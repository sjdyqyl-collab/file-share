<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1800pt" height="1449pt"
 viewBox="0.00 0.00 1800.00 1448.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 21060.81)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-21060.81 26166,-21060.81 26166,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" points="7061,-20903.81 7061,-21048.81 7373,-21048.81 7373,-20903.81 7061,-20903.81"/>
<text text-anchor="middle" x="7217" y="-21033.61" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_sp_split</title>
<polygon fill="none" stroke="black" points="7020,-20750.81 7020,-20895.81 7414,-20895.81 7414,-20750.81 7020,-20750.81"/>
<text text-anchor="middle" x="7217" y="-20880.61" font-family="Times,serif" font-size="14.00">Sequence Parallel Split</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ra_sp0</title>
<polygon fill="none" stroke="black" points="8,-15668.11 8,-21022.68 3960,-21022.68 3960,-15668.11 8,-15668.11"/>
<text text-anchor="middle" x="1984" y="-21007.48" font-family="Times,serif" font-size="14.00">Ring Attention + Sequence Parallel</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ffn0</title>
<polygon fill="none" stroke="black" points="14654,-15810.11 14654,-16189.11 18236,-16189.11 18236,-15810.11 14654,-15810.11"/>
<text text-anchor="middle" x="16445" y="-16173.91" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" points="7928,-15641.61 7928,-15928.61 14646,-15928.61 14646,-15641.61 7928,-15641.61"/>
<text text-anchor="middle" x="11287" y="-15913.41" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_ra_sp1</title>
<polygon fill="none" stroke="black" points="3968,-10558.91 3968,-15902.48 7920,-15902.48 7920,-10558.91 3968,-10558.91"/>
<text text-anchor="middle" x="5944" y="-15887.28" font-family="Times,serif" font-size="14.00">Ring Attention + Sequence Parallel</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_ffn1</title>
<polygon fill="none" stroke="black" points="18614,-10700.91 18614,-11079.91 22196,-11079.91 22196,-10700.91 18614,-10700.91"/>
<text text-anchor="middle" x="20405" y="-11064.71" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" points="11888,-10532.41 11888,-10819.41 18606,-10819.41 18606,-10532.41 11888,-10532.41"/>
<text text-anchor="middle" x="15247" y="-10804.21" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_ra_sp2</title>
<polygon fill="none" stroke="black" points="7928,-5449.7 7928,-10793.28 11880,-10793.28 11880,-5449.7 7928,-5449.7"/>
<text text-anchor="middle" x="9904" y="-10778.08" font-family="Times,serif" font-size="14.00">Ring Attention + Sequence Parallel</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_ffn2</title>
<polygon fill="none" stroke="black" points="22572,-5591.7 22572,-5970.7 26154,-5970.7 26154,-5591.7 22572,-5591.7"/>
<text text-anchor="middle" x="24363" y="-5955.5" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" points="15846,-5423.2 15846,-5710.2 22564,-5710.2 22564,-5423.2 15846,-5423.2"/>
<text text-anchor="middle" x="19205" y="-5695" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_ra_sp3</title>
<polygon fill="none" stroke="black" points="11888,-340.5 11888,-5684.07 15838,-5684.07 15838,-340.5 11888,-340.5"/>
<text text-anchor="middle" x="13863" y="-5668.87" font-family="Times,serif" font-size="14.00">Ring Attention + Sequence Parallel</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_ffn3</title>
<polygon fill="none" stroke="black" points="22572,-482.5 22572,-861.5 26154,-861.5 26154,-482.5 22572,-482.5"/>
<text text-anchor="middle" x="24363" y="-846.3" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="black" points="15846,-314 15846,-601 22564,-601 22564,-314 15846,-314"/>
<text text-anchor="middle" x="19205" y="-585.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_sp_gather</title>
<polygon fill="none" stroke="black" points="18992,-161 18992,-306 19418,-306 19418,-161 18992,-161"/>
<text text-anchor="middle" x="19205" y="-290.8" font-family="Times,serif" font-size="14.00">Sequence Parallel Gather</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" points="19049,-8 19049,-153 19361,-153 19361,-8 19049,-8"/>
<text text-anchor="middle" x="19205" y="-137.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7365.01,-21017.81 7129.56,-21017.81 7068.99,-20911.81 7304.44,-20911.81 7365.01,-21017.81"/>
<text text-anchor="middle" x="7217" y="-20976.11" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7217" y="-20961.11" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="7217" y="-20946.11" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- sp_split -->
<g id="node2" class="node">
<title>sp_split</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7405.88,-20864.81 7105.42,-20864.81 7028.12,-20758.81 7328.58,-20758.81 7405.88,-20864.81"/>
<text text-anchor="middle" x="7217" y="-20823.11" font-family="Times,serif" font-size="14.00">Sequence Parallel Split</text>
<text text-anchor="middle" x="7217" y="-20808.11" font-family="Times,serif" font-size="14.00">X: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7217" y="-20793.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- input&#45;&gt;sp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;sp_split</title>
<path fill="none" stroke="black" d="M7217,-20911.43C7217,-20899.65 7217,-20887.04 7217,-20874.9"/>
<polygon fill="black" stroke="black" points="7220.5,-20874.85 7217,-20864.85 7213.5,-20874.85 7220.5,-20874.85"/>
</g>
<!-- qkv0_0 -->
<g id="node3" class="node">
<title>qkv0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2873,-20632.7 2667,-20632.7 2667,-20579.7 2873,-20579.7 2873,-20632.7"/>
<text text-anchor="middle" x="2770" y="-20617.5" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2770" y="-20602.5" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2770" y="-20587.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- sp_split&#45;&gt;qkv0_0 -->
<g id="edge2" class="edge">
<title>sp_split&#45;&gt;qkv0_0</title>
<path fill="none" stroke="black" d="M7064.4,-20808.76C6398.02,-20799.59 3760.05,-20761.16 3391,-20722.81 3211.78,-20704.19 3006.82,-20661.85 2882.97,-20633.91"/>
<polygon fill="black" stroke="black" points="2883.62,-20630.47 2873.09,-20631.67 2882.07,-20637.3 2883.62,-20630.47"/>
</g>
<!-- qkv0_1 -->
<g id="node4" class="node">
<title>qkv0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3071,-20542.96 2865,-20542.96 2865,-20489.96 3071,-20489.96 3071,-20542.96"/>
<text text-anchor="middle" x="2968" y="-20527.76" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2968" y="-20512.76" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2968" y="-20497.76" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- sp_split&#45;&gt;qkv0_1 -->
<g id="edge3" class="edge">
<title>sp_split&#45;&gt;qkv0_1</title>
<path fill="none" stroke="black" d="M7065.93,-20810.82C6499.04,-20810.24 4498.7,-20802.46 3867,-20722.81 3569.64,-20685.32 3226.44,-20592.85 3063.45,-20545.86"/>
<polygon fill="black" stroke="black" points="3064.03,-20542.38 3053.45,-20542.97 3062.09,-20549.11 3064.03,-20542.38"/>
</g>
<!-- qkv0_2 -->
<g id="node5" class="node">
<title>qkv0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3535,-20453.22 3329,-20453.22 3329,-20400.22 3535,-20400.22 3535,-20453.22"/>
<text text-anchor="middle" x="3432" y="-20438.02" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3432" y="-20423.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3432" y="-20408.02" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- sp_split&#45;&gt;qkv0_2 -->
<g id="edge4" class="edge">
<title>sp_split&#45;&gt;qkv0_2</title>
<path fill="none" stroke="black" d="M7064.14,-20808.61C6509.43,-20800.26 4621.1,-20768.73 4354,-20722.81 4025.59,-20666.36 3652.82,-20520.34 3501.41,-20457.36"/>
<polygon fill="black" stroke="black" points="3502.33,-20453.95 3491.76,-20453.33 3499.64,-20460.41 3502.33,-20453.95"/>
</g>
<!-- qkv0_3 -->
<g id="node6" class="node">
<title>qkv0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3858,-20363.48 3652,-20363.48 3652,-20310.48 3858,-20310.48 3858,-20363.48"/>
<text text-anchor="middle" x="3755" y="-20348.28" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3755" y="-20333.28" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3755" y="-20318.28" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- sp_split&#45;&gt;qkv0_3 -->
<g id="edge5" class="edge">
<title>sp_split&#45;&gt;qkv0_3</title>
<path fill="none" stroke="black" d="M7063.83,-20807.96C6472.06,-20795.93 4368,-20743.57 4368,-20607.2 4368,-20607.2 4368,-20607.2 4368,-20515.46 4368,-20412.62 4045.63,-20365.6 3868.45,-20347.53"/>
<polygon fill="black" stroke="black" points="3868.59,-20344.02 3858.29,-20346.51 3867.89,-20350.99 3868.59,-20344.02"/>
</g>
<!-- qkv0_4 -->
<g id="node7" class="node">
<title>qkv0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1014,-20273.74 808,-20273.74 808,-20220.74 1014,-20220.74 1014,-20273.74"/>
<text text-anchor="middle" x="911" y="-20258.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="911" y="-20243.54" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="911" y="-20228.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- sp_split&#45;&gt;qkv0_4 -->
<g id="edge6" class="edge">
<title>sp_split&#45;&gt;qkv0_4</title>
<path fill="none" stroke="black" d="M7064.1,-20808.4C6518.52,-20799.62 4616.35,-20767.51 3047,-20722.81 3012.24,-20721.82 572.88,-20653.86 545,-20633.07 501.53,-20600.66 506,-20571.69 506,-20517.46 506,-20517.46 506,-20517.46 506,-20425.72 506,-20297.67 677.96,-20261.14 797.78,-20251.23"/>
<polygon fill="black" stroke="black" points="798.05,-20254.72 807.75,-20250.46 797.51,-20247.74 798.05,-20254.72"/>
</g>
<!-- qkv0_5 -->
<g id="node8" class="node">
<title>qkv0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="571,-20184 365,-20184 365,-20131 571,-20131 571,-20184"/>
<text text-anchor="middle" x="468" y="-20168.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="468" y="-20153.8" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="468" y="-20138.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- sp_split&#45;&gt;qkv0_5 -->
<g id="edge7" class="edge">
<title>sp_split&#45;&gt;qkv0_5</title>
<path fill="none" stroke="black" d="M7063.34,-20807.55C6597.1,-20797.75 5157.48,-20768.15 3964,-20750.81 3890.64,-20749.75 1392.94,-20744.98 1323,-20722.81 1282.87,-20710.09 1284.88,-20682.55 1245,-20669.07 1167.01,-20642.71 570.29,-20683.21 505,-20633.07 462.21,-20600.22 468,-20571.41 468,-20517.46 468,-20517.46 468,-20517.46 468,-20335.98 468,-20286.98 468,-20230.36 468,-20194.5"/>
<polygon fill="black" stroke="black" points="471.5,-20194.07 468,-20184.07 464.5,-20194.07 471.5,-20194.07"/>
</g>
<!-- qkv0_6 -->
<g id="node9" class="node">
<title>qkv0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2692,-20094.26 2486,-20094.26 2486,-20041.26 2692,-20041.26 2692,-20094.26"/>
<text text-anchor="middle" x="2589" y="-20079.06" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2589" y="-20064.06" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2589" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- sp_split&#45;&gt;qkv0_6 -->
<g id="edge8" class="edge">
<title>sp_split&#45;&gt;qkv0_6</title>
<path fill="none" stroke="black" d="M7063.84,-20808.12C6687.22,-20800.74 5723.69,-20776.99 5407,-20722.81 5230.06,-20692.54 5020,-20786.71 5020,-20607.2 5020,-20607.2 5020,-20607.2 5020,-20246.24 5020,-20073.54 3642.38,-20141.09 3470,-20130.63 3131.81,-20110.11 3041.7,-20140.72 2702.13,-20094.68"/>
<polygon fill="black" stroke="black" points="2702.39,-20091.18 2692.01,-20093.29 2701.44,-20098.11 2702.39,-20091.18"/>
</g>
<!-- qkv0_7 -->
<g id="node10" class="node">
<title>qkv0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="571,-20004.52 365,-20004.52 365,-19951.52 571,-19951.52 571,-20004.52"/>
<text text-anchor="middle" x="468" y="-19989.32" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="468" y="-19974.32" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="468" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- sp_split&#45;&gt;qkv0_7 -->
<g id="edge9" class="edge">
<title>sp_split&#45;&gt;qkv0_7</title>
<path fill="none" stroke="black" d="M7063.34,-20807.42C6597.11,-20797.24 5157.5,-20766.71 3964,-20750.81 3869.03,-20749.55 637.64,-20743.74 545,-20722.81 426.38,-20696.01 297,-20728.81 297,-20607.2 297,-20607.2 297,-20607.2 297,-20156.5 297,-20090.71 358.69,-20039.92 407.97,-20009.85"/>
<polygon fill="black" stroke="black" points="409.89,-20012.78 416.69,-20004.66 406.31,-20006.77 409.89,-20012.78"/>
</g>
<!-- qkv0_8 -->
<g id="node11" class="node">
<title>qkv0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2015,-19914.78 1809,-19914.78 1809,-19861.78 2015,-19861.78 2015,-19914.78"/>
<text text-anchor="middle" x="1912" y="-19899.58" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1912" y="-19884.58" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1912" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- sp_split&#45;&gt;qkv0_8 -->
<g id="edge10" class="edge">
<title>sp_split&#45;&gt;qkv0_8</title>
<path fill="none" stroke="black" d="M7064.65,-20809.42C6630.99,-20803.46 5421,-20772.05 5421,-20607.2 5421,-20607.2 5421,-20607.2 5421,-20066.76 5421,-19837.4 3589.16,-19960.67 3360,-19951.15 3066.45,-19938.97 2334.55,-19952.47 2025.23,-19915.17"/>
<polygon fill="black" stroke="black" points="2025.65,-19911.69 2015.3,-19913.93 2024.79,-19918.64 2025.65,-19911.69"/>
</g>
<!-- qkv0_9 -->
<g id="node12" class="node">
<title>qkv0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="713,-19825.04 507,-19825.04 507,-19772.04 713,-19772.04 713,-19825.04"/>
<text text-anchor="middle" x="610" y="-19809.84" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="610" y="-19794.84" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="610" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- sp_split&#45;&gt;qkv0_9 -->
<g id="edge11" class="edge">
<title>sp_split&#45;&gt;qkv0_9</title>
<path fill="none" stroke="black" d="M7063.34,-20807.39C6597.11,-20797.14 5157.5,-20766.4 3964,-20750.81 3913.31,-20750.15 356.95,-20749.75 314,-20722.81 265.47,-20692.37 257,-20664.49 257,-20607.2 257,-20607.2 257,-20607.2 257,-19977.02 257,-19867.82 393.51,-19825.8 496.75,-19809.64"/>
<polygon fill="black" stroke="black" points="497.58,-19813.05 506.95,-19808.11 496.54,-19806.13 497.58,-19813.05"/>
</g>
<!-- qkv0_10 -->
<g id="node13" class="node">
<title>qkv0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3941,-19735.3 3735,-19735.3 3735,-19682.3 3941,-19682.3 3941,-19735.3"/>
<text text-anchor="middle" x="3838" y="-19720.1" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3838" y="-19705.1" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3838" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- sp_split&#45;&gt;qkv0_10 -->
<g id="edge12" class="edge">
<title>sp_split&#45;&gt;qkv0_10</title>
<path fill="none" stroke="black" d="M7062.71,-20806.47C6774.55,-20797.24 6176.32,-20772.32 6096,-20722.81 6044.87,-20691.3 6026,-20667.27 6026,-20607.2 6026,-20607.2 6026,-20607.2 6026,-19887.28 6026,-19782.15 4399.93,-19726.38 3951.38,-19713"/>
<polygon fill="black" stroke="black" points="3951.43,-19709.5 3941.33,-19712.7 3951.22,-19716.5 3951.43,-19709.5"/>
</g>
<!-- qkv0_11 -->
<g id="node14" class="node">
<title>qkv0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="553,-19645.56 347,-19645.56 347,-19592.56 553,-19592.56 553,-19645.56"/>
<text text-anchor="middle" x="450" y="-19630.36" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="450" y="-19615.36" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="450" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- sp_split&#45;&gt;qkv0_11 -->
<g id="edge13" class="edge">
<title>sp_split&#45;&gt;qkv0_11</title>
<path fill="none" stroke="black" d="M7063.34,-20807.39C6597.11,-20797.11 5157.5,-20766.33 3964,-20750.81 3912.59,-20750.15 304.11,-20752.32 262,-20722.81 217.1,-20691.36 219,-20662.02 219,-20607.2 219,-20607.2 219,-20607.2 219,-19797.54 219,-19723.91 293.71,-19676.63 358.16,-19649.54"/>
<polygon fill="black" stroke="black" points="359.65,-19652.71 367.58,-19645.69 357,-19646.23 359.65,-19652.71"/>
</g>
<!-- qkv0_12 -->
<g id="node15" class="node">
<title>qkv0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3498,-19555.82 3292,-19555.82 3292,-19502.82 3498,-19502.82 3498,-19555.82"/>
<text text-anchor="middle" x="3395" y="-19540.62" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3395" y="-19525.62" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3395" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- sp_split&#45;&gt;qkv0_12 -->
<g id="edge14" class="edge">
<title>sp_split&#45;&gt;qkv0_12</title>
<path fill="none" stroke="black" d="M7056.33,-20797.68C6749.42,-20770.43 6110,-20702.25 6110,-20607.2 6110,-20607.2 6110,-20607.2 6110,-19707.8 6110,-19565.49 3736.1,-19576.34 3508.16,-19555.93"/>
<polygon fill="black" stroke="black" points="3508.34,-19552.43 3498.01,-19554.81 3507.57,-19559.39 3508.34,-19552.43"/>
</g>
<!-- qkv0_13 -->
<g id="node16" class="node">
<title>qkv0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3951,-20991.31 3745,-20991.31 3745,-20938.31 3951,-20938.31 3951,-20991.31"/>
<text text-anchor="middle" x="3848" y="-20976.11" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3848" y="-20961.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3848" y="-20946.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- sp_split&#45;&gt;qkv0_13 -->
<g id="edge15" class="edge">
<title>sp_split&#45;&gt;qkv0_13</title>
<path fill="none" stroke="black" d="M7072.19,-20819.3C6508.34,-20844.58 4465.95,-20936.12 3961.33,-20958.73"/>
<polygon fill="black" stroke="black" points="3960.96,-20955.25 3951.13,-20959.19 3961.28,-20962.24 3960.96,-20955.25"/>
</g>
<!-- qkv0_14 -->
<g id="node17" class="node">
<title>qkv0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2478,-20838.31 2272,-20838.31 2272,-20785.31 2478,-20785.31 2478,-20838.31"/>
<text text-anchor="middle" x="2375" y="-20823.11" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2375" y="-20808.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2375" y="-20793.11" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- sp_split&#45;&gt;qkv0_14 -->
<g id="edge16" class="edge">
<title>sp_split&#45;&gt;qkv0_14</title>
<path fill="none" stroke="black" d="M7066.6,-20811.81C5540.47,-20811.81 4014.35,-20811.81 2488.22,-20811.81"/>
<polygon fill="black" stroke="black" points="2488.14,-20808.31 2478.14,-20811.81 2488.14,-20815.31 2488.14,-20808.31"/>
</g>
<!-- qkv0_15 -->
<g id="node18" class="node">
<title>qkv0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1236,-20722.44 1030,-20722.44 1030,-20669.44 1236,-20669.44 1236,-20722.44"/>
<text text-anchor="middle" x="1133" y="-20707.24" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1133" y="-20692.24" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1133" y="-20677.24" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- sp_split&#45;&gt;qkv0_15 -->
<g id="edge17" class="edge">
<title>sp_split&#45;&gt;qkv0_15</title>
<path fill="none" stroke="black" d="M7063.34,-20807.54C6597.1,-20797.69 5157.48,-20767.98 3964,-20750.81 3662.46,-20746.48 1549.62,-20757.11 1250,-20722.81 1248.72,-20722.67 1247.44,-20722.51 1246.14,-20722.35"/>
<polygon fill="black" stroke="black" points="1246.54,-20718.87 1236.16,-20720.97 1245.58,-20725.81 1246.54,-20718.87"/>
</g>
<!-- res_attn0_0 -->
<g id="node611" class="node">
<title>res_attn0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8338.26,-15897.61 8018.1,-15897.61 7935.74,-15791.61 8255.9,-15791.61 8338.26,-15897.61"/>
<text text-anchor="middle" x="8137" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8137" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8137" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_0 -->
<g id="edge757" class="edge">
<title>sp_split&#45;&gt;res_attn0_0</title>
<path fill="none" stroke="black" d="M7357.97,-20798.98C7652.5,-20772.37 8306,-20702.56 8306,-20607.2 8306,-20607.2 8306,-20607.2 8306,-16272.61 8306,-16133.95 8228,-15986.62 8177.99,-15906.4"/>
<polygon fill="black" stroke="black" points="8180.92,-15904.49 8172.63,-15897.9 8175,-15908.22 8180.92,-15904.49"/>
</g>
<!-- res_attn0_1 -->
<g id="node612" class="node">
<title>res_attn0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8758.26,-15897.61 8438.1,-15897.61 8355.74,-15791.61 8675.9,-15791.61 8758.26,-15897.61"/>
<text text-anchor="middle" x="8557" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8557" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8557" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_1 -->
<g id="edge766" class="edge">
<title>sp_split&#45;&gt;res_attn0_1</title>
<path fill="none" stroke="black" d="M7366.3,-20810.01C7545.96,-20805.89 7855.48,-20788.67 8112,-20722.81 8238.44,-20690.36 8382,-20737.74 8382,-20607.2 8382,-20607.2 8382,-20607.2 8382,-16130.61 8382,-16040.09 8392.81,-16011.26 8444,-15936.61 8451.85,-15925.16 8461.56,-15914.42 8471.96,-15904.62"/>
<polygon fill="black" stroke="black" points="8474.59,-15906.96 8479.65,-15897.65 8469.89,-15901.78 8474.59,-15906.96"/>
</g>
<!-- res_attn0_2 -->
<g id="node613" class="node">
<title>res_attn0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9598.26,-15897.61 9278.1,-15897.61 9195.74,-15791.61 9515.9,-15791.61 9598.26,-15897.61"/>
<text text-anchor="middle" x="9397" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9397" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9397" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_2 -->
<g id="edge775" class="edge">
<title>sp_split&#45;&gt;res_attn0_2</title>
<path fill="none" stroke="black" d="M7363.58,-20806.78C7608.63,-20798.64 8090.41,-20776.23 8251,-20722.81 8337.35,-20694.09 8420,-20698.21 8420,-20607.2 8420,-20607.2 8420,-20607.2 8420,-18451.44 8420,-18302.49 8457.49,-18268.6 8472,-18120.35 8483.83,-17999.52 8471.01,-16021.31 8558,-15936.61 8570.52,-15924.42 9169.86,-15931.99 9187,-15928.61 9217.28,-15922.64 9248.8,-15912.5 9277.93,-15901.3"/>
<polygon fill="black" stroke="black" points="9279.26,-15904.54 9287.3,-15897.64 9276.71,-15898.02 9279.26,-15904.54"/>
</g>
<!-- res_attn0_3 -->
<g id="node614" class="node">
<title>res_attn0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10018.26,-15897.61 9698.1,-15897.61 9615.74,-15791.61 9935.9,-15791.61 10018.26,-15897.61"/>
<text text-anchor="middle" x="9817" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9817" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9817" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_3 -->
<g id="edge784" class="edge">
<title>sp_split&#45;&gt;res_attn0_3</title>
<path fill="none" stroke="black" d="M7363.52,-20806.35C7671.11,-20796.13 8363.83,-20768.34 8461,-20722.81 8525.5,-20692.59 8572,-20678.44 8572,-20607.2 8572,-20607.2 8572,-20607.2 8572,-16130.61 8572,-16024.8 8616.18,-15985.54 8710,-15936.61 8732.09,-15925.09 9582.54,-15933.38 9607,-15928.61 9637.38,-15922.68 9669,-15912.52 9698.2,-15901.29"/>
<polygon fill="black" stroke="black" points="9699.55,-15904.52 9707.59,-15897.61 9697,-15898 9699.55,-15904.52"/>
</g>
<!-- res_attn0_4 -->
<g id="node615" class="node">
<title>res_attn0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9178.26,-15897.61 8858.1,-15897.61 8775.74,-15791.61 9095.9,-15791.61 9178.26,-15897.61"/>
<text text-anchor="middle" x="8977" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8977" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8977" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_4 -->
<g id="edge793" class="edge">
<title>sp_split&#45;&gt;res_attn0_4</title>
<path fill="none" stroke="black" d="M7365.99,-20809.93C7673.26,-20806.69 8355.28,-20791.74 8434,-20722.81 8473.48,-20688.24 8458,-20659.68 8458,-20607.2 8458,-20607.2 8458,-20607.2 8458,-16130.61 8458,-16043.73 8417.72,-15995.06 8482,-15936.61 8493.72,-15925.95 8751.48,-15931.79 8767,-15928.61 8796.85,-15922.49 8827.92,-15912.44 8856.73,-15901.4"/>
<polygon fill="black" stroke="black" points="8858.37,-15904.52 8866.41,-15897.63 8855.83,-15898 8858.37,-15904.52"/>
</g>
<!-- res_attn0_5 -->
<g id="node616" class="node">
<title>res_attn0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10438.26,-15897.61 10118.1,-15897.61 10035.74,-15791.61 10355.9,-15791.61 10438.26,-15897.61"/>
<text text-anchor="middle" x="10237" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10237" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10237" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_5 -->
<g id="edge802" class="edge">
<title>sp_split&#45;&gt;res_attn0_5</title>
<path fill="none" stroke="black" d="M7366.46,-20810.7C7662.1,-20808.84 8311.04,-20796.24 8520,-20722.81 8604.82,-20693.01 8686,-20697.11 8686,-20607.2 8686,-20607.2 8686,-20607.2 8686,-16414.61 8686,-16200.39 8587.52,-16078.51 8748,-15936.61 8761.31,-15924.84 10009.56,-15931.99 10027,-15928.61 10057.39,-15922.72 10089.01,-15912.57 10118.21,-15901.35"/>
<polygon fill="black" stroke="black" points="10119.56,-15904.58 10127.6,-15897.67 10117.01,-15898.06 10119.56,-15904.58"/>
</g>
<!-- res_attn0_6 -->
<g id="node617" class="node">
<title>res_attn0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11698.26,-15897.61 11378.1,-15897.61 11295.74,-15791.61 11615.9,-15791.61 11698.26,-15897.61"/>
<text text-anchor="middle" x="11497" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11497" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11497" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_6 -->
<g id="edge811" class="edge">
<title>sp_split&#45;&gt;res_attn0_6</title>
<path fill="none" stroke="black" d="M7364.16,-20807.43C7731.52,-20798.32 8669,-20770.62 8802,-20722.81 8883.55,-20693.5 8959,-20693.86 8959,-20607.2 8959,-20607.2 8959,-20607.2 8959,-16556.61 8959,-16418.15 8918.5,-16029.7 9021,-15936.61 9032.65,-15926.03 11271.55,-15931.58 11287,-15928.61 11317.48,-15922.75 11349.2,-15912.57 11378.47,-15901.31"/>
<polygon fill="black" stroke="black" points="11379.85,-15904.53 11387.88,-15897.62 11377.29,-15898.01 11379.85,-15904.53"/>
</g>
<!-- res_attn0_7 -->
<g id="node618" class="node">
<title>res_attn0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10858.26,-15897.61 10538.1,-15897.61 10455.74,-15791.61 10775.9,-15791.61 10858.26,-15897.61"/>
<text text-anchor="middle" x="10657" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10657" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10657" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_7 -->
<g id="edge820" class="edge">
<title>sp_split&#45;&gt;res_attn0_7</title>
<path fill="none" stroke="black" d="M7365.12,-20808.76C7673.27,-20803.3 8373.81,-20784.33 8604,-20722.81 8716.07,-20692.87 8838,-20723.2 8838,-20607.2 8838,-20607.2 8838,-20607.2 8838,-16698.61 8838,-16507.16 8762,-16466.06 8762,-16274.61 8762,-16274.61 8762,-16274.61 8762,-16130.61 8762,-16039.1 8756.36,-15989.56 8831,-15936.61 8849.31,-15923.62 10424.96,-15932.86 10447,-15928.61 10477.39,-15922.74 10509.01,-15912.6 10538.21,-15901.38"/>
<polygon fill="black" stroke="black" points="10539.57,-15904.61 10547.6,-15897.7 10537.02,-15898.09 10539.57,-15904.61"/>
</g>
<!-- res_attn0_8 -->
<g id="node619" class="node">
<title>res_attn0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12538.26,-15897.61 12218.1,-15897.61 12135.74,-15791.61 12455.9,-15791.61 12538.26,-15897.61"/>
<text text-anchor="middle" x="12337" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12337" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12337" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_8 -->
<g id="edge829" class="edge">
<title>sp_split&#45;&gt;res_attn0_8</title>
<path fill="none" stroke="black" d="M7364.19,-20807.57C7757.04,-20798.32 8810.71,-20769.45 8961,-20722.81 9054.68,-20693.74 9149,-20705.29 9149,-20607.2 9149,-20607.2 9149,-20607.2 9149,-16130.61 9149,-15937.81 9349.43,-15981.2 9537,-15936.61 9606.99,-15919.97 12056.35,-15942.18 12127,-15928.61 12157.48,-15922.76 12189.2,-15912.58 12218.47,-15901.32"/>
<polygon fill="black" stroke="black" points="12219.85,-15904.54 12227.88,-15897.63 12217.3,-15898.02 12219.85,-15904.54"/>
</g>
<!-- res_attn0_9 -->
<g id="node620" class="node">
<title>res_attn0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11278.26,-15897.61 10958.1,-15897.61 10875.74,-15791.61 11195.9,-15791.61 11278.26,-15897.61"/>
<text text-anchor="middle" x="11077" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11077" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11077" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_9 -->
<g id="edge838" class="edge">
<title>sp_split&#45;&gt;res_attn0_9</title>
<path fill="none" stroke="black" d="M7363.86,-20806.82C7717.62,-20796.55 8597.09,-20766.9 8723,-20722.81 8803.44,-20694.65 8876,-20692.43 8876,-20607.2 8876,-20607.2 8876,-20607.2 8876,-16556.61 8876,-16276.98 8769.5,-16117.2 8983,-15936.61 8992.99,-15928.16 10854.15,-15931.09 10867,-15928.61 10897.39,-15922.75 10929.01,-15912.62 10958.22,-15901.39"/>
<polygon fill="black" stroke="black" points="10959.57,-15904.62 10967.61,-15897.72 10957.02,-15898.1 10959.57,-15904.62"/>
</g>
<!-- res_attn0_10 -->
<g id="node621" class="node">
<title>res_attn0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14638.26,-15897.61 14318.1,-15897.61 14235.74,-15791.61 14555.9,-15791.61 14638.26,-15897.61"/>
<text text-anchor="middle" x="14437" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14437" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14437" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_10 -->
<g id="edge847" class="edge">
<title>sp_split&#45;&gt;res_attn0_10</title>
<path fill="none" stroke="black" d="M7366.18,-20810.04C8323.85,-20804.62 13568,-20767.59 13568,-20607.2 13568,-20607.2 13568,-20607.2 13568,-16130.61 13568,-15824.27 13937.88,-16029.88 14227,-15928.61 14252.87,-15919.55 14280.27,-15909.25 14306.44,-15899.06"/>
<polygon fill="black" stroke="black" points="14307.98,-15902.21 14316.02,-15895.31 14305.43,-15895.69 14307.98,-15902.21"/>
</g>
<!-- res_attn0_11 -->
<g id="node622" class="node">
<title>res_attn0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13798.26,-15897.61 13478.1,-15897.61 13395.74,-15791.61 13715.9,-15791.61 13798.26,-15897.61"/>
<text text-anchor="middle" x="13597" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13597" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13597" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_11 -->
<g id="edge856" class="edge">
<title>sp_split&#45;&gt;res_attn0_11</title>
<path fill="none" stroke="black" d="M7366.82,-20810.97C8082.1,-20810.74 11115,-20798.48 11115,-20607.2 11115,-20607.2 11115,-20607.2 11115,-16130.61 11115,-15862.89 12037.24,-15959.22 12304,-15936.61 12363.95,-15931.53 13327.94,-15940.09 13387,-15928.61 13417.38,-15922.71 13449,-15912.55 13478.2,-15901.32"/>
<polygon fill="black" stroke="black" points="13479.56,-15904.55 13487.59,-15897.65 13477.01,-15898.03 13479.56,-15904.55"/>
</g>
<!-- res_attn0_12 -->
<g id="node623" class="node">
<title>res_attn0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14218.26,-15897.61 13898.1,-15897.61 13815.74,-15791.61 14135.9,-15791.61 14218.26,-15897.61"/>
<text text-anchor="middle" x="14017" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14017" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14017" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_12 -->
<g id="edge865" class="edge">
<title>sp_split&#45;&gt;res_attn0_12</title>
<path fill="none" stroke="black" d="M7365.19,-20808.87C8203.88,-20797.38 12318,-20734.56 12318,-20607.2 12318,-20607.2 12318,-20607.2 12318,-16130.61 12318,-15852.58 13277.19,-15962.61 13554,-15936.61 13610,-15931.35 13751.92,-15940.01 13807,-15928.61 13836.75,-15922.46 13867.73,-15912.42 13896.47,-15901.42"/>
<polygon fill="black" stroke="black" points="13898.08,-15904.55 13906.12,-15897.66 13895.54,-15898.03 13898.08,-15904.55"/>
</g>
<!-- res_attn0_13 -->
<g id="node624" class="node">
<title>res_attn0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12118.26,-15897.61 11798.1,-15897.61 11715.74,-15791.61 12035.9,-15791.61 12118.26,-15897.61"/>
<text text-anchor="middle" x="11917" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11917" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11917" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_13 -->
<g id="edge874" class="edge">
<title>sp_split&#45;&gt;res_attn0_13</title>
<path fill="none" stroke="black" d="M7364.62,-20807.95C7745.56,-20799.85 8741.71,-20774.02 8882,-20722.81 8962.06,-20693.59 9035,-20692.43 9035,-20607.2 9035,-20607.2 9035,-20607.2 9035,-16130.61 9035,-16033.61 9052.25,-15987.23 9135,-15936.61 9150.24,-15927.29 11689.46,-15931.98 11707,-15928.61 11737.48,-15922.76 11769.2,-15912.58 11798.47,-15901.32"/>
<polygon fill="black" stroke="black" points="11799.85,-15904.54 11807.88,-15897.63 11797.3,-15898.02 11799.85,-15904.54"/>
</g>
<!-- res_attn0_14 -->
<g id="node625" class="node">
<title>res_attn0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13378.26,-15897.61 13058.1,-15897.61 12975.74,-15791.61 13295.9,-15791.61 13378.26,-15897.61"/>
<text text-anchor="middle" x="13177" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13177" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13177" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_14 -->
<g id="edge883" class="edge">
<title>sp_split&#45;&gt;res_attn0_14</title>
<path fill="none" stroke="black" d="M7364.77,-20807.96C7777.12,-20799.46 8934.75,-20771.81 9312,-20722.81 9549.36,-20691.98 9838,-20846.56 9838,-20607.2 9838,-20607.2 9838,-20607.2 9838,-16130.61 9838,-15846.65 10817.91,-15958.84 11101,-15936.61 11152.67,-15932.55 12916.1,-15938.42 12967,-15928.61 12997.39,-15922.75 13029.01,-15912.62 13058.22,-15901.39"/>
<polygon fill="black" stroke="black" points="13059.57,-15904.62 13067.61,-15897.71 13057.02,-15898.1 13059.57,-15904.62"/>
</g>
<!-- res_attn0_15 -->
<g id="node626" class="node">
<title>res_attn0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12958.26,-15897.61 12638.1,-15897.61 12555.74,-15791.61 12875.9,-15791.61 12958.26,-15897.61"/>
<text text-anchor="middle" x="12757" y="-15855.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12757" y="-15840.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12757" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- sp_split&#45;&gt;res_attn0_15 -->
<g id="edge892" class="edge">
<title>sp_split&#45;&gt;res_attn0_15</title>
<path fill="none" stroke="black" d="M7364.19,-20807.24C7740.53,-20797.53 8731.16,-20768.35 9057,-20722.81 9280.32,-20691.61 9551,-20832.69 9551,-20607.2 9551,-20607.2 9551,-20607.2 9551,-16130.61 9551,-15981.76 9682.26,-15982.07 9824,-15936.61 9860.01,-15925.06 12509.86,-15935.74 12547,-15928.61 12577.48,-15922.76 12609.2,-15912.59 12638.47,-15901.33"/>
<polygon fill="black" stroke="black" points="12639.85,-15904.54 12647.88,-15897.64 12637.3,-15898.03 12639.85,-15904.54"/>
</g>
<!-- ring_stage0_0_0 -->
<g id="node19" class="node">
<title>ring_stage0_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2800.5,-20542.96 2607.5,-20542.96 2607.5,-20489.96 2800.5,-20489.96 2800.5,-20542.96"/>
<text text-anchor="middle" x="2704" y="-20527.76" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="2704" y="-20512.76" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_0×V_0</text>
<text text-anchor="middle" x="2704" y="-20497.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv0_0&#45;&gt;ring_stage0_0_0 -->
<g id="edge18" class="edge">
<title>qkv0_0&#45;&gt;ring_stage0_0_0</title>
<path fill="none" stroke="black" d="M2750.55,-20579.35C2743.91,-20570.52 2736.37,-20560.5 2729.33,-20551.14"/>
<polygon fill="black" stroke="black" points="2732.11,-20549.02 2723.31,-20543.13 2726.52,-20553.22 2732.11,-20549.02"/>
</g>
<!-- ring_stage0_0_1 -->
<g id="node20" class="node">
<title>ring_stage0_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3018.5,-20453.22 2825.5,-20453.22 2825.5,-20400.22 3018.5,-20400.22 3018.5,-20453.22"/>
<text text-anchor="middle" x="2922" y="-20438.02" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="2922" y="-20423.02" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_1×V_1</text>
<text text-anchor="middle" x="2922" y="-20408.02" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv0_1&#45;&gt;ring_stage0_0_1 -->
<g id="edge19" class="edge">
<title>qkv0_1&#45;&gt;ring_stage0_0_1</title>
<path fill="none" stroke="black" d="M2954.45,-20489.61C2949.96,-20481.05 2944.88,-20471.37 2940.1,-20462.25"/>
<polygon fill="black" stroke="black" points="2943.2,-20460.62 2935.46,-20453.39 2937,-20463.87 2943.2,-20460.62"/>
</g>
<!-- ring_stage0_0_2 -->
<g id="node21" class="node">
<title>ring_stage0_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3336.5,-20363.48 3143.5,-20363.48 3143.5,-20310.48 3336.5,-20310.48 3336.5,-20363.48"/>
<text text-anchor="middle" x="3240" y="-20348.28" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="3240" y="-20333.28" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_2×V_2</text>
<text text-anchor="middle" x="3240" y="-20318.28" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv0_2&#45;&gt;ring_stage0_0_2 -->
<g id="edge20" class="edge">
<title>qkv0_2&#45;&gt;ring_stage0_0_2</title>
<path fill="none" stroke="black" d="M3375.95,-20400.11C3353.87,-20390.02 3328.35,-20378.36 3305.43,-20367.88"/>
<polygon fill="black" stroke="black" points="3306.67,-20364.6 3296.12,-20363.63 3303.76,-20370.97 3306.67,-20364.6"/>
</g>
<!-- ring_stage0_0_3 -->
<g id="node22" class="node">
<title>ring_stage0_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3554.5,-20273.74 3361.5,-20273.74 3361.5,-20220.74 3554.5,-20220.74 3554.5,-20273.74"/>
<text text-anchor="middle" x="3458" y="-20258.54" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="3458" y="-20243.54" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_3×V_3</text>
<text text-anchor="middle" x="3458" y="-20228.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv0_3&#45;&gt;ring_stage0_0_3 -->
<g id="edge21" class="edge">
<title>qkv0_3&#45;&gt;ring_stage0_0_3</title>
<path fill="none" stroke="black" d="M3668.3,-20310.37C3632.54,-20299.81 3590.97,-20287.52 3554.27,-20276.68"/>
<polygon fill="black" stroke="black" points="3555.14,-20273.29 3544.55,-20273.81 3553.15,-20280 3555.14,-20273.29"/>
</g>
<!-- ring_stage0_0_4 -->
<g id="node23" class="node">
<title>ring_stage0_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1040.5,-20184 847.5,-20184 847.5,-20131 1040.5,-20131 1040.5,-20184"/>
<text text-anchor="middle" x="944" y="-20168.8" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="944" y="-20153.8" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_4×V_4</text>
<text text-anchor="middle" x="944" y="-20138.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv0_4&#45;&gt;ring_stage0_0_4 -->
<g id="edge22" class="edge">
<title>qkv0_4&#45;&gt;ring_stage0_0_4</title>
<path fill="none" stroke="black" d="M920.72,-20220.39C923.88,-20212 927.43,-20202.55 930.8,-20193.6"/>
<polygon fill="black" stroke="black" points="934.1,-20194.76 934.35,-20184.17 927.55,-20192.3 934.1,-20194.76"/>
</g>
<!-- ring_stage0_0_5 -->
<g id="node24" class="node">
<title>ring_stage0_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="822.5,-20094.26 629.5,-20094.26 629.5,-20041.26 822.5,-20041.26 822.5,-20094.26"/>
<text text-anchor="middle" x="726" y="-20079.06" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="726" y="-20064.06" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_5×V_5</text>
<text text-anchor="middle" x="726" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv0_5&#45;&gt;ring_stage0_0_5 -->
<g id="edge23" class="edge">
<title>qkv0_5&#45;&gt;ring_stage0_0_5</title>
<path fill="none" stroke="black" d="M543.32,-20130.89C573.92,-20120.48 609.42,-20108.41 640.94,-20097.69"/>
<polygon fill="black" stroke="black" points="642.25,-20100.94 650.59,-20094.41 639.99,-20094.31 642.25,-20100.94"/>
</g>
<!-- ring_stage0_0_6 -->
<g id="node25" class="node">
<title>ring_stage0_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2014.5,-20004.52 1821.5,-20004.52 1821.5,-19951.52 2014.5,-19951.52 2014.5,-20004.52"/>
<text text-anchor="middle" x="1918" y="-19989.32" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="1918" y="-19974.32" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_6×V_6</text>
<text text-anchor="middle" x="1918" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv0_6&#45;&gt;ring_stage0_0_6 -->
<g id="edge24" class="edge">
<title>qkv0_6&#45;&gt;ring_stage0_0_6</title>
<path fill="none" stroke="black" d="M2485.97,-20042.36C2482.95,-20041.84 2479.96,-20041.35 2477,-20040.89 2280.61,-20010.58 2225.19,-20036.09 2024.61,-20004.86"/>
<polygon fill="black" stroke="black" points="2025.06,-20001.39 2014.63,-20003.28 2023.96,-20008.3 2025.06,-20001.39"/>
</g>
<!-- ring_stage0_0_7 -->
<g id="node26" class="node">
<title>ring_stage0_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1143.5,-19914.78 950.5,-19914.78 950.5,-19861.78 1143.5,-19861.78 1143.5,-19914.78"/>
<text text-anchor="middle" x="1047" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="1047" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_7×V_7</text>
<text text-anchor="middle" x="1047" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv0_7&#45;&gt;ring_stage0_0_7 -->
<g id="edge25" class="edge">
<title>qkv0_7&#45;&gt;ring_stage0_0_7</title>
<path fill="none" stroke="black" d="M571.37,-19959.08C587.64,-19956.35 604.27,-19953.63 620,-19951.15 728.9,-19934 853.71,-19916.12 940.15,-19904.02"/>
<polygon fill="black" stroke="black" points="940.81,-19907.46 950.23,-19902.61 939.84,-19900.53 940.81,-19907.46"/>
</g>
<!-- ring_stage0_0_8 -->
<g id="node27" class="node">
<title>ring_stage0_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1137.5,-19825.04 944.5,-19825.04 944.5,-19772.04 1137.5,-19772.04 1137.5,-19825.04"/>
<text text-anchor="middle" x="1041" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="1041" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_8×V_8</text>
<text text-anchor="middle" x="1041" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv0_8&#45;&gt;ring_stage0_0_8 -->
<g id="edge26" class="edge">
<title>qkv0_8&#45;&gt;ring_stage0_0_8</title>
<path fill="none" stroke="black" d="M1808.99,-19862.79C1805.96,-19862.29 1802.96,-19861.83 1800,-19861.41 1515.46,-19821.01 1436.29,-19867 1147.54,-19825.35"/>
<polygon fill="black" stroke="black" points="1148.02,-19821.89 1137.62,-19823.9 1147,-19828.81 1148.02,-19821.89"/>
</g>
<!-- ring_stage0_0_9 -->
<g id="node28" class="node">
<title>ring_stage0_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="777.5,-19735.3 584.5,-19735.3 584.5,-19682.3 777.5,-19682.3 777.5,-19735.3"/>
<text text-anchor="middle" x="681" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="681" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_9×V_9</text>
<text text-anchor="middle" x="681" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv0_9&#45;&gt;ring_stage0_0_9 -->
<g id="edge27" class="edge">
<title>qkv0_9&#45;&gt;ring_stage0_0_9</title>
<path fill="none" stroke="black" d="M630.92,-19771.69C638.07,-19762.86 646.17,-19752.84 653.75,-19743.48"/>
<polygon fill="black" stroke="black" points="656.66,-19745.44 660.23,-19735.47 651.22,-19741.04 656.66,-19745.44"/>
</g>
<!-- ring_stage0_0_10 -->
<g id="node29" class="node">
<title>ring_stage0_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1029,-19645.56 809,-19645.56 809,-19592.56 1029,-19592.56 1029,-19645.56"/>
<text text-anchor="middle" x="919" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="919" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_10×V_10</text>
<text text-anchor="middle" x="919" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv0_10&#45;&gt;ring_stage0_0_10 -->
<g id="edge28" class="edge">
<title>qkv0_10&#45;&gt;ring_stage0_0_10</title>
<path fill="none" stroke="black" d="M3734.73,-19684.45C3728.41,-19683.47 3722.13,-19682.62 3716,-19681.93 3125.84,-19616.03 1634.32,-19710.4 1044,-19645.93 1042.49,-19645.77 1040.96,-19645.59 1039.43,-19645.41"/>
<polygon fill="black" stroke="black" points="1039.61,-19641.9 1029.24,-19644.07 1038.7,-19648.84 1039.61,-19641.9"/>
</g>
<!-- ring_stage0_0_11 -->
<g id="node30" class="node">
<title>ring_stage0_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="566,-19555.82 346,-19555.82 346,-19502.82 566,-19502.82 566,-19555.82"/>
<text text-anchor="middle" x="456" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="456" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_11×V_11</text>
<text text-anchor="middle" x="456" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv0_11&#45;&gt;ring_stage0_0_11 -->
<g id="edge29" class="edge">
<title>qkv0_11&#45;&gt;ring_stage0_0_11</title>
<path fill="none" stroke="black" d="M451.77,-19592.21C452.33,-19584 452.96,-19574.77 453.56,-19565.99"/>
<polygon fill="black" stroke="black" points="457.05,-19566.2 454.24,-19555.99 450.07,-19565.73 457.05,-19566.2"/>
</g>
<!-- ring_stage0_0_12 -->
<g id="node31" class="node">
<title>ring_stage0_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1050,-19466.08 830,-19466.08 830,-19413.08 1050,-19413.08 1050,-19466.08"/>
<text text-anchor="middle" x="940" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="940" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_12×V_12</text>
<text text-anchor="middle" x="940" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv0_12&#45;&gt;ring_stage0_0_12 -->
<g id="edge30" class="edge">
<title>qkv0_12&#45;&gt;ring_stage0_0_12</title>
<path fill="none" stroke="black" d="M3291.71,-19503.63C3288.78,-19503.2 3285.87,-19502.8 3283,-19502.45 2795.6,-19442.89 1566.36,-19522.17 1060.07,-19466.44"/>
<polygon fill="black" stroke="black" points="1060.42,-19462.96 1050.09,-19465.32 1059.63,-19469.92 1060.42,-19462.96"/>
</g>
<!-- ring_stage0_0_13 -->
<g id="node32" class="node">
<title>ring_stage0_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="774,-20838.31 554,-20838.31 554,-20785.31 774,-20785.31 774,-20838.31"/>
<text text-anchor="middle" x="664" y="-20823.11" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="664" y="-20808.11" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_13×V_13</text>
<text text-anchor="middle" x="664" y="-20793.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv0_13&#45;&gt;ring_stage0_0_13 -->
<g id="edge31" class="edge">
<title>qkv0_13&#45;&gt;ring_stage0_0_13</title>
<path fill="none" stroke="black" d="M3811.28,-20938.25C3790.27,-20925.18 3762.83,-20910.63 3736,-20903.81 3696.34,-20893.75 2303.9,-20896.99 2263,-20895.81 1710.21,-20879.97 1050.93,-20838.63 784.51,-20820.98"/>
<polygon fill="black" stroke="black" points="784.64,-20817.49 774.43,-20820.32 784.17,-20824.47 784.64,-20817.49"/>
</g>
<!-- ring_stage0_0_14 -->
<g id="node33" class="node">
<title>ring_stage0_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1012,-20722.44 792,-20722.44 792,-20669.44 1012,-20669.44 1012,-20722.44"/>
<text text-anchor="middle" x="902" y="-20707.24" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="902" y="-20692.24" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_14×V_14</text>
<text text-anchor="middle" x="902" y="-20677.24" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv0_14&#45;&gt;ring_stage0_0_14 -->
<g id="edge32" class="edge">
<title>qkv0_14&#45;&gt;ring_stage0_0_14</title>
<path fill="none" stroke="black" d="M2271.7,-20809.35C2046.1,-20805 1492.55,-20788.15 1022.16,-20722.89"/>
<polygon fill="black" stroke="black" points="1022.5,-20719.4 1012.11,-20721.49 1021.53,-20726.34 1022.5,-20719.4"/>
</g>
<!-- ring_stage0_0_15 -->
<g id="node34" class="node">
<title>ring_stage0_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1250,-20632.7 1030,-20632.7 1030,-20579.7 1250,-20579.7 1250,-20632.7"/>
<text text-anchor="middle" x="1140" y="-20617.5" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="1140" y="-20602.5" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_15×V_15</text>
<text text-anchor="middle" x="1140" y="-20587.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv0_15&#45;&gt;ring_stage0_0_15 -->
<g id="edge33" class="edge">
<title>qkv0_15&#45;&gt;ring_stage0_0_15</title>
<path fill="none" stroke="black" d="M1135.06,-20669.09C1135.72,-20660.88 1136.45,-20651.65 1137.15,-20642.88"/>
<polygon fill="black" stroke="black" points="1140.65,-20643.12 1137.95,-20632.87 1133.67,-20642.56 1140.65,-20643.12"/>
</g>
<!-- kv_send0_0_0 -->
<g id="node35" class="node">
<title>kv_send0_0_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2704" cy="-20426.72" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2704" y="-20430.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="2704" y="-20415.52" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_0_0&#45;&gt;kv_send0_0_0 -->
<g id="edge34" class="edge">
<title>ring_stage0_0_0&#45;&gt;kv_send0_0_0</title>
<path fill="none" stroke="black" d="M2704,-20489.61C2704,-20481.56 2704,-20472.53 2704,-20463.91"/>
<polygon fill="black" stroke="black" points="2707.5,-20463.69 2704,-20453.69 2700.5,-20463.69 2707.5,-20463.69"/>
</g>
<!-- ring_stage0_1_0 -->
<g id="node51" class="node">
<title>ring_stage0_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1474.5,-20453.22 1263.5,-20453.22 1263.5,-20400.22 1474.5,-20400.22 1474.5,-20453.22"/>
<text text-anchor="middle" x="1369" y="-20438.02" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1369" y="-20423.02" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_15×V_15</text>
<text text-anchor="middle" x="1369" y="-20408.02" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_0_0&#45;&gt;ring_stage0_1_0 -->
<g id="edge50" class="edge">
<title>ring_stage0_0_0&#45;&gt;ring_stage0_1_0</title>
<path fill="none" stroke="black" d="M2607.45,-20509.12C2367.34,-20493.34 1743.97,-20452.37 1484.73,-20435.33"/>
<polygon fill="black" stroke="black" points="1484.74,-20431.82 1474.53,-20434.66 1484.28,-20438.81 1484.74,-20431.82"/>
</g>
<!-- kv_send0_0_1 -->
<g id="node36" class="node">
<title>kv_send0_0_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2922" cy="-20336.98" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2922" y="-20340.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="2922" y="-20325.78" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_0_1&#45;&gt;kv_send0_0_1 -->
<g id="edge35" class="edge">
<title>ring_stage0_0_1&#45;&gt;kv_send0_0_1</title>
<path fill="none" stroke="black" d="M2922,-20399.87C2922,-20391.82 2922,-20382.79 2922,-20374.17"/>
<polygon fill="black" stroke="black" points="2925.5,-20373.95 2922,-20363.95 2918.5,-20373.95 2925.5,-20373.95"/>
</g>
<!-- ring_stage0_1_1 -->
<g id="node52" class="node">
<title>ring_stage0_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2800.5,-20363.48 2607.5,-20363.48 2607.5,-20310.48 2800.5,-20310.48 2800.5,-20363.48"/>
<text text-anchor="middle" x="2704" y="-20348.28" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="2704" y="-20333.28" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_0×V_0</text>
<text text-anchor="middle" x="2704" y="-20318.28" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_0_1&#45;&gt;ring_stage0_1_1 -->
<g id="edge53" class="edge">
<title>ring_stage0_0_1&#45;&gt;ring_stage0_1_1</title>
<path fill="none" stroke="black" d="M2858.36,-20400.11C2832.95,-20389.88 2803.54,-20378.05 2777.25,-20367.47"/>
<polygon fill="black" stroke="black" points="2778.3,-20364.12 2767.72,-20363.63 2775.69,-20370.61 2778.3,-20364.12"/>
</g>
<!-- kv_send0_0_2 -->
<g id="node37" class="node">
<title>kv_send0_0_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3240" cy="-20247.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3240" y="-20251.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="3240" y="-20236.04" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_0_2&#45;&gt;kv_send0_0_2 -->
<g id="edge36" class="edge">
<title>ring_stage0_0_2&#45;&gt;kv_send0_0_2</title>
<path fill="none" stroke="black" d="M3240,-20310.13C3240,-20302.08 3240,-20293.05 3240,-20284.43"/>
<polygon fill="black" stroke="black" points="3243.5,-20284.21 3240,-20274.21 3236.5,-20284.21 3243.5,-20284.21"/>
</g>
<!-- ring_stage0_1_2 -->
<g id="node53" class="node">
<title>ring_stage0_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3018.5,-20273.74 2825.5,-20273.74 2825.5,-20220.74 3018.5,-20220.74 3018.5,-20273.74"/>
<text text-anchor="middle" x="2922" y="-20258.54" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="2922" y="-20243.54" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_1×V_1</text>
<text text-anchor="middle" x="2922" y="-20228.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_0_2&#45;&gt;ring_stage0_1_2 -->
<g id="edge56" class="edge">
<title>ring_stage0_0_2&#45;&gt;ring_stage0_1_2</title>
<path fill="none" stroke="black" d="M3147.17,-20310.37C3108.64,-20299.74 3063.8,-20287.37 3024.32,-20276.48"/>
<polygon fill="black" stroke="black" points="3025.24,-20273.1 3014.67,-20273.81 3023.38,-20279.85 3025.24,-20273.1"/>
</g>
<!-- kv_send0_0_3 -->
<g id="node38" class="node">
<title>kv_send0_0_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3146" cy="-20157.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3146" y="-20161.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3146" y="-20146.3" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_0_3&#45;&gt;kv_send0_0_3 -->
<g id="edge37" class="edge">
<title>ring_stage0_0_3&#45;&gt;kv_send0_0_3</title>
<path fill="none" stroke="black" d="M3366.92,-20220.63C3321.6,-20207.89 3267.39,-20192.64 3224.01,-20180.44"/>
<polygon fill="black" stroke="black" points="3224.94,-20177.07 3214.36,-20177.73 3223.04,-20183.8 3224.94,-20177.07"/>
</g>
<!-- ring_stage0_1_3 -->
<g id="node54" class="node">
<title>ring_stage0_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3460.5,-20184 3267.5,-20184 3267.5,-20131 3460.5,-20131 3460.5,-20184"/>
<text text-anchor="middle" x="3364" y="-20168.8" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="3364" y="-20153.8" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_2×V_2</text>
<text text-anchor="middle" x="3364" y="-20138.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_0_3&#45;&gt;ring_stage0_1_3 -->
<g id="edge59" class="edge">
<title>ring_stage0_0_3&#45;&gt;ring_stage0_1_3</title>
<path fill="none" stroke="black" d="M3430.56,-20220.63C3420.7,-20211.43 3409.45,-20200.93 3399.04,-20191.21"/>
<polygon fill="black" stroke="black" points="3401.34,-20188.57 3391.64,-20184.3 3396.56,-20193.68 3401.34,-20188.57"/>
</g>
<!-- kv_send0_0_4 -->
<g id="node39" class="node">
<title>kv_send0_0_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="944" cy="-20067.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="944" y="-20071.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="944" y="-20056.56" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_0_4&#45;&gt;kv_send0_0_4 -->
<g id="edge38" class="edge">
<title>ring_stage0_0_4&#45;&gt;kv_send0_0_4</title>
<path fill="none" stroke="black" d="M944,-20130.65C944,-20122.6 944,-20113.57 944,-20104.95"/>
<polygon fill="black" stroke="black" points="947.5,-20104.73 944,-20094.73 940.5,-20104.73 947.5,-20104.73"/>
</g>
<!-- ring_stage0_1_4 -->
<g id="node55" class="node">
<title>ring_stage0_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2162.5,-20094.26 1969.5,-20094.26 1969.5,-20041.26 2162.5,-20041.26 2162.5,-20094.26"/>
<text text-anchor="middle" x="2066" y="-20079.06" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="2066" y="-20064.06" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_3×V_3</text>
<text text-anchor="middle" x="2066" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_0_4&#45;&gt;ring_stage0_1_4 -->
<g id="edge62" class="edge">
<title>ring_stage0_0_4&#45;&gt;ring_stage0_1_4</title>
<path fill="none" stroke="black" d="M1040.87,-20141.48C1069.8,-20137.43 1101.63,-20133.41 1131,-20130.63 1442.46,-20101.17 1522.17,-20119.98 1834,-20094.63 1874.97,-20091.3 1919.89,-20086.55 1959.2,-20082.03"/>
<polygon fill="black" stroke="black" points="1959.8,-20085.48 1969.33,-20080.85 1959,-20078.53 1959.8,-20085.48"/>
</g>
<!-- kv_send0_0_5 -->
<g id="node40" class="node">
<title>kv_send0_0_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="944" cy="-19978.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="944" y="-19981.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="944" y="-19966.82" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_0_5&#45;&gt;kv_send0_0_5 -->
<g id="edge39" class="edge">
<title>ring_stage0_0_5&#45;&gt;kv_send0_0_5</title>
<path fill="none" stroke="black" d="M789.64,-20041.15C818.09,-20029.7 851.57,-20016.23 880.06,-20004.76"/>
<polygon fill="black" stroke="black" points="881.54,-20007.93 889.51,-20000.95 878.93,-20001.44 881.54,-20007.93"/>
</g>
<!-- ring_stage0_1_5 -->
<g id="node56" class="node">
<title>ring_stage0_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="822.5,-20004.52 629.5,-20004.52 629.5,-19951.52 822.5,-19951.52 822.5,-20004.52"/>
<text text-anchor="middle" x="726" y="-19989.32" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="726" y="-19974.32" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_4×V_4</text>
<text text-anchor="middle" x="726" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_0_5&#45;&gt;ring_stage0_1_5 -->
<g id="edge65" class="edge">
<title>ring_stage0_0_5&#45;&gt;ring_stage0_1_5</title>
<path fill="none" stroke="black" d="M726,-20040.91C726,-20032.7 726,-20023.47 726,-20014.69"/>
<polygon fill="black" stroke="black" points="729.5,-20014.69 726,-20004.69 722.5,-20014.69 729.5,-20014.69"/>
</g>
<!-- kv_send0_0_6 -->
<g id="node41" class="node">
<title>kv_send0_0_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2136" cy="-19888.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2136" y="-19892.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2136" y="-19877.08" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_0_6&#45;&gt;kv_send0_0_6 -->
<g id="edge40" class="edge">
<title>ring_stage0_0_6&#45;&gt;kv_send0_0_6</title>
<path fill="none" stroke="black" d="M1981.64,-19951.41C2010.09,-19939.96 2043.57,-19926.48 2072.06,-19915.02"/>
<polygon fill="black" stroke="black" points="2073.54,-19918.19 2081.51,-19911.21 2070.93,-19911.7 2073.54,-19918.19"/>
</g>
<!-- ring_stage0_1_6 -->
<g id="node57" class="node">
<title>ring_stage0_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1790.5,-19914.78 1597.5,-19914.78 1597.5,-19861.78 1790.5,-19861.78 1790.5,-19914.78"/>
<text text-anchor="middle" x="1694" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1694" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_5×V_5</text>
<text text-anchor="middle" x="1694" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_0_6&#45;&gt;ring_stage0_1_6 -->
<g id="edge68" class="edge">
<title>ring_stage0_0_6&#45;&gt;ring_stage0_1_6</title>
<path fill="none" stroke="black" d="M1852.61,-19951.41C1826.39,-19941.14 1796.02,-19929.24 1768.91,-19918.63"/>
<polygon fill="black" stroke="black" points="1770.06,-19915.32 1759.47,-19914.93 1767.51,-19921.83 1770.06,-19915.32"/>
</g>
<!-- kv_send0_0_7 -->
<g id="node42" class="node">
<title>kv_send0_0_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1259" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1259" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="1259" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_0_7&#45;&gt;kv_send0_0_7 -->
<g id="edge41" class="edge">
<title>ring_stage0_0_7&#45;&gt;kv_send0_0_7</title>
<path fill="none" stroke="black" d="M1108.89,-19861.67C1136.33,-19850.31 1168.57,-19836.97 1196.13,-19825.56"/>
<polygon fill="black" stroke="black" points="1197.76,-19828.68 1205.66,-19821.62 1195.08,-19822.21 1197.76,-19828.68"/>
</g>
<!-- ring_stage0_1_7 -->
<g id="node58" class="node">
<title>ring_stage0_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1797.5,-19825.04 1604.5,-19825.04 1604.5,-19772.04 1797.5,-19772.04 1797.5,-19825.04"/>
<text text-anchor="middle" x="1701" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1701" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_6×V_6</text>
<text text-anchor="middle" x="1701" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_0_7&#45;&gt;ring_stage0_1_7 -->
<g id="edge71" class="edge">
<title>ring_stage0_0_7&#45;&gt;ring_stage0_1_7</title>
<path fill="none" stroke="black" d="M1143.63,-19863.03C1146.79,-19862.45 1149.91,-19861.91 1153,-19861.41 1344.34,-19830.47 1398.64,-19856 1594.33,-19825.39"/>
<polygon fill="black" stroke="black" points="1595.04,-19828.82 1604.37,-19823.79 1593.94,-19821.91 1595.04,-19828.82"/>
</g>
<!-- kv_send0_0_8 -->
<g id="node43" class="node">
<title>kv_send0_0_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1068" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1068" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="1068" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_0_8&#45;&gt;kv_send0_0_8 -->
<g id="edge42" class="edge">
<title>ring_stage0_0_8&#45;&gt;kv_send0_0_8</title>
<path fill="none" stroke="black" d="M1048.95,-19771.69C1051.49,-19763.47 1054.33,-19754.22 1057.04,-19745.42"/>
<polygon fill="black" stroke="black" points="1060.41,-19746.36 1060.01,-19735.77 1053.72,-19744.3 1060.41,-19746.36"/>
</g>
<!-- ring_stage0_1_8 -->
<g id="node59" class="node">
<title>ring_stage0_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1436.5,-19735.3 1243.5,-19735.3 1243.5,-19682.3 1436.5,-19682.3 1436.5,-19735.3"/>
<text text-anchor="middle" x="1340" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1340" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_7×V_7</text>
<text text-anchor="middle" x="1340" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_0_8&#45;&gt;ring_stage0_1_8 -->
<g id="edge74" class="edge">
<title>ring_stage0_0_8&#45;&gt;ring_stage0_1_8</title>
<path fill="none" stroke="black" d="M1128.29,-19771.93C1164.28,-19761.37 1206.14,-19749.08 1243.08,-19738.24"/>
<polygon fill="black" stroke="black" points="1244.25,-19741.55 1252.86,-19735.37 1242.28,-19734.83 1244.25,-19741.55"/>
</g>
<!-- kv_send0_0_9 -->
<g id="node44" class="node">
<title>kv_send0_0_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="681" cy="-19619.06" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="681" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="681" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_0_9&#45;&gt;kv_send0_0_9 -->
<g id="edge43" class="edge">
<title>ring_stage0_0_9&#45;&gt;kv_send0_0_9</title>
<path fill="none" stroke="black" d="M681,-19681.95C681,-19673.9 681,-19664.87 681,-19656.25"/>
<polygon fill="black" stroke="black" points="684.5,-19656.03 681,-19646.03 677.5,-19656.03 684.5,-19656.03"/>
</g>
<!-- ring_stage0_1_9 -->
<g id="node60" class="node">
<title>ring_stage0_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1245.5,-19645.56 1052.5,-19645.56 1052.5,-19592.56 1245.5,-19592.56 1245.5,-19645.56"/>
<text text-anchor="middle" x="1149" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1149" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_8×V_8</text>
<text text-anchor="middle" x="1149" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_0_9&#45;&gt;ring_stage0_1_9 -->
<g id="edge77" class="edge">
<title>ring_stage0_0_9&#45;&gt;ring_stage0_1_9</title>
<path fill="none" stroke="black" d="M777.88,-19692.56C849.84,-19680.86 950.31,-19663.73 1038,-19645.93 1039.45,-19645.64 1040.92,-19645.34 1042.39,-19645.03"/>
<polygon fill="black" stroke="black" points="1043.15,-19648.45 1052.21,-19642.97 1041.7,-19641.6 1043.15,-19648.45"/>
</g>
<!-- kv_send0_0_10 -->
<g id="node45" class="node">
<title>kv_send0_0_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="914" cy="-19529.32" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="914" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="914" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_0_10&#45;&gt;kv_send0_0_10 -->
<g id="edge44" class="edge">
<title>ring_stage0_0_10&#45;&gt;kv_send0_0_10</title>
<path fill="none" stroke="black" d="M917.53,-19592.21C917.07,-19584.16 916.55,-19575.13 916.06,-19566.51"/>
<polygon fill="black" stroke="black" points="919.54,-19566.08 915.48,-19556.29 912.55,-19566.47 919.54,-19566.08"/>
</g>
<!-- ring_stage0_1_10 -->
<g id="node61" class="node">
<title>ring_stage0_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="786,-19555.82 584,-19555.82 584,-19502.82 786,-19502.82 786,-19555.82"/>
<text text-anchor="middle" x="685" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="685" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_9×V_9</text>
<text text-anchor="middle" x="685" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_0_10&#45;&gt;ring_stage0_1_10 -->
<g id="edge80" class="edge">
<title>ring_stage0_0_10&#45;&gt;ring_stage0_1_10</title>
<path fill="none" stroke="black" d="M850.69,-19592.45C823.18,-19582.13 791.29,-19570.18 762.89,-19559.53"/>
<polygon fill="black" stroke="black" points="763.99,-19556.2 753.4,-19555.97 761.53,-19562.76 763.99,-19556.2"/>
</g>
<!-- kv_send0_0_11 -->
<g id="node46" class="node">
<title>kv_send0_0_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="702" cy="-19439.58" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="702" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="702" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_0_11&#45;&gt;kv_send0_0_11 -->
<g id="edge45" class="edge">
<title>ring_stage0_0_11&#45;&gt;kv_send0_0_11</title>
<path fill="none" stroke="black" d="M527.81,-19502.71C560.73,-19490.97 599.59,-19477.11 632.25,-19465.46"/>
<polygon fill="black" stroke="black" points="633.49,-19468.73 641.73,-19462.08 631.14,-19462.14 633.49,-19468.73"/>
</g>
<!-- ring_stage0_1_11 -->
<g id="node62" class="node">
<title>ring_stage0_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="574,-19466.08 354,-19466.08 354,-19413.08 574,-19413.08 574,-19466.08"/>
<text text-anchor="middle" x="464" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="464" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_10×V_10</text>
<text text-anchor="middle" x="464" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_0_11&#45;&gt;ring_stage0_1_11 -->
<g id="edge83" class="edge">
<title>ring_stage0_0_11&#45;&gt;ring_stage0_1_11</title>
<path fill="none" stroke="black" d="M458.36,-19502.47C459.11,-19494.26 459.95,-19485.03 460.75,-19476.25"/>
<polygon fill="black" stroke="black" points="464.24,-19476.52 461.66,-19466.25 457.27,-19475.89 464.24,-19476.52"/>
</g>
<!-- kv_send0_0_12 -->
<g id="node47" class="node">
<title>kv_send0_0_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="446" cy="-19349.84" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="446" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="446" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_0_12&#45;&gt;kv_send0_0_12 -->
<g id="edge46" class="edge">
<title>ring_stage0_0_12&#45;&gt;kv_send0_0_12</title>
<path fill="none" stroke="black" d="M829.84,-19414.33C826.86,-19413.77 823.91,-19413.23 821,-19412.71 707.46,-19392.45 677.53,-19397.08 564,-19376.71 554.25,-19374.96 544.07,-19372.98 533.97,-19370.9"/>
<polygon fill="black" stroke="black" points="534.41,-19367.42 523.9,-19368.81 532.98,-19374.27 534.41,-19367.42"/>
</g>
<!-- ring_stage0_1_12 -->
<g id="node63" class="node">
<title>ring_stage0_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1031,-19376.34 811,-19376.34 811,-19323.34 1031,-19323.34 1031,-19376.34"/>
<text text-anchor="middle" x="921" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="921" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_11×V_11</text>
<text text-anchor="middle" x="921" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_0_12&#45;&gt;ring_stage0_1_12 -->
<g id="edge86" class="edge">
<title>ring_stage0_0_12&#45;&gt;ring_stage0_1_12</title>
<path fill="none" stroke="black" d="M934.4,-19412.73C932.62,-19404.52 930.63,-19395.29 928.72,-19386.51"/>
<polygon fill="black" stroke="black" points="932.1,-19385.54 926.56,-19376.51 925.25,-19387.02 932.1,-19385.54"/>
</g>
<!-- kv_send0_0_13 -->
<g id="node48" class="node">
<title>kv_send0_0_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="664" cy="-20695.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="664" y="-20699.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="664" y="-20684.74" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_0_13&#45;&gt;kv_send0_0_13 -->
<g id="edge47" class="edge">
<title>ring_stage0_0_13&#45;&gt;kv_send0_0_13</title>
<path fill="none" stroke="black" d="M664,-20785.26C664,-20769.95 664,-20750.23 664,-20733.31"/>
<polygon fill="black" stroke="black" points="667.5,-20733.2 664,-20723.2 660.5,-20733.2 667.5,-20733.2"/>
</g>
<!-- ring_stage0_1_13 -->
<g id="node64" class="node">
<title>ring_stage0_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="316,-19286.6 96,-19286.6 96,-19233.6 316,-19233.6 316,-19286.6"/>
<text text-anchor="middle" x="206" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="206" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_12×V_12</text>
<text text-anchor="middle" x="206" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_0_13&#45;&gt;ring_stage0_1_13 -->
<g id="edge89" class="edge">
<title>ring_stage0_0_13&#45;&gt;ring_stage0_1_13</title>
<path fill="none" stroke="black" d="M610.31,-20785.16C585.92,-20770.52 559.35,-20749.67 545,-20722.81 439.61,-20525.65 665.34,-20391.09 521,-20220.37 472.54,-20163.06 405.56,-20240.75 356,-20184.37 321.95,-20145.64 346,-20120.34 346,-20068.76 346,-20068.76 346,-20068.76 346,-19977.02 346,-19844.79 356.06,-19805.13 308,-19681.93 272.49,-19590.89 255.49,-19565.69 181,-19502.45 153.12,-19478.78 126.4,-19497.46 107,-19466.45 73.18,-19412.39 76.09,-19378.75 107,-19322.97 113.76,-19310.78 124.04,-19300.67 135.45,-19292.4"/>
<polygon fill="black" stroke="black" points="137.58,-19295.19 143.93,-19286.71 133.68,-19289.38 137.58,-19295.19"/>
</g>
<!-- kv_send0_0_14 -->
<g id="node49" class="node">
<title>kv_send0_0_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="902" cy="-20606.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="902" y="-20610" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="902" y="-20595" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_0_14&#45;&gt;kv_send0_0_14 -->
<g id="edge48" class="edge">
<title>ring_stage0_0_14&#45;&gt;kv_send0_0_14</title>
<path fill="none" stroke="black" d="M902,-20669.09C902,-20661.04 902,-20652.01 902,-20643.39"/>
<polygon fill="black" stroke="black" points="905.5,-20643.17 902,-20633.17 898.5,-20643.17 905.5,-20643.17"/>
</g>
<!-- ring_stage0_1_14 -->
<g id="node65" class="node">
<title>ring_stage0_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="774,-20632.7 554,-20632.7 554,-20579.7 774,-20579.7 774,-20632.7"/>
<text text-anchor="middle" x="664" y="-20617.5" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="664" y="-20602.5" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_13×V_13</text>
<text text-anchor="middle" x="664" y="-20587.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_0_14&#45;&gt;ring_stage0_1_14 -->
<g id="edge92" class="edge">
<title>ring_stage0_0_14&#45;&gt;ring_stage0_1_14</title>
<path fill="none" stroke="black" d="M832.52,-20669.33C804.54,-20659.01 772.11,-20647.06 743.22,-20636.41"/>
<polygon fill="black" stroke="black" points="744.16,-20633.02 733.57,-20632.85 741.74,-20639.59 744.16,-20633.02"/>
</g>
<!-- kv_send0_0_15 -->
<g id="node50" class="node">
<title>kv_send0_0_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1337" cy="-20516.46" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1337" y="-20520.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1337" y="-20505.26" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_0_15&#45;&gt;kv_send0_0_15 -->
<g id="edge49" class="edge">
<title>ring_stage0_0_15&#45;&gt;kv_send0_0_15</title>
<path fill="none" stroke="black" d="M1197.51,-20579.59C1222.48,-20568.47 1251.74,-20555.44 1276.99,-20544.19"/>
<polygon fill="black" stroke="black" points="1278.74,-20547.24 1286.45,-20539.98 1275.89,-20540.85 1278.74,-20547.24"/>
</g>
<!-- ring_stage0_1_15 -->
<g id="node66" class="node">
<title>ring_stage0_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1184,-20542.96 964,-20542.96 964,-20489.96 1184,-20489.96 1184,-20542.96"/>
<text text-anchor="middle" x="1074" y="-20527.76" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1074" y="-20512.76" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_14×V_14</text>
<text text-anchor="middle" x="1074" y="-20497.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_0_15&#45;&gt;ring_stage0_1_15 -->
<g id="edge95" class="edge">
<title>ring_stage0_0_15&#45;&gt;ring_stage0_1_15</title>
<path fill="none" stroke="black" d="M1120.55,-20579.35C1113.91,-20570.52 1106.37,-20560.5 1099.33,-20551.14"/>
<polygon fill="black" stroke="black" points="1102.11,-20549.02 1093.31,-20543.13 1096.52,-20553.22 1102.11,-20549.02"/>
</g>
<!-- kv_send0_0_0&#45;&gt;ring_stage0_1_1 -->
<g id="edge54" class="edge">
<title>kv_send0_0_0&#45;&gt;ring_stage0_1_1</title>
<path fill="none" stroke="black" d="M2704,-20399.4C2704,-20391.36 2704,-20382.38 2704,-20373.82"/>
<polygon fill="black" stroke="black" points="2707.5,-20373.69 2704,-20363.69 2700.5,-20373.69 2707.5,-20373.69"/>
</g>
<!-- kv_send0_0_1&#45;&gt;ring_stage0_1_2 -->
<g id="edge57" class="edge">
<title>kv_send0_0_1&#45;&gt;ring_stage0_1_2</title>
<path fill="none" stroke="black" d="M2922,-20309.66C2922,-20301.62 2922,-20292.64 2922,-20284.08"/>
<polygon fill="black" stroke="black" points="2925.5,-20283.95 2922,-20273.95 2918.5,-20283.95 2925.5,-20283.95"/>
</g>
<!-- kv_send0_0_2&#45;&gt;ring_stage0_1_3 -->
<g id="edge60" class="edge">
<title>kv_send0_0_2&#45;&gt;ring_stage0_1_3</title>
<path fill="none" stroke="black" d="M3274.54,-20221.8C3288.44,-20211.97 3304.64,-20200.5 3319.41,-20190.05"/>
<polygon fill="black" stroke="black" points="3321.77,-20192.67 3327.92,-20184.04 3317.73,-20186.95 3321.77,-20192.67"/>
</g>
<!-- kv_send0_0_3&#45;&gt;ring_stage0_1_4 -->
<g id="edge63" class="edge">
<title>kv_send0_0_3&#45;&gt;ring_stage0_1_4</title>
<path fill="none" stroke="black" d="M3074.66,-20137.99C3061.23,-20135.09 3047.25,-20132.45 3034,-20130.63 2687.55,-20083.09 2596.17,-20127.28 2248,-20094.63 2223.56,-20092.34 2197.38,-20089.09 2172.71,-20085.67"/>
<polygon fill="black" stroke="black" points="2173,-20082.17 2162.61,-20084.24 2172.03,-20089.11 2173,-20082.17"/>
</g>
<!-- kv_send0_0_4&#45;&gt;ring_stage0_1_5 -->
<g id="edge66" class="edge">
<title>kv_send0_0_4&#45;&gt;ring_stage0_1_5</title>
<path fill="none" stroke="black" d="M889.55,-20044.85C862.13,-20033.81 828.49,-20020.27 798.87,-20008.35"/>
<polygon fill="black" stroke="black" points="799.99,-20005.03 789.41,-20004.54 797.38,-20011.52 799.99,-20005.03"/>
</g>
<!-- kv_send0_0_5&#45;&gt;ring_stage0_1_6 -->
<g id="edge69" class="edge">
<title>kv_send0_0_5&#45;&gt;ring_stage0_1_6</title>
<path fill="none" stroke="black" d="M1044.6,-19971.93C1169.89,-19964.56 1390.5,-19948.22 1587.47,-19915.32"/>
<polygon fill="black" stroke="black" points="1588.14,-19918.76 1597.42,-19913.64 1586.98,-19911.85 1588.14,-19918.76"/>
</g>
<!-- kv_send0_0_6&#45;&gt;ring_stage0_1_7 -->
<g id="edge72" class="edge">
<title>kv_send0_0_6&#45;&gt;ring_stage0_1_7</title>
<path fill="none" stroke="black" d="M2062.04,-19869.51C2049.38,-19866.67 2036.33,-19863.86 2024,-19861.41 1931.19,-19843.01 1904.48,-19844.87 1807.61,-19825.47"/>
<polygon fill="black" stroke="black" points="1808.19,-19822.02 1797.7,-19823.46 1806.8,-19828.88 1808.19,-19822.02"/>
</g>
<!-- kv_send0_0_7&#45;&gt;ring_stage0_1_8 -->
<g id="edge75" class="edge">
<title>kv_send0_0_7&#45;&gt;ring_stage0_1_8</title>
<path fill="none" stroke="black" d="M1282.43,-19772.16C1290.83,-19763.06 1300.44,-19752.65 1309.37,-19742.98"/>
<polygon fill="black" stroke="black" points="1312.13,-19745.15 1316.34,-19735.43 1306.99,-19740.4 1312.13,-19745.15"/>
</g>
<!-- kv_send0_0_8&#45;&gt;ring_stage0_1_9 -->
<g id="edge78" class="edge">
<title>kv_send0_0_8&#45;&gt;ring_stage0_1_9</title>
<path fill="none" stroke="black" d="M1091.43,-19682.42C1099.83,-19673.32 1109.44,-19662.91 1118.37,-19653.24"/>
<polygon fill="black" stroke="black" points="1121.13,-19655.41 1125.34,-19645.69 1115.99,-19650.66 1121.13,-19655.41"/>
</g>
<!-- kv_send0_0_9&#45;&gt;ring_stage0_1_10 -->
<g id="edge81" class="edge">
<title>kv_send0_0_9&#45;&gt;ring_stage0_1_10</title>
<path fill="none" stroke="black" d="M682.2,-19591.74C682.57,-19583.7 682.98,-19574.72 683.37,-19566.16"/>
<polygon fill="black" stroke="black" points="686.87,-19566.17 683.83,-19556.02 679.88,-19565.86 686.87,-19566.17"/>
</g>
<!-- kv_send0_0_10&#45;&gt;ring_stage0_1_11 -->
<g id="edge84" class="edge">
<title>kv_send0_0_10&#45;&gt;ring_stage0_1_11</title>
<path fill="none" stroke="black" d="M835.05,-19510.63C821.7,-19507.79 807.97,-19504.96 795,-19502.45 704.28,-19484.9 678.52,-19484.61 584.15,-19466.64"/>
<polygon fill="black" stroke="black" points="584.66,-19463.17 574.18,-19464.72 583.34,-19470.04 584.66,-19463.17"/>
</g>
<!-- kv_send0_0_11&#45;&gt;ring_stage0_1_12 -->
<g id="edge87" class="edge">
<title>kv_send0_0_11&#45;&gt;ring_stage0_1_12</title>
<path fill="none" stroke="black" d="M757.55,-19416.33C784.87,-19405.38 818.18,-19392.04 847.58,-19380.26"/>
<polygon fill="black" stroke="black" points="848.99,-19383.46 856.98,-19376.49 846.39,-19376.96 848.99,-19383.46"/>
</g>
<!-- kv_send0_0_12&#45;&gt;ring_stage0_1_13 -->
<g id="edge90" class="edge">
<title>kv_send0_0_12&#45;&gt;ring_stage0_1_13</title>
<path fill="none" stroke="black" d="M386.67,-19327.15C356.23,-19316.02 318.71,-19302.31 285.76,-19290.26"/>
<polygon fill="black" stroke="black" points="286.75,-19286.89 276.15,-19286.75 284.34,-19293.47 286.75,-19286.89"/>
</g>
<!-- kv_send0_0_13&#45;&gt;ring_stage0_1_14 -->
<g id="edge93" class="edge">
<title>kv_send0_0_13&#45;&gt;ring_stage0_1_14</title>
<path fill="none" stroke="black" d="M664,-20668.62C664,-20660.58 664,-20651.6 664,-20643.04"/>
<polygon fill="black" stroke="black" points="667.5,-20642.91 664,-20632.91 660.5,-20642.91 667.5,-20642.91"/>
</g>
<!-- kv_send0_0_14&#45;&gt;ring_stage0_1_15 -->
<g id="edge96" class="edge">
<title>kv_send0_0_14&#45;&gt;ring_stage0_1_15</title>
<path fill="none" stroke="black" d="M948.09,-20581.69C968.55,-20571.25 992.89,-20558.84 1014.68,-20547.72"/>
<polygon fill="black" stroke="black" points="1016.53,-20550.71 1023.85,-20543.05 1013.35,-20544.47 1016.53,-20550.71"/>
</g>
<!-- kv_send0_0_15&#45;&gt;ring_stage0_1_0 -->
<g id="edge51" class="edge">
<title>kv_send0_0_15&#45;&gt;ring_stage0_1_0</title>
<path fill="none" stroke="black" d="M1346.43,-20489.61C1349.49,-20481.22 1352.94,-20471.77 1356.2,-20462.82"/>
<polygon fill="black" stroke="black" points="1359.5,-20463.98 1359.64,-20453.39 1352.92,-20461.58 1359.5,-20463.98"/>
</g>
<!-- kv_send0_1_0 -->
<g id="node67" class="node">
<title>kv_send0_1_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1726" cy="-20336.98" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1726" y="-20340.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="1726" y="-20325.78" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_1_0&#45;&gt;kv_send0_1_0 -->
<g id="edge52" class="edge">
<title>ring_stage0_1_0&#45;&gt;kv_send0_1_0</title>
<path fill="none" stroke="black" d="M1473.22,-20400.11C1527.24,-20386.83 1592.32,-20370.84 1642.91,-20358.4"/>
<polygon fill="black" stroke="black" points="1643.95,-20361.75 1652.83,-20355.97 1642.28,-20354.96 1643.95,-20361.75"/>
</g>
<!-- ring_stage0_2_0 -->
<g id="node83" class="node">
<title>ring_stage0_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1367.5,-20363.48 1156.5,-20363.48 1156.5,-20310.48 1367.5,-20310.48 1367.5,-20363.48"/>
<text text-anchor="middle" x="1262" y="-20348.28" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1262" y="-20333.28" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_14×V_14</text>
<text text-anchor="middle" x="1262" y="-20318.28" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_1_0&#45;&gt;ring_stage0_2_0 -->
<g id="edge98" class="edge">
<title>ring_stage0_1_0&#45;&gt;ring_stage0_2_0</title>
<path fill="none" stroke="black" d="M1337.76,-20400.11C1326.33,-20390.73 1313.24,-20380 1301.2,-20370.12"/>
<polygon fill="black" stroke="black" points="1303.41,-20367.42 1293.46,-20363.78 1298.97,-20372.83 1303.41,-20367.42"/>
</g>
<!-- kv_send0_1_1 -->
<g id="node68" class="node">
<title>kv_send0_1_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2704" cy="-20247.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2704" y="-20251.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="2704" y="-20236.04" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_1_1&#45;&gt;kv_send0_1_1 -->
<g id="edge55" class="edge">
<title>ring_stage0_1_1&#45;&gt;kv_send0_1_1</title>
<path fill="none" stroke="black" d="M2704,-20310.13C2704,-20302.08 2704,-20293.05 2704,-20284.43"/>
<polygon fill="black" stroke="black" points="2707.5,-20284.21 2704,-20274.21 2700.5,-20284.21 2707.5,-20284.21"/>
</g>
<!-- ring_stage0_2_1 -->
<g id="node84" class="node">
<title>ring_stage0_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2101.5,-20273.74 1890.5,-20273.74 1890.5,-20220.74 2101.5,-20220.74 2101.5,-20273.74"/>
<text text-anchor="middle" x="1996" y="-20258.54" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1996" y="-20243.54" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_15×V_15</text>
<text text-anchor="middle" x="1996" y="-20228.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_1_1&#45;&gt;ring_stage0_2_1 -->
<g id="edge101" class="edge">
<title>ring_stage0_1_1&#45;&gt;ring_stage0_2_1</title>
<path fill="none" stroke="black" d="M2607.41,-20324.01C2478.39,-20308.02 2250.05,-20279.73 2111.9,-20262.61"/>
<polygon fill="black" stroke="black" points="2112.06,-20259.1 2101.71,-20261.34 2111.2,-20266.05 2112.06,-20259.1"/>
</g>
<!-- kv_send0_1_2 -->
<g id="node69" class="node">
<title>kv_send0_1_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2922" cy="-20157.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2922" y="-20161.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="2922" y="-20146.3" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_1_2&#45;&gt;kv_send0_1_2 -->
<g id="edge58" class="edge">
<title>ring_stage0_1_2&#45;&gt;kv_send0_1_2</title>
<path fill="none" stroke="black" d="M2922,-20220.39C2922,-20212.34 2922,-20203.31 2922,-20194.69"/>
<polygon fill="black" stroke="black" points="2925.5,-20194.47 2922,-20184.47 2918.5,-20194.47 2925.5,-20194.47"/>
</g>
<!-- ring_stage0_2_2 -->
<g id="node85" class="node">
<title>ring_stage0_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2800.5,-20184 2607.5,-20184 2607.5,-20131 2800.5,-20131 2800.5,-20184"/>
<text text-anchor="middle" x="2704" y="-20168.8" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="2704" y="-20153.8" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_0×V_0</text>
<text text-anchor="middle" x="2704" y="-20138.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_1_2&#45;&gt;ring_stage0_2_2 -->
<g id="edge104" class="edge">
<title>ring_stage0_1_2&#45;&gt;ring_stage0_2_2</title>
<path fill="none" stroke="black" d="M2858.36,-20220.63C2832.95,-20210.4 2803.54,-20198.57 2777.25,-20187.99"/>
<polygon fill="black" stroke="black" points="2778.3,-20184.64 2767.72,-20184.15 2775.69,-20191.13 2778.3,-20184.64"/>
</g>
<!-- kv_send0_1_3 -->
<g id="node70" class="node">
<title>kv_send0_1_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3037" cy="-20067.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3037" y="-20071.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3037" y="-20056.56" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_1_3&#45;&gt;kv_send0_1_3 -->
<g id="edge61" class="edge">
<title>ring_stage0_1_3&#45;&gt;kv_send0_1_3</title>
<path fill="none" stroke="black" d="M3268.54,-20130.89C3220.42,-20117.98 3162.73,-20102.5 3116.97,-20090.22"/>
<polygon fill="black" stroke="black" points="3117.66,-20086.78 3107.1,-20087.57 3115.85,-20093.54 3117.66,-20086.78"/>
</g>
<!-- ring_stage0_2_3 -->
<g id="node86" class="node">
<title>ring_stage0_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3351.5,-20094.26 3158.5,-20094.26 3158.5,-20041.26 3351.5,-20041.26 3351.5,-20094.26"/>
<text text-anchor="middle" x="3255" y="-20079.06" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="3255" y="-20064.06" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_1×V_1</text>
<text text-anchor="middle" x="3255" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_1_3&#45;&gt;ring_stage0_2_3 -->
<g id="edge107" class="edge">
<title>ring_stage0_1_3&#45;&gt;ring_stage0_2_3</title>
<path fill="none" stroke="black" d="M3332.18,-20130.89C3320.53,-20121.51 3307.2,-20110.78 3294.93,-20100.9"/>
<polygon fill="black" stroke="black" points="3297.03,-20098.1 3287.05,-20094.56 3292.64,-20103.56 3297.03,-20098.1"/>
</g>
<!-- kv_send0_1_4 -->
<g id="node71" class="node">
<title>kv_send0_1_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1592" cy="-19978.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1592" y="-19981.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1592" y="-19966.82" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_1_4&#45;&gt;kv_send0_1_4 -->
<g id="edge64" class="edge">
<title>ring_stage0_1_4&#45;&gt;kv_send0_1_4</title>
<path fill="none" stroke="black" d="M1969.22,-20048.85C1885.92,-20033.43 1766.52,-20011.33 1684.48,-19996.14"/>
<polygon fill="black" stroke="black" points="1684.89,-19992.66 1674.42,-19994.28 1683.61,-19999.54 1684.89,-19992.66"/>
</g>
<!-- ring_stage0_2_4 -->
<g id="node87" class="node">
<title>ring_stage0_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2687.5,-20004.52 2494.5,-20004.52 2494.5,-19951.52 2687.5,-19951.52 2687.5,-20004.52"/>
<text text-anchor="middle" x="2591" y="-19989.32" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="2591" y="-19974.32" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_2×V_2</text>
<text text-anchor="middle" x="2591" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_1_4&#45;&gt;ring_stage0_2_4 -->
<g id="edge110" class="edge">
<title>ring_stage0_1_4&#45;&gt;ring_stage0_2_4</title>
<path fill="none" stroke="black" d="M2162.94,-20053.07C2265.16,-20038.48 2419.37,-20015.99 2478,-20004.89 2480.09,-20004.5 2482.19,-20004.09 2484.31,-20003.68"/>
<polygon fill="black" stroke="black" points="2485.21,-20007.07 2494.32,-20001.66 2483.83,-20000.2 2485.21,-20007.07"/>
</g>
<!-- kv_send0_1_5 -->
<g id="node72" class="node">
<title>kv_send0_1_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1265" cy="-19888.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1265" y="-19892.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="1265" y="-19877.08" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_1_5&#45;&gt;kv_send0_1_5 -->
<g id="edge67" class="edge">
<title>ring_stage0_1_5&#45;&gt;kv_send0_1_5</title>
<path fill="none" stroke="black" d="M822.65,-19952.89C825.8,-19952.28 828.92,-19951.7 832,-19951.15 973.36,-19926.08 1011.49,-19939.35 1153,-19915.15 1162.52,-19913.53 1172.43,-19911.59 1182.26,-19909.52"/>
<polygon fill="black" stroke="black" points="1183.01,-19912.94 1192.05,-19907.41 1181.53,-19906.1 1183.01,-19912.94"/>
</g>
<!-- ring_stage0_2_5 -->
<g id="node88" class="node">
<title>ring_stage0_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1579.5,-19914.78 1386.5,-19914.78 1386.5,-19861.78 1579.5,-19861.78 1579.5,-19914.78"/>
<text text-anchor="middle" x="1483" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1483" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_3×V_3</text>
<text text-anchor="middle" x="1483" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_1_5&#45;&gt;ring_stage0_2_5 -->
<g id="edge113" class="edge">
<title>ring_stage0_1_5&#45;&gt;ring_stage0_2_5</title>
<path fill="none" stroke="black" d="M822.62,-19952.71C825.78,-19952.15 828.91,-19951.63 832,-19951.15 1068.65,-19914.74 1135.26,-19951.05 1376.25,-19915.13"/>
<polygon fill="black" stroke="black" points="1377.01,-19918.56 1386.38,-19913.6 1375.96,-19911.64 1377.01,-19918.56"/>
</g>
<!-- kv_send0_1_6 -->
<g id="node73" class="node">
<title>kv_send0_1_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2130" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2130" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2130" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_1_6&#45;&gt;kv_send0_1_6 -->
<g id="edge70" class="edge">
<title>ring_stage0_1_6&#45;&gt;kv_send0_1_6</title>
<path fill="none" stroke="black" d="M1790.69,-19863.36C1793.83,-19862.69 1796.94,-19862.04 1800,-19861.41 1896.21,-19841.76 1921.67,-19844.47 2018,-19825.41 2027.15,-19823.6 2036.7,-19821.59 2046.19,-19819.51"/>
<polygon fill="black" stroke="black" points="2047.04,-19822.91 2056.04,-19817.32 2045.52,-19816.07 2047.04,-19822.91"/>
</g>
<!-- ring_stage0_2_6 -->
<g id="node89" class="node">
<title>ring_stage0_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2008.5,-19825.04 1815.5,-19825.04 1815.5,-19772.04 2008.5,-19772.04 2008.5,-19825.04"/>
<text text-anchor="middle" x="1912" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1912" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_4×V_4</text>
<text text-anchor="middle" x="1912" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_1_6&#45;&gt;ring_stage0_2_6 -->
<g id="edge116" class="edge">
<title>ring_stage0_1_6&#45;&gt;ring_stage0_2_6</title>
<path fill="none" stroke="black" d="M1757.64,-19861.67C1783.05,-19851.44 1812.46,-19839.61 1838.75,-19829.02"/>
<polygon fill="black" stroke="black" points="1840.31,-19832.17 1848.28,-19825.19 1837.7,-19825.68 1840.31,-19832.17"/>
</g>
<!-- kv_send0_1_7 -->
<g id="node74" class="node">
<title>kv_send0_1_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1590" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1590" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="1590" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_1_7&#45;&gt;kv_send0_1_7 -->
<g id="edge73" class="edge">
<title>ring_stage0_1_7&#45;&gt;kv_send0_1_7</title>
<path fill="none" stroke="black" d="M1668.6,-19771.93C1656.42,-19762.3 1642.43,-19751.25 1629.67,-19741.16"/>
<polygon fill="black" stroke="black" points="1631.5,-19738.15 1621.49,-19734.69 1627.16,-19743.64 1631.5,-19738.15"/>
</g>
<!-- ring_stage0_2_7 -->
<g id="node90" class="node">
<title>ring_stage0_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2119.5,-19735.3 1926.5,-19735.3 1926.5,-19682.3 2119.5,-19682.3 2119.5,-19735.3"/>
<text text-anchor="middle" x="2023" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="2023" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_5×V_5</text>
<text text-anchor="middle" x="2023" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_1_7&#45;&gt;ring_stage0_2_7 -->
<g id="edge119" class="edge">
<title>ring_stage0_1_7&#45;&gt;ring_stage0_2_7</title>
<path fill="none" stroke="black" d="M1795,-19771.93C1834.02,-19761.3 1879.42,-19748.93 1919.39,-19738.03"/>
<polygon fill="black" stroke="black" points="1920.43,-19741.38 1929.16,-19735.37 1918.59,-19734.62 1920.43,-19741.38"/>
</g>
<!-- kv_send0_1_8 -->
<g id="node75" class="node">
<title>kv_send0_1_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1368" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1368" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="1368" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_1_8&#45;&gt;kv_send0_1_8 -->
<g id="edge76" class="edge">
<title>ring_stage0_1_8&#45;&gt;kv_send0_1_8</title>
<path fill="none" stroke="black" d="M1348.25,-19681.95C1350.87,-19673.73 1353.83,-19664.48 1356.63,-19655.68"/>
<polygon fill="black" stroke="black" points="1360.01,-19656.62 1359.71,-19646.03 1353.34,-19654.49 1360.01,-19656.62"/>
</g>
<!-- ring_stage0_2_8 -->
<g id="node91" class="node">
<title>ring_stage0_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1683.5,-19645.56 1490.5,-19645.56 1490.5,-19592.56 1683.5,-19592.56 1683.5,-19645.56"/>
<text text-anchor="middle" x="1587" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1587" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_6×V_6</text>
<text text-anchor="middle" x="1587" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_1_8&#45;&gt;ring_stage0_2_8 -->
<g id="edge122" class="edge">
<title>ring_stage0_1_8&#45;&gt;ring_stage0_2_8</title>
<path fill="none" stroke="black" d="M1412.11,-19682.19C1441.27,-19671.83 1475.09,-19659.81 1505.18,-19649.13"/>
<polygon fill="black" stroke="black" points="1506.55,-19652.35 1514.8,-19645.71 1504.21,-19645.76 1506.55,-19652.35"/>
</g>
<!-- kv_send0_1_9 -->
<g id="node76" class="node">
<title>kv_send0_1_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1151" cy="-19529.32" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1151" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="1151" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_1_9&#45;&gt;kv_send0_1_9 -->
<g id="edge79" class="edge">
<title>ring_stage0_1_9&#45;&gt;kv_send0_1_9</title>
<path fill="none" stroke="black" d="M1149.59,-19592.21C1149.77,-19584.16 1149.98,-19575.13 1150.18,-19566.51"/>
<polygon fill="black" stroke="black" points="1153.68,-19566.37 1150.41,-19556.29 1146.68,-19566.21 1153.68,-19566.37"/>
</g>
<!-- ring_stage0_2_9 -->
<g id="node92" class="node">
<title>ring_stage0_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1471.5,-19555.82 1278.5,-19555.82 1278.5,-19502.82 1471.5,-19502.82 1471.5,-19555.82"/>
<text text-anchor="middle" x="1375" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1375" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_7×V_7</text>
<text text-anchor="middle" x="1375" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_1_9&#45;&gt;ring_stage0_2_9 -->
<g id="edge125" class="edge">
<title>ring_stage0_1_9&#45;&gt;ring_stage0_2_9</title>
<path fill="none" stroke="black" d="M1214.98,-19592.45C1241.43,-19582.18 1272.07,-19570.28 1299.42,-19559.67"/>
<polygon fill="black" stroke="black" points="1300.89,-19562.85 1308.94,-19555.97 1298.35,-19556.32 1300.89,-19562.85"/>
</g>
<!-- kv_send0_1_10 -->
<g id="node77" class="node">
<title>kv_send0_1_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="226" cy="-19439.58" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="226" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="226" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_1_10&#45;&gt;kv_send0_1_10 -->
<g id="edge82" class="edge">
<title>ring_stage0_1_10&#45;&gt;kv_send0_1_10</title>
<path fill="none" stroke="black" d="M583.77,-19504.21C580.82,-19503.6 577.89,-19503.02 575,-19502.45 473.46,-19482.59 446.71,-19485.45 345,-19466.45 335.08,-19464.6 324.72,-19462.54 314.43,-19460.41"/>
<polygon fill="black" stroke="black" points="315.11,-19456.97 304.6,-19458.35 313.67,-19463.83 315.11,-19456.97"/>
</g>
<!-- ring_stage0_2_10 -->
<g id="node93" class="node">
<title>ring_stage0_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1270,-19466.08 1068,-19466.08 1068,-19413.08 1270,-19413.08 1270,-19466.08"/>
<text text-anchor="middle" x="1169" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="1169" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_8×V_8</text>
<text text-anchor="middle" x="1169" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_1_10&#45;&gt;ring_stage0_2_10 -->
<g id="edge128" class="edge">
<title>ring_stage0_1_10&#45;&gt;ring_stage0_2_10</title>
<path fill="none" stroke="black" d="M786.22,-19504.13C789.17,-19503.55 792.11,-19502.99 795,-19502.45 908.25,-19481.46 940.8,-19487.66 1057.72,-19466.61"/>
<polygon fill="black" stroke="black" points="1058.57,-19470.01 1067.78,-19464.77 1057.32,-19463.13 1058.57,-19470.01"/>
</g>
<!-- kv_send0_1_11 -->
<g id="node78" class="node">
<title>kv_send0_1_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="683" cy="-19349.84" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="683" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="683" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_1_11&#45;&gt;kv_send0_1_11 -->
<g id="edge85" class="edge">
<title>ring_stage0_1_11&#45;&gt;kv_send0_1_11</title>
<path fill="none" stroke="black" d="M527.93,-19412.97C556.29,-19401.61 589.61,-19388.26 618.08,-19376.85"/>
<polygon fill="black" stroke="black" points="619.55,-19380.03 627.54,-19373.06 616.95,-19373.53 619.55,-19380.03"/>
</g>
<!-- ring_stage0_2_11 -->
<g id="node94" class="node">
<title>ring_stage0_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="318,-19376.34 116,-19376.34 116,-19323.34 318,-19323.34 318,-19376.34"/>
<text text-anchor="middle" x="217" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="217" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_9×V_9</text>
<text text-anchor="middle" x="217" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_1_11&#45;&gt;ring_stage0_2_11 -->
<g id="edge131" class="edge">
<title>ring_stage0_1_11&#45;&gt;ring_stage0_2_11</title>
<path fill="none" stroke="black" d="M391.89,-19412.97C362.73,-19402.61 328.91,-19390.59 298.82,-19379.91"/>
<polygon fill="black" stroke="black" points="299.79,-19376.54 289.2,-19376.49 297.45,-19383.13 299.79,-19376.54"/>
</g>
<!-- kv_send0_1_12 -->
<g id="node79" class="node">
<title>kv_send0_1_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="681" cy="-19260.1" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="681" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="681" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_1_12&#45;&gt;kv_send0_1_12 -->
<g id="edge88" class="edge">
<title>ring_stage0_1_12&#45;&gt;kv_send0_1_12</title>
<path fill="none" stroke="black" d="M850.94,-19323.23C819.09,-19311.58 781.53,-19297.85 749.83,-19286.27"/>
<polygon fill="black" stroke="black" points="750.79,-19282.89 740.19,-19282.74 748.38,-19289.46 750.79,-19282.89"/>
</g>
<!-- ring_stage0_2_12 -->
<g id="node95" class="node">
<title>ring_stage0_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1029,-19286.6 809,-19286.6 809,-19233.6 1029,-19233.6 1029,-19286.6"/>
<text text-anchor="middle" x="919" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="919" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_10×V_10</text>
<text text-anchor="middle" x="919" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_1_12&#45;&gt;ring_stage0_2_12 -->
<g id="edge134" class="edge">
<title>ring_stage0_1_12&#45;&gt;ring_stage0_2_12</title>
<path fill="none" stroke="black" d="M920.41,-19322.99C920.22,-19314.78 920.01,-19305.55 919.81,-19296.77"/>
<polygon fill="black" stroke="black" points="923.31,-19296.69 919.59,-19286.77 916.31,-19296.84 923.31,-19296.69"/>
</g>
<!-- kv_send0_1_13 -->
<g id="node80" class="node">
<title>kv_send0_1_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="206" cy="-19170.36" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="206" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="206" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_1_13&#45;&gt;kv_send0_1_13 -->
<g id="edge91" class="edge">
<title>ring_stage0_1_13&#45;&gt;kv_send0_1_13</title>
<path fill="none" stroke="black" d="M206,-19233.25C206,-19225.2 206,-19216.17 206,-19207.55"/>
<polygon fill="black" stroke="black" points="209.5,-19207.33 206,-19197.33 202.5,-19207.33 209.5,-19207.33"/>
</g>
<!-- ring_stage0_2_13 -->
<g id="node96" class="node">
<title>ring_stage0_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="554,-19196.86 334,-19196.86 334,-19143.86 554,-19143.86 554,-19196.86"/>
<text text-anchor="middle" x="444" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="444" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_11×V_11</text>
<text text-anchor="middle" x="444" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_1_13&#45;&gt;ring_stage0_2_13 -->
<g id="edge137" class="edge">
<title>ring_stage0_1_13&#45;&gt;ring_stage0_2_13</title>
<path fill="none" stroke="black" d="M275.48,-19233.49C303.46,-19223.17 335.89,-19211.22 364.78,-19200.57"/>
<polygon fill="black" stroke="black" points="366.26,-19203.75 374.43,-19197.01 363.84,-19197.18 366.26,-19203.75"/>
</g>
<!-- kv_send0_1_14 -->
<g id="node81" class="node">
<title>kv_send0_1_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="773" cy="-20516.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="773" y="-20520.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="773" y="-20505.26" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_1_14&#45;&gt;kv_send0_1_14 -->
<g id="edge94" class="edge">
<title>ring_stage0_1_14&#45;&gt;kv_send0_1_14</title>
<path fill="none" stroke="black" d="M695.82,-20579.59C707.78,-20569.96 721.51,-20558.91 734.05,-20548.82"/>
<polygon fill="black" stroke="black" points="736.48,-20551.35 742.08,-20542.35 732.09,-20545.9 736.48,-20551.35"/>
</g>
<!-- ring_stage0_2_14 -->
<g id="node97" class="node">
<title>ring_stage0_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="296,-19107.12 76,-19107.12 76,-19054.12 296,-19054.12 296,-19107.12"/>
<text text-anchor="middle" x="186" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="186" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_12×V_12</text>
<text text-anchor="middle" x="186" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_1_14&#45;&gt;ring_stage0_2_14 -->
<g id="edge140" class="edge">
<title>ring_stage0_1_14&#45;&gt;ring_stage0_2_14</title>
<path fill="none" stroke="black" d="M641.93,-20579.63C575.59,-20502.37 379.75,-20271.38 334,-20184.37 264.01,-20051.26 282.32,-20003.49 233,-19861.41 171.37,-19683.88 120.11,-19650.48 82,-19466.45 71.57,-19416.09 77,-19402.27 77,-19350.84 77,-19350.84 77,-19350.84 77,-19259.1 77,-19207.53 60.08,-19187.48 87,-19143.49 94.41,-19131.39 105.17,-19121.28 116.89,-19112.98"/>
<polygon fill="black" stroke="black" points="119.15,-19115.68 125.57,-19107.25 115.29,-19109.84 119.15,-19115.68"/>
</g>
<!-- kv_send0_1_15 -->
<g id="node82" class="node">
<title>kv_send0_1_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1092" cy="-20426.72" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1092" y="-20430.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1092" y="-20415.52" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_1_15&#45;&gt;kv_send0_1_15 -->
<g id="edge97" class="edge">
<title>ring_stage0_1_15&#45;&gt;kv_send0_1_15</title>
<path fill="none" stroke="black" d="M1079.3,-20489.61C1080.97,-20481.47 1082.85,-20472.33 1084.63,-20463.63"/>
<polygon fill="black" stroke="black" points="1088.09,-20464.19 1086.67,-20453.69 1081.23,-20462.78 1088.09,-20464.19"/>
</g>
<!-- ring_stage0_2_15 -->
<g id="node98" class="node">
<title>ring_stage0_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="886,-20453.22 666,-20453.22 666,-20400.22 886,-20400.22 886,-20453.22"/>
<text text-anchor="middle" x="776" y="-20438.02" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="776" y="-20423.02" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_13×V_13</text>
<text text-anchor="middle" x="776" y="-20408.02" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_1_15&#45;&gt;ring_stage0_2_15 -->
<g id="edge143" class="edge">
<title>ring_stage0_1_15&#45;&gt;ring_stage0_2_15</title>
<path fill="none" stroke="black" d="M987,-20489.85C951.13,-20479.29 909.41,-20467 872.59,-20456.16"/>
<polygon fill="black" stroke="black" points="873.43,-20452.76 862.85,-20453.29 871.45,-20459.48 873.43,-20452.76"/>
</g>
<!-- kv_send0_1_0&#45;&gt;ring_stage0_2_1 -->
<g id="edge102" class="edge">
<title>kv_send0_1_0&#45;&gt;ring_stage0_2_1</title>
<path fill="none" stroke="black" d="M1788.96,-20315.52C1824.3,-20304.04 1868.95,-20289.53 1907.73,-20276.93"/>
<polygon fill="black" stroke="black" points="1909.03,-20280.19 1917.46,-20273.77 1906.87,-20273.53 1909.03,-20280.19"/>
</g>
<!-- kv_send0_1_1&#45;&gt;ring_stage0_2_2 -->
<g id="edge105" class="edge">
<title>kv_send0_1_1&#45;&gt;ring_stage0_2_2</title>
<path fill="none" stroke="black" d="M2704,-20219.92C2704,-20211.88 2704,-20202.9 2704,-20194.34"/>
<polygon fill="black" stroke="black" points="2707.5,-20194.21 2704,-20184.21 2700.5,-20194.21 2707.5,-20194.21"/>
</g>
<!-- kv_send0_1_2&#45;&gt;ring_stage0_2_3 -->
<g id="edge108" class="edge">
<title>kv_send0_1_2&#45;&gt;ring_stage0_2_3</title>
<path fill="none" stroke="black" d="M2992.62,-20137.9C3037.91,-20125.96 3097.55,-20110.25 3148.53,-20096.82"/>
<polygon fill="black" stroke="black" points="3149.49,-20100.18 3158.27,-20094.25 3147.71,-20093.41 3149.49,-20100.18"/>
</g>
<!-- kv_send0_1_3&#45;&gt;ring_stage0_2_4 -->
<g id="edge111" class="edge">
<title>kv_send0_1_3&#45;&gt;ring_stage0_2_4</title>
<path fill="none" stroke="black" d="M2963.05,-20048.92C2950.39,-20046.09 2937.34,-20043.3 2925,-20040.89 2825.17,-20021.44 2798.75,-20024.75 2699,-20004.89 2698.54,-20004.8 2698.08,-20004.71 2697.61,-20004.62"/>
<polygon fill="black" stroke="black" points="2698.28,-20001.18 2687.77,-20002.59 2696.86,-20008.03 2698.28,-20001.18"/>
</g>
<!-- kv_send0_1_4&#45;&gt;ring_stage0_2_5 -->
<g id="edge114" class="edge">
<title>kv_send0_1_4&#45;&gt;ring_stage0_2_5</title>
<path fill="none" stroke="black" d="M1561.35,-19952.35C1549.47,-19942.79 1535.7,-19931.71 1523.06,-19921.53"/>
<polygon fill="black" stroke="black" points="1524.93,-19918.54 1514.94,-19914.99 1520.54,-19923.99 1524.93,-19918.54"/>
</g>
<!-- kv_send0_1_5&#45;&gt;ring_stage0_2_6 -->
<g id="edge117" class="edge">
<title>kv_send0_1_5&#45;&gt;ring_stage0_2_6</title>
<path fill="none" stroke="black" d="M1337.65,-19869.06C1351.01,-19866.16 1364.88,-19863.46 1378,-19861.41 1563.83,-19832.49 1616.4,-19855.58 1805.44,-19825.56"/>
<polygon fill="black" stroke="black" points="1806.11,-19829 1815.43,-19823.94 1805,-19822.09 1806.11,-19829"/>
</g>
<!-- kv_send0_1_6&#45;&gt;ring_stage0_2_7 -->
<g id="edge120" class="edge">
<title>kv_send0_1_6&#45;&gt;ring_stage0_2_7</title>
<path fill="none" stroke="black" d="M2099.62,-19772.63C2087.97,-19763.08 2074.5,-19752.03 2062.13,-19741.89"/>
<polygon fill="black" stroke="black" points="2064.15,-19739.02 2054.2,-19735.38 2059.71,-19744.43 2064.15,-19739.02"/>
</g>
<!-- kv_send0_1_7&#45;&gt;ring_stage0_2_8 -->
<g id="edge123" class="edge">
<title>kv_send0_1_7&#45;&gt;ring_stage0_2_8</title>
<path fill="none" stroke="black" d="M1589.1,-19681.48C1588.83,-19673.44 1588.52,-19664.46 1588.23,-19655.9"/>
<polygon fill="black" stroke="black" points="1591.72,-19655.64 1587.88,-19645.76 1584.72,-19655.88 1591.72,-19655.64"/>
</g>
<!-- kv_send0_1_8&#45;&gt;ring_stage0_2_9 -->
<g id="edge126" class="edge">
<title>kv_send0_1_8&#45;&gt;ring_stage0_2_9</title>
<path fill="none" stroke="black" d="M1370.1,-19591.74C1370.74,-19583.7 1371.46,-19574.72 1372.14,-19566.16"/>
<polygon fill="black" stroke="black" points="1375.64,-19566.27 1372.95,-19556.02 1368.67,-19565.71 1375.64,-19566.27"/>
</g>
<!-- kv_send0_1_9&#45;&gt;ring_stage0_2_10 -->
<g id="edge129" class="edge">
<title>kv_send0_1_9&#45;&gt;ring_stage0_2_10</title>
<path fill="none" stroke="black" d="M1156.3,-19502.47C1157.99,-19494.26 1159.88,-19485.03 1161.68,-19476.25"/>
<polygon fill="black" stroke="black" points="1165.15,-19476.75 1163.73,-19466.25 1158.3,-19475.34 1165.15,-19476.75"/>
</g>
<!-- kv_send0_1_10&#45;&gt;ring_stage0_2_11 -->
<g id="edge132" class="edge">
<title>kv_send0_1_10&#45;&gt;ring_stage0_2_11</title>
<path fill="none" stroke="black" d="M223.3,-19412.26C222.48,-19404.22 221.55,-19395.24 220.68,-19386.68"/>
<polygon fill="black" stroke="black" points="224.14,-19386.14 219.64,-19376.54 217.18,-19386.85 224.14,-19386.14"/>
</g>
<!-- kv_send0_1_11&#45;&gt;ring_stage0_2_12 -->
<g id="edge135" class="edge">
<title>kv_send0_1_11&#45;&gt;ring_stage0_2_12</title>
<path fill="none" stroke="black" d="M741.64,-19327.04C771.58,-19315.91 808.42,-19302.21 840.75,-19290.19"/>
<polygon fill="black" stroke="black" points="842.03,-19293.45 850.19,-19286.69 839.59,-19286.89 842.03,-19293.45"/>
</g>
<!-- kv_send0_1_12&#45;&gt;ring_stage0_2_13 -->
<g id="edge138" class="edge">
<title>kv_send0_1_12&#45;&gt;ring_stage0_2_13</title>
<path fill="none" stroke="black" d="M622.11,-19237.3C592.04,-19226.17 555.05,-19212.47 522.58,-19200.45"/>
<polygon fill="black" stroke="black" points="523.7,-19197.14 513.11,-19196.95 521.27,-19203.7 523.7,-19197.14"/>
</g>
<!-- kv_send0_1_13&#45;&gt;ring_stage0_2_14 -->
<g id="edge141" class="edge">
<title>kv_send0_1_13&#45;&gt;ring_stage0_2_14</title>
<path fill="none" stroke="black" d="M200.11,-19143.51C198.24,-19135.3 196.13,-19126.07 194.13,-19117.29"/>
<polygon fill="black" stroke="black" points="197.49,-19116.26 191.85,-19107.29 190.66,-19117.82 197.49,-19116.26"/>
</g>
<!-- kv_send0_1_14&#45;&gt;ring_stage0_2_15 -->
<g id="edge144" class="edge">
<title>kv_send0_1_14&#45;&gt;ring_stage0_2_15</title>
<path fill="none" stroke="black" d="M773.9,-20489.14C774.17,-20481.1 774.48,-20472.12 774.77,-20463.56"/>
<polygon fill="black" stroke="black" points="778.28,-20463.54 775.12,-20453.43 771.28,-20463.3 778.28,-20463.54"/>
</g>
<!-- kv_send0_1_15&#45;&gt;ring_stage0_2_0 -->
<g id="edge99" class="edge">
<title>kv_send0_1_15&#45;&gt;ring_stage0_2_0</title>
<path fill="none" stroke="black" d="M1137.11,-20402.44C1157.42,-20391.96 1181.67,-20379.45 1203.37,-20368.25"/>
<polygon fill="black" stroke="black" points="1205.21,-20371.23 1212.49,-20363.54 1202,-20365.01 1205.21,-20371.23"/>
</g>
<!-- kv_send0_2_0 -->
<g id="node99" class="node">
<title>kv_send0_2_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1530" cy="-20247.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1530" y="-20251.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="1530" y="-20236.04" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_2_0&#45;&gt;kv_send0_2_0 -->
<g id="edge100" class="edge">
<title>ring_stage0_2_0&#45;&gt;kv_send0_2_0</title>
<path fill="none" stroke="black" d="M1340.24,-20310.37C1377.4,-20298.2 1421.52,-20283.76 1457.86,-20271.86"/>
<polygon fill="black" stroke="black" points="1458.99,-20275.17 1467.41,-20268.74 1456.81,-20268.52 1458.99,-20275.17"/>
</g>
<!-- ring_stage0_3_0 -->
<g id="node115" class="node">
<title>ring_stage0_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1314.5,-20273.74 1103.5,-20273.74 1103.5,-20220.74 1314.5,-20220.74 1314.5,-20273.74"/>
<text text-anchor="middle" x="1209" y="-20258.54" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1209" y="-20243.54" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_13×V_13</text>
<text text-anchor="middle" x="1209" y="-20228.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_2_0&#45;&gt;ring_stage0_3_0 -->
<g id="edge146" class="edge">
<title>ring_stage0_2_0&#45;&gt;ring_stage0_3_0</title>
<path fill="none" stroke="black" d="M1246.38,-20310.13C1241.16,-20301.48 1235.24,-20291.69 1229.69,-20282.49"/>
<polygon fill="black" stroke="black" points="1232.67,-20280.66 1224.5,-20273.91 1226.68,-20284.28 1232.67,-20280.66"/>
</g>
<!-- kv_send0_2_1 -->
<g id="node100" class="node">
<title>kv_send0_2_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2242" cy="-20157.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2242" y="-20161.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="2242" y="-20146.3" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_2_1&#45;&gt;kv_send0_2_1 -->
<g id="edge103" class="edge">
<title>ring_stage0_2_1&#45;&gt;kv_send0_2_1</title>
<path fill="none" stroke="black" d="M2067.81,-20220.63C2101.12,-20208.75 2140.51,-20194.7 2173.4,-20182.97"/>
<polygon fill="black" stroke="black" points="2174.7,-20186.22 2182.94,-20179.57 2172.35,-20179.63 2174.7,-20186.22"/>
</g>
<!-- ring_stage0_3_1 -->
<g id="node116" class="node">
<title>ring_stage0_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1748.5,-20184 1537.5,-20184 1537.5,-20131 1748.5,-20131 1748.5,-20184"/>
<text text-anchor="middle" x="1643" y="-20168.8" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1643" y="-20153.8" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_14×V_14</text>
<text text-anchor="middle" x="1643" y="-20138.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_2_1&#45;&gt;ring_stage0_3_1 -->
<g id="edge149" class="edge">
<title>ring_stage0_2_1&#45;&gt;ring_stage0_3_1</title>
<path fill="none" stroke="black" d="M1892.95,-20220.63C1849.91,-20209.93 1799.77,-20197.47 1755.75,-20186.53"/>
<polygon fill="black" stroke="black" points="1756.42,-20183.09 1745.87,-20184.07 1754.73,-20189.88 1756.42,-20183.09"/>
</g>
<!-- kv_send0_2_2 -->
<g id="node101" class="node">
<title>kv_send0_2_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2813" cy="-20067.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2813" y="-20071.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="2813" y="-20056.56" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_2_2&#45;&gt;kv_send0_2_2 -->
<g id="edge106" class="edge">
<title>ring_stage0_2_2&#45;&gt;kv_send0_2_2</title>
<path fill="none" stroke="black" d="M2735.82,-20130.89C2747.78,-20121.26 2761.51,-20110.21 2774.05,-20100.12"/>
<polygon fill="black" stroke="black" points="2776.48,-20102.65 2782.08,-20093.65 2772.09,-20097.2 2776.48,-20102.65"/>
</g>
<!-- ring_stage0_3_2 -->
<g id="node117" class="node">
<title>ring_stage0_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2467.5,-20094.26 2256.5,-20094.26 2256.5,-20041.26 2467.5,-20041.26 2467.5,-20094.26"/>
<text text-anchor="middle" x="2362" y="-20079.06" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="2362" y="-20064.06" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_15×V_15</text>
<text text-anchor="middle" x="2362" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_2_2&#45;&gt;ring_stage0_3_2 -->
<g id="edge152" class="edge">
<title>ring_stage0_2_2&#45;&gt;ring_stage0_3_2</title>
<path fill="none" stroke="black" d="M2607.37,-20131.71C2565.04,-20120.85 2515.16,-20108.06 2471.47,-20096.85"/>
<polygon fill="black" stroke="black" points="2472.22,-20093.43 2461.67,-20094.33 2470.48,-20100.21 2472.22,-20093.43"/>
</g>
<!-- kv_send0_2_3 -->
<g id="node102" class="node">
<title>kv_send0_2_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3036" cy="-19978.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3036" y="-19981.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3036" y="-19966.82" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_2_3&#45;&gt;kv_send0_2_3 -->
<g id="edge109" class="edge">
<title>ring_stage0_2_3&#45;&gt;kv_send0_2_3</title>
<path fill="none" stroke="black" d="M3191.07,-20041.15C3162.48,-20029.7 3128.86,-20016.23 3100.24,-20004.76"/>
<polygon fill="black" stroke="black" points="3101.32,-20001.42 3090.74,-20000.95 3098.72,-20007.92 3101.32,-20001.42"/>
</g>
<!-- ring_stage0_3_3 -->
<g id="node118" class="node">
<title>ring_stage0_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3350.5,-20004.52 3157.5,-20004.52 3157.5,-19951.52 3350.5,-19951.52 3350.5,-20004.52"/>
<text text-anchor="middle" x="3254" y="-19989.32" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="3254" y="-19974.32" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_0×V_0</text>
<text text-anchor="middle" x="3254" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_2_3&#45;&gt;ring_stage0_3_3 -->
<g id="edge155" class="edge">
<title>ring_stage0_2_3&#45;&gt;ring_stage0_3_3</title>
<path fill="none" stroke="black" d="M3254.71,-20040.91C3254.61,-20032.7 3254.51,-20023.47 3254.41,-20014.69"/>
<polygon fill="black" stroke="black" points="3257.91,-20014.65 3254.29,-20004.69 3250.91,-20014.73 3257.91,-20014.65"/>
</g>
<!-- kv_send0_2_4 -->
<g id="node103" class="node">
<title>kv_send0_2_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2590" cy="-19888.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2590" y="-19892.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="2590" y="-19877.08" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_2_4&#45;&gt;kv_send0_2_4 -->
<g id="edge112" class="edge">
<title>ring_stage0_2_4&#45;&gt;kv_send0_2_4</title>
<path fill="none" stroke="black" d="M2590.71,-19951.17C2590.61,-19943.12 2590.51,-19934.09 2590.41,-19925.47"/>
<polygon fill="black" stroke="black" points="2593.91,-19925.21 2590.3,-19915.25 2586.91,-19925.29 2593.91,-19925.21"/>
</g>
<!-- ring_stage0_3_4 -->
<g id="node119" class="node">
<title>ring_stage0_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3128.5,-19914.78 2935.5,-19914.78 2935.5,-19861.78 3128.5,-19861.78 3128.5,-19914.78"/>
<text text-anchor="middle" x="3032" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="3032" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_1×V_1</text>
<text text-anchor="middle" x="3032" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_2_4&#45;&gt;ring_stage0_3_4 -->
<g id="edge158" class="edge">
<title>ring_stage0_2_4&#45;&gt;ring_stage0_3_4</title>
<path fill="none" stroke="black" d="M2687.77,-19953.46C2691.56,-19952.66 2695.31,-19951.89 2699,-19951.15 2796.06,-19931.86 2824.11,-19935.05 2925.29,-19915.22"/>
<polygon fill="black" stroke="black" points="2926.18,-19918.61 2935.31,-19913.23 2924.82,-19911.74 2926.18,-19918.61"/>
</g>
<!-- kv_send0_2_5 -->
<g id="node104" class="node">
<title>kv_send0_2_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1483" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1483" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="1483" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_2_5&#45;&gt;kv_send0_2_5 -->
<g id="edge115" class="edge">
<title>ring_stage0_2_5&#45;&gt;kv_send0_2_5</title>
<path fill="none" stroke="black" d="M1483,-19861.43C1483,-19853.38 1483,-19844.35 1483,-19835.73"/>
<polygon fill="black" stroke="black" points="1486.5,-19835.51 1483,-19825.51 1479.5,-19835.51 1486.5,-19835.51"/>
</g>
<!-- ring_stage0_3_5 -->
<g id="node120" class="node">
<title>ring_stage0_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2585.5,-19825.04 2392.5,-19825.04 2392.5,-19772.04 2585.5,-19772.04 2585.5,-19825.04"/>
<text text-anchor="middle" x="2489" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="2489" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_2×V_2</text>
<text text-anchor="middle" x="2489" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_2_5&#45;&gt;ring_stage0_3_5 -->
<g id="edge161" class="edge">
<title>ring_stage0_2_5&#45;&gt;ring_stage0_3_5</title>
<path fill="none" stroke="black" d="M1579.62,-19862.93C1582.77,-19862.38 1585.91,-19861.87 1589,-19861.41 1876.52,-19818.77 1952.26,-19848.56 2242,-19825.41 2288.05,-19821.73 2338.83,-19816.6 2382.3,-19811.88"/>
<polygon fill="black" stroke="black" points="2382.76,-19815.35 2392.32,-19810.78 2382,-19808.39 2382.76,-19815.35"/>
</g>
<!-- kv_send0_2_6 -->
<g id="node105" class="node">
<title>kv_send0_2_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2241" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2241" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2241" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_2_6&#45;&gt;kv_send0_2_6 -->
<g id="edge118" class="edge">
<title>ring_stage0_2_6&#45;&gt;kv_send0_2_6</title>
<path fill="none" stroke="black" d="M2008.04,-19771.93C2056.55,-19758.99 2114.72,-19743.48 2160.8,-19731.19"/>
<polygon fill="black" stroke="black" points="2161.97,-19734.5 2170.73,-19728.54 2160.17,-19727.74 2161.97,-19734.5"/>
</g>
<!-- ring_stage0_3_6 -->
<g id="node121" class="node">
<title>ring_stage0_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1908.5,-19735.3 1715.5,-19735.3 1715.5,-19682.3 1908.5,-19682.3 1908.5,-19735.3"/>
<text text-anchor="middle" x="1812" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1812" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_3×V_3</text>
<text text-anchor="middle" x="1812" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_2_6&#45;&gt;ring_stage0_3_6 -->
<g id="edge164" class="edge">
<title>ring_stage0_2_6&#45;&gt;ring_stage0_3_6</title>
<path fill="none" stroke="black" d="M1882.81,-19771.93C1872.22,-19762.64 1860.12,-19752.02 1848.95,-19742.23"/>
<polygon fill="black" stroke="black" points="1851.23,-19739.56 1841.4,-19735.6 1846.61,-19744.83 1851.23,-19739.56"/>
</g>
<!-- kv_send0_2_7 -->
<g id="node106" class="node">
<title>kv_send0_2_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1805" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1805" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="1805" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_2_7&#45;&gt;kv_send0_2_7 -->
<g id="edge121" class="edge">
<title>ring_stage0_2_7&#45;&gt;kv_send0_2_7</title>
<path fill="none" stroke="black" d="M1959.36,-19682.19C1930.91,-19670.74 1897.43,-19657.26 1868.94,-19645.8"/>
<polygon fill="black" stroke="black" points="1870.07,-19642.48 1859.49,-19641.99 1867.46,-19648.97 1870.07,-19642.48"/>
</g>
<!-- ring_stage0_3_7 -->
<g id="node122" class="node">
<title>ring_stage0_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2343.5,-19645.56 2150.5,-19645.56 2150.5,-19592.56 2343.5,-19592.56 2343.5,-19645.56"/>
<text text-anchor="middle" x="2247" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="2247" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_4×V_4</text>
<text text-anchor="middle" x="2247" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_2_7&#45;&gt;ring_stage0_3_7 -->
<g id="edge167" class="edge">
<title>ring_stage0_2_7&#45;&gt;ring_stage0_3_7</title>
<path fill="none" stroke="black" d="M2088.39,-19682.19C2114.61,-19671.92 2144.98,-19660.02 2172.09,-19649.41"/>
<polygon fill="black" stroke="black" points="2173.49,-19652.61 2181.53,-19645.71 2170.94,-19646.1 2173.49,-19652.61"/>
</g>
<!-- kv_send0_2_8 -->
<g id="node107" class="node">
<title>kv_send0_2_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1593" cy="-19529.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1593" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="1593" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_2_8&#45;&gt;kv_send0_2_8 -->
<g id="edge124" class="edge">
<title>ring_stage0_2_8&#45;&gt;kv_send0_2_8</title>
<path fill="none" stroke="black" d="M1588.77,-19592.21C1589.32,-19584.16 1589.94,-19575.13 1590.53,-19566.51"/>
<polygon fill="black" stroke="black" points="1594.03,-19566.51 1591.22,-19556.29 1587.05,-19566.03 1594.03,-19566.51"/>
</g>
<!-- ring_stage0_3_8 -->
<g id="node123" class="node">
<title>ring_stage0_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1907.5,-19555.82 1714.5,-19555.82 1714.5,-19502.82 1907.5,-19502.82 1907.5,-19555.82"/>
<text text-anchor="middle" x="1811" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1811" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_5×V_5</text>
<text text-anchor="middle" x="1811" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_2_8&#45;&gt;ring_stage0_3_8 -->
<g id="edge170" class="edge">
<title>ring_stage0_2_8&#45;&gt;ring_stage0_3_8</title>
<path fill="none" stroke="black" d="M1652.39,-19592.45C1678.61,-19582.18 1708.98,-19570.28 1736.09,-19559.67"/>
<polygon fill="black" stroke="black" points="1737.49,-19562.87 1745.53,-19555.97 1734.94,-19556.36 1737.49,-19562.87"/>
</g>
<!-- kv_send0_2_9 -->
<g id="node108" class="node">
<title>kv_send0_2_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1398" cy="-19439.58" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1398" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="1398" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_2_9&#45;&gt;kv_send0_2_9 -->
<g id="edge127" class="edge">
<title>ring_stage0_2_9&#45;&gt;kv_send0_2_9</title>
<path fill="none" stroke="black" d="M1381.78,-19502.47C1383.91,-19494.33 1386.31,-19485.19 1388.59,-19476.49"/>
<polygon fill="black" stroke="black" points="1392.04,-19477.11 1391.19,-19466.55 1385.27,-19475.34 1392.04,-19477.11"/>
</g>
<!-- ring_stage0_3_9 -->
<g id="node124" class="node">
<title>ring_stage0_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1718.5,-19466.08 1525.5,-19466.08 1525.5,-19413.08 1718.5,-19413.08 1718.5,-19466.08"/>
<text text-anchor="middle" x="1622" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1622" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_6×V_6</text>
<text text-anchor="middle" x="1622" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_2_9&#45;&gt;ring_stage0_3_9 -->
<g id="edge173" class="edge">
<title>ring_stage0_2_9&#45;&gt;ring_stage0_3_9</title>
<path fill="none" stroke="black" d="M1447.11,-19502.71C1476.27,-19492.35 1510.09,-19480.33 1540.18,-19469.65"/>
<polygon fill="black" stroke="black" points="1541.55,-19472.87 1549.8,-19466.23 1539.21,-19466.28 1541.55,-19472.87"/>
</g>
<!-- kv_send0_2_10 -->
<g id="node109" class="node">
<title>kv_send0_2_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1159" cy="-19349.84" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1159" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="1159" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_2_10&#45;&gt;kv_send0_2_10 -->
<g id="edge130" class="edge">
<title>ring_stage0_2_10&#45;&gt;kv_send0_2_10</title>
<path fill="none" stroke="black" d="M1166.05,-19412.73C1165.13,-19404.59 1164.08,-19395.45 1163.09,-19386.75"/>
<polygon fill="black" stroke="black" points="1166.57,-19386.35 1161.96,-19376.81 1159.61,-19387.14 1166.57,-19386.35"/>
</g>
<!-- ring_stage0_3_10 -->
<g id="node125" class="node">
<title>ring_stage0_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1489,-19376.34 1287,-19376.34 1287,-19323.34 1489,-19323.34 1489,-19376.34"/>
<text text-anchor="middle" x="1388" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1388" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_7×V_7</text>
<text text-anchor="middle" x="1388" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_2_10&#45;&gt;ring_stage0_3_10 -->
<g id="edge176" class="edge">
<title>ring_stage0_2_10&#45;&gt;ring_stage0_3_10</title>
<path fill="none" stroke="black" d="M1232.93,-19412.97C1258.46,-19402.74 1288,-19390.91 1314.41,-19380.32"/>
<polygon fill="black" stroke="black" points="1316.01,-19383.46 1323.99,-19376.49 1313.4,-19376.96 1316.01,-19383.46"/>
</g>
<!-- kv_send0_2_11 -->
<g id="node110" class="node">
<title>kv_send0_2_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="444" cy="-19260.1" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="444" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="444" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_2_11&#45;&gt;kv_send0_2_11 -->
<g id="edge133" class="edge">
<title>ring_stage0_2_11&#45;&gt;kv_send0_2_11</title>
<path fill="none" stroke="black" d="M283.27,-19323.23C312.91,-19311.77 347.78,-19298.29 377.45,-19286.83"/>
<polygon fill="black" stroke="black" points="378.82,-19290.05 386.89,-19283.18 376.3,-19283.52 378.82,-19290.05"/>
</g>
<!-- ring_stage0_3_11 -->
<g id="node126" class="node">
<title>ring_stage0_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1249,-19286.6 1047,-19286.6 1047,-19233.6 1249,-19233.6 1249,-19286.6"/>
<text text-anchor="middle" x="1148" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1148" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_8×V_8</text>
<text text-anchor="middle" x="1148" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_2_11&#45;&gt;ring_stage0_3_11 -->
<g id="edge179" class="edge">
<title>ring_stage0_2_11&#45;&gt;ring_stage0_3_11</title>
<path fill="none" stroke="black" d="M318.16,-19324.33C321.14,-19323.84 324.09,-19323.38 327,-19322.97 636.91,-19279.05 722.88,-19330.25 1036.54,-19287.06"/>
<polygon fill="black" stroke="black" points="1037.42,-19290.47 1046.84,-19285.62 1036.45,-19283.54 1037.42,-19290.47"/>
</g>
<!-- kv_send0_2_12 -->
<g id="node111" class="node">
<title>kv_send0_2_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="682" cy="-19170.36" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="682" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="682" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_2_12&#45;&gt;kv_send0_2_12 -->
<g id="edge136" class="edge">
<title>ring_stage0_2_12&#45;&gt;kv_send0_2_12</title>
<path fill="none" stroke="black" d="M849.81,-19233.49C818.49,-19221.89 781.56,-19208.22 750.34,-19196.66"/>
<polygon fill="black" stroke="black" points="751.44,-19193.34 740.84,-19193.15 749.01,-19199.9 751.44,-19193.34"/>
</g>
<!-- ring_stage0_3_12 -->
<g id="node127" class="node">
<title>ring_stage0_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1012,-19196.86 810,-19196.86 810,-19143.86 1012,-19143.86 1012,-19196.86"/>
<text text-anchor="middle" x="911" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="911" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_9×V_9</text>
<text text-anchor="middle" x="911" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_2_12&#45;&gt;ring_stage0_3_12 -->
<g id="edge182" class="edge">
<title>ring_stage0_2_12&#45;&gt;ring_stage0_3_12</title>
<path fill="none" stroke="black" d="M916.64,-19233.25C915.89,-19225.04 915.05,-19215.81 914.25,-19207.03"/>
<polygon fill="black" stroke="black" points="917.73,-19206.67 913.34,-19197.03 910.76,-19207.3 917.73,-19206.67"/>
</g>
<!-- kv_send0_2_13 -->
<g id="node112" class="node">
<title>kv_send0_2_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="424" cy="-19080.62" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="424" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="424" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_2_13&#45;&gt;kv_send0_2_13 -->
<g id="edge139" class="edge">
<title>ring_stage0_2_13&#45;&gt;kv_send0_2_13</title>
<path fill="none" stroke="black" d="M438.11,-19143.51C436.25,-19135.37 434.17,-19126.23 432.18,-19117.53"/>
<polygon fill="black" stroke="black" points="435.55,-19116.56 429.92,-19107.59 428.73,-19118.12 435.55,-19116.56"/>
</g>
<!-- ring_stage0_3_13 -->
<g id="node128" class="node">
<title>ring_stage0_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="772,-19107.12 552,-19107.12 552,-19054.12 772,-19054.12 772,-19107.12"/>
<text text-anchor="middle" x="662" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="662" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_10×V_10</text>
<text text-anchor="middle" x="662" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_2_13&#45;&gt;ring_stage0_3_13 -->
<g id="edge185" class="edge">
<title>ring_stage0_2_13&#45;&gt;ring_stage0_3_13</title>
<path fill="none" stroke="black" d="M507.64,-19143.75C533.05,-19133.52 562.46,-19121.68 588.75,-19111.1"/>
<polygon fill="black" stroke="black" points="590.31,-19114.25 598.28,-19107.27 587.7,-19107.75 590.31,-19114.25"/>
</g>
<!-- kv_send0_2_14 -->
<g id="node113" class="node">
<title>kv_send0_2_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="186" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="186" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="186" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_2_14&#45;&gt;kv_send0_2_14 -->
<g id="edge142" class="edge">
<title>ring_stage0_2_14&#45;&gt;kv_send0_2_14</title>
<path fill="none" stroke="black" d="M186,-19053.77C186,-19045.72 186,-19036.69 186,-19028.07"/>
<polygon fill="black" stroke="black" points="189.5,-19027.85 186,-19017.85 182.5,-19027.85 189.5,-19027.85"/>
</g>
<!-- ring_stage0_3_14 -->
<g id="node129" class="node">
<title>ring_stage0_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="534,-19017.38 314,-19017.38 314,-18964.38 534,-18964.38 534,-19017.38"/>
<text text-anchor="middle" x="424" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="424" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_11×V_11</text>
<text text-anchor="middle" x="424" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_2_14&#45;&gt;ring_stage0_3_14 -->
<g id="edge188" class="edge">
<title>ring_stage0_2_14&#45;&gt;ring_stage0_3_14</title>
<path fill="none" stroke="black" d="M255.48,-19054.01C283.46,-19043.69 315.89,-19031.74 344.78,-19021.09"/>
<polygon fill="black" stroke="black" points="346.26,-19024.27 354.43,-19017.53 343.84,-19017.7 346.26,-19024.27"/>
</g>
<!-- kv_send0_2_15 -->
<g id="node114" class="node">
<title>kv_send0_2_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="968" cy="-20336.98" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="968" y="-20340.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="968" y="-20325.78" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_2_15&#45;&gt;kv_send0_2_15 -->
<g id="edge145" class="edge">
<title>ring_stage0_2_15&#45;&gt;kv_send0_2_15</title>
<path fill="none" stroke="black" d="M832.05,-20400.11C856.29,-20389.03 884.67,-20376.06 909.21,-20364.85"/>
<polygon fill="black" stroke="black" points="910.77,-20367.98 918.41,-20360.64 907.86,-20361.62 910.77,-20367.98"/>
</g>
<!-- ring_stage0_3_15 -->
<g id="node130" class="node">
<title>ring_stage0_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="277,-18927.64 57,-18927.64 57,-18874.64 277,-18874.64 277,-18927.64"/>
<text text-anchor="middle" x="167" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="167" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_12×V_12</text>
<text text-anchor="middle" x="167" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_2_15&#45;&gt;ring_stage0_3_15 -->
<g id="edge191" class="edge">
<title>ring_stage0_2_15&#45;&gt;ring_stage0_3_15</title>
<path fill="none" stroke="black" d="M717.91,-20400.1C663.34,-20371.61 590,-20319.99 590,-20248.24 590,-20248.24 590,-20248.24 590,-20066.76 590,-20015.19 615.51,-19988.55 580,-19951.15 499.98,-19866.87 421.47,-19973.57 321,-19915.15 190.52,-19839.28 182.88,-19780.23 114,-19645.93 35.1,-19492.08 57,-19434 57,-19261.1 57,-19261.1 57,-19261.1 57,-19079.62 57,-19028.05 39.98,-19007.94 67,-18964.01 74.56,-18951.72 85.57,-18941.5 97.55,-18933.14"/>
<polygon fill="black" stroke="black" points="99.5,-18936.05 105.97,-18927.65 95.68,-18930.18 99.5,-18936.05"/>
</g>
<!-- kv_send0_2_0&#45;&gt;ring_stage0_3_1 -->
<g id="edge150" class="edge">
<title>kv_send0_2_0&#45;&gt;ring_stage0_3_1</title>
<path fill="none" stroke="black" d="M1561.78,-20221.57C1574.21,-20211.92 1588.63,-20200.72 1601.85,-20190.46"/>
<polygon fill="black" stroke="black" points="1604.14,-20193.11 1609.89,-20184.21 1599.84,-20187.58 1604.14,-20193.11"/>
</g>
<!-- kv_send0_2_1&#45;&gt;ring_stage0_3_2 -->
<g id="edge153" class="edge">
<title>kv_send0_2_1&#45;&gt;ring_stage0_3_2</title>
<path fill="none" stroke="black" d="M2275.43,-20132.06C2288.88,-20122.23 2304.56,-20110.76 2318.85,-20100.31"/>
<polygon fill="black" stroke="black" points="2321.07,-20103.02 2327.08,-20094.3 2316.94,-20097.37 2321.07,-20103.02"/>
</g>
<!-- kv_send0_2_2&#45;&gt;ring_stage0_3_3 -->
<g id="edge156" class="edge">
<title>kv_send0_2_2&#45;&gt;ring_stage0_3_3</title>
<path fill="none" stroke="black" d="M2886.95,-20048.94C2899.61,-20046.11 2912.66,-20043.31 2925,-20040.89 3020.44,-20022.19 3047.9,-20024.63 3147.45,-20004.93"/>
<polygon fill="black" stroke="black" points="3148.19,-20008.35 3157.31,-20002.96 3146.82,-20001.49 3148.19,-20008.35"/>
</g>
<!-- kv_send0_2_3&#45;&gt;ring_stage0_3_4 -->
<g id="edge159" class="edge">
<title>kv_send0_2_3&#45;&gt;ring_stage0_3_4</title>
<path fill="none" stroke="black" d="M3034.8,-19950.7C3034.43,-19942.66 3034.02,-19933.68 3033.63,-19925.12"/>
<polygon fill="black" stroke="black" points="3037.12,-19924.82 3033.17,-19914.99 3030.13,-19925.13 3037.12,-19924.82"/>
</g>
<!-- kv_send0_2_4&#45;&gt;ring_stage0_3_5 -->
<g id="edge162" class="edge">
<title>kv_send0_2_4&#45;&gt;ring_stage0_3_5</title>
<path fill="none" stroke="black" d="M2561.33,-19862.37C2550.43,-19852.91 2537.85,-19841.98 2526.27,-19831.92"/>
<polygon fill="black" stroke="black" points="2528.29,-19829.04 2518.45,-19825.12 2523.7,-19834.32 2528.29,-19829.04"/>
</g>
<!-- kv_send0_2_5&#45;&gt;ring_stage0_3_6 -->
<g id="edge165" class="edge">
<title>kv_send0_2_5&#45;&gt;ring_stage0_3_6</title>
<path fill="none" stroke="black" d="M1553.18,-19778.83C1597.76,-19766.94 1656.31,-19751.32 1706.44,-19737.95"/>
<polygon fill="black" stroke="black" points="1707.59,-19741.27 1716.35,-19735.31 1705.78,-19734.51 1707.59,-19741.27"/>
</g>
<!-- kv_send0_2_6&#45;&gt;ring_stage0_3_7 -->
<g id="edge168" class="edge">
<title>kv_send0_2_6&#45;&gt;ring_stage0_3_7</title>
<path fill="none" stroke="black" d="M2242.8,-19681.48C2243.35,-19673.44 2243.96,-19664.46 2244.55,-19655.9"/>
<polygon fill="black" stroke="black" points="2248.05,-19655.98 2245.24,-19645.76 2241.07,-19655.5 2248.05,-19655.98"/>
</g>
<!-- kv_send0_2_7&#45;&gt;ring_stage0_3_8 -->
<g id="edge171" class="edge">
<title>kv_send0_2_7&#45;&gt;ring_stage0_3_8</title>
<path fill="none" stroke="black" d="M1806.8,-19591.74C1807.35,-19583.7 1807.96,-19574.72 1808.55,-19566.16"/>
<polygon fill="black" stroke="black" points="1812.05,-19566.24 1809.24,-19556.02 1805.07,-19565.76 1812.05,-19566.24"/>
</g>
<!-- kv_send0_2_8&#45;&gt;ring_stage0_3_9 -->
<g id="edge174" class="edge">
<title>kv_send0_2_8&#45;&gt;ring_stage0_3_9</title>
<path fill="none" stroke="black" d="M1601.54,-19502.47C1604.29,-19494.17 1607.38,-19484.83 1610.3,-19475.97"/>
<polygon fill="black" stroke="black" points="1613.7,-19476.84 1613.52,-19466.25 1607.06,-19474.64 1613.7,-19476.84"/>
</g>
<!-- kv_send0_2_9&#45;&gt;ring_stage0_3_10 -->
<g id="edge177" class="edge">
<title>kv_send0_2_9&#45;&gt;ring_stage0_3_10</title>
<path fill="none" stroke="black" d="M1395,-19412.26C1394.08,-19404.22 1393.06,-19395.24 1392.08,-19386.68"/>
<polygon fill="black" stroke="black" points="1395.54,-19386.08 1390.93,-19376.54 1388.58,-19386.88 1395.54,-19386.08"/>
</g>
<!-- kv_send0_2_10&#45;&gt;ring_stage0_3_11 -->
<g id="edge180" class="edge">
<title>kv_send0_2_10&#45;&gt;ring_stage0_3_11</title>
<path fill="none" stroke="black" d="M1155.7,-19322.52C1154.69,-19314.48 1153.57,-19305.5 1152.49,-19296.94"/>
<polygon fill="black" stroke="black" points="1155.94,-19296.29 1151.22,-19286.8 1148.99,-19297.16 1155.94,-19296.29"/>
</g>
<!-- kv_send0_2_11&#45;&gt;ring_stage0_3_12 -->
<g id="edge183" class="edge">
<title>kv_send0_2_11&#45;&gt;ring_stage0_3_12</title>
<path fill="none" stroke="black" d="M522.24,-19241.19C535.48,-19238.37 549.11,-19235.61 562,-19233.23 664.54,-19214.29 693.82,-19217.34 799.95,-19197.37"/>
<polygon fill="black" stroke="black" points="800.6,-19200.81 809.77,-19195.5 799.29,-19193.93 800.6,-19200.81"/>
</g>
<!-- kv_send0_2_12&#45;&gt;ring_stage0_3_13 -->
<g id="edge186" class="edge">
<title>kv_send0_2_12&#45;&gt;ring_stage0_3_13</title>
<path fill="none" stroke="black" d="M676.11,-19143.51C674.24,-19135.3 672.13,-19126.07 670.13,-19117.29"/>
<polygon fill="black" stroke="black" points="673.49,-19116.26 667.85,-19107.29 666.66,-19117.82 673.49,-19116.26"/>
</g>
<!-- kv_send0_2_13&#45;&gt;ring_stage0_3_14 -->
<g id="edge189" class="edge">
<title>kv_send0_2_13&#45;&gt;ring_stage0_3_14</title>
<path fill="none" stroke="black" d="M424,-19053.3C424,-19045.26 424,-19036.28 424,-19027.72"/>
<polygon fill="black" stroke="black" points="427.5,-19027.58 424,-19017.58 420.5,-19027.58 427.5,-19027.58"/>
</g>
<!-- kv_send0_2_14&#45;&gt;ring_stage0_3_15 -->
<g id="edge192" class="edge">
<title>kv_send0_2_14&#45;&gt;ring_stage0_3_15</title>
<path fill="none" stroke="black" d="M180.4,-18964.03C178.62,-18955.82 176.63,-18946.59 174.72,-18937.81"/>
<polygon fill="black" stroke="black" points="178.1,-18936.84 172.56,-18927.81 171.25,-18938.32 178.1,-18936.84"/>
</g>
<!-- kv_send0_2_15&#45;&gt;ring_stage0_3_0 -->
<g id="edge147" class="edge">
<title>kv_send0_2_15&#45;&gt;ring_stage0_3_0</title>
<path fill="none" stroke="black" d="M1026.34,-20314.74C1057.15,-20303.53 1095.43,-20289.59 1128.97,-20277.38"/>
<polygon fill="black" stroke="black" points="1130.55,-20280.53 1138.75,-20273.82 1128.16,-20273.95 1130.55,-20280.53"/>
</g>
<!-- kv_send0_3_0 -->
<g id="node131" class="node">
<title>kv_send0_3_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1243" cy="-20157.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1243" y="-20161.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="1243" y="-20146.3" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_3_0&#45;&gt;kv_send0_3_0 -->
<g id="edge148" class="edge">
<title>ring_stage0_3_0&#45;&gt;kv_send0_3_0</title>
<path fill="none" stroke="black" d="M1219.02,-20220.39C1222.24,-20212.08 1225.87,-20202.72 1229.31,-20193.84"/>
<polygon fill="black" stroke="black" points="1232.59,-20195.06 1232.94,-20184.47 1226.06,-20192.53 1232.59,-20195.06"/>
</g>
<!-- ring_stage0_4_0 -->
<g id="node147" class="node">
<title>ring_stage0_4_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="272.5,-18748.16 61.5,-18748.16 61.5,-18695.16 272.5,-18695.16 272.5,-18748.16"/>
<text text-anchor="middle" x="167" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="167" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_12×V_12</text>
<text text-anchor="middle" x="167" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_3_0&#45;&gt;ring_stage0_4_0 -->
<g id="edge194" class="edge">
<title>ring_stage0_3_0&#45;&gt;ring_stage0_4_0</title>
<path fill="none" stroke="black" d="M1103.16,-20231.3C1011.6,-20217.88 886.51,-20198.21 838,-20184.37 737.24,-20155.63 685.59,-20176.34 620,-20094.63 579.48,-20044.15 625.74,-20008.12 595,-19951.15 553.47,-19874.2 374.08,-19739.2 308,-19681.93 288.64,-19665.16 282.14,-19662.95 263,-19645.93 260.35,-19643.57 82.71,-19469.56 81,-19466.45 36.11,-19384.62 37,-19354.44 37,-19261.1 37,-19261.1 37,-19261.1 37,-18900.14 37,-18848.14 25.2,-18827.15 55,-18784.53 63.77,-18771.99 75.94,-18761.71 89.03,-18753.4"/>
<polygon fill="black" stroke="black" points="90.94,-18756.33 97.74,-18748.21 87.36,-18750.32 90.94,-18756.33"/>
</g>
<!-- kv_send0_3_1 -->
<g id="node132" class="node">
<title>kv_send0_3_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1722" cy="-20067.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1722" y="-20071.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="1722" y="-20056.56" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_3_1&#45;&gt;kv_send0_3_1 -->
<g id="edge151" class="edge">
<title>ring_stage0_3_1&#45;&gt;kv_send0_3_1</title>
<path fill="none" stroke="black" d="M1666.28,-20130.65C1674.46,-20121.56 1683.78,-20111.21 1692.42,-20101.62"/>
<polygon fill="black" stroke="black" points="1695.07,-20103.9 1699.16,-20094.13 1689.87,-20099.22 1695.07,-20103.9"/>
</g>
<!-- ring_stage0_4_1 -->
<g id="node148" class="node">
<title>ring_stage0_4_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1429.5,-20094.26 1218.5,-20094.26 1218.5,-20041.26 1429.5,-20041.26 1429.5,-20094.26"/>
<text text-anchor="middle" x="1324" y="-20079.06" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="1324" y="-20064.06" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_13×V_13</text>
<text text-anchor="middle" x="1324" y="-20049.06" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_3_1&#45;&gt;ring_stage0_4_1 -->
<g id="edge197" class="edge">
<title>ring_stage0_3_1&#45;&gt;ring_stage0_4_1</title>
<path fill="none" stroke="black" d="M1549.87,-20130.89C1511.22,-20120.26 1466.24,-20107.89 1426.64,-20097"/>
<polygon fill="black" stroke="black" points="1427.54,-20093.61 1416.97,-20094.33 1425.68,-20100.36 1427.54,-20093.61"/>
</g>
<!-- kv_send0_3_2 -->
<g id="node133" class="node">
<title>kv_send0_3_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2811" cy="-19978.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2811" y="-19981.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="2811" y="-19966.82" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_3_2&#45;&gt;kv_send0_3_2 -->
<g id="edge154" class="edge">
<title>ring_stage0_3_2&#45;&gt;kv_send0_3_2</title>
<path fill="none" stroke="black" d="M2467.54,-20042.77C2470.73,-20042.12 2473.89,-20041.5 2477,-20040.89 2574.26,-20022.01 2599.76,-20023.86 2697,-20004.89 2706.56,-20003.03 2716.54,-20000.95 2726.46,-19998.81"/>
<polygon fill="black" stroke="black" points="2727.3,-20002.21 2736.33,-19996.65 2725.81,-19995.37 2727.3,-20002.21"/>
</g>
<!-- ring_stage0_4_2 -->
<g id="node149" class="node">
<title>ring_stage0_4_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2468.5,-20004.52 2257.5,-20004.52 2257.5,-19951.52 2468.5,-19951.52 2468.5,-20004.52"/>
<text text-anchor="middle" x="2363" y="-19989.32" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="2363" y="-19974.32" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_14×V_14</text>
<text text-anchor="middle" x="2363" y="-19959.32" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_3_2&#45;&gt;ring_stage0_4_2 -->
<g id="edge200" class="edge">
<title>ring_stage0_3_2&#45;&gt;ring_stage0_4_2</title>
<path fill="none" stroke="black" d="M2362.29,-20040.91C2362.39,-20032.7 2362.49,-20023.47 2362.59,-20014.69"/>
<polygon fill="black" stroke="black" points="2366.09,-20014.73 2362.71,-20004.69 2359.09,-20014.65 2366.09,-20014.73"/>
</g>
<!-- kv_send0_3_3 -->
<g id="node134" class="node">
<title>kv_send0_3_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3479" cy="-19888.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3479" y="-19892.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3479" y="-19877.08" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_3_3&#45;&gt;kv_send0_3_3 -->
<g id="edge157" class="edge">
<title>ring_stage0_3_3&#45;&gt;kv_send0_3_3</title>
<path fill="none" stroke="black" d="M3319.68,-19951.41C3349.3,-19939.86 3384.18,-19926.26 3413.74,-19914.73"/>
<polygon fill="black" stroke="black" points="3415.09,-19917.96 3423.13,-19911.07 3412.55,-19911.44 3415.09,-19917.96"/>
</g>
<!-- ring_stage0_4_3 -->
<g id="node150" class="node">
<title>ring_stage0_4_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3357.5,-19914.78 3146.5,-19914.78 3146.5,-19861.78 3357.5,-19861.78 3357.5,-19914.78"/>
<text text-anchor="middle" x="3252" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="3252" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_15×V_15</text>
<text text-anchor="middle" x="3252" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_3_3&#45;&gt;ring_stage0_4_3 -->
<g id="edge203" class="edge">
<title>ring_stage0_3_3&#45;&gt;ring_stage0_4_3</title>
<path fill="none" stroke="black" d="M3253.41,-19951.17C3253.22,-19942.96 3253.01,-19933.73 3252.81,-19924.95"/>
<polygon fill="black" stroke="black" points="3256.31,-19924.87 3252.59,-19914.95 3249.31,-19925.03 3256.31,-19924.87"/>
</g>
<!-- kv_send0_3_4 -->
<g id="node135" class="node">
<title>kv_send0_3_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2933" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2933" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="2933" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_3_4&#45;&gt;kv_send0_3_4 -->
<g id="edge160" class="edge">
<title>ring_stage0_3_4&#45;&gt;kv_send0_3_4</title>
<path fill="none" stroke="black" d="M3003.1,-19861.67C2992.34,-19852.13 2980,-19841.2 2968.71,-19831.19"/>
<polygon fill="black" stroke="black" points="2970.89,-19828.45 2961.08,-19824.43 2966.25,-19833.68 2970.89,-19828.45"/>
</g>
<!-- ring_stage0_4_4 -->
<g id="node151" class="node">
<title>ring_stage0_4_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3477.5,-19825.04 3284.5,-19825.04 3284.5,-19772.04 3477.5,-19772.04 3477.5,-19825.04"/>
<text text-anchor="middle" x="3381" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="3381" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_0×V_0</text>
<text text-anchor="middle" x="3381" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_3_4&#45;&gt;ring_stage0_4_4 -->
<g id="edge206" class="edge">
<title>ring_stage0_3_4&#45;&gt;ring_stage0_4_4</title>
<path fill="none" stroke="black" d="M3128.75,-19862.96C3174.05,-19851.57 3228.12,-19837.98 3274.57,-19826.3"/>
<polygon fill="black" stroke="black" points="3275.52,-19829.67 3284.36,-19823.84 3273.81,-19822.88 3275.52,-19829.67"/>
</g>
<!-- kv_send0_3_5 -->
<g id="node136" class="node">
<title>kv_send0_3_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2485" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2485" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2485" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_3_5&#45;&gt;kv_send0_3_5 -->
<g id="edge163" class="edge">
<title>ring_stage0_3_5&#45;&gt;kv_send0_3_5</title>
<path fill="none" stroke="black" d="M2487.82,-19771.69C2487.45,-19763.64 2487.04,-19754.61 2486.65,-19745.99"/>
<polygon fill="black" stroke="black" points="2490.14,-19745.6 2486.18,-19735.77 2483.14,-19745.92 2490.14,-19745.6"/>
</g>
<!-- ring_stage0_4_5 -->
<g id="node152" class="node">
<title>ring_stage0_4_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2799.5,-19735.3 2606.5,-19735.3 2606.5,-19682.3 2799.5,-19682.3 2799.5,-19735.3"/>
<text text-anchor="middle" x="2703" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="2703" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_1×V_1</text>
<text text-anchor="middle" x="2703" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_3_5&#45;&gt;ring_stage0_4_5 -->
<g id="edge209" class="edge">
<title>ring_stage0_3_5&#45;&gt;ring_stage0_4_5</title>
<path fill="none" stroke="black" d="M2551.47,-19771.93C2576.41,-19761.7 2605.29,-19749.87 2631.09,-19739.28"/>
<polygon fill="black" stroke="black" points="2632.52,-19742.48 2640.45,-19735.45 2629.87,-19736 2632.52,-19742.48"/>
</g>
<!-- kv_send0_3_6 -->
<g id="node137" class="node">
<title>kv_send0_3_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2029" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2029" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2029" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_3_6&#45;&gt;kv_send0_3_6 -->
<g id="edge166" class="edge">
<title>ring_stage0_3_6&#45;&gt;kv_send0_3_6</title>
<path fill="none" stroke="black" d="M1875.35,-19682.19C1903.67,-19670.74 1936.99,-19657.26 1965.35,-19645.8"/>
<polygon fill="black" stroke="black" points="1966.8,-19648.99 1974.76,-19641.99 1964.18,-19642.5 1966.8,-19648.99"/>
</g>
<!-- ring_stage0_4_6 -->
<g id="node153" class="node">
<title>ring_stage0_4_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2581.5,-19645.56 2388.5,-19645.56 2388.5,-19592.56 2581.5,-19592.56 2581.5,-19645.56"/>
<text text-anchor="middle" x="2485" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="2485" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_2×V_2</text>
<text text-anchor="middle" x="2485" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_3_6&#45;&gt;ring_stage0_4_6 -->
<g id="edge212" class="edge">
<title>ring_stage0_3_6&#45;&gt;ring_stage0_4_6</title>
<path fill="none" stroke="black" d="M1908.63,-19683.56C1911.79,-19682.98 1914.91,-19682.43 1918,-19681.93 2109.49,-19650.84 2160.85,-19672.63 2353,-19645.93 2361.23,-19644.79 2369.72,-19643.46 2378.24,-19642.03"/>
<polygon fill="black" stroke="black" points="2378.99,-19645.45 2388.25,-19640.3 2377.8,-19638.55 2378.99,-19645.45"/>
</g>
<!-- kv_send0_3_7 -->
<g id="node138" class="node">
<title>kv_send0_3_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2029" cy="-19529.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2029" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2029" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_3_7&#45;&gt;kv_send0_3_7 -->
<g id="edge169" class="edge">
<title>ring_stage0_3_7&#45;&gt;kv_send0_3_7</title>
<path fill="none" stroke="black" d="M2183.36,-19592.45C2154.91,-19581 2121.43,-19567.52 2092.94,-19556.06"/>
<polygon fill="black" stroke="black" points="2094.07,-19552.74 2083.49,-19552.25 2091.46,-19559.23 2094.07,-19552.74"/>
</g>
<!-- ring_stage0_4_7 -->
<g id="node154" class="node">
<title>ring_stage0_4_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2343.5,-19555.82 2150.5,-19555.82 2150.5,-19502.82 2343.5,-19502.82 2343.5,-19555.82"/>
<text text-anchor="middle" x="2247" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="2247" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_3×V_3</text>
<text text-anchor="middle" x="2247" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_3_7&#45;&gt;ring_stage0_4_7 -->
<g id="edge215" class="edge">
<title>ring_stage0_3_7&#45;&gt;ring_stage0_4_7</title>
<path fill="none" stroke="black" d="M2247,-19592.21C2247,-19584 2247,-19574.77 2247,-19565.99"/>
<polygon fill="black" stroke="black" points="2250.5,-19565.99 2247,-19555.99 2243.5,-19565.99 2250.5,-19565.99"/>
</g>
<!-- kv_send0_3_8 -->
<g id="node139" class="node">
<title>kv_send0_3_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1840" cy="-19439.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1840" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="1840" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_3_8&#45;&gt;kv_send0_3_8 -->
<g id="edge172" class="edge">
<title>ring_stage0_3_8&#45;&gt;kv_send0_3_8</title>
<path fill="none" stroke="black" d="M1819.54,-19502.47C1822.26,-19494.25 1825.32,-19484.99 1828.23,-19476.2"/>
<polygon fill="black" stroke="black" points="1831.6,-19477.14 1831.42,-19466.55 1824.96,-19474.95 1831.6,-19477.14"/>
</g>
<!-- ring_stage0_4_8 -->
<g id="node155" class="node">
<title>ring_stage0_4_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2154.5,-19466.08 1961.5,-19466.08 1961.5,-19413.08 2154.5,-19413.08 2154.5,-19466.08"/>
<text text-anchor="middle" x="2058" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="2058" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_4×V_4</text>
<text text-anchor="middle" x="2058" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_3_8&#45;&gt;ring_stage0_4_8 -->
<g id="edge218" class="edge">
<title>ring_stage0_3_8&#45;&gt;ring_stage0_4_8</title>
<path fill="none" stroke="black" d="M1883.11,-19502.71C1912.27,-19492.35 1946.09,-19480.33 1976.18,-19469.65"/>
<polygon fill="black" stroke="black" points="1977.55,-19472.87 1985.8,-19466.23 1975.21,-19466.28 1977.55,-19472.87"/>
</g>
<!-- kv_send0_3_9 -->
<g id="node140" class="node">
<title>kv_send0_3_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1617" cy="-19349.84" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1617" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="1617" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_3_9&#45;&gt;kv_send0_3_9 -->
<g id="edge175" class="edge">
<title>ring_stage0_3_9&#45;&gt;kv_send0_3_9</title>
<path fill="none" stroke="black" d="M1620.53,-19412.73C1620.07,-19404.68 1619.55,-19395.65 1619.06,-19387.03"/>
<polygon fill="black" stroke="black" points="1622.54,-19386.6 1618.48,-19376.81 1615.55,-19386.99 1622.54,-19386.6"/>
</g>
<!-- ring_stage0_4_9 -->
<g id="node156" class="node">
<title>ring_stage0_4_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1937.5,-19376.34 1744.5,-19376.34 1744.5,-19323.34 1937.5,-19323.34 1937.5,-19376.34"/>
<text text-anchor="middle" x="1841" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="1841" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_5×V_5</text>
<text text-anchor="middle" x="1841" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_3_9&#45;&gt;ring_stage0_4_9 -->
<g id="edge221" class="edge">
<title>ring_stage0_3_9&#45;&gt;ring_stage0_4_9</title>
<path fill="none" stroke="black" d="M1685.93,-19412.97C1711.46,-19402.74 1741,-19390.91 1767.41,-19380.32"/>
<polygon fill="black" stroke="black" points="1769.01,-19383.46 1776.99,-19376.49 1766.4,-19376.96 1769.01,-19383.46"/>
</g>
<!-- kv_send0_3_10 -->
<g id="node141" class="node">
<title>kv_send0_3_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1377" cy="-19260.1" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1377" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="1377" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_3_10&#45;&gt;kv_send0_3_10 -->
<g id="edge178" class="edge">
<title>ring_stage0_3_10&#45;&gt;kv_send0_3_10</title>
<path fill="none" stroke="black" d="M1384.76,-19322.99C1383.74,-19314.85 1382.59,-19305.71 1381.5,-19297.01"/>
<polygon fill="black" stroke="black" points="1384.97,-19296.56 1380.26,-19287.07 1378.03,-19297.43 1384.97,-19296.56"/>
</g>
<!-- ring_stage0_4_10 -->
<g id="node157" class="node">
<title>ring_stage0_4_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1707,-19286.6 1505,-19286.6 1505,-19233.6 1707,-19233.6 1707,-19286.6"/>
<text text-anchor="middle" x="1606" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="1606" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_6×V_6</text>
<text text-anchor="middle" x="1606" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_3_10&#45;&gt;ring_stage0_4_10 -->
<g id="edge224" class="edge">
<title>ring_stage0_3_10&#45;&gt;ring_stage0_4_10</title>
<path fill="none" stroke="black" d="M1451.64,-19323.23C1477.05,-19313 1506.46,-19301.17 1532.75,-19290.58"/>
<polygon fill="black" stroke="black" points="1534.31,-19293.73 1542.28,-19286.75 1531.7,-19287.23 1534.31,-19293.73"/>
</g>
<!-- kv_send0_3_11 -->
<g id="node142" class="node">
<title>kv_send0_3_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1140" cy="-19170.36" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1140" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="1140" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_3_11&#45;&gt;kv_send0_3_11 -->
<g id="edge181" class="edge">
<title>ring_stage0_3_11&#45;&gt;kv_send0_3_11</title>
<path fill="none" stroke="black" d="M1145.64,-19233.25C1144.91,-19225.2 1144.09,-19216.17 1143.3,-19207.55"/>
<polygon fill="black" stroke="black" points="1146.76,-19206.97 1142.37,-19197.33 1139.79,-19207.61 1146.76,-19206.97"/>
</g>
<!-- ring_stage0_4_11 -->
<g id="node158" class="node">
<title>ring_stage0_4_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1470,-19196.86 1268,-19196.86 1268,-19143.86 1470,-19143.86 1470,-19196.86"/>
<text text-anchor="middle" x="1369" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="1369" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_7×V_7</text>
<text text-anchor="middle" x="1369" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_3_11&#45;&gt;ring_stage0_4_11 -->
<g id="edge227" class="edge">
<title>ring_stage0_3_11&#45;&gt;ring_stage0_4_11</title>
<path fill="none" stroke="black" d="M1212.52,-19233.49C1238.39,-19223.22 1268.35,-19211.32 1295.09,-19200.7"/>
<polygon fill="black" stroke="black" points="1296.4,-19203.95 1304.4,-19197.01 1293.82,-19197.44 1296.4,-19203.95"/>
</g>
<!-- kv_send0_3_12 -->
<g id="node143" class="node">
<title>kv_send0_3_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="900" cy="-19080.62" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="900" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="900" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_3_12&#45;&gt;kv_send0_3_12 -->
<g id="edge184" class="edge">
<title>ring_stage0_3_12&#45;&gt;kv_send0_3_12</title>
<path fill="none" stroke="black" d="M907.76,-19143.51C906.74,-19135.37 905.59,-19126.23 904.5,-19117.53"/>
<polygon fill="black" stroke="black" points="907.97,-19117.08 903.26,-19107.59 901.03,-19117.95 907.97,-19117.08"/>
</g>
<!-- ring_stage0_4_12 -->
<g id="node159" class="node">
<title>ring_stage0_4_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1230,-19107.12 1028,-19107.12 1028,-19054.12 1230,-19054.12 1230,-19107.12"/>
<text text-anchor="middle" x="1129" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="1129" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_8×V_8</text>
<text text-anchor="middle" x="1129" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_3_12&#45;&gt;ring_stage0_4_12 -->
<g id="edge230" class="edge">
<title>ring_stage0_3_12&#45;&gt;ring_stage0_4_12</title>
<path fill="none" stroke="black" d="M974.64,-19143.75C1000.05,-19133.52 1029.46,-19121.68 1055.75,-19111.1"/>
<polygon fill="black" stroke="black" points="1057.31,-19114.25 1065.28,-19107.27 1054.7,-19107.75 1057.31,-19114.25"/>
</g>
<!-- kv_send0_3_13 -->
<g id="node144" class="node">
<title>kv_send0_3_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="662" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="662" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="662" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_3_13&#45;&gt;kv_send0_3_13 -->
<g id="edge187" class="edge">
<title>ring_stage0_3_13&#45;&gt;kv_send0_3_13</title>
<path fill="none" stroke="black" d="M662,-19053.77C662,-19045.72 662,-19036.69 662,-19028.07"/>
<polygon fill="black" stroke="black" points="665.5,-19027.85 662,-19017.85 658.5,-19027.85 665.5,-19027.85"/>
</g>
<!-- ring_stage0_4_13 -->
<g id="node160" class="node">
<title>ring_stage0_4_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="992,-19017.38 790,-19017.38 790,-18964.38 992,-18964.38 992,-19017.38"/>
<text text-anchor="middle" x="891" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="891" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_9×V_9</text>
<text text-anchor="middle" x="891" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_3_13&#45;&gt;ring_stage0_4_13 -->
<g id="edge233" class="edge">
<title>ring_stage0_3_13&#45;&gt;ring_stage0_4_13</title>
<path fill="none" stroke="black" d="M728.85,-19054.01C755.66,-19043.74 786.71,-19031.84 814.42,-19021.22"/>
<polygon fill="black" stroke="black" points="815.98,-19024.37 824.07,-19017.53 813.47,-19017.84 815.98,-19024.37"/>
</g>
<!-- kv_send0_3_14 -->
<g id="node145" class="node">
<title>kv_send0_3_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="405" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="405" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="405" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_3_14&#45;&gt;kv_send0_3_14 -->
<g id="edge190" class="edge">
<title>ring_stage0_3_14&#45;&gt;kv_send0_3_14</title>
<path fill="none" stroke="black" d="M418.4,-18964.03C416.64,-18955.89 414.66,-18946.75 412.78,-18938.05"/>
<polygon fill="black" stroke="black" points="416.16,-18937.14 410.62,-18928.11 409.32,-18938.62 416.16,-18937.14"/>
</g>
<!-- ring_stage0_4_14 -->
<g id="node161" class="node">
<title>ring_stage0_4_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="753,-18927.64 533,-18927.64 533,-18874.64 753,-18874.64 753,-18927.64"/>
<text text-anchor="middle" x="643" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="643" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_10×V_10</text>
<text text-anchor="middle" x="643" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_3_14&#45;&gt;ring_stage0_4_14 -->
<g id="edge236" class="edge">
<title>ring_stage0_3_14&#45;&gt;ring_stage0_4_14</title>
<path fill="none" stroke="black" d="M487.93,-18964.27C513.46,-18954.04 543,-18942.2 569.41,-18931.62"/>
<polygon fill="black" stroke="black" points="571.01,-18934.76 578.99,-18927.79 568.4,-18928.26 571.01,-18934.76"/>
</g>
<!-- kv_send0_3_15 -->
<g id="node146" class="node">
<title>kv_send0_3_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="167" cy="-18811.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="167" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="167" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_3_15&#45;&gt;kv_send0_3_15 -->
<g id="edge193" class="edge">
<title>ring_stage0_3_15&#45;&gt;kv_send0_3_15</title>
<path fill="none" stroke="black" d="M167,-18874.29C167,-18866.24 167,-18857.21 167,-18848.59"/>
<polygon fill="black" stroke="black" points="170.5,-18848.37 167,-18838.37 163.5,-18848.37 170.5,-18848.37"/>
</g>
<!-- ring_stage0_4_15 -->
<g id="node162" class="node">
<title>ring_stage0_4_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="509,-18837.9 289,-18837.9 289,-18784.9 509,-18784.9 509,-18837.9"/>
<text text-anchor="middle" x="399" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="399" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_11×V_11</text>
<text text-anchor="middle" x="399" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_3_15&#45;&gt;ring_stage0_4_15 -->
<g id="edge239" class="edge">
<title>ring_stage0_3_15&#45;&gt;ring_stage0_4_15</title>
<path fill="none" stroke="black" d="M234.73,-18874.53C262,-18864.21 293.62,-18852.26 321.78,-18841.61"/>
<polygon fill="black" stroke="black" points="323.07,-18844.86 331.19,-18838.05 320.6,-18838.31 323.07,-18844.86"/>
</g>
<!-- kv_send0_3_0&#45;&gt;ring_stage0_4_1 -->
<g id="edge198" class="edge">
<title>kv_send0_3_0&#45;&gt;ring_stage0_4_1</title>
<path fill="none" stroke="black" d="M1266.43,-20131.13C1274.83,-20122.02 1284.44,-20111.61 1293.37,-20101.94"/>
<polygon fill="black" stroke="black" points="1296.13,-20104.11 1300.34,-20094.39 1290.99,-20099.36 1296.13,-20104.11"/>
</g>
<!-- kv_send0_3_1&#45;&gt;ring_stage0_4_2 -->
<g id="edge201" class="edge">
<title>kv_send0_3_1&#45;&gt;ring_stage0_4_2</title>
<path fill="none" stroke="black" d="M1815.52,-20056.3C1947.58,-20041.45 2179.36,-20015.07 2247.38,-20004.82"/>
<polygon fill="black" stroke="black" points="2248.17,-20008.24 2257.49,-20003.21 2247.07,-20001.32 2248.17,-20008.24"/>
</g>
<!-- kv_send0_3_2&#45;&gt;ring_stage0_4_3 -->
<g id="edge204" class="edge">
<title>kv_send0_3_2&#45;&gt;ring_stage0_4_3</title>
<path fill="none" stroke="black" d="M2885.33,-19959.36C2898.2,-19956.48 2911.46,-19953.64 2924,-19951.15 3015.46,-19933.01 3041.66,-19933.76 3136.44,-19915.41"/>
<polygon fill="black" stroke="black" points="3137.32,-19918.81 3146.46,-19913.45 3135.97,-19911.94 3137.32,-19918.81"/>
</g>
<!-- kv_send0_3_3&#45;&gt;ring_stage0_4_4 -->
<g id="edge207" class="edge">
<title>kv_send0_3_3&#45;&gt;ring_stage0_4_4</title>
<path fill="none" stroke="black" d="M3451.18,-19862.37C3440.6,-19852.91 3428.4,-19841.98 3417.16,-19831.92"/>
<polygon fill="black" stroke="black" points="3419.36,-19829.19 3409.57,-19825.12 3414.69,-19834.4 3419.36,-19829.19"/>
</g>
<!-- kv_send0_3_4&#45;&gt;ring_stage0_4_5 -->
<g id="edge210" class="edge">
<title>kv_send0_3_4&#45;&gt;ring_stage0_4_5</title>
<path fill="none" stroke="black" d="M2876.44,-19775.97C2847.27,-19764.84 2811.27,-19751.1 2779.64,-19739.04"/>
<polygon fill="black" stroke="black" points="2780.56,-19735.65 2769.97,-19735.35 2778.07,-19742.19 2780.56,-19735.65"/>
</g>
<!-- kv_send0_3_5&#45;&gt;ring_stage0_4_6 -->
<g id="edge213" class="edge">
<title>kv_send0_3_5&#45;&gt;ring_stage0_4_6</title>
<path fill="none" stroke="black" d="M2485,-19681.48C2485,-19673.44 2485,-19664.46 2485,-19655.9"/>
<polygon fill="black" stroke="black" points="2488.5,-19655.76 2485,-19645.76 2481.5,-19655.76 2488.5,-19655.76"/>
</g>
<!-- kv_send0_3_6&#45;&gt;ring_stage0_4_7 -->
<g id="edge216" class="edge">
<title>kv_send0_3_6&#45;&gt;ring_stage0_4_7</title>
<path fill="none" stroke="black" d="M2083.45,-19596.15C2110.87,-19585.11 2144.51,-19571.57 2174.13,-19559.65"/>
<polygon fill="black" stroke="black" points="2175.62,-19562.82 2183.59,-19555.84 2173.01,-19556.33 2175.62,-19562.82"/>
</g>
<!-- kv_send0_3_7&#45;&gt;ring_stage0_4_8 -->
<g id="edge219" class="edge">
<title>kv_send0_3_7&#45;&gt;ring_stage0_4_8</title>
<path fill="none" stroke="black" d="M2037.54,-19502.47C2040.29,-19494.17 2043.38,-19484.83 2046.3,-19475.97"/>
<polygon fill="black" stroke="black" points="2049.7,-19476.84 2049.52,-19466.25 2043.06,-19474.64 2049.7,-19476.84"/>
</g>
<!-- kv_send0_3_8&#45;&gt;ring_stage0_4_9 -->
<g id="edge222" class="edge">
<title>kv_send0_3_8&#45;&gt;ring_stage0_4_9</title>
<path fill="none" stroke="black" d="M1840.3,-19412.26C1840.39,-19404.22 1840.49,-19395.24 1840.59,-19386.68"/>
<polygon fill="black" stroke="black" points="1844.09,-19386.58 1840.71,-19376.54 1837.09,-19386.5 1844.09,-19386.58"/>
</g>
<!-- kv_send0_3_9&#45;&gt;ring_stage0_4_10 -->
<g id="edge225" class="edge">
<title>kv_send0_3_9&#45;&gt;ring_stage0_4_10</title>
<path fill="none" stroke="black" d="M1613.7,-19322.52C1612.69,-19314.48 1611.57,-19305.5 1610.49,-19296.94"/>
<polygon fill="black" stroke="black" points="1613.94,-19296.29 1609.22,-19286.8 1606.99,-19297.16 1613.94,-19296.29"/>
</g>
<!-- kv_send0_3_10&#45;&gt;ring_stage0_4_11 -->
<g id="edge228" class="edge">
<title>kv_send0_3_10&#45;&gt;ring_stage0_4_11</title>
<path fill="none" stroke="black" d="M1374.6,-19232.78C1373.87,-19224.74 1373.05,-19215.76 1372.27,-19207.2"/>
<polygon fill="black" stroke="black" points="1375.74,-19206.71 1371.34,-19197.06 1368.77,-19207.34 1375.74,-19206.71"/>
</g>
<!-- kv_send0_3_11&#45;&gt;ring_stage0_4_12 -->
<g id="edge231" class="edge">
<title>kv_send0_3_11&#45;&gt;ring_stage0_4_12</title>
<path fill="none" stroke="black" d="M1136.7,-19143.04C1135.69,-19135 1134.57,-19126.02 1133.49,-19117.46"/>
<polygon fill="black" stroke="black" points="1136.94,-19116.81 1132.22,-19107.32 1129.99,-19117.68 1136.94,-19116.81"/>
</g>
<!-- kv_send0_3_12&#45;&gt;ring_stage0_4_13 -->
<g id="edge234" class="edge">
<title>kv_send0_3_12&#45;&gt;ring_stage0_4_13</title>
<path fill="none" stroke="black" d="M897.3,-19053.3C896.48,-19045.26 895.55,-19036.28 894.68,-19027.72"/>
<polygon fill="black" stroke="black" points="898.14,-19027.17 893.64,-19017.58 891.18,-19027.89 898.14,-19027.17"/>
</g>
<!-- kv_send0_3_13&#45;&gt;ring_stage0_4_14 -->
<g id="edge237" class="edge">
<title>kv_send0_3_13&#45;&gt;ring_stage0_4_14</title>
<path fill="none" stroke="black" d="M656.4,-18964.03C654.62,-18955.82 652.63,-18946.59 650.72,-18937.81"/>
<polygon fill="black" stroke="black" points="654.1,-18936.84 648.56,-18927.81 647.25,-18938.32 654.1,-18936.84"/>
</g>
<!-- kv_send0_3_14&#45;&gt;ring_stage0_4_15 -->
<g id="edge240" class="edge">
<title>kv_send0_3_14&#45;&gt;ring_stage0_4_15</title>
<path fill="none" stroke="black" d="M403.2,-18873.82C402.65,-18865.78 402.04,-18856.8 401.45,-18848.24"/>
<polygon fill="black" stroke="black" points="404.93,-18847.84 400.76,-18838.1 397.95,-18848.32 404.93,-18847.84"/>
</g>
<!-- kv_send0_3_15&#45;&gt;ring_stage0_4_0 -->
<g id="edge195" class="edge">
<title>kv_send0_3_15&#45;&gt;ring_stage0_4_0</title>
<path fill="none" stroke="black" d="M167,-18784.08C167,-18776.04 167,-18767.06 167,-18758.5"/>
<polygon fill="black" stroke="black" points="170.5,-18758.36 167,-18748.36 163.5,-18758.36 170.5,-18758.36"/>
</g>
<!-- kv_send0_4_0 -->
<g id="node163" class="node">
<title>kv_send0_4_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="167" cy="-18631.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="167" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="167" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_4_0&#45;&gt;kv_send0_4_0 -->
<g id="edge196" class="edge">
<title>ring_stage0_4_0&#45;&gt;kv_send0_4_0</title>
<path fill="none" stroke="black" d="M167,-18694.81C167,-18686.76 167,-18677.73 167,-18669.11"/>
<polygon fill="black" stroke="black" points="170.5,-18668.89 167,-18658.89 163.5,-18668.89 170.5,-18668.89"/>
</g>
<!-- ring_stage0_5_0 -->
<g id="node179" class="node">
<title>ring_stage0_5_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="499.5,-18658.42 288.5,-18658.42 288.5,-18605.42 499.5,-18605.42 499.5,-18658.42"/>
<text text-anchor="middle" x="394" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="394" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_11×V_11</text>
<text text-anchor="middle" x="394" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_4_0&#45;&gt;ring_stage0_5_0 -->
<g id="edge242" class="edge">
<title>ring_stage0_4_0&#45;&gt;ring_stage0_5_0</title>
<path fill="none" stroke="black" d="M233.27,-18695.05C259.84,-18684.78 290.62,-18672.88 318.08,-18662.26"/>
<polygon fill="black" stroke="black" points="319.58,-18665.44 327.65,-18658.57 317.06,-18658.91 319.58,-18665.44"/>
</g>
<!-- kv_send0_4_1 -->
<g id="node164" class="node">
<title>kv_send0_4_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2136" cy="-19978.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2136" y="-19981.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="2136" y="-19966.82" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_4_1&#45;&gt;kv_send0_4_1 -->
<g id="edge199" class="edge">
<title>ring_stage0_4_1&#45;&gt;kv_send0_4_1</title>
<path fill="none" stroke="black" d="M1429.6,-20057.12C1483.56,-20052.22 1550.28,-20046.19 1610,-20040.89 1793.97,-20024.57 1841.57,-20033.75 2024,-20004.89 2033.68,-20003.36 2043.77,-20001.46 2053.76,-19999.4"/>
<polygon fill="black" stroke="black" points="2054.64,-20002.79 2063.69,-19997.29 2053.18,-19995.94 2054.64,-20002.79"/>
</g>
<!-- ring_stage0_5_1 -->
<g id="node180" class="node">
<title>ring_stage0_5_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="272.5,-18568.68 61.5,-18568.68 61.5,-18515.68 272.5,-18515.68 272.5,-18568.68"/>
<text text-anchor="middle" x="167" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="167" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_12×V_12</text>
<text text-anchor="middle" x="167" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_4_1&#45;&gt;ring_stage0_5_1 -->
<g id="edge245" class="edge">
<title>ring_stage0_4_1&#45;&gt;ring_stage0_5_1</title>
<path fill="none" stroke="black" d="M1272.72,-20041.24C1219.58,-20015.61 1133.58,-19976.39 1056,-19951.15 727,-19844.15 596.18,-19927.09 308,-19735.67 101.91,-19598.78 17,-19508.52 17,-19261.1 17,-19261.1 17,-19261.1 17,-18720.66 17,-18666.57 20.5,-18646.7 55,-18605.05 65.33,-18592.58 78.85,-18582.2 92.91,-18573.73"/>
<polygon fill="black" stroke="black" points="94.77,-18576.7 101.72,-18568.7 91.3,-18570.62 94.77,-18576.7"/>
</g>
<!-- kv_send0_4_2 -->
<g id="node165" class="node">
<title>kv_send0_4_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2814" cy="-19888.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2814" y="-19892.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="2814" y="-19877.08" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_4_2&#45;&gt;kv_send0_4_2 -->
<g id="edge202" class="edge">
<title>ring_stage0_4_2&#45;&gt;kv_send0_4_2</title>
<path fill="none" stroke="black" d="M2468.62,-19954.51C2474.49,-19953.35 2480.32,-19952.22 2486,-19951.15 2581.64,-19933.13 2606.54,-19934.11 2702,-19915.15 2711.15,-19913.33 2720.7,-19911.32 2730.19,-19909.24"/>
<polygon fill="black" stroke="black" points="2731.03,-19912.63 2740.04,-19907.05 2729.52,-19905.8 2731.03,-19912.63"/>
</g>
<!-- ring_stage0_5_2 -->
<g id="node181" class="node">
<title>ring_stage0_5_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2468.5,-19914.78 2257.5,-19914.78 2257.5,-19861.78 2468.5,-19861.78 2468.5,-19914.78"/>
<text text-anchor="middle" x="2363" y="-19899.58" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2363" y="-19884.58" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_13×V_13</text>
<text text-anchor="middle" x="2363" y="-19869.58" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_4_2&#45;&gt;ring_stage0_5_2 -->
<g id="edge248" class="edge">
<title>ring_stage0_4_2&#45;&gt;ring_stage0_5_2</title>
<path fill="none" stroke="black" d="M2363,-19951.17C2363,-19942.96 2363,-19933.73 2363,-19924.95"/>
<polygon fill="black" stroke="black" points="2366.5,-19924.95 2363,-19914.95 2359.5,-19924.95 2366.5,-19924.95"/>
</g>
<!-- kv_send0_4_3 -->
<g id="node166" class="node">
<title>kv_send0_4_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3599" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3599" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3599" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_4_3&#45;&gt;kv_send0_4_3 -->
<g id="edge205" class="edge">
<title>ring_stage0_4_3&#45;&gt;kv_send0_4_3</title>
<path fill="none" stroke="black" d="M3353.3,-19861.67C3405.33,-19848.51 3467.9,-19832.69 3516.87,-19820.31"/>
<polygon fill="black" stroke="black" points="3517.96,-19823.64 3526.8,-19817.8 3516.24,-19816.86 3517.96,-19823.64"/>
</g>
<!-- ring_stage0_5_3 -->
<g id="node182" class="node">
<title>ring_stage0_5_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3266.5,-19825.04 3055.5,-19825.04 3055.5,-19772.04 3266.5,-19772.04 3266.5,-19825.04"/>
<text text-anchor="middle" x="3161" y="-19809.84" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="3161" y="-19794.84" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_14×V_14</text>
<text text-anchor="middle" x="3161" y="-19779.84" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_4_3&#45;&gt;ring_stage0_5_3 -->
<g id="edge251" class="edge">
<title>ring_stage0_4_3&#45;&gt;ring_stage0_5_3</title>
<path fill="none" stroke="black" d="M3225.19,-19861.43C3215.75,-19852.33 3205.01,-19841.97 3195.05,-19832.37"/>
<polygon fill="black" stroke="black" points="3197.25,-19829.63 3187.62,-19825.21 3192.39,-19834.67 3197.25,-19829.63"/>
</g>
<!-- kv_send0_4_4 -->
<g id="node167" class="node">
<title>kv_send0_4_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3150" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3150" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="3150" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_4_4&#45;&gt;kv_send0_4_4 -->
<g id="edge208" class="edge">
<title>ring_stage0_4_4&#45;&gt;kv_send0_4_4</title>
<path fill="none" stroke="black" d="M3313.56,-19771.93C3282.92,-19760.29 3246.79,-19746.56 3216.28,-19734.98"/>
<polygon fill="black" stroke="black" points="3217.18,-19731.58 3206.59,-19731.3 3214.7,-19738.12 3217.18,-19731.58"/>
</g>
<!-- ring_stage0_5_4 -->
<g id="node183" class="node">
<title>ring_stage0_5_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3706.5,-19735.3 3495.5,-19735.3 3495.5,-19682.3 3706.5,-19682.3 3706.5,-19735.3"/>
<text text-anchor="middle" x="3601" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="3601" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_15×V_15</text>
<text text-anchor="middle" x="3601" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_4_4&#45;&gt;ring_stage0_5_4 -->
<g id="edge254" class="edge">
<title>ring_stage0_4_4&#45;&gt;ring_stage0_5_4</title>
<path fill="none" stroke="black" d="M3445.22,-19771.93C3470.87,-19761.7 3500.55,-19749.87 3527.08,-19739.28"/>
<polygon fill="black" stroke="black" points="3528.7,-19742.4 3536.7,-19735.45 3526.11,-19735.9 3528.7,-19742.4"/>
</g>
<!-- kv_send0_4_5 -->
<g id="node168" class="node">
<title>kv_send0_4_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2703" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2703" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2703" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_4_5&#45;&gt;kv_send0_4_5 -->
<g id="edge211" class="edge">
<title>ring_stage0_4_5&#45;&gt;kv_send0_4_5</title>
<path fill="none" stroke="black" d="M2703,-19681.95C2703,-19673.9 2703,-19664.87 2703,-19656.25"/>
<polygon fill="black" stroke="black" points="2706.5,-19656.03 2703,-19646.03 2699.5,-19656.03 2706.5,-19656.03"/>
</g>
<!-- ring_stage0_5_5 -->
<g id="node184" class="node">
<title>ring_stage0_5_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3038.5,-19645.56 2845.5,-19645.56 2845.5,-19592.56 3038.5,-19592.56 3038.5,-19645.56"/>
<text text-anchor="middle" x="2942" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2942" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_0×V_0</text>
<text text-anchor="middle" x="2942" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_4_5&#45;&gt;ring_stage0_5_5 -->
<g id="edge257" class="edge">
<title>ring_stage0_4_5&#45;&gt;ring_stage0_5_5</title>
<path fill="none" stroke="black" d="M2772.77,-19682.19C2800.87,-19671.87 2833.44,-19659.92 2862.45,-19649.27"/>
<polygon fill="black" stroke="black" points="2863.96,-19652.44 2872.14,-19645.71 2861.55,-19645.87 2863.96,-19652.44"/>
</g>
<!-- kv_send0_4_6 -->
<g id="node169" class="node">
<title>kv_send0_4_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2485" cy="-19529.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2485" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2485" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_4_6&#45;&gt;kv_send0_4_6 -->
<g id="edge214" class="edge">
<title>ring_stage0_4_6&#45;&gt;kv_send0_4_6</title>
<path fill="none" stroke="black" d="M2485,-19592.21C2485,-19584.16 2485,-19575.13 2485,-19566.51"/>
<polygon fill="black" stroke="black" points="2488.5,-19566.29 2485,-19556.29 2481.5,-19566.29 2488.5,-19566.29"/>
</g>
<!-- ring_stage0_5_6 -->
<g id="node185" class="node">
<title>ring_stage0_5_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2799.5,-19555.82 2606.5,-19555.82 2606.5,-19502.82 2799.5,-19502.82 2799.5,-19555.82"/>
<text text-anchor="middle" x="2703" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2703" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_1×V_1</text>
<text text-anchor="middle" x="2703" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_4_6&#45;&gt;ring_stage0_5_6 -->
<g id="edge260" class="edge">
<title>ring_stage0_4_6&#45;&gt;ring_stage0_5_6</title>
<path fill="none" stroke="black" d="M2548.64,-19592.45C2574.05,-19582.22 2603.46,-19570.39 2629.75,-19559.8"/>
<polygon fill="black" stroke="black" points="2631.31,-19562.95 2639.28,-19555.97 2628.7,-19556.45 2631.31,-19562.95"/>
</g>
<!-- kv_send0_4_7 -->
<g id="node170" class="node">
<title>kv_send0_4_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2276" cy="-19439.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2276" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2276" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_4_7&#45;&gt;kv_send0_4_7 -->
<g id="edge217" class="edge">
<title>ring_stage0_4_7&#45;&gt;kv_send0_4_7</title>
<path fill="none" stroke="black" d="M2255.54,-19502.47C2258.26,-19494.25 2261.32,-19484.99 2264.23,-19476.2"/>
<polygon fill="black" stroke="black" points="2267.6,-19477.14 2267.42,-19466.55 2260.96,-19474.95 2267.6,-19477.14"/>
</g>
<!-- ring_stage0_5_7 -->
<g id="node186" class="node">
<title>ring_stage0_5_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2611.5,-19466.08 2418.5,-19466.08 2418.5,-19413.08 2611.5,-19413.08 2611.5,-19466.08"/>
<text text-anchor="middle" x="2515" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2515" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_2×V_2</text>
<text text-anchor="middle" x="2515" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_4_7&#45;&gt;ring_stage0_5_7 -->
<g id="edge263" class="edge">
<title>ring_stage0_4_7&#45;&gt;ring_stage0_5_7</title>
<path fill="none" stroke="black" d="M2325.24,-19502.71C2357.16,-19492.26 2394.22,-19480.13 2427.07,-19469.37"/>
<polygon fill="black" stroke="black" points="2428.25,-19472.67 2436.67,-19466.23 2426.07,-19466.01 2428.25,-19472.67"/>
</g>
<!-- kv_send0_4_8 -->
<g id="node171" class="node">
<title>kv_send0_4_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2059" cy="-19349.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2059" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="2059" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_4_8&#45;&gt;kv_send0_4_8 -->
<g id="edge220" class="edge">
<title>ring_stage0_4_8&#45;&gt;kv_send0_4_8</title>
<path fill="none" stroke="black" d="M2058.29,-19412.73C2058.39,-19404.68 2058.49,-19395.65 2058.59,-19387.03"/>
<polygon fill="black" stroke="black" points="2062.09,-19386.85 2058.7,-19376.81 2055.09,-19386.77 2062.09,-19386.85"/>
</g>
<!-- ring_stage0_5_8 -->
<g id="node187" class="node">
<title>ring_stage0_5_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2375.5,-19376.34 2182.5,-19376.34 2182.5,-19323.34 2375.5,-19323.34 2375.5,-19376.34"/>
<text text-anchor="middle" x="2279" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2279" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_3×V_3</text>
<text text-anchor="middle" x="2279" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_4_8&#45;&gt;ring_stage0_5_8 -->
<g id="edge266" class="edge">
<title>ring_stage0_4_8&#45;&gt;ring_stage0_5_8</title>
<path fill="none" stroke="black" d="M2122.52,-19412.97C2148.39,-19402.7 2178.35,-19390.8 2205.09,-19380.18"/>
<polygon fill="black" stroke="black" points="2206.4,-19383.43 2214.4,-19376.49 2203.82,-19376.92 2206.4,-19383.43"/>
</g>
<!-- kv_send0_4_9 -->
<g id="node172" class="node">
<title>kv_send0_4_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1835" cy="-19260.1" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1835" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="1835" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_4_9&#45;&gt;kv_send0_4_9 -->
<g id="edge223" class="edge">
<title>ring_stage0_4_9&#45;&gt;kv_send0_4_9</title>
<path fill="none" stroke="black" d="M1839.23,-19322.99C1838.68,-19314.94 1838.06,-19305.91 1837.47,-19297.29"/>
<polygon fill="black" stroke="black" points="1840.95,-19296.81 1836.78,-19287.07 1833.97,-19297.29 1840.95,-19296.81"/>
</g>
<!-- ring_stage0_5_9 -->
<g id="node188" class="node">
<title>ring_stage0_5_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2155.5,-19286.6 1962.5,-19286.6 1962.5,-19233.6 2155.5,-19233.6 2155.5,-19286.6"/>
<text text-anchor="middle" x="2059" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="2059" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_4×V_4</text>
<text text-anchor="middle" x="2059" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_4_9&#45;&gt;ring_stage0_5_9 -->
<g id="edge269" class="edge">
<title>ring_stage0_4_9&#45;&gt;ring_stage0_5_9</title>
<path fill="none" stroke="black" d="M1904.64,-19323.23C1930.05,-19313 1959.46,-19301.17 1985.75,-19290.58"/>
<polygon fill="black" stroke="black" points="1987.31,-19293.73 1995.28,-19286.75 1984.7,-19287.23 1987.31,-19293.73"/>
</g>
<!-- kv_send0_4_10 -->
<g id="node173" class="node">
<title>kv_send0_4_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1598" cy="-19170.36" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1598" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="1598" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_4_10&#45;&gt;kv_send0_4_10 -->
<g id="edge226" class="edge">
<title>ring_stage0_4_10&#45;&gt;kv_send0_4_10</title>
<path fill="none" stroke="black" d="M1603.64,-19233.25C1602.91,-19225.2 1602.09,-19216.17 1601.3,-19207.55"/>
<polygon fill="black" stroke="black" points="1604.76,-19206.97 1600.37,-19197.33 1597.79,-19207.61 1604.76,-19206.97"/>
</g>
<!-- ring_stage0_5_10 -->
<g id="node189" class="node">
<title>ring_stage0_5_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1928,-19196.86 1726,-19196.86 1726,-19143.86 1928,-19143.86 1928,-19196.86"/>
<text text-anchor="middle" x="1827" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="1827" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_5×V_5</text>
<text text-anchor="middle" x="1827" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_4_10&#45;&gt;ring_stage0_5_10 -->
<g id="edge272" class="edge">
<title>ring_stage0_4_10&#45;&gt;ring_stage0_5_10</title>
<path fill="none" stroke="black" d="M1670.52,-19233.49C1696.39,-19223.22 1726.35,-19211.32 1753.09,-19200.7"/>
<polygon fill="black" stroke="black" points="1754.4,-19203.95 1762.4,-19197.01 1751.82,-19197.44 1754.4,-19203.95"/>
</g>
<!-- kv_send0_4_11 -->
<g id="node174" class="node">
<title>kv_send0_4_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1358" cy="-19080.62" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1358" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="1358" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_4_11&#45;&gt;kv_send0_4_11 -->
<g id="edge229" class="edge">
<title>ring_stage0_4_11&#45;&gt;kv_send0_4_11</title>
<path fill="none" stroke="black" d="M1365.76,-19143.51C1364.74,-19135.37 1363.59,-19126.23 1362.5,-19117.53"/>
<polygon fill="black" stroke="black" points="1365.97,-19117.08 1361.26,-19107.59 1359.03,-19117.95 1365.97,-19117.08"/>
</g>
<!-- ring_stage0_5_11 -->
<g id="node190" class="node">
<title>ring_stage0_5_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1688,-19107.12 1486,-19107.12 1486,-19054.12 1688,-19054.12 1688,-19107.12"/>
<text text-anchor="middle" x="1587" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="1587" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_6×V_6</text>
<text text-anchor="middle" x="1587" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_4_11&#45;&gt;ring_stage0_5_11 -->
<g id="edge275" class="edge">
<title>ring_stage0_4_11&#45;&gt;ring_stage0_5_11</title>
<path fill="none" stroke="black" d="M1432.64,-19143.75C1458.05,-19133.52 1487.46,-19121.68 1513.75,-19111.1"/>
<polygon fill="black" stroke="black" points="1515.31,-19114.25 1523.28,-19107.27 1512.7,-19107.75 1515.31,-19114.25"/>
</g>
<!-- kv_send0_4_12 -->
<g id="node175" class="node">
<title>kv_send0_4_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1120" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1120" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="1120" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_4_12&#45;&gt;kv_send0_4_12 -->
<g id="edge232" class="edge">
<title>ring_stage0_4_12&#45;&gt;kv_send0_4_12</title>
<path fill="none" stroke="black" d="M1126.35,-19053.77C1125.52,-19045.72 1124.6,-19036.69 1123.71,-19028.07"/>
<polygon fill="black" stroke="black" points="1127.17,-19027.44 1122.66,-19017.85 1120.2,-19028.16 1127.17,-19027.44"/>
</g>
<!-- ring_stage0_5_12 -->
<g id="node191" class="node">
<title>ring_stage0_5_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1450,-19017.38 1248,-19017.38 1248,-18964.38 1450,-18964.38 1450,-19017.38"/>
<text text-anchor="middle" x="1349" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="1349" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_7×V_7</text>
<text text-anchor="middle" x="1349" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_4_12&#45;&gt;ring_stage0_5_12 -->
<g id="edge278" class="edge">
<title>ring_stage0_4_12&#45;&gt;ring_stage0_5_12</title>
<path fill="none" stroke="black" d="M1193.22,-19054.01C1218.87,-19043.78 1248.55,-19031.94 1275.08,-19021.36"/>
<polygon fill="black" stroke="black" points="1276.7,-19024.48 1284.7,-19017.53 1274.11,-19017.98 1276.7,-19024.48"/>
</g>
<!-- kv_send0_4_13 -->
<g id="node176" class="node">
<title>kv_send0_4_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="881" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="881" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="881" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_4_13&#45;&gt;kv_send0_4_13 -->
<g id="edge235" class="edge">
<title>ring_stage0_4_13&#45;&gt;kv_send0_4_13</title>
<path fill="none" stroke="black" d="M888.05,-18964.03C887.13,-18955.89 886.08,-18946.75 885.09,-18938.05"/>
<polygon fill="black" stroke="black" points="888.57,-18937.65 883.96,-18928.11 881.61,-18938.44 888.57,-18937.65"/>
</g>
<!-- ring_stage0_5_13 -->
<g id="node192" class="node">
<title>ring_stage0_5_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1211,-18927.64 1009,-18927.64 1009,-18874.64 1211,-18874.64 1211,-18927.64"/>
<text text-anchor="middle" x="1110" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="1110" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_8×V_8</text>
<text text-anchor="middle" x="1110" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_4_13&#45;&gt;ring_stage0_5_13 -->
<g id="edge281" class="edge">
<title>ring_stage0_4_13&#45;&gt;ring_stage0_5_13</title>
<path fill="none" stroke="black" d="M954.93,-18964.27C980.46,-18954.04 1010,-18942.2 1036.41,-18931.62"/>
<polygon fill="black" stroke="black" points="1038.01,-18934.76 1045.99,-18927.79 1035.4,-18928.26 1038.01,-18934.76"/>
</g>
<!-- kv_send0_4_14 -->
<g id="node177" class="node">
<title>kv_send0_4_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="639" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="639" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="639" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_4_14&#45;&gt;kv_send0_4_14 -->
<g id="edge238" class="edge">
<title>ring_stage0_4_14&#45;&gt;kv_send0_4_14</title>
<path fill="none" stroke="black" d="M641.82,-18874.29C641.45,-18866.24 641.04,-18857.21 640.65,-18848.59"/>
<polygon fill="black" stroke="black" points="644.14,-18848.2 640.18,-18838.37 637.14,-18848.52 644.14,-18848.2"/>
</g>
<!-- ring_stage0_5_14 -->
<g id="node193" class="node">
<title>ring_stage0_5_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="970,-18837.9 768,-18837.9 768,-18784.9 970,-18784.9 970,-18837.9"/>
<text text-anchor="middle" x="869" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="869" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_9×V_9</text>
<text text-anchor="middle" x="869" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_4_14&#45;&gt;ring_stage0_5_14 -->
<g id="edge284" class="edge">
<title>ring_stage0_4_14&#45;&gt;ring_stage0_5_14</title>
<path fill="none" stroke="black" d="M708.98,-18874.53C735.43,-18864.26 766.07,-18852.36 793.42,-18841.74"/>
<polygon fill="black" stroke="black" points="794.89,-18844.93 802.94,-18838.05 792.35,-18838.4 794.89,-18844.93"/>
</g>
<!-- kv_send0_4_15 -->
<g id="node178" class="node">
<title>kv_send0_4_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="395" cy="-18721.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="395" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="395" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_4_15&#45;&gt;kv_send0_4_15 -->
<g id="edge241" class="edge">
<title>ring_stage0_4_15&#45;&gt;kv_send0_4_15</title>
<path fill="none" stroke="black" d="M397.82,-18784.55C397.45,-18776.5 397.04,-18767.47 396.65,-18758.85"/>
<polygon fill="black" stroke="black" points="400.14,-18758.46 396.18,-18748.63 393.14,-18758.78 400.14,-18758.46"/>
</g>
<!-- ring_stage0_5_15 -->
<g id="node194" class="node">
<title>ring_stage0_5_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="737,-18748.16 517,-18748.16 517,-18695.16 737,-18695.16 737,-18748.16"/>
<text text-anchor="middle" x="627" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="627" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_10×V_10</text>
<text text-anchor="middle" x="627" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_4_15&#45;&gt;ring_stage0_5_15 -->
<g id="edge287" class="edge">
<title>ring_stage0_4_15&#45;&gt;ring_stage0_5_15</title>
<path fill="none" stroke="black" d="M465.56,-18784.79C492.25,-18774.52 523.16,-18762.62 550.75,-18752"/>
<polygon fill="black" stroke="black" points="552.28,-18755.17 560.36,-18748.31 549.77,-18748.63 552.28,-18755.17"/>
</g>
<!-- kv_send0_4_0&#45;&gt;ring_stage0_5_1 -->
<g id="edge246" class="edge">
<title>kv_send0_4_0&#45;&gt;ring_stage0_5_1</title>
<path fill="none" stroke="black" d="M167,-18604.6C167,-18596.56 167,-18587.58 167,-18579.02"/>
<polygon fill="black" stroke="black" points="170.5,-18578.88 167,-18568.88 163.5,-18578.88 170.5,-18578.88"/>
</g>
<!-- kv_send0_4_1&#45;&gt;ring_stage0_5_2 -->
<g id="edge249" class="edge">
<title>kv_send0_4_1&#45;&gt;ring_stage0_5_2</title>
<path fill="none" stroke="black" d="M2192.11,-19955.33C2220.79,-19944.25 2256.09,-19930.6 2287.16,-19918.6"/>
<polygon fill="black" stroke="black" points="2288.58,-19921.8 2296.65,-19914.93 2286.06,-19915.27 2288.58,-19921.8"/>
</g>
<!-- kv_send0_4_2&#45;&gt;ring_stage0_5_3 -->
<g id="edge252" class="edge">
<title>kv_send0_4_2&#45;&gt;ring_stage0_5_3</title>
<path fill="none" stroke="black" d="M2886.32,-19869C2933.63,-19857.03 2996.36,-19841.17 3049.93,-19827.63"/>
<polygon fill="black" stroke="black" points="3050.99,-19830.97 3059.82,-19825.13 3049.27,-19824.18 3050.99,-19830.97"/>
</g>
<!-- kv_send0_4_3&#45;&gt;ring_stage0_5_4 -->
<g id="edge255" class="edge">
<title>kv_send0_4_3&#45;&gt;ring_stage0_5_4</title>
<path fill="none" stroke="black" d="M3599.6,-19771.22C3599.78,-19763.18 3599.99,-19754.2 3600.18,-19745.64"/>
<polygon fill="black" stroke="black" points="3603.69,-19745.58 3600.41,-19735.51 3596.69,-19745.42 3603.69,-19745.58"/>
</g>
<!-- kv_send0_4_4&#45;&gt;ring_stage0_5_5 -->
<g id="edge258" class="edge">
<title>kv_send0_4_4&#45;&gt;ring_stage0_5_5</title>
<path fill="none" stroke="black" d="M3097.51,-19685.66C3071.56,-19674.72 3039.89,-19661.35 3011.91,-19649.55"/>
<polygon fill="black" stroke="black" points="3013.16,-19646.28 3002.58,-19645.62 3010.43,-19652.73 3013.16,-19646.28"/>
</g>
<!-- kv_send0_4_5&#45;&gt;ring_stage0_5_6 -->
<g id="edge261" class="edge">
<title>kv_send0_4_5&#45;&gt;ring_stage0_5_6</title>
<path fill="none" stroke="black" d="M2703,-19591.74C2703,-19583.7 2703,-19574.72 2703,-19566.16"/>
<polygon fill="black" stroke="black" points="2706.5,-19566.02 2703,-19556.02 2699.5,-19566.02 2706.5,-19566.02"/>
</g>
<!-- kv_send0_4_6&#45;&gt;ring_stage0_5_7 -->
<g id="edge264" class="edge">
<title>kv_send0_4_6&#45;&gt;ring_stage0_5_7</title>
<path fill="none" stroke="black" d="M2493.84,-19502.47C2496.68,-19494.17 2499.87,-19484.83 2502.9,-19475.97"/>
<polygon fill="black" stroke="black" points="2506.3,-19476.84 2506.22,-19466.25 2499.68,-19474.58 2506.3,-19476.84"/>
</g>
<!-- kv_send0_4_7&#45;&gt;ring_stage0_5_8 -->
<g id="edge267" class="edge">
<title>kv_send0_4_7&#45;&gt;ring_stage0_5_8</title>
<path fill="none" stroke="black" d="M2276.9,-19412.26C2277.17,-19404.22 2277.48,-19395.24 2277.77,-19386.68"/>
<polygon fill="black" stroke="black" points="2281.28,-19386.66 2278.12,-19376.54 2274.28,-19386.42 2281.28,-19386.66"/>
</g>
<!-- kv_send0_4_8&#45;&gt;ring_stage0_5_9 -->
<g id="edge270" class="edge">
<title>kv_send0_4_8&#45;&gt;ring_stage0_5_9</title>
<path fill="none" stroke="black" d="M2059,-19322.52C2059,-19314.48 2059,-19305.5 2059,-19296.94"/>
<polygon fill="black" stroke="black" points="2062.5,-19296.8 2059,-19286.8 2055.5,-19296.8 2062.5,-19296.8"/>
</g>
<!-- kv_send0_4_9&#45;&gt;ring_stage0_5_10 -->
<g id="edge273" class="edge">
<title>kv_send0_4_9&#45;&gt;ring_stage0_5_10</title>
<path fill="none" stroke="black" d="M1832.6,-19232.78C1831.87,-19224.74 1831.05,-19215.76 1830.27,-19207.2"/>
<polygon fill="black" stroke="black" points="1833.74,-19206.71 1829.34,-19197.06 1826.77,-19207.34 1833.74,-19206.71"/>
</g>
<!-- kv_send0_4_10&#45;&gt;ring_stage0_5_11 -->
<g id="edge276" class="edge">
<title>kv_send0_4_10&#45;&gt;ring_stage0_5_11</title>
<path fill="none" stroke="black" d="M1594.7,-19143.04C1593.69,-19135 1592.57,-19126.02 1591.49,-19117.46"/>
<polygon fill="black" stroke="black" points="1594.94,-19116.81 1590.22,-19107.32 1587.99,-19117.68 1594.94,-19116.81"/>
</g>
<!-- kv_send0_4_11&#45;&gt;ring_stage0_5_12 -->
<g id="edge279" class="edge">
<title>kv_send0_4_11&#45;&gt;ring_stage0_5_12</title>
<path fill="none" stroke="black" d="M1355.3,-19053.3C1354.48,-19045.26 1353.55,-19036.28 1352.68,-19027.72"/>
<polygon fill="black" stroke="black" points="1356.14,-19027.17 1351.64,-19017.58 1349.18,-19027.89 1356.14,-19027.17"/>
</g>
<!-- kv_send0_4_12&#45;&gt;ring_stage0_5_13 -->
<g id="edge282" class="edge">
<title>kv_send0_4_12&#45;&gt;ring_stage0_5_13</title>
<path fill="none" stroke="black" d="M1117,-18963.56C1116.08,-18955.52 1115.06,-18946.54 1114.08,-18937.98"/>
<polygon fill="black" stroke="black" points="1117.54,-18937.38 1112.93,-18927.84 1110.58,-18938.18 1117.54,-18937.38"/>
</g>
<!-- kv_send0_4_13&#45;&gt;ring_stage0_5_14 -->
<g id="edge285" class="edge">
<title>kv_send0_4_13&#45;&gt;ring_stage0_5_14</title>
<path fill="none" stroke="black" d="M877.4,-18873.82C876.3,-18865.78 875.07,-18856.8 873.9,-18848.24"/>
<polygon fill="black" stroke="black" points="877.34,-18847.54 872.52,-18838.1 870.4,-18848.49 877.34,-18847.54"/>
</g>
<!-- kv_send0_4_14&#45;&gt;ring_stage0_5_15 -->
<g id="edge288" class="edge">
<title>kv_send0_4_14&#45;&gt;ring_stage0_5_15</title>
<path fill="none" stroke="black" d="M635.4,-18784.08C634.3,-18776.04 633.07,-18767.06 631.9,-18758.5"/>
<polygon fill="black" stroke="black" points="635.34,-18757.8 630.52,-18748.36 628.4,-18758.75 635.34,-18757.8"/>
</g>
<!-- kv_send0_4_15&#45;&gt;ring_stage0_5_0 -->
<g id="edge243" class="edge">
<title>kv_send0_4_15&#45;&gt;ring_stage0_5_0</title>
<path fill="none" stroke="black" d="M394.7,-18694.34C394.61,-18686.3 394.51,-18677.32 394.41,-18668.76"/>
<polygon fill="black" stroke="black" points="397.91,-18668.58 394.29,-18658.62 390.91,-18668.66 397.91,-18668.58"/>
</g>
<!-- kv_send0_5_0 -->
<g id="node195" class="node">
<title>kv_send0_5_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="394" cy="-18542.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="394" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="394" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_5_0&#45;&gt;kv_send0_5_0 -->
<g id="edge244" class="edge">
<title>ring_stage0_5_0&#45;&gt;kv_send0_5_0</title>
<path fill="none" stroke="black" d="M394,-18605.07C394,-18597.02 394,-18587.99 394,-18579.37"/>
<polygon fill="black" stroke="black" points="397.5,-18579.15 394,-18569.15 390.5,-18579.15 397.5,-18579.15"/>
</g>
<!-- ring_stage0_6_0 -->
<g id="node211" class="node">
<title>ring_stage0_6_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="726.5,-18568.68 515.5,-18568.68 515.5,-18515.68 726.5,-18515.68 726.5,-18568.68"/>
<text text-anchor="middle" x="621" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="621" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_10×V_10</text>
<text text-anchor="middle" x="621" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_5_0&#45;&gt;ring_stage0_6_0 -->
<g id="edge290" class="edge">
<title>ring_stage0_5_0&#45;&gt;ring_stage0_6_0</title>
<path fill="none" stroke="black" d="M460.27,-18605.31C486.84,-18595.04 517.62,-18583.14 545.08,-18572.52"/>
<polygon fill="black" stroke="black" points="546.58,-18575.7 554.65,-18568.83 544.06,-18569.17 546.58,-18575.7"/>
</g>
<!-- kv_send0_5_1 -->
<g id="node196" class="node">
<title>kv_send0_5_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="844" cy="-18452.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="844" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="844" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_5_1&#45;&gt;kv_send0_5_1 -->
<g id="edge247" class="edge">
<title>ring_stage0_5_1&#45;&gt;kv_send0_5_1</title>
<path fill="none" stroke="black" d="M272.79,-18516.79C275.89,-18516.27 278.97,-18515.77 282,-18515.31 479.93,-18485.27 533.13,-18509.73 731,-18479.31 741.02,-18477.77 751.48,-18475.83 761.81,-18473.72"/>
<polygon fill="black" stroke="black" points="762.6,-18477.13 771.66,-18471.64 761.15,-18470.28 762.6,-18477.13"/>
</g>
<!-- ring_stage0_6_1 -->
<g id="node212" class="node">
<title>ring_stage0_6_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="282.5,-18478.94 71.5,-18478.94 71.5,-18425.94 282.5,-18425.94 282.5,-18478.94"/>
<text text-anchor="middle" x="177" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="177" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_11×V_11</text>
<text text-anchor="middle" x="177" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_5_1&#45;&gt;ring_stage0_6_1 -->
<g id="edge293" class="edge">
<title>ring_stage0_5_1&#45;&gt;ring_stage0_6_1</title>
<path fill="none" stroke="black" d="M169.95,-18515.33C170.88,-18507.12 171.93,-18497.89 172.93,-18489.11"/>
<polygon fill="black" stroke="black" points="176.42,-18489.44 174.07,-18479.11 169.46,-18488.65 176.42,-18489.44"/>
</g>
<!-- kv_send0_5_2 -->
<g id="node197" class="node">
<title>kv_send0_5_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2708" cy="-19798.54" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2708" y="-19802.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="2708" y="-19787.34" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_5_2&#45;&gt;kv_send0_5_2 -->
<g id="edge250" class="edge">
<title>ring_stage0_5_2&#45;&gt;kv_send0_5_2</title>
<path fill="none" stroke="black" d="M2463.72,-19861.67C2515.35,-19848.54 2577.43,-19832.75 2626.08,-19820.38"/>
<polygon fill="black" stroke="black" points="2627.11,-19823.73 2635.94,-19817.87 2625.39,-19816.94 2627.11,-19823.73"/>
</g>
<!-- ring_stage0_6_2 -->
<g id="node213" class="node">
<title>ring_stage0_6_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1626.5,-18389.2 1415.5,-18389.2 1415.5,-18336.2 1626.5,-18336.2 1626.5,-18389.2"/>
<text text-anchor="middle" x="1521" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="1521" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_12×V_12</text>
<text text-anchor="middle" x="1521" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_5_2&#45;&gt;ring_stage0_6_2 -->
<g id="edge296" class="edge">
<title>ring_stage0_5_2&#45;&gt;ring_stage0_6_2</title>
<path fill="none" stroke="black" d="M2363,-19861.71C2363,-19827.22 2363,-19763.88 2363,-19709.8 2363,-19709.8 2363,-19709.8 2363,-19618.06 2363,-19566.49 2360.71,-19552.54 2373,-19502.45 2377.13,-19485.62 2384.6,-19483.45 2388,-19466.45 2392.68,-19443.03 2388.4,-19436.59 2388,-19412.71 2387.33,-19372.81 2411.05,-19353.2 2385,-19322.97 2327.18,-19255.88 2248.93,-19352.19 2189,-19286.97 2145.65,-19239.8 2218.81,-19190.24 2175,-19143.49 2107.25,-19071.2 2031.52,-19170.43 1955,-19107.49 1935.32,-19091.3 1954.67,-19069.96 1935,-19053.75 1859.21,-18991.31 1787.98,-19085.61 1717,-19017.75 1687.53,-18989.58 1704.55,-18968.25 1698,-18928.01 1695.74,-18914.14 1646,-18437.12 1638,-18425.57 1629.25,-18412.94 1617.09,-18402.69 1603.9,-18394.44"/>
<polygon fill="black" stroke="black" points="1605.51,-18391.32 1595.11,-18389.29 1601.97,-18397.36 1605.51,-18391.32"/>
</g>
<!-- kv_send0_5_3 -->
<g id="node198" class="node">
<title>kv_send0_5_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3374" cy="-19708.8" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3374" y="-19712.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3374" y="-19697.6" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_5_3&#45;&gt;kv_send0_5_3 -->
<g id="edge253" class="edge">
<title>ring_stage0_5_3&#45;&gt;kv_send0_5_3</title>
<path fill="none" stroke="black" d="M3223.18,-19771.93C3250.75,-19760.57 3283.14,-19747.23 3310.83,-19735.82"/>
<polygon fill="black" stroke="black" points="3312.5,-19738.92 3320.41,-19731.88 3309.83,-19732.45 3312.5,-19738.92"/>
</g>
<!-- ring_stage0_6_3 -->
<g id="node214" class="node">
<title>ring_stage0_6_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3028.5,-19735.3 2817.5,-19735.3 2817.5,-19682.3 3028.5,-19682.3 3028.5,-19735.3"/>
<text text-anchor="middle" x="2923" y="-19720.1" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2923" y="-19705.1" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_13×V_13</text>
<text text-anchor="middle" x="2923" y="-19690.1" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_5_3&#45;&gt;ring_stage0_6_3 -->
<g id="edge299" class="edge">
<title>ring_stage0_5_3&#45;&gt;ring_stage0_6_3</title>
<path fill="none" stroke="black" d="M3091.52,-19771.93C3063.54,-19761.61 3031.11,-19749.66 3002.22,-19739.01"/>
<polygon fill="black" stroke="black" points="3003.16,-19735.62 2992.57,-19735.45 3000.74,-19742.19 3003.16,-19735.62"/>
</g>
<!-- kv_send0_5_4 -->
<g id="node199" class="node">
<title>kv_send0_5_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3389" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3389" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="3389" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_5_4&#45;&gt;kv_send0_5_4 -->
<g id="edge256" class="edge">
<title>ring_stage0_5_4&#45;&gt;kv_send0_5_4</title>
<path fill="none" stroke="black" d="M3539.11,-19682.19C3511.67,-19670.83 3479.43,-19657.49 3451.87,-19646.08"/>
<polygon fill="black" stroke="black" points="3452.92,-19642.73 3442.34,-19642.14 3450.24,-19649.2 3452.92,-19642.73"/>
</g>
<!-- ring_stage0_6_4 -->
<g id="node215" class="node">
<title>ring_stage0_6_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3723.5,-19645.56 3512.5,-19645.56 3512.5,-19592.56 3723.5,-19592.56 3723.5,-19645.56"/>
<text text-anchor="middle" x="3618" y="-19630.36" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="3618" y="-19615.36" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_14×V_14</text>
<text text-anchor="middle" x="3618" y="-19600.36" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_5_4&#45;&gt;ring_stage0_6_4 -->
<g id="edge302" class="edge">
<title>ring_stage0_5_4&#45;&gt;ring_stage0_6_4</title>
<path fill="none" stroke="black" d="M3606.01,-19681.95C3607.6,-19673.74 3609.39,-19664.51 3611.09,-19655.73"/>
<polygon fill="black" stroke="black" points="3614.56,-19656.21 3613.03,-19645.73 3607.69,-19654.88 3614.56,-19656.21"/>
</g>
<!-- kv_send0_5_5 -->
<g id="node200" class="node">
<title>kv_send0_5_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2941" cy="-19529.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2941" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2941" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_5_5&#45;&gt;kv_send0_5_5 -->
<g id="edge259" class="edge">
<title>ring_stage0_5_5&#45;&gt;kv_send0_5_5</title>
<path fill="none" stroke="black" d="M2941.71,-19592.21C2941.61,-19584.16 2941.51,-19575.13 2941.41,-19566.51"/>
<polygon fill="black" stroke="black" points="2944.91,-19566.25 2941.3,-19556.29 2937.91,-19566.33 2944.91,-19566.25"/>
</g>
<!-- ring_stage0_6_5 -->
<g id="node216" class="node">
<title>ring_stage0_6_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3273.5,-19555.82 3062.5,-19555.82 3062.5,-19502.82 3273.5,-19502.82 3273.5,-19555.82"/>
<text text-anchor="middle" x="3168" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="3168" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_15×V_15</text>
<text text-anchor="middle" x="3168" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_5_5&#45;&gt;ring_stage0_6_5 -->
<g id="edge305" class="edge">
<title>ring_stage0_5_5&#45;&gt;ring_stage0_6_5</title>
<path fill="none" stroke="black" d="M3007.98,-19592.45C3034.43,-19582.18 3065.07,-19570.28 3092.42,-19559.67"/>
<polygon fill="black" stroke="black" points="3093.89,-19562.85 3101.94,-19555.97 3091.35,-19556.32 3093.89,-19562.85"/>
</g>
<!-- kv_send0_5_6 -->
<g id="node201" class="node">
<title>kv_send0_5_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2733" cy="-19439.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2733" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2733" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_5_6&#45;&gt;kv_send0_5_6 -->
<g id="edge262" class="edge">
<title>ring_stage0_5_6&#45;&gt;kv_send0_5_6</title>
<path fill="none" stroke="black" d="M2711.84,-19502.47C2714.65,-19494.25 2717.81,-19484.99 2720.82,-19476.2"/>
<polygon fill="black" stroke="black" points="2724.2,-19477.15 2724.12,-19466.55 2717.57,-19474.88 2724.2,-19477.15"/>
</g>
<!-- ring_stage0_6_6 -->
<g id="node217" class="node">
<title>ring_stage0_6_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3070.5,-19466.08 2877.5,-19466.08 2877.5,-19413.08 3070.5,-19413.08 3070.5,-19466.08"/>
<text text-anchor="middle" x="2974" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2974" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_0×V_0</text>
<text text-anchor="middle" x="2974" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_5_6&#45;&gt;ring_stage0_6_6 -->
<g id="edge308" class="edge">
<title>ring_stage0_5_6&#45;&gt;ring_stage0_6_6</title>
<path fill="none" stroke="black" d="M2782.11,-19502.71C2814.39,-19492.26 2851.86,-19480.13 2885.08,-19469.37"/>
<polygon fill="black" stroke="black" points="2886.35,-19472.64 2894.79,-19466.23 2884.2,-19465.98 2886.35,-19472.64"/>
</g>
<!-- kv_send0_5_7 -->
<g id="node202" class="node">
<title>kv_send0_5_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2517" cy="-19349.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2517" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2517" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_5_7&#45;&gt;kv_send0_5_7 -->
<g id="edge265" class="edge">
<title>ring_stage0_5_7&#45;&gt;kv_send0_5_7</title>
<path fill="none" stroke="black" d="M2515.59,-19412.73C2515.77,-19404.68 2515.98,-19395.65 2516.18,-19387.03"/>
<polygon fill="black" stroke="black" points="2519.68,-19386.89 2516.41,-19376.81 2512.68,-19386.73 2519.68,-19386.89"/>
</g>
<!-- ring_stage0_6_7 -->
<g id="node218" class="node">
<title>ring_stage0_6_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2832.5,-19376.34 2639.5,-19376.34 2639.5,-19323.34 2832.5,-19323.34 2832.5,-19376.34"/>
<text text-anchor="middle" x="2736" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2736" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_1×V_1</text>
<text text-anchor="middle" x="2736" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_5_7&#45;&gt;ring_stage0_6_7 -->
<g id="edge311" class="edge">
<title>ring_stage0_5_7&#45;&gt;ring_stage0_6_7</title>
<path fill="none" stroke="black" d="M2579.52,-19412.97C2605.39,-19402.7 2635.35,-19390.8 2662.09,-19380.18"/>
<polygon fill="black" stroke="black" points="2663.4,-19383.43 2671.4,-19376.49 2660.82,-19376.92 2663.4,-19383.43"/>
</g>
<!-- kv_send0_5_8 -->
<g id="node203" class="node">
<title>kv_send0_5_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2301" cy="-19260.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2301" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="2301" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_5_8&#45;&gt;kv_send0_5_8 -->
<g id="edge268" class="edge">
<title>ring_stage0_5_8&#45;&gt;kv_send0_5_8</title>
<path fill="none" stroke="black" d="M2285.48,-19322.99C2287.52,-19314.85 2289.81,-19305.71 2292,-19297.01"/>
<polygon fill="black" stroke="black" points="2295.45,-19297.62 2294.49,-19287.07 2288.66,-19295.92 2295.45,-19297.62"/>
</g>
<!-- ring_stage0_6_8 -->
<g id="node219" class="node">
<title>ring_stage0_6_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2615.5,-19286.6 2422.5,-19286.6 2422.5,-19233.6 2615.5,-19233.6 2615.5,-19286.6"/>
<text text-anchor="middle" x="2519" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2519" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_2×V_2</text>
<text text-anchor="middle" x="2519" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_5_8&#45;&gt;ring_stage0_6_8 -->
<g id="edge314" class="edge">
<title>ring_stage0_5_8&#45;&gt;ring_stage0_6_8</title>
<path fill="none" stroke="black" d="M2349.06,-19323.23C2377.28,-19312.91 2409.98,-19300.96 2439.12,-19290.31"/>
<polygon fill="black" stroke="black" points="2440.66,-19293.47 2448.85,-19286.75 2438.26,-19286.89 2440.66,-19293.47"/>
</g>
<!-- kv_send0_5_9 -->
<g id="node204" class="node">
<title>kv_send0_5_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2056" cy="-19170.36" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2056" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2056" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_5_9&#45;&gt;kv_send0_5_9 -->
<g id="edge271" class="edge">
<title>ring_stage0_5_9&#45;&gt;kv_send0_5_9</title>
<path fill="none" stroke="black" d="M2058.12,-19233.25C2057.84,-19225.2 2057.53,-19216.17 2057.24,-19207.55"/>
<polygon fill="black" stroke="black" points="2060.73,-19207.21 2056.89,-19197.33 2053.73,-19207.44 2060.73,-19207.21"/>
</g>
<!-- ring_stage0_6_9 -->
<g id="node220" class="node">
<title>ring_stage0_6_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2397.5,-19196.86 2204.5,-19196.86 2204.5,-19143.86 2397.5,-19143.86 2397.5,-19196.86"/>
<text text-anchor="middle" x="2301" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2301" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_3×V_3</text>
<text text-anchor="middle" x="2301" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_5_9&#45;&gt;ring_stage0_6_9 -->
<g id="edge317" class="edge">
<title>ring_stage0_5_9&#45;&gt;ring_stage0_6_9</title>
<path fill="none" stroke="black" d="M2129.65,-19233.49C2158.22,-19223.13 2191.36,-19211.11 2220.83,-19200.43"/>
<polygon fill="black" stroke="black" points="2222.06,-19203.71 2230.27,-19197.01 2219.67,-19197.13 2222.06,-19203.71"/>
</g>
<!-- kv_send0_5_10 -->
<g id="node205" class="node">
<title>kv_send0_5_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1816" cy="-19080.62" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1816" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="1816" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_5_10&#45;&gt;kv_send0_5_10 -->
<g id="edge274" class="edge">
<title>ring_stage0_5_10&#45;&gt;kv_send0_5_10</title>
<path fill="none" stroke="black" d="M1823.76,-19143.51C1822.74,-19135.37 1821.59,-19126.23 1820.5,-19117.53"/>
<polygon fill="black" stroke="black" points="1823.97,-19117.08 1819.26,-19107.59 1817.03,-19117.95 1823.97,-19117.08"/>
</g>
<!-- ring_stage0_6_10 -->
<g id="node221" class="node">
<title>ring_stage0_6_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2166,-19107.12 1964,-19107.12 1964,-19054.12 2166,-19054.12 2166,-19107.12"/>
<text text-anchor="middle" x="2065" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="2065" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_4×V_4</text>
<text text-anchor="middle" x="2065" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_5_10&#45;&gt;ring_stage0_6_10 -->
<g id="edge320" class="edge">
<title>ring_stage0_5_10&#45;&gt;ring_stage0_6_10</title>
<path fill="none" stroke="black" d="M1896.48,-19143.75C1924.46,-19133.43 1956.89,-19121.48 1985.78,-19110.83"/>
<polygon fill="black" stroke="black" points="1987.26,-19114.01 1995.43,-19107.27 1984.84,-19107.44 1987.26,-19114.01"/>
</g>
<!-- kv_send0_5_11 -->
<g id="node206" class="node">
<title>kv_send0_5_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1578" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1578" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="1578" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_5_11&#45;&gt;kv_send0_5_11 -->
<g id="edge277" class="edge">
<title>ring_stage0_5_11&#45;&gt;kv_send0_5_11</title>
<path fill="none" stroke="black" d="M1584.35,-19053.77C1583.52,-19045.72 1582.6,-19036.69 1581.71,-19028.07"/>
<polygon fill="black" stroke="black" points="1585.17,-19027.44 1580.66,-19017.85 1578.2,-19028.16 1585.17,-19027.44"/>
</g>
<!-- ring_stage0_6_11 -->
<g id="node222" class="node">
<title>ring_stage0_6_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1928,-19017.38 1726,-19017.38 1726,-18964.38 1928,-18964.38 1928,-19017.38"/>
<text text-anchor="middle" x="1827" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="1827" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_5×V_5</text>
<text text-anchor="middle" x="1827" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_5_11&#45;&gt;ring_stage0_6_11 -->
<g id="edge323" class="edge">
<title>ring_stage0_5_11&#45;&gt;ring_stage0_6_11</title>
<path fill="none" stroke="black" d="M1657.06,-19054.01C1685.28,-19043.69 1717.98,-19031.74 1747.12,-19021.09"/>
<polygon fill="black" stroke="black" points="1748.66,-19024.25 1756.85,-19017.53 1746.26,-19017.67 1748.66,-19024.25"/>
</g>
<!-- kv_send0_5_12 -->
<g id="node207" class="node">
<title>kv_send0_5_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1339" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1339" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="1339" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_5_12&#45;&gt;kv_send0_5_12 -->
<g id="edge280" class="edge">
<title>ring_stage0_5_12&#45;&gt;kv_send0_5_12</title>
<path fill="none" stroke="black" d="M1346.05,-18964.03C1345.13,-18955.89 1344.08,-18946.75 1343.09,-18938.05"/>
<polygon fill="black" stroke="black" points="1346.57,-18937.65 1341.96,-18928.11 1339.61,-18938.44 1346.57,-18937.65"/>
</g>
<!-- ring_stage0_6_12 -->
<g id="node223" class="node">
<title>ring_stage0_6_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1669,-18927.64 1467,-18927.64 1467,-18874.64 1669,-18874.64 1669,-18927.64"/>
<text text-anchor="middle" x="1568" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="1568" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_6×V_6</text>
<text text-anchor="middle" x="1568" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_5_12&#45;&gt;ring_stage0_6_12 -->
<g id="edge326" class="edge">
<title>ring_stage0_5_12&#45;&gt;ring_stage0_6_12</title>
<path fill="none" stroke="black" d="M1412.93,-18964.27C1438.46,-18954.04 1468,-18942.2 1494.41,-18931.62"/>
<polygon fill="black" stroke="black" points="1496.01,-18934.76 1503.99,-18927.79 1493.4,-18928.26 1496.01,-18934.76"/>
</g>
<!-- kv_send0_5_13 -->
<g id="node208" class="node">
<title>kv_send0_5_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1099" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1099" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="1099" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_5_13&#45;&gt;kv_send0_5_13 -->
<g id="edge283" class="edge">
<title>ring_stage0_5_13&#45;&gt;kv_send0_5_13</title>
<path fill="none" stroke="black" d="M1106.76,-18874.29C1105.74,-18866.15 1104.59,-18857.01 1103.5,-18848.31"/>
<polygon fill="black" stroke="black" points="1106.97,-18847.86 1102.26,-18838.37 1100.03,-18848.73 1106.97,-18847.86"/>
</g>
<!-- ring_stage0_6_13 -->
<g id="node224" class="node">
<title>ring_stage0_6_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1429,-18837.9 1227,-18837.9 1227,-18784.9 1429,-18784.9 1429,-18837.9"/>
<text text-anchor="middle" x="1328" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="1328" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_7×V_7</text>
<text text-anchor="middle" x="1328" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_5_13&#45;&gt;ring_stage0_6_13 -->
<g id="edge329" class="edge">
<title>ring_stage0_5_13&#45;&gt;ring_stage0_6_13</title>
<path fill="none" stroke="black" d="M1173.64,-18874.53C1199.05,-18864.3 1228.46,-18852.46 1254.75,-18841.88"/>
<polygon fill="black" stroke="black" points="1256.31,-18845.03 1264.28,-18838.05 1253.7,-18838.53 1256.31,-18845.03"/>
</g>
<!-- kv_send0_5_14 -->
<g id="node209" class="node">
<title>kv_send0_5_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="866" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="866" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="866" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_5_14&#45;&gt;kv_send0_5_14 -->
<g id="edge286" class="edge">
<title>ring_stage0_5_14&#45;&gt;kv_send0_5_14</title>
<path fill="none" stroke="black" d="M868.12,-18784.55C867.84,-18776.5 867.53,-18767.47 867.24,-18758.85"/>
<polygon fill="black" stroke="black" points="870.73,-18758.5 866.89,-18748.63 863.73,-18758.74 870.73,-18758.5"/>
</g>
<!-- ring_stage0_6_14 -->
<g id="node225" class="node">
<title>ring_stage0_6_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1196,-18748.16 994,-18748.16 994,-18695.16 1196,-18695.16 1196,-18748.16"/>
<text text-anchor="middle" x="1095" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="1095" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_8×V_8</text>
<text text-anchor="middle" x="1095" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_5_14&#45;&gt;ring_stage0_6_14 -->
<g id="edge332" class="edge">
<title>ring_stage0_5_14&#45;&gt;ring_stage0_6_14</title>
<path fill="none" stroke="black" d="M934.98,-18784.79C961.43,-18774.52 992.07,-18762.62 1019.42,-18752"/>
<polygon fill="black" stroke="black" points="1020.89,-18755.19 1028.94,-18748.31 1018.35,-18748.66 1020.89,-18755.19"/>
</g>
<!-- kv_send0_5_15 -->
<g id="node210" class="node">
<title>kv_send0_5_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="626" cy="-18631.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="626" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="626" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_5_15&#45;&gt;kv_send0_5_15 -->
<g id="edge289" class="edge">
<title>ring_stage0_5_15&#45;&gt;kv_send0_5_15</title>
<path fill="none" stroke="black" d="M626.71,-18694.81C626.61,-18686.76 626.51,-18677.73 626.41,-18669.11"/>
<polygon fill="black" stroke="black" points="629.91,-18668.85 626.3,-18658.89 622.91,-18668.93 629.91,-18668.85"/>
</g>
<!-- ring_stage0_6_15 -->
<g id="node226" class="node">
<title>ring_stage0_6_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="949,-18658.42 747,-18658.42 747,-18605.42 949,-18605.42 949,-18658.42"/>
<text text-anchor="middle" x="848" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="848" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_9×V_9</text>
<text text-anchor="middle" x="848" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_5_15&#45;&gt;ring_stage0_6_15 -->
<g id="edge335" class="edge">
<title>ring_stage0_5_15&#45;&gt;ring_stage0_6_15</title>
<path fill="none" stroke="black" d="M691.52,-18695.05C717.39,-18684.78 747.35,-18672.88 774.09,-18662.26"/>
<polygon fill="black" stroke="black" points="775.4,-18665.51 783.4,-18658.57 772.82,-18659 775.4,-18665.51"/>
</g>
<!-- kv_send0_5_0&#45;&gt;ring_stage0_6_1 -->
<g id="edge294" class="edge">
<title>kv_send0_5_0&#45;&gt;ring_stage0_6_1</title>
<path fill="none" stroke="black" d="M339.8,-18519.27C312.5,-18508.23 279.02,-18494.69 249.54,-18482.77"/>
<polygon fill="black" stroke="black" points="250.7,-18479.47 240.12,-18478.96 248.08,-18485.96 250.7,-18479.47"/>
</g>
<!-- kv_send0_5_1&#45;&gt;ring_stage0_6_2 -->
<g id="edge297" class="edge">
<title>kv_send0_5_1&#45;&gt;ring_stage0_6_2</title>
<path fill="none" stroke="black" d="M916,-18433.17C929.24,-18430.28 942.98,-18427.59 956,-18425.57 1152.96,-18395.06 1205.87,-18418.98 1403,-18389.57 1403.76,-18389.46 1404.52,-18389.34 1405.28,-18389.23"/>
<polygon fill="black" stroke="black" points="1406,-18392.66 1415.31,-18387.6 1404.87,-18385.75 1406,-18392.66"/>
</g>
<!-- kv_send0_5_2&#45;&gt;ring_stage0_6_3 -->
<g id="edge300" class="edge">
<title>kv_send0_5_2&#45;&gt;ring_stage0_6_3</title>
<path fill="none" stroke="black" d="M2761.98,-19775.52C2788.91,-19764.52 2821.87,-19751.07 2850.94,-19739.21"/>
<polygon fill="black" stroke="black" points="2852.29,-19742.44 2860.23,-19735.42 2849.64,-19735.96 2852.29,-19742.44"/>
</g>
<!-- kv_send0_5_3&#45;&gt;ring_stage0_6_4 -->
<g id="edge303" class="edge">
<title>kv_send0_5_3&#45;&gt;ring_stage0_6_4</title>
<path fill="none" stroke="black" d="M3432.75,-19686.67C3464.08,-19675.41 3503.09,-19661.38 3537.22,-19649.11"/>
<polygon fill="black" stroke="black" points="3538.48,-19652.38 3546.7,-19645.7 3536.11,-19645.79 3538.48,-19652.38"/>
</g>
<!-- kv_send0_5_4&#45;&gt;ring_stage0_6_5 -->
<g id="edge306" class="edge">
<title>kv_send0_5_4&#45;&gt;ring_stage0_6_5</title>
<path fill="none" stroke="black" d="M3334.09,-19596.26C3306.29,-19585.22 3272.14,-19571.67 3242.05,-19559.72"/>
<polygon fill="black" stroke="black" points="3243.03,-19556.34 3232.44,-19555.91 3240.44,-19562.85 3243.03,-19556.34"/>
</g>
<!-- kv_send0_5_5&#45;&gt;ring_stage0_6_6 -->
<g id="edge309" class="edge">
<title>kv_send0_5_5&#45;&gt;ring_stage0_6_6</title>
<path fill="none" stroke="black" d="M2950.72,-19502.47C2953.88,-19494.08 2957.43,-19484.63 2960.8,-19475.68"/>
<polygon fill="black" stroke="black" points="2964.1,-19476.84 2964.35,-19466.25 2957.55,-19474.38 2964.1,-19476.84"/>
</g>
<!-- kv_send0_5_6&#45;&gt;ring_stage0_6_7 -->
<g id="edge312" class="edge">
<title>kv_send0_5_6&#45;&gt;ring_stage0_6_7</title>
<path fill="none" stroke="black" d="M2733.9,-19412.26C2734.17,-19404.22 2734.48,-19395.24 2734.77,-19386.68"/>
<polygon fill="black" stroke="black" points="2738.28,-19386.66 2735.12,-19376.54 2731.28,-19386.42 2738.28,-19386.66"/>
</g>
<!-- kv_send0_5_7&#45;&gt;ring_stage0_6_8 -->
<g id="edge315" class="edge">
<title>kv_send0_5_7&#45;&gt;ring_stage0_6_8</title>
<path fill="none" stroke="black" d="M2517.6,-19322.52C2517.78,-19314.48 2517.99,-19305.5 2518.18,-19296.94"/>
<polygon fill="black" stroke="black" points="2521.69,-19296.88 2518.41,-19286.8 2514.69,-19296.72 2521.69,-19296.88"/>
</g>
<!-- kv_send0_5_8&#45;&gt;ring_stage0_6_9 -->
<g id="edge318" class="edge">
<title>kv_send0_5_8&#45;&gt;ring_stage0_6_9</title>
<path fill="none" stroke="black" d="M2301,-19232.78C2301,-19224.74 2301,-19215.76 2301,-19207.2"/>
<polygon fill="black" stroke="black" points="2304.5,-19207.06 2301,-19197.06 2297.5,-19207.06 2304.5,-19207.06"/>
</g>
<!-- kv_send0_5_9&#45;&gt;ring_stage0_6_10 -->
<g id="edge321" class="edge">
<title>kv_send0_5_9&#45;&gt;ring_stage0_6_10</title>
<path fill="none" stroke="black" d="M2058.7,-19143.04C2059.52,-19135 2060.45,-19126.02 2061.32,-19117.46"/>
<polygon fill="black" stroke="black" points="2064.82,-19117.63 2062.36,-19107.32 2057.86,-19116.91 2064.82,-19117.63"/>
</g>
<!-- kv_send0_5_10&#45;&gt;ring_stage0_6_11 -->
<g id="edge324" class="edge">
<title>kv_send0_5_10&#45;&gt;ring_stage0_6_11</title>
<path fill="none" stroke="black" d="M1819.3,-19053.3C1820.31,-19045.26 1821.43,-19036.28 1822.51,-19027.72"/>
<polygon fill="black" stroke="black" points="1826.01,-19027.94 1823.78,-19017.58 1819.06,-19027.07 1826.01,-19027.94"/>
</g>
<!-- kv_send0_5_11&#45;&gt;ring_stage0_6_12 -->
<g id="edge327" class="edge">
<title>kv_send0_5_11&#45;&gt;ring_stage0_6_12</title>
<path fill="none" stroke="black" d="M1575,-18963.56C1574.08,-18955.52 1573.06,-18946.54 1572.08,-18937.98"/>
<polygon fill="black" stroke="black" points="1575.54,-18937.38 1570.93,-18927.84 1568.58,-18938.18 1575.54,-18937.38"/>
</g>
<!-- kv_send0_5_12&#45;&gt;ring_stage0_6_13 -->
<g id="edge330" class="edge">
<title>kv_send0_5_12&#45;&gt;ring_stage0_6_13</title>
<path fill="none" stroke="black" d="M1335.7,-18873.82C1334.69,-18865.78 1333.57,-18856.8 1332.49,-18848.24"/>
<polygon fill="black" stroke="black" points="1335.94,-18847.59 1331.22,-18838.1 1328.99,-18848.46 1335.94,-18847.59"/>
</g>
<!-- kv_send0_5_13&#45;&gt;ring_stage0_6_14 -->
<g id="edge333" class="edge">
<title>kv_send0_5_13&#45;&gt;ring_stage0_6_14</title>
<path fill="none" stroke="black" d="M1097.8,-18784.08C1097.43,-18776.04 1097.02,-18767.06 1096.63,-18758.5"/>
<polygon fill="black" stroke="black" points="1100.12,-18758.19 1096.17,-18748.36 1093.13,-18758.51 1100.12,-18758.19"/>
</g>
<!-- kv_send0_5_14&#45;&gt;ring_stage0_6_15 -->
<g id="edge336" class="edge">
<title>kv_send0_5_14&#45;&gt;ring_stage0_6_15</title>
<path fill="none" stroke="black" d="M860.7,-18694.81C859.01,-18686.6 857.12,-18677.37 855.32,-18668.59"/>
<polygon fill="black" stroke="black" points="858.7,-18667.68 853.27,-18658.59 851.85,-18669.09 858.7,-18667.68"/>
</g>
<!-- kv_send0_5_15&#45;&gt;ring_stage0_6_0 -->
<g id="edge291" class="edge">
<title>kv_send0_5_15&#45;&gt;ring_stage0_6_0</title>
<path fill="none" stroke="black" d="M624.5,-18604.6C624.04,-18596.56 623.53,-18587.58 623.04,-18579.02"/>
<polygon fill="black" stroke="black" points="626.53,-18578.67 622.46,-18568.88 619.54,-18579.07 626.53,-18578.67"/>
</g>
<!-- kv_send0_6_0 -->
<g id="node227" class="node">
<title>kv_send0_6_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="407" cy="-18452.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="407" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="407" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_6_0&#45;&gt;kv_send0_6_0 -->
<g id="edge292" class="edge">
<title>ring_stage0_6_0&#45;&gt;kv_send0_6_0</title>
<path fill="none" stroke="black" d="M558.53,-18515.57C530.71,-18504.16 498,-18490.75 470.1,-18479.31"/>
<polygon fill="black" stroke="black" points="471.42,-18476.07 460.84,-18475.52 468.77,-18482.55 471.42,-18476.07"/>
</g>
<!-- ring_stage0_7_0 -->
<g id="node243" class="node">
<title>ring_stage0_7_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="722.5,-18478.94 529.5,-18478.94 529.5,-18425.94 722.5,-18425.94 722.5,-18478.94"/>
<text text-anchor="middle" x="626" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="626" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_9×V_9</text>
<text text-anchor="middle" x="626" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_6_0&#45;&gt;ring_stage0_7_0 -->
<g id="edge338" class="edge">
<title>ring_stage0_6_0&#45;&gt;ring_stage0_7_0</title>
<path fill="none" stroke="black" d="M622.47,-18515.33C622.94,-18507.12 623.47,-18497.89 623.97,-18489.11"/>
<polygon fill="black" stroke="black" points="627.46,-18489.29 624.54,-18479.11 620.47,-18488.89 627.46,-18489.29"/>
</g>
<!-- kv_send0_6_1 -->
<g id="node228" class="node">
<title>kv_send0_6_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="404" cy="-18362.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="404" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="404" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_6_1&#45;&gt;kv_send0_6_1 -->
<g id="edge295" class="edge">
<title>ring_stage0_6_1&#45;&gt;kv_send0_6_1</title>
<path fill="none" stroke="black" d="M243.27,-18425.83C273.26,-18414.23 308.61,-18400.57 338.51,-18389.01"/>
<polygon fill="black" stroke="black" points="339.95,-18392.21 348.01,-18385.34 337.42,-18385.68 339.95,-18392.21"/>
</g>
<!-- ring_stage0_7_1 -->
<g id="node244" class="node">
<title>ring_stage0_7_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="282.5,-18389.2 71.5,-18389.2 71.5,-18336.2 282.5,-18336.2 282.5,-18389.2"/>
<text text-anchor="middle" x="177" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="177" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_10×V_10</text>
<text text-anchor="middle" x="177" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_6_1&#45;&gt;ring_stage0_7_1 -->
<g id="edge341" class="edge">
<title>ring_stage0_6_1&#45;&gt;ring_stage0_7_1</title>
<path fill="none" stroke="black" d="M177,-18425.59C177,-18417.38 177,-18408.15 177,-18399.37"/>
<polygon fill="black" stroke="black" points="180.5,-18399.37 177,-18389.37 173.5,-18399.37 180.5,-18399.37"/>
</g>
<!-- kv_send0_6_2 -->
<g id="node229" class="node">
<title>kv_send0_6_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1745" cy="-18272.96" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1745" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="1745" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_6_2&#45;&gt;kv_send0_6_2 -->
<g id="edge298" class="edge">
<title>ring_stage0_6_2&#45;&gt;kv_send0_6_2</title>
<path fill="none" stroke="black" d="M1586.39,-18336.09C1615.87,-18324.54 1650.6,-18310.94 1680.03,-18299.41"/>
<polygon fill="black" stroke="black" points="1681.35,-18302.65 1689.38,-18295.75 1678.8,-18296.13 1681.35,-18302.65"/>
</g>
<!-- ring_stage0_7_2 -->
<g id="node245" class="node">
<title>ring_stage0_7_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1400.5,-18299.46 1189.5,-18299.46 1189.5,-18246.46 1400.5,-18246.46 1400.5,-18299.46"/>
<text text-anchor="middle" x="1295" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1295" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_11×V_11</text>
<text text-anchor="middle" x="1295" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_6_2&#45;&gt;ring_stage0_7_2 -->
<g id="edge344" class="edge">
<title>ring_stage0_6_2&#45;&gt;ring_stage0_7_2</title>
<path fill="none" stroke="black" d="M1455.02,-18336.09C1428.57,-18325.82 1397.93,-18313.92 1370.58,-18303.3"/>
<polygon fill="black" stroke="black" points="1371.65,-18299.96 1361.06,-18299.61 1369.11,-18306.49 1371.65,-18299.96"/>
</g>
<!-- kv_send0_6_3 -->
<g id="node230" class="node">
<title>kv_send0_6_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3161" cy="-19619.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3161" y="-19622.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="3161" y="-19607.86" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_6_3&#45;&gt;kv_send0_6_3 -->
<g id="edge301" class="edge">
<title>ring_stage0_6_3&#45;&gt;kv_send0_6_3</title>
<path fill="none" stroke="black" d="M2992.48,-19682.19C3024.31,-19670.45 3061.9,-19656.6 3093.49,-19644.95"/>
<polygon fill="black" stroke="black" points="3094.91,-19648.16 3103.08,-19641.41 3092.49,-19641.59 3094.91,-19648.16"/>
</g>
<!-- ring_stage0_7_3 -->
<g id="node246" class="node">
<title>ring_stage0_7_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2067.5,-18209.72 1856.5,-18209.72 1856.5,-18156.72 2067.5,-18156.72 2067.5,-18209.72"/>
<text text-anchor="middle" x="1962" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1962" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_12×V_12</text>
<text text-anchor="middle" x="1962" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_6_3&#45;&gt;ring_stage0_7_3 -->
<g id="edge347" class="edge">
<title>ring_stage0_6_3&#45;&gt;ring_stage0_7_3</title>
<path fill="none" stroke="black" d="M2872.65,-19682.26C2858.84,-19672.76 2845.38,-19660.63 2837,-19645.93 2817.17,-19611.14 2830.78,-19596.2 2829,-19556.19 2827.94,-19532.33 2824.04,-19525.82 2829,-19502.45 2832.63,-19485.32 2841.17,-19483.54 2845,-19466.45 2867.65,-19365.29 2851.88,-19336.86 2849,-19233.23 2847.89,-19193.3 2870.34,-19173.52 2844,-19143.49 2787.03,-19078.55 2711.56,-19170.99 2653,-19107.49 2633.98,-19086.87 2622.23,-18625.47 2603,-18605.05 2532.38,-18530.04 2448.37,-18640.36 2374,-18569.05 2347.68,-18543.82 2342.4,-18271.23 2316,-18246.09 2278.93,-18210.79 2143.74,-18219.06 2077.54,-18210.06"/>
<polygon fill="black" stroke="black" points="2077.96,-18206.58 2067.53,-18208.46 2076.85,-18213.49 2077.96,-18206.58"/>
</g>
<!-- kv_send0_6_4 -->
<g id="node231" class="node">
<title>kv_send0_6_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3619" cy="-19529.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3619" y="-19533.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="3619" y="-19518.12" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_6_4&#45;&gt;kv_send0_6_4 -->
<g id="edge304" class="edge">
<title>ring_stage0_6_4&#45;&gt;kv_send0_6_4</title>
<path fill="none" stroke="black" d="M3618.29,-19592.21C3618.39,-19584.16 3618.49,-19575.13 3618.59,-19566.51"/>
<polygon fill="black" stroke="black" points="3622.09,-19566.33 3618.7,-19556.29 3615.09,-19566.25 3622.09,-19566.33"/>
</g>
<!-- ring_stage0_7_4 -->
<g id="node247" class="node">
<title>ring_stage0_7_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3951.5,-19555.82 3740.5,-19555.82 3740.5,-19502.82 3951.5,-19502.82 3951.5,-19555.82"/>
<text text-anchor="middle" x="3846" y="-19540.62" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="3846" y="-19525.62" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_13×V_13</text>
<text text-anchor="middle" x="3846" y="-19510.62" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_6_4&#45;&gt;ring_stage0_7_4 -->
<g id="edge350" class="edge">
<title>ring_stage0_6_4&#45;&gt;ring_stage0_7_4</title>
<path fill="none" stroke="black" d="M3684.56,-19592.45C3711.25,-19582.18 3742.16,-19570.28 3769.75,-19559.67"/>
<polygon fill="black" stroke="black" points="3771.28,-19562.83 3779.36,-19555.97 3768.77,-19556.29 3771.28,-19562.83"/>
</g>
<!-- kv_send0_6_5 -->
<g id="node232" class="node">
<title>kv_send0_6_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3198" cy="-19439.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3198" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="3198" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_6_5&#45;&gt;kv_send0_6_5 -->
<g id="edge307" class="edge">
<title>ring_stage0_6_5&#45;&gt;kv_send0_6_5</title>
<path fill="none" stroke="black" d="M3176.84,-19502.47C3179.65,-19494.25 3182.81,-19484.99 3185.82,-19476.2"/>
<polygon fill="black" stroke="black" points="3189.2,-19477.15 3189.12,-19466.55 3182.57,-19474.88 3189.2,-19477.15"/>
</g>
<!-- ring_stage0_7_5 -->
<g id="node248" class="node">
<title>ring_stage0_7_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3595.5,-19466.08 3384.5,-19466.08 3384.5,-19413.08 3595.5,-19413.08 3595.5,-19466.08"/>
<text text-anchor="middle" x="3490" y="-19450.88" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="3490" y="-19435.88" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_14×V_14</text>
<text text-anchor="middle" x="3490" y="-19420.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_6_5&#45;&gt;ring_stage0_7_5 -->
<g id="edge353" class="edge">
<title>ring_stage0_6_5&#45;&gt;ring_stage0_7_5</title>
<path fill="none" stroke="black" d="M3262,-19502.71C3301.02,-19492.08 3346.42,-19479.71 3386.39,-19468.81"/>
<polygon fill="black" stroke="black" points="3387.43,-19472.16 3396.16,-19466.15 3385.59,-19465.4 3387.43,-19472.16"/>
</g>
<!-- kv_send0_6_6 -->
<g id="node233" class="node">
<title>kv_send0_6_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2977" cy="-19349.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2977" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2977" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_6_6&#45;&gt;kv_send0_6_6 -->
<g id="edge310" class="edge">
<title>ring_stage0_6_6&#45;&gt;kv_send0_6_6</title>
<path fill="none" stroke="black" d="M2974.88,-19412.73C2975.16,-19404.68 2975.47,-19395.65 2975.76,-19387.03"/>
<polygon fill="black" stroke="black" points="2979.27,-19386.92 2976.11,-19376.81 2972.27,-19386.69 2979.27,-19386.92"/>
</g>
<!-- ring_stage0_7_6 -->
<g id="node249" class="node">
<title>ring_stage0_7_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3309.5,-19376.34 3098.5,-19376.34 3098.5,-19323.34 3309.5,-19323.34 3309.5,-19376.34"/>
<text text-anchor="middle" x="3204" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="3204" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_15×V_15</text>
<text text-anchor="middle" x="3204" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_6_6&#45;&gt;ring_stage0_7_6 -->
<g id="edge356" class="edge">
<title>ring_stage0_6_6&#45;&gt;ring_stage0_7_6</title>
<path fill="none" stroke="black" d="M3041.14,-19412.97C3068.07,-19402.7 3099.25,-19390.8 3127.08,-19380.18"/>
<polygon fill="black" stroke="black" points="3128.68,-19383.32 3136.77,-19376.49 3126.18,-19376.78 3128.68,-19383.32"/>
</g>
<!-- kv_send0_6_7 -->
<g id="node234" class="node">
<title>kv_send0_6_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2737" cy="-19260.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2737" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2737" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_6_7&#45;&gt;kv_send0_6_7 -->
<g id="edge313" class="edge">
<title>ring_stage0_6_7&#45;&gt;kv_send0_6_7</title>
<path fill="none" stroke="black" d="M2736.29,-19322.99C2736.39,-19314.94 2736.49,-19305.91 2736.59,-19297.29"/>
<polygon fill="black" stroke="black" points="2740.09,-19297.11 2736.7,-19287.07 2733.09,-19297.03 2740.09,-19297.11"/>
</g>
<!-- ring_stage0_7_7 -->
<g id="node250" class="node">
<title>ring_stage0_7_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3073.5,-19286.6 2880.5,-19286.6 2880.5,-19233.6 3073.5,-19233.6 3073.5,-19286.6"/>
<text text-anchor="middle" x="2977" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="2977" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_0×V_0</text>
<text text-anchor="middle" x="2977" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_6_7&#45;&gt;ring_stage0_7_7 -->
<g id="edge359" class="edge">
<title>ring_stage0_6_7&#45;&gt;ring_stage0_7_7</title>
<path fill="none" stroke="black" d="M2806.36,-19323.23C2834.69,-19312.91 2867.53,-19300.96 2896.78,-19290.31"/>
<polygon fill="black" stroke="black" points="2898.36,-19293.46 2906.56,-19286.75 2895.96,-19286.88 2898.36,-19293.46"/>
</g>
<!-- kv_send0_6_8 -->
<g id="node235" class="node">
<title>kv_send0_6_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2519" cy="-19170.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2519" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="2519" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_6_8&#45;&gt;kv_send0_6_8 -->
<g id="edge316" class="edge">
<title>ring_stage0_6_8&#45;&gt;kv_send0_6_8</title>
<path fill="none" stroke="black" d="M2519,-19233.25C2519,-19225.2 2519,-19216.17 2519,-19207.55"/>
<polygon fill="black" stroke="black" points="2522.5,-19207.33 2519,-19197.33 2515.5,-19207.33 2522.5,-19207.33"/>
</g>
<!-- ring_stage0_7_8 -->
<g id="node251" class="node">
<title>ring_stage0_7_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2834.5,-19196.86 2641.5,-19196.86 2641.5,-19143.86 2834.5,-19143.86 2834.5,-19196.86"/>
<text text-anchor="middle" x="2738" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="2738" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_1×V_1</text>
<text text-anchor="middle" x="2738" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_6_8&#45;&gt;ring_stage0_7_8 -->
<g id="edge362" class="edge">
<title>ring_stage0_6_8&#45;&gt;ring_stage0_7_8</title>
<path fill="none" stroke="black" d="M2582.93,-19233.49C2608.46,-19223.26 2638,-19211.42 2664.41,-19200.84"/>
<polygon fill="black" stroke="black" points="2666.01,-19203.98 2673.99,-19197.01 2663.4,-19197.48 2666.01,-19203.98"/>
</g>
<!-- kv_send0_6_9 -->
<g id="node236" class="node">
<title>kv_send0_6_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2295" cy="-19080.62" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2295" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2295" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_6_9&#45;&gt;kv_send0_6_9 -->
<g id="edge319" class="edge">
<title>ring_stage0_6_9&#45;&gt;kv_send0_6_9</title>
<path fill="none" stroke="black" d="M2299.23,-19143.51C2298.68,-19135.46 2298.06,-19126.43 2297.47,-19117.81"/>
<polygon fill="black" stroke="black" points="2300.95,-19117.33 2296.78,-19107.59 2293.97,-19117.81 2300.95,-19117.33"/>
</g>
<!-- ring_stage0_7_9 -->
<g id="node252" class="node">
<title>ring_stage0_7_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2615.5,-19107.12 2422.5,-19107.12 2422.5,-19054.12 2615.5,-19054.12 2615.5,-19107.12"/>
<text text-anchor="middle" x="2519" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="2519" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_2×V_2</text>
<text text-anchor="middle" x="2519" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_6_9&#45;&gt;ring_stage0_7_9 -->
<g id="edge365" class="edge">
<title>ring_stage0_6_9&#45;&gt;ring_stage0_7_9</title>
<path fill="none" stroke="black" d="M2364.64,-19143.75C2390.05,-19133.52 2419.46,-19121.68 2445.75,-19111.1"/>
<polygon fill="black" stroke="black" points="2447.31,-19114.25 2455.28,-19107.27 2444.7,-19107.75 2447.31,-19114.25"/>
</g>
<!-- kv_send0_6_10 -->
<g id="node237" class="node">
<title>kv_send0_6_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2056" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2056" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2056" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_6_10&#45;&gt;kv_send0_6_10 -->
<g id="edge322" class="edge">
<title>ring_stage0_6_10&#45;&gt;kv_send0_6_10</title>
<path fill="none" stroke="black" d="M2062.35,-19053.77C2061.52,-19045.72 2060.6,-19036.69 2059.71,-19028.07"/>
<polygon fill="black" stroke="black" points="2063.17,-19027.44 2058.66,-19017.85 2056.2,-19028.16 2063.17,-19027.44"/>
</g>
<!-- ring_stage0_7_10 -->
<g id="node253" class="node">
<title>ring_stage0_7_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2386,-19017.38 2184,-19017.38 2184,-18964.38 2386,-18964.38 2386,-19017.38"/>
<text text-anchor="middle" x="2285" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="2285" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_3×V_3</text>
<text text-anchor="middle" x="2285" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_6_10&#45;&gt;ring_stage0_7_10 -->
<g id="edge368" class="edge">
<title>ring_stage0_6_10&#45;&gt;ring_stage0_7_10</title>
<path fill="none" stroke="black" d="M2129.22,-19054.01C2154.87,-19043.78 2184.55,-19031.94 2211.08,-19021.36"/>
<polygon fill="black" stroke="black" points="2212.7,-19024.48 2220.7,-19017.53 2210.11,-19017.98 2212.7,-19024.48"/>
</g>
<!-- kv_send0_6_11 -->
<g id="node238" class="node">
<title>kv_send0_6_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1817" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1817" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="1817" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_6_11&#45;&gt;kv_send0_6_11 -->
<g id="edge325" class="edge">
<title>ring_stage0_6_11&#45;&gt;kv_send0_6_11</title>
<path fill="none" stroke="black" d="M1824.05,-18964.03C1823.13,-18955.89 1822.08,-18946.75 1821.09,-18938.05"/>
<polygon fill="black" stroke="black" points="1824.57,-18937.65 1819.96,-18928.11 1817.61,-18938.44 1824.57,-18937.65"/>
</g>
<!-- ring_stage0_7_11 -->
<g id="node254" class="node">
<title>ring_stage0_7_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2147,-18927.64 1945,-18927.64 1945,-18874.64 2147,-18874.64 2147,-18927.64"/>
<text text-anchor="middle" x="2046" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="2046" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_4×V_4</text>
<text text-anchor="middle" x="2046" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_6_11&#45;&gt;ring_stage0_7_11 -->
<g id="edge371" class="edge">
<title>ring_stage0_6_11&#45;&gt;ring_stage0_7_11</title>
<path fill="none" stroke="black" d="M1890.93,-18964.27C1916.46,-18954.04 1946,-18942.2 1972.41,-18931.62"/>
<polygon fill="black" stroke="black" points="1974.01,-18934.76 1981.99,-18927.79 1971.4,-18928.26 1974.01,-18934.76"/>
</g>
<!-- kv_send0_6_12 -->
<g id="node239" class="node">
<title>kv_send0_6_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1557" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1557" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="1557" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_6_12&#45;&gt;kv_send0_6_12 -->
<g id="edge328" class="edge">
<title>ring_stage0_6_12&#45;&gt;kv_send0_6_12</title>
<path fill="none" stroke="black" d="M1564.76,-18874.29C1563.74,-18866.15 1562.59,-18857.01 1561.5,-18848.31"/>
<polygon fill="black" stroke="black" points="1564.97,-18847.86 1560.26,-18838.37 1558.03,-18848.73 1564.97,-18847.86"/>
</g>
<!-- ring_stage0_7_12 -->
<g id="node255" class="node">
<title>ring_stage0_7_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1907,-18837.9 1705,-18837.9 1705,-18784.9 1907,-18784.9 1907,-18837.9"/>
<text text-anchor="middle" x="1806" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1806" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_5×V_5</text>
<text text-anchor="middle" x="1806" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_6_12&#45;&gt;ring_stage0_7_12 -->
<g id="edge374" class="edge">
<title>ring_stage0_6_12&#45;&gt;ring_stage0_7_12</title>
<path fill="none" stroke="black" d="M1637.48,-18874.53C1665.46,-18864.21 1697.89,-18852.26 1726.78,-18841.61"/>
<polygon fill="black" stroke="black" points="1728.26,-18844.79 1736.43,-18838.05 1725.84,-18838.22 1728.26,-18844.79"/>
</g>
<!-- kv_send0_6_13 -->
<g id="node240" class="node">
<title>kv_send0_6_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1324" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1324" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="1324" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_6_13&#45;&gt;kv_send0_6_13 -->
<g id="edge331" class="edge">
<title>ring_stage0_6_13&#45;&gt;kv_send0_6_13</title>
<path fill="none" stroke="black" d="M1326.82,-18784.55C1326.45,-18776.5 1326.04,-18767.47 1325.65,-18758.85"/>
<polygon fill="black" stroke="black" points="1329.14,-18758.46 1325.18,-18748.63 1322.14,-18758.78 1329.14,-18758.46"/>
</g>
<!-- ring_stage0_7_13 -->
<g id="node256" class="node">
<title>ring_stage0_7_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1654,-18748.16 1452,-18748.16 1452,-18695.16 1654,-18695.16 1654,-18748.16"/>
<text text-anchor="middle" x="1553" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1553" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_6×V_6</text>
<text text-anchor="middle" x="1553" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_6_13&#45;&gt;ring_stage0_7_13 -->
<g id="edge377" class="edge">
<title>ring_stage0_6_13&#45;&gt;ring_stage0_7_13</title>
<path fill="none" stroke="black" d="M1393.68,-18784.79C1420.02,-18774.52 1450.53,-18762.62 1477.75,-18752"/>
<polygon fill="black" stroke="black" points="1479.19,-18755.2 1487.23,-18748.31 1476.65,-18748.68 1479.19,-18755.2"/>
</g>
<!-- kv_send0_6_14 -->
<g id="node241" class="node">
<title>kv_send0_6_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1081" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1081" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="1081" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_6_14&#45;&gt;kv_send0_6_14 -->
<g id="edge334" class="edge">
<title>ring_stage0_6_14&#45;&gt;kv_send0_6_14</title>
<path fill="none" stroke="black" d="M1090.88,-18694.81C1089.58,-18686.67 1088.12,-18677.53 1086.73,-18668.83"/>
<polygon fill="black" stroke="black" points="1090.18,-18668.21 1085.14,-18658.89 1083.26,-18669.32 1090.18,-18668.21"/>
</g>
<!-- ring_stage0_7_14 -->
<g id="node257" class="node">
<title>ring_stage0_7_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1412,-18658.42 1210,-18658.42 1210,-18605.42 1412,-18605.42 1412,-18658.42"/>
<text text-anchor="middle" x="1311" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1311" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_7×V_7</text>
<text text-anchor="middle" x="1311" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_6_14&#45;&gt;ring_stage0_7_14 -->
<g id="edge380" class="edge">
<title>ring_stage0_6_14&#45;&gt;ring_stage0_7_14</title>
<path fill="none" stroke="black" d="M1158.06,-18695.05C1183.23,-18684.82 1212.37,-18672.98 1238.42,-18662.4"/>
<polygon fill="black" stroke="black" points="1239.92,-18665.57 1247.86,-18658.57 1237.28,-18659.09 1239.92,-18665.57"/>
</g>
<!-- kv_send0_6_15 -->
<g id="node242" class="node">
<title>kv_send0_6_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="848" cy="-18542.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="848" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="848" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_6_15&#45;&gt;kv_send0_6_15 -->
<g id="edge337" class="edge">
<title>ring_stage0_6_15&#45;&gt;kv_send0_6_15</title>
<path fill="none" stroke="black" d="M848,-18605.07C848,-18597.02 848,-18587.99 848,-18579.37"/>
<polygon fill="black" stroke="black" points="851.5,-18579.15 848,-18569.15 844.5,-18579.15 851.5,-18579.15"/>
</g>
<!-- ring_stage0_7_15 -->
<g id="node258" class="node">
<title>ring_stage0_7_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1171,-18568.68 969,-18568.68 969,-18515.68 1171,-18515.68 1171,-18568.68"/>
<text text-anchor="middle" x="1070" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="1070" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_8×V_8</text>
<text text-anchor="middle" x="1070" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_6_15&#45;&gt;ring_stage0_7_15 -->
<g id="edge383" class="edge">
<title>ring_stage0_6_15&#45;&gt;ring_stage0_7_15</title>
<path fill="none" stroke="black" d="M912.81,-18605.31C938.8,-18595.04 968.9,-18583.14 995.76,-18572.52"/>
<polygon fill="black" stroke="black" points="997.1,-18575.76 1005.11,-18568.83 994.52,-18569.25 997.1,-18575.76"/>
</g>
<!-- kv_send0_6_0&#45;&gt;ring_stage0_7_1 -->
<g id="edge342" class="edge">
<title>kv_send0_6_0&#45;&gt;ring_stage0_7_1</title>
<path fill="none" stroke="black" d="M350.44,-18429.86C321.27,-18418.74 285.27,-18405 253.64,-18392.94"/>
<polygon fill="black" stroke="black" points="254.56,-18389.54 243.97,-18389.25 252.07,-18396.08 254.56,-18389.54"/>
</g>
<!-- kv_send0_6_1&#45;&gt;ring_stage0_7_2 -->
<g id="edge345" class="edge">
<title>kv_send0_6_1&#45;&gt;ring_stage0_7_2</title>
<path fill="none" stroke="black" d="M475.65,-18343.22C488.99,-18340.33 502.86,-18337.69 516,-18335.83 806.86,-18294.62 884.88,-18339.16 1176,-18299.83 1177.1,-18299.68 1178.2,-18299.53 1179.31,-18299.37"/>
<polygon fill="black" stroke="black" points="1180.04,-18302.8 1189.39,-18297.83 1178.98,-18295.88 1180.04,-18302.8"/>
</g>
<!-- kv_send0_6_2&#45;&gt;ring_stage0_7_3 -->
<g id="edge348" class="edge">
<title>kv_send0_6_2&#45;&gt;ring_stage0_7_3</title>
<path fill="none" stroke="black" d="M1799.2,-18250.05C1826.5,-18239.01 1859.98,-18225.47 1889.46,-18213.55"/>
<polygon fill="black" stroke="black" points="1890.92,-18216.74 1898.88,-18209.74 1888.3,-18210.25 1890.92,-18216.74"/>
</g>
<!-- kv_send0_6_3&#45;&gt;ring_stage0_7_4 -->
<g id="edge351" class="edge">
<title>kv_send0_6_3&#45;&gt;ring_stage0_7_4</title>
<path fill="none" stroke="black" d="M3234.35,-19600.07C3248.44,-19597.08 3263.13,-19594.28 3277,-19592.19 3473.93,-19562.57 3529.1,-19585.71 3730.21,-19556.21"/>
<polygon fill="black" stroke="black" points="3730.83,-19559.65 3740.21,-19554.72 3729.8,-19552.73 3730.83,-19559.65"/>
</g>
<!-- kv_send0_6_4&#45;&gt;ring_stage0_7_5 -->
<g id="edge354" class="edge">
<title>kv_send0_6_4&#45;&gt;ring_stage0_7_5</title>
<path fill="none" stroke="black" d="M3583.07,-19503.88C3568.47,-19493.96 3551.43,-19482.37 3535.95,-19471.84"/>
<polygon fill="black" stroke="black" points="3537.78,-19468.84 3527.54,-19466.11 3533.84,-19474.63 3537.78,-19468.84"/>
</g>
<!-- kv_send0_6_5&#45;&gt;ring_stage0_7_6 -->
<g id="edge357" class="edge">
<title>kv_send0_6_5&#45;&gt;ring_stage0_7_6</title>
<path fill="none" stroke="black" d="M3199.8,-19412.26C3200.35,-19404.22 3200.96,-19395.24 3201.55,-19386.68"/>
<polygon fill="black" stroke="black" points="3205.05,-19386.76 3202.24,-19376.54 3198.07,-19386.28 3205.05,-19386.76"/>
</g>
<!-- kv_send0_6_6&#45;&gt;ring_stage0_7_7 -->
<g id="edge360" class="edge">
<title>kv_send0_6_6&#45;&gt;ring_stage0_7_7</title>
<path fill="none" stroke="black" d="M2977,-19322.52C2977,-19314.48 2977,-19305.5 2977,-19296.94"/>
<polygon fill="black" stroke="black" points="2980.5,-19296.8 2977,-19286.8 2973.5,-19296.8 2980.5,-19296.8"/>
</g>
<!-- kv_send0_6_7&#45;&gt;ring_stage0_7_8 -->
<g id="edge363" class="edge">
<title>kv_send0_6_7&#45;&gt;ring_stage0_7_8</title>
<path fill="none" stroke="black" d="M2737.3,-19232.78C2737.39,-19224.74 2737.49,-19215.76 2737.59,-19207.2"/>
<polygon fill="black" stroke="black" points="2741.09,-19207.1 2737.71,-19197.06 2734.09,-19207.02 2741.09,-19207.1"/>
</g>
<!-- kv_send0_6_8&#45;&gt;ring_stage0_7_9 -->
<g id="edge366" class="edge">
<title>kv_send0_6_8&#45;&gt;ring_stage0_7_9</title>
<path fill="none" stroke="black" d="M2519,-19143.04C2519,-19135 2519,-19126.02 2519,-19117.46"/>
<polygon fill="black" stroke="black" points="2522.5,-19117.32 2519,-19107.32 2515.5,-19117.32 2522.5,-19117.32"/>
</g>
<!-- kv_send0_6_9&#45;&gt;ring_stage0_7_10 -->
<g id="edge369" class="edge">
<title>kv_send0_6_9&#45;&gt;ring_stage0_7_10</title>
<path fill="none" stroke="black" d="M2292,-19053.3C2291.08,-19045.26 2290.06,-19036.28 2289.08,-19027.72"/>
<polygon fill="black" stroke="black" points="2292.54,-19027.12 2287.93,-19017.58 2285.58,-19027.92 2292.54,-19027.12"/>
</g>
<!-- kv_send0_6_10&#45;&gt;ring_stage0_7_11 -->
<g id="edge372" class="edge">
<title>kv_send0_6_10&#45;&gt;ring_stage0_7_11</title>
<path fill="none" stroke="black" d="M2053,-18963.56C2052.08,-18955.52 2051.06,-18946.54 2050.08,-18937.98"/>
<polygon fill="black" stroke="black" points="2053.54,-18937.38 2048.93,-18927.84 2046.58,-18938.18 2053.54,-18937.38"/>
</g>
<!-- kv_send0_6_11&#45;&gt;ring_stage0_7_12 -->
<g id="edge375" class="edge">
<title>kv_send0_6_11&#45;&gt;ring_stage0_7_12</title>
<path fill="none" stroke="black" d="M1813.7,-18873.82C1812.69,-18865.78 1811.57,-18856.8 1810.49,-18848.24"/>
<polygon fill="black" stroke="black" points="1813.94,-18847.59 1809.22,-18838.1 1806.99,-18848.46 1813.94,-18847.59"/>
</g>
<!-- kv_send0_6_12&#45;&gt;ring_stage0_7_13 -->
<g id="edge378" class="edge">
<title>kv_send0_6_12&#45;&gt;ring_stage0_7_13</title>
<path fill="none" stroke="black" d="M1555.8,-18784.08C1555.43,-18776.04 1555.02,-18767.06 1554.63,-18758.5"/>
<polygon fill="black" stroke="black" points="1558.12,-18758.19 1554.17,-18748.36 1551.13,-18758.51 1558.12,-18758.19"/>
</g>
<!-- kv_send0_6_13&#45;&gt;ring_stage0_7_14 -->
<g id="edge381" class="edge">
<title>kv_send0_6_13&#45;&gt;ring_stage0_7_14</title>
<path fill="none" stroke="black" d="M1320.1,-18694.34C1318.91,-18686.3 1317.58,-18677.32 1316.31,-18668.76"/>
<polygon fill="black" stroke="black" points="1319.74,-18668 1314.81,-18658.62 1312.81,-18669.03 1319.74,-18668"/>
</g>
<!-- kv_send0_6_14&#45;&gt;ring_stage0_7_15 -->
<g id="edge384" class="edge">
<title>kv_send0_6_14&#45;&gt;ring_stage0_7_15</title>
<path fill="none" stroke="black" d="M1077.7,-18604.6C1076.69,-18596.56 1075.57,-18587.58 1074.49,-18579.02"/>
<polygon fill="black" stroke="black" points="1077.94,-18578.37 1073.22,-18568.88 1070.99,-18579.24 1077.94,-18578.37"/>
</g>
<!-- kv_send0_6_15&#45;&gt;ring_stage0_7_0 -->
<g id="edge339" class="edge">
<title>kv_send0_6_15&#45;&gt;ring_stage0_7_0</title>
<path fill="none" stroke="black" d="M792.84,-18519.38C764.91,-18508.34 730.61,-18494.79 700.39,-18482.84"/>
<polygon fill="black" stroke="black" points="701.32,-18479.45 690.73,-18479.02 698.75,-18485.96 701.32,-18479.45"/>
</g>
<!-- kv_send0_7_0 -->
<g id="node259" class="node">
<title>kv_send0_7_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="628" cy="-18362.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="628" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="628" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_7_0&#45;&gt;kv_send0_7_0 -->
<g id="edge340" class="edge">
<title>ring_stage0_7_0&#45;&gt;kv_send0_7_0</title>
<path fill="none" stroke="black" d="M626.59,-18425.59C626.77,-18417.54 626.98,-18408.51 627.18,-18399.89"/>
<polygon fill="black" stroke="black" points="630.68,-18399.75 627.41,-18389.67 623.68,-18399.59 630.68,-18399.75"/>
</g>
<!-- ring_stage0_8_0 -->
<g id="node275" class="node">
<title>ring_stage0_8_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="942.5,-18389.2 749.5,-18389.2 749.5,-18336.2 942.5,-18336.2 942.5,-18389.2"/>
<text text-anchor="middle" x="846" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="846" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_8×V_8</text>
<text text-anchor="middle" x="846" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_7_0&#45;&gt;ring_stage0_8_0 -->
<g id="edge386" class="edge">
<title>ring_stage0_7_0&#45;&gt;ring_stage0_8_0</title>
<path fill="none" stroke="black" d="M690.22,-18425.83C715.87,-18415.6 745.55,-18403.76 772.08,-18393.18"/>
<polygon fill="black" stroke="black" points="773.7,-18396.3 781.7,-18389.35 771.11,-18389.8 773.7,-18396.3"/>
</g>
<!-- kv_send0_7_1 -->
<g id="node260" class="node">
<title>kv_send0_7_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="403" cy="-18272.96" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="403" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="403" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_7_1&#45;&gt;kv_send0_7_1 -->
<g id="edge343" class="edge">
<title>ring_stage0_7_1&#45;&gt;kv_send0_7_1</title>
<path fill="none" stroke="black" d="M242.98,-18336.09C272.84,-18324.49 308.03,-18310.83 337.8,-18299.27"/>
<polygon fill="black" stroke="black" points="339.2,-18302.48 347.26,-18295.6 336.67,-18295.96 339.2,-18302.48"/>
</g>
<!-- ring_stage0_8_1 -->
<g id="node276" class="node">
<title>ring_stage0_8_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="280.5,-18299.46 87.5,-18299.46 87.5,-18246.46 280.5,-18246.46 280.5,-18299.46"/>
<text text-anchor="middle" x="184" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="184" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_9×V_9</text>
<text text-anchor="middle" x="184" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_7_1&#45;&gt;ring_stage0_8_1 -->
<g id="edge389" class="edge">
<title>ring_stage0_7_1&#45;&gt;ring_stage0_8_1</title>
<path fill="none" stroke="black" d="M179.06,-18335.85C179.72,-18327.64 180.45,-18318.41 181.15,-18309.63"/>
<polygon fill="black" stroke="black" points="184.65,-18309.87 181.95,-18299.63 177.67,-18309.32 184.65,-18309.87"/>
</g>
<!-- kv_send0_7_2 -->
<g id="node261" class="node">
<title>kv_send0_7_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1515" cy="-18183.22" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1515" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="1515" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_7_2&#45;&gt;kv_send0_7_2 -->
<g id="edge346" class="edge">
<title>ring_stage0_7_2&#45;&gt;kv_send0_7_2</title>
<path fill="none" stroke="black" d="M1359.22,-18246.35C1387.94,-18234.89 1421.72,-18221.42 1450.47,-18209.96"/>
<polygon fill="black" stroke="black" points="1452.02,-18213.11 1460.01,-18206.15 1449.43,-18206.6 1452.02,-18213.11"/>
</g>
<!-- ring_stage0_8_2 -->
<g id="node277" class="node">
<title>ring_stage0_8_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1169.5,-18209.72 958.5,-18209.72 958.5,-18156.72 1169.5,-18156.72 1169.5,-18209.72"/>
<text text-anchor="middle" x="1064" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="1064" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_10×V_10</text>
<text text-anchor="middle" x="1064" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_7_2&#45;&gt;ring_stage0_8_2 -->
<g id="edge392" class="edge">
<title>ring_stage0_7_2&#45;&gt;ring_stage0_8_2</title>
<path fill="none" stroke="black" d="M1227.56,-18246.35C1200.4,-18236.03 1168.93,-18224.08 1140.89,-18213.42"/>
<polygon fill="black" stroke="black" points="1142.11,-18210.15 1131.52,-18209.87 1139.63,-18216.69 1142.11,-18210.15"/>
</g>
<!-- kv_send0_7_3 -->
<g id="node262" class="node">
<title>kv_send0_7_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2106" cy="-18093.48" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2106" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="2106" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_7_3&#45;&gt;kv_send0_7_3 -->
<g id="edge349" class="edge">
<title>ring_stage0_7_3&#45;&gt;kv_send0_7_3</title>
<path fill="none" stroke="black" d="M2004.04,-18156.61C2020.86,-18146.36 2040.34,-18134.48 2057.74,-18123.88"/>
<polygon fill="black" stroke="black" points="2059.91,-18126.66 2066.63,-18118.47 2056.27,-18120.69 2059.91,-18126.66"/>
</g>
<!-- ring_stage0_8_3 -->
<g id="node278" class="node">
<title>ring_stage0_8_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1764.5,-18119.98 1553.5,-18119.98 1553.5,-18066.98 1764.5,-18066.98 1764.5,-18119.98"/>
<text text-anchor="middle" x="1659" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="1659" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_11×V_11</text>
<text text-anchor="middle" x="1659" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_7_3&#45;&gt;ring_stage0_8_3 -->
<g id="edge395" class="edge">
<title>ring_stage0_7_3&#45;&gt;ring_stage0_8_3</title>
<path fill="none" stroke="black" d="M1873.55,-18156.61C1837.07,-18146.04 1794.65,-18133.76 1757.21,-18122.92"/>
<polygon fill="black" stroke="black" points="1757.88,-18119.47 1747.3,-18120.05 1755.93,-18126.19 1757.88,-18119.47"/>
</g>
<!-- kv_send0_7_4 -->
<g id="node263" class="node">
<title>kv_send0_7_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3733" cy="-19439.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3733" y="-19443.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="3733" y="-19428.38" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_7_4&#45;&gt;kv_send0_7_4 -->
<g id="edge352" class="edge">
<title>ring_stage0_7_4&#45;&gt;kv_send0_7_4</title>
<path fill="none" stroke="black" d="M3813.01,-19502.71C3800.39,-19492.91 3785.86,-19481.63 3772.67,-19471.39"/>
<polygon fill="black" stroke="black" points="3774.71,-19468.54 3764.67,-19465.17 3770.42,-19474.07 3774.71,-19468.54"/>
</g>
<!-- ring_stage0_8_4 -->
<g id="node279" class="node">
<title>ring_stage0_8_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2211.5,-18004.11 2000.5,-18004.11 2000.5,-17951.11 2211.5,-17951.11 2211.5,-18004.11"/>
<text text-anchor="middle" x="2106" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2106" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_12×V_12</text>
<text text-anchor="middle" x="2106" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_7_4&#45;&gt;ring_stage0_8_4 -->
<g id="edge398" class="edge">
<title>ring_stage0_7_4&#45;&gt;ring_stage0_8_4</title>
<path fill="none" stroke="black" d="M3848.34,-19502.78C3851.3,-19468.32 3856,-19405 3856,-19350.84 3856,-19350.84 3856,-19350.84 3856,-18720.66 3856,-18711.4 3733.09,-18072.57 3726,-18066.61 3661.99,-18012.78 2302.54,-18049.21 2221,-18030.61 2200.44,-18025.92 2179.09,-18017.41 2160.44,-18008.61"/>
<polygon fill="black" stroke="black" points="2161.76,-18005.36 2151.24,-18004.14 2158.71,-18011.66 2161.76,-18005.36"/>
</g>
<!-- kv_send0_7_5 -->
<g id="node264" class="node">
<title>kv_send0_7_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3489" cy="-19349.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3489" y="-19353.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="3489" y="-19338.64" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_7_5&#45;&gt;kv_send0_7_5 -->
<g id="edge355" class="edge">
<title>ring_stage0_7_5&#45;&gt;kv_send0_7_5</title>
<path fill="none" stroke="black" d="M3489.71,-19412.73C3489.61,-19404.68 3489.51,-19395.65 3489.41,-19387.03"/>
<polygon fill="black" stroke="black" points="3492.91,-19386.77 3489.3,-19376.81 3485.91,-19386.85 3492.91,-19386.77"/>
</g>
<!-- ring_stage0_8_5 -->
<g id="node280" class="node">
<title>ring_stage0_8_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3826.5,-19376.34 3615.5,-19376.34 3615.5,-19323.34 3826.5,-19323.34 3826.5,-19376.34"/>
<text text-anchor="middle" x="3721" y="-19361.14" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="3721" y="-19346.14" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_13×V_13</text>
<text text-anchor="middle" x="3721" y="-19331.14" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_7_5&#45;&gt;ring_stage0_8_5 -->
<g id="edge401" class="edge">
<title>ring_stage0_7_5&#45;&gt;ring_stage0_8_5</title>
<path fill="none" stroke="black" d="M3557.44,-19412.97C3584.6,-19402.65 3616.07,-19390.7 3644.11,-19380.05"/>
<polygon fill="black" stroke="black" points="3645.37,-19383.31 3653.48,-19376.49 3642.89,-19376.77 3645.37,-19383.31"/>
</g>
<!-- kv_send0_7_6 -->
<g id="node265" class="node">
<title>kv_send0_7_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3204" cy="-19260.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3204" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3204" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_7_6&#45;&gt;kv_send0_7_6 -->
<g id="edge358" class="edge">
<title>ring_stage0_7_6&#45;&gt;kv_send0_7_6</title>
<path fill="none" stroke="black" d="M3204,-19322.99C3204,-19314.94 3204,-19305.91 3204,-19297.29"/>
<polygon fill="black" stroke="black" points="3207.5,-19297.07 3204,-19287.07 3200.5,-19297.07 3207.5,-19297.07"/>
</g>
<!-- ring_stage0_8_6 -->
<g id="node281" class="node">
<title>ring_stage0_8_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3564.5,-19286.6 3353.5,-19286.6 3353.5,-19233.6 3564.5,-19233.6 3564.5,-19286.6"/>
<text text-anchor="middle" x="3459" y="-19271.4" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="3459" y="-19256.4" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_14×V_14</text>
<text text-anchor="middle" x="3459" y="-19241.4" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_7_6&#45;&gt;ring_stage0_8_6 -->
<g id="edge404" class="edge">
<title>ring_stage0_7_6&#45;&gt;ring_stage0_8_6</title>
<path fill="none" stroke="black" d="M3278.44,-19323.23C3308.68,-19312.82 3343.77,-19300.75 3374.93,-19290.03"/>
<polygon fill="black" stroke="black" points="3376.15,-19293.31 3384.47,-19286.75 3373.87,-19286.69 3376.15,-19293.31"/>
</g>
<!-- kv_send0_7_7 -->
<g id="node266" class="node">
<title>kv_send0_7_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2977" cy="-19170.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2977" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2977" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_7_7&#45;&gt;kv_send0_7_7 -->
<g id="edge361" class="edge">
<title>ring_stage0_7_7&#45;&gt;kv_send0_7_7</title>
<path fill="none" stroke="black" d="M2977,-19233.25C2977,-19225.2 2977,-19216.17 2977,-19207.55"/>
<polygon fill="black" stroke="black" points="2980.5,-19207.33 2977,-19197.33 2973.5,-19207.33 2980.5,-19207.33"/>
</g>
<!-- ring_stage0_8_7 -->
<g id="node282" class="node">
<title>ring_stage0_8_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3309.5,-19196.86 3098.5,-19196.86 3098.5,-19143.86 3309.5,-19143.86 3309.5,-19196.86"/>
<text text-anchor="middle" x="3204" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="3204" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_15×V_15</text>
<text text-anchor="middle" x="3204" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_7_7&#45;&gt;ring_stage0_8_7 -->
<g id="edge407" class="edge">
<title>ring_stage0_7_7&#45;&gt;ring_stage0_8_7</title>
<path fill="none" stroke="black" d="M3043.27,-19233.49C3069.84,-19223.22 3100.62,-19211.32 3128.08,-19200.7"/>
<polygon fill="black" stroke="black" points="3129.58,-19203.88 3137.65,-19197.01 3127.06,-19197.35 3129.58,-19203.88"/>
</g>
<!-- kv_send0_7_8 -->
<g id="node267" class="node">
<title>kv_send0_7_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2765" cy="-19080.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2765" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="2765" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_7_8&#45;&gt;kv_send0_7_8 -->
<g id="edge364" class="edge">
<title>ring_stage0_7_8&#45;&gt;kv_send0_7_8</title>
<path fill="none" stroke="black" d="M2745.95,-19143.51C2748.49,-19135.28 2751.33,-19126.03 2754.04,-19117.24"/>
<polygon fill="black" stroke="black" points="2757.41,-19118.18 2757.01,-19107.59 2750.72,-19116.12 2757.41,-19118.18"/>
</g>
<!-- ring_stage0_8_8 -->
<g id="node283" class="node">
<title>ring_stage0_8_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3079.5,-19107.12 2886.5,-19107.12 2886.5,-19054.12 3079.5,-19054.12 3079.5,-19107.12"/>
<text text-anchor="middle" x="2983" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2983" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_0×V_0</text>
<text text-anchor="middle" x="2983" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_7_8&#45;&gt;ring_stage0_8_8 -->
<g id="edge410" class="edge">
<title>ring_stage0_7_8&#45;&gt;ring_stage0_8_8</title>
<path fill="none" stroke="black" d="M2809.52,-19143.75C2838.45,-19133.39 2872,-19121.37 2901.84,-19110.69"/>
<polygon fill="black" stroke="black" points="2903.15,-19113.93 2911.39,-19107.27 2900.79,-19107.34 2903.15,-19113.93"/>
</g>
<!-- kv_send0_7_9 -->
<g id="node268" class="node">
<title>kv_send0_7_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2514" cy="-18990.88" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2514" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2514" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_7_9&#45;&gt;kv_send0_7_9 -->
<g id="edge367" class="edge">
<title>ring_stage0_7_9&#45;&gt;kv_send0_7_9</title>
<path fill="none" stroke="black" d="M2517.53,-19053.77C2517.07,-19045.72 2516.55,-19036.69 2516.06,-19028.07"/>
<polygon fill="black" stroke="black" points="2519.54,-19027.64 2515.48,-19017.85 2512.55,-19028.03 2519.54,-19027.64"/>
</g>
<!-- ring_stage0_8_9 -->
<g id="node284" class="node">
<title>ring_stage0_8_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2855.5,-19017.38 2662.5,-19017.38 2662.5,-18964.38 2855.5,-18964.38 2855.5,-19017.38"/>
<text text-anchor="middle" x="2759" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2759" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_1×V_1</text>
<text text-anchor="middle" x="2759" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_7_9&#45;&gt;ring_stage0_8_9 -->
<g id="edge413" class="edge">
<title>ring_stage0_7_9&#45;&gt;ring_stage0_8_9</title>
<path fill="none" stroke="black" d="M2589.06,-19054.01C2617.28,-19043.69 2649.98,-19031.74 2679.12,-19021.09"/>
<polygon fill="black" stroke="black" points="2680.66,-19024.25 2688.85,-19017.53 2678.26,-19017.67 2680.66,-19024.25"/>
</g>
<!-- kv_send0_7_10 -->
<g id="node269" class="node">
<title>kv_send0_7_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2275" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2275" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2275" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_7_10&#45;&gt;kv_send0_7_10 -->
<g id="edge370" class="edge">
<title>ring_stage0_7_10&#45;&gt;kv_send0_7_10</title>
<path fill="none" stroke="black" d="M2282.05,-18964.03C2281.13,-18955.89 2280.08,-18946.75 2279.09,-18938.05"/>
<polygon fill="black" stroke="black" points="2282.57,-18937.65 2277.96,-18928.11 2275.61,-18938.44 2282.57,-18937.65"/>
</g>
<!-- ring_stage0_8_10 -->
<g id="node285" class="node">
<title>ring_stage0_8_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2605,-18927.64 2403,-18927.64 2403,-18874.64 2605,-18874.64 2605,-18927.64"/>
<text text-anchor="middle" x="2504" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2504" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_2×V_2</text>
<text text-anchor="middle" x="2504" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_7_10&#45;&gt;ring_stage0_8_10 -->
<g id="edge416" class="edge">
<title>ring_stage0_7_10&#45;&gt;ring_stage0_8_10</title>
<path fill="none" stroke="black" d="M2348.93,-18964.27C2374.46,-18954.04 2404,-18942.2 2430.41,-18931.62"/>
<polygon fill="black" stroke="black" points="2432.01,-18934.76 2439.99,-18927.79 2429.4,-18928.26 2432.01,-18934.76"/>
</g>
<!-- kv_send0_7_11 -->
<g id="node270" class="node">
<title>kv_send0_7_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2035" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2035" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="2035" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_7_11&#45;&gt;kv_send0_7_11 -->
<g id="edge373" class="edge">
<title>ring_stage0_7_11&#45;&gt;kv_send0_7_11</title>
<path fill="none" stroke="black" d="M2042.76,-18874.29C2041.74,-18866.15 2040.59,-18857.01 2039.5,-18848.31"/>
<polygon fill="black" stroke="black" points="2042.97,-18847.86 2038.26,-18838.37 2036.03,-18848.73 2042.97,-18847.86"/>
</g>
<!-- ring_stage0_8_11 -->
<g id="node286" class="node">
<title>ring_stage0_8_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2365,-18837.9 2163,-18837.9 2163,-18784.9 2365,-18784.9 2365,-18837.9"/>
<text text-anchor="middle" x="2264" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2264" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_3×V_3</text>
<text text-anchor="middle" x="2264" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_7_11&#45;&gt;ring_stage0_8_11 -->
<g id="edge419" class="edge">
<title>ring_stage0_7_11&#45;&gt;ring_stage0_8_11</title>
<path fill="none" stroke="black" d="M2109.64,-18874.53C2135.05,-18864.3 2164.46,-18852.46 2190.75,-18841.88"/>
<polygon fill="black" stroke="black" points="2192.31,-18845.03 2200.28,-18838.05 2189.7,-18838.53 2192.31,-18845.03"/>
</g>
<!-- kv_send0_7_12 -->
<g id="node271" class="node">
<title>kv_send0_7_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1803" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1803" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="1803" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_7_12&#45;&gt;kv_send0_7_12 -->
<g id="edge376" class="edge">
<title>ring_stage0_7_12&#45;&gt;kv_send0_7_12</title>
<path fill="none" stroke="black" d="M1805.12,-18784.55C1804.84,-18776.5 1804.53,-18767.47 1804.24,-18758.85"/>
<polygon fill="black" stroke="black" points="1807.73,-18758.5 1803.89,-18748.63 1800.73,-18758.74 1807.73,-18758.5"/>
</g>
<!-- ring_stage0_8_12 -->
<g id="node287" class="node">
<title>ring_stage0_8_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2134,-18748.16 1932,-18748.16 1932,-18695.16 2134,-18695.16 2134,-18748.16"/>
<text text-anchor="middle" x="2033" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="2033" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_4×V_4</text>
<text text-anchor="middle" x="2033" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_7_12&#45;&gt;ring_stage0_8_12 -->
<g id="edge422" class="edge">
<title>ring_stage0_7_12&#45;&gt;ring_stage0_8_12</title>
<path fill="none" stroke="black" d="M1872.27,-18784.79C1898.84,-18774.52 1929.62,-18762.62 1957.08,-18752"/>
<polygon fill="black" stroke="black" points="1958.58,-18755.18 1966.65,-18748.31 1956.06,-18748.65 1958.58,-18755.18"/>
</g>
<!-- kv_send0_7_13 -->
<g id="node272" class="node">
<title>kv_send0_7_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1542" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1542" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="1542" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_7_13&#45;&gt;kv_send0_7_13 -->
<g id="edge379" class="edge">
<title>ring_stage0_7_13&#45;&gt;kv_send0_7_13</title>
<path fill="none" stroke="black" d="M1549.76,-18694.81C1548.74,-18686.67 1547.59,-18677.53 1546.5,-18668.83"/>
<polygon fill="black" stroke="black" points="1549.97,-18668.38 1545.26,-18658.89 1543.03,-18669.25 1549.97,-18668.38"/>
</g>
<!-- ring_stage0_8_13 -->
<g id="node288" class="node">
<title>ring_stage0_8_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1895,-18658.42 1693,-18658.42 1693,-18605.42 1895,-18605.42 1895,-18658.42"/>
<text text-anchor="middle" x="1794" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="1794" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_5×V_5</text>
<text text-anchor="middle" x="1794" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_7_13&#45;&gt;ring_stage0_8_13 -->
<g id="edge425" class="edge">
<title>ring_stage0_7_13&#45;&gt;ring_stage0_8_13</title>
<path fill="none" stroke="black" d="M1623.36,-18695.05C1651.69,-18684.73 1684.53,-18672.78 1713.78,-18662.12"/>
<polygon fill="black" stroke="black" points="1715.36,-18665.28 1723.56,-18658.57 1712.96,-18658.7 1715.36,-18665.28"/>
</g>
<!-- kv_send0_7_14 -->
<g id="node273" class="node">
<title>kv_send0_7_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1299" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1299" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="1299" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_7_14&#45;&gt;kv_send0_7_14 -->
<g id="edge382" class="edge">
<title>ring_stage0_7_14&#45;&gt;kv_send0_7_14</title>
<path fill="none" stroke="black" d="M1307.46,-18605.07C1306.35,-18596.93 1305.1,-18587.79 1303.91,-18579.09"/>
<polygon fill="black" stroke="black" points="1307.37,-18578.58 1302.55,-18569.15 1300.44,-18579.53 1307.37,-18578.58"/>
</g>
<!-- ring_stage0_8_14 -->
<g id="node289" class="node">
<title>ring_stage0_8_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1629,-18568.68 1427,-18568.68 1427,-18515.68 1629,-18515.68 1629,-18568.68"/>
<text text-anchor="middle" x="1528" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="1528" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_6×V_6</text>
<text text-anchor="middle" x="1528" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_7_14&#45;&gt;ring_stage0_8_14 -->
<g id="edge428" class="edge">
<title>ring_stage0_7_14&#45;&gt;ring_stage0_8_14</title>
<path fill="none" stroke="black" d="M1374.35,-18605.31C1399.64,-18595.08 1428.92,-18583.24 1455.08,-18572.66"/>
<polygon fill="black" stroke="black" points="1456.61,-18575.82 1464.57,-18568.83 1453.99,-18569.33 1456.61,-18575.82"/>
</g>
<!-- kv_send0_7_15 -->
<g id="node274" class="node">
<title>kv_send0_7_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1068" cy="-18452.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1068" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1068" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_7_15&#45;&gt;kv_send0_7_15 -->
<g id="edge385" class="edge">
<title>ring_stage0_7_15&#45;&gt;kv_send0_7_15</title>
<path fill="none" stroke="black" d="M1069.41,-18515.33C1069.23,-18507.28 1069.02,-18498.25 1068.82,-18489.63"/>
<polygon fill="black" stroke="black" points="1072.32,-18489.33 1068.59,-18479.41 1065.32,-18489.49 1072.32,-18489.33"/>
</g>
<!-- ring_stage0_8_15 -->
<g id="node290" class="node">
<title>ring_stage0_8_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1391,-18478.94 1189,-18478.94 1189,-18425.94 1391,-18425.94 1391,-18478.94"/>
<text text-anchor="middle" x="1290" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="1290" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_7×V_7</text>
<text text-anchor="middle" x="1290" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_7_15&#45;&gt;ring_stage0_8_15 -->
<g id="edge431" class="edge">
<title>ring_stage0_7_15&#45;&gt;ring_stage0_8_15</title>
<path fill="none" stroke="black" d="M1134.22,-18515.57C1159.87,-18505.34 1189.55,-18493.5 1216.08,-18482.92"/>
<polygon fill="black" stroke="black" points="1217.7,-18486.04 1225.7,-18479.09 1215.11,-18479.54 1217.7,-18486.04"/>
</g>
<!-- kv_send0_7_0&#45;&gt;ring_stage0_8_1 -->
<g id="edge390" class="edge">
<title>kv_send0_7_0&#45;&gt;ring_stage0_8_1</title>
<path fill="none" stroke="black" d="M554.05,-18343.87C541.39,-18341.03 528.34,-18338.24 516,-18335.83 416.61,-18316.42 390.29,-18319.75 291,-18299.83 290.89,-18299.81 290.79,-18299.79 290.68,-18299.77"/>
<polygon fill="black" stroke="black" points="291.24,-18296.31 280.74,-18297.71 289.83,-18303.16 291.24,-18296.31"/>
</g>
<!-- kv_send0_7_1&#45;&gt;ring_stage0_8_2 -->
<g id="edge393" class="edge">
<title>kv_send0_7_1&#45;&gt;ring_stage0_8_2</title>
<path fill="none" stroke="black" d="M475.3,-18253.65C488.45,-18250.78 502.08,-18248.11 515,-18246.09 703.4,-18216.69 756.46,-18238.84 948.08,-18210.29"/>
<polygon fill="black" stroke="black" points="948.85,-18213.72 958.21,-18208.76 947.8,-18206.8 948.85,-18213.72"/>
</g>
<!-- kv_send0_7_2&#45;&gt;ring_stage0_8_3 -->
<g id="edge396" class="edge">
<title>kv_send0_7_2&#45;&gt;ring_stage0_8_3</title>
<path fill="none" stroke="black" d="M1554.35,-18158.25C1570.87,-18148.18 1590.3,-18136.34 1607.91,-18125.61"/>
<polygon fill="black" stroke="black" points="1610.21,-18128.31 1616.93,-18120.12 1606.56,-18122.33 1610.21,-18128.31"/>
</g>
<!-- kv_send0_7_3&#45;&gt;ring_stage0_8_4 -->
<g id="edge399" class="edge">
<title>kv_send0_7_3&#45;&gt;ring_stage0_8_4</title>
<path fill="none" stroke="black" d="M2106,-18066.36C2106,-18050.91 2106,-18031.14 2106,-18014.28"/>
<polygon fill="black" stroke="black" points="2109.5,-18014.22 2106,-18004.22 2102.5,-18014.22 2109.5,-18014.22"/>
</g>
<!-- kv_send0_7_4&#45;&gt;ring_stage0_8_5 -->
<g id="edge402" class="edge">
<title>kv_send0_7_4&#45;&gt;ring_stage0_8_5</title>
<path fill="none" stroke="black" d="M3729.4,-19412.26C3728.3,-19404.22 3727.07,-19395.24 3725.9,-19386.68"/>
<polygon fill="black" stroke="black" points="3729.34,-19385.98 3724.52,-19376.54 3722.4,-19386.93 3729.34,-19385.98"/>
</g>
<!-- kv_send0_7_5&#45;&gt;ring_stage0_8_6 -->
<g id="edge405" class="edge">
<title>kv_send0_7_5&#45;&gt;ring_stage0_8_6</title>
<path fill="none" stroke="black" d="M3480.16,-19322.99C3477.32,-19314.69 3474.13,-19305.35 3471.1,-19296.49"/>
<polygon fill="black" stroke="black" points="3474.32,-19295.1 3467.78,-19286.77 3467.7,-19297.36 3474.32,-19295.1"/>
</g>
<!-- kv_send0_7_6&#45;&gt;ring_stage0_8_7 -->
<g id="edge408" class="edge">
<title>kv_send0_7_6&#45;&gt;ring_stage0_8_7</title>
<path fill="none" stroke="black" d="M3204,-19232.78C3204,-19224.74 3204,-19215.76 3204,-19207.2"/>
<polygon fill="black" stroke="black" points="3207.5,-19207.06 3204,-19197.06 3200.5,-19207.06 3207.5,-19207.06"/>
</g>
<!-- kv_send0_7_7&#45;&gt;ring_stage0_8_8 -->
<g id="edge411" class="edge">
<title>kv_send0_7_7&#45;&gt;ring_stage0_8_8</title>
<path fill="none" stroke="black" d="M2978.8,-19143.04C2979.35,-19135 2979.96,-19126.02 2980.55,-19117.46"/>
<polygon fill="black" stroke="black" points="2984.05,-19117.54 2981.24,-19107.32 2977.07,-19117.06 2984.05,-19117.54"/>
</g>
<!-- kv_send0_7_8&#45;&gt;ring_stage0_8_9 -->
<g id="edge414" class="edge">
<title>kv_send0_7_8&#45;&gt;ring_stage0_8_9</title>
<path fill="none" stroke="black" d="M2763.2,-19053.3C2762.65,-19045.26 2762.04,-19036.28 2761.45,-19027.72"/>
<polygon fill="black" stroke="black" points="2764.93,-19027.32 2760.76,-19017.58 2757.95,-19027.8 2764.93,-19027.32"/>
</g>
<!-- kv_send0_7_9&#45;&gt;ring_stage0_8_10 -->
<g id="edge417" class="edge">
<title>kv_send0_7_9&#45;&gt;ring_stage0_8_10</title>
<path fill="none" stroke="black" d="M2511,-18963.56C2510.08,-18955.52 2509.06,-18946.54 2508.08,-18937.98"/>
<polygon fill="black" stroke="black" points="2511.54,-18937.38 2506.93,-18927.84 2504.58,-18938.18 2511.54,-18937.38"/>
</g>
<!-- kv_send0_7_10&#45;&gt;ring_stage0_8_11 -->
<g id="edge420" class="edge">
<title>kv_send0_7_10&#45;&gt;ring_stage0_8_11</title>
<path fill="none" stroke="black" d="M2271.7,-18873.82C2270.69,-18865.78 2269.57,-18856.8 2268.49,-18848.24"/>
<polygon fill="black" stroke="black" points="2271.94,-18847.59 2267.22,-18838.1 2264.99,-18848.46 2271.94,-18847.59"/>
</g>
<!-- kv_send0_7_11&#45;&gt;ring_stage0_8_12 -->
<g id="edge423" class="edge">
<title>kv_send0_7_11&#45;&gt;ring_stage0_8_12</title>
<path fill="none" stroke="black" d="M2034.4,-18784.08C2034.22,-18776.04 2034.01,-18767.06 2033.82,-18758.5"/>
<polygon fill="black" stroke="black" points="2037.31,-18758.28 2033.59,-18748.36 2030.31,-18758.44 2037.31,-18758.28"/>
</g>
<!-- kv_send0_7_12&#45;&gt;ring_stage0_8_13 -->
<g id="edge426" class="edge">
<title>kv_send0_7_12&#45;&gt;ring_stage0_8_13</title>
<path fill="none" stroke="black" d="M1800.3,-18694.34C1799.48,-18686.3 1798.55,-18677.32 1797.68,-18668.76"/>
<polygon fill="black" stroke="black" points="1801.14,-18668.21 1796.64,-18658.62 1794.18,-18668.93 1801.14,-18668.21"/>
</g>
<!-- kv_send0_7_13&#45;&gt;ring_stage0_8_14 -->
<g id="edge429" class="edge">
<title>kv_send0_7_13&#45;&gt;ring_stage0_8_14</title>
<path fill="none" stroke="black" d="M1537.8,-18604.6C1536.52,-18596.56 1535.08,-18587.58 1533.72,-18579.02"/>
<polygon fill="black" stroke="black" points="1537.13,-18578.21 1532.1,-18568.88 1530.22,-18579.31 1537.13,-18578.21"/>
</g>
<!-- kv_send0_7_14&#45;&gt;ring_stage0_8_15 -->
<g id="edge432" class="edge">
<title>kv_send0_7_14&#45;&gt;ring_stage0_8_15</title>
<path fill="none" stroke="black" d="M1296.3,-18514.86C1295.48,-18506.82 1294.55,-18497.84 1293.68,-18489.28"/>
<polygon fill="black" stroke="black" points="1297.14,-18488.73 1292.64,-18479.14 1290.18,-18489.45 1297.14,-18488.73"/>
</g>
<!-- kv_send0_7_15&#45;&gt;ring_stage0_8_0 -->
<g id="edge387" class="edge">
<title>kv_send0_7_15&#45;&gt;ring_stage0_8_0</title>
<path fill="none" stroke="black" d="M1012.84,-18429.64C984.91,-18418.6 950.61,-18405.05 920.39,-18393.1"/>
<polygon fill="black" stroke="black" points="921.32,-18389.71 910.73,-18389.28 918.75,-18396.22 921.32,-18389.71"/>
</g>
<!-- kv_send0_8_0 -->
<g id="node291" class="node">
<title>kv_send0_8_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="627" cy="-18272.96" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="627" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="627" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_8_0&#45;&gt;kv_send0_8_0 -->
<g id="edge388" class="edge">
<title>ring_stage0_8_0&#45;&gt;kv_send0_8_0</title>
<path fill="none" stroke="black" d="M782.07,-18336.09C753.48,-18324.63 719.86,-18311.16 691.24,-18299.7"/>
<polygon fill="black" stroke="black" points="692.32,-18296.36 681.74,-18295.89 689.72,-18302.86 692.32,-18296.36"/>
</g>
<!-- ring_stage0_9_0 -->
<g id="node307" class="node">
<title>ring_stage0_9_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="941.5,-18299.46 748.5,-18299.46 748.5,-18246.46 941.5,-18246.46 941.5,-18299.46"/>
<text text-anchor="middle" x="845" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="845" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_7×V_7</text>
<text text-anchor="middle" x="845" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_8_0&#45;&gt;ring_stage0_9_0 -->
<g id="edge434" class="edge">
<title>ring_stage0_8_0&#45;&gt;ring_stage0_9_0</title>
<path fill="none" stroke="black" d="M845.71,-18335.85C845.61,-18327.64 845.51,-18318.41 845.41,-18309.63"/>
<polygon fill="black" stroke="black" points="848.91,-18309.59 845.29,-18299.63 841.91,-18309.67 848.91,-18309.59"/>
</g>
<!-- kv_send0_8_1 -->
<g id="node292" class="node">
<title>kv_send0_8_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="626" cy="-18183.22" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="626" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="626" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_8_1&#45;&gt;kv_send0_8_1 -->
<g id="edge391" class="edge">
<title>ring_stage0_8_1&#45;&gt;kv_send0_8_1</title>
<path fill="none" stroke="black" d="M280.74,-18248.22C284.2,-18247.48 287.63,-18246.77 291,-18246.09 389.42,-18226.28 415.48,-18229.4 514,-18210.09 523.16,-18208.3 532.71,-18206.29 542.2,-18204.22"/>
<polygon fill="black" stroke="black" points="543.04,-18207.62 552.05,-18202.04 541.53,-18200.78 543.04,-18207.62"/>
</g>
<!-- ring_stage0_9_1 -->
<g id="node308" class="node">
<title>ring_stage0_9_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="280.5,-18209.72 87.5,-18209.72 87.5,-18156.72 280.5,-18156.72 280.5,-18209.72"/>
<text text-anchor="middle" x="184" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="184" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_8×V_8</text>
<text text-anchor="middle" x="184" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_8_1&#45;&gt;ring_stage0_9_1 -->
<g id="edge437" class="edge">
<title>ring_stage0_8_1&#45;&gt;ring_stage0_9_1</title>
<path fill="none" stroke="black" d="M184,-18246.11C184,-18237.9 184,-18228.67 184,-18219.89"/>
<polygon fill="black" stroke="black" points="187.5,-18219.89 184,-18209.89 180.5,-18219.89 187.5,-18219.89"/>
</g>
<!-- kv_send0_8_2 -->
<g id="node293" class="node">
<title>kv_send0_8_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1432" cy="-18093.48" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1432" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="1432" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_8_2&#45;&gt;kv_send0_8_2 -->
<g id="edge394" class="edge">
<title>ring_stage0_8_2&#45;&gt;kv_send0_8_2</title>
<path fill="none" stroke="black" d="M1169.95,-18156.96C1226.4,-18143.5 1294.88,-18127.17 1347.68,-18114.58"/>
<polygon fill="black" stroke="black" points="1348.77,-18117.92 1357.69,-18112.2 1347.15,-18111.11 1348.77,-18117.92"/>
</g>
<!-- ring_stage0_9_2 -->
<g id="node309" class="node">
<title>ring_stage0_9_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="875.5,-18119.98 682.5,-18119.98 682.5,-18066.98 875.5,-18066.98 875.5,-18119.98"/>
<text text-anchor="middle" x="779" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="779" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_9×V_9</text>
<text text-anchor="middle" x="779" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_8_2&#45;&gt;ring_stage0_9_2 -->
<g id="edge440" class="edge">
<title>ring_stage0_8_2&#45;&gt;ring_stage0_9_2</title>
<path fill="none" stroke="black" d="M980.8,-18156.61C946.71,-18146.11 907.11,-18133.92 872.06,-18123.13"/>
<polygon fill="black" stroke="black" points="872.89,-18119.72 862.3,-18120.13 870.83,-18126.41 872.89,-18119.72"/>
</g>
<!-- kv_send0_8_3 -->
<g id="node294" class="node">
<title>kv_send0_8_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1655" cy="-17977.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1655" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1655" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_8_3&#45;&gt;kv_send0_8_3 -->
<g id="edge397" class="edge">
<title>ring_stage0_8_3&#45;&gt;kv_send0_8_3</title>
<path fill="none" stroke="black" d="M1658.1,-18066.93C1657.56,-18051.61 1656.87,-18031.9 1656.28,-18014.98"/>
<polygon fill="black" stroke="black" points="1659.77,-18014.74 1655.92,-18004.87 1652.78,-18014.99 1659.77,-18014.74"/>
</g>
<!-- ring_stage0_9_3 -->
<g id="node310" class="node">
<title>ring_stage0_9_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1533.5,-18004.11 1322.5,-18004.11 1322.5,-17951.11 1533.5,-17951.11 1533.5,-18004.11"/>
<text text-anchor="middle" x="1428" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="1428" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_10×V_10</text>
<text text-anchor="middle" x="1428" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_8_3&#45;&gt;ring_stage0_9_3 -->
<g id="edge443" class="edge">
<title>ring_stage0_8_3&#45;&gt;ring_stage0_9_3</title>
<path fill="none" stroke="black" d="M1607.16,-18066.93C1572.21,-18049.7 1525.95,-18026.9 1489.19,-18008.78"/>
<polygon fill="black" stroke="black" points="1490.58,-18005.56 1480.07,-18004.28 1487.49,-18011.84 1490.58,-18005.56"/>
</g>
<!-- kv_send0_8_4 -->
<g id="node295" class="node">
<title>kv_send0_8_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2091" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2091" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="2091" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_8_4&#45;&gt;kv_send0_8_4 -->
<g id="edge400" class="edge">
<title>ring_stage0_8_4&#45;&gt;kv_send0_8_4</title>
<path fill="none" stroke="black" d="M2103.25,-17950.93C2100.9,-17928.97 2097.48,-17897.11 2094.86,-17872.6"/>
<polygon fill="black" stroke="black" points="2098.33,-17872.17 2093.78,-17862.6 2091.37,-17872.92 2098.33,-17872.17"/>
</g>
<!-- ring_stage0_9_4 -->
<g id="node311" class="node">
<title>ring_stage0_9_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1969.5,-17862.11 1758.5,-17862.11 1758.5,-17809.11 1969.5,-17809.11 1969.5,-17862.11"/>
<text text-anchor="middle" x="1864" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="1864" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_11×V_11</text>
<text text-anchor="middle" x="1864" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_8_4&#45;&gt;ring_stage0_9_4 -->
<g id="edge446" class="edge">
<title>ring_stage0_8_4&#45;&gt;ring_stage0_9_4</title>
<path fill="none" stroke="black" d="M2061.89,-17951.1C2021.08,-17927.48 1960.34,-17892.34 1916.92,-17867.23"/>
<polygon fill="black" stroke="black" points="1918.62,-17864.16 1908.21,-17862.19 1915.11,-17870.22 1918.62,-17864.16"/>
</g>
<!-- kv_send0_8_5 -->
<g id="node296" class="node">
<title>kv_send0_8_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3702" cy="-19260.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3702" y="-19263.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="3702" y="-19248.9" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_8_5&#45;&gt;kv_send0_8_5 -->
<g id="edge403" class="edge">
<title>ring_stage0_8_5&#45;&gt;kv_send0_8_5</title>
<path fill="none" stroke="black" d="M3715.4,-19322.99C3713.64,-19314.85 3711.66,-19305.71 3709.78,-19297.01"/>
<polygon fill="black" stroke="black" points="3713.16,-19296.1 3707.62,-19287.07 3706.32,-19297.58 3713.16,-19296.1"/>
</g>
<!-- ring_stage0_9_5 -->
<g id="node312" class="node">
<title>ring_stage0_9_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2689.5,-17720.11 2478.5,-17720.11 2478.5,-17667.11 2689.5,-17667.11 2689.5,-17720.11"/>
<text text-anchor="middle" x="2584" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2584" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_12×V_12</text>
<text text-anchor="middle" x="2584" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_8_5&#45;&gt;ring_stage0_9_5 -->
<g id="edge449" class="edge">
<title>ring_stage0_8_5&#45;&gt;ring_stage0_9_5</title>
<path fill="none" stroke="black" d="M3774.94,-19323.19C3789.67,-19313.74 3804.24,-19301.68 3814,-19286.97 3842.92,-19243.39 3836,-19223.67 3836,-19171.36 3836,-19171.36 3836,-19171.36 3836,-18451.44 3836,-18275.27 3873.21,-18183.04 3741,-18066.61 3688.79,-18020.63 3476.28,-18082.56 3430,-18030.61 3398.66,-17995.43 3401.16,-17961.87 3430,-17924.61 3469.06,-17874.14 3529.94,-17939.08 3569,-17888.61 3597.84,-17851.36 3601.62,-17816.6 3569,-17782.61 3535.51,-17747.7 2746.07,-17757.78 2699,-17746.61 2678.66,-17741.78 2657.52,-17733.34 2638.99,-17724.63"/>
<polygon fill="black" stroke="black" points="2640.36,-17721.41 2629.84,-17720.22 2637.32,-17727.72 2640.36,-17721.41"/>
</g>
<!-- kv_send0_8_6 -->
<g id="node297" class="node">
<title>kv_send0_8_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3458" cy="-19170.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3458" y="-19174.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3458" y="-19159.16" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_8_6&#45;&gt;kv_send0_8_6 -->
<g id="edge406" class="edge">
<title>ring_stage0_8_6&#45;&gt;kv_send0_8_6</title>
<path fill="none" stroke="black" d="M3458.71,-19233.25C3458.61,-19225.2 3458.51,-19216.17 3458.41,-19207.55"/>
<polygon fill="black" stroke="black" points="3461.91,-19207.29 3458.3,-19197.33 3454.91,-19207.37 3461.91,-19207.29"/>
</g>
<!-- ring_stage0_9_6 -->
<g id="node313" class="node">
<title>ring_stage0_9_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3796.5,-19196.86 3585.5,-19196.86 3585.5,-19143.86 3796.5,-19143.86 3796.5,-19196.86"/>
<text text-anchor="middle" x="3691" y="-19181.66" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="3691" y="-19166.66" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_13×V_13</text>
<text text-anchor="middle" x="3691" y="-19151.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_8_6&#45;&gt;ring_stage0_9_6 -->
<g id="edge452" class="edge">
<title>ring_stage0_8_6&#45;&gt;ring_stage0_9_6</title>
<path fill="none" stroke="black" d="M3526.73,-19233.49C3554,-19223.17 3585.62,-19211.22 3613.78,-19200.57"/>
<polygon fill="black" stroke="black" points="3615.07,-19203.82 3623.19,-19197.01 3612.6,-19197.27 3615.07,-19203.82"/>
</g>
<!-- kv_send0_8_7 -->
<g id="node298" class="node">
<title>kv_send0_8_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3204" cy="-19080.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3204" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3204" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_8_7&#45;&gt;kv_send0_8_7 -->
<g id="edge409" class="edge">
<title>ring_stage0_8_7&#45;&gt;kv_send0_8_7</title>
<path fill="none" stroke="black" d="M3204,-19143.51C3204,-19135.46 3204,-19126.43 3204,-19117.81"/>
<polygon fill="black" stroke="black" points="3207.5,-19117.59 3204,-19107.59 3200.5,-19117.59 3207.5,-19117.59"/>
</g>
<!-- ring_stage0_9_7 -->
<g id="node314" class="node">
<title>ring_stage0_9_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3561.5,-19107.12 3350.5,-19107.12 3350.5,-19054.12 3561.5,-19054.12 3561.5,-19107.12"/>
<text text-anchor="middle" x="3456" y="-19091.92" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="3456" y="-19076.92" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_14×V_14</text>
<text text-anchor="middle" x="3456" y="-19061.92" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_8_7&#45;&gt;ring_stage0_9_7 -->
<g id="edge455" class="edge">
<title>ring_stage0_8_7&#45;&gt;ring_stage0_9_7</title>
<path fill="none" stroke="black" d="M3277.57,-19143.75C3307.32,-19133.39 3341.83,-19121.37 3372.52,-19110.69"/>
<polygon fill="black" stroke="black" points="3374.05,-19113.86 3382.34,-19107.27 3371.75,-19107.25 3374.05,-19113.86"/>
</g>
<!-- kv_send0_8_8 -->
<g id="node299" class="node">
<title>kv_send0_8_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2977" cy="-18990.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2977" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="2977" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_8_8&#45;&gt;kv_send0_8_8 -->
<g id="edge412" class="edge">
<title>ring_stage0_8_8&#45;&gt;kv_send0_8_8</title>
<path fill="none" stroke="black" d="M2981.23,-19053.77C2980.68,-19045.72 2980.06,-19036.69 2979.47,-19028.07"/>
<polygon fill="black" stroke="black" points="2982.95,-19027.59 2978.78,-19017.85 2975.97,-19028.07 2982.95,-19027.59"/>
</g>
<!-- ring_stage0_9_8 -->
<g id="node315" class="node">
<title>ring_stage0_9_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3309.5,-19017.38 3098.5,-19017.38 3098.5,-18964.38 3309.5,-18964.38 3309.5,-19017.38"/>
<text text-anchor="middle" x="3204" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="3204" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_15×V_15</text>
<text text-anchor="middle" x="3204" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_8_8&#45;&gt;ring_stage0_9_8 -->
<g id="edge458" class="edge">
<title>ring_stage0_8_8&#45;&gt;ring_stage0_9_8</title>
<path fill="none" stroke="black" d="M3047.52,-19054.01C3073.39,-19043.74 3103.35,-19031.84 3130.09,-19021.22"/>
<polygon fill="black" stroke="black" points="3131.4,-19024.47 3139.4,-19017.53 3128.82,-19017.96 3131.4,-19024.47"/>
</g>
<!-- kv_send0_8_9 -->
<g id="node300" class="node">
<title>kv_send0_8_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2753" cy="-18901.14" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2753" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2753" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_8_9&#45;&gt;kv_send0_8_9 -->
<g id="edge415" class="edge">
<title>ring_stage0_8_9&#45;&gt;kv_send0_8_9</title>
<path fill="none" stroke="black" d="M2757.23,-18964.03C2756.68,-18955.98 2756.06,-18946.95 2755.47,-18938.33"/>
<polygon fill="black" stroke="black" points="2758.95,-18937.85 2754.78,-18928.11 2751.97,-18938.33 2758.95,-18937.85"/>
</g>
<!-- ring_stage0_9_9 -->
<g id="node316" class="node">
<title>ring_stage0_9_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3073.5,-18927.64 2880.5,-18927.64 2880.5,-18874.64 3073.5,-18874.64 3073.5,-18927.64"/>
<text text-anchor="middle" x="2977" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2977" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_0×V_0</text>
<text text-anchor="middle" x="2977" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_8_9&#45;&gt;ring_stage0_9_9 -->
<g id="edge461" class="edge">
<title>ring_stage0_8_9&#45;&gt;ring_stage0_9_9</title>
<path fill="none" stroke="black" d="M2822.64,-18964.27C2848.05,-18954.04 2877.46,-18942.2 2903.75,-18931.62"/>
<polygon fill="black" stroke="black" points="2905.31,-18934.77 2913.28,-18927.79 2902.7,-18928.27 2905.31,-18934.77"/>
</g>
<!-- kv_send0_8_10 -->
<g id="node301" class="node">
<title>kv_send0_8_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2493" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2493" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2493" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_8_10&#45;&gt;kv_send0_8_10 -->
<g id="edge418" class="edge">
<title>ring_stage0_8_10&#45;&gt;kv_send0_8_10</title>
<path fill="none" stroke="black" d="M2500.76,-18874.29C2499.74,-18866.15 2498.59,-18857.01 2497.5,-18848.31"/>
<polygon fill="black" stroke="black" points="2500.97,-18847.86 2496.26,-18838.37 2494.03,-18848.73 2500.97,-18847.86"/>
</g>
<!-- ring_stage0_9_10 -->
<g id="node317" class="node">
<title>ring_stage0_9_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2843,-18837.9 2641,-18837.9 2641,-18784.9 2843,-18784.9 2843,-18837.9"/>
<text text-anchor="middle" x="2742" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2742" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_1×V_1</text>
<text text-anchor="middle" x="2742" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_8_10&#45;&gt;ring_stage0_9_10 -->
<g id="edge464" class="edge">
<title>ring_stage0_8_10&#45;&gt;ring_stage0_9_10</title>
<path fill="none" stroke="black" d="M2573.48,-18874.53C2601.46,-18864.21 2633.89,-18852.26 2662.78,-18841.61"/>
<polygon fill="black" stroke="black" points="2664.26,-18844.79 2672.43,-18838.05 2661.84,-18838.22 2664.26,-18844.79"/>
</g>
<!-- kv_send0_8_11 -->
<g id="node302" class="node">
<title>kv_send0_8_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2263" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2263" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="2263" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_8_11&#45;&gt;kv_send0_8_11 -->
<g id="edge421" class="edge">
<title>ring_stage0_8_11&#45;&gt;kv_send0_8_11</title>
<path fill="none" stroke="black" d="M2263.71,-18784.55C2263.61,-18776.5 2263.51,-18767.47 2263.41,-18758.85"/>
<polygon fill="black" stroke="black" points="2266.91,-18758.59 2263.3,-18748.63 2259.91,-18758.67 2266.91,-18758.59"/>
</g>
<!-- ring_stage0_9_11 -->
<g id="node318" class="node">
<title>ring_stage0_9_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2594,-18748.16 2392,-18748.16 2392,-18695.16 2594,-18695.16 2594,-18748.16"/>
<text text-anchor="middle" x="2493" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2493" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_2×V_2</text>
<text text-anchor="middle" x="2493" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_8_11&#45;&gt;ring_stage0_9_11 -->
<g id="edge467" class="edge">
<title>ring_stage0_8_11&#45;&gt;ring_stage0_9_11</title>
<path fill="none" stroke="black" d="M2330.85,-18784.79C2357.66,-18774.52 2388.71,-18762.62 2416.42,-18752"/>
<polygon fill="black" stroke="black" points="2417.98,-18755.15 2426.07,-18748.31 2415.47,-18748.62 2417.98,-18755.15"/>
</g>
<!-- kv_send0_8_12 -->
<g id="node303" class="node">
<title>kv_send0_8_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2024" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2024" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="2024" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_8_12&#45;&gt;kv_send0_8_12 -->
<g id="edge424" class="edge">
<title>ring_stage0_8_12&#45;&gt;kv_send0_8_12</title>
<path fill="none" stroke="black" d="M2030.35,-18694.81C2029.52,-18686.76 2028.6,-18677.73 2027.71,-18669.11"/>
<polygon fill="black" stroke="black" points="2031.17,-18668.48 2026.66,-18658.89 2024.2,-18669.19 2031.17,-18668.48"/>
</g>
<!-- ring_stage0_9_12 -->
<g id="node319" class="node">
<title>ring_stage0_9_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2356,-18658.42 2154,-18658.42 2154,-18605.42 2356,-18605.42 2356,-18658.42"/>
<text text-anchor="middle" x="2255" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2255" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_3×V_3</text>
<text text-anchor="middle" x="2255" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_8_12&#45;&gt;ring_stage0_9_12 -->
<g id="edge470" class="edge">
<title>ring_stage0_8_12&#45;&gt;ring_stage0_9_12</title>
<path fill="none" stroke="black" d="M2097.81,-18695.05C2123.8,-18684.78 2153.9,-18672.88 2180.76,-18662.26"/>
<polygon fill="black" stroke="black" points="2182.1,-18665.5 2190.11,-18658.57 2179.52,-18658.99 2182.1,-18665.5"/>
</g>
<!-- kv_send0_8_13 -->
<g id="node304" class="node">
<title>kv_send0_8_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1777" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1777" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="1777" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_8_13&#45;&gt;kv_send0_8_13 -->
<g id="edge427" class="edge">
<title>ring_stage0_8_13&#45;&gt;kv_send0_8_13</title>
<path fill="none" stroke="black" d="M1788.99,-18605.07C1787.41,-18596.93 1785.64,-18587.79 1783.96,-18579.09"/>
<polygon fill="black" stroke="black" points="1787.37,-18578.3 1782.03,-18569.15 1780.5,-18579.63 1787.37,-18578.3"/>
</g>
<!-- ring_stage0_9_13 -->
<g id="node320" class="node">
<title>ring_stage0_9_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2107,-18568.68 1905,-18568.68 1905,-18515.68 2107,-18515.68 2107,-18568.68"/>
<text text-anchor="middle" x="2006" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="2006" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_4×V_4</text>
<text text-anchor="middle" x="2006" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_8_13&#45;&gt;ring_stage0_9_13 -->
<g id="edge473" class="edge">
<title>ring_stage0_8_13&#45;&gt;ring_stage0_9_13</title>
<path fill="none" stroke="black" d="M1855.89,-18605.31C1880.6,-18595.08 1909.2,-18583.24 1934.76,-18572.66"/>
<polygon fill="black" stroke="black" points="1936.13,-18575.88 1944.03,-18568.83 1933.46,-18569.42 1936.13,-18575.88"/>
</g>
<!-- kv_send0_8_14 -->
<g id="node305" class="node">
<title>kv_send0_8_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1519" cy="-18452.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1519" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="1519" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_8_14&#45;&gt;kv_send0_8_14 -->
<g id="edge430" class="edge">
<title>ring_stage0_8_14&#45;&gt;kv_send0_8_14</title>
<path fill="none" stroke="black" d="M1525.35,-18515.33C1524.52,-18507.28 1523.6,-18498.25 1522.71,-18489.63"/>
<polygon fill="black" stroke="black" points="1526.17,-18489 1521.66,-18479.41 1519.2,-18489.71 1526.17,-18489"/>
</g>
<!-- ring_stage0_9_14 -->
<g id="node321" class="node">
<title>ring_stage0_9_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1869,-18478.94 1667,-18478.94 1667,-18425.94 1869,-18425.94 1869,-18478.94"/>
<text text-anchor="middle" x="1768" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="1768" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_5×V_5</text>
<text text-anchor="middle" x="1768" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_8_14&#45;&gt;ring_stage0_9_14 -->
<g id="edge476" class="edge">
<title>ring_stage0_8_14&#45;&gt;ring_stage0_9_14</title>
<path fill="none" stroke="black" d="M1598.06,-18515.57C1626.28,-18505.25 1658.98,-18493.3 1688.12,-18482.64"/>
<polygon fill="black" stroke="black" points="1689.66,-18485.81 1697.85,-18479.09 1687.26,-18479.23 1689.66,-18485.81"/>
</g>
<!-- kv_send0_8_15 -->
<g id="node306" class="node">
<title>kv_send0_8_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1065" cy="-18362.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1065" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1065" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_8_15&#45;&gt;kv_send0_8_15 -->
<g id="edge433" class="edge">
<title>ring_stage0_8_15&#45;&gt;kv_send0_8_15</title>
<path fill="none" stroke="black" d="M1224.32,-18425.83C1194.7,-18414.28 1159.82,-18400.68 1130.26,-18389.15"/>
<polygon fill="black" stroke="black" points="1131.45,-18385.86 1120.87,-18385.49 1128.91,-18392.38 1131.45,-18385.86"/>
</g>
<!-- ring_stage0_9_15 -->
<g id="node322" class="node">
<title>ring_stage0_9_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1394,-18389.2 1192,-18389.2 1192,-18336.2 1394,-18336.2 1394,-18389.2"/>
<text text-anchor="middle" x="1293" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="1293" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_6×V_6</text>
<text text-anchor="middle" x="1293" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_8_15&#45;&gt;ring_stage0_9_15 -->
<g id="edge479" class="edge">
<title>ring_stage0_8_15&#45;&gt;ring_stage0_9_15</title>
<path fill="none" stroke="black" d="M1290.88,-18425.59C1291.16,-18417.38 1291.48,-18408.15 1291.78,-18399.37"/>
<polygon fill="black" stroke="black" points="1295.28,-18399.48 1292.12,-18389.37 1288.28,-18399.24 1295.28,-18399.48"/>
</g>
<!-- kv_send0_8_0&#45;&gt;ring_stage0_9_1 -->
<g id="edge438" class="edge">
<title>kv_send0_8_0&#45;&gt;ring_stage0_9_1</title>
<path fill="none" stroke="black" d="M553.05,-18254.13C540.39,-18251.29 527.34,-18248.5 515,-18246.09 418.71,-18227.29 390.99,-18229.92 290.63,-18210.14"/>
<polygon fill="black" stroke="black" points="291.18,-18206.69 280.69,-18208.16 289.81,-18213.55 291.18,-18206.69"/>
</g>
<!-- kv_send0_8_1&#45;&gt;ring_stage0_9_2 -->
<g id="edge441" class="edge">
<title>kv_send0_8_1&#45;&gt;ring_stage0_9_2</title>
<path fill="none" stroke="black" d="M667.4,-18158.48C685.28,-18148.22 706.42,-18136.1 725.47,-18125.18"/>
<polygon fill="black" stroke="black" points="727.41,-18128.1 734.34,-18120.09 723.93,-18122.03 727.41,-18128.1"/>
</g>
<!-- kv_send0_8_2&#45;&gt;ring_stage0_9_3 -->
<g id="edge444" class="edge">
<title>kv_send0_8_2&#45;&gt;ring_stage0_9_3</title>
<path fill="none" stroke="black" d="M1431.08,-18066.36C1430.54,-18050.91 1429.85,-18031.14 1429.25,-18014.28"/>
<polygon fill="black" stroke="black" points="1432.75,-18014.09 1428.9,-18004.22 1425.75,-18014.34 1432.75,-18014.09"/>
</g>
<!-- kv_send0_8_3&#45;&gt;ring_stage0_9_4 -->
<g id="edge447" class="edge">
<title>kv_send0_8_3&#45;&gt;ring_stage0_9_4</title>
<path fill="none" stroke="black" d="M1691.41,-17952.22C1726.42,-17928.77 1779.49,-17893.22 1817.53,-17867.74"/>
<polygon fill="black" stroke="black" points="1819.53,-17870.61 1825.89,-17862.14 1815.64,-17864.79 1819.53,-17870.61"/>
</g>
<!-- kv_send0_8_4&#45;&gt;ring_stage0_9_5 -->
<g id="edge450" class="edge">
<title>kv_send0_8_4&#45;&gt;ring_stage0_9_5</title>
<path fill="none" stroke="black" d="M2133.7,-17811.1C2154.12,-17800.83 2179.24,-17789.56 2203,-17782.61 2317.5,-17749.11 2354.33,-17779.53 2469,-17746.61 2488.28,-17741.08 2508.48,-17732.85 2526.47,-17724.56"/>
<polygon fill="black" stroke="black" points="2528.1,-17727.66 2535.66,-17720.24 2525.12,-17721.33 2528.1,-17727.66"/>
</g>
<!-- kv_send0_8_5&#45;&gt;ring_stage0_9_6 -->
<g id="edge453" class="edge">
<title>kv_send0_8_5&#45;&gt;ring_stage0_9_6</title>
<path fill="none" stroke="black" d="M3698.7,-19232.78C3697.69,-19224.74 3696.57,-19215.76 3695.49,-19207.2"/>
<polygon fill="black" stroke="black" points="3698.94,-19206.55 3694.22,-19197.06 3691.99,-19207.42 3698.94,-19206.55"/>
</g>
<!-- kv_send0_8_6&#45;&gt;ring_stage0_9_7 -->
<g id="edge456" class="edge">
<title>kv_send0_8_6&#45;&gt;ring_stage0_9_7</title>
<path fill="none" stroke="black" d="M3457.4,-19143.04C3457.22,-19135 3457.01,-19126.02 3456.82,-19117.46"/>
<polygon fill="black" stroke="black" points="3460.31,-19117.24 3456.59,-19107.32 3453.31,-19117.4 3460.31,-19117.24"/>
</g>
<!-- kv_send0_8_7&#45;&gt;ring_stage0_9_8 -->
<g id="edge459" class="edge">
<title>kv_send0_8_7&#45;&gt;ring_stage0_9_8</title>
<path fill="none" stroke="black" d="M3204,-19053.3C3204,-19045.26 3204,-19036.28 3204,-19027.72"/>
<polygon fill="black" stroke="black" points="3207.5,-19027.58 3204,-19017.58 3200.5,-19027.58 3207.5,-19027.58"/>
</g>
<!-- kv_send0_8_8&#45;&gt;ring_stage0_9_9 -->
<g id="edge462" class="edge">
<title>kv_send0_8_8&#45;&gt;ring_stage0_9_9</title>
<path fill="none" stroke="black" d="M2977,-18963.56C2977,-18955.52 2977,-18946.54 2977,-18937.98"/>
<polygon fill="black" stroke="black" points="2980.5,-18937.84 2977,-18927.84 2973.5,-18937.84 2980.5,-18937.84"/>
</g>
<!-- kv_send0_8_9&#45;&gt;ring_stage0_9_10 -->
<g id="edge465" class="edge">
<title>kv_send0_8_9&#45;&gt;ring_stage0_9_10</title>
<path fill="none" stroke="black" d="M2749.7,-18873.82C2748.69,-18865.78 2747.57,-18856.8 2746.49,-18848.24"/>
<polygon fill="black" stroke="black" points="2749.94,-18847.59 2745.22,-18838.1 2742.99,-18848.46 2749.94,-18847.59"/>
</g>
<!-- kv_send0_8_10&#45;&gt;ring_stage0_9_11 -->
<g id="edge468" class="edge">
<title>kv_send0_8_10&#45;&gt;ring_stage0_9_11</title>
<path fill="none" stroke="black" d="M2493,-18784.08C2493,-18776.04 2493,-18767.06 2493,-18758.5"/>
<polygon fill="black" stroke="black" points="2496.5,-18758.36 2493,-18748.36 2489.5,-18758.36 2496.5,-18758.36"/>
</g>
<!-- kv_send0_8_11&#45;&gt;ring_stage0_9_12 -->
<g id="edge471" class="edge">
<title>kv_send0_8_11&#45;&gt;ring_stage0_9_12</title>
<path fill="none" stroke="black" d="M2260.6,-18694.34C2259.87,-18686.3 2259.05,-18677.32 2258.27,-18668.76"/>
<polygon fill="black" stroke="black" points="2261.74,-18668.26 2257.34,-18658.62 2254.77,-18668.9 2261.74,-18668.26"/>
</g>
<!-- kv_send0_8_12&#45;&gt;ring_stage0_9_13 -->
<g id="edge474" class="edge">
<title>kv_send0_8_12&#45;&gt;ring_stage0_9_13</title>
<path fill="none" stroke="black" d="M2018.7,-18605.07C2017.01,-18596.86 2015.12,-18587.63 2013.32,-18578.85"/>
<polygon fill="black" stroke="black" points="2016.7,-18577.94 2011.27,-18568.85 2009.85,-18579.35 2016.7,-18577.94"/>
</g>
<!-- kv_send0_8_13&#45;&gt;ring_stage0_9_14 -->
<g id="edge477" class="edge">
<title>kv_send0_8_13&#45;&gt;ring_stage0_9_14</title>
<path fill="none" stroke="black" d="M1774.3,-18514.86C1773.48,-18506.82 1772.55,-18497.84 1771.68,-18489.28"/>
<polygon fill="black" stroke="black" points="1775.14,-18488.73 1770.64,-18479.14 1768.18,-18489.45 1775.14,-18488.73"/>
</g>
<!-- kv_send0_8_14&#45;&gt;ring_stage0_9_15 -->
<g id="edge480" class="edge">
<title>kv_send0_8_14&#45;&gt;ring_stage0_9_15</title>
<path fill="none" stroke="black" d="M1462.26,-18429.41C1433.82,-18418.37 1399,-18404.85 1368.35,-18392.95"/>
<polygon fill="black" stroke="black" points="1369.57,-18389.67 1358.99,-18389.32 1367.04,-18396.2 1369.57,-18389.67"/>
</g>
<!-- kv_send0_8_15&#45;&gt;ring_stage0_9_0 -->
<g id="edge435" class="edge">
<title>kv_send0_8_15&#45;&gt;ring_stage0_9_0</title>
<path fill="none" stroke="black" d="M1010.34,-18339.9C982.66,-18328.86 948.67,-18315.31 918.72,-18303.36"/>
<polygon fill="black" stroke="black" points="919.73,-18300 909.15,-18299.54 917.14,-18306.5 919.73,-18300"/>
</g>
<!-- kv_send0_9_0 -->
<g id="node323" class="node">
<title>kv_send0_9_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="402" cy="-18183.22" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="402" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="402" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_9_0&#45;&gt;kv_send0_9_0 -->
<g id="edge436" class="edge">
<title>ring_stage0_9_0&#45;&gt;kv_send0_9_0</title>
<path fill="none" stroke="black" d="M748.31,-18248.02C745.17,-18247.35 742.06,-18246.71 739,-18246.09 639.73,-18226.07 613.39,-18229.5 514,-18210.09 504.84,-18208.3 495.29,-18206.3 485.8,-18204.23"/>
<polygon fill="black" stroke="black" points="486.47,-18200.8 475.95,-18202.05 484.96,-18207.63 486.47,-18200.8"/>
</g>
<!-- ring_stage0_10_0 -->
<g id="node339" class="node">
<title>ring_stage0_10_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="940.5,-18209.72 747.5,-18209.72 747.5,-18156.72 940.5,-18156.72 940.5,-18209.72"/>
<text text-anchor="middle" x="844" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="844" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_6×V_6</text>
<text text-anchor="middle" x="844" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_9_0&#45;&gt;ring_stage0_10_0 -->
<g id="edge482" class="edge">
<title>ring_stage0_9_0&#45;&gt;ring_stage0_10_0</title>
<path fill="none" stroke="black" d="M844.71,-18246.11C844.61,-18237.9 844.51,-18228.67 844.41,-18219.89"/>
<polygon fill="black" stroke="black" points="847.91,-18219.85 844.29,-18209.89 840.91,-18219.93 847.91,-18219.85"/>
</g>
<!-- kv_send0_9_1 -->
<g id="node324" class="node">
<title>kv_send0_9_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="561" cy="-18093.48" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="561" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="561" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_9_1&#45;&gt;kv_send0_9_1 -->
<g id="edge439" class="edge">
<title>ring_stage0_9_1&#45;&gt;kv_send0_9_1</title>
<path fill="none" stroke="black" d="M280.75,-18158.54C283.87,-18157.8 286.96,-18157.07 290,-18156.35 360.53,-18139.76 378.37,-18136.5 449,-18120.35 457.71,-18118.36 466.81,-18116.27 475.88,-18114.18"/>
<polygon fill="black" stroke="black" points="476.74,-18117.58 485.7,-18111.92 475.17,-18110.75 476.74,-18117.58"/>
</g>
<!-- ring_stage0_10_1 -->
<g id="node340" class="node">
<title>ring_stage0_10_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="215.5,-18119.98 22.5,-18119.98 22.5,-18066.98 215.5,-18066.98 215.5,-18119.98"/>
<text text-anchor="middle" x="119" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="119" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_7×V_7</text>
<text text-anchor="middle" x="119" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_9_1&#45;&gt;ring_stage0_10_1 -->
<g id="edge485" class="edge">
<title>ring_stage0_9_1&#45;&gt;ring_stage0_10_1</title>
<path fill="none" stroke="black" d="M164.85,-18156.37C158.37,-18147.62 151.03,-18137.72 144.16,-18128.44"/>
<polygon fill="black" stroke="black" points="146.78,-18126.1 138.01,-18120.15 141.15,-18130.26 146.78,-18126.1"/>
</g>
<!-- kv_send0_9_2 -->
<g id="node325" class="node">
<title>kv_send0_9_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="766" cy="-17977.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="766" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="766" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_9_2&#45;&gt;kv_send0_9_2 -->
<g id="edge442" class="edge">
<title>ring_stage0_9_2&#45;&gt;kv_send0_9_2</title>
<path fill="none" stroke="black" d="M776.08,-18066.93C774.32,-18051.5 772.05,-18031.62 770.11,-18014.62"/>
<polygon fill="black" stroke="black" points="773.56,-18014.01 768.95,-18004.47 766.61,-18014.81 773.56,-18014.01"/>
</g>
<!-- ring_stage0_10_2 -->
<g id="node341" class="node">
<title>ring_stage0_10_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="644.5,-18004.11 451.5,-18004.11 451.5,-17951.11 644.5,-17951.11 644.5,-18004.11"/>
<text text-anchor="middle" x="548" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="548" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_8×V_8</text>
<text text-anchor="middle" x="548" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_9_2&#45;&gt;ring_stage0_10_2 -->
<g id="edge488" class="edge">
<title>ring_stage0_9_2&#45;&gt;ring_stage0_10_2</title>
<path fill="none" stroke="black" d="M727.16,-18066.93C692.21,-18049.7 645.95,-18026.9 609.19,-18008.78"/>
<polygon fill="black" stroke="black" points="610.58,-18005.56 600.07,-18004.28 607.49,-18011.84 610.58,-18005.56"/>
</g>
<!-- kv_send0_9_3 -->
<g id="node326" class="node">
<title>kv_send0_9_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1426" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1426" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1426" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_9_3&#45;&gt;kv_send0_9_3 -->
<g id="edge445" class="edge">
<title>ring_stage0_9_3&#45;&gt;kv_send0_9_3</title>
<path fill="none" stroke="black" d="M1427.63,-17950.93C1427.32,-17928.97 1426.86,-17897.11 1426.51,-17872.6"/>
<polygon fill="black" stroke="black" points="1430.01,-17872.55 1426.37,-17862.6 1423.01,-17872.65 1430.01,-17872.55"/>
</g>
<!-- ring_stage0_10_3 -->
<g id="node342" class="node">
<title>ring_stage0_10_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1304.5,-17862.11 1111.5,-17862.11 1111.5,-17809.11 1304.5,-17809.11 1304.5,-17862.11"/>
<text text-anchor="middle" x="1208" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="1208" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_9×V_9</text>
<text text-anchor="middle" x="1208" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_9_3&#45;&gt;ring_stage0_10_3 -->
<g id="edge491" class="edge">
<title>ring_stage0_9_3&#45;&gt;ring_stage0_10_3</title>
<path fill="none" stroke="black" d="M1387.9,-17951.1C1351.03,-17927.63 1296.27,-17892.78 1256.86,-17867.7"/>
<polygon fill="black" stroke="black" points="1258.51,-17864.6 1248.19,-17862.19 1254.75,-17870.51 1258.51,-17864.6"/>
</g>
<!-- kv_send0_9_4 -->
<g id="node327" class="node">
<title>kv_send0_9_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1921" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1921" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1921" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_9_4&#45;&gt;kv_send0_9_4 -->
<g id="edge448" class="edge">
<title>ring_stage0_9_4&#45;&gt;kv_send0_9_4</title>
<path fill="none" stroke="black" d="M1874.45,-17808.93C1883.48,-17786.77 1896.6,-17754.54 1906.61,-17729.95"/>
<polygon fill="black" stroke="black" points="1909.89,-17731.18 1910.42,-17720.6 1903.41,-17728.54 1909.89,-17731.18"/>
</g>
<!-- ring_stage0_10_4 -->
<g id="node343" class="node">
<title>ring_stage0_10_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1799.5,-17720.11 1588.5,-17720.11 1588.5,-17667.11 1799.5,-17667.11 1799.5,-17720.11"/>
<text text-anchor="middle" x="1694" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="1694" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_10×V_10</text>
<text text-anchor="middle" x="1694" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_9_4&#45;&gt;ring_stage0_10_4 -->
<g id="edge494" class="edge">
<title>ring_stage0_9_4&#45;&gt;ring_stage0_10_4</title>
<path fill="none" stroke="black" d="M1832.82,-17808.93C1804.66,-17785.74 1763.12,-17751.53 1732.82,-17726.58"/>
<polygon fill="black" stroke="black" points="1734.93,-17723.78 1724.98,-17720.13 1730.48,-17729.18 1734.93,-17723.78"/>
</g>
<!-- kv_send0_9_5 -->
<g id="node328" class="node">
<title>kv_send0_9_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3099" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3099" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="3099" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_9_5&#45;&gt;kv_send0_9_5 -->
<g id="edge451" class="edge">
<title>ring_stage0_9_5&#45;&gt;kv_send0_9_5</title>
<path fill="none" stroke="black" d="M2634.61,-17666.98C2654.34,-17657.72 2677.37,-17647.79 2699,-17640.61 2800.22,-17607 2920.14,-17582.56 3002.11,-17568.09"/>
<polygon fill="black" stroke="black" points="3002.91,-17571.5 3012.16,-17566.33 3001.71,-17564.61 3002.91,-17571.5"/>
</g>
<!-- ring_stage0_10_5 -->
<g id="node344" class="node">
<title>ring_stage0_10_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2547.5,-17578.11 2336.5,-17578.11 2336.5,-17525.11 2547.5,-17525.11 2547.5,-17578.11"/>
<text text-anchor="middle" x="2442" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="2442" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_11×V_11</text>
<text text-anchor="middle" x="2442" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_9_5&#45;&gt;ring_stage0_10_5 -->
<g id="edge497" class="edge">
<title>ring_stage0_9_5&#45;&gt;ring_stage0_10_5</title>
<path fill="none" stroke="black" d="M2557.96,-17666.93C2534.64,-17643.94 2500.32,-17610.11 2475.07,-17585.22"/>
<polygon fill="black" stroke="black" points="2477.46,-17582.65 2467.88,-17578.13 2472.54,-17587.64 2477.46,-17582.65"/>
</g>
<!-- kv_send0_9_6 -->
<g id="node329" class="node">
<title>kv_send0_9_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3686" cy="-19080.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3686" y="-19084.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3686" y="-19069.42" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_9_6&#45;&gt;kv_send0_9_6 -->
<g id="edge454" class="edge">
<title>ring_stage0_9_6&#45;&gt;kv_send0_9_6</title>
<path fill="none" stroke="black" d="M3689.53,-19143.51C3689.07,-19135.46 3688.55,-19126.43 3688.06,-19117.81"/>
<polygon fill="black" stroke="black" points="3691.54,-19117.38 3687.48,-19107.59 3684.55,-19117.77 3691.54,-19117.38"/>
</g>
<!-- ring_stage0_10_6 -->
<g id="node345" class="node">
<title>ring_stage0_10_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3462.5,-17436.11 3251.5,-17436.11 3251.5,-17383.11 3462.5,-17383.11 3462.5,-17436.11"/>
<text text-anchor="middle" x="3357" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="3357" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_12×V_12</text>
<text text-anchor="middle" x="3357" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_9_6&#45;&gt;ring_stage0_10_6 -->
<g id="edge500" class="edge">
<title>ring_stage0_9_6&#45;&gt;ring_stage0_10_6</title>
<path fill="none" stroke="black" d="M3756.37,-19143.73C3772.26,-19134.56 3787.63,-19122.63 3798,-19107.49 3827.38,-19064.59 3816,-19043.88 3816,-18991.88 3816,-18991.88 3816,-18991.88 3816,-18720.66 3816,-18600.57 3856,-18573.53 3856,-18453.44 3856,-18453.44 3856,-18453.44 3856,-18361.7 3856,-18227.95 3898.67,-18153.5 3797,-18066.61 3738.91,-18016.96 3506.13,-18087.41 3455,-18030.61 3423.48,-17995.6 3425.36,-17961.23 3455,-17924.61 3503.32,-17864.92 3572.31,-17945.41 3624,-17888.61 3682.54,-17824.28 3709.13,-17568.23 3657,-17498.61 3634.31,-17468.31 3547.28,-17444.9 3472.76,-17429.87"/>
<polygon fill="black" stroke="black" points="3473.3,-17426.41 3462.81,-17427.9 3471.94,-17433.28 3473.3,-17426.41"/>
</g>
<!-- kv_send0_9_7 -->
<g id="node330" class="node">
<title>kv_send0_9_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3454" cy="-18990.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3454" y="-18994.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3454" y="-18979.68" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_9_7&#45;&gt;kv_send0_9_7 -->
<g id="edge457" class="edge">
<title>ring_stage0_9_7&#45;&gt;kv_send0_9_7</title>
<path fill="none" stroke="black" d="M3455.41,-19053.77C3455.23,-19045.72 3455.02,-19036.69 3454.82,-19028.07"/>
<polygon fill="black" stroke="black" points="3458.32,-19027.77 3454.59,-19017.85 3451.32,-19027.93 3458.32,-19027.77"/>
</g>
<!-- ring_stage0_10_7 -->
<g id="node346" class="node">
<title>ring_stage0_10_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3786.5,-19017.38 3575.5,-19017.38 3575.5,-18964.38 3786.5,-18964.38 3786.5,-19017.38"/>
<text text-anchor="middle" x="3681" y="-19002.18" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="3681" y="-18987.18" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_13×V_13</text>
<text text-anchor="middle" x="3681" y="-18972.18" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_9_7&#45;&gt;ring_stage0_10_7 -->
<g id="edge503" class="edge">
<title>ring_stage0_9_7&#45;&gt;ring_stage0_10_7</title>
<path fill="none" stroke="black" d="M3521.68,-19054.01C3548.02,-19043.74 3578.53,-19031.84 3605.75,-19021.22"/>
<polygon fill="black" stroke="black" points="3607.19,-19024.42 3615.23,-19017.53 3604.65,-19017.9 3607.19,-19024.42"/>
</g>
<!-- kv_send0_9_8 -->
<g id="node331" class="node">
<title>kv_send0_9_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3204" cy="-18901.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3204" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3204" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_9_8&#45;&gt;kv_send0_9_8 -->
<g id="edge460" class="edge">
<title>ring_stage0_9_8&#45;&gt;kv_send0_9_8</title>
<path fill="none" stroke="black" d="M3204,-18964.03C3204,-18955.98 3204,-18946.95 3204,-18938.33"/>
<polygon fill="black" stroke="black" points="3207.5,-18938.11 3204,-18928.11 3200.5,-18938.11 3207.5,-18938.11"/>
</g>
<!-- ring_stage0_10_8 -->
<g id="node347" class="node">
<title>ring_stage0_10_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3548.5,-18927.64 3337.5,-18927.64 3337.5,-18874.64 3548.5,-18874.64 3548.5,-18927.64"/>
<text text-anchor="middle" x="3443" y="-18912.44" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="3443" y="-18897.44" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_14×V_14</text>
<text text-anchor="middle" x="3443" y="-18882.44" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_9_8&#45;&gt;ring_stage0_10_8 -->
<g id="edge506" class="edge">
<title>ring_stage0_9_8&#45;&gt;ring_stage0_10_8</title>
<path fill="none" stroke="black" d="M3273.77,-18964.27C3301.87,-18953.95 3334.44,-18942 3363.45,-18931.35"/>
<polygon fill="black" stroke="black" points="3364.96,-18934.52 3373.14,-18927.79 3362.55,-18927.95 3364.96,-18934.52"/>
</g>
<!-- kv_send0_9_9 -->
<g id="node332" class="node">
<title>kv_send0_9_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2971" cy="-18811.4" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2971" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2971" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_9_9&#45;&gt;kv_send0_9_9 -->
<g id="edge463" class="edge">
<title>ring_stage0_9_9&#45;&gt;kv_send0_9_9</title>
<path fill="none" stroke="black" d="M2975.23,-18874.29C2974.68,-18866.24 2974.06,-18857.21 2973.47,-18848.59"/>
<polygon fill="black" stroke="black" points="2976.95,-18848.11 2972.78,-18838.37 2969.97,-18848.59 2976.95,-18848.11"/>
</g>
<!-- ring_stage0_10_9 -->
<g id="node348" class="node">
<title>ring_stage0_10_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3309.5,-18837.9 3098.5,-18837.9 3098.5,-18784.9 3309.5,-18784.9 3309.5,-18837.9"/>
<text text-anchor="middle" x="3204" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="3204" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_15×V_15</text>
<text text-anchor="middle" x="3204" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_9_9&#45;&gt;ring_stage0_10_9 -->
<g id="edge509" class="edge">
<title>ring_stage0_9_9&#45;&gt;ring_stage0_10_9</title>
<path fill="none" stroke="black" d="M3043.27,-18874.53C3069.84,-18864.26 3100.62,-18852.36 3128.08,-18841.74"/>
<polygon fill="black" stroke="black" points="3129.58,-18844.92 3137.65,-18838.05 3127.06,-18838.39 3129.58,-18844.92"/>
</g>
<!-- kv_send0_9_10 -->
<g id="node333" class="node">
<title>kv_send0_9_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2742" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2742" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2742" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_9_10&#45;&gt;kv_send0_9_10 -->
<g id="edge466" class="edge">
<title>ring_stage0_9_10&#45;&gt;kv_send0_9_10</title>
<path fill="none" stroke="black" d="M2742,-18784.55C2742,-18776.5 2742,-18767.47 2742,-18758.85"/>
<polygon fill="black" stroke="black" points="2745.5,-18758.63 2742,-18748.63 2738.5,-18758.63 2745.5,-18758.63"/>
</g>
<!-- ring_stage0_10_10 -->
<g id="node349" class="node">
<title>ring_stage0_10_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3072,-18748.16 2870,-18748.16 2870,-18695.16 3072,-18695.16 3072,-18748.16"/>
<text text-anchor="middle" x="2971" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="2971" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_0×V_0</text>
<text text-anchor="middle" x="2971" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_9_10&#45;&gt;ring_stage0_10_10 -->
<g id="edge512" class="edge">
<title>ring_stage0_9_10&#45;&gt;ring_stage0_10_10</title>
<path fill="none" stroke="black" d="M2808.85,-18784.79C2835.66,-18774.52 2866.71,-18762.62 2894.42,-18752"/>
<polygon fill="black" stroke="black" points="2895.98,-18755.15 2904.07,-18748.31 2893.47,-18748.62 2895.98,-18755.15"/>
</g>
<!-- kv_send0_9_11 -->
<g id="node334" class="node">
<title>kv_send0_9_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2484" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2484" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="2484" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_9_11&#45;&gt;kv_send0_9_11 -->
<g id="edge469" class="edge">
<title>ring_stage0_9_11&#45;&gt;kv_send0_9_11</title>
<path fill="none" stroke="black" d="M2490.35,-18694.81C2489.52,-18686.76 2488.6,-18677.73 2487.71,-18669.11"/>
<polygon fill="black" stroke="black" points="2491.17,-18668.48 2486.66,-18658.89 2484.2,-18669.19 2491.17,-18668.48"/>
</g>
<!-- ring_stage0_10_11 -->
<g id="node350" class="node">
<title>ring_stage0_10_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2834,-18658.42 2632,-18658.42 2632,-18605.42 2834,-18605.42 2834,-18658.42"/>
<text text-anchor="middle" x="2733" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="2733" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_1×V_1</text>
<text text-anchor="middle" x="2733" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_9_11&#45;&gt;ring_stage0_10_11 -->
<g id="edge515" class="edge">
<title>ring_stage0_9_11&#45;&gt;ring_stage0_10_11</title>
<path fill="none" stroke="black" d="M2563.06,-18695.05C2591.28,-18684.73 2623.98,-18672.78 2653.12,-18662.12"/>
<polygon fill="black" stroke="black" points="2654.66,-18665.29 2662.85,-18658.57 2652.26,-18658.71 2654.66,-18665.29"/>
</g>
<!-- kv_send0_9_12 -->
<g id="node335" class="node">
<title>kv_send0_9_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2235" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2235" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="2235" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_9_12&#45;&gt;kv_send0_9_12 -->
<g id="edge472" class="edge">
<title>ring_stage0_9_12&#45;&gt;kv_send0_9_12</title>
<path fill="none" stroke="black" d="M2249.11,-18605.07C2247.25,-18596.93 2245.17,-18587.79 2243.18,-18579.09"/>
<polygon fill="black" stroke="black" points="2246.55,-18578.12 2240.92,-18569.15 2239.73,-18579.68 2246.55,-18578.12"/>
</g>
<!-- ring_stage0_10_12 -->
<g id="node351" class="node">
<title>ring_stage0_10_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2585,-18568.68 2383,-18568.68 2383,-18515.68 2585,-18515.68 2585,-18568.68"/>
<text text-anchor="middle" x="2484" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="2484" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_2×V_2</text>
<text text-anchor="middle" x="2484" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_9_12&#45;&gt;ring_stage0_10_12 -->
<g id="edge518" class="edge">
<title>ring_stage0_9_12&#45;&gt;ring_stage0_10_12</title>
<path fill="none" stroke="black" d="M2321.85,-18605.31C2348.66,-18595.04 2379.71,-18583.14 2407.42,-18572.52"/>
<polygon fill="black" stroke="black" points="2408.98,-18575.67 2417.07,-18568.83 2406.47,-18569.14 2408.98,-18575.67"/>
</g>
<!-- kv_send0_9_13 -->
<g id="node336" class="node">
<title>kv_send0_9_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1997" cy="-18452.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1997" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="1997" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_9_13&#45;&gt;kv_send0_9_13 -->
<g id="edge475" class="edge">
<title>ring_stage0_9_13&#45;&gt;kv_send0_9_13</title>
<path fill="none" stroke="black" d="M2003.35,-18515.33C2002.52,-18507.28 2001.6,-18498.25 2000.71,-18489.63"/>
<polygon fill="black" stroke="black" points="2004.17,-18489 1999.66,-18479.41 1997.2,-18489.71 2004.17,-18489"/>
</g>
<!-- ring_stage0_10_13 -->
<g id="node352" class="node">
<title>ring_stage0_10_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2327,-18478.94 2125,-18478.94 2125,-18425.94 2327,-18425.94 2327,-18478.94"/>
<text text-anchor="middle" x="2226" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="2226" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_3×V_3</text>
<text text-anchor="middle" x="2226" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_9_13&#45;&gt;ring_stage0_10_13 -->
<g id="edge521" class="edge">
<title>ring_stage0_9_13&#45;&gt;ring_stage0_10_13</title>
<path fill="none" stroke="black" d="M2070.22,-18515.57C2095.87,-18505.34 2125.55,-18493.5 2152.08,-18482.92"/>
<polygon fill="black" stroke="black" points="2153.7,-18486.04 2161.7,-18479.09 2151.11,-18479.54 2153.7,-18486.04"/>
</g>
<!-- kv_send0_9_14 -->
<g id="node337" class="node">
<title>kv_send0_9_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1756" cy="-18362.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1756" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="1756" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_9_14&#45;&gt;kv_send0_9_14 -->
<g id="edge478" class="edge">
<title>ring_stage0_9_14&#45;&gt;kv_send0_9_14</title>
<path fill="none" stroke="black" d="M1764.46,-18425.59C1763.35,-18417.45 1762.1,-18408.31 1760.91,-18399.61"/>
<polygon fill="black" stroke="black" points="1764.37,-18399.1 1759.55,-18389.67 1757.44,-18400.05 1764.37,-18399.1"/>
</g>
<!-- ring_stage0_10_14 -->
<g id="node353" class="node">
<title>ring_stage0_10_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2087,-18389.2 1885,-18389.2 1885,-18336.2 2087,-18336.2 2087,-18389.2"/>
<text text-anchor="middle" x="1986" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="1986" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_4×V_4</text>
<text text-anchor="middle" x="1986" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_9_14&#45;&gt;ring_stage0_10_14 -->
<g id="edge524" class="edge">
<title>ring_stage0_9_14&#45;&gt;ring_stage0_10_14</title>
<path fill="none" stroke="black" d="M1831.64,-18425.83C1857.05,-18415.6 1886.46,-18403.76 1912.75,-18393.18"/>
<polygon fill="black" stroke="black" points="1914.31,-18396.33 1922.28,-18389.35 1911.7,-18389.83 1914.31,-18396.33"/>
</g>
<!-- kv_send0_9_15 -->
<g id="node338" class="node">
<title>kv_send0_9_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1064" cy="-18272.96" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1064" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1064" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_9_15&#45;&gt;kv_send0_9_15 -->
<g id="edge481" class="edge">
<title>ring_stage0_9_15&#45;&gt;kv_send0_9_15</title>
<path fill="none" stroke="black" d="M1226.15,-18336.09C1195.89,-18324.49 1160.23,-18310.83 1130.07,-18299.27"/>
<polygon fill="black" stroke="black" points="1131.07,-18295.91 1120.48,-18295.6 1128.57,-18302.45 1131.07,-18295.91"/>
</g>
<!-- ring_stage0_10_15 -->
<g id="node354" class="node">
<title>ring_stage0_10_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1623,-18299.46 1421,-18299.46 1421,-18246.46 1623,-18246.46 1623,-18299.46"/>
<text text-anchor="middle" x="1522" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="1522" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_5×V_5</text>
<text text-anchor="middle" x="1522" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_9_15&#45;&gt;ring_stage0_10_15 -->
<g id="edge527" class="edge">
<title>ring_stage0_9_15&#45;&gt;ring_stage0_10_15</title>
<path fill="none" stroke="black" d="M1359.85,-18336.09C1386.66,-18325.82 1417.71,-18313.92 1445.42,-18303.3"/>
<polygon fill="black" stroke="black" points="1446.98,-18306.45 1455.07,-18299.61 1444.47,-18299.92 1446.98,-18306.45"/>
</g>
<!-- kv_send0_9_0&#45;&gt;ring_stage0_10_1 -->
<g id="edge486" class="edge">
<title>kv_send0_9_0&#45;&gt;ring_stage0_10_1</title>
<path fill="none" stroke="black" d="M337.43,-18162.2C300.05,-18150.61 252.38,-18135.83 211.12,-18123.04"/>
<polygon fill="black" stroke="black" points="211.91,-18119.62 201.33,-18120 209.84,-18126.31 211.91,-18119.62"/>
</g>
<!-- kv_send0_9_1&#45;&gt;ring_stage0_10_2 -->
<g id="edge489" class="edge">
<title>kv_send0_9_1&#45;&gt;ring_stage0_10_2</title>
<path fill="none" stroke="black" d="M558.02,-18066.36C556.25,-18050.91 554,-18031.14 552.07,-18014.28"/>
<polygon fill="black" stroke="black" points="555.54,-18013.76 550.92,-18004.22 548.58,-18014.55 555.54,-18013.76"/>
</g>
<!-- kv_send0_9_2&#45;&gt;ring_stage0_10_3 -->
<g id="edge492" class="edge">
<title>kv_send0_9_2&#45;&gt;ring_stage0_10_3</title>
<path fill="none" stroke="black" d="M809.31,-17953.1C829.65,-17942.95 854.53,-17931.79 878,-17924.61 974.42,-17895.1 1005.9,-17919.15 1102,-17888.61 1119.47,-17883.06 1137.68,-17875.04 1153.97,-17866.95"/>
<polygon fill="black" stroke="black" points="1155.99,-17869.85 1163.32,-17862.2 1152.82,-17863.61 1155.99,-17869.85"/>
</g>
<!-- kv_send0_9_3&#45;&gt;ring_stage0_10_4 -->
<g id="edge495" class="edge">
<title>kv_send0_9_3&#45;&gt;ring_stage0_10_4</title>
<path fill="none" stroke="black" d="M1470.56,-17811.34C1515.81,-17787.69 1586.13,-17750.96 1635.77,-17725.03"/>
<polygon fill="black" stroke="black" points="1637.55,-17728.05 1644.79,-17720.32 1634.31,-17721.85 1637.55,-17728.05"/>
</g>
<!-- kv_send0_9_4&#45;&gt;ring_stage0_10_5 -->
<g id="edge498" class="edge">
<title>kv_send0_9_4&#45;&gt;ring_stage0_10_5</title>
<path fill="none" stroke="black" d="M1963.8,-17669.11C1984.44,-17658.77 2009.9,-17647.46 2034,-17640.61 2160.21,-17604.76 2200.67,-17640.04 2327,-17604.61 2346.49,-17599.14 2366.89,-17590.85 2385.01,-17582.48"/>
<polygon fill="black" stroke="black" points="2386.71,-17585.55 2394.26,-17578.11 2383.72,-17579.22 2386.71,-17585.55"/>
</g>
<!-- kv_send0_9_5&#45;&gt;ring_stage0_10_6 -->
<g id="edge501" class="edge">
<title>kv_send0_9_5&#45;&gt;ring_stage0_10_6</title>
<path fill="none" stroke="black" d="M3142.18,-17527.18C3185.71,-17503.56 3253.1,-17466.99 3300.78,-17441.12"/>
<polygon fill="black" stroke="black" points="3302.62,-17444.1 3309.74,-17436.26 3299.28,-17437.95 3302.62,-17444.1"/>
</g>
<!-- kv_send0_9_6&#45;&gt;ring_stage0_10_7 -->
<g id="edge504" class="edge">
<title>kv_send0_9_6&#45;&gt;ring_stage0_10_7</title>
<path fill="none" stroke="black" d="M3684.5,-19053.3C3684.04,-19045.26 3683.53,-19036.28 3683.04,-19027.72"/>
<polygon fill="black" stroke="black" points="3686.53,-19027.37 3682.46,-19017.58 3679.54,-19027.77 3686.53,-19027.37"/>
</g>
<!-- kv_send0_9_7&#45;&gt;ring_stage0_10_8 -->
<g id="edge507" class="edge">
<title>kv_send0_9_7&#45;&gt;ring_stage0_10_8</title>
<path fill="none" stroke="black" d="M3450.7,-18963.56C3449.69,-18955.52 3448.57,-18946.54 3447.49,-18937.98"/>
<polygon fill="black" stroke="black" points="3450.94,-18937.33 3446.22,-18927.84 3443.99,-18938.2 3450.94,-18937.33"/>
</g>
<!-- kv_send0_9_8&#45;&gt;ring_stage0_10_9 -->
<g id="edge510" class="edge">
<title>kv_send0_9_8&#45;&gt;ring_stage0_10_9</title>
<path fill="none" stroke="black" d="M3204,-18873.82C3204,-18865.78 3204,-18856.8 3204,-18848.24"/>
<polygon fill="black" stroke="black" points="3207.5,-18848.1 3204,-18838.1 3200.5,-18848.1 3207.5,-18848.1"/>
</g>
<!-- kv_send0_9_9&#45;&gt;ring_stage0_10_10 -->
<g id="edge513" class="edge">
<title>kv_send0_9_9&#45;&gt;ring_stage0_10_10</title>
<path fill="none" stroke="black" d="M2971,-18784.08C2971,-18776.04 2971,-18767.06 2971,-18758.5"/>
<polygon fill="black" stroke="black" points="2974.5,-18758.36 2971,-18748.36 2967.5,-18758.36 2974.5,-18758.36"/>
</g>
<!-- kv_send0_9_10&#45;&gt;ring_stage0_10_11 -->
<g id="edge516" class="edge">
<title>kv_send0_9_10&#45;&gt;ring_stage0_10_11</title>
<path fill="none" stroke="black" d="M2739.3,-18694.34C2738.48,-18686.3 2737.55,-18677.32 2736.68,-18668.76"/>
<polygon fill="black" stroke="black" points="2740.14,-18668.21 2735.64,-18658.62 2733.18,-18668.93 2740.14,-18668.21"/>
</g>
<!-- kv_send0_9_11&#45;&gt;ring_stage0_10_12 -->
<g id="edge519" class="edge">
<title>kv_send0_9_11&#45;&gt;ring_stage0_10_12</title>
<path fill="none" stroke="black" d="M2484,-18604.6C2484,-18596.56 2484,-18587.58 2484,-18579.02"/>
<polygon fill="black" stroke="black" points="2487.5,-18578.88 2484,-18568.88 2480.5,-18578.88 2487.5,-18578.88"/>
</g>
<!-- kv_send0_9_12&#45;&gt;ring_stage0_10_13 -->
<g id="edge522" class="edge">
<title>kv_send0_9_12&#45;&gt;ring_stage0_10_13</title>
<path fill="none" stroke="black" d="M2232.3,-18514.86C2231.48,-18506.82 2230.55,-18497.84 2229.68,-18489.28"/>
<polygon fill="black" stroke="black" points="2233.14,-18488.73 2228.64,-18479.14 2226.18,-18489.45 2233.14,-18488.73"/>
</g>
<!-- kv_send0_9_13&#45;&gt;ring_stage0_10_14 -->
<g id="edge525" class="edge">
<title>kv_send0_9_13&#45;&gt;ring_stage0_10_14</title>
<path fill="none" stroke="black" d="M1993.7,-18425.12C1992.69,-18417.08 1991.57,-18408.1 1990.49,-18399.54"/>
<polygon fill="black" stroke="black" points="1993.94,-18398.89 1989.22,-18389.4 1986.99,-18399.76 1993.94,-18398.89"/>
</g>
<!-- kv_send0_9_14&#45;&gt;ring_stage0_10_15 -->
<g id="edge528" class="edge">
<title>kv_send0_9_14&#45;&gt;ring_stage0_10_15</title>
<path fill="none" stroke="black" d="M1697.86,-18339.9C1668.29,-18328.81 1631.95,-18315.19 1600,-18303.21"/>
<polygon fill="black" stroke="black" points="1600.82,-18299.78 1590.23,-18299.54 1598.37,-18306.33 1600.82,-18299.78"/>
</g>
<!-- kv_send0_9_15&#45;&gt;ring_stage0_10_0 -->
<g id="edge483" class="edge">
<title>kv_send0_9_15&#45;&gt;ring_stage0_10_0</title>
<path fill="none" stroke="black" d="M1009.34,-18250.16C981.66,-18239.12 947.67,-18225.57 917.72,-18213.62"/>
<polygon fill="black" stroke="black" points="918.73,-18210.26 908.15,-18209.8 916.14,-18216.76 918.73,-18210.26"/>
</g>
<!-- kv_send0_10_0 -->
<g id="node355" class="node">
<title>kv_send0_10_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="337" cy="-18093.48" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="337" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="337" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_10_0&#45;&gt;kv_send0_10_0 -->
<g id="edge484" class="edge">
<title>ring_stage0_10_0&#45;&gt;kv_send0_10_0</title>
<path fill="none" stroke="black" d="M747.34,-18158.14C744.19,-18157.51 741.07,-18156.92 738,-18156.35 610.69,-18132.97 576.45,-18142.95 449,-18120.35 439.67,-18118.7 429.94,-18116.76 420.29,-18114.72"/>
<polygon fill="black" stroke="black" points="420.79,-18111.24 410.28,-18112.55 419.31,-18118.09 420.79,-18111.24"/>
</g>
<!-- ring_stage0_11_0 -->
<g id="node371" class="node">
<title>ring_stage0_11_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1086.5,-18119.98 893.5,-18119.98 893.5,-18066.98 1086.5,-18066.98 1086.5,-18119.98"/>
<text text-anchor="middle" x="990" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="990" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_5×V_5</text>
<text text-anchor="middle" x="990" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_10_0&#45;&gt;ring_stage0_11_0 -->
<g id="edge530" class="edge">
<title>ring_stage0_10_0&#45;&gt;ring_stage0_11_0</title>
<path fill="none" stroke="black" d="M886.62,-18156.61C902.89,-18146.83 921.61,-18135.58 938.61,-18125.36"/>
<polygon fill="black" stroke="black" points="940.56,-18128.28 947.33,-18120.13 936.95,-18122.28 940.56,-18128.28"/>
</g>
<!-- kv_send0_10_1 -->
<g id="node356" class="node">
<title>kv_send0_10_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="119" cy="-17977.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="119" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="119" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_10_1&#45;&gt;kv_send0_10_1 -->
<g id="edge487" class="edge">
<title>ring_stage0_10_1&#45;&gt;kv_send0_10_1</title>
<path fill="none" stroke="black" d="M119,-18066.93C119,-18051.61 119,-18031.9 119,-18014.98"/>
<polygon fill="black" stroke="black" points="122.5,-18014.87 119,-18004.87 115.5,-18014.87 122.5,-18014.87"/>
</g>
<!-- ring_stage0_11_1 -->
<g id="node372" class="node">
<title>ring_stage0_11_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="433.5,-18004.11 240.5,-18004.11 240.5,-17951.11 433.5,-17951.11 433.5,-18004.11"/>
<text text-anchor="middle" x="337" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="337" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_6×V_6</text>
<text text-anchor="middle" x="337" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_10_1&#45;&gt;ring_stage0_11_1 -->
<g id="edge533" class="edge">
<title>ring_stage0_10_1&#45;&gt;ring_stage0_11_1</title>
<path fill="none" stroke="black" d="M167.92,-18066.93C200.77,-18049.77 244.19,-18027.09 278.81,-18009.01"/>
<polygon fill="black" stroke="black" points="280.62,-18012.01 287.86,-18004.28 277.38,-18005.8 280.62,-18012.01"/>
</g>
<!-- kv_send0_10_2 -->
<g id="node357" class="node">
<title>kv_send0_10_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="990" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="990" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="990" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_10_2&#45;&gt;kv_send0_10_2 -->
<g id="edge490" class="edge">
<title>ring_stage0_10_2&#45;&gt;kv_send0_10_2</title>
<path fill="none" stroke="black" d="M592.68,-17951.02C611.15,-17941.43 633.1,-17931.25 654,-17924.61 750.1,-17894.07 781.58,-17918.12 878,-17888.61 898.08,-17882.46 919.19,-17873.41 937.6,-17864.57"/>
<polygon fill="black" stroke="black" points="939.24,-17867.66 946.69,-17860.12 936.17,-17861.38 939.24,-17867.66"/>
</g>
<!-- ring_stage0_11_2 -->
<g id="node373" class="node">
<title>ring_stage0_11_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="433.5,-17862.11 240.5,-17862.11 240.5,-17809.11 433.5,-17809.11 433.5,-17862.11"/>
<text text-anchor="middle" x="337" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="337" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_7×V_7</text>
<text text-anchor="middle" x="337" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_10_2&#45;&gt;ring_stage0_11_2 -->
<g id="edge536" class="edge">
<title>ring_stage0_10_2&#45;&gt;ring_stage0_11_2</title>
<path fill="none" stroke="black" d="M509.3,-17950.93C474.05,-17927.55 421.91,-17892.95 384.22,-17867.94"/>
<polygon fill="black" stroke="black" points="385.72,-17864.74 375.46,-17862.13 381.85,-17870.57 385.72,-17864.74"/>
</g>
<!-- kv_send0_10_3 -->
<g id="node358" class="node">
<title>kv_send0_10_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1467" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1467" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1467" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_10_3&#45;&gt;kv_send0_10_3 -->
<g id="edge493" class="edge">
<title>ring_stage0_10_3&#45;&gt;kv_send0_10_3</title>
<path fill="none" stroke="black" d="M1255.2,-17809.1C1300.21,-17784.77 1367.85,-17748.2 1414.53,-17722.98"/>
<polygon fill="black" stroke="black" points="1416.43,-17725.92 1423.57,-17718.09 1413.11,-17719.76 1416.43,-17725.92"/>
</g>
<!-- ring_stage0_11_3 -->
<g id="node374" class="node">
<title>ring_stage0_11_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1121.5,-17720.11 928.5,-17720.11 928.5,-17667.11 1121.5,-17667.11 1121.5,-17720.11"/>
<text text-anchor="middle" x="1025" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="1025" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_8×V_8</text>
<text text-anchor="middle" x="1025" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_10_3&#45;&gt;ring_stage0_11_3 -->
<g id="edge539" class="edge">
<title>ring_stage0_10_3&#45;&gt;ring_stage0_11_3</title>
<path fill="none" stroke="black" d="M1174.43,-17808.93C1144,-17785.65 1099.02,-17751.24 1066.37,-17726.26"/>
<polygon fill="black" stroke="black" points="1068.42,-17723.42 1058.35,-17720.13 1064.17,-17728.98 1068.42,-17723.42"/>
</g>
<!-- kv_send0_10_4 -->
<g id="node359" class="node">
<title>kv_send0_10_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2215" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2215" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="2215" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_10_4&#45;&gt;kv_send0_10_4 -->
<g id="edge496" class="edge">
<title>ring_stage0_10_4&#45;&gt;kv_send0_10_4</title>
<path fill="none" stroke="black" d="M1741.74,-17667.1C1761.96,-17657.34 1786.11,-17647.03 1809,-17640.61 1935.76,-17605.08 1976.42,-17640.77 2103,-17604.61 2123.46,-17598.77 2144.88,-17589.64 2163.45,-17580.65"/>
<polygon fill="black" stroke="black" points="2165.19,-17583.7 2172.6,-17576.13 2162.09,-17577.42 2165.19,-17583.7"/>
</g>
<!-- ring_stage0_11_4 -->
<g id="node375" class="node">
<title>ring_stage0_11_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1786.5,-17578.11 1593.5,-17578.11 1593.5,-17525.11 1786.5,-17525.11 1786.5,-17578.11"/>
<text text-anchor="middle" x="1690" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="1690" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_9×V_9</text>
<text text-anchor="middle" x="1690" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_10_4&#45;&gt;ring_stage0_11_4 -->
<g id="edge542" class="edge">
<title>ring_stage0_10_4&#45;&gt;ring_stage0_11_4</title>
<path fill="none" stroke="black" d="M1693.27,-17666.93C1692.63,-17644.83 1691.72,-17612.71 1691.02,-17588.14"/>
<polygon fill="black" stroke="black" points="1694.51,-17588.02 1690.73,-17578.13 1687.52,-17588.22 1694.51,-17588.02"/>
</g>
<!-- kv_send0_10_5 -->
<g id="node360" class="node">
<title>kv_send0_10_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2462" cy="-17409.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2462" y="-17413.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2462" y="-17398.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_10_5&#45;&gt;kv_send0_10_5 -->
<g id="edge499" class="edge">
<title>ring_stage0_10_5&#45;&gt;kv_send0_10_5</title>
<path fill="none" stroke="black" d="M2445.67,-17524.93C2448.81,-17502.97 2453.36,-17471.11 2456.86,-17446.6"/>
<polygon fill="black" stroke="black" points="2460.34,-17446.99 2458.29,-17436.6 2453.41,-17446 2460.34,-17446.99"/>
</g>
<!-- ring_stage0_11_5 -->
<g id="node376" class="node">
<title>ring_stage0_11_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2320.5,-17436.11 2109.5,-17436.11 2109.5,-17383.11 2320.5,-17383.11 2320.5,-17436.11"/>
<text text-anchor="middle" x="2215" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2215" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_10×V_10</text>
<text text-anchor="middle" x="2215" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_10_5&#45;&gt;ring_stage0_11_5 -->
<g id="edge545" class="edge">
<title>ring_stage0_10_5&#45;&gt;ring_stage0_11_5</title>
<path fill="none" stroke="black" d="M2400.63,-17525.1C2362.5,-17501.58 2305.84,-17466.64 2265.15,-17441.54"/>
<polygon fill="black" stroke="black" points="2266.82,-17438.46 2256.47,-17436.19 2263.14,-17444.42 2266.82,-17438.46"/>
</g>
<!-- kv_send0_10_6 -->
<g id="node361" class="node">
<title>kv_send0_10_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3565" cy="-17267.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3565" y="-17271.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3565" y="-17256.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_10_6&#45;&gt;kv_send0_10_6 -->
<g id="edge502" class="edge">
<title>ring_stage0_10_6&#45;&gt;kv_send0_10_6</title>
<path fill="none" stroke="black" d="M3395.15,-17382.93C3430.44,-17359.18 3482.91,-17323.87 3520.18,-17298.78"/>
<polygon fill="black" stroke="black" points="3522.49,-17301.44 3528.83,-17292.95 3518.58,-17295.63 3522.49,-17301.44"/>
</g>
<!-- ring_stage0_11_6 -->
<g id="node377" class="node">
<title>ring_stage0_11_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2998.5,-17294.11 2787.5,-17294.11 2787.5,-17241.11 2998.5,-17241.11 2998.5,-17294.11"/>
<text text-anchor="middle" x="2893" y="-17278.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2893" y="-17263.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_11×V_11</text>
<text text-anchor="middle" x="2893" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_10_6&#45;&gt;ring_stage0_11_6 -->
<g id="edge548" class="edge">
<title>ring_stage0_10_6&#45;&gt;ring_stage0_11_6</title>
<path fill="none" stroke="black" d="M3251.39,-17387.31C3181.17,-17371.87 3087.41,-17348.8 3007,-17320.61 2989.16,-17314.36 2970.29,-17306.36 2953.15,-17298.52"/>
<polygon fill="black" stroke="black" points="2954.37,-17295.22 2943.83,-17294.19 2951.43,-17301.57 2954.37,-17295.22"/>
</g>
<!-- kv_send0_10_7 -->
<g id="node362" class="node">
<title>kv_send0_10_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3673" cy="-18901.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3673" y="-18904.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3673" y="-18889.94" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_10_7&#45;&gt;kv_send0_10_7 -->
<g id="edge505" class="edge">
<title>ring_stage0_10_7&#45;&gt;kv_send0_10_7</title>
<path fill="none" stroke="black" d="M3678.64,-18964.03C3677.91,-18955.98 3677.09,-18946.95 3676.3,-18938.33"/>
<polygon fill="black" stroke="black" points="3679.76,-18937.75 3675.37,-18928.11 3672.79,-18938.39 3679.76,-18937.75"/>
</g>
<!-- ring_stage0_11_7 -->
<g id="node378" class="node">
<title>ring_stage0_11_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3707.5,-17152.11 3496.5,-17152.11 3496.5,-17099.11 3707.5,-17099.11 3707.5,-17152.11"/>
<text text-anchor="middle" x="3602" y="-17136.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="3602" y="-17121.91" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_12×V_12</text>
<text text-anchor="middle" x="3602" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_10_7&#45;&gt;ring_stage0_11_7 -->
<g id="edge551" class="edge">
<title>ring_stage0_10_7&#45;&gt;ring_stage0_11_7</title>
<path fill="none" stroke="black" d="M3738.03,-18964.35C3754.76,-18954.79 3772.03,-18942.63 3785,-18928.01 3851.25,-18853.33 3876,-18822.49 3876,-18722.66 3876,-18722.66 3876,-18722.66 3876,-18271.96 3876,-18161.94 3913.1,-18139.16 3931,-18030.61 3945.1,-17945.09 3951,-17923.29 3951,-17836.61 3951,-17836.61 3951,-17836.61 3951,-17550.61 3951,-17464.27 3998.18,-17421.3 3941,-17356.61 3880.03,-17287.63 3809.05,-17377.93 3737,-17320.61 3696.95,-17288.75 3720.86,-17256.88 3692,-17214.61 3678,-17194.11 3658.7,-17174.47 3641.57,-17158.97"/>
<polygon fill="black" stroke="black" points="3643.68,-17156.17 3633.87,-17152.15 3639.04,-17161.41 3643.68,-17156.17"/>
</g>
<!-- kv_send0_10_8 -->
<g id="node363" class="node">
<title>kv_send0_10_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3441" cy="-18811.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3441" y="-18815.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3441" y="-18800.2" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_10_8&#45;&gt;kv_send0_10_8 -->
<g id="edge508" class="edge">
<title>ring_stage0_10_8&#45;&gt;kv_send0_10_8</title>
<path fill="none" stroke="black" d="M3442.41,-18874.29C3442.23,-18866.24 3442.02,-18857.21 3441.82,-18848.59"/>
<polygon fill="black" stroke="black" points="3445.32,-18848.29 3441.59,-18838.37 3438.32,-18848.45 3445.32,-18848.29"/>
</g>
<!-- ring_stage0_11_8 -->
<g id="node379" class="node">
<title>ring_stage0_11_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3777.5,-18837.9 3566.5,-18837.9 3566.5,-18784.9 3777.5,-18784.9 3777.5,-18837.9"/>
<text text-anchor="middle" x="3672" y="-18822.7" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="3672" y="-18807.7" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_13×V_13</text>
<text text-anchor="middle" x="3672" y="-18792.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_10_8&#45;&gt;ring_stage0_11_8 -->
<g id="edge554" class="edge">
<title>ring_stage0_10_8&#45;&gt;ring_stage0_11_8</title>
<path fill="none" stroke="black" d="M3509.85,-18874.53C3536.66,-18864.26 3567.71,-18852.36 3595.42,-18841.74"/>
<polygon fill="black" stroke="black" points="3596.98,-18844.89 3605.07,-18838.05 3594.47,-18838.36 3596.98,-18844.89"/>
</g>
<!-- kv_send0_10_9 -->
<g id="node364" class="node">
<title>kv_send0_10_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3202" cy="-18721.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3202" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="3202" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_10_9&#45;&gt;kv_send0_10_9 -->
<g id="edge511" class="edge">
<title>ring_stage0_10_9&#45;&gt;kv_send0_10_9</title>
<path fill="none" stroke="black" d="M3203.41,-18784.55C3203.23,-18776.5 3203.02,-18767.47 3202.82,-18758.85"/>
<polygon fill="black" stroke="black" points="3206.32,-18758.55 3202.59,-18748.63 3199.32,-18758.71 3206.32,-18758.55"/>
</g>
<!-- ring_stage0_11_9 -->
<g id="node380" class="node">
<title>ring_stage0_11_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3545.5,-18748.16 3334.5,-18748.16 3334.5,-18695.16 3545.5,-18695.16 3545.5,-18748.16"/>
<text text-anchor="middle" x="3440" y="-18732.96" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="3440" y="-18717.96" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_14×V_14</text>
<text text-anchor="middle" x="3440" y="-18702.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_10_9&#45;&gt;ring_stage0_11_9 -->
<g id="edge557" class="edge">
<title>ring_stage0_10_9&#45;&gt;ring_stage0_11_9</title>
<path fill="none" stroke="black" d="M3272.9,-18784.79C3300.64,-18774.47 3332.8,-18762.52 3361.45,-18751.87"/>
<polygon fill="black" stroke="black" points="3362.87,-18755.07 3371.02,-18748.31 3360.43,-18748.51 3362.87,-18755.07"/>
</g>
<!-- kv_send0_10_10 -->
<g id="node365" class="node">
<title>kv_send0_10_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2962" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2962" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2962" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_10_10&#45;&gt;kv_send0_10_10 -->
<g id="edge514" class="edge">
<title>ring_stage0_10_10&#45;&gt;kv_send0_10_10</title>
<path fill="none" stroke="black" d="M2968.35,-18694.81C2967.52,-18686.76 2966.6,-18677.73 2965.71,-18669.11"/>
<polygon fill="black" stroke="black" points="2969.17,-18668.48 2964.66,-18658.89 2962.2,-18669.19 2969.17,-18668.48"/>
</g>
<!-- ring_stage0_11_10 -->
<g id="node381" class="node">
<title>ring_stage0_11_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3310,-18658.42 3090,-18658.42 3090,-18605.42 3310,-18605.42 3310,-18658.42"/>
<text text-anchor="middle" x="3200" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="3200" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_15×V_15</text>
<text text-anchor="middle" x="3200" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_10_10&#45;&gt;ring_stage0_11_10 -->
<g id="edge560" class="edge">
<title>ring_stage0_10_10&#45;&gt;ring_stage0_11_10</title>
<path fill="none" stroke="black" d="M3037.85,-18695.05C3064.66,-18684.78 3095.71,-18672.88 3123.42,-18662.26"/>
<polygon fill="black" stroke="black" points="3124.98,-18665.41 3133.07,-18658.57 3122.47,-18658.88 3124.98,-18665.41"/>
</g>
<!-- kv_send0_10_11 -->
<g id="node366" class="node">
<title>kv_send0_10_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2713" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2713" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="2713" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_10_11&#45;&gt;kv_send0_10_11 -->
<g id="edge517" class="edge">
<title>ring_stage0_10_11&#45;&gt;kv_send0_10_11</title>
<path fill="none" stroke="black" d="M2727.11,-18605.07C2725.25,-18596.93 2723.17,-18587.79 2721.18,-18579.09"/>
<polygon fill="black" stroke="black" points="2724.55,-18578.12 2718.92,-18569.15 2717.73,-18579.68 2724.55,-18578.12"/>
</g>
<!-- ring_stage0_11_11 -->
<g id="node382" class="node">
<title>ring_stage0_11_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3043,-18568.68 2841,-18568.68 2841,-18515.68 3043,-18515.68 3043,-18568.68"/>
<text text-anchor="middle" x="2942" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2942" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_0×V_0</text>
<text text-anchor="middle" x="2942" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_10_11&#45;&gt;ring_stage0_11_11 -->
<g id="edge563" class="edge">
<title>ring_stage0_10_11&#45;&gt;ring_stage0_11_11</title>
<path fill="none" stroke="black" d="M2794.01,-18605.31C2818.27,-18595.13 2846.32,-18583.35 2871.44,-18572.8"/>
<polygon fill="black" stroke="black" points="2873.05,-18575.92 2880.91,-18568.83 2870.34,-18569.47 2873.05,-18575.92"/>
</g>
<!-- kv_send0_10_12 -->
<g id="node367" class="node">
<title>kv_send0_10_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2475" cy="-18452.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2475" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="2475" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_10_12&#45;&gt;kv_send0_10_12 -->
<g id="edge520" class="edge">
<title>ring_stage0_10_12&#45;&gt;kv_send0_10_12</title>
<path fill="none" stroke="black" d="M2481.35,-18515.33C2480.52,-18507.28 2479.6,-18498.25 2478.71,-18489.63"/>
<polygon fill="black" stroke="black" points="2482.17,-18489 2477.66,-18479.41 2475.2,-18489.71 2482.17,-18489"/>
</g>
<!-- ring_stage0_11_12 -->
<g id="node383" class="node">
<title>ring_stage0_11_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2805,-18478.94 2603,-18478.94 2603,-18425.94 2805,-18425.94 2805,-18478.94"/>
<text text-anchor="middle" x="2704" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2704" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_1×V_1</text>
<text text-anchor="middle" x="2704" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_10_12&#45;&gt;ring_stage0_11_12 -->
<g id="edge566" class="edge">
<title>ring_stage0_10_12&#45;&gt;ring_stage0_11_12</title>
<path fill="none" stroke="black" d="M2548.22,-18515.57C2573.87,-18505.34 2603.55,-18493.5 2630.08,-18482.92"/>
<polygon fill="black" stroke="black" points="2631.7,-18486.04 2639.7,-18479.09 2629.11,-18479.54 2631.7,-18486.04"/>
</g>
<!-- kv_send0_10_13 -->
<g id="node368" class="node">
<title>kv_send0_10_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2215" cy="-18362.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2215" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="2215" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_10_13&#45;&gt;kv_send0_10_13 -->
<g id="edge523" class="edge">
<title>ring_stage0_10_13&#45;&gt;kv_send0_10_13</title>
<path fill="none" stroke="black" d="M2222.76,-18425.59C2221.74,-18417.45 2220.59,-18408.31 2219.5,-18399.61"/>
<polygon fill="black" stroke="black" points="2222.97,-18399.16 2218.26,-18389.67 2216.03,-18400.03 2222.97,-18399.16"/>
</g>
<!-- ring_stage0_11_13 -->
<g id="node384" class="node">
<title>ring_stage0_11_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2565,-18389.2 2363,-18389.2 2363,-18336.2 2565,-18336.2 2565,-18389.2"/>
<text text-anchor="middle" x="2464" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2464" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_2×V_2</text>
<text text-anchor="middle" x="2464" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_10_13&#45;&gt;ring_stage0_11_13 -->
<g id="edge569" class="edge">
<title>ring_stage0_10_13&#45;&gt;ring_stage0_11_13</title>
<path fill="none" stroke="black" d="M2295.48,-18425.83C2323.46,-18415.51 2355.89,-18403.56 2384.78,-18392.9"/>
<polygon fill="black" stroke="black" points="2386.26,-18396.09 2394.43,-18389.35 2383.84,-18389.52 2386.26,-18396.09"/>
</g>
<!-- kv_send0_10_14 -->
<g id="node369" class="node">
<title>kv_send0_10_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1977" cy="-18272.96" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1977" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="1977" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_10_14&#45;&gt;kv_send0_10_14 -->
<g id="edge526" class="edge">
<title>ring_stage0_10_14&#45;&gt;kv_send0_10_14</title>
<path fill="none" stroke="black" d="M1983.35,-18335.85C1982.52,-18327.8 1981.6,-18318.77 1980.71,-18310.15"/>
<polygon fill="black" stroke="black" points="1984.17,-18309.52 1979.66,-18299.93 1977.2,-18310.23 1984.17,-18309.52"/>
</g>
<!-- ring_stage0_11_14 -->
<g id="node385" class="node">
<title>ring_stage0_11_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2307,-18299.46 2105,-18299.46 2105,-18246.46 2307,-18246.46 2307,-18299.46"/>
<text text-anchor="middle" x="2206" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="2206" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_3×V_3</text>
<text text-anchor="middle" x="2206" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_10_14&#45;&gt;ring_stage0_11_14 -->
<g id="edge572" class="edge">
<title>ring_stage0_10_14&#45;&gt;ring_stage0_11_14</title>
<path fill="none" stroke="black" d="M2050.22,-18336.09C2075.87,-18325.86 2105.55,-18314.02 2132.08,-18303.44"/>
<polygon fill="black" stroke="black" points="2133.7,-18306.56 2141.7,-18299.61 2131.11,-18300.06 2133.7,-18306.56"/>
</g>
<!-- kv_send0_10_15 -->
<g id="node370" class="node">
<title>kv_send0_10_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1291" cy="-18183.22" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1291" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1291" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_10_15&#45;&gt;kv_send0_10_15 -->
<g id="edge529" class="edge">
<title>ring_stage0_10_15&#45;&gt;kv_send0_10_15</title>
<path fill="none" stroke="black" d="M1454.56,-18246.35C1423.92,-18234.71 1387.79,-18220.98 1357.28,-18209.4"/>
<polygon fill="black" stroke="black" points="1358.18,-18206 1347.59,-18205.72 1355.7,-18212.54 1358.18,-18206"/>
</g>
<!-- ring_stage0_11_15 -->
<g id="node386" class="node">
<title>ring_stage0_11_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1838,-18209.72 1636,-18209.72 1636,-18156.72 1838,-18156.72 1838,-18209.72"/>
<text text-anchor="middle" x="1737" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="1737" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_4×V_4</text>
<text text-anchor="middle" x="1737" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_10_15&#45;&gt;ring_stage0_11_15 -->
<g id="edge575" class="edge">
<title>ring_stage0_10_15&#45;&gt;ring_stage0_11_15</title>
<path fill="none" stroke="black" d="M1584.76,-18246.35C1609.82,-18236.12 1638.83,-18224.28 1664.76,-18213.7"/>
<polygon fill="black" stroke="black" points="1666.22,-18216.89 1674.16,-18209.87 1663.58,-18210.4 1666.22,-18216.89"/>
</g>
<!-- kv_send0_10_0&#45;&gt;ring_stage0_11_1 -->
<g id="edge534" class="edge">
<title>kv_send0_10_0&#45;&gt;ring_stage0_11_1</title>
<path fill="none" stroke="black" d="M337,-18066.36C337,-18050.91 337,-18031.14 337,-18014.28"/>
<polygon fill="black" stroke="black" points="340.5,-18014.22 337,-18004.22 333.5,-18014.22 340.5,-18014.22"/>
</g>
<!-- kv_send0_10_1&#45;&gt;ring_stage0_11_2 -->
<g id="edge537" class="edge">
<title>kv_send0_10_1&#45;&gt;ring_stage0_11_2</title>
<path fill="none" stroke="black" d="M156.48,-17952.54C193,-17929.09 248.69,-17893.32 288.56,-17867.72"/>
<polygon fill="black" stroke="black" points="290.54,-17870.61 297.06,-17862.26 286.76,-17864.72 290.54,-17870.61"/>
</g>
<!-- kv_send0_10_2&#45;&gt;ring_stage0_11_3 -->
<g id="edge540" class="edge">
<title>kv_send0_10_2&#45;&gt;ring_stage0_11_3</title>
<path fill="none" stroke="black" d="M996.5,-17808.61C1002,-17786.6 1009.94,-17754.85 1016.04,-17730.44"/>
<polygon fill="black" stroke="black" points="1019.5,-17731.03 1018.53,-17720.48 1012.71,-17729.33 1019.5,-17731.03"/>
</g>
<!-- kv_send0_10_3&#45;&gt;ring_stage0_11_4 -->
<g id="edge543" class="edge">
<title>kv_send0_10_3&#45;&gt;ring_stage0_11_4</title>
<path fill="none" stroke="black" d="M1505.34,-17668.54C1542.69,-17645.09 1599.67,-17609.32 1640.45,-17583.72"/>
<polygon fill="black" stroke="black" points="1642.54,-17586.54 1649.15,-17578.26 1638.82,-17580.61 1642.54,-17586.54"/>
</g>
<!-- kv_send0_10_4&#45;&gt;ring_stage0_11_5 -->
<g id="edge546" class="edge">
<title>kv_send0_10_4&#45;&gt;ring_stage0_11_5</title>
<path fill="none" stroke="black" d="M2215,-17524.61C2215,-17502.7 2215,-17471.13 2215,-17446.76"/>
<polygon fill="black" stroke="black" points="2218.5,-17446.48 2215,-17436.48 2211.5,-17446.48 2218.5,-17446.48"/>
</g>
<!-- kv_send0_10_5&#45;&gt;ring_stage0_11_6 -->
<g id="edge549" class="edge">
<title>kv_send0_10_5&#45;&gt;ring_stage0_11_6</title>
<path fill="none" stroke="black" d="M2507.59,-17385.36C2527.64,-17375.68 2551.66,-17364.81 2574,-17356.61 2640.29,-17332.27 2716.47,-17311.01 2777.76,-17295.49"/>
<polygon fill="black" stroke="black" points="2778.62,-17298.89 2787.46,-17293.05 2776.91,-17292.1 2778.62,-17298.89"/>
</g>
<!-- kv_send0_10_6&#45;&gt;ring_stage0_11_7 -->
<g id="edge552" class="edge">
<title>kv_send0_10_6&#45;&gt;ring_stage0_11_7</title>
<path fill="none" stroke="black" d="M3571.87,-17240.61C3577.69,-17218.6 3586.08,-17186.85 3592.53,-17162.44"/>
<polygon fill="black" stroke="black" points="3595.99,-17163.04 3595.16,-17152.48 3589.23,-17161.25 3595.99,-17163.04"/>
</g>
<!-- kv_send0_10_7&#45;&gt;ring_stage0_11_8 -->
<g id="edge555" class="edge">
<title>kv_send0_10_7&#45;&gt;ring_stage0_11_8</title>
<path fill="none" stroke="black" d="M3672.7,-18873.82C3672.61,-18865.78 3672.51,-18856.8 3672.41,-18848.24"/>
<polygon fill="black" stroke="black" points="3675.91,-18848.06 3672.29,-18838.1 3668.91,-18848.14 3675.91,-18848.06"/>
</g>
<!-- kv_send0_10_8&#45;&gt;ring_stage0_11_9 -->
<g id="edge558" class="edge">
<title>kv_send0_10_8&#45;&gt;ring_stage0_11_9</title>
<path fill="none" stroke="black" d="M3440.7,-18784.08C3440.61,-18776.04 3440.51,-18767.06 3440.41,-18758.5"/>
<polygon fill="black" stroke="black" points="3443.91,-18758.32 3440.29,-18748.36 3436.91,-18758.4 3443.91,-18758.32"/>
</g>
<!-- kv_send0_10_9&#45;&gt;ring_stage0_11_10 -->
<g id="edge561" class="edge">
<title>kv_send0_10_9&#45;&gt;ring_stage0_11_10</title>
<path fill="none" stroke="black" d="M3201.4,-18694.34C3201.22,-18686.3 3201.01,-18677.32 3200.82,-18668.76"/>
<polygon fill="black" stroke="black" points="3204.31,-18668.54 3200.59,-18658.62 3197.31,-18668.7 3204.31,-18668.54"/>
</g>
<!-- kv_send0_10_10&#45;&gt;ring_stage0_11_11 -->
<g id="edge564" class="edge">
<title>kv_send0_10_10&#45;&gt;ring_stage0_11_11</title>
<path fill="none" stroke="black" d="M2956.11,-18605.07C2954.24,-18596.86 2952.13,-18587.63 2950.13,-18578.85"/>
<polygon fill="black" stroke="black" points="2953.49,-18577.82 2947.85,-18568.85 2946.66,-18579.37 2953.49,-18577.82"/>
</g>
<!-- kv_send0_10_11&#45;&gt;ring_stage0_11_12 -->
<g id="edge567" class="edge">
<title>kv_send0_10_11&#45;&gt;ring_stage0_11_12</title>
<path fill="none" stroke="black" d="M2710.3,-18514.86C2709.48,-18506.82 2708.55,-18497.84 2707.68,-18489.28"/>
<polygon fill="black" stroke="black" points="2711.14,-18488.73 2706.64,-18479.14 2704.18,-18489.45 2711.14,-18488.73"/>
</g>
<!-- kv_send0_10_12&#45;&gt;ring_stage0_11_13 -->
<g id="edge570" class="edge">
<title>kv_send0_10_12&#45;&gt;ring_stage0_11_13</title>
<path fill="none" stroke="black" d="M2471.7,-18425.12C2470.69,-18417.08 2469.57,-18408.1 2468.49,-18399.54"/>
<polygon fill="black" stroke="black" points="2471.94,-18398.89 2467.22,-18389.4 2464.99,-18399.76 2471.94,-18398.89"/>
</g>
<!-- kv_send0_10_13&#45;&gt;ring_stage0_11_14 -->
<g id="edge573" class="edge">
<title>kv_send0_10_13&#45;&gt;ring_stage0_11_14</title>
<path fill="none" stroke="black" d="M2212.3,-18335.38C2211.48,-18327.34 2210.55,-18318.36 2209.68,-18309.8"/>
<polygon fill="black" stroke="black" points="2213.14,-18309.25 2208.64,-18299.66 2206.18,-18309.97 2213.14,-18309.25"/>
</g>
<!-- kv_send0_10_14&#45;&gt;ring_stage0_11_15 -->
<g id="edge576" class="edge">
<title>kv_send0_10_14&#45;&gt;ring_stage0_11_15</title>
<path fill="none" stroke="black" d="M1917.67,-18250.27C1887.23,-18239.14 1849.71,-18225.42 1816.76,-18213.38"/>
<polygon fill="black" stroke="black" points="1817.75,-18210.01 1807.15,-18209.87 1815.34,-18216.59 1817.75,-18210.01"/>
</g>
<!-- kv_send0_10_15&#45;&gt;ring_stage0_11_0 -->
<g id="edge531" class="edge">
<title>kv_send0_10_15&#45;&gt;ring_stage0_11_0</title>
<path fill="none" stroke="black" d="M1223.82,-18162.64C1183.63,-18150.92 1131.86,-18135.83 1087.25,-18122.83"/>
<polygon fill="black" stroke="black" points="1088.14,-18119.44 1077.56,-18120 1086.18,-18126.16 1088.14,-18119.44"/>
</g>
<!-- kv_send0_11_0 -->
<g id="node387" class="node">
<title>kv_send0_11_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="990" cy="-17977.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="990" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="990" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_11_0&#45;&gt;kv_send0_11_0 -->
<g id="edge532" class="edge">
<title>ring_stage0_11_0&#45;&gt;kv_send0_11_0</title>
<path fill="none" stroke="black" d="M990,-18066.93C990,-18051.61 990,-18031.9 990,-18014.98"/>
<polygon fill="black" stroke="black" points="993.5,-18014.87 990,-18004.87 986.5,-18014.87 993.5,-18014.87"/>
</g>
<!-- ring_stage0_12_0 -->
<g id="node403" class="node">
<title>ring_stage0_12_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1304.5,-18004.11 1111.5,-18004.11 1111.5,-17951.11 1304.5,-17951.11 1304.5,-18004.11"/>
<text text-anchor="middle" x="1208" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="1208" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_4×V_4</text>
<text text-anchor="middle" x="1208" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_11_0&#45;&gt;ring_stage0_12_0 -->
<g id="edge578" class="edge">
<title>ring_stage0_11_0&#45;&gt;ring_stage0_12_0</title>
<path fill="none" stroke="black" d="M1038.92,-18066.93C1071.77,-18049.77 1115.19,-18027.09 1149.81,-18009.01"/>
<polygon fill="black" stroke="black" points="1151.62,-18012.01 1158.86,-18004.28 1148.38,-18005.8 1151.62,-18012.01"/>
</g>
<!-- kv_send0_11_1 -->
<g id="node388" class="node">
<title>kv_send0_11_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="119" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="119" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="119" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_11_1&#45;&gt;kv_send0_11_1 -->
<g id="edge535" class="edge">
<title>ring_stage0_11_1&#45;&gt;kv_send0_11_1</title>
<path fill="none" stroke="black" d="M297.27,-17951.1C260.05,-17927.19 204.43,-17891.47 165.23,-17866.3"/>
<polygon fill="black" stroke="black" points="166.94,-17863.24 156.64,-17860.78 163.16,-17869.13 166.94,-17863.24"/>
</g>
<!-- ring_stage0_12_1 -->
<g id="node404" class="node">
<title>ring_stage0_12_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="644.5,-17862.11 451.5,-17862.11 451.5,-17809.11 644.5,-17809.11 644.5,-17862.11"/>
<text text-anchor="middle" x="548" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="548" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_5×V_5</text>
<text text-anchor="middle" x="548" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_11_1&#45;&gt;ring_stage0_12_1 -->
<g id="edge581" class="edge">
<title>ring_stage0_11_1&#45;&gt;ring_stage0_12_1</title>
<path fill="none" stroke="black" d="M375.7,-17950.93C410.95,-17927.55 463.09,-17892.95 500.78,-17867.94"/>
<polygon fill="black" stroke="black" points="503.15,-17870.57 509.54,-17862.13 499.28,-17864.74 503.15,-17870.57"/>
</g>
<!-- kv_send0_11_2 -->
<g id="node389" class="node">
<title>kv_send0_11_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="337" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="337" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="337" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_11_2&#45;&gt;kv_send0_11_2 -->
<g id="edge538" class="edge">
<title>ring_stage0_11_2&#45;&gt;kv_send0_11_2</title>
<path fill="none" stroke="black" d="M337,-17808.93C337,-17786.97 337,-17755.11 337,-17730.6"/>
<polygon fill="black" stroke="black" points="340.5,-17730.6 337,-17720.6 333.5,-17730.6 340.5,-17730.6"/>
</g>
<!-- ring_stage0_12_2 -->
<g id="node405" class="node">
<title>ring_stage0_12_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="215.5,-17720.11 22.5,-17720.11 22.5,-17667.11 215.5,-17667.11 215.5,-17720.11"/>
<text text-anchor="middle" x="119" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="119" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_6×V_6</text>
<text text-anchor="middle" x="119" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_11_2&#45;&gt;ring_stage0_12_2 -->
<g id="edge584" class="edge">
<title>ring_stage0_11_2&#45;&gt;ring_stage0_12_2</title>
<path fill="none" stroke="black" d="M297.27,-17809.1C260.73,-17785.63 206.47,-17750.78 167.41,-17725.7"/>
<polygon fill="black" stroke="black" points="169.13,-17722.65 158.83,-17720.19 165.35,-17728.54 169.13,-17722.65"/>
</g>
<!-- kv_send0_11_3 -->
<g id="node390" class="node">
<title>kv_send0_11_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1465" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1465" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1465" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_11_3&#45;&gt;kv_send0_11_3 -->
<g id="edge541" class="edge">
<title>ring_stage0_11_3&#45;&gt;kv_send0_11_3</title>
<path fill="none" stroke="black" d="M1069.7,-17667.06C1088.16,-17657.47 1110.11,-17647.29 1131,-17640.61 1224.95,-17610.57 1255.59,-17633.17 1350,-17604.61 1370.73,-17598.34 1392.59,-17589.16 1411.62,-17580.25"/>
<polygon fill="black" stroke="black" points="1413.2,-17583.38 1420.72,-17575.92 1410.19,-17577.06 1413.2,-17583.38"/>
</g>
<!-- ring_stage0_12_3 -->
<g id="node406" class="node">
<title>ring_stage0_12_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1129.5,-17578.11 936.5,-17578.11 936.5,-17525.11 1129.5,-17525.11 1129.5,-17578.11"/>
<text text-anchor="middle" x="1033" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="1033" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_7×V_7</text>
<text text-anchor="middle" x="1033" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_11_3&#45;&gt;ring_stage0_12_3 -->
<g id="edge587" class="edge">
<title>ring_stage0_11_3&#45;&gt;ring_stage0_12_3</title>
<path fill="none" stroke="black" d="M1026.47,-17666.93C1027.73,-17644.83 1029.57,-17612.71 1030.97,-17588.14"/>
<polygon fill="black" stroke="black" points="1034.47,-17588.31 1031.54,-17578.13 1027.48,-17587.91 1034.47,-17588.31"/>
</g>
<!-- kv_send0_11_4 -->
<g id="node391" class="node">
<title>kv_send0_11_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1777" cy="-17409.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1777" y="-17413.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1777" y="-17398.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_11_4&#45;&gt;kv_send0_11_4 -->
<g id="edge544" class="edge">
<title>ring_stage0_11_4&#45;&gt;kv_send0_11_4</title>
<path fill="none" stroke="black" d="M1705.96,-17524.93C1719.85,-17502.58 1740.11,-17469.97 1755.44,-17445.3"/>
<polygon fill="black" stroke="black" points="1758.54,-17446.94 1760.85,-17436.6 1752.6,-17443.25 1758.54,-17446.94"/>
</g>
<!-- ring_stage0_12_4 -->
<g id="node407" class="node">
<title>ring_stage0_12_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1655.5,-17436.11 1462.5,-17436.11 1462.5,-17383.11 1655.5,-17383.11 1655.5,-17436.11"/>
<text text-anchor="middle" x="1559" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="1559" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_8×V_8</text>
<text text-anchor="middle" x="1559" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_11_4&#45;&gt;ring_stage0_12_4 -->
<g id="edge590" class="edge">
<title>ring_stage0_11_4&#45;&gt;ring_stage0_12_4</title>
<path fill="none" stroke="black" d="M1665.97,-17524.93C1644.55,-17502.04 1613.08,-17468.4 1589.81,-17443.54"/>
<polygon fill="black" stroke="black" points="1592.26,-17441.04 1582.88,-17436.13 1587.15,-17445.82 1592.26,-17441.04"/>
</g>
<!-- kv_send0_11_5 -->
<g id="node392" class="node">
<title>kv_send0_11_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2507" cy="-17267.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2507" y="-17271.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2507" y="-17256.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_11_5&#45;&gt;kv_send0_11_5 -->
<g id="edge547" class="edge">
<title>ring_stage0_11_5&#45;&gt;kv_send0_11_5</title>
<path fill="none" stroke="black" d="M2268.22,-17383.1C2319.58,-17358.47 2397.11,-17321.3 2449.78,-17296.04"/>
<polygon fill="black" stroke="black" points="2451.48,-17299.11 2458.99,-17291.63 2448.46,-17292.8 2451.48,-17299.11"/>
</g>
<!-- ring_stage0_12_5 -->
<g id="node408" class="node">
<title>ring_stage0_12_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2310.5,-17294.11 2117.5,-17294.11 2117.5,-17241.11 2310.5,-17241.11 2310.5,-17294.11"/>
<text text-anchor="middle" x="2214" y="-17278.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="2214" y="-17263.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_9×V_9</text>
<text text-anchor="middle" x="2214" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_11_5&#45;&gt;ring_stage0_12_5 -->
<g id="edge593" class="edge">
<title>ring_stage0_11_5&#45;&gt;ring_stage0_12_5</title>
<path fill="none" stroke="black" d="M2214.82,-17382.93C2214.66,-17360.83 2214.43,-17328.71 2214.25,-17304.14"/>
<polygon fill="black" stroke="black" points="2217.75,-17304.1 2214.18,-17294.13 2210.75,-17304.15 2217.75,-17304.1"/>
</g>
<!-- kv_send0_11_6 -->
<g id="node393" class="node">
<title>kv_send0_11_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3375" cy="-17125.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3375" y="-17129.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3375" y="-17114.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_11_6&#45;&gt;kv_send0_11_6 -->
<g id="edge550" class="edge">
<title>ring_stage0_11_6&#45;&gt;kv_send0_11_6</title>
<path fill="none" stroke="black" d="M2943.5,-17241.03C2963,-17231.84 2985.71,-17221.93 3007,-17214.61 3098.55,-17183.12 3206.66,-17158.72 3281.92,-17143.68"/>
<polygon fill="black" stroke="black" points="3282.72,-17147.09 3291.85,-17141.72 3281.36,-17140.23 3282.72,-17147.09"/>
</g>
<!-- ring_stage0_12_6 -->
<g id="node409" class="node">
<title>ring_stage0_12_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3038.5,-17152.11 2827.5,-17152.11 2827.5,-17099.11 3038.5,-17099.11 3038.5,-17152.11"/>
<text text-anchor="middle" x="2933" y="-17136.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="2933" y="-17121.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_10×V_10</text>
<text text-anchor="middle" x="2933" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_11_6&#45;&gt;ring_stage0_12_6 -->
<g id="edge596" class="edge">
<title>ring_stage0_11_6&#45;&gt;ring_stage0_12_6</title>
<path fill="none" stroke="black" d="M2900.34,-17240.93C2906.68,-17218.73 2915.91,-17186.42 2922.94,-17161.81"/>
<polygon fill="black" stroke="black" points="2926.33,-17162.7 2925.71,-17152.13 2919.6,-17160.78 2926.33,-17162.7"/>
</g>
<!-- kv_send0_11_7 -->
<g id="node394" class="node">
<title>kv_send0_11_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3605" cy="-16983.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3605" y="-16987.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3605" y="-16972.41" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_11_7&#45;&gt;kv_send0_11_7 -->
<g id="edge553" class="edge">
<title>ring_stage0_11_7&#45;&gt;kv_send0_11_7</title>
<path fill="none" stroke="black" d="M3602.55,-17098.93C3603.02,-17076.97 3603.7,-17045.11 3604.23,-17020.6"/>
<polygon fill="black" stroke="black" points="3607.73,-17020.67 3604.44,-17010.6 3600.73,-17020.52 3607.73,-17020.67"/>
</g>
<!-- ring_stage0_12_7 -->
<g id="node410" class="node">
<title>ring_stage0_12_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3483.5,-17010.11 3272.5,-17010.11 3272.5,-16957.11 3483.5,-16957.11 3483.5,-17010.11"/>
<text text-anchor="middle" x="3378" y="-16994.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="3378" y="-16979.91" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_11×V_11</text>
<text text-anchor="middle" x="3378" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_11_7&#45;&gt;ring_stage0_12_7 -->
<g id="edge599" class="edge">
<title>ring_stage0_11_7&#45;&gt;ring_stage0_12_7</title>
<path fill="none" stroke="black" d="M3561.18,-17099.1C3523.56,-17075.58 3467.64,-17040.64 3427.49,-17015.54"/>
<polygon fill="black" stroke="black" points="3429.26,-17012.52 3418.92,-17010.19 3425.55,-17018.45 3429.26,-17012.52"/>
</g>
<!-- kv_send0_11_8 -->
<g id="node395" class="node">
<title>kv_send0_11_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3671" cy="-18721.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3671" y="-18725.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3671" y="-18710.46" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_11_8&#45;&gt;kv_send0_11_8 -->
<g id="edge556" class="edge">
<title>ring_stage0_11_8&#45;&gt;kv_send0_11_8</title>
<path fill="none" stroke="black" d="M3671.71,-18784.55C3671.61,-18776.5 3671.51,-18767.47 3671.41,-18758.85"/>
<polygon fill="black" stroke="black" points="3674.91,-18758.59 3671.3,-18748.63 3667.91,-18758.67 3674.91,-18758.59"/>
</g>
<!-- ring_stage0_12_8 -->
<g id="node411" class="node">
<title>ring_stage0_12_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3780.5,-16868.11 3569.5,-16868.11 3569.5,-16815.11 3780.5,-16815.11 3780.5,-16868.11"/>
<text text-anchor="middle" x="3675" y="-16852.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="3675" y="-16837.91" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_12×V_12</text>
<text text-anchor="middle" x="3675" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_11_8&#45;&gt;ring_stage0_12_8 -->
<g id="edge602" class="edge">
<title>ring_stage0_11_8&#45;&gt;ring_stage0_12_8</title>
<path fill="none" stroke="black" d="M3740.72,-18784.79C3756.89,-18775.68 3772.46,-18763.78 3783,-18748.53 3801.91,-18721.17 3862.91,-18188.61 3871,-18156.35 3885.43,-18098.78 3905.85,-18089.09 3916,-18030.61 3934.85,-17922.01 3961,-17883.23 3916,-17782.61 3903.89,-17755.53 3729.11,-17631.69 3717,-17604.61 3717,-17604.61 3717,-16930.61 3717,-16930.61 3712.81,-16912.12 3704.25,-16892.96 3695.94,-16877.26"/>
<polygon fill="black" stroke="black" points="3698.99,-16875.53 3691.11,-16868.44 3692.85,-16878.9 3698.99,-16875.53"/>
</g>
<!-- kv_send0_11_9 -->
<g id="node396" class="node">
<title>kv_send0_11_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3438" cy="-18631.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3438" y="-18635.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="3438" y="-18620.72" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_11_9&#45;&gt;kv_send0_11_9 -->
<g id="edge559" class="edge">
<title>ring_stage0_11_9&#45;&gt;kv_send0_11_9</title>
<path fill="none" stroke="black" d="M3439.41,-18694.81C3439.23,-18686.76 3439.02,-18677.73 3438.82,-18669.11"/>
<polygon fill="black" stroke="black" points="3442.32,-18668.81 3438.59,-18658.89 3435.32,-18668.97 3442.32,-18668.81"/>
</g>
<!-- ring_stage0_12_9 -->
<g id="node412" class="node">
<title>ring_stage0_12_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3776.5,-18658.42 3565.5,-18658.42 3565.5,-18605.42 3776.5,-18605.42 3776.5,-18658.42"/>
<text text-anchor="middle" x="3671" y="-18643.22" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="3671" y="-18628.22" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_13×V_13</text>
<text text-anchor="middle" x="3671" y="-18613.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_11_9&#45;&gt;ring_stage0_12_9 -->
<g id="edge605" class="edge">
<title>ring_stage0_11_9&#45;&gt;ring_stage0_12_9</title>
<path fill="none" stroke="black" d="M3507.44,-18695.05C3534.6,-18684.73 3566.07,-18672.78 3594.11,-18662.12"/>
<polygon fill="black" stroke="black" points="3595.37,-18665.39 3603.48,-18658.57 3592.89,-18658.85 3595.37,-18665.39"/>
</g>
<!-- kv_send0_11_10 -->
<g id="node397" class="node">
<title>kv_send0_11_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3171" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3171" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="3171" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_11_10&#45;&gt;kv_send0_11_10 -->
<g id="edge562" class="edge">
<title>ring_stage0_11_10&#45;&gt;kv_send0_11_10</title>
<path fill="none" stroke="black" d="M3191.46,-18605.07C3188.74,-18596.84 3185.68,-18587.59 3182.77,-18578.8"/>
<polygon fill="black" stroke="black" points="3186.04,-18577.55 3179.58,-18569.15 3179.4,-18579.74 3186.04,-18577.55"/>
</g>
<!-- ring_stage0_12_10 -->
<g id="node413" class="node">
<title>ring_stage0_12_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3519,-18568.68 3299,-18568.68 3299,-18515.68 3519,-18515.68 3519,-18568.68"/>
<text text-anchor="middle" x="3409" y="-18553.48" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="3409" y="-18538.48" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_14×V_14</text>
<text text-anchor="middle" x="3409" y="-18523.48" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_11_10&#45;&gt;ring_stage0_12_10 -->
<g id="edge608" class="edge">
<title>ring_stage0_11_10&#45;&gt;ring_stage0_12_10</title>
<path fill="none" stroke="black" d="M3261.01,-18605.31C3285.27,-18595.13 3313.32,-18583.35 3338.44,-18572.8"/>
<polygon fill="black" stroke="black" points="3340.05,-18575.92 3347.91,-18568.83 3337.34,-18569.47 3340.05,-18575.92"/>
</g>
<!-- kv_send0_11_11 -->
<g id="node398" class="node">
<title>kv_send0_11_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2933" cy="-18452.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2933" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="2933" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_11_11&#45;&gt;kv_send0_11_11 -->
<g id="edge565" class="edge">
<title>ring_stage0_11_11&#45;&gt;kv_send0_11_11</title>
<path fill="none" stroke="black" d="M2939.35,-18515.33C2938.52,-18507.28 2937.6,-18498.25 2936.71,-18489.63"/>
<polygon fill="black" stroke="black" points="2940.17,-18489 2935.66,-18479.41 2933.2,-18489.71 2940.17,-18489"/>
</g>
<!-- ring_stage0_12_11 -->
<g id="node414" class="node">
<title>ring_stage0_12_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3281,-18478.94 3061,-18478.94 3061,-18425.94 3281,-18425.94 3281,-18478.94"/>
<text text-anchor="middle" x="3171" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="3171" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_15×V_15</text>
<text text-anchor="middle" x="3171" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_11_11&#45;&gt;ring_stage0_12_11 -->
<g id="edge611" class="edge">
<title>ring_stage0_11_11&#45;&gt;ring_stage0_12_11</title>
<path fill="none" stroke="black" d="M3008.85,-18515.57C3035.66,-18505.3 3066.71,-18493.4 3094.42,-18482.78"/>
<polygon fill="black" stroke="black" points="3095.98,-18485.93 3104.07,-18479.09 3093.47,-18479.4 3095.98,-18485.93"/>
</g>
<!-- kv_send0_11_12 -->
<g id="node399" class="node">
<title>kv_send0_11_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2693" cy="-18362.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2693" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="2693" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_11_12&#45;&gt;kv_send0_11_12 -->
<g id="edge568" class="edge">
<title>ring_stage0_11_12&#45;&gt;kv_send0_11_12</title>
<path fill="none" stroke="black" d="M2700.76,-18425.59C2699.74,-18417.45 2698.59,-18408.31 2697.5,-18399.61"/>
<polygon fill="black" stroke="black" points="2700.97,-18399.16 2696.26,-18389.67 2694.03,-18400.03 2700.97,-18399.16"/>
</g>
<!-- ring_stage0_12_12 -->
<g id="node415" class="node">
<title>ring_stage0_12_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3023,-18389.2 2821,-18389.2 2821,-18336.2 3023,-18336.2 3023,-18389.2"/>
<text text-anchor="middle" x="2922" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="2922" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_0×V_0</text>
<text text-anchor="middle" x="2922" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_11_12&#45;&gt;ring_stage0_12_12 -->
<g id="edge614" class="edge">
<title>ring_stage0_11_12&#45;&gt;ring_stage0_12_12</title>
<path fill="none" stroke="black" d="M2767.64,-18425.83C2793.05,-18415.6 2822.46,-18403.76 2848.75,-18393.18"/>
<polygon fill="black" stroke="black" points="2850.31,-18396.33 2858.28,-18389.35 2847.7,-18389.83 2850.31,-18396.33"/>
</g>
<!-- kv_send0_11_13 -->
<g id="node400" class="node">
<title>kv_send0_11_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2455" cy="-18272.96" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2455" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="2455" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_11_13&#45;&gt;kv_send0_11_13 -->
<g id="edge571" class="edge">
<title>ring_stage0_11_13&#45;&gt;kv_send0_11_13</title>
<path fill="none" stroke="black" d="M2461.35,-18335.85C2460.52,-18327.8 2459.6,-18318.77 2458.71,-18310.15"/>
<polygon fill="black" stroke="black" points="2462.17,-18309.52 2457.66,-18299.93 2455.2,-18310.23 2462.17,-18309.52"/>
</g>
<!-- ring_stage0_12_13 -->
<g id="node416" class="node">
<title>ring_stage0_12_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2785,-18299.46 2583,-18299.46 2583,-18246.46 2785,-18246.46 2785,-18299.46"/>
<text text-anchor="middle" x="2684" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="2684" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_1×V_1</text>
<text text-anchor="middle" x="2684" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_11_13&#45;&gt;ring_stage0_12_13 -->
<g id="edge617" class="edge">
<title>ring_stage0_11_13&#45;&gt;ring_stage0_12_13</title>
<path fill="none" stroke="black" d="M2528.22,-18336.09C2553.87,-18325.86 2583.55,-18314.02 2610.08,-18303.44"/>
<polygon fill="black" stroke="black" points="2611.7,-18306.56 2619.7,-18299.61 2609.11,-18300.06 2611.7,-18306.56"/>
</g>
<!-- kv_send0_11_14 -->
<g id="node401" class="node">
<title>kv_send0_11_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2195" cy="-18183.22" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2195" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="2195" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_11_14&#45;&gt;kv_send0_11_14 -->
<g id="edge574" class="edge">
<title>ring_stage0_11_14&#45;&gt;kv_send0_11_14</title>
<path fill="none" stroke="black" d="M2202.76,-18246.11C2201.74,-18237.97 2200.59,-18228.83 2199.5,-18220.13"/>
<polygon fill="black" stroke="black" points="2202.97,-18219.68 2198.26,-18210.19 2196.03,-18220.55 2202.97,-18219.68"/>
</g>
<!-- ring_stage0_12_14 -->
<g id="node417" class="node">
<title>ring_stage0_12_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2525,-18209.72 2323,-18209.72 2323,-18156.72 2525,-18156.72 2525,-18209.72"/>
<text text-anchor="middle" x="2424" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="2424" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_2×V_2</text>
<text text-anchor="middle" x="2424" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_11_14&#45;&gt;ring_stage0_12_14 -->
<g id="edge620" class="edge">
<title>ring_stage0_11_14&#45;&gt;ring_stage0_12_14</title>
<path fill="none" stroke="black" d="M2269.64,-18246.35C2295.05,-18236.12 2324.46,-18224.28 2350.75,-18213.7"/>
<polygon fill="black" stroke="black" points="2352.31,-18216.85 2360.28,-18209.87 2349.7,-18210.35 2352.31,-18216.85"/>
</g>
<!-- kv_send0_11_15 -->
<g id="node402" class="node">
<title>kv_send0_11_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1208" cy="-18093.48" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1208" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1208" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_11_15&#45;&gt;kv_send0_11_15 -->
<g id="edge577" class="edge">
<title>ring_stage0_11_15&#45;&gt;kv_send0_11_15</title>
<path fill="none" stroke="black" d="M1635.79,-18157.96C1632.83,-18157.4 1629.9,-18156.86 1627,-18156.35 1491.69,-18132.59 1455.36,-18143.85 1320,-18120.35 1310.49,-18118.7 1300.57,-18116.75 1290.74,-18114.67"/>
<polygon fill="black" stroke="black" points="1291.48,-18111.25 1280.96,-18112.56 1290,-18118.09 1291.48,-18111.25"/>
</g>
<!-- ring_stage0_12_15 -->
<g id="node418" class="node">
<title>ring_stage0_12_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1985,-18119.98 1783,-18119.98 1783,-18066.98 1985,-18066.98 1985,-18119.98"/>
<text text-anchor="middle" x="1884" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="1884" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_3×V_3</text>
<text text-anchor="middle" x="1884" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_11_15&#45;&gt;ring_stage0_12_15 -->
<g id="edge623" class="edge">
<title>ring_stage0_11_15&#45;&gt;ring_stage0_12_15</title>
<path fill="none" stroke="black" d="M1779.91,-18156.61C1796.3,-18146.83 1815.14,-18135.58 1832.26,-18125.36"/>
<polygon fill="black" stroke="black" points="1834.24,-18128.26 1841.03,-18120.13 1830.65,-18122.25 1834.24,-18128.26"/>
</g>
<!-- kv_send0_11_0&#45;&gt;ring_stage0_12_1 -->
<g id="edge582" class="edge">
<title>kv_send0_11_0&#45;&gt;ring_stage0_12_1</title>
<path fill="none" stroke="black" d="M946.69,-17953.1C926.35,-17942.95 901.47,-17931.79 878,-17924.61 781.58,-17895.1 750.1,-17919.15 654,-17888.61 636.53,-17883.06 618.32,-17875.04 602.03,-17866.95"/>
<polygon fill="black" stroke="black" points="603.18,-17863.61 592.68,-17862.2 600.01,-17869.85 603.18,-17863.61"/>
</g>
<!-- kv_send0_11_1&#45;&gt;ring_stage0_12_2 -->
<g id="edge585" class="edge">
<title>kv_send0_11_1&#45;&gt;ring_stage0_12_2</title>
<path fill="none" stroke="black" d="M119,-17808.61C119,-17786.7 119,-17755.13 119,-17730.76"/>
<polygon fill="black" stroke="black" points="122.5,-17730.48 119,-17720.48 115.5,-17730.48 122.5,-17730.48"/>
</g>
<!-- kv_send0_11_2&#45;&gt;ring_stage0_12_3 -->
<g id="edge588" class="edge">
<title>kv_send0_11_2&#45;&gt;ring_stage0_12_3</title>
<path fill="none" stroke="black" d="M378.47,-17669C399.03,-17658.44 424.62,-17646.96 449,-17640.61 655.16,-17586.89 721.43,-17660.54 927,-17604.61 945.44,-17599.59 964.51,-17591.33 981.3,-17582.86"/>
<polygon fill="black" stroke="black" points="983.12,-17585.86 990.38,-17578.15 979.89,-17579.65 983.12,-17585.86"/>
</g>
<!-- kv_send0_11_3&#45;&gt;ring_stage0_12_4 -->
<g id="edge591" class="edge">
<title>kv_send0_11_3&#45;&gt;ring_stage0_12_4</title>
<path fill="none" stroke="black" d="M1482.24,-17524.93C1497.41,-17502.34 1519.61,-17469.27 1536.24,-17444.51"/>
<polygon fill="black" stroke="black" points="1539.2,-17446.38 1541.87,-17436.13 1533.39,-17442.48 1539.2,-17446.38"/>
</g>
<!-- kv_send0_11_4&#45;&gt;ring_stage0_12_5 -->
<g id="edge594" class="edge">
<title>kv_send0_11_4&#45;&gt;ring_stage0_12_5</title>
<path fill="none" stroke="black" d="M1821.73,-17385.34C1842.14,-17375.43 1866.87,-17364.39 1890,-17356.61 1960.32,-17332.97 1981.4,-17340.03 2053,-17320.61 2078.28,-17313.75 2105.48,-17305.37 2130.19,-17297.34"/>
<polygon fill="black" stroke="black" points="2131.48,-17300.61 2139.9,-17294.17 2129.3,-17293.95 2131.48,-17300.61"/>
</g>
<!-- kv_send0_11_5&#45;&gt;ring_stage0_12_6 -->
<g id="edge597" class="edge">
<title>kv_send0_11_5&#45;&gt;ring_stage0_12_6</title>
<path fill="none" stroke="black" d="M2581.51,-17248.85C2645.13,-17232.91 2738.68,-17207.58 2818,-17178.61 2835.63,-17172.17 2854.33,-17164.22 2871.42,-17156.49"/>
<polygon fill="black" stroke="black" points="2873.09,-17159.58 2880.73,-17152.23 2870.18,-17153.21 2873.09,-17159.58"/>
</g>
<!-- kv_send0_11_6&#45;&gt;ring_stage0_12_7 -->
<g id="edge600" class="edge">
<title>kv_send0_11_6&#45;&gt;ring_stage0_12_7</title>
<path fill="none" stroke="black" d="M3375.56,-17098.61C3376.03,-17076.7 3376.7,-17045.13 3377.23,-17020.76"/>
<polygon fill="black" stroke="black" points="3380.73,-17020.55 3377.45,-17010.48 3373.73,-17020.4 3380.73,-17020.55"/>
</g>
<!-- kv_send0_11_7&#45;&gt;ring_stage0_12_8 -->
<g id="edge603" class="edge">
<title>kv_send0_11_7&#45;&gt;ring_stage0_12_8</title>
<path fill="none" stroke="black" d="M3617.84,-16956.93C3629.04,-16934.53 3645.38,-16901.85 3657.73,-16877.16"/>
<polygon fill="black" stroke="black" points="3660.9,-16878.64 3662.24,-16868.13 3654.64,-16875.5 3660.9,-16878.64"/>
</g>
<!-- kv_send0_11_8&#45;&gt;ring_stage0_12_9 -->
<g id="edge606" class="edge">
<title>kv_send0_11_8&#45;&gt;ring_stage0_12_9</title>
<path fill="none" stroke="black" d="M3671,-18694.34C3671,-18686.3 3671,-18677.32 3671,-18668.76"/>
<polygon fill="black" stroke="black" points="3674.5,-18668.62 3671,-18658.62 3667.5,-18668.62 3674.5,-18668.62"/>
</g>
<!-- kv_send0_11_9&#45;&gt;ring_stage0_12_10 -->
<g id="edge609" class="edge">
<title>kv_send0_11_9&#45;&gt;ring_stage0_12_10</title>
<path fill="none" stroke="black" d="M3429.46,-18605.07C3426.71,-18596.77 3423.62,-18587.43 3420.7,-18578.57"/>
<polygon fill="black" stroke="black" points="3423.94,-18577.24 3417.48,-18568.85 3417.3,-18579.44 3423.94,-18577.24"/>
</g>
<!-- kv_send0_11_10&#45;&gt;ring_stage0_12_11 -->
<g id="edge612" class="edge">
<title>kv_send0_11_10&#45;&gt;ring_stage0_12_11</title>
<path fill="none" stroke="black" d="M3171,-18514.86C3171,-18506.82 3171,-18497.84 3171,-18489.28"/>
<polygon fill="black" stroke="black" points="3174.5,-18489.14 3171,-18479.14 3167.5,-18489.14 3174.5,-18489.14"/>
</g>
<!-- kv_send0_11_11&#45;&gt;ring_stage0_12_12 -->
<g id="edge615" class="edge">
<title>kv_send0_11_11&#45;&gt;ring_stage0_12_12</title>
<path fill="none" stroke="black" d="M2929.7,-18425.12C2928.69,-18417.08 2927.57,-18408.1 2926.49,-18399.54"/>
<polygon fill="black" stroke="black" points="2929.94,-18398.89 2925.22,-18389.4 2922.99,-18399.76 2929.94,-18398.89"/>
</g>
<!-- kv_send0_11_12&#45;&gt;ring_stage0_12_13 -->
<g id="edge618" class="edge">
<title>kv_send0_11_12&#45;&gt;ring_stage0_12_13</title>
<path fill="none" stroke="black" d="M2690.3,-18335.38C2689.48,-18327.34 2688.55,-18318.36 2687.68,-18309.8"/>
<polygon fill="black" stroke="black" points="2691.14,-18309.25 2686.64,-18299.66 2684.18,-18309.97 2691.14,-18309.25"/>
</g>
<!-- kv_send0_11_13&#45;&gt;ring_stage0_12_14 -->
<g id="edge621" class="edge">
<title>kv_send0_11_13&#45;&gt;ring_stage0_12_14</title>
<path fill="none" stroke="black" d="M2445.87,-18246.11C2442.9,-18237.72 2439.56,-18228.27 2436.4,-18219.32"/>
<polygon fill="black" stroke="black" points="2439.7,-18218.15 2433.07,-18209.89 2433.1,-18220.48 2439.7,-18218.15"/>
</g>
<!-- kv_send0_11_14&#45;&gt;ring_stage0_12_15 -->
<g id="edge624" class="edge">
<title>kv_send0_11_14&#45;&gt;ring_stage0_12_15</title>
<path fill="none" stroke="black" d="M2124.82,-18162.42C2083.34,-18150.72 2030.13,-18135.71 1984.28,-18122.77"/>
<polygon fill="black" stroke="black" points="1985.19,-18119.39 1974.61,-18120.04 1983.29,-18126.13 1985.19,-18119.39"/>
</g>
<!-- kv_send0_11_15&#45;&gt;ring_stage0_12_0 -->
<g id="edge579" class="edge">
<title>kv_send0_11_15&#45;&gt;ring_stage0_12_0</title>
<path fill="none" stroke="black" d="M1208,-18066.36C1208,-18050.91 1208,-18031.14 1208,-18014.28"/>
<polygon fill="black" stroke="black" points="1211.5,-18014.22 1208,-18004.22 1204.5,-18014.22 1211.5,-18014.22"/>
</g>
<!-- kv_send0_12_0 -->
<g id="node419" class="node">
<title>kv_send0_12_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="766" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="766" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="766" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_12_0&#45;&gt;kv_send0_12_0 -->
<g id="edge580" class="edge">
<title>ring_stage0_12_0&#45;&gt;kv_send0_12_0</title>
<path fill="none" stroke="black" d="M1163.32,-17951.02C1144.85,-17941.43 1122.9,-17931.25 1102,-17924.61 1005.9,-17894.07 974.42,-17918.12 878,-17888.61 857.92,-17882.46 836.81,-17873.41 818.4,-17864.57"/>
<polygon fill="black" stroke="black" points="819.83,-17861.38 809.31,-17860.12 816.76,-17867.66 819.83,-17861.38"/>
</g>
<!-- ring_stage0_13_0 -->
<g id="node435" class="node">
<title>ring_stage0_13_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1740.5,-17862.11 1547.5,-17862.11 1547.5,-17809.11 1740.5,-17809.11 1740.5,-17862.11"/>
<text text-anchor="middle" x="1644" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="1644" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_3×V_3</text>
<text text-anchor="middle" x="1644" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_12_0&#45;&gt;ring_stage0_13_0 -->
<g id="edge626" class="edge">
<title>ring_stage0_12_0&#45;&gt;ring_stage0_13_0</title>
<path fill="none" stroke="black" d="M1252.68,-17951.02C1271.15,-17941.43 1293.1,-17931.25 1314,-17924.61 1410.1,-17894.07 1441.9,-17919.15 1538,-17888.61 1555.47,-17883.06 1573.68,-17875.04 1589.97,-17866.95"/>
<polygon fill="black" stroke="black" points="1591.99,-17869.85 1599.32,-17862.2 1588.82,-17863.61 1591.99,-17869.85"/>
</g>
<!-- kv_send0_12_1 -->
<g id="node420" class="node">
<title>kv_send0_12_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="561" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="561" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="561" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_12_1&#45;&gt;kv_send0_12_1 -->
<g id="edge583" class="edge">
<title>ring_stage0_12_1&#45;&gt;kv_send0_12_1</title>
<path fill="none" stroke="black" d="M550.38,-17808.93C552.42,-17786.97 555.38,-17755.11 557.66,-17730.6"/>
<polygon fill="black" stroke="black" points="561.15,-17730.88 558.59,-17720.6 554.18,-17730.23 561.15,-17730.88"/>
</g>
<!-- ring_stage0_13_1 -->
<g id="node436" class="node">
<title>ring_stage0_13_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="875.5,-17720.11 682.5,-17720.11 682.5,-17667.11 875.5,-17667.11 875.5,-17720.11"/>
<text text-anchor="middle" x="779" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="779" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_4×V_4</text>
<text text-anchor="middle" x="779" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_12_1&#45;&gt;ring_stage0_13_1 -->
<g id="edge629" class="edge">
<title>ring_stage0_12_1&#45;&gt;ring_stage0_13_1</title>
<path fill="none" stroke="black" d="M590.1,-17809.1C628.98,-17785.53 686.8,-17750.49 728.22,-17725.39"/>
<polygon fill="black" stroke="black" points="730.06,-17728.36 736.8,-17720.19 726.43,-17722.38 730.06,-17728.36"/>
</g>
<!-- kv_send0_12_2 -->
<g id="node421" class="node">
<title>kv_send0_12_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="815" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="815" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="815" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_12_2&#45;&gt;kv_send0_12_2 -->
<g id="edge586" class="edge">
<title>ring_stage0_12_2&#45;&gt;kv_send0_12_2</title>
<path fill="none" stroke="black" d="M161.62,-17667.07C180.41,-17657.06 203.14,-17646.56 225,-17640.61 430.57,-17584.68 496.84,-17658.33 703,-17604.61 723.95,-17599.15 745.8,-17589.91 764.57,-17580.72"/>
<polygon fill="black" stroke="black" points="766.16,-17583.84 773.53,-17576.22 763.02,-17577.58 766.16,-17583.84"/>
</g>
<!-- ring_stage0_13_2 -->
<g id="node437" class="node">
<title>ring_stage0_13_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="469.5,-17578.11 276.5,-17578.11 276.5,-17525.11 469.5,-17525.11 469.5,-17578.11"/>
<text text-anchor="middle" x="373" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="373" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_5×V_5</text>
<text text-anchor="middle" x="373" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_12_2&#45;&gt;ring_stage0_13_2 -->
<g id="edge632" class="edge">
<title>ring_stage0_12_2&#45;&gt;ring_stage0_13_2</title>
<path fill="none" stroke="black" d="M165.29,-17667.1C208.22,-17643.43 272.15,-17608.2 317.74,-17583.07"/>
<polygon fill="black" stroke="black" points="319.53,-17586.08 326.6,-17578.19 316.15,-17579.95 319.53,-17586.08"/>
</g>
<!-- kv_send0_12_3 -->
<g id="node422" class="node">
<title>kv_send0_12_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1339" cy="-17409.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1339" y="-17413.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1339" y="-17398.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_12_3&#45;&gt;kv_send0_12_3 -->
<g id="edge589" class="edge">
<title>ring_stage0_12_3&#45;&gt;kv_send0_12_3</title>
<path fill="none" stroke="black" d="M1083.37,-17525.09C1100.87,-17516.44 1120.69,-17506.88 1139,-17498.61 1177.14,-17481.39 1187.65,-17479.36 1226,-17462.61 1243.95,-17454.77 1263.37,-17445.96 1280.96,-17437.85"/>
<polygon fill="black" stroke="black" points="1282.91,-17440.8 1290.52,-17433.42 1279.97,-17434.44 1282.91,-17440.8"/>
</g>
<!-- ring_stage0_13_3 -->
<g id="node438" class="node">
<title>ring_stage0_13_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="970.5,-17436.11 777.5,-17436.11 777.5,-17383.11 970.5,-17383.11 970.5,-17436.11"/>
<text text-anchor="middle" x="874" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="874" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_6×V_6</text>
<text text-anchor="middle" x="874" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_12_3&#45;&gt;ring_stage0_13_3 -->
<g id="edge635" class="edge">
<title>ring_stage0_12_3&#45;&gt;ring_stage0_13_3</title>
<path fill="none" stroke="black" d="M1003.84,-17524.93C977.61,-17501.84 938.98,-17467.82 910.67,-17442.9"/>
<polygon fill="black" stroke="black" points="912.8,-17440.11 902.98,-17436.13 908.17,-17445.36 912.8,-17440.11"/>
</g>
<!-- kv_send0_12_4 -->
<g id="node423" class="node">
<title>kv_send0_12_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1941" cy="-17267.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1941" y="-17271.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1941" y="-17256.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_12_4&#45;&gt;kv_send0_12_4 -->
<g id="edge592" class="edge">
<title>ring_stage0_12_4&#45;&gt;kv_send0_12_4</title>
<path fill="none" stroke="black" d="M1607.4,-17383C1625.24,-17374.06 1645.79,-17364.33 1665,-17356.61 1730.04,-17330.46 1806.07,-17306.69 1861.85,-17290.47"/>
<polygon fill="black" stroke="black" points="1863.03,-17293.77 1871.67,-17287.64 1861.09,-17287.05 1863.03,-17293.77"/>
</g>
<!-- ring_stage0_13_4 -->
<g id="node439" class="node">
<title>ring_stage0_13_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1709.5,-17294.11 1516.5,-17294.11 1516.5,-17241.11 1709.5,-17241.11 1709.5,-17294.11"/>
<text text-anchor="middle" x="1613" y="-17278.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="1613" y="-17263.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_7×V_7</text>
<text text-anchor="middle" x="1613" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_12_4&#45;&gt;ring_stage0_13_4 -->
<g id="edge638" class="edge">
<title>ring_stage0_12_4&#45;&gt;ring_stage0_13_4</title>
<path fill="none" stroke="black" d="M1568.9,-17382.93C1577.51,-17360.63 1590.04,-17328.14 1599.55,-17303.49"/>
<polygon fill="black" stroke="black" points="1602.83,-17304.72 1603.16,-17294.13 1596.29,-17302.2 1602.83,-17304.72"/>
</g>
<!-- kv_send0_12_5 -->
<g id="node424" class="node">
<title>kv_send0_12_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2706" cy="-17125.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2706" y="-17129.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2706" y="-17114.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_12_5&#45;&gt;kv_send0_12_5 -->
<g id="edge595" class="edge">
<title>ring_stage0_12_5&#45;&gt;kv_send0_12_5</title>
<path fill="none" stroke="black" d="M2302.82,-17241.02C2332.16,-17232.58 2364.97,-17223.17 2395,-17214.61 2474.27,-17192.01 2564.96,-17166.37 2627.87,-17148.62"/>
<polygon fill="black" stroke="black" points="2629.05,-17151.93 2637.72,-17145.84 2627.15,-17145.19 2629.05,-17151.93"/>
</g>
<!-- ring_stage0_13_5 -->
<g id="node440" class="node">
<title>ring_stage0_13_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2308.5,-17152.11 2115.5,-17152.11 2115.5,-17099.11 2308.5,-17099.11 2308.5,-17152.11"/>
<text text-anchor="middle" x="2212" y="-17136.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="2212" y="-17121.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_8×V_8</text>
<text text-anchor="middle" x="2212" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_12_5&#45;&gt;ring_stage0_13_5 -->
<g id="edge641" class="edge">
<title>ring_stage0_12_5&#45;&gt;ring_stage0_13_5</title>
<path fill="none" stroke="black" d="M2213.63,-17240.93C2213.32,-17218.83 2212.86,-17186.71 2212.51,-17162.14"/>
<polygon fill="black" stroke="black" points="2216.01,-17162.07 2212.36,-17152.13 2209.01,-17162.17 2216.01,-17162.07"/>
</g>
<!-- kv_send0_12_6 -->
<g id="node425" class="node">
<title>kv_send0_12_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3033" cy="-16983.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3033" y="-16987.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="3033" y="-16972.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_12_6&#45;&gt;kv_send0_12_6 -->
<g id="edge598" class="edge">
<title>ring_stage0_12_6&#45;&gt;kv_send0_12_6</title>
<path fill="none" stroke="black" d="M2951.34,-17098.93C2967.48,-17076.34 2991.1,-17043.27 3008.79,-17018.51"/>
<polygon fill="black" stroke="black" points="3011.81,-17020.3 3014.77,-17010.13 3006.11,-17016.23 3011.81,-17020.3"/>
</g>
<!-- ring_stage0_13_6 -->
<g id="node441" class="node">
<title>ring_stage0_13_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2802.5,-17010.11 2609.5,-17010.11 2609.5,-16957.11 2802.5,-16957.11 2802.5,-17010.11"/>
<text text-anchor="middle" x="2706" y="-16994.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="2706" y="-16979.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_9×V_9</text>
<text text-anchor="middle" x="2706" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_12_6&#45;&gt;ring_stage0_13_6 -->
<g id="edge644" class="edge">
<title>ring_stage0_12_6&#45;&gt;ring_stage0_13_6</title>
<path fill="none" stroke="black" d="M2891.63,-17099.1C2853.5,-17075.58 2796.84,-17040.64 2756.15,-17015.54"/>
<polygon fill="black" stroke="black" points="2757.82,-17012.46 2747.47,-17010.19 2754.14,-17018.42 2757.82,-17012.46"/>
</g>
<!-- kv_send0_12_7 -->
<g id="node426" class="node">
<title>kv_send0_12_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3421" cy="-16841.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3421" y="-16845.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3421" y="-16830.41" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_12_7&#45;&gt;kv_send0_12_7 -->
<g id="edge601" class="edge">
<title>ring_stage0_12_7&#45;&gt;kv_send0_12_7</title>
<path fill="none" stroke="black" d="M3385.89,-16956.93C3392.66,-16934.87 3402.5,-16902.83 3410.05,-16878.28"/>
<polygon fill="black" stroke="black" points="3413.43,-16879.19 3413.02,-16868.6 3406.74,-16877.13 3413.43,-16879.19"/>
</g>
<!-- ring_stage0_13_7 -->
<g id="node442" class="node">
<title>ring_stage0_13_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3253.5,-16868.11 3042.5,-16868.11 3042.5,-16815.11 3253.5,-16815.11 3253.5,-16868.11"/>
<text text-anchor="middle" x="3148" y="-16852.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3148" y="-16837.91" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_10×V_10</text>
<text text-anchor="middle" x="3148" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_12_7&#45;&gt;ring_stage0_13_7 -->
<g id="edge647" class="edge">
<title>ring_stage0_12_7&#45;&gt;ring_stage0_13_7</title>
<path fill="none" stroke="black" d="M3336.08,-16957.1C3297.45,-16933.58 3240.04,-16898.64 3198.82,-16873.54"/>
<polygon fill="black" stroke="black" points="3200.38,-16870.4 3190.02,-16868.19 3196.74,-16876.38 3200.38,-16870.4"/>
</g>
<!-- kv_send0_12_8 -->
<g id="node427" class="node">
<title>kv_send0_12_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3619" cy="-16699.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3619" y="-16703.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3619" y="-16688.41" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_12_8&#45;&gt;kv_send0_12_8 -->
<g id="edge604" class="edge">
<title>ring_stage0_12_8&#45;&gt;kv_send0_12_8</title>
<path fill="none" stroke="black" d="M3664.73,-16814.93C3655.86,-16792.77 3642.97,-16760.54 3633.14,-16735.95"/>
<polygon fill="black" stroke="black" points="3636.36,-16734.58 3629.4,-16726.6 3629.86,-16737.18 3636.36,-16734.58"/>
</g>
<!-- ring_stage0_13_8 -->
<g id="node443" class="node">
<title>ring_stage0_13_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3951.5,-16726.11 3740.5,-16726.11 3740.5,-16673.11 3951.5,-16673.11 3951.5,-16726.11"/>
<text text-anchor="middle" x="3846" y="-16710.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3846" y="-16695.91" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_11×V_11</text>
<text text-anchor="middle" x="3846" y="-16680.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_12_8&#45;&gt;ring_stage0_13_8 -->
<g id="edge650" class="edge">
<title>ring_stage0_12_8&#45;&gt;ring_stage0_13_8</title>
<path fill="none" stroke="black" d="M3706.36,-16814.93C3734.69,-16791.74 3776.47,-16757.53 3806.95,-16732.58"/>
<polygon fill="black" stroke="black" points="3809.31,-16735.17 3814.83,-16726.13 3804.88,-16729.75 3809.31,-16735.17"/>
</g>
<!-- kv_send0_12_9 -->
<g id="node428" class="node">
<title>kv_send0_12_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3647" cy="-18542.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3647" y="-18545.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="3647" y="-18530.98" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_12_9&#45;&gt;kv_send0_12_9 -->
<g id="edge607" class="edge">
<title>ring_stage0_12_9&#45;&gt;kv_send0_12_9</title>
<path fill="none" stroke="black" d="M3663.93,-18605.07C3661.68,-18596.84 3659.15,-18587.59 3656.74,-18578.8"/>
<polygon fill="black" stroke="black" points="3660.12,-18577.87 3654.1,-18569.15 3653.37,-18579.72 3660.12,-18577.87"/>
</g>
<!-- ring_stage0_13_9 -->
<g id="node444" class="node">
<title>ring_stage0_13_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3496.5,-16584.11 3285.5,-16584.11 3285.5,-16531.11 3496.5,-16531.11 3496.5,-16584.11"/>
<text text-anchor="middle" x="3391" y="-16568.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3391" y="-16553.91" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_12×V_12</text>
<text text-anchor="middle" x="3391" y="-16538.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_12_9&#45;&gt;ring_stage0_13_9 -->
<g id="edge653" class="edge">
<title>ring_stage0_12_9&#45;&gt;ring_stage0_13_9</title>
<path fill="none" stroke="black" d="M3725.8,-18605.29C3740.84,-18595.84 3755.79,-18583.77 3766,-18569.05 3798.6,-18522.05 3856.05,-18119.43 3878,-18066.61 3885.29,-18049.08 3895.68,-18048.84 3901,-18030.61 3908.73,-18004.16 3918.11,-17804.21 3901,-17782.61 3857.63,-17727.85 3797.66,-17795.74 3748,-17746.61 3701.8,-17700.89 3723.8,-17668.71 3713,-17604.61 3698.55,-17518.78 3738.71,-17275.99 3677,-17214.61 3611.53,-17149.48 3325.41,-17246.68 3263,-17178.61 3231.16,-17143.88 3262.83,-17119.72 3263,-17072.61 3263.17,-17025.23 3261.25,-16688.71 3283,-16646.61 3294.91,-16623.57 3315.78,-16604.39 3336.03,-16589.88"/>
<polygon fill="black" stroke="black" points="3338.09,-16592.71 3344.34,-16584.15 3334.12,-16586.95 3338.09,-16592.71"/>
</g>
<!-- kv_send0_12_10 -->
<g id="node429" class="node">
<title>kv_send0_12_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3409" cy="-18452.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3409" y="-18456.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="3409" y="-18441.24" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_12_10&#45;&gt;kv_send0_12_10 -->
<g id="edge610" class="edge">
<title>ring_stage0_12_10&#45;&gt;kv_send0_12_10</title>
<path fill="none" stroke="black" d="M3409,-18515.33C3409,-18507.28 3409,-18498.25 3409,-18489.63"/>
<polygon fill="black" stroke="black" points="3412.5,-18489.41 3409,-18479.41 3405.5,-18489.41 3412.5,-18489.41"/>
</g>
<!-- ring_stage0_13_10 -->
<g id="node445" class="node">
<title>ring_stage0_13_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3757,-18478.94 3537,-18478.94 3537,-18425.94 3757,-18425.94 3757,-18478.94"/>
<text text-anchor="middle" x="3647" y="-18463.74" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3647" y="-18448.74" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_13×V_13</text>
<text text-anchor="middle" x="3647" y="-18433.74" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_12_10&#45;&gt;ring_stage0_13_10 -->
<g id="edge656" class="edge">
<title>ring_stage0_12_10&#45;&gt;ring_stage0_13_10</title>
<path fill="none" stroke="black" d="M3478.48,-18515.57C3506.46,-18505.25 3538.89,-18493.3 3567.78,-18482.64"/>
<polygon fill="black" stroke="black" points="3569.26,-18485.83 3577.43,-18479.09 3566.84,-18479.26 3569.26,-18485.83"/>
</g>
<!-- kv_send0_12_11 -->
<g id="node430" class="node">
<title>kv_send0_12_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3151" cy="-18362.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3151" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="3151" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_12_11&#45;&gt;kv_send0_12_11 -->
<g id="edge613" class="edge">
<title>ring_stage0_12_11&#45;&gt;kv_send0_12_11</title>
<path fill="none" stroke="black" d="M3165.11,-18425.59C3163.25,-18417.45 3161.17,-18408.31 3159.18,-18399.61"/>
<polygon fill="black" stroke="black" points="3162.55,-18398.64 3156.92,-18389.67 3155.73,-18400.2 3162.55,-18398.64"/>
</g>
<!-- ring_stage0_13_11 -->
<g id="node446" class="node">
<title>ring_stage0_13_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3499,-18389.2 3279,-18389.2 3279,-18336.2 3499,-18336.2 3499,-18389.2"/>
<text text-anchor="middle" x="3389" y="-18374" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3389" y="-18359" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_14×V_14</text>
<text text-anchor="middle" x="3389" y="-18344" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_12_11&#45;&gt;ring_stage0_13_11 -->
<g id="edge659" class="edge">
<title>ring_stage0_12_11&#45;&gt;ring_stage0_13_11</title>
<path fill="none" stroke="black" d="M3234.64,-18425.83C3260.05,-18415.6 3289.46,-18403.76 3315.75,-18393.18"/>
<polygon fill="black" stroke="black" points="3317.31,-18396.33 3325.28,-18389.35 3314.7,-18389.83 3317.31,-18396.33"/>
</g>
<!-- kv_send0_12_12 -->
<g id="node431" class="node">
<title>kv_send0_12_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2913" cy="-18272.96" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2913" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="2913" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_12_12&#45;&gt;kv_send0_12_12 -->
<g id="edge616" class="edge">
<title>ring_stage0_12_12&#45;&gt;kv_send0_12_12</title>
<path fill="none" stroke="black" d="M2919.35,-18335.85C2918.52,-18327.8 2917.6,-18318.77 2916.71,-18310.15"/>
<polygon fill="black" stroke="black" points="2920.17,-18309.52 2915.66,-18299.93 2913.2,-18310.23 2920.17,-18309.52"/>
</g>
<!-- ring_stage0_13_12 -->
<g id="node447" class="node">
<title>ring_stage0_13_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3261,-18299.46 3041,-18299.46 3041,-18246.46 3261,-18246.46 3261,-18299.46"/>
<text text-anchor="middle" x="3151" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="3151" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_15×V_15</text>
<text text-anchor="middle" x="3151" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_12_12&#45;&gt;ring_stage0_13_12 -->
<g id="edge662" class="edge">
<title>ring_stage0_12_12&#45;&gt;ring_stage0_13_12</title>
<path fill="none" stroke="black" d="M2988.85,-18336.09C3015.66,-18325.82 3046.71,-18313.92 3074.42,-18303.3"/>
<polygon fill="black" stroke="black" points="3075.98,-18306.45 3084.07,-18299.61 3073.47,-18299.92 3075.98,-18306.45"/>
</g>
<!-- kv_send0_12_13 -->
<g id="node432" class="node">
<title>kv_send0_12_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2653" cy="-18183.22" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2653" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="2653" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_12_13&#45;&gt;kv_send0_12_13 -->
<g id="edge619" class="edge">
<title>ring_stage0_12_13&#45;&gt;kv_send0_12_13</title>
<path fill="none" stroke="black" d="M2674.87,-18246.11C2671.96,-18237.88 2668.69,-18228.63 2665.59,-18219.84"/>
<polygon fill="black" stroke="black" points="2668.81,-18218.45 2662.18,-18210.19 2662.21,-18220.78 2668.81,-18218.45"/>
</g>
<!-- ring_stage0_13_13 -->
<g id="node448" class="node">
<title>ring_stage0_13_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2983,-18209.72 2781,-18209.72 2781,-18156.72 2983,-18156.72 2983,-18209.72"/>
<text text-anchor="middle" x="2882" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="2882" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_0×V_0</text>
<text text-anchor="middle" x="2882" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_12_13&#45;&gt;ring_stage0_13_13 -->
<g id="edge665" class="edge">
<title>ring_stage0_12_13&#45;&gt;ring_stage0_13_13</title>
<path fill="none" stroke="black" d="M2741.8,-18246.35C2764.68,-18236.21 2791.12,-18224.49 2814.84,-18213.98"/>
<polygon fill="black" stroke="black" points="2816.4,-18217.12 2824.13,-18209.87 2813.57,-18210.72 2816.4,-18217.12"/>
</g>
<!-- kv_send0_12_14 -->
<g id="node433" class="node">
<title>kv_send0_12_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2356" cy="-18093.48" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2356" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="2356" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_12_14&#45;&gt;kv_send0_12_14 -->
<g id="edge622" class="edge">
<title>ring_stage0_12_14&#45;&gt;kv_send0_12_14</title>
<path fill="none" stroke="black" d="M2403.97,-18156.37C2397.12,-18147.53 2389.35,-18137.52 2382.1,-18128.16"/>
<polygon fill="black" stroke="black" points="2384.78,-18125.91 2375.89,-18120.15 2379.25,-18130.19 2384.78,-18125.91"/>
</g>
<!-- ring_stage0_13_14 -->
<g id="node449" class="node">
<title>ring_stage0_13_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2696,-18119.98 2494,-18119.98 2494,-18066.98 2696,-18066.98 2696,-18119.98"/>
<text text-anchor="middle" x="2595" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="2595" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_1×V_1</text>
<text text-anchor="middle" x="2595" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_12_14&#45;&gt;ring_stage0_13_14 -->
<g id="edge668" class="edge">
<title>ring_stage0_12_14&#45;&gt;ring_stage0_13_14</title>
<path fill="none" stroke="black" d="M2473.92,-18156.61C2493.33,-18146.65 2515.71,-18135.17 2535.91,-18124.8"/>
<polygon fill="black" stroke="black" points="2537.72,-18127.81 2545.02,-18120.13 2534.52,-18121.58 2537.72,-18127.81"/>
</g>
<!-- kv_send0_12_15 -->
<g id="node434" class="node">
<title>kv_send0_12_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1879" cy="-17977.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1879" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="1879" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_12_15&#45;&gt;kv_send0_12_15 -->
<g id="edge625" class="edge">
<title>ring_stage0_12_15&#45;&gt;kv_send0_12_15</title>
<path fill="none" stroke="black" d="M1882.88,-18066.93C1882.21,-18051.61 1881.34,-18031.9 1880.6,-18014.98"/>
<polygon fill="black" stroke="black" points="1884.09,-18014.71 1880.15,-18004.87 1877.1,-18015.01 1884.09,-18014.71"/>
</g>
<!-- ring_stage0_13_15 -->
<g id="node450" class="node">
<title>ring_stage0_13_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2432,-18004.11 2230,-18004.11 2230,-17951.11 2432,-17951.11 2432,-18004.11"/>
<text text-anchor="middle" x="2331" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="2331" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_2×V_2</text>
<text text-anchor="middle" x="2331" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_12_15&#45;&gt;ring_stage0_13_15 -->
<g id="edge671" class="edge">
<title>ring_stage0_12_15&#45;&gt;ring_stage0_13_15</title>
<path fill="none" stroke="black" d="M1985.23,-18068.38C1988.19,-18067.77 1991.11,-18067.18 1994,-18066.61 2094.23,-18046.9 2123.4,-18060.74 2221,-18030.61 2239.22,-18024.98 2258.27,-18016.86 2275.3,-18008.7"/>
<polygon fill="black" stroke="black" points="2277.09,-18011.72 2284.53,-18004.18 2274.01,-18005.43 2277.09,-18011.72"/>
</g>
<!-- kv_send0_12_0&#45;&gt;ring_stage0_13_1 -->
<g id="edge630" class="edge">
<title>kv_send0_12_0&#45;&gt;ring_stage0_13_1</title>
<path fill="none" stroke="black" d="M768.41,-17808.61C770.46,-17786.6 773.41,-17754.85 775.67,-17730.44"/>
<polygon fill="black" stroke="black" points="779.16,-17730.76 776.6,-17720.48 772.19,-17730.11 779.16,-17730.76"/>
</g>
<!-- kv_send0_12_1&#45;&gt;ring_stage0_13_2 -->
<g id="edge633" class="edge">
<title>kv_send0_12_1&#45;&gt;ring_stage0_13_2</title>
<path fill="none" stroke="black" d="M527.82,-17667.9C496.63,-17644.67 449.77,-17609.78 415.78,-17584.47"/>
<polygon fill="black" stroke="black" points="417.55,-17581.42 407.44,-17578.25 413.37,-17587.03 417.55,-17581.42"/>
</g>
<!-- kv_send0_12_2&#45;&gt;ring_stage0_13_3 -->
<g id="edge636" class="edge">
<title>kv_send0_12_2&#45;&gt;ring_stage0_13_3</title>
<path fill="none" stroke="black" d="M825.96,-17524.61C835.31,-17502.41 848.85,-17470.28 859.18,-17445.79"/>
<polygon fill="black" stroke="black" points="862.44,-17447.05 863.1,-17436.48 855.99,-17444.33 862.44,-17447.05"/>
</g>
<!-- kv_send0_12_3&#45;&gt;ring_stage0_13_4 -->
<g id="edge639" class="edge">
<title>kv_send0_12_3&#45;&gt;ring_stage0_13_4</title>
<path fill="none" stroke="black" d="M1384.55,-17385.34C1430.83,-17361.69 1502.71,-17324.96 1553.47,-17299.03"/>
<polygon fill="black" stroke="black" points="1555.38,-17301.98 1562.69,-17294.32 1552.19,-17295.75 1555.38,-17301.98"/>
</g>
<!-- kv_send0_12_4&#45;&gt;ring_stage0_13_5 -->
<g id="edge642" class="edge">
<title>kv_send0_12_4&#45;&gt;ring_stage0_13_5</title>
<path fill="none" stroke="black" d="M1986.05,-17243.34C2031.82,-17219.69 2102.92,-17182.96 2153.12,-17157.03"/>
<polygon fill="black" stroke="black" points="2154.96,-17160.02 2162.24,-17152.32 2151.75,-17153.8 2154.96,-17160.02"/>
</g>
<!-- kv_send0_12_5&#45;&gt;ring_stage0_13_6 -->
<g id="edge645" class="edge">
<title>kv_send0_12_5&#45;&gt;ring_stage0_13_6</title>
<path fill="none" stroke="black" d="M2706,-17098.61C2706,-17076.7 2706,-17045.13 2706,-17020.76"/>
<polygon fill="black" stroke="black" points="2709.5,-17020.48 2706,-17010.48 2702.5,-17020.48 2709.5,-17020.48"/>
</g>
<!-- kv_send0_12_6&#45;&gt;ring_stage0_13_7 -->
<g id="edge648" class="edge">
<title>kv_send0_12_6&#45;&gt;ring_stage0_13_7</title>
<path fill="none" stroke="black" d="M3053.83,-16957.26C3072.52,-16934.5 3100.08,-16900.95 3120.56,-16876.02"/>
<polygon fill="black" stroke="black" points="3123.3,-16878.2 3126.94,-16868.25 3117.89,-16873.75 3123.3,-16878.2"/>
</g>
<!-- kv_send0_12_7&#45;&gt;ring_stage0_13_8 -->
<g id="edge651" class="edge">
<title>kv_send0_12_7&#45;&gt;ring_stage0_13_8</title>
<path fill="none" stroke="black" d="M3474.56,-16818.61C3500.39,-16808.55 3531.99,-16797.02 3561,-16788.61 3635.18,-16767.11 3657.61,-16776.66 3731,-16752.61 3749.36,-16746.59 3768.71,-16738.55 3786.2,-16730.6"/>
<polygon fill="black" stroke="black" points="3788.1,-16733.57 3795.7,-16726.2 3785.16,-16727.22 3788.1,-16733.57"/>
</g>
<!-- kv_send0_12_8&#45;&gt;ring_stage0_13_9 -->
<g id="edge654" class="edge">
<title>kv_send0_12_8&#45;&gt;ring_stage0_13_9</title>
<path fill="none" stroke="black" d="M3580.06,-16674.7C3541.83,-16651.23 3483.32,-16615.3 3441.52,-16589.63"/>
<polygon fill="black" stroke="black" points="3443.22,-16586.57 3432.87,-16584.32 3439.56,-16592.53 3443.22,-16586.57"/>
</g>
<!-- kv_send0_12_9&#45;&gt;ring_stage0_13_10 -->
<g id="edge657" class="edge">
<title>kv_send0_12_9&#45;&gt;ring_stage0_13_10</title>
<path fill="none" stroke="black" d="M3647,-18514.86C3647,-18506.82 3647,-18497.84 3647,-18489.28"/>
<polygon fill="black" stroke="black" points="3650.5,-18489.14 3647,-18479.14 3643.5,-18489.14 3650.5,-18489.14"/>
</g>
<!-- kv_send0_12_10&#45;&gt;ring_stage0_13_11 -->
<g id="edge660" class="edge">
<title>kv_send0_12_10&#45;&gt;ring_stage0_13_11</title>
<path fill="none" stroke="black" d="M3403.11,-18425.59C3401.24,-18417.38 3399.13,-18408.15 3397.13,-18399.37"/>
<polygon fill="black" stroke="black" points="3400.49,-18398.34 3394.85,-18389.37 3393.66,-18399.89 3400.49,-18398.34"/>
</g>
<!-- kv_send0_12_11&#45;&gt;ring_stage0_13_12 -->
<g id="edge663" class="edge">
<title>kv_send0_12_11&#45;&gt;ring_stage0_13_12</title>
<path fill="none" stroke="black" d="M3151,-18335.38C3151,-18327.34 3151,-18318.36 3151,-18309.8"/>
<polygon fill="black" stroke="black" points="3154.5,-18309.66 3151,-18299.66 3147.5,-18309.66 3154.5,-18309.66"/>
</g>
<!-- kv_send0_12_12&#45;&gt;ring_stage0_13_13 -->
<g id="edge666" class="edge">
<title>kv_send0_12_12&#45;&gt;ring_stage0_13_13</title>
<path fill="none" stroke="black" d="M2903.87,-18246.11C2900.9,-18237.72 2897.56,-18228.27 2894.4,-18219.32"/>
<polygon fill="black" stroke="black" points="2897.7,-18218.15 2891.07,-18209.89 2891.1,-18220.48 2897.7,-18218.15"/>
</g>
<!-- kv_send0_12_13&#45;&gt;ring_stage0_13_14 -->
<g id="edge669" class="edge">
<title>kv_send0_12_13&#45;&gt;ring_stage0_13_14</title>
<path fill="none" stroke="black" d="M2635.91,-18156.37C2630.19,-18147.71 2623.72,-18137.92 2617.64,-18128.73"/>
<polygon fill="black" stroke="black" points="2620.4,-18126.56 2611.97,-18120.15 2614.56,-18130.42 2620.4,-18126.56"/>
</g>
<!-- kv_send0_12_14&#45;&gt;ring_stage0_13_15 -->
<g id="edge672" class="edge">
<title>kv_send0_12_14&#45;&gt;ring_stage0_13_15</title>
<path fill="none" stroke="black" d="M2350.33,-18066.64C2346.94,-18051.21 2342.59,-18031.38 2338.87,-18014.45"/>
<polygon fill="black" stroke="black" points="2342.21,-18013.36 2336.65,-18004.35 2335.38,-18014.86 2342.21,-18013.36"/>
</g>
<!-- kv_send0_12_15&#45;&gt;ring_stage0_13_0 -->
<g id="edge627" class="edge">
<title>kv_send0_12_15&#45;&gt;ring_stage0_13_0</title>
<path fill="none" stroke="black" d="M1838.87,-17952.7C1799.38,-17929.18 1738.9,-17893.15 1695.8,-17867.47"/>
<polygon fill="black" stroke="black" points="1697.53,-17864.43 1687.15,-17862.32 1693.95,-17870.44 1697.53,-17864.43"/>
</g>
<!-- kv_send0_13_0 -->
<g id="node451" class="node">
<title>kv_send0_13_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1243" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1243" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="1243" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_13_0&#45;&gt;kv_send0_13_0 -->
<g id="edge628" class="edge">
<title>ring_stage0_13_0&#45;&gt;kv_send0_13_0</title>
<path fill="none" stroke="black" d="M1598.42,-17808.99C1580.1,-17799.56 1558.49,-17789.52 1538,-17782.61 1459.45,-17756.13 1433.83,-17772.25 1355,-17746.61 1335.21,-17740.17 1314.31,-17731.14 1296.01,-17722.4"/>
<polygon fill="black" stroke="black" points="1297.49,-17719.23 1286.97,-17718.01 1294.43,-17725.53 1297.49,-17719.23"/>
</g>
<!-- ring_stage0_14_0 -->
<g id="node467" class="node">
<title>ring_stage0_14_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2235.5,-17720.11 2042.5,-17720.11 2042.5,-17667.11 2235.5,-17667.11 2235.5,-17720.11"/>
<text text-anchor="middle" x="2139" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2139" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_2×V_2</text>
<text text-anchor="middle" x="2139" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_13_0&#45;&gt;ring_stage0_14_0 -->
<g id="edge674" class="edge">
<title>ring_stage0_13_0&#45;&gt;ring_stage0_14_0</title>
<path fill="none" stroke="black" d="M1687.8,-17809.08C1706.41,-17799.31 1728.7,-17789 1750,-17782.61 1871.45,-17746.2 1911.55,-17783.02 2033,-17746.61 2050.97,-17741.22 2069.65,-17733.04 2086.22,-17724.74"/>
<polygon fill="black" stroke="black" points="2087.9,-17727.82 2095.2,-17720.14 2084.7,-17721.59 2087.9,-17727.82"/>
</g>
<!-- kv_send0_13_1 -->
<g id="node452" class="node">
<title>kv_send0_13_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="591" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="591" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="591" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_13_1&#45;&gt;kv_send0_13_1 -->
<g id="edge631" class="edge">
<title>ring_stage0_13_1&#45;&gt;kv_send0_13_1</title>
<path fill="none" stroke="black" d="M744.52,-17666.93C712.86,-17643.35 665.89,-17608.38 632.25,-17583.33"/>
<polygon fill="black" stroke="black" points="634.11,-17580.35 624,-17577.19 629.93,-17585.97 634.11,-17580.35"/>
</g>
<!-- ring_stage0_14_1 -->
<g id="node468" class="node">
<title>ring_stage0_14_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1340.5,-17578.11 1147.5,-17578.11 1147.5,-17525.11 1340.5,-17525.11 1340.5,-17578.11"/>
<text text-anchor="middle" x="1244" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="1244" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_3×V_3</text>
<text text-anchor="middle" x="1244" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_13_1&#45;&gt;ring_stage0_14_1 -->
<g id="edge677" class="edge">
<title>ring_stage0_13_1&#45;&gt;ring_stage0_14_1</title>
<path fill="none" stroke="black" d="M839.85,-17667.09C864.13,-17657.68 892.56,-17647.61 919,-17640.61 1014.78,-17615.24 1044.68,-17634.93 1139,-17604.61 1156.32,-17599.04 1174.36,-17591.02 1190.49,-17582.93"/>
<polygon fill="black" stroke="black" points="1192.45,-17585.86 1199.76,-17578.18 1189.26,-17579.63 1192.45,-17585.86"/>
</g>
<!-- kv_send0_13_2 -->
<g id="node453" class="node">
<title>kv_send0_13_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="378" cy="-17409.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="378" y="-17413.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="378" y="-17398.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_13_2&#45;&gt;kv_send0_13_2 -->
<g id="edge634" class="edge">
<title>ring_stage0_13_2&#45;&gt;kv_send0_13_2</title>
<path fill="none" stroke="black" d="M373.92,-17524.93C374.7,-17502.97 375.84,-17471.11 376.71,-17446.6"/>
<polygon fill="black" stroke="black" points="380.21,-17446.72 377.07,-17436.6 373.22,-17446.47 380.21,-17446.72"/>
</g>
<!-- ring_stage0_14_2 -->
<g id="node469" class="node">
<title>ring_stage0_14_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="736.5,-17436.11 543.5,-17436.11 543.5,-17383.11 736.5,-17383.11 736.5,-17436.11"/>
<text text-anchor="middle" x="640" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="640" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_4×V_4</text>
<text text-anchor="middle" x="640" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_13_2&#45;&gt;ring_stage0_14_2 -->
<g id="edge680" class="edge">
<title>ring_stage0_13_2&#45;&gt;ring_stage0_14_2</title>
<path fill="none" stroke="black" d="M421.66,-17525.1C466.88,-17501.39 534.27,-17466.05 582.21,-17440.91"/>
<polygon fill="black" stroke="black" points="583.99,-17443.93 591.22,-17436.19 580.74,-17437.73 583.99,-17443.93"/>
</g>
<!-- kv_send0_13_3 -->
<g id="node454" class="node">
<title>kv_send0_13_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1392" cy="-17267.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1392" y="-17271.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1392" y="-17256.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_13_3&#45;&gt;kv_send0_13_3 -->
<g id="edge637" class="edge">
<title>ring_stage0_13_3&#45;&gt;kv_send0_13_3</title>
<path fill="none" stroke="black" d="M929.13,-17383.08C951.38,-17373.61 977.53,-17363.51 1002,-17356.61 1096.52,-17329.97 1124.35,-17342.87 1220,-17320.61 1253.45,-17312.83 1289.94,-17302.12 1320.66,-17292.45"/>
<polygon fill="black" stroke="black" points="1321.95,-17295.71 1330.43,-17289.35 1319.84,-17289.04 1321.95,-17295.71"/>
</g>
<!-- ring_stage0_14_3 -->
<g id="node470" class="node">
<title>ring_stage0_14_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="966.5,-17294.11 773.5,-17294.11 773.5,-17241.11 966.5,-17241.11 966.5,-17294.11"/>
<text text-anchor="middle" x="870" y="-17278.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="870" y="-17263.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_5×V_5</text>
<text text-anchor="middle" x="870" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_13_3&#45;&gt;ring_stage0_14_3 -->
<g id="edge683" class="edge">
<title>ring_stage0_13_3&#45;&gt;ring_stage0_14_3</title>
<path fill="none" stroke="black" d="M873.27,-17382.93C872.63,-17360.83 871.72,-17328.71 871.02,-17304.14"/>
<polygon fill="black" stroke="black" points="874.51,-17304.02 870.73,-17294.13 867.52,-17304.22 874.51,-17304.02"/>
</g>
<!-- kv_send0_13_4 -->
<g id="node455" class="node">
<title>kv_send0_13_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1994" cy="-17125.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1994" y="-17129.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1994" y="-17114.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_13_4&#45;&gt;kv_send0_13_4 -->
<g id="edge640" class="edge">
<title>ring_stage0_13_4&#45;&gt;kv_send0_13_4</title>
<path fill="none" stroke="black" d="M1683.75,-17241.08C1732.03,-17223.6 1797.43,-17199.84 1855,-17178.61 1878.58,-17169.91 1904.38,-17160.29 1927.28,-17151.71"/>
<polygon fill="black" stroke="black" points="1928.76,-17154.89 1936.9,-17148.11 1926.31,-17148.34 1928.76,-17154.89"/>
</g>
<!-- ring_stage0_14_4 -->
<g id="node471" class="node">
<title>ring_stage0_14_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1845.5,-17152.11 1652.5,-17152.11 1652.5,-17099.11 1845.5,-17099.11 1845.5,-17152.11"/>
<text text-anchor="middle" x="1749" y="-17136.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="1749" y="-17121.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_6×V_6</text>
<text text-anchor="middle" x="1749" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_13_4&#45;&gt;ring_stage0_14_4 -->
<g id="edge686" class="edge">
<title>ring_stage0_13_4&#45;&gt;ring_stage0_14_4</title>
<path fill="none" stroke="black" d="M1637.94,-17240.93C1660.18,-17218.04 1692.86,-17184.4 1717.01,-17159.54"/>
<polygon fill="black" stroke="black" points="1719.76,-17161.74 1724.21,-17152.13 1714.74,-17156.86 1719.76,-17161.74"/>
</g>
<!-- kv_send0_13_5 -->
<g id="node456" class="node">
<title>kv_send0_13_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2462" cy="-16983.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2462" y="-16987.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2462" y="-16972.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_13_5&#45;&gt;kv_send0_13_5 -->
<g id="edge643" class="edge">
<title>ring_stage0_13_5&#45;&gt;kv_send0_13_5</title>
<path fill="none" stroke="black" d="M2257.56,-17099.1C2300.87,-17074.84 2365.9,-17038.43 2410.94,-17013.21"/>
<polygon fill="black" stroke="black" points="2412.65,-17016.26 2419.67,-17008.32 2409.23,-17010.15 2412.65,-17016.26"/>
</g>
<!-- ring_stage0_14_5 -->
<g id="node472" class="node">
<title>ring_stage0_14_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2308.5,-17010.11 2115.5,-17010.11 2115.5,-16957.11 2308.5,-16957.11 2308.5,-17010.11"/>
<text text-anchor="middle" x="2212" y="-16994.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2212" y="-16979.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_7×V_7</text>
<text text-anchor="middle" x="2212" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_13_5&#45;&gt;ring_stage0_14_5 -->
<g id="edge689" class="edge">
<title>ring_stage0_13_5&#45;&gt;ring_stage0_14_5</title>
<path fill="none" stroke="black" d="M2212,-17098.93C2212,-17076.83 2212,-17044.71 2212,-17020.14"/>
<polygon fill="black" stroke="black" points="2215.5,-17020.13 2212,-17010.13 2208.5,-17020.13 2215.5,-17020.13"/>
</g>
<!-- kv_send0_13_6 -->
<g id="node457" class="node">
<title>kv_send0_13_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2921" cy="-16841.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2921" y="-16845.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2921" y="-16830.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_13_6&#45;&gt;kv_send0_13_6 -->
<g id="edge646" class="edge">
<title>ring_stage0_13_6&#45;&gt;kv_send0_13_6</title>
<path fill="none" stroke="black" d="M2745.43,-16956.93C2782.18,-16933.01 2836.94,-16897.35 2875.51,-16872.23"/>
<polygon fill="black" stroke="black" points="2877.5,-16875.11 2883.97,-16866.72 2873.68,-16869.25 2877.5,-16875.11"/>
</g>
<!-- ring_stage0_14_6 -->
<g id="node473" class="node">
<title>ring_stage0_14_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2799.5,-16868.11 2606.5,-16868.11 2606.5,-16815.11 2799.5,-16815.11 2799.5,-16868.11"/>
<text text-anchor="middle" x="2703" y="-16852.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2703" y="-16837.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_8×V_8</text>
<text text-anchor="middle" x="2703" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_13_6&#45;&gt;ring_stage0_14_6 -->
<g id="edge692" class="edge">
<title>ring_stage0_13_6&#45;&gt;ring_stage0_14_6</title>
<path fill="none" stroke="black" d="M2705.45,-16956.93C2704.98,-16934.83 2704.29,-16902.71 2703.76,-16878.14"/>
<polygon fill="black" stroke="black" points="2707.26,-16878.05 2703.55,-16868.13 2700.26,-16878.2 2707.26,-16878.05"/>
</g>
<!-- kv_send0_13_7 -->
<g id="node458" class="node">
<title>kv_send0_13_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3395" cy="-16699.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3395" y="-16703.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3395" y="-16688.41" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_13_7&#45;&gt;kv_send0_13_7 -->
<g id="edge649" class="edge">
<title>ring_stage0_13_7&#45;&gt;kv_send0_13_7</title>
<path fill="none" stroke="black" d="M3193.02,-16815.1C3235.71,-16790.89 3299.78,-16754.58 3344.27,-16729.36"/>
<polygon fill="black" stroke="black" points="3346.2,-16732.29 3353.17,-16724.32 3342.75,-16726.2 3346.2,-16732.29"/>
</g>
<!-- ring_stage0_14_7 -->
<g id="node474" class="node">
<title>ring_stage0_14_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3220.5,-16726.11 3027.5,-16726.11 3027.5,-16673.11 3220.5,-16673.11 3220.5,-16726.11"/>
<text text-anchor="middle" x="3124" y="-16710.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3124" y="-16695.91" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_9×V_9</text>
<text text-anchor="middle" x="3124" y="-16680.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_13_7&#45;&gt;ring_stage0_14_7 -->
<g id="edge695" class="edge">
<title>ring_stage0_13_7&#45;&gt;ring_stage0_14_7</title>
<path fill="none" stroke="black" d="M3143.6,-16814.93C3139.81,-16792.83 3134.3,-16760.71 3130.09,-16736.14"/>
<polygon fill="black" stroke="black" points="3133.51,-16735.39 3128.37,-16726.13 3126.61,-16736.57 3133.51,-16735.39"/>
</g>
<!-- kv_send0_13_8 -->
<g id="node459" class="node">
<title>kv_send0_13_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3847" cy="-16557.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3847" y="-16561.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3847" y="-16546.41" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_13_8&#45;&gt;kv_send0_13_8 -->
<g id="edge652" class="edge">
<title>ring_stage0_13_8&#45;&gt;kv_send0_13_8</title>
<path fill="none" stroke="black" d="M3846.18,-16672.93C3846.34,-16650.97 3846.57,-16619.11 3846.74,-16594.6"/>
<polygon fill="black" stroke="black" points="3850.24,-16594.62 3846.81,-16584.6 3843.24,-16594.57 3850.24,-16594.62"/>
</g>
<!-- ring_stage0_14_8 -->
<g id="node475" class="node">
<title>ring_stage0_14_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3725.5,-16584.11 3514.5,-16584.11 3514.5,-16531.11 3725.5,-16531.11 3725.5,-16584.11"/>
<text text-anchor="middle" x="3620" y="-16568.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3620" y="-16553.91" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_10×V_10</text>
<text text-anchor="middle" x="3620" y="-16538.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_13_8&#45;&gt;ring_stage0_14_8 -->
<g id="edge698" class="edge">
<title>ring_stage0_13_8&#45;&gt;ring_stage0_14_8</title>
<path fill="none" stroke="black" d="M3804.81,-16673.1C3766.85,-16649.58 3710.44,-16614.64 3669.93,-16589.54"/>
<polygon fill="black" stroke="black" points="3671.63,-16586.48 3661.29,-16584.19 3667.95,-16592.43 3671.63,-16586.48"/>
</g>
<!-- kv_send0_13_9 -->
<g id="node460" class="node">
<title>kv_send0_13_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2500" cy="-16415.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2500" y="-16419.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2500" y="-16404.41" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_13_9&#45;&gt;kv_send0_13_9 -->
<g id="edge655" class="edge">
<title>ring_stage0_13_9&#45;&gt;kv_send0_13_9</title>
<path fill="none" stroke="black" d="M3344.85,-16531.02C3324.38,-16520.93 3299.63,-16510.38 3276,-16504.61 2991.92,-16435.18 2903.51,-16536.23 2619,-16468.61 2596.66,-16463.3 2573.25,-16453.98 2553.17,-16444.69"/>
<polygon fill="black" stroke="black" points="2554.43,-16441.41 2543.89,-16440.29 2551.43,-16447.74 2554.43,-16441.41"/>
</g>
<!-- ring_stage0_14_9 -->
<g id="node476" class="node">
<title>ring_stage0_14_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3719.5,-16442.11 3508.5,-16442.11 3508.5,-16389.11 3719.5,-16389.11 3719.5,-16442.11"/>
<text text-anchor="middle" x="3614" y="-16426.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3614" y="-16411.91" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_11×V_11</text>
<text text-anchor="middle" x="3614" y="-16396.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_13_9&#45;&gt;ring_stage0_14_9 -->
<g id="edge701" class="edge">
<title>ring_stage0_13_9&#45;&gt;ring_stage0_14_9</title>
<path fill="none" stroke="black" d="M3431.64,-16531.1C3469.09,-16507.58 3524.76,-16472.64 3564.73,-16447.54"/>
<polygon fill="black" stroke="black" points="3566.65,-16450.47 3573.26,-16442.19 3562.93,-16444.54 3566.65,-16450.47"/>
</g>
<!-- kv_send0_13_10 -->
<g id="node461" class="node">
<title>kv_send0_13_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3627" cy="-18362.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3627" y="-18366.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="3627" y="-18351.5" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_13_10&#45;&gt;kv_send0_13_10 -->
<g id="edge658" class="edge">
<title>ring_stage0_13_10&#45;&gt;kv_send0_13_10</title>
<path fill="none" stroke="black" d="M3641.11,-18425.59C3639.25,-18417.45 3637.17,-18408.31 3635.18,-18399.61"/>
<polygon fill="black" stroke="black" points="3638.55,-18398.64 3632.92,-18389.67 3631.73,-18400.2 3638.55,-18398.64"/>
</g>
<!-- ring_stage0_14_10 -->
<g id="node477" class="node">
<title>ring_stage0_14_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2610,-16300.11 2390,-16300.11 2390,-16247.11 2610,-16247.11 2610,-16300.11"/>
<text text-anchor="middle" x="2500" y="-16284.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2500" y="-16269.91" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_12×V_12</text>
<text text-anchor="middle" x="2500" y="-16254.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_13_10&#45;&gt;ring_stage0_14_10 -->
<g id="edge704" class="edge">
<title>ring_stage0_13_10&#45;&gt;ring_stage0_14_10</title>
<path fill="none" stroke="black" d="M3707.43,-18425.81C3722.41,-18416.57 3736.79,-18404.61 3746,-18389.57 3772.92,-18345.58 3756,-18325.53 3756,-18273.96 3756,-18273.96 3756,-18273.96 3756,-18182.22 3756,-18129.14 3765.96,-18101.56 3726,-18066.61 3625.58,-17978.79 3516.5,-18130.44 3428,-18030.61 3396.75,-17995.36 3398.65,-17961.46 3428,-17924.61 3472.61,-17868.62 3535.87,-17940.68 3585,-17888.61 3623,-17848.34 3647,-17680.88 3609,-17640.61 3513.97,-17539.92 3082.03,-17705.3 2987,-17604.61 2954.66,-17570.35 2969.92,-17542.52 2987,-17498.61 2994.87,-17478.38 3012.13,-17482.84 3020,-17462.61 3037.08,-17418.7 3050.75,-17392.3 3020,-17356.61 2984.65,-17315.59 2828.84,-17341.77 2779,-17320.61 2731.3,-17300.36 2618.77,-17224.13 2594,-17178.61 2567.57,-17130.04 2611.16,-16971.55 2574,-16930.61 2513.01,-16863.41 2433.02,-16962.69 2373,-16894.61 2344.45,-16862.23 2363,-16743.78 2363,-16700.61 2363,-16700.61 2363,-16700.61 2363,-16556.61 2363,-16470.02 2338.48,-16438.04 2381,-16362.61 2394.31,-16339 2416.86,-16319.9 2438.77,-16305.61"/>
<polygon fill="black" stroke="black" points="2440.83,-16308.45 2447.44,-16300.17 2437.11,-16302.52 2440.83,-16308.45"/>
</g>
<!-- kv_send0_13_11 -->
<g id="node462" class="node">
<title>kv_send0_13_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3389" cy="-18272.96" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3389" y="-18276.76" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="3389" y="-18261.76" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_13_11&#45;&gt;kv_send0_13_11 -->
<g id="edge661" class="edge">
<title>ring_stage0_13_11&#45;&gt;kv_send0_13_11</title>
<path fill="none" stroke="black" d="M3389,-18335.85C3389,-18327.8 3389,-18318.77 3389,-18310.15"/>
<polygon fill="black" stroke="black" points="3392.5,-18309.93 3389,-18299.93 3385.5,-18309.93 3392.5,-18309.93"/>
</g>
<!-- ring_stage0_14_11 -->
<g id="node478" class="node">
<title>ring_stage0_14_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3737,-18299.46 3517,-18299.46 3517,-18246.46 3737,-18246.46 3737,-18299.46"/>
<text text-anchor="middle" x="3627" y="-18284.26" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3627" y="-18269.26" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_13×V_13</text>
<text text-anchor="middle" x="3627" y="-18254.26" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_13_11&#45;&gt;ring_stage0_14_11 -->
<g id="edge707" class="edge">
<title>ring_stage0_13_11&#45;&gt;ring_stage0_14_11</title>
<path fill="none" stroke="black" d="M3458.48,-18336.09C3486.46,-18325.77 3518.89,-18313.82 3547.78,-18303.16"/>
<polygon fill="black" stroke="black" points="3549.26,-18306.35 3557.43,-18299.61 3546.84,-18299.78 3549.26,-18306.35"/>
</g>
<!-- kv_send0_13_12 -->
<g id="node463" class="node">
<title>kv_send0_13_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3111" cy="-18183.22" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3111" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="3111" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_13_12&#45;&gt;kv_send0_13_12 -->
<g id="edge664" class="edge">
<title>ring_stage0_13_12&#45;&gt;kv_send0_13_12</title>
<path fill="none" stroke="black" d="M3139.22,-18246.11C3135.42,-18237.79 3131.16,-18228.43 3127.11,-18219.56"/>
<polygon fill="black" stroke="black" points="3130.17,-18217.84 3122.84,-18210.19 3123.8,-18220.74 3130.17,-18217.84"/>
</g>
<!-- ring_stage0_14_12 -->
<g id="node479" class="node">
<title>ring_stage0_14_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3459,-18209.72 3239,-18209.72 3239,-18156.72 3459,-18156.72 3459,-18209.72"/>
<text text-anchor="middle" x="3349" y="-18194.52" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3349" y="-18179.52" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_14×V_14</text>
<text text-anchor="middle" x="3349" y="-18164.52" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_13_12&#45;&gt;ring_stage0_14_12 -->
<g id="edge710" class="edge">
<title>ring_stage0_13_12&#45;&gt;ring_stage0_14_12</title>
<path fill="none" stroke="black" d="M3208.8,-18246.35C3231.68,-18236.21 3258.12,-18224.49 3281.84,-18213.98"/>
<polygon fill="black" stroke="black" points="3283.4,-18217.12 3291.13,-18209.87 3280.57,-18210.72 3283.4,-18217.12"/>
</g>
<!-- kv_send0_13_13 -->
<g id="node464" class="node">
<title>kv_send0_13_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2829" cy="-18093.48" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2829" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="2829" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_13_13&#45;&gt;kv_send0_13_13 -->
<g id="edge667" class="edge">
<title>ring_stage0_13_13&#45;&gt;kv_send0_13_13</title>
<path fill="none" stroke="black" d="M2866.38,-18156.37C2861.16,-18147.71 2855.24,-18137.92 2849.69,-18128.73"/>
<polygon fill="black" stroke="black" points="2852.67,-18126.9 2844.5,-18120.15 2846.68,-18130.52 2852.67,-18126.9"/>
</g>
<!-- ring_stage0_14_13 -->
<g id="node480" class="node">
<title>ring_stage0_14_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3182,-18119.98 2962,-18119.98 2962,-18066.98 3182,-18066.98 3182,-18119.98"/>
<text text-anchor="middle" x="3072" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="3072" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_15×V_15</text>
<text text-anchor="middle" x="3072" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_13_13&#45;&gt;ring_stage0_14_13 -->
<g id="edge713" class="edge">
<title>ring_stage0_13_13&#45;&gt;ring_stage0_14_13</title>
<path fill="none" stroke="black" d="M2937.47,-18156.61C2959.32,-18146.52 2984.57,-18134.85 3007.25,-18124.38"/>
<polygon fill="black" stroke="black" points="3008.85,-18127.5 3016.46,-18120.13 3005.92,-18121.14 3008.85,-18127.5"/>
</g>
<!-- kv_send0_13_14 -->
<g id="node465" class="node">
<title>kv_send0_13_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2560" cy="-17977.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2560" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="2560" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_13_14&#45;&gt;kv_send0_13_14 -->
<g id="edge670" class="edge">
<title>ring_stage0_13_14&#45;&gt;kv_send0_13_14</title>
<path fill="none" stroke="black" d="M2587.15,-18066.93C2582.36,-18051.36 2576.18,-18031.24 2570.92,-18014.14"/>
<polygon fill="black" stroke="black" points="2574.23,-18013 2567.95,-18004.47 2567.54,-18015.06 2574.23,-18013"/>
</g>
<!-- ring_stage0_14_14 -->
<g id="node481" class="node">
<title>ring_stage0_14_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2890,-18004.11 2688,-18004.11 2688,-17951.11 2890,-17951.11 2890,-18004.11"/>
<text text-anchor="middle" x="2789" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2789" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_0×V_0</text>
<text text-anchor="middle" x="2789" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_13_14&#45;&gt;ring_stage0_14_14 -->
<g id="edge716" class="edge">
<title>ring_stage0_13_14&#45;&gt;ring_stage0_14_14</title>
<path fill="none" stroke="black" d="M2638.54,-18066.93C2667.52,-18049.92 2705.75,-18027.47 2736.43,-18009.47"/>
<polygon fill="black" stroke="black" points="2738.42,-18012.36 2745.27,-18004.28 2734.88,-18006.32 2738.42,-18012.36"/>
</g>
<!-- kv_send0_13_15 -->
<g id="node466" class="node">
<title>kv_send0_13_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2315" cy="-17835.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2315" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="2315" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_13_15&#45;&gt;kv_send0_13_15 -->
<g id="edge673" class="edge">
<title>ring_stage0_13_15&#45;&gt;kv_send0_13_15</title>
<path fill="none" stroke="black" d="M2328.07,-17950.93C2325.56,-17928.97 2321.91,-17897.11 2319.11,-17872.6"/>
<polygon fill="black" stroke="black" points="2322.58,-17872.14 2317.97,-17862.6 2315.63,-17872.93 2322.58,-17872.14"/>
</g>
<!-- ring_stage0_14_15 -->
<g id="node482" class="node">
<title>ring_stage0_14_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2638,-17862.11 2436,-17862.11 2436,-17809.11 2638,-17809.11 2638,-17862.11"/>
<text text-anchor="middle" x="2537" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="2537" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_1×V_1</text>
<text text-anchor="middle" x="2537" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_13_15&#45;&gt;ring_stage0_14_15 -->
<g id="edge719" class="edge">
<title>ring_stage0_13_15&#45;&gt;ring_stage0_14_15</title>
<path fill="none" stroke="black" d="M2368.78,-17950.93C2403.19,-17927.55 2454.1,-17892.95 2490.89,-17867.94"/>
<polygon fill="black" stroke="black" points="2493.15,-17870.64 2499.46,-17862.13 2489.22,-17864.85 2493.15,-17870.64"/>
</g>
<!-- kv_send0_13_0&#45;&gt;ring_stage0_14_1 -->
<g id="edge678" class="edge">
<title>kv_send0_13_0&#45;&gt;ring_stage0_14_1</title>
<path fill="none" stroke="black" d="M1243.19,-17666.61C1243.34,-17644.7 1243.57,-17613.13 1243.74,-17588.76"/>
<polygon fill="black" stroke="black" points="1247.24,-17588.5 1243.82,-17578.48 1240.24,-17588.45 1247.24,-17588.5"/>
</g>
<!-- kv_send0_13_1&#45;&gt;ring_stage0_14_2 -->
<g id="edge681" class="edge">
<title>kv_send0_13_1&#45;&gt;ring_stage0_14_2</title>
<path fill="none" stroke="black" d="M600.1,-17524.61C607.84,-17502.5 619.02,-17470.56 627.57,-17446.11"/>
<polygon fill="black" stroke="black" points="630.95,-17447.07 630.95,-17436.48 624.34,-17444.76 630.95,-17447.07"/>
</g>
<!-- kv_send0_13_2&#45;&gt;ring_stage0_14_3 -->
<g id="edge684" class="edge">
<title>kv_send0_13_2&#45;&gt;ring_stage0_14_3</title>
<path fill="none" stroke="black" d="M435.14,-17387.13C464.38,-17376.76 500.74,-17364.82 534,-17356.61 630.19,-17332.87 659.11,-17349.11 754,-17320.61 773.17,-17314.85 793.31,-17306.65 811.34,-17298.45"/>
<polygon fill="black" stroke="black" points="812.95,-17301.56 820.56,-17294.18 810.01,-17295.21 812.95,-17301.56"/>
</g>
<!-- kv_send0_13_3&#45;&gt;ring_stage0_14_4 -->
<g id="edge687" class="edge">
<title>kv_send0_13_3&#45;&gt;ring_stage0_14_4</title>
<path fill="none" stroke="black" d="M1440.09,-17243.79C1460.8,-17234.3 1485.39,-17223.46 1508,-17214.61 1554.73,-17196.33 1567.82,-17195.69 1615,-17178.61 1634.66,-17171.49 1655.81,-17163.46 1675.36,-17155.88"/>
<polygon fill="black" stroke="black" points="1676.76,-17159.09 1684.81,-17152.2 1674.23,-17152.57 1676.76,-17159.09"/>
</g>
<!-- kv_send0_13_4&#45;&gt;ring_stage0_14_5 -->
<g id="edge690" class="edge">
<title>kv_send0_13_4&#45;&gt;ring_stage0_14_5</title>
<path fill="none" stroke="black" d="M2031.48,-17100.54C2068,-17077.09 2123.69,-17041.32 2163.56,-17015.72"/>
<polygon fill="black" stroke="black" points="2165.54,-17018.61 2172.06,-17010.26 2161.76,-17012.72 2165.54,-17018.61"/>
</g>
<!-- kv_send0_13_5&#45;&gt;ring_stage0_14_6 -->
<g id="edge693" class="edge">
<title>kv_send0_13_5&#45;&gt;ring_stage0_14_6</title>
<path fill="none" stroke="black" d="M2502.88,-16958.86C2543.46,-16935.29 2605.85,-16899.05 2650.17,-16873.3"/>
<polygon fill="black" stroke="black" points="2652.17,-16876.19 2659.06,-16868.14 2648.65,-16870.13 2652.17,-16876.19"/>
</g>
<!-- kv_send0_13_6&#45;&gt;ring_stage0_14_7 -->
<g id="edge696" class="edge">
<title>kv_send0_13_6&#45;&gt;ring_stage0_14_7</title>
<path fill="none" stroke="black" d="M2956.36,-16816.22C2990.22,-16792.87 3041.48,-16757.52 3078.4,-16732.06"/>
<polygon fill="black" stroke="black" points="3080.74,-16734.69 3086.99,-16726.14 3076.77,-16728.93 3080.74,-16734.69"/>
</g>
<!-- kv_send0_13_7&#45;&gt;ring_stage0_14_8 -->
<g id="edge699" class="edge">
<title>kv_send0_13_7&#45;&gt;ring_stage0_14_8</title>
<path fill="none" stroke="black" d="M3433.68,-16674.54C3471.45,-16651.04 3529.1,-16615.17 3570.26,-16589.56"/>
<polygon fill="black" stroke="black" points="3572.14,-16592.51 3578.78,-16584.26 3568.44,-16586.57 3572.14,-16592.51"/>
</g>
<!-- kv_send0_13_8&#45;&gt;ring_stage0_14_9 -->
<g id="edge702" class="edge">
<title>kv_send0_13_8&#45;&gt;ring_stage0_14_9</title>
<path fill="none" stroke="black" d="M3807.21,-16532.7C3768.06,-16509.18 3708.09,-16473.15 3665.36,-16447.47"/>
<polygon fill="black" stroke="black" points="3667.16,-16444.47 3656.78,-16442.32 3663.55,-16450.47 3667.16,-16444.47"/>
</g>
<!-- kv_send0_13_9&#45;&gt;ring_stage0_14_10 -->
<g id="edge705" class="edge">
<title>kv_send0_13_9&#45;&gt;ring_stage0_14_10</title>
<path fill="none" stroke="black" d="M2500,-16388.61C2500,-16366.7 2500,-16335.13 2500,-16310.76"/>
<polygon fill="black" stroke="black" points="2503.5,-16310.48 2500,-16300.48 2496.5,-16310.48 2503.5,-16310.48"/>
</g>
<!-- kv_send0_13_10&#45;&gt;ring_stage0_14_11 -->
<g id="edge708" class="edge">
<title>kv_send0_13_10&#45;&gt;ring_stage0_14_11</title>
<path fill="none" stroke="black" d="M3627,-18335.38C3627,-18327.34 3627,-18318.36 3627,-18309.8"/>
<polygon fill="black" stroke="black" points="3630.5,-18309.66 3627,-18299.66 3623.5,-18309.66 3630.5,-18309.66"/>
</g>
<!-- kv_send0_13_11&#45;&gt;ring_stage0_14_12 -->
<g id="edge711" class="edge">
<title>kv_send0_13_11&#45;&gt;ring_stage0_14_12</title>
<path fill="none" stroke="black" d="M3377.22,-18246.11C3373.35,-18237.63 3368.99,-18228.07 3364.87,-18219.04"/>
<polygon fill="black" stroke="black" points="3368.03,-18217.53 3360.7,-18209.89 3361.66,-18220.44 3368.03,-18217.53"/>
</g>
<!-- kv_send0_13_12&#45;&gt;ring_stage0_14_13 -->
<g id="edge714" class="edge">
<title>kv_send0_13_12&#45;&gt;ring_stage0_14_13</title>
<path fill="none" stroke="black" d="M3099.51,-18156.37C3095.74,-18147.89 3091.49,-18138.33 3087.47,-18129.3"/>
<polygon fill="black" stroke="black" points="3090.67,-18127.86 3083.41,-18120.15 3084.27,-18130.71 3090.67,-18127.86"/>
</g>
<!-- kv_send0_13_13&#45;&gt;ring_stage0_14_14 -->
<g id="edge717" class="edge">
<title>kv_send0_13_13&#45;&gt;ring_stage0_14_14</title>
<path fill="none" stroke="black" d="M2819.92,-18066.64C2814.45,-18051.06 2807.41,-18031 2801.42,-18013.97"/>
<polygon fill="black" stroke="black" points="2804.66,-18012.62 2798.04,-18004.35 2798.05,-18014.94 2804.66,-18012.62"/>
</g>
<!-- kv_send0_13_14&#45;&gt;ring_stage0_14_15 -->
<g id="edge720" class="edge">
<title>kv_send0_13_14&#45;&gt;ring_stage0_14_15</title>
<path fill="none" stroke="black" d="M2555.73,-17950.61C2552.11,-17928.6 2546.9,-17896.85 2542.89,-17872.44"/>
<polygon fill="black" stroke="black" points="2546.32,-17871.78 2541.25,-17862.48 2539.42,-17872.91 2546.32,-17871.78"/>
</g>
<!-- kv_send0_13_15&#45;&gt;ring_stage0_14_0 -->
<g id="edge675" class="edge">
<title>kv_send0_13_15&#45;&gt;ring_stage0_14_0</title>
<path fill="none" stroke="black" d="M2283.94,-17809.9C2254.86,-17786.77 2211.25,-17752.08 2179.46,-17726.79"/>
<polygon fill="black" stroke="black" points="2181.24,-17723.74 2171.24,-17720.25 2176.88,-17729.22 2181.24,-17723.74"/>
</g>
<!-- kv_send0_14_0 -->
<g id="node483" class="node">
<title>kv_send0_14_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1991" cy="-17551.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1991" y="-17555.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="1991" y="-17540.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage0_14_0&#45;&gt;kv_send0_14_0 -->
<g id="edge676" class="edge">
<title>ring_stage0_14_0&#45;&gt;kv_send0_14_0</title>
<path fill="none" stroke="black" d="M2111.85,-17666.93C2087.4,-17643.8 2051.34,-17609.69 2024.98,-17584.75"/>
<polygon fill="black" stroke="black" points="2027.15,-17581.98 2017.48,-17577.65 2022.33,-17587.07 2027.15,-17581.98"/>
</g>
<!-- ring_stage0_15_0 -->
<g id="node499" class="node">
<title>ring_stage0_15_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2758.5,-17578.11 2565.5,-17578.11 2565.5,-17525.11 2758.5,-17525.11 2758.5,-17578.11"/>
<text text-anchor="middle" x="2662" y="-17562.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2662" y="-17547.91" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_1×V_1</text>
<text text-anchor="middle" x="2662" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_14_0&#45;&gt;ring_stage0_15_0 -->
<g id="edge722" class="edge">
<title>ring_stage0_14_0&#45;&gt;ring_stage0_15_0</title>
<path fill="none" stroke="black" d="M2182.51,-17667.09C2201.16,-17657.26 2223.56,-17646.9 2245,-17640.61 2378.94,-17601.3 2423.14,-17644.17 2557,-17604.61 2574.94,-17599.31 2593.54,-17591.1 2610.02,-17582.77"/>
<polygon fill="black" stroke="black" points="2611.67,-17585.85 2618.93,-17578.14 2608.44,-17579.64 2611.67,-17585.85"/>
</g>
<!-- kv_send0_14_1 -->
<g id="node484" class="node">
<title>kv_send0_14_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1114" cy="-17409.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1114" y="-17413.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="1114" y="-17398.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage0_14_1&#45;&gt;kv_send0_14_1 -->
<g id="edge679" class="edge">
<title>ring_stage0_14_1&#45;&gt;kv_send0_14_1</title>
<path fill="none" stroke="black" d="M1220.16,-17524.93C1198.9,-17502.04 1167.67,-17468.4 1144.58,-17443.54"/>
<polygon fill="black" stroke="black" points="1147.06,-17441.07 1137.69,-17436.13 1141.93,-17445.84 1147.06,-17441.07"/>
</g>
<!-- ring_stage0_15_1 -->
<g id="node500" class="node">
<title>ring_stage0_15_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2091.5,-17436.11 1898.5,-17436.11 1898.5,-17383.11 2091.5,-17383.11 2091.5,-17436.11"/>
<text text-anchor="middle" x="1995" y="-17420.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="1995" y="-17405.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_2×V_2</text>
<text text-anchor="middle" x="1995" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_14_1&#45;&gt;ring_stage0_15_1 -->
<g id="edge724" class="edge">
<title>ring_stage0_14_1&#45;&gt;ring_stage0_15_1</title>
<path fill="none" stroke="black" d="M1287.89,-17525C1307.21,-17514.97 1330.59,-17504.48 1353,-17498.61 1583.97,-17438.13 1658.36,-17524.35 1889,-17462.61 1907.46,-17457.67 1926.53,-17449.43 1943.33,-17440.95"/>
<polygon fill="black" stroke="black" points="1945.14,-17443.95 1952.4,-17436.23 1941.91,-17437.74 1945.14,-17443.95"/>
</g>
<!-- kv_send0_14_2 -->
<g id="node485" class="node">
<title>kv_send0_14_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="642" cy="-17267.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="642" y="-17271.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="642" y="-17256.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage0_14_2&#45;&gt;kv_send0_14_2 -->
<g id="edge682" class="edge">
<title>ring_stage0_14_2&#45;&gt;kv_send0_14_2</title>
<path fill="none" stroke="black" d="M640.37,-17382.93C640.68,-17360.97 641.14,-17329.11 641.49,-17304.6"/>
<polygon fill="black" stroke="black" points="644.99,-17304.65 641.63,-17294.6 637.99,-17304.55 644.99,-17304.65"/>
</g>
<!-- ring_stage0_15_2 -->
<g id="node501" class="node">
<title>ring_stage0_15_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1210.5,-17294.11 1017.5,-17294.11 1017.5,-17241.11 1210.5,-17241.11 1210.5,-17294.11"/>
<text text-anchor="middle" x="1114" y="-17278.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="1114" y="-17263.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_3×V_3</text>
<text text-anchor="middle" x="1114" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_14_2&#45;&gt;ring_stage0_15_2 -->
<g id="edge726" class="edge">
<title>ring_stage0_14_2&#45;&gt;ring_stage0_15_2</title>
<path fill="none" stroke="black" d="M695.48,-17383.04C717.66,-17373.63 743.67,-17363.57 768,-17356.61 858.2,-17330.81 885.48,-17345.26 976,-17320.61 998.59,-17314.46 1022.66,-17306.06 1044.26,-17297.81"/>
<polygon fill="black" stroke="black" points="1045.61,-17301.04 1053.68,-17294.17 1043.09,-17294.52 1045.61,-17301.04"/>
</g>
<!-- kv_send0_14_3 -->
<g id="node486" class="node">
<title>kv_send0_14_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1503" cy="-17125.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1503" y="-17129.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="1503" y="-17114.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage0_14_3&#45;&gt;kv_send0_14_3 -->
<g id="edge685" class="edge">
<title>ring_stage0_14_3&#45;&gt;kv_send0_14_3</title>
<path fill="none" stroke="black" d="M928.51,-17241.03C952.96,-17231.31 981.93,-17221.05 1009,-17214.61 1151.67,-17180.66 1193.46,-17208.67 1337,-17178.61 1369.8,-17171.74 1405.35,-17161.06 1435.11,-17151.16"/>
<polygon fill="black" stroke="black" points="1436.6,-17154.35 1444.96,-17147.84 1434.37,-17147.71 1436.6,-17154.35"/>
</g>
<!-- ring_stage0_15_3 -->
<g id="node502" class="node">
<title>ring_stage0_15_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="882.5,-17152.11 689.5,-17152.11 689.5,-17099.11 882.5,-17099.11 882.5,-17152.11"/>
<text text-anchor="middle" x="786" y="-17136.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="786" y="-17121.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_4×V_4</text>
<text text-anchor="middle" x="786" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_14_3&#45;&gt;ring_stage0_15_3 -->
<g id="edge728" class="edge">
<title>ring_stage0_14_3&#45;&gt;ring_stage0_15_3</title>
<path fill="none" stroke="black" d="M854.59,-17240.93C841.09,-17218.43 821.37,-17185.56 806.53,-17160.83"/>
<polygon fill="black" stroke="black" points="809.46,-17158.9 801.31,-17152.13 803.45,-17162.5 809.46,-17158.9"/>
</g>
<!-- kv_send0_14_4 -->
<g id="node487" class="node">
<title>kv_send0_14_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1994" cy="-16983.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1994" y="-16987.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="1994" y="-16972.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage0_14_4&#45;&gt;kv_send0_14_4 -->
<g id="edge688" class="edge">
<title>ring_stage0_14_4&#45;&gt;kv_send0_14_4</title>
<path fill="none" stroke="black" d="M1793.65,-17099.1C1836,-17074.89 1899.56,-17038.58 1943.68,-17013.36"/>
<polygon fill="black" stroke="black" points="1945.57,-17016.32 1952.51,-17008.32 1942.09,-17010.24 1945.57,-17016.32"/>
</g>
<!-- ring_stage0_15_4 -->
<g id="node503" class="node">
<title>ring_stage0_15_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1871.5,-17010.11 1678.5,-17010.11 1678.5,-16957.11 1871.5,-16957.11 1871.5,-17010.11"/>
<text text-anchor="middle" x="1775" y="-16994.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="1775" y="-16979.91" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_5×V_5</text>
<text text-anchor="middle" x="1775" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_14_4&#45;&gt;ring_stage0_15_4 -->
<g id="edge730" class="edge">
<title>ring_stage0_14_4&#45;&gt;ring_stage0_15_4</title>
<path fill="none" stroke="black" d="M1753.77,-17098.93C1757.87,-17076.83 1763.84,-17044.71 1768.4,-17020.14"/>
<polygon fill="black" stroke="black" points="1771.88,-17020.6 1770.26,-17010.13 1764.99,-17019.32 1771.88,-17020.6"/>
</g>
<!-- kv_send0_14_5 -->
<g id="node488" class="node">
<title>kv_send0_14_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2485" cy="-16841.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2485" y="-16845.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2485" y="-16830.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage0_14_5&#45;&gt;kv_send0_14_5 -->
<g id="edge691" class="edge">
<title>ring_stage0_14_5&#45;&gt;kv_send0_14_5</title>
<path fill="none" stroke="black" d="M2261.75,-16957.1C2309.53,-16932.59 2381.52,-16895.68 2430.75,-16870.43"/>
<polygon fill="black" stroke="black" points="2432.37,-16873.54 2439.67,-16865.86 2429.17,-16867.31 2432.37,-16873.54"/>
</g>
<!-- ring_stage0_15_5 -->
<g id="node504" class="node">
<title>ring_stage0_15_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2206.5,-16868.11 2013.5,-16868.11 2013.5,-16815.11 2206.5,-16815.11 2206.5,-16868.11"/>
<text text-anchor="middle" x="2110" y="-16852.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2110" y="-16837.91" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_6×V_6</text>
<text text-anchor="middle" x="2110" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_14_5&#45;&gt;ring_stage0_15_5 -->
<g id="edge732" class="edge">
<title>ring_stage0_14_5&#45;&gt;ring_stage0_15_5</title>
<path fill="none" stroke="black" d="M2193.29,-16956.93C2176.83,-16934.34 2152.74,-16901.27 2134.7,-16876.51"/>
<polygon fill="black" stroke="black" points="2137.31,-16874.15 2128.59,-16868.13 2131.65,-16878.27 2137.31,-16874.15"/>
</g>
<!-- kv_send0_14_6 -->
<g id="node489" class="node">
<title>kv_send0_14_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2883" cy="-16699.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2883" y="-16703.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2883" y="-16688.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage0_14_6&#45;&gt;kv_send0_14_6 -->
<g id="edge694" class="edge">
<title>ring_stage0_14_6&#45;&gt;kv_send0_14_6</title>
<path fill="none" stroke="black" d="M2736.01,-16814.93C2766.24,-16791.43 2811.02,-16756.59 2843.21,-16731.56"/>
<polygon fill="black" stroke="black" points="2845.36,-16734.32 2851.1,-16725.42 2841.06,-16728.8 2845.36,-16734.32"/>
</g>
<!-- ring_stage0_15_6 -->
<g id="node505" class="node">
<title>ring_stage0_15_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2714.5,-16726.11 2521.5,-16726.11 2521.5,-16673.11 2714.5,-16673.11 2714.5,-16726.11"/>
<text text-anchor="middle" x="2618" y="-16710.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2618" y="-16695.91" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_7×V_7</text>
<text text-anchor="middle" x="2618" y="-16680.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_14_6&#45;&gt;ring_stage0_15_6 -->
<g id="edge734" class="edge">
<title>ring_stage0_14_6&#45;&gt;ring_stage0_15_6</title>
<path fill="none" stroke="black" d="M2687.41,-16814.93C2673.75,-16792.43 2653.79,-16759.56 2638.78,-16734.83"/>
<polygon fill="black" stroke="black" points="2641.67,-16732.86 2633.49,-16726.13 2635.69,-16736.49 2641.67,-16732.86"/>
</g>
<!-- kv_send0_14_7 -->
<g id="node490" class="node">
<title>kv_send0_14_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3164" cy="-16557.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3164" y="-16561.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="3164" y="-16546.41" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage0_14_7&#45;&gt;kv_send0_14_7 -->
<g id="edge697" class="edge">
<title>ring_stage0_14_7&#45;&gt;kv_send0_14_7</title>
<path fill="none" stroke="black" d="M3131.34,-16672.93C3137.64,-16650.87 3146.8,-16618.83 3153.81,-16594.28"/>
<polygon fill="black" stroke="black" points="3157.19,-16595.18 3156.57,-16584.6 3150.46,-16593.25 3157.19,-16595.18"/>
</g>
<!-- ring_stage0_15_7 -->
<g id="node506" class="node">
<title>ring_stage0_15_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3042.5,-16584.11 2849.5,-16584.11 2849.5,-16531.11 3042.5,-16531.11 3042.5,-16584.11"/>
<text text-anchor="middle" x="2946" y="-16568.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2946" y="-16553.91" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_8×V_8</text>
<text text-anchor="middle" x="2946" y="-16538.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_14_7&#45;&gt;ring_stage0_15_7 -->
<g id="edge736" class="edge">
<title>ring_stage0_14_7&#45;&gt;ring_stage0_15_7</title>
<path fill="none" stroke="black" d="M3091.35,-16672.93C3061.87,-16649.74 3018.37,-16615.53 2986.65,-16590.58"/>
<polygon fill="black" stroke="black" points="2988.46,-16587.56 2978.44,-16584.13 2984.14,-16593.06 2988.46,-16587.56"/>
</g>
<!-- kv_send0_14_8 -->
<g id="node491" class="node">
<title>kv_send0_14_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3841" cy="-16415.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3841" y="-16419.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="3841" y="-16404.41" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage0_14_8&#45;&gt;kv_send0_14_8 -->
<g id="edge700" class="edge">
<title>ring_stage0_14_8&#45;&gt;kv_send0_14_8</title>
<path fill="none" stroke="black" d="M3660.28,-16531.1C3698.01,-16507.19 3754.4,-16471.47 3794.13,-16446.3"/>
<polygon fill="black" stroke="black" points="3796.27,-16449.09 3802.85,-16440.78 3792.53,-16443.17 3796.27,-16449.09"/>
</g>
<!-- ring_stage0_15_8 -->
<g id="node507" class="node">
<title>ring_stage0_15_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3490.5,-16442.11 3297.5,-16442.11 3297.5,-16389.11 3490.5,-16389.11 3490.5,-16442.11"/>
<text text-anchor="middle" x="3394" y="-16426.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="3394" y="-16411.91" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_9×V_9</text>
<text text-anchor="middle" x="3394" y="-16396.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_14_8&#45;&gt;ring_stage0_15_8 -->
<g id="edge738" class="edge">
<title>ring_stage0_14_8&#45;&gt;ring_stage0_15_8</title>
<path fill="none" stroke="black" d="M3578.81,-16531.1C3540.85,-16507.58 3484.44,-16472.64 3443.93,-16447.54"/>
<polygon fill="black" stroke="black" points="3445.63,-16444.48 3435.29,-16442.19 3441.95,-16450.43 3445.63,-16444.48"/>
</g>
<!-- kv_send0_14_9 -->
<g id="node492" class="node">
<title>kv_send0_14_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2886" cy="-16273.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2886" y="-16277.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="2886" y="-16262.41" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage0_14_9&#45;&gt;kv_send0_14_9 -->
<g id="edge703" class="edge">
<title>ring_stage0_14_9&#45;&gt;kv_send0_14_9</title>
<path fill="none" stroke="black" d="M3567.95,-16389.08C3547.71,-16379.07 3523.29,-16368.56 3500,-16362.61 3286.29,-16307.98 3219.14,-16379.53 3005,-16326.61 2982.8,-16321.12 2959.51,-16311.82 2939.48,-16302.59"/>
<polygon fill="black" stroke="black" points="2940.76,-16299.32 2930.22,-16298.22 2937.77,-16305.65 2940.76,-16299.32"/>
</g>
<!-- ring_stage0_15_9 -->
<g id="node508" class="node">
<title>ring_stage0_15_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3894.5,-16300.11 3683.5,-16300.11 3683.5,-16247.11 3894.5,-16247.11 3894.5,-16300.11"/>
<text text-anchor="middle" x="3789" y="-16284.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="3789" y="-16269.91" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_10×V_10</text>
<text text-anchor="middle" x="3789" y="-16254.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_14_9&#45;&gt;ring_stage0_15_9 -->
<g id="edge740" class="edge">
<title>ring_stage0_14_9&#45;&gt;ring_stage0_15_9</title>
<path fill="none" stroke="black" d="M3646.1,-16388.93C3675.08,-16365.74 3717.85,-16331.53 3749.04,-16306.58"/>
<polygon fill="black" stroke="black" points="3751.48,-16309.11 3757.11,-16300.13 3747.11,-16303.64 3751.48,-16309.11"/>
</g>
<!-- kv_send0_14_10 -->
<g id="node493" class="node">
<title>kv_send0_14_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2500" cy="-16131.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2500" y="-16135.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="2500" y="-16120.41" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage0_14_10&#45;&gt;kv_send0_14_10 -->
<g id="edge706" class="edge">
<title>ring_stage0_14_10&#45;&gt;kv_send0_14_10</title>
<path fill="none" stroke="black" d="M2500,-16246.93C2500,-16224.97 2500,-16193.11 2500,-16168.6"/>
<polygon fill="black" stroke="black" points="2503.5,-16168.6 2500,-16158.6 2496.5,-16168.6 2503.5,-16168.6"/>
</g>
<!-- ring_stage0_15_10 -->
<g id="node509" class="node">
<title>ring_stage0_15_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2996,-16158.11 2776,-16158.11 2776,-16105.11 2996,-16105.11 2996,-16158.11"/>
<text text-anchor="middle" x="2886" y="-16142.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2886" y="-16127.91" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_11×V_11</text>
<text text-anchor="middle" x="2886" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_14_10&#45;&gt;ring_stage0_15_10 -->
<g id="edge742" class="edge">
<title>ring_stage0_14_10&#45;&gt;ring_stage0_15_10</title>
<path fill="none" stroke="black" d="M2570.35,-16247.1C2636.81,-16222.99 2736.4,-16186.87 2805.88,-16161.67"/>
<polygon fill="black" stroke="black" points="2807.27,-16164.89 2815.48,-16158.19 2804.89,-16158.31 2807.27,-16164.89"/>
</g>
<!-- kv_send0_14_11 -->
<g id="node494" class="node">
<title>kv_send0_14_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3607" cy="-18183.22" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3607" y="-18187.02" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="3607" y="-18172.02" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage0_14_11&#45;&gt;kv_send0_14_11 -->
<g id="edge709" class="edge">
<title>ring_stage0_14_11&#45;&gt;kv_send0_14_11</title>
<path fill="none" stroke="black" d="M3621.11,-18246.11C3619.25,-18237.97 3617.17,-18228.83 3615.18,-18220.13"/>
<polygon fill="black" stroke="black" points="3618.55,-18219.16 3612.92,-18210.19 3611.73,-18220.72 3618.55,-18219.16"/>
</g>
<!-- ring_stage0_15_11 -->
<g id="node510" class="node">
<title>ring_stage0_15_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2610,-16016.11 2390,-16016.11 2390,-15963.11 2610,-15963.11 2610,-16016.11"/>
<text text-anchor="middle" x="2500" y="-16000.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2500" y="-15985.91" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_12×V_12</text>
<text text-anchor="middle" x="2500" y="-15970.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_14_11&#45;&gt;ring_stage0_15_11 -->
<g id="edge744" class="edge">
<title>ring_stage0_14_11&#45;&gt;ring_stage0_15_11</title>
<path fill="none" stroke="black" d="M3533.95,-18246.29C3516.33,-18237.47 3499.76,-18225.71 3488,-18210.09 3449.28,-18158.65 3504.95,-18119.34 3468,-18066.61 3448.38,-18038.61 3417.64,-18059.91 3400,-18030.61 3375.7,-17990.25 3370.36,-17961.23 3400,-17924.61 3448.32,-17864.92 3520.68,-17948.3 3569,-17888.61 3598.64,-17851.99 3601.35,-17816.86 3569,-17782.61 3472.71,-17680.66 3044.36,-17839.15 2939,-17746.61 2902.98,-17714.97 2942.04,-17682.65 2919,-17640.61 2874.73,-17559.82 2852.11,-17536.2 2768,-17498.61 2682.88,-17460.57 2414.78,-17529.66 2350,-17462.61 2320.01,-17431.57 2340,-17311.78 2340,-17268.61 2340,-17268.61 2340,-17268.61 2340,-17124.61 2340,-16873.05 2343,-16810.17 2343,-16558.61 2343,-16558.61 2343,-16558.61 2343,-16272.61 2343,-16184.75 2334.05,-16152.88 2381,-16078.61 2395.67,-16055.41 2418.81,-16036.25 2440.81,-16021.8"/>
<polygon fill="black" stroke="black" points="2442.92,-16024.6 2449.48,-16016.29 2439.17,-16018.69 2442.92,-16024.6"/>
</g>
<!-- kv_send0_14_12 -->
<g id="node495" class="node">
<title>kv_send0_14_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3349" cy="-18093.48" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3349" y="-18097.28" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="3349" y="-18082.28" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage0_14_12&#45;&gt;kv_send0_14_12 -->
<g id="edge712" class="edge">
<title>ring_stage0_14_12&#45;&gt;kv_send0_14_12</title>
<path fill="none" stroke="black" d="M3349,-18156.37C3349,-18148.32 3349,-18139.29 3349,-18130.67"/>
<polygon fill="black" stroke="black" points="3352.5,-18130.45 3349,-18120.45 3345.5,-18130.45 3352.5,-18130.45"/>
</g>
<!-- ring_stage0_15_12 -->
<g id="node511" class="node">
<title>ring_stage0_15_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3717,-18119.98 3497,-18119.98 3497,-18066.98 3717,-18066.98 3717,-18119.98"/>
<text text-anchor="middle" x="3607" y="-18104.78" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="3607" y="-18089.78" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_13×V_13</text>
<text text-anchor="middle" x="3607" y="-18074.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_14_12&#45;&gt;ring_stage0_15_12 -->
<g id="edge746" class="edge">
<title>ring_stage0_14_12&#45;&gt;ring_stage0_15_12</title>
<path fill="none" stroke="black" d="M3424.32,-18156.61C3454.92,-18146.2 3490.42,-18134.13 3521.94,-18123.41"/>
<polygon fill="black" stroke="black" points="3523.25,-18126.66 3531.59,-18120.13 3520.99,-18120.03 3523.25,-18126.66"/>
</g>
<!-- kv_send0_14_13 -->
<g id="node496" class="node">
<title>kv_send0_14_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3018" cy="-17977.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="3018" y="-17981.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="3018" y="-17966.41" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage0_14_13&#45;&gt;kv_send0_14_13 -->
<g id="edge715" class="edge">
<title>ring_stage0_14_13&#45;&gt;kv_send0_14_13</title>
<path fill="none" stroke="black" d="M3059.88,-18066.93C3052.43,-18051.21 3042.78,-18030.86 3034.62,-18013.66"/>
<polygon fill="black" stroke="black" points="3037.71,-18012.01 3030.27,-18004.47 3031.39,-18015.01 3037.71,-18012.01"/>
</g>
<!-- ring_stage0_15_13 -->
<g id="node512" class="node">
<title>ring_stage0_15_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3366,-18004.11 3146,-18004.11 3146,-17951.11 3366,-17951.11 3366,-18004.11"/>
<text text-anchor="middle" x="3256" y="-17988.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="3256" y="-17973.91" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_14×V_14</text>
<text text-anchor="middle" x="3256" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_14_13&#45;&gt;ring_stage0_15_13 -->
<g id="edge748" class="edge">
<title>ring_stage0_14_13&#45;&gt;ring_stage0_15_13</title>
<path fill="none" stroke="black" d="M3113.29,-18066.93C3140.66,-18049.99 3176.73,-18027.67 3205.76,-18009.7"/>
<polygon fill="black" stroke="black" points="3207.87,-18012.52 3214.53,-18004.28 3204.18,-18006.56 3207.87,-18012.52"/>
</g>
<!-- kv_send0_14_14 -->
<g id="node497" class="node">
<title>kv_send0_14_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2766" cy="-17835.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2766" y="-17839.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="2766" y="-17824.41" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage0_14_14&#45;&gt;kv_send0_14_14 -->
<g id="edge718" class="edge">
<title>ring_stage0_14_14&#45;&gt;kv_send0_14_14</title>
<path fill="none" stroke="black" d="M2784.78,-17950.93C2781.17,-17928.97 2775.94,-17897.11 2771.91,-17872.6"/>
<polygon fill="black" stroke="black" points="2775.34,-17871.9 2770.27,-17862.6 2768.44,-17873.04 2775.34,-17871.9"/>
</g>
<!-- ring_stage0_15_14 -->
<g id="node513" class="node">
<title>ring_stage0_15_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3114,-17862.11 2894,-17862.11 2894,-17809.11 3114,-17809.11 3114,-17862.11"/>
<text text-anchor="middle" x="3004" y="-17846.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="3004" y="-17831.91" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_15×V_15</text>
<text text-anchor="middle" x="3004" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_14_14&#45;&gt;ring_stage0_15_14 -->
<g id="edge750" class="edge">
<title>ring_stage0_14_14&#45;&gt;ring_stage0_15_14</title>
<path fill="none" stroke="black" d="M2828.43,-17950.93C2864.5,-17927.45 2917.93,-17892.66 2956.37,-17867.63"/>
<polygon fill="black" stroke="black" points="2958.35,-17870.52 2964.82,-17862.13 2954.53,-17864.65 2958.35,-17870.52"/>
</g>
<!-- kv_send0_14_15 -->
<g id="node498" class="node">
<title>kv_send0_14_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2357" cy="-17693.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2357" y="-17697.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="2357" y="-17682.41" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage0_14_15&#45;&gt;kv_send0_14_15 -->
<g id="edge721" class="edge">
<title>ring_stage0_14_15&#45;&gt;kv_send0_14_15</title>
<path fill="none" stroke="black" d="M2503.99,-17808.93C2473.76,-17785.43 2428.98,-17750.59 2396.79,-17725.56"/>
<polygon fill="black" stroke="black" points="2398.94,-17722.8 2388.9,-17719.42 2394.64,-17728.32 2398.94,-17722.8"/>
</g>
<!-- ring_stage0_15_15 -->
<g id="node514" class="node">
<title>ring_stage0_15_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2910,-17720.11 2708,-17720.11 2708,-17667.11 2910,-17667.11 2910,-17720.11"/>
<text text-anchor="middle" x="2809" y="-17704.91" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="2809" y="-17689.91" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_0×V_0</text>
<text text-anchor="middle" x="2809" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_14_15&#45;&gt;ring_stage0_15_15 -->
<g id="edge752" class="edge">
<title>ring_stage0_14_15&#45;&gt;ring_stage0_15_15</title>
<path fill="none" stroke="black" d="M2586.57,-17809.1C2632.64,-17785.39 2701.29,-17750.05 2750.13,-17724.91"/>
<polygon fill="black" stroke="black" points="2752.02,-17727.88 2759.31,-17720.19 2748.82,-17721.65 2752.02,-17727.88"/>
</g>
<!-- kv_send0_14_0&#45;&gt;ring_stage0_15_1 -->
<g id="edge725" class="edge">
<title>kv_send0_14_0&#45;&gt;ring_stage0_15_1</title>
<path fill="none" stroke="black" d="M1991.74,-17524.61C1992.37,-17502.7 1993.27,-17471.13 1993.97,-17446.76"/>
<polygon fill="black" stroke="black" points="1997.47,-17446.57 1994.26,-17436.48 1990.48,-17446.37 1997.47,-17446.57"/>
</g>
<!-- kv_send0_14_1&#45;&gt;ring_stage0_15_2 -->
<g id="edge727" class="edge">
<title>kv_send0_14_1&#45;&gt;ring_stage0_15_2</title>
<path fill="none" stroke="black" d="M1114,-17382.61C1114,-17360.7 1114,-17329.13 1114,-17304.76"/>
<polygon fill="black" stroke="black" points="1117.5,-17304.48 1114,-17294.48 1110.5,-17304.48 1117.5,-17304.48"/>
</g>
<!-- kv_send0_14_2&#45;&gt;ring_stage0_15_3 -->
<g id="edge729" class="edge">
<title>kv_send0_14_2&#45;&gt;ring_stage0_15_3</title>
<path fill="none" stroke="black" d="M667.74,-17241.58C691.31,-17218.67 726.33,-17184.63 752.15,-17159.52"/>
<polygon fill="black" stroke="black" points="754.77,-17161.85 759.5,-17152.37 749.89,-17156.83 754.77,-17161.85"/>
</g>
<!-- kv_send0_14_3&#45;&gt;ring_stage0_15_4 -->
<g id="edge731" class="edge">
<title>kv_send0_14_3&#45;&gt;ring_stage0_15_4</title>
<path fill="none" stroke="black" d="M1548.22,-17101.34C1594.16,-17077.69 1665.52,-17040.96 1715.9,-17015.03"/>
<polygon fill="black" stroke="black" points="1717.77,-17018.01 1725.05,-17010.32 1714.56,-17011.78 1717.77,-17018.01"/>
</g>
<!-- kv_send0_14_4&#45;&gt;ring_stage0_15_5 -->
<g id="edge733" class="edge">
<title>kv_send0_14_4&#45;&gt;ring_stage0_15_5</title>
<path fill="none" stroke="black" d="M2015.01,-16957.26C2033.86,-16934.5 2061.66,-16900.95 2082.32,-16876.02"/>
<polygon fill="black" stroke="black" points="2085.07,-16878.18 2088.76,-16868.25 2079.68,-16873.71 2085.07,-16878.18"/>
</g>
<!-- kv_send0_14_5&#45;&gt;ring_stage0_15_6 -->
<g id="edge735" class="edge">
<title>kv_send0_14_5&#45;&gt;ring_stage0_15_6</title>
<path fill="none" stroke="black" d="M2509.09,-16815.26C2530.79,-16792.41 2562.85,-16758.66 2586.57,-16733.69"/>
<polygon fill="black" stroke="black" points="2589.29,-16735.91 2593.64,-16726.25 2584.22,-16731.09 2589.29,-16735.91"/>
</g>
<!-- kv_send0_14_6&#45;&gt;ring_stage0_15_7 -->
<g id="edge737" class="edge">
<title>kv_send0_14_6&#45;&gt;ring_stage0_15_7</title>
<path fill="none" stroke="black" d="M2894.7,-16672.61C2904.69,-16650.41 2919.15,-16618.28 2930.17,-16593.79"/>
<polygon fill="black" stroke="black" points="2933.45,-16595.03 2934.36,-16584.48 2927.07,-16592.16 2933.45,-16595.03"/>
</g>
<!-- kv_send0_14_7&#45;&gt;ring_stage0_15_8 -->
<g id="edge739" class="edge">
<title>kv_send0_14_7&#45;&gt;ring_stage0_15_8</title>
<path fill="none" stroke="black" d="M3203.28,-16532.7C3241.85,-16509.23 3300.87,-16473.3 3343.04,-16447.63"/>
<polygon fill="black" stroke="black" points="3345.05,-16450.51 3351.77,-16442.32 3341.41,-16444.53 3345.05,-16450.51"/>
</g>
<!-- kv_send0_14_8&#45;&gt;ring_stage0_15_9 -->
<g id="edge741" class="edge">
<title>kv_send0_14_8&#45;&gt;ring_stage0_15_9</title>
<path fill="none" stroke="black" d="M3831.34,-16388.61C3823.13,-16366.5 3811.27,-16334.56 3802.19,-16310.11"/>
<polygon fill="black" stroke="black" points="3805.37,-16308.63 3798.61,-16300.48 3798.81,-16311.07 3805.37,-16308.63"/>
</g>
<!-- kv_send0_14_9&#45;&gt;ring_stage0_15_10 -->
<g id="edge743" class="edge">
<title>kv_send0_14_9&#45;&gt;ring_stage0_15_10</title>
<path fill="none" stroke="black" d="M2886,-16246.61C2886,-16224.7 2886,-16193.13 2886,-16168.76"/>
<polygon fill="black" stroke="black" points="2889.5,-16168.48 2886,-16158.48 2882.5,-16168.48 2889.5,-16168.48"/>
</g>
<!-- kv_send0_14_10&#45;&gt;ring_stage0_15_11 -->
<g id="edge745" class="edge">
<title>kv_send0_14_10&#45;&gt;ring_stage0_15_11</title>
<path fill="none" stroke="black" d="M2500,-16104.61C2500,-16082.7 2500,-16051.13 2500,-16026.76"/>
<polygon fill="black" stroke="black" points="2503.5,-16026.48 2500,-16016.48 2496.5,-16026.48 2503.5,-16026.48"/>
</g>
<!-- kv_send0_14_11&#45;&gt;ring_stage0_15_12 -->
<g id="edge747" class="edge">
<title>kv_send0_14_11&#45;&gt;ring_stage0_15_12</title>
<path fill="none" stroke="black" d="M3607,-18155.9C3607,-18147.86 3607,-18138.88 3607,-18130.32"/>
<polygon fill="black" stroke="black" points="3610.5,-18130.18 3607,-18120.18 3603.5,-18130.18 3610.5,-18130.18"/>
</g>
<!-- kv_send0_14_12&#45;&gt;ring_stage0_15_13 -->
<g id="edge749" class="edge">
<title>kv_send0_14_12&#45;&gt;ring_stage0_15_13</title>
<path fill="none" stroke="black" d="M3328.13,-18066.93C3314.94,-18050.78 3297.75,-18029.73 3283.46,-18012.23"/>
<polygon fill="black" stroke="black" points="3286.16,-18010 3277.12,-18004.47 3280.74,-18014.43 3286.16,-18010"/>
</g>
<!-- kv_send0_14_13&#45;&gt;ring_stage0_15_14 -->
<g id="edge751" class="edge">
<title>kv_send0_14_13&#45;&gt;ring_stage0_15_14</title>
<path fill="none" stroke="black" d="M3015.4,-17950.61C3013.2,-17928.6 3010.02,-17896.85 3007.58,-17872.44"/>
<polygon fill="black" stroke="black" points="3011.06,-17872.08 3006.59,-17862.48 3004.1,-17872.77 3011.06,-17872.08"/>
</g>
<!-- kv_send0_14_14&#45;&gt;ring_stage0_15_15 -->
<g id="edge753" class="edge">
<title>kv_send0_14_14&#45;&gt;ring_stage0_15_15</title>
<path fill="none" stroke="black" d="M2773.99,-17808.61C2780.78,-17786.5 2790.59,-17754.56 2798.1,-17730.11"/>
<polygon fill="black" stroke="black" points="2801.47,-17731.06 2801.06,-17720.48 2794.77,-17729.01 2801.47,-17731.06"/>
</g>
<!-- kv_send0_14_15&#45;&gt;ring_stage0_15_0 -->
<g id="edge723" class="edge">
<title>kv_send0_14_15&#45;&gt;ring_stage0_15_0</title>
<path fill="none" stroke="black" d="M2405.48,-17669.8C2425.39,-17660.56 2448.73,-17649.9 2470,-17640.61 2508.35,-17623.86 2518.9,-17621.91 2557,-17604.61 2572.03,-17597.79 2588.09,-17590.06 2603,-17582.7"/>
<polygon fill="black" stroke="black" points="2604.73,-17585.75 2612.13,-17578.17 2601.61,-17579.48 2604.73,-17585.75"/>
</g>
<!-- accum0_0 -->
<g id="node531" class="node">
<title>accum0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3010.64,-17462.61 2670.79,-17462.61 2583.36,-17356.61 2923.21,-17356.61 3010.64,-17462.61"/>
<text text-anchor="middle" x="2797" y="-17420.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="2797" y="-17405.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2797" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage0_15_0&#45;&gt;accum0_0 -->
<g id="edge754" class="edge">
<title>ring_stage0_15_0&#45;&gt;accum0_0</title>
<path fill="none" stroke="black" d="M2686.76,-17524.93C2701.61,-17509.53 2721.15,-17489.27 2739.64,-17470.09"/>
<polygon fill="black" stroke="black" points="2742.25,-17472.43 2746.67,-17462.8 2737.21,-17467.57 2742.25,-17472.43"/>
</g>
<!-- accum0_1 -->
<g id="node532" class="node">
<title>accum0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3443.64,-17320.61 3103.79,-17320.61 3016.36,-17214.61 3356.21,-17214.61 3443.64,-17320.61"/>
<text text-anchor="middle" x="3230" y="-17278.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3230" y="-17263.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3230" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage0_15_1&#45;&gt;accum0_1 -->
<g id="edge763" class="edge">
<title>ring_stage0_15_1&#45;&gt;accum0_1</title>
<path fill="none" stroke="black" d="M2036.76,-17383.11C2055.67,-17372.9 2078.74,-17362.24 2101,-17356.61 2296.55,-17307.12 2808.12,-17347.73 3008,-17320.61 3031.79,-17317.38 3056.76,-17312.77 3081.03,-17307.6"/>
<polygon fill="black" stroke="black" points="3081.98,-17310.97 3091.01,-17305.43 3080.5,-17304.13 3081.98,-17310.97"/>
</g>
<!-- accum0_2 -->
<g id="node533" class="node">
<title>accum0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1327.64,-17178.61 987.79,-17178.61 900.36,-17072.61 1240.21,-17072.61 1327.64,-17178.61"/>
<text text-anchor="middle" x="1114" y="-17136.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="1114" y="-17121.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1114" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage0_15_2&#45;&gt;accum0_2 -->
<g id="edge772" class="edge">
<title>ring_stage0_15_2&#45;&gt;accum0_2</title>
<path fill="none" stroke="black" d="M1114,-17240.93C1114,-17226.28 1114,-17207.22 1114,-17188.89"/>
<polygon fill="black" stroke="black" points="1117.5,-17188.8 1114,-17178.8 1110.5,-17188.8 1117.5,-17188.8"/>
</g>
<!-- accum0_3 -->
<g id="node534" class="node">
<title>accum0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1660.64,-17036.61 1320.79,-17036.61 1233.36,-16930.61 1573.21,-16930.61 1660.64,-17036.61"/>
<text text-anchor="middle" x="1447" y="-16994.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="1447" y="-16979.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1447" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage0_15_3&#45;&gt;accum0_3 -->
<g id="edge781" class="edge">
<title>ring_stage0_15_3&#45;&gt;accum0_3</title>
<path fill="none" stroke="black" d="M829.05,-17099C847.52,-17089.17 869.71,-17078.82 891,-17072.61 1033.91,-17030.93 1077.24,-17061.56 1224,-17036.61 1247.68,-17032.58 1272.61,-17027.56 1296.87,-17022.24"/>
<polygon fill="black" stroke="black" points="1297.85,-17025.61 1306.86,-17020.02 1296.34,-17018.77 1297.85,-17025.61"/>
</g>
<!-- accum0_4 -->
<g id="node535" class="node">
<title>accum0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1995.64,-16894.61 1655.79,-16894.61 1568.36,-16788.61 1908.21,-16788.61 1995.64,-16894.61"/>
<text text-anchor="middle" x="1782" y="-16852.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="1782" y="-16837.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1782" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage0_15_4&#45;&gt;accum0_4 -->
<g id="edge790" class="edge">
<title>ring_stage0_15_4&#45;&gt;accum0_4</title>
<path fill="none" stroke="black" d="M1776.28,-16956.93C1777.02,-16942.28 1777.97,-16923.22 1778.89,-16904.89"/>
<polygon fill="black" stroke="black" points="1782.39,-16904.97 1779.39,-16894.8 1775.4,-16904.62 1782.39,-16904.97"/>
</g>
<!-- accum0_5 -->
<g id="node536" class="node">
<title>accum0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2323.64,-16752.61 1983.79,-16752.61 1896.36,-16646.61 2236.21,-16646.61 2323.64,-16752.61"/>
<text text-anchor="middle" x="2110" y="-16710.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="2110" y="-16695.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2110" y="-16680.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage0_15_5&#45;&gt;accum0_5 -->
<g id="edge799" class="edge">
<title>ring_stage0_15_5&#45;&gt;accum0_5</title>
<path fill="none" stroke="black" d="M2110,-16814.93C2110,-16800.28 2110,-16781.22 2110,-16762.89"/>
<polygon fill="black" stroke="black" points="2113.5,-16762.8 2110,-16752.8 2106.5,-16762.8 2113.5,-16762.8"/>
</g>
<!-- accum0_6 -->
<g id="node537" class="node">
<title>accum0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2831.64,-16610.61 2491.79,-16610.61 2404.36,-16504.61 2744.21,-16504.61 2831.64,-16610.61"/>
<text text-anchor="middle" x="2618" y="-16568.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="2618" y="-16553.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2618" y="-16538.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage0_15_6&#45;&gt;accum0_6 -->
<g id="edge808" class="edge">
<title>ring_stage0_15_6&#45;&gt;accum0_6</title>
<path fill="none" stroke="black" d="M2618,-16672.93C2618,-16658.28 2618,-16639.22 2618,-16620.89"/>
<polygon fill="black" stroke="black" points="2621.5,-16620.8 2618,-16610.8 2614.5,-16620.8 2621.5,-16620.8"/>
</g>
<!-- accum0_7 -->
<g id="node538" class="node">
<title>accum0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3279.64,-16468.61 2939.79,-16468.61 2852.36,-16362.61 3192.21,-16362.61 3279.64,-16468.61"/>
<text text-anchor="middle" x="3066" y="-16426.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3066" y="-16411.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3066" y="-16396.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage0_15_7&#45;&gt;accum0_7 -->
<g id="edge817" class="edge">
<title>ring_stage0_15_7&#45;&gt;accum0_7</title>
<path fill="none" stroke="black" d="M2968.01,-16530.93C2981.09,-16515.67 2998.27,-16495.63 3014.58,-16476.6"/>
<polygon fill="black" stroke="black" points="3017.41,-16478.67 3021.26,-16468.8 3012.1,-16474.12 3017.41,-16478.67"/>
</g>
<!-- accum0_8 -->
<g id="node539" class="node">
<title>accum0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3665.64,-16326.61 3325.79,-16326.61 3238.36,-16220.61 3578.21,-16220.61 3665.64,-16326.61"/>
<text text-anchor="middle" x="3452" y="-16284.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3452" y="-16269.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3452" y="-16254.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage0_15_8&#45;&gt;accum0_8 -->
<g id="edge826" class="edge">
<title>ring_stage0_15_8&#45;&gt;accum0_8</title>
<path fill="none" stroke="black" d="M3404.64,-16388.93C3410.79,-16374.08 3418.82,-16354.69 3426.52,-16336.12"/>
<polygon fill="black" stroke="black" points="3429.78,-16337.38 3430.38,-16326.8 3423.32,-16334.7 3429.78,-16337.38"/>
</g>
<!-- accum0_9 -->
<g id="node540" class="node">
<title>accum0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3727.64,-16184.61 3387.79,-16184.61 3300.36,-16078.61 3640.21,-16078.61 3727.64,-16184.61"/>
<text text-anchor="middle" x="3514" y="-16142.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3514" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3514" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage0_15_9&#45;&gt;accum0_9 -->
<g id="edge835" class="edge">
<title>ring_stage0_15_9&#45;&gt;accum0_9</title>
<path fill="none" stroke="black" d="M3738.88,-16247.1C3707.18,-16230.96 3664.91,-16209.44 3625.57,-16189.41"/>
<polygon fill="black" stroke="black" points="3626.68,-16186.05 3616.18,-16184.63 3623.5,-16192.28 3626.68,-16186.05"/>
</g>
<!-- accum0_10 -->
<g id="node541" class="node">
<title>accum0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3309.64,-16042.61 2969.79,-16042.61 2882.36,-15936.61 3222.21,-15936.61 3309.64,-16042.61"/>
<text text-anchor="middle" x="3096" y="-16000.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3096" y="-15985.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3096" y="-15970.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage0_15_10&#45;&gt;accum0_10 -->
<g id="edge844" class="edge">
<title>ring_stage0_15_10&#45;&gt;accum0_10</title>
<path fill="none" stroke="black" d="M2924.52,-16104.93C2948.23,-16089.13 2979.62,-16068.2 3009.06,-16048.57"/>
<polygon fill="black" stroke="black" points="3011.33,-16051.26 3017.71,-16042.8 3007.45,-16045.44 3011.33,-16051.26"/>
</g>
<!-- accum0_11 -->
<g id="node542" class="node">
<title>accum0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3050.64,-15897.61 2710.79,-15897.61 2623.36,-15791.61 2963.21,-15791.61 3050.64,-15897.61"/>
<text text-anchor="middle" x="2837" y="-15855.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="2837" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2837" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage0_15_11&#45;&gt;accum0_11 -->
<g id="edge853" class="edge">
<title>ring_stage0_15_11&#45;&gt;accum0_11</title>
<path fill="none" stroke="black" d="M2560.25,-15963.04C2600.44,-15945.99 2654.88,-15922.89 2704.84,-15901.69"/>
<polygon fill="black" stroke="black" points="2706.28,-15904.88 2714.12,-15897.75 2703.54,-15898.44 2706.28,-15904.88"/>
</g>
<!-- accum0_12 -->
<g id="node543" class="node">
<title>accum0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3891.64,-18030.61 3551.79,-18030.61 3464.36,-17924.61 3804.21,-17924.61 3891.64,-18030.61"/>
<text text-anchor="middle" x="3678" y="-17988.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3678" y="-17973.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3678" y="-17958.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage0_15_12&#45;&gt;accum0_12 -->
<g id="edge862" class="edge">
<title>ring_stage0_15_12&#45;&gt;accum0_12</title>
<path fill="none" stroke="black" d="M3622.93,-18066.93C3628.12,-18058.61 3634.12,-18048.99 3640.2,-18039.23"/>
<polygon fill="black" stroke="black" points="3643.24,-18040.98 3645.56,-18030.64 3637.3,-18037.28 3643.24,-18040.98"/>
</g>
<!-- accum0_13 -->
<g id="node544" class="node">
<title>accum0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3559.64,-17888.61 3219.79,-17888.61 3132.36,-17782.61 3472.21,-17782.61 3559.64,-17888.61"/>
<text text-anchor="middle" x="3346" y="-17846.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3346" y="-17831.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3346" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage0_15_13&#45;&gt;accum0_13 -->
<g id="edge871" class="edge">
<title>ring_stage0_15_13&#45;&gt;accum0_13</title>
<path fill="none" stroke="black" d="M3272.51,-17950.93C3282.19,-17935.87 3294.86,-17916.16 3306.95,-17897.36"/>
<polygon fill="black" stroke="black" points="3309.98,-17899.11 3312.45,-17888.8 3304.1,-17895.32 3309.98,-17899.11"/>
</g>
<!-- accum0_14 -->
<g id="node545" class="node">
<title>accum0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3375.64,-17746.61 3035.79,-17746.61 2948.36,-17640.61 3288.21,-17640.61 3375.64,-17746.61"/>
<text text-anchor="middle" x="3162" y="-17704.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3162" y="-17689.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3162" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage0_15_14&#45;&gt;accum0_14 -->
<g id="edge880" class="edge">
<title>ring_stage0_15_14&#45;&gt;accum0_14</title>
<path fill="none" stroke="black" d="M3032.98,-17808.93C3050.51,-17793.4 3073.63,-17772.91 3095.44,-17753.58"/>
<polygon fill="black" stroke="black" points="3097.93,-17756.05 3103.1,-17746.8 3093.29,-17750.82 3097.93,-17756.05"/>
</g>
<!-- accum0_15 -->
<g id="node546" class="node">
<title>accum0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3647.64,-17604.61 3307.79,-17604.61 3220.36,-17498.61 3560.21,-17498.61 3647.64,-17604.61"/>
<text text-anchor="middle" x="3434" y="-17562.91" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="3434" y="-17547.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3434" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage0_15_15&#45;&gt;accum0_15 -->
<g id="edge889" class="edge">
<title>ring_stage0_15_15&#45;&gt;accum0_15</title>
<path fill="none" stroke="black" d="M2863.96,-17667.1C2886.75,-17657.46 2913.72,-17647.23 2939,-17640.61 3056.97,-17609.73 3091.03,-17626.48 3211,-17604.61 3234.55,-17600.32 3259.35,-17595.17 3283.52,-17589.8"/>
<polygon fill="black" stroke="black" points="3284.48,-17593.17 3293.47,-17587.57 3282.94,-17586.34 3284.48,-17593.17"/>
</g>
<!-- kv_send0_15_0 -->
<g id="node515" class="node">
<title>kv_send0_15_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3624" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3624" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="3624" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- kv_send0_15_1 -->
<g id="node516" class="node">
<title>kv_send0_15_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3400" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3400" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="3400" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- kv_send0_15_2 -->
<g id="node517" class="node">
<title>kv_send0_15_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3176" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="3176" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="3176" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- kv_send0_15_3 -->
<g id="node518" class="node">
<title>kv_send0_15_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2952" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2952" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="2952" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- kv_send0_15_4 -->
<g id="node519" class="node">
<title>kv_send0_15_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2728" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2728" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="2728" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- kv_send0_15_5 -->
<g id="node520" class="node">
<title>kv_send0_15_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2504" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2504" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="2504" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- kv_send0_15_6 -->
<g id="node521" class="node">
<title>kv_send0_15_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2280" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2280" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="2280" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- kv_send0_15_7 -->
<g id="node522" class="node">
<title>kv_send0_15_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2056" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="2056" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="2056" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- kv_send0_15_8 -->
<g id="node523" class="node">
<title>kv_send0_15_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1832" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="1832" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="1832" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- kv_send0_15_9 -->
<g id="node524" class="node">
<title>kv_send0_15_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1601" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1601" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="1601" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- kv_send0_15_10 -->
<g id="node525" class="node">
<title>kv_send0_15_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1363" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1363" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="1363" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- kv_send0_15_11 -->
<g id="node526" class="node">
<title>kv_send0_15_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1125" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="1125" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="1125" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- kv_send0_15_12 -->
<g id="node527" class="node">
<title>kv_send0_15_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="886" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="886" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="886" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- kv_send0_15_13 -->
<g id="node528" class="node">
<title>kv_send0_15_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="645" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="645" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="645" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- kv_send0_15_14 -->
<g id="node529" class="node">
<title>kv_send0_15_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="400" cy="-20964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="400" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="400" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- kv_send0_15_15 -->
<g id="node530" class="node">
<title>kv_send0_15_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="152" cy="-20964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="152" y="-20968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="152" y="-20953.61" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- out_proj0_0 -->
<g id="node547" class="node">
<title>out_proj0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3952,-17294.11 3746,-17294.11 3746,-17241.11 3952,-17241.11 3952,-17294.11"/>
<text text-anchor="middle" x="3849" y="-17278.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3849" y="-17263.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3849" y="-17248.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- accum0_0&#45;&gt;out_proj0_0 -->
<g id="edge755" class="edge">
<title>accum0_0&#45;&gt;out_proj0_0</title>
<path fill="none" stroke="black" d="M2950.38,-17389.45C3036.34,-17379.03 3145.55,-17366.33 3243,-17356.61 3435.6,-17337.4 3486.87,-17356.82 3677,-17320.61 3706.74,-17314.95 3738.66,-17306.1 3766.82,-17297.3"/>
<polygon fill="black" stroke="black" points="3768.14,-17300.56 3776.61,-17294.2 3766.02,-17293.89 3768.14,-17300.56"/>
</g>
<!-- out_proj0_1 -->
<g id="node548" class="node">
<title>out_proj0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3952,-17152.11 3746,-17152.11 3746,-17099.11 3952,-17099.11 3952,-17152.11"/>
<text text-anchor="middle" x="3849" y="-17136.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3849" y="-17121.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3849" y="-17106.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- accum0_1&#45;&gt;out_proj0_1 -->
<g id="edge764" class="edge">
<title>accum0_1&#45;&gt;out_proj0_1</title>
<path fill="none" stroke="black" d="M3370.55,-17231.73C3397.8,-17225.57 3426.22,-17219.55 3453,-17214.61 3569.46,-17193.14 3602.42,-17208.53 3717,-17178.61 3739.11,-17172.84 3762.54,-17164.42 3783.42,-17156.03"/>
<polygon fill="black" stroke="black" points="3784.89,-17159.21 3792.82,-17152.18 3782.24,-17152.73 3784.89,-17159.21"/>
</g>
<!-- out_proj0_2 -->
<g id="node549" class="node">
<title>out_proj0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1215,-17010.11 1009,-17010.11 1009,-16957.11 1215,-16957.11 1215,-17010.11"/>
<text text-anchor="middle" x="1112" y="-16994.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1112" y="-16979.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1112" y="-16964.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- accum0_2&#45;&gt;out_proj0_2 -->
<g id="edge773" class="edge">
<title>accum0_2&#45;&gt;out_proj0_2</title>
<path fill="none" stroke="black" d="M1113.26,-17072.48C1113.01,-17055.17 1112.74,-17036.3 1112.51,-17020.5"/>
<polygon fill="black" stroke="black" points="1116.01,-17020.06 1112.36,-17010.11 1109.01,-17020.16 1116.01,-17020.06"/>
</g>
<!-- out_proj0_3 -->
<g id="node550" class="node">
<title>out_proj0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1550,-16868.11 1344,-16868.11 1344,-16815.11 1550,-16815.11 1550,-16868.11"/>
<text text-anchor="middle" x="1447" y="-16852.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1447" y="-16837.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1447" y="-16822.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- accum0_3&#45;&gt;out_proj0_3 -->
<g id="edge782" class="edge">
<title>accum0_3&#45;&gt;out_proj0_3</title>
<path fill="none" stroke="black" d="M1447,-16930.48C1447,-16913.17 1447,-16894.3 1447,-16878.5"/>
<polygon fill="black" stroke="black" points="1450.5,-16878.11 1447,-16868.11 1443.5,-16878.11 1450.5,-16878.11"/>
</g>
<!-- out_proj0_4 -->
<g id="node551" class="node">
<title>out_proj0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1828,-16726.11 1622,-16726.11 1622,-16673.11 1828,-16673.11 1828,-16726.11"/>
<text text-anchor="middle" x="1725" y="-16710.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1725" y="-16695.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="1725" y="-16680.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- accum0_4&#45;&gt;out_proj0_4 -->
<g id="edge791" class="edge">
<title>accum0_4&#45;&gt;out_proj0_4</title>
<path fill="none" stroke="black" d="M1760.78,-16788.48C1753.59,-16770.84 1745.75,-16751.58 1739.24,-16735.59"/>
<polygon fill="black" stroke="black" points="1742.39,-16734.05 1735.38,-16726.11 1735.91,-16736.69 1742.39,-16734.05"/>
</g>
<!-- out_proj0_5 -->
<g id="node552" class="node">
<title>out_proj0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2268,-16584.11 2062,-16584.11 2062,-16531.11 2268,-16531.11 2268,-16584.11"/>
<text text-anchor="middle" x="2165" y="-16568.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2165" y="-16553.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2165" y="-16538.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- accum0_5&#45;&gt;out_proj0_5 -->
<g id="edge800" class="edge">
<title>accum0_5&#45;&gt;out_proj0_5</title>
<path fill="none" stroke="black" d="M2130.48,-16646.48C2137.41,-16628.84 2144.98,-16609.58 2151.26,-16593.59"/>
<polygon fill="black" stroke="black" points="2154.58,-16594.7 2154.98,-16584.11 2148.07,-16592.14 2154.58,-16594.7"/>
</g>
<!-- out_proj0_6 -->
<g id="node553" class="node">
<title>out_proj0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2834,-16442.11 2628,-16442.11 2628,-16389.11 2834,-16389.11 2834,-16442.11"/>
<text text-anchor="middle" x="2731" y="-16426.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2731" y="-16411.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="2731" y="-16396.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- accum0_6&#45;&gt;out_proj0_6 -->
<g id="edge809" class="edge">
<title>accum0_6&#45;&gt;out_proj0_6</title>
<path fill="none" stroke="black" d="M2660.08,-16504.48C2674.72,-16486.34 2690.74,-16466.49 2703.85,-16450.25"/>
<polygon fill="black" stroke="black" points="2706.86,-16452.09 2710.42,-16442.11 2701.41,-16447.69 2706.86,-16452.09"/>
</g>
<!-- out_proj0_7 -->
<g id="node554" class="node">
<title>out_proj0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3220,-16300.11 3014,-16300.11 3014,-16247.11 3220,-16247.11 3220,-16300.11"/>
<text text-anchor="middle" x="3117" y="-16284.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3117" y="-16269.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3117" y="-16254.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- accum0_7&#45;&gt;out_proj0_7 -->
<g id="edge818" class="edge">
<title>accum0_7&#45;&gt;out_proj0_7</title>
<path fill="none" stroke="black" d="M3084.99,-16362.48C3091.42,-16344.84 3098.43,-16325.58 3104.26,-16309.59"/>
<polygon fill="black" stroke="black" points="3107.58,-16310.7 3107.71,-16300.11 3101,-16308.31 3107.58,-16310.7"/>
</g>
<!-- out_proj0_8 -->
<g id="node555" class="node">
<title>out_proj0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3952,-16158.11 3746,-16158.11 3746,-16105.11 3952,-16105.11 3952,-16158.11"/>
<text text-anchor="middle" x="3849" y="-16142.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3849" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3849" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- accum0_8&#45;&gt;out_proj0_8 -->
<g id="edge827" class="edge">
<title>accum0_8&#45;&gt;out_proj0_8</title>
<path fill="none" stroke="black" d="M3592.15,-16237.04C3638.84,-16223.75 3690.72,-16207.39 3737,-16189.11 3755.97,-16181.62 3776.06,-16172.04 3793.9,-16162.91"/>
<polygon fill="black" stroke="black" points="3795.74,-16165.9 3803.01,-16158.19 3792.52,-16159.69 3795.74,-16165.9"/>
</g>
<!-- out_proj0_9 -->
<g id="node556" class="node">
<title>out_proj0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3784,-16016.11 3578,-16016.11 3578,-15963.11 3784,-15963.11 3784,-16016.11"/>
<text text-anchor="middle" x="3681" y="-16000.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3681" y="-15985.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3681" y="-15970.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- accum0_9&#45;&gt;out_proj0_9 -->
<g id="edge836" class="edge">
<title>accum0_9&#45;&gt;out_proj0_9</title>
<path fill="none" stroke="black" d="M3576.18,-16078.48C3598.52,-16059.76 3623.03,-16039.21 3642.73,-16022.69"/>
<polygon fill="black" stroke="black" points="3645.17,-16025.22 3650.58,-16016.11 3640.67,-16019.85 3645.17,-16025.22"/>
</g>
<!-- out_proj0_10 -->
<g id="node557" class="node">
<title>out_proj0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3706,-15871.11 3500,-15871.11 3500,-15818.11 3706,-15818.11 3706,-15871.11"/>
<text text-anchor="middle" x="3603" y="-15855.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3603" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3603" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- accum0_10&#45;&gt;out_proj0_10 -->
<g id="edge845" class="edge">
<title>accum0_10&#45;&gt;out_proj0_10</title>
<path fill="none" stroke="black" d="M3233.2,-15949.91C3318.27,-15925.92 3425.66,-15895.63 3502.76,-15873.88"/>
<polygon fill="black" stroke="black" points="3503.81,-15877.22 3512.48,-15871.14 3501.91,-15870.49 3503.81,-15877.22"/>
</g>
<!-- out_proj0_11 -->
<g id="node558" class="node">
<title>out_proj0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3614,-15729.11 3408,-15729.11 3408,-15676.11 3614,-15676.11 3614,-15729.11"/>
<text text-anchor="middle" x="3511" y="-15713.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3511" y="-15698.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3511" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- accum0_11&#45;&gt;out_proj0_11 -->
<g id="edge854" class="edge">
<title>accum0_11&#45;&gt;out_proj0_11</title>
<path fill="none" stroke="black" d="M2981.59,-15813.58C3106.18,-15787.7 3283.55,-15750.86 3397.97,-15727.09"/>
<polygon fill="black" stroke="black" points="3398.73,-15730.51 3407.81,-15725.04 3397.31,-15723.65 3398.73,-15730.51"/>
</g>
<!-- out_proj0_12 -->
<g id="node559" class="node">
<title>out_proj0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3892,-17862.11 3686,-17862.11 3686,-17809.11 3892,-17809.11 3892,-17862.11"/>
<text text-anchor="middle" x="3789" y="-17846.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3789" y="-17831.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3789" y="-17816.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- accum0_12&#45;&gt;out_proj0_12 -->
<g id="edge863" class="edge">
<title>accum0_12&#45;&gt;out_proj0_12</title>
<path fill="none" stroke="black" d="M3719.33,-17924.48C3733.71,-17906.34 3749.46,-17886.49 3762.33,-17870.25"/>
<polygon fill="black" stroke="black" points="3765.31,-17872.12 3768.78,-17862.11 3759.83,-17867.77 3765.31,-17872.12"/>
</g>
<!-- out_proj0_13 -->
<g id="node560" class="node">
<title>out_proj0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3600,-17720.11 3394,-17720.11 3394,-17667.11 3600,-17667.11 3600,-17720.11"/>
<text text-anchor="middle" x="3497" y="-17704.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3497" y="-17689.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3497" y="-17674.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- accum0_13&#45;&gt;out_proj0_13 -->
<g id="edge872" class="edge">
<title>accum0_13&#45;&gt;out_proj0_13</title>
<path fill="none" stroke="black" d="M3402.23,-17782.48C3422.33,-17763.84 3444.39,-17743.39 3462.16,-17726.91"/>
<polygon fill="black" stroke="black" points="3464.54,-17729.48 3469.5,-17720.11 3459.78,-17724.34 3464.54,-17729.48"/>
</g>
<!-- out_proj0_14 -->
<g id="node561" class="node">
<title>out_proj0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3932,-17578.11 3726,-17578.11 3726,-17525.11 3932,-17525.11 3932,-17578.11"/>
<text text-anchor="middle" x="3829" y="-17562.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3829" y="-17547.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3829" y="-17532.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- accum0_14&#45;&gt;out_proj0_14 -->
<g id="edge881" class="edge">
<title>accum0_14&#45;&gt;out_proj0_14</title>
<path fill="none" stroke="black" d="M3302.53,-17657.65C3329.79,-17651.49 3358.21,-17645.49 3385,-17640.61 3504.97,-17618.74 3537.8,-17630.34 3657,-17604.61 3685.78,-17598.4 3716.71,-17589.7 3744.3,-17581.19"/>
<polygon fill="black" stroke="black" points="3745.41,-17584.51 3753.91,-17578.2 3743.33,-17577.83 3745.41,-17584.51"/>
</g>
<!-- out_proj0_15 -->
<g id="node562" class="node">
<title>out_proj0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3932,-17436.11 3726,-17436.11 3726,-17383.11 3932,-17383.11 3932,-17436.11"/>
<text text-anchor="middle" x="3829" y="-17420.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3829" y="-17405.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="3829" y="-17390.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- accum0_15&#45;&gt;out_proj0_15 -->
<g id="edge890" class="edge">
<title>accum0_15&#45;&gt;out_proj0_15</title>
<path fill="none" stroke="black" d="M3564.98,-17504.19C3625.13,-17482.87 3694.59,-17458.25 3747.17,-17439.61"/>
<polygon fill="black" stroke="black" points="3748.53,-17442.84 3756.79,-17436.21 3746.19,-17436.25 3748.53,-17442.84"/>
</g>
<!-- out_proj0_0&#45;&gt;res_attn0_0 -->
<g id="edge756" class="edge">
<title>out_proj0_0&#45;&gt;res_attn0_0</title>
<path fill="none" stroke="black" d="M3952.22,-17265.41C4606.91,-17257.12 8154,-17202.17 8154,-16984.61 8154,-16984.61 8154,-16984.61 8154,-16130.61 8154,-16053.81 8147.77,-15965.57 8142.86,-15907.87"/>
<polygon fill="black" stroke="black" points="8146.33,-15907.48 8141.99,-15897.82 8139.36,-15908.09 8146.33,-15907.48"/>
</g>
<!-- out_proj0_1&#45;&gt;res_attn0_1 -->
<g id="edge765" class="edge">
<title>out_proj0_1&#45;&gt;res_attn0_1</title>
<path fill="none" stroke="black" d="M3952.1,-17123.35C4603.06,-17114.72 8116,-17058.17 8116,-16842.61 8116,-16842.61 8116,-16842.61 8116,-16556.61 8116,-16259.16 8164.37,-16153.42 8368,-15936.61 8383.53,-15920.08 8402.69,-15906.2 8422.79,-15894.67"/>
<polygon fill="black" stroke="black" points="8424.72,-15897.61 8431.77,-15889.7 8421.33,-15891.48 8424.72,-15897.61"/>
</g>
<!-- out_proj0_2&#45;&gt;res_attn0_2 -->
<g id="edge774" class="edge">
<title>out_proj0_2&#45;&gt;res_attn0_2</title>
<path fill="none" stroke="black" d="M1148.47,-16956.82C1207.15,-16911.99 1316,-16813.61 1316,-16700.61 1316,-16700.61 1316,-16700.61 1316,-16414.61 1316,-16165.43 1391.65,-16058.47 1609,-15936.61 1631.95,-15923.74 9161.15,-15933.55 9187,-15928.61 9217.49,-15922.79 9249.21,-15912.63 9278.48,-15901.37"/>
<polygon fill="black" stroke="black" points="9279.86,-15904.59 9287.89,-15897.68 9277.3,-15898.07 9279.86,-15904.59"/>
</g>
<!-- out_proj0_3&#45;&gt;res_attn0_3 -->
<g id="edge783" class="edge">
<title>out_proj0_3&#45;&gt;res_attn0_3</title>
<path fill="none" stroke="black" d="M1462.53,-16814.83C1490.16,-16766.43 1545,-16657.87 1545,-16558.61 1545,-16558.61 1545,-16558.61 1545,-16130.61 1545,-15939.9 2191.54,-15958.41 2381,-15936.61 2480.7,-15925.14 9508.42,-15947.44 9607,-15928.61 9637.49,-15922.79 9669.21,-15912.62 9698.48,-15901.37"/>
<polygon fill="black" stroke="black" points="9699.86,-15904.58 9707.89,-15897.68 9697.3,-15898.07 9699.86,-15904.58"/>
</g>
<!-- out_proj0_4&#45;&gt;res_attn0_4 -->
<g id="edge792" class="edge">
<title>out_proj0_4&#45;&gt;res_attn0_4</title>
<path fill="none" stroke="black" d="M1633.29,-16673.04C1523.43,-16636.15 1354,-16556.58 1354,-16416.61 1354,-16416.61 1354,-16416.61 1354,-16130.61 1354,-16013.89 1424.24,-15983.79 1531,-15936.61 1553.98,-15926.45 8742.32,-15933.32 8767,-15928.61 8797.49,-15922.79 8829.21,-15912.62 8858.48,-15901.37"/>
<polygon fill="black" stroke="black" points="8859.86,-15904.58 8867.89,-15897.68 8857.3,-15898.07 8859.86,-15904.58"/>
</g>
<!-- out_proj0_5&#45;&gt;res_attn0_5 -->
<g id="edge801" class="edge">
<title>out_proj0_5&#45;&gt;res_attn0_5</title>
<path fill="none" stroke="black" d="M2167.41,-16530.92C2176.73,-16447.92 2218.47,-16186.14 2381,-16078.61 2390.1,-16072.59 8651.09,-15936.77 8662,-15936.61 8699.91,-15936.07 9989.77,-15935.81 10027,-15928.61 10057.39,-15922.73 10089.01,-15912.58 10118.21,-15901.36"/>
<polygon fill="black" stroke="black" points="10119.56,-15904.59 10127.6,-15897.68 10117.01,-15898.07 10119.56,-15904.59"/>
</g>
<!-- out_proj0_6&#45;&gt;res_attn0_6 -->
<g id="edge810" class="edge">
<title>out_proj0_6&#45;&gt;res_attn0_6</title>
<path fill="none" stroke="black" d="M2775.28,-16389.05C2795.29,-16378.83 2819.65,-16368.18 2843,-16362.61 3072.47,-16307.84 3668.34,-16337.56 3904,-16326.61 4974.71,-16276.88 7707.45,-16397.08 8719,-16042.61 8796.04,-16015.61 8791.24,-15961.45 8869,-15936.61 8900.99,-15926.39 11254.02,-15934.95 11287,-15928.61 11317.48,-15922.75 11349.2,-15912.58 11378.47,-15901.32"/>
<polygon fill="black" stroke="black" points="11379.85,-15904.54 11387.88,-15897.63 11377.29,-15898.02 11379.85,-15904.54"/>
</g>
<!-- out_proj0_7&#45;&gt;res_attn0_7 -->
<g id="edge819" class="edge">
<title>out_proj0_7&#45;&gt;res_attn0_7</title>
<path fill="none" stroke="black" d="M3161.27,-16247.04C3181.28,-16236.82 3205.64,-16226.17 3229,-16220.61 3375.89,-16185.64 8526.76,-16109.78 8662,-16042.61 8716.33,-16015.62 8693.29,-15962.83 8748,-15936.61 8769.28,-15926.41 10423.83,-15933.08 10447,-15928.61 10477.39,-15922.75 10509.01,-15912.61 10538.21,-15901.38"/>
<polygon fill="black" stroke="black" points="10539.57,-15904.61 10547.6,-15897.71 10537.02,-15898.09 10539.57,-15904.61"/>
</g>
<!-- out_proj0_8&#45;&gt;res_attn0_8 -->
<g id="edge828" class="edge">
<title>out_proj0_8&#45;&gt;res_attn0_8</title>
<path fill="none" stroke="black" d="M3952.1,-16130.09C4607.48,-16126.61 8180.51,-16104.9 8662,-16042.61 8859.35,-16017.08 8899.46,-15960.6 9097,-15936.61 9180.55,-15926.47 12044.34,-15944.47 12127,-15928.61 12157.49,-15922.76 12189.2,-15912.59 12218.47,-15901.33"/>
<polygon fill="black" stroke="black" points="12219.85,-15904.55 12227.89,-15897.64 12217.3,-15898.03 12219.85,-15904.55"/>
</g>
<!-- out_proj0_9&#45;&gt;res_attn0_9 -->
<g id="edge837" class="edge">
<title>out_proj0_9&#45;&gt;res_attn0_9</title>
<path fill="none" stroke="black" d="M3784.36,-15987.31C4313.56,-15980.73 6772.97,-15950.73 8786,-15936.61 8814.9,-15936.41 10838.62,-15934.07 10867,-15928.61 10897.48,-15922.74 10929.2,-15912.57 10958.47,-15901.31"/>
<polygon fill="black" stroke="black" points="10959.85,-15904.52 10967.88,-15897.62 10957.29,-15898.01 10959.85,-15904.52"/>
</g>
<!-- out_proj0_10&#45;&gt;res_attn0_10 -->
<g id="edge846" class="edge">
<title>out_proj0_10&#45;&gt;res_attn0_10</title>
<path fill="none" stroke="black" d="M3689.07,-15871.12C3763.41,-15892.56 3874.14,-15921.02 3973,-15932.61 3990.67,-15934.68 14200.54,-15935.99 14218,-15932.61 14251.87,-15926.06 14287.15,-15914.3 14319.24,-15901.47"/>
<polygon fill="black" stroke="black" points="14320.71,-15904.65 14328.65,-15897.64 14318.07,-15898.17 14320.71,-15904.65"/>
</g>
<!-- out_proj0_11&#45;&gt;res_attn0_11 -->
<g id="edge855" class="edge">
<title>out_proj0_11&#45;&gt;res_attn0_11</title>
<path fill="none" stroke="black" d="M3614.17,-15718.74C3705.8,-15731.4 3843.49,-15748.49 3964,-15755.61 4483.53,-15786.33 12769.53,-15727.93 13386.46,-15791.74"/>
<polygon fill="black" stroke="black" points="13386.23,-15795.24 13396.56,-15792.88 13387.02,-15788.28 13386.23,-15795.24"/>
</g>
<!-- out_proj0_12&#45;&gt;res_attn0_12 -->
<g id="edge864" class="edge">
<title>out_proj0_12&#45;&gt;res_attn0_12</title>
<path fill="none" stroke="black" d="M3892.09,-17831.61C4617.11,-17809.17 8921,-17653.75 8921,-17126.61 8921,-17126.61 8921,-17126.61 8921,-16698.61 8921,-16289.93 10485.14,-16080.67 12304,-15936.61 12387.24,-15930.02 13725.02,-15944.45 13807,-15928.61 13837.39,-15922.74 13869.01,-15912.59 13898.21,-15901.37"/>
<polygon fill="black" stroke="black" points="13899.57,-15904.6 13907.6,-15897.69 13897.01,-15898.08 13899.57,-15904.6"/>
</g>
<!-- out_proj0_13&#45;&gt;res_attn0_13 -->
<g id="edge873" class="edge">
<title>out_proj0_13&#45;&gt;res_attn0_13</title>
<path fill="none" stroke="black" d="M3600.13,-17692.56C4221.68,-17691.11 7472.81,-17666.84 8396,-17320.61 8591.4,-17247.33 8724,-17193.3 8724,-16984.61 8724,-16984.61 8724,-16984.61 8724,-16414.61 8724,-16164.5 8784.18,-16017.07 9021,-15936.61 9056.32,-15924.61 11670.36,-15935.64 11707,-15928.61 11737.48,-15922.76 11769.2,-15912.59 11798.47,-15901.32"/>
<polygon fill="black" stroke="black" points="11799.85,-15904.54 11807.88,-15897.63 11797.3,-15898.03 11799.85,-15904.54"/>
</g>
<!-- out_proj0_14&#45;&gt;res_attn0_14 -->
<g id="edge882" class="edge">
<title>out_proj0_14&#45;&gt;res_attn0_14</title>
<path fill="none" stroke="black" d="M3932.26,-17550.05C4644.46,-17544.87 8800,-17492.88 8800,-16984.61 8800,-16984.61 8800,-16984.61 8800,-16698.61 8800,-16131.32 9268.81,-16053.18 9824,-15936.61 9909.44,-15918.67 12881.26,-15945.05 12967,-15928.61 12997.49,-15922.76 13029.2,-15912.59 13058.47,-15901.33"/>
<polygon fill="black" stroke="black" points="13059.85,-15904.55 13067.89,-15897.64 13057.3,-15898.04 13059.85,-15904.55"/>
</g>
<!-- out_proj0_15&#45;&gt;res_attn0_15 -->
<g id="edge891" class="edge">
<title>out_proj0_15&#45;&gt;res_attn0_15</title>
<path fill="none" stroke="black" d="M3932.03,-17405.33C4640.43,-17382.08 8762,-17236.04 8762,-16984.61 8762,-16984.61 8762,-16984.61 8762,-16698.61 8762,-16313.82 8801.98,-16038.62 9173,-15936.61 9218.18,-15924.19 12500.98,-15937.43 12547,-15928.61 12577.49,-15922.77 12609.2,-15912.6 12638.47,-15901.34"/>
<polygon fill="black" stroke="black" points="12639.85,-15904.56 12647.89,-15897.65 12637.3,-15898.04 12639.85,-15904.56"/>
</g>
<!-- ffn1_0_0 -->
<g id="node563" class="node">
<title>ffn1_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14862.5,-16158.11 14663.5,-16158.11 14663.5,-16105.11 14862.5,-16105.11 14862.5,-16158.11"/>
<text text-anchor="middle" x="14763" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="14763" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="14763" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_0_0 -->
<g id="node579" class="node">
<title>act_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14797,-16008.61 14731,-16008.61 14731,-15970.61 14797,-15970.61 14797,-16008.61"/>
<text text-anchor="middle" x="14764" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14764" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_0_0&#45;&gt;act_0_0 -->
<g id="edge759" class="edge">
<title>ffn1_0_0&#45;&gt;act_0_0</title>
<path fill="none" stroke="black" d="M14763.18,-16104.93C14763.36,-16080.62 14763.62,-16044.19 14763.8,-16019.02"/>
<polygon fill="black" stroke="black" points="14767.3,-16019.01 14763.87,-16008.98 14760.3,-16018.96 14767.3,-16019.01"/>
</g>
<!-- ffn1_0_1 -->
<g id="node564" class="node">
<title>ffn1_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15083.5,-16158.11 14884.5,-16158.11 14884.5,-16105.11 15083.5,-16105.11 15083.5,-16158.11"/>
<text text-anchor="middle" x="14984" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="14984" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="14984" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_0_1 -->
<g id="node580" class="node">
<title>act_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15019,-16008.61 14953,-16008.61 14953,-15970.61 15019,-15970.61 15019,-16008.61"/>
<text text-anchor="middle" x="14986" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14986" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_0_1&#45;&gt;act_0_1 -->
<g id="edge768" class="edge">
<title>ffn1_0_1&#45;&gt;act_0_1</title>
<path fill="none" stroke="black" d="M14984.37,-16104.93C14984.71,-16080.62 14985.23,-16044.19 14985.59,-16019.02"/>
<polygon fill="black" stroke="black" points="14989.09,-16019.03 14985.74,-16008.98 14982.09,-16018.93 14989.09,-16019.03"/>
</g>
<!-- ffn1_0_2 -->
<g id="node565" class="node">
<title>ffn1_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15529.5,-16158.11 15330.5,-16158.11 15330.5,-16105.11 15529.5,-16105.11 15529.5,-16158.11"/>
<text text-anchor="middle" x="15430" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="15430" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="15430" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_0_2 -->
<g id="node581" class="node">
<title>act_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15466,-16008.61 15400,-16008.61 15400,-15970.61 15466,-15970.61 15466,-16008.61"/>
<text text-anchor="middle" x="15433" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15433" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_0_2&#45;&gt;act_0_2 -->
<g id="edge777" class="edge">
<title>ffn1_0_2&#45;&gt;act_0_2</title>
<path fill="none" stroke="black" d="M15430.55,-16104.93C15431.07,-16080.62 15431.85,-16044.19 15432.39,-16019.02"/>
<polygon fill="black" stroke="black" points="15435.89,-16019.06 15432.61,-16008.98 15428.89,-16018.91 15435.89,-16019.06"/>
</g>
<!-- ffn1_0_3 -->
<g id="node566" class="node">
<title>ffn1_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15753.5,-16158.11 15554.5,-16158.11 15554.5,-16105.11 15753.5,-16105.11 15753.5,-16158.11"/>
<text text-anchor="middle" x="15654" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="15654" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="15654" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_0_3 -->
<g id="node582" class="node">
<title>act_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15690,-16008.61 15624,-16008.61 15624,-15970.61 15690,-15970.61 15690,-16008.61"/>
<text text-anchor="middle" x="15657" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15657" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_0_3&#45;&gt;act_0_3 -->
<g id="edge786" class="edge">
<title>ffn1_0_3&#45;&gt;act_0_3</title>
<path fill="none" stroke="black" d="M15654.55,-16104.93C15655.07,-16080.62 15655.85,-16044.19 15656.39,-16019.02"/>
<polygon fill="black" stroke="black" points="15659.89,-16019.06 15656.61,-16008.98 15652.89,-16018.91 15659.89,-16019.06"/>
</g>
<!-- ffn1_0_4 -->
<g id="node567" class="node">
<title>ffn1_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15306.5,-16158.11 15107.5,-16158.11 15107.5,-16105.11 15306.5,-16105.11 15306.5,-16158.11"/>
<text text-anchor="middle" x="15207" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="15207" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="15207" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_0_4 -->
<g id="node583" class="node">
<title>act_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15243,-16008.61 15177,-16008.61 15177,-15970.61 15243,-15970.61 15243,-16008.61"/>
<text text-anchor="middle" x="15210" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15210" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_0_4&#45;&gt;act_0_4 -->
<g id="edge795" class="edge">
<title>ffn1_0_4&#45;&gt;act_0_4</title>
<path fill="none" stroke="black" d="M15207.55,-16104.93C15208.07,-16080.62 15208.85,-16044.19 15209.39,-16019.02"/>
<polygon fill="black" stroke="black" points="15212.89,-16019.06 15209.61,-16008.98 15205.89,-16018.91 15212.89,-16019.06"/>
</g>
<!-- ffn1_0_5 -->
<g id="node568" class="node">
<title>ffn1_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15977.5,-16158.11 15778.5,-16158.11 15778.5,-16105.11 15977.5,-16105.11 15977.5,-16158.11"/>
<text text-anchor="middle" x="15878" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="15878" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="15878" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_0_5 -->
<g id="node584" class="node">
<title>act_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15914,-16008.61 15848,-16008.61 15848,-15970.61 15914,-15970.61 15914,-16008.61"/>
<text text-anchor="middle" x="15881" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15881" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_0_5&#45;&gt;act_0_5 -->
<g id="edge804" class="edge">
<title>ffn1_0_5&#45;&gt;act_0_5</title>
<path fill="none" stroke="black" d="M15878.55,-16104.93C15879.07,-16080.62 15879.85,-16044.19 15880.39,-16019.02"/>
<polygon fill="black" stroke="black" points="15883.89,-16019.06 15880.61,-16008.98 15876.89,-16018.91 15883.89,-16019.06"/>
</g>
<!-- ffn1_0_6 -->
<g id="node569" class="node">
<title>ffn1_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16649.5,-16158.11 16450.5,-16158.11 16450.5,-16105.11 16649.5,-16105.11 16649.5,-16158.11"/>
<text text-anchor="middle" x="16550" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="16550" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="16550" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_0_6 -->
<g id="node585" class="node">
<title>act_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16586,-16008.61 16520,-16008.61 16520,-15970.61 16586,-15970.61 16586,-16008.61"/>
<text text-anchor="middle" x="16553" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16553" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_0_6&#45;&gt;act_0_6 -->
<g id="edge813" class="edge">
<title>ffn1_0_6&#45;&gt;act_0_6</title>
<path fill="none" stroke="black" d="M16550.55,-16104.93C16551.07,-16080.62 16551.85,-16044.19 16552.39,-16019.02"/>
<polygon fill="black" stroke="black" points="16555.89,-16019.06 16552.61,-16008.98 16548.89,-16018.91 16555.89,-16019.06"/>
</g>
<!-- ffn1_0_7 -->
<g id="node570" class="node">
<title>ffn1_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16201.5,-16158.11 16002.5,-16158.11 16002.5,-16105.11 16201.5,-16105.11 16201.5,-16158.11"/>
<text text-anchor="middle" x="16102" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="16102" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="16102" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_0_7 -->
<g id="node586" class="node">
<title>act_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16138,-16008.61 16072,-16008.61 16072,-15970.61 16138,-15970.61 16138,-16008.61"/>
<text text-anchor="middle" x="16105" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16105" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_0_7&#45;&gt;act_0_7 -->
<g id="edge822" class="edge">
<title>ffn1_0_7&#45;&gt;act_0_7</title>
<path fill="none" stroke="black" d="M16102.55,-16104.93C16103.07,-16080.62 16103.85,-16044.19 16104.39,-16019.02"/>
<polygon fill="black" stroke="black" points="16107.89,-16019.06 16104.61,-16008.98 16100.89,-16018.91 16107.89,-16019.06"/>
</g>
<!-- ffn1_0_8 -->
<g id="node571" class="node">
<title>ffn1_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17097.5,-16158.11 16898.5,-16158.11 16898.5,-16105.11 17097.5,-16105.11 17097.5,-16158.11"/>
<text text-anchor="middle" x="16998" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="16998" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="16998" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_0_8 -->
<g id="node587" class="node">
<title>act_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17034,-16008.61 16968,-16008.61 16968,-15970.61 17034,-15970.61 17034,-16008.61"/>
<text text-anchor="middle" x="17001" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17001" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_0_8&#45;&gt;act_0_8 -->
<g id="edge831" class="edge">
<title>ffn1_0_8&#45;&gt;act_0_8</title>
<path fill="none" stroke="black" d="M16998.55,-16104.93C16999.07,-16080.62 16999.85,-16044.19 17000.39,-16019.02"/>
<polygon fill="black" stroke="black" points="17003.89,-16019.06 17000.61,-16008.98 16996.89,-16018.91 17003.89,-16019.06"/>
</g>
<!-- ffn1_0_9 -->
<g id="node572" class="node">
<title>ffn1_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16425.5,-16158.11 16226.5,-16158.11 16226.5,-16105.11 16425.5,-16105.11 16425.5,-16158.11"/>
<text text-anchor="middle" x="16326" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="16326" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="16326" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_0_9 -->
<g id="node588" class="node">
<title>act_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16362,-16008.61 16296,-16008.61 16296,-15970.61 16362,-15970.61 16362,-16008.61"/>
<text text-anchor="middle" x="16329" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16329" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_0_9&#45;&gt;act_0_9 -->
<g id="edge840" class="edge">
<title>ffn1_0_9&#45;&gt;act_0_9</title>
<path fill="none" stroke="black" d="M16326.55,-16104.93C16327.07,-16080.62 16327.85,-16044.19 16328.39,-16019.02"/>
<polygon fill="black" stroke="black" points="16331.89,-16019.06 16328.61,-16008.98 16324.89,-16018.91 16331.89,-16019.06"/>
</g>
<!-- ffn1_0_10 -->
<g id="node573" class="node">
<title>ffn1_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18217.5,-16158.11 18018.5,-16158.11 18018.5,-16105.11 18217.5,-16105.11 18217.5,-16158.11"/>
<text text-anchor="middle" x="18118" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="18118" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="18118" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_0_10 -->
<g id="node589" class="node">
<title>act_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18158.5,-16008.61 18083.5,-16008.61 18083.5,-15970.61 18158.5,-15970.61 18158.5,-16008.61"/>
<text text-anchor="middle" x="18121" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18121" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_0_10&#45;&gt;act_0_10 -->
<g id="edge849" class="edge">
<title>ffn1_0_10&#45;&gt;act_0_10</title>
<path fill="none" stroke="black" d="M18118.55,-16104.93C18119.07,-16080.62 18119.85,-16044.19 18120.39,-16019.02"/>
<polygon fill="black" stroke="black" points="18123.89,-16019.06 18120.61,-16008.98 18116.89,-16018.91 18123.89,-16019.06"/>
</g>
<!-- ffn1_0_11 -->
<g id="node574" class="node">
<title>ffn1_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17769.5,-16158.11 17570.5,-16158.11 17570.5,-16105.11 17769.5,-16105.11 17769.5,-16158.11"/>
<text text-anchor="middle" x="17670" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="17670" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="17670" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_0_11 -->
<g id="node590" class="node">
<title>act_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17710.5,-16008.61 17635.5,-16008.61 17635.5,-15970.61 17710.5,-15970.61 17710.5,-16008.61"/>
<text text-anchor="middle" x="17673" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17673" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_0_11&#45;&gt;act_0_11 -->
<g id="edge858" class="edge">
<title>ffn1_0_11&#45;&gt;act_0_11</title>
<path fill="none" stroke="black" d="M17670.55,-16104.93C17671.07,-16080.62 17671.85,-16044.19 17672.39,-16019.02"/>
<polygon fill="black" stroke="black" points="17675.89,-16019.06 17672.61,-16008.98 17668.89,-16018.91 17675.89,-16019.06"/>
</g>
<!-- ffn1_0_12 -->
<g id="node575" class="node">
<title>ffn1_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17993.5,-16158.11 17794.5,-16158.11 17794.5,-16105.11 17993.5,-16105.11 17993.5,-16158.11"/>
<text text-anchor="middle" x="17894" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="17894" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="17894" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_0_12 -->
<g id="node591" class="node">
<title>act_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17934.5,-16008.61 17859.5,-16008.61 17859.5,-15970.61 17934.5,-15970.61 17934.5,-16008.61"/>
<text text-anchor="middle" x="17897" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17897" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_0_12&#45;&gt;act_0_12 -->
<g id="edge867" class="edge">
<title>ffn1_0_12&#45;&gt;act_0_12</title>
<path fill="none" stroke="black" d="M17894.55,-16104.93C17895.07,-16080.62 17895.85,-16044.19 17896.39,-16019.02"/>
<polygon fill="black" stroke="black" points="17899.89,-16019.06 17896.61,-16008.98 17892.89,-16018.91 17899.89,-16019.06"/>
</g>
<!-- ffn1_0_13 -->
<g id="node576" class="node">
<title>ffn1_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16873.5,-16158.11 16674.5,-16158.11 16674.5,-16105.11 16873.5,-16105.11 16873.5,-16158.11"/>
<text text-anchor="middle" x="16774" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="16774" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="16774" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_0_13 -->
<g id="node592" class="node">
<title>act_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16815.5,-16008.61 16740.5,-16008.61 16740.5,-15970.61 16815.5,-15970.61 16815.5,-16008.61"/>
<text text-anchor="middle" x="16778" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16778" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_0_13&#45;&gt;act_0_13 -->
<g id="edge876" class="edge">
<title>ffn1_0_13&#45;&gt;act_0_13</title>
<path fill="none" stroke="black" d="M16774.73,-16104.93C16775.43,-16080.62 16776.47,-16044.19 16777.19,-16019.02"/>
<polygon fill="black" stroke="black" points="16780.69,-16019.08 16777.48,-16008.98 16773.69,-16018.88 16780.69,-16019.08"/>
</g>
<!-- ffn1_0_14 -->
<g id="node577" class="node">
<title>ffn1_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17545.5,-16158.11 17346.5,-16158.11 17346.5,-16105.11 17545.5,-16105.11 17545.5,-16158.11"/>
<text text-anchor="middle" x="17446" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="17446" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="17446" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_0_14 -->
<g id="node593" class="node">
<title>act_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17486.5,-16008.61 17411.5,-16008.61 17411.5,-15970.61 17486.5,-15970.61 17486.5,-16008.61"/>
<text text-anchor="middle" x="17449" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17449" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_0_14&#45;&gt;act_0_14 -->
<g id="edge885" class="edge">
<title>ffn1_0_14&#45;&gt;act_0_14</title>
<path fill="none" stroke="black" d="M17446.55,-16104.93C17447.07,-16080.62 17447.85,-16044.19 17448.39,-16019.02"/>
<polygon fill="black" stroke="black" points="17451.89,-16019.06 17448.61,-16008.98 17444.89,-16018.91 17451.89,-16019.06"/>
</g>
<!-- ffn1_0_15 -->
<g id="node578" class="node">
<title>ffn1_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17321.5,-16158.11 17122.5,-16158.11 17122.5,-16105.11 17321.5,-16105.11 17321.5,-16158.11"/>
<text text-anchor="middle" x="17222" y="-16142.91" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="17222" y="-16127.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="17222" y="-16112.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_0_15 -->
<g id="node594" class="node">
<title>act_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17262.5,-16008.61 17187.5,-16008.61 17187.5,-15970.61 17262.5,-15970.61 17262.5,-16008.61"/>
<text text-anchor="middle" x="17225" y="-15993.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17225" y="-15978.41" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_0_15&#45;&gt;act_0_15 -->
<g id="edge894" class="edge">
<title>ffn1_0_15&#45;&gt;act_0_15</title>
<path fill="none" stroke="black" d="M17222.55,-16104.93C17223.07,-16080.62 17223.85,-16044.19 17224.39,-16019.02"/>
<polygon fill="black" stroke="black" points="17227.89,-16019.06 17224.61,-16008.98 17220.89,-16018.91 17227.89,-16019.06"/>
</g>
<!-- ffn2_0_0 -->
<g id="node595" class="node">
<title>ffn2_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14868,-15871.11 14662,-15871.11 14662,-15818.11 14868,-15818.11 14868,-15871.11"/>
<text text-anchor="middle" x="14765" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="14765" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14765" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_0_0&#45;&gt;ffn2_0_0 -->
<g id="edge760" class="edge">
<title>act_0_0&#45;&gt;ffn2_0_0</title>
<path fill="none" stroke="black" d="M14764.13,-15970.5C14764.28,-15948.24 14764.55,-15909.95 14764.75,-15881.61"/>
<polygon fill="black" stroke="black" points="14768.25,-15881.32 14764.82,-15871.3 14761.25,-15881.27 14768.25,-15881.32"/>
</g>
<!-- ffn2_0_1 -->
<g id="node596" class="node">
<title>ffn2_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15092,-15871.11 14886,-15871.11 14886,-15818.11 15092,-15818.11 15092,-15871.11"/>
<text text-anchor="middle" x="14989" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="14989" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14989" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_0_1&#45;&gt;ffn2_0_1 -->
<g id="edge769" class="edge">
<title>act_0_1&#45;&gt;ffn2_0_1</title>
<path fill="none" stroke="black" d="M14986.38,-15970.5C14986.85,-15948.24 14987.65,-15909.95 14988.24,-15881.61"/>
<polygon fill="black" stroke="black" points="14991.75,-15881.37 14988.46,-15871.3 14984.75,-15881.22 14991.75,-15881.37"/>
</g>
<!-- ffn2_0_2 -->
<g id="node597" class="node">
<title>ffn2_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15540,-15871.11 15334,-15871.11 15334,-15818.11 15540,-15818.11 15540,-15871.11"/>
<text text-anchor="middle" x="15437" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="15437" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15437" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_0_2&#45;&gt;ffn2_0_2 -->
<g id="edge778" class="edge">
<title>act_0_2&#45;&gt;ffn2_0_2</title>
<path fill="none" stroke="black" d="M15433.51,-15970.5C15434.13,-15948.24 15435.2,-15909.95 15435.99,-15881.61"/>
<polygon fill="black" stroke="black" points="15439.5,-15881.39 15436.28,-15871.3 15432.5,-15881.2 15439.5,-15881.39"/>
</g>
<!-- ffn2_0_3 -->
<g id="node598" class="node">
<title>ffn2_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15764,-15871.11 15558,-15871.11 15558,-15818.11 15764,-15818.11 15764,-15871.11"/>
<text text-anchor="middle" x="15661" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="15661" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15661" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_0_3&#45;&gt;ffn2_0_3 -->
<g id="edge787" class="edge">
<title>act_0_3&#45;&gt;ffn2_0_3</title>
<path fill="none" stroke="black" d="M15657.51,-15970.5C15658.13,-15948.24 15659.2,-15909.95 15659.99,-15881.61"/>
<polygon fill="black" stroke="black" points="15663.5,-15881.39 15660.28,-15871.3 15656.5,-15881.2 15663.5,-15881.39"/>
</g>
<!-- ffn2_0_4 -->
<g id="node599" class="node">
<title>ffn2_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15316,-15871.11 15110,-15871.11 15110,-15818.11 15316,-15818.11 15316,-15871.11"/>
<text text-anchor="middle" x="15213" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="15213" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15213" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_0_4&#45;&gt;ffn2_0_4 -->
<g id="edge796" class="edge">
<title>act_0_4&#45;&gt;ffn2_0_4</title>
<path fill="none" stroke="black" d="M15210.38,-15970.5C15210.85,-15948.24 15211.65,-15909.95 15212.24,-15881.61"/>
<polygon fill="black" stroke="black" points="15215.75,-15881.37 15212.46,-15871.3 15208.75,-15881.22 15215.75,-15881.37"/>
</g>
<!-- ffn2_0_5 -->
<g id="node600" class="node">
<title>ffn2_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15988,-15871.11 15782,-15871.11 15782,-15818.11 15988,-15818.11 15988,-15871.11"/>
<text text-anchor="middle" x="15885" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="15885" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15885" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_0_5&#45;&gt;ffn2_0_5 -->
<g id="edge805" class="edge">
<title>act_0_5&#45;&gt;ffn2_0_5</title>
<path fill="none" stroke="black" d="M15881.51,-15970.5C15882.13,-15948.24 15883.2,-15909.95 15883.99,-15881.61"/>
<polygon fill="black" stroke="black" points="15887.5,-15881.39 15884.28,-15871.3 15880.5,-15881.2 15887.5,-15881.39"/>
</g>
<!-- ffn2_0_6 -->
<g id="node601" class="node">
<title>ffn2_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16660,-15871.11 16454,-15871.11 16454,-15818.11 16660,-15818.11 16660,-15871.11"/>
<text text-anchor="middle" x="16557" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="16557" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16557" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_0_6&#45;&gt;ffn2_0_6 -->
<g id="edge814" class="edge">
<title>act_0_6&#45;&gt;ffn2_0_6</title>
<path fill="none" stroke="black" d="M16553.51,-15970.5C16554.13,-15948.24 16555.2,-15909.95 16555.99,-15881.61"/>
<polygon fill="black" stroke="black" points="16559.5,-15881.39 16556.28,-15871.3 16552.5,-15881.2 16559.5,-15881.39"/>
</g>
<!-- ffn2_0_7 -->
<g id="node602" class="node">
<title>ffn2_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16212,-15871.11 16006,-15871.11 16006,-15818.11 16212,-15818.11 16212,-15871.11"/>
<text text-anchor="middle" x="16109" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="16109" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16109" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_0_7&#45;&gt;ffn2_0_7 -->
<g id="edge823" class="edge">
<title>act_0_7&#45;&gt;ffn2_0_7</title>
<path fill="none" stroke="black" d="M16105.51,-15970.5C16106.13,-15948.24 16107.2,-15909.95 16107.99,-15881.61"/>
<polygon fill="black" stroke="black" points="16111.5,-15881.39 16108.28,-15871.3 16104.5,-15881.2 16111.5,-15881.39"/>
</g>
<!-- ffn2_0_8 -->
<g id="node603" class="node">
<title>ffn2_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17108,-15871.11 16902,-15871.11 16902,-15818.11 17108,-15818.11 17108,-15871.11"/>
<text text-anchor="middle" x="17005" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="17005" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17005" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_0_8&#45;&gt;ffn2_0_8 -->
<g id="edge832" class="edge">
<title>act_0_8&#45;&gt;ffn2_0_8</title>
<path fill="none" stroke="black" d="M17001.51,-15970.5C17002.13,-15948.24 17003.2,-15909.95 17003.99,-15881.61"/>
<polygon fill="black" stroke="black" points="17007.5,-15881.39 17004.28,-15871.3 17000.5,-15881.2 17007.5,-15881.39"/>
</g>
<!-- ffn2_0_9 -->
<g id="node604" class="node">
<title>ffn2_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16436,-15871.11 16230,-15871.11 16230,-15818.11 16436,-15818.11 16436,-15871.11"/>
<text text-anchor="middle" x="16333" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="16333" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16333" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_0_9&#45;&gt;ffn2_0_9 -->
<g id="edge841" class="edge">
<title>act_0_9&#45;&gt;ffn2_0_9</title>
<path fill="none" stroke="black" d="M16329.51,-15970.5C16330.13,-15948.24 16331.2,-15909.95 16331.99,-15881.61"/>
<polygon fill="black" stroke="black" points="16335.5,-15881.39 16332.28,-15871.3 16328.5,-15881.2 16335.5,-15881.39"/>
</g>
<!-- ffn2_0_10 -->
<g id="node605" class="node">
<title>ffn2_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18228,-15871.11 18022,-15871.11 18022,-15818.11 18228,-15818.11 18228,-15871.11"/>
<text text-anchor="middle" x="18125" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="18125" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18125" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_0_10&#45;&gt;ffn2_0_10 -->
<g id="edge850" class="edge">
<title>act_0_10&#45;&gt;ffn2_0_10</title>
<path fill="none" stroke="black" d="M18121.51,-15970.5C18122.13,-15948.24 18123.2,-15909.95 18123.99,-15881.61"/>
<polygon fill="black" stroke="black" points="18127.5,-15881.39 18124.28,-15871.3 18120.5,-15881.2 18127.5,-15881.39"/>
</g>
<!-- ffn2_0_11 -->
<g id="node606" class="node">
<title>ffn2_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17780,-15871.11 17574,-15871.11 17574,-15818.11 17780,-15818.11 17780,-15871.11"/>
<text text-anchor="middle" x="17677" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="17677" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17677" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_0_11&#45;&gt;ffn2_0_11 -->
<g id="edge859" class="edge">
<title>act_0_11&#45;&gt;ffn2_0_11</title>
<path fill="none" stroke="black" d="M17673.51,-15970.5C17674.13,-15948.24 17675.2,-15909.95 17675.99,-15881.61"/>
<polygon fill="black" stroke="black" points="17679.5,-15881.39 17676.28,-15871.3 17672.5,-15881.2 17679.5,-15881.39"/>
</g>
<!-- ffn2_0_12 -->
<g id="node607" class="node">
<title>ffn2_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18004,-15871.11 17798,-15871.11 17798,-15818.11 18004,-15818.11 18004,-15871.11"/>
<text text-anchor="middle" x="17901" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="17901" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17901" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_0_12&#45;&gt;ffn2_0_12 -->
<g id="edge868" class="edge">
<title>act_0_12&#45;&gt;ffn2_0_12</title>
<path fill="none" stroke="black" d="M17897.51,-15970.5C17898.13,-15948.24 17899.2,-15909.95 17899.99,-15881.61"/>
<polygon fill="black" stroke="black" points="17903.5,-15881.39 17900.28,-15871.3 17896.5,-15881.2 17903.5,-15881.39"/>
</g>
<!-- ffn2_0_13 -->
<g id="node608" class="node">
<title>ffn2_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16884,-15871.11 16678,-15871.11 16678,-15818.11 16884,-15818.11 16884,-15871.11"/>
<text text-anchor="middle" x="16781" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="16781" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16781" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_0_13&#45;&gt;ffn2_0_13 -->
<g id="edge877" class="edge">
<title>act_0_13&#45;&gt;ffn2_0_13</title>
<path fill="none" stroke="black" d="M16778.38,-15970.5C16778.85,-15948.24 16779.65,-15909.95 16780.24,-15881.61"/>
<polygon fill="black" stroke="black" points="16783.75,-15881.37 16780.46,-15871.3 16776.75,-15881.22 16783.75,-15881.37"/>
</g>
<!-- ffn2_0_14 -->
<g id="node609" class="node">
<title>ffn2_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17556,-15871.11 17350,-15871.11 17350,-15818.11 17556,-15818.11 17556,-15871.11"/>
<text text-anchor="middle" x="17453" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="17453" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17453" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_0_14&#45;&gt;ffn2_0_14 -->
<g id="edge886" class="edge">
<title>act_0_14&#45;&gt;ffn2_0_14</title>
<path fill="none" stroke="black" d="M17449.51,-15970.5C17450.13,-15948.24 17451.2,-15909.95 17451.99,-15881.61"/>
<polygon fill="black" stroke="black" points="17455.5,-15881.39 17452.28,-15871.3 17448.5,-15881.2 17455.5,-15881.39"/>
</g>
<!-- ffn2_0_15 -->
<g id="node610" class="node">
<title>ffn2_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17332,-15871.11 17126,-15871.11 17126,-15818.11 17332,-15818.11 17332,-15871.11"/>
<text text-anchor="middle" x="17229" y="-15855.91" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="17229" y="-15840.91" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17229" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_0_15&#45;&gt;ffn2_0_15 -->
<g id="edge895" class="edge">
<title>act_0_15&#45;&gt;ffn2_0_15</title>
<path fill="none" stroke="black" d="M17225.51,-15970.5C17226.13,-15948.24 17227.2,-15909.95 17227.99,-15881.61"/>
<polygon fill="black" stroke="black" points="17231.5,-15881.39 17228.28,-15871.3 17224.5,-15881.2 17231.5,-15881.39"/>
</g>
<!-- res_ffn0_0 -->
<g id="node627" class="node">
<title>res_ffn0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8338.26,-15755.61 8018.1,-15755.61 7935.74,-15649.61 8255.9,-15649.61 8338.26,-15755.61"/>
<text text-anchor="middle" x="8137" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8137" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8137" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn2_0_0&#45;&gt;res_ffn0_0 -->
<g id="edge761" class="edge">
<title>ffn2_0_0&#45;&gt;res_ffn0_0</title>
<path fill="none" stroke="black" d="M14720.08,-15818.01C14699.43,-15807.65 14674.19,-15796.9 14650,-15791.61 14310.74,-15717.46 8787.3,-15797.65 8347.41,-15755.42"/>
<polygon fill="black" stroke="black" points="8347.76,-15751.94 8337.44,-15754.33 8347,-15758.9 8347.76,-15751.94"/>
</g>
<!-- res_ffn0_1 -->
<g id="node628" class="node">
<title>res_ffn0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8758.26,-15755.61 8438.1,-15755.61 8355.74,-15649.61 8675.9,-15649.61 8758.26,-15755.61"/>
<text text-anchor="middle" x="8557" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8557" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8557" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn2_0_1&#45;&gt;res_ffn0_1 -->
<g id="edge770" class="edge">
<title>ffn2_0_1&#45;&gt;res_ffn0_1</title>
<path fill="none" stroke="black" d="M14945.33,-15818.02C14925.23,-15807.66 14900.64,-15796.9 14877,-15791.61 14548.58,-15718.07 9196.46,-15796.34 8767.43,-15755.42"/>
<polygon fill="black" stroke="black" points="8767.76,-15751.93 8757.44,-15754.33 8767,-15758.89 8767.76,-15751.93"/>
</g>
<!-- res_ffn0_2 -->
<g id="node629" class="node">
<title>res_ffn0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9598.26,-15755.61 9278.1,-15755.61 9195.74,-15649.61 9515.9,-15649.61 9598.26,-15755.61"/>
<text text-anchor="middle" x="9397" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9397" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9397" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn2_0_2&#45;&gt;res_ffn0_2 -->
<g id="edge779" class="edge">
<title>ffn2_0_2&#45;&gt;res_ffn0_2</title>
<path fill="none" stroke="black" d="M15393.33,-15818.02C15373.23,-15807.66 15348.64,-15796.91 15325,-15791.61 15017.82,-15722.76 10013.83,-15793.76 9607.4,-15755.41"/>
<polygon fill="black" stroke="black" points="9607.76,-15751.92 9597.44,-15754.33 9607,-15758.88 9607.76,-15751.92"/>
</g>
<!-- res_ffn0_3 -->
<g id="node630" class="node">
<title>res_ffn0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10018.26,-15755.61 9698.1,-15755.61 9615.74,-15649.61 9935.9,-15649.61 10018.26,-15755.61"/>
<text text-anchor="middle" x="9817" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9817" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9817" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn2_0_3&#45;&gt;res_ffn0_3 -->
<g id="edge788" class="edge">
<title>ffn2_0_3&#45;&gt;res_ffn0_3</title>
<path fill="none" stroke="black" d="M15617.33,-15818.02C15597.23,-15807.66 15572.64,-15796.91 15549,-15791.61 15252.5,-15725.12 10424.64,-15792.44 10027.65,-15755.43"/>
<polygon fill="black" stroke="black" points="10027.75,-15751.92 10017.44,-15754.33 10027.01,-15758.88 10027.75,-15751.92"/>
</g>
<!-- res_ffn0_4 -->
<g id="node631" class="node">
<title>res_ffn0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9178.26,-15755.61 8858.1,-15755.61 8775.74,-15649.61 9095.9,-15649.61 9178.26,-15755.61"/>
<text text-anchor="middle" x="8977" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8977" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8977" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn2_0_4&#45;&gt;res_ffn0_4 -->
<g id="edge797" class="edge">
<title>ffn2_0_4&#45;&gt;res_ffn0_4</title>
<path fill="none" stroke="black" d="M15169.33,-15818.02C15149.23,-15807.66 15124.64,-15796.91 15101,-15791.61 14783.2,-15720.42 9605.23,-15795.05 9187.42,-15755.41"/>
<polygon fill="black" stroke="black" points="9187.76,-15751.93 9177.44,-15754.33 9187,-15758.89 9187.76,-15751.93"/>
</g>
<!-- res_ffn0_5 -->
<g id="node632" class="node">
<title>res_ffn0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10438.26,-15755.61 10118.1,-15755.61 10035.74,-15649.61 10355.9,-15649.61 10438.26,-15755.61"/>
<text text-anchor="middle" x="10237" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10237" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10237" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn2_0_5&#45;&gt;res_ffn0_5 -->
<g id="edge806" class="edge">
<title>ffn2_0_5&#45;&gt;res_ffn0_5</title>
<path fill="none" stroke="black" d="M15841.33,-15818.03C15821.23,-15807.67 15796.64,-15796.91 15773,-15791.61 15487.1,-15727.46 10832.82,-15791.16 10447.58,-15755.42"/>
<polygon fill="black" stroke="black" points="10447.75,-15751.91 10437.44,-15754.33 10447.01,-15758.87 10447.75,-15751.91"/>
</g>
<!-- res_ffn0_6 -->
<g id="node633" class="node">
<title>res_ffn0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11698.26,-15755.61 11378.1,-15755.61 11295.74,-15649.61 11615.9,-15649.61 11698.26,-15755.61"/>
<text text-anchor="middle" x="11497" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11497" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11497" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn2_0_6&#45;&gt;res_ffn0_6 -->
<g id="edge815" class="edge">
<title>ffn2_0_6&#45;&gt;res_ffn0_6</title>
<path fill="none" stroke="black" d="M16513.33,-15818.03C16493.23,-15807.68 16468.64,-15796.92 16445,-15791.61 16190.94,-15734.49 12058.38,-15787.31 11707.52,-15755.39"/>
<polygon fill="black" stroke="black" points="11707.75,-15751.9 11697.44,-15754.32 11707.01,-15758.86 11707.75,-15751.9"/>
</g>
<!-- res_ffn0_7 -->
<g id="node634" class="node">
<title>res_ffn0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10858.26,-15755.61 10538.1,-15755.61 10455.74,-15649.61 10775.9,-15649.61 10858.26,-15755.61"/>
<text text-anchor="middle" x="10657" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10657" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10657" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn2_0_7&#45;&gt;res_ffn0_7 -->
<g id="edge824" class="edge">
<title>ffn2_0_7&#45;&gt;res_ffn0_7</title>
<path fill="none" stroke="black" d="M16065.33,-15818.03C16045.23,-15807.67 16020.64,-15796.92 15997,-15791.61 15721.7,-15729.8 11240.83,-15789.88 10867.49,-15755.4"/>
<polygon fill="black" stroke="black" points="10867.75,-15751.91 10857.44,-15754.33 10867.01,-15758.87 10867.75,-15751.91"/>
</g>
<!-- res_ffn0_8 -->
<g id="node635" class="node">
<title>res_ffn0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12538.26,-15755.61 12218.1,-15755.61 12135.74,-15649.61 12455.9,-15649.61 12538.26,-15755.61"/>
<text text-anchor="middle" x="12337" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12337" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12337" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn2_0_8&#45;&gt;res_ffn0_8 -->
<g id="edge833" class="edge">
<title>ffn2_0_8&#45;&gt;res_ffn0_8</title>
<path fill="none" stroke="black" d="M16961.32,-15818.04C16941.22,-15807.69 16916.63,-15796.93 16893,-15791.61 16660.21,-15739.19 12876.78,-15784.74 12547.68,-15755.4"/>
<polygon fill="black" stroke="black" points="12547.75,-15751.89 12537.44,-15754.32 12547.02,-15758.85 12547.75,-15751.89"/>
</g>
<!-- res_ffn0_9 -->
<g id="node636" class="node">
<title>res_ffn0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11278.26,-15755.61 10958.1,-15755.61 10875.74,-15649.61 11195.9,-15649.61 11278.26,-15755.61"/>
<text text-anchor="middle" x="11077" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11077" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11077" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn2_0_9&#45;&gt;res_ffn0_9 -->
<g id="edge842" class="edge">
<title>ffn2_0_9&#45;&gt;res_ffn0_9</title>
<path fill="none" stroke="black" d="M16289.33,-15818.03C16269.23,-15807.67 16244.64,-15796.92 16221,-15791.61 15956.29,-15732.14 11648.67,-15788.61 11287.39,-15755.39"/>
<polygon fill="black" stroke="black" points="11287.75,-15751.91 11277.44,-15754.33 11287.01,-15758.87 11287.75,-15751.91"/>
</g>
<!-- res_ffn0_10 -->
<g id="node637" class="node">
<title>res_ffn0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14638.26,-15755.61 14318.1,-15755.61 14235.74,-15649.61 14555.9,-15649.61 14638.26,-15755.61"/>
<text text-anchor="middle" x="14437" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14437" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14437" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn2_0_10&#45;&gt;res_ffn0_10 -->
<g id="edge851" class="edge">
<title>ffn2_0_10&#45;&gt;res_ffn0_10</title>
<path fill="none" stroke="black" d="M18081.02,-15818.09C18060.96,-15807.81 18036.48,-15797.1 18013,-15791.61 17680.18,-15713.81 15275.29,-15704.74 14608.19,-15703.73"/>
<polygon fill="black" stroke="black" points="14608.02,-15700.23 14598.02,-15703.71 14608.01,-15707.23 14608.02,-15700.23"/>
</g>
<!-- res_ffn0_11 -->
<g id="node638" class="node">
<title>res_ffn0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13798.26,-15755.61 13478.1,-15755.61 13395.74,-15649.61 13715.9,-15649.61 13798.26,-15755.61"/>
<text text-anchor="middle" x="13597" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13597" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13597" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn2_0_11&#45;&gt;res_ffn0_11 -->
<g id="edge860" class="edge">
<title>ffn2_0_11&#45;&gt;res_ffn0_11</title>
<path fill="none" stroke="black" d="M17633.32,-15818.06C17613.22,-15807.7 17588.63,-15796.95 17565,-15791.61 17364.03,-15746.22 14101.84,-15780.94 13807.63,-15755.37"/>
<polygon fill="black" stroke="black" points="13807.75,-15751.87 13797.44,-15754.32 13807.03,-15758.83 13807.75,-15751.87"/>
</g>
<!-- res_ffn0_12 -->
<g id="node639" class="node">
<title>res_ffn0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14218.26,-15755.61 13898.1,-15755.61 13815.74,-15649.61 14135.9,-15649.61 14218.26,-15755.61"/>
<text text-anchor="middle" x="14017" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14017" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14017" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn2_0_12&#45;&gt;res_ffn0_12 -->
<g id="edge869" class="edge">
<title>ffn2_0_12&#45;&gt;res_ffn0_12</title>
<path fill="none" stroke="black" d="M17857.32,-15818.06C17837.22,-15807.71 17812.63,-15796.95 17789,-15791.61 17598.61,-15748.56 14509.51,-15779.69 14227.53,-15755.36"/>
<polygon fill="black" stroke="black" points="14227.75,-15751.86 14217.44,-15754.31 14227.03,-15758.82 14227.75,-15751.86"/>
</g>
<!-- res_ffn0_13 -->
<g id="node640" class="node">
<title>res_ffn0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12118.26,-15755.61 11798.1,-15755.61 11715.74,-15649.61 12035.9,-15649.61 12118.26,-15755.61"/>
<text text-anchor="middle" x="11917" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11917" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11917" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn2_0_13&#45;&gt;res_ffn0_13 -->
<g id="edge878" class="edge">
<title>ffn2_0_13&#45;&gt;res_ffn0_13</title>
<path fill="none" stroke="black" d="M16737.32,-15818.04C16717.23,-15807.68 16692.63,-15796.93 16669,-15791.61 16425.58,-15736.84 12467.75,-15786.02 12127.62,-15755.4"/>
<polygon fill="black" stroke="black" points="12127.75,-15751.89 12117.44,-15754.32 12127.02,-15758.85 12127.75,-15751.89"/>
</g>
<!-- res_ffn0_14 -->
<g id="node641" class="node">
<title>res_ffn0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13378.26,-15755.61 13058.1,-15755.61 12975.74,-15649.61 13295.9,-15649.61 13378.26,-15755.61"/>
<text text-anchor="middle" x="13177" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13177" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13177" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn2_0_14&#45;&gt;res_ffn0_14 -->
<g id="edge887" class="edge">
<title>ffn2_0_14&#45;&gt;res_ffn0_14</title>
<path fill="none" stroke="black" d="M17409.32,-15818.05C17389.22,-15807.7 17364.63,-15796.94 17341,-15791.61 17129.43,-15743.88 13693.82,-15782.2 13387.68,-15755.38"/>
<polygon fill="black" stroke="black" points="13387.75,-15751.87 13377.44,-15754.32 13387.02,-15758.84 13387.75,-15751.87"/>
</g>
<!-- res_ffn0_15 -->
<g id="node642" class="node">
<title>res_ffn0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12958.26,-15755.61 12638.1,-15755.61 12555.74,-15649.61 12875.9,-15649.61 12958.26,-15755.61"/>
<text text-anchor="middle" x="12757" y="-15713.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12757" y="-15698.91" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12757" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn2_0_15&#45;&gt;res_ffn0_15 -->
<g id="edge896" class="edge">
<title>ffn2_0_15&#45;&gt;res_ffn0_15</title>
<path fill="none" stroke="black" d="M17185.32,-15818.05C17165.22,-15807.69 17140.63,-15796.94 17117,-15791.61 16894.82,-15741.54 13285.47,-15783.47 12967.7,-15755.39"/>
<polygon fill="black" stroke="black" points="12967.75,-15751.88 12957.44,-15754.32 12967.02,-15758.84 12967.75,-15751.88"/>
</g>
<!-- res_attn0_0&#45;&gt;ffn1_0_0 -->
<g id="edge758" class="edge">
<title>res_attn0_0&#45;&gt;ffn1_0_0</title>
<path fill="none" stroke="black" d="M8260.97,-15897.64C8289.02,-15908.56 8318.84,-15919.51 8347,-15928.61 8542.91,-15991.91 8591.9,-16015.57 8796,-16042.61 9397.24,-16122.25 13890.76,-16129.82 14653.22,-16130.54"/>
<polygon fill="black" stroke="black" points="14653.36,-16134.04 14663.36,-16130.55 14653.37,-16127.04 14653.36,-16134.04"/>
</g>
<!-- res_attn0_0&#45;&gt;res_ffn0_0 -->
<g id="edge762" class="edge">
<title>res_attn0_0&#45;&gt;res_ffn0_0</title>
<path fill="none" stroke="black" d="M8137,-15791.48C8137,-15783.19 8137,-15774.54 8137,-15766.04"/>
<polygon fill="black" stroke="black" points="8140.5,-15765.78 8137,-15755.78 8133.5,-15765.78 8140.5,-15765.78"/>
</g>
<!-- res_attn0_1&#45;&gt;ffn1_0_1 -->
<g id="edge767" class="edge">
<title>res_attn0_1&#45;&gt;ffn1_0_1</title>
<path fill="none" stroke="black" d="M8680.97,-15897.64C8709.02,-15908.56 8738.84,-15919.51 8767,-15928.61 8962.91,-15991.91 9011.78,-16016.43 9216,-16042.61 9527.68,-16082.57 14565.38,-16009.88 14872,-16078.61 14892.13,-16083.12 14912.95,-16091.59 14931.1,-16100.4"/>
<polygon fill="black" stroke="black" points="14929.82,-16103.67 14940.33,-16105.02 14932.95,-16097.41 14929.82,-16103.67"/>
</g>
<!-- res_attn0_1&#45;&gt;res_ffn0_1 -->
<g id="edge771" class="edge">
<title>res_attn0_1&#45;&gt;res_ffn0_1</title>
<path fill="none" stroke="black" d="M8557,-15791.48C8557,-15783.19 8557,-15774.54 8557,-15766.04"/>
<polygon fill="black" stroke="black" points="8560.5,-15765.78 8557,-15755.78 8553.5,-15765.78 8560.5,-15765.78"/>
</g>
<!-- res_attn0_2&#45;&gt;ffn1_0_2 -->
<g id="edge776" class="edge">
<title>res_attn0_2&#45;&gt;ffn1_0_2</title>
<path fill="none" stroke="black" d="M9521.28,-15897.67C9549.24,-15908.56 9578.95,-15919.49 9607,-15928.61 9799.93,-15991.35 9847.83,-16016.39 10049,-16042.61 10339.16,-16080.44 15030.27,-16015.5 15316,-16078.61 15336.53,-16083.15 15357.82,-16091.67 15376.35,-16100.53"/>
<polygon fill="black" stroke="black" points="15374.98,-16103.75 15385.49,-16105.02 15378.07,-16097.47 15374.98,-16103.75"/>
</g>
<!-- res_attn0_2&#45;&gt;res_ffn0_2 -->
<g id="edge780" class="edge">
<title>res_attn0_2&#45;&gt;res_ffn0_2</title>
<path fill="none" stroke="black" d="M9397,-15791.48C9397,-15783.19 9397,-15774.54 9397,-15766.04"/>
<polygon fill="black" stroke="black" points="9400.5,-15765.78 9397,-15755.78 9393.5,-15765.78 9400.5,-15765.78"/>
</g>
<!-- res_attn0_3&#45;&gt;ffn1_0_3 -->
<g id="edge785" class="edge">
<title>res_attn0_3&#45;&gt;ffn1_0_3</title>
<path fill="none" stroke="black" d="M9939.1,-15897.64C9967.64,-15908.74 9998.14,-15919.77 10027,-15928.61 10251.16,-15997.24 10309.05,-16016.29 10542,-16042.61 10817.86,-16073.78 15267.83,-16019.13 15539,-16078.61 15559.69,-16083.15 15581.15,-16091.67 15599.85,-16100.53"/>
<polygon fill="black" stroke="black" points="15598.56,-16103.79 15609.08,-16105.03 15601.62,-16097.5 15598.56,-16103.79"/>
</g>
<!-- res_attn0_3&#45;&gt;res_ffn0_3 -->
<g id="edge789" class="edge">
<title>res_attn0_3&#45;&gt;res_ffn0_3</title>
<path fill="none" stroke="black" d="M9817,-15791.48C9817,-15783.19 9817,-15774.54 9817,-15766.04"/>
<polygon fill="black" stroke="black" points="9820.5,-15765.78 9817,-15755.78 9813.5,-15765.78 9820.5,-15765.78"/>
</g>
<!-- res_attn0_4&#45;&gt;ffn1_0_4 -->
<g id="edge794" class="edge">
<title>res_attn0_4&#45;&gt;ffn1_0_4</title>
<path fill="none" stroke="black" d="M9100.97,-15897.64C9129.02,-15908.56 9158.84,-15919.51 9187,-15928.61 9382.91,-15991.91 9431.79,-16016.41 9636,-16042.61 9936.71,-16081.2 14796.95,-16013.26 15093,-16078.61 15113.53,-16083.14 15134.82,-16091.67 15153.35,-16100.52"/>
<polygon fill="black" stroke="black" points="15151.98,-16103.75 15162.5,-16105.02 15155.07,-16097.47 15151.98,-16103.75"/>
</g>
<!-- res_attn0_4&#45;&gt;res_ffn0_4 -->
<g id="edge798" class="edge">
<title>res_attn0_4&#45;&gt;res_ffn0_4</title>
<path fill="none" stroke="black" d="M8977,-15791.48C8977,-15783.19 8977,-15774.54 8977,-15766.04"/>
<polygon fill="black" stroke="black" points="8980.5,-15765.78 8977,-15755.78 8973.5,-15765.78 8980.5,-15765.78"/>
</g>
<!-- res_attn0_5&#45;&gt;ffn1_0_5 -->
<g id="edge803" class="edge">
<title>res_attn0_5&#45;&gt;ffn1_0_5</title>
<path fill="none" stroke="black" d="M10351.14,-15897.71C10381.71,-15909.71 10415.13,-15921.14 10447,-15928.61 10488.25,-15938.28 10500.37,-15928.71 10542,-15936.61 10703.36,-15967.22 10733.59,-16018.2 10896,-16042.61 11163.39,-16082.8 15498.89,-16020.65 15763,-16078.61 15783.69,-16083.15 15805.15,-16091.68 15823.85,-16100.53"/>
<polygon fill="black" stroke="black" points="15822.56,-16103.79 15833.08,-16105.03 15825.62,-16097.5 15822.56,-16103.79"/>
</g>
<!-- res_attn0_5&#45;&gt;res_ffn0_5 -->
<g id="edge807" class="edge">
<title>res_attn0_5&#45;&gt;res_ffn0_5</title>
<path fill="none" stroke="black" d="M10237,-15791.48C10237,-15783.19 10237,-15774.54 10237,-15766.04"/>
<polygon fill="black" stroke="black" points="10240.5,-15765.78 10237,-15755.78 10233.5,-15765.78 10240.5,-15765.78"/>
</g>
<!-- res_attn0_6&#45;&gt;ffn1_0_6 -->
<g id="edge812" class="edge">
<title>res_attn0_6&#45;&gt;ffn1_0_6</title>
<path fill="none" stroke="black" d="M11620.97,-15897.64C11649.02,-15908.56 11678.84,-15919.51 11707,-15928.61 11902.91,-15991.91 11951.81,-16016.22 12156,-16042.61 12391.77,-16073.08 16202.82,-16027.53 16435,-16078.61 16455.69,-16083.16 16477.15,-16091.69 16495.85,-16100.54"/>
<polygon fill="black" stroke="black" points="16494.55,-16103.8 16505.07,-16105.04 16497.62,-16097.51 16494.55,-16103.8"/>
</g>
<!-- res_attn0_6&#45;&gt;res_ffn0_6 -->
<g id="edge816" class="edge">
<title>res_attn0_6&#45;&gt;res_ffn0_6</title>
<path fill="none" stroke="black" d="M11497,-15791.48C11497,-15783.19 11497,-15774.54 11497,-15766.04"/>
<polygon fill="black" stroke="black" points="11500.5,-15765.78 11497,-15755.78 11493.5,-15765.78 11500.5,-15765.78"/>
</g>
<!-- res_attn0_7&#45;&gt;ffn1_0_7 -->
<g id="edge821" class="edge">
<title>res_attn0_7&#45;&gt;ffn1_0_7</title>
<path fill="none" stroke="black" d="M10780.97,-15897.64C10809.02,-15908.56 10838.84,-15919.51 10867,-15928.61 11062.91,-15991.91 11111.8,-16016.29 11316,-16042.61 11573.38,-16075.78 15733.53,-16022.95 15987,-16078.61 16007.69,-16083.15 16029.15,-16091.68 16047.85,-16100.53"/>
<polygon fill="black" stroke="black" points="16046.55,-16103.8 16057.08,-16105.03 16049.62,-16097.5 16046.55,-16103.8"/>
</g>
<!-- res_attn0_7&#45;&gt;res_ffn0_7 -->
<g id="edge825" class="edge">
<title>res_attn0_7&#45;&gt;res_ffn0_7</title>
<path fill="none" stroke="black" d="M10657,-15791.48C10657,-15783.19 10657,-15774.54 10657,-15766.04"/>
<polygon fill="black" stroke="black" points="10660.5,-15765.78 10657,-15755.78 10653.5,-15765.78 10660.5,-15765.78"/>
</g>
<!-- res_attn0_8&#45;&gt;ffn1_0_8 -->
<g id="edge830" class="edge">
<title>res_attn0_8&#45;&gt;ffn1_0_8</title>
<path fill="none" stroke="black" d="M12460.97,-15897.64C12489.02,-15908.56 12518.84,-15919.51 12547,-15928.61 12742.91,-15991.91 12791.82,-16016.13 12996,-16042.61 13210.16,-16070.38 16672.11,-16032.12 16883,-16078.61 16903.68,-16083.17 16925.15,-16091.7 16943.85,-16100.55"/>
<polygon fill="black" stroke="black" points="16942.55,-16103.81 16953.07,-16105.05 16945.62,-16097.52 16942.55,-16103.81"/>
</g>
<!-- res_attn0_8&#45;&gt;res_ffn0_8 -->
<g id="edge834" class="edge">
<title>res_attn0_8&#45;&gt;res_ffn0_8</title>
<path fill="none" stroke="black" d="M12337,-15791.48C12337,-15783.19 12337,-15774.54 12337,-15766.04"/>
<polygon fill="black" stroke="black" points="12340.5,-15765.78 12337,-15755.78 12333.5,-15765.78 12340.5,-15765.78"/>
</g>
<!-- res_attn0_9&#45;&gt;ffn1_0_9 -->
<g id="edge839" class="edge">
<title>res_attn0_9&#45;&gt;ffn1_0_9</title>
<path fill="none" stroke="black" d="M11200.97,-15897.64C11229.02,-15908.56 11258.84,-15919.51 11287,-15928.61 11482.91,-15991.91 11531.81,-16016.26 11736,-16042.61 11982.57,-16074.43 15968.18,-16025.24 16211,-16078.61 16231.69,-16083.16 16253.15,-16091.68 16271.85,-16100.54"/>
<polygon fill="black" stroke="black" points="16270.55,-16103.8 16281.08,-16105.04 16273.62,-16097.51 16270.55,-16103.8"/>
</g>
<!-- res_attn0_9&#45;&gt;res_ffn0_9 -->
<g id="edge843" class="edge">
<title>res_attn0_9&#45;&gt;res_ffn0_9</title>
<path fill="none" stroke="black" d="M11077,-15791.48C11077,-15783.19 11077,-15774.54 11077,-15766.04"/>
<polygon fill="black" stroke="black" points="11080.5,-15765.78 11077,-15755.78 11073.5,-15765.78 11080.5,-15765.78"/>
</g>
<!-- res_attn0_10&#45;&gt;ffn1_0_10 -->
<g id="edge848" class="edge">
<title>res_attn0_10&#45;&gt;ffn1_0_10</title>
<path fill="none" stroke="black" d="M14490.76,-15897.68C14544.37,-15945.73 14631.58,-16013.86 14722,-16042.61 14895.72,-16097.85 17825.02,-16039.22 18003,-16078.61 18023.68,-16083.19 18045.14,-16091.72 18063.84,-16100.57"/>
<polygon fill="black" stroke="black" points="18062.55,-16103.84 18073.07,-16105.07 18065.61,-16097.54 18062.55,-16103.84"/>
</g>
<!-- res_attn0_10&#45;&gt;res_ffn0_10 -->
<g id="edge852" class="edge">
<title>res_attn0_10&#45;&gt;res_ffn0_10</title>
<path fill="none" stroke="black" d="M14437,-15791.48C14437,-15783.19 14437,-15774.54 14437,-15766.04"/>
<polygon fill="black" stroke="black" points="14440.5,-15765.78 14437,-15755.78 14433.5,-15765.78 14440.5,-15765.78"/>
</g>
<!-- res_attn0_11&#45;&gt;ffn1_0_11 -->
<g id="edge857" class="edge">
<title>res_attn0_11&#45;&gt;ffn1_0_11</title>
<path fill="none" stroke="black" d="M13716.47,-15897.7C13836.85,-15946.97 14029.28,-16017.06 14204,-16042.61 14572.44,-16096.48 17191.43,-15998.19 17555,-16078.61 17575.68,-16083.19 17597.14,-16091.72 17615.84,-16100.57"/>
<polygon fill="black" stroke="black" points="17614.55,-16103.83 17625.07,-16105.07 17617.61,-16097.54 17614.55,-16103.83"/>
</g>
<!-- res_attn0_11&#45;&gt;res_ffn0_11 -->
<g id="edge861" class="edge">
<title>res_attn0_11&#45;&gt;res_ffn0_11</title>
<path fill="none" stroke="black" d="M13597,-15791.48C13597,-15783.19 13597,-15774.54 13597,-15766.04"/>
<polygon fill="black" stroke="black" points="13600.5,-15765.78 13597,-15755.78 13593.5,-15765.78 13600.5,-15765.78"/>
</g>
<!-- res_attn0_12&#45;&gt;ffn1_0_12 -->
<g id="edge866" class="edge">
<title>res_attn0_12&#45;&gt;ffn1_0_12</title>
<path fill="none" stroke="black" d="M14119.99,-15897.71C14221.89,-15946.15 14383.81,-16014.87 14533,-16042.61 14887.61,-16108.55 17426.84,-16000.65 17779,-16078.61 17799.68,-16083.19 17821.14,-16091.72 17839.84,-16100.58"/>
<polygon fill="black" stroke="black" points="17838.55,-16103.84 17849.07,-16105.07 17841.61,-16097.54 17838.55,-16103.84"/>
</g>
<!-- res_attn0_12&#45;&gt;res_ffn0_12 -->
<g id="edge870" class="edge">
<title>res_attn0_12&#45;&gt;res_ffn0_12</title>
<path fill="none" stroke="black" d="M14017,-15791.48C14017,-15783.19 14017,-15774.54 14017,-15766.04"/>
<polygon fill="black" stroke="black" points="14020.5,-15765.78 14017,-15755.78 14013.5,-15765.78 14020.5,-15765.78"/>
</g>
<!-- res_attn0_13&#45;&gt;ffn1_0_13 -->
<g id="edge875" class="edge">
<title>res_attn0_13&#45;&gt;ffn1_0_13</title>
<path fill="none" stroke="black" d="M12040.97,-15897.64C12069.02,-15908.56 12098.84,-15919.51 12127,-15928.61 12322.91,-15991.91 12371.82,-16016.18 12576,-16042.61 12800.97,-16071.73 16437.47,-16029.83 16659,-16078.61 16679.69,-16083.17 16701.15,-16091.69 16719.85,-16100.55"/>
<polygon fill="black" stroke="black" points="16718.55,-16103.81 16729.07,-16105.05 16721.62,-16097.52 16718.55,-16103.81"/>
</g>
<!-- res_attn0_13&#45;&gt;res_ffn0_13 -->
<g id="edge879" class="edge">
<title>res_attn0_13&#45;&gt;res_ffn0_13</title>
<path fill="none" stroke="black" d="M11917,-15791.48C11917,-15783.19 11917,-15774.54 11917,-15766.04"/>
<polygon fill="black" stroke="black" points="11920.5,-15765.78 11917,-15755.78 11913.5,-15765.78 11920.5,-15765.78"/>
</g>
<!-- res_attn0_14&#45;&gt;ffn1_0_14 -->
<g id="edge884" class="edge">
<title>res_attn0_14&#45;&gt;ffn1_0_14</title>
<path fill="none" stroke="black" d="M13302.74,-15897.65C13430.21,-15947.17 13634.42,-16017.7 13819,-16042.61 14205.74,-16094.8 16949.95,-15994.42 17331,-16078.61 17351.68,-16083.18 17373.14,-16091.71 17391.84,-16100.57"/>
<polygon fill="black" stroke="black" points="17390.55,-16103.83 17401.07,-16105.06 17393.61,-16097.53 17390.55,-16103.83"/>
</g>
<!-- res_attn0_14&#45;&gt;res_ffn0_14 -->
<g id="edge888" class="edge">
<title>res_attn0_14&#45;&gt;res_ffn0_14</title>
<path fill="none" stroke="black" d="M13177,-15791.48C13177,-15783.19 13177,-15774.54 13177,-15766.04"/>
<polygon fill="black" stroke="black" points="13180.5,-15765.78 13177,-15755.78 13173.5,-15765.78 13180.5,-15765.78"/>
</g>
<!-- res_attn0_15&#45;&gt;ffn1_0_15 -->
<g id="edge893" class="edge">
<title>res_attn0_15&#45;&gt;ffn1_0_15</title>
<path fill="none" stroke="black" d="M12881.26,-15897.71C12909.23,-15908.6 12938.94,-15919.52 12967,-15928.61 13161.63,-15991.67 13210.13,-16016.09 13413,-16042.61 13616.5,-16069.21 16906.59,-16034.38 17107,-16078.61 17127.68,-16083.17 17149.14,-16091.71 17167.85,-16100.56"/>
<polygon fill="black" stroke="black" points="17166.55,-16103.82 17177.07,-16105.06 17169.62,-16097.53 17166.55,-16103.82"/>
</g>
<!-- res_attn0_15&#45;&gt;res_ffn0_15 -->
<g id="edge897" class="edge">
<title>res_attn0_15&#45;&gt;res_ffn0_15</title>
<path fill="none" stroke="black" d="M12757,-15791.48C12757,-15783.19 12757,-15774.54 12757,-15766.04"/>
<polygon fill="black" stroke="black" points="12760.5,-15765.78 12757,-15755.78 12753.5,-15765.78 12760.5,-15765.78"/>
</g>
<!-- qkv1_0 -->
<g id="node643" class="node">
<title>qkv1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7582,-15523.5 7376,-15523.5 7376,-15470.5 7582,-15470.5 7582,-15523.5"/>
<text text-anchor="middle" x="7479" y="-15508.3" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7479" y="-15493.3" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7479" y="-15478.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn0_0&#45;&gt;qkv1_0 -->
<g id="edge898" class="edge">
<title>res_ffn0_0&#45;&gt;qkv1_0</title>
<path fill="none" stroke="black" d="M7968.83,-15649.57C7842.49,-15610.48 7674.19,-15558.4 7571.37,-15526.58"/>
<polygon fill="black" stroke="black" points="7572.22,-15523.18 7561.63,-15523.57 7570.15,-15529.87 7572.22,-15523.18"/>
</g>
<!-- res_attn1_0 -->
<g id="node1251" class="node">
<title>res_attn1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12298.26,-10788.41 11978.1,-10788.41 11895.74,-10682.41 12215.9,-10682.41 12298.26,-10788.41"/>
<text text-anchor="middle" x="12097" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12097" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12097" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn0_0&#45;&gt;res_attn1_0 -->
<g id="edge1653" class="edge">
<title>res_ffn0_0&#45;&gt;res_attn1_0</title>
<path fill="none" stroke="black" d="M8265.78,-15662.01C8899.12,-15466.37 11653,-14605.1 11653,-14421.12 11653,-14421.12 11653,-14421.12 11653,-11021.41 11653,-10930.33 11646.26,-10882.21 11719,-10827.41 11733.66,-10816.36 11866.05,-10823.23 11884,-10819.41 11913.73,-10813.07 11944.74,-10803.1 11973.59,-10792.23"/>
<polygon fill="black" stroke="black" points="11975.21,-10795.36 11983.29,-10788.51 11972.7,-10788.82 11975.21,-10795.36"/>
</g>
<!-- qkv1_1 -->
<g id="node644" class="node">
<title>qkv1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7691,-15433.76 7485,-15433.76 7485,-15380.76 7691,-15380.76 7691,-15433.76"/>
<text text-anchor="middle" x="7588" y="-15418.56" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7588" y="-15403.56" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7588" y="-15388.56" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn0_1&#45;&gt;qkv1_1 -->
<g id="edge899" class="edge">
<title>res_ffn0_1&#45;&gt;qkv1_1</title>
<path fill="none" stroke="black" d="M8385.16,-15649.59C8180.25,-15587.56 7845.11,-15486.1 7682.47,-15436.86"/>
<polygon fill="black" stroke="black" points="7683.06,-15433.38 7672.48,-15433.83 7681.04,-15440.08 7683.06,-15433.38"/>
</g>
<!-- res_attn1_1 -->
<g id="node1252" class="node">
<title>res_attn1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13138.26,-10788.41 12818.1,-10788.41 12735.74,-10682.41 13055.9,-10682.41 13138.26,-10788.41"/>
<text text-anchor="middle" x="12937" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12937" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12937" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn0_1&#45;&gt;res_attn1_1 -->
<g id="edge1662" class="edge">
<title>res_ffn0_1&#45;&gt;res_attn1_1</title>
<path fill="none" stroke="black" d="M8686.54,-15662.94C8713.06,-15655.49 8740.85,-15648.02 8767,-15641.61 9084.94,-15563.68 11653,-15376.65 11653,-15049.3 11653,-15049.3 11653,-15049.3 11653,-14688.34 11653,-14568.38 11691,-14541.08 11691,-14421.12 11691,-14421.12 11691,-14421.12 11691,-13521.72 11691,-13373.09 11720.14,-13338.18 11738,-13190.63 11785.64,-12797.17 11805,-12697.74 11805,-12301.41 11805,-12301.41 11805,-12301.41 11805,-11021.41 11805,-10933.87 11772.23,-10884.01 11839,-10827.41 11848.41,-10819.43 12714.89,-10821.77 12727,-10819.41 12757.38,-10813.48 12789,-10803.31 12818.2,-10792.09"/>
<polygon fill="black" stroke="black" points="12819.55,-10795.31 12827.59,-10788.41 12817,-10788.8 12819.55,-10795.31"/>
</g>
<!-- qkv1_2 -->
<g id="node645" class="node">
<title>qkv1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7803,-15344.02 7597,-15344.02 7597,-15291.02 7803,-15291.02 7803,-15344.02"/>
<text text-anchor="middle" x="7700" y="-15328.82" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7700" y="-15313.82" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7700" y="-15298.82" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn0_2&#45;&gt;qkv1_2 -->
<g id="edge900" class="edge">
<title>res_ffn0_2&#45;&gt;qkv1_2</title>
<path fill="none" stroke="black" d="M9264.17,-15649.53C9185.63,-15620.18 9083.7,-15584.57 8991,-15559.87 8562.43,-15445.7 8039.82,-15365.69 7813.49,-15333.84"/>
<polygon fill="black" stroke="black" points="7813.65,-15330.33 7803.26,-15332.41 7812.68,-15337.26 7813.65,-15330.33"/>
</g>
<!-- res_attn1_2 -->
<g id="node1253" class="node">
<title>res_attn1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13558.26,-10788.41 13238.1,-10788.41 13155.74,-10682.41 13475.9,-10682.41 13558.26,-10788.41"/>
<text text-anchor="middle" x="13357" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13357" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13357" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn0_2&#45;&gt;res_attn1_2 -->
<g id="edge1671" class="edge">
<title>res_ffn0_2&#45;&gt;res_attn1_2</title>
<path fill="none" stroke="black" d="M9524.54,-15660.45C9551.52,-15653.08 9580,-15646.27 9607,-15641.61 10420.2,-15501.28 10636.76,-15580.89 11460,-15523.87 11613.4,-15513.25 11805,-15651.76 11805,-15498 11805,-15498 11805,-15498 11805,-14867.82 11805,-14747.86 11843,-14720.56 11843,-14600.6 11843,-14600.6 11843,-14600.6 11843,-11021.41 11843,-10930.89 11832.07,-10881.02 11905,-10827.41 11918.9,-10817.19 13130.06,-10822.69 13147,-10819.41 13177.39,-10813.52 13209.01,-10803.37 13238.21,-10792.14"/>
<polygon fill="black" stroke="black" points="13239.56,-10795.37 13247.6,-10788.46 13237.01,-10788.85 13239.56,-10795.37"/>
</g>
<!-- qkv1_3 -->
<g id="node646" class="node">
<title>qkv1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7912,-15254.28 7706,-15254.28 7706,-15201.28 7912,-15201.28 7912,-15254.28"/>
<text text-anchor="middle" x="7809" y="-15239.08" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7809" y="-15224.08" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7809" y="-15209.08" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn0_3&#45;&gt;qkv1_3 -->
<g id="edge901" class="edge">
<title>res_ffn0_3&#45;&gt;qkv1_3</title>
<path fill="none" stroke="black" d="M9656.06,-15649.52C9495.33,-15596.33 9272,-15518.69 9272,-15498 9272,-15498 9272,-15498 9272,-15406.26 9272,-15270.47 8265.93,-15237.84 7922.38,-15230.66"/>
<polygon fill="black" stroke="black" points="7922.24,-15227.16 7912.17,-15230.45 7922.09,-15234.15 7922.24,-15227.16"/>
</g>
<!-- res_attn1_3 -->
<g id="node1254" class="node">
<title>res_attn1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13978.26,-10788.41 13658.1,-10788.41 13575.74,-10682.41 13895.9,-10682.41 13978.26,-10788.41"/>
<text text-anchor="middle" x="13777" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13777" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13777" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn0_3&#45;&gt;res_attn1_3 -->
<g id="edge1680" class="edge">
<title>res_ffn0_3&#45;&gt;res_attn1_3</title>
<path fill="none" stroke="black" d="M9944.16,-15659.96C9971.23,-15652.6 9999.85,-15645.92 10027,-15641.61 10235.22,-15608.59 11919,-15708.83 11919,-15498 11919,-15498 11919,-15498 11919,-11021.41 11919,-10915.6 11963.09,-10876.17 12057,-10827.41 12075.61,-10817.74 13546.41,-10823.39 13567,-10819.41 13597.39,-10813.54 13629.01,-10803.39 13658.21,-10792.17"/>
<polygon fill="black" stroke="black" points="13659.57,-10795.39 13667.6,-10788.49 13657.01,-10788.88 13659.57,-10795.39"/>
</g>
<!-- qkv1_4 -->
<g id="node647" class="node">
<title>qkv1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5353,-15164.54 5147,-15164.54 5147,-15111.54 5353,-15111.54 5353,-15164.54"/>
<text text-anchor="middle" x="5250" y="-15149.34" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5250" y="-15134.34" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5250" y="-15119.34" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn0_4&#45;&gt;qkv1_4 -->
<g id="edge902" class="edge">
<title>res_ffn0_4&#45;&gt;qkv1_4</title>
<path fill="none" stroke="black" d="M8805.76,-15649.6C8792.72,-15646.59 8779.69,-15643.87 8767,-15641.61 8283.48,-15555.54 8155.65,-15581.36 7665,-15559.87 7627.95,-15558.25 5021.05,-15550.27 4995,-15523.87 4882.74,-15410.08 5100.16,-15240.03 5201.71,-15170.43"/>
<polygon fill="black" stroke="black" points="5203.98,-15173.12 5210.29,-15164.61 5200.05,-15167.33 5203.98,-15173.12"/>
</g>
<!-- res_attn1_4 -->
<g id="node1255" class="node">
<title>res_attn1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12718.26,-10788.41 12398.1,-10788.41 12315.74,-10682.41 12635.9,-10682.41 12718.26,-10788.41"/>
<text text-anchor="middle" x="12517" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12517" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12517" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn0_4&#45;&gt;res_attn1_4 -->
<g id="edge1689" class="edge">
<title>res_ffn0_4&#45;&gt;res_attn1_4</title>
<path fill="none" stroke="black" d="M9104.89,-15660.82C9131.79,-15653.44 9160.15,-15646.54 9187,-15641.61 9455.17,-15592.4 11434.96,-15622.57 11632,-15434.13 11677.44,-15390.67 11729,-14982.87 11729,-14510.86 11729,-14510.86 11729,-14510.86 11729,-13521.72 11729,-12726.73 11767,-12528.39 11767,-11733.41 11767,-11733.41 11767,-11733.41 11767,-11305.41 11767,-11092.69 11638.01,-10975.19 11791,-10827.41 11801.31,-10817.45 12292.94,-10822.2 12307,-10819.41 12337.19,-10813.41 12368.61,-10803.29 12397.67,-10792.14"/>
<polygon fill="black" stroke="black" points="12398.97,-10795.38 12407.01,-10788.48 12396.43,-10788.86 12398.97,-10795.38"/>
</g>
<!-- qkv1_5 -->
<g id="node648" class="node">
<title>qkv1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5011,-15074.8 4805,-15074.8 4805,-15021.8 5011,-15021.8 5011,-15074.8"/>
<text text-anchor="middle" x="4908" y="-15059.6" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4908" y="-15044.6" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="4908" y="-15029.6" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn0_5&#45;&gt;qkv1_5 -->
<g id="edge903" class="edge">
<title>res_ffn0_5&#45;&gt;qkv1_5</title>
<path fill="none" stroke="black" d="M10067.57,-15649.55C10053.93,-15646.48 10040.29,-15643.77 10027,-15641.61 9170.69,-15502.69 6991.37,-15568.15 6125,-15523.87 5888.47,-15511.78 5256.05,-15571.34 5063,-15434.13 4945.95,-15350.94 4917.21,-15163.92 4910.22,-15085.25"/>
<polygon fill="black" stroke="black" points="4913.67,-15084.57 4909.37,-15074.89 4906.7,-15085.14 4913.67,-15084.57"/>
</g>
<!-- res_attn1_5 -->
<g id="node1256" class="node">
<title>res_attn1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14398.26,-10788.41 14078.1,-10788.41 13995.74,-10682.41 14315.9,-10682.41 14398.26,-10788.41"/>
<text text-anchor="middle" x="14197" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14197" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14197" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn0_5&#45;&gt;res_attn1_5 -->
<g id="edge1698" class="edge">
<title>res_ffn0_5&#45;&gt;res_attn1_5</title>
<path fill="none" stroke="black" d="M10363.83,-15659.73C10390.99,-15652.36 10419.72,-15645.73 10447,-15641.61 10730.29,-15598.79 11456.44,-15676.35 11736,-15613.61 11859,-15586.01 11995,-15624.06 11995,-15498 11995,-15498 11995,-15498 11995,-11305.41 11995,-11088.36 11923.11,-10959.93 12095,-10827.41 12105.41,-10819.38 13974.1,-10821.89 13987,-10819.41 14017.39,-10813.55 14049.01,-10803.41 14078.22,-10792.19"/>
<polygon fill="black" stroke="black" points="14079.57,-10795.42 14087.61,-10788.51 14077.02,-10788.9 14079.57,-10795.42"/>
</g>
<!-- qkv1_6 -->
<g id="node649" class="node">
<title>qkv1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7246,-14985.06 7040,-14985.06 7040,-14932.06 7246,-14932.06 7246,-14985.06"/>
<text text-anchor="middle" x="7143" y="-14969.86" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7143" y="-14954.86" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7143" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn0_6&#45;&gt;qkv1_6 -->
<g id="edge904" class="edge">
<title>res_ffn0_6&#45;&gt;qkv1_6</title>
<path fill="none" stroke="black" d="M11411.79,-15649.53C11232.92,-15543.21 10801.99,-15302.67 10405,-15200.91 9330.21,-14925.4 9022.32,-15091.53 7915,-15021.43 7625.11,-15003.08 7547.6,-15026.11 7256.03,-14985.47"/>
<polygon fill="black" stroke="black" points="7256.4,-14981.98 7246.01,-14984.06 7255.43,-14988.92 7256.4,-14981.98"/>
</g>
<!-- res_attn1_6 -->
<g id="node1257" class="node">
<title>res_attn1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15658.26,-10788.41 15338.1,-10788.41 15255.74,-10682.41 15575.9,-10682.41 15658.26,-10788.41"/>
<text text-anchor="middle" x="15457" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15457" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15457" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn0_6&#45;&gt;res_attn1_6 -->
<g id="edge1707" class="edge">
<title>res_ffn0_6&#45;&gt;res_attn1_6</title>
<path fill="none" stroke="black" d="M11627.09,-15663.9C11653.5,-15656.4 11681.12,-15648.66 11707,-15641.61 11952.42,-15574.75 12261,-15752.36 12261,-15498 12261,-15498 12261,-15498 12261,-11163.41 12261,-10994.83 12292.89,-10914.88 12437,-10827.41 12453.68,-10817.28 15227.84,-10823.09 15247,-10819.41 15277.48,-10813.56 15309.2,-10803.38 15338.47,-10792.12"/>
<polygon fill="black" stroke="black" points="15339.85,-10795.34 15347.88,-10788.43 15337.3,-10788.83 15339.85,-10795.34"/>
</g>
<!-- qkv1_7 -->
<g id="node650" class="node">
<title>qkv1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4975,-14895.32 4769,-14895.32 4769,-14842.32 4975,-14842.32 4975,-14895.32"/>
<text text-anchor="middle" x="4872" y="-14880.12" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4872" y="-14865.12" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="4872" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn0_7&#45;&gt;qkv1_7 -->
<g id="edge905" class="edge">
<title>res_ffn0_7&#45;&gt;qkv1_7</title>
<path fill="none" stroke="black" d="M10490.25,-15649.57C10475.73,-15646.38 10461.17,-15643.64 10447,-15641.61 10209.31,-15607.54 6364.35,-15632.74 6125,-15613.61 5810.66,-15588.49 4737,-15633.86 4737,-15318.52 4737,-15318.52 4737,-15318.52 4737,-15047.3 4737,-14986.76 4787.37,-14933.96 4826.58,-14902.03"/>
<polygon fill="black" stroke="black" points="4829.1,-14904.5 4834.75,-14895.54 4824.75,-14899.02 4829.1,-14904.5"/>
</g>
<!-- res_attn1_7 -->
<g id="node1258" class="node">
<title>res_attn1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14818.26,-10788.41 14498.1,-10788.41 14415.74,-10682.41 14735.9,-10682.41 14818.26,-10788.41"/>
<text text-anchor="middle" x="14617" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14617" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14617" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn0_7&#45;&gt;res_attn1_7 -->
<g id="edge1716" class="edge">
<title>res_ffn0_7&#45;&gt;res_attn1_7</title>
<path fill="none" stroke="black" d="M10784.13,-15659.78C10811.21,-15652.43 10839.83,-15645.8 10867,-15641.61 11086.93,-15607.67 11653.7,-15673.57 11868,-15613.61 11967.99,-15585.63 12071,-15601.83 12071,-15498 12071,-15498 12071,-15498 12071,-15137.04 12071,-14977.71 12104,-14939.4 12104,-14780.08 12104,-14780.08 12104,-14780.08 12104,-14688.34 12104,-14449.91 12108,-14390.32 12108,-14151.9 12108,-14151.9 12108,-14151.9 12108,-13431.98 12108,-13313.21 12109,-13283.52 12109,-13164.76 12109,-13164.76 12109,-13164.76 12109,-11305.41 12109,-11091.18 12010.33,-10969.1 12171,-10827.41 12182.65,-10817.14 14391.75,-10822.34 14407,-10819.41 14437.48,-10813.54 14469.2,-10803.37 14498.47,-10792.11"/>
<polygon fill="black" stroke="black" points="14499.85,-10795.33 14507.88,-10788.42 14497.29,-10788.81 14499.85,-10795.33"/>
</g>
<!-- qkv1_8 -->
<g id="node651" class="node">
<title>qkv1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6104,-14805.58 5898,-14805.58 5898,-14752.58 6104,-14752.58 6104,-14805.58"/>
<text text-anchor="middle" x="6001" y="-14790.38" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6001" y="-14775.38" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6001" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn0_8&#45;&gt;qkv1_8 -->
<g id="edge906" class="edge">
<title>res_ffn0_8&#45;&gt;qkv1_8</title>
<path fill="none" stroke="black" d="M12197.79,-15649.6C11987.99,-15561.13 11615,-15360.13 11615,-15049.3 11615,-15049.3 11615,-15049.3 11615,-14957.56 11615,-14738.47 7892.02,-14847.69 7673,-14841.95 7329.58,-14832.95 6473.14,-14848.89 6114.25,-14805.97"/>
<polygon fill="black" stroke="black" points="6114.65,-14802.49 6104.3,-14804.75 6113.8,-14809.44 6114.65,-14802.49"/>
</g>
<!-- res_attn1_8 -->
<g id="node1259" class="node">
<title>res_attn1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16498.26,-10788.41 16178.1,-10788.41 16095.74,-10682.41 16415.9,-10682.41 16498.26,-10788.41"/>
<text text-anchor="middle" x="16297" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16297" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16297" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn0_8&#45;&gt;res_attn1_8 -->
<g id="edge1725" class="edge">
<title>res_ffn0_8&#45;&gt;res_attn1_8</title>
<path fill="none" stroke="black" d="M12405.44,-15649.29C12445.79,-15612.1 12489,-15558.21 12489,-15498 12489,-15498 12489,-15498 12489,-11021.41 12489,-10930.89 12477.96,-10880.87 12551,-10827.41 12570.81,-10812.9 16062.88,-10824.03 16087,-10819.41 16117.49,-10813.57 16149.2,-10803.4 16178.47,-10792.14"/>
<polygon fill="black" stroke="black" points="16179.85,-10795.36 16187.89,-10788.45 16177.3,-10788.84 16179.85,-10795.36"/>
</g>
<!-- qkv1_9 -->
<g id="node652" class="node">
<title>qkv1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4957,-14715.84 4751,-14715.84 4751,-14662.84 4957,-14662.84 4957,-14715.84"/>
<text text-anchor="middle" x="4854" y="-14700.64" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4854" y="-14685.64" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="4854" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn0_9&#45;&gt;qkv1_9 -->
<g id="edge907" class="edge">
<title>res_ffn0_9&#45;&gt;qkv1_9</title>
<path fill="none" stroke="black" d="M10910.54,-15649.6C10895.92,-15646.39 10881.26,-15643.64 10867,-15641.61 10824.5,-15635.56 4718.24,-15640.78 4685,-15613.61 4644.37,-15580.4 4661,-15550.48 4661,-15498 4661,-15498 4661,-15498 4661,-14867.82 4661,-14798.93 4728.44,-14749.47 4783.59,-14720.54"/>
<polygon fill="black" stroke="black" points="4785.36,-14723.57 4792.67,-14715.9 4782.17,-14717.33 4785.36,-14723.57"/>
</g>
<!-- res_attn1_9 -->
<g id="node1260" class="node">
<title>res_attn1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15238.26,-10788.41 14918.1,-10788.41 14835.74,-10682.41 15155.9,-10682.41 15238.26,-10788.41"/>
<text text-anchor="middle" x="15037" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15037" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15037" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn0_9&#45;&gt;res_attn1_9 -->
<g id="edge1734" class="edge">
<title>res_ffn0_9&#45;&gt;res_attn1_9</title>
<path fill="none" stroke="black" d="M11204.18,-15660.05C11231.25,-15652.68 11259.86,-15645.98 11287,-15641.61 11437.41,-15617.4 11829.32,-15667.02 11972,-15613.61 12258.31,-15506.44 12185,-15265.28 12185,-14959.56 12185,-14959.56 12185,-14959.56 12185,-11021.41 12185,-10918.6 12220.72,-10876.61 12311,-10827.41 12326.34,-10819.05 14809.84,-10822.7 14827,-10819.41 14857.48,-10813.55 14889.2,-10803.38 14918.47,-10792.12"/>
<polygon fill="black" stroke="black" points="14919.85,-10795.34 14927.88,-10788.43 14917.3,-10788.82 14919.85,-10795.34"/>
</g>
<!-- qkv1_10 -->
<g id="node653" class="node">
<title>qkv1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7901,-14626.1 7695,-14626.1 7695,-14573.1 7901,-14573.1 7901,-14626.1"/>
<text text-anchor="middle" x="7798" y="-14610.9" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7798" y="-14595.9" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7798" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn0_10&#45;&gt;qkv1_10 -->
<g id="edge908" class="edge">
<title>res_ffn0_10&#45;&gt;qkv1_10</title>
<path fill="none" stroke="black" d="M14259.15,-15649.54C14248.3,-15646.75 14237.52,-15644.08 14227,-15641.61 13522.93,-15476.03 13306.78,-15591.42 12627,-15344.39 12199.72,-15189.11 12171.98,-14970.79 11736,-14841.95 10991.32,-14621.89 8476.69,-14602.31 7911.44,-14600.71"/>
<polygon fill="black" stroke="black" points="7911.26,-14597.21 7901.25,-14600.69 7911.24,-14604.21 7911.26,-14597.21"/>
</g>
<!-- res_attn1_10 -->
<g id="node1261" class="node">
<title>res_attn1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18598.26,-10788.41 18278.1,-10788.41 18195.74,-10682.41 18515.9,-10682.41 18598.26,-10788.41"/>
<text text-anchor="middle" x="18397" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18397" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18397" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn0_10&#45;&gt;res_attn1_10 -->
<g id="edge1743" class="edge">
<title>res_ffn0_10&#45;&gt;res_attn1_10</title>
<path fill="none" stroke="black" d="M14595.08,-15699.77C15234.07,-15691.32 17592,-15649.84 17592,-15498 17592,-15498 17592,-15498 17592,-11021.41 17592,-10742.14 17924.84,-10915.65 18187,-10819.41 18212.73,-10809.96 18240.07,-10799.48 18266.22,-10789.24"/>
<polygon fill="black" stroke="black" points="18267.76,-10792.4 18275.79,-10785.48 18265.21,-10785.88 18267.76,-10792.4"/>
</g>
<!-- qkv1_11 -->
<g id="node654" class="node">
<title>qkv1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4519,-14536.36 4313,-14536.36 4313,-14483.36 4519,-14483.36 4519,-14536.36"/>
<text text-anchor="middle" x="4416" y="-14521.16" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4416" y="-14506.16" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="4416" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn0_11&#45;&gt;qkv1_11 -->
<g id="edge909" class="edge">
<title>res_ffn0_11&#45;&gt;qkv1_11</title>
<path fill="none" stroke="black" d="M13430.54,-15649.59C13415.92,-15646.38 13401.27,-15643.64 13387,-15641.61 13187.28,-15613.25 6326.54,-15622.16 6125,-15613.61 5966.18,-15606.88 4699,-15656.96 4699,-15498 4699,-15498 4699,-15498 4699,-15316.52 4699,-15193.05 4623,-15172.77 4623,-15049.3 4623,-15049.3 4623,-15049.3 4623,-14688.34 4623,-14617.68 4552.63,-14569.08 4493.95,-14540.84"/>
<polygon fill="black" stroke="black" points="4495.18,-14537.55 4484.64,-14536.48 4492.21,-14543.89 4495.18,-14537.55"/>
</g>
<!-- res_attn1_11 -->
<g id="node1262" class="node">
<title>res_attn1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18178.26,-10788.41 17858.1,-10788.41 17775.74,-10682.41 18095.9,-10682.41 18178.26,-10788.41"/>
<text text-anchor="middle" x="17977" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17977" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17977" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn0_11&#45;&gt;res_attn1_11 -->
<g id="edge1752" class="edge">
<title>res_ffn0_11&#45;&gt;res_attn1_11</title>
<path fill="none" stroke="black" d="M13724.91,-15660.91C13751.81,-15653.53 13780.16,-15646.6 13807,-15641.61 13982.92,-15608.91 15411,-15676.94 15411,-15498 15411,-15498 15411,-15498 15411,-15406.26 15411,-15282.79 15487,-15262.51 15487,-15139.04 15487,-15139.04 15487,-15139.04 15487,-11021.41 15487,-10784.98 17370.16,-10844.06 17606,-10827.41 17677.47,-10822.36 17696.98,-10834.55 17767,-10819.41 17796.35,-10813.06 17826.93,-10803.08 17855.39,-10792.21"/>
<polygon fill="black" stroke="black" points="17856.9,-10795.38 17864.95,-10788.49 17854.36,-10788.85 17856.9,-10795.38"/>
</g>
<!-- qkv1_12 -->
<g id="node655" class="node">
<title>qkv1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7458,-14446.62 7252,-14446.62 7252,-14393.62 7458,-14393.62 7458,-14446.62"/>
<text text-anchor="middle" x="7355" y="-14431.42" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7355" y="-14416.42" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7355" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn0_12&#45;&gt;qkv1_12 -->
<g id="edge910" class="edge">
<title>res_ffn0_12&#45;&gt;qkv1_12</title>
<path fill="none" stroke="black" d="M13840.66,-15649.54C13829.31,-15646.71 13818.02,-15644.04 13807,-15641.61 13223.98,-15513.07 13036.82,-15599.4 12497,-15344.39 12424.33,-15310.06 12406.58,-15299.67 12340,-15254.65 12095.3,-15089.17 12084.53,-14971.4 11819,-14841.95 11666.51,-14767.61 11615.14,-14781.23 11448,-14752.21 11078.51,-14688.05 10982.58,-14695.25 10609,-14662.47 9217.95,-14540.42 8853.21,-14652.49 7467.95,-14447.04"/>
<polygon fill="black" stroke="black" points="7468.43,-14443.57 7458.02,-14445.56 7467.4,-14450.49 7468.43,-14443.57"/>
</g>
<!-- res_attn1_12 -->
<g id="node1263" class="node">
<title>res_attn1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17758.26,-10788.41 17438.1,-10788.41 17355.74,-10682.41 17675.9,-10682.41 17758.26,-10788.41"/>
<text text-anchor="middle" x="17557" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17557" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17557" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn0_12&#45;&gt;res_attn1_12 -->
<g id="edge1761" class="edge">
<title>res_ffn0_12&#45;&gt;res_attn1_12</title>
<path fill="none" stroke="black" d="M14143.84,-15659.76C14171,-15652.39 14199.73,-15645.76 14227,-15641.61 14292.82,-15631.61 15373.86,-15656.23 15425,-15613.61 15465.31,-15580.01 15449,-15550.48 15449,-15498 15449,-15498 15449,-15498 15449,-11021.41 15449,-10934.53 15408.03,-10885.08 15473,-10827.41 15482.73,-10818.77 17334.22,-10821.87 17347,-10819.41 17377.39,-10813.55 17409.01,-10803.41 17438.22,-10792.19"/>
<polygon fill="black" stroke="black" points="17439.57,-10795.42 17447.61,-10788.51 17437.02,-10788.9 17439.57,-10795.42"/>
</g>
<!-- qkv1_13 -->
<g id="node656" class="node">
<title>qkv1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7911,-15871.11 7705,-15871.11 7705,-15818.11 7911,-15818.11 7911,-15871.11"/>
<text text-anchor="middle" x="7808" y="-15855.91" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7808" y="-15840.91" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7808" y="-15825.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn0_13&#45;&gt;qkv1_13 -->
<g id="edge911" class="edge">
<title>res_ffn0_13&#45;&gt;qkv1_13</title>
<path fill="none" stroke="black" d="M11786.54,-15740.9C11760.41,-15746.96 11732.99,-15752.31 11707,-15755.61 11498.49,-15782.05 8129.32,-15746.67 7924,-15791.61 7903.06,-15796.19 7881.32,-15804.78 7862.39,-15813.68"/>
<polygon fill="black" stroke="black" points="7860.82,-15810.55 7853.34,-15818.05 7863.87,-15816.85 7860.82,-15810.55"/>
</g>
<!-- res_attn1_13 -->
<g id="node1264" class="node">
<title>res_attn1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16078.26,-10788.41 15758.1,-10788.41 15675.74,-10682.41 15995.9,-10682.41 16078.26,-10788.41"/>
<text text-anchor="middle" x="15877" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15877" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15877" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn0_13&#45;&gt;res_attn1_13 -->
<g id="edge1770" class="edge">
<title>res_ffn0_13&#45;&gt;res_attn1_13</title>
<path fill="none" stroke="black" d="M12046.65,-15663.37C12073.16,-15655.89 12100.92,-15648.3 12127,-15641.61 12181.31,-15627.68 12208.96,-15651.81 12250,-15613.61 12472.4,-15406.58 12449,-15263.41 12449,-14959.56 12449,-14959.56 12449,-14959.56 12449,-14867.82 12449,-14749.05 12450,-14719.36 12450,-14600.6 12450,-14600.6 12450,-14600.6 12450,-13611.46 12450,-13492.69 12451,-13463 12451,-13344.24 12451,-13344.24 12451,-13344.24 12451,-11021.41 12451,-10933.87 12418.04,-10883.79 12485,-10827.41 12501.9,-10813.17 15645.3,-10823.57 15667,-10819.41 15697.49,-10813.56 15729.2,-10803.39 15758.47,-10792.13"/>
<polygon fill="black" stroke="black" points="15759.85,-10795.35 15767.89,-10788.44 15757.3,-10788.83 15759.85,-10795.35"/>
</g>
<!-- qkv1_14 -->
<g id="node657" class="node">
<title>qkv1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7248,-15729.11 7042,-15729.11 7042,-15676.11 7248,-15676.11 7248,-15729.11"/>
<text text-anchor="middle" x="7145" y="-15713.91" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7145" y="-15698.91" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7145" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn0_14&#45;&gt;qkv1_14 -->
<g id="edge912" class="edge">
<title>res_ffn0_14&#45;&gt;qkv1_14</title>
<path fill="none" stroke="black" d="M13053.58,-15750.06C13022.81,-15759.81 12989.58,-15768.62 12958,-15773.61 12820.13,-15795.4 8072.44,-15779.88 7933,-15773.61 7692.22,-15762.79 7411.31,-15733.44 7258.4,-15716.05"/>
<polygon fill="black" stroke="black" points="7258.39,-15712.53 7248.06,-15714.87 7257.6,-15719.49 7258.39,-15712.53"/>
</g>
<!-- res_attn1_14 -->
<g id="node1265" class="node">
<title>res_attn1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17338.26,-10788.41 17018.1,-10788.41 16935.74,-10682.41 17255.9,-10682.41 17338.26,-10788.41"/>
<text text-anchor="middle" x="17137" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17137" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17137" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn0_14&#45;&gt;res_attn1_14 -->
<g id="edge1779" class="edge">
<title>res_ffn0_14&#45;&gt;res_attn1_14</title>
<path fill="none" stroke="black" d="M13019.08,-15649.53C12860.97,-15596.23 12641,-15518.41 12641,-15498 12641,-15498 12641,-15498 12641,-11021.41 12641,-10865.98 15276.68,-10833.21 15432,-10827.41 15473.5,-10825.86 16886.23,-10827.29 16927,-10819.41 16957.39,-10813.53 16989.01,-10803.39 17018.21,-10792.17"/>
<polygon fill="black" stroke="black" points="17019.57,-10795.39 17027.6,-10788.49 17017.01,-10788.88 17019.57,-10795.39"/>
</g>
<!-- qkv1_15 -->
<g id="node658" class="node">
<title>qkv1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7656,-15613.24 7450,-15613.24 7450,-15560.24 7656,-15560.24 7656,-15613.24"/>
<text text-anchor="middle" x="7553" y="-15598.04" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7553" y="-15583.04" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7553" y="-15568.04" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn0_15&#45;&gt;qkv1_15 -->
<g id="edge913" class="edge">
<title>res_ffn0_15&#45;&gt;qkv1_15</title>
<path fill="none" stroke="black" d="M12589.95,-15649.57C12575.53,-15646.39 12561.07,-15643.66 12547,-15641.61 12297.76,-15605.33 8385.76,-15590.53 7666.25,-15588.1"/>
<polygon fill="black" stroke="black" points="7666.16,-15584.6 7656.15,-15588.07 7666.14,-15591.6 7666.16,-15584.6"/>
</g>
<!-- res_attn1_15 -->
<g id="node1266" class="node">
<title>res_attn1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16918.26,-10788.41 16598.1,-10788.41 16515.74,-10682.41 16835.9,-10682.41 16918.26,-10788.41"/>
<text text-anchor="middle" x="16717" y="-10746.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16717" y="-10731.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16717" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn0_15&#45;&gt;res_attn1_15 -->
<g id="edge1788" class="edge">
<title>res_ffn0_15&#45;&gt;res_attn1_15</title>
<path fill="none" stroke="black" d="M12665.22,-15649.52C12615.85,-15614.07 12565,-15562.01 12565,-15498 12565,-15498 12565,-15498 12565,-11021.41 12565,-10801.16 12805.24,-10871.65 13021,-10827.41 13115.86,-10807.95 16411.9,-10837.63 16507,-10819.41 16537.49,-10813.56 16569.2,-10803.4 16598.47,-10792.14"/>
<polygon fill="black" stroke="black" points="16599.85,-10795.35 16607.89,-10788.45 16597.3,-10788.84 16599.85,-10795.35"/>
</g>
<!-- ring_stage1_0_0 -->
<g id="node659" class="node">
<title>ring_stage1_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7245.5,-15433.76 7052.5,-15433.76 7052.5,-15380.76 7245.5,-15380.76 7245.5,-15433.76"/>
<text text-anchor="middle" x="7149" y="-15418.56" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="7149" y="-15403.56" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_0×V_0</text>
<text text-anchor="middle" x="7149" y="-15388.56" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv1_0&#45;&gt;ring_stage1_0_0 -->
<g id="edge914" class="edge">
<title>qkv1_0&#45;&gt;ring_stage1_0_0</title>
<path fill="none" stroke="black" d="M7382.66,-15470.39C7342.6,-15459.73 7295.95,-15447.33 7254.92,-15436.42"/>
<polygon fill="black" stroke="black" points="7255.73,-15433.02 7245.17,-15433.83 7253.94,-15439.78 7255.73,-15433.02"/>
</g>
<!-- ring_stage1_0_1 -->
<g id="node660" class="node">
<title>ring_stage1_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7463.5,-15344.02 7270.5,-15344.02 7270.5,-15291.02 7463.5,-15291.02 7463.5,-15344.02"/>
<text text-anchor="middle" x="7367" y="-15328.82" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="7367" y="-15313.82" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_1×V_1</text>
<text text-anchor="middle" x="7367" y="-15298.82" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv1_1&#45;&gt;ring_stage1_0_1 -->
<g id="edge915" class="edge">
<title>qkv1_1&#45;&gt;ring_stage1_0_1</title>
<path fill="none" stroke="black" d="M7523.48,-15380.65C7497.61,-15370.38 7467.65,-15358.48 7440.91,-15347.86"/>
<polygon fill="black" stroke="black" points="7442.18,-15344.6 7431.6,-15344.17 7439.6,-15351.11 7442.18,-15344.6"/>
</g>
<!-- ring_stage1_0_2 -->
<g id="node661" class="node">
<title>ring_stage1_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7687.5,-15254.28 7494.5,-15254.28 7494.5,-15201.28 7687.5,-15201.28 7687.5,-15254.28"/>
<text text-anchor="middle" x="7591" y="-15239.08" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="7591" y="-15224.08" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_2×V_2</text>
<text text-anchor="middle" x="7591" y="-15209.08" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv1_2&#45;&gt;ring_stage1_0_2 -->
<g id="edge916" class="edge">
<title>qkv1_2&#45;&gt;ring_stage1_0_2</title>
<path fill="none" stroke="black" d="M7668.18,-15290.91C7656.53,-15281.53 7643.2,-15270.8 7630.93,-15260.92"/>
<polygon fill="black" stroke="black" points="7633.03,-15258.12 7623.05,-15254.58 7628.64,-15263.57 7633.03,-15258.12"/>
</g>
<!-- ring_stage1_0_3 -->
<g id="node662" class="node">
<title>ring_stage1_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7905.5,-15164.54 7712.5,-15164.54 7712.5,-15111.54 7905.5,-15111.54 7905.5,-15164.54"/>
<text text-anchor="middle" x="7809" y="-15149.34" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="7809" y="-15134.34" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_3×V_3</text>
<text text-anchor="middle" x="7809" y="-15119.34" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv1_3&#45;&gt;ring_stage1_0_3 -->
<g id="edge917" class="edge">
<title>qkv1_3&#45;&gt;ring_stage1_0_3</title>
<path fill="none" stroke="black" d="M7809,-15200.93C7809,-15192.72 7809,-15183.49 7809,-15174.71"/>
<polygon fill="black" stroke="black" points="7812.5,-15174.71 7809,-15164.71 7805.5,-15174.71 7812.5,-15174.71"/>
</g>
<!-- ring_stage1_0_4 -->
<g id="node663" class="node">
<title>ring_stage1_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5444.5,-15074.8 5251.5,-15074.8 5251.5,-15021.8 5444.5,-15021.8 5444.5,-15074.8"/>
<text text-anchor="middle" x="5348" y="-15059.6" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="5348" y="-15044.6" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_4×V_4</text>
<text text-anchor="middle" x="5348" y="-15029.6" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv1_4&#45;&gt;ring_stage1_0_4 -->
<g id="edge918" class="edge">
<title>qkv1_4&#45;&gt;ring_stage1_0_4</title>
<path fill="none" stroke="black" d="M5278.61,-15111.43C5288.88,-15102.23 5300.61,-15091.73 5311.47,-15082.01"/>
<polygon fill="black" stroke="black" points="5314.07,-15084.38 5319.19,-15075.1 5309.4,-15079.16 5314.07,-15084.38"/>
</g>
<!-- ring_stage1_0_5 -->
<g id="node664" class="node">
<title>ring_stage1_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5226.5,-14985.06 5033.5,-14985.06 5033.5,-14932.06 5226.5,-14932.06 5226.5,-14985.06"/>
<text text-anchor="middle" x="5130" y="-14969.86" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="5130" y="-14954.86" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_5×V_5</text>
<text text-anchor="middle" x="5130" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv1_5&#45;&gt;ring_stage1_0_5 -->
<g id="edge919" class="edge">
<title>qkv1_5&#45;&gt;ring_stage1_0_5</title>
<path fill="none" stroke="black" d="M4972.81,-15021.69C4998.8,-15011.41 5028.9,-14999.52 5055.76,-14988.9"/>
<polygon fill="black" stroke="black" points="5057.1,-14992.14 5065.11,-14985.21 5054.52,-14985.63 5057.1,-14992.14"/>
</g>
<!-- ring_stage1_0_6 -->
<g id="node665" class="node">
<title>ring_stage1_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6321.5,-14895.32 6128.5,-14895.32 6128.5,-14842.32 6321.5,-14842.32 6321.5,-14895.32"/>
<text text-anchor="middle" x="6225" y="-14880.12" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="6225" y="-14865.12" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_6×V_6</text>
<text text-anchor="middle" x="6225" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv1_6&#45;&gt;ring_stage1_0_6 -->
<g id="edge920" class="edge">
<title>qkv1_6&#45;&gt;ring_stage1_0_6</title>
<path fill="none" stroke="black" d="M7039.99,-14933.05C7036.97,-14932.56 7033.96,-14932.11 7031,-14931.69 6724.26,-14888.67 6641.66,-14939.32 6335,-14895.69 6333.91,-14895.53 6332.81,-14895.37 6331.71,-14895.21"/>
<polygon fill="black" stroke="black" points="6332.13,-14891.73 6321.69,-14893.57 6331,-14898.64 6332.13,-14891.73"/>
</g>
<!-- ring_stage1_0_7 -->
<g id="node666" class="node">
<title>ring_stage1_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5232.5,-14805.58 5039.5,-14805.58 5039.5,-14752.58 5232.5,-14752.58 5232.5,-14805.58"/>
<text text-anchor="middle" x="5136" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="5136" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_7×V_7</text>
<text text-anchor="middle" x="5136" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv1_7&#45;&gt;ring_stage1_0_7 -->
<g id="edge921" class="edge">
<title>qkv1_7&#45;&gt;ring_stage1_0_7</title>
<path fill="none" stroke="black" d="M4949.07,-14842.21C4980.38,-14831.8 5016.71,-14819.73 5048.96,-14809.01"/>
<polygon fill="black" stroke="black" points="5050.45,-14812.2 5058.83,-14805.73 5048.24,-14805.56 5050.45,-14812.2"/>
</g>
<!-- ring_stage1_0_8 -->
<g id="node667" class="node">
<title>ring_stage1_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5207.5,-14715.84 5014.5,-14715.84 5014.5,-14662.84 5207.5,-14662.84 5207.5,-14715.84"/>
<text text-anchor="middle" x="5111" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="5111" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_8×V_8</text>
<text text-anchor="middle" x="5111" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv1_8&#45;&gt;ring_stage1_0_8 -->
<g id="edge922" class="edge">
<title>qkv1_8&#45;&gt;ring_stage1_0_8</title>
<path fill="none" stroke="black" d="M5897.99,-14753.58C5894.97,-14753.09 5891.96,-14752.63 5889,-14752.21 5596.17,-14710.86 5514.72,-14758.76 5217.82,-14716.19"/>
<polygon fill="black" stroke="black" points="5218.02,-14712.68 5207.62,-14714.7 5217.01,-14719.61 5218.02,-14712.68"/>
</g>
<!-- ring_stage1_0_9 -->
<g id="node668" class="node">
<title>ring_stage1_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4950.5,-14626.1 4757.5,-14626.1 4757.5,-14573.1 4950.5,-14573.1 4950.5,-14626.1"/>
<text text-anchor="middle" x="4854" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="4854" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_9×V_9</text>
<text text-anchor="middle" x="4854" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv1_9&#45;&gt;ring_stage1_0_9 -->
<g id="edge923" class="edge">
<title>qkv1_9&#45;&gt;ring_stage1_0_9</title>
<path fill="none" stroke="black" d="M4854,-14662.49C4854,-14654.28 4854,-14645.05 4854,-14636.27"/>
<polygon fill="black" stroke="black" points="4857.5,-14636.26 4854,-14626.26 4850.5,-14636.26 4857.5,-14636.26"/>
</g>
<!-- ring_stage1_0_10 -->
<g id="node669" class="node">
<title>ring_stage1_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4995,-14536.36 4775,-14536.36 4775,-14483.36 4995,-14483.36 4995,-14536.36"/>
<text text-anchor="middle" x="4885" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="4885" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_10×V_10</text>
<text text-anchor="middle" x="4885" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv1_10&#45;&gt;ring_stage1_0_10 -->
<g id="edge924" class="edge">
<title>qkv1_10&#45;&gt;ring_stage1_0_10</title>
<path fill="none" stroke="black" d="M7694.73,-14575.24C7688.41,-14574.27 7682.13,-14573.41 7676,-14572.73 7086.28,-14506.87 5595.67,-14603.08 5006,-14536.73 5005.78,-14536.7 5005.56,-14536.68 5005.34,-14536.65"/>
<polygon fill="black" stroke="black" points="5005.67,-14533.17 4995.31,-14535.38 5004.79,-14540.11 5005.67,-14533.17"/>
</g>
<!-- ring_stage1_0_11 -->
<g id="node670" class="node">
<title>ring_stage1_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4526,-14446.62 4306,-14446.62 4306,-14393.62 4526,-14393.62 4526,-14446.62"/>
<text text-anchor="middle" x="4416" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="4416" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_11×V_11</text>
<text text-anchor="middle" x="4416" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv1_11&#45;&gt;ring_stage1_0_11 -->
<g id="edge925" class="edge">
<title>qkv1_11&#45;&gt;ring_stage1_0_11</title>
<path fill="none" stroke="black" d="M4416,-14483.01C4416,-14474.8 4416,-14465.57 4416,-14456.79"/>
<polygon fill="black" stroke="black" points="4419.5,-14456.78 4416,-14446.78 4412.5,-14456.78 4419.5,-14456.78"/>
</g>
<!-- ring_stage1_0_12 -->
<g id="node671" class="node">
<title>ring_stage1_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5010,-14356.88 4790,-14356.88 4790,-14303.88 5010,-14303.88 5010,-14356.88"/>
<text text-anchor="middle" x="4900" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="4900" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_12×V_12</text>
<text text-anchor="middle" x="4900" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv1_12&#45;&gt;ring_stage1_0_12 -->
<g id="edge926" class="edge">
<title>qkv1_12&#45;&gt;ring_stage1_0_12</title>
<path fill="none" stroke="black" d="M7251.71,-14394.43C7248.78,-14393.99 7245.87,-14393.6 7243,-14393.25 6755.6,-14333.69 5526.36,-14412.97 5020.07,-14357.24"/>
<polygon fill="black" stroke="black" points="5020.42,-14353.76 5010.09,-14356.11 5019.63,-14360.71 5020.42,-14353.76"/>
</g>
<!-- ring_stage1_0_13 -->
<g id="node672" class="node">
<title>ring_stage1_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6354,-15729.11 6134,-15729.11 6134,-15676.11 6354,-15676.11 6354,-15729.11"/>
<text text-anchor="middle" x="6244" y="-15713.91" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="6244" y="-15698.91" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_13×V_13</text>
<text text-anchor="middle" x="6244" y="-15683.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv1_13&#45;&gt;ring_stage1_0_13 -->
<g id="edge927" class="edge">
<title>qkv1_13&#45;&gt;ring_stage1_0_13</title>
<path fill="none" stroke="black" d="M7763.13,-15818C7743.21,-15807.91 7719.09,-15797.37 7696,-15791.61 7552.84,-15755.9 7180.28,-15764.46 7033,-15755.61 6795.84,-15741.36 6518.72,-15722.61 6364.08,-15711.96"/>
<polygon fill="black" stroke="black" points="6364.28,-15708.46 6354.07,-15711.27 6363.8,-15715.45 6364.28,-15708.46"/>
</g>
<!-- ring_stage1_0_14 -->
<g id="node673" class="node">
<title>ring_stage1_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6592,-15613.24 6372,-15613.24 6372,-15560.24 6592,-15560.24 6592,-15613.24"/>
<text text-anchor="middle" x="6482" y="-15598.04" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="6482" y="-15583.04" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_14×V_14</text>
<text text-anchor="middle" x="6482" y="-15568.04" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv1_14&#45;&gt;ring_stage1_0_14 -->
<g id="edge928" class="edge">
<title>qkv1_14&#45;&gt;ring_stage1_0_14</title>
<path fill="none" stroke="black" d="M7041.77,-15683.88C6922.88,-15663.46 6727.85,-15629.96 6602.22,-15608.39"/>
<polygon fill="black" stroke="black" points="6602.62,-15604.9 6592.17,-15606.66 6601.43,-15611.8 6602.62,-15604.9"/>
</g>
<!-- ring_stage1_0_15 -->
<g id="node674" class="node">
<title>ring_stage1_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7026,-15523.5 6806,-15523.5 6806,-15470.5 7026,-15470.5 7026,-15523.5"/>
<text text-anchor="middle" x="6916" y="-15508.3" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="6916" y="-15493.3" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_15×V_15</text>
<text text-anchor="middle" x="6916" y="-15478.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv1_15&#45;&gt;ring_stage1_0_15 -->
<g id="edge929" class="edge">
<title>qkv1_15&#45;&gt;ring_stage1_0_15</title>
<path fill="none" stroke="black" d="M7449.95,-15571.55C7336.84,-15555.97 7155.49,-15530.99 7036.04,-15514.54"/>
<polygon fill="black" stroke="black" points="7036.5,-15511.07 7026.12,-15513.17 7035.55,-15518 7036.5,-15511.07"/>
</g>
<!-- kv_send1_0_0 -->
<g id="node675" class="node">
<title>kv_send1_0_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7149" cy="-15317.52" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7149" y="-15321.32" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="7149" y="-15306.32" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_0_0&#45;&gt;kv_send1_0_0 -->
<g id="edge930" class="edge">
<title>ring_stage1_0_0&#45;&gt;kv_send1_0_0</title>
<path fill="none" stroke="black" d="M7149,-15380.41C7149,-15372.36 7149,-15363.33 7149,-15354.71"/>
<polygon fill="black" stroke="black" points="7152.5,-15354.49 7149,-15344.49 7145.5,-15354.49 7152.5,-15354.49"/>
</g>
<!-- ring_stage1_1_0 -->
<g id="node691" class="node">
<title>ring_stage1_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7021.5,-15344.02 6810.5,-15344.02 6810.5,-15291.02 7021.5,-15291.02 7021.5,-15344.02"/>
<text text-anchor="middle" x="6916" y="-15328.82" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="6916" y="-15313.82" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_15×V_15</text>
<text text-anchor="middle" x="6916" y="-15298.82" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_0_0&#45;&gt;ring_stage1_1_0 -->
<g id="edge946" class="edge">
<title>ring_stage1_0_0&#45;&gt;ring_stage1_1_0</title>
<path fill="none" stroke="black" d="M7080.98,-15380.65C7053.59,-15370.33 7021.84,-15358.38 6993.55,-15347.72"/>
<polygon fill="black" stroke="black" points="6994.7,-15344.41 6984.1,-15344.17 6992.23,-15350.97 6994.7,-15344.41"/>
</g>
<!-- kv_send1_0_1 -->
<g id="node676" class="node">
<title>kv_send1_0_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7367" cy="-15227.78" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7367" y="-15231.58" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="7367" y="-15216.58" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_0_1&#45;&gt;kv_send1_0_1 -->
<g id="edge931" class="edge">
<title>ring_stage1_0_1&#45;&gt;kv_send1_0_1</title>
<path fill="none" stroke="black" d="M7367,-15290.67C7367,-15282.62 7367,-15273.59 7367,-15264.97"/>
<polygon fill="black" stroke="black" points="7370.5,-15264.75 7367,-15254.75 7363.5,-15264.75 7370.5,-15264.75"/>
</g>
<!-- ring_stage1_1_1 -->
<g id="node692" class="node">
<title>ring_stage1_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7245.5,-15254.28 7052.5,-15254.28 7052.5,-15201.28 7245.5,-15201.28 7245.5,-15254.28"/>
<text text-anchor="middle" x="7149" y="-15239.08" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="7149" y="-15224.08" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_0×V_0</text>
<text text-anchor="middle" x="7149" y="-15209.08" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_0_1&#45;&gt;ring_stage1_1_1 -->
<g id="edge949" class="edge">
<title>ring_stage1_0_1&#45;&gt;ring_stage1_1_1</title>
<path fill="none" stroke="black" d="M7303.36,-15290.91C7277.95,-15280.68 7248.54,-15268.84 7222.25,-15258.26"/>
<polygon fill="black" stroke="black" points="7223.3,-15254.91 7212.72,-15254.43 7220.69,-15261.41 7223.3,-15254.91"/>
</g>
<!-- kv_send1_0_2 -->
<g id="node677" class="node">
<title>kv_send1_0_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7591" cy="-15138.04" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7591" y="-15141.84" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="7591" y="-15126.84" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_0_2&#45;&gt;kv_send1_0_2 -->
<g id="edge932" class="edge">
<title>ring_stage1_0_2&#45;&gt;kv_send1_0_2</title>
<path fill="none" stroke="black" d="M7591,-15200.93C7591,-15192.88 7591,-15183.85 7591,-15175.23"/>
<polygon fill="black" stroke="black" points="7594.5,-15175.01 7591,-15165.01 7587.5,-15175.01 7594.5,-15175.01"/>
</g>
<!-- ring_stage1_1_2 -->
<g id="node693" class="node">
<title>ring_stage1_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7463.5,-15164.54 7270.5,-15164.54 7270.5,-15111.54 7463.5,-15111.54 7463.5,-15164.54"/>
<text text-anchor="middle" x="7367" y="-15149.34" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="7367" y="-15134.34" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_1×V_1</text>
<text text-anchor="middle" x="7367" y="-15119.34" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_0_2&#45;&gt;ring_stage1_1_2 -->
<g id="edge952" class="edge">
<title>ring_stage1_0_2&#45;&gt;ring_stage1_1_2</title>
<path fill="none" stroke="black" d="M7525.61,-15201.17C7499.39,-15190.89 7469.02,-15179 7441.91,-15168.38"/>
<polygon fill="black" stroke="black" points="7443.06,-15165.07 7432.47,-15164.69 7440.51,-15171.59 7443.06,-15165.07"/>
</g>
<!-- kv_send1_0_3 -->
<g id="node678" class="node">
<title>kv_send1_0_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7591" cy="-15048.3" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7591" y="-15052.1" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7591" y="-15037.1" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_0_3&#45;&gt;kv_send1_0_3 -->
<g id="edge933" class="edge">
<title>ring_stage1_0_3&#45;&gt;kv_send1_0_3</title>
<path fill="none" stroke="black" d="M7745.36,-15111.43C7716.91,-15099.97 7683.43,-15086.5 7654.94,-15075.04"/>
<polygon fill="black" stroke="black" points="7656.07,-15071.72 7645.49,-15071.23 7653.46,-15078.21 7656.07,-15071.72"/>
</g>
<!-- ring_stage1_1_3 -->
<g id="node694" class="node">
<title>ring_stage1_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7905.5,-15074.8 7712.5,-15074.8 7712.5,-15021.8 7905.5,-15021.8 7905.5,-15074.8"/>
<text text-anchor="middle" x="7809" y="-15059.6" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="7809" y="-15044.6" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_2×V_2</text>
<text text-anchor="middle" x="7809" y="-15029.6" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_0_3&#45;&gt;ring_stage1_1_3 -->
<g id="edge955" class="edge">
<title>ring_stage1_0_3&#45;&gt;ring_stage1_1_3</title>
<path fill="none" stroke="black" d="M7809,-15111.19C7809,-15102.98 7809,-15093.75 7809,-15084.97"/>
<polygon fill="black" stroke="black" points="7812.5,-15084.97 7809,-15074.97 7805.5,-15084.97 7812.5,-15084.97"/>
</g>
<!-- kv_send1_0_4 -->
<g id="node679" class="node">
<title>kv_send1_0_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5348" cy="-14958.56" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5348" y="-14962.36" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5348" y="-14947.36" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_0_4&#45;&gt;kv_send1_0_4 -->
<g id="edge934" class="edge">
<title>ring_stage1_0_4&#45;&gt;kv_send1_0_4</title>
<path fill="none" stroke="black" d="M5348,-15021.45C5348,-15013.4 5348,-15004.37 5348,-14995.75"/>
<polygon fill="black" stroke="black" points="5351.5,-14995.53 5348,-14985.53 5344.5,-14995.53 5351.5,-14995.53"/>
</g>
<!-- ring_stage1_1_4 -->
<g id="node695" class="node">
<title>ring_stage1_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6792.5,-14985.06 6599.5,-14985.06 6599.5,-14932.06 6792.5,-14932.06 6792.5,-14985.06"/>
<text text-anchor="middle" x="6696" y="-14969.86" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="6696" y="-14954.86" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_3×V_3</text>
<text text-anchor="middle" x="6696" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_0_4&#45;&gt;ring_stage1_1_4 -->
<g id="edge958" class="edge">
<title>ring_stage1_0_4&#45;&gt;ring_stage1_1_4</title>
<path fill="none" stroke="black" d="M5444.61,-15044.86C5693,-15038.2 6350.45,-15018.12 6589.35,-14985.36"/>
<polygon fill="black" stroke="black" points="6589.97,-14988.81 6599.39,-14983.94 6588.99,-14981.87 6589.97,-14988.81"/>
</g>
<!-- kv_send1_0_5 -->
<g id="node680" class="node">
<title>kv_send1_0_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5348" cy="-14868.82" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5348" y="-14872.62" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="5348" y="-14857.62" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_0_5&#45;&gt;kv_send1_0_5 -->
<g id="edge935" class="edge">
<title>ring_stage1_0_5&#45;&gt;kv_send1_0_5</title>
<path fill="none" stroke="black" d="M5193.64,-14931.95C5222.09,-14920.49 5255.57,-14907.02 5284.06,-14895.56"/>
<polygon fill="black" stroke="black" points="5285.54,-14898.73 5293.51,-14891.75 5282.93,-14892.24 5285.54,-14898.73"/>
</g>
<!-- ring_stage1_1_5 -->
<g id="node696" class="node">
<title>ring_stage1_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5226.5,-14895.32 5033.5,-14895.32 5033.5,-14842.32 5226.5,-14842.32 5226.5,-14895.32"/>
<text text-anchor="middle" x="5130" y="-14880.12" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="5130" y="-14865.12" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_4×V_4</text>
<text text-anchor="middle" x="5130" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_0_5&#45;&gt;ring_stage1_1_5 -->
<g id="edge961" class="edge">
<title>ring_stage1_0_5&#45;&gt;ring_stage1_1_5</title>
<path fill="none" stroke="black" d="M5130,-14931.71C5130,-14923.5 5130,-14914.27 5130,-14905.49"/>
<polygon fill="black" stroke="black" points="5133.5,-14905.48 5130,-14895.49 5126.5,-14905.49 5133.5,-14905.48"/>
</g>
<!-- kv_send1_0_6 -->
<g id="node681" class="node">
<title>kv_send1_0_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6225" cy="-14779.08" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6225" y="-14782.88" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6225" y="-14767.88" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_0_6&#45;&gt;kv_send1_0_6 -->
<g id="edge936" class="edge">
<title>ring_stage1_0_6&#45;&gt;kv_send1_0_6</title>
<path fill="none" stroke="black" d="M6225,-14841.97C6225,-14833.92 6225,-14824.89 6225,-14816.27"/>
<polygon fill="black" stroke="black" points="6228.5,-14816.05 6225,-14806.05 6221.5,-14816.05 6228.5,-14816.05"/>
</g>
<!-- ring_stage1_1_6 -->
<g id="node697" class="node">
<title>ring_stage1_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5879.5,-14805.58 5686.5,-14805.58 5686.5,-14752.58 5879.5,-14752.58 5879.5,-14805.58"/>
<text text-anchor="middle" x="5783" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="5783" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_5×V_5</text>
<text text-anchor="middle" x="5783" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_0_6&#45;&gt;ring_stage1_1_6 -->
<g id="edge964" class="edge">
<title>ring_stage1_0_6&#45;&gt;ring_stage1_1_6</title>
<path fill="none" stroke="black" d="M6128.4,-14851.54C6063.59,-14840.27 5976.11,-14824.37 5889.7,-14806.05"/>
<polygon fill="black" stroke="black" points="5890.22,-14802.59 5879.71,-14803.92 5888.76,-14809.43 5890.22,-14802.59"/>
</g>
<!-- kv_send1_0_7 -->
<g id="node682" class="node">
<title>kv_send1_0_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5329" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5329" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="5329" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_0_7&#45;&gt;kv_send1_0_7 -->
<g id="edge937" class="edge">
<title>ring_stage1_0_7&#45;&gt;kv_send1_0_7</title>
<path fill="none" stroke="black" d="M5192.34,-14752.47C5216.71,-14741.39 5245.24,-14728.42 5269.91,-14717.2"/>
<polygon fill="black" stroke="black" points="5271.5,-14720.32 5279.16,-14713 5268.6,-14713.95 5271.5,-14720.32"/>
</g>
<!-- ring_stage1_1_7 -->
<g id="node698" class="node">
<title>ring_stage1_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5867.5,-14715.84 5674.5,-14715.84 5674.5,-14662.84 5867.5,-14662.84 5867.5,-14715.84"/>
<text text-anchor="middle" x="5771" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="5771" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_6×V_6</text>
<text text-anchor="middle" x="5771" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_0_7&#45;&gt;ring_stage1_1_7 -->
<g id="edge967" class="edge">
<title>ring_stage1_0_7&#45;&gt;ring_stage1_1_7</title>
<path fill="none" stroke="black" d="M5232.64,-14753.84C5235.79,-14753.26 5238.92,-14752.71 5242,-14752.21 5425.02,-14722.27 5477.03,-14745.83 5664.46,-14716.17"/>
<polygon fill="black" stroke="black" points="5665.05,-14719.62 5674.36,-14714.58 5663.93,-14712.71 5665.05,-14719.62"/>
</g>
<!-- kv_send1_0_8 -->
<g id="node683" class="node">
<title>kv_send1_0_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5111" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5111" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="5111" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_0_8&#45;&gt;kv_send1_0_8 -->
<g id="edge938" class="edge">
<title>ring_stage1_0_8&#45;&gt;kv_send1_0_8</title>
<path fill="none" stroke="black" d="M5111,-14662.49C5111,-14654.44 5111,-14645.41 5111,-14636.79"/>
<polygon fill="black" stroke="black" points="5114.5,-14636.57 5111,-14626.57 5107.5,-14636.57 5114.5,-14636.57"/>
</g>
<!-- ring_stage1_1_8 -->
<g id="node699" class="node">
<title>ring_stage1_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5425.5,-14626.1 5232.5,-14626.1 5232.5,-14573.1 5425.5,-14573.1 5425.5,-14626.1"/>
<text text-anchor="middle" x="5329" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="5329" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_7×V_7</text>
<text text-anchor="middle" x="5329" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_0_8&#45;&gt;ring_stage1_1_8 -->
<g id="edge970" class="edge">
<title>ring_stage1_0_8&#45;&gt;ring_stage1_1_8</title>
<path fill="none" stroke="black" d="M5174.64,-14662.73C5200.05,-14652.5 5229.46,-14640.66 5255.75,-14630.08"/>
<polygon fill="black" stroke="black" points="5257.31,-14633.23 5265.28,-14626.24 5254.7,-14626.73 5257.31,-14633.23"/>
</g>
<!-- kv_send1_0_9 -->
<g id="node684" class="node">
<title>kv_send1_0_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4647" cy="-14509.86" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4647" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="4647" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_0_9&#45;&gt;kv_send1_0_9 -->
<g id="edge939" class="edge">
<title>ring_stage1_0_9&#45;&gt;kv_send1_0_9</title>
<path fill="none" stroke="black" d="M4793.57,-14572.99C4767.1,-14561.76 4736.05,-14548.6 4709.36,-14537.29"/>
<polygon fill="black" stroke="black" points="4710.69,-14534.05 4700.11,-14533.37 4707.96,-14540.5 4710.69,-14534.05"/>
</g>
<!-- ring_stage1_1_9 -->
<g id="node700" class="node">
<title>ring_stage1_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5207.5,-14536.36 5014.5,-14536.36 5014.5,-14483.36 5207.5,-14483.36 5207.5,-14536.36"/>
<text text-anchor="middle" x="5111" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="5111" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_8×V_8</text>
<text text-anchor="middle" x="5111" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_0_9&#45;&gt;ring_stage1_1_9 -->
<g id="edge973" class="edge">
<title>ring_stage1_0_9&#45;&gt;ring_stage1_1_9</title>
<path fill="none" stroke="black" d="M4929.03,-14572.99C4959.5,-14562.58 4994.87,-14550.51 5026.27,-14539.79"/>
<polygon fill="black" stroke="black" points="5027.55,-14543.05 5035.88,-14536.5 5025.29,-14536.42 5027.55,-14543.05"/>
</g>
<!-- kv_send1_0_10 -->
<g id="node685" class="node">
<title>kv_send1_0_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4874" cy="-14420.12" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4874" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="4874" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_0_10&#45;&gt;kv_send1_0_10 -->
<g id="edge940" class="edge">
<title>ring_stage1_0_10&#45;&gt;kv_send1_0_10</title>
<path fill="none" stroke="black" d="M4881.76,-14483.01C4880.74,-14474.87 4879.59,-14465.73 4878.5,-14457.02"/>
<polygon fill="black" stroke="black" points="4881.97,-14456.57 4877.26,-14447.09 4875.03,-14457.45 4881.97,-14456.57"/>
</g>
<!-- ring_stage1_1_10 -->
<g id="node701" class="node">
<title>ring_stage1_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4746,-14446.62 4544,-14446.62 4544,-14393.62 4746,-14393.62 4746,-14446.62"/>
<text text-anchor="middle" x="4645" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="4645" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_9×V_9</text>
<text text-anchor="middle" x="4645" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_0_10&#45;&gt;ring_stage1_1_10 -->
<g id="edge976" class="edge">
<title>ring_stage1_0_10&#45;&gt;ring_stage1_1_10</title>
<path fill="none" stroke="black" d="M4814.94,-14483.25C4786.72,-14472.93 4754.02,-14460.97 4724.88,-14450.32"/>
<polygon fill="black" stroke="black" points="4725.74,-14446.91 4715.15,-14446.76 4723.34,-14453.49 4725.74,-14446.91"/>
</g>
<!-- kv_send1_0_11 -->
<g id="node686" class="node">
<title>kv_send1_0_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4662" cy="-14330.38" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4662" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="4662" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_0_11&#45;&gt;kv_send1_0_11 -->
<g id="edge941" class="edge">
<title>ring_stage1_0_11&#45;&gt;kv_send1_0_11</title>
<path fill="none" stroke="black" d="M4487.81,-14393.5C4520.73,-14381.77 4559.59,-14367.9 4592.25,-14356.25"/>
<polygon fill="black" stroke="black" points="4593.49,-14359.53 4601.73,-14352.87 4591.14,-14352.94 4593.49,-14359.53"/>
</g>
<!-- ring_stage1_1_11 -->
<g id="node702" class="node">
<title>ring_stage1_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4534,-14356.88 4314,-14356.88 4314,-14303.88 4534,-14303.88 4534,-14356.88"/>
<text text-anchor="middle" x="4424" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="4424" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_10×V_10</text>
<text text-anchor="middle" x="4424" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_0_11&#45;&gt;ring_stage1_1_11 -->
<g id="edge979" class="edge">
<title>ring_stage1_0_11&#45;&gt;ring_stage1_1_11</title>
<path fill="none" stroke="black" d="M4418.36,-14393.27C4419.11,-14385.06 4419.95,-14375.83 4420.75,-14367.05"/>
<polygon fill="black" stroke="black" points="4424.24,-14367.32 4421.66,-14357.04 4417.27,-14366.69 4424.24,-14367.32"/>
</g>
<!-- kv_send1_0_12 -->
<g id="node687" class="node">
<title>kv_send1_0_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4406" cy="-14240.64" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4406" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="4406" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_0_12&#45;&gt;kv_send1_0_12 -->
<g id="edge942" class="edge">
<title>ring_stage1_0_12&#45;&gt;kv_send1_0_12</title>
<path fill="none" stroke="black" d="M4789.84,-14305.13C4786.86,-14304.57 4783.91,-14304.03 4781,-14303.51 4667.46,-14283.24 4637.53,-14287.87 4524,-14267.51 4514.25,-14265.76 4504.07,-14263.77 4493.97,-14261.7"/>
<polygon fill="black" stroke="black" points="4494.41,-14258.22 4483.9,-14259.6 4492.98,-14265.07 4494.41,-14258.22"/>
</g>
<!-- ring_stage1_1_12 -->
<g id="node703" class="node">
<title>ring_stage1_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4991,-14267.14 4771,-14267.14 4771,-14214.14 4991,-14214.14 4991,-14267.14"/>
<text text-anchor="middle" x="4881" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="4881" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_11×V_11</text>
<text text-anchor="middle" x="4881" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_0_12&#45;&gt;ring_stage1_1_12 -->
<g id="edge982" class="edge">
<title>ring_stage1_0_12&#45;&gt;ring_stage1_1_12</title>
<path fill="none" stroke="black" d="M4894.4,-14303.53C4892.62,-14295.32 4890.63,-14286.09 4888.72,-14277.31"/>
<polygon fill="black" stroke="black" points="4892.1,-14276.34 4886.56,-14267.3 4885.25,-14277.82 4892.1,-14276.34"/>
</g>
<!-- kv_send1_0_13 -->
<g id="node688" class="node">
<title>kv_send1_0_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6244" cy="-15586.74" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6244" y="-15590.54" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6244" y="-15575.54" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_0_13&#45;&gt;kv_send1_0_13 -->
<g id="edge943" class="edge">
<title>ring_stage1_0_13&#45;&gt;kv_send1_0_13</title>
<path fill="none" stroke="black" d="M6244,-15676.06C6244,-15660.74 6244,-15641.03 6244,-15624.11"/>
<polygon fill="black" stroke="black" points="6247.5,-15624 6244,-15614 6240.5,-15624 6247.5,-15624"/>
</g>
<!-- ring_stage1_1_13 -->
<g id="node704" class="node">
<title>ring_stage1_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4276,-14177.4 4056,-14177.4 4056,-14124.4 4276,-14124.4 4276,-14177.4"/>
<text text-anchor="middle" x="4166" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="4166" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_12×V_12</text>
<text text-anchor="middle" x="4166" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_0_13&#45;&gt;ring_stage1_1_13 -->
<g id="edge985" class="edge">
<title>ring_stage1_0_13&#45;&gt;ring_stage1_1_13</title>
<path fill="none" stroke="black" d="M6133.89,-15694.39C5838.02,-15673.53 5048,-15607.56 5048,-15498 5048,-15498 5048,-15498 5048,-15406.26 5048,-15372.51 5000.36,-15134.53 4976,-15111.17 4917.11,-15054.7 4852.97,-15133.57 4796,-15075.17 4750.8,-15028.83 4786.04,-14994.65 4771,-14931.69 4767.11,-14915.42 4764.05,-14911.92 4760,-14895.69 4742.29,-14824.74 4751.26,-14621.75 4697,-14572.73 4631.93,-14513.94 4377.52,-14584.53 4304,-14536.73 4281.07,-14521.82 4292.18,-14503.43 4274,-14482.99 4228.8,-14432.15 4209.11,-14426.92 4150,-14393.25 4115.06,-14373.34 4089.06,-14390.87 4067,-14357.25 4032.01,-14303.94 4036.09,-14269.54 4067,-14213.77 4073.76,-14201.57 4084.04,-14191.46 4095.45,-14183.2"/>
<polygon fill="black" stroke="black" points="4097.58,-14185.99 4103.93,-14177.51 4093.68,-14180.17 4097.58,-14185.99"/>
</g>
<!-- kv_send1_0_14 -->
<g id="node689" class="node">
<title>kv_send1_0_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6482" cy="-15497" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6482" y="-15500.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6482" y="-15485.8" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_0_14&#45;&gt;kv_send1_0_14 -->
<g id="edge944" class="edge">
<title>ring_stage1_0_14&#45;&gt;kv_send1_0_14</title>
<path fill="none" stroke="black" d="M6482,-15559.89C6482,-15551.84 6482,-15542.81 6482,-15534.19"/>
<polygon fill="black" stroke="black" points="6485.5,-15533.97 6482,-15523.97 6478.5,-15533.97 6485.5,-15533.97"/>
</g>
<!-- ring_stage1_1_14 -->
<g id="node705" class="node">
<title>ring_stage1_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6354,-15523.5 6134,-15523.5 6134,-15470.5 6354,-15470.5 6354,-15523.5"/>
<text text-anchor="middle" x="6244" y="-15508.3" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="6244" y="-15493.3" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_13×V_13</text>
<text text-anchor="middle" x="6244" y="-15478.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_0_14&#45;&gt;ring_stage1_1_14 -->
<g id="edge988" class="edge">
<title>ring_stage1_0_14&#45;&gt;ring_stage1_1_14</title>
<path fill="none" stroke="black" d="M6412.52,-15560.13C6384.54,-15549.81 6352.11,-15537.86 6323.22,-15527.2"/>
<polygon fill="black" stroke="black" points="6324.16,-15523.82 6313.57,-15523.65 6321.74,-15530.39 6324.16,-15523.82"/>
</g>
<!-- kv_send1_0_15 -->
<g id="node690" class="node">
<title>kv_send1_0_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6916" cy="-15407.26" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6916" y="-15411.06" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="6916" y="-15396.06" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_0_15&#45;&gt;kv_send1_0_15 -->
<g id="edge945" class="edge">
<title>ring_stage1_0_15&#45;&gt;kv_send1_0_15</title>
<path fill="none" stroke="black" d="M6916,-15470.15C6916,-15462.1 6916,-15453.07 6916,-15444.45"/>
<polygon fill="black" stroke="black" points="6919.5,-15444.23 6916,-15434.23 6912.5,-15444.23 6919.5,-15444.23"/>
</g>
<!-- ring_stage1_1_15 -->
<g id="node706" class="node">
<title>ring_stage1_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6592,-15433.76 6372,-15433.76 6372,-15380.76 6592,-15380.76 6592,-15433.76"/>
<text text-anchor="middle" x="6482" y="-15418.56" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="6482" y="-15403.56" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_14×V_14</text>
<text text-anchor="middle" x="6482" y="-15388.56" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_0_15&#45;&gt;ring_stage1_1_15 -->
<g id="edge991" class="edge">
<title>ring_stage1_0_15&#45;&gt;ring_stage1_1_15</title>
<path fill="none" stroke="black" d="M6805.92,-15473.75C6743.83,-15461.19 6666.16,-15445.49 6602.44,-15432.61"/>
<polygon fill="black" stroke="black" points="6602.83,-15429.12 6592.34,-15430.57 6601.45,-15435.98 6602.83,-15429.12"/>
</g>
<!-- kv_send1_0_0&#45;&gt;ring_stage1_1_1 -->
<g id="edge950" class="edge">
<title>kv_send1_0_0&#45;&gt;ring_stage1_1_1</title>
<path fill="none" stroke="black" d="M7149,-15290.2C7149,-15282.16 7149,-15273.18 7149,-15264.62"/>
<polygon fill="black" stroke="black" points="7152.5,-15264.48 7149,-15254.48 7145.5,-15264.48 7152.5,-15264.48"/>
</g>
<!-- kv_send1_0_1&#45;&gt;ring_stage1_1_2 -->
<g id="edge953" class="edge">
<title>kv_send1_0_1&#45;&gt;ring_stage1_1_2</title>
<path fill="none" stroke="black" d="M7367,-15200.45C7367,-15192.42 7367,-15183.44 7367,-15174.88"/>
<polygon fill="black" stroke="black" points="7370.5,-15174.74 7367,-15164.74 7363.5,-15174.74 7370.5,-15174.74"/>
</g>
<!-- kv_send1_0_2&#45;&gt;ring_stage1_1_3 -->
<g id="edge956" class="edge">
<title>kv_send1_0_2&#45;&gt;ring_stage1_1_3</title>
<path fill="none" stroke="black" d="M7645.45,-15115.13C7672.87,-15104.09 7706.51,-15090.55 7736.13,-15078.63"/>
<polygon fill="black" stroke="black" points="7737.62,-15081.8 7745.59,-15074.82 7735.01,-15075.31 7737.62,-15081.8"/>
</g>
<!-- kv_send1_0_3&#45;&gt;ring_stage1_1_4 -->
<g id="edge959" class="edge">
<title>kv_send1_0_3&#45;&gt;ring_stage1_1_4</title>
<path fill="none" stroke="black" d="M7519.65,-15028.87C7506.22,-15025.96 7492.24,-15023.3 7479,-15021.43 7183.99,-14979.84 7101.93,-15028.23 6802.89,-14985.42"/>
<polygon fill="black" stroke="black" points="6803.02,-14981.9 6792.62,-14983.93 6802.01,-14988.83 6803.02,-14981.9"/>
</g>
<!-- kv_send1_0_4&#45;&gt;ring_stage1_1_5 -->
<g id="edge962" class="edge">
<title>kv_send1_0_4&#45;&gt;ring_stage1_1_5</title>
<path fill="none" stroke="black" d="M5293.55,-14935.65C5266.13,-14924.61 5232.49,-14911.07 5202.87,-14899.15"/>
<polygon fill="black" stroke="black" points="5203.99,-14895.83 5193.41,-14895.34 5201.38,-14902.32 5203.99,-14895.83"/>
</g>
<!-- kv_send1_0_5&#45;&gt;ring_stage1_1_6 -->
<g id="edge965" class="edge">
<title>kv_send1_0_5&#45;&gt;ring_stage1_1_6</title>
<path fill="none" stroke="black" d="M5432.7,-14853.29C5497.1,-14841.93 5588.11,-14825.21 5676.44,-14806.25"/>
<polygon fill="black" stroke="black" points="5677.32,-14809.64 5686.36,-14804.11 5675.84,-14802.8 5677.32,-14809.64"/>
</g>
<!-- kv_send1_0_6&#45;&gt;ring_stage1_1_7 -->
<g id="edge968" class="edge">
<title>kv_send1_0_6&#45;&gt;ring_stage1_1_7</title>
<path fill="none" stroke="black" d="M6151.37,-14760.24C6138.61,-14757.39 6125.45,-14754.59 6113,-14752.21 6011.95,-14732.86 5982.83,-14736.55 5877.75,-14716.28"/>
<polygon fill="black" stroke="black" points="5878.17,-14712.79 5867.68,-14714.31 5876.83,-14719.66 5878.17,-14712.79"/>
</g>
<!-- kv_send1_0_7&#45;&gt;ring_stage1_1_8 -->
<g id="edge971" class="edge">
<title>kv_send1_0_7&#45;&gt;ring_stage1_1_8</title>
<path fill="none" stroke="black" d="M5329,-14662.01C5329,-14653.98 5329,-14645 5329,-14636.44"/>
<polygon fill="black" stroke="black" points="5332.5,-14636.3 5329,-14626.3 5325.5,-14636.3 5332.5,-14636.3"/>
</g>
<!-- kv_send1_0_8&#45;&gt;ring_stage1_1_9 -->
<g id="edge974" class="edge">
<title>kv_send1_0_8&#45;&gt;ring_stage1_1_9</title>
<path fill="none" stroke="black" d="M5111,-14572.27C5111,-14564.24 5111,-14555.26 5111,-14546.7"/>
<polygon fill="black" stroke="black" points="5114.5,-14546.56 5111,-14536.56 5107.5,-14546.56 5114.5,-14546.56"/>
</g>
<!-- kv_send1_0_9&#45;&gt;ring_stage1_1_10 -->
<g id="edge977" class="edge">
<title>kv_send1_0_9&#45;&gt;ring_stage1_1_10</title>
<path fill="none" stroke="black" d="M4646.4,-14482.53C4646.22,-14474.5 4646.01,-14465.52 4645.82,-14456.96"/>
<polygon fill="black" stroke="black" points="4649.31,-14456.74 4645.59,-14446.82 4642.31,-14456.9 4649.31,-14456.74"/>
</g>
<!-- kv_send1_0_10&#45;&gt;ring_stage1_1_11 -->
<g id="edge980" class="edge">
<title>kv_send1_0_10&#45;&gt;ring_stage1_1_11</title>
<path fill="none" stroke="black" d="M4795.05,-14401.42C4781.7,-14398.59 4767.97,-14395.76 4755,-14393.25 4664.28,-14375.7 4638.52,-14375.4 4544.15,-14357.43"/>
<polygon fill="black" stroke="black" points="4544.66,-14353.97 4534.18,-14355.52 4543.34,-14360.84 4544.66,-14353.97"/>
</g>
<!-- kv_send1_0_11&#45;&gt;ring_stage1_1_12 -->
<g id="edge983" class="edge">
<title>kv_send1_0_11&#45;&gt;ring_stage1_1_12</title>
<path fill="none" stroke="black" d="M4717.55,-14307.12C4744.87,-14296.18 4778.18,-14282.83 4807.58,-14271.05"/>
<polygon fill="black" stroke="black" points="4808.99,-14274.26 4816.98,-14267.29 4806.39,-14267.76 4808.99,-14274.26"/>
</g>
<!-- kv_send1_0_12&#45;&gt;ring_stage1_1_13 -->
<g id="edge986" class="edge">
<title>kv_send1_0_12&#45;&gt;ring_stage1_1_13</title>
<path fill="none" stroke="black" d="M4346.67,-14217.95C4316.23,-14206.82 4278.71,-14193.1 4245.76,-14181.06"/>
<polygon fill="black" stroke="black" points="4246.75,-14177.69 4236.15,-14177.54 4244.34,-14184.27 4246.75,-14177.69"/>
</g>
<!-- kv_send1_0_13&#45;&gt;ring_stage1_1_14 -->
<g id="edge989" class="edge">
<title>kv_send1_0_13&#45;&gt;ring_stage1_1_14</title>
<path fill="none" stroke="black" d="M6244,-15559.42C6244,-15551.38 6244,-15542.4 6244,-15533.84"/>
<polygon fill="black" stroke="black" points="6247.5,-15533.7 6244,-15523.7 6240.5,-15533.7 6247.5,-15533.7"/>
</g>
<!-- kv_send1_0_14&#45;&gt;ring_stage1_1_15 -->
<g id="edge992" class="edge">
<title>kv_send1_0_14&#45;&gt;ring_stage1_1_15</title>
<path fill="none" stroke="black" d="M6482,-15469.68C6482,-15461.64 6482,-15452.66 6482,-15444.1"/>
<polygon fill="black" stroke="black" points="6485.5,-15443.96 6482,-15433.96 6478.5,-15443.96 6485.5,-15443.96"/>
</g>
<!-- kv_send1_0_15&#45;&gt;ring_stage1_1_0 -->
<g id="edge947" class="edge">
<title>kv_send1_0_15&#45;&gt;ring_stage1_1_0</title>
<path fill="none" stroke="black" d="M6916,-15379.94C6916,-15371.9 6916,-15362.92 6916,-15354.36"/>
<polygon fill="black" stroke="black" points="6919.5,-15354.22 6916,-15344.22 6912.5,-15354.22 6919.5,-15354.22"/>
</g>
<!-- kv_send1_1_0 -->
<g id="node707" class="node">
<title>kv_send1_1_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6916" cy="-15227.78" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6916" y="-15231.58" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="6916" y="-15216.58" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_1_0&#45;&gt;kv_send1_1_0 -->
<g id="edge948" class="edge">
<title>ring_stage1_1_0&#45;&gt;kv_send1_1_0</title>
<path fill="none" stroke="black" d="M6916,-15290.67C6916,-15282.62 6916,-15273.59 6916,-15264.97"/>
<polygon fill="black" stroke="black" points="6919.5,-15264.75 6916,-15254.75 6912.5,-15264.75 6919.5,-15264.75"/>
</g>
<!-- ring_stage1_2_0 -->
<g id="node723" class="node">
<title>ring_stage1_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6585.5,-15254.28 6374.5,-15254.28 6374.5,-15201.28 6585.5,-15201.28 6585.5,-15254.28"/>
<text text-anchor="middle" x="6480" y="-15239.08" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="6480" y="-15224.08" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_14×V_14</text>
<text text-anchor="middle" x="6480" y="-15209.08" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_1_0&#45;&gt;ring_stage1_2_0 -->
<g id="edge994" class="edge">
<title>ring_stage1_1_0&#45;&gt;ring_stage1_2_0</title>
<path fill="none" stroke="black" d="M6810.46,-15295.28C6745.61,-15282.23 6662.49,-15265.5 6595.83,-15252.09"/>
<polygon fill="black" stroke="black" points="6596.2,-15248.59 6585.7,-15250.05 6594.82,-15255.46 6596.2,-15248.59"/>
</g>
<!-- kv_send1_1_1 -->
<g id="node708" class="node">
<title>kv_send1_1_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7149" cy="-15138.04" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7149" y="-15141.84" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="7149" y="-15126.84" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_1_1&#45;&gt;kv_send1_1_1 -->
<g id="edge951" class="edge">
<title>ring_stage1_1_1&#45;&gt;kv_send1_1_1</title>
<path fill="none" stroke="black" d="M7149,-15200.93C7149,-15192.88 7149,-15183.85 7149,-15175.23"/>
<polygon fill="black" stroke="black" points="7152.5,-15175.01 7149,-15165.01 7145.5,-15175.01 7152.5,-15175.01"/>
</g>
<!-- ring_stage1_2_1 -->
<g id="node724" class="node">
<title>ring_stage1_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7021.5,-15164.54 6810.5,-15164.54 6810.5,-15111.54 7021.5,-15111.54 7021.5,-15164.54"/>
<text text-anchor="middle" x="6916" y="-15149.34" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="6916" y="-15134.34" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_15×V_15</text>
<text text-anchor="middle" x="6916" y="-15119.34" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_1_1&#45;&gt;ring_stage1_2_1 -->
<g id="edge997" class="edge">
<title>ring_stage1_1_1&#45;&gt;ring_stage1_2_1</title>
<path fill="none" stroke="black" d="M7080.98,-15201.17C7053.59,-15190.85 7021.84,-15178.9 6993.55,-15168.24"/>
<polygon fill="black" stroke="black" points="6994.7,-15164.93 6984.1,-15164.69 6992.23,-15171.49 6994.7,-15164.93"/>
</g>
<!-- kv_send1_1_2 -->
<g id="node709" class="node">
<title>kv_send1_1_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7367" cy="-15048.3" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7367" y="-15052.1" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="7367" y="-15037.1" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_1_2&#45;&gt;kv_send1_1_2 -->
<g id="edge954" class="edge">
<title>ring_stage1_1_2&#45;&gt;kv_send1_1_2</title>
<path fill="none" stroke="black" d="M7367,-15111.19C7367,-15103.14 7367,-15094.11 7367,-15085.49"/>
<polygon fill="black" stroke="black" points="7370.5,-15085.27 7367,-15075.27 7363.5,-15085.27 7370.5,-15085.27"/>
</g>
<!-- ring_stage1_2_2 -->
<g id="node725" class="node">
<title>ring_stage1_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7245.5,-15074.8 7052.5,-15074.8 7052.5,-15021.8 7245.5,-15021.8 7245.5,-15074.8"/>
<text text-anchor="middle" x="7149" y="-15059.6" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="7149" y="-15044.6" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_0×V_0</text>
<text text-anchor="middle" x="7149" y="-15029.6" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_1_2&#45;&gt;ring_stage1_2_2 -->
<g id="edge1000" class="edge">
<title>ring_stage1_1_2&#45;&gt;ring_stage1_2_2</title>
<path fill="none" stroke="black" d="M7303.36,-15111.43C7277.95,-15101.2 7248.54,-15089.36 7222.25,-15078.78"/>
<polygon fill="black" stroke="black" points="7223.3,-15075.43 7212.72,-15074.95 7220.69,-15081.93 7223.3,-15075.43"/>
</g>
<!-- kv_send1_1_3 -->
<g id="node710" class="node">
<title>kv_send1_1_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7591" cy="-14958.56" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7591" y="-14962.36" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7591" y="-14947.36" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_1_3&#45;&gt;kv_send1_1_3 -->
<g id="edge957" class="edge">
<title>ring_stage1_1_3&#45;&gt;kv_send1_1_3</title>
<path fill="none" stroke="black" d="M7745.36,-15021.69C7716.91,-15010.23 7683.43,-14996.76 7654.94,-14985.3"/>
<polygon fill="black" stroke="black" points="7656.07,-14981.98 7645.49,-14981.49 7653.46,-14988.47 7656.07,-14981.98"/>
</g>
<!-- ring_stage1_2_3 -->
<g id="node726" class="node">
<title>ring_stage1_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7905.5,-14985.06 7712.5,-14985.06 7712.5,-14932.06 7905.5,-14932.06 7905.5,-14985.06"/>
<text text-anchor="middle" x="7809" y="-14969.86" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="7809" y="-14954.86" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_1×V_1</text>
<text text-anchor="middle" x="7809" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_1_3&#45;&gt;ring_stage1_2_3 -->
<g id="edge1003" class="edge">
<title>ring_stage1_1_3&#45;&gt;ring_stage1_2_3</title>
<path fill="none" stroke="black" d="M7809,-15021.45C7809,-15013.24 7809,-15004.01 7809,-14995.23"/>
<polygon fill="black" stroke="black" points="7812.5,-14995.23 7809,-14985.23 7805.5,-14995.23 7812.5,-14995.23"/>
</g>
<!-- kv_send1_1_4 -->
<g id="node711" class="node">
<title>kv_send1_1_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5799" cy="-14868.82" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5799" y="-14872.62" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5799" y="-14857.62" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_1_4&#45;&gt;kv_send1_1_4 -->
<g id="edge960" class="edge">
<title>ring_stage1_1_4&#45;&gt;kv_send1_1_4</title>
<path fill="none" stroke="black" d="M6599.37,-14933.29C6596.22,-14932.72 6593.09,-14932.18 6590,-14931.69 6383.11,-14898.74 6328.86,-14912.1 6120,-14895.69 6048.99,-14890.11 5969.15,-14883.67 5906.86,-14878.62"/>
<polygon fill="black" stroke="black" points="5906.88,-14875.11 5896.62,-14877.79 5906.31,-14882.09 5906.88,-14875.11"/>
</g>
<!-- ring_stage1_2_4 -->
<g id="node727" class="node">
<title>ring_stage1_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6993.5,-14895.32 6800.5,-14895.32 6800.5,-14842.32 6993.5,-14842.32 6993.5,-14895.32"/>
<text text-anchor="middle" x="6897" y="-14880.12" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="6897" y="-14865.12" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_2×V_2</text>
<text text-anchor="middle" x="6897" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_1_4&#45;&gt;ring_stage1_2_4 -->
<g id="edge1006" class="edge">
<title>ring_stage1_1_4&#45;&gt;ring_stage1_2_4</title>
<path fill="none" stroke="black" d="M6754.68,-14931.95C6777.9,-14921.81 6804.75,-14910.09 6828.82,-14899.58"/>
<polygon fill="black" stroke="black" points="6830.48,-14902.67 6838.25,-14895.47 6827.68,-14896.26 6830.48,-14902.67"/>
</g>
<!-- kv_send1_1_5 -->
<g id="node712" class="node">
<title>kv_send1_1_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5354" cy="-14779.08" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5354" y="-14782.88" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="5354" y="-14767.88" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_1_5&#45;&gt;kv_send1_1_5 -->
<g id="edge963" class="edge">
<title>ring_stage1_1_5&#45;&gt;kv_send1_1_5</title>
<path fill="none" stroke="black" d="M5195.39,-14842.21C5224.87,-14830.66 5259.6,-14817.06 5289.03,-14805.53"/>
<polygon fill="black" stroke="black" points="5290.35,-14808.77 5298.38,-14801.86 5287.8,-14802.25 5290.35,-14808.77"/>
</g>
<!-- ring_stage1_2_5 -->
<g id="node728" class="node">
<title>ring_stage1_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5668.5,-14805.58 5475.5,-14805.58 5475.5,-14752.58 5668.5,-14752.58 5668.5,-14805.58"/>
<text text-anchor="middle" x="5572" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5572" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_3×V_3</text>
<text text-anchor="middle" x="5572" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_1_5&#45;&gt;ring_stage1_2_5 -->
<g id="edge1009" class="edge">
<title>ring_stage1_1_5&#45;&gt;ring_stage1_2_5</title>
<path fill="none" stroke="black" d="M5226.69,-14843.87C5229.82,-14843.2 5232.94,-14842.56 5236,-14841.95 5334.39,-14822.28 5362.83,-14825.98 5465.48,-14805.98"/>
<polygon fill="black" stroke="black" points="5466.18,-14809.4 5475.31,-14804.03 5464.82,-14802.54 5466.18,-14809.4"/>
</g>
<!-- kv_send1_1_6 -->
<g id="node713" class="node">
<title>kv_send1_1_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6200" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6200" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6200" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_1_6&#45;&gt;kv_send1_1_6 -->
<g id="edge966" class="edge">
<title>ring_stage1_1_6&#45;&gt;kv_send1_1_6</title>
<path fill="none" stroke="black" d="M5879.71,-14754.22C5882.84,-14753.53 5885.94,-14752.86 5889,-14752.21 5976.92,-14733.55 5999.97,-14734.33 6088,-14716.21 6097.07,-14714.34 6106.53,-14712.3 6115.94,-14710.22"/>
<polygon fill="black" stroke="black" points="6116.71,-14713.63 6125.71,-14708.03 6115.18,-14706.8 6116.71,-14713.63"/>
</g>
<!-- ring_stage1_2_6 -->
<g id="node729" class="node">
<title>ring_stage1_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6078.5,-14715.84 5885.5,-14715.84 5885.5,-14662.84 6078.5,-14662.84 6078.5,-14715.84"/>
<text text-anchor="middle" x="5982" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5982" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_4×V_4</text>
<text text-anchor="middle" x="5982" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_1_6&#45;&gt;ring_stage1_2_6 -->
<g id="edge1012" class="edge">
<title>ring_stage1_1_6&#45;&gt;ring_stage1_2_6</title>
<path fill="none" stroke="black" d="M5841.09,-14752.47C5864.08,-14742.33 5890.66,-14730.61 5914.5,-14720.1"/>
<polygon fill="black" stroke="black" points="5916.1,-14723.22 5923.83,-14715.98 5913.27,-14716.82 5916.1,-14723.22"/>
</g>
<!-- kv_send1_1_7 -->
<g id="node714" class="node">
<title>kv_send1_1_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5551" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5551" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="5551" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_1_7&#45;&gt;kv_send1_1_7 -->
<g id="edge969" class="edge">
<title>ring_stage1_1_7&#45;&gt;kv_send1_1_7</title>
<path fill="none" stroke="black" d="M5706.78,-14662.73C5678.06,-14651.27 5644.28,-14637.8 5615.53,-14626.33"/>
<polygon fill="black" stroke="black" points="5616.57,-14622.98 5605.99,-14622.53 5613.98,-14629.48 5616.57,-14622.98"/>
</g>
<!-- ring_stage1_2_7 -->
<g id="node730" class="node">
<title>ring_stage1_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6079.5,-14626.1 5886.5,-14626.1 5886.5,-14573.1 6079.5,-14573.1 6079.5,-14626.1"/>
<text text-anchor="middle" x="5983" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5983" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_5×V_5</text>
<text text-anchor="middle" x="5983" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_1_7&#45;&gt;ring_stage1_2_7 -->
<g id="edge1015" class="edge">
<title>ring_stage1_1_7&#45;&gt;ring_stage1_2_7</title>
<path fill="none" stroke="black" d="M5832.89,-14662.73C5857.6,-14652.5 5886.2,-14640.66 5911.76,-14630.08"/>
<polygon fill="black" stroke="black" points="5913.13,-14633.3 5921.03,-14626.24 5910.46,-14626.84 5913.13,-14633.3"/>
</g>
<!-- kv_send1_1_8 -->
<g id="node715" class="node">
<title>kv_send1_1_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5329" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5329" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="5329" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_1_8&#45;&gt;kv_send1_1_8 -->
<g id="edge972" class="edge">
<title>ring_stage1_1_8&#45;&gt;kv_send1_1_8</title>
<path fill="none" stroke="black" d="M5329,-14572.75C5329,-14564.7 5329,-14555.67 5329,-14547.05"/>
<polygon fill="black" stroke="black" points="5332.5,-14546.83 5329,-14536.83 5325.5,-14546.83 5332.5,-14546.83"/>
</g>
<!-- ring_stage1_2_8 -->
<g id="node731" class="node">
<title>ring_stage1_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5643.5,-14536.36 5450.5,-14536.36 5450.5,-14483.36 5643.5,-14483.36 5643.5,-14536.36"/>
<text text-anchor="middle" x="5547" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5547" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_6×V_6</text>
<text text-anchor="middle" x="5547" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_1_8&#45;&gt;ring_stage1_2_8 -->
<g id="edge1018" class="edge">
<title>ring_stage1_1_8&#45;&gt;ring_stage1_2_8</title>
<path fill="none" stroke="black" d="M5392.64,-14572.99C5418.05,-14562.76 5447.46,-14550.92 5473.75,-14540.34"/>
<polygon fill="black" stroke="black" points="5475.31,-14543.49 5483.28,-14536.5 5472.7,-14536.99 5475.31,-14543.49"/>
</g>
<!-- kv_send1_1_9 -->
<g id="node716" class="node">
<title>kv_send1_1_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5111" cy="-14420.12" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5111" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="5111" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_1_9&#45;&gt;kv_send1_1_9 -->
<g id="edge975" class="edge">
<title>ring_stage1_1_9&#45;&gt;kv_send1_1_9</title>
<path fill="none" stroke="black" d="M5111,-14483.01C5111,-14474.96 5111,-14465.93 5111,-14457.31"/>
<polygon fill="black" stroke="black" points="5114.5,-14457.09 5111,-14447.09 5107.5,-14457.09 5114.5,-14457.09"/>
</g>
<!-- ring_stage1_2_9 -->
<g id="node732" class="node">
<title>ring_stage1_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5431.5,-14446.62 5238.5,-14446.62 5238.5,-14393.62 5431.5,-14393.62 5431.5,-14446.62"/>
<text text-anchor="middle" x="5335" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5335" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_7×V_7</text>
<text text-anchor="middle" x="5335" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_1_9&#45;&gt;ring_stage1_2_9 -->
<g id="edge1021" class="edge">
<title>ring_stage1_1_9&#45;&gt;ring_stage1_2_9</title>
<path fill="none" stroke="black" d="M5176.39,-14483.25C5202.61,-14472.97 5232.98,-14461.08 5260.09,-14450.46"/>
<polygon fill="black" stroke="black" points="5261.49,-14453.67 5269.53,-14446.76 5258.94,-14447.15 5261.49,-14453.67"/>
</g>
<!-- kv_send1_1_10 -->
<g id="node717" class="node">
<title>kv_send1_1_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4186" cy="-14330.38" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4186" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="4186" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_1_10&#45;&gt;kv_send1_1_10 -->
<g id="edge978" class="edge">
<title>ring_stage1_1_10&#45;&gt;kv_send1_1_10</title>
<path fill="none" stroke="black" d="M4543.77,-14395.01C4540.82,-14394.4 4537.89,-14393.81 4535,-14393.25 4433.46,-14373.39 4406.71,-14376.25 4305,-14357.25 4295.08,-14355.4 4284.72,-14353.33 4274.43,-14351.21"/>
<polygon fill="black" stroke="black" points="4275.11,-14347.77 4264.6,-14349.15 4273.67,-14354.62 4275.11,-14347.77"/>
</g>
<!-- ring_stage1_2_10 -->
<g id="node733" class="node">
<title>ring_stage1_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5230,-14356.88 5028,-14356.88 5028,-14303.88 5230,-14303.88 5230,-14356.88"/>
<text text-anchor="middle" x="5129" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="5129" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_8×V_8</text>
<text text-anchor="middle" x="5129" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_1_10&#45;&gt;ring_stage1_2_10 -->
<g id="edge1024" class="edge">
<title>ring_stage1_1_10&#45;&gt;ring_stage1_2_10</title>
<path fill="none" stroke="black" d="M4746.22,-14394.93C4749.17,-14394.35 4752.11,-14393.79 4755,-14393.25 4868.25,-14372.26 4900.8,-14378.46 5017.72,-14357.41"/>
<polygon fill="black" stroke="black" points="5018.57,-14360.81 5027.78,-14355.57 5017.32,-14353.92 5018.57,-14360.81"/>
</g>
<!-- kv_send1_1_11 -->
<g id="node718" class="node">
<title>kv_send1_1_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4643" cy="-14240.64" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4643" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="4643" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_1_11&#45;&gt;kv_send1_1_11 -->
<g id="edge981" class="edge">
<title>ring_stage1_1_11&#45;&gt;kv_send1_1_11</title>
<path fill="none" stroke="black" d="M4487.93,-14303.76C4516.29,-14292.4 4549.61,-14279.05 4578.08,-14267.65"/>
<polygon fill="black" stroke="black" points="4579.55,-14270.83 4587.54,-14263.86 4576.95,-14264.33 4579.55,-14270.83"/>
</g>
<!-- ring_stage1_2_11 -->
<g id="node734" class="node">
<title>ring_stage1_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4278,-14267.14 4076,-14267.14 4076,-14214.14 4278,-14214.14 4278,-14267.14"/>
<text text-anchor="middle" x="4177" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="4177" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_9×V_9</text>
<text text-anchor="middle" x="4177" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_1_11&#45;&gt;ring_stage1_2_11 -->
<g id="edge1027" class="edge">
<title>ring_stage1_1_11&#45;&gt;ring_stage1_2_11</title>
<path fill="none" stroke="black" d="M4351.89,-14303.76C4322.73,-14293.4 4288.91,-14281.39 4258.82,-14270.7"/>
<polygon fill="black" stroke="black" points="4259.79,-14267.33 4249.2,-14267.28 4257.45,-14273.93 4259.79,-14267.33"/>
</g>
<!-- kv_send1_1_12 -->
<g id="node719" class="node">
<title>kv_send1_1_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4641" cy="-14150.9" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4641" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="4641" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_1_12&#45;&gt;kv_send1_1_12 -->
<g id="edge984" class="edge">
<title>ring_stage1_1_12&#45;&gt;kv_send1_1_12</title>
<path fill="none" stroke="black" d="M4810.94,-14214.02C4779.09,-14202.38 4741.53,-14188.65 4709.83,-14177.06"/>
<polygon fill="black" stroke="black" points="4710.79,-14173.69 4700.19,-14173.54 4708.38,-14180.26 4710.79,-14173.69"/>
</g>
<!-- ring_stage1_2_12 -->
<g id="node735" class="node">
<title>ring_stage1_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4989,-14177.4 4769,-14177.4 4769,-14124.4 4989,-14124.4 4989,-14177.4"/>
<text text-anchor="middle" x="4879" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="4879" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_10×V_10</text>
<text text-anchor="middle" x="4879" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_1_12&#45;&gt;ring_stage1_2_12 -->
<g id="edge1030" class="edge">
<title>ring_stage1_1_12&#45;&gt;ring_stage1_2_12</title>
<path fill="none" stroke="black" d="M4880.41,-14213.79C4880.22,-14205.58 4880.01,-14196.35 4879.81,-14187.57"/>
<polygon fill="black" stroke="black" points="4883.31,-14187.48 4879.59,-14177.56 4876.31,-14187.64 4883.31,-14187.48"/>
</g>
<!-- kv_send1_1_13 -->
<g id="node720" class="node">
<title>kv_send1_1_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4166" cy="-14061.16" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4166" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="4166" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_1_13&#45;&gt;kv_send1_1_13 -->
<g id="edge987" class="edge">
<title>ring_stage1_1_13&#45;&gt;kv_send1_1_13</title>
<path fill="none" stroke="black" d="M4166,-14124.05C4166,-14116 4166,-14106.97 4166,-14098.35"/>
<polygon fill="black" stroke="black" points="4169.5,-14098.13 4166,-14088.13 4162.5,-14098.13 4169.5,-14098.13"/>
</g>
<!-- ring_stage1_2_13 -->
<g id="node736" class="node">
<title>ring_stage1_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4514,-14087.66 4294,-14087.66 4294,-14034.66 4514,-14034.66 4514,-14087.66"/>
<text text-anchor="middle" x="4404" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="4404" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_11×V_11</text>
<text text-anchor="middle" x="4404" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_1_13&#45;&gt;ring_stage1_2_13 -->
<g id="edge1033" class="edge">
<title>ring_stage1_1_13&#45;&gt;ring_stage1_2_13</title>
<path fill="none" stroke="black" d="M4235.48,-14124.28C4263.46,-14113.97 4295.89,-14102.01 4324.78,-14091.36"/>
<polygon fill="black" stroke="black" points="4326.26,-14094.55 4334.43,-14087.8 4323.84,-14087.98 4326.26,-14094.55"/>
</g>
<!-- kv_send1_1_14 -->
<g id="node721" class="node">
<title>kv_send1_1_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6244" cy="-15407.26" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6244" y="-15411.06" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6244" y="-15396.06" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_1_14&#45;&gt;kv_send1_1_14 -->
<g id="edge990" class="edge">
<title>ring_stage1_1_14&#45;&gt;kv_send1_1_14</title>
<path fill="none" stroke="black" d="M6244,-15470.15C6244,-15462.1 6244,-15453.07 6244,-15444.45"/>
<polygon fill="black" stroke="black" points="6247.5,-15444.23 6244,-15434.23 6240.5,-15444.23 6247.5,-15444.23"/>
</g>
<!-- ring_stage1_2_14 -->
<g id="node737" class="node">
<title>ring_stage1_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4256,-13997.92 4036,-13997.92 4036,-13944.92 4256,-13944.92 4256,-13997.92"/>
<text text-anchor="middle" x="4146" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="4146" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_12×V_12</text>
<text text-anchor="middle" x="4146" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_1_14&#45;&gt;ring_stage1_2_14 -->
<g id="edge1036" class="edge">
<title>ring_stage1_1_14&#45;&gt;ring_stage1_2_14</title>
<path fill="none" stroke="black" d="M6133.93,-15489.58C5914.58,-15473.53 5410.87,-15420.21 5025,-15254.65 4897.97,-15200.15 4857.32,-15183.13 4771,-15075.17 4673.95,-14953.79 4739.07,-14869.39 4637,-14752.21 4428.52,-14512.87 4180.36,-14642.91 4042,-14357.25 4019.58,-14310.96 4037,-14293.07 4037,-14241.64 4037,-14241.64 4037,-14241.64 4037,-14149.9 4037,-14098.32 4020.08,-14078.28 4047,-14034.29 4054.41,-14022.19 4065.17,-14012.08 4076.89,-14003.77"/>
<polygon fill="black" stroke="black" points="4079.15,-14006.48 4085.57,-13998.05 4075.29,-14000.64 4079.15,-14006.48"/>
</g>
<!-- kv_send1_1_15 -->
<g id="node722" class="node">
<title>kv_send1_1_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6480" cy="-15317.52" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6480" y="-15321.32" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="6480" y="-15306.32" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_1_15&#45;&gt;kv_send1_1_15 -->
<g id="edge993" class="edge">
<title>ring_stage1_1_15&#45;&gt;kv_send1_1_15</title>
<path fill="none" stroke="black" d="M6481.41,-15380.41C6481.23,-15372.36 6481.02,-15363.33 6480.82,-15354.71"/>
<polygon fill="black" stroke="black" points="6484.32,-15354.41 6480.59,-15344.49 6477.32,-15354.57 6484.32,-15354.41"/>
</g>
<!-- ring_stage1_2_15 -->
<g id="node738" class="node">
<title>ring_stage1_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6356,-15344.02 6136,-15344.02 6136,-15291.02 6356,-15291.02 6356,-15344.02"/>
<text text-anchor="middle" x="6246" y="-15328.82" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="6246" y="-15313.82" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_13×V_13</text>
<text text-anchor="middle" x="6246" y="-15298.82" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_1_15&#45;&gt;ring_stage1_2_15 -->
<g id="edge1039" class="edge">
<title>ring_stage1_1_15&#45;&gt;ring_stage1_2_15</title>
<path fill="none" stroke="black" d="M6413.1,-15380.65C6385.36,-15370.33 6353.2,-15358.38 6324.55,-15347.72"/>
<polygon fill="black" stroke="black" points="6325.57,-15344.37 6314.98,-15344.17 6323.13,-15350.93 6325.57,-15344.37"/>
</g>
<!-- kv_send1_1_0&#45;&gt;ring_stage1_2_1 -->
<g id="edge998" class="edge">
<title>kv_send1_1_0&#45;&gt;ring_stage1_2_1</title>
<path fill="none" stroke="black" d="M6916,-15200.45C6916,-15192.42 6916,-15183.44 6916,-15174.88"/>
<polygon fill="black" stroke="black" points="6919.5,-15174.74 6916,-15164.74 6912.5,-15174.74 6919.5,-15174.74"/>
</g>
<!-- kv_send1_1_1&#45;&gt;ring_stage1_2_2 -->
<g id="edge1001" class="edge">
<title>kv_send1_1_1&#45;&gt;ring_stage1_2_2</title>
<path fill="none" stroke="black" d="M7149,-15110.71C7149,-15102.68 7149,-15093.7 7149,-15085.14"/>
<polygon fill="black" stroke="black" points="7152.5,-15085 7149,-15075 7145.5,-15085 7152.5,-15085"/>
</g>
<!-- kv_send1_1_2&#45;&gt;ring_stage1_2_3 -->
<g id="edge1004" class="edge">
<title>kv_send1_1_2&#45;&gt;ring_stage1_2_3</title>
<path fill="none" stroke="black" d="M7440.95,-15029.47C7453.61,-15026.64 7466.66,-15023.84 7479,-15021.43 7574.87,-15002.68 7602.46,-15005.21 7702.41,-14985.48"/>
<polygon fill="black" stroke="black" points="7703.19,-14988.89 7712.31,-14983.5 7701.82,-14982.03 7703.19,-14988.89"/>
</g>
<!-- kv_send1_1_3&#45;&gt;ring_stage1_2_4 -->
<g id="edge1007" class="edge">
<title>kv_send1_1_3&#45;&gt;ring_stage1_2_4</title>
<path fill="none" stroke="black" d="M7519.01,-14939.24C7505.77,-14936.35 7492.02,-14933.67 7479,-14931.69 7272.54,-14900.22 7214.35,-14928.05 7003.77,-14895.68"/>
<polygon fill="black" stroke="black" points="7004.05,-14892.18 6993.63,-14894.09 7002.97,-14899.1 7004.05,-14892.18"/>
</g>
<!-- kv_send1_1_4&#45;&gt;ring_stage1_2_5 -->
<g id="edge1010" class="edge">
<title>kv_send1_1_4&#45;&gt;ring_stage1_2_5</title>
<path fill="none" stroke="black" d="M5742.89,-14846.13C5714.21,-14835.05 5678.91,-14821.4 5647.84,-14809.39"/>
<polygon fill="black" stroke="black" points="5648.94,-14806.07 5638.35,-14805.73 5646.42,-14812.6 5648.94,-14806.07"/>
</g>
<!-- kv_send1_1_5&#45;&gt;ring_stage1_2_6 -->
<g id="edge1013" class="edge">
<title>kv_send1_1_5&#45;&gt;ring_stage1_2_6</title>
<path fill="none" stroke="black" d="M5426.66,-14759.9C5440.01,-14757 5453.88,-14754.28 5467,-14752.21 5644.43,-14724.25 5694.74,-14745.38 5875.32,-14716.38"/>
<polygon fill="black" stroke="black" points="5876.12,-14719.8 5885.43,-14714.73 5874.99,-14712.89 5876.12,-14719.8"/>
</g>
<!-- kv_send1_1_6&#45;&gt;ring_stage1_2_7 -->
<g id="edge1016" class="edge">
<title>kv_send1_1_6&#45;&gt;ring_stage1_2_7</title>
<path fill="none" stroke="black" d="M6145.8,-14666.42C6118.5,-14655.39 6085.02,-14641.85 6055.54,-14629.93"/>
<polygon fill="black" stroke="black" points="6056.7,-14626.62 6046.12,-14626.12 6054.08,-14633.11 6056.7,-14626.62"/>
</g>
<!-- kv_send1_1_7&#45;&gt;ring_stage1_2_8 -->
<g id="edge1019" class="edge">
<title>kv_send1_1_7&#45;&gt;ring_stage1_2_8</title>
<path fill="none" stroke="black" d="M5549.8,-14572.27C5549.43,-14564.24 5549.02,-14555.26 5548.63,-14546.7"/>
<polygon fill="black" stroke="black" points="5552.12,-14546.39 5548.17,-14536.56 5545.13,-14546.71 5552.12,-14546.39"/>
</g>
<!-- kv_send1_1_8&#45;&gt;ring_stage1_2_9 -->
<g id="edge1022" class="edge">
<title>kv_send1_1_8&#45;&gt;ring_stage1_2_9</title>
<path fill="none" stroke="black" d="M5330.8,-14482.53C5331.35,-14474.5 5331.96,-14465.52 5332.55,-14456.96"/>
<polygon fill="black" stroke="black" points="5336.05,-14457.04 5333.24,-14446.82 5329.07,-14456.56 5336.05,-14457.04"/>
</g>
<!-- kv_send1_1_9&#45;&gt;ring_stage1_2_10 -->
<g id="edge1025" class="edge">
<title>kv_send1_1_9&#45;&gt;ring_stage1_2_10</title>
<path fill="none" stroke="black" d="M5116.3,-14393.27C5117.99,-14385.06 5119.88,-14375.83 5121.68,-14367.05"/>
<polygon fill="black" stroke="black" points="5125.15,-14367.54 5123.73,-14357.04 5118.3,-14366.14 5125.15,-14367.54"/>
</g>
<!-- kv_send1_1_10&#45;&gt;ring_stage1_2_11 -->
<g id="edge1028" class="edge">
<title>kv_send1_1_10&#45;&gt;ring_stage1_2_11</title>
<path fill="none" stroke="black" d="M4183.3,-14303.05C4182.48,-14295.02 4181.55,-14286.04 4180.68,-14277.48"/>
<polygon fill="black" stroke="black" points="4184.14,-14276.93 4179.64,-14267.34 4177.18,-14277.65 4184.14,-14276.93"/>
</g>
<!-- kv_send1_1_11&#45;&gt;ring_stage1_2_12 -->
<g id="edge1031" class="edge">
<title>kv_send1_1_11&#45;&gt;ring_stage1_2_12</title>
<path fill="none" stroke="black" d="M4701.64,-14217.84C4731.58,-14206.7 4768.42,-14193.01 4800.75,-14180.99"/>
<polygon fill="black" stroke="black" points="4802.03,-14184.25 4810.19,-14177.48 4799.59,-14177.69 4802.03,-14184.25"/>
</g>
<!-- kv_send1_1_12&#45;&gt;ring_stage1_2_13 -->
<g id="edge1034" class="edge">
<title>kv_send1_1_12&#45;&gt;ring_stage1_2_13</title>
<path fill="none" stroke="black" d="M4582.11,-14128.1C4552.04,-14116.96 4515.05,-14103.27 4482.58,-14091.25"/>
<polygon fill="black" stroke="black" points="4483.7,-14087.93 4473.11,-14087.74 4481.27,-14094.5 4483.7,-14087.93"/>
</g>
<!-- kv_send1_1_13&#45;&gt;ring_stage1_2_14 -->
<g id="edge1037" class="edge">
<title>kv_send1_1_13&#45;&gt;ring_stage1_2_14</title>
<path fill="none" stroke="black" d="M4160.11,-14034.31C4158.24,-14026.1 4156.13,-14016.87 4154.13,-14008.09"/>
<polygon fill="black" stroke="black" points="4157.49,-14007.06 4151.85,-13998.08 4150.66,-14008.61 4157.49,-14007.06"/>
</g>
<!-- kv_send1_1_14&#45;&gt;ring_stage1_2_15 -->
<g id="edge1040" class="edge">
<title>kv_send1_1_14&#45;&gt;ring_stage1_2_15</title>
<path fill="none" stroke="black" d="M6244.6,-15379.94C6244.78,-15371.9 6244.99,-15362.92 6245.18,-15354.36"/>
<polygon fill="black" stroke="black" points="6248.69,-15354.3 6245.41,-15344.22 6241.69,-15354.14 6248.69,-15354.3"/>
</g>
<!-- kv_send1_1_15&#45;&gt;ring_stage1_2_0 -->
<g id="edge995" class="edge">
<title>kv_send1_1_15&#45;&gt;ring_stage1_2_0</title>
<path fill="none" stroke="black" d="M6480,-15290.2C6480,-15282.16 6480,-15273.18 6480,-15264.62"/>
<polygon fill="black" stroke="black" points="6483.5,-15264.48 6480,-15254.48 6476.5,-15264.48 6483.5,-15264.48"/>
</g>
<!-- kv_send1_2_0 -->
<g id="node739" class="node">
<title>kv_send1_2_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6479" cy="-15138.04" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6479" y="-15141.84" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="6479" y="-15126.84" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_2_0&#45;&gt;kv_send1_2_0 -->
<g id="edge996" class="edge">
<title>ring_stage1_2_0&#45;&gt;kv_send1_2_0</title>
<path fill="none" stroke="black" d="M6479.71,-15200.93C6479.61,-15192.88 6479.51,-15183.85 6479.41,-15175.23"/>
<polygon fill="black" stroke="black" points="6482.91,-15174.97 6479.3,-15165.01 6475.91,-15175.05 6482.91,-15174.97"/>
</g>
<!-- ring_stage1_3_0 -->
<g id="node755" class="node">
<title>ring_stage1_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6354.5,-15164.54 6143.5,-15164.54 6143.5,-15111.54 6354.5,-15111.54 6354.5,-15164.54"/>
<text text-anchor="middle" x="6249" y="-15149.34" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6249" y="-15134.34" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_13×V_13</text>
<text text-anchor="middle" x="6249" y="-15119.34" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_2_0&#45;&gt;ring_stage1_3_0 -->
<g id="edge1042" class="edge">
<title>ring_stage1_2_0&#45;&gt;ring_stage1_3_0</title>
<path fill="none" stroke="black" d="M6412.56,-15201.17C6385.4,-15190.85 6353.93,-15178.9 6325.89,-15168.24"/>
<polygon fill="black" stroke="black" points="6327.11,-15164.96 6316.52,-15164.69 6324.63,-15171.51 6327.11,-15164.96"/>
</g>
<!-- kv_send1_2_1 -->
<g id="node740" class="node">
<title>kv_send1_2_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6916" cy="-15048.3" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6916" y="-15052.1" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="6916" y="-15037.1" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_2_1&#45;&gt;kv_send1_2_1 -->
<g id="edge999" class="edge">
<title>ring_stage1_2_1&#45;&gt;kv_send1_2_1</title>
<path fill="none" stroke="black" d="M6916,-15111.19C6916,-15103.14 6916,-15094.11 6916,-15085.49"/>
<polygon fill="black" stroke="black" points="6919.5,-15085.27 6916,-15075.27 6912.5,-15085.27 6919.5,-15085.27"/>
</g>
<!-- ring_stage1_3_1 -->
<g id="node756" class="node">
<title>ring_stage1_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6583.5,-15074.8 6372.5,-15074.8 6372.5,-15021.8 6583.5,-15021.8 6583.5,-15074.8"/>
<text text-anchor="middle" x="6478" y="-15059.6" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6478" y="-15044.6" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_14×V_14</text>
<text text-anchor="middle" x="6478" y="-15029.6" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_2_1&#45;&gt;ring_stage1_3_1 -->
<g id="edge1045" class="edge">
<title>ring_stage1_2_1&#45;&gt;ring_stage1_3_1</title>
<path fill="none" stroke="black" d="M6810.25,-15115.86C6744.88,-15102.76 6660.92,-15085.94 6593.77,-15072.49"/>
<polygon fill="black" stroke="black" points="6594.05,-15068.98 6583.56,-15070.45 6592.68,-15075.84 6594.05,-15068.98"/>
</g>
<!-- kv_send1_2_2 -->
<g id="node741" class="node">
<title>kv_send1_2_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7367" cy="-14958.56" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7367" y="-14962.36" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="7367" y="-14947.36" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_2_2&#45;&gt;kv_send1_2_2 -->
<g id="edge1002" class="edge">
<title>ring_stage1_2_2&#45;&gt;kv_send1_2_2</title>
<path fill="none" stroke="black" d="M7212.64,-15021.69C7241.09,-15010.23 7274.57,-14996.76 7303.06,-14985.3"/>
<polygon fill="black" stroke="black" points="7304.54,-14988.47 7312.51,-14981.49 7301.93,-14981.98 7304.54,-14988.47"/>
</g>
<!-- ring_stage1_3_2 -->
<g id="node757" class="node">
<title>ring_stage1_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7021.5,-14985.06 6810.5,-14985.06 6810.5,-14932.06 7021.5,-14932.06 7021.5,-14985.06"/>
<text text-anchor="middle" x="6916" y="-14969.86" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6916" y="-14954.86" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_15×V_15</text>
<text text-anchor="middle" x="6916" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_2_2&#45;&gt;ring_stage1_3_2 -->
<g id="edge1048" class="edge">
<title>ring_stage1_2_2&#45;&gt;ring_stage1_3_2</title>
<path fill="none" stroke="black" d="M7080.98,-15021.69C7053.59,-15011.37 7021.84,-14999.41 6993.55,-14988.76"/>
<polygon fill="black" stroke="black" points="6994.7,-14985.45 6984.1,-14985.21 6992.23,-14992 6994.7,-14985.45"/>
</g>
<!-- kv_send1_2_3 -->
<g id="node742" class="node">
<title>kv_send1_2_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7342" cy="-14868.82" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7342" y="-14872.62" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7342" y="-14857.62" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_2_3&#45;&gt;kv_send1_2_3 -->
<g id="edge1005" class="edge">
<title>ring_stage1_2_3&#45;&gt;kv_send1_2_3</title>
<path fill="none" stroke="black" d="M7712.32,-14933.58C7709.18,-14932.92 7706.07,-14932.29 7703,-14931.69 7596.73,-14910.83 7568.54,-14915.11 7462,-14895.69 7451.05,-14893.69 7439.58,-14891.44 7428.25,-14889.11"/>
<polygon fill="black" stroke="black" points="7428.86,-14885.66 7418.35,-14887.05 7427.43,-14892.51 7428.86,-14885.66"/>
</g>
<!-- ring_stage1_3_3 -->
<g id="node758" class="node">
<title>ring_stage1_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7663.5,-14895.32 7470.5,-14895.32 7470.5,-14842.32 7663.5,-14842.32 7663.5,-14895.32"/>
<text text-anchor="middle" x="7567" y="-14880.12" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="7567" y="-14865.12" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_0×V_0</text>
<text text-anchor="middle" x="7567" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_2_3&#45;&gt;ring_stage1_3_3 -->
<g id="edge1051" class="edge">
<title>ring_stage1_2_3&#45;&gt;ring_stage1_3_3</title>
<path fill="none" stroke="black" d="M7738.35,-14931.95C7709.78,-14921.58 7676.64,-14909.57 7647.17,-14898.88"/>
<polygon fill="black" stroke="black" points="7648.33,-14895.58 7637.73,-14895.47 7645.94,-14902.16 7648.33,-14895.58"/>
</g>
<!-- kv_send1_2_4 -->
<g id="node743" class="node">
<title>kv_send1_2_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6679" cy="-14779.08" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6679" y="-14782.88" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="6679" y="-14767.88" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_2_4&#45;&gt;kv_send1_2_4 -->
<g id="edge1008" class="edge">
<title>ring_stage1_2_4&#45;&gt;kv_send1_2_4</title>
<path fill="none" stroke="black" d="M6833.36,-14842.21C6804.91,-14830.75 6771.43,-14817.28 6742.94,-14805.82"/>
<polygon fill="black" stroke="black" points="6744.07,-14802.5 6733.49,-14802.01 6741.46,-14808.99 6744.07,-14802.5"/>
</g>
<!-- ring_stage1_3_4 -->
<g id="node759" class="node">
<title>ring_stage1_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7217.5,-14805.58 7024.5,-14805.58 7024.5,-14752.58 7217.5,-14752.58 7217.5,-14805.58"/>
<text text-anchor="middle" x="7121" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="7121" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_1×V_1</text>
<text text-anchor="middle" x="7121" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_2_4&#45;&gt;ring_stage1_3_4 -->
<g id="edge1054" class="edge">
<title>ring_stage1_2_4&#45;&gt;ring_stage1_3_4</title>
<path fill="none" stroke="black" d="M6962.39,-14842.21C6988.61,-14831.93 7018.98,-14820.04 7046.09,-14809.42"/>
<polygon fill="black" stroke="black" points="7047.49,-14812.63 7055.53,-14805.73 7044.94,-14806.11 7047.49,-14812.63"/>
</g>
<!-- kv_send1_2_5 -->
<g id="node744" class="node">
<title>kv_send1_2_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5553" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5553" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="5553" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_2_5&#45;&gt;kv_send1_2_5 -->
<g id="edge1011" class="edge">
<title>ring_stage1_2_5&#45;&gt;kv_send1_2_5</title>
<path fill="none" stroke="black" d="M5566.4,-14752.23C5564.64,-14744.09 5562.66,-14734.95 5560.78,-14726.24"/>
<polygon fill="black" stroke="black" points="5564.16,-14725.34 5558.62,-14716.31 5557.32,-14726.82 5564.16,-14725.34"/>
</g>
<!-- ring_stage1_3_5 -->
<g id="node760" class="node">
<title>ring_stage1_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6542.5,-14715.84 6349.5,-14715.84 6349.5,-14662.84 6542.5,-14662.84 6542.5,-14715.84"/>
<text text-anchor="middle" x="6446" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6446" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_2×V_2</text>
<text text-anchor="middle" x="6446" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_2_5&#45;&gt;ring_stage1_3_5 -->
<g id="edge1057" class="edge">
<title>ring_stage1_2_5&#45;&gt;ring_stage1_3_5</title>
<path fill="none" stroke="black" d="M5668.62,-14753.73C5671.78,-14753.18 5674.91,-14752.67 5678,-14752.21 5957.14,-14710.58 6031.93,-14751.04 6312,-14716.21 6320.89,-14715.1 6330.08,-14713.76 6339.29,-14712.27"/>
<polygon fill="black" stroke="black" points="6339.98,-14715.71 6349.27,-14710.61 6338.83,-14708.8 6339.98,-14715.71"/>
</g>
<!-- kv_send1_2_6 -->
<g id="node745" class="node">
<title>kv_send1_2_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6201" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6201" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6201" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_2_6&#45;&gt;kv_send1_2_6 -->
<g id="edge1014" class="edge">
<title>ring_stage1_2_6&#45;&gt;kv_send1_2_6</title>
<path fill="none" stroke="black" d="M6045.93,-14662.73C6074.52,-14651.27 6108.14,-14637.8 6136.76,-14626.33"/>
<polygon fill="black" stroke="black" points="6138.28,-14629.5 6146.26,-14622.53 6135.68,-14623 6138.28,-14629.5"/>
</g>
<!-- ring_stage1_3_6 -->
<g id="node761" class="node">
<title>ring_stage1_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5868.5,-14626.1 5675.5,-14626.1 5675.5,-14573.1 5868.5,-14573.1 5868.5,-14626.1"/>
<text text-anchor="middle" x="5772" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="5772" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_3×V_3</text>
<text text-anchor="middle" x="5772" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_2_6&#45;&gt;ring_stage1_3_6 -->
<g id="edge1060" class="edge">
<title>ring_stage1_2_6&#45;&gt;ring_stage1_3_6</title>
<path fill="none" stroke="black" d="M5920.69,-14662.73C5896.33,-14652.54 5868.14,-14640.77 5842.9,-14630.22"/>
<polygon fill="black" stroke="black" points="5843.96,-14626.87 5833.38,-14626.24 5841.26,-14633.33 5843.96,-14626.87"/>
</g>
<!-- kv_send1_2_7 -->
<g id="node746" class="node">
<title>kv_send1_2_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5765" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5765" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="5765" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_2_7&#45;&gt;kv_send1_2_7 -->
<g id="edge1017" class="edge">
<title>ring_stage1_2_7&#45;&gt;kv_send1_2_7</title>
<path fill="none" stroke="black" d="M5919.36,-14572.99C5890.91,-14561.53 5857.43,-14548.06 5828.94,-14536.59"/>
<polygon fill="black" stroke="black" points="5830.07,-14533.28 5819.49,-14532.79 5827.46,-14539.77 5830.07,-14533.28"/>
</g>
<!-- ring_stage1_3_7 -->
<g id="node762" class="node">
<title>ring_stage1_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6303.5,-14536.36 6110.5,-14536.36 6110.5,-14483.36 6303.5,-14483.36 6303.5,-14536.36"/>
<text text-anchor="middle" x="6207" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6207" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_4×V_4</text>
<text text-anchor="middle" x="6207" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_2_7&#45;&gt;ring_stage1_3_7 -->
<g id="edge1063" class="edge">
<title>ring_stage1_2_7&#45;&gt;ring_stage1_3_7</title>
<path fill="none" stroke="black" d="M6048.39,-14572.99C6074.61,-14562.71 6104.98,-14550.82 6132.09,-14540.2"/>
<polygon fill="black" stroke="black" points="6133.49,-14543.41 6141.53,-14536.5 6130.94,-14536.89 6133.49,-14543.41"/>
</g>
<!-- kv_send1_2_8 -->
<g id="node747" class="node">
<title>kv_send1_2_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5553" cy="-14420.12" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5553" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="5553" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_2_8&#45;&gt;kv_send1_2_8 -->
<g id="edge1020" class="edge">
<title>ring_stage1_2_8&#45;&gt;kv_send1_2_8</title>
<path fill="none" stroke="black" d="M5548.77,-14483.01C5549.32,-14474.96 5549.94,-14465.93 5550.53,-14457.31"/>
<polygon fill="black" stroke="black" points="5554.03,-14457.3 5551.22,-14447.09 5547.05,-14456.83 5554.03,-14457.3"/>
</g>
<!-- ring_stage1_3_8 -->
<g id="node763" class="node">
<title>ring_stage1_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5867.5,-14446.62 5674.5,-14446.62 5674.5,-14393.62 5867.5,-14393.62 5867.5,-14446.62"/>
<text text-anchor="middle" x="5771" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="5771" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_5×V_5</text>
<text text-anchor="middle" x="5771" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_2_8&#45;&gt;ring_stage1_3_8 -->
<g id="edge1066" class="edge">
<title>ring_stage1_2_8&#45;&gt;ring_stage1_3_8</title>
<path fill="none" stroke="black" d="M5612.39,-14483.25C5638.61,-14472.97 5668.98,-14461.08 5696.09,-14450.46"/>
<polygon fill="black" stroke="black" points="5697.49,-14453.67 5705.53,-14446.76 5694.94,-14447.15 5697.49,-14453.67"/>
</g>
<!-- kv_send1_2_9 -->
<g id="node748" class="node">
<title>kv_send1_2_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5358" cy="-14330.38" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5358" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="5358" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_2_9&#45;&gt;kv_send1_2_9 -->
<g id="edge1023" class="edge">
<title>ring_stage1_2_9&#45;&gt;kv_send1_2_9</title>
<path fill="none" stroke="black" d="M5341.78,-14393.27C5343.91,-14385.13 5346.31,-14375.99 5348.59,-14367.28"/>
<polygon fill="black" stroke="black" points="5352.04,-14367.91 5351.19,-14357.35 5345.27,-14366.13 5352.04,-14367.91"/>
</g>
<!-- ring_stage1_3_9 -->
<g id="node764" class="node">
<title>ring_stage1_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5678.5,-14356.88 5485.5,-14356.88 5485.5,-14303.88 5678.5,-14303.88 5678.5,-14356.88"/>
<text text-anchor="middle" x="5582" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="5582" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_6×V_6</text>
<text text-anchor="middle" x="5582" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_2_9&#45;&gt;ring_stage1_3_9 -->
<g id="edge1069" class="edge">
<title>ring_stage1_2_9&#45;&gt;ring_stage1_3_9</title>
<path fill="none" stroke="black" d="M5407.11,-14393.5C5436.27,-14383.14 5470.09,-14371.13 5500.18,-14360.44"/>
<polygon fill="black" stroke="black" points="5501.55,-14363.67 5509.8,-14357.02 5499.21,-14357.07 5501.55,-14363.67"/>
</g>
<!-- kv_send1_2_10 -->
<g id="node749" class="node">
<title>kv_send1_2_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5119" cy="-14240.64" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5119" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="5119" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_2_10&#45;&gt;kv_send1_2_10 -->
<g id="edge1026" class="edge">
<title>ring_stage1_2_10&#45;&gt;kv_send1_2_10</title>
<path fill="none" stroke="black" d="M5126.05,-14303.53C5125.13,-14295.39 5124.08,-14286.25 5123.09,-14277.54"/>
<polygon fill="black" stroke="black" points="5126.57,-14277.15 5121.96,-14267.61 5119.61,-14277.94 5126.57,-14277.15"/>
</g>
<!-- ring_stage1_3_10 -->
<g id="node765" class="node">
<title>ring_stage1_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5449,-14267.14 5247,-14267.14 5247,-14214.14 5449,-14214.14 5449,-14267.14"/>
<text text-anchor="middle" x="5348" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="5348" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_7×V_7</text>
<text text-anchor="middle" x="5348" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_2_10&#45;&gt;ring_stage1_3_10 -->
<g id="edge1072" class="edge">
<title>ring_stage1_2_10&#45;&gt;ring_stage1_3_10</title>
<path fill="none" stroke="black" d="M5192.93,-14303.76C5218.46,-14293.54 5248,-14281.7 5274.41,-14271.12"/>
<polygon fill="black" stroke="black" points="5276.01,-14274.25 5283.99,-14267.28 5273.4,-14267.75 5276.01,-14274.25"/>
</g>
<!-- kv_send1_2_11 -->
<g id="node750" class="node">
<title>kv_send1_2_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4404" cy="-14150.9" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4404" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="4404" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_2_11&#45;&gt;kv_send1_2_11 -->
<g id="edge1029" class="edge">
<title>ring_stage1_2_11&#45;&gt;kv_send1_2_11</title>
<path fill="none" stroke="black" d="M4243.27,-14214.02C4272.91,-14202.57 4307.78,-14189.09 4337.45,-14177.62"/>
<polygon fill="black" stroke="black" points="4338.82,-14180.84 4346.89,-14173.97 4336.3,-14174.31 4338.82,-14180.84"/>
</g>
<!-- ring_stage1_3_11 -->
<g id="node766" class="node">
<title>ring_stage1_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5209,-14177.4 5007,-14177.4 5007,-14124.4 5209,-14124.4 5209,-14177.4"/>
<text text-anchor="middle" x="5108" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="5108" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_8×V_8</text>
<text text-anchor="middle" x="5108" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_2_11&#45;&gt;ring_stage1_3_11 -->
<g id="edge1075" class="edge">
<title>ring_stage1_2_11&#45;&gt;ring_stage1_3_11</title>
<path fill="none" stroke="black" d="M4278.16,-14215.12C4281.14,-14214.63 4284.09,-14214.18 4287,-14213.77 4596.91,-14169.85 4682.88,-14221.04 4996.54,-14177.86"/>
<polygon fill="black" stroke="black" points="4997.42,-14181.27 5006.84,-14176.41 4996.45,-14174.33 4997.42,-14181.27"/>
</g>
<!-- kv_send1_2_12 -->
<g id="node751" class="node">
<title>kv_send1_2_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4642" cy="-14061.16" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4642" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="4642" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_2_12&#45;&gt;kv_send1_2_12 -->
<g id="edge1032" class="edge">
<title>ring_stage1_2_12&#45;&gt;kv_send1_2_12</title>
<path fill="none" stroke="black" d="M4809.81,-14124.28C4778.49,-14112.69 4741.56,-14099.02 4710.34,-14087.46"/>
<polygon fill="black" stroke="black" points="4711.44,-14084.13 4700.84,-14083.94 4709.01,-14090.7 4711.44,-14084.13"/>
</g>
<!-- ring_stage1_3_12 -->
<g id="node767" class="node">
<title>ring_stage1_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4972,-14087.66 4770,-14087.66 4770,-14034.66 4972,-14034.66 4972,-14087.66"/>
<text text-anchor="middle" x="4871" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="4871" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_9×V_9</text>
<text text-anchor="middle" x="4871" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_2_12&#45;&gt;ring_stage1_3_12 -->
<g id="edge1078" class="edge">
<title>ring_stage1_2_12&#45;&gt;ring_stage1_3_12</title>
<path fill="none" stroke="black" d="M4876.64,-14124.05C4875.89,-14115.84 4875.05,-14106.61 4874.25,-14097.83"/>
<polygon fill="black" stroke="black" points="4877.73,-14097.46 4873.34,-14087.82 4870.76,-14098.1 4877.73,-14097.46"/>
</g>
<!-- kv_send1_2_13 -->
<g id="node752" class="node">
<title>kv_send1_2_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4384" cy="-13971.42" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4384" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="4384" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_2_13&#45;&gt;kv_send1_2_13 -->
<g id="edge1035" class="edge">
<title>ring_stage1_2_13&#45;&gt;kv_send1_2_13</title>
<path fill="none" stroke="black" d="M4398.11,-14034.31C4396.25,-14026.17 4394.17,-14017.03 4392.18,-14008.32"/>
<polygon fill="black" stroke="black" points="4395.55,-14007.36 4389.92,-13998.39 4388.73,-14008.91 4395.55,-14007.36"/>
</g>
<!-- ring_stage1_3_13 -->
<g id="node768" class="node">
<title>ring_stage1_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4732,-13997.92 4512,-13997.92 4512,-13944.92 4732,-13944.92 4732,-13997.92"/>
<text text-anchor="middle" x="4622" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="4622" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_10×V_10</text>
<text text-anchor="middle" x="4622" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_2_13&#45;&gt;ring_stage1_3_13 -->
<g id="edge1081" class="edge">
<title>ring_stage1_2_13&#45;&gt;ring_stage1_3_13</title>
<path fill="none" stroke="black" d="M4467.64,-14034.54C4493.05,-14024.32 4522.46,-14012.48 4548.75,-14001.9"/>
<polygon fill="black" stroke="black" points="4550.31,-14005.04 4558.28,-13998.06 4547.7,-13998.55 4550.31,-14005.04"/>
</g>
<!-- kv_send1_2_14 -->
<g id="node753" class="node">
<title>kv_send1_2_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4146" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4146" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="4146" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_2_14&#45;&gt;kv_send1_2_14 -->
<g id="edge1038" class="edge">
<title>ring_stage1_2_14&#45;&gt;kv_send1_2_14</title>
<path fill="none" stroke="black" d="M4146,-13944.57C4146,-13936.52 4146,-13927.49 4146,-13918.87"/>
<polygon fill="black" stroke="black" points="4149.5,-13918.65 4146,-13908.65 4142.5,-13918.65 4149.5,-13918.65"/>
</g>
<!-- ring_stage1_3_14 -->
<g id="node769" class="node">
<title>ring_stage1_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4494,-13908.18 4274,-13908.18 4274,-13855.18 4494,-13855.18 4494,-13908.18"/>
<text text-anchor="middle" x="4384" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="4384" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_11×V_11</text>
<text text-anchor="middle" x="4384" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_2_14&#45;&gt;ring_stage1_3_14 -->
<g id="edge1084" class="edge">
<title>ring_stage1_2_14&#45;&gt;ring_stage1_3_14</title>
<path fill="none" stroke="black" d="M4215.48,-13944.8C4243.46,-13934.49 4275.89,-13922.53 4304.78,-13911.88"/>
<polygon fill="black" stroke="black" points="4306.26,-13915.07 4314.43,-13908.32 4303.84,-13908.5 4306.26,-13915.07"/>
</g>
<!-- kv_send1_2_15 -->
<g id="node754" class="node">
<title>kv_send1_2_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6248" cy="-15227.78" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6248" y="-15231.58" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="6248" y="-15216.58" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_2_15&#45;&gt;kv_send1_2_15 -->
<g id="edge1041" class="edge">
<title>ring_stage1_2_15&#45;&gt;kv_send1_2_15</title>
<path fill="none" stroke="black" d="M6246.59,-15290.67C6246.77,-15282.62 6246.98,-15273.59 6247.18,-15264.97"/>
<polygon fill="black" stroke="black" points="6250.68,-15264.83 6247.41,-15254.75 6243.68,-15264.67 6250.68,-15264.83"/>
</g>
<!-- ring_stage1_3_15 -->
<g id="node770" class="node">
<title>ring_stage1_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4240,-13818.44 4020,-13818.44 4020,-13765.44 4240,-13765.44 4240,-13818.44"/>
<text text-anchor="middle" x="4130" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="4130" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_12×V_12</text>
<text text-anchor="middle" x="4130" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_2_15&#45;&gt;ring_stage1_3_15 -->
<g id="edge1087" class="edge">
<title>ring_stage1_2_15&#45;&gt;ring_stage1_3_15</title>
<path fill="none" stroke="black" d="M6135.67,-15310.13C5891.41,-15294.58 5312.78,-15249.72 5138,-15164.91 5086.32,-15139.83 5077.07,-15122.82 5045,-15075.17 5033,-15057.34 5014.88,-15006.1 5009,-14985.43 4991.3,-14923.17 5030.55,-14886.93 4984,-14841.95 4942.21,-14801.57 4779.72,-14825.5 4725,-14805.95 4681.84,-14790.53 4677.75,-14773.18 4637,-14752.21 4419.68,-14640.33 4326.29,-14683.73 4131,-14536.73 3988.48,-14429.45 4017,-14330.28 4017,-14151.9 4017,-14151.9 4017,-14151.9 4017,-13970.42 4017,-13918.84 3999.69,-13898.56 4027,-13854.81 4034.67,-13842.52 4045.77,-13832.34 4057.86,-13824.03"/>
<polygon fill="black" stroke="black" points="4059.83,-13826.93 4066.36,-13818.58 4056.05,-13821.03 4059.83,-13826.93"/>
</g>
<!-- kv_send1_2_0&#45;&gt;ring_stage1_3_1 -->
<g id="edge1046" class="edge">
<title>kv_send1_2_0&#45;&gt;ring_stage1_3_1</title>
<path fill="none" stroke="black" d="M6478.7,-15110.71C6478.61,-15102.68 6478.51,-15093.7 6478.41,-15085.14"/>
<polygon fill="black" stroke="black" points="6481.91,-15084.96 6478.29,-15075 6474.91,-15085.04 6481.91,-15084.96"/>
</g>
<!-- kv_send1_2_1&#45;&gt;ring_stage1_3_2 -->
<g id="edge1049" class="edge">
<title>kv_send1_2_1&#45;&gt;ring_stage1_3_2</title>
<path fill="none" stroke="black" d="M6916,-15020.97C6916,-15012.94 6916,-15003.96 6916,-14995.4"/>
<polygon fill="black" stroke="black" points="6919.5,-14995.26 6916,-14985.26 6912.5,-14995.26 6919.5,-14995.26"/>
</g>
<!-- kv_send1_2_2&#45;&gt;ring_stage1_3_3 -->
<g id="edge1052" class="edge">
<title>kv_send1_2_2&#45;&gt;ring_stage1_3_3</title>
<path fill="none" stroke="black" d="M7417.99,-14935.19C7442.73,-14924.34 7472.79,-14911.15 7499.41,-14899.47"/>
<polygon fill="black" stroke="black" points="7500.92,-14902.63 7508.67,-14895.41 7498.11,-14896.22 7500.92,-14902.63"/>
</g>
<!-- kv_send1_2_3&#45;&gt;ring_stage1_3_4 -->
<g id="edge1055" class="edge">
<title>kv_send1_2_3&#45;&gt;ring_stage1_3_4</title>
<path fill="none" stroke="black" d="M7287.09,-14846.02C7259.29,-14834.98 7225.14,-14821.42 7195.05,-14809.48"/>
<polygon fill="black" stroke="black" points="7196.03,-14806.1 7185.44,-14805.66 7193.44,-14812.61 7196.03,-14806.1"/>
</g>
<!-- kv_send1_2_4&#45;&gt;ring_stage1_3_5 -->
<g id="edge1058" class="edge">
<title>kv_send1_2_4&#45;&gt;ring_stage1_3_5</title>
<path fill="none" stroke="black" d="M6622,-14756.62C6592.33,-14745.44 6555.61,-14731.62 6523.41,-14719.49"/>
<polygon fill="black" stroke="black" points="6524.6,-14716.2 6514.01,-14715.95 6522.14,-14722.75 6524.6,-14716.2"/>
</g>
<!-- kv_send1_2_5&#45;&gt;ring_stage1_3_6 -->
<g id="edge1061" class="edge">
<title>kv_send1_2_5&#45;&gt;ring_stage1_3_6</title>
<path fill="none" stroke="black" d="M5607.7,-14666.42C5635.25,-14655.39 5669.04,-14641.85 5698.79,-14629.93"/>
<polygon fill="black" stroke="black" points="5700.32,-14633.09 5708.3,-14626.12 5697.71,-14626.59 5700.32,-14633.09"/>
</g>
<!-- kv_send1_2_6&#45;&gt;ring_stage1_3_7 -->
<g id="edge1064" class="edge">
<title>kv_send1_2_6&#45;&gt;ring_stage1_3_7</title>
<path fill="none" stroke="black" d="M6202.8,-14572.27C6203.35,-14564.24 6203.96,-14555.26 6204.55,-14546.7"/>
<polygon fill="black" stroke="black" points="6208.05,-14546.78 6205.24,-14536.56 6201.07,-14546.3 6208.05,-14546.78"/>
</g>
<!-- kv_send1_2_7&#45;&gt;ring_stage1_3_8 -->
<g id="edge1067" class="edge">
<title>kv_send1_2_7&#45;&gt;ring_stage1_3_8</title>
<path fill="none" stroke="black" d="M5766.8,-14482.53C5767.35,-14474.5 5767.96,-14465.52 5768.55,-14456.96"/>
<polygon fill="black" stroke="black" points="5772.05,-14457.04 5769.24,-14446.82 5765.07,-14456.56 5772.05,-14457.04"/>
</g>
<!-- kv_send1_2_8&#45;&gt;ring_stage1_3_9 -->
<g id="edge1070" class="edge">
<title>kv_send1_2_8&#45;&gt;ring_stage1_3_9</title>
<path fill="none" stroke="black" d="M5561.54,-14393.27C5564.29,-14384.97 5567.38,-14375.63 5570.3,-14366.76"/>
<polygon fill="black" stroke="black" points="5573.7,-14367.64 5573.52,-14357.04 5567.06,-14365.44 5573.7,-14367.64"/>
</g>
<!-- kv_send1_2_9&#45;&gt;ring_stage1_3_10 -->
<g id="edge1073" class="edge">
<title>kv_send1_2_9&#45;&gt;ring_stage1_3_10</title>
<path fill="none" stroke="black" d="M5355,-14303.05C5354.08,-14295.02 5353.06,-14286.04 5352.08,-14277.48"/>
<polygon fill="black" stroke="black" points="5355.54,-14276.88 5350.93,-14267.34 5348.58,-14277.67 5355.54,-14276.88"/>
</g>
<!-- kv_send1_2_10&#45;&gt;ring_stage1_3_11 -->
<g id="edge1076" class="edge">
<title>kv_send1_2_10&#45;&gt;ring_stage1_3_11</title>
<path fill="none" stroke="black" d="M5115.7,-14213.31C5114.69,-14205.28 5113.57,-14196.3 5112.49,-14187.74"/>
<polygon fill="black" stroke="black" points="5115.94,-14187.09 5111.22,-14177.6 5108.99,-14187.96 5115.94,-14187.09"/>
</g>
<!-- kv_send1_2_11&#45;&gt;ring_stage1_3_12 -->
<g id="edge1079" class="edge">
<title>kv_send1_2_11&#45;&gt;ring_stage1_3_12</title>
<path fill="none" stroke="black" d="M4482.24,-14131.98C4495.48,-14129.17 4509.11,-14126.41 4522,-14124.03 4624.54,-14105.09 4653.82,-14108.14 4759.95,-14088.17"/>
<polygon fill="black" stroke="black" points="4760.6,-14091.6 4769.77,-14086.29 4759.29,-14084.73 4760.6,-14091.6"/>
</g>
<!-- kv_send1_2_12&#45;&gt;ring_stage1_3_13 -->
<g id="edge1082" class="edge">
<title>kv_send1_2_12&#45;&gt;ring_stage1_3_13</title>
<path fill="none" stroke="black" d="M4636.11,-14034.31C4634.24,-14026.1 4632.13,-14016.87 4630.13,-14008.09"/>
<polygon fill="black" stroke="black" points="4633.49,-14007.06 4627.85,-13998.08 4626.66,-14008.61 4633.49,-14007.06"/>
</g>
<!-- kv_send1_2_13&#45;&gt;ring_stage1_3_14 -->
<g id="edge1085" class="edge">
<title>kv_send1_2_13&#45;&gt;ring_stage1_3_14</title>
<path fill="none" stroke="black" d="M4384,-13944.09C4384,-13936.05 4384,-13927.08 4384,-13918.52"/>
<polygon fill="black" stroke="black" points="4387.5,-13918.38 4384,-13908.38 4380.5,-13918.38 4387.5,-13918.38"/>
</g>
<!-- kv_send1_2_14&#45;&gt;ring_stage1_3_15 -->
<g id="edge1088" class="edge">
<title>kv_send1_2_14&#45;&gt;ring_stage1_3_15</title>
<path fill="none" stroke="black" d="M4141.29,-13854.83C4139.79,-13846.62 4138.11,-13837.39 4136.5,-13828.61"/>
<polygon fill="black" stroke="black" points="4139.92,-13827.81 4134.68,-13818.6 4133.03,-13829.07 4139.92,-13827.81"/>
</g>
<!-- kv_send1_2_15&#45;&gt;ring_stage1_3_0 -->
<g id="edge1043" class="edge">
<title>kv_send1_2_15&#45;&gt;ring_stage1_3_0</title>
<path fill="none" stroke="black" d="M6248.3,-15200.45C6248.39,-15192.42 6248.49,-15183.44 6248.59,-15174.88"/>
<polygon fill="black" stroke="black" points="6252.09,-15174.78 6248.71,-15164.74 6245.09,-15174.7 6252.09,-15174.78"/>
</g>
<!-- kv_send1_3_0 -->
<g id="node771" class="node">
<title>kv_send1_3_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6250" cy="-15048.3" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6250" y="-15052.1" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="6250" y="-15037.1" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_3_0&#45;&gt;kv_send1_3_0 -->
<g id="edge1044" class="edge">
<title>ring_stage1_3_0&#45;&gt;kv_send1_3_0</title>
<path fill="none" stroke="black" d="M6249.29,-15111.19C6249.39,-15103.14 6249.49,-15094.11 6249.59,-15085.49"/>
<polygon fill="black" stroke="black" points="6253.09,-15085.31 6249.7,-15075.27 6246.09,-15085.23 6253.09,-15085.31"/>
</g>
<!-- ring_stage1_4_0 -->
<g id="node787" class="node">
<title>ring_stage1_4_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4235.5,-13638.96 4024.5,-13638.96 4024.5,-13585.96 4235.5,-13585.96 4235.5,-13638.96"/>
<text text-anchor="middle" x="4130" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="4130" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_12×V_12</text>
<text text-anchor="middle" x="4130" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_3_0&#45;&gt;ring_stage1_4_0 -->
<g id="edge1090" class="edge">
<title>ring_stage1_3_0&#45;&gt;ring_stage1_4_0</title>
<path fill="none" stroke="black" d="M6143.48,-15134.93C5921.3,-15129.77 5411.83,-15113.98 5243,-15075.17 5140.89,-15051.69 5090.59,-15067.14 5025,-14985.43 4984.48,-14934.95 5038.91,-14893.68 5000,-14841.95 4923.32,-14740.01 4825.21,-14812.89 4742,-14716.21 4698.41,-14665.55 4749.14,-14614.54 4697,-14572.73 4623.4,-14513.71 4362.44,-14569.58 4274,-14536.73 4076.45,-14463.34 3997,-14362.63 3997,-14151.9 3997,-14151.9 3997,-14151.9 3997,-13790.94 3997,-13738.71 3987.53,-13717.74 4018,-13675.33 4026.98,-13662.82 4039.31,-13652.55 4052.52,-13644.22"/>
<polygon fill="black" stroke="black" points="4054.47,-13647.13 4061.3,-13639.03 4050.91,-13641.11 4054.47,-13647.13"/>
</g>
<!-- kv_send1_3_1 -->
<g id="node772" class="node">
<title>kv_send1_3_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6478" cy="-14958.56" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6478" y="-14962.36" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="6478" y="-14947.36" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_3_1&#45;&gt;kv_send1_3_1 -->
<g id="edge1047" class="edge">
<title>ring_stage1_3_1&#45;&gt;kv_send1_3_1</title>
<path fill="none" stroke="black" d="M6478,-15021.45C6478,-15013.4 6478,-15004.37 6478,-14995.75"/>
<polygon fill="black" stroke="black" points="6481.5,-14995.53 6478,-14985.53 6474.5,-14995.53 6481.5,-14995.53"/>
</g>
<!-- ring_stage1_4_1 -->
<g id="node788" class="node">
<title>ring_stage1_4_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6356.5,-14985.06 6145.5,-14985.06 6145.5,-14932.06 6356.5,-14932.06 6356.5,-14985.06"/>
<text text-anchor="middle" x="6251" y="-14969.86" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6251" y="-14954.86" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_13×V_13</text>
<text text-anchor="middle" x="6251" y="-14939.86" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_3_1&#45;&gt;ring_stage1_4_1 -->
<g id="edge1093" class="edge">
<title>ring_stage1_3_1&#45;&gt;ring_stage1_4_1</title>
<path fill="none" stroke="black" d="M6411.73,-15021.69C6385.16,-15011.41 6354.38,-14999.52 6326.92,-14988.9"/>
<polygon fill="black" stroke="black" points="6327.94,-14985.55 6317.35,-14985.21 6325.42,-14992.08 6327.94,-14985.55"/>
</g>
<!-- kv_send1_3_2 -->
<g id="node773" class="node">
<title>kv_send1_3_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7115" cy="-14868.82" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7115" y="-14872.62" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="7115" y="-14857.62" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_3_2&#45;&gt;kv_send1_3_2 -->
<g id="edge1050" class="edge">
<title>ring_stage1_3_2&#45;&gt;kv_send1_3_2</title>
<path fill="none" stroke="black" d="M6974.09,-14931.95C6999.43,-14920.77 7029.13,-14907.68 7054.72,-14896.4"/>
<polygon fill="black" stroke="black" points="7056.2,-14899.57 7063.94,-14892.33 7053.38,-14893.16 7056.2,-14899.57"/>
</g>
<!-- ring_stage1_4_2 -->
<g id="node789" class="node">
<title>ring_stage1_4_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6780.5,-14895.32 6569.5,-14895.32 6569.5,-14842.32 6780.5,-14842.32 6780.5,-14895.32"/>
<text text-anchor="middle" x="6675" y="-14880.12" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6675" y="-14865.12" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_14×V_14</text>
<text text-anchor="middle" x="6675" y="-14850.12" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_3_2&#45;&gt;ring_stage1_4_2 -->
<g id="edge1096" class="edge">
<title>ring_stage1_3_2&#45;&gt;ring_stage1_4_2</title>
<path fill="none" stroke="black" d="M6845.64,-14931.95C6817.31,-14921.63 6784.47,-14909.67 6755.22,-14899.02"/>
<polygon fill="black" stroke="black" points="6756.04,-14895.6 6745.44,-14895.47 6753.64,-14902.18 6756.04,-14895.6"/>
</g>
<!-- kv_send1_3_3 -->
<g id="node774" class="node">
<title>kv_send1_3_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7568" cy="-14779.08" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7568" y="-14782.88" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7568" y="-14767.88" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_3_3&#45;&gt;kv_send1_3_3 -->
<g id="edge1053" class="edge">
<title>ring_stage1_3_3&#45;&gt;kv_send1_3_3</title>
<path fill="none" stroke="black" d="M7567.29,-14841.97C7567.39,-14833.92 7567.49,-14824.89 7567.59,-14816.27"/>
<polygon fill="black" stroke="black" points="7571.09,-14816.09 7567.7,-14806.05 7564.09,-14816.01 7571.09,-14816.09"/>
</g>
<!-- ring_stage1_4_3 -->
<g id="node790" class="node">
<title>ring_stage1_4_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7446.5,-14805.58 7235.5,-14805.58 7235.5,-14752.58 7446.5,-14752.58 7446.5,-14805.58"/>
<text text-anchor="middle" x="7341" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="7341" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_15×V_15</text>
<text text-anchor="middle" x="7341" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_3_3&#45;&gt;ring_stage1_4_3 -->
<g id="edge1099" class="edge">
<title>ring_stage1_3_3&#45;&gt;ring_stage1_4_3</title>
<path fill="none" stroke="black" d="M7501.02,-14842.21C7474.57,-14831.93 7443.93,-14820.04 7416.58,-14809.42"/>
<polygon fill="black" stroke="black" points="7417.65,-14806.08 7407.06,-14805.73 7415.11,-14812.61 7417.65,-14806.08"/>
</g>
<!-- kv_send1_3_4 -->
<g id="node775" class="node">
<title>kv_send1_3_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6891" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6891" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="6891" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_3_4&#45;&gt;kv_send1_3_4 -->
<g id="edge1056" class="edge">
<title>ring_stage1_3_4&#45;&gt;kv_send1_3_4</title>
<path fill="none" stroke="black" d="M7053.86,-14752.47C7023.47,-14740.87 6987.65,-14727.21 6957.36,-14715.65"/>
<polygon fill="black" stroke="black" points="6958.32,-14712.27 6947.73,-14711.98 6955.82,-14718.81 6958.32,-14712.27"/>
</g>
<!-- ring_stage1_4_4 -->
<g id="node791" class="node">
<title>ring_stage1_4_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7439.5,-14715.84 7246.5,-14715.84 7246.5,-14662.84 7439.5,-14662.84 7439.5,-14715.84"/>
<text text-anchor="middle" x="7343" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="7343" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_0×V_0</text>
<text text-anchor="middle" x="7343" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_3_4&#45;&gt;ring_stage1_4_4 -->
<g id="edge1102" class="edge">
<title>ring_stage1_3_4&#45;&gt;ring_stage1_4_4</title>
<path fill="none" stroke="black" d="M7185.81,-14752.47C7211.8,-14742.19 7241.9,-14730.3 7268.76,-14719.68"/>
<polygon fill="black" stroke="black" points="7270.1,-14722.92 7278.11,-14715.98 7267.52,-14716.41 7270.1,-14722.92"/>
</g>
<!-- kv_send1_3_5 -->
<g id="node776" class="node">
<title>kv_send1_3_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6445" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6445" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6445" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_3_5&#45;&gt;kv_send1_3_5 -->
<g id="edge1059" class="edge">
<title>ring_stage1_3_5&#45;&gt;kv_send1_3_5</title>
<path fill="none" stroke="black" d="M6445.71,-14662.49C6445.61,-14654.44 6445.51,-14645.41 6445.41,-14636.79"/>
<polygon fill="black" stroke="black" points="6448.91,-14636.53 6445.3,-14626.57 6441.91,-14636.61 6448.91,-14636.53"/>
</g>
<!-- ring_stage1_4_5 -->
<g id="node792" class="node">
<title>ring_stage1_4_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6759.5,-14626.1 6566.5,-14626.1 6566.5,-14573.1 6759.5,-14573.1 6759.5,-14626.1"/>
<text text-anchor="middle" x="6663" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6663" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_1×V_1</text>
<text text-anchor="middle" x="6663" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_3_5&#45;&gt;ring_stage1_4_5 -->
<g id="edge1105" class="edge">
<title>ring_stage1_3_5&#45;&gt;ring_stage1_4_5</title>
<path fill="none" stroke="black" d="M6509.35,-14662.73C6534.64,-14652.5 6563.92,-14640.66 6590.08,-14630.08"/>
<polygon fill="black" stroke="black" points="6591.61,-14633.24 6599.57,-14626.24 6588.99,-14626.75 6591.61,-14633.24"/>
</g>
<!-- kv_send1_3_6 -->
<g id="node777" class="node">
<title>kv_send1_3_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5989" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5989" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="5989" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_3_6&#45;&gt;kv_send1_3_6 -->
<g id="edge1062" class="edge">
<title>ring_stage1_3_6&#45;&gt;kv_send1_3_6</title>
<path fill="none" stroke="black" d="M5835.35,-14572.99C5863.67,-14561.53 5896.99,-14548.06 5925.35,-14536.59"/>
<polygon fill="black" stroke="black" points="5926.8,-14539.78 5934.76,-14532.79 5924.18,-14533.29 5926.8,-14539.78"/>
</g>
<!-- ring_stage1_4_6 -->
<g id="node793" class="node">
<title>ring_stage1_4_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6541.5,-14536.36 6348.5,-14536.36 6348.5,-14483.36 6541.5,-14483.36 6541.5,-14536.36"/>
<text text-anchor="middle" x="6445" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6445" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_2×V_2</text>
<text text-anchor="middle" x="6445" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_3_6&#45;&gt;ring_stage1_4_6 -->
<g id="edge1108" class="edge">
<title>ring_stage1_3_6&#45;&gt;ring_stage1_4_6</title>
<path fill="none" stroke="black" d="M5868.63,-14574.35C5871.79,-14573.77 5874.91,-14573.23 5878,-14572.73 6069.49,-14541.64 6120.85,-14563.43 6313,-14536.73 6321.23,-14535.59 6329.72,-14534.26 6338.24,-14532.83"/>
<polygon fill="black" stroke="black" points="6338.99,-14536.25 6348.25,-14531.1 6337.8,-14529.35 6338.99,-14536.25"/>
</g>
<!-- kv_send1_3_7 -->
<g id="node778" class="node">
<title>kv_send1_3_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5989" cy="-14420.12" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5989" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="5989" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_3_7&#45;&gt;kv_send1_3_7 -->
<g id="edge1065" class="edge">
<title>ring_stage1_3_7&#45;&gt;kv_send1_3_7</title>
<path fill="none" stroke="black" d="M6143.36,-14483.25C6114.91,-14471.79 6081.43,-14458.32 6052.94,-14446.85"/>
<polygon fill="black" stroke="black" points="6054.07,-14443.54 6043.49,-14443.05 6051.46,-14450.03 6054.07,-14443.54"/>
</g>
<!-- ring_stage1_4_7 -->
<g id="node794" class="node">
<title>ring_stage1_4_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6303.5,-14446.62 6110.5,-14446.62 6110.5,-14393.62 6303.5,-14393.62 6303.5,-14446.62"/>
<text text-anchor="middle" x="6207" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6207" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_3×V_3</text>
<text text-anchor="middle" x="6207" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_3_7&#45;&gt;ring_stage1_4_7 -->
<g id="edge1111" class="edge">
<title>ring_stage1_3_7&#45;&gt;ring_stage1_4_7</title>
<path fill="none" stroke="black" d="M6207,-14483.01C6207,-14474.8 6207,-14465.57 6207,-14456.79"/>
<polygon fill="black" stroke="black" points="6210.5,-14456.78 6207,-14446.78 6203.5,-14456.78 6210.5,-14456.78"/>
</g>
<!-- kv_send1_3_8 -->
<g id="node779" class="node">
<title>kv_send1_3_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5800" cy="-14330.38" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5800" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="5800" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_3_8&#45;&gt;kv_send1_3_8 -->
<g id="edge1068" class="edge">
<title>ring_stage1_3_8&#45;&gt;kv_send1_3_8</title>
<path fill="none" stroke="black" d="M5779.54,-14393.27C5782.26,-14385.04 5785.32,-14375.79 5788.23,-14367"/>
<polygon fill="black" stroke="black" points="5791.6,-14367.94 5791.42,-14357.35 5784.96,-14365.74 5791.6,-14367.94"/>
</g>
<!-- ring_stage1_4_8 -->
<g id="node795" class="node">
<title>ring_stage1_4_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6114.5,-14356.88 5921.5,-14356.88 5921.5,-14303.88 6114.5,-14303.88 6114.5,-14356.88"/>
<text text-anchor="middle" x="6018" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="6018" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_4×V_4</text>
<text text-anchor="middle" x="6018" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_3_8&#45;&gt;ring_stage1_4_8 -->
<g id="edge1114" class="edge">
<title>ring_stage1_3_8&#45;&gt;ring_stage1_4_8</title>
<path fill="none" stroke="black" d="M5843.11,-14393.5C5872.27,-14383.14 5906.09,-14371.13 5936.18,-14360.44"/>
<polygon fill="black" stroke="black" points="5937.55,-14363.67 5945.8,-14357.02 5935.21,-14357.07 5937.55,-14363.67"/>
</g>
<!-- kv_send1_3_9 -->
<g id="node780" class="node">
<title>kv_send1_3_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5577" cy="-14240.64" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5577" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="5577" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_3_9&#45;&gt;kv_send1_3_9 -->
<g id="edge1071" class="edge">
<title>ring_stage1_3_9&#45;&gt;kv_send1_3_9</title>
<path fill="none" stroke="black" d="M5580.53,-14303.53C5580.07,-14295.48 5579.55,-14286.45 5579.06,-14277.83"/>
<polygon fill="black" stroke="black" points="5582.54,-14277.39 5578.48,-14267.61 5575.55,-14277.79 5582.54,-14277.39"/>
</g>
<!-- ring_stage1_4_9 -->
<g id="node796" class="node">
<title>ring_stage1_4_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5897.5,-14267.14 5704.5,-14267.14 5704.5,-14214.14 5897.5,-14214.14 5897.5,-14267.14"/>
<text text-anchor="middle" x="5801" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="5801" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_5×V_5</text>
<text text-anchor="middle" x="5801" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_3_9&#45;&gt;ring_stage1_4_9 -->
<g id="edge1117" class="edge">
<title>ring_stage1_3_9&#45;&gt;ring_stage1_4_9</title>
<path fill="none" stroke="black" d="M5645.93,-14303.76C5671.46,-14293.54 5701,-14281.7 5727.41,-14271.12"/>
<polygon fill="black" stroke="black" points="5729.01,-14274.25 5736.99,-14267.28 5726.4,-14267.75 5729.01,-14274.25"/>
</g>
<!-- kv_send1_3_10 -->
<g id="node781" class="node">
<title>kv_send1_3_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5337" cy="-14150.9" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5337" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="5337" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_3_10&#45;&gt;kv_send1_3_10 -->
<g id="edge1074" class="edge">
<title>ring_stage1_3_10&#45;&gt;kv_send1_3_10</title>
<path fill="none" stroke="black" d="M5344.76,-14213.79C5343.74,-14205.65 5342.59,-14196.51 5341.5,-14187.8"/>
<polygon fill="black" stroke="black" points="5344.97,-14187.35 5340.26,-14177.87 5338.03,-14188.23 5344.97,-14187.35"/>
</g>
<!-- ring_stage1_4_10 -->
<g id="node797" class="node">
<title>ring_stage1_4_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5667,-14177.4 5465,-14177.4 5465,-14124.4 5667,-14124.4 5667,-14177.4"/>
<text text-anchor="middle" x="5566" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="5566" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_6×V_6</text>
<text text-anchor="middle" x="5566" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_3_10&#45;&gt;ring_stage1_4_10 -->
<g id="edge1120" class="edge">
<title>ring_stage1_3_10&#45;&gt;ring_stage1_4_10</title>
<path fill="none" stroke="black" d="M5411.64,-14214.02C5437.05,-14203.8 5466.46,-14191.96 5492.75,-14181.38"/>
<polygon fill="black" stroke="black" points="5494.31,-14184.52 5502.28,-14177.54 5491.7,-14178.03 5494.31,-14184.52"/>
</g>
<!-- kv_send1_3_11 -->
<g id="node782" class="node">
<title>kv_send1_3_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5100" cy="-14061.16" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5100" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5100" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_3_11&#45;&gt;kv_send1_3_11 -->
<g id="edge1077" class="edge">
<title>ring_stage1_3_11&#45;&gt;kv_send1_3_11</title>
<path fill="none" stroke="black" d="M5105.64,-14124.05C5104.91,-14116 5104.09,-14106.97 5103.3,-14098.35"/>
<polygon fill="black" stroke="black" points="5106.76,-14097.77 5102.37,-14088.13 5099.79,-14098.4 5106.76,-14097.77"/>
</g>
<!-- ring_stage1_4_11 -->
<g id="node798" class="node">
<title>ring_stage1_4_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5430,-14087.66 5228,-14087.66 5228,-14034.66 5430,-14034.66 5430,-14087.66"/>
<text text-anchor="middle" x="5329" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="5329" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_7×V_7</text>
<text text-anchor="middle" x="5329" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_3_11&#45;&gt;ring_stage1_4_11 -->
<g id="edge1123" class="edge">
<title>ring_stage1_3_11&#45;&gt;ring_stage1_4_11</title>
<path fill="none" stroke="black" d="M5172.52,-14124.28C5198.39,-14114.01 5228.35,-14102.12 5255.09,-14091.5"/>
<polygon fill="black" stroke="black" points="5256.4,-14094.75 5264.4,-14087.8 5253.82,-14088.24 5256.4,-14094.75"/>
</g>
<!-- kv_send1_3_12 -->
<g id="node783" class="node">
<title>kv_send1_3_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4861" cy="-13971.42" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4861" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="4861" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_3_12&#45;&gt;kv_send1_3_12 -->
<g id="edge1080" class="edge">
<title>ring_stage1_3_12&#45;&gt;kv_send1_3_12</title>
<path fill="none" stroke="black" d="M4868.05,-14034.31C4867.13,-14026.17 4866.08,-14017.03 4865.09,-14008.32"/>
<polygon fill="black" stroke="black" points="4868.57,-14007.93 4863.96,-13998.39 4861.61,-14008.72 4868.57,-14007.93"/>
</g>
<!-- ring_stage1_4_12 -->
<g id="node799" class="node">
<title>ring_stage1_4_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5191,-13997.92 4989,-13997.92 4989,-13944.92 5191,-13944.92 5191,-13997.92"/>
<text text-anchor="middle" x="5090" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="5090" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_8×V_8</text>
<text text-anchor="middle" x="5090" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_3_12&#45;&gt;ring_stage1_4_12 -->
<g id="edge1126" class="edge">
<title>ring_stage1_3_12&#45;&gt;ring_stage1_4_12</title>
<path fill="none" stroke="black" d="M4934.93,-14034.54C4960.46,-14024.32 4990,-14012.48 5016.41,-14001.9"/>
<polygon fill="black" stroke="black" points="5018.01,-14005.03 5025.99,-13998.06 5015.4,-13998.53 5018.01,-14005.03"/>
</g>
<!-- kv_send1_3_13 -->
<g id="node784" class="node">
<title>kv_send1_3_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4622" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4622" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="4622" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_3_13&#45;&gt;kv_send1_3_13 -->
<g id="edge1083" class="edge">
<title>ring_stage1_3_13&#45;&gt;kv_send1_3_13</title>
<path fill="none" stroke="black" d="M4622,-13944.57C4622,-13936.52 4622,-13927.49 4622,-13918.87"/>
<polygon fill="black" stroke="black" points="4625.5,-13918.65 4622,-13908.65 4618.5,-13918.65 4625.5,-13918.65"/>
</g>
<!-- ring_stage1_4_13 -->
<g id="node800" class="node">
<title>ring_stage1_4_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4952,-13908.18 4750,-13908.18 4750,-13855.18 4952,-13855.18 4952,-13908.18"/>
<text text-anchor="middle" x="4851" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="4851" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_9×V_9</text>
<text text-anchor="middle" x="4851" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_3_13&#45;&gt;ring_stage1_4_13 -->
<g id="edge1129" class="edge">
<title>ring_stage1_3_13&#45;&gt;ring_stage1_4_13</title>
<path fill="none" stroke="black" d="M4688.85,-13944.8C4715.66,-13934.53 4746.71,-13922.64 4774.42,-13912.02"/>
<polygon fill="black" stroke="black" points="4775.98,-13915.17 4784.07,-13908.32 4773.47,-13908.63 4775.98,-13915.17"/>
</g>
<!-- kv_send1_3_14 -->
<g id="node785" class="node">
<title>kv_send1_3_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4368" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4368" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="4368" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_3_14&#45;&gt;kv_send1_3_14 -->
<g id="edge1086" class="edge">
<title>ring_stage1_3_14&#45;&gt;kv_send1_3_14</title>
<path fill="none" stroke="black" d="M4379.29,-13854.83C4377.8,-13846.69 4376.14,-13837.55 4374.55,-13828.84"/>
<polygon fill="black" stroke="black" points="4377.97,-13828.12 4372.74,-13818.91 4371.09,-13829.37 4377.97,-13828.12"/>
</g>
<!-- ring_stage1_4_14 -->
<g id="node801" class="node">
<title>ring_stage1_4_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4716,-13818.44 4496,-13818.44 4496,-13765.44 4716,-13765.44 4716,-13818.44"/>
<text text-anchor="middle" x="4606" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="4606" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_10×V_10</text>
<text text-anchor="middle" x="4606" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_3_14&#45;&gt;ring_stage1_4_14 -->
<g id="edge1132" class="edge">
<title>ring_stage1_3_14&#45;&gt;ring_stage1_4_14</title>
<path fill="none" stroke="black" d="M4448.81,-13855.06C4474.8,-13844.79 4504.9,-13832.9 4531.76,-13822.28"/>
<polygon fill="black" stroke="black" points="4533.1,-13825.51 4541.11,-13818.58 4530.52,-13819 4533.1,-13825.51"/>
</g>
<!-- kv_send1_3_15 -->
<g id="node786" class="node">
<title>kv_send1_3_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4130" cy="-13702.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4130" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="4130" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_3_15&#45;&gt;kv_send1_3_15 -->
<g id="edge1089" class="edge">
<title>ring_stage1_3_15&#45;&gt;kv_send1_3_15</title>
<path fill="none" stroke="black" d="M4130,-13765.09C4130,-13757.04 4130,-13748.01 4130,-13739.39"/>
<polygon fill="black" stroke="black" points="4133.5,-13739.17 4130,-13729.17 4126.5,-13739.17 4133.5,-13739.17"/>
</g>
<!-- ring_stage1_4_15 -->
<g id="node802" class="node">
<title>ring_stage1_4_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4475,-13728.7 4255,-13728.7 4255,-13675.7 4475,-13675.7 4475,-13728.7"/>
<text text-anchor="middle" x="4365" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="4365" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_11×V_11</text>
<text text-anchor="middle" x="4365" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_3_15&#45;&gt;ring_stage1_4_15 -->
<g id="edge1135" class="edge">
<title>ring_stage1_3_15&#45;&gt;ring_stage1_4_15</title>
<path fill="none" stroke="black" d="M4198.6,-13765.32C4226.23,-13755.01 4258.25,-13743.05 4286.78,-13732.4"/>
<polygon fill="black" stroke="black" points="4288.17,-13735.62 4296.31,-13728.84 4285.72,-13729.06 4288.17,-13735.62"/>
</g>
<!-- kv_send1_3_0&#45;&gt;ring_stage1_4_1 -->
<g id="edge1094" class="edge">
<title>kv_send1_3_0&#45;&gt;ring_stage1_4_1</title>
<path fill="none" stroke="black" d="M6250.3,-15020.97C6250.39,-15012.94 6250.49,-15003.96 6250.59,-14995.4"/>
<polygon fill="black" stroke="black" points="6254.09,-14995.3 6250.71,-14985.26 6247.09,-14995.22 6254.09,-14995.3"/>
</g>
<!-- kv_send1_3_1&#45;&gt;ring_stage1_4_2 -->
<g id="edge1097" class="edge">
<title>kv_send1_3_1&#45;&gt;ring_stage1_4_2</title>
<path fill="none" stroke="black" d="M6528.48,-14935.08C6552.74,-14924.27 6582.16,-14911.17 6608.25,-14899.55"/>
<polygon fill="black" stroke="black" points="6609.98,-14902.61 6617.69,-14895.34 6607.13,-14896.22 6609.98,-14902.61"/>
</g>
<!-- kv_send1_3_2&#45;&gt;ring_stage1_4_3 -->
<g id="edge1100" class="edge">
<title>kv_send1_3_2&#45;&gt;ring_stage1_4_3</title>
<path fill="none" stroke="black" d="M7170.87,-14846.13C7199.41,-14835.05 7234.56,-14821.4 7265.49,-14809.39"/>
<polygon fill="black" stroke="black" points="7266.89,-14812.61 7274.94,-14805.73 7264.35,-14806.08 7266.89,-14812.61"/>
</g>
<!-- kv_send1_3_3&#45;&gt;ring_stage1_4_4 -->
<g id="edge1103" class="edge">
<title>kv_send1_3_3&#45;&gt;ring_stage1_4_4</title>
<path fill="none" stroke="black" d="M7512.38,-14756.39C7483.96,-14745.31 7448.96,-14731.66 7418.18,-14719.65"/>
<polygon fill="black" stroke="black" points="7419.36,-14716.36 7408.77,-14715.99 7416.81,-14722.88 7419.36,-14716.36"/>
</g>
<!-- kv_send1_3_4&#45;&gt;ring_stage1_4_5 -->
<g id="edge1106" class="edge">
<title>kv_send1_3_4&#45;&gt;ring_stage1_4_5</title>
<path fill="none" stroke="black" d="M6834.93,-14666.76C6806.02,-14655.64 6770.33,-14641.9 6738.97,-14629.83"/>
<polygon fill="black" stroke="black" points="6739.98,-14626.47 6729.39,-14626.15 6737.47,-14633.01 6739.98,-14626.47"/>
</g>
<!-- kv_send1_3_5&#45;&gt;ring_stage1_4_6 -->
<g id="edge1109" class="edge">
<title>kv_send1_3_5&#45;&gt;ring_stage1_4_6</title>
<path fill="none" stroke="black" d="M6445,-14572.27C6445,-14564.24 6445,-14555.26 6445,-14546.7"/>
<polygon fill="black" stroke="black" points="6448.5,-14546.56 6445,-14536.56 6441.5,-14546.56 6448.5,-14546.56"/>
</g>
<!-- kv_send1_3_6&#45;&gt;ring_stage1_4_7 -->
<g id="edge1112" class="edge">
<title>kv_send1_3_6&#45;&gt;ring_stage1_4_7</title>
<path fill="none" stroke="black" d="M6043.45,-14486.94C6070.87,-14475.91 6104.51,-14462.37 6134.13,-14450.45"/>
<polygon fill="black" stroke="black" points="6135.62,-14453.62 6143.59,-14446.64 6133.01,-14447.13 6135.62,-14453.62"/>
</g>
<!-- kv_send1_3_7&#45;&gt;ring_stage1_4_8 -->
<g id="edge1115" class="edge">
<title>kv_send1_3_7&#45;&gt;ring_stage1_4_8</title>
<path fill="none" stroke="black" d="M5997.54,-14393.27C6000.29,-14384.97 6003.38,-14375.63 6006.3,-14366.76"/>
<polygon fill="black" stroke="black" points="6009.7,-14367.64 6009.52,-14357.04 6003.06,-14365.44 6009.7,-14367.64"/>
</g>
<!-- kv_send1_3_8&#45;&gt;ring_stage1_4_9 -->
<g id="edge1118" class="edge">
<title>kv_send1_3_8&#45;&gt;ring_stage1_4_9</title>
<path fill="none" stroke="black" d="M5800.3,-14303.05C5800.39,-14295.02 5800.49,-14286.04 5800.59,-14277.48"/>
<polygon fill="black" stroke="black" points="5804.09,-14277.38 5800.71,-14267.34 5797.09,-14277.3 5804.09,-14277.38"/>
</g>
<!-- kv_send1_3_9&#45;&gt;ring_stage1_4_10 -->
<g id="edge1121" class="edge">
<title>kv_send1_3_9&#45;&gt;ring_stage1_4_10</title>
<path fill="none" stroke="black" d="M5573.7,-14213.31C5572.69,-14205.28 5571.57,-14196.3 5570.49,-14187.74"/>
<polygon fill="black" stroke="black" points="5573.94,-14187.09 5569.22,-14177.6 5566.99,-14187.96 5573.94,-14187.09"/>
</g>
<!-- kv_send1_3_10&#45;&gt;ring_stage1_4_11 -->
<g id="edge1124" class="edge">
<title>kv_send1_3_10&#45;&gt;ring_stage1_4_11</title>
<path fill="none" stroke="black" d="M5334.6,-14123.57C5333.87,-14115.54 5333.05,-14106.56 5332.27,-14098"/>
<polygon fill="black" stroke="black" points="5335.74,-14097.5 5331.34,-14087.86 5328.77,-14098.14 5335.74,-14097.5"/>
</g>
<!-- kv_send1_3_11&#45;&gt;ring_stage1_4_12 -->
<g id="edge1127" class="edge">
<title>kv_send1_3_11&#45;&gt;ring_stage1_4_12</title>
<path fill="none" stroke="black" d="M5097,-14033.83C5096.08,-14025.79 5095.06,-14016.82 5094.08,-14008.26"/>
<polygon fill="black" stroke="black" points="5097.54,-14007.66 5092.93,-13998.12 5090.58,-14008.45 5097.54,-14007.66"/>
</g>
<!-- kv_send1_3_12&#45;&gt;ring_stage1_4_13 -->
<g id="edge1130" class="edge">
<title>kv_send1_3_12&#45;&gt;ring_stage1_4_13</title>
<path fill="none" stroke="black" d="M4858,-13944.09C4857.08,-13936.05 4856.06,-13927.08 4855.08,-13918.52"/>
<polygon fill="black" stroke="black" points="4858.54,-13917.92 4853.93,-13908.38 4851.58,-13918.71 4858.54,-13917.92"/>
</g>
<!-- kv_send1_3_13&#45;&gt;ring_stage1_4_14 -->
<g id="edge1133" class="edge">
<title>kv_send1_3_13&#45;&gt;ring_stage1_4_14</title>
<path fill="none" stroke="black" d="M4617.29,-13854.83C4615.79,-13846.62 4614.11,-13837.39 4612.5,-13828.61"/>
<polygon fill="black" stroke="black" points="4615.92,-13827.81 4610.68,-13818.6 4609.03,-13829.07 4615.92,-13827.81"/>
</g>
<!-- kv_send1_3_14&#45;&gt;ring_stage1_4_15 -->
<g id="edge1136" class="edge">
<title>kv_send1_3_14&#45;&gt;ring_stage1_4_15</title>
<path fill="none" stroke="black" d="M4367.1,-13764.61C4366.83,-13756.57 4366.52,-13747.6 4366.23,-13739.04"/>
<polygon fill="black" stroke="black" points="4369.72,-13738.77 4365.88,-13728.9 4362.72,-13739.01 4369.72,-13738.77"/>
</g>
<!-- kv_send1_3_15&#45;&gt;ring_stage1_4_0 -->
<g id="edge1091" class="edge">
<title>kv_send1_3_15&#45;&gt;ring_stage1_4_0</title>
<path fill="none" stroke="black" d="M4130,-13674.87C4130,-13666.83 4130,-13657.85 4130,-13649.3"/>
<polygon fill="black" stroke="black" points="4133.5,-13649.16 4130,-13639.16 4126.5,-13649.16 4133.5,-13649.16"/>
</g>
<!-- kv_send1_4_0 -->
<g id="node803" class="node">
<title>kv_send1_4_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4130" cy="-13522.72" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4130" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4130" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_4_0&#45;&gt;kv_send1_4_0 -->
<g id="edge1092" class="edge">
<title>ring_stage1_4_0&#45;&gt;kv_send1_4_0</title>
<path fill="none" stroke="black" d="M4130,-13585.61C4130,-13577.56 4130,-13568.53 4130,-13559.91"/>
<polygon fill="black" stroke="black" points="4133.5,-13559.69 4130,-13549.69 4126.5,-13559.69 4133.5,-13559.69"/>
</g>
<!-- ring_stage1_5_0 -->
<g id="node819" class="node">
<title>ring_stage1_5_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4466.5,-13549.22 4255.5,-13549.22 4255.5,-13496.22 4466.5,-13496.22 4466.5,-13549.22"/>
<text text-anchor="middle" x="4361" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="4361" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_11×V_11</text>
<text text-anchor="middle" x="4361" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_4_0&#45;&gt;ring_stage1_5_0 -->
<g id="edge1138" class="edge">
<title>ring_stage1_4_0&#45;&gt;ring_stage1_5_0</title>
<path fill="none" stroke="black" d="M4197.44,-13585.84C4224.6,-13575.53 4256.07,-13563.57 4284.11,-13552.92"/>
<polygon fill="black" stroke="black" points="4285.37,-13556.19 4293.48,-13549.36 4282.89,-13549.64 4285.37,-13556.19"/>
</g>
<!-- kv_send1_4_1 -->
<g id="node804" class="node">
<title>kv_send1_4_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6447" cy="-14868.82" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6447" y="-14872.62" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="6447" y="-14857.62" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_4_1&#45;&gt;kv_send1_4_1 -->
<g id="edge1095" class="edge">
<title>ring_stage1_4_1&#45;&gt;kv_send1_4_1</title>
<path fill="none" stroke="black" d="M6308.22,-14931.95C6333.07,-14920.82 6362.17,-14907.79 6387.29,-14896.55"/>
<polygon fill="black" stroke="black" points="6389.01,-14899.61 6396.71,-14892.33 6386.15,-14893.22 6389.01,-14899.61"/>
</g>
<!-- ring_stage1_5_1 -->
<g id="node820" class="node">
<title>ring_stage1_5_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4235.5,-13459.48 4024.5,-13459.48 4024.5,-13406.48 4235.5,-13406.48 4235.5,-13459.48"/>
<text text-anchor="middle" x="4130" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="4130" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_12×V_12</text>
<text text-anchor="middle" x="4130" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_4_1&#45;&gt;ring_stage1_5_1 -->
<g id="edge1141" class="edge">
<title>ring_stage1_4_1&#45;&gt;ring_stage1_5_1</title>
<path fill="none" stroke="black" d="M6145.47,-14949.89C6031.75,-14940.72 5845.71,-14923.07 5687,-14895.69 5584.83,-14878.06 5562.38,-14858.27 5460,-14841.95 5271.05,-14811.83 5218.81,-14842.54 5031,-14805.95 4898.99,-14780.23 4870.31,-14756.53 4742,-14716.21 4666.81,-14692.58 4648.28,-14685.81 4573,-14662.47 4480.76,-14633.86 4238.95,-14587.82 4157,-14536.73 4129.32,-14519.47 4131.57,-14504.45 4107,-14482.99 4086.11,-14464.74 4074,-14468.1 4056,-14446.99 3967.91,-14343.67 3977,-14287.67 3977,-14151.9 3977,-14151.9 3977,-14151.9 3977,-13611.46 3977,-13556.94 3982.73,-13537.42 4018,-13495.85 4028.53,-13483.43 4042.21,-13473.05 4056.38,-13464.57"/>
<polygon fill="black" stroke="black" points="4058.27,-13467.51 4065.23,-13459.52 4054.81,-13461.43 4058.27,-13467.51"/>
</g>
<!-- kv_send1_4_2 -->
<g id="node805" class="node">
<title>kv_send1_4_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6903" cy="-14779.08" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6903" y="-14782.88" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="6903" y="-14767.88" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_4_2&#45;&gt;kv_send1_4_2 -->
<g id="edge1098" class="edge">
<title>ring_stage1_4_2&#45;&gt;kv_send1_4_2</title>
<path fill="none" stroke="black" d="M6741.56,-14842.21C6771.69,-14830.61 6807.19,-14816.95 6837.22,-14805.39"/>
<polygon fill="black" stroke="black" points="6838.69,-14808.58 6846.77,-14801.72 6836.18,-14802.04 6838.69,-14808.58"/>
</g>
<!-- ring_stage1_5_2 -->
<g id="node821" class="node">
<title>ring_stage1_5_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6557.5,-14805.58 6346.5,-14805.58 6346.5,-14752.58 6557.5,-14752.58 6557.5,-14805.58"/>
<text text-anchor="middle" x="6452" y="-14790.38" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6452" y="-14775.38" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_13×V_13</text>
<text text-anchor="middle" x="6452" y="-14760.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_4_2&#45;&gt;ring_stage1_5_2 -->
<g id="edge1144" class="edge">
<title>ring_stage1_4_2&#45;&gt;ring_stage1_5_2</title>
<path fill="none" stroke="black" d="M6609.9,-14842.21C6583.79,-14831.93 6553.56,-14820.04 6526.58,-14809.42"/>
<polygon fill="black" stroke="black" points="6527.77,-14806.13 6517.18,-14805.73 6525.21,-14812.64 6527.77,-14806.13"/>
</g>
<!-- kv_send1_4_3 -->
<g id="node806" class="node">
<title>kv_send1_4_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7561" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7561" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7561" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_4_3&#45;&gt;kv_send1_4_3 -->
<g id="edge1101" class="edge">
<title>ring_stage1_4_3&#45;&gt;kv_send1_4_3</title>
<path fill="none" stroke="black" d="M7405.22,-14752.47C7433.94,-14741.01 7467.72,-14727.54 7496.47,-14716.08"/>
<polygon fill="black" stroke="black" points="7498.02,-14719.22 7506.01,-14712.27 7495.43,-14712.72 7498.02,-14719.22"/>
</g>
<!-- ring_stage1_5_3 -->
<g id="node822" class="node">
<title>ring_stage1_5_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7224.5,-14715.84 7013.5,-14715.84 7013.5,-14662.84 7224.5,-14662.84 7224.5,-14715.84"/>
<text text-anchor="middle" x="7119" y="-14700.64" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="7119" y="-14685.64" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_14×V_14</text>
<text text-anchor="middle" x="7119" y="-14670.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_4_3&#45;&gt;ring_stage1_5_3 -->
<g id="edge1147" class="edge">
<title>ring_stage1_4_3&#45;&gt;ring_stage1_5_3</title>
<path fill="none" stroke="black" d="M7276.19,-14752.47C7250.2,-14742.19 7220.1,-14730.3 7193.24,-14719.68"/>
<polygon fill="black" stroke="black" points="7194.48,-14716.41 7183.89,-14715.98 7191.9,-14722.92 7194.48,-14716.41"/>
</g>
<!-- kv_send1_4_4 -->
<g id="node807" class="node">
<title>kv_send1_4_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7110" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7110" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="7110" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_4_4&#45;&gt;kv_send1_4_4 -->
<g id="edge1104" class="edge">
<title>ring_stage1_4_4&#45;&gt;kv_send1_4_4</title>
<path fill="none" stroke="black" d="M7274.98,-14662.73C7243.94,-14651.04 7207.31,-14637.24 7176.46,-14625.63"/>
<polygon fill="black" stroke="black" points="7177.68,-14622.34 7167.08,-14622.09 7175.21,-14628.89 7177.68,-14622.34"/>
</g>
<!-- ring_stage1_5_4 -->
<g id="node823" class="node">
<title>ring_stage1_5_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7666.5,-14626.1 7455.5,-14626.1 7455.5,-14573.1 7666.5,-14573.1 7666.5,-14626.1"/>
<text text-anchor="middle" x="7561" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="7561" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_15×V_15</text>
<text text-anchor="middle" x="7561" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_4_4&#45;&gt;ring_stage1_5_4 -->
<g id="edge1150" class="edge">
<title>ring_stage1_4_4&#45;&gt;ring_stage1_5_4</title>
<path fill="none" stroke="black" d="M7406.64,-14662.73C7432.05,-14652.5 7461.46,-14640.66 7487.75,-14630.08"/>
<polygon fill="black" stroke="black" points="7489.31,-14633.23 7497.28,-14626.24 7486.7,-14626.73 7489.31,-14633.23"/>
</g>
<!-- kv_send1_4_5 -->
<g id="node808" class="node">
<title>kv_send1_4_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6663" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6663" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6663" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_4_5&#45;&gt;kv_send1_4_5 -->
<g id="edge1107" class="edge">
<title>ring_stage1_4_5&#45;&gt;kv_send1_4_5</title>
<path fill="none" stroke="black" d="M6663,-14572.75C6663,-14564.7 6663,-14555.67 6663,-14547.05"/>
<polygon fill="black" stroke="black" points="6666.5,-14546.83 6663,-14536.83 6659.5,-14546.83 6666.5,-14546.83"/>
</g>
<!-- ring_stage1_5_5 -->
<g id="node824" class="node">
<title>ring_stage1_5_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6998.5,-14536.36 6805.5,-14536.36 6805.5,-14483.36 6998.5,-14483.36 6998.5,-14536.36"/>
<text text-anchor="middle" x="6902" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6902" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_0×V_0</text>
<text text-anchor="middle" x="6902" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_4_5&#45;&gt;ring_stage1_5_5 -->
<g id="edge1153" class="edge">
<title>ring_stage1_4_5&#45;&gt;ring_stage1_5_5</title>
<path fill="none" stroke="black" d="M6732.77,-14572.99C6760.87,-14562.67 6793.44,-14550.71 6822.45,-14540.06"/>
<polygon fill="black" stroke="black" points="6823.96,-14543.24 6832.14,-14536.5 6821.55,-14536.67 6823.96,-14543.24"/>
</g>
<!-- kv_send1_4_6 -->
<g id="node809" class="node">
<title>kv_send1_4_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6445" cy="-14420.12" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6445" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6445" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_4_6&#45;&gt;kv_send1_4_6 -->
<g id="edge1110" class="edge">
<title>ring_stage1_4_6&#45;&gt;kv_send1_4_6</title>
<path fill="none" stroke="black" d="M6445,-14483.01C6445,-14474.96 6445,-14465.93 6445,-14457.31"/>
<polygon fill="black" stroke="black" points="6448.5,-14457.09 6445,-14447.09 6441.5,-14457.09 6448.5,-14457.09"/>
</g>
<!-- ring_stage1_5_6 -->
<g id="node825" class="node">
<title>ring_stage1_5_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6759.5,-14446.62 6566.5,-14446.62 6566.5,-14393.62 6759.5,-14393.62 6759.5,-14446.62"/>
<text text-anchor="middle" x="6663" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6663" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_1×V_1</text>
<text text-anchor="middle" x="6663" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_4_6&#45;&gt;ring_stage1_5_6 -->
<g id="edge1156" class="edge">
<title>ring_stage1_4_6&#45;&gt;ring_stage1_5_6</title>
<path fill="none" stroke="black" d="M6508.64,-14483.25C6534.05,-14473.02 6563.46,-14461.18 6589.75,-14450.6"/>
<polygon fill="black" stroke="black" points="6591.31,-14453.75 6599.28,-14446.76 6588.7,-14447.25 6591.31,-14453.75"/>
</g>
<!-- kv_send1_4_7 -->
<g id="node810" class="node">
<title>kv_send1_4_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6236" cy="-14330.38" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6236" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="6236" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_4_7&#45;&gt;kv_send1_4_7 -->
<g id="edge1113" class="edge">
<title>ring_stage1_4_7&#45;&gt;kv_send1_4_7</title>
<path fill="none" stroke="black" d="M6215.54,-14393.27C6218.26,-14385.04 6221.32,-14375.79 6224.23,-14367"/>
<polygon fill="black" stroke="black" points="6227.6,-14367.94 6227.42,-14357.35 6220.96,-14365.74 6227.6,-14367.94"/>
</g>
<!-- ring_stage1_5_7 -->
<g id="node826" class="node">
<title>ring_stage1_5_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6572.5,-14356.88 6379.5,-14356.88 6379.5,-14303.88 6572.5,-14303.88 6572.5,-14356.88"/>
<text text-anchor="middle" x="6476" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6476" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_2×V_2</text>
<text text-anchor="middle" x="6476" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_4_7&#45;&gt;ring_stage1_5_7 -->
<g id="edge1159" class="edge">
<title>ring_stage1_4_7&#45;&gt;ring_stage1_5_7</title>
<path fill="none" stroke="black" d="M6285.53,-14393.5C6317.57,-14383.05 6354.77,-14370.92 6387.74,-14360.17"/>
<polygon fill="black" stroke="black" points="6388.95,-14363.45 6397.37,-14357.02 6386.78,-14356.8 6388.95,-14363.45"/>
</g>
<!-- kv_send1_4_8 -->
<g id="node811" class="node">
<title>kv_send1_4_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6019" cy="-14240.64" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6019" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="6019" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_4_8&#45;&gt;kv_send1_4_8 -->
<g id="edge1116" class="edge">
<title>ring_stage1_4_8&#45;&gt;kv_send1_4_8</title>
<path fill="none" stroke="black" d="M6018.29,-14303.53C6018.39,-14295.48 6018.49,-14286.45 6018.59,-14277.83"/>
<polygon fill="black" stroke="black" points="6022.09,-14277.65 6018.7,-14267.61 6015.09,-14277.57 6022.09,-14277.65"/>
</g>
<!-- ring_stage1_5_8 -->
<g id="node827" class="node">
<title>ring_stage1_5_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6335.5,-14267.14 6142.5,-14267.14 6142.5,-14214.14 6335.5,-14214.14 6335.5,-14267.14"/>
<text text-anchor="middle" x="6239" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6239" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_3×V_3</text>
<text text-anchor="middle" x="6239" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_4_8&#45;&gt;ring_stage1_5_8 -->
<g id="edge1162" class="edge">
<title>ring_stage1_4_8&#45;&gt;ring_stage1_5_8</title>
<path fill="none" stroke="black" d="M6082.52,-14303.76C6108.39,-14293.49 6138.35,-14281.6 6165.09,-14270.98"/>
<polygon fill="black" stroke="black" points="6166.4,-14274.23 6174.4,-14267.28 6163.82,-14267.72 6166.4,-14274.23"/>
</g>
<!-- kv_send1_4_9 -->
<g id="node812" class="node">
<title>kv_send1_4_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5795" cy="-14150.9" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5795" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="5795" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_4_9&#45;&gt;kv_send1_4_9 -->
<g id="edge1119" class="edge">
<title>ring_stage1_4_9&#45;&gt;kv_send1_4_9</title>
<path fill="none" stroke="black" d="M5799.23,-14213.79C5798.68,-14205.74 5798.06,-14196.71 5797.47,-14188.09"/>
<polygon fill="black" stroke="black" points="5800.95,-14187.61 5796.78,-14177.87 5793.97,-14188.08 5800.95,-14187.61"/>
</g>
<!-- ring_stage1_5_9 -->
<g id="node828" class="node">
<title>ring_stage1_5_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6115.5,-14177.4 5922.5,-14177.4 5922.5,-14124.4 6115.5,-14124.4 6115.5,-14177.4"/>
<text text-anchor="middle" x="6019" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="6019" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_4×V_4</text>
<text text-anchor="middle" x="6019" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_4_9&#45;&gt;ring_stage1_5_9 -->
<g id="edge1165" class="edge">
<title>ring_stage1_4_9&#45;&gt;ring_stage1_5_9</title>
<path fill="none" stroke="black" d="M5864.64,-14214.02C5890.05,-14203.8 5919.46,-14191.96 5945.75,-14181.38"/>
<polygon fill="black" stroke="black" points="5947.31,-14184.52 5955.28,-14177.54 5944.7,-14178.03 5947.31,-14184.52"/>
</g>
<!-- kv_send1_4_10 -->
<g id="node813" class="node">
<title>kv_send1_4_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5558" cy="-14061.16" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5558" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="5558" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_4_10&#45;&gt;kv_send1_4_10 -->
<g id="edge1122" class="edge">
<title>ring_stage1_4_10&#45;&gt;kv_send1_4_10</title>
<path fill="none" stroke="black" d="M5563.64,-14124.05C5562.91,-14116 5562.09,-14106.97 5561.3,-14098.35"/>
<polygon fill="black" stroke="black" points="5564.76,-14097.77 5560.37,-14088.13 5557.79,-14098.4 5564.76,-14097.77"/>
</g>
<!-- ring_stage1_5_10 -->
<g id="node829" class="node">
<title>ring_stage1_5_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5888,-14087.66 5686,-14087.66 5686,-14034.66 5888,-14034.66 5888,-14087.66"/>
<text text-anchor="middle" x="5787" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="5787" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_5×V_5</text>
<text text-anchor="middle" x="5787" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_4_10&#45;&gt;ring_stage1_5_10 -->
<g id="edge1168" class="edge">
<title>ring_stage1_4_10&#45;&gt;ring_stage1_5_10</title>
<path fill="none" stroke="black" d="M5630.52,-14124.28C5656.39,-14114.01 5686.35,-14102.12 5713.09,-14091.5"/>
<polygon fill="black" stroke="black" points="5714.4,-14094.75 5722.4,-14087.8 5711.82,-14088.24 5714.4,-14094.75"/>
</g>
<!-- kv_send1_4_11 -->
<g id="node814" class="node">
<title>kv_send1_4_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5319" cy="-13971.42" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5319" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5319" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_4_11&#45;&gt;kv_send1_4_11 -->
<g id="edge1125" class="edge">
<title>ring_stage1_4_11&#45;&gt;kv_send1_4_11</title>
<path fill="none" stroke="black" d="M5326.05,-14034.31C5325.13,-14026.17 5324.08,-14017.03 5323.09,-14008.32"/>
<polygon fill="black" stroke="black" points="5326.57,-14007.93 5321.96,-13998.39 5319.61,-14008.72 5326.57,-14007.93"/>
</g>
<!-- ring_stage1_5_11 -->
<g id="node830" class="node">
<title>ring_stage1_5_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5649,-13997.92 5447,-13997.92 5447,-13944.92 5649,-13944.92 5649,-13997.92"/>
<text text-anchor="middle" x="5548" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="5548" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_6×V_6</text>
<text text-anchor="middle" x="5548" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_4_11&#45;&gt;ring_stage1_5_11 -->
<g id="edge1171" class="edge">
<title>ring_stage1_4_11&#45;&gt;ring_stage1_5_11</title>
<path fill="none" stroke="black" d="M5392.93,-14034.54C5418.46,-14024.32 5448,-14012.48 5474.41,-14001.9"/>
<polygon fill="black" stroke="black" points="5476.01,-14005.03 5483.99,-13998.06 5473.4,-13998.53 5476.01,-14005.03"/>
</g>
<!-- kv_send1_4_12 -->
<g id="node815" class="node">
<title>kv_send1_4_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5080" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5080" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="5080" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_4_12&#45;&gt;kv_send1_4_12 -->
<g id="edge1128" class="edge">
<title>ring_stage1_4_12&#45;&gt;kv_send1_4_12</title>
<path fill="none" stroke="black" d="M5087.05,-13944.57C5086.13,-13936.43 5085.08,-13927.29 5084.09,-13918.58"/>
<polygon fill="black" stroke="black" points="5087.57,-13918.19 5082.96,-13908.65 5080.61,-13918.98 5087.57,-13918.19"/>
</g>
<!-- ring_stage1_5_12 -->
<g id="node831" class="node">
<title>ring_stage1_5_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5410,-13908.18 5208,-13908.18 5208,-13855.18 5410,-13855.18 5410,-13908.18"/>
<text text-anchor="middle" x="5309" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="5309" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_7×V_7</text>
<text text-anchor="middle" x="5309" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_4_12&#45;&gt;ring_stage1_5_12 -->
<g id="edge1174" class="edge">
<title>ring_stage1_4_12&#45;&gt;ring_stage1_5_12</title>
<path fill="none" stroke="black" d="M5153.93,-13944.8C5179.46,-13934.58 5209,-13922.74 5235.41,-13912.16"/>
<polygon fill="black" stroke="black" points="5237.01,-13915.29 5244.99,-13908.32 5234.4,-13908.79 5237.01,-13915.29"/>
</g>
<!-- kv_send1_4_13 -->
<g id="node816" class="node">
<title>kv_send1_4_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4844" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4844" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="4844" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_4_13&#45;&gt;kv_send1_4_13 -->
<g id="edge1131" class="edge">
<title>ring_stage1_4_13&#45;&gt;kv_send1_4_13</title>
<path fill="none" stroke="black" d="M4848.94,-13854.83C4848.3,-13846.78 4847.57,-13837.75 4846.89,-13829.13"/>
<polygon fill="black" stroke="black" points="4850.36,-13828.6 4846.07,-13818.91 4843.38,-13829.15 4850.36,-13828.6"/>
</g>
<!-- ring_stage1_5_13 -->
<g id="node832" class="node">
<title>ring_stage1_5_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5174,-13818.44 4972,-13818.44 4972,-13765.44 5174,-13765.44 5174,-13818.44"/>
<text text-anchor="middle" x="5073" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="5073" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_8×V_8</text>
<text text-anchor="middle" x="5073" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_4_13&#45;&gt;ring_stage1_5_13 -->
<g id="edge1177" class="edge">
<title>ring_stage1_4_13&#45;&gt;ring_stage1_5_13</title>
<path fill="none" stroke="black" d="M4915.81,-13855.06C4941.8,-13844.79 4971.9,-13832.9 4998.76,-13822.28"/>
<polygon fill="black" stroke="black" points="5000.1,-13825.51 5008.11,-13818.58 4997.52,-13819 5000.1,-13825.51"/>
</g>
<!-- kv_send1_4_14 -->
<g id="node817" class="node">
<title>kv_send1_4_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4604" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4604" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="4604" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_4_14&#45;&gt;kv_send1_4_14 -->
<g id="edge1134" class="edge">
<title>ring_stage1_4_14&#45;&gt;kv_send1_4_14</title>
<path fill="none" stroke="black" d="M4605.41,-13765.09C4605.23,-13757.04 4605.02,-13748.01 4604.82,-13739.39"/>
<polygon fill="black" stroke="black" points="4608.32,-13739.08 4604.59,-13729.17 4601.32,-13739.24 4608.32,-13739.08"/>
</g>
<!-- ring_stage1_5_14 -->
<g id="node833" class="node">
<title>ring_stage1_5_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4934,-13728.7 4732,-13728.7 4732,-13675.7 4934,-13675.7 4934,-13728.7"/>
<text text-anchor="middle" x="4833" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="4833" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_9×V_9</text>
<text text-anchor="middle" x="4833" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_4_14&#45;&gt;ring_stage1_5_14 -->
<g id="edge1180" class="edge">
<title>ring_stage1_4_14&#45;&gt;ring_stage1_5_14</title>
<path fill="none" stroke="black" d="M4672.27,-13765.32C4698.84,-13755.05 4729.62,-13743.16 4757.08,-13732.54"/>
<polygon fill="black" stroke="black" points="4758.58,-13735.71 4766.65,-13728.84 4756.06,-13729.18 4758.58,-13735.71"/>
</g>
<!-- kv_send1_4_15 -->
<g id="node818" class="node">
<title>kv_send1_4_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4362" cy="-13612.46" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4362" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="4362" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_4_15&#45;&gt;kv_send1_4_15 -->
<g id="edge1137" class="edge">
<title>ring_stage1_4_15&#45;&gt;kv_send1_4_15</title>
<path fill="none" stroke="black" d="M4364.12,-13675.35C4363.84,-13667.3 4363.53,-13658.27 4363.24,-13649.65"/>
<polygon fill="black" stroke="black" points="4366.73,-13649.3 4362.89,-13639.43 4359.73,-13649.54 4366.73,-13649.3"/>
</g>
<!-- ring_stage1_5_15 -->
<g id="node834" class="node">
<title>ring_stage1_5_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4703,-13638.96 4483,-13638.96 4483,-13585.96 4703,-13585.96 4703,-13638.96"/>
<text text-anchor="middle" x="4593" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="4593" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_10×V_10</text>
<text text-anchor="middle" x="4593" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_4_15&#45;&gt;ring_stage1_5_15 -->
<g id="edge1183" class="edge">
<title>ring_stage1_4_15&#45;&gt;ring_stage1_5_15</title>
<path fill="none" stroke="black" d="M4431.56,-13675.58C4458.25,-13665.31 4489.16,-13653.42 4516.75,-13642.8"/>
<polygon fill="black" stroke="black" points="4518.28,-13645.96 4526.36,-13639.1 4515.77,-13639.43 4518.28,-13645.96"/>
</g>
<!-- kv_send1_4_0&#45;&gt;ring_stage1_5_1 -->
<g id="edge1142" class="edge">
<title>kv_send1_4_0&#45;&gt;ring_stage1_5_1</title>
<path fill="none" stroke="black" d="M4130,-13495.39C4130,-13487.35 4130,-13478.37 4130,-13469.82"/>
<polygon fill="black" stroke="black" points="4133.5,-13469.68 4130,-13459.68 4126.5,-13469.68 4133.5,-13469.68"/>
</g>
<!-- kv_send1_4_1&#45;&gt;ring_stage1_5_2 -->
<g id="edge1145" class="edge">
<title>kv_send1_4_1&#45;&gt;ring_stage1_5_2</title>
<path fill="none" stroke="black" d="M6448.5,-14841.49C6448.96,-14833.46 6449.47,-14824.48 6449.96,-14815.92"/>
<polygon fill="black" stroke="black" points="6453.46,-14815.96 6450.54,-14805.78 6446.47,-14815.57 6453.46,-14815.96"/>
</g>
<!-- kv_send1_4_2&#45;&gt;ring_stage1_5_3 -->
<g id="edge1148" class="edge">
<title>kv_send1_4_2&#45;&gt;ring_stage1_5_3</title>
<path fill="none" stroke="black" d="M6956.95,-14756.17C6984.12,-14745.13 7017.45,-14731.59 7046.8,-14719.67"/>
<polygon fill="black" stroke="black" points="7048.22,-14722.87 7056.17,-14715.86 7045.59,-14716.38 7048.22,-14722.87"/>
</g>
<!-- kv_send1_4_3&#45;&gt;ring_stage1_5_4 -->
<g id="edge1151" class="edge">
<title>kv_send1_4_3&#45;&gt;ring_stage1_5_4</title>
<path fill="none" stroke="black" d="M7561,-14662.01C7561,-14653.98 7561,-14645 7561,-14636.44"/>
<polygon fill="black" stroke="black" points="7564.5,-14636.3 7561,-14626.3 7557.5,-14636.3 7564.5,-14636.3"/>
</g>
<!-- kv_send1_4_4&#45;&gt;ring_stage1_5_5 -->
<g id="edge1154" class="edge">
<title>kv_send1_4_4&#45;&gt;ring_stage1_5_5</title>
<path fill="none" stroke="black" d="M7057.51,-14576.46C7031.56,-14565.51 6999.89,-14552.15 6971.91,-14540.35"/>
<polygon fill="black" stroke="black" points="6973.16,-14537.08 6962.58,-14536.41 6970.43,-14543.53 6973.16,-14537.08"/>
</g>
<!-- kv_send1_4_5&#45;&gt;ring_stage1_5_6 -->
<g id="edge1157" class="edge">
<title>kv_send1_4_5&#45;&gt;ring_stage1_5_6</title>
<path fill="none" stroke="black" d="M6663,-14482.53C6663,-14474.5 6663,-14465.52 6663,-14456.96"/>
<polygon fill="black" stroke="black" points="6666.5,-14456.82 6663,-14446.82 6659.5,-14456.82 6666.5,-14456.82"/>
</g>
<!-- kv_send1_4_6&#45;&gt;ring_stage1_5_7 -->
<g id="edge1160" class="edge">
<title>kv_send1_4_6&#45;&gt;ring_stage1_5_7</title>
<path fill="none" stroke="black" d="M6454.13,-14393.27C6457.1,-14384.88 6460.44,-14375.43 6463.6,-14366.48"/>
<polygon fill="black" stroke="black" points="6466.9,-14367.64 6466.93,-14357.04 6460.3,-14365.31 6466.9,-14367.64"/>
</g>
<!-- kv_send1_4_7&#45;&gt;ring_stage1_5_8 -->
<g id="edge1163" class="edge">
<title>kv_send1_4_7&#45;&gt;ring_stage1_5_8</title>
<path fill="none" stroke="black" d="M6236.9,-14303.05C6237.17,-14295.02 6237.48,-14286.04 6237.77,-14277.48"/>
<polygon fill="black" stroke="black" points="6241.28,-14277.45 6238.12,-14267.34 6234.28,-14277.22 6241.28,-14277.45"/>
</g>
<!-- kv_send1_4_8&#45;&gt;ring_stage1_5_9 -->
<g id="edge1166" class="edge">
<title>kv_send1_4_8&#45;&gt;ring_stage1_5_9</title>
<path fill="none" stroke="black" d="M6019,-14213.31C6019,-14205.28 6019,-14196.3 6019,-14187.74"/>
<polygon fill="black" stroke="black" points="6022.5,-14187.6 6019,-14177.6 6015.5,-14187.6 6022.5,-14187.6"/>
</g>
<!-- kv_send1_4_9&#45;&gt;ring_stage1_5_10 -->
<g id="edge1169" class="edge">
<title>kv_send1_4_9&#45;&gt;ring_stage1_5_10</title>
<path fill="none" stroke="black" d="M5792.6,-14123.57C5791.87,-14115.54 5791.05,-14106.56 5790.27,-14098"/>
<polygon fill="black" stroke="black" points="5793.74,-14097.5 5789.34,-14087.86 5786.77,-14098.14 5793.74,-14097.5"/>
</g>
<!-- kv_send1_4_10&#45;&gt;ring_stage1_5_11 -->
<g id="edge1172" class="edge">
<title>kv_send1_4_10&#45;&gt;ring_stage1_5_11</title>
<path fill="none" stroke="black" d="M5555,-14033.83C5554.08,-14025.79 5553.06,-14016.82 5552.08,-14008.26"/>
<polygon fill="black" stroke="black" points="5555.54,-14007.66 5550.93,-13998.12 5548.58,-14008.45 5555.54,-14007.66"/>
</g>
<!-- kv_send1_4_11&#45;&gt;ring_stage1_5_12 -->
<g id="edge1175" class="edge">
<title>kv_send1_4_11&#45;&gt;ring_stage1_5_12</title>
<path fill="none" stroke="black" d="M5316,-13944.09C5315.08,-13936.05 5314.06,-13927.08 5313.08,-13918.52"/>
<polygon fill="black" stroke="black" points="5316.54,-13917.92 5311.93,-13908.38 5309.58,-13918.71 5316.54,-13917.92"/>
</g>
<!-- kv_send1_4_12&#45;&gt;ring_stage1_5_13 -->
<g id="edge1178" class="edge">
<title>kv_send1_4_12&#45;&gt;ring_stage1_5_13</title>
<path fill="none" stroke="black" d="M5077.9,-13854.35C5077.26,-13846.31 5076.54,-13837.34 5075.86,-13828.78"/>
<polygon fill="black" stroke="black" points="5079.33,-13828.33 5075.05,-13818.64 5072.36,-13828.89 5079.33,-13828.33"/>
</g>
<!-- kv_send1_4_13&#45;&gt;ring_stage1_5_14 -->
<g id="edge1181" class="edge">
<title>kv_send1_4_13&#45;&gt;ring_stage1_5_14</title>
<path fill="none" stroke="black" d="M4840.7,-13764.61C4839.69,-13756.57 4838.57,-13747.6 4837.49,-13739.04"/>
<polygon fill="black" stroke="black" points="4840.94,-13738.39 4836.22,-13728.9 4833.99,-13739.26 4840.94,-13738.39"/>
</g>
<!-- kv_send1_4_14&#45;&gt;ring_stage1_5_15 -->
<g id="edge1184" class="edge">
<title>kv_send1_4_14&#45;&gt;ring_stage1_5_15</title>
<path fill="none" stroke="black" d="M4600.7,-13674.87C4599.69,-13666.83 4598.57,-13657.85 4597.49,-13649.3"/>
<polygon fill="black" stroke="black" points="4600.94,-13648.65 4596.22,-13639.16 4593.99,-13649.52 4600.94,-13648.65"/>
</g>
<!-- kv_send1_4_15&#45;&gt;ring_stage1_5_0 -->
<g id="edge1139" class="edge">
<title>kv_send1_4_15&#45;&gt;ring_stage1_5_0</title>
<path fill="none" stroke="black" d="M4361.7,-13585.13C4361.61,-13577.09 4361.51,-13568.11 4361.41,-13559.56"/>
<polygon fill="black" stroke="black" points="4364.91,-13559.38 4361.29,-13549.42 4357.91,-13559.46 4364.91,-13559.38"/>
</g>
<!-- kv_send1_5_0 -->
<g id="node835" class="node">
<title>kv_send1_5_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4357" cy="-13432.98" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4357" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4357" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_5_0&#45;&gt;kv_send1_5_0 -->
<g id="edge1140" class="edge">
<title>ring_stage1_5_0&#45;&gt;kv_send1_5_0</title>
<path fill="none" stroke="black" d="M4359.82,-13495.87C4359.45,-13487.82 4359.04,-13478.79 4358.65,-13470.17"/>
<polygon fill="black" stroke="black" points="4362.14,-13469.78 4358.18,-13459.95 4355.14,-13470.1 4362.14,-13469.78"/>
</g>
<!-- ring_stage1_6_0 -->
<g id="node851" class="node">
<title>ring_stage1_6_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4689.5,-13459.48 4478.5,-13459.48 4478.5,-13406.48 4689.5,-13406.48 4689.5,-13459.48"/>
<text text-anchor="middle" x="4584" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="4584" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_10×V_10</text>
<text text-anchor="middle" x="4584" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_5_0&#45;&gt;ring_stage1_6_0 -->
<g id="edge1186" class="edge">
<title>ring_stage1_5_0&#45;&gt;ring_stage1_6_0</title>
<path fill="none" stroke="black" d="M4426.1,-13496.1C4452.21,-13485.83 4482.44,-13473.94 4509.42,-13463.32"/>
<polygon fill="black" stroke="black" points="4510.79,-13466.54 4518.82,-13459.62 4508.23,-13460.03 4510.79,-13466.54"/>
</g>
<!-- kv_send1_5_1 -->
<g id="node836" class="node">
<title>kv_send1_5_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4807" cy="-13343.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4807" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4807" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_5_1&#45;&gt;kv_send1_5_1 -->
<g id="edge1143" class="edge">
<title>ring_stage1_5_1&#45;&gt;kv_send1_5_1</title>
<path fill="none" stroke="black" d="M4235.79,-13407.59C4238.89,-13407.06 4241.97,-13406.57 4245,-13406.11 4443.37,-13376.01 4496.72,-13400.77 4695,-13370.11 4704.76,-13368.6 4714.94,-13366.7 4725,-13364.63"/>
<polygon fill="black" stroke="black" points="4725.95,-13368.01 4735,-13362.51 4724.5,-13361.16 4725.95,-13368.01"/>
</g>
<!-- ring_stage1_6_1 -->
<g id="node852" class="node">
<title>ring_stage1_6_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4245.5,-13369.74 4034.5,-13369.74 4034.5,-13316.74 4245.5,-13316.74 4245.5,-13369.74"/>
<text text-anchor="middle" x="4140" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="4140" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_11×V_11</text>
<text text-anchor="middle" x="4140" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_5_1&#45;&gt;ring_stage1_6_1 -->
<g id="edge1189" class="edge">
<title>ring_stage1_5_1&#45;&gt;ring_stage1_6_1</title>
<path fill="none" stroke="black" d="M4132.95,-13406.13C4133.88,-13397.92 4134.93,-13388.69 4135.93,-13379.91"/>
<polygon fill="black" stroke="black" points="4139.42,-13380.24 4137.07,-13369.9 4132.46,-13379.44 4139.42,-13380.24"/>
</g>
<!-- kv_send1_5_2 -->
<g id="node837" class="node">
<title>kv_send1_5_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6666" cy="-14689.34" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6666" y="-14693.14" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="6666" y="-14678.14" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_5_2&#45;&gt;kv_send1_5_2 -->
<g id="edge1146" class="edge">
<title>ring_stage1_5_2&#45;&gt;kv_send1_5_2</title>
<path fill="none" stroke="black" d="M6514.47,-14752.47C6542.29,-14741.06 6575,-14727.65 6602.9,-14716.21"/>
<polygon fill="black" stroke="black" points="6604.23,-14719.45 6612.16,-14712.41 6601.58,-14712.97 6604.23,-14719.45"/>
</g>
<!-- ring_stage1_6_2 -->
<g id="node853" class="node">
<title>ring_stage1_6_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5589.5,-13280 5378.5,-13280 5378.5,-13227 5589.5,-13227 5589.5,-13280"/>
<text text-anchor="middle" x="5484" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="5484" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_12×V_12</text>
<text text-anchor="middle" x="5484" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_5_2&#45;&gt;ring_stage1_6_2 -->
<g id="edge1192" class="edge">
<title>ring_stage1_5_2&#45;&gt;ring_stage1_6_2</title>
<path fill="none" stroke="black" d="M6383.64,-14752.58C6367.37,-14743.45 6351.65,-14731.51 6341,-14716.21 6311.28,-14673.54 6323,-14652.6 6323,-14600.6 6323,-14600.6 6323,-14600.6 6323,-14508.86 6323,-14457.28 6320.71,-14443.34 6333,-14393.25 6337.13,-14376.41 6344.6,-14374.25 6348,-14357.25 6352.68,-14333.83 6348.4,-14327.39 6348,-14303.51 6347.33,-14263.61 6371.08,-14243.98 6345,-14213.77 6286.55,-14146.07 6207.12,-14243.99 6147,-14177.77 6103.98,-14130.39 6178.42,-14081.3 6135,-14034.29 6068.08,-13961.82 5992.16,-14060.98 5916,-13998.29 5896.32,-13982.09 5915.68,-13960.75 5896,-13944.55 5819.84,-13881.86 5747.22,-13977.82 5677,-13908.55 5648.16,-13880.1 5666.86,-13858.89 5661,-13818.81 5658.97,-13804.9 5609,-13327.92 5601,-13316.37 5592.25,-13303.74 5580.09,-13293.49 5566.9,-13285.23"/>
<polygon fill="black" stroke="black" points="5568.51,-13282.12 5558.11,-13280.09 5564.97,-13288.16 5568.51,-13282.12"/>
</g>
<!-- kv_send1_5_3 -->
<g id="node838" class="node">
<title>kv_send1_5_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7334" cy="-14599.6" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7334" y="-14603.4" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7334" y="-14588.4" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_5_3&#45;&gt;kv_send1_5_3 -->
<g id="edge1149" class="edge">
<title>ring_stage1_5_3&#45;&gt;kv_send1_5_3</title>
<path fill="none" stroke="black" d="M7181.76,-14662.73C7209.72,-14651.32 7242.58,-14637.91 7270.6,-14626.47"/>
<polygon fill="black" stroke="black" points="7271.97,-14629.69 7279.91,-14622.67 7269.32,-14623.21 7271.97,-14629.69"/>
</g>
<!-- ring_stage1_6_3 -->
<g id="node854" class="node">
<title>ring_stage1_6_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6988.5,-14626.1 6777.5,-14626.1 6777.5,-14573.1 6988.5,-14573.1 6988.5,-14626.1"/>
<text text-anchor="middle" x="6883" y="-14610.9" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6883" y="-14595.9" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_13×V_13</text>
<text text-anchor="middle" x="6883" y="-14580.9" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_5_3&#45;&gt;ring_stage1_6_3 -->
<g id="edge1195" class="edge">
<title>ring_stage1_5_3&#45;&gt;ring_stage1_6_3</title>
<path fill="none" stroke="black" d="M7050.1,-14662.73C7022.36,-14652.41 6990.2,-14640.45 6961.55,-14629.8"/>
<polygon fill="black" stroke="black" points="6962.57,-14626.45 6951.98,-14626.24 6960.13,-14633.01 6962.57,-14626.45"/>
</g>
<!-- kv_send1_5_4 -->
<g id="node839" class="node">
<title>kv_send1_5_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7350" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7350" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="7350" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_5_4&#45;&gt;kv_send1_5_4 -->
<g id="edge1152" class="edge">
<title>ring_stage1_5_4&#45;&gt;kv_send1_5_4</title>
<path fill="none" stroke="black" d="M7499.4,-14572.99C7472.09,-14561.63 7440,-14548.28 7412.58,-14536.88"/>
<polygon fill="black" stroke="black" points="7413.67,-14533.54 7403.09,-14532.93 7410.98,-14540.01 7413.67,-14533.54"/>
</g>
<!-- ring_stage1_6_4 -->
<g id="node855" class="node">
<title>ring_stage1_6_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7683.5,-14536.36 7472.5,-14536.36 7472.5,-14483.36 7683.5,-14483.36 7683.5,-14536.36"/>
<text text-anchor="middle" x="7578" y="-14521.16" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="7578" y="-14506.16" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_14×V_14</text>
<text text-anchor="middle" x="7578" y="-14491.16" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_5_4&#45;&gt;ring_stage1_6_4 -->
<g id="edge1198" class="edge">
<title>ring_stage1_5_4&#45;&gt;ring_stage1_6_4</title>
<path fill="none" stroke="black" d="M7566.01,-14572.75C7567.6,-14564.54 7569.39,-14555.31 7571.09,-14546.53"/>
<polygon fill="black" stroke="black" points="7574.56,-14547.01 7573.03,-14536.52 7567.69,-14545.68 7574.56,-14547.01"/>
</g>
<!-- kv_send1_5_5 -->
<g id="node840" class="node">
<title>kv_send1_5_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6901" cy="-14420.12" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6901" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6901" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_5_5&#45;&gt;kv_send1_5_5 -->
<g id="edge1155" class="edge">
<title>ring_stage1_5_5&#45;&gt;kv_send1_5_5</title>
<path fill="none" stroke="black" d="M6901.71,-14483.01C6901.61,-14474.96 6901.51,-14465.93 6901.41,-14457.31"/>
<polygon fill="black" stroke="black" points="6904.91,-14457.05 6901.3,-14447.09 6897.91,-14457.13 6904.91,-14457.05"/>
</g>
<!-- ring_stage1_6_5 -->
<g id="node856" class="node">
<title>ring_stage1_6_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7233.5,-14446.62 7022.5,-14446.62 7022.5,-14393.62 7233.5,-14393.62 7233.5,-14446.62"/>
<text text-anchor="middle" x="7128" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="7128" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_15×V_15</text>
<text text-anchor="middle" x="7128" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_5_5&#45;&gt;ring_stage1_6_5 -->
<g id="edge1201" class="edge">
<title>ring_stage1_5_5&#45;&gt;ring_stage1_6_5</title>
<path fill="none" stroke="black" d="M6967.98,-14483.25C6994.43,-14472.97 7025.07,-14461.08 7052.42,-14450.46"/>
<polygon fill="black" stroke="black" points="7053.89,-14453.65 7061.94,-14446.76 7051.35,-14447.12 7053.89,-14453.65"/>
</g>
<!-- kv_send1_5_6 -->
<g id="node841" class="node">
<title>kv_send1_5_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6694" cy="-14330.38" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6694" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6694" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_5_6&#45;&gt;kv_send1_5_6 -->
<g id="edge1158" class="edge">
<title>ring_stage1_5_6&#45;&gt;kv_send1_5_6</title>
<path fill="none" stroke="black" d="M6672.13,-14393.27C6675.04,-14385.04 6678.31,-14375.79 6681.41,-14367"/>
<polygon fill="black" stroke="black" points="6684.79,-14367.94 6684.82,-14357.35 6678.19,-14365.61 6684.79,-14367.94"/>
</g>
<!-- ring_stage1_6_6 -->
<g id="node857" class="node">
<title>ring_stage1_6_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7032.5,-14356.88 6839.5,-14356.88 6839.5,-14303.88 7032.5,-14303.88 7032.5,-14356.88"/>
<text text-anchor="middle" x="6936" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6936" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_0×V_0</text>
<text text-anchor="middle" x="6936" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_5_6&#45;&gt;ring_stage1_6_6 -->
<g id="edge1204" class="edge">
<title>ring_stage1_5_6&#45;&gt;ring_stage1_6_6</title>
<path fill="none" stroke="black" d="M6742.7,-14393.5C6775.21,-14383.05 6812.96,-14370.92 6846.43,-14360.17"/>
<polygon fill="black" stroke="black" points="6847.75,-14363.42 6856.2,-14357.02 6845.61,-14356.75 6847.75,-14363.42"/>
</g>
<!-- kv_send1_5_7 -->
<g id="node842" class="node">
<title>kv_send1_5_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6477" cy="-14240.64" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6477" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="6477" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_5_7&#45;&gt;kv_send1_5_7 -->
<g id="edge1161" class="edge">
<title>ring_stage1_5_7&#45;&gt;kv_send1_5_7</title>
<path fill="none" stroke="black" d="M6476.29,-14303.53C6476.39,-14295.48 6476.49,-14286.45 6476.59,-14277.83"/>
<polygon fill="black" stroke="black" points="6480.09,-14277.65 6476.7,-14267.61 6473.09,-14277.57 6480.09,-14277.65"/>
</g>
<!-- ring_stage1_6_7 -->
<g id="node858" class="node">
<title>ring_stage1_6_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6791.5,-14267.14 6598.5,-14267.14 6598.5,-14214.14 6791.5,-14214.14 6791.5,-14267.14"/>
<text text-anchor="middle" x="6695" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6695" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_1×V_1</text>
<text text-anchor="middle" x="6695" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_5_7&#45;&gt;ring_stage1_6_7 -->
<g id="edge1207" class="edge">
<title>ring_stage1_5_7&#45;&gt;ring_stage1_6_7</title>
<path fill="none" stroke="black" d="M6539.93,-14303.76C6565.46,-14293.54 6595,-14281.7 6621.41,-14271.12"/>
<polygon fill="black" stroke="black" points="6623.01,-14274.25 6630.99,-14267.28 6620.4,-14267.75 6623.01,-14274.25"/>
</g>
<!-- kv_send1_5_8 -->
<g id="node843" class="node">
<title>kv_send1_5_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6259" cy="-14150.9" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6259" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="6259" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_5_8&#45;&gt;kv_send1_5_8 -->
<g id="edge1164" class="edge">
<title>ring_stage1_5_8&#45;&gt;kv_send1_5_8</title>
<path fill="none" stroke="black" d="M6244.89,-14213.79C6246.75,-14205.65 6248.83,-14196.51 6250.82,-14187.8"/>
<polygon fill="black" stroke="black" points="6254.27,-14188.4 6253.08,-14177.87 6247.45,-14186.84 6254.27,-14188.4"/>
</g>
<!-- ring_stage1_6_8 -->
<g id="node859" class="node">
<title>ring_stage1_6_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6573.5,-14177.4 6380.5,-14177.4 6380.5,-14124.4 6573.5,-14124.4 6573.5,-14177.4"/>
<text text-anchor="middle" x="6477" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6477" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_2×V_2</text>
<text text-anchor="middle" x="6477" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_5_8&#45;&gt;ring_stage1_6_8 -->
<g id="edge1210" class="edge">
<title>ring_stage1_5_8&#45;&gt;ring_stage1_6_8</title>
<path fill="none" stroke="black" d="M6308.48,-14214.02C6336.46,-14203.71 6368.89,-14191.75 6397.78,-14181.1"/>
<polygon fill="black" stroke="black" points="6399.26,-14184.29 6407.43,-14177.54 6396.84,-14177.72 6399.26,-14184.29"/>
</g>
<!-- kv_send1_5_9 -->
<g id="node844" class="node">
<title>kv_send1_5_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6016" cy="-14061.16" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6016" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6016" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_5_9&#45;&gt;kv_send1_5_9 -->
<g id="edge1167" class="edge">
<title>ring_stage1_5_9&#45;&gt;kv_send1_5_9</title>
<path fill="none" stroke="black" d="M6018.12,-14124.05C6017.84,-14116 6017.53,-14106.97 6017.24,-14098.35"/>
<polygon fill="black" stroke="black" points="6020.73,-14098 6016.89,-14088.13 6013.73,-14098.24 6020.73,-14098"/>
</g>
<!-- ring_stage1_6_9 -->
<g id="node860" class="node">
<title>ring_stage1_6_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6357.5,-14087.66 6164.5,-14087.66 6164.5,-14034.66 6357.5,-14034.66 6357.5,-14087.66"/>
<text text-anchor="middle" x="6261" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6261" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_3×V_3</text>
<text text-anchor="middle" x="6261" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_5_9&#45;&gt;ring_stage1_6_9 -->
<g id="edge1213" class="edge">
<title>ring_stage1_5_9&#45;&gt;ring_stage1_6_9</title>
<path fill="none" stroke="black" d="M6089.65,-14124.28C6118.22,-14113.92 6151.36,-14101.91 6180.83,-14091.22"/>
<polygon fill="black" stroke="black" points="6182.06,-14094.5 6190.27,-14087.8 6179.67,-14087.92 6182.06,-14094.5"/>
</g>
<!-- kv_send1_5_10 -->
<g id="node845" class="node">
<title>kv_send1_5_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5777" cy="-13971.42" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5777" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="5777" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_5_10&#45;&gt;kv_send1_5_10 -->
<g id="edge1170" class="edge">
<title>ring_stage1_5_10&#45;&gt;kv_send1_5_10</title>
<path fill="none" stroke="black" d="M5784.05,-14034.31C5783.13,-14026.17 5782.08,-14017.03 5781.09,-14008.32"/>
<polygon fill="black" stroke="black" points="5784.57,-14007.93 5779.96,-13998.39 5777.61,-14008.72 5784.57,-14007.93"/>
</g>
<!-- ring_stage1_6_10 -->
<g id="node861" class="node">
<title>ring_stage1_6_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6127,-13997.92 5925,-13997.92 5925,-13944.92 6127,-13944.92 6127,-13997.92"/>
<text text-anchor="middle" x="6026" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="6026" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_4×V_4</text>
<text text-anchor="middle" x="6026" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_5_10&#45;&gt;ring_stage1_6_10 -->
<g id="edge1216" class="edge">
<title>ring_stage1_5_10&#45;&gt;ring_stage1_6_10</title>
<path fill="none" stroke="black" d="M5856.77,-14034.54C5884.87,-14024.23 5917.44,-14012.27 5946.45,-14001.62"/>
<polygon fill="black" stroke="black" points="5947.96,-14004.8 5956.14,-13998.06 5945.55,-13998.22 5947.96,-14004.8"/>
</g>
<!-- kv_send1_5_11 -->
<g id="node846" class="node">
<title>kv_send1_5_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5538" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5538" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5538" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_5_11&#45;&gt;kv_send1_5_11 -->
<g id="edge1173" class="edge">
<title>ring_stage1_5_11&#45;&gt;kv_send1_5_11</title>
<path fill="none" stroke="black" d="M5545.05,-13944.57C5544.13,-13936.43 5543.08,-13927.29 5542.09,-13918.58"/>
<polygon fill="black" stroke="black" points="5545.57,-13918.19 5540.96,-13908.65 5538.61,-13918.98 5545.57,-13918.19"/>
</g>
<!-- ring_stage1_6_11 -->
<g id="node862" class="node">
<title>ring_stage1_6_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5888,-13908.18 5686,-13908.18 5686,-13855.18 5888,-13855.18 5888,-13908.18"/>
<text text-anchor="middle" x="5787" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="5787" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_5×V_5</text>
<text text-anchor="middle" x="5787" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_5_11&#45;&gt;ring_stage1_6_11 -->
<g id="edge1219" class="edge">
<title>ring_stage1_5_11&#45;&gt;ring_stage1_6_11</title>
<path fill="none" stroke="black" d="M5617.77,-13944.8C5645.87,-13934.49 5678.44,-13922.53 5707.45,-13911.88"/>
<polygon fill="black" stroke="black" points="5708.96,-13915.06 5717.14,-13908.32 5706.55,-13908.48 5708.96,-13915.06"/>
</g>
<!-- kv_send1_5_12 -->
<g id="node847" class="node">
<title>kv_send1_5_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5302" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5302" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="5302" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_5_12&#45;&gt;kv_send1_5_12 -->
<g id="edge1176" class="edge">
<title>ring_stage1_5_12&#45;&gt;kv_send1_5_12</title>
<path fill="none" stroke="black" d="M5306.94,-13854.83C5306.3,-13846.78 5305.57,-13837.75 5304.89,-13829.13"/>
<polygon fill="black" stroke="black" points="5308.36,-13828.6 5304.07,-13818.91 5301.38,-13829.15 5308.36,-13828.6"/>
</g>
<!-- ring_stage1_6_12 -->
<g id="node863" class="node">
<title>ring_stage1_6_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5632,-13818.44 5430,-13818.44 5430,-13765.44 5632,-13765.44 5632,-13818.44"/>
<text text-anchor="middle" x="5531" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="5531" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_6×V_6</text>
<text text-anchor="middle" x="5531" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_5_12&#45;&gt;ring_stage1_6_12 -->
<g id="edge1222" class="edge">
<title>ring_stage1_5_12&#45;&gt;ring_stage1_6_12</title>
<path fill="none" stroke="black" d="M5373.81,-13855.06C5399.8,-13844.79 5429.9,-13832.9 5456.76,-13822.28"/>
<polygon fill="black" stroke="black" points="5458.1,-13825.51 5466.11,-13818.58 5455.52,-13819 5458.1,-13825.51"/>
</g>
<!-- kv_send1_5_13 -->
<g id="node848" class="node">
<title>kv_send1_5_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5062" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5062" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="5062" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_5_13&#45;&gt;kv_send1_5_13 -->
<g id="edge1179" class="edge">
<title>ring_stage1_5_13&#45;&gt;kv_send1_5_13</title>
<path fill="none" stroke="black" d="M5069.76,-13765.09C5068.74,-13756.95 5067.59,-13747.81 5066.5,-13739.1"/>
<polygon fill="black" stroke="black" points="5069.97,-13738.65 5065.26,-13729.17 5063.03,-13739.52 5069.97,-13738.65"/>
</g>
<!-- ring_stage1_6_13 -->
<g id="node864" class="node">
<title>ring_stage1_6_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5392,-13728.7 5190,-13728.7 5190,-13675.7 5392,-13675.7 5392,-13728.7"/>
<text text-anchor="middle" x="5291" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="5291" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_7×V_7</text>
<text text-anchor="middle" x="5291" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_5_13&#45;&gt;ring_stage1_6_13 -->
<g id="edge1225" class="edge">
<title>ring_stage1_5_13&#45;&gt;ring_stage1_6_13</title>
<path fill="none" stroke="black" d="M5136.64,-13765.32C5162.05,-13755.1 5191.46,-13743.26 5217.75,-13732.68"/>
<polygon fill="black" stroke="black" points="5219.31,-13735.82 5227.28,-13728.84 5216.7,-13729.33 5219.31,-13735.82"/>
</g>
<!-- kv_send1_5_14 -->
<g id="node849" class="node">
<title>kv_send1_5_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4831" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4831" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="4831" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_5_14&#45;&gt;kv_send1_5_14 -->
<g id="edge1182" class="edge">
<title>ring_stage1_5_14&#45;&gt;kv_send1_5_14</title>
<path fill="none" stroke="black" d="M4832.41,-13675.35C4832.23,-13667.3 4832.02,-13658.27 4831.82,-13649.65"/>
<polygon fill="black" stroke="black" points="4835.32,-13649.34 4831.59,-13639.43 4828.32,-13649.5 4835.32,-13649.34"/>
</g>
<!-- ring_stage1_6_14 -->
<g id="node865" class="node">
<title>ring_stage1_6_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5163,-13638.96 4961,-13638.96 4961,-13585.96 5163,-13585.96 5163,-13638.96"/>
<text text-anchor="middle" x="5062" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="5062" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_8×V_8</text>
<text text-anchor="middle" x="5062" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_5_14&#45;&gt;ring_stage1_6_14 -->
<g id="edge1228" class="edge">
<title>ring_stage1_5_14&#45;&gt;ring_stage1_6_14</title>
<path fill="none" stroke="black" d="M4899.85,-13675.58C4926.66,-13665.31 4957.71,-13653.42 4985.42,-13642.8"/>
<polygon fill="black" stroke="black" points="4986.98,-13645.95 4995.07,-13639.1 4984.47,-13639.41 4986.98,-13645.95"/>
</g>
<!-- kv_send1_5_15 -->
<g id="node850" class="node">
<title>kv_send1_5_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4590" cy="-13522.72" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4590" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="4590" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_5_15&#45;&gt;kv_send1_5_15 -->
<g id="edge1185" class="edge">
<title>ring_stage1_5_15&#45;&gt;kv_send1_5_15</title>
<path fill="none" stroke="black" d="M4592.12,-13585.61C4591.84,-13577.56 4591.53,-13568.53 4591.24,-13559.91"/>
<polygon fill="black" stroke="black" points="4594.73,-13559.56 4590.89,-13549.69 4587.73,-13559.8 4594.73,-13559.56"/>
</g>
<!-- ring_stage1_6_15 -->
<g id="node866" class="node">
<title>ring_stage1_6_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4915,-13549.22 4713,-13549.22 4713,-13496.22 4915,-13496.22 4915,-13549.22"/>
<text text-anchor="middle" x="4814" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="4814" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_9×V_9</text>
<text text-anchor="middle" x="4814" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_5_15&#45;&gt;ring_stage1_6_15 -->
<g id="edge1231" class="edge">
<title>ring_stage1_5_15&#45;&gt;ring_stage1_6_15</title>
<path fill="none" stroke="black" d="M4657.52,-13585.84C4683.39,-13575.57 4713.35,-13563.68 4740.09,-13553.06"/>
<polygon fill="black" stroke="black" points="4741.4,-13556.31 4749.4,-13549.36 4738.82,-13549.8 4741.4,-13556.31"/>
</g>
<!-- kv_send1_5_0&#45;&gt;ring_stage1_6_1 -->
<g id="edge1190" class="edge">
<title>kv_send1_5_0&#45;&gt;ring_stage1_6_1</title>
<path fill="none" stroke="black" d="M4302.8,-13410.06C4275.5,-13399.03 4242.02,-13385.49 4212.54,-13373.57"/>
<polygon fill="black" stroke="black" points="4213.7,-13370.26 4203.12,-13369.76 4211.08,-13376.75 4213.7,-13370.26"/>
</g>
<!-- kv_send1_5_1&#45;&gt;ring_stage1_6_2 -->
<g id="edge1193" class="edge">
<title>kv_send1_5_1&#45;&gt;ring_stage1_6_2</title>
<path fill="none" stroke="black" d="M4879,-13323.97C4892.23,-13321.08 4905.98,-13318.38 4919,-13316.37 5116.4,-13285.81 5169.46,-13310 5367,-13280.37 5367.35,-13280.32 5367.69,-13280.26 5368.04,-13280.21"/>
<polygon fill="black" stroke="black" points="5368.94,-13283.61 5378.26,-13278.56 5367.83,-13276.7 5368.94,-13283.61"/>
</g>
<!-- kv_send1_5_2&#45;&gt;ring_stage1_6_3 -->
<g id="edge1196" class="edge">
<title>kv_send1_5_2&#45;&gt;ring_stage1_6_3</title>
<path fill="none" stroke="black" d="M6720.2,-14666.42C6747.5,-14655.39 6780.98,-14641.85 6810.46,-14629.93"/>
<polygon fill="black" stroke="black" points="6811.92,-14633.11 6819.88,-14626.12 6809.3,-14626.62 6811.92,-14633.11"/>
</g>
<!-- kv_send1_5_3&#45;&gt;ring_stage1_6_4 -->
<g id="edge1199" class="edge">
<title>kv_send1_5_3&#45;&gt;ring_stage1_6_4</title>
<path fill="none" stroke="black" d="M7392.75,-14577.47C7424.08,-14566.21 7463.09,-14552.18 7497.22,-14539.91"/>
<polygon fill="black" stroke="black" points="7498.48,-14543.17 7506.7,-14536.5 7496.11,-14536.59 7498.48,-14543.17"/>
</g>
<!-- kv_send1_5_4&#45;&gt;ring_stage1_6_5 -->
<g id="edge1202" class="edge">
<title>kv_send1_5_4&#45;&gt;ring_stage1_6_5</title>
<path fill="none" stroke="black" d="M7294.84,-14487.06C7266.91,-14476.02 7232.61,-14462.46 7202.39,-14450.52"/>
<polygon fill="black" stroke="black" points="7203.32,-14447.12 7192.73,-14446.7 7200.75,-14453.63 7203.32,-14447.12"/>
</g>
<!-- kv_send1_5_5&#45;&gt;ring_stage1_6_6 -->
<g id="edge1205" class="edge">
<title>kv_send1_5_5&#45;&gt;ring_stage1_6_6</title>
<path fill="none" stroke="black" d="M6911.31,-14393.27C6914.66,-14384.88 6918.43,-14375.43 6922,-14366.48"/>
<polygon fill="black" stroke="black" points="6925.31,-14367.63 6925.76,-14357.04 6918.81,-14365.04 6925.31,-14367.63"/>
</g>
<!-- kv_send1_5_6&#45;&gt;ring_stage1_6_7 -->
<g id="edge1208" class="edge">
<title>kv_send1_5_6&#45;&gt;ring_stage1_6_7</title>
<path fill="none" stroke="black" d="M6694.3,-14303.05C6694.39,-14295.02 6694.49,-14286.04 6694.59,-14277.48"/>
<polygon fill="black" stroke="black" points="6698.09,-14277.38 6694.71,-14267.34 6691.09,-14277.3 6698.09,-14277.38"/>
</g>
<!-- kv_send1_5_7&#45;&gt;ring_stage1_6_8 -->
<g id="edge1211" class="edge">
<title>kv_send1_5_7&#45;&gt;ring_stage1_6_8</title>
<path fill="none" stroke="black" d="M6477,-14213.31C6477,-14205.28 6477,-14196.3 6477,-14187.74"/>
<polygon fill="black" stroke="black" points="6480.5,-14187.6 6477,-14177.6 6473.5,-14187.6 6480.5,-14187.6"/>
</g>
<!-- kv_send1_5_8&#45;&gt;ring_stage1_6_9 -->
<g id="edge1214" class="edge">
<title>kv_send1_5_8&#45;&gt;ring_stage1_6_9</title>
<path fill="none" stroke="black" d="M6259.6,-14123.57C6259.78,-14115.54 6259.99,-14106.56 6260.18,-14098"/>
<polygon fill="black" stroke="black" points="6263.69,-14097.94 6260.41,-14087.86 6256.69,-14097.78 6263.69,-14097.94"/>
</g>
<!-- kv_send1_5_9&#45;&gt;ring_stage1_6_10 -->
<g id="edge1217" class="edge">
<title>kv_send1_5_9&#45;&gt;ring_stage1_6_10</title>
<path fill="none" stroke="black" d="M6019,-14033.83C6019.92,-14025.79 6020.94,-14016.82 6021.92,-14008.26"/>
<polygon fill="black" stroke="black" points="6025.42,-14008.45 6023.07,-13998.12 6018.46,-14007.66 6025.42,-14008.45"/>
</g>
<!-- kv_send1_5_10&#45;&gt;ring_stage1_6_11 -->
<g id="edge1220" class="edge">
<title>kv_send1_5_10&#45;&gt;ring_stage1_6_11</title>
<path fill="none" stroke="black" d="M5780,-13944.09C5780.92,-13936.05 5781.94,-13927.08 5782.92,-13918.52"/>
<polygon fill="black" stroke="black" points="5786.42,-13918.71 5784.07,-13908.38 5779.46,-13917.92 5786.42,-13918.71"/>
</g>
<!-- kv_send1_5_11&#45;&gt;ring_stage1_6_12 -->
<g id="edge1223" class="edge">
<title>kv_send1_5_11&#45;&gt;ring_stage1_6_12</title>
<path fill="none" stroke="black" d="M5535.9,-13854.35C5535.26,-13846.31 5534.54,-13837.34 5533.86,-13828.78"/>
<polygon fill="black" stroke="black" points="5537.33,-13828.33 5533.05,-13818.64 5530.36,-13828.89 5537.33,-13828.33"/>
</g>
<!-- kv_send1_5_12&#45;&gt;ring_stage1_6_13 -->
<g id="edge1226" class="edge">
<title>kv_send1_5_12&#45;&gt;ring_stage1_6_13</title>
<path fill="none" stroke="black" d="M5298.7,-13764.61C5297.69,-13756.57 5296.57,-13747.6 5295.49,-13739.04"/>
<polygon fill="black" stroke="black" points="5298.94,-13738.39 5294.22,-13728.9 5291.99,-13739.26 5298.94,-13738.39"/>
</g>
<!-- kv_send1_5_13&#45;&gt;ring_stage1_6_14 -->
<g id="edge1229" class="edge">
<title>kv_send1_5_13&#45;&gt;ring_stage1_6_14</title>
<path fill="none" stroke="black" d="M5062,-13674.87C5062,-13666.83 5062,-13657.85 5062,-13649.3"/>
<polygon fill="black" stroke="black" points="5065.5,-13649.16 5062,-13639.16 5058.5,-13649.16 5065.5,-13649.16"/>
</g>
<!-- kv_send1_5_14&#45;&gt;ring_stage1_6_15 -->
<g id="edge1232" class="edge">
<title>kv_send1_5_14&#45;&gt;ring_stage1_6_15</title>
<path fill="none" stroke="black" d="M4825.99,-13585.61C4824.4,-13577.4 4822.61,-13568.17 4820.91,-13559.39"/>
<polygon fill="black" stroke="black" points="4824.31,-13558.53 4818.97,-13549.38 4817.44,-13559.87 4824.31,-13558.53"/>
</g>
<!-- kv_send1_5_15&#45;&gt;ring_stage1_6_0 -->
<g id="edge1187" class="edge">
<title>kv_send1_5_15&#45;&gt;ring_stage1_6_0</title>
<path fill="none" stroke="black" d="M4588.2,-13495.39C4587.65,-13487.35 4587.04,-13478.37 4586.45,-13469.82"/>
<polygon fill="black" stroke="black" points="4589.93,-13469.42 4585.76,-13459.68 4582.95,-13469.9 4589.93,-13469.42"/>
</g>
<!-- kv_send1_6_0 -->
<g id="node867" class="node">
<title>kv_send1_6_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4370" cy="-13343.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4370" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4370" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_6_0&#45;&gt;kv_send1_6_0 -->
<g id="edge1188" class="edge">
<title>ring_stage1_6_0&#45;&gt;kv_send1_6_0</title>
<path fill="none" stroke="black" d="M4521.53,-13406.36C4493.71,-13394.96 4461,-13381.55 4433.1,-13370.11"/>
<polygon fill="black" stroke="black" points="4434.42,-13366.87 4423.84,-13366.31 4431.77,-13373.34 4434.42,-13366.87"/>
</g>
<!-- ring_stage1_7_0 -->
<g id="node883" class="node">
<title>ring_stage1_7_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4685.5,-13369.74 4492.5,-13369.74 4492.5,-13316.74 4685.5,-13316.74 4685.5,-13369.74"/>
<text text-anchor="middle" x="4589" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="4589" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_9×V_9</text>
<text text-anchor="middle" x="4589" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_6_0&#45;&gt;ring_stage1_7_0 -->
<g id="edge1234" class="edge">
<title>ring_stage1_6_0&#45;&gt;ring_stage1_7_0</title>
<path fill="none" stroke="black" d="M4585.47,-13406.13C4585.94,-13397.92 4586.47,-13388.69 4586.97,-13379.91"/>
<polygon fill="black" stroke="black" points="4590.46,-13380.09 4587.54,-13369.9 4583.47,-13379.69 4590.46,-13380.09"/>
</g>
<!-- kv_send1_6_1 -->
<g id="node868" class="node">
<title>kv_send1_6_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4367" cy="-13253.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4367" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4367" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_6_1&#45;&gt;kv_send1_6_1 -->
<g id="edge1191" class="edge">
<title>ring_stage1_6_1&#45;&gt;kv_send1_6_1</title>
<path fill="none" stroke="black" d="M4206.27,-13316.62C4236.26,-13305.03 4271.61,-13291.37 4301.51,-13279.81"/>
<polygon fill="black" stroke="black" points="4302.95,-13283.01 4311.01,-13276.14 4300.42,-13276.48 4302.95,-13283.01"/>
</g>
<!-- ring_stage1_7_1 -->
<g id="node884" class="node">
<title>ring_stage1_7_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4245.5,-13280 4034.5,-13280 4034.5,-13227 4245.5,-13227 4245.5,-13280"/>
<text text-anchor="middle" x="4140" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="4140" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_10×V_10</text>
<text text-anchor="middle" x="4140" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_6_1&#45;&gt;ring_stage1_7_1 -->
<g id="edge1237" class="edge">
<title>ring_stage1_6_1&#45;&gt;ring_stage1_7_1</title>
<path fill="none" stroke="black" d="M4140,-13316.39C4140,-13308.18 4140,-13298.95 4140,-13290.17"/>
<polygon fill="black" stroke="black" points="4143.5,-13290.16 4140,-13280.16 4136.5,-13290.16 4143.5,-13290.16"/>
</g>
<!-- kv_send1_6_2 -->
<g id="node869" class="node">
<title>kv_send1_6_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5708" cy="-13163.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5708" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="5708" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_6_2&#45;&gt;kv_send1_6_2 -->
<g id="edge1194" class="edge">
<title>ring_stage1_6_2&#45;&gt;kv_send1_6_2</title>
<path fill="none" stroke="black" d="M5549.39,-13226.88C5578.87,-13215.34 5613.6,-13201.73 5643.03,-13190.21"/>
<polygon fill="black" stroke="black" points="5644.35,-13193.45 5652.38,-13186.54 5641.8,-13186.93 5644.35,-13193.45"/>
</g>
<!-- ring_stage1_7_2 -->
<g id="node885" class="node">
<title>ring_stage1_7_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5364.5,-13190.26 5153.5,-13190.26 5153.5,-13137.26 5364.5,-13137.26 5364.5,-13190.26"/>
<text text-anchor="middle" x="5259" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5259" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_11×V_11</text>
<text text-anchor="middle" x="5259" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_6_2&#45;&gt;ring_stage1_7_2 -->
<g id="edge1240" class="edge">
<title>ring_stage1_6_2&#45;&gt;ring_stage1_7_2</title>
<path fill="none" stroke="black" d="M5418.32,-13226.88C5391.98,-13216.61 5361.47,-13204.72 5334.25,-13194.1"/>
<polygon fill="black" stroke="black" points="5335.35,-13190.78 5324.77,-13190.4 5332.81,-13197.3 5335.35,-13190.78"/>
</g>
<!-- kv_send1_6_3 -->
<g id="node870" class="node">
<title>kv_send1_6_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7124" cy="-14509.86" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7124" y="-14513.66" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="7124" y="-14498.66" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_6_3&#45;&gt;kv_send1_6_3 -->
<g id="edge1197" class="edge">
<title>ring_stage1_6_3&#45;&gt;kv_send1_6_3</title>
<path fill="none" stroke="black" d="M6953.36,-14572.99C6985.71,-14561.2 7023.94,-14547.29 7056.01,-14535.61"/>
<polygon fill="black" stroke="black" points="7057.55,-14538.78 7065.75,-14532.07 7055.15,-14532.2 7057.55,-14538.78"/>
</g>
<!-- ring_stage1_7_3 -->
<g id="node886" class="node">
<title>ring_stage1_7_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6030.5,-13100.52 5819.5,-13100.52 5819.5,-13047.52 6030.5,-13047.52 6030.5,-13100.52"/>
<text text-anchor="middle" x="5925" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5925" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_12×V_12</text>
<text text-anchor="middle" x="5925" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_6_3&#45;&gt;ring_stage1_7_3 -->
<g id="edge1243" class="edge">
<title>ring_stage1_6_3&#45;&gt;ring_stage1_7_3</title>
<path fill="none" stroke="black" d="M6832.65,-14573.06C6818.84,-14563.56 6805.38,-14551.43 6797,-14536.73 6777.17,-14501.94 6790.78,-14486.99 6789,-14446.99 6787.94,-14423.13 6783.77,-14416.55 6789,-14393.25 6792.87,-14375.98 6801.31,-14374.31 6806,-14357.25 6819.67,-14307.48 6817,-14293.25 6817,-14241.64 6817,-14241.64 6817,-14241.64 6817,-14149.9 6817,-14098.28 6840.83,-14072.38 6806,-14034.29 6747.12,-13969.89 6671.83,-14062.74 6613,-13998.29 6594.1,-13977.58 6585.19,-13516.28 6566,-13495.85 6495.47,-13420.75 6411.37,-13531.15 6337,-13459.85 6310.68,-13434.61 6305.27,-13162.17 6279,-13136.89 6242.12,-13101.39 6106.76,-13109.83 6040.54,-13100.85"/>
<polygon fill="black" stroke="black" points="6040.96,-13097.38 6030.53,-13099.25 6039.85,-13104.29 6040.96,-13097.38"/>
</g>
<!-- kv_send1_6_4 -->
<g id="node871" class="node">
<title>kv_send1_6_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7579" cy="-14420.12" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7579" y="-14423.92" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="7579" y="-14408.92" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_6_4&#45;&gt;kv_send1_6_4 -->
<g id="edge1200" class="edge">
<title>ring_stage1_6_4&#45;&gt;kv_send1_6_4</title>
<path fill="none" stroke="black" d="M7578.29,-14483.01C7578.39,-14474.96 7578.49,-14465.93 7578.59,-14457.31"/>
<polygon fill="black" stroke="black" points="7582.09,-14457.13 7578.7,-14447.09 7575.09,-14457.05 7582.09,-14457.13"/>
</g>
<!-- ring_stage1_7_4 -->
<g id="node887" class="node">
<title>ring_stage1_7_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7911.5,-14446.62 7700.5,-14446.62 7700.5,-14393.62 7911.5,-14393.62 7911.5,-14446.62"/>
<text text-anchor="middle" x="7806" y="-14431.42" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="7806" y="-14416.42" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_13×V_13</text>
<text text-anchor="middle" x="7806" y="-14401.42" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_6_4&#45;&gt;ring_stage1_7_4 -->
<g id="edge1246" class="edge">
<title>ring_stage1_6_4&#45;&gt;ring_stage1_7_4</title>
<path fill="none" stroke="black" d="M7644.56,-14483.25C7671.25,-14472.97 7702.16,-14461.08 7729.75,-14450.46"/>
<polygon fill="black" stroke="black" points="7731.28,-14453.62 7739.36,-14446.76 7728.77,-14447.09 7731.28,-14453.62"/>
</g>
<!-- kv_send1_6_5 -->
<g id="node872" class="node">
<title>kv_send1_6_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7160" cy="-14330.38" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7160" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="7160" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_6_5&#45;&gt;kv_send1_6_5 -->
<g id="edge1203" class="edge">
<title>ring_stage1_6_5&#45;&gt;kv_send1_6_5</title>
<path fill="none" stroke="black" d="M7137.43,-14393.27C7140.43,-14385.04 7143.8,-14375.79 7147.01,-14367"/>
<polygon fill="black" stroke="black" points="7150.39,-14367.94 7150.53,-14357.35 7143.81,-14365.54 7150.39,-14367.94"/>
</g>
<!-- ring_stage1_7_5 -->
<g id="node888" class="node">
<title>ring_stage1_7_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7559.5,-14356.88 7348.5,-14356.88 7348.5,-14303.88 7559.5,-14303.88 7559.5,-14356.88"/>
<text text-anchor="middle" x="7454" y="-14341.68" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="7454" y="-14326.68" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_14×V_14</text>
<text text-anchor="middle" x="7454" y="-14311.68" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_6_5&#45;&gt;ring_stage1_7_5 -->
<g id="edge1249" class="edge">
<title>ring_stage1_6_5&#45;&gt;ring_stage1_7_5</title>
<path fill="none" stroke="black" d="M7223.17,-14393.5C7262.67,-14382.87 7308.63,-14370.5 7349.1,-14359.61"/>
<polygon fill="black" stroke="black" points="7350.25,-14362.93 7358.99,-14356.95 7348.43,-14356.17 7350.25,-14362.93"/>
</g>
<!-- kv_send1_6_6 -->
<g id="node873" class="node">
<title>kv_send1_6_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6939" cy="-14240.64" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6939" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6939" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_6_6&#45;&gt;kv_send1_6_6 -->
<g id="edge1206" class="edge">
<title>ring_stage1_6_6&#45;&gt;kv_send1_6_6</title>
<path fill="none" stroke="black" d="M6936.88,-14303.53C6937.16,-14295.48 6937.47,-14286.45 6937.76,-14277.83"/>
<polygon fill="black" stroke="black" points="6941.27,-14277.72 6938.11,-14267.61 6934.27,-14277.48 6941.27,-14277.72"/>
</g>
<!-- ring_stage1_7_6 -->
<g id="node889" class="node">
<title>ring_stage1_7_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7271.5,-14267.14 7060.5,-14267.14 7060.5,-14214.14 7271.5,-14214.14 7271.5,-14267.14"/>
<text text-anchor="middle" x="7166" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="7166" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_15×V_15</text>
<text text-anchor="middle" x="7166" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_6_6&#45;&gt;ring_stage1_7_6 -->
<g id="edge1252" class="edge">
<title>ring_stage1_6_6&#45;&gt;ring_stage1_7_6</title>
<path fill="none" stroke="black" d="M7003.14,-14303.76C7030.07,-14293.49 7061.25,-14281.6 7089.08,-14270.98"/>
<polygon fill="black" stroke="black" points="7090.68,-14274.12 7098.77,-14267.28 7088.18,-14267.58 7090.68,-14274.12"/>
</g>
<!-- kv_send1_6_7 -->
<g id="node874" class="node">
<title>kv_send1_6_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6695" cy="-14150.9" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6695" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="6695" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_6_7&#45;&gt;kv_send1_6_7 -->
<g id="edge1209" class="edge">
<title>ring_stage1_6_7&#45;&gt;kv_send1_6_7</title>
<path fill="none" stroke="black" d="M6695,-14213.79C6695,-14205.74 6695,-14196.71 6695,-14188.09"/>
<polygon fill="black" stroke="black" points="6698.5,-14187.87 6695,-14177.87 6691.5,-14187.87 6698.5,-14187.87"/>
</g>
<!-- ring_stage1_7_7 -->
<g id="node890" class="node">
<title>ring_stage1_7_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7035.5,-14177.4 6842.5,-14177.4 6842.5,-14124.4 7035.5,-14124.4 7035.5,-14177.4"/>
<text text-anchor="middle" x="6939" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="6939" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_0×V_0</text>
<text text-anchor="middle" x="6939" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_6_7&#45;&gt;ring_stage1_7_7 -->
<g id="edge1255" class="edge">
<title>ring_stage1_6_7&#45;&gt;ring_stage1_7_7</title>
<path fill="none" stroke="black" d="M6766.23,-14214.02C6795.04,-14203.66 6828.45,-14191.65 6858.17,-14180.96"/>
<polygon fill="black" stroke="black" points="6859.45,-14184.22 6867.68,-14177.54 6857.09,-14177.63 6859.45,-14184.22"/>
</g>
<!-- kv_send1_6_8 -->
<g id="node875" class="node">
<title>kv_send1_6_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6479" cy="-14061.16" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6479" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="6479" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_6_8&#45;&gt;kv_send1_6_8 -->
<g id="edge1212" class="edge">
<title>ring_stage1_6_8&#45;&gt;kv_send1_6_8</title>
<path fill="none" stroke="black" d="M6477.59,-14124.05C6477.77,-14116 6477.98,-14106.97 6478.18,-14098.35"/>
<polygon fill="black" stroke="black" points="6481.68,-14098.2 6478.41,-14088.13 6474.68,-14098.04 6481.68,-14098.2"/>
</g>
<!-- ring_stage1_7_8 -->
<g id="node891" class="node">
<title>ring_stage1_7_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6796.5,-14087.66 6603.5,-14087.66 6603.5,-14034.66 6796.5,-14034.66 6796.5,-14087.66"/>
<text text-anchor="middle" x="6700" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="6700" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_1×V_1</text>
<text text-anchor="middle" x="6700" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_6_8&#45;&gt;ring_stage1_7_8 -->
<g id="edge1258" class="edge">
<title>ring_stage1_6_8&#45;&gt;ring_stage1_7_8</title>
<path fill="none" stroke="black" d="M6542.1,-14124.28C6568.21,-14114.01 6598.44,-14102.12 6625.42,-14091.5"/>
<polygon fill="black" stroke="black" points="6626.79,-14094.72 6634.82,-14087.8 6624.23,-14088.21 6626.79,-14094.72"/>
</g>
<!-- kv_send1_6_9 -->
<g id="node876" class="node">
<title>kv_send1_6_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6255" cy="-13971.42" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6255" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6255" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_6_9&#45;&gt;kv_send1_6_9 -->
<g id="edge1215" class="edge">
<title>ring_stage1_6_9&#45;&gt;kv_send1_6_9</title>
<path fill="none" stroke="black" d="M6259.23,-14034.31C6258.68,-14026.26 6258.06,-14017.23 6257.47,-14008.61"/>
<polygon fill="black" stroke="black" points="6260.95,-14008.12 6256.78,-13998.39 6253.97,-14008.6 6260.95,-14008.12"/>
</g>
<!-- ring_stage1_7_9 -->
<g id="node892" class="node">
<title>ring_stage1_7_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6575.5,-13997.92 6382.5,-13997.92 6382.5,-13944.92 6575.5,-13944.92 6575.5,-13997.92"/>
<text text-anchor="middle" x="6479" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="6479" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_2×V_2</text>
<text text-anchor="middle" x="6479" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_6_9&#45;&gt;ring_stage1_7_9 -->
<g id="edge1261" class="edge">
<title>ring_stage1_6_9&#45;&gt;ring_stage1_7_9</title>
<path fill="none" stroke="black" d="M6324.64,-14034.54C6350.05,-14024.32 6379.46,-14012.48 6405.75,-14001.9"/>
<polygon fill="black" stroke="black" points="6407.31,-14005.04 6415.28,-13998.06 6404.7,-13998.55 6407.31,-14005.04"/>
</g>
<!-- kv_send1_6_10 -->
<g id="node877" class="node">
<title>kv_send1_6_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6016" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6016" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6016" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_6_10&#45;&gt;kv_send1_6_10 -->
<g id="edge1218" class="edge">
<title>ring_stage1_6_10&#45;&gt;kv_send1_6_10</title>
<path fill="none" stroke="black" d="M6023.05,-13944.57C6022.13,-13936.43 6021.08,-13927.29 6020.09,-13918.58"/>
<polygon fill="black" stroke="black" points="6023.57,-13918.19 6018.96,-13908.65 6016.61,-13918.98 6023.57,-13918.19"/>
</g>
<!-- ring_stage1_7_10 -->
<g id="node893" class="node">
<title>ring_stage1_7_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6346,-13908.18 6144,-13908.18 6144,-13855.18 6346,-13855.18 6346,-13908.18"/>
<text text-anchor="middle" x="6245" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="6245" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_3×V_3</text>
<text text-anchor="middle" x="6245" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_6_10&#45;&gt;ring_stage1_7_10 -->
<g id="edge1264" class="edge">
<title>ring_stage1_6_10&#45;&gt;ring_stage1_7_10</title>
<path fill="none" stroke="black" d="M6089.93,-13944.8C6115.46,-13934.58 6145,-13922.74 6171.41,-13912.16"/>
<polygon fill="black" stroke="black" points="6173.01,-13915.29 6180.99,-13908.32 6170.4,-13908.79 6173.01,-13915.29"/>
</g>
<!-- kv_send1_6_11 -->
<g id="node878" class="node">
<title>kv_send1_6_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5780" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5780" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5780" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_6_11&#45;&gt;kv_send1_6_11 -->
<g id="edge1221" class="edge">
<title>ring_stage1_6_11&#45;&gt;kv_send1_6_11</title>
<path fill="none" stroke="black" d="M5784.94,-13854.83C5784.3,-13846.78 5783.57,-13837.75 5782.89,-13829.13"/>
<polygon fill="black" stroke="black" points="5786.36,-13828.6 5782.07,-13818.91 5779.38,-13829.15 5786.36,-13828.6"/>
</g>
<!-- ring_stage1_7_11 -->
<g id="node894" class="node">
<title>ring_stage1_7_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6110,-13818.44 5908,-13818.44 5908,-13765.44 6110,-13765.44 6110,-13818.44"/>
<text text-anchor="middle" x="6009" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="6009" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_4×V_4</text>
<text text-anchor="middle" x="6009" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_6_11&#45;&gt;ring_stage1_7_11 -->
<g id="edge1267" class="edge">
<title>ring_stage1_6_11&#45;&gt;ring_stage1_7_11</title>
<path fill="none" stroke="black" d="M5851.81,-13855.06C5877.8,-13844.79 5907.9,-13832.9 5934.76,-13822.28"/>
<polygon fill="black" stroke="black" points="5936.1,-13825.51 5944.11,-13818.58 5933.52,-13819 5936.1,-13825.51"/>
</g>
<!-- kv_send1_6_12 -->
<g id="node879" class="node">
<title>kv_send1_6_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5520" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5520" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="5520" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_6_12&#45;&gt;kv_send1_6_12 -->
<g id="edge1224" class="edge">
<title>ring_stage1_6_12&#45;&gt;kv_send1_6_12</title>
<path fill="none" stroke="black" d="M5527.76,-13765.09C5526.74,-13756.95 5525.59,-13747.81 5524.5,-13739.1"/>
<polygon fill="black" stroke="black" points="5527.97,-13738.65 5523.26,-13729.17 5521.03,-13739.52 5527.97,-13738.65"/>
</g>
<!-- ring_stage1_7_12 -->
<g id="node895" class="node">
<title>ring_stage1_7_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5870,-13728.7 5668,-13728.7 5668,-13675.7 5870,-13675.7 5870,-13728.7"/>
<text text-anchor="middle" x="5769" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5769" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_5×V_5</text>
<text text-anchor="middle" x="5769" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_6_12&#45;&gt;ring_stage1_7_12 -->
<g id="edge1270" class="edge">
<title>ring_stage1_6_12&#45;&gt;ring_stage1_7_12</title>
<path fill="none" stroke="black" d="M5600.48,-13765.32C5628.46,-13755.01 5660.89,-13743.05 5689.78,-13732.4"/>
<polygon fill="black" stroke="black" points="5691.26,-13735.59 5699.43,-13728.84 5688.84,-13729.02 5691.26,-13735.59"/>
</g>
<!-- kv_send1_6_13 -->
<g id="node880" class="node">
<title>kv_send1_6_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5291" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5291" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="5291" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_6_13&#45;&gt;kv_send1_6_13 -->
<g id="edge1227" class="edge">
<title>ring_stage1_6_13&#45;&gt;kv_send1_6_13</title>
<path fill="none" stroke="black" d="M5291,-13675.35C5291,-13667.3 5291,-13658.27 5291,-13649.65"/>
<polygon fill="black" stroke="black" points="5294.5,-13649.43 5291,-13639.43 5287.5,-13649.43 5294.5,-13649.43"/>
</g>
<!-- ring_stage1_7_13 -->
<g id="node896" class="node">
<title>ring_stage1_7_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5621,-13638.96 5419,-13638.96 5419,-13585.96 5621,-13585.96 5621,-13638.96"/>
<text text-anchor="middle" x="5520" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5520" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_6×V_6</text>
<text text-anchor="middle" x="5520" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_6_13&#45;&gt;ring_stage1_7_13 -->
<g id="edge1273" class="edge">
<title>ring_stage1_6_13&#45;&gt;ring_stage1_7_13</title>
<path fill="none" stroke="black" d="M5357.85,-13675.58C5384.66,-13665.31 5415.71,-13653.42 5443.42,-13642.8"/>
<polygon fill="black" stroke="black" points="5444.98,-13645.95 5453.07,-13639.1 5442.47,-13639.41 5444.98,-13645.95"/>
</g>
<!-- kv_send1_6_14 -->
<g id="node881" class="node">
<title>kv_send1_6_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5044" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5044" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="5044" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_6_14&#45;&gt;kv_send1_6_14 -->
<g id="edge1230" class="edge">
<title>ring_stage1_6_14&#45;&gt;kv_send1_6_14</title>
<path fill="none" stroke="black" d="M5056.7,-13585.61C5055.03,-13577.47 5053.15,-13568.33 5051.37,-13559.62"/>
<polygon fill="black" stroke="black" points="5054.77,-13558.78 5049.33,-13549.69 5047.91,-13560.19 5054.77,-13558.78"/>
</g>
<!-- ring_stage1_7_14 -->
<g id="node897" class="node">
<title>ring_stage1_7_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5374,-13549.22 5172,-13549.22 5172,-13496.22 5374,-13496.22 5374,-13549.22"/>
<text text-anchor="middle" x="5273" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5273" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_7×V_7</text>
<text text-anchor="middle" x="5273" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_6_14&#45;&gt;ring_stage1_7_14 -->
<g id="edge1276" class="edge">
<title>ring_stage1_6_14&#45;&gt;ring_stage1_7_14</title>
<path fill="none" stroke="black" d="M5123.6,-13585.84C5148.08,-13575.66 5176.41,-13563.88 5201.77,-13553.34"/>
<polygon fill="black" stroke="black" points="5203.44,-13556.43 5211.33,-13549.36 5200.75,-13549.97 5203.44,-13556.43"/>
</g>
<!-- kv_send1_6_15 -->
<g id="node882" class="node">
<title>kv_send1_6_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4811" cy="-13432.98" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4811" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="4811" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_6_15&#45;&gt;kv_send1_6_15 -->
<g id="edge1233" class="edge">
<title>ring_stage1_6_15&#45;&gt;kv_send1_6_15</title>
<path fill="none" stroke="black" d="M4813.12,-13495.87C4812.84,-13487.82 4812.53,-13478.79 4812.24,-13470.17"/>
<polygon fill="black" stroke="black" points="4815.73,-13469.82 4811.89,-13459.95 4808.73,-13470.06 4815.73,-13469.82"/>
</g>
<!-- ring_stage1_7_15 -->
<g id="node898" class="node">
<title>ring_stage1_7_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5134,-13459.48 4932,-13459.48 4932,-13406.48 5134,-13406.48 5134,-13459.48"/>
<text text-anchor="middle" x="5033" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="5033" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_8×V_8</text>
<text text-anchor="middle" x="5033" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_6_15&#45;&gt;ring_stage1_7_15 -->
<g id="edge1279" class="edge">
<title>ring_stage1_6_15&#45;&gt;ring_stage1_7_15</title>
<path fill="none" stroke="black" d="M4877.93,-13496.1C4903.46,-13485.88 4933,-13474.04 4959.41,-13463.46"/>
<polygon fill="black" stroke="black" points="4961.01,-13466.59 4968.99,-13459.62 4958.4,-13460.09 4961.01,-13466.59"/>
</g>
<!-- kv_send1_6_0&#45;&gt;ring_stage1_7_1 -->
<g id="edge1238" class="edge">
<title>kv_send1_6_0&#45;&gt;ring_stage1_7_1</title>
<path fill="none" stroke="black" d="M4313.44,-13320.66C4284.27,-13309.53 4248.27,-13295.8 4216.64,-13283.73"/>
<polygon fill="black" stroke="black" points="4217.56,-13280.34 4206.97,-13280.05 4215.07,-13286.88 4217.56,-13280.34"/>
</g>
<!-- kv_send1_6_1&#45;&gt;ring_stage1_7_2 -->
<g id="edge1241" class="edge">
<title>kv_send1_6_1&#45;&gt;ring_stage1_7_2</title>
<path fill="none" stroke="black" d="M4438.65,-13234.01C4451.99,-13231.13 4465.86,-13228.49 4479,-13226.63 4771.19,-13185.27 4849.62,-13230.62 5142,-13190.63 5142.35,-13190.58 5142.7,-13190.53 5143.04,-13190.48"/>
<polygon fill="black" stroke="black" points="5143.91,-13193.89 5153.27,-13188.95 5142.86,-13186.97 5143.91,-13193.89"/>
</g>
<!-- kv_send1_6_2&#45;&gt;ring_stage1_7_3 -->
<g id="edge1244" class="edge">
<title>kv_send1_6_2&#45;&gt;ring_stage1_7_3</title>
<path fill="none" stroke="black" d="M5762.2,-13140.84C5789.5,-13129.8 5822.98,-13116.27 5852.46,-13104.35"/>
<polygon fill="black" stroke="black" points="5853.92,-13107.53 5861.88,-13100.54 5851.3,-13101.04 5853.92,-13107.53"/>
</g>
<!-- kv_send1_6_3&#45;&gt;ring_stage1_7_4 -->
<g id="edge1247" class="edge">
<title>kv_send1_6_3&#45;&gt;ring_stage1_7_4</title>
<path fill="none" stroke="black" d="M7196.68,-14490.73C7210.34,-14487.79 7224.56,-14485.04 7238,-14482.99 7434.45,-14453.05 7489.54,-14476.45 7690.23,-14447"/>
<polygon fill="black" stroke="black" points="7690.83,-14450.45 7700.21,-14445.51 7689.8,-14443.53 7690.83,-14450.45"/>
</g>
<!-- kv_send1_6_4&#45;&gt;ring_stage1_7_5 -->
<g id="edge1250" class="edge">
<title>kv_send1_6_4&#45;&gt;ring_stage1_7_5</title>
<path fill="none" stroke="black" d="M7544.18,-14394.68C7530.17,-14384.84 7513.84,-14373.38 7498.95,-14362.93"/>
<polygon fill="black" stroke="black" points="7500.57,-14359.79 7490.38,-14356.91 7496.55,-14365.52 7500.57,-14359.79"/>
</g>
<!-- kv_send1_6_5&#45;&gt;ring_stage1_7_6 -->
<g id="edge1253" class="edge">
<title>kv_send1_6_5&#45;&gt;ring_stage1_7_6</title>
<path fill="none" stroke="black" d="M7161.8,-14303.05C7162.35,-14295.02 7162.96,-14286.04 7163.55,-14277.48"/>
<polygon fill="black" stroke="black" points="7167.05,-14277.56 7164.24,-14267.34 7160.07,-14277.08 7167.05,-14277.56"/>
</g>
<!-- kv_send1_6_6&#45;&gt;ring_stage1_7_7 -->
<g id="edge1256" class="edge">
<title>kv_send1_6_6&#45;&gt;ring_stage1_7_7</title>
<path fill="none" stroke="black" d="M6939,-14213.31C6939,-14205.28 6939,-14196.3 6939,-14187.74"/>
<polygon fill="black" stroke="black" points="6942.5,-14187.6 6939,-14177.6 6935.5,-14187.6 6942.5,-14187.6"/>
</g>
<!-- kv_send1_6_7&#45;&gt;ring_stage1_7_8 -->
<g id="edge1259" class="edge">
<title>kv_send1_6_7&#45;&gt;ring_stage1_7_8</title>
<path fill="none" stroke="black" d="M6696.5,-14123.57C6696.96,-14115.54 6697.47,-14106.56 6697.96,-14098"/>
<polygon fill="black" stroke="black" points="6701.46,-14098.04 6698.54,-14087.86 6694.47,-14097.65 6701.46,-14098.04"/>
</g>
<!-- kv_send1_6_8&#45;&gt;ring_stage1_7_9 -->
<g id="edge1262" class="edge">
<title>kv_send1_6_8&#45;&gt;ring_stage1_7_9</title>
<path fill="none" stroke="black" d="M6479,-14033.83C6479,-14025.79 6479,-14016.82 6479,-14008.26"/>
<polygon fill="black" stroke="black" points="6482.5,-14008.12 6479,-13998.12 6475.5,-14008.12 6482.5,-14008.12"/>
</g>
<!-- kv_send1_6_9&#45;&gt;ring_stage1_7_10 -->
<g id="edge1265" class="edge">
<title>kv_send1_6_9&#45;&gt;ring_stage1_7_10</title>
<path fill="none" stroke="black" d="M6252,-13944.09C6251.08,-13936.05 6250.06,-13927.08 6249.08,-13918.52"/>
<polygon fill="black" stroke="black" points="6252.54,-13917.92 6247.93,-13908.38 6245.58,-13918.71 6252.54,-13917.92"/>
</g>
<!-- kv_send1_6_10&#45;&gt;ring_stage1_7_11 -->
<g id="edge1268" class="edge">
<title>kv_send1_6_10&#45;&gt;ring_stage1_7_11</title>
<path fill="none" stroke="black" d="M6013.9,-13854.35C6013.26,-13846.31 6012.54,-13837.34 6011.86,-13828.78"/>
<polygon fill="black" stroke="black" points="6015.33,-13828.33 6011.05,-13818.64 6008.36,-13828.89 6015.33,-13828.33"/>
</g>
<!-- kv_send1_6_11&#45;&gt;ring_stage1_7_12 -->
<g id="edge1271" class="edge">
<title>kv_send1_6_11&#45;&gt;ring_stage1_7_12</title>
<path fill="none" stroke="black" d="M5776.7,-13764.61C5775.69,-13756.57 5774.57,-13747.6 5773.49,-13739.04"/>
<polygon fill="black" stroke="black" points="5776.94,-13738.39 5772.22,-13728.9 5769.99,-13739.26 5776.94,-13738.39"/>
</g>
<!-- kv_send1_6_12&#45;&gt;ring_stage1_7_13 -->
<g id="edge1274" class="edge">
<title>kv_send1_6_12&#45;&gt;ring_stage1_7_13</title>
<path fill="none" stroke="black" d="M5520,-13674.87C5520,-13666.83 5520,-13657.85 5520,-13649.3"/>
<polygon fill="black" stroke="black" points="5523.5,-13649.16 5520,-13639.16 5516.5,-13649.16 5523.5,-13649.16"/>
</g>
<!-- kv_send1_6_13&#45;&gt;ring_stage1_7_14 -->
<g id="edge1277" class="edge">
<title>kv_send1_6_13&#45;&gt;ring_stage1_7_14</title>
<path fill="none" stroke="black" d="M5285.7,-13585.61C5284.01,-13577.4 5282.12,-13568.17 5280.32,-13559.39"/>
<polygon fill="black" stroke="black" points="5283.7,-13558.48 5278.27,-13549.38 5276.85,-13559.88 5283.7,-13558.48"/>
</g>
<!-- kv_send1_6_14&#45;&gt;ring_stage1_7_15 -->
<g id="edge1280" class="edge">
<title>kv_send1_6_14&#45;&gt;ring_stage1_7_15</title>
<path fill="none" stroke="black" d="M5040.7,-13495.39C5039.69,-13487.35 5038.57,-13478.37 5037.49,-13469.82"/>
<polygon fill="black" stroke="black" points="5040.94,-13469.17 5036.22,-13459.68 5033.99,-13470.04 5040.94,-13469.17"/>
</g>
<!-- kv_send1_6_15&#45;&gt;ring_stage1_7_0 -->
<g id="edge1235" class="edge">
<title>kv_send1_6_15&#45;&gt;ring_stage1_7_0</title>
<path fill="none" stroke="black" d="M4755.84,-13410.18C4727.91,-13399.14 4693.61,-13385.58 4663.39,-13373.64"/>
<polygon fill="black" stroke="black" points="4664.32,-13370.24 4653.73,-13369.82 4661.75,-13376.75 4664.32,-13370.24"/>
</g>
<!-- kv_send1_7_0 -->
<g id="node899" class="node">
<title>kv_send1_7_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4591" cy="-13253.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4591" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4591" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_7_0&#45;&gt;kv_send1_7_0 -->
<g id="edge1236" class="edge">
<title>ring_stage1_7_0&#45;&gt;kv_send1_7_0</title>
<path fill="none" stroke="black" d="M4589.59,-13316.39C4589.77,-13308.34 4589.98,-13299.31 4590.18,-13290.69"/>
<polygon fill="black" stroke="black" points="4593.68,-13290.54 4590.41,-13280.47 4586.68,-13290.38 4593.68,-13290.54"/>
</g>
<!-- ring_stage1_8_0 -->
<g id="node915" class="node">
<title>ring_stage1_8_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4905.5,-13280 4712.5,-13280 4712.5,-13227 4905.5,-13227 4905.5,-13280"/>
<text text-anchor="middle" x="4809" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="4809" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_8×V_8</text>
<text text-anchor="middle" x="4809" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_7_0&#45;&gt;ring_stage1_8_0 -->
<g id="edge1282" class="edge">
<title>ring_stage1_7_0&#45;&gt;ring_stage1_8_0</title>
<path fill="none" stroke="black" d="M4653.22,-13316.62C4678.87,-13306.4 4708.55,-13294.56 4735.08,-13283.98"/>
<polygon fill="black" stroke="black" points="4736.7,-13287.1 4744.7,-13280.14 4734.11,-13280.6 4736.7,-13287.1"/>
</g>
<!-- kv_send1_7_1 -->
<g id="node900" class="node">
<title>kv_send1_7_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4366" cy="-13163.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4366" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4366" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_7_1&#45;&gt;kv_send1_7_1 -->
<g id="edge1239" class="edge">
<title>ring_stage1_7_1&#45;&gt;kv_send1_7_1</title>
<path fill="none" stroke="black" d="M4205.98,-13226.88C4235.84,-13215.29 4271.03,-13201.63 4300.8,-13190.07"/>
<polygon fill="black" stroke="black" points="4302.2,-13193.28 4310.26,-13186.4 4299.67,-13186.75 4302.2,-13193.28"/>
</g>
<!-- ring_stage1_8_1 -->
<g id="node916" class="node">
<title>ring_stage1_8_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4243.5,-13190.26 4050.5,-13190.26 4050.5,-13137.26 4243.5,-13137.26 4243.5,-13190.26"/>
<text text-anchor="middle" x="4147" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="4147" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_9×V_9</text>
<text text-anchor="middle" x="4147" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_7_1&#45;&gt;ring_stage1_8_1 -->
<g id="edge1285" class="edge">
<title>ring_stage1_7_1&#45;&gt;ring_stage1_8_1</title>
<path fill="none" stroke="black" d="M4142.06,-13226.65C4142.72,-13218.44 4143.45,-13209.21 4144.15,-13200.43"/>
<polygon fill="black" stroke="black" points="4147.65,-13200.67 4144.95,-13190.42 4140.67,-13200.11 4147.65,-13200.67"/>
</g>
<!-- kv_send1_7_2 -->
<g id="node901" class="node">
<title>kv_send1_7_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5478" cy="-13074.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5478" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="5478" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_7_2&#45;&gt;kv_send1_7_2 -->
<g id="edge1242" class="edge">
<title>ring_stage1_7_2&#45;&gt;kv_send1_7_2</title>
<path fill="none" stroke="black" d="M5322.93,-13137.14C5351.52,-13125.69 5385.14,-13112.22 5413.76,-13100.75"/>
<polygon fill="black" stroke="black" points="5415.28,-13103.92 5423.26,-13096.95 5412.68,-13097.42 5415.28,-13103.92"/>
</g>
<!-- ring_stage1_8_2 -->
<g id="node917" class="node">
<title>ring_stage1_8_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5132.5,-13100.52 4921.5,-13100.52 4921.5,-13047.52 5132.5,-13047.52 5132.5,-13100.52"/>
<text text-anchor="middle" x="5027" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5027" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_10×V_10</text>
<text text-anchor="middle" x="5027" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_7_2&#45;&gt;ring_stage1_8_2 -->
<g id="edge1288" class="edge">
<title>ring_stage1_7_2&#45;&gt;ring_stage1_8_2</title>
<path fill="none" stroke="black" d="M5191.27,-13137.14C5164,-13126.83 5132.38,-13114.87 5104.22,-13104.22"/>
<polygon fill="black" stroke="black" points="5105.4,-13100.93 5094.81,-13100.66 5102.93,-13107.47 5105.4,-13100.93"/>
</g>
<!-- kv_send1_7_3 -->
<g id="node902" class="node">
<title>kv_send1_7_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6066" cy="-12984.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6066" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="6066" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_7_3&#45;&gt;kv_send1_7_3 -->
<g id="edge1245" class="edge">
<title>ring_stage1_7_3&#45;&gt;kv_send1_7_3</title>
<path fill="none" stroke="black" d="M5966.16,-13047.4C5982.64,-13037.15 6001.71,-13025.28 6018.75,-13014.68"/>
<polygon fill="black" stroke="black" points="6020.81,-13017.52 6027.45,-13009.27 6017.11,-13011.58 6020.81,-13017.52"/>
</g>
<!-- ring_stage1_8_3 -->
<g id="node918" class="node">
<title>ring_stage1_8_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5724.5,-13010.78 5513.5,-13010.78 5513.5,-12957.78 5724.5,-12957.78 5724.5,-13010.78"/>
<text text-anchor="middle" x="5619" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5619" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_11×V_11</text>
<text text-anchor="middle" x="5619" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_7_3&#45;&gt;ring_stage1_8_3 -->
<g id="edge1291" class="edge">
<title>ring_stage1_7_3&#45;&gt;ring_stage1_8_3</title>
<path fill="none" stroke="black" d="M5835.67,-13047.4C5798.83,-13036.84 5755.99,-13024.56 5718.18,-13013.72"/>
<polygon fill="black" stroke="black" points="5718.75,-13010.24 5708.18,-13010.85 5716.82,-13016.97 5718.75,-13010.24"/>
</g>
<!-- kv_send1_7_4 -->
<g id="node903" class="node">
<title>kv_send1_7_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7696" cy="-14330.38" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7696" y="-14334.18" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="7696" y="-14319.18" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_7_4&#45;&gt;kv_send1_7_4 -->
<g id="edge1248" class="edge">
<title>ring_stage1_7_4&#45;&gt;kv_send1_7_4</title>
<path fill="none" stroke="black" d="M7773.89,-14393.5C7761.82,-14383.88 7747.96,-14372.82 7735.31,-14362.74"/>
<polygon fill="black" stroke="black" points="7737.2,-14359.77 7727.2,-14356.27 7732.84,-14365.24 7737.2,-14359.77"/>
</g>
<!-- ring_stage1_8_4 -->
<g id="node919" class="node">
<title>ring_stage1_8_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6171.5,-12894.91 5960.5,-12894.91 5960.5,-12841.91 6171.5,-12841.91 6171.5,-12894.91"/>
<text text-anchor="middle" x="6066" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="6066" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_12×V_12</text>
<text text-anchor="middle" x="6066" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_7_4&#45;&gt;ring_stage1_8_4 -->
<g id="edge1294" class="edge">
<title>ring_stage1_7_4&#45;&gt;ring_stage1_8_4</title>
<path fill="none" stroke="black" d="M7809.05,-14393.59C7812.89,-14359.15 7819,-14295.86 7819,-14241.64 7819,-14241.64 7819,-14241.64 7819,-13611.46 7819,-13602.2 7696.09,-12963.37 7689,-12957.41 7624.86,-12903.47 6262.7,-12940.04 6181,-12921.41 6160.44,-12916.72 6139.09,-12908.2 6120.44,-12899.41"/>
<polygon fill="black" stroke="black" points="6121.76,-12896.16 6111.24,-12894.94 6118.71,-12902.45 6121.76,-12896.16"/>
</g>
<!-- kv_send1_7_5 -->
<g id="node904" class="node">
<title>kv_send1_7_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7438" cy="-14240.64" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7438" y="-14244.44" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="7438" y="-14229.44" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_7_5&#45;&gt;kv_send1_7_5 -->
<g id="edge1251" class="edge">
<title>ring_stage1_7_5&#45;&gt;kv_send1_7_5</title>
<path fill="none" stroke="black" d="M7449.29,-14303.53C7447.8,-14295.39 7446.14,-14286.25 7444.55,-14277.54"/>
<polygon fill="black" stroke="black" points="7447.97,-14276.82 7442.74,-14267.61 7441.09,-14278.07 7447.97,-14276.82"/>
</g>
<!-- ring_stage1_8_5 -->
<g id="node920" class="node">
<title>ring_stage1_8_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7771.5,-14267.14 7560.5,-14267.14 7560.5,-14214.14 7771.5,-14214.14 7771.5,-14267.14"/>
<text text-anchor="middle" x="7666" y="-14251.94" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="7666" y="-14236.94" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_13×V_13</text>
<text text-anchor="middle" x="7666" y="-14221.94" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_7_5&#45;&gt;ring_stage1_8_5 -->
<g id="edge1297" class="edge">
<title>ring_stage1_7_5&#45;&gt;ring_stage1_8_5</title>
<path fill="none" stroke="black" d="M7515.89,-14303.76C7540.6,-14293.54 7569.2,-14281.7 7594.76,-14271.12"/>
<polygon fill="black" stroke="black" points="7596.13,-14274.34 7604.03,-14267.28 7593.46,-14267.87 7596.13,-14274.34"/>
</g>
<!-- kv_send1_7_6 -->
<g id="node905" class="node">
<title>kv_send1_7_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7166" cy="-14150.9" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7166" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="7166" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_7_6&#45;&gt;kv_send1_7_6 -->
<g id="edge1254" class="edge">
<title>ring_stage1_7_6&#45;&gt;kv_send1_7_6</title>
<path fill="none" stroke="black" d="M7166,-14213.79C7166,-14205.74 7166,-14196.71 7166,-14188.09"/>
<polygon fill="black" stroke="black" points="7169.5,-14187.87 7166,-14177.87 7162.5,-14187.87 7169.5,-14187.87"/>
</g>
<!-- ring_stage1_8_6 -->
<g id="node921" class="node">
<title>ring_stage1_8_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7542.5,-14177.4 7331.5,-14177.4 7331.5,-14124.4 7542.5,-14124.4 7542.5,-14177.4"/>
<text text-anchor="middle" x="7437" y="-14162.2" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="7437" y="-14147.2" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_14×V_14</text>
<text text-anchor="middle" x="7437" y="-14132.2" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_7_6&#45;&gt;ring_stage1_8_6 -->
<g id="edge1300" class="edge">
<title>ring_stage1_7_6&#45;&gt;ring_stage1_8_6</title>
<path fill="none" stroke="black" d="M7245.11,-14214.02C7277.39,-14203.57 7314.86,-14191.44 7348.08,-14180.69"/>
<polygon fill="black" stroke="black" points="7349.35,-14183.95 7357.79,-14177.54 7347.2,-14177.29 7349.35,-14183.95"/>
</g>
<!-- kv_send1_7_7 -->
<g id="node906" class="node">
<title>kv_send1_7_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6939" cy="-14061.16" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6939" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="6939" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_7_7&#45;&gt;kv_send1_7_7 -->
<g id="edge1257" class="edge">
<title>ring_stage1_7_7&#45;&gt;kv_send1_7_7</title>
<path fill="none" stroke="black" d="M6939,-14124.05C6939,-14116 6939,-14106.97 6939,-14098.35"/>
<polygon fill="black" stroke="black" points="6942.5,-14098.13 6939,-14088.13 6935.5,-14098.13 6942.5,-14098.13"/>
</g>
<!-- ring_stage1_8_7 -->
<g id="node922" class="node">
<title>ring_stage1_8_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7271.5,-14087.66 7060.5,-14087.66 7060.5,-14034.66 7271.5,-14034.66 7271.5,-14087.66"/>
<text text-anchor="middle" x="7166" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="7166" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_15×V_15</text>
<text text-anchor="middle" x="7166" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_7_7&#45;&gt;ring_stage1_8_7 -->
<g id="edge1303" class="edge">
<title>ring_stage1_7_7&#45;&gt;ring_stage1_8_7</title>
<path fill="none" stroke="black" d="M7005.27,-14124.28C7031.84,-14114.01 7062.62,-14102.12 7090.08,-14091.5"/>
<polygon fill="black" stroke="black" points="7091.58,-14094.67 7099.65,-14087.8 7089.06,-14088.14 7091.58,-14094.67"/>
</g>
<!-- kv_send1_7_8 -->
<g id="node907" class="node">
<title>kv_send1_7_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6725" cy="-13971.42" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6725" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="6725" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_7_8&#45;&gt;kv_send1_7_8 -->
<g id="edge1260" class="edge">
<title>ring_stage1_7_8&#45;&gt;kv_send1_7_8</title>
<path fill="none" stroke="black" d="M6707.37,-14034.31C6709.71,-14026.08 6712.35,-14016.83 6714.85,-14008.04"/>
<polygon fill="black" stroke="black" points="6718.23,-14008.96 6717.6,-13998.39 6711.49,-14007.05 6718.23,-14008.96"/>
</g>
<!-- ring_stage1_8_8 -->
<g id="node923" class="node">
<title>ring_stage1_8_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7039.5,-13997.92 6846.5,-13997.92 6846.5,-13944.92 7039.5,-13944.92 7039.5,-13997.92"/>
<text text-anchor="middle" x="6943" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="6943" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_0×V_0</text>
<text text-anchor="middle" x="6943" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_7_8&#45;&gt;ring_stage1_8_8 -->
<g id="edge1306" class="edge">
<title>ring_stage1_7_8&#45;&gt;ring_stage1_8_8</title>
<path fill="none" stroke="black" d="M6770.94,-14034.54C6799.63,-14024.18 6832.91,-14012.17 6862.5,-14001.48"/>
<polygon fill="black" stroke="black" points="6863.76,-14004.75 6871.97,-13998.06 6861.38,-13998.17 6863.76,-14004.75"/>
</g>
<!-- kv_send1_7_9 -->
<g id="node908" class="node">
<title>kv_send1_7_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6474" cy="-13881.68" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6474" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6474" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_7_9&#45;&gt;kv_send1_7_9 -->
<g id="edge1263" class="edge">
<title>ring_stage1_7_9&#45;&gt;kv_send1_7_9</title>
<path fill="none" stroke="black" d="M6477.53,-13944.57C6477.07,-13936.52 6476.55,-13927.49 6476.06,-13918.87"/>
<polygon fill="black" stroke="black" points="6479.54,-13918.43 6475.48,-13908.65 6472.55,-13918.83 6479.54,-13918.43"/>
</g>
<!-- ring_stage1_8_9 -->
<g id="node924" class="node">
<title>ring_stage1_8_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6817.5,-13908.18 6624.5,-13908.18 6624.5,-13855.18 6817.5,-13855.18 6817.5,-13908.18"/>
<text text-anchor="middle" x="6721" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="6721" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_1×V_1</text>
<text text-anchor="middle" x="6721" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_7_9&#45;&gt;ring_stage1_8_9 -->
<g id="edge1309" class="edge">
<title>ring_stage1_7_9&#45;&gt;ring_stage1_8_9</title>
<path fill="none" stroke="black" d="M6549.65,-13944.8C6578.22,-13934.44 6611.36,-13922.43 6640.83,-13911.74"/>
<polygon fill="black" stroke="black" points="6642.06,-13915.02 6650.27,-13908.32 6639.67,-13908.44 6642.06,-13915.02"/>
</g>
<!-- kv_send1_7_10 -->
<g id="node909" class="node">
<title>kv_send1_7_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6238" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6238" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6238" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_7_10&#45;&gt;kv_send1_7_10 -->
<g id="edge1266" class="edge">
<title>ring_stage1_7_10&#45;&gt;kv_send1_7_10</title>
<path fill="none" stroke="black" d="M6242.94,-13854.83C6242.3,-13846.78 6241.57,-13837.75 6240.89,-13829.13"/>
<polygon fill="black" stroke="black" points="6244.36,-13828.6 6240.07,-13818.91 6237.38,-13829.15 6244.36,-13828.6"/>
</g>
<!-- ring_stage1_8_10 -->
<g id="node925" class="node">
<title>ring_stage1_8_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6568,-13818.44 6366,-13818.44 6366,-13765.44 6568,-13765.44 6568,-13818.44"/>
<text text-anchor="middle" x="6467" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="6467" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_2×V_2</text>
<text text-anchor="middle" x="6467" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_7_10&#45;&gt;ring_stage1_8_10 -->
<g id="edge1312" class="edge">
<title>ring_stage1_7_10&#45;&gt;ring_stage1_8_10</title>
<path fill="none" stroke="black" d="M6309.81,-13855.06C6335.8,-13844.79 6365.9,-13832.9 6392.76,-13822.28"/>
<polygon fill="black" stroke="black" points="6394.1,-13825.51 6402.11,-13818.58 6391.52,-13819 6394.1,-13825.51"/>
</g>
<!-- kv_send1_7_11 -->
<g id="node910" class="node">
<title>kv_send1_7_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5998" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5998" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5998" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_7_11&#45;&gt;kv_send1_7_11 -->
<g id="edge1269" class="edge">
<title>ring_stage1_7_11&#45;&gt;kv_send1_7_11</title>
<path fill="none" stroke="black" d="M6005.76,-13765.09C6004.74,-13756.95 6003.59,-13747.81 6002.5,-13739.1"/>
<polygon fill="black" stroke="black" points="6005.97,-13738.65 6001.26,-13729.17 5999.03,-13739.52 6005.97,-13738.65"/>
</g>
<!-- ring_stage1_8_11 -->
<g id="node926" class="node">
<title>ring_stage1_8_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6328,-13728.7 6126,-13728.7 6126,-13675.7 6328,-13675.7 6328,-13728.7"/>
<text text-anchor="middle" x="6227" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="6227" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_3×V_3</text>
<text text-anchor="middle" x="6227" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_7_11&#45;&gt;ring_stage1_8_11 -->
<g id="edge1315" class="edge">
<title>ring_stage1_7_11&#45;&gt;ring_stage1_8_11</title>
<path fill="none" stroke="black" d="M6072.64,-13765.32C6098.05,-13755.1 6127.46,-13743.26 6153.75,-13732.68"/>
<polygon fill="black" stroke="black" points="6155.31,-13735.82 6163.28,-13728.84 6152.7,-13729.33 6155.31,-13735.82"/>
</g>
<!-- kv_send1_7_12 -->
<g id="node911" class="node">
<title>kv_send1_7_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5769" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5769" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="5769" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_7_12&#45;&gt;kv_send1_7_12 -->
<g id="edge1272" class="edge">
<title>ring_stage1_7_12&#45;&gt;kv_send1_7_12</title>
<path fill="none" stroke="black" d="M5769,-13675.35C5769,-13667.3 5769,-13658.27 5769,-13649.65"/>
<polygon fill="black" stroke="black" points="5772.5,-13649.43 5769,-13639.43 5765.5,-13649.43 5772.5,-13649.43"/>
</g>
<!-- ring_stage1_8_12 -->
<g id="node927" class="node">
<title>ring_stage1_8_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6099,-13638.96 5897,-13638.96 5897,-13585.96 6099,-13585.96 6099,-13638.96"/>
<text text-anchor="middle" x="5998" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5998" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_4×V_4</text>
<text text-anchor="middle" x="5998" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_7_12&#45;&gt;ring_stage1_8_12 -->
<g id="edge1318" class="edge">
<title>ring_stage1_7_12&#45;&gt;ring_stage1_8_12</title>
<path fill="none" stroke="black" d="M5835.85,-13675.58C5862.66,-13665.31 5893.71,-13653.42 5921.42,-13642.8"/>
<polygon fill="black" stroke="black" points="5922.98,-13645.95 5931.07,-13639.1 5920.47,-13639.41 5922.98,-13645.95"/>
</g>
<!-- kv_send1_7_13 -->
<g id="node912" class="node">
<title>kv_send1_7_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5505" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5505" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="5505" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_7_13&#45;&gt;kv_send1_7_13 -->
<g id="edge1275" class="edge">
<title>ring_stage1_7_13&#45;&gt;kv_send1_7_13</title>
<path fill="none" stroke="black" d="M5515.58,-13585.61C5514.19,-13577.47 5512.63,-13568.33 5511.14,-13559.62"/>
<polygon fill="black" stroke="black" points="5514.57,-13558.95 5509.44,-13549.69 5507.67,-13560.13 5514.57,-13558.95"/>
</g>
<!-- ring_stage1_8_13 -->
<g id="node928" class="node">
<title>ring_stage1_8_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5856,-13549.22 5654,-13549.22 5654,-13496.22 5856,-13496.22 5856,-13549.22"/>
<text text-anchor="middle" x="5755" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5755" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_5×V_5</text>
<text text-anchor="middle" x="5755" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_7_13&#45;&gt;ring_stage1_8_13 -->
<g id="edge1321" class="edge">
<title>ring_stage1_7_13&#45;&gt;ring_stage1_8_13</title>
<path fill="none" stroke="black" d="M5588.6,-13585.84C5616.23,-13575.53 5648.25,-13563.57 5676.78,-13552.92"/>
<polygon fill="black" stroke="black" points="5678.17,-13556.14 5686.31,-13549.36 5675.72,-13549.58 5678.17,-13556.14"/>
</g>
<!-- kv_send1_7_14 -->
<g id="node913" class="node">
<title>kv_send1_7_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5262" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5262" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="5262" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_7_14&#45;&gt;kv_send1_7_14 -->
<g id="edge1278" class="edge">
<title>ring_stage1_7_14&#45;&gt;kv_send1_7_14</title>
<path fill="none" stroke="black" d="M5269.76,-13495.87C5268.74,-13487.73 5267.59,-13478.59 5266.5,-13469.88"/>
<polygon fill="black" stroke="black" points="5269.97,-13469.43 5265.26,-13459.95 5263.03,-13470.3 5269.97,-13469.43"/>
</g>
<!-- ring_stage1_8_14 -->
<g id="node929" class="node">
<title>ring_stage1_8_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5592,-13459.48 5390,-13459.48 5390,-13406.48 5592,-13406.48 5592,-13459.48"/>
<text text-anchor="middle" x="5491" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5491" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_6×V_6</text>
<text text-anchor="middle" x="5491" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_7_14&#45;&gt;ring_stage1_8_14 -->
<g id="edge1324" class="edge">
<title>ring_stage1_7_14&#45;&gt;ring_stage1_8_14</title>
<path fill="none" stroke="black" d="M5336.64,-13496.1C5362.05,-13485.88 5391.46,-13474.04 5417.75,-13463.46"/>
<polygon fill="black" stroke="black" points="5419.31,-13466.6 5427.28,-13459.62 5416.7,-13460.11 5419.31,-13466.6"/>
</g>
<!-- kv_send1_7_15 -->
<g id="node914" class="node">
<title>kv_send1_7_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5031" cy="-13343.24" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5031" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5031" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_7_15&#45;&gt;kv_send1_7_15 -->
<g id="edge1281" class="edge">
<title>ring_stage1_7_15&#45;&gt;kv_send1_7_15</title>
<path fill="none" stroke="black" d="M5032.41,-13406.13C5032.23,-13398.08 5032.02,-13389.05 5031.82,-13380.43"/>
<polygon fill="black" stroke="black" points="5035.32,-13380.12 5031.59,-13370.21 5028.32,-13380.28 5035.32,-13380.12"/>
</g>
<!-- ring_stage1_8_15 -->
<g id="node930" class="node">
<title>ring_stage1_8_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5354,-13369.74 5152,-13369.74 5152,-13316.74 5354,-13316.74 5354,-13369.74"/>
<text text-anchor="middle" x="5253" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="5253" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_7×V_7</text>
<text text-anchor="middle" x="5253" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_7_15&#45;&gt;ring_stage1_8_15 -->
<g id="edge1327" class="edge">
<title>ring_stage1_7_15&#45;&gt;ring_stage1_8_15</title>
<path fill="none" stroke="black" d="M5097.22,-13406.36C5122.87,-13396.14 5152.55,-13384.3 5179.08,-13373.72"/>
<polygon fill="black" stroke="black" points="5180.7,-13376.84 5188.7,-13369.88 5178.11,-13370.34 5180.7,-13376.84"/>
</g>
<!-- kv_send1_7_0&#45;&gt;ring_stage1_8_1 -->
<g id="edge1286" class="edge">
<title>kv_send1_7_0&#45;&gt;ring_stage1_8_1</title>
<path fill="none" stroke="black" d="M4517.05,-13234.66C4504.39,-13231.83 4491.34,-13229.04 4479,-13226.63 4379.61,-13207.22 4353.29,-13210.54 4254,-13190.63 4253.89,-13190.61 4253.79,-13190.58 4253.68,-13190.56"/>
<polygon fill="black" stroke="black" points="4254.24,-13187.11 4243.74,-13188.51 4252.83,-13193.96 4254.24,-13187.11"/>
</g>
<!-- kv_send1_7_1&#45;&gt;ring_stage1_8_2 -->
<g id="edge1289" class="edge">
<title>kv_send1_7_1&#45;&gt;ring_stage1_8_2</title>
<path fill="none" stroke="black" d="M4438.3,-13144.45C4451.45,-13141.58 4465.08,-13138.9 4478,-13136.89 4666.4,-13107.49 4719.46,-13129.64 4911.08,-13101.09"/>
<polygon fill="black" stroke="black" points="4911.85,-13104.52 4921.21,-13099.56 4910.8,-13097.6 4911.85,-13104.52"/>
</g>
<!-- kv_send1_7_2&#45;&gt;ring_stage1_8_3 -->
<g id="edge1292" class="edge">
<title>kv_send1_7_2&#45;&gt;ring_stage1_8_3</title>
<path fill="none" stroke="black" d="M5516.53,-13049.04C5532.64,-13039.02 5551.57,-13027.24 5568.75,-13016.54"/>
<polygon fill="black" stroke="black" points="5570.91,-13019.32 5577.55,-13011.07 5567.21,-13013.38 5570.91,-13019.32"/>
</g>
<!-- kv_send1_7_3&#45;&gt;ring_stage1_8_4 -->
<g id="edge1295" class="edge">
<title>kv_send1_7_3&#45;&gt;ring_stage1_8_4</title>
<path fill="none" stroke="black" d="M6066,-12957.15C6066,-12941.71 6066,-12921.94 6066,-12905.08"/>
<polygon fill="black" stroke="black" points="6069.5,-12905.02 6066,-12895.02 6062.5,-12905.02 6069.5,-12905.02"/>
</g>
<!-- kv_send1_7_4&#45;&gt;ring_stage1_8_5 -->
<g id="edge1298" class="edge">
<title>kv_send1_7_4&#45;&gt;ring_stage1_8_5</title>
<path fill="none" stroke="black" d="M7687.16,-14303.53C7684.32,-14295.23 7681.13,-14285.89 7678.1,-14277.02"/>
<polygon fill="black" stroke="black" points="7681.32,-14275.63 7674.78,-14267.3 7674.7,-14277.9 7681.32,-14275.63"/>
</g>
<!-- kv_send1_7_5&#45;&gt;ring_stage1_8_6 -->
<g id="edge1301" class="edge">
<title>kv_send1_7_5&#45;&gt;ring_stage1_8_6</title>
<path fill="none" stroke="black" d="M7437.7,-14213.31C7437.61,-14205.28 7437.51,-14196.3 7437.41,-14187.74"/>
<polygon fill="black" stroke="black" points="7440.91,-14187.56 7437.29,-14177.6 7433.91,-14187.64 7440.91,-14187.56"/>
</g>
<!-- kv_send1_7_6&#45;&gt;ring_stage1_8_7 -->
<g id="edge1304" class="edge">
<title>kv_send1_7_6&#45;&gt;ring_stage1_8_7</title>
<path fill="none" stroke="black" d="M7166,-14123.57C7166,-14115.54 7166,-14106.56 7166,-14098"/>
<polygon fill="black" stroke="black" points="7169.5,-14097.86 7166,-14087.86 7162.5,-14097.86 7169.5,-14097.86"/>
</g>
<!-- kv_send1_7_7&#45;&gt;ring_stage1_8_8 -->
<g id="edge1307" class="edge">
<title>kv_send1_7_7&#45;&gt;ring_stage1_8_8</title>
<path fill="none" stroke="black" d="M6940.2,-14033.83C6940.57,-14025.79 6940.98,-14016.82 6941.37,-14008.26"/>
<polygon fill="black" stroke="black" points="6944.87,-14008.27 6941.83,-13998.12 6937.88,-14007.95 6944.87,-14008.27"/>
</g>
<!-- kv_send1_7_8&#45;&gt;ring_stage1_8_9 -->
<g id="edge1310" class="edge">
<title>kv_send1_7_8&#45;&gt;ring_stage1_8_9</title>
<path fill="none" stroke="black" d="M6723.8,-13944.09C6723.43,-13936.05 6723.02,-13927.08 6722.63,-13918.52"/>
<polygon fill="black" stroke="black" points="6726.12,-13918.21 6722.17,-13908.38 6719.13,-13918.53 6726.12,-13918.21"/>
</g>
<!-- kv_send1_7_9&#45;&gt;ring_stage1_8_10 -->
<g id="edge1313" class="edge">
<title>kv_send1_7_9&#45;&gt;ring_stage1_8_10</title>
<path fill="none" stroke="black" d="M6471.9,-13854.35C6471.26,-13846.31 6470.54,-13837.34 6469.86,-13828.78"/>
<polygon fill="black" stroke="black" points="6473.33,-13828.33 6469.05,-13818.64 6466.36,-13828.89 6473.33,-13828.33"/>
</g>
<!-- kv_send1_7_10&#45;&gt;ring_stage1_8_11 -->
<g id="edge1316" class="edge">
<title>kv_send1_7_10&#45;&gt;ring_stage1_8_11</title>
<path fill="none" stroke="black" d="M6234.7,-13764.61C6233.69,-13756.57 6232.57,-13747.6 6231.49,-13739.04"/>
<polygon fill="black" stroke="black" points="6234.94,-13738.39 6230.22,-13728.9 6227.99,-13739.26 6234.94,-13738.39"/>
</g>
<!-- kv_send1_7_11&#45;&gt;ring_stage1_8_12 -->
<g id="edge1319" class="edge">
<title>kv_send1_7_11&#45;&gt;ring_stage1_8_12</title>
<path fill="none" stroke="black" d="M5998,-13674.87C5998,-13666.83 5998,-13657.85 5998,-13649.3"/>
<polygon fill="black" stroke="black" points="6001.5,-13649.16 5998,-13639.16 5994.5,-13649.16 6001.5,-13649.16"/>
</g>
<!-- kv_send1_7_12&#45;&gt;ring_stage1_8_13 -->
<g id="edge1322" class="edge">
<title>kv_send1_7_12&#45;&gt;ring_stage1_8_13</title>
<path fill="none" stroke="black" d="M5764.8,-13585.13C5763.52,-13577.09 5762.08,-13568.11 5760.72,-13559.56"/>
<polygon fill="black" stroke="black" points="5764.13,-13558.74 5759.1,-13549.42 5757.22,-13559.85 5764.13,-13558.74"/>
</g>
<!-- kv_send1_7_13&#45;&gt;ring_stage1_8_14 -->
<g id="edge1325" class="edge">
<title>kv_send1_7_13&#45;&gt;ring_stage1_8_14</title>
<path fill="none" stroke="black" d="M5500.8,-13495.39C5499.52,-13487.35 5498.08,-13478.37 5496.72,-13469.82"/>
<polygon fill="black" stroke="black" points="5500.13,-13469 5495.1,-13459.68 5493.22,-13470.11 5500.13,-13469"/>
</g>
<!-- kv_send1_7_14&#45;&gt;ring_stage1_8_15 -->
<g id="edge1328" class="edge">
<title>kv_send1_7_14&#45;&gt;ring_stage1_8_15</title>
<path fill="none" stroke="black" d="M5259.3,-13405.65C5258.48,-13397.61 5257.55,-13388.63 5256.68,-13380.08"/>
<polygon fill="black" stroke="black" points="5260.14,-13379.53 5255.64,-13369.94 5253.18,-13380.24 5260.14,-13379.53"/>
</g>
<!-- kv_send1_7_15&#45;&gt;ring_stage1_8_0 -->
<g id="edge1283" class="edge">
<title>kv_send1_7_15&#45;&gt;ring_stage1_8_0</title>
<path fill="none" stroke="black" d="M4975.84,-13320.44C4947.91,-13309.4 4913.61,-13295.84 4883.39,-13283.9"/>
<polygon fill="black" stroke="black" points="4884.32,-13280.5 4873.73,-13280.08 4881.75,-13287.01 4884.32,-13280.5"/>
</g>
<!-- kv_send1_8_0 -->
<g id="node931" class="node">
<title>kv_send1_8_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4590" cy="-13163.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4590" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4590" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_8_0&#45;&gt;kv_send1_8_0 -->
<g id="edge1284" class="edge">
<title>ring_stage1_8_0&#45;&gt;kv_send1_8_0</title>
<path fill="none" stroke="black" d="M4745.07,-13226.88C4716.48,-13215.43 4682.86,-13201.96 4654.24,-13190.49"/>
<polygon fill="black" stroke="black" points="4655.32,-13187.16 4644.74,-13186.69 4652.72,-13193.66 4655.32,-13187.16"/>
</g>
<!-- ring_stage1_9_0 -->
<g id="node947" class="node">
<title>ring_stage1_9_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4904.5,-13190.26 4711.5,-13190.26 4711.5,-13137.26 4904.5,-13137.26 4904.5,-13190.26"/>
<text text-anchor="middle" x="4808" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="4808" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_7×V_7</text>
<text text-anchor="middle" x="4808" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_8_0&#45;&gt;ring_stage1_9_0 -->
<g id="edge1330" class="edge">
<title>ring_stage1_8_0&#45;&gt;ring_stage1_9_0</title>
<path fill="none" stroke="black" d="M4808.71,-13226.65C4808.61,-13218.44 4808.51,-13209.21 4808.41,-13200.43"/>
<polygon fill="black" stroke="black" points="4811.91,-13200.38 4808.29,-13190.42 4804.91,-13200.46 4811.91,-13200.38"/>
</g>
<!-- kv_send1_8_1 -->
<g id="node932" class="node">
<title>kv_send1_8_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4589" cy="-13074.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4589" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4589" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_8_1&#45;&gt;kv_send1_8_1 -->
<g id="edge1287" class="edge">
<title>ring_stage1_8_1&#45;&gt;kv_send1_8_1</title>
<path fill="none" stroke="black" d="M4243.74,-13139.01C4247.2,-13138.28 4250.63,-13137.57 4254,-13136.89 4352.42,-13117.08 4378.48,-13120.2 4477,-13100.89 4486.16,-13099.09 4495.71,-13097.09 4505.2,-13095.02"/>
<polygon fill="black" stroke="black" points="4506.04,-13098.41 4515.05,-13092.84 4504.53,-13091.58 4506.04,-13098.41"/>
</g>
<!-- ring_stage1_9_1 -->
<g id="node948" class="node">
<title>ring_stage1_9_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4243.5,-13100.52 4050.5,-13100.52 4050.5,-13047.52 4243.5,-13047.52 4243.5,-13100.52"/>
<text text-anchor="middle" x="4147" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="4147" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_8×V_8</text>
<text text-anchor="middle" x="4147" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_8_1&#45;&gt;ring_stage1_9_1 -->
<g id="edge1333" class="edge">
<title>ring_stage1_8_1&#45;&gt;ring_stage1_9_1</title>
<path fill="none" stroke="black" d="M4147,-13136.91C4147,-13128.7 4147,-13119.47 4147,-13110.69"/>
<polygon fill="black" stroke="black" points="4150.5,-13110.68 4147,-13100.68 4143.5,-13110.68 4150.5,-13110.68"/>
</g>
<!-- kv_send1_8_2 -->
<g id="node933" class="node">
<title>kv_send1_8_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5392" cy="-12984.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5392" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="5392" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_8_2&#45;&gt;kv_send1_8_2 -->
<g id="edge1290" class="edge">
<title>ring_stage1_8_2&#45;&gt;kv_send1_8_2</title>
<path fill="none" stroke="black" d="M5132.57,-13047.64C5188.35,-13034.23 5255.86,-13018 5308.04,-13005.46"/>
<polygon fill="black" stroke="black" points="5309.02,-13008.82 5317.92,-13003.08 5307.38,-13002.02 5309.02,-13008.82"/>
</g>
<!-- ring_stage1_9_2 -->
<g id="node949" class="node">
<title>ring_stage1_9_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4835.5,-13010.78 4642.5,-13010.78 4642.5,-12957.78 4835.5,-12957.78 4835.5,-13010.78"/>
<text text-anchor="middle" x="4739" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="4739" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_9×V_9</text>
<text text-anchor="middle" x="4739" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_8_2&#45;&gt;ring_stage1_9_2 -->
<g id="edge1336" class="edge">
<title>ring_stage1_8_2&#45;&gt;ring_stage1_9_2</title>
<path fill="none" stroke="black" d="M4942.92,-13047.4C4908.47,-13036.91 4868.46,-13024.72 4833.04,-13013.93"/>
<polygon fill="black" stroke="black" points="4833.77,-13010.49 4823.18,-13010.92 4831.73,-13017.19 4833.77,-13010.49"/>
</g>
<!-- kv_send1_8_3 -->
<g id="node934" class="node">
<title>kv_send1_8_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5615" cy="-12868.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5615" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5615" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_8_3&#45;&gt;kv_send1_8_3 -->
<g id="edge1293" class="edge">
<title>ring_stage1_8_3&#45;&gt;kv_send1_8_3</title>
<path fill="none" stroke="black" d="M5618.1,-12957.72C5617.56,-12942.41 5616.87,-12922.69 5616.28,-12905.77"/>
<polygon fill="black" stroke="black" points="5619.77,-12905.54 5615.92,-12895.67 5612.78,-12905.78 5619.77,-12905.54"/>
</g>
<!-- ring_stage1_9_3 -->
<g id="node950" class="node">
<title>ring_stage1_9_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5493.5,-12894.91 5282.5,-12894.91 5282.5,-12841.91 5493.5,-12841.91 5493.5,-12894.91"/>
<text text-anchor="middle" x="5388" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="5388" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_10×V_10</text>
<text text-anchor="middle" x="5388" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_8_3&#45;&gt;ring_stage1_9_3 -->
<g id="edge1339" class="edge">
<title>ring_stage1_8_3&#45;&gt;ring_stage1_9_3</title>
<path fill="none" stroke="black" d="M5567.16,-12957.72C5532.21,-12940.49 5485.95,-12917.69 5449.19,-12899.57"/>
<polygon fill="black" stroke="black" points="5450.58,-12896.36 5440.07,-12895.07 5447.49,-12902.63 5450.58,-12896.36"/>
</g>
<!-- kv_send1_8_4 -->
<g id="node935" class="node">
<title>kv_send1_8_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6051" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6051" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="6051" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_8_4&#45;&gt;kv_send1_8_4 -->
<g id="edge1296" class="edge">
<title>ring_stage1_8_4&#45;&gt;kv_send1_8_4</title>
<path fill="none" stroke="black" d="M6063.25,-12841.73C6060.9,-12819.76 6057.48,-12787.91 6054.86,-12763.4"/>
<polygon fill="black" stroke="black" points="6058.33,-12762.97 6053.78,-12753.4 6051.37,-12763.71 6058.33,-12762.97"/>
</g>
<!-- ring_stage1_9_4 -->
<g id="node951" class="node">
<title>ring_stage1_9_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5929.5,-12752.91 5718.5,-12752.91 5718.5,-12699.91 5929.5,-12699.91 5929.5,-12752.91"/>
<text text-anchor="middle" x="5824" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="5824" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_11×V_11</text>
<text text-anchor="middle" x="5824" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_8_4&#45;&gt;ring_stage1_9_4 -->
<g id="edge1342" class="edge">
<title>ring_stage1_8_4&#45;&gt;ring_stage1_9_4</title>
<path fill="none" stroke="black" d="M6021.89,-12841.89C5981.08,-12818.28 5920.34,-12783.14 5876.92,-12758.02"/>
<polygon fill="black" stroke="black" points="5878.62,-12754.96 5868.21,-12752.98 5875.11,-12761.02 5878.62,-12754.96"/>
</g>
<!-- kv_send1_8_5 -->
<g id="node936" class="node">
<title>kv_send1_8_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7664" cy="-14150.9" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7664" y="-14154.7" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="7664" y="-14139.7" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_8_5&#45;&gt;kv_send1_8_5 -->
<g id="edge1299" class="edge">
<title>ring_stage1_8_5&#45;&gt;kv_send1_8_5</title>
<path fill="none" stroke="black" d="M7665.41,-14213.79C7665.23,-14205.74 7665.02,-14196.71 7664.82,-14188.09"/>
<polygon fill="black" stroke="black" points="7668.32,-14187.78 7664.59,-14177.87 7661.32,-14187.94 7668.32,-14187.78"/>
</g>
<!-- ring_stage1_9_5 -->
<g id="node952" class="node">
<title>ring_stage1_9_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6649.5,-12610.91 6438.5,-12610.91 6438.5,-12557.91 6649.5,-12557.91 6649.5,-12610.91"/>
<text text-anchor="middle" x="6544" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="6544" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_12×V_12</text>
<text text-anchor="middle" x="6544" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_8_5&#45;&gt;ring_stage1_9_5 -->
<g id="edge1345" class="edge">
<title>ring_stage1_8_5&#45;&gt;ring_stage1_9_5</title>
<path fill="none" stroke="black" d="M7732.75,-14214.04C7749.08,-14204.87 7765,-14192.93 7776,-14177.77 7806.76,-14135.36 7799,-14114.55 7799,-14062.16 7799,-14062.16 7799,-14062.16 7799,-13342.24 7799,-13166.07 7836.28,-13073.76 7704,-12957.41 7651.26,-12911.02 7436.75,-12973.82 7390,-12921.41 7358.64,-12886.25 7361.16,-12852.66 7390,-12815.41 7429.06,-12764.94 7489.94,-12829.87 7529,-12779.41 7557.84,-12742.15 7561.62,-12707.4 7529,-12673.41 7495.51,-12638.5 6706.07,-12648.58 6659,-12637.41 6638.66,-12632.58 6617.52,-12624.13 6598.99,-12615.43"/>
<polygon fill="black" stroke="black" points="6600.36,-12612.21 6589.84,-12611.01 6597.32,-12618.51 6600.36,-12612.21"/>
</g>
<!-- kv_send1_8_6 -->
<g id="node937" class="node">
<title>kv_send1_8_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7426" cy="-14061.16" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7426" y="-14064.96" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="7426" y="-14049.96" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_8_6&#45;&gt;kv_send1_8_6 -->
<g id="edge1302" class="edge">
<title>ring_stage1_8_6&#45;&gt;kv_send1_8_6</title>
<path fill="none" stroke="black" d="M7433.76,-14124.05C7432.74,-14115.91 7431.59,-14106.77 7430.5,-14098.06"/>
<polygon fill="black" stroke="black" points="7433.97,-14097.61 7429.26,-14088.13 7427.03,-14098.48 7433.97,-14097.61"/>
</g>
<!-- ring_stage1_9_6 -->
<g id="node953" class="node">
<title>ring_stage1_9_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7767.5,-14087.66 7556.5,-14087.66 7556.5,-14034.66 7767.5,-14034.66 7767.5,-14087.66"/>
<text text-anchor="middle" x="7662" y="-14072.46" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="7662" y="-14057.46" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_13×V_13</text>
<text text-anchor="middle" x="7662" y="-14042.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_8_6&#45;&gt;ring_stage1_9_6 -->
<g id="edge1348" class="edge">
<title>ring_stage1_8_6&#45;&gt;ring_stage1_9_6</title>
<path fill="none" stroke="black" d="M7502.68,-14124.28C7529.02,-14114.01 7559.53,-14102.12 7586.75,-14091.5"/>
<polygon fill="black" stroke="black" points="7588.19,-14094.7 7596.23,-14087.8 7585.65,-14088.18 7588.19,-14094.7"/>
</g>
<!-- kv_send1_8_7 -->
<g id="node938" class="node">
<title>kv_send1_8_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7167" cy="-13971.42" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7167" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7167" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_8_7&#45;&gt;kv_send1_8_7 -->
<g id="edge1305" class="edge">
<title>ring_stage1_8_7&#45;&gt;kv_send1_8_7</title>
<path fill="none" stroke="black" d="M7166.29,-14034.31C7166.39,-14026.26 7166.49,-14017.23 7166.59,-14008.61"/>
<polygon fill="black" stroke="black" points="7170.09,-14008.43 7166.7,-13998.39 7163.09,-14008.35 7170.09,-14008.43"/>
</g>
<!-- ring_stage1_9_7 -->
<g id="node954" class="node">
<title>ring_stage1_9_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7522.5,-13997.92 7311.5,-13997.92 7311.5,-13944.92 7522.5,-13944.92 7522.5,-13997.92"/>
<text text-anchor="middle" x="7417" y="-13982.72" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="7417" y="-13967.72" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_14×V_14</text>
<text text-anchor="middle" x="7417" y="-13952.72" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_8_7&#45;&gt;ring_stage1_9_7 -->
<g id="edge1351" class="edge">
<title>ring_stage1_8_7&#45;&gt;ring_stage1_9_7</title>
<path fill="none" stroke="black" d="M7239.27,-14034.54C7268.91,-14024.18 7303.28,-14012.17 7333.85,-14001.48"/>
<polygon fill="black" stroke="black" points="7335.35,-14004.67 7343.63,-13998.06 7333.04,-13998.06 7335.35,-14004.67"/>
</g>
<!-- kv_send1_8_8 -->
<g id="node939" class="node">
<title>kv_send1_8_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6940" cy="-13881.68" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6940" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="6940" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_8_8&#45;&gt;kv_send1_8_8 -->
<g id="edge1308" class="edge">
<title>ring_stage1_8_8&#45;&gt;kv_send1_8_8</title>
<path fill="none" stroke="black" d="M6942.12,-13944.57C6941.84,-13936.52 6941.53,-13927.49 6941.24,-13918.87"/>
<polygon fill="black" stroke="black" points="6944.73,-13918.52 6940.89,-13908.65 6937.73,-13918.76 6944.73,-13918.52"/>
</g>
<!-- ring_stage1_9_8 -->
<g id="node955" class="node">
<title>ring_stage1_9_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7272.5,-13908.18 7061.5,-13908.18 7061.5,-13855.18 7272.5,-13855.18 7272.5,-13908.18"/>
<text text-anchor="middle" x="7167" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="7167" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_15×V_15</text>
<text text-anchor="middle" x="7167" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_8_8&#45;&gt;ring_stage1_9_8 -->
<g id="edge1354" class="edge">
<title>ring_stage1_8_8&#45;&gt;ring_stage1_9_8</title>
<path fill="none" stroke="black" d="M7008.39,-13944.8C7034.61,-13934.53 7064.98,-13922.64 7092.09,-13912.02"/>
<polygon fill="black" stroke="black" points="7093.49,-13915.23 7101.53,-13908.32 7090.94,-13908.71 7093.49,-13915.23"/>
</g>
<!-- kv_send1_8_9 -->
<g id="node940" class="node">
<title>kv_send1_8_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6716" cy="-13791.94" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6716" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6716" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_8_9&#45;&gt;kv_send1_8_9 -->
<g id="edge1311" class="edge">
<title>ring_stage1_8_9&#45;&gt;kv_send1_8_9</title>
<path fill="none" stroke="black" d="M6719.53,-13854.83C6719.07,-13846.78 6718.55,-13837.75 6718.06,-13829.13"/>
<polygon fill="black" stroke="black" points="6721.54,-13828.69 6717.48,-13818.91 6714.55,-13829.09 6721.54,-13828.69"/>
</g>
<!-- ring_stage1_9_9 -->
<g id="node956" class="node">
<title>ring_stage1_9_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7036.5,-13818.44 6843.5,-13818.44 6843.5,-13765.44 7036.5,-13765.44 7036.5,-13818.44"/>
<text text-anchor="middle" x="6940" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="6940" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_0×V_0</text>
<text text-anchor="middle" x="6940" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_8_9&#45;&gt;ring_stage1_9_9 -->
<g id="edge1357" class="edge">
<title>ring_stage1_8_9&#45;&gt;ring_stage1_9_9</title>
<path fill="none" stroke="black" d="M6784.93,-13855.06C6810.46,-13844.84 6840,-13833 6866.41,-13822.42"/>
<polygon fill="black" stroke="black" points="6868.01,-13825.55 6875.99,-13818.58 6865.4,-13819.05 6868.01,-13825.55"/>
</g>
<!-- kv_send1_8_10 -->
<g id="node941" class="node">
<title>kv_send1_8_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6456" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6456" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6456" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_8_10&#45;&gt;kv_send1_8_10 -->
<g id="edge1314" class="edge">
<title>ring_stage1_8_10&#45;&gt;kv_send1_8_10</title>
<path fill="none" stroke="black" d="M6463.76,-13765.09C6462.74,-13756.95 6461.59,-13747.81 6460.5,-13739.1"/>
<polygon fill="black" stroke="black" points="6463.97,-13738.65 6459.26,-13729.17 6457.03,-13739.52 6463.97,-13738.65"/>
</g>
<!-- ring_stage1_9_10 -->
<g id="node957" class="node">
<title>ring_stage1_9_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6806,-13728.7 6604,-13728.7 6604,-13675.7 6806,-13675.7 6806,-13728.7"/>
<text text-anchor="middle" x="6705" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="6705" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_1×V_1</text>
<text text-anchor="middle" x="6705" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_8_10&#45;&gt;ring_stage1_9_10 -->
<g id="edge1360" class="edge">
<title>ring_stage1_8_10&#45;&gt;ring_stage1_9_10</title>
<path fill="none" stroke="black" d="M6536.48,-13765.32C6564.46,-13755.01 6596.89,-13743.05 6625.78,-13732.4"/>
<polygon fill="black" stroke="black" points="6627.26,-13735.59 6635.43,-13728.84 6624.84,-13729.02 6627.26,-13735.59"/>
</g>
<!-- kv_send1_8_11 -->
<g id="node942" class="node">
<title>kv_send1_8_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6227" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6227" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="6227" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_8_11&#45;&gt;kv_send1_8_11 -->
<g id="edge1317" class="edge">
<title>ring_stage1_8_11&#45;&gt;kv_send1_8_11</title>
<path fill="none" stroke="black" d="M6227,-13675.35C6227,-13667.3 6227,-13658.27 6227,-13649.65"/>
<polygon fill="black" stroke="black" points="6230.5,-13649.43 6227,-13639.43 6223.5,-13649.43 6230.5,-13649.43"/>
</g>
<!-- ring_stage1_9_11 -->
<g id="node958" class="node">
<title>ring_stage1_9_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6557,-13638.96 6355,-13638.96 6355,-13585.96 6557,-13585.96 6557,-13638.96"/>
<text text-anchor="middle" x="6456" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="6456" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_2×V_2</text>
<text text-anchor="middle" x="6456" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_8_11&#45;&gt;ring_stage1_9_11 -->
<g id="edge1363" class="edge">
<title>ring_stage1_8_11&#45;&gt;ring_stage1_9_11</title>
<path fill="none" stroke="black" d="M6293.85,-13675.58C6320.66,-13665.31 6351.71,-13653.42 6379.42,-13642.8"/>
<polygon fill="black" stroke="black" points="6380.98,-13645.95 6389.07,-13639.1 6378.47,-13639.41 6380.98,-13645.95"/>
</g>
<!-- kv_send1_8_12 -->
<g id="node943" class="node">
<title>kv_send1_8_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5987" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5987" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="5987" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_8_12&#45;&gt;kv_send1_8_12 -->
<g id="edge1320" class="edge">
<title>ring_stage1_8_12&#45;&gt;kv_send1_8_12</title>
<path fill="none" stroke="black" d="M5994.76,-13585.61C5993.74,-13577.47 5992.59,-13568.33 5991.5,-13559.62"/>
<polygon fill="black" stroke="black" points="5994.97,-13559.17 5990.26,-13549.69 5988.03,-13560.04 5994.97,-13559.17"/>
</g>
<!-- ring_stage1_9_12 -->
<g id="node959" class="node">
<title>ring_stage1_9_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6318,-13549.22 6116,-13549.22 6116,-13496.22 6318,-13496.22 6318,-13549.22"/>
<text text-anchor="middle" x="6217" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="6217" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_3×V_3</text>
<text text-anchor="middle" x="6217" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_8_12&#45;&gt;ring_stage1_9_12 -->
<g id="edge1366" class="edge">
<title>ring_stage1_8_12&#45;&gt;ring_stage1_9_12</title>
<path fill="none" stroke="black" d="M6061.93,-13585.84C6087.46,-13575.62 6117,-13563.78 6143.41,-13553.2"/>
<polygon fill="black" stroke="black" points="6145.01,-13556.33 6152.99,-13549.36 6142.4,-13549.83 6145.01,-13556.33"/>
</g>
<!-- kv_send1_8_13 -->
<g id="node944" class="node">
<title>kv_send1_8_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5740" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5740" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="5740" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_8_13&#45;&gt;kv_send1_8_13 -->
<g id="edge1323" class="edge">
<title>ring_stage1_8_13&#45;&gt;kv_send1_8_13</title>
<path fill="none" stroke="black" d="M5750.58,-13495.87C5749.19,-13487.73 5747.63,-13478.59 5746.14,-13469.88"/>
<polygon fill="black" stroke="black" points="5749.57,-13469.21 5744.44,-13459.95 5742.67,-13470.39 5749.57,-13469.21"/>
</g>
<!-- ring_stage1_9_13 -->
<g id="node960" class="node">
<title>ring_stage1_9_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6070,-13459.48 5868,-13459.48 5868,-13406.48 6070,-13406.48 6070,-13459.48"/>
<text text-anchor="middle" x="5969" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="5969" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_4×V_4</text>
<text text-anchor="middle" x="5969" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_8_13&#45;&gt;ring_stage1_9_13 -->
<g id="edge1369" class="edge">
<title>ring_stage1_8_13&#45;&gt;ring_stage1_9_13</title>
<path fill="none" stroke="black" d="M5817.47,-13496.1C5842.41,-13485.88 5871.29,-13474.04 5897.09,-13463.46"/>
<polygon fill="black" stroke="black" points="5898.52,-13466.66 5906.45,-13459.62 5895.87,-13460.18 5898.52,-13466.66"/>
</g>
<!-- kv_send1_8_14 -->
<g id="node945" class="node">
<title>kv_send1_8_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5482" cy="-13343.24" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5482" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="5482" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_8_14&#45;&gt;kv_send1_8_14 -->
<g id="edge1326" class="edge">
<title>ring_stage1_8_14&#45;&gt;kv_send1_8_14</title>
<path fill="none" stroke="black" d="M5488.35,-13406.13C5487.52,-13398.08 5486.6,-13389.05 5485.71,-13380.43"/>
<polygon fill="black" stroke="black" points="5489.17,-13379.8 5484.66,-13370.21 5482.2,-13380.51 5489.17,-13379.8"/>
</g>
<!-- ring_stage1_9_14 -->
<g id="node961" class="node">
<title>ring_stage1_9_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5832,-13369.74 5630,-13369.74 5630,-13316.74 5832,-13316.74 5832,-13369.74"/>
<text text-anchor="middle" x="5731" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="5731" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_5×V_5</text>
<text text-anchor="middle" x="5731" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_8_14&#45;&gt;ring_stage1_9_14 -->
<g id="edge1372" class="edge">
<title>ring_stage1_8_14&#45;&gt;ring_stage1_9_14</title>
<path fill="none" stroke="black" d="M5561.06,-13406.36C5589.28,-13396.05 5621.98,-13384.09 5651.12,-13373.44"/>
<polygon fill="black" stroke="black" points="5652.66,-13376.6 5660.85,-13369.88 5650.26,-13370.03 5652.66,-13376.6"/>
</g>
<!-- kv_send1_8_15 -->
<g id="node946" class="node">
<title>kv_send1_8_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5031" cy="-13253.5" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5031" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5031" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_8_15&#45;&gt;kv_send1_8_15 -->
<g id="edge1329" class="edge">
<title>ring_stage1_8_15&#45;&gt;kv_send1_8_15</title>
<path fill="none" stroke="black" d="M5188.19,-13316.62C5159.1,-13305.13 5124.86,-13291.59 5095.77,-13280.1"/>
<polygon fill="black" stroke="black" points="5096.71,-13276.7 5086.12,-13276.28 5094.13,-13283.21 5096.71,-13276.7"/>
</g>
<!-- ring_stage1_9_15 -->
<g id="node962" class="node">
<title>ring_stage1_9_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5358,-13280 5156,-13280 5156,-13227 5358,-13227 5358,-13280"/>
<text text-anchor="middle" x="5257" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="5257" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_6×V_6</text>
<text text-anchor="middle" x="5257" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_8_15&#45;&gt;ring_stage1_9_15 -->
<g id="edge1375" class="edge">
<title>ring_stage1_8_15&#45;&gt;ring_stage1_9_15</title>
<path fill="none" stroke="black" d="M5254.18,-13316.39C5254.55,-13308.18 5254.97,-13298.95 5255.37,-13290.17"/>
<polygon fill="black" stroke="black" points="5258.87,-13290.31 5255.83,-13280.16 5251.88,-13289.99 5258.87,-13290.31"/>
</g>
<!-- kv_send1_8_0&#45;&gt;ring_stage1_9_1 -->
<g id="edge1334" class="edge">
<title>kv_send1_8_0&#45;&gt;ring_stage1_9_1</title>
<path fill="none" stroke="black" d="M4516.05,-13144.92C4503.39,-13142.09 4490.34,-13139.3 4478,-13136.89 4381.71,-13118.09 4353.99,-13120.72 4253.63,-13100.94"/>
<polygon fill="black" stroke="black" points="4254.18,-13097.48 4243.69,-13098.96 4252.81,-13104.35 4254.18,-13097.48"/>
</g>
<!-- kv_send1_8_1&#45;&gt;ring_stage1_9_2 -->
<g id="edge1337" class="edge">
<title>kv_send1_8_1&#45;&gt;ring_stage1_9_2</title>
<path fill="none" stroke="black" d="M4629.59,-13049.27C4647.12,-13039.02 4667.85,-13026.9 4686.52,-13015.97"/>
<polygon fill="black" stroke="black" points="4688.35,-13018.96 4695.22,-13010.89 4684.82,-13012.91 4688.35,-13018.96"/>
</g>
<!-- kv_send1_8_2&#45;&gt;ring_stage1_9_3 -->
<g id="edge1340" class="edge">
<title>kv_send1_8_2&#45;&gt;ring_stage1_9_3</title>
<path fill="none" stroke="black" d="M5391.08,-12957.15C5390.54,-12941.71 5389.85,-12921.94 5389.25,-12905.08"/>
<polygon fill="black" stroke="black" points="5392.75,-12904.89 5388.9,-12895.02 5385.75,-12905.13 5392.75,-12904.89"/>
</g>
<!-- kv_send1_8_3&#45;&gt;ring_stage1_9_4 -->
<g id="edge1343" class="edge">
<title>kv_send1_8_3&#45;&gt;ring_stage1_9_4</title>
<path fill="none" stroke="black" d="M5651.41,-12843.02C5686.42,-12819.57 5739.49,-12784.02 5777.53,-12758.53"/>
<polygon fill="black" stroke="black" points="5779.53,-12761.41 5785.89,-12752.93 5775.64,-12755.59 5779.53,-12761.41"/>
</g>
<!-- kv_send1_8_4&#45;&gt;ring_stage1_9_5 -->
<g id="edge1346" class="edge">
<title>kv_send1_8_4&#45;&gt;ring_stage1_9_5</title>
<path fill="none" stroke="black" d="M6093.7,-12701.89C6114.12,-12691.62 6139.24,-12680.36 6163,-12673.41 6277.5,-12639.91 6314.33,-12670.33 6429,-12637.41 6448.28,-12631.87 6468.48,-12623.65 6486.47,-12615.36"/>
<polygon fill="black" stroke="black" points="6488.1,-12618.46 6495.66,-12611.04 6485.12,-12612.13 6488.1,-12618.46"/>
</g>
<!-- kv_send1_8_5&#45;&gt;ring_stage1_9_6 -->
<g id="edge1349" class="edge">
<title>kv_send1_8_5&#45;&gt;ring_stage1_9_6</title>
<path fill="none" stroke="black" d="M7663.4,-14123.57C7663.22,-14115.54 7663.01,-14106.56 7662.82,-14098"/>
<polygon fill="black" stroke="black" points="7666.31,-14097.78 7662.59,-14087.86 7659.31,-14097.94 7666.31,-14097.78"/>
</g>
<!-- kv_send1_8_6&#45;&gt;ring_stage1_9_7 -->
<g id="edge1352" class="edge">
<title>kv_send1_8_6&#45;&gt;ring_stage1_9_7</title>
<path fill="none" stroke="black" d="M7423.3,-14033.83C7422.48,-14025.79 7421.55,-14016.82 7420.68,-14008.26"/>
<polygon fill="black" stroke="black" points="7424.14,-14007.71 7419.64,-13998.12 7417.18,-14008.43 7424.14,-14007.71"/>
</g>
<!-- kv_send1_8_7&#45;&gt;ring_stage1_9_8 -->
<g id="edge1355" class="edge">
<title>kv_send1_8_7&#45;&gt;ring_stage1_9_8</title>
<path fill="none" stroke="black" d="M7167,-13944.09C7167,-13936.05 7167,-13927.08 7167,-13918.52"/>
<polygon fill="black" stroke="black" points="7170.5,-13918.38 7167,-13908.38 7163.5,-13918.38 7170.5,-13918.38"/>
</g>
<!-- kv_send1_8_8&#45;&gt;ring_stage1_9_9 -->
<g id="edge1358" class="edge">
<title>kv_send1_8_8&#45;&gt;ring_stage1_9_9</title>
<path fill="none" stroke="black" d="M6940,-13854.35C6940,-13846.31 6940,-13837.34 6940,-13828.78"/>
<polygon fill="black" stroke="black" points="6943.5,-13828.64 6940,-13818.64 6936.5,-13828.64 6943.5,-13828.64"/>
</g>
<!-- kv_send1_8_9&#45;&gt;ring_stage1_9_10 -->
<g id="edge1361" class="edge">
<title>kv_send1_8_9&#45;&gt;ring_stage1_9_10</title>
<path fill="none" stroke="black" d="M6712.7,-13764.61C6711.69,-13756.57 6710.57,-13747.6 6709.49,-13739.04"/>
<polygon fill="black" stroke="black" points="6712.94,-13738.39 6708.22,-13728.9 6705.99,-13739.26 6712.94,-13738.39"/>
</g>
<!-- kv_send1_8_10&#45;&gt;ring_stage1_9_11 -->
<g id="edge1364" class="edge">
<title>kv_send1_8_10&#45;&gt;ring_stage1_9_11</title>
<path fill="none" stroke="black" d="M6456,-13674.87C6456,-13666.83 6456,-13657.85 6456,-13649.3"/>
<polygon fill="black" stroke="black" points="6459.5,-13649.16 6456,-13639.16 6452.5,-13649.16 6459.5,-13649.16"/>
</g>
<!-- kv_send1_8_11&#45;&gt;ring_stage1_9_12 -->
<g id="edge1367" class="edge">
<title>kv_send1_8_11&#45;&gt;ring_stage1_9_12</title>
<path fill="none" stroke="black" d="M6224,-13585.13C6223.08,-13577.09 6222.06,-13568.11 6221.08,-13559.56"/>
<polygon fill="black" stroke="black" points="6224.54,-13558.96 6219.93,-13549.42 6217.58,-13559.75 6224.54,-13558.96"/>
</g>
<!-- kv_send1_8_12&#45;&gt;ring_stage1_9_13 -->
<g id="edge1370" class="edge">
<title>kv_send1_8_12&#45;&gt;ring_stage1_9_13</title>
<path fill="none" stroke="black" d="M5981.7,-13495.87C5980.01,-13487.66 5978.12,-13478.43 5976.32,-13469.65"/>
<polygon fill="black" stroke="black" points="5979.7,-13468.74 5974.27,-13459.64 5972.85,-13470.14 5979.7,-13468.74"/>
</g>
<!-- kv_send1_8_13&#45;&gt;ring_stage1_9_14 -->
<g id="edge1373" class="edge">
<title>kv_send1_8_13&#45;&gt;ring_stage1_9_14</title>
<path fill="none" stroke="black" d="M5737.3,-13405.65C5736.48,-13397.61 5735.55,-13388.63 5734.68,-13380.08"/>
<polygon fill="black" stroke="black" points="5738.14,-13379.53 5733.64,-13369.94 5731.18,-13380.24 5738.14,-13379.53"/>
</g>
<!-- kv_send1_8_14&#45;&gt;ring_stage1_9_15 -->
<g id="edge1376" class="edge">
<title>kv_send1_8_14&#45;&gt;ring_stage1_9_15</title>
<path fill="none" stroke="black" d="M5425.51,-13320.21C5397.2,-13309.17 5362.53,-13295.65 5332.02,-13283.75"/>
<polygon fill="black" stroke="black" points="5333.28,-13280.49 5322.69,-13280.11 5330.74,-13287.01 5333.28,-13280.49"/>
</g>
<!-- kv_send1_8_15&#45;&gt;ring_stage1_9_0 -->
<g id="edge1331" class="edge">
<title>kv_send1_8_15&#45;&gt;ring_stage1_9_0</title>
<path fill="none" stroke="black" d="M4975.59,-13230.7C4947.42,-13219.61 4912.78,-13205.98 4882.33,-13194"/>
<polygon fill="black" stroke="black" points="4883.61,-13190.75 4873.02,-13190.34 4881.05,-13197.26 4883.61,-13190.75"/>
</g>
<!-- kv_send1_9_0 -->
<g id="node963" class="node">
<title>kv_send1_9_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4365" cy="-13074.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4365" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4365" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_9_0&#45;&gt;kv_send1_9_0 -->
<g id="edge1332" class="edge">
<title>ring_stage1_9_0&#45;&gt;kv_send1_9_0</title>
<path fill="none" stroke="black" d="M4711.31,-13138.82C4708.17,-13138.15 4705.06,-13137.51 4702,-13136.89 4602.73,-13116.87 4576.39,-13120.29 4477,-13100.89 4467.84,-13099.1 4458.29,-13097.1 4448.8,-13095.03"/>
<polygon fill="black" stroke="black" points="4449.47,-13091.59 4438.95,-13092.85 4447.96,-13098.43 4449.47,-13091.59"/>
</g>
<!-- ring_stage1_10_0 -->
<g id="node979" class="node">
<title>ring_stage1_10_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4903.5,-13100.52 4710.5,-13100.52 4710.5,-13047.52 4903.5,-13047.52 4903.5,-13100.52"/>
<text text-anchor="middle" x="4807" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="4807" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_6×V_6</text>
<text text-anchor="middle" x="4807" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_9_0&#45;&gt;ring_stage1_10_0 -->
<g id="edge1378" class="edge">
<title>ring_stage1_9_0&#45;&gt;ring_stage1_10_0</title>
<path fill="none" stroke="black" d="M4807.71,-13136.91C4807.61,-13128.7 4807.51,-13119.47 4807.41,-13110.69"/>
<polygon fill="black" stroke="black" points="4810.91,-13110.64 4807.29,-13100.68 4803.91,-13110.72 4810.91,-13110.64"/>
</g>
<!-- kv_send1_9_1 -->
<g id="node964" class="node">
<title>kv_send1_9_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4521" cy="-12984.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4521" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4521" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_9_1&#45;&gt;kv_send1_9_1 -->
<g id="edge1335" class="edge">
<title>ring_stage1_9_1&#45;&gt;kv_send1_9_1</title>
<path fill="none" stroke="black" d="M4243.75,-13049.35C4246.87,-13048.61 4249.96,-13047.87 4253,-13047.15 4322.23,-13030.71 4339.67,-13027.15 4409,-13011.15 4417.71,-13009.14 4426.8,-13007.04 4435.88,-13004.94"/>
<polygon fill="black" stroke="black" points="4436.74,-13008.33 4445.69,-13002.67 4435.16,-13001.51 4436.74,-13008.33"/>
</g>
<!-- ring_stage1_10_1 -->
<g id="node980" class="node">
<title>ring_stage1_10_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4175.5,-13010.78 3982.5,-13010.78 3982.5,-12957.78 4175.5,-12957.78 4175.5,-13010.78"/>
<text text-anchor="middle" x="4079" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="4079" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_7×V_7</text>
<text text-anchor="middle" x="4079" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_9_1&#45;&gt;ring_stage1_10_1 -->
<g id="edge1381" class="edge">
<title>ring_stage1_9_1&#45;&gt;ring_stage1_10_1</title>
<path fill="none" stroke="black" d="M4126.97,-13047.17C4120.12,-13038.33 4112.35,-13028.31 4105.1,-13018.95"/>
<polygon fill="black" stroke="black" points="4107.78,-13016.7 4098.89,-13010.94 4102.25,-13020.99 4107.78,-13016.7"/>
</g>
<!-- kv_send1_9_2 -->
<g id="node965" class="node">
<title>kv_send1_9_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4726" cy="-12868.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4726" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4726" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_9_2&#45;&gt;kv_send1_9_2 -->
<g id="edge1338" class="edge">
<title>ring_stage1_9_2&#45;&gt;kv_send1_9_2</title>
<path fill="none" stroke="black" d="M4736.08,-12957.72C4734.32,-12942.3 4732.05,-12922.41 4730.11,-12905.41"/>
<polygon fill="black" stroke="black" points="4733.56,-12904.81 4728.95,-12895.27 4726.61,-12905.6 4733.56,-12904.81"/>
</g>
<!-- ring_stage1_10_2 -->
<g id="node981" class="node">
<title>ring_stage1_10_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4604.5,-12894.91 4411.5,-12894.91 4411.5,-12841.91 4604.5,-12841.91 4604.5,-12894.91"/>
<text text-anchor="middle" x="4508" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="4508" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_8×V_8</text>
<text text-anchor="middle" x="4508" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_9_2&#45;&gt;ring_stage1_10_2 -->
<g id="edge1384" class="edge">
<title>ring_stage1_9_2&#45;&gt;ring_stage1_10_2</title>
<path fill="none" stroke="black" d="M4687.16,-12957.72C4652.21,-12940.49 4605.95,-12917.69 4569.19,-12899.57"/>
<polygon fill="black" stroke="black" points="4570.58,-12896.36 4560.07,-12895.07 4567.49,-12902.63 4570.58,-12896.36"/>
</g>
<!-- kv_send1_9_3 -->
<g id="node966" class="node">
<title>kv_send1_9_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5386" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5386" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5386" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_9_3&#45;&gt;kv_send1_9_3 -->
<g id="edge1341" class="edge">
<title>ring_stage1_9_3&#45;&gt;kv_send1_9_3</title>
<path fill="none" stroke="black" d="M5387.63,-12841.73C5387.32,-12819.76 5386.86,-12787.91 5386.51,-12763.4"/>
<polygon fill="black" stroke="black" points="5390.01,-12763.35 5386.37,-12753.4 5383.01,-12763.45 5390.01,-12763.35"/>
</g>
<!-- ring_stage1_10_3 -->
<g id="node982" class="node">
<title>ring_stage1_10_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5264.5,-12752.91 5071.5,-12752.91 5071.5,-12699.91 5264.5,-12699.91 5264.5,-12752.91"/>
<text text-anchor="middle" x="5168" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="5168" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_9×V_9</text>
<text text-anchor="middle" x="5168" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_9_3&#45;&gt;ring_stage1_10_3 -->
<g id="edge1387" class="edge">
<title>ring_stage1_9_3&#45;&gt;ring_stage1_10_3</title>
<path fill="none" stroke="black" d="M5347.9,-12841.89C5311.03,-12818.43 5256.27,-12783.58 5216.86,-12758.5"/>
<polygon fill="black" stroke="black" points="5218.51,-12755.4 5208.19,-12752.98 5214.75,-12761.3 5218.51,-12755.4"/>
</g>
<!-- kv_send1_9_4 -->
<g id="node967" class="node">
<title>kv_send1_9_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5881" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5881" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5881" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_9_4&#45;&gt;kv_send1_9_4 -->
<g id="edge1344" class="edge">
<title>ring_stage1_9_4&#45;&gt;kv_send1_9_4</title>
<path fill="none" stroke="black" d="M5834.45,-12699.73C5843.48,-12677.57 5856.6,-12645.34 5866.61,-12620.75"/>
<polygon fill="black" stroke="black" points="5869.89,-12621.98 5870.42,-12611.4 5863.41,-12619.34 5869.89,-12621.98"/>
</g>
<!-- ring_stage1_10_4 -->
<g id="node983" class="node">
<title>ring_stage1_10_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5759.5,-12610.91 5548.5,-12610.91 5548.5,-12557.91 5759.5,-12557.91 5759.5,-12610.91"/>
<text text-anchor="middle" x="5654" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="5654" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_10×V_10</text>
<text text-anchor="middle" x="5654" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_9_4&#45;&gt;ring_stage1_10_4 -->
<g id="edge1390" class="edge">
<title>ring_stage1_9_4&#45;&gt;ring_stage1_10_4</title>
<path fill="none" stroke="black" d="M5792.82,-12699.73C5764.66,-12676.54 5723.12,-12642.33 5692.82,-12617.38"/>
<polygon fill="black" stroke="black" points="5694.93,-12614.58 5684.98,-12610.92 5690.48,-12619.98 5694.93,-12614.58"/>
</g>
<!-- kv_send1_9_5 -->
<g id="node968" class="node">
<title>kv_send1_9_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7059" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7059" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="7059" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_9_5&#45;&gt;kv_send1_9_5 -->
<g id="edge1347" class="edge">
<title>ring_stage1_9_5&#45;&gt;kv_send1_9_5</title>
<path fill="none" stroke="black" d="M6594.61,-12557.78C6614.34,-12548.52 6637.37,-12538.59 6659,-12531.41 6760.22,-12497.8 6880.14,-12473.36 6962.11,-12458.89"/>
<polygon fill="black" stroke="black" points="6962.91,-12462.3 6972.16,-12457.13 6961.71,-12455.41 6962.91,-12462.3"/>
</g>
<!-- ring_stage1_10_5 -->
<g id="node984" class="node">
<title>ring_stage1_10_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6505.5,-12468.91 6294.5,-12468.91 6294.5,-12415.91 6505.5,-12415.91 6505.5,-12468.91"/>
<text text-anchor="middle" x="6400" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="6400" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_11×V_11</text>
<text text-anchor="middle" x="6400" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_9_5&#45;&gt;ring_stage1_10_5 -->
<g id="edge1393" class="edge">
<title>ring_stage1_9_5&#45;&gt;ring_stage1_10_5</title>
<path fill="none" stroke="black" d="M6517.59,-12557.73C6493.94,-12534.74 6459.15,-12500.91 6433.54,-12476.01"/>
<polygon fill="black" stroke="black" points="6435.85,-12473.38 6426.24,-12468.92 6430.97,-12478.4 6435.85,-12473.38"/>
</g>
<!-- kv_send1_9_6 -->
<g id="node969" class="node">
<title>kv_send1_9_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7652" cy="-13971.42" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7652" y="-13975.22" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="7652" y="-13960.22" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_9_6&#45;&gt;kv_send1_9_6 -->
<g id="edge1350" class="edge">
<title>ring_stage1_9_6&#45;&gt;kv_send1_9_6</title>
<path fill="none" stroke="black" d="M7659.05,-14034.31C7658.13,-14026.17 7657.08,-14017.03 7656.09,-14008.32"/>
<polygon fill="black" stroke="black" points="7659.57,-14007.93 7654.96,-13998.39 7652.61,-14008.72 7659.57,-14007.93"/>
</g>
<!-- ring_stage1_10_6 -->
<g id="node985" class="node">
<title>ring_stage1_10_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7423.5,-12326.91 7212.5,-12326.91 7212.5,-12273.91 7423.5,-12273.91 7423.5,-12326.91"/>
<text text-anchor="middle" x="7318" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="7318" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_12×V_12</text>
<text text-anchor="middle" x="7318" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_9_6&#45;&gt;ring_stage1_10_6 -->
<g id="edge1396" class="edge">
<title>ring_stage1_9_6&#45;&gt;ring_stage1_10_6</title>
<path fill="none" stroke="black" d="M7723.81,-14034.61C7739.24,-14025.37 7754.17,-14013.39 7764,-13998.29 7792.28,-13954.87 7779,-13934.49 7779,-13882.68 7779,-13882.68 7779,-13882.68 7779,-13611.46 7779,-13491.37 7819,-13464.33 7819,-13344.24 7819,-13344.24 7819,-13344.24 7819,-13252.5 7819,-13120.37 7877.53,-13049.71 7783,-12957.41 7724.21,-12900 7470.2,-12982.27 7415,-12921.41 7383.35,-12886.51 7385.36,-12852.03 7415,-12815.41 7463.32,-12755.71 7532.31,-12836.21 7584,-12779.41 7642.54,-12715.08 7669.1,-12459.05 7617,-12389.41 7594.43,-12359.24 7507.95,-12335.85 7433.76,-12320.8"/>
<polygon fill="black" stroke="black" points="7434.34,-12317.35 7423.85,-12318.82 7432.97,-12324.21 7434.34,-12317.35"/>
</g>
<!-- kv_send1_9_7 -->
<g id="node970" class="node">
<title>kv_send1_9_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7414" cy="-13881.68" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7414" y="-13885.48" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7414" y="-13870.48" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_9_7&#45;&gt;kv_send1_9_7 -->
<g id="edge1353" class="edge">
<title>ring_stage1_9_7&#45;&gt;kv_send1_9_7</title>
<path fill="none" stroke="black" d="M7416.12,-13944.57C7415.84,-13936.52 7415.53,-13927.49 7415.24,-13918.87"/>
<polygon fill="black" stroke="black" points="7418.73,-13918.52 7414.89,-13908.65 7411.73,-13918.76 7418.73,-13918.52"/>
</g>
<!-- ring_stage1_10_7 -->
<g id="node986" class="node">
<title>ring_stage1_10_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7753.5,-13908.18 7542.5,-13908.18 7542.5,-13855.18 7753.5,-13855.18 7753.5,-13908.18"/>
<text text-anchor="middle" x="7648" y="-13892.98" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="7648" y="-13877.98" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_13×V_13</text>
<text text-anchor="middle" x="7648" y="-13862.98" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_9_7&#45;&gt;ring_stage1_10_7 -->
<g id="edge1399" class="edge">
<title>ring_stage1_9_7&#45;&gt;ring_stage1_10_7</title>
<path fill="none" stroke="black" d="M7484.44,-13944.8C7511.6,-13934.49 7543.07,-13922.53 7571.11,-13911.88"/>
<polygon fill="black" stroke="black" points="7572.37,-13915.15 7580.48,-13908.32 7569.89,-13908.6 7572.37,-13915.15"/>
</g>
<!-- kv_send1_9_8 -->
<g id="node971" class="node">
<title>kv_send1_9_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7167" cy="-13791.94" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7167" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7167" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_9_8&#45;&gt;kv_send1_9_8 -->
<g id="edge1356" class="edge">
<title>ring_stage1_9_8&#45;&gt;kv_send1_9_8</title>
<path fill="none" stroke="black" d="M7167,-13854.83C7167,-13846.78 7167,-13837.75 7167,-13829.13"/>
<polygon fill="black" stroke="black" points="7170.5,-13828.91 7167,-13818.91 7163.5,-13828.91 7170.5,-13828.91"/>
</g>
<!-- ring_stage1_10_8 -->
<g id="node987" class="node">
<title>ring_stage1_10_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7514.5,-13818.44 7303.5,-13818.44 7303.5,-13765.44 7514.5,-13765.44 7514.5,-13818.44"/>
<text text-anchor="middle" x="7409" y="-13803.24" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="7409" y="-13788.24" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_14×V_14</text>
<text text-anchor="middle" x="7409" y="-13773.24" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_9_8&#45;&gt;ring_stage1_10_8 -->
<g id="edge1402" class="edge">
<title>ring_stage1_9_8&#45;&gt;ring_stage1_10_8</title>
<path fill="none" stroke="black" d="M7237.65,-13855.06C7266.22,-13844.7 7299.36,-13832.69 7328.83,-13822"/>
<polygon fill="black" stroke="black" points="7330.06,-13825.28 7338.27,-13818.58 7327.67,-13818.7 7330.06,-13825.28"/>
</g>
<!-- kv_send1_9_9 -->
<g id="node972" class="node">
<title>kv_send1_9_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6934" cy="-13702.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6934" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6934" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_9_9&#45;&gt;kv_send1_9_9 -->
<g id="edge1359" class="edge">
<title>ring_stage1_9_9&#45;&gt;kv_send1_9_9</title>
<path fill="none" stroke="black" d="M6938.23,-13765.09C6937.68,-13757.04 6937.06,-13748.01 6936.47,-13739.39"/>
<polygon fill="black" stroke="black" points="6939.95,-13738.9 6935.78,-13729.17 6932.97,-13739.38 6939.95,-13738.9"/>
</g>
<!-- ring_stage1_10_9 -->
<g id="node988" class="node">
<title>ring_stage1_10_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7272.5,-13728.7 7061.5,-13728.7 7061.5,-13675.7 7272.5,-13675.7 7272.5,-13728.7"/>
<text text-anchor="middle" x="7167" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="7167" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_15×V_15</text>
<text text-anchor="middle" x="7167" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_9_9&#45;&gt;ring_stage1_10_9 -->
<g id="edge1405" class="edge">
<title>ring_stage1_9_9&#45;&gt;ring_stage1_10_9</title>
<path fill="none" stroke="black" d="M7006.27,-13765.32C7032.84,-13755.05 7063.62,-13743.16 7091.08,-13732.54"/>
<polygon fill="black" stroke="black" points="7092.58,-13735.71 7100.65,-13728.84 7090.06,-13729.18 7092.58,-13735.71"/>
</g>
<!-- kv_send1_9_10 -->
<g id="node973" class="node">
<title>kv_send1_9_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6705" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6705" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6705" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_9_10&#45;&gt;kv_send1_9_10 -->
<g id="edge1362" class="edge">
<title>ring_stage1_9_10&#45;&gt;kv_send1_9_10</title>
<path fill="none" stroke="black" d="M6705,-13675.35C6705,-13667.3 6705,-13658.27 6705,-13649.65"/>
<polygon fill="black" stroke="black" points="6708.5,-13649.43 6705,-13639.43 6701.5,-13649.43 6708.5,-13649.43"/>
</g>
<!-- ring_stage1_10_10 -->
<g id="node989" class="node">
<title>ring_stage1_10_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7035,-13638.96 6833,-13638.96 6833,-13585.96 7035,-13585.96 7035,-13638.96"/>
<text text-anchor="middle" x="6934" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="6934" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_0×V_0</text>
<text text-anchor="middle" x="6934" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_9_10&#45;&gt;ring_stage1_10_10 -->
<g id="edge1408" class="edge">
<title>ring_stage1_9_10&#45;&gt;ring_stage1_10_10</title>
<path fill="none" stroke="black" d="M6771.85,-13675.58C6798.66,-13665.31 6829.71,-13653.42 6857.42,-13642.8"/>
<polygon fill="black" stroke="black" points="6858.98,-13645.95 6867.07,-13639.1 6856.47,-13639.41 6858.98,-13645.95"/>
</g>
<!-- kv_send1_9_11 -->
<g id="node974" class="node">
<title>kv_send1_9_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6447" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6447" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="6447" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_9_11&#45;&gt;kv_send1_9_11 -->
<g id="edge1365" class="edge">
<title>ring_stage1_9_11&#45;&gt;kv_send1_9_11</title>
<path fill="none" stroke="black" d="M6453.35,-13585.61C6452.52,-13577.56 6451.6,-13568.53 6450.71,-13559.91"/>
<polygon fill="black" stroke="black" points="6454.17,-13559.28 6449.66,-13549.69 6447.2,-13559.99 6454.17,-13559.28"/>
</g>
<!-- ring_stage1_10_11 -->
<g id="node990" class="node">
<title>ring_stage1_10_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6797,-13549.22 6595,-13549.22 6595,-13496.22 6797,-13496.22 6797,-13549.22"/>
<text text-anchor="middle" x="6696" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="6696" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_1×V_1</text>
<text text-anchor="middle" x="6696" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_9_11&#45;&gt;ring_stage1_10_11 -->
<g id="edge1411" class="edge">
<title>ring_stage1_9_11&#45;&gt;ring_stage1_10_11</title>
<path fill="none" stroke="black" d="M6526.06,-13585.84C6554.28,-13575.53 6586.98,-13563.57 6616.12,-13552.92"/>
<polygon fill="black" stroke="black" points="6617.66,-13556.08 6625.85,-13549.36 6615.26,-13549.51 6617.66,-13556.08"/>
</g>
<!-- kv_send1_9_12 -->
<g id="node975" class="node">
<title>kv_send1_9_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6198" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6198" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="6198" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_9_12&#45;&gt;kv_send1_9_12 -->
<g id="edge1368" class="edge">
<title>ring_stage1_9_12&#45;&gt;kv_send1_9_12</title>
<path fill="none" stroke="black" d="M6211.4,-13495.87C6209.64,-13487.73 6207.66,-13478.59 6205.78,-13469.88"/>
<polygon fill="black" stroke="black" points="6209.16,-13468.98 6203.62,-13459.95 6202.32,-13470.46 6209.16,-13468.98"/>
</g>
<!-- ring_stage1_10_12 -->
<g id="node991" class="node">
<title>ring_stage1_10_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6548,-13459.48 6346,-13459.48 6346,-13406.48 6548,-13406.48 6548,-13459.48"/>
<text text-anchor="middle" x="6447" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="6447" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_2×V_2</text>
<text text-anchor="middle" x="6447" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_9_12&#45;&gt;ring_stage1_10_12 -->
<g id="edge1414" class="edge">
<title>ring_stage1_9_12&#45;&gt;ring_stage1_10_12</title>
<path fill="none" stroke="black" d="M6284.14,-13496.1C6311.07,-13485.83 6342.25,-13473.94 6370.08,-13463.32"/>
<polygon fill="black" stroke="black" points="6371.68,-13466.46 6379.77,-13459.62 6369.18,-13459.92 6371.68,-13466.46"/>
</g>
<!-- kv_send1_9_13 -->
<g id="node976" class="node">
<title>kv_send1_9_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5960" cy="-13343.24" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5960" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="5960" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_9_13&#45;&gt;kv_send1_9_13 -->
<g id="edge1371" class="edge">
<title>ring_stage1_9_13&#45;&gt;kv_send1_9_13</title>
<path fill="none" stroke="black" d="M5966.35,-13406.13C5965.52,-13398.08 5964.6,-13389.05 5963.71,-13380.43"/>
<polygon fill="black" stroke="black" points="5967.17,-13379.8 5962.66,-13370.21 5960.2,-13380.51 5967.17,-13379.8"/>
</g>
<!-- ring_stage1_10_13 -->
<g id="node992" class="node">
<title>ring_stage1_10_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6290,-13369.74 6088,-13369.74 6088,-13316.74 6290,-13316.74 6290,-13369.74"/>
<text text-anchor="middle" x="6189" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="6189" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_3×V_3</text>
<text text-anchor="middle" x="6189" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_9_13&#45;&gt;ring_stage1_10_13 -->
<g id="edge1417" class="edge">
<title>ring_stage1_9_13&#45;&gt;ring_stage1_10_13</title>
<path fill="none" stroke="black" d="M6033.22,-13406.36C6058.87,-13396.14 6088.55,-13384.3 6115.08,-13373.72"/>
<polygon fill="black" stroke="black" points="6116.7,-13376.84 6124.7,-13369.88 6114.11,-13370.34 6116.7,-13376.84"/>
</g>
<!-- kv_send1_9_14 -->
<g id="node977" class="node">
<title>kv_send1_9_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5718" cy="-13253.5" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5718" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="5718" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_9_14&#45;&gt;kv_send1_9_14 -->
<g id="edge1374" class="edge">
<title>ring_stage1_9_14&#45;&gt;kv_send1_9_14</title>
<path fill="none" stroke="black" d="M5727.17,-13316.39C5725.96,-13308.25 5724.61,-13299.11 5723.32,-13290.4"/>
<polygon fill="black" stroke="black" points="5726.78,-13289.85 5721.85,-13280.47 5719.85,-13290.87 5726.78,-13289.85"/>
</g>
<!-- ring_stage1_10_14 -->
<g id="node993" class="node">
<title>ring_stage1_10_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6049,-13280 5847,-13280 5847,-13227 6049,-13227 6049,-13280"/>
<text text-anchor="middle" x="5948" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="5948" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_4×V_4</text>
<text text-anchor="middle" x="5948" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_9_14&#45;&gt;ring_stage1_10_14 -->
<g id="edge1420" class="edge">
<title>ring_stage1_9_14&#45;&gt;ring_stage1_10_14</title>
<path fill="none" stroke="black" d="M5794.35,-13316.62C5819.64,-13306.4 5848.92,-13294.56 5875.08,-13283.98"/>
<polygon fill="black" stroke="black" points="5876.61,-13287.14 5884.57,-13280.14 5873.99,-13280.65 5876.61,-13287.14"/>
</g>
<!-- kv_send1_9_15 -->
<g id="node978" class="node">
<title>kv_send1_9_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5030" cy="-13163.76" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5030" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5030" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_9_15&#45;&gt;kv_send1_9_15 -->
<g id="edge1377" class="edge">
<title>ring_stage1_9_15&#45;&gt;kv_send1_9_15</title>
<path fill="none" stroke="black" d="M5190.73,-13226.88C5160.74,-13215.29 5125.39,-13201.63 5095.49,-13190.07"/>
<polygon fill="black" stroke="black" points="5096.58,-13186.74 5085.99,-13186.4 5094.05,-13193.27 5096.58,-13186.74"/>
</g>
<!-- ring_stage1_10_15 -->
<g id="node994" class="node">
<title>ring_stage1_10_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5586,-13190.26 5384,-13190.26 5384,-13137.26 5586,-13137.26 5586,-13190.26"/>
<text text-anchor="middle" x="5485" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="5485" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_5×V_5</text>
<text text-anchor="middle" x="5485" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_9_15&#45;&gt;ring_stage1_10_15 -->
<g id="edge1423" class="edge">
<title>ring_stage1_9_15&#45;&gt;ring_stage1_10_15</title>
<path fill="none" stroke="black" d="M5323.56,-13226.88C5350.25,-13216.61 5381.16,-13204.72 5408.75,-13194.1"/>
<polygon fill="black" stroke="black" points="5410.28,-13197.26 5418.36,-13190.4 5407.77,-13190.73 5410.28,-13197.26"/>
</g>
<!-- kv_send1_9_0&#45;&gt;ring_stage1_10_1 -->
<g id="edge1382" class="edge">
<title>kv_send1_9_0&#45;&gt;ring_stage1_10_1</title>
<path fill="none" stroke="black" d="M4300.1,-13053.11C4262.18,-13041.47 4213.7,-13026.6 4171.79,-13013.74"/>
<polygon fill="black" stroke="black" points="4172.72,-13010.37 4162.13,-13010.78 4170.66,-13017.06 4172.72,-13010.37"/>
</g>
<!-- kv_send1_9_1&#45;&gt;ring_stage1_10_2 -->
<g id="edge1385" class="edge">
<title>kv_send1_9_1&#45;&gt;ring_stage1_10_2</title>
<path fill="none" stroke="black" d="M4518.02,-12957.15C4516.25,-12941.71 4514,-12921.94 4512.07,-12905.08"/>
<polygon fill="black" stroke="black" points="4515.54,-12904.56 4510.92,-12895.02 4508.58,-12905.35 4515.54,-12904.56"/>
</g>
<!-- kv_send1_9_2&#45;&gt;ring_stage1_10_3 -->
<g id="edge1388" class="edge">
<title>kv_send1_9_2&#45;&gt;ring_stage1_10_3</title>
<path fill="none" stroke="black" d="M4769.31,-12843.89C4789.65,-12833.75 4814.53,-12822.59 4838,-12815.41 4934.42,-12785.9 4965.9,-12809.95 5062,-12779.41 5079.47,-12773.85 5097.68,-12765.83 5113.97,-12757.75"/>
<polygon fill="black" stroke="black" points="5115.99,-12760.65 5123.32,-12753 5112.82,-12754.41 5115.99,-12760.65"/>
</g>
<!-- kv_send1_9_3&#45;&gt;ring_stage1_10_4 -->
<g id="edge1391" class="edge">
<title>kv_send1_9_3&#45;&gt;ring_stage1_10_4</title>
<path fill="none" stroke="black" d="M5430.56,-12702.13C5475.81,-12678.49 5546.13,-12641.76 5595.77,-12615.83"/>
<polygon fill="black" stroke="black" points="5597.55,-12618.85 5604.79,-12611.11 5594.31,-12612.64 5597.55,-12618.85"/>
</g>
<!-- kv_send1_9_4&#45;&gt;ring_stage1_10_5 -->
<g id="edge1394" class="edge">
<title>kv_send1_9_4&#45;&gt;ring_stage1_10_5</title>
<path fill="none" stroke="black" d="M5923.8,-12559.91C5944.45,-12549.58 5969.91,-12538.26 5994,-12531.41 6119.34,-12495.75 6159.54,-12530.65 6285,-12495.41 6304.4,-12489.96 6324.7,-12481.71 6342.76,-12473.38"/>
<polygon fill="black" stroke="black" points="6344.43,-12476.47 6351.98,-12469.03 6341.44,-12470.13 6344.43,-12476.47"/>
</g>
<!-- kv_send1_9_5&#45;&gt;ring_stage1_10_6 -->
<g id="edge1397" class="edge">
<title>kv_send1_9_5&#45;&gt;ring_stage1_10_6</title>
<path fill="none" stroke="black" d="M7102.35,-12417.97C7146.05,-12394.35 7213.7,-12357.79 7261.56,-12331.92"/>
<polygon fill="black" stroke="black" points="7263.42,-12334.89 7270.55,-12327.05 7260.09,-12328.73 7263.42,-12334.89"/>
</g>
<!-- kv_send1_9_6&#45;&gt;ring_stage1_10_7 -->
<g id="edge1400" class="edge">
<title>kv_send1_9_6&#45;&gt;ring_stage1_10_7</title>
<path fill="none" stroke="black" d="M7650.8,-13944.09C7650.43,-13936.05 7650.02,-13927.08 7649.63,-13918.52"/>
<polygon fill="black" stroke="black" points="7653.12,-13918.21 7649.17,-13908.38 7646.13,-13918.53 7653.12,-13918.21"/>
</g>
<!-- kv_send1_9_7&#45;&gt;ring_stage1_10_8 -->
<g id="edge1403" class="edge">
<title>kv_send1_9_7&#45;&gt;ring_stage1_10_8</title>
<path fill="none" stroke="black" d="M7412.5,-13854.35C7412.04,-13846.31 7411.53,-13837.34 7411.04,-13828.78"/>
<polygon fill="black" stroke="black" points="7414.53,-13828.43 7410.46,-13818.64 7407.54,-13828.82 7414.53,-13828.43"/>
</g>
<!-- kv_send1_9_8&#45;&gt;ring_stage1_10_9 -->
<g id="edge1406" class="edge">
<title>kv_send1_9_8&#45;&gt;ring_stage1_10_9</title>
<path fill="none" stroke="black" d="M7167,-13764.61C7167,-13756.57 7167,-13747.6 7167,-13739.04"/>
<polygon fill="black" stroke="black" points="7170.5,-13738.9 7167,-13728.9 7163.5,-13738.9 7170.5,-13738.9"/>
</g>
<!-- kv_send1_9_9&#45;&gt;ring_stage1_10_10 -->
<g id="edge1409" class="edge">
<title>kv_send1_9_9&#45;&gt;ring_stage1_10_10</title>
<path fill="none" stroke="black" d="M6934,-13674.87C6934,-13666.83 6934,-13657.85 6934,-13649.3"/>
<polygon fill="black" stroke="black" points="6937.5,-13649.16 6934,-13639.16 6930.5,-13649.16 6937.5,-13649.16"/>
</g>
<!-- kv_send1_9_10&#45;&gt;ring_stage1_10_11 -->
<g id="edge1412" class="edge">
<title>kv_send1_9_10&#45;&gt;ring_stage1_10_11</title>
<path fill="none" stroke="black" d="M6702.3,-13585.13C6701.48,-13577.09 6700.55,-13568.11 6699.68,-13559.56"/>
<polygon fill="black" stroke="black" points="6703.14,-13559.01 6698.64,-13549.42 6696.18,-13559.73 6703.14,-13559.01"/>
</g>
<!-- kv_send1_9_11&#45;&gt;ring_stage1_10_12 -->
<g id="edge1415" class="edge">
<title>kv_send1_9_11&#45;&gt;ring_stage1_10_12</title>
<path fill="none" stroke="black" d="M6447,-13495.39C6447,-13487.35 6447,-13478.37 6447,-13469.82"/>
<polygon fill="black" stroke="black" points="6450.5,-13469.68 6447,-13459.68 6443.5,-13469.68 6450.5,-13469.68"/>
</g>
<!-- kv_send1_9_12&#45;&gt;ring_stage1_10_13 -->
<g id="edge1418" class="edge">
<title>kv_send1_9_12&#45;&gt;ring_stage1_10_13</title>
<path fill="none" stroke="black" d="M6195.3,-13405.65C6194.48,-13397.61 6193.55,-13388.63 6192.68,-13380.08"/>
<polygon fill="black" stroke="black" points="6196.14,-13379.53 6191.64,-13369.94 6189.18,-13380.24 6196.14,-13379.53"/>
</g>
<!-- kv_send1_9_13&#45;&gt;ring_stage1_10_14 -->
<g id="edge1421" class="edge">
<title>kv_send1_9_13&#45;&gt;ring_stage1_10_14</title>
<path fill="none" stroke="black" d="M5956.4,-13315.91C5955.3,-13307.87 5954.07,-13298.89 5952.9,-13290.34"/>
<polygon fill="black" stroke="black" points="5956.34,-13289.63 5951.52,-13280.2 5949.4,-13290.58 5956.34,-13289.63"/>
</g>
<!-- kv_send1_9_14&#45;&gt;ring_stage1_10_15 -->
<g id="edge1424" class="edge">
<title>kv_send1_9_14&#45;&gt;ring_stage1_10_15</title>
<path fill="none" stroke="black" d="M5659.81,-13230.58C5630.37,-13219.5 5594.23,-13205.89 5562.48,-13193.93"/>
<polygon fill="black" stroke="black" points="5563.37,-13190.53 5552.77,-13190.28 5560.9,-13197.08 5563.37,-13190.53"/>
</g>
<!-- kv_send1_9_15&#45;&gt;ring_stage1_10_0 -->
<g id="edge1379" class="edge">
<title>kv_send1_9_15&#45;&gt;ring_stage1_10_0</title>
<path fill="none" stroke="black" d="M4974.59,-13140.96C4946.42,-13129.87 4911.78,-13116.24 4881.33,-13104.26"/>
<polygon fill="black" stroke="black" points="4882.61,-13101.01 4872.02,-13100.6 4880.05,-13107.52 4882.61,-13101.01"/>
</g>
<!-- kv_send1_10_0 -->
<g id="node995" class="node">
<title>kv_send1_10_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4297" cy="-12984.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4297" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4297" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_10_0&#45;&gt;kv_send1_10_0 -->
<g id="edge1380" class="edge">
<title>ring_stage1_10_0&#45;&gt;kv_send1_10_0</title>
<path fill="none" stroke="black" d="M4710.34,-13048.93C4707.19,-13048.31 4704.07,-13047.71 4701,-13047.15 4572.38,-13023.61 4537.77,-13033.89 4409,-13011.15 4399.49,-13009.47 4389.58,-13007.5 4379.75,-13005.41"/>
<polygon fill="black" stroke="black" points="4380.49,-13001.99 4369.97,-13003.29 4379,-13008.83 4380.49,-13001.99"/>
</g>
<!-- ring_stage1_11_0 -->
<g id="node1011" class="node">
<title>ring_stage1_11_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5046.5,-13010.78 4853.5,-13010.78 4853.5,-12957.78 5046.5,-12957.78 5046.5,-13010.78"/>
<text text-anchor="middle" x="4950" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="4950" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_5×V_5</text>
<text text-anchor="middle" x="4950" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_10_0&#45;&gt;ring_stage1_11_0 -->
<g id="edge1426" class="edge">
<title>ring_stage1_10_0&#45;&gt;ring_stage1_11_0</title>
<path fill="none" stroke="black" d="M4848.75,-13047.4C4864.47,-13037.76 4882.52,-13026.68 4898.99,-13016.57"/>
<polygon fill="black" stroke="black" points="4901.26,-13019.29 4907.95,-13011.07 4897.6,-13013.32 4901.26,-13019.29"/>
</g>
<!-- kv_send1_10_1 -->
<g id="node996" class="node">
<title>kv_send1_10_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4079" cy="-12868.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4079" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4079" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_10_1&#45;&gt;kv_send1_10_1 -->
<g id="edge1383" class="edge">
<title>ring_stage1_10_1&#45;&gt;kv_send1_10_1</title>
<path fill="none" stroke="black" d="M4079,-12957.72C4079,-12942.41 4079,-12922.69 4079,-12905.77"/>
<polygon fill="black" stroke="black" points="4082.5,-12905.67 4079,-12895.67 4075.5,-12905.67 4082.5,-12905.67"/>
</g>
<!-- ring_stage1_11_1 -->
<g id="node1012" class="node">
<title>ring_stage1_11_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4393.5,-12894.91 4200.5,-12894.91 4200.5,-12841.91 4393.5,-12841.91 4393.5,-12894.91"/>
<text text-anchor="middle" x="4297" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="4297" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_6×V_6</text>
<text text-anchor="middle" x="4297" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_10_1&#45;&gt;ring_stage1_11_1 -->
<g id="edge1429" class="edge">
<title>ring_stage1_10_1&#45;&gt;ring_stage1_11_1</title>
<path fill="none" stroke="black" d="M4127.92,-12957.72C4160.77,-12940.57 4204.19,-12917.88 4238.81,-12899.8"/>
<polygon fill="black" stroke="black" points="4240.62,-12902.81 4247.86,-12895.07 4237.38,-12896.6 4240.62,-12902.81"/>
</g>
<!-- kv_send1_10_2 -->
<g id="node997" class="node">
<title>kv_send1_10_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4950" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4950" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4950" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_10_2&#45;&gt;kv_send1_10_2 -->
<g id="edge1386" class="edge">
<title>ring_stage1_10_2&#45;&gt;kv_send1_10_2</title>
<path fill="none" stroke="black" d="M4552.68,-12841.82C4571.15,-12832.22 4593.1,-12822.05 4614,-12815.41 4710.1,-12784.87 4741.58,-12808.92 4838,-12779.41 4858.08,-12773.26 4879.19,-12764.21 4897.6,-12755.37"/>
<polygon fill="black" stroke="black" points="4899.24,-12758.46 4906.69,-12750.92 4896.17,-12752.17 4899.24,-12758.46"/>
</g>
<!-- ring_stage1_11_2 -->
<g id="node1013" class="node">
<title>ring_stage1_11_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4393.5,-12752.91 4200.5,-12752.91 4200.5,-12699.91 4393.5,-12699.91 4393.5,-12752.91"/>
<text text-anchor="middle" x="4297" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="4297" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_7×V_7</text>
<text text-anchor="middle" x="4297" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_10_2&#45;&gt;ring_stage1_11_2 -->
<g id="edge1432" class="edge">
<title>ring_stage1_10_2&#45;&gt;ring_stage1_11_2</title>
<path fill="none" stroke="black" d="M4469.3,-12841.73C4434.05,-12818.34 4381.91,-12783.75 4344.22,-12758.74"/>
<polygon fill="black" stroke="black" points="4345.72,-12755.53 4335.46,-12752.92 4341.85,-12761.37 4345.72,-12755.53"/>
</g>
<!-- kv_send1_10_3 -->
<g id="node998" class="node">
<title>kv_send1_10_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5427" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5427" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5427" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_10_3&#45;&gt;kv_send1_10_3 -->
<g id="edge1389" class="edge">
<title>ring_stage1_10_3&#45;&gt;kv_send1_10_3</title>
<path fill="none" stroke="black" d="M5215.2,-12699.89C5260.21,-12675.57 5327.85,-12639 5374.53,-12613.77"/>
<polygon fill="black" stroke="black" points="5376.43,-12616.72 5383.57,-12608.88 5373.11,-12610.56 5376.43,-12616.72"/>
</g>
<!-- ring_stage1_11_3 -->
<g id="node1014" class="node">
<title>ring_stage1_11_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5081.5,-12610.91 4888.5,-12610.91 4888.5,-12557.91 5081.5,-12557.91 5081.5,-12610.91"/>
<text text-anchor="middle" x="4985" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="4985" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_8×V_8</text>
<text text-anchor="middle" x="4985" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_10_3&#45;&gt;ring_stage1_11_3 -->
<g id="edge1435" class="edge">
<title>ring_stage1_10_3&#45;&gt;ring_stage1_11_3</title>
<path fill="none" stroke="black" d="M5134.43,-12699.73C5104,-12676.44 5059.02,-12642.04 5026.37,-12617.06"/>
<polygon fill="black" stroke="black" points="5028.42,-12614.22 5018.35,-12610.92 5024.17,-12619.78 5028.42,-12614.22"/>
</g>
<!-- kv_send1_10_4 -->
<g id="node999" class="node">
<title>kv_send1_10_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6173" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6173" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="6173" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_10_4&#45;&gt;kv_send1_10_4 -->
<g id="edge1392" class="edge">
<title>ring_stage1_10_4&#45;&gt;kv_send1_10_4</title>
<path fill="none" stroke="black" d="M5702.02,-12557.78C5722.19,-12548.06 5746.22,-12537.8 5769,-12531.41 5894.89,-12496.07 5935.28,-12531.38 6061,-12495.41 6081.45,-12489.55 6102.88,-12480.43 6121.45,-12471.44"/>
<polygon fill="black" stroke="black" points="6123.19,-12474.49 6130.6,-12466.91 6120.08,-12468.21 6123.19,-12474.49"/>
</g>
<!-- ring_stage1_11_4 -->
<g id="node1015" class="node">
<title>ring_stage1_11_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5746.5,-12468.91 5553.5,-12468.91 5553.5,-12415.91 5746.5,-12415.91 5746.5,-12468.91"/>
<text text-anchor="middle" x="5650" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="5650" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_9×V_9</text>
<text text-anchor="middle" x="5650" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_10_4&#45;&gt;ring_stage1_11_4 -->
<g id="edge1438" class="edge">
<title>ring_stage1_10_4&#45;&gt;ring_stage1_11_4</title>
<path fill="none" stroke="black" d="M5653.27,-12557.73C5652.63,-12535.63 5651.72,-12503.51 5651.02,-12478.94"/>
<polygon fill="black" stroke="black" points="5654.51,-12478.82 5650.73,-12468.92 5647.52,-12479.02 5654.51,-12478.82"/>
</g>
<!-- kv_send1_10_5 -->
<g id="node1000" class="node">
<title>kv_send1_10_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6420" cy="-12300.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6420" y="-12304.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6420" y="-12289.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_10_5&#45;&gt;kv_send1_10_5 -->
<g id="edge1395" class="edge">
<title>ring_stage1_10_5&#45;&gt;kv_send1_10_5</title>
<path fill="none" stroke="black" d="M6403.67,-12415.73C6406.81,-12393.76 6411.36,-12361.91 6414.86,-12337.4"/>
<polygon fill="black" stroke="black" points="6418.34,-12337.79 6416.29,-12327.4 6411.41,-12336.8 6418.34,-12337.79"/>
</g>
<!-- ring_stage1_11_5 -->
<g id="node1016" class="node">
<title>ring_stage1_11_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6278.5,-12326.91 6067.5,-12326.91 6067.5,-12273.91 6278.5,-12273.91 6278.5,-12326.91"/>
<text text-anchor="middle" x="6173" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6173" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_10×V_10</text>
<text text-anchor="middle" x="6173" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_10_5&#45;&gt;ring_stage1_11_5 -->
<g id="edge1441" class="edge">
<title>ring_stage1_10_5&#45;&gt;ring_stage1_11_5</title>
<path fill="none" stroke="black" d="M6358.63,-12415.89C6320.5,-12392.38 6263.84,-12357.43 6223.15,-12332.34"/>
<polygon fill="black" stroke="black" points="6224.82,-12329.25 6214.47,-12326.98 6221.14,-12335.21 6224.82,-12329.25"/>
</g>
<!-- kv_send1_10_6 -->
<g id="node1001" class="node">
<title>kv_send1_10_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7525" cy="-12158.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7525" y="-12162.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="7525" y="-12147.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_10_6&#45;&gt;kv_send1_10_6 -->
<g id="edge1398" class="edge">
<title>ring_stage1_10_6&#45;&gt;kv_send1_10_6</title>
<path fill="none" stroke="black" d="M7355.97,-12273.73C7391.08,-12249.98 7443.3,-12214.66 7480.39,-12189.58"/>
<polygon fill="black" stroke="black" points="7482.68,-12192.25 7489.01,-12183.75 7478.76,-12186.45 7482.68,-12192.25"/>
</g>
<!-- ring_stage1_11_6 -->
<g id="node1017" class="node">
<title>ring_stage1_11_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6958.5,-12184.91 6747.5,-12184.91 6747.5,-12131.91 6958.5,-12131.91 6958.5,-12184.91"/>
<text text-anchor="middle" x="6853" y="-12169.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6853" y="-12154.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_11×V_11</text>
<text text-anchor="middle" x="6853" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_10_6&#45;&gt;ring_stage1_11_6 -->
<g id="edge1444" class="edge">
<title>ring_stage1_10_6&#45;&gt;ring_stage1_11_6</title>
<path fill="none" stroke="black" d="M7212.48,-12278.22C7142.01,-12262.8 7047.79,-12239.69 6967,-12211.41 6949.16,-12205.16 6930.29,-12197.16 6913.15,-12189.32"/>
<polygon fill="black" stroke="black" points="6914.37,-12186.03 6903.83,-12184.99 6911.42,-12192.38 6914.37,-12186.03"/>
</g>
<!-- kv_send1_10_7 -->
<g id="node1002" class="node">
<title>kv_send1_10_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7636" cy="-13791.94" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7636" y="-13795.74" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7636" y="-13780.74" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_10_7&#45;&gt;kv_send1_10_7 -->
<g id="edge1401" class="edge">
<title>ring_stage1_10_7&#45;&gt;kv_send1_10_7</title>
<path fill="none" stroke="black" d="M7644.46,-13854.83C7643.35,-13846.69 7642.1,-13837.55 7640.91,-13828.84"/>
<polygon fill="black" stroke="black" points="7644.37,-13828.34 7639.55,-13818.91 7637.44,-13829.29 7644.37,-13828.34"/>
</g>
<!-- ring_stage1_11_7 -->
<g id="node1018" class="node">
<title>ring_stage1_11_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7667.5,-12042.91 7456.5,-12042.91 7456.5,-11989.91 7667.5,-11989.91 7667.5,-12042.91"/>
<text text-anchor="middle" x="7562" y="-12027.71" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="7562" y="-12012.71" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_12×V_12</text>
<text text-anchor="middle" x="7562" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_10_7&#45;&gt;ring_stage1_11_7 -->
<g id="edge1447" class="edge">
<title>ring_stage1_10_7&#45;&gt;ring_stage1_11_7</title>
<path fill="none" stroke="black" d="M7705.4,-13855.04C7721.12,-13845.62 7736.88,-13833.56 7748,-13818.81 7822.84,-13719.53 7800.48,-13671.67 7824,-13549.59 7893.5,-13188.77 7911,-13094.86 7911,-12727.41 7911,-12727.41 7911,-12727.41 7911,-12441.41 7911,-12355.07 7958.18,-12312.1 7901,-12247.41 7840.03,-12178.42 7769.05,-12268.72 7697,-12211.41 7656.95,-12179.54 7680.86,-12147.68 7652,-12105.41 7638,-12084.9 7618.7,-12065.27 7601.57,-12049.77"/>
<polygon fill="black" stroke="black" points="7603.68,-12046.96 7593.87,-12042.95 7599.04,-12052.2 7603.68,-12046.96"/>
</g>
<!-- kv_send1_10_8 -->
<g id="node1003" class="node">
<title>kv_send1_10_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7409" cy="-13702.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7409" y="-13706" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7409" y="-13691" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_10_8&#45;&gt;kv_send1_10_8 -->
<g id="edge1404" class="edge">
<title>ring_stage1_10_8&#45;&gt;kv_send1_10_8</title>
<path fill="none" stroke="black" d="M7409,-13765.09C7409,-13757.04 7409,-13748.01 7409,-13739.39"/>
<polygon fill="black" stroke="black" points="7412.5,-13739.17 7409,-13729.17 7405.5,-13739.17 7412.5,-13739.17"/>
</g>
<!-- ring_stage1_11_8 -->
<g id="node1019" class="node">
<title>ring_stage1_11_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7741.5,-13728.7 7530.5,-13728.7 7530.5,-13675.7 7741.5,-13675.7 7741.5,-13728.7"/>
<text text-anchor="middle" x="7636" y="-13713.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="7636" y="-13698.5" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_13×V_13</text>
<text text-anchor="middle" x="7636" y="-13683.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_10_8&#45;&gt;ring_stage1_11_8 -->
<g id="edge1450" class="edge">
<title>ring_stage1_10_8&#45;&gt;ring_stage1_11_8</title>
<path fill="none" stroke="black" d="M7475.27,-13765.32C7501.84,-13755.05 7532.62,-13743.16 7560.08,-13732.54"/>
<polygon fill="black" stroke="black" points="7561.58,-13735.71 7569.65,-13728.84 7559.06,-13729.18 7561.58,-13735.71"/>
</g>
<!-- kv_send1_10_9 -->
<g id="node1004" class="node">
<title>kv_send1_10_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7165" cy="-13612.46" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7165" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="7165" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_10_9&#45;&gt;kv_send1_10_9 -->
<g id="edge1407" class="edge">
<title>ring_stage1_10_9&#45;&gt;kv_send1_10_9</title>
<path fill="none" stroke="black" d="M7166.41,-13675.35C7166.23,-13667.3 7166.02,-13658.27 7165.82,-13649.65"/>
<polygon fill="black" stroke="black" points="7169.32,-13649.34 7165.59,-13639.43 7162.32,-13649.5 7169.32,-13649.34"/>
</g>
<!-- ring_stage1_11_9 -->
<g id="node1020" class="node">
<title>ring_stage1_11_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7514.5,-13638.96 7303.5,-13638.96 7303.5,-13585.96 7514.5,-13585.96 7514.5,-13638.96"/>
<text text-anchor="middle" x="7409" y="-13623.76" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="7409" y="-13608.76" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_14×V_14</text>
<text text-anchor="middle" x="7409" y="-13593.76" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_10_9&#45;&gt;ring_stage1_11_9 -->
<g id="edge1453" class="edge">
<title>ring_stage1_10_9&#45;&gt;ring_stage1_11_9</title>
<path fill="none" stroke="black" d="M7237.65,-13675.58C7266.22,-13665.22 7299.36,-13653.21 7328.83,-13642.52"/>
<polygon fill="black" stroke="black" points="7330.06,-13645.8 7338.27,-13639.1 7327.67,-13639.22 7330.06,-13645.8"/>
</g>
<!-- kv_send1_10_10 -->
<g id="node1005" class="node">
<title>kv_send1_10_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6925" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6925" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6925" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_10_10&#45;&gt;kv_send1_10_10 -->
<g id="edge1410" class="edge">
<title>ring_stage1_10_10&#45;&gt;kv_send1_10_10</title>
<path fill="none" stroke="black" d="M6931.35,-13585.61C6930.52,-13577.56 6929.6,-13568.53 6928.71,-13559.91"/>
<polygon fill="black" stroke="black" points="6932.17,-13559.28 6927.66,-13549.69 6925.2,-13559.99 6932.17,-13559.28"/>
</g>
<!-- ring_stage1_11_10 -->
<g id="node1021" class="node">
<title>ring_stage1_11_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7273,-13549.22 7053,-13549.22 7053,-13496.22 7273,-13496.22 7273,-13549.22"/>
<text text-anchor="middle" x="7163" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="7163" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_15×V_15</text>
<text text-anchor="middle" x="7163" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_10_10&#45;&gt;ring_stage1_11_10 -->
<g id="edge1456" class="edge">
<title>ring_stage1_10_10&#45;&gt;ring_stage1_11_10</title>
<path fill="none" stroke="black" d="M7000.85,-13585.84C7027.66,-13575.57 7058.71,-13563.68 7086.42,-13553.06"/>
<polygon fill="black" stroke="black" points="7087.98,-13556.21 7096.07,-13549.36 7085.47,-13549.67 7087.98,-13556.21"/>
</g>
<!-- kv_send1_10_11 -->
<g id="node1006" class="node">
<title>kv_send1_10_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6676" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6676" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="6676" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_10_11&#45;&gt;kv_send1_10_11 -->
<g id="edge1413" class="edge">
<title>ring_stage1_10_11&#45;&gt;kv_send1_10_11</title>
<path fill="none" stroke="black" d="M6690.11,-13495.87C6688.25,-13487.73 6686.17,-13478.59 6684.18,-13469.88"/>
<polygon fill="black" stroke="black" points="6687.55,-13468.92 6681.92,-13459.95 6680.73,-13470.47 6687.55,-13468.92"/>
</g>
<!-- ring_stage1_11_11 -->
<g id="node1022" class="node">
<title>ring_stage1_11_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7006,-13459.48 6804,-13459.48 6804,-13406.48 7006,-13406.48 7006,-13459.48"/>
<text text-anchor="middle" x="6905" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6905" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_0×V_0</text>
<text text-anchor="middle" x="6905" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_10_11&#45;&gt;ring_stage1_11_11 -->
<g id="edge1459" class="edge">
<title>ring_stage1_10_11&#45;&gt;ring_stage1_11_11</title>
<path fill="none" stroke="black" d="M6757.01,-13496.1C6781.27,-13485.92 6809.32,-13474.14 6834.44,-13463.6"/>
<polygon fill="black" stroke="black" points="6836.05,-13466.72 6843.91,-13459.62 6833.34,-13460.27 6836.05,-13466.72"/>
</g>
<!-- kv_send1_10_12 -->
<g id="node1007" class="node">
<title>kv_send1_10_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6438" cy="-13343.24" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6438" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="6438" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_10_12&#45;&gt;kv_send1_10_12 -->
<g id="edge1416" class="edge">
<title>ring_stage1_10_12&#45;&gt;kv_send1_10_12</title>
<path fill="none" stroke="black" d="M6444.35,-13406.13C6443.52,-13398.08 6442.6,-13389.05 6441.71,-13380.43"/>
<polygon fill="black" stroke="black" points="6445.17,-13379.8 6440.66,-13370.21 6438.2,-13380.51 6445.17,-13379.8"/>
</g>
<!-- ring_stage1_11_12 -->
<g id="node1023" class="node">
<title>ring_stage1_11_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6768,-13369.74 6566,-13369.74 6566,-13316.74 6768,-13316.74 6768,-13369.74"/>
<text text-anchor="middle" x="6667" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6667" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_1×V_1</text>
<text text-anchor="middle" x="6667" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_10_12&#45;&gt;ring_stage1_11_12 -->
<g id="edge1462" class="edge">
<title>ring_stage1_10_12&#45;&gt;ring_stage1_11_12</title>
<path fill="none" stroke="black" d="M6511.22,-13406.36C6536.87,-13396.14 6566.55,-13384.3 6593.08,-13373.72"/>
<polygon fill="black" stroke="black" points="6594.7,-13376.84 6602.7,-13369.88 6592.11,-13370.34 6594.7,-13376.84"/>
</g>
<!-- kv_send1_10_13 -->
<g id="node1008" class="node">
<title>kv_send1_10_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6177" cy="-13253.5" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6177" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6177" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_10_13&#45;&gt;kv_send1_10_13 -->
<g id="edge1419" class="edge">
<title>ring_stage1_10_13&#45;&gt;kv_send1_10_13</title>
<path fill="none" stroke="black" d="M6185.46,-13316.39C6184.35,-13308.25 6183.1,-13299.11 6181.91,-13290.4"/>
<polygon fill="black" stroke="black" points="6185.37,-13289.9 6180.55,-13280.47 6178.44,-13290.85 6185.37,-13289.9"/>
</g>
<!-- ring_stage1_11_13 -->
<g id="node1024" class="node">
<title>ring_stage1_11_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6528,-13280 6326,-13280 6326,-13227 6528,-13227 6528,-13280"/>
<text text-anchor="middle" x="6427" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6427" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_2×V_2</text>
<text text-anchor="middle" x="6427" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_10_13&#45;&gt;ring_stage1_11_13 -->
<g id="edge1465" class="edge">
<title>ring_stage1_10_13&#45;&gt;ring_stage1_11_13</title>
<path fill="none" stroke="black" d="M6258.48,-13316.62C6286.46,-13306.31 6318.89,-13294.35 6347.78,-13283.7"/>
<polygon fill="black" stroke="black" points="6349.26,-13286.89 6357.43,-13280.14 6346.84,-13280.32 6349.26,-13286.89"/>
</g>
<!-- kv_send1_10_14 -->
<g id="node1009" class="node">
<title>kv_send1_10_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5939" cy="-13163.76" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5939" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="5939" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_10_14&#45;&gt;kv_send1_10_14 -->
<g id="edge1422" class="edge">
<title>ring_stage1_10_14&#45;&gt;kv_send1_10_14</title>
<path fill="none" stroke="black" d="M5945.35,-13226.65C5944.52,-13218.6 5943.6,-13209.57 5942.71,-13200.95"/>
<polygon fill="black" stroke="black" points="5946.17,-13200.32 5941.66,-13190.73 5939.2,-13201.03 5946.17,-13200.32"/>
</g>
<!-- ring_stage1_11_14 -->
<g id="node1025" class="node">
<title>ring_stage1_11_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6270,-13190.26 6068,-13190.26 6068,-13137.26 6270,-13137.26 6270,-13190.26"/>
<text text-anchor="middle" x="6169" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="6169" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_3×V_3</text>
<text text-anchor="middle" x="6169" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_10_14&#45;&gt;ring_stage1_11_14 -->
<g id="edge1468" class="edge">
<title>ring_stage1_10_14&#45;&gt;ring_stage1_11_14</title>
<path fill="none" stroke="black" d="M6012.52,-13226.88C6038.39,-13216.61 6068.35,-13204.72 6095.09,-13194.1"/>
<polygon fill="black" stroke="black" points="6096.4,-13197.35 6104.4,-13190.4 6093.82,-13190.84 6096.4,-13197.35"/>
</g>
<!-- kv_send1_10_15 -->
<g id="node1010" class="node">
<title>kv_send1_10_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5254" cy="-13074.02" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5254" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5254" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_10_15&#45;&gt;kv_send1_10_15 -->
<g id="edge1425" class="edge">
<title>ring_stage1_10_15&#45;&gt;kv_send1_10_15</title>
<path fill="none" stroke="black" d="M5417.56,-13137.14C5386.92,-13125.5 5350.79,-13111.78 5320.28,-13100.19"/>
<polygon fill="black" stroke="black" points="5321.18,-13096.79 5310.59,-13096.51 5318.7,-13103.34 5321.18,-13096.79"/>
</g>
<!-- ring_stage1_11_15 -->
<g id="node1026" class="node">
<title>ring_stage1_11_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5801,-13100.52 5599,-13100.52 5599,-13047.52 5801,-13047.52 5801,-13100.52"/>
<text text-anchor="middle" x="5700" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="5700" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_4×V_4</text>
<text text-anchor="middle" x="5700" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_10_15&#45;&gt;ring_stage1_11_15 -->
<g id="edge1471" class="edge">
<title>ring_stage1_10_15&#45;&gt;ring_stage1_11_15</title>
<path fill="none" stroke="black" d="M5547.76,-13137.14C5572.82,-13126.92 5601.83,-13115.08 5627.76,-13104.5"/>
<polygon fill="black" stroke="black" points="5629.22,-13107.68 5637.16,-13100.66 5626.58,-13101.2 5629.22,-13107.68"/>
</g>
<!-- kv_send1_10_0&#45;&gt;ring_stage1_11_1 -->
<g id="edge1430" class="edge">
<title>kv_send1_10_0&#45;&gt;ring_stage1_11_1</title>
<path fill="none" stroke="black" d="M4297,-12957.15C4297,-12941.71 4297,-12921.94 4297,-12905.08"/>
<polygon fill="black" stroke="black" points="4300.5,-12905.02 4297,-12895.02 4293.5,-12905.02 4300.5,-12905.02"/>
</g>
<!-- kv_send1_10_1&#45;&gt;ring_stage1_11_2 -->
<g id="edge1433" class="edge">
<title>kv_send1_10_1&#45;&gt;ring_stage1_11_2</title>
<path fill="none" stroke="black" d="M4116.48,-12843.34C4153,-12819.89 4208.69,-12784.12 4248.56,-12758.52"/>
<polygon fill="black" stroke="black" points="4250.54,-12761.4 4257.06,-12753.05 4246.76,-12755.51 4250.54,-12761.4"/>
</g>
<!-- kv_send1_10_2&#45;&gt;ring_stage1_11_3 -->
<g id="edge1436" class="edge">
<title>kv_send1_10_2&#45;&gt;ring_stage1_11_3</title>
<path fill="none" stroke="black" d="M4956.5,-12699.4C4962,-12677.4 4969.94,-12645.64 4976.04,-12621.23"/>
<polygon fill="black" stroke="black" points="4979.5,-12621.82 4978.53,-12611.27 4972.71,-12620.13 4979.5,-12621.82"/>
</g>
<!-- kv_send1_10_3&#45;&gt;ring_stage1_11_4 -->
<g id="edge1439" class="edge">
<title>kv_send1_10_3&#45;&gt;ring_stage1_11_4</title>
<path fill="none" stroke="black" d="M5465.34,-12559.34C5502.69,-12535.89 5559.67,-12500.12 5600.45,-12474.52"/>
<polygon fill="black" stroke="black" points="5602.54,-12477.33 5609.15,-12469.05 5598.82,-12471.41 5602.54,-12477.33"/>
</g>
<!-- kv_send1_10_4&#45;&gt;ring_stage1_11_5 -->
<g id="edge1442" class="edge">
<title>kv_send1_10_4&#45;&gt;ring_stage1_11_5</title>
<path fill="none" stroke="black" d="M6173,-12415.4C6173,-12393.5 6173,-12361.93 6173,-12337.56"/>
<polygon fill="black" stroke="black" points="6176.5,-12337.27 6173,-12327.27 6169.5,-12337.27 6176.5,-12337.27"/>
</g>
<!-- kv_send1_10_5&#45;&gt;ring_stage1_11_6 -->
<g id="edge1445" class="edge">
<title>kv_send1_10_5&#45;&gt;ring_stage1_11_6</title>
<path fill="none" stroke="black" d="M6465.59,-12276.14C6485.63,-12266.45 6509.66,-12255.59 6532,-12247.41 6598.83,-12222.93 6675.65,-12201.63 6737.38,-12186.13"/>
<polygon fill="black" stroke="black" points="6738.3,-12189.51 6747.16,-12183.69 6736.61,-12182.71 6738.3,-12189.51"/>
</g>
<!-- kv_send1_10_6&#45;&gt;ring_stage1_11_7 -->
<g id="edge1448" class="edge">
<title>kv_send1_10_6&#45;&gt;ring_stage1_11_7</title>
<path fill="none" stroke="black" d="M7531.87,-12131.4C7537.69,-12109.4 7546.08,-12077.64 7552.53,-12053.23"/>
<polygon fill="black" stroke="black" points="7555.99,-12053.83 7555.16,-12043.27 7549.23,-12052.05 7555.99,-12053.83"/>
</g>
<!-- kv_send1_10_7&#45;&gt;ring_stage1_11_8 -->
<g id="edge1451" class="edge">
<title>kv_send1_10_7&#45;&gt;ring_stage1_11_8</title>
<path fill="none" stroke="black" d="M7636,-13764.61C7636,-13756.57 7636,-13747.6 7636,-13739.04"/>
<polygon fill="black" stroke="black" points="7639.5,-13738.9 7636,-13728.9 7632.5,-13738.9 7639.5,-13738.9"/>
</g>
<!-- kv_send1_10_8&#45;&gt;ring_stage1_11_9 -->
<g id="edge1454" class="edge">
<title>kv_send1_10_8&#45;&gt;ring_stage1_11_9</title>
<path fill="none" stroke="black" d="M7409,-13674.87C7409,-13666.83 7409,-13657.85 7409,-13649.3"/>
<polygon fill="black" stroke="black" points="7412.5,-13649.16 7409,-13639.16 7405.5,-13649.16 7412.5,-13649.16"/>
</g>
<!-- kv_send1_10_9&#45;&gt;ring_stage1_11_10 -->
<g id="edge1457" class="edge">
<title>kv_send1_10_9&#45;&gt;ring_stage1_11_10</title>
<path fill="none" stroke="black" d="M7164.4,-13585.13C7164.22,-13577.09 7164.01,-13568.11 7163.82,-13559.56"/>
<polygon fill="black" stroke="black" points="7167.31,-13559.34 7163.59,-13549.42 7160.31,-13559.5 7167.31,-13559.34"/>
</g>
<!-- kv_send1_10_10&#45;&gt;ring_stage1_11_11 -->
<g id="edge1460" class="edge">
<title>kv_send1_10_10&#45;&gt;ring_stage1_11_11</title>
<path fill="none" stroke="black" d="M6919.11,-13495.87C6917.24,-13487.66 6915.13,-13478.43 6913.13,-13469.65"/>
<polygon fill="black" stroke="black" points="6916.49,-13468.62 6910.85,-13459.64 6909.66,-13470.17 6916.49,-13468.62"/>
</g>
<!-- kv_send1_10_11&#45;&gt;ring_stage1_11_12 -->
<g id="edge1463" class="edge">
<title>kv_send1_10_11&#45;&gt;ring_stage1_11_12</title>
<path fill="none" stroke="black" d="M6673.3,-13405.65C6672.48,-13397.61 6671.55,-13388.63 6670.68,-13380.08"/>
<polygon fill="black" stroke="black" points="6674.14,-13379.53 6669.64,-13369.94 6667.18,-13380.24 6674.14,-13379.53"/>
</g>
<!-- kv_send1_10_12&#45;&gt;ring_stage1_11_13 -->
<g id="edge1466" class="edge">
<title>kv_send1_10_12&#45;&gt;ring_stage1_11_13</title>
<path fill="none" stroke="black" d="M6434.7,-13315.91C6433.69,-13307.87 6432.57,-13298.89 6431.49,-13290.34"/>
<polygon fill="black" stroke="black" points="6434.94,-13289.69 6430.22,-13280.2 6427.99,-13290.56 6434.94,-13289.69"/>
</g>
<!-- kv_send1_10_13&#45;&gt;ring_stage1_11_14 -->
<g id="edge1469" class="edge">
<title>kv_send1_10_13&#45;&gt;ring_stage1_11_14</title>
<path fill="none" stroke="black" d="M6174.6,-13226.17C6173.87,-13218.13 6173.05,-13209.15 6172.27,-13200.6"/>
<polygon fill="black" stroke="black" points="6175.74,-13200.1 6171.34,-13190.46 6168.77,-13200.74 6175.74,-13200.1"/>
</g>
<!-- kv_send1_10_14&#45;&gt;ring_stage1_11_15 -->
<g id="edge1472" class="edge">
<title>kv_send1_10_14&#45;&gt;ring_stage1_11_15</title>
<path fill="none" stroke="black" d="M5879.92,-13141.07C5849.6,-13129.94 5812.24,-13116.22 5779.43,-13104.18"/>
<polygon fill="black" stroke="black" points="5780.45,-13100.82 5769.86,-13100.66 5778.04,-13107.4 5780.45,-13100.82"/>
</g>
<!-- kv_send1_10_15&#45;&gt;ring_stage1_11_0 -->
<g id="edge1427" class="edge">
<title>kv_send1_10_15&#45;&gt;ring_stage1_11_0</title>
<path fill="none" stroke="black" d="M5186.53,-13053.54C5145.87,-13041.81 5093.38,-13026.66 5048.18,-13013.61"/>
<polygon fill="black" stroke="black" points="5048.93,-13010.19 5038.35,-13010.78 5046.99,-13016.91 5048.93,-13010.19"/>
</g>
<!-- kv_send1_11_0 -->
<g id="node1027" class="node">
<title>kv_send1_11_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4950" cy="-12868.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4950" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4950" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_11_0&#45;&gt;kv_send1_11_0 -->
<g id="edge1428" class="edge">
<title>ring_stage1_11_0&#45;&gt;kv_send1_11_0</title>
<path fill="none" stroke="black" d="M4950,-12957.72C4950,-12942.41 4950,-12922.69 4950,-12905.77"/>
<polygon fill="black" stroke="black" points="4953.5,-12905.67 4950,-12895.67 4946.5,-12905.67 4953.5,-12905.67"/>
</g>
<!-- ring_stage1_12_0 -->
<g id="node1043" class="node">
<title>ring_stage1_12_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5264.5,-12894.91 5071.5,-12894.91 5071.5,-12841.91 5264.5,-12841.91 5264.5,-12894.91"/>
<text text-anchor="middle" x="5168" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="5168" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_4×V_4</text>
<text text-anchor="middle" x="5168" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_11_0&#45;&gt;ring_stage1_12_0 -->
<g id="edge1474" class="edge">
<title>ring_stage1_11_0&#45;&gt;ring_stage1_12_0</title>
<path fill="none" stroke="black" d="M4998.92,-12957.72C5031.77,-12940.57 5075.19,-12917.88 5109.81,-12899.8"/>
<polygon fill="black" stroke="black" points="5111.62,-12902.81 5118.86,-12895.07 5108.38,-12896.6 5111.62,-12902.81"/>
</g>
<!-- kv_send1_11_1 -->
<g id="node1028" class="node">
<title>kv_send1_11_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4079" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4079" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4079" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_11_1&#45;&gt;kv_send1_11_1 -->
<g id="edge1431" class="edge">
<title>ring_stage1_11_1&#45;&gt;kv_send1_11_1</title>
<path fill="none" stroke="black" d="M4257.27,-12841.89C4220.05,-12817.99 4164.43,-12782.27 4125.23,-12757.1"/>
<polygon fill="black" stroke="black" points="4126.94,-12754.04 4116.64,-12751.58 4123.16,-12759.93 4126.94,-12754.04"/>
</g>
<!-- ring_stage1_12_1 -->
<g id="node1044" class="node">
<title>ring_stage1_12_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4604.5,-12752.91 4411.5,-12752.91 4411.5,-12699.91 4604.5,-12699.91 4604.5,-12752.91"/>
<text text-anchor="middle" x="4508" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="4508" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_5×V_5</text>
<text text-anchor="middle" x="4508" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_11_1&#45;&gt;ring_stage1_12_1 -->
<g id="edge1477" class="edge">
<title>ring_stage1_11_1&#45;&gt;ring_stage1_12_1</title>
<path fill="none" stroke="black" d="M4335.7,-12841.73C4370.95,-12818.34 4423.09,-12783.75 4460.78,-12758.74"/>
<polygon fill="black" stroke="black" points="4463.15,-12761.37 4469.54,-12752.92 4459.28,-12755.53 4463.15,-12761.37"/>
</g>
<!-- kv_send1_11_2 -->
<g id="node1029" class="node">
<title>kv_send1_11_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4297" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4297" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4297" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_11_2&#45;&gt;kv_send1_11_2 -->
<g id="edge1434" class="edge">
<title>ring_stage1_11_2&#45;&gt;kv_send1_11_2</title>
<path fill="none" stroke="black" d="M4297,-12699.73C4297,-12677.76 4297,-12645.91 4297,-12621.4"/>
<polygon fill="black" stroke="black" points="4300.5,-12621.4 4297,-12611.4 4293.5,-12621.4 4300.5,-12621.4"/>
</g>
<!-- ring_stage1_12_2 -->
<g id="node1045" class="node">
<title>ring_stage1_12_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4175.5,-12610.91 3982.5,-12610.91 3982.5,-12557.91 4175.5,-12557.91 4175.5,-12610.91"/>
<text text-anchor="middle" x="4079" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="4079" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_6×V_6</text>
<text text-anchor="middle" x="4079" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_11_2&#45;&gt;ring_stage1_12_2 -->
<g id="edge1480" class="edge">
<title>ring_stage1_11_2&#45;&gt;ring_stage1_12_2</title>
<path fill="none" stroke="black" d="M4257.27,-12699.89C4220.73,-12676.43 4166.47,-12641.58 4127.41,-12616.5"/>
<polygon fill="black" stroke="black" points="4129.13,-12613.44 4118.83,-12610.98 4125.35,-12619.33 4129.13,-12613.44"/>
</g>
<!-- kv_send1_11_3 -->
<g id="node1030" class="node">
<title>kv_send1_11_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5429" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5429" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5429" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_11_3&#45;&gt;kv_send1_11_3 -->
<g id="edge1437" class="edge">
<title>ring_stage1_11_3&#45;&gt;kv_send1_11_3</title>
<path fill="none" stroke="black" d="M5029.7,-12557.85C5048.16,-12548.27 5070.11,-12538.09 5091,-12531.41 5184.95,-12501.36 5215.41,-12523.37 5310,-12495.41 5331.56,-12489.03 5354.38,-12479.74 5374.2,-12470.76"/>
<polygon fill="black" stroke="black" points="5375.76,-12473.9 5383.38,-12466.53 5372.83,-12467.54 5375.76,-12473.9"/>
</g>
<!-- ring_stage1_12_3 -->
<g id="node1046" class="node">
<title>ring_stage1_12_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5089.5,-12468.91 4896.5,-12468.91 4896.5,-12415.91 5089.5,-12415.91 5089.5,-12468.91"/>
<text text-anchor="middle" x="4993" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="4993" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_7×V_7</text>
<text text-anchor="middle" x="4993" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_11_3&#45;&gt;ring_stage1_12_3 -->
<g id="edge1483" class="edge">
<title>ring_stage1_11_3&#45;&gt;ring_stage1_12_3</title>
<path fill="none" stroke="black" d="M4986.47,-12557.73C4987.73,-12535.63 4989.57,-12503.51 4990.97,-12478.94"/>
<polygon fill="black" stroke="black" points="4994.47,-12479.11 4991.54,-12468.92 4987.48,-12478.71 4994.47,-12479.11"/>
</g>
<!-- kv_send1_11_4 -->
<g id="node1031" class="node">
<title>kv_send1_11_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5735" cy="-12300.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5735" y="-12304.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5735" y="-12289.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_11_4&#45;&gt;kv_send1_11_4 -->
<g id="edge1440" class="edge">
<title>ring_stage1_11_4&#45;&gt;kv_send1_11_4</title>
<path fill="none" stroke="black" d="M5665.59,-12415.73C5679.16,-12393.37 5698.96,-12360.77 5713.94,-12336.09"/>
<polygon fill="black" stroke="black" points="5717.02,-12337.76 5719.22,-12327.4 5711.04,-12334.13 5717.02,-12337.76"/>
</g>
<!-- ring_stage1_12_4 -->
<g id="node1047" class="node">
<title>ring_stage1_12_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5613.5,-12326.91 5420.5,-12326.91 5420.5,-12273.91 5613.5,-12273.91 5613.5,-12326.91"/>
<text text-anchor="middle" x="5517" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="5517" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_8×V_8</text>
<text text-anchor="middle" x="5517" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_11_4&#45;&gt;ring_stage1_12_4 -->
<g id="edge1486" class="edge">
<title>ring_stage1_11_4&#45;&gt;ring_stage1_12_4</title>
<path fill="none" stroke="black" d="M5625.61,-12415.73C5603.86,-12392.84 5571.9,-12359.2 5548.28,-12334.34"/>
<polygon fill="black" stroke="black" points="5550.66,-12331.76 5541.24,-12326.92 5545.59,-12336.58 5550.66,-12331.76"/>
</g>
<!-- kv_send1_11_5 -->
<g id="node1032" class="node">
<title>kv_send1_11_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6513" cy="-12158.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6513" y="-12162.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6513" y="-12147.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_11_5&#45;&gt;kv_send1_11_5 -->
<g id="edge1443" class="edge">
<title>ring_stage1_11_5&#45;&gt;kv_send1_11_5</title>
<path fill="none" stroke="black" d="M6234.97,-12273.89C6295.96,-12248.77 6388.65,-12210.61 6450,-12185.35"/>
<polygon fill="black" stroke="black" points="6451.65,-12188.45 6459.57,-12181.41 6448.99,-12181.98 6451.65,-12188.45"/>
</g>
<!-- ring_stage1_12_5 -->
<g id="node1048" class="node">
<title>ring_stage1_12_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6269.5,-12184.91 6076.5,-12184.91 6076.5,-12131.91 6269.5,-12131.91 6269.5,-12184.91"/>
<text text-anchor="middle" x="6173" y="-12169.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="6173" y="-12154.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_9×V_9</text>
<text text-anchor="middle" x="6173" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_11_5&#45;&gt;ring_stage1_12_5 -->
<g id="edge1489" class="edge">
<title>ring_stage1_11_5&#45;&gt;ring_stage1_12_5</title>
<path fill="none" stroke="black" d="M6173,-12273.73C6173,-12251.63 6173,-12219.51 6173,-12194.94"/>
<polygon fill="black" stroke="black" points="6176.5,-12194.92 6173,-12184.92 6169.5,-12194.92 6176.5,-12194.92"/>
</g>
<!-- kv_send1_11_6 -->
<g id="node1033" class="node">
<title>kv_send1_11_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7335" cy="-12016.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7335" y="-12020.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="7335" y="-12005.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_11_6&#45;&gt;kv_send1_11_6 -->
<g id="edge1446" class="edge">
<title>ring_stage1_11_6&#45;&gt;kv_send1_11_6</title>
<path fill="none" stroke="black" d="M6903.5,-12131.83C6923,-12122.63 6945.71,-12112.73 6967,-12105.41 7058.55,-12073.91 7166.66,-12049.51 7241.92,-12034.48"/>
<polygon fill="black" stroke="black" points="7242.72,-12037.89 7251.85,-12032.51 7241.36,-12031.02 7242.72,-12037.89"/>
</g>
<!-- ring_stage1_12_6 -->
<g id="node1049" class="node">
<title>ring_stage1_12_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6996.5,-12042.91 6785.5,-12042.91 6785.5,-11989.91 6996.5,-11989.91 6996.5,-12042.91"/>
<text text-anchor="middle" x="6891" y="-12027.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="6891" y="-12012.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_10×V_10</text>
<text text-anchor="middle" x="6891" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_11_6&#45;&gt;ring_stage1_12_6 -->
<g id="edge1492" class="edge">
<title>ring_stage1_11_6&#45;&gt;ring_stage1_12_6</title>
<path fill="none" stroke="black" d="M6859.97,-12131.73C6866,-12109.53 6874.76,-12077.22 6881.44,-12052.61"/>
<polygon fill="black" stroke="black" points="6884.83,-12053.49 6884.07,-12042.92 6878.08,-12051.66 6884.83,-12053.49"/>
</g>
<!-- kv_send1_11_7 -->
<g id="node1034" class="node">
<title>kv_send1_11_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7565" cy="-11874.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7565" y="-11878.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7565" y="-11863.21" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_11_7&#45;&gt;kv_send1_11_7 -->
<g id="edge1449" class="edge">
<title>ring_stage1_11_7&#45;&gt;kv_send1_11_7</title>
<path fill="none" stroke="black" d="M7562.55,-11989.73C7563.02,-11967.76 7563.7,-11935.91 7564.23,-11911.4"/>
<polygon fill="black" stroke="black" points="7567.73,-11911.47 7564.44,-11901.4 7560.73,-11911.32 7567.73,-11911.47"/>
</g>
<!-- ring_stage1_12_7 -->
<g id="node1050" class="node">
<title>ring_stage1_12_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7443.5,-11900.91 7232.5,-11900.91 7232.5,-11847.91 7443.5,-11847.91 7443.5,-11900.91"/>
<text text-anchor="middle" x="7338" y="-11885.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="7338" y="-11870.71" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_11×V_11</text>
<text text-anchor="middle" x="7338" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_11_7&#45;&gt;ring_stage1_12_7 -->
<g id="edge1495" class="edge">
<title>ring_stage1_11_7&#45;&gt;ring_stage1_12_7</title>
<path fill="none" stroke="black" d="M7521.18,-11989.89C7483.56,-11966.38 7427.64,-11931.43 7387.49,-11906.34"/>
<polygon fill="black" stroke="black" points="7389.26,-11903.32 7378.92,-11900.98 7385.55,-11909.25 7389.26,-11903.32"/>
</g>
<!-- kv_send1_11_8 -->
<g id="node1035" class="node">
<title>kv_send1_11_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7636" cy="-13612.46" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7636" y="-13616.26" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7636" y="-13601.26" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_11_8&#45;&gt;kv_send1_11_8 -->
<g id="edge1452" class="edge">
<title>ring_stage1_11_8&#45;&gt;kv_send1_11_8</title>
<path fill="none" stroke="black" d="M7636,-13675.35C7636,-13667.3 7636,-13658.27 7636,-13649.65"/>
<polygon fill="black" stroke="black" points="7639.5,-13649.43 7636,-13639.43 7632.5,-13649.43 7639.5,-13649.43"/>
</g>
<!-- ring_stage1_12_8 -->
<g id="node1051" class="node">
<title>ring_stage1_12_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7765.5,-11758.91 7554.5,-11758.91 7554.5,-11705.91 7765.5,-11705.91 7765.5,-11758.91"/>
<text text-anchor="middle" x="7660" y="-11743.71" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="7660" y="-11728.71" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_12×V_12</text>
<text text-anchor="middle" x="7660" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_11_8&#45;&gt;ring_stage1_12_8 -->
<g id="edge1498" class="edge">
<title>ring_stage1_11_8&#45;&gt;ring_stage1_12_8</title>
<path fill="none" stroke="black" d="M7704.74,-13675.65C7721.16,-13666.52 7737.07,-13654.59 7748,-13639.33 7748.74,-13638.3 7875.89,-12922.67 7876,-12921.41 7885.71,-12811.61 7921,-12774.03 7876,-12673.41 7863.89,-12646.33 7689.11,-12522.49 7677,-12495.41 7677,-12495.41 7677,-11821.41 7677,-11821.41 7675.33,-11804 7671.85,-11784.92 7668.47,-11768.98"/>
<polygon fill="black" stroke="black" points="7671.85,-11768.04 7666.29,-11759.02 7665.01,-11769.54 7671.85,-11768.04"/>
</g>
<!-- kv_send1_11_9 -->
<g id="node1036" class="node">
<title>kv_send1_11_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7401" cy="-13522.72" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7401" y="-13526.52" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="7401" y="-13511.52" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_11_9&#45;&gt;kv_send1_11_9 -->
<g id="edge1455" class="edge">
<title>ring_stage1_11_9&#45;&gt;kv_send1_11_9</title>
<path fill="none" stroke="black" d="M7406.64,-13585.61C7405.91,-13577.56 7405.09,-13568.53 7404.3,-13559.91"/>
<polygon fill="black" stroke="black" points="7407.76,-13559.33 7403.37,-13549.69 7400.79,-13559.96 7407.76,-13559.33"/>
</g>
<!-- ring_stage1_12_9 -->
<g id="node1052" class="node">
<title>ring_stage1_12_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7739.5,-13549.22 7528.5,-13549.22 7528.5,-13496.22 7739.5,-13496.22 7739.5,-13549.22"/>
<text text-anchor="middle" x="7634" y="-13534.02" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="7634" y="-13519.02" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_13×V_13</text>
<text text-anchor="middle" x="7634" y="-13504.02" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_11_9&#45;&gt;ring_stage1_12_9 -->
<g id="edge1501" class="edge">
<title>ring_stage1_11_9&#45;&gt;ring_stage1_12_9</title>
<path fill="none" stroke="black" d="M7474.68,-13585.84C7501.02,-13575.57 7531.53,-13563.68 7558.75,-13553.06"/>
<polygon fill="black" stroke="black" points="7560.19,-13556.26 7568.23,-13549.36 7557.65,-13549.74 7560.19,-13556.26"/>
</g>
<!-- kv_send1_11_10 -->
<g id="node1037" class="node">
<title>kv_send1_11_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7134" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7134" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="7134" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_11_10&#45;&gt;kv_send1_11_10 -->
<g id="edge1458" class="edge">
<title>ring_stage1_11_10&#45;&gt;kv_send1_11_10</title>
<path fill="none" stroke="black" d="M7154.46,-13495.87C7151.74,-13487.64 7148.68,-13478.39 7145.77,-13469.6"/>
<polygon fill="black" stroke="black" points="7149.04,-13468.34 7142.58,-13459.95 7142.4,-13470.54 7149.04,-13468.34"/>
</g>
<!-- ring_stage1_12_10 -->
<g id="node1053" class="node">
<title>ring_stage1_12_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7482,-13459.48 7262,-13459.48 7262,-13406.48 7482,-13406.48 7482,-13459.48"/>
<text text-anchor="middle" x="7372" y="-13444.28" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="7372" y="-13429.28" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_14×V_14</text>
<text text-anchor="middle" x="7372" y="-13414.28" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_11_10&#45;&gt;ring_stage1_12_10 -->
<g id="edge1504" class="edge">
<title>ring_stage1_11_10&#45;&gt;ring_stage1_12_10</title>
<path fill="none" stroke="black" d="M7224.01,-13496.1C7248.27,-13485.92 7276.32,-13474.14 7301.44,-13463.6"/>
<polygon fill="black" stroke="black" points="7303.05,-13466.72 7310.91,-13459.62 7300.34,-13460.27 7303.05,-13466.72"/>
</g>
<!-- kv_send1_11_11 -->
<g id="node1038" class="node">
<title>kv_send1_11_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6896" cy="-13343.24" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6896" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="6896" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_11_11&#45;&gt;kv_send1_11_11 -->
<g id="edge1461" class="edge">
<title>ring_stage1_11_11&#45;&gt;kv_send1_11_11</title>
<path fill="none" stroke="black" d="M6902.35,-13406.13C6901.52,-13398.08 6900.6,-13389.05 6899.71,-13380.43"/>
<polygon fill="black" stroke="black" points="6903.17,-13379.8 6898.66,-13370.21 6896.2,-13380.51 6903.17,-13379.8"/>
</g>
<!-- ring_stage1_12_11 -->
<g id="node1054" class="node">
<title>ring_stage1_12_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7244,-13369.74 7024,-13369.74 7024,-13316.74 7244,-13316.74 7244,-13369.74"/>
<text text-anchor="middle" x="7134" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="7134" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_15×V_15</text>
<text text-anchor="middle" x="7134" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_11_11&#45;&gt;ring_stage1_12_11 -->
<g id="edge1507" class="edge">
<title>ring_stage1_11_11&#45;&gt;ring_stage1_12_11</title>
<path fill="none" stroke="black" d="M6971.85,-13406.36C6998.66,-13396.09 7029.71,-13384.2 7057.42,-13373.58"/>
<polygon fill="black" stroke="black" points="7058.98,-13376.73 7067.07,-13369.88 7056.47,-13370.19 7058.98,-13376.73"/>
</g>
<!-- kv_send1_11_12 -->
<g id="node1039" class="node">
<title>kv_send1_11_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6656" cy="-13253.5" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6656" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="6656" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_11_12&#45;&gt;kv_send1_11_12 -->
<g id="edge1464" class="edge">
<title>ring_stage1_11_12&#45;&gt;kv_send1_11_12</title>
<path fill="none" stroke="black" d="M6663.76,-13316.39C6662.74,-13308.25 6661.59,-13299.11 6660.5,-13290.4"/>
<polygon fill="black" stroke="black" points="6663.97,-13289.95 6659.26,-13280.47 6657.03,-13290.82 6663.97,-13289.95"/>
</g>
<!-- ring_stage1_12_12 -->
<g id="node1055" class="node">
<title>ring_stage1_12_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6986,-13280 6784,-13280 6784,-13227 6986,-13227 6986,-13280"/>
<text text-anchor="middle" x="6885" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="6885" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_0×V_0</text>
<text text-anchor="middle" x="6885" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_11_12&#45;&gt;ring_stage1_12_12 -->
<g id="edge1510" class="edge">
<title>ring_stage1_11_12&#45;&gt;ring_stage1_12_12</title>
<path fill="none" stroke="black" d="M6730.64,-13316.62C6756.05,-13306.4 6785.46,-13294.56 6811.75,-13283.98"/>
<polygon fill="black" stroke="black" points="6813.31,-13287.12 6821.28,-13280.14 6810.7,-13280.63 6813.31,-13287.12"/>
</g>
<!-- kv_send1_11_13 -->
<g id="node1040" class="node">
<title>kv_send1_11_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6418" cy="-13163.76" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6418" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6418" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_11_13&#45;&gt;kv_send1_11_13 -->
<g id="edge1467" class="edge">
<title>ring_stage1_11_13&#45;&gt;kv_send1_11_13</title>
<path fill="none" stroke="black" d="M6424.35,-13226.65C6423.52,-13218.6 6422.6,-13209.57 6421.71,-13200.95"/>
<polygon fill="black" stroke="black" points="6425.17,-13200.32 6420.66,-13190.73 6418.2,-13201.03 6425.17,-13200.32"/>
</g>
<!-- ring_stage1_12_13 -->
<g id="node1056" class="node">
<title>ring_stage1_12_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6748,-13190.26 6546,-13190.26 6546,-13137.26 6748,-13137.26 6748,-13190.26"/>
<text text-anchor="middle" x="6647" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="6647" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_1×V_1</text>
<text text-anchor="middle" x="6647" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_11_13&#45;&gt;ring_stage1_12_13 -->
<g id="edge1513" class="edge">
<title>ring_stage1_11_13&#45;&gt;ring_stage1_12_13</title>
<path fill="none" stroke="black" d="M6491.22,-13226.88C6516.87,-13216.66 6546.55,-13204.82 6573.08,-13194.24"/>
<polygon fill="black" stroke="black" points="6574.7,-13197.36 6582.7,-13190.4 6572.11,-13190.86 6574.7,-13197.36"/>
</g>
<!-- kv_send1_11_14 -->
<g id="node1041" class="node">
<title>kv_send1_11_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6158" cy="-13074.02" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6158" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6158" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_11_14&#45;&gt;kv_send1_11_14 -->
<g id="edge1470" class="edge">
<title>ring_stage1_11_14&#45;&gt;kv_send1_11_14</title>
<path fill="none" stroke="black" d="M6165.76,-13136.91C6164.74,-13128.77 6163.59,-13119.63 6162.5,-13110.92"/>
<polygon fill="black" stroke="black" points="6165.97,-13110.47 6161.26,-13100.99 6159.03,-13111.34 6165.97,-13110.47"/>
</g>
<!-- ring_stage1_12_14 -->
<g id="node1057" class="node">
<title>ring_stage1_12_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6488,-13100.52 6286,-13100.52 6286,-13047.52 6488,-13047.52 6488,-13100.52"/>
<text text-anchor="middle" x="6387" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="6387" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_2×V_2</text>
<text text-anchor="middle" x="6387" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_11_14&#45;&gt;ring_stage1_12_14 -->
<g id="edge1516" class="edge">
<title>ring_stage1_11_14&#45;&gt;ring_stage1_12_14</title>
<path fill="none" stroke="black" d="M6232.64,-13137.14C6258.05,-13126.92 6287.46,-13115.08 6313.75,-13104.5"/>
<polygon fill="black" stroke="black" points="6315.31,-13107.64 6323.28,-13100.66 6312.7,-13101.15 6315.31,-13107.64"/>
</g>
<!-- kv_send1_11_15 -->
<g id="node1042" class="node">
<title>kv_send1_11_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5168" cy="-12984.28" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5168" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5168" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_11_15&#45;&gt;kv_send1_11_15 -->
<g id="edge1473" class="edge">
<title>ring_stage1_11_15&#45;&gt;kv_send1_11_15</title>
<path fill="none" stroke="black" d="M5598.8,-13048.75C5595.84,-13048.19 5592.9,-13047.65 5590,-13047.15 5453.37,-13023.23 5416.67,-13034.79 5280,-13011.15 5270.49,-13009.5 5260.57,-13007.55 5250.74,-13005.48"/>
<polygon fill="black" stroke="black" points="5251.47,-13002.05 5240.96,-13003.36 5250,-13008.9 5251.47,-13002.05"/>
</g>
<!-- ring_stage1_12_15 -->
<g id="node1058" class="node">
<title>ring_stage1_12_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5945,-13010.78 5743,-13010.78 5743,-12957.78 5945,-12957.78 5945,-13010.78"/>
<text text-anchor="middle" x="5844" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="5844" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_3×V_3</text>
<text text-anchor="middle" x="5844" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_11_15&#45;&gt;ring_stage1_12_15 -->
<g id="edge1519" class="edge">
<title>ring_stage1_11_15&#45;&gt;ring_stage1_12_15</title>
<path fill="none" stroke="black" d="M5742.04,-13047.4C5758.01,-13037.67 5776.39,-13026.47 5793.1,-13016.29"/>
<polygon fill="black" stroke="black" points="5794.94,-13019.27 5801.66,-13011.07 5791.3,-13013.29 5794.94,-13019.27"/>
</g>
<!-- kv_send1_11_0&#45;&gt;ring_stage1_12_1 -->
<g id="edge1478" class="edge">
<title>kv_send1_11_0&#45;&gt;ring_stage1_12_1</title>
<path fill="none" stroke="black" d="M4906.69,-12843.89C4886.35,-12833.75 4861.47,-12822.59 4838,-12815.41 4741.58,-12785.9 4710.1,-12809.95 4614,-12779.41 4596.53,-12773.85 4578.32,-12765.83 4562.03,-12757.75"/>
<polygon fill="black" stroke="black" points="4563.18,-12754.41 4552.68,-12753 4560.01,-12760.65 4563.18,-12754.41"/>
</g>
<!-- kv_send1_11_1&#45;&gt;ring_stage1_12_2 -->
<g id="edge1481" class="edge">
<title>kv_send1_11_1&#45;&gt;ring_stage1_12_2</title>
<path fill="none" stroke="black" d="M4079,-12699.4C4079,-12677.5 4079,-12645.93 4079,-12621.56"/>
<polygon fill="black" stroke="black" points="4082.5,-12621.27 4079,-12611.27 4075.5,-12621.27 4082.5,-12621.27"/>
</g>
<!-- kv_send1_11_2&#45;&gt;ring_stage1_12_3 -->
<g id="edge1484" class="edge">
<title>kv_send1_11_2&#45;&gt;ring_stage1_12_3</title>
<path fill="none" stroke="black" d="M4338.47,-12559.79C4359.03,-12549.23 4384.62,-12537.76 4409,-12531.41 4615.16,-12477.68 4681.43,-12551.33 4887,-12495.41 4905.44,-12490.39 4924.51,-12482.13 4941.3,-12473.65"/>
<polygon fill="black" stroke="black" points="4943.12,-12476.66 4950.38,-12468.94 4939.89,-12470.44 4943.12,-12476.66"/>
</g>
<!-- kv_send1_11_3&#45;&gt;ring_stage1_12_4 -->
<g id="edge1487" class="edge">
<title>kv_send1_11_3&#45;&gt;ring_stage1_12_4</title>
<path fill="none" stroke="black" d="M5445.14,-12415.73C5459.28,-12393.23 5479.95,-12360.36 5495.49,-12335.63"/>
<polygon fill="black" stroke="black" points="5498.6,-12337.25 5500.96,-12326.92 5492.68,-12333.53 5498.6,-12337.25"/>
</g>
<!-- kv_send1_11_4&#45;&gt;ring_stage1_12_5 -->
<g id="edge1490" class="edge">
<title>kv_send1_11_4&#45;&gt;ring_stage1_12_5</title>
<path fill="none" stroke="black" d="M5779.73,-12276.12C5800.14,-12266.21 5824.86,-12255.17 5848,-12247.41 5918.75,-12223.67 5939.97,-12230.9 6012,-12211.41 6037.28,-12204.57 6064.48,-12196.18 6089.2,-12188.16"/>
<polygon fill="black" stroke="black" points="6090.48,-12191.42 6098.9,-12184.99 6088.31,-12184.77 6090.48,-12191.42"/>
</g>
<!-- kv_send1_11_5&#45;&gt;ring_stage1_12_6 -->
<g id="edge1493" class="edge">
<title>kv_send1_11_5&#45;&gt;ring_stage1_12_6</title>
<path fill="none" stroke="black" d="M6578.51,-12137.53C6632.12,-12120.77 6709.66,-12095.43 6776,-12069.41 6793.13,-12062.69 6811.39,-12054.79 6828.2,-12047.2"/>
<polygon fill="black" stroke="black" points="6829.72,-12050.35 6837.37,-12043.02 6826.82,-12043.98 6829.72,-12050.35"/>
</g>
<!-- kv_send1_11_6&#45;&gt;ring_stage1_12_7 -->
<g id="edge1496" class="edge">
<title>kv_send1_11_6&#45;&gt;ring_stage1_12_7</title>
<path fill="none" stroke="black" d="M7335.56,-11989.4C7336.03,-11967.5 7336.7,-11935.93 7337.23,-11911.56"/>
<polygon fill="black" stroke="black" points="7340.73,-11911.35 7337.45,-11901.27 7333.73,-11911.2 7340.73,-11911.35"/>
</g>
<!-- kv_send1_11_7&#45;&gt;ring_stage1_12_8 -->
<g id="edge1499" class="edge">
<title>kv_send1_11_7&#45;&gt;ring_stage1_12_8</title>
<path fill="none" stroke="black" d="M7582.42,-11847.73C7597.76,-11825.13 7620.19,-11792.07 7637,-11767.3"/>
<polygon fill="black" stroke="black" points="7639.97,-11769.16 7642.69,-11758.92 7634.17,-11765.23 7639.97,-11769.16"/>
</g>
<!-- kv_send1_11_8&#45;&gt;ring_stage1_12_9 -->
<g id="edge1502" class="edge">
<title>kv_send1_11_8&#45;&gt;ring_stage1_12_9</title>
<path fill="none" stroke="black" d="M7635.4,-13585.13C7635.22,-13577.09 7635.01,-13568.11 7634.82,-13559.56"/>
<polygon fill="black" stroke="black" points="7638.31,-13559.34 7634.59,-13549.42 7631.31,-13559.5 7638.31,-13559.34"/>
</g>
<!-- kv_send1_11_9&#45;&gt;ring_stage1_12_10 -->
<g id="edge1505" class="edge">
<title>kv_send1_11_9&#45;&gt;ring_stage1_12_10</title>
<path fill="none" stroke="black" d="M7392.46,-13495.87C7389.71,-13487.57 7386.62,-13478.22 7383.7,-13469.36"/>
<polygon fill="black" stroke="black" points="7386.94,-13468.04 7380.48,-13459.64 7380.3,-13470.24 7386.94,-13468.04"/>
</g>
<!-- kv_send1_11_10&#45;&gt;ring_stage1_12_11 -->
<g id="edge1508" class="edge">
<title>kv_send1_11_10&#45;&gt;ring_stage1_12_11</title>
<path fill="none" stroke="black" d="M7134,-13405.65C7134,-13397.61 7134,-13388.63 7134,-13380.08"/>
<polygon fill="black" stroke="black" points="7137.5,-13379.94 7134,-13369.94 7130.5,-13379.94 7137.5,-13379.94"/>
</g>
<!-- kv_send1_11_11&#45;&gt;ring_stage1_12_12 -->
<g id="edge1511" class="edge">
<title>kv_send1_11_11&#45;&gt;ring_stage1_12_12</title>
<path fill="none" stroke="black" d="M6892.7,-13315.91C6891.69,-13307.87 6890.57,-13298.89 6889.49,-13290.34"/>
<polygon fill="black" stroke="black" points="6892.94,-13289.69 6888.22,-13280.2 6885.99,-13290.56 6892.94,-13289.69"/>
</g>
<!-- kv_send1_11_12&#45;&gt;ring_stage1_12_13 -->
<g id="edge1514" class="edge">
<title>kv_send1_11_12&#45;&gt;ring_stage1_12_13</title>
<path fill="none" stroke="black" d="M6653.3,-13226.17C6652.48,-13218.13 6651.55,-13209.15 6650.68,-13200.6"/>
<polygon fill="black" stroke="black" points="6654.14,-13200.05 6649.64,-13190.46 6647.18,-13200.76 6654.14,-13200.05"/>
</g>
<!-- kv_send1_11_13&#45;&gt;ring_stage1_12_14 -->
<g id="edge1517" class="edge">
<title>kv_send1_11_13&#45;&gt;ring_stage1_12_14</title>
<path fill="none" stroke="black" d="M6408.87,-13136.91C6405.9,-13128.52 6402.56,-13119.06 6399.4,-13110.12"/>
<polygon fill="black" stroke="black" points="6402.7,-13108.95 6396.07,-13100.68 6396.1,-13111.28 6402.7,-13108.95"/>
</g>
<!-- kv_send1_11_14&#45;&gt;ring_stage1_12_15 -->
<g id="edge1520" class="edge">
<title>kv_send1_11_14&#45;&gt;ring_stage1_12_15</title>
<path fill="none" stroke="black" d="M6087.53,-13053.33C6045.58,-13041.6 5991.65,-13026.53 5945.2,-13013.56"/>
<polygon fill="black" stroke="black" points="5945.99,-13010.14 5935.41,-13010.82 5944.1,-13016.88 5945.99,-13010.14"/>
</g>
<!-- kv_send1_11_15&#45;&gt;ring_stage1_12_0 -->
<g id="edge1475" class="edge">
<title>kv_send1_11_15&#45;&gt;ring_stage1_12_0</title>
<path fill="none" stroke="black" d="M5168,-12957.15C5168,-12941.71 5168,-12921.94 5168,-12905.08"/>
<polygon fill="black" stroke="black" points="5171.5,-12905.02 5168,-12895.02 5164.5,-12905.02 5171.5,-12905.02"/>
</g>
<!-- kv_send1_12_0 -->
<g id="node1059" class="node">
<title>kv_send1_12_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4726" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4726" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="4726" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_12_0&#45;&gt;kv_send1_12_0 -->
<g id="edge1476" class="edge">
<title>ring_stage1_12_0&#45;&gt;kv_send1_12_0</title>
<path fill="none" stroke="black" d="M5123.32,-12841.82C5104.85,-12832.22 5082.9,-12822.05 5062,-12815.41 4965.9,-12784.87 4934.42,-12808.92 4838,-12779.41 4817.92,-12773.26 4796.81,-12764.21 4778.4,-12755.37"/>
<polygon fill="black" stroke="black" points="4779.83,-12752.17 4769.31,-12750.92 4776.76,-12758.46 4779.83,-12752.17"/>
</g>
<!-- ring_stage1_13_0 -->
<g id="node1075" class="node">
<title>ring_stage1_13_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5700.5,-12752.91 5507.5,-12752.91 5507.5,-12699.91 5700.5,-12699.91 5700.5,-12752.91"/>
<text text-anchor="middle" x="5604" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="5604" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_3×V_3</text>
<text text-anchor="middle" x="5604" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_12_0&#45;&gt;ring_stage1_13_0 -->
<g id="edge1522" class="edge">
<title>ring_stage1_12_0&#45;&gt;ring_stage1_13_0</title>
<path fill="none" stroke="black" d="M5212.68,-12841.82C5231.15,-12832.22 5253.1,-12822.05 5274,-12815.41 5370.1,-12784.87 5401.9,-12809.95 5498,-12779.41 5515.47,-12773.85 5533.68,-12765.83 5549.97,-12757.75"/>
<polygon fill="black" stroke="black" points="5551.99,-12760.65 5559.32,-12753 5548.82,-12754.41 5551.99,-12760.65"/>
</g>
<!-- kv_send1_12_1 -->
<g id="node1060" class="node">
<title>kv_send1_12_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4521" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4521" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4521" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_12_1&#45;&gt;kv_send1_12_1 -->
<g id="edge1479" class="edge">
<title>ring_stage1_12_1&#45;&gt;kv_send1_12_1</title>
<path fill="none" stroke="black" d="M4510.38,-12699.73C4512.42,-12677.76 4515.38,-12645.91 4517.66,-12621.4"/>
<polygon fill="black" stroke="black" points="4521.15,-12621.68 4518.59,-12611.4 4514.18,-12621.03 4521.15,-12621.68"/>
</g>
<!-- ring_stage1_13_1 -->
<g id="node1076" class="node">
<title>ring_stage1_13_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4835.5,-12610.91 4642.5,-12610.91 4642.5,-12557.91 4835.5,-12557.91 4835.5,-12610.91"/>
<text text-anchor="middle" x="4739" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="4739" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_4×V_4</text>
<text text-anchor="middle" x="4739" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_12_1&#45;&gt;ring_stage1_13_1 -->
<g id="edge1525" class="edge">
<title>ring_stage1_12_1&#45;&gt;ring_stage1_13_1</title>
<path fill="none" stroke="black" d="M4550.1,-12699.89C4588.98,-12676.33 4646.8,-12641.29 4688.22,-12616.18"/>
<polygon fill="black" stroke="black" points="4690.06,-12619.16 4696.8,-12610.98 4686.43,-12613.17 4690.06,-12619.16"/>
</g>
<!-- kv_send1_12_2 -->
<g id="node1061" class="node">
<title>kv_send1_12_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4775" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4775" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4775" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_12_2&#45;&gt;kv_send1_12_2 -->
<g id="edge1482" class="edge">
<title>ring_stage1_12_2&#45;&gt;kv_send1_12_2</title>
<path fill="none" stroke="black" d="M4121.62,-12557.87C4140.41,-12547.85 4163.14,-12537.35 4185,-12531.41 4390.57,-12475.48 4456.84,-12549.13 4663,-12495.41 4683.95,-12489.95 4705.8,-12480.71 4724.57,-12471.51"/>
<polygon fill="black" stroke="black" points="4726.16,-12474.63 4733.53,-12467.02 4723.02,-12468.38 4726.16,-12474.63"/>
</g>
<!-- ring_stage1_13_2 -->
<g id="node1077" class="node">
<title>ring_stage1_13_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4429.5,-12468.91 4236.5,-12468.91 4236.5,-12415.91 4429.5,-12415.91 4429.5,-12468.91"/>
<text text-anchor="middle" x="4333" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="4333" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_5×V_5</text>
<text text-anchor="middle" x="4333" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_12_2&#45;&gt;ring_stage1_13_2 -->
<g id="edge1528" class="edge">
<title>ring_stage1_12_2&#45;&gt;ring_stage1_13_2</title>
<path fill="none" stroke="black" d="M4125.29,-12557.89C4168.22,-12534.23 4232.15,-12498.99 4277.74,-12473.87"/>
<polygon fill="black" stroke="black" points="4279.53,-12476.88 4286.6,-12468.98 4276.15,-12470.75 4279.53,-12476.88"/>
</g>
<!-- kv_send1_12_3 -->
<g id="node1062" class="node">
<title>kv_send1_12_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5299" cy="-12300.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5299" y="-12304.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5299" y="-12289.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_12_3&#45;&gt;kv_send1_12_3 -->
<g id="edge1485" class="edge">
<title>ring_stage1_12_3&#45;&gt;kv_send1_12_3</title>
<path fill="none" stroke="black" d="M5043.37,-12415.88C5060.87,-12407.23 5080.69,-12397.68 5099,-12389.41 5137.14,-12372.18 5147.65,-12370.16 5186,-12353.41 5203.95,-12345.57 5223.37,-12336.75 5240.96,-12328.64"/>
<polygon fill="black" stroke="black" points="5242.91,-12331.59 5250.52,-12324.22 5239.97,-12325.24 5242.91,-12331.59"/>
</g>
<!-- ring_stage1_13_3 -->
<g id="node1078" class="node">
<title>ring_stage1_13_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4949.5,-12326.91 4756.5,-12326.91 4756.5,-12273.91 4949.5,-12273.91 4949.5,-12326.91"/>
<text text-anchor="middle" x="4853" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="4853" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_6×V_6</text>
<text text-anchor="middle" x="4853" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_12_3&#45;&gt;ring_stage1_13_3 -->
<g id="edge1531" class="edge">
<title>ring_stage1_12_3&#45;&gt;ring_stage1_13_3</title>
<path fill="none" stroke="black" d="M4967.32,-12415.73C4944.33,-12392.74 4910.5,-12358.91 4885.61,-12334.01"/>
<polygon fill="black" stroke="black" points="4888.06,-12331.52 4878.52,-12326.92 4883.11,-12336.47 4888.06,-12331.52"/>
</g>
<!-- kv_send1_12_4 -->
<g id="node1063" class="node">
<title>kv_send1_12_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5900" cy="-12158.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5900" y="-12162.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5900" y="-12147.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_12_4&#45;&gt;kv_send1_12_4 -->
<g id="edge1488" class="edge">
<title>ring_stage1_12_4&#45;&gt;kv_send1_12_4</title>
<path fill="none" stroke="black" d="M5565.39,-12273.79C5583.24,-12264.84 5603.79,-12255.12 5623,-12247.41 5688.26,-12221.2 5764.57,-12197.44 5820.55,-12181.24"/>
<polygon fill="black" stroke="black" points="5821.77,-12184.53 5830.41,-12178.4 5819.83,-12177.8 5821.77,-12184.53"/>
</g>
<!-- ring_stage1_13_4 -->
<g id="node1079" class="node">
<title>ring_stage1_13_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5668.5,-12184.91 5475.5,-12184.91 5475.5,-12131.91 5668.5,-12131.91 5668.5,-12184.91"/>
<text text-anchor="middle" x="5572" y="-12169.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="5572" y="-12154.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_7×V_7</text>
<text text-anchor="middle" x="5572" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_12_4&#45;&gt;ring_stage1_13_4 -->
<g id="edge1534" class="edge">
<title>ring_stage1_12_4&#45;&gt;ring_stage1_13_4</title>
<path fill="none" stroke="black" d="M5527.09,-12273.73C5535.85,-12251.43 5548.61,-12218.93 5558.3,-12194.28"/>
<polygon fill="black" stroke="black" points="5561.58,-12195.51 5561.98,-12184.92 5555.06,-12192.95 5561.58,-12195.51"/>
</g>
<!-- kv_send1_12_5 -->
<g id="node1064" class="node">
<title>kv_send1_12_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6664" cy="-12016.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6664" y="-12020.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6664" y="-12005.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_12_5&#45;&gt;kv_send1_12_5 -->
<g id="edge1491" class="edge">
<title>ring_stage1_12_5&#45;&gt;kv_send1_12_5</title>
<path fill="none" stroke="black" d="M6262.49,-12131.89C6355.13,-12105.47 6498.4,-12064.63 6586.4,-12039.53"/>
<polygon fill="black" stroke="black" points="6587.4,-12042.89 6596.06,-12036.78 6585.48,-12036.16 6587.4,-12042.89"/>
</g>
<!-- ring_stage1_13_5 -->
<g id="node1080" class="node">
<title>ring_stage1_13_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6267.5,-12042.91 6074.5,-12042.91 6074.5,-11989.91 6267.5,-11989.91 6267.5,-12042.91"/>
<text text-anchor="middle" x="6171" y="-12027.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="6171" y="-12012.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_8×V_8</text>
<text text-anchor="middle" x="6171" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_12_5&#45;&gt;ring_stage1_13_5 -->
<g id="edge1537" class="edge">
<title>ring_stage1_12_5&#45;&gt;ring_stage1_13_5</title>
<path fill="none" stroke="black" d="M6172.63,-12131.73C6172.32,-12109.63 6171.86,-12077.51 6171.51,-12052.94"/>
<polygon fill="black" stroke="black" points="6175.01,-12052.87 6171.36,-12042.92 6168.01,-12052.97 6175.01,-12052.87"/>
</g>
<!-- kv_send1_12_6 -->
<g id="node1065" class="node">
<title>kv_send1_12_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6991" cy="-11874.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6991" y="-11878.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6991" y="-11863.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_12_6&#45;&gt;kv_send1_12_6 -->
<g id="edge1494" class="edge">
<title>ring_stage1_12_6&#45;&gt;kv_send1_12_6</title>
<path fill="none" stroke="black" d="M6909.34,-11989.73C6925.48,-11967.13 6949.1,-11934.07 6966.79,-11909.3"/>
<polygon fill="black" stroke="black" points="6969.81,-11911.09 6972.77,-11900.92 6964.11,-11907.03 6969.81,-11911.09"/>
</g>
<!-- ring_stage1_13_6 -->
<g id="node1081" class="node">
<title>ring_stage1_13_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6760.5,-11900.91 6567.5,-11900.91 6567.5,-11847.91 6760.5,-11847.91 6760.5,-11900.91"/>
<text text-anchor="middle" x="6664" y="-11885.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="6664" y="-11870.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_9×V_9</text>
<text text-anchor="middle" x="6664" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_12_6&#45;&gt;ring_stage1_13_6 -->
<g id="edge1540" class="edge">
<title>ring_stage1_12_6&#45;&gt;ring_stage1_13_6</title>
<path fill="none" stroke="black" d="M6849.63,-11989.89C6811.5,-11966.38 6754.84,-11931.43 6714.15,-11906.34"/>
<polygon fill="black" stroke="black" points="6715.82,-11903.25 6705.47,-11900.98 6712.14,-11909.21 6715.82,-11903.25"/>
</g>
<!-- kv_send1_12_7 -->
<g id="node1066" class="node">
<title>kv_send1_12_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7407" cy="-11732.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7407" y="-11736.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7407" y="-11721.21" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_12_7&#45;&gt;kv_send1_12_7 -->
<g id="edge1497" class="edge">
<title>ring_stage1_12_7&#45;&gt;kv_send1_12_7</title>
<path fill="none" stroke="black" d="M7350.66,-11847.73C7361.63,-11825.47 7377.6,-11793.05 7389.74,-11768.42"/>
<polygon fill="black" stroke="black" points="7392.91,-11769.91 7394.19,-11759.4 7386.63,-11766.82 7392.91,-11769.91"/>
</g>
<!-- ring_stage1_13_7 -->
<g id="node1082" class="node">
<title>ring_stage1_13_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7213.5,-11758.91 7002.5,-11758.91 7002.5,-11705.91 7213.5,-11705.91 7213.5,-11758.91"/>
<text text-anchor="middle" x="7108" y="-11743.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7108" y="-11728.71" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_10×V_10</text>
<text text-anchor="middle" x="7108" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_12_7&#45;&gt;ring_stage1_13_7 -->
<g id="edge1543" class="edge">
<title>ring_stage1_12_7&#45;&gt;ring_stage1_13_7</title>
<path fill="none" stroke="black" d="M7296.08,-11847.89C7257.45,-11824.38 7200.04,-11789.43 7158.82,-11764.34"/>
<polygon fill="black" stroke="black" points="7160.38,-11761.19 7150.02,-11758.98 7156.74,-11767.17 7160.38,-11761.19"/>
</g>
<!-- kv_send1_12_8 -->
<g id="node1067" class="node">
<title>kv_send1_12_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7579" cy="-11590.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7579" y="-11594.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7579" y="-11579.21" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_12_8&#45;&gt;kv_send1_12_8 -->
<g id="edge1500" class="edge">
<title>ring_stage1_12_8&#45;&gt;kv_send1_12_8</title>
<path fill="none" stroke="black" d="M7645.14,-11705.73C7632.21,-11683.37 7613.34,-11650.77 7599.07,-11626.09"/>
<polygon fill="black" stroke="black" points="7602.07,-11624.3 7594.04,-11617.4 7596.02,-11627.8 7602.07,-11624.3"/>
</g>
<!-- ring_stage1_13_8 -->
<g id="node1083" class="node">
<title>ring_stage1_13_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7911.5,-11616.91 7700.5,-11616.91 7700.5,-11563.91 7911.5,-11563.91 7911.5,-11616.91"/>
<text text-anchor="middle" x="7806" y="-11601.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7806" y="-11586.71" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_11×V_11</text>
<text text-anchor="middle" x="7806" y="-11571.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_12_8&#45;&gt;ring_stage1_13_8 -->
<g id="edge1546" class="edge">
<title>ring_stage1_12_8&#45;&gt;ring_stage1_13_8</title>
<path fill="none" stroke="black" d="M7686.78,-11705.73C7710.75,-11682.74 7746.03,-11648.91 7771.99,-11624.01"/>
<polygon fill="black" stroke="black" points="7774.6,-11626.37 7779.39,-11616.92 7769.75,-11621.32 7774.6,-11626.37"/>
</g>
<!-- kv_send1_12_9 -->
<g id="node1068" class="node">
<title>kv_send1_12_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7610" cy="-13432.98" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7610" y="-13436.78" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="7610" y="-13421.78" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_12_9&#45;&gt;kv_send1_12_9 -->
<g id="edge1503" class="edge">
<title>ring_stage1_12_9&#45;&gt;kv_send1_12_9</title>
<path fill="none" stroke="black" d="M7626.93,-13495.87C7624.68,-13487.64 7622.15,-13478.39 7619.74,-13469.6"/>
<polygon fill="black" stroke="black" points="7623.12,-13468.67 7617.1,-13459.95 7616.37,-13470.52 7623.12,-13468.67"/>
</g>
<!-- ring_stage1_13_9 -->
<g id="node1084" class="node">
<title>ring_stage1_13_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7456.5,-11474.91 7245.5,-11474.91 7245.5,-11421.91 7456.5,-11421.91 7456.5,-11474.91"/>
<text text-anchor="middle" x="7351" y="-11459.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7351" y="-11444.71" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_12×V_12</text>
<text text-anchor="middle" x="7351" y="-11429.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_12_9&#45;&gt;ring_stage1_13_9 -->
<g id="edge1549" class="edge">
<title>ring_stage1_12_9&#45;&gt;ring_stage1_13_9</title>
<path fill="none" stroke="black" d="M7688.61,-13495.95C7703.64,-13486.5 7718.64,-13474.46 7729,-13459.85 7764.64,-13409.61 7853.61,-12982.56 7861,-12921.41 7866.65,-12874.64 7862.16,-12862.5 7861,-12815.41 7859.44,-12752.24 7894.18,-12722.17 7854,-12673.41 7811.5,-12621.83 7755.26,-12684.67 7708,-12637.41 7662.04,-12591.44 7683.8,-12559.5 7673,-12495.41 7658.55,-12409.58 7698.71,-12166.79 7637,-12105.41 7571.53,-12040.28 7285.41,-12137.48 7223,-12069.41 7191.16,-12034.68 7222.83,-12010.52 7223,-11963.41 7223.17,-11916.02 7221.25,-11579.5 7243,-11537.41 7254.91,-11514.37 7275.78,-11495.19 7296.03,-11480.68"/>
<polygon fill="black" stroke="black" points="7298.09,-11483.51 7304.34,-11474.95 7294.12,-11477.75 7298.09,-11483.51"/>
</g>
<!-- kv_send1_12_10 -->
<g id="node1069" class="node">
<title>kv_send1_12_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7372" cy="-13343.24" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7372" y="-13347.04" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="7372" y="-13332.04" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_12_10&#45;&gt;kv_send1_12_10 -->
<g id="edge1506" class="edge">
<title>ring_stage1_12_10&#45;&gt;kv_send1_12_10</title>
<path fill="none" stroke="black" d="M7372,-13406.13C7372,-13398.08 7372,-13389.05 7372,-13380.43"/>
<polygon fill="black" stroke="black" points="7375.5,-13380.21 7372,-13370.21 7368.5,-13380.21 7375.5,-13380.21"/>
</g>
<!-- ring_stage1_13_10 -->
<g id="node1085" class="node">
<title>ring_stage1_13_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7720,-13369.74 7500,-13369.74 7500,-13316.74 7720,-13316.74 7720,-13369.74"/>
<text text-anchor="middle" x="7610" y="-13354.54" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7610" y="-13339.54" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_13×V_13</text>
<text text-anchor="middle" x="7610" y="-13324.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_12_10&#45;&gt;ring_stage1_13_10 -->
<g id="edge1552" class="edge">
<title>ring_stage1_12_10&#45;&gt;ring_stage1_13_10</title>
<path fill="none" stroke="black" d="M7441.48,-13406.36C7469.46,-13396.05 7501.89,-13384.09 7530.78,-13373.44"/>
<polygon fill="black" stroke="black" points="7532.26,-13376.63 7540.43,-13369.88 7529.84,-13370.06 7532.26,-13376.63"/>
</g>
<!-- kv_send1_12_11 -->
<g id="node1070" class="node">
<title>kv_send1_12_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7114" cy="-13253.5" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7114" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="7114" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_12_11&#45;&gt;kv_send1_12_11 -->
<g id="edge1509" class="edge">
<title>ring_stage1_12_11&#45;&gt;kv_send1_12_11</title>
<path fill="none" stroke="black" d="M7128.11,-13316.39C7126.25,-13308.25 7124.17,-13299.11 7122.18,-13290.4"/>
<polygon fill="black" stroke="black" points="7125.55,-13289.44 7119.92,-13280.47 7118.73,-13290.99 7125.55,-13289.44"/>
</g>
<!-- ring_stage1_13_11 -->
<g id="node1086" class="node">
<title>ring_stage1_13_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7462,-13280 7242,-13280 7242,-13227 7462,-13227 7462,-13280"/>
<text text-anchor="middle" x="7352" y="-13264.8" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7352" y="-13249.8" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_14×V_14</text>
<text text-anchor="middle" x="7352" y="-13234.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_12_11&#45;&gt;ring_stage1_13_11 -->
<g id="edge1555" class="edge">
<title>ring_stage1_12_11&#45;&gt;ring_stage1_13_11</title>
<path fill="none" stroke="black" d="M7197.64,-13316.62C7223.05,-13306.4 7252.46,-13294.56 7278.75,-13283.98"/>
<polygon fill="black" stroke="black" points="7280.31,-13287.12 7288.28,-13280.14 7277.7,-13280.63 7280.31,-13287.12"/>
</g>
<!-- kv_send1_12_12 -->
<g id="node1071" class="node">
<title>kv_send1_12_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6876" cy="-13163.76" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6876" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="6876" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_12_12&#45;&gt;kv_send1_12_12 -->
<g id="edge1512" class="edge">
<title>ring_stage1_12_12&#45;&gt;kv_send1_12_12</title>
<path fill="none" stroke="black" d="M6882.35,-13226.65C6881.52,-13218.6 6880.6,-13209.57 6879.71,-13200.95"/>
<polygon fill="black" stroke="black" points="6883.17,-13200.32 6878.66,-13190.73 6876.2,-13201.03 6883.17,-13200.32"/>
</g>
<!-- ring_stage1_13_12 -->
<g id="node1087" class="node">
<title>ring_stage1_13_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7224,-13190.26 7004,-13190.26 7004,-13137.26 7224,-13137.26 7224,-13190.26"/>
<text text-anchor="middle" x="7114" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="7114" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_15×V_15</text>
<text text-anchor="middle" x="7114" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_12_12&#45;&gt;ring_stage1_13_12 -->
<g id="edge1558" class="edge">
<title>ring_stage1_12_12&#45;&gt;ring_stage1_13_12</title>
<path fill="none" stroke="black" d="M6951.85,-13226.88C6978.66,-13216.61 7009.71,-13204.72 7037.42,-13194.1"/>
<polygon fill="black" stroke="black" points="7038.98,-13197.25 7047.07,-13190.4 7036.47,-13190.71 7038.98,-13197.25"/>
</g>
<!-- kv_send1_12_13 -->
<g id="node1072" class="node">
<title>kv_send1_12_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6616" cy="-13074.02" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6616" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6616" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_12_13&#45;&gt;kv_send1_12_13 -->
<g id="edge1515" class="edge">
<title>ring_stage1_12_13&#45;&gt;kv_send1_12_13</title>
<path fill="none" stroke="black" d="M6637.87,-13136.91C6634.96,-13128.68 6631.69,-13119.43 6628.59,-13110.64"/>
<polygon fill="black" stroke="black" points="6631.81,-13109.25 6625.18,-13100.99 6625.21,-13111.58 6631.81,-13109.25"/>
</g>
<!-- ring_stage1_13_13 -->
<g id="node1088" class="node">
<title>ring_stage1_13_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6946,-13100.52 6744,-13100.52 6744,-13047.52 6946,-13047.52 6946,-13100.52"/>
<text text-anchor="middle" x="6845" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="6845" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_0×V_0</text>
<text text-anchor="middle" x="6845" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_12_13&#45;&gt;ring_stage1_13_13 -->
<g id="edge1561" class="edge">
<title>ring_stage1_12_13&#45;&gt;ring_stage1_13_13</title>
<path fill="none" stroke="black" d="M6704.8,-13137.14C6727.68,-13127.01 6754.12,-13115.29 6777.84,-13104.78"/>
<polygon fill="black" stroke="black" points="6779.4,-13107.91 6787.13,-13100.66 6776.57,-13101.51 6779.4,-13107.91"/>
</g>
<!-- kv_send1_12_14 -->
<g id="node1073" class="node">
<title>kv_send1_12_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6317" cy="-12984.28" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6317" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6317" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_12_14&#45;&gt;kv_send1_12_14 -->
<g id="edge1518" class="edge">
<title>ring_stage1_12_14&#45;&gt;kv_send1_12_14</title>
<path fill="none" stroke="black" d="M6366.38,-13047.17C6359.33,-13038.33 6351.34,-13028.31 6343.87,-13018.95"/>
<polygon fill="black" stroke="black" points="6346.45,-13016.58 6337.48,-13010.94 6340.98,-13020.94 6346.45,-13016.58"/>
</g>
<!-- ring_stage1_13_14 -->
<g id="node1089" class="node">
<title>ring_stage1_13_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6657,-13010.78 6455,-13010.78 6455,-12957.78 6657,-12957.78 6657,-13010.78"/>
<text text-anchor="middle" x="6556" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="6556" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_1×V_1</text>
<text text-anchor="middle" x="6556" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_12_14&#45;&gt;ring_stage1_13_14 -->
<g id="edge1564" class="edge">
<title>ring_stage1_12_14&#45;&gt;ring_stage1_13_14</title>
<path fill="none" stroke="black" d="M6436.34,-13047.4C6455.51,-13037.45 6477.63,-13025.96 6497.6,-13015.6"/>
<polygon fill="black" stroke="black" points="6499.34,-13018.64 6506.6,-13010.92 6496.11,-13012.42 6499.34,-13018.64"/>
</g>
<!-- kv_send1_12_15 -->
<g id="node1074" class="node">
<title>kv_send1_12_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5839" cy="-12868.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5839" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="5839" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_12_15&#45;&gt;kv_send1_12_15 -->
<g id="edge1521" class="edge">
<title>ring_stage1_12_15&#45;&gt;kv_send1_12_15</title>
<path fill="none" stroke="black" d="M5842.88,-12957.72C5842.21,-12942.41 5841.34,-12922.69 5840.6,-12905.77"/>
<polygon fill="black" stroke="black" points="5844.09,-12905.5 5840.15,-12895.67 5837.1,-12905.81 5844.09,-12905.5"/>
</g>
<!-- ring_stage1_13_15 -->
<g id="node1090" class="node">
<title>ring_stage1_13_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6392,-12894.91 6190,-12894.91 6190,-12841.91 6392,-12841.91 6392,-12894.91"/>
<text text-anchor="middle" x="6291" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="6291" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_2×V_2</text>
<text text-anchor="middle" x="6291" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_12_15&#45;&gt;ring_stage1_13_15 -->
<g id="edge1567" class="edge">
<title>ring_stage1_12_15&#45;&gt;ring_stage1_13_15</title>
<path fill="none" stroke="black" d="M5945.23,-12959.17C5948.19,-12958.56 5951.11,-12957.97 5954,-12957.41 6054.23,-12937.7 6083.4,-12951.54 6181,-12921.41 6199.22,-12915.78 6218.27,-12907.66 6235.3,-12899.49"/>
<polygon fill="black" stroke="black" points="6237.09,-12902.51 6244.53,-12894.97 6234.01,-12896.23 6237.09,-12902.51"/>
</g>
<!-- kv_send1_12_0&#45;&gt;ring_stage1_13_1 -->
<g id="edge1526" class="edge">
<title>kv_send1_12_0&#45;&gt;ring_stage1_13_1</title>
<path fill="none" stroke="black" d="M4728.41,-12699.4C4730.46,-12677.4 4733.41,-12645.64 4735.67,-12621.23"/>
<polygon fill="black" stroke="black" points="4739.16,-12621.55 4736.6,-12611.27 4732.19,-12620.91 4739.16,-12621.55"/>
</g>
<!-- kv_send1_12_1&#45;&gt;ring_stage1_13_2 -->
<g id="edge1529" class="edge">
<title>kv_send1_12_1&#45;&gt;ring_stage1_13_2</title>
<path fill="none" stroke="black" d="M4487.82,-12558.7C4456.63,-12535.47 4409.77,-12500.58 4375.78,-12475.27"/>
<polygon fill="black" stroke="black" points="4377.55,-12472.22 4367.44,-12469.05 4373.37,-12477.83 4377.55,-12472.22"/>
</g>
<!-- kv_send1_12_2&#45;&gt;ring_stage1_13_3 -->
<g id="edge1532" class="edge">
<title>kv_send1_12_2&#45;&gt;ring_stage1_13_3</title>
<path fill="none" stroke="black" d="M4789.31,-12415.73C4801.79,-12393.33 4820,-12360.65 4833.75,-12335.96"/>
<polygon fill="black" stroke="black" points="4836.97,-12337.36 4838.78,-12326.92 4830.86,-12333.95 4836.97,-12337.36"/>
</g>
<!-- kv_send1_12_3&#45;&gt;ring_stage1_13_4 -->
<g id="edge1535" class="edge">
<title>kv_send1_12_3&#45;&gt;ring_stage1_13_4</title>
<path fill="none" stroke="black" d="M5344.39,-12276.13C5390.49,-12252.49 5462.11,-12215.76 5512.68,-12189.83"/>
<polygon fill="black" stroke="black" points="5514.57,-12192.79 5521.87,-12185.11 5511.38,-12186.56 5514.57,-12192.79"/>
</g>
<!-- kv_send1_12_4&#45;&gt;ring_stage1_13_5 -->
<g id="edge1538" class="edge">
<title>kv_send1_12_4&#45;&gt;ring_stage1_13_5</title>
<path fill="none" stroke="black" d="M5945.05,-12134.13C5990.82,-12110.49 6061.92,-12073.76 6112.12,-12047.83"/>
<polygon fill="black" stroke="black" points="6113.96,-12050.81 6121.24,-12043.11 6110.75,-12044.59 6113.96,-12050.81"/>
</g>
<!-- kv_send1_12_5&#45;&gt;ring_stage1_13_6 -->
<g id="edge1541" class="edge">
<title>kv_send1_12_5&#45;&gt;ring_stage1_13_6</title>
<path fill="none" stroke="black" d="M6664,-11989.4C6664,-11967.5 6664,-11935.93 6664,-11911.56"/>
<polygon fill="black" stroke="black" points="6667.5,-11911.27 6664,-11901.27 6660.5,-11911.27 6667.5,-11911.27"/>
</g>
<!-- kv_send1_12_6&#45;&gt;ring_stage1_13_7 -->
<g id="edge1544" class="edge">
<title>kv_send1_12_6&#45;&gt;ring_stage1_13_7</title>
<path fill="none" stroke="black" d="M7012.19,-11848.05C7031.2,-11825.3 7059.24,-11791.75 7080.08,-11766.81"/>
<polygon fill="black" stroke="black" points="7082.85,-11768.96 7086.57,-11759.04 7077.48,-11764.47 7082.85,-11768.96"/>
</g>
<!-- kv_send1_12_7&#45;&gt;ring_stage1_13_8 -->
<g id="edge1547" class="edge">
<title>kv_send1_12_7&#45;&gt;ring_stage1_13_8</title>
<path fill="none" stroke="black" d="M7461.3,-11709.45C7486.77,-11699.57 7517.7,-11688.18 7546,-11679.41 7609.42,-11659.74 7628.27,-11665.18 7691,-11643.41 7708.99,-11637.16 7728.02,-11629.17 7745.31,-11621.33"/>
<polygon fill="black" stroke="black" points="7747.09,-11624.36 7754.72,-11617 7744.17,-11618 7747.09,-11624.36"/>
</g>
<!-- kv_send1_12_8&#45;&gt;ring_stage1_13_9 -->
<g id="edge1550" class="edge">
<title>kv_send1_12_8&#45;&gt;ring_stage1_13_9</title>
<path fill="none" stroke="black" d="M7540.06,-11565.5C7501.83,-11542.02 7443.32,-11506.09 7401.52,-11480.43"/>
<polygon fill="black" stroke="black" points="7403.22,-11477.36 7392.87,-11475.11 7399.56,-11483.33 7403.22,-11477.36"/>
</g>
<!-- kv_send1_12_9&#45;&gt;ring_stage1_13_10 -->
<g id="edge1553" class="edge">
<title>kv_send1_12_9&#45;&gt;ring_stage1_13_10</title>
<path fill="none" stroke="black" d="M7610,-13405.65C7610,-13397.61 7610,-13388.63 7610,-13380.08"/>
<polygon fill="black" stroke="black" points="7613.5,-13379.94 7610,-13369.94 7606.5,-13379.94 7613.5,-13379.94"/>
</g>
<!-- kv_send1_12_10&#45;&gt;ring_stage1_13_11 -->
<g id="edge1556" class="edge">
<title>kv_send1_12_10&#45;&gt;ring_stage1_13_11</title>
<path fill="none" stroke="black" d="M7366.11,-13316.39C7364.24,-13308.18 7362.13,-13298.95 7360.13,-13290.17"/>
<polygon fill="black" stroke="black" points="7363.49,-13289.13 7357.85,-13280.16 7356.66,-13290.69 7363.49,-13289.13"/>
</g>
<!-- kv_send1_12_11&#45;&gt;ring_stage1_13_12 -->
<g id="edge1559" class="edge">
<title>kv_send1_12_11&#45;&gt;ring_stage1_13_12</title>
<path fill="none" stroke="black" d="M7114,-13226.17C7114,-13218.13 7114,-13209.15 7114,-13200.6"/>
<polygon fill="black" stroke="black" points="7117.5,-13200.46 7114,-13190.46 7110.5,-13200.46 7117.5,-13200.46"/>
</g>
<!-- kv_send1_12_12&#45;&gt;ring_stage1_13_13 -->
<g id="edge1562" class="edge">
<title>kv_send1_12_12&#45;&gt;ring_stage1_13_13</title>
<path fill="none" stroke="black" d="M6866.87,-13136.91C6863.9,-13128.52 6860.56,-13119.06 6857.4,-13110.12"/>
<polygon fill="black" stroke="black" points="6860.7,-13108.95 6854.07,-13100.68 6854.1,-13111.28 6860.7,-13108.95"/>
</g>
<!-- kv_send1_12_13&#45;&gt;ring_stage1_13_14 -->
<g id="edge1565" class="edge">
<title>kv_send1_12_13&#45;&gt;ring_stage1_13_14</title>
<path fill="none" stroke="black" d="M6598.32,-13047.17C6592.34,-13038.42 6585.57,-13028.52 6579.22,-13019.24"/>
<polygon fill="black" stroke="black" points="6582.08,-13017.22 6573.55,-13010.94 6576.31,-13021.17 6582.08,-13017.22"/>
</g>
<!-- kv_send1_12_14&#45;&gt;ring_stage1_13_15 -->
<g id="edge1568" class="edge">
<title>kv_send1_12_14&#45;&gt;ring_stage1_13_15</title>
<path fill="none" stroke="black" d="M6311.1,-12957.44C6307.58,-12942.01 6303.05,-12922.18 6299.18,-12905.25"/>
<polygon fill="black" stroke="black" points="6302.51,-12904.11 6296.88,-12895.14 6295.69,-12905.67 6302.51,-12904.11"/>
</g>
<!-- kv_send1_12_15&#45;&gt;ring_stage1_13_0 -->
<g id="edge1523" class="edge">
<title>kv_send1_12_15&#45;&gt;ring_stage1_13_0</title>
<path fill="none" stroke="black" d="M5798.87,-12843.5C5759.38,-12819.97 5698.9,-12783.94 5655.8,-12758.27"/>
<polygon fill="black" stroke="black" points="5657.53,-12755.22 5647.15,-12753.11 5653.95,-12761.24 5657.53,-12755.22"/>
</g>
<!-- kv_send1_13_0 -->
<g id="node1091" class="node">
<title>kv_send1_13_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5203" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5203" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="5203" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_13_0&#45;&gt;kv_send1_13_0 -->
<g id="edge1524" class="edge">
<title>ring_stage1_13_0&#45;&gt;kv_send1_13_0</title>
<path fill="none" stroke="black" d="M5558.42,-12699.78C5540.1,-12690.36 5518.49,-12680.32 5498,-12673.41 5419.45,-12646.93 5393.83,-12663.05 5315,-12637.41 5295.21,-12630.97 5274.31,-12621.93 5256.01,-12613.2"/>
<polygon fill="black" stroke="black" points="5257.49,-12610.03 5246.97,-12608.81 5254.43,-12616.33 5257.49,-12610.03"/>
</g>
<!-- ring_stage1_14_0 -->
<g id="node1107" class="node">
<title>ring_stage1_14_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6195.5,-12610.91 6002.5,-12610.91 6002.5,-12557.91 6195.5,-12557.91 6195.5,-12610.91"/>
<text text-anchor="middle" x="6099" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6099" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_2×V_2</text>
<text text-anchor="middle" x="6099" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_13_0&#45;&gt;ring_stage1_14_0 -->
<g id="edge1570" class="edge">
<title>ring_stage1_13_0&#45;&gt;ring_stage1_14_0</title>
<path fill="none" stroke="black" d="M5647.8,-12699.87C5666.41,-12690.11 5688.7,-12679.79 5710,-12673.41 5831.45,-12636.99 5871.55,-12673.82 5993,-12637.41 6010.97,-12632.02 6029.65,-12623.83 6046.22,-12615.54"/>
<polygon fill="black" stroke="black" points="6047.9,-12618.62 6055.2,-12610.94 6044.7,-12612.39 6047.9,-12618.62"/>
</g>
<!-- kv_send1_13_1 -->
<g id="node1092" class="node">
<title>kv_send1_13_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4551" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4551" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="4551" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_13_1&#45;&gt;kv_send1_13_1 -->
<g id="edge1527" class="edge">
<title>ring_stage1_13_1&#45;&gt;kv_send1_13_1</title>
<path fill="none" stroke="black" d="M4704.52,-12557.73C4672.86,-12534.15 4625.89,-12499.18 4592.25,-12474.13"/>
<polygon fill="black" stroke="black" points="4594.11,-12471.15 4584,-12467.98 4589.93,-12476.76 4594.11,-12471.15"/>
</g>
<!-- ring_stage1_14_1 -->
<g id="node1108" class="node">
<title>ring_stage1_14_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5300.5,-12468.91 5107.5,-12468.91 5107.5,-12415.91 5300.5,-12415.91 5300.5,-12468.91"/>
<text text-anchor="middle" x="5204" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="5204" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_3×V_3</text>
<text text-anchor="middle" x="5204" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_13_1&#45;&gt;ring_stage1_14_1 -->
<g id="edge1573" class="edge">
<title>ring_stage1_13_1&#45;&gt;ring_stage1_14_1</title>
<path fill="none" stroke="black" d="M4800.65,-12557.77C4825.03,-12548.4 4853.51,-12538.4 4880,-12531.41 4975.37,-12506.23 5005.1,-12525.63 5099,-12495.41 5116.32,-12489.83 5134.36,-12481.81 5150.49,-12473.72"/>
<polygon fill="black" stroke="black" points="5152.45,-12476.65 5159.75,-12468.97 5149.26,-12470.42 5152.45,-12476.65"/>
</g>
<!-- kv_send1_13_2 -->
<g id="node1093" class="node">
<title>kv_send1_13_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4335" cy="-12300.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4335" y="-12304.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4335" y="-12289.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_13_2&#45;&gt;kv_send1_13_2 -->
<g id="edge1530" class="edge">
<title>ring_stage1_13_2&#45;&gt;kv_send1_13_2</title>
<path fill="none" stroke="black" d="M4333.37,-12415.73C4333.68,-12393.76 4334.14,-12361.91 4334.49,-12337.4"/>
<polygon fill="black" stroke="black" points="4337.99,-12337.45 4334.63,-12327.4 4330.99,-12337.35 4337.99,-12337.45"/>
</g>
<!-- ring_stage1_14_2 -->
<g id="node1109" class="node">
<title>ring_stage1_14_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4693.5,-12326.91 4500.5,-12326.91 4500.5,-12273.91 4693.5,-12273.91 4693.5,-12326.91"/>
<text text-anchor="middle" x="4597" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="4597" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_4×V_4</text>
<text text-anchor="middle" x="4597" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_13_2&#45;&gt;ring_stage1_14_2 -->
<g id="edge1576" class="edge">
<title>ring_stage1_13_2&#45;&gt;ring_stage1_14_2</title>
<path fill="none" stroke="black" d="M4381.11,-12415.89C4425.82,-12392.18 4492.46,-12356.85 4539.86,-12331.71"/>
<polygon fill="black" stroke="black" points="4541.58,-12334.76 4548.77,-12326.98 4538.3,-12328.58 4541.58,-12334.76"/>
</g>
<!-- kv_send1_13_3 -->
<g id="node1094" class="node">
<title>kv_send1_13_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5350" cy="-12158.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5350" y="-12162.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5350" y="-12147.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_13_3&#45;&gt;kv_send1_13_3 -->
<g id="edge1533" class="edge">
<title>ring_stage1_13_3&#45;&gt;kv_send1_13_3</title>
<path fill="none" stroke="black" d="M4899.31,-12273.78C4918.26,-12264.24 4940.7,-12254.12 4962,-12247.41 5054.83,-12218.17 5083.22,-12233.53 5178,-12211.41 5211.44,-12203.6 5247.93,-12192.89 5278.66,-12183.22"/>
<polygon fill="black" stroke="black" points="5279.95,-12186.48 5288.42,-12180.12 5277.83,-12179.81 5279.95,-12186.48"/>
</g>
<!-- ring_stage1_14_3 -->
<g id="node1110" class="node">
<title>ring_stage1_14_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4943.5,-12184.91 4750.5,-12184.91 4750.5,-12131.91 4943.5,-12131.91 4943.5,-12184.91"/>
<text text-anchor="middle" x="4847" y="-12169.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="4847" y="-12154.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_5×V_5</text>
<text text-anchor="middle" x="4847" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_13_3&#45;&gt;ring_stage1_14_3 -->
<g id="edge1579" class="edge">
<title>ring_stage1_13_3&#45;&gt;ring_stage1_14_3</title>
<path fill="none" stroke="black" d="M4851.9,-12273.73C4850.95,-12251.63 4849.58,-12219.51 4848.52,-12194.94"/>
<polygon fill="black" stroke="black" points="4852.02,-12194.76 4848.09,-12184.92 4845.02,-12195.06 4852.02,-12194.76"/>
</g>
<!-- kv_send1_13_4 -->
<g id="node1095" class="node">
<title>kv_send1_13_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5953" cy="-12016.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5953" y="-12020.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5953" y="-12005.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_13_4&#45;&gt;kv_send1_13_4 -->
<g id="edge1536" class="edge">
<title>ring_stage1_13_4&#45;&gt;kv_send1_13_4</title>
<path fill="none" stroke="black" d="M5642.75,-12131.88C5691.03,-12114.4 5756.43,-12090.64 5814,-12069.41 5837.58,-12060.71 5863.38,-12051.09 5886.28,-12042.51"/>
<polygon fill="black" stroke="black" points="5887.76,-12045.69 5895.9,-12038.9 5885.31,-12039.14 5887.76,-12045.69"/>
</g>
<!-- ring_stage1_14_4 -->
<g id="node1111" class="node">
<title>ring_stage1_14_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5804.5,-12042.91 5611.5,-12042.91 5611.5,-11989.91 5804.5,-11989.91 5804.5,-12042.91"/>
<text text-anchor="middle" x="5708" y="-12027.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="5708" y="-12012.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_6×V_6</text>
<text text-anchor="middle" x="5708" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_13_4&#45;&gt;ring_stage1_14_4 -->
<g id="edge1582" class="edge">
<title>ring_stage1_13_4&#45;&gt;ring_stage1_14_4</title>
<path fill="none" stroke="black" d="M5596.94,-12131.73C5619.18,-12108.84 5651.86,-12075.2 5676.01,-12050.34"/>
<polygon fill="black" stroke="black" points="5678.76,-12052.53 5683.21,-12042.92 5673.74,-12047.66 5678.76,-12052.53"/>
</g>
<!-- kv_send1_13_5 -->
<g id="node1096" class="node">
<title>kv_send1_13_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6420" cy="-11874.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6420" y="-11878.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6420" y="-11863.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_13_5&#45;&gt;kv_send1_13_5 -->
<g id="edge1539" class="edge">
<title>ring_stage1_13_5&#45;&gt;kv_send1_13_5</title>
<path fill="none" stroke="black" d="M6216.38,-11989.89C6259.43,-11965.69 6324.01,-11929.37 6368.86,-11904.16"/>
<polygon fill="black" stroke="black" points="6370.83,-11907.07 6377.84,-11899.11 6367.4,-11900.96 6370.83,-11907.07"/>
</g>
<!-- ring_stage1_14_5 -->
<g id="node1112" class="node">
<title>ring_stage1_14_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6267.5,-11900.91 6074.5,-11900.91 6074.5,-11847.91 6267.5,-11847.91 6267.5,-11900.91"/>
<text text-anchor="middle" x="6171" y="-11885.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6171" y="-11870.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_7×V_7</text>
<text text-anchor="middle" x="6171" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_13_5&#45;&gt;ring_stage1_14_5 -->
<g id="edge1585" class="edge">
<title>ring_stage1_13_5&#45;&gt;ring_stage1_14_5</title>
<path fill="none" stroke="black" d="M6171,-11989.73C6171,-11967.63 6171,-11935.51 6171,-11910.94"/>
<polygon fill="black" stroke="black" points="6174.5,-11910.92 6171,-11900.92 6167.5,-11910.92 6174.5,-11910.92"/>
</g>
<!-- kv_send1_13_6 -->
<g id="node1097" class="node">
<title>kv_send1_13_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6881" cy="-11732.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6881" y="-11736.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6881" y="-11721.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_13_6&#45;&gt;kv_send1_13_6 -->
<g id="edge1542" class="edge">
<title>ring_stage1_13_6&#45;&gt;kv_send1_13_6</title>
<path fill="none" stroke="black" d="M6703.55,-11847.89C6740.6,-11823.99 6795.97,-11788.27 6834.98,-11763.1"/>
<polygon fill="black" stroke="black" points="6837.03,-11765.94 6843.54,-11757.58 6833.24,-11760.06 6837.03,-11765.94"/>
</g>
<!-- ring_stage1_14_6 -->
<g id="node1113" class="node">
<title>ring_stage1_14_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6759.5,-11758.91 6566.5,-11758.91 6566.5,-11705.91 6759.5,-11705.91 6759.5,-11758.91"/>
<text text-anchor="middle" x="6663" y="-11743.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6663" y="-11728.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_8×V_8</text>
<text text-anchor="middle" x="6663" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_13_6&#45;&gt;ring_stage1_14_6 -->
<g id="edge1588" class="edge">
<title>ring_stage1_13_6&#45;&gt;ring_stage1_14_6</title>
<path fill="none" stroke="black" d="M6663.82,-11847.73C6663.66,-11825.63 6663.43,-11793.51 6663.25,-11768.94"/>
<polygon fill="black" stroke="black" points="6666.75,-11768.9 6663.18,-11758.92 6659.75,-11768.95 6666.75,-11768.9"/>
</g>
<!-- kv_send1_13_7 -->
<g id="node1098" class="node">
<title>kv_send1_13_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7355" cy="-11590.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7355" y="-11594.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7355" y="-11579.21" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_13_7&#45;&gt;kv_send1_13_7 -->
<g id="edge1545" class="edge">
<title>ring_stage1_13_7&#45;&gt;kv_send1_13_7</title>
<path fill="none" stroke="black" d="M7153.02,-11705.89C7195.71,-11681.69 7259.78,-11645.37 7304.27,-11620.16"/>
<polygon fill="black" stroke="black" points="7306.2,-11623.09 7313.17,-11615.11 7302.75,-11617 7306.2,-11623.09"/>
</g>
<!-- ring_stage1_14_7 -->
<g id="node1114" class="node">
<title>ring_stage1_14_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7157.5,-11616.91 6964.5,-11616.91 6964.5,-11563.91 7157.5,-11563.91 7157.5,-11616.91"/>
<text text-anchor="middle" x="7061" y="-11601.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7061" y="-11586.71" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_9×V_9</text>
<text text-anchor="middle" x="7061" y="-11571.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_13_7&#45;&gt;ring_stage1_14_7 -->
<g id="edge1591" class="edge">
<title>ring_stage1_13_7&#45;&gt;ring_stage1_14_7</title>
<path fill="none" stroke="black" d="M7099.38,-11705.73C7091.93,-11683.53 7081.08,-11651.22 7072.82,-11626.61"/>
<polygon fill="black" stroke="black" points="7076.07,-11625.29 7069.57,-11616.92 7069.43,-11627.52 7076.07,-11625.29"/>
</g>
<!-- kv_send1_13_8 -->
<g id="node1099" class="node">
<title>kv_send1_13_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7807" cy="-11448.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7807" y="-11452.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7807" y="-11437.21" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_13_8&#45;&gt;kv_send1_13_8 -->
<g id="edge1548" class="edge">
<title>ring_stage1_13_8&#45;&gt;kv_send1_13_8</title>
<path fill="none" stroke="black" d="M7806.18,-11563.73C7806.34,-11541.76 7806.57,-11509.91 7806.74,-11485.4"/>
<polygon fill="black" stroke="black" points="7810.24,-11485.42 7806.81,-11475.4 7803.24,-11485.37 7810.24,-11485.42"/>
</g>
<!-- ring_stage1_14_8 -->
<g id="node1115" class="node">
<title>ring_stage1_14_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7685.5,-11474.91 7474.5,-11474.91 7474.5,-11421.91 7685.5,-11421.91 7685.5,-11474.91"/>
<text text-anchor="middle" x="7580" y="-11459.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7580" y="-11444.71" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_10×V_10</text>
<text text-anchor="middle" x="7580" y="-11429.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_13_8&#45;&gt;ring_stage1_14_8 -->
<g id="edge1594" class="edge">
<title>ring_stage1_13_8&#45;&gt;ring_stage1_14_8</title>
<path fill="none" stroke="black" d="M7764.81,-11563.89C7726.85,-11540.38 7670.44,-11505.43 7629.93,-11480.34"/>
<polygon fill="black" stroke="black" points="7631.63,-11477.27 7621.29,-11474.98 7627.95,-11483.22 7631.63,-11477.27"/>
</g>
<!-- kv_send1_13_9 -->
<g id="node1100" class="node">
<title>kv_send1_13_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6458" cy="-11306.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6458" y="-11310.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6458" y="-11295.21" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_13_9&#45;&gt;kv_send1_13_9 -->
<g id="edge1551" class="edge">
<title>ring_stage1_13_9&#45;&gt;kv_send1_13_9</title>
<path fill="none" stroke="black" d="M7304.85,-11421.81C7284.39,-11411.72 7259.63,-11401.18 7236,-11395.41 6951.06,-11325.79 6862.38,-11427.21 6577,-11359.41 6554.66,-11354.1 6531.25,-11344.78 6511.17,-11335.48"/>
<polygon fill="black" stroke="black" points="6512.43,-11332.21 6501.89,-11331.09 6509.43,-11338.53 6512.43,-11332.21"/>
</g>
<!-- ring_stage1_14_9 -->
<g id="node1116" class="node">
<title>ring_stage1_14_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7677.5,-11332.91 7466.5,-11332.91 7466.5,-11279.91 7677.5,-11279.91 7677.5,-11332.91"/>
<text text-anchor="middle" x="7572" y="-11317.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7572" y="-11302.71" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_11×V_11</text>
<text text-anchor="middle" x="7572" y="-11287.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_13_9&#45;&gt;ring_stage1_14_9 -->
<g id="edge1597" class="edge">
<title>ring_stage1_13_9&#45;&gt;ring_stage1_14_9</title>
<path fill="none" stroke="black" d="M7391.28,-11421.89C7428.32,-11398.43 7483.33,-11363.58 7522.92,-11338.5"/>
<polygon fill="black" stroke="black" points="7525.05,-11341.29 7531.63,-11332.98 7521.31,-11335.38 7525.05,-11341.29"/>
</g>
<!-- kv_send1_13_10 -->
<g id="node1101" class="node">
<title>kv_send1_13_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7590" cy="-13253.5" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7590" y="-13257.3" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="7590" y="-13242.3" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_13_10&#45;&gt;kv_send1_13_10 -->
<g id="edge1554" class="edge">
<title>ring_stage1_13_10&#45;&gt;kv_send1_13_10</title>
<path fill="none" stroke="black" d="M7604.11,-13316.39C7602.25,-13308.25 7600.17,-13299.11 7598.18,-13290.4"/>
<polygon fill="black" stroke="black" points="7601.55,-13289.44 7595.92,-13280.47 7594.73,-13290.99 7601.55,-13289.44"/>
</g>
<!-- ring_stage1_14_10 -->
<g id="node1117" class="node">
<title>ring_stage1_14_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6568,-11190.91 6348,-11190.91 6348,-11137.91 6568,-11137.91 6568,-11190.91"/>
<text text-anchor="middle" x="6458" y="-11175.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6458" y="-11160.71" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_12×V_12</text>
<text text-anchor="middle" x="6458" y="-11145.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_13_10&#45;&gt;ring_stage1_14_10 -->
<g id="edge1600" class="edge">
<title>ring_stage1_13_10&#45;&gt;ring_stage1_14_10</title>
<path fill="none" stroke="black" d="M7670.43,-13316.61C7685.41,-13307.37 7699.79,-13295.41 7709,-13280.37 7735.92,-13236.38 7719,-13216.33 7719,-13164.76 7719,-13164.76 7719,-13164.76 7719,-13073.02 7719,-13019.93 7728.98,-12992.33 7689,-12957.41 7587.53,-12868.77 7477.43,-13022.17 7388,-12921.41 7356.73,-12886.17 7358.65,-12852.25 7388,-12815.41 7432.61,-12759.41 7495.87,-12831.47 7545,-12779.41 7583,-12739.14 7607,-12571.67 7569,-12531.41 7473.97,-12430.72 7042.03,-12596.1 6947,-12495.41 6914.66,-12461.15 6930.6,-12433.57 6947,-12389.41 6954.35,-12369.61 6970.65,-12373.2 6978,-12353.41 6994.4,-12309.24 7008.73,-12283.11 6978,-12247.41 6907.93,-12165.99 6835.76,-12258.06 6739,-12211.41 6676.68,-12181.36 6681.96,-12144.68 6625,-12105.41 6595.22,-12084.87 6572.32,-12099.33 6552,-12069.41 6489.88,-11977.93 6606.25,-11903.35 6532,-11821.41 6471.65,-11754.8 6392.38,-11852.88 6333,-11785.41 6304.48,-11753 6323,-11634.58 6323,-11591.41 6323,-11591.41 6323,-11591.41 6323,-11447.41 6323,-11360.89 6296.9,-11328.99 6339,-11253.41 6352.13,-11229.82 6374.53,-11210.78 6396.37,-11196.51"/>
<polygon fill="black" stroke="black" points="6398.41,-11199.37 6405.02,-11191.09 6394.69,-11193.44 6398.41,-11199.37"/>
</g>
<!-- kv_send1_13_11 -->
<g id="node1102" class="node">
<title>kv_send1_13_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7352" cy="-13163.76" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7352" y="-13167.56" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="7352" y="-13152.56" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_13_11&#45;&gt;kv_send1_13_11 -->
<g id="edge1557" class="edge">
<title>ring_stage1_13_11&#45;&gt;kv_send1_13_11</title>
<path fill="none" stroke="black" d="M7352,-13226.65C7352,-13218.6 7352,-13209.57 7352,-13200.95"/>
<polygon fill="black" stroke="black" points="7355.5,-13200.73 7352,-13190.73 7348.5,-13200.73 7355.5,-13200.73"/>
</g>
<!-- ring_stage1_14_11 -->
<g id="node1118" class="node">
<title>ring_stage1_14_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7700,-13190.26 7480,-13190.26 7480,-13137.26 7700,-13137.26 7700,-13190.26"/>
<text text-anchor="middle" x="7590" y="-13175.06" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7590" y="-13160.06" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_13×V_13</text>
<text text-anchor="middle" x="7590" y="-13145.06" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_13_11&#45;&gt;ring_stage1_14_11 -->
<g id="edge1603" class="edge">
<title>ring_stage1_13_11&#45;&gt;ring_stage1_14_11</title>
<path fill="none" stroke="black" d="M7421.48,-13226.88C7449.46,-13216.57 7481.89,-13204.61 7510.78,-13193.96"/>
<polygon fill="black" stroke="black" points="7512.26,-13197.15 7520.43,-13190.4 7509.84,-13190.58 7512.26,-13197.15"/>
</g>
<!-- kv_send1_13_12 -->
<g id="node1103" class="node">
<title>kv_send1_13_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7074" cy="-13074.02" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7074" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="7074" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_13_12&#45;&gt;kv_send1_13_12 -->
<g id="edge1560" class="edge">
<title>ring_stage1_13_12&#45;&gt;kv_send1_13_12</title>
<path fill="none" stroke="black" d="M7102.22,-13136.91C7098.42,-13128.59 7094.16,-13119.23 7090.11,-13110.35"/>
<polygon fill="black" stroke="black" points="7093.17,-13108.63 7085.84,-13100.99 7086.8,-13111.54 7093.17,-13108.63"/>
</g>
<!-- ring_stage1_14_12 -->
<g id="node1119" class="node">
<title>ring_stage1_14_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7422,-13100.52 7202,-13100.52 7202,-13047.52 7422,-13047.52 7422,-13100.52"/>
<text text-anchor="middle" x="7312" y="-13085.32" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7312" y="-13070.32" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_14×V_14</text>
<text text-anchor="middle" x="7312" y="-13055.32" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_13_12&#45;&gt;ring_stage1_14_12 -->
<g id="edge1606" class="edge">
<title>ring_stage1_13_12&#45;&gt;ring_stage1_14_12</title>
<path fill="none" stroke="black" d="M7171.8,-13137.14C7194.68,-13127.01 7221.12,-13115.29 7244.84,-13104.78"/>
<polygon fill="black" stroke="black" points="7246.4,-13107.91 7254.13,-13100.66 7243.57,-13101.51 7246.4,-13107.91"/>
</g>
<!-- kv_send1_13_13 -->
<g id="node1104" class="node">
<title>kv_send1_13_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6790" cy="-12984.28" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6790" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6790" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_13_13&#45;&gt;kv_send1_13_13 -->
<g id="edge1563" class="edge">
<title>ring_stage1_13_13&#45;&gt;kv_send1_13_13</title>
<path fill="none" stroke="black" d="M6828.8,-13047.17C6823.37,-13038.51 6817.23,-13028.72 6811.47,-13019.52"/>
<polygon fill="black" stroke="black" points="6814.37,-13017.56 6806.09,-13010.94 6808.43,-13021.27 6814.37,-13017.56"/>
</g>
<!-- ring_stage1_14_13 -->
<g id="node1120" class="node">
<title>ring_stage1_14_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7144,-13010.78 6924,-13010.78 6924,-12957.78 7144,-12957.78 7144,-13010.78"/>
<text text-anchor="middle" x="7034" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="7034" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_15×V_15</text>
<text text-anchor="middle" x="7034" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_13_13&#45;&gt;ring_stage1_14_13 -->
<g id="edge1609" class="edge">
<title>ring_stage1_13_13&#45;&gt;ring_stage1_14_13</title>
<path fill="none" stroke="black" d="M6900.17,-13047.4C6921.91,-13037.31 6947.03,-13025.65 6969.59,-13015.18"/>
<polygon fill="black" stroke="black" points="6971.16,-13018.31 6978.76,-13010.92 6968.21,-13011.96 6971.16,-13018.31"/>
</g>
<!-- kv_send1_13_14 -->
<g id="node1105" class="node">
<title>kv_send1_13_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6520" cy="-12868.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6520" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6520" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_13_14&#45;&gt;kv_send1_13_14 -->
<g id="edge1566" class="edge">
<title>ring_stage1_13_14&#45;&gt;kv_send1_13_14</title>
<path fill="none" stroke="black" d="M6547.92,-12957.72C6543,-12942.16 6536.64,-12922.04 6531.23,-12904.93"/>
<polygon fill="black" stroke="black" points="6534.53,-12903.75 6528.18,-12895.27 6527.85,-12905.86 6534.53,-12903.75"/>
</g>
<!-- ring_stage1_14_14 -->
<g id="node1121" class="node">
<title>ring_stage1_14_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6850,-12894.91 6648,-12894.91 6648,-12841.91 6850,-12841.91 6850,-12894.91"/>
<text text-anchor="middle" x="6749" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6749" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_0×V_0</text>
<text text-anchor="middle" x="6749" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_13_14&#45;&gt;ring_stage1_14_14 -->
<g id="edge1612" class="edge">
<title>ring_stage1_13_14&#45;&gt;ring_stage1_14_14</title>
<path fill="none" stroke="black" d="M6599.31,-12957.72C6628.14,-12940.71 6666.18,-12918.27 6696.7,-12900.27"/>
<polygon fill="black" stroke="black" points="6698.66,-12903.17 6705.5,-12895.07 6695.11,-12897.14 6698.66,-12903.17"/>
</g>
<!-- kv_send1_13_15 -->
<g id="node1106" class="node">
<title>kv_send1_13_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6275" cy="-12726.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6275" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="6275" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_13_15&#45;&gt;kv_send1_13_15 -->
<g id="edge1569" class="edge">
<title>ring_stage1_13_15&#45;&gt;kv_send1_13_15</title>
<path fill="none" stroke="black" d="M6288.07,-12841.73C6285.56,-12819.76 6281.91,-12787.91 6279.11,-12763.4"/>
<polygon fill="black" stroke="black" points="6282.58,-12762.93 6277.97,-12753.4 6275.63,-12763.73 6282.58,-12762.93"/>
</g>
<!-- ring_stage1_14_15 -->
<g id="node1122" class="node">
<title>ring_stage1_14_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6598,-12752.91 6396,-12752.91 6396,-12699.91 6598,-12699.91 6598,-12752.91"/>
<text text-anchor="middle" x="6497" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="6497" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_1×V_1</text>
<text text-anchor="middle" x="6497" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_13_15&#45;&gt;ring_stage1_14_15 -->
<g id="edge1615" class="edge">
<title>ring_stage1_13_15&#45;&gt;ring_stage1_14_15</title>
<path fill="none" stroke="black" d="M6328.78,-12841.73C6363.19,-12818.34 6414.1,-12783.75 6450.89,-12758.74"/>
<polygon fill="black" stroke="black" points="6453.15,-12761.44 6459.46,-12752.92 6449.22,-12755.65 6453.15,-12761.44"/>
</g>
<!-- kv_send1_13_0&#45;&gt;ring_stage1_14_1 -->
<g id="edge1574" class="edge">
<title>kv_send1_13_0&#45;&gt;ring_stage1_14_1</title>
<path fill="none" stroke="black" d="M5203.19,-12557.4C5203.34,-12535.5 5203.57,-12503.93 5203.74,-12479.56"/>
<polygon fill="black" stroke="black" points="5207.24,-12479.3 5203.82,-12469.27 5200.24,-12479.25 5207.24,-12479.3"/>
</g>
<!-- kv_send1_13_1&#45;&gt;ring_stage1_14_2 -->
<g id="edge1577" class="edge">
<title>kv_send1_13_1&#45;&gt;ring_stage1_14_2</title>
<path fill="none" stroke="black" d="M4559.54,-12415.4C4566.81,-12393.3 4577.3,-12361.36 4585.34,-12336.91"/>
<polygon fill="black" stroke="black" points="4588.7,-12337.87 4588.5,-12327.27 4582.05,-12335.68 4588.7,-12337.87"/>
</g>
<!-- kv_send1_13_2&#45;&gt;ring_stage1_14_3 -->
<g id="edge1580" class="edge">
<title>kv_send1_13_2&#45;&gt;ring_stage1_14_3</title>
<path fill="none" stroke="black" d="M4392.13,-12277.99C4421.62,-12267.57 4458.38,-12255.57 4492,-12247.41 4591.69,-12223.2 4621.2,-12239.03 4720,-12211.41 4741,-12205.54 4763.21,-12197.22 4783.09,-12188.95"/>
<polygon fill="black" stroke="black" points="4784.49,-12192.16 4792.34,-12185.04 4781.77,-12185.71 4784.49,-12192.16"/>
</g>
<!-- kv_send1_13_3&#45;&gt;ring_stage1_14_4 -->
<g id="edge1583" class="edge">
<title>kv_send1_13_3&#45;&gt;ring_stage1_14_4</title>
<path fill="none" stroke="black" d="M5399.21,-12134.64C5419.99,-12125.26 5444.54,-12114.49 5467,-12105.41 5518.87,-12084.44 5577.85,-12062.86 5624.48,-12046.32"/>
<polygon fill="black" stroke="black" points="5625.68,-12049.61 5633.94,-12042.98 5623.34,-12043.02 5625.68,-12049.61"/>
</g>
<!-- kv_send1_13_4&#45;&gt;ring_stage1_14_5 -->
<g id="edge1586" class="edge">
<title>kv_send1_13_4&#45;&gt;ring_stage1_14_5</title>
<path fill="none" stroke="black" d="M5990.48,-11991.34C6027,-11967.89 6082.69,-11932.12 6122.56,-11906.52"/>
<polygon fill="black" stroke="black" points="6124.54,-11909.4 6131.06,-11901.05 6120.76,-11903.51 6124.54,-11909.4"/>
</g>
<!-- kv_send1_13_5&#45;&gt;ring_stage1_14_6 -->
<g id="edge1589" class="edge">
<title>kv_send1_13_5&#45;&gt;ring_stage1_14_6</title>
<path fill="none" stroke="black" d="M6461.22,-11849.66C6502.22,-11826.03 6565.31,-11789.69 6610.01,-11763.94"/>
<polygon fill="black" stroke="black" points="6611.78,-11766.96 6618.69,-11758.93 6608.28,-11760.89 6611.78,-11766.96"/>
</g>
<!-- kv_send1_13_6&#45;&gt;ring_stage1_14_7 -->
<g id="edge1592" class="edge">
<title>kv_send1_13_6&#45;&gt;ring_stage1_14_7</title>
<path fill="none" stroke="black" d="M6912.77,-11706.7C6942.63,-11683.47 6987.49,-11648.58 7020.04,-11623.27"/>
<polygon fill="black" stroke="black" points="7022.29,-11625.95 7028.03,-11617.05 7017.99,-11620.43 7022.29,-11625.95"/>
</g>
<!-- kv_send1_13_7&#45;&gt;ring_stage1_14_8 -->
<g id="edge1595" class="edge">
<title>kv_send1_13_7&#45;&gt;ring_stage1_14_8</title>
<path fill="none" stroke="black" d="M7393.68,-11565.34C7431.45,-11541.84 7489.1,-11505.97 7530.26,-11480.35"/>
<polygon fill="black" stroke="black" points="7532.14,-11483.31 7538.78,-11475.05 7528.44,-11477.36 7532.14,-11483.31"/>
</g>
<!-- kv_send1_13_8&#45;&gt;ring_stage1_14_9 -->
<g id="edge1598" class="edge">
<title>kv_send1_13_8&#45;&gt;ring_stage1_14_9</title>
<path fill="none" stroke="black" d="M7766.87,-11423.5C7727.38,-11399.97 7666.9,-11363.94 7623.8,-11338.27"/>
<polygon fill="black" stroke="black" points="7625.53,-11335.22 7615.15,-11333.11 7621.95,-11341.24 7625.53,-11335.22"/>
</g>
<!-- kv_send1_13_9&#45;&gt;ring_stage1_14_10 -->
<g id="edge1601" class="edge">
<title>kv_send1_13_9&#45;&gt;ring_stage1_14_10</title>
<path fill="none" stroke="black" d="M6458,-11279.4C6458,-11257.5 6458,-11225.93 6458,-11201.56"/>
<polygon fill="black" stroke="black" points="6461.5,-11201.27 6458,-11191.27 6454.5,-11201.27 6461.5,-11201.27"/>
</g>
<!-- kv_send1_13_10&#45;&gt;ring_stage1_14_11 -->
<g id="edge1604" class="edge">
<title>kv_send1_13_10&#45;&gt;ring_stage1_14_11</title>
<path fill="none" stroke="black" d="M7590,-13226.17C7590,-13218.13 7590,-13209.15 7590,-13200.6"/>
<polygon fill="black" stroke="black" points="7593.5,-13200.46 7590,-13190.46 7586.5,-13200.46 7593.5,-13200.46"/>
</g>
<!-- kv_send1_13_11&#45;&gt;ring_stage1_14_12 -->
<g id="edge1607" class="edge">
<title>kv_send1_13_11&#45;&gt;ring_stage1_14_12</title>
<path fill="none" stroke="black" d="M7340.22,-13136.91C7336.35,-13128.43 7331.99,-13118.86 7327.87,-13109.83"/>
<polygon fill="black" stroke="black" points="7331.03,-13108.33 7323.7,-13100.68 7324.66,-13111.23 7331.03,-13108.33"/>
</g>
<!-- kv_send1_13_12&#45;&gt;ring_stage1_14_13 -->
<g id="edge1610" class="edge">
<title>kv_send1_13_12&#45;&gt;ring_stage1_14_13</title>
<path fill="none" stroke="black" d="M7062.22,-13047.17C7058.35,-13038.69 7053.99,-13029.12 7049.87,-13020.09"/>
<polygon fill="black" stroke="black" points="7053.03,-13018.59 7045.7,-13010.94 7046.66,-13021.49 7053.03,-13018.59"/>
</g>
<!-- kv_send1_13_13&#45;&gt;ring_stage1_14_14 -->
<g id="edge1613" class="edge">
<title>kv_send1_13_13&#45;&gt;ring_stage1_14_14</title>
<path fill="none" stroke="black" d="M6780.7,-12957.44C6775.09,-12941.86 6767.87,-12921.8 6761.73,-12904.77"/>
<polygon fill="black" stroke="black" points="6764.95,-12903.37 6758.27,-12895.14 6758.36,-12905.74 6764.95,-12903.37"/>
</g>
<!-- kv_send1_13_14&#45;&gt;ring_stage1_14_15 -->
<g id="edge1616" class="edge">
<title>kv_send1_13_14&#45;&gt;ring_stage1_14_15</title>
<path fill="none" stroke="black" d="M6515.73,-12841.4C6512.11,-12819.4 6506.9,-12787.64 6502.89,-12763.23"/>
<polygon fill="black" stroke="black" points="6506.32,-12762.57 6501.25,-12753.27 6499.42,-12763.71 6506.32,-12762.57"/>
</g>
<!-- kv_send1_13_15&#45;&gt;ring_stage1_14_0 -->
<g id="edge1571" class="edge">
<title>kv_send1_13_15&#45;&gt;ring_stage1_14_0</title>
<path fill="none" stroke="black" d="M6243.94,-12700.7C6214.86,-12677.57 6171.25,-12642.87 6139.46,-12617.59"/>
<polygon fill="black" stroke="black" points="6141.24,-12614.54 6131.24,-12611.05 6136.88,-12620.01 6141.24,-12614.54"/>
</g>
<!-- kv_send1_14_0 -->
<g id="node1123" class="node">
<title>kv_send1_14_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5949" cy="-12442.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5949" y="-12446.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="5949" y="-12431.21" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage1_14_0&#45;&gt;kv_send1_14_0 -->
<g id="edge1572" class="edge">
<title>ring_stage1_14_0&#45;&gt;kv_send1_14_0</title>
<path fill="none" stroke="black" d="M6071.49,-12557.73C6046.7,-12534.59 6010.16,-12500.49 5983.44,-12475.55"/>
<polygon fill="black" stroke="black" points="5985.53,-12472.72 5975.83,-12468.45 5980.76,-12477.83 5985.53,-12472.72"/>
</g>
<!-- ring_stage1_15_0 -->
<g id="node1139" class="node">
<title>ring_stage1_15_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6716.5,-12468.91 6523.5,-12468.91 6523.5,-12415.91 6716.5,-12415.91 6716.5,-12468.91"/>
<text text-anchor="middle" x="6620" y="-12453.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6620" y="-12438.71" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_1×V_1</text>
<text text-anchor="middle" x="6620" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_14_0&#45;&gt;ring_stage1_15_0 -->
<g id="edge1618" class="edge">
<title>ring_stage1_14_0&#45;&gt;ring_stage1_15_0</title>
<path fill="none" stroke="black" d="M6142.51,-12557.89C6161.17,-12548.07 6183.56,-12537.71 6205,-12531.41 6338.08,-12492.3 6382,-12534.77 6515,-12495.41 6532.94,-12490.1 6551.54,-12481.89 6568.01,-12473.56"/>
<polygon fill="black" stroke="black" points="6569.66,-12476.64 6576.93,-12468.93 6566.44,-12470.43 6569.66,-12476.64"/>
</g>
<!-- kv_send1_14_1 -->
<g id="node1124" class="node">
<title>kv_send1_14_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5074" cy="-12300.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5074" y="-12304.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="5074" y="-12289.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage1_14_1&#45;&gt;kv_send1_14_1 -->
<g id="edge1575" class="edge">
<title>ring_stage1_14_1&#45;&gt;kv_send1_14_1</title>
<path fill="none" stroke="black" d="M5180.16,-12415.73C5158.9,-12392.84 5127.67,-12359.2 5104.58,-12334.34"/>
<polygon fill="black" stroke="black" points="5107.06,-12331.87 5097.69,-12326.92 5101.93,-12336.63 5107.06,-12331.87"/>
</g>
<!-- ring_stage1_15_1 -->
<g id="node1140" class="node">
<title>ring_stage1_15_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6049.5,-12326.91 5856.5,-12326.91 5856.5,-12273.91 6049.5,-12273.91 6049.5,-12326.91"/>
<text text-anchor="middle" x="5953" y="-12311.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="5953" y="-12296.71" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_2×V_2</text>
<text text-anchor="middle" x="5953" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_14_1&#45;&gt;ring_stage1_15_1 -->
<g id="edge1620" class="edge">
<title>ring_stage1_14_1&#45;&gt;ring_stage1_15_1</title>
<path fill="none" stroke="black" d="M5249.61,-12415.82C5269.66,-12405.79 5293.88,-12395.3 5317,-12389.41 5545.78,-12331.1 5618.96,-12414.55 5847,-12353.41 5865.46,-12348.46 5884.53,-12340.22 5901.32,-12331.74"/>
<polygon fill="black" stroke="black" points="5903.14,-12334.74 5910.4,-12327.02 5899.91,-12328.53 5903.14,-12334.74"/>
</g>
<!-- kv_send1_14_2 -->
<g id="node1125" class="node">
<title>kv_send1_14_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4608" cy="-12158.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4608" y="-12162.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="4608" y="-12147.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage1_14_2&#45;&gt;kv_send1_14_2 -->
<g id="edge1578" class="edge">
<title>ring_stage1_14_2&#45;&gt;kv_send1_14_2</title>
<path fill="none" stroke="black" d="M4599.02,-12273.73C4600.74,-12251.76 4603.25,-12219.91 4605.17,-12195.4"/>
<polygon fill="black" stroke="black" points="4608.66,-12195.64 4605.96,-12185.4 4601.69,-12195.09 4608.66,-12195.64"/>
</g>
<!-- ring_stage1_15_2 -->
<g id="node1141" class="node">
<title>ring_stage1_15_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5168.5,-12184.91 4975.5,-12184.91 4975.5,-12131.91 5168.5,-12131.91 5168.5,-12184.91"/>
<text text-anchor="middle" x="5072" y="-12169.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="5072" y="-12154.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_3×V_3</text>
<text text-anchor="middle" x="5072" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_14_2&#45;&gt;ring_stage1_15_2 -->
<g id="edge1622" class="edge">
<title>ring_stage1_14_2&#45;&gt;ring_stage1_15_2</title>
<path fill="none" stroke="black" d="M4663.96,-12273.81C4689.93,-12264.55 4720.08,-12254.62 4748,-12247.41 4837.57,-12224.27 4864.43,-12238.12 4953,-12211.41 4972.57,-12205.5 4993.21,-12197.26 5011.7,-12189.07"/>
<polygon fill="black" stroke="black" points="5013.2,-12192.24 5020.88,-12184.94 5010.32,-12185.85 5013.2,-12192.24"/>
</g>
<!-- kv_send1_14_3 -->
<g id="node1126" class="node">
<title>kv_send1_14_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5435" cy="-12016.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5435" y="-12020.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="5435" y="-12005.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage1_14_3&#45;&gt;kv_send1_14_3 -->
<g id="edge1581" class="edge">
<title>ring_stage1_14_3&#45;&gt;kv_send1_14_3</title>
<path fill="none" stroke="black" d="M4896.89,-12131.8C4918,-12122.02 4943.19,-12111.72 4967,-12105.41 5108.76,-12067.83 5152.29,-12103.19 5295,-12069.41 5321.62,-12063.11 5350.07,-12053.17 5374.33,-12043.66"/>
<polygon fill="black" stroke="black" points="5375.76,-12046.86 5383.75,-12039.9 5373.17,-12040.35 5375.76,-12046.86"/>
</g>
<!-- ring_stage1_15_3 -->
<g id="node1142" class="node">
<title>ring_stage1_15_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4840.5,-12042.91 4647.5,-12042.91 4647.5,-11989.91 4840.5,-11989.91 4840.5,-12042.91"/>
<text text-anchor="middle" x="4744" y="-12027.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="4744" y="-12012.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_4×V_4</text>
<text text-anchor="middle" x="4744" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_14_3&#45;&gt;ring_stage1_15_3 -->
<g id="edge1624" class="edge">
<title>ring_stage1_14_3&#45;&gt;ring_stage1_15_3</title>
<path fill="none" stroke="black" d="M4828.11,-12131.73C4811.41,-12109.03 4786.95,-12075.78 4768.7,-12050.98"/>
<polygon fill="black" stroke="black" points="4771.52,-12048.9 4762.77,-12042.92 4765.88,-12053.05 4771.52,-12048.9"/>
</g>
<!-- kv_send1_14_4 -->
<g id="node1127" class="node">
<title>kv_send1_14_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5953" cy="-11874.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5953" y="-11878.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="5953" y="-11863.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage1_14_4&#45;&gt;kv_send1_14_4 -->
<g id="edge1584" class="edge">
<title>ring_stage1_14_4&#45;&gt;kv_send1_14_4</title>
<path fill="none" stroke="black" d="M5752.65,-11989.89C5795,-11965.69 5858.56,-11929.37 5902.68,-11904.16"/>
<polygon fill="black" stroke="black" points="5904.57,-11907.11 5911.51,-11899.11 5901.09,-11901.04 5904.57,-11907.11"/>
</g>
<!-- ring_stage1_15_4 -->
<g id="node1143" class="node">
<title>ring_stage1_15_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5831.5,-11900.91 5638.5,-11900.91 5638.5,-11847.91 5831.5,-11847.91 5831.5,-11900.91"/>
<text text-anchor="middle" x="5735" y="-11885.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="5735" y="-11870.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_5×V_5</text>
<text text-anchor="middle" x="5735" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_14_4&#45;&gt;ring_stage1_15_4 -->
<g id="edge1626" class="edge">
<title>ring_stage1_14_4&#45;&gt;ring_stage1_15_4</title>
<path fill="none" stroke="black" d="M5712.95,-11989.73C5717.21,-11967.63 5723.41,-11935.51 5728.15,-11910.94"/>
<polygon fill="black" stroke="black" points="5731.62,-11911.4 5730.08,-11900.92 5724.75,-11910.08 5731.62,-11911.4"/>
</g>
<!-- kv_send1_14_5 -->
<g id="node1128" class="node">
<title>kv_send1_14_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6445" cy="-11732.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6445" y="-11736.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6445" y="-11721.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage1_14_5&#45;&gt;kv_send1_14_5 -->
<g id="edge1587" class="edge">
<title>ring_stage1_14_5&#45;&gt;kv_send1_14_5</title>
<path fill="none" stroke="black" d="M6220.94,-11847.89C6268.89,-11823.39 6341.14,-11786.47 6390.55,-11761.23"/>
<polygon fill="black" stroke="black" points="6392.19,-11764.32 6399.5,-11756.65 6389,-11758.09 6392.19,-11764.32"/>
</g>
<!-- ring_stage1_15_5 -->
<g id="node1144" class="node">
<title>ring_stage1_15_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6166.5,-11758.91 5973.5,-11758.91 5973.5,-11705.91 6166.5,-11705.91 6166.5,-11758.91"/>
<text text-anchor="middle" x="6070" y="-11743.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6070" y="-11728.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_6×V_6</text>
<text text-anchor="middle" x="6070" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_14_5&#45;&gt;ring_stage1_15_5 -->
<g id="edge1628" class="edge">
<title>ring_stage1_14_5&#45;&gt;ring_stage1_15_5</title>
<path fill="none" stroke="black" d="M6152.48,-11847.73C6136.17,-11825.13 6112.32,-11792.07 6094.45,-11767.3"/>
<polygon fill="black" stroke="black" points="6097.1,-11764.98 6088.41,-11758.92 6091.42,-11769.08 6097.1,-11764.98"/>
</g>
<!-- kv_send1_14_6 -->
<g id="node1129" class="node">
<title>kv_send1_14_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6819" cy="-11590.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6819" y="-11594.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6819" y="-11579.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage1_14_6&#45;&gt;kv_send1_14_6 -->
<g id="edge1590" class="edge">
<title>ring_stage1_14_6&#45;&gt;kv_send1_14_6</title>
<path fill="none" stroke="black" d="M6691.61,-11705.73C6717.5,-11682.49 6755.72,-11648.19 6783.54,-11623.23"/>
<polygon fill="black" stroke="black" points="6785.99,-11625.74 6791.09,-11616.45 6781.31,-11620.53 6785.99,-11625.74"/>
</g>
<!-- ring_stage1_15_6 -->
<g id="node1145" class="node">
<title>ring_stage1_15_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6674.5,-11616.91 6481.5,-11616.91 6481.5,-11563.91 6674.5,-11563.91 6674.5,-11616.91"/>
<text text-anchor="middle" x="6578" y="-11601.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6578" y="-11586.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_7×V_7</text>
<text text-anchor="middle" x="6578" y="-11571.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_14_6&#45;&gt;ring_stage1_15_6 -->
<g id="edge1630" class="edge">
<title>ring_stage1_14_6&#45;&gt;ring_stage1_15_6</title>
<path fill="none" stroke="black" d="M6647.41,-11705.73C6633.75,-11683.23 6613.79,-11650.36 6598.78,-11625.63"/>
<polygon fill="black" stroke="black" points="6601.67,-11623.65 6593.49,-11616.92 6595.69,-11627.29 6601.67,-11623.65"/>
</g>
<!-- kv_send1_14_7 -->
<g id="node1130" class="node">
<title>kv_send1_14_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7124" cy="-11448.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7124" y="-11452.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="7124" y="-11437.21" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage1_14_7&#45;&gt;kv_send1_14_7 -->
<g id="edge1593" class="edge">
<title>ring_stage1_14_7&#45;&gt;kv_send1_14_7</title>
<path fill="none" stroke="black" d="M7072.56,-11563.73C7082.53,-11541.57 7097.03,-11509.34 7108.1,-11484.75"/>
<polygon fill="black" stroke="black" points="7111.39,-11485.95 7112.3,-11475.4 7105.01,-11483.08 7111.39,-11485.95"/>
</g>
<!-- ring_stage1_15_7 -->
<g id="node1146" class="node">
<title>ring_stage1_15_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7002.5,-11474.91 6809.5,-11474.91 6809.5,-11421.91 7002.5,-11421.91 7002.5,-11474.91"/>
<text text-anchor="middle" x="6906" y="-11459.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6906" y="-11444.71" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_8×V_8</text>
<text text-anchor="middle" x="6906" y="-11429.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_14_7&#45;&gt;ring_stage1_15_7 -->
<g id="edge1632" class="edge">
<title>ring_stage1_14_7&#45;&gt;ring_stage1_15_7</title>
<path fill="none" stroke="black" d="M7032.57,-11563.73C7007.01,-11540.64 6969.34,-11506.62 6941.75,-11481.69"/>
<polygon fill="black" stroke="black" points="6944.02,-11479.03 6934.25,-11474.92 6939.32,-11484.22 6944.02,-11479.03"/>
</g>
<!-- kv_send1_14_8 -->
<g id="node1131" class="node">
<title>kv_send1_14_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7799" cy="-11306.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7799" y="-11310.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="7799" y="-11295.21" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage1_14_8&#45;&gt;kv_send1_14_8 -->
<g id="edge1596" class="edge">
<title>ring_stage1_14_8&#45;&gt;kv_send1_14_8</title>
<path fill="none" stroke="black" d="M7619.91,-11421.89C7657.31,-11397.99 7713.18,-11362.27 7752.56,-11337.1"/>
<polygon fill="black" stroke="black" points="7754.65,-11339.91 7761.19,-11331.58 7750.88,-11334.01 7754.65,-11339.91"/>
</g>
<!-- ring_stage1_15_8 -->
<g id="node1147" class="node">
<title>ring_stage1_15_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7448.5,-11332.91 7255.5,-11332.91 7255.5,-11279.91 7448.5,-11279.91 7448.5,-11332.91"/>
<text text-anchor="middle" x="7352" y="-11317.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="7352" y="-11302.71" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_9×V_9</text>
<text text-anchor="middle" x="7352" y="-11287.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_14_8&#45;&gt;ring_stage1_15_8 -->
<g id="edge1634" class="edge">
<title>ring_stage1_14_8&#45;&gt;ring_stage1_15_8</title>
<path fill="none" stroke="black" d="M7538.45,-11421.89C7500.15,-11398.38 7443.24,-11363.43 7402.38,-11338.34"/>
<polygon fill="black" stroke="black" points="7404.01,-11335.23 7393.65,-11332.98 7400.34,-11341.2 7404.01,-11335.23"/>
</g>
<!-- kv_send1_14_9 -->
<g id="node1132" class="node">
<title>kv_send1_14_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6848" cy="-11164.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6848" y="-11168.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="6848" y="-11153.21" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage1_14_9&#45;&gt;kv_send1_14_9 -->
<g id="edge1599" class="edge">
<title>ring_stage1_14_9&#45;&gt;kv_send1_14_9</title>
<path fill="none" stroke="black" d="M7525.95,-11279.88C7505.71,-11269.87 7481.29,-11259.37 7458,-11253.41 7246.03,-11199.15 7179.4,-11269.97 6967,-11217.41 6944.8,-11211.91 6921.51,-11202.61 6901.48,-11193.38"/>
<polygon fill="black" stroke="black" points="6902.76,-11190.11 6892.22,-11189.01 6899.77,-11196.44 6902.76,-11190.11"/>
</g>
<!-- ring_stage1_15_9 -->
<g id="node1148" class="node">
<title>ring_stage1_15_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7856.5,-11190.91 7645.5,-11190.91 7645.5,-11137.91 7856.5,-11137.91 7856.5,-11190.91"/>
<text text-anchor="middle" x="7751" y="-11175.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="7751" y="-11160.71" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_10×V_10</text>
<text text-anchor="middle" x="7751" y="-11145.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_14_9&#45;&gt;ring_stage1_15_9 -->
<g id="edge1636" class="edge">
<title>ring_stage1_14_9&#45;&gt;ring_stage1_15_9</title>
<path fill="none" stroke="black" d="M7604.83,-11279.73C7634.48,-11256.54 7678.22,-11222.33 7710.13,-11197.38"/>
<polygon fill="black" stroke="black" points="7712.66,-11199.84 7718.38,-11190.92 7708.34,-11194.33 7712.66,-11199.84"/>
</g>
<!-- kv_send1_14_10 -->
<g id="node1133" class="node">
<title>kv_send1_14_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6458" cy="-11022.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6458" y="-11026.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="6458" y="-11011.21" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage1_14_10&#45;&gt;kv_send1_14_10 -->
<g id="edge1602" class="edge">
<title>ring_stage1_14_10&#45;&gt;kv_send1_14_10</title>
<path fill="none" stroke="black" d="M6458,-11137.73C6458,-11115.76 6458,-11083.91 6458,-11059.4"/>
<polygon fill="black" stroke="black" points="6461.5,-11059.4 6458,-11049.4 6454.5,-11059.4 6461.5,-11059.4"/>
</g>
<!-- ring_stage1_15_10 -->
<g id="node1149" class="node">
<title>ring_stage1_15_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6958,-11048.91 6738,-11048.91 6738,-10995.91 6958,-10995.91 6958,-11048.91"/>
<text text-anchor="middle" x="6848" y="-11033.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6848" y="-11018.71" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_11×V_11</text>
<text text-anchor="middle" x="6848" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_14_10&#45;&gt;ring_stage1_15_10 -->
<g id="edge1638" class="edge">
<title>ring_stage1_14_10&#45;&gt;ring_stage1_15_10</title>
<path fill="none" stroke="black" d="M6529.08,-11137.89C6596.23,-11113.79 6696.85,-11077.67 6767.05,-11052.46"/>
<polygon fill="black" stroke="black" points="6768.52,-11055.66 6776.75,-11048.98 6766.16,-11049.07 6768.52,-11055.66"/>
</g>
<!-- kv_send1_14_11 -->
<g id="node1134" class="node">
<title>kv_send1_14_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7570" cy="-13074.02" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7570" y="-13077.82" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="7570" y="-13062.82" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage1_14_11&#45;&gt;kv_send1_14_11 -->
<g id="edge1605" class="edge">
<title>ring_stage1_14_11&#45;&gt;kv_send1_14_11</title>
<path fill="none" stroke="black" d="M7584.11,-13136.91C7582.25,-13128.77 7580.17,-13119.63 7578.18,-13110.92"/>
<polygon fill="black" stroke="black" points="7581.55,-13109.96 7575.92,-13100.99 7574.73,-13111.51 7581.55,-13109.96"/>
</g>
<!-- ring_stage1_15_11 -->
<g id="node1150" class="node">
<title>ring_stage1_15_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6568,-10906.91 6348,-10906.91 6348,-10853.91 6568,-10853.91 6568,-10906.91"/>
<text text-anchor="middle" x="6458" y="-10891.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6458" y="-10876.71" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_12×V_12</text>
<text text-anchor="middle" x="6458" y="-10861.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_14_11&#45;&gt;ring_stage1_15_11 -->
<g id="edge1640" class="edge">
<title>ring_stage1_14_11&#45;&gt;ring_stage1_15_11</title>
<path fill="none" stroke="black" d="M7496.95,-13137.09C7479.33,-13128.26 7462.76,-13116.5 7451,-13100.89 7412.28,-13049.45 7468.41,-13009.81 7431,-12957.41 7410.44,-12928.61 7378.52,-12951.56 7360,-12921.41 7335.34,-12881.26 7330.36,-12852.03 7360,-12815.41 7408.32,-12755.71 7480.68,-12839.1 7529,-12779.41 7558.64,-12742.79 7561.35,-12707.66 7529,-12673.41 7432.71,-12571.46 7004.36,-12729.94 6899,-12637.41 6862.98,-12605.77 6902.18,-12573.37 6879,-12531.41 6834.15,-12450.19 6810.82,-12426.98 6726,-12389.41 6640.76,-12351.64 6372.78,-12420.46 6308,-12353.41 6278.01,-12322.36 6298,-12202.58 6298,-12159.41 6298,-12159.41 6298,-12159.41 6298,-12015.41 6298,-11763.84 6303,-11700.97 6303,-11449.41 6303,-11449.41 6303,-11449.41 6303,-11163.41 6303,-11075.71 6292.51,-11043.76 6339,-10969.41 6353.55,-10946.13 6376.68,-10926.96 6398.69,-10912.52"/>
<polygon fill="black" stroke="black" points="6400.8,-10915.33 6407.38,-10907.02 6397.05,-10909.41 6400.8,-10915.33"/>
</g>
<!-- kv_send1_14_12 -->
<g id="node1135" class="node">
<title>kv_send1_14_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7312" cy="-12984.28" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="7312" y="-12988.08" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="7312" y="-12973.08" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage1_14_12&#45;&gt;kv_send1_14_12 -->
<g id="edge1608" class="edge">
<title>ring_stage1_14_12&#45;&gt;kv_send1_14_12</title>
<path fill="none" stroke="black" d="M7312,-13047.17C7312,-13039.12 7312,-13030.09 7312,-13021.47"/>
<polygon fill="black" stroke="black" points="7315.5,-13021.25 7312,-13011.25 7308.5,-13021.25 7315.5,-13021.25"/>
</g>
<!-- ring_stage1_15_12 -->
<g id="node1151" class="node">
<title>ring_stage1_15_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7680,-13010.78 7460,-13010.78 7460,-12957.78 7680,-12957.78 7680,-13010.78"/>
<text text-anchor="middle" x="7570" y="-12995.58" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="7570" y="-12980.58" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_13×V_13</text>
<text text-anchor="middle" x="7570" y="-12965.58" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_14_12&#45;&gt;ring_stage1_15_12 -->
<g id="edge1642" class="edge">
<title>ring_stage1_14_12&#45;&gt;ring_stage1_15_12</title>
<path fill="none" stroke="black" d="M7387.32,-13047.4C7417.92,-13037 7453.42,-13024.92 7484.94,-13014.2"/>
<polygon fill="black" stroke="black" points="7486.25,-13017.46 7494.59,-13010.92 7483.99,-13010.83 7486.25,-13017.46"/>
</g>
<!-- kv_send1_14_13 -->
<g id="node1136" class="node">
<title>kv_send1_14_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6978" cy="-12868.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6978" y="-12872.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="6978" y="-12857.21" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage1_14_13&#45;&gt;kv_send1_14_13 -->
<g id="edge1611" class="edge">
<title>ring_stage1_14_13&#45;&gt;kv_send1_14_13</title>
<path fill="none" stroke="black" d="M7021.43,-12957.72C7013.71,-12942.01 7003.7,-12921.66 6995.24,-12904.46"/>
<polygon fill="black" stroke="black" points="6998.27,-12902.7 6990.72,-12895.27 6991.99,-12905.79 6998.27,-12902.7"/>
</g>
<!-- ring_stage1_15_13 -->
<g id="node1152" class="node">
<title>ring_stage1_15_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7326,-12894.91 7106,-12894.91 7106,-12841.91 7326,-12841.91 7326,-12894.91"/>
<text text-anchor="middle" x="7216" y="-12879.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="7216" y="-12864.71" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_14×V_14</text>
<text text-anchor="middle" x="7216" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_14_13&#45;&gt;ring_stage1_15_13 -->
<g id="edge1644" class="edge">
<title>ring_stage1_14_13&#45;&gt;ring_stage1_15_13</title>
<path fill="none" stroke="black" d="M7074.84,-12957.72C7101.91,-12940.79 7137.59,-12918.46 7166.31,-12900.5"/>
<polygon fill="black" stroke="black" points="7168.36,-12903.34 7174.98,-12895.07 7164.64,-12897.41 7168.36,-12903.34"/>
</g>
<!-- kv_send1_14_14 -->
<g id="node1137" class="node">
<title>kv_send1_14_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6726" cy="-12726.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="6726" y="-12730.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="6726" y="-12715.21" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage1_14_14&#45;&gt;kv_send1_14_14 -->
<g id="edge1614" class="edge">
<title>ring_stage1_14_14&#45;&gt;kv_send1_14_14</title>
<path fill="none" stroke="black" d="M6744.78,-12841.73C6741.17,-12819.76 6735.94,-12787.91 6731.91,-12763.4"/>
<polygon fill="black" stroke="black" points="6735.34,-12762.7 6730.27,-12753.4 6728.44,-12763.83 6735.34,-12762.7"/>
</g>
<!-- ring_stage1_15_14 -->
<g id="node1153" class="node">
<title>ring_stage1_15_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7074,-12752.91 6854,-12752.91 6854,-12699.91 7074,-12699.91 7074,-12752.91"/>
<text text-anchor="middle" x="6964" y="-12737.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6964" y="-12722.71" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_15×V_15</text>
<text text-anchor="middle" x="6964" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_14_14&#45;&gt;ring_stage1_15_14 -->
<g id="edge1646" class="edge">
<title>ring_stage1_14_14&#45;&gt;ring_stage1_15_14</title>
<path fill="none" stroke="black" d="M6788.43,-12841.73C6824.5,-12818.24 6877.93,-12783.45 6916.37,-12758.42"/>
<polygon fill="black" stroke="black" points="6918.35,-12761.31 6924.82,-12752.92 6914.53,-12755.45 6918.35,-12761.31"/>
</g>
<!-- kv_send1_14_15 -->
<g id="node1138" class="node">
<title>kv_send1_14_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6317" cy="-12584.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6317" y="-12588.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="6317" y="-12573.21" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage1_14_15&#45;&gt;kv_send1_14_15 -->
<g id="edge1617" class="edge">
<title>ring_stage1_14_15&#45;&gt;kv_send1_14_15</title>
<path fill="none" stroke="black" d="M6463.99,-12699.73C6433.76,-12676.22 6388.98,-12641.39 6356.79,-12616.36"/>
<polygon fill="black" stroke="black" points="6358.94,-12613.59 6348.9,-12610.22 6354.64,-12619.12 6358.94,-12613.59"/>
</g>
<!-- ring_stage1_15_15 -->
<g id="node1154" class="node">
<title>ring_stage1_15_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6870,-12610.91 6668,-12610.91 6668,-12557.91 6870,-12557.91 6870,-12610.91"/>
<text text-anchor="middle" x="6769" y="-12595.71" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="6769" y="-12580.71" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_0×V_0</text>
<text text-anchor="middle" x="6769" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_14_15&#45;&gt;ring_stage1_15_15 -->
<g id="edge1648" class="edge">
<title>ring_stage1_14_15&#45;&gt;ring_stage1_15_15</title>
<path fill="none" stroke="black" d="M6546.57,-12699.89C6592.64,-12676.18 6661.29,-12640.85 6710.13,-12615.71"/>
<polygon fill="black" stroke="black" points="6712.02,-12618.67 6719.31,-12610.98 6708.82,-12612.45 6712.02,-12618.67"/>
</g>
<!-- kv_send1_14_0&#45;&gt;ring_stage1_15_1 -->
<g id="edge1621" class="edge">
<title>kv_send1_14_0&#45;&gt;ring_stage1_15_1</title>
<path fill="none" stroke="black" d="M5949.74,-12415.4C5950.37,-12393.5 5951.27,-12361.93 5951.97,-12337.56"/>
<polygon fill="black" stroke="black" points="5955.47,-12337.37 5952.26,-12327.27 5948.48,-12337.17 5955.47,-12337.37"/>
</g>
<!-- kv_send1_14_1&#45;&gt;ring_stage1_15_2 -->
<g id="edge1623" class="edge">
<title>kv_send1_14_1&#45;&gt;ring_stage1_15_2</title>
<path fill="none" stroke="black" d="M5073.63,-12273.4C5073.32,-12251.5 5072.86,-12219.93 5072.52,-12195.56"/>
<polygon fill="black" stroke="black" points="5076.01,-12195.22 5072.37,-12185.27 5069.01,-12195.32 5076.01,-12195.22"/>
</g>
<!-- kv_send1_14_2&#45;&gt;ring_stage1_15_3 -->
<g id="edge1625" class="edge">
<title>kv_send1_14_2&#45;&gt;ring_stage1_15_3</title>
<path fill="none" stroke="black" d="M4632.63,-12132.05C4654.83,-12109.2 4687.61,-12075.46 4711.86,-12050.49"/>
<polygon fill="black" stroke="black" points="4714.64,-12052.66 4719.1,-12043.04 4709.62,-12047.78 4714.64,-12052.66"/>
</g>
<!-- kv_send1_14_3&#45;&gt;ring_stage1_15_4 -->
<g id="edge1627" class="edge">
<title>kv_send1_14_3&#45;&gt;ring_stage1_15_4</title>
<path fill="none" stroke="black" d="M5486.14,-11992.93C5525.61,-11975.44 5581.48,-11950.36 5630,-11927.41 5644.69,-11920.46 5660.45,-11912.78 5675.16,-11905.5"/>
<polygon fill="black" stroke="black" points="5676.77,-11908.61 5684.18,-11901.03 5673.66,-11902.34 5676.77,-11908.61"/>
</g>
<!-- kv_send1_14_4&#45;&gt;ring_stage1_15_5 -->
<g id="edge1629" class="edge">
<title>kv_send1_14_4&#45;&gt;ring_stage1_15_5</title>
<path fill="none" stroke="black" d="M5974.19,-11848.05C5993.2,-11825.3 6021.24,-11791.75 6042.08,-11766.81"/>
<polygon fill="black" stroke="black" points="6044.85,-11768.96 6048.57,-11759.04 6039.48,-11764.47 6044.85,-11768.96"/>
</g>
<!-- kv_send1_14_5&#45;&gt;ring_stage1_15_6 -->
<g id="edge1631" class="edge">
<title>kv_send1_14_5&#45;&gt;ring_stage1_15_6</title>
<path fill="none" stroke="black" d="M6469.09,-11706.05C6490.79,-11683.2 6522.85,-11649.46 6546.57,-11624.49"/>
<polygon fill="black" stroke="black" points="6549.29,-11626.71 6553.64,-11617.04 6544.22,-11621.88 6549.29,-11626.71"/>
</g>
<!-- kv_send1_14_6&#45;&gt;ring_stage1_15_7 -->
<g id="edge1633" class="edge">
<title>kv_send1_14_6&#45;&gt;ring_stage1_15_7</title>
<path fill="none" stroke="black" d="M6834.96,-11563.73C6848.94,-11541.23 6869.37,-11508.36 6884.73,-11483.63"/>
<polygon fill="black" stroke="black" points="6887.84,-11485.26 6890.14,-11474.92 6881.89,-11481.57 6887.84,-11485.26"/>
</g>
<!-- kv_send1_14_7&#45;&gt;ring_stage1_15_8 -->
<g id="edge1635" class="edge">
<title>kv_send1_14_7&#45;&gt;ring_stage1_15_8</title>
<path fill="none" stroke="black" d="M7162.94,-11423.5C7201.17,-11400.02 7259.68,-11364.09 7301.48,-11338.43"/>
<polygon fill="black" stroke="black" points="7303.44,-11341.33 7310.13,-11333.11 7299.78,-11335.36 7303.44,-11341.33"/>
</g>
<!-- kv_send1_14_8&#45;&gt;ring_stage1_15_9 -->
<g id="edge1637" class="edge">
<title>kv_send1_14_8&#45;&gt;ring_stage1_15_9</title>
<path fill="none" stroke="black" d="M7790.08,-11279.4C7782.51,-11257.3 7771.56,-11225.36 7763.17,-11200.91"/>
<polygon fill="black" stroke="black" points="7766.42,-11199.6 7759.87,-11191.27 7759.8,-11201.87 7766.42,-11199.6"/>
</g>
<!-- kv_send1_14_9&#45;&gt;ring_stage1_15_10 -->
<g id="edge1639" class="edge">
<title>kv_send1_14_9&#45;&gt;ring_stage1_15_10</title>
<path fill="none" stroke="black" d="M6848,-11137.4C6848,-11115.5 6848,-11083.93 6848,-11059.56"/>
<polygon fill="black" stroke="black" points="6851.5,-11059.27 6848,-11049.27 6844.5,-11059.27 6851.5,-11059.27"/>
</g>
<!-- kv_send1_14_10&#45;&gt;ring_stage1_15_11 -->
<g id="edge1641" class="edge">
<title>kv_send1_14_10&#45;&gt;ring_stage1_15_11</title>
<path fill="none" stroke="black" d="M6458,-10995.4C6458,-10973.5 6458,-10941.93 6458,-10917.56"/>
<polygon fill="black" stroke="black" points="6461.5,-10917.27 6458,-10907.27 6454.5,-10917.27 6461.5,-10917.27"/>
</g>
<!-- kv_send1_14_11&#45;&gt;ring_stage1_15_12 -->
<g id="edge1643" class="edge">
<title>kv_send1_14_11&#45;&gt;ring_stage1_15_12</title>
<path fill="none" stroke="black" d="M7570,-13046.69C7570,-13038.65 7570,-13029.67 7570,-13021.12"/>
<polygon fill="black" stroke="black" points="7573.5,-13020.98 7570,-13010.98 7566.5,-13020.98 7573.5,-13020.98"/>
</g>
<!-- kv_send1_14_12&#45;&gt;ring_stage1_15_13 -->
<g id="edge1645" class="edge">
<title>kv_send1_14_12&#45;&gt;ring_stage1_15_13</title>
<path fill="none" stroke="black" d="M7290.46,-12957.72C7276.84,-12941.57 7259.1,-12920.53 7244.35,-12903.03"/>
<polygon fill="black" stroke="black" points="7246.93,-12900.66 7237.8,-12895.27 7241.57,-12905.17 7246.93,-12900.66"/>
</g>
<!-- kv_send1_14_13&#45;&gt;ring_stage1_15_14 -->
<g id="edge1647" class="edge">
<title>kv_send1_14_13&#45;&gt;ring_stage1_15_14</title>
<path fill="none" stroke="black" d="M6975.4,-12841.4C6973.2,-12819.4 6970.02,-12787.64 6967.58,-12763.23"/>
<polygon fill="black" stroke="black" points="6971.06,-12762.87 6966.59,-12753.27 6964.1,-12763.57 6971.06,-12762.87"/>
</g>
<!-- kv_send1_14_14&#45;&gt;ring_stage1_15_15 -->
<g id="edge1649" class="edge">
<title>kv_send1_14_14&#45;&gt;ring_stage1_15_15</title>
<path fill="none" stroke="black" d="M6733.99,-12699.4C6740.78,-12677.3 6750.59,-12645.36 6758.1,-12620.91"/>
<polygon fill="black" stroke="black" points="6761.47,-12621.86 6761.06,-12611.27 6754.77,-12619.8 6761.47,-12621.86"/>
</g>
<!-- kv_send1_14_15&#45;&gt;ring_stage1_15_0 -->
<g id="edge1619" class="edge">
<title>kv_send1_14_15&#45;&gt;ring_stage1_15_0</title>
<path fill="none" stroke="black" d="M6365.52,-12560.68C6385.44,-12551.46 6408.76,-12540.79 6430,-12531.41 6467.53,-12514.83 6477.71,-12512.52 6515,-12495.41 6529.93,-12488.56 6545.88,-12480.85 6560.74,-12473.52"/>
<polygon fill="black" stroke="black" points="6562.42,-12476.59 6569.82,-12469.01 6559.31,-12470.32 6562.42,-12476.59"/>
</g>
<!-- accum1_0 -->
<g id="node1171" class="node">
<title>accum1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6968.64,-12353.41 6628.79,-12353.41 6541.36,-12247.41 6881.21,-12247.41 6968.64,-12353.41"/>
<text text-anchor="middle" x="6755" y="-12311.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="6755" y="-12296.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6755" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage1_15_0&#45;&gt;accum1_0 -->
<g id="edge1650" class="edge">
<title>ring_stage1_15_0&#45;&gt;accum1_0</title>
<path fill="none" stroke="black" d="M6644.76,-12415.73C6659.61,-12400.33 6679.15,-12380.07 6697.64,-12360.89"/>
<polygon fill="black" stroke="black" points="6700.25,-12363.23 6704.67,-12353.6 6695.21,-12358.37 6700.25,-12363.23"/>
</g>
<!-- accum1_1 -->
<g id="node1172" class="node">
<title>accum1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7403.64,-12211.41 7063.79,-12211.41 6976.36,-12105.41 7316.21,-12105.41 7403.64,-12211.41"/>
<text text-anchor="middle" x="7190" y="-12169.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7190" y="-12154.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7190" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage1_15_1&#45;&gt;accum1_1 -->
<g id="edge1659" class="edge">
<title>ring_stage1_15_1&#45;&gt;accum1_1</title>
<path fill="none" stroke="black" d="M5994.76,-12273.9C6013.67,-12263.7 6036.74,-12253.04 6059,-12247.41 6254.98,-12197.82 6767.68,-12238.58 6968,-12211.41 6991.79,-12208.18 7016.76,-12203.56 7041.03,-12198.4"/>
<polygon fill="black" stroke="black" points="7041.98,-12201.77 7051.01,-12196.23 7040.5,-12194.93 7041.98,-12201.77"/>
</g>
<!-- accum1_2 -->
<g id="node1173" class="node">
<title>accum1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5285.64,-12069.41 4945.79,-12069.41 4858.36,-11963.41 5198.21,-11963.41 5285.64,-12069.41"/>
<text text-anchor="middle" x="5072" y="-12027.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="5072" y="-12012.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5072" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage1_15_2&#45;&gt;accum1_2 -->
<g id="edge1668" class="edge">
<title>ring_stage1_15_2&#45;&gt;accum1_2</title>
<path fill="none" stroke="black" d="M5072,-12131.73C5072,-12117.08 5072,-12098.02 5072,-12079.68"/>
<polygon fill="black" stroke="black" points="5075.5,-12079.6 5072,-12069.6 5068.5,-12079.6 5075.5,-12079.6"/>
</g>
<!-- accum1_3 -->
<g id="node1174" class="node">
<title>accum1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5620.64,-11927.41 5280.79,-11927.41 5193.36,-11821.41 5533.21,-11821.41 5620.64,-11927.41"/>
<text text-anchor="middle" x="5407" y="-11885.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="5407" y="-11870.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5407" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage1_15_3&#45;&gt;accum1_3 -->
<g id="edge1677" class="edge">
<title>ring_stage1_15_3&#45;&gt;accum1_3</title>
<path fill="none" stroke="black" d="M4787.05,-11989.79C4805.52,-11979.96 4827.71,-11969.61 4849,-11963.41 4992.77,-11921.53 5036.36,-11952.46 5184,-11927.41 5207.68,-11923.39 5232.61,-11918.37 5256.87,-11913.05"/>
<polygon fill="black" stroke="black" points="5257.86,-11916.42 5266.86,-11910.83 5256.34,-11909.58 5257.86,-11916.42"/>
</g>
<!-- accum1_4 -->
<g id="node1175" class="node">
<title>accum1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5955.64,-11785.41 5615.79,-11785.41 5528.36,-11679.41 5868.21,-11679.41 5955.64,-11785.41"/>
<text text-anchor="middle" x="5742" y="-11743.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="5742" y="-11728.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5742" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage1_15_4&#45;&gt;accum1_4 -->
<g id="edge1686" class="edge">
<title>ring_stage1_15_4&#45;&gt;accum1_4</title>
<path fill="none" stroke="black" d="M5736.28,-11847.73C5737.02,-11833.08 5737.97,-11814.02 5738.89,-11795.68"/>
<polygon fill="black" stroke="black" points="5742.39,-11795.76 5739.39,-11785.6 5735.4,-11795.41 5742.39,-11795.76"/>
</g>
<!-- accum1_5 -->
<g id="node1176" class="node">
<title>accum1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6283.64,-11643.41 5943.79,-11643.41 5856.36,-11537.41 6196.21,-11537.41 6283.64,-11643.41"/>
<text text-anchor="middle" x="6070" y="-11601.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="6070" y="-11586.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6070" y="-11571.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage1_15_5&#45;&gt;accum1_5 -->
<g id="edge1695" class="edge">
<title>ring_stage1_15_5&#45;&gt;accum1_5</title>
<path fill="none" stroke="black" d="M6070,-11705.73C6070,-11691.08 6070,-11672.02 6070,-11653.68"/>
<polygon fill="black" stroke="black" points="6073.5,-11653.6 6070,-11643.6 6066.5,-11653.6 6073.5,-11653.6"/>
</g>
<!-- accum1_6 -->
<g id="node1177" class="node">
<title>accum1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6791.64,-11501.41 6451.79,-11501.41 6364.36,-11395.41 6704.21,-11395.41 6791.64,-11501.41"/>
<text text-anchor="middle" x="6578" y="-11459.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="6578" y="-11444.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6578" y="-11429.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage1_15_6&#45;&gt;accum1_6 -->
<g id="edge1704" class="edge">
<title>ring_stage1_15_6&#45;&gt;accum1_6</title>
<path fill="none" stroke="black" d="M6578,-11563.73C6578,-11549.08 6578,-11530.02 6578,-11511.68"/>
<polygon fill="black" stroke="black" points="6581.5,-11511.6 6578,-11501.6 6574.5,-11511.6 6581.5,-11511.6"/>
</g>
<!-- accum1_7 -->
<g id="node1178" class="node">
<title>accum1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7237.64,-11359.41 6897.79,-11359.41 6810.36,-11253.41 7150.21,-11253.41 7237.64,-11359.41"/>
<text text-anchor="middle" x="7024" y="-11317.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7024" y="-11302.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7024" y="-11287.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage1_15_7&#45;&gt;accum1_7 -->
<g id="edge1713" class="edge">
<title>ring_stage1_15_7&#45;&gt;accum1_7</title>
<path fill="none" stroke="black" d="M6927.64,-11421.73C6940.51,-11406.47 6957.4,-11386.43 6973.44,-11367.39"/>
<polygon fill="black" stroke="black" points="6976.24,-11369.5 6980.01,-11359.6 6970.89,-11364.99 6976.24,-11369.5"/>
</g>
<!-- accum1_8 -->
<g id="node1179" class="node">
<title>accum1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7627.64,-11217.41 7287.79,-11217.41 7200.36,-11111.41 7540.21,-11111.41 7627.64,-11217.41"/>
<text text-anchor="middle" x="7414" y="-11175.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7414" y="-11160.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7414" y="-11145.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage1_15_8&#45;&gt;accum1_8 -->
<g id="edge1722" class="edge">
<title>ring_stage1_15_8&#45;&gt;accum1_8</title>
<path fill="none" stroke="black" d="M7363.37,-11279.73C7369.95,-11264.87 7378.53,-11245.49 7386.76,-11226.92"/>
<polygon fill="black" stroke="black" points="7390.04,-11228.16 7390.89,-11217.6 7383.64,-11225.33 7390.04,-11228.16"/>
</g>
<!-- accum1_9 -->
<g id="node1180" class="node">
<title>accum1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7687.64,-11075.41 7347.79,-11075.41 7260.36,-10969.41 7600.21,-10969.41 7687.64,-11075.41"/>
<text text-anchor="middle" x="7474" y="-11033.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7474" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7474" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage1_15_9&#45;&gt;accum1_9 -->
<g id="edge1731" class="edge">
<title>ring_stage1_15_9&#45;&gt;accum1_9</title>
<path fill="none" stroke="black" d="M7700.52,-11137.89C7668.45,-11121.69 7625.65,-11100.05 7585.88,-11079.95"/>
<polygon fill="black" stroke="black" points="7587.42,-11076.81 7576.92,-11075.42 7584.27,-11083.06 7587.42,-11076.81"/>
</g>
<!-- accum1_10 -->
<g id="node1181" class="node">
<title>accum1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7290.64,-10933.41 6950.79,-10933.41 6863.36,-10827.41 7203.21,-10827.41 7290.64,-10933.41"/>
<text text-anchor="middle" x="7077" y="-10891.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7077" y="-10876.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7077" y="-10861.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage1_15_10&#45;&gt;accum1_10 -->
<g id="edge1740" class="edge">
<title>ring_stage1_15_10&#45;&gt;accum1_10</title>
<path fill="none" stroke="black" d="M6889.74,-10995.89C6915.91,-10979.89 6950.74,-10958.6 6983.26,-10938.72"/>
<polygon fill="black" stroke="black" points="6985.21,-10941.63 6991.92,-10933.42 6981.56,-10935.65 6985.21,-10941.63"/>
</g>
<!-- accum1_11 -->
<g id="node1182" class="node">
<title>accum1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7009.64,-10788.41 6669.79,-10788.41 6582.36,-10682.41 6922.21,-10682.41 7009.64,-10788.41"/>
<text text-anchor="middle" x="6796" y="-10746.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="6796" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6796" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage1_15_11&#45;&gt;accum1_11 -->
<g id="edge1749" class="edge">
<title>ring_stage1_15_11&#45;&gt;accum1_11</title>
<path fill="none" stroke="black" d="M6518.43,-10853.84C6558.74,-10836.79 6613.34,-10813.69 6663.45,-10792.49"/>
<polygon fill="black" stroke="black" points="6664.9,-10795.67 6672.75,-10788.55 6662.18,-10789.22 6664.9,-10795.67"/>
</g>
<!-- accum1_12 -->
<g id="node1183" class="node">
<title>accum1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7851.64,-12921.41 7511.79,-12921.41 7424.36,-12815.41 7764.21,-12815.41 7851.64,-12921.41"/>
<text text-anchor="middle" x="7638" y="-12879.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7638" y="-12864.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7638" y="-12849.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage1_15_12&#45;&gt;accum1_12 -->
<g id="edge1758" class="edge">
<title>ring_stage1_15_12&#45;&gt;accum1_12</title>
<path fill="none" stroke="black" d="M7585.26,-12957.72C7590.23,-12949.4 7595.97,-12939.79 7601.8,-12930.03"/>
<polygon fill="black" stroke="black" points="7604.81,-12931.82 7606.93,-12921.44 7598.8,-12928.23 7604.81,-12931.82"/>
</g>
<!-- accum1_13 -->
<g id="node1184" class="node">
<title>accum1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7519.64,-12779.41 7179.79,-12779.41 7092.36,-12673.41 7432.21,-12673.41 7519.64,-12779.41"/>
<text text-anchor="middle" x="7306" y="-12737.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7306" y="-12722.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7306" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage1_15_13&#45;&gt;accum1_13 -->
<g id="edge1767" class="edge">
<title>ring_stage1_15_13&#45;&gt;accum1_13</title>
<path fill="none" stroke="black" d="M7232.51,-12841.73C7242.19,-12826.67 7254.86,-12806.96 7266.95,-12788.16"/>
<polygon fill="black" stroke="black" points="7269.98,-12789.9 7272.45,-12779.6 7264.1,-12786.12 7269.98,-12789.9"/>
</g>
<!-- accum1_14 -->
<g id="node1185" class="node">
<title>accum1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7335.64,-12637.41 6995.79,-12637.41 6908.36,-12531.41 7248.21,-12531.41 7335.64,-12637.41"/>
<text text-anchor="middle" x="7122" y="-12595.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7122" y="-12580.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7122" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage1_15_14&#45;&gt;accum1_14 -->
<g id="edge1776" class="edge">
<title>ring_stage1_15_14&#45;&gt;accum1_14</title>
<path fill="none" stroke="black" d="M6992.98,-12699.73C7010.51,-12684.19 7033.63,-12663.71 7055.44,-12644.38"/>
<polygon fill="black" stroke="black" points="7057.93,-12646.85 7063.1,-12637.6 7053.29,-12641.61 7057.93,-12646.85"/>
</g>
<!-- accum1_15 -->
<g id="node1186" class="node">
<title>accum1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7607.64,-12495.41 7267.79,-12495.41 7180.36,-12389.41 7520.21,-12389.41 7607.64,-12495.41"/>
<text text-anchor="middle" x="7394" y="-12453.71" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="7394" y="-12438.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7394" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage1_15_15&#45;&gt;accum1_15 -->
<g id="edge1785" class="edge">
<title>ring_stage1_15_15&#45;&gt;accum1_15</title>
<path fill="none" stroke="black" d="M6823.96,-12557.89C6846.75,-12548.25 6873.72,-12538.02 6899,-12531.41 7016.97,-12500.52 7051.03,-12517.28 7171,-12495.41 7194.55,-12491.11 7219.35,-12485.96 7243.52,-12480.6"/>
<polygon fill="black" stroke="black" points="7244.48,-12483.97 7253.47,-12478.37 7242.94,-12477.14 7244.48,-12483.97"/>
</g>
<!-- kv_send1_15_0 -->
<g id="node1155" class="node">
<title>kv_send1_15_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7584" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7584" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="7584" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- kv_send1_15_1 -->
<g id="node1156" class="node">
<title>kv_send1_15_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7360" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7360" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="7360" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- kv_send1_15_2 -->
<g id="node1157" class="node">
<title>kv_send1_15_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7136" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="7136" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="7136" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- kv_send1_15_3 -->
<g id="node1158" class="node">
<title>kv_send1_15_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6912" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6912" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="6912" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- kv_send1_15_4 -->
<g id="node1159" class="node">
<title>kv_send1_15_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6688" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6688" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="6688" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- kv_send1_15_5 -->
<g id="node1160" class="node">
<title>kv_send1_15_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6464" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6464" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="6464" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- kv_send1_15_6 -->
<g id="node1161" class="node">
<title>kv_send1_15_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6240" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6240" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="6240" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- kv_send1_15_7 -->
<g id="node1162" class="node">
<title>kv_send1_15_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6016" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="6016" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="6016" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- kv_send1_15_8 -->
<g id="node1163" class="node">
<title>kv_send1_15_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5792" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="5792" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="5792" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- kv_send1_15_9 -->
<g id="node1164" class="node">
<title>kv_send1_15_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5561" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5561" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="5561" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- kv_send1_15_10 -->
<g id="node1165" class="node">
<title>kv_send1_15_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5323" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5323" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="5323" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- kv_send1_15_11 -->
<g id="node1166" class="node">
<title>kv_send1_15_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5085" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="5085" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="5085" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- kv_send1_15_12 -->
<g id="node1167" class="node">
<title>kv_send1_15_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4846" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4846" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="4846" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- kv_send1_15_13 -->
<g id="node1168" class="node">
<title>kv_send1_15_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4605" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4605" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="4605" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- kv_send1_15_14 -->
<g id="node1169" class="node">
<title>kv_send1_15_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4360" cy="-15844.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="4360" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="4360" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- kv_send1_15_15 -->
<g id="node1170" class="node">
<title>kv_send1_15_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4112" cy="-15844.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="4112" y="-15848.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="4112" y="-15833.41" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- out_proj1_0 -->
<g id="node1187" class="node">
<title>out_proj1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7912,-12184.91 7706,-12184.91 7706,-12131.91 7912,-12131.91 7912,-12184.91"/>
<text text-anchor="middle" x="7809" y="-12169.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7809" y="-12154.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7809" y="-12139.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- accum1_0&#45;&gt;out_proj1_0 -->
<g id="edge1651" class="edge">
<title>accum1_0&#45;&gt;out_proj1_0</title>
<path fill="none" stroke="black" d="M6908.64,-12280.37C6995.3,-12269.94 7105.61,-12257.19 7204,-12247.41 7396.16,-12228.3 7447.3,-12247.55 7637,-12211.41 7666.74,-12205.74 7698.66,-12196.9 7726.82,-12188.1"/>
<polygon fill="black" stroke="black" points="7728.14,-12191.35 7736.61,-12184.99 7726.02,-12184.68 7728.14,-12191.35"/>
</g>
<!-- out_proj1_1 -->
<g id="node1188" class="node">
<title>out_proj1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7912,-12042.91 7706,-12042.91 7706,-11989.91 7912,-11989.91 7912,-12042.91"/>
<text text-anchor="middle" x="7809" y="-12027.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7809" y="-12012.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7809" y="-11997.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- accum1_1&#45;&gt;out_proj1_1 -->
<g id="edge1660" class="edge">
<title>accum1_1&#45;&gt;out_proj1_1</title>
<path fill="none" stroke="black" d="M7330.55,-12122.53C7357.8,-12116.36 7386.22,-12110.34 7413,-12105.41 7529.46,-12083.94 7562.42,-12099.32 7677,-12069.41 7699.11,-12063.63 7722.54,-12055.21 7743.42,-12046.82"/>
<polygon fill="black" stroke="black" points="7744.89,-12050.01 7752.82,-12042.98 7742.24,-12043.53 7744.89,-12050.01"/>
</g>
<!-- out_proj1_2 -->
<g id="node1189" class="node">
<title>out_proj1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5175,-11900.91 4969,-11900.91 4969,-11847.91 5175,-11847.91 5175,-11900.91"/>
<text text-anchor="middle" x="5072" y="-11885.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5072" y="-11870.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5072" y="-11855.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- accum1_2&#45;&gt;out_proj1_2 -->
<g id="edge1669" class="edge">
<title>accum1_2&#45;&gt;out_proj1_2</title>
<path fill="none" stroke="black" d="M5072,-11963.28C5072,-11945.97 5072,-11927.1 5072,-11911.3"/>
<polygon fill="black" stroke="black" points="5075.5,-11910.91 5072,-11900.91 5068.5,-11910.91 5075.5,-11910.91"/>
</g>
<!-- out_proj1_3 -->
<g id="node1190" class="node">
<title>out_proj1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5510,-11758.91 5304,-11758.91 5304,-11705.91 5510,-11705.91 5510,-11758.91"/>
<text text-anchor="middle" x="5407" y="-11743.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5407" y="-11728.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5407" y="-11713.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- accum1_3&#45;&gt;out_proj1_3 -->
<g id="edge1678" class="edge">
<title>accum1_3&#45;&gt;out_proj1_3</title>
<path fill="none" stroke="black" d="M5407,-11821.28C5407,-11803.97 5407,-11785.1 5407,-11769.3"/>
<polygon fill="black" stroke="black" points="5410.5,-11768.91 5407,-11758.91 5403.5,-11768.91 5410.5,-11768.91"/>
</g>
<!-- out_proj1_4 -->
<g id="node1191" class="node">
<title>out_proj1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5788,-11616.91 5582,-11616.91 5582,-11563.91 5788,-11563.91 5788,-11616.91"/>
<text text-anchor="middle" x="5685" y="-11601.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5685" y="-11586.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="5685" y="-11571.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- accum1_4&#45;&gt;out_proj1_4 -->
<g id="edge1687" class="edge">
<title>accum1_4&#45;&gt;out_proj1_4</title>
<path fill="none" stroke="black" d="M5720.78,-11679.28C5713.59,-11661.64 5705.75,-11642.37 5699.24,-11626.39"/>
<polygon fill="black" stroke="black" points="5702.39,-11624.85 5695.38,-11616.91 5695.91,-11627.49 5702.39,-11624.85"/>
</g>
<!-- out_proj1_5 -->
<g id="node1192" class="node">
<title>out_proj1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6228,-11474.91 6022,-11474.91 6022,-11421.91 6228,-11421.91 6228,-11474.91"/>
<text text-anchor="middle" x="6125" y="-11459.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6125" y="-11444.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6125" y="-11429.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- accum1_5&#45;&gt;out_proj1_5 -->
<g id="edge1696" class="edge">
<title>accum1_5&#45;&gt;out_proj1_5</title>
<path fill="none" stroke="black" d="M6090.48,-11537.28C6097.41,-11519.64 6104.98,-11500.37 6111.26,-11484.39"/>
<polygon fill="black" stroke="black" points="6114.58,-11485.49 6114.98,-11474.91 6108.07,-11482.93 6114.58,-11485.49"/>
</g>
<!-- out_proj1_6 -->
<g id="node1193" class="node">
<title>out_proj1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6792,-11332.91 6586,-11332.91 6586,-11279.91 6792,-11279.91 6792,-11332.91"/>
<text text-anchor="middle" x="6689" y="-11317.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6689" y="-11302.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="6689" y="-11287.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- accum1_6&#45;&gt;out_proj1_6 -->
<g id="edge1705" class="edge">
<title>accum1_6&#45;&gt;out_proj1_6</title>
<path fill="none" stroke="black" d="M6619.33,-11395.28C6633.71,-11377.14 6649.46,-11357.28 6662.33,-11341.04"/>
<polygon fill="black" stroke="black" points="6665.31,-11342.92 6668.78,-11332.91 6659.83,-11338.57 6665.31,-11342.92"/>
</g>
<!-- out_proj1_7 -->
<g id="node1194" class="node">
<title>out_proj1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7182,-11190.91 6976,-11190.91 6976,-11137.91 7182,-11137.91 7182,-11190.91"/>
<text text-anchor="middle" x="7079" y="-11175.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7079" y="-11160.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7079" y="-11145.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- accum1_7&#45;&gt;out_proj1_7 -->
<g id="edge1714" class="edge">
<title>accum1_7&#45;&gt;out_proj1_7</title>
<path fill="none" stroke="black" d="M7044.48,-11253.28C7051.41,-11235.64 7058.98,-11216.37 7065.26,-11200.39"/>
<polygon fill="black" stroke="black" points="7068.58,-11201.49 7068.98,-11190.91 7062.07,-11198.93 7068.58,-11201.49"/>
</g>
<!-- out_proj1_8 -->
<g id="node1195" class="node">
<title>out_proj1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7912,-11048.91 7706,-11048.91 7706,-10995.91 7912,-10995.91 7912,-11048.91"/>
<text text-anchor="middle" x="7809" y="-11033.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7809" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7809" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- accum1_8&#45;&gt;out_proj1_8 -->
<g id="edge1723" class="edge">
<title>accum1_8&#45;&gt;out_proj1_8</title>
<path fill="none" stroke="black" d="M7553.88,-11127.55C7600.05,-11114.28 7651.28,-11098.01 7697,-11079.91 7715.97,-11072.4 7736.05,-11062.82 7753.89,-11053.69"/>
<polygon fill="black" stroke="black" points="7755.73,-11056.68 7763,-11048.97 7752.51,-11050.46 7755.73,-11056.68"/>
</g>
<!-- out_proj1_9 -->
<g id="node1196" class="node">
<title>out_proj1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7745,-10906.91 7539,-10906.91 7539,-10853.91 7745,-10853.91 7745,-10906.91"/>
<text text-anchor="middle" x="7642" y="-10891.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7642" y="-10876.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7642" y="-10861.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- accum1_9&#45;&gt;out_proj1_9 -->
<g id="edge1732" class="edge">
<title>accum1_9&#45;&gt;out_proj1_9</title>
<path fill="none" stroke="black" d="M7536.56,-10969.28C7559.02,-10950.55 7583.68,-10930 7603.5,-10913.49"/>
<polygon fill="black" stroke="black" points="7605.96,-10916 7611.4,-10906.91 7601.48,-10910.62 7605.96,-10916"/>
</g>
<!-- out_proj1_10 -->
<g id="node1197" class="node">
<title>out_proj1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7660,-10761.91 7454,-10761.91 7454,-10708.91 7660,-10708.91 7660,-10761.91"/>
<text text-anchor="middle" x="7557" y="-10746.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7557" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7557" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- accum1_10&#45;&gt;out_proj1_10 -->
<g id="edge1741" class="edge">
<title>accum1_10&#45;&gt;out_proj1_10</title>
<path fill="none" stroke="black" d="M7212.94,-10838.91C7292.24,-10815.28 7390.32,-10786.06 7461.45,-10764.87"/>
<polygon fill="black" stroke="black" points="7462.72,-10768.15 7471.3,-10761.94 7460.72,-10761.44 7462.72,-10768.15"/>
</g>
<!-- out_proj1_11 -->
<g id="node1198" class="node">
<title>out_proj1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7574,-10619.91 7368,-10619.91 7368,-10566.91 7574,-10566.91 7574,-10619.91"/>
<text text-anchor="middle" x="7471" y="-10604.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7471" y="-10589.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7471" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- accum1_11&#45;&gt;out_proj1_11 -->
<g id="edge1750" class="edge">
<title>accum1_11&#45;&gt;out_proj1_11</title>
<path fill="none" stroke="black" d="M6940.8,-10704.37C7065.68,-10678.47 7243.48,-10641.6 7358.06,-10617.83"/>
<polygon fill="black" stroke="black" points="7358.83,-10621.25 7367.91,-10615.79 7357.41,-10614.39 7358.83,-10621.25"/>
</g>
<!-- out_proj1_12 -->
<g id="node1199" class="node">
<title>out_proj1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7845,-12752.91 7639,-12752.91 7639,-12699.91 7845,-12699.91 7845,-12752.91"/>
<text text-anchor="middle" x="7742" y="-12737.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7742" y="-12722.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7742" y="-12707.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- accum1_12&#45;&gt;out_proj1_12 -->
<g id="edge1759" class="edge">
<title>accum1_12&#45;&gt;out_proj1_12</title>
<path fill="none" stroke="black" d="M7676.73,-12815.28C7690.2,-12797.14 7704.95,-12777.28 7717.01,-12761.04"/>
<polygon fill="black" stroke="black" points="7719.9,-12763.02 7723.06,-12752.91 7714.28,-12758.85 7719.9,-12763.02"/>
</g>
<!-- out_proj1_13 -->
<g id="node1200" class="node">
<title>out_proj1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7560,-12610.91 7354,-12610.91 7354,-12557.91 7560,-12557.91 7560,-12610.91"/>
<text text-anchor="middle" x="7457" y="-12595.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7457" y="-12580.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7457" y="-12565.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- accum1_13&#45;&gt;out_proj1_13 -->
<g id="edge1768" class="edge">
<title>accum1_13&#45;&gt;out_proj1_13</title>
<path fill="none" stroke="black" d="M7362.23,-12673.28C7382.33,-12654.64 7404.39,-12634.19 7422.16,-12617.71"/>
<polygon fill="black" stroke="black" points="7424.54,-12620.27 7429.5,-12610.91 7419.78,-12615.14 7424.54,-12620.27"/>
</g>
<!-- out_proj1_14 -->
<g id="node1201" class="node">
<title>out_proj1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7892,-12468.91 7686,-12468.91 7686,-12415.91 7892,-12415.91 7892,-12468.91"/>
<text text-anchor="middle" x="7789" y="-12453.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7789" y="-12438.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7789" y="-12423.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- accum1_14&#45;&gt;out_proj1_14 -->
<g id="edge1777" class="edge">
<title>accum1_14&#45;&gt;out_proj1_14</title>
<path fill="none" stroke="black" d="M7262.53,-12548.44C7289.79,-12542.28 7318.21,-12536.29 7345,-12531.41 7464.97,-12509.53 7497.8,-12521.14 7617,-12495.41 7645.78,-12489.2 7676.71,-12480.5 7704.3,-12471.99"/>
<polygon fill="black" stroke="black" points="7705.41,-12475.31 7713.91,-12468.99 7703.33,-12468.63 7705.41,-12475.31"/>
</g>
<!-- out_proj1_15 -->
<g id="node1202" class="node">
<title>out_proj1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7892,-12326.91 7686,-12326.91 7686,-12273.91 7892,-12273.91 7892,-12326.91"/>
<text text-anchor="middle" x="7789" y="-12311.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7789" y="-12296.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="7789" y="-12281.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- accum1_15&#45;&gt;out_proj1_15 -->
<g id="edge1786" class="edge">
<title>accum1_15&#45;&gt;out_proj1_15</title>
<path fill="none" stroke="black" d="M7524.98,-12394.98C7585.13,-12373.67 7654.59,-12349.04 7707.17,-12330.41"/>
<polygon fill="black" stroke="black" points="7708.53,-12333.64 7716.79,-12327 7706.19,-12327.04 7708.53,-12333.64"/>
</g>
<!-- out_proj1_0&#45;&gt;res_attn1_0 -->
<g id="edge1652" class="edge">
<title>out_proj1_0&#45;&gt;res_attn1_0</title>
<path fill="none" stroke="black" d="M7912.07,-12153.47C8314.52,-12136.76 9758,-12063.71 9758,-11875.41 9758,-11875.41 9758,-11875.41 9758,-11021.41 9758,-10811.3 11429.37,-10841.62 11639,-10827.41 11693.35,-10823.72 11830.64,-10830.34 11884,-10819.41 11914.26,-10813.21 11945.81,-10803.11 11975.06,-10792.05"/>
<polygon fill="black" stroke="black" points="11976.4,-10795.28 11984.47,-10788.43 11973.88,-10788.75 11976.4,-10795.28"/>
</g>
<!-- out_proj1_1&#45;&gt;res_attn1_1 -->
<g id="edge1661" class="edge">
<title>out_proj1_1&#45;&gt;res_attn1_1</title>
<path fill="none" stroke="black" d="M7912.09,-12013.53C8531.19,-12001.63 11729,-11930.61 11729,-11733.41 11729,-11733.41 11729,-11733.41 11729,-11305.41 11729,-11091.18 11630.68,-10969.5 11791,-10827.41 11800.73,-10818.78 12714.24,-10821.89 12727,-10819.41 12757.38,-10813.49 12789,-10803.32 12818.2,-10792.1"/>
<polygon fill="black" stroke="black" points="12819.55,-10795.32 12827.59,-10788.42 12817,-10788.81 12819.55,-10795.32"/>
</g>
<!-- out_proj1_2&#45;&gt;res_attn1_2 -->
<g id="edge1670" class="edge">
<title>out_proj1_2&#45;&gt;res_attn1_2</title>
<path fill="none" stroke="black" d="M5108.47,-11847.62C5167.15,-11802.79 5276,-11704.4 5276,-11591.41 5276,-11591.41 5276,-11591.41 5276,-11021.41 5276,-10865.23 5419.47,-10872.51 5569,-10827.41 5619.38,-10812.21 13095.31,-10829.28 13147,-10819.41 13177.49,-10813.58 13209.21,-10803.42 13238.48,-10792.16"/>
<polygon fill="black" stroke="black" points="13239.86,-10795.38 13247.89,-10788.47 13237.3,-10788.86 13239.86,-10795.38"/>
</g>
<!-- out_proj1_3&#45;&gt;res_attn1_3 -->
<g id="edge1679" class="edge">
<title>out_proj1_3&#45;&gt;res_attn1_3</title>
<path fill="none" stroke="black" d="M5422.53,-11705.63C5450.16,-11657.22 5505,-11548.66 5505,-11449.41 5505,-11449.41 5505,-11449.41 5505,-11021.41 5505,-10831.13 6149.97,-10849.21 6339,-10827.41 6438.73,-10815.9 13468.39,-10838.24 13567,-10819.41 13597.49,-10813.58 13629.21,-10803.42 13658.48,-10792.16"/>
<polygon fill="black" stroke="black" points="13659.86,-10795.38 13667.89,-10788.47 13657.3,-10788.86 13659.86,-10795.38"/>
</g>
<!-- out_proj1_4&#45;&gt;res_attn1_4 -->
<g id="edge1688" class="edge">
<title>out_proj1_4&#45;&gt;res_attn1_4</title>
<path fill="none" stroke="black" d="M5581.89,-11571.44C5449.88,-11541.83 5238,-11469.13 5238,-11307.41 5238,-11307.41 5238,-11307.41 5238,-11021.41 5238,-10934.53 5196.94,-10884.98 5262,-10827.41 5271.16,-10819.3 12294.99,-10821.7 12307,-10819.41 12337.49,-10813.58 12369.21,-10803.42 12398.48,-10792.16"/>
<polygon fill="black" stroke="black" points="12399.86,-10795.38 12407.89,-10788.47 12397.3,-10788.86 12399.86,-10795.38"/>
</g>
<!-- out_proj1_5&#45;&gt;res_attn1_5 -->
<g id="edge1697" class="edge">
<title>out_proj1_5&#45;&gt;res_attn1_5</title>
<path fill="none" stroke="black" d="M6127.31,-11421.74C6136.32,-11338.81 6177.04,-11077.25 6339,-10969.41 6339,-10969.41 12009,-10827.41 12009,-10827.41 12063.94,-10826.61 13933.05,-10829.8 13987,-10819.41 14017.48,-10813.54 14049.2,-10803.36 14078.47,-10792.1"/>
<polygon fill="black" stroke="black" points="14079.85,-10795.32 14087.88,-10788.41 14077.29,-10788.8 14079.85,-10795.32"/>
</g>
<!-- out_proj1_6&#45;&gt;res_attn1_6 -->
<g id="edge1706" class="edge">
<title>out_proj1_6&#45;&gt;res_attn1_6</title>
<path fill="none" stroke="black" d="M6733.28,-11279.85C6753.29,-11269.63 6777.65,-11258.98 6801,-11253.41 7031.34,-11198.45 7629.5,-11229.4 7866,-11217.41 8800.26,-11170.04 11188.12,-11256.55 12066,-10933.41 12140.24,-10906.08 12133.91,-10852.31 12209,-10827.41 12249.05,-10814.12 15205.56,-10827.36 15247,-10819.41 15277.49,-10813.56 15309.2,-10803.39 15338.47,-10792.13"/>
<polygon fill="black" stroke="black" points="15339.85,-10795.35 15347.89,-10788.44 15337.3,-10788.83 15339.85,-10795.35"/>
</g>
<!-- out_proj1_7&#45;&gt;res_attn1_7 -->
<g id="edge1715" class="edge">
<title>out_proj1_7&#45;&gt;res_attn1_7</title>
<path fill="none" stroke="black" d="M7123.28,-11137.88C7143.3,-11127.67 7167.65,-11117.02 7191,-11111.41 7321.22,-11080.12 11889.18,-10993.23 12009,-10933.41 12063.28,-10906.31 12040.28,-10853.59 12095,-10827.41 12123.97,-10813.55 14375.47,-10825.47 14407,-10819.41 14437.48,-10813.55 14469.2,-10803.37 14498.47,-10792.11"/>
<polygon fill="black" stroke="black" points="14499.85,-10795.33 14507.88,-10788.42 14497.29,-10788.81 14499.85,-10795.33"/>
</g>
<!-- out_proj1_8&#45;&gt;res_attn1_8 -->
<g id="edge1724" class="edge">
<title>out_proj1_8&#45;&gt;res_attn1_8</title>
<path fill="none" stroke="black" d="M7912.35,-11020.75C8517.84,-11016.72 11592.8,-10993.4 12009,-10933.41 12186.78,-10907.78 12220.98,-10851.36 12399,-10827.41 12500.53,-10813.74 15986.39,-10838.68 16087,-10819.41 16117.49,-10813.57 16149.2,-10803.4 16178.47,-10792.14"/>
<polygon fill="black" stroke="black" points="16179.85,-10795.36 16187.89,-10788.45 16177.3,-10788.84 16179.85,-10795.36"/>
</g>
<!-- out_proj1_9&#45;&gt;res_attn1_9 -->
<g id="edge1733" class="edge">
<title>out_proj1_9&#45;&gt;res_attn1_9</title>
<path fill="none" stroke="black" d="M7745.21,-10877.88C8235.36,-10870.72 10377.17,-10840.18 12133,-10827.41 12170.42,-10827.13 14790.25,-10826.46 14827,-10819.41 14857.48,-10813.55 14889.2,-10803.38 14918.47,-10792.12"/>
<polygon fill="black" stroke="black" points="14919.85,-10795.34 14927.88,-10788.43 14917.3,-10788.82 14919.85,-10795.34"/>
</g>
<!-- out_proj1_10&#45;&gt;res_attn1_10 -->
<g id="edge1742" class="edge">
<title>out_proj1_10&#45;&gt;res_attn1_10</title>
<path fill="none" stroke="black" d="M7644.5,-10761.92C7720.06,-10783.36 7832.6,-10811.81 7933,-10823.41 7950.67,-10825.45 18160.54,-10826.78 18178,-10823.41 18211.87,-10816.86 18247.15,-10805.1 18279.24,-10792.26"/>
<polygon fill="black" stroke="black" points="18280.71,-10795.45 18288.65,-10788.44 18278.07,-10788.96 18280.71,-10795.45"/>
</g>
<!-- out_proj1_11&#45;&gt;res_attn1_11 -->
<g id="edge1751" class="edge">
<title>out_proj1_11&#45;&gt;res_attn1_11</title>
<path fill="none" stroke="black" d="M7574.17,-10609.54C7665.8,-10622.2 7803.49,-10639.29 7924,-10646.41 8466.82,-10678.46 17126.25,-10615.92 17766.49,-10682.53"/>
<polygon fill="black" stroke="black" points="17766.23,-10686.03 17776.56,-10683.68 17767.02,-10679.07 17766.23,-10686.03"/>
</g>
<!-- out_proj1_12&#45;&gt;res_attn1_12 -->
<g id="edge1760" class="edge">
<title>out_proj1_12&#45;&gt;res_attn1_12</title>
<path fill="none" stroke="black" d="M7845.09,-12723.56C8514.99,-12710.24 12223,-12615.92 12223,-12159.41 12223,-12159.41 12223,-12159.41 12223,-11589.41 12223,-11047.61 13343.93,-10989.52 15435,-10827.41 15487.95,-10823.3 17294.85,-10829.45 17347,-10819.41 17377.39,-10813.55 17409.02,-10803.41 17438.22,-10792.19"/>
<polygon fill="black" stroke="black" points="17439.57,-10795.42 17447.61,-10788.51 17437.02,-10788.9 17439.57,-10795.42"/>
</g>
<!-- out_proj1_13&#45;&gt;res_attn1_13 -->
<g id="edge1769" class="edge">
<title>out_proj1_13&#45;&gt;res_attn1_13</title>
<path fill="none" stroke="black" d="M7560.43,-12579.83C8132.43,-12559.22 10912.35,-12448.26 11733,-12211.41 11865.54,-12173.15 11930.05,-12182.53 12009,-12069.41 12058.72,-11998.16 12033,-11962.29 12033,-11875.41 12033,-11875.41 12033,-11875.41 12033,-11305.41 12033,-11148.95 12053.77,-11101.25 12138,-10969.41 12185.21,-10895.51 12194.32,-10861.79 12275,-10827.41 12296.67,-10818.17 15643.87,-10823.84 15667,-10819.41 15697.49,-10813.56 15729.2,-10803.39 15758.47,-10792.13"/>
<polygon fill="black" stroke="black" points="15759.85,-10795.35 15767.89,-10788.44 15757.3,-10788.84 15759.85,-10795.35"/>
</g>
<!-- out_proj1_14&#45;&gt;res_attn1_14 -->
<g id="edge1778" class="edge">
<title>out_proj1_14&#45;&gt;res_attn1_14</title>
<path fill="none" stroke="black" d="M7892.16,-12436.94C8551.41,-12407.74 12147,-12238.36 12147,-12017.41 12147,-12017.41 12147,-12017.41 12147,-11447.41 12147,-11222.07 12545.46,-10864.03 12627,-10827.41 12654.24,-10815.17 16897.67,-10825.02 16927,-10819.41 16957.49,-10813.57 16989.21,-10803.41 17018.48,-10792.15"/>
<polygon fill="black" stroke="black" points="17019.86,-10795.36 17027.89,-10788.46 17017.3,-10788.85 17019.86,-10795.36"/>
</g>
<!-- out_proj1_15&#45;&gt;res_attn1_15 -->
<g id="edge1787" class="edge">
<title>out_proj1_15&#45;&gt;res_attn1_15</title>
<path fill="none" stroke="black" d="M7892.2,-12294.76C8544.76,-12264.72 12071,-12092.34 12071,-11875.41 12071,-11875.41 12071,-11875.41 12071,-11305.41 12071,-11224.69 12153.29,-11027.82 12209,-10969.41 12311.92,-10861.5 12367.45,-10859.88 12513,-10827.41 12567.14,-10815.33 16452.52,-10829.84 16507,-10819.41 16537.49,-10813.57 16569.2,-10803.4 16598.48,-10792.14"/>
<polygon fill="black" stroke="black" points="16599.86,-10795.36 16607.89,-10788.45 16597.3,-10788.84 16599.86,-10795.36"/>
</g>
<!-- ffn1_1_0 -->
<g id="node1203" class="node">
<title>ffn1_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18822.5,-11048.91 18623.5,-11048.91 18623.5,-10995.91 18822.5,-10995.91 18822.5,-11048.91"/>
<text text-anchor="middle" x="18723" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="18723" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="18723" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_1_0 -->
<g id="node1219" class="node">
<title>act_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18757,-10899.41 18691,-10899.41 18691,-10861.41 18757,-10861.41 18757,-10899.41"/>
<text text-anchor="middle" x="18724" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18724" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_1_0&#45;&gt;act_1_0 -->
<g id="edge1655" class="edge">
<title>ffn1_1_0&#45;&gt;act_1_0</title>
<path fill="none" stroke="black" d="M18723.18,-10995.73C18723.36,-10971.42 18723.62,-10934.98 18723.8,-10909.81"/>
<polygon fill="black" stroke="black" points="18727.3,-10909.81 18723.87,-10899.78 18720.3,-10909.76 18727.3,-10909.81"/>
</g>
<!-- ffn1_1_1 -->
<g id="node1204" class="node">
<title>ffn1_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19266.5,-11048.91 19067.5,-11048.91 19067.5,-10995.91 19266.5,-10995.91 19266.5,-11048.91"/>
<text text-anchor="middle" x="19167" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="19167" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="19167" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_1_1 -->
<g id="node1220" class="node">
<title>act_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19203,-10899.41 19137,-10899.41 19137,-10861.41 19203,-10861.41 19203,-10899.41"/>
<text text-anchor="middle" x="19170" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19170" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_1_1&#45;&gt;act_1_1 -->
<g id="edge1664" class="edge">
<title>ffn1_1_1&#45;&gt;act_1_1</title>
<path fill="none" stroke="black" d="M19167.55,-10995.73C19168.07,-10971.42 19168.85,-10934.98 19169.39,-10909.81"/>
<polygon fill="black" stroke="black" points="19172.89,-10909.85 19169.61,-10899.78 19165.89,-10909.7 19172.89,-10909.85"/>
</g>
<!-- ffn1_1_2 -->
<g id="node1205" class="node">
<title>ffn1_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19489.5,-11048.91 19290.5,-11048.91 19290.5,-10995.91 19489.5,-10995.91 19489.5,-11048.91"/>
<text text-anchor="middle" x="19390" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="19390" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="19390" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_1_2 -->
<g id="node1221" class="node">
<title>act_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19426,-10899.41 19360,-10899.41 19360,-10861.41 19426,-10861.41 19426,-10899.41"/>
<text text-anchor="middle" x="19393" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19393" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_1_2&#45;&gt;act_1_2 -->
<g id="edge1673" class="edge">
<title>ffn1_1_2&#45;&gt;act_1_2</title>
<path fill="none" stroke="black" d="M19390.55,-10995.73C19391.07,-10971.42 19391.85,-10934.98 19392.39,-10909.81"/>
<polygon fill="black" stroke="black" points="19395.89,-10909.85 19392.61,-10899.78 19388.89,-10909.7 19395.89,-10909.85"/>
</g>
<!-- ffn1_1_3 -->
<g id="node1206" class="node">
<title>ffn1_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19713.5,-11048.91 19514.5,-11048.91 19514.5,-10995.91 19713.5,-10995.91 19713.5,-11048.91"/>
<text text-anchor="middle" x="19614" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="19614" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="19614" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_1_3 -->
<g id="node1222" class="node">
<title>act_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19650,-10899.41 19584,-10899.41 19584,-10861.41 19650,-10861.41 19650,-10899.41"/>
<text text-anchor="middle" x="19617" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19617" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_1_3&#45;&gt;act_1_3 -->
<g id="edge1682" class="edge">
<title>ffn1_1_3&#45;&gt;act_1_3</title>
<path fill="none" stroke="black" d="M19614.55,-10995.73C19615.07,-10971.42 19615.85,-10934.98 19616.39,-10909.81"/>
<polygon fill="black" stroke="black" points="19619.89,-10909.85 19616.61,-10899.78 19612.89,-10909.7 19619.89,-10909.85"/>
</g>
<!-- ffn1_1_4 -->
<g id="node1207" class="node">
<title>ffn1_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19043.5,-11048.91 18844.5,-11048.91 18844.5,-10995.91 19043.5,-10995.91 19043.5,-11048.91"/>
<text text-anchor="middle" x="18944" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="18944" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="18944" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_1_4 -->
<g id="node1223" class="node">
<title>act_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18979,-10899.41 18913,-10899.41 18913,-10861.41 18979,-10861.41 18979,-10899.41"/>
<text text-anchor="middle" x="18946" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18946" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_1_4&#45;&gt;act_1_4 -->
<g id="edge1691" class="edge">
<title>ffn1_1_4&#45;&gt;act_1_4</title>
<path fill="none" stroke="black" d="M18944.37,-10995.73C18944.71,-10971.42 18945.23,-10934.98 18945.59,-10909.81"/>
<polygon fill="black" stroke="black" points="18949.09,-10909.83 18945.74,-10899.78 18942.09,-10909.73 18949.09,-10909.83"/>
</g>
<!-- ffn1_1_5 -->
<g id="node1208" class="node">
<title>ffn1_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19937.5,-11048.91 19738.5,-11048.91 19738.5,-10995.91 19937.5,-10995.91 19937.5,-11048.91"/>
<text text-anchor="middle" x="19838" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="19838" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="19838" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_1_5 -->
<g id="node1224" class="node">
<title>act_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19874,-10899.41 19808,-10899.41 19808,-10861.41 19874,-10861.41 19874,-10899.41"/>
<text text-anchor="middle" x="19841" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19841" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_1_5&#45;&gt;act_1_5 -->
<g id="edge1700" class="edge">
<title>ffn1_1_5&#45;&gt;act_1_5</title>
<path fill="none" stroke="black" d="M19838.55,-10995.73C19839.07,-10971.42 19839.85,-10934.98 19840.39,-10909.81"/>
<polygon fill="black" stroke="black" points="19843.89,-10909.85 19840.61,-10899.78 19836.89,-10909.7 19843.89,-10909.85"/>
</g>
<!-- ffn1_1_6 -->
<g id="node1209" class="node">
<title>ffn1_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20609.5,-11048.91 20410.5,-11048.91 20410.5,-10995.91 20609.5,-10995.91 20609.5,-11048.91"/>
<text text-anchor="middle" x="20510" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="20510" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="20510" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_1_6 -->
<g id="node1225" class="node">
<title>act_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20546,-10899.41 20480,-10899.41 20480,-10861.41 20546,-10861.41 20546,-10899.41"/>
<text text-anchor="middle" x="20513" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20513" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_1_6&#45;&gt;act_1_6 -->
<g id="edge1709" class="edge">
<title>ffn1_1_6&#45;&gt;act_1_6</title>
<path fill="none" stroke="black" d="M20510.55,-10995.73C20511.07,-10971.42 20511.85,-10934.98 20512.39,-10909.81"/>
<polygon fill="black" stroke="black" points="20515.89,-10909.85 20512.61,-10899.78 20508.89,-10909.7 20515.89,-10909.85"/>
</g>
<!-- ffn1_1_7 -->
<g id="node1210" class="node">
<title>ffn1_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20161.5,-11048.91 19962.5,-11048.91 19962.5,-10995.91 20161.5,-10995.91 20161.5,-11048.91"/>
<text text-anchor="middle" x="20062" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="20062" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="20062" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_1_7 -->
<g id="node1226" class="node">
<title>act_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20098,-10899.41 20032,-10899.41 20032,-10861.41 20098,-10861.41 20098,-10899.41"/>
<text text-anchor="middle" x="20065" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20065" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_1_7&#45;&gt;act_1_7 -->
<g id="edge1718" class="edge">
<title>ffn1_1_7&#45;&gt;act_1_7</title>
<path fill="none" stroke="black" d="M20062.55,-10995.73C20063.07,-10971.42 20063.85,-10934.98 20064.39,-10909.81"/>
<polygon fill="black" stroke="black" points="20067.89,-10909.85 20064.61,-10899.78 20060.89,-10909.7 20067.89,-10909.85"/>
</g>
<!-- ffn1_1_8 -->
<g id="node1211" class="node">
<title>ffn1_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21057.5,-11048.91 20858.5,-11048.91 20858.5,-10995.91 21057.5,-10995.91 21057.5,-11048.91"/>
<text text-anchor="middle" x="20958" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="20958" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="20958" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_1_8 -->
<g id="node1227" class="node">
<title>act_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20994,-10899.41 20928,-10899.41 20928,-10861.41 20994,-10861.41 20994,-10899.41"/>
<text text-anchor="middle" x="20961" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20961" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_1_8&#45;&gt;act_1_8 -->
<g id="edge1727" class="edge">
<title>ffn1_1_8&#45;&gt;act_1_8</title>
<path fill="none" stroke="black" d="M20958.55,-10995.73C20959.07,-10971.42 20959.85,-10934.98 20960.39,-10909.81"/>
<polygon fill="black" stroke="black" points="20963.89,-10909.85 20960.61,-10899.78 20956.89,-10909.7 20963.89,-10909.85"/>
</g>
<!-- ffn1_1_9 -->
<g id="node1212" class="node">
<title>ffn1_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20385.5,-11048.91 20186.5,-11048.91 20186.5,-10995.91 20385.5,-10995.91 20385.5,-11048.91"/>
<text text-anchor="middle" x="20286" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="20286" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="20286" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_1_9 -->
<g id="node1228" class="node">
<title>act_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20322,-10899.41 20256,-10899.41 20256,-10861.41 20322,-10861.41 20322,-10899.41"/>
<text text-anchor="middle" x="20289" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20289" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_1_9&#45;&gt;act_1_9 -->
<g id="edge1736" class="edge">
<title>ffn1_1_9&#45;&gt;act_1_9</title>
<path fill="none" stroke="black" d="M20286.55,-10995.73C20287.07,-10971.42 20287.85,-10934.98 20288.39,-10909.81"/>
<polygon fill="black" stroke="black" points="20291.89,-10909.85 20288.61,-10899.78 20284.89,-10909.7 20291.89,-10909.85"/>
</g>
<!-- ffn1_1_10 -->
<g id="node1213" class="node">
<title>ffn1_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22177.5,-11048.91 21978.5,-11048.91 21978.5,-10995.91 22177.5,-10995.91 22177.5,-11048.91"/>
<text text-anchor="middle" x="22078" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="22078" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="22078" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_1_10 -->
<g id="node1229" class="node">
<title>act_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22118.5,-10899.41 22043.5,-10899.41 22043.5,-10861.41 22118.5,-10861.41 22118.5,-10899.41"/>
<text text-anchor="middle" x="22081" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22081" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_1_10&#45;&gt;act_1_10 -->
<g id="edge1745" class="edge">
<title>ffn1_1_10&#45;&gt;act_1_10</title>
<path fill="none" stroke="black" d="M22078.55,-10995.73C22079.07,-10971.42 22079.85,-10934.98 22080.39,-10909.81"/>
<polygon fill="black" stroke="black" points="22083.89,-10909.85 22080.61,-10899.78 22076.89,-10909.7 22083.89,-10909.85"/>
</g>
<!-- ffn1_1_11 -->
<g id="node1214" class="node">
<title>ffn1_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21953.5,-11048.91 21754.5,-11048.91 21754.5,-10995.91 21953.5,-10995.91 21953.5,-11048.91"/>
<text text-anchor="middle" x="21854" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="21854" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="21854" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_1_11 -->
<g id="node1230" class="node">
<title>act_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21895.5,-10899.41 21820.5,-10899.41 21820.5,-10861.41 21895.5,-10861.41 21895.5,-10899.41"/>
<text text-anchor="middle" x="21858" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21858" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_1_11&#45;&gt;act_1_11 -->
<g id="edge1754" class="edge">
<title>ffn1_1_11&#45;&gt;act_1_11</title>
<path fill="none" stroke="black" d="M21854.73,-10995.73C21855.43,-10971.42 21856.47,-10934.98 21857.19,-10909.81"/>
<polygon fill="black" stroke="black" points="21860.69,-10909.88 21857.48,-10899.78 21853.69,-10909.68 21860.69,-10909.88"/>
</g>
<!-- ffn1_1_12 -->
<g id="node1215" class="node">
<title>ffn1_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21729.5,-11048.91 21530.5,-11048.91 21530.5,-10995.91 21729.5,-10995.91 21729.5,-11048.91"/>
<text text-anchor="middle" x="21630" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="21630" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="21630" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_1_12 -->
<g id="node1231" class="node">
<title>act_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21670.5,-10899.41 21595.5,-10899.41 21595.5,-10861.41 21670.5,-10861.41 21670.5,-10899.41"/>
<text text-anchor="middle" x="21633" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21633" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_1_12&#45;&gt;act_1_12 -->
<g id="edge1763" class="edge">
<title>ffn1_1_12&#45;&gt;act_1_12</title>
<path fill="none" stroke="black" d="M21630.55,-10995.73C21631.07,-10971.42 21631.85,-10934.98 21632.39,-10909.81"/>
<polygon fill="black" stroke="black" points="21635.89,-10909.85 21632.61,-10899.78 21628.89,-10909.7 21635.89,-10909.85"/>
</g>
<!-- ffn1_1_13 -->
<g id="node1216" class="node">
<title>ffn1_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20833.5,-11048.91 20634.5,-11048.91 20634.5,-10995.91 20833.5,-10995.91 20833.5,-11048.91"/>
<text text-anchor="middle" x="20734" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="20734" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="20734" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_1_13 -->
<g id="node1232" class="node">
<title>act_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20774.5,-10899.41 20699.5,-10899.41 20699.5,-10861.41 20774.5,-10861.41 20774.5,-10899.41"/>
<text text-anchor="middle" x="20737" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20737" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_1_13&#45;&gt;act_1_13 -->
<g id="edge1772" class="edge">
<title>ffn1_1_13&#45;&gt;act_1_13</title>
<path fill="none" stroke="black" d="M20734.55,-10995.73C20735.07,-10971.42 20735.85,-10934.98 20736.39,-10909.81"/>
<polygon fill="black" stroke="black" points="20739.89,-10909.85 20736.61,-10899.78 20732.89,-10909.7 20739.89,-10909.85"/>
</g>
<!-- ffn1_1_14 -->
<g id="node1217" class="node">
<title>ffn1_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21505.5,-11048.91 21306.5,-11048.91 21306.5,-10995.91 21505.5,-10995.91 21505.5,-11048.91"/>
<text text-anchor="middle" x="21406" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="21406" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="21406" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_1_14 -->
<g id="node1233" class="node">
<title>act_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21446.5,-10899.41 21371.5,-10899.41 21371.5,-10861.41 21446.5,-10861.41 21446.5,-10899.41"/>
<text text-anchor="middle" x="21409" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21409" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_1_14&#45;&gt;act_1_14 -->
<g id="edge1781" class="edge">
<title>ffn1_1_14&#45;&gt;act_1_14</title>
<path fill="none" stroke="black" d="M21406.55,-10995.73C21407.07,-10971.42 21407.85,-10934.98 21408.39,-10909.81"/>
<polygon fill="black" stroke="black" points="21411.89,-10909.85 21408.61,-10899.78 21404.89,-10909.7 21411.89,-10909.85"/>
</g>
<!-- ffn1_1_15 -->
<g id="node1218" class="node">
<title>ffn1_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21281.5,-11048.91 21082.5,-11048.91 21082.5,-10995.91 21281.5,-10995.91 21281.5,-11048.91"/>
<text text-anchor="middle" x="21182" y="-11033.71" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="21182" y="-11018.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="21182" y="-11003.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_1_15 -->
<g id="node1234" class="node">
<title>act_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21222.5,-10899.41 21147.5,-10899.41 21147.5,-10861.41 21222.5,-10861.41 21222.5,-10899.41"/>
<text text-anchor="middle" x="21185" y="-10884.21" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21185" y="-10869.21" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_1_15&#45;&gt;act_1_15 -->
<g id="edge1790" class="edge">
<title>ffn1_1_15&#45;&gt;act_1_15</title>
<path fill="none" stroke="black" d="M21182.55,-10995.73C21183.07,-10971.42 21183.85,-10934.98 21184.39,-10909.81"/>
<polygon fill="black" stroke="black" points="21187.89,-10909.85 21184.61,-10899.78 21180.89,-10909.7 21187.89,-10909.85"/>
</g>
<!-- ffn2_1_0 -->
<g id="node1235" class="node">
<title>ffn2_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18828,-10761.91 18622,-10761.91 18622,-10708.91 18828,-10708.91 18828,-10761.91"/>
<text text-anchor="middle" x="18725" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="18725" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18725" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_1_0&#45;&gt;ffn2_1_0 -->
<g id="edge1656" class="edge">
<title>act_1_0&#45;&gt;ffn2_1_0</title>
<path fill="none" stroke="black" d="M18724.13,-10861.3C18724.28,-10839.04 18724.55,-10800.74 18724.75,-10772.41"/>
<polygon fill="black" stroke="black" points="18728.25,-10772.12 18724.82,-10762.09 18721.25,-10772.07 18728.25,-10772.12"/>
</g>
<!-- ffn2_1_1 -->
<g id="node1236" class="node">
<title>ffn2_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19276,-10761.91 19070,-10761.91 19070,-10708.91 19276,-10708.91 19276,-10761.91"/>
<text text-anchor="middle" x="19173" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="19173" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19173" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_1_1&#45;&gt;ffn2_1_1 -->
<g id="edge1665" class="edge">
<title>act_1_1&#45;&gt;ffn2_1_1</title>
<path fill="none" stroke="black" d="M19170.38,-10861.3C19170.85,-10839.04 19171.65,-10800.74 19172.24,-10772.41"/>
<polygon fill="black" stroke="black" points="19175.75,-10772.16 19172.46,-10762.09 19168.75,-10772.02 19175.75,-10772.16"/>
</g>
<!-- ffn2_1_2 -->
<g id="node1237" class="node">
<title>ffn2_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19500,-10761.91 19294,-10761.91 19294,-10708.91 19500,-10708.91 19500,-10761.91"/>
<text text-anchor="middle" x="19397" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="19397" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19397" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_1_2&#45;&gt;ffn2_1_2 -->
<g id="edge1674" class="edge">
<title>act_1_2&#45;&gt;ffn2_1_2</title>
<path fill="none" stroke="black" d="M19393.51,-10861.3C19394.13,-10839.04 19395.2,-10800.74 19395.99,-10772.41"/>
<polygon fill="black" stroke="black" points="19399.5,-10772.19 19396.28,-10762.09 19392.5,-10771.99 19399.5,-10772.19"/>
</g>
<!-- ffn2_1_3 -->
<g id="node1238" class="node">
<title>ffn2_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19724,-10761.91 19518,-10761.91 19518,-10708.91 19724,-10708.91 19724,-10761.91"/>
<text text-anchor="middle" x="19621" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="19621" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19621" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_1_3&#45;&gt;ffn2_1_3 -->
<g id="edge1683" class="edge">
<title>act_1_3&#45;&gt;ffn2_1_3</title>
<path fill="none" stroke="black" d="M19617.51,-10861.3C19618.13,-10839.04 19619.2,-10800.74 19619.99,-10772.41"/>
<polygon fill="black" stroke="black" points="19623.5,-10772.19 19620.28,-10762.09 19616.5,-10771.99 19623.5,-10772.19"/>
</g>
<!-- ffn2_1_4 -->
<g id="node1239" class="node">
<title>ffn2_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19052,-10761.91 18846,-10761.91 18846,-10708.91 19052,-10708.91 19052,-10761.91"/>
<text text-anchor="middle" x="18949" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="18949" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18949" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_1_4&#45;&gt;ffn2_1_4 -->
<g id="edge1692" class="edge">
<title>act_1_4&#45;&gt;ffn2_1_4</title>
<path fill="none" stroke="black" d="M18946.38,-10861.3C18946.85,-10839.04 18947.65,-10800.74 18948.24,-10772.41"/>
<polygon fill="black" stroke="black" points="18951.75,-10772.16 18948.46,-10762.09 18944.75,-10772.02 18951.75,-10772.16"/>
</g>
<!-- ffn2_1_5 -->
<g id="node1240" class="node">
<title>ffn2_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19948,-10761.91 19742,-10761.91 19742,-10708.91 19948,-10708.91 19948,-10761.91"/>
<text text-anchor="middle" x="19845" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="19845" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19845" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_1_5&#45;&gt;ffn2_1_5 -->
<g id="edge1701" class="edge">
<title>act_1_5&#45;&gt;ffn2_1_5</title>
<path fill="none" stroke="black" d="M19841.51,-10861.3C19842.13,-10839.04 19843.2,-10800.74 19843.99,-10772.41"/>
<polygon fill="black" stroke="black" points="19847.5,-10772.19 19844.28,-10762.09 19840.5,-10771.99 19847.5,-10772.19"/>
</g>
<!-- ffn2_1_6 -->
<g id="node1241" class="node">
<title>ffn2_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20620,-10761.91 20414,-10761.91 20414,-10708.91 20620,-10708.91 20620,-10761.91"/>
<text text-anchor="middle" x="20517" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="20517" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20517" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_1_6&#45;&gt;ffn2_1_6 -->
<g id="edge1710" class="edge">
<title>act_1_6&#45;&gt;ffn2_1_6</title>
<path fill="none" stroke="black" d="M20513.51,-10861.3C20514.13,-10839.04 20515.2,-10800.74 20515.99,-10772.41"/>
<polygon fill="black" stroke="black" points="20519.5,-10772.19 20516.28,-10762.09 20512.5,-10771.99 20519.5,-10772.19"/>
</g>
<!-- ffn2_1_7 -->
<g id="node1242" class="node">
<title>ffn2_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20172,-10761.91 19966,-10761.91 19966,-10708.91 20172,-10708.91 20172,-10761.91"/>
<text text-anchor="middle" x="20069" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="20069" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20069" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_1_7&#45;&gt;ffn2_1_7 -->
<g id="edge1719" class="edge">
<title>act_1_7&#45;&gt;ffn2_1_7</title>
<path fill="none" stroke="black" d="M20065.51,-10861.3C20066.13,-10839.04 20067.2,-10800.74 20067.99,-10772.41"/>
<polygon fill="black" stroke="black" points="20071.5,-10772.19 20068.28,-10762.09 20064.5,-10771.99 20071.5,-10772.19"/>
</g>
<!-- ffn2_1_8 -->
<g id="node1243" class="node">
<title>ffn2_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21068,-10761.91 20862,-10761.91 20862,-10708.91 21068,-10708.91 21068,-10761.91"/>
<text text-anchor="middle" x="20965" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="20965" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20965" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_1_8&#45;&gt;ffn2_1_8 -->
<g id="edge1728" class="edge">
<title>act_1_8&#45;&gt;ffn2_1_8</title>
<path fill="none" stroke="black" d="M20961.51,-10861.3C20962.13,-10839.04 20963.2,-10800.74 20963.99,-10772.41"/>
<polygon fill="black" stroke="black" points="20967.5,-10772.19 20964.28,-10762.09 20960.5,-10771.99 20967.5,-10772.19"/>
</g>
<!-- ffn2_1_9 -->
<g id="node1244" class="node">
<title>ffn2_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20396,-10761.91 20190,-10761.91 20190,-10708.91 20396,-10708.91 20396,-10761.91"/>
<text text-anchor="middle" x="20293" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="20293" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20293" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_1_9&#45;&gt;ffn2_1_9 -->
<g id="edge1737" class="edge">
<title>act_1_9&#45;&gt;ffn2_1_9</title>
<path fill="none" stroke="black" d="M20289.51,-10861.3C20290.13,-10839.04 20291.2,-10800.74 20291.99,-10772.41"/>
<polygon fill="black" stroke="black" points="20295.5,-10772.19 20292.28,-10762.09 20288.5,-10771.99 20295.5,-10772.19"/>
</g>
<!-- ffn2_1_10 -->
<g id="node1245" class="node">
<title>ffn2_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22188,-10761.91 21982,-10761.91 21982,-10708.91 22188,-10708.91 22188,-10761.91"/>
<text text-anchor="middle" x="22085" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="22085" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22085" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_1_10&#45;&gt;ffn2_1_10 -->
<g id="edge1746" class="edge">
<title>act_1_10&#45;&gt;ffn2_1_10</title>
<path fill="none" stroke="black" d="M22081.51,-10861.3C22082.13,-10839.04 22083.2,-10800.74 22083.99,-10772.41"/>
<polygon fill="black" stroke="black" points="22087.5,-10772.19 22084.28,-10762.09 22080.5,-10771.99 22087.5,-10772.19"/>
</g>
<!-- ffn2_1_11 -->
<g id="node1246" class="node">
<title>ffn2_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21964,-10761.91 21758,-10761.91 21758,-10708.91 21964,-10708.91 21964,-10761.91"/>
<text text-anchor="middle" x="21861" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="21861" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21861" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_1_11&#45;&gt;ffn2_1_11 -->
<g id="edge1755" class="edge">
<title>act_1_11&#45;&gt;ffn2_1_11</title>
<path fill="none" stroke="black" d="M21858.38,-10861.3C21858.85,-10839.04 21859.65,-10800.74 21860.24,-10772.41"/>
<polygon fill="black" stroke="black" points="21863.75,-10772.16 21860.46,-10762.09 21856.75,-10772.02 21863.75,-10772.16"/>
</g>
<!-- ffn2_1_12 -->
<g id="node1247" class="node">
<title>ffn2_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21740,-10761.91 21534,-10761.91 21534,-10708.91 21740,-10708.91 21740,-10761.91"/>
<text text-anchor="middle" x="21637" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="21637" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21637" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_1_12&#45;&gt;ffn2_1_12 -->
<g id="edge1764" class="edge">
<title>act_1_12&#45;&gt;ffn2_1_12</title>
<path fill="none" stroke="black" d="M21633.51,-10861.3C21634.13,-10839.04 21635.2,-10800.74 21635.99,-10772.41"/>
<polygon fill="black" stroke="black" points="21639.5,-10772.19 21636.28,-10762.09 21632.5,-10771.99 21639.5,-10772.19"/>
</g>
<!-- ffn2_1_13 -->
<g id="node1248" class="node">
<title>ffn2_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20844,-10761.91 20638,-10761.91 20638,-10708.91 20844,-10708.91 20844,-10761.91"/>
<text text-anchor="middle" x="20741" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="20741" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20741" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_1_13&#45;&gt;ffn2_1_13 -->
<g id="edge1773" class="edge">
<title>act_1_13&#45;&gt;ffn2_1_13</title>
<path fill="none" stroke="black" d="M20737.51,-10861.3C20738.13,-10839.04 20739.2,-10800.74 20739.99,-10772.41"/>
<polygon fill="black" stroke="black" points="20743.5,-10772.19 20740.28,-10762.09 20736.5,-10771.99 20743.5,-10772.19"/>
</g>
<!-- ffn2_1_14 -->
<g id="node1249" class="node">
<title>ffn2_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21516,-10761.91 21310,-10761.91 21310,-10708.91 21516,-10708.91 21516,-10761.91"/>
<text text-anchor="middle" x="21413" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="21413" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21413" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_1_14&#45;&gt;ffn2_1_14 -->
<g id="edge1782" class="edge">
<title>act_1_14&#45;&gt;ffn2_1_14</title>
<path fill="none" stroke="black" d="M21409.51,-10861.3C21410.13,-10839.04 21411.2,-10800.74 21411.99,-10772.41"/>
<polygon fill="black" stroke="black" points="21415.5,-10772.19 21412.28,-10762.09 21408.5,-10771.99 21415.5,-10772.19"/>
</g>
<!-- ffn2_1_15 -->
<g id="node1250" class="node">
<title>ffn2_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21292,-10761.91 21086,-10761.91 21086,-10708.91 21292,-10708.91 21292,-10761.91"/>
<text text-anchor="middle" x="21189" y="-10746.71" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="21189" y="-10731.71" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21189" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_1_15&#45;&gt;ffn2_1_15 -->
<g id="edge1791" class="edge">
<title>act_1_15&#45;&gt;ffn2_1_15</title>
<path fill="none" stroke="black" d="M21185.51,-10861.3C21186.13,-10839.04 21187.2,-10800.74 21187.99,-10772.41"/>
<polygon fill="black" stroke="black" points="21191.5,-10772.19 21188.28,-10762.09 21184.5,-10771.99 21191.5,-10772.19"/>
</g>
<!-- res_ffn1_0 -->
<g id="node1267" class="node">
<title>res_ffn1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12298.26,-10646.41 11978.1,-10646.41 11895.74,-10540.41 12215.9,-10540.41 12298.26,-10646.41"/>
<text text-anchor="middle" x="12097" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12097" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12097" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn2_1_0&#45;&gt;res_ffn1_0 -->
<g id="edge1657" class="edge">
<title>ffn2_1_0&#45;&gt;res_ffn1_0</title>
<path fill="none" stroke="black" d="M18680.08,-10708.81C18659.43,-10698.45 18634.19,-10687.69 18610,-10682.41 18270.74,-10608.26 12747.3,-10688.44 12307.41,-10646.22"/>
<polygon fill="black" stroke="black" points="12307.76,-10642.73 12297.44,-10645.13 12307,-10649.69 12307.76,-10642.73"/>
</g>
<!-- res_ffn1_1 -->
<g id="node1268" class="node">
<title>res_ffn1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13138.26,-10646.41 12818.1,-10646.41 12735.74,-10540.41 13055.9,-10540.41 13138.26,-10646.41"/>
<text text-anchor="middle" x="12937" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12937" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12937" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn2_1_1&#45;&gt;res_ffn1_1 -->
<g id="edge1666" class="edge">
<title>ffn2_1_1&#45;&gt;res_ffn1_1</title>
<path fill="none" stroke="black" d="M19129.33,-10708.81C19109.23,-10698.45 19084.64,-10687.7 19061,-10682.41 18743.2,-10611.21 13565.23,-10685.84 13147.42,-10646.21"/>
<polygon fill="black" stroke="black" points="13147.76,-10642.73 13137.44,-10645.13 13147,-10649.68 13147.76,-10642.73"/>
</g>
<!-- res_ffn1_2 -->
<g id="node1269" class="node">
<title>res_ffn1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13558.26,-10646.41 13238.1,-10646.41 13155.74,-10540.41 13475.9,-10540.41 13558.26,-10646.41"/>
<text text-anchor="middle" x="13357" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13357" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13357" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn2_1_2&#45;&gt;res_ffn1_2 -->
<g id="edge1675" class="edge">
<title>ffn2_1_2&#45;&gt;res_ffn1_2</title>
<path fill="none" stroke="black" d="M19353.33,-10708.82C19333.23,-10698.46 19308.64,-10687.7 19285,-10682.41 18977.82,-10613.56 13973.83,-10684.55 13567.4,-10646.2"/>
<polygon fill="black" stroke="black" points="13567.76,-10642.72 13557.44,-10645.13 13567,-10649.68 13567.76,-10642.72"/>
</g>
<!-- res_ffn1_3 -->
<g id="node1270" class="node">
<title>res_ffn1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13978.26,-10646.41 13658.1,-10646.41 13575.74,-10540.41 13895.9,-10540.41 13978.26,-10646.41"/>
<text text-anchor="middle" x="13777" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13777" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13777" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn2_1_3&#45;&gt;res_ffn1_3 -->
<g id="edge1684" class="edge">
<title>ffn2_1_3&#45;&gt;res_ffn1_3</title>
<path fill="none" stroke="black" d="M19577.33,-10708.82C19557.23,-10698.46 19532.64,-10687.71 19509,-10682.41 19212.5,-10615.92 14384.64,-10683.24 13987.65,-10646.22"/>
<polygon fill="black" stroke="black" points="13987.75,-10642.71 13977.44,-10645.13 13987.01,-10649.67 13987.75,-10642.71"/>
</g>
<!-- res_ffn1_4 -->
<g id="node1271" class="node">
<title>res_ffn1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12718.26,-10646.41 12398.1,-10646.41 12315.74,-10540.41 12635.9,-10540.41 12718.26,-10646.41"/>
<text text-anchor="middle" x="12517" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12517" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12517" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn2_1_4&#45;&gt;res_ffn1_4 -->
<g id="edge1693" class="edge">
<title>ffn2_1_4&#45;&gt;res_ffn1_4</title>
<path fill="none" stroke="black" d="M18905.33,-10708.81C18885.23,-10698.45 18860.64,-10687.7 18837,-10682.41 18508.58,-10608.87 13156.46,-10687.14 12727.43,-10646.21"/>
<polygon fill="black" stroke="black" points="12727.76,-10642.73 12717.44,-10645.13 12727,-10649.69 12727.76,-10642.73"/>
</g>
<!-- res_ffn1_5 -->
<g id="node1272" class="node">
<title>res_ffn1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14398.26,-10646.41 14078.1,-10646.41 13995.74,-10540.41 14315.9,-10540.41 14398.26,-10646.41"/>
<text text-anchor="middle" x="14197" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14197" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14197" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn2_1_5&#45;&gt;res_ffn1_5 -->
<g id="edge1702" class="edge">
<title>ffn2_1_5&#45;&gt;res_ffn1_5</title>
<path fill="none" stroke="black" d="M19801.33,-10708.82C19781.23,-10698.46 19756.64,-10687.71 19733,-10682.41 19447.1,-10618.26 14792.82,-10681.95 14407.58,-10646.21"/>
<polygon fill="black" stroke="black" points="14407.75,-10642.71 14397.44,-10645.12 14407.01,-10649.67 14407.75,-10642.71"/>
</g>
<!-- res_ffn1_6 -->
<g id="node1273" class="node">
<title>res_ffn1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15658.26,-10646.41 15338.1,-10646.41 15255.74,-10540.41 15575.9,-10540.41 15658.26,-10646.41"/>
<text text-anchor="middle" x="15457" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15457" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15457" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn2_1_6&#45;&gt;res_ffn1_6 -->
<g id="edge1711" class="edge">
<title>ffn2_1_6&#45;&gt;res_ffn1_6</title>
<path fill="none" stroke="black" d="M20473.33,-10708.83C20453.23,-10698.47 20428.64,-10687.72 20405,-10682.41 20150.94,-10625.29 16018.38,-10678.11 15667.52,-10646.19"/>
<polygon fill="black" stroke="black" points="15667.75,-10642.7 15657.44,-10645.12 15667.01,-10649.66 15667.75,-10642.7"/>
</g>
<!-- res_ffn1_7 -->
<g id="node1274" class="node">
<title>res_ffn1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14818.26,-10646.41 14498.1,-10646.41 14415.74,-10540.41 14735.9,-10540.41 14818.26,-10646.41"/>
<text text-anchor="middle" x="14617" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14617" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14617" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn2_1_7&#45;&gt;res_ffn1_7 -->
<g id="edge1720" class="edge">
<title>ffn2_1_7&#45;&gt;res_ffn1_7</title>
<path fill="none" stroke="black" d="M20025.33,-10708.82C20005.23,-10698.47 19980.64,-10687.71 19957,-10682.41 19681.7,-10620.6 15200.83,-10680.68 14827.49,-10646.2"/>
<polygon fill="black" stroke="black" points="14827.75,-10642.71 14817.44,-10645.12 14827.01,-10649.67 14827.75,-10642.71"/>
</g>
<!-- res_ffn1_8 -->
<g id="node1275" class="node">
<title>res_ffn1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16498.26,-10646.41 16178.1,-10646.41 16095.74,-10540.41 16415.9,-10540.41 16498.26,-10646.41"/>
<text text-anchor="middle" x="16297" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16297" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16297" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn2_1_8&#45;&gt;res_ffn1_8 -->
<g id="edge1729" class="edge">
<title>ffn2_1_8&#45;&gt;res_ffn1_8</title>
<path fill="none" stroke="black" d="M20921.32,-10708.84C20901.22,-10698.48 20876.63,-10687.73 20853,-10682.41 20620.21,-10629.99 16836.78,-10675.54 16507.68,-10646.19"/>
<polygon fill="black" stroke="black" points="16507.75,-10642.68 16497.44,-10645.12 16507.02,-10649.64 16507.75,-10642.68"/>
</g>
<!-- res_ffn1_9 -->
<g id="node1276" class="node">
<title>res_ffn1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15238.26,-10646.41 14918.1,-10646.41 14835.74,-10540.41 15155.9,-10540.41 15238.26,-10646.41"/>
<text text-anchor="middle" x="15037" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15037" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15037" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn2_1_9&#45;&gt;res_ffn1_9 -->
<g id="edge1738" class="edge">
<title>ffn2_1_9&#45;&gt;res_ffn1_9</title>
<path fill="none" stroke="black" d="M20249.33,-10708.83C20229.23,-10698.47 20204.64,-10687.72 20181,-10682.41 19916.29,-10622.94 15608.67,-10679.4 15247.39,-10646.18"/>
<polygon fill="black" stroke="black" points="15247.75,-10642.7 15237.44,-10645.12 15247.01,-10649.66 15247.75,-10642.7"/>
</g>
<!-- res_ffn1_10 -->
<g id="node1277" class="node">
<title>res_ffn1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18598.26,-10646.41 18278.1,-10646.41 18195.74,-10540.41 18515.9,-10540.41 18598.26,-10646.41"/>
<text text-anchor="middle" x="18397" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18397" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18397" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn2_1_10&#45;&gt;res_ffn1_10 -->
<g id="edge1747" class="edge">
<title>ffn2_1_10&#45;&gt;res_ffn1_10</title>
<path fill="none" stroke="black" d="M22041.02,-10708.88C22020.96,-10698.6 21996.48,-10687.9 21973,-10682.41 21640.18,-10604.61 19235.29,-10595.54 18568.19,-10594.52"/>
<polygon fill="black" stroke="black" points="18568.02,-10591.02 18558.02,-10594.51 18568.01,-10598.02 18568.02,-10591.02"/>
</g>
<!-- res_ffn1_11 -->
<g id="node1278" class="node">
<title>res_ffn1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18178.26,-10646.41 17858.1,-10646.41 17775.74,-10540.41 18095.9,-10540.41 18178.26,-10646.41"/>
<text text-anchor="middle" x="17977" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17977" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17977" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn2_1_11&#45;&gt;res_ffn1_11 -->
<g id="edge1756" class="edge">
<title>ffn2_1_11&#45;&gt;res_ffn1_11</title>
<path fill="none" stroke="black" d="M21817.32,-10708.86C21797.22,-10698.51 21772.63,-10687.75 21749,-10682.41 21558.61,-10639.36 18469.51,-10670.48 18187.53,-10646.15"/>
<polygon fill="black" stroke="black" points="18187.75,-10642.66 18177.44,-10645.11 18187.03,-10649.62 18187.75,-10642.66"/>
</g>
<!-- res_ffn1_12 -->
<g id="node1279" class="node">
<title>res_ffn1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17758.26,-10646.41 17438.1,-10646.41 17355.74,-10540.41 17675.9,-10540.41 17758.26,-10646.41"/>
<text text-anchor="middle" x="17557" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17557" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17557" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn2_1_12&#45;&gt;res_ffn1_12 -->
<g id="edge1765" class="edge">
<title>ffn2_1_12&#45;&gt;res_ffn1_12</title>
<path fill="none" stroke="black" d="M21593.32,-10708.85C21573.22,-10698.5 21548.63,-10687.74 21525,-10682.41 21324.03,-10637.02 18061.84,-10671.74 17767.63,-10646.17"/>
<polygon fill="black" stroke="black" points="17767.75,-10642.66 17757.44,-10645.11 17767.03,-10649.63 17767.75,-10642.66"/>
</g>
<!-- res_ffn1_13 -->
<g id="node1280" class="node">
<title>res_ffn1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16078.26,-10646.41 15758.1,-10646.41 15675.74,-10540.41 15995.9,-10540.41 16078.26,-10646.41"/>
<text text-anchor="middle" x="15877" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15877" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15877" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn2_1_13&#45;&gt;res_ffn1_13 -->
<g id="edge1774" class="edge">
<title>ffn2_1_13&#45;&gt;res_ffn1_13</title>
<path fill="none" stroke="black" d="M20697.32,-10708.83C20677.23,-10698.48 20652.63,-10687.72 20629,-10682.41 20385.58,-10627.64 16427.75,-10676.82 16087.62,-10646.19"/>
<polygon fill="black" stroke="black" points="16087.75,-10642.69 16077.44,-10645.12 16087.02,-10649.65 16087.75,-10642.69"/>
</g>
<!-- res_ffn1_14 -->
<g id="node1281" class="node">
<title>res_ffn1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17338.26,-10646.41 17018.1,-10646.41 16935.74,-10540.41 17255.9,-10540.41 17338.26,-10646.41"/>
<text text-anchor="middle" x="17137" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17137" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17137" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn2_1_14&#45;&gt;res_ffn1_14 -->
<g id="edge1783" class="edge">
<title>ffn2_1_14&#45;&gt;res_ffn1_14</title>
<path fill="none" stroke="black" d="M21369.32,-10708.85C21349.22,-10698.49 21324.63,-10687.74 21301,-10682.41 21089.43,-10634.68 17653.82,-10673 17347.68,-10646.18"/>
<polygon fill="black" stroke="black" points="17347.75,-10642.67 17337.44,-10645.11 17347.02,-10649.63 17347.75,-10642.67"/>
</g>
<!-- res_ffn1_15 -->
<g id="node1282" class="node">
<title>res_ffn1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16918.26,-10646.41 16598.1,-10646.41 16515.74,-10540.41 16835.9,-10540.41 16918.26,-10646.41"/>
<text text-anchor="middle" x="16717" y="-10604.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16717" y="-10589.71" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16717" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn2_1_15&#45;&gt;res_ffn1_15 -->
<g id="edge1792" class="edge">
<title>ffn2_1_15&#45;&gt;res_ffn1_15</title>
<path fill="none" stroke="black" d="M21145.32,-10708.84C21125.22,-10698.49 21100.63,-10687.73 21077,-10682.41 20854.82,-10632.33 17245.47,-10674.26 16927.7,-10646.19"/>
<polygon fill="black" stroke="black" points="16927.75,-10642.68 16917.44,-10645.12 16927.02,-10649.64 16927.75,-10642.68"/>
</g>
<!-- res_attn1_0&#45;&gt;ffn1_1_0 -->
<g id="edge1654" class="edge">
<title>res_attn1_0&#45;&gt;ffn1_1_0</title>
<path fill="none" stroke="black" d="M12220.97,-10788.44C12249.02,-10799.36 12278.84,-10810.31 12307,-10819.41 12502.91,-10882.71 12551.9,-10906.37 12756,-10933.41 13357.24,-11013.05 17850.76,-11020.62 18613.22,-11021.33"/>
<polygon fill="black" stroke="black" points="18613.36,-11024.83 18623.36,-11021.34 18613.37,-11017.83 18613.36,-11024.83"/>
</g>
<!-- res_attn1_0&#45;&gt;res_ffn1_0 -->
<g id="edge1658" class="edge">
<title>res_attn1_0&#45;&gt;res_ffn1_0</title>
<path fill="none" stroke="black" d="M12097,-10682.28C12097,-10673.99 12097,-10665.34 12097,-10656.84"/>
<polygon fill="black" stroke="black" points="12100.5,-10656.58 12097,-10646.58 12093.5,-10656.58 12100.5,-10656.58"/>
</g>
<!-- res_attn1_1&#45;&gt;ffn1_1_1 -->
<g id="edge1663" class="edge">
<title>res_attn1_1&#45;&gt;ffn1_1_1</title>
<path fill="none" stroke="black" d="M13060.97,-10788.44C13089.02,-10799.36 13118.84,-10810.31 13147,-10819.41 13342.91,-10882.71 13391.79,-10907.2 13596,-10933.41 13896.71,-10971.99 18756.95,-10904.05 19053,-10969.41 19073.53,-10973.94 19094.82,-10982.46 19113.35,-10991.32"/>
<polygon fill="black" stroke="black" points="19111.98,-10994.54 19122.5,-10995.82 19115.07,-10988.26 19111.98,-10994.54"/>
</g>
<!-- res_attn1_1&#45;&gt;res_ffn1_1 -->
<g id="edge1667" class="edge">
<title>res_attn1_1&#45;&gt;res_ffn1_1</title>
<path fill="none" stroke="black" d="M12937,-10682.28C12937,-10673.99 12937,-10665.34 12937,-10656.84"/>
<polygon fill="black" stroke="black" points="12940.5,-10656.58 12937,-10646.58 12933.5,-10656.58 12940.5,-10656.58"/>
</g>
<!-- res_attn1_2&#45;&gt;ffn1_1_2 -->
<g id="edge1672" class="edge">
<title>res_attn1_2&#45;&gt;ffn1_1_2</title>
<path fill="none" stroke="black" d="M13480.97,-10788.44C13509.02,-10799.36 13538.84,-10810.31 13567,-10819.41 13762.91,-10882.71 13811.79,-10907.18 14016,-10933.41 14305.85,-10970.64 18990.65,-10906.38 19276,-10969.41 19296.53,-10973.94 19317.81,-10982.47 19336.35,-10991.32"/>
<polygon fill="black" stroke="black" points="19334.98,-10994.55 19345.49,-10995.82 19338.07,-10988.27 19334.98,-10994.55"/>
</g>
<!-- res_attn1_2&#45;&gt;res_ffn1_2 -->
<g id="edge1676" class="edge">
<title>res_attn1_2&#45;&gt;res_ffn1_2</title>
<path fill="none" stroke="black" d="M13357,-10682.28C13357,-10673.99 13357,-10665.34 13357,-10656.84"/>
<polygon fill="black" stroke="black" points="13360.5,-10656.58 13357,-10646.58 13353.5,-10656.58 13360.5,-10656.58"/>
</g>
<!-- res_attn1_3&#45;&gt;ffn1_1_3 -->
<g id="edge1681" class="edge">
<title>res_attn1_3&#45;&gt;ffn1_1_3</title>
<path fill="none" stroke="black" d="M13900.97,-10788.44C13929.02,-10799.36 13958.84,-10810.31 13987,-10819.41 14182.91,-10882.71 14231.79,-10907.15 14436,-10933.41 14714.99,-10969.28 19224.24,-10909.15 19499,-10969.41 19519.69,-10973.94 19541.15,-10982.47 19559.85,-10991.32"/>
<polygon fill="black" stroke="black" points="19558.56,-10994.59 19569.08,-10995.82 19561.62,-10988.29 19558.56,-10994.59"/>
</g>
<!-- res_attn1_3&#45;&gt;res_ffn1_3 -->
<g id="edge1685" class="edge">
<title>res_attn1_3&#45;&gt;res_ffn1_3</title>
<path fill="none" stroke="black" d="M13777,-10682.28C13777,-10673.99 13777,-10665.34 13777,-10656.84"/>
<polygon fill="black" stroke="black" points="13780.5,-10656.58 13777,-10646.58 13773.5,-10656.58 13780.5,-10656.58"/>
</g>
<!-- res_attn1_4&#45;&gt;ffn1_1_4 -->
<g id="edge1690" class="edge">
<title>res_attn1_4&#45;&gt;ffn1_1_4</title>
<path fill="none" stroke="black" d="M12640.97,-10788.44C12669.02,-10799.36 12698.84,-10810.31 12727,-10819.41 12922.91,-10882.71 12971.78,-10907.23 13176,-10933.41 13487.68,-10973.36 18525.38,-10900.67 18832,-10969.41 18852.13,-10973.92 18872.95,-10982.39 18891.1,-10991.2"/>
<polygon fill="black" stroke="black" points="18889.82,-10994.47 18900.33,-10995.82 18892.95,-10988.21 18889.82,-10994.47"/>
</g>
<!-- res_attn1_4&#45;&gt;res_ffn1_4 -->
<g id="edge1694" class="edge">
<title>res_attn1_4&#45;&gt;res_ffn1_4</title>
<path fill="none" stroke="black" d="M12517,-10682.28C12517,-10673.99 12517,-10665.34 12517,-10656.84"/>
<polygon fill="black" stroke="black" points="12520.5,-10656.58 12517,-10646.58 12513.5,-10656.58 12520.5,-10656.58"/>
</g>
<!-- res_attn1_5&#45;&gt;ffn1_1_5 -->
<g id="edge1699" class="edge">
<title>res_attn1_5&#45;&gt;ffn1_1_5</title>
<path fill="none" stroke="black" d="M14320.97,-10788.44C14349.02,-10799.36 14378.84,-10810.31 14407,-10819.41 14602.91,-10882.71 14651.8,-10907.12 14856,-10933.41 15124.18,-10967.93 19458.89,-10911.45 19723,-10969.41 19743.69,-10973.95 19765.15,-10982.47 19783.85,-10991.33"/>
<polygon fill="black" stroke="black" points="19782.56,-10994.59 19793.08,-10995.83 19785.62,-10988.3 19782.56,-10994.59"/>
</g>
<!-- res_attn1_5&#45;&gt;res_ffn1_5 -->
<g id="edge1703" class="edge">
<title>res_attn1_5&#45;&gt;res_ffn1_5</title>
<path fill="none" stroke="black" d="M14197,-10682.28C14197,-10673.99 14197,-10665.34 14197,-10656.84"/>
<polygon fill="black" stroke="black" points="14200.5,-10656.58 14197,-10646.58 14193.5,-10656.58 14200.5,-10656.58"/>
</g>
<!-- res_attn1_6&#45;&gt;ffn1_1_6 -->
<g id="edge1708" class="edge">
<title>res_attn1_6&#45;&gt;ffn1_1_6</title>
<path fill="none" stroke="black" d="M15574.76,-10788.51C15604.42,-10800.08 15636.5,-10811.3 15667,-10819.41 16009.4,-10910.47 16102.72,-10906.39 16456,-10933.41 16674.21,-10950.09 20181.29,-10922.31 20395,-10969.41 20415.69,-10973.97 20437.15,-10982.5 20455.85,-10991.35"/>
<polygon fill="black" stroke="black" points="20454.55,-10994.61 20465.07,-10995.85 20457.62,-10988.32 20454.55,-10994.61"/>
</g>
<!-- res_attn1_6&#45;&gt;res_ffn1_6 -->
<g id="edge1712" class="edge">
<title>res_attn1_6&#45;&gt;res_ffn1_6</title>
<path fill="none" stroke="black" d="M15457,-10682.28C15457,-10673.99 15457,-10665.34 15457,-10656.84"/>
<polygon fill="black" stroke="black" points="15460.5,-10656.58 15457,-10646.58 15453.5,-10656.58 15460.5,-10656.58"/>
</g>
<!-- res_attn1_7&#45;&gt;ffn1_1_7 -->
<g id="edge1717" class="edge">
<title>res_attn1_7&#45;&gt;ffn1_1_7</title>
<path fill="none" stroke="black" d="M14740.97,-10788.45C14769.01,-10799.37 14798.83,-10810.31 14827,-10819.41 15023.34,-10882.79 15072.37,-10907.09 15277,-10933.41 15534.33,-10966.5 19693.59,-10913.75 19947,-10969.41 19967.69,-10973.95 19989.15,-10982.48 20007.85,-10991.33"/>
<polygon fill="black" stroke="black" points="20006.55,-10994.59 20017.08,-10995.83 20009.62,-10988.3 20006.55,-10994.59"/>
</g>
<!-- res_attn1_7&#45;&gt;res_ffn1_7 -->
<g id="edge1721" class="edge">
<title>res_attn1_7&#45;&gt;res_ffn1_7</title>
<path fill="none" stroke="black" d="M14617,-10682.28C14617,-10673.99 14617,-10665.34 14617,-10656.84"/>
<polygon fill="black" stroke="black" points="14620.5,-10656.58 14617,-10646.58 14613.5,-10656.58 14620.5,-10656.58"/>
</g>
<!-- res_attn1_8&#45;&gt;ffn1_1_8 -->
<g id="edge1726" class="edge">
<title>res_attn1_8&#45;&gt;ffn1_1_8</title>
<path fill="none" stroke="black" d="M16409.05,-10788.48C16440.14,-10800.76 16474.34,-10812.33 16507,-10819.41 16576.15,-10834.39 16596.66,-10813.33 16666,-10827.41 16800.48,-10854.72 16820.98,-10908.86 16956,-10933.41 17380.94,-11010.67 20421.22,-10876.43 20843,-10969.41 20863.68,-10973.97 20885.15,-10982.5 20903.85,-10991.35"/>
<polygon fill="black" stroke="black" points="20902.55,-10994.61 20913.07,-10995.85 20905.62,-10988.32 20902.55,-10994.61"/>
</g>
<!-- res_attn1_8&#45;&gt;res_ffn1_8 -->
<g id="edge1730" class="edge">
<title>res_attn1_8&#45;&gt;res_ffn1_8</title>
<path fill="none" stroke="black" d="M16297,-10682.28C16297,-10673.99 16297,-10665.34 16297,-10656.84"/>
<polygon fill="black" stroke="black" points="16300.5,-10656.58 16297,-10646.58 16293.5,-10656.58 16300.5,-10656.58"/>
</g>
<!-- res_attn1_9&#45;&gt;ffn1_1_9 -->
<g id="edge1735" class="edge">
<title>res_attn1_9&#45;&gt;ffn1_1_9</title>
<path fill="none" stroke="black" d="M15160.95,-10788.5C15189,-10799.42 15218.82,-10810.35 15247,-10819.41 15445.48,-10883.19 15495.2,-10907.05 15702,-10933.41 15948.29,-10964.8 19928.5,-10916.11 20171,-10969.41 20191.69,-10973.95 20213.15,-10982.48 20231.85,-10991.34"/>
<polygon fill="black" stroke="black" points="20230.55,-10994.6 20241.08,-10995.83 20233.62,-10988.3 20230.55,-10994.6"/>
</g>
<!-- res_attn1_9&#45;&gt;res_ffn1_9 -->
<g id="edge1739" class="edge">
<title>res_attn1_9&#45;&gt;res_ffn1_9</title>
<path fill="none" stroke="black" d="M15037,-10682.28C15037,-10673.99 15037,-10665.34 15037,-10656.84"/>
<polygon fill="black" stroke="black" points="15040.5,-10656.58 15037,-10646.58 15033.5,-10656.58 15040.5,-10656.58"/>
</g>
<!-- res_attn1_10&#45;&gt;ffn1_1_10 -->
<g id="edge1744" class="edge">
<title>res_attn1_10&#45;&gt;ffn1_1_10</title>
<path fill="none" stroke="black" d="M18450.76,-10788.48C18504.37,-10836.53 18591.58,-10904.65 18682,-10933.41 18855.72,-10988.65 21785.02,-10930.01 21963,-10969.41 21983.68,-10973.98 22005.14,-10982.52 22023.84,-10991.37"/>
<polygon fill="black" stroke="black" points="22022.55,-10994.63 22033.07,-10995.87 22025.61,-10988.34 22022.55,-10994.63"/>
</g>
<!-- res_attn1_10&#45;&gt;res_ffn1_10 -->
<g id="edge1748" class="edge">
<title>res_attn1_10&#45;&gt;res_ffn1_10</title>
<path fill="none" stroke="black" d="M18397,-10682.28C18397,-10673.99 18397,-10665.34 18397,-10656.84"/>
<polygon fill="black" stroke="black" points="18400.5,-10656.58 18397,-10646.58 18393.5,-10656.58 18400.5,-10656.58"/>
</g>
<!-- res_attn1_11&#45;&gt;ffn1_1_11 -->
<g id="edge1753" class="edge">
<title>res_attn1_11&#45;&gt;ffn1_1_11</title>
<path fill="none" stroke="black" d="M18079.99,-10788.51C18181.89,-10836.94 18343.81,-10905.66 18493,-10933.41 18847.61,-10999.35 21386.84,-10891.44 21739,-10969.41 21759.68,-10973.99 21781.14,-10982.52 21799.84,-10991.37"/>
<polygon fill="black" stroke="black" points="21798.55,-10994.63 21809.07,-10995.87 21801.61,-10988.34 21798.55,-10994.63"/>
</g>
<!-- res_attn1_11&#45;&gt;res_ffn1_11 -->
<g id="edge1757" class="edge">
<title>res_attn1_11&#45;&gt;res_ffn1_11</title>
<path fill="none" stroke="black" d="M17977,-10682.28C17977,-10673.99 17977,-10665.34 17977,-10656.84"/>
<polygon fill="black" stroke="black" points="17980.5,-10656.58 17977,-10646.58 17973.5,-10656.58 17980.5,-10656.58"/>
</g>
<!-- res_attn1_12&#45;&gt;ffn1_1_12 -->
<g id="edge1762" class="edge">
<title>res_attn1_12&#45;&gt;ffn1_1_12</title>
<path fill="none" stroke="black" d="M17676.47,-10788.5C17796.85,-10837.77 17989.28,-10907.86 18164,-10933.41 18532.44,-10987.28 21151.43,-10888.98 21515,-10969.41 21535.68,-10973.98 21557.14,-10982.52 21575.84,-10991.37"/>
<polygon fill="black" stroke="black" points="21574.55,-10994.63 21585.07,-10995.86 21577.61,-10988.34 21574.55,-10994.63"/>
</g>
<!-- res_attn1_12&#45;&gt;res_ffn1_12 -->
<g id="edge1766" class="edge">
<title>res_attn1_12&#45;&gt;res_ffn1_12</title>
<path fill="none" stroke="black" d="M17557,-10682.28C17557,-10673.99 17557,-10665.34 17557,-10656.84"/>
<polygon fill="black" stroke="black" points="17560.5,-10656.58 17557,-10646.58 17553.5,-10656.58 17560.5,-10656.58"/>
</g>
<!-- res_attn1_13&#45;&gt;ffn1_1_13 -->
<g id="edge1771" class="edge">
<title>res_attn1_13&#45;&gt;ffn1_1_13</title>
<path fill="none" stroke="black" d="M15987.29,-10788.46C16018.81,-10800.98 16053.66,-10812.68 16087,-10819.41 16167.4,-10835.62 16376.42,-10807.55 16456,-10827.41 16557.44,-10852.72 16564.4,-10908.73 16666,-10933.41 16879.42,-10985.24 20404.52,-10922.15 20619,-10969.41 20639.69,-10973.96 20661.15,-10982.5 20679.85,-10991.35"/>
<polygon fill="black" stroke="black" points="20678.55,-10994.61 20689.07,-10995.84 20681.62,-10988.32 20678.55,-10994.61"/>
</g>
<!-- res_attn1_13&#45;&gt;res_ffn1_13 -->
<g id="edge1775" class="edge">
<title>res_attn1_13&#45;&gt;res_ffn1_13</title>
<path fill="none" stroke="black" d="M15877,-10682.28C15877,-10673.99 15877,-10665.34 15877,-10656.84"/>
<polygon fill="black" stroke="black" points="15880.5,-10656.58 15877,-10646.58 15873.5,-10656.58 15880.5,-10656.58"/>
</g>
<!-- res_attn1_14&#45;&gt;ffn1_1_14 -->
<g id="edge1780" class="edge">
<title>res_attn1_14&#45;&gt;ffn1_1_14</title>
<path fill="none" stroke="black" d="M17262.74,-10788.45C17390.21,-10837.97 17594.42,-10908.5 17779,-10933.41 18165.74,-10985.59 20909.95,-10885.21 21291,-10969.41 21311.68,-10973.98 21333.14,-10982.51 21351.84,-10991.36"/>
<polygon fill="black" stroke="black" points="21350.55,-10994.62 21361.07,-10995.86 21353.61,-10988.33 21350.55,-10994.62"/>
</g>
<!-- res_attn1_14&#45;&gt;res_ffn1_14 -->
<g id="edge1784" class="edge">
<title>res_attn1_14&#45;&gt;res_ffn1_14</title>
<path fill="none" stroke="black" d="M17137,-10682.28C17137,-10673.99 17137,-10665.34 17137,-10656.84"/>
<polygon fill="black" stroke="black" points="17140.5,-10656.58 17137,-10646.58 17133.5,-10656.58 17140.5,-10656.58"/>
</g>
<!-- res_attn1_15&#45;&gt;ffn1_1_15 -->
<g id="edge1789" class="edge">
<title>res_attn1_15&#45;&gt;ffn1_1_15</title>
<path fill="none" stroke="black" d="M16841.26,-10788.51C16869.23,-10799.4 16898.94,-10810.31 16927,-10819.41 17121.63,-10882.47 17170.13,-10906.89 17373,-10933.41 17576.5,-10960.01 20866.59,-10925.18 21067,-10969.41 21087.68,-10973.97 21109.14,-10982.5 21127.85,-10991.36"/>
<polygon fill="black" stroke="black" points="21126.55,-10994.62 21137.07,-10995.85 21129.62,-10988.32 21126.55,-10994.62"/>
</g>
<!-- res_attn1_15&#45;&gt;res_ffn1_15 -->
<g id="edge1793" class="edge">
<title>res_attn1_15&#45;&gt;res_ffn1_15</title>
<path fill="none" stroke="black" d="M16717,-10682.28C16717,-10673.99 16717,-10665.34 16717,-10656.84"/>
<polygon fill="black" stroke="black" points="16720.5,-10656.58 16717,-10646.58 16713.5,-10656.58 16720.5,-10656.58"/>
</g>
<!-- qkv2_0 -->
<g id="node1283" class="node">
<title>qkv2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11299,-10414.3 11093,-10414.3 11093,-10361.3 11299,-10361.3 11299,-10414.3"/>
<text text-anchor="middle" x="11196" y="-10399.1" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11196" y="-10384.1" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11196" y="-10369.1" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn1_0&#45;&gt;qkv2_0 -->
<g id="edge1794" class="edge">
<title>res_ffn1_0&#45;&gt;qkv2_0</title>
<path fill="none" stroke="black" d="M11915.37,-10540.34C11904.78,-10537.59 11894.26,-10534.92 11884,-10532.41 11682.82,-10483.14 11445.93,-10436.06 11309.15,-10409.94"/>
<polygon fill="black" stroke="black" points="11309.55,-10406.45 11299.07,-10408.02 11308.24,-10413.33 11309.55,-10406.45"/>
</g>
<!-- res_attn2_0 -->
<g id="node1891" class="node">
<title>res_attn2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16256.26,-5679.2 15936.1,-5679.2 15853.74,-5573.2 16173.9,-5573.2 16256.26,-5679.2"/>
<text text-anchor="middle" x="16055" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16055" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16055" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn1_0&#45;&gt;res_attn2_0 -->
<g id="edge2549" class="edge">
<title>res_ffn1_0&#45;&gt;res_attn2_0</title>
<path fill="none" stroke="black" d="M12227.03,-10554.49C12253.45,-10547 12281.08,-10539.32 12307,-10532.41 12835.27,-10391.47 14695,-10486.84 14695,-9940.1 14695,-9940.1 14695,-9940.1 14695,-9489.4 14695,-9370.63 14696,-9340.94 14696,-9222.18 14696,-9222.18 14696,-9222.18 14696,-8950.95 14696,-8552.66 14733,-8453.85 14733,-8055.55 14733,-8055.55 14733,-8055.55 14733,-5912.2 14733,-5825.32 14692.12,-5775.98 14757,-5718.2 14768.25,-5708.18 15827.2,-5713.04 15842,-5710.2 15872.77,-5704.3 15904.83,-5694.15 15934.44,-5682.92"/>
<polygon fill="black" stroke="black" points="15935.9,-5686.11 15943.97,-5679.24 15933.38,-5679.58 15935.9,-5686.11"/>
</g>
<!-- qkv2_1 -->
<g id="node1284" class="node">
<title>qkv2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11408,-10324.56 11202,-10324.56 11202,-10271.56 11408,-10271.56 11408,-10324.56"/>
<text text-anchor="middle" x="11305" y="-10309.36" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11305" y="-10294.36" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11305" y="-10279.36" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn1_1&#45;&gt;qkv2_1 -->
<g id="edge1795" class="edge">
<title>res_ffn1_1&#45;&gt;qkv2_1</title>
<path fill="none" stroke="black" d="M12760.36,-10540.36C12749.1,-10537.53 12737.91,-10534.85 12727,-10532.41 12245.07,-10424.4 11660.8,-10344.2 11418.61,-10313.16"/>
<polygon fill="black" stroke="black" points="11418.75,-10309.65 11408.39,-10311.85 11417.87,-10316.59 11418.75,-10309.65"/>
</g>
<!-- res_attn2_1 -->
<g id="node1892" class="node">
<title>res_attn2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17096.26,-5679.2 16776.1,-5679.2 16693.74,-5573.2 17013.9,-5573.2 17096.26,-5679.2"/>
<text text-anchor="middle" x="16895" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16895" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16895" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn1_1&#45;&gt;res_attn2_1 -->
<g id="edge2558" class="edge">
<title>res_ffn1_1&#45;&gt;res_attn2_1</title>
<path fill="none" stroke="black" d="M13064.6,-10551.6C13091.58,-10544.2 13120.04,-10537.29 13147,-10532.41 13788.43,-10416.13 14007.6,-10666.2 14609,-10414.67 14894.38,-10295.31 14847,-10069.95 14847,-9760.62 14847,-9760.62 14847,-9760.62 14847,-5912.2 14847,-5821.69 14836.02,-5771.75 14909,-5718.2 14928.89,-5703.61 16660.78,-5714.87 16685,-5710.2 16715.39,-5704.34 16747.01,-5694.2 16776.21,-5682.98"/>
<polygon fill="black" stroke="black" points="16777.57,-5686.21 16785.61,-5679.3 16775.02,-5679.69 16777.57,-5686.21"/>
</g>
<!-- qkv2_2 -->
<g id="node1285" class="node">
<title>qkv2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11567,-10234.82 11361,-10234.82 11361,-10181.82 11567,-10181.82 11567,-10234.82"/>
<text text-anchor="middle" x="11464" y="-10219.62" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11464" y="-10204.62" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11464" y="-10189.62" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn1_2&#45;&gt;qkv2_2 -->
<g id="edge1796" class="edge">
<title>res_ffn1_2&#45;&gt;qkv2_2</title>
<path fill="none" stroke="black" d="M13178.85,-10540.33C13168.1,-10537.56 13157.42,-10534.89 13147,-10532.41 12560.94,-10392.72 11849,-10271.87 11577.01,-10227.45"/>
<polygon fill="black" stroke="black" points="11577.56,-10223.99 11567.13,-10225.84 11576.44,-10230.9 11577.56,-10223.99"/>
</g>
<!-- res_attn2_2 -->
<g id="node1893" class="node">
<title>res_attn2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17516.26,-5679.2 17196.1,-5679.2 17113.74,-5573.2 17433.9,-5573.2 17516.26,-5679.2"/>
<text text-anchor="middle" x="17315" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17315" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17315" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn1_2&#45;&gt;res_attn2_2 -->
<g id="edge2567" class="edge">
<title>res_ffn1_2&#45;&gt;res_attn2_2</title>
<path fill="none" stroke="black" d="M13484.98,-10552.06C13511.87,-10544.65 13540.2,-10537.62 13567,-10532.41 13711.6,-10504.26 14885,-10536.11 14885,-10388.8 14885,-10388.8 14885,-10388.8 14885,-10117.58 14885,-9958.03 14923,-9920.16 14923,-9760.62 14923,-9760.62 14923,-9760.62 14923,-5912.2 14923,-5824.67 14890.08,-5774.63 14957,-5718.2 14968.4,-5708.59 17090.35,-5713.02 17105,-5710.2 17135.48,-5704.34 17167.2,-5694.16 17196.47,-5682.9"/>
<polygon fill="black" stroke="black" points="17197.85,-5686.12 17205.88,-5679.21 17195.29,-5679.6 17197.85,-5686.12"/>
</g>
<!-- qkv2_3 -->
<g id="node1286" class="node">
<title>qkv2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11777,-10145.08 11571,-10145.08 11571,-10092.08 11777,-10092.08 11777,-10145.08"/>
<text text-anchor="middle" x="11674" y="-10129.88" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11674" y="-10114.88" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11674" y="-10099.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn1_3&#45;&gt;qkv2_3 -->
<g id="edge1797" class="edge">
<title>res_ffn1_3&#45;&gt;qkv2_3</title>
<path fill="none" stroke="black" d="M13597.63,-10540.34C13587.29,-10537.59 13577.02,-10534.93 13567,-10532.41 12896.12,-10363.59 12081.41,-10199.58 11786.97,-10141.6"/>
<polygon fill="black" stroke="black" points="11787.62,-10138.16 11777.14,-10139.67 11786.27,-10145.03 11787.62,-10138.16"/>
</g>
<!-- res_attn2_3 -->
<g id="node1894" class="node">
<title>res_attn2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18356.26,-5679.2 18036.1,-5679.2 17953.74,-5573.2 18273.9,-5573.2 18356.26,-5679.2"/>
<text text-anchor="middle" x="18155" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18155" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18155" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn1_3&#45;&gt;res_attn2_3 -->
<g id="edge2576" class="edge">
<title>res_ffn1_3&#45;&gt;res_attn2_3</title>
<path fill="none" stroke="black" d="M13904.2,-10551.01C13931.27,-10543.63 13959.88,-10536.88 13987,-10532.41 14437.01,-10458.22 14961,-10665.4 14961,-10209.32 14961,-10209.32 14961,-10209.32 14961,-8950.95 14961,-8802 14992.1,-8767.35 15013,-8619.86 15042.83,-8409.37 15073,-8357.89 15073,-8145.29 15073,-8145.29 15073,-8145.29 15073,-7963.81 15073,-7431.3 15037,-7298.72 15037,-6766.2 15037,-6766.2 15037,-6766.2 15037,-5912.2 15037,-5807.66 15077.58,-5767.07 15170,-5718.2 15187.04,-5709.2 17926.07,-5713.84 17945,-5710.2 17975.48,-5704.35 18007.2,-5694.18 18036.47,-5682.92"/>
<polygon fill="black" stroke="black" points="18037.85,-5686.14 18045.88,-5679.23 18035.3,-5679.62 18037.85,-5686.14"/>
</g>
<!-- qkv2_4 -->
<g id="node1287" class="node">
<title>qkv2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9174,-10055.34 8968,-10055.34 8968,-10002.34 9174,-10002.34 9174,-10055.34"/>
<text text-anchor="middle" x="9071" y="-10040.14" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9071" y="-10025.14" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9071" y="-10010.14" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn1_4&#45;&gt;qkv2_4 -->
<g id="edge1798" class="edge">
<title>res_ffn1_4&#45;&gt;qkv2_4</title>
<path fill="none" stroke="black" d="M12348.45,-10540.4C12334.52,-10537.28 12320.58,-10534.54 12307,-10532.41 12283.04,-10528.64 8832.86,-10432.11 8816,-10414.67 8705.03,-10299.89 8921.14,-10130.74 9022.51,-10061.32"/>
<polygon fill="black" stroke="black" points="9024.77,-10064.02 9031.07,-10055.51 9020.83,-10058.23 9024.77,-10064.02"/>
</g>
<!-- res_attn2_4 -->
<g id="node1895" class="node">
<title>res_attn2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16676.26,-5679.2 16356.1,-5679.2 16273.74,-5573.2 16593.9,-5573.2 16676.26,-5679.2"/>
<text text-anchor="middle" x="16475" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16475" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16475" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn1_4&#45;&gt;res_attn2_4 -->
<g id="edge2585" class="edge">
<title>res_ffn1_4&#45;&gt;res_attn2_4</title>
<path fill="none" stroke="black" d="M12645.32,-10552.31C12672.12,-10544.9 12700.34,-10537.81 12727,-10532.41 13387.88,-10398.37 13577.04,-10493.37 14230,-10324.93 14495.2,-10256.51 14771,-10303.72 14771,-10029.84 14771,-10029.84 14771,-10029.84 14771,-5912.2 14771,-5825.48 14727.62,-5776.31 14792,-5718.2 14807.19,-5704.5 16244.91,-5714.09 16265,-5710.2 16295.39,-5704.33 16327.01,-5694.18 16356.21,-5682.96"/>
<polygon fill="black" stroke="black" points="16357.57,-5686.19 16365.6,-5679.28 16355.01,-5679.67 16357.57,-5686.19"/>
</g>
<!-- qkv2_5 -->
<g id="node1288" class="node">
<title>qkv2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8832,-9965.6 8626,-9965.6 8626,-9912.6 8832,-9912.6 8832,-9965.6"/>
<text text-anchor="middle" x="8729" y="-9950.4" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8729" y="-9935.4" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8729" y="-9920.4" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn1_5&#45;&gt;qkv2_5 -->
<g id="edge1799" class="edge">
<title>res_ffn1_5&#45;&gt;qkv2_5</title>
<path fill="none" stroke="black" d="M14029.05,-10540.38C14014.92,-10537.24 14000.78,-10534.5 13987,-10532.41 13232.8,-10417.61 11317.68,-10468.33 10555,-10450.67 10466.11,-10448.61 9034.59,-10454.3 8955,-10414.67 8785.52,-10330.28 8742.31,-10070.97 8732.01,-9975.69"/>
<polygon fill="black" stroke="black" points="8735.49,-9975.28 8730.99,-9965.69 8728.53,-9975.99 8735.49,-9975.28"/>
</g>
<!-- res_attn2_5 -->
<g id="node1896" class="node">
<title>res_attn2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17936.26,-5679.2 17616.1,-5679.2 17533.74,-5573.2 17853.9,-5573.2 17936.26,-5679.2"/>
<text text-anchor="middle" x="17735" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17735" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17735" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn1_5&#45;&gt;res_attn2_5 -->
<g id="edge2594" class="edge">
<title>res_ffn1_5&#45;&gt;res_attn2_5</title>
<path fill="none" stroke="black" d="M14326.58,-10553.91C14353.1,-10546.45 14380.88,-10538.93 14407,-10532.41 14538.34,-10499.6 14999,-10524.17 14999,-10388.8 14999,-10388.8 14999,-10388.8 14999,-7616.2 14999,-7364.08 14961,-7302.33 14961,-7050.2 14961,-7050.2 14961,-7050.2 14961,-5912.2 14961,-5821.69 14949.98,-5771.7 15023,-5718.2 15037.02,-5707.93 17507.94,-5713.48 17525,-5710.2 17555.48,-5704.35 17587.2,-5694.17 17616.47,-5682.91"/>
<polygon fill="black" stroke="black" points="17617.85,-5686.13 17625.88,-5679.22 17615.3,-5679.61 17617.85,-5686.13"/>
</g>
<!-- qkv2_6 -->
<g id="node1289" class="node">
<title>qkv2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10611,-9875.86 10405,-9875.86 10405,-9822.86 10611,-9822.86 10611,-9875.86"/>
<text text-anchor="middle" x="10508" y="-9860.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10508" y="-9845.66" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10508" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn1_6&#45;&gt;qkv2_6 -->
<g id="edge1800" class="edge">
<title>res_ffn1_6&#45;&gt;qkv2_6</title>
<path fill="none" stroke="black" d="M15280.65,-10540.39C15269.3,-10537.55 15258.01,-10534.86 15247,-10532.41 13551.74,-10155.37 13116.46,-10090.93 11389,-9912.23 11051.99,-9877.36 10960.73,-9922.03 10621.13,-9876.26"/>
<polygon fill="black" stroke="black" points="10621.39,-9872.77 10611.01,-9874.88 10620.44,-9879.7 10621.39,-9872.77"/>
</g>
<!-- res_attn2_6 -->
<g id="node1897" class="node">
<title>res_attn2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20036.26,-5679.2 19716.1,-5679.2 19633.74,-5573.2 19953.9,-5573.2 20036.26,-5679.2"/>
<text text-anchor="middle" x="19835" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19835" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19835" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn1_6&#45;&gt;res_attn2_6 -->
<g id="edge2603" class="edge">
<title>res_ffn1_6&#45;&gt;res_attn2_6</title>
<path fill="none" stroke="black" d="M15407.47,-10540.37C15375.94,-10501.7 15341,-10445.96 15341,-10388.8 15341,-10388.8 15341,-10388.8 15341,-9220.18 15341,-9071.22 15377.35,-9037.22 15393,-8889.08 15415.19,-8679.02 15419,-8625.75 15419,-8414.51 15419,-8414.51 15419,-8414.51 15419,-8233.03 15419,-7833.23 15455,-7734 15455,-7334.2 15455,-7334.2 15455,-7334.2 15455,-5912.2 15455,-5624.32 15788.49,-5762.14 16073,-5718.2 16170.51,-5703.15 19528.1,-5728.77 19625,-5710.2 19655.49,-5704.36 19687.2,-5694.19 19716.47,-5682.93"/>
<polygon fill="black" stroke="black" points="19717.85,-5686.15 19725.89,-5679.24 19715.3,-5679.64 19717.85,-5686.15"/>
</g>
<!-- qkv2_7 -->
<g id="node1290" class="node">
<title>qkv2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8796,-9786.12 8590,-9786.12 8590,-9733.12 8796,-9733.12 8796,-9786.12"/>
<text text-anchor="middle" x="8693" y="-9770.92" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8693" y="-9755.92" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8693" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn1_7&#45;&gt;qkv2_7 -->
<g id="edge1801" class="edge">
<title>res_ffn1_7&#45;&gt;qkv2_7</title>
<path fill="none" stroke="black" d="M14450.25,-10540.34C14435.73,-10537.16 14421.17,-10534.43 14407,-10532.41 14257.07,-10511.02 9098.65,-10552.36 8955,-10504.41 8746.46,-10434.8 8558,-10429.16 8558,-10209.32 8558,-10209.32 8558,-10209.32 8558,-9938.1 8558,-9877.56 8608.37,-9824.75 8647.58,-9792.83"/>
<polygon fill="black" stroke="black" points="8650.1,-9795.29 8655.75,-9786.33 8645.75,-9789.81 8650.1,-9795.29"/>
</g>
<!-- res_attn2_7 -->
<g id="node1898" class="node">
<title>res_attn2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18776.26,-5679.2 18456.1,-5679.2 18373.74,-5573.2 18693.9,-5573.2 18776.26,-5679.2"/>
<text text-anchor="middle" x="18575" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18575" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18575" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn1_7&#45;&gt;res_attn2_7 -->
<g id="edge2612" class="edge">
<title>res_ffn1_7&#45;&gt;res_attn2_7</title>
<path fill="none" stroke="black" d="M14743.06,-10549.33C14843.94,-10512.43 14974.24,-10458.46 15010,-10414.67 15149.09,-10244.33 15150,-10160 15150,-9940.1 15150,-9940.1 15150,-9940.1 15150,-9758.62 15150,-9639.85 15151,-9610.16 15151,-9491.4 15151,-9491.4 15151,-9491.4 15151,-5912.2 15151,-5783.17 15246.57,-5764.53 15367,-5718.2 15405.86,-5703.25 18324.11,-5718.05 18365,-5710.2 18395.49,-5704.36 18427.2,-5694.18 18456.47,-5682.92"/>
<polygon fill="black" stroke="black" points="18457.85,-5686.14 18465.89,-5679.23 18455.3,-5679.63 18457.85,-5686.14"/>
</g>
<!-- qkv2_8 -->
<g id="node1291" class="node">
<title>qkv2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9935,-9696.38 9729,-9696.38 9729,-9643.38 9935,-9643.38 9935,-9696.38"/>
<text text-anchor="middle" x="9832" y="-9681.18" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9832" y="-9666.18" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9832" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn1_8&#45;&gt;qkv2_8 -->
<g id="edge1802" class="edge">
<title>res_ffn1_8&#45;&gt;qkv2_8</title>
<path fill="none" stroke="black" d="M16127.86,-10540.37C16114.12,-10537.28 16100.38,-10534.56 16087,-10532.41 15936.81,-10508.23 15546.99,-10553.5 15403,-10504.41 15057.61,-10386.64 14733,-10394.75 14733,-10029.84 14733,-10029.84 14733,-10029.84 14733,-9848.36 14733,-9656.36 11470.91,-9738.55 11279,-9732.75 10985.69,-9723.88 10255.04,-9734.09 9945.68,-9696.82"/>
<polygon fill="black" stroke="black" points="9945.65,-9693.29 9935.3,-9695.53 9944.79,-9700.23 9945.65,-9693.29"/>
</g>
<!-- res_attn2_8 -->
<g id="node1899" class="node">
<title>res_attn2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20876.26,-5679.2 20556.1,-5679.2 20473.74,-5573.2 20793.9,-5573.2 20876.26,-5679.2"/>
<text text-anchor="middle" x="20675" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20675" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20675" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn1_8&#45;&gt;res_attn2_8 -->
<g id="edge2621" class="edge">
<title>res_ffn1_8&#45;&gt;res_attn2_8</title>
<path fill="none" stroke="black" d="M16233,-10540.18C16194.54,-10502.65 16153,-10448.33 16153,-10388.8 16153,-10388.8 16153,-10388.8 16153,-5912.2 16153,-5767.47 18606.38,-5723.93 18751,-5718.2 18798.57,-5716.32 20418.25,-5719.22 20465,-5710.2 20495.39,-5704.34 20527.01,-5694.2 20556.21,-5682.98"/>
<polygon fill="black" stroke="black" points="20557.57,-5686.21 20565.6,-5679.3 20555.02,-5679.69 20557.57,-5686.21"/>
</g>
<!-- qkv2_9 -->
<g id="node1292" class="node">
<title>qkv2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8778,-9606.64 8572,-9606.64 8572,-9553.64 8778,-9553.64 8778,-9606.64"/>
<text text-anchor="middle" x="8675" y="-9591.44" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8675" y="-9576.44" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8675" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn1_9&#45;&gt;qkv2_9 -->
<g id="edge1803" class="edge">
<title>res_ffn1_9&#45;&gt;qkv2_9</title>
<path fill="none" stroke="black" d="M14870.54,-10540.4C14855.92,-10537.19 14841.26,-10534.44 14827,-10532.41 14783.54,-10526.22 8539.99,-10532.19 8506,-10504.41 8465.37,-10471.19 8482,-10441.27 8482,-10388.8 8482,-10388.8 8482,-10388.8 8482,-9758.62 8482,-9689.73 8549.44,-9640.27 8604.59,-9611.34"/>
<polygon fill="black" stroke="black" points="8606.36,-9614.36 8613.67,-9606.7 8603.17,-9608.13 8606.36,-9614.36"/>
</g>
<!-- res_attn2_9 -->
<g id="node1900" class="node">
<title>res_attn2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19196.26,-5679.2 18876.1,-5679.2 18793.74,-5573.2 19113.9,-5573.2 19196.26,-5679.2"/>
<text text-anchor="middle" x="18995" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18995" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18995" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn1_9&#45;&gt;res_attn2_9 -->
<g id="edge2630" class="edge">
<title>res_ffn1_9&#45;&gt;res_attn2_9</title>
<path fill="none" stroke="black" d="M15059.28,-10540.28C15116.48,-10401.6 15264,-10010.92 15264,-9670.88 15264,-9670.88 15264,-9670.88 15264,-8143.29 15264,-8024.53 15265,-7994.84 15265,-7876.07 15265,-7876.07 15265,-7876.07 15265,-5912.2 15265,-5813.09 15289.41,-5768.2 15375,-5718.2 15395.45,-5706.26 18761.74,-5714.66 18785,-5710.2 18815.49,-5704.36 18847.2,-5694.19 18876.47,-5682.93"/>
<polygon fill="black" stroke="black" points="18877.85,-5686.15 18885.89,-5679.24 18875.3,-5679.63 18877.85,-5686.15"/>
</g>
<!-- qkv2_10 -->
<g id="node1293" class="node">
<title>qkv2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11861,-9516.9 11655,-9516.9 11655,-9463.9 11861,-9463.9 11861,-9516.9"/>
<text text-anchor="middle" x="11758" y="-9501.7" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11758" y="-9486.7" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11758" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn1_10&#45;&gt;qkv2_10 -->
<g id="edge1804" class="edge">
<title>res_ffn1_10&#45;&gt;qkv2_10</title>
<path fill="none" stroke="black" d="M18223.97,-10540.37C18211.52,-10537.43 18199.1,-10534.73 18187,-10532.41 17288.52,-10359.95 17036.23,-10503.76 16139,-10324.93 15596.39,-10216.78 15443.4,-10210.31 14947,-9965.97 14848.85,-9917.65 14849.14,-9861.67 14747,-9822.49 14205.06,-9614.58 12349.63,-9518.06 11871.25,-9496.28"/>
<polygon fill="black" stroke="black" points="11871.38,-9492.78 11861.23,-9495.82 11871.06,-9499.77 11871.38,-9492.78"/>
</g>
<!-- res_attn2_10 -->
<g id="node1901" class="node">
<title>res_attn2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22556.26,-5679.2 22236.1,-5679.2 22153.74,-5573.2 22473.9,-5573.2 22556.26,-5679.2"/>
<text text-anchor="middle" x="22355" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22355" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22355" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn1_10&#45;&gt;res_attn2_10 -->
<g id="edge2639" class="edge">
<title>res_ffn1_10&#45;&gt;res_attn2_10</title>
<path fill="none" stroke="black" d="M18556.07,-10591.52C19093.28,-10587.92 20837.77,-10571.24 21395,-10504.41 21640.42,-10474.97 21939,-10635.97 21939,-10388.8 21939,-10388.8 21939,-10388.8 21939,-5912.2 21939,-5840.57 22109.01,-5744.05 22231.66,-5683.74"/>
<polygon fill="black" stroke="black" points="22233.33,-5686.82 22240.78,-5679.28 22230.26,-5680.53 22233.33,-5686.82"/>
</g>
<!-- qkv2_11 -->
<g id="node1294" class="node">
<title>qkv2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8479,-9427.16 8273,-9427.16 8273,-9374.16 8479,-9374.16 8479,-9427.16"/>
<text text-anchor="middle" x="8376" y="-9411.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8376" y="-9396.96" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="8376" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn1_11&#45;&gt;qkv2_11 -->
<g id="edge1805" class="edge">
<title>res_ffn1_11&#45;&gt;qkv2_11</title>
<path fill="none" stroke="black" d="M17810.54,-10540.38C17795.92,-10537.17 17781.27,-10534.43 17767,-10532.41 17282.28,-10463.73 9440.33,-10568.58 8955,-10504.41 8756.68,-10478.18 8520,-10588.84 8520,-10388.8 8520,-10388.8 8520,-10388.8 8520,-10207.32 8520,-10083.84 8444,-10063.57 8444,-9940.1 8444,-9940.1 8444,-9940.1 8444,-9579.14 8444,-9526.58 8417.68,-9470.73 8397.79,-9436.02"/>
<polygon fill="black" stroke="black" points="8400.72,-9434.09 8392.63,-9427.24 8394.68,-9437.63 8400.72,-9434.09"/>
</g>
<!-- res_attn2_11 -->
<g id="node1902" class="node">
<title>res_attn2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22136.26,-5679.2 21816.1,-5679.2 21733.74,-5573.2 22053.9,-5573.2 22136.26,-5679.2"/>
<text text-anchor="middle" x="21935" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21935" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21935" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn1_11&#45;&gt;res_attn2_11 -->
<g id="edge2648" class="edge">
<title>res_ffn1_11&#45;&gt;res_attn2_11</title>
<path fill="none" stroke="black" d="M18103.84,-10550.6C18131,-10543.22 18159.73,-10536.57 18187,-10532.41 18432.67,-10494.86 19056.68,-10514.43 19305,-10504.41 19535.84,-10495.09 21381,-10619.82 21381,-10388.8 21381,-10388.8 21381,-10388.8 21381,-5912.2 21381,-5864.85 21640.29,-5748.9 21804.09,-5680.37"/>
<polygon fill="black" stroke="black" points="21805.88,-5683.42 21813.76,-5676.33 21803.19,-5676.96 21805.88,-5683.42"/>
</g>
<!-- qkv2_12 -->
<g id="node1295" class="node">
<title>qkv2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11418,-9337.42 11212,-9337.42 11212,-9284.42 11418,-9284.42 11418,-9337.42"/>
<text text-anchor="middle" x="11315" y="-9322.22" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11315" y="-9307.22" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11315" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn1_12&#45;&gt;qkv2_12 -->
<g id="edge1806" class="edge">
<title>res_ffn1_12&#45;&gt;qkv2_12</title>
<path fill="none" stroke="black" d="M17383.07,-10540.38C17370.91,-10537.46 17358.81,-10534.77 17347,-10532.41 16904.27,-10443.94 16777.73,-10517.01 16338,-10414.67 15873.6,-10306.58 15765.69,-10242.53 15327,-10055.71 15113.92,-9964.96 15077.23,-9905.44 14861,-9822.49 14720.69,-9768.66 14681.65,-9765.55 14535,-9732.75 14306.98,-9681.74 14248.22,-9676.63 14017,-9643.01 13446.86,-9560.09 12014.88,-9438.5 11428.33,-9337.94"/>
<polygon fill="black" stroke="black" points="11428.5,-9334.42 11418.05,-9336.17 11427.31,-9341.32 11428.5,-9334.42"/>
</g>
<!-- res_attn2_12 -->
<g id="node1903" class="node">
<title>res_attn2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21716.26,-5679.2 21396.1,-5679.2 21313.74,-5573.2 21633.9,-5573.2 21716.26,-5679.2"/>
<text text-anchor="middle" x="21515" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21515" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21515" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn1_12&#45;&gt;res_attn2_12 -->
<g id="edge2657" class="edge">
<title>res_ffn1_12&#45;&gt;res_attn2_12</title>
<path fill="none" stroke="black" d="M17684.55,-10551.31C17711.53,-10543.93 17740.01,-10537.1 17767,-10532.41 17934.57,-10503.25 19291,-10558.88 19291,-10388.8 19291,-10388.8 19291,-10388.8 19291,-5912.2 19291,-5687.3 21086.45,-5763.27 21305,-5710.2 21333.2,-5703.36 21362.65,-5693.53 21390.27,-5683.02"/>
<polygon fill="black" stroke="black" points="21391.89,-5686.15 21399.96,-5679.28 21389.37,-5679.62 21391.89,-5686.15"/>
</g>
<!-- qkv2_13 -->
<g id="node1296" class="node">
<title>qkv2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11871,-10761.91 11665,-10761.91 11665,-10708.91 11871,-10708.91 11871,-10761.91"/>
<text text-anchor="middle" x="11768" y="-10746.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11768" y="-10731.71" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11768" y="-10716.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn1_13&#45;&gt;qkv2_13 -->
<g id="edge1807" class="edge">
<title>res_ffn1_13&#45;&gt;qkv2_13</title>
<path fill="none" stroke="black" d="M15746.54,-10631.7C15720.41,-10637.75 15692.99,-10643.11 15667,-10646.41 15458.49,-10672.85 12089.32,-10637.47 11884,-10682.41 11863.06,-10686.99 11841.32,-10695.58 11822.39,-10704.47"/>
<polygon fill="black" stroke="black" points="11820.82,-10701.34 11813.34,-10708.85 11823.87,-10707.65 11820.82,-10701.34"/>
</g>
<!-- res_attn2_13 -->
<g id="node1904" class="node">
<title>res_attn2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19616.26,-5679.2 19296.1,-5679.2 19213.74,-5573.2 19533.9,-5573.2 19616.26,-5679.2"/>
<text text-anchor="middle" x="19415" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19415" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19415" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn1_13&#45;&gt;res_attn2_13 -->
<g id="edge2666" class="edge">
<title>res_ffn1_13&#45;&gt;res_attn2_13</title>
<path fill="none" stroke="black" d="M15709.09,-10540.38C15564.52,-10493.08 15379,-10425.28 15379,-10388.8 15379,-10388.8 15379,-10388.8 15379,-5912.2 15379,-5821.69 15367.95,-5771.66 15441,-5718.2 15451.55,-5710.48 19192.16,-5712.66 19205,-5710.2 19235.49,-5704.36 19267.2,-5694.2 19296.47,-5682.94"/>
<polygon fill="black" stroke="black" points="19297.85,-5686.15 19305.89,-5679.25 19295.3,-5679.64 19297.85,-5686.15"/>
</g>
<!-- qkv2_14 -->
<g id="node1297" class="node">
<title>qkv2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10643,-10619.91 10437,-10619.91 10437,-10566.91 10643,-10566.91 10643,-10619.91"/>
<text text-anchor="middle" x="10540" y="-10604.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10540" y="-10589.71" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10540" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn1_14&#45;&gt;qkv2_14 -->
<g id="edge1808" class="edge">
<title>res_ffn1_14&#45;&gt;qkv2_14</title>
<path fill="none" stroke="black" d="M17013.58,-10640.86C16982.81,-10650.61 16949.58,-10659.42 16918,-10664.41 16780.13,-10686.2 12032.54,-10668.07 11893,-10664.41 11432.8,-10652.34 10885.45,-10617.23 10653.19,-10601.36"/>
<polygon fill="black" stroke="black" points="10653.26,-10597.85 10643.04,-10600.66 10652.78,-10604.84 10653.26,-10597.85"/>
</g>
<!-- res_attn2_14 -->
<g id="node1905" class="node">
<title>res_attn2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21296.26,-5679.2 20976.1,-5679.2 20893.74,-5573.2 21213.9,-5573.2 21296.26,-5679.2"/>
<text text-anchor="middle" x="21095" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21095" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21095" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn1_14&#45;&gt;res_attn2_14 -->
<g id="edge2675" class="edge">
<title>res_ffn1_14&#45;&gt;res_attn2_14</title>
<path fill="none" stroke="black" d="M17266.11,-10553.18C17292.72,-10545.76 17320.67,-10538.43 17347,-10532.41 17529.04,-10490.74 18175,-10575.54 18175,-10388.8 18175,-10388.8 18175,-10388.8 18175,-5912.2 18175,-5627.59 19157.27,-5740.61 19441,-5718.2 19520.97,-5711.89 20806.23,-5725.43 20885,-5710.2 20915.39,-5704.33 20947.01,-5694.18 20976.21,-5682.96"/>
<polygon fill="black" stroke="black" points="20977.57,-5686.19 20985.6,-5679.28 20975.01,-5679.67 20977.57,-5686.19"/>
</g>
<!-- qkv2_15 -->
<g id="node1298" class="node">
<title>qkv2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9646,-10504.04 9440,-10504.04 9440,-10451.04 9646,-10451.04 9646,-10504.04"/>
<text text-anchor="middle" x="9543" y="-10488.84" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9543" y="-10473.84" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9543" y="-10458.84" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn1_15&#45;&gt;qkv2_15 -->
<g id="edge1809" class="edge">
<title>res_ffn1_15&#45;&gt;qkv2_15</title>
<path fill="none" stroke="black" d="M16550.24,-10540.38C16535.72,-10537.19 16521.17,-10534.45 16507,-10532.41 16330.2,-10506.95 10542.18,-10482.57 9656.27,-10478.99"/>
<polygon fill="black" stroke="black" points="9656.09,-10475.49 9646.07,-10478.95 9656.06,-10482.49 9656.09,-10475.49"/>
</g>
<!-- res_attn2_15 -->
<g id="node1906" class="node">
<title>res_attn2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20456.26,-5679.2 20136.1,-5679.2 20053.74,-5573.2 20373.9,-5573.2 20456.26,-5679.2"/>
<text text-anchor="middle" x="20255" y="-5637.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20255" y="-5622.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20255" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn1_15&#45;&gt;res_attn2_15 -->
<g id="edge2684" class="edge">
<title>res_ffn1_15&#45;&gt;res_attn2_15</title>
<path fill="none" stroke="black" d="M16537.08,-10540.39C16384.76,-10493.7 16191,-10426.83 16191,-10388.8 16191,-10388.8 16191,-10388.8 16191,-10117.58 16191,-9994.1 16115,-9973.83 16115,-9850.36 16115,-9850.36 16115,-9850.36 16115,-9579.14 16115,-9061.37 16086,-8932.28 16086,-8414.51 16086,-8414.51 16086,-8414.51 16086,-8322.77 16086,-8204.01 16084,-8174.32 16084,-8055.55 16084,-8055.55 16084,-8055.55 16084,-7874.07 16084,-7697.23 16079,-7653.05 16079,-7476.2 16079,-7476.2 16079,-7476.2 16079,-6764.2 16079,-6512.65 16077,-6449.76 16077,-6198.2 16077,-6198.2 16077,-6198.2 16077,-5912.2 16077,-5821.69 16065.95,-5771.66 16139,-5718.2 16149.94,-5710.19 20031.68,-5712.75 20045,-5710.2 20075.49,-5704.36 20107.2,-5694.2 20136.47,-5682.94"/>
<polygon fill="black" stroke="black" points="20137.85,-5686.16 20145.89,-5679.25 20135.3,-5679.64 20137.85,-5686.16"/>
</g>
<!-- ring_stage2_0_0 -->
<g id="node1299" class="node">
<title>ring_stage2_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-10324.56 10526.5,-10324.56 10526.5,-10271.56 10719.5,-10271.56 10719.5,-10324.56"/>
<text text-anchor="middle" x="10623" y="-10309.36" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="10623" y="-10294.36" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_0×V_0</text>
<text text-anchor="middle" x="10623" y="-10279.36" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv2_0&#45;&gt;ring_stage2_0_0 -->
<g id="edge1810" class="edge">
<title>qkv2_0&#45;&gt;ring_stage2_0_0</title>
<path fill="none" stroke="black" d="M11092.9,-10371.01C10990.31,-10355.3 10833.59,-10331.3 10729.74,-10315.4"/>
<polygon fill="black" stroke="black" points="10729.96,-10311.89 10719.55,-10313.84 10728.9,-10318.81 10729.96,-10311.89"/>
</g>
<!-- ring_stage2_0_1 -->
<g id="node1300" class="node">
<title>ring_stage2_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10937.5,-10234.82 10744.5,-10234.82 10744.5,-10181.82 10937.5,-10181.82 10937.5,-10234.82"/>
<text text-anchor="middle" x="10841" y="-10219.62" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="10841" y="-10204.62" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_1×V_1</text>
<text text-anchor="middle" x="10841" y="-10189.62" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv2_1&#45;&gt;ring_stage2_0_1 -->
<g id="edge1811" class="edge">
<title>qkv2_1&#45;&gt;ring_stage2_0_1</title>
<path fill="none" stroke="black" d="M11201.74,-10277.53C11126.22,-10263.25 11024.07,-10243.93 10947.74,-10229.5"/>
<polygon fill="black" stroke="black" points="10948.1,-10226.01 10937.63,-10227.59 10946.8,-10232.89 10948.1,-10226.01"/>
</g>
<!-- ring_stage2_0_2 -->
<g id="node1301" class="node">
<title>ring_stage2_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11255.5,-10145.08 11062.5,-10145.08 11062.5,-10092.08 11255.5,-10092.08 11255.5,-10145.08"/>
<text text-anchor="middle" x="11159" y="-10129.88" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="11159" y="-10114.88" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_2×V_2</text>
<text text-anchor="middle" x="11159" y="-10099.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv2_2&#45;&gt;ring_stage2_0_2 -->
<g id="edge1812" class="edge">
<title>qkv2_2&#45;&gt;ring_stage2_0_2</title>
<path fill="none" stroke="black" d="M11374.96,-10181.7C11338.24,-10171.14 11295.55,-10158.86 11257.86,-10148.02"/>
<polygon fill="black" stroke="black" points="11258.46,-10144.55 11247.89,-10145.15 11256.53,-10151.27 11258.46,-10144.55"/>
</g>
<!-- ring_stage2_0_3 -->
<g id="node1302" class="node">
<title>ring_stage2_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11473.5,-10055.34 11280.5,-10055.34 11280.5,-10002.34 11473.5,-10002.34 11473.5,-10055.34"/>
<text text-anchor="middle" x="11377" y="-10040.14" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="11377" y="-10025.14" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_3×V_3</text>
<text text-anchor="middle" x="11377" y="-10010.14" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv2_3&#45;&gt;ring_stage2_0_3 -->
<g id="edge1813" class="edge">
<title>qkv2_3&#45;&gt;ring_stage2_0_3</title>
<path fill="none" stroke="black" d="M11587.3,-10091.96C11551.54,-10081.4 11509.97,-10069.12 11473.27,-10058.28"/>
<polygon fill="black" stroke="black" points="11474.14,-10054.88 11463.55,-10055.41 11472.15,-10061.6 11474.14,-10054.88"/>
</g>
<!-- ring_stage2_0_4 -->
<g id="node1303" class="node">
<title>ring_stage2_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9265.5,-9965.6 9072.5,-9965.6 9072.5,-9912.6 9265.5,-9912.6 9265.5,-9965.6"/>
<text text-anchor="middle" x="9169" y="-9950.4" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="9169" y="-9935.4" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_4×V_4</text>
<text text-anchor="middle" x="9169" y="-9920.4" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv2_4&#45;&gt;ring_stage2_0_4 -->
<g id="edge1814" class="edge">
<title>qkv2_4&#45;&gt;ring_stage2_0_4</title>
<path fill="none" stroke="black" d="M9099.61,-10002.22C9109.88,-9993.02 9121.61,-9982.52 9132.47,-9972.8"/>
<polygon fill="black" stroke="black" points="9135.07,-9975.17 9140.19,-9965.89 9130.4,-9969.96 9135.07,-9975.17"/>
</g>
<!-- ring_stage2_0_5 -->
<g id="node1304" class="node">
<title>ring_stage2_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9047.5,-9875.86 8854.5,-9875.86 8854.5,-9822.86 9047.5,-9822.86 9047.5,-9875.86"/>
<text text-anchor="middle" x="8951" y="-9860.66" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8951" y="-9845.66" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_5×V_5</text>
<text text-anchor="middle" x="8951" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv2_5&#45;&gt;ring_stage2_0_5 -->
<g id="edge1815" class="edge">
<title>qkv2_5&#45;&gt;ring_stage2_0_5</title>
<path fill="none" stroke="black" d="M8793.81,-9912.48C8819.8,-9902.21 8849.9,-9890.32 8876.76,-9879.7"/>
<polygon fill="black" stroke="black" points="8878.1,-9882.93 8886.11,-9876 8875.52,-9876.42 8878.1,-9882.93"/>
</g>
<!-- ring_stage2_0_6 -->
<g id="node1305" class="node">
<title>ring_stage2_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9934.5,-9786.12 9741.5,-9786.12 9741.5,-9733.12 9934.5,-9733.12 9934.5,-9786.12"/>
<text text-anchor="middle" x="9838" y="-9770.92" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="9838" y="-9755.92" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_6×V_6</text>
<text text-anchor="middle" x="9838" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv2_6&#45;&gt;ring_stage2_0_6 -->
<g id="edge1816" class="edge">
<title>qkv2_6&#45;&gt;ring_stage2_0_6</title>
<path fill="none" stroke="black" d="M10404.97,-9823.96C10401.95,-9823.44 10398.96,-9822.94 10396,-9822.49 10200.05,-9792.22 10144.74,-9817.63 9944.58,-9786.45"/>
<polygon fill="black" stroke="black" points="9945.06,-9782.98 9934.63,-9784.87 9943.96,-9789.9 9945.06,-9782.98"/>
</g>
<!-- ring_stage2_0_7 -->
<g id="node1306" class="node">
<title>ring_stage2_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9063.5,-9696.38 8870.5,-9696.38 8870.5,-9643.38 9063.5,-9643.38 9063.5,-9696.38"/>
<text text-anchor="middle" x="8967" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8967" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_7×V_7</text>
<text text-anchor="middle" x="8967" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv2_7&#45;&gt;ring_stage2_0_7 -->
<g id="edge1817" class="edge">
<title>qkv2_7&#45;&gt;ring_stage2_0_7</title>
<path fill="none" stroke="black" d="M8772.99,-9733C8805.62,-9722.55 8843.51,-9710.42 8877.1,-9699.66"/>
<polygon fill="black" stroke="black" points="8878.46,-9702.9 8886.91,-9696.52 8876.32,-9696.24 8878.46,-9702.9"/>
</g>
<!-- ring_stage2_0_8 -->
<g id="node1307" class="node">
<title>ring_stage2_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9057.5,-9606.64 8864.5,-9606.64 8864.5,-9553.64 9057.5,-9553.64 9057.5,-9606.64"/>
<text text-anchor="middle" x="8961" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8961" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_8×V_8</text>
<text text-anchor="middle" x="8961" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv2_8&#45;&gt;ring_stage2_0_8 -->
<g id="edge1818" class="edge">
<title>qkv2_8&#45;&gt;ring_stage2_0_8</title>
<path fill="none" stroke="black" d="M9728.99,-9644.38C9725.96,-9643.89 9722.96,-9643.43 9720,-9643.01 9435.46,-9602.61 9356.29,-9648.59 9067.54,-9606.95"/>
<polygon fill="black" stroke="black" points="9068.02,-9603.48 9057.62,-9605.49 9067,-9610.41 9068.02,-9603.48"/>
</g>
<!-- ring_stage2_0_9 -->
<g id="node1308" class="node">
<title>ring_stage2_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8771.5,-9516.9 8578.5,-9516.9 8578.5,-9463.9 8771.5,-9463.9 8771.5,-9516.9"/>
<text text-anchor="middle" x="8675" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8675" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_9×V_9</text>
<text text-anchor="middle" x="8675" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv2_9&#45;&gt;ring_stage2_0_9 -->
<g id="edge1819" class="edge">
<title>qkv2_9&#45;&gt;ring_stage2_0_9</title>
<path fill="none" stroke="black" d="M8675,-9553.29C8675,-9545.07 8675,-9535.84 8675,-9527.07"/>
<polygon fill="black" stroke="black" points="8678.5,-9527.06 8675,-9517.06 8671.5,-9527.06 8678.5,-9527.06"/>
</g>
<!-- ring_stage2_0_10 -->
<g id="node1309" class="node">
<title>ring_stage2_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8955,-9427.16 8735,-9427.16 8735,-9374.16 8955,-9374.16 8955,-9427.16"/>
<text text-anchor="middle" x="8845" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8845" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_10×V_10</text>
<text text-anchor="middle" x="8845" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv2_10&#45;&gt;ring_stage2_0_10 -->
<g id="edge1820" class="edge">
<title>qkv2_10&#45;&gt;ring_stage2_0_10</title>
<path fill="none" stroke="black" d="M11654.73,-9466.04C11648.41,-9465.06 11642.13,-9464.21 11636,-9463.53 11046.06,-9397.64 9554.83,-9494.41 8965,-9427.53 8964.9,-9427.51 8964.79,-9427.5 8964.69,-9427.49"/>
<polygon fill="black" stroke="black" points="8965.4,-9424.05 8955.04,-9426.27 8964.52,-9431 8965.4,-9424.05"/>
</g>
<!-- ring_stage2_0_11 -->
<g id="node1310" class="node">
<title>ring_stage2_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8486,-9337.42 8266,-9337.42 8266,-9284.42 8486,-9284.42 8486,-9337.42"/>
<text text-anchor="middle" x="8376" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8376" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_11×V_11</text>
<text text-anchor="middle" x="8376" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv2_11&#45;&gt;ring_stage2_0_11 -->
<g id="edge1821" class="edge">
<title>qkv2_11&#45;&gt;ring_stage2_0_11</title>
<path fill="none" stroke="black" d="M8376,-9373.81C8376,-9365.59 8376,-9356.36 8376,-9347.59"/>
<polygon fill="black" stroke="black" points="8379.5,-9347.58 8376,-9337.58 8372.5,-9347.58 8379.5,-9347.58"/>
</g>
<!-- ring_stage2_0_12 -->
<g id="node1311" class="node">
<title>ring_stage2_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8970,-9247.68 8750,-9247.68 8750,-9194.68 8970,-9194.68 8970,-9247.68"/>
<text text-anchor="middle" x="8860" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="8860" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_12×V_12</text>
<text text-anchor="middle" x="8860" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv2_12&#45;&gt;ring_stage2_0_12 -->
<g id="edge1822" class="edge">
<title>qkv2_12&#45;&gt;ring_stage2_0_12</title>
<path fill="none" stroke="black" d="M11211.71,-9285.22C11208.78,-9284.79 11205.87,-9284.4 11203,-9284.05 10715.6,-9224.49 9486.36,-9303.77 8980.07,-9248.04"/>
<polygon fill="black" stroke="black" points="8980.42,-9244.55 8970.09,-9246.91 8979.63,-9251.51 8980.42,-9244.55"/>
</g>
<!-- ring_stage2_0_13 -->
<g id="node1312" class="node">
<title>ring_stage2_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9184,-10619.91 8964,-10619.91 8964,-10566.91 9184,-10566.91 9184,-10619.91"/>
<text text-anchor="middle" x="9074" y="-10604.71" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="9074" y="-10589.71" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_13×V_13</text>
<text text-anchor="middle" x="9074" y="-10574.71" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv2_13&#45;&gt;ring_stage2_0_13 -->
<g id="edge1823" class="edge">
<title>qkv2_13&#45;&gt;ring_stage2_0_13</title>
<path fill="none" stroke="black" d="M11723.74,-10708.8C11703.73,-10698.57 11679.37,-10687.93 11656,-10682.41 11523.15,-10651.02 10564.42,-10651.03 10428,-10646.41 9972.49,-10630.98 9430.92,-10609.12 9194.46,-10599.4"/>
<polygon fill="black" stroke="black" points="9194.25,-10595.89 9184.12,-10598.98 9193.97,-10602.88 9194.25,-10595.89"/>
</g>
<!-- ring_stage2_0_14 -->
<g id="node1313" class="node">
<title>ring_stage2_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9422,-10504.04 9202,-10504.04 9202,-10451.04 9422,-10451.04 9422,-10504.04"/>
<text text-anchor="middle" x="9312" y="-10488.84" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="9312" y="-10473.84" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_14×V_14</text>
<text text-anchor="middle" x="9312" y="-10458.84" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv2_14&#45;&gt;ring_stage2_0_14 -->
<g id="edge1824" class="edge">
<title>qkv2_14&#45;&gt;ring_stage2_0_14</title>
<path fill="none" stroke="black" d="M10436.66,-10588.86C10241.69,-10581.15 9806.31,-10559.08 9432.06,-10504.48"/>
<polygon fill="black" stroke="black" points="9432.52,-10501.01 9422.12,-10503.02 9431.51,-10507.94 9432.52,-10501.01"/>
</g>
<!-- ring_stage2_0_15 -->
<g id="node1314" class="node">
<title>ring_stage2_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9660,-10414.3 9440,-10414.3 9440,-10361.3 9660,-10361.3 9660,-10414.3"/>
<text text-anchor="middle" x="9550" y="-10399.1" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="9550" y="-10384.1" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_15×V_15</text>
<text text-anchor="middle" x="9550" y="-10369.1" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv2_15&#45;&gt;ring_stage2_0_15 -->
<g id="edge1825" class="edge">
<title>qkv2_15&#45;&gt;ring_stage2_0_15</title>
<path fill="none" stroke="black" d="M9545.06,-10450.69C9545.72,-10442.48 9546.45,-10433.24 9547.15,-10424.47"/>
<polygon fill="black" stroke="black" points="9550.65,-10424.71 9547.95,-10414.46 9543.67,-10424.15 9550.65,-10424.71"/>
</g>
<!-- kv_send2_0_0 -->
<g id="node1315" class="node">
<title>kv_send2_0_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10623" cy="-10208.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10623" y="-10212.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="10623" y="-10197.12" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_0_0&#45;&gt;kv_send2_0_0 -->
<g id="edge1826" class="edge">
<title>ring_stage2_0_0&#45;&gt;kv_send2_0_0</title>
<path fill="none" stroke="black" d="M10623,-10271.21C10623,-10263.16 10623,-10254.13 10623,-10245.51"/>
<polygon fill="black" stroke="black" points="10626.5,-10245.29 10623,-10235.29 10619.5,-10245.29 10626.5,-10245.29"/>
</g>
<!-- ring_stage2_1_0 -->
<g id="node1331" class="node">
<title>ring_stage2_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10043.5,-10234.82 9832.5,-10234.82 9832.5,-10181.82 10043.5,-10181.82 10043.5,-10234.82"/>
<text text-anchor="middle" x="9938" y="-10219.62" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9938" y="-10204.62" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_15×V_15</text>
<text text-anchor="middle" x="9938" y="-10189.62" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_0_0&#45;&gt;ring_stage2_1_0 -->
<g id="edge1842" class="edge">
<title>ring_stage2_0_0&#45;&gt;ring_stage2_1_0</title>
<path fill="none" stroke="black" d="M10526.31,-10284.67C10402.13,-10268.77 10186.82,-10241.19 10053.97,-10224.17"/>
<polygon fill="black" stroke="black" points="10054.12,-10220.66 10043.76,-10222.86 10053.23,-10227.6 10054.12,-10220.66"/>
</g>
<!-- kv_send2_0_1 -->
<g id="node1316" class="node">
<title>kv_send2_0_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10841" cy="-10118.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10841" y="-10122.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="10841" y="-10107.38" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_0_1&#45;&gt;kv_send2_0_1 -->
<g id="edge1827" class="edge">
<title>ring_stage2_0_1&#45;&gt;kv_send2_0_1</title>
<path fill="none" stroke="black" d="M10841,-10181.47C10841,-10173.42 10841,-10164.39 10841,-10155.77"/>
<polygon fill="black" stroke="black" points="10844.5,-10155.55 10841,-10145.55 10837.5,-10155.55 10844.5,-10155.55"/>
</g>
<!-- ring_stage2_1_1 -->
<g id="node1332" class="node">
<title>ring_stage2_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-10145.08 10526.5,-10145.08 10526.5,-10092.08 10719.5,-10092.08 10719.5,-10145.08"/>
<text text-anchor="middle" x="10623" y="-10129.88" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="10623" y="-10114.88" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_0×V_0</text>
<text text-anchor="middle" x="10623" y="-10099.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_0_1&#45;&gt;ring_stage2_1_1 -->
<g id="edge1845" class="edge">
<title>ring_stage2_0_1&#45;&gt;ring_stage2_1_1</title>
<path fill="none" stroke="black" d="M10777.36,-10181.7C10751.95,-10171.48 10722.54,-10159.64 10696.25,-10149.06"/>
<polygon fill="black" stroke="black" points="10697.3,-10145.71 10686.72,-10145.22 10694.69,-10152.2 10697.3,-10145.71"/>
</g>
<!-- kv_send2_0_2 -->
<g id="node1317" class="node">
<title>kv_send2_0_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11159" cy="-10028.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11159" y="-10032.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="11159" y="-10017.64" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_0_2&#45;&gt;kv_send2_0_2 -->
<g id="edge1828" class="edge">
<title>ring_stage2_0_2&#45;&gt;kv_send2_0_2</title>
<path fill="none" stroke="black" d="M11159,-10091.73C11159,-10083.68 11159,-10074.65 11159,-10066.03"/>
<polygon fill="black" stroke="black" points="11162.5,-10065.81 11159,-10055.81 11155.5,-10065.81 11162.5,-10065.81"/>
</g>
<!-- ring_stage2_1_2 -->
<g id="node1333" class="node">
<title>ring_stage2_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10937.5,-10055.34 10744.5,-10055.34 10744.5,-10002.34 10937.5,-10002.34 10937.5,-10055.34"/>
<text text-anchor="middle" x="10841" y="-10040.14" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="10841" y="-10025.14" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_1×V_1</text>
<text text-anchor="middle" x="10841" y="-10010.14" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_0_2&#45;&gt;ring_stage2_1_2 -->
<g id="edge1848" class="edge">
<title>ring_stage2_0_2&#45;&gt;ring_stage2_1_2</title>
<path fill="none" stroke="black" d="M11066.17,-10091.96C11027.64,-10081.33 10982.8,-10068.96 10943.32,-10058.07"/>
<polygon fill="black" stroke="black" points="10944.24,-10054.69 10933.67,-10055.41 10942.38,-10061.44 10944.24,-10054.69"/>
</g>
<!-- kv_send2_0_3 -->
<g id="node1318" class="node">
<title>kv_send2_0_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11065" cy="-9939.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11065" y="-9942.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="11065" y="-9927.9" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_0_3&#45;&gt;kv_send2_0_3 -->
<g id="edge1829" class="edge">
<title>ring_stage2_0_3&#45;&gt;kv_send2_0_3</title>
<path fill="none" stroke="black" d="M11285.92,-10002.22C11240.6,-9989.48 11186.39,-9974.23 11143.01,-9962.03"/>
<polygon fill="black" stroke="black" points="11143.94,-9958.66 11133.36,-9959.32 11142.04,-9965.4 11143.94,-9958.66"/>
</g>
<!-- ring_stage2_1_3 -->
<g id="node1334" class="node">
<title>ring_stage2_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11379.5,-9965.6 11186.5,-9965.6 11186.5,-9912.6 11379.5,-9912.6 11379.5,-9965.6"/>
<text text-anchor="middle" x="11283" y="-9950.4" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="11283" y="-9935.4" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_2×V_2</text>
<text text-anchor="middle" x="11283" y="-9920.4" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_0_3&#45;&gt;ring_stage2_1_3 -->
<g id="edge1851" class="edge">
<title>ring_stage2_0_3&#45;&gt;ring_stage2_1_3</title>
<path fill="none" stroke="black" d="M11349.56,-10002.22C11339.7,-9993.02 11328.45,-9982.52 11318.04,-9972.8"/>
<polygon fill="black" stroke="black" points="11320.34,-9970.16 11310.64,-9965.89 11315.56,-9975.28 11320.34,-9970.16"/>
</g>
<!-- kv_send2_0_4 -->
<g id="node1319" class="node">
<title>kv_send2_0_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9169" cy="-9849.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9169" y="-9853.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9169" y="-9838.16" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_0_4&#45;&gt;kv_send2_0_4 -->
<g id="edge1830" class="edge">
<title>ring_stage2_0_4&#45;&gt;kv_send2_0_4</title>
<path fill="none" stroke="black" d="M9169,-9912.25C9169,-9904.2 9169,-9895.17 9169,-9886.54"/>
<polygon fill="black" stroke="black" points="9172.5,-9886.32 9169,-9876.32 9165.5,-9886.32 9172.5,-9886.32"/>
</g>
<!-- ring_stage2_1_4 -->
<g id="node1335" class="node">
<title>ring_stage2_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10081.5,-9875.86 9888.5,-9875.86 9888.5,-9822.86 10081.5,-9822.86 10081.5,-9875.86"/>
<text text-anchor="middle" x="9985" y="-9860.66" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9985" y="-9845.66" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_3×V_3</text>
<text text-anchor="middle" x="9985" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_0_4&#45;&gt;ring_stage2_1_4 -->
<g id="edge1854" class="edge">
<title>ring_stage2_0_4&#45;&gt;ring_stage2_1_4</title>
<path fill="none" stroke="black" d="M9265.74,-9917.91C9278.24,-9915.74 9290.9,-9913.77 9303,-9912.23 9553.47,-9880.23 9620.05,-9912.05 9870,-9876.23 9872.71,-9875.84 9875.45,-9875.42 9878.21,-9874.98"/>
<polygon fill="black" stroke="black" points="9878.99,-9878.39 9888.26,-9873.26 9877.82,-9871.49 9878.99,-9878.39"/>
</g>
<!-- kv_send2_0_5 -->
<g id="node1320" class="node">
<title>kv_send2_0_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9169" cy="-9759.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9169" y="-9763.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="9169" y="-9748.42" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_0_5&#45;&gt;kv_send2_0_5 -->
<g id="edge1831" class="edge">
<title>ring_stage2_0_5&#45;&gt;kv_send2_0_5</title>
<path fill="none" stroke="black" d="M9014.64,-9822.74C9043.09,-9811.29 9076.57,-9797.82 9105.06,-9786.35"/>
<polygon fill="black" stroke="black" points="9106.54,-9789.53 9114.51,-9782.55 9103.93,-9783.03 9106.54,-9789.53"/>
</g>
<!-- ring_stage2_1_5 -->
<g id="node1336" class="node">
<title>ring_stage2_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9047.5,-9786.12 8854.5,-9786.12 8854.5,-9733.12 9047.5,-9733.12 9047.5,-9786.12"/>
<text text-anchor="middle" x="8951" y="-9770.92" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="8951" y="-9755.92" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_4×V_4</text>
<text text-anchor="middle" x="8951" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_0_5&#45;&gt;ring_stage2_1_5 -->
<g id="edge1857" class="edge">
<title>ring_stage2_0_5&#45;&gt;ring_stage2_1_5</title>
<path fill="none" stroke="black" d="M8951,-9822.51C8951,-9814.29 8951,-9805.06 8951,-9796.29"/>
<polygon fill="black" stroke="black" points="8954.5,-9796.28 8951,-9786.28 8947.5,-9796.28 8954.5,-9796.28"/>
</g>
<!-- kv_send2_0_6 -->
<g id="node1321" class="node">
<title>kv_send2_0_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10056" cy="-9669.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10056" y="-9673.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10056" y="-9658.68" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_0_6&#45;&gt;kv_send2_0_6 -->
<g id="edge1832" class="edge">
<title>ring_stage2_0_6&#45;&gt;kv_send2_0_6</title>
<path fill="none" stroke="black" d="M9901.64,-9733C9930.09,-9721.55 9963.57,-9708.08 9992.06,-9696.61"/>
<polygon fill="black" stroke="black" points="9993.54,-9699.79 10001.51,-9692.81 9990.93,-9693.29 9993.54,-9699.79"/>
</g>
<!-- ring_stage2_1_6 -->
<g id="node1337" class="node">
<title>ring_stage2_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9710.5,-9696.38 9517.5,-9696.38 9517.5,-9643.38 9710.5,-9643.38 9710.5,-9696.38"/>
<text text-anchor="middle" x="9614" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9614" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_5×V_5</text>
<text text-anchor="middle" x="9614" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_0_6&#45;&gt;ring_stage2_1_6 -->
<g id="edge1860" class="edge">
<title>ring_stage2_0_6&#45;&gt;ring_stage2_1_6</title>
<path fill="none" stroke="black" d="M9772.61,-9733C9746.39,-9722.73 9716.02,-9710.84 9688.91,-9700.22"/>
<polygon fill="black" stroke="black" points="9690.06,-9696.91 9679.47,-9696.52 9687.51,-9703.43 9690.06,-9696.91"/>
</g>
<!-- kv_send2_0_7 -->
<g id="node1322" class="node">
<title>kv_send2_0_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9179" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9179" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="9179" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_0_7&#45;&gt;kv_send2_0_7 -->
<g id="edge1833" class="edge">
<title>ring_stage2_0_7&#45;&gt;kv_send2_0_7</title>
<path fill="none" stroke="black" d="M9028.89,-9643.26C9056.33,-9631.9 9088.57,-9618.56 9116.13,-9607.16"/>
<polygon fill="black" stroke="black" points="9117.76,-9610.27 9125.66,-9603.21 9115.08,-9603.8 9117.76,-9610.27"/>
</g>
<!-- ring_stage2_1_7 -->
<g id="node1338" class="node">
<title>ring_stage2_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9717.5,-9606.64 9524.5,-9606.64 9524.5,-9553.64 9717.5,-9553.64 9717.5,-9606.64"/>
<text text-anchor="middle" x="9621" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9621" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_6×V_6</text>
<text text-anchor="middle" x="9621" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_0_7&#45;&gt;ring_stage2_1_7 -->
<g id="edge1863" class="edge">
<title>ring_stage2_0_7&#45;&gt;ring_stage2_1_7</title>
<path fill="none" stroke="black" d="M9063.63,-9644.62C9066.79,-9644.05 9069.91,-9643.5 9073,-9643.01 9264.34,-9612.06 9318.64,-9637.59 9514.33,-9606.99"/>
<polygon fill="black" stroke="black" points="9515.04,-9610.42 9524.37,-9605.39 9513.94,-9603.5 9515.04,-9610.42"/>
</g>
<!-- kv_send2_0_8 -->
<g id="node1323" class="node">
<title>kv_send2_0_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8988" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8988" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="8988" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_0_8&#45;&gt;kv_send2_0_8 -->
<g id="edge1834" class="edge">
<title>ring_stage2_0_8&#45;&gt;kv_send2_0_8</title>
<path fill="none" stroke="black" d="M8968.95,-9553.29C8971.49,-9545.06 8974.33,-9535.81 8977.04,-9527.02"/>
<polygon fill="black" stroke="black" points="8980.41,-9527.95 8980.01,-9517.36 8973.72,-9525.89 8980.41,-9527.95"/>
</g>
<!-- ring_stage2_1_8 -->
<g id="node1339" class="node">
<title>ring_stage2_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9357.5,-9516.9 9164.5,-9516.9 9164.5,-9463.9 9357.5,-9463.9 9357.5,-9516.9"/>
<text text-anchor="middle" x="9261" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9261" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_7×V_7</text>
<text text-anchor="middle" x="9261" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_0_8&#45;&gt;ring_stage2_1_8 -->
<g id="edge1866" class="edge">
<title>ring_stage2_0_8&#45;&gt;ring_stage2_1_8</title>
<path fill="none" stroke="black" d="M9048.58,-9553.52C9084.7,-9542.96 9126.69,-9530.68 9163.76,-9519.84"/>
<polygon fill="black" stroke="black" points="9164.96,-9523.13 9173.57,-9516.97 9162.99,-9516.41 9164.96,-9523.13"/>
</g>
<!-- kv_send2_0_9 -->
<g id="node1324" class="node">
<title>kv_send2_0_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8607" cy="-9400.66" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8607" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="8607" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_0_9&#45;&gt;kv_send2_0_9 -->
<g id="edge1835" class="edge">
<title>ring_stage2_0_9&#45;&gt;kv_send2_0_9</title>
<path fill="none" stroke="black" d="M8654.97,-9463.55C8648.12,-9454.71 8640.35,-9444.69 8633.1,-9435.33"/>
<polygon fill="black" stroke="black" points="8635.78,-9433.08 8626.89,-9427.32 8630.25,-9437.37 8635.78,-9433.08"/>
</g>
<!-- ring_stage2_1_9 -->
<g id="node1340" class="node">
<title>ring_stage2_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9166.5,-9427.16 8973.5,-9427.16 8973.5,-9374.16 9166.5,-9374.16 9166.5,-9427.16"/>
<text text-anchor="middle" x="9070" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9070" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_8×V_8</text>
<text text-anchor="middle" x="9070" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_0_9&#45;&gt;ring_stage2_1_9 -->
<g id="edge1869" class="edge">
<title>ring_stage2_0_9&#45;&gt;ring_stage2_1_9</title>
<path fill="none" stroke="black" d="M8771.81,-9469.39C8825.49,-9458.12 8893.66,-9443.54 8963.41,-9427.64"/>
<polygon fill="black" stroke="black" points="8964.3,-9431.03 8973.26,-9425.38 8962.74,-9424.2 8964.3,-9431.03"/>
</g>
<!-- kv_send2_0_10 -->
<g id="node1325" class="node">
<title>kv_send2_0_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8834" cy="-9310.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8834" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="8834" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_0_10&#45;&gt;kv_send2_0_10 -->
<g id="edge1836" class="edge">
<title>ring_stage2_0_10&#45;&gt;kv_send2_0_10</title>
<path fill="none" stroke="black" d="M8841.76,-9373.81C8840.74,-9365.67 8839.59,-9356.53 8838.5,-9347.82"/>
<polygon fill="black" stroke="black" points="8841.97,-9347.37 8837.26,-9337.88 8835.03,-9348.24 8841.97,-9347.37"/>
</g>
<!-- ring_stage2_1_10 -->
<g id="node1341" class="node">
<title>ring_stage2_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8706,-9337.42 8504,-9337.42 8504,-9284.42 8706,-9284.42 8706,-9337.42"/>
<text text-anchor="middle" x="8605" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="8605" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_9×V_9</text>
<text text-anchor="middle" x="8605" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_0_10&#45;&gt;ring_stage2_1_10 -->
<g id="edge1872" class="edge">
<title>ring_stage2_0_10&#45;&gt;ring_stage2_1_10</title>
<path fill="none" stroke="black" d="M8774.94,-9374.04C8746.72,-9363.73 8714.02,-9351.77 8684.88,-9341.12"/>
<polygon fill="black" stroke="black" points="8685.74,-9337.71 8675.15,-9337.56 8683.34,-9344.28 8685.74,-9337.71"/>
</g>
<!-- kv_send2_0_11 -->
<g id="node1326" class="node">
<title>kv_send2_0_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8622" cy="-9221.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8622" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="8622" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_0_11&#45;&gt;kv_send2_0_11 -->
<g id="edge1837" class="edge">
<title>ring_stage2_0_11&#45;&gt;kv_send2_0_11</title>
<path fill="none" stroke="black" d="M8447.81,-9284.3C8480.73,-9272.56 8519.59,-9258.7 8552.25,-9247.05"/>
<polygon fill="black" stroke="black" points="8553.49,-9250.33 8561.73,-9243.67 8551.14,-9243.73 8553.49,-9250.33"/>
</g>
<!-- ring_stage2_1_11 -->
<g id="node1342" class="node">
<title>ring_stage2_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8494,-9247.68 8274,-9247.68 8274,-9194.68 8494,-9194.68 8494,-9247.68"/>
<text text-anchor="middle" x="8384" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="8384" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_10×V_10</text>
<text text-anchor="middle" x="8384" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_0_11&#45;&gt;ring_stage2_1_11 -->
<g id="edge1875" class="edge">
<title>ring_stage2_0_11&#45;&gt;ring_stage2_1_11</title>
<path fill="none" stroke="black" d="M8378.36,-9284.06C8379.11,-9275.85 8379.95,-9266.62 8380.75,-9257.85"/>
<polygon fill="black" stroke="black" points="8384.24,-9258.12 8381.66,-9247.84 8377.27,-9257.48 8384.24,-9258.12"/>
</g>
<!-- kv_send2_0_12 -->
<g id="node1327" class="node">
<title>kv_send2_0_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8366" cy="-9131.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8366" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="8366" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_0_12&#45;&gt;kv_send2_0_12 -->
<g id="edge1838" class="edge">
<title>ring_stage2_0_12&#45;&gt;kv_send2_0_12</title>
<path fill="none" stroke="black" d="M8749.84,-9195.92C8746.86,-9195.37 8743.91,-9194.83 8741,-9194.31 8627.46,-9174.04 8597.53,-9178.67 8484,-9158.31 8474.25,-9156.56 8464.07,-9154.57 8453.97,-9152.5"/>
<polygon fill="black" stroke="black" points="8454.41,-9149.01 8443.9,-9150.4 8452.98,-9155.87 8454.41,-9149.01"/>
</g>
<!-- ring_stage2_1_12 -->
<g id="node1343" class="node">
<title>ring_stage2_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8951,-9157.94 8731,-9157.94 8731,-9104.94 8951,-9104.94 8951,-9157.94"/>
<text text-anchor="middle" x="8841" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="8841" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_11×V_11</text>
<text text-anchor="middle" x="8841" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_0_12&#45;&gt;ring_stage2_1_12 -->
<g id="edge1878" class="edge">
<title>ring_stage2_0_12&#45;&gt;ring_stage2_1_12</title>
<path fill="none" stroke="black" d="M8854.4,-9194.32C8852.62,-9186.11 8850.63,-9176.88 8848.72,-9168.11"/>
<polygon fill="black" stroke="black" points="8852.1,-9167.13 8846.56,-9158.1 8845.25,-9168.61 8852.1,-9167.13"/>
</g>
<!-- kv_send2_0_13 -->
<g id="node1328" class="node">
<title>kv_send2_0_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9074" cy="-10477.54" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9074" y="-10481.34" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9074" y="-10466.34" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_0_13&#45;&gt;kv_send2_0_13 -->
<g id="edge1839" class="edge">
<title>ring_stage2_0_13&#45;&gt;kv_send2_0_13</title>
<path fill="none" stroke="black" d="M9074,-10566.85C9074,-10551.54 9074,-10531.82 9074,-10514.9"/>
<polygon fill="black" stroke="black" points="9077.5,-10514.8 9074,-10504.8 9070.5,-10514.8 9077.5,-10514.8"/>
</g>
<!-- ring_stage2_1_13 -->
<g id="node1344" class="node">
<title>ring_stage2_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8236,-9068.2 8016,-9068.2 8016,-9015.2 8236,-9015.2 8236,-9068.2"/>
<text text-anchor="middle" x="8126" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="8126" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_12×V_12</text>
<text text-anchor="middle" x="8126" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_0_13&#45;&gt;ring_stage2_1_13 -->
<g id="edge1881" class="edge">
<title>ring_stage2_0_13&#45;&gt;ring_stage2_1_13</title>
<path fill="none" stroke="black" d="M9018.25,-10566.79C8957.55,-10534.6 8869,-10473.19 8869,-10388.8 8869,-10388.8 8869,-10388.8 8869,-10297.06 8869,-10263.31 8821.36,-10025.33 8797,-10001.97 8738.11,-9945.5 8673.97,-10024.37 8617,-9965.97 8571.8,-9919.63 8607.04,-9885.44 8592,-9822.49 8588.11,-9806.21 8585.05,-9802.72 8581,-9786.49 8563.29,-9715.54 8571.03,-9513.87 8518,-9463.53 8435.31,-9385.02 8358.02,-9492.02 8264,-9427.53 8241.44,-9412.05 8250.39,-9395.69 8234,-9373.79 8200.53,-9329.06 8193.78,-9312.98 8146,-9284.05 8098.73,-9255.42 8059.93,-9292.41 8027,-9248.05 7988.99,-9196.84 7996.09,-9160.34 8027,-9104.57 8033.76,-9092.37 8044.04,-9082.26 8055.45,-9074"/>
<polygon fill="black" stroke="black" points="8057.58,-9076.78 8063.93,-9068.3 8053.68,-9070.97 8057.58,-9076.78"/>
</g>
<!-- kv_send2_0_14 -->
<g id="node1329" class="node">
<title>kv_send2_0_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9312" cy="-10387.8" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9312" y="-10391.6" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9312" y="-10376.6" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_0_14&#45;&gt;kv_send2_0_14 -->
<g id="edge1840" class="edge">
<title>ring_stage2_0_14&#45;&gt;kv_send2_0_14</title>
<path fill="none" stroke="black" d="M9312,-10450.69C9312,-10442.64 9312,-10433.61 9312,-10424.99"/>
<polygon fill="black" stroke="black" points="9315.5,-10424.77 9312,-10414.77 9308.5,-10424.77 9315.5,-10424.77"/>
</g>
<!-- ring_stage2_1_14 -->
<g id="node1345" class="node">
<title>ring_stage2_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9184,-10414.3 8964,-10414.3 8964,-10361.3 9184,-10361.3 9184,-10414.3"/>
<text text-anchor="middle" x="9074" y="-10399.1" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9074" y="-10384.1" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_13×V_13</text>
<text text-anchor="middle" x="9074" y="-10369.1" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_0_14&#45;&gt;ring_stage2_1_14 -->
<g id="edge1884" class="edge">
<title>ring_stage2_0_14&#45;&gt;ring_stage2_1_14</title>
<path fill="none" stroke="black" d="M9242.52,-10450.92C9214.54,-10440.61 9182.11,-10428.65 9153.22,-10418"/>
<polygon fill="black" stroke="black" points="9154.16,-10414.62 9143.57,-10414.44 9151.74,-10421.19 9154.16,-10414.62"/>
</g>
<!-- kv_send2_0_15 -->
<g id="node1330" class="node">
<title>kv_send2_0_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9909" cy="-10298.06" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9909" y="-10301.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9909" y="-10286.86" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_0_15&#45;&gt;kv_send2_0_15 -->
<g id="edge1841" class="edge">
<title>ring_stage2_0_15&#45;&gt;kv_send2_0_15</title>
<path fill="none" stroke="black" d="M9654.8,-10361.18C9709.13,-10347.91 9774.57,-10331.91 9825.44,-10319.48"/>
<polygon fill="black" stroke="black" points="9826.53,-10322.81 9835.42,-10317.04 9824.87,-10316.01 9826.53,-10322.81"/>
</g>
<!-- ring_stage2_1_15 -->
<g id="node1346" class="node">
<title>ring_stage2_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9553,-10324.56 9333,-10324.56 9333,-10271.56 9553,-10271.56 9553,-10324.56"/>
<text text-anchor="middle" x="9443" y="-10309.36" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="9443" y="-10294.36" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_14×V_14</text>
<text text-anchor="middle" x="9443" y="-10279.36" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_0_15&#45;&gt;ring_stage2_1_15 -->
<g id="edge1887" class="edge">
<title>ring_stage2_0_15&#45;&gt;ring_stage2_1_15</title>
<path fill="none" stroke="black" d="M9518.76,-10361.18C9507.33,-10351.81 9494.24,-10341.07 9482.2,-10331.2"/>
<polygon fill="black" stroke="black" points="9484.41,-10328.49 9474.46,-10324.85 9479.97,-10333.9 9484.41,-10328.49"/>
</g>
<!-- kv_send2_0_0&#45;&gt;ring_stage2_1_1 -->
<g id="edge1846" class="edge">
<title>kv_send2_0_0&#45;&gt;ring_stage2_1_1</title>
<path fill="none" stroke="black" d="M10623,-10180.99C10623,-10172.95 10623,-10163.97 10623,-10155.42"/>
<polygon fill="black" stroke="black" points="10626.5,-10155.28 10623,-10145.28 10619.5,-10155.28 10626.5,-10155.28"/>
</g>
<!-- kv_send2_0_1&#45;&gt;ring_stage2_1_2 -->
<g id="edge1849" class="edge">
<title>kv_send2_0_1&#45;&gt;ring_stage2_1_2</title>
<path fill="none" stroke="black" d="M10841,-10091.25C10841,-10083.21 10841,-10074.23 10841,-10065.68"/>
<polygon fill="black" stroke="black" points="10844.5,-10065.54 10841,-10055.54 10837.5,-10065.54 10844.5,-10065.54"/>
</g>
<!-- kv_send2_0_2&#45;&gt;ring_stage2_1_3 -->
<g id="edge1852" class="edge">
<title>kv_send2_0_2&#45;&gt;ring_stage2_1_3</title>
<path fill="none" stroke="black" d="M11193.54,-10003.4C11207.44,-9993.56 11223.64,-9982.1 11238.41,-9971.64"/>
<polygon fill="black" stroke="black" points="11240.77,-9974.26 11246.92,-9965.63 11236.73,-9968.55 11240.77,-9974.26"/>
</g>
<!-- kv_send2_0_3&#45;&gt;ring_stage2_1_4 -->
<g id="edge1855" class="edge">
<title>kv_send2_0_3&#45;&gt;ring_stage2_1_4</title>
<path fill="none" stroke="black" d="M10993.66,-9919.59C10980.23,-9916.68 10966.25,-9914.04 10953,-9912.23 10606.55,-9864.68 10515.17,-9908.87 10167,-9876.23 10142.56,-9873.94 10116.38,-9870.69 10091.71,-9867.26"/>
<polygon fill="black" stroke="black" points="10092,-9863.77 10081.61,-9865.84 10091.03,-9870.7 10092,-9863.77"/>
</g>
<!-- kv_send2_0_4&#45;&gt;ring_stage2_1_5 -->
<g id="edge1858" class="edge">
<title>kv_send2_0_4&#45;&gt;ring_stage2_1_5</title>
<path fill="none" stroke="black" d="M9114.55,-9826.44C9087.13,-9815.4 9053.49,-9801.87 9023.87,-9789.95"/>
<polygon fill="black" stroke="black" points="9024.99,-9786.62 9014.41,-9786.14 9022.38,-9793.12 9024.99,-9786.62"/>
</g>
<!-- kv_send2_0_5&#45;&gt;ring_stage2_1_6 -->
<g id="edge1861" class="edge">
<title>kv_send2_0_5&#45;&gt;ring_stage2_1_6</title>
<path fill="none" stroke="black" d="M9254.52,-9744.55C9321.03,-9733.27 9415.81,-9716.43 9507.37,-9697.05"/>
<polygon fill="black" stroke="black" points="9508.31,-9700.43 9517.36,-9694.92 9506.85,-9693.58 9508.31,-9700.43"/>
</g>
<!-- kv_send2_0_6&#45;&gt;ring_stage2_1_7 -->
<g id="edge1864" class="edge">
<title>kv_send2_0_6&#45;&gt;ring_stage2_1_7</title>
<path fill="none" stroke="black" d="M9982.04,-9651.1C9969.38,-9648.26 9956.33,-9645.45 9944,-9643.01 9851.19,-9624.61 9824.48,-9626.46 9727.61,-9607.06"/>
<polygon fill="black" stroke="black" points="9728.19,-9603.61 9717.7,-9605.05 9726.8,-9610.47 9728.19,-9603.61"/>
</g>
<!-- kv_send2_0_7&#45;&gt;ring_stage2_1_8 -->
<g id="edge1867" class="edge">
<title>kv_send2_0_7&#45;&gt;ring_stage2_1_8</title>
<path fill="none" stroke="black" d="M9202.72,-9553.76C9211.23,-9544.65 9220.95,-9534.25 9229.99,-9524.58"/>
<polygon fill="black" stroke="black" points="9232.78,-9526.72 9237.05,-9517.02 9227.67,-9521.94 9232.78,-9526.72"/>
</g>
<!-- kv_send2_0_8&#45;&gt;ring_stage2_1_9 -->
<g id="edge1870" class="edge">
<title>kv_send2_0_8&#45;&gt;ring_stage2_1_9</title>
<path fill="none" stroke="black" d="M9011.72,-9464.02C9020.23,-9454.91 9029.95,-9444.51 9038.99,-9434.84"/>
<polygon fill="black" stroke="black" points="9041.78,-9436.98 9046.05,-9427.28 9036.67,-9432.2 9041.78,-9436.98"/>
</g>
<!-- kv_send2_0_9&#45;&gt;ring_stage2_1_10 -->
<g id="edge1873" class="edge">
<title>kv_send2_0_9&#45;&gt;ring_stage2_1_10</title>
<path fill="none" stroke="black" d="M8606.4,-9373.33C8606.22,-9365.29 8606.01,-9356.31 8605.82,-9347.76"/>
<polygon fill="black" stroke="black" points="8609.31,-9347.54 8605.59,-9337.62 8602.31,-9347.7 8609.31,-9347.54"/>
</g>
<!-- kv_send2_0_10&#45;&gt;ring_stage2_1_11 -->
<g id="edge1876" class="edge">
<title>kv_send2_0_10&#45;&gt;ring_stage2_1_11</title>
<path fill="none" stroke="black" d="M8755.05,-9292.22C8741.7,-9289.38 8727.97,-9286.56 8715,-9284.05 8624.28,-9266.49 8598.52,-9266.2 8504.15,-9248.23"/>
<polygon fill="black" stroke="black" points="8504.66,-9244.76 8494.18,-9246.31 8503.34,-9251.64 8504.66,-9244.76"/>
</g>
<!-- kv_send2_0_11&#45;&gt;ring_stage2_1_12 -->
<g id="edge1879" class="edge">
<title>kv_send2_0_11&#45;&gt;ring_stage2_1_12</title>
<path fill="none" stroke="black" d="M8677.55,-9197.92C8704.87,-9186.97 8738.18,-9173.63 8767.58,-9161.85"/>
<polygon fill="black" stroke="black" points="8768.99,-9165.05 8776.98,-9158.09 8766.39,-9158.56 8768.99,-9165.05"/>
</g>
<!-- kv_send2_0_12&#45;&gt;ring_stage2_1_13 -->
<g id="edge1882" class="edge">
<title>kv_send2_0_12&#45;&gt;ring_stage2_1_13</title>
<path fill="none" stroke="black" d="M8306.67,-9108.75C8276.23,-9097.62 8238.71,-9083.9 8205.76,-9071.85"/>
<polygon fill="black" stroke="black" points="8206.75,-9068.49 8196.15,-9068.34 8204.34,-9075.06 8206.75,-9068.49"/>
</g>
<!-- kv_send2_0_13&#45;&gt;ring_stage2_1_14 -->
<g id="edge1885" class="edge">
<title>kv_send2_0_13&#45;&gt;ring_stage2_1_14</title>
<path fill="none" stroke="black" d="M9074,-10450.21C9074,-10442.17 9074,-10433.19 9074,-10424.64"/>
<polygon fill="black" stroke="black" points="9077.5,-10424.5 9074,-10414.5 9070.5,-10424.5 9077.5,-10424.5"/>
</g>
<!-- kv_send2_0_14&#45;&gt;ring_stage2_1_15 -->
<g id="edge1888" class="edge">
<title>kv_send2_0_14&#45;&gt;ring_stage2_1_15</title>
<path fill="none" stroke="black" d="M9348.49,-10362.36C9363.31,-10352.43 9380.61,-10340.84 9396.33,-10330.31"/>
<polygon fill="black" stroke="black" points="9398.52,-10333.06 9404.88,-10324.59 9394.62,-10327.25 9398.52,-10333.06"/>
</g>
<!-- kv_send2_0_15&#45;&gt;ring_stage2_1_0 -->
<g id="edge1843" class="edge">
<title>kv_send2_0_15&#45;&gt;ring_stage2_1_0</title>
<path fill="none" stroke="black" d="M9917.54,-10271.21C9920.29,-10262.91 9923.38,-10253.56 9926.3,-10244.7"/>
<polygon fill="black" stroke="black" points="9929.7,-10245.58 9929.52,-10234.98 9923.06,-10243.38 9929.7,-10245.58"/>
</g>
<!-- kv_send2_1_0 -->
<g id="node1347" class="node">
<title>kv_send2_1_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9968" cy="-10118.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9968" y="-10122.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="9968" y="-10107.38" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_1_0&#45;&gt;kv_send2_1_0 -->
<g id="edge1844" class="edge">
<title>ring_stage2_1_0&#45;&gt;kv_send2_1_0</title>
<path fill="none" stroke="black" d="M9946.84,-10181.47C9949.65,-10173.24 9952.81,-10163.99 9955.82,-10155.2"/>
<polygon fill="black" stroke="black" points="9959.2,-10156.14 9959.12,-10145.55 9952.57,-10153.88 9959.2,-10156.14"/>
</g>
<!-- ring_stage2_2_0 -->
<g id="node1363" class="node">
<title>ring_stage2_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9570.5,-10145.08 9359.5,-10145.08 9359.5,-10092.08 9570.5,-10092.08 9570.5,-10145.08"/>
<text text-anchor="middle" x="9465" y="-10129.88" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9465" y="-10114.88" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_14×V_14</text>
<text text-anchor="middle" x="9465" y="-10099.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_1_0&#45;&gt;ring_stage2_2_0 -->
<g id="edge1890" class="edge">
<title>ring_stage2_1_0&#45;&gt;ring_stage2_2_0</title>
<path fill="none" stroke="black" d="M9832.44,-10187.74C9757.78,-10173.89 9657.71,-10155.32 9580.85,-10141.07"/>
<polygon fill="black" stroke="black" points="9581.12,-10137.56 9570.65,-10139.17 9579.84,-10144.44 9581.12,-10137.56"/>
</g>
<!-- kv_send2_1_1 -->
<g id="node1348" class="node">
<title>kv_send2_1_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10623" cy="-10028.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10623" y="-10032.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="10623" y="-10017.64" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_1_1&#45;&gt;kv_send2_1_1 -->
<g id="edge1847" class="edge">
<title>ring_stage2_1_1&#45;&gt;kv_send2_1_1</title>
<path fill="none" stroke="black" d="M10623,-10091.73C10623,-10083.68 10623,-10074.65 10623,-10066.03"/>
<polygon fill="black" stroke="black" points="10626.5,-10065.81 10623,-10055.81 10619.5,-10065.81 10626.5,-10065.81"/>
</g>
<!-- ring_stage2_2_1 -->
<g id="node1364" class="node">
<title>ring_stage2_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10190.5,-10055.34 9979.5,-10055.34 9979.5,-10002.34 10190.5,-10002.34 10190.5,-10055.34"/>
<text text-anchor="middle" x="10085" y="-10040.14" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="10085" y="-10025.14" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_15×V_15</text>
<text text-anchor="middle" x="10085" y="-10010.14" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_1_1&#45;&gt;ring_stage2_2_1 -->
<g id="edge1893" class="edge">
<title>ring_stage2_1_1&#45;&gt;ring_stage2_2_1</title>
<path fill="none" stroke="black" d="M10526.2,-10101.79C10434.89,-10086.9 10297.91,-10064.56 10200.84,-10048.73"/>
<polygon fill="black" stroke="black" points="10201.13,-10045.23 10190.69,-10047.07 10200,-10052.14 10201.13,-10045.23"/>
</g>
<!-- kv_send2_1_2 -->
<g id="node1349" class="node">
<title>kv_send2_1_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10841" cy="-9939.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10841" y="-9942.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="10841" y="-9927.9" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_1_2&#45;&gt;kv_send2_1_2 -->
<g id="edge1850" class="edge">
<title>ring_stage2_1_2&#45;&gt;kv_send2_1_2</title>
<path fill="none" stroke="black" d="M10841,-10001.99C10841,-9993.94 10841,-9984.91 10841,-9976.29"/>
<polygon fill="black" stroke="black" points="10844.5,-9976.06 10841,-9966.06 10837.5,-9976.07 10844.5,-9976.06"/>
</g>
<!-- ring_stage2_2_2 -->
<g id="node1365" class="node">
<title>ring_stage2_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-9965.6 10526.5,-9965.6 10526.5,-9912.6 10719.5,-9912.6 10719.5,-9965.6"/>
<text text-anchor="middle" x="10623" y="-9950.4" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="10623" y="-9935.4" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_0×V_0</text>
<text text-anchor="middle" x="10623" y="-9920.4" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_1_2&#45;&gt;ring_stage2_2_2 -->
<g id="edge1896" class="edge">
<title>ring_stage2_1_2&#45;&gt;ring_stage2_2_2</title>
<path fill="none" stroke="black" d="M10777.36,-10002.22C10751.95,-9992 10722.54,-9980.16 10696.25,-9969.58"/>
<polygon fill="black" stroke="black" points="10697.3,-9966.23 10686.72,-9965.74 10694.69,-9972.72 10697.3,-9966.23"/>
</g>
<!-- kv_send2_1_3 -->
<g id="node1350" class="node">
<title>kv_send2_1_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10956" cy="-9849.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10956" y="-9853.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="10956" y="-9838.16" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_1_3&#45;&gt;kv_send2_1_3 -->
<g id="edge1853" class="edge">
<title>ring_stage2_1_3&#45;&gt;kv_send2_1_3</title>
<path fill="none" stroke="black" d="M11187.54,-9912.48C11139.42,-9899.57 11081.73,-9884.09 11035.97,-9871.81"/>
<polygon fill="black" stroke="black" points="11036.66,-9868.38 11026.1,-9869.16 11034.85,-9875.14 11036.66,-9868.38"/>
</g>
<!-- ring_stage2_2_3 -->
<g id="node1366" class="node">
<title>ring_stage2_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11270.5,-9875.86 11077.5,-9875.86 11077.5,-9822.86 11270.5,-9822.86 11270.5,-9875.86"/>
<text text-anchor="middle" x="11174" y="-9860.66" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="11174" y="-9845.66" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_1×V_1</text>
<text text-anchor="middle" x="11174" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_1_3&#45;&gt;ring_stage2_2_3 -->
<g id="edge1899" class="edge">
<title>ring_stage2_1_3&#45;&gt;ring_stage2_2_3</title>
<path fill="none" stroke="black" d="M11251.18,-9912.48C11239.53,-9903.1 11226.2,-9892.37 11213.93,-9882.5"/>
<polygon fill="black" stroke="black" points="11216.03,-9879.7 11206.05,-9876.15 11211.64,-9885.15 11216.03,-9879.7"/>
</g>
<!-- kv_send2_1_4 -->
<g id="node1351" class="node">
<title>kv_send2_1_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9551" cy="-9759.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9551" y="-9763.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9551" y="-9748.42" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_1_4&#45;&gt;kv_send2_1_4 -->
<g id="edge1856" class="edge">
<title>ring_stage2_1_4&#45;&gt;kv_send2_1_4</title>
<path fill="none" stroke="black" d="M9888.42,-9826.41C9882.19,-9825.06 9876.01,-9823.74 9870,-9822.49 9793.87,-9806.54 9707.22,-9789.83 9643.45,-9777.8"/>
<polygon fill="black" stroke="black" points="9643.9,-9774.32 9633.42,-9775.91 9642.6,-9781.2 9643.9,-9774.32"/>
</g>
<!-- ring_stage2_2_4 -->
<g id="node1367" class="node">
<title>ring_stage2_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10606.5,-9786.12 10413.5,-9786.12 10413.5,-9733.12 10606.5,-9733.12 10606.5,-9786.12"/>
<text text-anchor="middle" x="10510" y="-9770.92" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="10510" y="-9755.92" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_2×V_2</text>
<text text-anchor="middle" x="10510" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_1_4&#45;&gt;ring_stage2_2_4 -->
<g id="edge1902" class="edge">
<title>ring_stage2_1_4&#45;&gt;ring_stage2_2_4</title>
<path fill="none" stroke="black" d="M10081.78,-9834.27C10194.02,-9817.86 10367.6,-9792.27 10398,-9786.49 10399.72,-9786.16 10401.45,-9785.82 10403.19,-9785.48"/>
<polygon fill="black" stroke="black" points="10404.16,-9788.86 10413.27,-9783.46 10402.78,-9782 10404.16,-9788.86"/>
</g>
<!-- kv_send2_1_5 -->
<g id="node1352" class="node">
<title>kv_send2_1_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9185" cy="-9669.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9185" y="-9673.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="9185" y="-9658.68" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_1_5&#45;&gt;kv_send2_1_5 -->
<g id="edge1859" class="edge">
<title>ring_stage2_1_5&#45;&gt;kv_send2_1_5</title>
<path fill="none" stroke="black" d="M9019.31,-9733C9050.49,-9721.31 9087.27,-9707.52 9118.26,-9695.9"/>
<polygon fill="black" stroke="black" points="9119.54,-9699.16 9127.67,-9692.37 9117.08,-9692.61 9119.54,-9699.16"/>
</g>
<!-- ring_stage2_2_5 -->
<g id="node1368" class="node">
<title>ring_stage2_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9499.5,-9696.38 9306.5,-9696.38 9306.5,-9643.38 9499.5,-9643.38 9499.5,-9696.38"/>
<text text-anchor="middle" x="9403" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9403" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_3×V_3</text>
<text text-anchor="middle" x="9403" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_1_5&#45;&gt;ring_stage2_2_5 -->
<g id="edge1905" class="edge">
<title>ring_stage2_1_5&#45;&gt;ring_stage2_2_5</title>
<path fill="none" stroke="black" d="M9047.68,-9734.64C9050.82,-9733.98 9053.93,-9733.35 9057,-9732.75 9159.73,-9712.55 9189.44,-9717.25 9296.42,-9696.78"/>
<polygon fill="black" stroke="black" points="9297.17,-9700.2 9306.32,-9694.85 9295.83,-9693.33 9297.17,-9700.2"/>
</g>
<!-- kv_send2_1_6 -->
<g id="node1353" class="node">
<title>kv_send2_1_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10050" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10050" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10050" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_1_6&#45;&gt;kv_send2_1_6 -->
<g id="edge1862" class="edge">
<title>ring_stage2_1_6&#45;&gt;kv_send2_1_6</title>
<path fill="none" stroke="black" d="M9710.69,-9644.96C9713.83,-9644.28 9716.94,-9643.63 9720,-9643.01 9816.21,-9623.35 9841.67,-9626.07 9938,-9607.01 9947.15,-9605.19 9956.7,-9603.18 9966.19,-9601.1"/>
<polygon fill="black" stroke="black" points="9967.04,-9604.5 9976.04,-9598.92 9965.52,-9597.67 9967.04,-9604.5"/>
</g>
<!-- ring_stage2_2_6 -->
<g id="node1369" class="node">
<title>ring_stage2_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9928.5,-9606.64 9735.5,-9606.64 9735.5,-9553.64 9928.5,-9553.64 9928.5,-9606.64"/>
<text text-anchor="middle" x="9832" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9832" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_4×V_4</text>
<text text-anchor="middle" x="9832" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_1_6&#45;&gt;ring_stage2_2_6 -->
<g id="edge1908" class="edge">
<title>ring_stage2_1_6&#45;&gt;ring_stage2_2_6</title>
<path fill="none" stroke="black" d="M9677.64,-9643.26C9703.05,-9633.04 9732.46,-9621.2 9758.75,-9610.62"/>
<polygon fill="black" stroke="black" points="9760.31,-9613.76 9768.28,-9606.78 9757.7,-9607.27 9760.31,-9613.76"/>
</g>
<!-- kv_send2_1_7 -->
<g id="node1354" class="node">
<title>kv_send2_1_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9510" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9510" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="9510" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_1_7&#45;&gt;kv_send2_1_7 -->
<g id="edge1865" class="edge">
<title>ring_stage2_1_7&#45;&gt;kv_send2_1_7</title>
<path fill="none" stroke="black" d="M9588.6,-9553.52C9576.42,-9543.9 9562.43,-9532.84 9549.67,-9522.75"/>
<polygon fill="black" stroke="black" points="9551.5,-9519.74 9541.49,-9516.29 9547.16,-9525.23 9551.5,-9519.74"/>
</g>
<!-- ring_stage2_2_7 -->
<g id="node1370" class="node">
<title>ring_stage2_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10039.5,-9516.9 9846.5,-9516.9 9846.5,-9463.9 10039.5,-9463.9 10039.5,-9516.9"/>
<text text-anchor="middle" x="9943" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9943" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_5×V_5</text>
<text text-anchor="middle" x="9943" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_1_7&#45;&gt;ring_stage2_2_7 -->
<g id="edge1911" class="edge">
<title>ring_stage2_1_7&#45;&gt;ring_stage2_2_7</title>
<path fill="none" stroke="black" d="M9715,-9553.52C9754.02,-9542.89 9799.42,-9530.52 9839.39,-9519.63"/>
<polygon fill="black" stroke="black" points="9840.43,-9522.97 9849.16,-9516.97 9838.59,-9516.22 9840.43,-9522.97"/>
</g>
<!-- kv_send2_1_8 -->
<g id="node1355" class="node">
<title>kv_send2_1_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9289" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9289" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="9289" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_1_8&#45;&gt;kv_send2_1_8 -->
<g id="edge1868" class="edge">
<title>ring_stage2_1_8&#45;&gt;kv_send2_1_8</title>
<path fill="none" stroke="black" d="M9269.25,-9463.55C9271.87,-9455.32 9274.83,-9446.07 9277.63,-9437.28"/>
<polygon fill="black" stroke="black" points="9281.01,-9438.22 9280.71,-9427.62 9274.34,-9436.09 9281.01,-9438.22"/>
</g>
<!-- ring_stage2_2_8 -->
<g id="node1371" class="node">
<title>ring_stage2_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9603.5,-9427.16 9410.5,-9427.16 9410.5,-9374.16 9603.5,-9374.16 9603.5,-9427.16"/>
<text text-anchor="middle" x="9507" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9507" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_6×V_6</text>
<text text-anchor="middle" x="9507" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_1_8&#45;&gt;ring_stage2_2_8 -->
<g id="edge1914" class="edge">
<title>ring_stage2_1_8&#45;&gt;ring_stage2_2_8</title>
<path fill="none" stroke="black" d="M9332.81,-9463.78C9361.86,-9453.42 9395.55,-9441.41 9425.51,-9430.72"/>
<polygon fill="black" stroke="black" points="9426.85,-9433.96 9435.1,-9427.3 9424.5,-9427.36 9426.85,-9433.96"/>
</g>
<!-- kv_send2_1_9 -->
<g id="node1356" class="node">
<title>kv_send2_1_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9071" cy="-9310.92" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9071" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9071" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_1_9&#45;&gt;kv_send2_1_9 -->
<g id="edge1871" class="edge">
<title>ring_stage2_1_9&#45;&gt;kv_send2_1_9</title>
<path fill="none" stroke="black" d="M9070.29,-9373.81C9070.39,-9365.76 9070.49,-9356.73 9070.59,-9348.1"/>
<polygon fill="black" stroke="black" points="9074.09,-9347.92 9070.7,-9337.88 9067.09,-9347.84 9074.09,-9347.92"/>
</g>
<!-- ring_stage2_2_9 -->
<g id="node1372" class="node">
<title>ring_stage2_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9391.5,-9337.42 9198.5,-9337.42 9198.5,-9284.42 9391.5,-9284.42 9391.5,-9337.42"/>
<text text-anchor="middle" x="9295" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9295" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_7×V_7</text>
<text text-anchor="middle" x="9295" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_1_9&#45;&gt;ring_stage2_2_9 -->
<g id="edge1917" class="edge">
<title>ring_stage2_1_9&#45;&gt;ring_stage2_2_9</title>
<path fill="none" stroke="black" d="M9135.68,-9374.04C9162.02,-9363.77 9192.53,-9351.87 9219.75,-9341.26"/>
<polygon fill="black" stroke="black" points="9221.19,-9344.46 9229.23,-9337.56 9218.65,-9337.93 9221.19,-9344.46"/>
</g>
<!-- kv_send2_1_10 -->
<g id="node1357" class="node">
<title>kv_send2_1_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8146" cy="-9221.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8146" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="8146" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_1_10&#45;&gt;kv_send2_1_10 -->
<g id="edge1874" class="edge">
<title>ring_stage2_1_10&#45;&gt;kv_send2_1_10</title>
<path fill="none" stroke="black" d="M8503.77,-9285.8C8500.82,-9285.2 8497.89,-9284.61 8495,-9284.05 8393.46,-9264.19 8366.71,-9267.04 8265,-9248.05 8255.08,-9246.19 8244.72,-9244.13 8234.43,-9242"/>
<polygon fill="black" stroke="black" points="8235.11,-9238.57 8224.6,-9239.95 8233.67,-9245.42 8235.11,-9238.57"/>
</g>
<!-- ring_stage2_2_10 -->
<g id="node1373" class="node">
<title>ring_stage2_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9190,-9247.68 8988,-9247.68 8988,-9194.68 9190,-9194.68 9190,-9247.68"/>
<text text-anchor="middle" x="9089" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9089" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_8×V_8</text>
<text text-anchor="middle" x="9089" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_1_10&#45;&gt;ring_stage2_2_10 -->
<g id="edge1920" class="edge">
<title>ring_stage2_1_10&#45;&gt;ring_stage2_2_10</title>
<path fill="none" stroke="black" d="M8706.22,-9285.73C8709.17,-9285.14 8712.11,-9284.58 8715,-9284.05 8828.25,-9263.06 8860.8,-9269.26 8977.72,-9248.2"/>
<polygon fill="black" stroke="black" points="8978.57,-9251.61 8987.78,-9246.36 8977.32,-9244.72 8978.57,-9251.61"/>
</g>
<!-- kv_send2_1_11 -->
<g id="node1358" class="node">
<title>kv_send2_1_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8603" cy="-9131.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8603" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="8603" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_1_11&#45;&gt;kv_send2_1_11 -->
<g id="edge1877" class="edge">
<title>ring_stage2_1_11&#45;&gt;kv_send2_1_11</title>
<path fill="none" stroke="black" d="M8447.93,-9194.56C8476.29,-9183.2 8509.61,-9169.85 8538.08,-9158.44"/>
<polygon fill="black" stroke="black" points="8539.55,-9161.62 8547.54,-9154.66 8536.95,-9155.13 8539.55,-9161.62"/>
</g>
<!-- ring_stage2_2_11 -->
<g id="node1374" class="node">
<title>ring_stage2_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8238,-9157.94 8036,-9157.94 8036,-9104.94 8238,-9104.94 8238,-9157.94"/>
<text text-anchor="middle" x="8137" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="8137" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_9×V_9</text>
<text text-anchor="middle" x="8137" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_1_11&#45;&gt;ring_stage2_2_11 -->
<g id="edge1923" class="edge">
<title>ring_stage2_1_11&#45;&gt;ring_stage2_2_11</title>
<path fill="none" stroke="black" d="M8311.89,-9194.56C8282.73,-9184.2 8248.91,-9172.19 8218.82,-9161.5"/>
<polygon fill="black" stroke="black" points="8219.79,-9158.13 8209.2,-9158.08 8217.45,-9164.73 8219.79,-9158.13"/>
</g>
<!-- kv_send2_1_12 -->
<g id="node1359" class="node">
<title>kv_send2_1_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8601" cy="-9041.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8601" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="8601" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_1_12&#45;&gt;kv_send2_1_12 -->
<g id="edge1880" class="edge">
<title>ring_stage2_1_12&#45;&gt;kv_send2_1_12</title>
<path fill="none" stroke="black" d="M8770.94,-9104.82C8739.09,-9093.18 8701.53,-9079.45 8669.83,-9067.86"/>
<polygon fill="black" stroke="black" points="8670.79,-9064.48 8660.19,-9064.34 8668.38,-9071.06 8670.79,-9064.48"/>
</g>
<!-- ring_stage2_2_12 -->
<g id="node1375" class="node">
<title>ring_stage2_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8949,-9068.2 8729,-9068.2 8729,-9015.2 8949,-9015.2 8949,-9068.2"/>
<text text-anchor="middle" x="8839" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="8839" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_10×V_10</text>
<text text-anchor="middle" x="8839" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_1_12&#45;&gt;ring_stage2_2_12 -->
<g id="edge1926" class="edge">
<title>ring_stage2_1_12&#45;&gt;ring_stage2_2_12</title>
<path fill="none" stroke="black" d="M8840.41,-9104.58C8840.22,-9096.37 8840.01,-9087.14 8839.81,-9078.37"/>
<polygon fill="black" stroke="black" points="8843.31,-9078.28 8839.59,-9068.36 8836.31,-9078.44 8843.31,-9078.28"/>
</g>
<!-- kv_send2_1_13 -->
<g id="node1360" class="node">
<title>kv_send2_1_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8126" cy="-8951.95" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8126" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="8126" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_1_13&#45;&gt;kv_send2_1_13 -->
<g id="edge1883" class="edge">
<title>ring_stage2_1_13&#45;&gt;kv_send2_1_13</title>
<path fill="none" stroke="black" d="M8126,-9014.84C8126,-9006.79 8126,-8997.76 8126,-8989.14"/>
<polygon fill="black" stroke="black" points="8129.5,-8988.92 8126,-8978.92 8122.5,-8988.92 8129.5,-8988.92"/>
</g>
<!-- ring_stage2_2_13 -->
<g id="node1376" class="node">
<title>ring_stage2_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8474,-8978.45 8254,-8978.45 8254,-8925.45 8474,-8925.45 8474,-8978.45"/>
<text text-anchor="middle" x="8364" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="8364" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_11×V_11</text>
<text text-anchor="middle" x="8364" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_1_13&#45;&gt;ring_stage2_2_13 -->
<g id="edge1929" class="edge">
<title>ring_stage2_1_13&#45;&gt;ring_stage2_2_13</title>
<path fill="none" stroke="black" d="M8195.48,-9015.08C8223.46,-9004.77 8255.89,-8992.81 8284.78,-8982.16"/>
<polygon fill="black" stroke="black" points="8286.26,-8985.34 8294.43,-8978.6 8283.84,-8978.78 8286.26,-8985.34"/>
</g>
<!-- kv_send2_1_14 -->
<g id="node1361" class="node">
<title>kv_send2_1_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9163" cy="-10298.06" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9163" y="-10301.86" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9163" y="-10286.86" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_1_14&#45;&gt;kv_send2_1_14 -->
<g id="edge1886" class="edge">
<title>ring_stage2_1_14&#45;&gt;kv_send2_1_14</title>
<path fill="none" stroke="black" d="M9100.22,-10360.95C9109.54,-10351.76 9120.15,-10341.3 9129.96,-10331.63"/>
<polygon fill="black" stroke="black" points="9132.61,-10333.93 9137.27,-10324.42 9127.69,-10328.95 9132.61,-10333.93"/>
</g>
<!-- ring_stage2_2_14 -->
<g id="node1377" class="node">
<title>ring_stage2_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8216,-8888.71 7996,-8888.71 7996,-8835.71 8216,-8835.71 8216,-8888.71"/>
<text text-anchor="middle" x="8106" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="8106" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_12×V_12</text>
<text text-anchor="middle" x="8106" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_1_14&#45;&gt;ring_stage2_2_14 -->
<g id="edge1932" class="edge">
<title>ring_stage2_1_14&#45;&gt;ring_stage2_2_14</title>
<path fill="none" stroke="black" d="M9040.9,-10361.18C8943.49,-10285.31 8660.4,-10061.13 8592,-9965.97 8501.3,-9839.77 8548.94,-9769.02 8458,-9643.01 8301.09,-9425.6 8118.65,-9489.46 8002,-9248.05 7979.62,-9201.74 7997,-9183.87 7997,-9132.44 7997,-9132.44 7997,-9132.44 7997,-9040.7 7997,-8989.12 7980.08,-8969.07 8007,-8925.08 8014.41,-8912.98 8025.17,-8902.87 8036.89,-8894.57"/>
<polygon fill="black" stroke="black" points="8039.15,-8897.27 8045.57,-8888.84 8035.29,-8891.43 8039.15,-8897.27"/>
</g>
<!-- kv_send2_1_15 -->
<g id="node1362" class="node">
<title>kv_send2_1_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9445" cy="-10208.32" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9445" y="-10212.12" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9445" y="-10197.12" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_1_15&#45;&gt;kv_send2_1_15 -->
<g id="edge1889" class="edge">
<title>ring_stage2_1_15&#45;&gt;kv_send2_1_15</title>
<path fill="none" stroke="black" d="M9443.59,-10271.21C9443.77,-10263.16 9443.98,-10254.13 9444.18,-10245.51"/>
<polygon fill="black" stroke="black" points="9447.68,-10245.36 9444.41,-10235.29 9440.68,-10245.2 9447.68,-10245.36"/>
</g>
<!-- ring_stage2_2_15 -->
<g id="node1378" class="node">
<title>ring_stage2_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9299,-10234.82 9079,-10234.82 9079,-10181.82 9299,-10181.82 9299,-10234.82"/>
<text text-anchor="middle" x="9189" y="-10219.62" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="9189" y="-10204.62" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_13×V_13</text>
<text text-anchor="middle" x="9189" y="-10189.62" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_1_15&#45;&gt;ring_stage2_2_15 -->
<g id="edge1935" class="edge">
<title>ring_stage2_1_15&#45;&gt;ring_stage2_2_15</title>
<path fill="none" stroke="black" d="M9368.85,-10271.44C9338.73,-10261.04 9303.78,-10248.96 9272.74,-10238.24"/>
<polygon fill="black" stroke="black" points="9273.84,-10234.92 9263.24,-10234.96 9271.55,-10241.54 9273.84,-10234.92"/>
</g>
<!-- kv_send2_1_0&#45;&gt;ring_stage2_2_1 -->
<g id="edge1894" class="edge">
<title>kv_send2_1_0&#45;&gt;ring_stage2_2_1</title>
<path fill="none" stroke="black" d="M10000.9,-10092.9C10013.78,-10083.25 10028.71,-10072.05 10042.39,-10061.79"/>
<polygon fill="black" stroke="black" points="10044.81,-10064.35 10050.72,-10055.55 10040.61,-10058.75 10044.81,-10064.35"/>
</g>
<!-- kv_send2_1_1&#45;&gt;ring_stage2_2_2 -->
<g id="edge1897" class="edge">
<title>kv_send2_1_1&#45;&gt;ring_stage2_2_2</title>
<path fill="none" stroke="black" d="M10623,-10001.51C10623,-9993.47 10623,-9984.49 10623,-9975.94"/>
<polygon fill="black" stroke="black" points="10626.5,-9975.8 10623,-9965.8 10619.5,-9975.8 10626.5,-9975.8"/>
</g>
<!-- kv_send2_1_2&#45;&gt;ring_stage2_2_3 -->
<g id="edge1900" class="edge">
<title>kv_send2_1_2&#45;&gt;ring_stage2_2_3</title>
<path fill="none" stroke="black" d="M10911.62,-9919.49C10956.91,-9907.56 11016.55,-9891.84 11067.53,-9878.41"/>
<polygon fill="black" stroke="black" points="11068.49,-9881.78 11077.27,-9875.84 11066.71,-9875.01 11068.49,-9881.78"/>
</g>
<!-- kv_send2_1_3&#45;&gt;ring_stage2_2_4 -->
<g id="edge1903" class="edge">
<title>kv_send2_1_3&#45;&gt;ring_stage2_2_4</title>
<path fill="none" stroke="black" d="M10882.05,-9830.51C10869.39,-9827.67 10856.34,-9824.89 10844,-9822.49 10743.73,-9802.98 10717.17,-9806.5 10617,-9786.49 10616.89,-9786.46 10616.79,-9786.44 10616.68,-9786.42"/>
<polygon fill="black" stroke="black" points="10617.24,-9782.96 10606.74,-9784.37 10615.83,-9789.82 10617.24,-9782.96"/>
</g>
<!-- kv_send2_1_4&#45;&gt;ring_stage2_2_5 -->
<g id="edge1906" class="edge">
<title>kv_send2_1_4&#45;&gt;ring_stage2_2_5</title>
<path fill="none" stroke="black" d="M9510.56,-9734.64C9493.42,-9724.48 9473.24,-9712.52 9455.01,-9701.71"/>
<polygon fill="black" stroke="black" points="9456.63,-9698.6 9446.24,-9696.51 9453.06,-9704.62 9456.63,-9698.6"/>
</g>
<!-- kv_send2_1_5&#45;&gt;ring_stage2_2_6 -->
<g id="edge1909" class="edge">
<title>kv_send2_1_5&#45;&gt;ring_stage2_2_6</title>
<path fill="none" stroke="black" d="M9257.65,-9650.65C9271.01,-9647.76 9284.88,-9645.05 9298,-9643.01 9483.83,-9614.09 9536.4,-9637.17 9725.44,-9607.15"/>
<polygon fill="black" stroke="black" points="9726.11,-9610.59 9735.43,-9605.54 9725,-9603.68 9726.11,-9610.59"/>
</g>
<!-- kv_send2_1_6&#45;&gt;ring_stage2_2_7 -->
<g id="edge1912" class="edge">
<title>kv_send2_1_6&#45;&gt;ring_stage2_2_7</title>
<path fill="none" stroke="black" d="M10019.62,-9554.23C10007.97,-9544.67 9994.5,-9533.62 9982.13,-9523.48"/>
<polygon fill="black" stroke="black" points="9984.15,-9520.61 9974.2,-9516.98 9979.71,-9526.02 9984.15,-9520.61"/>
</g>
<!-- kv_send2_1_7&#45;&gt;ring_stage2_2_8 -->
<g id="edge1915" class="edge">
<title>kv_send2_1_7&#45;&gt;ring_stage2_2_8</title>
<path fill="none" stroke="black" d="M9509.1,-9463.07C9508.83,-9455.03 9508.52,-9446.05 9508.23,-9437.5"/>
<polygon fill="black" stroke="black" points="9511.72,-9437.23 9507.88,-9427.36 9504.72,-9437.47 9511.72,-9437.23"/>
</g>
<!-- kv_send2_1_8&#45;&gt;ring_stage2_2_9 -->
<g id="edge1918" class="edge">
<title>kv_send2_1_8&#45;&gt;ring_stage2_2_9</title>
<path fill="none" stroke="black" d="M9290.8,-9373.33C9291.35,-9365.29 9291.96,-9356.31 9292.55,-9347.76"/>
<polygon fill="black" stroke="black" points="9296.05,-9347.83 9293.24,-9337.62 9289.07,-9347.36 9296.05,-9347.83"/>
</g>
<!-- kv_send2_1_9&#45;&gt;ring_stage2_2_10 -->
<g id="edge1921" class="edge">
<title>kv_send2_1_9&#45;&gt;ring_stage2_2_10</title>
<path fill="none" stroke="black" d="M9076.3,-9284.06C9077.99,-9275.85 9079.88,-9266.62 9081.68,-9257.85"/>
<polygon fill="black" stroke="black" points="9085.15,-9258.34 9083.73,-9247.84 9078.3,-9256.93 9085.15,-9258.34"/>
</g>
<!-- kv_send2_1_10&#45;&gt;ring_stage2_2_11 -->
<g id="edge1924" class="edge">
<title>kv_send2_1_10&#45;&gt;ring_stage2_2_11</title>
<path fill="none" stroke="black" d="M8143.3,-9193.85C8142.48,-9185.81 8141.55,-9176.83 8140.68,-9168.27"/>
<polygon fill="black" stroke="black" points="8144.14,-9167.73 8139.64,-9158.14 8137.18,-9168.44 8144.14,-9167.73"/>
</g>
<!-- kv_send2_1_11&#45;&gt;ring_stage2_2_12 -->
<g id="edge1927" class="edge">
<title>kv_send2_1_11&#45;&gt;ring_stage2_2_12</title>
<path fill="none" stroke="black" d="M8661.64,-9108.63C8691.58,-9097.5 8728.42,-9083.81 8760.75,-9071.79"/>
<polygon fill="black" stroke="black" points="8762.03,-9075.04 8770.19,-9068.28 8759.59,-9068.48 8762.03,-9075.04"/>
</g>
<!-- kv_send2_1_12&#45;&gt;ring_stage2_2_13 -->
<g id="edge1930" class="edge">
<title>kv_send2_1_12&#45;&gt;ring_stage2_2_13</title>
<path fill="none" stroke="black" d="M8542.11,-9018.89C8512.04,-9007.76 8475.05,-8994.07 8442.58,-8982.05"/>
<polygon fill="black" stroke="black" points="8443.7,-8978.73 8433.11,-8978.54 8441.27,-8985.29 8443.7,-8978.73"/>
</g>
<!-- kv_send2_1_13&#45;&gt;ring_stage2_2_14 -->
<g id="edge1933" class="edge">
<title>kv_send2_1_13&#45;&gt;ring_stage2_2_14</title>
<path fill="none" stroke="black" d="M8120.11,-8925.1C8118.24,-8916.89 8116.13,-8907.66 8114.13,-8898.89"/>
<polygon fill="black" stroke="black" points="8117.49,-8897.85 8111.85,-8888.88 8110.66,-8899.41 8117.49,-8897.85"/>
</g>
<!-- kv_send2_1_14&#45;&gt;ring_stage2_2_15 -->
<g id="edge1936" class="edge">
<title>kv_send2_1_14&#45;&gt;ring_stage2_2_15</title>
<path fill="none" stroke="black" d="M9170.66,-10271.21C9173.12,-10262.91 9175.89,-10253.56 9178.51,-10244.7"/>
<polygon fill="black" stroke="black" points="9181.91,-10245.56 9181.39,-10234.98 9175.2,-10243.58 9181.91,-10245.56"/>
</g>
<!-- kv_send2_1_15&#45;&gt;ring_stage2_2_0 -->
<g id="edge1891" class="edge">
<title>kv_send2_1_15&#45;&gt;ring_stage2_2_0</title>
<path fill="none" stroke="black" d="M9450.89,-10181.47C9452.76,-10173.26 9454.87,-10164.02 9456.87,-10155.25"/>
<polygon fill="black" stroke="black" points="9460.34,-10155.77 9459.15,-10145.24 9453.51,-10154.21 9460.34,-10155.77"/>
</g>
<!-- kv_send2_2_0 -->
<g id="node1379" class="node">
<title>kv_send2_2_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9677" cy="-10028.84" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9677" y="-10032.64" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="9677" y="-10017.64" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_2_0&#45;&gt;kv_send2_2_0 -->
<g id="edge1892" class="edge">
<title>ring_stage2_2_0&#45;&gt;kv_send2_2_0</title>
<path fill="none" stroke="black" d="M9526.89,-10091.96C9554.33,-10080.61 9586.57,-10067.26 9614.13,-10055.86"/>
<polygon fill="black" stroke="black" points="9615.76,-10058.97 9623.66,-10051.91 9613.08,-10052.5 9615.76,-10058.97"/>
</g>
<!-- ring_stage2_3_0 -->
<g id="node1395" class="node">
<title>ring_stage2_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9511.5,-10055.34 9300.5,-10055.34 9300.5,-10002.34 9511.5,-10002.34 9511.5,-10055.34"/>
<text text-anchor="middle" x="9406" y="-10040.14" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9406" y="-10025.14" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_13×V_13</text>
<text text-anchor="middle" x="9406" y="-10010.14" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_2_0&#45;&gt;ring_stage2_3_0 -->
<g id="edge1938" class="edge">
<title>ring_stage2_2_0&#45;&gt;ring_stage2_3_0</title>
<path fill="none" stroke="black" d="M9447.62,-10091.73C9441.8,-10083.07 9435.21,-10073.28 9429.03,-10064.08"/>
<polygon fill="black" stroke="black" points="9431.74,-10061.85 9423.26,-10055.5 9425.93,-10065.75 9431.74,-10061.85"/>
</g>
<!-- kv_send2_2_1 -->
<g id="node1380" class="node">
<title>kv_send2_2_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10190" cy="-9939.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10190" y="-9942.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="10190" y="-9927.9" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_2_1&#45;&gt;kv_send2_2_1 -->
<g id="edge1895" class="edge">
<title>ring_stage2_2_1&#45;&gt;kv_send2_2_1</title>
<path fill="none" stroke="black" d="M10115.65,-10002.22C10127.17,-9992.6 10140.4,-9981.54 10152.48,-9971.45"/>
<polygon fill="black" stroke="black" points="10154.78,-9974.08 10160.21,-9964.99 10150.3,-9968.71 10154.78,-9974.08"/>
</g>
<!-- ring_stage2_3_1 -->
<g id="node1396" class="node">
<title>ring_stage2_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9825.5,-9965.6 9614.5,-9965.6 9614.5,-9912.6 9825.5,-9912.6 9825.5,-9965.6"/>
<text text-anchor="middle" x="9720" y="-9950.4" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9720" y="-9935.4" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_14×V_14</text>
<text text-anchor="middle" x="9720" y="-9920.4" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_2_1&#45;&gt;ring_stage2_3_1 -->
<g id="edge1941" class="edge">
<title>ring_stage2_2_1&#45;&gt;ring_stage2_3_1</title>
<path fill="none" stroke="black" d="M9979.43,-10002.46C9934.32,-9991.61 9881.53,-9978.93 9835.39,-9967.83"/>
<polygon fill="black" stroke="black" points="9836.19,-9964.43 9825.65,-9965.49 9834.56,-9971.23 9836.19,-9964.43"/>
</g>
<!-- kv_send2_2_2 -->
<g id="node1381" class="node">
<title>kv_send2_2_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10732" cy="-9849.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10732" y="-9853.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="10732" y="-9838.16" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_2_2&#45;&gt;kv_send2_2_2 -->
<g id="edge1898" class="edge">
<title>ring_stage2_2_2&#45;&gt;kv_send2_2_2</title>
<path fill="none" stroke="black" d="M10654.82,-9912.48C10666.78,-9902.86 10680.51,-9891.8 10693.05,-9881.71"/>
<polygon fill="black" stroke="black" points="10695.48,-9884.24 10701.08,-9875.25 10691.09,-9878.79 10695.48,-9884.24"/>
</g>
<!-- ring_stage2_3_2 -->
<g id="node1397" class="node">
<title>ring_stage2_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10386.5,-9875.86 10175.5,-9875.86 10175.5,-9822.86 10386.5,-9822.86 10386.5,-9875.86"/>
<text text-anchor="middle" x="10281" y="-9860.66" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="10281" y="-9845.66" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_15×V_15</text>
<text text-anchor="middle" x="10281" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_2_2&#45;&gt;ring_stage2_3_2 -->
<g id="edge1944" class="edge">
<title>ring_stage2_2_2&#45;&gt;ring_stage2_3_2</title>
<path fill="none" stroke="black" d="M10526.37,-9913.31C10484.04,-9902.45 10434.16,-9889.65 10390.47,-9878.44"/>
<polygon fill="black" stroke="black" points="10391.22,-9875.02 10380.67,-9875.93 10389.48,-9881.8 10391.22,-9875.02"/>
</g>
<!-- kv_send2_2_3 -->
<g id="node1382" class="node">
<title>kv_send2_2_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10953" cy="-9759.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10953" y="-9763.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="10953" y="-9748.42" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_2_3&#45;&gt;kv_send2_2_3 -->
<g id="edge1901" class="edge">
<title>ring_stage2_2_3&#45;&gt;kv_send2_2_3</title>
<path fill="none" stroke="black" d="M11109.48,-9822.74C11080.52,-9811.24 11046.44,-9797.71 11017.48,-9786.22"/>
<polygon fill="black" stroke="black" points="11018.46,-9782.84 11007.87,-9782.4 11015.87,-9789.34 11018.46,-9782.84"/>
</g>
<!-- ring_stage2_3_3 -->
<g id="node1398" class="node">
<title>ring_stage2_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11269.5,-9786.12 11076.5,-9786.12 11076.5,-9733.12 11269.5,-9733.12 11269.5,-9786.12"/>
<text text-anchor="middle" x="11173" y="-9770.92" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="11173" y="-9755.92" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_0×V_0</text>
<text text-anchor="middle" x="11173" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_2_3&#45;&gt;ring_stage2_3_3 -->
<g id="edge1947" class="edge">
<title>ring_stage2_2_3&#45;&gt;ring_stage2_3_3</title>
<path fill="none" stroke="black" d="M11173.71,-9822.51C11173.61,-9814.29 11173.51,-9805.06 11173.41,-9796.29"/>
<polygon fill="black" stroke="black" points="11176.91,-9796.24 11173.29,-9786.28 11169.91,-9796.32 11176.91,-9796.24"/>
</g>
<!-- kv_send2_2_4 -->
<g id="node1383" class="node">
<title>kv_send2_2_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10510" cy="-9669.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10510" y="-9673.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="10510" y="-9658.68" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_2_4&#45;&gt;kv_send2_2_4 -->
<g id="edge1904" class="edge">
<title>ring_stage2_2_4&#45;&gt;kv_send2_2_4</title>
<path fill="none" stroke="black" d="M10510,-9732.77C10510,-9724.72 10510,-9715.69 10510,-9707.06"/>
<polygon fill="black" stroke="black" points="10513.5,-9706.84 10510,-9696.84 10506.5,-9706.84 10513.5,-9706.84"/>
</g>
<!-- ring_stage2_3_4 -->
<g id="node1399" class="node">
<title>ring_stage2_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11048.5,-9696.38 10855.5,-9696.38 10855.5,-9643.38 11048.5,-9643.38 11048.5,-9696.38"/>
<text text-anchor="middle" x="10952" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="10952" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_1×V_1</text>
<text text-anchor="middle" x="10952" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_2_4&#45;&gt;ring_stage2_3_4 -->
<g id="edge1950" class="edge">
<title>ring_stage2_2_4&#45;&gt;ring_stage2_3_4</title>
<path fill="none" stroke="black" d="M10606.74,-9734.85C10610.2,-9734.12 10613.63,-9733.42 10617,-9732.75 10714.89,-9713.25 10743.22,-9716.73 10845.21,-9696.83"/>
<polygon fill="black" stroke="black" points="10846.18,-9700.2 10855.31,-9694.83 10844.82,-9693.33 10846.18,-9700.2"/>
</g>
<!-- kv_send2_2_5 -->
<g id="node1384" class="node">
<title>kv_send2_2_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9403" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9403" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="9403" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_2_5&#45;&gt;kv_send2_2_5 -->
<g id="edge1907" class="edge">
<title>ring_stage2_2_5&#45;&gt;kv_send2_2_5</title>
<path fill="none" stroke="black" d="M9403,-9643.03C9403,-9634.98 9403,-9625.95 9403,-9617.32"/>
<polygon fill="black" stroke="black" points="9406.5,-9617.1 9403,-9607.1 9399.5,-9617.1 9406.5,-9617.1"/>
</g>
<!-- ring_stage2_3_5 -->
<g id="node1400" class="node">
<title>ring_stage2_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10502.5,-9606.64 10309.5,-9606.64 10309.5,-9553.64 10502.5,-9553.64 10502.5,-9606.64"/>
<text text-anchor="middle" x="10406" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="10406" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_2×V_2</text>
<text text-anchor="middle" x="10406" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_2_5&#45;&gt;ring_stage2_3_5 -->
<g id="edge1953" class="edge">
<title>ring_stage2_2_5&#45;&gt;ring_stage2_3_5</title>
<path fill="none" stroke="black" d="M9499.62,-9644.52C9502.77,-9643.97 9505.91,-9643.46 9509,-9643.01 9796.52,-9600.37 9872.27,-9630.34 10162,-9607.01 10207.01,-9603.38 10256.58,-9598.32 10299.22,-9593.64"/>
<polygon fill="black" stroke="black" points="10299.78,-9597.1 10309.33,-9592.52 10299.01,-9590.14 10299.78,-9597.1"/>
</g>
<!-- kv_send2_2_6 -->
<g id="node1385" class="node">
<title>kv_send2_2_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10161" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10161" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10161" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_2_6&#45;&gt;kv_send2_2_6 -->
<g id="edge1910" class="edge">
<title>ring_stage2_2_6&#45;&gt;kv_send2_2_6</title>
<path fill="none" stroke="black" d="M9928.04,-9553.52C9976.55,-9540.59 10034.72,-9525.07 10080.8,-9512.79"/>
<polygon fill="black" stroke="black" points="10081.97,-9516.09 10090.73,-9510.13 10080.17,-9509.33 10081.97,-9516.09"/>
</g>
<!-- ring_stage2_3_6 -->
<g id="node1401" class="node">
<title>ring_stage2_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9828.5,-9516.9 9635.5,-9516.9 9635.5,-9463.9 9828.5,-9463.9 9828.5,-9516.9"/>
<text text-anchor="middle" x="9732" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9732" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_3×V_3</text>
<text text-anchor="middle" x="9732" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_2_6&#45;&gt;ring_stage2_3_6 -->
<g id="edge1956" class="edge">
<title>ring_stage2_2_6&#45;&gt;ring_stage2_3_6</title>
<path fill="none" stroke="black" d="M9802.81,-9553.52C9792.22,-9544.23 9780.12,-9533.62 9768.95,-9523.82"/>
<polygon fill="black" stroke="black" points="9771.23,-9521.16 9761.4,-9517.19 9766.61,-9526.42 9771.23,-9521.16"/>
</g>
<!-- kv_send2_2_7 -->
<g id="node1386" class="node">
<title>kv_send2_2_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9725" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9725" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="9725" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_2_7&#45;&gt;kv_send2_2_7 -->
<g id="edge1913" class="edge">
<title>ring_stage2_2_7&#45;&gt;kv_send2_2_7</title>
<path fill="none" stroke="black" d="M9879.36,-9463.78C9850.91,-9452.33 9817.43,-9438.86 9788.94,-9427.39"/>
<polygon fill="black" stroke="black" points="9790.07,-9424.07 9779.49,-9423.59 9787.46,-9430.57 9790.07,-9424.07"/>
</g>
<!-- ring_stage2_3_7 -->
<g id="node1402" class="node">
<title>ring_stage2_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10263.5,-9427.16 10070.5,-9427.16 10070.5,-9374.16 10263.5,-9374.16 10263.5,-9427.16"/>
<text text-anchor="middle" x="10167" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="10167" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_4×V_4</text>
<text text-anchor="middle" x="10167" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_2_7&#45;&gt;ring_stage2_3_7 -->
<g id="edge1959" class="edge">
<title>ring_stage2_2_7&#45;&gt;ring_stage2_3_7</title>
<path fill="none" stroke="black" d="M10008.39,-9463.78C10034.61,-9453.51 10064.98,-9441.61 10092.09,-9431"/>
<polygon fill="black" stroke="black" points="10093.49,-9434.21 10101.53,-9427.3 10090.94,-9427.69 10093.49,-9434.21"/>
</g>
<!-- kv_send2_2_8 -->
<g id="node1387" class="node">
<title>kv_send2_2_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9513" cy="-9310.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9513" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="9513" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_2_8&#45;&gt;kv_send2_2_8 -->
<g id="edge1916" class="edge">
<title>ring_stage2_2_8&#45;&gt;kv_send2_2_8</title>
<path fill="none" stroke="black" d="M9508.77,-9373.81C9509.32,-9365.76 9509.94,-9356.73 9510.53,-9348.1"/>
<polygon fill="black" stroke="black" points="9514.03,-9348.1 9511.22,-9337.88 9507.05,-9347.62 9514.03,-9348.1"/>
</g>
<!-- ring_stage2_3_8 -->
<g id="node1403" class="node">
<title>ring_stage2_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9827.5,-9337.42 9634.5,-9337.42 9634.5,-9284.42 9827.5,-9284.42 9827.5,-9337.42"/>
<text text-anchor="middle" x="9731" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9731" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_5×V_5</text>
<text text-anchor="middle" x="9731" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_2_8&#45;&gt;ring_stage2_3_8 -->
<g id="edge1962" class="edge">
<title>ring_stage2_2_8&#45;&gt;ring_stage2_3_8</title>
<path fill="none" stroke="black" d="M9572.39,-9374.04C9598.61,-9363.77 9628.98,-9351.87 9656.09,-9341.26"/>
<polygon fill="black" stroke="black" points="9657.49,-9344.47 9665.53,-9337.56 9654.94,-9337.95 9657.49,-9344.47"/>
</g>
<!-- kv_send2_2_9 -->
<g id="node1388" class="node">
<title>kv_send2_2_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9318" cy="-9221.18" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9318" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9318" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_2_9&#45;&gt;kv_send2_2_9 -->
<g id="edge1919" class="edge">
<title>ring_stage2_2_9&#45;&gt;kv_send2_2_9</title>
<path fill="none" stroke="black" d="M9301.78,-9284.06C9303.91,-9275.93 9306.31,-9266.79 9308.59,-9258.08"/>
<polygon fill="black" stroke="black" points="9312.04,-9258.7 9311.19,-9248.14 9305.27,-9256.93 9312.04,-9258.7"/>
</g>
<!-- ring_stage2_3_9 -->
<g id="node1404" class="node">
<title>ring_stage2_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9638.5,-9247.68 9445.5,-9247.68 9445.5,-9194.68 9638.5,-9194.68 9638.5,-9247.68"/>
<text text-anchor="middle" x="9542" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9542" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_6×V_6</text>
<text text-anchor="middle" x="9542" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_2_9&#45;&gt;ring_stage2_3_9 -->
<g id="edge1965" class="edge">
<title>ring_stage2_2_9&#45;&gt;ring_stage2_3_9</title>
<path fill="none" stroke="black" d="M9367.11,-9284.3C9396.27,-9273.94 9430.09,-9261.93 9460.18,-9251.24"/>
<polygon fill="black" stroke="black" points="9461.55,-9254.47 9469.8,-9247.82 9459.21,-9247.87 9461.55,-9254.47"/>
</g>
<!-- kv_send2_2_10 -->
<g id="node1389" class="node">
<title>kv_send2_2_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9079" cy="-9131.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9079" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9079" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_2_10&#45;&gt;kv_send2_2_10 -->
<g id="edge1922" class="edge">
<title>ring_stage2_2_10&#45;&gt;kv_send2_2_10</title>
<path fill="none" stroke="black" d="M9086.05,-9194.32C9085.13,-9186.19 9084.08,-9177.05 9083.09,-9168.34"/>
<polygon fill="black" stroke="black" points="9086.57,-9167.94 9081.96,-9158.4 9079.61,-9168.74 9086.57,-9167.94"/>
</g>
<!-- ring_stage2_3_10 -->
<g id="node1405" class="node">
<title>ring_stage2_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9409,-9157.94 9207,-9157.94 9207,-9104.94 9409,-9104.94 9409,-9157.94"/>
<text text-anchor="middle" x="9308" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9308" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_7×V_7</text>
<text text-anchor="middle" x="9308" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_2_10&#45;&gt;ring_stage2_3_10 -->
<g id="edge1968" class="edge">
<title>ring_stage2_2_10&#45;&gt;ring_stage2_3_10</title>
<path fill="none" stroke="black" d="M9152.93,-9194.56C9178.46,-9184.34 9208,-9172.5 9234.41,-9161.92"/>
<polygon fill="black" stroke="black" points="9236.01,-9165.05 9243.99,-9158.08 9233.4,-9158.55 9236.01,-9165.05"/>
</g>
<!-- kv_send2_2_11 -->
<g id="node1390" class="node">
<title>kv_send2_2_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8364" cy="-9041.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8364" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="8364" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_2_11&#45;&gt;kv_send2_2_11 -->
<g id="edge1925" class="edge">
<title>ring_stage2_2_11&#45;&gt;kv_send2_2_11</title>
<path fill="none" stroke="black" d="M8203.27,-9104.82C8232.91,-9093.37 8267.78,-9079.89 8297.45,-9068.42"/>
<polygon fill="black" stroke="black" points="8298.82,-9071.64 8306.89,-9064.77 8296.3,-9065.11 8298.82,-9071.64"/>
</g>
<!-- ring_stage2_3_11 -->
<g id="node1406" class="node">
<title>ring_stage2_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9169,-9068.2 8967,-9068.2 8967,-9015.2 9169,-9015.2 9169,-9068.2"/>
<text text-anchor="middle" x="9068" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="9068" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_8×V_8</text>
<text text-anchor="middle" x="9068" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_2_11&#45;&gt;ring_stage2_3_11 -->
<g id="edge1971" class="edge">
<title>ring_stage2_2_11&#45;&gt;ring_stage2_3_11</title>
<path fill="none" stroke="black" d="M8238.16,-9105.92C8241.14,-9105.43 8244.09,-9104.98 8247,-9104.57 8556.91,-9060.64 8642.88,-9111.84 8956.54,-9068.65"/>
<polygon fill="black" stroke="black" points="8957.42,-9072.06 8966.84,-9067.21 8956.45,-9065.13 8957.42,-9072.06"/>
</g>
<!-- kv_send2_2_12 -->
<g id="node1391" class="node">
<title>kv_send2_2_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8602" cy="-8951.95" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8602" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="8602" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_2_12&#45;&gt;kv_send2_2_12 -->
<g id="edge1928" class="edge">
<title>ring_stage2_2_12&#45;&gt;kv_send2_2_12</title>
<path fill="none" stroke="black" d="M8769.81,-9015.08C8738.49,-9003.48 8701.56,-8989.81 8670.34,-8978.26"/>
<polygon fill="black" stroke="black" points="8671.44,-8974.93 8660.84,-8974.74 8669.01,-8981.49 8671.44,-8974.93"/>
</g>
<!-- ring_stage2_3_12 -->
<g id="node1407" class="node">
<title>ring_stage2_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8932,-8978.45 8730,-8978.45 8730,-8925.45 8932,-8925.45 8932,-8978.45"/>
<text text-anchor="middle" x="8831" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="8831" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_9×V_9</text>
<text text-anchor="middle" x="8831" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_2_12&#45;&gt;ring_stage2_3_12 -->
<g id="edge1974" class="edge">
<title>ring_stage2_2_12&#45;&gt;ring_stage2_3_12</title>
<path fill="none" stroke="black" d="M8836.64,-9014.84C8835.89,-9006.63 8835.05,-8997.4 8834.25,-8988.63"/>
<polygon fill="black" stroke="black" points="8837.73,-8988.26 8833.34,-8978.62 8830.76,-8988.9 8837.73,-8988.26"/>
</g>
<!-- kv_send2_2_13 -->
<g id="node1392" class="node">
<title>kv_send2_2_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8344" cy="-8862.21" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8344" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="8344" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_2_13&#45;&gt;kv_send2_2_13 -->
<g id="edge1931" class="edge">
<title>ring_stage2_2_13&#45;&gt;kv_send2_2_13</title>
<path fill="none" stroke="black" d="M8358.11,-8925.1C8356.25,-8916.97 8354.17,-8907.83 8352.18,-8899.12"/>
<polygon fill="black" stroke="black" points="8355.55,-8898.16 8349.92,-8889.18 8348.73,-8899.71 8355.55,-8898.16"/>
</g>
<!-- ring_stage2_3_13 -->
<g id="node1408" class="node">
<title>ring_stage2_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8692,-8888.71 8472,-8888.71 8472,-8835.71 8692,-8835.71 8692,-8888.71"/>
<text text-anchor="middle" x="8582" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="8582" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_10×V_10</text>
<text text-anchor="middle" x="8582" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_2_13&#45;&gt;ring_stage2_3_13 -->
<g id="edge1977" class="edge">
<title>ring_stage2_2_13&#45;&gt;ring_stage2_3_13</title>
<path fill="none" stroke="black" d="M8427.64,-8925.34C8453.05,-8915.11 8482.46,-8903.28 8508.75,-8892.7"/>
<polygon fill="black" stroke="black" points="8510.31,-8895.84 8518.28,-8888.86 8507.7,-8889.35 8510.31,-8895.84"/>
</g>
<!-- kv_send2_2_14 -->
<g id="node1393" class="node">
<title>kv_send2_2_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8106" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8106" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="8106" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_2_14&#45;&gt;kv_send2_2_14 -->
<g id="edge1934" class="edge">
<title>ring_stage2_2_14&#45;&gt;kv_send2_2_14</title>
<path fill="none" stroke="black" d="M8106,-8835.36C8106,-8827.31 8106,-8818.28 8106,-8809.66"/>
<polygon fill="black" stroke="black" points="8109.5,-8809.44 8106,-8799.44 8102.5,-8809.44 8109.5,-8809.44"/>
</g>
<!-- ring_stage2_3_14 -->
<g id="node1409" class="node">
<title>ring_stage2_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8454,-8798.97 8234,-8798.97 8234,-8745.97 8454,-8745.97 8454,-8798.97"/>
<text text-anchor="middle" x="8344" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="8344" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_11×V_11</text>
<text text-anchor="middle" x="8344" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_2_14&#45;&gt;ring_stage2_3_14 -->
<g id="edge1980" class="edge">
<title>ring_stage2_2_14&#45;&gt;ring_stage2_3_14</title>
<path fill="none" stroke="black" d="M8175.48,-8835.6C8203.46,-8825.29 8235.89,-8813.33 8264.78,-8802.68"/>
<polygon fill="black" stroke="black" points="8266.26,-8805.86 8274.43,-8799.12 8263.84,-8799.3 8266.26,-8805.86"/>
</g>
<!-- kv_send2_2_15 -->
<g id="node1394" class="node">
<title>kv_send2_2_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9236" cy="-10118.58" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9236" y="-10122.38" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9236" y="-10107.38" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_2_15&#45;&gt;kv_send2_2_15 -->
<g id="edge1937" class="edge">
<title>ring_stage2_2_15&#45;&gt;kv_send2_2_15</title>
<path fill="none" stroke="black" d="M9202.85,-10181.47C9207.44,-10172.9 9212.62,-10163.22 9217.5,-10154.11"/>
<polygon fill="black" stroke="black" points="9220.61,-10155.71 9222.25,-10145.24 9214.44,-10152.4 9220.61,-10155.71"/>
</g>
<!-- ring_stage2_3_15 -->
<g id="node1410" class="node">
<title>ring_stage2_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8202,-8709.23 7982,-8709.23 7982,-8656.23 8202,-8656.23 8202,-8709.23"/>
<text text-anchor="middle" x="8092" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="8092" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_12×V_12</text>
<text text-anchor="middle" x="8092" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_2_15&#45;&gt;ring_stage2_3_15 -->
<g id="edge1983" class="edge">
<title>ring_stage2_2_15&#45;&gt;ring_stage2_3_15</title>
<path fill="none" stroke="black" d="M9135.16,-10181.76C9062.74,-10144.57 8935.08,-10068.61 8866,-9965.97 8854,-9948.14 8835.88,-9896.89 8830,-9876.23 8812.3,-9813.96 8851.55,-9777.72 8805,-9732.75 8763.21,-9692.37 8600.72,-9716.3 8546,-9696.75 8502.84,-9681.33 8497.34,-9666.5 8458,-9643.01 8294.95,-9545.63 8232.83,-9551.55 8089,-9427.53 7954.1,-9311.2 7977,-9220.83 7977,-9042.7 7977,-9042.7 7977,-9042.7 7977,-8861.21 7977,-8809.64 7959.5,-8789.24 7987,-8745.6 7994.79,-8733.24 8006.02,-8723.05 8018.26,-8714.75"/>
<polygon fill="black" stroke="black" points="8020.29,-8717.61 8026.87,-8709.3 8016.55,-8711.69 8020.29,-8717.61"/>
</g>
<!-- kv_send2_2_0&#45;&gt;ring_stage2_3_1 -->
<g id="edge1942" class="edge">
<title>kv_send2_2_0&#45;&gt;ring_stage2_3_1</title>
<path fill="none" stroke="black" d="M9689.67,-10001.99C9693.82,-9993.51 9698.51,-9983.94 9702.94,-9974.91"/>
<polygon fill="black" stroke="black" points="9706.16,-9976.28 9707.42,-9965.76 9699.88,-9973.2 9706.16,-9976.28"/>
</g>
<!-- kv_send2_2_1&#45;&gt;ring_stage2_3_2 -->
<g id="edge1945" class="edge">
<title>kv_send2_2_1&#45;&gt;ring_stage2_3_2</title>
<path fill="none" stroke="black" d="M10216.32,-9912.72C10225.95,-9903.43 10236.99,-9892.79 10247.18,-9882.96"/>
<polygon fill="black" stroke="black" points="10249.65,-9885.44 10254.42,-9875.98 10244.79,-9880.4 10249.65,-9885.44"/>
</g>
<!-- kv_send2_2_2&#45;&gt;ring_stage2_3_3 -->
<g id="edge1948" class="edge">
<title>kv_send2_2_2&#45;&gt;ring_stage2_3_3</title>
<path fill="none" stroke="black" d="M10805.96,-9830.55C10818.62,-9827.71 10831.66,-9824.91 10844,-9822.49 10941.65,-9803.28 10967.43,-9806.09 11065,-9786.49 11065.46,-9786.39 11065.92,-9786.3 11066.39,-9786.21"/>
<polygon fill="black" stroke="black" points="11067.14,-9789.62 11076.22,-9784.16 11065.72,-9782.77 11067.14,-9789.62"/>
</g>
<!-- kv_send2_2_3&#45;&gt;ring_stage2_3_4 -->
<g id="edge1951" class="edge">
<title>kv_send2_2_3&#45;&gt;ring_stage2_3_4</title>
<path fill="none" stroke="black" d="M10952.7,-9732.29C10952.61,-9724.25 10952.51,-9715.27 10952.41,-9706.72"/>
<polygon fill="black" stroke="black" points="10955.91,-9706.54 10952.29,-9696.58 10948.91,-9706.62 10955.91,-9706.54"/>
</g>
<!-- kv_send2_2_4&#45;&gt;ring_stage2_3_5 -->
<g id="edge1954" class="edge">
<title>kv_send2_2_4&#45;&gt;ring_stage2_3_5</title>
<path fill="none" stroke="black" d="M10480.48,-9643.97C10469.15,-9634.41 10456.05,-9623.36 10444.03,-9613.22"/>
<polygon fill="black" stroke="black" points="10446.22,-9610.49 10436.32,-9606.72 10441.71,-9615.84 10446.22,-9610.49"/>
</g>
<!-- kv_send2_2_5&#45;&gt;ring_stage2_3_6 -->
<g id="edge1957" class="edge">
<title>kv_send2_2_5&#45;&gt;ring_stage2_3_6</title>
<path fill="none" stroke="black" d="M9473.18,-9560.42C9517.76,-9548.53 9576.31,-9532.92 9626.44,-9519.55"/>
<polygon fill="black" stroke="black" points="9627.59,-9522.86 9636.35,-9516.91 9625.78,-9516.1 9627.59,-9522.86"/>
</g>
<!-- kv_send2_2_6&#45;&gt;ring_stage2_3_7 -->
<g id="edge1960" class="edge">
<title>kv_send2_2_6&#45;&gt;ring_stage2_3_7</title>
<path fill="none" stroke="black" d="M10162.8,-9463.07C10163.35,-9455.03 10163.96,-9446.05 10164.55,-9437.5"/>
<polygon fill="black" stroke="black" points="10168.05,-9437.57 10165.24,-9427.36 10161.07,-9437.1 10168.05,-9437.57"/>
</g>
<!-- kv_send2_2_7&#45;&gt;ring_stage2_3_8 -->
<g id="edge1963" class="edge">
<title>kv_send2_2_7&#45;&gt;ring_stage2_3_8</title>
<path fill="none" stroke="black" d="M9726.8,-9373.33C9727.35,-9365.29 9727.96,-9356.31 9728.55,-9347.76"/>
<polygon fill="black" stroke="black" points="9732.05,-9347.83 9729.24,-9337.62 9725.07,-9347.36 9732.05,-9347.83"/>
</g>
<!-- kv_send2_2_8&#45;&gt;ring_stage2_3_9 -->
<g id="edge1966" class="edge">
<title>kv_send2_2_8&#45;&gt;ring_stage2_3_9</title>
<path fill="none" stroke="black" d="M9521.54,-9284.06C9524.29,-9275.76 9527.38,-9266.42 9530.3,-9257.56"/>
<polygon fill="black" stroke="black" points="9533.7,-9258.43 9533.52,-9247.84 9527.06,-9256.24 9533.7,-9258.43"/>
</g>
<!-- kv_send2_2_9&#45;&gt;ring_stage2_3_10 -->
<g id="edge1969" class="edge">
<title>kv_send2_2_9&#45;&gt;ring_stage2_3_10</title>
<path fill="none" stroke="black" d="M9315,-9193.85C9314.08,-9185.81 9313.06,-9176.83 9312.08,-9168.27"/>
<polygon fill="black" stroke="black" points="9315.54,-9167.68 9310.93,-9158.14 9308.58,-9168.47 9315.54,-9167.68"/>
</g>
<!-- kv_send2_2_10&#45;&gt;ring_stage2_3_11 -->
<g id="edge1972" class="edge">
<title>kv_send2_2_10&#45;&gt;ring_stage2_3_11</title>
<path fill="none" stroke="black" d="M9075.7,-9104.11C9074.69,-9096.07 9073.57,-9087.09 9072.49,-9078.53"/>
<polygon fill="black" stroke="black" points="9075.94,-9077.88 9071.22,-9068.4 9068.99,-9078.76 9075.94,-9077.88"/>
</g>
<!-- kv_send2_2_11&#45;&gt;ring_stage2_3_12 -->
<g id="edge1975" class="edge">
<title>kv_send2_2_11&#45;&gt;ring_stage2_3_12</title>
<path fill="none" stroke="black" d="M8442.24,-9022.78C8455.48,-9019.97 8469.11,-9017.21 8482,-9014.82 8584.54,-8995.88 8613.82,-8998.93 8719.95,-8978.96"/>
<polygon fill="black" stroke="black" points="8720.6,-8982.4 8729.77,-8977.09 8719.29,-8975.52 8720.6,-8982.4"/>
</g>
<!-- kv_send2_2_12&#45;&gt;ring_stage2_3_13 -->
<g id="edge1978" class="edge">
<title>kv_send2_2_12&#45;&gt;ring_stage2_3_13</title>
<path fill="none" stroke="black" d="M8596.11,-8925.1C8594.24,-8916.89 8592.13,-8907.66 8590.13,-8898.89"/>
<polygon fill="black" stroke="black" points="8593.49,-8897.85 8587.85,-8888.88 8586.66,-8899.41 8593.49,-8897.85"/>
</g>
<!-- kv_send2_2_13&#45;&gt;ring_stage2_3_14 -->
<g id="edge1981" class="edge">
<title>kv_send2_2_13&#45;&gt;ring_stage2_3_14</title>
<path fill="none" stroke="black" d="M8344,-8834.89C8344,-8826.85 8344,-8817.87 8344,-8809.31"/>
<polygon fill="black" stroke="black" points="8347.5,-8809.18 8344,-8799.18 8340.5,-8809.18 8347.5,-8809.18"/>
</g>
<!-- kv_send2_2_14&#45;&gt;ring_stage2_3_15 -->
<g id="edge1984" class="edge">
<title>kv_send2_2_14&#45;&gt;ring_stage2_3_15</title>
<path fill="none" stroke="black" d="M8101.8,-8745.15C8100.52,-8737.11 8099.08,-8728.13 8097.72,-8719.57"/>
<polygon fill="black" stroke="black" points="8101.13,-8718.76 8096.1,-8709.44 8094.22,-8719.86 8101.13,-8718.76"/>
</g>
<!-- kv_send2_2_15&#45;&gt;ring_stage2_3_0 -->
<g id="edge1939" class="edge">
<title>kv_send2_2_15&#45;&gt;ring_stage2_3_0</title>
<path fill="none" stroke="black" d="M9281.11,-10094.29C9301.42,-10083.81 9325.67,-10071.3 9347.37,-10060.1"/>
<polygon fill="black" stroke="black" points="9349.21,-10063.09 9356.49,-10055.39 9346,-10056.87 9349.21,-10063.09"/>
</g>
<!-- kv_send2_3_0 -->
<g id="node1411" class="node">
<title>kv_send2_3_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9415" cy="-9939.1" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9415" y="-9942.9" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="9415" y="-9927.9" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_3_0&#45;&gt;kv_send2_3_0 -->
<g id="edge1940" class="edge">
<title>ring_stage2_3_0&#45;&gt;kv_send2_3_0</title>
<path fill="none" stroke="black" d="M9408.65,-10001.99C9409.48,-9993.94 9410.4,-9984.91 9411.29,-9976.29"/>
<polygon fill="black" stroke="black" points="9414.8,-9976.37 9412.34,-9966.06 9407.83,-9975.66 9414.8,-9976.37"/>
</g>
<!-- ring_stage2_4_0 -->
<g id="node1427" class="node">
<title>ring_stage2_4_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8197.5,-8529.75 7986.5,-8529.75 7986.5,-8476.75 8197.5,-8476.75 8197.5,-8529.75"/>
<text text-anchor="middle" x="8092" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="8092" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_12×V_12</text>
<text text-anchor="middle" x="8092" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_3_0&#45;&gt;ring_stage2_4_0 -->
<g id="edge1986" class="edge">
<title>ring_stage2_3_0&#45;&gt;ring_stage2_4_0</title>
<path fill="none" stroke="black" d="M9300.42,-10014.11C9154.44,-9992.77 8902.51,-9946.62 8846,-9876.23 8805.48,-9825.75 8859.91,-9784.47 8821,-9732.75 8744.32,-9630.81 8646.21,-9703.69 8563,-9607.01 8519.41,-9556.35 8569.27,-9506.4 8518,-9463.53 8420.4,-9381.9 8351.77,-9475.68 8234,-9427.53 8173.01,-9402.59 8032.93,-9303.91 7998,-9248.05 7948.66,-9169.14 7957,-9135.76 7957,-9042.7 7957,-9042.7 7957,-9042.7 7957,-8681.73 7957,-8629.35 7949.08,-8608.42 7980,-8566.12 7989.14,-8553.62 8001.61,-8543.34 8014.92,-8534.99"/>
<polygon fill="black" stroke="black" points="8016.92,-8537.88 8023.76,-8529.79 8013.37,-8531.85 8016.92,-8537.88"/>
</g>
<!-- kv_send2_3_1 -->
<g id="node1412" class="node">
<title>kv_send2_3_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9758" cy="-9849.36" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9758" y="-9853.16" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="9758" y="-9838.16" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_3_1&#45;&gt;kv_send2_3_1 -->
<g id="edge1943" class="edge">
<title>ring_stage2_3_1&#45;&gt;kv_send2_3_1</title>
<path fill="none" stroke="black" d="M9731.2,-9912.25C9734.8,-9903.93 9738.85,-9894.57 9742.7,-9885.69"/>
<polygon fill="black" stroke="black" points="9745.99,-9886.89 9746.75,-9876.32 9739.57,-9884.11 9745.99,-9886.89"/>
</g>
<!-- ring_stage2_4_1 -->
<g id="node1428" class="node">
<title>ring_stage2_4_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9520.5,-9875.86 9309.5,-9875.86 9309.5,-9822.86 9520.5,-9822.86 9520.5,-9875.86"/>
<text text-anchor="middle" x="9415" y="-9860.66" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9415" y="-9845.66" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_13×V_13</text>
<text text-anchor="middle" x="9415" y="-9830.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_3_1&#45;&gt;ring_stage2_4_1 -->
<g id="edge1989" class="edge">
<title>ring_stage2_3_1&#45;&gt;ring_stage2_4_1</title>
<path fill="none" stroke="black" d="M9630.96,-9912.48C9594.24,-9901.92 9551.55,-9889.64 9513.86,-9878.8"/>
<polygon fill="black" stroke="black" points="9514.46,-9875.33 9503.89,-9875.93 9512.53,-9882.05 9514.46,-9875.33"/>
</g>
<!-- kv_send2_3_2 -->
<g id="node1413" class="node">
<title>kv_send2_3_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10729" cy="-9759.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10729" y="-9763.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="10729" y="-9748.42" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_3_2&#45;&gt;kv_send2_3_2 -->
<g id="edge1946" class="edge">
<title>ring_stage2_3_2&#45;&gt;kv_send2_3_2</title>
<path fill="none" stroke="black" d="M10386.54,-9824.36C10389.73,-9823.72 10392.89,-9823.09 10396,-9822.49 10493.26,-9803.61 10518.77,-9805.55 10616,-9786.49 10625.31,-9784.66 10635.02,-9782.63 10644.67,-9780.53"/>
<polygon fill="black" stroke="black" points="10645.67,-9783.9 10654.68,-9778.33 10644.16,-9777.06 10645.67,-9783.9"/>
</g>
<!-- ring_stage2_4_2 -->
<g id="node1429" class="node">
<title>ring_stage2_4_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10388.5,-9786.12 10177.5,-9786.12 10177.5,-9733.12 10388.5,-9733.12 10388.5,-9786.12"/>
<text text-anchor="middle" x="10283" y="-9770.92" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="10283" y="-9755.92" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_14×V_14</text>
<text text-anchor="middle" x="10283" y="-9740.92" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_3_2&#45;&gt;ring_stage2_4_2 -->
<g id="edge1992" class="edge">
<title>ring_stage2_3_2&#45;&gt;ring_stage2_4_2</title>
<path fill="none" stroke="black" d="M10281.59,-9822.51C10281.78,-9814.29 10281.99,-9805.06 10282.19,-9796.29"/>
<polygon fill="black" stroke="black" points="10285.69,-9796.36 10282.41,-9786.28 10278.69,-9796.2 10285.69,-9796.36"/>
</g>
<!-- kv_send2_3_3 -->
<g id="node1414" class="node">
<title>kv_send2_3_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11399" cy="-9669.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11399" y="-9673.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="11399" y="-9658.68" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_3_3&#45;&gt;kv_send2_3_3 -->
<g id="edge1949" class="edge">
<title>ring_stage2_3_3&#45;&gt;kv_send2_3_3</title>
<path fill="none" stroke="black" d="M11238.98,-9733C11268.84,-9721.41 11304.03,-9707.75 11333.8,-9696.19"/>
<polygon fill="black" stroke="black" points="11335.2,-9699.4 11343.26,-9692.52 11332.67,-9692.87 11335.2,-9699.4"/>
</g>
<!-- ring_stage2_4_3 -->
<g id="node1430" class="node">
<title>ring_stage2_4_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11277.5,-9696.38 11066.5,-9696.38 11066.5,-9643.38 11277.5,-9643.38 11277.5,-9696.38"/>
<text text-anchor="middle" x="11172" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="11172" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_15×V_15</text>
<text text-anchor="middle" x="11172" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_3_3&#45;&gt;ring_stage2_4_3 -->
<g id="edge1995" class="edge">
<title>ring_stage2_3_3&#45;&gt;ring_stage2_4_3</title>
<path fill="none" stroke="black" d="M11172.71,-9732.77C11172.61,-9724.55 11172.51,-9715.32 11172.41,-9706.55"/>
<polygon fill="black" stroke="black" points="11175.91,-9706.5 11172.29,-9696.54 11168.91,-9706.58 11175.91,-9706.5"/>
</g>
<!-- kv_send2_3_4 -->
<g id="node1415" class="node">
<title>kv_send2_3_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10851" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10851" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="10851" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_3_4&#45;&gt;kv_send2_3_4 -->
<g id="edge1952" class="edge">
<title>ring_stage2_3_4&#45;&gt;kv_send2_3_4</title>
<path fill="none" stroke="black" d="M10922.52,-9643.26C10911.54,-9633.73 10898.95,-9622.79 10887.43,-9612.78"/>
<polygon fill="black" stroke="black" points="10889.5,-9609.94 10879.65,-9606.03 10884.91,-9615.23 10889.5,-9609.94"/>
</g>
<!-- ring_stage2_4_4 -->
<g id="node1431" class="node">
<title>ring_stage2_4_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11395.5,-9606.64 11202.5,-9606.64 11202.5,-9553.64 11395.5,-9553.64 11395.5,-9606.64"/>
<text text-anchor="middle" x="11299" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="11299" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_0×V_0</text>
<text text-anchor="middle" x="11299" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_3_4&#45;&gt;ring_stage2_4_4 -->
<g id="edge1998" class="edge">
<title>ring_stage2_3_4&#45;&gt;ring_stage2_4_4</title>
<path fill="none" stroke="black" d="M11048.66,-9644.44C11093.31,-9633.14 11146.47,-9619.7 11192.3,-9608.12"/>
<polygon fill="black" stroke="black" points="11193.42,-9611.44 11202.26,-9605.6 11191.71,-9604.66 11193.42,-9611.44"/>
</g>
<!-- kv_send2_3_5 -->
<g id="node1416" class="node">
<title>kv_send2_3_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10405" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10405" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10405" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_3_5&#45;&gt;kv_send2_3_5 -->
<g id="edge1955" class="edge">
<title>ring_stage2_3_5&#45;&gt;kv_send2_3_5</title>
<path fill="none" stroke="black" d="M10405.71,-9553.29C10405.61,-9545.24 10405.51,-9536.21 10405.41,-9527.58"/>
<polygon fill="black" stroke="black" points="10408.91,-9527.32 10405.3,-9517.36 10401.91,-9527.4 10408.91,-9527.32"/>
</g>
<!-- ring_stage2_4_5 -->
<g id="node1432" class="node">
<title>ring_stage2_4_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-9516.9 10526.5,-9516.9 10526.5,-9463.9 10719.5,-9463.9 10719.5,-9516.9"/>
<text text-anchor="middle" x="10623" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="10623" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_1×V_1</text>
<text text-anchor="middle" x="10623" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_3_5&#45;&gt;ring_stage2_4_5 -->
<g id="edge2001" class="edge">
<title>ring_stage2_3_5&#45;&gt;ring_stage2_4_5</title>
<path fill="none" stroke="black" d="M10469.35,-9553.52C10494.64,-9543.3 10523.92,-9531.46 10550.08,-9520.88"/>
<polygon fill="black" stroke="black" points="10551.61,-9524.03 10559.57,-9517.04 10548.99,-9517.55 10551.61,-9524.03"/>
</g>
<!-- kv_send2_3_6 -->
<g id="node1417" class="node">
<title>kv_send2_3_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9949" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9949" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="9949" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_3_6&#45;&gt;kv_send2_3_6 -->
<g id="edge1958" class="edge">
<title>ring_stage2_3_6&#45;&gt;kv_send2_3_6</title>
<path fill="none" stroke="black" d="M9795.35,-9463.78C9823.67,-9452.33 9856.99,-9438.86 9885.35,-9427.39"/>
<polygon fill="black" stroke="black" points="9886.8,-9430.58 9894.76,-9423.59 9884.18,-9424.09 9886.8,-9430.58"/>
</g>
<!-- ring_stage2_4_6 -->
<g id="node1433" class="node">
<title>ring_stage2_4_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10501.5,-9427.16 10308.5,-9427.16 10308.5,-9374.16 10501.5,-9374.16 10501.5,-9427.16"/>
<text text-anchor="middle" x="10405" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="10405" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_2×V_2</text>
<text text-anchor="middle" x="10405" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_3_6&#45;&gt;ring_stage2_4_6 -->
<g id="edge2004" class="edge">
<title>ring_stage2_3_6&#45;&gt;ring_stage2_4_6</title>
<path fill="none" stroke="black" d="M9828.63,-9465.15C9831.79,-9464.57 9834.91,-9464.03 9838,-9463.53 10029.49,-9432.43 10080.85,-9454.22 10273,-9427.53 10281.23,-9426.38 10289.72,-9425.06 10298.24,-9423.62"/>
<polygon fill="black" stroke="black" points="10298.99,-9427.05 10308.25,-9421.89 10297.8,-9420.15 10298.99,-9427.05"/>
</g>
<!-- kv_send2_3_7 -->
<g id="node1418" class="node">
<title>kv_send2_3_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9949" cy="-9310.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9949" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="9949" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_3_7&#45;&gt;kv_send2_3_7 -->
<g id="edge1961" class="edge">
<title>ring_stage2_3_7&#45;&gt;kv_send2_3_7</title>
<path fill="none" stroke="black" d="M10103.36,-9374.04C10074.91,-9362.59 10041.43,-9349.12 10012.94,-9337.65"/>
<polygon fill="black" stroke="black" points="10014.07,-9334.33 10003.49,-9333.85 10011.46,-9340.83 10014.07,-9334.33"/>
</g>
<!-- ring_stage2_4_7 -->
<g id="node1434" class="node">
<title>ring_stage2_4_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10263.5,-9337.42 10070.5,-9337.42 10070.5,-9284.42 10263.5,-9284.42 10263.5,-9337.42"/>
<text text-anchor="middle" x="10167" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="10167" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_3×V_3</text>
<text text-anchor="middle" x="10167" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_3_7&#45;&gt;ring_stage2_4_7 -->
<g id="edge2007" class="edge">
<title>ring_stage2_3_7&#45;&gt;ring_stage2_4_7</title>
<path fill="none" stroke="black" d="M10167,-9373.81C10167,-9365.59 10167,-9356.36 10167,-9347.59"/>
<polygon fill="black" stroke="black" points="10170.5,-9347.58 10167,-9337.58 10163.5,-9347.58 10170.5,-9347.58"/>
</g>
<!-- kv_send2_3_8 -->
<g id="node1419" class="node">
<title>kv_send2_3_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9760" cy="-9221.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9760" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="9760" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_3_8&#45;&gt;kv_send2_3_8 -->
<g id="edge1964" class="edge">
<title>ring_stage2_3_8&#45;&gt;kv_send2_3_8</title>
<path fill="none" stroke="black" d="M9739.54,-9284.06C9742.26,-9275.84 9745.32,-9266.59 9748.23,-9257.8"/>
<polygon fill="black" stroke="black" points="9751.6,-9258.74 9751.42,-9248.14 9744.96,-9256.54 9751.6,-9258.74"/>
</g>
<!-- ring_stage2_4_8 -->
<g id="node1435" class="node">
<title>ring_stage2_4_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10074.5,-9247.68 9881.5,-9247.68 9881.5,-9194.68 10074.5,-9194.68 10074.5,-9247.68"/>
<text text-anchor="middle" x="9978" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9978" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_4×V_4</text>
<text text-anchor="middle" x="9978" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_3_8&#45;&gt;ring_stage2_4_8 -->
<g id="edge2010" class="edge">
<title>ring_stage2_3_8&#45;&gt;ring_stage2_4_8</title>
<path fill="none" stroke="black" d="M9803.11,-9284.3C9832.27,-9273.94 9866.09,-9261.93 9896.18,-9251.24"/>
<polygon fill="black" stroke="black" points="9897.55,-9254.47 9905.8,-9247.82 9895.21,-9247.87 9897.55,-9254.47"/>
</g>
<!-- kv_send2_3_9 -->
<g id="node1420" class="node">
<title>kv_send2_3_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9537" cy="-9131.44" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9537" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9537" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_3_9&#45;&gt;kv_send2_3_9 -->
<g id="edge1967" class="edge">
<title>ring_stage2_3_9&#45;&gt;kv_send2_3_9</title>
<path fill="none" stroke="black" d="M9540.53,-9194.32C9540.07,-9186.27 9539.55,-9177.25 9539.06,-9168.62"/>
<polygon fill="black" stroke="black" points="9542.54,-9168.19 9538.48,-9158.4 9535.55,-9168.59 9542.54,-9168.19"/>
</g>
<!-- ring_stage2_4_9 -->
<g id="node1436" class="node">
<title>ring_stage2_4_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9857.5,-9157.94 9664.5,-9157.94 9664.5,-9104.94 9857.5,-9104.94 9857.5,-9157.94"/>
<text text-anchor="middle" x="9761" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9761" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_5×V_5</text>
<text text-anchor="middle" x="9761" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_3_9&#45;&gt;ring_stage2_4_9 -->
<g id="edge2013" class="edge">
<title>ring_stage2_3_9&#45;&gt;ring_stage2_4_9</title>
<path fill="none" stroke="black" d="M9605.93,-9194.56C9631.46,-9184.34 9661,-9172.5 9687.41,-9161.92"/>
<polygon fill="black" stroke="black" points="9689.01,-9165.05 9696.99,-9158.08 9686.4,-9158.55 9689.01,-9165.05"/>
</g>
<!-- kv_send2_3_10 -->
<g id="node1421" class="node">
<title>kv_send2_3_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9297" cy="-9041.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9297" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9297" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_3_10&#45;&gt;kv_send2_3_10 -->
<g id="edge1970" class="edge">
<title>ring_stage2_3_10&#45;&gt;kv_send2_3_10</title>
<path fill="none" stroke="black" d="M9304.76,-9104.58C9303.74,-9096.45 9302.59,-9087.31 9301.5,-9078.6"/>
<polygon fill="black" stroke="black" points="9304.97,-9078.15 9300.26,-9068.66 9298.03,-9079.02 9304.97,-9078.15"/>
</g>
<!-- ring_stage2_4_10 -->
<g id="node1437" class="node">
<title>ring_stage2_4_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9627,-9068.2 9425,-9068.2 9425,-9015.2 9627,-9015.2 9627,-9068.2"/>
<text text-anchor="middle" x="9526" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9526" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_6×V_6</text>
<text text-anchor="middle" x="9526" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_3_10&#45;&gt;ring_stage2_4_10 -->
<g id="edge2016" class="edge">
<title>ring_stage2_3_10&#45;&gt;ring_stage2_4_10</title>
<path fill="none" stroke="black" d="M9371.64,-9104.82C9397.05,-9094.6 9426.46,-9082.76 9452.75,-9072.18"/>
<polygon fill="black" stroke="black" points="9454.31,-9075.32 9462.28,-9068.34 9451.7,-9068.83 9454.31,-9075.32"/>
</g>
<!-- kv_send2_3_11 -->
<g id="node1422" class="node">
<title>kv_send2_3_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9060" cy="-8951.95" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9060" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9060" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_3_11&#45;&gt;kv_send2_3_11 -->
<g id="edge1973" class="edge">
<title>ring_stage2_3_11&#45;&gt;kv_send2_3_11</title>
<path fill="none" stroke="black" d="M9065.64,-9014.84C9064.91,-9006.79 9064.09,-8997.76 9063.3,-8989.14"/>
<polygon fill="black" stroke="black" points="9066.76,-8988.56 9062.37,-8978.92 9059.79,-8989.2 9066.76,-8988.56"/>
</g>
<!-- ring_stage2_4_11 -->
<g id="node1438" class="node">
<title>ring_stage2_4_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9390,-8978.45 9188,-8978.45 9188,-8925.45 9390,-8925.45 9390,-8978.45"/>
<text text-anchor="middle" x="9289" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9289" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_7×V_7</text>
<text text-anchor="middle" x="9289" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_3_11&#45;&gt;ring_stage2_4_11 -->
<g id="edge2019" class="edge">
<title>ring_stage2_3_11&#45;&gt;ring_stage2_4_11</title>
<path fill="none" stroke="black" d="M9132.52,-9015.08C9158.39,-9004.81 9188.35,-8992.91 9215.09,-8982.3"/>
<polygon fill="black" stroke="black" points="9216.4,-8985.54 9224.4,-8978.6 9213.82,-8979.04 9216.4,-8985.54"/>
</g>
<!-- kv_send2_3_12 -->
<g id="node1423" class="node">
<title>kv_send2_3_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8821" cy="-8862.21" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8821" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="8821" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_3_12&#45;&gt;kv_send2_3_12 -->
<g id="edge1976" class="edge">
<title>ring_stage2_3_12&#45;&gt;kv_send2_3_12</title>
<path fill="none" stroke="black" d="M8828.05,-8925.1C8827.13,-8916.97 8826.08,-8907.83 8825.09,-8899.12"/>
<polygon fill="black" stroke="black" points="8828.57,-8898.72 8823.96,-8889.18 8821.61,-8899.52 8828.57,-8898.72"/>
</g>
<!-- ring_stage2_4_12 -->
<g id="node1439" class="node">
<title>ring_stage2_4_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9151,-8888.71 8949,-8888.71 8949,-8835.71 9151,-8835.71 9151,-8888.71"/>
<text text-anchor="middle" x="9050" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="9050" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_8×V_8</text>
<text text-anchor="middle" x="9050" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_3_12&#45;&gt;ring_stage2_4_12 -->
<g id="edge2022" class="edge">
<title>ring_stage2_3_12&#45;&gt;ring_stage2_4_12</title>
<path fill="none" stroke="black" d="M8894.93,-8925.34C8920.46,-8915.11 8950,-8903.28 8976.41,-8892.7"/>
<polygon fill="black" stroke="black" points="8978.01,-8895.83 8985.99,-8888.86 8975.4,-8889.33 8978.01,-8895.83"/>
</g>
<!-- kv_send2_3_13 -->
<g id="node1424" class="node">
<title>kv_send2_3_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8582" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8582" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="8582" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_3_13&#45;&gt;kv_send2_3_13 -->
<g id="edge1979" class="edge">
<title>ring_stage2_3_13&#45;&gt;kv_send2_3_13</title>
<path fill="none" stroke="black" d="M8582,-8835.36C8582,-8827.31 8582,-8818.28 8582,-8809.66"/>
<polygon fill="black" stroke="black" points="8585.5,-8809.44 8582,-8799.44 8578.5,-8809.44 8585.5,-8809.44"/>
</g>
<!-- ring_stage2_4_13 -->
<g id="node1440" class="node">
<title>ring_stage2_4_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8912,-8798.97 8710,-8798.97 8710,-8745.97 8912,-8745.97 8912,-8798.97"/>
<text text-anchor="middle" x="8811" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="8811" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_9×V_9</text>
<text text-anchor="middle" x="8811" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_3_13&#45;&gt;ring_stage2_4_13 -->
<g id="edge2025" class="edge">
<title>ring_stage2_3_13&#45;&gt;ring_stage2_4_13</title>
<path fill="none" stroke="black" d="M8648.85,-8835.6C8675.66,-8825.33 8706.71,-8813.43 8734.42,-8802.82"/>
<polygon fill="black" stroke="black" points="8735.98,-8805.97 8744.07,-8799.12 8733.47,-8799.43 8735.98,-8805.97"/>
</g>
<!-- kv_send2_3_14 -->
<g id="node1425" class="node">
<title>kv_send2_3_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8330" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8330" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="8330" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_3_14&#45;&gt;kv_send2_3_14 -->
<g id="edge1982" class="edge">
<title>ring_stage2_3_14&#45;&gt;kv_send2_3_14</title>
<path fill="none" stroke="black" d="M8339.88,-8745.62C8338.58,-8737.49 8337.12,-8728.35 8335.73,-8719.64"/>
<polygon fill="black" stroke="black" points="8339.18,-8719.03 8334.14,-8709.7 8332.26,-8720.13 8339.18,-8719.03"/>
</g>
<!-- ring_stage2_4_14 -->
<g id="node1441" class="node">
<title>ring_stage2_4_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8678,-8709.23 8458,-8709.23 8458,-8656.23 8678,-8656.23 8678,-8709.23"/>
<text text-anchor="middle" x="8568" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="8568" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_10×V_10</text>
<text text-anchor="middle" x="8568" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_3_14&#45;&gt;ring_stage2_4_14 -->
<g id="edge2028" class="edge">
<title>ring_stage2_3_14&#45;&gt;ring_stage2_4_14</title>
<path fill="none" stroke="black" d="M8409.39,-8745.86C8435.61,-8735.59 8465.98,-8723.69 8493.09,-8713.08"/>
<polygon fill="black" stroke="black" points="8494.49,-8716.29 8502.53,-8709.38 8491.94,-8709.77 8494.49,-8716.29"/>
</g>
<!-- kv_send2_3_15 -->
<g id="node1426" class="node">
<title>kv_send2_3_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8092" cy="-8592.99" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8092" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8092" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_3_15&#45;&gt;kv_send2_3_15 -->
<g id="edge1985" class="edge">
<title>ring_stage2_3_15&#45;&gt;kv_send2_3_15</title>
<path fill="none" stroke="black" d="M8092,-8655.88C8092,-8647.83 8092,-8638.8 8092,-8630.18"/>
<polygon fill="black" stroke="black" points="8095.5,-8629.96 8092,-8619.96 8088.5,-8629.96 8095.5,-8629.96"/>
</g>
<!-- ring_stage2_4_15 -->
<g id="node1442" class="node">
<title>ring_stage2_4_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8435,-8619.49 8215,-8619.49 8215,-8566.49 8435,-8566.49 8435,-8619.49"/>
<text text-anchor="middle" x="8325" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="8325" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_11×V_11</text>
<text text-anchor="middle" x="8325" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_3_15&#45;&gt;ring_stage2_4_15 -->
<g id="edge2031" class="edge">
<title>ring_stage2_3_15&#45;&gt;ring_stage2_4_15</title>
<path fill="none" stroke="black" d="M8160.02,-8656.12C8187.41,-8645.8 8219.16,-8633.85 8247.45,-8623.2"/>
<polygon fill="black" stroke="black" points="8248.77,-8626.44 8256.9,-8619.64 8246.3,-8619.89 8248.77,-8626.44"/>
</g>
<!-- kv_send2_3_0&#45;&gt;ring_stage2_4_1 -->
<g id="edge1990" class="edge">
<title>kv_send2_3_0&#45;&gt;ring_stage2_4_1</title>
<path fill="none" stroke="black" d="M9415,-9911.77C9415,-9903.73 9415,-9894.75 9415,-9886.2"/>
<polygon fill="black" stroke="black" points="9418.5,-9886.06 9415,-9876.06 9411.5,-9886.06 9418.5,-9886.06"/>
</g>
<!-- kv_send2_3_1&#45;&gt;ring_stage2_4_2 -->
<g id="edge1993" class="edge">
<title>kv_send2_3_1&#45;&gt;ring_stage2_4_2</title>
<path fill="none" stroke="black" d="M9834.28,-9831.15C9849.39,-9828.03 9865.16,-9824.98 9880,-9822.49 10003.98,-9801.63 10039.15,-9808.3 10167.28,-9786.53"/>
<polygon fill="black" stroke="black" points="10168.23,-9789.92 10177.49,-9784.77 10167.04,-9783.02 10168.23,-9789.92"/>
</g>
<!-- kv_send2_3_2&#45;&gt;ring_stage2_4_3 -->
<g id="edge1996" class="edge">
<title>kv_send2_3_2&#45;&gt;ring_stage2_4_3</title>
<path fill="none" stroke="black" d="M10802.96,-9740.84C10815.62,-9738 10828.67,-9735.19 10841,-9732.75 10933.81,-9714.35 10960.37,-9715.47 11056.61,-9696.97"/>
<polygon fill="black" stroke="black" points="11057.31,-9700.4 11066.46,-9695.06 11055.98,-9693.53 11057.31,-9700.4"/>
</g>
<!-- kv_send2_3_3&#45;&gt;ring_stage2_4_4 -->
<g id="edge1999" class="edge">
<title>kv_send2_3_3&#45;&gt;ring_stage2_4_4</title>
<path fill="none" stroke="black" d="M11370.61,-9643.97C11359.82,-9634.5 11347.37,-9623.57 11335.9,-9613.51"/>
<polygon fill="black" stroke="black" points="11337.98,-9610.68 11328.16,-9606.72 11333.36,-9615.94 11337.98,-9610.68"/>
</g>
<!-- kv_send2_3_4&#45;&gt;ring_stage2_4_5 -->
<g id="edge2002" class="edge">
<title>kv_send2_3_4&#45;&gt;ring_stage2_4_5</title>
<path fill="none" stroke="black" d="M10794.93,-9557.56C10766.02,-9546.43 10730.33,-9532.7 10698.97,-9520.63"/>
<polygon fill="black" stroke="black" points="10699.98,-9517.27 10689.39,-9516.94 10697.47,-9523.8 10699.98,-9517.27"/>
</g>
<!-- kv_send2_3_5&#45;&gt;ring_stage2_4_6 -->
<g id="edge2005" class="edge">
<title>kv_send2_3_5&#45;&gt;ring_stage2_4_6</title>
<path fill="none" stroke="black" d="M10405,-9463.07C10405,-9455.03 10405,-9446.05 10405,-9437.5"/>
<polygon fill="black" stroke="black" points="10408.5,-9437.36 10405,-9427.36 10401.5,-9437.36 10408.5,-9437.36"/>
</g>
<!-- kv_send2_3_6&#45;&gt;ring_stage2_4_7 -->
<g id="edge2008" class="edge">
<title>kv_send2_3_6&#45;&gt;ring_stage2_4_7</title>
<path fill="none" stroke="black" d="M10003.45,-9377.74C10030.87,-9366.7 10064.51,-9353.17 10094.13,-9341.25"/>
<polygon fill="black" stroke="black" points="10095.62,-9344.42 10103.59,-9337.44 10093.01,-9337.92 10095.62,-9344.42"/>
</g>
<!-- kv_send2_3_7&#45;&gt;ring_stage2_4_8 -->
<g id="edge2011" class="edge">
<title>kv_send2_3_7&#45;&gt;ring_stage2_4_8</title>
<path fill="none" stroke="black" d="M9957.54,-9284.06C9960.29,-9275.76 9963.38,-9266.42 9966.3,-9257.56"/>
<polygon fill="black" stroke="black" points="9969.7,-9258.43 9969.52,-9247.84 9963.06,-9256.24 9969.7,-9258.43"/>
</g>
<!-- kv_send2_3_8&#45;&gt;ring_stage2_4_9 -->
<g id="edge2014" class="edge">
<title>kv_send2_3_8&#45;&gt;ring_stage2_4_9</title>
<path fill="none" stroke="black" d="M9760.3,-9193.85C9760.39,-9185.81 9760.49,-9176.83 9760.59,-9168.27"/>
<polygon fill="black" stroke="black" points="9764.09,-9168.18 9760.71,-9158.14 9757.09,-9168.1 9764.09,-9168.18"/>
</g>
<!-- kv_send2_3_9&#45;&gt;ring_stage2_4_10 -->
<g id="edge2017" class="edge">
<title>kv_send2_3_9&#45;&gt;ring_stage2_4_10</title>
<path fill="none" stroke="black" d="M9533.7,-9104.11C9532.69,-9096.07 9531.57,-9087.09 9530.49,-9078.53"/>
<polygon fill="black" stroke="black" points="9533.94,-9077.88 9529.22,-9068.4 9526.99,-9078.76 9533.94,-9077.88"/>
</g>
<!-- kv_send2_3_10&#45;&gt;ring_stage2_4_11 -->
<g id="edge2020" class="edge">
<title>kv_send2_3_10&#45;&gt;ring_stage2_4_11</title>
<path fill="none" stroke="black" d="M9294.6,-9014.37C9293.87,-9006.33 9293.05,-8997.35 9292.27,-8988.79"/>
<polygon fill="black" stroke="black" points="9295.74,-8988.3 9291.34,-8978.66 9288.77,-8988.93 9295.74,-8988.3"/>
</g>
<!-- kv_send2_3_11&#45;&gt;ring_stage2_4_12 -->
<g id="edge2023" class="edge">
<title>kv_send2_3_11&#45;&gt;ring_stage2_4_12</title>
<path fill="none" stroke="black" d="M9057,-8924.63C9056.08,-8916.59 9055.06,-8907.61 9054.08,-8899.05"/>
<polygon fill="black" stroke="black" points="9057.54,-8898.46 9052.93,-8888.92 9050.58,-8899.25 9057.54,-8898.46"/>
</g>
<!-- kv_send2_3_12&#45;&gt;ring_stage2_4_13 -->
<g id="edge2026" class="edge">
<title>kv_send2_3_12&#45;&gt;ring_stage2_4_13</title>
<path fill="none" stroke="black" d="M8818,-8834.89C8817.08,-8826.85 8816.06,-8817.87 8815.08,-8809.31"/>
<polygon fill="black" stroke="black" points="8818.54,-8808.72 8813.93,-8799.18 8811.58,-8809.51 8818.54,-8808.72"/>
</g>
<!-- kv_send2_3_13&#45;&gt;ring_stage2_4_14 -->
<g id="edge2029" class="edge">
<title>kv_send2_3_13&#45;&gt;ring_stage2_4_14</title>
<path fill="none" stroke="black" d="M8577.8,-8745.15C8576.52,-8737.11 8575.08,-8728.13 8573.72,-8719.57"/>
<polygon fill="black" stroke="black" points="8577.13,-8718.76 8572.1,-8709.44 8570.22,-8719.86 8577.13,-8718.76"/>
</g>
<!-- kv_send2_3_14&#45;&gt;ring_stage2_4_15 -->
<g id="edge2032" class="edge">
<title>kv_send2_3_14&#45;&gt;ring_stage2_4_15</title>
<path fill="none" stroke="black" d="M8328.5,-8655.41C8328.04,-8647.37 8327.53,-8638.39 8327.04,-8629.83"/>
<polygon fill="black" stroke="black" points="8330.53,-8629.48 8326.46,-8619.7 8323.54,-8629.88 8330.53,-8629.48"/>
</g>
<!-- kv_send2_3_15&#45;&gt;ring_stage2_4_0 -->
<g id="edge1987" class="edge">
<title>kv_send2_3_15&#45;&gt;ring_stage2_4_0</title>
<path fill="none" stroke="black" d="M8092,-8565.67C8092,-8557.63 8092,-8548.65 8092,-8540.09"/>
<polygon fill="black" stroke="black" points="8095.5,-8539.96 8092,-8529.96 8088.5,-8539.96 8095.5,-8539.96"/>
</g>
<!-- kv_send2_4_0 -->
<g id="node1443" class="node">
<title>kv_send2_4_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8092" cy="-8413.51" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8092" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8092" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_4_0&#45;&gt;kv_send2_4_0 -->
<g id="edge1988" class="edge">
<title>ring_stage2_4_0&#45;&gt;kv_send2_4_0</title>
<path fill="none" stroke="black" d="M8092,-8476.4C8092,-8468.35 8092,-8459.32 8092,-8450.7"/>
<polygon fill="black" stroke="black" points="8095.5,-8450.48 8092,-8440.48 8088.5,-8450.48 8095.5,-8450.48"/>
</g>
<!-- ring_stage2_5_0 -->
<g id="node1459" class="node">
<title>ring_stage2_5_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8425.5,-8440.01 8214.5,-8440.01 8214.5,-8387.01 8425.5,-8387.01 8425.5,-8440.01"/>
<text text-anchor="middle" x="8320" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="8320" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_11×V_11</text>
<text text-anchor="middle" x="8320" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_4_0&#45;&gt;ring_stage2_5_0 -->
<g id="edge2034" class="edge">
<title>ring_stage2_4_0&#45;&gt;ring_stage2_5_0</title>
<path fill="none" stroke="black" d="M8158.56,-8476.64C8185.25,-8466.37 8216.16,-8454.47 8243.75,-8443.86"/>
<polygon fill="black" stroke="black" points="8245.28,-8447.02 8253.36,-8440.16 8242.77,-8440.49 8245.28,-8447.02"/>
</g>
<!-- kv_send2_4_1 -->
<g id="node1444" class="node">
<title>kv_send2_4_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10056" cy="-9759.62" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10056" y="-9763.42" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="10056" y="-9748.42" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_4_1&#45;&gt;kv_send2_4_1 -->
<g id="edge1991" class="edge">
<title>ring_stage2_4_1&#45;&gt;kv_send2_4_1</title>
<path fill="none" stroke="black" d="M9520.53,-9836.32C9668.89,-9819.35 9923.44,-9790.05 9944,-9786.49 9953.51,-9784.84 9963.43,-9782.89 9973.26,-9780.81"/>
<polygon fill="black" stroke="black" points="9974,-9784.23 9983.04,-9778.69 9972.52,-9777.39 9974,-9784.23"/>
</g>
<!-- ring_stage2_5_1 -->
<g id="node1460" class="node">
<title>ring_stage2_5_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8197.5,-8350.27 7986.5,-8350.27 7986.5,-8297.27 8197.5,-8297.27 8197.5,-8350.27"/>
<text text-anchor="middle" x="8092" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="8092" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_12×V_12</text>
<text text-anchor="middle" x="8092" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_4_1&#45;&gt;ring_stage2_5_1 -->
<g id="edge2037" class="edge">
<title>ring_stage2_4_1&#45;&gt;ring_stage2_5_1</title>
<path fill="none" stroke="black" d="M9394.17,-9822.63C9370.14,-9795.02 9327.86,-9752.49 9281,-9732.75 9108.76,-9660.17 9045.59,-9731.8 8862,-9696.75 8692.98,-9664.48 8283.68,-9515.83 8136,-9427.53 8129.19,-9423.46 8030.33,-9343.66 8025,-9337.79 7933.1,-9236.37 7937,-9179.55 7937,-9042.7 7937,-9042.7 7937,-9042.7 7937,-8502.25 7937,-8447.43 7944.22,-8428.18 7980,-8386.64 7990.69,-8374.24 8004.5,-8363.85 8018.76,-8355.34"/>
<polygon fill="black" stroke="black" points="8020.7,-8358.27 8027.67,-8350.29 8017.25,-8352.18 8020.7,-8358.27"/>
</g>
<!-- kv_send2_4_2 -->
<g id="node1445" class="node">
<title>kv_send2_4_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10734" cy="-9669.88" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10734" y="-9673.68" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="10734" y="-9658.68" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_4_2&#45;&gt;kv_send2_4_2 -->
<g id="edge1994" class="edge">
<title>ring_stage2_4_2&#45;&gt;kv_send2_4_2</title>
<path fill="none" stroke="black" d="M10388.74,-9735.89C10394.24,-9734.81 10399.68,-9733.75 10405,-9732.75 10501.06,-9714.6 10526.1,-9715.76 10622,-9696.75 10631.15,-9694.93 10640.7,-9692.92 10650.19,-9690.84"/>
<polygon fill="black" stroke="black" points="10651.04,-9694.23 10660.04,-9688.65 10649.52,-9687.4 10651.04,-9694.23"/>
</g>
<!-- ring_stage2_5_2 -->
<g id="node1461" class="node">
<title>ring_stage2_5_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10388.5,-9696.38 10177.5,-9696.38 10177.5,-9643.38 10388.5,-9643.38 10388.5,-9696.38"/>
<text text-anchor="middle" x="10283" y="-9681.18" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="10283" y="-9666.18" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_13×V_13</text>
<text text-anchor="middle" x="10283" y="-9651.18" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_4_2&#45;&gt;ring_stage2_5_2 -->
<g id="edge2040" class="edge">
<title>ring_stage2_4_2&#45;&gt;ring_stage2_5_2</title>
<path fill="none" stroke="black" d="M10283,-9732.77C10283,-9724.55 10283,-9715.32 10283,-9706.55"/>
<polygon fill="black" stroke="black" points="10286.5,-9706.54 10283,-9696.54 10279.5,-9706.54 10286.5,-9706.54"/>
</g>
<!-- kv_send2_4_3 -->
<g id="node1446" class="node">
<title>kv_send2_4_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11521" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11521" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="11521" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_4_3&#45;&gt;kv_send2_4_3 -->
<g id="edge1997" class="edge">
<title>ring_stage2_4_3&#45;&gt;kv_send2_4_3</title>
<path fill="none" stroke="black" d="M11273.88,-9643.26C11326.3,-9630.08 11389.37,-9614.23 11438.67,-9601.83"/>
<polygon fill="black" stroke="black" points="11439.81,-9605.16 11448.65,-9599.32 11438.1,-9598.37 11439.81,-9605.16"/>
</g>
<!-- ring_stage2_5_3 -->
<g id="node1462" class="node">
<title>ring_stage2_5_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11184.5,-9606.64 10973.5,-9606.64 10973.5,-9553.64 11184.5,-9553.64 11184.5,-9606.64"/>
<text text-anchor="middle" x="11079" y="-9591.44" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="11079" y="-9576.44" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_14×V_14</text>
<text text-anchor="middle" x="11079" y="-9561.44" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_4_3&#45;&gt;ring_stage2_5_3 -->
<g id="edge2043" class="edge">
<title>ring_stage2_4_3&#45;&gt;ring_stage2_5_3</title>
<path fill="none" stroke="black" d="M11144.6,-9643.03C11134.86,-9633.83 11123.76,-9623.36 11113.5,-9613.68"/>
<polygon fill="black" stroke="black" points="11115.88,-9611.12 11106.2,-9606.8 11111.08,-9616.21 11115.88,-9611.12"/>
</g>
<!-- kv_send2_4_4 -->
<g id="node1447" class="node">
<title>kv_send2_4_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11070" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11070" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="11070" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_4_4&#45;&gt;kv_send2_4_4 -->
<g id="edge2000" class="edge">
<title>ring_stage2_4_4&#45;&gt;kv_send2_4_4</title>
<path fill="none" stroke="black" d="M11232.15,-9553.52C11201.89,-9541.93 11166.23,-9528.27 11136.07,-9516.71"/>
<polygon fill="black" stroke="black" points="11137.07,-9513.35 11126.48,-9513.04 11134.57,-9519.88 11137.07,-9513.35"/>
</g>
<!-- ring_stage2_5_4 -->
<g id="node1463" class="node">
<title>ring_stage2_5_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11626.5,-9516.9 11415.5,-9516.9 11415.5,-9463.9 11626.5,-9463.9 11626.5,-9516.9"/>
<text text-anchor="middle" x="11521" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="11521" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_15×V_15</text>
<text text-anchor="middle" x="11521" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_4_4&#45;&gt;ring_stage2_5_4 -->
<g id="edge2046" class="edge">
<title>ring_stage2_4_4&#45;&gt;ring_stage2_5_4</title>
<path fill="none" stroke="black" d="M11363.81,-9553.52C11389.8,-9543.25 11419.9,-9531.35 11446.76,-9520.74"/>
<polygon fill="black" stroke="black" points="11448.1,-9523.97 11456.11,-9517.04 11445.52,-9517.46 11448.1,-9523.97"/>
</g>
<!-- kv_send2_4_5 -->
<g id="node1448" class="node">
<title>kv_send2_4_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10623" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10623" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10623" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_4_5&#45;&gt;kv_send2_4_5 -->
<g id="edge2003" class="edge">
<title>ring_stage2_4_5&#45;&gt;kv_send2_4_5</title>
<path fill="none" stroke="black" d="M10623,-9463.55C10623,-9455.5 10623,-9446.47 10623,-9437.84"/>
<polygon fill="black" stroke="black" points="10626.5,-9437.62 10623,-9427.62 10619.5,-9437.62 10626.5,-9437.62"/>
</g>
<!-- ring_stage2_5_5 -->
<g id="node1464" class="node">
<title>ring_stage2_5_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10958.5,-9427.16 10765.5,-9427.16 10765.5,-9374.16 10958.5,-9374.16 10958.5,-9427.16"/>
<text text-anchor="middle" x="10862" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="10862" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_0×V_0</text>
<text text-anchor="middle" x="10862" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_4_5&#45;&gt;ring_stage2_5_5 -->
<g id="edge2049" class="edge">
<title>ring_stage2_4_5&#45;&gt;ring_stage2_5_5</title>
<path fill="none" stroke="black" d="M10692.77,-9463.78C10720.87,-9453.47 10753.44,-9441.51 10782.45,-9430.86"/>
<polygon fill="black" stroke="black" points="10783.96,-9434.03 10792.14,-9427.3 10781.55,-9427.46 10783.96,-9434.03"/>
</g>
<!-- kv_send2_4_6 -->
<g id="node1449" class="node">
<title>kv_send2_4_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10405" cy="-9310.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10405" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10405" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_4_6&#45;&gt;kv_send2_4_6 -->
<g id="edge2006" class="edge">
<title>ring_stage2_4_6&#45;&gt;kv_send2_4_6</title>
<path fill="none" stroke="black" d="M10405,-9373.81C10405,-9365.76 10405,-9356.73 10405,-9348.1"/>
<polygon fill="black" stroke="black" points="10408.5,-9347.88 10405,-9337.88 10401.5,-9347.88 10408.5,-9347.88"/>
</g>
<!-- ring_stage2_5_6 -->
<g id="node1465" class="node">
<title>ring_stage2_5_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-9337.42 10526.5,-9337.42 10526.5,-9284.42 10719.5,-9284.42 10719.5,-9337.42"/>
<text text-anchor="middle" x="10623" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="10623" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_1×V_1</text>
<text text-anchor="middle" x="10623" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_4_6&#45;&gt;ring_stage2_5_6 -->
<g id="edge2052" class="edge">
<title>ring_stage2_4_6&#45;&gt;ring_stage2_5_6</title>
<path fill="none" stroke="black" d="M10468.64,-9374.04C10494.05,-9363.82 10523.46,-9351.98 10549.75,-9341.4"/>
<polygon fill="black" stroke="black" points="10551.31,-9344.54 10559.28,-9337.56 10548.7,-9338.05 10551.31,-9344.54"/>
</g>
<!-- kv_send2_4_7 -->
<g id="node1450" class="node">
<title>kv_send2_4_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10196" cy="-9221.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10196" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="10196" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_4_7&#45;&gt;kv_send2_4_7 -->
<g id="edge2009" class="edge">
<title>ring_stage2_4_7&#45;&gt;kv_send2_4_7</title>
<path fill="none" stroke="black" d="M10175.54,-9284.06C10178.26,-9275.84 10181.32,-9266.59 10184.23,-9257.8"/>
<polygon fill="black" stroke="black" points="10187.6,-9258.74 10187.42,-9248.14 10180.96,-9256.54 10187.6,-9258.74"/>
</g>
<!-- ring_stage2_5_7 -->
<g id="node1466" class="node">
<title>ring_stage2_5_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10531.5,-9247.68 10338.5,-9247.68 10338.5,-9194.68 10531.5,-9194.68 10531.5,-9247.68"/>
<text text-anchor="middle" x="10435" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="10435" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_2×V_2</text>
<text text-anchor="middle" x="10435" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_4_7&#45;&gt;ring_stage2_5_7 -->
<g id="edge2055" class="edge">
<title>ring_stage2_4_7&#45;&gt;ring_stage2_5_7</title>
<path fill="none" stroke="black" d="M10245.24,-9284.3C10277.16,-9273.85 10314.22,-9261.72 10347.07,-9250.96"/>
<polygon fill="black" stroke="black" points="10348.25,-9254.26 10356.67,-9247.82 10346.07,-9247.61 10348.25,-9254.26"/>
</g>
<!-- kv_send2_4_8 -->
<g id="node1451" class="node">
<title>kv_send2_4_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9979" cy="-9131.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9979" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="9979" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_4_8&#45;&gt;kv_send2_4_8 -->
<g id="edge2012" class="edge">
<title>ring_stage2_4_8&#45;&gt;kv_send2_4_8</title>
<path fill="none" stroke="black" d="M9978.29,-9194.32C9978.39,-9186.27 9978.49,-9177.25 9978.59,-9168.62"/>
<polygon fill="black" stroke="black" points="9982.09,-9168.44 9978.7,-9158.4 9975.09,-9168.36 9982.09,-9168.44"/>
</g>
<!-- ring_stage2_5_8 -->
<g id="node1467" class="node">
<title>ring_stage2_5_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10294.5,-9157.94 10101.5,-9157.94 10101.5,-9104.94 10294.5,-9104.94 10294.5,-9157.94"/>
<text text-anchor="middle" x="10198" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="10198" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_3×V_3</text>
<text text-anchor="middle" x="10198" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_4_8&#45;&gt;ring_stage2_5_8 -->
<g id="edge2058" class="edge">
<title>ring_stage2_4_8&#45;&gt;ring_stage2_5_8</title>
<path fill="none" stroke="black" d="M10042.22,-9194.56C10067.87,-9184.34 10097.55,-9172.5 10124.08,-9161.92"/>
<polygon fill="black" stroke="black" points="10125.7,-9165.04 10133.7,-9158.08 10123.11,-9158.53 10125.7,-9165.04"/>
</g>
<!-- kv_send2_4_9 -->
<g id="node1452" class="node">
<title>kv_send2_4_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9755" cy="-9041.7" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9755" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9755" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_4_9&#45;&gt;kv_send2_4_9 -->
<g id="edge2015" class="edge">
<title>ring_stage2_4_9&#45;&gt;kv_send2_4_9</title>
<path fill="none" stroke="black" d="M9759.23,-9104.58C9758.68,-9096.53 9758.06,-9087.51 9757.47,-9078.88"/>
<polygon fill="black" stroke="black" points="9760.95,-9078.4 9756.78,-9068.66 9753.97,-9078.88 9760.95,-9078.4"/>
</g>
<!-- ring_stage2_5_9 -->
<g id="node1468" class="node">
<title>ring_stage2_5_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10075.5,-9068.2 9882.5,-9068.2 9882.5,-9015.2 10075.5,-9015.2 10075.5,-9068.2"/>
<text text-anchor="middle" x="9979" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="9979" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_4×V_4</text>
<text text-anchor="middle" x="9979" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_4_9&#45;&gt;ring_stage2_5_9 -->
<g id="edge2061" class="edge">
<title>ring_stage2_4_9&#45;&gt;ring_stage2_5_9</title>
<path fill="none" stroke="black" d="M9824.64,-9104.82C9850.05,-9094.6 9879.46,-9082.76 9905.75,-9072.18"/>
<polygon fill="black" stroke="black" points="9907.31,-9075.32 9915.28,-9068.34 9904.7,-9068.83 9907.31,-9075.32"/>
</g>
<!-- kv_send2_4_10 -->
<g id="node1453" class="node">
<title>kv_send2_4_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9518" cy="-8951.95" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9518" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9518" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_4_10&#45;&gt;kv_send2_4_10 -->
<g id="edge2018" class="edge">
<title>ring_stage2_4_10&#45;&gt;kv_send2_4_10</title>
<path fill="none" stroke="black" d="M9523.64,-9014.84C9522.91,-9006.79 9522.09,-8997.76 9521.3,-8989.14"/>
<polygon fill="black" stroke="black" points="9524.76,-8988.56 9520.37,-8978.92 9517.79,-8989.2 9524.76,-8988.56"/>
</g>
<!-- ring_stage2_5_10 -->
<g id="node1469" class="node">
<title>ring_stage2_5_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9848,-8978.45 9646,-8978.45 9646,-8925.45 9848,-8925.45 9848,-8978.45"/>
<text text-anchor="middle" x="9747" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="9747" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_5×V_5</text>
<text text-anchor="middle" x="9747" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_4_10&#45;&gt;ring_stage2_5_10 -->
<g id="edge2064" class="edge">
<title>ring_stage2_4_10&#45;&gt;ring_stage2_5_10</title>
<path fill="none" stroke="black" d="M9590.52,-9015.08C9616.39,-9004.81 9646.35,-8992.91 9673.09,-8982.3"/>
<polygon fill="black" stroke="black" points="9674.4,-8985.54 9682.4,-8978.6 9671.82,-8979.04 9674.4,-8985.54"/>
</g>
<!-- kv_send2_4_11 -->
<g id="node1454" class="node">
<title>kv_send2_4_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9279" cy="-8862.21" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9279" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9279" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_4_11&#45;&gt;kv_send2_4_11 -->
<g id="edge2021" class="edge">
<title>ring_stage2_4_11&#45;&gt;kv_send2_4_11</title>
<path fill="none" stroke="black" d="M9286.05,-8925.1C9285.13,-8916.97 9284.08,-8907.83 9283.09,-8899.12"/>
<polygon fill="black" stroke="black" points="9286.57,-8898.72 9281.96,-8889.18 9279.61,-8899.52 9286.57,-8898.72"/>
</g>
<!-- ring_stage2_5_11 -->
<g id="node1470" class="node">
<title>ring_stage2_5_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9609,-8888.71 9407,-8888.71 9407,-8835.71 9609,-8835.71 9609,-8888.71"/>
<text text-anchor="middle" x="9508" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="9508" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_6×V_6</text>
<text text-anchor="middle" x="9508" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_4_11&#45;&gt;ring_stage2_5_11 -->
<g id="edge2067" class="edge">
<title>ring_stage2_4_11&#45;&gt;ring_stage2_5_11</title>
<path fill="none" stroke="black" d="M9352.93,-8925.34C9378.46,-8915.11 9408,-8903.28 9434.41,-8892.7"/>
<polygon fill="black" stroke="black" points="9436.01,-8895.83 9443.99,-8888.86 9433.4,-8889.33 9436.01,-8895.83"/>
</g>
<!-- kv_send2_4_12 -->
<g id="node1455" class="node">
<title>kv_send2_4_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9040" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9040" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="9040" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_4_12&#45;&gt;kv_send2_4_12 -->
<g id="edge2024" class="edge">
<title>ring_stage2_4_12&#45;&gt;kv_send2_4_12</title>
<path fill="none" stroke="black" d="M9047.05,-8835.36C9046.13,-8827.23 9045.08,-8818.09 9044.09,-8809.38"/>
<polygon fill="black" stroke="black" points="9047.57,-8808.98 9042.96,-8799.44 9040.61,-8809.78 9047.57,-8808.98"/>
</g>
<!-- ring_stage2_5_12 -->
<g id="node1471" class="node">
<title>ring_stage2_5_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9370,-8798.97 9168,-8798.97 9168,-8745.97 9370,-8745.97 9370,-8798.97"/>
<text text-anchor="middle" x="9269" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="9269" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_7×V_7</text>
<text text-anchor="middle" x="9269" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_4_12&#45;&gt;ring_stage2_5_12 -->
<g id="edge2070" class="edge">
<title>ring_stage2_4_12&#45;&gt;ring_stage2_5_12</title>
<path fill="none" stroke="black" d="M9113.93,-8835.6C9139.46,-8825.37 9169,-8813.54 9195.41,-8802.96"/>
<polygon fill="black" stroke="black" points="9197.01,-8806.09 9204.99,-8799.12 9194.4,-8799.59 9197.01,-8806.09"/>
</g>
<!-- kv_send2_4_13 -->
<g id="node1456" class="node">
<title>kv_send2_4_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8806" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8806" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="8806" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_4_13&#45;&gt;kv_send2_4_13 -->
<g id="edge2027" class="edge">
<title>ring_stage2_4_13&#45;&gt;kv_send2_4_13</title>
<path fill="none" stroke="black" d="M8809.53,-8745.62C8809.07,-8737.57 8808.55,-8728.54 8808.06,-8719.92"/>
<polygon fill="black" stroke="black" points="8811.54,-8719.49 8807.48,-8709.7 8804.55,-8719.89 8811.54,-8719.49"/>
</g>
<!-- ring_stage2_5_13 -->
<g id="node1472" class="node">
<title>ring_stage2_5_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9136,-8709.23 8934,-8709.23 8934,-8656.23 9136,-8656.23 9136,-8709.23"/>
<text text-anchor="middle" x="9035" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="9035" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_8×V_8</text>
<text text-anchor="middle" x="9035" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_4_13&#45;&gt;ring_stage2_5_13 -->
<g id="edge2073" class="edge">
<title>ring_stage2_4_13&#45;&gt;ring_stage2_5_13</title>
<path fill="none" stroke="black" d="M8876.39,-8745.86C8902.61,-8735.59 8932.98,-8723.69 8960.09,-8713.08"/>
<polygon fill="black" stroke="black" points="8961.49,-8716.29 8969.53,-8709.38 8958.94,-8709.77 8961.49,-8716.29"/>
</g>
<!-- kv_send2_4_14 -->
<g id="node1457" class="node">
<title>kv_send2_4_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8564" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8564" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="8564" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_4_14&#45;&gt;kv_send2_4_14 -->
<g id="edge2030" class="edge">
<title>ring_stage2_4_14&#45;&gt;kv_send2_4_14</title>
<path fill="none" stroke="black" d="M8566.82,-8655.88C8566.45,-8647.83 8566.04,-8638.8 8565.65,-8630.18"/>
<polygon fill="black" stroke="black" points="8569.14,-8629.79 8565.18,-8619.96 8562.14,-8630.11 8569.14,-8629.79"/>
</g>
<!-- ring_stage2_5_14 -->
<g id="node1473" class="node">
<title>ring_stage2_5_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8894,-8619.49 8692,-8619.49 8692,-8566.49 8894,-8566.49 8894,-8619.49"/>
<text text-anchor="middle" x="8793" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="8793" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_9×V_9</text>
<text text-anchor="middle" x="8793" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_4_14&#45;&gt;ring_stage2_5_14 -->
<g id="edge2076" class="edge">
<title>ring_stage2_4_14&#45;&gt;ring_stage2_5_14</title>
<path fill="none" stroke="black" d="M8633.68,-8656.12C8660.02,-8645.85 8690.53,-8633.95 8717.75,-8623.34"/>
<polygon fill="black" stroke="black" points="8719.19,-8626.53 8727.23,-8619.64 8716.65,-8620.01 8719.19,-8626.53"/>
</g>
<!-- kv_send2_4_15 -->
<g id="node1458" class="node">
<title>kv_send2_4_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8320" cy="-8503.25" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8320" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8320" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_4_15&#45;&gt;kv_send2_4_15 -->
<g id="edge2033" class="edge">
<title>ring_stage2_4_15&#45;&gt;kv_send2_4_15</title>
<path fill="none" stroke="black" d="M8323.53,-8566.14C8323.07,-8558.09 8322.55,-8549.06 8322.06,-8540.44"/>
<polygon fill="black" stroke="black" points="8325.54,-8540.01 8321.48,-8530.22 8318.55,-8540.41 8325.54,-8540.01"/>
</g>
<!-- ring_stage2_5_15 -->
<g id="node1474" class="node">
<title>ring_stage2_5_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8662,-8529.75 8442,-8529.75 8442,-8476.75 8662,-8476.75 8662,-8529.75"/>
<text text-anchor="middle" x="8552" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="8552" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_10×V_10</text>
<text text-anchor="middle" x="8552" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_4_15&#45;&gt;ring_stage2_5_15 -->
<g id="edge2079" class="edge">
<title>ring_stage2_4_15&#45;&gt;ring_stage2_5_15</title>
<path fill="none" stroke="black" d="M8391.27,-8566.38C8417.84,-8556.11 8448.62,-8544.21 8476.08,-8533.6"/>
<polygon fill="black" stroke="black" points="8477.58,-8536.77 8485.65,-8529.9 8475.06,-8530.24 8477.58,-8536.77"/>
</g>
<!-- kv_send2_4_0&#45;&gt;ring_stage2_5_1 -->
<g id="edge2038" class="edge">
<title>kv_send2_4_0&#45;&gt;ring_stage2_5_1</title>
<path fill="none" stroke="black" d="M8092,-8386.19C8092,-8378.15 8092,-8369.17 8092,-8360.61"/>
<polygon fill="black" stroke="black" points="8095.5,-8360.48 8092,-8350.48 8088.5,-8360.48 8095.5,-8360.48"/>
</g>
<!-- kv_send2_4_1&#45;&gt;ring_stage2_5_2 -->
<g id="edge2041" class="edge">
<title>kv_send2_4_1&#45;&gt;ring_stage2_5_2</title>
<path fill="none" stroke="black" d="M10112.11,-9736.93C10140.79,-9725.84 10176.09,-9712.2 10207.16,-9700.19"/>
<polygon fill="black" stroke="black" points="10208.58,-9703.39 10216.65,-9696.52 10206.06,-9696.86 10208.58,-9703.39"/>
</g>
<!-- kv_send2_4_2&#45;&gt;ring_stage2_5_3 -->
<g id="edge2044" class="edge">
<title>kv_send2_4_2&#45;&gt;ring_stage2_5_3</title>
<path fill="none" stroke="black" d="M10805.9,-9650.59C10852.94,-9638.63 10915.31,-9622.76 10968.57,-9609.22"/>
<polygon fill="black" stroke="black" points="10969.58,-9612.58 10978.41,-9606.72 10967.85,-9605.79 10969.58,-9612.58"/>
</g>
<!-- kv_send2_4_3&#45;&gt;ring_stage2_5_4 -->
<g id="edge2047" class="edge">
<title>kv_send2_4_3&#45;&gt;ring_stage2_5_4</title>
<path fill="none" stroke="black" d="M11521,-9552.81C11521,-9544.77 11521,-9535.79 11521,-9527.24"/>
<polygon fill="black" stroke="black" points="11524.5,-9527.1 11521,-9517.1 11517.5,-9527.1 11524.5,-9527.1"/>
</g>
<!-- kv_send2_4_4&#45;&gt;ring_stage2_5_5 -->
<g id="edge2050" class="edge">
<title>kv_send2_4_4&#45;&gt;ring_stage2_5_5</title>
<path fill="none" stroke="black" d="M11017.51,-9467.26C10991.56,-9456.31 10959.89,-9442.95 10931.91,-9431.15"/>
<polygon fill="black" stroke="black" points="10933.16,-9427.87 10922.58,-9427.21 10930.43,-9434.32 10933.16,-9427.87"/>
</g>
<!-- kv_send2_4_5&#45;&gt;ring_stage2_5_6 -->
<g id="edge2053" class="edge">
<title>kv_send2_4_5&#45;&gt;ring_stage2_5_6</title>
<path fill="none" stroke="black" d="M10623,-9373.33C10623,-9365.29 10623,-9356.31 10623,-9347.76"/>
<polygon fill="black" stroke="black" points="10626.5,-9347.62 10623,-9337.62 10619.5,-9347.62 10626.5,-9347.62"/>
</g>
<!-- kv_send2_4_6&#45;&gt;ring_stage2_5_7 -->
<g id="edge2056" class="edge">
<title>kv_send2_4_6&#45;&gt;ring_stage2_5_7</title>
<path fill="none" stroke="black" d="M10413.84,-9284.06C10416.68,-9275.76 10419.87,-9266.42 10422.9,-9257.56"/>
<polygon fill="black" stroke="black" points="10426.3,-9258.44 10426.22,-9247.84 10419.68,-9256.17 10426.3,-9258.44"/>
</g>
<!-- kv_send2_4_7&#45;&gt;ring_stage2_5_8 -->
<g id="edge2059" class="edge">
<title>kv_send2_4_7&#45;&gt;ring_stage2_5_8</title>
<path fill="none" stroke="black" d="M10196.6,-9193.85C10196.78,-9185.81 10196.99,-9176.83 10197.18,-9168.27"/>
<polygon fill="black" stroke="black" points="10200.69,-9168.21 10197.41,-9158.14 10193.69,-9168.06 10200.69,-9168.21"/>
</g>
<!-- kv_send2_4_8&#45;&gt;ring_stage2_5_9 -->
<g id="edge2062" class="edge">
<title>kv_send2_4_8&#45;&gt;ring_stage2_5_9</title>
<path fill="none" stroke="black" d="M9979,-9104.11C9979,-9096.07 9979,-9087.09 9979,-9078.53"/>
<polygon fill="black" stroke="black" points="9982.5,-9078.4 9979,-9068.4 9975.5,-9078.4 9982.5,-9078.4"/>
</g>
<!-- kv_send2_4_9&#45;&gt;ring_stage2_5_10 -->
<g id="edge2065" class="edge">
<title>kv_send2_4_9&#45;&gt;ring_stage2_5_10</title>
<path fill="none" stroke="black" d="M9752.6,-9014.37C9751.87,-9006.33 9751.05,-8997.35 9750.27,-8988.79"/>
<polygon fill="black" stroke="black" points="9753.74,-8988.3 9749.34,-8978.66 9746.77,-8988.93 9753.74,-8988.3"/>
</g>
<!-- kv_send2_4_10&#45;&gt;ring_stage2_5_11 -->
<g id="edge2068" class="edge">
<title>kv_send2_4_10&#45;&gt;ring_stage2_5_11</title>
<path fill="none" stroke="black" d="M9515,-8924.63C9514.08,-8916.59 9513.06,-8907.61 9512.08,-8899.05"/>
<polygon fill="black" stroke="black" points="9515.54,-8898.46 9510.93,-8888.92 9508.58,-8899.25 9515.54,-8898.46"/>
</g>
<!-- kv_send2_4_11&#45;&gt;ring_stage2_5_12 -->
<g id="edge2071" class="edge">
<title>kv_send2_4_11&#45;&gt;ring_stage2_5_12</title>
<path fill="none" stroke="black" d="M9276,-8834.89C9275.08,-8826.85 9274.06,-8817.87 9273.08,-8809.31"/>
<polygon fill="black" stroke="black" points="9276.54,-8808.72 9271.93,-8799.18 9269.58,-8809.51 9276.54,-8808.72"/>
</g>
<!-- kv_send2_4_12&#45;&gt;ring_stage2_5_13 -->
<g id="edge2074" class="edge">
<title>kv_send2_4_12&#45;&gt;ring_stage2_5_13</title>
<path fill="none" stroke="black" d="M9038.5,-8745.15C9038.04,-8737.11 9037.53,-8728.13 9037.04,-8719.57"/>
<polygon fill="black" stroke="black" points="9040.53,-8719.22 9036.46,-8709.44 9033.54,-8719.62 9040.53,-8719.22"/>
</g>
<!-- kv_send2_4_13&#45;&gt;ring_stage2_5_14 -->
<g id="edge2077" class="edge">
<title>kv_send2_4_13&#45;&gt;ring_stage2_5_14</title>
<path fill="none" stroke="black" d="M8802.1,-8655.41C8800.91,-8647.37 8799.58,-8638.39 8798.31,-8629.83"/>
<polygon fill="black" stroke="black" points="8801.74,-8629.08 8796.81,-8619.7 8794.81,-8630.1 8801.74,-8629.08"/>
</g>
<!-- kv_send2_4_14&#45;&gt;ring_stage2_5_15 -->
<g id="edge2080" class="edge">
<title>kv_send2_4_14&#45;&gt;ring_stage2_5_15</title>
<path fill="none" stroke="black" d="M8560.4,-8565.67C8559.3,-8557.63 8558.07,-8548.65 8556.9,-8540.09"/>
<polygon fill="black" stroke="black" points="8560.34,-8539.39 8555.52,-8529.96 8553.4,-8540.34 8560.34,-8539.39"/>
</g>
<!-- kv_send2_4_15&#45;&gt;ring_stage2_5_0 -->
<g id="edge2035" class="edge">
<title>kv_send2_4_15&#45;&gt;ring_stage2_5_0</title>
<path fill="none" stroke="black" d="M8320,-8475.93C8320,-8467.89 8320,-8458.91 8320,-8450.35"/>
<polygon fill="black" stroke="black" points="8323.5,-8450.22 8320,-8440.22 8316.5,-8450.22 8323.5,-8450.22"/>
</g>
<!-- kv_send2_5_0 -->
<g id="node1475" class="node">
<title>kv_send2_5_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8319" cy="-8323.77" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8319" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8319" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_5_0&#45;&gt;kv_send2_5_0 -->
<g id="edge2036" class="edge">
<title>ring_stage2_5_0&#45;&gt;kv_send2_5_0</title>
<path fill="none" stroke="black" d="M8319.71,-8386.66C8319.61,-8378.61 8319.51,-8369.58 8319.41,-8360.96"/>
<polygon fill="black" stroke="black" points="8322.91,-8360.7 8319.3,-8350.74 8315.91,-8360.78 8322.91,-8360.7"/>
</g>
<!-- ring_stage2_6_0 -->
<g id="node1491" class="node">
<title>ring_stage2_6_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8651.5,-8350.27 8440.5,-8350.27 8440.5,-8297.27 8651.5,-8297.27 8651.5,-8350.27"/>
<text text-anchor="middle" x="8546" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="8546" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_10×V_10</text>
<text text-anchor="middle" x="8546" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_5_0&#45;&gt;ring_stage2_6_0 -->
<g id="edge2082" class="edge">
<title>ring_stage2_5_0&#45;&gt;ring_stage2_6_0</title>
<path fill="none" stroke="black" d="M8385.98,-8386.9C8412.43,-8376.63 8443.07,-8364.73 8470.42,-8354.12"/>
<polygon fill="black" stroke="black" points="8471.89,-8357.3 8479.94,-8350.42 8469.35,-8350.78 8471.89,-8357.3"/>
</g>
<!-- kv_send2_5_1 -->
<g id="node1476" class="node">
<title>kv_send2_5_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8769" cy="-8234.03" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8769" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8769" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_5_1&#45;&gt;kv_send2_5_1 -->
<g id="edge2039" class="edge">
<title>ring_stage2_5_1&#45;&gt;kv_send2_5_1</title>
<path fill="none" stroke="black" d="M8197.79,-8298.38C8200.89,-8297.86 8203.97,-8297.36 8207,-8296.9 8405.37,-8266.81 8458.72,-8291.56 8657,-8260.9 8666.76,-8259.39 8676.94,-8257.5 8687,-8255.43"/>
<polygon fill="black" stroke="black" points="8687.95,-8258.81 8697,-8253.31 8686.5,-8251.96 8687.95,-8258.81"/>
</g>
<!-- ring_stage2_6_1 -->
<g id="node1492" class="node">
<title>ring_stage2_6_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8207.5,-8260.53 7996.5,-8260.53 7996.5,-8207.53 8207.5,-8207.53 8207.5,-8260.53"/>
<text text-anchor="middle" x="8102" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="8102" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_11×V_11</text>
<text text-anchor="middle" x="8102" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_5_1&#45;&gt;ring_stage2_6_1 -->
<g id="edge2085" class="edge">
<title>ring_stage2_5_1&#45;&gt;ring_stage2_6_1</title>
<path fill="none" stroke="black" d="M8094.95,-8296.92C8095.88,-8288.71 8096.93,-8279.48 8097.93,-8270.71"/>
<polygon fill="black" stroke="black" points="8101.42,-8271.03 8099.07,-8260.7 8094.46,-8270.24 8101.42,-8271.03"/>
</g>
<!-- kv_send2_5_2 -->
<g id="node1477" class="node">
<title>kv_send2_5_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10626" cy="-9580.14" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10626" y="-9583.94" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="10626" y="-9568.94" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_5_2&#45;&gt;kv_send2_5_2 -->
<g id="edge2042" class="edge">
<title>ring_stage2_5_2&#45;&gt;kv_send2_5_2</title>
<path fill="none" stroke="black" d="M10383.13,-9643.26C10434.37,-9630.15 10495.96,-9614.4 10544.3,-9602.04"/>
<polygon fill="black" stroke="black" points="10545.27,-9605.4 10554.09,-9599.53 10543.54,-9598.62 10545.27,-9605.4"/>
</g>
<!-- ring_stage2_6_2 -->
<g id="node1493" class="node">
<title>ring_stage2_6_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9550.5,-8170.79 9339.5,-8170.79 9339.5,-8117.79 9550.5,-8117.79 9550.5,-8170.79"/>
<text text-anchor="middle" x="9445" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9445" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_12×V_12</text>
<text text-anchor="middle" x="9445" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_5_2&#45;&gt;ring_stage2_6_2 -->
<g id="edge2088" class="edge">
<title>ring_stage2_5_2&#45;&gt;ring_stage2_6_2</title>
<path fill="none" stroke="black" d="M10283,-9643.31C10283,-9608.82 10283,-9545.47 10283,-9491.4 10283,-9491.4 10283,-9491.4 10283,-9399.66 10283,-9348.08 10280.71,-9334.13 10293,-9284.05 10297.13,-9267.21 10304.6,-9265.04 10308,-9248.05 10312.68,-9224.62 10308.53,-9218.18 10308,-9194.31 10307.11,-9154.39 10330.22,-9134.68 10304,-9104.57 10246.13,-9038.1 10168.6,-9133.48 10109,-9068.57 10065.67,-9021.37 10138.79,-8971.85 10095,-8925.08 10027.58,-8853.08 9952.16,-8951.78 9876,-8889.08 9856.32,-8872.89 9875.68,-8851.54 9856,-8835.34 9779.84,-8772.65 9706.46,-8869.38 9637,-8799.34 9625.33,-8787.57 9572.46,-8220.77 9563,-8207.16 9554.22,-8194.55 9542.06,-8184.31 9528.84,-8176.07"/>
<polygon fill="black" stroke="black" points="9530.44,-8172.95 9520.04,-8170.94 9526.92,-8179 9530.44,-8172.95"/>
</g>
<!-- kv_send2_5_3 -->
<g id="node1478" class="node">
<title>kv_send2_5_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11294" cy="-9490.4" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11294" y="-9494.2" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="11294" y="-9479.2" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_5_3&#45;&gt;kv_send2_5_3 -->
<g id="edge2045" class="edge">
<title>ring_stage2_5_3&#45;&gt;kv_send2_5_3</title>
<path fill="none" stroke="black" d="M11141.76,-9553.52C11169.72,-9542.12 11202.58,-9528.7 11230.6,-9517.27"/>
<polygon fill="black" stroke="black" points="11231.97,-9520.49 11239.91,-9513.47 11229.32,-9514.01 11231.97,-9520.49"/>
</g>
<!-- ring_stage2_6_3 -->
<g id="node1494" class="node">
<title>ring_stage2_6_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10948.5,-9516.9 10737.5,-9516.9 10737.5,-9463.9 10948.5,-9463.9 10948.5,-9516.9"/>
<text text-anchor="middle" x="10843" y="-9501.7" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="10843" y="-9486.7" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_13×V_13</text>
<text text-anchor="middle" x="10843" y="-9471.7" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_5_3&#45;&gt;ring_stage2_6_3 -->
<g id="edge2091" class="edge">
<title>ring_stage2_5_3&#45;&gt;ring_stage2_6_3</title>
<path fill="none" stroke="black" d="M11010.1,-9553.52C10982.36,-9543.21 10950.2,-9531.25 10921.55,-9520.6"/>
<polygon fill="black" stroke="black" points="10922.57,-9517.25 10911.98,-9517.04 10920.13,-9523.81 10922.57,-9517.25"/>
</g>
<!-- kv_send2_5_4 -->
<g id="node1479" class="node">
<title>kv_send2_5_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11307" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11307" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="11307" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_5_4&#45;&gt;kv_send2_5_4 -->
<g id="edge2048" class="edge">
<title>ring_stage2_5_4&#45;&gt;kv_send2_5_4</title>
<path fill="none" stroke="black" d="M11458.53,-9463.78C11430.71,-9452.38 11398,-9438.96 11370.1,-9427.53"/>
<polygon fill="black" stroke="black" points="11371.42,-9424.29 11360.84,-9423.73 11368.77,-9430.76 11371.42,-9424.29"/>
</g>
<!-- ring_stage2_6_4 -->
<g id="node1495" class="node">
<title>ring_stage2_6_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11640.5,-9427.16 11429.5,-9427.16 11429.5,-9374.16 11640.5,-9374.16 11640.5,-9427.16"/>
<text text-anchor="middle" x="11535" y="-9411.96" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="11535" y="-9396.96" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_14×V_14</text>
<text text-anchor="middle" x="11535" y="-9381.96" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_5_4&#45;&gt;ring_stage2_6_4 -->
<g id="edge2094" class="edge">
<title>ring_stage2_5_4&#45;&gt;ring_stage2_6_4</title>
<path fill="none" stroke="black" d="M11525.12,-9463.55C11526.43,-9455.33 11527.91,-9446.1 11529.31,-9437.33"/>
<polygon fill="black" stroke="black" points="11532.79,-9437.75 11530.9,-9427.32 11525.87,-9436.64 11532.79,-9437.75"/>
</g>
<!-- kv_send2_5_5 -->
<g id="node1480" class="node">
<title>kv_send2_5_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10861" cy="-9310.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10861" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10861" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_5_5&#45;&gt;kv_send2_5_5 -->
<g id="edge2051" class="edge">
<title>ring_stage2_5_5&#45;&gt;kv_send2_5_5</title>
<path fill="none" stroke="black" d="M10861.71,-9373.81C10861.61,-9365.76 10861.51,-9356.73 10861.41,-9348.1"/>
<polygon fill="black" stroke="black" points="10864.91,-9347.84 10861.3,-9337.88 10857.91,-9347.92 10864.91,-9347.84"/>
</g>
<!-- ring_stage2_6_5 -->
<g id="node1496" class="node">
<title>ring_stage2_6_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11193.5,-9337.42 10982.5,-9337.42 10982.5,-9284.42 11193.5,-9284.42 11193.5,-9337.42"/>
<text text-anchor="middle" x="11088" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="11088" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_15×V_15</text>
<text text-anchor="middle" x="11088" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_5_5&#45;&gt;ring_stage2_6_5 -->
<g id="edge2097" class="edge">
<title>ring_stage2_5_5&#45;&gt;ring_stage2_6_5</title>
<path fill="none" stroke="black" d="M10927.98,-9374.04C10954.43,-9363.77 10985.07,-9351.87 11012.42,-9341.26"/>
<polygon fill="black" stroke="black" points="11013.89,-9344.44 11021.94,-9337.56 11011.35,-9337.92 11013.89,-9344.44"/>
</g>
<!-- kv_send2_5_6 -->
<g id="node1481" class="node">
<title>kv_send2_5_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10654" cy="-9221.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10654" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10654" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_5_6&#45;&gt;kv_send2_5_6 -->
<g id="edge2054" class="edge">
<title>ring_stage2_5_6&#45;&gt;kv_send2_5_6</title>
<path fill="none" stroke="black" d="M10632.13,-9284.06C10635.04,-9275.84 10638.31,-9266.59 10641.41,-9257.8"/>
<polygon fill="black" stroke="black" points="10644.79,-9258.74 10644.82,-9248.14 10638.19,-9256.41 10644.79,-9258.74"/>
</g>
<!-- ring_stage2_6_6 -->
<g id="node1497" class="node">
<title>ring_stage2_6_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10991.5,-9247.68 10798.5,-9247.68 10798.5,-9194.68 10991.5,-9194.68 10991.5,-9247.68"/>
<text text-anchor="middle" x="10895" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="10895" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_0×V_0</text>
<text text-anchor="middle" x="10895" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_5_6&#45;&gt;ring_stage2_6_6 -->
<g id="edge2100" class="edge">
<title>ring_stage2_5_6&#45;&gt;ring_stage2_6_6</title>
<path fill="none" stroke="black" d="M10702.4,-9284.3C10734.8,-9273.85 10772.41,-9261.72 10805.76,-9250.96"/>
<polygon fill="black" stroke="black" points="10807.05,-9254.22 10815.5,-9247.82 10804.9,-9247.56 10807.05,-9254.22"/>
</g>
<!-- kv_send2_5_7 -->
<g id="node1482" class="node">
<title>kv_send2_5_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10439" cy="-9131.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10439" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="10439" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_5_7&#45;&gt;kv_send2_5_7 -->
<g id="edge2057" class="edge">
<title>ring_stage2_5_7&#45;&gt;kv_send2_5_7</title>
<path fill="none" stroke="black" d="M10436.18,-9194.32C10436.55,-9186.27 10436.96,-9177.25 10437.35,-9168.62"/>
<polygon fill="black" stroke="black" points="10440.86,-9168.55 10437.82,-9158.4 10433.86,-9168.23 10440.86,-9168.55"/>
</g>
<!-- ring_stage2_6_7 -->
<g id="node1498" class="node">
<title>ring_stage2_6_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10753.5,-9157.94 10560.5,-9157.94 10560.5,-9104.94 10753.5,-9104.94 10753.5,-9157.94"/>
<text text-anchor="middle" x="10657" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="10657" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_1×V_1</text>
<text text-anchor="middle" x="10657" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_5_7&#45;&gt;ring_stage2_6_7 -->
<g id="edge2103" class="edge">
<title>ring_stage2_5_7&#45;&gt;ring_stage2_6_7</title>
<path fill="none" stroke="black" d="M10499.81,-9194.56C10525.8,-9184.29 10555.9,-9172.39 10582.76,-9161.78"/>
<polygon fill="black" stroke="black" points="10584.1,-9165.01 10592.11,-9158.08 10581.52,-9158.5 10584.1,-9165.01"/>
</g>
<!-- kv_send2_5_8 -->
<g id="node1483" class="node">
<title>kv_send2_5_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10221" cy="-9041.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10221" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="10221" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_5_8&#45;&gt;kv_send2_5_8 -->
<g id="edge2060" class="edge">
<title>ring_stage2_5_8&#45;&gt;kv_send2_5_8</title>
<path fill="none" stroke="black" d="M10204.78,-9104.58C10206.91,-9096.45 10209.31,-9087.31 10211.59,-9078.6"/>
<polygon fill="black" stroke="black" points="10215.04,-9079.22 10214.19,-9068.66 10208.27,-9077.45 10215.04,-9079.22"/>
</g>
<!-- ring_stage2_6_8 -->
<g id="node1499" class="node">
<title>ring_stage2_6_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10535.5,-9068.2 10342.5,-9068.2 10342.5,-9015.2 10535.5,-9015.2 10535.5,-9068.2"/>
<text text-anchor="middle" x="10439" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="10439" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_2×V_2</text>
<text text-anchor="middle" x="10439" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_5_8&#45;&gt;ring_stage2_6_8 -->
<g id="edge2106" class="edge">
<title>ring_stage2_5_8&#45;&gt;ring_stage2_6_8</title>
<path fill="none" stroke="black" d="M10268.36,-9104.82C10296.69,-9094.51 10329.53,-9082.55 10358.78,-9071.9"/>
<polygon fill="black" stroke="black" points="10360.36,-9075.05 10368.56,-9068.34 10357.96,-9068.47 10360.36,-9075.05"/>
</g>
<!-- kv_send2_5_9 -->
<g id="node1484" class="node">
<title>kv_send2_5_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9976" cy="-8951.95" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9976" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9976" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_5_9&#45;&gt;kv_send2_5_9 -->
<g id="edge2063" class="edge">
<title>ring_stage2_5_9&#45;&gt;kv_send2_5_9</title>
<path fill="none" stroke="black" d="M9978.12,-9014.84C9977.84,-9006.79 9977.53,-8997.76 9977.24,-8989.14"/>
<polygon fill="black" stroke="black" points="9980.73,-8988.8 9976.89,-8978.92 9973.73,-8989.04 9980.73,-8988.8"/>
</g>
<!-- ring_stage2_6_9 -->
<g id="node1500" class="node">
<title>ring_stage2_6_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10317.5,-8978.45 10124.5,-8978.45 10124.5,-8925.45 10317.5,-8925.45 10317.5,-8978.45"/>
<text text-anchor="middle" x="10221" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="10221" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_3×V_3</text>
<text text-anchor="middle" x="10221" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_5_9&#45;&gt;ring_stage2_6_9 -->
<g id="edge2109" class="edge">
<title>ring_stage2_5_9&#45;&gt;ring_stage2_6_9</title>
<path fill="none" stroke="black" d="M10049.65,-9015.08C10078.22,-9004.72 10111.36,-8992.71 10140.83,-8982.02"/>
<polygon fill="black" stroke="black" points="10142.06,-8985.3 10150.27,-8978.6 10139.67,-8978.72 10142.06,-8985.3"/>
</g>
<!-- kv_send2_5_10 -->
<g id="node1485" class="node">
<title>kv_send2_5_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9737" cy="-8862.21" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9737" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9737" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_5_10&#45;&gt;kv_send2_5_10 -->
<g id="edge2066" class="edge">
<title>ring_stage2_5_10&#45;&gt;kv_send2_5_10</title>
<path fill="none" stroke="black" d="M9744.05,-8925.1C9743.13,-8916.97 9742.08,-8907.83 9741.09,-8899.12"/>
<polygon fill="black" stroke="black" points="9744.57,-8898.72 9739.96,-8889.18 9737.61,-8899.52 9744.57,-8898.72"/>
</g>
<!-- ring_stage2_6_10 -->
<g id="node1501" class="node">
<title>ring_stage2_6_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10087,-8888.71 9885,-8888.71 9885,-8835.71 10087,-8835.71 10087,-8888.71"/>
<text text-anchor="middle" x="9986" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9986" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_4×V_4</text>
<text text-anchor="middle" x="9986" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_5_10&#45;&gt;ring_stage2_6_10 -->
<g id="edge2112" class="edge">
<title>ring_stage2_5_10&#45;&gt;ring_stage2_6_10</title>
<path fill="none" stroke="black" d="M9816.77,-8925.34C9844.87,-8915.03 9877.44,-8903.07 9906.45,-8892.42"/>
<polygon fill="black" stroke="black" points="9907.96,-8895.59 9916.14,-8888.86 9905.55,-8889.02 9907.96,-8895.59"/>
</g>
<!-- kv_send2_5_11 -->
<g id="node1486" class="node">
<title>kv_send2_5_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9498" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9498" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9498" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_5_11&#45;&gt;kv_send2_5_11 -->
<g id="edge2069" class="edge">
<title>ring_stage2_5_11&#45;&gt;kv_send2_5_11</title>
<path fill="none" stroke="black" d="M9505.05,-8835.36C9504.13,-8827.23 9503.08,-8818.09 9502.09,-8809.38"/>
<polygon fill="black" stroke="black" points="9505.57,-8808.98 9500.96,-8799.44 9498.61,-8809.78 9505.57,-8808.98"/>
</g>
<!-- ring_stage2_6_11 -->
<g id="node1502" class="node">
<title>ring_stage2_6_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9848,-8798.97 9646,-8798.97 9646,-8745.97 9848,-8745.97 9848,-8798.97"/>
<text text-anchor="middle" x="9747" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9747" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_5×V_5</text>
<text text-anchor="middle" x="9747" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_5_11&#45;&gt;ring_stage2_6_11 -->
<g id="edge2115" class="edge">
<title>ring_stage2_5_11&#45;&gt;ring_stage2_6_11</title>
<path fill="none" stroke="black" d="M9577.77,-8835.6C9605.87,-8825.29 9638.44,-8813.33 9667.45,-8802.68"/>
<polygon fill="black" stroke="black" points="9668.96,-8805.85 9677.14,-8799.12 9666.55,-8799.28 9668.96,-8805.85"/>
</g>
<!-- kv_send2_5_12 -->
<g id="node1487" class="node">
<title>kv_send2_5_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9264" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9264" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="9264" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_5_12&#45;&gt;kv_send2_5_12 -->
<g id="edge2072" class="edge">
<title>ring_stage2_5_12&#45;&gt;kv_send2_5_12</title>
<path fill="none" stroke="black" d="M9267.53,-8745.62C9267.07,-8737.57 9266.55,-8728.54 9266.06,-8719.92"/>
<polygon fill="black" stroke="black" points="9269.54,-8719.49 9265.48,-8709.7 9262.55,-8719.89 9269.54,-8719.49"/>
</g>
<!-- ring_stage2_6_12 -->
<g id="node1503" class="node">
<title>ring_stage2_6_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9594,-8709.23 9392,-8709.23 9392,-8656.23 9594,-8656.23 9594,-8709.23"/>
<text text-anchor="middle" x="9493" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9493" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_6×V_6</text>
<text text-anchor="middle" x="9493" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_5_12&#45;&gt;ring_stage2_6_12 -->
<g id="edge2118" class="edge">
<title>ring_stage2_5_12&#45;&gt;ring_stage2_6_12</title>
<path fill="none" stroke="black" d="M9334.39,-8745.86C9360.61,-8735.59 9390.98,-8723.69 9418.09,-8713.08"/>
<polygon fill="black" stroke="black" points="9419.49,-8716.29 9427.53,-8709.38 9416.94,-8709.77 9419.49,-8716.29"/>
</g>
<!-- kv_send2_5_13 -->
<g id="node1488" class="node">
<title>kv_send2_5_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9024" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9024" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9024" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_5_13&#45;&gt;kv_send2_5_13 -->
<g id="edge2075" class="edge">
<title>ring_stage2_5_13&#45;&gt;kv_send2_5_13</title>
<path fill="none" stroke="black" d="M9031.76,-8655.88C9030.74,-8647.75 9029.59,-8638.61 9028.5,-8629.9"/>
<polygon fill="black" stroke="black" points="9031.97,-8629.45 9027.26,-8619.96 9025.03,-8630.32 9031.97,-8629.45"/>
</g>
<!-- ring_stage2_6_13 -->
<g id="node1504" class="node">
<title>ring_stage2_6_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9354,-8619.49 9152,-8619.49 9152,-8566.49 9354,-8566.49 9354,-8619.49"/>
<text text-anchor="middle" x="9253" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9253" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_7×V_7</text>
<text text-anchor="middle" x="9253" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_5_13&#45;&gt;ring_stage2_6_13 -->
<g id="edge2121" class="edge">
<title>ring_stage2_5_13&#45;&gt;ring_stage2_6_13</title>
<path fill="none" stroke="black" d="M9098.64,-8656.12C9124.05,-8645.89 9153.46,-8634.06 9179.75,-8623.48"/>
<polygon fill="black" stroke="black" points="9181.31,-8626.62 9189.28,-8619.64 9178.7,-8620.13 9181.31,-8626.62"/>
</g>
<!-- kv_send2_5_14 -->
<g id="node1489" class="node">
<title>kv_send2_5_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8791" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8791" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="8791" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_5_14&#45;&gt;kv_send2_5_14 -->
<g id="edge2078" class="edge">
<title>ring_stage2_5_14&#45;&gt;kv_send2_5_14</title>
<path fill="none" stroke="black" d="M8792.41,-8566.14C8792.23,-8558.09 8792.02,-8549.06 8791.82,-8540.44"/>
<polygon fill="black" stroke="black" points="8795.32,-8540.14 8791.59,-8530.22 8788.32,-8540.3 8795.32,-8540.14"/>
</g>
<!-- ring_stage2_6_14 -->
<g id="node1505" class="node">
<title>ring_stage2_6_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9122,-8529.75 8920,-8529.75 8920,-8476.75 9122,-8476.75 9122,-8529.75"/>
<text text-anchor="middle" x="9021" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="9021" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_8×V_8</text>
<text text-anchor="middle" x="9021" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_5_14&#45;&gt;ring_stage2_6_14 -->
<g id="edge2124" class="edge">
<title>ring_stage2_5_14&#45;&gt;ring_stage2_6_14</title>
<path fill="none" stroke="black" d="M8859.56,-8566.38C8886.25,-8556.11 8917.16,-8544.21 8944.75,-8533.6"/>
<polygon fill="black" stroke="black" points="8946.28,-8536.76 8954.36,-8529.9 8943.77,-8530.23 8946.28,-8536.76"/>
</g>
<!-- kv_send2_5_15 -->
<g id="node1490" class="node">
<title>kv_send2_5_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8550" cy="-8413.51" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8550" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8550" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_5_15&#45;&gt;kv_send2_5_15 -->
<g id="edge2081" class="edge">
<title>ring_stage2_5_15&#45;&gt;kv_send2_5_15</title>
<path fill="none" stroke="black" d="M8551.41,-8476.4C8551.23,-8468.35 8551.02,-8459.32 8550.82,-8450.7"/>
<polygon fill="black" stroke="black" points="8554.32,-8450.4 8550.59,-8440.48 8547.32,-8450.56 8554.32,-8450.4"/>
</g>
<!-- ring_stage2_6_15 -->
<g id="node1506" class="node">
<title>ring_stage2_6_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8875,-8440.01 8673,-8440.01 8673,-8387.01 8875,-8387.01 8875,-8440.01"/>
<text text-anchor="middle" x="8774" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="8774" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_9×V_9</text>
<text text-anchor="middle" x="8774" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_5_15&#45;&gt;ring_stage2_6_15 -->
<g id="edge2127" class="edge">
<title>ring_stage2_5_15&#45;&gt;ring_stage2_6_15</title>
<path fill="none" stroke="black" d="M8616.81,-8476.64C8642.8,-8466.37 8672.9,-8454.47 8699.76,-8443.86"/>
<polygon fill="black" stroke="black" points="8701.1,-8447.09 8709.11,-8440.16 8698.52,-8440.58 8701.1,-8447.09"/>
</g>
<!-- kv_send2_5_0&#45;&gt;ring_stage2_6_1 -->
<g id="edge2086" class="edge">
<title>kv_send2_5_0&#45;&gt;ring_stage2_6_1</title>
<path fill="none" stroke="black" d="M8264.8,-8300.86C8237.5,-8289.82 8204.02,-8276.29 8174.54,-8264.36"/>
<polygon fill="black" stroke="black" points="8175.7,-8261.06 8165.12,-8260.56 8173.08,-8267.55 8175.7,-8261.06"/>
</g>
<!-- kv_send2_5_1&#45;&gt;ring_stage2_6_2 -->
<g id="edge2089" class="edge">
<title>kv_send2_5_1&#45;&gt;ring_stage2_6_2</title>
<path fill="none" stroke="black" d="M8841,-8214.77C8854.23,-8211.87 8867.98,-8209.18 8881,-8207.16 9078.4,-8176.6 9131.48,-8200.98 9329,-8171.16 9329.11,-8171.15 9329.21,-8171.13 9329.32,-8171.12"/>
<polygon fill="black" stroke="black" points="9329.91,-8174.57 9339.22,-8169.52 9328.79,-8167.66 9329.91,-8174.57"/>
</g>
<!-- kv_send2_5_2&#45;&gt;ring_stage2_6_3 -->
<g id="edge2092" class="edge">
<title>kv_send2_5_2&#45;&gt;ring_stage2_6_3</title>
<path fill="none" stroke="black" d="M10680.2,-9557.22C10707.5,-9546.18 10740.98,-9532.65 10770.46,-9520.73"/>
<polygon fill="black" stroke="black" points="10771.92,-9523.91 10779.88,-9516.92 10769.3,-9517.42 10771.92,-9523.91"/>
</g>
<!-- kv_send2_5_3&#45;&gt;ring_stage2_6_4 -->
<g id="edge2095" class="edge">
<title>kv_send2_5_3&#45;&gt;ring_stage2_6_4</title>
<path fill="none" stroke="black" d="M11352.34,-9468.16C11383.15,-9456.94 11421.43,-9443 11454.97,-9430.79"/>
<polygon fill="black" stroke="black" points="11456.55,-9433.94 11464.75,-9427.23 11454.16,-9427.36 11456.55,-9433.94"/>
</g>
<!-- kv_send2_5_4&#45;&gt;ring_stage2_6_5 -->
<g id="edge2098" class="edge">
<title>kv_send2_5_4&#45;&gt;ring_stage2_6_5</title>
<path fill="none" stroke="black" d="M11252.3,-9377.74C11224.75,-9366.7 11190.96,-9353.17 11161.21,-9341.25"/>
<polygon fill="black" stroke="black" points="11162.29,-9337.91 11151.7,-9337.44 11159.68,-9344.4 11162.29,-9337.91"/>
</g>
<!-- kv_send2_5_5&#45;&gt;ring_stage2_6_6 -->
<g id="edge2101" class="edge">
<title>kv_send2_5_5&#45;&gt;ring_stage2_6_6</title>
<path fill="none" stroke="black" d="M10871.02,-9284.06C10874.27,-9275.68 10877.93,-9266.22 10881.4,-9257.28"/>
<polygon fill="black" stroke="black" points="10884.7,-9258.43 10885.05,-9247.84 10878.18,-9255.9 10884.7,-9258.43"/>
</g>
<!-- kv_send2_5_6&#45;&gt;ring_stage2_6_7 -->
<g id="edge2104" class="edge">
<title>kv_send2_5_6&#45;&gt;ring_stage2_6_7</title>
<path fill="none" stroke="black" d="M10654.9,-9193.85C10655.17,-9185.81 10655.48,-9176.83 10655.77,-9168.27"/>
<polygon fill="black" stroke="black" points="10659.28,-9168.25 10656.12,-9158.14 10652.28,-9168.01 10659.28,-9168.25"/>
</g>
<!-- kv_send2_5_7&#45;&gt;ring_stage2_6_8 -->
<g id="edge2107" class="edge">
<title>kv_send2_5_7&#45;&gt;ring_stage2_6_8</title>
<path fill="none" stroke="black" d="M10439,-9104.11C10439,-9096.07 10439,-9087.09 10439,-9078.53"/>
<polygon fill="black" stroke="black" points="10442.5,-9078.4 10439,-9068.4 10435.5,-9078.4 10442.5,-9078.4"/>
</g>
<!-- kv_send2_5_8&#45;&gt;ring_stage2_6_9 -->
<g id="edge2110" class="edge">
<title>kv_send2_5_8&#45;&gt;ring_stage2_6_9</title>
<path fill="none" stroke="black" d="M10221,-9014.37C10221,-9006.33 10221,-8997.35 10221,-8988.79"/>
<polygon fill="black" stroke="black" points="10224.5,-8988.66 10221,-8978.66 10217.5,-8988.66 10224.5,-8988.66"/>
</g>
<!-- kv_send2_5_9&#45;&gt;ring_stage2_6_10 -->
<g id="edge2113" class="edge">
<title>kv_send2_5_9&#45;&gt;ring_stage2_6_10</title>
<path fill="none" stroke="black" d="M9979,-8924.63C9979.92,-8916.59 9980.94,-8907.61 9981.92,-8899.05"/>
<polygon fill="black" stroke="black" points="9985.42,-8899.25 9983.07,-8888.92 9978.46,-8898.46 9985.42,-8899.25"/>
</g>
<!-- kv_send2_5_10&#45;&gt;ring_stage2_6_11 -->
<g id="edge2116" class="edge">
<title>kv_send2_5_10&#45;&gt;ring_stage2_6_11</title>
<path fill="none" stroke="black" d="M9740,-8834.89C9740.92,-8826.85 9741.94,-8817.87 9742.92,-8809.31"/>
<polygon fill="black" stroke="black" points="9746.42,-8809.51 9744.07,-8799.18 9739.46,-8808.72 9746.42,-8809.51"/>
</g>
<!-- kv_send2_5_11&#45;&gt;ring_stage2_6_12 -->
<g id="edge2119" class="edge">
<title>kv_send2_5_11&#45;&gt;ring_stage2_6_12</title>
<path fill="none" stroke="black" d="M9496.5,-8745.15C9496.04,-8737.11 9495.53,-8728.13 9495.04,-8719.57"/>
<polygon fill="black" stroke="black" points="9498.53,-8719.22 9494.46,-8709.44 9491.54,-8719.62 9498.53,-8719.22"/>
</g>
<!-- kv_send2_5_12&#45;&gt;ring_stage2_6_13 -->
<g id="edge2122" class="edge">
<title>kv_send2_5_12&#45;&gt;ring_stage2_6_13</title>
<path fill="none" stroke="black" d="M9260.7,-8655.41C9259.69,-8647.37 9258.57,-8638.39 9257.49,-8629.83"/>
<polygon fill="black" stroke="black" points="9260.94,-8629.18 9256.22,-8619.7 9253.99,-8630.05 9260.94,-8629.18"/>
</g>
<!-- kv_send2_5_13&#45;&gt;ring_stage2_6_14 -->
<g id="edge2125" class="edge">
<title>kv_send2_5_13&#45;&gt;ring_stage2_6_14</title>
<path fill="none" stroke="black" d="M9023.1,-8565.67C9022.83,-8557.63 9022.52,-8548.65 9022.23,-8540.09"/>
<polygon fill="black" stroke="black" points="9025.72,-8539.83 9021.88,-8529.96 9018.72,-8540.07 9025.72,-8539.83"/>
</g>
<!-- kv_send2_5_14&#45;&gt;ring_stage2_6_15 -->
<g id="edge2128" class="edge">
<title>kv_send2_5_14&#45;&gt;ring_stage2_6_15</title>
<path fill="none" stroke="black" d="M8785.99,-8476.4C8784.4,-8468.19 8782.61,-8458.96 8780.91,-8450.19"/>
<polygon fill="black" stroke="black" points="8784.31,-8449.33 8778.97,-8440.18 8777.44,-8450.66 8784.31,-8449.33"/>
</g>
<!-- kv_send2_5_15&#45;&gt;ring_stage2_6_0 -->
<g id="edge2083" class="edge">
<title>kv_send2_5_15&#45;&gt;ring_stage2_6_0</title>
<path fill="none" stroke="black" d="M8548.8,-8386.19C8548.43,-8378.15 8548.02,-8369.17 8547.63,-8360.61"/>
<polygon fill="black" stroke="black" points="8551.12,-8360.31 8547.17,-8350.48 8544.13,-8360.63 8551.12,-8360.31"/>
</g>
<!-- kv_send2_6_0 -->
<g id="node1507" class="node">
<title>kv_send2_6_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8332" cy="-8234.03" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8332" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8332" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_6_0&#45;&gt;kv_send2_6_0 -->
<g id="edge2084" class="edge">
<title>ring_stage2_6_0&#45;&gt;kv_send2_6_0</title>
<path fill="none" stroke="black" d="M8483.53,-8297.16C8455.71,-8285.75 8423,-8272.34 8395.1,-8260.91"/>
<polygon fill="black" stroke="black" points="8396.42,-8257.66 8385.84,-8257.11 8393.77,-8264.14 8396.42,-8257.66"/>
</g>
<!-- ring_stage2_7_0 -->
<g id="node1523" class="node">
<title>ring_stage2_7_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8647.5,-8260.53 8454.5,-8260.53 8454.5,-8207.53 8647.5,-8207.53 8647.5,-8260.53"/>
<text text-anchor="middle" x="8551" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="8551" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_9×V_9</text>
<text text-anchor="middle" x="8551" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_6_0&#45;&gt;ring_stage2_7_0 -->
<g id="edge2130" class="edge">
<title>ring_stage2_6_0&#45;&gt;ring_stage2_7_0</title>
<path fill="none" stroke="black" d="M8547.47,-8296.92C8547.94,-8288.71 8548.47,-8279.48 8548.97,-8270.71"/>
<polygon fill="black" stroke="black" points="8552.46,-8270.88 8549.54,-8260.7 8545.47,-8270.48 8552.46,-8270.88"/>
</g>
<!-- kv_send2_6_1 -->
<g id="node1508" class="node">
<title>kv_send2_6_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8328" cy="-8144.29" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8328" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8328" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_6_1&#45;&gt;kv_send2_6_1 -->
<g id="edge2087" class="edge">
<title>ring_stage2_6_1&#45;&gt;kv_send2_6_1</title>
<path fill="none" stroke="black" d="M8167.98,-8207.42C8197.84,-8195.83 8233.03,-8182.16 8262.8,-8170.61"/>
<polygon fill="black" stroke="black" points="8264.2,-8173.82 8272.26,-8166.93 8261.67,-8167.29 8264.2,-8173.82"/>
</g>
<!-- ring_stage2_7_1 -->
<g id="node1524" class="node">
<title>ring_stage2_7_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8206.5,-8170.79 7995.5,-8170.79 7995.5,-8117.79 8206.5,-8117.79 8206.5,-8170.79"/>
<text text-anchor="middle" x="8101" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="8101" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_10×V_10</text>
<text text-anchor="middle" x="8101" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_6_1&#45;&gt;ring_stage2_7_1 -->
<g id="edge2133" class="edge">
<title>ring_stage2_6_1&#45;&gt;ring_stage2_7_1</title>
<path fill="none" stroke="black" d="M8101.71,-8207.18C8101.61,-8198.97 8101.51,-8189.74 8101.41,-8180.97"/>
<polygon fill="black" stroke="black" points="8104.91,-8180.92 8101.29,-8170.96 8097.91,-8181 8104.91,-8180.92"/>
</g>
<!-- kv_send2_6_2 -->
<g id="node1509" class="node">
<title>kv_send2_6_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9670" cy="-8054.55" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9670" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="9670" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_6_2&#45;&gt;kv_send2_6_2 -->
<g id="edge2090" class="edge">
<title>ring_stage2_6_2&#45;&gt;kv_send2_6_2</title>
<path fill="none" stroke="black" d="M9510.68,-8117.68C9540.3,-8106.13 9575.18,-8092.53 9604.74,-8081"/>
<polygon fill="black" stroke="black" points="9606.09,-8084.23 9614.13,-8077.34 9603.55,-8077.71 9606.09,-8084.23"/>
</g>
<!-- ring_stage2_7_2 -->
<g id="node1525" class="node">
<title>ring_stage2_7_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9326.5,-8081.05 9115.5,-8081.05 9115.5,-8028.05 9326.5,-8028.05 9326.5,-8081.05"/>
<text text-anchor="middle" x="9221" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9221" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_11×V_11</text>
<text text-anchor="middle" x="9221" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_6_2&#45;&gt;ring_stage2_7_2 -->
<g id="edge2136" class="edge">
<title>ring_stage2_6_2&#45;&gt;ring_stage2_7_2</title>
<path fill="none" stroke="black" d="M9379.61,-8117.68C9353.39,-8107.41 9323.02,-8095.51 9295.91,-8084.9"/>
<polygon fill="black" stroke="black" points="9297.06,-8081.59 9286.47,-8081.2 9294.51,-8088.11 9297.06,-8081.59"/>
</g>
<!-- kv_send2_6_3 -->
<g id="node1510" class="node">
<title>kv_send2_6_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11081" cy="-9400.66" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11081" y="-9404.46" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="11081" y="-9389.46" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_6_3&#45;&gt;kv_send2_6_3 -->
<g id="edge2093" class="edge">
<title>ring_stage2_6_3&#45;&gt;kv_send2_6_3</title>
<path fill="none" stroke="black" d="M10912.48,-9463.78C10944.31,-9452.05 10981.9,-9438.19 11013.49,-9426.55"/>
<polygon fill="black" stroke="black" points="11014.91,-9429.75 11023.08,-9423.01 11012.49,-9423.18 11014.91,-9429.75"/>
</g>
<!-- ring_stage2_7_3 -->
<g id="node1526" class="node">
<title>ring_stage2_7_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9992.5,-7991.31 9781.5,-7991.31 9781.5,-7938.31 9992.5,-7938.31 9992.5,-7991.31"/>
<text text-anchor="middle" x="9887" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9887" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_12×V_12</text>
<text text-anchor="middle" x="9887" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_6_3&#45;&gt;ring_stage2_7_3 -->
<g id="edge2139" class="edge">
<title>ring_stage2_6_3&#45;&gt;ring_stage2_7_3</title>
<path fill="none" stroke="black" d="M10792.65,-9463.85C10778.84,-9454.35 10765.38,-9442.23 10757,-9427.53 10737.17,-9392.74 10750.78,-9377.79 10749,-9337.79 10747.94,-9313.92 10743.77,-9307.35 10749,-9284.05 10752.87,-9266.78 10761.98,-9265.28 10766,-9248.05 10789.53,-9147.09 10770.73,-9118.47 10769,-9014.82 10768.33,-8974.92 10792.01,-8955.35 10766,-8925.08 10709.13,-8858.91 10631.7,-8953.65 10573,-8889.08 10554.15,-8868.35 10547.15,-8407.11 10528,-8386.64 10457.61,-8311.41 10373.37,-8421.95 10299,-8350.64 10272.68,-8325.41 10267.4,-8052.82 10241,-8027.68 10203.93,-7992.38 10068.74,-8000.65 10002.54,-7991.65"/>
<polygon fill="black" stroke="black" points="10002.96,-7988.18 9992.53,-7990.05 10001.85,-7995.09 10002.96,-7988.18"/>
</g>
<!-- kv_send2_6_4 -->
<g id="node1511" class="node">
<title>kv_send2_6_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11539" cy="-9310.92" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11539" y="-9314.72" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="11539" y="-9299.72" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_6_4&#45;&gt;kv_send2_6_4 -->
<g id="edge2096" class="edge">
<title>ring_stage2_6_4&#45;&gt;kv_send2_6_4</title>
<path fill="none" stroke="black" d="M11536.18,-9373.81C11536.55,-9365.76 11536.96,-9356.73 11537.35,-9348.1"/>
<polygon fill="black" stroke="black" points="11540.86,-9348.03 11537.82,-9337.88 11533.86,-9347.71 11540.86,-9348.03"/>
</g>
<!-- ring_stage2_7_4 -->
<g id="node1527" class="node">
<title>ring_stage2_7_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11871.5,-9337.42 11660.5,-9337.42 11660.5,-9284.42 11871.5,-9284.42 11871.5,-9337.42"/>
<text text-anchor="middle" x="11766" y="-9322.22" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="11766" y="-9307.22" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_13×V_13</text>
<text text-anchor="middle" x="11766" y="-9292.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_6_4&#45;&gt;ring_stage2_7_4 -->
<g id="edge2142" class="edge">
<title>ring_stage2_6_4&#45;&gt;ring_stage2_7_4</title>
<path fill="none" stroke="black" d="M11602.44,-9374.04C11629.6,-9363.73 11661.07,-9351.77 11689.11,-9341.12"/>
<polygon fill="black" stroke="black" points="11690.37,-9344.38 11698.48,-9337.56 11687.89,-9337.84 11690.37,-9344.38"/>
</g>
<!-- kv_send2_6_5 -->
<g id="node1512" class="node">
<title>kv_send2_6_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11118" cy="-9221.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11118" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="11118" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_6_5&#45;&gt;kv_send2_6_5 -->
<g id="edge2099" class="edge">
<title>ring_stage2_6_5&#45;&gt;kv_send2_6_5</title>
<path fill="none" stroke="black" d="M11096.84,-9284.06C11099.65,-9275.84 11102.81,-9266.59 11105.82,-9257.8"/>
<polygon fill="black" stroke="black" points="11109.2,-9258.74 11109.12,-9248.14 11102.57,-9256.47 11109.2,-9258.74"/>
</g>
<!-- ring_stage2_7_5 -->
<g id="node1528" class="node">
<title>ring_stage2_7_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11525.5,-9247.68 11314.5,-9247.68 11314.5,-9194.68 11525.5,-9194.68 11525.5,-9247.68"/>
<text text-anchor="middle" x="11420" y="-9232.48" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="11420" y="-9217.48" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_14×V_14</text>
<text text-anchor="middle" x="11420" y="-9202.48" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_6_5&#45;&gt;ring_stage2_7_5 -->
<g id="edge2145" class="edge">
<title>ring_stage2_6_5&#45;&gt;ring_stage2_7_5</title>
<path fill="none" stroke="black" d="M11184.92,-9284.3C11225.23,-9273.65 11272.16,-9261.25 11313.43,-9250.34"/>
<polygon fill="black" stroke="black" points="11314.47,-9253.68 11323.25,-9247.75 11312.68,-9246.92 11314.47,-9253.68"/>
</g>
<!-- kv_send2_6_6 -->
<g id="node1513" class="node">
<title>kv_send2_6_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10898" cy="-9131.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10898" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10898" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_6_6&#45;&gt;kv_send2_6_6 -->
<g id="edge2102" class="edge">
<title>ring_stage2_6_6&#45;&gt;kv_send2_6_6</title>
<path fill="none" stroke="black" d="M10895.88,-9194.32C10896.16,-9186.27 10896.47,-9177.25 10896.76,-9168.62"/>
<polygon fill="black" stroke="black" points="10900.27,-9168.52 10897.11,-9158.4 10893.27,-9168.28 10900.27,-9168.52"/>
</g>
<!-- ring_stage2_7_6 -->
<g id="node1529" class="node">
<title>ring_stage2_7_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11231.5,-9157.94 11020.5,-9157.94 11020.5,-9104.94 11231.5,-9104.94 11231.5,-9157.94"/>
<text text-anchor="middle" x="11126" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="11126" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_15×V_15</text>
<text text-anchor="middle" x="11126" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_6_6&#45;&gt;ring_stage2_7_6 -->
<g id="edge2148" class="edge">
<title>ring_stage2_6_6&#45;&gt;ring_stage2_7_6</title>
<path fill="none" stroke="black" d="M10962.44,-9194.56C10989.6,-9184.25 11021.07,-9172.29 11049.11,-9161.64"/>
<polygon fill="black" stroke="black" points="11050.37,-9164.9 11058.48,-9158.08 11047.89,-9158.36 11050.37,-9164.9"/>
</g>
<!-- kv_send2_6_7 -->
<g id="node1514" class="node">
<title>kv_send2_6_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10657" cy="-9041.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10657" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="10657" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_6_7&#45;&gt;kv_send2_6_7 -->
<g id="edge2105" class="edge">
<title>ring_stage2_6_7&#45;&gt;kv_send2_6_7</title>
<path fill="none" stroke="black" d="M10657,-9104.58C10657,-9096.53 10657,-9087.51 10657,-9078.88"/>
<polygon fill="black" stroke="black" points="10660.5,-9078.66 10657,-9068.66 10653.5,-9078.66 10660.5,-9078.66"/>
</g>
<!-- ring_stage2_7_7 -->
<g id="node1530" class="node">
<title>ring_stage2_7_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10996.5,-9068.2 10803.5,-9068.2 10803.5,-9015.2 10996.5,-9015.2 10996.5,-9068.2"/>
<text text-anchor="middle" x="10900" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="10900" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_0×V_0</text>
<text text-anchor="middle" x="10900" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_6_7&#45;&gt;ring_stage2_7_7 -->
<g id="edge2151" class="edge">
<title>ring_stage2_6_7&#45;&gt;ring_stage2_7_7</title>
<path fill="none" stroke="black" d="M10727.94,-9104.82C10756.63,-9094.46 10789.91,-9082.45 10819.5,-9071.76"/>
<polygon fill="black" stroke="black" points="10820.76,-9075.03 10828.97,-9068.34 10818.38,-9068.44 10820.76,-9075.03"/>
</g>
<!-- kv_send2_6_8 -->
<g id="node1515" class="node">
<title>kv_send2_6_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10439" cy="-8951.95" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10439" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="10439" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_6_8&#45;&gt;kv_send2_6_8 -->
<g id="edge2108" class="edge">
<title>ring_stage2_6_8&#45;&gt;kv_send2_6_8</title>
<path fill="none" stroke="black" d="M10439,-9014.84C10439,-9006.79 10439,-8997.76 10439,-8989.14"/>
<polygon fill="black" stroke="black" points="10442.5,-8988.92 10439,-8978.92 10435.5,-8988.92 10442.5,-8988.92"/>
</g>
<!-- ring_stage2_7_8 -->
<g id="node1531" class="node">
<title>ring_stage2_7_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10756.5,-8978.45 10563.5,-8978.45 10563.5,-8925.45 10756.5,-8925.45 10756.5,-8978.45"/>
<text text-anchor="middle" x="10660" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="10660" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_1×V_1</text>
<text text-anchor="middle" x="10660" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_6_8&#45;&gt;ring_stage2_7_8 -->
<g id="edge2154" class="edge">
<title>ring_stage2_6_8&#45;&gt;ring_stage2_7_8</title>
<path fill="none" stroke="black" d="M10503.52,-9015.08C10529.39,-9004.81 10559.35,-8992.91 10586.09,-8982.3"/>
<polygon fill="black" stroke="black" points="10587.4,-8985.54 10595.4,-8978.6 10584.82,-8979.04 10587.4,-8985.54"/>
</g>
<!-- kv_send2_6_9 -->
<g id="node1516" class="node">
<title>kv_send2_6_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10215" cy="-8862.21" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10215" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10215" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_6_9&#45;&gt;kv_send2_6_9 -->
<g id="edge2111" class="edge">
<title>ring_stage2_6_9&#45;&gt;kv_send2_6_9</title>
<path fill="none" stroke="black" d="M10219.23,-8925.1C10218.68,-8917.05 10218.06,-8908.02 10217.47,-8899.4"/>
<polygon fill="black" stroke="black" points="10220.95,-8898.92 10216.78,-8889.18 10213.97,-8899.4 10220.95,-8898.92"/>
</g>
<!-- ring_stage2_7_9 -->
<g id="node1532" class="node">
<title>ring_stage2_7_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10535.5,-8888.71 10342.5,-8888.71 10342.5,-8835.71 10535.5,-8835.71 10535.5,-8888.71"/>
<text text-anchor="middle" x="10439" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="10439" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_2×V_2</text>
<text text-anchor="middle" x="10439" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_6_9&#45;&gt;ring_stage2_7_9 -->
<g id="edge2157" class="edge">
<title>ring_stage2_6_9&#45;&gt;ring_stage2_7_9</title>
<path fill="none" stroke="black" d="M10284.64,-8925.34C10310.05,-8915.11 10339.46,-8903.28 10365.75,-8892.7"/>
<polygon fill="black" stroke="black" points="10367.31,-8895.84 10375.28,-8888.86 10364.7,-8889.35 10367.31,-8895.84"/>
</g>
<!-- kv_send2_6_10 -->
<g id="node1517" class="node">
<title>kv_send2_6_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9976" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9976" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9976" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_6_10&#45;&gt;kv_send2_6_10 -->
<g id="edge2114" class="edge">
<title>ring_stage2_6_10&#45;&gt;kv_send2_6_10</title>
<path fill="none" stroke="black" d="M9983.05,-8835.36C9982.13,-8827.23 9981.08,-8818.09 9980.09,-8809.38"/>
<polygon fill="black" stroke="black" points="9983.57,-8808.98 9978.96,-8799.44 9976.61,-8809.78 9983.57,-8808.98"/>
</g>
<!-- ring_stage2_7_10 -->
<g id="node1533" class="node">
<title>ring_stage2_7_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10306,-8798.97 10104,-8798.97 10104,-8745.97 10306,-8745.97 10306,-8798.97"/>
<text text-anchor="middle" x="10205" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="10205" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_3×V_3</text>
<text text-anchor="middle" x="10205" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_6_10&#45;&gt;ring_stage2_7_10 -->
<g id="edge2160" class="edge">
<title>ring_stage2_6_10&#45;&gt;ring_stage2_7_10</title>
<path fill="none" stroke="black" d="M10049.93,-8835.6C10075.46,-8825.37 10105,-8813.54 10131.41,-8802.96"/>
<polygon fill="black" stroke="black" points="10133.01,-8806.09 10140.99,-8799.12 10130.4,-8799.59 10133.01,-8806.09"/>
</g>
<!-- kv_send2_6_11 -->
<g id="node1518" class="node">
<title>kv_send2_6_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9742" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9742" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9742" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_6_11&#45;&gt;kv_send2_6_11 -->
<g id="edge2117" class="edge">
<title>ring_stage2_6_11&#45;&gt;kv_send2_6_11</title>
<path fill="none" stroke="black" d="M9745.53,-8745.62C9745.07,-8737.57 9744.55,-8728.54 9744.06,-8719.92"/>
<polygon fill="black" stroke="black" points="9747.54,-8719.49 9743.48,-8709.7 9740.55,-8719.89 9747.54,-8719.49"/>
</g>
<!-- ring_stage2_7_11 -->
<g id="node1534" class="node">
<title>ring_stage2_7_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10072,-8709.23 9870,-8709.23 9870,-8656.23 10072,-8656.23 10072,-8709.23"/>
<text text-anchor="middle" x="9971" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9971" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_4×V_4</text>
<text text-anchor="middle" x="9971" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_6_11&#45;&gt;ring_stage2_7_11 -->
<g id="edge2163" class="edge">
<title>ring_stage2_6_11&#45;&gt;ring_stage2_7_11</title>
<path fill="none" stroke="black" d="M9812.39,-8745.86C9838.61,-8735.59 9868.98,-8723.69 9896.09,-8713.08"/>
<polygon fill="black" stroke="black" points="9897.49,-8716.29 9905.53,-8709.38 9894.94,-8709.77 9897.49,-8716.29"/>
</g>
<!-- kv_send2_6_12 -->
<g id="node1519" class="node">
<title>kv_send2_6_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9482" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9482" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="9482" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_6_12&#45;&gt;kv_send2_6_12 -->
<g id="edge2120" class="edge">
<title>ring_stage2_6_12&#45;&gt;kv_send2_6_12</title>
<path fill="none" stroke="black" d="M9489.76,-8655.88C9488.74,-8647.75 9487.59,-8638.61 9486.5,-8629.9"/>
<polygon fill="black" stroke="black" points="9489.97,-8629.45 9485.26,-8619.96 9483.03,-8630.32 9489.97,-8629.45"/>
</g>
<!-- ring_stage2_7_12 -->
<g id="node1535" class="node">
<title>ring_stage2_7_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9832,-8619.49 9630,-8619.49 9630,-8566.49 9832,-8566.49 9832,-8619.49"/>
<text text-anchor="middle" x="9731" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9731" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_5×V_5</text>
<text text-anchor="middle" x="9731" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_6_12&#45;&gt;ring_stage2_7_12 -->
<g id="edge2166" class="edge">
<title>ring_stage2_6_12&#45;&gt;ring_stage2_7_12</title>
<path fill="none" stroke="black" d="M9562.48,-8656.12C9590.46,-8645.8 9622.89,-8633.85 9651.78,-8623.2"/>
<polygon fill="black" stroke="black" points="9653.26,-8626.38 9661.43,-8619.64 9650.84,-8619.82 9653.26,-8626.38"/>
</g>
<!-- kv_send2_6_13 -->
<g id="node1520" class="node">
<title>kv_send2_6_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9252" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9252" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9252" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_6_13&#45;&gt;kv_send2_6_13 -->
<g id="edge2123" class="edge">
<title>ring_stage2_6_13&#45;&gt;kv_send2_6_13</title>
<path fill="none" stroke="black" d="M9252.71,-8566.14C9252.61,-8558.09 9252.51,-8549.06 9252.41,-8540.44"/>
<polygon fill="black" stroke="black" points="9255.91,-8540.18 9252.3,-8530.22 9248.91,-8540.26 9255.91,-8540.18"/>
</g>
<!-- ring_stage2_7_13 -->
<g id="node1536" class="node">
<title>ring_stage2_7_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9583,-8529.75 9381,-8529.75 9381,-8476.75 9583,-8476.75 9583,-8529.75"/>
<text text-anchor="middle" x="9482" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9482" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_6×V_6</text>
<text text-anchor="middle" x="9482" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_6_13&#45;&gt;ring_stage2_7_13 -->
<g id="edge2169" class="edge">
<title>ring_stage2_6_13&#45;&gt;ring_stage2_7_13</title>
<path fill="none" stroke="black" d="M9319.85,-8566.38C9346.66,-8556.11 9377.71,-8544.21 9405.42,-8533.6"/>
<polygon fill="black" stroke="black" points="9406.98,-8536.75 9415.07,-8529.9 9404.47,-8530.21 9406.98,-8536.75"/>
</g>
<!-- kv_send2_6_14 -->
<g id="node1521" class="node">
<title>kv_send2_6_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9006" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9006" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9006" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_6_14&#45;&gt;kv_send2_6_14 -->
<g id="edge2126" class="edge">
<title>ring_stage2_6_14&#45;&gt;kv_send2_6_14</title>
<path fill="none" stroke="black" d="M9016.58,-8476.4C9015.19,-8468.27 9013.63,-8459.13 9012.14,-8450.42"/>
<polygon fill="black" stroke="black" points="9015.57,-8449.75 9010.44,-8440.48 9008.67,-8450.93 9015.57,-8449.75"/>
</g>
<!-- ring_stage2_7_14 -->
<g id="node1537" class="node">
<title>ring_stage2_7_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9338,-8440.01 9136,-8440.01 9136,-8387.01 9338,-8387.01 9338,-8440.01"/>
<text text-anchor="middle" x="9237" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="9237" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_7×V_7</text>
<text text-anchor="middle" x="9237" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_6_14&#45;&gt;ring_stage2_7_14 -->
<g id="edge2172" class="edge">
<title>ring_stage2_6_14&#45;&gt;ring_stage2_7_14</title>
<path fill="none" stroke="black" d="M9084.06,-8476.64C9109.23,-8466.41 9138.37,-8454.58 9164.42,-8444"/>
<polygon fill="black" stroke="black" points="9165.92,-8447.17 9173.86,-8440.16 9163.28,-8440.68 9165.92,-8447.17"/>
</g>
<!-- kv_send2_6_15 -->
<g id="node1522" class="node">
<title>kv_send2_6_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8773" cy="-8323.77" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8773" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8773" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_6_15&#45;&gt;kv_send2_6_15 -->
<g id="edge2129" class="edge">
<title>ring_stage2_6_15&#45;&gt;kv_send2_6_15</title>
<path fill="none" stroke="black" d="M8773.71,-8386.66C8773.61,-8378.61 8773.51,-8369.58 8773.41,-8360.96"/>
<polygon fill="black" stroke="black" points="8776.91,-8360.7 8773.3,-8350.74 8769.91,-8360.78 8776.91,-8360.7"/>
</g>
<!-- ring_stage2_7_15 -->
<g id="node1538" class="node">
<title>ring_stage2_7_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9096,-8350.27 8894,-8350.27 8894,-8297.27 9096,-8297.27 9096,-8350.27"/>
<text text-anchor="middle" x="8995" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="8995" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_8×V_8</text>
<text text-anchor="middle" x="8995" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_6_15&#45;&gt;ring_stage2_7_15 -->
<g id="edge2175" class="edge">
<title>ring_stage2_6_15&#45;&gt;ring_stage2_7_15</title>
<path fill="none" stroke="black" d="M8838.52,-8386.9C8864.39,-8376.63 8894.35,-8364.73 8921.09,-8354.12"/>
<polygon fill="black" stroke="black" points="8922.4,-8357.36 8930.4,-8350.42 8919.82,-8350.86 8922.4,-8357.36"/>
</g>
<!-- kv_send2_6_0&#45;&gt;ring_stage2_7_1 -->
<g id="edge2134" class="edge">
<title>kv_send2_6_0&#45;&gt;ring_stage2_7_1</title>
<path fill="none" stroke="black" d="M8275.2,-8211.46C8245.9,-8200.33 8209.74,-8186.6 8177.97,-8174.53"/>
<polygon fill="black" stroke="black" points="8178.86,-8171.12 8168.26,-8170.84 8176.37,-8177.67 8178.86,-8171.12"/>
</g>
<!-- kv_send2_6_1&#45;&gt;ring_stage2_7_2 -->
<g id="edge2137" class="edge">
<title>kv_send2_6_1&#45;&gt;ring_stage2_7_2</title>
<path fill="none" stroke="black" d="M8399.65,-8124.81C8412.99,-8121.92 8426.86,-8119.28 8440,-8117.42 8732.63,-8076.01 8811.18,-8121.46 9104,-8081.42 9104.35,-8081.38 9104.7,-8081.33 9105.04,-8081.28"/>
<polygon fill="black" stroke="black" points="9105.9,-8084.69 9115.27,-8079.74 9104.86,-8077.77 9105.9,-8084.69"/>
</g>
<!-- kv_send2_6_2&#45;&gt;ring_stage2_7_3 -->
<g id="edge2140" class="edge">
<title>kv_send2_6_2&#45;&gt;ring_stage2_7_3</title>
<path fill="none" stroke="black" d="M9724.2,-8031.64C9751.5,-8020.6 9784.98,-8007.06 9814.46,-7995.14"/>
<polygon fill="black" stroke="black" points="9815.92,-7998.33 9823.88,-7991.33 9813.3,-7991.84 9815.92,-7998.33"/>
</g>
<!-- kv_send2_6_3&#45;&gt;ring_stage2_7_4 -->
<g id="edge2143" class="edge">
<title>kv_send2_6_3&#45;&gt;ring_stage2_7_4</title>
<path fill="none" stroke="black" d="M11153.68,-9381.52C11167.34,-9378.58 11181.56,-9375.83 11195,-9373.79 11392.75,-9343.7 11448.21,-9367.38 11650.17,-9337.81"/>
<polygon fill="black" stroke="black" points="11650.83,-9341.25 11660.21,-9336.31 11649.8,-9334.32 11650.83,-9341.25"/>
</g>
<!-- kv_send2_6_4&#45;&gt;ring_stage2_7_5 -->
<g id="edge2146" class="edge">
<title>kv_send2_6_4&#45;&gt;ring_stage2_7_5</title>
<path fill="none" stroke="black" d="M11505.54,-9285.24C11492.32,-9275.5 11476.97,-9264.18 11462.95,-9253.84"/>
<polygon fill="black" stroke="black" points="11465,-9251 11454.87,-9247.89 11460.84,-9256.64 11465,-9251"/>
</g>
<!-- kv_send2_6_5&#45;&gt;ring_stage2_7_6 -->
<g id="edge2149" class="edge">
<title>kv_send2_6_5&#45;&gt;ring_stage2_7_6</title>
<path fill="none" stroke="black" d="M11120.4,-9193.85C11121.13,-9185.81 11121.95,-9176.83 11122.73,-9168.27"/>
<polygon fill="black" stroke="black" points="11126.23,-9168.41 11123.66,-9158.14 11119.26,-9167.78 11126.23,-9168.41"/>
</g>
<!-- kv_send2_6_6&#45;&gt;ring_stage2_7_7 -->
<g id="edge2152" class="edge">
<title>kv_send2_6_6&#45;&gt;ring_stage2_7_7</title>
<path fill="none" stroke="black" d="M10898.6,-9104.11C10898.78,-9096.07 10898.99,-9087.09 10899.18,-9078.53"/>
<polygon fill="black" stroke="black" points="10902.69,-9078.47 10899.41,-9068.4 10895.69,-9078.32 10902.69,-9078.47"/>
</g>
<!-- kv_send2_6_7&#45;&gt;ring_stage2_7_8 -->
<g id="edge2155" class="edge">
<title>kv_send2_6_7&#45;&gt;ring_stage2_7_8</title>
<path fill="none" stroke="black" d="M10657.9,-9014.37C10658.17,-9006.33 10658.48,-8997.35 10658.77,-8988.79"/>
<polygon fill="black" stroke="black" points="10662.28,-8988.77 10659.12,-8978.66 10655.28,-8988.53 10662.28,-8988.77"/>
</g>
<!-- kv_send2_6_8&#45;&gt;ring_stage2_7_9 -->
<g id="edge2158" class="edge">
<title>kv_send2_6_8&#45;&gt;ring_stage2_7_9</title>
<path fill="none" stroke="black" d="M10439,-8924.63C10439,-8916.59 10439,-8907.61 10439,-8899.05"/>
<polygon fill="black" stroke="black" points="10442.5,-8898.92 10439,-8888.92 10435.5,-8898.92 10442.5,-8898.92"/>
</g>
<!-- kv_send2_6_9&#45;&gt;ring_stage2_7_10 -->
<g id="edge2161" class="edge">
<title>kv_send2_6_9&#45;&gt;ring_stage2_7_10</title>
<path fill="none" stroke="black" d="M10212,-8834.89C10211.08,-8826.85 10210.06,-8817.87 10209.08,-8809.31"/>
<polygon fill="black" stroke="black" points="10212.54,-8808.72 10207.93,-8799.18 10205.58,-8809.51 10212.54,-8808.72"/>
</g>
<!-- kv_send2_6_10&#45;&gt;ring_stage2_7_11 -->
<g id="edge2164" class="edge">
<title>kv_send2_6_10&#45;&gt;ring_stage2_7_11</title>
<path fill="none" stroke="black" d="M9974.5,-8745.15C9974.04,-8737.11 9973.53,-8728.13 9973.04,-8719.57"/>
<polygon fill="black" stroke="black" points="9976.53,-8719.22 9972.46,-8709.44 9969.54,-8719.62 9976.53,-8719.22"/>
</g>
<!-- kv_send2_6_11&#45;&gt;ring_stage2_7_12 -->
<g id="edge2167" class="edge">
<title>kv_send2_6_11&#45;&gt;ring_stage2_7_12</title>
<path fill="none" stroke="black" d="M9738.7,-8655.41C9737.69,-8647.37 9736.57,-8638.39 9735.49,-8629.83"/>
<polygon fill="black" stroke="black" points="9738.94,-8629.18 9734.22,-8619.7 9731.99,-8630.05 9738.94,-8629.18"/>
</g>
<!-- kv_send2_6_12&#45;&gt;ring_stage2_7_13 -->
<g id="edge2170" class="edge">
<title>kv_send2_6_12&#45;&gt;ring_stage2_7_13</title>
<path fill="none" stroke="black" d="M9482,-8565.67C9482,-8557.63 9482,-8548.65 9482,-8540.09"/>
<polygon fill="black" stroke="black" points="9485.5,-8539.96 9482,-8529.96 9478.5,-8539.96 9485.5,-8539.96"/>
</g>
<!-- kv_send2_6_13&#45;&gt;ring_stage2_7_14 -->
<g id="edge2173" class="edge">
<title>kv_send2_6_13&#45;&gt;ring_stage2_7_14</title>
<path fill="none" stroke="black" d="M9247.58,-8476.4C9246.18,-8468.19 9244.6,-8458.96 9243.1,-8450.19"/>
<polygon fill="black" stroke="black" points="9246.52,-8449.45 9241.39,-8440.18 9239.62,-8450.63 9246.52,-8449.45"/>
</g>
<!-- kv_send2_6_14&#45;&gt;ring_stage2_7_15 -->
<g id="edge2176" class="edge">
<title>kv_send2_6_14&#45;&gt;ring_stage2_7_15</title>
<path fill="none" stroke="black" d="M9002.7,-8386.19C9001.69,-8378.15 9000.57,-8369.17 8999.49,-8360.61"/>
<polygon fill="black" stroke="black" points="9002.94,-8359.96 8998.22,-8350.48 8995.99,-8360.83 9002.94,-8359.96"/>
</g>
<!-- kv_send2_6_15&#45;&gt;ring_stage2_7_0 -->
<g id="edge2131" class="edge">
<title>kv_send2_6_15&#45;&gt;ring_stage2_7_0</title>
<path fill="none" stroke="black" d="M8717.84,-8300.97C8689.91,-8289.94 8655.61,-8276.38 8625.39,-8264.43"/>
<polygon fill="black" stroke="black" points="8626.32,-8261.04 8615.73,-8260.62 8623.75,-8267.55 8626.32,-8261.04"/>
</g>
<!-- kv_send2_7_0 -->
<g id="node1539" class="node">
<title>kv_send2_7_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8552" cy="-8144.29" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8552" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8552" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_7_0&#45;&gt;kv_send2_7_0 -->
<g id="edge2132" class="edge">
<title>ring_stage2_7_0&#45;&gt;kv_send2_7_0</title>
<path fill="none" stroke="black" d="M8551.29,-8207.18C8551.39,-8199.13 8551.49,-8190.1 8551.59,-8181.48"/>
<polygon fill="black" stroke="black" points="8555.09,-8181.3 8551.7,-8171.26 8548.09,-8181.22 8555.09,-8181.3"/>
</g>
<!-- ring_stage2_8_0 -->
<g id="node1555" class="node">
<title>ring_stage2_8_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8866.5,-8170.79 8673.5,-8170.79 8673.5,-8117.79 8866.5,-8117.79 8866.5,-8170.79"/>
<text text-anchor="middle" x="8770" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="8770" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_8×V_8</text>
<text text-anchor="middle" x="8770" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_7_0&#45;&gt;ring_stage2_8_0 -->
<g id="edge2178" class="edge">
<title>ring_stage2_7_0&#45;&gt;ring_stage2_8_0</title>
<path fill="none" stroke="black" d="M8614.93,-8207.42C8640.46,-8197.19 8670,-8185.36 8696.41,-8174.78"/>
<polygon fill="black" stroke="black" points="8698.01,-8177.91 8705.99,-8170.94 8695.4,-8171.41 8698.01,-8177.91"/>
</g>
<!-- kv_send2_7_1 -->
<g id="node1540" class="node">
<title>kv_send2_7_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8327" cy="-8054.55" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8327" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8327" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_7_1&#45;&gt;kv_send2_7_1 -->
<g id="edge2135" class="edge">
<title>ring_stage2_7_1&#45;&gt;kv_send2_7_1</title>
<path fill="none" stroke="black" d="M8166.98,-8117.68C8196.84,-8106.09 8232.03,-8092.42 8261.8,-8080.87"/>
<polygon fill="black" stroke="black" points="8263.2,-8084.08 8271.26,-8077.19 8260.67,-8077.55 8263.2,-8084.08"/>
</g>
<!-- ring_stage2_8_1 -->
<g id="node1556" class="node">
<title>ring_stage2_8_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8205.5,-8081.05 8012.5,-8081.05 8012.5,-8028.05 8205.5,-8028.05 8205.5,-8081.05"/>
<text text-anchor="middle" x="8109" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="8109" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_9×V_9</text>
<text text-anchor="middle" x="8109" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_7_1&#45;&gt;ring_stage2_8_1 -->
<g id="edge2181" class="edge">
<title>ring_stage2_7_1&#45;&gt;ring_stage2_8_1</title>
<path fill="none" stroke="black" d="M8103.36,-8117.44C8104.11,-8109.23 8104.95,-8100 8105.75,-8091.23"/>
<polygon fill="black" stroke="black" points="8109.24,-8091.5 8106.66,-8081.22 8102.27,-8090.86 8109.24,-8091.5"/>
</g>
<!-- kv_send2_7_2 -->
<g id="node1541" class="node">
<title>kv_send2_7_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9440" cy="-7964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9440" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="9440" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_7_2&#45;&gt;kv_send2_7_2 -->
<g id="edge2138" class="edge">
<title>ring_stage2_7_2&#45;&gt;kv_send2_7_2</title>
<path fill="none" stroke="black" d="M9284.93,-8027.94C9313.52,-8016.49 9347.14,-8003.02 9375.76,-7991.55"/>
<polygon fill="black" stroke="black" points="9377.28,-7994.71 9385.26,-7987.74 9374.68,-7988.21 9377.28,-7994.71"/>
</g>
<!-- ring_stage2_8_2 -->
<g id="node1557" class="node">
<title>ring_stage2_8_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9094.5,-7991.31 8883.5,-7991.31 8883.5,-7938.31 9094.5,-7938.31 9094.5,-7991.31"/>
<text text-anchor="middle" x="8989" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="8989" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_10×V_10</text>
<text text-anchor="middle" x="8989" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_7_2&#45;&gt;ring_stage2_8_2 -->
<g id="edge2184" class="edge">
<title>ring_stage2_7_2&#45;&gt;ring_stage2_8_2</title>
<path fill="none" stroke="black" d="M9153.27,-8027.94C9126,-8017.62 9094.38,-8005.67 9066.22,-7995.02"/>
<polygon fill="black" stroke="black" points="9067.4,-7991.72 9056.81,-7991.46 9064.93,-7998.27 9067.4,-7991.72"/>
</g>
<!-- kv_send2_7_3 -->
<g id="node1542" class="node">
<title>kv_send2_7_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10026" cy="-7875.07" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10026" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="10026" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_7_3&#45;&gt;kv_send2_7_3 -->
<g id="edge2141" class="edge">
<title>ring_stage2_7_3&#45;&gt;kv_send2_7_3</title>
<path fill="none" stroke="black" d="M9927.58,-7938.2C9943.82,-7927.95 9962.62,-7916.08 9979.42,-7905.48"/>
<polygon fill="black" stroke="black" points="9981.41,-7908.36 9987.99,-7900.06 9977.67,-7902.44 9981.41,-7908.36"/>
</g>
<!-- ring_stage2_8_3 -->
<g id="node1558" class="node">
<title>ring_stage2_8_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9684.5,-7901.57 9473.5,-7901.57 9473.5,-7848.57 9684.5,-7848.57 9684.5,-7901.57"/>
<text text-anchor="middle" x="9579" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="9579" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_11×V_11</text>
<text text-anchor="middle" x="9579" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_7_3&#45;&gt;ring_stage2_8_3 -->
<g id="edge2187" class="edge">
<title>ring_stage2_7_3&#45;&gt;ring_stage2_8_3</title>
<path fill="none" stroke="black" d="M9797.09,-7938.2C9760,-7927.64 9716.89,-7915.35 9678.83,-7904.51"/>
<polygon fill="black" stroke="black" points="9679.34,-7901.02 9668.76,-7901.64 9677.42,-7907.75 9679.34,-7901.02"/>
</g>
<!-- kv_send2_7_4 -->
<g id="node1543" class="node">
<title>kv_send2_7_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11658" cy="-9221.18" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11658" y="-9224.98" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="11658" y="-9209.98" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_7_4&#45;&gt;kv_send2_7_4 -->
<g id="edge2144" class="edge">
<title>ring_stage2_7_4&#45;&gt;kv_send2_7_4</title>
<path fill="none" stroke="black" d="M11734.47,-9284.3C11722.62,-9274.68 11709.02,-9263.62 11696.6,-9253.53"/>
<polygon fill="black" stroke="black" points="11698.61,-9250.65 11688.64,-9247.07 11694.19,-9256.09 11698.61,-9250.65"/>
</g>
<!-- ring_stage2_8_4 -->
<g id="node1559" class="node">
<title>ring_stage2_8_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10131.5,-7785.7 9920.5,-7785.7 9920.5,-7732.7 10131.5,-7732.7 10131.5,-7785.7"/>
<text text-anchor="middle" x="10026" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="10026" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_12×V_12</text>
<text text-anchor="middle" x="10026" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_7_4&#45;&gt;ring_stage2_8_4 -->
<g id="edge2190" class="edge">
<title>ring_stage2_7_4&#45;&gt;ring_stage2_8_4</title>
<path fill="none" stroke="black" d="M11769.52,-9284.4C11773.95,-9249.98 11781,-9186.7 11781,-9132.44 11781,-9132.44 11781,-9132.44 11781,-8502.25 11781,-8492.99 11658.09,-7854.16 11651,-7848.2 11586.78,-7794.2 10222.81,-7830.86 10141,-7812.2 10120.44,-7807.51 10099.09,-7799 10080.44,-7790.2"/>
<polygon fill="black" stroke="black" points="10081.76,-7786.95 10071.24,-7785.74 10078.71,-7793.25 10081.76,-7786.95"/>
</g>
<!-- kv_send2_7_5 -->
<g id="node1544" class="node">
<title>kv_send2_7_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11408" cy="-9131.44" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11408" y="-9135.24" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="11408" y="-9120.24" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_7_5&#45;&gt;kv_send2_7_5 -->
<g id="edge2147" class="edge">
<title>ring_stage2_7_5&#45;&gt;kv_send2_7_5</title>
<path fill="none" stroke="black" d="M11416.46,-9194.32C11415.35,-9186.19 11414.1,-9177.05 11412.91,-9168.34"/>
<polygon fill="black" stroke="black" points="11416.37,-9167.84 11411.55,-9158.4 11409.44,-9168.79 11416.37,-9167.84"/>
</g>
<!-- ring_stage2_8_5 -->
<g id="node1560" class="node">
<title>ring_stage2_8_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11751.5,-9157.94 11540.5,-9157.94 11540.5,-9104.94 11751.5,-9104.94 11751.5,-9157.94"/>
<text text-anchor="middle" x="11646" y="-9142.74" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="11646" y="-9127.74" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_13×V_13</text>
<text text-anchor="middle" x="11646" y="-9112.74" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_7_5&#45;&gt;ring_stage2_8_5 -->
<g id="edge2193" class="edge">
<title>ring_stage2_7_5&#45;&gt;ring_stage2_8_5</title>
<path fill="none" stroke="black" d="M11485.98,-9194.56C11512.43,-9184.29 11543.07,-9172.39 11570.42,-9161.78"/>
<polygon fill="black" stroke="black" points="11571.89,-9164.96 11579.94,-9158.08 11569.35,-9158.44 11571.89,-9164.96"/>
</g>
<!-- kv_send2_7_6 -->
<g id="node1545" class="node">
<title>kv_send2_7_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11127" cy="-9041.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11127" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="11127" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_7_6&#45;&gt;kv_send2_7_6 -->
<g id="edge2150" class="edge">
<title>ring_stage2_7_6&#45;&gt;kv_send2_7_6</title>
<path fill="none" stroke="black" d="M11126.29,-9104.58C11126.39,-9096.53 11126.49,-9087.51 11126.59,-9078.88"/>
<polygon fill="black" stroke="black" points="11130.09,-9078.7 11126.7,-9068.66 11123.09,-9078.62 11130.09,-9078.7"/>
</g>
<!-- ring_stage2_8_6 -->
<g id="node1561" class="node">
<title>ring_stage2_8_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11503.5,-9068.2 11292.5,-9068.2 11292.5,-9015.2 11503.5,-9015.2 11503.5,-9068.2"/>
<text text-anchor="middle" x="11398" y="-9053" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="11398" y="-9038" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_14×V_14</text>
<text text-anchor="middle" x="11398" y="-9023" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_7_6&#45;&gt;ring_stage2_8_6 -->
<g id="edge2196" class="edge">
<title>ring_stage2_7_6&#45;&gt;ring_stage2_8_6</title>
<path fill="none" stroke="black" d="M11205.4,-9104.82C11237.8,-9094.37 11275.41,-9082.24 11308.76,-9071.48"/>
<polygon fill="black" stroke="black" points="11310.05,-9074.74 11318.5,-9068.34 11307.9,-9068.08 11310.05,-9074.74"/>
</g>
<!-- kv_send2_7_7 -->
<g id="node1546" class="node">
<title>kv_send2_7_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10901" cy="-8951.95" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10901" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="10901" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_7_7&#45;&gt;kv_send2_7_7 -->
<g id="edge2153" class="edge">
<title>ring_stage2_7_7&#45;&gt;kv_send2_7_7</title>
<path fill="none" stroke="black" d="M10900.29,-9014.84C10900.39,-9006.79 10900.49,-8997.76 10900.59,-8989.14"/>
<polygon fill="black" stroke="black" points="10904.09,-8988.96 10900.7,-8978.92 10897.09,-8988.88 10904.09,-8988.96"/>
</g>
<!-- ring_stage2_8_7 -->
<g id="node1562" class="node">
<title>ring_stage2_8_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11234.5,-8978.45 11023.5,-8978.45 11023.5,-8925.45 11234.5,-8925.45 11234.5,-8978.45"/>
<text text-anchor="middle" x="11129" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="11129" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_15×V_15</text>
<text text-anchor="middle" x="11129" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_7_7&#45;&gt;ring_stage2_8_7 -->
<g id="edge2199" class="edge">
<title>ring_stage2_7_7&#45;&gt;ring_stage2_8_7</title>
<path fill="none" stroke="black" d="M10966.85,-9015.08C10993.66,-9004.81 11024.71,-8992.91 11052.42,-8982.3"/>
<polygon fill="black" stroke="black" points="11053.98,-8985.45 11062.07,-8978.6 11051.47,-8978.91 11053.98,-8985.45"/>
</g>
<!-- kv_send2_7_8 -->
<g id="node1547" class="node">
<title>kv_send2_7_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10685" cy="-8862.21" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10685" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="10685" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_7_8&#45;&gt;kv_send2_7_8 -->
<g id="edge2156" class="edge">
<title>ring_stage2_7_8&#45;&gt;kv_send2_7_8</title>
<path fill="none" stroke="black" d="M10667.37,-8925.1C10669.71,-8916.88 10672.35,-8907.63 10674.85,-8898.84"/>
<polygon fill="black" stroke="black" points="10678.23,-8899.76 10677.6,-8889.18 10671.49,-8897.84 10678.23,-8899.76"/>
</g>
<!-- ring_stage2_8_8 -->
<g id="node1563" class="node">
<title>ring_stage2_8_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10999.5,-8888.71 10806.5,-8888.71 10806.5,-8835.71 10999.5,-8835.71 10999.5,-8888.71"/>
<text text-anchor="middle" x="10903" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="10903" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_0×V_0</text>
<text text-anchor="middle" x="10903" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_7_8&#45;&gt;ring_stage2_8_8 -->
<g id="edge2202" class="edge">
<title>ring_stage2_7_8&#45;&gt;ring_stage2_8_8</title>
<path fill="none" stroke="black" d="M10730.94,-8925.34C10759.63,-8914.98 10792.91,-8902.97 10822.5,-8892.28"/>
<polygon fill="black" stroke="black" points="10823.76,-8895.55 10831.97,-8888.86 10821.38,-8888.96 10823.76,-8895.55"/>
</g>
<!-- kv_send2_7_9 -->
<g id="node1548" class="node">
<title>kv_send2_7_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10434" cy="-8772.47" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10434" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10434" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_7_9&#45;&gt;kv_send2_7_9 -->
<g id="edge2159" class="edge">
<title>ring_stage2_7_9&#45;&gt;kv_send2_7_9</title>
<path fill="none" stroke="black" d="M10437.53,-8835.36C10437.07,-8827.31 10436.55,-8818.28 10436.06,-8809.66"/>
<polygon fill="black" stroke="black" points="10439.54,-8809.23 10435.48,-8799.44 10432.55,-8809.63 10439.54,-8809.23"/>
</g>
<!-- ring_stage2_8_9 -->
<g id="node1564" class="node">
<title>ring_stage2_8_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10778.5,-8798.97 10585.5,-8798.97 10585.5,-8745.97 10778.5,-8745.97 10778.5,-8798.97"/>
<text text-anchor="middle" x="10682" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="10682" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_1×V_1</text>
<text text-anchor="middle" x="10682" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_7_9&#45;&gt;ring_stage2_8_9 -->
<g id="edge2205" class="edge">
<title>ring_stage2_7_9&#45;&gt;ring_stage2_8_9</title>
<path fill="none" stroke="black" d="M10509.94,-8835.6C10538.63,-8825.24 10571.91,-8813.23 10601.5,-8802.54"/>
<polygon fill="black" stroke="black" points="10602.76,-8805.81 10610.97,-8799.12 10600.38,-8799.22 10602.76,-8805.81"/>
</g>
<!-- kv_send2_7_10 -->
<g id="node1549" class="node">
<title>kv_send2_7_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10200" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10200" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="10200" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_7_10&#45;&gt;kv_send2_7_10 -->
<g id="edge2162" class="edge">
<title>ring_stage2_7_10&#45;&gt;kv_send2_7_10</title>
<path fill="none" stroke="black" d="M10203.53,-8745.62C10203.07,-8737.57 10202.55,-8728.54 10202.06,-8719.92"/>
<polygon fill="black" stroke="black" points="10205.54,-8719.49 10201.48,-8709.7 10198.55,-8719.89 10205.54,-8719.49"/>
</g>
<!-- ring_stage2_8_10 -->
<g id="node1565" class="node">
<title>ring_stage2_8_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10530,-8709.23 10328,-8709.23 10328,-8656.23 10530,-8656.23 10530,-8709.23"/>
<text text-anchor="middle" x="10429" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="10429" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_2×V_2</text>
<text text-anchor="middle" x="10429" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_7_10&#45;&gt;ring_stage2_8_10 -->
<g id="edge2208" class="edge">
<title>ring_stage2_7_10&#45;&gt;ring_stage2_8_10</title>
<path fill="none" stroke="black" d="M10270.39,-8745.86C10296.61,-8735.59 10326.98,-8723.69 10354.09,-8713.08"/>
<polygon fill="black" stroke="black" points="10355.49,-8716.29 10363.53,-8709.38 10352.94,-8709.77 10355.49,-8716.29"/>
</g>
<!-- kv_send2_7_11 -->
<g id="node1550" class="node">
<title>kv_send2_7_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9960" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9960" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9960" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_7_11&#45;&gt;kv_send2_7_11 -->
<g id="edge2165" class="edge">
<title>ring_stage2_7_11&#45;&gt;kv_send2_7_11</title>
<path fill="none" stroke="black" d="M9967.76,-8655.88C9966.74,-8647.75 9965.59,-8638.61 9964.5,-8629.9"/>
<polygon fill="black" stroke="black" points="9967.97,-8629.45 9963.26,-8619.96 9961.03,-8630.32 9967.97,-8629.45"/>
</g>
<!-- ring_stage2_8_11 -->
<g id="node1566" class="node">
<title>ring_stage2_8_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10290,-8619.49 10088,-8619.49 10088,-8566.49 10290,-8566.49 10290,-8619.49"/>
<text text-anchor="middle" x="10189" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="10189" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_3×V_3</text>
<text text-anchor="middle" x="10189" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_7_11&#45;&gt;ring_stage2_8_11 -->
<g id="edge2211" class="edge">
<title>ring_stage2_7_11&#45;&gt;ring_stage2_8_11</title>
<path fill="none" stroke="black" d="M10034.64,-8656.12C10060.05,-8645.89 10089.46,-8634.06 10115.75,-8623.48"/>
<polygon fill="black" stroke="black" points="10117.31,-8626.62 10125.28,-8619.64 10114.7,-8620.13 10117.31,-8626.62"/>
</g>
<!-- kv_send2_7_12 -->
<g id="node1551" class="node">
<title>kv_send2_7_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9731" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9731" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="9731" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_7_12&#45;&gt;kv_send2_7_12 -->
<g id="edge2168" class="edge">
<title>ring_stage2_7_12&#45;&gt;kv_send2_7_12</title>
<path fill="none" stroke="black" d="M9731,-8566.14C9731,-8558.09 9731,-8549.06 9731,-8540.44"/>
<polygon fill="black" stroke="black" points="9734.5,-8540.22 9731,-8530.22 9727.5,-8540.22 9734.5,-8540.22"/>
</g>
<!-- ring_stage2_8_12 -->
<g id="node1567" class="node">
<title>ring_stage2_8_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10061,-8529.75 9859,-8529.75 9859,-8476.75 10061,-8476.75 10061,-8529.75"/>
<text text-anchor="middle" x="9960" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="9960" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_4×V_4</text>
<text text-anchor="middle" x="9960" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_7_12&#45;&gt;ring_stage2_8_12 -->
<g id="edge2214" class="edge">
<title>ring_stage2_7_12&#45;&gt;ring_stage2_8_12</title>
<path fill="none" stroke="black" d="M9797.85,-8566.38C9824.66,-8556.11 9855.71,-8544.21 9883.42,-8533.6"/>
<polygon fill="black" stroke="black" points="9884.98,-8536.75 9893.07,-8529.9 9882.47,-8530.21 9884.98,-8536.75"/>
</g>
<!-- kv_send2_7_13 -->
<g id="node1552" class="node">
<title>kv_send2_7_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9467" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9467" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9467" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_7_13&#45;&gt;kv_send2_7_13 -->
<g id="edge2171" class="edge">
<title>ring_stage2_7_13&#45;&gt;kv_send2_7_13</title>
<path fill="none" stroke="black" d="M9477.58,-8476.4C9476.19,-8468.27 9474.63,-8459.13 9473.14,-8450.42"/>
<polygon fill="black" stroke="black" points="9476.57,-8449.75 9471.44,-8440.48 9469.67,-8450.93 9476.57,-8449.75"/>
</g>
<!-- ring_stage2_8_13 -->
<g id="node1568" class="node">
<title>ring_stage2_8_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9818,-8440.01 9616,-8440.01 9616,-8387.01 9818,-8387.01 9818,-8440.01"/>
<text text-anchor="middle" x="9717" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="9717" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_5×V_5</text>
<text text-anchor="middle" x="9717" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_7_13&#45;&gt;ring_stage2_8_13 -->
<g id="edge2217" class="edge">
<title>ring_stage2_7_13&#45;&gt;ring_stage2_8_13</title>
<path fill="none" stroke="black" d="M9550.6,-8476.64C9578.23,-8466.32 9610.25,-8454.37 9638.78,-8443.72"/>
<polygon fill="black" stroke="black" points="9640.17,-8446.94 9648.31,-8440.16 9637.72,-8440.38 9640.17,-8446.94"/>
</g>
<!-- kv_send2_7_14 -->
<g id="node1553" class="node">
<title>kv_send2_7_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9224" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9224" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9224" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_7_14&#45;&gt;kv_send2_7_14 -->
<g id="edge2174" class="edge">
<title>ring_stage2_7_14&#45;&gt;kv_send2_7_14</title>
<path fill="none" stroke="black" d="M9233.17,-8386.66C9231.96,-8378.53 9230.61,-8369.39 9229.32,-8360.68"/>
<polygon fill="black" stroke="black" points="9232.78,-8360.12 9227.85,-8350.74 9225.85,-8361.15 9232.78,-8360.12"/>
</g>
<!-- ring_stage2_8_14 -->
<g id="node1569" class="node">
<title>ring_stage2_8_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9554,-8350.27 9352,-8350.27 9352,-8297.27 9554,-8297.27 9554,-8350.27"/>
<text text-anchor="middle" x="9453" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="9453" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_6×V_6</text>
<text text-anchor="middle" x="9453" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_7_14&#45;&gt;ring_stage2_8_14 -->
<g id="edge2220" class="edge">
<title>ring_stage2_7_14&#45;&gt;ring_stage2_8_14</title>
<path fill="none" stroke="black" d="M9300.06,-8386.9C9325.23,-8376.67 9354.37,-8364.84 9380.42,-8354.26"/>
<polygon fill="black" stroke="black" points="9381.92,-8357.43 9389.86,-8350.42 9379.28,-8350.94 9381.92,-8357.43"/>
</g>
<!-- kv_send2_7_15 -->
<g id="node1554" class="node">
<title>kv_send2_7_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8993" cy="-8234.03" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8993" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8993" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_7_15&#45;&gt;kv_send2_7_15 -->
<g id="edge2177" class="edge">
<title>ring_stage2_7_15&#45;&gt;kv_send2_7_15</title>
<path fill="none" stroke="black" d="M8994.41,-8296.92C8994.23,-8288.87 8994.02,-8279.84 8993.82,-8271.22"/>
<polygon fill="black" stroke="black" points="8997.32,-8270.92 8993.59,-8261 8990.32,-8271.08 8997.32,-8270.92"/>
</g>
<!-- ring_stage2_8_15 -->
<g id="node1570" class="node">
<title>ring_stage2_8_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9316,-8260.53 9114,-8260.53 9114,-8207.53 9316,-8207.53 9316,-8260.53"/>
<text text-anchor="middle" x="9215" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="9215" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_7×V_7</text>
<text text-anchor="middle" x="9215" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_7_15&#45;&gt;ring_stage2_8_15 -->
<g id="edge2223" class="edge">
<title>ring_stage2_7_15&#45;&gt;ring_stage2_8_15</title>
<path fill="none" stroke="black" d="M9059.22,-8297.16C9084.87,-8286.93 9114.55,-8275.1 9141.08,-8264.52"/>
<polygon fill="black" stroke="black" points="9142.7,-8267.64 9150.7,-8260.68 9140.11,-8261.13 9142.7,-8267.64"/>
</g>
<!-- kv_send2_7_0&#45;&gt;ring_stage2_8_1 -->
<g id="edge2182" class="edge">
<title>kv_send2_7_0&#45;&gt;ring_stage2_8_1</title>
<path fill="none" stroke="black" d="M8478.05,-8125.46C8465.39,-8122.62 8452.34,-8119.83 8440,-8117.42 8343.71,-8098.62 8315.99,-8101.25 8215.63,-8081.48"/>
<polygon fill="black" stroke="black" points="8216.18,-8078.02 8205.69,-8079.49 8214.81,-8084.88 8216.18,-8078.02"/>
</g>
<!-- kv_send2_7_1&#45;&gt;ring_stage2_8_2 -->
<g id="edge2185" class="edge">
<title>kv_send2_7_1&#45;&gt;ring_stage2_8_2</title>
<path fill="none" stroke="black" d="M8399.3,-8035.24C8412.45,-8032.37 8426.08,-8029.7 8439,-8027.68 8627.83,-7998.24 8681.02,-8020.48 8873.06,-7991.89"/>
<polygon fill="black" stroke="black" points="8873.84,-7995.31 8883.21,-7990.35 8872.8,-7988.39 8873.84,-7995.31"/>
</g>
<!-- kv_send2_7_2&#45;&gt;ring_stage2_8_3 -->
<g id="edge2188" class="edge">
<title>kv_send2_7_2&#45;&gt;ring_stage2_8_3</title>
<path fill="none" stroke="black" d="M9478.35,-7939.61C9494.23,-7929.58 9512.84,-7917.84 9529.71,-7907.19"/>
<polygon fill="black" stroke="black" points="9531.76,-7910.03 9538.35,-7901.74 9528.02,-7904.11 9531.76,-7910.03"/>
</g>
<!-- kv_send2_7_3&#45;&gt;ring_stage2_8_4 -->
<g id="edge2191" class="edge">
<title>kv_send2_7_3&#45;&gt;ring_stage2_8_4</title>
<path fill="none" stroke="black" d="M10026,-7847.95C10026,-7832.51 10026,-7812.74 10026,-7795.87"/>
<polygon fill="black" stroke="black" points="10029.5,-7795.81 10026,-7785.81 10022.5,-7795.81 10029.5,-7795.81"/>
</g>
<!-- kv_send2_7_4&#45;&gt;ring_stage2_8_5 -->
<g id="edge2194" class="edge">
<title>kv_send2_7_4&#45;&gt;ring_stage2_8_5</title>
<path fill="none" stroke="black" d="M11654.4,-9193.85C11653.3,-9185.81 11652.07,-9176.83 11650.9,-9168.27"/>
<polygon fill="black" stroke="black" points="11654.34,-9167.57 11649.52,-9158.14 11647.4,-9168.52 11654.34,-9167.57"/>
</g>
<!-- kv_send2_7_5&#45;&gt;ring_stage2_8_6 -->
<g id="edge2197" class="edge">
<title>kv_send2_7_5&#45;&gt;ring_stage2_8_6</title>
<path fill="none" stroke="black" d="M11405,-9104.11C11404.08,-9096.07 11403.06,-9087.09 11402.08,-9078.53"/>
<polygon fill="black" stroke="black" points="11405.54,-9077.94 11400.93,-9068.4 11398.58,-9078.73 11405.54,-9077.94"/>
</g>
<!-- kv_send2_7_6&#45;&gt;ring_stage2_8_7 -->
<g id="edge2200" class="edge">
<title>kv_send2_7_6&#45;&gt;ring_stage2_8_7</title>
<path fill="none" stroke="black" d="M11127.6,-9014.37C11127.78,-9006.33 11127.99,-8997.35 11128.18,-8988.79"/>
<polygon fill="black" stroke="black" points="11131.69,-8988.73 11128.41,-8978.66 11124.69,-8988.58 11131.69,-8988.73"/>
</g>
<!-- kv_send2_7_7&#45;&gt;ring_stage2_8_8 -->
<g id="edge2203" class="edge">
<title>kv_send2_7_7&#45;&gt;ring_stage2_8_8</title>
<path fill="none" stroke="black" d="M10901.6,-8924.63C10901.78,-8916.59 10901.99,-8907.61 10902.18,-8899.05"/>
<polygon fill="black" stroke="black" points="10905.69,-8898.99 10902.41,-8888.92 10898.69,-8898.83 10905.69,-8898.99"/>
</g>
<!-- kv_send2_7_8&#45;&gt;ring_stage2_8_9 -->
<g id="edge2206" class="edge">
<title>kv_send2_7_8&#45;&gt;ring_stage2_8_9</title>
<path fill="none" stroke="black" d="M10684.1,-8834.89C10683.83,-8826.85 10683.52,-8817.87 10683.23,-8809.31"/>
<polygon fill="black" stroke="black" points="10686.72,-8809.05 10682.88,-8799.18 10679.72,-8809.29 10686.72,-8809.05"/>
</g>
<!-- kv_send2_7_9&#45;&gt;ring_stage2_8_10 -->
<g id="edge2209" class="edge">
<title>kv_send2_7_9&#45;&gt;ring_stage2_8_10</title>
<path fill="none" stroke="black" d="M10432.5,-8745.15C10432.04,-8737.11 10431.53,-8728.13 10431.04,-8719.57"/>
<polygon fill="black" stroke="black" points="10434.53,-8719.22 10430.46,-8709.44 10427.54,-8719.62 10434.53,-8719.22"/>
</g>
<!-- kv_send2_7_10&#45;&gt;ring_stage2_8_11 -->
<g id="edge2212" class="edge">
<title>kv_send2_7_10&#45;&gt;ring_stage2_8_11</title>
<path fill="none" stroke="black" d="M10196.7,-8655.41C10195.69,-8647.37 10194.57,-8638.39 10193.49,-8629.83"/>
<polygon fill="black" stroke="black" points="10196.94,-8629.18 10192.22,-8619.7 10189.99,-8630.05 10196.94,-8629.18"/>
</g>
<!-- kv_send2_7_11&#45;&gt;ring_stage2_8_12 -->
<g id="edge2215" class="edge">
<title>kv_send2_7_11&#45;&gt;ring_stage2_8_12</title>
<path fill="none" stroke="black" d="M9960,-8565.67C9960,-8557.63 9960,-8548.65 9960,-8540.09"/>
<polygon fill="black" stroke="black" points="9963.5,-8539.96 9960,-8529.96 9956.5,-8539.96 9963.5,-8539.96"/>
</g>
<!-- kv_send2_7_12&#45;&gt;ring_stage2_8_13 -->
<g id="edge2218" class="edge">
<title>kv_send2_7_12&#45;&gt;ring_stage2_8_13</title>
<path fill="none" stroke="black" d="M9726.8,-8475.93C9725.52,-8467.89 9724.08,-8458.91 9722.72,-8450.35"/>
<polygon fill="black" stroke="black" points="9726.13,-8449.54 9721.1,-8440.22 9719.22,-8450.64 9726.13,-8449.54"/>
</g>
<!-- kv_send2_7_13&#45;&gt;ring_stage2_8_14 -->
<g id="edge2221" class="edge">
<title>kv_send2_7_13&#45;&gt;ring_stage2_8_14</title>
<path fill="none" stroke="black" d="M9462.8,-8386.19C9461.52,-8378.15 9460.08,-8369.17 9458.72,-8360.61"/>
<polygon fill="black" stroke="black" points="9462.13,-8359.8 9457.1,-8350.48 9455.22,-8360.9 9462.13,-8359.8"/>
</g>
<!-- kv_send2_7_14&#45;&gt;ring_stage2_8_15 -->
<g id="edge2224" class="edge">
<title>kv_send2_7_14&#45;&gt;ring_stage2_8_15</title>
<path fill="none" stroke="black" d="M9221.3,-8296.45C9220.48,-8288.41 9219.55,-8279.43 9218.68,-8270.87"/>
<polygon fill="black" stroke="black" points="9222.14,-8270.33 9217.64,-8260.74 9215.18,-8271.04 9222.14,-8270.33"/>
</g>
<!-- kv_send2_7_15&#45;&gt;ring_stage2_8_0 -->
<g id="edge2179" class="edge">
<title>kv_send2_7_15&#45;&gt;ring_stage2_8_0</title>
<path fill="none" stroke="black" d="M8937.59,-8211.23C8909.42,-8200.15 8874.78,-8186.52 8844.33,-8174.54"/>
<polygon fill="black" stroke="black" points="8845.61,-8171.28 8835.02,-8170.88 8843.05,-8177.8 8845.61,-8171.28"/>
</g>
<!-- kv_send2_8_0 -->
<g id="node1571" class="node">
<title>kv_send2_8_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8551" cy="-8054.55" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8551" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8551" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_8_0&#45;&gt;kv_send2_8_0 -->
<g id="edge2180" class="edge">
<title>ring_stage2_8_0&#45;&gt;kv_send2_8_0</title>
<path fill="none" stroke="black" d="M8706.07,-8117.68C8677.48,-8106.23 8643.86,-8092.76 8615.24,-8081.29"/>
<polygon fill="black" stroke="black" points="8616.32,-8077.95 8605.74,-8077.48 8613.72,-8084.45 8616.32,-8077.95"/>
</g>
<!-- ring_stage2_9_0 -->
<g id="node1587" class="node">
<title>ring_stage2_9_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8865.5,-8081.05 8672.5,-8081.05 8672.5,-8028.05 8865.5,-8028.05 8865.5,-8081.05"/>
<text text-anchor="middle" x="8769" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="8769" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_7×V_7</text>
<text text-anchor="middle" x="8769" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_8_0&#45;&gt;ring_stage2_9_0 -->
<g id="edge2226" class="edge">
<title>ring_stage2_8_0&#45;&gt;ring_stage2_9_0</title>
<path fill="none" stroke="black" d="M8769.71,-8117.44C8769.61,-8109.23 8769.51,-8100 8769.41,-8091.23"/>
<polygon fill="black" stroke="black" points="8772.91,-8091.18 8769.29,-8081.22 8765.91,-8091.26 8772.91,-8091.18"/>
</g>
<!-- kv_send2_8_1 -->
<g id="node1572" class="node">
<title>kv_send2_8_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8551" cy="-7964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8551" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8551" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_8_1&#45;&gt;kv_send2_8_1 -->
<g id="edge2183" class="edge">
<title>ring_stage2_8_1&#45;&gt;kv_send2_8_1</title>
<path fill="none" stroke="black" d="M8205.69,-8029.62C8208.83,-8028.95 8211.94,-8028.3 8215,-8027.68 8313.84,-8007.71 8340.04,-8011.04 8439,-7991.68 8448.16,-7989.89 8457.71,-7987.89 8467.2,-7985.82"/>
<polygon fill="black" stroke="black" points="8468.04,-7989.22 8477.05,-7983.64 8466.53,-7982.38 8468.04,-7989.22"/>
</g>
<!-- ring_stage2_9_1 -->
<g id="node1588" class="node">
<title>ring_stage2_9_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8205.5,-7991.31 8012.5,-7991.31 8012.5,-7938.31 8205.5,-7938.31 8205.5,-7991.31"/>
<text text-anchor="middle" x="8109" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="8109" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_8×V_8</text>
<text text-anchor="middle" x="8109" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_8_1&#45;&gt;ring_stage2_9_1 -->
<g id="edge2229" class="edge">
<title>ring_stage2_8_1&#45;&gt;ring_stage2_9_1</title>
<path fill="none" stroke="black" d="M8109,-8027.7C8109,-8019.49 8109,-8010.26 8109,-8001.49"/>
<polygon fill="black" stroke="black" points="8112.5,-8001.48 8109,-7991.48 8105.5,-8001.48 8112.5,-8001.48"/>
</g>
<!-- kv_send2_8_2 -->
<g id="node1573" class="node">
<title>kv_send2_8_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9352" cy="-7875.07" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9352" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="9352" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_8_2&#45;&gt;kv_send2_8_2 -->
<g id="edge2186" class="edge">
<title>ring_stage2_8_2&#45;&gt;kv_send2_8_2</title>
<path fill="none" stroke="black" d="M9094.97,-7938.2C9150.21,-7924.85 9216.82,-7908.75 9268.38,-7896.28"/>
<polygon fill="black" stroke="black" points="9269.26,-7899.67 9278.16,-7893.92 9267.62,-7892.87 9269.26,-7899.67"/>
</g>
<!-- ring_stage2_9_2 -->
<g id="node1589" class="node">
<title>ring_stage2_9_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8795.5,-7901.57 8602.5,-7901.57 8602.5,-7848.57 8795.5,-7848.57 8795.5,-7901.57"/>
<text text-anchor="middle" x="8699" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="8699" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_9×V_9</text>
<text text-anchor="middle" x="8699" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_8_2&#45;&gt;ring_stage2_9_2 -->
<g id="edge2232" class="edge">
<title>ring_stage2_8_2&#45;&gt;ring_stage2_9_2</title>
<path fill="none" stroke="black" d="M8904.34,-7938.2C8869.57,-7927.68 8829.18,-7915.46 8793.46,-7904.65"/>
<polygon fill="black" stroke="black" points="8794.1,-7901.19 8783.51,-7901.64 8792.07,-7907.89 8794.1,-7901.19"/>
</g>
<!-- kv_send2_8_3 -->
<g id="node1574" class="node">
<title>kv_send2_8_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9575" cy="-7759.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9575" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9575" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_8_3&#45;&gt;kv_send2_8_3 -->
<g id="edge2189" class="edge">
<title>ring_stage2_8_3&#45;&gt;kv_send2_8_3</title>
<path fill="none" stroke="black" d="M9578.1,-7848.52C9577.56,-7833.21 9576.87,-7813.49 9576.28,-7796.57"/>
<polygon fill="black" stroke="black" points="9579.77,-7796.33 9575.92,-7786.46 9572.78,-7796.58 9579.77,-7796.33"/>
</g>
<!-- ring_stage2_9_3 -->
<g id="node1590" class="node">
<title>ring_stage2_9_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9453.5,-7785.7 9242.5,-7785.7 9242.5,-7732.7 9453.5,-7732.7 9453.5,-7785.7"/>
<text text-anchor="middle" x="9348" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="9348" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_10×V_10</text>
<text text-anchor="middle" x="9348" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_8_3&#45;&gt;ring_stage2_9_3 -->
<g id="edge2235" class="edge">
<title>ring_stage2_8_3&#45;&gt;ring_stage2_9_3</title>
<path fill="none" stroke="black" d="M9527.16,-7848.52C9492.21,-7831.29 9445.95,-7808.49 9409.19,-7790.37"/>
<polygon fill="black" stroke="black" points="9410.58,-7787.15 9400.07,-7785.87 9407.49,-7793.43 9410.58,-7787.15"/>
</g>
<!-- kv_send2_8_4 -->
<g id="node1575" class="node">
<title>kv_send2_8_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10011" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10011" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="10011" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_8_4&#45;&gt;kv_send2_8_4 -->
<g id="edge2192" class="edge">
<title>ring_stage2_8_4&#45;&gt;kv_send2_8_4</title>
<path fill="none" stroke="black" d="M10023.25,-7732.53C10020.9,-7710.56 10017.48,-7678.71 10014.86,-7654.2"/>
<polygon fill="black" stroke="black" points="10018.33,-7653.76 10013.78,-7644.19 10011.37,-7654.51 10018.33,-7653.76"/>
</g>
<!-- ring_stage2_9_4 -->
<g id="node1591" class="node">
<title>ring_stage2_9_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9889.5,-7643.7 9678.5,-7643.7 9678.5,-7590.7 9889.5,-7590.7 9889.5,-7643.7"/>
<text text-anchor="middle" x="9784" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="9784" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_11×V_11</text>
<text text-anchor="middle" x="9784" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_8_4&#45;&gt;ring_stage2_9_4 -->
<g id="edge2238" class="edge">
<title>ring_stage2_8_4&#45;&gt;ring_stage2_9_4</title>
<path fill="none" stroke="black" d="M9981.89,-7732.69C9941.08,-7709.08 9880.34,-7673.94 9836.92,-7648.82"/>
<polygon fill="black" stroke="black" points="9838.62,-7645.76 9828.21,-7643.78 9835.11,-7651.82 9838.62,-7645.76"/>
</g>
<!-- kv_send2_8_5 -->
<g id="node1576" class="node">
<title>kv_send2_8_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11635" cy="-9041.7" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11635" y="-9045.5" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="11635" y="-9030.5" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_8_5&#45;&gt;kv_send2_8_5 -->
<g id="edge2195" class="edge">
<title>ring_stage2_8_5&#45;&gt;kv_send2_8_5</title>
<path fill="none" stroke="black" d="M11642.76,-9104.58C11641.74,-9096.45 11640.59,-9087.31 11639.5,-9078.6"/>
<polygon fill="black" stroke="black" points="11642.97,-9078.15 11638.26,-9068.66 11636.03,-9079.02 11642.97,-9078.15"/>
</g>
<!-- ring_stage2_9_5 -->
<g id="node1592" class="node">
<title>ring_stage2_9_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10609.5,-7501.7 10398.5,-7501.7 10398.5,-7448.7 10609.5,-7448.7 10609.5,-7501.7"/>
<text text-anchor="middle" x="10504" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="10504" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_12×V_12</text>
<text text-anchor="middle" x="10504" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_8_5&#45;&gt;ring_stage2_9_5 -->
<g id="edge2241" class="edge">
<title>ring_stage2_8_5&#45;&gt;ring_stage2_9_5</title>
<path fill="none" stroke="black" d="M11707.3,-9104.83C11722.57,-9095.59 11737.33,-9083.62 11747,-9068.57 11774.97,-9025.01 11761,-9004.71 11761,-8952.95 11761,-8952.95 11761,-8952.95 11761,-8233.03 11761,-8144.95 11732.16,-7906.36 11666,-7848.2 11612.92,-7801.54 11397.06,-7864.93 11350,-7812.2 11318.63,-7777.06 11321.16,-7743.46 11350,-7706.2 11389.06,-7655.74 11449.94,-7720.67 11489,-7670.2 11517.84,-7632.95 11521.62,-7598.2 11489,-7564.2 11455.51,-7529.3 10666.07,-7539.37 10619,-7528.2 10598.66,-7523.38 10577.52,-7514.93 10558.99,-7506.23"/>
<polygon fill="black" stroke="black" points="10560.36,-7503 10549.84,-7501.81 10557.32,-7509.31 10560.36,-7503"/>
</g>
<!-- kv_send2_8_6 -->
<g id="node1577" class="node">
<title>kv_send2_8_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11382" cy="-8951.95" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11382" y="-8955.75" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="11382" y="-8940.75" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_8_6&#45;&gt;kv_send2_8_6 -->
<g id="edge2198" class="edge">
<title>ring_stage2_8_6&#45;&gt;kv_send2_8_6</title>
<path fill="none" stroke="black" d="M11393.29,-9014.84C11391.8,-9006.71 11390.14,-8997.57 11388.55,-8988.86"/>
<polygon fill="black" stroke="black" points="11391.97,-8988.13 11386.74,-8978.92 11385.09,-8989.39 11391.97,-8988.13"/>
</g>
<!-- ring_stage2_9_6 -->
<g id="node1593" class="node">
<title>ring_stage2_9_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11736.5,-8978.45 11525.5,-8978.45 11525.5,-8925.45 11736.5,-8925.45 11736.5,-8978.45"/>
<text text-anchor="middle" x="11631" y="-8963.25" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="11631" y="-8948.25" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_13×V_13</text>
<text text-anchor="middle" x="11631" y="-8933.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_8_6&#45;&gt;ring_stage2_9_6 -->
<g id="edge2244" class="edge">
<title>ring_stage2_8_6&#45;&gt;ring_stage2_9_6</title>
<path fill="none" stroke="black" d="M11466.02,-9015.08C11493.41,-9004.77 11525.16,-8992.81 11553.45,-8982.16"/>
<polygon fill="black" stroke="black" points="11554.77,-8985.4 11562.9,-8978.6 11552.3,-8978.85 11554.77,-8985.4"/>
</g>
<!-- kv_send2_8_7 -->
<g id="node1578" class="node">
<title>kv_send2_8_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11129" cy="-8862.21" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11129" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11129" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_8_7&#45;&gt;kv_send2_8_7 -->
<g id="edge2201" class="edge">
<title>ring_stage2_8_7&#45;&gt;kv_send2_8_7</title>
<path fill="none" stroke="black" d="M11129,-8925.1C11129,-8917.05 11129,-8908.02 11129,-8899.4"/>
<polygon fill="black" stroke="black" points="11132.5,-8899.18 11129,-8889.18 11125.5,-8899.18 11132.5,-8899.18"/>
</g>
<!-- ring_stage2_9_7 -->
<g id="node1594" class="node">
<title>ring_stage2_9_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11485.5,-8888.71 11274.5,-8888.71 11274.5,-8835.71 11485.5,-8835.71 11485.5,-8888.71"/>
<text text-anchor="middle" x="11380" y="-8873.51" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="11380" y="-8858.51" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_14×V_14</text>
<text text-anchor="middle" x="11380" y="-8843.51" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_8_7&#45;&gt;ring_stage2_9_7 -->
<g id="edge2247" class="edge">
<title>ring_stage2_8_7&#45;&gt;ring_stage2_9_7</title>
<path fill="none" stroke="black" d="M11202.27,-8925.34C11231.91,-8914.98 11266.28,-8902.97 11296.85,-8892.28"/>
<polygon fill="black" stroke="black" points="11298.35,-8895.46 11306.63,-8888.86 11296.04,-8888.86 11298.35,-8895.46"/>
</g>
<!-- kv_send2_8_8 -->
<g id="node1579" class="node">
<title>kv_send2_8_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10902" cy="-8772.47" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10902" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="10902" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_8_8&#45;&gt;kv_send2_8_8 -->
<g id="edge2204" class="edge">
<title>ring_stage2_8_8&#45;&gt;kv_send2_8_8</title>
<path fill="none" stroke="black" d="M10902.71,-8835.36C10902.61,-8827.31 10902.51,-8818.28 10902.41,-8809.66"/>
<polygon fill="black" stroke="black" points="10905.91,-8809.4 10902.3,-8799.44 10898.91,-8809.48 10905.91,-8809.4"/>
</g>
<!-- ring_stage2_9_8 -->
<g id="node1595" class="node">
<title>ring_stage2_9_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11234.5,-8798.97 11023.5,-8798.97 11023.5,-8745.97 11234.5,-8745.97 11234.5,-8798.97"/>
<text text-anchor="middle" x="11129" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="11129" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_15×V_15</text>
<text text-anchor="middle" x="11129" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_8_8&#45;&gt;ring_stage2_9_8 -->
<g id="edge2250" class="edge">
<title>ring_stage2_8_8&#45;&gt;ring_stage2_9_8</title>
<path fill="none" stroke="black" d="M10968.98,-8835.6C10995.43,-8825.33 11026.07,-8813.43 11053.42,-8802.82"/>
<polygon fill="black" stroke="black" points="11054.89,-8806 11062.94,-8799.12 11052.35,-8799.48 11054.89,-8806"/>
</g>
<!-- kv_send2_8_9 -->
<g id="node1580" class="node">
<title>kv_send2_8_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10678" cy="-8682.73" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10678" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10678" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_8_9&#45;&gt;kv_send2_8_9 -->
<g id="edge2207" class="edge">
<title>ring_stage2_8_9&#45;&gt;kv_send2_8_9</title>
<path fill="none" stroke="black" d="M10680.82,-8745.62C10680.45,-8737.57 10680.04,-8728.54 10679.65,-8719.92"/>
<polygon fill="black" stroke="black" points="10683.14,-8719.53 10679.18,-8709.7 10676.14,-8719.85 10683.14,-8719.53"/>
</g>
<!-- ring_stage2_9_9 -->
<g id="node1596" class="node">
<title>ring_stage2_9_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10998.5,-8709.23 10805.5,-8709.23 10805.5,-8656.23 10998.5,-8656.23 10998.5,-8709.23"/>
<text text-anchor="middle" x="10902" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="10902" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_0×V_0</text>
<text text-anchor="middle" x="10902" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_8_9&#45;&gt;ring_stage2_9_9 -->
<g id="edge2253" class="edge">
<title>ring_stage2_8_9&#45;&gt;ring_stage2_9_9</title>
<path fill="none" stroke="black" d="M10746.22,-8745.86C10771.87,-8735.63 10801.55,-8723.8 10828.08,-8713.22"/>
<polygon fill="black" stroke="black" points="10829.7,-8716.34 10837.7,-8709.38 10827.11,-8709.83 10829.7,-8716.34"/>
</g>
<!-- kv_send2_8_10 -->
<g id="node1581" class="node">
<title>kv_send2_8_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10418" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10418" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="10418" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_8_10&#45;&gt;kv_send2_8_10 -->
<g id="edge2210" class="edge">
<title>ring_stage2_8_10&#45;&gt;kv_send2_8_10</title>
<path fill="none" stroke="black" d="M10425.76,-8655.88C10424.74,-8647.75 10423.59,-8638.61 10422.5,-8629.9"/>
<polygon fill="black" stroke="black" points="10425.97,-8629.45 10421.26,-8619.96 10419.03,-8630.32 10425.97,-8629.45"/>
</g>
<!-- ring_stage2_9_10 -->
<g id="node1597" class="node">
<title>ring_stage2_9_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10768,-8619.49 10566,-8619.49 10566,-8566.49 10768,-8566.49 10768,-8619.49"/>
<text text-anchor="middle" x="10667" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="10667" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_1×V_1</text>
<text text-anchor="middle" x="10667" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_8_10&#45;&gt;ring_stage2_9_10 -->
<g id="edge2256" class="edge">
<title>ring_stage2_8_10&#45;&gt;ring_stage2_9_10</title>
<path fill="none" stroke="black" d="M10498.48,-8656.12C10526.46,-8645.8 10558.89,-8633.85 10587.78,-8623.2"/>
<polygon fill="black" stroke="black" points="10589.26,-8626.38 10597.43,-8619.64 10586.84,-8619.82 10589.26,-8626.38"/>
</g>
<!-- kv_send2_8_11 -->
<g id="node1582" class="node">
<title>kv_send2_8_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10189" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10189" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="10189" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_8_11&#45;&gt;kv_send2_8_11 -->
<g id="edge2213" class="edge">
<title>ring_stage2_8_11&#45;&gt;kv_send2_8_11</title>
<path fill="none" stroke="black" d="M10189,-8566.14C10189,-8558.09 10189,-8549.06 10189,-8540.44"/>
<polygon fill="black" stroke="black" points="10192.5,-8540.22 10189,-8530.22 10185.5,-8540.22 10192.5,-8540.22"/>
</g>
<!-- ring_stage2_9_11 -->
<g id="node1598" class="node">
<title>ring_stage2_9_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10519,-8529.75 10317,-8529.75 10317,-8476.75 10519,-8476.75 10519,-8529.75"/>
<text text-anchor="middle" x="10418" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="10418" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_2×V_2</text>
<text text-anchor="middle" x="10418" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_8_11&#45;&gt;ring_stage2_9_11 -->
<g id="edge2259" class="edge">
<title>ring_stage2_8_11&#45;&gt;ring_stage2_9_11</title>
<path fill="none" stroke="black" d="M10255.85,-8566.38C10282.66,-8556.11 10313.71,-8544.21 10341.42,-8533.6"/>
<polygon fill="black" stroke="black" points="10342.98,-8536.75 10351.07,-8529.9 10340.47,-8530.21 10342.98,-8536.75"/>
</g>
<!-- kv_send2_8_12 -->
<g id="node1583" class="node">
<title>kv_send2_8_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9949" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9949" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="9949" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_8_12&#45;&gt;kv_send2_8_12 -->
<g id="edge2216" class="edge">
<title>ring_stage2_8_12&#45;&gt;kv_send2_8_12</title>
<path fill="none" stroke="black" d="M9956.76,-8476.4C9955.74,-8468.27 9954.59,-8459.13 9953.5,-8450.42"/>
<polygon fill="black" stroke="black" points="9956.97,-8449.97 9952.26,-8440.48 9950.03,-8450.84 9956.97,-8449.97"/>
</g>
<!-- ring_stage2_9_12 -->
<g id="node1599" class="node">
<title>ring_stage2_9_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10280,-8440.01 10078,-8440.01 10078,-8387.01 10280,-8387.01 10280,-8440.01"/>
<text text-anchor="middle" x="10179" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="10179" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_3×V_3</text>
<text text-anchor="middle" x="10179" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_8_12&#45;&gt;ring_stage2_9_12 -->
<g id="edge2262" class="edge">
<title>ring_stage2_8_12&#45;&gt;ring_stage2_9_12</title>
<path fill="none" stroke="black" d="M10023.93,-8476.64C10049.46,-8466.41 10079,-8454.58 10105.41,-8444"/>
<polygon fill="black" stroke="black" points="10107.01,-8447.13 10114.99,-8440.16 10104.4,-8440.63 10107.01,-8447.13"/>
</g>
<!-- kv_send2_8_13 -->
<g id="node1584" class="node">
<title>kv_send2_8_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9702" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9702" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9702" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_8_13&#45;&gt;kv_send2_8_13 -->
<g id="edge2219" class="edge">
<title>ring_stage2_8_13&#45;&gt;kv_send2_8_13</title>
<path fill="none" stroke="black" d="M9712.58,-8386.66C9711.19,-8378.53 9709.63,-8369.39 9708.14,-8360.68"/>
<polygon fill="black" stroke="black" points="9711.57,-8360.01 9706.44,-8350.74 9704.67,-8361.19 9711.57,-8360.01"/>
</g>
<!-- ring_stage2_9_13 -->
<g id="node1600" class="node">
<title>ring_stage2_9_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10032,-8350.27 9830,-8350.27 9830,-8297.27 10032,-8297.27 10032,-8350.27"/>
<text text-anchor="middle" x="9931" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="9931" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_4×V_4</text>
<text text-anchor="middle" x="9931" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_8_13&#45;&gt;ring_stage2_9_13 -->
<g id="edge2265" class="edge">
<title>ring_stage2_8_13&#45;&gt;ring_stage2_9_13</title>
<path fill="none" stroke="black" d="M9779.47,-8386.9C9804.41,-8376.67 9833.29,-8364.84 9859.09,-8354.26"/>
<polygon fill="black" stroke="black" points="9860.52,-8357.45 9868.45,-8350.42 9857.87,-8350.98 9860.52,-8357.45"/>
</g>
<!-- kv_send2_8_14 -->
<g id="node1585" class="node">
<title>kv_send2_8_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9444" cy="-8234.03" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9444" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9444" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_8_14&#45;&gt;kv_send2_8_14 -->
<g id="edge2222" class="edge">
<title>ring_stage2_8_14&#45;&gt;kv_send2_8_14</title>
<path fill="none" stroke="black" d="M9450.35,-8296.92C9449.52,-8288.87 9448.6,-8279.84 9447.71,-8271.22"/>
<polygon fill="black" stroke="black" points="9451.17,-8270.59 9446.66,-8261 9444.2,-8271.31 9451.17,-8270.59"/>
</g>
<!-- ring_stage2_9_14 -->
<g id="node1601" class="node">
<title>ring_stage2_9_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9794,-8260.53 9592,-8260.53 9592,-8207.53 9794,-8207.53 9794,-8260.53"/>
<text text-anchor="middle" x="9693" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="9693" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_5×V_5</text>
<text text-anchor="middle" x="9693" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_8_14&#45;&gt;ring_stage2_9_14 -->
<g id="edge2268" class="edge">
<title>ring_stage2_8_14&#45;&gt;ring_stage2_9_14</title>
<path fill="none" stroke="black" d="M9523.06,-8297.16C9551.28,-8286.84 9583.98,-8274.89 9613.12,-8264.24"/>
<polygon fill="black" stroke="black" points="9614.66,-8267.4 9622.85,-8260.68 9612.26,-8260.83 9614.66,-8267.4"/>
</g>
<!-- kv_send2_8_15 -->
<g id="node1586" class="node">
<title>kv_send2_8_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8992" cy="-8144.29" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8992" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8992" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_8_15&#45;&gt;kv_send2_8_15 -->
<g id="edge2225" class="edge">
<title>ring_stage2_8_15&#45;&gt;kv_send2_8_15</title>
<path fill="none" stroke="black" d="M9149.9,-8207.42C9120.55,-8195.87 9085.98,-8182.27 9056.68,-8170.74"/>
<polygon fill="black" stroke="black" points="9057.96,-8167.48 9047.37,-8167.08 9055.39,-8174 9057.96,-8167.48"/>
</g>
<!-- ring_stage2_9_15 -->
<g id="node1602" class="node">
<title>ring_stage2_9_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9320,-8170.79 9118,-8170.79 9118,-8117.79 9320,-8117.79 9320,-8170.79"/>
<text text-anchor="middle" x="9219" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="9219" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_6×V_6</text>
<text text-anchor="middle" x="9219" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_8_15&#45;&gt;ring_stage2_9_15 -->
<g id="edge2271" class="edge">
<title>ring_stage2_8_15&#45;&gt;ring_stage2_9_15</title>
<path fill="none" stroke="black" d="M9216.18,-8207.18C9216.55,-8198.97 9216.97,-8189.74 9217.37,-8180.97"/>
<polygon fill="black" stroke="black" points="9220.87,-8181.11 9217.83,-8170.96 9213.88,-8180.79 9220.87,-8181.11"/>
</g>
<!-- kv_send2_8_0&#45;&gt;ring_stage2_9_1 -->
<g id="edge2230" class="edge">
<title>kv_send2_8_0&#45;&gt;ring_stage2_9_1</title>
<path fill="none" stroke="black" d="M8477.05,-8035.73C8464.39,-8032.89 8451.34,-8030.1 8439,-8027.68 8343.13,-8008.93 8315.54,-8011.47 8215.59,-7991.73"/>
<polygon fill="black" stroke="black" points="8216.18,-7988.28 8205.69,-7989.75 8214.81,-7995.14 8216.18,-7988.28"/>
</g>
<!-- kv_send2_8_1&#45;&gt;ring_stage2_9_2 -->
<g id="edge2233" class="edge">
<title>kv_send2_8_1&#45;&gt;ring_stage2_9_2</title>
<path fill="none" stroke="black" d="M8591.44,-7939.84C8608.58,-7929.68 8628.76,-7917.71 8646.99,-7906.91"/>
<polygon fill="black" stroke="black" points="8648.94,-7909.82 8655.76,-7901.71 8645.37,-7903.8 8648.94,-7909.82"/>
</g>
<!-- kv_send2_8_2&#45;&gt;ring_stage2_9_3 -->
<g id="edge2236" class="edge">
<title>kv_send2_8_2&#45;&gt;ring_stage2_9_3</title>
<path fill="none" stroke="black" d="M9351.08,-7847.95C9350.54,-7832.51 9349.85,-7812.74 9349.25,-7795.87"/>
<polygon fill="black" stroke="black" points="9352.75,-7795.68 9348.9,-7785.81 9345.75,-7795.93 9352.75,-7795.68"/>
</g>
<!-- kv_send2_8_3&#45;&gt;ring_stage2_9_4 -->
<g id="edge2239" class="edge">
<title>kv_send2_8_3&#45;&gt;ring_stage2_9_4</title>
<path fill="none" stroke="black" d="M9611.41,-7733.82C9646.42,-7710.37 9699.49,-7674.81 9737.53,-7649.33"/>
<polygon fill="black" stroke="black" points="9739.53,-7652.2 9745.89,-7643.73 9735.64,-7646.39 9739.53,-7652.2"/>
</g>
<!-- kv_send2_8_4&#45;&gt;ring_stage2_9_5 -->
<g id="edge2242" class="edge">
<title>kv_send2_8_4&#45;&gt;ring_stage2_9_5</title>
<path fill="none" stroke="black" d="M10053.7,-7592.69C10074.12,-7582.42 10099.24,-7571.16 10123,-7564.2 10237.5,-7530.71 10274.33,-7561.13 10389,-7528.2 10408.28,-7522.67 10428.48,-7514.44 10446.47,-7506.16"/>
<polygon fill="black" stroke="black" points="10448.1,-7509.26 10455.66,-7501.83 10445.12,-7502.92 10448.1,-7509.26"/>
</g>
<!-- kv_send2_8_5&#45;&gt;ring_stage2_9_6 -->
<g id="edge2245" class="edge">
<title>kv_send2_8_5&#45;&gt;ring_stage2_9_6</title>
<path fill="none" stroke="black" d="M11633.8,-9014.37C11633.43,-9006.33 11633.02,-8997.35 11632.63,-8988.79"/>
<polygon fill="black" stroke="black" points="11636.12,-8988.49 11632.17,-8978.66 11629.13,-8988.81 11636.12,-8988.49"/>
</g>
<!-- kv_send2_8_6&#45;&gt;ring_stage2_9_7 -->
<g id="edge2248" class="edge">
<title>kv_send2_8_6&#45;&gt;ring_stage2_9_7</title>
<path fill="none" stroke="black" d="M11381.4,-8924.63C11381.22,-8916.59 11381.01,-8907.61 11380.82,-8899.05"/>
<polygon fill="black" stroke="black" points="11384.31,-8898.83 11380.59,-8888.92 11377.31,-8898.99 11384.31,-8898.83"/>
</g>
<!-- kv_send2_8_7&#45;&gt;ring_stage2_9_8 -->
<g id="edge2251" class="edge">
<title>kv_send2_8_7&#45;&gt;ring_stage2_9_8</title>
<path fill="none" stroke="black" d="M11129,-8834.89C11129,-8826.85 11129,-8817.87 11129,-8809.31"/>
<polygon fill="black" stroke="black" points="11132.5,-8809.18 11129,-8799.18 11125.5,-8809.18 11132.5,-8809.18"/>
</g>
<!-- kv_send2_8_8&#45;&gt;ring_stage2_9_9 -->
<g id="edge2254" class="edge">
<title>kv_send2_8_8&#45;&gt;ring_stage2_9_9</title>
<path fill="none" stroke="black" d="M10902,-8745.15C10902,-8737.11 10902,-8728.13 10902,-8719.57"/>
<polygon fill="black" stroke="black" points="10905.5,-8719.44 10902,-8709.44 10898.5,-8719.44 10905.5,-8719.44"/>
</g>
<!-- kv_send2_8_9&#45;&gt;ring_stage2_9_10 -->
<g id="edge2257" class="edge">
<title>kv_send2_8_9&#45;&gt;ring_stage2_9_10</title>
<path fill="none" stroke="black" d="M10674.7,-8655.41C10673.69,-8647.37 10672.57,-8638.39 10671.49,-8629.83"/>
<polygon fill="black" stroke="black" points="10674.94,-8629.18 10670.22,-8619.7 10667.99,-8630.05 10674.94,-8629.18"/>
</g>
<!-- kv_send2_8_10&#45;&gt;ring_stage2_9_11 -->
<g id="edge2260" class="edge">
<title>kv_send2_8_10&#45;&gt;ring_stage2_9_11</title>
<path fill="none" stroke="black" d="M10418,-8565.67C10418,-8557.63 10418,-8548.65 10418,-8540.09"/>
<polygon fill="black" stroke="black" points="10421.5,-8539.96 10418,-8529.96 10414.5,-8539.96 10421.5,-8539.96"/>
</g>
<!-- kv_send2_8_11&#45;&gt;ring_stage2_9_12 -->
<g id="edge2263" class="edge">
<title>kv_send2_8_11&#45;&gt;ring_stage2_9_12</title>
<path fill="none" stroke="black" d="M10186,-8475.93C10185.08,-8467.89 10184.06,-8458.91 10183.08,-8450.35"/>
<polygon fill="black" stroke="black" points="10186.54,-8449.76 10181.93,-8440.22 10179.58,-8450.55 10186.54,-8449.76"/>
</g>
<!-- kv_send2_8_12&#45;&gt;ring_stage2_9_13 -->
<g id="edge2266" class="edge">
<title>kv_send2_8_12&#45;&gt;ring_stage2_9_13</title>
<path fill="none" stroke="black" d="M9943.7,-8386.66C9942.01,-8378.45 9940.12,-8369.22 9938.32,-8360.45"/>
<polygon fill="black" stroke="black" points="9941.7,-8359.53 9936.27,-8350.44 9934.85,-8360.94 9941.7,-8359.53"/>
</g>
<!-- kv_send2_8_13&#45;&gt;ring_stage2_9_14 -->
<g id="edge2269" class="edge">
<title>kv_send2_8_13&#45;&gt;ring_stage2_9_14</title>
<path fill="none" stroke="black" d="M9699.3,-8296.45C9698.48,-8288.41 9697.55,-8279.43 9696.68,-8270.87"/>
<polygon fill="black" stroke="black" points="9700.14,-8270.33 9695.64,-8260.74 9693.18,-8271.04 9700.14,-8270.33"/>
</g>
<!-- kv_send2_8_14&#45;&gt;ring_stage2_9_15 -->
<g id="edge2272" class="edge">
<title>kv_send2_8_14&#45;&gt;ring_stage2_9_15</title>
<path fill="none" stroke="black" d="M9387.51,-8211.01C9359.2,-8199.97 9324.53,-8186.45 9294.02,-8174.55"/>
<polygon fill="black" stroke="black" points="9295.28,-8171.28 9284.69,-8170.91 9292.74,-8177.81 9295.28,-8171.28"/>
</g>
<!-- kv_send2_8_15&#45;&gt;ring_stage2_9_0 -->
<g id="edge2227" class="edge">
<title>kv_send2_8_15&#45;&gt;ring_stage2_9_0</title>
<path fill="none" stroke="black" d="M8936.59,-8121.49C8908.42,-8110.41 8873.78,-8096.78 8843.33,-8084.8"/>
<polygon fill="black" stroke="black" points="8844.61,-8081.54 8834.02,-8081.14 8842.05,-8088.06 8844.61,-8081.54"/>
</g>
<!-- kv_send2_9_0 -->
<g id="node1603" class="node">
<title>kv_send2_9_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8327" cy="-7964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8327" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8327" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_9_0&#45;&gt;kv_send2_9_0 -->
<g id="edge2228" class="edge">
<title>ring_stage2_9_0&#45;&gt;kv_send2_9_0</title>
<path fill="none" stroke="black" d="M8672.31,-8029.62C8669.17,-8028.95 8666.06,-8028.3 8663,-8027.68 8564.16,-8007.71 8537.96,-8011.04 8439,-7991.68 8429.84,-7989.89 8420.29,-7987.89 8410.8,-7985.82"/>
<polygon fill="black" stroke="black" points="8411.47,-7982.38 8400.95,-7983.64 8409.96,-7989.22 8411.47,-7982.38"/>
</g>
<!-- ring_stage2_10_0 -->
<g id="node1619" class="node">
<title>ring_stage2_10_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8865.5,-7991.31 8672.5,-7991.31 8672.5,-7938.31 8865.5,-7938.31 8865.5,-7991.31"/>
<text text-anchor="middle" x="8769" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="8769" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_6×V_6</text>
<text text-anchor="middle" x="8769" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_9_0&#45;&gt;ring_stage2_10_0 -->
<g id="edge2274" class="edge">
<title>ring_stage2_9_0&#45;&gt;ring_stage2_10_0</title>
<path fill="none" stroke="black" d="M8769,-8027.7C8769,-8019.49 8769,-8010.26 8769,-8001.49"/>
<polygon fill="black" stroke="black" points="8772.5,-8001.48 8769,-7991.48 8765.5,-8001.48 8772.5,-8001.48"/>
</g>
<!-- kv_send2_9_1 -->
<g id="node1604" class="node">
<title>kv_send2_9_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8481" cy="-7875.07" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8481" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8481" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_9_1&#45;&gt;kv_send2_9_1 -->
<g id="edge2231" class="edge">
<title>ring_stage2_9_1&#45;&gt;kv_send2_9_1</title>
<path fill="none" stroke="black" d="M8205.75,-7940.15C8208.87,-7939.41 8211.96,-7938.67 8215,-7937.94 8248.82,-7929.88 8331.19,-7910.75 8395.38,-7895.88"/>
<polygon fill="black" stroke="black" points="8396.56,-7899.2 8405.52,-7893.53 8394.98,-7892.38 8396.56,-7899.2"/>
</g>
<!-- ring_stage2_10_1 -->
<g id="node1620" class="node">
<title>ring_stage2_10_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8135.5,-7901.57 7942.5,-7901.57 7942.5,-7848.57 8135.5,-7848.57 8135.5,-7901.57"/>
<text text-anchor="middle" x="8039" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="8039" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_7×V_7</text>
<text text-anchor="middle" x="8039" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_9_1&#45;&gt;ring_stage2_10_1 -->
<g id="edge2277" class="edge">
<title>ring_stage2_9_1&#45;&gt;ring_stage2_10_1</title>
<path fill="none" stroke="black" d="M8088.38,-7937.96C8081.33,-7929.13 8073.34,-7919.11 8065.87,-7909.75"/>
<polygon fill="black" stroke="black" points="8068.45,-7907.37 8059.48,-7901.74 8062.98,-7911.74 8068.45,-7907.37"/>
</g>
<!-- kv_send2_9_2 -->
<g id="node1605" class="node">
<title>kv_send2_9_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8686" cy="-7759.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8686" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8686" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_9_2&#45;&gt;kv_send2_9_2 -->
<g id="edge2234" class="edge">
<title>ring_stage2_9_2&#45;&gt;kv_send2_9_2</title>
<path fill="none" stroke="black" d="M8696.08,-7848.52C8694.32,-7833.1 8692.05,-7813.21 8690.11,-7796.21"/>
<polygon fill="black" stroke="black" points="8693.56,-7795.61 8688.95,-7786.07 8686.61,-7796.4 8693.56,-7795.61"/>
</g>
<!-- ring_stage2_10_2 -->
<g id="node1621" class="node">
<title>ring_stage2_10_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8564.5,-7785.7 8371.5,-7785.7 8371.5,-7732.7 8564.5,-7732.7 8564.5,-7785.7"/>
<text text-anchor="middle" x="8468" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="8468" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_8×V_8</text>
<text text-anchor="middle" x="8468" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_9_2&#45;&gt;ring_stage2_10_2 -->
<g id="edge2280" class="edge">
<title>ring_stage2_9_2&#45;&gt;ring_stage2_10_2</title>
<path fill="none" stroke="black" d="M8647.16,-7848.52C8612.21,-7831.29 8565.95,-7808.49 8529.19,-7790.37"/>
<polygon fill="black" stroke="black" points="8530.58,-7787.15 8520.07,-7785.87 8527.49,-7793.43 8530.58,-7787.15"/>
</g>
<!-- kv_send2_9_3 -->
<g id="node1606" class="node">
<title>kv_send2_9_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9346" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9346" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9346" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_9_3&#45;&gt;kv_send2_9_3 -->
<g id="edge2237" class="edge">
<title>ring_stage2_9_3&#45;&gt;kv_send2_9_3</title>
<path fill="none" stroke="black" d="M9347.63,-7732.53C9347.32,-7710.56 9346.86,-7678.71 9346.51,-7654.2"/>
<polygon fill="black" stroke="black" points="9350.01,-7654.14 9346.37,-7644.19 9343.01,-7654.24 9350.01,-7654.14"/>
</g>
<!-- ring_stage2_10_3 -->
<g id="node1622" class="node">
<title>ring_stage2_10_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9224.5,-7643.7 9031.5,-7643.7 9031.5,-7590.7 9224.5,-7590.7 9224.5,-7643.7"/>
<text text-anchor="middle" x="9128" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="9128" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_9×V_9</text>
<text text-anchor="middle" x="9128" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_9_3&#45;&gt;ring_stage2_10_3 -->
<g id="edge2283" class="edge">
<title>ring_stage2_9_3&#45;&gt;ring_stage2_10_3</title>
<path fill="none" stroke="black" d="M9307.9,-7732.69C9271.03,-7709.22 9216.27,-7674.38 9176.86,-7649.29"/>
<polygon fill="black" stroke="black" points="9178.51,-7646.2 9168.19,-7643.78 9174.75,-7652.1 9178.51,-7646.2"/>
</g>
<!-- kv_send2_9_4 -->
<g id="node1607" class="node">
<title>kv_send2_9_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9841" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9841" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9841" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_9_4&#45;&gt;kv_send2_9_4 -->
<g id="edge2240" class="edge">
<title>ring_stage2_9_4&#45;&gt;kv_send2_9_4</title>
<path fill="none" stroke="black" d="M9794.45,-7590.53C9803.48,-7568.36 9816.6,-7536.14 9826.61,-7511.54"/>
<polygon fill="black" stroke="black" points="9829.89,-7512.77 9830.42,-7502.19 9823.41,-7510.13 9829.89,-7512.77"/>
</g>
<!-- ring_stage2_10_4 -->
<g id="node1623" class="node">
<title>ring_stage2_10_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9719.5,-7501.7 9508.5,-7501.7 9508.5,-7448.7 9719.5,-7448.7 9719.5,-7501.7"/>
<text text-anchor="middle" x="9614" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="9614" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_10×V_10</text>
<text text-anchor="middle" x="9614" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_9_4&#45;&gt;ring_stage2_10_4 -->
<g id="edge2286" class="edge">
<title>ring_stage2_9_4&#45;&gt;ring_stage2_10_4</title>
<path fill="none" stroke="black" d="M9752.82,-7590.53C9724.66,-7567.34 9683.12,-7533.13 9652.82,-7508.17"/>
<polygon fill="black" stroke="black" points="9654.93,-7505.37 9644.98,-7501.72 9650.48,-7510.78 9654.93,-7505.37"/>
</g>
<!-- kv_send2_9_5 -->
<g id="node1608" class="node">
<title>kv_send2_9_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11019" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11019" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="11019" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_9_5&#45;&gt;kv_send2_9_5 -->
<g id="edge2243" class="edge">
<title>ring_stage2_9_5&#45;&gt;kv_send2_9_5</title>
<path fill="none" stroke="black" d="M10554.61,-7448.57C10574.34,-7439.31 10597.37,-7429.38 10619,-7422.2 10720.22,-7388.59 10840.14,-7364.16 10922.11,-7349.68"/>
<polygon fill="black" stroke="black" points="10922.91,-7353.1 10932.16,-7347.93 10921.71,-7346.2 10922.91,-7353.1"/>
</g>
<!-- ring_stage2_10_5 -->
<g id="node1624" class="node">
<title>ring_stage2_10_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10465.5,-7359.7 10254.5,-7359.7 10254.5,-7306.7 10465.5,-7306.7 10465.5,-7359.7"/>
<text text-anchor="middle" x="10360" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="10360" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_11×V_11</text>
<text text-anchor="middle" x="10360" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_9_5&#45;&gt;ring_stage2_10_5 -->
<g id="edge2289" class="edge">
<title>ring_stage2_9_5&#45;&gt;ring_stage2_10_5</title>
<path fill="none" stroke="black" d="M10477.59,-7448.53C10453.94,-7425.53 10419.15,-7391.71 10393.54,-7366.81"/>
<polygon fill="black" stroke="black" points="10395.85,-7364.18 10386.24,-7359.72 10390.97,-7369.2 10395.85,-7364.18"/>
</g>
<!-- kv_send2_9_6 -->
<g id="node1609" class="node">
<title>kv_send2_9_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11618" cy="-8862.21" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11618" y="-8866.01" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="11618" y="-8851.01" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_9_6&#45;&gt;kv_send2_9_6 -->
<g id="edge2246" class="edge">
<title>ring_stage2_9_6&#45;&gt;kv_send2_9_6</title>
<path fill="none" stroke="black" d="M11627.17,-8925.1C11625.96,-8916.97 11624.61,-8907.83 11623.32,-8899.12"/>
<polygon fill="black" stroke="black" points="11626.78,-8898.56 11621.85,-8889.18 11619.85,-8899.59 11626.78,-8898.56"/>
</g>
<!-- ring_stage2_10_6 -->
<g id="node1625" class="node">
<title>ring_stage2_10_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11383.5,-7217.7 11172.5,-7217.7 11172.5,-7164.7 11383.5,-7164.7 11383.5,-7217.7"/>
<text text-anchor="middle" x="11278" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="11278" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_12×V_12</text>
<text text-anchor="middle" x="11278" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_9_6&#45;&gt;ring_stage2_10_6 -->
<g id="edge2292" class="edge">
<title>ring_stage2_9_6&#45;&gt;ring_stage2_10_6</title>
<path fill="none" stroke="black" d="M11691.09,-8925.43C11706.16,-8916.17 11720.68,-8904.17 11730,-8889.08 11757.13,-8845.18 11741,-8825.09 11741,-8773.47 11741,-8773.47 11741,-8773.47 11741,-8502.25 11741,-8382.17 11781,-8355.12 11781,-8235.03 11781,-8235.03 11781,-8235.03 11781,-8143.29 11781,-8008.3 11817,-7929.21 11709,-7848.2 11649.28,-7803.41 11424.88,-7867.75 11375,-7812.2 11343.52,-7777.15 11345.36,-7742.82 11375,-7706.2 11423.32,-7646.51 11492.31,-7727 11544,-7670.2 11602.54,-7605.87 11629.1,-7349.85 11577,-7280.2 11554.43,-7250.04 11467.95,-7226.65 11393.76,-7211.59"/>
<polygon fill="black" stroke="black" points="11394.34,-7208.14 11383.85,-7209.62 11392.97,-7215.01 11394.34,-7208.14"/>
</g>
<!-- kv_send2_9_7 -->
<g id="node1610" class="node">
<title>kv_send2_9_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11370" cy="-8772.47" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11370" y="-8776.27" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11370" y="-8761.27" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_9_7&#45;&gt;kv_send2_9_7 -->
<g id="edge2249" class="edge">
<title>ring_stage2_9_7&#45;&gt;kv_send2_9_7</title>
<path fill="none" stroke="black" d="M11377.05,-8835.36C11376.13,-8827.23 11375.08,-8818.09 11374.09,-8809.38"/>
<polygon fill="black" stroke="black" points="11377.57,-8808.98 11372.96,-8799.44 11370.61,-8809.78 11377.57,-8808.98"/>
</g>
<!-- ring_stage2_10_7 -->
<g id="node1626" class="node">
<title>ring_stage2_10_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11715.5,-8798.97 11504.5,-8798.97 11504.5,-8745.97 11715.5,-8745.97 11715.5,-8798.97"/>
<text text-anchor="middle" x="11610" y="-8783.77" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="11610" y="-8768.77" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_13×V_13</text>
<text text-anchor="middle" x="11610" y="-8753.77" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_9_7&#45;&gt;ring_stage2_10_7 -->
<g id="edge2295" class="edge">
<title>ring_stage2_9_7&#45;&gt;ring_stage2_10_7</title>
<path fill="none" stroke="black" d="M11447.14,-8835.6C11474.07,-8825.33 11505.25,-8813.43 11533.08,-8802.82"/>
<polygon fill="black" stroke="black" points="11534.68,-8805.95 11542.77,-8799.12 11532.18,-8799.41 11534.68,-8805.95"/>
</g>
<!-- kv_send2_9_8 -->
<g id="node1611" class="node">
<title>kv_send2_9_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11129" cy="-8682.73" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11129" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11129" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_9_8&#45;&gt;kv_send2_9_8 -->
<g id="edge2252" class="edge">
<title>ring_stage2_9_8&#45;&gt;kv_send2_9_8</title>
<path fill="none" stroke="black" d="M11129,-8745.62C11129,-8737.57 11129,-8728.54 11129,-8719.92"/>
<polygon fill="black" stroke="black" points="11132.5,-8719.7 11129,-8709.7 11125.5,-8719.7 11132.5,-8719.7"/>
</g>
<!-- ring_stage2_10_8 -->
<g id="node1627" class="node">
<title>ring_stage2_10_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11474.5,-8709.23 11263.5,-8709.23 11263.5,-8656.23 11474.5,-8656.23 11474.5,-8709.23"/>
<text text-anchor="middle" x="11369" y="-8694.03" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="11369" y="-8679.03" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_14×V_14</text>
<text text-anchor="middle" x="11369" y="-8664.03" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_9_8&#45;&gt;ring_stage2_10_8 -->
<g id="edge2298" class="edge">
<title>ring_stage2_9_8&#45;&gt;ring_stage2_10_8</title>
<path fill="none" stroke="black" d="M11199.06,-8745.86C11227.28,-8735.54 11259.98,-8723.59 11289.12,-8712.94"/>
<polygon fill="black" stroke="black" points="11290.66,-8716.1 11298.85,-8709.38 11288.26,-8709.53 11290.66,-8716.1"/>
</g>
<!-- kv_send2_9_9 -->
<g id="node1612" class="node">
<title>kv_send2_9_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10896" cy="-8592.99" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10896" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10896" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_9_9&#45;&gt;kv_send2_9_9 -->
<g id="edge2255" class="edge">
<title>ring_stage2_9_9&#45;&gt;kv_send2_9_9</title>
<path fill="none" stroke="black" d="M10900.23,-8655.88C10899.68,-8647.83 10899.06,-8638.8 10898.47,-8630.18"/>
<polygon fill="black" stroke="black" points="10901.95,-8629.7 10897.78,-8619.96 10894.97,-8630.18 10901.95,-8629.7"/>
</g>
<!-- ring_stage2_10_9 -->
<g id="node1628" class="node">
<title>ring_stage2_10_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11234.5,-8619.49 11023.5,-8619.49 11023.5,-8566.49 11234.5,-8566.49 11234.5,-8619.49"/>
<text text-anchor="middle" x="11129" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="11129" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_15×V_15</text>
<text text-anchor="middle" x="11129" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_9_9&#45;&gt;ring_stage2_10_9 -->
<g id="edge2301" class="edge">
<title>ring_stage2_9_9&#45;&gt;ring_stage2_10_9</title>
<path fill="none" stroke="black" d="M10968.27,-8656.12C10994.84,-8645.85 11025.62,-8633.95 11053.08,-8623.34"/>
<polygon fill="black" stroke="black" points="11054.58,-8626.51 11062.65,-8619.64 11052.06,-8619.98 11054.58,-8626.51"/>
</g>
<!-- kv_send2_9_10 -->
<g id="node1613" class="node">
<title>kv_send2_9_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10667" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10667" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="10667" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_9_10&#45;&gt;kv_send2_9_10 -->
<g id="edge2258" class="edge">
<title>ring_stage2_9_10&#45;&gt;kv_send2_9_10</title>
<path fill="none" stroke="black" d="M10667,-8566.14C10667,-8558.09 10667,-8549.06 10667,-8540.44"/>
<polygon fill="black" stroke="black" points="10670.5,-8540.22 10667,-8530.22 10663.5,-8540.22 10670.5,-8540.22"/>
</g>
<!-- ring_stage2_10_10 -->
<g id="node1629" class="node">
<title>ring_stage2_10_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10997,-8529.75 10795,-8529.75 10795,-8476.75 10997,-8476.75 10997,-8529.75"/>
<text text-anchor="middle" x="10896" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="10896" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_0×V_0</text>
<text text-anchor="middle" x="10896" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_9_10&#45;&gt;ring_stage2_10_10 -->
<g id="edge2304" class="edge">
<title>ring_stage2_9_10&#45;&gt;ring_stage2_10_10</title>
<path fill="none" stroke="black" d="M10733.85,-8566.38C10760.66,-8556.11 10791.71,-8544.21 10819.42,-8533.6"/>
<polygon fill="black" stroke="black" points="10820.98,-8536.75 10829.07,-8529.9 10818.47,-8530.21 10820.98,-8536.75"/>
</g>
<!-- kv_send2_9_11 -->
<g id="node1614" class="node">
<title>kv_send2_9_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10409" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10409" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="10409" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_9_11&#45;&gt;kv_send2_9_11 -->
<g id="edge2261" class="edge">
<title>ring_stage2_9_11&#45;&gt;kv_send2_9_11</title>
<path fill="none" stroke="black" d="M10415.35,-8476.4C10414.52,-8468.35 10413.6,-8459.32 10412.71,-8450.7"/>
<polygon fill="black" stroke="black" points="10416.17,-8450.07 10411.66,-8440.48 10409.2,-8450.79 10416.17,-8450.07"/>
</g>
<!-- ring_stage2_10_11 -->
<g id="node1630" class="node">
<title>ring_stage2_10_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10759,-8440.01 10557,-8440.01 10557,-8387.01 10759,-8387.01 10759,-8440.01"/>
<text text-anchor="middle" x="10658" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="10658" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_1×V_1</text>
<text text-anchor="middle" x="10658" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_9_11&#45;&gt;ring_stage2_10_11 -->
<g id="edge2307" class="edge">
<title>ring_stage2_9_11&#45;&gt;ring_stage2_10_11</title>
<path fill="none" stroke="black" d="M10488.06,-8476.64C10516.28,-8466.32 10548.98,-8454.37 10578.12,-8443.72"/>
<polygon fill="black" stroke="black" points="10579.66,-8446.88 10587.85,-8440.16 10577.26,-8440.31 10579.66,-8446.88"/>
</g>
<!-- kv_send2_9_12 -->
<g id="node1615" class="node">
<title>kv_send2_9_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10160" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10160" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="10160" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_9_12&#45;&gt;kv_send2_9_12 -->
<g id="edge2264" class="edge">
<title>ring_stage2_9_12&#45;&gt;kv_send2_9_12</title>
<path fill="none" stroke="black" d="M10173.4,-8386.66C10171.64,-8378.53 10169.66,-8369.39 10167.78,-8360.68"/>
<polygon fill="black" stroke="black" points="10171.16,-8359.78 10165.62,-8350.74 10164.32,-8361.26 10171.16,-8359.78"/>
</g>
<!-- ring_stage2_10_12 -->
<g id="node1631" class="node">
<title>ring_stage2_10_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10510,-8350.27 10308,-8350.27 10308,-8297.27 10510,-8297.27 10510,-8350.27"/>
<text text-anchor="middle" x="10409" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="10409" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_2×V_2</text>
<text text-anchor="middle" x="10409" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_9_12&#45;&gt;ring_stage2_10_12 -->
<g id="edge2310" class="edge">
<title>ring_stage2_9_12&#45;&gt;ring_stage2_10_12</title>
<path fill="none" stroke="black" d="M10246.14,-8386.9C10273.07,-8376.63 10304.25,-8364.73 10332.08,-8354.12"/>
<polygon fill="black" stroke="black" points="10333.68,-8357.25 10341.77,-8350.42 10331.18,-8350.71 10333.68,-8357.25"/>
</g>
<!-- kv_send2_9_13 -->
<g id="node1616" class="node">
<title>kv_send2_9_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9922" cy="-8234.03" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9922" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="9922" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_9_13&#45;&gt;kv_send2_9_13 -->
<g id="edge2267" class="edge">
<title>ring_stage2_9_13&#45;&gt;kv_send2_9_13</title>
<path fill="none" stroke="black" d="M9928.35,-8296.92C9927.52,-8288.87 9926.6,-8279.84 9925.71,-8271.22"/>
<polygon fill="black" stroke="black" points="9929.17,-8270.59 9924.66,-8261 9922.2,-8271.31 9929.17,-8270.59"/>
</g>
<!-- ring_stage2_10_13 -->
<g id="node1632" class="node">
<title>ring_stage2_10_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10252,-8260.53 10050,-8260.53 10050,-8207.53 10252,-8207.53 10252,-8260.53"/>
<text text-anchor="middle" x="10151" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="10151" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_3×V_3</text>
<text text-anchor="middle" x="10151" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_9_13&#45;&gt;ring_stage2_10_13 -->
<g id="edge2313" class="edge">
<title>ring_stage2_9_13&#45;&gt;ring_stage2_10_13</title>
<path fill="none" stroke="black" d="M9995.22,-8297.16C10020.87,-8286.93 10050.55,-8275.1 10077.08,-8264.52"/>
<polygon fill="black" stroke="black" points="10078.7,-8267.64 10086.7,-8260.68 10076.11,-8261.13 10078.7,-8267.64"/>
</g>
<!-- kv_send2_9_14 -->
<g id="node1617" class="node">
<title>kv_send2_9_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9680" cy="-8144.29" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9680" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9680" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_9_14&#45;&gt;kv_send2_9_14 -->
<g id="edge2270" class="edge">
<title>ring_stage2_9_14&#45;&gt;kv_send2_9_14</title>
<path fill="none" stroke="black" d="M9689.17,-8207.18C9687.96,-8199.05 9686.61,-8189.91 9685.32,-8181.2"/>
<polygon fill="black" stroke="black" points="9688.78,-8180.64 9683.85,-8171.26 9681.85,-8181.67 9688.78,-8180.64"/>
</g>
<!-- ring_stage2_10_14 -->
<g id="node1633" class="node">
<title>ring_stage2_10_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10011,-8170.79 9809,-8170.79 9809,-8117.79 10011,-8117.79 10011,-8170.79"/>
<text text-anchor="middle" x="9910" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="9910" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_4×V_4</text>
<text text-anchor="middle" x="9910" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_9_14&#45;&gt;ring_stage2_10_14 -->
<g id="edge2316" class="edge">
<title>ring_stage2_9_14&#45;&gt;ring_stage2_10_14</title>
<path fill="none" stroke="black" d="M9756.35,-8207.42C9781.64,-8197.19 9810.92,-8185.36 9837.08,-8174.78"/>
<polygon fill="black" stroke="black" points="9838.61,-8177.93 9846.57,-8170.94 9835.99,-8171.44 9838.61,-8177.93"/>
</g>
<!-- kv_send2_9_15 -->
<g id="node1618" class="node">
<title>kv_send2_9_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8992" cy="-8054.55" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8992" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8992" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_9_15&#45;&gt;kv_send2_9_15 -->
<g id="edge2273" class="edge">
<title>ring_stage2_9_15&#45;&gt;kv_send2_9_15</title>
<path fill="none" stroke="black" d="M9152.73,-8117.68C9122.74,-8106.09 9087.39,-8092.42 9057.49,-8080.87"/>
<polygon fill="black" stroke="black" points="9058.58,-8077.53 9047.99,-8077.19 9056.05,-8084.06 9058.58,-8077.53"/>
</g>
<!-- ring_stage2_10_15 -->
<g id="node1634" class="node">
<title>ring_stage2_10_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9548,-8081.05 9346,-8081.05 9346,-8028.05 9548,-8028.05 9548,-8081.05"/>
<text text-anchor="middle" x="9447" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="9447" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_5×V_5</text>
<text text-anchor="middle" x="9447" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_9_15&#45;&gt;ring_stage2_10_15 -->
<g id="edge2319" class="edge">
<title>ring_stage2_9_15&#45;&gt;ring_stage2_10_15</title>
<path fill="none" stroke="black" d="M9285.56,-8117.68C9312.25,-8107.41 9343.16,-8095.51 9370.75,-8084.9"/>
<polygon fill="black" stroke="black" points="9372.28,-8088.06 9380.36,-8081.2 9369.77,-8081.52 9372.28,-8088.06"/>
</g>
<!-- kv_send2_9_0&#45;&gt;ring_stage2_10_1 -->
<g id="edge2278" class="edge">
<title>kv_send2_9_0&#45;&gt;ring_stage2_10_1</title>
<path fill="none" stroke="black" d="M8261.65,-7943.9C8223.46,-7932.27 8174.64,-7917.4 8132.44,-7904.54"/>
<polygon fill="black" stroke="black" points="8133.3,-7901.14 8122.71,-7901.58 8131.26,-7907.84 8133.3,-7901.14"/>
</g>
<!-- kv_send2_9_1&#45;&gt;ring_stage2_10_2 -->
<g id="edge2281" class="edge">
<title>kv_send2_9_1&#45;&gt;ring_stage2_10_2</title>
<path fill="none" stroke="black" d="M8478.02,-7847.95C8476.25,-7832.51 8474,-7812.74 8472.07,-7795.87"/>
<polygon fill="black" stroke="black" points="8475.54,-7795.35 8470.92,-7785.81 8468.58,-7796.15 8475.54,-7795.35"/>
</g>
<!-- kv_send2_9_2&#45;&gt;ring_stage2_10_3 -->
<g id="edge2284" class="edge">
<title>kv_send2_9_2&#45;&gt;ring_stage2_10_3</title>
<path fill="none" stroke="black" d="M8729.31,-7734.69C8749.65,-7724.55 8774.53,-7713.39 8798,-7706.2 8894.42,-7676.69 8925.9,-7700.74 9022,-7670.2 9039.47,-7664.65 9057.68,-7656.63 9073.97,-7648.54"/>
<polygon fill="black" stroke="black" points="9075.99,-7651.44 9083.32,-7643.79 9072.82,-7645.2 9075.99,-7651.44"/>
</g>
<!-- kv_send2_9_3&#45;&gt;ring_stage2_10_4 -->
<g id="edge2287" class="edge">
<title>kv_send2_9_3&#45;&gt;ring_stage2_10_4</title>
<path fill="none" stroke="black" d="M9390.56,-7592.93C9435.81,-7569.29 9506.13,-7532.56 9555.77,-7506.62"/>
<polygon fill="black" stroke="black" points="9557.55,-7509.64 9564.79,-7501.91 9554.31,-7503.44 9557.55,-7509.64"/>
</g>
<!-- kv_send2_9_4&#45;&gt;ring_stage2_10_5 -->
<g id="edge2290" class="edge">
<title>kv_send2_9_4&#45;&gt;ring_stage2_10_5</title>
<path fill="none" stroke="black" d="M9883.8,-7450.71C9904.45,-7440.38 9929.91,-7429.06 9954,-7422.2 10079.34,-7386.54 10119.54,-7421.45 10245,-7386.2 10264.4,-7380.75 10284.7,-7372.51 10302.76,-7364.18"/>
<polygon fill="black" stroke="black" points="10304.43,-7367.26 10311.98,-7359.83 10301.44,-7360.93 10304.43,-7367.26"/>
</g>
<!-- kv_send2_9_5&#45;&gt;ring_stage2_10_6 -->
<g id="edge2293" class="edge">
<title>kv_send2_9_5&#45;&gt;ring_stage2_10_6</title>
<path fill="none" stroke="black" d="M11062.35,-7308.77C11106.05,-7285.15 11173.7,-7248.58 11221.56,-7222.71"/>
<polygon fill="black" stroke="black" points="11223.42,-7225.68 11230.55,-7217.85 11220.09,-7219.53 11223.42,-7225.68"/>
</g>
<!-- kv_send2_9_6&#45;&gt;ring_stage2_10_7 -->
<g id="edge2296" class="edge">
<title>kv_send2_9_6&#45;&gt;ring_stage2_10_7</title>
<path fill="none" stroke="black" d="M11615.6,-8834.89C11614.87,-8826.85 11614.05,-8817.87 11613.27,-8809.31"/>
<polygon fill="black" stroke="black" points="11616.74,-8808.82 11612.34,-8799.18 11609.77,-8809.45 11616.74,-8808.82"/>
</g>
<!-- kv_send2_9_7&#45;&gt;ring_stage2_10_8 -->
<g id="edge2299" class="edge">
<title>kv_send2_9_7&#45;&gt;ring_stage2_10_8</title>
<path fill="none" stroke="black" d="M11369.7,-8745.15C11369.61,-8737.11 11369.51,-8728.13 11369.41,-8719.57"/>
<polygon fill="black" stroke="black" points="11372.91,-8719.4 11369.29,-8709.44 11365.91,-8719.48 11372.91,-8719.4"/>
</g>
<!-- kv_send2_9_8&#45;&gt;ring_stage2_10_9 -->
<g id="edge2302" class="edge">
<title>kv_send2_9_8&#45;&gt;ring_stage2_10_9</title>
<path fill="none" stroke="black" d="M11129,-8655.41C11129,-8647.37 11129,-8638.39 11129,-8629.83"/>
<polygon fill="black" stroke="black" points="11132.5,-8629.7 11129,-8619.7 11125.5,-8629.7 11132.5,-8629.7"/>
</g>
<!-- kv_send2_9_9&#45;&gt;ring_stage2_10_10 -->
<g id="edge2305" class="edge">
<title>kv_send2_9_9&#45;&gt;ring_stage2_10_10</title>
<path fill="none" stroke="black" d="M10896,-8565.67C10896,-8557.63 10896,-8548.65 10896,-8540.09"/>
<polygon fill="black" stroke="black" points="10899.5,-8539.96 10896,-8529.96 10892.5,-8539.96 10899.5,-8539.96"/>
</g>
<!-- kv_send2_9_10&#45;&gt;ring_stage2_10_11 -->
<g id="edge2308" class="edge">
<title>kv_send2_9_10&#45;&gt;ring_stage2_10_11</title>
<path fill="none" stroke="black" d="M10664.3,-8475.93C10663.48,-8467.89 10662.55,-8458.91 10661.68,-8450.35"/>
<polygon fill="black" stroke="black" points="10665.14,-8449.81 10660.64,-8440.22 10658.18,-8450.52 10665.14,-8449.81"/>
</g>
<!-- kv_send2_9_11&#45;&gt;ring_stage2_10_12 -->
<g id="edge2311" class="edge">
<title>kv_send2_9_11&#45;&gt;ring_stage2_10_12</title>
<path fill="none" stroke="black" d="M10409,-8386.19C10409,-8378.15 10409,-8369.17 10409,-8360.61"/>
<polygon fill="black" stroke="black" points="10412.5,-8360.48 10409,-8350.48 10405.5,-8360.48 10412.5,-8360.48"/>
</g>
<!-- kv_send2_9_12&#45;&gt;ring_stage2_10_13 -->
<g id="edge2314" class="edge">
<title>kv_send2_9_12&#45;&gt;ring_stage2_10_13</title>
<path fill="none" stroke="black" d="M10157.3,-8296.45C10156.48,-8288.41 10155.55,-8279.43 10154.68,-8270.87"/>
<polygon fill="black" stroke="black" points="10158.14,-8270.33 10153.64,-8260.74 10151.18,-8271.04 10158.14,-8270.33"/>
</g>
<!-- kv_send2_9_13&#45;&gt;ring_stage2_10_14 -->
<g id="edge2317" class="edge">
<title>kv_send2_9_13&#45;&gt;ring_stage2_10_14</title>
<path fill="none" stroke="black" d="M9918.4,-8206.71C9917.3,-8198.67 9916.07,-8189.69 9914.9,-8181.13"/>
<polygon fill="black" stroke="black" points="9918.34,-8180.43 9913.52,-8171 9911.4,-8181.38 9918.34,-8180.43"/>
</g>
<!-- kv_send2_9_14&#45;&gt;ring_stage2_10_15 -->
<g id="edge2320" class="edge">
<title>kv_send2_9_14&#45;&gt;ring_stage2_10_15</title>
<path fill="none" stroke="black" d="M9621.81,-8121.38C9592.37,-8110.29 9556.23,-8096.69 9524.48,-8084.73"/>
<polygon fill="black" stroke="black" points="9525.37,-8081.32 9514.77,-8081.08 9522.9,-8087.87 9525.37,-8081.32"/>
</g>
<!-- kv_send2_9_15&#45;&gt;ring_stage2_10_0 -->
<g id="edge2275" class="edge">
<title>kv_send2_9_15&#45;&gt;ring_stage2_10_0</title>
<path fill="none" stroke="black" d="M8936.59,-8031.75C8908.42,-8020.67 8873.78,-8007.04 8843.33,-7995.06"/>
<polygon fill="black" stroke="black" points="8844.61,-7991.8 8834.02,-7991.4 8842.05,-7998.32 8844.61,-7991.8"/>
</g>
<!-- kv_send2_10_0 -->
<g id="node1635" class="node">
<title>kv_send2_10_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8257" cy="-7875.07" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8257" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8257" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_10_0&#45;&gt;kv_send2_10_0 -->
<g id="edge2276" class="edge">
<title>ring_stage2_10_0&#45;&gt;kv_send2_10_0</title>
<path fill="none" stroke="black" d="M8672.34,-7939.73C8669.19,-7939.1 8666.07,-7938.51 8663,-7937.94 8533.5,-7914.3 8498.65,-7924.79 8369,-7901.94 8359.49,-7900.27 8349.58,-7898.3 8339.75,-7896.22"/>
<polygon fill="black" stroke="black" points="8340.49,-7892.79 8329.97,-7894.09 8339,-7899.63 8340.49,-7892.79"/>
</g>
<!-- ring_stage2_11_0 -->
<g id="node1651" class="node">
<title>ring_stage2_11_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9006.5,-7901.57 8813.5,-7901.57 8813.5,-7848.57 9006.5,-7848.57 9006.5,-7901.57"/>
<text text-anchor="middle" x="8910" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="8910" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_5×V_5</text>
<text text-anchor="middle" x="8910" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_10_0&#45;&gt;ring_stage2_11_0 -->
<g id="edge2322" class="edge">
<title>ring_stage2_10_0&#45;&gt;ring_stage2_11_0</title>
<path fill="none" stroke="black" d="M8810.16,-7938.2C8825.66,-7928.55 8843.47,-7917.48 8859.71,-7907.37"/>
<polygon fill="black" stroke="black" points="8861.9,-7910.13 8868.54,-7901.87 8858.2,-7904.18 8861.9,-7910.13"/>
</g>
<!-- kv_send2_10_1 -->
<g id="node1636" class="node">
<title>kv_send2_10_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8039" cy="-7759.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8039" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8039" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_10_1&#45;&gt;kv_send2_10_1 -->
<g id="edge2279" class="edge">
<title>ring_stage2_10_1&#45;&gt;kv_send2_10_1</title>
<path fill="none" stroke="black" d="M8039,-7848.52C8039,-7833.21 8039,-7813.49 8039,-7796.57"/>
<polygon fill="black" stroke="black" points="8042.5,-7796.46 8039,-7786.46 8035.5,-7796.46 8042.5,-7796.46"/>
</g>
<!-- ring_stage2_11_1 -->
<g id="node1652" class="node">
<title>ring_stage2_11_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8353.5,-7785.7 8160.5,-7785.7 8160.5,-7732.7 8353.5,-7732.7 8353.5,-7785.7"/>
<text text-anchor="middle" x="8257" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="8257" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_6×V_6</text>
<text text-anchor="middle" x="8257" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_10_1&#45;&gt;ring_stage2_11_1 -->
<g id="edge2325" class="edge">
<title>ring_stage2_10_1&#45;&gt;ring_stage2_11_1</title>
<path fill="none" stroke="black" d="M8087.92,-7848.52C8120.77,-7831.36 8164.19,-7808.68 8198.81,-7790.6"/>
<polygon fill="black" stroke="black" points="8200.62,-7793.6 8207.86,-7785.87 8197.38,-7787.4 8200.62,-7793.6"/>
</g>
<!-- kv_send2_10_2 -->
<g id="node1637" class="node">
<title>kv_send2_10_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8910" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8910" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8910" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_10_2&#45;&gt;kv_send2_10_2 -->
<g id="edge2282" class="edge">
<title>ring_stage2_10_2&#45;&gt;kv_send2_10_2</title>
<path fill="none" stroke="black" d="M8512.68,-7732.61C8531.15,-7723.02 8553.1,-7712.85 8574,-7706.2 8670.1,-7675.66 8701.58,-7699.71 8798,-7670.2 8818.08,-7664.06 8839.19,-7655 8857.6,-7646.16"/>
<polygon fill="black" stroke="black" points="8859.24,-7649.26 8866.69,-7641.72 8856.17,-7642.97 8859.24,-7649.26"/>
</g>
<!-- ring_stage2_11_2 -->
<g id="node1653" class="node">
<title>ring_stage2_11_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8353.5,-7643.7 8160.5,-7643.7 8160.5,-7590.7 8353.5,-7590.7 8353.5,-7643.7"/>
<text text-anchor="middle" x="8257" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="8257" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_7×V_7</text>
<text text-anchor="middle" x="8257" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_10_2&#45;&gt;ring_stage2_11_2 -->
<g id="edge2328" class="edge">
<title>ring_stage2_10_2&#45;&gt;ring_stage2_11_2</title>
<path fill="none" stroke="black" d="M8429.3,-7732.53C8394.05,-7709.14 8341.91,-7674.54 8304.22,-7649.54"/>
<polygon fill="black" stroke="black" points="8305.72,-7646.33 8295.46,-7643.72 8301.85,-7652.16 8305.72,-7646.33"/>
</g>
<!-- kv_send2_10_3 -->
<g id="node1638" class="node">
<title>kv_send2_10_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9387" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9387" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9387" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_10_3&#45;&gt;kv_send2_10_3 -->
<g id="edge2285" class="edge">
<title>ring_stage2_10_3&#45;&gt;kv_send2_10_3</title>
<path fill="none" stroke="black" d="M9175.2,-7590.69C9220.21,-7566.36 9287.85,-7529.8 9334.53,-7504.57"/>
<polygon fill="black" stroke="black" points="9336.43,-7507.51 9343.57,-7499.68 9333.11,-7501.36 9336.43,-7507.51"/>
</g>
<!-- ring_stage2_11_3 -->
<g id="node1654" class="node">
<title>ring_stage2_11_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9041.5,-7501.7 8848.5,-7501.7 8848.5,-7448.7 9041.5,-7448.7 9041.5,-7501.7"/>
<text text-anchor="middle" x="8945" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="8945" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_8×V_8</text>
<text text-anchor="middle" x="8945" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_10_3&#45;&gt;ring_stage2_11_3 -->
<g id="edge2331" class="edge">
<title>ring_stage2_10_3&#45;&gt;ring_stage2_11_3</title>
<path fill="none" stroke="black" d="M9094.43,-7590.53C9064,-7567.24 9019.02,-7532.83 8986.37,-7507.85"/>
<polygon fill="black" stroke="black" points="8988.42,-7505.02 8978.35,-7501.72 8984.17,-7510.57 8988.42,-7505.02"/>
</g>
<!-- kv_send2_10_4 -->
<g id="node1639" class="node">
<title>kv_send2_10_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10133" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10133" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="10133" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_10_4&#45;&gt;kv_send2_10_4 -->
<g id="edge2288" class="edge">
<title>ring_stage2_10_4&#45;&gt;kv_send2_10_4</title>
<path fill="none" stroke="black" d="M9662.02,-7448.57C9682.19,-7438.85 9706.22,-7428.6 9729,-7422.2 9854.89,-7386.86 9895.28,-7422.17 10021,-7386.2 10041.45,-7380.35 10062.88,-7371.22 10081.45,-7362.24"/>
<polygon fill="black" stroke="black" points="10083.19,-7365.28 10090.6,-7357.71 10080.08,-7359.01 10083.19,-7365.28"/>
</g>
<!-- ring_stage2_11_4 -->
<g id="node1655" class="node">
<title>ring_stage2_11_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9703.5,-7359.7 9510.5,-7359.7 9510.5,-7306.7 9703.5,-7306.7 9703.5,-7359.7"/>
<text text-anchor="middle" x="9607" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="9607" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_9×V_9</text>
<text text-anchor="middle" x="9607" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_10_4&#45;&gt;ring_stage2_11_4 -->
<g id="edge2334" class="edge">
<title>ring_stage2_10_4&#45;&gt;ring_stage2_11_4</title>
<path fill="none" stroke="black" d="M9612.72,-7448.53C9611.61,-7426.42 9610.01,-7394.3 9608.78,-7369.73"/>
<polygon fill="black" stroke="black" points="9612.27,-7369.53 9608.28,-7359.72 9605.28,-7369.88 9612.27,-7369.53"/>
</g>
<!-- kv_send2_10_5 -->
<g id="node1640" class="node">
<title>kv_send2_10_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10380" cy="-7191.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10380" y="-7195" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10380" y="-7180" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_10_5&#45;&gt;kv_send2_10_5 -->
<g id="edge2291" class="edge">
<title>ring_stage2_10_5&#45;&gt;kv_send2_10_5</title>
<path fill="none" stroke="black" d="M10363.67,-7306.53C10366.81,-7284.56 10371.36,-7252.71 10374.86,-7228.2"/>
<polygon fill="black" stroke="black" points="10378.34,-7228.59 10376.29,-7218.19 10371.41,-7227.6 10378.34,-7228.59"/>
</g>
<!-- ring_stage2_11_5 -->
<g id="node1656" class="node">
<title>ring_stage2_11_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10238.5,-7217.7 10027.5,-7217.7 10027.5,-7164.7 10238.5,-7164.7 10238.5,-7217.7"/>
<text text-anchor="middle" x="10133" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10133" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_10×V_10</text>
<text text-anchor="middle" x="10133" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_10_5&#45;&gt;ring_stage2_11_5 -->
<g id="edge2337" class="edge">
<title>ring_stage2_10_5&#45;&gt;ring_stage2_11_5</title>
<path fill="none" stroke="black" d="M10318.63,-7306.69C10280.5,-7283.18 10223.84,-7248.23 10183.15,-7223.14"/>
<polygon fill="black" stroke="black" points="10184.82,-7220.05 10174.47,-7217.78 10181.14,-7226.01 10184.82,-7220.05"/>
</g>
<!-- kv_send2_10_6 -->
<g id="node1641" class="node">
<title>kv_send2_10_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11485" cy="-7049.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11485" y="-7053" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="11485" y="-7038" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_10_6&#45;&gt;kv_send2_10_6 -->
<g id="edge2294" class="edge">
<title>ring_stage2_10_6&#45;&gt;kv_send2_10_6</title>
<path fill="none" stroke="black" d="M11315.97,-7164.53C11351.08,-7140.77 11403.3,-7105.46 11440.39,-7080.37"/>
<polygon fill="black" stroke="black" points="11442.68,-7083.05 11449.01,-7074.55 11438.76,-7077.25 11442.68,-7083.05"/>
</g>
<!-- ring_stage2_11_6 -->
<g id="node1657" class="node">
<title>ring_stage2_11_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10918.5,-7075.7 10707.5,-7075.7 10707.5,-7022.7 10918.5,-7022.7 10918.5,-7075.7"/>
<text text-anchor="middle" x="10813" y="-7060.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10813" y="-7045.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_11×V_11</text>
<text text-anchor="middle" x="10813" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_10_6&#45;&gt;ring_stage2_11_6 -->
<g id="edge2340" class="edge">
<title>ring_stage2_10_6&#45;&gt;ring_stage2_11_6</title>
<path fill="none" stroke="black" d="M11172.48,-7169.02C11102.01,-7153.59 11007.79,-7130.49 10927,-7102.2 10909.16,-7095.96 10890.29,-7087.96 10873.15,-7080.12"/>
<polygon fill="black" stroke="black" points="10874.37,-7076.82 10863.83,-7075.79 10871.42,-7083.17 10874.37,-7076.82"/>
</g>
<!-- kv_send2_10_7 -->
<g id="node1642" class="node">
<title>kv_send2_10_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11599" cy="-8682.73" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11599" y="-8686.53" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11599" y="-8671.53" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_10_7&#45;&gt;kv_send2_10_7 -->
<g id="edge2297" class="edge">
<title>ring_stage2_10_7&#45;&gt;kv_send2_10_7</title>
<path fill="none" stroke="black" d="M11606.76,-8745.62C11605.74,-8737.49 11604.59,-8728.35 11603.5,-8719.64"/>
<polygon fill="black" stroke="black" points="11606.97,-8719.19 11602.26,-8709.7 11600.03,-8720.06 11606.97,-8719.19"/>
</g>
<!-- ring_stage2_11_7 -->
<g id="node1658" class="node">
<title>ring_stage2_11_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11627.5,-6933.7 11416.5,-6933.7 11416.5,-6880.7 11627.5,-6880.7 11627.5,-6933.7"/>
<text text-anchor="middle" x="11522" y="-6918.5" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="11522" y="-6903.5" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_12×V_12</text>
<text text-anchor="middle" x="11522" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_10_7&#45;&gt;ring_stage2_11_7 -->
<g id="edge2343" class="edge">
<title>ring_stage2_10_7&#45;&gt;ring_stage2_11_7</title>
<path fill="none" stroke="black" d="M11665.15,-8745.85C11681.49,-8736.25 11698.36,-8724.1 11711,-8709.6 11776.49,-8634.5 11801,-8603.9 11801,-8504.25 11801,-8504.25 11801,-8504.25 11801,-7963.81 11801,-7893.4 11832.4,-7881.09 11847,-7812.2 11865.01,-7727.21 11871,-7705.08 11871,-7618.2 11871,-7618.2 11871,-7618.2 11871,-7332.2 11871,-7245.87 11918.18,-7202.89 11861,-7138.2 11800.03,-7069.22 11729.05,-7159.52 11657,-7102.2 11616.95,-7070.34 11640.86,-7038.47 11612,-6996.2 11598,-6975.7 11578.7,-6956.07 11561.57,-6940.57"/>
<polygon fill="black" stroke="black" points="11563.68,-6937.76 11553.87,-6933.75 11559.04,-6943 11563.68,-6937.76"/>
</g>
<!-- kv_send2_10_8 -->
<g id="node1643" class="node">
<title>kv_send2_10_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11366" cy="-8592.99" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11366" y="-8596.79" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11366" y="-8581.79" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_10_8&#45;&gt;kv_send2_10_8 -->
<g id="edge2300" class="edge">
<title>ring_stage2_10_8&#45;&gt;kv_send2_10_8</title>
<path fill="none" stroke="black" d="M11368.12,-8655.88C11367.84,-8647.83 11367.53,-8638.8 11367.24,-8630.18"/>
<polygon fill="black" stroke="black" points="11370.73,-8629.84 11366.89,-8619.96 11363.73,-8630.08 11370.73,-8629.84"/>
</g>
<!-- ring_stage2_11_8 -->
<g id="node1659" class="node">
<title>ring_stage2_11_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11703.5,-8619.49 11492.5,-8619.49 11492.5,-8566.49 11703.5,-8566.49 11703.5,-8619.49"/>
<text text-anchor="middle" x="11598" y="-8604.29" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="11598" y="-8589.29" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_13×V_13</text>
<text text-anchor="middle" x="11598" y="-8574.29" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_10_8&#45;&gt;ring_stage2_11_8 -->
<g id="edge2346" class="edge">
<title>ring_stage2_10_8&#45;&gt;ring_stage2_11_8</title>
<path fill="none" stroke="black" d="M11435.85,-8656.12C11462.66,-8645.85 11493.71,-8633.95 11521.42,-8623.34"/>
<polygon fill="black" stroke="black" points="11522.98,-8626.49 11531.07,-8619.64 11520.47,-8619.95 11522.98,-8626.49"/>
</g>
<!-- kv_send2_10_9 -->
<g id="node1644" class="node">
<title>kv_send2_10_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11127" cy="-8503.25" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11127" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="11127" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_10_9&#45;&gt;kv_send2_10_9 -->
<g id="edge2303" class="edge">
<title>ring_stage2_10_9&#45;&gt;kv_send2_10_9</title>
<path fill="none" stroke="black" d="M11128.41,-8566.14C11128.23,-8558.09 11128.02,-8549.06 11127.82,-8540.44"/>
<polygon fill="black" stroke="black" points="11131.32,-8540.14 11127.59,-8530.22 11124.32,-8540.3 11131.32,-8540.14"/>
</g>
<!-- ring_stage2_11_9 -->
<g id="node1660" class="node">
<title>ring_stage2_11_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11469.5,-8529.75 11258.5,-8529.75 11258.5,-8476.75 11469.5,-8476.75 11469.5,-8529.75"/>
<text text-anchor="middle" x="11364" y="-8514.55" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="11364" y="-8499.55" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_14×V_14</text>
<text text-anchor="middle" x="11364" y="-8484.55" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_10_9&#45;&gt;ring_stage2_11_9 -->
<g id="edge2349" class="edge">
<title>ring_stage2_10_9&#45;&gt;ring_stage2_11_9</title>
<path fill="none" stroke="black" d="M11197.6,-8566.38C11225.23,-8556.06 11257.25,-8544.11 11285.78,-8533.46"/>
<polygon fill="black" stroke="black" points="11287.17,-8536.68 11295.31,-8529.9 11284.72,-8530.12 11287.17,-8536.68"/>
</g>
<!-- kv_send2_10_10 -->
<g id="node1645" class="node">
<title>kv_send2_10_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10887" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10887" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="10887" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_10_10&#45;&gt;kv_send2_10_10 -->
<g id="edge2306" class="edge">
<title>ring_stage2_10_10&#45;&gt;kv_send2_10_10</title>
<path fill="none" stroke="black" d="M10893.35,-8476.4C10892.52,-8468.35 10891.6,-8459.32 10890.71,-8450.7"/>
<polygon fill="black" stroke="black" points="10894.17,-8450.07 10889.66,-8440.48 10887.2,-8450.79 10894.17,-8450.07"/>
</g>
<!-- ring_stage2_11_10 -->
<g id="node1661" class="node">
<title>ring_stage2_11_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11235,-8440.01 11015,-8440.01 11015,-8387.01 11235,-8387.01 11235,-8440.01"/>
<text text-anchor="middle" x="11125" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="11125" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_15×V_15</text>
<text text-anchor="middle" x="11125" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_10_10&#45;&gt;ring_stage2_11_10 -->
<g id="edge2352" class="edge">
<title>ring_stage2_10_10&#45;&gt;ring_stage2_11_10</title>
<path fill="none" stroke="black" d="M10962.85,-8476.64C10989.66,-8466.37 11020.71,-8454.47 11048.42,-8443.86"/>
<polygon fill="black" stroke="black" points="11049.98,-8447.01 11058.07,-8440.16 11047.47,-8440.47 11049.98,-8447.01"/>
</g>
<!-- kv_send2_10_11 -->
<g id="node1646" class="node">
<title>kv_send2_10_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10638" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10638" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="10638" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_10_11&#45;&gt;kv_send2_10_11 -->
<g id="edge2309" class="edge">
<title>ring_stage2_10_11&#45;&gt;kv_send2_10_11</title>
<path fill="none" stroke="black" d="M10652.11,-8386.66C10650.25,-8378.53 10648.17,-8369.39 10646.18,-8360.68"/>
<polygon fill="black" stroke="black" points="10649.55,-8359.71 10643.92,-8350.74 10642.73,-8361.27 10649.55,-8359.71"/>
</g>
<!-- ring_stage2_11_11 -->
<g id="node1662" class="node">
<title>ring_stage2_11_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10968,-8350.27 10766,-8350.27 10766,-8297.27 10968,-8297.27 10968,-8350.27"/>
<text text-anchor="middle" x="10867" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10867" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_0×V_0</text>
<text text-anchor="middle" x="10867" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_10_11&#45;&gt;ring_stage2_11_11 -->
<g id="edge2355" class="edge">
<title>ring_stage2_10_11&#45;&gt;ring_stage2_11_11</title>
<path fill="none" stroke="black" d="M10719.01,-8386.9C10743.27,-8376.72 10771.32,-8364.94 10796.44,-8354.4"/>
<polygon fill="black" stroke="black" points="10798.05,-8357.52 10805.91,-8350.42 10795.34,-8351.06 10798.05,-8357.52"/>
</g>
<!-- kv_send2_10_12 -->
<g id="node1647" class="node">
<title>kv_send2_10_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10400" cy="-8234.03" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10400" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="10400" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_10_12&#45;&gt;kv_send2_10_12 -->
<g id="edge2312" class="edge">
<title>ring_stage2_10_12&#45;&gt;kv_send2_10_12</title>
<path fill="none" stroke="black" d="M10406.35,-8296.92C10405.52,-8288.87 10404.6,-8279.84 10403.71,-8271.22"/>
<polygon fill="black" stroke="black" points="10407.17,-8270.59 10402.66,-8261 10400.2,-8271.31 10407.17,-8270.59"/>
</g>
<!-- ring_stage2_11_12 -->
<g id="node1663" class="node">
<title>ring_stage2_11_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10730,-8260.53 10528,-8260.53 10528,-8207.53 10730,-8207.53 10730,-8260.53"/>
<text text-anchor="middle" x="10629" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10629" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_1×V_1</text>
<text text-anchor="middle" x="10629" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_10_12&#45;&gt;ring_stage2_11_12 -->
<g id="edge2358" class="edge">
<title>ring_stage2_10_12&#45;&gt;ring_stage2_11_12</title>
<path fill="none" stroke="black" d="M10473.22,-8297.16C10498.87,-8286.93 10528.55,-8275.1 10555.08,-8264.52"/>
<polygon fill="black" stroke="black" points="10556.7,-8267.64 10564.7,-8260.68 10554.11,-8261.13 10556.7,-8267.64"/>
</g>
<!-- kv_send2_10_13 -->
<g id="node1648" class="node">
<title>kv_send2_10_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10140" cy="-8144.29" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10140" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="10140" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_10_13&#45;&gt;kv_send2_10_13 -->
<g id="edge2315" class="edge">
<title>ring_stage2_10_13&#45;&gt;kv_send2_10_13</title>
<path fill="none" stroke="black" d="M10147.76,-8207.18C10146.74,-8199.05 10145.59,-8189.91 10144.5,-8181.2"/>
<polygon fill="black" stroke="black" points="10147.97,-8180.75 10143.26,-8171.26 10141.03,-8181.62 10147.97,-8180.75"/>
</g>
<!-- ring_stage2_11_13 -->
<g id="node1664" class="node">
<title>ring_stage2_11_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10490,-8170.79 10288,-8170.79 10288,-8117.79 10490,-8117.79 10490,-8170.79"/>
<text text-anchor="middle" x="10389" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10389" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_2×V_2</text>
<text text-anchor="middle" x="10389" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_10_13&#45;&gt;ring_stage2_11_13 -->
<g id="edge2361" class="edge">
<title>ring_stage2_10_13&#45;&gt;ring_stage2_11_13</title>
<path fill="none" stroke="black" d="M10220.48,-8207.42C10248.46,-8197.1 10280.89,-8185.15 10309.78,-8174.5"/>
<polygon fill="black" stroke="black" points="10311.26,-8177.68 10319.43,-8170.94 10308.84,-8171.11 10311.26,-8177.68"/>
</g>
<!-- kv_send2_10_14 -->
<g id="node1649" class="node">
<title>kv_send2_10_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9902" cy="-8054.55" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9902" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="9902" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_10_14&#45;&gt;kv_send2_10_14 -->
<g id="edge2318" class="edge">
<title>ring_stage2_10_14&#45;&gt;kv_send2_10_14</title>
<path fill="none" stroke="black" d="M9907.64,-8117.44C9906.91,-8109.39 9906.09,-8100.36 9905.3,-8091.74"/>
<polygon fill="black" stroke="black" points="9908.76,-8091.16 9904.37,-8081.52 9901.79,-8091.8 9908.76,-8091.16"/>
</g>
<!-- ring_stage2_11_14 -->
<g id="node1665" class="node">
<title>ring_stage2_11_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10232,-8081.05 10030,-8081.05 10030,-8028.05 10232,-8028.05 10232,-8081.05"/>
<text text-anchor="middle" x="10131" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="10131" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_3×V_3</text>
<text text-anchor="middle" x="10131" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_10_14&#45;&gt;ring_stage2_11_14 -->
<g id="edge2364" class="edge">
<title>ring_stage2_10_14&#45;&gt;ring_stage2_11_14</title>
<path fill="none" stroke="black" d="M9974.52,-8117.68C10000.39,-8107.41 10030.35,-8095.51 10057.09,-8084.9"/>
<polygon fill="black" stroke="black" points="10058.4,-8088.14 10066.4,-8081.2 10055.82,-8081.64 10058.4,-8088.14"/>
</g>
<!-- kv_send2_10_15 -->
<g id="node1650" class="node">
<title>kv_send2_10_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9216" cy="-7964.81" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9216" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9216" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_10_15&#45;&gt;kv_send2_10_15 -->
<g id="edge2321" class="edge">
<title>ring_stage2_10_15&#45;&gt;kv_send2_10_15</title>
<path fill="none" stroke="black" d="M9379.56,-8027.94C9348.92,-8016.3 9312.79,-8002.58 9282.28,-7990.99"/>
<polygon fill="black" stroke="black" points="9283.18,-7987.59 9272.59,-7987.31 9280.7,-7994.13 9283.18,-7987.59"/>
</g>
<!-- ring_stage2_11_15 -->
<g id="node1666" class="node">
<title>ring_stage2_11_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9763,-7991.31 9561,-7991.31 9561,-7938.31 9763,-7938.31 9763,-7991.31"/>
<text text-anchor="middle" x="9662" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="9662" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_4×V_4</text>
<text text-anchor="middle" x="9662" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_10_15&#45;&gt;ring_stage2_11_15 -->
<g id="edge2367" class="edge">
<title>ring_stage2_10_15&#45;&gt;ring_stage2_11_15</title>
<path fill="none" stroke="black" d="M9509.76,-8027.94C9534.82,-8017.71 9563.83,-8005.88 9589.76,-7995.3"/>
<polygon fill="black" stroke="black" points="9591.22,-7998.48 9599.16,-7991.46 9588.58,-7992 9591.22,-7998.48"/>
</g>
<!-- kv_send2_10_0&#45;&gt;ring_stage2_11_1 -->
<g id="edge2326" class="edge">
<title>kv_send2_10_0&#45;&gt;ring_stage2_11_1</title>
<path fill="none" stroke="black" d="M8257,-7847.95C8257,-7832.51 8257,-7812.74 8257,-7795.87"/>
<polygon fill="black" stroke="black" points="8260.5,-7795.81 8257,-7785.81 8253.5,-7795.81 8260.5,-7795.81"/>
</g>
<!-- kv_send2_10_1&#45;&gt;ring_stage2_11_2 -->
<g id="edge2329" class="edge">
<title>kv_send2_10_1&#45;&gt;ring_stage2_11_2</title>
<path fill="none" stroke="black" d="M8076.48,-7734.14C8113,-7710.68 8168.69,-7674.91 8208.56,-7649.31"/>
<polygon fill="black" stroke="black" points="8210.54,-7652.2 8217.06,-7643.85 8206.76,-7646.31 8210.54,-7652.2"/>
</g>
<!-- kv_send2_10_2&#45;&gt;ring_stage2_11_3 -->
<g id="edge2332" class="edge">
<title>kv_send2_10_2&#45;&gt;ring_stage2_11_3</title>
<path fill="none" stroke="black" d="M8916.5,-7590.2C8922,-7568.2 8929.94,-7536.44 8936.04,-7512.03"/>
<polygon fill="black" stroke="black" points="8939.5,-7512.62 8938.53,-7502.07 8932.71,-7510.92 8939.5,-7512.62"/>
</g>
<!-- kv_send2_10_3&#45;&gt;ring_stage2_11_4 -->
<g id="edge2335" class="edge">
<title>kv_send2_10_3&#45;&gt;ring_stage2_11_4</title>
<path fill="none" stroke="black" d="M9424.82,-7450.14C9461.67,-7426.68 9517.88,-7390.91 9558.11,-7365.31"/>
<polygon fill="black" stroke="black" points="9560.14,-7368.17 9566.7,-7359.85 9556.38,-7362.27 9560.14,-7368.17"/>
</g>
<!-- kv_send2_10_4&#45;&gt;ring_stage2_11_5 -->
<g id="edge2338" class="edge">
<title>kv_send2_10_4&#45;&gt;ring_stage2_11_5</title>
<path fill="none" stroke="black" d="M10133,-7306.2C10133,-7284.29 10133,-7252.72 10133,-7228.36"/>
<polygon fill="black" stroke="black" points="10136.5,-7228.07 10133,-7218.07 10129.5,-7228.07 10136.5,-7228.07"/>
</g>
<!-- kv_send2_10_5&#45;&gt;ring_stage2_11_6 -->
<g id="edge2341" class="edge">
<title>kv_send2_10_5&#45;&gt;ring_stage2_11_6</title>
<path fill="none" stroke="black" d="M10425.59,-7166.93C10445.63,-7157.25 10469.66,-7146.39 10492,-7138.2 10558.83,-7113.72 10635.65,-7092.43 10697.38,-7076.92"/>
<polygon fill="black" stroke="black" points="10698.3,-7080.3 10707.16,-7074.49 10696.61,-7073.51 10698.3,-7080.3"/>
</g>
<!-- kv_send2_10_6&#45;&gt;ring_stage2_11_7 -->
<g id="edge2344" class="edge">
<title>kv_send2_10_6&#45;&gt;ring_stage2_11_7</title>
<path fill="none" stroke="black" d="M11491.87,-7022.2C11497.69,-7000.2 11506.08,-6968.44 11512.53,-6944.03"/>
<polygon fill="black" stroke="black" points="11515.99,-6944.63 11515.16,-6934.07 11509.23,-6942.84 11515.99,-6944.63"/>
</g>
<!-- kv_send2_10_7&#45;&gt;ring_stage2_11_8 -->
<g id="edge2347" class="edge">
<title>kv_send2_10_7&#45;&gt;ring_stage2_11_8</title>
<path fill="none" stroke="black" d="M11598.7,-8655.41C11598.61,-8647.37 11598.51,-8638.39 11598.41,-8629.83"/>
<polygon fill="black" stroke="black" points="11601.91,-8629.66 11598.29,-8619.7 11594.91,-8629.74 11601.91,-8629.66"/>
</g>
<!-- kv_send2_10_8&#45;&gt;ring_stage2_11_9 -->
<g id="edge2350" class="edge">
<title>kv_send2_10_8&#45;&gt;ring_stage2_11_9</title>
<path fill="none" stroke="black" d="M11365.4,-8565.67C11365.22,-8557.63 11365.01,-8548.65 11364.82,-8540.09"/>
<polygon fill="black" stroke="black" points="11368.31,-8539.87 11364.59,-8529.96 11361.31,-8540.03 11368.31,-8539.87"/>
</g>
<!-- kv_send2_10_9&#45;&gt;ring_stage2_11_10 -->
<g id="edge2353" class="edge">
<title>kv_send2_10_9&#45;&gt;ring_stage2_11_10</title>
<path fill="none" stroke="black" d="M11126.4,-8475.93C11126.22,-8467.89 11126.01,-8458.91 11125.82,-8450.35"/>
<polygon fill="black" stroke="black" points="11129.31,-8450.13 11125.59,-8440.22 11122.31,-8450.29 11129.31,-8450.13"/>
</g>
<!-- kv_send2_10_10&#45;&gt;ring_stage2_11_11 -->
<g id="edge2356" class="edge">
<title>kv_send2_10_10&#45;&gt;ring_stage2_11_11</title>
<path fill="none" stroke="black" d="M10881.11,-8386.66C10879.24,-8378.45 10877.13,-8369.22 10875.13,-8360.45"/>
<polygon fill="black" stroke="black" points="10878.49,-8359.41 10872.85,-8350.44 10871.66,-8360.97 10878.49,-8359.41"/>
</g>
<!-- kv_send2_10_11&#45;&gt;ring_stage2_11_12 -->
<g id="edge2359" class="edge">
<title>kv_send2_10_11&#45;&gt;ring_stage2_11_12</title>
<path fill="none" stroke="black" d="M10635.3,-8296.45C10634.48,-8288.41 10633.55,-8279.43 10632.68,-8270.87"/>
<polygon fill="black" stroke="black" points="10636.14,-8270.33 10631.64,-8260.74 10629.18,-8271.04 10636.14,-8270.33"/>
</g>
<!-- kv_send2_10_12&#45;&gt;ring_stage2_11_13 -->
<g id="edge2362" class="edge">
<title>kv_send2_10_12&#45;&gt;ring_stage2_11_13</title>
<path fill="none" stroke="black" d="M10396.7,-8206.71C10395.69,-8198.67 10394.57,-8189.69 10393.49,-8181.13"/>
<polygon fill="black" stroke="black" points="10396.94,-8180.48 10392.22,-8171 10389.99,-8181.35 10396.94,-8180.48"/>
</g>
<!-- kv_send2_10_13&#45;&gt;ring_stage2_11_14 -->
<g id="edge2365" class="edge">
<title>kv_send2_10_13&#45;&gt;ring_stage2_11_14</title>
<path fill="none" stroke="black" d="M10137.3,-8116.97C10136.48,-8108.93 10135.55,-8099.95 10134.68,-8091.39"/>
<polygon fill="black" stroke="black" points="10138.14,-8090.85 10133.64,-8081.26 10131.18,-8091.56 10138.14,-8090.85"/>
</g>
<!-- kv_send2_10_14&#45;&gt;ring_stage2_11_15 -->
<g id="edge2368" class="edge">
<title>kv_send2_10_14&#45;&gt;ring_stage2_11_15</title>
<path fill="none" stroke="black" d="M9842.67,-8031.87C9812.23,-8020.73 9774.71,-8007.02 9741.76,-7994.97"/>
<polygon fill="black" stroke="black" points="9742.75,-7991.61 9732.15,-7991.46 9740.34,-7998.18 9742.75,-7991.61"/>
</g>
<!-- kv_send2_10_15&#45;&gt;ring_stage2_11_0 -->
<g id="edge2323" class="edge">
<title>kv_send2_10_15&#45;&gt;ring_stage2_11_0</title>
<path fill="none" stroke="black" d="M9148.47,-7944.45C9107.47,-7932.69 9054.42,-7917.48 9008.77,-7904.39"/>
<polygon fill="black" stroke="black" points="9009.72,-7901.03 8999.15,-7901.63 9007.79,-7907.76 9009.72,-7901.03"/>
</g>
<!-- kv_send2_11_0 -->
<g id="node1667" class="node">
<title>kv_send2_11_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8910" cy="-7759.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8910" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8910" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_11_0&#45;&gt;kv_send2_11_0 -->
<g id="edge2324" class="edge">
<title>ring_stage2_11_0&#45;&gt;kv_send2_11_0</title>
<path fill="none" stroke="black" d="M8910,-7848.52C8910,-7833.21 8910,-7813.49 8910,-7796.57"/>
<polygon fill="black" stroke="black" points="8913.5,-7796.46 8910,-7786.46 8906.5,-7796.46 8913.5,-7796.46"/>
</g>
<!-- ring_stage2_12_0 -->
<g id="node1683" class="node">
<title>ring_stage2_12_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9224.5,-7785.7 9031.5,-7785.7 9031.5,-7732.7 9224.5,-7732.7 9224.5,-7785.7"/>
<text text-anchor="middle" x="9128" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="9128" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_4×V_4</text>
<text text-anchor="middle" x="9128" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_11_0&#45;&gt;ring_stage2_12_0 -->
<g id="edge2370" class="edge">
<title>ring_stage2_11_0&#45;&gt;ring_stage2_12_0</title>
<path fill="none" stroke="black" d="M8958.92,-7848.52C8991.77,-7831.36 9035.19,-7808.68 9069.81,-7790.6"/>
<polygon fill="black" stroke="black" points="9071.62,-7793.6 9078.86,-7785.87 9068.38,-7787.4 9071.62,-7793.6"/>
</g>
<!-- kv_send2_11_1 -->
<g id="node1668" class="node">
<title>kv_send2_11_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8039" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8039" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8039" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_11_1&#45;&gt;kv_send2_11_1 -->
<g id="edge2327" class="edge">
<title>ring_stage2_11_1&#45;&gt;kv_send2_11_1</title>
<path fill="none" stroke="black" d="M8217.27,-7732.69C8180.05,-7708.78 8124.43,-7673.06 8085.23,-7647.89"/>
<polygon fill="black" stroke="black" points="8086.94,-7644.83 8076.64,-7642.37 8083.16,-7650.72 8086.94,-7644.83"/>
</g>
<!-- ring_stage2_12_1 -->
<g id="node1684" class="node">
<title>ring_stage2_12_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8564.5,-7643.7 8371.5,-7643.7 8371.5,-7590.7 8564.5,-7590.7 8564.5,-7643.7"/>
<text text-anchor="middle" x="8468" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="8468" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_5×V_5</text>
<text text-anchor="middle" x="8468" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_11_1&#45;&gt;ring_stage2_12_1 -->
<g id="edge2373" class="edge">
<title>ring_stage2_11_1&#45;&gt;ring_stage2_12_1</title>
<path fill="none" stroke="black" d="M8295.7,-7732.53C8330.95,-7709.14 8383.09,-7674.54 8420.78,-7649.54"/>
<polygon fill="black" stroke="black" points="8423.15,-7652.16 8429.54,-7643.72 8419.28,-7646.33 8423.15,-7652.16"/>
</g>
<!-- kv_send2_11_2 -->
<g id="node1669" class="node">
<title>kv_send2_11_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8257" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8257" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8257" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_11_2&#45;&gt;kv_send2_11_2 -->
<g id="edge2330" class="edge">
<title>ring_stage2_11_2&#45;&gt;kv_send2_11_2</title>
<path fill="none" stroke="black" d="M8257,-7590.53C8257,-7568.56 8257,-7536.71 8257,-7512.2"/>
<polygon fill="black" stroke="black" points="8260.5,-7512.19 8257,-7502.19 8253.5,-7512.19 8260.5,-7512.19"/>
</g>
<!-- ring_stage2_12_2 -->
<g id="node1685" class="node">
<title>ring_stage2_12_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8135.5,-7501.7 7942.5,-7501.7 7942.5,-7448.7 8135.5,-7448.7 8135.5,-7501.7"/>
<text text-anchor="middle" x="8039" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="8039" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_6×V_6</text>
<text text-anchor="middle" x="8039" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_11_2&#45;&gt;ring_stage2_12_2 -->
<g id="edge2376" class="edge">
<title>ring_stage2_11_2&#45;&gt;ring_stage2_12_2</title>
<path fill="none" stroke="black" d="M8217.27,-7590.69C8180.73,-7567.22 8126.47,-7532.38 8087.41,-7507.29"/>
<polygon fill="black" stroke="black" points="8089.13,-7504.24 8078.83,-7501.78 8085.35,-7510.13 8089.13,-7504.24"/>
</g>
<!-- kv_send2_11_3 -->
<g id="node1670" class="node">
<title>kv_send2_11_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9385" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9385" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9385" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_11_3&#45;&gt;kv_send2_11_3 -->
<g id="edge2333" class="edge">
<title>ring_stage2_11_3&#45;&gt;kv_send2_11_3</title>
<path fill="none" stroke="black" d="M8989.69,-7448.64C9008.16,-7439.06 9030.11,-7428.88 9051,-7422.2 9145.38,-7392.06 9176.2,-7415.02 9271,-7386.2 9291.57,-7379.95 9313.25,-7370.78 9332.11,-7361.87"/>
<polygon fill="black" stroke="black" points="9333.64,-7365.02 9341.13,-7357.53 9330.6,-7358.71 9333.64,-7365.02"/>
</g>
<!-- ring_stage2_12_3 -->
<g id="node1686" class="node">
<title>ring_stage2_12_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9050.5,-7359.7 8857.5,-7359.7 8857.5,-7306.7 9050.5,-7306.7 9050.5,-7359.7"/>
<text text-anchor="middle" x="8954" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="8954" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_7×V_7</text>
<text text-anchor="middle" x="8954" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_11_3&#45;&gt;ring_stage2_12_3 -->
<g id="edge2379" class="edge">
<title>ring_stage2_11_3&#45;&gt;ring_stage2_12_3</title>
<path fill="none" stroke="black" d="M8946.65,-7448.53C8948.07,-7426.42 8950.14,-7394.3 8951.72,-7369.73"/>
<polygon fill="black" stroke="black" points="8955.21,-7369.92 8952.36,-7359.72 8948.23,-7369.47 8955.21,-7369.92"/>
</g>
<!-- kv_send2_11_4 -->
<g id="node1671" class="node">
<title>kv_send2_11_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9695" cy="-7191.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9695" y="-7195" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9695" y="-7180" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_11_4&#45;&gt;kv_send2_11_4 -->
<g id="edge2336" class="edge">
<title>ring_stage2_11_4&#45;&gt;kv_send2_11_4</title>
<path fill="none" stroke="black" d="M9623.14,-7306.53C9637.19,-7284.17 9657.69,-7251.56 9673.2,-7226.89"/>
<polygon fill="black" stroke="black" points="9676.31,-7228.52 9678.66,-7218.19 9670.38,-7224.8 9676.31,-7228.52"/>
</g>
<!-- ring_stage2_12_4 -->
<g id="node1687" class="node">
<title>ring_stage2_12_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9573.5,-7217.7 9380.5,-7217.7 9380.5,-7164.7 9573.5,-7164.7 9573.5,-7217.7"/>
<text text-anchor="middle" x="9477" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="9477" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_8×V_8</text>
<text text-anchor="middle" x="9477" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_11_4&#45;&gt;ring_stage2_12_4 -->
<g id="edge2382" class="edge">
<title>ring_stage2_11_4&#45;&gt;ring_stage2_12_4</title>
<path fill="none" stroke="black" d="M9583.16,-7306.53C9561.9,-7283.63 9530.67,-7250 9507.58,-7225.13"/>
<polygon fill="black" stroke="black" points="9510.06,-7222.67 9500.69,-7217.72 9504.93,-7227.43 9510.06,-7222.67"/>
</g>
<!-- kv_send2_11_5 -->
<g id="node1672" class="node">
<title>kv_send2_11_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10426" cy="-7049.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10426" y="-7053" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10426" y="-7038" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_11_5&#45;&gt;kv_send2_11_5 -->
<g id="edge2339" class="edge">
<title>ring_stage2_11_5&#45;&gt;kv_send2_11_5</title>
<path fill="none" stroke="black" d="M10186.4,-7164.69C10237.94,-7140.06 10315.73,-7102.89 10368.58,-7077.64"/>
<polygon fill="black" stroke="black" points="10370.31,-7080.69 10377.82,-7073.22 10367.29,-7074.38 10370.31,-7080.69"/>
</g>
<!-- ring_stage2_12_5 -->
<g id="node1688" class="node">
<title>ring_stage2_12_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10229.5,-7075.7 10036.5,-7075.7 10036.5,-7022.7 10229.5,-7022.7 10229.5,-7075.7"/>
<text text-anchor="middle" x="10133" y="-7060.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="10133" y="-7045.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_9×V_9</text>
<text text-anchor="middle" x="10133" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_11_5&#45;&gt;ring_stage2_12_5 -->
<g id="edge2385" class="edge">
<title>ring_stage2_11_5&#45;&gt;ring_stage2_12_5</title>
<path fill="none" stroke="black" d="M10133,-7164.53C10133,-7142.42 10133,-7110.3 10133,-7085.73"/>
<polygon fill="black" stroke="black" points="10136.5,-7085.72 10133,-7075.72 10129.5,-7085.72 10136.5,-7085.72"/>
</g>
<!-- kv_send2_11_6 -->
<g id="node1673" class="node">
<title>kv_send2_11_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11295" cy="-6907.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11295" y="-6911" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="11295" y="-6896" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_11_6&#45;&gt;kv_send2_11_6 -->
<g id="edge2342" class="edge">
<title>ring_stage2_11_6&#45;&gt;kv_send2_11_6</title>
<path fill="none" stroke="black" d="M10863.5,-7022.63C10883,-7013.43 10905.71,-7003.53 10927,-6996.2 11018.55,-6964.71 11126.66,-6940.31 11201.92,-6925.28"/>
<polygon fill="black" stroke="black" points="11202.72,-6928.69 11211.85,-6923.31 11201.36,-6921.82 11202.72,-6928.69"/>
</g>
<!-- ring_stage2_12_6 -->
<g id="node1689" class="node">
<title>ring_stage2_12_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10956.5,-6933.7 10745.5,-6933.7 10745.5,-6880.7 10956.5,-6880.7 10956.5,-6933.7"/>
<text text-anchor="middle" x="10851" y="-6918.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="10851" y="-6903.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_10×V_10</text>
<text text-anchor="middle" x="10851" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_11_6&#45;&gt;ring_stage2_12_6 -->
<g id="edge2388" class="edge">
<title>ring_stage2_11_6&#45;&gt;ring_stage2_12_6</title>
<path fill="none" stroke="black" d="M10819.97,-7022.53C10826,-7000.32 10834.76,-6968.02 10841.44,-6943.41"/>
<polygon fill="black" stroke="black" points="10844.83,-6944.29 10844.07,-6933.72 10838.08,-6942.45 10844.83,-6944.29"/>
</g>
<!-- kv_send2_11_7 -->
<g id="node1674" class="node">
<title>kv_send2_11_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11525" cy="-6765.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11525" y="-6769" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11525" y="-6754" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_11_7&#45;&gt;kv_send2_11_7 -->
<g id="edge2345" class="edge">
<title>ring_stage2_11_7&#45;&gt;kv_send2_11_7</title>
<path fill="none" stroke="black" d="M11522.55,-6880.53C11523.02,-6858.56 11523.7,-6826.71 11524.23,-6802.2"/>
<polygon fill="black" stroke="black" points="11527.73,-6802.27 11524.44,-6792.19 11520.73,-6802.12 11527.73,-6802.27"/>
</g>
<!-- ring_stage2_12_7 -->
<g id="node1690" class="node">
<title>ring_stage2_12_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11403.5,-6791.7 11192.5,-6791.7 11192.5,-6738.7 11403.5,-6738.7 11403.5,-6791.7"/>
<text text-anchor="middle" x="11298" y="-6776.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="11298" y="-6761.5" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_11×V_11</text>
<text text-anchor="middle" x="11298" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_11_7&#45;&gt;ring_stage2_12_7 -->
<g id="edge2391" class="edge">
<title>ring_stage2_11_7&#45;&gt;ring_stage2_12_7</title>
<path fill="none" stroke="black" d="M11481.18,-6880.69C11443.56,-6857.18 11387.64,-6822.23 11347.49,-6797.14"/>
<polygon fill="black" stroke="black" points="11349.26,-6794.11 11338.92,-6791.78 11345.55,-6800.05 11349.26,-6794.11"/>
</g>
<!-- kv_send2_11_8 -->
<g id="node1675" class="node">
<title>kv_send2_11_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11598" cy="-8503.25" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11598" y="-8507.05" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11598" y="-8492.05" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_11_8&#45;&gt;kv_send2_11_8 -->
<g id="edge2348" class="edge">
<title>ring_stage2_11_8&#45;&gt;kv_send2_11_8</title>
<path fill="none" stroke="black" d="M11598,-8566.14C11598,-8558.09 11598,-8549.06 11598,-8540.44"/>
<polygon fill="black" stroke="black" points="11601.5,-8540.22 11598,-8530.22 11594.5,-8540.22 11601.5,-8540.22"/>
</g>
<!-- ring_stage2_12_8 -->
<g id="node1691" class="node">
<title>ring_stage2_12_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11726.5,-6649.7 11515.5,-6649.7 11515.5,-6596.7 11726.5,-6596.7 11726.5,-6649.7"/>
<text text-anchor="middle" x="11621" y="-6634.5" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="11621" y="-6619.5" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_12×V_12</text>
<text text-anchor="middle" x="11621" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_11_8&#45;&gt;ring_stage2_12_8 -->
<g id="edge2394" class="edge">
<title>ring_stage2_11_8&#45;&gt;ring_stage2_12_8</title>
<path fill="none" stroke="black" d="M11667.85,-8566.49C11684.06,-8557.4 11699.59,-8545.48 11710,-8530.12 11731.43,-8498.52 11778.31,-7882.04 11796,-7848.2 11807.08,-7827.01 11826.27,-7834.05 11836,-7812.2 11853.63,-7772.62 11863.78,-7455.46 11836,-7422.2 11778.38,-7353.22 11694.62,-7455.18 11637,-7386.2 11637,-7386.2 11637,-6712.2 11637,-6712.2 11635.43,-6694.82 11632.16,-6675.74 11628.98,-6659.81"/>
<polygon fill="black" stroke="black" points="11632.37,-6658.92 11626.92,-6649.84 11625.51,-6660.34 11632.37,-6658.92"/>
</g>
<!-- kv_send2_11_9 -->
<g id="node1676" class="node">
<title>kv_send2_11_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11363" cy="-8413.51" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11363" y="-8417.31" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="11363" y="-8402.31" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_11_9&#45;&gt;kv_send2_11_9 -->
<g id="edge2351" class="edge">
<title>ring_stage2_11_9&#45;&gt;kv_send2_11_9</title>
<path fill="none" stroke="black" d="M11363.71,-8476.4C11363.61,-8468.35 11363.51,-8459.32 11363.41,-8450.7"/>
<polygon fill="black" stroke="black" points="11366.91,-8450.44 11363.3,-8440.48 11359.91,-8450.52 11366.91,-8450.44"/>
</g>
<!-- ring_stage2_12_9 -->
<g id="node1692" class="node">
<title>ring_stage2_12_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11701.5,-8440.01 11490.5,-8440.01 11490.5,-8387.01 11701.5,-8387.01 11701.5,-8440.01"/>
<text text-anchor="middle" x="11596" y="-8424.81" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="11596" y="-8409.81" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_13×V_13</text>
<text text-anchor="middle" x="11596" y="-8394.81" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_11_9&#45;&gt;ring_stage2_12_9 -->
<g id="edge2397" class="edge">
<title>ring_stage2_11_9&#45;&gt;ring_stage2_12_9</title>
<path fill="none" stroke="black" d="M11431.73,-8476.64C11459,-8466.32 11490.62,-8454.37 11518.78,-8443.72"/>
<polygon fill="black" stroke="black" points="11520.07,-8446.97 11528.19,-8440.16 11517.6,-8440.42 11520.07,-8446.97"/>
</g>
<!-- kv_send2_11_10 -->
<g id="node1677" class="node">
<title>kv_send2_11_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11096" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11096" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="11096" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_11_10&#45;&gt;kv_send2_11_10 -->
<g id="edge2354" class="edge">
<title>ring_stage2_11_10&#45;&gt;kv_send2_11_10</title>
<path fill="none" stroke="black" d="M11116.46,-8386.66C11113.74,-8378.44 11110.68,-8369.19 11107.77,-8360.4"/>
<polygon fill="black" stroke="black" points="11111.04,-8359.14 11104.58,-8350.74 11104.4,-8361.34 11111.04,-8359.14"/>
</g>
<!-- ring_stage2_12_10 -->
<g id="node1693" class="node">
<title>ring_stage2_12_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11444,-8350.27 11224,-8350.27 11224,-8297.27 11444,-8297.27 11444,-8350.27"/>
<text text-anchor="middle" x="11334" y="-8335.07" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="11334" y="-8320.07" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_14×V_14</text>
<text text-anchor="middle" x="11334" y="-8305.07" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_11_10&#45;&gt;ring_stage2_12_10 -->
<g id="edge2400" class="edge">
<title>ring_stage2_11_10&#45;&gt;ring_stage2_12_10</title>
<path fill="none" stroke="black" d="M11186.01,-8386.9C11210.27,-8376.72 11238.32,-8364.94 11263.44,-8354.4"/>
<polygon fill="black" stroke="black" points="11265.05,-8357.52 11272.91,-8350.42 11262.34,-8351.06 11265.05,-8357.52"/>
</g>
<!-- kv_send2_11_11 -->
<g id="node1678" class="node">
<title>kv_send2_11_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10858" cy="-8234.03" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10858" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="10858" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_11_11&#45;&gt;kv_send2_11_11 -->
<g id="edge2357" class="edge">
<title>ring_stage2_11_11&#45;&gt;kv_send2_11_11</title>
<path fill="none" stroke="black" d="M10864.35,-8296.92C10863.52,-8288.87 10862.6,-8279.84 10861.71,-8271.22"/>
<polygon fill="black" stroke="black" points="10865.17,-8270.59 10860.66,-8261 10858.2,-8271.31 10865.17,-8270.59"/>
</g>
<!-- ring_stage2_12_11 -->
<g id="node1694" class="node">
<title>ring_stage2_12_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11206,-8260.53 10986,-8260.53 10986,-8207.53 11206,-8207.53 11206,-8260.53"/>
<text text-anchor="middle" x="11096" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="11096" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_15×V_15</text>
<text text-anchor="middle" x="11096" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_11_11&#45;&gt;ring_stage2_12_11 -->
<g id="edge2403" class="edge">
<title>ring_stage2_11_11&#45;&gt;ring_stage2_12_11</title>
<path fill="none" stroke="black" d="M10933.85,-8297.16C10960.66,-8286.89 10991.71,-8274.99 11019.42,-8264.38"/>
<polygon fill="black" stroke="black" points="11020.98,-8267.53 11029.07,-8260.68 11018.47,-8260.99 11020.98,-8267.53"/>
</g>
<!-- kv_send2_11_12 -->
<g id="node1679" class="node">
<title>kv_send2_11_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10618" cy="-8144.29" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10618" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="10618" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_11_12&#45;&gt;kv_send2_11_12 -->
<g id="edge2360" class="edge">
<title>ring_stage2_11_12&#45;&gt;kv_send2_11_12</title>
<path fill="none" stroke="black" d="M10625.76,-8207.18C10624.74,-8199.05 10623.59,-8189.91 10622.5,-8181.2"/>
<polygon fill="black" stroke="black" points="10625.97,-8180.75 10621.26,-8171.26 10619.03,-8181.62 10625.97,-8180.75"/>
</g>
<!-- ring_stage2_12_12 -->
<g id="node1695" class="node">
<title>ring_stage2_12_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10948,-8170.79 10746,-8170.79 10746,-8117.79 10948,-8117.79 10948,-8170.79"/>
<text text-anchor="middle" x="10847" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="10847" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_0×V_0</text>
<text text-anchor="middle" x="10847" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_11_12&#45;&gt;ring_stage2_12_12 -->
<g id="edge2406" class="edge">
<title>ring_stage2_11_12&#45;&gt;ring_stage2_12_12</title>
<path fill="none" stroke="black" d="M10692.64,-8207.42C10718.05,-8197.19 10747.46,-8185.36 10773.75,-8174.78"/>
<polygon fill="black" stroke="black" points="10775.31,-8177.92 10783.28,-8170.94 10772.7,-8171.43 10775.31,-8177.92"/>
</g>
<!-- kv_send2_11_13 -->
<g id="node1680" class="node">
<title>kv_send2_11_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10380" cy="-8054.55" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10380" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="10380" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_11_13&#45;&gt;kv_send2_11_13 -->
<g id="edge2363" class="edge">
<title>ring_stage2_11_13&#45;&gt;kv_send2_11_13</title>
<path fill="none" stroke="black" d="M10386.35,-8117.44C10385.52,-8109.39 10384.6,-8100.36 10383.71,-8091.74"/>
<polygon fill="black" stroke="black" points="10387.17,-8091.11 10382.66,-8081.52 10380.2,-8091.83 10387.17,-8091.11"/>
</g>
<!-- ring_stage2_12_13 -->
<g id="node1696" class="node">
<title>ring_stage2_12_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10710,-8081.05 10508,-8081.05 10508,-8028.05 10710,-8028.05 10710,-8081.05"/>
<text text-anchor="middle" x="10609" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="10609" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_1×V_1</text>
<text text-anchor="middle" x="10609" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_11_13&#45;&gt;ring_stage2_12_13 -->
<g id="edge2409" class="edge">
<title>ring_stage2_11_13&#45;&gt;ring_stage2_12_13</title>
<path fill="none" stroke="black" d="M10453.22,-8117.68C10478.87,-8107.45 10508.55,-8095.62 10535.08,-8085.04"/>
<polygon fill="black" stroke="black" points="10536.7,-8088.16 10544.7,-8081.2 10534.11,-8081.65 10536.7,-8088.16"/>
</g>
<!-- kv_send2_11_14 -->
<g id="node1681" class="node">
<title>kv_send2_11_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10120" cy="-7964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10120" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="10120" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_11_14&#45;&gt;kv_send2_11_14 -->
<g id="edge2366" class="edge">
<title>ring_stage2_11_14&#45;&gt;kv_send2_11_14</title>
<path fill="none" stroke="black" d="M10127.76,-8027.7C10126.74,-8019.56 10125.59,-8010.43 10124.5,-8001.72"/>
<polygon fill="black" stroke="black" points="10127.97,-8001.27 10123.26,-7991.78 10121.03,-8002.14 10127.97,-8001.27"/>
</g>
<!-- ring_stage2_12_14 -->
<g id="node1697" class="node">
<title>ring_stage2_12_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10450,-7991.31 10248,-7991.31 10248,-7938.31 10450,-7938.31 10450,-7991.31"/>
<text text-anchor="middle" x="10349" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="10349" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_2×V_2</text>
<text text-anchor="middle" x="10349" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_11_14&#45;&gt;ring_stage2_12_14 -->
<g id="edge2412" class="edge">
<title>ring_stage2_11_14&#45;&gt;ring_stage2_12_14</title>
<path fill="none" stroke="black" d="M10194.64,-8027.94C10220.05,-8017.71 10249.46,-8005.88 10275.75,-7995.3"/>
<polygon fill="black" stroke="black" points="10277.31,-7998.44 10285.28,-7991.46 10274.7,-7991.95 10277.31,-7998.44"/>
</g>
<!-- kv_send2_11_15 -->
<g id="node1682" class="node">
<title>kv_send2_11_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9128" cy="-7875.07" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9128" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9128" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_11_15&#45;&gt;kv_send2_11_15 -->
<g id="edge2369" class="edge">
<title>ring_stage2_11_15&#45;&gt;kv_send2_11_15</title>
<path fill="none" stroke="black" d="M9560.8,-7939.55C9557.84,-7938.99 9554.9,-7938.45 9552,-7937.94 9414.5,-7913.92 9377.55,-7925.69 9240,-7901.94 9230.49,-7900.3 9220.57,-7898.36 9210.74,-7896.28"/>
<polygon fill="black" stroke="black" points="9211.47,-7892.86 9200.96,-7894.17 9210,-7899.7 9211.47,-7892.86"/>
</g>
<!-- ring_stage2_12_15 -->
<g id="node1698" class="node">
<title>ring_stage2_12_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9905,-7901.57 9703,-7901.57 9703,-7848.57 9905,-7848.57 9905,-7901.57"/>
<text text-anchor="middle" x="9804" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="9804" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_3×V_3</text>
<text text-anchor="middle" x="9804" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_11_15&#45;&gt;ring_stage2_12_15 -->
<g id="edge2415" class="edge">
<title>ring_stage2_11_15&#45;&gt;ring_stage2_12_15</title>
<path fill="none" stroke="black" d="M9703.45,-7938.2C9719.06,-7928.55 9736.99,-7917.48 9753.35,-7907.37"/>
<polygon fill="black" stroke="black" points="9755.58,-7910.11 9762.25,-7901.87 9751.9,-7904.15 9755.58,-7910.11"/>
</g>
<!-- kv_send2_11_0&#45;&gt;ring_stage2_12_1 -->
<g id="edge2374" class="edge">
<title>kv_send2_11_0&#45;&gt;ring_stage2_12_1</title>
<path fill="none" stroke="black" d="M8866.69,-7734.69C8846.35,-7724.55 8821.47,-7713.39 8798,-7706.2 8701.58,-7676.69 8670.1,-7700.74 8574,-7670.2 8556.53,-7664.65 8538.32,-7656.63 8522.03,-7648.54"/>
<polygon fill="black" stroke="black" points="8523.18,-7645.2 8512.68,-7643.79 8520.01,-7651.44 8523.18,-7645.2"/>
</g>
<!-- kv_send2_11_1&#45;&gt;ring_stage2_12_2 -->
<g id="edge2377" class="edge">
<title>kv_send2_11_1&#45;&gt;ring_stage2_12_2</title>
<path fill="none" stroke="black" d="M8039,-7590.2C8039,-7568.29 8039,-7536.72 8039,-7512.36"/>
<polygon fill="black" stroke="black" points="8042.5,-7512.07 8039,-7502.07 8035.5,-7512.07 8042.5,-7512.07"/>
</g>
<!-- kv_send2_11_2&#45;&gt;ring_stage2_12_3 -->
<g id="edge2380" class="edge">
<title>kv_send2_11_2&#45;&gt;ring_stage2_12_3</title>
<path fill="none" stroke="black" d="M8298.47,-7450.59C8319.03,-7440.03 8344.62,-7428.55 8369,-7422.2 8575.59,-7368.38 8641.99,-7442.23 8848,-7386.2 8866.44,-7381.19 8885.51,-7372.93 8902.3,-7364.45"/>
<polygon fill="black" stroke="black" points="8904.12,-7367.46 8911.38,-7359.74 8900.89,-7361.24 8904.12,-7367.46"/>
</g>
<!-- kv_send2_11_3&#45;&gt;ring_stage2_12_4 -->
<g id="edge2383" class="edge">
<title>kv_send2_11_3&#45;&gt;ring_stage2_12_4</title>
<path fill="none" stroke="black" d="M9401.87,-7306.53C9416.72,-7283.93 9438.45,-7250.87 9454.72,-7226.1"/>
<polygon fill="black" stroke="black" points="9457.67,-7228 9460.23,-7217.72 9451.82,-7224.15 9457.67,-7228"/>
</g>
<!-- kv_send2_11_4&#45;&gt;ring_stage2_12_5 -->
<g id="edge2386" class="edge">
<title>kv_send2_11_4&#45;&gt;ring_stage2_12_5</title>
<path fill="none" stroke="black" d="M9739.73,-7166.92C9760.14,-7157.01 9784.86,-7145.97 9808,-7138.2 9878.75,-7114.47 9899.97,-7121.69 9972,-7102.2 9997.28,-7095.36 10024.48,-7086.98 10049.2,-7078.96"/>
<polygon fill="black" stroke="black" points="10050.48,-7082.22 10058.9,-7075.79 10048.31,-7075.57 10050.48,-7082.22"/>
</g>
<!-- kv_send2_11_5&#45;&gt;ring_stage2_12_6 -->
<g id="edge2389" class="edge">
<title>kv_send2_11_5&#45;&gt;ring_stage2_12_6</title>
<path fill="none" stroke="black" d="M10500.26,-7030.42C10563.68,-7014.45 10656.92,-6989.12 10736,-6960.2 10753.62,-6953.76 10772.33,-6945.81 10789.41,-6938.08"/>
<polygon fill="black" stroke="black" points="10791.09,-6941.16 10798.72,-6933.82 10788.17,-6934.79 10791.09,-6941.16"/>
</g>
<!-- kv_send2_11_6&#45;&gt;ring_stage2_12_7 -->
<g id="edge2392" class="edge">
<title>kv_send2_11_6&#45;&gt;ring_stage2_12_7</title>
<path fill="none" stroke="black" d="M11295.56,-6880.2C11296.03,-6858.29 11296.7,-6826.72 11297.23,-6802.36"/>
<polygon fill="black" stroke="black" points="11300.73,-6802.14 11297.45,-6792.07 11293.73,-6801.99 11300.73,-6802.14"/>
</g>
<!-- kv_send2_11_7&#45;&gt;ring_stage2_12_8 -->
<g id="edge2395" class="edge">
<title>kv_send2_11_7&#45;&gt;ring_stage2_12_8</title>
<path fill="none" stroke="black" d="M11542.61,-6738.53C11558.1,-6715.93 11580.77,-6682.87 11597.76,-6658.1"/>
<polygon fill="black" stroke="black" points="11600.73,-6659.95 11603.5,-6649.72 11594.96,-6655.99 11600.73,-6659.95"/>
</g>
<!-- kv_send2_11_8&#45;&gt;ring_stage2_12_9 -->
<g id="edge2398" class="edge">
<title>kv_send2_11_8&#45;&gt;ring_stage2_12_9</title>
<path fill="none" stroke="black" d="M11597.4,-8475.93C11597.22,-8467.89 11597.01,-8458.91 11596.82,-8450.35"/>
<polygon fill="black" stroke="black" points="11600.31,-8450.13 11596.59,-8440.22 11593.31,-8450.29 11600.31,-8450.13"/>
</g>
<!-- kv_send2_11_9&#45;&gt;ring_stage2_12_10 -->
<g id="edge2401" class="edge">
<title>kv_send2_11_9&#45;&gt;ring_stage2_12_10</title>
<path fill="none" stroke="black" d="M11354.46,-8386.66C11351.71,-8378.36 11348.62,-8369.02 11345.7,-8360.16"/>
<polygon fill="black" stroke="black" points="11348.94,-8358.84 11342.48,-8350.44 11342.3,-8361.03 11348.94,-8358.84"/>
</g>
<!-- kv_send2_11_10&#45;&gt;ring_stage2_12_11 -->
<g id="edge2404" class="edge">
<title>kv_send2_11_10&#45;&gt;ring_stage2_12_11</title>
<path fill="none" stroke="black" d="M11096,-8296.45C11096,-8288.41 11096,-8279.43 11096,-8270.87"/>
<polygon fill="black" stroke="black" points="11099.5,-8270.74 11096,-8260.74 11092.5,-8270.74 11099.5,-8270.74"/>
</g>
<!-- kv_send2_11_11&#45;&gt;ring_stage2_12_12 -->
<g id="edge2407" class="edge">
<title>kv_send2_11_11&#45;&gt;ring_stage2_12_12</title>
<path fill="none" stroke="black" d="M10854.7,-8206.71C10853.69,-8198.67 10852.57,-8189.69 10851.49,-8181.13"/>
<polygon fill="black" stroke="black" points="10854.94,-8180.48 10850.22,-8171 10847.99,-8181.35 10854.94,-8180.48"/>
</g>
<!-- kv_send2_11_12&#45;&gt;ring_stage2_12_13 -->
<g id="edge2410" class="edge">
<title>kv_send2_11_12&#45;&gt;ring_stage2_12_13</title>
<path fill="none" stroke="black" d="M10615.3,-8116.97C10614.48,-8108.93 10613.55,-8099.95 10612.68,-8091.39"/>
<polygon fill="black" stroke="black" points="10616.14,-8090.85 10611.64,-8081.26 10609.18,-8091.56 10616.14,-8090.85"/>
</g>
<!-- kv_send2_11_13&#45;&gt;ring_stage2_12_14 -->
<g id="edge2413" class="edge">
<title>kv_send2_11_13&#45;&gt;ring_stage2_12_14</title>
<path fill="none" stroke="black" d="M10370.87,-8027.7C10367.9,-8019.31 10364.56,-8009.86 10361.4,-8000.91"/>
<polygon fill="black" stroke="black" points="10364.7,-7999.74 10358.07,-7991.48 10358.1,-8002.07 10364.7,-7999.74"/>
</g>
<!-- kv_send2_11_14&#45;&gt;ring_stage2_12_15 -->
<g id="edge2416" class="edge">
<title>kv_send2_11_14&#45;&gt;ring_stage2_12_15</title>
<path fill="none" stroke="black" d="M10049.48,-7944.23C10007.19,-7932.49 9952.7,-7917.36 9905.8,-7904.34"/>
<polygon fill="black" stroke="black" points="9906.49,-7900.9 9895.92,-7901.6 9904.62,-7907.64 9906.49,-7900.9"/>
</g>
<!-- kv_send2_11_15&#45;&gt;ring_stage2_12_0 -->
<g id="edge2371" class="edge">
<title>kv_send2_11_15&#45;&gt;ring_stage2_12_0</title>
<path fill="none" stroke="black" d="M9128,-7847.95C9128,-7832.51 9128,-7812.74 9128,-7795.87"/>
<polygon fill="black" stroke="black" points="9131.5,-7795.81 9128,-7785.81 9124.5,-7795.81 9131.5,-7795.81"/>
</g>
<!-- kv_send2_12_0 -->
<g id="node1699" class="node">
<title>kv_send2_12_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8686" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8686" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="8686" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_12_0&#45;&gt;kv_send2_12_0 -->
<g id="edge2372" class="edge">
<title>ring_stage2_12_0&#45;&gt;kv_send2_12_0</title>
<path fill="none" stroke="black" d="M9083.32,-7732.61C9064.85,-7723.02 9042.9,-7712.85 9022,-7706.2 8925.9,-7675.66 8894.42,-7699.71 8798,-7670.2 8777.92,-7664.06 8756.81,-7655 8738.4,-7646.16"/>
<polygon fill="black" stroke="black" points="8739.83,-7642.97 8729.31,-7641.72 8736.76,-7649.26 8739.83,-7642.97"/>
</g>
<!-- ring_stage2_13_0 -->
<g id="node1715" class="node">
<title>ring_stage2_13_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9660.5,-7643.7 9467.5,-7643.7 9467.5,-7590.7 9660.5,-7590.7 9660.5,-7643.7"/>
<text text-anchor="middle" x="9564" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="9564" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_3×V_3</text>
<text text-anchor="middle" x="9564" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_12_0&#45;&gt;ring_stage2_13_0 -->
<g id="edge2418" class="edge">
<title>ring_stage2_12_0&#45;&gt;ring_stage2_13_0</title>
<path fill="none" stroke="black" d="M9172.68,-7732.61C9191.15,-7723.02 9213.1,-7712.85 9234,-7706.2 9330.1,-7675.66 9361.9,-7700.74 9458,-7670.2 9475.47,-7664.65 9493.68,-7656.63 9509.97,-7648.54"/>
<polygon fill="black" stroke="black" points="9511.99,-7651.44 9519.32,-7643.79 9508.82,-7645.2 9511.99,-7651.44"/>
</g>
<!-- kv_send2_12_1 -->
<g id="node1700" class="node">
<title>kv_send2_12_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8481" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8481" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8481" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_12_1&#45;&gt;kv_send2_12_1 -->
<g id="edge2375" class="edge">
<title>ring_stage2_12_1&#45;&gt;kv_send2_12_1</title>
<path fill="none" stroke="black" d="M8470.38,-7590.53C8472.42,-7568.56 8475.38,-7536.71 8477.66,-7512.2"/>
<polygon fill="black" stroke="black" points="8481.15,-7512.47 8478.59,-7502.19 8474.18,-7511.83 8481.15,-7512.47"/>
</g>
<!-- ring_stage2_13_1 -->
<g id="node1716" class="node">
<title>ring_stage2_13_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8795.5,-7501.7 8602.5,-7501.7 8602.5,-7448.7 8795.5,-7448.7 8795.5,-7501.7"/>
<text text-anchor="middle" x="8699" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="8699" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_4×V_4</text>
<text text-anchor="middle" x="8699" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_12_1&#45;&gt;ring_stage2_13_1 -->
<g id="edge2421" class="edge">
<title>ring_stage2_12_1&#45;&gt;ring_stage2_13_1</title>
<path fill="none" stroke="black" d="M8510.1,-7590.69C8548.98,-7567.13 8606.8,-7532.08 8648.22,-7506.98"/>
<polygon fill="black" stroke="black" points="8650.06,-7509.96 8656.8,-7501.78 8646.43,-7503.97 8650.06,-7509.96"/>
</g>
<!-- kv_send2_12_2 -->
<g id="node1701" class="node">
<title>kv_send2_12_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8736" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8736" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8736" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_12_2&#45;&gt;kv_send2_12_2 -->
<g id="edge2378" class="edge">
<title>ring_stage2_12_2&#45;&gt;kv_send2_12_2</title>
<path fill="none" stroke="black" d="M8081.62,-7448.67C8100.41,-7438.65 8123.14,-7428.15 8145,-7422.2 8351.01,-7366.18 8417.41,-7440.02 8624,-7386.2 8644.95,-7380.75 8666.8,-7371.5 8685.57,-7362.31"/>
<polygon fill="black" stroke="black" points="8687.16,-7365.43 8694.53,-7357.82 8684.02,-7359.17 8687.16,-7365.43"/>
</g>
<!-- ring_stage2_13_2 -->
<g id="node1717" class="node">
<title>ring_stage2_13_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8390.5,-7359.7 8197.5,-7359.7 8197.5,-7306.7 8390.5,-7306.7 8390.5,-7359.7"/>
<text text-anchor="middle" x="8294" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="8294" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_5×V_5</text>
<text text-anchor="middle" x="8294" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_12_2&#45;&gt;ring_stage2_13_2 -->
<g id="edge2424" class="edge">
<title>ring_stage2_12_2&#45;&gt;ring_stage2_13_2</title>
<path fill="none" stroke="black" d="M8085.47,-7448.69C8128.57,-7425.03 8192.75,-7389.79 8238.52,-7364.66"/>
<polygon fill="black" stroke="black" points="8240.33,-7367.66 8247.41,-7359.78 8236.96,-7361.52 8240.33,-7367.66"/>
</g>
<!-- kv_send2_12_3 -->
<g id="node1702" class="node">
<title>kv_send2_12_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9259" cy="-7191.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9259" y="-7195" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9259" y="-7180" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_12_3&#45;&gt;kv_send2_12_3 -->
<g id="edge2381" class="edge">
<title>ring_stage2_12_3&#45;&gt;kv_send2_12_3</title>
<path fill="none" stroke="black" d="M9004.66,-7306.59C9022.09,-7297.98 9041.8,-7288.47 9060,-7280.2 9097.73,-7263.07 9108.06,-7260.87 9146,-7244.2 9163.93,-7236.33 9183.35,-7227.5 9200.94,-7219.39"/>
<polygon fill="black" stroke="black" points="9202.89,-7222.35 9210.5,-7214.97 9199.95,-7215.99 9202.89,-7222.35"/>
</g>
<!-- ring_stage2_13_3 -->
<g id="node1718" class="node">
<title>ring_stage2_13_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8871.5,-7217.7 8678.5,-7217.7 8678.5,-7164.7 8871.5,-7164.7 8871.5,-7217.7"/>
<text text-anchor="middle" x="8775" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="8775" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_6×V_6</text>
<text text-anchor="middle" x="8775" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_12_3&#45;&gt;ring_stage2_13_3 -->
<g id="edge2427" class="edge">
<title>ring_stage2_12_3&#45;&gt;ring_stage2_13_3</title>
<path fill="none" stroke="black" d="M8921.17,-7306.53C8891.52,-7283.34 8847.78,-7249.13 8815.87,-7224.17"/>
<polygon fill="black" stroke="black" points="8817.66,-7221.12 8807.62,-7217.72 8813.34,-7226.64 8817.66,-7221.12"/>
</g>
<!-- kv_send2_12_4 -->
<g id="node1703" class="node">
<title>kv_send2_12_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9860" cy="-7049.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9860" y="-7053" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9860" y="-7038" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_12_4&#45;&gt;kv_send2_12_4 -->
<g id="edge2384" class="edge">
<title>ring_stage2_12_4&#45;&gt;kv_send2_12_4</title>
<path fill="none" stroke="black" d="M9525.39,-7164.58C9543.24,-7155.64 9563.79,-7145.92 9583,-7138.2 9648.26,-7112 9724.57,-7088.24 9780.55,-7072.04"/>
<polygon fill="black" stroke="black" points="9781.77,-7075.33 9790.41,-7069.2 9779.83,-7068.6 9781.77,-7075.33"/>
</g>
<!-- ring_stage2_13_4 -->
<g id="node1719" class="node">
<title>ring_stage2_13_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9628.5,-7075.7 9435.5,-7075.7 9435.5,-7022.7 9628.5,-7022.7 9628.5,-7075.7"/>
<text text-anchor="middle" x="9532" y="-7060.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="9532" y="-7045.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_7×V_7</text>
<text text-anchor="middle" x="9532" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_12_4&#45;&gt;ring_stage2_13_4 -->
<g id="edge2430" class="edge">
<title>ring_stage2_12_4&#45;&gt;ring_stage2_13_4</title>
<path fill="none" stroke="black" d="M9487.09,-7164.53C9495.85,-7142.23 9508.61,-7109.73 9518.3,-7085.08"/>
<polygon fill="black" stroke="black" points="9521.58,-7086.31 9521.98,-7075.72 9515.06,-7083.75 9521.58,-7086.31"/>
</g>
<!-- kv_send2_12_5 -->
<g id="node1704" class="node">
<title>kv_send2_12_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10624" cy="-6907.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10624" y="-6911" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10624" y="-6896" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_12_5&#45;&gt;kv_send2_12_5 -->
<g id="edge2387" class="edge">
<title>ring_stage2_12_5&#45;&gt;kv_send2_12_5</title>
<path fill="none" stroke="black" d="M10221.82,-7022.62C10251.17,-7014.19 10283.98,-7004.78 10314,-6996.2 10393.02,-6973.64 10483.42,-6947.99 10546.13,-6930.24"/>
<polygon fill="black" stroke="black" points="10547.28,-6933.55 10555.95,-6927.45 10545.37,-6926.81 10547.28,-6933.55"/>
</g>
<!-- ring_stage2_13_5 -->
<g id="node1720" class="node">
<title>ring_stage2_13_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10229.5,-6933.7 10036.5,-6933.7 10036.5,-6880.7 10229.5,-6880.7 10229.5,-6933.7"/>
<text text-anchor="middle" x="10133" y="-6918.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="10133" y="-6903.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_8×V_8</text>
<text text-anchor="middle" x="10133" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_12_5&#45;&gt;ring_stage2_13_5 -->
<g id="edge2433" class="edge">
<title>ring_stage2_12_5&#45;&gt;ring_stage2_13_5</title>
<path fill="none" stroke="black" d="M10133,-7022.53C10133,-7000.42 10133,-6968.3 10133,-6943.73"/>
<polygon fill="black" stroke="black" points="10136.5,-6943.72 10133,-6933.72 10129.5,-6943.72 10136.5,-6943.72"/>
</g>
<!-- kv_send2_12_6 -->
<g id="node1705" class="node">
<title>kv_send2_12_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10950" cy="-6765.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10950" y="-6769" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10950" y="-6754" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_12_6&#45;&gt;kv_send2_12_6 -->
<g id="edge2390" class="edge">
<title>ring_stage2_12_6&#45;&gt;kv_send2_12_6</title>
<path fill="none" stroke="black" d="M10869.16,-6880.53C10885.14,-6857.93 10908.52,-6824.87 10926.03,-6800.1"/>
<polygon fill="black" stroke="black" points="10929.04,-6801.9 10931.96,-6791.72 10923.33,-6797.86 10929.04,-6801.9"/>
</g>
<!-- ring_stage2_13_6 -->
<g id="node1721" class="node">
<title>ring_stage2_13_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10773.5,-6791.7 10580.5,-6791.7 10580.5,-6738.7 10773.5,-6738.7 10773.5,-6791.7"/>
<text text-anchor="middle" x="10677" y="-6776.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="10677" y="-6761.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_9×V_9</text>
<text text-anchor="middle" x="10677" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_12_6&#45;&gt;ring_stage2_13_6 -->
<g id="edge2436" class="edge">
<title>ring_stage2_12_6&#45;&gt;ring_stage2_13_6</title>
<path fill="none" stroke="black" d="M10819.09,-6880.53C10790.27,-6857.34 10747.75,-6823.13 10716.73,-6798.17"/>
<polygon fill="black" stroke="black" points="10718.7,-6795.26 10708.71,-6791.72 10714.31,-6800.71 10718.7,-6795.26"/>
</g>
<!-- kv_send2_12_7 -->
<g id="node1706" class="node">
<title>kv_send2_12_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11342" cy="-6623.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11342" y="-6627" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11342" y="-6612" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_12_7&#45;&gt;kv_send2_12_7 -->
<g id="edge2393" class="edge">
<title>ring_stage2_12_7&#45;&gt;kv_send2_12_7</title>
<path fill="none" stroke="black" d="M11306.07,-6738.53C11313,-6716.46 11323.07,-6684.42 11330.79,-6659.87"/>
<polygon fill="black" stroke="black" points="11334.17,-6660.78 11333.83,-6650.19 11327.49,-6658.68 11334.17,-6660.78"/>
</g>
<!-- ring_stage2_13_7 -->
<g id="node1722" class="node">
<title>ring_stage2_13_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11173.5,-6649.7 10962.5,-6649.7 10962.5,-6596.7 11173.5,-6596.7 11173.5,-6649.7"/>
<text text-anchor="middle" x="11068" y="-6634.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11068" y="-6619.5" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_10×V_10</text>
<text text-anchor="middle" x="11068" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_12_7&#45;&gt;ring_stage2_13_7 -->
<g id="edge2439" class="edge">
<title>ring_stage2_12_7&#45;&gt;ring_stage2_13_7</title>
<path fill="none" stroke="black" d="M11256.08,-6738.69C11217.45,-6715.18 11160.04,-6680.23 11118.82,-6655.14"/>
<polygon fill="black" stroke="black" points="11120.38,-6651.99 11110.02,-6649.78 11116.74,-6657.97 11120.38,-6651.99"/>
</g>
<!-- kv_send2_12_8 -->
<g id="node1707" class="node">
<title>kv_send2_12_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11539" cy="-6481.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11539" y="-6485" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11539" y="-6470" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_12_8&#45;&gt;kv_send2_12_8 -->
<g id="edge2396" class="edge">
<title>ring_stage2_12_8&#45;&gt;kv_send2_12_8</title>
<path fill="none" stroke="black" d="M11605.96,-6596.53C11592.87,-6574.17 11573.77,-6541.56 11559.32,-6516.89"/>
<polygon fill="black" stroke="black" points="11562.3,-6515.05 11554.22,-6508.19 11556.26,-6518.59 11562.3,-6515.05"/>
</g>
<!-- ring_stage2_13_8 -->
<g id="node1723" class="node">
<title>ring_stage2_13_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11871.5,-6507.7 11660.5,-6507.7 11660.5,-6454.7 11871.5,-6454.7 11871.5,-6507.7"/>
<text text-anchor="middle" x="11766" y="-6492.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11766" y="-6477.5" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_11×V_11</text>
<text text-anchor="middle" x="11766" y="-6462.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_12_8&#45;&gt;ring_stage2_13_8 -->
<g id="edge2442" class="edge">
<title>ring_stage2_12_8&#45;&gt;ring_stage2_13_8</title>
<path fill="none" stroke="black" d="M11647.6,-6596.53C11671.41,-6573.53 11706.44,-6539.71 11732.23,-6514.81"/>
<polygon fill="black" stroke="black" points="11734.81,-6517.18 11739.57,-6507.72 11729.95,-6512.15 11734.81,-6517.18"/>
</g>
<!-- kv_send2_12_9 -->
<g id="node1708" class="node">
<title>kv_send2_12_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11572" cy="-8323.77" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11572" y="-8327.57" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="11572" y="-8312.57" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_12_9&#45;&gt;kv_send2_12_9 -->
<g id="edge2399" class="edge">
<title>ring_stage2_12_9&#45;&gt;kv_send2_12_9</title>
<path fill="none" stroke="black" d="M11588.93,-8386.66C11586.68,-8378.44 11584.15,-8369.19 11581.74,-8360.4"/>
<polygon fill="black" stroke="black" points="11585.12,-8359.47 11579.1,-8350.74 11578.37,-8361.31 11585.12,-8359.47"/>
</g>
<!-- ring_stage2_13_9 -->
<g id="node1724" class="node">
<title>ring_stage2_13_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11416.5,-6365.7 11205.5,-6365.7 11205.5,-6312.7 11416.5,-6312.7 11416.5,-6365.7"/>
<text text-anchor="middle" x="11311" y="-6350.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11311" y="-6335.5" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_12×V_12</text>
<text text-anchor="middle" x="11311" y="-6320.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_12_9&#45;&gt;ring_stage2_13_9 -->
<g id="edge2445" class="edge">
<title>ring_stage2_12_9&#45;&gt;ring_stage2_13_9</title>
<path fill="none" stroke="black" d="M11651.68,-8386.83C11666.57,-8377.44 11681.21,-8365.41 11691,-8350.64 11753.67,-8256.1 11725.86,-7947.33 11781,-7848.2 11792.63,-7827.3 11811.27,-7834.05 11821,-7812.2 11832.21,-7787.03 11831.89,-7589.52 11821,-7564.2 11775.52,-7458.51 11683.3,-7489.69 11633,-7386.2 11594.96,-7307.92 11658.71,-7057.58 11597,-6996.2 11531.53,-6931.08 11245.41,-7028.27 11183,-6960.2 11151.16,-6925.48 11182.83,-6901.31 11183,-6854.2 11183.17,-6806.82 11181.25,-6470.3 11203,-6428.2 11214.91,-6405.16 11235.78,-6385.99 11256.03,-6371.48"/>
<polygon fill="black" stroke="black" points="11258.09,-6374.31 11264.34,-6365.75 11254.12,-6368.54 11258.09,-6374.31"/>
</g>
<!-- kv_send2_12_10 -->
<g id="node1709" class="node">
<title>kv_send2_12_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11334" cy="-8234.03" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11334" y="-8237.83" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="11334" y="-8222.83" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_12_10&#45;&gt;kv_send2_12_10 -->
<g id="edge2402" class="edge">
<title>ring_stage2_12_10&#45;&gt;kv_send2_12_10</title>
<path fill="none" stroke="black" d="M11334,-8296.92C11334,-8288.87 11334,-8279.84 11334,-8271.22"/>
<polygon fill="black" stroke="black" points="11337.5,-8271 11334,-8261 11330.5,-8271 11337.5,-8271"/>
</g>
<!-- ring_stage2_13_10 -->
<g id="node1725" class="node">
<title>ring_stage2_13_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11682,-8260.53 11462,-8260.53 11462,-8207.53 11682,-8207.53 11682,-8260.53"/>
<text text-anchor="middle" x="11572" y="-8245.33" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11572" y="-8230.33" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_13×V_13</text>
<text text-anchor="middle" x="11572" y="-8215.33" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_12_10&#45;&gt;ring_stage2_13_10 -->
<g id="edge2448" class="edge">
<title>ring_stage2_12_10&#45;&gt;ring_stage2_13_10</title>
<path fill="none" stroke="black" d="M11403.48,-8297.16C11431.46,-8286.84 11463.89,-8274.89 11492.78,-8264.24"/>
<polygon fill="black" stroke="black" points="11494.26,-8267.42 11502.43,-8260.68 11491.84,-8260.85 11494.26,-8267.42"/>
</g>
<!-- kv_send2_12_11 -->
<g id="node1710" class="node">
<title>kv_send2_12_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11076" cy="-8144.29" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11076" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="11076" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_12_11&#45;&gt;kv_send2_12_11 -->
<g id="edge2405" class="edge">
<title>ring_stage2_12_11&#45;&gt;kv_send2_12_11</title>
<path fill="none" stroke="black" d="M11090.11,-8207.18C11088.25,-8199.05 11086.17,-8189.91 11084.18,-8181.2"/>
<polygon fill="black" stroke="black" points="11087.55,-8180.23 11081.92,-8171.26 11080.73,-8181.79 11087.55,-8180.23"/>
</g>
<!-- ring_stage2_13_11 -->
<g id="node1726" class="node">
<title>ring_stage2_13_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11424,-8170.79 11204,-8170.79 11204,-8117.79 11424,-8117.79 11424,-8170.79"/>
<text text-anchor="middle" x="11314" y="-8155.59" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11314" y="-8140.59" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_14×V_14</text>
<text text-anchor="middle" x="11314" y="-8125.59" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_12_11&#45;&gt;ring_stage2_13_11 -->
<g id="edge2451" class="edge">
<title>ring_stage2_12_11&#45;&gt;ring_stage2_13_11</title>
<path fill="none" stroke="black" d="M11159.64,-8207.42C11185.05,-8197.19 11214.46,-8185.36 11240.75,-8174.78"/>
<polygon fill="black" stroke="black" points="11242.31,-8177.92 11250.28,-8170.94 11239.7,-8171.43 11242.31,-8177.92"/>
</g>
<!-- kv_send2_12_12 -->
<g id="node1711" class="node">
<title>kv_send2_12_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10838" cy="-8054.55" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10838" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="10838" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_12_12&#45;&gt;kv_send2_12_12 -->
<g id="edge2408" class="edge">
<title>ring_stage2_12_12&#45;&gt;kv_send2_12_12</title>
<path fill="none" stroke="black" d="M10844.35,-8117.44C10843.52,-8109.39 10842.6,-8100.36 10841.71,-8091.74"/>
<polygon fill="black" stroke="black" points="10845.17,-8091.11 10840.66,-8081.52 10838.2,-8091.83 10845.17,-8091.11"/>
</g>
<!-- ring_stage2_13_12 -->
<g id="node1727" class="node">
<title>ring_stage2_13_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11186,-8081.05 10966,-8081.05 10966,-8028.05 11186,-8028.05 11186,-8081.05"/>
<text text-anchor="middle" x="11076" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="11076" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_15×V_15</text>
<text text-anchor="middle" x="11076" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_12_12&#45;&gt;ring_stage2_13_12 -->
<g id="edge2454" class="edge">
<title>ring_stage2_12_12&#45;&gt;ring_stage2_13_12</title>
<path fill="none" stroke="black" d="M10913.85,-8117.68C10940.66,-8107.41 10971.71,-8095.51 10999.42,-8084.9"/>
<polygon fill="black" stroke="black" points="11000.98,-8088.05 11009.07,-8081.2 10998.47,-8081.51 11000.98,-8088.05"/>
</g>
<!-- kv_send2_12_13 -->
<g id="node1712" class="node">
<title>kv_send2_12_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10578" cy="-7964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10578" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="10578" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_12_13&#45;&gt;kv_send2_12_13 -->
<g id="edge2411" class="edge">
<title>ring_stage2_12_13&#45;&gt;kv_send2_12_13</title>
<path fill="none" stroke="black" d="M10599.87,-8027.7C10596.96,-8019.48 10593.69,-8010.23 10590.59,-8001.43"/>
<polygon fill="black" stroke="black" points="10593.81,-8000.05 10587.18,-7991.78 10587.21,-8002.38 10593.81,-8000.05"/>
</g>
<!-- ring_stage2_13_13 -->
<g id="node1728" class="node">
<title>ring_stage2_13_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10908,-7991.31 10706,-7991.31 10706,-7938.31 10908,-7938.31 10908,-7991.31"/>
<text text-anchor="middle" x="10807" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="10807" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_0×V_0</text>
<text text-anchor="middle" x="10807" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_12_13&#45;&gt;ring_stage2_13_13 -->
<g id="edge2457" class="edge">
<title>ring_stage2_12_13&#45;&gt;ring_stage2_13_13</title>
<path fill="none" stroke="black" d="M10666.8,-8027.94C10689.68,-8017.8 10716.12,-8006.08 10739.84,-7995.57"/>
<polygon fill="black" stroke="black" points="10741.4,-7998.71 10749.13,-7991.46 10738.57,-7992.31 10741.4,-7998.71"/>
</g>
<!-- kv_send2_12_14 -->
<g id="node1713" class="node">
<title>kv_send2_12_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10278" cy="-7875.07" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10278" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="10278" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_12_14&#45;&gt;kv_send2_12_14 -->
<g id="edge2414" class="edge">
<title>ring_stage2_12_14&#45;&gt;kv_send2_12_14</title>
<path fill="none" stroke="black" d="M10328.08,-7937.96C10320.93,-7929.13 10312.83,-7919.11 10305.25,-7909.75"/>
<polygon fill="black" stroke="black" points="10307.78,-7907.31 10298.77,-7901.74 10302.34,-7911.71 10307.78,-7907.31"/>
</g>
<!-- ring_stage2_13_14 -->
<g id="node1729" class="node">
<title>ring_stage2_13_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10618,-7901.57 10416,-7901.57 10416,-7848.57 10618,-7848.57 10618,-7901.57"/>
<text text-anchor="middle" x="10517" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="10517" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_1×V_1</text>
<text text-anchor="middle" x="10517" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_12_14&#45;&gt;ring_stage2_13_14 -->
<g id="edge2460" class="edge">
<title>ring_stage2_12_14&#45;&gt;ring_stage2_13_14</title>
<path fill="none" stroke="black" d="M10398.04,-7938.2C10417.11,-7928.24 10439.1,-7916.76 10458.95,-7906.39"/>
<polygon fill="black" stroke="black" points="10460.65,-7909.45 10467.89,-7901.72 10457.41,-7903.25 10460.65,-7909.45"/>
</g>
<!-- kv_send2_12_15 -->
<g id="node1714" class="node">
<title>kv_send2_12_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9799" cy="-7759.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9799" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="9799" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_12_15&#45;&gt;kv_send2_12_15 -->
<g id="edge2417" class="edge">
<title>ring_stage2_12_15&#45;&gt;kv_send2_12_15</title>
<path fill="none" stroke="black" d="M9802.88,-7848.52C9802.21,-7833.21 9801.34,-7813.49 9800.6,-7796.57"/>
<polygon fill="black" stroke="black" points="9804.09,-7796.3 9800.15,-7786.46 9797.1,-7796.61 9804.09,-7796.3"/>
</g>
<!-- ring_stage2_13_15 -->
<g id="node1730" class="node">
<title>ring_stage2_13_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10352,-7785.7 10150,-7785.7 10150,-7732.7 10352,-7732.7 10352,-7785.7"/>
<text text-anchor="middle" x="10251" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="10251" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_2×V_2</text>
<text text-anchor="middle" x="10251" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_12_15&#45;&gt;ring_stage2_13_15 -->
<g id="edge2463" class="edge">
<title>ring_stage2_12_15&#45;&gt;ring_stage2_13_15</title>
<path fill="none" stroke="black" d="M9905.23,-7849.97C9908.19,-7849.36 9911.11,-7848.77 9914,-7848.2 10014.23,-7828.5 10043.4,-7842.34 10141,-7812.2 10159.22,-7806.58 10178.27,-7798.45 10195.3,-7790.29"/>
<polygon fill="black" stroke="black" points="10197.09,-7793.31 10204.53,-7785.77 10194.01,-7787.02 10197.09,-7793.31"/>
</g>
<!-- kv_send2_12_0&#45;&gt;ring_stage2_13_1 -->
<g id="edge2422" class="edge">
<title>kv_send2_12_0&#45;&gt;ring_stage2_13_1</title>
<path fill="none" stroke="black" d="M8688.41,-7590.2C8690.46,-7568.2 8693.41,-7536.44 8695.67,-7512.03"/>
<polygon fill="black" stroke="black" points="8699.16,-7512.35 8696.6,-7502.07 8692.19,-7511.7 8699.16,-7512.35"/>
</g>
<!-- kv_send2_12_1&#45;&gt;ring_stage2_13_2 -->
<g id="edge2425" class="edge">
<title>kv_send2_12_1&#45;&gt;ring_stage2_13_2</title>
<path fill="none" stroke="black" d="M8448,-7449.5C8416.97,-7426.27 8370.37,-7391.38 8336.55,-7366.06"/>
<polygon fill="black" stroke="black" points="8338.35,-7363.04 8328.25,-7359.85 8334.16,-7368.64 8338.35,-7363.04"/>
</g>
<!-- kv_send2_12_2&#45;&gt;ring_stage2_13_3 -->
<g id="edge2428" class="edge">
<title>kv_send2_12_2&#45;&gt;ring_stage2_13_3</title>
<path fill="none" stroke="black" d="M8743.24,-7306.2C8749.4,-7284.1 8758.3,-7252.16 8765.11,-7227.7"/>
<polygon fill="black" stroke="black" points="8768.48,-7228.64 8767.79,-7218.07 8761.74,-7226.76 8768.48,-7228.64"/>
</g>
<!-- kv_send2_12_3&#45;&gt;ring_stage2_13_4 -->
<g id="edge2431" class="edge">
<title>kv_send2_12_3&#45;&gt;ring_stage2_13_4</title>
<path fill="none" stroke="black" d="M9304.39,-7166.93C9350.49,-7143.29 9422.11,-7106.56 9472.68,-7080.62"/>
<polygon fill="black" stroke="black" points="9474.57,-7083.59 9481.87,-7075.91 9471.38,-7077.36 9474.57,-7083.59"/>
</g>
<!-- kv_send2_12_4&#45;&gt;ring_stage2_13_5 -->
<g id="edge2434" class="edge">
<title>kv_send2_12_4&#45;&gt;ring_stage2_13_5</title>
<path fill="none" stroke="black" d="M9905.39,-7024.93C9951.49,-7001.29 10023.11,-6964.56 10073.68,-6938.62"/>
<polygon fill="black" stroke="black" points="10075.57,-6941.59 10082.87,-6933.91 10072.38,-6935.36 10075.57,-6941.59"/>
</g>
<!-- kv_send2_12_5&#45;&gt;ring_stage2_13_6 -->
<g id="edge2437" class="edge">
<title>kv_send2_12_5&#45;&gt;ring_stage2_13_6</title>
<path fill="none" stroke="black" d="M10633.84,-6880.2C10642.21,-6858.1 10654.3,-6826.16 10663.56,-6801.7"/>
<polygon fill="black" stroke="black" points="10666.94,-6802.66 10667.21,-6792.07 10660.39,-6800.18 10666.94,-6802.66"/>
</g>
<!-- kv_send2_12_6&#45;&gt;ring_stage2_13_7 -->
<g id="edge2440" class="edge">
<title>kv_send2_12_6&#45;&gt;ring_stage2_13_7</title>
<path fill="none" stroke="black" d="M10971.37,-6738.85C10990.55,-6716.1 11018.83,-6682.54 11039.84,-6657.61"/>
<polygon fill="black" stroke="black" points="11042.62,-6659.74 11046.39,-6649.84 11037.27,-6655.23 11042.62,-6659.74"/>
</g>
<!-- kv_send2_12_7&#45;&gt;ring_stage2_13_8 -->
<g id="edge2443" class="edge">
<title>kv_send2_12_7&#45;&gt;ring_stage2_13_8</title>
<path fill="none" stroke="black" d="M11404.02,-6601.68C11434.85,-6591.73 11472.75,-6579.87 11507,-6570.2 11570.49,-6552.28 11588.69,-6555.88 11651,-6534.2 11668.99,-6527.95 11688.01,-6519.94 11705.3,-6512.1"/>
<polygon fill="black" stroke="black" points="11707.09,-6515.14 11714.71,-6507.78 11704.16,-6508.78 11707.09,-6515.14"/>
</g>
<!-- kv_send2_12_8&#45;&gt;ring_stage2_13_9 -->
<g id="edge2446" class="edge">
<title>kv_send2_12_8&#45;&gt;ring_stage2_13_9</title>
<path fill="none" stroke="black" d="M11500.06,-6456.3C11461.83,-6432.82 11403.32,-6396.89 11361.52,-6371.22"/>
<polygon fill="black" stroke="black" points="11363.22,-6368.16 11352.87,-6365.91 11359.56,-6374.13 11363.22,-6368.16"/>
</g>
<!-- kv_send2_12_9&#45;&gt;ring_stage2_13_10 -->
<g id="edge2449" class="edge">
<title>kv_send2_12_9&#45;&gt;ring_stage2_13_10</title>
<path fill="none" stroke="black" d="M11572,-8296.45C11572,-8288.41 11572,-8279.43 11572,-8270.87"/>
<polygon fill="black" stroke="black" points="11575.5,-8270.74 11572,-8260.74 11568.5,-8270.74 11575.5,-8270.74"/>
</g>
<!-- kv_send2_12_10&#45;&gt;ring_stage2_13_11 -->
<g id="edge2452" class="edge">
<title>kv_send2_12_10&#45;&gt;ring_stage2_13_11</title>
<path fill="none" stroke="black" d="M11328.11,-8207.18C11326.24,-8198.97 11324.13,-8189.74 11322.13,-8180.97"/>
<polygon fill="black" stroke="black" points="11325.49,-8179.93 11319.85,-8170.96 11318.66,-8181.49 11325.49,-8179.93"/>
</g>
<!-- kv_send2_12_11&#45;&gt;ring_stage2_13_12 -->
<g id="edge2455" class="edge">
<title>kv_send2_12_11&#45;&gt;ring_stage2_13_12</title>
<path fill="none" stroke="black" d="M11076,-8116.97C11076,-8108.93 11076,-8099.95 11076,-8091.39"/>
<polygon fill="black" stroke="black" points="11079.5,-8091.26 11076,-8081.26 11072.5,-8091.26 11079.5,-8091.26"/>
</g>
<!-- kv_send2_12_12&#45;&gt;ring_stage2_13_13 -->
<g id="edge2458" class="edge">
<title>kv_send2_12_12&#45;&gt;ring_stage2_13_13</title>
<path fill="none" stroke="black" d="M10828.87,-8027.7C10825.9,-8019.31 10822.56,-8009.86 10819.4,-8000.91"/>
<polygon fill="black" stroke="black" points="10822.7,-7999.74 10816.07,-7991.48 10816.1,-8002.07 10822.7,-7999.74"/>
</g>
<!-- kv_send2_12_13&#45;&gt;ring_stage2_13_14 -->
<g id="edge2461" class="edge">
<title>kv_send2_12_13&#45;&gt;ring_stage2_13_14</title>
<path fill="none" stroke="black" d="M10560.03,-7937.96C10553.95,-7929.22 10547.06,-7919.31 10540.61,-7910.03"/>
<polygon fill="black" stroke="black" points="10543.43,-7907.95 10534.84,-7901.74 10537.68,-7911.95 10543.43,-7907.95"/>
</g>
<!-- kv_send2_12_14&#45;&gt;ring_stage2_13_15 -->
<g id="edge2464" class="edge">
<title>kv_send2_12_14&#45;&gt;ring_stage2_13_15</title>
<path fill="none" stroke="black" d="M10271.87,-7848.23C10268.21,-7832.8 10263.51,-7812.97 10259.5,-7796.04"/>
<polygon fill="black" stroke="black" points="10262.82,-7794.86 10257.1,-7785.94 10256,-7796.48 10262.82,-7794.86"/>
</g>
<!-- kv_send2_12_15&#45;&gt;ring_stage2_13_0 -->
<g id="edge2419" class="edge">
<title>kv_send2_12_15&#45;&gt;ring_stage2_13_0</title>
<path fill="none" stroke="black" d="M9758.87,-7734.3C9719.38,-7710.77 9658.9,-7674.74 9615.8,-7649.06"/>
<polygon fill="black" stroke="black" points="9617.53,-7646.02 9607.15,-7643.91 9613.95,-7652.04 9617.53,-7646.02"/>
</g>
<!-- kv_send2_13_0 -->
<g id="node1731" class="node">
<title>kv_send2_13_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9163" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9163" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="9163" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_13_0&#45;&gt;kv_send2_13_0 -->
<g id="edge2420" class="edge">
<title>ring_stage2_13_0&#45;&gt;kv_send2_13_0</title>
<path fill="none" stroke="black" d="M9518.42,-7590.58C9500.1,-7581.16 9478.49,-7571.11 9458,-7564.2 9379.45,-7537.72 9353.83,-7553.84 9275,-7528.2 9255.21,-7521.77 9234.31,-7512.73 9216.01,-7503.99"/>
<polygon fill="black" stroke="black" points="9217.49,-7500.82 9206.97,-7499.61 9214.43,-7507.12 9217.49,-7500.82"/>
</g>
<!-- ring_stage2_14_0 -->
<g id="node1747" class="node">
<title>ring_stage2_14_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10155.5,-7501.7 9962.5,-7501.7 9962.5,-7448.7 10155.5,-7448.7 10155.5,-7501.7"/>
<text text-anchor="middle" x="10059" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10059" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_2×V_2</text>
<text text-anchor="middle" x="10059" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_13_0&#45;&gt;ring_stage2_14_0 -->
<g id="edge2466" class="edge">
<title>ring_stage2_13_0&#45;&gt;ring_stage2_14_0</title>
<path fill="none" stroke="black" d="M9607.8,-7590.67C9626.41,-7580.9 9648.7,-7570.59 9670,-7564.2 9791.45,-7527.79 9831.55,-7564.62 9953,-7528.2 9970.97,-7522.81 9989.65,-7514.63 10006.22,-7506.34"/>
<polygon fill="black" stroke="black" points="10007.9,-7509.41 10015.2,-7501.74 10004.7,-7503.18 10007.9,-7509.41"/>
</g>
<!-- kv_send2_13_1 -->
<g id="node1732" class="node">
<title>kv_send2_13_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8512" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8512" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="8512" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_13_1&#45;&gt;kv_send2_13_1 -->
<g id="edge2423" class="edge">
<title>ring_stage2_13_1&#45;&gt;kv_send2_13_1</title>
<path fill="none" stroke="black" d="M8664.7,-7448.53C8633.21,-7424.95 8586.49,-7389.97 8553.03,-7364.92"/>
<polygon fill="black" stroke="black" points="8554.93,-7361.97 8544.83,-7358.78 8550.73,-7367.57 8554.93,-7361.97"/>
</g>
<!-- ring_stage2_14_1 -->
<g id="node1748" class="node">
<title>ring_stage2_14_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9261.5,-7359.7 9068.5,-7359.7 9068.5,-7306.7 9261.5,-7306.7 9261.5,-7359.7"/>
<text text-anchor="middle" x="9165" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="9165" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_3×V_3</text>
<text text-anchor="middle" x="9165" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_13_1&#45;&gt;ring_stage2_14_1 -->
<g id="edge2469" class="edge">
<title>ring_stage2_13_1&#45;&gt;ring_stage2_14_1</title>
<path fill="none" stroke="black" d="M8760.3,-7448.69C8784.76,-7439.28 8813.38,-7429.22 8840,-7422.2 8935.81,-7396.95 8965.68,-7416.52 9060,-7386.2 9077.32,-7380.64 9095.36,-7372.61 9111.49,-7364.52"/>
<polygon fill="black" stroke="black" points="9113.45,-7367.45 9120.76,-7359.78 9110.26,-7361.22 9113.45,-7367.45"/>
</g>
<!-- kv_send2_13_2 -->
<g id="node1733" class="node">
<title>kv_send2_13_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8295" cy="-7191.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8295" y="-7195" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8295" y="-7180" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_13_2&#45;&gt;kv_send2_13_2 -->
<g id="edge2426" class="edge">
<title>ring_stage2_13_2&#45;&gt;kv_send2_13_2</title>
<path fill="none" stroke="black" d="M8294.18,-7306.53C8294.34,-7284.56 8294.57,-7252.71 8294.74,-7228.2"/>
<polygon fill="black" stroke="black" points="8298.24,-7228.22 8294.81,-7218.19 8291.24,-7228.17 8298.24,-7228.22"/>
</g>
<!-- ring_stage2_14_2 -->
<g id="node1749" class="node">
<title>ring_stage2_14_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8612.5,-7217.7 8419.5,-7217.7 8419.5,-7164.7 8612.5,-7164.7 8612.5,-7217.7"/>
<text text-anchor="middle" x="8516" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="8516" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_4×V_4</text>
<text text-anchor="middle" x="8516" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_13_2&#45;&gt;ring_stage2_14_2 -->
<g id="edge2472" class="edge">
<title>ring_stage2_13_2&#45;&gt;ring_stage2_14_2</title>
<path fill="none" stroke="black" d="M8334.46,-7306.69C8371.74,-7283.18 8427.16,-7248.23 8466.95,-7223.14"/>
<polygon fill="black" stroke="black" points="8468.85,-7226.07 8475.44,-7217.78 8465.12,-7220.15 8468.85,-7226.07"/>
</g>
<!-- kv_send2_13_3 -->
<g id="node1734" class="node">
<title>kv_send2_13_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9311" cy="-7049.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9311" y="-7053" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9311" y="-7038" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_13_3&#45;&gt;kv_send2_13_3 -->
<g id="edge2429" class="edge">
<title>ring_stage2_13_3&#45;&gt;kv_send2_13_3</title>
<path fill="none" stroke="black" d="M8839.37,-7164.66C8864.8,-7155.31 8894.47,-7145.29 8922,-7138.2 9017.1,-7113.73 9044.37,-7124.54 9140,-7102.2 9173.26,-7094.43 9209.54,-7083.73 9240.09,-7074.05"/>
<polygon fill="black" stroke="black" points="9241.33,-7077.33 9249.79,-7070.95 9239.2,-7070.66 9241.33,-7077.33"/>
</g>
<!-- ring_stage2_14_3 -->
<g id="node1750" class="node">
<title>ring_stage2_14_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8861.5,-7075.7 8668.5,-7075.7 8668.5,-7022.7 8861.5,-7022.7 8861.5,-7075.7"/>
<text text-anchor="middle" x="8765" y="-7060.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="8765" y="-7045.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_5×V_5</text>
<text text-anchor="middle" x="8765" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_13_3&#45;&gt;ring_stage2_14_3 -->
<g id="edge2475" class="edge">
<title>ring_stage2_13_3&#45;&gt;ring_stage2_14_3</title>
<path fill="none" stroke="black" d="M8773.17,-7164.53C8771.59,-7142.42 8769.29,-7110.3 8767.54,-7085.73"/>
<polygon fill="black" stroke="black" points="8771.03,-7085.44 8766.82,-7075.72 8764.04,-7085.94 8771.03,-7085.44"/>
</g>
<!-- kv_send2_13_4 -->
<g id="node1735" class="node">
<title>kv_send2_13_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9901" cy="-6907.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9901" y="-6911" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9901" y="-6896" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_13_4&#45;&gt;kv_send2_13_4 -->
<g id="edge2432" class="edge">
<title>ring_stage2_13_4&#45;&gt;kv_send2_13_4</title>
<path fill="none" stroke="black" d="M9605.15,-7022.66C9653.55,-7005.52 9718.3,-6982.16 9775,-6960.2 9795.96,-6952.09 9818.7,-6942.84 9839.03,-6934.41"/>
<polygon fill="black" stroke="black" points="9840.6,-6937.55 9848.49,-6930.48 9837.91,-6931.09 9840.6,-6937.55"/>
</g>
<!-- ring_stage2_14_4 -->
<g id="node1751" class="node">
<title>ring_stage2_14_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9765.5,-6933.7 9572.5,-6933.7 9572.5,-6880.7 9765.5,-6880.7 9765.5,-6933.7"/>
<text text-anchor="middle" x="9669" y="-6918.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="9669" y="-6903.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_6×V_6</text>
<text text-anchor="middle" x="9669" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_13_4&#45;&gt;ring_stage2_14_4 -->
<g id="edge2478" class="edge">
<title>ring_stage2_13_4&#45;&gt;ring_stage2_14_4</title>
<path fill="none" stroke="black" d="M9557.13,-7022.53C9579.53,-6999.63 9612.44,-6966 9636.78,-6941.13"/>
<polygon fill="black" stroke="black" points="9639.54,-6943.31 9644.03,-6933.72 9634.54,-6938.42 9639.54,-6943.31"/>
</g>
<!-- kv_send2_13_5 -->
<g id="node1736" class="node">
<title>kv_send2_13_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10380" cy="-6765.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10380" y="-6769" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10380" y="-6754" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_13_5&#45;&gt;kv_send2_13_5 -->
<g id="edge2435" class="edge">
<title>ring_stage2_13_5&#45;&gt;kv_send2_13_5</title>
<path fill="none" stroke="black" d="M10178.02,-6880.69C10220.71,-6856.49 10284.78,-6820.17 10329.27,-6794.96"/>
<polygon fill="black" stroke="black" points="10331.2,-6797.89 10338.17,-6789.91 10327.75,-6791.8 10331.2,-6797.89"/>
</g>
<!-- ring_stage2_14_5 -->
<g id="node1752" class="node">
<title>ring_stage2_14_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10229.5,-6791.7 10036.5,-6791.7 10036.5,-6738.7 10229.5,-6738.7 10229.5,-6791.7"/>
<text text-anchor="middle" x="10133" y="-6776.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10133" y="-6761.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_7×V_7</text>
<text text-anchor="middle" x="10133" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_13_5&#45;&gt;ring_stage2_14_5 -->
<g id="edge2481" class="edge">
<title>ring_stage2_13_5&#45;&gt;ring_stage2_14_5</title>
<path fill="none" stroke="black" d="M10133,-6880.53C10133,-6858.42 10133,-6826.3 10133,-6801.73"/>
<polygon fill="black" stroke="black" points="10136.5,-6801.72 10133,-6791.72 10129.5,-6801.72 10136.5,-6801.72"/>
</g>
<!-- kv_send2_13_6 -->
<g id="node1737" class="node">
<title>kv_send2_13_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10841" cy="-6623.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10841" y="-6627" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10841" y="-6612" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_13_6&#45;&gt;kv_send2_13_6 -->
<g id="edge2438" class="edge">
<title>ring_stage2_13_6&#45;&gt;kv_send2_13_6</title>
<path fill="none" stroke="black" d="M10707.08,-6738.53C10734.38,-6715.22 10774.73,-6680.78 10804,-6655.79"/>
<polygon fill="black" stroke="black" points="10806.6,-6658.17 10811.94,-6649.01 10802.06,-6652.84 10806.6,-6658.17"/>
</g>
<!-- ring_stage2_14_6 -->
<g id="node1753" class="node">
<title>ring_stage2_14_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10719.5,-6649.7 10526.5,-6649.7 10526.5,-6596.7 10719.5,-6596.7 10719.5,-6649.7"/>
<text text-anchor="middle" x="10623" y="-6634.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10623" y="-6619.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_8×V_8</text>
<text text-anchor="middle" x="10623" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_13_6&#45;&gt;ring_stage2_14_6 -->
<g id="edge2484" class="edge">
<title>ring_stage2_13_6&#45;&gt;ring_stage2_14_6</title>
<path fill="none" stroke="black" d="M10667.1,-6738.53C10658.49,-6716.23 10645.96,-6683.73 10636.45,-6659.08"/>
<polygon fill="black" stroke="black" points="10639.71,-6657.79 10632.84,-6649.72 10633.17,-6660.31 10639.71,-6657.79"/>
</g>
<!-- kv_send2_13_7 -->
<g id="node1738" class="node">
<title>kv_send2_13_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11315" cy="-6481.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11315" y="-6485" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11315" y="-6470" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_13_7&#45;&gt;kv_send2_13_7 -->
<g id="edge2441" class="edge">
<title>ring_stage2_13_7&#45;&gt;kv_send2_13_7</title>
<path fill="none" stroke="black" d="M11113.02,-6596.69C11155.71,-6572.49 11219.78,-6536.17 11264.27,-6510.96"/>
<polygon fill="black" stroke="black" points="11266.2,-6513.89 11273.17,-6505.91 11262.75,-6507.8 11266.2,-6513.89"/>
</g>
<!-- ring_stage2_14_7 -->
<g id="node1754" class="node">
<title>ring_stage2_14_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11117.5,-6507.7 10924.5,-6507.7 10924.5,-6454.7 11117.5,-6454.7 11117.5,-6507.7"/>
<text text-anchor="middle" x="11021" y="-6492.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="11021" y="-6477.5" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_9×V_9</text>
<text text-anchor="middle" x="11021" y="-6462.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_13_7&#45;&gt;ring_stage2_14_7 -->
<g id="edge2487" class="edge">
<title>ring_stage2_13_7&#45;&gt;ring_stage2_14_7</title>
<path fill="none" stroke="black" d="M11059.38,-6596.53C11051.93,-6574.32 11041.08,-6542.02 11032.82,-6517.41"/>
<polygon fill="black" stroke="black" points="11036.07,-6516.08 11029.57,-6507.72 11029.43,-6518.31 11036.07,-6516.08"/>
</g>
<!-- kv_send2_13_8 -->
<g id="node1739" class="node">
<title>kv_send2_13_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11767" cy="-6339.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11767" y="-6343" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11767" y="-6328" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_13_8&#45;&gt;kv_send2_13_8 -->
<g id="edge2444" class="edge">
<title>ring_stage2_13_8&#45;&gt;kv_send2_13_8</title>
<path fill="none" stroke="black" d="M11766.18,-6454.53C11766.34,-6432.56 11766.57,-6400.71 11766.74,-6376.2"/>
<polygon fill="black" stroke="black" points="11770.24,-6376.22 11766.81,-6366.19 11763.24,-6376.17 11770.24,-6376.22"/>
</g>
<!-- ring_stage2_14_8 -->
<g id="node1755" class="node">
<title>ring_stage2_14_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11645.5,-6365.7 11434.5,-6365.7 11434.5,-6312.7 11645.5,-6312.7 11645.5,-6365.7"/>
<text text-anchor="middle" x="11540" y="-6350.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="11540" y="-6335.5" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_10×V_10</text>
<text text-anchor="middle" x="11540" y="-6320.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_13_8&#45;&gt;ring_stage2_14_8 -->
<g id="edge2490" class="edge">
<title>ring_stage2_13_8&#45;&gt;ring_stage2_14_8</title>
<path fill="none" stroke="black" d="M11724.81,-6454.69C11686.85,-6431.18 11630.44,-6396.23 11589.93,-6371.14"/>
<polygon fill="black" stroke="black" points="11591.63,-6368.07 11581.29,-6365.78 11587.95,-6374.02 11591.63,-6368.07"/>
</g>
<!-- kv_send2_13_9 -->
<g id="node1740" class="node">
<title>kv_send2_13_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10420" cy="-6197.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10420" y="-6201" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10420" y="-6186" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_13_9&#45;&gt;kv_send2_13_9 -->
<g id="edge2447" class="edge">
<title>ring_stage2_13_9&#45;&gt;kv_send2_13_9</title>
<path fill="none" stroke="black" d="M11264.85,-6312.61C11244.38,-6302.52 11219.63,-6291.98 11196,-6286.2 10911.92,-6216.78 10823.51,-6317.83 10539,-6250.2 10516.66,-6244.89 10493.25,-6235.57 10473.17,-6226.28"/>
<polygon fill="black" stroke="black" points="10474.43,-6223 10463.89,-6221.88 10471.43,-6229.33 10474.43,-6223"/>
</g>
<!-- ring_stage2_14_9 -->
<g id="node1756" class="node">
<title>ring_stage2_14_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11639.5,-6223.7 11428.5,-6223.7 11428.5,-6170.7 11639.5,-6170.7 11639.5,-6223.7"/>
<text text-anchor="middle" x="11534" y="-6208.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="11534" y="-6193.5" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_11×V_11</text>
<text text-anchor="middle" x="11534" y="-6178.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_13_9&#45;&gt;ring_stage2_14_9 -->
<g id="edge2493" class="edge">
<title>ring_stage2_13_9&#45;&gt;ring_stage2_14_9</title>
<path fill="none" stroke="black" d="M11351.64,-6312.69C11389.09,-6289.18 11444.76,-6254.23 11484.73,-6229.14"/>
<polygon fill="black" stroke="black" points="11486.65,-6232.06 11493.26,-6223.78 11482.93,-6226.13 11486.65,-6232.06"/>
</g>
<!-- kv_send2_13_10 -->
<g id="node1741" class="node">
<title>kv_send2_13_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11552" cy="-8144.29" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11552" y="-8148.09" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="11552" y="-8133.09" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_13_10&#45;&gt;kv_send2_13_10 -->
<g id="edge2450" class="edge">
<title>ring_stage2_13_10&#45;&gt;kv_send2_13_10</title>
<path fill="none" stroke="black" d="M11566.11,-8207.18C11564.25,-8199.05 11562.17,-8189.91 11560.18,-8181.2"/>
<polygon fill="black" stroke="black" points="11563.55,-8180.23 11557.92,-8171.26 11556.73,-8181.79 11563.55,-8180.23"/>
</g>
<!-- ring_stage2_14_10 -->
<g id="node1757" class="node">
<title>ring_stage2_14_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10530,-6081.7 10310,-6081.7 10310,-6028.7 10530,-6028.7 10530,-6081.7"/>
<text text-anchor="middle" x="10420" y="-6066.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10420" y="-6051.5" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_12×V_12</text>
<text text-anchor="middle" x="10420" y="-6036.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_13_10&#45;&gt;ring_stage2_14_10 -->
<g id="edge2496" class="edge">
<title>ring_stage2_13_10&#45;&gt;ring_stage2_14_10</title>
<path fill="none" stroke="black" d="M11632.43,-8207.41C11647.41,-8198.17 11661.79,-8186.2 11671,-8171.16 11697.92,-8127.18 11681,-8107.13 11681,-8055.55 11681,-8055.55 11681,-8055.55 11681,-7963.81 11681,-7910.73 11690.99,-7883.11 11651,-7848.2 11548.83,-7759.03 11438.06,-7913.6 11348,-7812.2 11316.71,-7776.98 11318.65,-7743.05 11348,-7706.2 11392.61,-7650.21 11455.87,-7722.27 11505,-7670.2 11543,-7629.93 11567,-7462.47 11529,-7422.2 11433.97,-7321.51 11002.03,-7486.89 10907,-7386.2 10874.66,-7351.94 10890.6,-7324.37 10907,-7280.2 10914.35,-7260.41 10930.65,-7264 10938,-7244.2 10954.4,-7200.04 10968.73,-7173.91 10938,-7138.2 10902.96,-7097.49 10748.48,-7123.09 10699,-7102.2 10650.93,-7081.91 10537.06,-7005.97 10512,-6960.2 10458.9,-6863.21 10566.25,-6794.15 10492,-6712.2 10431.65,-6645.6 10352.38,-6743.68 10293,-6676.2 10264.48,-6643.8 10283,-6525.37 10283,-6482.2 10283,-6482.2 10283,-6482.2 10283,-6338.2 10283,-6251.61 10258.48,-6219.64 10301,-6144.2 10314.31,-6120.59 10336.86,-6101.49 10358.77,-6087.2"/>
<polygon fill="black" stroke="black" points="10360.83,-6090.04 10367.44,-6081.77 10357.11,-6084.11 10360.83,-6090.04"/>
</g>
<!-- kv_send2_13_11 -->
<g id="node1742" class="node">
<title>kv_send2_13_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11314" cy="-8054.55" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11314" y="-8058.35" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="11314" y="-8043.35" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_13_11&#45;&gt;kv_send2_13_11 -->
<g id="edge2453" class="edge">
<title>ring_stage2_13_11&#45;&gt;kv_send2_13_11</title>
<path fill="none" stroke="black" d="M11314,-8117.44C11314,-8109.39 11314,-8100.36 11314,-8091.74"/>
<polygon fill="black" stroke="black" points="11317.5,-8091.52 11314,-8081.52 11310.5,-8091.52 11317.5,-8091.52"/>
</g>
<!-- ring_stage2_14_11 -->
<g id="node1758" class="node">
<title>ring_stage2_14_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11662,-8081.05 11442,-8081.05 11442,-8028.05 11662,-8028.05 11662,-8081.05"/>
<text text-anchor="middle" x="11552" y="-8065.85" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="11552" y="-8050.85" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_13×V_13</text>
<text text-anchor="middle" x="11552" y="-8035.85" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_13_11&#45;&gt;ring_stage2_14_11 -->
<g id="edge2499" class="edge">
<title>ring_stage2_13_11&#45;&gt;ring_stage2_14_11</title>
<path fill="none" stroke="black" d="M11383.48,-8117.68C11411.46,-8107.36 11443.89,-8095.41 11472.78,-8084.76"/>
<polygon fill="black" stroke="black" points="11474.26,-8087.94 11482.43,-8081.2 11471.84,-8081.37 11474.26,-8087.94"/>
</g>
<!-- kv_send2_13_12 -->
<g id="node1743" class="node">
<title>kv_send2_13_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11036" cy="-7964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11036" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="11036" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_13_12&#45;&gt;kv_send2_13_12 -->
<g id="edge2456" class="edge">
<title>ring_stage2_13_12&#45;&gt;kv_send2_13_12</title>
<path fill="none" stroke="black" d="M11064.22,-8027.7C11060.42,-8019.39 11056.16,-8010.03 11052.11,-8001.15"/>
<polygon fill="black" stroke="black" points="11055.17,-7999.43 11047.84,-7991.78 11048.8,-8002.33 11055.17,-7999.43"/>
</g>
<!-- ring_stage2_14_12 -->
<g id="node1759" class="node">
<title>ring_stage2_14_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11384,-7991.31 11164,-7991.31 11164,-7938.31 11384,-7938.31 11384,-7991.31"/>
<text text-anchor="middle" x="11274" y="-7976.11" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="11274" y="-7961.11" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_14×V_14</text>
<text text-anchor="middle" x="11274" y="-7946.11" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_13_12&#45;&gt;ring_stage2_14_12 -->
<g id="edge2502" class="edge">
<title>ring_stage2_13_12&#45;&gt;ring_stage2_14_12</title>
<path fill="none" stroke="black" d="M11133.8,-8027.94C11156.68,-8017.8 11183.12,-8006.08 11206.84,-7995.57"/>
<polygon fill="black" stroke="black" points="11208.4,-7998.71 11216.13,-7991.46 11205.57,-7992.31 11208.4,-7998.71"/>
</g>
<!-- kv_send2_13_13 -->
<g id="node1744" class="node">
<title>kv_send2_13_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10751" cy="-7875.07" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10751" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="10751" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_13_13&#45;&gt;kv_send2_13_13 -->
<g id="edge2459" class="edge">
<title>ring_stage2_13_13&#45;&gt;kv_send2_13_13</title>
<path fill="none" stroke="black" d="M10790.5,-7937.96C10784.98,-7929.31 10778.73,-7919.52 10772.86,-7910.32"/>
<polygon fill="black" stroke="black" points="10775.71,-7908.29 10767.38,-7901.74 10769.81,-7912.05 10775.71,-7908.29"/>
</g>
<!-- ring_stage2_14_13 -->
<g id="node1760" class="node">
<title>ring_stage2_14_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11105,-7901.57 10885,-7901.57 10885,-7848.57 11105,-7848.57 11105,-7901.57"/>
<text text-anchor="middle" x="10995" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10995" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_15×V_15</text>
<text text-anchor="middle" x="10995" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_13_13&#45;&gt;ring_stage2_14_13 -->
<g id="edge2505" class="edge">
<title>ring_stage2_13_13&#45;&gt;ring_stage2_14_13</title>
<path fill="none" stroke="black" d="M10861.88,-7938.2C10883.51,-7928.11 10908.49,-7916.45 10930.93,-7905.97"/>
<polygon fill="black" stroke="black" points="10932.47,-7909.12 10940.05,-7901.72 10929.51,-7902.78 10932.47,-7909.12"/>
</g>
<!-- kv_send2_13_14 -->
<g id="node1745" class="node">
<title>kv_send2_13_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10480" cy="-7759.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10480" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="10480" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_13_14&#45;&gt;kv_send2_13_14 -->
<g id="edge2462" class="edge">
<title>ring_stage2_13_14&#45;&gt;kv_send2_13_14</title>
<path fill="none" stroke="black" d="M10508.7,-7848.52C10503.64,-7832.95 10497.1,-7812.83 10491.54,-7795.73"/>
<polygon fill="black" stroke="black" points="10494.82,-7794.5 10488.4,-7786.07 10488.17,-7796.66 10494.82,-7794.5"/>
</g>
<!-- ring_stage2_14_14 -->
<g id="node1761" class="node">
<title>ring_stage2_14_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10810,-7785.7 10608,-7785.7 10608,-7732.7 10810,-7732.7 10810,-7785.7"/>
<text text-anchor="middle" x="10709" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10709" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_0×V_0</text>
<text text-anchor="middle" x="10709" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_13_14&#45;&gt;ring_stage2_14_14 -->
<g id="edge2508" class="edge">
<title>ring_stage2_13_14&#45;&gt;ring_stage2_14_14</title>
<path fill="none" stroke="black" d="M10560.09,-7848.52C10588.77,-7831.51 10626.61,-7809.07 10656.97,-7791.06"/>
<polygon fill="black" stroke="black" points="10658.91,-7793.98 10665.72,-7785.87 10655.34,-7787.96 10658.91,-7793.98"/>
</g>
<!-- kv_send2_13_15 -->
<g id="node1746" class="node">
<title>kv_send2_13_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10235" cy="-7617.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10235" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="10235" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_13_15&#45;&gt;kv_send2_13_15 -->
<g id="edge2465" class="edge">
<title>ring_stage2_13_15&#45;&gt;kv_send2_13_15</title>
<path fill="none" stroke="black" d="M10248.07,-7732.53C10245.56,-7710.56 10241.91,-7678.71 10239.11,-7654.2"/>
<polygon fill="black" stroke="black" points="10242.58,-7653.73 10237.97,-7644.19 10235.63,-7654.53 10242.58,-7653.73"/>
</g>
<!-- ring_stage2_14_15 -->
<g id="node1762" class="node">
<title>ring_stage2_14_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10558,-7643.7 10356,-7643.7 10356,-7590.7 10558,-7590.7 10558,-7643.7"/>
<text text-anchor="middle" x="10457" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="10457" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_1×V_1</text>
<text text-anchor="middle" x="10457" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_13_15&#45;&gt;ring_stage2_14_15 -->
<g id="edge2511" class="edge">
<title>ring_stage2_13_15&#45;&gt;ring_stage2_14_15</title>
<path fill="none" stroke="black" d="M10288.78,-7732.53C10323.19,-7709.14 10374.1,-7674.54 10410.89,-7649.54"/>
<polygon fill="black" stroke="black" points="10413.15,-7652.23 10419.46,-7643.72 10409.22,-7646.45 10413.15,-7652.23"/>
</g>
<!-- kv_send2_13_0&#45;&gt;ring_stage2_14_1 -->
<g id="edge2470" class="edge">
<title>kv_send2_13_0&#45;&gt;ring_stage2_14_1</title>
<path fill="none" stroke="black" d="M9163.37,-7448.2C9163.68,-7426.29 9164.14,-7394.72 9164.48,-7370.36"/>
<polygon fill="black" stroke="black" points="9167.99,-7370.12 9164.63,-7360.07 9160.99,-7370.02 9167.99,-7370.12"/>
</g>
<!-- kv_send2_13_1&#45;&gt;ring_stage2_14_2 -->
<g id="edge2473" class="edge">
<title>kv_send2_13_1&#45;&gt;ring_stage2_14_2</title>
<path fill="none" stroke="black" d="M8512.74,-7306.2C8513.37,-7284.29 8514.27,-7252.72 8514.97,-7228.36"/>
<polygon fill="black" stroke="black" points="8518.47,-7228.16 8515.26,-7218.07 8511.48,-7227.96 8518.47,-7228.16"/>
</g>
<!-- kv_send2_13_2&#45;&gt;ring_stage2_14_3 -->
<g id="edge2476" class="edge">
<title>kv_send2_13_2&#45;&gt;ring_stage2_14_3</title>
<path fill="none" stroke="black" d="M8339.37,-7166.91C8360.54,-7156.68 8386.55,-7145.4 8411,-7138.2 8513.21,-7108.14 8545.74,-7132.11 8648,-7102.2 8667.44,-7096.52 8687.86,-7088.29 8706.11,-7080.06"/>
<polygon fill="black" stroke="black" points="8707.81,-7083.12 8715.43,-7075.76 8704.89,-7076.77 8707.81,-7083.12"/>
</g>
<!-- kv_send2_13_3&#45;&gt;ring_stage2_14_4 -->
<g id="edge2479" class="edge">
<title>kv_send2_13_3&#45;&gt;ring_stage2_14_4</title>
<path fill="none" stroke="black" d="M9359.07,-7025.33C9379.77,-7015.82 9404.37,-7004.99 9427,-6996.2 9474.56,-6977.74 9488,-6977.5 9536,-6960.2 9555.64,-6953.13 9576.76,-6945.08 9596.25,-6937.46"/>
<polygon fill="black" stroke="black" points="9597.64,-6940.67 9605.67,-6933.76 9595.08,-6934.16 9597.64,-6940.67"/>
</g>
<!-- kv_send2_13_4&#45;&gt;ring_stage2_14_5 -->
<g id="edge2482" class="edge">
<title>kv_send2_13_4&#45;&gt;ring_stage2_14_5</title>
<path fill="none" stroke="black" d="M9940.62,-6882.3C9979.52,-6858.82 10039.06,-6822.89 10081.6,-6797.22"/>
<polygon fill="black" stroke="black" points="10083.65,-6800.07 10090.4,-6791.91 10080.03,-6794.08 10083.65,-6800.07"/>
</g>
<!-- kv_send2_13_5&#45;&gt;ring_stage2_14_6 -->
<g id="edge2485" class="edge">
<title>kv_send2_13_5&#45;&gt;ring_stage2_14_6</title>
<path fill="none" stroke="black" d="M10421.22,-6740.45C10462.22,-6716.83 10525.31,-6680.49 10570.01,-6654.73"/>
<polygon fill="black" stroke="black" points="10571.78,-6657.76 10578.69,-6649.73 10568.28,-6651.69 10571.78,-6657.76"/>
</g>
<!-- kv_send2_13_6&#45;&gt;ring_stage2_14_7 -->
<g id="edge2488" class="edge">
<title>kv_send2_13_6&#45;&gt;ring_stage2_14_7</title>
<path fill="none" stroke="black" d="M10872.77,-6597.5C10902.63,-6574.27 10947.49,-6539.38 10980.04,-6514.06"/>
<polygon fill="black" stroke="black" points="10982.29,-6516.75 10988.03,-6507.85 10977.99,-6511.22 10982.29,-6516.75"/>
</g>
<!-- kv_send2_13_7&#45;&gt;ring_stage2_14_8 -->
<g id="edge2491" class="edge">
<title>kv_send2_13_7&#45;&gt;ring_stage2_14_8</title>
<path fill="none" stroke="black" d="M11353.68,-6456.14C11391.45,-6432.63 11449.1,-6396.76 11490.26,-6371.15"/>
<polygon fill="black" stroke="black" points="11492.14,-6374.1 11498.78,-6365.85 11488.44,-6368.16 11492.14,-6374.1"/>
</g>
<!-- kv_send2_13_8&#45;&gt;ring_stage2_14_9 -->
<g id="edge2494" class="edge">
<title>kv_send2_13_8&#45;&gt;ring_stage2_14_9</title>
<path fill="none" stroke="black" d="M11727.21,-6314.3C11688.06,-6290.77 11628.09,-6254.74 11585.36,-6229.06"/>
<polygon fill="black" stroke="black" points="11587.16,-6226.06 11576.78,-6223.91 11583.55,-6232.06 11587.16,-6226.06"/>
</g>
<!-- kv_send2_13_9&#45;&gt;ring_stage2_14_10 -->
<g id="edge2497" class="edge">
<title>kv_send2_13_9&#45;&gt;ring_stage2_14_10</title>
<path fill="none" stroke="black" d="M10420,-6170.2C10420,-6148.29 10420,-6116.72 10420,-6092.36"/>
<polygon fill="black" stroke="black" points="10423.5,-6092.07 10420,-6082.07 10416.5,-6092.07 10423.5,-6092.07"/>
</g>
<!-- kv_send2_13_10&#45;&gt;ring_stage2_14_11 -->
<g id="edge2500" class="edge">
<title>kv_send2_13_10&#45;&gt;ring_stage2_14_11</title>
<path fill="none" stroke="black" d="M11552,-8116.97C11552,-8108.93 11552,-8099.95 11552,-8091.39"/>
<polygon fill="black" stroke="black" points="11555.5,-8091.26 11552,-8081.26 11548.5,-8091.26 11555.5,-8091.26"/>
</g>
<!-- kv_send2_13_11&#45;&gt;ring_stage2_14_12 -->
<g id="edge2503" class="edge">
<title>kv_send2_13_11&#45;&gt;ring_stage2_14_12</title>
<path fill="none" stroke="black" d="M11302.22,-8027.7C11298.35,-8019.22 11293.99,-8009.66 11289.87,-8000.63"/>
<polygon fill="black" stroke="black" points="11293.03,-7999.13 11285.7,-7991.48 11286.66,-8002.03 11293.03,-7999.13"/>
</g>
<!-- kv_send2_13_12&#45;&gt;ring_stage2_14_13 -->
<g id="edge2506" class="edge">
<title>kv_send2_13_12&#45;&gt;ring_stage2_14_13</title>
<path fill="none" stroke="black" d="M11023.92,-7937.96C11019.96,-7929.48 11015.49,-7919.92 11011.27,-7910.89"/>
<polygon fill="black" stroke="black" points="11014.4,-7909.32 11006.99,-7901.74 11008.06,-7912.28 11014.4,-7909.32"/>
</g>
<!-- kv_send2_13_13&#45;&gt;ring_stage2_14_14 -->
<g id="edge2509" class="edge">
<title>kv_send2_13_13&#45;&gt;ring_stage2_14_14</title>
<path fill="none" stroke="black" d="M10741.47,-7848.23C10735.72,-7832.66 10728.33,-7812.6 10722.04,-7795.56"/>
<polygon fill="black" stroke="black" points="10725.24,-7794.11 10718.49,-7785.94 10718.67,-7796.53 10725.24,-7794.11"/>
</g>
<!-- kv_send2_13_14&#45;&gt;ring_stage2_14_15 -->
<g id="edge2512" class="edge">
<title>kv_send2_13_14&#45;&gt;ring_stage2_14_15</title>
<path fill="none" stroke="black" d="M10475.73,-7732.2C10472.11,-7710.2 10466.9,-7678.44 10462.89,-7654.03"/>
<polygon fill="black" stroke="black" points="10466.32,-7653.37 10461.25,-7644.07 10459.42,-7654.5 10466.32,-7653.37"/>
</g>
<!-- kv_send2_13_15&#45;&gt;ring_stage2_14_0 -->
<g id="edge2467" class="edge">
<title>kv_send2_13_15&#45;&gt;ring_stage2_14_0</title>
<path fill="none" stroke="black" d="M10203.94,-7591.5C10174.86,-7568.37 10131.25,-7533.67 10099.46,-7508.39"/>
<polygon fill="black" stroke="black" points="10101.24,-7505.33 10091.24,-7501.85 10096.88,-7510.81 10101.24,-7505.33"/>
</g>
<!-- kv_send2_14_0 -->
<g id="node1763" class="node">
<title>kv_send2_14_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9909" cy="-7333.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9909" y="-7337" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="9909" y="-7322" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage2_14_0&#45;&gt;kv_send2_14_0 -->
<g id="edge2468" class="edge">
<title>ring_stage2_14_0&#45;&gt;kv_send2_14_0</title>
<path fill="none" stroke="black" d="M10031.49,-7448.53C10006.7,-7425.39 9970.16,-7391.28 9943.44,-7366.35"/>
<polygon fill="black" stroke="black" points="9945.53,-7363.51 9935.83,-7359.25 9940.76,-7368.63 9945.53,-7363.51"/>
</g>
<!-- ring_stage2_15_0 -->
<g id="node1779" class="node">
<title>ring_stage2_15_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10676.5,-7359.7 10483.5,-7359.7 10483.5,-7306.7 10676.5,-7306.7 10676.5,-7359.7"/>
<text text-anchor="middle" x="10580" y="-7344.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10580" y="-7329.5" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_1×V_1</text>
<text text-anchor="middle" x="10580" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_14_0&#45;&gt;ring_stage2_15_0 -->
<g id="edge2514" class="edge">
<title>ring_stage2_14_0&#45;&gt;ring_stage2_15_0</title>
<path fill="none" stroke="black" d="M10102.51,-7448.69C10121.17,-7438.87 10143.56,-7428.5 10165,-7422.2 10298.08,-7383.09 10342,-7425.56 10475,-7386.2 10492.94,-7380.89 10511.54,-7372.69 10528.01,-7364.35"/>
<polygon fill="black" stroke="black" points="10529.66,-7367.44 10536.93,-7359.73 10526.44,-7361.23 10529.66,-7367.44"/>
</g>
<!-- kv_send2_14_1 -->
<g id="node1764" class="node">
<title>kv_send2_14_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9034" cy="-7191.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9034" y="-7195" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="9034" y="-7180" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage2_14_1&#45;&gt;kv_send2_14_1 -->
<g id="edge2471" class="edge">
<title>ring_stage2_14_1&#45;&gt;kv_send2_14_1</title>
<path fill="none" stroke="black" d="M9140.97,-7306.53C9119.55,-7283.63 9088.08,-7250 9064.81,-7225.13"/>
<polygon fill="black" stroke="black" points="9067.26,-7222.63 9057.88,-7217.72 9062.15,-7227.41 9067.26,-7222.63"/>
</g>
<!-- ring_stage2_15_1 -->
<g id="node1780" class="node">
<title>ring_stage2_15_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10009.5,-7217.7 9816.5,-7217.7 9816.5,-7164.7 10009.5,-7164.7 10009.5,-7217.7"/>
<text text-anchor="middle" x="9913" y="-7202.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="9913" y="-7187.5" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_2×V_2</text>
<text text-anchor="middle" x="9913" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_14_1&#45;&gt;ring_stage2_15_1 -->
<g id="edge2516" class="edge">
<title>ring_stage2_14_1&#45;&gt;ring_stage2_15_1</title>
<path fill="none" stroke="black" d="M9208.46,-7306.59C9227.6,-7296.56 9250.77,-7286.07 9273,-7280.2 9503,-7219.51 9577.23,-7305.74 9807,-7244.2 9825.46,-7239.26 9844.53,-7231.02 9861.33,-7222.54"/>
<polygon fill="black" stroke="black" points="9863.14,-7225.54 9870.4,-7217.82 9859.91,-7219.33 9863.14,-7225.54"/>
</g>
<!-- kv_send2_14_2 -->
<g id="node1765" class="node">
<title>kv_send2_14_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8536" cy="-7049.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8536" y="-7053" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="8536" y="-7038" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage2_14_2&#45;&gt;kv_send2_14_2 -->
<g id="edge2474" class="edge">
<title>ring_stage2_14_2&#45;&gt;kv_send2_14_2</title>
<path fill="none" stroke="black" d="M8519.67,-7164.53C8522.81,-7142.56 8527.36,-7110.71 8530.86,-7086.2"/>
<polygon fill="black" stroke="black" points="8534.34,-7086.59 8532.29,-7076.19 8527.41,-7085.6 8534.34,-7086.59"/>
</g>
<!-- ring_stage2_15_2 -->
<g id="node1781" class="node">
<title>ring_stage2_15_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9130.5,-7075.7 8937.5,-7075.7 8937.5,-7022.7 9130.5,-7022.7 9130.5,-7075.7"/>
<text text-anchor="middle" x="9034" y="-7060.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="9034" y="-7045.5" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_3×V_3</text>
<text text-anchor="middle" x="9034" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_14_2&#45;&gt;ring_stage2_15_2 -->
<g id="edge2518" class="edge">
<title>ring_stage2_14_2&#45;&gt;ring_stage2_15_2</title>
<path fill="none" stroke="black" d="M8584.34,-7164.7C8610.83,-7155.46 8641.57,-7145.51 8670,-7138.2 8757.9,-7115.62 8782.91,-7124.04 8871,-7102.2 8897.33,-7095.68 8925.62,-7087.19 8951.12,-7078.97"/>
<polygon fill="black" stroke="black" points="8952.32,-7082.26 8960.75,-7075.83 8950.16,-7075.6 8952.32,-7082.26"/>
</g>
<!-- kv_send2_14_3 -->
<g id="node1766" class="node">
<title>kv_send2_14_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9424" cy="-6907.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9424" y="-6911" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="9424" y="-6896" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage2_14_3&#45;&gt;kv_send2_14_3 -->
<g id="edge2477" class="edge">
<title>ring_stage2_14_3&#45;&gt;kv_send2_14_3</title>
<path fill="none" stroke="black" d="M8835.22,-7022.58C8863.95,-7012.98 8897.73,-7002.81 8929,-6996.2 9072.49,-6965.89 9113.44,-6990.14 9257,-6960.2 9290.13,-6953.3 9326.06,-6942.55 9356.08,-6932.61"/>
<polygon fill="black" stroke="black" points="9357.23,-6935.92 9365.6,-6929.42 9355.01,-6929.28 9357.23,-6935.92"/>
</g>
<!-- ring_stage2_15_3 -->
<g id="node1782" class="node">
<title>ring_stage2_15_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8802.5,-6933.7 8609.5,-6933.7 8609.5,-6880.7 8802.5,-6880.7 8802.5,-6933.7"/>
<text text-anchor="middle" x="8706" y="-6918.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="8706" y="-6903.5" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_4×V_4</text>
<text text-anchor="middle" x="8706" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_14_3&#45;&gt;ring_stage2_15_3 -->
<g id="edge2520" class="edge">
<title>ring_stage2_14_3&#45;&gt;ring_stage2_15_3</title>
<path fill="none" stroke="black" d="M8754.18,-7022.53C8744.78,-7000.23 8731.09,-6967.73 8720.7,-6943.08"/>
<polygon fill="black" stroke="black" points="8723.86,-6941.57 8716.75,-6933.72 8717.41,-6944.29 8723.86,-6941.57"/>
</g>
<!-- kv_send2_14_4 -->
<g id="node1767" class="node">
<title>kv_send2_14_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9915" cy="-6765.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9915" y="-6769" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="9915" y="-6754" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage2_14_4&#45;&gt;kv_send2_14_4 -->
<g id="edge2480" class="edge">
<title>ring_stage2_14_4&#45;&gt;kv_send2_14_4</title>
<path fill="none" stroke="black" d="M9713.83,-6880.69C9756.36,-6856.49 9820.17,-6820.17 9864.48,-6794.96"/>
<polygon fill="black" stroke="black" points="9866.38,-6797.9 9873.34,-6789.91 9862.92,-6791.81 9866.38,-6797.9"/>
</g>
<!-- ring_stage2_15_4 -->
<g id="node1783" class="node">
<title>ring_stage2_15_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9793.5,-6791.7 9600.5,-6791.7 9600.5,-6738.7 9793.5,-6738.7 9793.5,-6791.7"/>
<text text-anchor="middle" x="9697" y="-6776.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="9697" y="-6761.5" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_5×V_5</text>
<text text-anchor="middle" x="9697" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_14_4&#45;&gt;ring_stage2_15_4 -->
<g id="edge2522" class="edge">
<title>ring_stage2_14_4&#45;&gt;ring_stage2_15_4</title>
<path fill="none" stroke="black" d="M9674.14,-6880.53C9678.56,-6858.42 9684.98,-6826.3 9689.89,-6801.73"/>
<polygon fill="black" stroke="black" points="9693.37,-6802.21 9691.9,-6791.72 9686.5,-6800.84 9693.37,-6802.21"/>
</g>
<!-- kv_send2_14_5 -->
<g id="node1768" class="node">
<title>kv_send2_14_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10405" cy="-6623.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10405" y="-6627" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10405" y="-6612" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage2_14_5&#45;&gt;kv_send2_14_5 -->
<g id="edge2483" class="edge">
<title>ring_stage2_14_5&#45;&gt;kv_send2_14_5</title>
<path fill="none" stroke="black" d="M10182.57,-6738.69C10230.08,-6714.24 10301.6,-6677.42 10350.64,-6652.18"/>
<polygon fill="black" stroke="black" points="10352.54,-6655.14 10359.83,-6647.45 10349.34,-6648.92 10352.54,-6655.14"/>
</g>
<!-- ring_stage2_15_5 -->
<g id="node1784" class="node">
<title>ring_stage2_15_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10128.5,-6649.7 9935.5,-6649.7 9935.5,-6596.7 10128.5,-6596.7 10128.5,-6649.7"/>
<text text-anchor="middle" x="10032" y="-6634.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10032" y="-6619.5" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_6×V_6</text>
<text text-anchor="middle" x="10032" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_14_5&#45;&gt;ring_stage2_15_5 -->
<g id="edge2524" class="edge">
<title>ring_stage2_14_5&#45;&gt;ring_stage2_15_5</title>
<path fill="none" stroke="black" d="M10114.48,-6738.53C10098.17,-6715.93 10074.32,-6682.87 10056.45,-6658.1"/>
<polygon fill="black" stroke="black" points="10059.1,-6655.78 10050.41,-6649.72 10053.42,-6659.88 10059.1,-6655.78"/>
</g>
<!-- kv_send2_14_6 -->
<g id="node1769" class="node">
<title>kv_send2_14_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10779" cy="-6481.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10779" y="-6485" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10779" y="-6470" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage2_14_6&#45;&gt;kv_send2_14_6 -->
<g id="edge2486" class="edge">
<title>ring_stage2_14_6&#45;&gt;kv_send2_14_6</title>
<path fill="none" stroke="black" d="M10651.61,-6596.53C10677.5,-6573.29 10715.72,-6538.99 10743.54,-6514.02"/>
<polygon fill="black" stroke="black" points="10745.99,-6516.53 10751.09,-6507.25 10741.31,-6511.32 10745.99,-6516.53"/>
</g>
<!-- ring_stage2_15_6 -->
<g id="node1785" class="node">
<title>ring_stage2_15_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10634.5,-6507.7 10441.5,-6507.7 10441.5,-6454.7 10634.5,-6454.7 10634.5,-6507.7"/>
<text text-anchor="middle" x="10538" y="-6492.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10538" y="-6477.5" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_7×V_7</text>
<text text-anchor="middle" x="10538" y="-6462.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_14_6&#45;&gt;ring_stage2_15_6 -->
<g id="edge2526" class="edge">
<title>ring_stage2_14_6&#45;&gt;ring_stage2_15_6</title>
<path fill="none" stroke="black" d="M10607.41,-6596.53C10593.75,-6574.03 10573.79,-6541.15 10558.78,-6516.43"/>
<polygon fill="black" stroke="black" points="10561.67,-6514.45 10553.49,-6507.72 10555.69,-6518.08 10561.67,-6514.45"/>
</g>
<!-- kv_send2_14_7 -->
<g id="node1770" class="node">
<title>kv_send2_14_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11084" cy="-6339.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11084" y="-6343" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="11084" y="-6328" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage2_14_7&#45;&gt;kv_send2_14_7 -->
<g id="edge2489" class="edge">
<title>ring_stage2_14_7&#45;&gt;kv_send2_14_7</title>
<path fill="none" stroke="black" d="M11032.56,-6454.53C11042.53,-6432.36 11057.03,-6400.14 11068.1,-6375.54"/>
<polygon fill="black" stroke="black" points="11071.39,-6376.75 11072.3,-6366.19 11065.01,-6373.88 11071.39,-6376.75"/>
</g>
<!-- ring_stage2_15_7 -->
<g id="node1786" class="node">
<title>ring_stage2_15_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10962.5,-6365.7 10769.5,-6365.7 10769.5,-6312.7 10962.5,-6312.7 10962.5,-6365.7"/>
<text text-anchor="middle" x="10866" y="-6350.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10866" y="-6335.5" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_8×V_8</text>
<text text-anchor="middle" x="10866" y="-6320.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_14_7&#45;&gt;ring_stage2_15_7 -->
<g id="edge2528" class="edge">
<title>ring_stage2_14_7&#45;&gt;ring_stage2_15_7</title>
<path fill="none" stroke="black" d="M10992.57,-6454.53C10967.01,-6431.44 10929.34,-6397.42 10901.75,-6372.49"/>
<polygon fill="black" stroke="black" points="10904.02,-6369.82 10894.25,-6365.72 10899.32,-6375.02 10904.02,-6369.82"/>
</g>
<!-- kv_send2_14_8 -->
<g id="node1771" class="node">
<title>kv_send2_14_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11761" cy="-6197.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11761" y="-6201" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="11761" y="-6186" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage2_14_8&#45;&gt;kv_send2_14_8 -->
<g id="edge2492" class="edge">
<title>ring_stage2_14_8&#45;&gt;kv_send2_14_8</title>
<path fill="none" stroke="black" d="M11580.28,-6312.69C11618.01,-6288.78 11674.4,-6253.06 11714.13,-6227.89"/>
<polygon fill="black" stroke="black" points="11716.27,-6230.68 11722.85,-6222.37 11712.53,-6224.77 11716.27,-6230.68"/>
</g>
<!-- ring_stage2_15_8 -->
<g id="node1787" class="node">
<title>ring_stage2_15_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11410.5,-6223.7 11217.5,-6223.7 11217.5,-6170.7 11410.5,-6170.7 11410.5,-6223.7"/>
<text text-anchor="middle" x="11314" y="-6208.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="11314" y="-6193.5" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_9×V_9</text>
<text text-anchor="middle" x="11314" y="-6178.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_14_8&#45;&gt;ring_stage2_15_8 -->
<g id="edge2530" class="edge">
<title>ring_stage2_14_8&#45;&gt;ring_stage2_15_8</title>
<path fill="none" stroke="black" d="M11498.81,-6312.69C11460.85,-6289.18 11404.44,-6254.23 11363.93,-6229.14"/>
<polygon fill="black" stroke="black" points="11365.63,-6226.07 11355.29,-6223.78 11361.95,-6232.02 11365.63,-6226.07"/>
</g>
<!-- kv_send2_14_9 -->
<g id="node1772" class="node">
<title>kv_send2_14_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10783" cy="-6055.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10783" y="-6059" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="10783" y="-6044" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage2_14_9&#45;&gt;kv_send2_14_9 -->
<g id="edge2495" class="edge">
<title>ring_stage2_14_9&#45;&gt;kv_send2_14_9</title>
<path fill="none" stroke="black" d="M11487.96,-6170.64C11467.72,-6160.62 11443.3,-6150.12 11420,-6144.2 11196.32,-6087.41 11126.13,-6163.21 10902,-6108.2 10879.79,-6102.75 10856.5,-6093.46 10836.47,-6084.22"/>
<polygon fill="black" stroke="black" points="10837.75,-6080.96 10827.21,-6079.85 10834.76,-6087.29 10837.75,-6080.96"/>
</g>
<!-- ring_stage2_15_9 -->
<g id="node1788" class="node">
<title>ring_stage2_15_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11791.5,-6081.7 11580.5,-6081.7 11580.5,-6028.7 11791.5,-6028.7 11791.5,-6081.7"/>
<text text-anchor="middle" x="11686" y="-6066.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="11686" y="-6051.5" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_10×V_10</text>
<text text-anchor="middle" x="11686" y="-6036.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_14_9&#45;&gt;ring_stage2_15_9 -->
<g id="edge2532" class="edge">
<title>ring_stage2_14_9&#45;&gt;ring_stage2_15_9</title>
<path fill="none" stroke="black" d="M11561.88,-6170.53C11586.84,-6147.53 11623.57,-6113.71 11650.6,-6088.81"/>
<polygon fill="black" stroke="black" points="11653.31,-6091.07 11658.3,-6081.72 11648.57,-6085.92 11653.31,-6091.07"/>
</g>
<!-- kv_send2_14_10 -->
<g id="node1773" class="node">
<title>kv_send2_14_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10420" cy="-5913.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10420" y="-5917" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="10420" y="-5902" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage2_14_10&#45;&gt;kv_send2_14_10 -->
<g id="edge2498" class="edge">
<title>ring_stage2_14_10&#45;&gt;kv_send2_14_10</title>
<path fill="none" stroke="black" d="M10420,-6028.53C10420,-6006.56 10420,-5974.71 10420,-5950.2"/>
<polygon fill="black" stroke="black" points="10423.5,-5950.19 10420,-5940.19 10416.5,-5950.19 10423.5,-5950.19"/>
</g>
<!-- ring_stage2_15_10 -->
<g id="node1789" class="node">
<title>ring_stage2_15_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10893,-5939.7 10673,-5939.7 10673,-5886.7 10893,-5886.7 10893,-5939.7"/>
<text text-anchor="middle" x="10783" y="-5924.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10783" y="-5909.5" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_11×V_11</text>
<text text-anchor="middle" x="10783" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_14_10&#45;&gt;ring_stage2_15_10 -->
<g id="edge2534" class="edge">
<title>ring_stage2_14_10&#45;&gt;ring_stage2_15_10</title>
<path fill="none" stroke="black" d="M10486.16,-6028.69C10548.53,-6004.63 10641.93,-5968.61 10707.26,-5943.42"/>
<polygon fill="black" stroke="black" points="10708.61,-5946.64 10716.68,-5939.78 10706.09,-5940.11 10708.61,-5946.64"/>
</g>
<!-- kv_send2_14_11 -->
<g id="node1774" class="node">
<title>kv_send2_14_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11532" cy="-7964.81" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11532" y="-7968.61" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="11532" y="-7953.61" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage2_14_11&#45;&gt;kv_send2_14_11 -->
<g id="edge2501" class="edge">
<title>ring_stage2_14_11&#45;&gt;kv_send2_14_11</title>
<path fill="none" stroke="black" d="M11546.11,-8027.7C11544.25,-8019.56 11542.17,-8010.43 11540.18,-8001.72"/>
<polygon fill="black" stroke="black" points="11543.55,-8000.75 11537.92,-7991.78 11536.73,-8002.31 11543.55,-8000.75"/>
</g>
<!-- ring_stage2_15_11 -->
<g id="node1790" class="node">
<title>ring_stage2_15_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10530,-5797.7 10310,-5797.7 10310,-5744.7 10530,-5744.7 10530,-5797.7"/>
<text text-anchor="middle" x="10420" y="-5782.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10420" y="-5767.5" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_12×V_12</text>
<text text-anchor="middle" x="10420" y="-5752.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_14_11&#45;&gt;ring_stage2_15_11 -->
<g id="edge2536" class="edge">
<title>ring_stage2_14_11&#45;&gt;ring_stage2_15_11</title>
<path fill="none" stroke="black" d="M11458.95,-8027.88C11441.33,-8019.06 11424.76,-8007.3 11413,-7991.68 11374.28,-7940.24 11430.7,-7900.4 11393,-7848.2 11371.82,-7818.88 11339.1,-7842.92 11320,-7812.2 11295.12,-7772.2 11290.36,-7742.82 11320,-7706.2 11368.32,-7646.51 11440.68,-7729.9 11489,-7670.2 11518.64,-7633.58 11521.35,-7598.45 11489,-7564.2 11392.71,-7462.26 10964.36,-7620.74 10859,-7528.2 10822.98,-7496.57 10862.18,-7464.17 10839,-7422.2 10794.15,-7340.99 10770.82,-7317.78 10686,-7280.2 10600.76,-7242.44 10332.78,-7311.25 10268,-7244.2 10238.01,-7213.16 10258,-7093.37 10258,-7050.2 10258,-7050.2 10258,-7050.2 10258,-6906.2 10258,-6654.64 10263,-6591.77 10263,-6340.2 10263,-6340.2 10263,-6340.2 10263,-6054.2 10263,-5966.34 10254.05,-5934.47 10301,-5860.2 10315.67,-5837 10338.81,-5817.84 10360.81,-5803.39"/>
<polygon fill="black" stroke="black" points="10362.92,-5806.2 10369.48,-5797.88 10359.17,-5800.29 10362.92,-5806.2"/>
</g>
<!-- kv_send2_14_12 -->
<g id="node1775" class="node">
<title>kv_send2_14_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11274" cy="-7875.07" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="11274" y="-7878.87" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="11274" y="-7863.87" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage2_14_12&#45;&gt;kv_send2_14_12 -->
<g id="edge2504" class="edge">
<title>ring_stage2_14_12&#45;&gt;kv_send2_14_12</title>
<path fill="none" stroke="black" d="M11274,-7937.96C11274,-7929.91 11274,-7920.88 11274,-7912.26"/>
<polygon fill="black" stroke="black" points="11277.5,-7912.04 11274,-7902.04 11270.5,-7912.04 11277.5,-7912.04"/>
</g>
<!-- ring_stage2_15_12 -->
<g id="node1791" class="node">
<title>ring_stage2_15_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11642,-7901.57 11422,-7901.57 11422,-7848.57 11642,-7848.57 11642,-7901.57"/>
<text text-anchor="middle" x="11532" y="-7886.37" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="11532" y="-7871.37" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_13×V_13</text>
<text text-anchor="middle" x="11532" y="-7856.37" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_14_12&#45;&gt;ring_stage2_15_12 -->
<g id="edge2538" class="edge">
<title>ring_stage2_14_12&#45;&gt;ring_stage2_15_12</title>
<path fill="none" stroke="black" d="M11349.32,-7938.2C11379.92,-7927.79 11415.42,-7915.72 11446.94,-7905"/>
<polygon fill="black" stroke="black" points="11448.25,-7908.25 11456.59,-7901.72 11445.99,-7901.63 11448.25,-7908.25"/>
</g>
<!-- kv_send2_14_13 -->
<g id="node1776" class="node">
<title>kv_send2_14_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10938" cy="-7759.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10938" y="-7763" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="10938" y="-7748" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage2_14_13&#45;&gt;kv_send2_14_13 -->
<g id="edge2507" class="edge">
<title>ring_stage2_14_13&#45;&gt;kv_send2_14_13</title>
<path fill="none" stroke="black" d="M10982.21,-7848.52C10974.34,-7832.81 10964.16,-7812.46 10955.54,-7795.25"/>
<polygon fill="black" stroke="black" points="10958.55,-7793.44 10950.95,-7786.07 10952.29,-7796.58 10958.55,-7793.44"/>
</g>
<!-- ring_stage2_15_13 -->
<g id="node1792" class="node">
<title>ring_stage2_15_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11286,-7785.7 11066,-7785.7 11066,-7732.7 11286,-7732.7 11286,-7785.7"/>
<text text-anchor="middle" x="11176" y="-7770.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="11176" y="-7755.5" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_14×V_14</text>
<text text-anchor="middle" x="11176" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_14_13&#45;&gt;ring_stage2_15_13 -->
<g id="edge2540" class="edge">
<title>ring_stage2_14_13&#45;&gt;ring_stage2_15_13</title>
<path fill="none" stroke="black" d="M11035.62,-7848.52C11062.54,-7831.58 11098.02,-7809.26 11126.58,-7791.29"/>
<polygon fill="black" stroke="black" points="11128.6,-7794.16 11135.2,-7785.87 11124.87,-7788.23 11128.6,-7794.16"/>
</g>
<!-- kv_send2_14_14 -->
<g id="node1777" class="node">
<title>kv_send2_14_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10686" cy="-7617.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="10686" y="-7621" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="10686" y="-7606" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage2_14_14&#45;&gt;kv_send2_14_14 -->
<g id="edge2510" class="edge">
<title>ring_stage2_14_14&#45;&gt;kv_send2_14_14</title>
<path fill="none" stroke="black" d="M10704.78,-7732.53C10701.17,-7710.56 10695.94,-7678.71 10691.91,-7654.2"/>
<polygon fill="black" stroke="black" points="10695.34,-7653.49 10690.27,-7644.19 10688.44,-7654.63 10695.34,-7653.49"/>
</g>
<!-- ring_stage2_15_14 -->
<g id="node1793" class="node">
<title>ring_stage2_15_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11034,-7643.7 10814,-7643.7 10814,-7590.7 11034,-7590.7 11034,-7643.7"/>
<text text-anchor="middle" x="10924" y="-7628.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10924" y="-7613.5" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_15×V_15</text>
<text text-anchor="middle" x="10924" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_14_14&#45;&gt;ring_stage2_15_14 -->
<g id="edge2542" class="edge">
<title>ring_stage2_14_14&#45;&gt;ring_stage2_15_14</title>
<path fill="none" stroke="black" d="M10748.43,-7732.53C10784.5,-7709.04 10837.93,-7674.25 10876.37,-7649.22"/>
<polygon fill="black" stroke="black" points="10878.35,-7652.11 10884.82,-7643.72 10874.53,-7646.24 10878.35,-7652.11"/>
</g>
<!-- kv_send2_14_15 -->
<g id="node1778" class="node">
<title>kv_send2_14_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10277" cy="-7475.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10277" y="-7479" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="10277" y="-7464" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage2_14_15&#45;&gt;kv_send2_14_15 -->
<g id="edge2513" class="edge">
<title>ring_stage2_14_15&#45;&gt;kv_send2_14_15</title>
<path fill="none" stroke="black" d="M10423.99,-7590.53C10393.76,-7567.02 10348.98,-7532.19 10316.79,-7507.15"/>
<polygon fill="black" stroke="black" points="10318.94,-7504.39 10308.9,-7501.01 10314.64,-7509.92 10318.94,-7504.39"/>
</g>
<!-- ring_stage2_15_15 -->
<g id="node1794" class="node">
<title>ring_stage2_15_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10830,-7501.7 10628,-7501.7 10628,-7448.7 10830,-7448.7 10830,-7501.7"/>
<text text-anchor="middle" x="10729" y="-7486.5" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="10729" y="-7471.5" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_0×V_0</text>
<text text-anchor="middle" x="10729" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_14_15&#45;&gt;ring_stage2_15_15 -->
<g id="edge2544" class="edge">
<title>ring_stage2_14_15&#45;&gt;ring_stage2_15_15</title>
<path fill="none" stroke="black" d="M10506.57,-7590.69C10552.64,-7566.98 10621.29,-7531.64 10670.13,-7506.51"/>
<polygon fill="black" stroke="black" points="10672.02,-7509.47 10679.31,-7501.78 10668.82,-7503.24 10672.02,-7509.47"/>
</g>
<!-- kv_send2_14_0&#45;&gt;ring_stage2_15_1 -->
<g id="edge2517" class="edge">
<title>kv_send2_14_0&#45;&gt;ring_stage2_15_1</title>
<path fill="none" stroke="black" d="M9909.74,-7306.2C9910.37,-7284.29 9911.27,-7252.72 9911.97,-7228.36"/>
<polygon fill="black" stroke="black" points="9915.47,-7228.16 9912.26,-7218.07 9908.48,-7227.96 9915.47,-7228.16"/>
</g>
<!-- kv_send2_14_1&#45;&gt;ring_stage2_15_2 -->
<g id="edge2519" class="edge">
<title>kv_send2_14_1&#45;&gt;ring_stage2_15_2</title>
<path fill="none" stroke="black" d="M9034,-7164.2C9034,-7142.29 9034,-7110.72 9034,-7086.36"/>
<polygon fill="black" stroke="black" points="9037.5,-7086.07 9034,-7076.07 9030.5,-7086.07 9037.5,-7086.07"/>
</g>
<!-- kv_send2_14_2&#45;&gt;ring_stage2_15_3 -->
<g id="edge2521" class="edge">
<title>kv_send2_14_2&#45;&gt;ring_stage2_15_3</title>
<path fill="none" stroke="black" d="M8566.39,-7023.17C8594.53,-7000 8636.53,-6965.42 8667.1,-6940.24"/>
<polygon fill="black" stroke="black" points="8669.52,-6942.78 8675.01,-6933.73 8665.07,-6937.38 8669.52,-6942.78"/>
</g>
<!-- kv_send2_14_3&#45;&gt;ring_stage2_15_4 -->
<g id="edge2523" class="edge">
<title>kv_send2_14_3&#45;&gt;ring_stage2_15_4</title>
<path fill="none" stroke="black" d="M9469.39,-6882.93C9515.49,-6859.29 9587.11,-6822.56 9637.68,-6796.62"/>
<polygon fill="black" stroke="black" points="9639.57,-6799.59 9646.87,-6791.91 9636.38,-6793.36 9639.57,-6799.59"/>
</g>
<!-- kv_send2_14_4&#45;&gt;ring_stage2_15_5 -->
<g id="edge2525" class="edge">
<title>kv_send2_14_4&#45;&gt;ring_stage2_15_5</title>
<path fill="none" stroke="black" d="M9936.19,-6738.85C9955.2,-6716.1 9983.24,-6682.54 10004.08,-6657.61"/>
<polygon fill="black" stroke="black" points="10006.85,-6659.76 10010.57,-6649.84 10001.48,-6655.27 10006.85,-6659.76"/>
</g>
<!-- kv_send2_14_5&#45;&gt;ring_stage2_15_6 -->
<g id="edge2527" class="edge">
<title>kv_send2_14_5&#45;&gt;ring_stage2_15_6</title>
<path fill="none" stroke="black" d="M10429.09,-6596.85C10450.79,-6574 10482.85,-6540.25 10506.57,-6515.29"/>
<polygon fill="black" stroke="black" points="10509.29,-6517.5 10513.64,-6507.84 10504.22,-6512.68 10509.29,-6517.5"/>
</g>
<!-- kv_send2_14_6&#45;&gt;ring_stage2_15_7 -->
<g id="edge2529" class="edge">
<title>kv_send2_14_6&#45;&gt;ring_stage2_15_7</title>
<path fill="none" stroke="black" d="M10794.96,-6454.53C10808.94,-6432.03 10829.37,-6399.15 10844.73,-6374.43"/>
<polygon fill="black" stroke="black" points="10847.84,-6376.06 10850.14,-6365.72 10841.89,-6372.37 10847.84,-6376.06"/>
</g>
<!-- kv_send2_14_7&#45;&gt;ring_stage2_15_8 -->
<g id="edge2531" class="edge">
<title>kv_send2_14_7&#45;&gt;ring_stage2_15_8</title>
<path fill="none" stroke="black" d="M11123.28,-6314.3C11161.85,-6290.82 11220.87,-6254.89 11263.04,-6229.22"/>
<polygon fill="black" stroke="black" points="11265.05,-6232.1 11271.77,-6223.91 11261.41,-6226.12 11265.05,-6232.1"/>
</g>
<!-- kv_send2_14_8&#45;&gt;ring_stage2_15_9 -->
<g id="edge2533" class="edge">
<title>kv_send2_14_8&#45;&gt;ring_stage2_15_9</title>
<path fill="none" stroke="black" d="M11747.24,-6170.53C11735.24,-6148.13 11717.73,-6115.44 11704.51,-6090.75"/>
<polygon fill="black" stroke="black" points="11707.48,-6088.88 11699.67,-6081.72 11701.31,-6092.19 11707.48,-6088.88"/>
</g>
<!-- kv_send2_14_9&#45;&gt;ring_stage2_15_10 -->
<g id="edge2535" class="edge">
<title>kv_send2_14_9&#45;&gt;ring_stage2_15_10</title>
<path fill="none" stroke="black" d="M10783,-6028.2C10783,-6006.29 10783,-5974.72 10783,-5950.36"/>
<polygon fill="black" stroke="black" points="10786.5,-5950.07 10783,-5940.07 10779.5,-5950.07 10786.5,-5950.07"/>
</g>
<!-- kv_send2_14_10&#45;&gt;ring_stage2_15_11 -->
<g id="edge2537" class="edge">
<title>kv_send2_14_10&#45;&gt;ring_stage2_15_11</title>
<path fill="none" stroke="black" d="M10420,-5886.2C10420,-5864.29 10420,-5832.72 10420,-5808.36"/>
<polygon fill="black" stroke="black" points="10423.5,-5808.07 10420,-5798.07 10416.5,-5808.07 10423.5,-5808.07"/>
</g>
<!-- kv_send2_14_11&#45;&gt;ring_stage2_15_12 -->
<g id="edge2539" class="edge">
<title>kv_send2_14_11&#45;&gt;ring_stage2_15_12</title>
<path fill="none" stroke="black" d="M11532,-7937.49C11532,-7929.45 11532,-7920.47 11532,-7911.91"/>
<polygon fill="black" stroke="black" points="11535.5,-7911.78 11532,-7901.78 11528.5,-7911.78 11535.5,-7911.78"/>
</g>
<!-- kv_send2_14_12&#45;&gt;ring_stage2_15_13 -->
<g id="edge2541" class="edge">
<title>kv_send2_14_12&#45;&gt;ring_stage2_15_13</title>
<path fill="none" stroke="black" d="M11252.01,-7848.52C11238.11,-7832.37 11219.99,-7811.32 11204.94,-7793.83"/>
<polygon fill="black" stroke="black" points="11207.43,-7791.36 11198.26,-7786.07 11202.13,-7795.93 11207.43,-7791.36"/>
</g>
<!-- kv_send2_14_13&#45;&gt;ring_stage2_15_14 -->
<g id="edge2543" class="edge">
<title>kv_send2_14_13&#45;&gt;ring_stage2_15_14</title>
<path fill="none" stroke="black" d="M10935.4,-7732.2C10933.2,-7710.2 10930.02,-7678.44 10927.58,-7654.03"/>
<polygon fill="black" stroke="black" points="10931.06,-7653.67 10926.59,-7644.07 10924.1,-7654.37 10931.06,-7653.67"/>
</g>
<!-- kv_send2_14_14&#45;&gt;ring_stage2_15_15 -->
<g id="edge2545" class="edge">
<title>kv_send2_14_14&#45;&gt;ring_stage2_15_15</title>
<path fill="none" stroke="black" d="M10693.99,-7590.2C10700.78,-7568.1 10710.59,-7536.16 10718.1,-7511.7"/>
<polygon fill="black" stroke="black" points="10721.47,-7512.66 10721.06,-7502.07 10714.77,-7510.6 10721.47,-7512.66"/>
</g>
<!-- kv_send2_14_15&#45;&gt;ring_stage2_15_0 -->
<g id="edge2515" class="edge">
<title>kv_send2_14_15&#45;&gt;ring_stage2_15_0</title>
<path fill="none" stroke="black" d="M10325.52,-7451.48C10345.44,-7442.26 10368.76,-7431.58 10390,-7422.2 10427.53,-7405.63 10437.71,-7403.31 10475,-7386.2 10489.93,-7379.35 10505.88,-7371.65 10520.74,-7364.32"/>
<polygon fill="black" stroke="black" points="10522.42,-7367.39 10529.82,-7359.81 10519.31,-7361.12 10522.42,-7367.39"/>
</g>
<!-- accum2_0 -->
<g id="node1811" class="node">
<title>accum2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10928.64,-7244.2 10588.79,-7244.2 10501.36,-7138.2 10841.21,-7138.2 10928.64,-7244.2"/>
<text text-anchor="middle" x="10715" y="-7202.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10715" y="-7187.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10715" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage2_15_0&#45;&gt;accum2_0 -->
<g id="edge2546" class="edge">
<title>ring_stage2_15_0&#45;&gt;accum2_0</title>
<path fill="none" stroke="black" d="M10604.76,-7306.53C10619.61,-7291.13 10639.15,-7270.87 10657.64,-7251.68"/>
<polygon fill="black" stroke="black" points="10660.25,-7254.02 10664.67,-7244.4 10655.21,-7249.17 10660.25,-7254.02"/>
</g>
<!-- accum2_1 -->
<g id="node1812" class="node">
<title>accum2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11363.64,-7102.2 11023.79,-7102.2 10936.36,-6996.2 11276.21,-6996.2 11363.64,-7102.2"/>
<text text-anchor="middle" x="11150" y="-7060.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11150" y="-7045.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11150" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage2_15_1&#45;&gt;accum2_1 -->
<g id="edge2555" class="edge">
<title>ring_stage2_15_1&#45;&gt;accum2_1</title>
<path fill="none" stroke="black" d="M9954.76,-7164.7C9973.67,-7154.49 9996.74,-7143.83 10019,-7138.2 10214.98,-7088.61 10727.68,-7129.38 10928,-7102.2 10951.79,-7098.98 10976.76,-7094.36 11001.03,-7089.19"/>
<polygon fill="black" stroke="black" points="11001.98,-7092.57 11011.01,-7087.03 11000.5,-7085.73 11001.98,-7092.57"/>
</g>
<!-- accum2_2 -->
<g id="node1813" class="node">
<title>accum2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9247.64,-6960.2 8907.79,-6960.2 8820.36,-6854.2 9160.21,-6854.2 9247.64,-6960.2"/>
<text text-anchor="middle" x="9034" y="-6918.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="9034" y="-6903.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9034" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage2_15_2&#45;&gt;accum2_2 -->
<g id="edge2564" class="edge">
<title>ring_stage2_15_2&#45;&gt;accum2_2</title>
<path fill="none" stroke="black" d="M9034,-7022.53C9034,-7007.87 9034,-6988.82 9034,-6970.48"/>
<polygon fill="black" stroke="black" points="9037.5,-6970.4 9034,-6960.4 9030.5,-6970.4 9037.5,-6970.4"/>
</g>
<!-- accum2_3 -->
<g id="node1814" class="node">
<title>accum2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9582.64,-6818.2 9242.79,-6818.2 9155.36,-6712.2 9495.21,-6712.2 9582.64,-6818.2"/>
<text text-anchor="middle" x="9369" y="-6776.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="9369" y="-6761.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9369" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage2_15_3&#45;&gt;accum2_3 -->
<g id="edge2573" class="edge">
<title>ring_stage2_15_3&#45;&gt;accum2_3</title>
<path fill="none" stroke="black" d="M8749.05,-6880.59C8767.52,-6870.75 8789.71,-6860.4 8811,-6854.2 8954.77,-6812.33 8998.36,-6843.25 9146,-6818.2 9169.68,-6814.19 9194.61,-6809.17 9218.87,-6803.84"/>
<polygon fill="black" stroke="black" points="9219.86,-6807.21 9228.86,-6801.63 9218.34,-6800.38 9219.86,-6807.21"/>
</g>
<!-- accum2_4 -->
<g id="node1815" class="node">
<title>accum2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9917.64,-6676.2 9577.79,-6676.2 9490.36,-6570.2 9830.21,-6570.2 9917.64,-6676.2"/>
<text text-anchor="middle" x="9704" y="-6634.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="9704" y="-6619.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9704" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage2_15_4&#45;&gt;accum2_4 -->
<g id="edge2582" class="edge">
<title>ring_stage2_15_4&#45;&gt;accum2_4</title>
<path fill="none" stroke="black" d="M9698.28,-6738.53C9699.02,-6723.87 9699.97,-6704.82 9700.89,-6686.48"/>
<polygon fill="black" stroke="black" points="9704.39,-6686.56 9701.39,-6676.4 9697.4,-6686.21 9704.39,-6686.56"/>
</g>
<!-- accum2_5 -->
<g id="node1816" class="node">
<title>accum2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10243.64,-6534.2 9903.79,-6534.2 9816.36,-6428.2 10156.21,-6428.2 10243.64,-6534.2"/>
<text text-anchor="middle" x="10030" y="-6492.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10030" y="-6477.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10030" y="-6462.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage2_15_5&#45;&gt;accum2_5 -->
<g id="edge2591" class="edge">
<title>ring_stage2_15_5&#45;&gt;accum2_5</title>
<path fill="none" stroke="black" d="M10031.63,-6596.53C10031.42,-6581.87 10031.15,-6562.82 10030.89,-6544.48"/>
<polygon fill="black" stroke="black" points="10034.39,-6544.35 10030.75,-6534.4 10027.39,-6544.45 10034.39,-6544.35"/>
</g>
<!-- accum2_6 -->
<g id="node1817" class="node">
<title>accum2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10751.64,-6392.2 10411.79,-6392.2 10324.36,-6286.2 10664.21,-6286.2 10751.64,-6392.2"/>
<text text-anchor="middle" x="10538" y="-6350.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10538" y="-6335.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10538" y="-6320.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage2_15_6&#45;&gt;accum2_6 -->
<g id="edge2600" class="edge">
<title>ring_stage2_15_6&#45;&gt;accum2_6</title>
<path fill="none" stroke="black" d="M10538,-6454.53C10538,-6439.87 10538,-6420.82 10538,-6402.48"/>
<polygon fill="black" stroke="black" points="10541.5,-6402.4 10538,-6392.4 10534.5,-6402.4 10541.5,-6402.4"/>
</g>
<!-- accum2_7 -->
<g id="node1818" class="node">
<title>accum2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11199.64,-6250.2 10859.79,-6250.2 10772.36,-6144.2 11112.21,-6144.2 11199.64,-6250.2"/>
<text text-anchor="middle" x="10986" y="-6208.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10986" y="-6193.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10986" y="-6178.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage2_15_7&#45;&gt;accum2_7 -->
<g id="edge2609" class="edge">
<title>ring_stage2_15_7&#45;&gt;accum2_7</title>
<path fill="none" stroke="black" d="M10888.01,-6312.53C10901.09,-6297.26 10918.27,-6277.22 10934.58,-6258.19"/>
<polygon fill="black" stroke="black" points="10937.41,-6260.27 10941.26,-6250.4 10932.1,-6255.71 10937.41,-6260.27"/>
</g>
<!-- accum2_8 -->
<g id="node1819" class="node">
<title>accum2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11562.64,-6108.2 11222.79,-6108.2 11135.36,-6002.2 11475.21,-6002.2 11562.64,-6108.2"/>
<text text-anchor="middle" x="11349" y="-6066.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11349" y="-6051.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11349" y="-6036.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage2_15_8&#45;&gt;accum2_8 -->
<g id="edge2618" class="edge">
<title>ring_stage2_15_8&#45;&gt;accum2_8</title>
<path fill="none" stroke="black" d="M11320.42,-6170.53C11324.1,-6155.8 11328.89,-6136.64 11333.49,-6118.22"/>
<polygon fill="black" stroke="black" points="11336.92,-6118.95 11335.95,-6108.4 11330.13,-6117.25 11336.92,-6118.95"/>
</g>
<!-- accum2_9 -->
<g id="node1820" class="node">
<title>accum2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11647.64,-5966.2 11307.79,-5966.2 11220.36,-5860.2 11560.21,-5860.2 11647.64,-5966.2"/>
<text text-anchor="middle" x="11434" y="-5924.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11434" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11434" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage2_15_9&#45;&gt;accum2_9 -->
<g id="edge2627" class="edge">
<title>ring_stage2_15_9&#45;&gt;accum2_9</title>
<path fill="none" stroke="black" d="M11640.07,-6028.69C11611.15,-6012.62 11572.62,-5991.21 11536.7,-5971.26"/>
<polygon fill="black" stroke="black" points="11538.07,-5968.02 11527.63,-5966.22 11534.67,-5974.14 11538.07,-5968.02"/>
</g>
<!-- accum2_10 -->
<g id="node1821" class="node">
<title>accum2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11023.64,-5824.2 10683.79,-5824.2 10596.36,-5718.2 10936.21,-5718.2 11023.64,-5824.2"/>
<text text-anchor="middle" x="10810" y="-5782.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10810" y="-5767.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10810" y="-5752.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage2_15_10&#45;&gt;accum2_10 -->
<g id="edge2636" class="edge">
<title>ring_stage2_15_10&#45;&gt;accum2_10</title>
<path fill="none" stroke="black" d="M10787.95,-5886.53C10790.79,-5871.8 10794.49,-5852.64 10798.04,-5834.22"/>
<polygon fill="black" stroke="black" points="10801.48,-5834.88 10799.93,-5824.4 10794.6,-5833.55 10801.48,-5834.88"/>
</g>
<!-- accum2_11 -->
<g id="node1822" class="node">
<title>accum2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10888.64,-5679.2 10548.79,-5679.2 10461.36,-5573.2 10801.21,-5573.2 10888.64,-5679.2"/>
<text text-anchor="middle" x="10675" y="-5637.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="10675" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10675" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage2_15_11&#45;&gt;accum2_11 -->
<g id="edge2645" class="edge">
<title>ring_stage2_15_11&#45;&gt;accum2_11</title>
<path fill="none" stroke="black" d="M10465.59,-5744.64C10495.5,-5727.87 10535.83,-5705.25 10573.11,-5684.34"/>
<polygon fill="black" stroke="black" points="10575.01,-5687.29 10582.02,-5679.35 10571.58,-5681.19 10575.01,-5687.29"/>
</g>
<!-- accum2_12 -->
<g id="node1823" class="node">
<title>accum2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11811.64,-7812.2 11471.79,-7812.2 11384.36,-7706.2 11724.21,-7706.2 11811.64,-7812.2"/>
<text text-anchor="middle" x="11598" y="-7770.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11598" y="-7755.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11598" y="-7740.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage2_15_12&#45;&gt;accum2_12 -->
<g id="edge2654" class="edge">
<title>ring_stage2_15_12&#45;&gt;accum2_12</title>
<path fill="none" stroke="black" d="M11546.81,-7848.52C11551.58,-7840.29 11557.09,-7830.78 11562.69,-7821.12"/>
<polygon fill="black" stroke="black" points="11565.85,-7822.64 11567.84,-7812.24 11559.8,-7819.13 11565.85,-7822.64"/>
</g>
<!-- accum2_13 -->
<g id="node1824" class="node">
<title>accum2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11479.64,-7670.2 11139.79,-7670.2 11052.36,-7564.2 11392.21,-7564.2 11479.64,-7670.2"/>
<text text-anchor="middle" x="11266" y="-7628.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11266" y="-7613.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11266" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage2_15_13&#45;&gt;accum2_13 -->
<g id="edge2663" class="edge">
<title>ring_stage2_15_13&#45;&gt;accum2_13</title>
<path fill="none" stroke="black" d="M11192.51,-7732.53C11202.19,-7717.47 11214.86,-7697.76 11226.95,-7678.95"/>
<polygon fill="black" stroke="black" points="11229.98,-7680.7 11232.45,-7670.4 11224.1,-7676.92 11229.98,-7680.7"/>
</g>
<!-- accum2_14 -->
<g id="node1825" class="node">
<title>accum2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11295.64,-7528.2 10955.79,-7528.2 10868.36,-7422.2 11208.21,-7422.2 11295.64,-7528.2"/>
<text text-anchor="middle" x="11082" y="-7486.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11082" y="-7471.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11082" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage2_15_14&#45;&gt;accum2_14 -->
<g id="edge2672" class="edge">
<title>ring_stage2_15_14&#45;&gt;accum2_14</title>
<path fill="none" stroke="black" d="M10952.98,-7590.53C10970.51,-7574.99 10993.63,-7554.51 11015.44,-7535.18"/>
<polygon fill="black" stroke="black" points="11017.93,-7537.65 11023.1,-7528.4 11013.29,-7532.41 11017.93,-7537.65"/>
</g>
<!-- accum2_15 -->
<g id="node1826" class="node">
<title>accum2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11567.64,-7386.2 11227.79,-7386.2 11140.36,-7280.2 11480.21,-7280.2 11567.64,-7386.2"/>
<text text-anchor="middle" x="11354" y="-7344.5" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="11354" y="-7329.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11354" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage2_15_15&#45;&gt;accum2_15 -->
<g id="edge2681" class="edge">
<title>ring_stage2_15_15&#45;&gt;accum2_15</title>
<path fill="none" stroke="black" d="M10783.96,-7448.69C10806.75,-7439.05 10833.72,-7428.82 10859,-7422.2 10976.97,-7391.32 11011.03,-7408.08 11131,-7386.2 11154.55,-7381.91 11179.35,-7376.76 11203.52,-7371.39"/>
<polygon fill="black" stroke="black" points="11204.48,-7374.77 11213.47,-7369.17 11202.94,-7367.94 11204.48,-7374.77"/>
</g>
<!-- kv_send2_15_0 -->
<g id="node1795" class="node">
<title>kv_send2_15_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11544" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11544" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="11544" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- kv_send2_15_1 -->
<g id="node1796" class="node">
<title>kv_send2_15_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11320" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11320" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="11320" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- kv_send2_15_2 -->
<g id="node1797" class="node">
<title>kv_send2_15_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11096" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11096" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="11096" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- kv_send2_15_3 -->
<g id="node1798" class="node">
<title>kv_send2_15_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10872" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10872" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="10872" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- kv_send2_15_4 -->
<g id="node1799" class="node">
<title>kv_send2_15_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10648" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10648" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="10648" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- kv_send2_15_5 -->
<g id="node1800" class="node">
<title>kv_send2_15_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10424" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10424" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="10424" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- kv_send2_15_6 -->
<g id="node1801" class="node">
<title>kv_send2_15_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="10200" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="10200" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="10200" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- kv_send2_15_7 -->
<g id="node1802" class="node">
<title>kv_send2_15_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9976" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9976" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="9976" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- kv_send2_15_8 -->
<g id="node1803" class="node">
<title>kv_send2_15_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9752" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="9752" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="9752" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- kv_send2_15_9 -->
<g id="node1804" class="node">
<title>kv_send2_15_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9521" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9521" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="9521" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- kv_send2_15_10 -->
<g id="node1805" class="node">
<title>kv_send2_15_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9283" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9283" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="9283" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- kv_send2_15_11 -->
<g id="node1806" class="node">
<title>kv_send2_15_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9045" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="9045" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="9045" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- kv_send2_15_12 -->
<g id="node1807" class="node">
<title>kv_send2_15_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8806" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8806" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="8806" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- kv_send2_15_13 -->
<g id="node1808" class="node">
<title>kv_send2_15_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8565" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8565" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="8565" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- kv_send2_15_14 -->
<g id="node1809" class="node">
<title>kv_send2_15_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8320" cy="-10735.41" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="8320" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="8320" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- kv_send2_15_15 -->
<g id="node1810" class="node">
<title>kv_send2_15_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="8072" cy="-10735.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="8072" y="-10739.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="8072" y="-10724.21" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- out_proj2_0 -->
<g id="node1827" class="node">
<title>out_proj2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11872,-7075.7 11666,-7075.7 11666,-7022.7 11872,-7022.7 11872,-7075.7"/>
<text text-anchor="middle" x="11769" y="-7060.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11769" y="-7045.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11769" y="-7030.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- accum2_0&#45;&gt;out_proj2_0 -->
<g id="edge2547" class="edge">
<title>accum2_0&#45;&gt;out_proj2_0</title>
<path fill="none" stroke="black" d="M10868.64,-7171.16C10955.3,-7160.74 11065.61,-7147.99 11164,-7138.2 11356.16,-7119.09 11407.3,-7138.35 11597,-7102.2 11626.74,-7096.54 11658.66,-7087.69 11686.82,-7078.89"/>
<polygon fill="black" stroke="black" points="11688.14,-7082.15 11696.61,-7075.79 11686.02,-7075.47 11688.14,-7082.15"/>
</g>
<!-- out_proj2_1 -->
<g id="node1828" class="node">
<title>out_proj2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11872,-6933.7 11666,-6933.7 11666,-6880.7 11872,-6880.7 11872,-6933.7"/>
<text text-anchor="middle" x="11769" y="-6918.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11769" y="-6903.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11769" y="-6888.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- accum2_1&#45;&gt;out_proj2_1 -->
<g id="edge2556" class="edge">
<title>accum2_1&#45;&gt;out_proj2_1</title>
<path fill="none" stroke="black" d="M11290.55,-7013.33C11317.8,-7007.16 11346.22,-7001.14 11373,-6996.2 11489.46,-6974.73 11522.42,-6990.12 11637,-6960.2 11659.11,-6954.43 11682.54,-6946.01 11703.42,-6937.62"/>
<polygon fill="black" stroke="black" points="11704.89,-6940.8 11712.82,-6933.78 11702.24,-6934.32 11704.89,-6940.8"/>
</g>
<!-- out_proj2_2 -->
<g id="node1829" class="node">
<title>out_proj2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9137,-6791.7 8931,-6791.7 8931,-6738.7 9137,-6738.7 9137,-6791.7"/>
<text text-anchor="middle" x="9034" y="-6776.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9034" y="-6761.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9034" y="-6746.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- accum2_2&#45;&gt;out_proj2_2 -->
<g id="edge2565" class="edge">
<title>accum2_2&#45;&gt;out_proj2_2</title>
<path fill="none" stroke="black" d="M9034,-6854.07C9034,-6836.77 9034,-6817.9 9034,-6802.1"/>
<polygon fill="black" stroke="black" points="9037.5,-6801.7 9034,-6791.7 9030.5,-6801.7 9037.5,-6801.7"/>
</g>
<!-- out_proj2_3 -->
<g id="node1830" class="node">
<title>out_proj2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9472,-6649.7 9266,-6649.7 9266,-6596.7 9472,-6596.7 9472,-6649.7"/>
<text text-anchor="middle" x="9369" y="-6634.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9369" y="-6619.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9369" y="-6604.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- accum2_3&#45;&gt;out_proj2_3 -->
<g id="edge2574" class="edge">
<title>accum2_3&#45;&gt;out_proj2_3</title>
<path fill="none" stroke="black" d="M9369,-6712.07C9369,-6694.77 9369,-6675.9 9369,-6660.1"/>
<polygon fill="black" stroke="black" points="9372.5,-6659.7 9369,-6649.7 9365.5,-6659.7 9372.5,-6659.7"/>
</g>
<!-- out_proj2_4 -->
<g id="node1831" class="node">
<title>out_proj2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9700,-6507.7 9494,-6507.7 9494,-6454.7 9700,-6454.7 9700,-6507.7"/>
<text text-anchor="middle" x="9597" y="-6492.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9597" y="-6477.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="9597" y="-6462.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- accum2_4&#45;&gt;out_proj2_4 -->
<g id="edge2583" class="edge">
<title>accum2_4&#45;&gt;out_proj2_4</title>
<path fill="none" stroke="black" d="M9664.16,-6570.07C9650.29,-6551.93 9635.12,-6532.08 9622.71,-6515.84"/>
<polygon fill="black" stroke="black" points="9625.34,-6513.52 9616.49,-6507.7 9619.78,-6517.77 9625.34,-6513.52"/>
</g>
<!-- out_proj2_5 -->
<g id="node1832" class="node">
<title>out_proj2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10188,-6365.7 9982,-6365.7 9982,-6312.7 10188,-6312.7 10188,-6365.7"/>
<text text-anchor="middle" x="10085" y="-6350.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10085" y="-6335.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10085" y="-6320.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- accum2_5&#45;&gt;out_proj2_5 -->
<g id="edge2592" class="edge">
<title>accum2_5&#45;&gt;out_proj2_5</title>
<path fill="none" stroke="black" d="M10050.48,-6428.07C10057.41,-6410.43 10064.98,-6391.17 10071.26,-6375.19"/>
<polygon fill="black" stroke="black" points="10074.58,-6376.29 10074.98,-6365.7 10068.07,-6373.73 10074.58,-6376.29"/>
</g>
<!-- out_proj2_6 -->
<g id="node1833" class="node">
<title>out_proj2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10754,-6223.7 10548,-6223.7 10548,-6170.7 10754,-6170.7 10754,-6223.7"/>
<text text-anchor="middle" x="10651" y="-6208.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10651" y="-6193.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="10651" y="-6178.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- accum2_6&#45;&gt;out_proj2_6 -->
<g id="edge2601" class="edge">
<title>accum2_6&#45;&gt;out_proj2_6</title>
<path fill="none" stroke="black" d="M10580.08,-6286.07C10594.72,-6267.93 10610.74,-6248.08 10623.85,-6231.84"/>
<polygon fill="black" stroke="black" points="10626.86,-6233.68 10630.42,-6223.7 10621.41,-6229.29 10626.86,-6233.68"/>
</g>
<!-- out_proj2_7 -->
<g id="node1834" class="node">
<title>out_proj2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11117,-6081.7 10911,-6081.7 10911,-6028.7 11117,-6028.7 11117,-6081.7"/>
<text text-anchor="middle" x="11014" y="-6066.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11014" y="-6051.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11014" y="-6036.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- accum2_7&#45;&gt;out_proj2_7 -->
<g id="edge2610" class="edge">
<title>accum2_7&#45;&gt;out_proj2_7</title>
<path fill="none" stroke="black" d="M10996.43,-6144.07C10999.92,-6126.6 11003.73,-6107.53 11006.91,-6091.64"/>
<polygon fill="black" stroke="black" points="11010.37,-6092.2 11008.9,-6081.7 11003.51,-6090.82 11010.37,-6092.2"/>
</g>
<!-- out_proj2_8 -->
<g id="node1835" class="node">
<title>out_proj2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11872,-5939.7 11666,-5939.7 11666,-5886.7 11872,-5886.7 11872,-5939.7"/>
<text text-anchor="middle" x="11769" y="-5924.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11769" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11769" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- accum2_8&#45;&gt;out_proj2_8 -->
<g id="edge2619" class="edge">
<title>accum2_8&#45;&gt;out_proj2_8</title>
<path fill="none" stroke="black" d="M11491.6,-6021.96C11544.33,-6008.38 11604.1,-5990.98 11657,-5970.7 11676.22,-5963.34 11696.52,-5953.71 11714.48,-5944.49"/>
<polygon fill="black" stroke="black" points="11716.38,-5947.44 11723.63,-5939.72 11713.15,-5941.24 11716.38,-5947.44"/>
</g>
<!-- out_proj2_9 -->
<g id="node1836" class="node">
<title>out_proj2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11705,-5797.7 11499,-5797.7 11499,-5744.7 11705,-5744.7 11705,-5797.7"/>
<text text-anchor="middle" x="11602" y="-5782.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11602" y="-5767.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11602" y="-5752.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- accum2_9&#45;&gt;out_proj2_9 -->
<g id="edge2628" class="edge">
<title>accum2_9&#45;&gt;out_proj2_9</title>
<path fill="none" stroke="black" d="M11496.56,-5860.07C11519.02,-5841.35 11543.68,-5820.8 11563.5,-5804.29"/>
<polygon fill="black" stroke="black" points="11565.96,-5806.79 11571.4,-5797.7 11561.48,-5801.42 11565.96,-5806.79"/>
</g>
<!-- out_proj2_10 -->
<g id="node1837" class="node">
<title>out_proj2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11416,-5652.7 11210,-5652.7 11210,-5599.7 11416,-5599.7 11416,-5652.7"/>
<text text-anchor="middle" x="11313" y="-5637.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11313" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11313" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- accum2_10&#45;&gt;out_proj2_10 -->
<g id="edge2637" class="edge">
<title>accum2_10&#45;&gt;out_proj2_10</title>
<path fill="none" stroke="black" d="M10947.11,-5731.22C11031.19,-5707.32 11136.94,-5677.26 11213.1,-5655.61"/>
<polygon fill="black" stroke="black" points="11214.51,-5658.84 11223.17,-5652.74 11212.6,-5652.11 11214.51,-5658.84"/>
</g>
<!-- out_proj2_11 -->
<g id="node1838" class="node">
<title>out_proj2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11452,-5510.7 11246,-5510.7 11246,-5457.7 11452,-5457.7 11452,-5510.7"/>
<text text-anchor="middle" x="11349" y="-5495.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11349" y="-5480.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11349" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- accum2_11&#45;&gt;out_proj2_11 -->
<g id="edge2646" class="edge">
<title>accum2_11&#45;&gt;out_proj2_11</title>
<path fill="none" stroke="black" d="M10819.59,-5595.17C10944.18,-5569.29 11121.55,-5532.45 11235.97,-5508.68"/>
<polygon fill="black" stroke="black" points="11236.73,-5512.1 11245.81,-5506.64 11235.31,-5505.24 11236.73,-5512.1"/>
</g>
<!-- out_proj2_12 -->
<g id="node1839" class="node">
<title>out_proj2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11812,-7643.7 11606,-7643.7 11606,-7590.7 11812,-7590.7 11812,-7643.7"/>
<text text-anchor="middle" x="11709" y="-7628.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11709" y="-7613.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11709" y="-7598.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- accum2_12&#45;&gt;out_proj2_12 -->
<g id="edge2655" class="edge">
<title>accum2_12&#45;&gt;out_proj2_12</title>
<path fill="none" stroke="black" d="M11639.33,-7706.07C11653.71,-7687.93 11669.46,-7668.08 11682.33,-7651.84"/>
<polygon fill="black" stroke="black" points="11685.31,-7653.71 11688.78,-7643.7 11679.83,-7649.37 11685.31,-7653.71"/>
</g>
<!-- out_proj2_13 -->
<g id="node1840" class="node">
<title>out_proj2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11520,-7501.7 11314,-7501.7 11314,-7448.7 11520,-7448.7 11520,-7501.7"/>
<text text-anchor="middle" x="11417" y="-7486.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11417" y="-7471.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11417" y="-7456.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- accum2_13&#45;&gt;out_proj2_13 -->
<g id="edge2664" class="edge">
<title>accum2_13&#45;&gt;out_proj2_13</title>
<path fill="none" stroke="black" d="M11322.23,-7564.07C11342.33,-7545.43 11364.39,-7524.98 11382.16,-7508.51"/>
<polygon fill="black" stroke="black" points="11384.54,-7511.07 11389.5,-7501.7 11379.78,-7505.94 11384.54,-7511.07"/>
</g>
<!-- out_proj2_14 -->
<g id="node1841" class="node">
<title>out_proj2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11852,-7359.7 11646,-7359.7 11646,-7306.7 11852,-7306.7 11852,-7359.7"/>
<text text-anchor="middle" x="11749" y="-7344.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11749" y="-7329.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11749" y="-7314.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- accum2_14&#45;&gt;out_proj2_14 -->
<g id="edge2673" class="edge">
<title>accum2_14&#45;&gt;out_proj2_14</title>
<path fill="none" stroke="black" d="M11222.53,-7439.24C11249.79,-7433.08 11278.21,-7427.09 11305,-7422.2 11424.97,-7400.33 11457.8,-7411.93 11577,-7386.2 11605.78,-7379.99 11636.71,-7371.29 11664.3,-7362.79"/>
<polygon fill="black" stroke="black" points="11665.41,-7366.11 11673.91,-7359.79 11663.33,-7359.42 11665.41,-7366.11"/>
</g>
<!-- out_proj2_15 -->
<g id="node1842" class="node">
<title>out_proj2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="11852,-7217.7 11646,-7217.7 11646,-7164.7 11852,-7164.7 11852,-7217.7"/>
<text text-anchor="middle" x="11749" y="-7202.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11749" y="-7187.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="11749" y="-7172.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- accum2_15&#45;&gt;out_proj2_15 -->
<g id="edge2682" class="edge">
<title>accum2_15&#45;&gt;out_proj2_15</title>
<path fill="none" stroke="black" d="M11484.98,-7285.78C11545.13,-7264.46 11614.59,-7239.84 11667.17,-7221.21"/>
<polygon fill="black" stroke="black" points="11668.53,-7224.44 11676.79,-7217.8 11666.19,-7217.84 11668.53,-7224.44"/>
</g>
<!-- out_proj2_0&#45;&gt;res_attn2_0 -->
<g id="edge2548" class="edge">
<title>out_proj2_0&#45;&gt;res_attn2_0</title>
<path fill="none" stroke="black" d="M11872.21,-7043.65C12387.5,-7020.26 14657,-6909.11 14657,-6766.2 14657,-6766.2 14657,-6766.2 14657,-6622.2 14657,-6219.48 14425.63,-5994.1 14719,-5718.2 14730.36,-5707.52 15826.68,-5713.14 15842,-5710.2 15872.78,-5704.31 15904.83,-5694.15 15934.44,-5682.93"/>
<polygon fill="black" stroke="black" points="15935.9,-5686.11 15943.97,-5679.25 15933.38,-5679.58 15935.9,-5686.11"/>
</g>
<!-- out_proj2_1&#45;&gt;res_attn2_1 -->
<g id="edge2557" class="edge">
<title>out_proj2_1&#45;&gt;res_attn2_1</title>
<path fill="none" stroke="black" d="M11872.15,-6906.45C12335.25,-6905.59 14219.47,-6880.53 14671,-6534.2 14799.1,-6435.95 14809,-6359.64 14809,-6198.2 14809,-6198.2 14809,-6198.2 14809,-5912.2 14809,-5825.32 14768.03,-5775.88 14833,-5718.2 14842.62,-5709.66 16672.37,-5712.64 16685,-5710.2 16715.39,-5704.35 16747.01,-5694.21 16776.22,-5682.98"/>
<polygon fill="black" stroke="black" points="16777.57,-5686.21 16785.61,-5679.31 16775.02,-5679.69 16777.57,-5686.21"/>
</g>
<!-- out_proj2_2&#45;&gt;res_attn2_2 -->
<g id="edge2566" class="edge">
<title>out_proj2_2&#45;&gt;res_attn2_2</title>
<path fill="none" stroke="black" d="M9070.47,-6738.41C9129.15,-6693.59 9238,-6595.2 9238,-6482.2 9238,-6482.2 9238,-6482.2 9238,-5912.2 9238,-5772.26 9353.72,-5763.87 9486,-5718.2 9536.01,-5700.94 17053.03,-5720.13 17105,-5710.2 17135.49,-5704.38 17167.21,-5694.22 17196.48,-5682.96"/>
<polygon fill="black" stroke="black" points="17197.86,-5686.18 17205.89,-5679.27 17195.3,-5679.66 17197.86,-5686.18"/>
</g>
<!-- out_proj2_3&#45;&gt;res_attn2_3 -->
<g id="edge2575" class="edge">
<title>out_proj2_3&#45;&gt;res_attn2_3</title>
<path fill="none" stroke="black" d="M9376.55,-6596.42C9390.29,-6547.11 9418,-6435.86 9418,-6340.2 9418,-6340.2 9418,-6340.2 9418,-5912.2 9418,-5711.3 10101.28,-5739.99 10301,-5718.2 10353.77,-5712.45 17892.86,-5720.16 17945,-5710.2 17975.49,-5704.38 18007.21,-5694.22 18036.48,-5682.96"/>
<polygon fill="black" stroke="black" points="18037.86,-5686.18 18045.89,-5679.27 18035.3,-5679.66 18037.86,-5686.18"/>
</g>
<!-- out_proj2_4&#45;&gt;res_attn2_4 -->
<g id="edge2584" class="edge">
<title>out_proj2_4&#45;&gt;res_attn2_4</title>
<path fill="none" stroke="black" d="M9493.99,-6455.16C9376.36,-6419.69 9200,-6342.45 9200,-6198.2 9200,-6198.2 9200,-6198.2 9200,-5912.2 9200,-5825.32 9158.94,-5775.78 9224,-5718.2 9233.15,-5710.1 16252.99,-5712.5 16265,-5710.2 16295.49,-5704.38 16327.21,-5694.22 16356.48,-5682.96"/>
<polygon fill="black" stroke="black" points="16357.86,-5686.18 16365.89,-5679.27 16355.3,-5679.66 16357.86,-5686.18"/>
</g>
<!-- out_proj2_5&#45;&gt;res_attn2_5 -->
<g id="edge2593" class="edge">
<title>out_proj2_5&#45;&gt;res_attn2_5</title>
<path fill="none" stroke="black" d="M10087.42,-6312.53C10096.78,-6229.59 10138.63,-5967.97 10301,-5860.2 10366.43,-5816.78 11635.51,-5826.49 11714,-5824.2 13151.05,-5782.34 13509.57,-5743.99 14947,-5718.2 14982.8,-5717.56 17489.84,-5716.96 17525,-5710.2 17555.48,-5704.35 17587.2,-5694.18 17616.47,-5682.92"/>
<polygon fill="black" stroke="black" points="17617.85,-5686.13 17625.88,-5679.23 17615.3,-5679.62 17617.85,-5686.13"/>
</g>
<!-- out_proj2_6&#45;&gt;res_attn2_6 -->
<g id="edge2602" class="edge">
<title>out_proj2_6&#45;&gt;res_attn2_6</title>
<path fill="none" stroke="black" d="M10695.28,-6170.65C10715.29,-6160.44 10739.65,-6149.79 10763,-6144.2 10987.48,-6090.54 11570.63,-6122.31 11801,-6108.2 13239.84,-6020.08 13624.06,-6133.6 15032,-5824.2 15168.07,-5794.3 15189.77,-5742.24 15327,-5718.2 15444.6,-5697.6 19507.74,-5732.65 19625,-5710.2 19655.49,-5704.37 19687.21,-5694.2 19716.48,-5682.94"/>
<polygon fill="black" stroke="black" points="19717.86,-5686.16 19725.89,-5679.25 19715.3,-5679.64 19717.86,-5686.16"/>
</g>
<!-- out_proj2_7&#45;&gt;res_attn2_7 -->
<g id="edge2611" class="edge">
<title>out_proj2_7&#45;&gt;res_attn2_7</title>
<path fill="none" stroke="black" d="M11058.57,-6028.59C11078.53,-6018.43 11102.77,-6007.84 11126,-6002.2 11289.18,-5962.58 11713.25,-5978.27 11881,-5970.7 13222.55,-5910.16 13592.61,-6135.26 14899,-5824.2 15011.65,-5797.38 15023.77,-5742.43 15137,-5718.2 15224.68,-5699.45 18276.94,-5727.09 18365,-5710.2 18395.49,-5704.36 18427.2,-5694.19 18456.47,-5682.93"/>
<polygon fill="black" stroke="black" points="18457.85,-5686.15 18465.89,-5679.24 18455.3,-5679.63 18457.85,-5686.15"/>
</g>
<!-- out_proj2_8&#45;&gt;res_attn2_8 -->
<g id="edge2620" class="edge">
<title>out_proj2_8&#45;&gt;res_attn2_8</title>
<path fill="none" stroke="black" d="M11872.11,-5911.54C12265.65,-5908.56 13710.82,-5893.23 14899,-5824.2 15434.39,-5793.1 15565.24,-5742.27 16101,-5718.2 16161.55,-5715.48 20405.47,-5721.6 20465,-5710.2 20495.49,-5704.37 20527.21,-5694.2 20556.48,-5682.94"/>
<polygon fill="black" stroke="black" points="20557.86,-5686.16 20565.89,-5679.25 20555.3,-5679.64 20557.86,-5686.16"/>
</g>
<!-- out_proj2_9&#45;&gt;res_attn2_9 -->
<g id="edge2629" class="edge">
<title>out_proj2_9&#45;&gt;res_attn2_9</title>
<path fill="none" stroke="black" d="M11705.04,-5768.26C12134.44,-5760.26 13823.91,-5729.76 15213,-5718.2 15262.61,-5717.79 18736.28,-5719.54 18785,-5710.2 18815.49,-5704.36 18847.2,-5694.19 18876.47,-5682.93"/>
<polygon fill="black" stroke="black" points="18877.85,-5686.15 18885.89,-5679.24 18875.3,-5679.64 18877.85,-5686.15"/>
</g>
<!-- out_proj2_10&#45;&gt;res_attn2_10 -->
<g id="edge2638" class="edge">
<title>out_proj2_10&#45;&gt;res_attn2_10</title>
<path fill="none" stroke="black" d="M11416.19,-5646.67C11531.76,-5668.46 11724.92,-5701.53 11893,-5714.2 11928.47,-5716.88 22101.08,-5720.96 22136,-5714.2 22169.87,-5707.65 22205.15,-5695.89 22237.24,-5683.06"/>
<polygon fill="black" stroke="black" points="22238.71,-5686.24 22246.65,-5679.23 22236.07,-5679.76 22238.71,-5686.24"/>
</g>
<!-- out_proj2_11&#45;&gt;res_attn2_11 -->
<g id="edge2647" class="edge">
<title>out_proj2_11&#45;&gt;res_attn2_11</title>
<path fill="none" stroke="black" d="M11452.35,-5498.13C11559.95,-5510.92 11733.48,-5529.63 11884,-5537.2 12426.97,-5564.52 21084.38,-5506.67 21724.49,-5573.33"/>
<polygon fill="black" stroke="black" points="21724.23,-5576.82 21734.56,-5574.47 21725.02,-5569.87 21724.23,-5576.82"/>
</g>
<!-- out_proj2_12&#45;&gt;res_attn2_12 -->
<g id="edge2656" class="edge">
<title>out_proj2_12&#45;&gt;res_attn2_12</title>
<path fill="none" stroke="black" d="M11812.12,-7609.33C12122.71,-7587.73 13075.95,-7514.92 13857,-7386.2 14427.69,-7292.15 14635.88,-7407.7 15127,-7102.2 15315.96,-6984.66 15254.15,-6833.06 15441,-6712.2 16490.07,-6033.65 16951.15,-6314.05 18161,-6002.2 18656.61,-5874.46 18769.29,-5782.81 19277,-5718.2 19332.88,-5711.09 21249.68,-5720.85 21305,-5710.2 21335.48,-5704.34 21367.2,-5694.16 21396.47,-5682.9"/>
<polygon fill="black" stroke="black" points="21397.85,-5686.12 21405.88,-5679.21 21395.29,-5679.6 21397.85,-5686.12"/>
</g>
<!-- out_proj2_13&#45;&gt;res_attn2_13 -->
<g id="edge2665" class="edge">
<title>out_proj2_13&#45;&gt;res_attn2_13</title>
<path fill="none" stroke="black" d="M11520.28,-7473.55C12028.56,-7468.77 14263.78,-7429.22 14861,-7102.2 15016.29,-7017.17 15075,-6943.25 15075,-6766.2 15075,-6766.2 15075,-6766.2 15075,-6338.2 15075,-5962.99 15285.76,-5816.03 15648,-5718.2 15695.69,-5705.32 19156.48,-5719.5 19205,-5710.2 19235.49,-5704.36 19267.2,-5694.19 19296.47,-5682.93"/>
<polygon fill="black" stroke="black" points="19297.85,-5686.15 19305.89,-5679.24 19295.3,-5679.64 19297.85,-5686.15"/>
</g>
<!-- out_proj2_14&#45;&gt;res_attn2_14 -->
<g id="edge2674" class="edge">
<title>out_proj2_14&#45;&gt;res_attn2_14</title>
<path fill="none" stroke="black" d="M11852.19,-7325.61C12185.99,-7303.57 13266.31,-7226.77 14153,-7102.2 14495.01,-7054.15 14598.97,-7094.88 14917,-6960.2 15266.4,-6812.24 15184.49,-6565.8 15441,-6286.2 15729.46,-5971.79 15809.62,-5851.37 16215,-5718.2 16245.81,-5708.08 20853.15,-5716.3 20885,-5710.2 20915.49,-5704.37 20947.21,-5694.2 20976.48,-5682.95"/>
<polygon fill="black" stroke="black" points="20977.86,-5686.16 20985.89,-5679.26 20975.3,-5679.65 20977.86,-5686.16"/>
</g>
<!-- out_proj2_15&#45;&gt;res_attn2_15 -->
<g id="edge2683" class="edge">
<title>out_proj2_15&#45;&gt;res_attn2_15</title>
<path fill="none" stroke="black" d="M11852.44,-7188.31C12418.23,-7176.65 15113,-7103.39 15113,-6766.2 15113,-6766.2 15113,-6766.2 15113,-6338.2 15113,-6151.54 15217.18,-6116.19 15365,-6002.2 15630.23,-5797.69 15734.38,-5782.84 16063,-5718.2 16171.53,-5696.86 19936.36,-5731.01 20045,-5710.2 20075.49,-5704.37 20107.2,-5694.2 20136.48,-5682.94"/>
<polygon fill="black" stroke="black" points="20137.86,-5686.16 20145.89,-5679.25 20135.3,-5679.64 20137.86,-5686.16"/>
</g>
<!-- ffn1_2_0 -->
<g id="node1843" class="node">
<title>ffn1_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22780.5,-5939.7 22581.5,-5939.7 22581.5,-5886.7 22780.5,-5886.7 22780.5,-5939.7"/>
<text text-anchor="middle" x="22681" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="22681" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="22681" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_2_0 -->
<g id="node1859" class="node">
<title>act_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22715,-5790.2 22649,-5790.2 22649,-5752.2 22715,-5752.2 22715,-5790.2"/>
<text text-anchor="middle" x="22682" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22682" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_2_0&#45;&gt;act_2_0 -->
<g id="edge2551" class="edge">
<title>ffn1_2_0&#45;&gt;act_2_0</title>
<path fill="none" stroke="black" d="M22681.18,-5886.53C22681.36,-5862.21 22681.62,-5825.78 22681.8,-5800.61"/>
<polygon fill="black" stroke="black" points="22685.3,-5800.6 22681.87,-5790.58 22678.3,-5800.55 22685.3,-5800.6"/>
</g>
<!-- ffn1_2_1 -->
<g id="node1844" class="node">
<title>ffn1_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23224.5,-5939.7 23025.5,-5939.7 23025.5,-5886.7 23224.5,-5886.7 23224.5,-5939.7"/>
<text text-anchor="middle" x="23125" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23125" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23125" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_2_1 -->
<g id="node1860" class="node">
<title>act_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23161,-5790.2 23095,-5790.2 23095,-5752.2 23161,-5752.2 23161,-5790.2"/>
<text text-anchor="middle" x="23128" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23128" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_2_1&#45;&gt;act_2_1 -->
<g id="edge2560" class="edge">
<title>ffn1_2_1&#45;&gt;act_2_1</title>
<path fill="none" stroke="black" d="M23125.55,-5886.53C23126.07,-5862.21 23126.85,-5825.78 23127.39,-5800.61"/>
<polygon fill="black" stroke="black" points="23130.89,-5800.65 23127.61,-5790.58 23123.89,-5800.5 23130.89,-5800.65"/>
</g>
<!-- ffn1_2_2 -->
<g id="node1845" class="node">
<title>ffn1_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23447.5,-5939.7 23248.5,-5939.7 23248.5,-5886.7 23447.5,-5886.7 23447.5,-5939.7"/>
<text text-anchor="middle" x="23348" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23348" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23348" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_2_2 -->
<g id="node1861" class="node">
<title>act_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23384,-5790.2 23318,-5790.2 23318,-5752.2 23384,-5752.2 23384,-5790.2"/>
<text text-anchor="middle" x="23351" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23351" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_2_2&#45;&gt;act_2_2 -->
<g id="edge2569" class="edge">
<title>ffn1_2_2&#45;&gt;act_2_2</title>
<path fill="none" stroke="black" d="M23348.55,-5886.53C23349.07,-5862.21 23349.85,-5825.78 23350.39,-5800.61"/>
<polygon fill="black" stroke="black" points="23353.89,-5800.65 23350.61,-5790.58 23346.89,-5800.5 23353.89,-5800.65"/>
</g>
<!-- ffn1_2_3 -->
<g id="node1846" class="node">
<title>ffn1_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23895.5,-5939.7 23696.5,-5939.7 23696.5,-5886.7 23895.5,-5886.7 23895.5,-5939.7"/>
<text text-anchor="middle" x="23796" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23796" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23796" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_2_3 -->
<g id="node1862" class="node">
<title>act_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23832,-5790.2 23766,-5790.2 23766,-5752.2 23832,-5752.2 23832,-5790.2"/>
<text text-anchor="middle" x="23799" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23799" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_2_3&#45;&gt;act_2_3 -->
<g id="edge2578" class="edge">
<title>ffn1_2_3&#45;&gt;act_2_3</title>
<path fill="none" stroke="black" d="M23796.55,-5886.53C23797.07,-5862.21 23797.85,-5825.78 23798.39,-5800.61"/>
<polygon fill="black" stroke="black" points="23801.89,-5800.65 23798.61,-5790.58 23794.89,-5800.5 23801.89,-5800.65"/>
</g>
<!-- ffn1_2_4 -->
<g id="node1847" class="node">
<title>ffn1_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23001.5,-5939.7 22802.5,-5939.7 22802.5,-5886.7 23001.5,-5886.7 23001.5,-5939.7"/>
<text text-anchor="middle" x="22902" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="22902" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="22902" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_2_4 -->
<g id="node1863" class="node">
<title>act_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22937,-5790.2 22871,-5790.2 22871,-5752.2 22937,-5752.2 22937,-5790.2"/>
<text text-anchor="middle" x="22904" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22904" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_2_4&#45;&gt;act_2_4 -->
<g id="edge2587" class="edge">
<title>ffn1_2_4&#45;&gt;act_2_4</title>
<path fill="none" stroke="black" d="M22902.37,-5886.53C22902.71,-5862.21 22903.23,-5825.78 22903.59,-5800.61"/>
<polygon fill="black" stroke="black" points="22907.09,-5800.63 22903.74,-5790.58 22900.09,-5800.53 22907.09,-5800.63"/>
</g>
<!-- ffn1_2_5 -->
<g id="node1848" class="node">
<title>ffn1_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23671.5,-5939.7 23472.5,-5939.7 23472.5,-5886.7 23671.5,-5886.7 23671.5,-5939.7"/>
<text text-anchor="middle" x="23572" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23572" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23572" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_2_5 -->
<g id="node1864" class="node">
<title>act_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23608,-5790.2 23542,-5790.2 23542,-5752.2 23608,-5752.2 23608,-5790.2"/>
<text text-anchor="middle" x="23575" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23575" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_2_5&#45;&gt;act_2_5 -->
<g id="edge2596" class="edge">
<title>ffn1_2_5&#45;&gt;act_2_5</title>
<path fill="none" stroke="black" d="M23572.55,-5886.53C23573.07,-5862.21 23573.85,-5825.78 23574.39,-5800.61"/>
<polygon fill="black" stroke="black" points="23577.89,-5800.65 23574.61,-5790.58 23570.89,-5800.5 23577.89,-5800.65"/>
</g>
<!-- ffn1_2_6 -->
<g id="node1849" class="node">
<title>ffn1_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24791.5,-5939.7 24592.5,-5939.7 24592.5,-5886.7 24791.5,-5886.7 24791.5,-5939.7"/>
<text text-anchor="middle" x="24692" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24692" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24692" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_2_6 -->
<g id="node1865" class="node">
<title>act_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24728,-5790.2 24662,-5790.2 24662,-5752.2 24728,-5752.2 24728,-5790.2"/>
<text text-anchor="middle" x="24695" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24695" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_2_6&#45;&gt;act_2_6 -->
<g id="edge2605" class="edge">
<title>ffn1_2_6&#45;&gt;act_2_6</title>
<path fill="none" stroke="black" d="M24692.55,-5886.53C24693.07,-5862.21 24693.85,-5825.78 24694.39,-5800.61"/>
<polygon fill="black" stroke="black" points="24697.89,-5800.65 24694.61,-5790.58 24690.89,-5800.5 24697.89,-5800.65"/>
</g>
<!-- ffn1_2_7 -->
<g id="node1850" class="node">
<title>ffn1_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24119.5,-5939.7 23920.5,-5939.7 23920.5,-5886.7 24119.5,-5886.7 24119.5,-5939.7"/>
<text text-anchor="middle" x="24020" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24020" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24020" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_2_7 -->
<g id="node1866" class="node">
<title>act_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24056,-5790.2 23990,-5790.2 23990,-5752.2 24056,-5752.2 24056,-5790.2"/>
<text text-anchor="middle" x="24023" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24023" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_2_7&#45;&gt;act_2_7 -->
<g id="edge2614" class="edge">
<title>ffn1_2_7&#45;&gt;act_2_7</title>
<path fill="none" stroke="black" d="M24020.55,-5886.53C24021.07,-5862.21 24021.85,-5825.78 24022.39,-5800.61"/>
<polygon fill="black" stroke="black" points="24025.89,-5800.65 24022.61,-5790.58 24018.89,-5800.5 24025.89,-5800.65"/>
</g>
<!-- ffn1_2_8 -->
<g id="node1851" class="node">
<title>ffn1_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25239.5,-5939.7 25040.5,-5939.7 25040.5,-5886.7 25239.5,-5886.7 25239.5,-5939.7"/>
<text text-anchor="middle" x="25140" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25140" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25140" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_2_8 -->
<g id="node1867" class="node">
<title>act_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25176,-5790.2 25110,-5790.2 25110,-5752.2 25176,-5752.2 25176,-5790.2"/>
<text text-anchor="middle" x="25143" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25143" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_2_8&#45;&gt;act_2_8 -->
<g id="edge2623" class="edge">
<title>ffn1_2_8&#45;&gt;act_2_8</title>
<path fill="none" stroke="black" d="M25140.55,-5886.53C25141.07,-5862.21 25141.85,-5825.78 25142.39,-5800.61"/>
<polygon fill="black" stroke="black" points="25145.89,-5800.65 25142.61,-5790.58 25138.89,-5800.5 25145.89,-5800.65"/>
</g>
<!-- ffn1_2_9 -->
<g id="node1852" class="node">
<title>ffn1_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24343.5,-5939.7 24144.5,-5939.7 24144.5,-5886.7 24343.5,-5886.7 24343.5,-5939.7"/>
<text text-anchor="middle" x="24244" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24244" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24244" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_2_9 -->
<g id="node1868" class="node">
<title>act_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24280,-5790.2 24214,-5790.2 24214,-5752.2 24280,-5752.2 24280,-5790.2"/>
<text text-anchor="middle" x="24247" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24247" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_2_9&#45;&gt;act_2_9 -->
<g id="edge2632" class="edge">
<title>ffn1_2_9&#45;&gt;act_2_9</title>
<path fill="none" stroke="black" d="M24244.55,-5886.53C24245.07,-5862.21 24245.85,-5825.78 24246.39,-5800.61"/>
<polygon fill="black" stroke="black" points="24249.89,-5800.65 24246.61,-5790.58 24242.89,-5800.5 24249.89,-5800.65"/>
</g>
<!-- ffn1_2_10 -->
<g id="node1853" class="node">
<title>ffn1_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26135.5,-5939.7 25936.5,-5939.7 25936.5,-5886.7 26135.5,-5886.7 26135.5,-5939.7"/>
<text text-anchor="middle" x="26036" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="26036" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="26036" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_2_10 -->
<g id="node1869" class="node">
<title>act_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26076.5,-5790.2 26001.5,-5790.2 26001.5,-5752.2 26076.5,-5752.2 26076.5,-5790.2"/>
<text text-anchor="middle" x="26039" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="26039" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_2_10&#45;&gt;act_2_10 -->
<g id="edge2641" class="edge">
<title>ffn1_2_10&#45;&gt;act_2_10</title>
<path fill="none" stroke="black" d="M26036.55,-5886.53C26037.07,-5862.21 26037.85,-5825.78 26038.39,-5800.61"/>
<polygon fill="black" stroke="black" points="26041.89,-5800.65 26038.61,-5790.58 26034.89,-5800.5 26041.89,-5800.65"/>
</g>
<!-- ffn1_2_11 -->
<g id="node1854" class="node">
<title>ffn1_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25911.5,-5939.7 25712.5,-5939.7 25712.5,-5886.7 25911.5,-5886.7 25911.5,-5939.7"/>
<text text-anchor="middle" x="25812" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25812" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25812" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_2_11 -->
<g id="node1870" class="node">
<title>act_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25853.5,-5790.2 25778.5,-5790.2 25778.5,-5752.2 25853.5,-5752.2 25853.5,-5790.2"/>
<text text-anchor="middle" x="25816" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25816" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_2_11&#45;&gt;act_2_11 -->
<g id="edge2650" class="edge">
<title>ffn1_2_11&#45;&gt;act_2_11</title>
<path fill="none" stroke="black" d="M25812.73,-5886.53C25813.43,-5862.21 25814.47,-5825.78 25815.19,-5800.61"/>
<polygon fill="black" stroke="black" points="25818.69,-5800.67 25815.48,-5790.58 25811.69,-5800.47 25818.69,-5800.67"/>
</g>
<!-- ffn1_2_12 -->
<g id="node1855" class="node">
<title>ffn1_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25687.5,-5939.7 25488.5,-5939.7 25488.5,-5886.7 25687.5,-5886.7 25687.5,-5939.7"/>
<text text-anchor="middle" x="25588" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25588" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25588" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_2_12 -->
<g id="node1871" class="node">
<title>act_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25629.5,-5790.2 25554.5,-5790.2 25554.5,-5752.2 25629.5,-5752.2 25629.5,-5790.2"/>
<text text-anchor="middle" x="25592" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25592" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_2_12&#45;&gt;act_2_12 -->
<g id="edge2659" class="edge">
<title>ffn1_2_12&#45;&gt;act_2_12</title>
<path fill="none" stroke="black" d="M25588.73,-5886.53C25589.43,-5862.21 25590.47,-5825.78 25591.19,-5800.61"/>
<polygon fill="black" stroke="black" points="25594.69,-5800.67 25591.48,-5790.58 25587.69,-5800.47 25594.69,-5800.67"/>
</g>
<!-- ffn1_2_13 -->
<g id="node1856" class="node">
<title>ffn1_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24567.5,-5939.7 24368.5,-5939.7 24368.5,-5886.7 24567.5,-5886.7 24567.5,-5939.7"/>
<text text-anchor="middle" x="24468" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24468" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24468" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_2_13 -->
<g id="node1872" class="node">
<title>act_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24508.5,-5790.2 24433.5,-5790.2 24433.5,-5752.2 24508.5,-5752.2 24508.5,-5790.2"/>
<text text-anchor="middle" x="24471" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24471" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_2_13&#45;&gt;act_2_13 -->
<g id="edge2668" class="edge">
<title>ffn1_2_13&#45;&gt;act_2_13</title>
<path fill="none" stroke="black" d="M24468.55,-5886.53C24469.07,-5862.21 24469.85,-5825.78 24470.39,-5800.61"/>
<polygon fill="black" stroke="black" points="24473.89,-5800.65 24470.61,-5790.58 24466.89,-5800.5 24473.89,-5800.65"/>
</g>
<!-- ffn1_2_14 -->
<g id="node1857" class="node">
<title>ffn1_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25463.5,-5939.7 25264.5,-5939.7 25264.5,-5886.7 25463.5,-5886.7 25463.5,-5939.7"/>
<text text-anchor="middle" x="25364" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25364" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25364" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_2_14 -->
<g id="node1873" class="node">
<title>act_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25405.5,-5790.2 25330.5,-5790.2 25330.5,-5752.2 25405.5,-5752.2 25405.5,-5790.2"/>
<text text-anchor="middle" x="25368" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25368" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_2_14&#45;&gt;act_2_14 -->
<g id="edge2677" class="edge">
<title>ffn1_2_14&#45;&gt;act_2_14</title>
<path fill="none" stroke="black" d="M25364.73,-5886.53C25365.43,-5862.21 25366.47,-5825.78 25367.19,-5800.61"/>
<polygon fill="black" stroke="black" points="25370.69,-5800.67 25367.48,-5790.58 25363.69,-5800.47 25370.69,-5800.67"/>
</g>
<!-- ffn1_2_15 -->
<g id="node1858" class="node">
<title>ffn1_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25015.5,-5939.7 24816.5,-5939.7 24816.5,-5886.7 25015.5,-5886.7 25015.5,-5939.7"/>
<text text-anchor="middle" x="24916" y="-5924.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24916" y="-5909.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24916" y="-5894.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_2_15 -->
<g id="node1874" class="node">
<title>act_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24956.5,-5790.2 24881.5,-5790.2 24881.5,-5752.2 24956.5,-5752.2 24956.5,-5790.2"/>
<text text-anchor="middle" x="24919" y="-5775" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24919" y="-5760" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_2_15&#45;&gt;act_2_15 -->
<g id="edge2686" class="edge">
<title>ffn1_2_15&#45;&gt;act_2_15</title>
<path fill="none" stroke="black" d="M24916.55,-5886.53C24917.07,-5862.21 24917.85,-5825.78 24918.39,-5800.61"/>
<polygon fill="black" stroke="black" points="24921.89,-5800.65 24918.61,-5790.58 24914.89,-5800.5 24921.89,-5800.65"/>
</g>
<!-- ffn2_2_0 -->
<g id="node1875" class="node">
<title>ffn2_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22786,-5652.7 22580,-5652.7 22580,-5599.7 22786,-5599.7 22786,-5652.7"/>
<text text-anchor="middle" x="22683" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="22683" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22683" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_2_0&#45;&gt;ffn2_2_0 -->
<g id="edge2552" class="edge">
<title>act_2_0&#45;&gt;ffn2_2_0</title>
<path fill="none" stroke="black" d="M22682.13,-5752.09C22682.28,-5729.83 22682.55,-5691.54 22682.75,-5663.21"/>
<polygon fill="black" stroke="black" points="22686.25,-5662.91 22682.82,-5652.89 22679.25,-5662.87 22686.25,-5662.91"/>
</g>
<!-- ffn2_2_1 -->
<g id="node1876" class="node">
<title>ffn2_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23234,-5652.7 23028,-5652.7 23028,-5599.7 23234,-5599.7 23234,-5652.7"/>
<text text-anchor="middle" x="23131" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23131" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23131" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_2_1&#45;&gt;ffn2_2_1 -->
<g id="edge2561" class="edge">
<title>act_2_1&#45;&gt;ffn2_2_1</title>
<path fill="none" stroke="black" d="M23128.38,-5752.09C23128.85,-5729.83 23129.65,-5691.54 23130.24,-5663.21"/>
<polygon fill="black" stroke="black" points="23133.75,-5662.96 23130.46,-5652.89 23126.75,-5662.81 23133.75,-5662.96"/>
</g>
<!-- ffn2_2_2 -->
<g id="node1877" class="node">
<title>ffn2_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23458,-5652.7 23252,-5652.7 23252,-5599.7 23458,-5599.7 23458,-5652.7"/>
<text text-anchor="middle" x="23355" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23355" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23355" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_2_2&#45;&gt;ffn2_2_2 -->
<g id="edge2570" class="edge">
<title>act_2_2&#45;&gt;ffn2_2_2</title>
<path fill="none" stroke="black" d="M23351.51,-5752.09C23352.13,-5729.83 23353.2,-5691.54 23353.99,-5663.21"/>
<polygon fill="black" stroke="black" points="23357.5,-5662.98 23354.28,-5652.89 23350.5,-5662.79 23357.5,-5662.98"/>
</g>
<!-- ffn2_2_3 -->
<g id="node1878" class="node">
<title>ffn2_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23906,-5652.7 23700,-5652.7 23700,-5599.7 23906,-5599.7 23906,-5652.7"/>
<text text-anchor="middle" x="23803" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23803" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23803" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_2_3&#45;&gt;ffn2_2_3 -->
<g id="edge2579" class="edge">
<title>act_2_3&#45;&gt;ffn2_2_3</title>
<path fill="none" stroke="black" d="M23799.51,-5752.09C23800.13,-5729.83 23801.2,-5691.54 23801.99,-5663.21"/>
<polygon fill="black" stroke="black" points="23805.5,-5662.98 23802.28,-5652.89 23798.5,-5662.79 23805.5,-5662.98"/>
</g>
<!-- ffn2_2_4 -->
<g id="node1879" class="node">
<title>ffn2_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23010,-5652.7 22804,-5652.7 22804,-5599.7 23010,-5599.7 23010,-5652.7"/>
<text text-anchor="middle" x="22907" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="22907" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22907" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_2_4&#45;&gt;ffn2_2_4 -->
<g id="edge2588" class="edge">
<title>act_2_4&#45;&gt;ffn2_2_4</title>
<path fill="none" stroke="black" d="M22904.38,-5752.09C22904.85,-5729.83 22905.65,-5691.54 22906.24,-5663.21"/>
<polygon fill="black" stroke="black" points="22909.75,-5662.96 22906.46,-5652.89 22902.75,-5662.81 22909.75,-5662.96"/>
</g>
<!-- ffn2_2_5 -->
<g id="node1880" class="node">
<title>ffn2_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23682,-5652.7 23476,-5652.7 23476,-5599.7 23682,-5599.7 23682,-5652.7"/>
<text text-anchor="middle" x="23579" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23579" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23579" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_2_5&#45;&gt;ffn2_2_5 -->
<g id="edge2597" class="edge">
<title>act_2_5&#45;&gt;ffn2_2_5</title>
<path fill="none" stroke="black" d="M23575.51,-5752.09C23576.13,-5729.83 23577.2,-5691.54 23577.99,-5663.21"/>
<polygon fill="black" stroke="black" points="23581.5,-5662.98 23578.28,-5652.89 23574.5,-5662.79 23581.5,-5662.98"/>
</g>
<!-- ffn2_2_6 -->
<g id="node1881" class="node">
<title>ffn2_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24802,-5652.7 24596,-5652.7 24596,-5599.7 24802,-5599.7 24802,-5652.7"/>
<text text-anchor="middle" x="24699" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24699" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24699" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_2_6&#45;&gt;ffn2_2_6 -->
<g id="edge2606" class="edge">
<title>act_2_6&#45;&gt;ffn2_2_6</title>
<path fill="none" stroke="black" d="M24695.51,-5752.09C24696.13,-5729.83 24697.2,-5691.54 24697.99,-5663.21"/>
<polygon fill="black" stroke="black" points="24701.5,-5662.98 24698.28,-5652.89 24694.5,-5662.79 24701.5,-5662.98"/>
</g>
<!-- ffn2_2_7 -->
<g id="node1882" class="node">
<title>ffn2_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24130,-5652.7 23924,-5652.7 23924,-5599.7 24130,-5599.7 24130,-5652.7"/>
<text text-anchor="middle" x="24027" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24027" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24027" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_2_7&#45;&gt;ffn2_2_7 -->
<g id="edge2615" class="edge">
<title>act_2_7&#45;&gt;ffn2_2_7</title>
<path fill="none" stroke="black" d="M24023.51,-5752.09C24024.13,-5729.83 24025.2,-5691.54 24025.99,-5663.21"/>
<polygon fill="black" stroke="black" points="24029.5,-5662.98 24026.28,-5652.89 24022.5,-5662.79 24029.5,-5662.98"/>
</g>
<!-- ffn2_2_8 -->
<g id="node1883" class="node">
<title>ffn2_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25250,-5652.7 25044,-5652.7 25044,-5599.7 25250,-5599.7 25250,-5652.7"/>
<text text-anchor="middle" x="25147" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25147" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25147" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_2_8&#45;&gt;ffn2_2_8 -->
<g id="edge2624" class="edge">
<title>act_2_8&#45;&gt;ffn2_2_8</title>
<path fill="none" stroke="black" d="M25143.51,-5752.09C25144.13,-5729.83 25145.2,-5691.54 25145.99,-5663.21"/>
<polygon fill="black" stroke="black" points="25149.5,-5662.98 25146.28,-5652.89 25142.5,-5662.79 25149.5,-5662.98"/>
</g>
<!-- ffn2_2_9 -->
<g id="node1884" class="node">
<title>ffn2_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24354,-5652.7 24148,-5652.7 24148,-5599.7 24354,-5599.7 24354,-5652.7"/>
<text text-anchor="middle" x="24251" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24251" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24251" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_2_9&#45;&gt;ffn2_2_9 -->
<g id="edge2633" class="edge">
<title>act_2_9&#45;&gt;ffn2_2_9</title>
<path fill="none" stroke="black" d="M24247.51,-5752.09C24248.13,-5729.83 24249.2,-5691.54 24249.99,-5663.21"/>
<polygon fill="black" stroke="black" points="24253.5,-5662.98 24250.28,-5652.89 24246.5,-5662.79 24253.5,-5662.98"/>
</g>
<!-- ffn2_2_10 -->
<g id="node1885" class="node">
<title>ffn2_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26146,-5652.7 25940,-5652.7 25940,-5599.7 26146,-5599.7 26146,-5652.7"/>
<text text-anchor="middle" x="26043" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="26043" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="26043" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_2_10&#45;&gt;ffn2_2_10 -->
<g id="edge2642" class="edge">
<title>act_2_10&#45;&gt;ffn2_2_10</title>
<path fill="none" stroke="black" d="M26039.51,-5752.09C26040.13,-5729.83 26041.2,-5691.54 26041.99,-5663.21"/>
<polygon fill="black" stroke="black" points="26045.5,-5662.98 26042.28,-5652.89 26038.5,-5662.79 26045.5,-5662.98"/>
</g>
<!-- ffn2_2_11 -->
<g id="node1886" class="node">
<title>ffn2_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25922,-5652.7 25716,-5652.7 25716,-5599.7 25922,-5599.7 25922,-5652.7"/>
<text text-anchor="middle" x="25819" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25819" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25819" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_2_11&#45;&gt;ffn2_2_11 -->
<g id="edge2651" class="edge">
<title>act_2_11&#45;&gt;ffn2_2_11</title>
<path fill="none" stroke="black" d="M25816.38,-5752.09C25816.85,-5729.83 25817.65,-5691.54 25818.24,-5663.21"/>
<polygon fill="black" stroke="black" points="25821.75,-5662.96 25818.46,-5652.89 25814.75,-5662.81 25821.75,-5662.96"/>
</g>
<!-- ffn2_2_12 -->
<g id="node1887" class="node">
<title>ffn2_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25698,-5652.7 25492,-5652.7 25492,-5599.7 25698,-5599.7 25698,-5652.7"/>
<text text-anchor="middle" x="25595" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25595" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25595" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_2_12&#45;&gt;ffn2_2_12 -->
<g id="edge2660" class="edge">
<title>act_2_12&#45;&gt;ffn2_2_12</title>
<path fill="none" stroke="black" d="M25592.38,-5752.09C25592.85,-5729.83 25593.65,-5691.54 25594.24,-5663.21"/>
<polygon fill="black" stroke="black" points="25597.75,-5662.96 25594.46,-5652.89 25590.75,-5662.81 25597.75,-5662.96"/>
</g>
<!-- ffn2_2_13 -->
<g id="node1888" class="node">
<title>ffn2_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24578,-5652.7 24372,-5652.7 24372,-5599.7 24578,-5599.7 24578,-5652.7"/>
<text text-anchor="middle" x="24475" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24475" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24475" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_2_13&#45;&gt;ffn2_2_13 -->
<g id="edge2669" class="edge">
<title>act_2_13&#45;&gt;ffn2_2_13</title>
<path fill="none" stroke="black" d="M24471.51,-5752.09C24472.13,-5729.83 24473.2,-5691.54 24473.99,-5663.21"/>
<polygon fill="black" stroke="black" points="24477.5,-5662.98 24474.28,-5652.89 24470.5,-5662.79 24477.5,-5662.98"/>
</g>
<!-- ffn2_2_14 -->
<g id="node1889" class="node">
<title>ffn2_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25474,-5652.7 25268,-5652.7 25268,-5599.7 25474,-5599.7 25474,-5652.7"/>
<text text-anchor="middle" x="25371" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25371" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25371" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_2_14&#45;&gt;ffn2_2_14 -->
<g id="edge2678" class="edge">
<title>act_2_14&#45;&gt;ffn2_2_14</title>
<path fill="none" stroke="black" d="M25368.38,-5752.09C25368.85,-5729.83 25369.65,-5691.54 25370.24,-5663.21"/>
<polygon fill="black" stroke="black" points="25373.75,-5662.96 25370.46,-5652.89 25366.75,-5662.81 25373.75,-5662.96"/>
</g>
<!-- ffn2_2_15 -->
<g id="node1890" class="node">
<title>ffn2_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25026,-5652.7 24820,-5652.7 24820,-5599.7 25026,-5599.7 25026,-5652.7"/>
<text text-anchor="middle" x="24923" y="-5637.5" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24923" y="-5622.5" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24923" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_2_15&#45;&gt;ffn2_2_15 -->
<g id="edge2687" class="edge">
<title>act_2_15&#45;&gt;ffn2_2_15</title>
<path fill="none" stroke="black" d="M24919.51,-5752.09C24920.13,-5729.83 24921.2,-5691.54 24921.99,-5663.21"/>
<polygon fill="black" stroke="black" points="24925.5,-5662.98 24922.28,-5652.89 24918.5,-5662.79 24925.5,-5662.98"/>
</g>
<!-- res_ffn2_0 -->
<g id="node1907" class="node">
<title>res_ffn2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16256.26,-5537.2 15936.1,-5537.2 15853.74,-5431.2 16173.9,-5431.2 16256.26,-5537.2"/>
<text text-anchor="middle" x="16055" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16055" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16055" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn2_2_0&#45;&gt;res_ffn2_0 -->
<g id="edge2553" class="edge">
<title>ffn2_2_0&#45;&gt;res_ffn2_0</title>
<path fill="none" stroke="black" d="M22638.08,-5599.6C22617.43,-5589.24 22592.19,-5578.49 22568,-5573.2 22228.74,-5499.05 16705.3,-5579.24 16265.41,-5537.01"/>
<polygon fill="black" stroke="black" points="16265.76,-5533.53 16255.44,-5535.93 16265,-5540.49 16265.76,-5533.53"/>
</g>
<!-- res_ffn2_1 -->
<g id="node1908" class="node">
<title>res_ffn2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17096.26,-5537.2 16776.1,-5537.2 16693.74,-5431.2 17013.9,-5431.2 17096.26,-5537.2"/>
<text text-anchor="middle" x="16895" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16895" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16895" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn2_2_1&#45;&gt;res_ffn2_1 -->
<g id="edge2562" class="edge">
<title>ffn2_2_1&#45;&gt;res_ffn2_1</title>
<path fill="none" stroke="black" d="M23087.33,-5599.61C23067.23,-5589.25 23042.64,-5578.5 23019,-5573.2 22701.2,-5502.01 17523.23,-5576.64 17105.42,-5537.01"/>
<polygon fill="black" stroke="black" points="17105.76,-5533.52 17095.44,-5535.92 17105,-5540.48 17105.76,-5533.52"/>
</g>
<!-- res_ffn2_2 -->
<g id="node1909" class="node">
<title>res_ffn2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17516.26,-5537.2 17196.1,-5537.2 17113.74,-5431.2 17433.9,-5431.2 17516.26,-5537.2"/>
<text text-anchor="middle" x="17315" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17315" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17315" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn2_2_2&#45;&gt;res_ffn2_2 -->
<g id="edge2571" class="edge">
<title>ffn2_2_2&#45;&gt;res_ffn2_2</title>
<path fill="none" stroke="black" d="M23311.33,-5599.61C23291.23,-5589.25 23266.64,-5578.5 23243,-5573.2 22935.82,-5504.36 17931.83,-5575.35 17525.4,-5537"/>
<polygon fill="black" stroke="black" points="17525.76,-5533.52 17515.44,-5535.92 17525,-5540.48 17525.76,-5533.52"/>
</g>
<!-- res_ffn2_3 -->
<g id="node1910" class="node">
<title>res_ffn2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18356.26,-5537.2 18036.1,-5537.2 17953.74,-5431.2 18273.9,-5431.2 18356.26,-5537.2"/>
<text text-anchor="middle" x="18155" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18155" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18155" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn2_2_3&#45;&gt;res_ffn2_3 -->
<g id="edge2580" class="edge">
<title>ffn2_2_3&#45;&gt;res_ffn2_3</title>
<path fill="none" stroke="black" d="M23759.33,-5599.62C23739.23,-5589.26 23714.64,-5578.51 23691,-5573.2 23405.1,-5509.06 18750.82,-5572.75 18365.58,-5537.01"/>
<polygon fill="black" stroke="black" points="18365.75,-5533.51 18355.44,-5535.92 18365.01,-5540.47 18365.75,-5533.51"/>
</g>
<!-- res_ffn2_4 -->
<g id="node1911" class="node">
<title>res_ffn2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16676.26,-5537.2 16356.1,-5537.2 16273.74,-5431.2 16593.9,-5431.2 16676.26,-5537.2"/>
<text text-anchor="middle" x="16475" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16475" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16475" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn2_2_4&#45;&gt;res_ffn2_4 -->
<g id="edge2589" class="edge">
<title>ffn2_2_4&#45;&gt;res_ffn2_4</title>
<path fill="none" stroke="black" d="M22863.33,-5599.61C22843.23,-5589.25 22818.64,-5578.5 22795,-5573.2 22466.58,-5499.67 17114.46,-5577.93 16685.43,-5537.01"/>
<polygon fill="black" stroke="black" points="16685.76,-5533.53 16675.44,-5535.93 16685,-5540.48 16685.76,-5533.53"/>
</g>
<!-- res_ffn2_5 -->
<g id="node1912" class="node">
<title>res_ffn2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17936.26,-5537.2 17616.1,-5537.2 17533.74,-5431.2 17853.9,-5431.2 17936.26,-5537.2"/>
<text text-anchor="middle" x="17735" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17735" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17735" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn2_2_5&#45;&gt;res_ffn2_5 -->
<g id="edge2598" class="edge">
<title>ffn2_2_5&#45;&gt;res_ffn2_5</title>
<path fill="none" stroke="black" d="M23535.33,-5599.62C23515.23,-5589.26 23490.64,-5578.5 23467,-5573.2 23170.5,-5506.72 18342.64,-5574.03 17945.65,-5537.02"/>
<polygon fill="black" stroke="black" points="17945.75,-5533.51 17935.44,-5535.92 17945.01,-5540.47 17945.75,-5533.51"/>
</g>
<!-- res_ffn2_6 -->
<g id="node1913" class="node">
<title>res_ffn2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20036.26,-5537.2 19716.1,-5537.2 19633.74,-5431.2 19953.9,-5431.2 20036.26,-5537.2"/>
<text text-anchor="middle" x="19835" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19835" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19835" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn2_2_6&#45;&gt;res_ffn2_6 -->
<g id="edge2607" class="edge">
<title>ffn2_2_6&#45;&gt;res_ffn2_6</title>
<path fill="none" stroke="black" d="M24655.32,-5599.63C24635.23,-5589.28 24610.63,-5578.52 24587,-5573.2 24343.58,-5518.44 20385.75,-5567.62 20045.62,-5536.99"/>
<polygon fill="black" stroke="black" points="20045.75,-5533.49 20035.44,-5535.92 20045.02,-5540.45 20045.75,-5533.49"/>
</g>
<!-- res_ffn2_7 -->
<g id="node1914" class="node">
<title>res_ffn2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18776.26,-5537.2 18456.1,-5537.2 18373.74,-5431.2 18693.9,-5431.2 18776.26,-5537.2"/>
<text text-anchor="middle" x="18575" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18575" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18575" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn2_2_7&#45;&gt;res_ffn2_7 -->
<g id="edge2616" class="edge">
<title>ffn2_2_7&#45;&gt;res_ffn2_7</title>
<path fill="none" stroke="black" d="M23983.33,-5599.62C23963.23,-5589.26 23938.64,-5578.51 23915,-5573.2 23639.7,-5511.4 19158.83,-5571.47 18785.49,-5537"/>
<polygon fill="black" stroke="black" points="18785.75,-5533.5 18775.44,-5535.92 18785.01,-5540.46 18785.75,-5533.5"/>
</g>
<!-- res_ffn2_8 -->
<g id="node1915" class="node">
<title>res_ffn2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20876.26,-5537.2 20556.1,-5537.2 20473.74,-5431.2 20793.9,-5431.2 20876.26,-5537.2"/>
<text text-anchor="middle" x="20675" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20675" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20675" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn2_2_8&#45;&gt;res_ffn2_8 -->
<g id="edge2625" class="edge">
<title>ffn2_2_8&#45;&gt;res_ffn2_8</title>
<path fill="none" stroke="black" d="M25103.32,-5599.64C25083.22,-5589.29 25058.63,-5578.53 25035,-5573.2 24812.82,-5523.13 21203.47,-5565.06 20885.7,-5536.99"/>
<polygon fill="black" stroke="black" points="20885.75,-5533.47 20875.44,-5535.91 20885.02,-5540.43 20885.75,-5533.47"/>
</g>
<!-- res_ffn2_9 -->
<g id="node1916" class="node">
<title>res_ffn2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19196.26,-5537.2 18876.1,-5537.2 18793.74,-5431.2 19113.9,-5431.2 19196.26,-5537.2"/>
<text text-anchor="middle" x="18995" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18995" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18995" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn2_2_9&#45;&gt;res_ffn2_9 -->
<g id="edge2634" class="edge">
<title>ffn2_2_9&#45;&gt;res_ffn2_9</title>
<path fill="none" stroke="black" d="M24207.33,-5599.62C24187.23,-5589.27 24162.64,-5578.51 24139,-5573.2 23874.29,-5513.74 19566.67,-5570.2 19205.39,-5536.98"/>
<polygon fill="black" stroke="black" points="19205.75,-5533.5 19195.44,-5535.92 19205.01,-5540.46 19205.75,-5533.5"/>
</g>
<!-- res_ffn2_10 -->
<g id="node1917" class="node">
<title>res_ffn2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22556.26,-5537.2 22236.1,-5537.2 22153.74,-5431.2 22473.9,-5431.2 22556.26,-5537.2"/>
<text text-anchor="middle" x="22355" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22355" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22355" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn2_2_10&#45;&gt;res_ffn2_10 -->
<g id="edge2643" class="edge">
<title>ffn2_2_10&#45;&gt;res_ffn2_10</title>
<path fill="none" stroke="black" d="M25999.02,-5599.68C25978.96,-5589.4 25954.48,-5578.69 25931,-5573.2 25598.18,-5495.4 23193.29,-5486.33 22526.19,-5485.32"/>
<polygon fill="black" stroke="black" points="22526.02,-5481.82 22516.02,-5485.31 22526.01,-5488.82 22526.02,-5481.82"/>
</g>
<!-- res_ffn2_11 -->
<g id="node1918" class="node">
<title>res_ffn2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22136.26,-5537.2 21816.1,-5537.2 21733.74,-5431.2 22053.9,-5431.2 22136.26,-5537.2"/>
<text text-anchor="middle" x="21935" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21935" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21935" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn2_2_11&#45;&gt;res_ffn2_11 -->
<g id="edge2652" class="edge">
<title>ffn2_2_11&#45;&gt;res_ffn2_11</title>
<path fill="none" stroke="black" d="M25775.32,-5599.66C25755.22,-5589.3 25730.63,-5578.55 25707,-5573.2 25516.61,-5530.15 22427.51,-5561.28 22145.53,-5536.95"/>
<polygon fill="black" stroke="black" points="22145.75,-5533.45 22135.44,-5535.91 22145.03,-5540.42 22145.75,-5533.45"/>
</g>
<!-- res_ffn2_12 -->
<g id="node1919" class="node">
<title>res_ffn2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21716.26,-5537.2 21396.1,-5537.2 21313.74,-5431.2 21633.9,-5431.2 21716.26,-5537.2"/>
<text text-anchor="middle" x="21515" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21515" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21515" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn2_2_12&#45;&gt;res_ffn2_12 -->
<g id="edge2661" class="edge">
<title>ffn2_2_12&#45;&gt;res_ffn2_12</title>
<path fill="none" stroke="black" d="M25551.32,-5599.65C25531.22,-5589.3 25506.63,-5578.54 25483,-5573.2 25282.03,-5527.81 22019.84,-5562.53 21725.63,-5536.97"/>
<polygon fill="black" stroke="black" points="21725.75,-5533.46 21715.44,-5535.91 21725.03,-5540.42 21725.75,-5533.46"/>
</g>
<!-- res_ffn2_13 -->
<g id="node1920" class="node">
<title>res_ffn2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19616.26,-5537.2 19296.1,-5537.2 19213.74,-5431.2 19533.9,-5431.2 19616.26,-5537.2"/>
<text text-anchor="middle" x="19415" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19415" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19415" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn2_2_13&#45;&gt;res_ffn2_13 -->
<g id="edge2670" class="edge">
<title>ffn2_2_13&#45;&gt;res_ffn2_13</title>
<path fill="none" stroke="black" d="M24431.33,-5599.63C24411.23,-5589.27 24386.64,-5578.52 24363,-5573.2 24108.94,-5516.09 19976.38,-5568.91 19625.52,-5536.99"/>
<polygon fill="black" stroke="black" points="19625.75,-5533.49 19615.44,-5535.92 19625.01,-5540.45 19625.75,-5533.49"/>
</g>
<!-- res_ffn2_14 -->
<g id="node1921" class="node">
<title>res_ffn2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21296.26,-5537.2 20976.1,-5537.2 20893.74,-5431.2 21213.9,-5431.2 21296.26,-5537.2"/>
<text text-anchor="middle" x="21095" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21095" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21095" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn2_2_14&#45;&gt;res_ffn2_14 -->
<g id="edge2679" class="edge">
<title>ffn2_2_14&#45;&gt;res_ffn2_14</title>
<path fill="none" stroke="black" d="M25327.32,-5599.64C25307.22,-5589.29 25282.63,-5578.53 25259,-5573.2 25047.43,-5525.47 21611.82,-5563.79 21305.68,-5536.98"/>
<polygon fill="black" stroke="black" points="21305.75,-5533.47 21295.44,-5535.91 21305.02,-5540.43 21305.75,-5533.47"/>
</g>
<!-- res_ffn2_15 -->
<g id="node1922" class="node">
<title>res_ffn2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20456.26,-5537.2 20136.1,-5537.2 20053.74,-5431.2 20373.9,-5431.2 20456.26,-5537.2"/>
<text text-anchor="middle" x="20255" y="-5495.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20255" y="-5480.5" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20255" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn2_2_15&#45;&gt;res_ffn2_15 -->
<g id="edge2688" class="edge">
<title>ffn2_2_15&#45;&gt;res_ffn2_15</title>
<path fill="none" stroke="black" d="M24879.32,-5599.64C24859.22,-5589.28 24834.63,-5578.52 24811,-5573.2 24578.21,-5520.78 20794.78,-5566.33 20465.68,-5536.99"/>
<polygon fill="black" stroke="black" points="20465.75,-5533.48 20455.44,-5535.91 20465.02,-5540.44 20465.75,-5533.48"/>
</g>
<!-- res_attn2_0&#45;&gt;ffn1_2_0 -->
<g id="edge2550" class="edge">
<title>res_attn2_0&#45;&gt;ffn1_2_0</title>
<path fill="none" stroke="black" d="M16178.97,-5679.23C16207.02,-5690.15 16236.84,-5701.1 16265,-5710.2 16460.91,-5773.5 16509.9,-5797.17 16714,-5824.2 17315.24,-5903.85 21808.76,-5911.42 22571.22,-5912.13"/>
<polygon fill="black" stroke="black" points="22571.36,-5915.63 22581.36,-5912.14 22571.37,-5908.63 22571.36,-5915.63"/>
</g>
<!-- res_attn2_0&#45;&gt;res_ffn2_0 -->
<g id="edge2554" class="edge">
<title>res_attn2_0&#45;&gt;res_ffn2_0</title>
<path fill="none" stroke="black" d="M16055,-5573.07C16055,-5564.78 16055,-5556.13 16055,-5547.64"/>
<polygon fill="black" stroke="black" points="16058.5,-5547.38 16055,-5537.38 16051.5,-5547.38 16058.5,-5547.38"/>
</g>
<!-- res_attn2_1&#45;&gt;ffn1_2_1 -->
<g id="edge2559" class="edge">
<title>res_attn2_1&#45;&gt;ffn1_2_1</title>
<path fill="none" stroke="black" d="M17018.97,-5679.23C17047.02,-5690.15 17076.84,-5701.1 17105,-5710.2 17300.91,-5773.5 17349.79,-5798 17554,-5824.2 17854.71,-5862.79 22714.95,-5794.85 23011,-5860.2 23031.53,-5864.74 23052.82,-5873.26 23071.35,-5882.12"/>
<polygon fill="black" stroke="black" points="23069.98,-5885.34 23080.5,-5886.61 23073.07,-5879.06 23069.98,-5885.34"/>
</g>
<!-- res_attn2_1&#45;&gt;res_ffn2_1 -->
<g id="edge2563" class="edge">
<title>res_attn2_1&#45;&gt;res_ffn2_1</title>
<path fill="none" stroke="black" d="M16895,-5573.07C16895,-5564.78 16895,-5556.13 16895,-5547.64"/>
<polygon fill="black" stroke="black" points="16898.5,-5547.38 16895,-5537.38 16891.5,-5547.38 16898.5,-5547.38"/>
</g>
<!-- res_attn2_2&#45;&gt;ffn1_2_2 -->
<g id="edge2568" class="edge">
<title>res_attn2_2&#45;&gt;ffn1_2_2</title>
<path fill="none" stroke="black" d="M17438.97,-5679.23C17467.02,-5690.15 17496.84,-5701.1 17525,-5710.2 17720.91,-5773.5 17769.79,-5797.97 17974,-5824.2 18263.85,-5861.43 22948.65,-5797.17 23234,-5860.2 23254.53,-5864.74 23275.81,-5873.26 23294.35,-5882.12"/>
<polygon fill="black" stroke="black" points="23292.98,-5885.34 23303.49,-5886.62 23296.07,-5879.06 23292.98,-5885.34"/>
</g>
<!-- res_attn2_2&#45;&gt;res_ffn2_2 -->
<g id="edge2572" class="edge">
<title>res_attn2_2&#45;&gt;res_ffn2_2</title>
<path fill="none" stroke="black" d="M17315,-5573.07C17315,-5564.78 17315,-5556.13 17315,-5547.64"/>
<polygon fill="black" stroke="black" points="17318.5,-5547.38 17315,-5537.38 17311.5,-5547.38 17318.5,-5547.38"/>
</g>
<!-- res_attn2_3&#45;&gt;ffn1_2_3 -->
<g id="edge2577" class="edge">
<title>res_attn2_3&#45;&gt;ffn1_2_3</title>
<path fill="none" stroke="black" d="M18278.97,-5679.23C18307.02,-5690.15 18336.84,-5701.1 18365,-5710.2 18560.91,-5773.5 18609.8,-5797.92 18814,-5824.2 19082.18,-5858.73 23416.89,-5802.24 23681,-5860.2 23701.69,-5864.74 23723.15,-5873.27 23741.85,-5882.12"/>
<polygon fill="black" stroke="black" points="23740.56,-5885.39 23751.08,-5886.62 23743.62,-5879.09 23740.56,-5885.39"/>
</g>
<!-- res_attn2_3&#45;&gt;res_ffn2_3 -->
<g id="edge2581" class="edge">
<title>res_attn2_3&#45;&gt;res_ffn2_3</title>
<path fill="none" stroke="black" d="M18155,-5573.07C18155,-5564.78 18155,-5556.13 18155,-5547.64"/>
<polygon fill="black" stroke="black" points="18158.5,-5547.38 18155,-5537.38 18151.5,-5547.38 18158.5,-5547.38"/>
</g>
<!-- res_attn2_4&#45;&gt;ffn1_2_4 -->
<g id="edge2586" class="edge">
<title>res_attn2_4&#45;&gt;ffn1_2_4</title>
<path fill="none" stroke="black" d="M16598.97,-5679.23C16627.02,-5690.15 16656.84,-5701.1 16685,-5710.2 16880.91,-5773.5 16929.78,-5798.02 17134,-5824.2 17445.68,-5864.16 22483.38,-5791.47 22790,-5860.2 22810.13,-5864.72 22830.95,-5873.18 22849.1,-5881.99"/>
<polygon fill="black" stroke="black" points="22847.82,-5885.27 22858.33,-5886.61 22850.95,-5879.01 22847.82,-5885.27"/>
</g>
<!-- res_attn2_4&#45;&gt;res_ffn2_4 -->
<g id="edge2590" class="edge">
<title>res_attn2_4&#45;&gt;res_ffn2_4</title>
<path fill="none" stroke="black" d="M16475,-5573.07C16475,-5564.78 16475,-5556.13 16475,-5547.64"/>
<polygon fill="black" stroke="black" points="16478.5,-5547.38 16475,-5537.38 16471.5,-5547.38 16478.5,-5547.38"/>
</g>
<!-- res_attn2_5&#45;&gt;ffn1_2_5 -->
<g id="edge2595" class="edge">
<title>res_attn2_5&#45;&gt;ffn1_2_5</title>
<path fill="none" stroke="black" d="M17858.97,-5679.23C17887.02,-5690.15 17916.84,-5701.1 17945,-5710.2 18140.91,-5773.5 18189.79,-5797.95 18394,-5824.2 18672.99,-5860.08 23182.24,-5799.95 23457,-5860.2 23477.69,-5864.74 23499.15,-5873.27 23517.85,-5882.12"/>
<polygon fill="black" stroke="black" points="23516.56,-5885.38 23527.08,-5886.62 23519.62,-5879.09 23516.56,-5885.38"/>
</g>
<!-- res_attn2_5&#45;&gt;res_ffn2_5 -->
<g id="edge2599" class="edge">
<title>res_attn2_5&#45;&gt;res_ffn2_5</title>
<path fill="none" stroke="black" d="M17735,-5573.07C17735,-5564.78 17735,-5556.13 17735,-5547.64"/>
<polygon fill="black" stroke="black" points="17738.5,-5547.38 17735,-5537.38 17731.5,-5547.38 17738.5,-5547.38"/>
</g>
<!-- res_attn2_6&#45;&gt;ffn1_2_6 -->
<g id="edge2604" class="edge">
<title>res_attn2_6&#45;&gt;ffn1_2_6</title>
<path fill="none" stroke="black" d="M19958.97,-5679.23C19987.02,-5690.15 20016.84,-5701.1 20045,-5710.2 20240.91,-5773.5 20289.82,-5797.77 20494,-5824.2 20718.97,-5853.32 24355.47,-5811.42 24577,-5860.2 24597.69,-5864.76 24619.15,-5873.29 24637.85,-5882.14"/>
<polygon fill="black" stroke="black" points="24636.55,-5885.4 24647.07,-5886.64 24639.62,-5879.11 24636.55,-5885.4"/>
</g>
<!-- res_attn2_6&#45;&gt;res_ffn2_6 -->
<g id="edge2608" class="edge">
<title>res_attn2_6&#45;&gt;res_ffn2_6</title>
<path fill="none" stroke="black" d="M19835,-5573.07C19835,-5564.78 19835,-5556.13 19835,-5547.64"/>
<polygon fill="black" stroke="black" points="19838.5,-5547.38 19835,-5537.38 19831.5,-5547.38 19838.5,-5547.38"/>
</g>
<!-- res_attn2_7&#45;&gt;ffn1_2_7 -->
<g id="edge2613" class="edge">
<title>res_attn2_7&#45;&gt;ffn1_2_7</title>
<path fill="none" stroke="black" d="M18698.97,-5679.23C18727.02,-5690.15 18756.84,-5701.1 18785,-5710.2 18980.91,-5773.5 19029.8,-5797.89 19234,-5824.2 19491.38,-5857.37 23651.53,-5804.54 23905,-5860.2 23925.69,-5864.75 23947.15,-5873.27 23965.85,-5882.13"/>
<polygon fill="black" stroke="black" points="23964.55,-5885.39 23975.08,-5886.63 23967.62,-5879.1 23964.55,-5885.39"/>
</g>
<!-- res_attn2_7&#45;&gt;res_ffn2_7 -->
<g id="edge2617" class="edge">
<title>res_attn2_7&#45;&gt;res_ffn2_7</title>
<path fill="none" stroke="black" d="M18575,-5573.07C18575,-5564.78 18575,-5556.13 18575,-5547.64"/>
<polygon fill="black" stroke="black" points="18578.5,-5547.38 18575,-5537.38 18571.5,-5547.38 18578.5,-5547.38"/>
</g>
<!-- res_attn2_8&#45;&gt;ffn1_2_8 -->
<g id="edge2622" class="edge">
<title>res_attn2_8&#45;&gt;ffn1_2_8</title>
<path fill="none" stroke="black" d="M20799.26,-5679.31C20827.23,-5690.19 20856.94,-5701.11 20885,-5710.2 21079.63,-5773.26 21128.13,-5797.68 21331,-5824.2 21534.5,-5850.81 24824.59,-5815.98 25025,-5860.2 25045.68,-5864.77 25067.14,-5873.3 25085.85,-5882.15"/>
<polygon fill="black" stroke="black" points="25084.55,-5885.41 25095.07,-5886.65 25087.62,-5879.12 25084.55,-5885.41"/>
</g>
<!-- res_attn2_8&#45;&gt;res_ffn2_8 -->
<g id="edge2626" class="edge">
<title>res_attn2_8&#45;&gt;res_ffn2_8</title>
<path fill="none" stroke="black" d="M20675,-5573.07C20675,-5564.78 20675,-5556.13 20675,-5547.64"/>
<polygon fill="black" stroke="black" points="20678.5,-5547.38 20675,-5537.38 20671.5,-5547.38 20678.5,-5547.38"/>
</g>
<!-- res_attn2_9&#45;&gt;ffn1_2_9 -->
<g id="edge2631" class="edge">
<title>res_attn2_9&#45;&gt;ffn1_2_9</title>
<path fill="none" stroke="black" d="M19118.97,-5679.23C19147.02,-5690.15 19176.84,-5701.1 19205,-5710.2 19400.91,-5773.5 19449.81,-5797.85 19654,-5824.2 19900.57,-5856.02 23886.18,-5806.83 24129,-5860.2 24149.69,-5864.75 24171.15,-5873.28 24189.85,-5882.13"/>
<polygon fill="black" stroke="black" points="24188.55,-5885.39 24199.08,-5886.63 24191.62,-5879.1 24188.55,-5885.39"/>
</g>
<!-- res_attn2_9&#45;&gt;res_ffn2_9 -->
<g id="edge2635" class="edge">
<title>res_attn2_9&#45;&gt;res_ffn2_9</title>
<path fill="none" stroke="black" d="M18995,-5573.07C18995,-5564.78 18995,-5556.13 18995,-5547.64"/>
<polygon fill="black" stroke="black" points="18998.5,-5547.38 18995,-5537.38 18991.5,-5547.38 18998.5,-5547.38"/>
</g>
<!-- res_attn2_10&#45;&gt;ffn1_2_10 -->
<g id="edge2640" class="edge">
<title>res_attn2_10&#45;&gt;ffn1_2_10</title>
<path fill="none" stroke="black" d="M22408.76,-5679.28C22462.37,-5727.33 22549.58,-5795.45 22640,-5824.2 22813.72,-5879.45 25743.02,-5820.81 25921,-5860.2 25941.68,-5864.78 25963.14,-5873.32 25981.84,-5882.17"/>
<polygon fill="black" stroke="black" points="25980.55,-5885.43 25991.07,-5886.66 25983.61,-5879.14 25980.55,-5885.43"/>
</g>
<!-- res_attn2_10&#45;&gt;res_ffn2_10 -->
<g id="edge2644" class="edge">
<title>res_attn2_10&#45;&gt;res_ffn2_10</title>
<path fill="none" stroke="black" d="M22355,-5573.07C22355,-5564.78 22355,-5556.13 22355,-5547.64"/>
<polygon fill="black" stroke="black" points="22358.5,-5547.38 22355,-5537.38 22351.5,-5547.38 22358.5,-5547.38"/>
</g>
<!-- res_attn2_11&#45;&gt;ffn1_2_11 -->
<g id="edge2649" class="edge">
<title>res_attn2_11&#45;&gt;ffn1_2_11</title>
<path fill="none" stroke="black" d="M22037.99,-5679.3C22139.89,-5727.74 22301.81,-5796.46 22451,-5824.2 22805.61,-5890.14 25344.84,-5782.24 25697,-5860.2 25717.68,-5864.78 25739.14,-5873.32 25757.84,-5882.17"/>
<polygon fill="black" stroke="black" points="25756.55,-5885.43 25767.07,-5886.66 25759.61,-5879.14 25756.55,-5885.43"/>
</g>
<!-- res_attn2_11&#45;&gt;res_ffn2_11 -->
<g id="edge2653" class="edge">
<title>res_attn2_11&#45;&gt;res_ffn2_11</title>
<path fill="none" stroke="black" d="M21935,-5573.07C21935,-5564.78 21935,-5556.13 21935,-5547.64"/>
<polygon fill="black" stroke="black" points="21938.5,-5547.38 21935,-5537.38 21931.5,-5547.38 21938.5,-5547.38"/>
</g>
<!-- res_attn2_12&#45;&gt;ffn1_2_12 -->
<g id="edge2658" class="edge">
<title>res_attn2_12&#45;&gt;ffn1_2_12</title>
<path fill="none" stroke="black" d="M21634.47,-5679.29C21754.85,-5728.57 21947.28,-5798.66 22122,-5824.2 22490.44,-5878.07 25109.43,-5779.78 25473,-5860.2 25493.68,-5864.78 25515.14,-5873.31 25533.84,-5882.16"/>
<polygon fill="black" stroke="black" points="25532.55,-5885.43 25543.07,-5886.66 25535.61,-5879.13 25532.55,-5885.43"/>
</g>
<!-- res_attn2_12&#45;&gt;res_ffn2_12 -->
<g id="edge2662" class="edge">
<title>res_attn2_12&#45;&gt;res_ffn2_12</title>
<path fill="none" stroke="black" d="M21515,-5573.07C21515,-5564.78 21515,-5556.13 21515,-5547.64"/>
<polygon fill="black" stroke="black" points="21518.5,-5547.38 21515,-5537.38 21511.5,-5547.38 21518.5,-5547.38"/>
</g>
<!-- res_attn2_13&#45;&gt;ffn1_2_13 -->
<g id="edge2667" class="edge">
<title>res_attn2_13&#45;&gt;ffn1_2_13</title>
<path fill="none" stroke="black" d="M19538.97,-5679.23C19567.02,-5690.15 19596.84,-5701.1 19625,-5710.2 19820.91,-5773.5 19869.81,-5797.81 20074,-5824.2 20309.77,-5854.67 24120.82,-5809.13 24353,-5860.2 24373.69,-5864.75 24395.15,-5873.28 24413.85,-5882.14"/>
<polygon fill="black" stroke="black" points="24412.55,-5885.4 24423.07,-5886.63 24415.62,-5879.11 24412.55,-5885.4"/>
</g>
<!-- res_attn2_13&#45;&gt;res_ffn2_13 -->
<g id="edge2671" class="edge">
<title>res_attn2_13&#45;&gt;res_ffn2_13</title>
<path fill="none" stroke="black" d="M19415,-5573.07C19415,-5564.78 19415,-5556.13 19415,-5547.64"/>
<polygon fill="black" stroke="black" points="19418.5,-5547.38 19415,-5537.38 19411.5,-5547.38 19418.5,-5547.38"/>
</g>
<!-- res_attn2_14&#45;&gt;ffn1_2_14 -->
<g id="edge2676" class="edge">
<title>res_attn2_14&#45;&gt;ffn1_2_14</title>
<path fill="none" stroke="black" d="M21220.74,-5679.24C21348.21,-5728.76 21552.42,-5799.3 21737,-5824.2 22123.74,-5876.39 24867.95,-5776.01 25249,-5860.2 25269.68,-5864.77 25291.14,-5873.31 25309.84,-5882.16"/>
<polygon fill="black" stroke="black" points="25308.55,-5885.42 25319.07,-5886.65 25311.61,-5879.13 25308.55,-5885.42"/>
</g>
<!-- res_attn2_14&#45;&gt;res_ffn2_14 -->
<g id="edge2680" class="edge">
<title>res_attn2_14&#45;&gt;res_ffn2_14</title>
<path fill="none" stroke="black" d="M21095,-5573.07C21095,-5564.78 21095,-5556.13 21095,-5547.64"/>
<polygon fill="black" stroke="black" points="21098.5,-5547.38 21095,-5537.38 21091.5,-5547.38 21098.5,-5547.38"/>
</g>
<!-- res_attn2_15&#45;&gt;ffn1_2_15 -->
<g id="edge2685" class="edge">
<title>res_attn2_15&#45;&gt;ffn1_2_15</title>
<path fill="none" stroke="black" d="M20378.97,-5679.23C20407.02,-5690.15 20436.84,-5701.1 20465,-5710.2 20660.91,-5773.5 20709.82,-5797.73 20914,-5824.2 21128.16,-5851.97 24590.11,-5813.72 24801,-5860.2 24821.68,-5864.76 24843.15,-5873.29 24861.85,-5882.15"/>
<polygon fill="black" stroke="black" points="24860.55,-5885.41 24871.07,-5886.64 24863.62,-5879.12 24860.55,-5885.41"/>
</g>
<!-- res_attn2_15&#45;&gt;res_ffn2_15 -->
<g id="edge2689" class="edge">
<title>res_attn2_15&#45;&gt;res_ffn2_15</title>
<path fill="none" stroke="black" d="M20255,-5573.07C20255,-5564.78 20255,-5556.13 20255,-5547.64"/>
<polygon fill="black" stroke="black" points="20258.5,-5547.38 20255,-5537.38 20251.5,-5547.38 20258.5,-5547.38"/>
</g>
<!-- qkv3_0 -->
<g id="node1923" class="node">
<title>qkv3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15353,-5305.09 15147,-5305.09 15147,-5252.09 15353,-5252.09 15353,-5305.09"/>
<text text-anchor="middle" x="15250" y="-5289.89" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15250" y="-5274.89" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15250" y="-5259.89" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn2_0&#45;&gt;qkv3_0 -->
<g id="edge2690" class="edge">
<title>res_ffn2_0&#45;&gt;qkv3_0</title>
<path fill="none" stroke="black" d="M15871.83,-5431.14C15861.75,-5428.42 15851.76,-5425.76 15842,-5423.2 15675.95,-5379.69 15482.48,-5333.62 15363.11,-5305.73"/>
<polygon fill="black" stroke="black" points="15363.76,-5302.29 15353.22,-5303.43 15362.16,-5309.11 15363.76,-5302.29"/>
</g>
<!-- res_attn3_0 -->
<g id="node2531" class="node">
<title>res_attn3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16256.26,-570 15936.1,-570 15853.74,-464 16173.9,-464 16256.26,-570"/>
<text text-anchor="middle" x="16055" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16055" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16055" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- res_ffn2_0&#45;&gt;res_attn3_0 -->
<g id="edge3445" class="edge">
<title>res_ffn2_0&#45;&gt;res_attn3_0</title>
<path fill="none" stroke="black" d="M16183.31,-5443.04C16210.11,-5435.64 16238.33,-5428.57 16265,-5423.2 16397.08,-5396.63 17469,-5414.32 17469,-5279.59 17469,-5279.59 17469,-5279.59 17469,-4918.63 17469,-4598.66 17545,-4522.69 17545,-4202.71 17545,-4202.71 17545,-4202.71 17545,-2223 17545,-2033.8 17507,-1988.2 17507,-1799 17507,-1799 17507,-1799 17507,-1229 17507,-1155.75 16541.31,-729.1 16185.01,-574.18"/>
<polygon fill="black" stroke="black" points="16186.24,-570.9 16175.68,-570.13 16183.45,-577.32 16186.24,-570.9"/>
</g>
<!-- qkv3_1 -->
<g id="node1924" class="node">
<title>qkv3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15542,-5215.35 15336,-5215.35 15336,-5162.35 15542,-5162.35 15542,-5215.35"/>
<text text-anchor="middle" x="15439" y="-5200.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15439" y="-5185.15" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15439" y="-5170.15" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn2_1&#45;&gt;qkv3_1 -->
<g id="edge2691" class="edge">
<title>res_ffn2_1&#45;&gt;qkv3_1</title>
<path fill="none" stroke="black" d="M16717.15,-5431.15C16706.3,-5428.36 16695.52,-5425.69 16685,-5423.2 16271,-5325.52 15771.89,-5242.32 15552.18,-5207.42"/>
<polygon fill="black" stroke="black" points="15552.67,-5203.95 15542.24,-5205.84 15551.57,-5210.87 15552.67,-5203.95"/>
</g>
<!-- res_attn3_1 -->
<g id="node2532" class="node">
<title>res_attn3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17096.26,-570 16776.1,-570 16693.74,-464 17013.9,-464 17096.26,-570"/>
<text text-anchor="middle" x="16895" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16895" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16895" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- res_ffn2_1&#45;&gt;res_attn3_1 -->
<g id="edge3454" class="edge">
<title>res_ffn2_1&#45;&gt;res_attn3_1</title>
<path fill="none" stroke="black" d="M17025.09,-5445.5C17051.5,-5437.99 17079.12,-5430.25 17105,-5423.2 17350.42,-5356.35 17659,-5533.95 17659,-5279.59 17659,-5279.59 17659,-5279.59 17659,-4559.67 17659,-4081.66 17622,-3962.8 17622,-3484.79 17622,-3484.79 17622,-3484.79 17622,-3123.83 17622,-3005.07 17621,-2975.38 17621,-2856.61 17621,-2856.61 17621,-2856.61 17621,-803 17621,-715.46 17653.56,-665.86 17587,-609 17576.82,-600.3 17118.13,-603.61 17105,-601 17074.82,-594.99 17043.4,-584.86 17014.34,-573.71"/>
<polygon fill="black" stroke="black" points="17015.58,-570.43 17004.99,-570.05 17013.03,-576.95 17015.58,-570.43"/>
</g>
<!-- qkv3_2 -->
<g id="node1925" class="node">
<title>qkv3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15590,-5125.61 15384,-5125.61 15384,-5072.61 15590,-5072.61 15590,-5125.61"/>
<text text-anchor="middle" x="15487" y="-5110.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15487" y="-5095.41" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15487" y="-5080.41" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn2_2&#45;&gt;qkv3_2 -->
<g id="edge2692" class="edge">
<title>res_ffn2_2&#45;&gt;qkv3_2</title>
<path fill="none" stroke="black" d="M17136.54,-5431.15C17125.89,-5428.37 17115.32,-5425.7 17105,-5423.2 16544.63,-5287.44 15865.17,-5165.43 15600.34,-5119.47"/>
<polygon fill="black" stroke="black" points="15600.78,-5116 15590.33,-5117.74 15599.59,-5122.9 15600.78,-5116"/>
</g>
<!-- res_attn3_2 -->
<g id="node2533" class="node">
<title>res_attn3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17516.26,-570 17196.1,-570 17113.74,-464 17433.9,-464 17516.26,-570"/>
<text text-anchor="middle" x="17315" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17315" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17315" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- res_ffn2_2&#45;&gt;res_attn3_2 -->
<g id="edge3463" class="edge">
<title>res_ffn2_2&#45;&gt;res_attn3_2</title>
<path fill="none" stroke="black" d="M17444.65,-5444.97C17471.16,-5437.49 17498.92,-5429.89 17525,-5423.2 17579.31,-5409.27 17605.01,-5431.19 17648,-5395.2 17724.01,-5331.58 17735,-5288.97 17735,-5189.85 17735,-5189.85 17735,-5189.85 17735,-1371 17735,-1199.78 17745.96,-726.05 17621,-609 17605.38,-594.37 17545.84,-605.88 17525,-601 17496.28,-594.28 17466.3,-584.34 17438.28,-573.66"/>
<polygon fill="black" stroke="black" points="17439.45,-570.35 17428.86,-570.01 17436.92,-576.88 17439.45,-570.35"/>
</g>
<!-- qkv3_3 -->
<g id="node1926" class="node">
<title>qkv3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15796,-5035.87 15590,-5035.87 15590,-4982.87 15796,-4982.87 15796,-5035.87"/>
<text text-anchor="middle" x="15693" y="-5020.67" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15693" y="-5005.67" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15693" y="-4990.67" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn2_3&#45;&gt;qkv3_3 -->
<g id="edge2693" class="edge">
<title>res_ffn2_3&#45;&gt;qkv3_3</title>
<path fill="none" stroke="black" d="M18009.98,-5431.18C17904.42,-5393.54 17775.49,-5348.16 17749,-5341.46 17020.2,-5157.1 16118.94,-5053.8 15806.16,-5021.51"/>
<polygon fill="black" stroke="black" points="15806.49,-5018.02 15796.18,-5020.48 15805.77,-5024.99 15806.49,-5018.02"/>
</g>
<!-- res_attn3_3 -->
<g id="node2534" class="node">
<title>res_attn3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18356.26,-570 18036.1,-570 17953.74,-464 18273.9,-464 18356.26,-570"/>
<text text-anchor="middle" x="18155" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18155" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18155" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- res_ffn2_3&#45;&gt;res_attn3_3 -->
<g id="edge3472" class="edge">
<title>res_ffn2_3&#45;&gt;res_attn3_3</title>
<path fill="none" stroke="black" d="M18033.75,-5431.09C18016.89,-5420.71 18000.69,-5408.76 17987,-5395.2 17945.57,-5354.18 17925,-5337.9 17925,-5279.59 17925,-5279.59 17925,-5279.59 17925,-4918.63 17925,-4719.79 17900,-4670.78 17900,-4471.93 17900,-4471.93 17900,-4471.93 17900,-4380.19 17900,-4141.77 17897,-4082.17 17897,-3843.75 17897,-3843.75 17897,-3843.75 17897,-3034.09 17897,-2737.57 17887,-2663.52 17887,-2367 17887,-2367 17887,-2367 17887,-803 17887,-706 17919.11,-678.29 17987,-609 17999.03,-596.72 18013.08,-585.68 18027.83,-575.89"/>
<polygon fill="black" stroke="black" points="18030.06,-578.61 18036.58,-570.26 18026.28,-572.72 18030.06,-578.61"/>
</g>
<!-- qkv3_4 -->
<g id="node1927" class="node">
<title>qkv3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12974,-4946.13 12768,-4946.13 12768,-4893.13 12974,-4893.13 12974,-4946.13"/>
<text text-anchor="middle" x="12871" y="-4930.93" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12871" y="-4915.93" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12871" y="-4900.93" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn2_4&#45;&gt;qkv3_4 -->
<g id="edge2694" class="edge">
<title>res_ffn2_4&#45;&gt;qkv3_4</title>
<path fill="none" stroke="black" d="M16306.46,-5431.17C16292.52,-5428.05 16278.58,-5425.33 16265,-5423.2 16239.79,-5419.26 12612.53,-5321.88 12593,-5305.46 12552.83,-5271.69 12569,-5242.33 12569,-5189.85 12569,-5189.85 12569,-5189.85 12569,-5098.11 12569,-5007.06 12672.31,-4961.8 12758.08,-4939.92"/>
<polygon fill="black" stroke="black" points="12759.04,-4943.29 12767.91,-4937.49 12757.37,-4936.49 12759.04,-4943.29"/>
</g>
<!-- res_attn3_4 -->
<g id="node2535" class="node">
<title>res_attn3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16676.26,-570 16356.1,-570 16273.74,-464 16593.9,-464 16676.26,-570"/>
<text text-anchor="middle" x="16475" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16475" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16475" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- res_ffn2_4&#45;&gt;res_attn3_4 -->
<g id="edge3481" class="edge">
<title>res_ffn2_4&#45;&gt;res_attn3_4</title>
<path fill="none" stroke="black" d="M16602.53,-5442.02C16629.52,-5434.65 16658,-5427.85 16685,-5423.2 16860.36,-5393.04 17358.53,-5438.22 17477,-5305.46 17490.9,-5289.89 17583,-4582.54 17583,-4561.67 17583,-4561.67 17583,-4561.67 17583,-2081 17583,-1639.79 17545,-1530.21 17545,-1089 17545,-1089 17545,-1089 17545,-803 17545,-606.69 16872.34,-659.68 16685,-601 16659.59,-593.04 16632.89,-583.47 16607.36,-573.69"/>
<polygon fill="black" stroke="black" points="16608.61,-570.42 16598.02,-570.08 16606.09,-576.95 16608.61,-570.42"/>
</g>
<!-- qkv3_5 -->
<g id="node1928" class="node">
<title>qkv3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12619,-4856.39 12413,-4856.39 12413,-4803.39 12619,-4803.39 12619,-4856.39"/>
<text text-anchor="middle" x="12516" y="-4841.19" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12516" y="-4826.19" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12516" y="-4811.19" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn2_5&#45;&gt;qkv3_5 -->
<g id="edge2695" class="edge">
<title>res_ffn2_5&#45;&gt;qkv3_5</title>
<path fill="none" stroke="black" d="M17566.76,-5431.14C17552.73,-5428.02 17538.68,-5425.3 17525,-5423.2 16154.34,-5212.89 15792.32,-5373.86 14406,-5341.46 14357.28,-5340.32 12690.61,-5335.19 12652,-5305.46 12512.53,-5198.09 12509.31,-4957.58 12513.49,-4866.64"/>
<polygon fill="black" stroke="black" points="12516.99,-4866.73 12514.01,-4856.56 12510,-4866.36 12516.99,-4866.73"/>
</g>
<!-- res_attn3_5 -->
<g id="node2536" class="node">
<title>res_attn3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17936.26,-570 17616.1,-570 17533.74,-464 17853.9,-464 17936.26,-570"/>
<text text-anchor="middle" x="17735" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17735" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17735" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- res_ffn2_5&#45;&gt;res_attn3_5 -->
<g id="edge3490" class="edge">
<title>res_ffn2_5&#45;&gt;res_attn3_5</title>
<path fill="none" stroke="black" d="M17748.94,-5431.17C17770.88,-5344.55 17811,-5165.02 17811,-5010.37 17811,-5010.37 17811,-5010.37 17811,-1087 17811,-901.33 17770.75,-684.56 17748.83,-580.29"/>
<polygon fill="black" stroke="black" points="17752.2,-579.3 17746.71,-570.25 17745.36,-580.76 17752.2,-579.3"/>
</g>
<!-- qkv3_6 -->
<g id="node1929" class="node">
<title>qkv3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14803,-4766.65 14597,-4766.65 14597,-4713.65 14803,-4713.65 14803,-4766.65"/>
<text text-anchor="middle" x="14700" y="-4751.45" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14700" y="-4736.45" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14700" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn2_6&#45;&gt;qkv3_6 -->
<g id="edge2696" class="edge">
<title>res_ffn2_6&#45;&gt;qkv3_6</title>
<path fill="none" stroke="black" d="M19667.35,-5431.19C19653.12,-5428.04 19638.87,-5425.3 19625,-5423.2 19331.8,-5379 18582.88,-5447.39 18291,-5395.2 18153.51,-5370.62 17697,-5329.52 17697,-5189.85 17697,-5189.85 17697,-5189.85 17697,-5098.11 17697,-4990.01 17586.47,-5013.8 17483,-4982.5 16652.48,-4731.32 16404.5,-4864.38 15539,-4803.02 15219.61,-4780.38 15134.17,-4810.96 14813.06,-4767.06"/>
<polygon fill="black" stroke="black" points="14813.39,-4763.57 14803.01,-4765.67 14812.44,-4770.5 14813.39,-4763.57"/>
</g>
<!-- res_attn3_6 -->
<g id="node2537" class="node">
<title>res_attn3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20456.26,-570 20136.1,-570 20053.74,-464 20373.9,-464 20456.26,-570"/>
<text text-anchor="middle" x="20255" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20255" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20255" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- res_ffn2_6&#45;&gt;res_attn3_6 -->
<g id="edge3499" class="edge">
<title>res_ffn2_6&#45;&gt;res_attn3_6</title>
<path fill="none" stroke="black" d="M19667.35,-5431.2C19653.12,-5428.04 19638.87,-5425.3 19625,-5423.2 19553.79,-5412.44 18384.37,-5441.26 18329,-5395.2 18288.66,-5361.64 18305,-5332.07 18305,-5279.59 18305,-5279.59 18305,-5279.59 18305,-4380.19 18305,-4098.08 18409,-4036.13 18409,-3754.01 18409,-3754.01 18409,-3754.01 18409,-3662.27 18409,-3543.51 18410,-3513.82 18410,-3395.05 18410,-3395.05 18410,-3395.05 18410,-1371 18410,-1182.51 18419,-1135.49 18419,-947 18419,-947 18419,-947 18419,-803 18419,-620.94 19868.6,-646.04 20045,-601 20072.69,-593.93 20101.64,-584.15 20128.89,-573.79"/>
<polygon fill="black" stroke="black" points="20130.38,-576.97 20138.45,-570.1 20127.86,-570.43 20130.38,-576.97"/>
</g>
<!-- qkv3_7 -->
<g id="node1930" class="node">
<title>qkv3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12623,-4676.91 12417,-4676.91 12417,-4623.91 12623,-4623.91 12623,-4676.91"/>
<text text-anchor="middle" x="12520" y="-4661.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12520" y="-4646.71" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12520" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn2_7&#45;&gt;qkv3_7 -->
<g id="edge2697" class="edge">
<title>res_ffn2_7&#45;&gt;qkv3_7</title>
<path fill="none" stroke="black" d="M18408.54,-5431.2C18393.92,-5427.99 18379.26,-5425.24 18365,-5423.2 18286.45,-5412.01 12725.53,-5425.02 12652,-5395.2 12476.62,-5324.08 12345,-5289.37 12345,-5100.11 12345,-5100.11 12345,-5100.11 12345,-4828.89 12345,-4762.56 12407.75,-4712.03 12458.1,-4682.16"/>
<polygon fill="black" stroke="black" points="12460.11,-4685.04 12467.02,-4677 12456.61,-4678.98 12460.11,-4685.04"/>
</g>
<!-- res_attn3_7 -->
<g id="node2538" class="node">
<title>res_attn3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18776.26,-570 18456.1,-570 18373.74,-464 18693.9,-464 18776.26,-570"/>
<text text-anchor="middle" x="18575" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18575" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18575" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- res_ffn2_7&#45;&gt;res_attn3_7 -->
<g id="edge3508" class="edge">
<title>res_ffn2_7&#45;&gt;res_attn3_7</title>
<path fill="none" stroke="black" d="M18400.76,-5431.2C18388.71,-5428.29 18376.7,-5425.59 18365,-5423.2 18194.58,-5388.52 18001,-5453.51 18001,-5279.59 18001,-5279.59 18001,-5279.59 18001,-803 18001,-716.12 17960.59,-667.3 18025,-609 18039.01,-596.32 18346.48,-604.75 18365,-601 18395.08,-594.9 18426.39,-584.78 18455.38,-573.65"/>
<polygon fill="black" stroke="black" points="18456.67,-576.91 18464.71,-570.01 18454.12,-570.39 18456.67,-576.91"/>
</g>
<!-- qkv3_8 -->
<g id="node1931" class="node">
<title>qkv3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14339,-4587.17 14133,-4587.17 14133,-4534.17 14339,-4534.17 14339,-4587.17"/>
<text text-anchor="middle" x="14236" y="-4571.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14236" y="-4556.97" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14236" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn2_8&#45;&gt;qkv3_8 -->
<g id="edge2698" class="edge">
<title>res_ffn2_8&#45;&gt;qkv3_8</title>
<path fill="none" stroke="black" d="M20507.65,-5431.14C20493.33,-5427.98 20478.97,-5425.26 20465,-5423.2 20238.52,-5389.91 18628.02,-5446.82 18405,-5395.2 18132.05,-5332.03 18082.44,-5257.4 17835,-5125.98 17724.57,-5067.33 17708.09,-5031.37 17593,-4982.5 17009.04,-4734.57 16302.52,-4699.23 15470,-4623.54 14980.2,-4579.01 14852.51,-4644.46 14364,-4587.54 14359.19,-4586.98 14354.28,-4586.33 14349.34,-4585.62"/>
<polygon fill="black" stroke="black" points="14349.57,-4582.11 14339.16,-4584.06 14348.51,-4589.03 14349.57,-4582.11"/>
</g>
<!-- res_attn3_8 -->
<g id="node2539" class="node">
<title>res_attn3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20876.26,-570 20556.1,-570 20473.74,-464 20793.9,-464 20876.26,-570"/>
<text text-anchor="middle" x="20675" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20675" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20675" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn2_8&#45;&gt;res_attn3_8 -->
<g id="edge3517" class="edge">
<title>res_ffn2_8&#45;&gt;res_attn3_8</title>
<path fill="none" stroke="black" d="M20501.07,-5431.15C20488.92,-5428.24 20476.81,-5425.55 20465,-5423.2 20411.69,-5412.59 20266.97,-5425.74 20222,-5395.2 20173.77,-5362.44 20160,-5337.9 20160,-5279.59 20160,-5279.59 20160,-5279.59 20160,-803 20160,-697.19 20205.15,-659.75 20298,-609 20314.3,-600.09 20446.84,-604.91 20465,-601 20494.44,-594.66 20525.12,-584.65 20553.64,-573.75"/>
<polygon fill="black" stroke="black" points="20555.18,-576.91 20563.23,-570.02 20552.64,-570.38 20555.18,-576.91"/>
</g>
<!-- qkv3_9 -->
<g id="node1932" class="node">
<title>qkv3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12674,-4497.43 12468,-4497.43 12468,-4444.43 12674,-4444.43 12674,-4497.43"/>
<text text-anchor="middle" x="12571" y="-4482.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12571" y="-4467.23" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12571" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn2_9&#45;&gt;qkv3_9 -->
<g id="edge2699" class="edge">
<title>res_ffn2_9&#45;&gt;qkv3_9</title>
<path fill="none" stroke="black" d="M18828.54,-5431.19C18813.92,-5427.98 18799.26,-5425.23 18785,-5423.2 18740.37,-5416.85 12327.91,-5423.73 12293,-5395.2 12252.37,-5361.99 12269,-5332.07 12269,-5279.59 12269,-5279.59 12269,-5279.59 12269,-4649.41 12269,-4558.36 12372.31,-4513.1 12458.08,-4491.22"/>
<polygon fill="black" stroke="black" points="12459.04,-4494.59 12467.91,-4488.79 12457.37,-4487.79 12459.04,-4494.59"/>
</g>
<!-- res_attn3_9 -->
<g id="node2540" class="node">
<title>res_attn3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19616.26,-570 19296.1,-570 19213.74,-464 19533.9,-464 19616.26,-570"/>
<text text-anchor="middle" x="19415" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19415" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19415" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn2_9&#45;&gt;res_attn3_9 -->
<g id="edge3526" class="edge">
<title>res_ffn2_9&#45;&gt;res_attn3_9</title>
<path fill="none" stroke="black" d="M18825.56,-5431.18C18811.92,-5428.1 18798.28,-5425.38 18785,-5423.2 18718.26,-5412.29 18228.46,-5439.08 18177,-5395.2 18137.07,-5361.15 18153,-5332.07 18153,-5279.59 18153,-5279.59 18153,-5279.59 18153,-4021.23 18153,-3222.73 18191,-3023.5 18191,-2225 18191,-2225 18191,-2225 18191,-803 18191,-737.46 18266.42,-770.47 18329,-751 18579.52,-673.05 18642.01,-644.22 18902,-609 18968.75,-599.96 19139,-614.47 19205,-601 19234.85,-594.91 19265.93,-584.86 19294.74,-573.83"/>
<polygon fill="black" stroke="black" points="19296.38,-576.95 19304.42,-570.05 19293.83,-570.43 19296.38,-576.95"/>
</g>
<!-- qkv3_10 -->
<g id="node1933" class="node">
<title>qkv3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15147,-4407.69 14941,-4407.69 14941,-4354.69 15147,-4354.69 15147,-4407.69"/>
<text text-anchor="middle" x="15044" y="-4392.49" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15044" y="-4377.49" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15044" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn2_10&#45;&gt;qkv3_10 -->
<g id="edge2700" class="edge">
<title>res_ffn2_10&#45;&gt;qkv3_10</title>
<path fill="none" stroke="black" d="M22181.36,-5431.18C22169.11,-5428.26 22156.9,-5425.56 22145,-5423.2 21334.62,-5263.08 21118.87,-5308.12 20298,-5215.72 19237.08,-5096.31 18964.34,-5120.53 17911,-4946.5 16879.09,-4776.01 16646.61,-4597.32 15612,-4444.06 15411.34,-4414.34 15357.52,-4438.78 15157,-4408.06 15156.9,-4408.05 15156.79,-4408.03 15156.69,-4408.01"/>
<polygon fill="black" stroke="black" points="15157.47,-4404.6 15147.03,-4406.43 15156.34,-4411.5 15157.47,-4404.6"/>
</g>
<!-- res_attn3_10 -->
<g id="node2541" class="node">
<title>res_attn3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22136.26,-570 21816.1,-570 21733.74,-464 22053.9,-464 22136.26,-570"/>
<text text-anchor="middle" x="21935" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21935" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21935" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn2_10&#45;&gt;res_attn3_10 -->
<g id="edge3535" class="edge">
<title>res_ffn2_10&#45;&gt;res_attn3_10</title>
<path fill="none" stroke="black" d="M22257.44,-5431.12C22206.23,-5396.06 22154,-5344.41 22154,-5279.59 22154,-5279.59 22154,-5279.59 22154,-5187.85 22154,-5066.42 22097,-5042.07 22097,-4920.63 22097,-4920.63 22097,-4920.63 22097,-3303.31 22097,-3104.75 22090,-3055.17 22090,-2856.61 22090,-2856.61 22090,-2856.61 22090,-2764.87 22090,-2461.32 22051,-2386.55 22051,-2083 22051,-2083 22051,-2083 22051,-1797 22051,-1608.56 22050,-1561.44 22050,-1373 22050,-1373 22050,-1373 22050,-803 22050,-720.95 22008.51,-634.64 21975.37,-578.79"/>
<polygon fill="black" stroke="black" points="21978.29,-576.86 21970.13,-570.1 21972.29,-580.47 21978.29,-576.86"/>
</g>
<!-- qkv3_11 -->
<g id="node1934" class="node">
<title>qkv3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12279,-4317.95 12073,-4317.95 12073,-4264.95 12279,-4264.95 12279,-4317.95"/>
<text text-anchor="middle" x="12176" y="-4302.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12176" y="-4287.75" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12176" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn2_11&#45;&gt;qkv3_11 -->
<g id="edge2701" class="edge">
<title>res_ffn2_11&#45;&gt;qkv3_11</title>
<path fill="none" stroke="black" d="M21768.54,-5431.17C21753.92,-5427.97 21739.27,-5425.22 21725,-5423.2 21475.46,-5387.86 12900.68,-5436.16 12652,-5395.2 12492.44,-5368.93 12307,-5441.31 12307,-5279.59 12307,-5279.59 12307,-5279.59 12307,-5098.11 12307,-4974.64 12231,-4954.37 12231,-4830.89 12231,-4830.89 12231,-4830.89 12231,-4469.93 12231,-4418.63 12209.77,-4362.57 12193.69,-4327.46"/>
<polygon fill="black" stroke="black" points="12196.73,-4325.7 12189.31,-4318.14 12190.4,-4328.68 12196.73,-4325.7"/>
</g>
<!-- res_attn3_11 -->
<g id="node2542" class="node">
<title>res_attn3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22556.26,-570 22236.1,-570 22153.74,-464 22473.9,-464 22556.26,-570"/>
<text text-anchor="middle" x="22355" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22355" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22355" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn2_11&#45;&gt;res_attn3_11 -->
<g id="edge3544" class="edge">
<title>res_ffn2_11&#45;&gt;res_attn3_11</title>
<path fill="none" stroke="black" d="M22019.94,-5431.13C22066.96,-5395.2 22116,-5342.62 22116,-5279.59 22116,-5279.59 22116,-5279.59 22116,-5187.85 22116,-5068.79 22135,-5039.7 22135,-4920.63 22135,-4920.63 22135,-4920.63 22135,-3213.57 22135,-2900.18 22163,-2822.39 22163,-2509 22163,-2509 22163,-2509 22163,-2081 22163,-1889.55 22239,-1848.45 22239,-1657 22239,-1657 22239,-1657 22239,-945 22239,-811.02 22292.84,-661.4 22327.16,-579.64"/>
<polygon fill="black" stroke="black" points="22330.56,-580.59 22331.25,-570.02 22324.12,-577.86 22330.56,-580.59"/>
</g>
<!-- qkv3_12 -->
<g id="node1935" class="node">
<title>qkv3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14402,-4228.21 14196,-4228.21 14196,-4175.21 14402,-4175.21 14402,-4228.21"/>
<text text-anchor="middle" x="14299" y="-4213.01" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14299" y="-4198.01" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14299" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn2_12&#45;&gt;qkv3_12 -->
<g id="edge2702" class="edge">
<title>res_ffn2_12&#45;&gt;qkv3_12</title>
<path fill="none" stroke="black" d="M21341.06,-5431.2C21328.91,-5428.28 21316.8,-5425.58 21305,-5423.2 20208,-5202.75 19915.98,-5259.2 18805,-5125.98 18592.53,-5100.51 17849,-5224.37 17849,-5010.37 17849,-5010.37 17849,-5010.37 17849,-4739.15 17849,-4280.2 16294.16,-4323.41 15839,-4264.58 15209.81,-4183.26 15041.46,-4307.77 14412,-4228.58 14411.9,-4228.57 14411.79,-4228.56 14411.69,-4228.54"/>
<polygon fill="black" stroke="black" points="14412.39,-4225.11 14402,-4227.19 14411.42,-4232.04 14412.39,-4225.11"/>
</g>
<!-- res_attn3_12 -->
<g id="node2543" class="node">
<title>res_attn3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21296.26,-570 20976.1,-570 20893.74,-464 21213.9,-464 21296.26,-570"/>
<text text-anchor="middle" x="21095" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21095" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21095" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn2_12&#45;&gt;res_attn3_12 -->
<g id="edge3553" class="edge">
<title>res_ffn2_12&#45;&gt;res_attn3_12</title>
<path fill="none" stroke="black" d="M21339.56,-5431.19C21327.9,-5428.32 21316.31,-5425.63 21305,-5423.2 21086.98,-5376.51 20312,-5502.56 20312,-5279.59 20312,-5279.59 20312,-5279.59 20312,-803 20312,-706 20329.6,-660.19 20412,-609 20434.32,-595.13 20859.23,-606.14 20885,-601 20915.18,-594.99 20946.6,-584.86 20975.66,-573.7"/>
<polygon fill="black" stroke="black" points="20976.97,-576.95 20985.01,-570.04 20974.42,-570.43 20976.97,-576.95"/>
</g>
<!-- qkv3_13 -->
<g id="node1936" class="node">
<title>qkv3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15829,-5652.7 15623,-5652.7 15623,-5599.7 15829,-5599.7 15829,-5652.7"/>
<text text-anchor="middle" x="15726" y="-5637.5" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15726" y="-5622.5" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15726" y="-5607.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn2_13&#45;&gt;qkv3_13 -->
<g id="edge2703" class="edge">
<title>res_ffn2_13&#45;&gt;qkv3_13</title>
<path fill="none" stroke="black" d="M19284.54,-5522.47C19258.4,-5528.53 19230.99,-5533.89 19205,-5537.2 18834.31,-5584.43 16207,-5493.09 15842,-5573.2 15821.07,-5577.8 15799.32,-5586.39 15780.4,-5595.28"/>
<polygon fill="black" stroke="black" points="15778.83,-5592.16 15771.35,-5599.66 15781.87,-5598.46 15778.83,-5592.16"/>
</g>
<!-- res_attn3_13 -->
<g id="node2544" class="node">
<title>res_attn3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19196.26,-570 18876.1,-570 18793.74,-464 19113.9,-464 19196.26,-570"/>
<text text-anchor="middle" x="18995" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18995" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18995" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn2_13&#45;&gt;res_attn3_13 -->
<g id="edge3562" class="edge">
<title>res_ffn2_13&#45;&gt;res_attn3_13</title>
<path fill="none" stroke="black" d="M19246.46,-5431.15C19232.53,-5428.04 19218.58,-5425.32 19205,-5423.2 19105.27,-5407.66 18388.76,-5437.26 18297,-5395.2 18233.63,-5366.16 18191,-5349.3 18191,-5279.59 18191,-5279.59 18191,-5279.59 18191,-4021.23 18191,-3899.8 18134,-3875.45 18134,-3754.01 18134,-3754.01 18134,-3754.01 18134,-3123.83 18134,-3005.05 18129,-2975.4 18129,-2856.61 18129,-2856.61 18129,-2856.61 18129,-2764.87 18129,-2588.04 18127,-2543.83 18127,-2367 18127,-2367 18127,-2367 18127,-1513 18127,-1173.61 17992.78,-1036.05 18177,-751 18249.95,-638.12 18313.98,-643.05 18444,-609 18517.33,-589.8 18710.71,-616.05 18785,-601 18815.08,-594.91 18846.39,-584.78 18875.38,-573.65"/>
<polygon fill="black" stroke="black" points="18876.67,-576.91 18884.71,-570.01 18874.12,-570.39 18876.67,-576.91"/>
</g>
<!-- qkv3_14 -->
<g id="node1937" class="node">
<title>qkv3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14471,-5510.7 14265,-5510.7 14265,-5457.7 14471,-5457.7 14471,-5510.7"/>
<text text-anchor="middle" x="14368" y="-5495.5" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14368" y="-5480.5" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14368" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn2_14&#45;&gt;qkv3_14 -->
<g id="edge2704" class="edge">
<title>res_ffn2_14&#45;&gt;qkv3_14</title>
<path fill="none" stroke="black" d="M20971.58,-5531.66C20940.81,-5541.41 20907.58,-5550.21 20876,-5555.2 20738.13,-5576.99 15990.54,-5558.54 15851,-5555.2 15339.5,-5542.97 14729.61,-5507.02 14481.43,-5491.49"/>
<polygon fill="black" stroke="black" points="14481.52,-5487.99 14471.32,-5490.85 14481.08,-5494.97 14481.52,-5487.99"/>
</g>
<!-- res_attn3_14 -->
<g id="node2545" class="node">
<title>res_attn3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21716.26,-570 21396.1,-570 21313.74,-464 21633.9,-464 21716.26,-570"/>
<text text-anchor="middle" x="21515" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21515" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21515" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn2_14&#45;&gt;res_attn3_14 -->
<g id="edge3571" class="edge">
<title>res_ffn2_14&#45;&gt;res_attn3_14</title>
<path fill="none" stroke="black" d="M20925.26,-5431.19C20911.72,-5428.12 20898.18,-5425.4 20885,-5423.2 20825.08,-5413.24 20387.55,-5431.71 20339,-5395.2 20227.44,-5311.32 20350,-5012.64 20350,-4920.63 20350,-4920.63 20350,-4920.63 20350,-3841.75 20350,-3402.64 20425,-3295.72 20425,-2856.61 20425,-2856.61 20425,-2856.61 20425,-2081 20425,-1892.56 20426,-1845.44 20426,-1657 20426,-1657 20426,-1657 20426,-803 20426,-602.58 21113.59,-660.45 21305,-601 21331.34,-592.82 21359.07,-582.86 21385.42,-572.73"/>
<polygon fill="black" stroke="black" points="21387.01,-575.87 21395.07,-568.99 21384.48,-569.34 21387.01,-575.87"/>
</g>
<!-- qkv3_15 -->
<g id="node1938" class="node">
<title>qkv3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13343,-5394.83 13137,-5394.83 13137,-5341.83 13343,-5341.83 13343,-5394.83"/>
<text text-anchor="middle" x="13240" y="-5379.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13240" y="-5364.63" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13240" y="-5349.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn2_15&#45;&gt;qkv3_15 -->
<g id="edge2705" class="edge">
<title>res_ffn2_15&#45;&gt;qkv3_15</title>
<path fill="none" stroke="black" d="M20088.24,-5431.18C20073.72,-5427.99 20059.17,-5425.24 20045,-5423.2 19872.39,-5398.33 14226.79,-5373.5 13353.09,-5369.81"/>
<polygon fill="black" stroke="black" points="13353.04,-5366.31 13343.03,-5369.76 13353.01,-5373.31 13353.04,-5366.31"/>
</g>
<!-- res_attn3_15 -->
<g id="node2546" class="node">
<title>res_attn3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20036.26,-570 19716.1,-570 19633.74,-464 19953.9,-464 20036.26,-570"/>
<text text-anchor="middle" x="19835" y="-528.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19835" y="-513.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19835" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn2_15&#45;&gt;res_attn3_15 -->
<g id="edge3580" class="edge">
<title>res_ffn2_15&#45;&gt;res_attn3_15</title>
<path fill="none" stroke="black" d="M20082.87,-5431.14C20070.12,-5428.17 20057.4,-5425.48 20045,-5423.2 19858.33,-5389 18343,-5469.38 18343,-5279.59 18343,-5279.59 18343,-5279.59 18343,-803 18343,-759.93 18398.01,-675.39 18596,-609 18650.2,-590.82 19568.88,-611.91 19625,-601 19655.38,-595.09 19687,-584.93 19716.2,-573.71"/>
<polygon fill="black" stroke="black" points="19717.56,-576.93 19725.59,-570.03 19715,-570.42 19717.56,-576.93"/>
</g>
<!-- ring_stage3_0_0 -->
<g id="node1939" class="node">
<title>ring_stage3_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14869.5,-5215.35 14676.5,-5215.35 14676.5,-5162.35 14869.5,-5162.35 14869.5,-5215.35"/>
<text text-anchor="middle" x="14773" y="-5200.15" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="14773" y="-5185.15" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_0×V_0</text>
<text text-anchor="middle" x="14773" y="-5170.15" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv3_0&#45;&gt;ring_stage3_0_0 -->
<g id="edge2706" class="edge">
<title>qkv3_0&#45;&gt;ring_stage3_0_0</title>
<path fill="none" stroke="black" d="M15146.79,-5258.61C15067.85,-5244.09 14959.36,-5224.13 14879.59,-5209.46"/>
<polygon fill="black" stroke="black" points="14879.98,-5205.97 14869.51,-5207.61 14878.72,-5212.86 14879.98,-5205.97"/>
</g>
<!-- ring_stage3_0_1 -->
<g id="node1940" class="node">
<title>ring_stage3_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15087.5,-5125.61 14894.5,-5125.61 14894.5,-5072.61 15087.5,-5072.61 15087.5,-5125.61"/>
<text text-anchor="middle" x="14991" y="-5110.41" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="14991" y="-5095.41" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_1×V_1</text>
<text text-anchor="middle" x="14991" y="-5080.41" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv3_1&#45;&gt;ring_stage3_0_1 -->
<g id="edge2707" class="edge">
<title>qkv3_1&#45;&gt;ring_stage3_0_1</title>
<path fill="none" stroke="black" d="M15335.94,-5167.67C15264.62,-5153.7 15169.95,-5135.16 15097.83,-5121.04"/>
<polygon fill="black" stroke="black" points="15098.3,-5117.56 15087.81,-5119.07 15096.95,-5124.43 15098.3,-5117.56"/>
</g>
<!-- ring_stage3_0_2 -->
<g id="node1941" class="node">
<title>ring_stage3_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15344.5,-5035.87 15151.5,-5035.87 15151.5,-4982.87 15344.5,-4982.87 15344.5,-5035.87"/>
<text text-anchor="middle" x="15248" y="-5020.67" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="15248" y="-5005.67" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_2×V_2</text>
<text text-anchor="middle" x="15248" y="-4990.67" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv3_2&#45;&gt;ring_stage3_0_2 -->
<g id="edge2708" class="edge">
<title>qkv3_2&#45;&gt;ring_stage3_0_2</title>
<path fill="none" stroke="black" d="M15417.23,-5072.5C15389.13,-5062.18 15356.56,-5050.23 15327.55,-5039.58"/>
<polygon fill="black" stroke="black" points="15328.45,-5036.18 15317.86,-5036.02 15326.04,-5042.75 15328.45,-5036.18"/>
</g>
<!-- ring_stage3_0_3 -->
<g id="node1942" class="node">
<title>ring_stage3_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15562.5,-4946.13 15369.5,-4946.13 15369.5,-4893.13 15562.5,-4893.13 15562.5,-4946.13"/>
<text text-anchor="middle" x="15466" y="-4930.93" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="15466" y="-4915.93" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_3×V_3</text>
<text text-anchor="middle" x="15466" y="-4900.93" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv3_3&#45;&gt;ring_stage3_0_3 -->
<g id="edge2709" class="edge">
<title>qkv3_3&#45;&gt;ring_stage3_0_3</title>
<path fill="none" stroke="black" d="M15626.73,-4982.76C15600.16,-4972.49 15569.38,-4960.59 15541.92,-4949.98"/>
<polygon fill="black" stroke="black" points="15542.94,-4946.62 15532.35,-4946.28 15540.42,-4953.15 15542.94,-4946.62"/>
</g>
<!-- ring_stage3_0_4 -->
<g id="node1943" class="node">
<title>ring_stage3_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13078.5,-4856.39 12885.5,-4856.39 12885.5,-4803.39 13078.5,-4803.39 13078.5,-4856.39"/>
<text text-anchor="middle" x="12982" y="-4841.19" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="12982" y="-4826.19" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_4×V_4</text>
<text text-anchor="middle" x="12982" y="-4811.19" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv3_4&#45;&gt;ring_stage3_0_4 -->
<g id="edge2710" class="edge">
<title>qkv3_4&#45;&gt;ring_stage3_0_4</title>
<path fill="none" stroke="black" d="M12903.4,-4893.02C12915.27,-4883.64 12928.84,-4872.91 12941.34,-4863.03"/>
<polygon fill="black" stroke="black" points="12943.69,-4865.64 12949.36,-4856.69 12939.35,-4860.15 12943.69,-4865.64"/>
</g>
<!-- ring_stage3_0_5 -->
<g id="node1944" class="node">
<title>ring_stage3_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12860.5,-4766.65 12667.5,-4766.65 12667.5,-4713.65 12860.5,-4713.65 12860.5,-4766.65"/>
<text text-anchor="middle" x="12764" y="-4751.45" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="12764" y="-4736.45" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_5×V_5</text>
<text text-anchor="middle" x="12764" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv3_5&#45;&gt;ring_stage3_0_5 -->
<g id="edge2711" class="edge">
<title>qkv3_5&#45;&gt;ring_stage3_0_5</title>
<path fill="none" stroke="black" d="M12588.4,-4803.28C12617.68,-4792.92 12651.64,-4780.9 12681.85,-4770.22"/>
<polygon fill="black" stroke="black" points="12683.25,-4773.43 12691.51,-4766.8 12680.92,-4766.83 12683.25,-4773.43"/>
</g>
<!-- ring_stage3_0_6 -->
<g id="node1945" class="node">
<title>ring_stage3_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13878.5,-4676.91 13685.5,-4676.91 13685.5,-4623.91 13878.5,-4623.91 13878.5,-4676.91"/>
<text text-anchor="middle" x="13782" y="-4661.71" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13782" y="-4646.71" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_6×V_6</text>
<text text-anchor="middle" x="13782" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv3_6&#45;&gt;ring_stage3_0_6 -->
<g id="edge2712" class="edge">
<title>qkv3_6&#45;&gt;ring_stage3_0_6</title>
<path fill="none" stroke="black" d="M14596.99,-4714.65C14593.97,-4714.16 14590.96,-4713.7 14588,-4713.28 14285.23,-4670.71 14204.04,-4717.89 13901,-4677.28 13896.87,-4676.73 13892.68,-4676.11 13888.45,-4675.43"/>
<polygon fill="black" stroke="black" points="13888.98,-4671.97 13878.54,-4673.77 13887.82,-4678.88 13888.98,-4671.97"/>
</g>
<!-- ring_stage3_0_7 -->
<g id="node1946" class="node">
<title>ring_stage3_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13449.5,-4587.17 13256.5,-4587.17 13256.5,-4534.17 13449.5,-4534.17 13449.5,-4587.17"/>
<text text-anchor="middle" x="13353" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13353" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_7×V_7</text>
<text text-anchor="middle" x="13353" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv3_7&#45;&gt;ring_stage3_0_7 -->
<g id="edge2713" class="edge">
<title>qkv3_7&#45;&gt;ring_stage3_0_7</title>
<path fill="none" stroke="black" d="M12623.19,-4627.83C12632.9,-4626.21 12642.62,-4624.74 12652,-4623.54 12912.14,-4590.25 12981.45,-4625.18 13241,-4587.54 13242.73,-4587.29 13244.48,-4587.03 13246.23,-4586.75"/>
<polygon fill="black" stroke="black" points="13247.08,-4590.16 13256.36,-4585.05 13245.92,-4583.25 13247.08,-4590.16"/>
</g>
<!-- ring_stage3_0_8 -->
<g id="node1947" class="node">
<title>ring_stage3_0_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14331.5,-4497.43 14138.5,-4497.43 14138.5,-4444.43 14331.5,-4444.43 14331.5,-4497.43"/>
<text text-anchor="middle" x="14235" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="14235" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_8×V_8</text>
<text text-anchor="middle" x="14235" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv3_8&#45;&gt;ring_stage3_0_8 -->
<g id="edge2714" class="edge">
<title>qkv3_8&#45;&gt;ring_stage3_0_8</title>
<path fill="none" stroke="black" d="M14235.71,-4533.82C14235.61,-4525.61 14235.51,-4516.38 14235.41,-4507.6"/>
<polygon fill="black" stroke="black" points="14238.91,-4507.56 14235.29,-4497.6 14231.91,-4507.64 14238.91,-4507.56"/>
</g>
<!-- ring_stage3_0_9 -->
<g id="node1948" class="node">
<title>ring_stage3_0_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13659.5,-4407.69 13466.5,-4407.69 13466.5,-4354.69 13659.5,-4354.69 13659.5,-4407.69"/>
<text text-anchor="middle" x="13563" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13563" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_9×V_9</text>
<text text-anchor="middle" x="13563" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv3_9&#45;&gt;ring_stage3_0_9 -->
<g id="edge2715" class="edge">
<title>qkv3_9&#45;&gt;ring_stage3_0_9</title>
<path fill="none" stroke="black" d="M12674.27,-4456.86C12713.03,-4452.3 12757.49,-4447.47 12798,-4444.06 13087.01,-4419.72 13165.09,-4450.32 13456.37,-4408.02"/>
<polygon fill="black" stroke="black" points="13457,-4411.47 13466.38,-4406.55 13455.98,-4404.54 13457,-4411.47"/>
</g>
<!-- ring_stage3_0_10 -->
<g id="node1949" class="node">
<title>ring_stage3_0_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14120,-4317.95 13900,-4317.95 13900,-4264.95 14120,-4264.95 14120,-4317.95"/>
<text text-anchor="middle" x="14010" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="14010" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_10×V_10</text>
<text text-anchor="middle" x="14010" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv3_10&#45;&gt;ring_stage3_0_10 -->
<g id="edge2716" class="edge">
<title>qkv3_10&#45;&gt;ring_stage3_0_10</title>
<path fill="none" stroke="black" d="M14940.99,-4355.66C14937.97,-4355.17 14934.97,-4354.73 14932,-4354.32 14578.49,-4305.97 14483.86,-4364.08 14130,-4318.32 14129.9,-4318.31 14129.8,-4318.3 14129.69,-4318.28"/>
<polygon fill="black" stroke="black" points="14130.45,-4314.85 14120.06,-4316.93 14129.47,-4321.79 14130.45,-4314.85"/>
</g>
<!-- ring_stage3_0_11 -->
<g id="node1950" class="node">
<title>ring_stage3_0_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13046,-4228.21 12826,-4228.21 12826,-4175.21 13046,-4175.21 13046,-4228.21"/>
<text text-anchor="middle" x="12936" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="12936" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_11×V_11</text>
<text text-anchor="middle" x="12936" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv3_11&#45;&gt;ring_stage3_0_11 -->
<g id="edge2717" class="edge">
<title>qkv3_11&#45;&gt;ring_stage3_0_11</title>
<path fill="none" stroke="black" d="M12279.01,-4275.53C12307.77,-4271.65 12339.07,-4267.69 12368,-4264.58 12563.75,-4243.56 12617.2,-4257.43 12815.7,-4228.69"/>
<polygon fill="black" stroke="black" points="12816.49,-4232.11 12825.88,-4227.2 12815.48,-4225.18 12816.49,-4232.11"/>
</g>
<!-- ring_stage3_0_12 -->
<g id="node1951" class="node">
<title>ring_stage3_0_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13470,-4138.47 13250,-4138.47 13250,-4085.47 13470,-4085.47 13470,-4138.47"/>
<text text-anchor="middle" x="13360" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13360" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_12×V_12</text>
<text text-anchor="middle" x="13360" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv3_12&#45;&gt;ring_stage3_0_12 -->
<g id="edge2718" class="edge">
<title>qkv3_12&#45;&gt;ring_stage3_0_12</title>
<path fill="none" stroke="black" d="M14195.99,-4176.2C14192.97,-4175.71 14189.96,-4175.26 14187,-4174.84 13878.31,-4131.69 13793.14,-4179.4 13480.38,-4138.92"/>
<polygon fill="black" stroke="black" points="13480.48,-4135.4 13470.11,-4137.57 13479.56,-4142.34 13480.48,-4135.4"/>
</g>
<!-- ring_stage3_0_13 -->
<g id="node1952" class="node">
<title>ring_stage3_0_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12881,-5510.7 12661,-5510.7 12661,-5457.7 12881,-5457.7 12881,-5510.7"/>
<text text-anchor="middle" x="12771" y="-5495.5" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="12771" y="-5480.5" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_13×V_13</text>
<text text-anchor="middle" x="12771" y="-5465.5" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv3_13&#45;&gt;ring_stage3_0_13 -->
<g id="edge2719" class="edge">
<title>qkv3_13&#45;&gt;ring_stage3_0_13</title>
<path fill="none" stroke="black" d="M15682.01,-5599.7C15661.95,-5589.43 15637.48,-5578.72 15614,-5573.2 15467.05,-5538.71 14406.87,-5541.84 14256,-5537.2 13748.94,-5521.61 13144.63,-5499.29 12891.68,-5489.78"/>
<polygon fill="black" stroke="black" points="12891.49,-5486.27 12881.37,-5489.39 12891.23,-5493.26 12891.49,-5486.27"/>
</g>
<!-- ring_stage3_0_14 -->
<g id="node1953" class="node">
<title>ring_stage3_0_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13119,-5394.83 12899,-5394.83 12899,-5341.83 13119,-5341.83 13119,-5394.83"/>
<text text-anchor="middle" x="13009" y="-5379.63" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13009" y="-5364.63" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_14×V_14</text>
<text text-anchor="middle" x="13009" y="-5349.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv3_14&#45;&gt;ring_stage3_0_14 -->
<g id="edge2720" class="edge">
<title>qkv3_14&#45;&gt;ring_stage3_0_14</title>
<path fill="none" stroke="black" d="M14264.99,-5480.88C14053.45,-5475.01 13554.86,-5455.6 13129.16,-5395.29"/>
<polygon fill="black" stroke="black" points="13129.51,-5391.8 13119.12,-5393.85 13128.52,-5398.73 13129.51,-5391.8"/>
</g>
<!-- ring_stage3_0_15 -->
<g id="node1954" class="node">
<title>ring_stage3_0_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13357,-5305.09 13137,-5305.09 13137,-5252.09 13357,-5252.09 13357,-5305.09"/>
<text text-anchor="middle" x="13247" y="-5289.89" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="13247" y="-5274.89" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_15×V_15</text>
<text text-anchor="middle" x="13247" y="-5259.89" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv3_15&#45;&gt;ring_stage3_0_15 -->
<g id="edge2721" class="edge">
<title>qkv3_15&#45;&gt;ring_stage3_0_15</title>
<path fill="none" stroke="black" d="M13242.06,-5341.48C13242.72,-5333.27 13243.45,-5324.04 13244.15,-5315.26"/>
<polygon fill="black" stroke="black" points="13247.65,-5315.51 13244.95,-5305.26 13240.67,-5314.95 13247.65,-5315.51"/>
</g>
<!-- kv_send3_0_0 -->
<g id="node1955" class="node">
<title>kv_send3_0_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14773" cy="-5099.11" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14773" y="-5102.91" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="14773" y="-5087.91" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_0_0&#45;&gt;kv_send3_0_0 -->
<g id="edge2722" class="edge">
<title>ring_stage3_0_0&#45;&gt;kv_send3_0_0</title>
<path fill="none" stroke="black" d="M14773,-5162C14773,-5153.95 14773,-5144.92 14773,-5136.3"/>
<polygon fill="black" stroke="black" points="14776.5,-5136.08 14773,-5126.08 14769.5,-5136.08 14776.5,-5136.08"/>
</g>
<!-- ring_stage3_1_0 -->
<g id="node1971" class="node">
<title>ring_stage3_1_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14057.5,-5125.61 13846.5,-5125.61 13846.5,-5072.61 14057.5,-5072.61 14057.5,-5125.61"/>
<text text-anchor="middle" x="13952" y="-5110.41" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13952" y="-5095.41" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_15×V_15</text>
<text text-anchor="middle" x="13952" y="-5080.41" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_0_0&#45;&gt;ring_stage3_1_0 -->
<g id="edge2738" class="edge">
<title>ring_stage3_0_0&#45;&gt;ring_stage3_1_0</title>
<path fill="none" stroke="black" d="M14676.41,-5177.53C14524.55,-5161.3 14230.54,-5129.88 14067.66,-5112.47"/>
<polygon fill="black" stroke="black" points="14067.92,-5108.98 14057.6,-5111.4 14067.18,-5115.94 14067.92,-5108.98"/>
</g>
<!-- kv_send3_0_1 -->
<g id="node1956" class="node">
<title>kv_send3_0_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14991" cy="-5009.37" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14991" y="-5013.17" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="14991" y="-4998.17" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_0_1&#45;&gt;kv_send3_0_1 -->
<g id="edge2723" class="edge">
<title>ring_stage3_0_1&#45;&gt;kv_send3_0_1</title>
<path fill="none" stroke="black" d="M14991,-5072.26C14991,-5064.21 14991,-5055.18 14991,-5046.56"/>
<polygon fill="black" stroke="black" points="14994.5,-5046.34 14991,-5036.34 14987.5,-5046.34 14994.5,-5046.34"/>
</g>
<!-- ring_stage3_1_1 -->
<g id="node1972" class="node">
<title>ring_stage3_1_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14869.5,-5035.87 14676.5,-5035.87 14676.5,-4982.87 14869.5,-4982.87 14869.5,-5035.87"/>
<text text-anchor="middle" x="14773" y="-5020.67" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="14773" y="-5005.67" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_0×V_0</text>
<text text-anchor="middle" x="14773" y="-4990.67" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_0_1&#45;&gt;ring_stage3_1_1 -->
<g id="edge2741" class="edge">
<title>ring_stage3_0_1&#45;&gt;ring_stage3_1_1</title>
<path fill="none" stroke="black" d="M14927.36,-5072.5C14901.95,-5062.27 14872.54,-5050.44 14846.25,-5039.85"/>
<polygon fill="black" stroke="black" points="14847.3,-5036.51 14836.72,-5036.02 14844.69,-5043 14847.3,-5036.51"/>
</g>
<!-- kv_send3_0_2 -->
<g id="node1957" class="node">
<title>kv_send3_0_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15248" cy="-4919.63" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15248" y="-4923.43" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="15248" y="-4908.43" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_0_2&#45;&gt;kv_send3_0_2 -->
<g id="edge2724" class="edge">
<title>ring_stage3_0_2&#45;&gt;kv_send3_0_2</title>
<path fill="none" stroke="black" d="M15248,-4982.52C15248,-4974.47 15248,-4965.44 15248,-4956.82"/>
<polygon fill="black" stroke="black" points="15251.5,-4956.6 15248,-4946.6 15244.5,-4956.6 15251.5,-4956.6"/>
</g>
<!-- ring_stage3_1_2 -->
<g id="node1973" class="node">
<title>ring_stage3_1_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15087.5,-4946.13 14894.5,-4946.13 14894.5,-4893.13 15087.5,-4893.13 15087.5,-4946.13"/>
<text text-anchor="middle" x="14991" y="-4930.93" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="14991" y="-4915.93" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_1×V_1</text>
<text text-anchor="middle" x="14991" y="-4900.93" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_0_2&#45;&gt;ring_stage3_1_2 -->
<g id="edge2744" class="edge">
<title>ring_stage3_0_2&#45;&gt;ring_stage3_1_2</title>
<path fill="none" stroke="black" d="M15172.97,-4982.76C15142.5,-4972.35 15107.13,-4960.28 15075.73,-4949.56"/>
<polygon fill="black" stroke="black" points="15076.71,-4946.2 15066.12,-4946.28 15074.45,-4952.82 15076.71,-4946.2"/>
</g>
<!-- kv_send3_0_3 -->
<g id="node1958" class="node">
<title>kv_send3_0_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15215" cy="-4829.89" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15215" y="-4833.69" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15215" y="-4818.69" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_0_3&#45;&gt;kv_send3_0_3 -->
<g id="edge2725" class="edge">
<title>ring_stage3_0_3&#45;&gt;kv_send3_0_3</title>
<path fill="none" stroke="black" d="M15392.73,-4893.02C15358.62,-4881.1 15318.24,-4866.98 15284.6,-4855.22"/>
<polygon fill="black" stroke="black" points="15285.44,-4851.81 15274.85,-4851.81 15283.13,-4858.42 15285.44,-4851.81"/>
</g>
<!-- ring_stage3_1_3 -->
<g id="node1974" class="node">
<title>ring_stage3_1_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15529.5,-4856.39 15336.5,-4856.39 15336.5,-4803.39 15529.5,-4803.39 15529.5,-4856.39"/>
<text text-anchor="middle" x="15433" y="-4841.19" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="15433" y="-4826.19" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_2×V_2</text>
<text text-anchor="middle" x="15433" y="-4811.19" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_0_3&#45;&gt;ring_stage3_1_3 -->
<g id="edge2747" class="edge">
<title>ring_stage3_0_3&#45;&gt;ring_stage3_1_3</title>
<path fill="none" stroke="black" d="M15456.28,-4892.78C15453.12,-4884.39 15449.57,-4874.94 15446.2,-4865.99"/>
<polygon fill="black" stroke="black" points="15449.45,-4864.69 15442.65,-4856.56 15442.9,-4867.15 15449.45,-4864.69"/>
</g>
<!-- kv_send3_0_4 -->
<g id="node1959" class="node">
<title>kv_send3_0_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12982" cy="-4740.15" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12982" y="-4743.95" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="12982" y="-4728.95" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_0_4&#45;&gt;kv_send3_0_4 -->
<g id="edge2726" class="edge">
<title>ring_stage3_0_4&#45;&gt;kv_send3_0_4</title>
<path fill="none" stroke="black" d="M12982,-4803.04C12982,-4794.99 12982,-4785.96 12982,-4777.34"/>
<polygon fill="black" stroke="black" points="12985.5,-4777.12 12982,-4767.12 12978.5,-4777.12 12985.5,-4777.12"/>
</g>
<!-- ring_stage3_1_4 -->
<g id="node1975" class="node">
<title>ring_stage3_1_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14058.5,-4766.65 13865.5,-4766.65 13865.5,-4713.65 14058.5,-4713.65 14058.5,-4766.65"/>
<text text-anchor="middle" x="13962" y="-4751.45" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13962" y="-4736.45" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_3×V_3</text>
<text text-anchor="middle" x="13962" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_0_4&#45;&gt;ring_stage3_1_4 -->
<g id="edge2750" class="edge">
<title>ring_stage3_0_4&#45;&gt;ring_stage3_1_4</title>
<path fill="none" stroke="black" d="M13078.78,-4823C13227.42,-4813.56 13520.79,-4793.39 13769,-4767.02 13796.99,-4764.05 13827.2,-4760.27 13855.21,-4756.53"/>
<polygon fill="black" stroke="black" points="13855.98,-4759.96 13865.42,-4755.15 13855.05,-4753.02 13855.98,-4759.96"/>
</g>
<!-- kv_send3_0_5 -->
<g id="node1960" class="node">
<title>kv_send3_0_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12764" cy="-4650.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12764" y="-4654.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="12764" y="-4639.21" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_0_5&#45;&gt;kv_send3_0_5 -->
<g id="edge2727" class="edge">
<title>ring_stage3_0_5&#45;&gt;kv_send3_0_5</title>
<path fill="none" stroke="black" d="M12764,-4713.3C12764,-4705.25 12764,-4696.22 12764,-4687.6"/>
<polygon fill="black" stroke="black" points="12767.5,-4687.38 12764,-4677.38 12760.5,-4687.38 12767.5,-4687.38"/>
</g>
<!-- ring_stage3_1_5 -->
<g id="node1976" class="node">
<title>ring_stage3_1_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13078.5,-4676.91 12885.5,-4676.91 12885.5,-4623.91 13078.5,-4623.91 13078.5,-4676.91"/>
<text text-anchor="middle" x="12982" y="-4661.71" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="12982" y="-4646.71" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_4×V_4</text>
<text text-anchor="middle" x="12982" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_0_5&#45;&gt;ring_stage3_1_5 -->
<g id="edge2753" class="edge">
<title>ring_stage3_0_5&#45;&gt;ring_stage3_1_5</title>
<path fill="none" stroke="black" d="M12827.64,-4713.54C12853.05,-4703.31 12882.46,-4691.48 12908.75,-4680.89"/>
<polygon fill="black" stroke="black" points="12910.31,-4684.04 12918.28,-4677.06 12907.7,-4677.55 12910.31,-4684.04"/>
</g>
<!-- kv_send3_0_6 -->
<g id="node1961" class="node">
<title>kv_send3_0_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13782" cy="-4560.67" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13782" y="-4564.47" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="13782" y="-4549.47" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_0_6&#45;&gt;kv_send3_0_6 -->
<g id="edge2728" class="edge">
<title>ring_stage3_0_6&#45;&gt;kv_send3_0_6</title>
<path fill="none" stroke="black" d="M13782,-4623.56C13782,-4615.51 13782,-4606.48 13782,-4597.86"/>
<polygon fill="black" stroke="black" points="13785.5,-4597.64 13782,-4587.64 13778.5,-4597.64 13785.5,-4597.64"/>
</g>
<!-- ring_stage3_1_6 -->
<g id="node1977" class="node">
<title>ring_stage3_1_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13231.5,-4587.17 13038.5,-4587.17 13038.5,-4534.17 13231.5,-4534.17 13231.5,-4587.17"/>
<text text-anchor="middle" x="13135" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13135" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_5×V_5</text>
<text text-anchor="middle" x="13135" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_0_6&#45;&gt;ring_stage3_1_6 -->
<g id="edge2756" class="edge">
<title>ring_stage3_0_6&#45;&gt;ring_stage3_1_6</title>
<path fill="none" stroke="black" d="M13685.36,-4625.17C13682.21,-4624.59 13679.08,-4624.05 13676,-4623.54 13487.59,-4592.82 13436.62,-4616.92 13248,-4587.54 13245.9,-4587.22 13243.79,-4586.87 13241.66,-4586.51"/>
<polygon fill="black" stroke="black" points="13242.06,-4583.03 13231.61,-4584.73 13240.84,-4589.92 13242.06,-4583.03"/>
</g>
<!-- kv_send3_0_7 -->
<g id="node1962" class="node">
<title>kv_send3_0_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13791" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13791" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="13791" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_0_7&#45;&gt;kv_send3_0_7 -->
<g id="edge2729" class="edge">
<title>ring_stage3_0_7&#45;&gt;kv_send3_0_7</title>
<path fill="none" stroke="black" d="M13449.69,-4535.75C13452.83,-4535.08 13455.94,-4534.43 13459,-4533.8 13556.09,-4514.04 13581.79,-4516.96 13679,-4497.8 13688.16,-4496 13697.7,-4493.99 13707.19,-4491.91"/>
<polygon fill="black" stroke="black" points="13708.04,-4495.31 13717.04,-4489.73 13706.52,-4488.48 13708.04,-4495.31"/>
</g>
<!-- ring_stage3_1_7 -->
<g id="node1978" class="node">
<title>ring_stage3_1_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13669.5,-4497.43 13476.5,-4497.43 13476.5,-4444.43 13669.5,-4444.43 13669.5,-4497.43"/>
<text text-anchor="middle" x="13573" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13573" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_6×V_6</text>
<text text-anchor="middle" x="13573" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_0_7&#45;&gt;ring_stage3_1_7 -->
<g id="edge2759" class="edge">
<title>ring_stage3_0_7&#45;&gt;ring_stage3_1_7</title>
<path fill="none" stroke="black" d="M13417.22,-4534.06C13442.87,-4523.83 13472.55,-4512 13499.08,-4501.41"/>
<polygon fill="black" stroke="black" points="13500.7,-4504.53 13508.7,-4497.58 13498.11,-4498.03 13500.7,-4504.53"/>
</g>
<!-- kv_send3_0_8 -->
<g id="node1963" class="node">
<title>kv_send3_0_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14235" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14235" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14235" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_0_8&#45;&gt;kv_send3_0_8 -->
<g id="edge2730" class="edge">
<title>ring_stage3_0_8&#45;&gt;kv_send3_0_8</title>
<path fill="none" stroke="black" d="M14235,-4444.08C14235,-4436.03 14235,-4427 14235,-4418.38"/>
<polygon fill="black" stroke="black" points="14238.5,-4418.16 14235,-4408.16 14231.5,-4418.16 14238.5,-4418.16"/>
</g>
<!-- ring_stage3_1_8 -->
<g id="node1979" class="node">
<title>ring_stage3_1_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14105.5,-4407.69 13912.5,-4407.69 13912.5,-4354.69 14105.5,-4354.69 14105.5,-4407.69"/>
<text text-anchor="middle" x="14009" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="14009" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_7×V_7</text>
<text text-anchor="middle" x="14009" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_0_8&#45;&gt;ring_stage3_1_8 -->
<g id="edge2762" class="edge">
<title>ring_stage3_0_8&#45;&gt;ring_stage3_1_8</title>
<path fill="none" stroke="black" d="M14169.02,-4444.32C14142.57,-4434.05 14111.93,-4422.15 14084.58,-4411.53"/>
<polygon fill="black" stroke="black" points="14085.65,-4408.19 14075.06,-4407.84 14083.11,-4414.72 14085.65,-4408.19"/>
</g>
<!-- kv_send3_0_9 -->
<g id="node1964" class="node">
<title>kv_send3_0_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13561" cy="-4291.45" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13561" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="13561" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_0_9&#45;&gt;kv_send3_0_9 -->
<g id="edge2731" class="edge">
<title>ring_stage3_0_9&#45;&gt;kv_send3_0_9</title>
<path fill="none" stroke="black" d="M13562.41,-4354.34C13562.23,-4346.29 13562.02,-4337.26 13561.82,-4328.64"/>
<polygon fill="black" stroke="black" points="13565.32,-4328.34 13561.59,-4318.42 13558.32,-4328.5 13565.32,-4328.34"/>
</g>
<!-- ring_stage3_1_9 -->
<g id="node1980" class="node">
<title>ring_stage3_1_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14331.5,-4317.95 14138.5,-4317.95 14138.5,-4264.95 14331.5,-4264.95 14331.5,-4317.95"/>
<text text-anchor="middle" x="14235" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="14235" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_8×V_8</text>
<text text-anchor="middle" x="14235" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_0_9&#45;&gt;ring_stage3_1_9 -->
<g id="edge2765" class="edge">
<title>ring_stage3_0_9&#45;&gt;ring_stage3_1_9</title>
<path fill="none" stroke="black" d="M13659.68,-4356.09C13663.15,-4355.45 13666.6,-4354.86 13670,-4354.32 13868.83,-4322.69 13925.14,-4349.78 14128.27,-4318.31"/>
<polygon fill="black" stroke="black" points="14129.04,-4321.73 14138.37,-4316.72 14127.94,-4314.82 14129.04,-4321.73"/>
</g>
<!-- kv_send3_0_10 -->
<g id="node1965" class="node">
<title>kv_send3_0_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13606" cy="-4201.71" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13606" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="13606" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_0_10&#45;&gt;kv_send3_0_10 -->
<g id="edge2732" class="edge">
<title>ring_stage3_0_10&#45;&gt;kv_send3_0_10</title>
<path fill="none" stroke="black" d="M13899.78,-4266.49C13896.82,-4265.85 13893.89,-4265.21 13891,-4264.58 13817.23,-4248.56 13798.77,-4244.6 13725,-4228.58 13715.55,-4226.53 13705.67,-4224.38 13695.83,-4222.25"/>
<polygon fill="black" stroke="black" points="13696.53,-4218.82 13686.01,-4220.11 13695.04,-4225.66 13696.53,-4218.82"/>
</g>
<!-- ring_stage3_1_10 -->
<g id="node1981" class="node">
<title>ring_stage3_1_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13478,-4228.21 13276,-4228.21 13276,-4175.21 13478,-4175.21 13478,-4228.21"/>
<text text-anchor="middle" x="13377" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13377" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_9×V_9</text>
<text text-anchor="middle" x="13377" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_0_10&#45;&gt;ring_stage3_1_10 -->
<g id="edge2768" class="edge">
<title>ring_stage3_0_10&#45;&gt;ring_stage3_1_10</title>
<path fill="none" stroke="black" d="M13899.87,-4266C13896.89,-4265.5 13893.93,-4265.03 13891,-4264.58 13716.02,-4237.87 13666.74,-4256.59 13488.18,-4228.67"/>
<polygon fill="black" stroke="black" points="13488.61,-4225.19 13478.19,-4227.08 13487.51,-4232.11 13488.61,-4225.19"/>
</g>
<!-- kv_send3_0_11 -->
<g id="node1966" class="node">
<title>kv_send3_0_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13598" cy="-4111.97" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13598" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13598" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_0_11&#45;&gt;kv_send3_0_11 -->
<g id="edge2733" class="edge">
<title>ring_stage3_0_11&#45;&gt;kv_send3_0_11</title>
<path fill="none" stroke="black" d="M13046.08,-4176.41C13049.42,-4175.86 13052.73,-4175.33 13056,-4174.84 13242.6,-4146.9 13292.42,-4166.94 13479,-4138.84 13489.48,-4137.26 13500.43,-4135.31 13511.25,-4133.19"/>
<polygon fill="black" stroke="black" points="13512.02,-4136.6 13521.13,-4131.2 13510.64,-4129.74 13512.02,-4136.6"/>
</g>
<!-- ring_stage3_1_11 -->
<g id="node1982" class="node">
<title>ring_stage3_1_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13232,-4138.47 13012,-4138.47 13012,-4085.47 13232,-4085.47 13232,-4138.47"/>
<text text-anchor="middle" x="13122" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13122" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_10×V_10</text>
<text text-anchor="middle" x="13122" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_0_11&#45;&gt;ring_stage3_1_11 -->
<g id="edge2771" class="edge">
<title>ring_stage3_0_11&#45;&gt;ring_stage3_1_11</title>
<path fill="none" stroke="black" d="M12990.3,-4175.1C13011.6,-4165.05 13036.19,-4153.45 13058.32,-4143.01"/>
<polygon fill="black" stroke="black" points="13060.08,-4146.05 13067.63,-4138.62 13057.1,-4139.72 13060.08,-4146.05"/>
</g>
<!-- kv_send3_0_12 -->
<g id="node1967" class="node">
<title>kv_send3_0_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12462" cy="-4022.23" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12462" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="12462" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_0_12&#45;&gt;kv_send3_0_12 -->
<g id="edge2734" class="edge">
<title>ring_stage3_0_12&#45;&gt;kv_send3_0_12</title>
<path fill="none" stroke="black" d="M13249.89,-4086.39C13246.9,-4085.93 13243.93,-4085.5 13241,-4085.1 12949.88,-4045.77 12872.12,-4088.43 12581,-4049.1 12570.33,-4047.66 12559.2,-4045.77 12548.21,-4043.66"/>
<polygon fill="black" stroke="black" points="12548.67,-4040.19 12538.18,-4041.68 12547.31,-4047.05 12548.67,-4040.19"/>
</g>
<!-- ring_stage3_1_12 -->
<g id="node1983" class="node">
<title>ring_stage3_1_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13703,-4048.73 13483,-4048.73 13483,-3995.73 13703,-3995.73 13703,-4048.73"/>
<text text-anchor="middle" x="13593" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13593" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_11×V_11</text>
<text text-anchor="middle" x="13593" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_0_12&#45;&gt;ring_stage3_1_12 -->
<g id="edge2774" class="edge">
<title>ring_stage3_0_12&#45;&gt;ring_stage3_1_12</title>
<path fill="none" stroke="black" d="M13428.02,-4085.36C13455.41,-4075.04 13487.16,-4063.09 13515.45,-4052.44"/>
<polygon fill="black" stroke="black" points="13516.77,-4055.68 13524.9,-4048.88 13514.3,-4049.13 13516.77,-4055.68"/>
</g>
<!-- kv_send3_0_13 -->
<g id="node1968" class="node">
<title>kv_send3_0_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12771" cy="-5368.33" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12771" y="-5372.13" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12771" y="-5357.13" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_0_13&#45;&gt;kv_send3_0_13 -->
<g id="edge2735" class="edge">
<title>ring_stage3_0_13&#45;&gt;kv_send3_0_13</title>
<path fill="none" stroke="black" d="M12771,-5457.65C12771,-5442.34 12771,-5422.62 12771,-5405.7"/>
<polygon fill="black" stroke="black" points="12774.5,-5405.59 12771,-5395.59 12767.5,-5405.59 12774.5,-5405.59"/>
</g>
<!-- ring_stage3_1_13 -->
<g id="node1984" class="node">
<title>ring_stage3_1_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12327,-3958.99 12107,-3958.99 12107,-3905.99 12327,-3905.99 12327,-3958.99"/>
<text text-anchor="middle" x="12217" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="12217" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_12×V_12</text>
<text text-anchor="middle" x="12217" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_0_13&#45;&gt;ring_stage3_1_13 -->
<g id="edge2777" class="edge">
<title>ring_stage3_0_13&#45;&gt;ring_stage3_1_13</title>
<path fill="none" stroke="black" d="M12719.26,-5457.53C12694.87,-5442.71 12667.74,-5421.72 12652,-5395.2 12625.52,-5350.6 12636,-5331.47 12636,-5279.59 12636,-5279.59 12636,-5279.59 12636,-5187.85 12636,-5004.26 12456.41,-5027.53 12389,-4856.76 12291.76,-4610.44 12500.29,-4461.3 12323,-4264.58 12272.75,-4208.83 12215.99,-4276.23 12158,-4228.58 12117.4,-4195.22 12093.63,-4041.38 12119,-3995.36 12125.72,-3983.17 12135.97,-3973.05 12147.35,-3964.77"/>
<polygon fill="black" stroke="black" points="12149.47,-3967.56 12155.8,-3959.06 12145.55,-3961.75 12149.47,-3967.56"/>
</g>
<!-- kv_send3_0_14 -->
<g id="node1969" class="node">
<title>kv_send3_0_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13009" cy="-5278.59" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13009" y="-5282.39" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="13009" y="-5267.39" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_0_14&#45;&gt;kv_send3_0_14 -->
<g id="edge2736" class="edge">
<title>ring_stage3_0_14&#45;&gt;kv_send3_0_14</title>
<path fill="none" stroke="black" d="M13009,-5341.48C13009,-5333.43 13009,-5324.4 13009,-5315.78"/>
<polygon fill="black" stroke="black" points="13012.5,-5315.56 13009,-5305.56 13005.5,-5315.56 13012.5,-5315.56"/>
</g>
<!-- ring_stage3_1_14 -->
<g id="node1985" class="node">
<title>ring_stage3_1_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12881,-5305.09 12661,-5305.09 12661,-5252.09 12881,-5252.09 12881,-5305.09"/>
<text text-anchor="middle" x="12771" y="-5289.89" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="12771" y="-5274.89" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_13×V_13</text>
<text text-anchor="middle" x="12771" y="-5259.89" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_0_14&#45;&gt;ring_stage3_1_14 -->
<g id="edge2780" class="edge">
<title>ring_stage3_0_14&#45;&gt;ring_stage3_1_14</title>
<path fill="none" stroke="black" d="M12939.52,-5341.72C12911.54,-5331.4 12879.11,-5319.45 12850.22,-5308.8"/>
<polygon fill="black" stroke="black" points="12851.16,-5305.41 12840.57,-5305.24 12848.74,-5311.98 12851.16,-5305.41"/>
</g>
<!-- kv_send3_0_15 -->
<g id="node1970" class="node">
<title>kv_send3_0_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13390" cy="-5188.85" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13390" y="-5192.65" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13390" y="-5177.65" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_0_15&#45;&gt;kv_send3_0_15 -->
<g id="edge2737" class="edge">
<title>ring_stage3_0_15&#45;&gt;kv_send3_0_15</title>
<path fill="none" stroke="black" d="M13288.75,-5251.98C13305.45,-5241.73 13324.8,-5229.86 13342.08,-5219.26"/>
<polygon fill="black" stroke="black" points="13344.21,-5222.06 13350.9,-5213.84 13340.55,-5216.09 13344.21,-5222.06"/>
</g>
<!-- ring_stage3_1_15 -->
<g id="node1986" class="node">
<title>ring_stage3_1_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13224,-5215.35 13004,-5215.35 13004,-5162.35 13224,-5162.35 13224,-5215.35"/>
<text text-anchor="middle" x="13114" y="-5200.15" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="13114" y="-5185.15" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_14×V_14</text>
<text text-anchor="middle" x="13114" y="-5170.15" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_0_15&#45;&gt;ring_stage3_1_15 -->
<g id="edge2783" class="edge">
<title>ring_stage3_0_15&#45;&gt;ring_stage3_1_15</title>
<path fill="none" stroke="black" d="M13208.17,-5251.98C13193.69,-5242.42 13177.07,-5231.46 13161.87,-5221.43"/>
<polygon fill="black" stroke="black" points="13163.38,-5218.24 13153.11,-5215.65 13159.53,-5224.08 13163.38,-5218.24"/>
</g>
<!-- kv_send3_0_0&#45;&gt;ring_stage3_1_1 -->
<g id="edge2742" class="edge">
<title>kv_send3_0_0&#45;&gt;ring_stage3_1_1</title>
<path fill="none" stroke="black" d="M14773,-5071.79C14773,-5063.75 14773,-5054.77 14773,-5046.21"/>
<polygon fill="black" stroke="black" points="14776.5,-5046.08 14773,-5036.08 14769.5,-5046.08 14776.5,-5046.08"/>
</g>
<!-- kv_send3_0_1&#45;&gt;ring_stage3_1_2 -->
<g id="edge2745" class="edge">
<title>kv_send3_0_1&#45;&gt;ring_stage3_1_2</title>
<path fill="none" stroke="black" d="M14991,-4982.05C14991,-4974.01 14991,-4965.03 14991,-4956.47"/>
<polygon fill="black" stroke="black" points="14994.5,-4956.34 14991,-4946.34 14987.5,-4956.34 14994.5,-4956.34"/>
</g>
<!-- kv_send3_0_2&#45;&gt;ring_stage3_1_3 -->
<g id="edge2748" class="edge">
<title>kv_send3_0_2&#45;&gt;ring_stage3_1_3</title>
<path fill="none" stroke="black" d="M15296.12,-4895.81C15318.62,-4885.14 15345.71,-4872.29 15369.83,-4860.85"/>
<polygon fill="black" stroke="black" points="15371.38,-4863.99 15378.92,-4856.54 15368.38,-4857.67 15371.38,-4863.99"/>
</g>
<!-- kv_send3_0_3&#45;&gt;ring_stage3_1_4 -->
<g id="edge2751" class="edge">
<title>kv_send3_0_3&#45;&gt;ring_stage3_1_4</title>
<path fill="none" stroke="black" d="M15143.97,-4810.35C15130.45,-4807.43 15116.35,-4804.79 15103,-4803.02 14666.08,-4745.16 14550.37,-4812.58 14112,-4767.02 14097.9,-4765.56 14083.13,-4763.57 14068.59,-4761.35"/>
<polygon fill="black" stroke="black" points="14068.98,-4757.87 14058.56,-4759.77 14067.9,-4764.78 14068.98,-4757.87"/>
</g>
<!-- kv_send3_0_4&#45;&gt;ring_stage3_1_5 -->
<g id="edge2754" class="edge">
<title>kv_send3_0_4&#45;&gt;ring_stage3_1_5</title>
<path fill="none" stroke="black" d="M12982,-4712.83C12982,-4704.79 12982,-4695.81 12982,-4687.25"/>
<polygon fill="black" stroke="black" points="12985.5,-4687.11 12982,-4677.12 12978.5,-4687.12 12985.5,-4687.11"/>
</g>
<!-- kv_send3_0_5&#45;&gt;ring_stage3_1_6 -->
<g id="edge2757" class="edge">
<title>kv_send3_0_5&#45;&gt;ring_stage3_1_6</title>
<path fill="none" stroke="black" d="M12838.63,-4631.76C12893.05,-4618.89 12967.58,-4601.27 13028.28,-4586.91"/>
<polygon fill="black" stroke="black" points="13029.36,-4590.25 13038.28,-4584.55 13027.75,-4583.44 13029.36,-4590.25"/>
</g>
<!-- kv_send3_0_6&#45;&gt;ring_stage3_1_7 -->
<g id="edge2760" class="edge">
<title>kv_send3_0_6&#45;&gt;ring_stage3_1_7</title>
<path fill="none" stroke="black" d="M13729.26,-4537.53C13703.19,-4526.59 13671.36,-4513.22 13643.25,-4501.42"/>
<polygon fill="black" stroke="black" points="13644.45,-4498.13 13633.87,-4497.49 13641.74,-4504.59 13644.45,-4498.13"/>
</g>
<!-- kv_send3_0_7&#45;&gt;ring_stage3_1_8 -->
<g id="edge2763" class="edge">
<title>kv_send3_0_7&#45;&gt;ring_stage3_1_8</title>
<path fill="none" stroke="black" d="M13845.45,-4448.02C13872.87,-4436.98 13906.51,-4423.44 13936.13,-4411.52"/>
<polygon fill="black" stroke="black" points="13937.62,-4414.69 13945.59,-4407.71 13935.01,-4408.2 13937.62,-4414.69"/>
</g>
<!-- kv_send3_0_8&#45;&gt;ring_stage3_1_9 -->
<g id="edge2766" class="edge">
<title>kv_send3_0_8&#45;&gt;ring_stage3_1_9</title>
<path fill="none" stroke="black" d="M14235,-4353.87C14235,-4345.83 14235,-4336.85 14235,-4328.29"/>
<polygon fill="black" stroke="black" points="14238.5,-4328.15 14235,-4318.15 14231.5,-4328.15 14238.5,-4328.15"/>
</g>
<!-- kv_send3_0_9&#45;&gt;ring_stage3_1_10 -->
<g id="edge2769" class="edge">
<title>kv_send3_0_9&#45;&gt;ring_stage3_1_10</title>
<path fill="none" stroke="black" d="M13512.17,-4267.17C13489.99,-4256.59 13463.48,-4243.95 13439.84,-4232.67"/>
<polygon fill="black" stroke="black" points="13441.12,-4229.41 13430.59,-4228.26 13438.11,-4235.73 13441.12,-4229.41"/>
</g>
<!-- kv_send3_0_10&#45;&gt;ring_stage3_1_11 -->
<g id="edge2772" class="edge">
<title>kv_send3_0_10&#45;&gt;ring_stage3_1_11</title>
<path fill="none" stroke="black" d="M13527.74,-4182.9C13514.19,-4180.04 13500.21,-4177.24 13487,-4174.84 13381.47,-4155.67 13351.46,-4158.41 13242.27,-4139.02"/>
<polygon fill="black" stroke="black" points="13242.63,-4135.52 13232.16,-4137.2 13241.39,-4142.41 13242.63,-4135.52"/>
</g>
<!-- kv_send3_0_11&#45;&gt;ring_stage3_1_12 -->
<g id="edge2775" class="edge">
<title>kv_send3_0_11&#45;&gt;ring_stage3_1_12</title>
<path fill="none" stroke="black" d="M13596.5,-4084.65C13596.04,-4076.61 13595.53,-4067.63 13595.04,-4059.07"/>
<polygon fill="black" stroke="black" points="13598.53,-4058.72 13594.46,-4048.93 13591.54,-4059.12 13598.53,-4058.72"/>
</g>
<!-- kv_send3_0_12&#45;&gt;ring_stage3_1_13 -->
<g id="edge2778" class="edge">
<title>kv_send3_0_12&#45;&gt;ring_stage3_1_13</title>
<path fill="none" stroke="black" d="M12401.75,-3999.66C12370.41,-3988.43 12331.67,-3974.56 12297.76,-3962.42"/>
<polygon fill="black" stroke="black" points="12298.94,-3959.12 12288.34,-3959.04 12296.58,-3965.71 12298.94,-3959.12"/>
</g>
<!-- kv_send3_0_13&#45;&gt;ring_stage3_1_14 -->
<g id="edge2781" class="edge">
<title>kv_send3_0_13&#45;&gt;ring_stage3_1_14</title>
<path fill="none" stroke="black" d="M12771,-5341.01C12771,-5332.97 12771,-5323.99 12771,-5315.43"/>
<polygon fill="black" stroke="black" points="12774.5,-5315.3 12771,-5305.3 12767.5,-5315.3 12774.5,-5315.3"/>
</g>
<!-- kv_send3_0_14&#45;&gt;ring_stage3_1_15 -->
<g id="edge2784" class="edge">
<title>kv_send3_0_14&#45;&gt;ring_stage3_1_15</title>
<path fill="none" stroke="black" d="M13038.81,-5252.69C13050.25,-5243.13 13063.47,-5232.08 13075.6,-5221.94"/>
<polygon fill="black" stroke="black" points="13077.96,-5224.53 13083.39,-5215.43 13073.47,-5219.16 13077.96,-5224.53"/>
</g>
<!-- kv_send3_0_15&#45;&gt;ring_stage3_1_0 -->
<g id="edge2739" class="edge">
<title>kv_send3_0_15&#45;&gt;ring_stage3_1_0</title>
<path fill="none" stroke="black" d="M13476.89,-5174.29C13573.3,-5159.24 13729.32,-5134.88 13836.08,-5118.21"/>
<polygon fill="black" stroke="black" points="13836.92,-5121.62 13846.26,-5116.62 13835.84,-5114.71 13836.92,-5121.62"/>
</g>
<!-- kv_send3_1_0 -->
<g id="node1987" class="node">
<title>kv_send3_1_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14065" cy="-5009.37" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14065" y="-5013.17" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="14065" y="-4998.17" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_1_0&#45;&gt;kv_send3_1_0 -->
<g id="edge2740" class="edge">
<title>ring_stage3_1_0&#45;&gt;kv_send3_1_0</title>
<path fill="none" stroke="black" d="M13984.99,-5072.5C13997.61,-5062.7 14012.14,-5051.42 14025.33,-5041.18"/>
<polygon fill="black" stroke="black" points="14027.58,-5043.86 14033.33,-5034.96 14023.29,-5038.33 14027.58,-5043.86"/>
</g>
<!-- ring_stage3_2_0 -->
<g id="node2003" class="node">
<title>ring_stage3_2_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13604.5,-5035.87 13393.5,-5035.87 13393.5,-4982.87 13604.5,-4982.87 13604.5,-5035.87"/>
<text text-anchor="middle" x="13499" y="-5020.67" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="13499" y="-5005.67" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_14×V_14</text>
<text text-anchor="middle" x="13499" y="-4990.67" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_1_0&#45;&gt;ring_stage3_2_0 -->
<g id="edge2786" class="edge">
<title>ring_stage3_1_0&#45;&gt;ring_stage3_2_0</title>
<path fill="none" stroke="black" d="M13846.36,-5077.65C13776.95,-5064.21 13686.11,-5046.61 13614.74,-5032.79"/>
<polygon fill="black" stroke="black" points="13615.29,-5029.33 13604.8,-5030.87 13613.96,-5036.2 13615.29,-5029.33"/>
</g>
<!-- kv_send3_1_1 -->
<g id="node1988" class="node">
<title>kv_send3_1_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14773" cy="-4919.63" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14773" y="-4923.43" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="14773" y="-4908.43" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_1_1&#45;&gt;kv_send3_1_1 -->
<g id="edge2743" class="edge">
<title>ring_stage3_1_1&#45;&gt;kv_send3_1_1</title>
<path fill="none" stroke="black" d="M14773,-4982.52C14773,-4974.47 14773,-4965.44 14773,-4956.82"/>
<polygon fill="black" stroke="black" points="14776.5,-4956.6 14773,-4946.6 14769.5,-4956.6 14776.5,-4956.6"/>
</g>
<!-- ring_stage3_2_1 -->
<g id="node2004" class="node">
<title>ring_stage3_2_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14289.5,-4946.13 14078.5,-4946.13 14078.5,-4893.13 14289.5,-4893.13 14289.5,-4946.13"/>
<text text-anchor="middle" x="14184" y="-4930.93" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="14184" y="-4915.93" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_15×V_15</text>
<text text-anchor="middle" x="14184" y="-4900.93" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_1_1&#45;&gt;ring_stage3_2_1 -->
<g id="edge2789" class="edge">
<title>ring_stage3_1_1&#45;&gt;ring_stage3_2_1</title>
<path fill="none" stroke="black" d="M14676.4,-4993.98C14573.22,-4978.61 14409.74,-4954.26 14299.75,-4937.88"/>
<polygon fill="black" stroke="black" points="14300.02,-4934.38 14289.61,-4936.37 14298.99,-4941.3 14300.02,-4934.38"/>
</g>
<!-- kv_send3_1_2 -->
<g id="node1989" class="node">
<title>kv_send3_1_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14991" cy="-4829.89" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14991" y="-4833.69" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="14991" y="-4818.69" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_1_2&#45;&gt;kv_send3_1_2 -->
<g id="edge2746" class="edge">
<title>ring_stage3_1_2&#45;&gt;kv_send3_1_2</title>
<path fill="none" stroke="black" d="M14991,-4892.78C14991,-4884.73 14991,-4875.7 14991,-4867.08"/>
<polygon fill="black" stroke="black" points="14994.5,-4866.86 14991,-4856.86 14987.5,-4866.86 14994.5,-4866.86"/>
</g>
<!-- ring_stage3_2_2 -->
<g id="node2005" class="node">
<title>ring_stage3_2_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14869.5,-4856.39 14676.5,-4856.39 14676.5,-4803.39 14869.5,-4803.39 14869.5,-4856.39"/>
<text text-anchor="middle" x="14773" y="-4841.19" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="14773" y="-4826.19" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_0×V_0</text>
<text text-anchor="middle" x="14773" y="-4811.19" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_1_2&#45;&gt;ring_stage3_2_2 -->
<g id="edge2792" class="edge">
<title>ring_stage3_1_2&#45;&gt;ring_stage3_2_2</title>
<path fill="none" stroke="black" d="M14927.36,-4893.02C14901.95,-4882.79 14872.54,-4870.96 14846.25,-4860.37"/>
<polygon fill="black" stroke="black" points="14847.3,-4857.03 14836.72,-4856.54 14844.69,-4863.52 14847.3,-4857.03"/>
</g>
<!-- kv_send3_1_3 -->
<g id="node1990" class="node">
<title>kv_send3_1_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15148" cy="-4740.15" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15148" y="-4743.95" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15148" y="-4728.95" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_1_3&#45;&gt;kv_send3_1_3 -->
<g id="edge2749" class="edge">
<title>ring_stage3_1_3&#45;&gt;kv_send3_1_3</title>
<path fill="none" stroke="black" d="M15349.8,-4803.28C15309.66,-4790.92 15261.88,-4776.21 15222.9,-4764.21"/>
<polygon fill="black" stroke="black" points="15223.77,-4760.82 15213.18,-4761.22 15221.71,-4767.51 15223.77,-4760.82"/>
</g>
<!-- ring_stage3_2_3 -->
<g id="node2006" class="node">
<title>ring_stage3_2_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15462.5,-4766.65 15269.5,-4766.65 15269.5,-4713.65 15462.5,-4713.65 15462.5,-4766.65"/>
<text text-anchor="middle" x="15366" y="-4751.45" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="15366" y="-4736.45" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_1×V_1</text>
<text text-anchor="middle" x="15366" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_1_3&#45;&gt;ring_stage3_2_3 -->
<g id="edge2795" class="edge">
<title>ring_stage3_1_3&#45;&gt;ring_stage3_2_3</title>
<path fill="none" stroke="black" d="M15413.26,-4803.04C15406.51,-4794.21 15398.86,-4784.19 15391.72,-4774.83"/>
<polygon fill="black" stroke="black" points="15394.45,-4772.64 15385.6,-4766.82 15388.89,-4776.89 15394.45,-4772.64"/>
</g>
<!-- kv_send3_1_4 -->
<g id="node1991" class="node">
<title>kv_send3_1_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13564" cy="-4650.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13564" y="-4654.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="13564" y="-4639.21" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_1_4&#45;&gt;kv_send3_1_4 -->
<g id="edge2752" class="edge">
<title>ring_stage3_1_4&#45;&gt;kv_send3_1_4</title>
<path fill="none" stroke="black" d="M13865.31,-4718.45C13810.11,-4706.55 13739.64,-4691.25 13677,-4677.28 13667.96,-4675.27 13658.52,-4673.14 13649.12,-4671.01"/>
<polygon fill="black" stroke="black" points="13649.87,-4667.59 13639.34,-4668.79 13648.32,-4674.42 13649.87,-4667.59"/>
</g>
<!-- ring_stage3_2_4 -->
<g id="node2007" class="node">
<title>ring_stage3_2_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14335.5,-4676.91 14142.5,-4676.91 14142.5,-4623.91 14335.5,-4623.91 14335.5,-4676.91"/>
<text text-anchor="middle" x="14239" y="-4661.71" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="14239" y="-4646.71" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_2×V_2</text>
<text text-anchor="middle" x="14239" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_1_4&#45;&gt;ring_stage3_2_4 -->
<g id="edge2798" class="edge">
<title>ring_stage3_1_4&#45;&gt;ring_stage3_2_4</title>
<path fill="none" stroke="black" d="M14042.86,-4713.54C14075.86,-4703.09 14114.16,-4690.96 14148.12,-4680.2"/>
<polygon fill="black" stroke="black" points="14149.56,-4683.41 14158.04,-4677.06 14147.44,-4676.74 14149.56,-4683.41"/>
</g>
<!-- kv_send3_1_5 -->
<g id="node1992" class="node">
<title>kv_send3_1_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12897" cy="-4560.67" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12897" y="-4564.47" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="12897" y="-4549.47" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_1_5&#45;&gt;kv_send3_1_5 -->
<g id="edge2755" class="edge">
<title>ring_stage3_1_5&#45;&gt;kv_send3_1_5</title>
<path fill="none" stroke="black" d="M12956.96,-4623.56C12948.06,-4614.38 12937.93,-4603.92 12928.56,-4594.25"/>
<polygon fill="black" stroke="black" points="12931.04,-4591.78 12921.57,-4587.04 12926.02,-4596.65 12931.04,-4591.78"/>
</g>
<!-- ring_stage3_2_5 -->
<g id="node2008" class="node">
<title>ring_stage3_2_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13660.5,-4587.17 13467.5,-4587.17 13467.5,-4534.17 13660.5,-4534.17 13660.5,-4587.17"/>
<text text-anchor="middle" x="13564" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="13564" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_3×V_3</text>
<text text-anchor="middle" x="13564" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_1_5&#45;&gt;ring_stage3_2_5 -->
<g id="edge2801" class="edge">
<title>ring_stage3_1_5&#45;&gt;ring_stage3_2_5</title>
<path fill="none" stroke="black" d="M13078.89,-4640.08C13173.26,-4630.25 13320.87,-4612.91 13457.19,-4587.81"/>
<polygon fill="black" stroke="black" points="13458.21,-4591.18 13467.4,-4585.91 13456.93,-4584.29 13458.21,-4591.18"/>
</g>
<!-- kv_send3_1_6 -->
<g id="node1993" class="node">
<title>kv_send3_1_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13131" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13131" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="13131" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_1_6&#45;&gt;kv_send3_1_6 -->
<g id="edge2758" class="edge">
<title>ring_stage3_1_6&#45;&gt;kv_send3_1_6</title>
<path fill="none" stroke="black" d="M13133.82,-4533.82C13133.45,-4525.77 13133.04,-4516.74 13132.65,-4508.12"/>
<polygon fill="black" stroke="black" points="13136.14,-4507.73 13132.18,-4497.9 13129.14,-4508.05 13136.14,-4507.73"/>
</g>
<!-- ring_stage3_2_6 -->
<g id="node2009" class="node">
<title>ring_stage3_2_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12999.5,-4497.43 12806.5,-4497.43 12806.5,-4444.43 12999.5,-4444.43 12999.5,-4497.43"/>
<text text-anchor="middle" x="12903" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="12903" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_4×V_4</text>
<text text-anchor="middle" x="12903" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_1_6&#45;&gt;ring_stage3_2_6 -->
<g id="edge2804" class="edge">
<title>ring_stage3_1_6&#45;&gt;ring_stage3_2_6</title>
<path fill="none" stroke="black" d="M13067.27,-4534.06C13040,-4523.74 13008.38,-4511.79 12980.22,-4501.14"/>
<polygon fill="black" stroke="black" points="12981.4,-4497.84 12970.81,-4497.58 12978.93,-4504.39 12981.4,-4497.84"/>
</g>
<!-- kv_send3_1_7 -->
<g id="node1994" class="node">
<title>kv_send3_1_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13782" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13782" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="13782" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_1_7&#45;&gt;kv_send3_1_7 -->
<g id="edge2761" class="edge">
<title>ring_stage3_1_7&#45;&gt;kv_send3_1_7</title>
<path fill="none" stroke="black" d="M13634.01,-4444.32C13660.96,-4433.01 13692.6,-4419.72 13719.69,-4408.35"/>
<polygon fill="black" stroke="black" points="13721.2,-4411.51 13729.07,-4404.41 13718.49,-4405.06 13721.2,-4411.51"/>
</g>
<!-- ring_stage3_2_7 -->
<g id="node2010" class="node">
<title>ring_stage3_2_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13223.5,-4407.69 13030.5,-4407.69 13030.5,-4354.69 13223.5,-4354.69 13223.5,-4407.69"/>
<text text-anchor="middle" x="13127" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="13127" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_5×V_5</text>
<text text-anchor="middle" x="13127" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_1_7&#45;&gt;ring_stage3_2_7 -->
<g id="edge2807" class="edge">
<title>ring_stage3_1_7&#45;&gt;ring_stage3_2_7</title>
<path fill="none" stroke="black" d="M13476.31,-4445.97C13473.18,-4445.31 13470.07,-4444.67 13467,-4444.06 13366.92,-4424.19 13337.95,-4428.28 13233.68,-4408.12"/>
<polygon fill="black" stroke="black" points="13234.17,-4404.65 13223.69,-4406.16 13232.82,-4411.52 13234.17,-4404.65"/>
</g>
<!-- kv_send3_1_8 -->
<g id="node1995" class="node">
<title>kv_send3_1_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14472" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14472" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14472" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_1_8&#45;&gt;kv_send3_1_8 -->
<g id="edge2764" class="edge">
<title>ring_stage3_1_8&#45;&gt;kv_send3_1_8</title>
<path fill="none" stroke="black" d="M14105.63,-4357.85C14111.5,-4356.62 14117.32,-4355.43 14123,-4354.32 14219.37,-4335.45 14244.37,-4335.84 14341,-4318.32 14354.4,-4315.89 14368.55,-4313.22 14382.39,-4310.53"/>
<polygon fill="black" stroke="black" points="14383.26,-4313.93 14392.41,-4308.58 14381.92,-4307.06 14383.26,-4313.93"/>
</g>
<!-- ring_stage3_2_8 -->
<g id="node2011" class="node">
<title>ring_stage3_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13881.5,-4317.95 13688.5,-4317.95 13688.5,-4264.95 13881.5,-4264.95 13881.5,-4317.95"/>
<text text-anchor="middle" x="13785" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="13785" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_6×V_6</text>
<text text-anchor="middle" x="13785" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_1_8&#45;&gt;ring_stage3_2_8 -->
<g id="edge2810" class="edge">
<title>ring_stage3_1_8&#45;&gt;ring_stage3_2_8</title>
<path fill="none" stroke="black" d="M13943.61,-4354.58C13917.39,-4344.31 13887.02,-4332.41 13859.91,-4321.79"/>
<polygon fill="black" stroke="black" points="13861.06,-4318.49 13850.47,-4318.1 13858.51,-4325 13861.06,-4318.49"/>
</g>
<!-- kv_send3_1_9 -->
<g id="node1996" class="node">
<title>kv_send3_1_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14068" cy="-4201.71" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14068" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14068" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_1_9&#45;&gt;kv_send3_1_9 -->
<g id="edge2767" class="edge">
<title>ring_stage3_1_9&#45;&gt;kv_send3_1_9</title>
<path fill="none" stroke="black" d="M14186.25,-4264.84C14166.04,-4254.22 14142.52,-4241.86 14121.81,-4230.98"/>
<polygon fill="black" stroke="black" points="14123.29,-4227.81 14112.81,-4226.26 14120.04,-4234.01 14123.29,-4227.81"/>
</g>
<!-- ring_stage3_2_9 -->
<g id="node2012" class="node">
<title>ring_stage3_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14613.5,-4228.21 14420.5,-4228.21 14420.5,-4175.21 14613.5,-4175.21 14613.5,-4228.21"/>
<text text-anchor="middle" x="14517" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="14517" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_7×V_7</text>
<text text-anchor="middle" x="14517" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_1_9&#45;&gt;ring_stage3_2_9 -->
<g id="edge2813" class="edge">
<title>ring_stage3_1_9&#45;&gt;ring_stage3_2_9</title>
<path fill="none" stroke="black" d="M14317.32,-4264.84C14351.06,-4254.34 14390.24,-4242.15 14424.92,-4231.36"/>
<polygon fill="black" stroke="black" points="14426.06,-4234.67 14434.57,-4228.36 14423.99,-4227.99 14426.06,-4234.67"/>
</g>
<!-- kv_send3_1_10 -->
<g id="node1997" class="node">
<title>kv_send3_1_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12884" cy="-4111.97" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12884" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="12884" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_1_10&#45;&gt;kv_send3_1_10 -->
<g id="edge2770" class="edge">
<title>ring_stage3_1_10&#45;&gt;kv_send3_1_10</title>
<path fill="none" stroke="black" d="M13275.78,-4176.52C13272.83,-4175.94 13269.89,-4175.38 13267,-4174.84 13150.56,-4153.26 13119.61,-4159.44 13003,-4138.84 12992.98,-4137.07 12982.52,-4135.05 12972.15,-4132.94"/>
<polygon fill="black" stroke="black" points="12972.74,-4129.49 12962.24,-4130.9 12971.33,-4136.35 12972.74,-4129.49"/>
</g>
<!-- ring_stage3_2_10 -->
<g id="node2013" class="node">
<title>ring_stage3_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14152,-4138.47 13950,-4138.47 13950,-4085.47 14152,-4085.47 14152,-4138.47"/>
<text text-anchor="middle" x="14051" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="14051" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_8×V_8</text>
<text text-anchor="middle" x="14051" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_1_10&#45;&gt;ring_stage3_2_10 -->
<g id="edge2816" class="edge">
<title>ring_stage3_1_10&#45;&gt;ring_stage3_2_10</title>
<path fill="none" stroke="black" d="M13478.18,-4176.31C13481.15,-4175.79 13484.09,-4175.3 13487,-4174.84 13683.76,-4144.09 13739.24,-4169.26 13939.84,-4138.91"/>
<polygon fill="black" stroke="black" points="13940.47,-4142.36 13949.82,-4137.38 13939.4,-4135.44 13940.47,-4142.36"/>
</g>
<!-- kv_send3_1_11 -->
<g id="node1998" class="node">
<title>kv_send3_1_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13131" cy="-4022.23" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13131" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13131" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_1_11&#45;&gt;kv_send3_1_11 -->
<g id="edge2773" class="edge">
<title>ring_stage3_1_11&#45;&gt;kv_send3_1_11</title>
<path fill="none" stroke="black" d="M13124.65,-4085.12C13125.48,-4077.07 13126.4,-4068.04 13127.29,-4059.42"/>
<polygon fill="black" stroke="black" points="13130.8,-4059.51 13128.34,-4049.2 13123.83,-4058.79 13130.8,-4059.51"/>
</g>
<!-- ring_stage3_2_11 -->
<g id="node2014" class="node">
<title>ring_stage3_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13003,-4048.73 12801,-4048.73 12801,-3995.73 13003,-3995.73 13003,-4048.73"/>
<text text-anchor="middle" x="12902" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="12902" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_9×V_9</text>
<text text-anchor="middle" x="12902" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_1_11&#45;&gt;ring_stage3_2_11 -->
<g id="edge2819" class="edge">
<title>ring_stage3_1_11&#45;&gt;ring_stage3_2_11</title>
<path fill="none" stroke="black" d="M13057.78,-4085.36C13032.13,-4075.13 13002.45,-4063.29 12975.92,-4052.71"/>
<polygon fill="black" stroke="black" points="12976.89,-4049.33 12966.3,-4048.88 12974.3,-4055.83 12976.89,-4049.33"/>
</g>
<!-- kv_send3_1_12 -->
<g id="node1999" class="node">
<title>kv_send3_1_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12666" cy="-3932.49" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12666" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="12666" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_1_12&#45;&gt;kv_send3_1_12 -->
<g id="edge2776" class="edge">
<title>ring_stage3_1_12&#45;&gt;kv_send3_1_12</title>
<path fill="none" stroke="black" d="M13482.89,-3996.64C13479.9,-3996.18 13476.93,-3995.75 13474,-3995.36 13169.63,-3954.61 13088.33,-4000.38 12784,-3959.36 12773.42,-3957.94 12762.38,-3956.05 12751.48,-3953.95"/>
<polygon fill="black" stroke="black" points="12752.02,-3950.49 12741.53,-3951.97 12750.65,-3957.36 12752.02,-3950.49"/>
</g>
<!-- ring_stage3_2_12 -->
<g id="node2015" class="node">
<title>ring_stage3_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13475,-3958.99 13255,-3958.99 13255,-3905.99 13475,-3905.99 13475,-3958.99"/>
<text text-anchor="middle" x="13365" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="13365" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_10×V_10</text>
<text text-anchor="middle" x="13365" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_1_12&#45;&gt;ring_stage3_2_12 -->
<g id="edge2822" class="edge">
<title>ring_stage3_1_12&#45;&gt;ring_stage3_2_12</title>
<path fill="none" stroke="black" d="M13526.44,-3995.62C13499.75,-3985.35 13468.84,-3973.45 13441.25,-3962.83"/>
<polygon fill="black" stroke="black" points="13442.23,-3959.46 13431.64,-3959.14 13439.72,-3966 13442.23,-3959.46"/>
</g>
<!-- kv_send3_1_13 -->
<g id="node2000" class="node">
<title>kv_send3_1_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12213" cy="-3842.75" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12213" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12213" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_1_13&#45;&gt;kv_send3_1_13 -->
<g id="edge2779" class="edge">
<title>ring_stage3_1_13&#45;&gt;kv_send3_1_13</title>
<path fill="none" stroke="black" d="M12215.82,-3905.64C12215.45,-3897.59 12215.04,-3888.56 12214.65,-3879.94"/>
<polygon fill="black" stroke="black" points="12218.14,-3879.55 12214.18,-3869.72 12211.14,-3879.87 12218.14,-3879.55"/>
</g>
<!-- ring_stage3_2_13 -->
<g id="node2016" class="node">
<title>ring_stage3_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12561,-3869.25 12341,-3869.25 12341,-3816.25 12561,-3816.25 12561,-3869.25"/>
<text text-anchor="middle" x="12451" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="12451" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_11×V_11</text>
<text text-anchor="middle" x="12451" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_1_13&#45;&gt;ring_stage3_2_13 -->
<g id="edge2825" class="edge">
<title>ring_stage3_1_13&#45;&gt;ring_stage3_2_13</title>
<path fill="none" stroke="black" d="M12285.31,-3905.88C12312.82,-3895.56 12344.71,-3883.61 12373.11,-3872.96"/>
<polygon fill="black" stroke="black" points="12374.47,-3876.19 12382.6,-3869.4 12372.01,-3869.63 12374.47,-3876.19"/>
</g>
<!-- kv_send3_1_14 -->
<g id="node2001" class="node">
<title>kv_send3_1_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12785" cy="-5188.85" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12785" y="-5192.65" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12785" y="-5177.65" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_1_14&#45;&gt;kv_send3_1_14 -->
<g id="edge2782" class="edge">
<title>ring_stage3_1_14&#45;&gt;kv_send3_1_14</title>
<path fill="none" stroke="black" d="M12775.12,-5251.74C12776.42,-5243.6 12777.88,-5234.46 12779.27,-5225.76"/>
<polygon fill="black" stroke="black" points="12782.74,-5226.25 12780.86,-5215.82 12775.82,-5225.15 12782.74,-5226.25"/>
</g>
<!-- ring_stage3_2_14 -->
<g id="node2017" class="node">
<title>ring_stage3_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12294,-3779.51 12074,-3779.51 12074,-3726.51 12294,-3726.51 12294,-3779.51"/>
<text text-anchor="middle" x="12184" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="12184" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_12×V_12</text>
<text text-anchor="middle" x="12184" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_1_14&#45;&gt;ring_stage3_2_14 -->
<g id="edge2828" class="edge">
<title>ring_stage3_1_14&#45;&gt;ring_stage3_2_14</title>
<path fill="none" stroke="black" d="M12710.92,-5251.96C12694.52,-5242.56 12677.98,-5230.52 12666,-5215.72 12623.69,-5163.46 12652.94,-5129.7 12618,-5072.24 12589.14,-5024.78 12570.07,-5021.99 12531,-4982.5 12503.07,-4954.27 12423.22,-4891.52 12404,-4856.76 12382.8,-4818.42 12318,-4515.75 12318,-4471.93 12318,-4471.93 12318,-4471.93 12318,-4380.19 12318,-4327.11 12326.24,-4301.4 12288,-4264.58 12234.24,-4212.82 12176.57,-4281.55 12124,-4228.58 12095.28,-4199.65 12110.07,-4179.29 12105,-4138.84 12096.07,-4067.59 12060.57,-3879.43 12094,-3815.88 12100.26,-3803.98 12109.96,-3793.92 12120.71,-3785.61"/>
<polygon fill="black" stroke="black" points="12123.02,-3788.26 12129.1,-3779.58 12118.94,-3782.57 12123.02,-3788.26"/>
</g>
<!-- kv_send3_1_15 -->
<g id="node2002" class="node">
<title>kv_send3_1_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13306" cy="-5099.11" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13306" y="-5102.91" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13306" y="-5087.91" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_1_15&#45;&gt;kv_send3_1_15 -->
<g id="edge2785" class="edge">
<title>ring_stage3_1_15&#45;&gt;kv_send3_1_15</title>
<path fill="none" stroke="black" d="M13170.05,-5162.24C13194.29,-5151.16 13222.67,-5138.19 13247.21,-5126.98"/>
<polygon fill="black" stroke="black" points="13248.77,-5130.11 13256.41,-5122.77 13245.86,-5123.75 13248.77,-5130.11"/>
</g>
<!-- ring_stage3_2_15 -->
<g id="node2018" class="node">
<title>ring_stage3_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12895,-5125.61 12675,-5125.61 12675,-5072.61 12895,-5072.61 12895,-5125.61"/>
<text text-anchor="middle" x="12785" y="-5110.41" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="12785" y="-5095.41" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_13×V_13</text>
<text text-anchor="middle" x="12785" y="-5080.41" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_1_15&#45;&gt;ring_stage3_2_15 -->
<g id="edge2831" class="edge">
<title>ring_stage3_1_15&#45;&gt;ring_stage3_2_15</title>
<path fill="none" stroke="black" d="M13017.96,-5162.24C12978.01,-5151.59 12931.51,-5139.18 12890.6,-5128.28"/>
<polygon fill="black" stroke="black" points="12891.44,-5124.88 12880.88,-5125.68 12889.64,-5131.64 12891.44,-5124.88"/>
</g>
<!-- kv_send3_1_0&#45;&gt;ring_stage3_2_1 -->
<g id="edge2790" class="edge">
<title>kv_send3_1_0&#45;&gt;ring_stage3_2_1</title>
<path fill="none" stroke="black" d="M14098.46,-4983.7C14111.68,-4973.95 14127.03,-4962.63 14141.05,-4952.3"/>
<polygon fill="black" stroke="black" points="14143.16,-4955.1 14149.13,-4946.34 14139,-4949.46 14143.16,-4955.1"/>
</g>
<!-- kv_send3_1_1&#45;&gt;ring_stage3_2_2 -->
<g id="edge2793" class="edge">
<title>kv_send3_1_1&#45;&gt;ring_stage3_2_2</title>
<path fill="none" stroke="black" d="M14773,-4892.31C14773,-4884.27 14773,-4875.29 14773,-4866.73"/>
<polygon fill="black" stroke="black" points="14776.5,-4866.6 14773,-4856.6 14769.5,-4866.6 14776.5,-4866.6"/>
</g>
<!-- kv_send3_1_2&#45;&gt;ring_stage3_2_3 -->
<g id="edge2796" class="edge">
<title>kv_send3_1_2&#45;&gt;ring_stage3_2_3</title>
<path fill="none" stroke="black" d="M15066.3,-4811.48C15078.57,-4808.65 15091.14,-4805.75 15103,-4803.02 15169.77,-4787.66 15188.73,-4783.83 15259.41,-4767.15"/>
<polygon fill="black" stroke="black" points="15260.32,-4770.53 15269.25,-4764.82 15258.71,-4763.72 15260.32,-4770.53"/>
</g>
<!-- kv_send3_1_3&#45;&gt;ring_stage3_2_4 -->
<g id="edge2799" class="edge">
<title>kv_send3_1_3&#45;&gt;ring_stage3_2_4</title>
<path fill="none" stroke="black" d="M15076.65,-4720.73C15063.22,-4717.81 15049.24,-4715.15 15036,-4713.28 14738.52,-4671.32 14658.85,-4716.56 14361,-4677.28 14355.96,-4676.62 14350.83,-4675.86 14345.65,-4675.03"/>
<polygon fill="black" stroke="black" points="14346.1,-4671.55 14335.66,-4673.34 14344.94,-4678.46 14346.1,-4671.55"/>
</g>
<!-- kv_send3_1_4&#45;&gt;ring_stage3_2_5 -->
<g id="edge2802" class="edge">
<title>kv_send3_1_4&#45;&gt;ring_stage3_2_5</title>
<path fill="none" stroke="black" d="M13564,-4623.09C13564,-4615.05 13564,-4606.07 13564,-4597.51"/>
<polygon fill="black" stroke="black" points="13567.5,-4597.37 13564,-4587.37 13560.5,-4597.37 13567.5,-4597.37"/>
</g>
<!-- kv_send3_1_5&#45;&gt;ring_stage3_2_6 -->
<g id="edge2805" class="edge">
<title>kv_send3_1_5&#45;&gt;ring_stage3_2_6</title>
<path fill="none" stroke="black" d="M12898.8,-4533.35C12899.35,-4525.31 12899.96,-4516.33 12900.55,-4507.77"/>
<polygon fill="black" stroke="black" points="12904.05,-4507.85 12901.24,-4497.63 12897.07,-4507.37 12904.05,-4507.85"/>
</g>
<!-- kv_send3_1_6&#45;&gt;ring_stage3_2_7 -->
<g id="edge2808" class="edge">
<title>kv_send3_1_6&#45;&gt;ring_stage3_2_7</title>
<path fill="none" stroke="black" d="M13129.8,-4443.61C13129.43,-4435.57 13129.02,-4426.59 13128.63,-4418.03"/>
<polygon fill="black" stroke="black" points="13132.12,-4417.72 13128.17,-4407.89 13125.13,-4418.04 13132.12,-4417.72"/>
</g>
<!-- kv_send3_1_7&#45;&gt;ring_stage3_2_8 -->
<g id="edge2811" class="edge">
<title>kv_send3_1_7&#45;&gt;ring_stage3_2_8</title>
<path fill="none" stroke="black" d="M13782.9,-4353.87C13783.17,-4345.83 13783.48,-4336.85 13783.77,-4328.29"/>
<polygon fill="black" stroke="black" points="13787.28,-4328.27 13784.12,-4318.15 13780.28,-4328.03 13787.28,-4328.27"/>
</g>
<!-- kv_send3_1_8&#45;&gt;ring_stage3_2_9 -->
<g id="edge2814" class="edge">
<title>kv_send3_1_8&#45;&gt;ring_stage3_2_9</title>
<path fill="none" stroke="black" d="M14485.26,-4264.6C14489.61,-4256.12 14494.51,-4246.56 14499.14,-4237.53"/>
<polygon fill="black" stroke="black" points="14502.39,-4238.87 14503.84,-4228.38 14496.16,-4235.68 14502.39,-4238.87"/>
</g>
<!-- kv_send3_1_9&#45;&gt;ring_stage3_2_10 -->
<g id="edge2817" class="edge">
<title>kv_send3_1_9&#45;&gt;ring_stage3_2_10</title>
<path fill="none" stroke="black" d="M14062.99,-4174.86C14061.4,-4166.65 14059.61,-4157.42 14057.91,-4148.64"/>
<polygon fill="black" stroke="black" points="14061.31,-4147.79 14055.97,-4138.64 14054.44,-4149.12 14061.31,-4147.79"/>
</g>
<!-- kv_send3_1_10&#45;&gt;ring_stage3_2_11 -->
<g id="edge2820" class="edge">
<title>kv_send3_1_10&#45;&gt;ring_stage3_2_11</title>
<path fill="none" stroke="black" d="M12889.3,-4085.12C12890.99,-4076.91 12892.88,-4067.68 12894.68,-4058.9"/>
<polygon fill="black" stroke="black" points="12898.15,-4059.4 12896.73,-4048.9 12891.3,-4057.99 12898.15,-4059.4"/>
</g>
<!-- kv_send3_1_11&#45;&gt;ring_stage3_2_12 -->
<g id="edge2823" class="edge">
<title>kv_send3_1_11&#45;&gt;ring_stage3_2_12</title>
<path fill="none" stroke="black" d="M13189.14,-3999.43C13218.71,-3988.35 13255.05,-3974.72 13287,-3962.74"/>
<polygon fill="black" stroke="black" points="13288.63,-3965.86 13296.77,-3959.08 13286.18,-3959.31 13288.63,-3965.86"/>
</g>
<!-- kv_send3_1_12&#45;&gt;ring_stage3_2_13 -->
<g id="edge2826" class="edge">
<title>kv_send3_1_12&#45;&gt;ring_stage3_2_13</title>
<path fill="none" stroke="black" d="M12611.19,-3909.12C12584.48,-3898.22 12551.99,-3884.97 12523.28,-3873.25"/>
<polygon fill="black" stroke="black" points="12524.28,-3869.88 12513.7,-3869.34 12521.64,-3876.36 12524.28,-3869.88"/>
</g>
<!-- kv_send3_1_13&#45;&gt;ring_stage3_2_14 -->
<g id="edge2829" class="edge">
<title>kv_send3_1_13&#45;&gt;ring_stage3_2_14</title>
<path fill="none" stroke="black" d="M12204.46,-3815.9C12201.71,-3807.6 12198.62,-3798.26 12195.7,-3789.4"/>
<polygon fill="black" stroke="black" points="12198.94,-3788.07 12192.48,-3779.68 12192.3,-3790.27 12198.94,-3788.07"/>
</g>
<!-- kv_send3_1_14&#45;&gt;ring_stage3_2_15 -->
<g id="edge2832" class="edge">
<title>kv_send3_1_14&#45;&gt;ring_stage3_2_15</title>
<path fill="none" stroke="black" d="M12785,-5161.53C12785,-5153.49 12785,-5144.51 12785,-5135.95"/>
<polygon fill="black" stroke="black" points="12788.5,-5135.82 12785,-5125.82 12781.5,-5135.82 12788.5,-5135.82"/>
</g>
<!-- kv_send3_1_15&#45;&gt;ring_stage3_2_0 -->
<g id="edge2787" class="edge">
<title>kv_send3_1_15&#45;&gt;ring_stage3_2_0</title>
<path fill="none" stroke="black" d="M13355.7,-5075.52C13379.38,-5064.76 13408.01,-5051.74 13433.44,-5040.18"/>
<polygon fill="black" stroke="black" points="13434.99,-5043.32 13442.65,-5035.99 13432.09,-5036.94 13434.99,-5043.32"/>
</g>
<!-- kv_send3_2_0 -->
<g id="node2019" class="node">
<title>kv_send3_2_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13789" cy="-4919.63" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13789" y="-4923.43" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="13789" y="-4908.43" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_2_0&#45;&gt;kv_send3_2_0 -->
<g id="edge2788" class="edge">
<title>ring_stage3_2_0&#45;&gt;kv_send3_2_0</title>
<path fill="none" stroke="black" d="M13583.66,-4982.76C13624.74,-4970.33 13673.69,-4955.52 13713.49,-4943.48"/>
<polygon fill="black" stroke="black" points="13714.58,-4946.8 13723.14,-4940.56 13712.56,-4940.1 13714.58,-4946.8"/>
</g>
<!-- ring_stage3_3_0 -->
<g id="node2035" class="node">
<title>ring_stage3_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13442.5,-4946.13 13231.5,-4946.13 13231.5,-4893.13 13442.5,-4893.13 13442.5,-4946.13"/>
<text text-anchor="middle" x="13337" y="-4930.93" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="13337" y="-4915.93" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_13×V_13</text>
<text text-anchor="middle" x="13337" y="-4900.93" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_2_0&#45;&gt;ring_stage3_3_0 -->
<g id="edge2834" class="edge">
<title>ring_stage3_2_0&#45;&gt;ring_stage3_3_0</title>
<path fill="none" stroke="black" d="M13451.71,-4982.76C13433.41,-4972.85 13412.31,-4961.42 13393.24,-4951.09"/>
<polygon fill="black" stroke="black" points="13394.81,-4947.96 13384.35,-4946.28 13391.48,-4954.12 13394.81,-4947.96"/>
</g>
<!-- kv_send3_2_1 -->
<g id="node2020" class="node">
<title>kv_send3_2_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14354" cy="-4829.89" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14354" y="-4833.69" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="14354" y="-4818.69" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_2_1&#45;&gt;kv_send3_2_1 -->
<g id="edge2791" class="edge">
<title>ring_stage3_2_1&#45;&gt;kv_send3_2_1</title>
<path fill="none" stroke="black" d="M14233.63,-4893.02C14254.47,-4882.26 14278.76,-4869.73 14300.04,-4858.74"/>
<polygon fill="black" stroke="black" points="14301.67,-4861.84 14308.95,-4854.14 14298.46,-4855.62 14301.67,-4861.84"/>
</g>
<!-- ring_stage3_3_1 -->
<g id="node2036" class="node">
<title>ring_stage3_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14119.5,-4856.39 13908.5,-4856.39 13908.5,-4803.39 14119.5,-4803.39 14119.5,-4856.39"/>
<text text-anchor="middle" x="14014" y="-4841.19" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14014" y="-4826.19" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_14×V_14</text>
<text text-anchor="middle" x="14014" y="-4811.19" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_2_1&#45;&gt;ring_stage3_3_1 -->
<g id="edge2837" class="edge">
<title>ring_stage3_2_1&#45;&gt;ring_stage3_3_1</title>
<path fill="none" stroke="black" d="M14134.37,-4893.02C14115.08,-4883.06 14092.83,-4871.58 14072.75,-4861.21"/>
<polygon fill="black" stroke="black" points="14074.18,-4858.01 14063.69,-4856.54 14070.97,-4864.24 14074.18,-4858.01"/>
</g>
<!-- kv_send3_2_2 -->
<g id="node2021" class="node">
<title>kv_send3_2_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14924" cy="-4740.15" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14924" y="-4743.95" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="14924" y="-4728.95" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_2_2&#45;&gt;kv_send3_2_2 -->
<g id="edge2794" class="edge">
<title>ring_stage3_2_2&#45;&gt;kv_send3_2_2</title>
<path fill="none" stroke="black" d="M14817.08,-4803.28C14835.04,-4792.85 14855.87,-4780.74 14874.36,-4770"/>
<polygon fill="black" stroke="black" points="14876.34,-4772.9 14883.22,-4764.85 14872.82,-4766.84 14876.34,-4772.9"/>
</g>
<!-- ring_stage3_3_2 -->
<g id="node2037" class="node">
<title>ring_stage3_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14578.5,-4766.65 14367.5,-4766.65 14367.5,-4713.65 14578.5,-4713.65 14578.5,-4766.65"/>
<text text-anchor="middle" x="14473" y="-4751.45" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14473" y="-4736.45" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_15×V_15</text>
<text text-anchor="middle" x="14473" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_2_2&#45;&gt;ring_stage3_3_2 -->
<g id="edge2840" class="edge">
<title>ring_stage3_2_2&#45;&gt;ring_stage3_3_2</title>
<path fill="none" stroke="black" d="M14685.42,-4803.28C14649.3,-4792.72 14607.31,-4780.43 14570.24,-4769.59"/>
<polygon fill="black" stroke="black" points="14571.01,-4766.17 14560.43,-4766.72 14569.04,-4772.89 14571.01,-4766.17"/>
</g>
<!-- kv_send3_2_3 -->
<g id="node2022" class="node">
<title>kv_send3_2_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14844" cy="-4650.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14844" y="-4654.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="14844" y="-4639.21" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_2_3&#45;&gt;kv_send3_2_3 -->
<g id="edge2797" class="edge">
<title>ring_stage3_2_3&#45;&gt;kv_send3_2_3</title>
<path fill="none" stroke="black" d="M15269.32,-4715.15C15266.18,-4714.5 15263.07,-4713.87 15260,-4713.28 15148.91,-4691.84 15119.88,-4694.1 15008,-4677.28 14986.12,-4673.99 14962.63,-4670.35 14940.44,-4666.87"/>
<polygon fill="black" stroke="black" points="14940.78,-4663.38 14930.35,-4665.28 14939.69,-4670.29 14940.78,-4663.38"/>
</g>
<!-- ring_stage3_3_3 -->
<g id="node2038" class="node">
<title>ring_stage3_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15460.5,-4676.91 15267.5,-4676.91 15267.5,-4623.91 15460.5,-4623.91 15460.5,-4676.91"/>
<text text-anchor="middle" x="15364" y="-4661.71" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="15364" y="-4646.71" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_0×V_0</text>
<text text-anchor="middle" x="15364" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_2_3&#45;&gt;ring_stage3_3_3 -->
<g id="edge2843" class="edge">
<title>ring_stage3_2_3&#45;&gt;ring_stage3_3_3</title>
<path fill="none" stroke="black" d="M15365.41,-4713.3C15365.22,-4705.09 15365.01,-4695.86 15364.81,-4687.08"/>
<polygon fill="black" stroke="black" points="15368.31,-4687 15364.59,-4677.08 15361.31,-4687.16 15368.31,-4687"/>
</g>
<!-- kv_send3_2_4 -->
<g id="node2023" class="node">
<title>kv_send3_2_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14011" cy="-4560.67" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14011" y="-4564.47" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14011" y="-4549.47" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_2_4&#45;&gt;kv_send3_2_4 -->
<g id="edge2800" class="edge">
<title>ring_stage3_2_4&#45;&gt;kv_send3_2_4</title>
<path fill="none" stroke="black" d="M14172.44,-4623.8C14142.31,-4612.21 14106.81,-4598.54 14076.78,-4586.99"/>
<polygon fill="black" stroke="black" points="14077.82,-4583.64 14067.23,-4583.31 14075.31,-4590.17 14077.82,-4583.64"/>
</g>
<!-- ring_stage3_3_4 -->
<g id="node2039" class="node">
<title>ring_stage3_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14927.5,-4587.17 14734.5,-4587.17 14734.5,-4534.17 14927.5,-4534.17 14927.5,-4587.17"/>
<text text-anchor="middle" x="14831" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14831" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_1×V_1</text>
<text text-anchor="middle" x="14831" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_2_4&#45;&gt;ring_stage3_3_4 -->
<g id="edge2846" class="edge">
<title>ring_stage3_2_4&#45;&gt;ring_stage3_3_4</title>
<path fill="none" stroke="black" d="M14335.76,-4628.17C14344.28,-4626.52 14352.78,-4624.95 14361,-4623.54 14485.17,-4602.24 14628.9,-4584.29 14724.4,-4573.3"/>
<polygon fill="black" stroke="black" points="14724.82,-4576.78 14734.35,-4572.16 14724.02,-4569.82 14724.82,-4576.78"/>
</g>
<!-- kv_send3_2_5 -->
<g id="node2024" class="node">
<title>kv_send3_2_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13355" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13355" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="13355" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_2_5&#45;&gt;kv_send3_2_5 -->
<g id="edge2803" class="edge">
<title>ring_stage3_2_5&#45;&gt;kv_send3_2_5</title>
<path fill="none" stroke="black" d="M13502.99,-4534.06C13476.04,-4522.75 13444.4,-4509.46 13417.31,-4498.09"/>
<polygon fill="black" stroke="black" points="13418.51,-4494.8 13407.93,-4494.15 13415.8,-4501.25 13418.51,-4494.8"/>
</g>
<!-- ring_stage3_3_5 -->
<g id="node2040" class="node">
<title>ring_stage3_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14105.5,-4497.43 13912.5,-4497.43 13912.5,-4444.43 14105.5,-4444.43 14105.5,-4497.43"/>
<text text-anchor="middle" x="14009" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14009" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_2×V_2</text>
<text text-anchor="middle" x="14009" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_2_5&#45;&gt;ring_stage3_3_5 -->
<g id="edge2849" class="edge">
<title>ring_stage3_2_5&#45;&gt;ring_stage3_3_5</title>
<path fill="none" stroke="black" d="M13660.69,-4535.71C13663.82,-4535.05 13666.93,-4534.41 13670,-4533.8 13769.66,-4513.98 13798.5,-4517.97 13902.36,-4497.85"/>
<polygon fill="black" stroke="black" points="13903.18,-4501.26 13912.31,-4495.89 13901.83,-4494.39 13903.18,-4501.26"/>
</g>
<!-- kv_send3_2_6 -->
<g id="node2025" class="node">
<title>kv_send3_2_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12698" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12698" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="12698" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_2_6&#45;&gt;kv_send3_2_6 -->
<g id="edge2806" class="edge">
<title>ring_stage3_2_6&#45;&gt;kv_send3_2_6</title>
<path fill="none" stroke="black" d="M12843.15,-4444.32C12816.95,-4433.1 12786.21,-4419.95 12759.78,-4408.64"/>
<polygon fill="black" stroke="black" points="12760.83,-4405.28 12750.26,-4404.56 12758.08,-4411.71 12760.83,-4405.28"/>
</g>
<!-- ring_stage3_3_6 -->
<g id="node2041" class="node">
<title>ring_stage3_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13012.5,-4407.69 12819.5,-4407.69 12819.5,-4354.69 13012.5,-4354.69 13012.5,-4407.69"/>
<text text-anchor="middle" x="12916" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="12916" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_3×V_3</text>
<text text-anchor="middle" x="12916" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_2_6&#45;&gt;ring_stage3_3_6 -->
<g id="edge2852" class="edge">
<title>ring_stage3_2_6&#45;&gt;ring_stage3_3_6</title>
<path fill="none" stroke="black" d="M12906.83,-4444.08C12908.05,-4435.87 12909.41,-4426.64 12910.71,-4417.86"/>
<polygon fill="black" stroke="black" points="12914.19,-4418.26 12912.2,-4407.86 12907.27,-4417.24 12914.19,-4418.26"/>
</g>
<!-- kv_send3_2_7 -->
<g id="node2026" class="node">
<title>kv_send3_2_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13119" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13119" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="13119" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_2_7&#45;&gt;kv_send3_2_7 -->
<g id="edge2809" class="edge">
<title>ring_stage3_2_7&#45;&gt;kv_send3_2_7</title>
<path fill="none" stroke="black" d="M13124.64,-4354.34C13123.91,-4346.29 13123.09,-4337.26 13122.3,-4328.64"/>
<polygon fill="black" stroke="black" points="13125.76,-4328.06 13121.37,-4318.42 13118.79,-4328.7 13125.76,-4328.06"/>
</g>
<!-- ring_stage3_3_7 -->
<g id="node2042" class="node">
<title>ring_stage3_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12794.5,-4317.95 12601.5,-4317.95 12601.5,-4264.95 12794.5,-4264.95 12794.5,-4317.95"/>
<text text-anchor="middle" x="12698" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="12698" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_4×V_4</text>
<text text-anchor="middle" x="12698" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_2_7&#45;&gt;ring_stage3_3_7 -->
<g id="edge2855" class="edge">
<title>ring_stage3_2_7&#45;&gt;ring_stage3_3_7</title>
<path fill="none" stroke="black" d="M13030.35,-4356.18C13027.54,-4355.54 13024.75,-4354.92 13022,-4354.32 12949.78,-4338.54 12868,-4322.94 12804.68,-4311.36"/>
<polygon fill="black" stroke="black" points="12805.14,-4307.88 12794.68,-4309.53 12803.89,-4314.77 12805.14,-4307.88"/>
</g>
<!-- kv_send3_2_8 -->
<g id="node2027" class="node">
<title>kv_send3_2_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13837" cy="-4201.71" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13837" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="13837" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_2_8&#45;&gt;kv_send3_2_8 -->
<g id="edge2812" class="edge">
<title>ring_stage3_2_8&#45;&gt;kv_send3_2_8</title>
<path fill="none" stroke="black" d="M13800.32,-4264.6C13805.4,-4256.03 13811.13,-4246.36 13816.54,-4237.24"/>
<polygon fill="black" stroke="black" points="13819.7,-4238.76 13821.79,-4228.38 13813.68,-4235.2 13819.7,-4238.76"/>
</g>
<!-- ring_stage3_3_8 -->
<g id="node2043" class="node">
<title>ring_stage3_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13257.5,-4228.21 13064.5,-4228.21 13064.5,-4175.21 13257.5,-4175.21 13257.5,-4228.21"/>
<text text-anchor="middle" x="13161" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="13161" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_5×V_5</text>
<text text-anchor="middle" x="13161" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_2_8&#45;&gt;ring_stage3_3_8 -->
<g id="edge2858" class="edge">
<title>ring_stage3_2_8&#45;&gt;ring_stage3_3_8</title>
<path fill="none" stroke="black" d="M13688.43,-4266.06C13685.59,-4265.54 13682.78,-4265.04 13680,-4264.58 13501.42,-4234.98 13450.58,-4257.68 13267.59,-4228.55"/>
<polygon fill="black" stroke="black" points="13268.07,-4225.09 13257.64,-4226.94 13266.95,-4232 13268.07,-4225.09"/>
</g>
<!-- kv_send3_2_9 -->
<g id="node2028" class="node">
<title>kv_send3_2_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14491" cy="-4111.97" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14491" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14491" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_2_9&#45;&gt;kv_send3_2_9 -->
<g id="edge2815" class="edge">
<title>ring_stage3_2_9&#45;&gt;kv_send3_2_9</title>
<path fill="none" stroke="black" d="M14509.34,-4174.86C14506.9,-4166.63 14504.16,-4157.38 14501.56,-4148.59"/>
<polygon fill="black" stroke="black" points="14504.89,-4147.53 14498.7,-4138.94 14498.18,-4149.52 14504.89,-4147.53"/>
</g>
<!-- ring_stage3_3_9 -->
<g id="node2044" class="node">
<title>ring_stage3_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14363.5,-4138.47 14170.5,-4138.47 14170.5,-4085.47 14363.5,-4085.47 14363.5,-4138.47"/>
<text text-anchor="middle" x="14267" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14267" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_6×V_6</text>
<text text-anchor="middle" x="14267" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_2_9&#45;&gt;ring_stage3_3_9 -->
<g id="edge2861" class="edge">
<title>ring_stage3_2_9&#45;&gt;ring_stage3_3_9</title>
<path fill="none" stroke="black" d="M14444.02,-4175.1C14414.5,-4164.74 14380.26,-4152.72 14349.82,-4142.04"/>
<polygon fill="black" stroke="black" points="14350.67,-4138.63 14340.07,-4138.62 14348.35,-4145.23 14350.67,-4138.63"/>
</g>
<!-- kv_send3_2_10 -->
<g id="node2029" class="node">
<title>kv_send3_2_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13831" cy="-4022.23" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13831" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="13831" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_2_10&#45;&gt;kv_send3_2_10 -->
<g id="edge2818" class="edge">
<title>ring_stage3_2_10&#45;&gt;kv_send3_2_10</title>
<path fill="none" stroke="black" d="M13986.78,-4085.36C13958.29,-4074 13924.82,-4060.65 13896.22,-4049.24"/>
<polygon fill="black" stroke="black" points="13897.3,-4045.91 13886.72,-4045.45 13894.71,-4052.41 13897.3,-4045.91"/>
</g>
<!-- ring_stage3_3_10 -->
<g id="node2045" class="node">
<title>ring_stage3_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14372,-4048.73 14170,-4048.73 14170,-3995.73 14372,-3995.73 14372,-4048.73"/>
<text text-anchor="middle" x="14271" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="14271" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_7×V_7</text>
<text text-anchor="middle" x="14271" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_2_10&#45;&gt;ring_stage3_3_10 -->
<g id="edge2864" class="edge">
<title>ring_stage3_2_10&#45;&gt;ring_stage3_3_10</title>
<path fill="none" stroke="black" d="M14115.22,-4085.36C14140.87,-4075.13 14170.55,-4063.29 14197.08,-4052.71"/>
<polygon fill="black" stroke="black" points="14198.7,-4055.83 14206.7,-4048.88 14196.11,-4049.33 14198.7,-4055.83"/>
</g>
<!-- kv_send3_2_11 -->
<g id="node2030" class="node">
<title>kv_send3_2_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12903" cy="-3932.49" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12903" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="12903" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_2_11&#45;&gt;kv_send3_2_11 -->
<g id="edge2821" class="edge">
<title>ring_stage3_2_11&#45;&gt;kv_send3_2_11</title>
<path fill="none" stroke="black" d="M12902.29,-3995.38C12902.39,-3987.33 12902.49,-3978.3 12902.59,-3969.68"/>
<polygon fill="black" stroke="black" points="12906.09,-3969.5 12902.7,-3959.46 12899.09,-3969.42 12906.09,-3969.5"/>
</g>
<!-- ring_stage3_3_11 -->
<g id="node2046" class="node">
<title>ring_stage3_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13695,-3958.99 13493,-3958.99 13493,-3905.99 13695,-3905.99 13695,-3958.99"/>
<text text-anchor="middle" x="13594" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="13594" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_8×V_8</text>
<text text-anchor="middle" x="13594" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_2_11&#45;&gt;ring_stage3_3_11 -->
<g id="edge2867" class="edge">
<title>ring_stage3_2_11&#45;&gt;ring_stage3_3_11</title>
<path fill="none" stroke="black" d="M13003.18,-3996.81C13006.15,-3996.3 13009.09,-3995.81 13012,-3995.36 13216.66,-3963.69 13274.3,-3990.67 13482.78,-3959.44"/>
<polygon fill="black" stroke="black" points="13483.46,-3962.88 13492.82,-3957.91 13482.41,-3955.96 13483.46,-3962.88"/>
</g>
<!-- kv_send3_2_12 -->
<g id="node2031" class="node">
<title>kv_send3_2_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12913" cy="-3842.75" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12913" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="12913" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_2_12&#45;&gt;kv_send3_2_12 -->
<g id="edge2824" class="edge">
<title>ring_stage3_2_12&#45;&gt;kv_send3_2_12</title>
<path fill="none" stroke="black" d="M13254.82,-3907.35C13251.85,-3906.76 13248.91,-3906.18 13246,-3905.62 13151.29,-3887.37 13126.71,-3887.87 13032,-3869.62 13022.27,-3867.75 13012.11,-3865.69 13002.01,-3863.58"/>
<polygon fill="black" stroke="black" points="13002.45,-3860.1 12991.95,-3861.46 13001.01,-3866.95 13002.45,-3860.1"/>
</g>
<!-- ring_stage3_3_12 -->
<g id="node2047" class="node">
<title>ring_stage3_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13243,-3869.25 13041,-3869.25 13041,-3816.25 13243,-3816.25 13243,-3869.25"/>
<text text-anchor="middle" x="13142" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="13142" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_9×V_9</text>
<text text-anchor="middle" x="13142" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_2_12&#45;&gt;ring_stage3_3_12 -->
<g id="edge2870" class="edge">
<title>ring_stage3_2_12&#45;&gt;ring_stage3_3_12</title>
<path fill="none" stroke="black" d="M13299.9,-3905.88C13273.79,-3895.61 13243.56,-3883.71 13216.58,-3873.09"/>
<polygon fill="black" stroke="black" points="13217.77,-3869.8 13207.18,-3869.4 13215.21,-3876.32 13217.77,-3869.8"/>
</g>
<!-- kv_send3_2_13 -->
<g id="node2032" class="node">
<title>kv_send3_2_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12423" cy="-3753.01" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12423" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12423" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_2_13&#45;&gt;kv_send3_2_13 -->
<g id="edge2827" class="edge">
<title>ring_stage3_2_13&#45;&gt;kv_send3_2_13</title>
<path fill="none" stroke="black" d="M12442.75,-3815.9C12440.13,-3807.67 12437.17,-3798.42 12434.37,-3789.63"/>
<polygon fill="black" stroke="black" points="12437.66,-3788.44 12431.29,-3779.98 12430.99,-3790.57 12437.66,-3788.44"/>
</g>
<!-- ring_stage3_3_13 -->
<g id="node2048" class="node">
<title>ring_stage3_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12774,-3779.51 12554,-3779.51 12554,-3726.51 12774,-3726.51 12774,-3779.51"/>
<text text-anchor="middle" x="12664" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="12664" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_10×V_10</text>
<text text-anchor="middle" x="12664" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_2_13&#45;&gt;ring_stage3_3_13 -->
<g id="edge2873" class="edge">
<title>ring_stage3_2_13&#45;&gt;ring_stage3_3_13</title>
<path fill="none" stroke="black" d="M12513.18,-3816.14C12538.01,-3805.91 12566.74,-3794.07 12592.43,-3783.49"/>
<polygon fill="black" stroke="black" points="12593.83,-3786.7 12601.74,-3779.66 12591.16,-3780.23 12593.83,-3786.7"/>
</g>
<!-- kv_send3_2_14 -->
<g id="node2033" class="node">
<title>kv_send3_2_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12177" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12177" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12177" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_2_14&#45;&gt;kv_send3_2_14 -->
<g id="edge2830" class="edge">
<title>ring_stage3_2_14&#45;&gt;kv_send3_2_14</title>
<path fill="none" stroke="black" d="M12181.94,-3726.16C12181.3,-3718.11 12180.57,-3709.08 12179.89,-3700.46"/>
<polygon fill="black" stroke="black" points="12183.36,-3699.93 12179.07,-3690.24 12176.38,-3700.49 12183.36,-3699.93"/>
</g>
<!-- ring_stage3_3_14 -->
<g id="node2049" class="node">
<title>ring_stage3_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12525,-3689.77 12305,-3689.77 12305,-3636.77 12525,-3636.77 12525,-3689.77"/>
<text text-anchor="middle" x="12415" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="12415" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_11×V_11</text>
<text text-anchor="middle" x="12415" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_2_14&#45;&gt;ring_stage3_3_14 -->
<g id="edge2876" class="edge">
<title>ring_stage3_2_14&#45;&gt;ring_stage3_3_14</title>
<path fill="none" stroke="black" d="M12251.44,-3726.4C12278.6,-3716.08 12310.07,-3704.13 12338.11,-3693.48"/>
<polygon fill="black" stroke="black" points="12339.37,-3696.74 12347.48,-3689.92 12336.89,-3690.2 12339.37,-3696.74"/>
</g>
<!-- kv_send3_2_15 -->
<g id="node2034" class="node">
<title>kv_send3_2_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13174" cy="-5009.37" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13174" y="-5013.17" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13174" y="-4998.17" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_2_15&#45;&gt;kv_send3_2_15 -->
<g id="edge2833" class="edge">
<title>ring_stage3_2_15&#45;&gt;kv_send3_2_15</title>
<path fill="none" stroke="black" d="M12895.17,-5073.26C12956.21,-5059.5 13030.98,-5042.63 13087.72,-5029.83"/>
<polygon fill="black" stroke="black" points="13088.76,-5033.19 13097.74,-5027.57 13087.22,-5026.36 13088.76,-5033.19"/>
</g>
<!-- ring_stage3_3_15 -->
<g id="node2050" class="node">
<title>ring_stage3_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12259,-3600.03 12039,-3600.03 12039,-3547.03 12259,-3547.03 12259,-3600.03"/>
<text text-anchor="middle" x="12149" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="12149" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_12×V_12</text>
<text text-anchor="middle" x="12149" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_2_15&#45;&gt;ring_stage3_3_15 -->
<g id="edge2879" class="edge">
<title>ring_stage3_2_15&#45;&gt;ring_stage3_3_15</title>
<path fill="none" stroke="black" d="M12770.18,-5072.34C12745.15,-5028.51 12693.28,-4936.47 12653,-4856.76 12641.12,-4833.25 12645.83,-4822.41 12628,-4803.02 12551.77,-4720.12 12496.77,-4746.6 12408,-4677.28 12364.46,-4643.28 12085.98,-4369 12064,-4318.32 12011.75,-4197.82 12048,-4154.58 12048,-4023.23 12048,-4023.23 12048,-4023.23 12048,-3752.01 12048,-3700.44 12031.93,-3680.9 12058,-3636.4 12064.99,-3624.46 12075.31,-3614.33 12086.52,-3605.93"/>
<polygon fill="black" stroke="black" points="12088.62,-3608.73 12094.8,-3600.12 12084.6,-3603 12088.62,-3608.73"/>
</g>
<!-- kv_send3_2_0&#45;&gt;ring_stage3_3_1 -->
<g id="edge2838" class="edge">
<title>kv_send3_2_0&#45;&gt;ring_stage3_3_1</title>
<path fill="none" stroke="black" d="M13844.62,-4896.94C13873.04,-4885.86 13908.04,-4872.21 13938.82,-4860.21"/>
<polygon fill="black" stroke="black" points="13940.19,-4863.43 13948.23,-4856.54 13937.64,-4856.91 13940.19,-4863.43"/>
</g>
<!-- kv_send3_2_1&#45;&gt;ring_stage3_3_2 -->
<g id="edge2841" class="edge">
<title>kv_send3_2_1&#45;&gt;ring_stage3_3_2</title>
<path fill="none" stroke="black" d="M14387.46,-4804.22C14400.68,-4794.47 14416.03,-4783.15 14430.05,-4772.82"/>
<polygon fill="black" stroke="black" points="14432.16,-4775.61 14438.13,-4766.86 14428,-4769.98 14432.16,-4775.61"/>
</g>
<!-- kv_send3_2_2&#45;&gt;ring_stage3_3_3 -->
<g id="edge2844" class="edge">
<title>kv_send3_2_2&#45;&gt;ring_stage3_3_3</title>
<path fill="none" stroke="black" d="M14998.3,-4721.49C15010.86,-4718.65 15023.79,-4715.81 15036,-4713.28 15122.73,-4695.31 15144.99,-4693.8 15232,-4677.28 15240.25,-4675.72 15248.78,-4674.08 15257.35,-4672.43"/>
<polygon fill="black" stroke="black" points="15258.27,-4675.81 15267.42,-4670.48 15256.94,-4668.94 15258.27,-4675.81"/>
</g>
<!-- kv_send3_2_3&#45;&gt;ring_stage3_3_4 -->
<g id="edge2847" class="edge">
<title>kv_send3_2_3&#45;&gt;ring_stage3_3_4</title>
<path fill="none" stroke="black" d="M14840.1,-4623.09C14838.91,-4615.05 14837.58,-4606.07 14836.31,-4597.51"/>
<polygon fill="black" stroke="black" points="14839.74,-4596.75 14834.81,-4587.37 14832.81,-4597.78 14839.74,-4596.75"/>
</g>
<!-- kv_send3_2_4&#45;&gt;ring_stage3_3_5 -->
<g id="edge2850" class="edge">
<title>kv_send3_2_4&#45;&gt;ring_stage3_3_5</title>
<path fill="none" stroke="black" d="M14010.4,-4533.35C14010.22,-4525.31 14010.01,-4516.33 14009.82,-4507.77"/>
<polygon fill="black" stroke="black" points="14013.31,-4507.55 14009.59,-4497.63 14006.31,-4507.71 14013.31,-4507.55"/>
</g>
<!-- kv_send3_2_5&#45;&gt;ring_stage3_3_6 -->
<g id="edge2853" class="edge">
<title>kv_send3_2_5&#45;&gt;ring_stage3_3_6</title>
<path fill="none" stroke="black" d="M13281.04,-4452.13C13268.38,-4449.29 13255.34,-4446.49 13243,-4444.06 13148.5,-4425.47 13121.26,-4427.7 13022.77,-4408.15"/>
<polygon fill="black" stroke="black" points="13023.19,-4404.66 13012.69,-4406.12 13021.81,-4411.52 13023.19,-4404.66"/>
</g>
<!-- kv_send3_2_6&#45;&gt;ring_stage3_3_7 -->
<g id="edge2856" class="edge">
<title>kv_send3_2_6&#45;&gt;ring_stage3_3_7</title>
<path fill="none" stroke="black" d="M12698,-4353.87C12698,-4345.83 12698,-4336.85 12698,-4328.29"/>
<polygon fill="black" stroke="black" points="12701.5,-4328.15 12698,-4318.15 12694.5,-4328.15 12701.5,-4328.15"/>
</g>
<!-- kv_send3_2_7&#45;&gt;ring_stage3_3_8 -->
<g id="edge2859" class="edge">
<title>kv_send3_2_7&#45;&gt;ring_stage3_3_8</title>
<path fill="none" stroke="black" d="M13131.37,-4264.6C13135.43,-4256.12 13140.01,-4246.56 13144.33,-4237.53"/>
<polygon fill="black" stroke="black" points="13147.55,-4238.91 13148.71,-4228.38 13141.24,-4235.89 13147.55,-4238.91"/>
</g>
<!-- kv_send3_2_8&#45;&gt;ring_stage3_3_9 -->
<g id="edge2862" class="edge">
<title>kv_send3_2_8&#45;&gt;ring_stage3_3_9</title>
<path fill="none" stroke="black" d="M13911.27,-4182.91C13923.84,-4180.09 13936.77,-4177.29 13949,-4174.84 14039.6,-4156.7 14065.69,-4158.07 14160.31,-4138.92"/>
<polygon fill="black" stroke="black" points="14161.21,-4142.31 14170.3,-4136.87 14159.8,-4135.45 14161.21,-4142.31"/>
</g>
<!-- kv_send3_2_9&#45;&gt;ring_stage3_3_10 -->
<g id="edge2865" class="edge">
<title>kv_send3_2_9&#45;&gt;ring_stage3_3_10</title>
<path fill="none" stroke="black" d="M14435.2,-4088.72C14407.75,-4077.77 14374.29,-4064.43 14344.75,-4052.65"/>
<polygon fill="black" stroke="black" points="14345.9,-4049.34 14335.32,-4048.88 14343.31,-4055.84 14345.9,-4049.34"/>
</g>
<!-- kv_send3_2_10&#45;&gt;ring_stage3_3_11 -->
<g id="edge2868" class="edge">
<title>kv_send3_2_10&#45;&gt;ring_stage3_3_11</title>
<path fill="none" stroke="black" d="M13772.11,-3999.43C13742.04,-3988.3 13705.05,-3974.6 13672.58,-3962.58"/>
<polygon fill="black" stroke="black" points="13673.7,-3959.26 13663.11,-3959.08 13671.27,-3965.83 13673.7,-3959.26"/>
</g>
<!-- kv_send3_2_11&#45;&gt;ring_stage3_3_12 -->
<g id="edge2871" class="edge">
<title>kv_send3_2_11&#45;&gt;ring_stage3_3_12</title>
<path fill="none" stroke="black" d="M12962.08,-3909.8C12992.4,-3898.67 13029.76,-3884.96 13062.57,-3872.91"/>
<polygon fill="black" stroke="black" points="13063.96,-3876.13 13072.14,-3869.4 13061.55,-3869.56 13063.96,-3876.13"/>
</g>
<!-- kv_send3_2_12&#45;&gt;ring_stage3_3_13 -->
<g id="edge2874" class="edge">
<title>kv_send3_2_12&#45;&gt;ring_stage3_3_13</title>
<path fill="none" stroke="black" d="M12852.09,-3820.29C12820.24,-3809.07 12780.8,-3795.17 12746.28,-3783"/>
<polygon fill="black" stroke="black" points="12747.28,-3779.64 12736.68,-3779.62 12744.95,-3786.25 12747.28,-3779.64"/>
</g>
<!-- kv_send3_2_13&#45;&gt;ring_stage3_3_14 -->
<g id="edge2877" class="edge">
<title>kv_send3_2_13&#45;&gt;ring_stage3_3_14</title>
<path fill="none" stroke="black" d="M12420.6,-3725.69C12419.87,-3717.65 12419.05,-3708.67 12418.27,-3700.11"/>
<polygon fill="black" stroke="black" points="12421.74,-3699.61 12417.34,-3689.97 12414.77,-3700.25 12421.74,-3699.61"/>
</g>
<!-- kv_send3_2_14&#45;&gt;ring_stage3_3_15 -->
<g id="edge2880" class="edge">
<title>kv_send3_2_14&#45;&gt;ring_stage3_3_15</title>
<path fill="none" stroke="black" d="M12168.75,-3636.42C12166.1,-3628.12 12163.12,-3618.78 12160.29,-3609.92"/>
<polygon fill="black" stroke="black" points="12163.57,-3608.66 12157.19,-3600.2 12156.9,-3610.79 12163.57,-3608.66"/>
</g>
<!-- kv_send3_2_15&#45;&gt;ring_stage3_3_0 -->
<g id="edge2835" class="edge">
<title>kv_send3_2_15&#45;&gt;ring_stage3_3_0</title>
<path fill="none" stroke="black" d="M13217.68,-4984.86C13236.99,-4974.47 13259.93,-4962.12 13280.51,-4951.04"/>
<polygon fill="black" stroke="black" points="13282.33,-4954.04 13289.48,-4946.21 13279.01,-4947.87 13282.33,-4954.04"/>
</g>
<!-- kv_send3_3_0 -->
<g id="node2051" class="node">
<title>kv_send3_3_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13512" cy="-4829.89" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13512" y="-4833.69" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="13512" y="-4818.69" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_3_0&#45;&gt;kv_send3_3_0 -->
<g id="edge2836" class="edge">
<title>ring_stage3_3_0&#45;&gt;kv_send3_3_0</title>
<path fill="none" stroke="black" d="M13388.09,-4893.02C13409.63,-4882.22 13434.75,-4869.62 13456.72,-4858.61"/>
<polygon fill="black" stroke="black" points="13458.55,-4861.6 13465.92,-4853.99 13455.42,-4855.35 13458.55,-4861.6"/>
</g>
<!-- ring_stage3_4_0 -->
<g id="node2067" class="node">
<title>ring_stage3_4_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12230.5,-3420.55 12019.5,-3420.55 12019.5,-3367.55 12230.5,-3367.55 12230.5,-3420.55"/>
<text text-anchor="middle" x="12125" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12125" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_12×V_12</text>
<text text-anchor="middle" x="12125" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_3_0&#45;&gt;ring_stage3_4_0 -->
<g id="edge2882" class="edge">
<title>ring_stage3_3_0&#45;&gt;ring_stage3_4_0</title>
<path fill="none" stroke="black" d="M13231.3,-4910.59C13059.15,-4895.07 12730.19,-4854.49 12659,-4767.02 12618.04,-4716.7 12666.7,-4678.38 12632,-4623.54 12581.18,-4543.22 12529.86,-4561.15 12459,-4497.8 12418.72,-4461.79 12410,-4450.84 12377,-4408.06 12347.99,-4370.46 12343.76,-4358.85 12319,-4318.32 12304.62,-4294.79 12310.46,-4280.58 12288,-4264.58 12219.06,-4215.48 12166.8,-4281.82 12101,-4228.58 12025.58,-4167.57 12027,-4120.24 12027,-4023.23 12027,-4023.23 12027,-4023.23 12027,-3931.49 12027,-3826.03 11979.45,-3549.48 12030,-3456.92 12036.61,-3444.83 12046.7,-3434.72 12057.89,-3426.42"/>
<polygon fill="black" stroke="black" points="12059.95,-3429.25 12066.19,-3420.69 12055.97,-3423.49 12059.95,-3429.25"/>
</g>
<!-- kv_send3_3_1 -->
<g id="node2052" class="node">
<title>kv_send3_3_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14224" cy="-4740.15" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14224" y="-4743.95" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="14224" y="-4728.95" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_3_1&#45;&gt;kv_send3_3_1 -->
<g id="edge2839" class="edge">
<title>ring_stage3_3_1&#45;&gt;kv_send3_3_1</title>
<path fill="none" stroke="black" d="M14075.31,-4803.28C14102.38,-4791.97 14134.17,-4778.68 14161.39,-4767.31"/>
<polygon fill="black" stroke="black" points="14162.94,-4770.46 14170.82,-4763.37 14160.24,-4764 14162.94,-4770.46"/>
</g>
<!-- ring_stage3_4_1 -->
<g id="node2068" class="node">
<title>ring_stage3_4_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13759.5,-4766.65 13548.5,-4766.65 13548.5,-4713.65 13759.5,-4713.65 13759.5,-4766.65"/>
<text text-anchor="middle" x="13654" y="-4751.45" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="13654" y="-4736.45" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_13×V_13</text>
<text text-anchor="middle" x="13654" y="-4721.45" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_3_1&#45;&gt;ring_stage3_4_1 -->
<g id="edge2885" class="edge">
<title>ring_stage3_3_1&#45;&gt;ring_stage3_4_1</title>
<path fill="none" stroke="black" d="M13908.91,-4803.28C13864.92,-4792.56 13813.67,-4780.07 13768.7,-4769.11"/>
<polygon fill="black" stroke="black" points="13769.46,-4765.69 13758.91,-4766.72 13767.8,-4772.49 13769.46,-4765.69"/>
</g>
<!-- kv_send3_3_2 -->
<g id="node2053" class="node">
<title>kv_send3_3_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15120" cy="-4650.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15120" y="-4654.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="15120" y="-4639.21" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_3_2&#45;&gt;kv_send3_3_2 -->
<g id="edge2842" class="edge">
<title>ring_stage3_3_2&#45;&gt;kv_send3_3_2</title>
<path fill="none" stroke="black" d="M14578.8,-4714.83C14581.9,-4714.29 14584.97,-4713.77 14588,-4713.28 14750.25,-4687.2 14792.99,-4698.09 14956,-4677.28 14978.42,-4674.42 15002.48,-4670.89 15025.09,-4667.36"/>
<polygon fill="black" stroke="black" points="15025.68,-4670.81 15035.02,-4665.79 15024.59,-4663.89 15025.68,-4670.81"/>
</g>
<!-- ring_stage3_4_2 -->
<g id="node2069" class="node">
<title>ring_stage3_4_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14580.5,-4676.91 14369.5,-4676.91 14369.5,-4623.91 14580.5,-4623.91 14580.5,-4676.91"/>
<text text-anchor="middle" x="14475" y="-4661.71" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="14475" y="-4646.71" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_14×V_14</text>
<text text-anchor="middle" x="14475" y="-4631.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_3_2&#45;&gt;ring_stage3_4_2 -->
<g id="edge2888" class="edge">
<title>ring_stage3_3_2&#45;&gt;ring_stage3_4_2</title>
<path fill="none" stroke="black" d="M14473.59,-4713.3C14473.78,-4705.09 14473.99,-4695.86 14474.19,-4687.08"/>
<polygon fill="black" stroke="black" points="14477.69,-4687.16 14474.41,-4677.08 14470.69,-4687 14477.69,-4687.16"/>
</g>
<!-- kv_send3_3_3 -->
<g id="node2054" class="node">
<title>kv_send3_3_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15049" cy="-4560.67" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15049" y="-4564.47" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15049" y="-4549.47" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_3_3&#45;&gt;kv_send3_3_3 -->
<g id="edge2845" class="edge">
<title>ring_stage3_3_3&#45;&gt;kv_send3_3_3</title>
<path fill="none" stroke="black" d="M15272.04,-4623.8C15226.21,-4611.03 15171.36,-4595.75 15127.52,-4583.54"/>
<polygon fill="black" stroke="black" points="15128.34,-4580.14 15117.77,-4580.83 15126.46,-4586.88 15128.34,-4580.14"/>
</g>
<!-- ring_stage3_4_3 -->
<g id="node2070" class="node">
<title>ring_stage3_4_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15605.5,-4587.17 15394.5,-4587.17 15394.5,-4534.17 15605.5,-4534.17 15605.5,-4587.17"/>
<text text-anchor="middle" x="15500" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="15500" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_15×V_15</text>
<text text-anchor="middle" x="15500" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_3_3&#45;&gt;ring_stage3_4_3 -->
<g id="edge2891" class="edge">
<title>ring_stage3_3_3&#45;&gt;ring_stage3_4_3</title>
<path fill="none" stroke="black" d="M15403.7,-4623.8C15418.65,-4614.15 15435.82,-4603.08 15451.49,-4592.97"/>
<polygon fill="black" stroke="black" points="15453.51,-4595.83 15460.01,-4587.47 15449.71,-4589.95 15453.51,-4595.83"/>
</g>
<!-- kv_send3_3_4 -->
<g id="node2055" class="node">
<title>kv_send3_3_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14831" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14831" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14831" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_3_4&#45;&gt;kv_send3_3_4 -->
<g id="edge2848" class="edge">
<title>ring_stage3_3_4&#45;&gt;kv_send3_3_4</title>
<path fill="none" stroke="black" d="M14831,-4533.82C14831,-4525.77 14831,-4516.74 14831,-4508.12"/>
<polygon fill="black" stroke="black" points="14834.5,-4507.9 14831,-4497.9 14827.5,-4507.9 14834.5,-4507.9"/>
</g>
<!-- ring_stage3_4_4 -->
<g id="node2071" class="node">
<title>ring_stage3_4_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15145.5,-4497.43 14952.5,-4497.43 14952.5,-4444.43 15145.5,-4444.43 15145.5,-4497.43"/>
<text text-anchor="middle" x="15049" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="15049" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_0×V_0</text>
<text text-anchor="middle" x="15049" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_3_4&#45;&gt;ring_stage3_4_4 -->
<g id="edge2894" class="edge">
<title>ring_stage3_3_4&#45;&gt;ring_stage3_4_4</title>
<path fill="none" stroke="black" d="M14894.64,-4534.06C14920.05,-4523.83 14949.46,-4512 14975.75,-4501.41"/>
<polygon fill="black" stroke="black" points="14977.31,-4504.56 14985.28,-4497.58 14974.7,-4498.06 14977.31,-4504.56"/>
</g>
<!-- kv_send3_3_5 -->
<g id="node2056" class="node">
<title>kv_send3_3_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13345" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13345" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="13345" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_3_5&#45;&gt;kv_send3_3_5 -->
<g id="edge2851" class="edge">
<title>ring_stage3_3_5&#45;&gt;kv_send3_3_5</title>
<path fill="none" stroke="black" d="M13912.37,-4445.68C13909.21,-4445.1 13906.09,-4444.56 13903,-4444.06 13707.11,-4412.44 13654.11,-4438.28 13458,-4408.06 13447.98,-4406.52 13437.52,-4404.58 13427.19,-4402.46"/>
<polygon fill="black" stroke="black" points="13427.85,-4399.02 13417.34,-4400.38 13426.4,-4405.87 13427.85,-4399.02"/>
</g>
<!-- ring_stage3_4_5 -->
<g id="node2072" class="node">
<title>ring_stage3_4_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14698.5,-4407.69 14505.5,-4407.69 14505.5,-4354.69 14698.5,-4354.69 14698.5,-4407.69"/>
<text text-anchor="middle" x="14602" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="14602" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_1×V_1</text>
<text text-anchor="middle" x="14602" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_3_5&#45;&gt;ring_stage3_4_5 -->
<g id="edge2897" class="edge">
<title>ring_stage3_3_5&#45;&gt;ring_stage3_4_5</title>
<path fill="none" stroke="black" d="M14105.62,-4448.55C14113.85,-4446.95 14122.06,-4445.43 14130,-4444.06 14254.88,-4422.56 14399.48,-4404.62 14495.39,-4393.69"/>
<polygon fill="black" stroke="black" points="14495.84,-4397.16 14505.38,-4392.56 14495.05,-4390.21 14495.84,-4397.16"/>
</g>
<!-- kv_send3_3_6 -->
<g id="node2057" class="node">
<title>kv_send3_3_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12480" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12480" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="12480" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_3_6&#45;&gt;kv_send3_3_6 -->
<g id="edge2854" class="edge">
<title>ring_stage3_3_6&#45;&gt;kv_send3_3_6</title>
<path fill="none" stroke="black" d="M12819.3,-4356.28C12816.17,-4355.6 12813.06,-4354.95 12810,-4354.32 12714.22,-4334.72 12688.91,-4337.24 12593,-4318.32 12583.69,-4316.49 12573.99,-4314.45 12564.34,-4312.35"/>
<polygon fill="black" stroke="black" points="12564.84,-4308.88 12554.32,-4310.14 12563.33,-4315.71 12564.84,-4308.88"/>
</g>
<!-- ring_stage3_4_6 -->
<g id="node2073" class="node">
<title>ring_stage3_4_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13433.5,-4317.95 13240.5,-4317.95 13240.5,-4264.95 13433.5,-4264.95 13433.5,-4317.95"/>
<text text-anchor="middle" x="13337" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="13337" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_2×V_2</text>
<text text-anchor="middle" x="13337" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_3_6&#45;&gt;ring_stage3_4_6 -->
<g id="edge2900" class="edge">
<title>ring_stage3_3_6&#45;&gt;ring_stage3_4_6</title>
<path fill="none" stroke="black" d="M13012.7,-4356.3C13015.83,-4355.62 13018.94,-4354.96 13022,-4354.32 13111.22,-4335.77 13137.02,-4337.37 13230.43,-4318.38"/>
<polygon fill="black" stroke="black" points="13231.21,-4321.79 13240.3,-4316.34 13229.8,-4314.93 13231.21,-4321.79"/>
</g>
<!-- kv_send3_3_7 -->
<g id="node2058" class="node">
<title>kv_send3_3_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12481" cy="-4201.71" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12481" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="12481" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_3_7&#45;&gt;kv_send3_3_7 -->
<g id="edge2857" class="edge">
<title>ring_stage3_3_7&#45;&gt;kv_send3_3_7</title>
<path fill="none" stroke="black" d="M12634.65,-4264.84C12606.33,-4253.39 12573.01,-4239.91 12544.65,-4228.45"/>
<polygon fill="black" stroke="black" points="12545.82,-4225.15 12535.24,-4224.64 12543.2,-4231.64 12545.82,-4225.15"/>
</g>
<!-- ring_stage3_4_7 -->
<g id="node2074" class="node">
<title>ring_stage3_4_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12359.5,-4228.21 12166.5,-4228.21 12166.5,-4175.21 12359.5,-4175.21 12359.5,-4228.21"/>
<text text-anchor="middle" x="12263" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12263" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_3×V_3</text>
<text text-anchor="middle" x="12263" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_3_7&#45;&gt;ring_stage3_4_7 -->
<g id="edge2903" class="edge">
<title>ring_stage3_3_7&#45;&gt;ring_stage3_4_7</title>
<path fill="none" stroke="black" d="M12601.31,-4266.52C12598.17,-4265.85 12595.06,-4265.2 12592,-4264.58 12496.68,-4245.29 12469.11,-4248.28 12369.56,-4228.62"/>
<polygon fill="black" stroke="black" points="12370.18,-4225.18 12359.69,-4226.65 12368.81,-4232.04 12370.18,-4225.18"/>
</g>
<!-- kv_send3_3_8 -->
<g id="node2059" class="node">
<title>kv_send3_3_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13829" cy="-4111.97" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13829" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="13829" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_3_8&#45;&gt;kv_send3_3_8 -->
<g id="edge2860" class="edge">
<title>ring_stage3_3_8&#45;&gt;kv_send3_3_8</title>
<path fill="none" stroke="black" d="M13257.63,-4176.45C13260.79,-4175.88 13263.91,-4175.34 13267,-4174.84 13465.09,-4142.95 13518.72,-4169.5 13717,-4138.84 13726.76,-4137.33 13736.94,-4135.44 13747,-4133.37"/>
<polygon fill="black" stroke="black" points="13747.95,-4136.74 13757,-4131.24 13746.5,-4129.9 13747.95,-4136.74"/>
</g>
<!-- ring_stage3_4_8 -->
<g id="node2075" class="node">
<title>ring_stage3_4_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12756.5,-4138.47 12563.5,-4138.47 12563.5,-4085.47 12756.5,-4085.47 12756.5,-4138.47"/>
<text text-anchor="middle" x="12660" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12660" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_4×V_4</text>
<text text-anchor="middle" x="12660" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_3_8&#45;&gt;ring_stage3_4_8 -->
<g id="edge2906" class="edge">
<title>ring_stage3_3_8&#45;&gt;ring_stage3_4_8</title>
<path fill="none" stroke="black" d="M13064.34,-4176.63C13061.19,-4176 13058.07,-4175.41 13055,-4174.84 12930.5,-4152 12894.53,-4161.88 12766.77,-4139.08"/>
<polygon fill="black" stroke="black" points="12767.06,-4135.57 12756.6,-4137.23 12765.81,-4142.46 12767.06,-4135.57"/>
</g>
<!-- kv_send3_3_9 -->
<g id="node2060" class="node">
<title>kv_send3_3_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14500" cy="-4022.23" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14500" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14500" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_3_9&#45;&gt;kv_send3_3_9 -->
<g id="edge2863" class="edge">
<title>ring_stage3_3_9&#45;&gt;kv_send3_3_9</title>
<path fill="none" stroke="black" d="M14335.02,-4085.36C14365.56,-4073.86 14401.52,-4060.32 14432.05,-4048.82"/>
<polygon fill="black" stroke="black" points="14433.64,-4051.96 14441.76,-4045.16 14431.17,-4045.41 14433.64,-4051.96"/>
</g>
<!-- ring_stage3_4_9 -->
<g id="node2076" class="node">
<title>ring_stage3_4_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14151.5,-4048.73 13958.5,-4048.73 13958.5,-3995.73 14151.5,-3995.73 14151.5,-4048.73"/>
<text text-anchor="middle" x="14055" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="14055" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_5×V_5</text>
<text text-anchor="middle" x="14055" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_3_9&#45;&gt;ring_stage3_4_9 -->
<g id="edge2909" class="edge">
<title>ring_stage3_3_9&#45;&gt;ring_stage3_4_9</title>
<path fill="none" stroke="black" d="M14205.11,-4085.36C14180.4,-4075.13 14151.8,-4063.29 14126.24,-4052.71"/>
<polygon fill="black" stroke="black" points="14127.54,-4049.47 14116.97,-4048.88 14124.87,-4055.94 14127.54,-4049.47"/>
</g>
<!-- kv_send3_3_10 -->
<g id="node2061" class="node">
<title>kv_send3_3_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14034" cy="-3932.49" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14034" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14034" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_3_10&#45;&gt;kv_send3_3_10 -->
<g id="edge2866" class="edge">
<title>ring_stage3_3_10&#45;&gt;kv_send3_3_10</title>
<path fill="none" stroke="black" d="M14201.81,-3995.62C14170.49,-3984.02 14133.56,-3970.35 14102.34,-3958.79"/>
<polygon fill="black" stroke="black" points="14103.44,-3955.47 14092.84,-3955.28 14101.01,-3962.03 14103.44,-3955.47"/>
</g>
<!-- ring_stage3_4_10 -->
<g id="node2077" class="node">
<title>ring_stage3_4_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14601,-3958.99 14399,-3958.99 14399,-3905.99 14601,-3905.99 14601,-3958.99"/>
<text text-anchor="middle" x="14500" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="14500" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_6×V_6</text>
<text text-anchor="middle" x="14500" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_3_10&#45;&gt;ring_stage3_4_10 -->
<g id="edge2912" class="edge">
<title>ring_stage3_3_10&#45;&gt;ring_stage3_4_10</title>
<path fill="none" stroke="black" d="M14337.85,-3995.62C14364.66,-3985.35 14395.71,-3973.45 14423.42,-3962.83"/>
<polygon fill="black" stroke="black" points="14424.98,-3965.98 14433.07,-3959.14 14422.47,-3959.45 14424.98,-3965.98"/>
</g>
<!-- kv_send3_3_11 -->
<g id="node2062" class="node">
<title>kv_send3_3_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13371" cy="-3842.75" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13371" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13371" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_3_11&#45;&gt;kv_send3_3_11 -->
<g id="edge2869" class="edge">
<title>ring_stage3_3_11&#45;&gt;kv_send3_3_11</title>
<path fill="none" stroke="black" d="M13528.9,-3905.88C13500.02,-3894.52 13466.1,-3881.17 13437.11,-3869.76"/>
<polygon fill="black" stroke="black" points="13438.06,-3866.38 13427.48,-3865.97 13435.5,-3872.89 13438.06,-3866.38"/>
</g>
<!-- ring_stage3_4_11 -->
<g id="node2078" class="node">
<title>ring_stage3_4_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13912,-3869.25 13710,-3869.25 13710,-3816.25 13912,-3816.25 13912,-3869.25"/>
<text text-anchor="middle" x="13811" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="13811" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_7×V_7</text>
<text text-anchor="middle" x="13811" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_3_11&#45;&gt;ring_stage3_4_11 -->
<g id="edge2915" class="edge">
<title>ring_stage3_3_11&#45;&gt;ring_stage3_4_11</title>
<path fill="none" stroke="black" d="M13657.35,-3905.88C13682.64,-3895.65 13711.92,-3883.81 13738.08,-3873.23"/>
<polygon fill="black" stroke="black" points="13739.61,-3876.39 13747.57,-3869.4 13736.99,-3869.9 13739.61,-3876.39"/>
</g>
<!-- kv_send3_3_12 -->
<g id="node2063" class="node">
<title>kv_send3_3_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12903" cy="-3753.01" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12903" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="12903" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_3_12&#45;&gt;kv_send3_3_12 -->
<g id="edge2872" class="edge">
<title>ring_stage3_3_12&#45;&gt;kv_send3_3_12</title>
<path fill="none" stroke="black" d="M13072.23,-3816.14C13040.64,-3804.54 13003.4,-3790.87 12971.92,-3779.31"/>
<polygon fill="black" stroke="black" points="12972.93,-3775.96 12962.34,-3775.8 12970.52,-3782.53 12972.93,-3775.96"/>
</g>
<!-- ring_stage3_4_12 -->
<g id="node2079" class="node">
<title>ring_stage3_4_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13235,-3779.51 13033,-3779.51 13033,-3726.51 13235,-3726.51 13235,-3779.51"/>
<text text-anchor="middle" x="13134" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="13134" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_8×V_8</text>
<text text-anchor="middle" x="13134" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_3_12&#45;&gt;ring_stage3_4_12 -->
<g id="edge2918" class="edge">
<title>ring_stage3_3_12&#45;&gt;ring_stage3_4_12</title>
<path fill="none" stroke="black" d="M13139.64,-3815.9C13138.89,-3807.69 13138.05,-3798.46 13137.25,-3789.68"/>
<polygon fill="black" stroke="black" points="13140.73,-3789.32 13136.34,-3779.68 13133.76,-3789.95 13140.73,-3789.32"/>
</g>
<!-- kv_send3_3_13 -->
<g id="node2064" class="node">
<title>kv_send3_3_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12653" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12653" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12653" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_3_13&#45;&gt;kv_send3_3_13 -->
<g id="edge2875" class="edge">
<title>ring_stage3_3_13&#45;&gt;kv_send3_3_13</title>
<path fill="none" stroke="black" d="M12660.76,-3726.16C12659.74,-3718.02 12658.59,-3708.88 12657.5,-3700.18"/>
<polygon fill="black" stroke="black" points="12660.97,-3699.73 12656.26,-3690.24 12654.03,-3700.6 12660.97,-3699.73"/>
</g>
<!-- ring_stage3_4_13 -->
<g id="node2080" class="node">
<title>ring_stage3_4_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12983,-3689.77 12781,-3689.77 12781,-3636.77 12983,-3636.77 12983,-3689.77"/>
<text text-anchor="middle" x="12882" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12882" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_9×V_9</text>
<text text-anchor="middle" x="12882" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_3_13&#45;&gt;ring_stage3_4_13 -->
<g id="edge2921" class="edge">
<title>ring_stage3_3_13&#45;&gt;ring_stage3_4_13</title>
<path fill="none" stroke="black" d="M12727.64,-3726.4C12753.05,-3716.17 12782.46,-3704.33 12808.75,-3693.75"/>
<polygon fill="black" stroke="black" points="12810.31,-3696.9 12818.28,-3689.92 12807.7,-3690.4 12810.31,-3696.9"/>
</g>
<!-- kv_send3_3_14 -->
<g id="node2065" class="node">
<title>kv_send3_3_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12387" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12387" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12387" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_3_14&#45;&gt;kv_send3_3_14 -->
<g id="edge2878" class="edge">
<title>ring_stage3_3_14&#45;&gt;kv_send3_3_14</title>
<path fill="none" stroke="black" d="M12406.75,-3636.42C12404.13,-3628.19 12401.17,-3618.94 12398.37,-3610.15"/>
<polygon fill="black" stroke="black" points="12401.66,-3608.96 12395.29,-3600.5 12394.99,-3611.09 12401.66,-3608.96"/>
</g>
<!-- ring_stage3_4_14 -->
<g id="node2081" class="node">
<title>ring_stage3_4_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12735,-3600.03 12515,-3600.03 12515,-3547.03 12735,-3547.03 12735,-3600.03"/>
<text text-anchor="middle" x="12625" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12625" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_10×V_10</text>
<text text-anchor="middle" x="12625" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_3_14&#45;&gt;ring_stage3_4_14 -->
<g id="edge2924" class="edge">
<title>ring_stage3_3_14&#45;&gt;ring_stage3_4_14</title>
<path fill="none" stroke="black" d="M12476.31,-3636.66C12500.67,-3626.48 12528.86,-3614.7 12554.1,-3604.15"/>
<polygon fill="black" stroke="black" points="12555.74,-3607.26 12563.62,-3600.18 12553.04,-3600.8 12555.74,-3607.26"/>
</g>
<!-- kv_send3_3_15 -->
<g id="node2066" class="node">
<title>kv_send3_3_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12142" cy="-3483.79" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12142" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12142" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_3_15&#45;&gt;kv_send3_3_15 -->
<g id="edge2881" class="edge">
<title>ring_stage3_3_15&#45;&gt;kv_send3_3_15</title>
<path fill="none" stroke="black" d="M12146.94,-3546.68C12146.3,-3538.63 12145.57,-3529.6 12144.89,-3520.98"/>
<polygon fill="black" stroke="black" points="12148.36,-3520.45 12144.07,-3510.76 12141.38,-3521.01 12148.36,-3520.45"/>
</g>
<!-- ring_stage3_4_15 -->
<g id="node2082" class="node">
<title>ring_stage3_4_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12483,-3510.29 12263,-3510.29 12263,-3457.29 12483,-3457.29 12483,-3510.29"/>
<text text-anchor="middle" x="12373" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
<text text-anchor="middle" x="12373" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_11×V_11</text>
<text text-anchor="middle" x="12373" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_3_15&#45;&gt;ring_stage3_4_15 -->
<g id="edge2927" class="edge">
<title>ring_stage3_3_15&#45;&gt;ring_stage3_4_15</title>
<path fill="none" stroke="black" d="M12214.39,-3546.92C12240.61,-3536.65 12270.98,-3524.75 12298.09,-3514.13"/>
<polygon fill="black" stroke="black" points="12299.49,-3517.34 12307.53,-3510.44 12296.94,-3510.83 12299.49,-3517.34"/>
</g>
<!-- kv_send3_3_0&#45;&gt;ring_stage3_4_1 -->
<g id="edge2886" class="edge">
<title>kv_send3_3_0&#45;&gt;ring_stage3_4_1</title>
<path fill="none" stroke="black" d="M13550.8,-4804.92C13567.1,-4794.85 13586.26,-4783.01 13603.62,-4772.28"/>
<polygon fill="black" stroke="black" points="13605.84,-4775.02 13612.51,-4766.79 13602.16,-4769.07 13605.84,-4775.02"/>
</g>
<!-- kv_send3_3_1&#45;&gt;ring_stage3_4_2 -->
<g id="edge2889" class="edge">
<title>kv_send3_3_1&#45;&gt;ring_stage3_4_2</title>
<path fill="none" stroke="black" d="M14283.8,-4718.25C14316.14,-4706.94 14356.59,-4692.81 14391.94,-4680.45"/>
<polygon fill="black" stroke="black" points="14393.48,-4683.62 14401.77,-4677.01 14391.17,-4677.01 14393.48,-4683.62"/>
</g>
<!-- kv_send3_3_2&#45;&gt;ring_stage3_4_3 -->
<g id="edge2892" class="edge">
<title>kv_send3_3_2&#45;&gt;ring_stage3_4_3</title>
<path fill="none" stroke="black" d="M15195.53,-4631.97C15249.45,-4619.52 15322.99,-4602.54 15384.28,-4588.39"/>
<polygon fill="black" stroke="black" points="15385.44,-4591.72 15394.4,-4586.06 15383.87,-4584.89 15385.44,-4591.72"/>
</g>
<!-- kv_send3_3_3&#45;&gt;ring_stage3_4_4 -->
<g id="edge2895" class="edge">
<title>kv_send3_3_3&#45;&gt;ring_stage3_4_4</title>
<path fill="none" stroke="black" d="M15049,-4533.35C15049,-4525.31 15049,-4516.33 15049,-4507.77"/>
<polygon fill="black" stroke="black" points="15052.5,-4507.63 15049,-4497.63 15045.5,-4507.63 15052.5,-4507.63"/>
</g>
<!-- kv_send3_3_4&#45;&gt;ring_stage3_4_5 -->
<g id="edge2898" class="edge">
<title>kv_send3_3_4&#45;&gt;ring_stage3_4_5</title>
<path fill="none" stroke="black" d="M14774.69,-4448.36C14745.64,-4437.23 14709.8,-4423.49 14678.3,-4411.43"/>
<polygon fill="black" stroke="black" points="14679.27,-4408.05 14668.68,-4407.74 14676.77,-4414.59 14679.27,-4408.05"/>
</g>
<!-- kv_send3_3_5&#45;&gt;ring_stage3_4_6 -->
<g id="edge2901" class="edge">
<title>kv_send3_3_5&#45;&gt;ring_stage3_4_6</title>
<path fill="none" stroke="black" d="M13342.6,-4353.87C13341.87,-4345.83 13341.05,-4336.85 13340.27,-4328.29"/>
<polygon fill="black" stroke="black" points="13343.74,-4327.8 13339.34,-4318.15 13336.77,-4328.43 13343.74,-4327.8"/>
</g>
<!-- kv_send3_3_6&#45;&gt;ring_stage3_4_7 -->
<g id="edge2904" class="edge">
<title>kv_send3_3_6&#45;&gt;ring_stage3_4_7</title>
<path fill="none" stroke="black" d="M12425.8,-4268.54C12398.5,-4257.5 12365.02,-4243.96 12335.54,-4232.04"/>
<polygon fill="black" stroke="black" points="12336.7,-4228.74 12326.12,-4228.23 12334.08,-4235.23 12336.7,-4228.74"/>
</g>
<!-- kv_send3_3_7&#45;&gt;ring_stage3_4_8 -->
<g id="edge2907" class="edge">
<title>kv_send3_3_7&#45;&gt;ring_stage3_4_8</title>
<path fill="none" stroke="black" d="M12528.03,-4177.66C12549.7,-4167.04 12575.7,-4154.29 12598.87,-4142.94"/>
<polygon fill="black" stroke="black" points="12600.49,-4146.04 12607.93,-4138.5 12597.41,-4139.75 12600.49,-4146.04"/>
</g>
<!-- kv_send3_3_8&#45;&gt;ring_stage3_4_9 -->
<g id="edge2910" class="edge">
<title>kv_send3_3_8&#45;&gt;ring_stage3_4_9</title>
<path fill="none" stroke="black" d="M13884.87,-4089.28C13913.41,-4078.2 13948.56,-4064.55 13979.49,-4052.55"/>
<polygon fill="black" stroke="black" points="13980.89,-4055.76 13988.94,-4048.88 13978.35,-4049.23 13980.89,-4055.76"/>
</g>
<!-- kv_send3_3_9&#45;&gt;ring_stage3_4_10 -->
<g id="edge2913" class="edge">
<title>kv_send3_3_9&#45;&gt;ring_stage3_4_10</title>
<path fill="none" stroke="black" d="M14500,-3994.91C14500,-3986.87 14500,-3977.89 14500,-3969.33"/>
<polygon fill="black" stroke="black" points="14503.5,-3969.19 14500,-3959.19 14496.5,-3969.19 14503.5,-3969.19"/>
</g>
<!-- kv_send3_3_10&#45;&gt;ring_stage3_4_11 -->
<g id="edge2916" class="edge">
<title>kv_send3_3_10&#45;&gt;ring_stage3_4_11</title>
<path fill="none" stroke="black" d="M13977.73,-3909.35C13949.79,-3898.36 13915.65,-3884.93 13885.56,-3873.09"/>
<polygon fill="black" stroke="black" points="13886.54,-3869.71 13875.95,-3869.31 13883.97,-3876.22 13886.54,-3869.71"/>
</g>
<!-- kv_send3_3_11&#45;&gt;ring_stage3_4_12 -->
<g id="edge2919" class="edge">
<title>kv_send3_3_11&#45;&gt;ring_stage3_4_12</title>
<path fill="none" stroke="black" d="M13312.11,-3819.95C13282.04,-3808.82 13245.05,-3795.12 13212.58,-3783.1"/>
<polygon fill="black" stroke="black" points="13213.7,-3779.78 13203.11,-3779.6 13211.27,-3786.35 13213.7,-3779.78"/>
</g>
<!-- kv_send3_3_12&#45;&gt;ring_stage3_4_13 -->
<g id="edge2922" class="edge">
<title>kv_send3_3_12&#45;&gt;ring_stage3_4_13</title>
<path fill="none" stroke="black" d="M12896.81,-3726.16C12894.85,-3717.95 12892.64,-3708.72 12890.54,-3699.94"/>
<polygon fill="black" stroke="black" points="12893.87,-3698.85 12888.14,-3689.94 12887.07,-3700.48 12893.87,-3698.85"/>
</g>
<!-- kv_send3_3_13&#45;&gt;ring_stage3_4_14 -->
<g id="edge2925" class="edge">
<title>kv_send3_3_13&#45;&gt;ring_stage3_4_14</title>
<path fill="none" stroke="black" d="M12644.75,-3636.42C12642.1,-3628.12 12639.12,-3618.78 12636.29,-3609.92"/>
<polygon fill="black" stroke="black" points="12639.57,-3608.66 12633.19,-3600.2 12632.9,-3610.79 12639.57,-3608.66"/>
</g>
<!-- kv_send3_3_14&#45;&gt;ring_stage3_4_15 -->
<g id="edge2928" class="edge">
<title>kv_send3_3_14&#45;&gt;ring_stage3_4_15</title>
<path fill="none" stroke="black" d="M12382.8,-3546.21C12381.52,-3538.17 12380.08,-3529.19 12378.72,-3520.63"/>
<polygon fill="black" stroke="black" points="12382.13,-3519.82 12377.1,-3510.49 12375.22,-3520.92 12382.13,-3519.82"/>
</g>
<!-- kv_send3_3_15&#45;&gt;ring_stage3_4_0 -->
<g id="edge2883" class="edge">
<title>kv_send3_3_15&#45;&gt;ring_stage3_4_0</title>
<path fill="none" stroke="black" d="M12136.99,-3456.94C12135.4,-3448.73 12133.61,-3439.5 12131.91,-3430.72"/>
<polygon fill="black" stroke="black" points="12135.31,-3429.87 12129.97,-3420.72 12128.44,-3431.2 12135.31,-3429.87"/>
</g>
<!-- kv_send3_4_0 -->
<g id="node2083" class="node">
<title>kv_send3_4_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12123" cy="-3304.31" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12123" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12123" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_4_0&#45;&gt;kv_send3_4_0 -->
<g id="edge2884" class="edge">
<title>ring_stage3_4_0&#45;&gt;kv_send3_4_0</title>
<path fill="none" stroke="black" d="M12124.41,-3367.2C12124.23,-3359.15 12124.02,-3350.12 12123.82,-3341.5"/>
<polygon fill="black" stroke="black" points="12127.32,-3341.2 12123.59,-3331.28 12120.32,-3341.36 12127.32,-3341.2"/>
</g>
<!-- ring_stage3_5_0 -->
<g id="node2099" class="node">
<title>ring_stage3_5_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12456.5,-3330.81 12245.5,-3330.81 12245.5,-3277.81 12456.5,-3277.81 12456.5,-3330.81"/>
<text text-anchor="middle" x="12351" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12351" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_11×V_11</text>
<text text-anchor="middle" x="12351" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_4_0&#45;&gt;ring_stage3_5_0 -->
<g id="edge2930" class="edge">
<title>ring_stage3_4_0&#45;&gt;ring_stage3_5_0</title>
<path fill="none" stroke="black" d="M12190.98,-3367.44C12217.43,-3357.17 12248.07,-3345.27 12275.42,-3334.65"/>
<polygon fill="black" stroke="black" points="12276.89,-3337.84 12284.94,-3330.96 12274.35,-3331.31 12276.89,-3337.84"/>
</g>
<!-- kv_send3_4_1 -->
<g id="node2084" class="node">
<title>kv_send3_4_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14013" cy="-4650.41" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14013" y="-4654.21" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="14013" y="-4639.21" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_4_1&#45;&gt;kv_send3_4_1 -->
<g id="edge2887" class="edge">
<title>ring_stage3_4_1&#45;&gt;kv_send3_4_1</title>
<path fill="none" stroke="black" d="M13758.8,-4713.54C13813.13,-4700.26 13878.57,-4684.27 13929.44,-4671.83"/>
<polygon fill="black" stroke="black" points="13930.53,-4675.17 13939.42,-4669.4 13928.87,-4668.37 13930.53,-4675.17"/>
</g>
<!-- ring_stage3_5_1 -->
<g id="node2100" class="node">
<title>ring_stage3_5_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12107.5,-3241.07 11896.5,-3241.07 11896.5,-3188.07 12107.5,-3188.07 12107.5,-3241.07"/>
<text text-anchor="middle" x="12002" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12002" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_12×V_12</text>
<text text-anchor="middle" x="12002" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_4_1&#45;&gt;ring_stage3_5_1 -->
<g id="edge2933" class="edge">
<title>ring_stage3_4_1&#45;&gt;ring_stage3_5_1</title>
<path fill="none" stroke="black" d="M13548.49,-4725.44C13391.5,-4703.1 13106.65,-4654.54 13030,-4587.54 13010.69,-4570.67 13028.88,-4550 13009,-4533.8 12935.24,-4473.72 12888.8,-4526.19 12798,-4497.8 12744.15,-4480.96 12735.04,-4465.84 12683,-4444.06 12640.58,-4426.31 12628.82,-4424.82 12586,-4408.06 12488.43,-4369.89 12456.75,-4374.02 12368,-4318.32 12337.68,-4299.29 12339.7,-4281.21 12308,-4264.58 12247.28,-4232.74 12210.52,-4272.65 12158,-4228.58 12071.99,-4156.4 12073.6,-4165.03 12007,-3690.14 11994.32,-3599.71 12000,-3576.11 12000,-3484.79 12000,-3484.79 12000,-3484.79 12000,-3393.05 12000,-3344.04 12000.77,-3287.42 12001.36,-3251.57"/>
<polygon fill="black" stroke="black" points="12004.86,-3251.2 12001.53,-3241.14 11997.86,-3251.08 12004.86,-3251.2"/>
</g>
<!-- kv_send3_4_2 -->
<g id="node2085" class="node">
<title>kv_send3_4_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15273" cy="-4560.67" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15273" y="-4564.47" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="15273" y="-4549.47" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_4_2&#45;&gt;kv_send3_4_2 -->
<g id="edge2890" class="edge">
<title>ring_stage3_4_2&#45;&gt;kv_send3_4_2</title>
<path fill="none" stroke="black" d="M14580.62,-4638.38C14627.04,-4633.64 14682.21,-4628.14 14732,-4623.54 14922.53,-4605.96 14971.97,-4617.15 15161,-4587.54 15170.69,-4586.03 15180.78,-4584.14 15190.76,-4582.08"/>
<polygon fill="black" stroke="black" points="15191.64,-4585.47 15200.7,-4579.97 15190.19,-4578.62 15191.64,-4585.47"/>
</g>
<!-- ring_stage3_5_2 -->
<g id="node2101" class="node">
<title>ring_stage3_5_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14583.5,-4587.17 14372.5,-4587.17 14372.5,-4534.17 14583.5,-4534.17 14583.5,-4587.17"/>
<text text-anchor="middle" x="14478" y="-4571.97" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="14478" y="-4556.97" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_13×V_13</text>
<text text-anchor="middle" x="14478" y="-4541.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_4_2&#45;&gt;ring_stage3_5_2 -->
<g id="edge2936" class="edge">
<title>ring_stage3_4_2&#45;&gt;ring_stage3_5_2</title>
<path fill="none" stroke="black" d="M14475.88,-4623.56C14476.16,-4615.35 14476.48,-4606.12 14476.78,-4597.34"/>
<polygon fill="black" stroke="black" points="14480.28,-4597.45 14477.12,-4587.34 14473.28,-4597.21 14480.28,-4597.45"/>
</g>
<!-- kv_send3_4_3 -->
<g id="node2086" class="node">
<title>kv_send3_4_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15500" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15500" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15500" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_4_3&#45;&gt;kv_send3_4_3 -->
<g id="edge2893" class="edge">
<title>ring_stage3_4_3&#45;&gt;kv_send3_4_3</title>
<path fill="none" stroke="black" d="M15500,-4533.82C15500,-4525.77 15500,-4516.74 15500,-4508.12"/>
<polygon fill="black" stroke="black" points="15503.5,-4507.9 15500,-4497.9 15496.5,-4507.9 15503.5,-4507.9"/>
</g>
<!-- ring_stage3_5_3 -->
<g id="node2102" class="node">
<title>ring_stage3_5_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15378.5,-4497.43 15167.5,-4497.43 15167.5,-4444.43 15378.5,-4444.43 15378.5,-4497.43"/>
<text text-anchor="middle" x="15273" y="-4482.23" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="15273" y="-4467.23" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_14×V_14</text>
<text text-anchor="middle" x="15273" y="-4452.23" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_4_3&#45;&gt;ring_stage3_5_3 -->
<g id="edge2939" class="edge">
<title>ring_stage3_4_3&#45;&gt;ring_stage3_5_3</title>
<path fill="none" stroke="black" d="M15433.73,-4534.06C15407.16,-4523.79 15376.38,-4511.89 15348.92,-4501.28"/>
<polygon fill="black" stroke="black" points="15349.94,-4497.92 15339.35,-4497.58 15347.42,-4504.45 15349.94,-4497.92"/>
</g>
<!-- kv_send3_4_4 -->
<g id="node2087" class="node">
<title>kv_send3_4_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14820" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14820" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14820" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_4_4&#45;&gt;kv_send3_4_4 -->
<g id="edge2896" class="edge">
<title>ring_stage3_4_4&#45;&gt;kv_send3_4_4</title>
<path fill="none" stroke="black" d="M14982.15,-4444.32C14951.89,-4432.73 14916.23,-4419.06 14886.07,-4407.51"/>
<polygon fill="black" stroke="black" points="14887.07,-4404.14 14876.48,-4403.83 14884.57,-4410.68 14887.07,-4404.14"/>
</g>
<!-- ring_stage3_5_4 -->
<g id="node2103" class="node">
<title>ring_stage3_5_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15605.5,-4407.69 15394.5,-4407.69 15394.5,-4354.69 15605.5,-4354.69 15605.5,-4407.69"/>
<text text-anchor="middle" x="15500" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="15500" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_15×V_15</text>
<text text-anchor="middle" x="15500" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_4_4&#45;&gt;ring_stage3_5_4 -->
<g id="edge2942" class="edge">
<title>ring_stage3_4_4&#45;&gt;ring_stage3_5_4</title>
<path fill="none" stroke="black" d="M15145.79,-4446.75C15150.25,-4445.82 15154.67,-4444.91 15159,-4444.06 15256.1,-4424.97 15283.97,-4427.21 15384.5,-4408.3"/>
<polygon fill="black" stroke="black" points="15385.3,-4411.71 15394.47,-4406.4 15383.99,-4404.83 15385.3,-4411.71"/>
</g>
<!-- kv_send3_4_5 -->
<g id="node2088" class="node">
<title>kv_send3_4_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14707" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14707" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14707" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_4_5&#45;&gt;kv_send3_4_5 -->
<g id="edge2899" class="edge">
<title>ring_stage3_4_5&#45;&gt;kv_send3_4_5</title>
<path fill="none" stroke="black" d="M14632.65,-4354.58C14644.17,-4344.95 14657.4,-4333.9 14669.48,-4323.81"/>
<polygon fill="black" stroke="black" points="14671.78,-4326.44 14677.21,-4317.34 14667.3,-4321.07 14671.78,-4326.44"/>
</g>
<!-- ring_stage3_5_5 -->
<g id="node2104" class="node">
<title>ring_stage3_5_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15057.5,-4317.95 14864.5,-4317.95 14864.5,-4264.95 15057.5,-4264.95 15057.5,-4317.95"/>
<text text-anchor="middle" x="14961" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="14961" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_0×V_0</text>
<text text-anchor="middle" x="14961" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_4_5&#45;&gt;ring_stage3_5_5 -->
<g id="edge2945" class="edge">
<title>ring_stage3_4_5&#45;&gt;ring_stage3_5_5</title>
<path fill="none" stroke="black" d="M14698.68,-4356.56C14746.87,-4344.79 14805.25,-4330.52 14854.7,-4318.43"/>
<polygon fill="black" stroke="black" points="14855.58,-4321.82 14864.46,-4316.05 14853.92,-4315.02 14855.58,-4321.82"/>
</g>
<!-- kv_send3_4_6 -->
<g id="node2089" class="node">
<title>kv_send3_4_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12705" cy="-4201.71" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12705" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="12705" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_4_6&#45;&gt;kv_send3_4_6 -->
<g id="edge2902" class="edge">
<title>ring_stage3_4_6&#45;&gt;kv_send3_4_6</title>
<path fill="none" stroke="black" d="M13240.36,-4266.22C13237.21,-4265.64 13234.08,-4265.09 13231,-4264.58 13048.76,-4234.6 12999.43,-4257.44 12817,-4228.58 12807.32,-4227.05 12797.23,-4225.15 12787.24,-4223.09"/>
<polygon fill="black" stroke="black" points="12787.82,-4219.63 12777.31,-4220.98 12786.36,-4226.48 12787.82,-4219.63"/>
</g>
<!-- ring_stage3_5_6 -->
<g id="node2105" class="node">
<title>ring_stage3_5_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14824.5,-4228.21 14631.5,-4228.21 14631.5,-4175.21 14824.5,-4175.21 14824.5,-4228.21"/>
<text text-anchor="middle" x="14728" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="14728" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_1×V_1</text>
<text text-anchor="middle" x="14728" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_4_6&#45;&gt;ring_stage3_5_6 -->
<g id="edge2948" class="edge">
<title>ring_stage3_4_6&#45;&gt;ring_stage3_5_6</title>
<path fill="none" stroke="black" d="M13433.54,-4265.85C13436.39,-4265.39 13439.21,-4264.96 13442,-4264.58 13958.98,-4193.82 14100.92,-4298.45 14621.44,-4228.67"/>
<polygon fill="black" stroke="black" points="14622.02,-4232.12 14631.46,-4227.31 14621.08,-4225.19 14622.02,-4232.12"/>
</g>
<!-- kv_send3_4_7 -->
<g id="node2090" class="node">
<title>kv_send3_4_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12231" cy="-4111.97" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12231" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="12231" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_4_7&#45;&gt;kv_send3_4_7 -->
<g id="edge2905" class="edge">
<title>ring_stage3_4_7&#45;&gt;kv_send3_4_7</title>
<path fill="none" stroke="black" d="M12253.57,-4174.86C12250.57,-4166.63 12247.2,-4157.38 12243.99,-4148.59"/>
<polygon fill="black" stroke="black" points="12247.19,-4147.14 12240.47,-4138.94 12240.61,-4149.53 12247.19,-4147.14"/>
</g>
<!-- ring_stage3_5_7 -->
<g id="node2106" class="node">
<title>ring_stage3_5_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12545.5,-4138.47 12352.5,-4138.47 12352.5,-4085.47 12545.5,-4085.47 12545.5,-4138.47"/>
<text text-anchor="middle" x="12449" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12449" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_2×V_2</text>
<text text-anchor="middle" x="12449" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_4_7&#45;&gt;ring_stage3_5_7 -->
<g id="edge2951" class="edge">
<title>ring_stage3_4_7&#45;&gt;ring_stage3_5_7</title>
<path fill="none" stroke="black" d="M12317.3,-4175.1C12338.6,-4165.05 12363.19,-4153.45 12385.32,-4143.01"/>
<polygon fill="black" stroke="black" points="12387.08,-4146.05 12394.63,-4138.62 12384.1,-4139.72 12387.08,-4146.05"/>
</g>
<!-- kv_send3_4_8 -->
<g id="node2091" class="node">
<title>kv_send3_4_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13362" cy="-4022.23" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13362" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="13362" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_4_8&#45;&gt;kv_send3_4_8 -->
<g id="edge2908" class="edge">
<title>ring_stage3_4_8&#45;&gt;kv_send3_4_8</title>
<path fill="none" stroke="black" d="M12756.57,-4086.53C12759.4,-4086.02 12762.22,-4085.54 12765,-4085.1 12978.46,-4051.13 13036.3,-4081.52 13250,-4049.1 13259.77,-4047.62 13269.94,-4045.74 13280.01,-4043.68"/>
<polygon fill="black" stroke="black" points="13280.95,-4047.06 13290.01,-4041.57 13279.51,-4040.21 13280.95,-4047.06"/>
</g>
<!-- ring_stage3_5_8 -->
<g id="node2107" class="node">
<title>ring_stage3_5_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12782.5,-4048.73 12589.5,-4048.73 12589.5,-3995.73 12782.5,-3995.73 12782.5,-4048.73"/>
<text text-anchor="middle" x="12686" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12686" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_3×V_3</text>
<text text-anchor="middle" x="12686" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_4_8&#45;&gt;ring_stage3_5_8 -->
<g id="edge2954" class="edge">
<title>ring_stage3_4_8&#45;&gt;ring_stage3_5_8</title>
<path fill="none" stroke="black" d="M12667.66,-4085.12C12670.12,-4076.82 12672.89,-4067.48 12675.51,-4058.62"/>
<polygon fill="black" stroke="black" points="12678.91,-4059.48 12678.39,-4048.9 12672.2,-4057.49 12678.91,-4059.48"/>
</g>
<!-- kv_send3_4_9 -->
<g id="node2092" class="node">
<title>kv_send3_4_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14271" cy="-3932.49" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14271" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14271" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_4_9&#45;&gt;kv_send3_4_9 -->
<g id="edge2911" class="edge">
<title>ring_stage3_4_9&#45;&gt;kv_send3_4_9</title>
<path fill="none" stroke="black" d="M14118.06,-3995.62C14145.91,-3984.3 14178.63,-3971.01 14206.63,-3959.64"/>
<polygon fill="black" stroke="black" points="14207.99,-3962.86 14215.94,-3955.86 14205.35,-3956.38 14207.99,-3962.86"/>
</g>
<!-- ring_stage3_5_9 -->
<g id="node2108" class="node">
<title>ring_stage3_5_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13906.5,-3958.99 13713.5,-3958.99 13713.5,-3905.99 13906.5,-3905.99 13906.5,-3958.99"/>
<text text-anchor="middle" x="13810" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="13810" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_4×V_4</text>
<text text-anchor="middle" x="13810" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_4_9&#45;&gt;ring_stage3_5_9 -->
<g id="edge2957" class="edge">
<title>ring_stage3_4_9&#45;&gt;ring_stage3_5_9</title>
<path fill="none" stroke="black" d="M13983.48,-3995.62C13954.55,-3985.26 13921,-3973.24 13891.16,-3962.56"/>
<polygon fill="black" stroke="black" points="13892.21,-3959.21 13881.61,-3959.14 13889.85,-3965.8 13892.21,-3959.21"/>
</g>
<!-- kv_send3_4_10 -->
<g id="node2093" class="node">
<title>kv_send3_4_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14040" cy="-3842.75" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14040" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14040" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_4_10&#45;&gt;kv_send3_4_10 -->
<g id="edge2914" class="edge">
<title>ring_stage3_4_10&#45;&gt;kv_send3_4_10</title>
<path fill="none" stroke="black" d="M14398.77,-3907.37C14395.82,-3906.77 14392.89,-3906.18 14390,-3905.62 14287.58,-3885.66 14260.57,-3888.8 14158,-3869.62 14148.34,-3867.81 14138.26,-3865.8 14128.23,-3863.72"/>
<polygon fill="black" stroke="black" points="14128.76,-3860.25 14118.25,-3861.62 14127.32,-3867.1 14128.76,-3860.25"/>
</g>
<!-- ring_stage3_5_10 -->
<g id="node2109" class="node">
<title>ring_stage3_5_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14607,-3869.25 14405,-3869.25 14405,-3816.25 14607,-3816.25 14607,-3869.25"/>
<text text-anchor="middle" x="14506" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="14506" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_5×V_5</text>
<text text-anchor="middle" x="14506" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_4_10&#45;&gt;ring_stage3_5_10 -->
<g id="edge2960" class="edge">
<title>ring_stage3_4_10&#45;&gt;ring_stage3_5_10</title>
<path fill="none" stroke="black" d="M14501.77,-3905.64C14502.33,-3897.43 14502.96,-3888.2 14503.56,-3879.42"/>
<polygon fill="black" stroke="black" points="14507.05,-3879.63 14504.24,-3869.42 14500.07,-3879.15 14507.05,-3879.63"/>
</g>
<!-- kv_send3_4_11 -->
<g id="node2094" class="node">
<title>kv_send3_4_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13811" cy="-3753.01" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13811" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13811" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_4_11&#45;&gt;kv_send3_4_11 -->
<g id="edge2917" class="edge">
<title>ring_stage3_4_11&#45;&gt;kv_send3_4_11</title>
<path fill="none" stroke="black" d="M13811,-3815.9C13811,-3807.85 13811,-3798.82 13811,-3790.2"/>
<polygon fill="black" stroke="black" points="13814.5,-3789.98 13811,-3779.98 13807.5,-3789.98 13814.5,-3789.98"/>
</g>
<!-- ring_stage3_5_11 -->
<g id="node2110" class="node">
<title>ring_stage3_5_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14141,-3779.51 13939,-3779.51 13939,-3726.51 14141,-3726.51 14141,-3779.51"/>
<text text-anchor="middle" x="14040" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="14040" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_6×V_6</text>
<text text-anchor="middle" x="14040" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_4_11&#45;&gt;ring_stage3_5_11 -->
<g id="edge2963" class="edge">
<title>ring_stage3_4_11&#45;&gt;ring_stage3_5_11</title>
<path fill="none" stroke="black" d="M13877.85,-3816.14C13904.66,-3805.87 13935.71,-3793.97 13963.42,-3783.35"/>
<polygon fill="black" stroke="black" points="13964.98,-3786.5 13973.07,-3779.66 13962.47,-3779.97 13964.98,-3786.5"/>
</g>
<!-- kv_send3_4_12 -->
<g id="node2095" class="node">
<title>kv_send3_4_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13111" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13111" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="13111" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_4_12&#45;&gt;kv_send3_4_12 -->
<g id="edge2920" class="edge">
<title>ring_stage3_4_12&#45;&gt;kv_send3_4_12</title>
<path fill="none" stroke="black" d="M13127.22,-3726.16C13125.09,-3718.02 13122.69,-3708.88 13120.41,-3700.18"/>
<polygon fill="black" stroke="black" points="13123.73,-3699.03 13117.81,-3690.24 13116.96,-3700.8 13123.73,-3699.03"/>
</g>
<!-- ring_stage3_5_12 -->
<g id="node2111" class="node">
<title>ring_stage3_5_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13441,-3689.77 13239,-3689.77 13239,-3636.77 13441,-3636.77 13441,-3689.77"/>
<text text-anchor="middle" x="13340" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="13340" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_7×V_7</text>
<text text-anchor="middle" x="13340" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_4_12&#45;&gt;ring_stage3_5_12 -->
<g id="edge2966" class="edge">
<title>ring_stage3_4_12&#45;&gt;ring_stage3_5_12</title>
<path fill="none" stroke="black" d="M13194.14,-3726.4C13218.04,-3716.22 13245.69,-3704.44 13270.45,-3693.89"/>
<polygon fill="black" stroke="black" points="13271.96,-3697.06 13279.79,-3689.92 13269.22,-3690.62 13271.96,-3697.06"/>
</g>
<!-- kv_send3_4_13 -->
<g id="node2096" class="node">
<title>kv_send3_4_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12863" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12863" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12863" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_4_13&#45;&gt;kv_send3_4_13 -->
<g id="edge2923" class="edge">
<title>ring_stage3_4_13&#45;&gt;kv_send3_4_13</title>
<path fill="none" stroke="black" d="M12876.4,-3636.42C12874.64,-3628.28 12872.66,-3619.14 12870.78,-3610.44"/>
<polygon fill="black" stroke="black" points="12874.16,-3609.53 12868.62,-3600.5 12867.32,-3611.01 12874.16,-3609.53"/>
</g>
<!-- ring_stage3_5_13 -->
<g id="node2112" class="node">
<title>ring_stage3_5_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13193,-3600.03 12991,-3600.03 12991,-3547.03 13193,-3547.03 13193,-3600.03"/>
<text text-anchor="middle" x="13092" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="13092" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_8×V_8</text>
<text text-anchor="middle" x="13092" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_4_13&#45;&gt;ring_stage3_5_13 -->
<g id="edge2969" class="edge">
<title>ring_stage3_4_13&#45;&gt;ring_stage3_5_13</title>
<path fill="none" stroke="black" d="M12943.31,-3636.66C12967.67,-3626.48 12995.86,-3614.7 13021.1,-3604.15"/>
<polygon fill="black" stroke="black" points="13022.74,-3607.26 13030.62,-3600.18 13020.04,-3600.8 13022.74,-3607.26"/>
</g>
<!-- kv_send3_4_14 -->
<g id="node2097" class="node">
<title>kv_send3_4_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12611" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12611" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12611" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_4_14&#45;&gt;kv_send3_4_14 -->
<g id="edge2926" class="edge">
<title>ring_stage3_4_14&#45;&gt;kv_send3_4_14</title>
<path fill="none" stroke="black" d="M12620.88,-3546.68C12619.58,-3538.54 12618.12,-3529.4 12616.73,-3520.7"/>
<polygon fill="black" stroke="black" points="12620.18,-3520.08 12615.14,-3510.76 12613.26,-3521.19 12620.18,-3520.08"/>
</g>
<!-- ring_stage3_5_14 -->
<g id="node2113" class="node">
<title>ring_stage3_5_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12941,-3510.29 12739,-3510.29 12739,-3457.29 12941,-3457.29 12941,-3510.29"/>
<text text-anchor="middle" x="12840" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12840" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_9×V_9</text>
<text text-anchor="middle" x="12840" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_4_14&#45;&gt;ring_stage3_5_14 -->
<g id="edge2972" class="edge">
<title>ring_stage3_4_14&#45;&gt;ring_stage3_5_14</title>
<path fill="none" stroke="black" d="M12687.76,-3546.92C12712.82,-3536.69 12741.83,-3524.85 12767.76,-3514.27"/>
<polygon fill="black" stroke="black" points="12769.22,-3517.46 12777.16,-3510.44 12766.58,-3510.97 12769.22,-3517.46"/>
</g>
<!-- kv_send3_4_15 -->
<g id="node2098" class="node">
<title>kv_send3_4_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12352" cy="-3394.05" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12352" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12352" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_4_15&#45;&gt;kv_send3_4_15 -->
<g id="edge2929" class="edge">
<title>ring_stage3_4_15&#45;&gt;kv_send3_4_15</title>
<path fill="none" stroke="black" d="M12366.81,-3456.94C12364.87,-3448.8 12362.68,-3439.66 12360.59,-3430.96"/>
<polygon fill="black" stroke="black" points="12363.95,-3429.93 12358.22,-3421.02 12357.14,-3431.56 12363.95,-3429.93"/>
</g>
<!-- ring_stage3_5_15 -->
<g id="node2114" class="node">
<title>ring_stage3_5_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12693,-3420.55 12473,-3420.55 12473,-3367.55 12693,-3367.55 12693,-3420.55"/>
<text text-anchor="middle" x="12583" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
<text text-anchor="middle" x="12583" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_10×V_10</text>
<text text-anchor="middle" x="12583" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_4_15&#45;&gt;ring_stage3_5_15 -->
<g id="edge2975" class="edge">
<title>ring_stage3_4_15&#45;&gt;ring_stage3_5_15</title>
<path fill="none" stroke="black" d="M12434.31,-3457.18C12458.67,-3447 12486.86,-3435.22 12512.1,-3424.67"/>
<polygon fill="black" stroke="black" points="12513.74,-3427.78 12521.62,-3420.7 12511.04,-3421.32 12513.74,-3427.78"/>
</g>
<!-- kv_send3_4_0&#45;&gt;ring_stage3_5_1 -->
<g id="edge2934" class="edge">
<title>kv_send3_4_0&#45;&gt;ring_stage3_5_1</title>
<path fill="none" stroke="black" d="M12089.29,-3278.87C12075.73,-3269.04 12059.92,-3257.57 12045.51,-3247.12"/>
<polygon fill="black" stroke="black" points="12047.36,-3244.14 12037.21,-3241.1 12043.25,-3249.81 12047.36,-3244.14"/>
</g>
<!-- kv_send3_4_1&#45;&gt;ring_stage3_5_2 -->
<g id="edge2937" class="edge">
<title>kv_send3_4_1&#45;&gt;ring_stage3_5_2</title>
<path fill="none" stroke="black" d="M14090.03,-4632.41C14104.61,-4629.35 14119.76,-4626.26 14134,-4623.54 14228.74,-4605.46 14253.14,-4604.96 14348,-4587.54 14352.7,-4586.68 14357.5,-4585.79 14362.34,-4584.87"/>
<polygon fill="black" stroke="black" points="14363.17,-4588.28 14372.34,-4582.97 14361.86,-4581.4 14363.17,-4588.28"/>
</g>
<!-- kv_send3_4_2&#45;&gt;ring_stage3_5_3 -->
<g id="edge2940" class="edge">
<title>kv_send3_4_2&#45;&gt;ring_stage3_5_3</title>
<path fill="none" stroke="black" d="M15273,-4533.35C15273,-4525.31 15273,-4516.33 15273,-4507.77"/>
<polygon fill="black" stroke="black" points="15276.5,-4507.63 15273,-4497.63 15269.5,-4507.63 15276.5,-4507.63"/>
</g>
<!-- kv_send3_4_3&#45;&gt;ring_stage3_5_4 -->
<g id="edge2943" class="edge">
<title>kv_send3_4_3&#45;&gt;ring_stage3_5_4</title>
<path fill="none" stroke="black" d="M15500,-4443.61C15500,-4435.57 15500,-4426.59 15500,-4418.03"/>
<polygon fill="black" stroke="black" points="15503.5,-4417.89 15500,-4407.89 15496.5,-4417.89 15503.5,-4417.89"/>
</g>
<!-- kv_send3_4_4&#45;&gt;ring_stage3_5_5 -->
<g id="edge2946" class="edge">
<title>kv_send3_4_4&#45;&gt;ring_stage3_5_5</title>
<path fill="none" stroke="black" d="M14858.53,-4356.22C14874.64,-4346.19 14893.57,-4334.41 14910.75,-4323.72"/>
<polygon fill="black" stroke="black" points="14912.91,-4326.5 14919.55,-4318.24 14909.21,-4320.55 14912.91,-4326.5"/>
</g>
<!-- kv_send3_4_5&#45;&gt;ring_stage3_5_6 -->
<g id="edge2949" class="edge">
<title>kv_send3_4_5&#45;&gt;ring_stage3_5_6</title>
<path fill="none" stroke="black" d="M14713.19,-4264.6C14715.15,-4256.39 14717.36,-4247.16 14719.46,-4238.38"/>
<polygon fill="black" stroke="black" points="14722.93,-4238.92 14721.86,-4228.38 14716.13,-4237.29 14722.93,-4238.92"/>
</g>
<!-- kv_send3_4_6&#45;&gt;ring_stage3_5_7 -->
<g id="edge2952" class="edge">
<title>kv_send3_4_6&#45;&gt;ring_stage3_5_7</title>
<path fill="none" stroke="black" d="M12644.33,-4179.92C12611.08,-4168.52 12569.35,-4154.22 12533.01,-4141.76"/>
<polygon fill="black" stroke="black" points="12534,-4138.4 12523.4,-4138.47 12531.73,-4145.03 12534,-4138.4"/>
</g>
<!-- kv_send3_4_7&#45;&gt;ring_stage3_5_8 -->
<g id="edge2955" class="edge">
<title>kv_send3_4_7&#45;&gt;ring_stage3_5_8</title>
<path fill="none" stroke="black" d="M12304.99,-4093.2C12317.96,-4090.33 12331.35,-4087.51 12344,-4085.1 12445.5,-4065.8 12474.75,-4069.61 12579.36,-4049.35"/>
<polygon fill="black" stroke="black" points="12580.25,-4052.75 12589.38,-4047.39 12578.9,-4045.88 12580.25,-4052.75"/>
</g>
<!-- kv_send3_4_8&#45;&gt;ring_stage3_5_9 -->
<g id="edge2958" class="edge">
<title>kv_send3_4_8&#45;&gt;ring_stage3_5_9</title>
<path fill="none" stroke="black" d="M13435.94,-4003.36C13448.61,-4000.53 13461.66,-3997.75 13474,-3995.36 13572.51,-3976.3 13600.84,-3979.43 13703.48,-3959.39"/>
<polygon fill="black" stroke="black" points="13704.18,-3962.82 13713.31,-3957.44 13702.82,-3955.95 13704.18,-3962.82"/>
</g>
<!-- kv_send3_4_9&#45;&gt;ring_stage3_5_10 -->
<g id="edge2961" class="edge">
<title>kv_send3_4_9&#45;&gt;ring_stage3_5_10</title>
<path fill="none" stroke="black" d="M14329.39,-3909.69C14359.21,-3898.56 14395.89,-3884.86 14428.09,-3872.84"/>
<polygon fill="black" stroke="black" points="14429.33,-3876.11 14437.48,-3869.34 14426.88,-3869.55 14429.33,-3876.11"/>
</g>
<!-- kv_send3_4_10&#45;&gt;ring_stage3_5_11 -->
<g id="edge2964" class="edge">
<title>kv_send3_4_10&#45;&gt;ring_stage3_5_11</title>
<path fill="none" stroke="black" d="M14040,-3815.43C14040,-3807.39 14040,-3798.41 14040,-3789.85"/>
<polygon fill="black" stroke="black" points="14043.5,-3789.71 14040,-3779.71 14036.5,-3789.71 14043.5,-3789.71"/>
</g>
<!-- kv_send3_4_11&#45;&gt;ring_stage3_5_12 -->
<g id="edge2967" class="edge">
<title>kv_send3_4_11&#45;&gt;ring_stage3_5_12</title>
<path fill="none" stroke="black" d="M13732.76,-3734.07C13719.52,-3731.26 13705.89,-3728.51 13693,-3726.14 13588.76,-3707.02 13558.96,-3710.43 13451.2,-3690.3"/>
<polygon fill="black" stroke="black" points="13451.7,-3686.84 13441.23,-3688.42 13450.4,-3693.71 13451.7,-3686.84"/>
</g>
<!-- kv_send3_4_12&#45;&gt;ring_stage3_5_13 -->
<g id="edge2970" class="edge">
<title>kv_send3_4_12&#45;&gt;ring_stage3_5_13</title>
<path fill="none" stroke="black" d="M13105.4,-3636.42C13103.62,-3628.21 13101.63,-3618.98 13099.72,-3610.2"/>
<polygon fill="black" stroke="black" points="13103.1,-3609.23 13097.56,-3600.2 13096.25,-3610.71 13103.1,-3609.23"/>
</g>
<!-- kv_send3_4_13&#45;&gt;ring_stage3_5_14 -->
<g id="edge2973" class="edge">
<title>kv_send3_4_13&#45;&gt;ring_stage3_5_14</title>
<path fill="none" stroke="black" d="M12856.22,-3546.68C12854.05,-3538.38 12851.6,-3529.04 12849.28,-3520.18"/>
<polygon fill="black" stroke="black" points="12852.65,-3519.24 12846.73,-3510.46 12845.88,-3521.02 12852.65,-3519.24"/>
</g>
<!-- kv_send3_4_14&#45;&gt;ring_stage3_5_15 -->
<g id="edge2976" class="edge">
<title>kv_send3_4_14&#45;&gt;ring_stage3_5_15</title>
<path fill="none" stroke="black" d="M12602.75,-3456.94C12600.1,-3448.64 12597.12,-3439.3 12594.29,-3430.44"/>
<polygon fill="black" stroke="black" points="12597.57,-3429.18 12591.19,-3420.72 12590.9,-3431.31 12597.57,-3429.18"/>
</g>
<!-- kv_send3_4_15&#45;&gt;ring_stage3_5_0 -->
<g id="edge2931" class="edge">
<title>kv_send3_4_15&#45;&gt;ring_stage3_5_0</title>
<path fill="none" stroke="black" d="M12351.7,-3366.73C12351.61,-3358.69 12351.51,-3349.71 12351.41,-3341.15"/>
<polygon fill="black" stroke="black" points="12354.91,-3340.97 12351.29,-3331.01 12347.91,-3341.05 12354.91,-3340.97"/>
</g>
<!-- kv_send3_5_0 -->
<g id="node2115" class="node">
<title>kv_send3_5_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12286" cy="-3214.57" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12286" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12286" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_5_0&#45;&gt;kv_send3_5_0 -->
<g id="edge2932" class="edge">
<title>ring_stage3_5_0&#45;&gt;kv_send3_5_0</title>
<path fill="none" stroke="black" d="M12331.85,-3277.46C12325.37,-3268.71 12318.03,-3258.81 12311.16,-3249.53"/>
<polygon fill="black" stroke="black" points="12313.78,-3247.19 12305.01,-3241.24 12308.15,-3251.35 12313.78,-3247.19"/>
</g>
<!-- ring_stage3_6_0 -->
<g id="node2131" class="node">
<title>ring_stage3_6_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12646.5,-3241.07 12435.5,-3241.07 12435.5,-3188.07 12646.5,-3188.07 12646.5,-3241.07"/>
<text text-anchor="middle" x="12541" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="12541" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_10×V_10</text>
<text text-anchor="middle" x="12541" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_5_0&#45;&gt;ring_stage3_6_0 -->
<g id="edge2978" class="edge">
<title>ring_stage3_5_0&#45;&gt;ring_stage3_6_0</title>
<path fill="none" stroke="black" d="M12406.47,-3277.7C12428.32,-3267.61 12453.57,-3255.94 12476.25,-3245.47"/>
<polygon fill="black" stroke="black" points="12477.85,-3248.59 12485.46,-3241.22 12474.92,-3242.23 12477.85,-3248.59"/>
</g>
<!-- kv_send3_5_1 -->
<g id="node2116" class="node">
<title>kv_send3_5_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12229" cy="-3124.83" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12229" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12229" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_5_1&#45;&gt;kv_send3_5_1 -->
<g id="edge2935" class="edge">
<title>ring_stage3_5_1&#45;&gt;kv_send3_5_1</title>
<path fill="none" stroke="black" d="M12068.27,-3187.96C12098.26,-3176.36 12133.61,-3162.7 12163.51,-3151.14"/>
<polygon fill="black" stroke="black" points="12164.95,-3154.34 12173.01,-3147.47 12162.42,-3147.81 12164.95,-3154.34"/>
</g>
<!-- ring_stage3_6_1 -->
<g id="node2132" class="node">
<title>ring_stage3_6_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12107.5,-3151.33 11896.5,-3151.33 11896.5,-3098.33 12107.5,-3098.33 12107.5,-3151.33"/>
<text text-anchor="middle" x="12002" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="12002" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_11×V_11</text>
<text text-anchor="middle" x="12002" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_5_1&#45;&gt;ring_stage3_6_1 -->
<g id="edge2981" class="edge">
<title>ring_stage3_5_1&#45;&gt;ring_stage3_6_1</title>
<path fill="none" stroke="black" d="M12002,-3187.72C12002,-3179.51 12002,-3170.28 12002,-3161.5"/>
<polygon fill="black" stroke="black" points="12005.5,-3161.5 12002,-3151.5 11998.5,-3161.5 12005.5,-3161.5"/>
</g>
<!-- kv_send3_5_2 -->
<g id="node2117" class="node">
<title>kv_send3_5_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14607" cy="-4470.93" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14607" y="-4474.73" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="14607" y="-4459.73" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_5_2&#45;&gt;kv_send3_5_2 -->
<g id="edge2938" class="edge">
<title>ring_stage3_5_2&#45;&gt;kv_send3_5_2</title>
<path fill="none" stroke="black" d="M14515.66,-4534.06C14530.47,-4523.99 14547.57,-4512.35 14562.95,-4501.89"/>
<polygon fill="black" stroke="black" points="14564.99,-4504.74 14571.29,-4496.22 14561.05,-4498.95 14564.99,-4504.74"/>
</g>
<!-- ring_stage3_6_2 -->
<g id="node2133" class="node">
<title>ring_stage3_6_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13221.5,-3061.59 13010.5,-3061.59 13010.5,-3008.59 13221.5,-3008.59 13221.5,-3061.59"/>
<text text-anchor="middle" x="13116" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="13116" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_12×V_12</text>
<text text-anchor="middle" x="13116" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_5_2&#45;&gt;ring_stage3_6_2 -->
<g id="edge2984" class="edge">
<title>ring_stage3_5_2&#45;&gt;ring_stage3_6_2</title>
<path fill="none" stroke="black" d="M14471.33,-4534.07C14461.71,-4490.59 14449.86,-4402.37 14497,-4354.32 14597.85,-4251.53 14714.45,-4417.35 14819,-4318.32 14834.32,-4303.82 14844,-4117.52 14844,-4112.97 14844,-4112.97 14844,-4112.97 14844,-4021.23 14844,-3988.42 14853.88,-3750.59 14832,-3726.14 14761.24,-3647.08 14678.31,-3757.1 14596,-3690.14 14576.23,-3674.06 14596.63,-3651.36 14576,-3636.4 14495.34,-3577.92 13756.9,-3663.76 13680,-3600.4 13654.71,-3579.57 13670.03,-3479.19 13646,-3456.92 13570.75,-3387.19 13494.24,-3489.57 13418,-3420.92 13398.16,-3403.05 13378.05,-3207.38 13360,-3187.7 13325.51,-3150.1 13288.31,-3186.5 13251,-3151.7 13232.13,-3134.1 13246.2,-3117.21 13229,-3097.96 13217.95,-3085.6 13203.83,-3075.21 13189.34,-3066.69"/>
<polygon fill="black" stroke="black" points="13190.73,-3063.45 13180.3,-3061.62 13187.31,-3069.56 13190.73,-3063.45"/>
</g>
<!-- kv_send3_5_3 -->
<g id="node2118" class="node">
<title>kv_send3_5_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15727" cy="-4381.19" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15727" y="-4384.99" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15727" y="-4369.99" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_5_3&#45;&gt;kv_send3_5_3 -->
<g id="edge2941" class="edge">
<title>ring_stage3_5_3&#45;&gt;kv_send3_5_3</title>
<path fill="none" stroke="black" d="M15378.54,-4445.92C15381.73,-4445.28 15384.88,-4444.66 15388,-4444.06 15488.33,-4424.84 15514.73,-4427.57 15615,-4408.06 15624.16,-4406.28 15633.71,-4404.29 15643.2,-4402.22"/>
<polygon fill="black" stroke="black" points="15644.04,-4405.62 15653.05,-4400.04 15642.53,-4398.78 15644.04,-4405.62"/>
</g>
<!-- ring_stage3_6_3 -->
<g id="node2134" class="node">
<title>ring_stage3_6_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15376.5,-4407.69 15165.5,-4407.69 15165.5,-4354.69 15376.5,-4354.69 15376.5,-4407.69"/>
<text text-anchor="middle" x="15271" y="-4392.49" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="15271" y="-4377.49" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_13×V_13</text>
<text text-anchor="middle" x="15271" y="-4362.49" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_5_3&#45;&gt;ring_stage3_6_3 -->
<g id="edge2987" class="edge">
<title>ring_stage3_5_3&#45;&gt;ring_stage3_6_3</title>
<path fill="none" stroke="black" d="M15272.41,-4444.08C15272.22,-4435.87 15272.01,-4426.64 15271.81,-4417.86"/>
<polygon fill="black" stroke="black" points="15275.31,-4417.78 15271.59,-4407.86 15268.31,-4417.93 15275.31,-4417.78"/>
</g>
<!-- kv_send3_5_4 -->
<g id="node2119" class="node">
<title>kv_send3_5_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15273" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15273" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="15273" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_5_4&#45;&gt;kv_send3_5_4 -->
<g id="edge2944" class="edge">
<title>ring_stage3_5_4&#45;&gt;kv_send3_5_4</title>
<path fill="none" stroke="black" d="M15433.73,-4354.58C15403.74,-4342.99 15368.39,-4329.32 15338.49,-4317.77"/>
<polygon fill="black" stroke="black" points="15339.58,-4314.43 15328.99,-4314.09 15337.05,-4320.96 15339.58,-4314.43"/>
</g>
<!-- ring_stage3_6_4 -->
<g id="node2135" class="node">
<title>ring_stage3_6_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15829.5,-4317.95 15618.5,-4317.95 15618.5,-4264.95 15829.5,-4264.95 15829.5,-4317.95"/>
<text text-anchor="middle" x="15724" y="-4302.75" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="15724" y="-4287.75" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_14×V_14</text>
<text text-anchor="middle" x="15724" y="-4272.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_5_4&#45;&gt;ring_stage3_6_4 -->
<g id="edge2990" class="edge">
<title>ring_stage3_5_4&#45;&gt;ring_stage3_6_4</title>
<path fill="none" stroke="black" d="M15565.39,-4354.58C15591.61,-4344.31 15621.98,-4332.41 15649.09,-4321.79"/>
<polygon fill="black" stroke="black" points="15650.49,-4325 15658.53,-4318.1 15647.94,-4318.49 15650.49,-4325"/>
</g>
<!-- kv_send3_5_5 -->
<g id="node2120" class="node">
<title>kv_send3_5_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14966" cy="-4201.71" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14966" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14966" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_5_5&#45;&gt;kv_send3_5_5 -->
<g id="edge2947" class="edge">
<title>ring_stage3_5_5&#45;&gt;kv_send3_5_5</title>
<path fill="none" stroke="black" d="M14962.47,-4264.6C14962.93,-4256.55 14963.45,-4247.52 14963.94,-4238.9"/>
<polygon fill="black" stroke="black" points="14967.45,-4238.86 14964.52,-4228.68 14960.46,-4238.47 14967.45,-4238.86"/>
</g>
<!-- ring_stage3_6_5 -->
<g id="node2136" class="node">
<title>ring_stage3_6_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15300.5,-4228.21 15089.5,-4228.21 15089.5,-4175.21 15300.5,-4175.21 15300.5,-4228.21"/>
<text text-anchor="middle" x="15195" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="15195" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_15×V_15</text>
<text text-anchor="middle" x="15195" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_5_5&#45;&gt;ring_stage3_6_5 -->
<g id="edge2993" class="edge">
<title>ring_stage3_5_5&#45;&gt;ring_stage3_6_5</title>
<path fill="none" stroke="black" d="M15029.31,-4264.84C15056.82,-4254.52 15088.71,-4242.57 15117.11,-4231.92"/>
<polygon fill="black" stroke="black" points="15118.47,-4235.15 15126.6,-4228.36 15116.01,-4228.59 15118.47,-4235.15"/>
</g>
<!-- kv_send3_5_6 -->
<g id="node2121" class="node">
<title>kv_send3_5_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14722" cy="-4111.97" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14722" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14722" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_5_6&#45;&gt;kv_send3_5_6 -->
<g id="edge2950" class="edge">
<title>ring_stage3_5_6&#45;&gt;kv_send3_5_6</title>
<path fill="none" stroke="black" d="M14726.23,-4174.86C14725.68,-4166.81 14725.06,-4157.78 14724.47,-4149.16"/>
<polygon fill="black" stroke="black" points="14727.95,-4148.68 14723.78,-4138.94 14720.97,-4149.16 14727.95,-4148.68"/>
</g>
<!-- ring_stage3_6_6 -->
<g id="node2137" class="node">
<title>ring_stage3_6_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15062.5,-4138.47 14869.5,-4138.47 14869.5,-4085.47 15062.5,-4085.47 15062.5,-4138.47"/>
<text text-anchor="middle" x="14966" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="14966" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_0×V_0</text>
<text text-anchor="middle" x="14966" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_5_6&#45;&gt;ring_stage3_6_6 -->
<g id="edge2996" class="edge">
<title>ring_stage3_5_6&#45;&gt;ring_stage3_6_6</title>
<path fill="none" stroke="black" d="M14797.48,-4175.1C14825.46,-4164.78 14857.89,-4152.83 14886.78,-4142.18"/>
<polygon fill="black" stroke="black" points="14888.26,-4145.36 14896.43,-4138.62 14885.84,-4138.79 14888.26,-4145.36"/>
</g>
<!-- kv_send3_5_7 -->
<g id="node2122" class="node">
<title>kv_send3_5_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12231" cy="-4022.23" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12231" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="12231" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_5_7&#45;&gt;kv_send3_5_7 -->
<g id="edge2953" class="edge">
<title>ring_stage3_5_7&#45;&gt;kv_send3_5_7</title>
<path fill="none" stroke="black" d="M12385.36,-4085.36C12356.91,-4073.91 12323.43,-4060.43 12294.94,-4048.97"/>
<polygon fill="black" stroke="black" points="12296.07,-4045.65 12285.49,-4045.16 12293.46,-4052.14 12296.07,-4045.65"/>
</g>
<!-- ring_stage3_6_7 -->
<g id="node2138" class="node">
<title>ring_stage3_6_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14820.5,-4048.73 14627.5,-4048.73 14627.5,-3995.73 14820.5,-3995.73 14820.5,-4048.73"/>
<text text-anchor="middle" x="14724" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="14724" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_1×V_1</text>
<text text-anchor="middle" x="14724" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_5_7&#45;&gt;ring_stage3_6_7 -->
<g id="edge2999" class="edge">
<title>ring_stage3_5_7&#45;&gt;ring_stage3_6_7</title>
<path fill="none" stroke="black" d="M12545.6,-4086.46C12548.76,-4085.96 12551.9,-4085.5 12555,-4085.1 13006.74,-4026.77 14147.8,-4107.19 14617.52,-4049.14"/>
<polygon fill="black" stroke="black" points="14617.98,-4052.61 14627.46,-4047.88 14617.1,-4045.67 14617.98,-4052.61"/>
</g>
<!-- kv_send3_5_8 -->
<g id="node2123" class="node">
<title>kv_send3_5_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13134" cy="-3932.49" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13134" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="13134" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_5_8&#45;&gt;kv_send3_5_8 -->
<g id="edge2956" class="edge">
<title>ring_stage3_5_8&#45;&gt;kv_send3_5_8</title>
<path fill="none" stroke="black" d="M12782.69,-3997.28C12785.82,-3996.62 12788.94,-3995.97 12792,-3995.36 12893.46,-3975.08 12920.42,-3979.02 13022,-3959.36 13031.16,-3957.59 13040.71,-3955.6 13050.21,-3953.54"/>
<polygon fill="black" stroke="black" points="13051.05,-3956.93 13060.06,-3951.36 13049.54,-3950.1 13051.05,-3956.93"/>
</g>
<!-- ring_stage3_6_8 -->
<g id="node2139" class="node">
<title>ring_stage3_6_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12538.5,-3958.99 12345.5,-3958.99 12345.5,-3905.99 12538.5,-3905.99 12538.5,-3958.99"/>
<text text-anchor="middle" x="12442" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="12442" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_2×V_2</text>
<text text-anchor="middle" x="12442" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_5_8&#45;&gt;ring_stage3_6_8 -->
<g id="edge3002" class="edge">
<title>ring_stage3_5_8&#45;&gt;ring_stage3_6_8</title>
<path fill="none" stroke="black" d="M12614.77,-3995.62C12585.96,-3985.26 12552.55,-3973.24 12522.83,-3962.56"/>
<polygon fill="black" stroke="black" points="12523.91,-3959.23 12513.32,-3959.14 12521.55,-3965.81 12523.91,-3959.23"/>
</g>
<!-- kv_send3_5_9 -->
<g id="node2124" class="node">
<title>kv_send3_5_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14277" cy="-3842.75" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14277" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14277" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_5_9&#45;&gt;kv_send3_5_9 -->
<g id="edge2959" class="edge">
<title>ring_stage3_5_9&#45;&gt;kv_send3_5_9</title>
<path fill="none" stroke="black" d="M13906.61,-3907.32C13909.44,-3906.73 13912.24,-3906.16 13915,-3905.62 14022.56,-3884.49 14051.18,-3889.37 14159,-3869.62 14168.67,-3867.85 14178.76,-3865.86 14188.78,-3863.79"/>
<polygon fill="black" stroke="black" points="14189.69,-3867.18 14198.76,-3861.7 14188.26,-3860.32 14189.69,-3867.18"/>
</g>
<!-- ring_stage3_6_9 -->
<g id="node2140" class="node">
<title>ring_stage3_6_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13691.5,-3869.25 13498.5,-3869.25 13498.5,-3816.25 13691.5,-3816.25 13691.5,-3869.25"/>
<text text-anchor="middle" x="13595" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="13595" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_3×V_3</text>
<text text-anchor="middle" x="13595" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_5_9&#45;&gt;ring_stage3_6_9 -->
<g id="edge3005" class="edge">
<title>ring_stage3_5_9&#45;&gt;ring_stage3_6_9</title>
<path fill="none" stroke="black" d="M13747.24,-3905.88C13722.18,-3895.65 13693.17,-3883.81 13667.24,-3873.23"/>
<polygon fill="black" stroke="black" points="13668.42,-3869.94 13657.84,-3869.4 13665.78,-3876.42 13668.42,-3869.94"/>
</g>
<!-- kv_send3_5_10 -->
<g id="node2125" class="node">
<title>kv_send3_5_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14713" cy="-3753.01" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14713" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14713" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_5_10&#45;&gt;kv_send3_5_10 -->
<g id="edge2962" class="edge">
<title>ring_stage3_5_10&#45;&gt;kv_send3_5_10</title>
<path fill="none" stroke="black" d="M14566.43,-3816.14C14592.9,-3804.92 14623.95,-3791.76 14650.64,-3780.44"/>
<polygon fill="black" stroke="black" points="14652.04,-3783.65 14659.89,-3776.52 14649.31,-3777.2 14652.04,-3783.65"/>
</g>
<!-- ring_stage3_6_10 -->
<g id="node2141" class="node">
<title>ring_stage3_6_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14361,-3779.51 14159,-3779.51 14159,-3726.51 14361,-3726.51 14361,-3779.51"/>
<text text-anchor="middle" x="14260" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="14260" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_4×V_4</text>
<text text-anchor="middle" x="14260" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_5_10&#45;&gt;ring_stage3_6_10 -->
<g id="edge3008" class="edge">
<title>ring_stage3_5_10&#45;&gt;ring_stage3_6_10</title>
<path fill="none" stroke="black" d="M14434.19,-3816.14C14405.14,-3805.78 14371.45,-3793.76 14341.49,-3783.08"/>
<polygon fill="black" stroke="black" points="14342.5,-3779.72 14331.9,-3779.66 14340.15,-3786.31 14342.5,-3779.72"/>
</g>
<!-- kv_send3_5_11 -->
<g id="node2126" class="node">
<title>kv_send3_5_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13569" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13569" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13569" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_5_11&#45;&gt;kv_send3_5_11 -->
<g id="edge2965" class="edge">
<title>ring_stage3_5_11&#45;&gt;kv_send3_5_11</title>
<path fill="none" stroke="black" d="M13938.77,-3727.87C13935.82,-3727.27 13932.89,-3726.7 13930,-3726.14 13823.2,-3705.68 13794.97,-3709.7 13688,-3690.14 13678.07,-3688.33 13667.71,-3686.29 13657.41,-3684.17"/>
<polygon fill="black" stroke="black" points="13658.09,-3680.74 13647.59,-3682.13 13656.66,-3687.59 13658.09,-3680.74"/>
</g>
<!-- ring_stage3_6_11 -->
<g id="node2142" class="node">
<title>ring_stage3_6_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14567,-3689.77 14365,-3689.77 14365,-3636.77 14567,-3636.77 14567,-3689.77"/>
<text text-anchor="middle" x="14466" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="14466" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_5×V_5</text>
<text text-anchor="middle" x="14466" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_5_11&#45;&gt;ring_stage3_6_11 -->
<g id="edge3011" class="edge">
<title>ring_stage3_5_11&#45;&gt;ring_stage3_6_11</title>
<path fill="none" stroke="black" d="M14141.25,-3727.97C14144.19,-3727.34 14147.12,-3726.73 14150,-3726.14 14237.94,-3708.13 14263.23,-3708.72 14354.78,-3690.34"/>
<polygon fill="black" stroke="black" points="14355.65,-3693.74 14364.75,-3688.32 14354.26,-3686.87 14355.65,-3693.74"/>
</g>
<!-- kv_send3_5_12 -->
<g id="node2127" class="node">
<title>kv_send3_5_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13321" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13321" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="13321" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_5_12&#45;&gt;kv_send3_5_12 -->
<g id="edge2968" class="edge">
<title>ring_stage3_5_12&#45;&gt;kv_send3_5_12</title>
<path fill="none" stroke="black" d="M13334.4,-3636.42C13332.64,-3628.28 13330.66,-3619.14 13328.78,-3610.44"/>
<polygon fill="black" stroke="black" points="13332.16,-3609.53 13326.62,-3600.5 13325.32,-3611.01 13332.16,-3609.53"/>
</g>
<!-- ring_stage3_6_12 -->
<g id="node2143" class="node">
<title>ring_stage3_6_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13651,-3600.03 13449,-3600.03 13449,-3547.03 13651,-3547.03 13651,-3600.03"/>
<text text-anchor="middle" x="13550" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="13550" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_6×V_6</text>
<text text-anchor="middle" x="13550" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_5_12&#45;&gt;ring_stage3_6_12 -->
<g id="edge3014" class="edge">
<title>ring_stage3_5_12&#45;&gt;ring_stage3_6_12</title>
<path fill="none" stroke="black" d="M13401.31,-3636.66C13425.67,-3626.48 13453.86,-3614.7 13479.1,-3604.15"/>
<polygon fill="black" stroke="black" points="13480.74,-3607.26 13488.62,-3600.18 13478.04,-3600.8 13480.74,-3607.26"/>
</g>
<!-- kv_send3_5_13 -->
<g id="node2128" class="node">
<title>kv_send3_5_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13069" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13069" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="13069" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_5_13&#45;&gt;kv_send3_5_13 -->
<g id="edge2971" class="edge">
<title>ring_stage3_5_13&#45;&gt;kv_send3_5_13</title>
<path fill="none" stroke="black" d="M13085.22,-3546.68C13083.09,-3538.54 13080.69,-3529.4 13078.41,-3520.7"/>
<polygon fill="black" stroke="black" points="13081.73,-3519.55 13075.81,-3510.76 13074.96,-3521.32 13081.73,-3519.55"/>
</g>
<!-- ring_stage3_6_13 -->
<g id="node2144" class="node">
<title>ring_stage3_6_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13399,-3510.29 13197,-3510.29 13197,-3457.29 13399,-3457.29 13399,-3510.29"/>
<text text-anchor="middle" x="13298" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="13298" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_7×V_7</text>
<text text-anchor="middle" x="13298" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_5_13&#45;&gt;ring_stage3_6_13 -->
<g id="edge3017" class="edge">
<title>ring_stage3_5_13&#45;&gt;ring_stage3_6_13</title>
<path fill="none" stroke="black" d="M13152.14,-3546.92C13176.04,-3536.74 13203.69,-3524.96 13228.45,-3514.41"/>
<polygon fill="black" stroke="black" points="13229.96,-3517.58 13237.79,-3510.44 13227.22,-3511.14 13229.96,-3517.58"/>
</g>
<!-- kv_send3_5_14 -->
<g id="node2129" class="node">
<title>kv_send3_5_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12821" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12821" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12821" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_5_14&#45;&gt;kv_send3_5_14 -->
<g id="edge2974" class="edge">
<title>ring_stage3_5_14&#45;&gt;kv_send3_5_14</title>
<path fill="none" stroke="black" d="M12834.4,-3456.94C12832.64,-3448.8 12830.66,-3439.66 12828.78,-3430.96"/>
<polygon fill="black" stroke="black" points="12832.16,-3430.05 12826.62,-3421.02 12825.32,-3431.53 12832.16,-3430.05"/>
</g>
<!-- ring_stage3_6_14 -->
<g id="node2145" class="node">
<title>ring_stage3_6_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13151,-3420.55 12949,-3420.55 12949,-3367.55 13151,-3367.55 13151,-3420.55"/>
<text text-anchor="middle" x="13050" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="13050" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_8×V_8</text>
<text text-anchor="middle" x="13050" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_5_14&#45;&gt;ring_stage3_6_14 -->
<g id="edge3020" class="edge">
<title>ring_stage3_5_14&#45;&gt;ring_stage3_6_14</title>
<path fill="none" stroke="black" d="M12901.31,-3457.18C12925.67,-3447 12953.86,-3435.22 12979.1,-3424.67"/>
<polygon fill="black" stroke="black" points="12980.74,-3427.78 12988.62,-3420.7 12978.04,-3421.32 12980.74,-3427.78"/>
</g>
<!-- kv_send3_5_15 -->
<g id="node2130" class="node">
<title>kv_send3_5_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12580" cy="-3304.31" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12580" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12580" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_5_15&#45;&gt;kv_send3_5_15 -->
<g id="edge2977" class="edge">
<title>ring_stage3_5_15&#45;&gt;kv_send3_5_15</title>
<path fill="none" stroke="black" d="M12582.12,-3367.2C12581.84,-3359.15 12581.53,-3350.12 12581.24,-3341.5"/>
<polygon fill="black" stroke="black" points="12584.73,-3341.15 12580.89,-3331.28 12577.73,-3341.39 12584.73,-3341.15"/>
</g>
<!-- ring_stage3_6_15 -->
<g id="node2146" class="node">
<title>ring_stage3_6_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12904,-3330.81 12702,-3330.81 12702,-3277.81 12904,-3277.81 12904,-3330.81"/>
<text text-anchor="middle" x="12803" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
<text text-anchor="middle" x="12803" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_9×V_9</text>
<text text-anchor="middle" x="12803" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_5_15&#45;&gt;ring_stage3_6_15 -->
<g id="edge3023" class="edge">
<title>ring_stage3_5_15&#45;&gt;ring_stage3_6_15</title>
<path fill="none" stroke="black" d="M12647.22,-3367.44C12672.87,-3357.21 12702.55,-3345.37 12729.08,-3334.79"/>
<polygon fill="black" stroke="black" points="12730.7,-3337.91 12738.7,-3330.96 12728.11,-3331.41 12730.7,-3337.91"/>
</g>
<!-- kv_send3_5_0&#45;&gt;ring_stage3_6_1 -->
<g id="edge2982" class="edge">
<title>kv_send3_5_0&#45;&gt;ring_stage3_6_1</title>
<path fill="none" stroke="black" d="M12221.2,-3193.55C12183.61,-3181.94 12135.65,-3167.12 12094.18,-3154.31"/>
<polygon fill="black" stroke="black" points="12095.2,-3150.96 12084.62,-3151.35 12093.14,-3157.65 12095.2,-3150.96"/>
</g>
<!-- kv_send3_5_1&#45;&gt;ring_stage3_6_2 -->
<g id="edge2985" class="edge">
<title>kv_send3_5_1&#45;&gt;ring_stage3_6_2</title>
<path fill="none" stroke="black" d="M12300.65,-3105.35C12313.99,-3102.46 12327.86,-3099.82 12341,-3097.96 12628.6,-3057.21 12708.24,-3101.32 13000.19,-3061.96"/>
<polygon fill="black" stroke="black" points="13000.79,-3065.41 13010.22,-3060.58 12999.84,-3058.47 13000.79,-3065.41"/>
</g>
<!-- kv_send3_5_2&#45;&gt;ring_stage3_6_3 -->
<g id="edge2988" class="edge">
<title>kv_send3_5_2&#45;&gt;ring_stage3_6_3</title>
<path fill="none" stroke="black" d="M14679.3,-4451.62C14692.45,-4448.75 14706.08,-4446.07 14719,-4444.06 14908.36,-4414.55 14961.6,-4436.75 15155.28,-4408.07"/>
<polygon fill="black" stroke="black" points="15155.84,-4411.52 15165.21,-4406.57 15154.8,-4404.6 15155.84,-4411.52"/>
</g>
<!-- kv_send3_5_3&#45;&gt;ring_stage3_6_4 -->
<g id="edge2991" class="edge">
<title>kv_send3_5_3&#45;&gt;ring_stage3_6_4</title>
<path fill="none" stroke="black" d="M15726.1,-4353.87C15725.83,-4345.83 15725.52,-4336.85 15725.23,-4328.29"/>
<polygon fill="black" stroke="black" points="15728.72,-4328.03 15724.88,-4318.15 15721.72,-4328.27 15728.72,-4328.03"/>
</g>
<!-- kv_send3_5_4&#45;&gt;ring_stage3_6_5 -->
<g id="edge2994" class="edge">
<title>kv_send3_5_4&#45;&gt;ring_stage3_6_5</title>
<path fill="none" stroke="black" d="M15250.44,-4265.07C15242.34,-4255.97 15233.09,-4245.56 15224.5,-4235.89"/>
<polygon fill="black" stroke="black" points="15227.04,-4233.49 15217.78,-4228.34 15221.81,-4238.14 15227.04,-4233.49"/>
</g>
<!-- kv_send3_5_5&#45;&gt;ring_stage3_6_6 -->
<g id="edge2997" class="edge">
<title>kv_send3_5_5&#45;&gt;ring_stage3_6_6</title>
<path fill="none" stroke="black" d="M14966,-4174.39C14966,-4166.35 14966,-4157.37 14966,-4148.81"/>
<polygon fill="black" stroke="black" points="14969.5,-4148.67 14966,-4138.67 14962.5,-4148.67 14969.5,-4148.67"/>
</g>
<!-- kv_send3_5_6&#45;&gt;ring_stage3_6_7 -->
<g id="edge3000" class="edge">
<title>kv_send3_5_6&#45;&gt;ring_stage3_6_7</title>
<path fill="none" stroke="black" d="M14722.6,-4084.65C14722.78,-4076.61 14722.99,-4067.63 14723.18,-4059.07"/>
<polygon fill="black" stroke="black" points="14726.69,-4059.01 14723.41,-4048.93 14719.69,-4058.85 14726.69,-4059.01"/>
</g>
<!-- kv_send3_5_7&#45;&gt;ring_stage3_6_8 -->
<g id="edge3003" class="edge">
<title>kv_send3_5_7&#45;&gt;ring_stage3_6_8</title>
<path fill="none" stroke="black" d="M12284.24,-3999.09C12310.57,-3988.14 12342.7,-3974.78 12371.08,-3962.98"/>
<polygon fill="black" stroke="black" points="12372.66,-3966.12 12380.54,-3959.05 12369.97,-3959.65 12372.66,-3966.12"/>
</g>
<!-- kv_send3_5_8&#45;&gt;ring_stage3_6_9 -->
<g id="edge3006" class="edge">
<title>kv_send3_5_8&#45;&gt;ring_stage3_6_9</title>
<path fill="none" stroke="black" d="M13207.62,-3913.6C13220.38,-3910.75 13233.55,-3907.97 13246,-3905.62 13350.56,-3885.87 13380.69,-3890.46 13488.42,-3869.86"/>
<polygon fill="black" stroke="black" points="13489.24,-3873.26 13498.39,-3867.92 13487.9,-3866.39 13489.24,-3873.26"/>
</g>
<!-- kv_send3_5_9&#45;&gt;ring_stage3_6_10 -->
<g id="edge3009" class="edge">
<title>kv_send3_5_9&#45;&gt;ring_stage3_6_10</title>
<path fill="none" stroke="black" d="M14271.99,-3815.9C14270.4,-3807.69 14268.61,-3798.46 14266.91,-3789.68"/>
<polygon fill="black" stroke="black" points="14270.31,-3788.83 14264.97,-3779.68 14263.44,-3790.16 14270.31,-3788.83"/>
</g>
<!-- kv_send3_5_10&#45;&gt;ring_stage3_6_11 -->
<g id="edge3012" class="edge">
<title>kv_send3_5_10&#45;&gt;ring_stage3_6_11</title>
<path fill="none" stroke="black" d="M14652.58,-3730.55C14620.98,-3719.33 14581.86,-3705.43 14547.62,-3693.26"/>
<polygon fill="black" stroke="black" points="14548.69,-3689.93 14538.1,-3689.88 14546.35,-3696.53 14548.69,-3689.93"/>
</g>
<!-- kv_send3_5_11&#45;&gt;ring_stage3_6_12 -->
<g id="edge3015" class="edge">
<title>kv_send3_5_11&#45;&gt;ring_stage3_6_12</title>
<path fill="none" stroke="black" d="M13563.4,-3636.42C13561.62,-3628.21 13559.63,-3618.98 13557.72,-3610.2"/>
<polygon fill="black" stroke="black" points="13561.1,-3609.23 13555.56,-3600.2 13554.25,-3610.71 13561.1,-3609.23"/>
</g>
<!-- kv_send3_5_12&#45;&gt;ring_stage3_6_13 -->
<g id="edge3018" class="edge">
<title>kv_send3_5_12&#45;&gt;ring_stage3_6_13</title>
<path fill="none" stroke="black" d="M13314.22,-3546.68C13312.05,-3538.38 13309.6,-3529.04 13307.28,-3520.18"/>
<polygon fill="black" stroke="black" points="13310.65,-3519.24 13304.73,-3510.46 13303.88,-3521.02 13310.65,-3519.24"/>
</g>
<!-- kv_send3_5_13&#45;&gt;ring_stage3_6_14 -->
<g id="edge3021" class="edge">
<title>kv_send3_5_13&#45;&gt;ring_stage3_6_14</title>
<path fill="none" stroke="black" d="M13063.4,-3456.94C13061.62,-3448.73 13059.63,-3439.5 13057.72,-3430.72"/>
<polygon fill="black" stroke="black" points="13061.1,-3429.75 13055.56,-3420.72 13054.25,-3431.23 13061.1,-3429.75"/>
</g>
<!-- kv_send3_5_14&#45;&gt;ring_stage3_6_15 -->
<g id="edge3024" class="edge">
<title>kv_send3_5_14&#45;&gt;ring_stage3_6_15</title>
<path fill="none" stroke="black" d="M12815.7,-3367.2C12814.01,-3358.99 12812.12,-3349.76 12810.32,-3340.98"/>
<polygon fill="black" stroke="black" points="12813.7,-3340.07 12808.27,-3330.98 12806.85,-3341.48 12813.7,-3340.07"/>
</g>
<!-- kv_send3_5_15&#45;&gt;ring_stage3_6_0 -->
<g id="edge2979" class="edge">
<title>kv_send3_5_15&#45;&gt;ring_stage3_6_0</title>
<path fill="none" stroke="black" d="M12568.51,-3277.46C12564.74,-3268.98 12560.49,-3259.42 12556.47,-3250.39"/>
<polygon fill="black" stroke="black" points="12559.67,-3248.95 12552.41,-3241.24 12553.27,-3251.8 12559.67,-3248.95"/>
</g>
<!-- kv_send3_6_0 -->
<g id="node2147" class="node">
<title>kv_send3_6_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12453" cy="-3124.83" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12453" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12453" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_6_0&#45;&gt;kv_send3_6_0 -->
<g id="edge2980" class="edge">
<title>ring_stage3_6_0&#45;&gt;kv_send3_6_0</title>
<path fill="none" stroke="black" d="M12515.07,-3187.72C12505.78,-3178.46 12495.19,-3167.89 12485.41,-3158.15"/>
<polygon fill="black" stroke="black" points="12487.69,-3155.47 12478.14,-3150.89 12482.75,-3160.43 12487.69,-3155.47"/>
</g>
<!-- ring_stage3_7_0 -->
<g id="node2163" class="node">
<title>ring_stage3_7_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12767.5,-3151.33 12574.5,-3151.33 12574.5,-3098.33 12767.5,-3098.33 12767.5,-3151.33"/>
<text text-anchor="middle" x="12671" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="12671" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_9×V_9</text>
<text text-anchor="middle" x="12671" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_6_0&#45;&gt;ring_stage3_7_0 -->
<g id="edge3026" class="edge">
<title>ring_stage3_6_0&#45;&gt;ring_stage3_7_0</title>
<path fill="none" stroke="black" d="M12578.95,-3187.96C12593.11,-3178.4 12609.35,-3167.44 12624.21,-3157.41"/>
<polygon fill="black" stroke="black" points="12626.45,-3160.12 12632.78,-3151.63 12622.53,-3154.32 12626.45,-3160.12"/>
</g>
<!-- kv_send3_6_1 -->
<g id="node2148" class="node">
<title>kv_send3_6_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12889" cy="-3035.09" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12889" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12889" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_6_1&#45;&gt;kv_send3_6_1 -->
<g id="edge2983" class="edge">
<title>ring_stage3_6_1&#45;&gt;kv_send3_6_1</title>
<path fill="none" stroke="black" d="M12107.78,-3099.34C12110.88,-3098.84 12113.96,-3098.38 12117,-3097.96 12407.98,-3057.58 12486.14,-3103.17 12777,-3061.96 12786.85,-3060.56 12797.12,-3058.73 12807.26,-3056.68"/>
<polygon fill="black" stroke="black" points="12808.28,-3060.05 12817.35,-3054.57 12806.84,-3053.19 12808.28,-3060.05"/>
</g>
<!-- ring_stage3_7_1 -->
<g id="node2164" class="node">
<title>ring_stage3_7_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12107.5,-3061.59 11896.5,-3061.59 11896.5,-3008.59 12107.5,-3008.59 12107.5,-3061.59"/>
<text text-anchor="middle" x="12002" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="12002" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_10×V_10</text>
<text text-anchor="middle" x="12002" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_6_1&#45;&gt;ring_stage3_7_1 -->
<g id="edge3029" class="edge">
<title>ring_stage3_6_1&#45;&gt;ring_stage3_7_1</title>
<path fill="none" stroke="black" d="M12002,-3097.98C12002,-3089.77 12002,-3080.54 12002,-3071.76"/>
<polygon fill="black" stroke="black" points="12005.5,-3071.76 12002,-3061.76 11998.5,-3071.76 12005.5,-3071.76"/>
</g>
<!-- kv_send3_6_2 -->
<g id="node2149" class="node">
<title>kv_send3_6_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13346" cy="-2945.35" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13346" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="13346" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_6_2&#45;&gt;kv_send3_6_2 -->
<g id="edge2986" class="edge">
<title>ring_stage3_6_2&#45;&gt;kv_send3_6_2</title>
<path fill="none" stroke="black" d="M13183.14,-3008.48C13213.53,-2996.88 13249.35,-2983.22 13279.64,-2971.66"/>
<polygon fill="black" stroke="black" points="13281.18,-2974.82 13289.27,-2967.99 13278.68,-2968.28 13281.18,-2974.82"/>
</g>
<!-- ring_stage3_7_2 -->
<g id="node2165" class="node">
<title>ring_stage3_7_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12995.5,-2971.85 12784.5,-2971.85 12784.5,-2918.85 12995.5,-2918.85 12995.5,-2971.85"/>
<text text-anchor="middle" x="12890" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="12890" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_11×V_11</text>
<text text-anchor="middle" x="12890" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_6_2&#45;&gt;ring_stage3_7_2 -->
<g id="edge3032" class="edge">
<title>ring_stage3_6_2&#45;&gt;ring_stage3_7_2</title>
<path fill="none" stroke="black" d="M13050.02,-3008.48C13023.57,-2998.21 12992.93,-2986.31 12965.58,-2975.69"/>
<polygon fill="black" stroke="black" points="12966.65,-2972.35 12956.06,-2972 12964.11,-2978.88 12966.65,-2972.35"/>
</g>
<!-- kv_send3_6_3 -->
<g id="node2150" class="node">
<title>kv_send3_6_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15497" cy="-4291.45" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15497" y="-4295.25" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="15497" y="-4280.25" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_6_3&#45;&gt;kv_send3_6_3 -->
<g id="edge2989" class="edge">
<title>ring_stage3_6_3&#45;&gt;kv_send3_6_3</title>
<path fill="none" stroke="black" d="M15336.98,-4354.58C15366.84,-4342.99 15402.03,-4329.32 15431.8,-4317.77"/>
<polygon fill="black" stroke="black" points="15433.2,-4320.97 15441.26,-4314.09 15430.67,-4314.45 15433.2,-4320.97"/>
</g>
<!-- ring_stage3_7_3 -->
<g id="node2166" class="node">
<title>ring_stage3_7_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13674.5,-2882.11 13463.5,-2882.11 13463.5,-2829.11 13674.5,-2829.11 13674.5,-2882.11"/>
<text text-anchor="middle" x="13569" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13569" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_12×V_12</text>
<text text-anchor="middle" x="13569" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_6_3&#45;&gt;ring_stage3_7_3 -->
<g id="edge3035" class="edge">
<title>ring_stage3_6_3&#45;&gt;ring_stage3_7_3</title>
<path fill="none" stroke="black" d="M15199.91,-4354.63C15184.44,-4345.61 15170.02,-4333.74 15161,-4318.32 15148.94,-4297.7 15144.94,-4282.26 15161,-4264.58 15217.14,-4202.78 15476.7,-4288.35 15535,-4228.58 15585.24,-4177.08 15509.82,-3959.06 15558,-3905.62 15619.64,-3837.24 15702.82,-3940.15 15762,-3869.62 15767.95,-3862.53 15765.17,-3411.41 15719,-3367.18 15609.08,-3261.89 15147.15,-3434.09 15035,-3331.18 14987.56,-3287.65 15062.62,-3231.04 15015,-3187.7 14948.37,-3127.06 14277.82,-3204.74 14205,-3151.7 14184.4,-3136.7 14204.78,-3114.03 14185,-3097.96 14101.97,-3030.5 14022.47,-3137.79 13947,-3061.96 13901.54,-3016.28 13971.52,-2964.11 13926,-2918.48 13889.55,-2881.94 13752.41,-2891.32 13684.76,-2882.28"/>
<polygon fill="black" stroke="black" points="13684.95,-2878.77 13674.53,-2880.67 13683.86,-2885.69 13684.95,-2878.77"/>
</g>
<!-- kv_send3_6_4 -->
<g id="node2151" class="node">
<title>kv_send3_6_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15423" cy="-4201.71" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15423" y="-4205.51" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="15423" y="-4190.51" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_6_4&#45;&gt;kv_send3_6_4 -->
<g id="edge2992" class="edge">
<title>ring_stage3_6_4&#45;&gt;kv_send3_6_4</title>
<path fill="none" stroke="black" d="M15636.13,-4264.84C15592.92,-4252.24 15541.32,-4237.2 15499.71,-4225.07"/>
<polygon fill="black" stroke="black" points="15500.49,-4221.65 15489.91,-4222.22 15498.53,-4228.37 15500.49,-4221.65"/>
</g>
<!-- ring_stage3_7_4 -->
<g id="node2167" class="node">
<title>ring_stage3_7_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15813.5,-4228.21 15602.5,-4228.21 15602.5,-4175.21 15813.5,-4175.21 15813.5,-4228.21"/>
<text text-anchor="middle" x="15708" y="-4213.01" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="15708" y="-4198.01" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_13×V_13</text>
<text text-anchor="middle" x="15708" y="-4183.01" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_6_4&#45;&gt;ring_stage3_7_4 -->
<g id="edge3038" class="edge">
<title>ring_stage3_6_4&#45;&gt;ring_stage3_7_4</title>
<path fill="none" stroke="black" d="M15719.29,-4264.6C15717.79,-4256.39 15716.11,-4247.16 15714.5,-4238.38"/>
<polygon fill="black" stroke="black" points="15717.92,-4237.59 15712.68,-4228.38 15711.03,-4238.84 15717.92,-4237.59"/>
</g>
<!-- kv_send3_6_5 -->
<g id="node2152" class="node">
<title>kv_send3_6_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15194" cy="-4111.97" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15194" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="15194" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_6_5&#45;&gt;kv_send3_6_5 -->
<g id="edge2995" class="edge">
<title>ring_stage3_6_5&#45;&gt;kv_send3_6_5</title>
<path fill="none" stroke="black" d="M15194.71,-4174.86C15194.61,-4166.81 15194.51,-4157.78 15194.41,-4149.16"/>
<polygon fill="black" stroke="black" points="15197.91,-4148.9 15194.3,-4138.94 15190.91,-4148.98 15197.91,-4148.9"/>
</g>
<!-- ring_stage3_7_5 -->
<g id="node2168" class="node">
<title>ring_stage3_7_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15526.5,-4138.47 15315.5,-4138.47 15315.5,-4085.47 15526.5,-4085.47 15526.5,-4138.47"/>
<text text-anchor="middle" x="15421" y="-4123.27" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="15421" y="-4108.27" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_14×V_14</text>
<text text-anchor="middle" x="15421" y="-4093.27" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_6_5&#45;&gt;ring_stage3_7_5 -->
<g id="edge3041" class="edge">
<title>ring_stage3_6_5&#45;&gt;ring_stage3_7_5</title>
<path fill="none" stroke="black" d="M15260.98,-4175.1C15287.43,-4164.83 15318.07,-4152.93 15345.42,-4142.31"/>
<polygon fill="black" stroke="black" points="15346.89,-4145.5 15354.94,-4138.62 15344.35,-4138.97 15346.89,-4145.5"/>
</g>
<!-- kv_send3_6_6 -->
<g id="node2153" class="node">
<title>kv_send3_6_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14966" cy="-4022.23" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14966" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14966" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_6_6&#45;&gt;kv_send3_6_6 -->
<g id="edge2998" class="edge">
<title>ring_stage3_6_6&#45;&gt;kv_send3_6_6</title>
<path fill="none" stroke="black" d="M14966,-4085.12C14966,-4077.07 14966,-4068.04 14966,-4059.42"/>
<polygon fill="black" stroke="black" points="14969.5,-4059.2 14966,-4049.2 14962.5,-4059.2 14969.5,-4059.2"/>
</g>
<!-- ring_stage3_7_6 -->
<g id="node2169" class="node">
<title>ring_stage3_7_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15299.5,-4048.73 15088.5,-4048.73 15088.5,-3995.73 15299.5,-3995.73 15299.5,-4048.73"/>
<text text-anchor="middle" x="15194" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="15194" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_15×V_15</text>
<text text-anchor="middle" x="15194" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_6_6&#45;&gt;ring_stage3_7_6 -->
<g id="edge3044" class="edge">
<title>ring_stage3_6_6&#45;&gt;ring_stage3_7_6</title>
<path fill="none" stroke="black" d="M15032.56,-4085.36C15059.25,-4075.09 15090.16,-4063.19 15117.75,-4052.57"/>
<polygon fill="black" stroke="black" points="15119.28,-4055.74 15127.36,-4048.88 15116.77,-4049.2 15119.28,-4055.74"/>
</g>
<!-- kv_send3_6_7 -->
<g id="node2154" class="node">
<title>kv_send3_6_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14722" cy="-3932.49" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14722" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="14722" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_6_7&#45;&gt;kv_send3_6_7 -->
<g id="edge3001" class="edge">
<title>ring_stage3_6_7&#45;&gt;kv_send3_6_7</title>
<path fill="none" stroke="black" d="M14723.41,-3995.38C14723.23,-3987.33 14723.02,-3978.3 14722.82,-3969.68"/>
<polygon fill="black" stroke="black" points="14726.32,-3969.38 14722.59,-3959.46 14719.32,-3969.54 14726.32,-3969.38"/>
</g>
<!-- ring_stage3_7_7 -->
<g id="node2170" class="node">
<title>ring_stage3_7_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15061.5,-3958.99 14868.5,-3958.99 14868.5,-3905.99 15061.5,-3905.99 15061.5,-3958.99"/>
<text text-anchor="middle" x="14965" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="14965" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_0×V_0</text>
<text text-anchor="middle" x="14965" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_6_7&#45;&gt;ring_stage3_7_7 -->
<g id="edge3047" class="edge">
<title>ring_stage3_6_7&#45;&gt;ring_stage3_7_7</title>
<path fill="none" stroke="black" d="M14794.36,-3995.62C14822.69,-3985.3 14855.53,-3973.35 14884.78,-3962.7"/>
<polygon fill="black" stroke="black" points="14886.36,-3965.85 14894.56,-3959.14 14883.96,-3959.27 14886.36,-3965.85"/>
</g>
<!-- kv_send3_6_8 -->
<g id="node2155" class="node">
<title>kv_send3_6_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12682" cy="-3842.75" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12682" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="12682" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_6_8&#45;&gt;kv_send3_6_8 -->
<g id="edge3004" class="edge">
<title>ring_stage3_6_8&#45;&gt;kv_send3_6_8</title>
<path fill="none" stroke="black" d="M12512.06,-3905.88C12544.16,-3894.14 12582.06,-3880.29 12613.92,-3868.64"/>
<polygon fill="black" stroke="black" points="12615.41,-3871.82 12623.6,-3865.1 12613,-3865.25 12615.41,-3871.82"/>
</g>
<!-- ring_stage3_7_8 -->
<g id="node2171" class="node">
<title>ring_stage3_7_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14818.5,-3869.25 14625.5,-3869.25 14625.5,-3816.25 14818.5,-3816.25 14818.5,-3869.25"/>
<text text-anchor="middle" x="14722" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="14722" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_1×V_1</text>
<text text-anchor="middle" x="14722" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_6_8&#45;&gt;ring_stage3_7_8 -->
<g id="edge3050" class="edge">
<title>ring_stage3_6_8&#45;&gt;ring_stage3_7_8</title>
<path fill="none" stroke="black" d="M12538.54,-3906.84C12541.38,-3906.39 12544.21,-3905.99 12547,-3905.62 12999.77,-3846.67 14143.59,-3927.34 14615.41,-3869.52"/>
<polygon fill="black" stroke="black" points="14615.92,-3872.98 14625.4,-3868.26 14615.04,-3866.04 14615.92,-3872.98"/>
</g>
<!-- kv_send3_6_9 -->
<g id="node2156" class="node">
<title>kv_send3_6_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13574" cy="-3753.01" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13574" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="13574" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_6_9&#45;&gt;kv_send3_6_9 -->
<g id="edge3007" class="edge">
<title>ring_stage3_6_9&#45;&gt;kv_send3_6_9</title>
<path fill="none" stroke="black" d="M13588.81,-3815.9C13586.87,-3807.76 13584.68,-3798.62 13582.59,-3789.92"/>
<polygon fill="black" stroke="black" points="13585.95,-3788.89 13580.22,-3779.98 13579.14,-3790.52 13585.95,-3788.89"/>
</g>
<!-- ring_stage3_7_9 -->
<g id="node2172" class="node">
<title>ring_stage3_7_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13446.5,-3779.51 13253.5,-3779.51 13253.5,-3726.51 13446.5,-3726.51 13446.5,-3779.51"/>
<text text-anchor="middle" x="13350" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13350" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_2×V_2</text>
<text text-anchor="middle" x="13350" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_6_9&#45;&gt;ring_stage3_7_9 -->
<g id="edge3053" class="edge">
<title>ring_stage3_6_9&#45;&gt;ring_stage3_7_9</title>
<path fill="none" stroke="black" d="M13523.48,-3816.14C13494.55,-3805.78 13461,-3793.76 13431.16,-3783.08"/>
<polygon fill="black" stroke="black" points="13432.21,-3779.73 13421.61,-3779.66 13429.85,-3786.32 13432.21,-3779.73"/>
</g>
<!-- kv_send3_6_10 -->
<g id="node2157" class="node">
<title>kv_send3_6_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14715" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14715" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14715" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_6_10&#45;&gt;kv_send3_6_10 -->
<g id="edge3010" class="edge">
<title>ring_stage3_6_10&#45;&gt;kv_send3_6_10</title>
<path fill="none" stroke="black" d="M14361.25,-3727.97C14364.19,-3727.34 14367.12,-3726.73 14370,-3726.14 14461.05,-3707.49 14484.53,-3706.64 14576,-3690.14 14590.13,-3687.59 14605.06,-3684.86 14619.69,-3682.15"/>
<polygon fill="black" stroke="black" points="14620.56,-3685.55 14629.76,-3680.29 14619.29,-3678.67 14620.56,-3685.55"/>
</g>
<!-- ring_stage3_7_10 -->
<g id="node2173" class="node">
<title>ring_stage3_7_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14347,-3689.77 14145,-3689.77 14145,-3636.77 14347,-3636.77 14347,-3689.77"/>
<text text-anchor="middle" x="14246" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="14246" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_3×V_3</text>
<text text-anchor="middle" x="14246" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_6_10&#45;&gt;ring_stage3_7_10 -->
<g id="edge3056" class="edge">
<title>ring_stage3_6_10&#45;&gt;ring_stage3_7_10</title>
<path fill="none" stroke="black" d="M14255.88,-3726.16C14254.57,-3717.95 14253.09,-3708.72 14251.69,-3699.94"/>
<polygon fill="black" stroke="black" points="14255.13,-3699.26 14250.1,-3689.94 14248.21,-3700.36 14255.13,-3699.26"/>
</g>
<!-- kv_send3_6_11 -->
<g id="node2158" class="node">
<title>kv_send3_6_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14036" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14036" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="14036" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_6_11&#45;&gt;kv_send3_6_11 -->
<g id="edge3013" class="edge">
<title>ring_stage3_6_11&#45;&gt;kv_send3_6_11</title>
<path fill="none" stroke="black" d="M14364.75,-3638.24C14361.8,-3637.61 14358.88,-3637 14356,-3636.4 14267.13,-3618.01 14244.02,-3618.04 14155,-3600.4 14145.36,-3598.49 14135.29,-3596.42 14125.27,-3594.31"/>
<polygon fill="black" stroke="black" points="14125.8,-3590.84 14115.29,-3592.19 14124.35,-3597.69 14125.8,-3590.84"/>
</g>
<!-- ring_stage3_7_11 -->
<g id="node2174" class="node">
<title>ring_stage3_7_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15259,-3600.03 15057,-3600.03 15057,-3547.03 15259,-3547.03 15259,-3600.03"/>
<text text-anchor="middle" x="15158" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="15158" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_4×V_4</text>
<text text-anchor="middle" x="15158" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_6_11&#45;&gt;ring_stage3_7_11 -->
<g id="edge3059" class="edge">
<title>ring_stage3_6_11&#45;&gt;ring_stage3_7_11</title>
<path fill="none" stroke="black" d="M14567.29,-3640.92C14576.97,-3639.24 14586.65,-3637.7 14596,-3636.4 14792.39,-3609.13 14847.14,-3630.83 15046.89,-3600.47"/>
<polygon fill="black" stroke="black" points="15047.47,-3603.92 15056.82,-3598.94 15046.4,-3597 15047.47,-3603.92"/>
</g>
<!-- kv_send3_6_12 -->
<g id="node2159" class="node">
<title>kv_send3_6_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13527" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13527" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="13527" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_6_12&#45;&gt;kv_send3_6_12 -->
<g id="edge3016" class="edge">
<title>ring_stage3_6_12&#45;&gt;kv_send3_6_12</title>
<path fill="none" stroke="black" d="M13543.22,-3546.68C13541.09,-3538.54 13538.69,-3529.4 13536.41,-3520.7"/>
<polygon fill="black" stroke="black" points="13539.73,-3519.55 13533.81,-3510.76 13532.96,-3521.32 13539.73,-3519.55"/>
</g>
<!-- ring_stage3_7_12 -->
<g id="node2175" class="node">
<title>ring_stage3_7_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13877,-3510.29 13675,-3510.29 13675,-3457.29 13877,-3457.29 13877,-3510.29"/>
<text text-anchor="middle" x="13776" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13776" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_5×V_5</text>
<text text-anchor="middle" x="13776" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_6_12&#45;&gt;ring_stage3_7_12 -->
<g id="edge3062" class="edge">
<title>ring_stage3_6_12&#45;&gt;ring_stage3_7_12</title>
<path fill="none" stroke="black" d="M13615.98,-3546.92C13642.43,-3536.65 13673.07,-3524.75 13700.42,-3514.13"/>
<polygon fill="black" stroke="black" points="13701.89,-3517.32 13709.94,-3510.44 13699.35,-3510.79 13701.89,-3517.32"/>
</g>
<!-- kv_send3_6_13 -->
<g id="node2160" class="node">
<title>kv_send3_6_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13279" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13279" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="13279" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_6_13&#45;&gt;kv_send3_6_13 -->
<g id="edge3019" class="edge">
<title>ring_stage3_6_13&#45;&gt;kv_send3_6_13</title>
<path fill="none" stroke="black" d="M13292.4,-3456.94C13290.64,-3448.8 13288.66,-3439.66 13286.78,-3430.96"/>
<polygon fill="black" stroke="black" points="13290.16,-3430.05 13284.62,-3421.02 13283.32,-3431.53 13290.16,-3430.05"/>
</g>
<!-- ring_stage3_7_13 -->
<g id="node2176" class="node">
<title>ring_stage3_7_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13629,-3420.55 13427,-3420.55 13427,-3367.55 13629,-3367.55 13629,-3420.55"/>
<text text-anchor="middle" x="13528" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13528" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_6×V_6</text>
<text text-anchor="middle" x="13528" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_6_13&#45;&gt;ring_stage3_7_13 -->
<g id="edge3065" class="edge">
<title>ring_stage3_6_13&#45;&gt;ring_stage3_7_13</title>
<path fill="none" stroke="black" d="M13365.14,-3457.18C13392.07,-3446.91 13423.25,-3435.01 13451.08,-3424.39"/>
<polygon fill="black" stroke="black" points="13452.68,-3427.53 13460.77,-3420.7 13450.18,-3420.99 13452.68,-3427.53"/>
</g>
<!-- kv_send3_6_14 -->
<g id="node2161" class="node">
<title>kv_send3_6_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13032" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13032" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="13032" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_6_14&#45;&gt;kv_send3_6_14 -->
<g id="edge3022" class="edge">
<title>ring_stage3_6_14&#45;&gt;kv_send3_6_14</title>
<path fill="none" stroke="black" d="M13044.7,-3367.2C13043.03,-3359.06 13041.15,-3349.92 13039.37,-3341.22"/>
<polygon fill="black" stroke="black" points="13042.77,-3340.37 13037.33,-3331.28 13035.91,-3341.78 13042.77,-3340.37"/>
</g>
<!-- ring_stage3_7_14 -->
<g id="node2177" class="node">
<title>ring_stage3_7_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13362,-3330.81 13160,-3330.81 13160,-3277.81 13362,-3277.81 13362,-3330.81"/>
<text text-anchor="middle" x="13261" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13261" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_7×V_7</text>
<text text-anchor="middle" x="13261" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_6_14&#45;&gt;ring_stage3_7_14 -->
<g id="edge3068" class="edge">
<title>ring_stage3_6_14&#45;&gt;ring_stage3_7_14</title>
<path fill="none" stroke="black" d="M13111.6,-3367.44C13136.08,-3357.26 13164.41,-3345.48 13189.77,-3334.93"/>
<polygon fill="black" stroke="black" points="13191.44,-3338.03 13199.33,-3330.96 13188.75,-3331.56 13191.44,-3338.03"/>
</g>
<!-- kv_send3_6_15 -->
<g id="node2162" class="node">
<title>kv_send3_6_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12782" cy="-3214.57" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12782" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12782" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_6_15&#45;&gt;kv_send3_6_15 -->
<g id="edge3025" class="edge">
<title>ring_stage3_6_15&#45;&gt;kv_send3_6_15</title>
<path fill="none" stroke="black" d="M12796.81,-3277.46C12794.87,-3269.32 12792.68,-3260.18 12790.59,-3251.48"/>
<polygon fill="black" stroke="black" points="12793.95,-3250.45 12788.22,-3241.54 12787.14,-3252.08 12793.95,-3250.45"/>
</g>
<!-- ring_stage3_7_15 -->
<g id="node2178" class="node">
<title>ring_stage3_7_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13112,-3241.07 12910,-3241.07 12910,-3188.07 13112,-3188.07 13112,-3241.07"/>
<text text-anchor="middle" x="13011" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
<text text-anchor="middle" x="13011" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_8×V_8</text>
<text text-anchor="middle" x="13011" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_6_15&#45;&gt;ring_stage3_7_15 -->
<g id="edge3071" class="edge">
<title>ring_stage3_6_15&#45;&gt;ring_stage3_7_15</title>
<path fill="none" stroke="black" d="M12863.72,-3277.7C12887.86,-3267.52 12915.78,-3255.74 12940.78,-3245.19"/>
<polygon fill="black" stroke="black" points="12942.35,-3248.33 12950.2,-3241.22 12939.63,-3241.88 12942.35,-3248.33"/>
</g>
<!-- kv_send3_6_0&#45;&gt;ring_stage3_7_1 -->
<g id="edge3030" class="edge">
<title>kv_send3_6_0&#45;&gt;ring_stage3_7_1</title>
<path fill="none" stroke="black" d="M12379.05,-3106.01C12366.39,-3103.17 12353.34,-3100.37 12341,-3097.96 12245.13,-3079.21 12217.71,-3080.9 12117.47,-3061.99"/>
<polygon fill="black" stroke="black" points="12118.02,-3058.54 12107.54,-3060.1 12116.71,-3065.41 12118.02,-3058.54"/>
</g>
<!-- kv_send3_6_1&#45;&gt;ring_stage3_7_2 -->
<g id="edge3033" class="edge">
<title>kv_send3_6_1&#45;&gt;ring_stage3_7_2</title>
<path fill="none" stroke="black" d="M12889.3,-3007.77C12889.39,-2999.73 12889.49,-2990.75 12889.59,-2982.19"/>
<polygon fill="black" stroke="black" points="12893.09,-2982.09 12889.71,-2972.05 12886.09,-2982.01 12893.09,-2982.09"/>
</g>
<!-- kv_send3_6_2&#45;&gt;ring_stage3_7_3 -->
<g id="edge3036" class="edge">
<title>kv_send3_6_2&#45;&gt;ring_stage3_7_3</title>
<path fill="none" stroke="black" d="M13401.41,-2922.55C13429.58,-2911.46 13464.22,-2897.84 13494.67,-2885.86"/>
<polygon fill="black" stroke="black" points="13495.95,-2889.11 13503.98,-2882.19 13493.39,-2882.6 13495.95,-2889.11"/>
</g>
<!-- kv_send3_6_3&#45;&gt;ring_stage3_7_4 -->
<g id="edge3039" class="edge">
<title>kv_send3_6_3&#45;&gt;ring_stage3_7_4</title>
<path fill="none" stroke="black" d="M15550.24,-4268.31C15576.57,-4257.37 15608.7,-4244 15637.08,-4232.2"/>
<polygon fill="black" stroke="black" points="15638.66,-4235.34 15646.54,-4228.27 15635.97,-4228.87 15638.66,-4235.34"/>
</g>
<!-- kv_send3_6_4&#45;&gt;ring_stage3_7_5 -->
<g id="edge3042" class="edge">
<title>kv_send3_6_4&#45;&gt;ring_stage3_7_5</title>
<path fill="none" stroke="black" d="M15422.4,-4174.39C15422.22,-4166.35 15422.01,-4157.37 15421.82,-4148.81"/>
<polygon fill="black" stroke="black" points="15425.31,-4148.59 15421.59,-4138.67 15418.31,-4148.75 15425.31,-4148.59"/>
</g>
<!-- kv_send3_6_5&#45;&gt;ring_stage3_7_6 -->
<g id="edge3045" class="edge">
<title>kv_send3_6_5&#45;&gt;ring_stage3_7_6</title>
<path fill="none" stroke="black" d="M15194,-4084.65C15194,-4076.61 15194,-4067.63 15194,-4059.07"/>
<polygon fill="black" stroke="black" points="15197.5,-4058.93 15194,-4048.93 15190.5,-4058.93 15197.5,-4058.93"/>
</g>
<!-- kv_send3_6_6&#45;&gt;ring_stage3_7_7 -->
<g id="edge3048" class="edge">
<title>kv_send3_6_6&#45;&gt;ring_stage3_7_7</title>
<path fill="none" stroke="black" d="M14965.7,-3994.91C14965.61,-3986.87 14965.51,-3977.89 14965.41,-3969.33"/>
<polygon fill="black" stroke="black" points="14968.91,-3969.15 14965.29,-3959.19 14961.91,-3969.23 14968.91,-3969.15"/>
</g>
<!-- kv_send3_6_7&#45;&gt;ring_stage3_7_8 -->
<g id="edge3051" class="edge">
<title>kv_send3_6_7&#45;&gt;ring_stage3_7_8</title>
<path fill="none" stroke="black" d="M14722,-3905.17C14722,-3897.13 14722,-3888.15 14722,-3879.59"/>
<polygon fill="black" stroke="black" points="14725.5,-3879.45 14722,-3869.45 14718.5,-3879.45 14725.5,-3879.45"/>
</g>
<!-- kv_send3_6_8&#45;&gt;ring_stage3_7_9 -->
<g id="edge3054" class="edge">
<title>kv_send3_6_8&#45;&gt;ring_stage3_7_9</title>
<path fill="none" stroke="black" d="M12754,-3823.48C12767.23,-3820.59 12780.98,-3817.89 12794,-3815.88 12989.09,-3785.71 13044.15,-3810.93 13243.46,-3779.84"/>
<polygon fill="black" stroke="black" points="13244.04,-3783.29 13253.37,-3778.27 13242.94,-3776.38 13244.04,-3783.29"/>
</g>
<!-- kv_send3_6_9&#45;&gt;ring_stage3_7_10 -->
<g id="edge3057" class="edge">
<title>kv_send3_6_9&#45;&gt;ring_stage3_7_10</title>
<path fill="none" stroke="black" d="M13650.53,-3733.66C13664.27,-3730.82 13678.52,-3728.16 13692,-3726.14 13884.56,-3697.36 13938.64,-3720.11 14134.76,-3690.23"/>
<polygon fill="black" stroke="black" points="14135.47,-3693.66 14144.82,-3688.67 14134.4,-3686.74 14135.47,-3693.66"/>
</g>
<!-- kv_send3_6_10&#45;&gt;ring_stage3_7_11 -->
<g id="edge3060" class="edge">
<title>kv_send3_6_10&#45;&gt;ring_stage3_7_11</title>
<path fill="none" stroke="black" d="M14793.95,-3644.56C14807.29,-3641.72 14821.02,-3638.9 14834,-3636.4 14925.56,-3618.76 14951.73,-3619.39 15046.72,-3600.61"/>
<polygon fill="black" stroke="black" points="15047.64,-3603.99 15056.76,-3598.6 15046.27,-3597.13 15047.64,-3603.99"/>
</g>
<!-- kv_send3_6_11&#45;&gt;ring_stage3_7_12 -->
<g id="edge3063" class="edge">
<title>kv_send3_6_11&#45;&gt;ring_stage3_7_12</title>
<path fill="none" stroke="black" d="M13973.39,-3551.4C13939.87,-3540.09 13898.09,-3525.99 13861.61,-3513.68"/>
<polygon fill="black" stroke="black" points="13862.56,-3510.31 13851.97,-3510.43 13860.33,-3516.94 13862.56,-3510.31"/>
</g>
<!-- kv_send3_6_12&#45;&gt;ring_stage3_7_13 -->
<g id="edge3066" class="edge">
<title>kv_send3_6_12&#45;&gt;ring_stage3_7_13</title>
<path fill="none" stroke="black" d="M13527.3,-3456.47C13527.39,-3448.43 13527.49,-3439.45 13527.59,-3430.89"/>
<polygon fill="black" stroke="black" points="13531.09,-3430.79 13527.71,-3420.75 13524.09,-3430.71 13531.09,-3430.79"/>
</g>
<!-- kv_send3_6_13&#45;&gt;ring_stage3_7_14 -->
<g id="edge3069" class="edge">
<title>kv_send3_6_13&#45;&gt;ring_stage3_7_14</title>
<path fill="none" stroke="black" d="M13273.7,-3367.2C13272.01,-3358.99 13270.12,-3349.76 13268.32,-3340.98"/>
<polygon fill="black" stroke="black" points="13271.7,-3340.07 13266.27,-3330.98 13264.85,-3341.48 13271.7,-3340.07"/>
</g>
<!-- kv_send3_6_14&#45;&gt;ring_stage3_7_15 -->
<g id="edge3072" class="edge">
<title>kv_send3_6_14&#45;&gt;ring_stage3_7_15</title>
<path fill="none" stroke="black" d="M13025.81,-3277.46C13023.85,-3269.25 13021.64,-3260.02 13019.54,-3251.24"/>
<polygon fill="black" stroke="black" points="13022.87,-3250.15 13017.14,-3241.24 13016.07,-3251.78 13022.87,-3250.15"/>
</g>
<!-- kv_send3_6_15&#45;&gt;ring_stage3_7_0 -->
<g id="edge3027" class="edge">
<title>kv_send3_6_15&#45;&gt;ring_stage3_7_0</title>
<path fill="none" stroke="black" d="M12750.78,-3188.9C12738.57,-3179.24 12724.4,-3168.04 12711.43,-3157.78"/>
<polygon fill="black" stroke="black" points="12713.54,-3155 12703.53,-3151.54 12709.2,-3160.49 12713.54,-3155"/>
</g>
<!-- kv_send3_7_0 -->
<g id="node2179" class="node">
<title>kv_send3_7_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12229" cy="-3035.09" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12229" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12229" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_7_0&#45;&gt;kv_send3_7_0 -->
<g id="edge3028" class="edge">
<title>ring_stage3_7_0&#45;&gt;kv_send3_7_0</title>
<path fill="none" stroke="black" d="M12574.31,-3099.9C12571.17,-3099.23 12568.06,-3098.58 12565,-3097.96 12466.6,-3078.04 12440.54,-3081.17 12342,-3061.96 12332.69,-3060.15 12322.98,-3058.12 12313.33,-3056.03"/>
<polygon fill="black" stroke="black" points="12313.83,-3052.56 12303.31,-3053.83 12312.33,-3059.39 12313.83,-3052.56"/>
</g>
<!-- ring_stage3_8_0 -->
<g id="node2195" class="node">
<title>ring_stage3_8_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12543.5,-3061.59 12350.5,-3061.59 12350.5,-3008.59 12543.5,-3008.59 12543.5,-3061.59"/>
<text text-anchor="middle" x="12447" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="12447" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_8×V_8</text>
<text text-anchor="middle" x="12447" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_7_0&#45;&gt;ring_stage3_8_0 -->
<g id="edge3074" class="edge">
<title>ring_stage3_7_0&#45;&gt;ring_stage3_8_0</title>
<path fill="none" stroke="black" d="M12605.61,-3098.22C12579.39,-3087.95 12549.02,-3076.05 12521.91,-3065.43"/>
<polygon fill="black" stroke="black" points="12523.06,-3062.12 12512.47,-3061.74 12520.51,-3068.64 12523.06,-3062.12"/>
</g>
<!-- kv_send3_7_1 -->
<g id="node2180" class="node">
<title>kv_send3_7_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12449" cy="-2945.35" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12449" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12449" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_7_1&#45;&gt;kv_send3_7_1 -->
<g id="edge3031" class="edge">
<title>ring_stage3_7_1&#45;&gt;kv_send3_7_1</title>
<path fill="none" stroke="black" d="M12107.54,-3010.09C12110.73,-3009.45 12113.89,-3008.82 12117,-3008.22 12214.26,-2989.34 12239.79,-2991.38 12337,-2972.22 12346.16,-2970.42 12355.7,-2968.41 12365.19,-2966.33"/>
<polygon fill="black" stroke="black" points="12366.04,-2969.73 12375.04,-2964.15 12364.52,-2962.89 12366.04,-2969.73"/>
</g>
<!-- ring_stage3_8_1 -->
<g id="node2196" class="node">
<title>ring_stage3_8_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12103.5,-2971.85 11910.5,-2971.85 11910.5,-2918.85 12103.5,-2918.85 12103.5,-2971.85"/>
<text text-anchor="middle" x="12007" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="12007" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_9×V_9</text>
<text text-anchor="middle" x="12007" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_7_1&#45;&gt;ring_stage3_8_1 -->
<g id="edge3077" class="edge">
<title>ring_stage3_7_1&#45;&gt;ring_stage3_8_1</title>
<path fill="none" stroke="black" d="M12003.47,-3008.24C12003.94,-3000.03 12004.47,-2990.8 12004.97,-2982.02"/>
<polygon fill="black" stroke="black" points="12008.46,-2982.2 12005.54,-2972.02 12001.47,-2981.8 12008.46,-2982.2"/>
</g>
<!-- kv_send3_7_2 -->
<g id="node2181" class="node">
<title>kv_send3_7_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13118" cy="-2855.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13118" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="13118" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_7_2&#45;&gt;kv_send3_7_2 -->
<g id="edge3034" class="edge">
<title>ring_stage3_7_2&#45;&gt;kv_send3_7_2</title>
<path fill="none" stroke="black" d="M12956.56,-2918.74C12986.69,-2907.14 13022.19,-2893.48 13052.22,-2881.92"/>
<polygon fill="black" stroke="black" points="13053.69,-2885.11 13061.77,-2878.25 13051.18,-2878.58 13053.69,-2885.11"/>
</g>
<!-- ring_stage3_8_2 -->
<g id="node2197" class="node">
<title>ring_stage3_8_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12783.5,-2882.11 12572.5,-2882.11 12572.5,-2829.11 12783.5,-2829.11 12783.5,-2882.11"/>
<text text-anchor="middle" x="12678" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="12678" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_10×V_10</text>
<text text-anchor="middle" x="12678" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_7_2&#45;&gt;ring_stage3_8_2 -->
<g id="edge3080" class="edge">
<title>ring_stage3_7_2&#45;&gt;ring_stage3_8_2</title>
<path fill="none" stroke="black" d="M12828.11,-2918.74C12803.4,-2908.51 12774.8,-2896.67 12749.24,-2886.09"/>
<polygon fill="black" stroke="black" points="12750.54,-2882.85 12739.97,-2882.26 12747.87,-2889.31 12750.54,-2882.85"/>
</g>
<!-- kv_send3_7_3 -->
<g id="node2182" class="node">
<title>kv_send3_7_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13568" cy="-2765.87" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13568" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="13568" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_7_3&#45;&gt;kv_send3_7_3 -->
<g id="edge3037" class="edge">
<title>ring_stage3_7_3&#45;&gt;kv_send3_7_3</title>
<path fill="none" stroke="black" d="M13568.71,-2828.76C13568.61,-2820.71 13568.51,-2811.68 13568.41,-2803.06"/>
<polygon fill="black" stroke="black" points="13571.91,-2802.8 13568.3,-2792.84 13564.91,-2802.88 13571.91,-2802.8"/>
</g>
<!-- ring_stage3_8_3 -->
<g id="node2198" class="node">
<title>ring_stage3_8_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13445.5,-2792.37 13234.5,-2792.37 13234.5,-2739.37 13445.5,-2739.37 13445.5,-2792.37"/>
<text text-anchor="middle" x="13340" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="13340" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_11×V_11</text>
<text text-anchor="middle" x="13340" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_7_3&#45;&gt;ring_stage3_8_3 -->
<g id="edge3083" class="edge">
<title>ring_stage3_7_3&#45;&gt;ring_stage3_8_3</title>
<path fill="none" stroke="black" d="M13502.15,-2829C13475.34,-2818.73 13444.29,-2806.83 13416.58,-2796.21"/>
<polygon fill="black" stroke="black" points="13417.53,-2792.83 13406.93,-2792.52 13415.02,-2799.36 13417.53,-2792.83"/>
</g>
<!-- kv_send3_7_4 -->
<g id="node2183" class="node">
<title>kv_send3_7_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15689" cy="-4111.97" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15689" y="-4115.77" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="15689" y="-4100.77" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_7_4&#45;&gt;kv_send3_7_4 -->
<g id="edge3040" class="edge">
<title>ring_stage3_7_4&#45;&gt;kv_send3_7_4</title>
<path fill="none" stroke="black" d="M15702.4,-4174.86C15700.64,-4166.72 15698.66,-4157.58 15696.78,-4148.88"/>
<polygon fill="black" stroke="black" points="15700.16,-4147.97 15694.62,-4138.94 15693.32,-4149.45 15700.16,-4147.97"/>
</g>
<!-- ring_stage3_8_4 -->
<g id="node2199" class="node">
<title>ring_stage3_8_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14151.5,-2676.5 13940.5,-2676.5 13940.5,-2623.5 14151.5,-2623.5 14151.5,-2676.5"/>
<text text-anchor="middle" x="14046" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="14046" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_12×V_12</text>
<text text-anchor="middle" x="14046" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_7_4&#45;&gt;ring_stage3_8_4 -->
<g id="edge3086" class="edge">
<title>ring_stage3_7_4&#45;&gt;ring_stage3_8_4</title>
<path fill="none" stroke="black" d="M15763.78,-4174.98C15778.2,-4165.64 15792.14,-4153.65 15801,-4138.84 15827.51,-4094.55 15812,-4074.85 15812,-4023.23 15812,-4023.23 15812,-4023.23 15812,-3752.01 15812,-3432.59 15749,-3355.51 15749,-3036.09 15749,-3036.09 15749,-3036.09 15749,-2944.35 15749,-2892.78 15776.1,-2864.56 15739,-2828.74 15682.65,-2774.34 15105.65,-2826.56 15035,-2792.74 15006.11,-2778.91 15015.94,-2752.72 14987,-2739 14820.98,-2660.3 14339.72,-2745.62 14161,-2703 14140.67,-2698.15 14119.52,-2689.7 14100.99,-2681"/>
<polygon fill="black" stroke="black" points="14102.37,-2677.77 14091.84,-2676.58 14099.33,-2684.08 14102.37,-2677.77"/>
</g>
<!-- kv_send3_7_5 -->
<g id="node2184" class="node">
<title>kv_send3_7_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15421" cy="-4022.23" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15421" y="-4026.03" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="15421" y="-4011.03" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_7_5&#45;&gt;kv_send3_7_5 -->
<g id="edge3043" class="edge">
<title>ring_stage3_7_5&#45;&gt;kv_send3_7_5</title>
<path fill="none" stroke="black" d="M15421,-4085.12C15421,-4077.07 15421,-4068.04 15421,-4059.42"/>
<polygon fill="black" stroke="black" points="15424.5,-4059.2 15421,-4049.2 15417.5,-4059.2 15424.5,-4059.2"/>
</g>
<!-- ring_stage3_8_5 -->
<g id="node2200" class="node">
<title>ring_stage3_8_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15785.5,-4048.73 15574.5,-4048.73 15574.5,-3995.73 15785.5,-3995.73 15785.5,-4048.73"/>
<text text-anchor="middle" x="15680" y="-4033.53" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="15680" y="-4018.53" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_13×V_13</text>
<text text-anchor="middle" x="15680" y="-4003.53" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_7_5&#45;&gt;ring_stage3_8_5 -->
<g id="edge3089" class="edge">
<title>ring_stage3_7_5&#45;&gt;ring_stage3_8_5</title>
<path fill="none" stroke="black" d="M15496.61,-4085.36C15527.33,-4074.95 15562.97,-4062.88 15594.61,-4052.16"/>
<polygon fill="black" stroke="black" points="15595.95,-4055.4 15604.3,-4048.88 15593.7,-4048.77 15595.95,-4055.4"/>
</g>
<!-- kv_send3_7_6 -->
<g id="node2185" class="node">
<title>kv_send3_7_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15192" cy="-3932.49" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15192" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="15192" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_7_6&#45;&gt;kv_send3_7_6 -->
<g id="edge3046" class="edge">
<title>ring_stage3_7_6&#45;&gt;kv_send3_7_6</title>
<path fill="none" stroke="black" d="M15193.41,-3995.38C15193.23,-3987.33 15193.02,-3978.3 15192.82,-3969.68"/>
<polygon fill="black" stroke="black" points="15196.32,-3969.38 15192.59,-3959.46 15189.32,-3969.54 15196.32,-3969.38"/>
</g>
<!-- ring_stage3_8_6 -->
<g id="node2201" class="node">
<title>ring_stage3_8_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15525.5,-3958.99 15314.5,-3958.99 15314.5,-3905.99 15525.5,-3905.99 15525.5,-3958.99"/>
<text text-anchor="middle" x="15420" y="-3943.79" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="15420" y="-3928.79" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_14×V_14</text>
<text text-anchor="middle" x="15420" y="-3913.79" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_7_6&#45;&gt;ring_stage3_8_6 -->
<g id="edge3092" class="edge">
<title>ring_stage3_7_6&#45;&gt;ring_stage3_8_6</title>
<path fill="none" stroke="black" d="M15259.98,-3995.62C15286.43,-3985.35 15317.07,-3973.45 15344.42,-3962.83"/>
<polygon fill="black" stroke="black" points="15345.89,-3966.02 15353.94,-3959.14 15343.35,-3959.49 15345.89,-3966.02"/>
</g>
<!-- kv_send3_7_7 -->
<g id="node2186" class="node">
<title>kv_send3_7_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14964" cy="-3842.75" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14964" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="14964" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_7_7&#45;&gt;kv_send3_7_7 -->
<g id="edge3049" class="edge">
<title>ring_stage3_7_7&#45;&gt;kv_send3_7_7</title>
<path fill="none" stroke="black" d="M14964.71,-3905.64C14964.61,-3897.59 14964.51,-3888.56 14964.41,-3879.94"/>
<polygon fill="black" stroke="black" points="14967.91,-3879.68 14964.3,-3869.72 14960.91,-3879.76 14967.91,-3879.68"/>
</g>
<!-- ring_stage3_8_7 -->
<g id="node2202" class="node">
<title>ring_stage3_8_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15297.5,-3869.25 15086.5,-3869.25 15086.5,-3816.25 15297.5,-3816.25 15297.5,-3869.25"/>
<text text-anchor="middle" x="15192" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="15192" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_15×V_15</text>
<text text-anchor="middle" x="15192" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_7_7&#45;&gt;ring_stage3_8_7 -->
<g id="edge3095" class="edge">
<title>ring_stage3_7_7&#45;&gt;ring_stage3_8_7</title>
<path fill="none" stroke="black" d="M15031.27,-3905.88C15057.84,-3895.61 15088.62,-3883.71 15116.08,-3873.09"/>
<polygon fill="black" stroke="black" points="15117.58,-3876.27 15125.65,-3869.4 15115.06,-3869.74 15117.58,-3876.27"/>
</g>
<!-- kv_send3_7_8 -->
<g id="node2187" class="node">
<title>kv_send3_7_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14482" cy="-3753.01" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14482" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14482" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_7_8&#45;&gt;kv_send3_7_8 -->
<g id="edge3052" class="edge">
<title>ring_stage3_7_8&#45;&gt;kv_send3_7_8</title>
<path fill="none" stroke="black" d="M14651.94,-3816.14C14619.84,-3804.4 14581.94,-3790.55 14550.08,-3778.9"/>
<polygon fill="black" stroke="black" points="14551,-3775.51 14540.4,-3775.36 14548.59,-3782.08 14551,-3775.51"/>
</g>
<!-- ring_stage3_8_8 -->
<g id="node2203" class="node">
<title>ring_stage3_8_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15054.5,-3779.51 14861.5,-3779.51 14861.5,-3726.51 15054.5,-3726.51 15054.5,-3779.51"/>
<text text-anchor="middle" x="14958" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="14958" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_0×V_0</text>
<text text-anchor="middle" x="14958" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_7_8&#45;&gt;ring_stage3_8_8 -->
<g id="edge3098" class="edge">
<title>ring_stage3_7_8&#45;&gt;ring_stage3_8_8</title>
<path fill="none" stroke="black" d="M14790.9,-3816.14C14818.64,-3805.82 14850.8,-3793.87 14879.45,-3783.22"/>
<polygon fill="black" stroke="black" points="14880.87,-3786.42 14889.02,-3779.66 14878.43,-3779.86 14880.87,-3786.42"/>
</g>
<!-- kv_send3_7_9 -->
<g id="node2188" class="node">
<title>kv_send3_7_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14017" cy="-3663.27" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14017" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14017" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_7_9&#45;&gt;kv_send3_7_9 -->
<g id="edge3055" class="edge">
<title>ring_stage3_7_9&#45;&gt;kv_send3_7_9</title>
<path fill="none" stroke="black" d="M13446.57,-3727.6C13449.41,-3727.08 13452.22,-3726.59 13455,-3726.14 13650.41,-3694.36 13703.19,-3719.41 13899,-3690.14 13909.22,-3688.61 13919.87,-3686.72 13930.42,-3684.65"/>
<polygon fill="black" stroke="black" points="13931.36,-3688.03 13940.47,-3682.62 13929.98,-3681.17 13931.36,-3688.03"/>
</g>
<!-- ring_stage3_8_9 -->
<g id="node2204" class="node">
<title>ring_stage3_8_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13889.5,-3689.77 13696.5,-3689.77 13696.5,-3636.77 13889.5,-3636.77 13889.5,-3689.77"/>
<text text-anchor="middle" x="13793" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="13793" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_1×V_1</text>
<text text-anchor="middle" x="13793" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_7_9&#45;&gt;ring_stage3_8_9 -->
<g id="edge3101" class="edge">
<title>ring_stage3_7_9&#45;&gt;ring_stage3_8_9</title>
<path fill="none" stroke="black" d="M13446.62,-3727.87C13449.44,-3727.27 13452.24,-3726.69 13455,-3726.14 13554.64,-3706.21 13583.52,-3710.41 13686.51,-3690.37"/>
<polygon fill="black" stroke="black" points="13687.25,-3693.79 13696.38,-3688.42 13685.89,-3686.92 13687.25,-3693.79"/>
</g>
<!-- kv_send3_7_10 -->
<g id="node2189" class="node">
<title>kv_send3_7_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14929" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14929" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14929" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_7_10&#45;&gt;kv_send3_7_10 -->
<g id="edge3058" class="edge">
<title>ring_stage3_7_10&#45;&gt;kv_send3_7_10</title>
<path fill="none" stroke="black" d="M14347.18,-3637.87C14350.15,-3637.35 14353.09,-3636.86 14356,-3636.4 14555.98,-3605.14 14609.76,-3629.97 14810,-3600.4 14820.49,-3598.85 14831.43,-3596.92 14842.26,-3594.81"/>
<polygon fill="black" stroke="black" points="14843.03,-3598.22 14852.14,-3592.83 14841.65,-3591.36 14843.03,-3598.22"/>
</g>
<!-- ring_stage3_8_10 -->
<g id="node2205" class="node">
<title>ring_stage3_8_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14577,-3600.03 14375,-3600.03 14375,-3547.03 14577,-3547.03 14577,-3600.03"/>
<text text-anchor="middle" x="14476" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="14476" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_2×V_2</text>
<text text-anchor="middle" x="14476" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_7_10&#45;&gt;ring_stage3_8_10 -->
<g id="edge3104" class="edge">
<title>ring_stage3_7_10&#45;&gt;ring_stage3_8_10</title>
<path fill="none" stroke="black" d="M14313.14,-3636.66C14340.07,-3626.39 14371.25,-3614.49 14399.08,-3603.87"/>
<polygon fill="black" stroke="black" points="14400.68,-3607.01 14408.77,-3600.18 14398.18,-3600.47 14400.68,-3607.01"/>
</g>
<!-- kv_send3_7_11 -->
<g id="node2190" class="node">
<title>kv_send3_7_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15374" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15374" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="15374" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_7_11&#45;&gt;kv_send3_7_11 -->
<g id="edge3061" class="edge">
<title>ring_stage3_7_11&#45;&gt;kv_send3_7_11</title>
<path fill="none" stroke="black" d="M15221.06,-3546.92C15248.91,-3535.6 15281.63,-3522.31 15309.63,-3510.94"/>
<polygon fill="black" stroke="black" points="15310.99,-3514.16 15318.94,-3507.16 15308.35,-3507.68 15310.99,-3514.16"/>
</g>
<!-- ring_stage3_8_11 -->
<g id="node2206" class="node">
<title>ring_stage3_8_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15246,-3510.29 15044,-3510.29 15044,-3457.29 15246,-3457.29 15246,-3510.29"/>
<text text-anchor="middle" x="15145" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="15145" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_3×V_3</text>
<text text-anchor="middle" x="15145" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_7_11&#45;&gt;ring_stage3_8_11 -->
<g id="edge3107" class="edge">
<title>ring_stage3_7_11&#45;&gt;ring_stage3_8_11</title>
<path fill="none" stroke="black" d="M15154.17,-3546.68C15152.95,-3538.47 15151.59,-3529.24 15150.29,-3520.46"/>
<polygon fill="black" stroke="black" points="15153.73,-3519.84 15148.8,-3510.46 15146.81,-3520.86 15153.73,-3519.84"/>
</g>
<!-- kv_send3_7_12 -->
<g id="node2191" class="node">
<title>kv_send3_7_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13767" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13767" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="13767" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_7_12&#45;&gt;kv_send3_7_12 -->
<g id="edge3064" class="edge">
<title>ring_stage3_7_12&#45;&gt;kv_send3_7_12</title>
<path fill="none" stroke="black" d="M13773.35,-3456.94C13772.52,-3448.89 13771.6,-3439.86 13770.71,-3431.24"/>
<polygon fill="black" stroke="black" points="13774.17,-3430.61 13769.66,-3421.02 13767.2,-3431.32 13774.17,-3430.61"/>
</g>
<!-- ring_stage3_8_12 -->
<g id="node2207" class="node">
<title>ring_stage3_8_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15248,-3420.55 15046,-3420.55 15046,-3367.55 15248,-3367.55 15248,-3420.55"/>
<text text-anchor="middle" x="15147" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="15147" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_4×V_4</text>
<text text-anchor="middle" x="15147" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_7_12&#45;&gt;ring_stage3_8_12 -->
<g id="edge3110" class="edge">
<title>ring_stage3_7_12&#45;&gt;ring_stage3_8_12</title>
<path fill="none" stroke="black" d="M13877.15,-3458.2C13880.13,-3457.73 13883.08,-3457.31 13886,-3456.92 14390.07,-3390.44 14527.78,-3486.56 15035.69,-3420.97"/>
<polygon fill="black" stroke="black" points="15036.38,-3424.41 15045.85,-3419.64 15035.48,-3417.47 15036.38,-3424.41"/>
</g>
<!-- kv_send3_7_13 -->
<g id="node2192" class="node">
<title>kv_send3_7_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13513" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13513" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="13513" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_7_13&#45;&gt;kv_send3_7_13 -->
<g id="edge3067" class="edge">
<title>ring_stage3_7_13&#45;&gt;kv_send3_7_13</title>
<path fill="none" stroke="black" d="M13523.58,-3367.2C13522.19,-3359.06 13520.63,-3349.92 13519.14,-3341.22"/>
<polygon fill="black" stroke="black" points="13522.57,-3340.55 13517.44,-3331.28 13515.67,-3341.73 13522.57,-3340.55"/>
</g>
<!-- ring_stage3_8_13 -->
<g id="node2208" class="node">
<title>ring_stage3_8_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13843,-3330.81 13641,-3330.81 13641,-3277.81 13843,-3277.81 13843,-3330.81"/>
<text text-anchor="middle" x="13742" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="13742" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_5×V_5</text>
<text text-anchor="middle" x="13742" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_7_13&#45;&gt;ring_stage3_8_13 -->
<g id="edge3113" class="edge">
<title>ring_stage3_7_13&#45;&gt;ring_stage3_8_13</title>
<path fill="none" stroke="black" d="M13590.47,-3367.44C13615.41,-3357.21 13644.29,-3345.37 13670.09,-3334.79"/>
<polygon fill="black" stroke="black" points="13671.52,-3337.99 13679.45,-3330.96 13668.87,-3331.51 13671.52,-3337.99"/>
</g>
<!-- kv_send3_7_14 -->
<g id="node2193" class="node">
<title>kv_send3_7_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13241" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13241" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="13241" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_7_14&#45;&gt;kv_send3_7_14 -->
<g id="edge3070" class="edge">
<title>ring_stage3_7_14&#45;&gt;kv_send3_7_14</title>
<path fill="none" stroke="black" d="M13255.11,-3277.46C13253.25,-3269.32 13251.17,-3260.18 13249.18,-3251.48"/>
<polygon fill="black" stroke="black" points="13252.55,-3250.51 13246.92,-3241.54 13245.73,-3252.07 13252.55,-3250.51"/>
</g>
<!-- ring_stage3_8_14 -->
<g id="node2209" class="node">
<title>ring_stage3_8_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13597,-3241.07 13395,-3241.07 13395,-3188.07 13597,-3188.07 13597,-3241.07"/>
<text text-anchor="middle" x="13496" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="13496" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_6×V_6</text>
<text text-anchor="middle" x="13496" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_7_14&#45;&gt;ring_stage3_8_14 -->
<g id="edge3116" class="edge">
<title>ring_stage3_7_14&#45;&gt;ring_stage3_8_14</title>
<path fill="none" stroke="black" d="M13329.6,-3277.7C13357.23,-3267.38 13389.25,-3255.43 13417.78,-3244.77"/>
<polygon fill="black" stroke="black" points="13419.17,-3247.99 13427.31,-3241.22 13416.72,-3241.44 13419.17,-3247.99"/>
</g>
<!-- kv_send3_7_15 -->
<g id="node2194" class="node">
<title>kv_send3_7_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12892" cy="-3124.83" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12892" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12892" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_7_15&#45;&gt;kv_send3_7_15 -->
<g id="edge3073" class="edge">
<title>ring_stage3_7_15&#45;&gt;kv_send3_7_15</title>
<path fill="none" stroke="black" d="M12976.26,-3187.96C12962.97,-3178.15 12947.67,-3166.87 12933.78,-3156.64"/>
<polygon fill="black" stroke="black" points="12935.48,-3153.54 12925.35,-3150.42 12931.32,-3159.17 12935.48,-3153.54"/>
</g>
<!-- ring_stage3_8_15 -->
<g id="node2210" class="node">
<title>ring_stage3_8_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13220,-3151.33 13018,-3151.33 13018,-3098.33 13220,-3098.33 13220,-3151.33"/>
<text text-anchor="middle" x="13119" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
<text text-anchor="middle" x="13119" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_7×V_7</text>
<text text-anchor="middle" x="13119" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_7_15&#45;&gt;ring_stage3_8_15 -->
<g id="edge3119" class="edge">
<title>ring_stage3_7_15&#45;&gt;ring_stage3_8_15</title>
<path fill="none" stroke="black" d="M13042.53,-3187.96C13054.07,-3178.58 13067.28,-3167.85 13079.44,-3157.97"/>
<polygon fill="black" stroke="black" points="13081.69,-3160.65 13087.25,-3151.63 13077.28,-3155.22 13081.69,-3160.65"/>
</g>
<!-- kv_send3_7_0&#45;&gt;ring_stage3_8_1 -->
<g id="edge3078" class="edge">
<title>kv_send3_7_0&#45;&gt;ring_stage3_8_1</title>
<path fill="none" stroke="black" d="M12173.84,-3012.29C12145.91,-3001.25 12111.61,-2987.7 12081.39,-2975.75"/>
<polygon fill="black" stroke="black" points="12082.32,-2972.35 12071.73,-2971.93 12079.75,-2978.86 12082.32,-2972.35"/>
</g>
<!-- kv_send3_7_1&#45;&gt;ring_stage3_8_2 -->
<g id="edge3081" class="edge">
<title>kv_send3_7_1&#45;&gt;ring_stage3_8_2</title>
<path fill="none" stroke="black" d="M12505.31,-2922.77C12534.36,-2911.65 12570.2,-2897.91 12601.7,-2885.85"/>
<polygon fill="black" stroke="black" points="12603.23,-2889.01 12611.32,-2882.16 12600.73,-2882.47 12603.23,-2889.01"/>
</g>
<!-- kv_send3_7_2&#45;&gt;ring_stage3_8_3 -->
<g id="edge3084" class="edge">
<title>kv_send3_7_2&#45;&gt;ring_stage3_8_3</title>
<path fill="none" stroke="black" d="M13173.16,-2832.81C13201.09,-2821.77 13235.39,-2808.22 13265.61,-2796.27"/>
<polygon fill="black" stroke="black" points="13267.25,-2799.38 13275.27,-2792.45 13264.68,-2792.87 13267.25,-2799.38"/>
</g>
<!-- kv_send3_7_3&#45;&gt;ring_stage3_8_4 -->
<g id="edge3087" class="edge">
<title>kv_send3_7_3&#45;&gt;ring_stage3_8_4</title>
<path fill="none" stroke="black" d="M13641.94,-2746.99C13654.6,-2744.16 13667.66,-2741.38 13680,-2739 13782.02,-2719.29 13810.62,-2729.83 13911,-2703 13933.3,-2697.04 13957,-2688.65 13978.2,-2680.36"/>
<polygon fill="black" stroke="black" points="13979.76,-2683.5 13987.76,-2676.56 13977.17,-2677 13979.76,-2683.5"/>
</g>
<!-- kv_send3_7_4&#45;&gt;ring_stage3_8_5 -->
<g id="edge3090" class="edge">
<title>kv_send3_7_4&#45;&gt;ring_stage3_8_5</title>
<path fill="none" stroke="black" d="M15686.3,-4084.65C15685.48,-4076.61 15684.55,-4067.63 15683.68,-4059.07"/>
<polygon fill="black" stroke="black" points="15687.14,-4058.52 15682.64,-4048.93 15680.18,-4059.24 15687.14,-4058.52"/>
</g>
<!-- kv_send3_7_5&#45;&gt;ring_stage3_8_6 -->
<g id="edge3093" class="edge">
<title>kv_send3_7_5&#45;&gt;ring_stage3_8_6</title>
<path fill="none" stroke="black" d="M15420.7,-3994.91C15420.61,-3986.87 15420.51,-3977.89 15420.41,-3969.33"/>
<polygon fill="black" stroke="black" points="15423.91,-3969.15 15420.29,-3959.19 15416.91,-3969.23 15423.91,-3969.15"/>
</g>
<!-- kv_send3_7_6&#45;&gt;ring_stage3_8_7 -->
<g id="edge3096" class="edge">
<title>kv_send3_7_6&#45;&gt;ring_stage3_8_7</title>
<path fill="none" stroke="black" d="M15192,-3905.17C15192,-3897.13 15192,-3888.15 15192,-3879.59"/>
<polygon fill="black" stroke="black" points="15195.5,-3879.45 15192,-3869.45 15188.5,-3879.45 15195.5,-3879.45"/>
</g>
<!-- kv_send3_7_7&#45;&gt;ring_stage3_8_8 -->
<g id="edge3099" class="edge">
<title>kv_send3_7_7&#45;&gt;ring_stage3_8_8</title>
<path fill="none" stroke="black" d="M14962.2,-3815.43C14961.65,-3807.39 14961.04,-3798.41 14960.45,-3789.85"/>
<polygon fill="black" stroke="black" points="14963.93,-3789.45 14959.76,-3779.71 14956.95,-3789.93 14963.93,-3789.45"/>
</g>
<!-- kv_send3_7_8&#45;&gt;ring_stage3_8_9 -->
<g id="edge3102" class="edge">
<title>kv_send3_7_8&#45;&gt;ring_stage3_8_9</title>
<path fill="none" stroke="black" d="M14410.01,-3733.7C14396.77,-3730.81 14383.02,-3728.13 14370,-3726.14 14165.27,-3694.87 14107.53,-3722.53 13899.58,-3690.28"/>
<polygon fill="black" stroke="black" points="13899.99,-3686.8 13889.57,-3688.7 13898.9,-3693.72 13899.99,-3686.8"/>
</g>
<!-- kv_send3_7_9&#45;&gt;ring_stage3_8_10 -->
<g id="edge3105" class="edge">
<title>kv_send3_7_9&#45;&gt;ring_stage3_8_10</title>
<path fill="none" stroke="black" d="M14095.6,-3644.5C14109.05,-3641.66 14122.91,-3638.85 14136,-3636.4 14234.53,-3618 14262.71,-3620.1 14364.67,-3600.6"/>
<polygon fill="black" stroke="black" points="14365.62,-3603.98 14374.77,-3598.64 14364.28,-3597.11 14365.62,-3603.98"/>
</g>
<!-- kv_send3_7_10&#45;&gt;ring_stage3_8_11 -->
<g id="edge3108" class="edge">
<title>kv_send3_7_10&#45;&gt;ring_stage3_8_11</title>
<path fill="none" stroke="black" d="M14984.06,-3550.16C15010.9,-3539.26 15043.54,-3526.01 15072.38,-3514.29"/>
<polygon fill="black" stroke="black" points="15074.06,-3517.38 15082.01,-3510.38 15071.43,-3510.9 15074.06,-3517.38"/>
</g>
<!-- kv_send3_7_11&#45;&gt;ring_stage3_8_12 -->
<g id="edge3111" class="edge">
<title>kv_send3_7_11&#45;&gt;ring_stage3_8_12</title>
<path fill="none" stroke="black" d="M15317.01,-3460.76C15288.45,-3449.72 15253.47,-3436.2 15222.69,-3424.3"/>
<polygon fill="black" stroke="black" points="15223.87,-3421.01 15213.28,-3420.67 15221.34,-3427.54 15223.87,-3421.01"/>
</g>
<!-- kv_send3_7_12&#45;&gt;ring_stage3_8_13 -->
<g id="edge3114" class="edge">
<title>kv_send3_7_12&#45;&gt;ring_stage3_8_13</title>
<path fill="none" stroke="black" d="M13759.63,-3367.2C13757.27,-3358.9 13754.61,-3349.56 13752.08,-3340.7"/>
<polygon fill="black" stroke="black" points="13755.42,-3339.63 13749.31,-3330.98 13748.69,-3341.55 13755.42,-3339.63"/>
</g>
<!-- kv_send3_7_13&#45;&gt;ring_stage3_8_14 -->
<g id="edge3117" class="edge">
<title>kv_send3_7_13&#45;&gt;ring_stage3_8_14</title>
<path fill="none" stroke="black" d="M13507.99,-3277.46C13506.4,-3269.25 13504.61,-3260.02 13502.91,-3251.24"/>
<polygon fill="black" stroke="black" points="13506.31,-3250.39 13500.97,-3241.24 13499.44,-3251.72 13506.31,-3250.39"/>
</g>
<!-- kv_send3_7_14&#45;&gt;ring_stage3_8_15 -->
<g id="edge3120" class="edge">
<title>kv_send3_7_14&#45;&gt;ring_stage3_8_15</title>
<path fill="none" stroke="black" d="M13206.69,-3188.9C13193.14,-3179.15 13177.4,-3167.83 13163.03,-3157.49"/>
<polygon fill="black" stroke="black" points="13164.91,-3154.54 13154.75,-3151.54 13160.83,-3160.22 13164.91,-3154.54"/>
</g>
<!-- kv_send3_7_15&#45;&gt;ring_stage3_8_0 -->
<g id="edge3075" class="edge">
<title>kv_send3_7_15&#45;&gt;ring_stage3_8_0</title>
<path fill="none" stroke="black" d="M12816.98,-3106.25C12803.69,-3103.34 12789.96,-3100.46 12777,-3097.96 12681.08,-3079.48 12653.54,-3081.76 12553.59,-3062.01"/>
<polygon fill="black" stroke="black" points="12554.18,-3058.56 12543.69,-3060.03 12552.81,-3065.42 12554.18,-3058.56"/>
</g>
<!-- kv_send3_8_0 -->
<g id="node2211" class="node">
<title>kv_send3_8_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12225" cy="-2945.35" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12225" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12225" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_8_0&#45;&gt;kv_send3_8_0 -->
<g id="edge3076" class="edge">
<title>ring_stage3_8_0&#45;&gt;kv_send3_8_0</title>
<path fill="none" stroke="black" d="M12382.19,-3008.48C12353.1,-2996.98 12318.86,-2983.45 12289.77,-2971.95"/>
<polygon fill="black" stroke="black" points="12290.71,-2968.56 12280.12,-2968.14 12288.13,-2975.07 12290.71,-2968.56"/>
</g>
<!-- ring_stage3_9_0 -->
<g id="node2227" class="node">
<title>ring_stage3_9_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12763.5,-2971.85 12570.5,-2971.85 12570.5,-2918.85 12763.5,-2918.85 12763.5,-2971.85"/>
<text text-anchor="middle" x="12667" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="12667" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_7×V_7</text>
<text text-anchor="middle" x="12667" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_8_0&#45;&gt;ring_stage3_9_0 -->
<g id="edge3122" class="edge">
<title>ring_stage3_8_0&#45;&gt;ring_stage3_9_0</title>
<path fill="none" stroke="black" d="M12511.22,-3008.48C12536.87,-2998.25 12566.55,-2986.41 12593.08,-2975.83"/>
<polygon fill="black" stroke="black" points="12594.7,-2978.95 12602.7,-2972 12592.11,-2972.45 12594.7,-2978.95"/>
</g>
<!-- kv_send3_8_1 -->
<g id="node2212" class="node">
<title>kv_send3_8_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12227" cy="-2855.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12227" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12227" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_8_1&#45;&gt;kv_send3_8_1 -->
<g id="edge3079" class="edge">
<title>ring_stage3_8_1&#45;&gt;kv_send3_8_1</title>
<path fill="none" stroke="black" d="M12071.22,-2918.74C12099.94,-2907.28 12133.72,-2893.81 12162.47,-2882.35"/>
<polygon fill="black" stroke="black" points="12164.02,-2885.5 12172.01,-2878.54 12161.43,-2878.99 12164.02,-2885.5"/>
</g>
<!-- ring_stage3_9_1 -->
<g id="node2228" class="node">
<title>ring_stage3_9_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12105.5,-2882.11 11912.5,-2882.11 11912.5,-2829.11 12105.5,-2829.11 12105.5,-2882.11"/>
<text text-anchor="middle" x="12009" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="12009" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_8×V_8</text>
<text text-anchor="middle" x="12009" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_8_1&#45;&gt;ring_stage3_9_1 -->
<g id="edge3125" class="edge">
<title>ring_stage3_8_1&#45;&gt;ring_stage3_9_1</title>
<path fill="none" stroke="black" d="M12007.59,-2918.5C12007.78,-2910.29 12007.99,-2901.06 12008.19,-2892.28"/>
<polygon fill="black" stroke="black" points="12011.69,-2892.35 12008.41,-2882.28 12004.69,-2892.19 12011.69,-2892.35"/>
</g>
<!-- kv_send3_8_2 -->
<g id="node2213" class="node">
<title>kv_send3_8_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12676" cy="-2765.87" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12676" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12676" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_8_2&#45;&gt;kv_send3_8_2 -->
<g id="edge3082" class="edge">
<title>ring_stage3_8_2&#45;&gt;kv_send3_8_2</title>
<path fill="none" stroke="black" d="M12677.41,-2828.76C12677.23,-2820.71 12677.02,-2811.68 12676.82,-2803.06"/>
<polygon fill="black" stroke="black" points="12680.32,-2802.76 12676.59,-2792.84 12673.32,-2802.92 12680.32,-2802.76"/>
</g>
<!-- ring_stage3_9_2 -->
<g id="node2229" class="node">
<title>ring_stage3_9_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12552.5,-2792.37 12359.5,-2792.37 12359.5,-2739.37 12552.5,-2739.37 12552.5,-2792.37"/>
<text text-anchor="middle" x="12456" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="12456" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_9×V_9</text>
<text text-anchor="middle" x="12456" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_8_2&#45;&gt;ring_stage3_9_2 -->
<g id="edge3128" class="edge">
<title>ring_stage3_8_2&#45;&gt;ring_stage3_9_2</title>
<path fill="none" stroke="black" d="M12613.19,-2829C12587.2,-2818.73 12557.1,-2806.83 12530.24,-2796.21"/>
<polygon fill="black" stroke="black" points="12531.48,-2792.94 12520.89,-2792.52 12528.9,-2799.45 12531.48,-2792.94"/>
</g>
<!-- kv_send3_8_3 -->
<g id="node2214" class="node">
<title>kv_send3_8_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13555" cy="-2650" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13555" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="13555" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_8_3&#45;&gt;kv_send3_8_3 -->
<g id="edge3085" class="edge">
<title>ring_stage3_8_3&#45;&gt;kv_send3_8_3</title>
<path fill="none" stroke="black" d="M13388.25,-2739.32C13422,-2721.44 13467.09,-2697.56 13501.87,-2679.14"/>
<polygon fill="black" stroke="black" points="13503.74,-2682.11 13510.94,-2674.34 13500.46,-2675.93 13503.74,-2682.11"/>
</g>
<!-- ring_stage3_9_3 -->
<g id="node2230" class="node">
<title>ring_stage3_9_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13202.5,-2676.5 12991.5,-2676.5 12991.5,-2623.5 13202.5,-2623.5 13202.5,-2676.5"/>
<text text-anchor="middle" x="13097" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="13097" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_10×V_10</text>
<text text-anchor="middle" x="13097" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_8_3&#45;&gt;ring_stage3_9_3 -->
<g id="edge3131" class="edge">
<title>ring_stage3_8_3&#45;&gt;ring_stage3_9_3</title>
<path fill="none" stroke="black" d="M13285.47,-2739.32C13248.55,-2722.01 13199.63,-2699.09 13160.88,-2680.94"/>
<polygon fill="black" stroke="black" points="13162.31,-2677.74 13151.77,-2676.67 13159.34,-2684.08 13162.31,-2677.74"/>
</g>
<!-- kv_send3_8_4 -->
<g id="node2215" class="node">
<title>kv_send3_8_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14048" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14048" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14048" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_8_4&#45;&gt;kv_send3_8_4 -->
<g id="edge3088" class="edge">
<title>ring_stage3_8_4&#45;&gt;kv_send3_8_4</title>
<path fill="none" stroke="black" d="M14046.37,-2623.32C14046.68,-2601.36 14047.14,-2569.5 14047.49,-2544.99"/>
<polygon fill="black" stroke="black" points="14050.99,-2545.04 14047.63,-2534.99 14043.99,-2544.94 14050.99,-2545.04"/>
</g>
<!-- ring_stage3_9_4 -->
<g id="node2231" class="node">
<title>ring_stage3_9_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13870.5,-2534.5 13659.5,-2534.5 13659.5,-2481.5 13870.5,-2481.5 13870.5,-2534.5"/>
<text text-anchor="middle" x="13765" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="13765" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_11×V_11</text>
<text text-anchor="middle" x="13765" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_8_4&#45;&gt;ring_stage3_9_4 -->
<g id="edge3134" class="edge">
<title>ring_stage3_8_4&#45;&gt;ring_stage3_9_4</title>
<path fill="none" stroke="black" d="M13994.79,-2623.48C13947.1,-2599.73 13875.98,-2564.29 13825.51,-2539.15"/>
<polygon fill="black" stroke="black" points="13826.85,-2535.9 13816.34,-2534.58 13823.73,-2542.17 13826.85,-2535.9"/>
</g>
<!-- kv_send3_8_5 -->
<g id="node2216" class="node">
<title>kv_send3_8_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15670" cy="-3932.49" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15670" y="-3936.29" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="15670" y="-3921.29" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_8_5&#45;&gt;kv_send3_8_5 -->
<g id="edge3091" class="edge">
<title>ring_stage3_8_5&#45;&gt;kv_send3_8_5</title>
<path fill="none" stroke="black" d="M15677.05,-3995.38C15676.13,-3987.24 15675.08,-3978.1 15674.09,-3969.4"/>
<polygon fill="black" stroke="black" points="15677.57,-3969 15672.96,-3959.46 15670.61,-3969.79 15677.57,-3969"/>
</g>
<!-- ring_stage3_9_5 -->
<g id="node2232" class="node">
<title>ring_stage3_9_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14375.5,-2392.5 14164.5,-2392.5 14164.5,-2339.5 14375.5,-2339.5 14375.5,-2392.5"/>
<text text-anchor="middle" x="14270" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="14270" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_12×V_12</text>
<text text-anchor="middle" x="14270" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_8_5&#45;&gt;ring_stage3_9_5 -->
<g id="edge3137" class="edge">
<title>ring_stage3_8_5&#45;&gt;ring_stage3_9_5</title>
<path fill="none" stroke="black" d="M15742.77,-3995.63C15758,-3986.44 15772.6,-3974.49 15782,-3959.36 15809.22,-3915.55 15792,-3895.33 15792,-3843.75 15792,-3843.75 15792,-3843.75 15792,-3752.01 15792,-3632.11 15829,-3604.69 15829,-3484.79 15829,-3484.79 15829,-3484.79 15829,-3123.83 15829,-3086.46 15785.45,-2480.35 15758,-2455 15701.94,-2403.23 14459.37,-2436.06 14385,-2419 14364.45,-2414.29 14343.09,-2405.77 14324.45,-2396.97"/>
<polygon fill="black" stroke="black" points="14325.77,-2393.72 14315.24,-2392.51 14322.71,-2400.02 14325.77,-2393.72"/>
</g>
<!-- kv_send3_8_6 -->
<g id="node2217" class="node">
<title>kv_send3_8_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15420" cy="-3842.75" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15420" y="-3846.55" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="15420" y="-3831.55" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_8_6&#45;&gt;kv_send3_8_6 -->
<g id="edge3094" class="edge">
<title>ring_stage3_8_6&#45;&gt;kv_send3_8_6</title>
<path fill="none" stroke="black" d="M15420,-3905.64C15420,-3897.59 15420,-3888.56 15420,-3879.94"/>
<polygon fill="black" stroke="black" points="15423.5,-3879.72 15420,-3869.72 15416.5,-3879.72 15423.5,-3879.72"/>
</g>
<!-- ring_stage3_9_6 -->
<g id="node2233" class="node">
<title>ring_stage3_9_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15752.5,-3869.25 15541.5,-3869.25 15541.5,-3816.25 15752.5,-3816.25 15752.5,-3869.25"/>
<text text-anchor="middle" x="15647" y="-3854.05" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="15647" y="-3839.05" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_13×V_13</text>
<text text-anchor="middle" x="15647" y="-3824.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_8_6&#45;&gt;ring_stage3_9_6 -->
<g id="edge3140" class="edge">
<title>ring_stage3_8_6&#45;&gt;ring_stage3_9_6</title>
<path fill="none" stroke="black" d="M15486.27,-3905.88C15512.84,-3895.61 15543.62,-3883.71 15571.08,-3873.09"/>
<polygon fill="black" stroke="black" points="15572.58,-3876.27 15580.65,-3869.4 15570.06,-3869.74 15572.58,-3876.27"/>
</g>
<!-- kv_send3_8_7 -->
<g id="node2218" class="node">
<title>kv_send3_8_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15176" cy="-3753.01" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15176" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="15176" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_8_7&#45;&gt;kv_send3_8_7 -->
<g id="edge3097" class="edge">
<title>ring_stage3_8_7&#45;&gt;kv_send3_8_7</title>
<path fill="none" stroke="black" d="M15187.29,-3815.9C15185.8,-3807.76 15184.14,-3798.62 15182.55,-3789.92"/>
<polygon fill="black" stroke="black" points="15185.97,-3789.19 15180.74,-3779.98 15179.09,-3790.45 15185.97,-3789.19"/>
</g>
<!-- ring_stage3_9_7 -->
<g id="node2234" class="node">
<title>ring_stage3_9_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15508.5,-3779.51 15297.5,-3779.51 15297.5,-3726.51 15508.5,-3726.51 15508.5,-3779.51"/>
<text text-anchor="middle" x="15403" y="-3764.31" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="15403" y="-3749.31" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_14×V_14</text>
<text text-anchor="middle" x="15403" y="-3734.31" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_8_7&#45;&gt;ring_stage3_9_7 -->
<g id="edge3143" class="edge">
<title>ring_stage3_8_7&#45;&gt;ring_stage3_9_7</title>
<path fill="none" stroke="black" d="M15253.6,-3816.14C15278.08,-3805.96 15306.41,-3794.18 15331.77,-3783.63"/>
<polygon fill="black" stroke="black" points="15333.44,-3786.73 15341.33,-3779.66 15330.75,-3780.26 15333.44,-3786.73"/>
</g>
<!-- kv_send3_8_8 -->
<g id="node2219" class="node">
<title>kv_send3_8_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14946" cy="-3663.27" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14946" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14946" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_8_8&#45;&gt;kv_send3_8_8 -->
<g id="edge3100" class="edge">
<title>ring_stage3_8_8&#45;&gt;kv_send3_8_8</title>
<path fill="none" stroke="black" d="M14954.46,-3726.16C14953.35,-3718.02 14952.1,-3708.88 14950.91,-3700.18"/>
<polygon fill="black" stroke="black" points="14954.37,-3699.67 14949.55,-3690.24 14947.44,-3700.62 14954.37,-3699.67"/>
</g>
<!-- ring_stage3_9_8 -->
<g id="node2235" class="node">
<title>ring_stage3_9_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15278.5,-3689.77 15067.5,-3689.77 15067.5,-3636.77 15278.5,-3636.77 15278.5,-3689.77"/>
<text text-anchor="middle" x="15173" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="15173" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_15×V_15</text>
<text text-anchor="middle" x="15173" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_8_8&#45;&gt;ring_stage3_9_8 -->
<g id="edge3146" class="edge">
<title>ring_stage3_8_8&#45;&gt;ring_stage3_9_8</title>
<path fill="none" stroke="black" d="M15020.76,-3726.4C15045.82,-3716.17 15074.83,-3704.33 15100.76,-3693.75"/>
<polygon fill="black" stroke="black" points="15102.22,-3696.94 15110.16,-3689.92 15099.58,-3690.45 15102.22,-3696.94"/>
</g>
<!-- kv_send3_8_9 -->
<g id="node2220" class="node">
<title>kv_send3_8_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13799" cy="-3573.53" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13799" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="13799" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_8_9&#45;&gt;kv_send3_8_9 -->
<g id="edge3103" class="edge">
<title>ring_stage3_8_9&#45;&gt;kv_send3_8_9</title>
<path fill="none" stroke="black" d="M13794.77,-3636.42C13795.32,-3628.37 13795.94,-3619.34 13796.53,-3610.72"/>
<polygon fill="black" stroke="black" points="13800.03,-3610.72 13797.22,-3600.5 13793.05,-3610.24 13800.03,-3610.72"/>
</g>
<!-- ring_stage3_9_9 -->
<g id="node2236" class="node">
<title>ring_stage3_9_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14356.5,-3600.03 14163.5,-3600.03 14163.5,-3547.03 14356.5,-3547.03 14356.5,-3600.03"/>
<text text-anchor="middle" x="14260" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="14260" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_0×V_0</text>
<text text-anchor="middle" x="14260" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_8_9&#45;&gt;ring_stage3_9_9 -->
<g id="edge3149" class="edge">
<title>ring_stage3_8_9&#45;&gt;ring_stage3_9_9</title>
<path fill="none" stroke="black" d="M13889.61,-3638.07C13892.43,-3637.49 13895.23,-3636.93 13898,-3636.4 14008.05,-3615.19 14039.95,-3621.82 14153.27,-3600.65"/>
<polygon fill="black" stroke="black" points="14154.22,-3604.03 14163.39,-3598.73 14152.91,-3597.16 14154.22,-3604.03"/>
</g>
<!-- kv_send3_8_10 -->
<g id="node2221" class="node">
<title>kv_send3_8_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14692" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14692" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14692" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_8_10&#45;&gt;kv_send3_8_10 -->
<g id="edge3106" class="edge">
<title>ring_stage3_8_10&#45;&gt;kv_send3_8_10</title>
<path fill="none" stroke="black" d="M14539.06,-3546.92C14566.91,-3535.6 14599.63,-3522.31 14627.63,-3510.94"/>
<polygon fill="black" stroke="black" points="14628.99,-3514.16 14636.94,-3507.16 14626.35,-3507.68 14628.99,-3514.16"/>
</g>
<!-- ring_stage3_9_10 -->
<g id="node2237" class="node">
<title>ring_stage3_9_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14335,-3510.29 14133,-3510.29 14133,-3457.29 14335,-3457.29 14335,-3510.29"/>
<text text-anchor="middle" x="14234" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="14234" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_1×V_1</text>
<text text-anchor="middle" x="14234" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_8_10&#45;&gt;ring_stage3_9_10 -->
<g id="edge3152" class="edge">
<title>ring_stage3_8_10&#45;&gt;ring_stage3_9_10</title>
<path fill="none" stroke="black" d="M14405.35,-3546.92C14376.78,-3536.56 14343.64,-3524.54 14314.17,-3513.86"/>
<polygon fill="black" stroke="black" points="14315.33,-3510.55 14304.73,-3510.44 14312.94,-3517.14 14315.33,-3510.55"/>
</g>
<!-- kv_send3_8_11 -->
<g id="node2222" class="node">
<title>kv_send3_8_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15600" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15600" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="15600" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_8_11&#45;&gt;kv_send3_8_11 -->
<g id="edge3109" class="edge">
<title>ring_stage3_8_11&#45;&gt;kv_send3_8_11</title>
<path fill="none" stroke="black" d="M15246.23,-3458.69C15249.19,-3458.08 15252.11,-3457.49 15255,-3456.92 15354.79,-3437.27 15381.04,-3439.73 15481,-3420.92 15490.92,-3419.05 15501.28,-3416.98 15511.57,-3414.85"/>
<polygon fill="black" stroke="black" points="15512.32,-3418.27 15521.39,-3412.79 15510.89,-3411.42 15512.32,-3418.27"/>
</g>
<!-- ring_stage3_9_11 -->
<g id="node2238" class="node">
<title>ring_stage3_9_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15028,-3420.55 14826,-3420.55 14826,-3367.55 15028,-3367.55 15028,-3420.55"/>
<text text-anchor="middle" x="14927" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="14927" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_2×V_2</text>
<text text-anchor="middle" x="14927" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_8_11&#45;&gt;ring_stage3_9_11 -->
<g id="edge3155" class="edge">
<title>ring_stage3_8_11&#45;&gt;ring_stage3_9_11</title>
<path fill="none" stroke="black" d="M15081.36,-3457.18C15055.95,-3446.95 15026.54,-3435.11 15000.25,-3424.53"/>
<polygon fill="black" stroke="black" points="15001.3,-3421.18 14990.72,-3420.7 14998.69,-3427.68 15001.3,-3421.18"/>
</g>
<!-- kv_send3_8_12 -->
<g id="node2223" class="node">
<title>kv_send3_8_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15154" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15154" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="15154" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_8_12&#45;&gt;kv_send3_8_12 -->
<g id="edge3112" class="edge">
<title>ring_stage3_8_12&#45;&gt;kv_send3_8_12</title>
<path fill="none" stroke="black" d="M15149.06,-3367.2C15149.7,-3359.15 15150.43,-3350.12 15151.11,-3341.5"/>
<polygon fill="black" stroke="black" points="15154.62,-3341.53 15151.93,-3331.28 15147.64,-3340.97 15154.62,-3341.53"/>
</g>
<!-- ring_stage3_9_12 -->
<g id="node2239" class="node">
<title>ring_stage3_9_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15721,-3330.81 15519,-3330.81 15519,-3277.81 15721,-3277.81 15721,-3330.81"/>
<text text-anchor="middle" x="15620" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="15620" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_3×V_3</text>
<text text-anchor="middle" x="15620" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_8_12&#45;&gt;ring_stage3_9_12 -->
<g id="edge3158" class="edge">
<title>ring_stage3_8_12&#45;&gt;ring_stage3_9_12</title>
<path fill="none" stroke="black" d="M15248.22,-3368.88C15251.18,-3368.3 15254.11,-3367.73 15257,-3367.18 15365.45,-3346.75 15396.63,-3351.88 15508.76,-3331.34"/>
<polygon fill="black" stroke="black" points="15509.59,-3334.75 15518.78,-3329.48 15508.31,-3327.86 15509.59,-3334.75"/>
</g>
<!-- kv_send3_8_13 -->
<g id="node2224" class="node">
<title>kv_send3_8_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13726" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13726" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="13726" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_8_13&#45;&gt;kv_send3_8_13 -->
<g id="edge3115" class="edge">
<title>ring_stage3_8_13&#45;&gt;kv_send3_8_13</title>
<path fill="none" stroke="black" d="M13737.29,-3277.46C13735.8,-3269.32 13734.14,-3260.18 13732.55,-3251.48"/>
<polygon fill="black" stroke="black" points="13735.97,-3250.75 13730.74,-3241.54 13729.09,-3252.01 13735.97,-3250.75"/>
</g>
<!-- ring_stage3_9_13 -->
<g id="node2240" class="node">
<title>ring_stage3_9_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15272,-3241.07 15070,-3241.07 15070,-3188.07 15272,-3188.07 15272,-3241.07"/>
<text text-anchor="middle" x="15171" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="15171" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_4×V_4</text>
<text text-anchor="middle" x="15171" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_8_13&#45;&gt;ring_stage3_9_13 -->
<g id="edge3161" class="edge">
<title>ring_stage3_8_13&#45;&gt;ring_stage3_9_13</title>
<path fill="none" stroke="black" d="M13843.15,-3278.72C13846.13,-3278.25 13849.08,-3277.82 13852,-3277.44 14364.71,-3209.91 14500.33,-3291.85 15015,-3241.44 15029.43,-3240.03 15044.54,-3238.1 15059.45,-3235.92"/>
<polygon fill="black" stroke="black" points="15060.35,-3239.32 15069.72,-3234.38 15059.31,-3232.4 15060.35,-3239.32"/>
</g>
<!-- kv_send3_8_14 -->
<g id="node2225" class="node">
<title>kv_send3_8_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13370" cy="-3124.83" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13370" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="13370" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_8_14&#45;&gt;kv_send3_8_14 -->
<g id="edge3118" class="edge">
<title>ring_stage3_8_14&#45;&gt;kv_send3_8_14</title>
<path fill="none" stroke="black" d="M13459.22,-3187.96C13445.01,-3178.06 13428.63,-3166.66 13413.82,-3156.35"/>
<polygon fill="black" stroke="black" points="13415.52,-3153.26 13405.31,-3150.42 13411.52,-3159.01 13415.52,-3153.26"/>
</g>
<!-- ring_stage3_9_14 -->
<g id="node2241" class="node">
<title>ring_stage3_9_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13700,-3151.33 13498,-3151.33 13498,-3098.33 13700,-3098.33 13700,-3151.33"/>
<text text-anchor="middle" x="13599" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="13599" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_5×V_5</text>
<text text-anchor="middle" x="13599" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_8_14&#45;&gt;ring_stage3_9_14 -->
<g id="edge3164" class="edge">
<title>ring_stage3_8_14&#45;&gt;ring_stage3_9_14</title>
<path fill="none" stroke="black" d="M13526.07,-3187.96C13536.97,-3178.67 13549.44,-3168.05 13560.94,-3158.25"/>
<polygon fill="black" stroke="black" points="13563.37,-3160.78 13568.72,-3151.63 13558.83,-3155.45 13563.37,-3160.78"/>
</g>
<!-- kv_send3_8_15 -->
<g id="node2226" class="node">
<title>kv_send3_8_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12665" cy="-3035.09" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12665" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12665" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_8_15&#45;&gt;kv_send3_8_15 -->
<g id="edge3121" class="edge">
<title>ring_stage3_8_15&#45;&gt;kv_send3_8_15</title>
<path fill="none" stroke="black" d="M13017.8,-3100.69C13013.14,-3099.74 13008.52,-3098.83 13004,-3097.96 12903.67,-3078.74 12877.27,-3081.47 12777,-3061.96 12767.84,-3060.18 12758.29,-3058.18 12748.8,-3056.12"/>
<polygon fill="black" stroke="black" points="12749.47,-3052.68 12738.95,-3053.94 12747.96,-3059.51 12749.47,-3052.68"/>
</g>
<!-- ring_stage3_9_15 -->
<g id="node2242" class="node">
<title>ring_stage3_9_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13442,-3061.59 13240,-3061.59 13240,-3008.59 13442,-3008.59 13442,-3061.59"/>
<text text-anchor="middle" x="13341" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
<text text-anchor="middle" x="13341" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_6×V_6</text>
<text text-anchor="middle" x="13341" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_8_15&#45;&gt;ring_stage3_9_15 -->
<g id="edge3167" class="edge">
<title>ring_stage3_8_15&#45;&gt;ring_stage3_9_15</title>
<path fill="none" stroke="black" d="M13183.81,-3098.22C13209.8,-3087.95 13239.9,-3076.05 13266.76,-3065.43"/>
<polygon fill="black" stroke="black" points="13268.1,-3068.67 13276.11,-3061.74 13265.52,-3062.16 13268.1,-3068.67"/>
</g>
<!-- kv_send3_8_0&#45;&gt;ring_stage3_9_1 -->
<g id="edge3126" class="edge">
<title>kv_send3_8_0&#45;&gt;ring_stage3_9_1</title>
<path fill="none" stroke="black" d="M12171.05,-2922.44C12143.88,-2911.4 12110.55,-2897.86 12081.2,-2885.94"/>
<polygon fill="black" stroke="black" points="12082.41,-2882.65 12071.83,-2882.13 12079.78,-2889.14 12082.41,-2882.65"/>
</g>
<!-- kv_send3_8_1&#45;&gt;ring_stage3_9_2 -->
<g id="edge3129" class="edge">
<title>kv_send3_8_1&#45;&gt;ring_stage3_9_2</title>
<path fill="none" stroke="black" d="M12283.31,-2833.03C12312.36,-2821.91 12348.2,-2808.17 12379.7,-2796.11"/>
<polygon fill="black" stroke="black" points="12381.23,-2799.27 12389.32,-2792.42 12378.73,-2792.73 12381.23,-2799.27"/>
</g>
<!-- kv_send3_8_2&#45;&gt;ring_stage3_9_3 -->
<g id="edge3132" class="edge">
<title>kv_send3_8_2&#45;&gt;ring_stage3_9_3</title>
<path fill="none" stroke="black" d="M12750.6,-2747.16C12763.07,-2744.34 12775.89,-2741.52 12788,-2739 12873.85,-2721.13 12898.33,-2729.26 12982,-2703 13000.78,-2697.11 13020.54,-2688.94 13038.29,-2680.83"/>
<polygon fill="black" stroke="black" points="13039.77,-2684 13047.36,-2676.61 13036.82,-2677.66 13039.77,-2684"/>
</g>
<!-- kv_send3_8_3&#45;&gt;ring_stage3_9_4 -->
<g id="edge3135" class="edge">
<title>kv_send3_8_3&#45;&gt;ring_stage3_9_4</title>
<path fill="none" stroke="black" d="M13591.58,-2624.61C13626.76,-2601.16 13680.08,-2565.61 13718.31,-2540.13"/>
<polygon fill="black" stroke="black" points="13720.33,-2542.98 13726.71,-2534.53 13716.45,-2537.16 13720.33,-2542.98"/>
</g>
<!-- kv_send3_8_4&#45;&gt;ring_stage3_9_5 -->
<g id="edge3138" class="edge">
<title>kv_send3_8_4&#45;&gt;ring_stage3_9_5</title>
<path fill="none" stroke="black" d="M14086.16,-2482.93C14123.35,-2459.48 14180.07,-2423.71 14220.67,-2398.11"/>
<polygon fill="black" stroke="black" points="14222.74,-2400.94 14229.33,-2392.65 14219.01,-2395.02 14222.74,-2400.94"/>
</g>
<!-- kv_send3_8_5&#45;&gt;ring_stage3_9_6 -->
<g id="edge3141" class="edge">
<title>kv_send3_8_5&#45;&gt;ring_stage3_9_6</title>
<path fill="none" stroke="black" d="M15663.22,-3905.64C15661.05,-3897.34 15658.6,-3888 15656.28,-3879.14"/>
<polygon fill="black" stroke="black" points="15659.65,-3878.2 15653.73,-3869.42 15652.88,-3879.98 15659.65,-3878.2"/>
</g>
<!-- kv_send3_8_6&#45;&gt;ring_stage3_9_7 -->
<g id="edge3144" class="edge">
<title>kv_send3_8_6&#45;&gt;ring_stage3_9_7</title>
<path fill="none" stroke="black" d="M15414.99,-3815.9C15413.4,-3807.69 15411.61,-3798.46 15409.91,-3789.68"/>
<polygon fill="black" stroke="black" points="15413.31,-3788.83 15407.97,-3779.68 15406.44,-3790.16 15413.31,-3788.83"/>
</g>
<!-- kv_send3_8_7&#45;&gt;ring_stage3_9_8 -->
<g id="edge3147" class="edge">
<title>kv_send3_8_7&#45;&gt;ring_stage3_9_8</title>
<path fill="none" stroke="black" d="M15175.1,-3725.69C15174.83,-3717.65 15174.52,-3708.67 15174.23,-3700.11"/>
<polygon fill="black" stroke="black" points="15177.72,-3699.85 15173.88,-3689.97 15170.72,-3700.09 15177.72,-3699.85"/>
</g>
<!-- kv_send3_8_8&#45;&gt;ring_stage3_9_9 -->
<g id="edge3150" class="edge">
<title>kv_send3_8_8&#45;&gt;ring_stage3_9_9</title>
<path fill="none" stroke="black" d="M14874.01,-3643.97C14860.77,-3641.08 14847.02,-3638.39 14834,-3636.4 14631.01,-3605.33 14573.79,-3632.37 14366.61,-3600.37"/>
<polygon fill="black" stroke="black" points="14367.05,-3596.9 14356.63,-3598.8 14365.97,-3603.81 14367.05,-3596.9"/>
</g>
<!-- kv_send3_8_9&#45;&gt;ring_stage3_9_10 -->
<g id="edge3153" class="edge">
<title>kv_send3_8_9&#45;&gt;ring_stage3_9_10</title>
<path fill="none" stroke="black" d="M13877.61,-3554.8C13890.74,-3551.98 13904.24,-3549.17 13917,-3546.66 14005.5,-3529.27 14030.8,-3529.33 14122.74,-3510.87"/>
<polygon fill="black" stroke="black" points="14123.65,-3514.26 14132.75,-3508.84 14122.26,-3507.4 14123.65,-3514.26"/>
</g>
<!-- kv_send3_8_10&#45;&gt;ring_stage3_9_11 -->
<g id="edge3156" class="edge">
<title>kv_send3_8_10&#45;&gt;ring_stage3_9_11</title>
<path fill="none" stroke="black" d="M14750.39,-3460.99C14780.21,-3449.86 14816.89,-3436.16 14849.09,-3424.14"/>
<polygon fill="black" stroke="black" points="14850.33,-3427.41 14858.48,-3420.63 14847.88,-3420.85 14850.33,-3427.41"/>
</g>
<!-- kv_send3_8_11&#45;&gt;ring_stage3_9_12 -->
<g id="edge3159" class="edge">
<title>kv_send3_8_11&#45;&gt;ring_stage3_9_12</title>
<path fill="none" stroke="black" d="M15605.89,-3367.2C15607.76,-3358.99 15609.87,-3349.76 15611.87,-3340.98"/>
<polygon fill="black" stroke="black" points="15615.34,-3341.5 15614.15,-3330.98 15608.51,-3339.95 15615.34,-3341.5"/>
</g>
<!-- kv_send3_8_12&#45;&gt;ring_stage3_9_13 -->
<g id="edge3162" class="edge">
<title>kv_send3_8_12&#45;&gt;ring_stage3_9_13</title>
<path fill="none" stroke="black" d="M15159.01,-3277.46C15160.6,-3269.25 15162.39,-3260.02 15164.09,-3251.24"/>
<polygon fill="black" stroke="black" points="15167.56,-3251.72 15166.03,-3241.24 15160.69,-3250.39 15167.56,-3251.72"/>
</g>
<!-- kv_send3_8_13&#45;&gt;ring_stage3_9_14 -->
<g id="edge3165" class="edge">
<title>kv_send3_8_13&#45;&gt;ring_stage3_9_14</title>
<path fill="none" stroke="black" d="M13690.62,-3189.13C13676.26,-3179.2 13659.48,-3167.62 13644.24,-3157.09"/>
<polygon fill="black" stroke="black" points="13646.17,-3154.17 13635.96,-3151.36 13642.2,-3159.93 13646.17,-3154.17"/>
</g>
<!-- kv_send3_8_14&#45;&gt;ring_stage3_9_15 -->
<g id="edge3168" class="edge">
<title>kv_send3_8_14&#45;&gt;ring_stage3_9_15</title>
<path fill="none" stroke="black" d="M13361.46,-3097.98C13358.71,-3089.68 13355.62,-3080.34 13352.7,-3071.48"/>
<polygon fill="black" stroke="black" points="13355.94,-3070.15 13349.48,-3061.76 13349.3,-3072.35 13355.94,-3070.15"/>
</g>
<!-- kv_send3_8_15&#45;&gt;ring_stage3_9_0 -->
<g id="edge3123" class="edge">
<title>kv_send3_8_15&#45;&gt;ring_stage3_9_0</title>
<path fill="none" stroke="black" d="M12665.6,-3007.77C12665.78,-2999.73 12665.99,-2990.75 12666.18,-2982.19"/>
<polygon fill="black" stroke="black" points="12669.69,-2982.13 12666.41,-2972.05 12662.69,-2981.97 12669.69,-2982.13"/>
</g>
<!-- kv_send3_9_0 -->
<g id="node2243" class="node">
<title>kv_send3_9_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12451" cy="-2855.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12451" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12451" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_9_0&#45;&gt;kv_send3_9_0 -->
<g id="edge3124" class="edge">
<title>ring_stage3_9_0&#45;&gt;kv_send3_9_0</title>
<path fill="none" stroke="black" d="M12603.94,-2918.74C12575.75,-2907.28 12542.58,-2893.81 12514.36,-2882.35"/>
<polygon fill="black" stroke="black" points="12515.57,-2879.06 12504.99,-2878.54 12512.94,-2885.55 12515.57,-2879.06"/>
</g>
<!-- ring_stage3_10_0 -->
<g id="node2259" class="node">
<title>ring_stage3_10_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12996.5,-2882.11 12803.5,-2882.11 12803.5,-2829.11 12996.5,-2829.11 12996.5,-2882.11"/>
<text text-anchor="middle" x="12900" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="12900" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_6×V_6</text>
<text text-anchor="middle" x="12900" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_9_0&#45;&gt;ring_stage3_10_0 -->
<g id="edge3170" class="edge">
<title>ring_stage3_9_0&#45;&gt;ring_stage3_10_0</title>
<path fill="none" stroke="black" d="M12735.02,-2918.74C12762.41,-2908.42 12794.16,-2896.47 12822.45,-2885.81"/>
<polygon fill="black" stroke="black" points="12823.77,-2889.06 12831.9,-2882.26 12821.3,-2882.5 12823.77,-2889.06"/>
</g>
<!-- kv_send3_9_1 -->
<g id="node2244" class="node">
<title>kv_send3_9_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12012" cy="-2765.87" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12012" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12012" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_9_1&#45;&gt;kv_send3_9_1 -->
<g id="edge3127" class="edge">
<title>ring_stage3_9_1&#45;&gt;kv_send3_9_1</title>
<path fill="none" stroke="black" d="M12009.88,-2828.76C12010.16,-2820.71 12010.47,-2811.68 12010.76,-2803.06"/>
<polygon fill="black" stroke="black" points="12014.27,-2802.95 12011.11,-2792.84 12007.27,-2802.71 12014.27,-2802.95"/>
</g>
<!-- ring_stage3_10_1 -->
<g id="node2260" class="node">
<title>ring_stage3_10_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12336.5,-2792.37 12143.5,-2792.37 12143.5,-2739.37 12336.5,-2739.37 12336.5,-2792.37"/>
<text text-anchor="middle" x="12240" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="12240" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_7×V_7</text>
<text text-anchor="middle" x="12240" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_9_1&#45;&gt;ring_stage3_10_1 -->
<g id="edge3173" class="edge">
<title>ring_stage3_9_1&#45;&gt;ring_stage3_10_1</title>
<path fill="none" stroke="black" d="M12076.44,-2829C12103.6,-2818.68 12135.07,-2806.73 12163.11,-2796.07"/>
<polygon fill="black" stroke="black" points="12164.37,-2799.34 12172.48,-2792.52 12161.89,-2792.79 12164.37,-2799.34"/>
</g>
<!-- kv_send3_9_2 -->
<g id="node2245" class="node">
<title>kv_send3_9_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12870" cy="-2650" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12870" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12870" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_9_2&#45;&gt;kv_send3_9_2 -->
<g id="edge3130" class="edge">
<title>ring_stage3_9_2&#45;&gt;kv_send3_9_2</title>
<path fill="none" stroke="black" d="M12552.51,-2741.49C12556.39,-2740.64 12560.23,-2739.8 12564,-2739 12649.78,-2720.78 12674.46,-2729.67 12758,-2703 12777.92,-2696.64 12798.91,-2687.58 12817.27,-2678.8"/>
<polygon fill="black" stroke="black" points="12818.88,-2681.91 12826.34,-2674.39 12815.82,-2675.62 12818.88,-2681.91"/>
</g>
<!-- ring_stage3_10_2 -->
<g id="node2261" class="node">
<title>ring_stage3_10_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12313.5,-2676.5 12120.5,-2676.5 12120.5,-2623.5 12313.5,-2623.5 12313.5,-2676.5"/>
<text text-anchor="middle" x="12217" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="12217" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_8×V_8</text>
<text text-anchor="middle" x="12217" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_9_2&#45;&gt;ring_stage3_10_2 -->
<g id="edge3176" class="edge">
<title>ring_stage3_9_2&#45;&gt;ring_stage3_10_2</title>
<path fill="none" stroke="black" d="M12400.23,-2739.24C12376.39,-2728.2 12348.28,-2715.08 12323,-2703 12308.3,-2695.97 12292.5,-2688.3 12277.71,-2681.05"/>
<polygon fill="black" stroke="black" points="12279.17,-2677.87 12268.65,-2676.61 12276.09,-2684.15 12279.17,-2677.87"/>
</g>
<!-- kv_send3_9_3 -->
<g id="node2246" class="node">
<title>kv_send3_9_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13306" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13306" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="13306" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_9_3&#45;&gt;kv_send3_9_3 -->
<g id="edge3133" class="edge">
<title>ring_stage3_9_3&#45;&gt;kv_send3_9_3</title>
<path fill="none" stroke="black" d="M13135.33,-2623.32C13170.79,-2599.57 13223.51,-2564.25 13260.96,-2539.17"/>
<polygon fill="black" stroke="black" points="13263.3,-2541.82 13269.66,-2533.34 13259.4,-2536 13263.3,-2541.82"/>
</g>
<!-- ring_stage3_10_3 -->
<g id="node2262" class="node">
<title>ring_stage3_10_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12960.5,-2534.5 12767.5,-2534.5 12767.5,-2481.5 12960.5,-2481.5 12960.5,-2534.5"/>
<text text-anchor="middle" x="12864" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="12864" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_9×V_9</text>
<text text-anchor="middle" x="12864" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_9_3&#45;&gt;ring_stage3_10_3 -->
<g id="edge3179" class="edge">
<title>ring_stage3_9_3&#45;&gt;ring_stage3_10_3</title>
<path fill="none" stroke="black" d="M13054.54,-2623.48C13015.32,-2599.92 12957,-2564.88 12915.22,-2539.77"/>
<polygon fill="black" stroke="black" points="12916.94,-2536.73 12906.57,-2534.58 12913.34,-2542.73 12916.94,-2536.73"/>
</g>
<!-- kv_send3_9_4 -->
<g id="node2247" class="node">
<title>kv_send3_9_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14043" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14043" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14043" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_9_4&#45;&gt;kv_send3_9_4 -->
<g id="edge3136" class="edge">
<title>ring_stage3_9_4&#45;&gt;kv_send3_9_4</title>
<path fill="none" stroke="black" d="M13815.67,-2481.48C13864.32,-2456.98 13937.63,-2420.07 13987.76,-2394.82"/>
<polygon fill="black" stroke="black" points="13989.48,-2397.87 13996.84,-2390.25 13986.33,-2391.62 13989.48,-2397.87"/>
</g>
<!-- ring_stage3_10_4 -->
<g id="node2263" class="node">
<title>ring_stage3_10_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13870.5,-2392.5 13659.5,-2392.5 13659.5,-2339.5 13870.5,-2339.5 13870.5,-2392.5"/>
<text text-anchor="middle" x="13765" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="13765" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_10×V_10</text>
<text text-anchor="middle" x="13765" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_9_4&#45;&gt;ring_stage3_10_4 -->
<g id="edge3182" class="edge">
<title>ring_stage3_9_4&#45;&gt;ring_stage3_10_4</title>
<path fill="none" stroke="black" d="M13765,-2481.32C13765,-2459.22 13765,-2427.1 13765,-2402.53"/>
<polygon fill="black" stroke="black" points="13768.5,-2402.52 13765,-2392.52 13761.5,-2402.52 13768.5,-2402.52"/>
</g>
<!-- kv_send3_9_5 -->
<g id="node2248" class="node">
<title>kv_send3_9_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14701" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14701" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14701" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_9_5&#45;&gt;kv_send3_9_5 -->
<g id="edge3139" class="edge">
<title>ring_stage3_9_5&#45;&gt;kv_send3_9_5</title>
<path fill="none" stroke="black" d="M14319.32,-2339.42C14339.28,-2329.95 14362.81,-2319.86 14385,-2313 14472.96,-2285.82 14501.17,-2304.62 14589,-2277 14608.94,-2270.73 14629.95,-2261.69 14648.31,-2252.9"/>
<polygon fill="black" stroke="black" points="14649.91,-2256.01 14657.37,-2248.48 14646.85,-2249.72 14649.91,-2256.01"/>
</g>
<!-- ring_stage3_10_5 -->
<g id="node2264" class="node">
<title>ring_stage3_10_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14355.5,-2250.5 14144.5,-2250.5 14144.5,-2197.5 14355.5,-2197.5 14355.5,-2250.5"/>
<text text-anchor="middle" x="14250" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14250" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_11×V_11</text>
<text text-anchor="middle" x="14250" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_9_5&#45;&gt;ring_stage3_10_5 -->
<g id="edge3185" class="edge">
<title>ring_stage3_9_5&#45;&gt;ring_stage3_10_5</title>
<path fill="none" stroke="black" d="M14266.33,-2339.32C14263.17,-2317.22 14258.59,-2285.1 14255.08,-2260.53"/>
<polygon fill="black" stroke="black" points="14258.52,-2259.92 14253.65,-2250.52 14251.59,-2260.91 14258.52,-2259.92"/>
</g>
<!-- kv_send3_9_6 -->
<g id="node2249" class="node">
<title>kv_send3_9_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15630" cy="-3753.01" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15630" y="-3756.81" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="15630" y="-3741.81" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_9_6&#45;&gt;kv_send3_9_6 -->
<g id="edge3142" class="edge">
<title>ring_stage3_9_6&#45;&gt;kv_send3_9_6</title>
<path fill="none" stroke="black" d="M15641.99,-3815.9C15640.41,-3807.76 15638.64,-3798.62 15636.96,-3789.92"/>
<polygon fill="black" stroke="black" points="15640.37,-3789.13 15635.03,-3779.98 15633.5,-3790.46 15640.37,-3789.13"/>
</g>
<!-- ring_stage3_10_6 -->
<g id="node2265" class="node">
<title>ring_stage3_10_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14864.5,-2108.5 14653.5,-2108.5 14653.5,-2055.5 14864.5,-2055.5 14864.5,-2108.5"/>
<text text-anchor="middle" x="14759" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14759" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_12×V_12</text>
<text text-anchor="middle" x="14759" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_9_6&#45;&gt;ring_stage3_10_6 -->
<g id="edge3188" class="edge">
<title>ring_stage3_9_6&#45;&gt;ring_stage3_10_6</title>
<path fill="none" stroke="black" d="M15704.54,-3815.98C15719.09,-3806.69 15733.1,-3794.74 15742,-3779.88 15768.51,-3735.64 15752,-3715.85 15752,-3664.27 15752,-3664.27 15752,-3664.27 15752,-3572.53 15752,-3333.99 15769,-3274.63 15769,-3036.09 15769,-3036.09 15769,-3036.09 15769,-2854.61 15769,-2765.77 15818.9,-2519.67 15758,-2455 15695.3,-2388.41 15409.78,-2486.44 15348,-2419 15316.18,-2384.26 15319.79,-2350.73 15348,-2313 15381.85,-2267.72 15436.15,-2322.28 15470,-2277 15484.1,-2258.13 15486.03,-2188.26 15470,-2171 15433.39,-2131.56 15040.22,-2143.01 14987,-2135 14947.2,-2129.01 14904.03,-2119.86 14866.07,-2110.9"/>
<polygon fill="black" stroke="black" points="14866.56,-2107.42 14856.03,-2108.5 14864.94,-2114.23 14866.56,-2107.42"/>
</g>
<!-- kv_send3_9_7 -->
<g id="node2250" class="node">
<title>kv_send3_9_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15400" cy="-3663.27" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15400" y="-3667.07" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="15400" y="-3652.07" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_9_7&#45;&gt;kv_send3_9_7 -->
<g id="edge3145" class="edge">
<title>ring_stage3_9_7&#45;&gt;kv_send3_9_7</title>
<path fill="none" stroke="black" d="M15402.12,-3726.16C15401.84,-3718.11 15401.53,-3709.08 15401.24,-3700.46"/>
<polygon fill="black" stroke="black" points="15404.73,-3700.11 15400.89,-3690.24 15397.73,-3700.35 15404.73,-3700.11"/>
</g>
<!-- ring_stage3_10_7 -->
<g id="node2266" class="node">
<title>ring_stage3_10_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15732.5,-3689.77 15521.5,-3689.77 15521.5,-3636.77 15732.5,-3636.77 15732.5,-3689.77"/>
<text text-anchor="middle" x="15627" y="-3674.57" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="15627" y="-3659.57" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_13×V_13</text>
<text text-anchor="middle" x="15627" y="-3644.57" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_9_7&#45;&gt;ring_stage3_10_7 -->
<g id="edge3191" class="edge">
<title>ring_stage3_9_7&#45;&gt;ring_stage3_10_7</title>
<path fill="none" stroke="black" d="M15468.39,-3726.4C15494.61,-3716.13 15524.98,-3704.23 15552.09,-3693.61"/>
<polygon fill="black" stroke="black" points="15553.49,-3696.82 15561.53,-3689.92 15550.94,-3690.31 15553.49,-3696.82"/>
</g>
<!-- kv_send3_9_8 -->
<g id="node2251" class="node">
<title>kv_send3_9_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14698" cy="-3573.53" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14698" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14698" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_9_8&#45;&gt;kv_send3_9_8 -->
<g id="edge3148" class="edge">
<title>ring_stage3_9_8&#45;&gt;kv_send3_9_8</title>
<path fill="none" stroke="black" d="M15067.47,-3638.2C15064.28,-3637.58 15061.12,-3636.98 15058,-3636.4 14948.48,-3616.16 14919.47,-3620.95 14810,-3600.4 14800.76,-3598.67 14791.12,-3596.69 14781.55,-3594.63"/>
<polygon fill="black" stroke="black" points="14782.14,-3591.17 14771.62,-3592.45 14780.64,-3598.01 14782.14,-3591.17"/>
</g>
<!-- ring_stage3_10_8 -->
<g id="node2267" class="node">
<title>ring_stage3_10_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15488.5,-3600.03 15277.5,-3600.03 15277.5,-3547.03 15488.5,-3547.03 15488.5,-3600.03"/>
<text text-anchor="middle" x="15383" y="-3584.83" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="15383" y="-3569.83" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_14×V_14</text>
<text text-anchor="middle" x="15383" y="-3554.83" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_9_8&#45;&gt;ring_stage3_10_8 -->
<g id="edge3194" class="edge">
<title>ring_stage3_9_8&#45;&gt;ring_stage3_10_8</title>
<path fill="none" stroke="black" d="M15234.31,-3636.66C15258.67,-3626.48 15286.86,-3614.7 15312.1,-3604.15"/>
<polygon fill="black" stroke="black" points="15313.74,-3607.26 15321.62,-3600.18 15311.04,-3600.8 15313.74,-3607.26"/>
</g>
<!-- kv_send3_9_9 -->
<g id="node2252" class="node">
<title>kv_send3_9_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14005" cy="-3483.79" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14005" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14005" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_9_9&#45;&gt;kv_send3_9_9 -->
<g id="edge3151" class="edge">
<title>ring_stage3_9_9&#45;&gt;kv_send3_9_9</title>
<path fill="none" stroke="black" d="M14185.56,-3546.92C14151.31,-3535.13 14110.84,-3521.21 14076.9,-3509.53"/>
<polygon fill="black" stroke="black" points="14077.65,-3506.09 14067.05,-3506.14 14075.37,-3512.71 14077.65,-3506.09"/>
</g>
<!-- ring_stage3_10_9 -->
<g id="node2268" class="node">
<title>ring_stage3_10_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14564.5,-3510.29 14353.5,-3510.29 14353.5,-3457.29 14564.5,-3457.29 14564.5,-3510.29"/>
<text text-anchor="middle" x="14459" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14459" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_15×V_15</text>
<text text-anchor="middle" x="14459" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_9_9&#45;&gt;ring_stage3_10_9 -->
<g id="edge3197" class="edge">
<title>ring_stage3_9_9&#45;&gt;ring_stage3_10_9</title>
<path fill="none" stroke="black" d="M14318.09,-3546.92C14341.08,-3536.78 14367.66,-3525.06 14391.5,-3514.55"/>
<polygon fill="black" stroke="black" points="14393.1,-3517.67 14400.83,-3510.44 14390.27,-3511.27 14393.1,-3517.67"/>
</g>
<!-- kv_send3_9_10 -->
<g id="node2253" class="node">
<title>kv_send3_9_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14469" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14469" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14469" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_9_10&#45;&gt;kv_send3_9_10 -->
<g id="edge3154" class="edge">
<title>ring_stage3_9_10&#45;&gt;kv_send3_9_10</title>
<path fill="none" stroke="black" d="M14302.6,-3457.18C14333.67,-3445.58 14370.28,-3431.91 14401.24,-3420.35"/>
<polygon fill="black" stroke="black" points="14402.51,-3423.61 14410.65,-3416.84 14400.06,-3417.05 14402.51,-3423.61"/>
</g>
<!-- ring_stage3_10_10 -->
<g id="node2269" class="node">
<title>ring_stage3_10_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14104,-3420.55 13902,-3420.55 13902,-3367.55 14104,-3367.55 14104,-3420.55"/>
<text text-anchor="middle" x="14003" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14003" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_0×V_0</text>
<text text-anchor="middle" x="14003" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_9_10&#45;&gt;ring_stage3_10_10 -->
<g id="edge3200" class="edge">
<title>ring_stage3_9_10&#45;&gt;ring_stage3_10_10</title>
<path fill="none" stroke="black" d="M14166.56,-3457.18C14139.4,-3446.86 14107.93,-3434.91 14079.89,-3424.25"/>
<polygon fill="black" stroke="black" points="14081.11,-3420.98 14070.52,-3420.7 14078.63,-3427.52 14081.11,-3420.98"/>
</g>
<!-- kv_send3_9_11 -->
<g id="node2254" class="node">
<title>kv_send3_9_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15391" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15391" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="15391" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_9_11&#45;&gt;kv_send3_9_11 -->
<g id="edge3157" class="edge">
<title>ring_stage3_9_11&#45;&gt;kv_send3_9_11</title>
<path fill="none" stroke="black" d="M15028.23,-3368.92C15031.18,-3368.32 15034.11,-3367.74 15037,-3367.18 15141.17,-3347.02 15168.68,-3350.55 15273,-3331.18 15282.67,-3329.39 15292.75,-3327.38 15302.77,-3325.3"/>
<polygon fill="black" stroke="black" points="15303.69,-3328.69 15312.75,-3323.21 15302.25,-3321.84 15303.69,-3328.69"/>
</g>
<!-- ring_stage3_10_11 -->
<g id="node2270" class="node">
<title>ring_stage3_10_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14776,-3330.81 14574,-3330.81 14574,-3277.81 14776,-3277.81 14776,-3330.81"/>
<text text-anchor="middle" x="14675" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14675" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_1×V_1</text>
<text text-anchor="middle" x="14675" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_9_11&#45;&gt;ring_stage3_10_11 -->
<g id="edge3203" class="edge">
<title>ring_stage3_9_11&#45;&gt;ring_stage3_10_11</title>
<path fill="none" stroke="black" d="M14853.43,-3367.44C14823.68,-3357.08 14789.17,-3345.06 14758.48,-3334.38"/>
<polygon fill="black" stroke="black" points="14759.25,-3330.94 14748.66,-3330.96 14756.95,-3337.55 14759.25,-3330.94"/>
</g>
<!-- kv_send3_9_12 -->
<g id="node2255" class="node">
<title>kv_send3_9_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15620" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15620" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="15620" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_9_12&#45;&gt;kv_send3_9_12 -->
<g id="edge3160" class="edge">
<title>ring_stage3_9_12&#45;&gt;kv_send3_9_12</title>
<path fill="none" stroke="black" d="M15620,-3277.46C15620,-3269.41 15620,-3260.38 15620,-3251.76"/>
<polygon fill="black" stroke="black" points="15623.5,-3251.54 15620,-3241.54 15616.5,-3251.54 15623.5,-3251.54"/>
</g>
<!-- ring_stage3_10_12 -->
<g id="node2271" class="node">
<title>ring_stage3_10_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15492,-3241.07 15290,-3241.07 15290,-3188.07 15492,-3188.07 15492,-3241.07"/>
<text text-anchor="middle" x="15391" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="15391" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_2×V_2</text>
<text text-anchor="middle" x="15391" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_9_12&#45;&gt;ring_stage3_10_12 -->
<g id="edge3206" class="edge">
<title>ring_stage3_9_12&#45;&gt;ring_stage3_10_12</title>
<path fill="none" stroke="black" d="M15553.15,-3277.7C15526.34,-3267.43 15495.29,-3255.53 15467.58,-3244.91"/>
<polygon fill="black" stroke="black" points="15468.53,-3241.53 15457.93,-3241.22 15466.02,-3248.06 15468.53,-3241.53"/>
</g>
<!-- kv_send3_9_13 -->
<g id="node2256" class="node">
<title>kv_send3_9_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14799" cy="-3124.83" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14799" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="14799" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_9_13&#45;&gt;kv_send3_9_13 -->
<g id="edge3163" class="edge">
<title>ring_stage3_9_13&#45;&gt;kv_send3_9_13</title>
<path fill="none" stroke="black" d="M15069.84,-3189.71C15012.32,-3176.14 14941.02,-3159.33 14886.01,-3146.35"/>
<polygon fill="black" stroke="black" points="14886.48,-3142.87 14875.94,-3143.98 14884.87,-3149.68 14886.48,-3142.87"/>
</g>
<!-- ring_stage3_10_13 -->
<g id="node2272" class="node">
<title>ring_stage3_10_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15369,-3151.33 15167,-3151.33 15167,-3098.33 15369,-3098.33 15369,-3151.33"/>
<text text-anchor="middle" x="15268" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="15268" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_3×V_3</text>
<text text-anchor="middle" x="15268" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_9_13&#45;&gt;ring_stage3_10_13 -->
<g id="edge3209" class="edge">
<title>ring_stage3_9_13&#45;&gt;ring_stage3_10_13</title>
<path fill="none" stroke="black" d="M15199.32,-3187.96C15209.49,-3178.76 15221.1,-3168.26 15231.84,-3158.54"/>
<polygon fill="black" stroke="black" points="15234.41,-3160.93 15239.48,-3151.63 15229.72,-3155.74 15234.41,-3160.93"/>
</g>
<!-- kv_send3_9_14 -->
<g id="node2257" class="node">
<title>kv_send3_9_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13570" cy="-3035.09" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13570" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="13570" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_9_14&#45;&gt;kv_send3_9_14 -->
<g id="edge3166" class="edge">
<title>ring_stage3_9_14&#45;&gt;kv_send3_9_14</title>
<path fill="none" stroke="black" d="M13590.46,-3097.98C13587.74,-3089.75 13584.68,-3080.5 13581.77,-3071.71"/>
<polygon fill="black" stroke="black" points="13585.04,-3070.46 13578.58,-3062.06 13578.4,-3072.65 13585.04,-3070.46"/>
</g>
<!-- ring_stage3_10_14 -->
<g id="node2273" class="node">
<title>ring_stage3_10_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14633,-3061.59 14431,-3061.59 14431,-3008.59 14633,-3008.59 14633,-3061.59"/>
<text text-anchor="middle" x="14532" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="14532" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_4×V_4</text>
<text text-anchor="middle" x="14532" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_9_14&#45;&gt;ring_stage3_10_14 -->
<g id="edge3212" class="edge">
<title>ring_stage3_9_14&#45;&gt;ring_stage3_10_14</title>
<path fill="none" stroke="black" d="M13700.16,-3099.31C13703.14,-3098.83 13706.09,-3098.37 13709,-3097.96 14019.78,-3053.94 14106,-3105.33 14420.51,-3062.05"/>
<polygon fill="black" stroke="black" points="14421.42,-3065.46 14430.84,-3060.61 14420.45,-3058.53 14421.42,-3065.46"/>
</g>
<!-- kv_send3_9_15 -->
<g id="node2258" class="node">
<title>kv_send3_9_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13118" cy="-2945.35" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13118" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13118" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_9_15&#45;&gt;kv_send3_9_15 -->
<g id="edge3169" class="edge">
<title>ring_stage3_9_15&#45;&gt;kv_send3_9_15</title>
<path fill="none" stroke="black" d="M13275.9,-3008.48C13246.55,-2996.93 13211.98,-2983.33 13182.68,-2971.8"/>
<polygon fill="black" stroke="black" points="13183.96,-2968.54 13173.37,-2968.14 13181.39,-2975.05 13183.96,-2968.54"/>
</g>
<!-- ring_stage3_10_15 -->
<g id="node2274" class="node">
<title>ring_stage3_10_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13671,-2971.85 13469,-2971.85 13469,-2918.85 13671,-2918.85 13671,-2971.85"/>
<text text-anchor="middle" x="13570" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
<text text-anchor="middle" x="13570" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_5×V_5</text>
<text text-anchor="middle" x="13570" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_9_15&#45;&gt;ring_stage3_10_15 -->
<g id="edge3215" class="edge">
<title>ring_stage3_9_15&#45;&gt;ring_stage3_10_15</title>
<path fill="none" stroke="black" d="M13407.85,-3008.48C13434.66,-2998.21 13465.71,-2986.31 13493.42,-2975.69"/>
<polygon fill="black" stroke="black" points="13494.98,-2978.84 13503.07,-2972 13492.47,-2972.31 13494.98,-2978.84"/>
</g>
<!-- kv_send3_9_0&#45;&gt;ring_stage3_10_1 -->
<g id="edge3174" class="edge">
<title>kv_send3_9_0&#45;&gt;ring_stage3_10_1</title>
<path fill="none" stroke="black" d="M12397.76,-2832.47C12371.43,-2821.52 12339.3,-2808.16 12310.92,-2796.36"/>
<polygon fill="black" stroke="black" points="12312.03,-2793.03 12301.46,-2792.42 12309.34,-2799.5 12312.03,-2793.03"/>
</g>
<!-- kv_send3_9_1&#45;&gt;ring_stage3_10_2 -->
<g id="edge3177" class="edge">
<title>kv_send3_9_1&#45;&gt;ring_stage3_10_2</title>
<path fill="none" stroke="black" d="M12054.48,-2741.28C12085.7,-2723.93 12128.39,-2700.22 12162.18,-2681.45"/>
<polygon fill="black" stroke="black" points="12163.97,-2684.46 12171.01,-2676.54 12160.57,-2678.34 12163.97,-2684.46"/>
</g>
<!-- kv_send3_9_2&#45;&gt;ring_stage3_10_3 -->
<g id="edge3180" class="edge">
<title>kv_send3_9_2&#45;&gt;ring_stage3_10_3</title>
<path fill="none" stroke="black" d="M12868.89,-2623C12867.95,-2601.09 12866.59,-2569.52 12865.55,-2545.15"/>
<polygon fill="black" stroke="black" points="12869.03,-2544.71 12865.11,-2534.87 12862.04,-2545.01 12869.03,-2544.71"/>
</g>
<!-- kv_send3_9_3&#45;&gt;ring_stage3_10_4 -->
<g id="edge3183" class="edge">
<title>kv_send3_9_3&#45;&gt;ring_stage3_10_4</title>
<path fill="none" stroke="black" d="M13349.76,-2483.6C13370.28,-2473.48 13395.38,-2462.31 13419,-2455 13509.88,-2426.87 13538.27,-2444.22 13630,-2419 13652.16,-2412.91 13675.72,-2404.53 13696.85,-2396.28"/>
<polygon fill="black" stroke="black" points="13698.37,-2399.44 13706.38,-2392.5 13695.79,-2392.93 13698.37,-2399.44"/>
</g>
<!-- kv_send3_9_4&#45;&gt;ring_stage3_10_5 -->
<g id="edge3186" class="edge">
<title>kv_send3_9_4&#45;&gt;ring_stage3_10_5</title>
<path fill="none" stroke="black" d="M14079.06,-2340.61C14113.59,-2317.26 14165.86,-2281.91 14203.5,-2256.45"/>
<polygon fill="black" stroke="black" points="14205.94,-2259.03 14212.26,-2250.53 14202.01,-2253.23 14205.94,-2259.03"/>
</g>
<!-- kv_send3_9_5&#45;&gt;ring_stage3_10_6 -->
<g id="edge3189" class="edge">
<title>kv_send3_9_5&#45;&gt;ring_stage3_10_6</title>
<path fill="none" stroke="black" d="M14711.77,-2197C14720.97,-2174.8 14734.28,-2142.67 14744.43,-2118.18"/>
<polygon fill="black" stroke="black" points="14747.69,-2119.44 14748.28,-2108.87 14741.22,-2116.76 14747.69,-2119.44"/>
</g>
<!-- kv_send3_9_6&#45;&gt;ring_stage3_10_7 -->
<g id="edge3192" class="edge">
<title>kv_send3_9_6&#45;&gt;ring_stage3_10_7</title>
<path fill="none" stroke="black" d="M15629.1,-3725.69C15628.83,-3717.65 15628.52,-3708.67 15628.23,-3700.11"/>
<polygon fill="black" stroke="black" points="15631.72,-3699.85 15627.88,-3689.97 15624.72,-3700.09 15631.72,-3699.85"/>
</g>
<!-- kv_send3_9_7&#45;&gt;ring_stage3_10_8 -->
<g id="edge3195" class="edge">
<title>kv_send3_9_7&#45;&gt;ring_stage3_10_8</title>
<path fill="none" stroke="black" d="M15394.99,-3636.42C15393.4,-3628.21 15391.61,-3618.98 15389.91,-3610.2"/>
<polygon fill="black" stroke="black" points="15393.31,-3609.35 15387.97,-3600.2 15386.44,-3610.68 15393.31,-3609.35"/>
</g>
<!-- kv_send3_9_8&#45;&gt;ring_stage3_10_9 -->
<g id="edge3198" class="edge">
<title>kv_send3_9_8&#45;&gt;ring_stage3_10_9</title>
<path fill="none" stroke="black" d="M14639.84,-3551.18C14609.28,-3539.96 14571.38,-3526.05 14538.18,-3513.86"/>
<polygon fill="black" stroke="black" points="14539.09,-3510.46 14528.5,-3510.3 14536.68,-3517.04 14539.09,-3510.46"/>
</g>
<!-- kv_send3_9_9&#45;&gt;ring_stage3_10_10 -->
<g id="edge3201" class="edge">
<title>kv_send3_9_9&#45;&gt;ring_stage3_10_10</title>
<path fill="none" stroke="black" d="M14004.4,-3456.47C14004.22,-3448.43 14004.01,-3439.45 14003.82,-3430.89"/>
<polygon fill="black" stroke="black" points="14007.31,-3430.67 14003.59,-3420.75 14000.31,-3430.83 14007.31,-3430.67"/>
</g>
<!-- kv_send3_9_10&#45;&gt;ring_stage3_10_11 -->
<g id="edge3204" class="edge">
<title>kv_send3_9_10&#45;&gt;ring_stage3_10_11</title>
<path fill="none" stroke="black" d="M14522.05,-3370.46C14547.43,-3359.65 14578.15,-3346.56 14605.38,-3334.96"/>
<polygon fill="black" stroke="black" points="14607.02,-3338.07 14614.85,-3330.93 14604.28,-3331.63 14607.02,-3338.07"/>
</g>
<!-- kv_send3_9_11&#45;&gt;ring_stage3_10_12 -->
<g id="edge3207" class="edge">
<title>kv_send3_9_11&#45;&gt;ring_stage3_10_12</title>
<path fill="none" stroke="black" d="M15391,-3276.99C15391,-3268.95 15391,-3259.97 15391,-3251.41"/>
<polygon fill="black" stroke="black" points="15394.5,-3251.27 15391,-3241.27 15387.5,-3251.27 15394.5,-3251.27"/>
</g>
<!-- kv_send3_9_12&#45;&gt;ring_stage3_10_13 -->
<g id="edge3210" class="edge">
<title>kv_send3_9_12&#45;&gt;ring_stage3_10_13</title>
<path fill="none" stroke="black" d="M15544.92,-3194.86C15496.64,-3182.82 15433.05,-3166.97 15378.99,-3153.5"/>
<polygon fill="black" stroke="black" points="15379.56,-3150.03 15369.01,-3151.01 15377.87,-3156.82 15379.56,-3150.03"/>
</g>
<!-- kv_send3_9_13&#45;&gt;ring_stage3_10_14 -->
<g id="edge3213" class="edge">
<title>kv_send3_9_13&#45;&gt;ring_stage3_10_14</title>
<path fill="none" stroke="black" d="M14735.39,-3102.93C14700.84,-3091.57 14657.59,-3077.36 14619.87,-3064.97"/>
<polygon fill="black" stroke="black" points="14620.5,-3061.49 14609.9,-3061.69 14618.31,-3068.14 14620.5,-3061.49"/>
</g>
<!-- kv_send3_9_14&#45;&gt;ring_stage3_10_15 -->
<g id="edge3216" class="edge">
<title>kv_send3_9_14&#45;&gt;ring_stage3_10_15</title>
<path fill="none" stroke="black" d="M13570,-3007.77C13570,-2999.73 13570,-2990.75 13570,-2982.19"/>
<polygon fill="black" stroke="black" points="13573.5,-2982.05 13570,-2972.05 13566.5,-2982.05 13573.5,-2982.05"/>
</g>
<!-- kv_send3_9_15&#45;&gt;ring_stage3_10_0 -->
<g id="edge3171" class="edge">
<title>kv_send3_9_15&#45;&gt;ring_stage3_10_0</title>
<path fill="none" stroke="black" d="M13063.55,-2922.44C13036.13,-2911.4 13002.49,-2897.86 12972.87,-2885.94"/>
<polygon fill="black" stroke="black" points="12973.99,-2882.62 12963.41,-2882.13 12971.38,-2889.11 12973.99,-2882.62"/>
</g>
<!-- kv_send3_10_0 -->
<g id="node2275" class="node">
<title>kv_send3_10_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12900" cy="-2765.87" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12900" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12900" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_10_0&#45;&gt;kv_send3_10_0 -->
<g id="edge3172" class="edge">
<title>ring_stage3_10_0&#45;&gt;kv_send3_10_0</title>
<path fill="none" stroke="black" d="M12900,-2828.76C12900,-2820.71 12900,-2811.68 12900,-2803.06"/>
<polygon fill="black" stroke="black" points="12903.5,-2802.84 12900,-2792.84 12896.5,-2802.84 12903.5,-2802.84"/>
</g>
<!-- ring_stage3_11_0 -->
<g id="node2291" class="node">
<title>ring_stage3_11_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13215.5,-2792.37 13022.5,-2792.37 13022.5,-2739.37 13215.5,-2739.37 13215.5,-2792.37"/>
<text text-anchor="middle" x="13119" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="13119" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_5×V_5</text>
<text text-anchor="middle" x="13119" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_10_0&#45;&gt;ring_stage3_11_0 -->
<g id="edge3218" class="edge">
<title>ring_stage3_10_0&#45;&gt;ring_stage3_11_0</title>
<path fill="none" stroke="black" d="M12963.93,-2829C12989.46,-2818.77 13019,-2806.93 13045.41,-2796.35"/>
<polygon fill="black" stroke="black" points="13047.01,-2799.48 13054.99,-2792.52 13044.4,-2792.99 13047.01,-2799.48"/>
</g>
<!-- kv_send3_10_1 -->
<g id="node2276" class="node">
<title>kv_send3_10_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="11999" cy="-2650" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="11999" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="11999" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_10_1&#45;&gt;kv_send3_10_1 -->
<g id="edge3175" class="edge">
<title>ring_stage3_10_1&#45;&gt;kv_send3_10_1</title>
<path fill="none" stroke="black" d="M12185.91,-2739.32C12147.37,-2721.1 12095.64,-2696.66 12056.38,-2678.11"/>
<polygon fill="black" stroke="black" points="12057.72,-2674.88 12047.19,-2673.77 12054.73,-2681.2 12057.72,-2674.88"/>
</g>
<!-- ring_stage3_11_1 -->
<g id="node2292" class="node">
<title>ring_stage3_11_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12524.5,-2676.5 12331.5,-2676.5 12331.5,-2623.5 12524.5,-2623.5 12524.5,-2676.5"/>
<text text-anchor="middle" x="12428" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="12428" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_6×V_6</text>
<text text-anchor="middle" x="12428" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_10_1&#45;&gt;ring_stage3_11_1 -->
<g id="edge3221" class="edge">
<title>ring_stage3_10_1&#45;&gt;ring_stage3_11_1</title>
<path fill="none" stroke="black" d="M12282.19,-2739.32C12310.27,-2722.31 12347.33,-2699.86 12377.05,-2681.86"/>
<polygon fill="black" stroke="black" points="12378.88,-2684.84 12385.63,-2676.67 12375.26,-2678.85 12378.88,-2684.84"/>
</g>
<!-- kv_send3_10_2 -->
<g id="node2277" class="node">
<title>kv_send3_10_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12435" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12435" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12435" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_10_2&#45;&gt;kv_send3_10_2 -->
<g id="edge3178" class="edge">
<title>ring_stage3_10_2&#45;&gt;kv_send3_10_2</title>
<path fill="none" stroke="black" d="M12256.73,-2623.48C12293.95,-2599.58 12349.57,-2563.86 12388.77,-2538.69"/>
<polygon fill="black" stroke="black" points="12390.84,-2541.52 12397.36,-2533.17 12387.06,-2535.63 12390.84,-2541.52"/>
</g>
<!-- ring_stage3_11_2 -->
<g id="node2293" class="node">
<title>ring_stage3_11_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12089.5,-2534.5 11896.5,-2534.5 11896.5,-2481.5 12089.5,-2481.5 12089.5,-2534.5"/>
<text text-anchor="middle" x="11993" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="11993" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_7×V_7</text>
<text text-anchor="middle" x="11993" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_10_2&#45;&gt;ring_stage3_11_2 -->
<g id="edge3224" class="edge">
<title>ring_stage3_10_2&#45;&gt;ring_stage3_11_2</title>
<path fill="none" stroke="black" d="M12176.18,-2623.48C12138.56,-2599.97 12082.64,-2565.03 12042.49,-2539.93"/>
<polygon fill="black" stroke="black" points="12044.26,-2536.91 12033.92,-2534.58 12040.55,-2542.84 12044.26,-2536.91"/>
</g>
<!-- kv_send3_10_3 -->
<g id="node2278" class="node">
<title>kv_send3_10_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13518" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13518" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="13518" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_10_3&#45;&gt;kv_send3_10_3 -->
<g id="edge3181" class="edge">
<title>ring_stage3_10_3&#45;&gt;kv_send3_10_3</title>
<path fill="none" stroke="black" d="M12906.9,-2481.4C12925.64,-2471.44 12948.26,-2461 12970,-2455 13157.43,-2403.28 13218.02,-2468.71 13406,-2419 13426.74,-2413.51 13448.39,-2404.37 13467.06,-2395.27"/>
<polygon fill="black" stroke="black" points="13468.87,-2398.27 13476.25,-2390.67 13465.74,-2392.01 13468.87,-2398.27"/>
</g>
<!-- ring_stage3_11_3 -->
<g id="node2294" class="node">
<title>ring_stage3_11_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12949.5,-2392.5 12756.5,-2392.5 12756.5,-2339.5 12949.5,-2339.5 12949.5,-2392.5"/>
<text text-anchor="middle" x="12853" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="12853" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_8×V_8</text>
<text text-anchor="middle" x="12853" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_10_3&#45;&gt;ring_stage3_11_3 -->
<g id="edge3227" class="edge">
<title>ring_stage3_10_3&#45;&gt;ring_stage3_11_3</title>
<path fill="none" stroke="black" d="M12861.98,-2481.32C12860.25,-2459.22 12857.72,-2427.1 12855.79,-2402.53"/>
<polygon fill="black" stroke="black" points="12859.28,-2402.21 12855,-2392.52 12852.3,-2402.76 12859.28,-2402.21"/>
</g>
<!-- kv_send3_10_4 -->
<g id="node2279" class="node">
<title>kv_send3_10_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14003" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14003" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14003" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_10_4&#45;&gt;kv_send3_10_4 -->
<g id="edge3184" class="edge">
<title>ring_stage3_10_4&#45;&gt;kv_send3_10_4</title>
<path fill="none" stroke="black" d="M13808.38,-2339.48C13849.31,-2315.41 13910.62,-2279.34 13953.46,-2254.14"/>
<polygon fill="black" stroke="black" points="13955.46,-2257.02 13962.31,-2248.94 13951.91,-2250.99 13955.46,-2257.02"/>
</g>
<!-- ring_stage3_11_4 -->
<g id="node2295" class="node">
<title>ring_stage3_11_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13614.5,-2250.5 13421.5,-2250.5 13421.5,-2197.5 13614.5,-2197.5 13614.5,-2250.5"/>
<text text-anchor="middle" x="13518" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="13518" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_9×V_9</text>
<text text-anchor="middle" x="13518" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_10_4&#45;&gt;ring_stage3_11_4 -->
<g id="edge3230" class="edge">
<title>ring_stage3_10_4&#45;&gt;ring_stage3_11_4</title>
<path fill="none" stroke="black" d="M13719.98,-2339.48C13678.33,-2315.87 13616.33,-2280.73 13572.02,-2255.62"/>
<polygon fill="black" stroke="black" points="13573.55,-2252.46 13563.12,-2250.58 13570.1,-2258.55 13573.55,-2252.46"/>
</g>
<!-- kv_send3_10_5 -->
<g id="node2280" class="node">
<title>kv_send3_10_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14258" cy="-2082" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14258" y="-2085.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14258" y="-2070.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_10_5&#45;&gt;kv_send3_10_5 -->
<g id="edge3187" class="edge">
<title>ring_stage3_10_5&#45;&gt;kv_send3_10_5</title>
<path fill="none" stroke="black" d="M14251.47,-2197.32C14252.72,-2175.36 14254.54,-2143.5 14255.94,-2118.99"/>
<polygon fill="black" stroke="black" points="14259.44,-2119.17 14256.51,-2108.99 14252.45,-2118.77 14259.44,-2119.17"/>
</g>
<!-- ring_stage3_11_5 -->
<g id="node2296" class="node">
<title>ring_stage3_11_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14112.5,-2108.5 13901.5,-2108.5 13901.5,-2055.5 14112.5,-2055.5 14112.5,-2108.5"/>
<text text-anchor="middle" x="14007" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14007" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_10×V_10</text>
<text text-anchor="middle" x="14007" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_10_5&#45;&gt;ring_stage3_11_5 -->
<g id="edge3233" class="edge">
<title>ring_stage3_10_5&#45;&gt;ring_stage3_11_5</title>
<path fill="none" stroke="black" d="M14205.71,-2197.48C14164.73,-2173.87 14103.74,-2138.73 14060.14,-2113.62"/>
<polygon fill="black" stroke="black" points="14061.81,-2110.54 14051.39,-2108.58 14058.31,-2116.6 14061.81,-2110.54"/>
</g>
<!-- kv_send3_10_6 -->
<g id="node2281" class="node">
<title>kv_send3_10_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15145" cy="-1940" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15145" y="-1943.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="15145" y="-1928.8" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_10_6&#45;&gt;kv_send3_10_6 -->
<g id="edge3190" class="edge">
<title>ring_stage3_10_6&#45;&gt;kv_send3_10_6</title>
<path fill="none" stroke="black" d="M14848.21,-2055.41C14902.26,-2039.15 14972.28,-2016.74 15033,-1993 15051.7,-1985.69 15071.71,-1976.76 15089.57,-1968.39"/>
<polygon fill="black" stroke="black" points="15091.15,-1971.51 15098.7,-1964.07 15088.16,-1965.18 15091.15,-1971.51"/>
</g>
<!-- ring_stage3_11_6 -->
<g id="node2297" class="node">
<title>ring_stage3_11_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14577.5,-1966.5 14366.5,-1966.5 14366.5,-1913.5 14577.5,-1913.5 14577.5,-1966.5"/>
<text text-anchor="middle" x="14472" y="-1951.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14472" y="-1936.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_11×V_11</text>
<text text-anchor="middle" x="14472" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_10_6&#45;&gt;ring_stage3_11_6 -->
<g id="edge3236" class="edge">
<title>ring_stage3_10_6&#45;&gt;ring_stage3_11_6</title>
<path fill="none" stroke="black" d="M14706.69,-2055.48C14657.89,-2031.68 14585.05,-1996.14 14533.48,-1970.99"/>
<polygon fill="black" stroke="black" points="14534.95,-1967.81 14524.43,-1966.58 14531.88,-1974.11 14534.95,-1967.81"/>
</g>
<!-- kv_send3_10_7 -->
<g id="node2282" class="node">
<title>kv_send3_10_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15610" cy="-3573.53" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15610" y="-3577.33" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="15610" y="-3562.33" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_10_7&#45;&gt;kv_send3_10_7 -->
<g id="edge3193" class="edge">
<title>ring_stage3_10_7&#45;&gt;kv_send3_10_7</title>
<path fill="none" stroke="black" d="M15621.99,-3636.42C15620.41,-3628.28 15618.64,-3619.14 15616.96,-3610.44"/>
<polygon fill="black" stroke="black" points="15620.37,-3609.65 15615.03,-3600.5 15613.5,-3610.98 15620.37,-3609.65"/>
</g>
<!-- ring_stage3_11_7 -->
<g id="node2298" class="node">
<title>ring_stage3_11_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15250.5,-1824.5 15039.5,-1824.5 15039.5,-1771.5 15250.5,-1771.5 15250.5,-1824.5"/>
<text text-anchor="middle" x="15145" y="-1809.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="15145" y="-1794.3" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_12×V_12</text>
<text text-anchor="middle" x="15145" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_10_7&#45;&gt;ring_stage3_11_7 -->
<g id="edge3239" class="edge">
<title>ring_stage3_10_7&#45;&gt;ring_stage3_11_7</title>
<path fill="none" stroke="black" d="M15680.69,-3636.51C15695.87,-3627 15711.18,-3614.92 15722,-3600.4 15803.67,-3490.74 15809,-3442.04 15809,-3305.31 15809,-3305.31 15809,-3305.31 15809,-3123.83 15809,-3004.73 15829,-2975.71 15829,-2856.61 15829,-2856.61 15829,-2856.61 15829,-2764.87 15829,-2626.27 15893.32,-2551.66 15794,-2455 15726.71,-2389.51 15436.5,-2488.17 15373,-2419 15341.14,-2384.3 15345.25,-2351.07 15373,-2313 15403.8,-2270.75 15454.2,-2319.25 15485,-2277 15512.75,-2238.93 15493.23,-2217.39 15485,-2171 15473.26,-2104.82 15472.13,-2083.64 15433,-2029 15374.48,-1947.29 15335.63,-1949.6 15257,-1887 15233.5,-1868.29 15207.08,-1847.52 15185.81,-1830.86"/>
<polygon fill="black" stroke="black" points="15187.96,-1828.1 15177.92,-1824.69 15183.64,-1833.61 15187.96,-1828.1"/>
</g>
<!-- kv_send3_10_8 -->
<g id="node2283" class="node">
<title>kv_send3_10_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14923" cy="-3483.79" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14923" y="-3487.59" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14923" y="-3472.59" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_10_8&#45;&gt;kv_send3_10_8 -->
<g id="edge3196" class="edge">
<title>ring_stage3_10_8&#45;&gt;kv_send3_10_8</title>
<path fill="none" stroke="black" d="M15277.47,-3548.5C15274.28,-3547.87 15271.12,-3547.25 15268,-3546.66 15165.05,-3527.15 15137.9,-3530.47 15035,-3510.66 15025.84,-3508.9 15016.28,-3506.91 15006.79,-3504.85"/>
<polygon fill="black" stroke="black" points="15007.46,-3501.42 14996.94,-3502.68 15005.95,-3508.25 15007.46,-3501.42"/>
</g>
<!-- ring_stage3_11_8 -->
<g id="node2299" class="node">
<title>ring_stage3_11_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15712.5,-3510.29 15501.5,-3510.29 15501.5,-3457.29 15712.5,-3457.29 15712.5,-3510.29"/>
<text text-anchor="middle" x="15607" y="-3495.09" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="15607" y="-3480.09" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_13×V_13</text>
<text text-anchor="middle" x="15607" y="-3465.09" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_10_8&#45;&gt;ring_stage3_11_8 -->
<g id="edge3242" class="edge">
<title>ring_stage3_10_8&#45;&gt;ring_stage3_11_8</title>
<path fill="none" stroke="black" d="M15448.39,-3546.92C15474.61,-3536.65 15504.98,-3524.75 15532.09,-3514.13"/>
<polygon fill="black" stroke="black" points="15533.49,-3517.34 15541.53,-3510.44 15530.94,-3510.83 15533.49,-3517.34"/>
</g>
<!-- kv_send3_10_9 -->
<g id="node2284" class="node">
<title>kv_send3_10_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14232" cy="-3394.05" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14232" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14232" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_10_9&#45;&gt;kv_send3_10_9 -->
<g id="edge3199" class="edge">
<title>ring_stage3_10_9&#45;&gt;kv_send3_10_9</title>
<path fill="none" stroke="black" d="M14392.73,-3457.18C14363.09,-3445.72 14328.22,-3432.24 14298.55,-3420.77"/>
<polygon fill="black" stroke="black" points="14299.7,-3417.47 14289.11,-3417.13 14297.18,-3424 14299.7,-3417.47"/>
</g>
<!-- ring_stage3_11_9 -->
<g id="node2300" class="node">
<title>ring_stage3_11_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14807.5,-3420.55 14596.5,-3420.55 14596.5,-3367.55 14807.5,-3367.55 14807.5,-3420.55"/>
<text text-anchor="middle" x="14702" y="-3405.35" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14702" y="-3390.35" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_14×V_14</text>
<text text-anchor="middle" x="14702" y="-3375.35" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_10_9&#45;&gt;ring_stage3_11_9 -->
<g id="edge3245" class="edge">
<title>ring_stage3_10_9&#45;&gt;ring_stage3_11_9</title>
<path fill="none" stroke="black" d="M14529.94,-3457.18C14558.63,-3446.82 14591.91,-3434.8 14621.5,-3424.12"/>
<polygon fill="black" stroke="black" points="14622.76,-3427.38 14630.97,-3420.7 14620.38,-3420.8 14622.76,-3427.38"/>
</g>
<!-- kv_send3_10_10 -->
<g id="node2285" class="node">
<title>kv_send3_10_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14209" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14209" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14209" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_10_10&#45;&gt;kv_send3_10_10 -->
<g id="edge3202" class="edge">
<title>ring_stage3_10_10&#45;&gt;kv_send3_10_10</title>
<path fill="none" stroke="black" d="M14063.14,-3367.44C14089.26,-3356.31 14119.86,-3343.28 14146.27,-3332.03"/>
<polygon fill="black" stroke="black" points="14147.97,-3335.11 14155.8,-3327.97 14145.23,-3328.67 14147.97,-3335.11"/>
</g>
<!-- ring_stage3_11_10 -->
<g id="node2301" class="node">
<title>ring_stage3_11_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14081,-3330.81 13861,-3330.81 13861,-3277.81 14081,-3277.81 14081,-3330.81"/>
<text text-anchor="middle" x="13971" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="13971" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_15×V_15</text>
<text text-anchor="middle" x="13971" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_10_10&#45;&gt;ring_stage3_11_10 -->
<g id="edge3248" class="edge">
<title>ring_stage3_10_10&#45;&gt;ring_stage3_11_10</title>
<path fill="none" stroke="black" d="M13993.57,-3367.2C13990.51,-3358.81 13987.06,-3349.36 13983.8,-3340.41"/>
<polygon fill="black" stroke="black" points="13987.08,-3339.17 13980.36,-3330.98 13980.5,-3341.57 13987.08,-3339.17"/>
</g>
<!-- kv_send3_10_11 -->
<g id="node2286" class="node">
<title>kv_send3_10_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14896" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14896" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="14896" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_10_11&#45;&gt;kv_send3_10_11 -->
<g id="edge3205" class="edge">
<title>ring_stage3_10_11&#45;&gt;kv_send3_10_11</title>
<path fill="none" stroke="black" d="M14739.52,-3277.7C14768.13,-3266.34 14801.76,-3252.99 14830.49,-3241.58"/>
<polygon fill="black" stroke="black" points="14832.03,-3244.73 14840.03,-3237.79 14829.44,-3238.23 14832.03,-3244.73"/>
</g>
<!-- ring_stage3_11_11 -->
<g id="node2302" class="node">
<title>ring_stage3_11_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14531,-3241.07 14329,-3241.07 14329,-3188.07 14531,-3188.07 14531,-3241.07"/>
<text text-anchor="middle" x="14430" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14430" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_0×V_0</text>
<text text-anchor="middle" x="14430" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_10_11&#45;&gt;ring_stage3_11_11 -->
<g id="edge3251" class="edge">
<title>ring_stage3_10_11&#45;&gt;ring_stage3_11_11</title>
<path fill="none" stroke="black" d="M14603.48,-3277.7C14574.55,-3267.34 14541,-3255.32 14511.16,-3244.64"/>
<polygon fill="black" stroke="black" points="14512.21,-3241.29 14501.61,-3241.22 14509.85,-3247.88 14512.21,-3241.29"/>
</g>
<!-- kv_send3_10_12 -->
<g id="node2287" class="node">
<title>kv_send3_10_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15497" cy="-3124.83" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15497" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="15497" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_10_12&#45;&gt;kv_send3_10_12 -->
<g id="edge3208" class="edge">
<title>ring_stage3_10_12&#45;&gt;kv_send3_10_12</title>
<path fill="none" stroke="black" d="M15421.94,-3187.96C15433.57,-3178.33 15446.93,-3167.28 15459.12,-3157.19"/>
<polygon fill="black" stroke="black" points="15461.46,-3159.79 15466.93,-3150.72 15457,-3154.4 15461.46,-3159.79"/>
</g>
<!-- ring_stage3_11_12 -->
<g id="node2303" class="node">
<title>ring_stage3_11_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15129,-3151.33 14927,-3151.33 14927,-3098.33 15129,-3098.33 15129,-3151.33"/>
<text text-anchor="middle" x="15028" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="15028" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_1×V_1</text>
<text text-anchor="middle" x="15028" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_10_12&#45;&gt;ring_stage3_11_12 -->
<g id="edge3254" class="edge">
<title>ring_stage3_10_12&#45;&gt;ring_stage3_11_12</title>
<path fill="none" stroke="black" d="M15289.88,-3189.13C15242.98,-3177.79 15187.09,-3164.29 15139.02,-3152.67"/>
<polygon fill="black" stroke="black" points="15139.74,-3149.24 15129.2,-3150.29 15138.1,-3156.04 15139.74,-3149.24"/>
</g>
<!-- kv_send3_10_13 -->
<g id="node2288" class="node">
<title>kv_send3_10_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15001" cy="-3035.09" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15001" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="15001" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_10_13&#45;&gt;kv_send3_10_13 -->
<g id="edge3211" class="edge">
<title>ring_stage3_10_13&#45;&gt;kv_send3_10_13</title>
<path fill="none" stroke="black" d="M15190.05,-3098.22C15153.61,-3086.24 15110.45,-3072.06 15074.58,-3060.27"/>
<polygon fill="black" stroke="black" points="15075.26,-3056.81 15064.66,-3057.01 15073.07,-3063.46 15075.26,-3056.81"/>
</g>
<!-- ring_stage3_11_13 -->
<g id="node2304" class="node">
<title>ring_stage3_11_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15593,-3061.59 15391,-3061.59 15391,-3008.59 15593,-3008.59 15593,-3061.59"/>
<text text-anchor="middle" x="15492" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="15492" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_2×V_2</text>
<text text-anchor="middle" x="15492" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_10_13&#45;&gt;ring_stage3_11_13 -->
<g id="edge3257" class="edge">
<title>ring_stage3_10_13&#45;&gt;ring_stage3_11_13</title>
<path fill="none" stroke="black" d="M15333.39,-3098.22C15359.61,-3087.95 15389.98,-3076.05 15417.09,-3065.43"/>
<polygon fill="black" stroke="black" points="15418.49,-3068.64 15426.53,-3061.74 15415.94,-3062.12 15418.49,-3068.64"/>
</g>
<!-- kv_send3_10_14 -->
<g id="node2289" class="node">
<title>kv_send3_10_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14304" cy="-2945.35" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14304" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="14304" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_10_14&#45;&gt;kv_send3_10_14 -->
<g id="edge3214" class="edge">
<title>ring_stage3_10_14&#45;&gt;kv_send3_10_14</title>
<path fill="none" stroke="black" d="M14465.44,-3008.48C14435.67,-2997.02 14400.65,-2983.54 14370.84,-2972.07"/>
<polygon fill="black" stroke="black" points="14371.95,-2968.75 14361.36,-2968.43 14369.44,-2975.28 14371.95,-2968.75"/>
</g>
<!-- ring_stage3_11_14 -->
<g id="node2305" class="node">
<title>ring_stage3_11_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14900,-2971.85 14698,-2971.85 14698,-2918.85 14900,-2918.85 14900,-2971.85"/>
<text text-anchor="middle" x="14799" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14799" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_3×V_3</text>
<text text-anchor="middle" x="14799" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_10_14&#45;&gt;ring_stage3_11_14 -->
<g id="edge3260" class="edge">
<title>ring_stage3_10_14&#45;&gt;ring_stage3_11_14</title>
<path fill="none" stroke="black" d="M14609.95,-3008.48C14641.75,-2998.03 14678.67,-2985.89 14711.4,-2975.14"/>
<polygon fill="black" stroke="black" points="14712.55,-2978.44 14720.96,-2972 14710.37,-2971.79 14712.55,-2978.44"/>
</g>
<!-- kv_send3_10_15 -->
<g id="node2290" class="node">
<title>kv_send3_10_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13342" cy="-2855.61" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13342" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13342" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_10_15&#45;&gt;kv_send3_10_15 -->
<g id="edge3217" class="edge">
<title>ring_stage3_10_15&#45;&gt;kv_send3_10_15</title>
<path fill="none" stroke="black" d="M13503.44,-2918.74C13473.31,-2907.14 13437.81,-2893.48 13407.78,-2881.92"/>
<polygon fill="black" stroke="black" points="13408.82,-2878.58 13398.23,-2878.25 13406.31,-2885.11 13408.82,-2878.58"/>
</g>
<!-- ring_stage3_11_15 -->
<g id="node2306" class="node">
<title>ring_stage3_11_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14371,-2882.11 14169,-2882.11 14169,-2829.11 14371,-2829.11 14371,-2882.11"/>
<text text-anchor="middle" x="14270" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
<text text-anchor="middle" x="14270" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_4×V_4</text>
<text text-anchor="middle" x="14270" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_10_15&#45;&gt;ring_stage3_11_15 -->
<g id="edge3263" class="edge">
<title>ring_stage3_10_15&#45;&gt;ring_stage3_11_15</title>
<path fill="none" stroke="black" d="M13671.21,-2921.2C13676.88,-2920.21 13682.5,-2919.29 13688,-2918.48 13892.9,-2888.36 13950.3,-2913.84 14158.78,-2882.56"/>
<polygon fill="black" stroke="black" points="14159.46,-2886 14168.82,-2881.03 14158.41,-2879.08 14159.46,-2886"/>
</g>
<!-- kv_send3_10_0&#45;&gt;ring_stage3_11_1 -->
<g id="edge3222" class="edge">
<title>kv_send3_10_0&#45;&gt;ring_stage3_11_1</title>
<path fill="none" stroke="black" d="M12826.39,-2746.92C12813.63,-2744.08 12800.46,-2741.32 12788,-2739 12675.91,-2718.15 12642.98,-2736.52 12534,-2703 12516.15,-2697.51 12497.57,-2689.34 12481.05,-2681.09"/>
<polygon fill="black" stroke="black" points="12482.6,-2677.95 12472.1,-2676.52 12479.42,-2684.18 12482.6,-2677.95"/>
</g>
<!-- kv_send3_10_1&#45;&gt;ring_stage3_11_2 -->
<g id="edge3225" class="edge">
<title>kv_send3_10_1&#45;&gt;ring_stage3_11_2</title>
<path fill="none" stroke="black" d="M11997.89,-2623C11996.95,-2601.09 11995.59,-2569.52 11994.55,-2545.15"/>
<polygon fill="black" stroke="black" points="11998.03,-2544.71 11994.11,-2534.87 11991.04,-2545.01 11998.03,-2544.71"/>
</g>
<!-- kv_send3_10_2&#45;&gt;ring_stage3_11_3 -->
<g id="edge3228" class="edge">
<title>kv_send3_10_2&#45;&gt;ring_stage3_11_3</title>
<path fill="none" stroke="black" d="M12479.06,-2483.58C12499.54,-2473.52 12524.52,-2462.4 12548,-2455 12633.73,-2428 12661.61,-2447.06 12747,-2419 12764.34,-2413.3 12782.43,-2405.28 12798.67,-2397.24"/>
<polygon fill="black" stroke="black" points="12800.65,-2400.16 12807.99,-2392.52 12797.49,-2393.91 12800.65,-2400.16"/>
</g>
<!-- kv_send3_10_3&#45;&gt;ring_stage3_11_4 -->
<g id="edge3231" class="edge">
<title>kv_send3_10_3&#45;&gt;ring_stage3_11_4</title>
<path fill="none" stroke="black" d="M13518,-2339C13518,-2317.09 13518,-2285.52 13518,-2261.15"/>
<polygon fill="black" stroke="black" points="13521.5,-2260.87 13518,-2250.87 13514.5,-2260.87 13521.5,-2260.87"/>
</g>
<!-- kv_send3_10_4&#45;&gt;ring_stage3_11_5 -->
<g id="edge3234" class="edge">
<title>kv_send3_10_4&#45;&gt;ring_stage3_11_5</title>
<path fill="none" stroke="black" d="M14003.74,-2197C14004.37,-2175.09 14005.27,-2143.52 14005.97,-2119.15"/>
<polygon fill="black" stroke="black" points="14009.47,-2118.96 14006.26,-2108.87 14002.48,-2118.76 14009.47,-2118.96"/>
</g>
<!-- kv_send3_10_5&#45;&gt;ring_stage3_11_6 -->
<g id="edge3237" class="edge">
<title>kv_send3_10_5&#45;&gt;ring_stage3_11_6</title>
<path fill="none" stroke="black" d="M14295.28,-2056.61C14331.12,-2033.16 14385.47,-1997.61 14424.42,-1972.13"/>
<polygon fill="black" stroke="black" points="14426.53,-1974.93 14432.98,-1966.53 14422.7,-1969.07 14426.53,-1974.93"/>
</g>
<!-- kv_send3_10_6&#45;&gt;ring_stage3_11_7 -->
<g id="edge3240" class="edge">
<title>kv_send3_10_6&#45;&gt;ring_stage3_11_7</title>
<path fill="none" stroke="black" d="M15145,-1913C15145,-1891.09 15145,-1859.52 15145,-1835.15"/>
<polygon fill="black" stroke="black" points="15148.5,-1834.87 15145,-1824.87 15141.5,-1834.87 15148.5,-1834.87"/>
</g>
<!-- kv_send3_10_7&#45;&gt;ring_stage3_11_8 -->
<g id="edge3243" class="edge">
<title>kv_send3_10_7&#45;&gt;ring_stage3_11_8</title>
<path fill="none" stroke="black" d="M15609.1,-3546.21C15608.83,-3538.17 15608.52,-3529.19 15608.23,-3520.63"/>
<polygon fill="black" stroke="black" points="15611.72,-3520.37 15607.88,-3510.49 15604.72,-3520.61 15611.72,-3520.37"/>
</g>
<!-- kv_send3_10_8&#45;&gt;ring_stage3_11_9 -->
<g id="edge3246" class="edge">
<title>kv_send3_10_8&#45;&gt;ring_stage3_11_9</title>
<path fill="none" stroke="black" d="M14868.09,-3460.99C14840.29,-3449.95 14806.14,-3436.4 14776.05,-3424.45"/>
<polygon fill="black" stroke="black" points="14777.03,-3421.07 14766.44,-3420.63 14774.44,-3427.58 14777.03,-3421.07"/>
</g>
<!-- kv_send3_10_9&#45;&gt;ring_stage3_11_10 -->
<g id="edge3249" class="edge">
<title>kv_send3_10_9&#45;&gt;ring_stage3_11_10</title>
<path fill="none" stroke="black" d="M14169.15,-3371.92C14135.5,-3360.61 14093.56,-3346.51 14056.94,-3334.2"/>
<polygon fill="black" stroke="black" points="14057.86,-3330.82 14047.26,-3330.95 14055.63,-3337.45 14057.86,-3330.82"/>
</g>
<!-- kv_send3_10_10&#45;&gt;ring_stage3_11_11 -->
<g id="edge3252" class="edge">
<title>kv_send3_10_10&#45;&gt;ring_stage3_11_11</title>
<path fill="none" stroke="black" d="M14264.77,-3281.17C14292.46,-3270.18 14326.29,-3256.75 14356.1,-3244.91"/>
<polygon fill="black" stroke="black" points="14357.63,-3248.07 14365.63,-3241.13 14355.05,-3241.56 14357.63,-3248.07"/>
</g>
<!-- kv_send3_10_11&#45;&gt;ring_stage3_11_12 -->
<g id="edge3255" class="edge">
<title>kv_send3_10_11&#45;&gt;ring_stage3_11_12</title>
<path fill="none" stroke="black" d="M14932.77,-3189.13C14947.7,-3179.2 14965.14,-3167.62 14980.98,-3157.09"/>
<polygon fill="black" stroke="black" points="14983.2,-3159.81 14989.59,-3151.36 14979.32,-3153.98 14983.2,-3159.81"/>
</g>
<!-- kv_send3_10_12&#45;&gt;ring_stage3_11_13 -->
<g id="edge3258" class="edge">
<title>kv_send3_10_12&#45;&gt;ring_stage3_11_13</title>
<path fill="none" stroke="black" d="M15495.5,-3097.51C15495.04,-3089.47 15494.53,-3080.49 15494.04,-3071.93"/>
<polygon fill="black" stroke="black" points="15497.53,-3071.58 15493.46,-3061.79 15490.54,-3071.98 15497.53,-3071.58"/>
</g>
<!-- kv_send3_10_13&#45;&gt;ring_stage3_11_14 -->
<g id="edge3261" class="edge">
<title>kv_send3_10_13&#45;&gt;ring_stage3_11_14</title>
<path fill="none" stroke="black" d="M14948.72,-3011.38C14923.83,-3000.57 14893.75,-2987.51 14867.11,-2975.93"/>
<polygon fill="black" stroke="black" points="14868.4,-2972.68 14857.84,-2971.91 14865.61,-2979.1 14868.4,-2972.68"/>
</g>
<!-- kv_send3_10_14&#45;&gt;ring_stage3_11_15 -->
<g id="edge3264" class="edge">
<title>kv_send3_10_14&#45;&gt;ring_stage3_11_15</title>
<path fill="none" stroke="black" d="M14293.98,-2918.5C14290.73,-2910.11 14287.07,-2900.66 14283.6,-2891.71"/>
<polygon fill="black" stroke="black" points="14286.82,-2890.34 14279.95,-2882.28 14280.3,-2892.86 14286.82,-2890.34"/>
</g>
<!-- kv_send3_10_15&#45;&gt;ring_stage3_11_0 -->
<g id="edge3219" class="edge">
<title>kv_send3_10_15&#45;&gt;ring_stage3_11_0</title>
<path fill="none" stroke="black" d="M13286.59,-2832.81C13258.42,-2821.72 13223.78,-2808.1 13193.33,-2796.12"/>
<polygon fill="black" stroke="black" points="13194.61,-2792.86 13184.02,-2792.45 13192.05,-2799.37 13194.61,-2792.86"/>
</g>
<!-- kv_send3_11_0 -->
<g id="node2307" class="node">
<title>kv_send3_11_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12646" cy="-2650" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12646" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="12646" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_11_0&#45;&gt;kv_send3_11_0 -->
<g id="edge3220" class="edge">
<title>ring_stage3_11_0&#45;&gt;kv_send3_11_0</title>
<path fill="none" stroke="black" d="M13022.27,-2741.04C13018.81,-2740.33 13015.38,-2739.65 13012,-2739 12900.01,-2717.58 12867.33,-2735.36 12758,-2703 12737.78,-2697.01 12716.56,-2687.95 12698.09,-2679.06"/>
<polygon fill="black" stroke="black" points="12699.51,-2675.85 12688.99,-2674.58 12696.42,-2682.13 12699.51,-2675.85"/>
</g>
<!-- ring_stage3_12_0 -->
<g id="node2323" class="node">
<title>ring_stage3_12_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13413.5,-2676.5 13220.5,-2676.5 13220.5,-2623.5 13413.5,-2623.5 13413.5,-2676.5"/>
<text text-anchor="middle" x="13317" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="13317" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_4×V_4</text>
<text text-anchor="middle" x="13317" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_11_0&#45;&gt;ring_stage3_12_0 -->
<g id="edge3266" class="edge">
<title>ring_stage3_11_0&#45;&gt;ring_stage3_12_0</title>
<path fill="none" stroke="black" d="M13163.44,-2739.32C13193.01,-2722.31 13232.03,-2699.86 13263.34,-2681.86"/>
<polygon fill="black" stroke="black" points="13265.45,-2684.69 13272.37,-2676.67 13261.96,-2678.62 13265.45,-2684.69"/>
</g>
<!-- kv_send3_11_1 -->
<g id="node2308" class="node">
<title>kv_send3_11_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12211" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12211" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12211" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_11_1&#45;&gt;kv_send3_11_1 -->
<g id="edge3223" class="edge">
<title>ring_stage3_11_1&#45;&gt;kv_send3_11_1</title>
<path fill="none" stroke="black" d="M12388.45,-2623.48C12351.4,-2599.58 12296.03,-2563.86 12257.02,-2538.69"/>
<polygon fill="black" stroke="black" points="12258.76,-2535.65 12248.46,-2533.17 12254.97,-2541.53 12258.76,-2535.65"/>
</g>
<!-- ring_stage3_12_1 -->
<g id="node2324" class="node">
<title>ring_stage3_12_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12749.5,-2534.5 12556.5,-2534.5 12556.5,-2481.5 12749.5,-2481.5 12749.5,-2534.5"/>
<text text-anchor="middle" x="12653" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="12653" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_5×V_5</text>
<text text-anchor="middle" x="12653" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_11_1&#45;&gt;ring_stage3_12_1 -->
<g id="edge3269" class="edge">
<title>ring_stage3_11_1&#45;&gt;ring_stage3_12_1</title>
<path fill="none" stroke="black" d="M12469.01,-2623.48C12506.8,-2599.97 12562.96,-2565.03 12603.29,-2539.93"/>
<polygon fill="black" stroke="black" points="12605.25,-2542.83 12611.9,-2534.58 12601.56,-2536.89 12605.25,-2542.83"/>
</g>
<!-- kv_send3_11_2 -->
<g id="node2309" class="node">
<title>kv_send3_11_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12411" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12411" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12411" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_11_2&#45;&gt;kv_send3_11_2 -->
<g id="edge3226" class="edge">
<title>ring_stage3_11_2&#45;&gt;kv_send3_11_2</title>
<path fill="none" stroke="black" d="M12038.01,-2481.47C12056.43,-2471.95 12078.26,-2461.81 12099,-2455 12184.82,-2426.84 12212.89,-2446.24 12299,-2419 12318.93,-2412.69 12339.93,-2403.65 12358.29,-2394.86"/>
<polygon fill="black" stroke="black" points="12359.9,-2397.97 12367.36,-2390.44 12356.83,-2391.68 12359.9,-2397.97"/>
</g>
<!-- ring_stage3_12_2 -->
<g id="node2325" class="node">
<title>ring_stage3_12_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12289.5,-2392.5 12096.5,-2392.5 12096.5,-2339.5 12289.5,-2339.5 12289.5,-2392.5"/>
<text text-anchor="middle" x="12193" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="12193" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_6×V_6</text>
<text text-anchor="middle" x="12193" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_11_2&#45;&gt;ring_stage3_12_2 -->
<g id="edge3272" class="edge">
<title>ring_stage3_11_2&#45;&gt;ring_stage3_12_2</title>
<path fill="none" stroke="black" d="M12029.68,-2481.32C12063.09,-2457.94 12112.52,-2423.34 12148.24,-2398.33"/>
<polygon fill="black" stroke="black" points="12150.36,-2401.12 12156.55,-2392.52 12146.35,-2395.38 12150.36,-2401.12"/>
</g>
<!-- kv_send3_11_3 -->
<g id="node2310" class="node">
<title>kv_send3_11_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12852" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12852" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="12852" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_11_3&#45;&gt;kv_send3_11_3 -->
<g id="edge3229" class="edge">
<title>ring_stage3_11_3&#45;&gt;kv_send3_11_3</title>
<path fill="none" stroke="black" d="M12852.82,-2339.32C12852.66,-2317.36 12852.43,-2285.5 12852.26,-2260.99"/>
<polygon fill="black" stroke="black" points="12855.76,-2260.96 12852.19,-2250.99 12848.76,-2261.01 12855.76,-2260.96"/>
</g>
<!-- ring_stage3_12_3 -->
<g id="node2326" class="node">
<title>ring_stage3_12_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12728.5,-2250.5 12535.5,-2250.5 12535.5,-2197.5 12728.5,-2197.5 12728.5,-2250.5"/>
<text text-anchor="middle" x="12632" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="12632" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_7×V_7</text>
<text text-anchor="middle" x="12632" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_11_3&#45;&gt;ring_stage3_12_3 -->
<g id="edge3275" class="edge">
<title>ring_stage3_11_3&#45;&gt;ring_stage3_12_3</title>
<path fill="none" stroke="black" d="M12812.72,-2339.48C12775.68,-2316.02 12720.67,-2281.17 12681.08,-2256.09"/>
<polygon fill="black" stroke="black" points="12682.69,-2252.97 12672.37,-2250.58 12678.95,-2258.88 12682.69,-2252.97"/>
</g>
<!-- kv_send3_11_4 -->
<g id="node2311" class="node">
<title>kv_send3_11_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13518" cy="-2082" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13518" y="-2085.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="13518" y="-2070.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_11_4&#45;&gt;kv_send3_11_4 -->
<g id="edge3232" class="edge">
<title>ring_stage3_11_4&#45;&gt;kv_send3_11_4</title>
<path fill="none" stroke="black" d="M13518,-2197.32C13518,-2175.36 13518,-2143.5 13518,-2118.99"/>
<polygon fill="black" stroke="black" points="13521.5,-2118.99 13518,-2108.99 13514.5,-2118.99 13521.5,-2118.99"/>
</g>
<!-- ring_stage3_12_4 -->
<g id="node2327" class="node">
<title>ring_stage3_12_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13396.5,-2108.5 13203.5,-2108.5 13203.5,-2055.5 13396.5,-2055.5 13396.5,-2108.5"/>
<text text-anchor="middle" x="13300" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="13300" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_8×V_8</text>
<text text-anchor="middle" x="13300" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_11_4&#45;&gt;ring_stage3_12_4 -->
<g id="edge3278" class="edge">
<title>ring_stage3_11_4&#45;&gt;ring_stage3_12_4</title>
<path fill="none" stroke="black" d="M13478.27,-2197.48C13441.73,-2174.02 13387.47,-2139.17 13348.41,-2114.09"/>
<polygon fill="black" stroke="black" points="13350.13,-2111.04 13339.83,-2108.58 13346.35,-2116.93 13350.13,-2111.04"/>
</g>
<!-- kv_send3_11_5 -->
<g id="node2312" class="node">
<title>kv_send3_11_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14221" cy="-1940" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14221" y="-1943.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14221" y="-1928.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_11_5&#45;&gt;kv_send3_11_5 -->
<g id="edge3235" class="edge">
<title>ring_stage3_11_5&#45;&gt;kv_send3_11_5</title>
<path fill="none" stroke="black" d="M14046.25,-2055.32C14082.82,-2031.4 14137.33,-1995.74 14175.72,-1970.62"/>
<polygon fill="black" stroke="black" points="14177.69,-1973.52 14184.14,-1965.11 14173.86,-1967.66 14177.69,-1973.52"/>
</g>
<!-- ring_stage3_12_5 -->
<g id="node2328" class="node">
<title>ring_stage3_12_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14098.5,-1966.5 13905.5,-1966.5 13905.5,-1913.5 14098.5,-1913.5 14098.5,-1966.5"/>
<text text-anchor="middle" x="14002" y="-1951.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14002" y="-1936.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_9×V_9</text>
<text text-anchor="middle" x="14002" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_11_5&#45;&gt;ring_stage3_12_5 -->
<g id="edge3281" class="edge">
<title>ring_stage3_11_5&#45;&gt;ring_stage3_12_5</title>
<path fill="none" stroke="black" d="M14006.08,-2055.32C14005.29,-2033.22 14004.15,-2001.1 14003.27,-1976.53"/>
<polygon fill="black" stroke="black" points="14006.77,-1976.38 14002.91,-1966.52 13999.77,-1976.63 14006.77,-1976.38"/>
</g>
<!-- kv_send3_11_6 -->
<g id="node2313" class="node">
<title>kv_send3_11_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14804" cy="-1798" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14804" y="-1801.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14804" y="-1786.8" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_11_6&#45;&gt;kv_send3_11_6 -->
<g id="edge3238" class="edge">
<title>ring_stage3_11_6&#45;&gt;kv_send3_11_6</title>
<path fill="none" stroke="black" d="M14527.37,-1913.43C14546.22,-1904.87 14567.46,-1895.37 14587,-1887 14637.72,-1865.26 14695.66,-1841.83 14738.9,-1824.62"/>
<polygon fill="black" stroke="black" points="14740.45,-1827.77 14748.45,-1820.83 14737.87,-1821.27 14740.45,-1827.77"/>
</g>
<!-- ring_stage3_12_6 -->
<g id="node2329" class="node">
<title>ring_stage3_12_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14550.5,-1824.5 14339.5,-1824.5 14339.5,-1771.5 14550.5,-1771.5 14550.5,-1824.5"/>
<text text-anchor="middle" x="14445" y="-1809.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14445" y="-1794.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_10×V_10</text>
<text text-anchor="middle" x="14445" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_11_6&#45;&gt;ring_stage3_12_6 -->
<g id="edge3284" class="edge">
<title>ring_stage3_11_6&#45;&gt;ring_stage3_12_6</title>
<path fill="none" stroke="black" d="M14467.05,-1913.32C14462.79,-1891.22 14456.59,-1859.1 14451.85,-1834.53"/>
<polygon fill="black" stroke="black" points="14455.25,-1833.67 14449.92,-1824.52 14448.38,-1835 14455.25,-1833.67"/>
</g>
<!-- kv_send3_11_7 -->
<g id="node2314" class="node">
<title>kv_send3_11_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15146" cy="-1656" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15146" y="-1659.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="15146" y="-1644.8" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_11_7&#45;&gt;kv_send3_11_7 -->
<g id="edge3241" class="edge">
<title>ring_stage3_11_7&#45;&gt;kv_send3_11_7</title>
<path fill="none" stroke="black" d="M15145.18,-1771.32C15145.34,-1749.36 15145.57,-1717.5 15145.74,-1692.99"/>
<polygon fill="black" stroke="black" points="15149.24,-1693.01 15145.81,-1682.99 15142.24,-1692.96 15149.24,-1693.01"/>
</g>
<!-- ring_stage3_12_7 -->
<g id="node2330" class="node">
<title>ring_stage3_12_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15021.5,-1682.5 14810.5,-1682.5 14810.5,-1629.5 15021.5,-1629.5 15021.5,-1682.5"/>
<text text-anchor="middle" x="14916" y="-1667.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14916" y="-1652.3" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_11×V_11</text>
<text text-anchor="middle" x="14916" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_11_7&#45;&gt;ring_stage3_12_7 -->
<g id="edge3287" class="edge">
<title>ring_stage3_11_7&#45;&gt;ring_stage3_12_7</title>
<path fill="none" stroke="black" d="M15103.26,-1771.48C15064.8,-1747.97 15007.64,-1713.03 14966.6,-1687.93"/>
<polygon fill="black" stroke="black" points="14968.19,-1684.81 14957.84,-1682.58 14964.54,-1690.78 14968.19,-1684.81"/>
</g>
<!-- kv_send3_11_8 -->
<g id="node2315" class="node">
<title>kv_send3_11_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15369" cy="-3394.05" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15369" y="-3397.85" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="15369" y="-3382.85" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_11_8&#45;&gt;kv_send3_11_8 -->
<g id="edge3244" class="edge">
<title>ring_stage3_11_8&#45;&gt;kv_send3_11_8</title>
<path fill="none" stroke="black" d="M15537.52,-3457.18C15505.69,-3445.44 15468.1,-3431.59 15436.51,-3419.94"/>
<polygon fill="black" stroke="black" points="15437.51,-3416.58 15426.92,-3416.4 15435.09,-3423.15 15437.51,-3416.58"/>
</g>
<!-- ring_stage3_12_8 -->
<g id="node2331" class="node">
<title>ring_stage3_12_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15254.5,-1540.5 15043.5,-1540.5 15043.5,-1487.5 15254.5,-1487.5 15254.5,-1540.5"/>
<text text-anchor="middle" x="15149" y="-1525.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="15149" y="-1510.3" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_12×V_12</text>
<text text-anchor="middle" x="15149" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_11_8&#45;&gt;ring_stage3_12_8 -->
<g id="edge3290" class="edge">
<title>ring_stage3_11_8&#45;&gt;ring_stage3_12_8</title>
<path fill="none" stroke="black" d="M15663.09,-3457.23C15716.57,-3428.57 15789,-3376.59 15789,-3305.31 15789,-3305.31 15789,-3305.31 15789,-2944.35 15789,-2537.14 16033.93,-2319.92 15749,-2029 15705.85,-1984.94 15667.7,-2025.02 15615,-1993 15564.79,-1962.49 15300.81,-1643.23 15258,-1603 15237.03,-1583.3 15212.17,-1563.01 15191.49,-1546.89"/>
<polygon fill="black" stroke="black" points="15193.54,-1544.05 15183.49,-1540.7 15189.26,-1549.59 15193.54,-1544.05"/>
</g>
<!-- kv_send3_11_9 -->
<g id="node2316" class="node">
<title>kv_send3_11_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14446" cy="-3304.31" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14446" y="-3308.11" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14446" y="-3293.11" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_11_9&#45;&gt;kv_send3_11_9 -->
<g id="edge3247" class="edge">
<title>ring_stage3_11_9&#45;&gt;kv_send3_11_9</title>
<path fill="none" stroke="black" d="M14627.27,-3367.44C14592.6,-3355.55 14551.58,-3341.5 14517.34,-3329.76"/>
<polygon fill="black" stroke="black" points="14518.47,-3326.45 14507.88,-3326.52 14516.2,-3333.07 14518.47,-3326.45"/>
</g>
<!-- ring_stage3_12_9 -->
<g id="node2332" class="node">
<title>ring_stage3_12_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15005.5,-3330.81 14794.5,-3330.81 14794.5,-3277.81 15005.5,-3277.81 15005.5,-3330.81"/>
<text text-anchor="middle" x="14900" y="-3315.61" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14900" y="-3300.61" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_13×V_13</text>
<text text-anchor="middle" x="14900" y="-3285.61" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_11_9&#45;&gt;ring_stage3_12_9 -->
<g id="edge3293" class="edge">
<title>ring_stage3_11_9&#45;&gt;ring_stage3_12_9</title>
<path fill="none" stroke="black" d="M14759.8,-3367.44C14782.68,-3357.3 14809.12,-3345.58 14832.84,-3335.07"/>
<polygon fill="black" stroke="black" points="14834.4,-3338.21 14842.13,-3330.96 14831.57,-3331.81 14834.4,-3338.21"/>
</g>
<!-- kv_send3_11_10 -->
<g id="node2317" class="node">
<title>kv_send3_11_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13963" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13963" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="13963" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_11_10&#45;&gt;kv_send3_11_10 -->
<g id="edge3250" class="edge">
<title>ring_stage3_11_10&#45;&gt;kv_send3_11_10</title>
<path fill="none" stroke="black" d="M13968.64,-3277.46C13967.91,-3269.41 13967.09,-3260.38 13966.3,-3251.76"/>
<polygon fill="black" stroke="black" points="13969.76,-3251.18 13965.37,-3241.54 13962.79,-3251.82 13969.76,-3251.18"/>
</g>
<!-- ring_stage3_12_10 -->
<g id="node2333" class="node">
<title>ring_stage3_12_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14311,-3241.07 14091,-3241.07 14091,-3188.07 14311,-3188.07 14311,-3241.07"/>
<text text-anchor="middle" x="14201" y="-3225.87" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14201" y="-3210.87" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_14×V_14</text>
<text text-anchor="middle" x="14201" y="-3195.87" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_11_10&#45;&gt;ring_stage3_12_10 -->
<g id="edge3296" class="edge">
<title>ring_stage3_11_10&#45;&gt;ring_stage3_12_10</title>
<path fill="none" stroke="black" d="M14038.14,-3277.7C14065.07,-3267.43 14096.25,-3255.53 14124.08,-3244.91"/>
<polygon fill="black" stroke="black" points="14125.68,-3248.05 14133.77,-3241.22 14123.18,-3241.51 14125.68,-3248.05"/>
</g>
<!-- kv_send3_11_11 -->
<g id="node2318" class="node">
<title>kv_send3_11_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14562" cy="-3124.83" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14562" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="14562" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_11_11&#45;&gt;kv_send3_11_11 -->
<g id="edge3253" class="edge">
<title>ring_stage3_11_11&#45;&gt;kv_send3_11_11</title>
<path fill="none" stroke="black" d="M14468.53,-3187.96C14483.56,-3177.97 14500.89,-3166.45 14516.52,-3156.06"/>
<polygon fill="black" stroke="black" points="14518.62,-3158.87 14525.01,-3150.42 14514.74,-3153.04 14518.62,-3158.87"/>
</g>
<!-- ring_stage3_12_11 -->
<g id="node2334" class="node">
<title>ring_stage3_12_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14176,-3151.33 13956,-3151.33 13956,-3098.33 14176,-3098.33 14176,-3151.33"/>
<text text-anchor="middle" x="14066" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14066" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_15×V_15</text>
<text text-anchor="middle" x="14066" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_11_11&#45;&gt;ring_stage3_12_11 -->
<g id="edge3299" class="edge">
<title>ring_stage3_11_11&#45;&gt;ring_stage3_12_11</title>
<path fill="none" stroke="black" d="M14328.61,-3189.13C14283.04,-3178.15 14229.03,-3165.13 14181.88,-3153.76"/>
<polygon fill="black" stroke="black" points="14182.47,-3150.3 14171.93,-3151.36 14180.83,-3157.11 14182.47,-3150.3"/>
</g>
<!-- kv_send3_11_12 -->
<g id="node2319" class="node">
<title>kv_send3_11_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15238" cy="-3035.09" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15238" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="15238" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_11_12&#45;&gt;kv_send3_11_12 -->
<g id="edge3256" class="edge">
<title>ring_stage3_11_12&#45;&gt;kv_send3_11_12</title>
<path fill="none" stroke="black" d="M15089.31,-3098.22C15116.16,-3087 15147.66,-3073.83 15174.74,-3062.52"/>
<polygon fill="black" stroke="black" points="15176.24,-3065.69 15184.12,-3058.6 15173.54,-3059.23 15176.24,-3065.69"/>
</g>
<!-- ring_stage3_12_12 -->
<g id="node2335" class="node">
<title>ring_stage3_12_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14873,-3061.59 14671,-3061.59 14671,-3008.59 14873,-3008.59 14873,-3061.59"/>
<text text-anchor="middle" x="14772" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14772" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_0×V_0</text>
<text text-anchor="middle" x="14772" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_11_12&#45;&gt;ring_stage3_12_12 -->
<g id="edge3302" class="edge">
<title>ring_stage3_11_12&#45;&gt;ring_stage3_12_12</title>
<path fill="none" stroke="black" d="M14953.27,-3098.22C14922.91,-3087.81 14887.68,-3075.74 14856.4,-3065.02"/>
<polygon fill="black" stroke="black" points="14857.42,-3061.67 14846.83,-3061.74 14855.15,-3068.29 14857.42,-3061.67"/>
</g>
<!-- kv_send3_11_13 -->
<g id="node2320" class="node">
<title>kv_send3_11_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15510" cy="-2945.35" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15510" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="15510" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_11_13&#45;&gt;kv_send3_11_13 -->
<g id="edge3259" class="edge">
<title>ring_stage3_11_13&#45;&gt;kv_send3_11_13</title>
<path fill="none" stroke="black" d="M15497.3,-3008.24C15498.97,-3000.1 15500.85,-2990.96 15502.63,-2982.26"/>
<polygon fill="black" stroke="black" points="15506.09,-2982.82 15504.67,-2972.32 15499.23,-2981.41 15506.09,-2982.82"/>
</g>
<!-- ring_stage3_12_13 -->
<g id="node2336" class="node">
<title>ring_stage3_12_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15382,-2971.85 15180,-2971.85 15180,-2918.85 15382,-2918.85 15382,-2971.85"/>
<text text-anchor="middle" x="15281" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="15281" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_1×V_1</text>
<text text-anchor="middle" x="15281" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_11_13&#45;&gt;ring_stage3_12_13 -->
<g id="edge3305" class="edge">
<title>ring_stage3_11_13&#45;&gt;ring_stage3_12_13</title>
<path fill="none" stroke="black" d="M15430.4,-3008.48C15405.92,-2998.3 15377.59,-2986.52 15352.23,-2975.97"/>
<polygon fill="black" stroke="black" points="15353.25,-2972.6 15342.67,-2972 15350.56,-2979.07 15353.25,-2972.6"/>
</g>
<!-- kv_send3_11_14 -->
<g id="node2321" class="node">
<title>kv_send3_11_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14794" cy="-2855.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14794" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="14794" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_11_14&#45;&gt;kv_send3_11_14 -->
<g id="edge3262" class="edge">
<title>ring_stage3_11_14&#45;&gt;kv_send3_11_14</title>
<path fill="none" stroke="black" d="M14797.53,-2918.5C14797.07,-2910.45 14796.55,-2901.42 14796.06,-2892.8"/>
<polygon fill="black" stroke="black" points="14799.54,-2892.36 14795.48,-2882.58 14792.55,-2892.76 14799.54,-2892.36"/>
</g>
<!-- ring_stage3_12_14 -->
<g id="node2337" class="node">
<title>ring_stage3_12_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15492,-2882.11 15290,-2882.11 15290,-2829.11 15492,-2829.11 15492,-2882.11"/>
<text text-anchor="middle" x="15391" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="15391" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_2×V_2</text>
<text text-anchor="middle" x="15391" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_11_14&#45;&gt;ring_stage3_12_14 -->
<g id="edge3308" class="edge">
<title>ring_stage3_11_14&#45;&gt;ring_stage3_12_14</title>
<path fill="none" stroke="black" d="M14900.22,-2924.12C14911.26,-2922.12 14922.36,-2920.2 14933,-2918.48 15056,-2898.66 15087.56,-2899.34 15211,-2882.48 15233.21,-2879.45 15256.94,-2876.11 15279.65,-2872.86"/>
<polygon fill="black" stroke="black" points="15280.25,-2876.31 15289.65,-2871.43 15279.26,-2869.38 15280.25,-2876.31"/>
</g>
<!-- kv_send3_11_15 -->
<g id="node2322" class="node">
<title>kv_send3_11_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14268" cy="-2765.87" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14268" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="14268" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_11_15&#45;&gt;kv_send3_11_15 -->
<g id="edge3265" class="edge">
<title>ring_stage3_11_15&#45;&gt;kv_send3_11_15</title>
<path fill="none" stroke="black" d="M14269.41,-2828.76C14269.23,-2820.71 14269.02,-2811.68 14268.82,-2803.06"/>
<polygon fill="black" stroke="black" points="14272.32,-2802.76 14268.59,-2792.84 14265.32,-2802.92 14272.32,-2802.76"/>
</g>
<!-- ring_stage3_12_15 -->
<g id="node2338" class="node">
<title>ring_stage3_12_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14631,-2792.37 14429,-2792.37 14429,-2739.37 14631,-2739.37 14631,-2792.37"/>
<text text-anchor="middle" x="14530" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
<text text-anchor="middle" x="14530" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_3×V_3</text>
<text text-anchor="middle" x="14530" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_11_15&#45;&gt;ring_stage3_12_15 -->
<g id="edge3311" class="edge">
<title>ring_stage3_11_15&#45;&gt;ring_stage3_12_15</title>
<path fill="none" stroke="black" d="M14345.9,-2829C14376.74,-2818.59 14412.51,-2806.52 14444.28,-2795.8"/>
<polygon fill="black" stroke="black" points="14445.65,-2799.03 14454,-2792.52 14443.41,-2792.4 14445.65,-2799.03"/>
</g>
<!-- kv_send3_11_0&#45;&gt;ring_stage3_12_1 -->
<g id="edge3270" class="edge">
<title>kv_send3_11_0&#45;&gt;ring_stage3_12_1</title>
<path fill="none" stroke="black" d="M12647.3,-2623C12648.4,-2601.09 12649.97,-2569.52 12651.19,-2545.15"/>
<polygon fill="black" stroke="black" points="12654.7,-2545.03 12651.71,-2534.87 12647.71,-2544.68 12654.7,-2545.03"/>
</g>
<!-- kv_send3_11_1&#45;&gt;ring_stage3_12_2 -->
<g id="edge3273" class="edge">
<title>kv_send3_11_1&#45;&gt;ring_stage3_12_2</title>
<path fill="none" stroke="black" d="M12207.66,-2481C12204.83,-2458.99 12200.74,-2427.24 12197.61,-2402.83"/>
<polygon fill="black" stroke="black" points="12201.07,-2402.34 12196.33,-2392.87 12194.13,-2403.23 12201.07,-2402.34"/>
</g>
<!-- kv_send3_11_2&#45;&gt;ring_stage3_12_3 -->
<g id="edge3276" class="edge">
<title>kv_send3_11_2&#45;&gt;ring_stage3_12_3</title>
<path fill="none" stroke="black" d="M12448.99,-2340.93C12486.01,-2317.48 12542.48,-2281.71 12582.89,-2256.11"/>
<polygon fill="black" stroke="black" points="12584.94,-2258.95 12591.52,-2250.65 12581.19,-2253.04 12584.94,-2258.95"/>
</g>
<!-- kv_send3_11_3&#45;&gt;ring_stage3_12_4 -->
<g id="edge3279" class="edge">
<title>kv_send3_11_3&#45;&gt;ring_stage3_12_4</title>
<path fill="none" stroke="black" d="M12895.03,-2199.58C12915.41,-2189.39 12940.41,-2178.17 12964,-2171 13063,-2140.92 13095.33,-2166.14 13194,-2135 13211.48,-2129.48 13229.69,-2121.47 13245.98,-2113.39"/>
<polygon fill="black" stroke="black" points="13248,-2116.28 13255.33,-2108.63 13244.83,-2110.04 13248,-2116.28"/>
</g>
<!-- kv_send3_11_4&#45;&gt;ring_stage3_12_5 -->
<g id="edge3282" class="edge">
<title>kv_send3_11_4&#45;&gt;ring_stage3_12_5</title>
<path fill="none" stroke="black" d="M13597.39,-2064.8C13670.15,-2049.15 13780.45,-2023.39 13874,-1993 13894,-1986.5 13915.31,-1978.36 13934.69,-1970.46"/>
<polygon fill="black" stroke="black" points="13936.12,-1973.65 13944.03,-1966.61 13933.45,-1967.18 13936.12,-1973.65"/>
</g>
<!-- kv_send3_11_5&#45;&gt;ring_stage3_12_6 -->
<g id="edge3285" class="edge">
<title>kv_send3_11_5&#45;&gt;ring_stage3_12_6</title>
<path fill="none" stroke="black" d="M14259.51,-1914.93C14297.11,-1891.43 14354.5,-1855.56 14395.48,-1829.95"/>
<polygon fill="black" stroke="black" points="14397.34,-1832.91 14403.97,-1824.65 14393.63,-1826.98 14397.34,-1832.91"/>
</g>
<!-- kv_send3_11_6&#45;&gt;ring_stage3_12_7 -->
<g id="edge3288" class="edge">
<title>kv_send3_11_6&#45;&gt;ring_stage3_12_7</title>
<path fill="none" stroke="black" d="M14824.28,-1771.65C14842.41,-1748.99 14869.1,-1715.63 14889.02,-1690.73"/>
<polygon fill="black" stroke="black" points="14891.98,-1692.63 14895.49,-1682.64 14886.51,-1688.26 14891.98,-1692.63"/>
</g>
<!-- kv_send3_11_7&#45;&gt;ring_stage3_12_8 -->
<g id="edge3291" class="edge">
<title>kv_send3_11_7&#45;&gt;ring_stage3_12_8</title>
<path fill="none" stroke="black" d="M15146.56,-1629C15147.03,-1607.09 15147.7,-1575.52 15148.23,-1551.15"/>
<polygon fill="black" stroke="black" points="15151.73,-1550.94 15148.45,-1540.87 15144.73,-1550.79 15151.73,-1550.94"/>
</g>
<!-- kv_send3_11_8&#45;&gt;ring_stage3_12_9 -->
<g id="edge3294" class="edge">
<title>kv_send3_11_8&#45;&gt;ring_stage3_12_9</title>
<path fill="none" stroke="black" d="M15295.37,-3375.2C15282.61,-3372.35 15269.45,-3369.56 15257,-3367.18 15152.35,-3347.18 15124.79,-3350.42 15020,-3331.18 15018.53,-3330.91 15017.04,-3330.64 15015.55,-3330.36"/>
<polygon fill="black" stroke="black" points="15016.09,-3326.9 15005.61,-3328.46 15014.78,-3333.77 15016.09,-3326.9"/>
</g>
<!-- kv_send3_11_9&#45;&gt;ring_stage3_12_10 -->
<g id="edge3297" class="edge">
<title>kv_send3_11_9&#45;&gt;ring_stage3_12_10</title>
<path fill="none" stroke="black" d="M14385.75,-3281.73C14354.41,-3270.51 14315.67,-3256.64 14281.76,-3244.49"/>
<polygon fill="black" stroke="black" points="14282.94,-3241.2 14272.34,-3241.12 14280.58,-3247.79 14282.94,-3241.2"/>
</g>
<!-- kv_send3_11_10&#45;&gt;ring_stage3_12_11 -->
<g id="edge3300" class="edge">
<title>kv_send3_11_10&#45;&gt;ring_stage3_12_11</title>
<path fill="none" stroke="black" d="M13992.24,-3188.66C14003.46,-3179.1 14016.43,-3168.06 14028.33,-3157.92"/>
<polygon fill="black" stroke="black" points="14030.63,-3160.56 14035.97,-3151.41 14026.09,-3155.23 14030.63,-3160.56"/>
</g>
<!-- kv_send3_11_11&#45;&gt;ring_stage3_12_12 -->
<g id="edge3303" class="edge">
<title>kv_send3_11_11&#45;&gt;ring_stage3_12_12</title>
<path fill="none" stroke="black" d="M14615.81,-3101.35C14641.9,-3090.45 14673.58,-3077.21 14701.57,-3065.52"/>
<polygon fill="black" stroke="black" points="14703.03,-3068.7 14710.91,-3061.62 14700.33,-3062.24 14703.03,-3068.7"/>
</g>
<!-- kv_send3_11_12&#45;&gt;ring_stage3_12_13 -->
<g id="edge3306" class="edge">
<title>kv_send3_11_12&#45;&gt;ring_stage3_12_13</title>
<path fill="none" stroke="black" d="M15250.67,-3008.24C15254.82,-2999.76 15259.51,-2990.2 15263.94,-2981.16"/>
<polygon fill="black" stroke="black" points="15267.16,-2982.54 15268.42,-2972.02 15260.88,-2979.46 15267.16,-2982.54"/>
</g>
<!-- kv_send3_11_13&#45;&gt;ring_stage3_12_14 -->
<g id="edge3309" class="edge">
<title>kv_send3_11_13&#45;&gt;ring_stage3_12_14</title>
<path fill="none" stroke="black" d="M15476.54,-2919.68C15463.32,-2909.93 15447.97,-2898.61 15433.95,-2888.27"/>
<polygon fill="black" stroke="black" points="15436,-2885.44 15425.87,-2882.32 15431.84,-2891.07 15436,-2885.44"/>
</g>
<!-- kv_send3_11_14&#45;&gt;ring_stage3_12_15 -->
<g id="edge3312" class="edge">
<title>kv_send3_11_14&#45;&gt;ring_stage3_12_15</title>
<path fill="none" stroke="black" d="M14730.77,-2833.59C14696.6,-2822.24 14653.9,-2808.05 14616.68,-2795.68"/>
<polygon fill="black" stroke="black" points="14617.44,-2792.24 14606.84,-2792.41 14615.23,-2798.88 14617.44,-2792.24"/>
</g>
<!-- kv_send3_11_15&#45;&gt;ring_stage3_12_0 -->
<g id="edge3267" class="edge">
<title>kv_send3_11_15&#45;&gt;ring_stage3_12_0</title>
<path fill="none" stroke="black" d="M14196.65,-2746.4C14183.23,-2743.49 14169.24,-2740.84 14156,-2739 13835.14,-2694.37 13742.37,-2781.19 13428,-2703 13408.39,-2698.12 13388.06,-2689.71 13370.24,-2681.06"/>
<polygon fill="black" stroke="black" points="13371.67,-2677.86 13361.16,-2676.53 13368.55,-2684.12 13371.67,-2677.86"/>
</g>
<!-- kv_send3_12_0 -->
<g id="node2339" class="node">
<title>kv_send3_12_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13082" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13082" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="13082" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_12_0&#45;&gt;kv_send3_12_0 -->
<g id="edge3268" class="edge">
<title>ring_stage3_12_0&#45;&gt;kv_send3_12_0</title>
<path fill="none" stroke="black" d="M13274.17,-2623.48C13233.75,-2599.41 13173.21,-2563.34 13130.92,-2538.14"/>
<polygon fill="black" stroke="black" points="13132.56,-2535.05 13122.18,-2532.94 13128.98,-2541.06 13132.56,-2535.05"/>
</g>
<!-- ring_stage3_13_0 -->
<g id="node2355" class="node">
<title>ring_stage3_13_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13620.5,-2534.5 13427.5,-2534.5 13427.5,-2481.5 13620.5,-2481.5 13620.5,-2534.5"/>
<text text-anchor="middle" x="13524" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="13524" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_3×V_3</text>
<text text-anchor="middle" x="13524" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_12_0&#45;&gt;ring_stage3_13_0 -->
<g id="edge3314" class="edge">
<title>ring_stage3_12_0&#45;&gt;ring_stage3_13_0</title>
<path fill="none" stroke="black" d="M13354.97,-2623.32C13389.54,-2599.94 13440.7,-2565.34 13477.67,-2540.33"/>
<polygon fill="black" stroke="black" points="13479.95,-2543.02 13486.27,-2534.52 13476.03,-2537.22 13479.95,-2543.02"/>
</g>
<!-- kv_send3_12_1 -->
<g id="node2340" class="node">
<title>kv_send3_12_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12635" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12635" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12635" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_12_1&#45;&gt;kv_send3_12_1 -->
<g id="edge3271" class="edge">
<title>ring_stage3_12_1&#45;&gt;kv_send3_12_1</title>
<path fill="none" stroke="black" d="M12649.7,-2481.32C12646.87,-2459.36 12642.78,-2427.5 12639.63,-2402.99"/>
<polygon fill="black" stroke="black" points="12643.09,-2402.46 12638.34,-2392.99 12636.15,-2403.35 12643.09,-2402.46"/>
</g>
<!-- ring_stage3_13_1 -->
<g id="node2356" class="node">
<title>ring_stage3_13_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13172.5,-2392.5 12979.5,-2392.5 12979.5,-2339.5 13172.5,-2339.5 13172.5,-2392.5"/>
<text text-anchor="middle" x="13076" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="13076" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_4×V_4</text>
<text text-anchor="middle" x="13076" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_12_1&#45;&gt;ring_stage3_13_1 -->
<g id="edge3317" class="edge">
<title>ring_stage3_12_1&#45;&gt;ring_stage3_13_1</title>
<path fill="none" stroke="black" d="M12698.01,-2481.47C12716.43,-2471.95 12738.26,-2461.81 12759,-2455 12844.82,-2426.84 12872.67,-2445.53 12959,-2419 12978.18,-2413.11 12998.38,-2404.9 13016.5,-2396.75"/>
<polygon fill="black" stroke="black" points="13018.13,-2399.85 13025.76,-2392.51 13015.21,-2393.49 13018.13,-2399.85"/>
</g>
<!-- kv_send3_12_2 -->
<g id="node2341" class="node">
<title>kv_send3_12_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12194" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12194" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12194" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_12_2&#45;&gt;kv_send3_12_2 -->
<g id="edge3274" class="edge">
<title>ring_stage3_12_2&#45;&gt;kv_send3_12_2</title>
<path fill="none" stroke="black" d="M12193.18,-2339.32C12193.34,-2317.36 12193.57,-2285.5 12193.74,-2260.99"/>
<polygon fill="black" stroke="black" points="12197.24,-2261.01 12193.81,-2250.99 12190.24,-2260.96 12197.24,-2261.01"/>
</g>
<!-- ring_stage3_13_2 -->
<g id="node2357" class="node">
<title>ring_stage3_13_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12514.5,-2250.5 12321.5,-2250.5 12321.5,-2197.5 12514.5,-2197.5 12514.5,-2250.5"/>
<text text-anchor="middle" x="12418" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="12418" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_5×V_5</text>
<text text-anchor="middle" x="12418" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_12_2&#45;&gt;ring_stage3_13_2 -->
<g id="edge3320" class="edge">
<title>ring_stage3_12_2&#45;&gt;ring_stage3_13_2</title>
<path fill="none" stroke="black" d="M12234.01,-2339.48C12271.8,-2315.97 12327.96,-2281.03 12368.29,-2255.93"/>
<polygon fill="black" stroke="black" points="12370.25,-2258.83 12376.9,-2250.58 12366.56,-2252.89 12370.25,-2258.83"/>
</g>
<!-- kv_send3_12_3 -->
<g id="node2342" class="node">
<title>kv_send3_12_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13082" cy="-2082" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13082" y="-2085.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="13082" y="-2070.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_12_3&#45;&gt;kv_send3_12_3 -->
<g id="edge3277" class="edge">
<title>ring_stage3_12_3&#45;&gt;kv_send3_12_3</title>
<path fill="none" stroke="black" d="M12677.56,-2197.39C12696.39,-2187.79 12718.74,-2177.62 12740,-2171 12838.78,-2140.23 12871,-2165.08 12970,-2135 12990.18,-2128.87 13011.39,-2119.77 13029.86,-2110.89"/>
<polygon fill="black" stroke="black" points="13031.53,-2113.97 13038.97,-2106.42 13028.45,-2107.69 13031.53,-2113.97"/>
</g>
<!-- ring_stage3_13_3 -->
<g id="node2358" class="node">
<title>ring_stage3_13_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12525.5,-2108.5 12332.5,-2108.5 12332.5,-2055.5 12525.5,-2055.5 12525.5,-2108.5"/>
<text text-anchor="middle" x="12429" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="12429" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_6×V_6</text>
<text text-anchor="middle" x="12429" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_12_3&#45;&gt;ring_stage3_13_3 -->
<g id="edge3323" class="edge">
<title>ring_stage3_12_3&#45;&gt;ring_stage3_13_3</title>
<path fill="none" stroke="black" d="M12594.77,-2197.32C12560.86,-2173.94 12510.69,-2139.34 12474.43,-2114.33"/>
<polygon fill="black" stroke="black" points="12476.22,-2111.31 12466,-2108.52 12472.24,-2117.07 12476.22,-2111.31"/>
</g>
<!-- kv_send3_12_4 -->
<g id="node2343" class="node">
<title>kv_send3_12_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13762" cy="-1940" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13762" y="-1943.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="13762" y="-1928.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_12_4&#45;&gt;kv_send3_12_4 -->
<g id="edge3280" class="edge">
<title>ring_stage3_12_4&#45;&gt;kv_send3_12_4</title>
<path fill="none" stroke="black" d="M13346.55,-2055.49C13364.72,-2046.24 13385.97,-2036.29 13406,-2029 13493.13,-1997.27 13596.35,-1973.16 13669.15,-1958.27"/>
<polygon fill="black" stroke="black" points="13670.11,-1961.65 13679.22,-1956.23 13668.72,-1954.79 13670.11,-1961.65"/>
</g>
<!-- ring_stage3_13_4 -->
<g id="node2359" class="node">
<title>ring_stage3_13_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13370.5,-1966.5 13177.5,-1966.5 13177.5,-1913.5 13370.5,-1913.5 13370.5,-1966.5"/>
<text text-anchor="middle" x="13274" y="-1951.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="13274" y="-1936.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_7×V_7</text>
<text text-anchor="middle" x="13274" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_12_4&#45;&gt;ring_stage3_13_4 -->
<g id="edge3326" class="edge">
<title>ring_stage3_12_4&#45;&gt;ring_stage3_13_4</title>
<path fill="none" stroke="black" d="M13295.23,-2055.32C13291.13,-2033.22 13285.16,-2001.1 13280.6,-1976.53"/>
<polygon fill="black" stroke="black" points="13284.01,-1975.71 13278.74,-1966.52 13277.12,-1976.99 13284.01,-1975.71"/>
</g>
<!-- kv_send3_12_5 -->
<g id="node2344" class="node">
<title>kv_send3_12_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14218" cy="-1798" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14218" y="-1801.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14218" y="-1786.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_12_5&#45;&gt;kv_send3_12_5 -->
<g id="edge3283" class="edge">
<title>ring_stage3_12_5&#45;&gt;kv_send3_12_5</title>
<path fill="none" stroke="black" d="M14041.62,-1913.32C14078.53,-1889.4 14133.55,-1853.74 14172.3,-1828.62"/>
<polygon fill="black" stroke="black" points="14174.31,-1831.49 14180.8,-1823.11 14170.5,-1825.61 14174.31,-1831.49"/>
</g>
<!-- ring_stage3_13_5 -->
<g id="node2360" class="node">
<title>ring_stage3_13_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14096.5,-1824.5 13903.5,-1824.5 13903.5,-1771.5 14096.5,-1771.5 14096.5,-1824.5"/>
<text text-anchor="middle" x="14000" y="-1809.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14000" y="-1794.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_8×V_8</text>
<text text-anchor="middle" x="14000" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_12_5&#45;&gt;ring_stage3_13_5 -->
<g id="edge3329" class="edge">
<title>ring_stage3_12_5&#45;&gt;ring_stage3_13_5</title>
<path fill="none" stroke="black" d="M14001.63,-1913.32C14001.32,-1891.22 14000.86,-1859.1 14000.51,-1834.53"/>
<polygon fill="black" stroke="black" points="14004.01,-1834.46 14000.36,-1824.52 13997.01,-1834.56 14004.01,-1834.46"/>
</g>
<!-- kv_send3_12_6 -->
<g id="node2345" class="node">
<title>kv_send3_12_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14447" cy="-1656" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14447" y="-1659.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14447" y="-1644.8" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_12_6&#45;&gt;kv_send3_12_6 -->
<g id="edge3286" class="edge">
<title>ring_stage3_12_6&#45;&gt;kv_send3_12_6</title>
<path fill="none" stroke="black" d="M14445.37,-1771.32C14445.68,-1749.36 14446.14,-1717.5 14446.49,-1692.99"/>
<polygon fill="black" stroke="black" points="14449.99,-1693.04 14446.63,-1682.99 14442.99,-1692.94 14449.99,-1693.04"/>
</g>
<!-- ring_stage3_13_6 -->
<g id="node2361" class="node">
<title>ring_stage3_13_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14322.5,-1682.5 14129.5,-1682.5 14129.5,-1629.5 14322.5,-1629.5 14322.5,-1682.5"/>
<text text-anchor="middle" x="14226" y="-1667.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14226" y="-1652.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_9×V_9</text>
<text text-anchor="middle" x="14226" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_12_6&#45;&gt;ring_stage3_13_6 -->
<g id="edge3332" class="edge">
<title>ring_stage3_12_6&#45;&gt;ring_stage3_13_6</title>
<path fill="none" stroke="black" d="M14405.09,-1771.48C14368.38,-1748.02 14313.87,-1713.17 14274.63,-1688.09"/>
<polygon fill="black" stroke="black" points="14276.32,-1685.01 14266.01,-1682.58 14272.55,-1690.91 14276.32,-1685.01"/>
</g>
<!-- kv_send3_12_7 -->
<g id="node2346" class="node">
<title>kv_send3_12_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14922" cy="-1514" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14922" y="-1517.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="14922" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_12_7&#45;&gt;kv_send3_12_7 -->
<g id="edge3289" class="edge">
<title>ring_stage3_12_7&#45;&gt;kv_send3_12_7</title>
<path fill="none" stroke="black" d="M14917.1,-1629.32C14918.04,-1607.36 14919.41,-1575.5 14920.46,-1550.99"/>
<polygon fill="black" stroke="black" points="14923.95,-1551.13 14920.89,-1540.99 14916.96,-1550.83 14923.95,-1551.13"/>
</g>
<!-- ring_stage3_13_7 -->
<g id="node2362" class="node">
<title>ring_stage3_13_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14800.5,-1540.5 14589.5,-1540.5 14589.5,-1487.5 14800.5,-1487.5 14800.5,-1540.5"/>
<text text-anchor="middle" x="14695" y="-1525.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14695" y="-1510.3" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_10×V_10</text>
<text text-anchor="middle" x="14695" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_12_7&#45;&gt;ring_stage3_13_7 -->
<g id="edge3335" class="edge">
<title>ring_stage3_12_7&#45;&gt;ring_stage3_13_7</title>
<path fill="none" stroke="black" d="M14875.72,-1629.48C14838.68,-1606.02 14783.67,-1571.17 14744.08,-1546.09"/>
<polygon fill="black" stroke="black" points="14745.69,-1542.97 14735.37,-1540.58 14741.95,-1548.88 14745.69,-1542.97"/>
</g>
<!-- kv_send3_12_8 -->
<g id="node2347" class="node">
<title>kv_send3_12_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14921" cy="-1372" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14921" y="-1375.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="14921" y="-1360.8" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_12_8&#45;&gt;kv_send3_12_8 -->
<g id="edge3292" class="edge">
<title>ring_stage3_12_8&#45;&gt;kv_send3_12_8</title>
<path fill="none" stroke="black" d="M15107.45,-1487.48C15068.32,-1463.46 15009.74,-1427.49 14968.72,-1402.3"/>
<polygon fill="black" stroke="black" points="14970.34,-1399.19 14959.98,-1396.94 14966.67,-1405.15 14970.34,-1399.19"/>
</g>
<!-- ring_stage3_13_8 -->
<g id="node2363" class="node">
<title>ring_stage3_13_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15253.5,-1398.5 15042.5,-1398.5 15042.5,-1345.5 15253.5,-1345.5 15253.5,-1398.5"/>
<text text-anchor="middle" x="15148" y="-1383.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="15148" y="-1368.3" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_11×V_11</text>
<text text-anchor="middle" x="15148" y="-1353.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_12_8&#45;&gt;ring_stage3_13_8 -->
<g id="edge3338" class="edge">
<title>ring_stage3_12_8&#45;&gt;ring_stage3_13_8</title>
<path fill="none" stroke="black" d="M15148.82,-1487.32C15148.66,-1465.22 15148.43,-1433.1 15148.25,-1408.53"/>
<polygon fill="black" stroke="black" points="15151.75,-1408.49 15148.18,-1398.52 15144.75,-1408.54 15151.75,-1408.49"/>
</g>
<!-- kv_send3_12_9 -->
<g id="node2348" class="node">
<title>kv_send3_12_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14659" cy="-3214.57" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14659" y="-3218.37" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14659" y="-3203.37" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_12_9&#45;&gt;kv_send3_12_9 -->
<g id="edge3295" class="edge">
<title>ring_stage3_12_9&#45;&gt;kv_send3_12_9</title>
<path fill="none" stroke="black" d="M14829.64,-3277.7C14797.66,-3266.05 14759.95,-3252.32 14728.12,-3240.73"/>
<polygon fill="black" stroke="black" points="14729.03,-3237.34 14718.44,-3237.21 14726.64,-3243.92 14729.03,-3237.34"/>
</g>
<!-- ring_stage3_13_9 -->
<g id="node2364" class="node">
<title>ring_stage3_13_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14995.5,-1256.5 14784.5,-1256.5 14784.5,-1203.5 14995.5,-1203.5 14995.5,-1256.5"/>
<text text-anchor="middle" x="14890" y="-1241.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14890" y="-1226.3" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_12×V_12</text>
<text text-anchor="middle" x="14890" y="-1211.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_12_9&#45;&gt;ring_stage3_13_9 -->
<g id="edge3341" class="edge">
<title>ring_stage3_12_9&#45;&gt;ring_stage3_13_9</title>
<path fill="none" stroke="black" d="M14957.28,-3277.78C14976.58,-3267.84 14997.61,-3255.45 15015,-3241.44 15039.48,-3221.72 15035.97,-3206.73 15061,-3187.7 15091.07,-3164.84 15112.39,-3179.47 15138,-3151.7 15155.28,-3132.96 15138.45,-3114.31 15158,-3097.96 15226.93,-3040.28 15299.38,-3130.94 15357,-3061.96 15372.31,-3043.63 15373.16,-3025.81 15357,-3008.22 15293.03,-2938.58 15001.64,-3037.26 14933,-2972.22 14886.26,-2927.93 14956.73,-2876 14913,-2828.74 14862.32,-2773.97 14819.43,-2817.42 14749,-2792.74 14698.03,-2774.88 14692.27,-2752.59 14640,-2739 14563.77,-2719.17 13986.37,-2760 13932,-2703 13902.09,-2671.64 13903.46,-2346.45 13931,-2313 13983.96,-2248.67 14058.14,-2337.92 14115,-2277 14152.9,-2236.4 14108.04,-2069.54 14146,-2029 14203.85,-1967.22 14271.93,-2051.6 14333,-1993 14367.93,-1959.49 14322.84,-1920.27 14358,-1887 14424.24,-1824.32 14499.67,-1919.38 14560,-1851 14617.12,-1786.26 14570,-1743.34 14570,-1657 14570,-1657 14570,-1657 14570,-1513 14570,-1469.78 14555.23,-1351.26 14584,-1319 14641.5,-1254.53 14692.62,-1308.98 14775,-1283 14793.77,-1277.08 14813.53,-1268.91 14831.28,-1260.8"/>
<polygon fill="black" stroke="black" points="14832.76,-1263.97 14840.35,-1256.58 14829.81,-1257.62 14832.76,-1263.97"/>
</g>
<!-- kv_send3_12_10 -->
<g id="node2349" class="node">
<title>kv_send3_12_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13828" cy="-3124.83" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13828" y="-3128.63" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="13828" y="-3113.63" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_12_10&#45;&gt;kv_send3_12_10 -->
<g id="edge3298" class="edge">
<title>ring_stage3_12_10&#45;&gt;kv_send3_12_10</title>
<path fill="none" stroke="black" d="M14092.36,-3188.02C14035.99,-3174.76 13968.05,-3158.78 13915.17,-3146.33"/>
<polygon fill="black" stroke="black" points="13915.67,-3142.86 13905.14,-3143.98 13914.07,-3149.67 13915.67,-3142.86"/>
</g>
<!-- ring_stage3_13_10 -->
<g id="node2365" class="node">
<title>ring_stage3_13_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14434,-3151.33 14214,-3151.33 14214,-3098.33 14434,-3098.33 14434,-3151.33"/>
<text text-anchor="middle" x="14324" y="-3136.13" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14324" y="-3121.13" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_13×V_13</text>
<text text-anchor="middle" x="14324" y="-3106.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_12_10&#45;&gt;ring_stage3_13_10 -->
<g id="edge3344" class="edge">
<title>ring_stage3_12_10&#45;&gt;ring_stage3_13_10</title>
<path fill="none" stroke="black" d="M14236.91,-3187.96C14250.18,-3178.49 14265.38,-3167.64 14279.34,-3157.69"/>
<polygon fill="black" stroke="black" points="14281.73,-3160.28 14287.84,-3151.63 14277.66,-3154.59 14281.73,-3160.28"/>
</g>
<!-- kv_send3_12_11 -->
<g id="node2350" class="node">
<title>kv_send3_12_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14066" cy="-3035.09" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14066" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="14066" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_12_11&#45;&gt;kv_send3_12_11 -->
<g id="edge3301" class="edge">
<title>ring_stage3_12_11&#45;&gt;kv_send3_12_11</title>
<path fill="none" stroke="black" d="M14066,-3097.98C14066,-3089.93 14066,-3080.9 14066,-3072.28"/>
<polygon fill="black" stroke="black" points="14069.5,-3072.06 14066,-3062.06 14062.5,-3072.06 14069.5,-3072.06"/>
</g>
<!-- ring_stage3_13_11 -->
<g id="node2366" class="node">
<title>ring_stage3_13_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13918,-3061.59 13698,-3061.59 13698,-3008.59 13918,-3008.59 13918,-3061.59"/>
<text text-anchor="middle" x="13808" y="-3046.39" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="13808" y="-3031.39" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_14×V_14</text>
<text text-anchor="middle" x="13808" y="-3016.39" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_12_11&#45;&gt;ring_stage3_13_11 -->
<g id="edge3347" class="edge">
<title>ring_stage3_12_11&#45;&gt;ring_stage3_13_11</title>
<path fill="none" stroke="black" d="M13990.68,-3098.22C13960.08,-3087.81 13924.58,-3075.74 13893.06,-3065.02"/>
<polygon fill="black" stroke="black" points="13894.01,-3061.64 13883.41,-3061.74 13891.75,-3068.27 13894.01,-3061.64"/>
</g>
<!-- kv_send3_12_12 -->
<g id="node2351" class="node">
<title>kv_send3_12_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15052" cy="-2945.35" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15052" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="15052" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_12_12&#45;&gt;kv_send3_12_12 -->
<g id="edge3304" class="edge">
<title>ring_stage3_12_12&#45;&gt;kv_send3_12_12</title>
<path fill="none" stroke="black" d="M14853.74,-3008.48C14892.41,-2996.36 14938.31,-2981.98 14976.19,-2970.1"/>
<polygon fill="black" stroke="black" points="14977.65,-2973.32 14986.15,-2966.99 14975.56,-2966.64 14977.65,-2973.32"/>
</g>
<!-- ring_stage3_13_12 -->
<g id="node2367" class="node">
<title>ring_stage3_13_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14672,-2971.85 14452,-2971.85 14452,-2918.85 14672,-2918.85 14672,-2971.85"/>
<text text-anchor="middle" x="14562" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14562" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_15×V_15</text>
<text text-anchor="middle" x="14562" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_12_12&#45;&gt;ring_stage3_13_12 -->
<g id="edge3350" class="edge">
<title>ring_stage3_12_12&#45;&gt;ring_stage3_13_12</title>
<path fill="none" stroke="black" d="M14710.69,-3008.48C14686.33,-2998.3 14658.14,-2986.52 14632.9,-2975.97"/>
<polygon fill="black" stroke="black" points="14633.96,-2972.62 14623.38,-2972 14631.26,-2979.08 14633.96,-2972.62"/>
</g>
<!-- kv_send3_12_13 -->
<g id="node2352" class="node">
<title>kv_send3_12_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15620" cy="-2855.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15620" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="15620" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_12_13&#45;&gt;kv_send3_12_13 -->
<g id="edge3307" class="edge">
<title>ring_stage3_12_13&#45;&gt;kv_send3_12_13</title>
<path fill="none" stroke="black" d="M15379.96,-2918.74C15429.68,-2905.87 15489.26,-2890.45 15536.62,-2878.19"/>
<polygon fill="black" stroke="black" points="15537.72,-2881.52 15546.53,-2875.63 15535.97,-2874.74 15537.72,-2881.52"/>
</g>
<!-- ring_stage3_13_13 -->
<g id="node2368" class="node">
<title>ring_stage3_13_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15202,-2882.11 15000,-2882.11 15000,-2829.11 15202,-2829.11 15202,-2882.11"/>
<text text-anchor="middle" x="15101" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="15101" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_0×V_0</text>
<text text-anchor="middle" x="15101" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_12_13&#45;&gt;ring_stage3_13_13 -->
<g id="edge3353" class="edge">
<title>ring_stage3_12_13&#45;&gt;ring_stage3_13_13</title>
<path fill="none" stroke="black" d="M15228.45,-2918.74C15207.84,-2908.69 15184.04,-2897.09 15162.63,-2886.65"/>
<polygon fill="black" stroke="black" points="15164.14,-2883.49 15153.61,-2882.26 15161.07,-2889.78 15164.14,-2883.49"/>
</g>
<!-- kv_send3_12_14 -->
<g id="node2353" class="node">
<title>kv_send3_12_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15391" cy="-2765.87" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15391" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="15391" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_12_14&#45;&gt;kv_send3_12_14 -->
<g id="edge3310" class="edge">
<title>ring_stage3_12_14&#45;&gt;kv_send3_12_14</title>
<path fill="none" stroke="black" d="M15391,-2828.76C15391,-2820.71 15391,-2811.68 15391,-2803.06"/>
<polygon fill="black" stroke="black" points="15394.5,-2802.84 15391,-2792.84 15387.5,-2802.84 15394.5,-2802.84"/>
</g>
<!-- ring_stage3_13_14 -->
<g id="node2369" class="node">
<title>ring_stage3_13_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15721,-2792.37 15519,-2792.37 15519,-2739.37 15721,-2739.37 15721,-2792.37"/>
<text text-anchor="middle" x="15620" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="15620" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_1×V_1</text>
<text text-anchor="middle" x="15620" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_12_14&#45;&gt;ring_stage3_13_14 -->
<g id="edge3356" class="edge">
<title>ring_stage3_12_14&#45;&gt;ring_stage3_13_14</title>
<path fill="none" stroke="black" d="M15457.85,-2829C15484.66,-2818.73 15515.71,-2806.83 15543.42,-2796.21"/>
<polygon fill="black" stroke="black" points="15544.98,-2799.36 15553.07,-2792.52 15542.47,-2792.83 15544.98,-2799.36"/>
</g>
<!-- kv_send3_12_15 -->
<g id="node2354" class="node">
<title>kv_send3_12_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13799" cy="-2650" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13799" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="13799" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_12_15&#45;&gt;kv_send3_12_15 -->
<g id="edge3313" class="edge">
<title>ring_stage3_12_15&#45;&gt;kv_send3_12_15</title>
<path fill="none" stroke="black" d="M14428.88,-2741.24C14424.2,-2740.43 14419.56,-2739.67 14415,-2739 14195.03,-2706.51 14131.71,-2756.96 13916,-2703 13894.03,-2697.51 13871.02,-2688.15 13851.28,-2678.88"/>
<polygon fill="black" stroke="black" points="13852.69,-2675.67 13842.16,-2674.49 13849.65,-2681.98 13852.69,-2675.67"/>
</g>
<!-- ring_stage3_13_15 -->
<g id="node2370" class="node">
<title>ring_stage3_13_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14610,-2676.5 14408,-2676.5 14408,-2623.5 14610,-2623.5 14610,-2676.5"/>
<text text-anchor="middle" x="14509" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
<text text-anchor="middle" x="14509" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_2×V_2</text>
<text text-anchor="middle" x="14509" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_12_15&#45;&gt;ring_stage3_13_15 -->
<g id="edge3359" class="edge">
<title>ring_stage3_12_15&#45;&gt;ring_stage3_13_15</title>
<path fill="none" stroke="black" d="M14525.29,-2739.32C14522.44,-2723.89 14518.78,-2704.01 14515.64,-2687.01"/>
<polygon fill="black" stroke="black" points="14519.03,-2686.06 14513.77,-2676.86 14512.14,-2687.33 14519.03,-2686.06"/>
</g>
<!-- kv_send3_12_0&#45;&gt;ring_stage3_13_1 -->
<g id="edge3318" class="edge">
<title>kv_send3_12_0&#45;&gt;ring_stage3_13_1</title>
<path fill="none" stroke="black" d="M13080.89,-2481C13079.95,-2459.09 13078.59,-2427.52 13077.55,-2403.15"/>
<polygon fill="black" stroke="black" points="13081.03,-2402.71 13077.11,-2392.87 13074.04,-2403.01 13081.03,-2402.71"/>
</g>
<!-- kv_send3_12_1&#45;&gt;ring_stage3_13_2 -->
<g id="edge3321" class="edge">
<title>kv_send3_12_1&#45;&gt;ring_stage3_13_2</title>
<path fill="none" stroke="black" d="M12597.7,-2340.93C12561.42,-2317.53 12506.13,-2281.86 12466.47,-2256.27"/>
<polygon fill="black" stroke="black" points="12468.05,-2253.13 12457.75,-2250.65 12464.26,-2259.01 12468.05,-2253.13"/>
</g>
<!-- kv_send3_12_2&#45;&gt;ring_stage3_13_3 -->
<g id="edge3324" class="edge">
<title>kv_send3_12_2&#45;&gt;ring_stage3_13_3</title>
<path fill="none" stroke="black" d="M12234.13,-2199.09C12273.62,-2175.57 12334.1,-2139.54 12377.2,-2113.86"/>
<polygon fill="black" stroke="black" points="12379.05,-2116.83 12385.85,-2108.71 12375.47,-2110.82 12379.05,-2116.83"/>
</g>
<!-- kv_send3_12_3&#45;&gt;ring_stage3_13_4 -->
<g id="edge3327" class="edge">
<title>kv_send3_12_3&#45;&gt;ring_stage3_13_4</title>
<path fill="none" stroke="black" d="M13115.88,-2056.29C13147.88,-2032.97 13196,-1997.88 13230.75,-1972.54"/>
<polygon fill="black" stroke="black" points="13232.81,-1975.36 13238.83,-1966.64 13228.69,-1969.71 13232.81,-1975.36"/>
</g>
<!-- kv_send3_12_4&#45;&gt;ring_stage3_13_5 -->
<g id="edge3330" class="edge">
<title>kv_send3_12_4&#45;&gt;ring_stage3_13_5</title>
<path fill="none" stroke="black" d="M13802.37,-1915.25C13842.45,-1891.68 13904.06,-1855.44 13947.83,-1829.69"/>
<polygon fill="black" stroke="black" points="13949.76,-1832.61 13956.6,-1824.53 13946.21,-1826.58 13949.76,-1832.61"/>
</g>
<!-- kv_send3_12_5&#45;&gt;ring_stage3_13_6 -->
<g id="edge3333" class="edge">
<title>kv_send3_12_5&#45;&gt;ring_stage3_13_6</title>
<path fill="none" stroke="black" d="M14219.49,-1771C14220.74,-1749.09 14222.54,-1717.52 14223.93,-1693.15"/>
<polygon fill="black" stroke="black" points="14227.45,-1693.05 14224.52,-1682.87 14220.46,-1692.65 14227.45,-1693.05"/>
</g>
<!-- kv_send3_12_6&#45;&gt;ring_stage3_13_7 -->
<g id="edge3336" class="edge">
<title>kv_send3_12_6&#45;&gt;ring_stage3_13_7</title>
<path fill="none" stroke="black" d="M14488.79,-1631.41C14530.59,-1607.81 14595.08,-1571.41 14640.79,-1545.6"/>
<polygon fill="black" stroke="black" points="14642.69,-1548.55 14649.67,-1540.59 14639.25,-1542.45 14642.69,-1548.55"/>
</g>
<!-- kv_send3_12_7&#45;&gt;ring_stage3_13_8 -->
<g id="edge3339" class="edge">
<title>kv_send3_12_7&#45;&gt;ring_stage3_13_8</title>
<path fill="none" stroke="black" d="M14960.85,-1488.93C14998.79,-1465.43 15056.69,-1429.56 15098.04,-1403.95"/>
<polygon fill="black" stroke="black" points="15099.94,-1406.89 15106.6,-1398.65 15096.26,-1400.94 15099.94,-1406.89"/>
</g>
<!-- kv_send3_12_8&#45;&gt;ring_stage3_13_9 -->
<g id="edge3342" class="edge">
<title>kv_send3_12_8&#45;&gt;ring_stage3_13_9</title>
<path fill="none" stroke="black" d="M14915.24,-1345C14910.37,-1322.99 14903.34,-1291.24 14897.93,-1266.83"/>
<polygon fill="black" stroke="black" points="14901.31,-1265.87 14895.73,-1256.87 14894.47,-1267.39 14901.31,-1265.87"/>
</g>
<!-- kv_send3_12_9&#45;&gt;ring_stage3_13_10 -->
<g id="edge3345" class="edge">
<title>kv_send3_12_9&#45;&gt;ring_stage3_13_10</title>
<path fill="none" stroke="black" d="M14585.9,-3194.42C14540.68,-3182.58 14481.85,-3167.17 14431.4,-3153.96"/>
<polygon fill="black" stroke="black" points="14431.99,-3150.5 14421.43,-3151.35 14430.21,-3157.27 14431.99,-3150.5"/>
</g>
<!-- kv_send3_12_10&#45;&gt;ring_stage3_13_11 -->
<g id="edge3348" class="edge">
<title>kv_send3_12_10&#45;&gt;ring_stage3_13_11</title>
<path fill="none" stroke="black" d="M13822.11,-3097.98C13820.24,-3089.77 13818.13,-3080.54 13816.13,-3071.76"/>
<polygon fill="black" stroke="black" points="13819.49,-3070.73 13813.85,-3061.76 13812.66,-3072.28 13819.49,-3070.73"/>
</g>
<!-- kv_send3_12_11&#45;&gt;ring_stage3_13_12 -->
<g id="edge3351" class="edge">
<title>kv_send3_12_11&#45;&gt;ring_stage3_13_12</title>
<path fill="none" stroke="black" d="M14144.24,-3016.17C14157.48,-3013.36 14171.11,-3010.6 14184,-3008.22 14289.63,-2988.71 14317.07,-2990.05 14423,-2972.22 14429.12,-2971.19 14435.38,-2970.11 14441.7,-2969.01"/>
<polygon fill="black" stroke="black" points="14442.43,-2972.43 14451.67,-2967.24 14441.21,-2965.54 14442.43,-2972.43"/>
</g>
<!-- kv_send3_12_12&#45;&gt;ring_stage3_13_13 -->
<g id="edge3354" class="edge">
<title>kv_send3_12_12&#45;&gt;ring_stage3_13_13</title>
<path fill="none" stroke="black" d="M15066.44,-2918.5C15071.22,-2909.93 15076.63,-2900.25 15081.72,-2891.14"/>
<polygon fill="black" stroke="black" points="15084.85,-2892.71 15086.67,-2882.28 15078.73,-2889.3 15084.85,-2892.71"/>
</g>
<!-- kv_send3_12_13&#45;&gt;ring_stage3_13_14 -->
<g id="edge3357" class="edge">
<title>kv_send3_12_13&#45;&gt;ring_stage3_13_14</title>
<path fill="none" stroke="black" d="M15620,-2828.29C15620,-2820.25 15620,-2811.27 15620,-2802.71"/>
<polygon fill="black" stroke="black" points="15623.5,-2802.57 15620,-2792.57 15616.5,-2802.57 15623.5,-2802.57"/>
</g>
<!-- kv_send3_12_14&#45;&gt;ring_stage3_13_15 -->
<g id="edge3360" class="edge">
<title>kv_send3_12_14&#45;&gt;ring_stage3_13_15</title>
<path fill="none" stroke="black" d="M15315.15,-2746.36C15301.2,-2743.49 15286.72,-2740.87 15273,-2739 14984.56,-2699.7 14901.18,-2774.54 14619,-2703 14599.65,-2698.09 14579.59,-2689.72 14561.98,-2681.11"/>
<polygon fill="black" stroke="black" points="14563.52,-2677.97 14553.02,-2676.6 14560.38,-2684.22 14563.52,-2677.97"/>
</g>
<!-- kv_send3_12_15&#45;&gt;ring_stage3_13_0 -->
<g id="edge3315" class="edge">
<title>kv_send3_12_15&#45;&gt;ring_stage3_13_0</title>
<path fill="none" stroke="black" d="M13753.28,-2625.72C13706.74,-2602.03 13634.39,-2565.2 13583.43,-2539.26"/>
<polygon fill="black" stroke="black" points="13585,-2536.12 13574.5,-2534.71 13581.82,-2542.36 13585,-2536.12"/>
</g>
<!-- kv_send3_13_0 -->
<g id="node2371" class="node">
<title>kv_send3_13_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13294" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13294" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="13294" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_13_0&#45;&gt;kv_send3_13_0 -->
<g id="edge3316" class="edge">
<title>ring_stage3_13_0&#45;&gt;kv_send3_13_0</title>
<path fill="none" stroke="black" d="M13482.08,-2481.48C13442.53,-2457.41 13383.27,-2421.34 13341.88,-2396.14"/>
<polygon fill="black" stroke="black" points="13343.69,-2393.15 13333.33,-2390.94 13340.05,-2399.13 13343.69,-2393.15"/>
</g>
<!-- ring_stage3_14_0 -->
<g id="node2387" class="node">
<title>ring_stage3_14_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14586.5,-2392.5 14393.5,-2392.5 14393.5,-2339.5 14586.5,-2339.5 14586.5,-2392.5"/>
<text text-anchor="middle" x="14490" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14490" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_2×V_2</text>
<text text-anchor="middle" x="14490" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_13_0&#45;&gt;ring_stage3_14_0 -->
<g id="edge3362" class="edge">
<title>ring_stage3_13_0&#45;&gt;ring_stage3_14_0</title>
<path fill="none" stroke="black" d="M13575.23,-2481.38C13597.88,-2471.28 13625.18,-2460.74 13651,-2455 13969.83,-2384.1 14068.9,-2501.2 14385,-2419 14403.52,-2414.18 14422.61,-2405.88 14439.35,-2397.31"/>
<polygon fill="black" stroke="black" points="14441.18,-2400.31 14448.39,-2392.54 14437.91,-2394.11 14441.18,-2400.31"/>
</g>
<!-- kv_send3_13_1 -->
<g id="node2372" class="node">
<title>kv_send3_13_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13076" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13076" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="13076" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_13_1&#45;&gt;kv_send3_13_1 -->
<g id="edge3319" class="edge">
<title>ring_stage3_13_1&#45;&gt;kv_send3_13_1</title>
<path fill="none" stroke="black" d="M13076,-2339.32C13076,-2317.36 13076,-2285.5 13076,-2260.99"/>
<polygon fill="black" stroke="black" points="13079.5,-2260.99 13076,-2250.99 13072.5,-2260.99 13079.5,-2260.99"/>
</g>
<!-- ring_stage3_14_1 -->
<g id="node2388" class="node">
<title>ring_stage3_14_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13390.5,-2250.5 13197.5,-2250.5 13197.5,-2197.5 13390.5,-2197.5 13390.5,-2250.5"/>
<text text-anchor="middle" x="13294" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="13294" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_3×V_3</text>
<text text-anchor="middle" x="13294" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_13_1&#45;&gt;ring_stage3_14_1 -->
<g id="edge3365" class="edge">
<title>ring_stage3_13_1&#45;&gt;ring_stage3_14_1</title>
<path fill="none" stroke="black" d="M13115.73,-2339.48C13152.27,-2316.02 13206.53,-2281.17 13245.59,-2256.09"/>
<polygon fill="black" stroke="black" points="13247.65,-2258.93 13254.17,-2250.58 13243.87,-2253.04 13247.65,-2258.93"/>
</g>
<!-- kv_send3_13_2 -->
<g id="node2373" class="node">
<title>kv_send3_13_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12211" cy="-2082" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12211" y="-2085.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12211" y="-2070.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_13_2&#45;&gt;kv_send3_13_2 -->
<g id="edge3322" class="edge">
<title>ring_stage3_13_2&#45;&gt;kv_send3_13_2</title>
<path fill="none" stroke="black" d="M12380.03,-2197.32C12344.92,-2173.57 12292.7,-2138.25 12255.61,-2113.17"/>
<polygon fill="black" stroke="black" points="12257.24,-2110.05 12246.99,-2107.34 12253.32,-2115.85 12257.24,-2110.05"/>
</g>
<!-- ring_stage3_14_2 -->
<g id="node2389" class="node">
<title>ring_stage3_14_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12736.5,-2108.5 12543.5,-2108.5 12543.5,-2055.5 12736.5,-2055.5 12736.5,-2108.5"/>
<text text-anchor="middle" x="12640" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="12640" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_4×V_4</text>
<text text-anchor="middle" x="12640" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_13_2&#45;&gt;ring_stage3_14_2 -->
<g id="edge3368" class="edge">
<title>ring_stage3_13_2&#45;&gt;ring_stage3_14_2</title>
<path fill="none" stroke="black" d="M12458.46,-2197.48C12495.74,-2173.97 12551.16,-2139.03 12590.95,-2113.93"/>
<polygon fill="black" stroke="black" points="12592.85,-2116.87 12599.44,-2108.58 12589.12,-2110.95 12592.85,-2116.87"/>
</g>
<!-- kv_send3_13_3 -->
<g id="node2374" class="node">
<title>kv_send3_13_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12707" cy="-1940" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12707" y="-1943.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="12707" y="-1928.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_13_3&#45;&gt;kv_send3_13_3 -->
<g id="edge3325" class="edge">
<title>ring_stage3_13_3&#45;&gt;kv_send3_13_3</title>
<path fill="none" stroke="black" d="M12479.67,-2055.48C12528.32,-2030.98 12601.63,-1994.07 12651.76,-1968.82"/>
<polygon fill="black" stroke="black" points="12653.48,-1971.87 12660.84,-1964.25 12650.33,-1965.62 12653.48,-1971.87"/>
</g>
<!-- ring_stage3_14_3 -->
<g id="node2390" class="node">
<title>ring_stage3_14_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12361.5,-1966.5 12168.5,-1966.5 12168.5,-1913.5 12361.5,-1913.5 12361.5,-1966.5"/>
<text text-anchor="middle" x="12265" y="-1951.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="12265" y="-1936.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_5×V_5</text>
<text text-anchor="middle" x="12265" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_13_3&#45;&gt;ring_stage3_14_3 -->
<g id="edge3371" class="edge">
<title>ring_stage3_13_3&#45;&gt;ring_stage3_14_3</title>
<path fill="none" stroke="black" d="M12398.92,-2055.32C12371.87,-2032.23 12332.02,-1998.21 12302.82,-1973.29"/>
<polygon fill="black" stroke="black" points="12304.77,-1970.35 12294.89,-1966.52 12300.22,-1975.67 12304.77,-1970.35"/>
</g>
<!-- kv_send3_13_4 -->
<g id="node2375" class="node">
<title>kv_send3_13_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13762" cy="-1798" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13762" y="-1801.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="13762" y="-1786.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_13_4&#45;&gt;kv_send3_13_4 -->
<g id="edge3328" class="edge">
<title>ring_stage3_13_4&#45;&gt;kv_send3_13_4</title>
<path fill="none" stroke="black" d="M13362.94,-1913.48C13454.93,-1887.09 13597.12,-1846.3 13684.61,-1821.2"/>
<polygon fill="black" stroke="black" points="13685.83,-1824.49 13694.47,-1818.37 13683.9,-1817.77 13685.83,-1824.49"/>
</g>
<!-- ring_stage3_14_4 -->
<g id="node2391" class="node">
<title>ring_stage3_14_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13318.5,-1824.5 13125.5,-1824.5 13125.5,-1771.5 13318.5,-1771.5 13318.5,-1824.5"/>
<text text-anchor="middle" x="13222" y="-1809.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="13222" y="-1794.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_6×V_6</text>
<text text-anchor="middle" x="13222" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_13_4&#45;&gt;ring_stage3_14_4 -->
<g id="edge3374" class="edge">
<title>ring_stage3_13_4&#45;&gt;ring_stage3_14_4</title>
<path fill="none" stroke="black" d="M13264.46,-1913.32C13256.22,-1891.12 13244.22,-1858.81 13235.08,-1834.2"/>
<polygon fill="black" stroke="black" points="13238.24,-1832.67 13231.48,-1824.52 13231.68,-1835.11 13238.24,-1832.67"/>
</g>
<!-- kv_send3_13_5 -->
<g id="node2376" class="node">
<title>kv_send3_13_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14007" cy="-1656" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14007" y="-1659.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14007" y="-1644.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_13_5&#45;&gt;kv_send3_13_5 -->
<g id="edge3331" class="edge">
<title>ring_stage3_13_5&#45;&gt;kv_send3_13_5</title>
<path fill="none" stroke="black" d="M14001.28,-1771.32C14002.38,-1749.36 14003.97,-1717.5 14005.2,-1692.99"/>
<polygon fill="black" stroke="black" points="14008.7,-1693.15 14005.7,-1682.99 14001.71,-1692.8 14008.7,-1693.15"/>
</g>
<!-- ring_stage3_14_5 -->
<g id="node2392" class="node">
<title>ring_stage3_14_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13858.5,-1682.5 13665.5,-1682.5 13665.5,-1629.5 13858.5,-1629.5 13858.5,-1682.5"/>
<text text-anchor="middle" x="13762" y="-1667.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="13762" y="-1652.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_7×V_7</text>
<text text-anchor="middle" x="13762" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_13_5&#45;&gt;ring_stage3_14_5 -->
<g id="edge3377" class="edge">
<title>ring_stage3_13_5&#45;&gt;ring_stage3_14_5</title>
<path fill="none" stroke="black" d="M13956.62,-1771.48C13916.57,-1747.92 13856.99,-1712.88 13814.32,-1687.77"/>
<polygon fill="black" stroke="black" points="13815.87,-1684.63 13805.48,-1682.58 13812.32,-1690.66 13815.87,-1684.63"/>
</g>
<!-- kv_send3_13_6 -->
<g id="node2377" class="node">
<title>kv_send3_13_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14394" cy="-1514" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14394" y="-1517.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14394" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_13_6&#45;&gt;kv_send3_13_6 -->
<g id="edge3334" class="edge">
<title>ring_stage3_13_6&#45;&gt;kv_send3_13_6</title>
<path fill="none" stroke="black" d="M14256.81,-1629.32C14284.9,-1605.92 14326.46,-1571.28 14356.48,-1546.27"/>
<polygon fill="black" stroke="black" points="14358.79,-1548.9 14364.23,-1539.81 14354.31,-1543.52 14358.79,-1548.9"/>
</g>
<!-- ring_stage3_14_6 -->
<g id="node2393" class="node">
<title>ring_stage3_14_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14218.5,-1540.5 14025.5,-1540.5 14025.5,-1487.5 14218.5,-1487.5 14218.5,-1540.5"/>
<text text-anchor="middle" x="14122" y="-1525.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14122" y="-1510.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_8×V_8</text>
<text text-anchor="middle" x="14122" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_13_6&#45;&gt;ring_stage3_14_6 -->
<g id="edge3380" class="edge">
<title>ring_stage3_13_6&#45;&gt;ring_stage3_14_6</title>
<path fill="none" stroke="black" d="M14206.92,-1629.32C14190.07,-1606.63 14165.36,-1573.37 14146.94,-1548.57"/>
<polygon fill="black" stroke="black" points="14149.73,-1546.46 14140.95,-1540.52 14144.11,-1550.63 14149.73,-1546.46"/>
</g>
<!-- kv_send3_13_7 -->
<g id="node2378" class="node">
<title>kv_send3_13_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14696" cy="-1372" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14696" y="-1375.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="14696" y="-1360.8" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_13_7&#45;&gt;kv_send3_13_7 -->
<g id="edge3337" class="edge">
<title>ring_stage3_13_7&#45;&gt;kv_send3_13_7</title>
<path fill="none" stroke="black" d="M14695.18,-1487.32C14695.34,-1465.36 14695.57,-1433.5 14695.74,-1408.99"/>
<polygon fill="black" stroke="black" points="14699.24,-1409.01 14695.81,-1398.99 14692.24,-1408.96 14699.24,-1409.01"/>
</g>
<!-- ring_stage3_14_7 -->
<g id="node2394" class="node">
<title>ring_stage3_14_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14550.5,-1398.5 14357.5,-1398.5 14357.5,-1345.5 14550.5,-1345.5 14550.5,-1398.5"/>
<text text-anchor="middle" x="14454" y="-1383.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14454" y="-1368.3" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_9×V_9</text>
<text text-anchor="middle" x="14454" y="-1353.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_13_7&#45;&gt;ring_stage3_14_7 -->
<g id="edge3383" class="edge">
<title>ring_stage3_13_7&#45;&gt;ring_stage3_14_7</title>
<path fill="none" stroke="black" d="M14651.08,-1487.48C14610.43,-1463.87 14549.94,-1428.73 14506.71,-1403.62"/>
<polygon fill="black" stroke="black" points="14508.43,-1400.57 14498.03,-1398.58 14504.92,-1406.63 14508.43,-1400.57"/>
</g>
<!-- kv_send3_13_8 -->
<g id="node2379" class="node">
<title>kv_send3_13_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15346" cy="-1230" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15346" y="-1233.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="15346" y="-1218.8" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_13_8&#45;&gt;kv_send3_13_8 -->
<g id="edge3340" class="edge">
<title>ring_stage3_13_8&#45;&gt;kv_send3_13_8</title>
<path fill="none" stroke="black" d="M15184.32,-1345.32C15217.91,-1321.57 15267.85,-1286.25 15303.33,-1261.17"/>
<polygon fill="black" stroke="black" points="15305.43,-1263.97 15311.57,-1255.34 15301.39,-1258.26 15305.43,-1263.97"/>
</g>
<!-- ring_stage3_14_8 -->
<g id="node2395" class="node">
<title>ring_stage3_14_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15224.5,-1256.5 15013.5,-1256.5 15013.5,-1203.5 15224.5,-1203.5 15224.5,-1256.5"/>
<text text-anchor="middle" x="15119" y="-1241.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="15119" y="-1226.3" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_10×V_10</text>
<text text-anchor="middle" x="15119" y="-1211.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_13_8&#45;&gt;ring_stage3_14_8 -->
<g id="edge3386" class="edge">
<title>ring_stage3_13_8&#45;&gt;ring_stage3_14_8</title>
<path fill="none" stroke="black" d="M15142.68,-1345.32C15138.1,-1323.22 15131.45,-1291.1 15126.36,-1266.53"/>
<polygon fill="black" stroke="black" points="15129.74,-1265.6 15124.29,-1256.52 15122.89,-1267.02 15129.74,-1265.6"/>
</g>
<!-- kv_send3_13_9 -->
<g id="node2380" class="node">
<title>kv_send3_13_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14013" cy="-1088" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14013" y="-1091.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14013" y="-1076.8" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_13_9&#45;&gt;kv_send3_13_9 -->
<g id="edge3343" class="edge">
<title>ring_stage3_13_9&#45;&gt;kv_send3_13_9</title>
<path fill="none" stroke="black" d="M14843.85,-1203.42C14823.38,-1193.33 14798.62,-1182.79 14775,-1177 14497,-1108.88 14410.43,-1207.35 14132,-1141 14109.66,-1135.68 14086.25,-1126.36 14066.17,-1117.06"/>
<polygon fill="black" stroke="black" points="14067.43,-1113.79 14056.9,-1112.66 14064.43,-1120.11 14067.43,-1113.79"/>
</g>
<!-- ring_stage3_14_9 -->
<g id="node2396" class="node">
<title>ring_stage3_14_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15232.5,-1114.5 15021.5,-1114.5 15021.5,-1061.5 15232.5,-1061.5 15232.5,-1114.5"/>
<text text-anchor="middle" x="15127" y="-1099.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="15127" y="-1084.3" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_11×V_11</text>
<text text-anchor="middle" x="15127" y="-1069.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_13_9&#45;&gt;ring_stage3_14_9 -->
<g id="edge3389" class="edge">
<title>ring_stage3_13_9&#45;&gt;ring_stage3_14_9</title>
<path fill="none" stroke="black" d="M14933.19,-1203.48C14973.08,-1179.92 15032.4,-1144.88 15074.9,-1119.77"/>
<polygon fill="black" stroke="black" points="15076.87,-1122.68 15083.7,-1114.58 15073.31,-1116.65 15076.87,-1122.68"/>
</g>
<!-- kv_send3_13_10 -->
<g id="node2381" class="node">
<title>kv_send3_13_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14303" cy="-3035.09" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14303" y="-3038.89" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14303" y="-3023.89" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_13_10&#45;&gt;kv_send3_13_10 -->
<g id="edge3346" class="edge">
<title>ring_stage3_13_10&#45;&gt;kv_send3_13_10</title>
<path fill="none" stroke="black" d="M14317.81,-3097.98C14315.87,-3089.84 14313.68,-3080.7 14311.59,-3072"/>
<polygon fill="black" stroke="black" points="14314.95,-3070.97 14309.22,-3062.06 14308.14,-3072.6 14314.95,-3070.97"/>
</g>
<!-- ring_stage3_14_10 -->
<g id="node2397" class="node">
<title>ring_stage3_14_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14120,-972.5 13900,-972.5 13900,-919.5 14120,-919.5 14120,-972.5"/>
<text text-anchor="middle" x="14010" y="-957.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14010" y="-942.3" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_12×V_12</text>
<text text-anchor="middle" x="14010" y="-927.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_13_10&#45;&gt;ring_stage3_14_10 -->
<g id="edge3392" class="edge">
<title>ring_stage3_13_10&#45;&gt;ring_stage3_14_10</title>
<path fill="none" stroke="black" d="M14434.19,-3099.73C14437.16,-3099.13 14440.1,-3098.54 14443,-3097.96 14487.08,-3089.19 14613.19,-3096.45 14642,-3061.96 14657.31,-3043.63 14657.31,-3026.55 14642,-3008.22 14584.38,-2939.24 14507.7,-3034.61 14443,-2972.22 14404.81,-2935.39 14432.46,-2773.31 14392,-2739 14332.17,-2688.28 13741.03,-2759.86 13687,-2703 13670.77,-2685.92 13671.95,-2615.12 13687,-2597 13742.76,-2529.88 13824.07,-2627.97 13880,-2561 13893.57,-2544.75 13884,-1820.17 13884,-1799 13884,-1799 13884,-1799 13884,-1229 13884,-1142.66 13853.62,-1111.31 13894,-1035 13906.47,-1011.43 13928.36,-992.34 13949.79,-978.04"/>
<polygon fill="black" stroke="black" points="13951.75,-980.95 13958.28,-972.6 13947.97,-975.05 13951.75,-980.95"/>
</g>
<!-- kv_send3_13_11 -->
<g id="node2382" class="node">
<title>kv_send3_13_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13807" cy="-2945.35" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13807" y="-2949.15" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13807" y="-2934.15" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_13_11&#45;&gt;kv_send3_13_11 -->
<g id="edge3349" class="edge">
<title>ring_stage3_13_11&#45;&gt;kv_send3_13_11</title>
<path fill="none" stroke="black" d="M13807.71,-3008.24C13807.61,-3000.19 13807.51,-2991.16 13807.41,-2982.54"/>
<polygon fill="black" stroke="black" points="13810.91,-2982.28 13807.3,-2972.32 13803.91,-2982.36 13810.91,-2982.28"/>
</g>
<!-- ring_stage3_14_11 -->
<g id="node2398" class="node">
<title>ring_stage3_14_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14176,-2971.85 13956,-2971.85 13956,-2918.85 14176,-2918.85 14176,-2971.85"/>
<text text-anchor="middle" x="14066" y="-2956.65" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14066" y="-2941.65" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_13×V_13</text>
<text text-anchor="middle" x="14066" y="-2926.65" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_13_11&#45;&gt;ring_stage3_14_11 -->
<g id="edge3395" class="edge">
<title>ring_stage3_13_11&#45;&gt;ring_stage3_14_11</title>
<path fill="none" stroke="black" d="M13883.32,-3008.48C13913.92,-2998.07 13949.42,-2986 13980.94,-2975.28"/>
<polygon fill="black" stroke="black" points="13982.25,-2978.53 13990.59,-2972 13979.99,-2971.9 13982.25,-2978.53"/>
</g>
<!-- kv_send3_13_12 -->
<g id="node2383" class="node">
<title>kv_send3_13_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14557" cy="-2855.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14557" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="14557" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_13_12&#45;&gt;kv_send3_13_12 -->
<g id="edge3352" class="edge">
<title>ring_stage3_13_12&#45;&gt;kv_send3_13_12</title>
<path fill="none" stroke="black" d="M14560.53,-2918.5C14560.07,-2910.45 14559.55,-2901.42 14559.06,-2892.8"/>
<polygon fill="black" stroke="black" points="14562.54,-2892.36 14558.48,-2882.58 14555.55,-2892.76 14562.54,-2892.36"/>
</g>
<!-- ring_stage3_14_12 -->
<g id="node2399" class="node">
<title>ring_stage3_14_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13913,-2882.11 13693,-2882.11 13693,-2829.11 13913,-2829.11 13913,-2882.11"/>
<text text-anchor="middle" x="13803" y="-2866.91" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="13803" y="-2851.91" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_14×V_14</text>
<text text-anchor="middle" x="13803" y="-2836.91" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_13_12&#45;&gt;ring_stage3_14_12 -->
<g id="edge3398" class="edge">
<title>ring_stage3_13_12&#45;&gt;ring_stage3_14_12</title>
<path fill="none" stroke="black" d="M14451.78,-2922.67C14442.07,-2921.11 14432.37,-2919.69 14423,-2918.48 14204.83,-2890.43 14144.72,-2913.57 13923.11,-2882.55"/>
<polygon fill="black" stroke="black" points="13923.51,-2879.07 13913.12,-2881.13 13922.53,-2886 13923.51,-2879.07"/>
</g>
<!-- kv_send3_13_13 -->
<g id="node2384" class="node">
<title>kv_send3_13_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15154" cy="-2765.87" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15154" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="15154" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_13_13&#45;&gt;kv_send3_13_13 -->
<g id="edge3355" class="edge">
<title>ring_stage3_13_13&#45;&gt;kv_send3_13_13</title>
<path fill="none" stroke="black" d="M15116.62,-2828.76C15121.84,-2820.1 15127.76,-2810.31 15133.31,-2801.12"/>
<polygon fill="black" stroke="black" points="15136.32,-2802.9 15138.5,-2792.54 15130.33,-2799.29 15136.32,-2802.9"/>
</g>
<!-- ring_stage3_14_13 -->
<g id="node2400" class="node">
<title>ring_stage3_14_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14978,-2792.37 14758,-2792.37 14758,-2739.37 14978,-2739.37 14978,-2792.37"/>
<text text-anchor="middle" x="14868" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14868" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_15×V_15</text>
<text text-anchor="middle" x="14868" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_13_13&#45;&gt;ring_stage3_14_13 -->
<g id="edge3401" class="edge">
<title>ring_stage3_13_13&#45;&gt;ring_stage3_14_13</title>
<path fill="none" stroke="black" d="M15032.98,-2829C15005.59,-2818.68 14973.84,-2806.73 14945.55,-2796.07"/>
<polygon fill="black" stroke="black" points="14946.7,-2792.76 14936.1,-2792.52 14944.23,-2799.32 14946.7,-2792.76"/>
</g>
<!-- kv_send3_13_14 -->
<g id="node2385" class="node">
<title>kv_send3_13_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14738" cy="-2650" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14738" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="14738" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_13_14&#45;&gt;kv_send3_13_14 -->
<g id="edge3358" class="edge">
<title>ring_stage3_13_14&#45;&gt;kv_send3_13_14</title>
<path fill="none" stroke="black" d="M15518.83,-2740.37C15515.86,-2739.88 15512.91,-2739.42 15510,-2739 15221.86,-2697.52 15139.1,-2770.79 14856,-2703 14833.82,-2697.69 14810.61,-2688.37 14790.7,-2679.08"/>
<polygon fill="black" stroke="black" points="14792.04,-2675.84 14781.5,-2674.68 14789.01,-2682.15 14792.04,-2675.84"/>
</g>
<!-- ring_stage3_14_14 -->
<g id="node2401" class="node">
<title>ring_stage3_14_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15750,-2676.5 15548,-2676.5 15548,-2623.5 15750,-2623.5 15750,-2676.5"/>
<text text-anchor="middle" x="15649" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="15649" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_0×V_0</text>
<text text-anchor="middle" x="15649" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_13_14&#45;&gt;ring_stage3_14_14 -->
<g id="edge3404" class="edge">
<title>ring_stage3_13_14&#45;&gt;ring_stage3_14_14</title>
<path fill="none" stroke="black" d="M15626.51,-2739.32C15630.44,-2723.89 15635.5,-2704.01 15639.83,-2687.01"/>
<polygon fill="black" stroke="black" points="15643.34,-2687.42 15642.41,-2676.86 15636.55,-2685.69 15643.34,-2687.42"/>
</g>
<!-- kv_send3_13_15 -->
<g id="node2386" class="node">
<title>kv_send3_13_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14275" cy="-2508" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14275" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="14275" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_13_15&#45;&gt;kv_send3_13_15 -->
<g id="edge3361" class="edge">
<title>ring_stage3_13_15&#45;&gt;kv_send3_13_15</title>
<path fill="none" stroke="black" d="M14466.35,-2623.48C14426.11,-2599.41 14365.83,-2563.34 14323.71,-2538.14"/>
<polygon fill="black" stroke="black" points="14325.39,-2535.07 14315.01,-2532.94 14321.79,-2541.08 14325.39,-2535.07"/>
</g>
<!-- ring_stage3_14_15 -->
<g id="node2402" class="node">
<title>ring_stage3_14_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15044,-2534.5 14842,-2534.5 14842,-2481.5 15044,-2481.5 15044,-2534.5"/>
<text text-anchor="middle" x="14943" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
<text text-anchor="middle" x="14943" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_1×V_1</text>
<text text-anchor="middle" x="14943" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_13_15&#45;&gt;ring_stage3_14_15 -->
<g id="edge3407" class="edge">
<title>ring_stage3_13_15&#45;&gt;ring_stage3_14_15</title>
<path fill="none" stroke="black" d="M14555.77,-2623.4C14574.89,-2613.87 14597.54,-2603.74 14619,-2597 14711.02,-2568.12 14740.98,-2589.88 14833,-2561 14851.11,-2555.32 14870.06,-2547.22 14887.03,-2539.09"/>
<polygon fill="black" stroke="black" points="14888.79,-2542.13 14896.23,-2534.6 14885.71,-2535.84 14888.79,-2542.13"/>
</g>
<!-- kv_send3_13_0&#45;&gt;ring_stage3_14_1 -->
<g id="edge3366" class="edge">
<title>kv_send3_13_0&#45;&gt;ring_stage3_14_1</title>
<path fill="none" stroke="black" d="M13294,-2339C13294,-2317.09 13294,-2285.52 13294,-2261.15"/>
<polygon fill="black" stroke="black" points="13297.5,-2260.87 13294,-2250.87 13290.5,-2260.87 13297.5,-2260.87"/>
</g>
<!-- kv_send3_13_1&#45;&gt;ring_stage3_14_2 -->
<g id="edge3369" class="edge">
<title>kv_send3_13_1&#45;&gt;ring_stage3_14_2</title>
<path fill="none" stroke="black" d="M13032.67,-2199.53C13012.34,-2189.4 12987.46,-2178.23 12964,-2171 12870.16,-2142.06 12839.52,-2164.94 12746,-2135 12728.54,-2129.41 12710.34,-2121.38 12694.05,-2113.29"/>
<polygon fill="black" stroke="black" points="12695.2,-2109.95 12684.7,-2108.54 12692.03,-2116.19 12695.2,-2109.95"/>
</g>
<!-- kv_send3_13_2&#45;&gt;ring_stage3_14_3 -->
<g id="edge3372" class="edge">
<title>kv_send3_13_2&#45;&gt;ring_stage3_14_3</title>
<path fill="none" stroke="black" d="M12221.03,-2055C12229.56,-2032.89 12241.88,-2000.95 12251.31,-1976.5"/>
<polygon fill="black" stroke="black" points="12254.69,-1977.46 12255.02,-1966.87 12248.16,-1974.94 12254.69,-1977.46"/>
</g>
<!-- kv_send3_13_3&#45;&gt;ring_stage3_14_4 -->
<g id="edge3375" class="edge">
<title>kv_send3_13_3&#45;&gt;ring_stage3_14_4</title>
<path fill="none" stroke="black" d="M12750.1,-1915.48C12770.7,-1905.21 12796.04,-1893.94 12820,-1887 12935.85,-1853.42 12972.21,-1881.18 13089,-1851 13111.27,-1845.24 13134.87,-1836.83 13155.91,-1828.44"/>
<polygon fill="black" stroke="black" points="13157.43,-1831.6 13165.38,-1824.6 13154.8,-1825.11 13157.43,-1831.6"/>
</g>
<!-- kv_send3_13_4&#45;&gt;ring_stage3_14_5 -->
<g id="edge3378" class="edge">
<title>kv_send3_13_4&#45;&gt;ring_stage3_14_5</title>
<path fill="none" stroke="black" d="M13762,-1771C13762,-1749.09 13762,-1717.52 13762,-1693.15"/>
<polygon fill="black" stroke="black" points="13765.5,-1692.87 13762,-1682.87 13758.5,-1692.87 13765.5,-1692.87"/>
</g>
<!-- kv_send3_13_5&#45;&gt;ring_stage3_14_6 -->
<g id="edge3381" class="edge">
<title>kv_send3_13_5&#45;&gt;ring_stage3_14_6</title>
<path fill="none" stroke="black" d="M14027.83,-1629.65C14046.52,-1606.89 14074.08,-1573.34 14094.56,-1548.41"/>
<polygon fill="black" stroke="black" points="14097.3,-1550.59 14100.94,-1540.64 14091.89,-1546.14 14097.3,-1550.59"/>
</g>
<!-- kv_send3_13_6&#45;&gt;ring_stage3_14_7 -->
<g id="edge3384" class="edge">
<title>kv_send3_13_6&#45;&gt;ring_stage3_14_7</title>
<path fill="none" stroke="black" d="M14405.14,-1487C14414.66,-1464.8 14428.43,-1432.67 14438.92,-1408.18"/>
<polygon fill="black" stroke="black" points="14442.19,-1409.44 14442.91,-1398.87 14435.76,-1406.68 14442.19,-1409.44"/>
</g>
<!-- kv_send3_13_7&#45;&gt;ring_stage3_14_8 -->
<g id="edge3387" class="edge">
<title>kv_send3_13_7&#45;&gt;ring_stage3_14_8</title>
<path fill="none" stroke="black" d="M14740.07,-1347.61C14760.55,-1337.55 14785.53,-1326.43 14809,-1319 14893.44,-1292.28 14920.51,-1309.58 15005,-1283 15023.56,-1277.16 15043.06,-1269.06 15060.59,-1260.98"/>
<polygon fill="black" stroke="black" points="15062.54,-1263.93 15070.1,-1256.51 15059.57,-1257.59 15062.54,-1263.93"/>
</g>
<!-- kv_send3_13_8&#45;&gt;ring_stage3_14_9 -->
<g id="edge3390" class="edge">
<title>kv_send3_13_8&#45;&gt;ring_stage3_14_9</title>
<path fill="none" stroke="black" d="M15308.35,-1204.93C15271.67,-1181.48 15215.71,-1145.71 15175.66,-1120.11"/>
<polygon fill="black" stroke="black" points="15177.43,-1117.08 15167.12,-1114.65 15173.66,-1122.98 15177.43,-1117.08"/>
</g>
<!-- kv_send3_13_9&#45;&gt;ring_stage3_14_10 -->
<g id="edge3393" class="edge">
<title>kv_send3_13_9&#45;&gt;ring_stage3_14_10</title>
<path fill="none" stroke="black" d="M14012.44,-1061C14011.97,-1039.09 14011.3,-1007.52 14010.77,-983.15"/>
<polygon fill="black" stroke="black" points="14014.27,-982.79 14010.55,-972.87 14007.27,-982.94 14014.27,-982.79"/>
</g>
<!-- kv_send3_13_10&#45;&gt;ring_stage3_14_11 -->
<g id="edge3396" class="edge">
<title>kv_send3_13_10&#45;&gt;ring_stage3_14_11</title>
<path fill="none" stroke="black" d="M14244.11,-3012.29C14214.04,-3001.16 14177.05,-2987.46 14144.58,-2975.44"/>
<polygon fill="black" stroke="black" points="14145.7,-2972.12 14135.11,-2971.93 14143.27,-2978.69 14145.7,-2972.12"/>
</g>
<!-- kv_send3_13_11&#45;&gt;ring_stage3_14_12 -->
<g id="edge3399" class="edge">
<title>kv_send3_13_11&#45;&gt;ring_stage3_14_12</title>
<path fill="none" stroke="black" d="M13805.8,-2918.03C13805.43,-2909.99 13805.02,-2901.01 13804.63,-2892.45"/>
<polygon fill="black" stroke="black" points="13808.12,-2892.14 13804.17,-2882.31 13801.13,-2892.46 13808.12,-2892.14"/>
</g>
<!-- kv_send3_13_12&#45;&gt;ring_stage3_14_13 -->
<g id="edge3402" class="edge">
<title>kv_send3_13_12&#45;&gt;ring_stage3_14_13</title>
<path fill="none" stroke="black" d="M14627.18,-2834.81C14668.66,-2823.11 14721.87,-2808.1 14767.72,-2795.16"/>
<polygon fill="black" stroke="black" points="14768.71,-2798.52 14777.39,-2792.43 14766.81,-2791.78 14768.71,-2798.52"/>
</g>
<!-- kv_send3_13_13&#45;&gt;ring_stage3_14_14 -->
<g id="edge3405" class="edge">
<title>kv_send3_13_13&#45;&gt;ring_stage3_14_14</title>
<path fill="none" stroke="black" d="M15231.89,-2746.85C15245.24,-2744.03 15258.99,-2741.3 15272,-2739 15389.91,-2718.16 15424.18,-2736.99 15539,-2703 15557.46,-2697.54 15576.71,-2689.37 15593.86,-2681.13"/>
<polygon fill="black" stroke="black" points="15595.72,-2684.11 15603.15,-2676.55 15592.63,-2677.83 15595.72,-2684.11"/>
</g>
<!-- kv_send3_13_14&#45;&gt;ring_stage3_14_15 -->
<g id="edge3408" class="edge">
<title>kv_send3_13_14&#45;&gt;ring_stage3_14_15</title>
<path fill="none" stroke="black" d="M14774.18,-2624.29C14808.34,-2600.97 14859.72,-2565.88 14896.82,-2540.54"/>
<polygon fill="black" stroke="black" points="14899.17,-2543.17 14905.45,-2534.64 14895.22,-2537.39 14899.17,-2543.17"/>
</g>
<!-- kv_send3_13_15&#45;&gt;ring_stage3_14_0 -->
<g id="edge3363" class="edge">
<title>kv_send3_13_15&#45;&gt;ring_stage3_14_0</title>
<path fill="none" stroke="black" d="M14312.45,-2482.61C14348.47,-2459.16 14403.06,-2423.61 14442.2,-2398.13"/>
<polygon fill="black" stroke="black" points="14444.33,-2400.92 14450.8,-2392.53 14440.51,-2395.05 14444.33,-2400.92"/>
</g>
<!-- kv_send3_14_0 -->
<g id="node2403" class="node">
<title>kv_send3_14_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14477" cy="-2224" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14477" y="-2227.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="14477" y="-2212.8" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- ring_stage3_14_0&#45;&gt;kv_send3_14_0 -->
<g id="edge3364" class="edge">
<title>ring_stage3_14_0&#45;&gt;kv_send3_14_0</title>
<path fill="none" stroke="black" d="M14487.62,-2339.32C14485.58,-2317.36 14482.62,-2285.5 14480.34,-2260.99"/>
<polygon fill="black" stroke="black" points="14483.82,-2260.62 14479.41,-2250.99 14476.85,-2261.27 14483.82,-2260.62"/>
</g>
<!-- ring_stage3_15_0 -->
<g id="node2419" class="node">
<title>ring_stage3_15_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15015.5,-2250.5 14822.5,-2250.5 14822.5,-2197.5 15015.5,-2197.5 15015.5,-2250.5"/>
<text text-anchor="middle" x="14919" y="-2235.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14919" y="-2220.3" font-family="Times,serif" font-size="14.00">Compute: Q_0×K_1×V_1</text>
<text text-anchor="middle" x="14919" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_14_0&#45;&gt;ring_stage3_15_0 -->
<g id="edge3410" class="edge">
<title>ring_stage3_14_0&#45;&gt;ring_stage3_15_0</title>
<path fill="none" stroke="black" d="M14537.67,-2339.45C14557.16,-2329.93 14580.2,-2319.79 14602,-2313 14692.83,-2284.72 14722.48,-2306.25 14813,-2277 14830.36,-2271.39 14848.47,-2263.39 14864.7,-2255.35"/>
<polygon fill="black" stroke="black" points="14866.69,-2258.27 14874.02,-2250.62 14863.52,-2252.02 14866.69,-2258.27"/>
</g>
<!-- kv_send3_14_1 -->
<g id="node2404" class="node">
<title>kv_send3_14_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12858" cy="-2082" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12858" y="-2085.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="12858" y="-2070.8" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- ring_stage3_14_1&#45;&gt;kv_send3_14_1 -->
<g id="edge3367" class="edge">
<title>ring_stage3_14_1&#45;&gt;kv_send3_14_1</title>
<path fill="none" stroke="black" d="M13249.3,-2197.46C13230.83,-2187.87 13208.89,-2177.69 13188,-2171 13094.48,-2141.06 13063.84,-2163.94 12970,-2135 12949.93,-2128.81 12928.83,-2119.75 12910.41,-2110.91"/>
<polygon fill="black" stroke="black" points="12911.85,-2107.72 12901.33,-2106.47 12908.77,-2114.01 12911.85,-2107.72"/>
</g>
<!-- ring_stage3_15_1 -->
<g id="node2420" class="node">
<title>ring_stage3_15_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14573.5,-2108.5 14380.5,-2108.5 14380.5,-2055.5 14573.5,-2055.5 14573.5,-2108.5"/>
<text text-anchor="middle" x="14477" y="-2093.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14477" y="-2078.3" font-family="Times,serif" font-size="14.00">Compute: Q_1×K_2×V_2</text>
<text text-anchor="middle" x="14477" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_14_1&#45;&gt;ring_stage3_15_1 -->
<g id="edge3412" class="edge">
<title>ring_stage3_14_1&#45;&gt;ring_stage3_15_1</title>
<path fill="none" stroke="black" d="M13341.23,-2197.49C13362.53,-2187.29 13388.38,-2176.63 13413,-2171 13827.93,-2076.13 13957.07,-2238.23 14370,-2135 14388.94,-2130.27 14408.47,-2121.94 14425.58,-2113.32"/>
<polygon fill="black" stroke="black" points="14427.56,-2116.24 14434.82,-2108.52 14424.34,-2110.03 14427.56,-2116.24"/>
</g>
<!-- kv_send3_14_2 -->
<g id="node2405" class="node">
<title>kv_send3_14_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12483" cy="-1940" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12483" y="-1943.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="12483" y="-1928.8" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- ring_stage3_14_2&#45;&gt;kv_send3_14_2 -->
<g id="edge3370" class="edge">
<title>ring_stage3_14_2&#45;&gt;kv_send3_14_2</title>
<path fill="none" stroke="black" d="M12611.2,-2055.32C12585.15,-2032.09 12546.68,-1997.79 12518.69,-1972.82"/>
<polygon fill="black" stroke="black" points="12520.88,-1970.09 12511.09,-1966.04 12516.22,-1975.31 12520.88,-1970.09"/>
</g>
<!-- ring_stage3_15_2 -->
<g id="node2421" class="node">
<title>ring_stage3_15_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13021.5,-1966.5 12828.5,-1966.5 12828.5,-1913.5 13021.5,-1913.5 13021.5,-1966.5"/>
<text text-anchor="middle" x="12925" y="-1951.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="12925" y="-1936.3" font-family="Times,serif" font-size="14.00">Compute: Q_2×K_3×V_3</text>
<text text-anchor="middle" x="12925" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_14_2&#45;&gt;ring_stage3_15_2 -->
<g id="edge3414" class="edge">
<title>ring_stage3_14_2&#45;&gt;ring_stage3_15_2</title>
<path fill="none" stroke="black" d="M12691.94,-2055.48C12740.41,-2031.68 12812.74,-1996.14 12863.95,-1970.99"/>
<polygon fill="black" stroke="black" points="12865.5,-1974.13 12872.93,-1966.58 12862.42,-1967.84 12865.5,-1974.13"/>
</g>
<!-- kv_send3_14_3 -->
<g id="node2406" class="node">
<title>kv_send3_14_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12265" cy="-1798" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12265" y="-1801.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="12265" y="-1786.8" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- ring_stage3_14_3&#45;&gt;kv_send3_14_3 -->
<g id="edge3373" class="edge">
<title>ring_stage3_14_3&#45;&gt;kv_send3_14_3</title>
<path fill="none" stroke="black" d="M12265,-1913.32C12265,-1891.36 12265,-1859.5 12265,-1834.99"/>
<polygon fill="black" stroke="black" points="12268.5,-1834.99 12265,-1824.99 12261.5,-1834.99 12268.5,-1834.99"/>
</g>
<!-- ring_stage3_15_3 -->
<g id="node2422" class="node">
<title>ring_stage3_15_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12579.5,-1824.5 12386.5,-1824.5 12386.5,-1771.5 12579.5,-1771.5 12579.5,-1824.5"/>
<text text-anchor="middle" x="12483" y="-1809.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="12483" y="-1794.3" font-family="Times,serif" font-size="14.00">Compute: Q_3×K_4×V_4</text>
<text text-anchor="middle" x="12483" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_14_3&#45;&gt;ring_stage3_15_3 -->
<g id="edge3416" class="edge">
<title>ring_stage3_14_3&#45;&gt;ring_stage3_15_3</title>
<path fill="none" stroke="black" d="M12304.73,-1913.48C12341.27,-1890.02 12395.53,-1855.17 12434.59,-1830.09"/>
<polygon fill="black" stroke="black" points="12436.65,-1832.93 12443.17,-1824.58 12432.87,-1827.04 12436.65,-1832.93"/>
</g>
<!-- kv_send3_14_4 -->
<g id="node2407" class="node">
<title>kv_send3_14_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13466" cy="-1656" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13466" y="-1659.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="13466" y="-1644.8" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- ring_stage3_14_4&#45;&gt;kv_send3_14_4 -->
<g id="edge3376" class="edge">
<title>ring_stage3_14_4&#45;&gt;kv_send3_14_4</title>
<path fill="none" stroke="black" d="M13266.47,-1771.48C13308.65,-1747.28 13371.94,-1710.97 13415.89,-1685.75"/>
<polygon fill="black" stroke="black" points="13417.75,-1688.72 13424.68,-1680.71 13414.27,-1682.65 13417.75,-1688.72"/>
</g>
<!-- ring_stage3_15_4 -->
<g id="node2423" class="node">
<title>ring_stage3_15_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13292.5,-1682.5 13099.5,-1682.5 13099.5,-1629.5 13292.5,-1629.5 13292.5,-1682.5"/>
<text text-anchor="middle" x="13196" y="-1667.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="13196" y="-1652.3" font-family="Times,serif" font-size="14.00">Compute: Q_4×K_5×V_5</text>
<text text-anchor="middle" x="13196" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_14_4&#45;&gt;ring_stage3_15_4 -->
<g id="edge3418" class="edge">
<title>ring_stage3_14_4&#45;&gt;ring_stage3_15_4</title>
<path fill="none" stroke="black" d="M13217.23,-1771.32C13213.13,-1749.22 13207.16,-1717.1 13202.6,-1692.53"/>
<polygon fill="black" stroke="black" points="13206.01,-1691.71 13200.74,-1682.52 13199.12,-1692.99 13206.01,-1691.71"/>
</g>
<!-- kv_send3_14_5 -->
<g id="node2408" class="node">
<title>kv_send3_14_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13762" cy="-1514" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13762" y="-1517.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="13762" y="-1502.8" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- ring_stage3_14_5&#45;&gt;kv_send3_14_5 -->
<g id="edge3379" class="edge">
<title>ring_stage3_14_5&#45;&gt;kv_send3_14_5</title>
<path fill="none" stroke="black" d="M13762,-1629.32C13762,-1607.36 13762,-1575.5 13762,-1550.99"/>
<polygon fill="black" stroke="black" points="13765.5,-1550.99 13762,-1540.99 13758.5,-1550.99 13765.5,-1550.99"/>
</g>
<!-- ring_stage3_15_5 -->
<g id="node2424" class="node">
<title>ring_stage3_15_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13620.5,-1540.5 13427.5,-1540.5 13427.5,-1487.5 13620.5,-1487.5 13620.5,-1540.5"/>
<text text-anchor="middle" x="13524" y="-1525.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="13524" y="-1510.3" font-family="Times,serif" font-size="14.00">Compute: Q_5×K_6×V_6</text>
<text text-anchor="middle" x="13524" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_14_5&#45;&gt;ring_stage3_15_5 -->
<g id="edge3420" class="edge">
<title>ring_stage3_14_5&#45;&gt;ring_stage3_15_5</title>
<path fill="none" stroke="black" d="M13718.62,-1629.48C13678.57,-1605.92 13618.99,-1570.88 13576.32,-1545.77"/>
<polygon fill="black" stroke="black" points="13577.87,-1542.63 13567.48,-1540.58 13574.32,-1548.66 13577.87,-1542.63"/>
</g>
<!-- kv_send3_14_6 -->
<g id="node2409" class="node">
<title>kv_send3_14_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14236" cy="-1372" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14236" y="-1375.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14236" y="-1360.8" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- ring_stage3_14_6&#45;&gt;kv_send3_14_6 -->
<g id="edge3382" class="edge">
<title>ring_stage3_14_6&#45;&gt;kv_send3_14_6</title>
<path fill="none" stroke="black" d="M14142.91,-1487.32C14161.39,-1464.63 14188.47,-1431.37 14208.66,-1406.57"/>
<polygon fill="black" stroke="black" points="14211.62,-1408.48 14215.22,-1398.52 14206.19,-1404.06 14211.62,-1408.48"/>
</g>
<!-- ring_stage3_15_6 -->
<g id="node2425" class="node">
<title>ring_stage3_15_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14114.5,-1398.5 13921.5,-1398.5 13921.5,-1345.5 14114.5,-1345.5 14114.5,-1398.5"/>
<text text-anchor="middle" x="14018" y="-1383.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14018" y="-1368.3" font-family="Times,serif" font-size="14.00">Compute: Q_6×K_7×V_7</text>
<text text-anchor="middle" x="14018" y="-1353.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_14_6&#45;&gt;ring_stage3_15_6 -->
<g id="edge3422" class="edge">
<title>ring_stage3_14_6&#45;&gt;ring_stage3_15_6</title>
<path fill="none" stroke="black" d="M14102.92,-1487.32C14086.07,-1464.63 14061.36,-1431.37 14042.94,-1406.57"/>
<polygon fill="black" stroke="black" points="14045.73,-1404.46 14036.95,-1398.52 14040.11,-1408.63 14045.73,-1404.46"/>
</g>
<!-- kv_send3_14_7 -->
<g id="node2410" class="node">
<title>kv_send3_14_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14663" cy="-1230" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14663" y="-1233.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="14663" y="-1218.8" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- ring_stage3_14_7&#45;&gt;kv_send3_14_7 -->
<g id="edge3385" class="edge">
<title>ring_stage3_14_7&#45;&gt;kv_send3_14_7</title>
<path fill="none" stroke="black" d="M14492.33,-1345.32C14527.79,-1321.57 14580.51,-1286.25 14617.96,-1261.17"/>
<polygon fill="black" stroke="black" points="14620.3,-1263.82 14626.66,-1255.34 14616.4,-1258 14620.3,-1263.82"/>
</g>
<!-- ring_stage3_15_7 -->
<g id="node2426" class="node">
<title>ring_stage3_15_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14541.5,-1256.5 14348.5,-1256.5 14348.5,-1203.5 14541.5,-1203.5 14541.5,-1256.5"/>
<text text-anchor="middle" x="14445" y="-1241.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14445" y="-1226.3" font-family="Times,serif" font-size="14.00">Compute: Q_7×K_8×V_8</text>
<text text-anchor="middle" x="14445" y="-1211.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_14_7&#45;&gt;ring_stage3_15_7 -->
<g id="edge3424" class="edge">
<title>ring_stage3_14_7&#45;&gt;ring_stage3_15_7</title>
<path fill="none" stroke="black" d="M14452.35,-1345.32C14450.93,-1323.22 14448.86,-1291.1 14447.28,-1266.53"/>
<polygon fill="black" stroke="black" points="14450.77,-1266.27 14446.64,-1256.52 14443.79,-1266.72 14450.77,-1266.27"/>
</g>
<!-- kv_send3_14_8 -->
<g id="node2411" class="node">
<title>kv_send3_14_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15354" cy="-1088" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15354" y="-1091.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="15354" y="-1076.8" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- ring_stage3_14_8&#45;&gt;kv_send3_14_8 -->
<g id="edge3388" class="edge">
<title>ring_stage3_14_8&#45;&gt;kv_send3_14_8</title>
<path fill="none" stroke="black" d="M15161.83,-1203.48C15202.25,-1179.41 15262.79,-1143.34 15305.08,-1118.14"/>
<polygon fill="black" stroke="black" points="15307.02,-1121.06 15313.82,-1112.94 15303.44,-1115.05 15307.02,-1121.06"/>
</g>
<!-- ring_stage3_15_8 -->
<g id="node2427" class="node">
<title>ring_stage3_15_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15003.5,-1114.5 14810.5,-1114.5 14810.5,-1061.5 15003.5,-1061.5 15003.5,-1114.5"/>
<text text-anchor="middle" x="14907" y="-1099.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14907" y="-1084.3" font-family="Times,serif" font-size="14.00">Compute: Q_8×K_9×V_9</text>
<text text-anchor="middle" x="14907" y="-1069.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_14_8&#45;&gt;ring_stage3_15_8 -->
<g id="edge3426" class="edge">
<title>ring_stage3_14_8&#45;&gt;ring_stage3_15_8</title>
<path fill="none" stroke="black" d="M15080.12,-1203.32C15044.7,-1179.94 14992.31,-1145.34 14954.45,-1120.33"/>
<polygon fill="black" stroke="black" points="14955.91,-1117.11 14945.64,-1114.52 14952.05,-1122.95 14955.91,-1117.11"/>
</g>
<!-- kv_send3_14_9 -->
<g id="node2412" class="node">
<title>kv_send3_14_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14348" cy="-946" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14348" y="-949.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="14348" y="-934.8" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- ring_stage3_14_9&#45;&gt;kv_send3_14_9 -->
<g id="edge3391" class="edge">
<title>ring_stage3_14_9&#45;&gt;kv_send3_14_9</title>
<path fill="none" stroke="black" d="M15080.97,-1061.39C15060.74,-1051.37 15036.31,-1040.87 15013,-1035 14777.18,-975.57 14703.29,-1056.55 14467,-999 14444.78,-993.59 14421.49,-984.3 14401.46,-975.06"/>
<polygon fill="black" stroke="black" points="14402.74,-971.79 14392.2,-970.69 14399.75,-978.12 14402.74,-971.79"/>
</g>
<!-- ring_stage3_15_9 -->
<g id="node2428" class="node">
<title>ring_stage3_15_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15356.5,-972.5 15145.5,-972.5 15145.5,-919.5 15356.5,-919.5 15356.5,-972.5"/>
<text text-anchor="middle" x="15251" y="-957.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="15251" y="-942.3" font-family="Times,serif" font-size="14.00">Compute: Q_9×K_10×V_10</text>
<text text-anchor="middle" x="15251" y="-927.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_14_9&#45;&gt;ring_stage3_15_9 -->
<g id="edge3428" class="edge">
<title>ring_stage3_14_9&#45;&gt;ring_stage3_15_9</title>
<path fill="none" stroke="black" d="M15149.74,-1061.32C15169.93,-1038.53 15199.55,-1005.08 15221.55,-980.25"/>
<polygon fill="black" stroke="black" points="15224.39,-982.32 15228.4,-972.52 15219.15,-977.68 15224.39,-982.32"/>
</g>
<!-- kv_send3_14_10 -->
<g id="node2413" class="node">
<title>kv_send3_14_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14009" cy="-804" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14009" y="-807.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="14009" y="-792.8" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- ring_stage3_14_10&#45;&gt;kv_send3_14_10 -->
<g id="edge3394" class="edge">
<title>ring_stage3_14_10&#45;&gt;kv_send3_14_10</title>
<path fill="none" stroke="black" d="M14009.82,-919.32C14009.66,-897.36 14009.43,-865.5 14009.26,-840.99"/>
<polygon fill="black" stroke="black" points="14012.76,-840.96 14009.19,-830.99 14005.76,-841.01 14012.76,-840.96"/>
</g>
<!-- ring_stage3_15_10 -->
<g id="node2429" class="node">
<title>ring_stage3_15_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14458,-830.5 14238,-830.5 14238,-777.5 14458,-777.5 14458,-830.5"/>
<text text-anchor="middle" x="14348" y="-815.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14348" y="-800.3" font-family="Times,serif" font-size="14.00">Compute: Q_10×K_11×V_11</text>
<text text-anchor="middle" x="14348" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_14_10&#45;&gt;ring_stage3_15_10 -->
<g id="edge3430" class="edge">
<title>ring_stage3_14_10&#45;&gt;ring_stage3_15_10</title>
<path fill="none" stroke="black" d="M14071.6,-919.48C14129.44,-895.53 14215.93,-859.7 14276.72,-834.52"/>
<polygon fill="black" stroke="black" points="14278.35,-837.64 14286.25,-830.58 14275.67,-831.17 14278.35,-837.64"/>
</g>
<!-- kv_send3_14_11 -->
<g id="node2414" class="node">
<title>kv_send3_14_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14041" cy="-2855.61" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="14041" y="-2859.41" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="14041" y="-2844.41" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- ring_stage3_14_11&#45;&gt;kv_send3_14_11 -->
<g id="edge3397" class="edge">
<title>ring_stage3_14_11&#45;&gt;kv_send3_14_11</title>
<path fill="none" stroke="black" d="M14058.63,-2918.5C14056.29,-2910.27 14053.65,-2901.02 14051.15,-2892.23"/>
<polygon fill="black" stroke="black" points="14054.51,-2891.24 14048.4,-2882.58 14047.77,-2893.16 14054.51,-2891.24"/>
</g>
<!-- ring_stage3_15_11 -->
<g id="node2430" class="node">
<title>ring_stage3_15_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14118,-688.5 13898,-688.5 13898,-635.5 14118,-635.5 14118,-688.5"/>
<text text-anchor="middle" x="14008" y="-673.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14008" y="-658.3" font-family="Times,serif" font-size="14.00">Compute: Q_11×K_12×V_12</text>
<text text-anchor="middle" x="14008" y="-643.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_14_11&#45;&gt;ring_stage3_15_11 -->
<g id="edge3432" class="edge">
<title>ring_stage3_14_11&#45;&gt;ring_stage3_15_11</title>
<path fill="none" stroke="black" d="M14176.19,-2920.27C14179.16,-2919.66 14182.1,-2919.06 14185,-2918.48 14228.2,-2909.8 14351.81,-2916.35 14380,-2882.48 14400.4,-2857.97 14402.11,-2761.97 14380,-2739 14307.76,-2663.93 13515.24,-2778.07 13443,-2703 13426.67,-2686.03 13428,-2615.16 13443,-2597 13496.89,-2531.74 13574.44,-2624.85 13630,-2561 13658.34,-2528.43 13640,-2410.17 13640,-2367 13640,-2367 13640,-2367 13640,-1655 13640,-1611.83 13623.77,-1495.29 13650,-1461 13681.25,-1420.14 13725.98,-1463.59 13760,-1425 13961.74,-1196.15 13727.88,-1009.43 13890,-751 13904.57,-727.78 13927.64,-708.57 13949.54,-694.08"/>
<polygon fill="black" stroke="black" points="13951.63,-696.9 13958.17,-688.57 13947.86,-691 13951.63,-696.9"/>
</g>
<!-- kv_send3_14_12 -->
<g id="node2415" class="node">
<title>kv_send3_14_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13799" cy="-2765.87" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13799" y="-2769.67" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="13799" y="-2754.67" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- ring_stage3_14_12&#45;&gt;kv_send3_14_12 -->
<g id="edge3400" class="edge">
<title>ring_stage3_14_12&#45;&gt;kv_send3_14_12</title>
<path fill="none" stroke="black" d="M13801.82,-2828.76C13801.45,-2820.71 13801.04,-2811.68 13800.65,-2803.06"/>
<polygon fill="black" stroke="black" points="13804.14,-2802.67 13800.18,-2792.84 13797.14,-2802.99 13804.14,-2802.67"/>
</g>
<!-- ring_stage3_15_12 -->
<g id="node2431" class="node">
<title>ring_stage3_15_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14147,-2792.37 13927,-2792.37 13927,-2739.37 14147,-2739.37 14147,-2792.37"/>
<text text-anchor="middle" x="14037" y="-2777.17" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14037" y="-2762.17" font-family="Times,serif" font-size="14.00">Compute: Q_12×K_13×V_13</text>
<text text-anchor="middle" x="14037" y="-2747.17" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_14_12&#45;&gt;ring_stage3_15_12 -->
<g id="edge3434" class="edge">
<title>ring_stage3_14_12&#45;&gt;ring_stage3_15_12</title>
<path fill="none" stroke="black" d="M13871.31,-2829C13898.82,-2818.68 13930.71,-2806.73 13959.11,-2796.07"/>
<polygon fill="black" stroke="black" points="13960.47,-2799.3 13968.6,-2792.52 13958.01,-2792.75 13960.47,-2799.3"/>
</g>
<!-- kv_send3_14_13 -->
<g id="node2416" class="node">
<title>kv_send3_14_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15420" cy="-2650" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15420" y="-2653.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="15420" y="-2638.8" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- ring_stage3_14_13&#45;&gt;kv_send3_14_13 -->
<g id="edge3403" class="edge">
<title>ring_stage3_14_13&#45;&gt;kv_send3_14_13</title>
<path fill="none" stroke="black" d="M14978.45,-2747.45C14997.3,-2744.56 15016.71,-2741.65 15035,-2739 15153.5,-2721.83 15186.74,-2735.46 15302,-2703 15323.39,-2696.97 15345.94,-2687.8 15365.53,-2678.83"/>
<polygon fill="black" stroke="black" points="15367.02,-2682 15374.6,-2674.6 15364.05,-2675.66 15367.02,-2682"/>
</g>
<!-- ring_stage3_15_13 -->
<g id="node2432" class="node">
<title>ring_stage3_15_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14390,-2676.5 14170,-2676.5 14170,-2623.5 14390,-2623.5 14390,-2676.5"/>
<text text-anchor="middle" x="14280" y="-2661.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="14280" y="-2646.3" font-family="Times,serif" font-size="14.00">Compute: Q_13×K_14×V_14</text>
<text text-anchor="middle" x="14280" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_14_13&#45;&gt;ring_stage3_15_13 -->
<g id="edge3436" class="edge">
<title>ring_stage3_14_13&#45;&gt;ring_stage3_15_13</title>
<path fill="none" stroke="black" d="M14757.62,-2748.67C14734.62,-2745.39 14710.53,-2742.02 14688,-2739 14559.71,-2721.79 14523.82,-2737.27 14399,-2703 14378.91,-2697.49 14357.82,-2689.18 14339.08,-2680.81"/>
<polygon fill="black" stroke="black" points="14340.34,-2677.54 14329.79,-2676.58 14337.44,-2683.91 14340.34,-2677.54"/>
</g>
<!-- kv_send3_14_14 -->
<g id="node2417" class="node">
<title>kv_send3_14_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15177" cy="-2508" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="15177" y="-2511.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="15177" y="-2496.8" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- ring_stage3_14_14&#45;&gt;kv_send3_14_14 -->
<g id="edge3406" class="edge">
<title>ring_stage3_14_14&#45;&gt;kv_send3_14_14</title>
<path fill="none" stroke="black" d="M15602.84,-2623.46C15583.61,-2613.81 15560.73,-2603.59 15539,-2597 15434.52,-2565.33 15400.94,-2591.12 15296,-2561 15274.49,-2554.82 15251.76,-2545.62 15232,-2536.66"/>
<polygon fill="black" stroke="black" points="15233.4,-2533.45 15222.85,-2532.44 15230.46,-2539.81 15233.4,-2533.45"/>
</g>
<!-- ring_stage3_15_14 -->
<g id="node2433" class="node">
<title>ring_stage3_15_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15749,-2534.5 15529,-2534.5 15529,-2481.5 15749,-2481.5 15749,-2534.5"/>
<text text-anchor="middle" x="15639" y="-2519.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="15639" y="-2504.3" font-family="Times,serif" font-size="14.00">Compute: Q_14×K_15×V_15</text>
<text text-anchor="middle" x="15639" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_14_14&#45;&gt;ring_stage3_15_14 -->
<g id="edge3438" class="edge">
<title>ring_stage3_14_14&#45;&gt;ring_stage3_15_14</title>
<path fill="none" stroke="black" d="M15647.17,-2623.32C15645.59,-2601.22 15643.29,-2569.1 15641.54,-2544.53"/>
<polygon fill="black" stroke="black" points="15645.03,-2544.24 15640.82,-2534.52 15638.04,-2544.74 15645.03,-2544.24"/>
</g>
<!-- kv_send3_14_15 -->
<g id="node2418" class="node">
<title>kv_send3_14_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14941" cy="-2366" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14941" y="-2369.8" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="14941" y="-2354.8" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- ring_stage3_14_15&#45;&gt;kv_send3_14_15 -->
<g id="edge3409" class="edge">
<title>ring_stage3_14_15&#45;&gt;kv_send3_14_15</title>
<path fill="none" stroke="black" d="M14942.63,-2481.32C14942.32,-2459.36 14941.86,-2427.5 14941.51,-2402.99"/>
<polygon fill="black" stroke="black" points="14945.01,-2402.94 14941.37,-2392.99 14938.01,-2403.04 14945.01,-2402.94"/>
</g>
<!-- ring_stage3_15_15 -->
<g id="node2434" class="node">
<title>ring_stage3_15_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15278,-2392.5 15076,-2392.5 15076,-2339.5 15278,-2339.5 15278,-2392.5"/>
<text text-anchor="middle" x="15177" y="-2377.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
<text text-anchor="middle" x="15177" y="-2362.3" font-family="Times,serif" font-size="14.00">Compute: Q_15×K_0×V_0</text>
<text text-anchor="middle" x="15177" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_14_15&#45;&gt;ring_stage3_15_15 -->
<g id="edge3440" class="edge">
<title>ring_stage3_14_15&#45;&gt;ring_stage3_15_15</title>
<path fill="none" stroke="black" d="M14985.65,-2481.48C15025.03,-2457.92 15083.6,-2422.88 15125.56,-2397.77"/>
<polygon fill="black" stroke="black" points="15127.47,-2400.71 15134.25,-2392.58 15123.87,-2394.71 15127.47,-2400.71"/>
</g>
<!-- kv_send3_14_0&#45;&gt;ring_stage3_15_1 -->
<g id="edge3413" class="edge">
<title>kv_send3_14_0&#45;&gt;ring_stage3_15_1</title>
<path fill="none" stroke="black" d="M14477,-2197C14477,-2175.09 14477,-2143.52 14477,-2119.15"/>
<polygon fill="black" stroke="black" points="14480.5,-2118.87 14477,-2108.87 14473.5,-2118.87 14480.5,-2118.87"/>
</g>
<!-- kv_send3_14_1&#45;&gt;ring_stage3_15_2 -->
<g id="edge3415" class="edge">
<title>kv_send3_14_1&#45;&gt;ring_stage3_15_2</title>
<path fill="none" stroke="black" d="M12870.45,-2055C12881.07,-2032.8 12896.44,-2000.67 12908.17,-1976.18"/>
<polygon fill="black" stroke="black" points="12911.46,-1977.4 12912.62,-1966.87 12905.15,-1974.37 12911.46,-1977.4"/>
</g>
<!-- kv_send3_14_2&#45;&gt;ring_stage3_15_3 -->
<g id="edge3417" class="edge">
<title>kv_send3_14_2&#45;&gt;ring_stage3_15_3</title>
<path fill="none" stroke="black" d="M12483,-1913C12483,-1891.09 12483,-1859.52 12483,-1835.15"/>
<polygon fill="black" stroke="black" points="12486.5,-1834.87 12483,-1824.87 12479.5,-1834.87 12486.5,-1834.87"/>
</g>
<!-- kv_send3_14_3&#45;&gt;ring_stage3_15_4 -->
<g id="edge3419" class="edge">
<title>kv_send3_14_3&#45;&gt;ring_stage3_15_4</title>
<path fill="none" stroke="black" d="M12306.53,-1773.26C12327.31,-1762.6 12353.25,-1751.08 12378,-1745 12684.83,-1669.6 12781.84,-1787.08 13088,-1709 13106.97,-1704.16 13126.58,-1695.86 13143.8,-1687.29"/>
<polygon fill="black" stroke="black" points="13145.8,-1690.2 13153.11,-1682.52 13142.61,-1683.97 13145.8,-1690.2"/>
</g>
<!-- kv_send3_14_4&#45;&gt;ring_stage3_15_5 -->
<g id="edge3421" class="edge">
<title>kv_send3_14_4&#45;&gt;ring_stage3_15_5</title>
<path fill="none" stroke="black" d="M13476.77,-1629C13485.97,-1606.8 13499.28,-1574.67 13509.43,-1550.18"/>
<polygon fill="black" stroke="black" points="13512.69,-1551.44 13513.28,-1540.87 13506.22,-1548.76 13512.69,-1551.44"/>
</g>
<!-- kv_send3_14_5&#45;&gt;ring_stage3_15_6 -->
<g id="edge3423" class="edge">
<title>kv_send3_14_5&#45;&gt;ring_stage3_15_6</title>
<path fill="none" stroke="black" d="M13805.14,-1489.41C13848.38,-1465.76 13915.13,-1429.26 13962.34,-1403.44"/>
<polygon fill="black" stroke="black" points="13964.12,-1406.46 13971.21,-1398.59 13960.76,-1400.31 13964.12,-1406.46"/>
</g>
<!-- kv_send3_14_6&#45;&gt;ring_stage3_15_7 -->
<g id="edge3425" class="edge">
<title>kv_send3_14_6&#45;&gt;ring_stage3_15_7</title>
<path fill="none" stroke="black" d="M14272.41,-1346.61C14307.42,-1323.16 14360.49,-1287.61 14398.53,-1262.13"/>
<polygon fill="black" stroke="black" points="14400.53,-1265 14406.89,-1256.53 14396.64,-1259.18 14400.53,-1265"/>
</g>
<!-- kv_send3_14_7&#45;&gt;ring_stage3_15_8 -->
<g id="edge3427" class="edge">
<title>kv_send3_14_7&#45;&gt;ring_stage3_15_8</title>
<path fill="none" stroke="black" d="M14704.39,-1205.25C14745.56,-1181.63 14808.91,-1145.28 14853.79,-1119.53"/>
<polygon fill="black" stroke="black" points="14855.58,-1122.54 14862.51,-1114.53 14852.09,-1116.47 14855.58,-1122.54"/>
</g>
<!-- kv_send3_14_8&#45;&gt;ring_stage3_15_9 -->
<g id="edge3429" class="edge">
<title>kv_send3_14_8&#45;&gt;ring_stage3_15_9</title>
<path fill="none" stroke="black" d="M15335.11,-1061.32C15318.41,-1038.63 15293.95,-1005.37 15275.7,-980.57"/>
<polygon fill="black" stroke="black" points="15278.52,-978.5 15269.77,-972.52 15272.88,-982.64 15278.52,-978.5"/>
</g>
<!-- kv_send3_14_9&#45;&gt;ring_stage3_15_10 -->
<g id="edge3431" class="edge">
<title>kv_send3_14_9&#45;&gt;ring_stage3_15_10</title>
<path fill="none" stroke="black" d="M14348,-919C14348,-897.09 14348,-865.52 14348,-841.15"/>
<polygon fill="black" stroke="black" points="14351.5,-840.87 14348,-830.87 14344.5,-840.87 14351.5,-840.87"/>
</g>
<!-- kv_send3_14_10&#45;&gt;ring_stage3_15_11 -->
<g id="edge3433" class="edge">
<title>kv_send3_14_10&#45;&gt;ring_stage3_15_11</title>
<path fill="none" stroke="black" d="M14008.81,-777C14008.66,-755.09 14008.43,-723.52 14008.26,-699.15"/>
<polygon fill="black" stroke="black" points="14011.76,-698.84 14008.18,-688.87 14004.76,-698.89 14011.76,-698.84"/>
</g>
<!-- kv_send3_14_11&#45;&gt;ring_stage3_15_12 -->
<g id="edge3435" class="edge">
<title>kv_send3_14_11&#45;&gt;ring_stage3_15_12</title>
<path fill="none" stroke="black" d="M14039.8,-2828.29C14039.43,-2820.25 14039.02,-2811.27 14038.63,-2802.71"/>
<polygon fill="black" stroke="black" points="14042.12,-2802.4 14038.17,-2792.57 14035.13,-2802.72 14042.12,-2802.4"/>
</g>
<!-- kv_send3_14_12&#45;&gt;ring_stage3_15_13 -->
<g id="edge3437" class="edge">
<title>kv_send3_14_12&#45;&gt;ring_stage3_15_13</title>
<path fill="none" stroke="black" d="M13877.58,-2747.01C13891.04,-2744.17 13904.9,-2741.39 13918,-2739 14025.4,-2719.39 14056.06,-2733.12 14161,-2703 14180.84,-2697.31 14201.7,-2689.04 14220.32,-2680.76"/>
<polygon fill="black" stroke="black" points="14221.89,-2683.89 14229.55,-2676.58 14219,-2677.52 14221.89,-2683.89"/>
</g>
<!-- kv_send3_14_13&#45;&gt;ring_stage3_15_14 -->
<g id="edge3439" class="edge">
<title>kv_send3_14_13&#45;&gt;ring_stage3_15_14</title>
<path fill="none" stroke="black" d="M15458.15,-2624.61C15494.91,-2601.11 15550.68,-2565.46 15590.56,-2539.96"/>
<polygon fill="black" stroke="black" points="15592.53,-2542.86 15599.07,-2534.53 15588.76,-2536.96 15592.53,-2542.86"/>
</g>
<!-- kv_send3_14_14&#45;&gt;ring_stage3_15_15 -->
<g id="edge3441" class="edge">
<title>kv_send3_14_14&#45;&gt;ring_stage3_15_15</title>
<path fill="none" stroke="black" d="M15177,-2481C15177,-2459.09 15177,-2427.52 15177,-2403.15"/>
<polygon fill="black" stroke="black" points="15180.5,-2402.87 15177,-2392.87 15173.5,-2402.87 15180.5,-2402.87"/>
</g>
<!-- kv_send3_14_15&#45;&gt;ring_stage3_15_0 -->
<g id="edge3411" class="edge">
<title>kv_send3_14_15&#45;&gt;ring_stage3_15_0</title>
<path fill="none" stroke="black" d="M14936.91,-2339C14933.46,-2316.99 14928.47,-2285.24 14924.63,-2260.83"/>
<polygon fill="black" stroke="black" points="14928.07,-2260.2 14923.06,-2250.87 14921.16,-2261.29 14928.07,-2260.2"/>
</g>
<!-- accum3_0 -->
<g id="node2451" class="node">
<title>accum3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15423.64,-2135 15083.79,-2135 14996.36,-2029 15336.21,-2029 15423.64,-2135"/>
<text text-anchor="middle" x="15210" y="-2093.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="15210" y="-2078.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15210" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ring_stage3_15_0&#45;&gt;accum3_0 -->
<g id="edge3442" class="edge">
<title>ring_stage3_15_0&#45;&gt;accum3_0</title>
<path fill="none" stroke="black" d="M14970.18,-2197.43C14987.26,-2188.95 15006.42,-2179.51 15024,-2171 15045.34,-2160.67 15068.11,-2149.78 15090.14,-2139.32"/>
<polygon fill="black" stroke="black" points="15091.66,-2142.47 15099.2,-2135.02 15088.66,-2136.15 15091.66,-2142.47"/>
</g>
<!-- accum3_1 -->
<g id="node2452" class="node">
<title>accum3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15023.64,-1993 14683.79,-1993 14596.36,-1887 14936.21,-1887 15023.64,-1993"/>
<text text-anchor="middle" x="14810" y="-1951.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14810" y="-1936.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14810" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ring_stage3_15_1&#45;&gt;accum3_1 -->
<g id="edge3451" class="edge">
<title>ring_stage3_15_1&#45;&gt;accum3_1</title>
<path fill="none" stroke="black" d="M14537.69,-2055.48C14576.64,-2039.11 14628.78,-2017.19 14677,-1996.91"/>
<polygon fill="black" stroke="black" points="14678.41,-2000.12 14686.27,-1993.02 14675.7,-1993.67 14678.41,-2000.12"/>
</g>
<!-- accum3_2 -->
<g id="node2453" class="node">
<title>accum3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13079.64,-1851 12739.79,-1851 12652.36,-1745 12992.21,-1745 13079.64,-1851"/>
<text text-anchor="middle" x="12866" y="-1809.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="12866" y="-1794.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12866" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ring_stage3_15_2&#45;&gt;accum3_2 -->
<g id="edge3460" class="edge">
<title>ring_stage3_15_2&#45;&gt;accum3_2</title>
<path fill="none" stroke="black" d="M12914.18,-1913.32C12907.92,-1898.47 12899.75,-1879.08 12891.92,-1860.51"/>
<polygon fill="black" stroke="black" points="12895.1,-1859.05 12888,-1851.19 12888.65,-1861.77 12895.1,-1859.05"/>
</g>
<!-- accum3_3 -->
<g id="node2454" class="node">
<title>accum3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13078.64,-1709 12738.79,-1709 12651.36,-1603 12991.21,-1603 13078.64,-1709"/>
<text text-anchor="middle" x="12865" y="-1667.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="12865" y="-1652.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12865" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ring_stage3_15_3&#45;&gt;accum3_3 -->
<g id="edge3469" class="edge">
<title>ring_stage3_15_3&#45;&gt;accum3_3</title>
<path fill="none" stroke="black" d="M12552.62,-1771.48C12600.73,-1753.85 12666.38,-1729.79 12725.08,-1708.28"/>
<polygon fill="black" stroke="black" points="12726.63,-1711.44 12734.82,-1704.71 12724.22,-1704.87 12726.63,-1711.44"/>
</g>
<!-- accum3_4 -->
<g id="node2455" class="node">
<title>accum3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13409.64,-1567 13069.79,-1567 12982.36,-1461 13322.21,-1461 13409.64,-1567"/>
<text text-anchor="middle" x="13196" y="-1525.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="13196" y="-1510.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13196" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ring_stage3_15_4&#45;&gt;accum3_4 -->
<g id="edge3478" class="edge">
<title>ring_stage3_15_4&#45;&gt;accum3_4</title>
<path fill="none" stroke="black" d="M13196,-1629.32C13196,-1614.67 13196,-1595.61 13196,-1577.28"/>
<polygon fill="black" stroke="black" points="13199.5,-1577.19 13196,-1567.19 13192.5,-1577.19 13199.5,-1577.19"/>
</g>
<!-- accum3_5 -->
<g id="node2456" class="node">
<title>accum3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13750.64,-1425 13410.79,-1425 13323.36,-1319 13663.21,-1319 13750.64,-1425"/>
<text text-anchor="middle" x="13537" y="-1383.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="13537" y="-1368.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13537" y="-1353.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ring_stage3_15_5&#45;&gt;accum3_5 -->
<g id="edge3487" class="edge">
<title>ring_stage3_15_5&#45;&gt;accum3_5</title>
<path fill="none" stroke="black" d="M13526.38,-1487.32C13527.75,-1472.67 13529.51,-1453.61 13531.22,-1435.28"/>
<polygon fill="black" stroke="black" points="13534.71,-1435.47 13532.15,-1425.19 13527.74,-1434.83 13534.71,-1435.47"/>
</g>
<!-- accum3_6 -->
<g id="node2457" class="node">
<title>accum3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14330.64,-1283 13990.79,-1283 13903.36,-1177 14243.21,-1177 14330.64,-1283"/>
<text text-anchor="middle" x="14117" y="-1241.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14117" y="-1226.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14117" y="-1211.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ring_stage3_15_6&#45;&gt;accum3_6 -->
<g id="edge3496" class="edge">
<title>ring_stage3_15_6&#45;&gt;accum3_6</title>
<path fill="none" stroke="black" d="M14036.16,-1345.32C14046.86,-1330.19 14060.87,-1310.37 14074.22,-1291.49"/>
<polygon fill="black" stroke="black" points="14077.18,-1293.38 14080.09,-1283.19 14071.46,-1289.34 14077.18,-1293.38"/>
</g>
<!-- accum3_7 -->
<g id="node2458" class="node">
<title>accum3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14792.64,-1141 14452.79,-1141 14365.36,-1035 14705.21,-1035 14792.64,-1141"/>
<text text-anchor="middle" x="14579" y="-1099.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14579" y="-1084.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14579" y="-1069.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ring_stage3_15_7&#45;&gt;accum3_7 -->
<g id="edge3505" class="edge">
<title>ring_stage3_15_7&#45;&gt;accum3_7</title>
<path fill="none" stroke="black" d="M14469.58,-1203.32C14484.32,-1187.92 14503.71,-1167.66 14522.07,-1148.48"/>
<polygon fill="black" stroke="black" points="14524.66,-1150.84 14529.04,-1141.19 14519.6,-1146 14524.66,-1150.84"/>
</g>
<!-- accum3_8 -->
<g id="node2459" class="node">
<title>accum3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15127.64,-999 14787.79,-999 14700.36,-893 15040.21,-893 15127.64,-999"/>
<text text-anchor="middle" x="14914" y="-957.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14914" y="-942.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14914" y="-927.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ring_stage3_15_8&#45;&gt;accum3_8 -->
<g id="edge3514" class="edge">
<title>ring_stage3_15_8&#45;&gt;accum3_8</title>
<path fill="none" stroke="black" d="M14908.28,-1061.32C14909.02,-1046.67 14909.97,-1027.61 14910.89,-1009.28"/>
<polygon fill="black" stroke="black" points="14914.39,-1009.36 14911.39,-999.19 14907.4,-1009.01 14914.39,-1009.36"/>
</g>
<!-- accum3_9 -->
<g id="node2460" class="node">
<title>accum3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15183.64,-857 14843.79,-857 14756.36,-751 15096.21,-751 15183.64,-857"/>
<text text-anchor="middle" x="14970" y="-815.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14970" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14970" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ring_stage3_15_9&#45;&gt;accum3_9 -->
<g id="edge3523" class="edge">
<title>ring_stage3_15_9&#45;&gt;accum3_9</title>
<path fill="none" stroke="black" d="M15199.79,-919.48C15167.26,-903.28 15123.84,-881.65 15083.5,-861.55"/>
<polygon fill="black" stroke="black" points="15084.92,-858.34 15074.41,-857.02 15081.8,-864.61 15084.92,-858.34"/>
</g>
<!-- accum3_10 -->
<g id="node2461" class="node">
<title>accum3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14563.64,-715 14223.79,-715 14136.36,-609 14476.21,-609 14563.64,-715"/>
<text text-anchor="middle" x="14350" y="-673.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14350" y="-658.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14350" y="-643.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ring_stage3_15_10&#45;&gt;accum3_10 -->
<g id="edge3532" class="edge">
<title>ring_stage3_15_10&#45;&gt;accum3_10</title>
<path fill="none" stroke="black" d="M14348.37,-777.32C14348.58,-762.67 14348.85,-743.61 14349.11,-725.28"/>
<polygon fill="black" stroke="black" points="14352.61,-725.24 14349.25,-715.19 14345.61,-725.14 14352.61,-725.24"/>
</g>
<!-- accum3_11 -->
<g id="node2462" class="node">
<title>accum3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14569.64,-570 14229.79,-570 14142.36,-464 14482.21,-464 14569.64,-570"/>
<text text-anchor="middle" x="14356" y="-528.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14356" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14356" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ring_stage3_15_11&#45;&gt;accum3_11 -->
<g id="edge3541" class="edge">
<title>ring_stage3_15_11&#45;&gt;accum3_11</title>
<path fill="none" stroke="black" d="M14065.33,-635.48C14084.84,-626.92 14106.82,-617.42 14127,-609 14156.52,-596.69 14188.33,-583.81 14218.58,-571.74"/>
<polygon fill="black" stroke="black" points="14219.91,-574.97 14227.91,-568.02 14217.32,-568.47 14219.91,-574.97"/>
</g>
<!-- accum3_12 -->
<g id="node2463" class="node">
<title>accum3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15292.64,-2703 14952.79,-2703 14865.36,-2597 15205.21,-2597 15292.64,-2703"/>
<text text-anchor="middle" x="15079" y="-2661.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="15079" y="-2646.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15079" y="-2631.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ring_stage3_15_12&#45;&gt;accum3_12 -->
<g id="edge3550" class="edge">
<title>ring_stage3_15_12&#45;&gt;accum3_12</title>
<path fill="none" stroke="black" d="M14147.11,-2740.27C14150.1,-2739.82 14153.07,-2739.39 14156,-2739 14465.22,-2697.73 14548.12,-2746.75 14857,-2703 14880.77,-2699.63 14905.73,-2694.94 14930,-2689.75"/>
<polygon fill="black" stroke="black" points="14930.95,-2693.12 14939.98,-2687.57 14929.46,-2686.28 14930.95,-2693.12"/>
</g>
<!-- accum3_13 -->
<g id="node2464" class="node">
<title>accum3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14823.64,-2561 14483.79,-2561 14396.36,-2455 14736.21,-2455 14823.64,-2561"/>
<text text-anchor="middle" x="14610" y="-2519.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="14610" y="-2504.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14610" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ring_stage3_15_13&#45;&gt;accum3_13 -->
<g id="edge3559" class="edge">
<title>ring_stage3_15_13&#45;&gt;accum3_13</title>
<path fill="none" stroke="black" d="M14338.02,-2623.41C14357.38,-2614.94 14379.09,-2605.5 14399,-2597 14423.54,-2586.52 14449.75,-2575.47 14475.06,-2564.88"/>
<polygon fill="black" stroke="black" points="14476.46,-2568.09 14484.33,-2561 14473.76,-2561.63 14476.46,-2568.09"/>
</g>
<!-- accum3_14 -->
<g id="node2465" class="node">
<title>accum3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15809.64,-2419 15469.79,-2419 15382.36,-2313 15722.21,-2313 15809.64,-2419"/>
<text text-anchor="middle" x="15596" y="-2377.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="15596" y="-2362.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15596" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ring_stage3_15_14&#45;&gt;accum3_14 -->
<g id="edge3568" class="edge">
<title>ring_stage3_15_14&#45;&gt;accum3_14</title>
<path fill="none" stroke="black" d="M15631.11,-2481.32C15626.57,-2466.53 15620.65,-2447.26 15614.97,-2428.77"/>
<polygon fill="black" stroke="black" points="15618.31,-2427.72 15612.03,-2419.19 15611.62,-2429.78 15618.31,-2427.72"/>
</g>
<!-- accum3_15 -->
<g id="node2466" class="node">
<title>accum3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15460.64,-2277 15120.79,-2277 15033.36,-2171 15373.21,-2171 15460.64,-2277"/>
<text text-anchor="middle" x="15247" y="-2235.3" font-family="Times,serif" font-size="14.00">Accumulate Results</text>
<text text-anchor="middle" x="15247" y="-2220.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15247" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ring_stage3_15_15&#45;&gt;accum3_15 -->
<g id="edge3577" class="edge">
<title>ring_stage3_15_15&#45;&gt;accum3_15</title>
<path fill="none" stroke="black" d="M15189.84,-2339.32C15197.3,-2324.4 15207.05,-2304.91 15216.37,-2286.26"/>
<polygon fill="black" stroke="black" points="15219.56,-2287.7 15220.9,-2277.19 15213.3,-2284.57 15219.56,-2287.7"/>
</g>
<!-- kv_send3_15_0 -->
<g id="node2435" class="node">
<title>kv_send3_15_0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15502" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15502" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 1</text>
<text text-anchor="middle" x="15502" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 0→1</text>
</g>
<!-- kv_send3_15_1 -->
<g id="node2436" class="node">
<title>kv_send3_15_1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15278" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15278" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 2</text>
<text text-anchor="middle" x="15278" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 1→2</text>
</g>
<!-- kv_send3_15_2 -->
<g id="node2437" class="node">
<title>kv_send3_15_2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="15054" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="15054" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 3</text>
<text text-anchor="middle" x="15054" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 2→3</text>
</g>
<!-- kv_send3_15_3 -->
<g id="node2438" class="node">
<title>kv_send3_15_3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14830" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14830" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 4</text>
<text text-anchor="middle" x="14830" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 3→4</text>
</g>
<!-- kv_send3_15_4 -->
<g id="node2439" class="node">
<title>kv_send3_15_4</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14606" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14606" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 5</text>
<text text-anchor="middle" x="14606" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 4→5</text>
</g>
<!-- kv_send3_15_5 -->
<g id="node2440" class="node">
<title>kv_send3_15_5</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14382" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14382" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 6</text>
<text text-anchor="middle" x="14382" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 5→6</text>
</g>
<!-- kv_send3_15_6 -->
<g id="node2441" class="node">
<title>kv_send3_15_6</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="14158" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="14158" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 7</text>
<text text-anchor="middle" x="14158" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 6→7</text>
</g>
<!-- kv_send3_15_7 -->
<g id="node2442" class="node">
<title>kv_send3_15_7</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13934" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13934" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 8</text>
<text text-anchor="middle" x="13934" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- kv_send3_15_8 -->
<g id="node2443" class="node">
<title>kv_send3_15_8</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13710" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="13710" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 9</text>
<text text-anchor="middle" x="13710" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 8→9</text>
</g>
<!-- kv_send3_15_9 -->
<g id="node2444" class="node">
<title>kv_send3_15_9</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13479" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13479" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 10</text>
<text text-anchor="middle" x="13479" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 9→10</text>
</g>
<!-- kv_send3_15_10 -->
<g id="node2445" class="node">
<title>kv_send3_15_10</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13241" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13241" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 11</text>
<text text-anchor="middle" x="13241" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 10→11</text>
</g>
<!-- kv_send3_15_11 -->
<g id="node2446" class="node">
<title>kv_send3_15_11</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="13003" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="13003" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 12</text>
<text text-anchor="middle" x="13003" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 11→12</text>
</g>
<!-- kv_send3_15_12 -->
<g id="node2447" class="node">
<title>kv_send3_15_12</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12764" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12764" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 13</text>
<text text-anchor="middle" x="12764" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 12→13</text>
</g>
<!-- kv_send3_15_13 -->
<g id="node2448" class="node">
<title>kv_send3_15_13</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12523" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12523" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 14</text>
<text text-anchor="middle" x="12523" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 13→14</text>
</g>
<!-- kv_send3_15_14 -->
<g id="node2449" class="node">
<title>kv_send3_15_14</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12278" cy="-5626.2" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="12278" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 15</text>
<text text-anchor="middle" x="12278" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 14→15</text>
</g>
<!-- kv_send3_15_15 -->
<g id="node2450" class="node">
<title>kv_send3_15_15</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="12031" cy="-5626.2" rx="103.48" ry="26.74"/>
<text text-anchor="middle" x="12031" y="-5630" font-family="Times,serif" font-size="14.00">Send KV to GPU 0</text>
<text text-anchor="middle" x="12031" y="-5615" font-family="Times,serif" font-size="14.00">GPU: 15→0</text>
</g>
<!-- out_proj3_0 -->
<g id="node2467" class="node">
<title>out_proj3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15830,-1966.5 15624,-1966.5 15624,-1913.5 15830,-1913.5 15830,-1966.5"/>
<text text-anchor="middle" x="15727" y="-1951.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15727" y="-1936.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15727" y="-1921.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- accum3_0&#45;&gt;out_proj3_0 -->
<g id="edge3443" class="edge">
<title>accum3_0&#45;&gt;out_proj3_0</title>
<path fill="none" stroke="black" d="M15348.55,-2043.48C15434.74,-2020.14 15543.8,-1990.61 15622.68,-1969.25"/>
<polygon fill="black" stroke="black" points="15623.89,-1972.55 15632.63,-1966.56 15622.06,-1965.79 15623.89,-1972.55"/>
</g>
<!-- out_proj3_1 -->
<g id="node2468" class="node">
<title>out_proj3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15830,-1824.5 15624,-1824.5 15624,-1771.5 15830,-1771.5 15830,-1824.5"/>
<text text-anchor="middle" x="15727" y="-1809.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15727" y="-1794.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15727" y="-1779.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- accum3_1&#45;&gt;out_proj3_1 -->
<g id="edge3452" class="edge">
<title>accum3_1&#45;&gt;out_proj3_1</title>
<path fill="none" stroke="black" d="M14950.51,-1903.92C14977.77,-1897.77 15006.2,-1891.81 15033,-1887 15236.36,-1850.5 15475.91,-1823.65 15613.75,-1809.74"/>
<polygon fill="black" stroke="black" points="15614.3,-1813.2 15623.9,-1808.72 15613.6,-1806.24 15614.3,-1813.2"/>
</g>
<!-- out_proj3_2 -->
<g id="node2469" class="node">
<title>out_proj3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12633,-1682.5 12427,-1682.5 12427,-1629.5 12633,-1629.5 12633,-1682.5"/>
<text text-anchor="middle" x="12530" y="-1667.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12530" y="-1652.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12530" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- accum3_2&#45;&gt;out_proj3_2 -->
<g id="edge3461" class="edge">
<title>accum3_2&#45;&gt;out_proj3_2</title>
<path fill="none" stroke="black" d="M12729.54,-1744.91C12700.51,-1733.4 12670.14,-1721.05 12642,-1709 12625.85,-1702.09 12608.57,-1694.27 12592.54,-1686.85"/>
<polygon fill="black" stroke="black" points="12593.8,-1683.57 12583.26,-1682.52 12590.84,-1689.92 12593.8,-1683.57"/>
</g>
<!-- out_proj3_3 -->
<g id="node2470" class="node">
<title>out_proj3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="12964,-1540.5 12758,-1540.5 12758,-1487.5 12964,-1487.5 12964,-1540.5"/>
<text text-anchor="middle" x="12861" y="-1525.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12861" y="-1510.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="12861" y="-1495.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- accum3_3&#45;&gt;out_proj3_3 -->
<g id="edge3470" class="edge">
<title>accum3_3&#45;&gt;out_proj3_3</title>
<path fill="none" stroke="black" d="M12863.51,-1602.87C12863.02,-1585.56 12862.48,-1566.69 12862.03,-1550.89"/>
<polygon fill="black" stroke="black" points="12865.51,-1550.4 12861.73,-1540.5 12858.52,-1550.6 12865.51,-1550.4"/>
</g>
<!-- out_proj3_4 -->
<g id="node2471" class="node">
<title>out_proj3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13207,-1398.5 13001,-1398.5 13001,-1345.5 13207,-1345.5 13207,-1398.5"/>
<text text-anchor="middle" x="13104" y="-1383.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13104" y="-1368.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13104" y="-1353.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- accum3_4&#45;&gt;out_proj3_4 -->
<g id="edge3479" class="edge">
<title>accum3_4&#45;&gt;out_proj3_4</title>
<path fill="none" stroke="black" d="M13161.74,-1460.87C13149.93,-1442.9 13137.01,-1423.24 13126.4,-1407.08"/>
<polygon fill="black" stroke="black" points="13129.17,-1404.94 13120.76,-1398.5 13123.32,-1408.78 13129.17,-1404.94"/>
</g>
<!-- out_proj3_5 -->
<g id="node2472" class="node">
<title>out_proj3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="13749,-1256.5 13543,-1256.5 13543,-1203.5 13749,-1203.5 13749,-1256.5"/>
<text text-anchor="middle" x="13646" y="-1241.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13646" y="-1226.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="13646" y="-1211.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- accum3_5&#45;&gt;out_proj3_5 -->
<g id="edge3488" class="edge">
<title>accum3_5&#45;&gt;out_proj3_5</title>
<path fill="none" stroke="black" d="M13577.59,-1318.87C13591.71,-1300.73 13607.17,-1280.87 13619.81,-1264.63"/>
<polygon fill="black" stroke="black" points="13622.76,-1266.54 13626.15,-1256.5 13617.24,-1262.24 13622.76,-1266.54"/>
</g>
<!-- out_proj3_6 -->
<g id="node2473" class="node">
<title>out_proj3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14347,-1114.5 14141,-1114.5 14141,-1061.5 14347,-1061.5 14347,-1114.5"/>
<text text-anchor="middle" x="14244" y="-1099.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14244" y="-1084.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14244" y="-1069.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- accum3_6&#45;&gt;out_proj3_6 -->
<g id="edge3497" class="edge">
<title>accum3_6&#45;&gt;out_proj3_6</title>
<path fill="none" stroke="black" d="M14164.29,-1176.87C14180.9,-1158.56 14199.09,-1138.51 14213.89,-1122.19"/>
<polygon fill="black" stroke="black" points="14216.74,-1124.26 14220.87,-1114.5 14211.56,-1119.56 14216.74,-1124.26"/>
</g>
<!-- out_proj3_7 -->
<g id="node2474" class="node">
<title>out_proj3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14682,-972.5 14476,-972.5 14476,-919.5 14682,-919.5 14682,-972.5"/>
<text text-anchor="middle" x="14579" y="-957.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14579" y="-942.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14579" y="-927.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- accum3_7&#45;&gt;out_proj3_7 -->
<g id="edge3506" class="edge">
<title>accum3_7&#45;&gt;out_proj3_7</title>
<path fill="none" stroke="black" d="M14579,-1034.87C14579,-1017.56 14579,-998.69 14579,-982.89"/>
<polygon fill="black" stroke="black" points="14582.5,-982.5 14579,-972.5 14575.5,-982.5 14582.5,-982.5"/>
</g>
<!-- out_proj3_8 -->
<g id="node2475" class="node">
<title>out_proj3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15619,-830.5 15413,-830.5 15413,-777.5 15619,-777.5 15619,-830.5"/>
<text text-anchor="middle" x="15516" y="-815.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15516" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15516" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- accum3_8&#45;&gt;out_proj3_8 -->
<g id="edge3515" class="edge">
<title>accum3_8&#45;&gt;out_proj3_8</title>
<path fill="none" stroke="black" d="M15055.86,-911.9C15082.8,-905.62 15110.77,-899.1 15137,-893 15226.25,-872.23 15327.34,-848.76 15402.66,-831.29"/>
<polygon fill="black" stroke="black" points="15403.69,-834.64 15412.64,-828.97 15402.11,-827.82 15403.69,-834.64"/>
</g>
<!-- out_proj3_9 -->
<g id="node2476" class="node">
<title>out_proj3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14788,-688.5 14582,-688.5 14582,-635.5 14788,-635.5 14788,-688.5"/>
<text text-anchor="middle" x="14685" y="-673.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14685" y="-658.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14685" y="-643.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- accum3_9&#45;&gt;out_proj3_9 -->
<g id="edge3524" class="edge">
<title>accum3_9&#45;&gt;out_proj3_9</title>
<path fill="none" stroke="black" d="M14863.88,-750.87C14824.24,-731.4 14780.58,-709.95 14746.31,-693.12"/>
<polygon fill="black" stroke="black" points="14747.43,-689.77 14736.91,-688.5 14744.34,-696.05 14747.43,-689.77"/>
</g>
<!-- out_proj3_10 -->
<g id="node2477" class="node">
<title>out_proj3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15142,-543.5 14936,-543.5 14936,-490.5 15142,-490.5 15142,-543.5"/>
<text text-anchor="middle" x="15039" y="-528.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15039" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15039" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- accum3_10&#45;&gt;out_proj3_10 -->
<g id="edge3533" class="edge">
<title>accum3_10&#45;&gt;out_proj3_10</title>
<path fill="none" stroke="black" d="M14491.39,-627.22C14518.44,-620.98 14546.57,-614.66 14573,-609 14693.08,-583.28 14831.22,-556.68 14925.73,-538.93"/>
<polygon fill="black" stroke="black" points="14926.41,-542.36 14935.59,-537.08 14925.12,-535.48 14926.41,-542.36"/>
</g>
<!-- out_proj3_11 -->
<g id="node2478" class="node">
<title>out_proj3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15145,-401.5 14939,-401.5 14939,-348.5 15145,-348.5 15145,-401.5"/>
<text text-anchor="middle" x="15042" y="-386.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15042" y="-371.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15042" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- accum3_11&#45;&gt;out_proj3_11 -->
<g id="edge3542" class="edge">
<title>accum3_11&#45;&gt;out_proj3_11</title>
<path fill="none" stroke="black" d="M14501.06,-486.4C14628.67,-460.35 14811.85,-422.97 14928.88,-399.09"/>
<polygon fill="black" stroke="black" points="14929.84,-402.46 14938.94,-397.03 14928.44,-395.6 14929.84,-402.46"/>
</g>
<!-- out_proj3_12 -->
<g id="node2479" class="node">
<title>out_proj3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15511,-2534.5 15305,-2534.5 15305,-2481.5 15511,-2481.5 15511,-2534.5"/>
<text text-anchor="middle" x="15408" y="-2519.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15408" y="-2504.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15408" y="-2489.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- accum3_12&#45;&gt;out_proj3_12 -->
<g id="edge3551" class="edge">
<title>accum3_12&#45;&gt;out_proj3_12</title>
<path fill="none" stroke="black" d="M15206.52,-2598.51C15236.02,-2586.49 15267.2,-2573.52 15296,-2561 15312.02,-2554.04 15329.2,-2546.24 15345.17,-2538.84"/>
<polygon fill="black" stroke="black" points="15346.82,-2541.93 15354.41,-2534.54 15343.87,-2535.58 15346.82,-2541.93"/>
</g>
<!-- out_proj3_13 -->
<g id="node2480" class="node">
<title>out_proj3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="14817,-2392.5 14611,-2392.5 14611,-2339.5 14817,-2339.5 14817,-2392.5"/>
<text text-anchor="middle" x="14714" y="-2377.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14714" y="-2362.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="14714" y="-2347.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- accum3_13&#45;&gt;out_proj3_13 -->
<g id="edge3560" class="edge">
<title>accum3_13&#45;&gt;out_proj3_13</title>
<path fill="none" stroke="black" d="M14648.73,-2454.87C14662.2,-2436.73 14676.95,-2416.87 14689.01,-2400.63"/>
<polygon fill="black" stroke="black" points="14691.9,-2402.61 14695.06,-2392.5 14686.28,-2398.44 14691.9,-2402.61"/>
</g>
<!-- out_proj3_14 -->
<g id="node2481" class="node">
<title>out_proj3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15767,-2250.5 15561,-2250.5 15561,-2197.5 15767,-2197.5 15767,-2250.5"/>
<text text-anchor="middle" x="15664" y="-2235.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15664" y="-2220.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15664" y="-2205.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- accum3_14&#45;&gt;out_proj3_14 -->
<g id="edge3569" class="edge">
<title>accum3_14&#45;&gt;out_proj3_14</title>
<path fill="none" stroke="black" d="M15621.32,-2312.87C15629.97,-2295.06 15639.42,-2275.6 15647.23,-2259.53"/>
<polygon fill="black" stroke="black" points="15650.39,-2261.02 15651.61,-2250.5 15644.1,-2257.97 15650.39,-2261.02"/>
</g>
<!-- out_proj3_15 -->
<g id="node2482" class="node">
<title>out_proj3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="15740,-2108.5 15534,-2108.5 15534,-2055.5 15740,-2055.5 15740,-2108.5"/>
<text text-anchor="middle" x="15637" y="-2093.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15637" y="-2078.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="15637" y="-2063.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- accum3_15&#45;&gt;out_proj3_15 -->
<g id="edge3578" class="edge">
<title>accum3_15&#45;&gt;out_proj3_15</title>
<path fill="none" stroke="black" d="M15377.68,-2176.09C15436.86,-2154.84 15504.95,-2130.4 15556.5,-2111.9"/>
<polygon fill="black" stroke="black" points="15557.7,-2115.19 15565.93,-2108.51 15555.33,-2108.6 15557.7,-2115.19"/>
</g>
<!-- out_proj3_0&#45;&gt;res_attn3_0 -->
<g id="edge3444" class="edge">
<title>out_proj3_0&#45;&gt;res_attn3_0</title>
<path fill="none" stroke="black" d="M15775.31,-1913.47C15798.6,-1898.51 15824.56,-1877.35 15839,-1851 15880.63,-1775.02 15858,-1743.63 15858,-1657 15858,-1657 15858,-1657 15858,-803 15858,-712.34 15926.3,-629.63 15982.46,-576.95"/>
<polygon fill="black" stroke="black" points="15984.98,-579.39 15989.95,-570.03 15980.23,-574.25 15984.98,-579.39"/>
</g>
<!-- out_proj3_1&#45;&gt;res_attn3_1 -->
<g id="edge3453" class="edge">
<title>out_proj3_1&#45;&gt;res_attn3_1</title>
<path fill="none" stroke="black" d="M15830.11,-1791.28C16204.32,-1769.16 17469,-1682.07 17469,-1515 17469,-1515 17469,-1515 17469,-1229 17469,-1089.78 17656.57,-708.31 17559,-609 17550.16,-600 17117.37,-603.47 17105,-601 17074.82,-594.98 17043.4,-584.84 17014.34,-573.68"/>
<polygon fill="black" stroke="black" points="17015.58,-570.41 17005,-570.03 17013.03,-576.93 17015.58,-570.41"/>
</g>
<!-- out_proj3_2&#45;&gt;res_attn3_2 -->
<g id="edge3462" class="edge">
<title>out_proj3_2&#45;&gt;res_attn3_2</title>
<path fill="none" stroke="black" d="M12565.3,-1629.41C12622.71,-1584.5 12730,-1485.54 12730,-1373 12730,-1373 12730,-1373 12730,-803 12730,-660.6 12850.1,-654.63 12985,-609 13039.21,-590.67 17048.8,-611.76 17105,-601 17135.49,-595.16 17167.2,-585 17196.48,-573.74"/>
<polygon fill="black" stroke="black" points="17197.86,-576.96 17205.89,-570.05 17195.3,-570.44 17197.86,-576.96"/>
</g>
<!-- out_proj3_3&#45;&gt;res_attn3_3 -->
<g id="edge3471" class="edge">
<title>out_proj3_3&#45;&gt;res_attn3_3</title>
<path fill="none" stroke="black" d="M12870.71,-1487.38C12888.38,-1438.36 12924,-1327.57 12924,-1231 12924,-1231 12924,-1231 12924,-803 12924,-584.27 13671.36,-630.88 13889,-609 13945.05,-603.37 17889.67,-611.59 17945,-601 17975.49,-595.16 18007.2,-585 18036.48,-573.74"/>
<polygon fill="black" stroke="black" points="18037.86,-576.95 18045.89,-570.05 18035.3,-570.44 18037.86,-576.95"/>
</g>
<!-- out_proj3_4&#45;&gt;res_attn3_4 -->
<g id="edge3480" class="edge">
<title>out_proj3_4&#45;&gt;res_attn3_4</title>
<path fill="none" stroke="black" d="M13000.83,-1348.22C12878.8,-1314.47 12692,-1238.41 12692,-1089 12692,-1089 12692,-1089 12692,-803 12692,-716.12 12650.97,-666.61 12716,-609 12725.22,-600.83 16252.9,-603.32 16265,-601 16295.49,-595.16 16327.2,-584.99 16356.47,-573.73"/>
<polygon fill="black" stroke="black" points="16357.85,-576.95 16365.89,-570.04 16355.3,-570.43 16357.85,-576.95"/>
</g>
<!-- out_proj3_5&#45;&gt;res_attn3_5 -->
<g id="edge3489" class="edge">
<title>out_proj3_5&#45;&gt;res_attn3_5</title>
<path fill="none" stroke="black" d="M13649.99,-1203.3C13664.39,-1120.29 13722.05,-858.47 13890,-751 13932.48,-723.82 14746.61,-717.05 14797,-715 16009.5,-665.6 16337.92,-852.87 17525,-601 17554.54,-594.73 17585.33,-584.72 17613.92,-573.78"/>
<polygon fill="black" stroke="black" points="17615.48,-576.93 17623.53,-570.04 17612.94,-570.41 17615.48,-576.93"/>
</g>
<!-- out_proj3_6&#45;&gt;res_attn3_6 -->
<g id="edge3498" class="edge">
<title>out_proj3_6&#45;&gt;res_attn3_6</title>
<path fill="none" stroke="black" d="M14288.28,-1061.46C14308.29,-1051.25 14332.65,-1040.59 14356,-1035 14574.41,-982.67 15142.21,-1017.86 15366,-999 15692.72,-971.46 17963.89,-631.46 18291,-609 18339.61,-605.66 19997.16,-610.22 20045,-601 20075.39,-595.14 20107.01,-585 20136.21,-573.78"/>
<polygon fill="black" stroke="black" points="20137.57,-577 20145.61,-570.1 20135.02,-570.49 20137.57,-577"/>
</g>
<!-- out_proj3_7&#45;&gt;res_attn3_7 -->
<g id="edge3507" class="edge">
<title>out_proj3_7&#45;&gt;res_attn3_7</title>
<path fill="none" stroke="black" d="M14623.28,-919.44C14643.29,-909.22 14667.64,-898.57 14691,-893 14893.66,-844.66 15420.2,-876.46 15628,-861.5 16646.22,-788.19 16892.23,-674.17 17911,-609 17961.35,-605.78 18315.52,-610.88 18365,-601 18395.18,-594.98 18426.6,-584.84 18455.66,-573.68"/>
<polygon fill="black" stroke="black" points="18456.97,-576.93 18465,-570.03 18454.42,-570.41 18456.97,-576.93"/>
</g>
<!-- out_proj3_8&#45;&gt;res_attn3_8 -->
<g id="edge3516" class="edge">
<title>out_proj3_8&#45;&gt;res_attn3_8</title>
<path fill="none" stroke="black" d="M15619.18,-793.31C15983.84,-759.6 17246.13,-647.4 18291,-609 18351.35,-606.78 20405.7,-612.41 20465,-601 20495.48,-595.14 20527.2,-584.96 20556.47,-573.7"/>
<polygon fill="black" stroke="black" points="20557.85,-576.92 20565.88,-570.01 20555.29,-570.4 20557.85,-576.92"/>
</g>
<!-- out_proj3_9&#45;&gt;res_attn3_9 -->
<g id="edge3525" class="edge">
<title>out_proj3_9&#45;&gt;res_attn3_9</title>
<path fill="none" stroke="black" d="M14788.31,-659.09C15200.92,-651.55 16770.89,-623.47 18063,-609 18094.72,-608.64 19173.86,-607.04 19205,-601 19235.39,-595.1 19267,-584.95 19296.2,-573.72"/>
<polygon fill="black" stroke="black" points="19297.56,-576.95 19305.59,-570.04 19295.01,-570.43 19297.56,-576.95"/>
</g>
<!-- out_proj3_10&#45;&gt;res_attn3_10 -->
<g id="edge3534" class="edge">
<title>out_proj3_10&#45;&gt;res_attn3_10</title>
<path fill="none" stroke="black" d="M15142.21,-531.8C15296.16,-553.05 15595.25,-591.18 15851,-605 15891.67,-607.2 21676.01,-612.73 21716,-605 21749.87,-598.45 21785.15,-586.69 21817.24,-573.86"/>
<polygon fill="black" stroke="black" points="21818.71,-577.04 21826.65,-570.03 21816.07,-570.56 21818.71,-577.04"/>
</g>
<!-- out_proj3_11&#45;&gt;res_attn3_11 -->
<g id="edge3543" class="edge">
<title>out_proj3_11&#45;&gt;res_attn3_11</title>
<path fill="none" stroke="black" d="M15145.14,-384.66C15297.43,-397.01 15591.45,-419.15 15842,-428 16189.05,-440.26 21704.83,-420.94 22144.59,-464.18"/>
<polygon fill="black" stroke="black" points="22144.24,-467.66 22154.56,-465.28 22145.01,-460.7 22144.24,-467.66"/>
</g>
<!-- out_proj3_12&#45;&gt;res_attn3_12 -->
<g id="edge3552" class="edge">
<title>out_proj3_12&#45;&gt;res_attn3_12</title>
<path fill="none" stroke="black" d="M15454.42,-2481.45C15474.1,-2471.68 15497.63,-2461.37 15520,-2455 15648.74,-2418.36 15686.68,-2439.2 15819,-2419 16783.54,-2271.74 17925,-2774.72 17925,-1799 17925,-1799 17925,-1799 17925,-1655 17925,-1271.68 18015.53,-1113.62 18329,-893 18690.52,-638.56 19857.28,-643.64 20298,-609 20363.03,-603.89 20821.01,-613.64 20885,-601 20915.28,-595.02 20946.8,-584.87 20975.93,-573.67"/>
<polygon fill="black" stroke="black" points="20977.26,-576.91 20985.29,-570.01 20974.71,-570.39 20977.26,-576.91"/>
</g>
<!-- out_proj3_13&#45;&gt;res_attn3_13 -->
<g id="edge3561" class="edge">
<title>out_proj3_13&#45;&gt;res_attn3_13</title>
<path fill="none" stroke="black" d="M14759.55,-2339.49C14780.12,-2329.28 14805.11,-2318.63 14829,-2313 15033.99,-2264.72 15567.49,-2306.58 15776,-2277 16211.54,-2215.21 17697,-2238.91 17697,-1799 17697,-1799 17697,-1799 17697,-1371 17697,-1002.29 17718.1,-813.35 18025,-609 18042.57,-597.3 18764.28,-605.06 18785,-601 18815.29,-595.07 18846.81,-584.93 18875.94,-573.74"/>
<polygon fill="black" stroke="black" points="18877.27,-576.98 18885.31,-570.08 18874.72,-570.46 18877.27,-576.98"/>
</g>
<!-- out_proj3_14&#45;&gt;res_attn3_14 -->
<g id="edge3570" class="edge">
<title>out_proj3_14&#45;&gt;res_attn3_14</title>
<path fill="none" stroke="black" d="M15767.2,-2200.64C15952.35,-2160.35 16353.07,-2072.36 16690,-1993 17114.8,-1892.94 17235.13,-1894.88 17630,-1709 17951.87,-1557.48 18003.11,-1461.67 18329,-1319 19119.4,-972.98 19368.85,-1025.15 20174,-715 20282.05,-673.38 20298.85,-633.59 20412,-609 20508.96,-587.93 21207.61,-620 21305,-601 21335.38,-595.07 21367,-584.91 21396.2,-573.68"/>
<polygon fill="black" stroke="black" points="21397.55,-576.91 21405.59,-570 21395,-570.39 21397.55,-576.91"/>
</g>
<!-- out_proj3_15&#45;&gt;res_attn3_15 -->
<g id="edge3579" class="edge">
<title>out_proj3_15&#45;&gt;res_attn3_15</title>
<path fill="none" stroke="black" d="M15740.21,-2073.74C16030.33,-2050.58 16874.03,-1964.4 17521,-1709 17632.04,-1665.17 17666.38,-1653.17 17749,-1567 18087.55,-1213.87 17869.16,-856.71 18291,-609 18306.98,-599.62 19606.81,-604.52 19625,-601 19655.39,-595.12 19687.01,-584.97 19716.21,-573.74"/>
<polygon fill="black" stroke="black" points="19717.56,-576.97 19725.6,-570.07 19715.01,-570.45 19717.56,-576.97"/>
</g>
<!-- ffn1_3_0 -->
<g id="node2483" class="node">
<title>ffn1_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22780.5,-830.5 22581.5,-830.5 22581.5,-777.5 22780.5,-777.5 22780.5,-830.5"/>
<text text-anchor="middle" x="22681" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="22681" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="22681" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_3_0 -->
<g id="node2499" class="node">
<title>act_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22715,-681 22649,-681 22649,-643 22715,-643 22715,-681"/>
<text text-anchor="middle" x="22682" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22682" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_3_0&#45;&gt;act_3_0 -->
<g id="edge3447" class="edge">
<title>ffn1_3_0&#45;&gt;act_3_0</title>
<path fill="none" stroke="black" d="M22681.18,-777.32C22681.36,-753.01 22681.62,-716.58 22681.8,-691.4"/>
<polygon fill="black" stroke="black" points="22685.3,-691.4 22681.87,-681.37 22678.3,-691.35 22685.3,-691.4"/>
</g>
<!-- ffn1_3_1 -->
<g id="node2484" class="node">
<title>ffn1_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23224.5,-830.5 23025.5,-830.5 23025.5,-777.5 23224.5,-777.5 23224.5,-830.5"/>
<text text-anchor="middle" x="23125" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23125" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23125" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_3_1 -->
<g id="node2500" class="node">
<title>act_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23161,-681 23095,-681 23095,-643 23161,-643 23161,-681"/>
<text text-anchor="middle" x="23128" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23128" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_3_1&#45;&gt;act_3_1 -->
<g id="edge3456" class="edge">
<title>ffn1_3_1&#45;&gt;act_3_1</title>
<path fill="none" stroke="black" d="M23125.55,-777.32C23126.07,-753.01 23126.85,-716.58 23127.39,-691.4"/>
<polygon fill="black" stroke="black" points="23130.89,-691.45 23127.61,-681.37 23123.89,-691.3 23130.89,-691.45"/>
</g>
<!-- ffn1_3_2 -->
<g id="node2485" class="node">
<title>ffn1_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23447.5,-830.5 23248.5,-830.5 23248.5,-777.5 23447.5,-777.5 23447.5,-830.5"/>
<text text-anchor="middle" x="23348" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23348" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23348" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_3_2 -->
<g id="node2501" class="node">
<title>act_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23384,-681 23318,-681 23318,-643 23384,-643 23384,-681"/>
<text text-anchor="middle" x="23351" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23351" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_3_2&#45;&gt;act_3_2 -->
<g id="edge3465" class="edge">
<title>ffn1_3_2&#45;&gt;act_3_2</title>
<path fill="none" stroke="black" d="M23348.55,-777.32C23349.07,-753.01 23349.85,-716.58 23350.39,-691.4"/>
<polygon fill="black" stroke="black" points="23353.89,-691.45 23350.61,-681.37 23346.89,-691.3 23353.89,-691.45"/>
</g>
<!-- ffn1_3_3 -->
<g id="node2486" class="node">
<title>ffn1_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23895.5,-830.5 23696.5,-830.5 23696.5,-777.5 23895.5,-777.5 23895.5,-830.5"/>
<text text-anchor="middle" x="23796" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23796" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23796" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_3_3 -->
<g id="node2502" class="node">
<title>act_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23832,-681 23766,-681 23766,-643 23832,-643 23832,-681"/>
<text text-anchor="middle" x="23799" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23799" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_3_3&#45;&gt;act_3_3 -->
<g id="edge3474" class="edge">
<title>ffn1_3_3&#45;&gt;act_3_3</title>
<path fill="none" stroke="black" d="M23796.55,-777.32C23797.07,-753.01 23797.85,-716.58 23798.39,-691.4"/>
<polygon fill="black" stroke="black" points="23801.89,-691.45 23798.61,-681.37 23794.89,-691.3 23801.89,-691.45"/>
</g>
<!-- ffn1_3_4 -->
<g id="node2487" class="node">
<title>ffn1_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23001.5,-830.5 22802.5,-830.5 22802.5,-777.5 23001.5,-777.5 23001.5,-830.5"/>
<text text-anchor="middle" x="22902" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="22902" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="22902" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_3_4 -->
<g id="node2503" class="node">
<title>act_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22937,-681 22871,-681 22871,-643 22937,-643 22937,-681"/>
<text text-anchor="middle" x="22904" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22904" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_3_4&#45;&gt;act_3_4 -->
<g id="edge3483" class="edge">
<title>ffn1_3_4&#45;&gt;act_3_4</title>
<path fill="none" stroke="black" d="M22902.37,-777.32C22902.71,-753.01 22903.23,-716.58 22903.59,-691.4"/>
<polygon fill="black" stroke="black" points="22907.09,-691.42 22903.74,-681.37 22900.09,-691.32 22907.09,-691.42"/>
</g>
<!-- ffn1_3_5 -->
<g id="node2488" class="node">
<title>ffn1_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23671.5,-830.5 23472.5,-830.5 23472.5,-777.5 23671.5,-777.5 23671.5,-830.5"/>
<text text-anchor="middle" x="23572" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="23572" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="23572" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_3_5 -->
<g id="node2504" class="node">
<title>act_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23608,-681 23542,-681 23542,-643 23608,-643 23608,-681"/>
<text text-anchor="middle" x="23575" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="23575" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_3_5&#45;&gt;act_3_5 -->
<g id="edge3492" class="edge">
<title>ffn1_3_5&#45;&gt;act_3_5</title>
<path fill="none" stroke="black" d="M23572.55,-777.32C23573.07,-753.01 23573.85,-716.58 23574.39,-691.4"/>
<polygon fill="black" stroke="black" points="23577.89,-691.45 23574.61,-681.37 23570.89,-691.3 23577.89,-691.45"/>
</g>
<!-- ffn1_3_6 -->
<g id="node2489" class="node">
<title>ffn1_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25015.5,-830.5 24816.5,-830.5 24816.5,-777.5 25015.5,-777.5 25015.5,-830.5"/>
<text text-anchor="middle" x="24916" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24916" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24916" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_3_6 -->
<g id="node2505" class="node">
<title>act_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24952,-681 24886,-681 24886,-643 24952,-643 24952,-681"/>
<text text-anchor="middle" x="24919" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24919" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_3_6&#45;&gt;act_3_6 -->
<g id="edge3501" class="edge">
<title>ffn1_3_6&#45;&gt;act_3_6</title>
<path fill="none" stroke="black" d="M24916.55,-777.32C24917.07,-753.01 24917.85,-716.58 24918.39,-691.4"/>
<polygon fill="black" stroke="black" points="24921.89,-691.45 24918.61,-681.37 24914.89,-691.3 24921.89,-691.45"/>
</g>
<!-- ffn1_3_7 -->
<g id="node2490" class="node">
<title>ffn1_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24119.5,-830.5 23920.5,-830.5 23920.5,-777.5 24119.5,-777.5 24119.5,-830.5"/>
<text text-anchor="middle" x="24020" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24020" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24020" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_3_7 -->
<g id="node2506" class="node">
<title>act_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24056,-681 23990,-681 23990,-643 24056,-643 24056,-681"/>
<text text-anchor="middle" x="24023" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24023" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_3_7&#45;&gt;act_3_7 -->
<g id="edge3510" class="edge">
<title>ffn1_3_7&#45;&gt;act_3_7</title>
<path fill="none" stroke="black" d="M24020.55,-777.32C24021.07,-753.01 24021.85,-716.58 24022.39,-691.4"/>
<polygon fill="black" stroke="black" points="24025.89,-691.45 24022.61,-681.37 24018.89,-691.3 24025.89,-691.45"/>
</g>
<!-- ffn1_3_8 -->
<g id="node2491" class="node">
<title>ffn1_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25239.5,-830.5 25040.5,-830.5 25040.5,-777.5 25239.5,-777.5 25239.5,-830.5"/>
<text text-anchor="middle" x="25140" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25140" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25140" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_3_8 -->
<g id="node2507" class="node">
<title>act_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25176,-681 25110,-681 25110,-643 25176,-643 25176,-681"/>
<text text-anchor="middle" x="25143" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25143" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_3_8&#45;&gt;act_3_8 -->
<g id="edge3519" class="edge">
<title>ffn1_3_8&#45;&gt;act_3_8</title>
<path fill="none" stroke="black" d="M25140.55,-777.32C25141.07,-753.01 25141.85,-716.58 25142.39,-691.4"/>
<polygon fill="black" stroke="black" points="25145.89,-691.45 25142.61,-681.37 25138.89,-691.3 25145.89,-691.45"/>
</g>
<!-- ffn1_3_9 -->
<g id="node2492" class="node">
<title>ffn1_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24567.5,-830.5 24368.5,-830.5 24368.5,-777.5 24567.5,-777.5 24567.5,-830.5"/>
<text text-anchor="middle" x="24468" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24468" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24468" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_3_9 -->
<g id="node2508" class="node">
<title>act_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24504,-681 24438,-681 24438,-643 24504,-643 24504,-681"/>
<text text-anchor="middle" x="24471" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24471" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_3_9&#45;&gt;act_3_9 -->
<g id="edge3528" class="edge">
<title>ffn1_3_9&#45;&gt;act_3_9</title>
<path fill="none" stroke="black" d="M24468.55,-777.32C24469.07,-753.01 24469.85,-716.58 24470.39,-691.4"/>
<polygon fill="black" stroke="black" points="24473.89,-691.45 24470.61,-681.37 24466.89,-691.3 24473.89,-691.45"/>
</g>
<!-- ffn1_3_10 -->
<g id="node2493" class="node">
<title>ffn1_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25911.5,-830.5 25712.5,-830.5 25712.5,-777.5 25911.5,-777.5 25911.5,-830.5"/>
<text text-anchor="middle" x="25812" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25812" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25812" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_3_10 -->
<g id="node2509" class="node">
<title>act_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25853.5,-681 25778.5,-681 25778.5,-643 25853.5,-643 25853.5,-681"/>
<text text-anchor="middle" x="25816" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25816" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_3_10&#45;&gt;act_3_10 -->
<g id="edge3537" class="edge">
<title>ffn1_3_10&#45;&gt;act_3_10</title>
<path fill="none" stroke="black" d="M25812.73,-777.32C25813.43,-753.01 25814.47,-716.58 25815.19,-691.4"/>
<polygon fill="black" stroke="black" points="25818.69,-691.47 25815.48,-681.37 25811.69,-691.27 25818.69,-691.47"/>
</g>
<!-- ffn1_3_11 -->
<g id="node2494" class="node">
<title>ffn1_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26135.5,-830.5 25936.5,-830.5 25936.5,-777.5 26135.5,-777.5 26135.5,-830.5"/>
<text text-anchor="middle" x="26036" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="26036" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="26036" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_3_11 -->
<g id="node2510" class="node">
<title>act_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26076.5,-681 26001.5,-681 26001.5,-643 26076.5,-643 26076.5,-681"/>
<text text-anchor="middle" x="26039" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="26039" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_3_11&#45;&gt;act_3_11 -->
<g id="edge3546" class="edge">
<title>ffn1_3_11&#45;&gt;act_3_11</title>
<path fill="none" stroke="black" d="M26036.55,-777.32C26037.07,-753.01 26037.85,-716.58 26038.39,-691.4"/>
<polygon fill="black" stroke="black" points="26041.89,-691.45 26038.61,-681.37 26034.89,-691.3 26041.89,-691.45"/>
</g>
<!-- ffn1_3_12 -->
<g id="node2495" class="node">
<title>ffn1_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25463.5,-830.5 25264.5,-830.5 25264.5,-777.5 25463.5,-777.5 25463.5,-830.5"/>
<text text-anchor="middle" x="25364" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25364" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25364" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_3_12 -->
<g id="node2511" class="node">
<title>act_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25404.5,-681 25329.5,-681 25329.5,-643 25404.5,-643 25404.5,-681"/>
<text text-anchor="middle" x="25367" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25367" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_3_12&#45;&gt;act_3_12 -->
<g id="edge3555" class="edge">
<title>ffn1_3_12&#45;&gt;act_3_12</title>
<path fill="none" stroke="black" d="M25364.55,-777.32C25365.07,-753.01 25365.85,-716.58 25366.39,-691.4"/>
<polygon fill="black" stroke="black" points="25369.89,-691.45 25366.61,-681.37 25362.89,-691.3 25369.89,-691.45"/>
</g>
<!-- ffn1_3_13 -->
<g id="node2496" class="node">
<title>ffn1_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24343.5,-830.5 24144.5,-830.5 24144.5,-777.5 24343.5,-777.5 24343.5,-830.5"/>
<text text-anchor="middle" x="24244" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24244" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24244" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_3_13 -->
<g id="node2512" class="node">
<title>act_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24284.5,-681 24209.5,-681 24209.5,-643 24284.5,-643 24284.5,-681"/>
<text text-anchor="middle" x="24247" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24247" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_3_13&#45;&gt;act_3_13 -->
<g id="edge3564" class="edge">
<title>ffn1_3_13&#45;&gt;act_3_13</title>
<path fill="none" stroke="black" d="M24244.55,-777.32C24245.07,-753.01 24245.85,-716.58 24246.39,-691.4"/>
<polygon fill="black" stroke="black" points="24249.89,-691.45 24246.61,-681.37 24242.89,-691.3 24249.89,-691.45"/>
</g>
<!-- ffn1_3_14 -->
<g id="node2497" class="node">
<title>ffn1_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25687.5,-830.5 25488.5,-830.5 25488.5,-777.5 25687.5,-777.5 25687.5,-830.5"/>
<text text-anchor="middle" x="25588" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="25588" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="25588" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_3_14 -->
<g id="node2513" class="node">
<title>act_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25629.5,-681 25554.5,-681 25554.5,-643 25629.5,-643 25629.5,-681"/>
<text text-anchor="middle" x="25592" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25592" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_3_14&#45;&gt;act_3_14 -->
<g id="edge3573" class="edge">
<title>ffn1_3_14&#45;&gt;act_3_14</title>
<path fill="none" stroke="black" d="M25588.73,-777.32C25589.43,-753.01 25590.47,-716.58 25591.19,-691.4"/>
<polygon fill="black" stroke="black" points="25594.69,-691.47 25591.48,-681.37 25587.69,-691.27 25594.69,-691.47"/>
</g>
<!-- ffn1_3_15 -->
<g id="node2498" class="node">
<title>ffn1_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24791.5,-830.5 24592.5,-830.5 24592.5,-777.5 24791.5,-777.5 24791.5,-830.5"/>
<text text-anchor="middle" x="24692" y="-815.3" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="24692" y="-800.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, ffn_dim]</text>
<text text-anchor="middle" x="24692" y="-785.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_3_15 -->
<g id="node2514" class="node">
<title>act_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24732.5,-681 24657.5,-681 24657.5,-643 24732.5,-643 24732.5,-681"/>
<text text-anchor="middle" x="24695" y="-665.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24695" y="-650.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_3_15&#45;&gt;act_3_15 -->
<g id="edge3582" class="edge">
<title>ffn1_3_15&#45;&gt;act_3_15</title>
<path fill="none" stroke="black" d="M24692.55,-777.32C24693.07,-753.01 24693.85,-716.58 24694.39,-691.4"/>
<polygon fill="black" stroke="black" points="24697.89,-691.45 24694.61,-681.37 24690.89,-691.3 24697.89,-691.45"/>
</g>
<!-- ffn2_3_0 -->
<g id="node2515" class="node">
<title>ffn2_3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22786,-543.5 22580,-543.5 22580,-490.5 22786,-490.5 22786,-543.5"/>
<text text-anchor="middle" x="22683" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="22683" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22683" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act_3_0&#45;&gt;ffn2_3_0 -->
<g id="edge3448" class="edge">
<title>act_3_0&#45;&gt;ffn2_3_0</title>
<path fill="none" stroke="black" d="M22682.13,-642.89C22682.28,-620.63 22682.55,-582.34 22682.75,-554"/>
<polygon fill="black" stroke="black" points="22686.25,-553.71 22682.82,-543.69 22679.25,-553.66 22686.25,-553.71"/>
</g>
<!-- ffn2_3_1 -->
<g id="node2516" class="node">
<title>ffn2_3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23234,-543.5 23028,-543.5 23028,-490.5 23234,-490.5 23234,-543.5"/>
<text text-anchor="middle" x="23131" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23131" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23131" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act_3_1&#45;&gt;ffn2_3_1 -->
<g id="edge3457" class="edge">
<title>act_3_1&#45;&gt;ffn2_3_1</title>
<path fill="none" stroke="black" d="M23128.38,-642.89C23128.85,-620.63 23129.65,-582.34 23130.24,-554"/>
<polygon fill="black" stroke="black" points="23133.75,-553.76 23130.46,-543.69 23126.75,-553.61 23133.75,-553.76"/>
</g>
<!-- ffn2_3_2 -->
<g id="node2517" class="node">
<title>ffn2_3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23458,-543.5 23252,-543.5 23252,-490.5 23458,-490.5 23458,-543.5"/>
<text text-anchor="middle" x="23355" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23355" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23355" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act_3_2&#45;&gt;ffn2_3_2 -->
<g id="edge3466" class="edge">
<title>act_3_2&#45;&gt;ffn2_3_2</title>
<path fill="none" stroke="black" d="M23351.51,-642.89C23352.13,-620.63 23353.2,-582.34 23353.99,-554"/>
<polygon fill="black" stroke="black" points="23357.5,-553.78 23354.28,-543.69 23350.5,-553.58 23357.5,-553.78"/>
</g>
<!-- ffn2_3_3 -->
<g id="node2518" class="node">
<title>ffn2_3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23906,-543.5 23700,-543.5 23700,-490.5 23906,-490.5 23906,-543.5"/>
<text text-anchor="middle" x="23803" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23803" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23803" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act_3_3&#45;&gt;ffn2_3_3 -->
<g id="edge3475" class="edge">
<title>act_3_3&#45;&gt;ffn2_3_3</title>
<path fill="none" stroke="black" d="M23799.51,-642.89C23800.13,-620.63 23801.2,-582.34 23801.99,-554"/>
<polygon fill="black" stroke="black" points="23805.5,-553.78 23802.28,-543.69 23798.5,-553.58 23805.5,-553.78"/>
</g>
<!-- ffn2_3_4 -->
<g id="node2519" class="node">
<title>ffn2_3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23010,-543.5 22804,-543.5 22804,-490.5 23010,-490.5 23010,-543.5"/>
<text text-anchor="middle" x="22907" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="22907" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22907" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act_3_4&#45;&gt;ffn2_3_4 -->
<g id="edge3484" class="edge">
<title>act_3_4&#45;&gt;ffn2_3_4</title>
<path fill="none" stroke="black" d="M22904.38,-642.89C22904.85,-620.63 22905.65,-582.34 22906.24,-554"/>
<polygon fill="black" stroke="black" points="22909.75,-553.76 22906.46,-543.69 22902.75,-553.61 22909.75,-553.76"/>
</g>
<!-- ffn2_3_5 -->
<g id="node2520" class="node">
<title>ffn2_3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="23682,-543.5 23476,-543.5 23476,-490.5 23682,-490.5 23682,-543.5"/>
<text text-anchor="middle" x="23579" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="23579" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="23579" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act_3_5&#45;&gt;ffn2_3_5 -->
<g id="edge3493" class="edge">
<title>act_3_5&#45;&gt;ffn2_3_5</title>
<path fill="none" stroke="black" d="M23575.51,-642.89C23576.13,-620.63 23577.2,-582.34 23577.99,-554"/>
<polygon fill="black" stroke="black" points="23581.5,-553.78 23578.28,-543.69 23574.5,-553.58 23581.5,-553.78"/>
</g>
<!-- ffn2_3_6 -->
<g id="node2521" class="node">
<title>ffn2_3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25026,-543.5 24820,-543.5 24820,-490.5 25026,-490.5 25026,-543.5"/>
<text text-anchor="middle" x="24923" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24923" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24923" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act_3_6&#45;&gt;ffn2_3_6 -->
<g id="edge3502" class="edge">
<title>act_3_6&#45;&gt;ffn2_3_6</title>
<path fill="none" stroke="black" d="M24919.51,-642.89C24920.13,-620.63 24921.2,-582.34 24921.99,-554"/>
<polygon fill="black" stroke="black" points="24925.5,-553.78 24922.28,-543.69 24918.5,-553.58 24925.5,-553.78"/>
</g>
<!-- ffn2_3_7 -->
<g id="node2522" class="node">
<title>ffn2_3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24130,-543.5 23924,-543.5 23924,-490.5 24130,-490.5 24130,-543.5"/>
<text text-anchor="middle" x="24027" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24027" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24027" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act_3_7&#45;&gt;ffn2_3_7 -->
<g id="edge3511" class="edge">
<title>act_3_7&#45;&gt;ffn2_3_7</title>
<path fill="none" stroke="black" d="M24023.51,-642.89C24024.13,-620.63 24025.2,-582.34 24025.99,-554"/>
<polygon fill="black" stroke="black" points="24029.5,-553.78 24026.28,-543.69 24022.5,-553.58 24029.5,-553.78"/>
</g>
<!-- ffn2_3_8 -->
<g id="node2523" class="node">
<title>ffn2_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25250,-543.5 25044,-543.5 25044,-490.5 25250,-490.5 25250,-543.5"/>
<text text-anchor="middle" x="25147" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25147" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25147" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act_3_8&#45;&gt;ffn2_3_8 -->
<g id="edge3520" class="edge">
<title>act_3_8&#45;&gt;ffn2_3_8</title>
<path fill="none" stroke="black" d="M25143.51,-642.89C25144.13,-620.63 25145.2,-582.34 25145.99,-554"/>
<polygon fill="black" stroke="black" points="25149.5,-553.78 25146.28,-543.69 25142.5,-553.58 25149.5,-553.78"/>
</g>
<!-- ffn2_3_9 -->
<g id="node2524" class="node">
<title>ffn2_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24578,-543.5 24372,-543.5 24372,-490.5 24578,-490.5 24578,-543.5"/>
<text text-anchor="middle" x="24475" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24475" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24475" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act_3_9&#45;&gt;ffn2_3_9 -->
<g id="edge3529" class="edge">
<title>act_3_9&#45;&gt;ffn2_3_9</title>
<path fill="none" stroke="black" d="M24471.51,-642.89C24472.13,-620.63 24473.2,-582.34 24473.99,-554"/>
<polygon fill="black" stroke="black" points="24477.5,-553.78 24474.28,-543.69 24470.5,-553.58 24477.5,-553.78"/>
</g>
<!-- ffn2_3_10 -->
<g id="node2525" class="node">
<title>ffn2_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25922,-543.5 25716,-543.5 25716,-490.5 25922,-490.5 25922,-543.5"/>
<text text-anchor="middle" x="25819" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25819" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25819" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act_3_10&#45;&gt;ffn2_3_10 -->
<g id="edge3538" class="edge">
<title>act_3_10&#45;&gt;ffn2_3_10</title>
<path fill="none" stroke="black" d="M25816.38,-642.89C25816.85,-620.63 25817.65,-582.34 25818.24,-554"/>
<polygon fill="black" stroke="black" points="25821.75,-553.76 25818.46,-543.69 25814.75,-553.61 25821.75,-553.76"/>
</g>
<!-- ffn2_3_11 -->
<g id="node2526" class="node">
<title>ffn2_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="26146,-543.5 25940,-543.5 25940,-490.5 26146,-490.5 26146,-543.5"/>
<text text-anchor="middle" x="26043" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="26043" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="26043" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act_3_11&#45;&gt;ffn2_3_11 -->
<g id="edge3547" class="edge">
<title>act_3_11&#45;&gt;ffn2_3_11</title>
<path fill="none" stroke="black" d="M26039.51,-642.89C26040.13,-620.63 26041.2,-582.34 26041.99,-554"/>
<polygon fill="black" stroke="black" points="26045.5,-553.78 26042.28,-543.69 26038.5,-553.58 26045.5,-553.78"/>
</g>
<!-- ffn2_3_12 -->
<g id="node2527" class="node">
<title>ffn2_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25474,-543.5 25268,-543.5 25268,-490.5 25474,-490.5 25474,-543.5"/>
<text text-anchor="middle" x="25371" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25371" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25371" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act_3_12&#45;&gt;ffn2_3_12 -->
<g id="edge3556" class="edge">
<title>act_3_12&#45;&gt;ffn2_3_12</title>
<path fill="none" stroke="black" d="M25367.51,-642.89C25368.13,-620.63 25369.2,-582.34 25369.99,-554"/>
<polygon fill="black" stroke="black" points="25373.5,-553.78 25370.28,-543.69 25366.5,-553.58 25373.5,-553.78"/>
</g>
<!-- ffn2_3_13 -->
<g id="node2528" class="node">
<title>ffn2_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24354,-543.5 24148,-543.5 24148,-490.5 24354,-490.5 24354,-543.5"/>
<text text-anchor="middle" x="24251" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24251" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24251" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act_3_13&#45;&gt;ffn2_3_13 -->
<g id="edge3565" class="edge">
<title>act_3_13&#45;&gt;ffn2_3_13</title>
<path fill="none" stroke="black" d="M24247.51,-642.89C24248.13,-620.63 24249.2,-582.34 24249.99,-554"/>
<polygon fill="black" stroke="black" points="24253.5,-553.78 24250.28,-543.69 24246.5,-553.58 24253.5,-553.78"/>
</g>
<!-- ffn2_3_14 -->
<g id="node2529" class="node">
<title>ffn2_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="25698,-543.5 25492,-543.5 25492,-490.5 25698,-490.5 25698,-543.5"/>
<text text-anchor="middle" x="25595" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="25595" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="25595" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act_3_14&#45;&gt;ffn2_3_14 -->
<g id="edge3574" class="edge">
<title>act_3_14&#45;&gt;ffn2_3_14</title>
<path fill="none" stroke="black" d="M25592.38,-642.89C25592.85,-620.63 25593.65,-582.34 25594.24,-554"/>
<polygon fill="black" stroke="black" points="25597.75,-553.76 25594.46,-543.69 25590.75,-553.61 25597.75,-553.76"/>
</g>
<!-- ffn2_3_15 -->
<g id="node2530" class="node">
<title>ffn2_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="24802,-543.5 24596,-543.5 24596,-490.5 24802,-490.5 24802,-543.5"/>
<text text-anchor="middle" x="24699" y="-528.3" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="24699" y="-513.3" font-family="Times,serif" font-size="14.00">Output: [B, L/16, d_model]</text>
<text text-anchor="middle" x="24699" y="-498.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act_3_15&#45;&gt;ffn2_3_15 -->
<g id="edge3583" class="edge">
<title>act_3_15&#45;&gt;ffn2_3_15</title>
<path fill="none" stroke="black" d="M24695.51,-642.89C24696.13,-620.63 24697.2,-582.34 24697.99,-554"/>
<polygon fill="black" stroke="black" points="24701.5,-553.78 24698.28,-543.69 24694.5,-553.58 24701.5,-553.78"/>
</g>
<!-- res_ffn3_0 -->
<g id="node2547" class="node">
<title>res_ffn3_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16256.26,-428 15936.1,-428 15853.74,-322 16173.9,-322 16256.26,-428"/>
<text text-anchor="middle" x="16055" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16055" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16055" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn2_3_0&#45;&gt;res_ffn3_0 -->
<g id="edge3449" class="edge">
<title>ffn2_3_0&#45;&gt;res_ffn3_0</title>
<path fill="none" stroke="black" d="M22638.08,-490.4C22617.43,-480.04 22592.19,-469.29 22568,-464 22228.74,-389.85 16705.3,-470.03 16265.41,-427.81"/>
<polygon fill="black" stroke="black" points="16265.76,-424.33 16255.44,-426.72 16265,-431.29 16265.76,-424.33"/>
</g>
<!-- res_ffn3_1 -->
<g id="node2548" class="node">
<title>res_ffn3_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17096.26,-428 16776.1,-428 16693.74,-322 17013.9,-322 17096.26,-428"/>
<text text-anchor="middle" x="16895" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16895" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16895" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn2_3_1&#45;&gt;res_ffn3_1 -->
<g id="edge3458" class="edge">
<title>ffn2_3_1&#45;&gt;res_ffn3_1</title>
<path fill="none" stroke="black" d="M23087.33,-490.41C23067.23,-480.05 23042.64,-469.3 23019,-464 22701.2,-392.81 17523.23,-467.44 17105.42,-427.8"/>
<polygon fill="black" stroke="black" points="17105.76,-424.32 17095.44,-426.72 17105,-431.28 17105.76,-424.32"/>
</g>
<!-- res_ffn3_2 -->
<g id="node2549" class="node">
<title>res_ffn3_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17516.26,-428 17196.1,-428 17113.74,-322 17433.9,-322 17516.26,-428"/>
<text text-anchor="middle" x="17315" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17315" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17315" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn2_3_2&#45;&gt;res_ffn3_2 -->
<g id="edge3467" class="edge">
<title>ffn2_3_2&#45;&gt;res_ffn3_2</title>
<path fill="none" stroke="black" d="M23311.33,-490.41C23291.23,-480.05 23266.64,-469.3 23243,-464 22935.82,-395.15 17931.83,-466.15 17525.4,-427.8"/>
<polygon fill="black" stroke="black" points="17525.76,-424.31 17515.44,-426.72 17525,-431.27 17525.76,-424.31"/>
</g>
<!-- res_ffn3_3 -->
<g id="node2550" class="node">
<title>res_ffn3_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18356.26,-428 18036.1,-428 17953.74,-322 18273.9,-322 18356.26,-428"/>
<text text-anchor="middle" x="18155" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18155" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18155" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn2_3_3&#45;&gt;res_ffn3_3 -->
<g id="edge3476" class="edge">
<title>ffn2_3_3&#45;&gt;res_ffn3_3</title>
<path fill="none" stroke="black" d="M23759.33,-490.42C23739.23,-480.06 23714.64,-469.3 23691,-464 23405.1,-399.85 18750.82,-463.55 18365.58,-427.8"/>
<polygon fill="black" stroke="black" points="18365.75,-424.3 18355.44,-426.72 18365.01,-431.26 18365.75,-424.3"/>
</g>
<!-- res_ffn3_4 -->
<g id="node2551" class="node">
<title>res_ffn3_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="16676.26,-428 16356.1,-428 16273.74,-322 16593.9,-322 16676.26,-428"/>
<text text-anchor="middle" x="16475" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16475" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="16475" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn2_3_4&#45;&gt;res_ffn3_4 -->
<g id="edge3485" class="edge">
<title>ffn2_3_4&#45;&gt;res_ffn3_4</title>
<path fill="none" stroke="black" d="M22863.33,-490.41C22843.23,-480.05 22818.64,-469.29 22795,-464 22466.58,-390.46 17114.46,-468.73 16685.43,-427.81"/>
<polygon fill="black" stroke="black" points="16685.76,-424.32 16675.44,-426.72 16685,-431.28 16685.76,-424.32"/>
</g>
<!-- res_ffn3_5 -->
<g id="node2552" class="node">
<title>res_ffn3_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="17936.26,-428 17616.1,-428 17533.74,-322 17853.9,-322 17936.26,-428"/>
<text text-anchor="middle" x="17735" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17735" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="17735" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn2_3_5&#45;&gt;res_ffn3_5 -->
<g id="edge3494" class="edge">
<title>ffn2_3_5&#45;&gt;res_ffn3_5</title>
<path fill="none" stroke="black" d="M23535.33,-490.41C23515.23,-480.05 23490.64,-469.3 23467,-464 23170.5,-397.51 18342.64,-464.83 17945.65,-427.82"/>
<polygon fill="black" stroke="black" points="17945.75,-424.31 17935.44,-426.72 17945.01,-431.27 17945.75,-424.31"/>
</g>
<!-- res_ffn3_6 -->
<g id="node2553" class="node">
<title>res_ffn3_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20456.26,-428 20136.1,-428 20053.74,-322 20373.9,-322 20456.26,-428"/>
<text text-anchor="middle" x="20255" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20255" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20255" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn2_3_6&#45;&gt;res_ffn3_6 -->
<g id="edge3503" class="edge">
<title>ffn2_3_6&#45;&gt;res_ffn3_6</title>
<path fill="none" stroke="black" d="M24879.32,-490.43C24859.22,-480.08 24834.63,-469.32 24811,-464 24578.21,-411.58 20794.78,-457.13 20465.68,-427.79"/>
<polygon fill="black" stroke="black" points="20465.75,-424.28 20455.44,-426.71 20465.02,-431.24 20465.75,-424.28"/>
</g>
<!-- res_ffn3_7 -->
<g id="node2554" class="node">
<title>res_ffn3_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="18776.26,-428 18456.1,-428 18373.74,-322 18693.9,-322 18776.26,-428"/>
<text text-anchor="middle" x="18575" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18575" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18575" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn2_3_7&#45;&gt;res_ffn3_7 -->
<g id="edge3512" class="edge">
<title>ffn2_3_7&#45;&gt;res_ffn3_7</title>
<path fill="none" stroke="black" d="M23983.33,-490.42C23963.23,-480.06 23938.64,-469.31 23915,-464 23639.7,-402.19 19158.83,-462.27 18785.49,-427.79"/>
<polygon fill="black" stroke="black" points="18785.75,-424.3 18775.44,-426.72 18785.01,-431.26 18785.75,-424.3"/>
</g>
<!-- res_ffn3_8 -->
<g id="node2555" class="node">
<title>res_ffn3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20876.26,-428 20556.1,-428 20473.74,-322 20793.9,-322 20876.26,-428"/>
<text text-anchor="middle" x="20675" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20675" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="20675" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn2_3_8&#45;&gt;res_ffn3_8 -->
<g id="edge3521" class="edge">
<title>ffn2_3_8&#45;&gt;res_ffn3_8</title>
<path fill="none" stroke="black" d="M25103.32,-490.44C25083.22,-480.08 25058.63,-469.33 25035,-464 24812.82,-413.93 21203.47,-455.86 20885.7,-427.78"/>
<polygon fill="black" stroke="black" points="20885.75,-424.27 20875.44,-426.71 20885.02,-431.23 20885.75,-424.27"/>
</g>
<!-- res_ffn3_9 -->
<g id="node2556" class="node">
<title>res_ffn3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19616.26,-428 19296.1,-428 19213.74,-322 19533.9,-322 19616.26,-428"/>
<text text-anchor="middle" x="19415" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19415" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19415" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn2_3_9&#45;&gt;res_ffn3_9 -->
<g id="edge3530" class="edge">
<title>ffn2_3_9&#45;&gt;res_ffn3_9</title>
<path fill="none" stroke="black" d="M24431.33,-490.42C24411.23,-480.07 24386.64,-469.31 24363,-464 24108.94,-406.88 19976.38,-459.7 19625.52,-427.78"/>
<polygon fill="black" stroke="black" points="19625.75,-424.29 19615.44,-426.71 19625.01,-431.25 19625.75,-424.29"/>
</g>
<!-- res_ffn3_10 -->
<g id="node2557" class="node">
<title>res_ffn3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22136.26,-428 21816.1,-428 21733.74,-322 22053.9,-322 22136.26,-428"/>
<text text-anchor="middle" x="21935" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21935" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21935" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn2_3_10&#45;&gt;res_ffn3_10 -->
<g id="edge3539" class="edge">
<title>ffn2_3_10&#45;&gt;res_ffn3_10</title>
<path fill="none" stroke="black" d="M25775.32,-490.45C25755.22,-480.1 25730.63,-469.34 25707,-464 25516.61,-420.95 22427.51,-452.07 22145.53,-427.75"/>
<polygon fill="black" stroke="black" points="22145.75,-424.25 22135.44,-426.7 22145.03,-431.21 22145.75,-424.25"/>
</g>
<!-- res_ffn3_11 -->
<g id="node2558" class="node">
<title>res_ffn3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="22556.26,-428 22236.1,-428 22153.74,-322 22473.9,-322 22556.26,-428"/>
<text text-anchor="middle" x="22355" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22355" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="22355" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn2_3_11&#45;&gt;res_ffn3_11 -->
<g id="edge3548" class="edge">
<title>ffn2_3_11&#45;&gt;res_ffn3_11</title>
<path fill="none" stroke="black" d="M25999.02,-490.48C25978.96,-480.2 25954.48,-469.49 25931,-464 25598.18,-386.2 23193.29,-377.13 22526.19,-376.12"/>
<polygon fill="black" stroke="black" points="22526.02,-372.62 22516.02,-376.1 22526.01,-379.62 22526.02,-372.62"/>
</g>
<!-- res_ffn3_12 -->
<g id="node2559" class="node">
<title>res_ffn3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21296.26,-428 20976.1,-428 20893.74,-322 21213.9,-322 21296.26,-428"/>
<text text-anchor="middle" x="21095" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21095" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21095" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn2_3_12&#45;&gt;res_ffn3_12 -->
<g id="edge3557" class="edge">
<title>ffn2_3_12&#45;&gt;res_ffn3_12</title>
<path fill="none" stroke="black" d="M25327.32,-490.44C25307.22,-480.09 25282.63,-469.33 25259,-464 25047.43,-416.27 21611.82,-454.59 21305.68,-427.77"/>
<polygon fill="black" stroke="black" points="21305.75,-424.26 21295.44,-426.71 21305.02,-431.22 21305.75,-424.26"/>
</g>
<!-- res_ffn3_13 -->
<g id="node2560" class="node">
<title>res_ffn3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19196.26,-428 18876.1,-428 18793.74,-322 19113.9,-322 19196.26,-428"/>
<text text-anchor="middle" x="18995" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18995" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="18995" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn2_3_13&#45;&gt;res_ffn3_13 -->
<g id="edge3566" class="edge">
<title>ffn2_3_13&#45;&gt;res_ffn3_13</title>
<path fill="none" stroke="black" d="M24207.33,-490.42C24187.23,-480.06 24162.64,-469.31 24139,-464 23874.29,-404.53 19566.67,-461 19205.39,-427.78"/>
<polygon fill="black" stroke="black" points="19205.75,-424.3 19195.44,-426.72 19205.01,-431.26 19205.75,-424.3"/>
</g>
<!-- res_ffn3_14 -->
<g id="node2561" class="node">
<title>res_ffn3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="21716.26,-428 21396.1,-428 21313.74,-322 21633.9,-322 21716.26,-428"/>
<text text-anchor="middle" x="21515" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21515" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="21515" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn2_3_14&#45;&gt;res_ffn3_14 -->
<g id="edge3575" class="edge">
<title>ffn2_3_14&#45;&gt;res_ffn3_14</title>
<path fill="none" stroke="black" d="M25551.32,-490.45C25531.22,-480.09 25506.63,-469.34 25483,-464 25282.03,-418.61 22019.84,-453.33 21725.63,-427.76"/>
<polygon fill="black" stroke="black" points="21725.75,-424.26 21715.44,-426.71 21725.03,-431.22 21725.75,-424.26"/>
</g>
<!-- res_ffn3_15 -->
<g id="node2562" class="node">
<title>res_ffn3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="20036.26,-428 19716.1,-428 19633.74,-322 19953.9,-322 20036.26,-428"/>
<text text-anchor="middle" x="19835" y="-386.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19835" y="-371.3" font-family="Times,serif" font-size="14.00">Input: [B, L/16, d_model]</text>
<text text-anchor="middle" x="19835" y="-356.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn2_3_15&#45;&gt;res_ffn3_15 -->
<g id="edge3584" class="edge">
<title>ffn2_3_15&#45;&gt;res_ffn3_15</title>
<path fill="none" stroke="black" d="M24655.32,-490.43C24635.23,-480.07 24610.63,-469.32 24587,-464 24343.58,-409.23 20385.75,-458.41 20045.62,-427.79"/>
<polygon fill="black" stroke="black" points="20045.75,-424.28 20035.44,-426.71 20045.02,-431.24 20045.75,-424.28"/>
</g>
<!-- res_attn3_0&#45;&gt;ffn1_3_0 -->
<g id="edge3446" class="edge">
<title>res_attn3_0&#45;&gt;ffn1_3_0</title>
<path fill="none" stroke="black" d="M16164.4,-570.05C16196.14,-582.71 16231.32,-594.47 16265,-601 16331.43,-613.88 17417.57,-591.75 17483,-609 17576.5,-633.65 17579.63,-689.84 17673,-715 17917.33,-780.84 21858.55,-799.71 22571.04,-802.58"/>
<polygon fill="black" stroke="black" points="22571.28,-806.09 22581.29,-802.63 22571.31,-799.09 22571.28,-806.09"/>
</g>
<!-- res_attn3_0&#45;&gt;res_ffn3_0 -->
<g id="edge3450" class="edge">
<title>res_attn3_0&#45;&gt;res_ffn3_0</title>
<path fill="none" stroke="black" d="M16055,-463.87C16055,-455.58 16055,-446.93 16055,-438.43"/>
<polygon fill="black" stroke="black" points="16058.5,-438.17 16055,-428.17 16051.5,-438.17 16058.5,-438.17"/>
</g>
<!-- res_attn3_1&#45;&gt;ffn1_3_1 -->
<g id="edge3455" class="edge">
<title>res_attn3_1&#45;&gt;ffn1_3_1</title>
<path fill="none" stroke="black" d="M17004.7,-570.05C17036.36,-582.66 17071.44,-594.4 17105,-601 17123.59,-604.65 17770.2,-600.25 17787,-609 17838.41,-635.78 17811.53,-688.34 17863,-715 17989.98,-780.77 22871.36,-720.15 23011,-751 23031.53,-755.54 23052.81,-764.06 23071.35,-772.92"/>
<polygon fill="black" stroke="black" points="23069.98,-776.14 23080.49,-777.42 23073.07,-769.86 23069.98,-776.14"/>
</g>
<!-- res_attn3_1&#45;&gt;res_ffn3_1 -->
<g id="edge3459" class="edge">
<title>res_attn3_1&#45;&gt;res_ffn3_1</title>
<path fill="none" stroke="black" d="M16895,-463.87C16895,-455.58 16895,-446.93 16895,-438.43"/>
<polygon fill="black" stroke="black" points="16898.5,-438.17 16895,-428.17 16891.5,-438.17 16898.5,-438.17"/>
</g>
<!-- res_attn3_2&#45;&gt;ffn1_3_2 -->
<g id="edge3464" class="edge">
<title>res_attn3_2&#45;&gt;ffn1_3_2</title>
<path fill="none" stroke="black" d="M17425.29,-570.01C17456.81,-582.53 17491.67,-594.24 17525,-601 17598.63,-615.93 17789.39,-593.97 17863,-609 17987.69,-634.46 18004.1,-690.57 18129,-715 18407.35,-769.44 22957.06,-689.8 23234,-751 23254.53,-755.54 23275.81,-764.06 23294.35,-772.92"/>
<polygon fill="black" stroke="black" points="23292.98,-776.14 23303.49,-777.42 23296.07,-769.86 23292.98,-776.14"/>
</g>
<!-- res_attn3_2&#45;&gt;res_ffn3_2 -->
<g id="edge3468" class="edge">
<title>res_attn3_2&#45;&gt;res_ffn3_2</title>
<path fill="none" stroke="black" d="M17315,-463.87C17315,-455.58 17315,-446.93 17315,-438.43"/>
<polygon fill="black" stroke="black" points="17318.5,-438.17 17315,-428.17 17311.5,-438.17 17318.5,-438.17"/>
</g>
<!-- res_attn3_3&#45;&gt;ffn1_3_3 -->
<g id="edge3473" class="edge">
<title>res_attn3_3&#45;&gt;ffn1_3_3</title>
<path fill="none" stroke="black" d="M18278.96,-570.06C18307.01,-580.98 18336.83,-591.92 18365,-601 18562.19,-664.54 18611.49,-688.71 18817,-715 19085.05,-749.29 23417.05,-693.08 23681,-751 23701.69,-755.54 23723.15,-764.07 23741.85,-772.92"/>
<polygon fill="black" stroke="black" points="23740.56,-776.18 23751.08,-777.42 23743.62,-769.89 23740.56,-776.18"/>
</g>
<!-- res_attn3_3&#45;&gt;res_ffn3_3 -->
<g id="edge3477" class="edge">
<title>res_attn3_3&#45;&gt;res_ffn3_3</title>
<path fill="none" stroke="black" d="M18155,-463.87C18155,-455.58 18155,-446.93 18155,-438.43"/>
<polygon fill="black" stroke="black" points="18158.5,-438.17 18155,-428.17 18151.5,-438.17 18158.5,-438.17"/>
</g>
<!-- res_attn3_4&#45;&gt;ffn1_3_4 -->
<g id="edge3482" class="edge">
<title>res_attn3_4&#45;&gt;ffn1_3_4</title>
<path fill="none" stroke="black" d="M16584.41,-570.02C16616.14,-582.68 16651.33,-594.45 16685,-601 16711.94,-606.24 17647.5,-598.86 17673,-609 17737.29,-634.57 17722.7,-689.46 17787,-715 17916.16,-766.31 22654.4,-720.54 22790,-751 22810.13,-755.52 22830.95,-763.99 22849.1,-772.8"/>
<polygon fill="black" stroke="black" points="22847.82,-776.07 22858.33,-777.42 22850.95,-769.81 22847.82,-776.07"/>
</g>
<!-- res_attn3_4&#45;&gt;res_ffn3_4 -->
<g id="edge3486" class="edge">
<title>res_attn3_4&#45;&gt;res_ffn3_4</title>
<path fill="none" stroke="black" d="M16475,-463.87C16475,-455.58 16475,-446.93 16475,-438.43"/>
<polygon fill="black" stroke="black" points="16478.5,-438.17 16475,-428.17 16471.5,-438.17 16478.5,-438.17"/>
</g>
<!-- res_attn3_5&#45;&gt;ffn1_3_5 -->
<g id="edge3491" class="edge">
<title>res_attn3_5&#45;&gt;ffn1_3_5</title>
<path fill="none" stroke="black" d="M17846.48,-570.01C17877.71,-582.37 17912.12,-593.99 17945,-601 18025.06,-618.06 18048.98,-591.78 18129,-609 18253.01,-635.69 18269.52,-690.57 18394,-715 18670.02,-769.17 23182.24,-690.75 23457,-751 23477.69,-755.54 23499.15,-764.06 23517.85,-772.92"/>
<polygon fill="black" stroke="black" points="23516.56,-776.18 23527.08,-777.42 23519.62,-769.89 23516.56,-776.18"/>
</g>
<!-- res_attn3_5&#45;&gt;res_ffn3_5 -->
<g id="edge3495" class="edge">
<title>res_attn3_5&#45;&gt;res_ffn3_5</title>
<path fill="none" stroke="black" d="M17735,-463.87C17735,-455.58 17735,-446.93 17735,-438.43"/>
<polygon fill="black" stroke="black" points="17738.5,-438.17 17735,-428.17 17731.5,-438.17 17738.5,-438.17"/>
</g>
<!-- res_attn3_6&#45;&gt;ffn1_3_6 -->
<g id="edge3500" class="edge">
<title>res_attn3_6&#45;&gt;ffn1_3_6</title>
<path fill="none" stroke="black" d="M20370.06,-570.01C20400.41,-581.9 20433.49,-593.3 20465,-601 20943.31,-717.92 21075.41,-686.9 21567,-715 21746.38,-725.26 24625.57,-712.16 24801,-751 24821.68,-755.58 24843.14,-764.11 24861.84,-772.97"/>
<polygon fill="black" stroke="black" points="24860.55,-776.23 24871.07,-777.46 24863.61,-769.93 24860.55,-776.23"/>
</g>
<!-- res_attn3_6&#45;&gt;res_ffn3_6 -->
<g id="edge3504" class="edge">
<title>res_attn3_6&#45;&gt;res_ffn3_6</title>
<path fill="none" stroke="black" d="M20255,-463.87C20255,-455.58 20255,-446.93 20255,-438.43"/>
<polygon fill="black" stroke="black" points="20258.5,-438.17 20255,-428.17 20251.5,-438.17 20258.5,-438.17"/>
</g>
<!-- res_attn3_7&#45;&gt;ffn1_3_7 -->
<g id="edge3509" class="edge">
<title>res_attn3_7&#45;&gt;ffn1_3_7</title>
<path fill="none" stroke="black" d="M18688.84,-570.08C18719.49,-582.13 18753.02,-593.58 18785,-601 19404.77,-744.84 19576.39,-686.55 20212,-715 20416.97,-724.18 23704.64,-706.78 23905,-751 23925.68,-755.56 23947.14,-764.1 23965.85,-772.95"/>
<polygon fill="black" stroke="black" points="23964.55,-776.21 23975.07,-777.45 23967.62,-769.92 23964.55,-776.21"/>
</g>
<!-- res_attn3_7&#45;&gt;res_ffn3_7 -->
<g id="edge3513" class="edge">
<title>res_attn3_7&#45;&gt;res_ffn3_7</title>
<path fill="none" stroke="black" d="M18575,-463.87C18575,-455.58 18575,-446.93 18575,-438.43"/>
<polygon fill="black" stroke="black" points="18578.5,-438.17 18575,-428.17 18571.5,-438.17 18578.5,-438.17"/>
</g>
<!-- res_attn3_8&#45;&gt;ffn1_3_8 -->
<g id="edge3518" class="edge">
<title>res_attn3_8&#45;&gt;ffn1_3_8</title>
<path fill="none" stroke="black" d="M20784.7,-570.05C20816.36,-582.66 20851.44,-594.4 20885,-601 20959.36,-615.61 21491.62,-601.16 21567,-609 21808.1,-634.08 21860.91,-689.85 22102,-715 22425.05,-748.7 24707.92,-680.6 25025,-751 25045.68,-755.59 25067.14,-764.13 25085.84,-772.98"/>
<polygon fill="black" stroke="black" points="25084.54,-776.24 25095.07,-777.47 25087.61,-769.95 25084.54,-776.24"/>
</g>
<!-- res_attn3_8&#45;&gt;res_ffn3_8 -->
<g id="edge3522" class="edge">
<title>res_attn3_8&#45;&gt;res_ffn3_8</title>
<path fill="none" stroke="black" d="M20675,-463.87C20675,-455.58 20675,-446.93 20675,-438.43"/>
<polygon fill="black" stroke="black" points="20678.5,-438.17 20675,-428.17 20671.5,-438.17 20678.5,-438.17"/>
</g>
<!-- res_attn3_9&#45;&gt;ffn1_3_9 -->
<g id="edge3527" class="edge">
<title>res_attn3_9&#45;&gt;ffn1_3_9</title>
<path fill="none" stroke="black" d="M19524.7,-570.03C19556.36,-582.64 19591.44,-594.39 19625,-601 19642.03,-604.36 20235.87,-598.92 20250,-609 20290.74,-638.07 20247.2,-686.01 20288,-715 20380.05,-780.4 24242.72,-726.71 24353,-751 24373.69,-755.56 24395.15,-764.09 24413.85,-772.94"/>
<polygon fill="black" stroke="black" points="24412.55,-776.2 24423.07,-777.44 24415.62,-769.91 24412.55,-776.2"/>
</g>
<!-- res_attn3_9&#45;&gt;res_ffn3_9 -->
<g id="edge3531" class="edge">
<title>res_attn3_9&#45;&gt;res_ffn3_9</title>
<path fill="none" stroke="black" d="M19415,-463.87C19415,-455.58 19415,-446.93 19415,-438.43"/>
<polygon fill="black" stroke="black" points="19418.5,-438.17 19415,-428.17 19411.5,-438.17 19418.5,-438.17"/>
</g>
<!-- res_attn3_10&#45;&gt;ffn1_3_10 -->
<g id="edge3536" class="edge">
<title>res_attn3_10&#45;&gt;ffn1_3_10</title>
<path fill="none" stroke="black" d="M22058.34,-570.04C22086.55,-581.02 22116.6,-591.99 22145,-601 22159.39,-605.56 22163.6,-604.48 22178,-609 22302.19,-647.97 22323.2,-690.33 22451,-715 22805.15,-783.38 25344.84,-673.04 25697,-751 25717.68,-755.58 25739.14,-764.11 25757.84,-772.96"/>
<polygon fill="black" stroke="black" points="25756.55,-776.23 25767.07,-777.46 25759.61,-769.93 25756.55,-776.23"/>
</g>
<!-- res_attn3_10&#45;&gt;res_ffn3_10 -->
<g id="edge3540" class="edge">
<title>res_attn3_10&#45;&gt;res_ffn3_10</title>
<path fill="none" stroke="black" d="M21935,-463.87C21935,-455.58 21935,-446.93 21935,-438.43"/>
<polygon fill="black" stroke="black" points="21938.5,-438.17 21935,-428.17 21931.5,-438.17 21938.5,-438.17"/>
</g>
<!-- res_attn3_11&#45;&gt;ffn1_3_11 -->
<g id="edge3545" class="edge">
<title>res_attn3_11&#45;&gt;ffn1_3_11</title>
<path fill="none" stroke="black" d="M22408.76,-570.07C22462.37,-618.12 22549.58,-686.24 22640,-715 22813.72,-770.24 25743.02,-711.61 25921,-751 25941.68,-755.58 25963.14,-764.11 25981.84,-772.96"/>
<polygon fill="black" stroke="black" points="25980.55,-776.22 25991.07,-777.46 25983.61,-769.93 25980.55,-776.22"/>
</g>
<!-- res_attn3_11&#45;&gt;res_ffn3_11 -->
<g id="edge3549" class="edge">
<title>res_attn3_11&#45;&gt;res_ffn3_11</title>
<path fill="none" stroke="black" d="M22355,-463.87C22355,-455.58 22355,-446.93 22355,-438.43"/>
<polygon fill="black" stroke="black" points="22358.5,-438.17 22355,-428.17 22351.5,-438.17 22358.5,-438.17"/>
</g>
<!-- res_attn3_12&#45;&gt;ffn1_3_12 -->
<g id="edge3554" class="edge">
<title>res_attn3_12&#45;&gt;ffn1_3_12</title>
<path fill="none" stroke="black" d="M21204.69,-570.09C21236.35,-582.7 21271.43,-594.43 21305,-601 21326.73,-605.25 22083.96,-596.17 22102,-609 22142.78,-638.01 22099.24,-685.96 22140,-715 22210.34,-765.12 25164.68,-732.31 25249,-751 25269.68,-755.58 25291.14,-764.12 25309.84,-772.97"/>
<polygon fill="black" stroke="black" points="25308.54,-776.23 25319.07,-777.47 25311.61,-769.94 25308.54,-776.23"/>
</g>
<!-- res_attn3_12&#45;&gt;res_ffn3_12 -->
<g id="edge3558" class="edge">
<title>res_attn3_12&#45;&gt;res_ffn3_12</title>
<path fill="none" stroke="black" d="M21095,-463.87C21095,-455.58 21095,-446.93 21095,-438.43"/>
<polygon fill="black" stroke="black" points="21098.5,-438.17 21095,-428.17 21091.5,-438.17 21098.5,-438.17"/>
</g>
<!-- res_attn3_13&#45;&gt;ffn1_3_13 -->
<g id="edge3563" class="edge">
<title>res_attn3_13&#45;&gt;ffn1_3_13</title>
<path fill="none" stroke="black" d="M19104.41,-570.02C19136.14,-582.68 19171.33,-594.45 19205,-601 19218.73,-603.67 20200.59,-600.9 20212,-609 20252.81,-637.97 20209.21,-686.01 20250,-715 20337.83,-777.43 24023.77,-727.8 24129,-751 24149.68,-755.56 24171.15,-764.09 24189.85,-772.94"/>
<polygon fill="black" stroke="black" points="24188.55,-776.2 24199.07,-777.44 24191.62,-769.91 24188.55,-776.2"/>
</g>
<!-- res_attn3_13&#45;&gt;res_ffn3_13 -->
<g id="edge3567" class="edge">
<title>res_attn3_13&#45;&gt;res_ffn3_13</title>
<path fill="none" stroke="black" d="M18995,-463.87C18995,-455.58 18995,-446.93 18995,-438.43"/>
<polygon fill="black" stroke="black" points="18998.5,-438.17 18995,-428.17 18991.5,-438.17 18998.5,-438.17"/>
</g>
<!-- res_attn3_14&#45;&gt;ffn1_3_14 -->
<g id="edge3572" class="edge">
<title>res_attn3_14&#45;&gt;ffn1_3_14</title>
<path fill="none" stroke="black" d="M21625.27,-570.1C21656.79,-582.63 21691.66,-594.32 21725,-601 21747.61,-605.53 22121.27,-595.55 22140,-609 22180.65,-638.2 22137.23,-685.97 22178,-715 22252.56,-768.09 25383.63,-731.22 25473,-751 25493.68,-755.58 25515.14,-764.11 25533.84,-772.96"/>
<polygon fill="black" stroke="black" points="25532.55,-776.22 25543.07,-777.46 25535.61,-769.93 25532.55,-776.22"/>
</g>
<!-- res_attn3_14&#45;&gt;res_ffn3_14 -->
<g id="edge3576" class="edge">
<title>res_attn3_14&#45;&gt;res_ffn3_14</title>
<path fill="none" stroke="black" d="M21515,-463.87C21515,-455.58 21515,-446.93 21515,-438.43"/>
<polygon fill="black" stroke="black" points="21518.5,-438.17 21515,-428.17 21511.5,-438.17 21518.5,-438.17"/>
</g>
<!-- res_attn3_15&#45;&gt;ffn1_3_15 -->
<g id="edge3581" class="edge">
<title>res_attn3_15&#45;&gt;ffn1_3_15</title>
<path fill="none" stroke="black" d="M19945.88,-570.02C19977.26,-582.47 20011.89,-594.13 20045,-601 20097.9,-611.98 20235.44,-596.47 20288,-609 20396.7,-634.92 20406.99,-690.39 20516,-715 20956.16,-814.37 24136.32,-653.95 24577,-751 24597.69,-755.56 24619.15,-764.09 24637.85,-772.94"/>
<polygon fill="black" stroke="black" points="24636.55,-776.2 24647.07,-777.44 24639.62,-769.91 24636.55,-776.2"/>
</g>
<!-- res_attn3_15&#45;&gt;res_ffn3_15 -->
<g id="edge3585" class="edge">
<title>res_attn3_15&#45;&gt;res_ffn3_15</title>
<path fill="none" stroke="black" d="M19835,-463.87C19835,-455.58 19835,-446.93 19835,-438.43"/>
<polygon fill="black" stroke="black" points="19838.5,-438.17 19835,-428.17 19831.5,-438.17 19838.5,-438.17"/>
</g>
<!-- sp_gather -->
<g id="node2563" class="node">
<title>sp_gather</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19410.05,-275 19083.86,-275 18999.95,-169 19326.14,-169 19410.05,-275"/>
<text text-anchor="middle" x="19205" y="-233.3" font-family="Times,serif" font-size="14.00">Sequence Parallel Gather</text>
<text text-anchor="middle" x="19205" y="-218.3" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="19205" y="-203.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15 → Host</text>
</g>
<!-- res_ffn3_0&#45;&gt;sp_gather -->
<g id="edge3586" class="edge">
<title>res_ffn3_0&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M16182.14,-332.24C16209.22,-324.88 16237.84,-318.23 16265,-314 16803.19,-230.12 18485.93,-222.84 19032.01,-222.75"/>
<polygon fill="black" stroke="black" points="19032.33,-226.25 19042.33,-222.75 19032.33,-219.25 19032.33,-226.25"/>
</g>
<!-- res_ffn3_1&#45;&gt;sp_gather -->
<g id="edge3587" class="edge">
<title>res_ffn3_1&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M17022.19,-332.5C17049.26,-325.12 17077.86,-318.4 17105,-314 17474.8,-254.02 18602.26,-231.71 19034.16,-225.23"/>
<polygon fill="black" stroke="black" points="19034.29,-228.73 19044.24,-225.08 19034.18,-221.73 19034.29,-228.73"/>
</g>
<!-- res_ffn3_2&#45;&gt;sp_gather -->
<g id="edge3588" class="edge">
<title>res_ffn3_2&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M17442.5,-332.64C17469.49,-325.29 17497.98,-318.53 17525,-314 17811.82,-265.88 18668.97,-237.56 19035.6,-227.35"/>
<polygon fill="black" stroke="black" points="19035.87,-230.85 19045.77,-227.07 19035.68,-223.85 19035.87,-230.85"/>
</g>
<!-- res_ffn3_3&#45;&gt;sp_gather -->
<g id="edge3589" class="edge">
<title>res_ffn3_3&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M18282.99,-333.69C18309.87,-326.28 18338.21,-319.24 18365,-314 18596.66,-268.7 18868.99,-244.39 19039.32,-232.59"/>
<polygon fill="black" stroke="black" points="19039.64,-236.07 19049.38,-231.9 19039.16,-229.09 19039.64,-236.07"/>
</g>
<!-- res_ffn3_4&#45;&gt;sp_gather -->
<g id="edge3590" class="edge">
<title>res_ffn3_4&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M16602.16,-332.34C16629.23,-324.98 16657.85,-318.3 16685,-314 17138.72,-242.08 18542.13,-226.92 19033.2,-223.79"/>
<polygon fill="black" stroke="black" points="19033.23,-227.29 19043.21,-223.73 19033.18,-220.29 19033.23,-227.29"/>
</g>
<!-- res_ffn3_5&#45;&gt;sp_gather -->
<g id="edge3591" class="edge">
<title>res_ffn3_5&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M17862.57,-333.02C17889.55,-325.63 17918.02,-318.78 17945,-314 18329.88,-245.87 18789.53,-228.5 19033.32,-224.23"/>
<polygon fill="black" stroke="black" points="19033.39,-227.73 19043.33,-224.06 19033.27,-220.73 19033.39,-227.73"/>
</g>
<!-- res_ffn3_6&#45;&gt;sp_gather -->
<g id="edge3592" class="edge">
<title>res_ffn3_6&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M20081.66,-321.99C20069.31,-319.05 20057,-316.35 20045,-314 19820.75,-270.15 19558.39,-245.97 19387.33,-233.76"/>
<polygon fill="black" stroke="black" points="19387.44,-230.26 19377.22,-233.04 19386.95,-237.24 19387.44,-230.26"/>
</g>
<!-- res_ffn3_7&#45;&gt;sp_gather -->
<g id="edge3593" class="edge">
<title>res_ffn3_7&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M18704.59,-335.55C18731.11,-328.08 18758.89,-320.55 18785,-314 18873.83,-291.71 18974.04,-269.88 19054.29,-253.18"/>
<polygon fill="black" stroke="black" points="19055.39,-256.53 19064.47,-251.07 19053.97,-249.67 19055.39,-256.53"/>
</g>
<!-- res_ffn3_8&#45;&gt;sp_gather -->
<g id="edge3594" class="edge">
<title>res_ffn3_8&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M20503.77,-321.96C20490.72,-318.96 20477.69,-316.25 20465,-314 20081.85,-246.18 19624.6,-228.65 19379.98,-224.29"/>
<polygon fill="black" stroke="black" points="19379.99,-220.79 19369.94,-224.11 19379.87,-227.79 19379.99,-220.79"/>
</g>
<!-- res_ffn3_9&#45;&gt;sp_gather -->
<g id="edge3595" class="edge">
<title>res_ffn3_9&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M19342.44,-321.82C19324.16,-308.68 19304.42,-294.49 19285.77,-281.08"/>
<polygon fill="black" stroke="black" points="19287.73,-278.18 19277.57,-275.18 19283.64,-283.86 19287.73,-278.18"/>
</g>
<!-- res_ffn3_10&#45;&gt;sp_gather -->
<g id="edge3596" class="edge">
<title>res_ffn3_10&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M21766.16,-321.96C21752.32,-318.86 21738.48,-316.14 21725,-314 21272.22,-242.23 19873.67,-226.99 19379.86,-223.81"/>
<polygon fill="black" stroke="black" points="19379.82,-220.31 19369.8,-223.75 19379.77,-227.31 19379.82,-220.31"/>
</g>
<!-- res_ffn3_11&#45;&gt;sp_gather -->
<g id="edge3597" class="edge">
<title>res_ffn3_11&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M22186.46,-321.95C22172.53,-318.84 22158.58,-316.12 22145,-314 21607.28,-230.19 19927.01,-222.86 19379.43,-222.75"/>
<polygon fill="black" stroke="black" points="19379.07,-219.25 19369.07,-222.75 19379.07,-226.25 19379.07,-219.25"/>
</g>
<!-- res_ffn3_12&#45;&gt;sp_gather -->
<g id="edge3598" class="edge">
<title>res_ffn3_12&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M20924.96,-321.97C20911.52,-318.91 20898.09,-316.2 20885,-314 20600.25,-266.23 19753.38,-237.97 19382.41,-227.58"/>
<polygon fill="black" stroke="black" points="19382.48,-224.08 19372.39,-227.3 19382.28,-231.07 19382.48,-224.08"/>
</g>
<!-- res_ffn3_13&#45;&gt;sp_gather -->
<g id="edge3599" class="edge">
<title>res_ffn3_13&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M19067.56,-321.82C19085.84,-308.68 19105.58,-294.49 19124.23,-281.08"/>
<polygon fill="black" stroke="black" points="19126.36,-283.86 19132.43,-275.18 19122.27,-278.18 19126.36,-283.86"/>
</g>
<!-- res_ffn3_14&#45;&gt;sp_gather -->
<g id="edge3600" class="edge">
<title>res_ffn3_14&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M21345.57,-321.94C21331.93,-318.87 21318.29,-316.16 21305,-314 20936.65,-254.25 19816.58,-231.89 19380.96,-225.31"/>
<polygon fill="black" stroke="black" points="19380.84,-221.81 19370.79,-225.16 19380.74,-228.81 19380.84,-221.81"/>
</g>
<!-- res_ffn3_15&#45;&gt;sp_gather -->
<g id="edge3601" class="edge">
<title>res_ffn3_15&#45;&gt;sp_gather</title>
<path fill="none" stroke="black" d="M19655.92,-321.99C19645.48,-319.22 19635.11,-316.54 19625,-314 19555.42,-296.54 19478.87,-279.36 19410.39,-264.71"/>
<polygon fill="black" stroke="black" points="19410.85,-261.23 19400.34,-262.57 19409.39,-268.08 19410.85,-261.23"/>
</g>
<!-- output -->
<g id="node2564" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="lightyellow" points="19353.01,-122 19117.56,-122 19056.99,-16 19292.44,-16 19353.01,-122"/>
<text text-anchor="middle" x="19205" y="-80.3" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="19205" y="-65.3" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="19205" y="-50.3" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- sp_gather&#45;&gt;output -->
<g id="edge3602" class="edge">
<title>sp_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M19205,-168.61C19205,-156.83 19205,-144.22 19205,-132.09"/>
<polygon fill="black" stroke="black" points="19208.5,-132.04 19205,-122.04 19201.5,-132.04 19208.5,-132.04"/>
</g>
</g>
</svg>
