<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="8pt"
 viewBox="0.00 0.00 1440.00 7.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.01 0.01) rotate(0) translate(4 601)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-601 109824,-601 109824,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="lightblue" stroke="lightblue" d="M6562,-280.5C6562,-280.5 13072,-280.5 13072,-280.5 13078,-280.5 13084,-286.5 13084,-292.5 13084,-292.5 13084,-577 13084,-577 13084,-583 13078,-589 13072,-589 13072,-589 6562,-589 6562,-589 6556,-589 6550,-583 6550,-577 6550,-577 6550,-292.5 6550,-292.5 6550,-286.5 6556,-280.5 6562,-280.5"/>
<text text-anchor="middle" x="9817" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="lightblue" stroke="lightblue" d="M20,-280.5C20,-280.5 6530,-280.5 6530,-280.5 6536,-280.5 6542,-286.5 6542,-292.5 6542,-292.5 6542,-577 6542,-577 6542,-583 6536,-589 6530,-589 6530,-589 20,-589 20,-589 14,-589 8,-583 8,-577 8,-577 8,-292.5 8,-292.5 8,-286.5 14,-280.5 20,-280.5"/>
<text text-anchor="middle" x="3275" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="lightblue" stroke="lightblue" d="M14250,-280.5C14250,-280.5 20761,-280.5 20761,-280.5 20767,-280.5 20773,-286.5 20773,-292.5 20773,-292.5 20773,-577 20773,-577 20773,-583 20767,-589 20761,-589 20761,-589 14250,-589 14250,-589 14244,-589 14238,-583 14238,-577 14238,-577 14238,-292.5 14238,-292.5 14238,-286.5 14244,-280.5 14250,-280.5"/>
<text text-anchor="middle" x="17505.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="lightblue" stroke="lightblue" d="M20793,-280.5C20793,-280.5 27304,-280.5 27304,-280.5 27310,-280.5 27316,-286.5 27316,-292.5 27316,-292.5 27316,-577 27316,-577 27316,-583 27310,-589 27304,-589 27304,-589 20793,-589 20793,-589 20787,-589 20781,-583 20781,-577 20781,-577 20781,-292.5 20781,-292.5 20781,-286.5 20787,-280.5 20793,-280.5"/>
<text text-anchor="middle" x="24048.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<path fill="lightblue" stroke="lightblue" d="M27336,-280.5C27336,-280.5 33846,-280.5 33846,-280.5 33852,-280.5 33858,-286.5 33858,-292.5 33858,-292.5 33858,-577 33858,-577 33858,-583 33852,-589 33846,-589 33846,-589 27336,-589 27336,-589 27330,-589 27324,-583 27324,-577 27324,-577 27324,-292.5 27324,-292.5 27324,-286.5 27330,-280.5 27336,-280.5"/>
<text text-anchor="middle" x="30591" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<path fill="lightblue" stroke="lightblue" d="M33878,-280.5C33878,-280.5 40388,-280.5 40388,-280.5 40394,-280.5 40400,-286.5 40400,-292.5 40400,-292.5 40400,-577 40400,-577 40400,-583 40394,-589 40388,-589 40388,-589 33878,-589 33878,-589 33872,-589 33866,-583 33866,-577 33866,-577 33866,-292.5 33866,-292.5 33866,-286.5 33872,-280.5 33878,-280.5"/>
<text text-anchor="middle" x="37133" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<path fill="lightblue" stroke="lightblue" d="M41566,-280.5C41566,-280.5 48077,-280.5 48077,-280.5 48083,-280.5 48089,-286.5 48089,-292.5 48089,-292.5 48089,-577 48089,-577 48089,-583 48083,-589 48077,-589 48077,-589 41566,-589 41566,-589 41560,-589 41554,-583 41554,-577 41554,-577 41554,-292.5 41554,-292.5 41554,-286.5 41560,-280.5 41566,-280.5"/>
<text text-anchor="middle" x="44821.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<path fill="lightblue" stroke="lightblue" d="M48109,-280.5C48109,-280.5 54620,-280.5 54620,-280.5 54626,-280.5 54632,-286.5 54632,-292.5 54632,-292.5 54632,-577 54632,-577 54632,-583 54626,-589 54620,-589 54620,-589 48109,-589 48109,-589 48103,-589 48097,-583 48097,-577 48097,-577 48097,-292.5 48097,-292.5 48097,-286.5 48103,-280.5 48109,-280.5"/>
<text text-anchor="middle" x="51364.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<path fill="lightblue" stroke="lightblue" d="M54794,-280.5C54794,-280.5 61304,-280.5 61304,-280.5 61310,-280.5 61316,-286.5 61316,-292.5 61316,-292.5 61316,-577 61316,-577 61316,-583 61310,-589 61304,-589 61304,-589 54794,-589 54794,-589 54788,-589 54782,-583 54782,-577 54782,-577 54782,-292.5 54782,-292.5 54782,-286.5 54788,-280.5 54794,-280.5"/>
<text text-anchor="middle" x="58049" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<path fill="lightblue" stroke="lightblue" d="M61402,-280.5C61402,-280.5 67912,-280.5 67912,-280.5 67918,-280.5 67924,-286.5 67924,-292.5 67924,-292.5 67924,-577 67924,-577 67924,-583 67918,-589 67912,-589 67912,-589 61402,-589 61402,-589 61396,-589 61390,-583 61390,-577 61390,-577 61390,-292.5 61390,-292.5 61390,-286.5 61396,-280.5 61402,-280.5"/>
<text text-anchor="middle" x="64657" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<path fill="lightblue" stroke="lightblue" d="M69128,-280.5C69128,-280.5 75639,-280.5 75639,-280.5 75645,-280.5 75651,-286.5 75651,-292.5 75651,-292.5 75651,-577 75651,-577 75651,-583 75645,-589 75639,-589 75639,-589 69128,-589 69128,-589 69122,-589 69116,-583 69116,-577 69116,-577 69116,-292.5 69116,-292.5 69116,-286.5 69122,-280.5 69128,-280.5"/>
<text text-anchor="middle" x="72383.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<path fill="lightblue" stroke="lightblue" d="M75737,-280.5C75737,-280.5 82248,-280.5 82248,-280.5 82254,-280.5 82260,-286.5 82260,-292.5 82260,-292.5 82260,-577 82260,-577 82260,-583 82254,-589 82248,-589 82248,-589 75737,-589 75737,-589 75731,-589 75725,-583 75725,-577 75725,-577 75725,-292.5 75725,-292.5 75725,-286.5 75731,-280.5 75737,-280.5"/>
<text text-anchor="middle" x="78992.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<path fill="lightblue" stroke="lightblue" d="M82346,-280.5C82346,-280.5 88856,-280.5 88856,-280.5 88862,-280.5 88868,-286.5 88868,-292.5 88868,-292.5 88868,-577 88868,-577 88868,-583 88862,-589 88856,-589 88856,-589 82346,-589 82346,-589 82340,-589 82334,-583 82334,-577 82334,-577 82334,-292.5 82334,-292.5 82334,-286.5 82340,-280.5 82346,-280.5"/>
<text text-anchor="middle" x="85601" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<path fill="lightblue" stroke="lightblue" d="M88954,-280.5C88954,-280.5 95464,-280.5 95464,-280.5 95470,-280.5 95476,-286.5 95476,-292.5 95476,-292.5 95476,-577 95476,-577 95476,-583 95470,-589 95464,-589 95464,-589 88954,-589 88954,-589 88948,-589 88942,-583 88942,-577 88942,-577 88942,-292.5 88942,-292.5 88942,-286.5 88948,-280.5 88954,-280.5"/>
<text text-anchor="middle" x="92209" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<path fill="lightblue" stroke="lightblue" d="M96680,-280.5C96680,-280.5 103191,-280.5 103191,-280.5 103197,-280.5 103203,-286.5 103203,-292.5 103203,-292.5 103203,-577 103203,-577 103203,-583 103197,-589 103191,-589 103191,-589 96680,-589 96680,-589 96674,-589 96668,-583 96668,-577 96668,-577 96668,-292.5 96668,-292.5 96668,-286.5 96674,-280.5 96680,-280.5"/>
<text text-anchor="middle" x="99935.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<path fill="lightblue" stroke="lightblue" d="M103289,-280.5C103289,-280.5 109800,-280.5 109800,-280.5 109806,-280.5 109812,-286.5 109812,-292.5 109812,-292.5 109812,-577 109812,-577 109812,-583 109806,-589 109800,-589 109800,-589 103289,-589 103289,-589 103283,-589 103277,-583 103277,-577 103277,-577 103277,-292.5 103277,-292.5 103277,-286.5 103283,-280.5 103289,-280.5"/>
<text text-anchor="middle" x="106544.5" y="-573.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- embed_0 -->
<g id="node1" class="node">
<title>embed_0</title>
<polygon fill="none" stroke="black" points="7433,-516.5 7213,-516.5 7213,-463.5 7433,-463.5 7433,-516.5"/>
<text text-anchor="middle" x="7323" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="7323" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="7323" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu0_ln1 -->
<g id="node2" class="node">
<title>layer0_gpu0_ln1</title>
<ellipse fill="none" stroke="black" cx="7323" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="7323" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7323" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="7323" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- embed_0&#45;&gt;layer0_gpu0_ln1 -->
<g id="edge1" class="edge">
<title>embed_0&#45;&gt;layer0_gpu0_ln1</title>
<path fill="none" stroke="black" d="M7323,-463.33C7323,-439.41 7323,-403.17 7323,-374.06"/>
<polygon fill="black" stroke="black" points="7326.5,-373.69 7323,-363.69 7319.5,-373.69 7326.5,-373.69"/>
</g>
<!-- layer0_gpu0_qkv -->
<g id="node3" class="node">
<title>layer0_gpu0_qkv</title>
<polygon fill="none" stroke="black" points="12914,-524 12784,-524 12784,-456 12914,-456 12914,-524"/>
<text text-anchor="middle" x="12849" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12849" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12849" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="12849" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_reshape -->
<g id="node4" class="node">
<title>layer0_gpu0_reshape</title>
<ellipse fill="none" stroke="black" cx="12698" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="12698" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="12698" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="12698" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_attn -->
<g id="node5" class="node">
<title>layer0_gpu0_attn</title>
<polygon fill="none" stroke="black" points="12457,-558 12302,-490 12457,-422 12612,-490 12457,-558"/>
<text text-anchor="middle" x="12457" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="12457" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12457" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="12457" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_out_proj -->
<g id="node6" class="node">
<title>layer0_gpu0_out_proj</title>
<polygon fill="none" stroke="black" points="9849,-524 9705,-524 9705,-456 9849,-456 9849,-524"/>
<text text-anchor="middle" x="9777" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9777" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="9777" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="9777" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_concat_group0 -->
<g id="node593" class="node">
<title>layer0_concat_group0</title>
<polygon fill="yellow" stroke="black" points="13340,-302.8 13340,-349.2 13268.53,-382 13167.47,-382 13096,-349.2 13096,-302.8 13167.47,-270 13268.53,-270 13340,-302.8"/>
<polygon fill="none" stroke="black" points="13344,-300.24 13344,-351.76 13269.41,-386 13166.59,-386 13092,-351.76 13092,-300.24 13166.59,-266 13269.41,-266 13344,-300.24"/>
<text text-anchor="middle" x="13218" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="13218" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13218" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="13218" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- layer0_gpu0_out_proj&#45;&gt;layer0_concat_group0 -->
<g id="edge17" class="edge">
<title>layer0_gpu0_out_proj&#45;&gt;layer0_concat_group0</title>
<path fill="none" stroke="black" d="M9807.28,-455.92C9821.53,-442.73 9839.64,-429.02 9859,-422 10027.64,-360.8 12912.87,-424.9 13088,-386 13100.12,-383.31 13112.48,-379.41 13124.52,-374.88"/>
<polygon fill="black" stroke="black" points="13126.06,-378.03 13134.09,-371.12 13123.5,-371.52 13126.06,-378.03"/>
</g>
<!-- layer0_gpu0_ln2 -->
<g id="node7" class="node">
<title>layer0_gpu0_ln2</title>
<ellipse fill="none" stroke="black" cx="12039" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="12039" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12039" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="12039" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_mlp1 -->
<g id="node8" class="node">
<title>layer0_gpu0_mlp1</title>
<polygon fill="none" stroke="black" points="11945,-524 11811,-524 11811,-456 11945,-456 11945,-524"/>
<text text-anchor="middle" x="11878" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="11878" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11878" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="11878" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_gelu -->
<g id="node9" class="node">
<title>layer0_gpu0_gelu</title>
<ellipse fill="none" stroke="black" cx="11698" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11698" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11698" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="11698" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer0_gpu0_mlp2 -->
<g id="node10" class="node">
<title>layer0_gpu0_mlp2</title>
<polygon fill="none" stroke="black" points="11584.5,-524 11477.5,-524 11477.5,-456 11584.5,-456 11584.5,-524"/>
<text text-anchor="middle" x="11531" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="11531" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11531" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="11531" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_ln1 -->
<g id="node11" class="node">
<title>layer1_gpu0_ln1</title>
<ellipse fill="none" stroke="black" cx="8157" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="8157" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8157" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="8157" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_qkv -->
<g id="node12" class="node">
<title>layer1_gpu0_qkv</title>
<polygon fill="none" stroke="black" points="11297,-524 11167,-524 11167,-456 11297,-456 11297,-524"/>
<text text-anchor="middle" x="11232" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11232" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11232" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="11232" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_reshape -->
<g id="node13" class="node">
<title>layer1_gpu0_reshape</title>
<ellipse fill="none" stroke="black" cx="11081" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="11081" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="11081" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="11081" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_attn -->
<g id="node14" class="node">
<title>layer1_gpu0_attn</title>
<polygon fill="none" stroke="black" points="10840,-558 10685,-490 10840,-422 10995,-490 10840,-558"/>
<text text-anchor="middle" x="10840" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="10840" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10840" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="10840" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_out_proj -->
<g id="node15" class="node">
<title>layer1_gpu0_out_proj</title>
<polygon fill="none" stroke="black" points="11459,-524 11315,-524 11315,-456 11459,-456 11459,-524"/>
<text text-anchor="middle" x="11387" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11387" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11387" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="11387" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_concat_group0 -->
<g id="node594" class="node">
<title>layer1_concat_group0</title>
<polygon fill="yellow" stroke="black" points="13880,-302.8 13880,-349.2 13808.53,-382 13707.47,-382 13636,-349.2 13636,-302.8 13707.47,-270 13808.53,-270 13880,-302.8"/>
<polygon fill="none" stroke="black" points="13884,-300.24 13884,-351.76 13809.41,-386 13706.59,-386 13632,-351.76 13632,-300.24 13706.59,-266 13809.41,-266 13884,-300.24"/>
<text text-anchor="middle" x="13758" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="13758" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13758" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="13758" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- layer1_gpu0_out_proj&#45;&gt;layer1_concat_group0 -->
<g id="edge18" class="edge">
<title>layer1_gpu0_out_proj&#45;&gt;layer1_concat_group0</title>
<path fill="none" stroke="black" d="M11417.29,-455.97C11431.55,-442.79 11449.66,-429.08 11469,-422 11693.78,-339.72 13389.11,-436.92 13623,-386 13636.17,-383.13 13649.64,-378.94 13662.73,-374.1"/>
<polygon fill="black" stroke="black" points="13664.11,-377.32 13672.19,-370.47 13661.6,-370.79 13664.11,-377.32"/>
</g>
<!-- layer1_gpu0_ln2 -->
<g id="node16" class="node">
<title>layer1_gpu0_ln2</title>
<ellipse fill="none" stroke="black" cx="10429" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="10429" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10429" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="10429" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_mlp1 -->
<g id="node17" class="node">
<title>layer1_gpu0_mlp1</title>
<polygon fill="none" stroke="black" points="10335,-524 10201,-524 10201,-456 10335,-456 10335,-524"/>
<text text-anchor="middle" x="10268" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="10268" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10268" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="10268" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_gelu -->
<g id="node18" class="node">
<title>layer1_gpu0_gelu</title>
<ellipse fill="none" stroke="black" cx="10088" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10088" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10088" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="10088" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_gpu0_mlp2 -->
<g id="node19" class="node">
<title>layer1_gpu0_mlp2</title>
<polygon fill="none" stroke="black" points="9974.5,-524 9867.5,-524 9867.5,-456 9974.5,-456 9974.5,-524"/>
<text text-anchor="middle" x="9921" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="9921" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="9921" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="9921" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_ln1 -->
<g id="node20" class="node">
<title>layer2_gpu0_ln1</title>
<ellipse fill="none" stroke="black" cx="8981" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="8981" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8981" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="8981" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_qkv -->
<g id="node21" class="node">
<title>layer2_gpu0_qkv</title>
<polygon fill="none" stroke="black" points="9687,-524 9557,-524 9557,-456 9687,-456 9687,-524"/>
<text text-anchor="middle" x="9622" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9622" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9622" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="9622" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_reshape -->
<g id="node22" class="node">
<title>layer2_gpu0_reshape</title>
<ellipse fill="none" stroke="black" cx="9471" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="9471" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="9471" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="9471" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_attn -->
<g id="node23" class="node">
<title>layer2_gpu0_attn</title>
<polygon fill="none" stroke="black" points="9230,-558 9075,-490 9230,-422 9385,-490 9230,-558"/>
<text text-anchor="middle" x="9230" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="9230" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9230" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="9230" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_out_proj -->
<g id="node24" class="node">
<title>layer2_gpu0_out_proj</title>
<polygon fill="none" stroke="black" points="13076,-524 12932,-524 12932,-456 13076,-456 13076,-524"/>
<text text-anchor="middle" x="13004" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13004" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13004" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="13004" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_concat_group0 -->
<g id="node595" class="node">
<title>layer2_concat_group0</title>
<polygon fill="yellow" stroke="black" points="14226,-302.8 14226,-349.2 14154.53,-382 14053.47,-382 13982,-349.2 13982,-302.8 14053.47,-270 14154.53,-270 14226,-302.8"/>
<polygon fill="none" stroke="black" points="14230,-300.24 14230,-351.76 14155.41,-386 14052.59,-386 13978,-351.76 13978,-300.24 14052.59,-266 14155.41,-266 14230,-300.24"/>
<text text-anchor="middle" x="14104" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="14104" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="14104" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="14104" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- layer2_gpu0_out_proj&#45;&gt;layer2_concat_group0 -->
<g id="edge19" class="edge">
<title>layer2_gpu0_out_proj&#45;&gt;layer2_concat_group0</title>
<path fill="none" stroke="black" d="M13076.03,-488.39C13237.57,-485.5 13640.02,-469.71 13964,-386 13977.8,-382.43 13992.01,-377.75 14005.84,-372.57"/>
<polygon fill="black" stroke="black" points="14007.27,-375.77 14015.35,-368.91 14004.76,-369.23 14007.27,-375.77"/>
</g>
<!-- layer2_gpu0_ln2 -->
<g id="node25" class="node">
<title>layer2_gpu0_ln2</title>
<ellipse fill="none" stroke="black" cx="8812" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="8812" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8812" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="8812" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_mlp1 -->
<g id="node26" class="node">
<title>layer2_gpu0_mlp1</title>
<polygon fill="none" stroke="black" points="8718,-524 8584,-524 8584,-456 8718,-456 8718,-524"/>
<text text-anchor="middle" x="8651" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="8651" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8651" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="8651" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_gelu -->
<g id="node27" class="node">
<title>layer2_gpu0_gelu</title>
<ellipse fill="none" stroke="black" cx="8471" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="8471" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8471" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="8471" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_gpu0_mlp2 -->
<g id="node28" class="node">
<title>layer2_gpu0_mlp2</title>
<polygon fill="none" stroke="black" points="8357.5,-524 8250.5,-524 8250.5,-456 8357.5,-456 8357.5,-524"/>
<text text-anchor="middle" x="8304" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="8304" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8304" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="8304" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_ln1 -->
<g id="node29" class="node">
<title>layer3_gpu0_ln1</title>
<ellipse fill="none" stroke="black" cx="12208" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="12208" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12208" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="12208" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_qkv -->
<g id="node30" class="node">
<title>layer3_gpu0_qkv</title>
<polygon fill="none" stroke="black" points="8063,-524 7933,-524 7933,-456 8063,-456 8063,-524"/>
<text text-anchor="middle" x="7998" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7998" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="7998" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="7998" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_reshape -->
<g id="node31" class="node">
<title>layer3_gpu0_reshape</title>
<ellipse fill="none" stroke="black" cx="7847" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="7847" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7847" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="7847" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_attn -->
<g id="node32" class="node">
<title>layer3_gpu0_attn</title>
<polygon fill="none" stroke="black" points="7606,-558 7451,-490 7606,-422 7761,-490 7606,-558"/>
<text text-anchor="middle" x="7606" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="7606" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7606" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="7606" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_out_proj -->
<g id="node33" class="node">
<title>layer3_gpu0_out_proj</title>
<polygon fill="none" stroke="black" points="10667,-524 10523,-524 10523,-456 10667,-456 10667,-524"/>
<text text-anchor="middle" x="10595" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10595" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="10595" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="10595" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_concat_group0 -->
<g id="node596" class="node">
<title>layer3_concat_group0</title>
<polygon fill="yellow" stroke="black" points="13610,-302.8 13610,-349.2 13538.53,-382 13437.47,-382 13366,-349.2 13366,-302.8 13437.47,-270 13538.53,-270 13610,-302.8"/>
<polygon fill="none" stroke="black" points="13614,-300.24 13614,-351.76 13539.41,-386 13436.59,-386 13362,-351.76 13362,-300.24 13436.59,-266 13539.41,-266 13614,-300.24"/>
<text text-anchor="middle" x="13488" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="13488" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13488" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="13488" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- layer3_gpu0_out_proj&#45;&gt;layer3_concat_group0 -->
<g id="edge20" class="edge">
<title>layer3_gpu0_out_proj&#45;&gt;layer3_concat_group0</title>
<path fill="none" stroke="black" d="M10624.84,-455.95C10638.91,-442.76 10656.82,-429.05 10676,-422 10815.6,-370.68 13207.62,-417.4 13353,-386 13366.18,-383.15 13379.65,-378.98 13392.74,-374.14"/>
<polygon fill="black" stroke="black" points="13394.11,-377.36 13402.19,-370.51 13391.6,-370.83 13394.11,-377.36"/>
</g>
<!-- layer3_gpu0_ln2 -->
<g id="node34" class="node">
<title>layer3_gpu0_ln2</title>
<ellipse fill="none" stroke="black" cx="7119" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="7119" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7119" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="7119" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_mlp1 -->
<g id="node35" class="node">
<title>layer3_gpu0_mlp1</title>
<polygon fill="none" stroke="black" points="7025,-524 6891,-524 6891,-456 7025,-456 7025,-524"/>
<text text-anchor="middle" x="6958" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="6958" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6958" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="6958" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_gelu -->
<g id="node36" class="node">
<title>layer3_gpu0_gelu</title>
<ellipse fill="none" stroke="black" cx="6778" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="6778" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6778" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="6778" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_gpu0_mlp2 -->
<g id="node37" class="node">
<title>layer3_gpu0_mlp2</title>
<polygon fill="none" stroke="black" points="6664.5,-524 6557.5,-524 6557.5,-456 6664.5,-456 6664.5,-524"/>
<text text-anchor="middle" x="6611" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="6611" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="6611" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="6611" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- embed_1 -->
<g id="node38" class="node">
<title>embed_1</title>
<polygon fill="none" stroke="black" points="891,-516.5 671,-516.5 671,-463.5 891,-463.5 891,-516.5"/>
<text text-anchor="middle" x="781" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="781" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="781" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu1_ln1 -->
<g id="node39" class="node">
<title>layer0_gpu1_ln1</title>
<ellipse fill="none" stroke="black" cx="781" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="781" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="781" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="781" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- embed_1&#45;&gt;layer0_gpu1_ln1 -->
<g id="edge2" class="edge">
<title>embed_1&#45;&gt;layer0_gpu1_ln1</title>
<path fill="none" stroke="black" d="M781,-463.33C781,-439.41 781,-403.17 781,-374.06"/>
<polygon fill="black" stroke="black" points="784.5,-373.69 781,-363.69 777.5,-373.69 784.5,-373.69"/>
</g>
<!-- layer0_gpu1_qkv -->
<g id="node40" class="node">
<title>layer0_gpu1_qkv</title>
<polygon fill="none" stroke="black" points="6372,-524 6242,-524 6242,-456 6372,-456 6372,-524"/>
<text text-anchor="middle" x="6307" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6307" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6307" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="6307" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_reshape -->
<g id="node41" class="node">
<title>layer0_gpu1_reshape</title>
<ellipse fill="none" stroke="black" cx="6156" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="6156" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6156" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="6156" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_attn -->
<g id="node42" class="node">
<title>layer0_gpu1_attn</title>
<polygon fill="none" stroke="black" points="5915,-558 5760,-490 5915,-422 6070,-490 5915,-558"/>
<text text-anchor="middle" x="5915" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="5915" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5915" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="5915" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_out_proj -->
<g id="node43" class="node">
<title>layer0_gpu1_out_proj</title>
<polygon fill="none" stroke="black" points="4132,-524 3988,-524 3988,-456 4132,-456 4132,-524"/>
<text text-anchor="middle" x="4060" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4060" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4060" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="4060" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_out_proj&#45;&gt;layer0_concat_group0 -->
<g id="edge21" class="edge">
<title>layer0_gpu1_out_proj&#45;&gt;layer0_concat_group0</title>
<path fill="none" stroke="black" d="M4089.81,-455.86C4103.88,-442.66 4121.78,-428.96 4141,-422 4374.67,-337.35 12845.19,-439.03 13088,-386 13100.13,-383.35 13112.5,-379.48 13124.54,-374.96"/>
<polygon fill="black" stroke="black" points="13126.07,-378.12 13134.11,-371.21 13123.52,-371.6 13126.07,-378.12"/>
</g>
<!-- layer0_gpu1_ln2 -->
<g id="node44" class="node">
<title>layer0_gpu1_ln2</title>
<ellipse fill="none" stroke="black" cx="5504" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="5504" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5504" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="5504" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_mlp1 -->
<g id="node45" class="node">
<title>layer0_gpu1_mlp1</title>
<polygon fill="none" stroke="black" points="5410,-524 5276,-524 5276,-456 5410,-456 5410,-524"/>
<text text-anchor="middle" x="5343" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="5343" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="5343" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="5343" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_gelu -->
<g id="node46" class="node">
<title>layer0_gpu1_gelu</title>
<ellipse fill="none" stroke="black" cx="5163" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="5163" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5163" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="5163" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer0_gpu1_mlp2 -->
<g id="node47" class="node">
<title>layer0_gpu1_mlp2</title>
<polygon fill="none" stroke="black" points="5049.5,-524 4942.5,-524 4942.5,-456 5049.5,-456 5049.5,-524"/>
<text text-anchor="middle" x="4996" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="4996" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4996" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="4996" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_ln1 -->
<g id="node48" class="node">
<title>layer1_gpu1_ln1</title>
<ellipse fill="none" stroke="black" cx="1615" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="1615" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1615" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="1615" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_qkv -->
<g id="node49" class="node">
<title>layer1_gpu1_qkv</title>
<polygon fill="none" stroke="black" points="4762,-524 4632,-524 4632,-456 4762,-456 4762,-524"/>
<text text-anchor="middle" x="4697" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4697" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4697" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="4697" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_reshape -->
<g id="node50" class="node">
<title>layer1_gpu1_reshape</title>
<ellipse fill="none" stroke="black" cx="4546" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="4546" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4546" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="4546" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_attn -->
<g id="node51" class="node">
<title>layer1_gpu1_attn</title>
<polygon fill="none" stroke="black" points="4305,-558 4150,-490 4305,-422 4460,-490 4305,-558"/>
<text text-anchor="middle" x="4305" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="4305" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4305" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="4305" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_out_proj -->
<g id="node52" class="node">
<title>layer1_gpu1_out_proj</title>
<polygon fill="none" stroke="black" points="5742,-524 5598,-524 5598,-456 5742,-456 5742,-524"/>
<text text-anchor="middle" x="5670" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5670" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="5670" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="5670" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_out_proj&#45;&gt;layer1_concat_group0 -->
<g id="edge22" class="edge">
<title>layer1_gpu1_out_proj&#45;&gt;layer1_concat_group0</title>
<path fill="none" stroke="black" d="M5699.81,-455.86C5713.88,-442.66 5731.78,-428.97 5751,-422 5956.57,-347.47 13409.06,-431.22 13623,-386 13636.29,-383.19 13649.88,-379.01 13663.06,-374.14"/>
<polygon fill="black" stroke="black" points="13664.5,-377.34 13672.59,-370.49 13662,-370.8 13664.5,-377.34"/>
</g>
<!-- layer1_gpu1_ln2 -->
<g id="node53" class="node">
<title>layer1_gpu1_ln2</title>
<ellipse fill="none" stroke="black" cx="3894" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="3894" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3894" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="3894" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_mlp1 -->
<g id="node54" class="node">
<title>layer1_gpu1_mlp1</title>
<polygon fill="none" stroke="black" points="3800,-524 3666,-524 3666,-456 3800,-456 3800,-524"/>
<text text-anchor="middle" x="3733" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="3733" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3733" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="3733" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_gelu -->
<g id="node55" class="node">
<title>layer1_gpu1_gelu</title>
<ellipse fill="none" stroke="black" cx="3553" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3553" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3553" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="3553" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_gpu1_mlp2 -->
<g id="node56" class="node">
<title>layer1_gpu1_mlp2</title>
<polygon fill="none" stroke="black" points="3439.5,-524 3332.5,-524 3332.5,-456 3439.5,-456 3439.5,-524"/>
<text text-anchor="middle" x="3386" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="3386" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3386" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="3386" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_ln1 -->
<g id="node57" class="node">
<title>layer2_gpu1_ln1</title>
<ellipse fill="none" stroke="black" cx="2439" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="2439" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2439" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="2439" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_qkv -->
<g id="node58" class="node">
<title>layer2_gpu1_qkv</title>
<polygon fill="none" stroke="black" points="3145,-524 3015,-524 3015,-456 3145,-456 3145,-524"/>
<text text-anchor="middle" x="3080" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3080" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3080" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="3080" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_reshape -->
<g id="node59" class="node">
<title>layer2_gpu1_reshape</title>
<ellipse fill="none" stroke="black" cx="2929" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2929" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="2929" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_attn -->
<g id="node60" class="node">
<title>layer2_gpu1_attn</title>
<polygon fill="none" stroke="black" points="2688,-558 2533,-490 2688,-422 2843,-490 2688,-558"/>
<text text-anchor="middle" x="2688" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="2688" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2688" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="2688" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_out_proj -->
<g id="node61" class="node">
<title>layer2_gpu1_out_proj</title>
<polygon fill="none" stroke="black" points="6534,-524 6390,-524 6390,-456 6534,-456 6534,-524"/>
<text text-anchor="middle" x="6462" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6462" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="6462" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="6462" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_out_proj&#45;&gt;layer2_concat_group0 -->
<g id="edge23" class="edge">
<title>layer2_gpu1_out_proj&#45;&gt;layer2_concat_group0</title>
<path fill="none" stroke="black" d="M6493.13,-455.85C6507.76,-442.64 6526.3,-428.95 6546,-422 6738.46,-354.11 13690.88,-414.23 13893,-386 13924.95,-381.54 13958.9,-373.55 13990,-364.87"/>
<polygon fill="black" stroke="black" points="13991.33,-368.14 13999.99,-362.04 13989.42,-361.4 13991.33,-368.14"/>
</g>
<!-- layer2_gpu1_ln2 -->
<g id="node62" class="node">
<title>layer2_gpu1_ln2</title>
<ellipse fill="none" stroke="black" cx="2270" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="2270" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2270" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="2270" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_mlp1 -->
<g id="node63" class="node">
<title>layer2_gpu1_mlp1</title>
<polygon fill="none" stroke="black" points="2176,-524 2042,-524 2042,-456 2176,-456 2176,-524"/>
<text text-anchor="middle" x="2109" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="2109" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2109" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="2109" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_gelu -->
<g id="node64" class="node">
<title>layer2_gpu1_gelu</title>
<ellipse fill="none" stroke="black" cx="1929" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1929" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1929" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="1929" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_gpu1_mlp2 -->
<g id="node65" class="node">
<title>layer2_gpu1_mlp2</title>
<polygon fill="none" stroke="black" points="1815.5,-524 1708.5,-524 1708.5,-456 1815.5,-456 1815.5,-524"/>
<text text-anchor="middle" x="1762" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="1762" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1762" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="1762" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_ln1 -->
<g id="node66" class="node">
<title>layer3_gpu1_ln1</title>
<ellipse fill="none" stroke="black" cx="3239" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="3239" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3239" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="3239" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_qkv -->
<g id="node67" class="node">
<title>layer3_gpu1_qkv</title>
<polygon fill="none" stroke="black" points="1521,-524 1391,-524 1391,-456 1521,-456 1521,-524"/>
<text text-anchor="middle" x="1456" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1456" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1456" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="1456" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_reshape -->
<g id="node68" class="node">
<title>layer3_gpu1_reshape</title>
<ellipse fill="none" stroke="black" cx="1305" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="1305" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1305" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="1305" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_attn -->
<g id="node69" class="node">
<title>layer3_gpu1_attn</title>
<polygon fill="none" stroke="black" points="1064,-558 909,-490 1064,-422 1219,-490 1064,-558"/>
<text text-anchor="middle" x="1064" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="1064" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1064" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="1064" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_out_proj -->
<g id="node70" class="node">
<title>layer3_gpu1_out_proj</title>
<polygon fill="none" stroke="black" points="4924,-524 4780,-524 4780,-456 4924,-456 4924,-524"/>
<text text-anchor="middle" x="4852" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4852" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4852" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="4852" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_out_proj&#45;&gt;layer3_concat_group0 -->
<g id="edge24" class="edge">
<title>layer3_gpu1_out_proj&#45;&gt;layer3_concat_group0</title>
<path fill="none" stroke="black" d="M4882.25,-455.86C4896.5,-442.65 4914.62,-428.96 4934,-422 5154.11,-342.98 13124.18,-434.33 13353,-386 13366.29,-383.19 13379.88,-379.01 13393.07,-374.15"/>
<polygon fill="black" stroke="black" points="13394.5,-377.34 13402.59,-370.49 13392,-370.81 13394.5,-377.34"/>
</g>
<!-- layer3_gpu1_ln2 -->
<g id="node71" class="node">
<title>layer3_gpu1_ln2</title>
<ellipse fill="none" stroke="black" cx="577" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="577" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="577" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="577" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_mlp1 -->
<g id="node72" class="node">
<title>layer3_gpu1_mlp1</title>
<polygon fill="none" stroke="black" points="483,-524 349,-524 349,-456 483,-456 483,-524"/>
<text text-anchor="middle" x="416" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="416" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="416" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="416" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_gelu -->
<g id="node73" class="node">
<title>layer3_gpu1_gelu</title>
<ellipse fill="none" stroke="black" cx="236" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="236" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="236" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="236" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_gpu1_mlp2 -->
<g id="node74" class="node">
<title>layer3_gpu1_mlp2</title>
<polygon fill="none" stroke="black" points="122.5,-524 15.5,-524 15.5,-456 122.5,-456 122.5,-524"/>
<text text-anchor="middle" x="69" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="69" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="69" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="69" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- embed_2 -->
<g id="node75" class="node">
<title>embed_2</title>
<polygon fill="none" stroke="black" points="19140,-516.5 18920,-516.5 18920,-463.5 19140,-463.5 19140,-516.5"/>
<text text-anchor="middle" x="19030" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="19030" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="19030" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu2_ln1 -->
<g id="node76" class="node">
<title>layer0_gpu2_ln1</title>
<ellipse fill="none" stroke="black" cx="19030" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="19030" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="19030" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="19030" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- embed_2&#45;&gt;layer0_gpu2_ln1 -->
<g id="edge3" class="edge">
<title>embed_2&#45;&gt;layer0_gpu2_ln1</title>
<path fill="none" stroke="black" d="M19030,-463.33C19030,-439.41 19030,-403.17 19030,-374.06"/>
<polygon fill="black" stroke="black" points="19033.5,-373.69 19030,-363.69 19026.5,-373.69 19033.5,-373.69"/>
</g>
<!-- layer0_gpu2_qkv -->
<g id="node77" class="node">
<title>layer0_gpu2_qkv</title>
<polygon fill="none" stroke="black" points="20595,-524 20465,-524 20465,-456 20595,-456 20595,-524"/>
<text text-anchor="middle" x="20530" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20530" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20530" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="20530" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_reshape -->
<g id="node78" class="node">
<title>layer0_gpu2_reshape</title>
<ellipse fill="none" stroke="black" cx="20379" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="20379" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="20379" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="20379" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_attn -->
<g id="node79" class="node">
<title>layer0_gpu2_attn</title>
<polygon fill="none" stroke="black" points="20138,-558 19983,-490 20138,-422 20293,-490 20138,-558"/>
<text text-anchor="middle" x="20138" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="20138" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="20138" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="20138" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_out_proj -->
<g id="node80" class="node">
<title>layer0_gpu2_out_proj</title>
<polygon fill="none" stroke="black" points="15045,-524 14901,-524 14901,-456 15045,-456 15045,-524"/>
<text text-anchor="middle" x="14973" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14973" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14973" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="14973" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_out_proj&#45;&gt;layer0_concat_group0 -->
<g id="edge25" class="edge">
<title>layer0_gpu2_out_proj&#45;&gt;layer0_concat_group0</title>
<path fill="none" stroke="black" d="M14942.74,-455.68C14928.73,-442.62 14910.98,-429.08 14892,-422 14731.75,-362.19 13520.01,-422.94 13353,-386 13339.84,-383.09 13326.37,-378.87 13313.29,-374.02"/>
<polygon fill="black" stroke="black" points="13314.42,-370.71 13303.83,-370.38 13311.91,-377.24 13314.42,-370.71"/>
</g>
<!-- layer0_gpu2_ln2 -->
<g id="node81" class="node">
<title>layer0_gpu2_ln2</title>
<ellipse fill="none" stroke="black" cx="19720" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="19720" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="19720" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="19720" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_mlp1 -->
<g id="node82" class="node">
<title>layer0_gpu2_mlp1</title>
<polygon fill="none" stroke="black" points="19626,-524 19492,-524 19492,-456 19626,-456 19626,-524"/>
<text text-anchor="middle" x="19559" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="19559" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19559" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="19559" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_gelu -->
<g id="node83" class="node">
<title>layer0_gpu2_gelu</title>
<ellipse fill="none" stroke="black" cx="19379" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19379" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19379" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="19379" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer0_gpu2_mlp2 -->
<g id="node84" class="node">
<title>layer0_gpu2_mlp2</title>
<polygon fill="none" stroke="black" points="19265.5,-524 19158.5,-524 19158.5,-456 19265.5,-456 19265.5,-524"/>
<text text-anchor="middle" x="19212" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="19212" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="19212" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="19212" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_ln1 -->
<g id="node85" class="node">
<title>layer1_gpu2_ln1</title>
<ellipse fill="none" stroke="black" cx="17379" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="17379" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="17379" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="17379" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_qkv -->
<g id="node86" class="node">
<title>layer1_gpu2_qkv</title>
<polygon fill="none" stroke="black" points="18902,-524 18772,-524 18772,-456 18902,-456 18902,-524"/>
<text text-anchor="middle" x="18837" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18837" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18837" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="18837" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_reshape -->
<g id="node87" class="node">
<title>layer1_gpu2_reshape</title>
<ellipse fill="none" stroke="black" cx="18686" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="18686" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="18686" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="18686" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_attn -->
<g id="node88" class="node">
<title>layer1_gpu2_attn</title>
<polygon fill="none" stroke="black" points="18445,-558 18290,-490 18445,-422 18600,-490 18445,-558"/>
<text text-anchor="middle" x="18445" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="18445" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="18445" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="18445" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_out_proj -->
<g id="node89" class="node">
<title>layer1_gpu2_out_proj</title>
<polygon fill="none" stroke="black" points="16655,-524 16511,-524 16511,-456 16655,-456 16655,-524"/>
<text text-anchor="middle" x="16583" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16583" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16583" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="16583" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_out_proj&#45;&gt;layer1_concat_group0 -->
<g id="edge26" class="edge">
<title>layer1_gpu2_out_proj&#45;&gt;layer1_concat_group0</title>
<path fill="none" stroke="black" d="M16553.15,-455.95C16539.09,-442.76 16521.18,-429.06 16502,-422 16366.21,-372.06 14039.61,-415.64 13898,-386 13883.74,-383.01 13869.11,-378.57 13854.94,-373.43"/>
<polygon fill="black" stroke="black" points="13855.8,-370.02 13845.21,-369.78 13853.34,-376.57 13855.8,-370.02"/>
</g>
<!-- layer1_gpu2_ln2 -->
<g id="node90" class="node">
<title>layer1_gpu2_ln2</title>
<ellipse fill="none" stroke="black" cx="18034" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="18034" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="18034" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="18034" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_mlp1 -->
<g id="node91" class="node">
<title>layer1_gpu2_mlp1</title>
<polygon fill="none" stroke="black" points="17940,-524 17806,-524 17806,-456 17940,-456 17940,-524"/>
<text text-anchor="middle" x="17873" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="17873" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17873" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="17873" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_gelu -->
<g id="node92" class="node">
<title>layer1_gpu2_gelu</title>
<ellipse fill="none" stroke="black" cx="17693" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17693" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17693" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="17693" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_gpu2_mlp2 -->
<g id="node93" class="node">
<title>layer1_gpu2_mlp2</title>
<polygon fill="none" stroke="black" points="17579.5,-524 17472.5,-524 17472.5,-456 17579.5,-456 17579.5,-524"/>
<text text-anchor="middle" x="17526" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="17526" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17526" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="17526" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_ln1 -->
<g id="node94" class="node">
<title>layer2_gpu2_ln1</title>
<ellipse fill="none" stroke="black" cx="19889" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="19889" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="19889" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="19889" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_qkv -->
<g id="node95" class="node">
<title>layer2_gpu2_qkv</title>
<polygon fill="none" stroke="black" points="17285,-524 17155,-524 17155,-456 17285,-456 17285,-524"/>
<text text-anchor="middle" x="17220" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17220" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17220" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="17220" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_reshape -->
<g id="node96" class="node">
<title>layer2_gpu2_reshape</title>
<ellipse fill="none" stroke="black" cx="17069" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="17069" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="17069" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="17069" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_attn -->
<g id="node97" class="node">
<title>layer2_gpu2_attn</title>
<polygon fill="none" stroke="black" points="16828,-558 16673,-490 16828,-422 16983,-490 16828,-558"/>
<text text-anchor="middle" x="16828" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="16828" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="16828" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="16828" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_out_proj -->
<g id="node98" class="node">
<title>layer2_gpu2_out_proj</title>
<polygon fill="none" stroke="black" points="18272,-524 18128,-524 18128,-456 18272,-456 18272,-524"/>
<text text-anchor="middle" x="18200" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18200" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18200" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="18200" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_out_proj&#45;&gt;layer2_concat_group0 -->
<g id="edge27" class="edge">
<title>layer2_gpu2_out_proj&#45;&gt;layer2_concat_group0</title>
<path fill="none" stroke="black" d="M18170.17,-455.91C18156.1,-442.71 18138.2,-429.01 18119,-422 17916.26,-347.95 14444.75,-432.61 14234,-386 14221.87,-383.32 14209.52,-379.43 14197.48,-374.9"/>
<polygon fill="black" stroke="black" points="14198.49,-371.54 14187.91,-371.15 14195.94,-378.06 14198.49,-371.54"/>
</g>
<!-- layer2_gpu2_ln2 -->
<g id="node99" class="node">
<title>layer2_gpu2_ln2</title>
<ellipse fill="none" stroke="black" cx="16417" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="16417" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="16417" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="16417" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_mlp1 -->
<g id="node100" class="node">
<title>layer2_gpu2_mlp1</title>
<polygon fill="none" stroke="black" points="16323,-524 16189,-524 16189,-456 16323,-456 16323,-524"/>
<text text-anchor="middle" x="16256" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="16256" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16256" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="16256" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_gelu -->
<g id="node101" class="node">
<title>layer2_gpu2_gelu</title>
<ellipse fill="none" stroke="black" cx="16076" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16076" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16076" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="16076" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_gpu2_mlp2 -->
<g id="node102" class="node">
<title>layer2_gpu2_mlp2</title>
<polygon fill="none" stroke="black" points="15962.5,-524 15855.5,-524 15855.5,-456 15962.5,-456 15962.5,-524"/>
<text text-anchor="middle" x="15909" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="15909" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15909" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="15909" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_ln1 -->
<g id="node103" class="node">
<title>layer3_gpu2_ln1</title>
<ellipse fill="none" stroke="black" cx="20689" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="20689" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="20689" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="20689" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_qkv -->
<g id="node104" class="node">
<title>layer3_gpu2_qkv</title>
<polygon fill="none" stroke="black" points="15675,-524 15545,-524 15545,-456 15675,-456 15675,-524"/>
<text text-anchor="middle" x="15610" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15610" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15610" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="15610" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_reshape -->
<g id="node105" class="node">
<title>layer3_gpu2_reshape</title>
<ellipse fill="none" stroke="black" cx="15459" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="15459" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="15459" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="15459" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_attn -->
<g id="node106" class="node">
<title>layer3_gpu2_attn</title>
<polygon fill="none" stroke="black" points="15218,-558 15063,-490 15218,-422 15373,-490 15218,-558"/>
<text text-anchor="middle" x="15218" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="15218" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15218" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="15218" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_out_proj -->
<g id="node107" class="node">
<title>layer3_gpu2_out_proj</title>
<polygon fill="none" stroke="black" points="15837,-524 15693,-524 15693,-456 15837,-456 15837,-524"/>
<text text-anchor="middle" x="15765" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15765" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15765" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="15765" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_out_proj&#45;&gt;layer3_concat_group0 -->
<g id="edge28" class="edge">
<title>layer3_gpu2_out_proj&#45;&gt;layer3_concat_group0</title>
<path fill="none" stroke="black" d="M15735.14,-455.98C15721.07,-442.8 15703.17,-429.09 15684,-422 15469.19,-342.55 13846.77,-434.81 13623,-386 13609.83,-383.13 13596.36,-378.94 13583.27,-374.09"/>
<polygon fill="black" stroke="black" points="13584.41,-370.78 13573.82,-370.46 13581.9,-377.31 13584.41,-370.78"/>
</g>
<!-- layer3_gpu2_ln2 -->
<g id="node108" class="node">
<title>layer3_gpu2_ln2</title>
<ellipse fill="none" stroke="black" cx="14807" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="14807" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="14807" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="14807" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_mlp1 -->
<g id="node109" class="node">
<title>layer3_gpu2_mlp1</title>
<polygon fill="none" stroke="black" points="14713,-524 14579,-524 14579,-456 14713,-456 14713,-524"/>
<text text-anchor="middle" x="14646" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="14646" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14646" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="14646" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_gelu -->
<g id="node110" class="node">
<title>layer3_gpu2_gelu</title>
<ellipse fill="none" stroke="black" cx="14466" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14466" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14466" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="14466" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_gpu2_mlp2 -->
<g id="node111" class="node">
<title>layer3_gpu2_mlp2</title>
<polygon fill="none" stroke="black" points="14352.5,-524 14245.5,-524 14245.5,-456 14352.5,-456 14352.5,-524"/>
<text text-anchor="middle" x="14299" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="14299" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14299" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="14299" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- embed_3 -->
<g id="node112" class="node">
<title>embed_3</title>
<polygon fill="none" stroke="black" points="25683,-516.5 25463,-516.5 25463,-463.5 25683,-463.5 25683,-516.5"/>
<text text-anchor="middle" x="25573" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="25573" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="25573" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu3_ln1 -->
<g id="node113" class="node">
<title>layer0_gpu3_ln1</title>
<ellipse fill="none" stroke="black" cx="25573" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="25573" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="25573" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="25573" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- embed_3&#45;&gt;layer0_gpu3_ln1 -->
<g id="edge4" class="edge">
<title>embed_3&#45;&gt;layer0_gpu3_ln1</title>
<path fill="none" stroke="black" d="M25573,-463.33C25573,-439.41 25573,-403.17 25573,-374.06"/>
<polygon fill="black" stroke="black" points="25576.5,-373.69 25573,-363.69 25569.5,-373.69 25576.5,-373.69"/>
</g>
<!-- layer0_gpu3_qkv -->
<g id="node114" class="node">
<title>layer0_gpu3_qkv</title>
<polygon fill="none" stroke="black" points="27138,-524 27008,-524 27008,-456 27138,-456 27138,-524"/>
<text text-anchor="middle" x="27073" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="27073" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="27073" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="27073" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_reshape -->
<g id="node115" class="node">
<title>layer0_gpu3_reshape</title>
<ellipse fill="none" stroke="black" cx="26922" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="26922" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="26922" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="26922" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_attn -->
<g id="node116" class="node">
<title>layer0_gpu3_attn</title>
<polygon fill="none" stroke="black" points="26681,-558 26526,-490 26681,-422 26836,-490 26681,-558"/>
<text text-anchor="middle" x="26681" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="26681" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="26681" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="26681" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_out_proj -->
<g id="node117" class="node">
<title>layer0_gpu3_out_proj</title>
<polygon fill="none" stroke="black" points="21588,-524 21444,-524 21444,-456 21588,-456 21588,-524"/>
<text text-anchor="middle" x="21516" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="21516" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="21516" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="21516" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_out_proj&#45;&gt;layer0_concat_group0 -->
<g id="edge29" class="edge">
<title>layer0_gpu3_out_proj&#45;&gt;layer0_concat_group0</title>
<path fill="none" stroke="black" d="M21486.19,-455.86C21472.12,-442.66 21454.22,-428.97 21435,-422 21223.94,-345.49 13572.65,-432.41 13353,-386 13339.71,-383.19 13326.12,-379.01 13312.94,-374.14"/>
<polygon fill="black" stroke="black" points="13314,-370.8 13303.41,-370.49 13311.5,-377.34 13314,-370.8"/>
</g>
<!-- layer0_gpu3_ln2 -->
<g id="node118" class="node">
<title>layer0_gpu3_ln2</title>
<ellipse fill="none" stroke="black" cx="26263" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="26263" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="26263" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="26263" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_mlp1 -->
<g id="node119" class="node">
<title>layer0_gpu3_mlp1</title>
<polygon fill="none" stroke="black" points="26169,-524 26035,-524 26035,-456 26169,-456 26169,-524"/>
<text text-anchor="middle" x="26102" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="26102" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="26102" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="26102" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_gelu -->
<g id="node120" class="node">
<title>layer0_gpu3_gelu</title>
<ellipse fill="none" stroke="black" cx="25922" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25922" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="25922" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="25922" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer0_gpu3_mlp2 -->
<g id="node121" class="node">
<title>layer0_gpu3_mlp2</title>
<polygon fill="none" stroke="black" points="25808.5,-524 25701.5,-524 25701.5,-456 25808.5,-456 25808.5,-524"/>
<text text-anchor="middle" x="25755" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="25755" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="25755" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="25755" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_ln1 -->
<g id="node122" class="node">
<title>layer1_gpu3_ln1</title>
<ellipse fill="none" stroke="black" cx="24739" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="24739" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="24739" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="24739" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_qkv -->
<g id="node123" class="node">
<title>layer1_gpu3_qkv</title>
<polygon fill="none" stroke="black" points="25445,-524 25315,-524 25315,-456 25445,-456 25445,-524"/>
<text text-anchor="middle" x="25380" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="25380" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25380" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="25380" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_reshape -->
<g id="node124" class="node">
<title>layer1_gpu3_reshape</title>
<ellipse fill="none" stroke="black" cx="25229" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="25229" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="25229" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="25229" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_attn -->
<g id="node125" class="node">
<title>layer1_gpu3_attn</title>
<polygon fill="none" stroke="black" points="24988,-558 24833,-490 24988,-422 25143,-490 24988,-558"/>
<text text-anchor="middle" x="24988" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="24988" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="24988" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="24988" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_out_proj -->
<g id="node126" class="node">
<title>layer1_gpu3_out_proj</title>
<polygon fill="none" stroke="black" points="23198,-524 23054,-524 23054,-456 23198,-456 23198,-524"/>
<text text-anchor="middle" x="23126" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="23126" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="23126" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="23126" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_out_proj&#45;&gt;layer1_concat_group0 -->
<g id="edge30" class="edge">
<title>layer1_gpu3_out_proj&#45;&gt;layer1_concat_group0</title>
<path fill="none" stroke="black" d="M23096.19,-455.86C23082.12,-442.66 23064.22,-428.96 23045,-422 22926.48,-379.07 14093.85,-403.38 13969,-386 13937.04,-381.55 13903.1,-373.57 13872,-364.89"/>
<polygon fill="black" stroke="black" points="13872.58,-361.42 13862,-362.06 13870.67,-368.16 13872.58,-361.42"/>
</g>
<!-- layer1_gpu3_ln2 -->
<g id="node127" class="node">
<title>layer1_gpu3_ln2</title>
<ellipse fill="none" stroke="black" cx="24570" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="24570" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="24570" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="24570" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_mlp1 -->
<g id="node128" class="node">
<title>layer1_gpu3_mlp1</title>
<polygon fill="none" stroke="black" points="24476,-524 24342,-524 24342,-456 24476,-456 24476,-524"/>
<text text-anchor="middle" x="24409" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="24409" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24409" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="24409" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_gelu -->
<g id="node129" class="node">
<title>layer1_gpu3_gelu</title>
<ellipse fill="none" stroke="black" cx="24229" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24229" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="24229" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="24229" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_gpu3_mlp2 -->
<g id="node130" class="node">
<title>layer1_gpu3_mlp2</title>
<polygon fill="none" stroke="black" points="24115.5,-524 24008.5,-524 24008.5,-456 24115.5,-456 24115.5,-524"/>
<text text-anchor="middle" x="24062" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="24062" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="24062" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="24062" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_ln1 -->
<g id="node131" class="node">
<title>layer2_gpu3_ln1</title>
<ellipse fill="none" stroke="black" cx="26432" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="26432" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="26432" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="26432" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_qkv -->
<g id="node132" class="node">
<title>layer2_gpu3_qkv</title>
<polygon fill="none" stroke="black" points="23828,-524 23698,-524 23698,-456 23828,-456 23828,-524"/>
<text text-anchor="middle" x="23763" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="23763" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="23763" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="23763" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_reshape -->
<g id="node133" class="node">
<title>layer2_gpu3_reshape</title>
<ellipse fill="none" stroke="black" cx="23612" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="23612" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="23612" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="23612" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_attn -->
<g id="node134" class="node">
<title>layer2_gpu3_attn</title>
<polygon fill="none" stroke="black" points="23371,-558 23216,-490 23371,-422 23526,-490 23371,-558"/>
<text text-anchor="middle" x="23371" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="23371" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="23371" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="23371" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_out_proj -->
<g id="node135" class="node">
<title>layer2_gpu3_out_proj</title>
<polygon fill="none" stroke="black" points="23990,-524 23846,-524 23846,-456 23990,-456 23990,-524"/>
<text text-anchor="middle" x="23918" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="23918" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="23918" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="23918" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_out_proj&#45;&gt;layer2_concat_group0 -->
<g id="edge31" class="edge">
<title>layer2_gpu3_out_proj&#45;&gt;layer2_concat_group0</title>
<path fill="none" stroke="black" d="M23888.19,-455.86C23874.12,-442.65 23856.22,-428.96 23837,-422 23711.59,-376.59 14364.31,-414.44 14234,-386 14221.87,-383.35 14209.5,-379.48 14197.46,-374.97"/>
<polygon fill="black" stroke="black" points="14198.48,-371.6 14187.89,-371.22 14195.93,-378.12 14198.48,-371.6"/>
</g>
<!-- layer2_gpu3_ln2 -->
<g id="node136" class="node">
<title>layer2_gpu3_ln2</title>
<ellipse fill="none" stroke="black" cx="22960" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="22960" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="22960" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="22960" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_mlp1 -->
<g id="node137" class="node">
<title>layer2_gpu3_mlp1</title>
<polygon fill="none" stroke="black" points="22866,-524 22732,-524 22732,-456 22866,-456 22866,-524"/>
<text text-anchor="middle" x="22799" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="22799" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="22799" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="22799" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_gelu -->
<g id="node138" class="node">
<title>layer2_gpu3_gelu</title>
<ellipse fill="none" stroke="black" cx="22619" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="22619" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22619" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="22619" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_gpu3_mlp2 -->
<g id="node139" class="node">
<title>layer2_gpu3_mlp2</title>
<polygon fill="none" stroke="black" points="22505.5,-524 22398.5,-524 22398.5,-456 22505.5,-456 22505.5,-524"/>
<text text-anchor="middle" x="22452" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="22452" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22452" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="22452" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_ln1 -->
<g id="node140" class="node">
<title>layer3_gpu3_ln1</title>
<ellipse fill="none" stroke="black" cx="27232" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="27232" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="27232" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="27232" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_qkv -->
<g id="node141" class="node">
<title>layer3_gpu3_qkv</title>
<polygon fill="none" stroke="black" points="22218,-524 22088,-524 22088,-456 22218,-456 22218,-524"/>
<text text-anchor="middle" x="22153" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22153" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="22153" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="22153" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_reshape -->
<g id="node142" class="node">
<title>layer3_gpu3_reshape</title>
<ellipse fill="none" stroke="black" cx="22002" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="22002" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="22002" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="22002" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_attn -->
<g id="node143" class="node">
<title>layer3_gpu3_attn</title>
<polygon fill="none" stroke="black" points="21761,-558 21606,-490 21761,-422 21916,-490 21761,-558"/>
<text text-anchor="middle" x="21761" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="21761" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="21761" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="21761" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_out_proj -->
<g id="node144" class="node">
<title>layer3_gpu3_out_proj</title>
<polygon fill="none" stroke="black" points="22380,-524 22236,-524 22236,-456 22380,-456 22380,-524"/>
<text text-anchor="middle" x="22308" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="22308" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22308" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="22308" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_out_proj&#45;&gt;layer3_concat_group0 -->
<g id="edge32" class="edge">
<title>layer3_gpu3_out_proj&#45;&gt;layer3_concat_group0</title>
<path fill="none" stroke="black" d="M22278.19,-455.86C22264.12,-442.66 22246.22,-428.96 22227,-422 22002.29,-340.58 13856.85,-435.38 13623,-386 13609.71,-383.19 13596.12,-379.01 13582.93,-374.15"/>
<polygon fill="black" stroke="black" points="13584,-370.81 13573.41,-370.49 13581.49,-377.34 13584,-370.81"/>
</g>
<!-- layer3_gpu3_ln2 -->
<g id="node145" class="node">
<title>layer3_gpu3_ln2</title>
<ellipse fill="none" stroke="black" cx="21350" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="21350" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="21350" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="21350" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_mlp1 -->
<g id="node146" class="node">
<title>layer3_gpu3_mlp1</title>
<polygon fill="none" stroke="black" points="21256,-524 21122,-524 21122,-456 21256,-456 21256,-524"/>
<text text-anchor="middle" x="21189" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="21189" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="21189" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="21189" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_gelu -->
<g id="node147" class="node">
<title>layer3_gpu3_gelu</title>
<ellipse fill="none" stroke="black" cx="21009" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21009" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21009" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="21009" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_gpu3_mlp2 -->
<g id="node148" class="node">
<title>layer3_gpu3_mlp2</title>
<polygon fill="none" stroke="black" points="20895.5,-524 20788.5,-524 20788.5,-456 20895.5,-456 20895.5,-524"/>
<text text-anchor="middle" x="20842" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="20842" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="20842" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="20842" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- embed_4 -->
<g id="node149" class="node">
<title>embed_4</title>
<polygon fill="none" stroke="black" points="29006,-516.5 28786,-516.5 28786,-463.5 29006,-463.5 29006,-516.5"/>
<text text-anchor="middle" x="28896" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="28896" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="28896" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu4_ln1 -->
<g id="node150" class="node">
<title>layer0_gpu4_ln1</title>
<ellipse fill="none" stroke="black" cx="28896" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="28896" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="28896" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="28896" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- embed_4&#45;&gt;layer0_gpu4_ln1 -->
<g id="edge5" class="edge">
<title>embed_4&#45;&gt;layer0_gpu4_ln1</title>
<path fill="none" stroke="black" d="M28896,-463.33C28896,-439.41 28896,-403.17 28896,-374.06"/>
<polygon fill="black" stroke="black" points="28899.5,-373.69 28896,-363.69 28892.5,-373.69 28899.5,-373.69"/>
</g>
<!-- layer0_gpu4_qkv -->
<g id="node151" class="node">
<title>layer0_gpu4_qkv</title>
<polygon fill="none" stroke="black" points="33688,-524 33558,-524 33558,-456 33688,-456 33688,-524"/>
<text text-anchor="middle" x="33623" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="33623" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="33623" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="33623" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_reshape -->
<g id="node152" class="node">
<title>layer0_gpu4_reshape</title>
<ellipse fill="none" stroke="black" cx="33472" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="33472" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="33472" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="33472" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_attn -->
<g id="node153" class="node">
<title>layer0_gpu4_attn</title>
<polygon fill="none" stroke="black" points="33231,-558 33076,-490 33231,-422 33386,-490 33231,-558"/>
<text text-anchor="middle" x="33231" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="33231" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="33231" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="33231" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_out_proj -->
<g id="node154" class="node">
<title>layer0_gpu4_out_proj</title>
<polygon fill="none" stroke="black" points="31448,-524 31304,-524 31304,-456 31448,-456 31448,-524"/>
<text text-anchor="middle" x="31376" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="31376" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="31376" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="31376" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_concat_group1 -->
<g id="node597" class="node">
<title>layer0_concat_group1</title>
<polygon fill="yellow" stroke="black" points="40656,-302.8 40656,-349.2 40584.53,-382 40483.47,-382 40412,-349.2 40412,-302.8 40483.47,-270 40584.53,-270 40656,-302.8"/>
<polygon fill="none" stroke="black" points="40660,-300.24 40660,-351.76 40585.41,-386 40482.59,-386 40408,-351.76 40408,-300.24 40482.59,-266 40585.41,-266 40660,-300.24"/>
<text text-anchor="middle" x="40534" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="40534" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="40534" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="40534" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- layer0_gpu4_out_proj&#45;&gt;layer0_concat_group1 -->
<g id="edge33" class="edge">
<title>layer0_gpu4_out_proj&#45;&gt;layer0_concat_group1</title>
<path fill="none" stroke="black" d="M31405.81,-455.86C31419.88,-442.66 31437.78,-428.96 31457,-422 31690.67,-337.35 40161.19,-439.03 40404,-386 40416.13,-383.35 40428.5,-379.48 40440.54,-374.96"/>
<polygon fill="black" stroke="black" points="40442.07,-378.12 40450.11,-371.21 40439.52,-371.6 40442.07,-378.12"/>
</g>
<!-- layer0_gpu4_ln2 -->
<g id="node155" class="node">
<title>layer0_gpu4_ln2</title>
<ellipse fill="none" stroke="black" cx="32820" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="32820" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="32820" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="32820" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_mlp1 -->
<g id="node156" class="node">
<title>layer0_gpu4_mlp1</title>
<polygon fill="none" stroke="black" points="32726,-524 32592,-524 32592,-456 32726,-456 32726,-524"/>
<text text-anchor="middle" x="32659" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="32659" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32659" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="32659" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_gelu -->
<g id="node157" class="node">
<title>layer0_gpu4_gelu</title>
<ellipse fill="none" stroke="black" cx="32479" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32479" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="32479" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="32479" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer0_gpu4_mlp2 -->
<g id="node158" class="node">
<title>layer0_gpu4_mlp2</title>
<polygon fill="none" stroke="black" points="32365.5,-524 32258.5,-524 32258.5,-456 32365.5,-456 32365.5,-524"/>
<text text-anchor="middle" x="32312" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="32312" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="32312" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="32312" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_ln1 -->
<g id="node159" class="node">
<title>layer1_gpu4_ln1</title>
<ellipse fill="none" stroke="black" cx="28062" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="28062" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="28062" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="28062" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_qkv -->
<g id="node160" class="node">
<title>layer1_gpu4_qkv</title>
<polygon fill="none" stroke="black" points="32078,-524 31948,-524 31948,-456 32078,-456 32078,-524"/>
<text text-anchor="middle" x="32013" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32013" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32013" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="32013" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_reshape -->
<g id="node161" class="node">
<title>layer1_gpu4_reshape</title>
<ellipse fill="none" stroke="black" cx="31862" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="31862" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="31862" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="31862" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_attn -->
<g id="node162" class="node">
<title>layer1_gpu4_attn</title>
<polygon fill="none" stroke="black" points="31621,-558 31466,-490 31621,-422 31776,-490 31621,-558"/>
<text text-anchor="middle" x="31621" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="31621" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="31621" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="31621" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_out_proj -->
<g id="node163" class="node">
<title>layer1_gpu4_out_proj</title>
<polygon fill="none" stroke="black" points="33058,-524 32914,-524 32914,-456 33058,-456 33058,-524"/>
<text text-anchor="middle" x="32986" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="32986" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="32986" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="32986" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_concat_group1 -->
<g id="node598" class="node">
<title>layer1_concat_group1</title>
<polygon fill="yellow" stroke="black" points="41196,-302.8 41196,-349.2 41124.53,-382 41023.47,-382 40952,-349.2 40952,-302.8 41023.47,-270 41124.53,-270 41196,-302.8"/>
<polygon fill="none" stroke="black" points="41200,-300.24 41200,-351.76 41125.41,-386 41022.59,-386 40948,-351.76 40948,-300.24 41022.59,-266 41125.41,-266 41200,-300.24"/>
<text text-anchor="middle" x="41074" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="41074" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="41074" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="41074" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- layer1_gpu4_out_proj&#45;&gt;layer1_concat_group1 -->
<g id="edge34" class="edge">
<title>layer1_gpu4_out_proj&#45;&gt;layer1_concat_group1</title>
<path fill="none" stroke="black" d="M33015.81,-455.86C33029.88,-442.66 33047.78,-428.97 33067,-422 33272.57,-347.47 40725.06,-431.22 40939,-386 40952.29,-383.19 40965.88,-379.01 40979.06,-374.14"/>
<polygon fill="black" stroke="black" points="40980.5,-377.34 40988.59,-370.49 40978,-370.8 40980.5,-377.34"/>
</g>
<!-- layer1_gpu4_ln2 -->
<g id="node164" class="node">
<title>layer1_gpu4_ln2</title>
<ellipse fill="none" stroke="black" cx="31210" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="31210" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="31210" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="31210" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_mlp1 -->
<g id="node165" class="node">
<title>layer1_gpu4_mlp1</title>
<polygon fill="none" stroke="black" points="31116,-524 30982,-524 30982,-456 31116,-456 31116,-524"/>
<text text-anchor="middle" x="31049" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="31049" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31049" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="31049" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_gelu -->
<g id="node166" class="node">
<title>layer1_gpu4_gelu</title>
<ellipse fill="none" stroke="black" cx="30869" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30869" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="30869" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="30869" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_gpu4_mlp2 -->
<g id="node167" class="node">
<title>layer1_gpu4_mlp2</title>
<polygon fill="none" stroke="black" points="30755.5,-524 30648.5,-524 30648.5,-456 30755.5,-456 30755.5,-524"/>
<text text-anchor="middle" x="30702" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="30702" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="30702" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="30702" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_ln1 -->
<g id="node168" class="node">
<title>layer2_gpu4_ln1</title>
<ellipse fill="none" stroke="black" cx="29755" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="29755" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="29755" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="29755" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_qkv -->
<g id="node169" class="node">
<title>layer2_gpu4_qkv</title>
<polygon fill="none" stroke="black" points="30461,-524 30331,-524 30331,-456 30461,-456 30461,-524"/>
<text text-anchor="middle" x="30396" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="30396" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="30396" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="30396" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_reshape -->
<g id="node170" class="node">
<title>layer2_gpu4_reshape</title>
<ellipse fill="none" stroke="black" cx="30245" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="30245" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="30245" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="30245" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_attn -->
<g id="node171" class="node">
<title>layer2_gpu4_attn</title>
<polygon fill="none" stroke="black" points="30004,-558 29849,-490 30004,-422 30159,-490 30004,-558"/>
<text text-anchor="middle" x="30004" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="30004" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="30004" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="30004" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_out_proj -->
<g id="node172" class="node">
<title>layer2_gpu4_out_proj</title>
<polygon fill="none" stroke="black" points="33850,-524 33706,-524 33706,-456 33850,-456 33850,-524"/>
<text text-anchor="middle" x="33778" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="33778" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="33778" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="33778" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_concat_group1 -->
<g id="node599" class="node">
<title>layer2_concat_group1</title>
<polygon fill="yellow" stroke="black" points="41542,-302.8 41542,-349.2 41470.53,-382 41369.47,-382 41298,-349.2 41298,-302.8 41369.47,-270 41470.53,-270 41542,-302.8"/>
<polygon fill="none" stroke="black" points="41546,-300.24 41546,-351.76 41471.41,-386 41368.59,-386 41294,-351.76 41294,-300.24 41368.59,-266 41471.41,-266 41546,-300.24"/>
<text text-anchor="middle" x="41420" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="41420" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="41420" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="41420" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- layer2_gpu4_out_proj&#45;&gt;layer2_concat_group1 -->
<g id="edge35" class="edge">
<title>layer2_gpu4_out_proj&#45;&gt;layer2_concat_group1</title>
<path fill="none" stroke="black" d="M33809.13,-455.85C33823.76,-442.64 33842.3,-428.95 33862,-422 34054.46,-354.11 41006.88,-414.23 41209,-386 41240.95,-381.54 41274.9,-373.55 41306,-364.87"/>
<polygon fill="black" stroke="black" points="41307.33,-368.14 41315.99,-362.04 41305.42,-361.4 41307.33,-368.14"/>
</g>
<!-- layer2_gpu4_ln2 -->
<g id="node173" class="node">
<title>layer2_gpu4_ln2</title>
<ellipse fill="none" stroke="black" cx="29586" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="29586" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="29586" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="29586" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_mlp1 -->
<g id="node174" class="node">
<title>layer2_gpu4_mlp1</title>
<polygon fill="none" stroke="black" points="29492,-524 29358,-524 29358,-456 29492,-456 29492,-524"/>
<text text-anchor="middle" x="29425" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="29425" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="29425" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="29425" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_gelu -->
<g id="node175" class="node">
<title>layer2_gpu4_gelu</title>
<ellipse fill="none" stroke="black" cx="29245" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29245" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="29245" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="29245" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_gpu4_mlp2 -->
<g id="node176" class="node">
<title>layer2_gpu4_mlp2</title>
<polygon fill="none" stroke="black" points="29131.5,-524 29024.5,-524 29024.5,-456 29131.5,-456 29131.5,-524"/>
<text text-anchor="middle" x="29078" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="29078" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="29078" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="29078" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_ln1 -->
<g id="node177" class="node">
<title>layer3_gpu4_ln1</title>
<ellipse fill="none" stroke="black" cx="30555" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="30555" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="30555" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="30555" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_qkv -->
<g id="node178" class="node">
<title>layer3_gpu4_qkv</title>
<polygon fill="none" stroke="black" points="28768,-524 28638,-524 28638,-456 28768,-456 28768,-524"/>
<text text-anchor="middle" x="28703" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="28703" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="28703" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="28703" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_reshape -->
<g id="node179" class="node">
<title>layer3_gpu4_reshape</title>
<ellipse fill="none" stroke="black" cx="28552" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="28552" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="28552" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="28552" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_attn -->
<g id="node180" class="node">
<title>layer3_gpu4_attn</title>
<polygon fill="none" stroke="black" points="28311,-558 28156,-490 28311,-422 28466,-490 28311,-558"/>
<text text-anchor="middle" x="28311" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="28311" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="28311" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="28311" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_out_proj -->
<g id="node181" class="node">
<title>layer3_gpu4_out_proj</title>
<polygon fill="none" stroke="black" points="32240,-524 32096,-524 32096,-456 32240,-456 32240,-524"/>
<text text-anchor="middle" x="32168" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="32168" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="32168" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="32168" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_concat_group1 -->
<g id="node600" class="node">
<title>layer3_concat_group1</title>
<polygon fill="yellow" stroke="black" points="40926,-302.8 40926,-349.2 40854.53,-382 40753.47,-382 40682,-349.2 40682,-302.8 40753.47,-270 40854.53,-270 40926,-302.8"/>
<polygon fill="none" stroke="black" points="40930,-300.24 40930,-351.76 40855.41,-386 40752.59,-386 40678,-351.76 40678,-300.24 40752.59,-266 40855.41,-266 40930,-300.24"/>
<text text-anchor="middle" x="40804" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="40804" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="40804" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="40804" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- layer3_gpu4_out_proj&#45;&gt;layer3_concat_group1 -->
<g id="edge36" class="edge">
<title>layer3_gpu4_out_proj&#45;&gt;layer3_concat_group1</title>
<path fill="none" stroke="black" d="M32198.25,-455.86C32212.5,-442.65 32230.62,-428.96 32250,-422 32470.11,-342.98 40440.18,-434.33 40669,-386 40682.29,-383.19 40695.88,-379.01 40709.07,-374.15"/>
<polygon fill="black" stroke="black" points="40710.5,-377.34 40718.59,-370.49 40708,-370.81 40710.5,-377.34"/>
</g>
<!-- layer3_gpu4_ln2 -->
<g id="node182" class="node">
<title>layer3_gpu4_ln2</title>
<ellipse fill="none" stroke="black" cx="27893" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="27893" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="27893" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="27893" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_mlp1 -->
<g id="node183" class="node">
<title>layer3_gpu4_mlp1</title>
<polygon fill="none" stroke="black" points="27799,-524 27665,-524 27665,-456 27799,-456 27799,-524"/>
<text text-anchor="middle" x="27732" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="27732" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="27732" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="27732" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_gelu -->
<g id="node184" class="node">
<title>layer3_gpu4_gelu</title>
<ellipse fill="none" stroke="black" cx="27552" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27552" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="27552" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="27552" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_gpu4_mlp2 -->
<g id="node185" class="node">
<title>layer3_gpu4_mlp2</title>
<polygon fill="none" stroke="black" points="27438.5,-524 27331.5,-524 27331.5,-456 27438.5,-456 27438.5,-524"/>
<text text-anchor="middle" x="27385" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="27385" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="27385" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="27385" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- embed_5 -->
<g id="node186" class="node">
<title>embed_5</title>
<polygon fill="none" stroke="black" points="35548,-516.5 35328,-516.5 35328,-463.5 35548,-463.5 35548,-516.5"/>
<text text-anchor="middle" x="35438" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="35438" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="35438" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu5_ln1 -->
<g id="node187" class="node">
<title>layer0_gpu5_ln1</title>
<ellipse fill="none" stroke="black" cx="35438" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="35438" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="35438" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="35438" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- embed_5&#45;&gt;layer0_gpu5_ln1 -->
<g id="edge6" class="edge">
<title>embed_5&#45;&gt;layer0_gpu5_ln1</title>
<path fill="none" stroke="black" d="M35438,-463.33C35438,-439.41 35438,-403.17 35438,-374.06"/>
<polygon fill="black" stroke="black" points="35441.5,-373.69 35438,-363.69 35434.5,-373.69 35441.5,-373.69"/>
</g>
<!-- layer0_gpu5_qkv -->
<g id="node188" class="node">
<title>layer0_gpu5_qkv</title>
<polygon fill="none" stroke="black" points="40230,-524 40100,-524 40100,-456 40230,-456 40230,-524"/>
<text text-anchor="middle" x="40165" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="40165" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="40165" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="40165" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_reshape -->
<g id="node189" class="node">
<title>layer0_gpu5_reshape</title>
<ellipse fill="none" stroke="black" cx="40014" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="40014" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="40014" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="40014" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_attn -->
<g id="node190" class="node">
<title>layer0_gpu5_attn</title>
<polygon fill="none" stroke="black" points="39773,-558 39618,-490 39773,-422 39928,-490 39773,-558"/>
<text text-anchor="middle" x="39773" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="39773" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="39773" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="39773" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_out_proj -->
<g id="node191" class="node">
<title>layer0_gpu5_out_proj</title>
<polygon fill="none" stroke="black" points="37165,-524 37021,-524 37021,-456 37165,-456 37165,-524"/>
<text text-anchor="middle" x="37093" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="37093" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="37093" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="37093" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_out_proj&#45;&gt;layer0_concat_group1 -->
<g id="edge37" class="edge">
<title>layer0_gpu5_out_proj&#45;&gt;layer0_concat_group1</title>
<path fill="none" stroke="black" d="M37123.28,-455.92C37137.53,-442.73 37155.64,-429.02 37175,-422 37343.64,-360.8 40228.87,-424.9 40404,-386 40416.12,-383.31 40428.48,-379.41 40440.52,-374.88"/>
<polygon fill="black" stroke="black" points="40442.06,-378.03 40450.09,-371.12 40439.5,-371.52 40442.06,-378.03"/>
</g>
<!-- layer0_gpu5_ln2 -->
<g id="node192" class="node">
<title>layer0_gpu5_ln2</title>
<ellipse fill="none" stroke="black" cx="39355" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="39355" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="39355" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="39355" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_mlp1 -->
<g id="node193" class="node">
<title>layer0_gpu5_mlp1</title>
<polygon fill="none" stroke="black" points="39261,-524 39127,-524 39127,-456 39261,-456 39261,-524"/>
<text text-anchor="middle" x="39194" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="39194" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="39194" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="39194" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_gelu -->
<g id="node194" class="node">
<title>layer0_gpu5_gelu</title>
<ellipse fill="none" stroke="black" cx="39014" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="39014" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="39014" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="39014" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer0_gpu5_mlp2 -->
<g id="node195" class="node">
<title>layer0_gpu5_mlp2</title>
<polygon fill="none" stroke="black" points="38900.5,-524 38793.5,-524 38793.5,-456 38900.5,-456 38900.5,-524"/>
<text text-anchor="middle" x="38847" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="38847" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="38847" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="38847" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_ln1 -->
<g id="node196" class="node">
<title>layer1_gpu5_ln1</title>
<ellipse fill="none" stroke="black" cx="34604" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="34604" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="34604" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="34604" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_qkv -->
<g id="node197" class="node">
<title>layer1_gpu5_qkv</title>
<polygon fill="none" stroke="black" points="38613,-524 38483,-524 38483,-456 38613,-456 38613,-524"/>
<text text-anchor="middle" x="38548" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="38548" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="38548" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="38548" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_reshape -->
<g id="node198" class="node">
<title>layer1_gpu5_reshape</title>
<ellipse fill="none" stroke="black" cx="38397" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="38397" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="38397" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="38397" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_attn -->
<g id="node199" class="node">
<title>layer1_gpu5_attn</title>
<polygon fill="none" stroke="black" points="38156,-558 38001,-490 38156,-422 38311,-490 38156,-558"/>
<text text-anchor="middle" x="38156" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="38156" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="38156" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="38156" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_out_proj -->
<g id="node200" class="node">
<title>layer1_gpu5_out_proj</title>
<polygon fill="none" stroke="black" points="38775,-524 38631,-524 38631,-456 38775,-456 38775,-524"/>
<text text-anchor="middle" x="38703" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="38703" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="38703" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="38703" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_out_proj&#45;&gt;layer1_concat_group1 -->
<g id="edge38" class="edge">
<title>layer1_gpu5_out_proj&#45;&gt;layer1_concat_group1</title>
<path fill="none" stroke="black" d="M38733.29,-455.97C38747.55,-442.79 38765.66,-429.08 38785,-422 39009.78,-339.72 40705.11,-436.92 40939,-386 40952.17,-383.13 40965.64,-378.94 40978.73,-374.1"/>
<polygon fill="black" stroke="black" points="40980.11,-377.32 40988.19,-370.47 40977.6,-370.79 40980.11,-377.32"/>
</g>
<!-- layer1_gpu5_ln2 -->
<g id="node201" class="node">
<title>layer1_gpu5_ln2</title>
<ellipse fill="none" stroke="black" cx="37745" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="37745" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="37745" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="37745" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_mlp1 -->
<g id="node202" class="node">
<title>layer1_gpu5_mlp1</title>
<polygon fill="none" stroke="black" points="37651,-524 37517,-524 37517,-456 37651,-456 37651,-524"/>
<text text-anchor="middle" x="37584" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="37584" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="37584" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="37584" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_gelu -->
<g id="node203" class="node">
<title>layer1_gpu5_gelu</title>
<ellipse fill="none" stroke="black" cx="37404" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="37404" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="37404" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="37404" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_gpu5_mlp2 -->
<g id="node204" class="node">
<title>layer1_gpu5_mlp2</title>
<polygon fill="none" stroke="black" points="37290.5,-524 37183.5,-524 37183.5,-456 37290.5,-456 37290.5,-524"/>
<text text-anchor="middle" x="37237" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="37237" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="37237" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="37237" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_ln1 -->
<g id="node205" class="node">
<title>layer2_gpu5_ln1</title>
<ellipse fill="none" stroke="black" cx="36297" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="36297" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="36297" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="36297" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_qkv -->
<g id="node206" class="node">
<title>layer2_gpu5_qkv</title>
<polygon fill="none" stroke="black" points="37003,-524 36873,-524 36873,-456 37003,-456 37003,-524"/>
<text text-anchor="middle" x="36938" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="36938" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="36938" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="36938" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_reshape -->
<g id="node207" class="node">
<title>layer2_gpu5_reshape</title>
<ellipse fill="none" stroke="black" cx="36787" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="36787" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="36787" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="36787" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_attn -->
<g id="node208" class="node">
<title>layer2_gpu5_attn</title>
<polygon fill="none" stroke="black" points="36546,-558 36391,-490 36546,-422 36701,-490 36546,-558"/>
<text text-anchor="middle" x="36546" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="36546" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="36546" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="36546" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_out_proj -->
<g id="node209" class="node">
<title>layer2_gpu5_out_proj</title>
<polygon fill="none" stroke="black" points="40392,-524 40248,-524 40248,-456 40392,-456 40392,-524"/>
<text text-anchor="middle" x="40320" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="40320" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="40320" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="40320" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_out_proj&#45;&gt;layer2_concat_group1 -->
<g id="edge39" class="edge">
<title>layer2_gpu5_out_proj&#45;&gt;layer2_concat_group1</title>
<path fill="none" stroke="black" d="M40392.03,-488.39C40553.57,-485.5 40956.02,-469.71 41280,-386 41293.8,-382.43 41308.01,-377.75 41321.84,-372.57"/>
<polygon fill="black" stroke="black" points="41323.27,-375.77 41331.35,-368.91 41320.76,-369.23 41323.27,-375.77"/>
</g>
<!-- layer2_gpu5_ln2 -->
<g id="node210" class="node">
<title>layer2_gpu5_ln2</title>
<ellipse fill="none" stroke="black" cx="36128" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="36128" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="36128" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="36128" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_mlp1 -->
<g id="node211" class="node">
<title>layer2_gpu5_mlp1</title>
<polygon fill="none" stroke="black" points="36034,-524 35900,-524 35900,-456 36034,-456 36034,-524"/>
<text text-anchor="middle" x="35967" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="35967" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="35967" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="35967" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_gelu -->
<g id="node212" class="node">
<title>layer2_gpu5_gelu</title>
<ellipse fill="none" stroke="black" cx="35787" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="35787" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="35787" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="35787" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5_mlp2 -->
<g id="node213" class="node">
<title>layer2_gpu5_mlp2</title>
<polygon fill="none" stroke="black" points="35673.5,-524 35566.5,-524 35566.5,-456 35673.5,-456 35673.5,-524"/>
<text text-anchor="middle" x="35620" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="35620" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="35620" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="35620" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_ln1 -->
<g id="node214" class="node">
<title>layer3_gpu5_ln1</title>
<ellipse fill="none" stroke="black" cx="39524" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="39524" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="39524" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="39524" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_qkv -->
<g id="node215" class="node">
<title>layer3_gpu5_qkv</title>
<polygon fill="none" stroke="black" points="35310,-524 35180,-524 35180,-456 35310,-456 35310,-524"/>
<text text-anchor="middle" x="35245" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="35245" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="35245" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="35245" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_reshape -->
<g id="node216" class="node">
<title>layer3_gpu5_reshape</title>
<ellipse fill="none" stroke="black" cx="35094" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="35094" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="35094" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="35094" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_attn -->
<g id="node217" class="node">
<title>layer3_gpu5_attn</title>
<polygon fill="none" stroke="black" points="34853,-558 34698,-490 34853,-422 35008,-490 34853,-558"/>
<text text-anchor="middle" x="34853" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="34853" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="34853" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="34853" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_out_proj -->
<g id="node218" class="node">
<title>layer3_gpu5_out_proj</title>
<polygon fill="none" stroke="black" points="37983,-524 37839,-524 37839,-456 37983,-456 37983,-524"/>
<text text-anchor="middle" x="37911" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="37911" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="37911" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="37911" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_out_proj&#45;&gt;layer3_concat_group1 -->
<g id="edge40" class="edge">
<title>layer3_gpu5_out_proj&#45;&gt;layer3_concat_group1</title>
<path fill="none" stroke="black" d="M37940.84,-455.95C37954.91,-442.76 37972.82,-429.05 37992,-422 38131.6,-370.68 40523.62,-417.4 40669,-386 40682.18,-383.15 40695.65,-378.98 40708.74,-374.14"/>
<polygon fill="black" stroke="black" points="40710.11,-377.36 40718.19,-370.51 40707.6,-370.83 40710.11,-377.36"/>
</g>
<!-- layer3_gpu5_ln2 -->
<g id="node219" class="node">
<title>layer3_gpu5_ln2</title>
<ellipse fill="none" stroke="black" cx="34435" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="34435" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="34435" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="34435" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_mlp1 -->
<g id="node220" class="node">
<title>layer3_gpu5_mlp1</title>
<polygon fill="none" stroke="black" points="34341,-524 34207,-524 34207,-456 34341,-456 34341,-524"/>
<text text-anchor="middle" x="34274" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="34274" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="34274" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="34274" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_gelu -->
<g id="node221" class="node">
<title>layer3_gpu5_gelu</title>
<ellipse fill="none" stroke="black" cx="34094" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="34094" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="34094" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="34094" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_gpu5_mlp2 -->
<g id="node222" class="node">
<title>layer3_gpu5_mlp2</title>
<polygon fill="none" stroke="black" points="33980.5,-524 33873.5,-524 33873.5,-456 33980.5,-456 33980.5,-524"/>
<text text-anchor="middle" x="33927" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="33927" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="33927" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="33927" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- embed_6 -->
<g id="node223" class="node">
<title>embed_6</title>
<polygon fill="none" stroke="black" points="46456,-516.5 46236,-516.5 46236,-463.5 46456,-463.5 46456,-516.5"/>
<text text-anchor="middle" x="46346" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="46346" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="46346" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu6_ln1 -->
<g id="node224" class="node">
<title>layer0_gpu6_ln1</title>
<ellipse fill="none" stroke="black" cx="46346" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="46346" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="46346" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="46346" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- embed_6&#45;&gt;layer0_gpu6_ln1 -->
<g id="edge7" class="edge">
<title>embed_6&#45;&gt;layer0_gpu6_ln1</title>
<path fill="none" stroke="black" d="M46346,-463.33C46346,-439.41 46346,-403.17 46346,-374.06"/>
<polygon fill="black" stroke="black" points="46349.5,-373.69 46346,-363.69 46342.5,-373.69 46349.5,-373.69"/>
</g>
<!-- layer0_gpu6_qkv -->
<g id="node225" class="node">
<title>layer0_gpu6_qkv</title>
<polygon fill="none" stroke="black" points="47911,-524 47781,-524 47781,-456 47911,-456 47911,-524"/>
<text text-anchor="middle" x="47846" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="47846" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="47846" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="47846" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_reshape -->
<g id="node226" class="node">
<title>layer0_gpu6_reshape</title>
<ellipse fill="none" stroke="black" cx="47695" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="47695" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="47695" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="47695" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_attn -->
<g id="node227" class="node">
<title>layer0_gpu6_attn</title>
<polygon fill="none" stroke="black" points="47454,-558 47299,-490 47454,-422 47609,-490 47454,-558"/>
<text text-anchor="middle" x="47454" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="47454" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="47454" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="47454" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_out_proj -->
<g id="node228" class="node">
<title>layer0_gpu6_out_proj</title>
<polygon fill="none" stroke="black" points="42361,-524 42217,-524 42217,-456 42361,-456 42361,-524"/>
<text text-anchor="middle" x="42289" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="42289" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="42289" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="42289" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_out_proj&#45;&gt;layer0_concat_group1 -->
<g id="edge41" class="edge">
<title>layer0_gpu6_out_proj&#45;&gt;layer0_concat_group1</title>
<path fill="none" stroke="black" d="M42258.74,-455.68C42244.73,-442.62 42226.98,-429.08 42208,-422 42047.75,-362.19 40836.01,-422.94 40669,-386 40655.84,-383.09 40642.37,-378.87 40629.29,-374.02"/>
<polygon fill="black" stroke="black" points="40630.42,-370.71 40619.83,-370.38 40627.91,-377.24 40630.42,-370.71"/>
</g>
<!-- layer0_gpu6_ln2 -->
<g id="node229" class="node">
<title>layer0_gpu6_ln2</title>
<ellipse fill="none" stroke="black" cx="47036" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="47036" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="47036" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="47036" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_mlp1 -->
<g id="node230" class="node">
<title>layer0_gpu6_mlp1</title>
<polygon fill="none" stroke="black" points="46942,-524 46808,-524 46808,-456 46942,-456 46942,-524"/>
<text text-anchor="middle" x="46875" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="46875" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="46875" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="46875" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_gelu -->
<g id="node231" class="node">
<title>layer0_gpu6_gelu</title>
<ellipse fill="none" stroke="black" cx="46695" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="46695" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="46695" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="46695" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer0_gpu6_mlp2 -->
<g id="node232" class="node">
<title>layer0_gpu6_mlp2</title>
<polygon fill="none" stroke="black" points="46581.5,-524 46474.5,-524 46474.5,-456 46581.5,-456 46581.5,-524"/>
<text text-anchor="middle" x="46528" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="46528" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="46528" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="46528" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_ln1 -->
<g id="node233" class="node">
<title>layer1_gpu6_ln1</title>
<ellipse fill="none" stroke="black" cx="44695" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="44695" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="44695" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="44695" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_qkv -->
<g id="node234" class="node">
<title>layer1_gpu6_qkv</title>
<polygon fill="none" stroke="black" points="46218,-524 46088,-524 46088,-456 46218,-456 46218,-524"/>
<text text-anchor="middle" x="46153" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="46153" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="46153" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="46153" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_reshape -->
<g id="node235" class="node">
<title>layer1_gpu6_reshape</title>
<ellipse fill="none" stroke="black" cx="46002" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="46002" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="46002" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="46002" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_attn -->
<g id="node236" class="node">
<title>layer1_gpu6_attn</title>
<polygon fill="none" stroke="black" points="45761,-558 45606,-490 45761,-422 45916,-490 45761,-558"/>
<text text-anchor="middle" x="45761" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="45761" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="45761" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="45761" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_out_proj -->
<g id="node237" class="node">
<title>layer1_gpu6_out_proj</title>
<polygon fill="none" stroke="black" points="43971,-524 43827,-524 43827,-456 43971,-456 43971,-524"/>
<text text-anchor="middle" x="43899" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="43899" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="43899" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="43899" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_out_proj&#45;&gt;layer1_concat_group1 -->
<g id="edge42" class="edge">
<title>layer1_gpu6_out_proj&#45;&gt;layer1_concat_group1</title>
<path fill="none" stroke="black" d="M43869.15,-455.95C43855.09,-442.76 43837.18,-429.06 43818,-422 43682.21,-372.06 41355.61,-415.64 41214,-386 41199.74,-383.01 41185.11,-378.57 41170.94,-373.43"/>
<polygon fill="black" stroke="black" points="41171.8,-370.02 41161.21,-369.78 41169.34,-376.57 41171.8,-370.02"/>
</g>
<!-- layer1_gpu6_ln2 -->
<g id="node238" class="node">
<title>layer1_gpu6_ln2</title>
<ellipse fill="none" stroke="black" cx="45350" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="45350" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="45350" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="45350" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_mlp1 -->
<g id="node239" class="node">
<title>layer1_gpu6_mlp1</title>
<polygon fill="none" stroke="black" points="45256,-524 45122,-524 45122,-456 45256,-456 45256,-524"/>
<text text-anchor="middle" x="45189" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="45189" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="45189" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="45189" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_gelu -->
<g id="node240" class="node">
<title>layer1_gpu6_gelu</title>
<ellipse fill="none" stroke="black" cx="45009" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="45009" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="45009" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="45009" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_gpu6_mlp2 -->
<g id="node241" class="node">
<title>layer1_gpu6_mlp2</title>
<polygon fill="none" stroke="black" points="44895.5,-524 44788.5,-524 44788.5,-456 44895.5,-456 44895.5,-524"/>
<text text-anchor="middle" x="44842" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="44842" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="44842" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="44842" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_ln1 -->
<g id="node242" class="node">
<title>layer2_gpu6_ln1</title>
<ellipse fill="none" stroke="black" cx="47205" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="47205" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="47205" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="47205" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_qkv -->
<g id="node243" class="node">
<title>layer2_gpu6_qkv</title>
<polygon fill="none" stroke="black" points="44601,-524 44471,-524 44471,-456 44601,-456 44601,-524"/>
<text text-anchor="middle" x="44536" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="44536" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="44536" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="44536" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_reshape -->
<g id="node244" class="node">
<title>layer2_gpu6_reshape</title>
<ellipse fill="none" stroke="black" cx="44385" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="44385" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="44385" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="44385" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_attn -->
<g id="node245" class="node">
<title>layer2_gpu6_attn</title>
<polygon fill="none" stroke="black" points="44144,-558 43989,-490 44144,-422 44299,-490 44144,-558"/>
<text text-anchor="middle" x="44144" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="44144" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="44144" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="44144" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_out_proj -->
<g id="node246" class="node">
<title>layer2_gpu6_out_proj</title>
<polygon fill="none" stroke="black" points="45588,-524 45444,-524 45444,-456 45588,-456 45588,-524"/>
<text text-anchor="middle" x="45516" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="45516" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="45516" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="45516" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_out_proj&#45;&gt;layer2_concat_group1 -->
<g id="edge43" class="edge">
<title>layer2_gpu6_out_proj&#45;&gt;layer2_concat_group1</title>
<path fill="none" stroke="black" d="M45486.17,-455.91C45472.1,-442.71 45454.2,-429.01 45435,-422 45232.26,-347.95 41760.75,-432.61 41550,-386 41537.87,-383.32 41525.52,-379.43 41513.48,-374.9"/>
<polygon fill="black" stroke="black" points="41514.49,-371.54 41503.91,-371.15 41511.94,-378.06 41514.49,-371.54"/>
</g>
<!-- layer2_gpu6_ln2 -->
<g id="node247" class="node">
<title>layer2_gpu6_ln2</title>
<ellipse fill="none" stroke="black" cx="43733" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="43733" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="43733" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="43733" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_mlp1 -->
<g id="node248" class="node">
<title>layer2_gpu6_mlp1</title>
<polygon fill="none" stroke="black" points="43639,-524 43505,-524 43505,-456 43639,-456 43639,-524"/>
<text text-anchor="middle" x="43572" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="43572" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="43572" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="43572" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_gelu -->
<g id="node249" class="node">
<title>layer2_gpu6_gelu</title>
<ellipse fill="none" stroke="black" cx="43392" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="43392" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="43392" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="43392" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6_mlp2 -->
<g id="node250" class="node">
<title>layer2_gpu6_mlp2</title>
<polygon fill="none" stroke="black" points="43278.5,-524 43171.5,-524 43171.5,-456 43278.5,-456 43278.5,-524"/>
<text text-anchor="middle" x="43225" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="43225" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="43225" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="43225" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_ln1 -->
<g id="node251" class="node">
<title>layer3_gpu6_ln1</title>
<ellipse fill="none" stroke="black" cx="48005" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="48005" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="48005" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="48005" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_qkv -->
<g id="node252" class="node">
<title>layer3_gpu6_qkv</title>
<polygon fill="none" stroke="black" points="42991,-524 42861,-524 42861,-456 42991,-456 42991,-524"/>
<text text-anchor="middle" x="42926" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="42926" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="42926" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="42926" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_reshape -->
<g id="node253" class="node">
<title>layer3_gpu6_reshape</title>
<ellipse fill="none" stroke="black" cx="42775" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="42775" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="42775" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="42775" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_attn -->
<g id="node254" class="node">
<title>layer3_gpu6_attn</title>
<polygon fill="none" stroke="black" points="42534,-558 42379,-490 42534,-422 42689,-490 42534,-558"/>
<text text-anchor="middle" x="42534" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="42534" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="42534" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="42534" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_out_proj -->
<g id="node255" class="node">
<title>layer3_gpu6_out_proj</title>
<polygon fill="none" stroke="black" points="43153,-524 43009,-524 43009,-456 43153,-456 43153,-524"/>
<text text-anchor="middle" x="43081" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="43081" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="43081" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="43081" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_out_proj&#45;&gt;layer3_concat_group1 -->
<g id="edge44" class="edge">
<title>layer3_gpu6_out_proj&#45;&gt;layer3_concat_group1</title>
<path fill="none" stroke="black" d="M43051.14,-455.98C43037.07,-442.8 43019.17,-429.09 43000,-422 42785.19,-342.55 41162.77,-434.81 40939,-386 40925.83,-383.13 40912.36,-378.94 40899.27,-374.09"/>
<polygon fill="black" stroke="black" points="40900.41,-370.78 40889.82,-370.46 40897.9,-377.31 40900.41,-370.78"/>
</g>
<!-- layer3_gpu6_ln2 -->
<g id="node256" class="node">
<title>layer3_gpu6_ln2</title>
<ellipse fill="none" stroke="black" cx="42123" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="42123" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="42123" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="42123" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_mlp1 -->
<g id="node257" class="node">
<title>layer3_gpu6_mlp1</title>
<polygon fill="none" stroke="black" points="42029,-524 41895,-524 41895,-456 42029,-456 42029,-524"/>
<text text-anchor="middle" x="41962" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="41962" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="41962" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="41962" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_gelu -->
<g id="node258" class="node">
<title>layer3_gpu6_gelu</title>
<ellipse fill="none" stroke="black" cx="41782" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="41782" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="41782" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="41782" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_gpu6_mlp2 -->
<g id="node259" class="node">
<title>layer3_gpu6_mlp2</title>
<polygon fill="none" stroke="black" points="41668.5,-524 41561.5,-524 41561.5,-456 41668.5,-456 41668.5,-524"/>
<text text-anchor="middle" x="41615" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="41615" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="41615" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="41615" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- embed_7 -->
<g id="node260" class="node">
<title>embed_7</title>
<polygon fill="none" stroke="black" points="52999,-516.5 52779,-516.5 52779,-463.5 52999,-463.5 52999,-516.5"/>
<text text-anchor="middle" x="52889" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="52889" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="52889" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu7_ln1 -->
<g id="node261" class="node">
<title>layer0_gpu7_ln1</title>
<ellipse fill="none" stroke="black" cx="52889" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="52889" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="52889" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="52889" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- embed_7&#45;&gt;layer0_gpu7_ln1 -->
<g id="edge8" class="edge">
<title>embed_7&#45;&gt;layer0_gpu7_ln1</title>
<path fill="none" stroke="black" d="M52889,-463.33C52889,-439.41 52889,-403.17 52889,-374.06"/>
<polygon fill="black" stroke="black" points="52892.5,-373.69 52889,-363.69 52885.5,-373.69 52892.5,-373.69"/>
</g>
<!-- layer0_gpu7_qkv -->
<g id="node262" class="node">
<title>layer0_gpu7_qkv</title>
<polygon fill="none" stroke="black" points="54454,-524 54324,-524 54324,-456 54454,-456 54454,-524"/>
<text text-anchor="middle" x="54389" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="54389" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="54389" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="54389" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_reshape -->
<g id="node263" class="node">
<title>layer0_gpu7_reshape</title>
<ellipse fill="none" stroke="black" cx="54238" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="54238" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="54238" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="54238" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_attn -->
<g id="node264" class="node">
<title>layer0_gpu7_attn</title>
<polygon fill="none" stroke="black" points="53997,-558 53842,-490 53997,-422 54152,-490 53997,-558"/>
<text text-anchor="middle" x="53997" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="53997" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53997" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="53997" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_out_proj -->
<g id="node265" class="node">
<title>layer0_gpu7_out_proj</title>
<polygon fill="none" stroke="black" points="48904,-524 48760,-524 48760,-456 48904,-456 48904,-524"/>
<text text-anchor="middle" x="48832" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="48832" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="48832" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="48832" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_out_proj&#45;&gt;layer0_concat_group1 -->
<g id="edge45" class="edge">
<title>layer0_gpu7_out_proj&#45;&gt;layer0_concat_group1</title>
<path fill="none" stroke="black" d="M48802.19,-455.86C48788.12,-442.66 48770.22,-428.97 48751,-422 48539.94,-345.49 40888.65,-432.41 40669,-386 40655.71,-383.19 40642.12,-379.01 40628.94,-374.14"/>
<polygon fill="black" stroke="black" points="40630,-370.8 40619.41,-370.49 40627.5,-377.34 40630,-370.8"/>
</g>
<!-- layer0_gpu7_ln2 -->
<g id="node266" class="node">
<title>layer0_gpu7_ln2</title>
<ellipse fill="none" stroke="black" cx="53579" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="53579" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="53579" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="53579" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_mlp1 -->
<g id="node267" class="node">
<title>layer0_gpu7_mlp1</title>
<polygon fill="none" stroke="black" points="53485,-524 53351,-524 53351,-456 53485,-456 53485,-524"/>
<text text-anchor="middle" x="53418" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="53418" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="53418" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="53418" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_gelu -->
<g id="node268" class="node">
<title>layer0_gpu7_gelu</title>
<ellipse fill="none" stroke="black" cx="53238" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="53238" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="53238" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="53238" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer0_gpu7_mlp2 -->
<g id="node269" class="node">
<title>layer0_gpu7_mlp2</title>
<polygon fill="none" stroke="black" points="53124.5,-524 53017.5,-524 53017.5,-456 53124.5,-456 53124.5,-524"/>
<text text-anchor="middle" x="53071" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="53071" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="53071" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="53071" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_ln1 -->
<g id="node270" class="node">
<title>layer1_gpu7_ln1</title>
<ellipse fill="none" stroke="black" cx="52055" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="52055" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="52055" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="52055" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_qkv -->
<g id="node271" class="node">
<title>layer1_gpu7_qkv</title>
<polygon fill="none" stroke="black" points="52761,-524 52631,-524 52631,-456 52761,-456 52761,-524"/>
<text text-anchor="middle" x="52696" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="52696" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="52696" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="52696" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_reshape -->
<g id="node272" class="node">
<title>layer1_gpu7_reshape</title>
<ellipse fill="none" stroke="black" cx="52545" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="52545" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="52545" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="52545" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_attn -->
<g id="node273" class="node">
<title>layer1_gpu7_attn</title>
<polygon fill="none" stroke="black" points="52304,-558 52149,-490 52304,-422 52459,-490 52304,-558"/>
<text text-anchor="middle" x="52304" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="52304" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52304" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="52304" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_out_proj -->
<g id="node274" class="node">
<title>layer1_gpu7_out_proj</title>
<polygon fill="none" stroke="black" points="50514,-524 50370,-524 50370,-456 50514,-456 50514,-524"/>
<text text-anchor="middle" x="50442" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="50442" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="50442" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="50442" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_out_proj&#45;&gt;layer1_concat_group1 -->
<g id="edge46" class="edge">
<title>layer1_gpu7_out_proj&#45;&gt;layer1_concat_group1</title>
<path fill="none" stroke="black" d="M50412.19,-455.86C50398.12,-442.66 50380.22,-428.96 50361,-422 50242.48,-379.07 41409.85,-403.38 41285,-386 41253.04,-381.55 41219.1,-373.57 41188,-364.89"/>
<polygon fill="black" stroke="black" points="41188.58,-361.42 41178,-362.06 41186.67,-368.16 41188.58,-361.42"/>
</g>
<!-- layer1_gpu7_ln2 -->
<g id="node275" class="node">
<title>layer1_gpu7_ln2</title>
<ellipse fill="none" stroke="black" cx="51886" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="51886" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="51886" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="51886" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_mlp1 -->
<g id="node276" class="node">
<title>layer1_gpu7_mlp1</title>
<polygon fill="none" stroke="black" points="51792,-524 51658,-524 51658,-456 51792,-456 51792,-524"/>
<text text-anchor="middle" x="51725" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="51725" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="51725" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="51725" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_gelu -->
<g id="node277" class="node">
<title>layer1_gpu7_gelu</title>
<ellipse fill="none" stroke="black" cx="51545" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="51545" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="51545" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="51545" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_gpu7_mlp2 -->
<g id="node278" class="node">
<title>layer1_gpu7_mlp2</title>
<polygon fill="none" stroke="black" points="51431.5,-524 51324.5,-524 51324.5,-456 51431.5,-456 51431.5,-524"/>
<text text-anchor="middle" x="51378" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="51378" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="51378" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="51378" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_ln1 -->
<g id="node279" class="node">
<title>layer2_gpu7_ln1</title>
<ellipse fill="none" stroke="black" cx="53748" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="53748" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="53748" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="53748" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_qkv -->
<g id="node280" class="node">
<title>layer2_gpu7_qkv</title>
<polygon fill="none" stroke="black" points="51144,-524 51014,-524 51014,-456 51144,-456 51144,-524"/>
<text text-anchor="middle" x="51079" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="51079" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="51079" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="51079" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_reshape -->
<g id="node281" class="node">
<title>layer2_gpu7_reshape</title>
<ellipse fill="none" stroke="black" cx="50928" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="50928" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="50928" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="50928" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_attn -->
<g id="node282" class="node">
<title>layer2_gpu7_attn</title>
<polygon fill="none" stroke="black" points="50687,-558 50532,-490 50687,-422 50842,-490 50687,-558"/>
<text text-anchor="middle" x="50687" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="50687" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50687" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="50687" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_out_proj -->
<g id="node283" class="node">
<title>layer2_gpu7_out_proj</title>
<polygon fill="none" stroke="black" points="51306,-524 51162,-524 51162,-456 51306,-456 51306,-524"/>
<text text-anchor="middle" x="51234" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="51234" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="51234" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="51234" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_out_proj&#45;&gt;layer2_concat_group1 -->
<g id="edge47" class="edge">
<title>layer2_gpu7_out_proj&#45;&gt;layer2_concat_group1</title>
<path fill="none" stroke="black" d="M51204.19,-455.86C51190.12,-442.65 51172.22,-428.96 51153,-422 51027.59,-376.59 41680.31,-414.44 41550,-386 41537.87,-383.35 41525.5,-379.48 41513.46,-374.97"/>
<polygon fill="black" stroke="black" points="41514.48,-371.6 41503.89,-371.22 41511.93,-378.12 41514.48,-371.6"/>
</g>
<!-- layer2_gpu7_ln2 -->
<g id="node284" class="node">
<title>layer2_gpu7_ln2</title>
<ellipse fill="none" stroke="black" cx="50276" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="50276" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="50276" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="50276" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_mlp1 -->
<g id="node285" class="node">
<title>layer2_gpu7_mlp1</title>
<polygon fill="none" stroke="black" points="50182,-524 50048,-524 50048,-456 50182,-456 50182,-524"/>
<text text-anchor="middle" x="50115" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="50115" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="50115" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="50115" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_gelu -->
<g id="node286" class="node">
<title>layer2_gpu7_gelu</title>
<ellipse fill="none" stroke="black" cx="49935" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="49935" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="49935" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="49935" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7_mlp2 -->
<g id="node287" class="node">
<title>layer2_gpu7_mlp2</title>
<polygon fill="none" stroke="black" points="49821.5,-524 49714.5,-524 49714.5,-456 49821.5,-456 49821.5,-524"/>
<text text-anchor="middle" x="49768" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="49768" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="49768" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="49768" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_ln1 -->
<g id="node288" class="node">
<title>layer3_gpu7_ln1</title>
<ellipse fill="none" stroke="black" cx="54548" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="54548" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="54548" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="54548" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_qkv -->
<g id="node289" class="node">
<title>layer3_gpu7_qkv</title>
<polygon fill="none" stroke="black" points="49534,-524 49404,-524 49404,-456 49534,-456 49534,-524"/>
<text text-anchor="middle" x="49469" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="49469" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="49469" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="49469" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_reshape -->
<g id="node290" class="node">
<title>layer3_gpu7_reshape</title>
<ellipse fill="none" stroke="black" cx="49318" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="49318" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="49318" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="49318" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_attn -->
<g id="node291" class="node">
<title>layer3_gpu7_attn</title>
<polygon fill="none" stroke="black" points="49077,-558 48922,-490 49077,-422 49232,-490 49077,-558"/>
<text text-anchor="middle" x="49077" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="49077" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="49077" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="49077" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_out_proj -->
<g id="node292" class="node">
<title>layer3_gpu7_out_proj</title>
<polygon fill="none" stroke="black" points="49696,-524 49552,-524 49552,-456 49696,-456 49696,-524"/>
<text text-anchor="middle" x="49624" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="49624" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="49624" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="49624" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_out_proj&#45;&gt;layer3_concat_group1 -->
<g id="edge48" class="edge">
<title>layer3_gpu7_out_proj&#45;&gt;layer3_concat_group1</title>
<path fill="none" stroke="black" d="M49594.19,-455.86C49580.12,-442.66 49562.22,-428.96 49543,-422 49318.29,-340.58 41172.85,-435.38 40939,-386 40925.71,-383.19 40912.12,-379.01 40898.93,-374.15"/>
<polygon fill="black" stroke="black" points="40900,-370.81 40889.41,-370.49 40897.49,-377.34 40900,-370.81"/>
</g>
<!-- layer3_gpu7_ln2 -->
<g id="node293" class="node">
<title>layer3_gpu7_ln2</title>
<ellipse fill="none" stroke="black" cx="48666" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="48666" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="48666" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="48666" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_mlp1 -->
<g id="node294" class="node">
<title>layer3_gpu7_mlp1</title>
<polygon fill="none" stroke="black" points="48572,-524 48438,-524 48438,-456 48572,-456 48572,-524"/>
<text text-anchor="middle" x="48505" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="48505" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="48505" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="48505" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_gelu -->
<g id="node295" class="node">
<title>layer3_gpu7_gelu</title>
<ellipse fill="none" stroke="black" cx="48325" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="48325" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="48325" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="48325" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_gpu7_mlp2 -->
<g id="node296" class="node">
<title>layer3_gpu7_mlp2</title>
<polygon fill="none" stroke="black" points="48211.5,-524 48104.5,-524 48104.5,-456 48211.5,-456 48211.5,-524"/>
<text text-anchor="middle" x="48158" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="48158" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="48158" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="48158" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- embed_8 -->
<g id="node297" class="node">
<title>embed_8</title>
<polygon fill="none" stroke="black" points="57289,-516.5 57069,-516.5 57069,-463.5 57289,-463.5 57289,-516.5"/>
<text text-anchor="middle" x="57179" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="57179" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="57179" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu8_ln1 -->
<g id="node298" class="node">
<title>layer0_gpu8_ln1</title>
<ellipse fill="none" stroke="black" cx="57179" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="57179" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="57179" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="57179" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- embed_8&#45;&gt;layer0_gpu8_ln1 -->
<g id="edge9" class="edge">
<title>embed_8&#45;&gt;layer0_gpu8_ln1</title>
<path fill="none" stroke="black" d="M57179,-463.33C57179,-439.41 57179,-403.17 57179,-374.06"/>
<polygon fill="black" stroke="black" points="57182.5,-373.69 57179,-363.69 57175.5,-373.69 57182.5,-373.69"/>
</g>
<!-- layer0_gpu8_qkv -->
<g id="node299" class="node">
<title>layer0_gpu8_qkv</title>
<polygon fill="none" stroke="black" points="61146,-524 61016,-524 61016,-456 61146,-456 61146,-524"/>
<text text-anchor="middle" x="61081" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="61081" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="61081" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="61081" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_reshape -->
<g id="node300" class="node">
<title>layer0_gpu8_reshape</title>
<ellipse fill="none" stroke="black" cx="60930" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="60930" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="60930" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="60930" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_attn -->
<g id="node301" class="node">
<title>layer0_gpu8_attn</title>
<polygon fill="none" stroke="black" points="60689,-558 60534,-490 60689,-422 60844,-490 60689,-558"/>
<text text-anchor="middle" x="60689" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="60689" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60689" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="60689" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_out_proj -->
<g id="node302" class="node">
<title>layer0_gpu8_out_proj</title>
<polygon fill="none" stroke="black" points="58906,-524 58762,-524 58762,-456 58906,-456 58906,-524"/>
<text text-anchor="middle" x="58834" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="58834" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="58834" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="58834" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_concat_group2 -->
<g id="node601" class="node">
<title>layer0_concat_group2</title>
<polygon fill="yellow" stroke="black" points="68180,-302.8 68180,-349.2 68108.53,-382 68007.47,-382 67936,-349.2 67936,-302.8 68007.47,-270 68108.53,-270 68180,-302.8"/>
<polygon fill="none" stroke="black" points="68184,-300.24 68184,-351.76 68109.41,-386 68006.59,-386 67932,-351.76 67932,-300.24 68006.59,-266 68109.41,-266 68184,-300.24"/>
<text text-anchor="middle" x="68058" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="68058" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="68058" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="68058" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- layer0_gpu8_out_proj&#45;&gt;layer0_concat_group2 -->
<g id="edge49" class="edge">
<title>layer0_gpu8_out_proj&#45;&gt;layer0_concat_group2</title>
<path fill="none" stroke="black" d="M58863.81,-455.86C58877.88,-442.66 58895.78,-428.96 58915,-422 59150.39,-336.73 67683.4,-439.42 67928,-386 67940.13,-383.35 67952.5,-379.48 67964.54,-374.96"/>
<polygon fill="black" stroke="black" points="67966.07,-378.12 67974.11,-371.21 67963.52,-371.6 67966.07,-378.12"/>
</g>
<!-- layer0_gpu8_ln2 -->
<g id="node303" class="node">
<title>layer0_gpu8_ln2</title>
<ellipse fill="none" stroke="black" cx="60278" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="60278" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="60278" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="60278" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_mlp1 -->
<g id="node304" class="node">
<title>layer0_gpu8_mlp1</title>
<polygon fill="none" stroke="black" points="60184,-524 60050,-524 60050,-456 60184,-456 60184,-524"/>
<text text-anchor="middle" x="60117" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="60117" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="60117" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="60117" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_gelu -->
<g id="node305" class="node">
<title>layer0_gpu8_gelu</title>
<ellipse fill="none" stroke="black" cx="59937" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="59937" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="59937" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="59937" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer0_gpu8_mlp2 -->
<g id="node306" class="node">
<title>layer0_gpu8_mlp2</title>
<polygon fill="none" stroke="black" points="59823.5,-524 59716.5,-524 59716.5,-456 59823.5,-456 59823.5,-524"/>
<text text-anchor="middle" x="59770" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="59770" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="59770" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="59770" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_ln1 -->
<g id="node307" class="node">
<title>layer1_gpu8_ln1</title>
<ellipse fill="none" stroke="black" cx="55520" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="55520" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="55520" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="55520" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_qkv -->
<g id="node308" class="node">
<title>layer1_gpu8_qkv</title>
<polygon fill="none" stroke="black" points="59536,-524 59406,-524 59406,-456 59536,-456 59536,-524"/>
<text text-anchor="middle" x="59471" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="59471" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="59471" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="59471" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_reshape -->
<g id="node309" class="node">
<title>layer1_gpu8_reshape</title>
<ellipse fill="none" stroke="black" cx="59320" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="59320" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="59320" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="59320" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_attn -->
<g id="node310" class="node">
<title>layer1_gpu8_attn</title>
<polygon fill="none" stroke="black" points="59079,-558 58924,-490 59079,-422 59234,-490 59079,-558"/>
<text text-anchor="middle" x="59079" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="59079" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59079" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="59079" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_out_proj -->
<g id="node311" class="node">
<title>layer1_gpu8_out_proj</title>
<polygon fill="none" stroke="black" points="60516,-524 60372,-524 60372,-456 60516,-456 60516,-524"/>
<text text-anchor="middle" x="60444" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="60444" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="60444" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="60444" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_concat_group2 -->
<g id="node602" class="node">
<title>layer1_concat_group2</title>
<polygon fill="yellow" stroke="black" points="68720,-302.8 68720,-349.2 68648.53,-382 68547.47,-382 68476,-349.2 68476,-302.8 68547.47,-270 68648.53,-270 68720,-302.8"/>
<polygon fill="none" stroke="black" points="68724,-300.24 68724,-351.76 68649.41,-386 68546.59,-386 68472,-351.76 68472,-300.24 68546.59,-266 68649.41,-266 68724,-300.24"/>
<text text-anchor="middle" x="68598" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="68598" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="68598" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="68598" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- layer1_gpu8_out_proj&#45;&gt;layer1_concat_group2 -->
<g id="edge50" class="edge">
<title>layer1_gpu8_out_proj&#45;&gt;layer1_concat_group2</title>
<path fill="none" stroke="black" d="M60473.81,-455.86C60487.88,-442.66 60505.78,-428.97 60525,-422 60732.3,-346.84 68247.26,-431.59 68463,-386 68476.29,-383.19 68489.88,-379.01 68503.06,-374.14"/>
<polygon fill="black" stroke="black" points="68504.5,-377.34 68512.59,-370.49 68502,-370.8 68504.5,-377.34"/>
</g>
<!-- layer1_gpu8_ln2 -->
<g id="node312" class="node">
<title>layer1_gpu8_ln2</title>
<ellipse fill="none" stroke="black" cx="58668" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="58668" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="58668" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="58668" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_mlp1 -->
<g id="node313" class="node">
<title>layer1_gpu8_mlp1</title>
<polygon fill="none" stroke="black" points="58574,-524 58440,-524 58440,-456 58574,-456 58574,-524"/>
<text text-anchor="middle" x="58507" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="58507" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="58507" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="58507" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_gelu -->
<g id="node314" class="node">
<title>layer1_gpu8_gelu</title>
<ellipse fill="none" stroke="black" cx="58327" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="58327" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="58327" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="58327" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_gpu8_mlp2 -->
<g id="node315" class="node">
<title>layer1_gpu8_mlp2</title>
<polygon fill="none" stroke="black" points="58213.5,-524 58106.5,-524 58106.5,-456 58213.5,-456 58213.5,-524"/>
<text text-anchor="middle" x="58160" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="58160" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="58160" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="58160" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_ln1 -->
<g id="node316" class="node">
<title>layer2_gpu8_ln1</title>
<ellipse fill="none" stroke="black" cx="56320" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="56320" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="56320" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="56320" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_qkv -->
<g id="node317" class="node">
<title>layer2_gpu8_qkv</title>
<polygon fill="none" stroke="black" points="57919,-524 57789,-524 57789,-456 57919,-456 57919,-524"/>
<text text-anchor="middle" x="57854" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="57854" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="57854" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="57854" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_reshape -->
<g id="node318" class="node">
<title>layer2_gpu8_reshape</title>
<ellipse fill="none" stroke="black" cx="57703" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="57703" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="57703" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="57703" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_attn -->
<g id="node319" class="node">
<title>layer2_gpu8_attn</title>
<polygon fill="none" stroke="black" points="57462,-558 57307,-490 57462,-422 57617,-490 57462,-558"/>
<text text-anchor="middle" x="57462" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="57462" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="57462" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="57462" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_out_proj -->
<g id="node320" class="node">
<title>layer2_gpu8_out_proj</title>
<polygon fill="none" stroke="black" points="61308,-524 61164,-524 61164,-456 61308,-456 61308,-524"/>
<text text-anchor="middle" x="61236" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="61236" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="61236" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="61236" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_concat_group2 -->
<g id="node603" class="node">
<title>layer2_concat_group2</title>
<polygon fill="yellow" stroke="black" points="69104,-302.8 69104,-349.2 69032.53,-382 68931.47,-382 68860,-349.2 68860,-302.8 68931.47,-270 69032.53,-270 69104,-302.8"/>
<polygon fill="none" stroke="black" points="69108,-300.24 69108,-351.76 69033.41,-386 68930.59,-386 68856,-351.76 68856,-300.24 68930.59,-266 69033.41,-266 69108,-300.24"/>
<text text-anchor="middle" x="68982" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="68982" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="68982" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="68982" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- layer2_gpu8_out_proj&#45;&gt;layer2_concat_group2 -->
<g id="edge51" class="edge">
<title>layer2_gpu8_out_proj&#45;&gt;layer2_concat_group2</title>
<path fill="none" stroke="black" d="M61294.99,-455.82C61321.87,-442.53 61354.64,-428.77 61386,-422 61585.5,-378.96 68530.35,-410.18 68733,-386 68775.38,-380.94 68821.03,-371.37 68861.51,-361.39"/>
<polygon fill="black" stroke="black" points="68862.56,-364.73 68871.42,-358.91 68860.87,-357.94 68862.56,-364.73"/>
</g>
<!-- layer2_gpu8_ln2 -->
<g id="node321" class="node">
<title>layer2_gpu8_ln2</title>
<ellipse fill="none" stroke="black" cx="56975" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="56975" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="56975" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="56975" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_mlp1 -->
<g id="node322" class="node">
<title>layer2_gpu8_mlp1</title>
<polygon fill="none" stroke="black" points="56881,-524 56747,-524 56747,-456 56881,-456 56881,-524"/>
<text text-anchor="middle" x="56814" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="56814" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="56814" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="56814" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_gelu -->
<g id="node323" class="node">
<title>layer2_gpu8_gelu</title>
<ellipse fill="none" stroke="black" cx="56634" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="56634" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="56634" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="56634" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_gpu8_mlp2 -->
<g id="node324" class="node">
<title>layer2_gpu8_mlp2</title>
<polygon fill="none" stroke="black" points="56520.5,-524 56413.5,-524 56413.5,-456 56520.5,-456 56520.5,-524"/>
<text text-anchor="middle" x="56467" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="56467" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="56467" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="56467" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_ln1 -->
<g id="node325" class="node">
<title>layer3_gpu8_ln1</title>
<ellipse fill="none" stroke="black" cx="58013" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="58013" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="58013" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="58013" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_qkv -->
<g id="node326" class="node">
<title>layer3_gpu8_qkv</title>
<polygon fill="none" stroke="black" points="56226,-524 56096,-524 56096,-456 56226,-456 56226,-524"/>
<text text-anchor="middle" x="56161" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="56161" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="56161" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="56161" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_reshape -->
<g id="node327" class="node">
<title>layer3_gpu8_reshape</title>
<ellipse fill="none" stroke="black" cx="56010" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="56010" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="56010" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="56010" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_attn -->
<g id="node328" class="node">
<title>layer3_gpu8_attn</title>
<polygon fill="none" stroke="black" points="55769,-558 55614,-490 55769,-422 55924,-490 55769,-558"/>
<text text-anchor="middle" x="55769" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="55769" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55769" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="55769" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_out_proj -->
<g id="node329" class="node">
<title>layer3_gpu8_out_proj</title>
<polygon fill="none" stroke="black" points="59698,-524 59554,-524 59554,-456 59698,-456 59698,-524"/>
<text text-anchor="middle" x="59626" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="59626" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="59626" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="59626" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_concat_group2 -->
<g id="node604" class="node">
<title>layer3_concat_group2</title>
<polygon fill="yellow" stroke="black" points="68450,-302.8 68450,-349.2 68378.53,-382 68277.47,-382 68206,-349.2 68206,-302.8 68277.47,-270 68378.53,-270 68450,-302.8"/>
<polygon fill="none" stroke="black" points="68454,-300.24 68454,-351.76 68379.41,-386 68276.59,-386 68202,-351.76 68202,-300.24 68276.59,-266 68379.41,-266 68454,-300.24"/>
<text text-anchor="middle" x="68328" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="68328" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="68328" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="68328" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- layer3_gpu8_out_proj&#45;&gt;layer3_concat_group2 -->
<g id="edge52" class="edge">
<title>layer3_gpu8_out_proj&#45;&gt;layer3_concat_group2</title>
<path fill="none" stroke="black" d="M59656.25,-455.85C59670.5,-442.65 59688.62,-428.96 59708,-422 59929.84,-342.36 67962.39,-434.7 68193,-386 68206.29,-383.19 68219.88,-379.01 68233.07,-374.15"/>
<polygon fill="black" stroke="black" points="68234.5,-377.34 68242.59,-370.49 68232,-370.81 68234.5,-377.34"/>
</g>
<!-- layer3_gpu8_ln2 -->
<g id="node330" class="node">
<title>layer3_gpu8_ln2</title>
<ellipse fill="none" stroke="black" cx="55351" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="55351" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="55351" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="55351" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_mlp1 -->
<g id="node331" class="node">
<title>layer3_gpu8_mlp1</title>
<polygon fill="none" stroke="black" points="55257,-524 55123,-524 55123,-456 55257,-456 55257,-524"/>
<text text-anchor="middle" x="55190" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="55190" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="55190" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="55190" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_gelu -->
<g id="node332" class="node">
<title>layer3_gpu8_gelu</title>
<ellipse fill="none" stroke="black" cx="55010" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="55010" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="55010" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="55010" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_gpu8_mlp2 -->
<g id="node333" class="node">
<title>layer3_gpu8_mlp2</title>
<polygon fill="none" stroke="black" points="54896.5,-524 54789.5,-524 54789.5,-456 54896.5,-456 54896.5,-524"/>
<text text-anchor="middle" x="54843" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="54843" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="54843" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="54843" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- embed_9 -->
<g id="node334" class="node">
<title>embed_9</title>
<polygon fill="none" stroke="black" points="63897,-516.5 63677,-516.5 63677,-463.5 63897,-463.5 63897,-516.5"/>
<text text-anchor="middle" x="63787" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="63787" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="63787" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu9_ln1 -->
<g id="node335" class="node">
<title>layer0_gpu9_ln1</title>
<ellipse fill="none" stroke="black" cx="63787" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="63787" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="63787" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="63787" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- embed_9&#45;&gt;layer0_gpu9_ln1 -->
<g id="edge10" class="edge">
<title>embed_9&#45;&gt;layer0_gpu9_ln1</title>
<path fill="none" stroke="black" d="M63787,-463.33C63787,-439.41 63787,-403.17 63787,-374.06"/>
<polygon fill="black" stroke="black" points="63790.5,-373.69 63787,-363.69 63783.5,-373.69 63790.5,-373.69"/>
</g>
<!-- layer0_gpu9_qkv -->
<g id="node336" class="node">
<title>layer0_gpu9_qkv</title>
<polygon fill="none" stroke="black" points="67754,-524 67624,-524 67624,-456 67754,-456 67754,-524"/>
<text text-anchor="middle" x="67689" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="67689" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="67689" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="67689" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_reshape -->
<g id="node337" class="node">
<title>layer0_gpu9_reshape</title>
<ellipse fill="none" stroke="black" cx="67538" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="67538" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="67538" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="67538" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_attn -->
<g id="node338" class="node">
<title>layer0_gpu9_attn</title>
<polygon fill="none" stroke="black" points="67297,-558 67142,-490 67297,-422 67452,-490 67297,-558"/>
<text text-anchor="middle" x="67297" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="67297" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="67297" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="67297" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_out_proj -->
<g id="node339" class="node">
<title>layer0_gpu9_out_proj</title>
<polygon fill="none" stroke="black" points="64689,-524 64545,-524 64545,-456 64689,-456 64689,-524"/>
<text text-anchor="middle" x="64617" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="64617" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="64617" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="64617" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_out_proj&#45;&gt;layer0_concat_group2 -->
<g id="edge53" class="edge">
<title>layer0_gpu9_out_proj&#45;&gt;layer0_concat_group2</title>
<path fill="none" stroke="black" d="M64647.28,-455.92C64661.53,-442.73 64679.64,-429.02 64699,-422 64867.64,-360.8 67752.87,-424.9 67928,-386 67940.12,-383.31 67952.48,-379.41 67964.52,-374.88"/>
<polygon fill="black" stroke="black" points="67966.06,-378.03 67974.09,-371.12 67963.5,-371.52 67966.06,-378.03"/>
</g>
<!-- layer0_gpu9_ln2 -->
<g id="node340" class="node">
<title>layer0_gpu9_ln2</title>
<ellipse fill="none" stroke="black" cx="66879" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="66879" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="66879" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="66879" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_mlp1 -->
<g id="node341" class="node">
<title>layer0_gpu9_mlp1</title>
<polygon fill="none" stroke="black" points="66785,-524 66651,-524 66651,-456 66785,-456 66785,-524"/>
<text text-anchor="middle" x="66718" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="66718" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="66718" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="66718" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_gelu -->
<g id="node342" class="node">
<title>layer0_gpu9_gelu</title>
<ellipse fill="none" stroke="black" cx="66538" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="66538" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="66538" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="66538" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer0_gpu9_mlp2 -->
<g id="node343" class="node">
<title>layer0_gpu9_mlp2</title>
<polygon fill="none" stroke="black" points="66424.5,-524 66317.5,-524 66317.5,-456 66424.5,-456 66424.5,-524"/>
<text text-anchor="middle" x="66371" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="66371" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="66371" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="66371" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_ln1 -->
<g id="node344" class="node">
<title>layer1_gpu9_ln1</title>
<ellipse fill="none" stroke="black" cx="62128" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="62128" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="62128" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="62128" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_qkv -->
<g id="node345" class="node">
<title>layer1_gpu9_qkv</title>
<polygon fill="none" stroke="black" points="66137,-524 66007,-524 66007,-456 66137,-456 66137,-524"/>
<text text-anchor="middle" x="66072" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="66072" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="66072" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="66072" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_reshape -->
<g id="node346" class="node">
<title>layer1_gpu9_reshape</title>
<ellipse fill="none" stroke="black" cx="65921" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="65921" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="65921" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="65921" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_attn -->
<g id="node347" class="node">
<title>layer1_gpu9_attn</title>
<polygon fill="none" stroke="black" points="65680,-558 65525,-490 65680,-422 65835,-490 65680,-558"/>
<text text-anchor="middle" x="65680" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="65680" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="65680" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="65680" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_out_proj -->
<g id="node348" class="node">
<title>layer1_gpu9_out_proj</title>
<polygon fill="none" stroke="black" points="66299,-524 66155,-524 66155,-456 66299,-456 66299,-524"/>
<text text-anchor="middle" x="66227" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="66227" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="66227" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="66227" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_out_proj&#45;&gt;layer1_concat_group2 -->
<g id="edge54" class="edge">
<title>layer1_gpu9_out_proj&#45;&gt;layer1_concat_group2</title>
<path fill="none" stroke="black" d="M66257.29,-455.97C66271.55,-442.79 66289.66,-429.08 66309,-422 66533.78,-339.72 68229.11,-436.92 68463,-386 68476.17,-383.13 68489.64,-378.94 68502.73,-374.1"/>
<polygon fill="black" stroke="black" points="68504.11,-377.32 68512.19,-370.47 68501.6,-370.79 68504.11,-377.32"/>
</g>
<!-- layer1_gpu9_ln2 -->
<g id="node349" class="node">
<title>layer1_gpu9_ln2</title>
<ellipse fill="none" stroke="black" cx="65269" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="65269" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="65269" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="65269" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_mlp1 -->
<g id="node350" class="node">
<title>layer1_gpu9_mlp1</title>
<polygon fill="none" stroke="black" points="65175,-524 65041,-524 65041,-456 65175,-456 65175,-524"/>
<text text-anchor="middle" x="65108" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="65108" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="65108" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="65108" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_gelu -->
<g id="node351" class="node">
<title>layer1_gpu9_gelu</title>
<ellipse fill="none" stroke="black" cx="64928" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="64928" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="64928" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="64928" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_gpu9_mlp2 -->
<g id="node352" class="node">
<title>layer1_gpu9_mlp2</title>
<polygon fill="none" stroke="black" points="64814.5,-524 64707.5,-524 64707.5,-456 64814.5,-456 64814.5,-524"/>
<text text-anchor="middle" x="64761" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="64761" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="64761" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="64761" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_ln1 -->
<g id="node353" class="node">
<title>layer2_gpu9_ln1</title>
<ellipse fill="none" stroke="black" cx="62928" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="62928" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="62928" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="62928" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_qkv -->
<g id="node354" class="node">
<title>layer2_gpu9_qkv</title>
<polygon fill="none" stroke="black" points="64527,-524 64397,-524 64397,-456 64527,-456 64527,-524"/>
<text text-anchor="middle" x="64462" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="64462" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="64462" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="64462" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_reshape -->
<g id="node355" class="node">
<title>layer2_gpu9_reshape</title>
<ellipse fill="none" stroke="black" cx="64311" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="64311" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="64311" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="64311" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_attn -->
<g id="node356" class="node">
<title>layer2_gpu9_attn</title>
<polygon fill="none" stroke="black" points="64070,-558 63915,-490 64070,-422 64225,-490 64070,-558"/>
<text text-anchor="middle" x="64070" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="64070" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="64070" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="64070" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_out_proj -->
<g id="node357" class="node">
<title>layer2_gpu9_out_proj</title>
<polygon fill="none" stroke="black" points="67916,-524 67772,-524 67772,-456 67916,-456 67916,-524"/>
<text text-anchor="middle" x="67844" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="67844" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="67844" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="67844" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_out_proj&#45;&gt;layer2_concat_group2 -->
<g id="edge55" class="edge">
<title>layer2_gpu9_out_proj&#45;&gt;layer2_concat_group2</title>
<path fill="none" stroke="black" d="M67916.19,-486.5C68077.23,-479.8 68477.39,-456.8 68804,-386 68826.55,-381.11 68850.26,-374.41 68872.75,-367.27"/>
<polygon fill="black" stroke="black" points="68873.87,-370.59 68882.31,-364.19 68871.72,-363.92 68873.87,-370.59"/>
</g>
<!-- layer2_gpu9_ln2 -->
<g id="node358" class="node">
<title>layer2_gpu9_ln2</title>
<ellipse fill="none" stroke="black" cx="63583" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="63583" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="63583" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="63583" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_mlp1 -->
<g id="node359" class="node">
<title>layer2_gpu9_mlp1</title>
<polygon fill="none" stroke="black" points="63489,-524 63355,-524 63355,-456 63489,-456 63489,-524"/>
<text text-anchor="middle" x="63422" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="63422" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="63422" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="63422" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_gelu -->
<g id="node360" class="node">
<title>layer2_gpu9_gelu</title>
<ellipse fill="none" stroke="black" cx="63242" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="63242" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="63242" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="63242" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_gpu9_mlp2 -->
<g id="node361" class="node">
<title>layer2_gpu9_mlp2</title>
<polygon fill="none" stroke="black" points="63128.5,-524 63021.5,-524 63021.5,-456 63128.5,-456 63128.5,-524"/>
<text text-anchor="middle" x="63075" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="63075" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="63075" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="63075" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_ln1 -->
<g id="node362" class="node">
<title>layer3_gpu9_ln1</title>
<ellipse fill="none" stroke="black" cx="67048" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="67048" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="67048" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="67048" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_qkv -->
<g id="node363" class="node">
<title>layer3_gpu9_qkv</title>
<polygon fill="none" stroke="black" points="62834,-524 62704,-524 62704,-456 62834,-456 62834,-524"/>
<text text-anchor="middle" x="62769" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="62769" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="62769" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="62769" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_reshape -->
<g id="node364" class="node">
<title>layer3_gpu9_reshape</title>
<ellipse fill="none" stroke="black" cx="62618" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="62618" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="62618" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="62618" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_attn -->
<g id="node365" class="node">
<title>layer3_gpu9_attn</title>
<polygon fill="none" stroke="black" points="62377,-558 62222,-490 62377,-422 62532,-490 62377,-558"/>
<text text-anchor="middle" x="62377" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="62377" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="62377" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="62377" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_out_proj -->
<g id="node366" class="node">
<title>layer3_gpu9_out_proj</title>
<polygon fill="none" stroke="black" points="65507,-524 65363,-524 65363,-456 65507,-456 65507,-524"/>
<text text-anchor="middle" x="65435" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="65435" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="65435" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="65435" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_out_proj&#45;&gt;layer3_concat_group2 -->
<g id="edge56" class="edge">
<title>layer3_gpu9_out_proj&#45;&gt;layer3_concat_group2</title>
<path fill="none" stroke="black" d="M65464.84,-455.95C65478.91,-442.76 65496.82,-429.05 65516,-422 65655.6,-370.68 68047.62,-417.4 68193,-386 68206.18,-383.15 68219.65,-378.98 68232.74,-374.14"/>
<polygon fill="black" stroke="black" points="68234.11,-377.36 68242.19,-370.51 68231.6,-370.83 68234.11,-377.36"/>
</g>
<!-- layer3_gpu9_ln2 -->
<g id="node367" class="node">
<title>layer3_gpu9_ln2</title>
<ellipse fill="none" stroke="black" cx="61959" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="61959" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="61959" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="61959" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_mlp1 -->
<g id="node368" class="node">
<title>layer3_gpu9_mlp1</title>
<polygon fill="none" stroke="black" points="61865,-524 61731,-524 61731,-456 61865,-456 61865,-524"/>
<text text-anchor="middle" x="61798" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="61798" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="61798" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="61798" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_gelu -->
<g id="node369" class="node">
<title>layer3_gpu9_gelu</title>
<ellipse fill="none" stroke="black" cx="61618" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="61618" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="61618" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="61618" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9_mlp2 -->
<g id="node370" class="node">
<title>layer3_gpu9_mlp2</title>
<polygon fill="none" stroke="black" points="61504.5,-524 61397.5,-524 61397.5,-456 61504.5,-456 61504.5,-524"/>
<text text-anchor="middle" x="61451" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="61451" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="61451" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="61451" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- embed_10 -->
<g id="node371" class="node">
<title>embed_10</title>
<polygon fill="none" stroke="black" points="74843,-516.5 74623,-516.5 74623,-463.5 74843,-463.5 74843,-516.5"/>
<text text-anchor="middle" x="74733" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="74733" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="74733" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu10_ln1 -->
<g id="node372" class="node">
<title>layer0_gpu10_ln1</title>
<ellipse fill="none" stroke="black" cx="74733" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="74733" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="74733" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="74733" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- embed_10&#45;&gt;layer0_gpu10_ln1 -->
<g id="edge11" class="edge">
<title>embed_10&#45;&gt;layer0_gpu10_ln1</title>
<path fill="none" stroke="black" d="M74733,-463.33C74733,-439.41 74733,-403.17 74733,-374.06"/>
<polygon fill="black" stroke="black" points="74736.5,-373.69 74733,-363.69 74729.5,-373.69 74736.5,-373.69"/>
</g>
<!-- layer0_gpu10_qkv -->
<g id="node373" class="node">
<title>layer0_gpu10_qkv</title>
<polygon fill="none" stroke="black" points="75473,-524 75343,-524 75343,-456 75473,-456 75473,-524"/>
<text text-anchor="middle" x="75408" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="75408" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="75408" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="75408" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_reshape -->
<g id="node374" class="node">
<title>layer0_gpu10_reshape</title>
<ellipse fill="none" stroke="black" cx="75257" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="75257" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="75257" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="75257" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_attn -->
<g id="node375" class="node">
<title>layer0_gpu10_attn</title>
<polygon fill="none" stroke="black" points="75016,-558 74861,-490 75016,-422 75171,-490 75016,-558"/>
<text text-anchor="middle" x="75016" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="75016" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="75016" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="75016" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_out_proj -->
<g id="node376" class="node">
<title>layer0_gpu10_out_proj</title>
<polygon fill="none" stroke="black" points="69923,-524 69779,-524 69779,-456 69923,-456 69923,-524"/>
<text text-anchor="middle" x="69851" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="69851" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="69851" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="69851" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_out_proj&#45;&gt;layer0_concat_group2 -->
<g id="edge57" class="edge">
<title>layer0_gpu10_out_proj&#45;&gt;layer0_concat_group2</title>
<path fill="none" stroke="black" d="M69820.75,-455.68C69806.73,-442.61 69788.98,-429.08 69770,-422 69605.78,-360.76 68364.14,-423.81 68193,-386 68179.84,-383.09 68166.37,-378.88 68153.28,-374.03"/>
<polygon fill="black" stroke="black" points="68154.42,-370.71 68143.83,-370.39 68151.91,-377.25 68154.42,-370.71"/>
</g>
<!-- layer0_gpu10_ln2 -->
<g id="node377" class="node">
<title>layer0_gpu10_ln2</title>
<ellipse fill="none" stroke="black" cx="74529" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="74529" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="74529" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="74529" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_mlp1 -->
<g id="node378" class="node">
<title>layer0_gpu10_mlp1</title>
<polygon fill="none" stroke="black" points="74435,-524 74301,-524 74301,-456 74435,-456 74435,-524"/>
<text text-anchor="middle" x="74368" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="74368" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="74368" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="74368" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_gelu -->
<g id="node379" class="node">
<title>layer0_gpu10_gelu</title>
<ellipse fill="none" stroke="black" cx="74188" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="74188" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="74188" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="74188" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer0_gpu10_mlp2 -->
<g id="node380" class="node">
<title>layer0_gpu10_mlp2</title>
<polygon fill="none" stroke="black" points="74074.5,-524 73967.5,-524 73967.5,-456 74074.5,-456 74074.5,-524"/>
<text text-anchor="middle" x="74021" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="74021" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="74021" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="74021" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_ln1 -->
<g id="node381" class="node">
<title>layer1_gpu10_ln1</title>
<ellipse fill="none" stroke="black" cx="72257" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="72257" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="72257" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="72257" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_qkv -->
<g id="node382" class="node">
<title>layer1_gpu10_qkv</title>
<polygon fill="none" stroke="black" points="73787,-524 73657,-524 73657,-456 73787,-456 73787,-524"/>
<text text-anchor="middle" x="73722" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="73722" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="73722" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="73722" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_reshape -->
<g id="node383" class="node">
<title>layer1_gpu10_reshape</title>
<ellipse fill="none" stroke="black" cx="73571" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="73571" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="73571" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="73571" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_attn -->
<g id="node384" class="node">
<title>layer1_gpu10_attn</title>
<polygon fill="none" stroke="black" points="73330,-558 73175,-490 73330,-422 73485,-490 73330,-558"/>
<text text-anchor="middle" x="73330" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="73330" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="73330" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="73330" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_out_proj -->
<g id="node385" class="node">
<title>layer1_gpu10_out_proj</title>
<polygon fill="none" stroke="black" points="71533,-524 71389,-524 71389,-456 71533,-456 71533,-524"/>
<text text-anchor="middle" x="71461" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="71461" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="71461" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="71461" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_out_proj&#45;&gt;layer1_concat_group2 -->
<g id="edge58" class="edge">
<title>layer1_gpu10_out_proj&#45;&gt;layer1_concat_group2</title>
<path fill="none" stroke="black" d="M71431.16,-455.95C71417.09,-442.76 71399.18,-429.05 71380,-422 71242.23,-371.34 68881.68,-416.06 68738,-386 68723.74,-383.02 68709.11,-378.57 68694.94,-373.44"/>
<polygon fill="black" stroke="black" points="68695.8,-370.02 68685.21,-369.78 68693.34,-376.58 68695.8,-370.02"/>
</g>
<!-- layer1_gpu10_ln2 -->
<g id="node386" class="node">
<title>layer1_gpu10_ln2</title>
<ellipse fill="none" stroke="black" cx="72912" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="72912" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="72912" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="72912" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_mlp1 -->
<g id="node387" class="node">
<title>layer1_gpu10_mlp1</title>
<polygon fill="none" stroke="black" points="72818,-524 72684,-524 72684,-456 72818,-456 72818,-524"/>
<text text-anchor="middle" x="72751" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="72751" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="72751" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="72751" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_gelu -->
<g id="node388" class="node">
<title>layer1_gpu10_gelu</title>
<ellipse fill="none" stroke="black" cx="72571" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="72571" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="72571" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="72571" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_gpu10_mlp2 -->
<g id="node389" class="node">
<title>layer1_gpu10_mlp2</title>
<polygon fill="none" stroke="black" points="72457.5,-524 72350.5,-524 72350.5,-456 72457.5,-456 72457.5,-524"/>
<text text-anchor="middle" x="72404" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="72404" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="72404" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="72404" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_ln1 -->
<g id="node390" class="node">
<title>layer2_gpu10_ln1</title>
<ellipse fill="none" stroke="black" cx="73081" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="73081" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="73081" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="73081" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_qkv -->
<g id="node391" class="node">
<title>layer2_gpu10_qkv</title>
<polygon fill="none" stroke="black" points="72163,-524 72033,-524 72033,-456 72163,-456 72163,-524"/>
<text text-anchor="middle" x="72098" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="72098" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="72098" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="72098" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_reshape -->
<g id="node392" class="node">
<title>layer2_gpu10_reshape</title>
<ellipse fill="none" stroke="black" cx="71947" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="71947" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="71947" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="71947" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_attn -->
<g id="node393" class="node">
<title>layer2_gpu10_attn</title>
<polygon fill="none" stroke="black" points="71706,-558 71551,-490 71706,-422 71861,-490 71706,-558"/>
<text text-anchor="middle" x="71706" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="71706" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="71706" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="71706" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_out_proj -->
<g id="node394" class="node">
<title>layer2_gpu10_out_proj</title>
<polygon fill="none" stroke="black" points="73949,-524 73805,-524 73805,-456 73949,-456 73949,-524"/>
<text text-anchor="middle" x="73877" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="73877" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="73877" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="73877" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_out_proj&#45;&gt;layer2_concat_group2 -->
<g id="edge59" class="edge">
<title>layer2_gpu10_out_proj&#45;&gt;layer2_concat_group2</title>
<path fill="none" stroke="black" d="M73847.18,-455.89C73833.11,-442.7 73815.2,-429 73796,-422 73673.75,-377.46 69239.07,-414 69112,-386 69099.87,-383.33 69087.51,-379.44 69075.47,-374.92"/>
<polygon fill="black" stroke="black" points="69076.49,-371.56 69065.9,-371.17 69073.93,-378.07 69076.49,-371.56"/>
</g>
<!-- layer2_gpu10_ln2 -->
<g id="node395" class="node">
<title>layer2_gpu10_ln2</title>
<ellipse fill="none" stroke="black" cx="71295" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="71295" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="71295" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="71295" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_mlp1 -->
<g id="node396" class="node">
<title>layer2_gpu10_mlp1</title>
<polygon fill="none" stroke="black" points="71201,-524 71067,-524 71067,-456 71201,-456 71201,-524"/>
<text text-anchor="middle" x="71134" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="71134" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="71134" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="71134" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_gelu -->
<g id="node397" class="node">
<title>layer2_gpu10_gelu</title>
<ellipse fill="none" stroke="black" cx="70954" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="70954" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="70954" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="70954" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_gpu10_mlp2 -->
<g id="node398" class="node">
<title>layer2_gpu10_mlp2</title>
<polygon fill="none" stroke="black" points="70840.5,-524 70733.5,-524 70733.5,-456 70840.5,-456 70840.5,-524"/>
<text text-anchor="middle" x="70787" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="70787" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="70787" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="70787" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_ln1 -->
<g id="node399" class="node">
<title>layer3_gpu10_ln1</title>
<ellipse fill="none" stroke="black" cx="75567" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="75567" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="75567" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="75567" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_qkv -->
<g id="node400" class="node">
<title>layer3_gpu10_qkv</title>
<polygon fill="none" stroke="black" points="70553,-524 70423,-524 70423,-456 70553,-456 70553,-524"/>
<text text-anchor="middle" x="70488" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="70488" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="70488" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="70488" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_reshape -->
<g id="node401" class="node">
<title>layer3_gpu10_reshape</title>
<ellipse fill="none" stroke="black" cx="70337" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="70337" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="70337" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="70337" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_attn -->
<g id="node402" class="node">
<title>layer3_gpu10_attn</title>
<polygon fill="none" stroke="black" points="70096,-558 69941,-490 70096,-422 70251,-490 70096,-558"/>
<text text-anchor="middle" x="70096" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="70096" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="70096" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="70096" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_out_proj -->
<g id="node403" class="node">
<title>layer3_gpu10_out_proj</title>
<polygon fill="none" stroke="black" points="70715,-524 70571,-524 70571,-456 70715,-456 70715,-524"/>
<text text-anchor="middle" x="70643" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="70643" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="70643" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="70643" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_out_proj&#45;&gt;layer3_concat_group2 -->
<g id="edge60" class="edge">
<title>layer3_gpu10_out_proj&#45;&gt;layer3_concat_group2</title>
<path fill="none" stroke="black" d="M70613.14,-455.98C70599.07,-442.8 70581.17,-429.09 70562,-422 70343.22,-341.12 68690.91,-435.67 68463,-386 68449.83,-383.13 68436.36,-378.94 68423.27,-374.1"/>
<polygon fill="black" stroke="black" points="68424.41,-370.78 68413.82,-370.46 68421.89,-377.32 68424.41,-370.78"/>
</g>
<!-- layer3_gpu10_ln2 -->
<g id="node404" class="node">
<title>layer3_gpu10_ln2</title>
<ellipse fill="none" stroke="black" cx="69685" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="69685" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="69685" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="69685" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_mlp1 -->
<g id="node405" class="node">
<title>layer3_gpu10_mlp1</title>
<polygon fill="none" stroke="black" points="69591,-524 69457,-524 69457,-456 69591,-456 69591,-524"/>
<text text-anchor="middle" x="69524" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="69524" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="69524" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="69524" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_gelu -->
<g id="node406" class="node">
<title>layer3_gpu10_gelu</title>
<ellipse fill="none" stroke="black" cx="69344" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="69344" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="69344" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="69344" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10_mlp2 -->
<g id="node407" class="node">
<title>layer3_gpu10_mlp2</title>
<polygon fill="none" stroke="black" points="69230.5,-524 69123.5,-524 69123.5,-456 69230.5,-456 69230.5,-524"/>
<text text-anchor="middle" x="69177" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="69177" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="69177" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="69177" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- embed_11 -->
<g id="node408" class="node">
<title>embed_11</title>
<polygon fill="none" stroke="black" points="81452,-516.5 81232,-516.5 81232,-463.5 81452,-463.5 81452,-516.5"/>
<text text-anchor="middle" x="81342" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="81342" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="81342" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu11_ln1 -->
<g id="node409" class="node">
<title>layer0_gpu11_ln1</title>
<ellipse fill="none" stroke="black" cx="81342" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="81342" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="81342" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="81342" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- embed_11&#45;&gt;layer0_gpu11_ln1 -->
<g id="edge12" class="edge">
<title>embed_11&#45;&gt;layer0_gpu11_ln1</title>
<path fill="none" stroke="black" d="M81342,-463.33C81342,-439.41 81342,-403.17 81342,-374.06"/>
<polygon fill="black" stroke="black" points="81345.5,-373.69 81342,-363.69 81338.5,-373.69 81345.5,-373.69"/>
</g>
<!-- layer0_gpu11_qkv -->
<g id="node410" class="node">
<title>layer0_gpu11_qkv</title>
<polygon fill="none" stroke="black" points="82082,-524 81952,-524 81952,-456 82082,-456 82082,-524"/>
<text text-anchor="middle" x="82017" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="82017" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="82017" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="82017" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_reshape -->
<g id="node411" class="node">
<title>layer0_gpu11_reshape</title>
<ellipse fill="none" stroke="black" cx="81866" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="81866" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="81866" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="81866" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_attn -->
<g id="node412" class="node">
<title>layer0_gpu11_attn</title>
<polygon fill="none" stroke="black" points="81625,-558 81470,-490 81625,-422 81780,-490 81625,-558"/>
<text text-anchor="middle" x="81625" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="81625" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="81625" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="81625" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_out_proj -->
<g id="node413" class="node">
<title>layer0_gpu11_out_proj</title>
<polygon fill="none" stroke="black" points="76532,-524 76388,-524 76388,-456 76532,-456 76532,-524"/>
<text text-anchor="middle" x="76460" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="76460" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="76460" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="76460" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_out_proj&#45;&gt;layer0_concat_group2 -->
<g id="edge61" class="edge">
<title>layer0_gpu11_out_proj&#45;&gt;layer0_concat_group2</title>
<path fill="none" stroke="black" d="M76430.19,-455.86C76416.12,-442.66 76398.22,-428.97 76379,-422 76165.22,-344.51 68415.48,-433 68193,-386 68179.71,-383.19 68166.12,-379.01 68152.93,-374.14"/>
<polygon fill="black" stroke="black" points="68154,-370.81 68143.41,-370.49 68151.5,-377.34 68154,-370.81"/>
</g>
<!-- layer0_gpu11_ln2 -->
<g id="node414" class="node">
<title>layer0_gpu11_ln2</title>
<ellipse fill="none" stroke="black" cx="81138" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="81138" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="81138" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="81138" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_mlp1 -->
<g id="node415" class="node">
<title>layer0_gpu11_mlp1</title>
<polygon fill="none" stroke="black" points="81044,-524 80910,-524 80910,-456 81044,-456 81044,-524"/>
<text text-anchor="middle" x="80977" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="80977" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="80977" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="80977" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_gelu -->
<g id="node416" class="node">
<title>layer0_gpu11_gelu</title>
<ellipse fill="none" stroke="black" cx="80797" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="80797" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="80797" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="80797" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer0_gpu11_mlp2 -->
<g id="node417" class="node">
<title>layer0_gpu11_mlp2</title>
<polygon fill="none" stroke="black" points="80683.5,-524 80576.5,-524 80576.5,-456 80683.5,-456 80683.5,-524"/>
<text text-anchor="middle" x="80630" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="80630" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="80630" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="80630" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_ln1 -->
<g id="node418" class="node">
<title>layer1_gpu11_ln1</title>
<ellipse fill="none" stroke="black" cx="79683" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="79683" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="79683" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="79683" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_qkv -->
<g id="node419" class="node">
<title>layer1_gpu11_qkv</title>
<polygon fill="none" stroke="black" points="80389,-524 80259,-524 80259,-456 80389,-456 80389,-524"/>
<text text-anchor="middle" x="80324" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="80324" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="80324" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="80324" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_reshape -->
<g id="node420" class="node">
<title>layer1_gpu11_reshape</title>
<ellipse fill="none" stroke="black" cx="80173" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="80173" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="80173" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="80173" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_attn -->
<g id="node421" class="node">
<title>layer1_gpu11_attn</title>
<polygon fill="none" stroke="black" points="79932,-558 79777,-490 79932,-422 80087,-490 79932,-558"/>
<text text-anchor="middle" x="79932" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="79932" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="79932" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="79932" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_out_proj -->
<g id="node422" class="node">
<title>layer1_gpu11_out_proj</title>
<polygon fill="none" stroke="black" points="78142,-524 77998,-524 77998,-456 78142,-456 78142,-524"/>
<text text-anchor="middle" x="78070" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="78070" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="78070" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="78070" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_out_proj&#45;&gt;layer1_concat_group2 -->
<g id="edge62" class="edge">
<title>layer1_gpu11_out_proj&#45;&gt;layer1_concat_group2</title>
<path fill="none" stroke="black" d="M78040.19,-455.86C78026.12,-442.66 78008.22,-428.96 77989,-422 77869.62,-378.76 68973.09,-400.99 68847,-386 68804.61,-380.96 68758.97,-371.4 68718.49,-361.41"/>
<polygon fill="black" stroke="black" points="68719.13,-357.96 68708.58,-358.93 68717.43,-364.75 68719.13,-357.96"/>
</g>
<!-- layer1_gpu11_ln2 -->
<g id="node423" class="node">
<title>layer1_gpu11_ln2</title>
<ellipse fill="none" stroke="black" cx="79514" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="79514" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="79514" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="79514" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_mlp1 -->
<g id="node424" class="node">
<title>layer1_gpu11_mlp1</title>
<polygon fill="none" stroke="black" points="79420,-524 79286,-524 79286,-456 79420,-456 79420,-524"/>
<text text-anchor="middle" x="79353" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="79353" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="79353" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="79353" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_gelu -->
<g id="node425" class="node">
<title>layer1_gpu11_gelu</title>
<ellipse fill="none" stroke="black" cx="79173" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="79173" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="79173" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="79173" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_gpu11_mlp2 -->
<g id="node426" class="node">
<title>layer1_gpu11_mlp2</title>
<polygon fill="none" stroke="black" points="79059.5,-524 78952.5,-524 78952.5,-456 79059.5,-456 79059.5,-524"/>
<text text-anchor="middle" x="79006" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="79006" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="79006" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="79006" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_ln1 -->
<g id="node427" class="node">
<title>layer2_gpu11_ln1</title>
<ellipse fill="none" stroke="black" cx="80483" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="80483" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="80483" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="80483" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_qkv -->
<g id="node428" class="node">
<title>layer2_gpu11_qkv</title>
<polygon fill="none" stroke="black" points="78772,-524 78642,-524 78642,-456 78772,-456 78772,-524"/>
<text text-anchor="middle" x="78707" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="78707" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="78707" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="78707" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_reshape -->
<g id="node429" class="node">
<title>layer2_gpu11_reshape</title>
<ellipse fill="none" stroke="black" cx="78556" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="78556" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="78556" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="78556" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_attn -->
<g id="node430" class="node">
<title>layer2_gpu11_attn</title>
<polygon fill="none" stroke="black" points="78315,-558 78160,-490 78315,-422 78470,-490 78315,-558"/>
<text text-anchor="middle" x="78315" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="78315" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="78315" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="78315" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_out_proj -->
<g id="node431" class="node">
<title>layer2_gpu11_out_proj</title>
<polygon fill="none" stroke="black" points="78934,-524 78790,-524 78790,-456 78934,-456 78934,-524"/>
<text text-anchor="middle" x="78862" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="78862" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="78862" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="78862" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_out_proj&#45;&gt;layer2_concat_group2 -->
<g id="edge63" class="edge">
<title>layer2_gpu11_out_proj&#45;&gt;layer2_concat_group2</title>
<path fill="none" stroke="black" d="M78832.19,-455.86C78818.12,-442.65 78800.22,-428.96 78781,-422 78654.73,-376.28 69243.2,-414.64 69112,-386 69099.87,-383.35 69087.5,-379.48 69075.46,-374.97"/>
<polygon fill="black" stroke="black" points="69076.48,-371.6 69065.89,-371.22 69073.93,-378.12 69076.48,-371.6"/>
</g>
<!-- layer2_gpu11_ln2 -->
<g id="node432" class="node">
<title>layer2_gpu11_ln2</title>
<ellipse fill="none" stroke="black" cx="77904" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="77904" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="77904" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="77904" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_mlp1 -->
<g id="node433" class="node">
<title>layer2_gpu11_mlp1</title>
<polygon fill="none" stroke="black" points="77810,-524 77676,-524 77676,-456 77810,-456 77810,-524"/>
<text text-anchor="middle" x="77743" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="77743" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="77743" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="77743" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_gelu -->
<g id="node434" class="node">
<title>layer2_gpu11_gelu</title>
<ellipse fill="none" stroke="black" cx="77563" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="77563" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="77563" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="77563" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_gpu11_mlp2 -->
<g id="node435" class="node">
<title>layer2_gpu11_mlp2</title>
<polygon fill="none" stroke="black" points="77449.5,-524 77342.5,-524 77342.5,-456 77449.5,-456 77449.5,-524"/>
<text text-anchor="middle" x="77396" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="77396" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="77396" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="77396" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_ln1 -->
<g id="node436" class="node">
<title>layer3_gpu11_ln1</title>
<ellipse fill="none" stroke="black" cx="82176" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="82176" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="82176" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="82176" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_qkv -->
<g id="node437" class="node">
<title>layer3_gpu11_qkv</title>
<polygon fill="none" stroke="black" points="77162,-524 77032,-524 77032,-456 77162,-456 77162,-524"/>
<text text-anchor="middle" x="77097" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="77097" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="77097" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="77097" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_reshape -->
<g id="node438" class="node">
<title>layer3_gpu11_reshape</title>
<ellipse fill="none" stroke="black" cx="76946" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="76946" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="76946" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="76946" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_attn -->
<g id="node439" class="node">
<title>layer3_gpu11_attn</title>
<polygon fill="none" stroke="black" points="76705,-558 76550,-490 76705,-422 76860,-490 76705,-558"/>
<text text-anchor="middle" x="76705" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="76705" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="76705" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="76705" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_out_proj -->
<g id="node440" class="node">
<title>layer3_gpu11_out_proj</title>
<polygon fill="none" stroke="black" points="77324,-524 77180,-524 77180,-456 77324,-456 77324,-524"/>
<text text-anchor="middle" x="77252" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="77252" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="77252" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="77252" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_out_proj&#45;&gt;layer3_concat_group2 -->
<g id="edge64" class="edge">
<title>layer3_gpu11_out_proj&#45;&gt;layer3_concat_group2</title>
<path fill="none" stroke="black" d="M77222.19,-455.86C77208.12,-442.66 77190.22,-428.96 77171,-422 76943.58,-339.6 68699.67,-435.97 68463,-386 68449.71,-383.19 68436.12,-379.01 68422.93,-374.15"/>
<polygon fill="black" stroke="black" points="68424,-370.81 68413.41,-370.49 68421.49,-377.34 68424,-370.81"/>
</g>
<!-- layer3_gpu11_ln2 -->
<g id="node441" class="node">
<title>layer3_gpu11_ln2</title>
<ellipse fill="none" stroke="black" cx="76294" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="76294" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="76294" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="76294" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_mlp1 -->
<g id="node442" class="node">
<title>layer3_gpu11_mlp1</title>
<polygon fill="none" stroke="black" points="76200,-524 76066,-524 76066,-456 76200,-456 76200,-524"/>
<text text-anchor="middle" x="76133" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="76133" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="76133" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="76133" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_gelu -->
<g id="node443" class="node">
<title>layer3_gpu11_gelu</title>
<ellipse fill="none" stroke="black" cx="75953" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="75953" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="75953" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="75953" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11_mlp2 -->
<g id="node444" class="node">
<title>layer3_gpu11_mlp2</title>
<polygon fill="none" stroke="black" points="75839.5,-524 75732.5,-524 75732.5,-456 75839.5,-456 75839.5,-524"/>
<text text-anchor="middle" x="75786" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="75786" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="75786" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="75786" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- embed_12 -->
<g id="node445" class="node">
<title>embed_12</title>
<polygon fill="none" stroke="black" points="84841,-516.5 84621,-516.5 84621,-463.5 84841,-463.5 84841,-516.5"/>
<text text-anchor="middle" x="84731" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="84731" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="84731" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu12_ln1 -->
<g id="node446" class="node">
<title>layer0_gpu12_ln1</title>
<ellipse fill="none" stroke="black" cx="84731" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="84731" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="84731" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="84731" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- embed_12&#45;&gt;layer0_gpu12_ln1 -->
<g id="edge13" class="edge">
<title>embed_12&#45;&gt;layer0_gpu12_ln1</title>
<path fill="none" stroke="black" d="M84731,-463.33C84731,-439.41 84731,-403.17 84731,-374.06"/>
<polygon fill="black" stroke="black" points="84734.5,-373.69 84731,-363.69 84727.5,-373.69 84734.5,-373.69"/>
</g>
<!-- layer0_gpu12_qkv -->
<g id="node447" class="node">
<title>layer0_gpu12_qkv</title>
<polygon fill="none" stroke="black" points="88698,-524 88568,-524 88568,-456 88698,-456 88698,-524"/>
<text text-anchor="middle" x="88633" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="88633" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="88633" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="88633" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_reshape -->
<g id="node448" class="node">
<title>layer0_gpu12_reshape</title>
<ellipse fill="none" stroke="black" cx="88482" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="88482" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="88482" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="88482" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_attn -->
<g id="node449" class="node">
<title>layer0_gpu12_attn</title>
<polygon fill="none" stroke="black" points="88241,-558 88086,-490 88241,-422 88396,-490 88241,-558"/>
<text text-anchor="middle" x="88241" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="88241" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="88241" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="88241" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_out_proj -->
<g id="node450" class="node">
<title>layer0_gpu12_out_proj</title>
<polygon fill="none" stroke="black" points="86458,-524 86314,-524 86314,-456 86458,-456 86458,-524"/>
<text text-anchor="middle" x="86386" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="86386" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="86386" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="86386" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_concat_group3 -->
<g id="node605" class="node">
<title>layer0_concat_group3</title>
<polygon fill="yellow" stroke="black" points="95732,-302.8 95732,-349.2 95660.53,-382 95559.47,-382 95488,-349.2 95488,-302.8 95559.47,-270 95660.53,-270 95732,-302.8"/>
<polygon fill="none" stroke="black" points="95736,-300.24 95736,-351.76 95661.41,-386 95558.59,-386 95484,-351.76 95484,-300.24 95558.59,-266 95661.41,-266 95736,-300.24"/>
<text text-anchor="middle" x="95610" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="95610" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="95610" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="95610" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- layer0_gpu12_out_proj&#45;&gt;layer0_concat_group3 -->
<g id="edge65" class="edge">
<title>layer0_gpu12_out_proj&#45;&gt;layer0_concat_group3</title>
<path fill="none" stroke="black" d="M86415.81,-455.86C86429.88,-442.66 86447.78,-428.96 86467,-422 86702.39,-336.73 95235.4,-439.42 95480,-386 95492.13,-383.35 95504.5,-379.48 95516.54,-374.96"/>
<polygon fill="black" stroke="black" points="95518.07,-378.12 95526.11,-371.21 95515.52,-371.6 95518.07,-378.12"/>
</g>
<!-- layer0_gpu12_ln2 -->
<g id="node451" class="node">
<title>layer0_gpu12_ln2</title>
<ellipse fill="none" stroke="black" cx="87830" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="87830" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="87830" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="87830" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_mlp1 -->
<g id="node452" class="node">
<title>layer0_gpu12_mlp1</title>
<polygon fill="none" stroke="black" points="87736,-524 87602,-524 87602,-456 87736,-456 87736,-524"/>
<text text-anchor="middle" x="87669" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="87669" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="87669" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="87669" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_gelu -->
<g id="node453" class="node">
<title>layer0_gpu12_gelu</title>
<ellipse fill="none" stroke="black" cx="87489" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="87489" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="87489" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="87489" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer0_gpu12_mlp2 -->
<g id="node454" class="node">
<title>layer0_gpu12_mlp2</title>
<polygon fill="none" stroke="black" points="87375.5,-524 87268.5,-524 87268.5,-456 87375.5,-456 87375.5,-524"/>
<text text-anchor="middle" x="87322" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="87322" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="87322" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="87322" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_ln1 -->
<g id="node455" class="node">
<title>layer1_gpu12_ln1</title>
<ellipse fill="none" stroke="black" cx="83072" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="83072" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="83072" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="83072" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_qkv -->
<g id="node456" class="node">
<title>layer1_gpu12_qkv</title>
<polygon fill="none" stroke="black" points="87088,-524 86958,-524 86958,-456 87088,-456 87088,-524"/>
<text text-anchor="middle" x="87023" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="87023" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="87023" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="87023" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_reshape -->
<g id="node457" class="node">
<title>layer1_gpu12_reshape</title>
<ellipse fill="none" stroke="black" cx="86872" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="86872" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="86872" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="86872" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_attn -->
<g id="node458" class="node">
<title>layer1_gpu12_attn</title>
<polygon fill="none" stroke="black" points="86631,-558 86476,-490 86631,-422 86786,-490 86631,-558"/>
<text text-anchor="middle" x="86631" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="86631" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="86631" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="86631" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_out_proj -->
<g id="node459" class="node">
<title>layer1_gpu12_out_proj</title>
<polygon fill="none" stroke="black" points="88068,-524 87924,-524 87924,-456 88068,-456 88068,-524"/>
<text text-anchor="middle" x="87996" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="87996" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="87996" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="87996" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_concat_group3 -->
<g id="node606" class="node">
<title>layer1_concat_group3</title>
<polygon fill="yellow" stroke="black" points="96272,-302.8 96272,-349.2 96200.53,-382 96099.47,-382 96028,-349.2 96028,-302.8 96099.47,-270 96200.53,-270 96272,-302.8"/>
<polygon fill="none" stroke="black" points="96276,-300.24 96276,-351.76 96201.41,-386 96098.59,-386 96024,-351.76 96024,-300.24 96098.59,-266 96201.41,-266 96276,-300.24"/>
<text text-anchor="middle" x="96150" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="96150" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="96150" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="96150" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- layer1_gpu12_out_proj&#45;&gt;layer1_concat_group3 -->
<g id="edge66" class="edge">
<title>layer1_gpu12_out_proj&#45;&gt;layer1_concat_group3</title>
<path fill="none" stroke="black" d="M88025.81,-455.86C88039.88,-442.66 88057.78,-428.97 88077,-422 88284.3,-346.84 95799.26,-431.59 96015,-386 96028.29,-383.19 96041.88,-379.01 96055.06,-374.14"/>
<polygon fill="black" stroke="black" points="96056.5,-377.34 96064.59,-370.49 96054,-370.8 96056.5,-377.34"/>
</g>
<!-- layer1_gpu12_ln2 -->
<g id="node460" class="node">
<title>layer1_gpu12_ln2</title>
<ellipse fill="none" stroke="black" cx="86220" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="86220" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="86220" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="86220" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_mlp1 -->
<g id="node461" class="node">
<title>layer1_gpu12_mlp1</title>
<polygon fill="none" stroke="black" points="86126,-524 85992,-524 85992,-456 86126,-456 86126,-524"/>
<text text-anchor="middle" x="86059" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="86059" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="86059" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="86059" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_gelu -->
<g id="node462" class="node">
<title>layer1_gpu12_gelu</title>
<ellipse fill="none" stroke="black" cx="85879" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="85879" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="85879" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="85879" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_gpu12_mlp2 -->
<g id="node463" class="node">
<title>layer1_gpu12_mlp2</title>
<polygon fill="none" stroke="black" points="85765.5,-524 85658.5,-524 85658.5,-456 85765.5,-456 85765.5,-524"/>
<text text-anchor="middle" x="85712" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="85712" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="85712" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="85712" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_ln1 -->
<g id="node464" class="node">
<title>layer2_gpu12_ln1</title>
<ellipse fill="none" stroke="black" cx="83872" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="83872" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="83872" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="83872" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_qkv -->
<g id="node465" class="node">
<title>layer2_gpu12_qkv</title>
<polygon fill="none" stroke="black" points="85471,-524 85341,-524 85341,-456 85471,-456 85471,-524"/>
<text text-anchor="middle" x="85406" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="85406" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="85406" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="85406" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_reshape -->
<g id="node466" class="node">
<title>layer2_gpu12_reshape</title>
<ellipse fill="none" stroke="black" cx="85255" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="85255" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="85255" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="85255" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_attn -->
<g id="node467" class="node">
<title>layer2_gpu12_attn</title>
<polygon fill="none" stroke="black" points="85014,-558 84859,-490 85014,-422 85169,-490 85014,-558"/>
<text text-anchor="middle" x="85014" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="85014" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="85014" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="85014" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_out_proj -->
<g id="node468" class="node">
<title>layer2_gpu12_out_proj</title>
<polygon fill="none" stroke="black" points="88860,-524 88716,-524 88716,-456 88860,-456 88860,-524"/>
<text text-anchor="middle" x="88788" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="88788" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="88788" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="88788" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_concat_group3 -->
<g id="node607" class="node">
<title>layer2_concat_group3</title>
<polygon fill="yellow" stroke="black" points="96656,-302.8 96656,-349.2 96584.53,-382 96483.47,-382 96412,-349.2 96412,-302.8 96483.47,-270 96584.53,-270 96656,-302.8"/>
<polygon fill="none" stroke="black" points="96660,-300.24 96660,-351.76 96585.41,-386 96482.59,-386 96408,-351.76 96408,-300.24 96482.59,-266 96585.41,-266 96660,-300.24"/>
<text text-anchor="middle" x="96534" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="96534" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="96534" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="96534" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- layer2_gpu12_out_proj&#45;&gt;layer2_concat_group3 -->
<g id="edge67" class="edge">
<title>layer2_gpu12_out_proj&#45;&gt;layer2_concat_group3</title>
<path fill="none" stroke="black" d="M88846.99,-455.82C88873.87,-442.53 88906.64,-428.77 88938,-422 89137.5,-378.96 96082.35,-410.18 96285,-386 96327.38,-380.94 96373.03,-371.37 96413.51,-361.39"/>
<polygon fill="black" stroke="black" points="96414.56,-364.73 96423.42,-358.91 96412.87,-357.94 96414.56,-364.73"/>
</g>
<!-- layer2_gpu12_ln2 -->
<g id="node469" class="node">
<title>layer2_gpu12_ln2</title>
<ellipse fill="none" stroke="black" cx="84527" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="84527" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="84527" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="84527" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_mlp1 -->
<g id="node470" class="node">
<title>layer2_gpu12_mlp1</title>
<polygon fill="none" stroke="black" points="84433,-524 84299,-524 84299,-456 84433,-456 84433,-524"/>
<text text-anchor="middle" x="84366" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="84366" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="84366" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="84366" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_gelu -->
<g id="node471" class="node">
<title>layer2_gpu12_gelu</title>
<ellipse fill="none" stroke="black" cx="84186" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="84186" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="84186" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="84186" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_gpu12_mlp2 -->
<g id="node472" class="node">
<title>layer2_gpu12_mlp2</title>
<polygon fill="none" stroke="black" points="84072.5,-524 83965.5,-524 83965.5,-456 84072.5,-456 84072.5,-524"/>
<text text-anchor="middle" x="84019" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="84019" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="84019" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="84019" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_ln1 -->
<g id="node473" class="node">
<title>layer3_gpu12_ln1</title>
<ellipse fill="none" stroke="black" cx="85565" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="85565" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="85565" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="85565" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_qkv -->
<g id="node474" class="node">
<title>layer3_gpu12_qkv</title>
<polygon fill="none" stroke="black" points="83778,-524 83648,-524 83648,-456 83778,-456 83778,-524"/>
<text text-anchor="middle" x="83713" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="83713" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="83713" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="83713" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_reshape -->
<g id="node475" class="node">
<title>layer3_gpu12_reshape</title>
<ellipse fill="none" stroke="black" cx="83562" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="83562" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="83562" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="83562" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_attn -->
<g id="node476" class="node">
<title>layer3_gpu12_attn</title>
<polygon fill="none" stroke="black" points="83321,-558 83166,-490 83321,-422 83476,-490 83321,-558"/>
<text text-anchor="middle" x="83321" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="83321" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="83321" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="83321" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_out_proj -->
<g id="node477" class="node">
<title>layer3_gpu12_out_proj</title>
<polygon fill="none" stroke="black" points="87250,-524 87106,-524 87106,-456 87250,-456 87250,-524"/>
<text text-anchor="middle" x="87178" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="87178" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="87178" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="87178" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_concat_group3 -->
<g id="node608" class="node">
<title>layer3_concat_group3</title>
<polygon fill="yellow" stroke="black" points="96002,-302.8 96002,-349.2 95930.53,-382 95829.47,-382 95758,-349.2 95758,-302.8 95829.47,-270 95930.53,-270 96002,-302.8"/>
<polygon fill="none" stroke="black" points="96006,-300.24 96006,-351.76 95931.41,-386 95828.59,-386 95754,-351.76 95754,-300.24 95828.59,-266 95931.41,-266 96006,-300.24"/>
<text text-anchor="middle" x="95880" y="-344.8" font-family="Times,serif" font-size="14.00">Concat Dimensions</text>
<text text-anchor="middle" x="95880" y="-329.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="95880" y="-314.8" font-family="Times,serif" font-size="14.00">[B,L,4,512]</text>
<text text-anchor="middle" x="95880" y="-299.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- layer3_gpu12_out_proj&#45;&gt;layer3_concat_group3 -->
<g id="edge68" class="edge">
<title>layer3_gpu12_out_proj&#45;&gt;layer3_concat_group3</title>
<path fill="none" stroke="black" d="M87208.25,-455.85C87222.5,-442.65 87240.62,-428.96 87260,-422 87481.84,-342.36 95514.39,-434.7 95745,-386 95758.29,-383.19 95771.88,-379.01 95785.07,-374.15"/>
<polygon fill="black" stroke="black" points="95786.5,-377.34 95794.59,-370.49 95784,-370.81 95786.5,-377.34"/>
</g>
<!-- layer3_gpu12_ln2 -->
<g id="node478" class="node">
<title>layer3_gpu12_ln2</title>
<ellipse fill="none" stroke="black" cx="82903" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="82903" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="82903" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="82903" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_mlp1 -->
<g id="node479" class="node">
<title>layer3_gpu12_mlp1</title>
<polygon fill="none" stroke="black" points="82809,-524 82675,-524 82675,-456 82809,-456 82809,-524"/>
<text text-anchor="middle" x="82742" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="82742" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="82742" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="82742" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_gelu -->
<g id="node480" class="node">
<title>layer3_gpu12_gelu</title>
<ellipse fill="none" stroke="black" cx="82562" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="82562" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="82562" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="82562" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_gpu12_mlp2 -->
<g id="node481" class="node">
<title>layer3_gpu12_mlp2</title>
<polygon fill="none" stroke="black" points="82448.5,-524 82341.5,-524 82341.5,-456 82448.5,-456 82448.5,-524"/>
<text text-anchor="middle" x="82395" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="82395" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="82395" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="82395" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- embed_13 -->
<g id="node482" class="node">
<title>embed_13</title>
<polygon fill="none" stroke="black" points="91449,-516.5 91229,-516.5 91229,-463.5 91449,-463.5 91449,-516.5"/>
<text text-anchor="middle" x="91339" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="91339" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="91339" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu13_ln1 -->
<g id="node483" class="node">
<title>layer0_gpu13_ln1</title>
<ellipse fill="none" stroke="black" cx="91339" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="91339" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="91339" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="91339" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- embed_13&#45;&gt;layer0_gpu13_ln1 -->
<g id="edge14" class="edge">
<title>embed_13&#45;&gt;layer0_gpu13_ln1</title>
<path fill="none" stroke="black" d="M91339,-463.33C91339,-439.41 91339,-403.17 91339,-374.06"/>
<polygon fill="black" stroke="black" points="91342.5,-373.69 91339,-363.69 91335.5,-373.69 91342.5,-373.69"/>
</g>
<!-- layer0_gpu13_qkv -->
<g id="node484" class="node">
<title>layer0_gpu13_qkv</title>
<polygon fill="none" stroke="black" points="95306,-524 95176,-524 95176,-456 95306,-456 95306,-524"/>
<text text-anchor="middle" x="95241" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="95241" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="95241" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="95241" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_reshape -->
<g id="node485" class="node">
<title>layer0_gpu13_reshape</title>
<ellipse fill="none" stroke="black" cx="95090" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="95090" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="95090" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="95090" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_attn -->
<g id="node486" class="node">
<title>layer0_gpu13_attn</title>
<polygon fill="none" stroke="black" points="94849,-558 94694,-490 94849,-422 95004,-490 94849,-558"/>
<text text-anchor="middle" x="94849" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="94849" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="94849" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="94849" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_out_proj -->
<g id="node487" class="node">
<title>layer0_gpu13_out_proj</title>
<polygon fill="none" stroke="black" points="92241,-524 92097,-524 92097,-456 92241,-456 92241,-524"/>
<text text-anchor="middle" x="92169" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="92169" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="92169" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="92169" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_out_proj&#45;&gt;layer0_concat_group3 -->
<g id="edge69" class="edge">
<title>layer0_gpu13_out_proj&#45;&gt;layer0_concat_group3</title>
<path fill="none" stroke="black" d="M92199.28,-455.92C92213.53,-442.73 92231.64,-429.02 92251,-422 92419.64,-360.8 95304.87,-424.9 95480,-386 95492.12,-383.31 95504.48,-379.41 95516.52,-374.88"/>
<polygon fill="black" stroke="black" points="95518.06,-378.03 95526.09,-371.12 95515.5,-371.52 95518.06,-378.03"/>
</g>
<!-- layer0_gpu13_ln2 -->
<g id="node488" class="node">
<title>layer0_gpu13_ln2</title>
<ellipse fill="none" stroke="black" cx="94431" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="94431" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="94431" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="94431" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_mlp1 -->
<g id="node489" class="node">
<title>layer0_gpu13_mlp1</title>
<polygon fill="none" stroke="black" points="94337,-524 94203,-524 94203,-456 94337,-456 94337,-524"/>
<text text-anchor="middle" x="94270" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="94270" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="94270" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="94270" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_gelu -->
<g id="node490" class="node">
<title>layer0_gpu13_gelu</title>
<ellipse fill="none" stroke="black" cx="94090" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="94090" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="94090" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="94090" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer0_gpu13_mlp2 -->
<g id="node491" class="node">
<title>layer0_gpu13_mlp2</title>
<polygon fill="none" stroke="black" points="93976.5,-524 93869.5,-524 93869.5,-456 93976.5,-456 93976.5,-524"/>
<text text-anchor="middle" x="93923" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="93923" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="93923" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="93923" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_ln1 -->
<g id="node492" class="node">
<title>layer1_gpu13_ln1</title>
<ellipse fill="none" stroke="black" cx="89680" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="89680" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="89680" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="89680" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_qkv -->
<g id="node493" class="node">
<title>layer1_gpu13_qkv</title>
<polygon fill="none" stroke="black" points="93689,-524 93559,-524 93559,-456 93689,-456 93689,-524"/>
<text text-anchor="middle" x="93624" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="93624" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="93624" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="93624" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_reshape -->
<g id="node494" class="node">
<title>layer1_gpu13_reshape</title>
<ellipse fill="none" stroke="black" cx="93473" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="93473" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="93473" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="93473" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_attn -->
<g id="node495" class="node">
<title>layer1_gpu13_attn</title>
<polygon fill="none" stroke="black" points="93232,-558 93077,-490 93232,-422 93387,-490 93232,-558"/>
<text text-anchor="middle" x="93232" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="93232" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="93232" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="93232" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_out_proj -->
<g id="node496" class="node">
<title>layer1_gpu13_out_proj</title>
<polygon fill="none" stroke="black" points="93851,-524 93707,-524 93707,-456 93851,-456 93851,-524"/>
<text text-anchor="middle" x="93779" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="93779" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="93779" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="93779" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_out_proj&#45;&gt;layer1_concat_group3 -->
<g id="edge70" class="edge">
<title>layer1_gpu13_out_proj&#45;&gt;layer1_concat_group3</title>
<path fill="none" stroke="black" d="M93809.29,-455.97C93823.55,-442.79 93841.66,-429.08 93861,-422 94085.78,-339.72 95781.11,-436.92 96015,-386 96028.17,-383.13 96041.64,-378.94 96054.73,-374.1"/>
<polygon fill="black" stroke="black" points="96056.11,-377.32 96064.19,-370.47 96053.6,-370.79 96056.11,-377.32"/>
</g>
<!-- layer1_gpu13_ln2 -->
<g id="node497" class="node">
<title>layer1_gpu13_ln2</title>
<ellipse fill="none" stroke="black" cx="92821" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="92821" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="92821" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="92821" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_mlp1 -->
<g id="node498" class="node">
<title>layer1_gpu13_mlp1</title>
<polygon fill="none" stroke="black" points="92727,-524 92593,-524 92593,-456 92727,-456 92727,-524"/>
<text text-anchor="middle" x="92660" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="92660" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="92660" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="92660" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_gelu -->
<g id="node499" class="node">
<title>layer1_gpu13_gelu</title>
<ellipse fill="none" stroke="black" cx="92480" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="92480" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="92480" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="92480" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_gpu13_mlp2 -->
<g id="node500" class="node">
<title>layer1_gpu13_mlp2</title>
<polygon fill="none" stroke="black" points="92366.5,-524 92259.5,-524 92259.5,-456 92366.5,-456 92366.5,-524"/>
<text text-anchor="middle" x="92313" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="92313" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="92313" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="92313" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_ln1 -->
<g id="node501" class="node">
<title>layer2_gpu13_ln1</title>
<ellipse fill="none" stroke="black" cx="90480" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="90480" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="90480" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="90480" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_qkv -->
<g id="node502" class="node">
<title>layer2_gpu13_qkv</title>
<polygon fill="none" stroke="black" points="92079,-524 91949,-524 91949,-456 92079,-456 92079,-524"/>
<text text-anchor="middle" x="92014" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="92014" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="92014" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="92014" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_reshape -->
<g id="node503" class="node">
<title>layer2_gpu13_reshape</title>
<ellipse fill="none" stroke="black" cx="91863" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="91863" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="91863" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="91863" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_attn -->
<g id="node504" class="node">
<title>layer2_gpu13_attn</title>
<polygon fill="none" stroke="black" points="91622,-558 91467,-490 91622,-422 91777,-490 91622,-558"/>
<text text-anchor="middle" x="91622" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="91622" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="91622" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="91622" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_out_proj -->
<g id="node505" class="node">
<title>layer2_gpu13_out_proj</title>
<polygon fill="none" stroke="black" points="95468,-524 95324,-524 95324,-456 95468,-456 95468,-524"/>
<text text-anchor="middle" x="95396" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="95396" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="95396" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="95396" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_out_proj&#45;&gt;layer2_concat_group3 -->
<g id="edge71" class="edge">
<title>layer2_gpu13_out_proj&#45;&gt;layer2_concat_group3</title>
<path fill="none" stroke="black" d="M95468.19,-486.5C95629.23,-479.8 96029.39,-456.8 96356,-386 96378.55,-381.11 96402.26,-374.41 96424.75,-367.27"/>
<polygon fill="black" stroke="black" points="96425.87,-370.59 96434.31,-364.19 96423.72,-363.92 96425.87,-370.59"/>
</g>
<!-- layer2_gpu13_ln2 -->
<g id="node506" class="node">
<title>layer2_gpu13_ln2</title>
<ellipse fill="none" stroke="black" cx="91135" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="91135" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="91135" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="91135" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_mlp1 -->
<g id="node507" class="node">
<title>layer2_gpu13_mlp1</title>
<polygon fill="none" stroke="black" points="91041,-524 90907,-524 90907,-456 91041,-456 91041,-524"/>
<text text-anchor="middle" x="90974" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="90974" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="90974" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="90974" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_gelu -->
<g id="node508" class="node">
<title>layer2_gpu13_gelu</title>
<ellipse fill="none" stroke="black" cx="90794" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="90794" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="90794" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="90794" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_gpu13_mlp2 -->
<g id="node509" class="node">
<title>layer2_gpu13_mlp2</title>
<polygon fill="none" stroke="black" points="90680.5,-524 90573.5,-524 90573.5,-456 90680.5,-456 90680.5,-524"/>
<text text-anchor="middle" x="90627" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="90627" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="90627" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="90627" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_ln1 -->
<g id="node510" class="node">
<title>layer3_gpu13_ln1</title>
<ellipse fill="none" stroke="black" cx="94600" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="94600" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="94600" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="94600" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_qkv -->
<g id="node511" class="node">
<title>layer3_gpu13_qkv</title>
<polygon fill="none" stroke="black" points="90386,-524 90256,-524 90256,-456 90386,-456 90386,-524"/>
<text text-anchor="middle" x="90321" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="90321" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="90321" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="90321" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_reshape -->
<g id="node512" class="node">
<title>layer3_gpu13_reshape</title>
<ellipse fill="none" stroke="black" cx="90170" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="90170" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="90170" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="90170" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_attn -->
<g id="node513" class="node">
<title>layer3_gpu13_attn</title>
<polygon fill="none" stroke="black" points="89929,-558 89774,-490 89929,-422 90084,-490 89929,-558"/>
<text text-anchor="middle" x="89929" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="89929" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="89929" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="89929" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_out_proj -->
<g id="node514" class="node">
<title>layer3_gpu13_out_proj</title>
<polygon fill="none" stroke="black" points="93059,-524 92915,-524 92915,-456 93059,-456 93059,-524"/>
<text text-anchor="middle" x="92987" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="92987" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="92987" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="92987" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_out_proj&#45;&gt;layer3_concat_group3 -->
<g id="edge72" class="edge">
<title>layer3_gpu13_out_proj&#45;&gt;layer3_concat_group3</title>
<path fill="none" stroke="black" d="M93016.84,-455.95C93030.91,-442.76 93048.82,-429.05 93068,-422 93207.6,-370.68 95599.62,-417.4 95745,-386 95758.18,-383.15 95771.65,-378.98 95784.74,-374.14"/>
<polygon fill="black" stroke="black" points="95786.11,-377.36 95794.19,-370.51 95783.6,-370.83 95786.11,-377.36"/>
</g>
<!-- layer3_gpu13_ln2 -->
<g id="node515" class="node">
<title>layer3_gpu13_ln2</title>
<ellipse fill="none" stroke="black" cx="89511" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="89511" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="89511" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="89511" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_mlp1 -->
<g id="node516" class="node">
<title>layer3_gpu13_mlp1</title>
<polygon fill="none" stroke="black" points="89417,-524 89283,-524 89283,-456 89417,-456 89417,-524"/>
<text text-anchor="middle" x="89350" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="89350" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="89350" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="89350" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_gelu -->
<g id="node517" class="node">
<title>layer3_gpu13_gelu</title>
<ellipse fill="none" stroke="black" cx="89170" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="89170" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="89170" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="89170" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_gpu13_mlp2 -->
<g id="node518" class="node">
<title>layer3_gpu13_mlp2</title>
<polygon fill="none" stroke="black" points="89056.5,-524 88949.5,-524 88949.5,-456 89056.5,-456 89056.5,-524"/>
<text text-anchor="middle" x="89003" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="89003" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="89003" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="89003" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- embed_14 -->
<g id="node519" class="node">
<title>embed_14</title>
<polygon fill="none" stroke="black" points="102395,-516.5 102175,-516.5 102175,-463.5 102395,-463.5 102395,-516.5"/>
<text text-anchor="middle" x="102285" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="102285" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="102285" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu14_ln1 -->
<g id="node520" class="node">
<title>layer0_gpu14_ln1</title>
<ellipse fill="none" stroke="black" cx="102285" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="102285" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="102285" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="102285" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- embed_14&#45;&gt;layer0_gpu14_ln1 -->
<g id="edge15" class="edge">
<title>embed_14&#45;&gt;layer0_gpu14_ln1</title>
<path fill="none" stroke="black" d="M102285,-463.33C102285,-439.41 102285,-403.17 102285,-374.06"/>
<polygon fill="black" stroke="black" points="102288.5,-373.69 102285,-363.69 102281.5,-373.69 102288.5,-373.69"/>
</g>
<!-- layer0_gpu14_qkv -->
<g id="node521" class="node">
<title>layer0_gpu14_qkv</title>
<polygon fill="none" stroke="black" points="103025,-524 102895,-524 102895,-456 103025,-456 103025,-524"/>
<text text-anchor="middle" x="102960" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="102960" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="102960" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="102960" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_reshape -->
<g id="node522" class="node">
<title>layer0_gpu14_reshape</title>
<ellipse fill="none" stroke="black" cx="102809" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="102809" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="102809" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="102809" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_attn -->
<g id="node523" class="node">
<title>layer0_gpu14_attn</title>
<polygon fill="none" stroke="black" points="102568,-558 102413,-490 102568,-422 102723,-490 102568,-558"/>
<text text-anchor="middle" x="102568" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="102568" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="102568" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="102568" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_out_proj -->
<g id="node524" class="node">
<title>layer0_gpu14_out_proj</title>
<polygon fill="none" stroke="black" points="97475,-524 97331,-524 97331,-456 97475,-456 97475,-524"/>
<text text-anchor="middle" x="97403" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="97403" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="97403" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="97403" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_out_proj&#45;&gt;layer0_concat_group3 -->
<g id="edge73" class="edge">
<title>layer0_gpu14_out_proj&#45;&gt;layer0_concat_group3</title>
<path fill="none" stroke="black" d="M97372.75,-455.68C97358.73,-442.61 97340.98,-429.08 97322,-422 97157.78,-360.76 95916.14,-423.81 95745,-386 95731.84,-383.09 95718.37,-378.88 95705.28,-374.03"/>
<polygon fill="black" stroke="black" points="95706.42,-370.71 95695.83,-370.39 95703.91,-377.25 95706.42,-370.71"/>
</g>
<!-- layer0_gpu14_ln2 -->
<g id="node525" class="node">
<title>layer0_gpu14_ln2</title>
<ellipse fill="none" stroke="black" cx="102081" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="102081" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="102081" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="102081" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_mlp1 -->
<g id="node526" class="node">
<title>layer0_gpu14_mlp1</title>
<polygon fill="none" stroke="black" points="101987,-524 101853,-524 101853,-456 101987,-456 101987,-524"/>
<text text-anchor="middle" x="101920" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="101920" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="101920" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="101920" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_gelu -->
<g id="node527" class="node">
<title>layer0_gpu14_gelu</title>
<ellipse fill="none" stroke="black" cx="101740" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="101740" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="101740" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="101740" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer0_gpu14_mlp2 -->
<g id="node528" class="node">
<title>layer0_gpu14_mlp2</title>
<polygon fill="none" stroke="black" points="101626.5,-524 101519.5,-524 101519.5,-456 101626.5,-456 101626.5,-524"/>
<text text-anchor="middle" x="101573" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="101573" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="101573" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="101573" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_ln1 -->
<g id="node529" class="node">
<title>layer1_gpu14_ln1</title>
<ellipse fill="none" stroke="black" cx="99809" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="99809" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="99809" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="99809" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_qkv -->
<g id="node530" class="node">
<title>layer1_gpu14_qkv</title>
<polygon fill="none" stroke="black" points="101339,-524 101209,-524 101209,-456 101339,-456 101339,-524"/>
<text text-anchor="middle" x="101274" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="101274" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="101274" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="101274" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_reshape -->
<g id="node531" class="node">
<title>layer1_gpu14_reshape</title>
<ellipse fill="none" stroke="black" cx="101123" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="101123" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="101123" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="101123" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_attn -->
<g id="node532" class="node">
<title>layer1_gpu14_attn</title>
<polygon fill="none" stroke="black" points="100882,-558 100727,-490 100882,-422 101037,-490 100882,-558"/>
<text text-anchor="middle" x="100882" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="100882" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="100882" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="100882" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_out_proj -->
<g id="node533" class="node">
<title>layer1_gpu14_out_proj</title>
<polygon fill="none" stroke="black" points="99085,-524 98941,-524 98941,-456 99085,-456 99085,-524"/>
<text text-anchor="middle" x="99013" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="99013" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="99013" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="99013" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_out_proj&#45;&gt;layer1_concat_group3 -->
<g id="edge74" class="edge">
<title>layer1_gpu14_out_proj&#45;&gt;layer1_concat_group3</title>
<path fill="none" stroke="black" d="M98983.16,-455.95C98969.09,-442.76 98951.18,-429.05 98932,-422 98794.23,-371.34 96433.68,-416.06 96290,-386 96275.74,-383.02 96261.11,-378.57 96246.94,-373.44"/>
<polygon fill="black" stroke="black" points="96247.8,-370.02 96237.21,-369.78 96245.34,-376.58 96247.8,-370.02"/>
</g>
<!-- layer1_gpu14_ln2 -->
<g id="node534" class="node">
<title>layer1_gpu14_ln2</title>
<ellipse fill="none" stroke="black" cx="100464" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="100464" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="100464" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="100464" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_mlp1 -->
<g id="node535" class="node">
<title>layer1_gpu14_mlp1</title>
<polygon fill="none" stroke="black" points="100370,-524 100236,-524 100236,-456 100370,-456 100370,-524"/>
<text text-anchor="middle" x="100303" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="100303" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="100303" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="100303" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_gelu -->
<g id="node536" class="node">
<title>layer1_gpu14_gelu</title>
<ellipse fill="none" stroke="black" cx="100123" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="100123" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="100123" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="100123" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_gpu14_mlp2 -->
<g id="node537" class="node">
<title>layer1_gpu14_mlp2</title>
<polygon fill="none" stroke="black" points="100009.5,-524 99902.5,-524 99902.5,-456 100009.5,-456 100009.5,-524"/>
<text text-anchor="middle" x="99956" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="99956" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="99956" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="99956" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_ln1 -->
<g id="node538" class="node">
<title>layer2_gpu14_ln1</title>
<ellipse fill="none" stroke="black" cx="100633" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="100633" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="100633" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="100633" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_qkv -->
<g id="node539" class="node">
<title>layer2_gpu14_qkv</title>
<polygon fill="none" stroke="black" points="99715,-524 99585,-524 99585,-456 99715,-456 99715,-524"/>
<text text-anchor="middle" x="99650" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="99650" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="99650" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="99650" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_reshape -->
<g id="node540" class="node">
<title>layer2_gpu14_reshape</title>
<ellipse fill="none" stroke="black" cx="99499" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="99499" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="99499" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="99499" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_attn -->
<g id="node541" class="node">
<title>layer2_gpu14_attn</title>
<polygon fill="none" stroke="black" points="99258,-558 99103,-490 99258,-422 99413,-490 99258,-558"/>
<text text-anchor="middle" x="99258" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="99258" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="99258" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="99258" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_out_proj -->
<g id="node542" class="node">
<title>layer2_gpu14_out_proj</title>
<polygon fill="none" stroke="black" points="101501,-524 101357,-524 101357,-456 101501,-456 101501,-524"/>
<text text-anchor="middle" x="101429" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="101429" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="101429" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="101429" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_out_proj&#45;&gt;layer2_concat_group3 -->
<g id="edge75" class="edge">
<title>layer2_gpu14_out_proj&#45;&gt;layer2_concat_group3</title>
<path fill="none" stroke="black" d="M101399.18,-455.89C101385.11,-442.7 101367.2,-429 101348,-422 101225.75,-377.46 96791.07,-414 96664,-386 96651.87,-383.33 96639.51,-379.44 96627.47,-374.92"/>
<polygon fill="black" stroke="black" points="96628.49,-371.56 96617.9,-371.17 96625.93,-378.07 96628.49,-371.56"/>
</g>
<!-- layer2_gpu14_ln2 -->
<g id="node543" class="node">
<title>layer2_gpu14_ln2</title>
<ellipse fill="none" stroke="black" cx="98847" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="98847" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="98847" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="98847" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_mlp1 -->
<g id="node544" class="node">
<title>layer2_gpu14_mlp1</title>
<polygon fill="none" stroke="black" points="98753,-524 98619,-524 98619,-456 98753,-456 98753,-524"/>
<text text-anchor="middle" x="98686" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="98686" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="98686" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="98686" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_gelu -->
<g id="node545" class="node">
<title>layer2_gpu14_gelu</title>
<ellipse fill="none" stroke="black" cx="98506" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="98506" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="98506" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="98506" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_gpu14_mlp2 -->
<g id="node546" class="node">
<title>layer2_gpu14_mlp2</title>
<polygon fill="none" stroke="black" points="98392.5,-524 98285.5,-524 98285.5,-456 98392.5,-456 98392.5,-524"/>
<text text-anchor="middle" x="98339" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="98339" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="98339" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="98339" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_ln1 -->
<g id="node547" class="node">
<title>layer3_gpu14_ln1</title>
<ellipse fill="none" stroke="black" cx="103119" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="103119" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="103119" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="103119" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_qkv -->
<g id="node548" class="node">
<title>layer3_gpu14_qkv</title>
<polygon fill="none" stroke="black" points="98105,-524 97975,-524 97975,-456 98105,-456 98105,-524"/>
<text text-anchor="middle" x="98040" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="98040" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="98040" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="98040" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_reshape -->
<g id="node549" class="node">
<title>layer3_gpu14_reshape</title>
<ellipse fill="none" stroke="black" cx="97889" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="97889" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="97889" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="97889" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_attn -->
<g id="node550" class="node">
<title>layer3_gpu14_attn</title>
<polygon fill="none" stroke="black" points="97648,-558 97493,-490 97648,-422 97803,-490 97648,-558"/>
<text text-anchor="middle" x="97648" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="97648" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="97648" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="97648" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_out_proj -->
<g id="node551" class="node">
<title>layer3_gpu14_out_proj</title>
<polygon fill="none" stroke="black" points="98267,-524 98123,-524 98123,-456 98267,-456 98267,-524"/>
<text text-anchor="middle" x="98195" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="98195" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="98195" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="98195" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_out_proj&#45;&gt;layer3_concat_group3 -->
<g id="edge76" class="edge">
<title>layer3_gpu14_out_proj&#45;&gt;layer3_concat_group3</title>
<path fill="none" stroke="black" d="M98165.14,-455.98C98151.07,-442.8 98133.17,-429.09 98114,-422 97895.22,-341.12 96242.91,-435.67 96015,-386 96001.83,-383.13 95988.36,-378.94 95975.27,-374.1"/>
<polygon fill="black" stroke="black" points="95976.41,-370.78 95965.82,-370.46 95973.89,-377.32 95976.41,-370.78"/>
</g>
<!-- layer3_gpu14_ln2 -->
<g id="node552" class="node">
<title>layer3_gpu14_ln2</title>
<ellipse fill="none" stroke="black" cx="97237" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="97237" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="97237" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="97237" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_mlp1 -->
<g id="node553" class="node">
<title>layer3_gpu14_mlp1</title>
<polygon fill="none" stroke="black" points="97143,-524 97009,-524 97009,-456 97143,-456 97143,-524"/>
<text text-anchor="middle" x="97076" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="97076" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="97076" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="97076" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_gelu -->
<g id="node554" class="node">
<title>layer3_gpu14_gelu</title>
<ellipse fill="none" stroke="black" cx="96896" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="96896" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="96896" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="96896" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_gpu14_mlp2 -->
<g id="node555" class="node">
<title>layer3_gpu14_mlp2</title>
<polygon fill="none" stroke="black" points="96782.5,-524 96675.5,-524 96675.5,-456 96782.5,-456 96782.5,-524"/>
<text text-anchor="middle" x="96729" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="96729" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="96729" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="96729" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- embed_15 -->
<g id="node556" class="node">
<title>embed_15</title>
<polygon fill="none" stroke="black" points="109004,-516.5 108784,-516.5 108784,-463.5 109004,-463.5 109004,-516.5"/>
<text text-anchor="middle" x="108894" y="-501.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="108894" y="-486.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
<text text-anchor="middle" x="108894" y="-471.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_gpu15_ln1 -->
<g id="node557" class="node">
<title>layer0_gpu15_ln1</title>
<ellipse fill="none" stroke="black" cx="108894" cy="-326" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="108894" y="-337.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="108894" y="-322.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="108894" y="-307.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- embed_15&#45;&gt;layer0_gpu15_ln1 -->
<g id="edge16" class="edge">
<title>embed_15&#45;&gt;layer0_gpu15_ln1</title>
<path fill="none" stroke="black" d="M108894,-463.33C108894,-439.41 108894,-403.17 108894,-374.06"/>
<polygon fill="black" stroke="black" points="108897.5,-373.69 108894,-363.69 108890.5,-373.69 108897.5,-373.69"/>
</g>
<!-- layer0_gpu15_qkv -->
<g id="node558" class="node">
<title>layer0_gpu15_qkv</title>
<polygon fill="none" stroke="black" points="109634,-524 109504,-524 109504,-456 109634,-456 109634,-524"/>
<text text-anchor="middle" x="109569" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="109569" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="109569" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="109569" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_reshape -->
<g id="node559" class="node">
<title>layer0_gpu15_reshape</title>
<ellipse fill="none" stroke="black" cx="109418" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="109418" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="109418" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="109418" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_attn -->
<g id="node560" class="node">
<title>layer0_gpu15_attn</title>
<polygon fill="none" stroke="black" points="109177,-558 109022,-490 109177,-422 109332,-490 109177,-558"/>
<text text-anchor="middle" x="109177" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="109177" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="109177" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="109177" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_out_proj -->
<g id="node561" class="node">
<title>layer0_gpu15_out_proj</title>
<polygon fill="none" stroke="black" points="104084,-524 103940,-524 103940,-456 104084,-456 104084,-524"/>
<text text-anchor="middle" x="104012" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="104012" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="104012" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="104012" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_out_proj&#45;&gt;layer0_concat_group3 -->
<g id="edge77" class="edge">
<title>layer0_gpu15_out_proj&#45;&gt;layer0_concat_group3</title>
<path fill="none" stroke="black" d="M103982.19,-455.86C103968.12,-442.66 103950.22,-428.97 103931,-422 103717.22,-344.51 95967.48,-433 95745,-386 95731.71,-383.19 95718.12,-379.01 95704.93,-374.14"/>
<polygon fill="black" stroke="black" points="95706,-370.81 95695.41,-370.49 95703.5,-377.34 95706,-370.81"/>
</g>
<!-- layer0_gpu15_ln2 -->
<g id="node562" class="node">
<title>layer0_gpu15_ln2</title>
<ellipse fill="none" stroke="black" cx="108690" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="108690" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="108690" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="108690" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_mlp1 -->
<g id="node563" class="node">
<title>layer0_gpu15_mlp1</title>
<polygon fill="none" stroke="black" points="108596,-524 108462,-524 108462,-456 108596,-456 108596,-524"/>
<text text-anchor="middle" x="108529" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="108529" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="108529" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="108529" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_gelu -->
<g id="node564" class="node">
<title>layer0_gpu15_gelu</title>
<ellipse fill="none" stroke="black" cx="108349" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="108349" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="108349" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="108349" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_gpu15_mlp2 -->
<g id="node565" class="node">
<title>layer0_gpu15_mlp2</title>
<polygon fill="none" stroke="black" points="108235.5,-524 108128.5,-524 108128.5,-456 108235.5,-456 108235.5,-524"/>
<text text-anchor="middle" x="108182" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="108182" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="108182" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="108182" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_ln1 -->
<g id="node566" class="node">
<title>layer1_gpu15_ln1</title>
<ellipse fill="none" stroke="black" cx="107235" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="107235" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="107235" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="107235" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_qkv -->
<g id="node567" class="node">
<title>layer1_gpu15_qkv</title>
<polygon fill="none" stroke="black" points="107941,-524 107811,-524 107811,-456 107941,-456 107941,-524"/>
<text text-anchor="middle" x="107876" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="107876" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="107876" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="107876" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_reshape -->
<g id="node568" class="node">
<title>layer1_gpu15_reshape</title>
<ellipse fill="none" stroke="black" cx="107725" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="107725" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="107725" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="107725" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_attn -->
<g id="node569" class="node">
<title>layer1_gpu15_attn</title>
<polygon fill="none" stroke="black" points="107484,-558 107329,-490 107484,-422 107639,-490 107484,-558"/>
<text text-anchor="middle" x="107484" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="107484" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="107484" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="107484" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_out_proj -->
<g id="node570" class="node">
<title>layer1_gpu15_out_proj</title>
<polygon fill="none" stroke="black" points="105694,-524 105550,-524 105550,-456 105694,-456 105694,-524"/>
<text text-anchor="middle" x="105622" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="105622" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="105622" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="105622" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_out_proj&#45;&gt;layer1_concat_group3 -->
<g id="edge78" class="edge">
<title>layer1_gpu15_out_proj&#45;&gt;layer1_concat_group3</title>
<path fill="none" stroke="black" d="M105592.19,-455.86C105578.12,-442.66 105560.22,-428.96 105541,-422 105421.62,-378.76 96525.09,-400.99 96399,-386 96356.61,-380.96 96310.97,-371.4 96270.49,-361.41"/>
<polygon fill="black" stroke="black" points="96271.13,-357.96 96260.58,-358.93 96269.43,-364.75 96271.13,-357.96"/>
</g>
<!-- layer1_gpu15_ln2 -->
<g id="node571" class="node">
<title>layer1_gpu15_ln2</title>
<ellipse fill="none" stroke="black" cx="107066" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="107066" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="107066" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="107066" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_mlp1 -->
<g id="node572" class="node">
<title>layer1_gpu15_mlp1</title>
<polygon fill="none" stroke="black" points="106972,-524 106838,-524 106838,-456 106972,-456 106972,-524"/>
<text text-anchor="middle" x="106905" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="106905" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="106905" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="106905" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_gelu -->
<g id="node573" class="node">
<title>layer1_gpu15_gelu</title>
<ellipse fill="none" stroke="black" cx="106725" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="106725" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="106725" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="106725" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_gpu15_mlp2 -->
<g id="node574" class="node">
<title>layer1_gpu15_mlp2</title>
<polygon fill="none" stroke="black" points="106611.5,-524 106504.5,-524 106504.5,-456 106611.5,-456 106611.5,-524"/>
<text text-anchor="middle" x="106558" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="106558" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="106558" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="106558" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_ln1 -->
<g id="node575" class="node">
<title>layer2_gpu15_ln1</title>
<ellipse fill="none" stroke="black" cx="108035" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="108035" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="108035" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="108035" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_qkv -->
<g id="node576" class="node">
<title>layer2_gpu15_qkv</title>
<polygon fill="none" stroke="black" points="106324,-524 106194,-524 106194,-456 106324,-456 106324,-524"/>
<text text-anchor="middle" x="106259" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="106259" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="106259" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="106259" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_reshape -->
<g id="node577" class="node">
<title>layer2_gpu15_reshape</title>
<ellipse fill="none" stroke="black" cx="106108" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="106108" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="106108" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="106108" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_attn -->
<g id="node578" class="node">
<title>layer2_gpu15_attn</title>
<polygon fill="none" stroke="black" points="105867,-558 105712,-490 105867,-422 106022,-490 105867,-558"/>
<text text-anchor="middle" x="105867" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="105867" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="105867" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="105867" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_out_proj -->
<g id="node579" class="node">
<title>layer2_gpu15_out_proj</title>
<polygon fill="none" stroke="black" points="106486,-524 106342,-524 106342,-456 106486,-456 106486,-524"/>
<text text-anchor="middle" x="106414" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="106414" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="106414" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="106414" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_out_proj&#45;&gt;layer2_concat_group3 -->
<g id="edge79" class="edge">
<title>layer2_gpu15_out_proj&#45;&gt;layer2_concat_group3</title>
<path fill="none" stroke="black" d="M106384.19,-455.86C106370.12,-442.65 106352.22,-428.96 106333,-422 106206.73,-376.28 96795.2,-414.64 96664,-386 96651.87,-383.35 96639.5,-379.48 96627.46,-374.97"/>
<polygon fill="black" stroke="black" points="96628.48,-371.6 96617.89,-371.22 96625.93,-378.12 96628.48,-371.6"/>
</g>
<!-- layer2_gpu15_ln2 -->
<g id="node580" class="node">
<title>layer2_gpu15_ln2</title>
<ellipse fill="none" stroke="black" cx="105456" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="105456" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="105456" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="105456" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_mlp1 -->
<g id="node581" class="node">
<title>layer2_gpu15_mlp1</title>
<polygon fill="none" stroke="black" points="105362,-524 105228,-524 105228,-456 105362,-456 105362,-524"/>
<text text-anchor="middle" x="105295" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="105295" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="105295" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="105295" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_gelu -->
<g id="node582" class="node">
<title>layer2_gpu15_gelu</title>
<ellipse fill="none" stroke="black" cx="105115" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="105115" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="105115" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="105115" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_gpu15_mlp2 -->
<g id="node583" class="node">
<title>layer2_gpu15_mlp2</title>
<polygon fill="none" stroke="black" points="105001.5,-524 104894.5,-524 104894.5,-456 105001.5,-456 105001.5,-524"/>
<text text-anchor="middle" x="104948" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="104948" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="104948" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="104948" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_ln1 -->
<g id="node584" class="node">
<title>layer3_gpu15_ln1</title>
<ellipse fill="none" stroke="black" cx="109728" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="109728" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="109728" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="109728" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_qkv -->
<g id="node585" class="node">
<title>layer3_gpu15_qkv</title>
<polygon fill="none" stroke="black" points="104714,-524 104584,-524 104584,-456 104714,-456 104714,-524"/>
<text text-anchor="middle" x="104649" y="-508.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="104649" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="104649" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,3*4*128]</text>
<text text-anchor="middle" x="104649" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_reshape -->
<g id="node586" class="node">
<title>layer3_gpu15_reshape</title>
<ellipse fill="none" stroke="black" cx="104498" cy="-490" rx="68" ry="37.5"/>
<text text-anchor="middle" x="104498" y="-501.3" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="104498" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="104498" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_attn -->
<g id="node587" class="node">
<title>layer3_gpu15_attn</title>
<polygon fill="none" stroke="black" points="104257,-558 104102,-490 104257,-422 104412,-490 104257,-558"/>
<text text-anchor="middle" x="104257" y="-508.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product</text>
<text text-anchor="middle" x="104257" y="-493.8" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="104257" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4,128]</text>
<text text-anchor="middle" x="104257" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_out_proj -->
<g id="node588" class="node">
<title>layer3_gpu15_out_proj</title>
<polygon fill="none" stroke="black" points="104876,-524 104732,-524 104732,-456 104876,-456 104876,-524"/>
<text text-anchor="middle" x="104804" y="-508.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="104804" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="104804" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*128]</text>
<text text-anchor="middle" x="104804" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_out_proj&#45;&gt;layer3_concat_group3 -->
<g id="edge80" class="edge">
<title>layer3_gpu15_out_proj&#45;&gt;layer3_concat_group3</title>
<path fill="none" stroke="black" d="M104774.19,-455.86C104760.12,-442.66 104742.22,-428.96 104723,-422 104495.58,-339.6 96251.67,-435.97 96015,-386 96001.71,-383.19 95988.12,-379.01 95974.93,-374.15"/>
<polygon fill="black" stroke="black" points="95976,-370.81 95965.41,-370.49 95973.49,-377.34 95976,-370.81"/>
</g>
<!-- layer3_gpu15_ln2 -->
<g id="node589" class="node">
<title>layer3_gpu15_ln2</title>
<ellipse fill="none" stroke="black" cx="103846" cy="-490" rx="75.73" ry="37.5"/>
<text text-anchor="middle" x="103846" y="-501.3" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="103846" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,D]</text>
<text text-anchor="middle" x="103846" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_mlp1 -->
<g id="node590" class="node">
<title>layer3_gpu15_mlp1</title>
<polygon fill="none" stroke="black" points="103752,-524 103618,-524 103618,-456 103752,-456 103752,-524"/>
<text text-anchor="middle" x="103685" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense1</text>
<text text-anchor="middle" x="103685" y="-493.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="103685" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="103685" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_gelu -->
<g id="node591" class="node">
<title>layer3_gpu15_gelu</title>
<ellipse fill="none" stroke="black" cx="103505" cy="-490" rx="95" ry="37.5"/>
<text text-anchor="middle" x="103505" y="-501.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="103505" y="-486.3" font-family="Times,serif" font-size="14.00">[B,L,4*8192//16]</text>
<text text-anchor="middle" x="103505" y="-471.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_gpu15_mlp2 -->
<g id="node592" class="node">
<title>layer3_gpu15_mlp2</title>
<polygon fill="none" stroke="black" points="103391.5,-524 103284.5,-524 103284.5,-456 103391.5,-456 103391.5,-524"/>
<text text-anchor="middle" x="103338" y="-508.8" font-family="Times,serif" font-size="14.00">MLP Dense2</text>
<text text-anchor="middle" x="103338" y="-493.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="103338" y="-478.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="103338" y="-463.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer0_final_concat -->
<g id="node609" class="node">
<title>layer0_final_concat</title>
<polygon fill="orange" stroke="black" points="52993.5,-163.07 52993.5,-199.93 52917.64,-226 52810.36,-226 52734.5,-199.93 52734.5,-163.07 52810.36,-137 52917.64,-137 52993.5,-163.07"/>
<polygon fill="none" stroke="black" points="52997.5,-160.21 52997.5,-202.79 52918.31,-230 52809.69,-230 52730.5,-202.79 52730.5,-160.21 52809.69,-133 52918.31,-133 52997.5,-160.21"/>
<text text-anchor="middle" x="52864" y="-192.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="52864" y="-177.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="52864" y="-162.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer0_concat_group0&#45;&gt;layer0_final_concat -->
<g id="edge81" class="edge">
<title>layer0_concat_group0&#45;&gt;layer0_final_concat</title>
<path fill="none" stroke="black" d="M13303.41,-281.48C13319.5,-275.07 13336.48,-269.47 13353,-266 13612.01,-211.59 50133.29,-184.46 52719.81,-182.6"/>
<polygon fill="black" stroke="black" points="52720.06,-186.1 52730.06,-182.59 52720.06,-179.1 52720.06,-186.1"/>
</g>
<!-- layer1_final_concat -->
<g id="node610" class="node">
<title>layer1_final_concat</title>
<polygon fill="orange" stroke="black" points="54836.5,-163.07 54836.5,-199.93 54760.64,-226 54653.36,-226 54577.5,-199.93 54577.5,-163.07 54653.36,-137 54760.64,-137 54836.5,-163.07"/>
<polygon fill="none" stroke="black" points="54840.5,-160.21 54840.5,-202.79 54761.31,-230 54652.69,-230 54573.5,-202.79 54573.5,-160.21 54652.69,-133 54761.31,-133 54840.5,-160.21"/>
<text text-anchor="middle" x="54707" y="-192.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="54707" y="-177.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="54707" y="-162.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_concat_group0&#45;&gt;layer1_final_concat -->
<g id="edge101" class="edge">
<title>layer1_concat_group0&#45;&gt;layer1_final_concat</title>
<path fill="none" stroke="black" d="M13854.99,-286.65C13880.9,-278.13 13909.16,-270.34 13936,-266 14211.61,-221.39 53862.05,-241.81 54141,-230 54284.93,-223.91 54448.91,-209.3 54563.19,-197.88"/>
<polygon fill="black" stroke="black" points="54563.8,-201.34 54573.4,-196.85 54563.1,-194.37 54563.8,-201.34"/>
</g>
<!-- layer2_final_concat -->
<g id="node611" class="node">
<title>layer2_final_concat</title>
<polygon fill="orange" stroke="black" points="58320.5,-163.07 58320.5,-199.93 58244.64,-226 58137.36,-226 58061.5,-199.93 58061.5,-163.07 58137.36,-137 58244.64,-137 58320.5,-163.07"/>
<polygon fill="none" stroke="black" points="58324.5,-160.21 58324.5,-202.79 58245.31,-230 58136.69,-230 58057.5,-202.79 58057.5,-160.21 58136.69,-133 58245.31,-133 58324.5,-160.21"/>
<text text-anchor="middle" x="58191" y="-192.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="58191" y="-177.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="58191" y="-162.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_concat_group0&#45;&gt;layer2_final_concat -->
<g id="edge121" class="edge">
<title>layer2_concat_group0&#45;&gt;layer2_final_concat</title>
<path fill="none" stroke="black" d="M14187.88,-280.75C14202.87,-274.64 14218.62,-269.33 14234,-266 14371.83,-236.12 54708.98,-231.06 54850,-230 56088.03,-220.65 57583.93,-193.88 58047.24,-185.23"/>
<polygon fill="black" stroke="black" points="58047.4,-188.73 58057.33,-185.04 58047.27,-181.73 58047.4,-188.73"/>
</g>
<!-- layer3_final_concat -->
<g id="node612" class="node">
<title>layer3_final_concat</title>
<polygon fill="orange" stroke="black" points="54127.5,-163.07 54127.5,-199.93 54051.64,-226 53944.36,-226 53868.5,-199.93 53868.5,-163.07 53944.36,-137 54051.64,-137 54127.5,-163.07"/>
<polygon fill="none" stroke="black" points="54131.5,-160.21 54131.5,-202.79 54052.31,-230 53943.69,-230 53864.5,-202.79 53864.5,-160.21 53943.69,-133 54052.31,-133 54131.5,-160.21"/>
<text text-anchor="middle" x="53998" y="-192.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="53998" y="-177.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="53998" y="-162.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_concat_group0&#45;&gt;layer3_final_concat -->
<g id="edge141" class="edge">
<title>layer3_concat_group0&#45;&gt;layer3_final_concat</title>
<path fill="none" stroke="black" d="M13573.4,-281.46C13589.5,-275.06 13606.48,-269.46 13623,-266 13756.85,-237.97 52870.29,-233.34 53007,-230 53308.54,-222.64 53661.26,-203.12 53854.04,-191.52"/>
<polygon fill="black" stroke="black" points="53854.46,-195.01 53864.23,-190.91 53854.04,-188.02 53854.46,-195.01"/>
</g>
<!-- layer0_concat_group1&#45;&gt;layer0_final_concat -->
<g id="edge82" class="edge">
<title>layer0_concat_group1&#45;&gt;layer0_final_concat</title>
<path fill="none" stroke="black" d="M40619.42,-281.54C40635.52,-275.13 40652.49,-269.51 40669,-266 40978.83,-200.15 51371.25,-184.44 52720.21,-182.68"/>
<polygon fill="black" stroke="black" points="52720.43,-186.18 52730.43,-182.66 52720.43,-179.18 52720.43,-186.18"/>
</g>
<!-- layer1_concat_group1&#45;&gt;layer1_final_concat -->
<g id="edge102" class="edge">
<title>layer1_concat_group1&#45;&gt;layer1_final_concat</title>
<path fill="none" stroke="black" d="M41170.99,-286.69C41196.9,-278.17 41225.17,-270.37 41252,-266 41605.37,-208.45 53783.31,-245.48 54141,-230 54284.92,-223.77 54448.91,-209.18 54563.18,-197.8"/>
<polygon fill="black" stroke="black" points="54563.79,-201.26 54573.39,-196.78 54563.09,-194.29 54563.79,-201.26"/>
</g>
<!-- layer2_concat_group1&#45;&gt;layer2_final_concat -->
<g id="edge122" class="edge">
<title>layer2_concat_group1&#45;&gt;layer2_final_concat</title>
<path fill="none" stroke="black" d="M41503.89,-280.77C41518.87,-274.67 41534.62,-269.35 41550,-266 41730.49,-226.7 54665.28,-231.56 54850,-230 56088.02,-219.52 57583.92,-193.5 58047.24,-185.14"/>
<polygon fill="black" stroke="black" points="58047.39,-188.63 58057.33,-184.95 58047.27,-181.63 58047.39,-188.63"/>
</g>
<!-- layer3_concat_group1&#45;&gt;layer3_final_concat -->
<g id="edge142" class="edge">
<title>layer3_concat_group1&#45;&gt;layer3_final_concat</title>
<path fill="none" stroke="black" d="M40889.41,-281.49C40905.51,-275.08 40922.48,-269.48 40939,-266 41103.02,-231.47 52839.44,-234.26 53007,-230 53308.53,-222.33 53661.25,-202.93 53854.03,-191.43"/>
<polygon fill="black" stroke="black" points="53854.45,-194.91 53864.23,-190.82 53854.04,-187.92 53854.45,-194.91"/>
</g>
<!-- layer0_concat_group2&#45;&gt;layer0_final_concat -->
<g id="edge83" class="edge">
<title>layer0_concat_group2&#45;&gt;layer0_final_concat</title>
<path fill="none" stroke="black" d="M67974.11,-280.77C67959.13,-274.66 67943.38,-269.35 67928,-266 67737.03,-224.44 54051.38,-234.93 53856,-230 53553.95,-222.39 53200.59,-202.94 53007.7,-191.43"/>
<polygon fill="black" stroke="black" points="53007.7,-187.92 52997.51,-190.82 53007.28,-194.91 53007.7,-187.92"/>
</g>
<!-- layer1_concat_group2&#45;&gt;layer1_final_concat -->
<g id="edge103" class="edge">
<title>layer1_concat_group2&#45;&gt;layer1_final_concat</title>
<path fill="none" stroke="black" d="M68512.59,-281.5C68496.49,-275.09 68479.52,-269.48 68463,-266 68321.47,-236.17 58193.63,-231.28 58049,-230 56810.61,-219.06 55314.26,-193.35 54850.8,-185.1"/>
<polygon fill="black" stroke="black" points="54850.77,-181.6 54840.71,-184.92 54850.65,-188.59 54850.77,-181.6"/>
</g>
<!-- layer2_concat_group2&#45;&gt;layer2_final_concat -->
<g id="edge123" class="edge">
<title>layer2_concat_group2&#45;&gt;layer2_final_concat</title>
<path fill="none" stroke="black" d="M68894.81,-282.14C68877.68,-275.48 68859.57,-269.62 68842,-266 68572.44,-210.42 59587.54,-185.99 58335.32,-182.85"/>
<polygon fill="black" stroke="black" points="58334.94,-179.35 58324.93,-182.82 58334.92,-186.35 58334.94,-179.35"/>
</g>
<!-- layer3_concat_group2&#45;&gt;layer3_final_concat -->
<g id="edge143" class="edge">
<title>layer3_concat_group2&#45;&gt;layer3_final_concat</title>
<path fill="none" stroke="black" d="M68242.59,-281.49C68226.49,-275.08 68209.52,-269.48 68193,-266 68007.78,-227.04 54754.1,-238.16 54565,-230 54420.7,-223.78 54256.28,-209.17 54141.79,-197.78"/>
<polygon fill="black" stroke="black" points="54141.86,-194.27 54131.56,-196.76 54141.16,-201.24 54141.86,-194.27"/>
</g>
<!-- layer0_concat_group3&#45;&gt;layer0_final_concat -->
<g id="edge84" class="edge">
<title>layer0_concat_group3&#45;&gt;layer0_final_concat</title>
<path fill="none" stroke="black" d="M95526.12,-280.74C95511.13,-274.64 95495.38,-269.33 95480,-266 95338.75,-235.38 54000.48,-233.52 53856,-230 53553.94,-222.64 53200.59,-203.1 53007.7,-191.5"/>
<polygon fill="black" stroke="black" points="53007.7,-188 52997.5,-190.89 53007.28,-194.98 53007.7,-188"/>
</g>
<!-- layer1_concat_group3&#45;&gt;layer1_final_concat -->
<g id="edge104" class="edge">
<title>layer1_concat_group3&#45;&gt;layer1_final_concat</title>
<path fill="none" stroke="black" d="M96064.6,-281.46C96048.5,-275.06 96031.52,-269.46 96015,-266 95885.97,-238.97 58180.82,-231 58049,-230 56810.6,-220.61 55314.25,-193.86 54850.8,-185.23"/>
<polygon fill="black" stroke="black" points="54850.77,-181.72 54840.71,-185.04 54850.64,-188.72 54850.77,-181.72"/>
</g>
<!-- layer2_concat_group3&#45;&gt;layer2_final_concat -->
<g id="edge124" class="edge">
<title>layer2_concat_group3&#45;&gt;layer2_final_concat</title>
<path fill="none" stroke="black" d="M96447.2,-282.2C96429.96,-275.5 96411.71,-269.6 96394,-266 96143.37,-215.06 60871.44,-184.73 58334.71,-182.62"/>
<polygon fill="black" stroke="black" points="58334.66,-179.12 58324.66,-182.61 58334.65,-186.12 58334.66,-179.12"/>
</g>
<!-- layer3_concat_group3&#45;&gt;layer3_final_concat -->
<g id="edge144" class="edge">
<title>layer3_concat_group3&#45;&gt;layer3_final_concat</title>
<path fill="none" stroke="black" d="M95794.6,-281.46C95778.5,-275.06 95761.52,-269.46 95745,-266 95465.1,-207.38 54850.72,-242.07 54565,-230 54420.7,-223.9 54256.27,-209.28 54141.78,-197.85"/>
<polygon fill="black" stroke="black" points="54141.85,-194.34 54131.55,-196.83 54141.16,-201.31 54141.85,-194.34"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu0_ln1 -->
<g id="edge85" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu0_ln1</title>
<path fill="none" stroke="black" d="M52730.25,-182.61C50248.39,-184.7 14033.75,-215.98 11833,-266 11034.45,-284.15 8990.82,-144.01 8242,-422 8225.81,-428.01 8210.28,-438.34 8197.04,-449.12"/>
<polygon fill="black" stroke="black" points="8194.46,-446.71 8189.1,-455.85 8198.99,-452.05 8194.46,-446.71"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu1_ln1 -->
<g id="edge86" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu1_ln1</title>
<path fill="none" stroke="black" d="M52730.46,-182.52C50023.93,-182.89 7055.66,-190.02 4452,-266 3227.45,-301.74 2845.65,11.94 1700,-422 1683.85,-428.12 1668.34,-438.48 1655.09,-449.25"/>
<polygon fill="black" stroke="black" points="1652.52,-446.84 1647.14,-455.98 1657.04,-452.19 1652.52,-446.84"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu2_ln1 -->
<g id="edge87" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu2_ln1</title>
<path fill="none" stroke="black" d="M52730.17,-182.46C50247.75,-181.8 14061.12,-173.68 13969,-266 13931.33,-303.75 13931.49,-348.08 13969,-386 14033.96,-451.67 17206.9,-391.27 17294,-422 17310.59,-427.85 17326.41,-438.39 17339.81,-449.39"/>
<polygon fill="black" stroke="black" points="17337.54,-452.05 17347.41,-455.9 17342.09,-446.74 17337.54,-452.05"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu3_ln1 -->
<g id="edge88" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu3_ln1</title>
<path fill="none" stroke="black" d="M52730.18,-182.48C50698.83,-182.23 26211.91,-180.99 25488,-266 25186.92,-301.36 25097.08,-290.38 24824,-422 24809,-429.23 24794.2,-439.48 24781.26,-449.8"/>
<polygon fill="black" stroke="black" points="24778.97,-447.15 24773.46,-456.2 24783.41,-452.56 24778.97,-447.15"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu4_ln1 -->
<g id="edge89" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu4_ln1</title>
<path fill="none" stroke="black" d="M52730.24,-182.54C50835.78,-183.12 29445.16,-191.39 28811,-266 28509.93,-301.42 28420.08,-290.38 28147,-422 28132,-429.23 28117.2,-439.48 28104.26,-449.8"/>
<polygon fill="black" stroke="black" points="28101.97,-447.15 28096.46,-456.2 28106.41,-452.56 28101.97,-447.15"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu5_ln1 -->
<g id="edge90" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu5_ln1</title>
<path fill="none" stroke="black" d="M52730.27,-182.71C51135.79,-185.33 35810.9,-211.83 35353,-266 35051.95,-301.62 34962.08,-290.38 34689,-422 34674,-429.23 34659.2,-439.48 34646.26,-449.8"/>
<polygon fill="black" stroke="black" points="34643.97,-447.15 34638.46,-456.2 34648.41,-452.56 34643.97,-447.15"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu6_ln1 -->
<g id="edge91" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu6_ln1</title>
<path fill="none" stroke="black" d="M52730.35,-182.82C51446.08,-185.98 41338.05,-212.56 41285,-266 41247.42,-303.85 41247.49,-348.08 41285,-386 41349.96,-451.67 44522.9,-391.27 44610,-422 44626.59,-427.85 44642.41,-438.39 44655.81,-449.39"/>
<polygon fill="black" stroke="black" points="44653.54,-452.05 44663.41,-455.9 44658.09,-446.74 44653.54,-452.05"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu7_ln1 -->
<g id="edge92" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu7_ln1</title>
<path fill="none" stroke="black" d="M52745.76,-208.17C52598.06,-243.2 52340.4,-314.21 52140,-422 52125.47,-429.81 52110.92,-440.15 52098.06,-450.35"/>
<polygon fill="black" stroke="black" points="52095.84,-447.64 52090.28,-456.67 52100.25,-453.08 52095.84,-447.64"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu8_ln1 -->
<g id="edge93" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu8_ln1</title>
<path fill="none" stroke="black" d="M52997.57,-188.97C53188.08,-198.18 53548.79,-215.56 53856,-230 54202.65,-246.3 54291.43,-224.68 54636,-266 54995.68,-309.13 55107.17,-270.02 55436,-422 55451.14,-429 55465.96,-439.29 55478.83,-449.71"/>
<polygon fill="black" stroke="black" points="55476.66,-452.46 55486.57,-456.19 55481.15,-447.09 55476.66,-452.46"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu9_ln1 -->
<g id="edge94" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu9_ln1</title>
<path fill="none" stroke="black" d="M52997.51,-190.72C53187.94,-202.03 53548.55,-221.9 53856,-230 53907.82,-231.36 61279.47,-233.68 61320,-266 61362.82,-300.15 61305.99,-350.86 61348,-386 61407.4,-435.69 61971.6,-394.54 62044,-422 62060.03,-428.08 62075.38,-438.43 62088.47,-449.2"/>
<polygon fill="black" stroke="black" points="62086.45,-452.08 62096.32,-455.93 62091,-446.77 62086.45,-452.08"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu10_ln1 -->
<g id="edge95" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu10_ln1</title>
<path fill="none" stroke="black" d="M52997.51,-190.82C53187.93,-202.25 53548.54,-222.27 53856,-230 53907.64,-231.3 68691.95,-234.64 68733,-266 68776.95,-299.58 68722.18,-352.24 68766,-386 68840.95,-443.75 72082.77,-390.53 72172,-422 72188.59,-427.85 72204.42,-438.38 72217.82,-449.39"/>
<polygon fill="black" stroke="black" points="72215.54,-452.05 72225.41,-455.9 72220.09,-446.73 72215.54,-452.05"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu11_ln1 -->
<g id="edge96" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu11_ln1</title>
<path fill="none" stroke="black" d="M52997.51,-190.85C53187.93,-202.32 53548.54,-222.39 53856,-230 53893.83,-230.94 75625.37,-242.45 75655,-266 75697.87,-300.08 75640.26,-351.76 75683,-386 75767.9,-454.01 79496.49,-385.6 79599,-422 79615.16,-427.74 79630.54,-437.99 79643.63,-448.78"/>
<polygon fill="black" stroke="black" points="79641.6,-451.66 79651.46,-455.53 79646.17,-446.36 79641.6,-451.66"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu12_ln1 -->
<g id="edge97" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu12_ln1</title>
<path fill="none" stroke="black" d="M52997.5,-190.87C53187.93,-202.36 53548.54,-222.45 53856,-230 53905.3,-231.21 82225.39,-235.32 82264,-266 82306.88,-300.07 82249.99,-350.86 82292,-386 82351.4,-435.69 82915.6,-394.54 82988,-422 83004.03,-428.08 83019.38,-438.43 83032.47,-449.2"/>
<polygon fill="black" stroke="black" points="83030.45,-452.08 83040.32,-455.93 83035,-446.77 83030.45,-452.08"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu13_ln1 -->
<g id="edge98" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu13_ln1</title>
<path fill="none" stroke="black" d="M52997.5,-190.88C53187.93,-202.38 53548.54,-222.48 53856,-230 53916.77,-231.49 88824.4,-228.19 88872,-266 88914.88,-300.06 88857.99,-350.86 88900,-386 88959.4,-435.69 89523.6,-394.54 89596,-422 89612.03,-428.08 89627.38,-438.43 89640.47,-449.2"/>
<polygon fill="black" stroke="black" points="89638.45,-452.08 89648.32,-455.93 89643,-446.77 89638.45,-452.08"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu14_ln1 -->
<g id="edge99" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu14_ln1</title>
<path fill="none" stroke="black" d="M52997.5,-190.89C53187.93,-202.4 53548.54,-222.51 53856,-230 53929.64,-231.79 96226.43,-221.33 96285,-266 96328.98,-299.55 96274.18,-352.24 96318,-386 96392.95,-443.75 99634.77,-390.53 99724,-422 99740.59,-427.85 99756.42,-438.38 99769.82,-449.39"/>
<polygon fill="black" stroke="black" points="99767.54,-452.05 99777.41,-455.9 99772.09,-446.73 99767.54,-452.05"/>
</g>
<!-- layer0_final_concat&#45;&gt;layer1_gpu15_ln1 -->
<g id="edge100" class="edge">
<title>layer0_final_concat&#45;&gt;layer1_gpu15_ln1</title>
<path fill="none" stroke="black" d="M52997.5,-190.89C53187.93,-202.41 53548.54,-222.53 53856,-230 53898.83,-231.04 103173.45,-239.36 103207,-266 103249.89,-300.06 103192.26,-351.76 103235,-386 103319.9,-454.01 107048.49,-385.6 107151,-422 107167.16,-427.74 107182.54,-437.99 107195.63,-448.78"/>
<polygon fill="black" stroke="black" points="107193.6,-451.66 107203.46,-455.53 107198.17,-446.36 107193.6,-451.66"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu0_ln1 -->
<g id="edge105" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu0_ln1</title>
<path fill="none" stroke="black" d="M54573.4,-196.85C54458.83,-208.41 54289.27,-223.72 54141,-230 53001.52,-278.23 14223.26,-242.38 13083,-266 11767.53,-293.25 11439.83,-336.98 10125,-386 10007.35,-390.39 9176.57,-381.55 9066,-422 9049.78,-427.93 9034.25,-438.25 9021,-449.03"/>
<polygon fill="black" stroke="black" points="9018.42,-446.62 9013.07,-455.76 9022.95,-451.96 9018.42,-446.62"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu1_ln1 -->
<g id="edge106" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu1_ln1</title>
<path fill="none" stroke="black" d="M54573.4,-196.86C54458.83,-208.42 54289.27,-223.73 54141,-230 52773.61,-287.78 6238.76,-217.71 4871,-266 4107.39,-292.96 3918.55,-337.61 3156,-386 3015.61,-394.91 2655.54,-372.15 2524,-422 2507.85,-428.12 2492.34,-438.48 2479.09,-449.25"/>
<polygon fill="black" stroke="black" points="2476.52,-446.85 2471.15,-455.98 2481.04,-452.19 2476.52,-446.85"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu2_ln1 -->
<g id="edge107" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu2_ln1</title>
<path fill="none" stroke="black" d="M54573.4,-196.85C54458.83,-208.4 54289.27,-223.71 54141,-230 53677.13,-249.68 21173.75,-217.48 20712,-266 20378.59,-301.04 20277.61,-279.84 19974,-422 19958.78,-429.13 19943.82,-439.45 19930.8,-449.87"/>
<polygon fill="black" stroke="black" points="19928.44,-447.28 19922.95,-456.34 19932.89,-452.68 19928.44,-447.28"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu3_ln1 -->
<g id="edge108" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu3_ln1</title>
<path fill="none" stroke="black" d="M54573.4,-196.84C54458.83,-208.38 54289.27,-223.69 54141,-230 53767.92,-245.88 27626.37,-226.93 27255,-266 26921.59,-301.08 26820.61,-279.84 26517,-422 26501.78,-429.13 26486.82,-439.45 26473.8,-449.87"/>
<polygon fill="black" stroke="black" points="26471.44,-447.28 26465.95,-456.34 26475.89,-452.68 26471.44,-447.28"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu4_ln1 -->
<g id="edge109" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu4_ln1</title>
<path fill="none" stroke="black" d="M54573.4,-196.83C54458.83,-208.36 54289.27,-223.67 54141,-230 52922.5,-282.04 33406.91,-224.55 32188,-266 31665.37,-283.77 30328.12,-234.4 29840,-422 29824.02,-428.14 29808.65,-438.39 29795.48,-449.06"/>
<polygon fill="black" stroke="black" points="29792.97,-446.6 29787.58,-455.72 29797.48,-451.95 29792.97,-446.6"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu5_ln1 -->
<g id="edge110" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu5_ln1</title>
<path fill="none" stroke="black" d="M54573.39,-196.79C54458.82,-208.3 54289.27,-223.59 54141,-230 52615.53,-295.9 41925.57,-234.37 40399,-266 39505.85,-284.51 37220.2,-113.02 36382,-422 36365.79,-427.97 36350.27,-438.3 36337.02,-449.07"/>
<polygon fill="black" stroke="black" points="36334.44,-446.67 36329.08,-455.81 36338.97,-452.01 36334.44,-446.67"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu6_ln1 -->
<g id="edge111" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu6_ln1</title>
<path fill="none" stroke="black" d="M54573.39,-196.67C54458.82,-208.1 54289.26,-223.35 54141,-230 53462.45,-260.42 48703.34,-193.39 48028,-266 47694.67,-301.84 47593.61,-279.84 47290,-422 47274.78,-429.13 47259.82,-439.45 47246.8,-449.87"/>
<polygon fill="black" stroke="black" points="47244.44,-447.28 47238.95,-456.34 47248.89,-452.68 47244.44,-447.28"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu7_ln1 -->
<g id="edge112" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu7_ln1</title>
<path fill="none" stroke="black" d="M54573.31,-202.06C54396.5,-231.66 54078.61,-298.01 53833,-422 53818.14,-429.5 53803.38,-439.84 53790.43,-450.15"/>
<polygon fill="black" stroke="black" points="53788.15,-447.5 53782.62,-456.54 53792.58,-452.91 53788.15,-447.5"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu8_ln1 -->
<g id="edge113" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu8_ln1</title>
<path fill="none" stroke="black" d="M54840.64,-194.68C55164.74,-225.62 55984.28,-312.58 56235,-422 56250.55,-428.78 56265.7,-439.11 56278.8,-449.65"/>
<polygon fill="black" stroke="black" points="56276.75,-452.49 56286.68,-456.2 56281.23,-447.11 56276.75,-452.49"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu9_ln1 -->
<g id="edge114" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu9_ln1</title>
<path fill="none" stroke="black" d="M54840.72,-184.56C55292.18,-191.48 56801.52,-214.33 58049,-230 58782.1,-239.21 60616.05,-223.91 61348,-266 62014.95,-304.35 62224.04,-170.64 62843,-422 62858.86,-428.44 62874.19,-438.78 62887.37,-449.43"/>
<polygon fill="black" stroke="black" points="62885.37,-452.32 62895.28,-456.07 62889.87,-446.96 62885.37,-452.32"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu10_ln1 -->
<g id="edge115" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu10_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-184.92C55292.16,-192.99 56801.47,-219.04 58049,-230 58123.42,-230.65 68700.34,-230.96 68766,-266 68822.77,-296.29 68790.31,-355.55 68847,-386 68948.56,-440.55 72888.36,-383.45 72997,-422 73013.16,-427.73 73028.55,-437.99 73041.63,-448.78"/>
<polygon fill="black" stroke="black" points="73039.6,-451.65 73049.46,-455.53 73044.17,-446.35 73039.6,-451.65"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu11_ln1 -->
<g id="edge116" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu11_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-184.98C55292.16,-193.25 56801.47,-219.86 58049,-230 61967.55,-261.85 71764.93,-197.2 75683,-266 76207.09,-275.2 79905.66,-242.11 80398,-422 80414.22,-427.93 80429.76,-438.24 80443,-449.02"/>
<polygon fill="black" stroke="black" points="80441.05,-451.95 80450.94,-455.75 80445.58,-446.61 80441.05,-451.95"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu12_ln1 -->
<g id="edge117" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu12_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-185.01C55292.16,-193.36 56801.46,-220.21 58049,-230 58722.4,-235.29 81619.52,-230.51 82292,-266 82959.12,-301.21 83168.04,-170.64 83787,-422 83802.86,-428.44 83818.19,-438.78 83831.37,-449.43"/>
<polygon fill="black" stroke="black" points="83829.37,-452.32 83839.28,-456.07 83833.87,-446.96 83829.37,-452.32"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu13_ln1 -->
<g id="edge118" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu13_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-185.03C55292.16,-193.42 56801.46,-220.41 58049,-230 58905.95,-236.59 88044.21,-220.97 88900,-266 89567.13,-301.1 89776.04,-170.64 90395,-422 90410.86,-428.44 90426.19,-438.78 90439.37,-449.43"/>
<polygon fill="black" stroke="black" points="90437.37,-452.32 90447.28,-456.07 90441.87,-446.96 90437.37,-452.32"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu14_ln1 -->
<g id="edge119" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu14_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-185.04C55292.16,-193.47 56801.46,-220.55 58049,-230 58115.44,-230.5 96259.35,-234.79 96318,-266 96374.81,-296.23 96342.31,-355.55 96399,-386 96500.56,-440.55 100440.36,-383.45 100549,-422 100565.16,-427.73 100580.55,-437.99 100593.63,-448.78"/>
<polygon fill="black" stroke="black" points="100591.6,-451.65 100601.46,-455.53 100596.17,-446.35 100591.6,-451.65"/>
</g>
<!-- layer1_final_concat&#45;&gt;layer2_gpu15_ln1 -->
<g id="edge120" class="edge">
<title>layer1_final_concat&#45;&gt;layer2_gpu15_ln1</title>
<path fill="none" stroke="black" d="M54840.71,-185.04C55292.16,-193.5 56801.46,-220.64 58049,-230 60559.26,-248.84 100725.03,-223.49 103235,-266 103759.1,-274.88 107457.66,-242.11 107950,-422 107966.22,-427.93 107981.76,-438.24 107995,-449.02"/>
<polygon fill="black" stroke="black" points="107993.05,-451.95 108002.94,-455.75 107997.58,-446.61 107993.05,-451.95"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu0_ln1 -->
<g id="edge125" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu0_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-185.04C57606.02,-193.48 56097.17,-220.59 54850,-230 54779.03,-230.54 14031.16,-231.75 13969,-266 13913.71,-296.46 13947.96,-354.94 13893,-386 13738.19,-473.49 12460.34,-361.86 12293,-422 12276.75,-427.84 12261.2,-438.13 12247.96,-448.91"/>
<polygon fill="black" stroke="black" points="12245.38,-446.51 12240.03,-455.65 12249.91,-451.85 12245.38,-446.51"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu1_ln1 -->
<g id="edge126" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu1_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-185.05C57606.02,-193.51 56097.17,-220.67 54850,-230 52166.52,-250.07 9228.75,-200.09 6546,-266 6534.8,-266.28 3334.49,-418.08 3324,-422 3307.82,-428.05 3292.3,-438.4 3279.06,-449.17"/>
<polygon fill="black" stroke="black" points="3276.48,-446.76 3271.12,-455.9 3281.01,-452.1 3276.48,-446.76"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu2_ln1 -->
<g id="edge127" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu2_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-185.03C57606.01,-193.45 56097.16,-220.48 54850,-230 54790.85,-230.45 20825.89,-232.7 20777,-266 20719.11,-305.43 20699.31,-389.38 20692.53,-442.28"/>
<polygon fill="black" stroke="black" points="20689.03,-442.09 20691.34,-452.43 20695.98,-442.9 20689.03,-442.09"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu3_ln1 -->
<g id="edge128" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu3_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-185.02C57606.01,-193.4 56097.16,-220.32 54850,-230 54802.21,-230.37 27359.5,-239.09 27320,-266 27262.12,-305.44 27242.31,-389.39 27235.53,-442.29"/>
<polygon fill="black" stroke="black" points="27232.03,-442.09 27234.34,-452.43 27238.98,-442.91 27232.03,-442.09"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu4_ln1 -->
<g id="edge129" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu4_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-185C57606.01,-193.31 56097.16,-220.07 54850,-230 52518.07,-248.58 36193.27,-207.6 33862,-266 33772.42,-268.24 30723.93,-390.61 30640,-422 30623.82,-428.05 30608.3,-438.4 30595.06,-449.17"/>
<polygon fill="black" stroke="black" points="30592.48,-446.76 30587.12,-455.9 30597.01,-452.1 30592.48,-446.76"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu5_ln1 -->
<g id="edge130" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu5_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-184.96C57606.01,-193.13 56097.16,-219.48 54850,-230 54802.9,-230.4 41326.23,-243.24 41285,-266 41229.73,-296.51 41263.96,-354.94 41209,-386 41054.19,-473.49 39776.34,-361.86 39609,-422 39592.75,-427.84 39577.2,-438.13 39563.96,-448.91"/>
<polygon fill="black" stroke="black" points="39561.38,-446.51 39556.03,-455.65 39565.91,-451.85 39561.38,-446.51"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu6_ln1 -->
<g id="edge131" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu6_ln1</title>
<path fill="none" stroke="black" d="M58057.33,-184.83C57606.01,-192.59 56097.14,-217.81 54850,-230 54803.08,-230.46 48131.72,-239.5 48093,-266 48035.2,-305.56 48015.36,-389.47 48008.56,-442.33"/>
<polygon fill="black" stroke="black" points="48005.06,-442.12 48007.36,-452.46 48012.01,-442.94 48005.06,-442.12"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu7_ln1 -->
<g id="edge132" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu7_ln1</title>
<path fill="none" stroke="black" d="M58057.45,-183.05C57445.39,-185.92 54931.53,-201.59 54778,-266 54689.15,-303.27 54615.23,-392.21 54576.72,-445.83"/>
<polygon fill="black" stroke="black" points="54573.77,-443.94 54570.84,-454.12 54579.48,-447.98 54573.77,-443.94"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu8_ln1 -->
<g id="edge133" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu8_ln1</title>
<path fill="none" stroke="black" d="M58163.41,-230.01C58129.28,-288.77 58071.66,-387.99 58038.52,-445.06"/>
<polygon fill="black" stroke="black" points="58035.41,-443.44 58033.42,-453.84 58041.47,-446.95 58035.41,-443.44"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu9_ln1 -->
<g id="edge134" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu9_ln1</title>
<path fill="none" stroke="black" d="M58324.61,-182.92C59543.01,-186.79 68684.87,-217.49 68733,-266 68770.56,-303.86 68770.29,-347.87 68733,-386 68670.84,-449.57 67216.67,-391.93 67133,-422 67116.75,-427.84 67101.2,-438.13 67087.96,-448.91"/>
<polygon fill="black" stroke="black" points="67085.38,-446.51 67080.03,-455.65 67089.91,-451.85 67085.38,-446.51"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu10_ln1 -->
<g id="edge135" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu10_ln1</title>
<path fill="none" stroke="black" d="M58324.79,-182.75C59875.03,-185.69 74383.86,-214.58 74818,-266 75119.04,-301.65 75208.92,-290.38 75482,-422 75497,-429.23 75511.8,-439.48 75524.74,-449.8"/>
<polygon fill="black" stroke="black" points="75522.59,-452.56 75532.54,-456.2 75527.03,-447.15 75522.59,-452.56"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu11_ln1 -->
<g id="edge136" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu11_ln1</title>
<path fill="none" stroke="black" d="M58324.82,-182.55C60184.63,-183.36 80814.89,-193.95 81427,-266 81728.07,-301.44 81817.92,-290.38 82091,-422 82106,-429.23 82120.8,-439.48 82133.74,-449.8"/>
<polygon fill="black" stroke="black" points="82131.59,-452.56 82141.54,-456.2 82136.03,-447.15 82131.59,-452.56"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu12_ln1 -->
<g id="edge137" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu12_ln1</title>
<path fill="none" stroke="black" d="M58324.56,-182.49C60324.07,-182.42 84112.35,-183.33 84816,-266 85117.08,-301.37 85206.92,-290.38 85480,-422 85495,-429.23 85509.8,-439.48 85522.74,-449.8"/>
<polygon fill="black" stroke="black" points="85520.59,-452.56 85530.54,-456.2 85525.03,-447.15 85520.59,-452.56"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu13_ln1 -->
<g id="edge138" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu13_ln1</title>
<path fill="none" stroke="black" d="M58324.85,-182.47C60780.25,-181.92 96194.81,-175.61 96285,-266 96322.67,-303.75 96322.29,-347.87 96285,-386 96222.84,-449.57 94768.67,-391.93 94685,-422 94668.75,-427.84 94653.2,-438.13 94639.96,-448.91"/>
<polygon fill="black" stroke="black" points="94637.38,-446.51 94632.03,-455.65 94641.91,-451.85 94637.38,-446.51"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu14_ln1 -->
<g id="edge139" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu14_ln1</title>
<path fill="none" stroke="black" d="M58324.85,-182.54C60964.88,-183.36 101780.26,-197.09 102370,-266 102671.1,-301.18 102760.92,-290.38 103034,-422 103049,-429.23 103063.8,-439.48 103076.74,-449.8"/>
<polygon fill="black" stroke="black" points="103074.59,-452.56 103084.54,-456.2 103079.03,-447.15 103074.59,-452.56"/>
</g>
<!-- layer2_final_concat&#45;&gt;layer3_gpu15_ln1 -->
<g id="edge140" class="edge">
<title>layer2_final_concat&#45;&gt;layer3_gpu15_ln1</title>
<path fill="none" stroke="black" d="M58324.61,-182.51C61163.54,-182.68 108299.47,-186.68 108979,-266 109280.1,-301.15 109369.92,-290.38 109643,-422 109658,-429.23 109672.8,-439.48 109685.74,-449.8"/>
<polygon fill="black" stroke="black" points="109683.59,-452.56 109693.54,-456.2 109688.03,-447.15 109683.59,-452.56"/>
</g>
<!-- final_output -->
<g id="node613" class="node">
<title>final_output</title>
<polygon fill="green" stroke="black" points="54084,-30.07 54084,-66.93 54033.62,-93 53962.38,-93 53912,-66.93 53912,-30.07 53962.38,-4 54033.62,-4 54084,-30.07"/>
<polygon fill="none" stroke="black" points="54088,-27.63 54088,-69.37 54034.6,-97 53961.4,-97 53908,-69.37 53908,-27.63 53961.4,0 54034.6,0 54088,-27.63"/>
<text text-anchor="middle" x="53998" y="-59.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="53998" y="-44.8" font-family="Times,serif" font-size="14.00">[B,L,8192]</text>
<text text-anchor="middle" x="53998" y="-29.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge145" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53907.14,-145.39C53892.57,-125.59 53893.32,-101.02 53909.41,-81.71"/>
<polygon fill="black" stroke="black" points="53912.14,-83.92 53916.62,-74.32 53907.13,-79.03 53912.14,-83.92"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge146" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53917.19,-141.9C53907.57,-124.26 53907.95,-103.47 53918.34,-86.08"/>
<polygon fill="black" stroke="black" points="53921.27,-88.01 53924.25,-77.84 53915.58,-83.93 53921.27,-88.01"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge147" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53928.11,-138.33C53922.28,-123.34 53922.3,-106.48 53928.17,-91.5"/>
<polygon fill="black" stroke="black" points="53931.35,-92.98 53932.58,-82.45 53925.05,-89.91 53931.35,-92.98"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge148" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53939.66,-134.31C53936.59,-122.34 53936.45,-109.43 53939.25,-97.37"/>
<polygon fill="black" stroke="black" points="53942.69,-98.08 53942.29,-87.49 53936,-96.02 53942.69,-98.08"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge149" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53952.34,-132.84C53950.58,-123.17 53950.28,-112.95 53951.45,-103.09"/>
<polygon fill="black" stroke="black" points="53954.94,-103.45 53953.2,-93 53948.04,-102.25 53954.94,-103.45"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge150" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53965.39,-132.84C53964.31,-124.62 53964,-115.99 53964.45,-107.54"/>
<polygon fill="black" stroke="black" points="53967.95,-107.62 53965.36,-97.35 53960.98,-106.99 53967.95,-107.62"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge151" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53978.43,-132.84C53977.79,-124.62 53977.6,-115.99 53977.87,-107.54"/>
<polygon fill="black" stroke="black" points="53981.37,-107.52 53978.42,-97.35 53974.38,-107.15 53981.37,-107.52"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge152" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M53991.48,-132.84C53991.26,-124.62 53991.2,-115.99 53991.29,-107.54"/>
<polygon fill="black" stroke="black" points="53994.79,-107.41 53991.47,-97.35 53987.79,-107.28 53994.79,-107.41"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge153" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54004.52,-132.84C54004.74,-124.62 54004.8,-115.99 54004.71,-107.54"/>
<polygon fill="black" stroke="black" points="54008.21,-107.28 54004.53,-97.35 54001.21,-107.41 54008.21,-107.28"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge154" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54017.57,-132.84C54018.21,-124.62 54018.4,-115.99 54018.13,-107.54"/>
<polygon fill="black" stroke="black" points="54021.62,-107.15 54017.58,-97.35 54014.63,-107.52 54021.62,-107.15"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge155" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54030.61,-132.84C54031.69,-124.62 54032,-115.99 54031.55,-107.54"/>
<polygon fill="black" stroke="black" points="54035.02,-106.99 54030.64,-97.35 54028.05,-107.62 54035.02,-106.99"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge156" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54043.66,-132.84C54045.42,-123.17 54045.72,-112.95 54044.55,-103.09"/>
<polygon fill="black" stroke="black" points="54047.96,-102.25 54042.8,-93 54041.06,-103.45 54047.96,-102.25"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge157" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54056.34,-134.31C54059.41,-122.34 54059.55,-109.43 54056.75,-97.37"/>
<polygon fill="black" stroke="black" points="54060,-96.02 54053.71,-87.49 54053.31,-98.08 54060,-96.02"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge158" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54067.89,-138.33C54073.72,-123.34 54073.7,-106.48 54067.83,-91.5"/>
<polygon fill="black" stroke="black" points="54070.95,-89.91 54063.42,-82.45 54064.65,-92.98 54070.95,-89.91"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge159" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54078.81,-141.9C54088.43,-124.26 54088.05,-103.47 54077.66,-86.08"/>
<polygon fill="black" stroke="black" points="54080.42,-83.93 54071.75,-77.84 54074.73,-88.01 54080.42,-83.93"/>
</g>
<!-- layer3_final_concat&#45;&gt;final_output -->
<g id="edge160" class="edge">
<title>layer3_final_concat&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M54088.86,-145.39C54103.43,-125.59 54102.68,-101.02 54086.59,-81.71"/>
<polygon fill="black" stroke="black" points="54088.87,-79.03 54079.38,-74.32 54083.86,-83.92 54088.87,-79.03"/>
</g>
</g>
</svg>
