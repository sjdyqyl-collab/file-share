<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="527pt"
 viewBox="0.00 0.00 1440.00 527.20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.18 0.18) rotate(0) translate(4 2863)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2863 7827,-2863 7827,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M2536,-2119C2536,-2119 7803,-2119 7803,-2119 7809,-2119 7815,-2125 7815,-2131 7815,-2131 7815,-2767 7815,-2767 7815,-2773 7809,-2779 7803,-2779 7803,-2779 2536,-2779 2536,-2779 2530,-2779 2524,-2773 2524,-2767 2524,-2767 2524,-2131 2524,-2131 2524,-2125 2530,-2119 2536,-2119"/>
<text text-anchor="middle" x="5169.5" y="-2763.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M1762,-1440C1762,-1440 7029,-1440 7029,-1440 7035,-1440 7041,-1446 7041,-1452 7041,-1452 7041,-2088 7041,-2088 7041,-2094 7035,-2100 7029,-2100 7029,-2100 1762,-2100 1762,-2100 1756,-2100 1750,-2094 1750,-2088 1750,-2088 1750,-1452 1750,-1452 1750,-1446 1756,-1440 1762,-1440"/>
<text text-anchor="middle" x="4395.5" y="-2084.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M908,-761C908,-761 6175,-761 6175,-761 6181,-761 6187,-767 6187,-773 6187,-773 6187,-1409 6187,-1409 6187,-1415 6181,-1421 6175,-1421 6175,-1421 908,-1421 908,-1421 902,-1421 896,-1415 896,-1409 896,-1409 896,-773 896,-773 896,-767 902,-761 908,-761"/>
<text text-anchor="middle" x="3541.5" y="-1405.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M20,-82C20,-82 5287,-82 5287,-82 5293,-82 5299,-88 5299,-94 5299,-94 5299,-730 5299,-730 5299,-736 5293,-742 5287,-742 5287,-742 20,-742 20,-742 14,-742 8,-736 8,-730 8,-730 8,-94 8,-94 8,-88 14,-82 20,-82"/>
<text text-anchor="middle" x="2653.5" y="-726.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="white" stroke="black" points="4571,-2859 4365,-2859 4365,-2806 4571,-2806 4571,-2859"/>
<text text-anchor="middle" x="4468" y="-2843.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4468" y="-2828.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 1024, 8192]</text>
<text text-anchor="middle" x="4468" y="-2813.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln1_0 -->
<g id="node48" class="node">
<title>ln1_0</title>
<polygon fill="white" stroke="black" points="5002.5,-2748 4849.5,-2748 4849.5,-2695 5002.5,-2695 5002.5,-2748"/>
<text text-anchor="middle" x="4926" y="-2732.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4926" y="-2717.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4926" y="-2702.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1_0 -->
<g id="edge177" class="edge">
<title>input&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M4571.07,-2806.97C4651.85,-2787.74 4762.98,-2761.3 4839.25,-2743.15"/>
<polygon fill="black" stroke="black" points="4840.39,-2746.47 4849.31,-2740.75 4838.77,-2739.66 4840.39,-2746.47"/>
</g>
<!-- residual1_0 -->
<g id="node97" class="node">
<title>residual1_0</title>
<polygon fill="orange" stroke="black" points="4088.5,-2748 3935.5,-2748 3935.5,-2695 4088.5,-2695 4088.5,-2748"/>
<text text-anchor="middle" x="4012" y="-2732.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4012" y="-2717.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4012" y="-2702.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;residual1_0 -->
<g id="edge237" class="edge">
<title>input&#45;&gt;residual1_0</title>
<path fill="none" stroke="black" d="M4364.81,-2806.83C4284.48,-2787.63 4174.26,-2761.29 4098.51,-2743.18"/>
<polygon fill="black" stroke="black" points="4099.06,-2739.71 4088.52,-2740.79 4097.43,-2746.52 4099.06,-2739.71"/>
</g>
<!-- proj_0_0_0 -->
<g id="node2" class="node">
<title>proj_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="5757,-2388 5613,-2388 5613,-2335 5757,-2335 5757,-2388"/>
<text text-anchor="middle" x="5685" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5685" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5685" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_0_0 -->
<g id="node3" class="node">
<title>concat_dim_0_0</title>
<polygon fill="lightsteelblue" stroke="black" points="5574.5,-2284 5421.5,-2284 5421.5,-2231 5574.5,-2231 5574.5,-2284"/>
<text text-anchor="middle" x="5498" y="-2268.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="5498" y="-2253.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="5498" y="-2238.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_0_0_0&#45;&gt;concat_dim_0_0 -->
<g id="edge1" class="edge">
<title>proj_0_0_0&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5660.02,-2334.72C5648.11,-2323.52 5633.16,-2310.94 5618,-2302 5607.38,-2295.74 5595.71,-2290.14 5583.95,-2285.22"/>
<polygon fill="black" stroke="black" points="5585.1,-2281.91 5574.51,-2281.42 5582.48,-2288.4 5585.1,-2281.91"/>
<text text-anchor="middle" x="5696" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_0 -->
<g id="node22" class="node">
<title>concat_heads_0</title>
<polygon fill="lightsteelblue" stroke="black" points="5791,-2180 5627,-2180 5627,-2127 5791,-2127 5791,-2180"/>
<text text-anchor="middle" x="5709" y="-2164.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="5709" y="-2149.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="5709" y="-2134.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_0 -->
<g id="edge17" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5550.97,-2230.89C5580.07,-2216.83 5616.32,-2199.3 5646.76,-2184.59"/>
<polygon fill="black" stroke="black" points="5648.53,-2187.62 5656.01,-2180.12 5645.48,-2181.32 5648.53,-2187.62"/>
<text text-anchor="middle" x="5660.5" y="-2201.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_0_0_1 -->
<g id="node4" class="node">
<title>proj_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5570,-2388 5426,-2388 5426,-2335 5570,-2335 5570,-2388"/>
<text text-anchor="middle" x="5498" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5498" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5498" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_0_0_1&#45;&gt;concat_dim_0_0 -->
<g id="edge2" class="edge">
<title>proj_0_0_1&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5498,-2334.76C5498,-2322.56 5498,-2307.78 5498,-2294.49"/>
<polygon fill="black" stroke="black" points="5501.5,-2294.23 5498,-2284.23 5494.5,-2294.23 5501.5,-2294.23"/>
<text text-anchor="middle" x="5556" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_0_0_2 -->
<g id="node5" class="node">
<title>proj_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="5388,-2388 5244,-2388 5244,-2335 5388,-2335 5388,-2388"/>
<text text-anchor="middle" x="5316" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5316" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5316" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_0_0_2&#45;&gt;concat_dim_0_0 -->
<g id="edge3" class="edge">
<title>proj_0_0_2&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5338.52,-2334.93C5349.53,-2323.64 5363.51,-2310.93 5378,-2302 5388.5,-2295.53 5400.1,-2289.83 5411.83,-2284.85"/>
<polygon fill="black" stroke="black" points="5413.3,-2288.03 5421.24,-2281.01 5410.66,-2281.54 5413.3,-2288.03"/>
<text text-anchor="middle" x="5436" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_0_0_3 -->
<g id="node6" class="node">
<title>proj_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5185,-2388 5041,-2388 5041,-2335 5185,-2335 5185,-2388"/>
<text text-anchor="middle" x="5113" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5113" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5113" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_0_0_3&#45;&gt;concat_dim_0_0 -->
<g id="edge4" class="edge">
<title>proj_0_0_3&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5160.26,-2334.88C5183.41,-2323.29 5212.05,-2310.35 5239,-2302 5295.14,-2284.6 5360.41,-2273.69 5411.39,-2267.15"/>
<polygon fill="black" stroke="black" points="5411.9,-2270.62 5421.38,-2265.9 5411.03,-2263.67 5411.9,-2270.62"/>
<text text-anchor="middle" x="5297" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_0_1_0 -->
<g id="node7" class="node">
<title>proj_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="4594,-2388 4450,-2388 4450,-2335 4594,-2335 4594,-2388"/>
<text text-anchor="middle" x="4522" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4522" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4522" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_0_1 -->
<g id="node8" class="node">
<title>concat_dim_0_1</title>
<polygon fill="lightsteelblue" stroke="black" points="4598.5,-2284 4445.5,-2284 4445.5,-2231 4598.5,-2231 4598.5,-2284"/>
<text text-anchor="middle" x="4522" y="-2268.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4522" y="-2253.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="4522" y="-2238.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_0_1_0&#45;&gt;concat_dim_0_1 -->
<g id="edge5" class="edge">
<title>proj_0_1_0&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4522,-2334.76C4522,-2322.56 4522,-2307.78 4522,-2294.49"/>
<polygon fill="black" stroke="black" points="4525.5,-2294.23 4522,-2284.23 4518.5,-2294.23 4525.5,-2294.23"/>
<text text-anchor="middle" x="4580" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_0 -->
<g id="edge18" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4598.51,-2249.93C4807.81,-2231.94 5389.31,-2181.97 5616.43,-2162.45"/>
<polygon fill="black" stroke="black" points="5616.98,-2165.92 5626.65,-2161.58 5616.38,-2158.95 5616.98,-2165.92"/>
<text text-anchor="middle" x="5230.5" y="-2201.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_0_1_1 -->
<g id="node9" class="node">
<title>proj_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4407,-2388 4263,-2388 4263,-2335 4407,-2335 4407,-2388"/>
<text text-anchor="middle" x="4335" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4335" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4335" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_0_1_1&#45;&gt;concat_dim_0_1 -->
<g id="edge6" class="edge">
<title>proj_0_1_1&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4359.98,-2334.72C4371.89,-2323.52 4386.84,-2310.94 4402,-2302 4412.62,-2295.74 4424.29,-2290.14 4436.05,-2285.22"/>
<polygon fill="black" stroke="black" points="4437.52,-2288.4 4445.49,-2281.42 4434.9,-2281.91 4437.52,-2288.4"/>
<text text-anchor="middle" x="4460" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_0_1_2 -->
<g id="node10" class="node">
<title>proj_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="4184,-2388 4040,-2388 4040,-2335 4184,-2335 4184,-2388"/>
<text text-anchor="middle" x="4112" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4112" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4112" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_0_1_2&#45;&gt;concat_dim_0_1 -->
<g id="edge7" class="edge">
<title>proj_0_1_2&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4169.07,-2334.85C4196.42,-2323.4 4229.93,-2310.59 4261,-2302 4318.18,-2286.2 4384.09,-2275.27 4435.37,-2268.32"/>
<polygon fill="black" stroke="black" points="4435.97,-2271.77 4445.42,-2266.98 4435.05,-2264.83 4435.97,-2271.77"/>
<text text-anchor="middle" x="4319" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_0_1_3 -->
<g id="node11" class="node">
<title>proj_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4781,-2388 4637,-2388 4637,-2335 4781,-2335 4781,-2388"/>
<text text-anchor="middle" x="4709" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4709" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4709" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_0_1_3&#45;&gt;concat_dim_0_1 -->
<g id="edge8" class="edge">
<title>proj_0_1_3&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4684.02,-2334.72C4672.11,-2323.52 4657.16,-2310.94 4642,-2302 4631.38,-2295.74 4619.71,-2290.14 4607.95,-2285.22"/>
<polygon fill="black" stroke="black" points="4609.1,-2281.91 4598.51,-2281.42 4606.48,-2288.4 4609.1,-2281.91"/>
<text text-anchor="middle" x="4720" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_0_2_0 -->
<g id="node12" class="node">
<title>proj_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7075,-2388 6931,-2388 6931,-2335 7075,-2335 7075,-2388"/>
<text text-anchor="middle" x="7003" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7003" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7003" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_0_2 -->
<g id="node13" class="node">
<title>concat_dim_0_2</title>
<polygon fill="lightsteelblue" stroke="black" points="7282.5,-2284 7129.5,-2284 7129.5,-2231 7282.5,-2231 7282.5,-2284"/>
<text text-anchor="middle" x="7206" y="-2268.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="7206" y="-2253.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="7206" y="-2238.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_0_2_0&#45;&gt;concat_dim_0_2 -->
<g id="edge9" class="edge">
<title>proj_0_2_0&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7035.23,-2334.76C7050.1,-2323.69 7068.34,-2311.21 7086,-2302 7096.77,-2296.38 7108.44,-2291.17 7120.12,-2286.45"/>
<polygon fill="black" stroke="black" points="7121.44,-2289.69 7129.47,-2282.78 7118.88,-2283.18 7121.44,-2289.69"/>
<text text-anchor="middle" x="7144" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_0 -->
<g id="edge19" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7129.45,-2251.28C6877.66,-2234.13 6075.71,-2179.49 5801.76,-2160.82"/>
<polygon fill="black" stroke="black" points="5801.68,-2157.31 5791.46,-2160.12 5801.2,-2164.29 5801.68,-2157.31"/>
<text text-anchor="middle" x="6591.5" y="-2201.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_0_2_1 -->
<g id="node14" class="node">
<title>proj_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7704,-2388 7560,-2388 7560,-2335 7704,-2335 7704,-2388"/>
<text text-anchor="middle" x="7632" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7632" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7632" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_0_2_1&#45;&gt;concat_dim_0_2 -->
<g id="edge10" class="edge">
<title>proj_0_2_1&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7576.47,-2334.98C7549.37,-2323.42 7516,-2310.47 7485,-2302 7421.78,-2284.73 7348.51,-2273.63 7292.92,-2266.97"/>
<polygon fill="black" stroke="black" points="7293.1,-2263.47 7282.76,-2265.78 7292.28,-2270.42 7293.1,-2263.47"/>
<text text-anchor="middle" x="7588" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_0_2_2 -->
<g id="node15" class="node">
<title>proj_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7481,-2388 7337,-2388 7337,-2335 7481,-2335 7481,-2388"/>
<text text-anchor="middle" x="7409" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7409" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7409" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_0_2_2&#45;&gt;concat_dim_0_2 -->
<g id="edge11" class="edge">
<title>proj_0_2_2&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7381.45,-2334.98C7368.17,-2323.7 7351.55,-2310.98 7335,-2302 7321.62,-2294.74 7306.81,-2288.38 7292.14,-2282.93"/>
<polygon fill="black" stroke="black" points="7293.12,-2279.57 7282.53,-2279.48 7290.76,-2286.15 7293.12,-2279.57"/>
<text text-anchor="middle" x="7418.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_0_2_3 -->
<g id="node16" class="node">
<title>proj_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7278,-2388 7134,-2388 7134,-2335 7278,-2335 7278,-2388"/>
<text text-anchor="middle" x="7206" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7206" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7206" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_0_2_3&#45;&gt;concat_dim_0_2 -->
<g id="edge12" class="edge">
<title>proj_0_2_3&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7206,-2334.76C7206,-2322.56 7206,-2307.78 7206,-2294.49"/>
<polygon fill="black" stroke="black" points="7209.5,-2294.23 7206,-2284.23 7202.5,-2294.23 7209.5,-2294.23"/>
<text text-anchor="middle" x="7268.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_0_3_0 -->
<g id="node17" class="node">
<title>proj_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6094,-2388 5950,-2388 5950,-2335 6094,-2335 6094,-2388"/>
<text text-anchor="middle" x="6022" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6022" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6022" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_0_3 -->
<g id="node18" class="node">
<title>concat_dim_0_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6306.5,-2284 6153.5,-2284 6153.5,-2231 6306.5,-2231 6306.5,-2284"/>
<text text-anchor="middle" x="6230" y="-2268.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6230" y="-2253.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="6230" y="-2238.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_0_3_0&#45;&gt;concat_dim_0_3 -->
<g id="edge13" class="edge">
<title>proj_0_3_0&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6052.04,-2334.78C6066.2,-2323.59 6083.75,-2311.01 6101,-2302 6114.4,-2295 6129.17,-2288.78 6143.77,-2283.39"/>
<polygon fill="black" stroke="black" points="6145.09,-2286.63 6153.33,-2279.97 6142.73,-2280.04 6145.09,-2286.63"/>
<text text-anchor="middle" x="6163.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_0 -->
<g id="edge20" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6153.4,-2241.5C6059.75,-2223.17 5901.35,-2192.16 5801.13,-2172.54"/>
<polygon fill="black" stroke="black" points="5801.5,-2169.04 5791.02,-2170.56 5800.16,-2175.91 5801.5,-2169.04"/>
<text text-anchor="middle" x="6044.5" y="-2201.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_0_3_1 -->
<g id="node19" class="node">
<title>proj_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6688,-2388 6544,-2388 6544,-2335 6688,-2335 6688,-2388"/>
<text text-anchor="middle" x="6616" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6616" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6616" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_0_3_1&#45;&gt;concat_dim_0_3 -->
<g id="edge14" class="edge">
<title>proj_0_3_1&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6576.86,-2334.83C6557.24,-2323.09 6532.65,-2310.04 6509,-2302 6446.62,-2280.81 6372.85,-2269.88 6316.84,-2264.28"/>
<polygon fill="black" stroke="black" points="6316.88,-2260.76 6306.59,-2263.29 6316.21,-2267.73 6316.88,-2260.76"/>
<text text-anchor="middle" x="6604.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_0_3_2 -->
<g id="node20" class="node">
<title>proj_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="6505,-2388 6361,-2388 6361,-2335 6505,-2335 6505,-2388"/>
<text text-anchor="middle" x="6433" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6433" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6433" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_0_3_2&#45;&gt;concat_dim_0_3 -->
<g id="edge15" class="edge">
<title>proj_0_3_2&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6405.45,-2334.98C6392.17,-2323.7 6375.55,-2310.98 6359,-2302 6345.62,-2294.74 6330.81,-2288.38 6316.14,-2282.93"/>
<polygon fill="black" stroke="black" points="6317.12,-2279.57 6306.53,-2279.48 6314.76,-2286.15 6317.12,-2279.57"/>
<text text-anchor="middle" x="6442.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_0_3_3 -->
<g id="node21" class="node">
<title>proj_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="6302,-2388 6158,-2388 6158,-2335 6302,-2335 6302,-2388"/>
<text text-anchor="middle" x="6230" y="-2372.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6230" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6230" y="-2342.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_0_3_3&#45;&gt;concat_dim_0_3 -->
<g id="edge16" class="edge">
<title>proj_0_3_3&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6230,-2334.76C6230,-2322.56 6230,-2307.78 6230,-2294.49"/>
<polygon fill="black" stroke="black" points="6233.5,-2294.23 6230,-2284.23 6226.5,-2294.23 6233.5,-2294.23"/>
<text text-anchor="middle" x="6292.5" y="-2305.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- mlp_col_0_0 -->
<g id="node23" class="node">
<title>mlp_col_0_0</title>
<polygon fill="lightblue" stroke="black" points="3623.5,-2568 3456.5,-2568 3456.5,-2515 3623.5,-2515 3623.5,-2568"/>
<text text-anchor="middle" x="3540" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3540" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3540" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_0_0 -->
<g id="node24" class="node">
<title>gelu_0_0</title>
<polygon fill="lightblue" stroke="black" points="3540.5,-2478 3387.5,-2478 3387.5,-2425 3540.5,-2425 3540.5,-2478"/>
<text text-anchor="middle" x="3464" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3464" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3464" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- mlp_col_0_0&#45;&gt;gelu_0_0 -->
<g id="edge21" class="edge">
<title>mlp_col_0_0&#45;&gt;gelu_0_0</title>
<path fill="none" stroke="black" d="M3517.61,-2514.57C3509.88,-2505.62 3501.1,-2495.46 3492.93,-2485.99"/>
<polygon fill="black" stroke="black" points="3495.42,-2483.52 3486.23,-2478.24 3490.12,-2488.1 3495.42,-2483.52"/>
</g>
<!-- mlp_row_0_0 -->
<g id="node39" class="node">
<title>mlp_row_0_0</title>
<polygon fill="lightblue" stroke="black" points="3540.5,-2388 3387.5,-2388 3387.5,-2335 3540.5,-2335 3540.5,-2388"/>
<text text-anchor="middle" x="3464" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3464" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3464" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_0_0&#45;&gt;mlp_row_0_0 -->
<g id="edge29" class="edge">
<title>gelu_0_0&#45;&gt;mlp_row_0_0</title>
<path fill="none" stroke="black" d="M3464,-2424.57C3464,-2416.34 3464,-2407.08 3464,-2398.28"/>
<polygon fill="black" stroke="black" points="3467.5,-2398.24 3464,-2388.24 3460.5,-2398.24 3467.5,-2398.24"/>
</g>
<!-- mlp_col_0_1 -->
<g id="node25" class="node">
<title>mlp_col_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3808.5,-2568 3641.5,-2568 3641.5,-2515 3808.5,-2515 3808.5,-2568"/>
<text text-anchor="middle" x="3725" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3725" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3725" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_0_1 -->
<g id="node26" class="node">
<title>gelu_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3711.5,-2478 3558.5,-2478 3558.5,-2425 3711.5,-2425 3711.5,-2478"/>
<text text-anchor="middle" x="3635" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3635" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3635" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- mlp_col_0_1&#45;&gt;gelu_0_1 -->
<g id="edge22" class="edge">
<title>mlp_col_0_1&#45;&gt;gelu_0_1</title>
<path fill="none" stroke="black" d="M3698.48,-2514.57C3689.15,-2505.44 3678.52,-2495.06 3668.67,-2485.43"/>
<polygon fill="black" stroke="black" points="3670.92,-2482.73 3661.33,-2478.24 3666.03,-2487.74 3670.92,-2482.73"/>
</g>
<!-- mlp_row_0_1 -->
<g id="node40" class="node">
<title>mlp_row_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3711.5,-2388 3558.5,-2388 3558.5,-2335 3711.5,-2335 3711.5,-2388"/>
<text text-anchor="middle" x="3635" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3635" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3635" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_0_1&#45;&gt;mlp_row_0_1 -->
<g id="edge30" class="edge">
<title>gelu_0_1&#45;&gt;mlp_row_0_1</title>
<path fill="none" stroke="black" d="M3635,-2424.57C3635,-2416.34 3635,-2407.08 3635,-2398.28"/>
<polygon fill="black" stroke="black" points="3638.5,-2398.24 3635,-2388.24 3631.5,-2398.24 3638.5,-2398.24"/>
</g>
<!-- mlp_col_0_2 -->
<g id="node27" class="node">
<title>mlp_col_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3993.5,-2568 3826.5,-2568 3826.5,-2515 3993.5,-2515 3993.5,-2568"/>
<text text-anchor="middle" x="3910" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3910" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3910" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_0_2 -->
<g id="node28" class="node">
<title>gelu_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3882.5,-2478 3729.5,-2478 3729.5,-2425 3882.5,-2425 3882.5,-2478"/>
<text text-anchor="middle" x="3806" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3806" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3806" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- mlp_col_0_2&#45;&gt;gelu_0_2 -->
<g id="edge23" class="edge">
<title>mlp_col_0_2&#45;&gt;gelu_0_2</title>
<path fill="none" stroke="black" d="M3879.64,-2514.81C3868.53,-2505.41 3855.82,-2494.66 3844.12,-2484.76"/>
<polygon fill="black" stroke="black" points="3846.11,-2481.86 3836.22,-2478.07 3841.59,-2487.2 3846.11,-2481.86"/>
</g>
<!-- mlp_row_0_2 -->
<g id="node41" class="node">
<title>mlp_row_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3882.5,-2388 3729.5,-2388 3729.5,-2335 3882.5,-2335 3882.5,-2388"/>
<text text-anchor="middle" x="3806" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3806" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3806" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_0_2&#45;&gt;mlp_row_0_2 -->
<g id="edge31" class="edge">
<title>gelu_0_2&#45;&gt;mlp_row_0_2</title>
<path fill="none" stroke="black" d="M3806,-2424.57C3806,-2416.34 3806,-2407.08 3806,-2398.28"/>
<polygon fill="black" stroke="black" points="3809.5,-2398.24 3806,-2388.24 3802.5,-2398.24 3809.5,-2398.24"/>
</g>
<!-- mlp_col_0_3 -->
<g id="node29" class="node">
<title>mlp_col_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2698.5,-2568 2531.5,-2568 2531.5,-2515 2698.5,-2515 2698.5,-2568"/>
<text text-anchor="middle" x="2615" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2615" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2615" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_0_3 -->
<g id="node30" class="node">
<title>gelu_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2685.5,-2478 2532.5,-2478 2532.5,-2425 2685.5,-2425 2685.5,-2478"/>
<text text-anchor="middle" x="2609" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2609" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2609" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- mlp_col_0_3&#45;&gt;gelu_0_3 -->
<g id="edge24" class="edge">
<title>mlp_col_0_3&#45;&gt;gelu_0_3</title>
<path fill="none" stroke="black" d="M2613.23,-2514.57C2612.67,-2506.34 2612.04,-2497.08 2611.44,-2488.28"/>
<polygon fill="black" stroke="black" points="2614.93,-2487.98 2610.76,-2478.24 2607.94,-2488.46 2614.93,-2487.98"/>
</g>
<!-- mlp_row_0_3 -->
<g id="node42" class="node">
<title>mlp_row_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2685.5,-2388 2532.5,-2388 2532.5,-2335 2685.5,-2335 2685.5,-2388"/>
<text text-anchor="middle" x="2609" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2609" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2609" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_0_3&#45;&gt;mlp_row_0_3 -->
<g id="edge32" class="edge">
<title>gelu_0_3&#45;&gt;mlp_row_0_3</title>
<path fill="none" stroke="black" d="M2609,-2424.57C2609,-2416.34 2609,-2407.08 2609,-2398.28"/>
<polygon fill="black" stroke="black" points="2612.5,-2398.24 2609,-2388.24 2605.5,-2398.24 2612.5,-2398.24"/>
</g>
<!-- mlp_col_0_4 -->
<g id="node31" class="node">
<title>mlp_col_0_4</title>
<polygon fill="lightpink" stroke="black" points="2883.5,-2568 2716.5,-2568 2716.5,-2515 2883.5,-2515 2883.5,-2568"/>
<text text-anchor="middle" x="2800" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2800" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2800" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_0_4 -->
<g id="node32" class="node">
<title>gelu_0_4</title>
<polygon fill="lightpink" stroke="black" points="2856.5,-2478 2703.5,-2478 2703.5,-2425 2856.5,-2425 2856.5,-2478"/>
<text text-anchor="middle" x="2780" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2780" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2780" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- mlp_col_0_4&#45;&gt;gelu_0_4 -->
<g id="edge25" class="edge">
<title>mlp_col_0_4&#45;&gt;gelu_0_4</title>
<path fill="none" stroke="black" d="M2794.11,-2514.57C2792.24,-2506.34 2790.13,-2497.08 2788.13,-2488.28"/>
<polygon fill="black" stroke="black" points="2791.48,-2487.22 2785.85,-2478.24 2784.65,-2488.77 2791.48,-2487.22"/>
</g>
<!-- mlp_row_0_4 -->
<g id="node43" class="node">
<title>mlp_row_0_4</title>
<polygon fill="lightpink" stroke="black" points="2856.5,-2388 2703.5,-2388 2703.5,-2335 2856.5,-2335 2856.5,-2388"/>
<text text-anchor="middle" x="2780" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2780" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2780" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_0_4&#45;&gt;mlp_row_0_4 -->
<g id="edge33" class="edge">
<title>gelu_0_4&#45;&gt;mlp_row_0_4</title>
<path fill="none" stroke="black" d="M2780,-2424.57C2780,-2416.34 2780,-2407.08 2780,-2398.28"/>
<polygon fill="black" stroke="black" points="2783.5,-2398.24 2780,-2388.24 2776.5,-2398.24 2783.5,-2398.24"/>
</g>
<!-- mlp_col_0_5 -->
<g id="node33" class="node">
<title>mlp_col_0_5</title>
<polygon fill="lightcyan" stroke="black" points="3068.5,-2568 2901.5,-2568 2901.5,-2515 3068.5,-2515 3068.5,-2568"/>
<text text-anchor="middle" x="2985" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2985" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2985" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_0_5 -->
<g id="node34" class="node">
<title>gelu_0_5</title>
<polygon fill="lightcyan" stroke="black" points="3027.5,-2478 2874.5,-2478 2874.5,-2425 3027.5,-2425 3027.5,-2478"/>
<text text-anchor="middle" x="2951" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2951" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2951" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- mlp_col_0_5&#45;&gt;gelu_0_5 -->
<g id="edge26" class="edge">
<title>mlp_col_0_5&#45;&gt;gelu_0_5</title>
<path fill="none" stroke="black" d="M2974.98,-2514.57C2971.73,-2506.16 2968.07,-2496.68 2964.6,-2487.7"/>
<polygon fill="black" stroke="black" points="2967.81,-2486.31 2960.95,-2478.24 2961.28,-2488.83 2967.81,-2486.31"/>
</g>
<!-- mlp_row_0_5 -->
<g id="node44" class="node">
<title>mlp_row_0_5</title>
<polygon fill="lightcyan" stroke="black" points="3027.5,-2388 2874.5,-2388 2874.5,-2335 3027.5,-2335 3027.5,-2388"/>
<text text-anchor="middle" x="2951" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2951" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2951" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_0_5&#45;&gt;mlp_row_0_5 -->
<g id="edge34" class="edge">
<title>gelu_0_5&#45;&gt;mlp_row_0_5</title>
<path fill="none" stroke="black" d="M2951,-2424.57C2951,-2416.34 2951,-2407.08 2951,-2398.28"/>
<polygon fill="black" stroke="black" points="2954.5,-2398.24 2951,-2388.24 2947.5,-2398.24 2954.5,-2398.24"/>
</g>
<!-- mlp_col_0_6 -->
<g id="node35" class="node">
<title>mlp_col_0_6</title>
<polygon fill="lightgrey" stroke="black" points="3253.5,-2568 3086.5,-2568 3086.5,-2515 3253.5,-2515 3253.5,-2568"/>
<text text-anchor="middle" x="3170" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3170" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3170" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_0_6 -->
<g id="node36" class="node">
<title>gelu_0_6</title>
<polygon fill="lightgrey" stroke="black" points="3198.5,-2478 3045.5,-2478 3045.5,-2425 3198.5,-2425 3198.5,-2478"/>
<text text-anchor="middle" x="3122" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3122" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3122" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- mlp_col_0_6&#45;&gt;gelu_0_6 -->
<g id="edge27" class="edge">
<title>mlp_col_0_6&#45;&gt;gelu_0_6</title>
<path fill="none" stroke="black" d="M3155.86,-2514.57C3151.17,-2505.98 3145.88,-2496.27 3140.89,-2487.13"/>
<polygon fill="black" stroke="black" points="3143.9,-2485.34 3136.04,-2478.24 3137.76,-2488.7 3143.9,-2485.34"/>
</g>
<!-- mlp_row_0_6 -->
<g id="node45" class="node">
<title>mlp_row_0_6</title>
<polygon fill="lightgrey" stroke="black" points="3198.5,-2388 3045.5,-2388 3045.5,-2335 3198.5,-2335 3198.5,-2388"/>
<text text-anchor="middle" x="3122" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3122" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3122" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_0_6&#45;&gt;mlp_row_0_6 -->
<g id="edge35" class="edge">
<title>gelu_0_6&#45;&gt;mlp_row_0_6</title>
<path fill="none" stroke="black" d="M3122,-2424.57C3122,-2416.34 3122,-2407.08 3122,-2398.28"/>
<polygon fill="black" stroke="black" points="3125.5,-2398.24 3122,-2388.24 3118.5,-2398.24 3125.5,-2398.24"/>
</g>
<!-- mlp_col_0_7 -->
<g id="node37" class="node">
<title>mlp_col_0_7</title>
<polygon fill="lightseagreen" stroke="black" points="3438.5,-2568 3271.5,-2568 3271.5,-2515 3438.5,-2515 3438.5,-2568"/>
<text text-anchor="middle" x="3355" y="-2552.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3355" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3355" y="-2522.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_0_7 -->
<g id="node38" class="node">
<title>gelu_0_7</title>
<polygon fill="lightseagreen" stroke="black" points="3369.5,-2478 3216.5,-2478 3216.5,-2425 3369.5,-2425 3369.5,-2478"/>
<text text-anchor="middle" x="3293" y="-2462.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3293" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3293" y="-2432.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- mlp_col_0_7&#45;&gt;gelu_0_7 -->
<g id="edge28" class="edge">
<title>mlp_col_0_7&#45;&gt;gelu_0_7</title>
<path fill="none" stroke="black" d="M3336.73,-2514.57C3330.55,-2505.8 3323.55,-2495.87 3317,-2486.56"/>
<polygon fill="black" stroke="black" points="3319.76,-2484.4 3311.14,-2478.24 3314.03,-2488.43 3319.76,-2484.4"/>
</g>
<!-- mlp_row_0_7 -->
<g id="node46" class="node">
<title>mlp_row_0_7</title>
<polygon fill="lightseagreen" stroke="black" points="3369.5,-2388 3216.5,-2388 3216.5,-2335 3369.5,-2335 3369.5,-2388"/>
<text text-anchor="middle" x="3293" y="-2372.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3293" y="-2357.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3293" y="-2342.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_0_7&#45;&gt;mlp_row_0_7 -->
<g id="edge36" class="edge">
<title>gelu_0_7&#45;&gt;mlp_row_0_7</title>
<path fill="none" stroke="black" d="M3293,-2424.57C3293,-2416.34 3293,-2407.08 3293,-2398.28"/>
<polygon fill="black" stroke="black" points="3296.5,-2398.24 3293,-2388.24 3289.5,-2398.24 3296.5,-2398.24"/>
</g>
<!-- mlp_allreduce_0 -->
<g id="node47" class="node">
<title>mlp_allreduce_0</title>
<polygon fill="yellow" stroke="black" points="3369.5,-2284 3216.5,-2284 3216.5,-2231 3369.5,-2231 3369.5,-2284"/>
<text text-anchor="middle" x="3293" y="-2268.8" font-family="Times,serif" font-size="14.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="3293" y="-2253.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3293" y="-2238.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_row_0_0&#45;&gt;mlp_allreduce_0 -->
<g id="edge37" class="edge">
<title>mlp_row_0_0&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3420.85,-2334.76C3397.67,-2320.94 3368.95,-2303.8 3344.59,-2289.28"/>
<polygon fill="black" stroke="black" points="3346.22,-2286.17 3335.84,-2284.05 3342.64,-2292.18 3346.22,-2286.17"/>
</g>
<!-- mlp_row_0_1&#45;&gt;mlp_allreduce_0 -->
<g id="edge38" class="edge">
<title>mlp_row_0_1&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3558.09,-2337.42C3555.36,-2336.6 3552.66,-2335.79 3550,-2335 3493.23,-2318.04 3429.39,-2299.03 3379.54,-2284.21"/>
<polygon fill="black" stroke="black" points="3380.35,-2280.8 3369.76,-2281.3 3378.35,-2287.51 3380.35,-2280.8"/>
</g>
<!-- mlp_row_0_2&#45;&gt;mlp_allreduce_0 -->
<g id="edge39" class="edge">
<title>mlp_row_0_2&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3729.2,-2337.03C3726.44,-2336.32 3723.7,-2335.64 3721,-2335 3603.94,-2307.08 3466.67,-2284.26 3379.78,-2271.02"/>
<polygon fill="black" stroke="black" points="3380.11,-2267.53 3369.7,-2269.5 3379.06,-2274.45 3380.11,-2267.53"/>
</g>
<!-- mlp_row_0_3&#45;&gt;mlp_allreduce_0 -->
<g id="edge40" class="edge">
<title>mlp_row_0_3&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2685.74,-2337.08C2688.86,-2336.34 2691.95,-2335.64 2695,-2335 2874.87,-2297.09 3089.4,-2275.19 3206.38,-2265.17"/>
<polygon fill="black" stroke="black" points="3206.68,-2268.66 3216.35,-2264.33 3206.09,-2261.69 3206.68,-2268.66"/>
</g>
<!-- mlp_row_0_4&#45;&gt;mlp_allreduce_0 -->
<g id="edge41" class="edge">
<title>mlp_row_0_4&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2856.78,-2337.27C2859.89,-2336.48 2862.97,-2335.72 2866,-2335 2982.84,-2307.3 3119.77,-2284.43 3206.44,-2271.12"/>
<polygon fill="black" stroke="black" points="3207.14,-2274.55 3216.5,-2269.58 3206.08,-2267.63 3207.14,-2274.55"/>
</g>
<!-- mlp_row_0_5&#45;&gt;mlp_allreduce_0 -->
<g id="edge42" class="edge">
<title>mlp_row_0_5&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3027.75,-2337.61C3080.79,-2321.79 3151.43,-2300.72 3206.47,-2284.31"/>
<polygon fill="black" stroke="black" points="3207.63,-2287.61 3216.21,-2281.4 3205.63,-2280.91 3207.63,-2287.61"/>
</g>
<!-- mlp_row_0_6&#45;&gt;mlp_allreduce_0 -->
<g id="edge43" class="edge">
<title>mlp_row_0_6&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3165.15,-2334.76C3188.33,-2320.94 3217.05,-2303.8 3241.41,-2289.28"/>
<polygon fill="black" stroke="black" points="3243.36,-2292.18 3250.16,-2284.05 3239.78,-2286.17 3243.36,-2292.18"/>
</g>
<!-- mlp_row_0_7&#45;&gt;mlp_allreduce_0 -->
<g id="edge44" class="edge">
<title>mlp_row_0_7&#45;&gt;mlp_allreduce_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3293,-2334.76C3293,-2322.56 3293,-2307.78 3293,-2294.49"/>
<polygon fill="black" stroke="black" points="3296.5,-2294.23 3293,-2284.23 3289.5,-2294.23 3296.5,-2294.23"/>
</g>
<!-- residual2_0 -->
<g id="node99" class="node">
<title>residual2_0</title>
<polygon fill="orange" stroke="black" points="3674.5,-2180 3521.5,-2180 3521.5,-2127 3674.5,-2127 3674.5,-2180"/>
<text text-anchor="middle" x="3598" y="-2164.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3598" y="-2149.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3598" y="-2134.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_allreduce_0&#45;&gt;residual2_0 -->
<g id="edge236" class="edge">
<title>mlp_allreduce_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M3369.57,-2230.89C3412.89,-2216.41 3467.18,-2198.25 3511.97,-2183.27"/>
<polygon fill="black" stroke="black" points="3513.29,-2186.52 3521.66,-2180.03 3511.07,-2179.88 3513.29,-2186.52"/>
</g>
<!-- qkv_0_0_0 -->
<g id="node49" class="node">
<title>qkv_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="5781.5,-2658 5628.5,-2658 5628.5,-2605 5781.5,-2605 5781.5,-2658"/>
<text text-anchor="middle" x="5705" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5705" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5705" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_0_0 -->
<g id="edge178" class="edge">
<title>ln1_0&#45;&gt;qkv_0_0_0</title>
<path fill="none" stroke="black" d="M5002.58,-2716.04C5125.65,-2708.25 5374.84,-2689.87 5584,-2658 5595.16,-2656.3 5606.85,-2654.22 5618.36,-2651.99"/>
<polygon fill="black" stroke="black" points="5619.3,-2655.38 5628.43,-2650 5617.94,-2648.51 5619.3,-2655.38"/>
</g>
<!-- reshape_0_0_0 -->
<g id="node50" class="node">
<title>reshape_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="5796,-2568 5634,-2568 5634,-2515 5796,-2515 5796,-2568"/>
<text text-anchor="middle" x="5715" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5715" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5715" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_0_0_0&#45;&gt;reshape_0_0_0 -->
<g id="edge179" class="edge">
<title>qkv_0_0_0&#45;&gt;reshape_0_0_0</title>
<path fill="none" stroke="black" d="M5707.95,-2604.57C5708.88,-2596.34 5709.93,-2587.08 5710.93,-2578.28"/>
<polygon fill="black" stroke="black" points="5714.42,-2578.57 5712.07,-2568.24 5707.47,-2577.78 5714.42,-2578.57"/>
</g>
<!-- attn_0_0_0 -->
<g id="node51" class="node">
<title>attn_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="5855,-2478 5629,-2478 5629,-2425 5855,-2425 5855,-2478"/>
<text text-anchor="middle" x="5742" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5742" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5742" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge180" class="edge">
<title>reshape_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="black" d="M5722.95,-2514.57C5725.51,-2506.25 5728.38,-2496.88 5731.11,-2487.99"/>
<polygon fill="black" stroke="black" points="5734.51,-2488.83 5734.1,-2478.24 5727.82,-2486.78 5734.51,-2488.83"/>
</g>
<!-- attn_0_0_0&#45;&gt;proj_0_0_0 -->
<g id="edge181" class="edge">
<title>attn_0_0_0&#45;&gt;proj_0_0_0</title>
<path fill="none" stroke="black" d="M5725.21,-2424.57C5719.58,-2415.89 5713.22,-2406.07 5707.25,-2396.85"/>
<polygon fill="black" stroke="black" points="5710.05,-2394.73 5701.67,-2388.24 5704.17,-2398.54 5710.05,-2394.73"/>
</g>
<!-- qkv_0_0_1 -->
<g id="node52" class="node">
<title>qkv_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5574.5,-2658 5421.5,-2658 5421.5,-2605 5574.5,-2605 5574.5,-2658"/>
<text text-anchor="middle" x="5498" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5498" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5498" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_0_0_1 -->
<g id="node53" class="node">
<title>reshape_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5579,-2568 5417,-2568 5417,-2515 5579,-2515 5579,-2568"/>
<text text-anchor="middle" x="5498" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5498" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5498" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_0_0_1&#45;&gt;reshape_0_0_1 -->
<g id="edge182" class="edge">
<title>qkv_0_0_1&#45;&gt;reshape_0_0_1</title>
<path fill="none" stroke="black" d="M5498,-2604.57C5498,-2596.34 5498,-2587.08 5498,-2578.28"/>
<polygon fill="black" stroke="black" points="5501.5,-2578.24 5498,-2568.24 5494.5,-2578.24 5501.5,-2578.24"/>
</g>
<!-- attn_0_0_1 -->
<g id="node54" class="node">
<title>attn_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5611,-2478 5385,-2478 5385,-2425 5611,-2425 5611,-2478"/>
<text text-anchor="middle" x="5498" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5498" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5498" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge183" class="edge">
<title>reshape_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="black" d="M5498,-2514.57C5498,-2506.34 5498,-2497.08 5498,-2488.28"/>
<polygon fill="black" stroke="black" points="5501.5,-2488.24 5498,-2478.24 5494.5,-2488.24 5501.5,-2488.24"/>
</g>
<!-- attn_0_0_1&#45;&gt;proj_0_0_1 -->
<g id="edge184" class="edge">
<title>attn_0_0_1&#45;&gt;proj_0_0_1</title>
<path fill="none" stroke="black" d="M5498,-2424.57C5498,-2416.34 5498,-2407.08 5498,-2398.28"/>
<polygon fill="black" stroke="black" points="5501.5,-2398.24 5498,-2388.24 5494.5,-2398.24 5501.5,-2398.24"/>
</g>
<!-- qkv_0_0_2 -->
<g id="node55" class="node">
<title>qkv_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="5330.5,-2658 5177.5,-2658 5177.5,-2605 5330.5,-2605 5330.5,-2658"/>
<text text-anchor="middle" x="5254" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5254" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5254" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_0_0_2 -->
<g id="node56" class="node">
<title>reshape_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="5335,-2568 5173,-2568 5173,-2515 5335,-2515 5335,-2568"/>
<text text-anchor="middle" x="5254" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5254" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5254" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_0_0_2&#45;&gt;reshape_0_0_2 -->
<g id="edge185" class="edge">
<title>qkv_0_0_2&#45;&gt;reshape_0_0_2</title>
<path fill="none" stroke="black" d="M5254,-2604.57C5254,-2596.34 5254,-2587.08 5254,-2578.28"/>
<polygon fill="black" stroke="black" points="5257.5,-2578.24 5254,-2568.24 5250.5,-2578.24 5257.5,-2578.24"/>
</g>
<!-- attn_0_0_2 -->
<g id="node57" class="node">
<title>attn_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="5367,-2478 5141,-2478 5141,-2425 5367,-2425 5367,-2478"/>
<text text-anchor="middle" x="5254" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5254" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5254" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge186" class="edge">
<title>reshape_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="black" d="M5254,-2514.57C5254,-2506.34 5254,-2497.08 5254,-2488.28"/>
<polygon fill="black" stroke="black" points="5257.5,-2488.24 5254,-2478.24 5250.5,-2488.24 5257.5,-2488.24"/>
</g>
<!-- attn_0_0_2&#45;&gt;proj_0_0_2 -->
<g id="edge187" class="edge">
<title>attn_0_0_2&#45;&gt;proj_0_0_2</title>
<path fill="none" stroke="black" d="M5272.27,-2424.57C5278.45,-2415.8 5285.45,-2405.87 5292,-2396.56"/>
<polygon fill="black" stroke="black" points="5294.97,-2398.43 5297.86,-2388.24 5289.24,-2394.4 5294.97,-2398.43"/>
</g>
<!-- qkv_0_0_3 -->
<g id="node58" class="node">
<title>qkv_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5086.5,-2658 4933.5,-2658 4933.5,-2605 5086.5,-2605 5086.5,-2658"/>
<text text-anchor="middle" x="5010" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5010" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5010" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_0_0_3 -->
<g id="node59" class="node">
<title>reshape_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5091,-2568 4929,-2568 4929,-2515 5091,-2515 5091,-2568"/>
<text text-anchor="middle" x="5010" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5010" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5010" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_0_0_3&#45;&gt;reshape_0_0_3 -->
<g id="edge188" class="edge">
<title>qkv_0_0_3&#45;&gt;reshape_0_0_3</title>
<path fill="none" stroke="black" d="M5010,-2604.57C5010,-2596.34 5010,-2587.08 5010,-2578.28"/>
<polygon fill="black" stroke="black" points="5013.5,-2578.24 5010,-2568.24 5006.5,-2578.24 5013.5,-2578.24"/>
</g>
<!-- attn_0_0_3 -->
<g id="node60" class="node">
<title>attn_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5123,-2478 4897,-2478 4897,-2425 5123,-2425 5123,-2478"/>
<text text-anchor="middle" x="5010" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5010" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5010" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge189" class="edge">
<title>reshape_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="black" d="M5010,-2514.57C5010,-2506.34 5010,-2497.08 5010,-2488.28"/>
<polygon fill="black" stroke="black" points="5013.5,-2488.24 5010,-2478.24 5006.5,-2488.24 5013.5,-2488.24"/>
</g>
<!-- attn_0_0_3&#45;&gt;proj_0_0_3 -->
<g id="edge190" class="edge">
<title>attn_0_0_3&#45;&gt;proj_0_0_3</title>
<path fill="none" stroke="black" d="M5040.07,-2424.81C5051.07,-2415.41 5063.66,-2404.66 5075.24,-2394.76"/>
<polygon fill="black" stroke="black" points="5077.74,-2397.23 5083.07,-2388.07 5073.2,-2391.9 5077.74,-2397.23"/>
</g>
<!-- qkv_0_1_0 -->
<g id="node61" class="node">
<title>qkv_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="4598.5,-2658 4445.5,-2658 4445.5,-2605 4598.5,-2605 4598.5,-2658"/>
<text text-anchor="middle" x="4522" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4522" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4522" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_0_1_0 -->
<g id="node62" class="node">
<title>reshape_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="4603,-2568 4441,-2568 4441,-2515 4603,-2515 4603,-2568"/>
<text text-anchor="middle" x="4522" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4522" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4522" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_0_1_0&#45;&gt;reshape_0_1_0 -->
<g id="edge191" class="edge">
<title>qkv_0_1_0&#45;&gt;reshape_0_1_0</title>
<path fill="none" stroke="black" d="M4522,-2604.57C4522,-2596.34 4522,-2587.08 4522,-2578.28"/>
<polygon fill="black" stroke="black" points="4525.5,-2578.24 4522,-2568.24 4518.5,-2578.24 4525.5,-2578.24"/>
</g>
<!-- attn_0_1_0 -->
<g id="node63" class="node">
<title>attn_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="4635,-2478 4409,-2478 4409,-2425 4635,-2425 4635,-2478"/>
<text text-anchor="middle" x="4522" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4522" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4522" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge192" class="edge">
<title>reshape_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="black" d="M4522,-2514.57C4522,-2506.34 4522,-2497.08 4522,-2488.28"/>
<polygon fill="black" stroke="black" points="4525.5,-2488.24 4522,-2478.24 4518.5,-2488.24 4525.5,-2488.24"/>
</g>
<!-- attn_0_1_0&#45;&gt;proj_0_1_0 -->
<g id="edge193" class="edge">
<title>attn_0_1_0&#45;&gt;proj_0_1_0</title>
<path fill="none" stroke="black" d="M4522,-2424.57C4522,-2416.34 4522,-2407.08 4522,-2398.28"/>
<polygon fill="black" stroke="black" points="4525.5,-2398.24 4522,-2388.24 4518.5,-2398.24 4525.5,-2398.24"/>
</g>
<!-- qkv_0_1_1 -->
<g id="node64" class="node">
<title>qkv_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4368.5,-2658 4215.5,-2658 4215.5,-2605 4368.5,-2605 4368.5,-2658"/>
<text text-anchor="middle" x="4292" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4292" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4292" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_0_1_1 -->
<g id="node65" class="node">
<title>reshape_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4373,-2568 4211,-2568 4211,-2515 4373,-2515 4373,-2568"/>
<text text-anchor="middle" x="4292" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4292" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4292" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_0_1_1&#45;&gt;reshape_0_1_1 -->
<g id="edge194" class="edge">
<title>qkv_0_1_1&#45;&gt;reshape_0_1_1</title>
<path fill="none" stroke="black" d="M4292,-2604.57C4292,-2596.34 4292,-2587.08 4292,-2578.28"/>
<polygon fill="black" stroke="black" points="4295.5,-2578.24 4292,-2568.24 4288.5,-2578.24 4295.5,-2578.24"/>
</g>
<!-- attn_0_1_1 -->
<g id="node66" class="node">
<title>attn_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4391,-2478 4165,-2478 4165,-2425 4391,-2425 4391,-2478"/>
<text text-anchor="middle" x="4278" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4278" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4278" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge195" class="edge">
<title>reshape_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="black" d="M4287.88,-2514.57C4286.57,-2506.34 4285.09,-2497.08 4283.69,-2488.28"/>
<polygon fill="black" stroke="black" points="4287.12,-2487.57 4282.1,-2478.24 4280.21,-2488.67 4287.12,-2487.57"/>
</g>
<!-- attn_0_1_1&#45;&gt;proj_0_1_1 -->
<g id="edge196" class="edge">
<title>attn_0_1_1&#45;&gt;proj_0_1_1</title>
<path fill="none" stroke="black" d="M4294.79,-2424.57C4300.42,-2415.89 4306.78,-2406.07 4312.75,-2396.85"/>
<polygon fill="black" stroke="black" points="4315.83,-2398.54 4318.33,-2388.24 4309.95,-2394.73 4315.83,-2398.54"/>
</g>
<!-- qkv_0_1_2 -->
<g id="node67" class="node">
<title>qkv_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="4188.5,-2658 4035.5,-2658 4035.5,-2605 4188.5,-2605 4188.5,-2658"/>
<text text-anchor="middle" x="4112" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4112" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4112" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_0_1_2 -->
<g id="node68" class="node">
<title>reshape_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="4193,-2568 4031,-2568 4031,-2515 4193,-2515 4193,-2568"/>
<text text-anchor="middle" x="4112" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4112" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4112" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_0_1_2&#45;&gt;reshape_0_1_2 -->
<g id="edge197" class="edge">
<title>qkv_0_1_2&#45;&gt;reshape_0_1_2</title>
<path fill="none" stroke="black" d="M4112,-2604.57C4112,-2596.34 4112,-2587.08 4112,-2578.28"/>
<polygon fill="black" stroke="black" points="4115.5,-2578.24 4112,-2568.24 4108.5,-2578.24 4115.5,-2578.24"/>
</g>
<!-- attn_0_1_2 -->
<g id="node69" class="node">
<title>attn_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="4147,-2478 3921,-2478 3921,-2425 4147,-2425 4147,-2478"/>
<text text-anchor="middle" x="4034" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4034" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4034" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge198" class="edge">
<title>reshape_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="black" d="M4089.02,-2514.57C4081.09,-2505.62 4072.08,-2495.46 4063.69,-2485.99"/>
<polygon fill="black" stroke="black" points="4066.07,-2483.4 4056.82,-2478.24 4060.83,-2488.05 4066.07,-2483.4"/>
</g>
<!-- attn_0_1_2&#45;&gt;proj_0_1_2 -->
<g id="edge199" class="edge">
<title>attn_0_1_2&#45;&gt;proj_0_1_2</title>
<path fill="none" stroke="black" d="M4056.98,-2424.57C4064.91,-2415.62 4073.92,-2405.46 4082.31,-2395.99"/>
<polygon fill="black" stroke="black" points="4085.17,-2398.05 4089.18,-2388.24 4079.93,-2393.4 4085.17,-2398.05"/>
</g>
<!-- qkv_0_1_3 -->
<g id="node70" class="node">
<title>qkv_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4842.5,-2658 4689.5,-2658 4689.5,-2605 4842.5,-2605 4842.5,-2658"/>
<text text-anchor="middle" x="4766" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4766" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4766" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_0_1_3 -->
<g id="node71" class="node">
<title>reshape_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4847,-2568 4685,-2568 4685,-2515 4847,-2515 4847,-2568"/>
<text text-anchor="middle" x="4766" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4766" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4766" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_0_1_3&#45;&gt;reshape_0_1_3 -->
<g id="edge200" class="edge">
<title>qkv_0_1_3&#45;&gt;reshape_0_1_3</title>
<path fill="none" stroke="black" d="M4766,-2604.57C4766,-2596.34 4766,-2587.08 4766,-2578.28"/>
<polygon fill="black" stroke="black" points="4769.5,-2578.24 4766,-2568.24 4762.5,-2578.24 4769.5,-2578.24"/>
</g>
<!-- attn_0_1_3 -->
<g id="node72" class="node">
<title>attn_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4879,-2478 4653,-2478 4653,-2425 4879,-2425 4879,-2478"/>
<text text-anchor="middle" x="4766" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4766" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4766" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge201" class="edge">
<title>reshape_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="black" d="M4766,-2514.57C4766,-2506.34 4766,-2497.08 4766,-2488.28"/>
<polygon fill="black" stroke="black" points="4769.5,-2488.24 4766,-2478.24 4762.5,-2488.24 4769.5,-2488.24"/>
</g>
<!-- attn_0_1_3&#45;&gt;proj_0_1_3 -->
<g id="edge202" class="edge">
<title>attn_0_1_3&#45;&gt;proj_0_1_3</title>
<path fill="none" stroke="black" d="M4749.21,-2424.57C4743.58,-2415.89 4737.22,-2406.07 4731.25,-2396.85"/>
<polygon fill="black" stroke="black" points="4734.05,-2394.73 4725.67,-2388.24 4728.17,-2398.54 4734.05,-2394.73"/>
</g>
<!-- qkv_0_2_0 -->
<g id="node73" class="node">
<title>qkv_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7038.5,-2658 6885.5,-2658 6885.5,-2605 7038.5,-2605 7038.5,-2658"/>
<text text-anchor="middle" x="6962" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6962" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6962" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_0_2_0 -->
<g id="node74" class="node">
<title>reshape_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7043,-2568 6881,-2568 6881,-2515 7043,-2515 7043,-2568"/>
<text text-anchor="middle" x="6962" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6962" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6962" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_0_2_0&#45;&gt;reshape_0_2_0 -->
<g id="edge203" class="edge">
<title>qkv_0_2_0&#45;&gt;reshape_0_2_0</title>
<path fill="none" stroke="black" d="M6962,-2604.57C6962,-2596.34 6962,-2587.08 6962,-2578.28"/>
<polygon fill="black" stroke="black" points="6965.5,-2578.24 6962,-2568.24 6958.5,-2578.24 6965.5,-2578.24"/>
</g>
<!-- attn_0_2_0 -->
<g id="node75" class="node">
<title>attn_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7075,-2478 6849,-2478 6849,-2425 7075,-2425 7075,-2478"/>
<text text-anchor="middle" x="6962" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6962" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6962" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge204" class="edge">
<title>reshape_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="black" d="M6962,-2514.57C6962,-2506.34 6962,-2497.08 6962,-2488.28"/>
<polygon fill="black" stroke="black" points="6965.5,-2488.24 6962,-2478.24 6958.5,-2488.24 6965.5,-2488.24"/>
</g>
<!-- attn_0_2_0&#45;&gt;proj_0_2_0 -->
<g id="edge205" class="edge">
<title>attn_0_2_0&#45;&gt;proj_0_2_0</title>
<path fill="none" stroke="black" d="M6974.08,-2424.57C6978.04,-2416.07 6982.51,-2406.48 6986.73,-2397.42"/>
<polygon fill="black" stroke="black" points="6989.96,-2398.78 6991.01,-2388.24 6983.61,-2395.83 6989.96,-2398.78"/>
</g>
<!-- qkv_0_2_1 -->
<g id="node76" class="node">
<title>qkv_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7770.5,-2658 7617.5,-2658 7617.5,-2605 7770.5,-2605 7770.5,-2658"/>
<text text-anchor="middle" x="7694" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7694" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7694" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_0_2_1 -->
<g id="node77" class="node">
<title>reshape_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7775,-2568 7613,-2568 7613,-2515 7775,-2515 7775,-2568"/>
<text text-anchor="middle" x="7694" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7694" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7694" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_0_2_1&#45;&gt;reshape_0_2_1 -->
<g id="edge206" class="edge">
<title>qkv_0_2_1&#45;&gt;reshape_0_2_1</title>
<path fill="none" stroke="black" d="M7694,-2604.57C7694,-2596.34 7694,-2587.08 7694,-2578.28"/>
<polygon fill="black" stroke="black" points="7697.5,-2578.24 7694,-2568.24 7690.5,-2578.24 7697.5,-2578.24"/>
</g>
<!-- attn_0_2_1 -->
<g id="node78" class="node">
<title>attn_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7807,-2478 7581,-2478 7581,-2425 7807,-2425 7807,-2478"/>
<text text-anchor="middle" x="7694" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7694" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7694" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge207" class="edge">
<title>reshape_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="black" d="M7694,-2514.57C7694,-2506.34 7694,-2497.08 7694,-2488.28"/>
<polygon fill="black" stroke="black" points="7697.5,-2488.24 7694,-2478.24 7690.5,-2488.24 7697.5,-2488.24"/>
</g>
<!-- attn_0_2_1&#45;&gt;proj_0_2_1 -->
<g id="edge208" class="edge">
<title>attn_0_2_1&#45;&gt;proj_0_2_1</title>
<path fill="none" stroke="black" d="M7675.73,-2424.57C7669.55,-2415.8 7662.55,-2405.87 7656,-2396.56"/>
<polygon fill="black" stroke="black" points="7658.76,-2394.4 7650.14,-2388.24 7653.03,-2398.43 7658.76,-2394.4"/>
</g>
<!-- qkv_0_2_2 -->
<g id="node79" class="node">
<title>qkv_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7526.5,-2658 7373.5,-2658 7373.5,-2605 7526.5,-2605 7526.5,-2658"/>
<text text-anchor="middle" x="7450" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7450" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7450" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_0_2_2 -->
<g id="node80" class="node">
<title>reshape_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7531,-2568 7369,-2568 7369,-2515 7531,-2515 7531,-2568"/>
<text text-anchor="middle" x="7450" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7450" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7450" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_0_2_2&#45;&gt;reshape_0_2_2 -->
<g id="edge209" class="edge">
<title>qkv_0_2_2&#45;&gt;reshape_0_2_2</title>
<path fill="none" stroke="black" d="M7450,-2604.57C7450,-2596.34 7450,-2587.08 7450,-2578.28"/>
<polygon fill="black" stroke="black" points="7453.5,-2578.24 7450,-2568.24 7446.5,-2578.24 7453.5,-2578.24"/>
</g>
<!-- attn_0_2_2 -->
<g id="node81" class="node">
<title>attn_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7563,-2478 7337,-2478 7337,-2425 7563,-2425 7563,-2478"/>
<text text-anchor="middle" x="7450" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7450" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7450" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge210" class="edge">
<title>reshape_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="black" d="M7450,-2514.57C7450,-2506.34 7450,-2497.08 7450,-2488.28"/>
<polygon fill="black" stroke="black" points="7453.5,-2488.24 7450,-2478.24 7446.5,-2488.24 7453.5,-2488.24"/>
</g>
<!-- attn_0_2_2&#45;&gt;proj_0_2_2 -->
<g id="edge211" class="edge">
<title>attn_0_2_2&#45;&gt;proj_0_2_2</title>
<path fill="none" stroke="black" d="M7437.92,-2424.57C7433.96,-2416.07 7429.49,-2406.48 7425.27,-2397.42"/>
<polygon fill="black" stroke="black" points="7428.39,-2395.83 7420.99,-2388.24 7422.04,-2398.78 7428.39,-2395.83"/>
</g>
<!-- qkv_0_2_3 -->
<g id="node82" class="node">
<title>qkv_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7282.5,-2658 7129.5,-2658 7129.5,-2605 7282.5,-2605 7282.5,-2658"/>
<text text-anchor="middle" x="7206" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7206" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7206" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_0_2_3 -->
<g id="node83" class="node">
<title>reshape_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7287,-2568 7125,-2568 7125,-2515 7287,-2515 7287,-2568"/>
<text text-anchor="middle" x="7206" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7206" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7206" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_0_2_3&#45;&gt;reshape_0_2_3 -->
<g id="edge212" class="edge">
<title>qkv_0_2_3&#45;&gt;reshape_0_2_3</title>
<path fill="none" stroke="black" d="M7206,-2604.57C7206,-2596.34 7206,-2587.08 7206,-2578.28"/>
<polygon fill="black" stroke="black" points="7209.5,-2578.24 7206,-2568.24 7202.5,-2578.24 7209.5,-2578.24"/>
</g>
<!-- attn_0_2_3 -->
<g id="node84" class="node">
<title>attn_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7319,-2478 7093,-2478 7093,-2425 7319,-2425 7319,-2478"/>
<text text-anchor="middle" x="7206" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7206" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7206" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge213" class="edge">
<title>reshape_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="black" d="M7206,-2514.57C7206,-2506.34 7206,-2497.08 7206,-2488.28"/>
<polygon fill="black" stroke="black" points="7209.5,-2488.24 7206,-2478.24 7202.5,-2488.24 7209.5,-2488.24"/>
</g>
<!-- attn_0_2_3&#45;&gt;proj_0_2_3 -->
<g id="edge214" class="edge">
<title>attn_0_2_3&#45;&gt;proj_0_2_3</title>
<path fill="none" stroke="black" d="M7206,-2424.57C7206,-2416.34 7206,-2407.08 7206,-2398.28"/>
<polygon fill="black" stroke="black" points="7209.5,-2398.24 7206,-2388.24 7202.5,-2398.24 7209.5,-2398.24"/>
</g>
<!-- qkv_0_3_0 -->
<g id="node85" class="node">
<title>qkv_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6062.5,-2658 5909.5,-2658 5909.5,-2605 6062.5,-2605 6062.5,-2658"/>
<text text-anchor="middle" x="5986" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5986" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5986" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_0_3_0 -->
<g id="node86" class="node">
<title>reshape_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6067,-2568 5905,-2568 5905,-2515 6067,-2515 6067,-2568"/>
<text text-anchor="middle" x="5986" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5986" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5986" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_0_3_0&#45;&gt;reshape_0_3_0 -->
<g id="edge215" class="edge">
<title>qkv_0_3_0&#45;&gt;reshape_0_3_0</title>
<path fill="none" stroke="black" d="M5986,-2604.57C5986,-2596.34 5986,-2587.08 5986,-2578.28"/>
<polygon fill="black" stroke="black" points="5989.5,-2578.24 5986,-2568.24 5982.5,-2578.24 5989.5,-2578.24"/>
</g>
<!-- attn_0_3_0 -->
<g id="node87" class="node">
<title>attn_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6099,-2478 5873,-2478 5873,-2425 6099,-2425 6099,-2478"/>
<text text-anchor="middle" x="5986" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5986" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5986" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge216" class="edge">
<title>reshape_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="black" d="M5986,-2514.57C5986,-2506.34 5986,-2497.08 5986,-2488.28"/>
<polygon fill="black" stroke="black" points="5989.5,-2488.24 5986,-2478.24 5982.5,-2488.24 5989.5,-2488.24"/>
</g>
<!-- attn_0_3_0&#45;&gt;proj_0_3_0 -->
<g id="edge217" class="edge">
<title>attn_0_3_0&#45;&gt;proj_0_3_0</title>
<path fill="none" stroke="black" d="M5996.61,-2424.57C6000.05,-2416.16 6003.93,-2406.68 6007.6,-2397.7"/>
<polygon fill="black" stroke="black" points="6010.92,-2398.82 6011.47,-2388.24 6004.44,-2396.17 6010.92,-2398.82"/>
</g>
<!-- qkv_0_3_1 -->
<g id="node88" class="node">
<title>qkv_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6794.5,-2658 6641.5,-2658 6641.5,-2605 6794.5,-2605 6794.5,-2658"/>
<text text-anchor="middle" x="6718" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6718" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6718" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_0_3_1 -->
<g id="node89" class="node">
<title>reshape_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6799,-2568 6637,-2568 6637,-2515 6799,-2515 6799,-2568"/>
<text text-anchor="middle" x="6718" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6718" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6718" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_0_3_1&#45;&gt;reshape_0_3_1 -->
<g id="edge218" class="edge">
<title>qkv_0_3_1&#45;&gt;reshape_0_3_1</title>
<path fill="none" stroke="black" d="M6718,-2604.57C6718,-2596.34 6718,-2587.08 6718,-2578.28"/>
<polygon fill="black" stroke="black" points="6721.5,-2578.24 6718,-2568.24 6714.5,-2578.24 6721.5,-2578.24"/>
</g>
<!-- attn_0_3_1 -->
<g id="node90" class="node">
<title>attn_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6831,-2478 6605,-2478 6605,-2425 6831,-2425 6831,-2478"/>
<text text-anchor="middle" x="6718" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6718" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6718" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge219" class="edge">
<title>reshape_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="black" d="M6718,-2514.57C6718,-2506.34 6718,-2497.08 6718,-2488.28"/>
<polygon fill="black" stroke="black" points="6721.5,-2488.24 6718,-2478.24 6714.5,-2488.24 6721.5,-2488.24"/>
</g>
<!-- attn_0_3_1&#45;&gt;proj_0_3_1 -->
<g id="edge220" class="edge">
<title>attn_0_3_1&#45;&gt;proj_0_3_1</title>
<path fill="none" stroke="black" d="M6688.22,-2424.81C6677.33,-2415.41 6664.86,-2404.66 6653.39,-2394.76"/>
<polygon fill="black" stroke="black" points="6655.5,-2391.95 6645.64,-2388.07 6650.92,-2397.25 6655.5,-2391.95"/>
</g>
<!-- qkv_0_3_2 -->
<g id="node91" class="node">
<title>qkv_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="6550.5,-2658 6397.5,-2658 6397.5,-2605 6550.5,-2605 6550.5,-2658"/>
<text text-anchor="middle" x="6474" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6474" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6474" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_0_3_2 -->
<g id="node92" class="node">
<title>reshape_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="6555,-2568 6393,-2568 6393,-2515 6555,-2515 6555,-2568"/>
<text text-anchor="middle" x="6474" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6474" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6474" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_0_3_2&#45;&gt;reshape_0_3_2 -->
<g id="edge221" class="edge">
<title>qkv_0_3_2&#45;&gt;reshape_0_3_2</title>
<path fill="none" stroke="black" d="M6474,-2604.57C6474,-2596.34 6474,-2587.08 6474,-2578.28"/>
<polygon fill="black" stroke="black" points="6477.5,-2578.24 6474,-2568.24 6470.5,-2578.24 6477.5,-2578.24"/>
</g>
<!-- attn_0_3_2 -->
<g id="node93" class="node">
<title>attn_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="6587,-2478 6361,-2478 6361,-2425 6587,-2425 6587,-2478"/>
<text text-anchor="middle" x="6474" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6474" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6474" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge222" class="edge">
<title>reshape_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="black" d="M6474,-2514.57C6474,-2506.34 6474,-2497.08 6474,-2488.28"/>
<polygon fill="black" stroke="black" points="6477.5,-2488.24 6474,-2478.24 6470.5,-2488.24 6477.5,-2488.24"/>
</g>
<!-- attn_0_3_2&#45;&gt;proj_0_3_2 -->
<g id="edge223" class="edge">
<title>attn_0_3_2&#45;&gt;proj_0_3_2</title>
<path fill="none" stroke="black" d="M6461.92,-2424.57C6457.96,-2416.07 6453.49,-2406.48 6449.27,-2397.42"/>
<polygon fill="black" stroke="black" points="6452.39,-2395.83 6444.99,-2388.24 6446.04,-2398.78 6452.39,-2395.83"/>
</g>
<!-- qkv_0_3_3 -->
<g id="node94" class="node">
<title>qkv_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="6306.5,-2658 6153.5,-2658 6153.5,-2605 6306.5,-2605 6306.5,-2658"/>
<text text-anchor="middle" x="6230" y="-2642.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6230" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6230" y="-2612.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_0_3_3 -->
<g id="node95" class="node">
<title>reshape_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="6311,-2568 6149,-2568 6149,-2515 6311,-2515 6311,-2568"/>
<text text-anchor="middle" x="6230" y="-2552.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6230" y="-2537.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6230" y="-2522.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_0_3_3&#45;&gt;reshape_0_3_3 -->
<g id="edge224" class="edge">
<title>qkv_0_3_3&#45;&gt;reshape_0_3_3</title>
<path fill="none" stroke="black" d="M6230,-2604.57C6230,-2596.34 6230,-2587.08 6230,-2578.28"/>
<polygon fill="black" stroke="black" points="6233.5,-2578.24 6230,-2568.24 6226.5,-2578.24 6233.5,-2578.24"/>
</g>
<!-- attn_0_3_3 -->
<g id="node96" class="node">
<title>attn_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="6343,-2478 6117,-2478 6117,-2425 6343,-2425 6343,-2478"/>
<text text-anchor="middle" x="6230" y="-2462.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6230" y="-2447.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6230" y="-2432.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge225" class="edge">
<title>reshape_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="black" d="M6230,-2514.57C6230,-2506.34 6230,-2497.08 6230,-2488.28"/>
<polygon fill="black" stroke="black" points="6233.5,-2488.24 6230,-2478.24 6226.5,-2488.24 6233.5,-2488.24"/>
</g>
<!-- attn_0_3_3&#45;&gt;proj_0_3_3 -->
<g id="edge226" class="edge">
<title>attn_0_3_3&#45;&gt;proj_0_3_3</title>
<path fill="none" stroke="black" d="M6230,-2424.57C6230,-2416.34 6230,-2407.08 6230,-2398.28"/>
<polygon fill="black" stroke="black" points="6233.5,-2398.24 6230,-2388.24 6226.5,-2398.24 6233.5,-2398.24"/>
</g>
<!-- ln2_0 -->
<g id="node98" class="node">
<title>ln2_0</title>
<polygon fill="white" stroke="black" points="3431.5,-2658 3278.5,-2658 3278.5,-2605 3431.5,-2605 3431.5,-2658"/>
<text text-anchor="middle" x="3355" y="-2642.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3355" y="-2627.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3355" y="-2612.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_0&#45;&gt;ln2_0 -->
<g id="edge227" class="edge">
<title>residual1_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M3935.35,-2710.23C3812.25,-2693.75 3571.25,-2661.47 3441.93,-2644.14"/>
<polygon fill="black" stroke="black" points="3442.05,-2640.63 3431.67,-2642.77 3441.12,-2647.57 3442.05,-2640.63"/>
</g>
<!-- residual1_0&#45;&gt;residual2_0 -->
<g id="edge238" class="edge">
<title>residual1_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M4014.21,-2694.78C4017.86,-2646.19 4022.91,-2543.24 4003,-2515 3977.84,-2479.32 3938.85,-2512.43 3912,-2478 3892.4,-2452.87 3902,-2438.87 3902,-2407 3902,-2407 3902,-2407 3902,-2256.5 3902,-2210.35 3774.51,-2181.2 3684.65,-2166.38"/>
<polygon fill="black" stroke="black" points="3685.14,-2162.92 3674.71,-2164.78 3684.03,-2169.83 3685.14,-2162.92"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_0 -->
<g id="edge228" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_0</title>
<path fill="none" stroke="black" d="M3409.01,-2604.81C3430.28,-2594.69 3454.87,-2583 3476.95,-2572.49"/>
<polygon fill="black" stroke="black" points="3478.72,-2575.53 3486.25,-2568.07 3475.71,-2569.2 3478.72,-2575.53"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_1 -->
<g id="edge229" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_1</title>
<path fill="none" stroke="black" d="M3431.64,-2614.33C3485.2,-2602.79 3558.59,-2586.47 3631.5,-2568.34"/>
<polygon fill="black" stroke="black" points="3632.46,-2571.71 3641.31,-2565.89 3630.76,-2564.91 3632.46,-2571.71"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_2 -->
<g id="edge230" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_2</title>
<path fill="none" stroke="black" d="M3431.73,-2623.38C3521.85,-2614.28 3675.89,-2596.48 3816.3,-2568.25"/>
<polygon fill="black" stroke="black" points="3817.28,-2571.62 3826.38,-2566.2 3815.88,-2564.76 3817.28,-2571.62"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_3 -->
<g id="edge231" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_3</title>
<path fill="none" stroke="black" d="M3278.22,-2627.34C3158.35,-2621.47 2919.55,-2606.02 2708.76,-2568"/>
<polygon fill="black" stroke="black" points="2709.21,-2564.52 2698.75,-2566.17 2707.96,-2571.41 2709.21,-2564.52"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_4 -->
<g id="edge232" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_4</title>
<path fill="none" stroke="black" d="M3278.45,-2623.3C3188.54,-2614.13 3034.84,-2596.26 2893.67,-2568.02"/>
<polygon fill="black" stroke="black" points="2894.02,-2564.52 2883.53,-2565.97 2892.63,-2571.38 2894.02,-2564.52"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_5 -->
<g id="edge233" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_5</title>
<path fill="none" stroke="black" d="M3278.35,-2614.19C3225.02,-2602.61 3152.03,-2586.32 3078.51,-2568.08"/>
<polygon fill="black" stroke="black" points="3079.15,-2564.64 3068.6,-2565.62 3077.46,-2571.43 3079.15,-2564.64"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_6 -->
<g id="edge234" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_6</title>
<path fill="none" stroke="black" d="M3300.99,-2604.81C3279.72,-2594.69 3255.13,-2583 3233.05,-2572.49"/>
<polygon fill="black" stroke="black" points="3234.29,-2569.2 3223.75,-2568.07 3231.28,-2575.53 3234.29,-2569.2"/>
</g>
<!-- ln2_0&#45;&gt;mlp_col_0_7 -->
<g id="edge235" class="edge">
<title>ln2_0&#45;&gt;mlp_col_0_7</title>
<path fill="none" stroke="black" d="M3355,-2604.57C3355,-2596.34 3355,-2587.08 3355,-2578.28"/>
<polygon fill="black" stroke="black" points="3358.5,-2578.24 3355,-2568.24 3351.5,-2578.24 3358.5,-2578.24"/>
</g>
<!-- ln1_1 -->
<g id="node146" class="node">
<title>ln1_1</title>
<polygon fill="white" stroke="black" points="4264.5,-2069 4111.5,-2069 4111.5,-2016 4264.5,-2016 4264.5,-2069"/>
<text text-anchor="middle" x="4188" y="-2053.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4188" y="-2038.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4188" y="-2023.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1 -->
<g id="edge239" class="edge">
<title>residual2_0&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M3674.53,-2138.36C3784.35,-2118.07 3986.09,-2080.8 4101.29,-2059.52"/>
<polygon fill="black" stroke="black" points="4101.94,-2062.96 4111.14,-2057.7 4100.67,-2056.07 4101.94,-2062.96"/>
</g>
<!-- residual1_1 -->
<g id="node195" class="node">
<title>residual1_1</title>
<polygon fill="orange" stroke="black" points="3314.5,-2069 3161.5,-2069 3161.5,-2016 3314.5,-2016 3314.5,-2069"/>
<text text-anchor="middle" x="3238" y="-2053.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3238" y="-2038.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3238" y="-2023.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_0&#45;&gt;residual1_1 -->
<g id="edge299" class="edge">
<title>residual2_0&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M3521.21,-2129.25C3463.51,-2111.78 3384.43,-2087.83 3324.49,-2069.69"/>
<polygon fill="black" stroke="black" points="3325.25,-2066.26 3314.67,-2066.71 3323.23,-2072.96 3325.25,-2066.26"/>
</g>
<!-- proj_1_0_0 -->
<g id="node100" class="node">
<title>proj_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="4983,-1709 4839,-1709 4839,-1656 4983,-1656 4983,-1709"/>
<text text-anchor="middle" x="4911" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4911" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4911" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_1_0 -->
<g id="node101" class="node">
<title>concat_dim_1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="4800.5,-1605 4647.5,-1605 4647.5,-1552 4800.5,-1552 4800.5,-1605"/>
<text text-anchor="middle" x="4724" y="-1589.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4724" y="-1574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="4724" y="-1559.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_1_0_0&#45;&gt;concat_dim_1_0 -->
<g id="edge45" class="edge">
<title>proj_1_0_0&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4886.02,-1655.72C4874.11,-1644.52 4859.16,-1631.94 4844,-1623 4833.38,-1616.74 4821.71,-1611.14 4809.95,-1606.22"/>
<polygon fill="black" stroke="black" points="4811.1,-1602.91 4800.51,-1602.42 4808.48,-1609.4 4811.1,-1602.91"/>
<text text-anchor="middle" x="4922" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_1 -->
<g id="node120" class="node">
<title>concat_heads_1</title>
<polygon fill="lightsteelblue" stroke="black" points="5017,-1501 4853,-1501 4853,-1448 5017,-1448 5017,-1501"/>
<text text-anchor="middle" x="4935" y="-1485.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="4935" y="-1470.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4935" y="-1455.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_1 -->
<g id="edge61" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4776.97,-1551.89C4806.07,-1537.83 4842.32,-1520.3 4872.76,-1505.59"/>
<polygon fill="black" stroke="black" points="4874.53,-1508.62 4882.01,-1501.12 4871.48,-1502.32 4874.53,-1508.62"/>
<text text-anchor="middle" x="4886.5" y="-1522.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_1_0_1 -->
<g id="node102" class="node">
<title>proj_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4796,-1709 4652,-1709 4652,-1656 4796,-1656 4796,-1709"/>
<text text-anchor="middle" x="4724" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4724" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4724" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_1_0_1&#45;&gt;concat_dim_1_0 -->
<g id="edge46" class="edge">
<title>proj_1_0_1&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4724,-1655.76C4724,-1643.56 4724,-1628.78 4724,-1615.49"/>
<polygon fill="black" stroke="black" points="4727.5,-1615.23 4724,-1605.23 4720.5,-1615.23 4727.5,-1615.23"/>
<text text-anchor="middle" x="4782" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_1_0_2 -->
<g id="node103" class="node">
<title>proj_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="4593,-1709 4449,-1709 4449,-1656 4593,-1656 4593,-1709"/>
<text text-anchor="middle" x="4521" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4521" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4521" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_1_0_2&#45;&gt;concat_dim_1_0 -->
<g id="edge47" class="edge">
<title>proj_1_0_2&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4553.23,-1655.76C4568.1,-1644.69 4586.34,-1632.21 4604,-1623 4614.77,-1617.38 4626.44,-1612.17 4638.12,-1607.45"/>
<polygon fill="black" stroke="black" points="4639.44,-1610.69 4647.47,-1603.78 4636.88,-1604.18 4639.44,-1610.69"/>
<text text-anchor="middle" x="4662" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_1_0_3 -->
<g id="node104" class="node">
<title>proj_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="4370,-1709 4226,-1709 4226,-1656 4370,-1656 4370,-1709"/>
<text text-anchor="middle" x="4298" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4298" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4298" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_1_0_3&#45;&gt;concat_dim_1_0 -->
<g id="edge48" class="edge">
<title>proj_1_0_3&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4360.24,-1656C4390.02,-1644.58 4426.43,-1631.75 4460,-1623 4518.26,-1607.82 4585.2,-1596.86 4637.09,-1589.74"/>
<polygon fill="black" stroke="black" points="4637.82,-1593.17 4647.26,-1588.36 4636.89,-1586.23 4637.82,-1593.17"/>
<text text-anchor="middle" x="4518" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_1_1_0 -->
<g id="node105" class="node">
<title>proj_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="3820,-1709 3676,-1709 3676,-1656 3820,-1656 3820,-1709"/>
<text text-anchor="middle" x="3748" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3748" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3748" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_1_1 -->
<g id="node106" class="node">
<title>concat_dim_1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="3824.5,-1605 3671.5,-1605 3671.5,-1552 3824.5,-1552 3824.5,-1605"/>
<text text-anchor="middle" x="3748" y="-1589.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3748" y="-1574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="3748" y="-1559.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_1_1_0&#45;&gt;concat_dim_1_1 -->
<g id="edge49" class="edge">
<title>proj_1_1_0&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3748,-1655.76C3748,-1643.56 3748,-1628.78 3748,-1615.49"/>
<polygon fill="black" stroke="black" points="3751.5,-1615.23 3748,-1605.23 3744.5,-1615.23 3751.5,-1615.23"/>
<text text-anchor="middle" x="3806" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_1 -->
<g id="edge62" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3824.51,-1570.93C4033.81,-1552.94 4615.31,-1502.97 4842.43,-1483.45"/>
<polygon fill="black" stroke="black" points="4842.98,-1486.92 4852.65,-1482.58 4842.38,-1479.95 4842.98,-1486.92"/>
<text text-anchor="middle" x="4456.5" y="-1522.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_1_1_1 -->
<g id="node107" class="node">
<title>proj_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="3638,-1709 3494,-1709 3494,-1656 3638,-1656 3638,-1709"/>
<text text-anchor="middle" x="3566" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3566" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3566" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_1_1_1&#45;&gt;concat_dim_1_1 -->
<g id="edge50" class="edge">
<title>proj_1_1_1&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3588.52,-1655.93C3599.53,-1644.64 3613.51,-1631.93 3628,-1623 3638.5,-1616.53 3650.1,-1610.83 3661.83,-1605.85"/>
<polygon fill="black" stroke="black" points="3663.3,-1609.03 3671.24,-1602.01 3660.66,-1602.54 3663.3,-1609.03"/>
<text text-anchor="middle" x="3686" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_1_1_2 -->
<g id="node108" class="node">
<title>proj_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="3394,-1709 3250,-1709 3250,-1656 3394,-1656 3394,-1709"/>
<text text-anchor="middle" x="3322" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3322" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3322" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_1_1_2&#45;&gt;concat_dim_1_1 -->
<g id="edge51" class="edge">
<title>proj_1_1_2&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3386.64,-1655.96C3417.29,-1644.61 3454.64,-1631.84 3489,-1623 3545.72,-1608.42 3610.72,-1597.52 3661.41,-1590.28"/>
<polygon fill="black" stroke="black" points="3661.94,-1593.74 3671.35,-1588.88 3660.96,-1586.8 3661.94,-1593.74"/>
<text text-anchor="middle" x="3547" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_1_1_3 -->
<g id="node109" class="node">
<title>proj_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4002,-1709 3858,-1709 3858,-1656 4002,-1656 4002,-1709"/>
<text text-anchor="middle" x="3930" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3930" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3930" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_1_1_3&#45;&gt;concat_dim_1_1 -->
<g id="edge52" class="edge">
<title>proj_1_1_3&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3907.48,-1655.93C3896.47,-1644.64 3882.49,-1631.93 3868,-1623 3857.5,-1616.53 3845.9,-1610.83 3834.17,-1605.85"/>
<polygon fill="black" stroke="black" points="3835.34,-1602.54 3824.76,-1602.01 3832.7,-1609.03 3835.34,-1602.54"/>
<text text-anchor="middle" x="3944" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_1_2_0 -->
<g id="node110" class="node">
<title>proj_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6301,-1709 6157,-1709 6157,-1656 6301,-1656 6301,-1709"/>
<text text-anchor="middle" x="6229" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6229" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6229" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_1_2 -->
<g id="node111" class="node">
<title>concat_dim_1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="6508.5,-1605 6355.5,-1605 6355.5,-1552 6508.5,-1552 6508.5,-1605"/>
<text text-anchor="middle" x="6432" y="-1589.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6432" y="-1574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="6432" y="-1559.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_1_2_0&#45;&gt;concat_dim_1_2 -->
<g id="edge53" class="edge">
<title>proj_1_2_0&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6261.23,-1655.76C6276.1,-1644.69 6294.34,-1632.21 6312,-1623 6322.77,-1617.38 6334.44,-1612.17 6346.12,-1607.45"/>
<polygon fill="black" stroke="black" points="6347.44,-1610.69 6355.47,-1603.78 6344.88,-1604.18 6347.44,-1610.69"/>
<text text-anchor="middle" x="6370" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_1 -->
<g id="edge63" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6355.45,-1572.28C6103.66,-1555.13 5301.71,-1500.49 5027.76,-1481.82"/>
<polygon fill="black" stroke="black" points="5027.68,-1478.31 5017.46,-1481.12 5027.2,-1485.29 5027.68,-1478.31"/>
<text text-anchor="middle" x="5817.5" y="-1522.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_1_2_1 -->
<g id="node112" class="node">
<title>proj_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6930,-1709 6786,-1709 6786,-1656 6930,-1656 6930,-1709"/>
<text text-anchor="middle" x="6858" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6858" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6858" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_1_2_1&#45;&gt;concat_dim_1_2 -->
<g id="edge54" class="edge">
<title>proj_1_2_1&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6802.47,-1655.98C6775.37,-1644.42 6742,-1631.47 6711,-1623 6647.78,-1605.73 6574.51,-1594.63 6518.92,-1587.97"/>
<polygon fill="black" stroke="black" points="6519.1,-1584.47 6508.76,-1586.78 6518.28,-1591.42 6519.1,-1584.47"/>
<text text-anchor="middle" x="6814" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_1_2_2 -->
<g id="node113" class="node">
<title>proj_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6707,-1709 6563,-1709 6563,-1656 6707,-1656 6707,-1709"/>
<text text-anchor="middle" x="6635" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6635" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6635" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_1_2_2&#45;&gt;concat_dim_1_2 -->
<g id="edge55" class="edge">
<title>proj_1_2_2&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6607.45,-1655.98C6594.17,-1644.7 6577.55,-1631.98 6561,-1623 6547.62,-1615.74 6532.81,-1609.38 6518.14,-1603.93"/>
<polygon fill="black" stroke="black" points="6519.12,-1600.57 6508.53,-1600.48 6516.76,-1607.15 6519.12,-1600.57"/>
<text text-anchor="middle" x="6644.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_1_2_3 -->
<g id="node114" class="node">
<title>proj_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6504,-1709 6360,-1709 6360,-1656 6504,-1656 6504,-1709"/>
<text text-anchor="middle" x="6432" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6432" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6432" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_1_2_3&#45;&gt;concat_dim_1_2 -->
<g id="edge56" class="edge">
<title>proj_1_2_3&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6432,-1655.76C6432,-1643.56 6432,-1628.78 6432,-1615.49"/>
<polygon fill="black" stroke="black" points="6435.5,-1615.23 6432,-1605.23 6428.5,-1615.23 6435.5,-1615.23"/>
<text text-anchor="middle" x="6494.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_1_3_0 -->
<g id="node115" class="node">
<title>proj_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="5346,-1709 5202,-1709 5202,-1656 5346,-1656 5346,-1709"/>
<text text-anchor="middle" x="5274" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5274" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5274" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_1_3 -->
<g id="node116" class="node">
<title>concat_dim_1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5532.5,-1605 5379.5,-1605 5379.5,-1552 5532.5,-1552 5532.5,-1605"/>
<text text-anchor="middle" x="5456" y="-1589.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="5456" y="-1574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="5456" y="-1559.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_1_3_0&#45;&gt;concat_dim_1_3 -->
<g id="edge57" class="edge">
<title>proj_1_3_0&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5292.28,-1655.96C5301.57,-1644.54 5313.7,-1631.71 5327,-1623 5339.97,-1614.5 5354.77,-1607.5 5369.61,-1601.79"/>
<polygon fill="black" stroke="black" points="5371.16,-1604.95 5379.35,-1598.22 5368.75,-1598.38 5371.16,-1604.95"/>
<text text-anchor="middle" x="5389.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_1 -->
<g id="edge64" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5379.4,-1562.5C5285.75,-1544.17 5127.35,-1513.16 5027.13,-1493.54"/>
<polygon fill="black" stroke="black" points="5027.5,-1490.04 5017.02,-1491.56 5026.16,-1496.91 5027.5,-1490.04"/>
<text text-anchor="middle" x="5270.5" y="-1522.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_1_3_1 -->
<g id="node117" class="node">
<title>proj_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5934,-1709 5790,-1709 5790,-1656 5934,-1656 5934,-1709"/>
<text text-anchor="middle" x="5862" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5862" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5862" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_1_3_1&#45;&gt;concat_dim_1_3 -->
<g id="edge58" class="edge">
<title>proj_1_3_1&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5813.49,-1655.95C5789.54,-1644.31 5759.87,-1631.3 5732,-1623 5670.07,-1604.55 5597.86,-1593.52 5542.84,-1587.19"/>
<polygon fill="black" stroke="black" points="5543.1,-1583.69 5532.77,-1586.06 5542.32,-1590.65 5543.1,-1583.69"/>
<text text-anchor="middle" x="5834.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_1_3_2 -->
<g id="node118" class="node">
<title>proj_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5717,-1709 5573,-1709 5573,-1656 5717,-1656 5717,-1709"/>
<text text-anchor="middle" x="5645" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5645" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5645" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_1_3_2&#45;&gt;concat_dim_1_3 -->
<g id="edge59" class="edge">
<title>proj_1_3_2&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5623.43,-1655.75C5612.83,-1644.42 5599.27,-1631.73 5585,-1623 5571.85,-1614.96 5557.03,-1608.19 5542.24,-1602.57"/>
<polygon fill="black" stroke="black" points="5543.14,-1599.17 5532.55,-1599.04 5540.75,-1605.75 5543.14,-1599.17"/>
<text text-anchor="middle" x="5665.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_1_3_3 -->
<g id="node119" class="node">
<title>proj_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5528,-1709 5384,-1709 5384,-1656 5528,-1656 5528,-1709"/>
<text text-anchor="middle" x="5456" y="-1693.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5456" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5456" y="-1663.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_1_3_3&#45;&gt;concat_dim_1_3 -->
<g id="edge60" class="edge">
<title>proj_1_3_3&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5456,-1655.76C5456,-1643.56 5456,-1628.78 5456,-1615.49"/>
<polygon fill="black" stroke="black" points="5459.5,-1615.23 5456,-1605.23 5452.5,-1615.23 5459.5,-1615.23"/>
<text text-anchor="middle" x="5518.5" y="-1626.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- mlp_col_1_0 -->
<g id="node121" class="node">
<title>mlp_col_1_0</title>
<polygon fill="lightblue" stroke="black" points="2849.5,-1889 2682.5,-1889 2682.5,-1836 2849.5,-1836 2849.5,-1889"/>
<text text-anchor="middle" x="2766" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2766" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2766" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_1_0 -->
<g id="node122" class="node">
<title>gelu_1_0</title>
<polygon fill="lightblue" stroke="black" points="2766.5,-1799 2613.5,-1799 2613.5,-1746 2766.5,-1746 2766.5,-1799"/>
<text text-anchor="middle" x="2690" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2690" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2690" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- mlp_col_1_0&#45;&gt;gelu_1_0 -->
<g id="edge65" class="edge">
<title>mlp_col_1_0&#45;&gt;gelu_1_0</title>
<path fill="none" stroke="black" d="M2743.61,-1835.57C2735.88,-1826.62 2727.1,-1816.46 2718.93,-1806.99"/>
<polygon fill="black" stroke="black" points="2721.42,-1804.52 2712.23,-1799.24 2716.12,-1809.1 2721.42,-1804.52"/>
</g>
<!-- mlp_row_1_0 -->
<g id="node137" class="node">
<title>mlp_row_1_0</title>
<polygon fill="lightblue" stroke="black" points="2766.5,-1709 2613.5,-1709 2613.5,-1656 2766.5,-1656 2766.5,-1709"/>
<text text-anchor="middle" x="2690" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2690" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2690" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_1_0&#45;&gt;mlp_row_1_0 -->
<g id="edge73" class="edge">
<title>gelu_1_0&#45;&gt;mlp_row_1_0</title>
<path fill="none" stroke="black" d="M2690,-1745.57C2690,-1737.34 2690,-1728.08 2690,-1719.28"/>
<polygon fill="black" stroke="black" points="2693.5,-1719.24 2690,-1709.24 2686.5,-1719.24 2693.5,-1719.24"/>
</g>
<!-- mlp_col_1_1 -->
<g id="node123" class="node">
<title>mlp_col_1_1</title>
<polygon fill="lightgreen" stroke="black" points="3034.5,-1889 2867.5,-1889 2867.5,-1836 3034.5,-1836 3034.5,-1889"/>
<text text-anchor="middle" x="2951" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2951" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2951" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_1_1 -->
<g id="node124" class="node">
<title>gelu_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2937.5,-1799 2784.5,-1799 2784.5,-1746 2937.5,-1746 2937.5,-1799"/>
<text text-anchor="middle" x="2861" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2861" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2861" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- mlp_col_1_1&#45;&gt;gelu_1_1 -->
<g id="edge66" class="edge">
<title>mlp_col_1_1&#45;&gt;gelu_1_1</title>
<path fill="none" stroke="black" d="M2924.48,-1835.57C2915.15,-1826.44 2904.52,-1816.06 2894.67,-1806.43"/>
<polygon fill="black" stroke="black" points="2896.92,-1803.73 2887.33,-1799.24 2892.03,-1808.74 2896.92,-1803.73"/>
</g>
<!-- mlp_row_1_1 -->
<g id="node138" class="node">
<title>mlp_row_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2937.5,-1709 2784.5,-1709 2784.5,-1656 2937.5,-1656 2937.5,-1709"/>
<text text-anchor="middle" x="2861" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2861" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2861" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_1_1&#45;&gt;mlp_row_1_1 -->
<g id="edge74" class="edge">
<title>gelu_1_1&#45;&gt;mlp_row_1_1</title>
<path fill="none" stroke="black" d="M2861,-1745.57C2861,-1737.34 2861,-1728.08 2861,-1719.28"/>
<polygon fill="black" stroke="black" points="2864.5,-1719.24 2861,-1709.24 2857.5,-1719.24 2864.5,-1719.24"/>
</g>
<!-- mlp_col_1_2 -->
<g id="node125" class="node">
<title>mlp_col_1_2</title>
<polygon fill="lightyellow" stroke="black" points="3219.5,-1889 3052.5,-1889 3052.5,-1836 3219.5,-1836 3219.5,-1889"/>
<text text-anchor="middle" x="3136" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="3136" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3136" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_1_2 -->
<g id="node126" class="node">
<title>gelu_1_2</title>
<polygon fill="lightyellow" stroke="black" points="3108.5,-1799 2955.5,-1799 2955.5,-1746 3108.5,-1746 3108.5,-1799"/>
<text text-anchor="middle" x="3032" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3032" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="3032" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- mlp_col_1_2&#45;&gt;gelu_1_2 -->
<g id="edge67" class="edge">
<title>mlp_col_1_2&#45;&gt;gelu_1_2</title>
<path fill="none" stroke="black" d="M3105.64,-1835.81C3094.53,-1826.41 3081.82,-1815.66 3070.12,-1805.76"/>
<polygon fill="black" stroke="black" points="3072.11,-1802.86 3062.22,-1799.07 3067.59,-1808.2 3072.11,-1802.86"/>
</g>
<!-- mlp_row_1_2 -->
<g id="node139" class="node">
<title>mlp_row_1_2</title>
<polygon fill="lightyellow" stroke="black" points="3108.5,-1709 2955.5,-1709 2955.5,-1656 3108.5,-1656 3108.5,-1709"/>
<text text-anchor="middle" x="3032" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="3032" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3032" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_1_2&#45;&gt;mlp_row_1_2 -->
<g id="edge75" class="edge">
<title>gelu_1_2&#45;&gt;mlp_row_1_2</title>
<path fill="none" stroke="black" d="M3032,-1745.57C3032,-1737.34 3032,-1728.08 3032,-1719.28"/>
<polygon fill="black" stroke="black" points="3035.5,-1719.24 3032,-1709.24 3028.5,-1719.24 3035.5,-1719.24"/>
</g>
<!-- mlp_col_1_3 -->
<g id="node127" class="node">
<title>mlp_col_1_3</title>
<polygon fill="lightcoral" stroke="black" points="1924.5,-1889 1757.5,-1889 1757.5,-1836 1924.5,-1836 1924.5,-1889"/>
<text text-anchor="middle" x="1841" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1841" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1841" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_1_3 -->
<g id="node128" class="node">
<title>gelu_1_3</title>
<polygon fill="lightcoral" stroke="black" points="1911.5,-1799 1758.5,-1799 1758.5,-1746 1911.5,-1746 1911.5,-1799"/>
<text text-anchor="middle" x="1835" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1835" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1835" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- mlp_col_1_3&#45;&gt;gelu_1_3 -->
<g id="edge68" class="edge">
<title>mlp_col_1_3&#45;&gt;gelu_1_3</title>
<path fill="none" stroke="black" d="M1839.23,-1835.57C1838.67,-1827.34 1838.04,-1818.08 1837.44,-1809.28"/>
<polygon fill="black" stroke="black" points="1840.93,-1808.98 1836.76,-1799.24 1833.94,-1809.46 1840.93,-1808.98"/>
</g>
<!-- mlp_row_1_3 -->
<g id="node140" class="node">
<title>mlp_row_1_3</title>
<polygon fill="lightcoral" stroke="black" points="1911.5,-1709 1758.5,-1709 1758.5,-1656 1911.5,-1656 1911.5,-1709"/>
<text text-anchor="middle" x="1835" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1835" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1835" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_1_3&#45;&gt;mlp_row_1_3 -->
<g id="edge76" class="edge">
<title>gelu_1_3&#45;&gt;mlp_row_1_3</title>
<path fill="none" stroke="black" d="M1835,-1745.57C1835,-1737.34 1835,-1728.08 1835,-1719.28"/>
<polygon fill="black" stroke="black" points="1838.5,-1719.24 1835,-1709.24 1831.5,-1719.24 1838.5,-1719.24"/>
</g>
<!-- mlp_col_1_4 -->
<g id="node129" class="node">
<title>mlp_col_1_4</title>
<polygon fill="lightpink" stroke="black" points="2109.5,-1889 1942.5,-1889 1942.5,-1836 2109.5,-1836 2109.5,-1889"/>
<text text-anchor="middle" x="2026" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2026" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2026" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_1_4 -->
<g id="node130" class="node">
<title>gelu_1_4</title>
<polygon fill="lightpink" stroke="black" points="2082.5,-1799 1929.5,-1799 1929.5,-1746 2082.5,-1746 2082.5,-1799"/>
<text text-anchor="middle" x="2006" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2006" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2006" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- mlp_col_1_4&#45;&gt;gelu_1_4 -->
<g id="edge69" class="edge">
<title>mlp_col_1_4&#45;&gt;gelu_1_4</title>
<path fill="none" stroke="black" d="M2020.11,-1835.57C2018.24,-1827.34 2016.13,-1818.08 2014.13,-1809.28"/>
<polygon fill="black" stroke="black" points="2017.48,-1808.22 2011.85,-1799.24 2010.65,-1809.77 2017.48,-1808.22"/>
</g>
<!-- mlp_row_1_4 -->
<g id="node141" class="node">
<title>mlp_row_1_4</title>
<polygon fill="lightpink" stroke="black" points="2082.5,-1709 1929.5,-1709 1929.5,-1656 2082.5,-1656 2082.5,-1709"/>
<text text-anchor="middle" x="2006" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2006" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2006" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_1_4&#45;&gt;mlp_row_1_4 -->
<g id="edge77" class="edge">
<title>gelu_1_4&#45;&gt;mlp_row_1_4</title>
<path fill="none" stroke="black" d="M2006,-1745.57C2006,-1737.34 2006,-1728.08 2006,-1719.28"/>
<polygon fill="black" stroke="black" points="2009.5,-1719.24 2006,-1709.24 2002.5,-1719.24 2009.5,-1719.24"/>
</g>
<!-- mlp_col_1_5 -->
<g id="node131" class="node">
<title>mlp_col_1_5</title>
<polygon fill="lightcyan" stroke="black" points="2294.5,-1889 2127.5,-1889 2127.5,-1836 2294.5,-1836 2294.5,-1889"/>
<text text-anchor="middle" x="2211" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2211" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2211" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_1_5 -->
<g id="node132" class="node">
<title>gelu_1_5</title>
<polygon fill="lightcyan" stroke="black" points="2253.5,-1799 2100.5,-1799 2100.5,-1746 2253.5,-1746 2253.5,-1799"/>
<text text-anchor="middle" x="2177" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2177" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2177" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- mlp_col_1_5&#45;&gt;gelu_1_5 -->
<g id="edge70" class="edge">
<title>mlp_col_1_5&#45;&gt;gelu_1_5</title>
<path fill="none" stroke="black" d="M2200.98,-1835.57C2197.73,-1827.16 2194.07,-1817.68 2190.6,-1808.7"/>
<polygon fill="black" stroke="black" points="2193.81,-1807.31 2186.95,-1799.24 2187.28,-1809.83 2193.81,-1807.31"/>
</g>
<!-- mlp_row_1_5 -->
<g id="node142" class="node">
<title>mlp_row_1_5</title>
<polygon fill="lightcyan" stroke="black" points="2253.5,-1709 2100.5,-1709 2100.5,-1656 2253.5,-1656 2253.5,-1709"/>
<text text-anchor="middle" x="2177" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2177" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2177" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_1_5&#45;&gt;mlp_row_1_5 -->
<g id="edge78" class="edge">
<title>gelu_1_5&#45;&gt;mlp_row_1_5</title>
<path fill="none" stroke="black" d="M2177,-1745.57C2177,-1737.34 2177,-1728.08 2177,-1719.28"/>
<polygon fill="black" stroke="black" points="2180.5,-1719.24 2177,-1709.24 2173.5,-1719.24 2180.5,-1719.24"/>
</g>
<!-- mlp_col_1_6 -->
<g id="node133" class="node">
<title>mlp_col_1_6</title>
<polygon fill="lightgrey" stroke="black" points="2479.5,-1889 2312.5,-1889 2312.5,-1836 2479.5,-1836 2479.5,-1889"/>
<text text-anchor="middle" x="2396" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2396" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2396" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_1_6 -->
<g id="node134" class="node">
<title>gelu_1_6</title>
<polygon fill="lightgrey" stroke="black" points="2424.5,-1799 2271.5,-1799 2271.5,-1746 2424.5,-1746 2424.5,-1799"/>
<text text-anchor="middle" x="2348" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2348" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2348" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- mlp_col_1_6&#45;&gt;gelu_1_6 -->
<g id="edge71" class="edge">
<title>mlp_col_1_6&#45;&gt;gelu_1_6</title>
<path fill="none" stroke="black" d="M2381.86,-1835.57C2377.17,-1826.98 2371.88,-1817.27 2366.89,-1808.13"/>
<polygon fill="black" stroke="black" points="2369.9,-1806.34 2362.04,-1799.24 2363.76,-1809.7 2369.9,-1806.34"/>
</g>
<!-- mlp_row_1_6 -->
<g id="node143" class="node">
<title>mlp_row_1_6</title>
<polygon fill="lightgrey" stroke="black" points="2424.5,-1709 2271.5,-1709 2271.5,-1656 2424.5,-1656 2424.5,-1709"/>
<text text-anchor="middle" x="2348" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2348" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2348" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_1_6&#45;&gt;mlp_row_1_6 -->
<g id="edge79" class="edge">
<title>gelu_1_6&#45;&gt;mlp_row_1_6</title>
<path fill="none" stroke="black" d="M2348,-1745.57C2348,-1737.34 2348,-1728.08 2348,-1719.28"/>
<polygon fill="black" stroke="black" points="2351.5,-1719.24 2348,-1709.24 2344.5,-1719.24 2351.5,-1719.24"/>
</g>
<!-- mlp_col_1_7 -->
<g id="node135" class="node">
<title>mlp_col_1_7</title>
<polygon fill="lightseagreen" stroke="black" points="2664.5,-1889 2497.5,-1889 2497.5,-1836 2664.5,-1836 2664.5,-1889"/>
<text text-anchor="middle" x="2581" y="-1873.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2581" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2581" y="-1843.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_1_7 -->
<g id="node136" class="node">
<title>gelu_1_7</title>
<polygon fill="lightseagreen" stroke="black" points="2595.5,-1799 2442.5,-1799 2442.5,-1746 2595.5,-1746 2595.5,-1799"/>
<text text-anchor="middle" x="2519" y="-1783.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2519" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2519" y="-1753.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- mlp_col_1_7&#45;&gt;gelu_1_7 -->
<g id="edge72" class="edge">
<title>mlp_col_1_7&#45;&gt;gelu_1_7</title>
<path fill="none" stroke="black" d="M2562.73,-1835.57C2556.55,-1826.8 2549.55,-1816.87 2543,-1807.56"/>
<polygon fill="black" stroke="black" points="2545.76,-1805.4 2537.14,-1799.24 2540.03,-1809.43 2545.76,-1805.4"/>
</g>
<!-- mlp_row_1_7 -->
<g id="node144" class="node">
<title>mlp_row_1_7</title>
<polygon fill="lightseagreen" stroke="black" points="2595.5,-1709 2442.5,-1709 2442.5,-1656 2595.5,-1656 2595.5,-1709"/>
<text text-anchor="middle" x="2519" y="-1693.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2519" y="-1678.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2519" y="-1663.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_1_7&#45;&gt;mlp_row_1_7 -->
<g id="edge80" class="edge">
<title>gelu_1_7&#45;&gt;mlp_row_1_7</title>
<path fill="none" stroke="black" d="M2519,-1745.57C2519,-1737.34 2519,-1728.08 2519,-1719.28"/>
<polygon fill="black" stroke="black" points="2522.5,-1719.24 2519,-1709.24 2515.5,-1719.24 2522.5,-1719.24"/>
</g>
<!-- mlp_allreduce_1 -->
<g id="node145" class="node">
<title>mlp_allreduce_1</title>
<polygon fill="yellow" stroke="black" points="2595.5,-1605 2442.5,-1605 2442.5,-1552 2595.5,-1552 2595.5,-1605"/>
<text text-anchor="middle" x="2519" y="-1589.8" font-family="Times,serif" font-size="14.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="2519" y="-1574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2519" y="-1559.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_row_1_0&#45;&gt;mlp_allreduce_1 -->
<g id="edge81" class="edge">
<title>mlp_row_1_0&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2646.85,-1655.76C2623.67,-1641.94 2594.95,-1624.8 2570.59,-1610.28"/>
<polygon fill="black" stroke="black" points="2572.22,-1607.17 2561.84,-1605.05 2568.64,-1613.18 2572.22,-1607.17"/>
</g>
<!-- mlp_row_1_1&#45;&gt;mlp_allreduce_1 -->
<g id="edge82" class="edge">
<title>mlp_row_1_1&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2784.09,-1658.42C2781.36,-1657.6 2778.66,-1656.79 2776,-1656 2719.23,-1639.04 2655.39,-1620.03 2605.54,-1605.21"/>
<polygon fill="black" stroke="black" points="2606.35,-1601.8 2595.76,-1602.3 2604.35,-1608.51 2606.35,-1601.8"/>
</g>
<!-- mlp_row_1_2&#45;&gt;mlp_allreduce_1 -->
<g id="edge83" class="edge">
<title>mlp_row_1_2&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2955.2,-1658.03C2952.44,-1657.32 2949.7,-1656.64 2947,-1656 2829.94,-1628.08 2692.67,-1605.26 2605.78,-1592.02"/>
<polygon fill="black" stroke="black" points="2606.11,-1588.53 2595.7,-1590.5 2605.06,-1595.45 2606.11,-1588.53"/>
</g>
<!-- mlp_row_1_3&#45;&gt;mlp_allreduce_1 -->
<g id="edge84" class="edge">
<title>mlp_row_1_3&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1911.77,-1657.87C1914.54,-1657.21 1917.29,-1656.58 1920,-1656 2100.02,-1617.33 2314.97,-1595.71 2432.19,-1585.95"/>
<polygon fill="black" stroke="black" points="2432.5,-1589.44 2442.18,-1585.13 2431.93,-1582.46 2432.5,-1589.44"/>
</g>
<!-- mlp_row_1_4&#45;&gt;mlp_allreduce_1 -->
<g id="edge85" class="edge">
<title>mlp_row_1_4&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2082.8,-1658.03C2085.56,-1657.32 2088.3,-1656.64 2091,-1656 2208.06,-1628.08 2345.33,-1605.26 2432.22,-1592.02"/>
<polygon fill="black" stroke="black" points="2432.94,-1595.45 2442.3,-1590.5 2431.89,-1588.53 2432.94,-1595.45"/>
</g>
<!-- mlp_row_1_5&#45;&gt;mlp_allreduce_1 -->
<g id="edge86" class="edge">
<title>mlp_row_1_5&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2253.91,-1658.42C2256.64,-1657.6 2259.34,-1656.79 2262,-1656 2318.77,-1639.04 2382.61,-1620.03 2432.46,-1605.21"/>
<polygon fill="black" stroke="black" points="2433.65,-1608.51 2442.24,-1602.3 2431.65,-1601.8 2433.65,-1608.51"/>
</g>
<!-- mlp_row_1_6&#45;&gt;mlp_allreduce_1 -->
<g id="edge87" class="edge">
<title>mlp_row_1_6&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2391.15,-1655.76C2414.33,-1641.94 2443.05,-1624.8 2467.41,-1610.28"/>
<polygon fill="black" stroke="black" points="2469.36,-1613.18 2476.16,-1605.05 2465.78,-1607.17 2469.36,-1613.18"/>
</g>
<!-- mlp_row_1_7&#45;&gt;mlp_allreduce_1 -->
<g id="edge88" class="edge">
<title>mlp_row_1_7&#45;&gt;mlp_allreduce_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2519,-1655.76C2519,-1643.56 2519,-1628.78 2519,-1615.49"/>
<polygon fill="black" stroke="black" points="2522.5,-1615.23 2519,-1605.23 2515.5,-1615.23 2522.5,-1615.23"/>
</g>
<!-- residual2_1 -->
<g id="node197" class="node">
<title>residual2_1</title>
<polygon fill="orange" stroke="black" points="3050.5,-1501 2897.5,-1501 2897.5,-1448 3050.5,-1448 3050.5,-1501"/>
<text text-anchor="middle" x="2974" y="-1485.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2974" y="-1470.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2974" y="-1455.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_allreduce_1&#45;&gt;residual2_1 -->
<g id="edge298" class="edge">
<title>mlp_allreduce_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M2595.67,-1560.31C2676.43,-1542.21 2803.34,-1513.76 2887.59,-1494.87"/>
<polygon fill="black" stroke="black" points="2888.4,-1498.28 2897.4,-1492.67 2886.87,-1491.45 2888.4,-1498.28"/>
</g>
<!-- qkv_1_0_0 -->
<g id="node147" class="node">
<title>qkv_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="4976.5,-1979 4823.5,-1979 4823.5,-1926 4976.5,-1926 4976.5,-1979"/>
<text text-anchor="middle" x="4900" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4900" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4900" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;qkv_1_0_0 -->
<g id="edge240" class="edge">
<title>ln1_1&#45;&gt;qkv_1_0_0</title>
<path fill="none" stroke="black" d="M4264.74,-2038.14C4382.8,-2031.99 4615.69,-2015.99 4810,-1979 4811.08,-1978.79 4812.16,-1978.58 4813.25,-1978.36"/>
<polygon fill="black" stroke="black" points="4814.09,-1981.76 4823.13,-1976.24 4812.62,-1974.92 4814.09,-1981.76"/>
</g>
<!-- reshape_1_0_0 -->
<g id="node148" class="node">
<title>reshape_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="5022,-1889 4860,-1889 4860,-1836 5022,-1836 5022,-1889"/>
<text text-anchor="middle" x="4941" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4941" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4941" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_1_0_0&#45;&gt;reshape_1_0_0 -->
<g id="edge241" class="edge">
<title>qkv_1_0_0&#45;&gt;reshape_1_0_0</title>
<path fill="none" stroke="black" d="M4912.08,-1925.57C4916.04,-1917.07 4920.51,-1907.48 4924.73,-1898.42"/>
<polygon fill="black" stroke="black" points="4927.96,-1899.78 4929.01,-1889.24 4921.61,-1896.83 4927.96,-1899.78"/>
</g>
<!-- attn_1_0_0 -->
<g id="node149" class="node">
<title>attn_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="5081,-1799 4855,-1799 4855,-1746 5081,-1746 5081,-1799"/>
<text text-anchor="middle" x="4968" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4968" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4968" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge242" class="edge">
<title>reshape_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="black" d="M4948.95,-1835.57C4951.51,-1827.25 4954.38,-1817.88 4957.11,-1808.99"/>
<polygon fill="black" stroke="black" points="4960.51,-1809.83 4960.1,-1799.24 4953.82,-1807.78 4960.51,-1809.83"/>
</g>
<!-- attn_1_0_0&#45;&gt;proj_1_0_0 -->
<g id="edge243" class="edge">
<title>attn_1_0_0&#45;&gt;proj_1_0_0</title>
<path fill="none" stroke="black" d="M4951.21,-1745.57C4945.58,-1736.89 4939.22,-1727.07 4933.25,-1717.85"/>
<polygon fill="black" stroke="black" points="4936.05,-1715.73 4927.67,-1709.24 4930.17,-1719.54 4936.05,-1715.73"/>
</g>
<!-- qkv_1_0_1 -->
<g id="node150" class="node">
<title>qkv_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4800.5,-1979 4647.5,-1979 4647.5,-1926 4800.5,-1926 4800.5,-1979"/>
<text text-anchor="middle" x="4724" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4724" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4724" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_1_0_1 -->
<g id="node151" class="node">
<title>reshape_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4805,-1889 4643,-1889 4643,-1836 4805,-1836 4805,-1889"/>
<text text-anchor="middle" x="4724" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4724" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4724" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_1_0_1&#45;&gt;reshape_1_0_1 -->
<g id="edge244" class="edge">
<title>qkv_1_0_1&#45;&gt;reshape_1_0_1</title>
<path fill="none" stroke="black" d="M4724,-1925.57C4724,-1917.34 4724,-1908.08 4724,-1899.28"/>
<polygon fill="black" stroke="black" points="4727.5,-1899.24 4724,-1889.24 4720.5,-1899.24 4727.5,-1899.24"/>
</g>
<!-- attn_1_0_1 -->
<g id="node152" class="node">
<title>attn_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4837,-1799 4611,-1799 4611,-1746 4837,-1746 4837,-1799"/>
<text text-anchor="middle" x="4724" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4724" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4724" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge245" class="edge">
<title>reshape_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="black" d="M4724,-1835.57C4724,-1827.34 4724,-1818.08 4724,-1809.28"/>
<polygon fill="black" stroke="black" points="4727.5,-1809.24 4724,-1799.24 4720.5,-1809.24 4727.5,-1809.24"/>
</g>
<!-- attn_1_0_1&#45;&gt;proj_1_0_1 -->
<g id="edge246" class="edge">
<title>attn_1_0_1&#45;&gt;proj_1_0_1</title>
<path fill="none" stroke="black" d="M4724,-1745.57C4724,-1737.34 4724,-1728.08 4724,-1719.28"/>
<polygon fill="black" stroke="black" points="4727.5,-1719.24 4724,-1709.24 4720.5,-1719.24 4727.5,-1719.24"/>
</g>
<!-- qkv_1_0_2 -->
<g id="node153" class="node">
<title>qkv_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="4556.5,-1979 4403.5,-1979 4403.5,-1926 4556.5,-1926 4556.5,-1979"/>
<text text-anchor="middle" x="4480" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4480" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4480" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_1_0_2 -->
<g id="node154" class="node">
<title>reshape_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="4561,-1889 4399,-1889 4399,-1836 4561,-1836 4561,-1889"/>
<text text-anchor="middle" x="4480" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4480" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4480" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_1_0_2&#45;&gt;reshape_1_0_2 -->
<g id="edge247" class="edge">
<title>qkv_1_0_2&#45;&gt;reshape_1_0_2</title>
<path fill="none" stroke="black" d="M4480,-1925.57C4480,-1917.34 4480,-1908.08 4480,-1899.28"/>
<polygon fill="black" stroke="black" points="4483.5,-1899.24 4480,-1889.24 4476.5,-1899.24 4483.5,-1899.24"/>
</g>
<!-- attn_1_0_2 -->
<g id="node155" class="node">
<title>attn_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="4593,-1799 4367,-1799 4367,-1746 4593,-1746 4593,-1799"/>
<text text-anchor="middle" x="4480" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4480" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4480" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge248" class="edge">
<title>reshape_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="black" d="M4480,-1835.57C4480,-1827.34 4480,-1818.08 4480,-1809.28"/>
<polygon fill="black" stroke="black" points="4483.5,-1809.24 4480,-1799.24 4476.5,-1809.24 4483.5,-1809.24"/>
</g>
<!-- attn_1_0_2&#45;&gt;proj_1_0_2 -->
<g id="edge249" class="edge">
<title>attn_1_0_2&#45;&gt;proj_1_0_2</title>
<path fill="none" stroke="black" d="M4492.08,-1745.57C4496.04,-1737.07 4500.51,-1727.48 4504.73,-1718.42"/>
<polygon fill="black" stroke="black" points="4507.96,-1719.78 4509.01,-1709.24 4501.61,-1716.83 4507.96,-1719.78"/>
</g>
<!-- qkv_1_0_3 -->
<g id="node156" class="node">
<title>qkv_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="4312.5,-1979 4159.5,-1979 4159.5,-1926 4312.5,-1926 4312.5,-1979"/>
<text text-anchor="middle" x="4236" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4236" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4236" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_1_0_3 -->
<g id="node157" class="node">
<title>reshape_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="4317,-1889 4155,-1889 4155,-1836 4317,-1836 4317,-1889"/>
<text text-anchor="middle" x="4236" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4236" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4236" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_1_0_3&#45;&gt;reshape_1_0_3 -->
<g id="edge250" class="edge">
<title>qkv_1_0_3&#45;&gt;reshape_1_0_3</title>
<path fill="none" stroke="black" d="M4236,-1925.57C4236,-1917.34 4236,-1908.08 4236,-1899.28"/>
<polygon fill="black" stroke="black" points="4239.5,-1899.24 4236,-1889.24 4232.5,-1899.24 4239.5,-1899.24"/>
</g>
<!-- attn_1_0_3 -->
<g id="node158" class="node">
<title>attn_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="4349,-1799 4123,-1799 4123,-1746 4349,-1746 4349,-1799"/>
<text text-anchor="middle" x="4236" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4236" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4236" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge251" class="edge">
<title>reshape_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="black" d="M4236,-1835.57C4236,-1827.34 4236,-1818.08 4236,-1809.28"/>
<polygon fill="black" stroke="black" points="4239.5,-1809.24 4236,-1799.24 4232.5,-1809.24 4239.5,-1809.24"/>
</g>
<!-- attn_1_0_3&#45;&gt;proj_1_0_3 -->
<g id="edge252" class="edge">
<title>attn_1_0_3&#45;&gt;proj_1_0_3</title>
<path fill="none" stroke="black" d="M4254.27,-1745.57C4260.45,-1736.8 4267.45,-1726.87 4274,-1717.56"/>
<polygon fill="black" stroke="black" points="4276.97,-1719.43 4279.86,-1709.24 4271.24,-1715.4 4276.97,-1719.43"/>
</g>
<!-- qkv_1_1_0 -->
<g id="node159" class="node">
<title>qkv_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="3824.5,-1979 3671.5,-1979 3671.5,-1926 3824.5,-1926 3824.5,-1979"/>
<text text-anchor="middle" x="3748" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3748" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3748" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_1_1_0 -->
<g id="node160" class="node">
<title>reshape_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="3829,-1889 3667,-1889 3667,-1836 3829,-1836 3829,-1889"/>
<text text-anchor="middle" x="3748" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3748" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3748" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_1_1_0&#45;&gt;reshape_1_1_0 -->
<g id="edge253" class="edge">
<title>qkv_1_1_0&#45;&gt;reshape_1_1_0</title>
<path fill="none" stroke="black" d="M3748,-1925.57C3748,-1917.34 3748,-1908.08 3748,-1899.28"/>
<polygon fill="black" stroke="black" points="3751.5,-1899.24 3748,-1889.24 3744.5,-1899.24 3751.5,-1899.24"/>
</g>
<!-- attn_1_1_0 -->
<g id="node161" class="node">
<title>attn_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="3861,-1799 3635,-1799 3635,-1746 3861,-1746 3861,-1799"/>
<text text-anchor="middle" x="3748" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3748" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3748" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge254" class="edge">
<title>reshape_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="black" d="M3748,-1835.57C3748,-1827.34 3748,-1818.08 3748,-1809.28"/>
<polygon fill="black" stroke="black" points="3751.5,-1809.24 3748,-1799.24 3744.5,-1809.24 3751.5,-1809.24"/>
</g>
<!-- attn_1_1_0&#45;&gt;proj_1_1_0 -->
<g id="edge255" class="edge">
<title>attn_1_1_0&#45;&gt;proj_1_1_0</title>
<path fill="none" stroke="black" d="M3748,-1745.57C3748,-1737.34 3748,-1728.08 3748,-1719.28"/>
<polygon fill="black" stroke="black" points="3751.5,-1719.24 3748,-1709.24 3744.5,-1719.24 3751.5,-1719.24"/>
</g>
<!-- qkv_1_1_1 -->
<g id="node162" class="node">
<title>qkv_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="3594.5,-1979 3441.5,-1979 3441.5,-1926 3594.5,-1926 3594.5,-1979"/>
<text text-anchor="middle" x="3518" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3518" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3518" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_1_1_1 -->
<g id="node163" class="node">
<title>reshape_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="3599,-1889 3437,-1889 3437,-1836 3599,-1836 3599,-1889"/>
<text text-anchor="middle" x="3518" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3518" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3518" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_1_1_1&#45;&gt;reshape_1_1_1 -->
<g id="edge256" class="edge">
<title>qkv_1_1_1&#45;&gt;reshape_1_1_1</title>
<path fill="none" stroke="black" d="M3518,-1925.57C3518,-1917.34 3518,-1908.08 3518,-1899.28"/>
<polygon fill="black" stroke="black" points="3521.5,-1899.24 3518,-1889.24 3514.5,-1899.24 3521.5,-1899.24"/>
</g>
<!-- attn_1_1_1 -->
<g id="node164" class="node">
<title>attn_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="3617,-1799 3391,-1799 3391,-1746 3617,-1746 3617,-1799"/>
<text text-anchor="middle" x="3504" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3504" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3504" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge257" class="edge">
<title>reshape_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="black" d="M3513.88,-1835.57C3512.57,-1827.34 3511.09,-1818.08 3509.69,-1809.28"/>
<polygon fill="black" stroke="black" points="3513.12,-1808.57 3508.1,-1799.24 3506.21,-1809.67 3513.12,-1808.57"/>
</g>
<!-- attn_1_1_1&#45;&gt;proj_1_1_1 -->
<g id="edge258" class="edge">
<title>attn_1_1_1&#45;&gt;proj_1_1_1</title>
<path fill="none" stroke="black" d="M3522.27,-1745.57C3528.45,-1736.8 3535.45,-1726.87 3542,-1717.56"/>
<polygon fill="black" stroke="black" points="3544.97,-1719.43 3547.86,-1709.24 3539.24,-1715.4 3544.97,-1719.43"/>
</g>
<!-- qkv_1_1_2 -->
<g id="node165" class="node">
<title>qkv_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="3414.5,-1979 3261.5,-1979 3261.5,-1926 3414.5,-1926 3414.5,-1979"/>
<text text-anchor="middle" x="3338" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3338" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3338" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_1_1_2 -->
<g id="node166" class="node">
<title>reshape_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="3419,-1889 3257,-1889 3257,-1836 3419,-1836 3419,-1889"/>
<text text-anchor="middle" x="3338" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3338" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3338" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_1_1_2&#45;&gt;reshape_1_1_2 -->
<g id="edge259" class="edge">
<title>qkv_1_1_2&#45;&gt;reshape_1_1_2</title>
<path fill="none" stroke="black" d="M3338,-1925.57C3338,-1917.34 3338,-1908.08 3338,-1899.28"/>
<polygon fill="black" stroke="black" points="3341.5,-1899.24 3338,-1889.24 3334.5,-1899.24 3341.5,-1899.24"/>
</g>
<!-- attn_1_1_2 -->
<g id="node167" class="node">
<title>attn_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="3373,-1799 3147,-1799 3147,-1746 3373,-1746 3373,-1799"/>
<text text-anchor="middle" x="3260" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3260" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3260" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge260" class="edge">
<title>reshape_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="black" d="M3315.02,-1835.57C3307.09,-1826.62 3298.08,-1816.46 3289.69,-1806.99"/>
<polygon fill="black" stroke="black" points="3292.07,-1804.4 3282.82,-1799.24 3286.83,-1809.05 3292.07,-1804.4"/>
</g>
<!-- attn_1_1_2&#45;&gt;proj_1_1_2 -->
<g id="edge261" class="edge">
<title>attn_1_1_2&#45;&gt;proj_1_1_2</title>
<path fill="none" stroke="black" d="M3278.27,-1745.57C3284.45,-1736.8 3291.45,-1726.87 3298,-1717.56"/>
<polygon fill="black" stroke="black" points="3300.97,-1719.43 3303.86,-1709.24 3295.24,-1715.4 3300.97,-1719.43"/>
</g>
<!-- qkv_1_1_3 -->
<g id="node168" class="node">
<title>qkv_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4068.5,-1979 3915.5,-1979 3915.5,-1926 4068.5,-1926 4068.5,-1979"/>
<text text-anchor="middle" x="3992" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3992" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3992" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_1_1_3 -->
<g id="node169" class="node">
<title>reshape_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4073,-1889 3911,-1889 3911,-1836 4073,-1836 4073,-1889"/>
<text text-anchor="middle" x="3992" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3992" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3992" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_1_1_3&#45;&gt;reshape_1_1_3 -->
<g id="edge262" class="edge">
<title>qkv_1_1_3&#45;&gt;reshape_1_1_3</title>
<path fill="none" stroke="black" d="M3992,-1925.57C3992,-1917.34 3992,-1908.08 3992,-1899.28"/>
<polygon fill="black" stroke="black" points="3995.5,-1899.24 3992,-1889.24 3988.5,-1899.24 3995.5,-1899.24"/>
</g>
<!-- attn_1_1_3 -->
<g id="node170" class="node">
<title>attn_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4105,-1799 3879,-1799 3879,-1746 4105,-1746 4105,-1799"/>
<text text-anchor="middle" x="3992" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3992" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3992" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge263" class="edge">
<title>reshape_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="black" d="M3992,-1835.57C3992,-1827.34 3992,-1818.08 3992,-1809.28"/>
<polygon fill="black" stroke="black" points="3995.5,-1809.24 3992,-1799.24 3988.5,-1809.24 3995.5,-1809.24"/>
</g>
<!-- attn_1_1_3&#45;&gt;proj_1_1_3 -->
<g id="edge264" class="edge">
<title>attn_1_1_3&#45;&gt;proj_1_1_3</title>
<path fill="none" stroke="black" d="M3973.73,-1745.57C3967.55,-1736.8 3960.55,-1726.87 3954,-1717.56"/>
<polygon fill="black" stroke="black" points="3956.76,-1715.4 3948.14,-1709.24 3951.03,-1719.43 3956.76,-1715.4"/>
</g>
<!-- qkv_1_2_0 -->
<g id="node171" class="node">
<title>qkv_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6264.5,-1979 6111.5,-1979 6111.5,-1926 6264.5,-1926 6264.5,-1979"/>
<text text-anchor="middle" x="6188" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6188" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6188" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_1_2_0 -->
<g id="node172" class="node">
<title>reshape_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6269,-1889 6107,-1889 6107,-1836 6269,-1836 6269,-1889"/>
<text text-anchor="middle" x="6188" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6188" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6188" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_1_2_0&#45;&gt;reshape_1_2_0 -->
<g id="edge265" class="edge">
<title>qkv_1_2_0&#45;&gt;reshape_1_2_0</title>
<path fill="none" stroke="black" d="M6188,-1925.57C6188,-1917.34 6188,-1908.08 6188,-1899.28"/>
<polygon fill="black" stroke="black" points="6191.5,-1899.24 6188,-1889.24 6184.5,-1899.24 6191.5,-1899.24"/>
</g>
<!-- attn_1_2_0 -->
<g id="node173" class="node">
<title>attn_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6301,-1799 6075,-1799 6075,-1746 6301,-1746 6301,-1799"/>
<text text-anchor="middle" x="6188" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6188" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6188" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge266" class="edge">
<title>reshape_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="black" d="M6188,-1835.57C6188,-1827.34 6188,-1818.08 6188,-1809.28"/>
<polygon fill="black" stroke="black" points="6191.5,-1809.24 6188,-1799.24 6184.5,-1809.24 6191.5,-1809.24"/>
</g>
<!-- attn_1_2_0&#45;&gt;proj_1_2_0 -->
<g id="edge267" class="edge">
<title>attn_1_2_0&#45;&gt;proj_1_2_0</title>
<path fill="none" stroke="black" d="M6200.08,-1745.57C6204.04,-1737.07 6208.51,-1727.48 6212.73,-1718.42"/>
<polygon fill="black" stroke="black" points="6215.96,-1719.78 6217.01,-1709.24 6209.61,-1716.83 6215.96,-1719.78"/>
</g>
<!-- qkv_1_2_1 -->
<g id="node174" class="node">
<title>qkv_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6996.5,-1979 6843.5,-1979 6843.5,-1926 6996.5,-1926 6996.5,-1979"/>
<text text-anchor="middle" x="6920" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6920" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6920" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_1_2_1 -->
<g id="node175" class="node">
<title>reshape_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7001,-1889 6839,-1889 6839,-1836 7001,-1836 7001,-1889"/>
<text text-anchor="middle" x="6920" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6920" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6920" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_1_2_1&#45;&gt;reshape_1_2_1 -->
<g id="edge268" class="edge">
<title>qkv_1_2_1&#45;&gt;reshape_1_2_1</title>
<path fill="none" stroke="black" d="M6920,-1925.57C6920,-1917.34 6920,-1908.08 6920,-1899.28"/>
<polygon fill="black" stroke="black" points="6923.5,-1899.24 6920,-1889.24 6916.5,-1899.24 6923.5,-1899.24"/>
</g>
<!-- attn_1_2_1 -->
<g id="node176" class="node">
<title>attn_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7033,-1799 6807,-1799 6807,-1746 7033,-1746 7033,-1799"/>
<text text-anchor="middle" x="6920" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6920" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6920" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge269" class="edge">
<title>reshape_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="black" d="M6920,-1835.57C6920,-1827.34 6920,-1818.08 6920,-1809.28"/>
<polygon fill="black" stroke="black" points="6923.5,-1809.24 6920,-1799.24 6916.5,-1809.24 6923.5,-1809.24"/>
</g>
<!-- attn_1_2_1&#45;&gt;proj_1_2_1 -->
<g id="edge270" class="edge">
<title>attn_1_2_1&#45;&gt;proj_1_2_1</title>
<path fill="none" stroke="black" d="M6901.73,-1745.57C6895.55,-1736.8 6888.55,-1726.87 6882,-1717.56"/>
<polygon fill="black" stroke="black" points="6884.76,-1715.4 6876.14,-1709.24 6879.03,-1719.43 6884.76,-1715.4"/>
</g>
<!-- qkv_1_2_2 -->
<g id="node177" class="node">
<title>qkv_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6752.5,-1979 6599.5,-1979 6599.5,-1926 6752.5,-1926 6752.5,-1979"/>
<text text-anchor="middle" x="6676" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6676" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6676" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_1_2_2 -->
<g id="node178" class="node">
<title>reshape_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6757,-1889 6595,-1889 6595,-1836 6757,-1836 6757,-1889"/>
<text text-anchor="middle" x="6676" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6676" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6676" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_1_2_2&#45;&gt;reshape_1_2_2 -->
<g id="edge271" class="edge">
<title>qkv_1_2_2&#45;&gt;reshape_1_2_2</title>
<path fill="none" stroke="black" d="M6676,-1925.57C6676,-1917.34 6676,-1908.08 6676,-1899.28"/>
<polygon fill="black" stroke="black" points="6679.5,-1899.24 6676,-1889.24 6672.5,-1899.24 6679.5,-1899.24"/>
</g>
<!-- attn_1_2_2 -->
<g id="node179" class="node">
<title>attn_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6789,-1799 6563,-1799 6563,-1746 6789,-1746 6789,-1799"/>
<text text-anchor="middle" x="6676" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6676" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6676" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge272" class="edge">
<title>reshape_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="black" d="M6676,-1835.57C6676,-1827.34 6676,-1818.08 6676,-1809.28"/>
<polygon fill="black" stroke="black" points="6679.5,-1809.24 6676,-1799.24 6672.5,-1809.24 6679.5,-1809.24"/>
</g>
<!-- attn_1_2_2&#45;&gt;proj_1_2_2 -->
<g id="edge273" class="edge">
<title>attn_1_2_2&#45;&gt;proj_1_2_2</title>
<path fill="none" stroke="black" d="M6663.92,-1745.57C6659.96,-1737.07 6655.49,-1727.48 6651.27,-1718.42"/>
<polygon fill="black" stroke="black" points="6654.39,-1716.83 6646.99,-1709.24 6648.04,-1719.78 6654.39,-1716.83"/>
</g>
<!-- qkv_1_2_3 -->
<g id="node180" class="node">
<title>qkv_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6508.5,-1979 6355.5,-1979 6355.5,-1926 6508.5,-1926 6508.5,-1979"/>
<text text-anchor="middle" x="6432" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6432" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6432" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_1_2_3 -->
<g id="node181" class="node">
<title>reshape_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6513,-1889 6351,-1889 6351,-1836 6513,-1836 6513,-1889"/>
<text text-anchor="middle" x="6432" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6432" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6432" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_1_2_3&#45;&gt;reshape_1_2_3 -->
<g id="edge274" class="edge">
<title>qkv_1_2_3&#45;&gt;reshape_1_2_3</title>
<path fill="none" stroke="black" d="M6432,-1925.57C6432,-1917.34 6432,-1908.08 6432,-1899.28"/>
<polygon fill="black" stroke="black" points="6435.5,-1899.24 6432,-1889.24 6428.5,-1899.24 6435.5,-1899.24"/>
</g>
<!-- attn_1_2_3 -->
<g id="node182" class="node">
<title>attn_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6545,-1799 6319,-1799 6319,-1746 6545,-1746 6545,-1799"/>
<text text-anchor="middle" x="6432" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6432" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6432" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge275" class="edge">
<title>reshape_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="black" d="M6432,-1835.57C6432,-1827.34 6432,-1818.08 6432,-1809.28"/>
<polygon fill="black" stroke="black" points="6435.5,-1809.24 6432,-1799.24 6428.5,-1809.24 6435.5,-1809.24"/>
</g>
<!-- attn_1_2_3&#45;&gt;proj_1_2_3 -->
<g id="edge276" class="edge">
<title>attn_1_2_3&#45;&gt;proj_1_2_3</title>
<path fill="none" stroke="black" d="M6432,-1745.57C6432,-1737.34 6432,-1728.08 6432,-1719.28"/>
<polygon fill="black" stroke="black" points="6435.5,-1719.24 6432,-1709.24 6428.5,-1719.24 6435.5,-1719.24"/>
</g>
<!-- qkv_1_3_0 -->
<g id="node183" class="node">
<title>qkv_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="5288.5,-1979 5135.5,-1979 5135.5,-1926 5288.5,-1926 5288.5,-1979"/>
<text text-anchor="middle" x="5212" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5212" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5212" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_1_3_0 -->
<g id="node184" class="node">
<title>reshape_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="5293,-1889 5131,-1889 5131,-1836 5293,-1836 5293,-1889"/>
<text text-anchor="middle" x="5212" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5212" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5212" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_1_3_0&#45;&gt;reshape_1_3_0 -->
<g id="edge277" class="edge">
<title>qkv_1_3_0&#45;&gt;reshape_1_3_0</title>
<path fill="none" stroke="black" d="M5212,-1925.57C5212,-1917.34 5212,-1908.08 5212,-1899.28"/>
<polygon fill="black" stroke="black" points="5215.5,-1899.24 5212,-1889.24 5208.5,-1899.24 5215.5,-1899.24"/>
</g>
<!-- attn_1_3_0 -->
<g id="node185" class="node">
<title>attn_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="5325,-1799 5099,-1799 5099,-1746 5325,-1746 5325,-1799"/>
<text text-anchor="middle" x="5212" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5212" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5212" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge278" class="edge">
<title>reshape_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="black" d="M5212,-1835.57C5212,-1827.34 5212,-1818.08 5212,-1809.28"/>
<polygon fill="black" stroke="black" points="5215.5,-1809.24 5212,-1799.24 5208.5,-1809.24 5215.5,-1809.24"/>
</g>
<!-- attn_1_3_0&#45;&gt;proj_1_3_0 -->
<g id="edge279" class="edge">
<title>attn_1_3_0&#45;&gt;proj_1_3_0</title>
<path fill="none" stroke="black" d="M5230.27,-1745.57C5236.45,-1736.8 5243.45,-1726.87 5250,-1717.56"/>
<polygon fill="black" stroke="black" points="5252.97,-1719.43 5255.86,-1709.24 5247.24,-1715.4 5252.97,-1719.43"/>
</g>
<!-- qkv_1_3_1 -->
<g id="node186" class="node">
<title>qkv_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6020.5,-1979 5867.5,-1979 5867.5,-1926 6020.5,-1926 6020.5,-1979"/>
<text text-anchor="middle" x="5944" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5944" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5944" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_1_3_1 -->
<g id="node187" class="node">
<title>reshape_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6025,-1889 5863,-1889 5863,-1836 6025,-1836 6025,-1889"/>
<text text-anchor="middle" x="5944" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5944" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5944" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_1_3_1&#45;&gt;reshape_1_3_1 -->
<g id="edge280" class="edge">
<title>qkv_1_3_1&#45;&gt;reshape_1_3_1</title>
<path fill="none" stroke="black" d="M5944,-1925.57C5944,-1917.34 5944,-1908.08 5944,-1899.28"/>
<polygon fill="black" stroke="black" points="5947.5,-1899.24 5944,-1889.24 5940.5,-1899.24 5947.5,-1899.24"/>
</g>
<!-- attn_1_3_1 -->
<g id="node188" class="node">
<title>attn_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="6057,-1799 5831,-1799 5831,-1746 6057,-1746 6057,-1799"/>
<text text-anchor="middle" x="5944" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5944" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5944" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge281" class="edge">
<title>reshape_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="black" d="M5944,-1835.57C5944,-1827.34 5944,-1818.08 5944,-1809.28"/>
<polygon fill="black" stroke="black" points="5947.5,-1809.24 5944,-1799.24 5940.5,-1809.24 5947.5,-1809.24"/>
</g>
<!-- attn_1_3_1&#45;&gt;proj_1_3_1 -->
<g id="edge282" class="edge">
<title>attn_1_3_1&#45;&gt;proj_1_3_1</title>
<path fill="none" stroke="black" d="M5919.84,-1745.57C5911.42,-1736.53 5901.84,-1726.26 5892.94,-1716.71"/>
<polygon fill="black" stroke="black" points="5895.36,-1714.17 5885.99,-1709.24 5890.24,-1718.94 5895.36,-1714.17"/>
</g>
<!-- qkv_1_3_2 -->
<g id="node189" class="node">
<title>qkv_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5776.5,-1979 5623.5,-1979 5623.5,-1926 5776.5,-1926 5776.5,-1979"/>
<text text-anchor="middle" x="5700" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5700" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5700" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_1_3_2 -->
<g id="node190" class="node">
<title>reshape_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5781,-1889 5619,-1889 5619,-1836 5781,-1836 5781,-1889"/>
<text text-anchor="middle" x="5700" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5700" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5700" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_1_3_2&#45;&gt;reshape_1_3_2 -->
<g id="edge283" class="edge">
<title>qkv_1_3_2&#45;&gt;reshape_1_3_2</title>
<path fill="none" stroke="black" d="M5700,-1925.57C5700,-1917.34 5700,-1908.08 5700,-1899.28"/>
<polygon fill="black" stroke="black" points="5703.5,-1899.24 5700,-1889.24 5696.5,-1899.24 5703.5,-1899.24"/>
</g>
<!-- attn_1_3_2 -->
<g id="node191" class="node">
<title>attn_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5813,-1799 5587,-1799 5587,-1746 5813,-1746 5813,-1799"/>
<text text-anchor="middle" x="5700" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5700" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5700" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge284" class="edge">
<title>reshape_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="black" d="M5700,-1835.57C5700,-1827.34 5700,-1818.08 5700,-1809.28"/>
<polygon fill="black" stroke="black" points="5703.5,-1809.24 5700,-1799.24 5696.5,-1809.24 5703.5,-1809.24"/>
</g>
<!-- attn_1_3_2&#45;&gt;proj_1_3_2 -->
<g id="edge285" class="edge">
<title>attn_1_3_2&#45;&gt;proj_1_3_2</title>
<path fill="none" stroke="black" d="M5683.8,-1745.57C5678.37,-1736.89 5672.23,-1727.07 5666.47,-1717.85"/>
<polygon fill="black" stroke="black" points="5669.36,-1715.87 5661.09,-1709.24 5663.42,-1719.58 5669.36,-1715.87"/>
</g>
<!-- qkv_1_3_3 -->
<g id="node192" class="node">
<title>qkv_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5532.5,-1979 5379.5,-1979 5379.5,-1926 5532.5,-1926 5532.5,-1979"/>
<text text-anchor="middle" x="5456" y="-1963.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5456" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5456" y="-1933.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_1_3_3 -->
<g id="node193" class="node">
<title>reshape_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5537,-1889 5375,-1889 5375,-1836 5537,-1836 5537,-1889"/>
<text text-anchor="middle" x="5456" y="-1873.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5456" y="-1858.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5456" y="-1843.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_1_3_3&#45;&gt;reshape_1_3_3 -->
<g id="edge286" class="edge">
<title>qkv_1_3_3&#45;&gt;reshape_1_3_3</title>
<path fill="none" stroke="black" d="M5456,-1925.57C5456,-1917.34 5456,-1908.08 5456,-1899.28"/>
<polygon fill="black" stroke="black" points="5459.5,-1899.24 5456,-1889.24 5452.5,-1899.24 5459.5,-1899.24"/>
</g>
<!-- attn_1_3_3 -->
<g id="node194" class="node">
<title>attn_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5569,-1799 5343,-1799 5343,-1746 5569,-1746 5569,-1799"/>
<text text-anchor="middle" x="5456" y="-1783.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5456" y="-1768.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5456" y="-1753.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge287" class="edge">
<title>reshape_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="black" d="M5456,-1835.57C5456,-1827.34 5456,-1818.08 5456,-1809.28"/>
<polygon fill="black" stroke="black" points="5459.5,-1809.24 5456,-1799.24 5452.5,-1809.24 5459.5,-1809.24"/>
</g>
<!-- attn_1_3_3&#45;&gt;proj_1_3_3 -->
<g id="edge288" class="edge">
<title>attn_1_3_3&#45;&gt;proj_1_3_3</title>
<path fill="none" stroke="black" d="M5456,-1745.57C5456,-1737.34 5456,-1728.08 5456,-1719.28"/>
<polygon fill="black" stroke="black" points="5459.5,-1719.24 5456,-1709.24 5452.5,-1719.24 5459.5,-1719.24"/>
</g>
<!-- ln2_1 -->
<g id="node196" class="node">
<title>ln2_1</title>
<polygon fill="white" stroke="black" points="2657.5,-1979 2504.5,-1979 2504.5,-1926 2657.5,-1926 2657.5,-1979"/>
<text text-anchor="middle" x="2581" y="-1963.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2581" y="-1948.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2581" y="-1933.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge289" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M3161.35,-2031.23C3038.25,-2014.75 2797.25,-1982.47 2667.93,-1965.14"/>
<polygon fill="black" stroke="black" points="2668.05,-1961.63 2657.67,-1963.77 2667.12,-1968.57 2668.05,-1961.63"/>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge300" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M3240.21,-2015.78C3243.86,-1967.19 3248.91,-1864.24 3229,-1836 3203.84,-1800.32 3164.85,-1833.43 3138,-1799 3118.4,-1773.87 3128,-1759.87 3128,-1728 3128,-1728 3128,-1728 3128,-1577.5 3128,-1539.67 3095.3,-1515.05 3060.04,-1499.49"/>
<polygon fill="black" stroke="black" points="3061.13,-1496.15 3050.55,-1495.54 3058.43,-1502.61 3061.13,-1496.15"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_0 -->
<g id="edge290" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_0</title>
<path fill="none" stroke="black" d="M2635.01,-1925.81C2656.28,-1915.69 2680.87,-1904 2702.95,-1893.49"/>
<polygon fill="black" stroke="black" points="2704.72,-1896.53 2712.25,-1889.07 2701.71,-1890.2 2704.72,-1896.53"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_1 -->
<g id="edge291" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_1</title>
<path fill="none" stroke="black" d="M2657.64,-1935.33C2711.2,-1923.79 2784.59,-1907.47 2857.5,-1889.34"/>
<polygon fill="black" stroke="black" points="2858.46,-1892.71 2867.31,-1886.89 2856.76,-1885.91 2858.46,-1892.71"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_2 -->
<g id="edge292" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_2</title>
<path fill="none" stroke="black" d="M2657.73,-1944.38C2747.85,-1935.28 2901.89,-1917.48 3042.3,-1889.25"/>
<polygon fill="black" stroke="black" points="3043.28,-1892.62 3052.38,-1887.2 3041.88,-1885.76 3043.28,-1892.62"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_3 -->
<g id="edge293" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_3</title>
<path fill="none" stroke="black" d="M2504.09,-1948.42C2384.02,-1942.66 2144.82,-1927.34 1934.58,-1889.17"/>
<polygon fill="black" stroke="black" points="1935.06,-1885.7 1924.59,-1887.33 1933.8,-1892.58 1935.06,-1885.7"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_4 -->
<g id="edge294" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_4</title>
<path fill="none" stroke="black" d="M2504.27,-1944.38C2414.15,-1935.28 2260.11,-1917.48 2119.7,-1889.25"/>
<polygon fill="black" stroke="black" points="2120.12,-1885.76 2109.62,-1887.2 2118.72,-1892.62 2120.12,-1885.76"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_5 -->
<g id="edge295" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_5</title>
<path fill="none" stroke="black" d="M2504.36,-1935.33C2450.8,-1923.79 2377.41,-1907.47 2304.5,-1889.34"/>
<polygon fill="black" stroke="black" points="2305.24,-1885.91 2294.69,-1886.89 2303.54,-1892.71 2305.24,-1885.91"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_6 -->
<g id="edge296" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_6</title>
<path fill="none" stroke="black" d="M2526.99,-1925.81C2505.72,-1915.69 2481.13,-1904 2459.05,-1893.49"/>
<polygon fill="black" stroke="black" points="2460.29,-1890.2 2449.75,-1889.07 2457.28,-1896.53 2460.29,-1890.2"/>
</g>
<!-- ln2_1&#45;&gt;mlp_col_1_7 -->
<g id="edge297" class="edge">
<title>ln2_1&#45;&gt;mlp_col_1_7</title>
<path fill="none" stroke="black" d="M2581,-1925.57C2581,-1917.34 2581,-1908.08 2581,-1899.28"/>
<polygon fill="black" stroke="black" points="2584.5,-1899.24 2581,-1889.24 2577.5,-1899.24 2584.5,-1899.24"/>
</g>
<!-- ln1_2 -->
<g id="node244" class="node">
<title>ln1_2</title>
<polygon fill="white" stroke="black" points="3410.5,-1390 3257.5,-1390 3257.5,-1337 3410.5,-1337 3410.5,-1390"/>
<text text-anchor="middle" x="3334" y="-1374.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3334" y="-1359.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3334" y="-1344.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2 -->
<g id="edge301" class="edge">
<title>residual2_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M3050.79,-1450.25C3108.49,-1432.78 3187.57,-1408.83 3247.51,-1390.69"/>
<polygon fill="black" stroke="black" points="3248.77,-1393.96 3257.33,-1387.71 3246.75,-1387.26 3248.77,-1393.96"/>
</g>
<!-- residual1_2 -->
<g id="node293" class="node">
<title>residual1_2</title>
<polygon fill="orange" stroke="black" points="2460.5,-1390 2307.5,-1390 2307.5,-1337 2460.5,-1337 2460.5,-1390"/>
<text text-anchor="middle" x="2384" y="-1374.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2384" y="-1359.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2384" y="-1344.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;residual1_2 -->
<g id="edge361" class="edge">
<title>residual2_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M2897.47,-1459.36C2787.65,-1439.07 2585.91,-1401.8 2470.71,-1380.52"/>
<polygon fill="black" stroke="black" points="2471.33,-1377.07 2460.86,-1378.7 2470.06,-1383.96 2471.33,-1377.07"/>
</g>
<!-- proj_2_0_0 -->
<g id="node198" class="node">
<title>proj_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4129,-1030 3985,-1030 3985,-977 4129,-977 4129,-1030"/>
<text text-anchor="middle" x="4057" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4057" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4057" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_2_0 -->
<g id="node199" class="node">
<title>concat_dim_2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3946.5,-926 3793.5,-926 3793.5,-873 3946.5,-873 3946.5,-926"/>
<text text-anchor="middle" x="3870" y="-910.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3870" y="-895.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="3870" y="-880.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge89" class="edge">
<title>proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4032.02,-976.72C4020.11,-965.52 4005.16,-952.94 3990,-944 3979.38,-937.74 3967.71,-932.14 3955.95,-927.22"/>
<polygon fill="black" stroke="black" points="3957.1,-923.91 3946.51,-923.42 3954.48,-930.4 3957.1,-923.91"/>
<text text-anchor="middle" x="4068" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_2 -->
<g id="node218" class="node">
<title>concat_heads_2</title>
<polygon fill="lightsteelblue" stroke="black" points="4163,-822 3999,-822 3999,-769 4163,-769 4163,-822"/>
<text text-anchor="middle" x="4081" y="-806.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="4081" y="-791.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4081" y="-776.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge105" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3922.97,-872.89C3952.07,-858.83 3988.32,-841.3 4018.76,-826.59"/>
<polygon fill="black" stroke="black" points="4020.53,-829.62 4028.01,-822.12 4017.48,-823.32 4020.53,-829.62"/>
<text text-anchor="middle" x="4032.5" y="-843.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_2_0_1 -->
<g id="node200" class="node">
<title>proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3942,-1030 3798,-1030 3798,-977 3942,-977 3942,-1030"/>
<text text-anchor="middle" x="3870" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3870" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3870" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge90" class="edge">
<title>proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3870,-976.76C3870,-964.56 3870,-949.78 3870,-936.49"/>
<polygon fill="black" stroke="black" points="3873.5,-936.23 3870,-926.23 3866.5,-936.23 3873.5,-936.23"/>
<text text-anchor="middle" x="3928" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_2_0_2 -->
<g id="node201" class="node">
<title>proj_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3760,-1030 3616,-1030 3616,-977 3760,-977 3760,-1030"/>
<text text-anchor="middle" x="3688" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3688" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3688" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge91" class="edge">
<title>proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.52,-976.93C3721.53,-965.64 3735.51,-952.93 3750,-944 3760.5,-937.53 3772.1,-931.83 3783.83,-926.85"/>
<polygon fill="black" stroke="black" points="3785.3,-930.03 3793.24,-923.01 3782.66,-923.54 3785.3,-930.03"/>
<text text-anchor="middle" x="3808" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_2_0_3 -->
<g id="node202" class="node">
<title>proj_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3516,-1030 3372,-1030 3372,-977 3516,-977 3516,-1030"/>
<text text-anchor="middle" x="3444" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3444" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3444" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge92" class="edge">
<title>proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3508.64,-976.96C3539.29,-965.61 3576.64,-952.84 3611,-944 3667.72,-929.42 3732.72,-918.52 3783.41,-911.28"/>
<polygon fill="black" stroke="black" points="3783.94,-914.74 3793.35,-909.88 3782.96,-907.8 3783.94,-914.74"/>
<text text-anchor="middle" x="3669" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_2_1_0 -->
<g id="node203" class="node">
<title>proj_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="2966,-1030 2822,-1030 2822,-977 2966,-977 2966,-1030"/>
<text text-anchor="middle" x="2894" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2894" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2894" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_2_1 -->
<g id="node204" class="node">
<title>concat_dim_2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2970.5,-926 2817.5,-926 2817.5,-873 2970.5,-873 2970.5,-926"/>
<text text-anchor="middle" x="2894" y="-910.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="2894" y="-895.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="2894" y="-880.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge93" class="edge">
<title>proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2894,-976.76C2894,-964.56 2894,-949.78 2894,-936.49"/>
<polygon fill="black" stroke="black" points="2897.5,-936.23 2894,-926.23 2890.5,-936.23 2897.5,-936.23"/>
<text text-anchor="middle" x="2952" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge106" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2970.51,-891.93C3179.81,-873.94 3761.31,-823.97 3988.43,-804.45"/>
<polygon fill="black" stroke="black" points="3988.98,-807.92 3998.65,-803.58 3988.38,-800.95 3988.98,-807.92"/>
<text text-anchor="middle" x="3602.5" y="-843.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_2_1_1 -->
<g id="node205" class="node">
<title>proj_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2784,-1030 2640,-1030 2640,-977 2784,-977 2784,-1030"/>
<text text-anchor="middle" x="2712" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2712" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2712" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge94" class="edge">
<title>proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734.52,-976.93C2745.53,-965.64 2759.51,-952.93 2774,-944 2784.5,-937.53 2796.1,-931.83 2807.83,-926.85"/>
<polygon fill="black" stroke="black" points="2809.3,-930.03 2817.24,-923.01 2806.66,-923.54 2809.3,-930.03"/>
<text text-anchor="middle" x="2832" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_2_1_2 -->
<g id="node206" class="node">
<title>proj_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2540,-1030 2396,-1030 2396,-977 2540,-977 2540,-1030"/>
<text text-anchor="middle" x="2468" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2468" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2468" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge95" class="edge">
<title>proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2532.64,-976.96C2563.29,-965.61 2600.64,-952.84 2635,-944 2691.72,-929.42 2756.72,-918.52 2807.41,-911.28"/>
<polygon fill="black" stroke="black" points="2807.94,-914.74 2817.35,-909.88 2806.96,-907.8 2807.94,-914.74"/>
<text text-anchor="middle" x="2693" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_2_1_3 -->
<g id="node207" class="node">
<title>proj_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="3153,-1030 3009,-1030 3009,-977 3153,-977 3153,-1030"/>
<text text-anchor="middle" x="3081" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3081" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3081" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge96" class="edge">
<title>proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3056.02,-976.72C3044.11,-965.52 3029.16,-952.94 3014,-944 3003.38,-937.74 2991.71,-932.14 2979.95,-927.22"/>
<polygon fill="black" stroke="black" points="2981.1,-923.91 2970.51,-923.42 2978.48,-930.4 2981.1,-923.91"/>
<text text-anchor="middle" x="3092" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_2_2_0 -->
<g id="node208" class="node">
<title>proj_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5447,-1030 5303,-1030 5303,-977 5447,-977 5447,-1030"/>
<text text-anchor="middle" x="5375" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5375" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5375" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_2_2 -->
<g id="node209" class="node">
<title>concat_dim_2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="5654.5,-926 5501.5,-926 5501.5,-873 5654.5,-873 5654.5,-926"/>
<text text-anchor="middle" x="5578" y="-910.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="5578" y="-895.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="5578" y="-880.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge97" class="edge">
<title>proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5407.23,-976.76C5422.1,-965.69 5440.34,-953.21 5458,-944 5468.77,-938.38 5480.44,-933.17 5492.12,-928.45"/>
<polygon fill="black" stroke="black" points="5493.44,-931.69 5501.47,-924.78 5490.88,-925.18 5493.44,-931.69"/>
<text text-anchor="middle" x="5516" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge107" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5501.45,-893.28C5249.66,-876.13 4447.71,-821.49 4173.76,-802.82"/>
<polygon fill="black" stroke="black" points="4173.68,-799.31 4163.46,-802.12 4173.2,-806.29 4173.68,-799.31"/>
<text text-anchor="middle" x="4963.5" y="-843.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_2_2_1 -->
<g id="node210" class="node">
<title>proj_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6076,-1030 5932,-1030 5932,-977 6076,-977 6076,-1030"/>
<text text-anchor="middle" x="6004" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6004" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6004" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge98" class="edge">
<title>proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5948.47,-976.98C5921.37,-965.42 5888,-952.47 5857,-944 5793.78,-926.73 5720.51,-915.63 5664.92,-908.97"/>
<polygon fill="black" stroke="black" points="5665.1,-905.47 5654.76,-907.78 5664.28,-912.42 5665.1,-905.47"/>
<text text-anchor="middle" x="5960" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_2_2_2 -->
<g id="node211" class="node">
<title>proj_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5853,-1030 5709,-1030 5709,-977 5853,-977 5853,-1030"/>
<text text-anchor="middle" x="5781" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5781" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5781" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge99" class="edge">
<title>proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5753.45,-976.98C5740.17,-965.7 5723.55,-952.98 5707,-944 5693.62,-936.74 5678.81,-930.38 5664.14,-924.93"/>
<polygon fill="black" stroke="black" points="5665.12,-921.57 5654.53,-921.48 5662.76,-928.15 5665.12,-921.57"/>
<text text-anchor="middle" x="5790.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_2_2_3 -->
<g id="node212" class="node">
<title>proj_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5650,-1030 5506,-1030 5506,-977 5650,-977 5650,-1030"/>
<text text-anchor="middle" x="5578" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5578" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5578" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge100" class="edge">
<title>proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5578,-976.76C5578,-964.56 5578,-949.78 5578,-936.49"/>
<polygon fill="black" stroke="black" points="5581.5,-936.23 5578,-926.23 5574.5,-936.23 5581.5,-936.23"/>
<text text-anchor="middle" x="5640.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_2_3_0 -->
<g id="node213" class="node">
<title>proj_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="4492,-1030 4348,-1030 4348,-977 4492,-977 4492,-1030"/>
<text text-anchor="middle" x="4420" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4420" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4420" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_2_3 -->
<g id="node214" class="node">
<title>concat_dim_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4678.5,-926 4525.5,-926 4525.5,-873 4678.5,-873 4678.5,-926"/>
<text text-anchor="middle" x="4602" y="-910.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4602" y="-895.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="4602" y="-880.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge101" class="edge">
<title>proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4438.28,-976.96C4447.57,-965.54 4459.7,-952.71 4473,-944 4485.97,-935.5 4500.77,-928.5 4515.61,-922.79"/>
<polygon fill="black" stroke="black" points="4517.16,-925.95 4525.35,-919.22 4514.75,-919.38 4517.16,-925.95"/>
<text text-anchor="middle" x="4535.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge108" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4525.4,-883.5C4431.75,-865.17 4273.35,-834.16 4173.13,-814.54"/>
<polygon fill="black" stroke="black" points="4173.5,-811.04 4163.02,-812.56 4172.16,-817.91 4173.5,-811.04"/>
<text text-anchor="middle" x="4416.5" y="-843.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_2_3_1 -->
<g id="node215" class="node">
<title>proj_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5080,-1030 4936,-1030 4936,-977 5080,-977 5080,-1030"/>
<text text-anchor="middle" x="5008" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5008" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5008" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge102" class="edge">
<title>proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4959.49,-976.95C4935.54,-965.31 4905.87,-952.3 4878,-944 4816.07,-925.55 4743.86,-914.52 4688.84,-908.19"/>
<polygon fill="black" stroke="black" points="4689.1,-904.69 4678.77,-907.06 4688.32,-911.65 4689.1,-904.69"/>
<text text-anchor="middle" x="4980.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_2_3_2 -->
<g id="node216" class="node">
<title>proj_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="4863,-1030 4719,-1030 4719,-977 4863,-977 4863,-1030"/>
<text text-anchor="middle" x="4791" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4791" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4791" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge103" class="edge">
<title>proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4769.43,-976.75C4758.83,-965.42 4745.27,-952.73 4731,-944 4717.85,-935.96 4703.03,-929.19 4688.24,-923.57"/>
<polygon fill="black" stroke="black" points="4689.14,-920.17 4678.55,-920.04 4686.75,-926.75 4689.14,-920.17"/>
<text text-anchor="middle" x="4811.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_2_3_3 -->
<g id="node217" class="node">
<title>proj_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="4674,-1030 4530,-1030 4530,-977 4674,-977 4674,-1030"/>
<text text-anchor="middle" x="4602" y="-1014.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4602" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4602" y="-984.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge104" class="edge">
<title>proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4602,-976.76C4602,-964.56 4602,-949.78 4602,-936.49"/>
<polygon fill="black" stroke="black" points="4605.5,-936.23 4602,-926.23 4598.5,-936.23 4605.5,-936.23"/>
<text text-anchor="middle" x="4664.5" y="-947.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- mlp_col_2_0 -->
<g id="node219" class="node">
<title>mlp_col_2_0</title>
<polygon fill="lightblue" stroke="black" points="1995.5,-1210 1828.5,-1210 1828.5,-1157 1995.5,-1157 1995.5,-1210"/>
<text text-anchor="middle" x="1912" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1912" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1912" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_2_0 -->
<g id="node220" class="node">
<title>gelu_2_0</title>
<polygon fill="lightblue" stroke="black" points="1912.5,-1120 1759.5,-1120 1759.5,-1067 1912.5,-1067 1912.5,-1120"/>
<text text-anchor="middle" x="1836" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1836" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1836" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- mlp_col_2_0&#45;&gt;gelu_2_0 -->
<g id="edge109" class="edge">
<title>mlp_col_2_0&#45;&gt;gelu_2_0</title>
<path fill="none" stroke="black" d="M1889.61,-1156.57C1881.88,-1147.62 1873.1,-1137.46 1864.93,-1127.99"/>
<polygon fill="black" stroke="black" points="1867.42,-1125.52 1858.23,-1120.24 1862.12,-1130.1 1867.42,-1125.52"/>
</g>
<!-- mlp_row_2_0 -->
<g id="node235" class="node">
<title>mlp_row_2_0</title>
<polygon fill="lightblue" stroke="black" points="1912.5,-1030 1759.5,-1030 1759.5,-977 1912.5,-977 1912.5,-1030"/>
<text text-anchor="middle" x="1836" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1836" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1836" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_2_0&#45;&gt;mlp_row_2_0 -->
<g id="edge117" class="edge">
<title>gelu_2_0&#45;&gt;mlp_row_2_0</title>
<path fill="none" stroke="black" d="M1836,-1066.57C1836,-1058.34 1836,-1049.08 1836,-1040.28"/>
<polygon fill="black" stroke="black" points="1839.5,-1040.24 1836,-1030.24 1832.5,-1040.24 1839.5,-1040.24"/>
</g>
<!-- mlp_col_2_1 -->
<g id="node221" class="node">
<title>mlp_col_2_1</title>
<polygon fill="lightgreen" stroke="black" points="2180.5,-1210 2013.5,-1210 2013.5,-1157 2180.5,-1157 2180.5,-1210"/>
<text text-anchor="middle" x="2097" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2097" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2097" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_2_1 -->
<g id="node222" class="node">
<title>gelu_2_1</title>
<polygon fill="lightgreen" stroke="black" points="2083.5,-1120 1930.5,-1120 1930.5,-1067 2083.5,-1067 2083.5,-1120"/>
<text text-anchor="middle" x="2007" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2007" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2007" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- mlp_col_2_1&#45;&gt;gelu_2_1 -->
<g id="edge110" class="edge">
<title>mlp_col_2_1&#45;&gt;gelu_2_1</title>
<path fill="none" stroke="black" d="M2070.48,-1156.57C2061.15,-1147.44 2050.52,-1137.06 2040.67,-1127.43"/>
<polygon fill="black" stroke="black" points="2042.92,-1124.73 2033.33,-1120.24 2038.03,-1129.74 2042.92,-1124.73"/>
</g>
<!-- mlp_row_2_1 -->
<g id="node236" class="node">
<title>mlp_row_2_1</title>
<polygon fill="lightgreen" stroke="black" points="2083.5,-1030 1930.5,-1030 1930.5,-977 2083.5,-977 2083.5,-1030"/>
<text text-anchor="middle" x="2007" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2007" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2007" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_2_1&#45;&gt;mlp_row_2_1 -->
<g id="edge118" class="edge">
<title>gelu_2_1&#45;&gt;mlp_row_2_1</title>
<path fill="none" stroke="black" d="M2007,-1066.57C2007,-1058.34 2007,-1049.08 2007,-1040.28"/>
<polygon fill="black" stroke="black" points="2010.5,-1040.24 2007,-1030.24 2003.5,-1040.24 2010.5,-1040.24"/>
</g>
<!-- mlp_col_2_2 -->
<g id="node223" class="node">
<title>mlp_col_2_2</title>
<polygon fill="lightyellow" stroke="black" points="2365.5,-1210 2198.5,-1210 2198.5,-1157 2365.5,-1157 2365.5,-1210"/>
<text text-anchor="middle" x="2282" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="2282" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2282" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_2_2 -->
<g id="node224" class="node">
<title>gelu_2_2</title>
<polygon fill="lightyellow" stroke="black" points="2254.5,-1120 2101.5,-1120 2101.5,-1067 2254.5,-1067 2254.5,-1120"/>
<text text-anchor="middle" x="2178" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2178" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="2178" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- mlp_col_2_2&#45;&gt;gelu_2_2 -->
<g id="edge111" class="edge">
<title>mlp_col_2_2&#45;&gt;gelu_2_2</title>
<path fill="none" stroke="black" d="M2251.64,-1156.81C2240.53,-1147.41 2227.82,-1136.66 2216.12,-1126.76"/>
<polygon fill="black" stroke="black" points="2218.11,-1123.86 2208.22,-1120.07 2213.59,-1129.2 2218.11,-1123.86"/>
</g>
<!-- mlp_row_2_2 -->
<g id="node237" class="node">
<title>mlp_row_2_2</title>
<polygon fill="lightyellow" stroke="black" points="2254.5,-1030 2101.5,-1030 2101.5,-977 2254.5,-977 2254.5,-1030"/>
<text text-anchor="middle" x="2178" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="2178" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2178" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_2_2&#45;&gt;mlp_row_2_2 -->
<g id="edge119" class="edge">
<title>gelu_2_2&#45;&gt;mlp_row_2_2</title>
<path fill="none" stroke="black" d="M2178,-1066.57C2178,-1058.34 2178,-1049.08 2178,-1040.28"/>
<polygon fill="black" stroke="black" points="2181.5,-1040.24 2178,-1030.24 2174.5,-1040.24 2181.5,-1040.24"/>
</g>
<!-- mlp_col_2_3 -->
<g id="node225" class="node">
<title>mlp_col_2_3</title>
<polygon fill="lightcoral" stroke="black" points="1070.5,-1210 903.5,-1210 903.5,-1157 1070.5,-1157 1070.5,-1210"/>
<text text-anchor="middle" x="987" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="987" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="987" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_2_3 -->
<g id="node226" class="node">
<title>gelu_2_3</title>
<polygon fill="lightcoral" stroke="black" points="1057.5,-1120 904.5,-1120 904.5,-1067 1057.5,-1067 1057.5,-1120"/>
<text text-anchor="middle" x="981" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="981" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="981" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- mlp_col_2_3&#45;&gt;gelu_2_3 -->
<g id="edge112" class="edge">
<title>mlp_col_2_3&#45;&gt;gelu_2_3</title>
<path fill="none" stroke="black" d="M985.23,-1156.57C984.67,-1148.34 984.04,-1139.08 983.44,-1130.28"/>
<polygon fill="black" stroke="black" points="986.93,-1129.98 982.76,-1120.24 979.94,-1130.46 986.93,-1129.98"/>
</g>
<!-- mlp_row_2_3 -->
<g id="node238" class="node">
<title>mlp_row_2_3</title>
<polygon fill="lightcoral" stroke="black" points="1057.5,-1030 904.5,-1030 904.5,-977 1057.5,-977 1057.5,-1030"/>
<text text-anchor="middle" x="981" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="981" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="981" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_2_3&#45;&gt;mlp_row_2_3 -->
<g id="edge120" class="edge">
<title>gelu_2_3&#45;&gt;mlp_row_2_3</title>
<path fill="none" stroke="black" d="M981,-1066.57C981,-1058.34 981,-1049.08 981,-1040.28"/>
<polygon fill="black" stroke="black" points="984.5,-1040.24 981,-1030.24 977.5,-1040.24 984.5,-1040.24"/>
</g>
<!-- mlp_col_2_4 -->
<g id="node227" class="node">
<title>mlp_col_2_4</title>
<polygon fill="lightpink" stroke="black" points="1255.5,-1210 1088.5,-1210 1088.5,-1157 1255.5,-1157 1255.5,-1210"/>
<text text-anchor="middle" x="1172" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1172" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1172" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_2_4 -->
<g id="node228" class="node">
<title>gelu_2_4</title>
<polygon fill="lightpink" stroke="black" points="1228.5,-1120 1075.5,-1120 1075.5,-1067 1228.5,-1067 1228.5,-1120"/>
<text text-anchor="middle" x="1152" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1152" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1152" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- mlp_col_2_4&#45;&gt;gelu_2_4 -->
<g id="edge113" class="edge">
<title>mlp_col_2_4&#45;&gt;gelu_2_4</title>
<path fill="none" stroke="black" d="M1166.11,-1156.57C1164.24,-1148.34 1162.13,-1139.08 1160.13,-1130.28"/>
<polygon fill="black" stroke="black" points="1163.48,-1129.22 1157.85,-1120.24 1156.65,-1130.77 1163.48,-1129.22"/>
</g>
<!-- mlp_row_2_4 -->
<g id="node239" class="node">
<title>mlp_row_2_4</title>
<polygon fill="lightpink" stroke="black" points="1228.5,-1030 1075.5,-1030 1075.5,-977 1228.5,-977 1228.5,-1030"/>
<text text-anchor="middle" x="1152" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1152" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1152" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_2_4&#45;&gt;mlp_row_2_4 -->
<g id="edge121" class="edge">
<title>gelu_2_4&#45;&gt;mlp_row_2_4</title>
<path fill="none" stroke="black" d="M1152,-1066.57C1152,-1058.34 1152,-1049.08 1152,-1040.28"/>
<polygon fill="black" stroke="black" points="1155.5,-1040.24 1152,-1030.24 1148.5,-1040.24 1155.5,-1040.24"/>
</g>
<!-- mlp_col_2_5 -->
<g id="node229" class="node">
<title>mlp_col_2_5</title>
<polygon fill="lightcyan" stroke="black" points="1440.5,-1210 1273.5,-1210 1273.5,-1157 1440.5,-1157 1440.5,-1210"/>
<text text-anchor="middle" x="1357" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1357" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1357" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_2_5 -->
<g id="node230" class="node">
<title>gelu_2_5</title>
<polygon fill="lightcyan" stroke="black" points="1399.5,-1120 1246.5,-1120 1246.5,-1067 1399.5,-1067 1399.5,-1120"/>
<text text-anchor="middle" x="1323" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1323" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1323" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- mlp_col_2_5&#45;&gt;gelu_2_5 -->
<g id="edge114" class="edge">
<title>mlp_col_2_5&#45;&gt;gelu_2_5</title>
<path fill="none" stroke="black" d="M1346.98,-1156.57C1343.73,-1148.16 1340.07,-1138.68 1336.6,-1129.7"/>
<polygon fill="black" stroke="black" points="1339.81,-1128.31 1332.95,-1120.24 1333.28,-1130.83 1339.81,-1128.31"/>
</g>
<!-- mlp_row_2_5 -->
<g id="node240" class="node">
<title>mlp_row_2_5</title>
<polygon fill="lightcyan" stroke="black" points="1399.5,-1030 1246.5,-1030 1246.5,-977 1399.5,-977 1399.5,-1030"/>
<text text-anchor="middle" x="1323" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1323" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1323" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_2_5&#45;&gt;mlp_row_2_5 -->
<g id="edge122" class="edge">
<title>gelu_2_5&#45;&gt;mlp_row_2_5</title>
<path fill="none" stroke="black" d="M1323,-1066.57C1323,-1058.34 1323,-1049.08 1323,-1040.28"/>
<polygon fill="black" stroke="black" points="1326.5,-1040.24 1323,-1030.24 1319.5,-1040.24 1326.5,-1040.24"/>
</g>
<!-- mlp_col_2_6 -->
<g id="node231" class="node">
<title>mlp_col_2_6</title>
<polygon fill="lightgrey" stroke="black" points="1625.5,-1210 1458.5,-1210 1458.5,-1157 1625.5,-1157 1625.5,-1210"/>
<text text-anchor="middle" x="1542" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1542" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1542" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_2_6 -->
<g id="node232" class="node">
<title>gelu_2_6</title>
<polygon fill="lightgrey" stroke="black" points="1570.5,-1120 1417.5,-1120 1417.5,-1067 1570.5,-1067 1570.5,-1120"/>
<text text-anchor="middle" x="1494" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1494" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1494" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- mlp_col_2_6&#45;&gt;gelu_2_6 -->
<g id="edge115" class="edge">
<title>mlp_col_2_6&#45;&gt;gelu_2_6</title>
<path fill="none" stroke="black" d="M1527.86,-1156.57C1523.17,-1147.98 1517.88,-1138.27 1512.89,-1129.13"/>
<polygon fill="black" stroke="black" points="1515.9,-1127.34 1508.04,-1120.24 1509.76,-1130.7 1515.9,-1127.34"/>
</g>
<!-- mlp_row_2_6 -->
<g id="node241" class="node">
<title>mlp_row_2_6</title>
<polygon fill="lightgrey" stroke="black" points="1570.5,-1030 1417.5,-1030 1417.5,-977 1570.5,-977 1570.5,-1030"/>
<text text-anchor="middle" x="1494" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1494" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1494" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_2_6&#45;&gt;mlp_row_2_6 -->
<g id="edge123" class="edge">
<title>gelu_2_6&#45;&gt;mlp_row_2_6</title>
<path fill="none" stroke="black" d="M1494,-1066.57C1494,-1058.34 1494,-1049.08 1494,-1040.28"/>
<polygon fill="black" stroke="black" points="1497.5,-1040.24 1494,-1030.24 1490.5,-1040.24 1497.5,-1040.24"/>
</g>
<!-- mlp_col_2_7 -->
<g id="node233" class="node">
<title>mlp_col_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="1810.5,-1210 1643.5,-1210 1643.5,-1157 1810.5,-1157 1810.5,-1210"/>
<text text-anchor="middle" x="1727" y="-1194.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1727" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1727" y="-1164.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_2_7 -->
<g id="node234" class="node">
<title>gelu_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="1741.5,-1120 1588.5,-1120 1588.5,-1067 1741.5,-1067 1741.5,-1120"/>
<text text-anchor="middle" x="1665" y="-1104.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1665" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1665" y="-1074.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- mlp_col_2_7&#45;&gt;gelu_2_7 -->
<g id="edge116" class="edge">
<title>mlp_col_2_7&#45;&gt;gelu_2_7</title>
<path fill="none" stroke="black" d="M1708.73,-1156.57C1702.55,-1147.8 1695.55,-1137.87 1689,-1128.56"/>
<polygon fill="black" stroke="black" points="1691.76,-1126.4 1683.14,-1120.24 1686.03,-1130.43 1691.76,-1126.4"/>
</g>
<!-- mlp_row_2_7 -->
<g id="node242" class="node">
<title>mlp_row_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="1741.5,-1030 1588.5,-1030 1588.5,-977 1741.5,-977 1741.5,-1030"/>
<text text-anchor="middle" x="1665" y="-1014.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1665" y="-999.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1665" y="-984.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_2_7&#45;&gt;mlp_row_2_7 -->
<g id="edge124" class="edge">
<title>gelu_2_7&#45;&gt;mlp_row_2_7</title>
<path fill="none" stroke="black" d="M1665,-1066.57C1665,-1058.34 1665,-1049.08 1665,-1040.28"/>
<polygon fill="black" stroke="black" points="1668.5,-1040.24 1665,-1030.24 1661.5,-1040.24 1668.5,-1040.24"/>
</g>
<!-- mlp_allreduce_2 -->
<g id="node243" class="node">
<title>mlp_allreduce_2</title>
<polygon fill="yellow" stroke="black" points="1741.5,-926 1588.5,-926 1588.5,-873 1741.5,-873 1741.5,-926"/>
<text text-anchor="middle" x="1665" y="-910.8" font-family="Times,serif" font-size="14.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="1665" y="-895.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1665" y="-880.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_row_2_0&#45;&gt;mlp_allreduce_2 -->
<g id="edge125" class="edge">
<title>mlp_row_2_0&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1792.85,-976.76C1769.67,-962.94 1740.95,-945.8 1716.59,-931.28"/>
<polygon fill="black" stroke="black" points="1718.22,-928.17 1707.84,-926.05 1714.64,-934.18 1718.22,-928.17"/>
</g>
<!-- mlp_row_2_1&#45;&gt;mlp_allreduce_2 -->
<g id="edge126" class="edge">
<title>mlp_row_2_1&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1930.25,-979.61C1877.21,-963.79 1806.57,-942.72 1751.53,-926.31"/>
<polygon fill="black" stroke="black" points="1752.37,-922.91 1741.79,-923.4 1750.37,-929.61 1752.37,-922.91"/>
</g>
<!-- mlp_row_2_2&#45;&gt;mlp_allreduce_2 -->
<g id="edge127" class="edge">
<title>mlp_row_2_2&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2101.22,-979.27C2098.11,-978.48 2095.03,-977.72 2092,-977 1975.16,-949.3 1838.23,-926.43 1751.56,-913.12"/>
<polygon fill="black" stroke="black" points="1751.92,-909.63 1741.5,-911.58 1750.86,-916.55 1751.92,-909.63"/>
</g>
<!-- mlp_row_2_3&#45;&gt;mlp_allreduce_2 -->
<g id="edge128" class="edge">
<title>mlp_row_2_3&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1057.77,-978.87C1060.54,-978.21 1063.29,-977.58 1066,-977 1246.02,-938.33 1460.97,-916.71 1578.19,-906.95"/>
<polygon fill="black" stroke="black" points="1578.5,-910.44 1588.18,-906.13 1577.93,-903.46 1578.5,-910.44"/>
</g>
<!-- mlp_row_2_4&#45;&gt;mlp_allreduce_2 -->
<g id="edge129" class="edge">
<title>mlp_row_2_4&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1228.8,-979.03C1231.56,-978.32 1234.3,-977.64 1237,-977 1354.06,-949.08 1491.33,-926.26 1578.22,-913.02"/>
<polygon fill="black" stroke="black" points="1578.94,-916.45 1588.3,-911.5 1577.89,-909.53 1578.94,-916.45"/>
</g>
<!-- mlp_row_2_5&#45;&gt;mlp_allreduce_2 -->
<g id="edge130" class="edge">
<title>mlp_row_2_5&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1399.91,-979.42C1402.64,-978.6 1405.34,-977.79 1408,-977 1464.77,-960.04 1528.61,-941.03 1578.46,-926.21"/>
<polygon fill="black" stroke="black" points="1579.65,-929.51 1588.24,-923.3 1577.65,-922.8 1579.65,-929.51"/>
</g>
<!-- mlp_row_2_6&#45;&gt;mlp_allreduce_2 -->
<g id="edge131" class="edge">
<title>mlp_row_2_6&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537.15,-976.76C1560.33,-962.94 1589.05,-945.8 1613.41,-931.28"/>
<polygon fill="black" stroke="black" points="1615.36,-934.18 1622.16,-926.05 1611.78,-928.17 1615.36,-934.18"/>
</g>
<!-- mlp_row_2_7&#45;&gt;mlp_allreduce_2 -->
<g id="edge132" class="edge">
<title>mlp_row_2_7&#45;&gt;mlp_allreduce_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1665,-976.76C1665,-964.56 1665,-949.78 1665,-936.49"/>
<polygon fill="black" stroke="black" points="1668.5,-936.23 1665,-926.23 1661.5,-936.23 1668.5,-936.23"/>
</g>
<!-- residual2_2 -->
<g id="node295" class="node">
<title>residual2_2</title>
<polygon fill="orange" stroke="black" points="2046.5,-822 1893.5,-822 1893.5,-769 2046.5,-769 2046.5,-822"/>
<text text-anchor="middle" x="1970" y="-806.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1970" y="-791.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1970" y="-776.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_allreduce_2&#45;&gt;residual2_2 -->
<g id="edge360" class="edge">
<title>mlp_allreduce_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M1741.57,-872.89C1784.89,-858.41 1839.18,-840.25 1883.97,-825.27"/>
<polygon fill="black" stroke="black" points="1885.29,-828.52 1893.66,-822.03 1883.07,-821.88 1885.29,-828.52"/>
</g>
<!-- qkv_2_0_0 -->
<g id="node245" class="node">
<title>qkv_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4122.5,-1300 3969.5,-1300 3969.5,-1247 4122.5,-1247 4122.5,-1300"/>
<text text-anchor="middle" x="4046" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4046" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4046" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_2&#45;&gt;qkv_2_0_0 -->
<g id="edge302" class="edge">
<title>ln1_2&#45;&gt;qkv_2_0_0</title>
<path fill="none" stroke="black" d="M3410.74,-1359.14C3528.8,-1352.99 3761.69,-1336.99 3956,-1300 3957.08,-1299.79 3958.16,-1299.58 3959.25,-1299.36"/>
<polygon fill="black" stroke="black" points="3960.09,-1302.76 3969.13,-1297.24 3958.62,-1295.92 3960.09,-1302.76"/>
</g>
<!-- reshape_2_0_0 -->
<g id="node246" class="node">
<title>reshape_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4168,-1210 4006,-1210 4006,-1157 4168,-1157 4168,-1210"/>
<text text-anchor="middle" x="4087" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4087" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4087" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_2_0_0&#45;&gt;reshape_2_0_0 -->
<g id="edge303" class="edge">
<title>qkv_2_0_0&#45;&gt;reshape_2_0_0</title>
<path fill="none" stroke="black" d="M4058.08,-1246.57C4062.04,-1238.07 4066.51,-1228.48 4070.73,-1219.42"/>
<polygon fill="black" stroke="black" points="4073.96,-1220.78 4075.01,-1210.24 4067.61,-1217.83 4073.96,-1220.78"/>
</g>
<!-- attn_2_0_0 -->
<g id="node247" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4227,-1120 4001,-1120 4001,-1067 4227,-1067 4227,-1120"/>
<text text-anchor="middle" x="4114" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4114" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4114" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge304" class="edge">
<title>reshape_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M4094.95,-1156.57C4097.51,-1148.25 4100.38,-1138.88 4103.11,-1129.99"/>
<polygon fill="black" stroke="black" points="4106.51,-1130.83 4106.1,-1120.24 4099.82,-1128.78 4106.51,-1130.83"/>
</g>
<!-- attn_2_0_0&#45;&gt;proj_2_0_0 -->
<g id="edge305" class="edge">
<title>attn_2_0_0&#45;&gt;proj_2_0_0</title>
<path fill="none" stroke="black" d="M4097.21,-1066.57C4091.58,-1057.89 4085.22,-1048.07 4079.25,-1038.85"/>
<polygon fill="black" stroke="black" points="4082.05,-1036.73 4073.67,-1030.24 4076.17,-1040.54 4082.05,-1036.73"/>
</g>
<!-- qkv_2_0_1 -->
<g id="node248" class="node">
<title>qkv_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3946.5,-1300 3793.5,-1300 3793.5,-1247 3946.5,-1247 3946.5,-1300"/>
<text text-anchor="middle" x="3870" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3870" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3870" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_2_0_1 -->
<g id="node249" class="node">
<title>reshape_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3951,-1210 3789,-1210 3789,-1157 3951,-1157 3951,-1210"/>
<text text-anchor="middle" x="3870" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3870" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3870" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_2_0_1&#45;&gt;reshape_2_0_1 -->
<g id="edge306" class="edge">
<title>qkv_2_0_1&#45;&gt;reshape_2_0_1</title>
<path fill="none" stroke="black" d="M3870,-1246.57C3870,-1238.34 3870,-1229.08 3870,-1220.28"/>
<polygon fill="black" stroke="black" points="3873.5,-1220.24 3870,-1210.24 3866.5,-1220.24 3873.5,-1220.24"/>
</g>
<!-- attn_2_0_1 -->
<g id="node250" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3983,-1120 3757,-1120 3757,-1067 3983,-1067 3983,-1120"/>
<text text-anchor="middle" x="3870" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3870" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3870" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge307" class="edge">
<title>reshape_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M3870,-1156.57C3870,-1148.34 3870,-1139.08 3870,-1130.28"/>
<polygon fill="black" stroke="black" points="3873.5,-1130.24 3870,-1120.24 3866.5,-1130.24 3873.5,-1130.24"/>
</g>
<!-- attn_2_0_1&#45;&gt;proj_2_0_1 -->
<g id="edge308" class="edge">
<title>attn_2_0_1&#45;&gt;proj_2_0_1</title>
<path fill="none" stroke="black" d="M3870,-1066.57C3870,-1058.34 3870,-1049.08 3870,-1040.28"/>
<polygon fill="black" stroke="black" points="3873.5,-1040.24 3870,-1030.24 3866.5,-1040.24 3873.5,-1040.24"/>
</g>
<!-- qkv_2_0_2 -->
<g id="node251" class="node">
<title>qkv_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3702.5,-1300 3549.5,-1300 3549.5,-1247 3702.5,-1247 3702.5,-1300"/>
<text text-anchor="middle" x="3626" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3626" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3626" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_2_0_2 -->
<g id="node252" class="node">
<title>reshape_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3707,-1210 3545,-1210 3545,-1157 3707,-1157 3707,-1210"/>
<text text-anchor="middle" x="3626" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3626" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3626" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_2_0_2&#45;&gt;reshape_2_0_2 -->
<g id="edge309" class="edge">
<title>qkv_2_0_2&#45;&gt;reshape_2_0_2</title>
<path fill="none" stroke="black" d="M3626,-1246.57C3626,-1238.34 3626,-1229.08 3626,-1220.28"/>
<polygon fill="black" stroke="black" points="3629.5,-1220.24 3626,-1210.24 3622.5,-1220.24 3629.5,-1220.24"/>
</g>
<!-- attn_2_0_2 -->
<g id="node253" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3739,-1120 3513,-1120 3513,-1067 3739,-1067 3739,-1120"/>
<text text-anchor="middle" x="3626" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3626" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3626" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge310" class="edge">
<title>reshape_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M3626,-1156.57C3626,-1148.34 3626,-1139.08 3626,-1130.28"/>
<polygon fill="black" stroke="black" points="3629.5,-1130.24 3626,-1120.24 3622.5,-1130.24 3629.5,-1130.24"/>
</g>
<!-- attn_2_0_2&#45;&gt;proj_2_0_2 -->
<g id="edge311" class="edge">
<title>attn_2_0_2&#45;&gt;proj_2_0_2</title>
<path fill="none" stroke="black" d="M3644.27,-1066.57C3650.45,-1057.8 3657.45,-1047.87 3664,-1038.56"/>
<polygon fill="black" stroke="black" points="3666.97,-1040.43 3669.86,-1030.24 3661.24,-1036.4 3666.97,-1040.43"/>
</g>
<!-- qkv_2_0_3 -->
<g id="node254" class="node">
<title>qkv_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3458.5,-1300 3305.5,-1300 3305.5,-1247 3458.5,-1247 3458.5,-1300"/>
<text text-anchor="middle" x="3382" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3382" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3382" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_2_0_3 -->
<g id="node255" class="node">
<title>reshape_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3463,-1210 3301,-1210 3301,-1157 3463,-1157 3463,-1210"/>
<text text-anchor="middle" x="3382" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3382" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3382" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_2_0_3&#45;&gt;reshape_2_0_3 -->
<g id="edge312" class="edge">
<title>qkv_2_0_3&#45;&gt;reshape_2_0_3</title>
<path fill="none" stroke="black" d="M3382,-1246.57C3382,-1238.34 3382,-1229.08 3382,-1220.28"/>
<polygon fill="black" stroke="black" points="3385.5,-1220.24 3382,-1210.24 3378.5,-1220.24 3385.5,-1220.24"/>
</g>
<!-- attn_2_0_3 -->
<g id="node256" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3495,-1120 3269,-1120 3269,-1067 3495,-1067 3495,-1120"/>
<text text-anchor="middle" x="3382" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3382" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3382" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge313" class="edge">
<title>reshape_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M3382,-1156.57C3382,-1148.34 3382,-1139.08 3382,-1130.28"/>
<polygon fill="black" stroke="black" points="3385.5,-1130.24 3382,-1120.24 3378.5,-1130.24 3385.5,-1130.24"/>
</g>
<!-- attn_2_0_3&#45;&gt;proj_2_0_3 -->
<g id="edge314" class="edge">
<title>attn_2_0_3&#45;&gt;proj_2_0_3</title>
<path fill="none" stroke="black" d="M3400.27,-1066.57C3406.45,-1057.8 3413.45,-1047.87 3420,-1038.56"/>
<polygon fill="black" stroke="black" points="3422.97,-1040.43 3425.86,-1030.24 3417.24,-1036.4 3422.97,-1040.43"/>
</g>
<!-- qkv_2_1_0 -->
<g id="node257" class="node">
<title>qkv_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="2970.5,-1300 2817.5,-1300 2817.5,-1247 2970.5,-1247 2970.5,-1300"/>
<text text-anchor="middle" x="2894" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2894" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2894" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_2_1_0 -->
<g id="node258" class="node">
<title>reshape_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="2975,-1210 2813,-1210 2813,-1157 2975,-1157 2975,-1210"/>
<text text-anchor="middle" x="2894" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2894" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2894" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_2_1_0&#45;&gt;reshape_2_1_0 -->
<g id="edge315" class="edge">
<title>qkv_2_1_0&#45;&gt;reshape_2_1_0</title>
<path fill="none" stroke="black" d="M2894,-1246.57C2894,-1238.34 2894,-1229.08 2894,-1220.28"/>
<polygon fill="black" stroke="black" points="2897.5,-1220.24 2894,-1210.24 2890.5,-1220.24 2897.5,-1220.24"/>
</g>
<!-- attn_2_1_0 -->
<g id="node259" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="3007,-1120 2781,-1120 2781,-1067 3007,-1067 3007,-1120"/>
<text text-anchor="middle" x="2894" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2894" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2894" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge316" class="edge">
<title>reshape_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M2894,-1156.57C2894,-1148.34 2894,-1139.08 2894,-1130.28"/>
<polygon fill="black" stroke="black" points="2897.5,-1130.24 2894,-1120.24 2890.5,-1130.24 2897.5,-1130.24"/>
</g>
<!-- attn_2_1_0&#45;&gt;proj_2_1_0 -->
<g id="edge317" class="edge">
<title>attn_2_1_0&#45;&gt;proj_2_1_0</title>
<path fill="none" stroke="black" d="M2894,-1066.57C2894,-1058.34 2894,-1049.08 2894,-1040.28"/>
<polygon fill="black" stroke="black" points="2897.5,-1040.24 2894,-1030.24 2890.5,-1040.24 2897.5,-1040.24"/>
</g>
<!-- qkv_2_1_1 -->
<g id="node260" class="node">
<title>qkv_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2740.5,-1300 2587.5,-1300 2587.5,-1247 2740.5,-1247 2740.5,-1300"/>
<text text-anchor="middle" x="2664" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2664" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2664" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_2_1_1 -->
<g id="node261" class="node">
<title>reshape_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2745,-1210 2583,-1210 2583,-1157 2745,-1157 2745,-1210"/>
<text text-anchor="middle" x="2664" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2664" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2664" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_2_1_1&#45;&gt;reshape_2_1_1 -->
<g id="edge318" class="edge">
<title>qkv_2_1_1&#45;&gt;reshape_2_1_1</title>
<path fill="none" stroke="black" d="M2664,-1246.57C2664,-1238.34 2664,-1229.08 2664,-1220.28"/>
<polygon fill="black" stroke="black" points="2667.5,-1220.24 2664,-1210.24 2660.5,-1220.24 2667.5,-1220.24"/>
</g>
<!-- attn_2_1_1 -->
<g id="node262" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2763,-1120 2537,-1120 2537,-1067 2763,-1067 2763,-1120"/>
<text text-anchor="middle" x="2650" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2650" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2650" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge319" class="edge">
<title>reshape_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M2659.88,-1156.57C2658.57,-1148.34 2657.09,-1139.08 2655.69,-1130.28"/>
<polygon fill="black" stroke="black" points="2659.12,-1129.57 2654.1,-1120.24 2652.21,-1130.67 2659.12,-1129.57"/>
</g>
<!-- attn_2_1_1&#45;&gt;proj_2_1_1 -->
<g id="edge320" class="edge">
<title>attn_2_1_1&#45;&gt;proj_2_1_1</title>
<path fill="none" stroke="black" d="M2668.27,-1066.57C2674.45,-1057.8 2681.45,-1047.87 2688,-1038.56"/>
<polygon fill="black" stroke="black" points="2690.97,-1040.43 2693.86,-1030.24 2685.24,-1036.4 2690.97,-1040.43"/>
</g>
<!-- qkv_2_1_2 -->
<g id="node263" class="node">
<title>qkv_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2560.5,-1300 2407.5,-1300 2407.5,-1247 2560.5,-1247 2560.5,-1300"/>
<text text-anchor="middle" x="2484" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2484" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2484" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_2_1_2 -->
<g id="node264" class="node">
<title>reshape_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2565,-1210 2403,-1210 2403,-1157 2565,-1157 2565,-1210"/>
<text text-anchor="middle" x="2484" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2484" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2484" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_2_1_2&#45;&gt;reshape_2_1_2 -->
<g id="edge321" class="edge">
<title>qkv_2_1_2&#45;&gt;reshape_2_1_2</title>
<path fill="none" stroke="black" d="M2484,-1246.57C2484,-1238.34 2484,-1229.08 2484,-1220.28"/>
<polygon fill="black" stroke="black" points="2487.5,-1220.24 2484,-1210.24 2480.5,-1220.24 2487.5,-1220.24"/>
</g>
<!-- attn_2_1_2 -->
<g id="node265" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2519,-1120 2293,-1120 2293,-1067 2519,-1067 2519,-1120"/>
<text text-anchor="middle" x="2406" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2406" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2406" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge322" class="edge">
<title>reshape_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M2461.02,-1156.57C2453.09,-1147.62 2444.08,-1137.46 2435.69,-1127.99"/>
<polygon fill="black" stroke="black" points="2438.07,-1125.4 2428.82,-1120.24 2432.83,-1130.05 2438.07,-1125.4"/>
</g>
<!-- attn_2_1_2&#45;&gt;proj_2_1_2 -->
<g id="edge323" class="edge">
<title>attn_2_1_2&#45;&gt;proj_2_1_2</title>
<path fill="none" stroke="black" d="M2424.27,-1066.57C2430.45,-1057.8 2437.45,-1047.87 2444,-1038.56"/>
<polygon fill="black" stroke="black" points="2446.97,-1040.43 2449.86,-1030.24 2441.24,-1036.4 2446.97,-1040.43"/>
</g>
<!-- qkv_2_1_3 -->
<g id="node266" class="node">
<title>qkv_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="3214.5,-1300 3061.5,-1300 3061.5,-1247 3214.5,-1247 3214.5,-1300"/>
<text text-anchor="middle" x="3138" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3138" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3138" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_2_1_3 -->
<g id="node267" class="node">
<title>reshape_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="3219,-1210 3057,-1210 3057,-1157 3219,-1157 3219,-1210"/>
<text text-anchor="middle" x="3138" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3138" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3138" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_2_1_3&#45;&gt;reshape_2_1_3 -->
<g id="edge324" class="edge">
<title>qkv_2_1_3&#45;&gt;reshape_2_1_3</title>
<path fill="none" stroke="black" d="M3138,-1246.57C3138,-1238.34 3138,-1229.08 3138,-1220.28"/>
<polygon fill="black" stroke="black" points="3141.5,-1220.24 3138,-1210.24 3134.5,-1220.24 3141.5,-1220.24"/>
</g>
<!-- attn_2_1_3 -->
<g id="node268" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="3251,-1120 3025,-1120 3025,-1067 3251,-1067 3251,-1120"/>
<text text-anchor="middle" x="3138" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3138" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3138" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge325" class="edge">
<title>reshape_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M3138,-1156.57C3138,-1148.34 3138,-1139.08 3138,-1130.28"/>
<polygon fill="black" stroke="black" points="3141.5,-1130.24 3138,-1120.24 3134.5,-1130.24 3141.5,-1130.24"/>
</g>
<!-- attn_2_1_3&#45;&gt;proj_2_1_3 -->
<g id="edge326" class="edge">
<title>attn_2_1_3&#45;&gt;proj_2_1_3</title>
<path fill="none" stroke="black" d="M3121.21,-1066.57C3115.58,-1057.89 3109.22,-1048.07 3103.25,-1038.85"/>
<polygon fill="black" stroke="black" points="3106.05,-1036.73 3097.67,-1030.24 3100.17,-1040.54 3106.05,-1036.73"/>
</g>
<!-- qkv_2_2_0 -->
<g id="node269" class="node">
<title>qkv_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5410.5,-1300 5257.5,-1300 5257.5,-1247 5410.5,-1247 5410.5,-1300"/>
<text text-anchor="middle" x="5334" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5334" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5334" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_2_2_0 -->
<g id="node270" class="node">
<title>reshape_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5415,-1210 5253,-1210 5253,-1157 5415,-1157 5415,-1210"/>
<text text-anchor="middle" x="5334" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5334" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5334" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_2_0&#45;&gt;reshape_2_2_0 -->
<g id="edge327" class="edge">
<title>qkv_2_2_0&#45;&gt;reshape_2_2_0</title>
<path fill="none" stroke="black" d="M5334,-1246.57C5334,-1238.34 5334,-1229.08 5334,-1220.28"/>
<polygon fill="black" stroke="black" points="5337.5,-1220.24 5334,-1210.24 5330.5,-1220.24 5337.5,-1220.24"/>
</g>
<!-- attn_2_2_0 -->
<g id="node271" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5447,-1120 5221,-1120 5221,-1067 5447,-1067 5447,-1120"/>
<text text-anchor="middle" x="5334" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5334" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5334" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge328" class="edge">
<title>reshape_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M5334,-1156.57C5334,-1148.34 5334,-1139.08 5334,-1130.28"/>
<polygon fill="black" stroke="black" points="5337.5,-1130.24 5334,-1120.24 5330.5,-1130.24 5337.5,-1130.24"/>
</g>
<!-- attn_2_2_0&#45;&gt;proj_2_2_0 -->
<g id="edge329" class="edge">
<title>attn_2_2_0&#45;&gt;proj_2_2_0</title>
<path fill="none" stroke="black" d="M5346.08,-1066.57C5350.04,-1058.07 5354.51,-1048.48 5358.73,-1039.42"/>
<polygon fill="black" stroke="black" points="5361.96,-1040.78 5363.01,-1030.24 5355.61,-1037.83 5361.96,-1040.78"/>
</g>
<!-- qkv_2_2_1 -->
<g id="node272" class="node">
<title>qkv_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6142.5,-1300 5989.5,-1300 5989.5,-1247 6142.5,-1247 6142.5,-1300"/>
<text text-anchor="middle" x="6066" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6066" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6066" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_2_2_1 -->
<g id="node273" class="node">
<title>reshape_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6147,-1210 5985,-1210 5985,-1157 6147,-1157 6147,-1210"/>
<text text-anchor="middle" x="6066" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6066" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6066" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_2_1&#45;&gt;reshape_2_2_1 -->
<g id="edge330" class="edge">
<title>qkv_2_2_1&#45;&gt;reshape_2_2_1</title>
<path fill="none" stroke="black" d="M6066,-1246.57C6066,-1238.34 6066,-1229.08 6066,-1220.28"/>
<polygon fill="black" stroke="black" points="6069.5,-1220.24 6066,-1210.24 6062.5,-1220.24 6069.5,-1220.24"/>
</g>
<!-- attn_2_2_1 -->
<g id="node274" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6179,-1120 5953,-1120 5953,-1067 6179,-1067 6179,-1120"/>
<text text-anchor="middle" x="6066" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6066" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6066" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge331" class="edge">
<title>reshape_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M6066,-1156.57C6066,-1148.34 6066,-1139.08 6066,-1130.28"/>
<polygon fill="black" stroke="black" points="6069.5,-1130.24 6066,-1120.24 6062.5,-1130.24 6069.5,-1130.24"/>
</g>
<!-- attn_2_2_1&#45;&gt;proj_2_2_1 -->
<g id="edge332" class="edge">
<title>attn_2_2_1&#45;&gt;proj_2_2_1</title>
<path fill="none" stroke="black" d="M6047.73,-1066.57C6041.55,-1057.8 6034.55,-1047.87 6028,-1038.56"/>
<polygon fill="black" stroke="black" points="6030.76,-1036.4 6022.14,-1030.24 6025.03,-1040.43 6030.76,-1036.4"/>
</g>
<!-- qkv_2_2_2 -->
<g id="node275" class="node">
<title>qkv_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5898.5,-1300 5745.5,-1300 5745.5,-1247 5898.5,-1247 5898.5,-1300"/>
<text text-anchor="middle" x="5822" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5822" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5822" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_2_2_2 -->
<g id="node276" class="node">
<title>reshape_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5903,-1210 5741,-1210 5741,-1157 5903,-1157 5903,-1210"/>
<text text-anchor="middle" x="5822" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5822" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5822" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2_2&#45;&gt;reshape_2_2_2 -->
<g id="edge333" class="edge">
<title>qkv_2_2_2&#45;&gt;reshape_2_2_2</title>
<path fill="none" stroke="black" d="M5822,-1246.57C5822,-1238.34 5822,-1229.08 5822,-1220.28"/>
<polygon fill="black" stroke="black" points="5825.5,-1220.24 5822,-1210.24 5818.5,-1220.24 5825.5,-1220.24"/>
</g>
<!-- attn_2_2_2 -->
<g id="node277" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5935,-1120 5709,-1120 5709,-1067 5935,-1067 5935,-1120"/>
<text text-anchor="middle" x="5822" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5822" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5822" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge334" class="edge">
<title>reshape_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M5822,-1156.57C5822,-1148.34 5822,-1139.08 5822,-1130.28"/>
<polygon fill="black" stroke="black" points="5825.5,-1130.24 5822,-1120.24 5818.5,-1130.24 5825.5,-1130.24"/>
</g>
<!-- attn_2_2_2&#45;&gt;proj_2_2_2 -->
<g id="edge335" class="edge">
<title>attn_2_2_2&#45;&gt;proj_2_2_2</title>
<path fill="none" stroke="black" d="M5809.92,-1066.57C5805.96,-1058.07 5801.49,-1048.48 5797.27,-1039.42"/>
<polygon fill="black" stroke="black" points="5800.39,-1037.83 5792.99,-1030.24 5794.04,-1040.78 5800.39,-1037.83"/>
</g>
<!-- qkv_2_2_3 -->
<g id="node278" class="node">
<title>qkv_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5654.5,-1300 5501.5,-1300 5501.5,-1247 5654.5,-1247 5654.5,-1300"/>
<text text-anchor="middle" x="5578" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5578" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5578" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_2_2_3 -->
<g id="node279" class="node">
<title>reshape_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5659,-1210 5497,-1210 5497,-1157 5659,-1157 5659,-1210"/>
<text text-anchor="middle" x="5578" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5578" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5578" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_2_3&#45;&gt;reshape_2_2_3 -->
<g id="edge336" class="edge">
<title>qkv_2_2_3&#45;&gt;reshape_2_2_3</title>
<path fill="none" stroke="black" d="M5578,-1246.57C5578,-1238.34 5578,-1229.08 5578,-1220.28"/>
<polygon fill="black" stroke="black" points="5581.5,-1220.24 5578,-1210.24 5574.5,-1220.24 5581.5,-1220.24"/>
</g>
<!-- attn_2_2_3 -->
<g id="node280" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5691,-1120 5465,-1120 5465,-1067 5691,-1067 5691,-1120"/>
<text text-anchor="middle" x="5578" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5578" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5578" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge337" class="edge">
<title>reshape_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M5578,-1156.57C5578,-1148.34 5578,-1139.08 5578,-1130.28"/>
<polygon fill="black" stroke="black" points="5581.5,-1130.24 5578,-1120.24 5574.5,-1130.24 5581.5,-1130.24"/>
</g>
<!-- attn_2_2_3&#45;&gt;proj_2_2_3 -->
<g id="edge338" class="edge">
<title>attn_2_2_3&#45;&gt;proj_2_2_3</title>
<path fill="none" stroke="black" d="M5578,-1066.57C5578,-1058.34 5578,-1049.08 5578,-1040.28"/>
<polygon fill="black" stroke="black" points="5581.5,-1040.24 5578,-1030.24 5574.5,-1040.24 5581.5,-1040.24"/>
</g>
<!-- qkv_2_3_0 -->
<g id="node281" class="node">
<title>qkv_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="4434.5,-1300 4281.5,-1300 4281.5,-1247 4434.5,-1247 4434.5,-1300"/>
<text text-anchor="middle" x="4358" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4358" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4358" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_2_3_0 -->
<g id="node282" class="node">
<title>reshape_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="4439,-1210 4277,-1210 4277,-1157 4439,-1157 4439,-1210"/>
<text text-anchor="middle" x="4358" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4358" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4358" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_2_3_0&#45;&gt;reshape_2_3_0 -->
<g id="edge339" class="edge">
<title>qkv_2_3_0&#45;&gt;reshape_2_3_0</title>
<path fill="none" stroke="black" d="M4358,-1246.57C4358,-1238.34 4358,-1229.08 4358,-1220.28"/>
<polygon fill="black" stroke="black" points="4361.5,-1220.24 4358,-1210.24 4354.5,-1220.24 4361.5,-1220.24"/>
</g>
<!-- attn_2_3_0 -->
<g id="node283" class="node">
<title>attn_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="4471,-1120 4245,-1120 4245,-1067 4471,-1067 4471,-1120"/>
<text text-anchor="middle" x="4358" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4358" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4358" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge340" class="edge">
<title>reshape_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M4358,-1156.57C4358,-1148.34 4358,-1139.08 4358,-1130.28"/>
<polygon fill="black" stroke="black" points="4361.5,-1130.24 4358,-1120.24 4354.5,-1130.24 4361.5,-1130.24"/>
</g>
<!-- attn_2_3_0&#45;&gt;proj_2_3_0 -->
<g id="edge341" class="edge">
<title>attn_2_3_0&#45;&gt;proj_2_3_0</title>
<path fill="none" stroke="black" d="M4376.27,-1066.57C4382.45,-1057.8 4389.45,-1047.87 4396,-1038.56"/>
<polygon fill="black" stroke="black" points="4398.97,-1040.43 4401.86,-1030.24 4393.24,-1036.4 4398.97,-1040.43"/>
</g>
<!-- qkv_2_3_1 -->
<g id="node284" class="node">
<title>qkv_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5166.5,-1300 5013.5,-1300 5013.5,-1247 5166.5,-1247 5166.5,-1300"/>
<text text-anchor="middle" x="5090" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5090" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5090" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_2_3_1 -->
<g id="node285" class="node">
<title>reshape_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5171,-1210 5009,-1210 5009,-1157 5171,-1157 5171,-1210"/>
<text text-anchor="middle" x="5090" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5090" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5090" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_2_3_1&#45;&gt;reshape_2_3_1 -->
<g id="edge342" class="edge">
<title>qkv_2_3_1&#45;&gt;reshape_2_3_1</title>
<path fill="none" stroke="black" d="M5090,-1246.57C5090,-1238.34 5090,-1229.08 5090,-1220.28"/>
<polygon fill="black" stroke="black" points="5093.5,-1220.24 5090,-1210.24 5086.5,-1220.24 5093.5,-1220.24"/>
</g>
<!-- attn_2_3_1 -->
<g id="node286" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5203,-1120 4977,-1120 4977,-1067 5203,-1067 5203,-1120"/>
<text text-anchor="middle" x="5090" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5090" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5090" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge343" class="edge">
<title>reshape_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M5090,-1156.57C5090,-1148.34 5090,-1139.08 5090,-1130.28"/>
<polygon fill="black" stroke="black" points="5093.5,-1130.24 5090,-1120.24 5086.5,-1130.24 5093.5,-1130.24"/>
</g>
<!-- attn_2_3_1&#45;&gt;proj_2_3_1 -->
<g id="edge344" class="edge">
<title>attn_2_3_1&#45;&gt;proj_2_3_1</title>
<path fill="none" stroke="black" d="M5065.84,-1066.57C5057.42,-1057.53 5047.84,-1047.26 5038.94,-1037.71"/>
<polygon fill="black" stroke="black" points="5041.36,-1035.17 5031.99,-1030.24 5036.24,-1039.94 5041.36,-1035.17"/>
</g>
<!-- qkv_2_3_2 -->
<g id="node287" class="node">
<title>qkv_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="4922.5,-1300 4769.5,-1300 4769.5,-1247 4922.5,-1247 4922.5,-1300"/>
<text text-anchor="middle" x="4846" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4846" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4846" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_2_3_2 -->
<g id="node288" class="node">
<title>reshape_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="4927,-1210 4765,-1210 4765,-1157 4927,-1157 4927,-1210"/>
<text text-anchor="middle" x="4846" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4846" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4846" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_2_3_2&#45;&gt;reshape_2_3_2 -->
<g id="edge345" class="edge">
<title>qkv_2_3_2&#45;&gt;reshape_2_3_2</title>
<path fill="none" stroke="black" d="M4846,-1246.57C4846,-1238.34 4846,-1229.08 4846,-1220.28"/>
<polygon fill="black" stroke="black" points="4849.5,-1220.24 4846,-1210.24 4842.5,-1220.24 4849.5,-1220.24"/>
</g>
<!-- attn_2_3_2 -->
<g id="node289" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="4959,-1120 4733,-1120 4733,-1067 4959,-1067 4959,-1120"/>
<text text-anchor="middle" x="4846" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4846" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4846" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge346" class="edge">
<title>reshape_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M4846,-1156.57C4846,-1148.34 4846,-1139.08 4846,-1130.28"/>
<polygon fill="black" stroke="black" points="4849.5,-1130.24 4846,-1120.24 4842.5,-1130.24 4849.5,-1130.24"/>
</g>
<!-- attn_2_3_2&#45;&gt;proj_2_3_2 -->
<g id="edge347" class="edge">
<title>attn_2_3_2&#45;&gt;proj_2_3_2</title>
<path fill="none" stroke="black" d="M4829.8,-1066.57C4824.37,-1057.89 4818.23,-1048.07 4812.47,-1038.85"/>
<polygon fill="black" stroke="black" points="4815.36,-1036.87 4807.09,-1030.24 4809.42,-1040.58 4815.36,-1036.87"/>
</g>
<!-- qkv_2_3_3 -->
<g id="node290" class="node">
<title>qkv_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="4678.5,-1300 4525.5,-1300 4525.5,-1247 4678.5,-1247 4678.5,-1300"/>
<text text-anchor="middle" x="4602" y="-1284.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4602" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4602" y="-1254.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_2_3_3 -->
<g id="node291" class="node">
<title>reshape_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="4683,-1210 4521,-1210 4521,-1157 4683,-1157 4683,-1210"/>
<text text-anchor="middle" x="4602" y="-1194.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4602" y="-1179.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4602" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_2_3_3&#45;&gt;reshape_2_3_3 -->
<g id="edge348" class="edge">
<title>qkv_2_3_3&#45;&gt;reshape_2_3_3</title>
<path fill="none" stroke="black" d="M4602,-1246.57C4602,-1238.34 4602,-1229.08 4602,-1220.28"/>
<polygon fill="black" stroke="black" points="4605.5,-1220.24 4602,-1210.24 4598.5,-1220.24 4605.5,-1220.24"/>
</g>
<!-- attn_2_3_3 -->
<g id="node292" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="4715,-1120 4489,-1120 4489,-1067 4715,-1067 4715,-1120"/>
<text text-anchor="middle" x="4602" y="-1104.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4602" y="-1089.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4602" y="-1074.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge349" class="edge">
<title>reshape_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M4602,-1156.57C4602,-1148.34 4602,-1139.08 4602,-1130.28"/>
<polygon fill="black" stroke="black" points="4605.5,-1130.24 4602,-1120.24 4598.5,-1130.24 4605.5,-1130.24"/>
</g>
<!-- attn_2_3_3&#45;&gt;proj_2_3_3 -->
<g id="edge350" class="edge">
<title>attn_2_3_3&#45;&gt;proj_2_3_3</title>
<path fill="none" stroke="black" d="M4602,-1066.57C4602,-1058.34 4602,-1049.08 4602,-1040.28"/>
<polygon fill="black" stroke="black" points="4605.5,-1040.24 4602,-1030.24 4598.5,-1040.24 4605.5,-1040.24"/>
</g>
<!-- ln2_2 -->
<g id="node294" class="node">
<title>ln2_2</title>
<polygon fill="white" stroke="black" points="1803.5,-1300 1650.5,-1300 1650.5,-1247 1803.5,-1247 1803.5,-1300"/>
<text text-anchor="middle" x="1727" y="-1284.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1727" y="-1269.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1727" y="-1254.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge351" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M2307.35,-1352.23C2184.25,-1335.75 1943.25,-1303.47 1813.93,-1286.14"/>
<polygon fill="black" stroke="black" points="1814.05,-1282.63 1803.67,-1284.77 1813.12,-1289.57 1814.05,-1282.63"/>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge362" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M2386.07,-1336.78C2389.44,-1288.19 2393.93,-1185.23 2374,-1157 2349.06,-1121.67 2310.53,-1154.16 2284,-1120 2264.45,-1094.83 2274,-1080.87 2274,-1049 2274,-1049 2274,-1049 2274,-898.5 2274,-852.35 2146.51,-823.2 2056.65,-808.38"/>
<polygon fill="black" stroke="black" points="2057.14,-804.92 2046.71,-806.78 2056.03,-811.83 2057.14,-804.92"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_0 -->
<g id="edge352" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_0</title>
<path fill="none" stroke="black" d="M1781.01,-1246.81C1802.28,-1236.69 1826.87,-1225 1848.95,-1214.49"/>
<polygon fill="black" stroke="black" points="1850.72,-1217.53 1858.25,-1210.07 1847.71,-1211.2 1850.72,-1217.53"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_1 -->
<g id="edge353" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_1</title>
<path fill="none" stroke="black" d="M1803.65,-1256.19C1856.98,-1244.61 1929.97,-1228.32 2003.49,-1210.08"/>
<polygon fill="black" stroke="black" points="2004.54,-1213.43 2013.4,-1207.62 2002.85,-1206.64 2004.54,-1213.43"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_2 -->
<g id="edge354" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_2</title>
<path fill="none" stroke="black" d="M1803.55,-1265.3C1893.46,-1256.13 2047.16,-1238.26 2188.33,-1210.02"/>
<polygon fill="black" stroke="black" points="2189.37,-1213.38 2198.47,-1207.97 2187.98,-1206.52 2189.37,-1213.38"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_3 -->
<g id="edge355" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_3</title>
<path fill="none" stroke="black" d="M1650.09,-1269.42C1530.02,-1263.66 1290.82,-1248.34 1080.58,-1210.17"/>
<polygon fill="black" stroke="black" points="1081.06,-1206.7 1070.59,-1208.33 1079.8,-1213.58 1081.06,-1206.7"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_4 -->
<g id="edge356" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_4</title>
<path fill="none" stroke="black" d="M1650.27,-1265.38C1560.15,-1256.28 1406.11,-1238.48 1265.7,-1210.25"/>
<polygon fill="black" stroke="black" points="1266.12,-1206.76 1255.62,-1208.2 1264.72,-1213.62 1266.12,-1206.76"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_5 -->
<g id="edge357" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_5</title>
<path fill="none" stroke="black" d="M1650.36,-1256.33C1596.8,-1244.79 1523.41,-1228.47 1450.5,-1210.34"/>
<polygon fill="black" stroke="black" points="1451.24,-1206.91 1440.69,-1207.89 1449.54,-1213.71 1451.24,-1206.91"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_6 -->
<g id="edge358" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_6</title>
<path fill="none" stroke="black" d="M1672.99,-1246.81C1651.72,-1236.69 1627.13,-1225 1605.05,-1214.49"/>
<polygon fill="black" stroke="black" points="1606.29,-1211.2 1595.75,-1210.07 1603.28,-1217.53 1606.29,-1211.2"/>
</g>
<!-- ln2_2&#45;&gt;mlp_col_2_7 -->
<g id="edge359" class="edge">
<title>ln2_2&#45;&gt;mlp_col_2_7</title>
<path fill="none" stroke="black" d="M1727,-1246.57C1727,-1238.34 1727,-1229.08 1727,-1220.28"/>
<polygon fill="black" stroke="black" points="1730.5,-1220.24 1727,-1210.24 1723.5,-1220.24 1730.5,-1220.24"/>
</g>
<!-- ln1_3 -->
<g id="node342" class="node">
<title>ln1_3</title>
<polygon fill="white" stroke="black" points="2522.5,-711 2369.5,-711 2369.5,-658 2522.5,-658 2522.5,-711"/>
<text text-anchor="middle" x="2446" y="-695.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2446" y="-680.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="2446" y="-665.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3 -->
<g id="edge363" class="edge">
<title>residual2_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M2046.74,-776.93C2132.28,-757.34 2270.3,-725.73 2359.58,-705.29"/>
<polygon fill="black" stroke="black" points="2360.44,-708.68 2369.41,-703.04 2358.88,-701.86 2360.44,-708.68"/>
</g>
<!-- residual1_3 -->
<g id="node391" class="node">
<title>residual1_3</title>
<polygon fill="orange" stroke="black" points="1572.5,-711 1419.5,-711 1419.5,-658 1572.5,-658 1572.5,-711"/>
<text text-anchor="middle" x="1496" y="-695.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1496" y="-680.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1496" y="-665.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;residual1_3 -->
<g id="edge423" class="edge">
<title>residual2_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1893.32,-776.87C1808.21,-757.29 1671.17,-725.78 1582.35,-705.36"/>
<polygon fill="black" stroke="black" points="1583.1,-701.94 1572.57,-703.11 1581.53,-708.76 1583.1,-701.94"/>
</g>
<!-- proj_3_0_0 -->
<g id="node296" class="node">
<title>proj_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="3241,-351 3097,-351 3097,-298 3241,-298 3241,-351"/>
<text text-anchor="middle" x="3169" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3169" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3169" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_3_0 -->
<g id="node297" class="node">
<title>concat_dim_3_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3058.5,-247 2905.5,-247 2905.5,-194 3058.5,-194 3058.5,-247"/>
<text text-anchor="middle" x="2982" y="-231.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="2982" y="-216.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="2982" y="-201.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge133" class="edge">
<title>proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3144.02,-297.72C3132.11,-286.52 3117.16,-273.94 3102,-265 3091.38,-258.74 3079.71,-253.14 3067.95,-248.22"/>
<polygon fill="black" stroke="black" points="3069.1,-244.91 3058.51,-244.42 3066.48,-251.4 3069.1,-244.91"/>
<text text-anchor="middle" x="3180" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_3 -->
<g id="node316" class="node">
<title>concat_heads_3</title>
<polygon fill="lightsteelblue" stroke="black" points="3275,-143 3111,-143 3111,-90 3275,-90 3275,-143"/>
<text text-anchor="middle" x="3193" y="-127.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="3193" y="-112.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="3193" y="-97.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge149" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3034.97,-193.89C3064.07,-179.83 3100.32,-162.3 3130.76,-147.59"/>
<polygon fill="black" stroke="black" points="3132.53,-150.62 3140.01,-143.12 3129.48,-144.32 3132.53,-150.62"/>
<text text-anchor="middle" x="3144.5" y="-164.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_3_0_1 -->
<g id="node298" class="node">
<title>proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3054,-351 2910,-351 2910,-298 3054,-298 3054,-351"/>
<text text-anchor="middle" x="2982" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2982" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2982" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge134" class="edge">
<title>proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982,-297.76C2982,-285.56 2982,-270.78 2982,-257.49"/>
<polygon fill="black" stroke="black" points="2985.5,-257.23 2982,-247.23 2978.5,-257.23 2985.5,-257.23"/>
<text text-anchor="middle" x="3040" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_3_0_2 -->
<g id="node299" class="node">
<title>proj_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="2872,-351 2728,-351 2728,-298 2872,-298 2872,-351"/>
<text text-anchor="middle" x="2800" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2800" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2800" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge135" class="edge">
<title>proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2822.52,-297.93C2833.53,-286.64 2847.51,-273.93 2862,-265 2872.5,-258.53 2884.1,-252.83 2895.83,-247.85"/>
<polygon fill="black" stroke="black" points="2897.3,-251.03 2905.24,-244.01 2894.66,-244.54 2897.3,-251.03"/>
<text text-anchor="middle" x="2920" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_3_0_3 -->
<g id="node300" class="node">
<title>proj_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2669,-351 2525,-351 2525,-298 2669,-298 2669,-351"/>
<text text-anchor="middle" x="2597" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2597" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2597" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge136" class="edge">
<title>proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2644.26,-297.88C2667.41,-286.29 2696.05,-273.35 2723,-265 2779.14,-247.6 2844.41,-236.69 2895.39,-230.15"/>
<polygon fill="black" stroke="black" points="2895.9,-233.62 2905.38,-228.9 2895.03,-226.67 2895.9,-233.62"/>
<text text-anchor="middle" x="2781" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_3_1_0 -->
<g id="node301" class="node">
<title>proj_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="2078,-351 1934,-351 1934,-298 2078,-298 2078,-351"/>
<text text-anchor="middle" x="2006" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2006" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2006" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_3_1 -->
<g id="node302" class="node">
<title>concat_dim_3_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2082.5,-247 1929.5,-247 1929.5,-194 2082.5,-194 2082.5,-247"/>
<text text-anchor="middle" x="2006" y="-231.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="2006" y="-216.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="2006" y="-201.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge137" class="edge">
<title>proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2006,-297.76C2006,-285.56 2006,-270.78 2006,-257.49"/>
<polygon fill="black" stroke="black" points="2009.5,-257.23 2006,-247.23 2002.5,-257.23 2009.5,-257.23"/>
<text text-anchor="middle" x="2064" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge150" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2082.51,-212.93C2291.81,-194.94 2873.31,-144.97 3100.43,-125.45"/>
<polygon fill="black" stroke="black" points="3100.98,-128.92 3110.65,-124.58 3100.38,-121.95 3100.98,-128.92"/>
<text text-anchor="middle" x="2714.5" y="-164.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_3_1_1 -->
<g id="node303" class="node">
<title>proj_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1891,-351 1747,-351 1747,-298 1891,-298 1891,-351"/>
<text text-anchor="middle" x="1819" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1819" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1819" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge138" class="edge">
<title>proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1843.98,-297.72C1855.89,-286.52 1870.84,-273.94 1886,-265 1896.62,-258.74 1908.29,-253.14 1920.05,-248.22"/>
<polygon fill="black" stroke="black" points="1921.52,-251.4 1929.49,-244.42 1918.9,-244.91 1921.52,-251.4"/>
<text text-anchor="middle" x="1944" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_3_1_2 -->
<g id="node304" class="node">
<title>proj_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1688,-351 1544,-351 1544,-298 1688,-298 1688,-351"/>
<text text-anchor="middle" x="1616" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1616" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1616" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge139" class="edge">
<title>proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1664.85,-297.92C1688.75,-286.34 1718.29,-273.4 1746,-265 1802.56,-247.86 1868.22,-236.94 1919.41,-230.33"/>
<polygon fill="black" stroke="black" points="1919.96,-233.79 1929.44,-229.06 1919.08,-226.84 1919.96,-233.79"/>
<text text-anchor="middle" x="1804" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_3_1_3 -->
<g id="node305" class="node">
<title>proj_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2265,-351 2121,-351 2121,-298 2265,-298 2265,-351"/>
<text text-anchor="middle" x="2193" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2193" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2193" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge140" class="edge">
<title>proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2168.02,-297.72C2156.11,-286.52 2141.16,-273.94 2126,-265 2115.38,-258.74 2103.71,-253.14 2091.95,-248.22"/>
<polygon fill="black" stroke="black" points="2093.1,-244.91 2082.51,-244.42 2090.48,-251.4 2093.1,-244.91"/>
<text text-anchor="middle" x="2205" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_3_2_0 -->
<g id="node306" class="node">
<title>proj_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="4580,-351 4436,-351 4436,-298 4580,-298 4580,-351"/>
<text text-anchor="middle" x="4508" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4508" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4508" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_3_2 -->
<g id="node307" class="node">
<title>concat_dim_3_2</title>
<polygon fill="lightsteelblue" stroke="black" points="4766.5,-247 4613.5,-247 4613.5,-194 4766.5,-194 4766.5,-247"/>
<text text-anchor="middle" x="4690" y="-231.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4690" y="-216.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="4690" y="-201.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge141" class="edge">
<title>proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4530.52,-297.93C4541.53,-286.64 4555.51,-273.93 4570,-265 4580.5,-258.53 4592.1,-252.83 4603.83,-247.85"/>
<polygon fill="black" stroke="black" points="4605.3,-251.03 4613.24,-244.01 4602.66,-244.54 4605.3,-251.03"/>
<text text-anchor="middle" x="4628" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge151" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4613.45,-214.28C4361.66,-197.13 3559.71,-142.49 3285.76,-123.82"/>
<polygon fill="black" stroke="black" points="3285.68,-120.31 3275.46,-123.12 3285.2,-127.29 3285.68,-120.31"/>
<text text-anchor="middle" x="4075.5" y="-164.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_3_2_1 -->
<g id="node308" class="node">
<title>proj_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5188,-351 5044,-351 5044,-298 5188,-298 5188,-351"/>
<text text-anchor="middle" x="5116" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5116" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5116" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge142" class="edge">
<title>proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5060.47,-297.98C5033.37,-286.42 5000,-273.47 4969,-265 4905.78,-247.73 4832.51,-236.63 4776.92,-229.97"/>
<polygon fill="black" stroke="black" points="4777.1,-226.47 4766.76,-228.78 4776.28,-233.42 4777.1,-226.47"/>
<text text-anchor="middle" x="5072" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_3_2_2 -->
<g id="node309" class="node">
<title>proj_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="4965,-351 4821,-351 4821,-298 4965,-298 4965,-351"/>
<text text-anchor="middle" x="4893" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4893" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4893" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge143" class="edge">
<title>proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4865.45,-297.98C4852.17,-286.7 4835.55,-273.98 4819,-265 4805.62,-257.74 4790.81,-251.38 4776.14,-245.93"/>
<polygon fill="black" stroke="black" points="4777.12,-242.57 4766.53,-242.48 4774.76,-249.15 4777.12,-242.57"/>
<text text-anchor="middle" x="4902.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_3_2_3 -->
<g id="node310" class="node">
<title>proj_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4762,-351 4618,-351 4618,-298 4762,-298 4762,-351"/>
<text text-anchor="middle" x="4690" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4690" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4690" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge144" class="edge">
<title>proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4690,-297.76C4690,-285.56 4690,-270.78 4690,-257.49"/>
<polygon fill="black" stroke="black" points="4693.5,-257.23 4690,-247.23 4686.5,-257.23 4693.5,-257.23"/>
<text text-anchor="middle" x="4752.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_3_3_0 -->
<g id="node311" class="node">
<title>proj_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3583,-351 3439,-351 3439,-298 3583,-298 3583,-351"/>
<text text-anchor="middle" x="3511" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3511" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3511" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_3_3 -->
<g id="node312" class="node">
<title>concat_dim_3_3</title>
<polygon fill="lightsteelblue" stroke="black" points="3790.5,-247 3637.5,-247 3637.5,-194 3790.5,-194 3790.5,-247"/>
<text text-anchor="middle" x="3714" y="-231.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3714" y="-216.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="3714" y="-201.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge145" class="edge">
<title>proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3538.55,-297.98C3551.83,-286.7 3568.45,-273.98 3585,-265 3598.38,-257.74 3613.19,-251.38 3627.86,-245.93"/>
<polygon fill="black" stroke="black" points="3629.24,-249.15 3637.47,-242.48 3626.88,-242.57 3629.24,-249.15"/>
<text text-anchor="middle" x="3647.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge152" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3637.4,-204.5C3543.75,-186.17 3385.35,-155.16 3285.13,-135.54"/>
<polygon fill="black" stroke="black" points="3285.5,-132.04 3275.02,-133.56 3284.16,-138.91 3285.5,-132.04"/>
<text text-anchor="middle" x="3528.5" y="-164.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_3_3_1 -->
<g id="node313" class="node">
<title>proj_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="4187,-351 4043,-351 4043,-298 4187,-298 4187,-351"/>
<text text-anchor="middle" x="4115" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4115" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="4115" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge146" class="edge">
<title>proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4069.94,-297.99C4047.46,-286.29 4019.47,-273.21 3993,-265 3930.19,-245.51 3856.59,-234.5 3800.76,-228.44"/>
<polygon fill="black" stroke="black" points="3800.86,-224.93 3790.55,-227.36 3800.13,-231.89 3800.86,-224.93"/>
<text text-anchor="middle" x="4093.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_3_3_2 -->
<g id="node314" class="node">
<title>proj_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="3989,-351 3845,-351 3845,-298 3989,-298 3989,-351"/>
<text text-anchor="middle" x="3917" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3917" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3917" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge147" class="edge">
<title>proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3889.45,-297.98C3876.17,-286.7 3859.55,-273.98 3843,-265 3829.62,-257.74 3814.81,-251.38 3800.14,-245.93"/>
<polygon fill="black" stroke="black" points="3801.12,-242.57 3790.53,-242.48 3798.76,-249.15 3801.12,-242.57"/>
<text text-anchor="middle" x="3926.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_3_3_3 -->
<g id="node315" class="node">
<title>proj_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3786,-351 3642,-351 3642,-298 3786,-298 3786,-351"/>
<text text-anchor="middle" x="3714" y="-335.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3714" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3714" y="-305.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge148" class="edge">
<title>proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3714,-297.76C3714,-285.56 3714,-270.78 3714,-257.49"/>
<polygon fill="black" stroke="black" points="3717.5,-257.23 3714,-247.23 3710.5,-257.23 3717.5,-257.23"/>
<text text-anchor="middle" x="3776.5" y="-268.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- mlp_col_3_0 -->
<g id="node317" class="node">
<title>mlp_col_3_0</title>
<polygon fill="lightblue" stroke="black" points="1107.5,-531 940.5,-531 940.5,-478 1107.5,-478 1107.5,-531"/>
<text text-anchor="middle" x="1024" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1024" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1024" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_3_0 -->
<g id="node318" class="node">
<title>gelu_3_0</title>
<polygon fill="lightblue" stroke="black" points="1024.5,-441 871.5,-441 871.5,-388 1024.5,-388 1024.5,-441"/>
<text text-anchor="middle" x="948" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="948" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="948" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- mlp_col_3_0&#45;&gt;gelu_3_0 -->
<g id="edge153" class="edge">
<title>mlp_col_3_0&#45;&gt;gelu_3_0</title>
<path fill="none" stroke="black" d="M1001.61,-477.57C993.88,-468.62 985.1,-458.46 976.93,-448.99"/>
<polygon fill="black" stroke="black" points="979.42,-446.52 970.23,-441.24 974.12,-451.1 979.42,-446.52"/>
</g>
<!-- mlp_row_3_0 -->
<g id="node333" class="node">
<title>mlp_row_3_0</title>
<polygon fill="lightblue" stroke="black" points="1024.5,-351 871.5,-351 871.5,-298 1024.5,-298 1024.5,-351"/>
<text text-anchor="middle" x="948" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="948" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="948" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 0</text>
</g>
<!-- gelu_3_0&#45;&gt;mlp_row_3_0 -->
<g id="edge161" class="edge">
<title>gelu_3_0&#45;&gt;mlp_row_3_0</title>
<path fill="none" stroke="black" d="M948,-387.57C948,-379.34 948,-370.08 948,-361.28"/>
<polygon fill="black" stroke="black" points="951.5,-361.24 948,-351.24 944.5,-361.24 951.5,-361.24"/>
</g>
<!-- mlp_col_3_1 -->
<g id="node319" class="node">
<title>mlp_col_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1292.5,-531 1125.5,-531 1125.5,-478 1292.5,-478 1292.5,-531"/>
<text text-anchor="middle" x="1209" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1209" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1209" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_3_1 -->
<g id="node320" class="node">
<title>gelu_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1195.5,-441 1042.5,-441 1042.5,-388 1195.5,-388 1195.5,-441"/>
<text text-anchor="middle" x="1119" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1119" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1119" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- mlp_col_3_1&#45;&gt;gelu_3_1 -->
<g id="edge154" class="edge">
<title>mlp_col_3_1&#45;&gt;gelu_3_1</title>
<path fill="none" stroke="black" d="M1182.48,-477.57C1173.15,-468.44 1162.52,-458.06 1152.67,-448.43"/>
<polygon fill="black" stroke="black" points="1154.92,-445.73 1145.33,-441.24 1150.03,-450.74 1154.92,-445.73"/>
</g>
<!-- mlp_row_3_1 -->
<g id="node334" class="node">
<title>mlp_row_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1195.5,-351 1042.5,-351 1042.5,-298 1195.5,-298 1195.5,-351"/>
<text text-anchor="middle" x="1119" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1119" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1119" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 1</text>
</g>
<!-- gelu_3_1&#45;&gt;mlp_row_3_1 -->
<g id="edge162" class="edge">
<title>gelu_3_1&#45;&gt;mlp_row_3_1</title>
<path fill="none" stroke="black" d="M1119,-387.57C1119,-379.34 1119,-370.08 1119,-361.28"/>
<polygon fill="black" stroke="black" points="1122.5,-361.24 1119,-351.24 1115.5,-361.24 1122.5,-361.24"/>
</g>
<!-- mlp_col_3_2 -->
<g id="node321" class="node">
<title>mlp_col_3_2</title>
<polygon fill="lightyellow" stroke="black" points="1477.5,-531 1310.5,-531 1310.5,-478 1477.5,-478 1477.5,-531"/>
<text text-anchor="middle" x="1394" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="1394" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1394" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_3_2 -->
<g id="node322" class="node">
<title>gelu_3_2</title>
<polygon fill="lightyellow" stroke="black" points="1366.5,-441 1213.5,-441 1213.5,-388 1366.5,-388 1366.5,-441"/>
<text text-anchor="middle" x="1290" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1290" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="1290" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- mlp_col_3_2&#45;&gt;gelu_3_2 -->
<g id="edge155" class="edge">
<title>mlp_col_3_2&#45;&gt;gelu_3_2</title>
<path fill="none" stroke="black" d="M1363.64,-477.81C1352.53,-468.41 1339.82,-457.66 1328.12,-447.76"/>
<polygon fill="black" stroke="black" points="1330.11,-444.86 1320.22,-441.07 1325.59,-450.2 1330.11,-444.86"/>
</g>
<!-- mlp_row_3_2 -->
<g id="node335" class="node">
<title>mlp_row_3_2</title>
<polygon fill="lightyellow" stroke="black" points="1366.5,-351 1213.5,-351 1213.5,-298 1366.5,-298 1366.5,-351"/>
<text text-anchor="middle" x="1290" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="1290" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1290" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 2</text>
</g>
<!-- gelu_3_2&#45;&gt;mlp_row_3_2 -->
<g id="edge163" class="edge">
<title>gelu_3_2&#45;&gt;mlp_row_3_2</title>
<path fill="none" stroke="black" d="M1290,-387.57C1290,-379.34 1290,-370.08 1290,-361.28"/>
<polygon fill="black" stroke="black" points="1293.5,-361.24 1290,-351.24 1286.5,-361.24 1293.5,-361.24"/>
</g>
<!-- mlp_col_3_3 -->
<g id="node323" class="node">
<title>mlp_col_3_3</title>
<polygon fill="lightcoral" stroke="black" points="182.5,-531 15.5,-531 15.5,-478 182.5,-478 182.5,-531"/>
<text text-anchor="middle" x="99" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="99" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="99" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_3_3 -->
<g id="node324" class="node">
<title>gelu_3_3</title>
<polygon fill="lightcoral" stroke="black" points="169.5,-441 16.5,-441 16.5,-388 169.5,-388 169.5,-441"/>
<text text-anchor="middle" x="93" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="93" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="93" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- mlp_col_3_3&#45;&gt;gelu_3_3 -->
<g id="edge156" class="edge">
<title>mlp_col_3_3&#45;&gt;gelu_3_3</title>
<path fill="none" stroke="black" d="M97.23,-477.57C96.67,-469.34 96.04,-460.08 95.44,-451.28"/>
<polygon fill="black" stroke="black" points="98.93,-450.98 94.76,-441.24 91.94,-451.46 98.93,-450.98"/>
</g>
<!-- mlp_row_3_3 -->
<g id="node336" class="node">
<title>mlp_row_3_3</title>
<polygon fill="lightcoral" stroke="black" points="169.5,-351 16.5,-351 16.5,-298 169.5,-298 169.5,-351"/>
<text text-anchor="middle" x="93" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="93" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="93" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 3</text>
</g>
<!-- gelu_3_3&#45;&gt;mlp_row_3_3 -->
<g id="edge164" class="edge">
<title>gelu_3_3&#45;&gt;mlp_row_3_3</title>
<path fill="none" stroke="black" d="M93,-387.57C93,-379.34 93,-370.08 93,-361.28"/>
<polygon fill="black" stroke="black" points="96.5,-361.24 93,-351.24 89.5,-361.24 96.5,-361.24"/>
</g>
<!-- mlp_col_3_4 -->
<g id="node325" class="node">
<title>mlp_col_3_4</title>
<polygon fill="lightpink" stroke="black" points="367.5,-531 200.5,-531 200.5,-478 367.5,-478 367.5,-531"/>
<text text-anchor="middle" x="284" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="284" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="284" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_3_4 -->
<g id="node326" class="node">
<title>gelu_3_4</title>
<polygon fill="lightpink" stroke="black" points="340.5,-441 187.5,-441 187.5,-388 340.5,-388 340.5,-441"/>
<text text-anchor="middle" x="264" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="264" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="264" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- mlp_col_3_4&#45;&gt;gelu_3_4 -->
<g id="edge157" class="edge">
<title>mlp_col_3_4&#45;&gt;gelu_3_4</title>
<path fill="none" stroke="black" d="M278.11,-477.57C276.24,-469.34 274.13,-460.08 272.13,-451.28"/>
<polygon fill="black" stroke="black" points="275.48,-450.22 269.85,-441.24 268.65,-451.77 275.48,-450.22"/>
</g>
<!-- mlp_row_3_4 -->
<g id="node337" class="node">
<title>mlp_row_3_4</title>
<polygon fill="lightpink" stroke="black" points="340.5,-351 187.5,-351 187.5,-298 340.5,-298 340.5,-351"/>
<text text-anchor="middle" x="264" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="264" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="264" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 4</text>
</g>
<!-- gelu_3_4&#45;&gt;mlp_row_3_4 -->
<g id="edge165" class="edge">
<title>gelu_3_4&#45;&gt;mlp_row_3_4</title>
<path fill="none" stroke="black" d="M264,-387.57C264,-379.34 264,-370.08 264,-361.28"/>
<polygon fill="black" stroke="black" points="267.5,-361.24 264,-351.24 260.5,-361.24 267.5,-361.24"/>
</g>
<!-- mlp_col_3_5 -->
<g id="node327" class="node">
<title>mlp_col_3_5</title>
<polygon fill="lightcyan" stroke="black" points="552.5,-531 385.5,-531 385.5,-478 552.5,-478 552.5,-531"/>
<text text-anchor="middle" x="469" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="469" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="469" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_3_5 -->
<g id="node328" class="node">
<title>gelu_3_5</title>
<polygon fill="lightcyan" stroke="black" points="511.5,-441 358.5,-441 358.5,-388 511.5,-388 511.5,-441"/>
<text text-anchor="middle" x="435" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="435" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="435" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- mlp_col_3_5&#45;&gt;gelu_3_5 -->
<g id="edge158" class="edge">
<title>mlp_col_3_5&#45;&gt;gelu_3_5</title>
<path fill="none" stroke="black" d="M458.98,-477.57C455.73,-469.16 452.07,-459.68 448.6,-450.7"/>
<polygon fill="black" stroke="black" points="451.81,-449.31 444.95,-441.24 445.28,-451.83 451.81,-449.31"/>
</g>
<!-- mlp_row_3_5 -->
<g id="node338" class="node">
<title>mlp_row_3_5</title>
<polygon fill="lightcyan" stroke="black" points="511.5,-351 358.5,-351 358.5,-298 511.5,-298 511.5,-351"/>
<text text-anchor="middle" x="435" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="435" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="435" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 5</text>
</g>
<!-- gelu_3_5&#45;&gt;mlp_row_3_5 -->
<g id="edge166" class="edge">
<title>gelu_3_5&#45;&gt;mlp_row_3_5</title>
<path fill="none" stroke="black" d="M435,-387.57C435,-379.34 435,-370.08 435,-361.28"/>
<polygon fill="black" stroke="black" points="438.5,-361.24 435,-351.24 431.5,-361.24 438.5,-361.24"/>
</g>
<!-- mlp_col_3_6 -->
<g id="node329" class="node">
<title>mlp_col_3_6</title>
<polygon fill="lightgrey" stroke="black" points="737.5,-531 570.5,-531 570.5,-478 737.5,-478 737.5,-531"/>
<text text-anchor="middle" x="654" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="654" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="654" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_3_6 -->
<g id="node330" class="node">
<title>gelu_3_6</title>
<polygon fill="lightgrey" stroke="black" points="682.5,-441 529.5,-441 529.5,-388 682.5,-388 682.5,-441"/>
<text text-anchor="middle" x="606" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="606" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="606" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- mlp_col_3_6&#45;&gt;gelu_3_6 -->
<g id="edge159" class="edge">
<title>mlp_col_3_6&#45;&gt;gelu_3_6</title>
<path fill="none" stroke="black" d="M639.86,-477.57C635.17,-468.98 629.88,-459.27 624.89,-450.13"/>
<polygon fill="black" stroke="black" points="627.9,-448.34 620.04,-441.24 621.76,-451.7 627.9,-448.34"/>
</g>
<!-- mlp_row_3_6 -->
<g id="node339" class="node">
<title>mlp_row_3_6</title>
<polygon fill="lightgrey" stroke="black" points="682.5,-351 529.5,-351 529.5,-298 682.5,-298 682.5,-351"/>
<text text-anchor="middle" x="606" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="606" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="606" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 6</text>
</g>
<!-- gelu_3_6&#45;&gt;mlp_row_3_6 -->
<g id="edge167" class="edge">
<title>gelu_3_6&#45;&gt;mlp_row_3_6</title>
<path fill="none" stroke="black" d="M606,-387.57C606,-379.34 606,-370.08 606,-361.28"/>
<polygon fill="black" stroke="black" points="609.5,-361.24 606,-351.24 602.5,-361.24 609.5,-361.24"/>
</g>
<!-- mlp_col_3_7 -->
<g id="node331" class="node">
<title>mlp_col_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="922.5,-531 755.5,-531 755.5,-478 922.5,-478 922.5,-531"/>
<text text-anchor="middle" x="839" y="-515.8" font-family="Times,serif" font-size="14.00">MLP Column Parallel</text>
<text text-anchor="middle" x="839" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="839" y="-485.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_3_7 -->
<g id="node332" class="node">
<title>gelu_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="853.5,-441 700.5,-441 700.5,-388 853.5,-388 853.5,-441"/>
<text text-anchor="middle" x="777" y="-425.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="777" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4096]</text>
<text text-anchor="middle" x="777" y="-395.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- mlp_col_3_7&#45;&gt;gelu_3_7 -->
<g id="edge160" class="edge">
<title>mlp_col_3_7&#45;&gt;gelu_3_7</title>
<path fill="none" stroke="black" d="M820.73,-477.57C814.55,-468.8 807.55,-458.87 801,-449.56"/>
<polygon fill="black" stroke="black" points="803.76,-447.4 795.14,-441.24 798.03,-451.43 803.76,-447.4"/>
</g>
<!-- mlp_row_3_7 -->
<g id="node340" class="node">
<title>mlp_row_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="853.5,-351 700.5,-351 700.5,-298 853.5,-298 853.5,-351"/>
<text text-anchor="middle" x="777" y="-335.8" font-family="Times,serif" font-size="14.00">MLP Row Parallel</text>
<text text-anchor="middle" x="777" y="-320.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="777" y="-305.8" font-family="Times,serif" font-size="14.00">TP Rank 7</text>
</g>
<!-- gelu_3_7&#45;&gt;mlp_row_3_7 -->
<g id="edge168" class="edge">
<title>gelu_3_7&#45;&gt;mlp_row_3_7</title>
<path fill="none" stroke="black" d="M777,-387.57C777,-379.34 777,-370.08 777,-361.28"/>
<polygon fill="black" stroke="black" points="780.5,-361.24 777,-351.24 773.5,-361.24 780.5,-361.24"/>
</g>
<!-- mlp_allreduce_3 -->
<g id="node341" class="node">
<title>mlp_allreduce_3</title>
<polygon fill="yellow" stroke="black" points="853.5,-247 700.5,-247 700.5,-194 853.5,-194 853.5,-247"/>
<text text-anchor="middle" x="777" y="-231.8" font-family="Times,serif" font-size="14.00">MLP All&#45;Reduce</text>
<text text-anchor="middle" x="777" y="-216.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="777" y="-201.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_row_3_0&#45;&gt;mlp_allreduce_3 -->
<g id="edge169" class="edge">
<title>mlp_row_3_0&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M904.85,-297.76C881.67,-283.94 852.95,-266.8 828.59,-252.28"/>
<polygon fill="black" stroke="black" points="830.22,-249.17 819.84,-247.05 826.64,-255.18 830.22,-249.17"/>
</g>
<!-- mlp_row_3_1&#45;&gt;mlp_allreduce_3 -->
<g id="edge170" class="edge">
<title>mlp_row_3_1&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1042.25,-300.61C989.21,-284.79 918.57,-263.72 863.53,-247.31"/>
<polygon fill="black" stroke="black" points="864.37,-243.91 853.79,-244.4 862.37,-250.61 864.37,-243.91"/>
</g>
<!-- mlp_row_3_2&#45;&gt;mlp_allreduce_3 -->
<g id="edge171" class="edge">
<title>mlp_row_3_2&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1213.22,-300.27C1210.11,-299.48 1207.03,-298.72 1204,-298 1087.16,-270.3 950.23,-247.43 863.56,-234.12"/>
<polygon fill="black" stroke="black" points="863.92,-230.63 853.5,-232.58 862.86,-237.55 863.92,-230.63"/>
</g>
<!-- mlp_row_3_3&#45;&gt;mlp_allreduce_3 -->
<g id="edge172" class="edge">
<title>mlp_row_3_3&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169.77,-299.87C172.54,-299.21 175.29,-298.58 178,-298 358.02,-259.33 572.97,-237.71 690.19,-227.95"/>
<polygon fill="black" stroke="black" points="690.5,-231.44 700.18,-227.13 689.93,-224.46 690.5,-231.44"/>
</g>
<!-- mlp_row_3_4&#45;&gt;mlp_allreduce_3 -->
<g id="edge173" class="edge">
<title>mlp_row_3_4&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M340.8,-300.03C343.56,-299.32 346.3,-298.64 349,-298 466.06,-270.08 603.33,-247.26 690.22,-234.02"/>
<polygon fill="black" stroke="black" points="690.94,-237.45 700.3,-232.5 689.89,-230.53 690.94,-237.45"/>
</g>
<!-- mlp_row_3_5&#45;&gt;mlp_allreduce_3 -->
<g id="edge174" class="edge">
<title>mlp_row_3_5&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M511.91,-300.42C514.64,-299.6 517.34,-298.79 520,-298 576.77,-281.04 640.61,-262.03 690.46,-247.21"/>
<polygon fill="black" stroke="black" points="691.65,-250.51 700.24,-244.3 689.65,-243.8 691.65,-250.51"/>
</g>
<!-- mlp_row_3_6&#45;&gt;mlp_allreduce_3 -->
<g id="edge175" class="edge">
<title>mlp_row_3_6&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M649.15,-297.76C672.33,-283.94 701.05,-266.8 725.41,-252.28"/>
<polygon fill="black" stroke="black" points="727.36,-255.18 734.16,-247.05 723.78,-249.17 727.36,-255.18"/>
</g>
<!-- mlp_row_3_7&#45;&gt;mlp_allreduce_3 -->
<g id="edge176" class="edge">
<title>mlp_row_3_7&#45;&gt;mlp_allreduce_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M777,-297.76C777,-285.56 777,-270.78 777,-257.49"/>
<polygon fill="black" stroke="black" points="780.5,-257.23 777,-247.23 773.5,-257.23 780.5,-257.23"/>
</g>
<!-- residual2_3 -->
<g id="node393" class="node">
<title>residual2_3</title>
<polygon fill="orange" stroke="black" points="1308.5,-143 1155.5,-143 1155.5,-90 1308.5,-90 1308.5,-143"/>
<text text-anchor="middle" x="1232" y="-127.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1232" y="-112.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1232" y="-97.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_allreduce_3&#45;&gt;residual2_3 -->
<g id="edge422" class="edge">
<title>mlp_allreduce_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M853.67,-202.31C934.43,-184.21 1061.34,-155.76 1145.59,-136.87"/>
<polygon fill="black" stroke="black" points="1146.4,-140.28 1155.4,-134.67 1144.87,-133.45 1146.4,-140.28"/>
</g>
<!-- qkv_3_0_0 -->
<g id="node343" class="node">
<title>qkv_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="3234.5,-621 3081.5,-621 3081.5,-568 3234.5,-568 3234.5,-621"/>
<text text-anchor="middle" x="3158" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3158" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3158" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_3&#45;&gt;qkv_3_0_0 -->
<g id="edge364" class="edge">
<title>ln1_3&#45;&gt;qkv_3_0_0</title>
<path fill="none" stroke="black" d="M2522.74,-680.14C2640.8,-673.99 2873.69,-657.99 3068,-621 3069.08,-620.79 3070.16,-620.58 3071.25,-620.36"/>
<polygon fill="black" stroke="black" points="3072.09,-623.76 3081.13,-618.24 3070.62,-616.92 3072.09,-623.76"/>
</g>
<!-- reshape_3_0_0 -->
<g id="node344" class="node">
<title>reshape_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="3280,-531 3118,-531 3118,-478 3280,-478 3280,-531"/>
<text text-anchor="middle" x="3199" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3199" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3199" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_3_0_0&#45;&gt;reshape_3_0_0 -->
<g id="edge365" class="edge">
<title>qkv_3_0_0&#45;&gt;reshape_3_0_0</title>
<path fill="none" stroke="black" d="M3170.08,-567.57C3174.04,-559.07 3178.51,-549.48 3182.73,-540.42"/>
<polygon fill="black" stroke="black" points="3185.96,-541.78 3187.01,-531.24 3179.61,-538.83 3185.96,-541.78"/>
</g>
<!-- attn_3_0_0 -->
<g id="node345" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="3339,-441 3113,-441 3113,-388 3339,-388 3339,-441"/>
<text text-anchor="middle" x="3226" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3226" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3226" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge366" class="edge">
<title>reshape_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M3206.95,-477.57C3209.51,-469.25 3212.38,-459.88 3215.11,-450.99"/>
<polygon fill="black" stroke="black" points="3218.51,-451.83 3218.1,-441.24 3211.82,-449.78 3218.51,-451.83"/>
</g>
<!-- attn_3_0_0&#45;&gt;proj_3_0_0 -->
<g id="edge367" class="edge">
<title>attn_3_0_0&#45;&gt;proj_3_0_0</title>
<path fill="none" stroke="black" d="M3209.21,-387.57C3203.58,-378.89 3197.22,-369.07 3191.25,-359.85"/>
<polygon fill="black" stroke="black" points="3194.05,-357.73 3185.67,-351.24 3188.17,-361.54 3194.05,-357.73"/>
</g>
<!-- qkv_3_0_1 -->
<g id="node346" class="node">
<title>qkv_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3058.5,-621 2905.5,-621 2905.5,-568 3058.5,-568 3058.5,-621"/>
<text text-anchor="middle" x="2982" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2982" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2982" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_3_0_1 -->
<g id="node347" class="node">
<title>reshape_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3063,-531 2901,-531 2901,-478 3063,-478 3063,-531"/>
<text text-anchor="middle" x="2982" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2982" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2982" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_3_0_1&#45;&gt;reshape_3_0_1 -->
<g id="edge368" class="edge">
<title>qkv_3_0_1&#45;&gt;reshape_3_0_1</title>
<path fill="none" stroke="black" d="M2982,-567.57C2982,-559.34 2982,-550.08 2982,-541.28"/>
<polygon fill="black" stroke="black" points="2985.5,-541.24 2982,-531.24 2978.5,-541.24 2985.5,-541.24"/>
</g>
<!-- attn_3_0_1 -->
<g id="node348" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3095,-441 2869,-441 2869,-388 3095,-388 3095,-441"/>
<text text-anchor="middle" x="2982" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2982" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2982" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge369" class="edge">
<title>reshape_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M2982,-477.57C2982,-469.34 2982,-460.08 2982,-451.28"/>
<polygon fill="black" stroke="black" points="2985.5,-451.24 2982,-441.24 2978.5,-451.24 2985.5,-451.24"/>
</g>
<!-- attn_3_0_1&#45;&gt;proj_3_0_1 -->
<g id="edge370" class="edge">
<title>attn_3_0_1&#45;&gt;proj_3_0_1</title>
<path fill="none" stroke="black" d="M2982,-387.57C2982,-379.34 2982,-370.08 2982,-361.28"/>
<polygon fill="black" stroke="black" points="2985.5,-361.24 2982,-351.24 2978.5,-361.24 2985.5,-361.24"/>
</g>
<!-- qkv_3_0_2 -->
<g id="node349" class="node">
<title>qkv_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="2814.5,-621 2661.5,-621 2661.5,-568 2814.5,-568 2814.5,-621"/>
<text text-anchor="middle" x="2738" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2738" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2738" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_3_0_2 -->
<g id="node350" class="node">
<title>reshape_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="2819,-531 2657,-531 2657,-478 2819,-478 2819,-531"/>
<text text-anchor="middle" x="2738" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2738" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2738" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_3_0_2&#45;&gt;reshape_3_0_2 -->
<g id="edge371" class="edge">
<title>qkv_3_0_2&#45;&gt;reshape_3_0_2</title>
<path fill="none" stroke="black" d="M2738,-567.57C2738,-559.34 2738,-550.08 2738,-541.28"/>
<polygon fill="black" stroke="black" points="2741.5,-541.24 2738,-531.24 2734.5,-541.24 2741.5,-541.24"/>
</g>
<!-- attn_3_0_2 -->
<g id="node351" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="2851,-441 2625,-441 2625,-388 2851,-388 2851,-441"/>
<text text-anchor="middle" x="2738" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2738" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2738" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge372" class="edge">
<title>reshape_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M2738,-477.57C2738,-469.34 2738,-460.08 2738,-451.28"/>
<polygon fill="black" stroke="black" points="2741.5,-451.24 2738,-441.24 2734.5,-451.24 2741.5,-451.24"/>
</g>
<!-- attn_3_0_2&#45;&gt;proj_3_0_2 -->
<g id="edge373" class="edge">
<title>attn_3_0_2&#45;&gt;proj_3_0_2</title>
<path fill="none" stroke="black" d="M2756.27,-387.57C2762.45,-378.8 2769.45,-368.87 2776,-359.56"/>
<polygon fill="black" stroke="black" points="2778.97,-361.43 2781.86,-351.24 2773.24,-357.4 2778.97,-361.43"/>
</g>
<!-- qkv_3_0_3 -->
<g id="node352" class="node">
<title>qkv_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2570.5,-621 2417.5,-621 2417.5,-568 2570.5,-568 2570.5,-621"/>
<text text-anchor="middle" x="2494" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2494" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2494" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_3_0_3 -->
<g id="node353" class="node">
<title>reshape_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2575,-531 2413,-531 2413,-478 2575,-478 2575,-531"/>
<text text-anchor="middle" x="2494" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2494" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2494" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_3_0_3&#45;&gt;reshape_3_0_3 -->
<g id="edge374" class="edge">
<title>qkv_3_0_3&#45;&gt;reshape_3_0_3</title>
<path fill="none" stroke="black" d="M2494,-567.57C2494,-559.34 2494,-550.08 2494,-541.28"/>
<polygon fill="black" stroke="black" points="2497.5,-541.24 2494,-531.24 2490.5,-541.24 2497.5,-541.24"/>
</g>
<!-- attn_3_0_3 -->
<g id="node354" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="2607,-441 2381,-441 2381,-388 2607,-388 2607,-441"/>
<text text-anchor="middle" x="2494" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2494" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2494" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge375" class="edge">
<title>reshape_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M2494,-477.57C2494,-469.34 2494,-460.08 2494,-451.28"/>
<polygon fill="black" stroke="black" points="2497.5,-451.24 2494,-441.24 2490.5,-451.24 2497.5,-451.24"/>
</g>
<!-- attn_3_0_3&#45;&gt;proj_3_0_3 -->
<g id="edge376" class="edge">
<title>attn_3_0_3&#45;&gt;proj_3_0_3</title>
<path fill="none" stroke="black" d="M2524.07,-387.81C2535.07,-378.41 2547.66,-367.66 2559.24,-357.76"/>
<polygon fill="black" stroke="black" points="2561.74,-360.23 2567.07,-351.07 2557.2,-354.9 2561.74,-360.23"/>
</g>
<!-- qkv_3_1_0 -->
<g id="node355" class="node">
<title>qkv_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="2082.5,-621 1929.5,-621 1929.5,-568 2082.5,-568 2082.5,-621"/>
<text text-anchor="middle" x="2006" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2006" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2006" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_3_1_0 -->
<g id="node356" class="node">
<title>reshape_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="2087,-531 1925,-531 1925,-478 2087,-478 2087,-531"/>
<text text-anchor="middle" x="2006" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2006" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2006" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_3_1_0&#45;&gt;reshape_3_1_0 -->
<g id="edge377" class="edge">
<title>qkv_3_1_0&#45;&gt;reshape_3_1_0</title>
<path fill="none" stroke="black" d="M2006,-567.57C2006,-559.34 2006,-550.08 2006,-541.28"/>
<polygon fill="black" stroke="black" points="2009.5,-541.24 2006,-531.24 2002.5,-541.24 2009.5,-541.24"/>
</g>
<!-- attn_3_1_0 -->
<g id="node357" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="2119,-441 1893,-441 1893,-388 2119,-388 2119,-441"/>
<text text-anchor="middle" x="2006" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2006" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2006" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge378" class="edge">
<title>reshape_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M2006,-477.57C2006,-469.34 2006,-460.08 2006,-451.28"/>
<polygon fill="black" stroke="black" points="2009.5,-451.24 2006,-441.24 2002.5,-451.24 2009.5,-451.24"/>
</g>
<!-- attn_3_1_0&#45;&gt;proj_3_1_0 -->
<g id="edge379" class="edge">
<title>attn_3_1_0&#45;&gt;proj_3_1_0</title>
<path fill="none" stroke="black" d="M2006,-387.57C2006,-379.34 2006,-370.08 2006,-361.28"/>
<polygon fill="black" stroke="black" points="2009.5,-361.24 2006,-351.24 2002.5,-361.24 2009.5,-361.24"/>
</g>
<!-- qkv_3_1_1 -->
<g id="node358" class="node">
<title>qkv_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1852.5,-621 1699.5,-621 1699.5,-568 1852.5,-568 1852.5,-621"/>
<text text-anchor="middle" x="1776" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1776" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1776" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_3_1_1 -->
<g id="node359" class="node">
<title>reshape_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1857,-531 1695,-531 1695,-478 1857,-478 1857,-531"/>
<text text-anchor="middle" x="1776" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1776" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1776" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_3_1_1&#45;&gt;reshape_3_1_1 -->
<g id="edge380" class="edge">
<title>qkv_3_1_1&#45;&gt;reshape_3_1_1</title>
<path fill="none" stroke="black" d="M1776,-567.57C1776,-559.34 1776,-550.08 1776,-541.28"/>
<polygon fill="black" stroke="black" points="1779.5,-541.24 1776,-531.24 1772.5,-541.24 1779.5,-541.24"/>
</g>
<!-- attn_3_1_1 -->
<g id="node360" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1875,-441 1649,-441 1649,-388 1875,-388 1875,-441"/>
<text text-anchor="middle" x="1762" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1762" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1762" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge381" class="edge">
<title>reshape_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M1771.88,-477.57C1770.57,-469.34 1769.09,-460.08 1767.69,-451.28"/>
<polygon fill="black" stroke="black" points="1771.12,-450.57 1766.1,-441.24 1764.21,-451.67 1771.12,-450.57"/>
</g>
<!-- attn_3_1_1&#45;&gt;proj_3_1_1 -->
<g id="edge382" class="edge">
<title>attn_3_1_1&#45;&gt;proj_3_1_1</title>
<path fill="none" stroke="black" d="M1778.79,-387.57C1784.42,-378.89 1790.78,-369.07 1796.75,-359.85"/>
<polygon fill="black" stroke="black" points="1799.83,-361.54 1802.33,-351.24 1793.95,-357.73 1799.83,-361.54"/>
</g>
<!-- qkv_3_1_2 -->
<g id="node361" class="node">
<title>qkv_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1672.5,-621 1519.5,-621 1519.5,-568 1672.5,-568 1672.5,-621"/>
<text text-anchor="middle" x="1596" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1596" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1596" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_3_1_2 -->
<g id="node362" class="node">
<title>reshape_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1677,-531 1515,-531 1515,-478 1677,-478 1677,-531"/>
<text text-anchor="middle" x="1596" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1596" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1596" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_3_1_2&#45;&gt;reshape_3_1_2 -->
<g id="edge383" class="edge">
<title>qkv_3_1_2&#45;&gt;reshape_3_1_2</title>
<path fill="none" stroke="black" d="M1596,-567.57C1596,-559.34 1596,-550.08 1596,-541.28"/>
<polygon fill="black" stroke="black" points="1599.5,-541.24 1596,-531.24 1592.5,-541.24 1599.5,-541.24"/>
</g>
<!-- attn_3_1_2 -->
<g id="node363" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1631,-441 1405,-441 1405,-388 1631,-388 1631,-441"/>
<text text-anchor="middle" x="1518" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1518" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1518" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge384" class="edge">
<title>reshape_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M1573.02,-477.57C1565.09,-468.62 1556.08,-458.46 1547.69,-448.99"/>
<polygon fill="black" stroke="black" points="1550.07,-446.4 1540.82,-441.24 1544.83,-451.05 1550.07,-446.4"/>
</g>
<!-- attn_3_1_2&#45;&gt;proj_3_1_2 -->
<g id="edge385" class="edge">
<title>attn_3_1_2&#45;&gt;proj_3_1_2</title>
<path fill="none" stroke="black" d="M1546.61,-387.81C1557.08,-378.41 1569.05,-367.66 1580.08,-357.76"/>
<polygon fill="black" stroke="black" points="1582.42,-360.36 1587.52,-351.07 1577.75,-355.15 1582.42,-360.36"/>
</g>
<!-- qkv_3_1_3 -->
<g id="node364" class="node">
<title>qkv_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2326.5,-621 2173.5,-621 2173.5,-568 2326.5,-568 2326.5,-621"/>
<text text-anchor="middle" x="2250" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2250" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2250" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_3_1_3 -->
<g id="node365" class="node">
<title>reshape_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2331,-531 2169,-531 2169,-478 2331,-478 2331,-531"/>
<text text-anchor="middle" x="2250" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2250" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2250" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_3_1_3&#45;&gt;reshape_3_1_3 -->
<g id="edge386" class="edge">
<title>qkv_3_1_3&#45;&gt;reshape_3_1_3</title>
<path fill="none" stroke="black" d="M2250,-567.57C2250,-559.34 2250,-550.08 2250,-541.28"/>
<polygon fill="black" stroke="black" points="2253.5,-541.24 2250,-531.24 2246.5,-541.24 2253.5,-541.24"/>
</g>
<!-- attn_3_1_3 -->
<g id="node366" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2363,-441 2137,-441 2137,-388 2363,-388 2363,-441"/>
<text text-anchor="middle" x="2250" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2250" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2250" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge387" class="edge">
<title>reshape_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M2250,-477.57C2250,-469.34 2250,-460.08 2250,-451.28"/>
<polygon fill="black" stroke="black" points="2253.5,-451.24 2250,-441.24 2246.5,-451.24 2253.5,-451.24"/>
</g>
<!-- attn_3_1_3&#45;&gt;proj_3_1_3 -->
<g id="edge388" class="edge">
<title>attn_3_1_3&#45;&gt;proj_3_1_3</title>
<path fill="none" stroke="black" d="M2233.21,-387.57C2227.58,-378.89 2221.22,-369.07 2215.25,-359.85"/>
<polygon fill="black" stroke="black" points="2218.05,-357.73 2209.67,-351.24 2212.17,-361.54 2218.05,-357.73"/>
</g>
<!-- qkv_3_2_0 -->
<g id="node367" class="node">
<title>qkv_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="4522.5,-621 4369.5,-621 4369.5,-568 4522.5,-568 4522.5,-621"/>
<text text-anchor="middle" x="4446" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4446" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4446" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_3_2_0 -->
<g id="node368" class="node">
<title>reshape_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="4527,-531 4365,-531 4365,-478 4527,-478 4527,-531"/>
<text text-anchor="middle" x="4446" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4446" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4446" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_3_2_0&#45;&gt;reshape_3_2_0 -->
<g id="edge389" class="edge">
<title>qkv_3_2_0&#45;&gt;reshape_3_2_0</title>
<path fill="none" stroke="black" d="M4446,-567.57C4446,-559.34 4446,-550.08 4446,-541.28"/>
<polygon fill="black" stroke="black" points="4449.5,-541.24 4446,-531.24 4442.5,-541.24 4449.5,-541.24"/>
</g>
<!-- attn_3_2_0 -->
<g id="node369" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="4559,-441 4333,-441 4333,-388 4559,-388 4559,-441"/>
<text text-anchor="middle" x="4446" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4446" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4446" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge390" class="edge">
<title>reshape_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M4446,-477.57C4446,-469.34 4446,-460.08 4446,-451.28"/>
<polygon fill="black" stroke="black" points="4449.5,-451.24 4446,-441.24 4442.5,-451.24 4449.5,-451.24"/>
</g>
<!-- attn_3_2_0&#45;&gt;proj_3_2_0 -->
<g id="edge391" class="edge">
<title>attn_3_2_0&#45;&gt;proj_3_2_0</title>
<path fill="none" stroke="black" d="M4464.27,-387.57C4470.45,-378.8 4477.45,-368.87 4484,-359.56"/>
<polygon fill="black" stroke="black" points="4486.97,-361.43 4489.86,-351.24 4481.24,-357.4 4486.97,-361.43"/>
</g>
<!-- qkv_3_2_1 -->
<g id="node370" class="node">
<title>qkv_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5254.5,-621 5101.5,-621 5101.5,-568 5254.5,-568 5254.5,-621"/>
<text text-anchor="middle" x="5178" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5178" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5178" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_3_2_1 -->
<g id="node371" class="node">
<title>reshape_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5259,-531 5097,-531 5097,-478 5259,-478 5259,-531"/>
<text text-anchor="middle" x="5178" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5178" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5178" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_3_2_1&#45;&gt;reshape_3_2_1 -->
<g id="edge392" class="edge">
<title>qkv_3_2_1&#45;&gt;reshape_3_2_1</title>
<path fill="none" stroke="black" d="M5178,-567.57C5178,-559.34 5178,-550.08 5178,-541.28"/>
<polygon fill="black" stroke="black" points="5181.5,-541.24 5178,-531.24 5174.5,-541.24 5181.5,-541.24"/>
</g>
<!-- attn_3_2_1 -->
<g id="node372" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5291,-441 5065,-441 5065,-388 5291,-388 5291,-441"/>
<text text-anchor="middle" x="5178" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5178" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5178" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge393" class="edge">
<title>reshape_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M5178,-477.57C5178,-469.34 5178,-460.08 5178,-451.28"/>
<polygon fill="black" stroke="black" points="5181.5,-451.24 5178,-441.24 5174.5,-451.24 5181.5,-451.24"/>
</g>
<!-- attn_3_2_1&#45;&gt;proj_3_2_1 -->
<g id="edge394" class="edge">
<title>attn_3_2_1&#45;&gt;proj_3_2_1</title>
<path fill="none" stroke="black" d="M5159.73,-387.57C5153.55,-378.8 5146.55,-368.87 5140,-359.56"/>
<polygon fill="black" stroke="black" points="5142.76,-357.4 5134.14,-351.24 5137.03,-361.43 5142.76,-357.4"/>
</g>
<!-- qkv_3_2_2 -->
<g id="node373" class="node">
<title>qkv_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5010.5,-621 4857.5,-621 4857.5,-568 5010.5,-568 5010.5,-621"/>
<text text-anchor="middle" x="4934" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4934" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4934" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_3_2_2 -->
<g id="node374" class="node">
<title>reshape_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5015,-531 4853,-531 4853,-478 5015,-478 5015,-531"/>
<text text-anchor="middle" x="4934" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4934" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4934" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_3_2_2&#45;&gt;reshape_3_2_2 -->
<g id="edge395" class="edge">
<title>qkv_3_2_2&#45;&gt;reshape_3_2_2</title>
<path fill="none" stroke="black" d="M4934,-567.57C4934,-559.34 4934,-550.08 4934,-541.28"/>
<polygon fill="black" stroke="black" points="4937.5,-541.24 4934,-531.24 4930.5,-541.24 4937.5,-541.24"/>
</g>
<!-- attn_3_2_2 -->
<g id="node375" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="5047,-441 4821,-441 4821,-388 5047,-388 5047,-441"/>
<text text-anchor="middle" x="4934" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4934" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4934" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge396" class="edge">
<title>reshape_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M4934,-477.57C4934,-469.34 4934,-460.08 4934,-451.28"/>
<polygon fill="black" stroke="black" points="4937.5,-451.24 4934,-441.24 4930.5,-451.24 4937.5,-451.24"/>
</g>
<!-- attn_3_2_2&#45;&gt;proj_3_2_2 -->
<g id="edge397" class="edge">
<title>attn_3_2_2&#45;&gt;proj_3_2_2</title>
<path fill="none" stroke="black" d="M4921.92,-387.57C4917.96,-379.07 4913.49,-369.48 4909.27,-360.42"/>
<polygon fill="black" stroke="black" points="4912.39,-358.83 4904.99,-351.24 4906.04,-361.78 4912.39,-358.83"/>
</g>
<!-- qkv_3_2_3 -->
<g id="node376" class="node">
<title>qkv_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4766.5,-621 4613.5,-621 4613.5,-568 4766.5,-568 4766.5,-621"/>
<text text-anchor="middle" x="4690" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4690" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4690" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_3_2_3 -->
<g id="node377" class="node">
<title>reshape_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4771,-531 4609,-531 4609,-478 4771,-478 4771,-531"/>
<text text-anchor="middle" x="4690" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4690" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4690" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_3_2_3&#45;&gt;reshape_3_2_3 -->
<g id="edge398" class="edge">
<title>qkv_3_2_3&#45;&gt;reshape_3_2_3</title>
<path fill="none" stroke="black" d="M4690,-567.57C4690,-559.34 4690,-550.08 4690,-541.28"/>
<polygon fill="black" stroke="black" points="4693.5,-541.24 4690,-531.24 4686.5,-541.24 4693.5,-541.24"/>
</g>
<!-- attn_3_2_3 -->
<g id="node378" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4803,-441 4577,-441 4577,-388 4803,-388 4803,-441"/>
<text text-anchor="middle" x="4690" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4690" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4690" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge399" class="edge">
<title>reshape_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M4690,-477.57C4690,-469.34 4690,-460.08 4690,-451.28"/>
<polygon fill="black" stroke="black" points="4693.5,-451.24 4690,-441.24 4686.5,-451.24 4693.5,-451.24"/>
</g>
<!-- attn_3_2_3&#45;&gt;proj_3_2_3 -->
<g id="edge400" class="edge">
<title>attn_3_2_3&#45;&gt;proj_3_2_3</title>
<path fill="none" stroke="black" d="M4690,-387.57C4690,-379.34 4690,-370.08 4690,-361.28"/>
<polygon fill="black" stroke="black" points="4693.5,-361.24 4690,-351.24 4686.5,-361.24 4693.5,-361.24"/>
</g>
<!-- qkv_3_3_0 -->
<g id="node379" class="node">
<title>qkv_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3546.5,-621 3393.5,-621 3393.5,-568 3546.5,-568 3546.5,-621"/>
<text text-anchor="middle" x="3470" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3470" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3470" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_3_3_0 -->
<g id="node380" class="node">
<title>reshape_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3551,-531 3389,-531 3389,-478 3551,-478 3551,-531"/>
<text text-anchor="middle" x="3470" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3470" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3470" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_3_0&#45;&gt;reshape_3_3_0 -->
<g id="edge401" class="edge">
<title>qkv_3_3_0&#45;&gt;reshape_3_3_0</title>
<path fill="none" stroke="black" d="M3470,-567.57C3470,-559.34 3470,-550.08 3470,-541.28"/>
<polygon fill="black" stroke="black" points="3473.5,-541.24 3470,-531.24 3466.5,-541.24 3473.5,-541.24"/>
</g>
<!-- attn_3_3_0 -->
<g id="node381" class="node">
<title>attn_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3583,-441 3357,-441 3357,-388 3583,-388 3583,-441"/>
<text text-anchor="middle" x="3470" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3470" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3470" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge402" class="edge">
<title>reshape_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M3470,-477.57C3470,-469.34 3470,-460.08 3470,-451.28"/>
<polygon fill="black" stroke="black" points="3473.5,-451.24 3470,-441.24 3466.5,-451.24 3473.5,-451.24"/>
</g>
<!-- attn_3_3_0&#45;&gt;proj_3_3_0 -->
<g id="edge403" class="edge">
<title>attn_3_3_0&#45;&gt;proj_3_3_0</title>
<path fill="none" stroke="black" d="M3482.08,-387.57C3486.04,-379.07 3490.51,-369.48 3494.73,-360.42"/>
<polygon fill="black" stroke="black" points="3497.96,-361.78 3499.01,-351.24 3491.61,-358.83 3497.96,-361.78"/>
</g>
<!-- qkv_3_3_1 -->
<g id="node382" class="node">
<title>qkv_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="4278.5,-621 4125.5,-621 4125.5,-568 4278.5,-568 4278.5,-621"/>
<text text-anchor="middle" x="4202" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4202" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="4202" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_3_3_1 -->
<g id="node383" class="node">
<title>reshape_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="4283,-531 4121,-531 4121,-478 4283,-478 4283,-531"/>
<text text-anchor="middle" x="4202" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="4202" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4202" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_3_1&#45;&gt;reshape_3_3_1 -->
<g id="edge404" class="edge">
<title>qkv_3_3_1&#45;&gt;reshape_3_3_1</title>
<path fill="none" stroke="black" d="M4202,-567.57C4202,-559.34 4202,-550.08 4202,-541.28"/>
<polygon fill="black" stroke="black" points="4205.5,-541.24 4202,-531.24 4198.5,-541.24 4205.5,-541.24"/>
</g>
<!-- attn_3_3_1 -->
<g id="node384" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="4315,-441 4089,-441 4089,-388 4315,-388 4315,-441"/>
<text text-anchor="middle" x="4202" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4202" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="4202" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge405" class="edge">
<title>reshape_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M4202,-477.57C4202,-469.34 4202,-460.08 4202,-451.28"/>
<polygon fill="black" stroke="black" points="4205.5,-451.24 4202,-441.24 4198.5,-451.24 4205.5,-451.24"/>
</g>
<!-- attn_3_3_1&#45;&gt;proj_3_3_1 -->
<g id="edge406" class="edge">
<title>attn_3_3_1&#45;&gt;proj_3_3_1</title>
<path fill="none" stroke="black" d="M4176.37,-387.57C4167.34,-378.44 4157.07,-368.06 4147.55,-358.43"/>
<polygon fill="black" stroke="black" points="4149.97,-355.89 4140.45,-351.24 4144.99,-360.81 4149.97,-355.89"/>
</g>
<!-- qkv_3_3_2 -->
<g id="node385" class="node">
<title>qkv_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="4034.5,-621 3881.5,-621 3881.5,-568 4034.5,-568 4034.5,-621"/>
<text text-anchor="middle" x="3958" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3958" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3958" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_3_3_2 -->
<g id="node386" class="node">
<title>reshape_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="4039,-531 3877,-531 3877,-478 4039,-478 4039,-531"/>
<text text-anchor="middle" x="3958" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3958" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3958" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_3_2&#45;&gt;reshape_3_3_2 -->
<g id="edge407" class="edge">
<title>qkv_3_3_2&#45;&gt;reshape_3_3_2</title>
<path fill="none" stroke="black" d="M3958,-567.57C3958,-559.34 3958,-550.08 3958,-541.28"/>
<polygon fill="black" stroke="black" points="3961.5,-541.24 3958,-531.24 3954.5,-541.24 3961.5,-541.24"/>
</g>
<!-- attn_3_3_2 -->
<g id="node387" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="4071,-441 3845,-441 3845,-388 4071,-388 4071,-441"/>
<text text-anchor="middle" x="3958" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3958" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3958" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge408" class="edge">
<title>reshape_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M3958,-477.57C3958,-469.34 3958,-460.08 3958,-451.28"/>
<polygon fill="black" stroke="black" points="3961.5,-451.24 3958,-441.24 3954.5,-451.24 3961.5,-451.24"/>
</g>
<!-- attn_3_3_2&#45;&gt;proj_3_3_2 -->
<g id="edge409" class="edge">
<title>attn_3_3_2&#45;&gt;proj_3_3_2</title>
<path fill="none" stroke="black" d="M3945.92,-387.57C3941.96,-379.07 3937.49,-369.48 3933.27,-360.42"/>
<polygon fill="black" stroke="black" points="3936.39,-358.83 3928.99,-351.24 3930.04,-361.78 3936.39,-358.83"/>
</g>
<!-- qkv_3_3_3 -->
<g id="node388" class="node">
<title>qkv_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3790.5,-621 3637.5,-621 3637.5,-568 3790.5,-568 3790.5,-621"/>
<text text-anchor="middle" x="3714" y="-605.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3714" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3714" y="-575.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_3_3_3 -->
<g id="node389" class="node">
<title>reshape_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3795,-531 3633,-531 3633,-478 3795,-478 3795,-531"/>
<text text-anchor="middle" x="3714" y="-515.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3714" y="-500.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3714" y="-485.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3_3&#45;&gt;reshape_3_3_3 -->
<g id="edge410" class="edge">
<title>qkv_3_3_3&#45;&gt;reshape_3_3_3</title>
<path fill="none" stroke="black" d="M3714,-567.57C3714,-559.34 3714,-550.08 3714,-541.28"/>
<polygon fill="black" stroke="black" points="3717.5,-541.24 3714,-531.24 3710.5,-541.24 3717.5,-541.24"/>
</g>
<!-- attn_3_3_3 -->
<g id="node390" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3827,-441 3601,-441 3601,-388 3827,-388 3827,-441"/>
<text text-anchor="middle" x="3714" y="-425.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3714" y="-410.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3714" y="-395.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge411" class="edge">
<title>reshape_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M3714,-477.57C3714,-469.34 3714,-460.08 3714,-451.28"/>
<polygon fill="black" stroke="black" points="3717.5,-451.24 3714,-441.24 3710.5,-451.24 3717.5,-451.24"/>
</g>
<!-- attn_3_3_3&#45;&gt;proj_3_3_3 -->
<g id="edge412" class="edge">
<title>attn_3_3_3&#45;&gt;proj_3_3_3</title>
<path fill="none" stroke="black" d="M3714,-387.57C3714,-379.34 3714,-370.08 3714,-361.28"/>
<polygon fill="black" stroke="black" points="3717.5,-361.24 3714,-351.24 3710.5,-361.24 3717.5,-361.24"/>
</g>
<!-- ln2_3 -->
<g id="node392" class="node">
<title>ln2_3</title>
<polygon fill="white" stroke="black" points="915.5,-621 762.5,-621 762.5,-568 915.5,-568 915.5,-621"/>
<text text-anchor="middle" x="839" y="-605.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="839" y="-590.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="839" y="-575.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge413" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M1419.35,-673.23C1296.25,-656.75 1055.25,-624.47 925.93,-607.14"/>
<polygon fill="black" stroke="black" points="926.05,-603.63 915.67,-605.77 925.12,-610.57 926.05,-603.63"/>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge424" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M1498.07,-657.78C1501.44,-609.19 1505.93,-506.23 1486,-478 1461.06,-442.67 1422.53,-475.16 1396,-441 1376.45,-415.83 1386,-401.87 1386,-370 1386,-370 1386,-370 1386,-219.5 1386,-181.67 1353.3,-157.05 1318.04,-141.49"/>
<polygon fill="black" stroke="black" points="1319.13,-138.15 1308.55,-137.54 1316.43,-144.61 1319.13,-138.15"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_0 -->
<g id="edge414" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_0</title>
<path fill="none" stroke="black" d="M893.01,-567.81C914.28,-557.69 938.87,-546 960.95,-535.49"/>
<polygon fill="black" stroke="black" points="962.72,-538.53 970.25,-531.07 959.71,-532.2 962.72,-538.53"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_1 -->
<g id="edge415" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_1</title>
<path fill="none" stroke="black" d="M915.65,-577.19C968.98,-565.61 1041.97,-549.32 1115.49,-531.08"/>
<polygon fill="black" stroke="black" points="1116.54,-534.43 1125.4,-528.62 1114.85,-527.64 1116.54,-534.43"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_2 -->
<g id="edge416" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_2</title>
<path fill="none" stroke="black" d="M915.55,-586.3C1005.46,-577.13 1159.16,-559.26 1300.33,-531.02"/>
<polygon fill="black" stroke="black" points="1301.37,-534.38 1310.47,-528.97 1299.98,-527.52 1301.37,-534.38"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_3 -->
<g id="edge417" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_3</title>
<path fill="none" stroke="black" d="M762.09,-590.42C642.02,-584.66 402.82,-569.34 192.58,-531.17"/>
<polygon fill="black" stroke="black" points="193.06,-527.7 182.59,-529.33 191.8,-534.58 193.06,-527.7"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_4 -->
<g id="edge418" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_4</title>
<path fill="none" stroke="black" d="M762.27,-586.38C672.15,-577.28 518.11,-559.48 377.7,-531.25"/>
<polygon fill="black" stroke="black" points="378.12,-527.76 367.62,-529.2 376.72,-534.62 378.12,-527.76"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_5 -->
<g id="edge419" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_5</title>
<path fill="none" stroke="black" d="M762.36,-577.33C708.8,-565.79 635.41,-549.47 562.5,-531.34"/>
<polygon fill="black" stroke="black" points="563.24,-527.91 552.69,-528.89 561.54,-534.71 563.24,-527.91"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_6 -->
<g id="edge420" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_6</title>
<path fill="none" stroke="black" d="M784.99,-567.81C763.72,-557.69 739.13,-546 717.05,-535.49"/>
<polygon fill="black" stroke="black" points="718.29,-532.2 707.75,-531.07 715.28,-538.53 718.29,-532.2"/>
</g>
<!-- ln2_3&#45;&gt;mlp_col_3_7 -->
<g id="edge421" class="edge">
<title>ln2_3&#45;&gt;mlp_col_3_7</title>
<path fill="none" stroke="black" d="M839,-567.57C839,-559.34 839,-550.08 839,-541.28"/>
<polygon fill="black" stroke="black" points="842.5,-541.24 839,-531.24 835.5,-541.24 842.5,-541.24"/>
</g>
<!-- output -->
<g id="node394" class="node">
<title>output</title>
<polygon fill="white" stroke="black" points="1308.5,-53 1155.5,-53 1155.5,0 1308.5,0 1308.5,-53"/>
<text text-anchor="middle" x="1232" y="-37.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1232" y="-22.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1232" y="-7.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_3&#45;&gt;output -->
<g id="edge425" class="edge">
<title>residual2_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1232,-89.57C1232,-81.34 1232,-72.08 1232,-63.28"/>
<polygon fill="black" stroke="black" points="1235.5,-63.24 1232,-53.24 1228.5,-63.24 1235.5,-63.24"/>
</g>
</g>
</svg>
