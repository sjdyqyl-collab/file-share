<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Transformer_16GPUs Pages: 1 -->
<svg width="1440pt" height="642pt"
 viewBox="0.00 0.00 1440.00 642.34" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 10619.68)">
<title>Dense_Transformer_16GPUs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-10619.68 23812.15,-10619.68 23812.15,4 -4,4"/>
<g id="clust17" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9768.57,-10404.68 9768.57,-10607.68 14822.57,-10607.68 14822.57,-10404.68 9768.57,-10404.68"/>
<text text-anchor="middle" x="12295.57" y="-10592.48" font-family="Times,serif" font-size="14.00">Input Embedding</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="13000.57,-8 13000.57,-330.17 19238.57,-330.17 19238.57,-8 13000.57,-8"/>
<text text-anchor="middle" x="16119.57" y="-314.97" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input_tensor -->
<g id="node1" class="node">
<title>input_tensor</title>
<polygon fill="lightblue" stroke="black" points="14795.57,-10576.68 14575.57,-10576.68 14575.57,-10538.68 14795.57,-10538.68 14795.57,-10576.68"/>
<text text-anchor="middle" x="14685.57" y="-10561.48" font-family="Times,serif" font-size="14.00">Input Tensor</text>
<text text-anchor="middle" x="14685.57" y="-10546.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- embed_0 -->
<g id="node2" class="node">
<title>embed_0</title>
<ellipse fill="yellow" stroke="black" cx="9925.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="9925.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="9925.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9925.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input_tensor&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M14575.48,-10556.34C13949.11,-10554.3 10847.5,-10543.12 10422.57,-10520.68 10271.41,-10512.7 10232.97,-10512.11 10083.57,-10487.68 10069.24,-10485.34 10054.26,-10482.46 10039.49,-10479.35"/>
<polygon fill="black" stroke="black" points="10039.82,-10475.84 10029.3,-10477.17 10038.35,-10482.69 10039.82,-10475.84"/>
<text text-anchor="middle" x="10475.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_1 -->
<g id="node3" class="node">
<title>embed_1</title>
<ellipse fill="yellow" stroke="black" cx="10241.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10241.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10241.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10241.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_1 -->
<g id="edge2" class="edge">
<title>input_tensor&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M14575.25,-10556.88C14020.84,-10557.71 11535.26,-10559.14 10763.57,-10520.68 10601.33,-10512.6 10559.97,-10513.36 10399.57,-10487.68 10385.23,-10485.39 10370.25,-10482.53 10355.48,-10479.44"/>
<polygon fill="black" stroke="black" points="10355.8,-10475.93 10345.29,-10477.27 10354.34,-10482.78 10355.8,-10475.93"/>
<text text-anchor="middle" x="10816.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_2 -->
<g id="node4" class="node">
<title>embed_2</title>
<ellipse fill="yellow" stroke="black" cx="10557.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10557.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10557.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10557.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_2 -->
<g id="edge3" class="edge">
<title>input_tensor&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M14575.28,-10556.31C14179.42,-10554.77 12793.11,-10547.66 11649.57,-10520.68 11234.32,-10510.89 11127.38,-10542.01 10715.57,-10487.68 10700.58,-10485.71 10684.91,-10482.95 10669.53,-10479.83"/>
<polygon fill="black" stroke="black" points="10669.97,-10476.35 10659.47,-10477.73 10668.54,-10483.2 10669.97,-10476.35"/>
<text text-anchor="middle" x="11702.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_3 -->
<g id="node5" class="node">
<title>embed_3</title>
<ellipse fill="yellow" stroke="black" cx="10873.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10873.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10873.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10873.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_3 -->
<g id="edge4" class="edge">
<title>input_tensor&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M14575.43,-10555.4C14240.08,-10551.39 13201.93,-10538.36 12341.57,-10520.68 12082.43,-10515.36 12017.69,-10512.22 11758.57,-10505.68 11597.02,-10501.61 11191.9,-10507.97 11031.57,-10487.68 11016.45,-10485.77 11000.66,-10483.03 10985.16,-10479.91"/>
<polygon fill="black" stroke="black" points="10985.52,-10476.41 10975.02,-10477.8 10984.1,-10483.26 10985.52,-10476.41"/>
<text text-anchor="middle" x="12394.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_4 -->
<g id="node6" class="node">
<title>embed_4</title>
<ellipse fill="yellow" stroke="black" cx="11189.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11189.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11189.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11189.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_4 -->
<g id="edge5" class="edge">
<title>input_tensor&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M14575.42,-10555.84C14280.01,-10553.3 13445.48,-10544.43 12751.57,-10520.68 12617.71,-10516.1 12584.44,-10510.11 12450.57,-10505.68 12205.56,-10497.58 11590.9,-10517.44 11347.57,-10487.68 11332.33,-10485.82 11316.41,-10483.09 11300.79,-10479.96"/>
<polygon fill="black" stroke="black" points="11301.08,-10476.44 11290.58,-10477.84 11299.66,-10483.3 11301.08,-10476.44"/>
<text text-anchor="middle" x="12804.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_5 -->
<g id="node7" class="node">
<title>embed_5</title>
<ellipse fill="yellow" stroke="black" cx="11505.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11505.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11505.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11505.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_5 -->
<g id="edge6" class="edge">
<title>input_tensor&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M14575.39,-10557.04C14308.42,-10557.29 13605.81,-10554.4 13020.57,-10520.68 12949.27,-10516.58 12931.89,-10509.56 12860.57,-10505.68 12594.93,-10491.26 11927.66,-10519.8 11663.57,-10487.68 11648.33,-10485.83 11632.41,-10483.11 11616.79,-10479.97"/>
<polygon fill="black" stroke="black" points="11617.08,-10476.46 11606.58,-10477.86 11615.66,-10483.31 11617.08,-10476.46"/>
<text text-anchor="middle" x="13073.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_6 -->
<g id="node8" class="node">
<title>embed_6</title>
<ellipse fill="yellow" stroke="black" cx="11821.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11821.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11821.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11821.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_6 -->
<g id="edge7" class="edge">
<title>input_tensor&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M14575.36,-10556.01C14281.1,-10553.9 13481.52,-10545.94 13218.57,-10520.68 13178.64,-10516.85 13169.52,-10509.34 13129.57,-10505.68 12875.05,-10482.38 12233.28,-10518.62 11979.57,-10487.68 11964.33,-10485.82 11948.41,-10483.1 11932.79,-10479.96"/>
<polygon fill="black" stroke="black" points="11933.08,-10476.45 11922.58,-10477.85 11931.66,-10483.31 11933.08,-10476.45"/>
<text text-anchor="middle" x="13271.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_7 -->
<g id="node9" class="node">
<title>embed_7</title>
<ellipse fill="yellow" stroke="black" cx="12137.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12137.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12137.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12137.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_7 -->
<g id="edge8" class="edge">
<title>input_tensor&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M14575.3,-10557.08C14304.13,-10557.51 13610.29,-10555.08 13381.57,-10520.68 13356.94,-10516.98 13352.22,-10509.26 13327.57,-10505.68 13100.59,-10472.72 12523.23,-10515.65 12295.57,-10487.68 12280.33,-10485.81 12264.41,-10483.08 12248.79,-10479.94"/>
<polygon fill="black" stroke="black" points="12249.08,-10476.43 12238.58,-10477.82 12247.66,-10483.28 12249.08,-10476.43"/>
<text text-anchor="middle" x="13434.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_8 -->
<g id="node10" class="node">
<title>embed_8</title>
<ellipse fill="yellow" stroke="black" cx="12453.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12453.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12453.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12453.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_8 -->
<g id="edge9" class="edge">
<title>input_tensor&#45;&gt;embed_8</title>
<path fill="none" stroke="black" d="M14575.56,-10555.47C14306.18,-10552.19 13628.13,-10541.92 13527.57,-10520.68 13510.21,-10517.02 13507.95,-10509.26 13490.57,-10505.68 13299.2,-10466.33 12805.45,-10511.8 12611.57,-10487.68 12596.33,-10485.79 12580.41,-10483.04 12564.8,-10479.9"/>
<polygon fill="black" stroke="black" points="12565.09,-10476.38 12554.59,-10477.78 12563.67,-10483.24 12565.09,-10476.38"/>
<text text-anchor="middle" x="13580.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_9 -->
<g id="node11" class="node">
<title>embed_9</title>
<ellipse fill="yellow" stroke="black" cx="12769.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12769.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12769.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12769.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_9 -->
<g id="edge10" class="edge">
<title>input_tensor&#45;&gt;embed_9</title>
<path fill="none" stroke="black" d="M14575.44,-10555.62C14329.52,-10552.83 13750.52,-10543.87 13664.57,-10520.68 13650.94,-10517.01 13650.22,-10509.29 13636.57,-10505.68 13560.39,-10485.53 13005.75,-10497.6 12927.57,-10487.68 12912.45,-10485.77 12896.66,-10483.03 12881.16,-10479.9"/>
<polygon fill="black" stroke="black" points="12881.52,-10476.4 12871.02,-10477.79 12880.1,-10483.25 12881.52,-10476.4"/>
<text text-anchor="middle" x="13717.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_10 -->
<g id="node12" class="node">
<title>embed_10</title>
<ellipse fill="yellow" stroke="black" cx="13085.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13085.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13085.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="13085.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_10 -->
<g id="edge11" class="edge">
<title>input_tensor&#45;&gt;embed_10</title>
<path fill="none" stroke="black" d="M14575.38,-10555.62C14353.47,-10552.98 13867.7,-10544.54 13795.57,-10520.68 13784.34,-10516.97 13784.82,-10509.36 13773.57,-10505.68 13661.57,-10469.04 13360.42,-10503.02 13243.57,-10487.68 13228.58,-10485.72 13212.91,-10482.97 13197.53,-10479.85"/>
<polygon fill="black" stroke="black" points="13197.97,-10476.37 13187.46,-10477.75 13196.54,-10483.22 13197.97,-10476.37"/>
<text text-anchor="middle" x="13848.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_11 -->
<g id="node13" class="node">
<title>embed_11</title>
<ellipse fill="yellow" stroke="black" cx="13401.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13401.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13401.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="13401.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_11 -->
<g id="edge12" class="edge">
<title>input_tensor&#45;&gt;embed_11</title>
<path fill="none" stroke="black" d="M14575.38,-10557.56C14396.03,-10557.97 14049.19,-10554.17 13931.57,-10520.68 13918.37,-10516.92 13917.77,-10509.47 13904.57,-10505.68 13830.78,-10484.5 13635.6,-10498.36 13559.57,-10487.68 13544.71,-10485.6 13529.18,-10482.79 13513.91,-10479.67"/>
<polygon fill="black" stroke="black" points="13514.43,-10476.2 13503.93,-10477.57 13512.99,-10483.05 13514.43,-10476.2"/>
<text text-anchor="middle" x="13984.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_12 -->
<g id="node14" class="node">
<title>embed_12</title>
<ellipse fill="yellow" stroke="black" cx="13717.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13717.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13717.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13717.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_12 -->
<g id="edge13" class="edge">
<title>input_tensor&#45;&gt;embed_12</title>
<path fill="none" stroke="black" d="M14575.17,-10549.69C14474.6,-10543.08 14322.01,-10532.45 14189.57,-10520.68 14154.63,-10517.58 13910.17,-10493.48 13875.57,-10487.68 13861.36,-10485.3 13846.51,-10482.42 13831.86,-10479.32"/>
<polygon fill="black" stroke="black" points="13832.26,-10475.83 13821.75,-10477.15 13830.79,-10482.67 13832.26,-10475.83"/>
<text text-anchor="middle" x="14242.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_13 -->
<g id="node15" class="node">
<title>embed_13</title>
<ellipse fill="yellow" stroke="black" cx="14033.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14033.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14033.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="14033.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_13 -->
<g id="edge14" class="edge">
<title>input_tensor&#45;&gt;embed_13</title>
<path fill="none" stroke="black" d="M14575.18,-10544.46C14474.73,-10532.58 14322.57,-10512.69 14191.57,-10487.68 14177.76,-10485.05 14163.31,-10482.05 14149.01,-10478.93"/>
<polygon fill="black" stroke="black" points="14149.67,-10475.49 14139.15,-10476.75 14148.16,-10482.32 14149.67,-10475.49"/>
<text text-anchor="middle" x="14433.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_14 -->
<g id="node16" class="node">
<title>embed_14</title>
<ellipse fill="yellow" stroke="black" cx="14349.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14349.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14349.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="14349.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_14 -->
<g id="edge15" class="edge">
<title>input_tensor&#45;&gt;embed_14</title>
<path fill="none" stroke="black" d="M14625.28,-10538.65C14606.46,-10532.97 14585.64,-10526.62 14566.57,-10520.68 14528.09,-10508.7 14485.86,-10495.25 14448.97,-10483.39"/>
<polygon fill="black" stroke="black" points="14449.8,-10479.98 14439.21,-10480.25 14447.66,-10486.65 14449.8,-10479.98"/>
<text text-anchor="middle" x="14619.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_15 -->
<g id="node17" class="node">
<title>embed_15</title>
<ellipse fill="yellow" stroke="black" cx="14665.57" cy="-10450.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14665.57" y="-10461.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14665.57" y="-10446.48" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14665.57" y="-10431.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_15 -->
<g id="edge16" class="edge">
<title>input_tensor&#45;&gt;embed_15</title>
<path fill="none" stroke="black" d="M14682.09,-10538.31C14679.96,-10527.1 14677.14,-10512.22 14674.44,-10497.93"/>
<polygon fill="black" stroke="black" points="14677.8,-10496.87 14672.49,-10487.69 14670.92,-10498.17 14677.8,-10496.87"/>
<text text-anchor="middle" x="14730.07" y="-10509.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- residual_0 -->
<g id="node51" class="node">
<title>residual_0</title>
<ellipse fill="lightgreen" stroke="black" cx="14977.57" cy="-8681.64" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="14977.57" y="-8692.94" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14977.57" y="-8677.94" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="14977.57" y="-8662.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge49" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14685.07,-10538.62C14740.65,-10521.37 14842.57,-10491.95 14842.57,-10451.18 14842.57,-10451.18 14842.57,-10451.18 14842.57,-8808.14 14842.57,-8777.2 14842.57,-8741.98 14865.61,-8716.74"/>
<polygon fill="black" stroke="black" points="14868.3,-8719 14873.12,-8709.57 14863.47,-8713.94 14868.3,-8719"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge50" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14699.36,-10538.62C14758.65,-10521.37 14860.57,-10491.95 14860.57,-10451.18 14860.57,-10451.18 14860.57,-10451.18 14860.57,-8808.14 14860.57,-8778.35 14860.57,-8744.59 14878.39,-8719.59"/>
<polygon fill="black" stroke="black" points="14881.16,-8721.74 14884.82,-8711.8 14875.76,-8717.28 14881.16,-8721.74"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge51" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14713.65,-10538.62C14776.65,-10521.37 14878.57,-10491.95 14878.57,-10451.18 14878.57,-10451.18 14878.57,-10451.18 14878.57,-8808.14 14878.57,-8779.51 14878.57,-8747.22 14891.95,-8722.56"/>
<polygon fill="black" stroke="black" points="14895.09,-8724.15 14897.51,-8713.84 14889.18,-8720.39 14895.09,-8724.15"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge52" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14727.94,-10538.62C14794.65,-10521.37 14896.57,-10491.95 14896.57,-10451.18 14896.57,-10451.18 14896.57,-10451.18 14896.57,-8808.14 14896.57,-8780.44 14896.57,-8749.3 14906.49,-8724.97"/>
<polygon fill="black" stroke="black" points="14909.79,-8726.19 14910.99,-8715.67 14903.49,-8723.15 14909.79,-8726.19"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge53" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14742.22,-10538.62C14812.65,-10521.37 14914.57,-10491.95 14914.57,-10451.18 14914.57,-10451.18 14914.57,-10451.18 14914.57,-8808.14 14914.57,-8781.04 14914.57,-8750.65 14921.8,-8726.57"/>
<polygon fill="black" stroke="black" points="14925.15,-8727.59 14925.21,-8716.99 14918.55,-8725.24 14925.15,-8727.59"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge54" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14756.51,-10538.62C14830.65,-10521.37 14932.57,-10491.95 14932.57,-10451.18 14932.57,-10451.18 14932.57,-10451.18 14932.57,-8808.14 14932.57,-8781.54 14932.57,-8751.78 14937.45,-8727.91"/>
<polygon fill="black" stroke="black" points="14940.88,-8728.61 14939.85,-8718.07 14934.08,-8726.95 14940.88,-8728.61"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge55" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14770.8,-10538.62C14848.65,-10521.37 14950.57,-10491.95 14950.57,-10451.18 14950.57,-10451.18 14950.57,-10451.18 14950.57,-8808.14 14950.57,-8781.95 14950.57,-8752.68 14953.37,-8729"/>
<polygon fill="black" stroke="black" points="14956.86,-8729.28 14954.8,-8718.88 14949.93,-8728.29 14956.86,-8729.28"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge56" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14785.09,-10538.62C14866.65,-10521.37 14968.57,-10491.95 14968.57,-10451.18 14968.57,-10451.18 14968.57,-10451.18 14968.57,-8808.14 14968.57,-8782.04 14968.57,-8752.89 14969.5,-8729.26"/>
<polygon fill="black" stroke="black" points="14973,-8729.31 14969.97,-8719.16 14966,-8728.98 14973,-8729.31"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge57" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.58,-10539.38C14881.59,-10522.24 14986.57,-10492.55 14986.57,-10451.18 14986.57,-10451.18 14986.57,-10451.18 14986.57,-8808.14 14986.57,-8782.04 14986.57,-8752.89 14985.65,-8729.26"/>
<polygon fill="black" stroke="black" points="14989.14,-8728.98 14985.18,-8719.16 14982.15,-8729.31 14989.14,-8728.98"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge58" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.79,-10541.96C14888.36,-10525.31 15004.57,-10494.71 15004.57,-10451.18 15004.57,-10451.18 15004.57,-10451.18 15004.57,-8808.14 15004.57,-8781.95 15004.57,-8752.68 15001.78,-8729"/>
<polygon fill="black" stroke="black" points="15005.21,-8728.29 15000.34,-8718.88 14998.28,-8729.28 15005.21,-8728.29"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge59" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.88,-10544.19C14895.32,-10528.12 15022.57,-10496.73 15022.57,-10451.18 15022.57,-10451.18 15022.57,-10451.18 15022.57,-8808.14 15022.57,-8781.54 15022.57,-8751.78 15017.7,-8727.91"/>
<polygon fill="black" stroke="black" points="15021.06,-8726.95 15015.29,-8718.07 15014.26,-8728.61 15021.06,-8726.95"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge60" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.83,-10546.11C14902.56,-10530.69 15040.57,-10498.62 15040.57,-10451.18 15040.57,-10451.18 15040.57,-10451.18 15040.57,-8808.14 15040.57,-8781.04 15040.57,-8750.65 15033.35,-8726.57"/>
<polygon fill="black" stroke="black" points="15036.59,-8725.24 15029.93,-8716.99 15030,-8727.59 15036.59,-8725.24"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge61" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.62,-10547.75C14910.18,-10533.04 15058.57,-10500.37 15058.57,-10451.18 15058.57,-10451.18 15058.57,-10451.18 15058.57,-8808.14 15058.57,-8780.44 15058.57,-8749.3 15048.65,-8724.97"/>
<polygon fill="black" stroke="black" points="15051.66,-8723.15 15044.16,-8715.67 15045.36,-8726.19 15051.66,-8723.15"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge62" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.74,-10549.09C14918.68,-10535.09 15076.57,-10501.92 15076.57,-10451.18 15076.57,-10451.18 15076.57,-10451.18 15076.57,-8808.14 15076.57,-8779.51 15076.57,-8747.22 15063.2,-8722.56"/>
<polygon fill="black" stroke="black" points="15065.96,-8720.39 15057.64,-8713.84 15060.06,-8724.15 15065.96,-8720.39"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge63" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.76,-10550.21C14927.75,-10536.92 15094.57,-10503.33 15094.57,-10451.18 15094.57,-10451.18 15094.57,-10451.18 15094.57,-8808.14 15094.57,-8778.35 15094.57,-8744.59 15076.76,-8719.59"/>
<polygon fill="black" stroke="black" points="15079.39,-8717.28 15070.32,-8711.8 15073.99,-8721.74 15079.39,-8717.28"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge64" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14795.75,-10551.16C14937.46,-10538.56 15112.57,-10504.61 15112.57,-10451.18 15112.57,-10451.18 15112.57,-10451.18 15112.57,-8808.14 15112.57,-8777.2 15112.57,-8741.98 15089.54,-8716.74"/>
<polygon fill="black" stroke="black" points="15091.68,-8713.94 15082.03,-8709.57 15086.85,-8719 15091.68,-8713.94"/>
</g>
<!-- ln1_0_0 -->
<g id="node52" class="node">
<title>ln1_0_0</title>
<ellipse fill="lightgreen" stroke="black" cx="5755.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="5755.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5755.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5755.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_0&#45;&gt;ln1_0_0 -->
<g id="edge65" class="edge">
<title>embed_0&#45;&gt;ln1_0_0</title>
<path fill="none" stroke="black" d="M9776.62,-10447.54C9298.13,-10441.92 7757.11,-10421.27 6482.57,-10375.68 6284.89,-10368.61 6057.15,-10356.54 5910.02,-10348.23"/>
<polygon fill="black" stroke="black" points="5910.19,-10344.73 5900.01,-10347.66 5909.8,-10351.72 5910.19,-10344.73"/>
</g>
<!-- ln1_0_1 -->
<g id="node53" class="node">
<title>ln1_0_1</title>
<ellipse fill="lightgreen" stroke="black" cx="6640.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="6640.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6640.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="6640.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_1&#45;&gt;ln1_0_1 -->
<g id="edge66" class="edge">
<title>embed_1&#45;&gt;ln1_0_1</title>
<path fill="none" stroke="black" d="M10153.47,-10419.93C10130.93,-10413.68 10106.57,-10407.97 10083.57,-10404.68 9753.47,-10357.46 7415.68,-10391.03 7082.57,-10375.68 6984.17,-10371.15 6873.73,-10362.03 6787.87,-10354.04"/>
<polygon fill="black" stroke="black" points="6788.07,-10350.55 6777.78,-10353.1 6787.41,-10357.52 6788.07,-10350.55"/>
</g>
<!-- ln1_0_2 -->
<g id="node54" class="node">
<title>ln1_0_2</title>
<ellipse fill="lightgreen" stroke="black" cx="7240.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="7240.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7240.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7240.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_2&#45;&gt;ln1_0_2 -->
<g id="edge67" class="edge">
<title>embed_2&#45;&gt;ln1_0_2</title>
<path fill="none" stroke="black" d="M10469.04,-10419.9C10446.62,-10413.69 10422.42,-10408.01 10399.57,-10404.68 10187.79,-10373.8 8687.54,-10380.46 8473.57,-10375.68 8087.24,-10367.06 7632.95,-10352.46 7398.43,-10344.59"/>
<polygon fill="black" stroke="black" points="7398.23,-10341.08 7388.12,-10344.24 7398,-10348.08 7398.23,-10341.08"/>
</g>
<!-- ln1_0_3 -->
<g id="node55" class="node">
<title>ln1_0_3</title>
<ellipse fill="lightgreen" stroke="black" cx="8631.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="8631.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8631.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="8631.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_3&#45;&gt;ln1_0_3 -->
<g id="edge68" class="edge">
<title>embed_3&#45;&gt;ln1_0_3</title>
<path fill="none" stroke="black" d="M10785.04,-10419.92C10762.62,-10413.72 10738.41,-10408.03 10715.57,-10404.68 10330.74,-10348.27 9353.75,-10400.06 8965.57,-10375.68 8902.01,-10371.69 8831.91,-10364.47 8772.41,-10357.49"/>
<polygon fill="black" stroke="black" points="8772.54,-10353.98 8762.2,-10356.28 8771.72,-10360.93 8772.54,-10353.98"/>
</g>
<!-- ln1_0_4 -->
<g id="node56" class="node">
<title>ln1_0_4</title>
<ellipse fill="lightgreen" stroke="black" cx="9123.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="9123.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9123.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="9123.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_4&#45;&gt;ln1_0_4 -->
<g id="edge69" class="edge">
<title>embed_4&#45;&gt;ln1_0_4</title>
<path fill="none" stroke="black" d="M11100.6,-10419.96C11078.3,-10413.79 11054.26,-10408.12 11031.57,-10404.68 10786.51,-10367.58 10164.27,-10384.6 9916.57,-10375.68 9695.21,-10367.71 9439.24,-10355.36 9279.36,-10347.28"/>
<polygon fill="black" stroke="black" points="9279.13,-10343.76 9268.97,-10346.75 9278.78,-10350.75 9279.13,-10343.76"/>
</g>
<!-- ln1_0_5 -->
<g id="node57" class="node">
<title>ln1_0_5</title>
<ellipse fill="lightgreen" stroke="black" cx="10074.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10074.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10074.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="10074.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_5&#45;&gt;ln1_0_5 -->
<g id="edge70" class="edge">
<title>embed_5&#45;&gt;ln1_0_5</title>
<path fill="none" stroke="black" d="M11416.14,-10420.13C11393.95,-10414 11370.08,-10408.3 11347.57,-10404.68 11058.11,-10358.19 10981.35,-10390.83 10688.57,-10375.68 10531.82,-10367.58 10352.64,-10356.74 10228.48,-10348.99"/>
<polygon fill="black" stroke="black" points="10228.34,-10345.48 10218.14,-10348.34 10227.9,-10352.46 10228.34,-10345.48"/>
</g>
<!-- ln1_0_6 -->
<g id="node58" class="node">
<title>ln1_0_6</title>
<ellipse fill="lightgreen" stroke="black" cx="10846.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10846.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10846.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10846.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_6&#45;&gt;ln1_0_6 -->
<g id="edge71" class="edge">
<title>embed_6&#45;&gt;ln1_0_6</title>
<path fill="none" stroke="black" d="M11731.24,-10420.27C11709.3,-10414.21 11685.76,-10408.51 11663.57,-10404.68 11474.38,-10372.04 11423.94,-10391.17 11232.57,-10375.68 11153.6,-10369.29 11065.64,-10361.06 10993.65,-10354.04"/>
<polygon fill="black" stroke="black" points="10993.9,-10350.54 10983.6,-10353.05 10993.22,-10357.51 10993.9,-10350.54"/>
</g>
<!-- ln1_0_7 -->
<g id="node59" class="node">
<title>ln1_0_7</title>
<ellipse fill="lightgreen" stroke="black" cx="11390.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11390.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11390.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11390.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_7&#45;&gt;ln1_0_7 -->
<g id="edge72" class="edge">
<title>embed_7&#45;&gt;ln1_0_7</title>
<path fill="none" stroke="black" d="M12046.34,-10420.42C12024.64,-10414.44 12001.43,-10408.73 11979.57,-10404.68 11840.46,-10378.95 11803.16,-10391.54 11662.57,-10375.68 11618.98,-10370.77 11571.56,-10364.67 11528.7,-10358.87"/>
<polygon fill="black" stroke="black" points="11529.15,-10355.4 11518.77,-10357.52 11528.21,-10362.33 11529.15,-10355.4"/>
</g>
<!-- ln1_0_8 -->
<g id="node60" class="node">
<title>ln1_0_8</title>
<ellipse fill="lightgreen" stroke="black" cx="11820.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11820.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11820.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="11820.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_8&#45;&gt;ln1_0_8 -->
<g id="edge73" class="edge">
<title>embed_8&#45;&gt;ln1_0_8</title>
<path fill="none" stroke="black" d="M12361.45,-10420.51C12339.99,-10414.59 12317.11,-10408.89 12295.57,-10404.68 12181.46,-10382.4 12150.71,-10391.87 12035.57,-10375.68 12007.82,-10371.78 11978.14,-10367.09 11949.97,-10362.38"/>
<polygon fill="black" stroke="black" points="11950.52,-10358.92 11940.08,-10360.72 11949.36,-10365.83 11950.52,-10358.92"/>
</g>
<!-- ln1_0_9 -->
<g id="node61" class="node">
<title>ln1_0_9</title>
<ellipse fill="lightgreen" stroke="black" cx="12193.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12193.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12193.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12193.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_9&#45;&gt;ln1_0_9 -->
<g id="edge74" class="edge">
<title>embed_9&#45;&gt;ln1_0_9</title>
<path fill="none" stroke="black" d="M12676.96,-10420.73C12655.62,-10414.83 12632.92,-10409.09 12611.57,-10404.68 12515.85,-10384.94 12490.12,-10390.91 12393.57,-10375.68 12369.9,-10371.95 12344.72,-10367.63 12320.49,-10363.3"/>
<polygon fill="black" stroke="black" points="12321,-10359.83 12310.54,-10361.51 12319.76,-10366.72 12321,-10359.83"/>
</g>
<!-- ln1_0_10 -->
<g id="node62" class="node">
<title>ln1_0_10</title>
<ellipse fill="lightgreen" stroke="black" cx="12551.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12551.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12551.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12551.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_10&#45;&gt;ln1_0_10 -->
<g id="edge75" class="edge">
<title>embed_10&#45;&gt;ln1_0_10</title>
<path fill="none" stroke="black" d="M12992.06,-10420.8C12970.97,-10414.97 12948.6,-10409.23 12927.57,-10404.68 12844.08,-10386.63 12821.73,-10390.36 12737.57,-10375.68 12717.65,-10372.21 12696.58,-10368.3 12676.06,-10364.37"/>
<polygon fill="black" stroke="black" points="12676.51,-10360.89 12666.03,-10362.43 12675.19,-10367.76 12676.51,-10360.89"/>
</g>
<!-- ln1_0_11 -->
<g id="node63" class="node">
<title>ln1_0_11</title>
<ellipse fill="lightgreen" stroke="black" cx="12895.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12895.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12895.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12895.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_11&#45;&gt;ln1_0_11 -->
<g id="edge76" class="edge">
<title>embed_11&#45;&gt;ln1_0_11</title>
<path fill="none" stroke="black" d="M13308.02,-10420.98C13286.93,-10415.14 13264.58,-10409.36 13243.57,-10404.68 13166.19,-10387.47 13145.48,-10390.36 13067.57,-10375.68 13050.9,-10372.54 13033.35,-10369.04 13016.1,-10365.49"/>
<polygon fill="black" stroke="black" points="13016.49,-10362 13005.99,-10363.4 13015.07,-10368.85 13016.49,-10362"/>
</g>
<!-- ln1_0_12 -->
<g id="node64" class="node">
<title>ln1_0_12</title>
<ellipse fill="lightgreen" stroke="black" cx="13225.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13225.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13225.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13225.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_12&#45;&gt;ln1_0_12 -->
<g id="edge77" class="edge">
<title>embed_12&#45;&gt;ln1_0_12</title>
<path fill="none" stroke="black" d="M13622.65,-10421.11C13601.94,-10415.36 13580.09,-10409.58 13559.57,-10404.68 13492.74,-10388.75 13417.71,-10373.77 13355.72,-10362.18"/>
<polygon fill="black" stroke="black" points="13356.36,-10358.74 13345.89,-10360.34 13355.08,-10365.62 13356.36,-10358.74"/>
</g>
<!-- ln1_0_13 -->
<g id="node65" class="node">
<title>ln1_0_13</title>
<ellipse fill="lightgreen" stroke="black" cx="13712.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13712.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13712.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13712.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_13&#45;&gt;ln1_0_13 -->
<g id="edge78" class="edge">
<title>embed_13&#45;&gt;ln1_0_13</title>
<path fill="none" stroke="black" d="M13947.13,-10419.56C13904.31,-10404.89 13852.49,-10387.13 13808.45,-10372.04"/>
<polygon fill="black" stroke="black" points="13809.49,-10368.69 13798.89,-10368.76 13807.22,-10375.32 13809.49,-10368.69"/>
</g>
<!-- ln1_0_14 -->
<g id="node66" class="node">
<title>ln1_0_14</title>
<ellipse fill="lightgreen" stroke="black" cx="14173.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14173.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14173.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="14173.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_14&#45;&gt;ln1_0_14 -->
<g id="edge79" class="edge">
<title>embed_14&#45;&gt;ln1_0_14</title>
<path fill="none" stroke="black" d="M14294.85,-10414.98C14276.39,-10403.44 14255.63,-10390.47 14236.58,-10378.56"/>
<polygon fill="black" stroke="black" points="14238.29,-10375.51 14227.96,-10373.18 14234.58,-10381.44 14238.29,-10375.51"/>
</g>
<!-- ln1_0_15 -->
<g id="node67" class="node">
<title>ln1_0_15</title>
<ellipse fill="lightgreen" stroke="black" cx="14595.57" cy="-10338.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14595.57" y="-10349.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14595.57" y="-10334.48" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14595.57" y="-10319.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_15&#45;&gt;ln1_0_15 -->
<g id="edge80" class="edge">
<title>embed_15&#45;&gt;ln1_0_15</title>
<path fill="none" stroke="black" d="M14642.46,-10412.86C14636.6,-10403.66 14630.25,-10393.67 14624.16,-10384.1"/>
<polygon fill="black" stroke="black" points="14626.99,-10382.03 14618.66,-10375.47 14621.08,-10385.78 14626.99,-10382.03"/>
</g>
<!-- final_ln_0 -->
<g id="node18" class="node">
<title>final_ln_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13219.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13219.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="13219.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13219.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_0 -->
<g id="node19" class="node">
<title>output_proj_final_0</title>
<ellipse fill="yellow" stroke="black" cx="13194.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="13194.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13194.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13194.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13194.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_0&#45;&gt;output_proj_final_0 -->
<g id="edge17" class="edge">
<title>final_ln_0&#45;&gt;output_proj_final_0</title>
<path fill="none" stroke="black" d="M13212,-224.16C13210.23,-215.61 13208.3,-206.3 13206.39,-197.09"/>
<polygon fill="black" stroke="black" points="13209.79,-196.25 13204.34,-187.17 13202.94,-197.68 13209.79,-196.25"/>
</g>
<!-- final_output -->
<g id="node50" class="node">
<title>final_output</title>
<polygon fill="lightblue" stroke="black" points="16237.57,-54 16001.57,-54 16001.57,-16 16237.57,-16 16237.57,-54"/>
<text text-anchor="middle" x="16119.57" y="-38.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="16119.57" y="-23.8" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size]</text>
</g>
<!-- output_proj_final_0&#45;&gt;final_output -->
<g id="edge33" class="edge">
<title>output_proj_final_0&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M13320.78,-103.65C13343.53,-98.58 13367.14,-94.05 13389.57,-91 13643.38,-56.54 13709.51,-78.36 13965.57,-72 14734.14,-52.9 15657.23,-41.26 15991.16,-37.42"/>
<polygon fill="black" stroke="black" points="15991.39,-40.92 16001.35,-37.3 15991.31,-33.92 15991.39,-40.92"/>
</g>
<!-- final_ln_1 -->
<g id="node20" class="node">
<title>final_ln_1</title>
<ellipse fill="lightgreen" stroke="black" cx="13794.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13794.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="13794.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13794.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_1 -->
<g id="node21" class="node">
<title>output_proj_final_1</title>
<ellipse fill="yellow" stroke="black" cx="13584.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="13584.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13584.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13584.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13584.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_1&#45;&gt;output_proj_final_1 -->
<g id="edge18" class="edge">
<title>final_ln_1&#45;&gt;output_proj_final_1</title>
<path fill="none" stroke="black" d="M13736.08,-227.08C13715.18,-215.08 13691.21,-201.32 13668.6,-188.33"/>
<polygon fill="black" stroke="black" points="13670.09,-185.15 13659.67,-183.21 13666.6,-191.22 13670.09,-185.15"/>
</g>
<!-- output_proj_final_1&#45;&gt;final_output -->
<g id="edge34" class="edge">
<title>output_proj_final_1&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M13710.78,-103.64C13733.53,-98.57 13757.14,-94.04 13779.57,-91 14036.47,-56.17 14103.42,-78.88 14362.57,-72 14972.19,-55.82 15700.95,-42.96 15991.17,-38.1"/>
<polygon fill="black" stroke="black" points="15991.37,-41.6 16001.31,-37.93 15991.25,-34.6 15991.37,-41.6"/>
</g>
<!-- final_ln_2 -->
<g id="node22" class="node">
<title>final_ln_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14239.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14239.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14239.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14239.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_2 -->
<g id="node23" class="node">
<title>output_proj_final_2</title>
<ellipse fill="yellow" stroke="black" cx="13974.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="13974.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13974.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13974.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13974.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_2&#45;&gt;output_proj_final_2 -->
<g id="edge19" class="edge">
<title>final_ln_2&#45;&gt;output_proj_final_2</title>
<path fill="none" stroke="black" d="M14168.91,-228.51C14139.88,-215.3 14105.75,-199.77 14074.26,-185.44"/>
<polygon fill="black" stroke="black" points="14075.57,-182.19 14065.02,-181.24 14072.67,-188.57 14075.57,-182.19"/>
</g>
<!-- output_proj_final_2&#45;&gt;final_output -->
<g id="edge35" class="edge">
<title>output_proj_final_2&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14100.52,-103.69C14123.35,-98.6 14147.05,-94.05 14169.57,-91 14523.15,-43.15 15615.69,-36.81 15991.24,-36.06"/>
<polygon fill="black" stroke="black" points="15991.34,-39.56 16001.33,-36.04 15991.33,-32.56 15991.34,-39.56"/>
</g>
<!-- final_ln_3 -->
<g id="node24" class="node">
<title>final_ln_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14620.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14620.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14620.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14620.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_3 -->
<g id="node25" class="node">
<title>output_proj_final_3</title>
<ellipse fill="yellow" stroke="black" cx="14364.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="14364.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14364.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14364.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14364.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_3&#45;&gt;output_proj_final_3 -->
<g id="edge20" class="edge">
<title>final_ln_3&#45;&gt;output_proj_final_3</title>
<path fill="none" stroke="black" d="M14551.97,-228.35C14524.32,-215.33 14491.92,-200.07 14461.91,-185.93"/>
<polygon fill="black" stroke="black" points="14463.22,-182.68 14452.68,-181.58 14460.23,-189.01 14463.22,-182.68"/>
</g>
<!-- output_proj_final_3&#45;&gt;final_output -->
<g id="edge36" class="edge">
<title>output_proj_final_3&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14490.79,-103.69C14513.53,-98.62 14537.15,-94.07 14559.57,-91 14834.73,-53.32 15669.27,-40.72 15991.09,-37.19"/>
<polygon fill="black" stroke="black" points="15991.43,-40.69 16001.39,-37.08 15991.35,-33.69 15991.43,-40.69"/>
</g>
<!-- final_ln_4 -->
<g id="node26" class="node">
<title>final_ln_4</title>
<ellipse fill="lightgreen" stroke="black" cx="14968.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14968.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14968.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14968.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_4 -->
<g id="node27" class="node">
<title>output_proj_final_4</title>
<ellipse fill="yellow" stroke="black" cx="14754.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="14754.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14754.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14754.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14754.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_4&#45;&gt;output_proj_final_4 -->
<g id="edge21" class="edge">
<title>final_ln_4&#45;&gt;output_proj_final_4</title>
<path fill="none" stroke="black" d="M14909.25,-227.24C14887.75,-215.12 14863.02,-201.19 14839.74,-188.07"/>
<polygon fill="black" stroke="black" points="14841.33,-184.95 14830.9,-183.09 14837.89,-191.05 14841.33,-184.95"/>
</g>
<!-- output_proj_final_4&#45;&gt;final_output -->
<g id="edge37" class="edge">
<title>output_proj_final_4&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14881.34,-103.8C14903.93,-98.74 14927.34,-94.18 14949.57,-91 15147.23,-62.75 15730.11,-45.48 15990.9,-38.96"/>
<polygon fill="black" stroke="black" points="15991.27,-42.46 16001.18,-38.71 15991.1,-35.46 15991.27,-42.46"/>
</g>
<!-- final_ln_5 -->
<g id="node28" class="node">
<title>final_ln_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15300.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15300.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="15300.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15300.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_5 -->
<g id="node29" class="node">
<title>output_proj_final_5</title>
<ellipse fill="yellow" stroke="black" cx="15144.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="15144.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15144.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15144.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15144.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_5&#45;&gt;output_proj_final_5 -->
<g id="edge22" class="edge">
<title>final_ln_5&#45;&gt;output_proj_final_5</title>
<path fill="none" stroke="black" d="M15255.45,-225.79C15241.56,-215.05 15225.96,-202.99 15210.95,-191.39"/>
<polygon fill="black" stroke="black" points="15212.74,-188.35 15202.68,-185 15208.46,-193.89 15212.74,-188.35"/>
</g>
<!-- output_proj_final_5&#45;&gt;final_output -->
<g id="edge38" class="edge">
<title>output_proj_final_5&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M15272.2,-104.05C15294.53,-99.02 15317.63,-94.4 15339.57,-91 15567.33,-55.73 15836.05,-43.05 15991.23,-38.51"/>
<polygon fill="black" stroke="black" points="15991.39,-42.01 16001.28,-38.22 15991.19,-35.01 15991.39,-42.01"/>
</g>
<!-- final_ln_6 -->
<g id="node30" class="node">
<title>final_ln_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15624.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15624.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="15624.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15624.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_6 -->
<g id="node31" class="node">
<title>output_proj_final_6</title>
<ellipse fill="yellow" stroke="black" cx="15534.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="15534.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15534.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15534.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15534.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_6&#45;&gt;output_proj_final_6 -->
<g id="edge23" class="edge">
<title>final_ln_6&#45;&gt;output_proj_final_6</title>
<path fill="none" stroke="black" d="M15597.57,-224.49C15590.54,-215.07 15582.82,-204.72 15575.25,-194.58"/>
<polygon fill="black" stroke="black" points="15578.02,-192.45 15569.24,-186.53 15572.41,-196.63 15578.02,-192.45"/>
</g>
<!-- output_proj_final_6&#45;&gt;final_output -->
<g id="edge39" class="edge">
<title>output_proj_final_6&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M15665.05,-104.74C15686.53,-99.78 15708.62,-95 15729.57,-91 15816.35,-74.44 15914.88,-60.59 15991.18,-50.93"/>
<polygon fill="black" stroke="black" points="15991.84,-54.37 16001.33,-49.65 15990.97,-47.43 15991.84,-54.37"/>
</g>
<!-- final_ln_7 -->
<g id="node32" class="node">
<title>final_ln_7</title>
<ellipse fill="lightgreen" stroke="black" cx="15943.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15943.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="15943.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15943.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_7 -->
<g id="node33" class="node">
<title>output_proj_final_7</title>
<ellipse fill="yellow" stroke="black" cx="15924.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="15924.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15924.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15924.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15924.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_7&#45;&gt;output_proj_final_7 -->
<g id="edge24" class="edge">
<title>final_ln_7&#45;&gt;output_proj_final_7</title>
<path fill="none" stroke="black" d="M15937.82,-224.16C15936.47,-215.61 15935.01,-206.3 15933.56,-197.09"/>
<polygon fill="black" stroke="black" points="15937.01,-196.51 15931.99,-187.17 15930.09,-197.6 15937.01,-196.51"/>
</g>
<!-- output_proj_final_7&#45;&gt;final_output -->
<g id="edge40" class="edge">
<title>output_proj_final_7&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16005.58,-95.68C16029.64,-83.08 16055.09,-69.76 16075.82,-58.91"/>
<polygon fill="black" stroke="black" points="16077.45,-62 16084.69,-54.26 16074.21,-55.8 16077.45,-62"/>
</g>
<!-- final_ln_8 -->
<g id="node34" class="node">
<title>final_ln_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16296.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16296.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="16296.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16296.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_8 -->
<g id="node35" class="node">
<title>output_proj_final_8</title>
<ellipse fill="yellow" stroke="black" cx="16314.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="16314.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16314.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16314.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16314.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_8&#45;&gt;output_proj_final_8 -->
<g id="edge25" class="edge">
<title>final_ln_8&#45;&gt;output_proj_final_8</title>
<path fill="none" stroke="black" d="M16302.02,-224.16C16303.3,-215.61 16304.69,-206.3 16306.06,-197.09"/>
<polygon fill="black" stroke="black" points="16309.53,-197.58 16307.54,-187.17 16302.61,-196.55 16309.53,-197.58"/>
</g>
<!-- output_proj_final_8&#45;&gt;final_output -->
<g id="edge41" class="edge">
<title>output_proj_final_8&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16233.57,-95.68C16209.51,-83.08 16184.06,-69.76 16163.33,-58.91"/>
<polygon fill="black" stroke="black" points="16164.94,-55.8 16154.46,-54.26 16161.69,-62 16164.94,-55.8"/>
</g>
<!-- final_ln_9 -->
<g id="node36" class="node">
<title>final_ln_9</title>
<ellipse fill="lightgreen" stroke="black" cx="16667.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16667.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="16667.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16667.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_9 -->
<g id="node37" class="node">
<title>output_proj_final_9</title>
<ellipse fill="yellow" stroke="black" cx="16704.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="16704.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16704.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16704.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16704.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_9&#45;&gt;output_proj_final_9 -->
<g id="edge26" class="edge">
<title>final_ln_9&#45;&gt;output_proj_final_9</title>
<path fill="none" stroke="black" d="M16678.78,-224.16C16681.43,-215.52 16684.32,-206.1 16687.17,-196.79"/>
<polygon fill="black" stroke="black" points="16690.54,-197.76 16690.12,-187.17 16683.84,-195.71 16690.54,-197.76"/>
</g>
<!-- output_proj_final_9&#45;&gt;final_output -->
<g id="edge42" class="edge">
<title>output_proj_final_9&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16574.1,-104.74C16552.62,-99.78 16530.53,-95 16509.57,-91 16422.79,-74.44 16324.27,-60.59 16247.96,-50.93"/>
<polygon fill="black" stroke="black" points="16248.18,-47.43 16237.82,-49.65 16247.31,-54.37 16248.18,-47.43"/>
</g>
<!-- final_ln_10 -->
<g id="node38" class="node">
<title>final_ln_10</title>
<ellipse fill="lightgreen" stroke="black" cx="17041.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17041.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="17041.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17041.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_10 -->
<g id="node39" class="node">
<title>output_proj_final_10</title>
<ellipse fill="yellow" stroke="black" cx="17094.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="17094.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17094.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17094.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17094.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_10&#45;&gt;output_proj_final_10 -->
<g id="edge27" class="edge">
<title>final_ln_10&#45;&gt;output_proj_final_10</title>
<path fill="none" stroke="black" d="M17057.62,-224.16C17061.46,-215.43 17065.65,-205.9 17069.78,-196.5"/>
<polygon fill="black" stroke="black" points="17073.06,-197.74 17073.88,-187.17 17066.65,-194.92 17073.06,-197.74"/>
</g>
<!-- output_proj_final_10&#45;&gt;final_output -->
<g id="edge43" class="edge">
<title>output_proj_final_10&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16966.95,-104.05C16944.62,-99.02 16921.51,-94.4 16899.57,-91 16671.82,-55.73 16403.1,-43.05 16247.92,-38.51"/>
<polygon fill="black" stroke="black" points="16247.96,-35.01 16237.86,-38.22 16247.76,-42.01 16247.96,-35.01"/>
</g>
<!-- final_ln_11 -->
<g id="node40" class="node">
<title>final_ln_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17386.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17386.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="17386.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17386.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_11 -->
<g id="node41" class="node">
<title>output_proj_final_11</title>
<ellipse fill="yellow" stroke="black" cx="17484.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="17484.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17484.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17484.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17484.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_11&#45;&gt;output_proj_final_11 -->
<g id="edge28" class="edge">
<title>final_ln_11&#45;&gt;output_proj_final_11</title>
<path fill="none" stroke="black" d="M17415.71,-224.81C17423.53,-215.19 17432.17,-204.56 17440.61,-194.18"/>
<polygon fill="black" stroke="black" points="17443.41,-196.28 17447,-186.31 17437.98,-191.87 17443.41,-196.28"/>
</g>
<!-- output_proj_final_11&#45;&gt;final_output -->
<g id="edge44" class="edge">
<title>output_proj_final_11&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M17357.8,-103.8C17335.22,-98.74 17311.81,-94.18 17289.57,-91 17091.92,-62.75 16509.03,-45.48 16248.24,-38.96"/>
<polygon fill="black" stroke="black" points="16248.05,-35.46 16237.97,-38.71 16247.87,-42.46 16248.05,-35.46"/>
</g>
<!-- final_ln_12 -->
<g id="node42" class="node">
<title>final_ln_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17717.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17717.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="17717.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17717.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_12 -->
<g id="node43" class="node">
<title>output_proj_final_12</title>
<ellipse fill="yellow" stroke="black" cx="17874.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="17874.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17874.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17874.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17874.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_12&#45;&gt;output_proj_final_12 -->
<g id="edge29" class="edge">
<title>final_ln_12&#45;&gt;output_proj_final_12</title>
<path fill="none" stroke="black" d="M17762.98,-225.79C17777.17,-214.89 17793.13,-202.64 17808.44,-190.88"/>
<polygon fill="black" stroke="black" points="17810.58,-193.65 17816.38,-184.78 17806.31,-188.1 17810.58,-193.65"/>
</g>
<!-- output_proj_final_12&#45;&gt;final_output -->
<g id="edge45" class="edge">
<title>output_proj_final_12&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M17748.36,-103.69C17725.61,-98.62 17702,-94.07 17679.57,-91 17404.42,-53.32 16569.88,-40.72 16248.06,-37.19"/>
<polygon fill="black" stroke="black" points="16247.79,-33.69 16237.76,-37.08 16247.72,-40.69 16247.79,-33.69"/>
</g>
<!-- final_ln_13 -->
<g id="node44" class="node">
<title>final_ln_13</title>
<ellipse fill="lightgreen" stroke="black" cx="18040.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18040.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="18040.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18040.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_13 -->
<g id="node45" class="node">
<title>output_proj_final_13</title>
<ellipse fill="yellow" stroke="black" cx="18264.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="18264.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18264.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18264.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18264.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_13&#45;&gt;output_proj_final_13 -->
<g id="edge30" class="edge">
<title>final_ln_13&#45;&gt;output_proj_final_13</title>
<path fill="none" stroke="black" d="M18102.38,-227.4C18125.21,-215.1 18151.56,-200.92 18176.29,-187.61"/>
<polygon fill="black" stroke="black" points="18178.17,-190.57 18185.32,-182.75 18174.85,-184.41 18178.17,-190.57"/>
</g>
<!-- output_proj_final_13&#45;&gt;final_output -->
<g id="edge46" class="edge">
<title>output_proj_final_13&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M18138.63,-103.69C18115.8,-98.6 18092.09,-94.05 18069.57,-91 17715.99,-43.15 16623.45,-36.81 16247.91,-36.06"/>
<polygon fill="black" stroke="black" points="16247.82,-32.56 16237.81,-36.04 16247.81,-39.56 16247.82,-32.56"/>
</g>
<!-- final_ln_14 -->
<g id="node46" class="node">
<title>final_ln_14</title>
<ellipse fill="lightgreen" stroke="black" cx="18360.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18360.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="18360.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18360.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_14 -->
<g id="node47" class="node">
<title>output_proj_final_14</title>
<ellipse fill="yellow" stroke="black" cx="18654.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="18654.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18654.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18654.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18654.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_14&#45;&gt;output_proj_final_14 -->
<g id="edge31" class="edge">
<title>final_ln_14&#45;&gt;output_proj_final_14</title>
<path fill="none" stroke="black" d="M18437.05,-229.3C18470.71,-215.5 18510.83,-199.04 18547.4,-184.04"/>
<polygon fill="black" stroke="black" points="18549.18,-187.09 18557.11,-180.06 18546.53,-180.62 18549.18,-187.09"/>
</g>
<!-- output_proj_final_14&#45;&gt;final_output -->
<g id="edge47" class="edge">
<title>output_proj_final_14&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M18528.36,-103.64C18505.62,-98.57 18482.01,-94.04 18459.57,-91 18202.67,-56.17 18135.73,-78.88 17876.57,-72 17266.96,-55.82 16538.19,-42.96 16247.97,-38.1"/>
<polygon fill="black" stroke="black" points="16247.89,-34.6 16237.83,-37.93 16247.77,-41.6 16247.89,-34.6"/>
</g>
<!-- final_ln_15 -->
<g id="node48" class="node">
<title>final_ln_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18678.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18678.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="18678.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18678.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_15 -->
<g id="node49" class="node">
<title>output_proj_final_15</title>
<ellipse fill="yellow" stroke="black" cx="19044.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="19044.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="19044.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="19044.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19044.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_15&#45;&gt;output_proj_final_15 -->
<g id="edge32" class="edge">
<title>final_ln_15&#45;&gt;output_proj_final_15</title>
<path fill="none" stroke="black" d="M18767.17,-231.48C18813.58,-216.19 18871.14,-197.22 18921.78,-180.54"/>
<polygon fill="black" stroke="black" points="18923.08,-183.8 18931.48,-177.34 18920.89,-177.15 18923.08,-183.8"/>
</g>
<!-- output_proj_final_15&#45;&gt;final_output -->
<g id="edge48" class="edge">
<title>output_proj_final_15&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M18918.91,-103.61C18896,-98.51 18872.19,-93.97 18849.57,-91 18509.29,-46.25 18420.71,-79.38 18077.57,-72 17387.4,-57.16 16560.31,-43.21 16247.66,-38.08"/>
<polygon fill="black" stroke="black" points="16247.71,-34.58 16237.66,-37.92 16247.6,-41.58 16247.71,-34.58"/>
</g>
<!-- ln2_0_0 -->
<g id="node289" class="node">
<title>ln2_0_0</title>
<ellipse fill="lightgreen" stroke="black" cx="12607.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12607.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12607.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12607.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_0 -->
<g id="edge350" class="edge">
<title>residual_0&#45;&gt;ln2_0_0</title>
<path fill="none" stroke="black" d="M14823.79,-8676.04C14524.39,-8667.01 13842.26,-8646.12 13268.57,-8626.14 13044.99,-8618.35 12987.33,-8636.67 12765.57,-8607.14 12750.58,-8605.14 12734.92,-8602.37 12719.53,-8599.25"/>
<polygon fill="black" stroke="black" points="12719.98,-8595.77 12709.47,-8597.15 12718.54,-8602.62 12719.98,-8595.77"/>
</g>
<!-- ln2_0_1 -->
<g id="node290" class="node">
<title>ln2_0_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12923.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12923.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12923.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12923.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_1 -->
<g id="edge351" class="edge">
<title>residual_0&#45;&gt;ln2_0_1</title>
<path fill="none" stroke="black" d="M14822.37,-8678.39C14431.97,-8672.12 13416.45,-8651.9 13081.57,-8607.14 13066.58,-8605.13 13050.92,-8602.36 13035.53,-8599.24"/>
<polygon fill="black" stroke="black" points="13035.98,-8595.75 13025.47,-8597.13 13034.55,-8602.6 13035.98,-8595.75"/>
</g>
<!-- ln2_0_2 -->
<g id="node291" class="node">
<title>ln2_0_2</title>
<ellipse fill="lightgreen" stroke="black" cx="13239.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13239.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13239.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13239.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_2 -->
<g id="edge352" class="edge">
<title>residual_0&#45;&gt;ln2_0_2</title>
<path fill="none" stroke="black" d="M14824.3,-8675.08C14455,-8661.48 13536.14,-8626.21 13397.57,-8607.14 13382.59,-8605.08 13366.93,-8602.27 13351.55,-8599.13"/>
<polygon fill="black" stroke="black" points="13351.99,-8595.64 13341.49,-8597.02 13350.56,-8602.49 13351.99,-8595.64"/>
</g>
<!-- ln2_0_3 -->
<g id="node292" class="node">
<title>ln2_0_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13555.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13555.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13555.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13555.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_3 -->
<g id="edge353" class="edge">
<title>residual_0&#45;&gt;ln2_0_3</title>
<path fill="none" stroke="black" d="M14827.28,-8671.83C14639.83,-8660.85 14309.53,-8641.53 14026.57,-8625.14 13887.47,-8617.08 13851.51,-8626.89 13713.57,-8607.14 13698.71,-8605.01 13683.19,-8602.18 13667.92,-8599.05"/>
<polygon fill="black" stroke="black" points="13668.44,-8595.58 13657.94,-8596.94 13667,-8602.43 13668.44,-8595.58"/>
</g>
<!-- ln2_0_4 -->
<g id="node293" class="node">
<title>ln2_0_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13871.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13871.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13871.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13871.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_4 -->
<g id="edge354" class="edge">
<title>residual_0&#45;&gt;ln2_0_4</title>
<path fill="none" stroke="black" d="M14830.02,-8669.78C14573.41,-8650.81 14068.39,-8613.09 14029.57,-8607.14 14014.96,-8604.9 13999.7,-8602.04 13984.67,-8598.91"/>
<polygon fill="black" stroke="black" points="13985.34,-8595.48 13974.83,-8596.82 13983.89,-8602.33 13985.34,-8595.48"/>
</g>
<!-- ln2_0_5 -->
<g id="node294" class="node">
<title>ln2_0_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14187.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14187.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14187.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14187.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_5 -->
<g id="edge355" class="edge">
<title>residual_0&#45;&gt;ln2_0_5</title>
<path fill="none" stroke="black" d="M14831.95,-8668.34C14703.43,-8656.39 14511.29,-8635.82 14345.57,-8607.14 14331.49,-8604.7 14316.77,-8601.79 14302.23,-8598.7"/>
<polygon fill="black" stroke="black" points="14302.72,-8595.22 14292.2,-8596.53 14301.24,-8602.06 14302.72,-8595.22"/>
</g>
<!-- ln2_0_6 -->
<g id="node295" class="node">
<title>ln2_0_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14503.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14503.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14503.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14503.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_6 -->
<g id="edge356" class="edge">
<title>residual_0&#45;&gt;ln2_0_6</title>
<path fill="none" stroke="black" d="M14867.34,-8655.06C14793.65,-8637.95 14696.79,-8615.48 14621.55,-8598.02"/>
<polygon fill="black" stroke="black" points="14622.09,-8594.55 14611.55,-8595.7 14620.5,-8601.37 14622.09,-8594.55"/>
</g>
<!-- ln2_0_7 -->
<g id="node296" class="node">
<title>ln2_0_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14819.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14819.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14819.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14819.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_7 -->
<g id="edge357" class="edge">
<title>residual_0&#45;&gt;ln2_0_7</title>
<path fill="none" stroke="black" d="M14927.58,-8645.83C14911.64,-8634.74 14893.88,-8622.37 14877.43,-8610.92"/>
<polygon fill="black" stroke="black" points="14879.18,-8607.87 14868.97,-8605.03 14875.18,-8613.61 14879.18,-8607.87"/>
</g>
<!-- ln2_0_8 -->
<g id="node297" class="node">
<title>ln2_0_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15135.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15135.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15135.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15135.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_8 -->
<g id="edge358" class="edge">
<title>residual_0&#45;&gt;ln2_0_8</title>
<path fill="none" stroke="black" d="M15027.57,-8645.83C15043.5,-8634.74 15061.27,-8622.37 15077.71,-8610.92"/>
<polygon fill="black" stroke="black" points="15079.97,-8613.61 15086.18,-8605.03 15075.97,-8607.87 15079.97,-8613.61"/>
</g>
<!-- ln2_0_9 -->
<g id="node298" class="node">
<title>ln2_0_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15451.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15451.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15451.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15451.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_9 -->
<g id="edge359" class="edge">
<title>residual_0&#45;&gt;ln2_0_9</title>
<path fill="none" stroke="black" d="M15087.81,-8655.06C15161.5,-8637.95 15258.35,-8615.48 15333.59,-8598.02"/>
<polygon fill="black" stroke="black" points="15334.64,-8601.37 15343.59,-8595.7 15333.06,-8594.55 15334.64,-8601.37"/>
</g>
<!-- ln2_0_10 -->
<g id="node299" class="node">
<title>ln2_0_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15767.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15767.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15767.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15767.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_10 -->
<g id="edge360" class="edge">
<title>residual_0&#45;&gt;ln2_0_10</title>
<path fill="none" stroke="black" d="M15123.19,-8668.34C15251.72,-8656.39 15443.86,-8635.82 15609.57,-8607.14 15623.66,-8604.7 15638.38,-8601.79 15652.92,-8598.7"/>
<polygon fill="black" stroke="black" points="15653.91,-8602.06 15662.94,-8596.53 15652.43,-8595.22 15653.91,-8602.06"/>
</g>
<!-- ln2_0_11 -->
<g id="node300" class="node">
<title>ln2_0_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16083.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16083.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16083.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16083.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_11 -->
<g id="edge361" class="edge">
<title>residual_0&#45;&gt;ln2_0_11</title>
<path fill="none" stroke="black" d="M15131.49,-8675.78C15319.71,-8668.22 15647.57,-8649.78 15925.57,-8607.14 15940.18,-8604.9 15955.45,-8602.04 15970.48,-8598.91"/>
<polygon fill="black" stroke="black" points="15971.26,-8602.33 15980.31,-8596.82 15969.81,-8595.48 15971.26,-8602.33"/>
</g>
<!-- ln2_0_12 -->
<g id="node301" class="node">
<title>ln2_0_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16399.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16399.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16399.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16399.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_12 -->
<g id="edge362" class="edge">
<title>residual_0&#45;&gt;ln2_0_12</title>
<path fill="none" stroke="black" d="M15133.11,-8680.02C15372.47,-8677.18 15845.02,-8664.05 16241.57,-8607.14 16256.43,-8605 16271.96,-8602.18 16287.22,-8599.04"/>
<polygon fill="black" stroke="black" points="16288.15,-8602.42 16297.21,-8596.93 16286.7,-8595.57 16288.15,-8602.42"/>
</g>
<!-- ln2_0_13 -->
<g id="node302" class="node">
<title>ln2_0_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16715.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16715.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16715.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16715.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_13 -->
<g id="edge363" class="edge">
<title>residual_0&#45;&gt;ln2_0_13</title>
<path fill="none" stroke="black" d="M15131.94,-8677.01C15473.69,-8668.39 16285.45,-8644.59 16557.57,-8607.14 16572.56,-8605.08 16588.21,-8602.27 16603.6,-8599.13"/>
<polygon fill="black" stroke="black" points="16604.59,-8602.49 16613.66,-8597.02 16603.15,-8595.64 16604.59,-8602.49"/>
</g>
<!-- ln2_0_14 -->
<g id="node303" class="node">
<title>ln2_0_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17031.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17031.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17031.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17031.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_14 -->
<g id="edge364" class="edge">
<title>residual_0&#45;&gt;ln2_0_14</title>
<path fill="none" stroke="black" d="M15132.78,-8678.39C15523.18,-8672.12 16538.7,-8651.9 16873.57,-8607.14 16888.57,-8605.13 16904.23,-8602.36 16919.61,-8599.24"/>
<polygon fill="black" stroke="black" points="16920.6,-8602.6 16929.67,-8597.13 16919.17,-8595.75 16920.6,-8602.6"/>
</g>
<!-- ln2_0_15 -->
<g id="node304" class="node">
<title>ln2_0_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17347.57" cy="-8569.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17347.57" y="-8580.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17347.57" y="-8565.94" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17347.57" y="-8550.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_15 -->
<g id="edge365" class="edge">
<title>residual_0&#45;&gt;ln2_0_15</title>
<path fill="none" stroke="black" d="M15131.59,-8676.1C15432.26,-8667.16 16118.5,-8646.39 16695.57,-8626.14 16915.16,-8618.43 16971.79,-8636.22 17189.57,-8607.14 17204.57,-8605.14 17220.23,-8602.37 17235.61,-8599.24"/>
<polygon fill="black" stroke="black" points="17236.6,-8602.61 17245.67,-8597.14 17235.17,-8595.76 17236.6,-8602.61"/>
</g>
<!-- qkv_proj_0_0 -->
<g id="node68" class="node">
<title>qkv_proj_0_0</title>
<ellipse fill="orange" stroke="black" cx="3547.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="3547.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3547.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="3547.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="3547.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3547.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_0&#45;&gt;qkv_proj_0_0 -->
<g id="edge81" class="edge">
<title>ln1_0_0&#45;&gt;qkv_proj_0_0</title>
<path fill="none" stroke="black" d="M5611.13,-10328.6C5213.57,-10304.98 4105.87,-10239.17 3699.53,-10215.02"/>
<polygon fill="black" stroke="black" points="3699.66,-10211.52 3689.47,-10214.42 3699.25,-10218.51 3699.66,-10211.52"/>
</g>
<!-- qkv_proj_0_1 -->
<g id="node69" class="node">
<title>qkv_proj_0_1</title>
<ellipse fill="orange" stroke="black" cx="5320.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="5320.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5320.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="5320.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="5320.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="5320.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_1&#45;&gt;qkv_proj_0_1 -->
<g id="edge82" class="edge">
<title>ln1_0_1&#45;&gt;qkv_proj_0_1</title>
<path fill="none" stroke="black" d="M6503.05,-10323.52C6253.48,-10298.71 5728.01,-10246.49 5469.97,-10220.84"/>
<polygon fill="black" stroke="black" points="5470.07,-10217.33 5459.78,-10219.83 5469.38,-10224.3 5470.07,-10217.33"/>
</g>
<!-- qkv_proj_0_2 -->
<g id="node70" class="node">
<title>qkv_proj_0_2</title>
<ellipse fill="orange" stroke="black" cx="6389.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="6389.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6389.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6389.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="6389.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6389.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_2&#45;&gt;qkv_proj_0_2 -->
<g id="edge83" class="edge">
<title>ln1_0_2&#45;&gt;qkv_proj_0_2</title>
<path fill="none" stroke="black" d="M7111.03,-10319.6C7007.22,-10305.27 6857.9,-10284.14 6727.57,-10263.68 6662.81,-10253.52 6591.23,-10241.43 6530.67,-10230.94"/>
<polygon fill="black" stroke="black" points="6531.11,-10227.47 6520.66,-10229.21 6529.91,-10234.36 6531.11,-10227.47"/>
</g>
<!-- qkv_proj_0_3 -->
<g id="node71" class="node">
<title>qkv_proj_0_3</title>
<ellipse fill="orange" stroke="black" cx="6880.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="6880.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6880.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6880.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="6880.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6880.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_3&#45;&gt;qkv_proj_0_3 -->
<g id="edge84" class="edge">
<title>ln1_0_3&#45;&gt;qkv_proj_0_3</title>
<path fill="none" stroke="black" d="M8489.76,-10326.56C8164.32,-10302.18 7366.18,-10242.38 7031.81,-10217.32"/>
<polygon fill="black" stroke="black" points="7031.8,-10213.81 7021.57,-10216.56 7031.28,-10220.79 7031.8,-10213.81"/>
</g>
<!-- qkv_proj_0_4 -->
<g id="node72" class="node">
<title>qkv_proj_0_4</title>
<ellipse fill="orange" stroke="black" cx="8551.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8551.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8551.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8551.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="8551.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8551.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_4&#45;&gt;qkv_proj_0_4 -->
<g id="edge85" class="edge">
<title>ln1_0_4&#45;&gt;qkv_proj_0_4</title>
<path fill="none" stroke="black" d="M9002.46,-10316.1C8929.2,-10302.65 8834.11,-10283.98 8750.57,-10263.68 8726.04,-10257.72 8700,-10250.69 8675.13,-10243.63"/>
<polygon fill="black" stroke="black" points="8675.87,-10240.2 8665.29,-10240.82 8673.94,-10246.93 8675.87,-10240.2"/>
</g>
<!-- qkv_proj_0_5 -->
<g id="node73" class="node">
<title>qkv_proj_0_5</title>
<ellipse fill="orange" stroke="black" cx="8903.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8903.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8903.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8903.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="8903.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8903.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_5&#45;&gt;qkv_proj_0_5 -->
<g id="edge86" class="edge">
<title>ln1_0_5&#45;&gt;qkv_proj_0_5</title>
<path fill="none" stroke="black" d="M9925.14,-10337.39C9729.16,-10335.12 9375.45,-10322.2 9079.57,-10263.68 9059.65,-10259.74 9038.84,-10254.24 9018.8,-10248.17"/>
<polygon fill="black" stroke="black" points="9019.62,-10244.76 9009.03,-10245.16 9017.55,-10251.45 9019.62,-10244.76"/>
</g>
<!-- qkv_proj_0_6 -->
<g id="node74" class="node">
<title>qkv_proj_0_6</title>
<ellipse fill="orange" stroke="black" cx="9232.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9232.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9232.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9232.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="9232.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9232.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_6&#45;&gt;qkv_proj_0_6 -->
<g id="edge87" class="edge">
<title>ln1_0_6&#45;&gt;qkv_proj_0_6</title>
<path fill="none" stroke="black" d="M10703.01,-10328.03C10578.59,-10320.25 10393.74,-10309.04 10232.57,-10300.68 10046.86,-10291.05 9579.14,-10299.03 9396.57,-10263.68 9379.07,-10260.3 9360.92,-10255.4 9343.34,-10249.87"/>
<polygon fill="black" stroke="black" points="9344.24,-10246.48 9333.64,-10246.74 9342.09,-10253.15 9344.24,-10246.48"/>
</g>
<!-- qkv_proj_0_7 -->
<g id="node75" class="node">
<title>qkv_proj_0_7</title>
<ellipse fill="orange" stroke="black" cx="9549.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9549.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9549.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9549.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="9549.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9549.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_7&#45;&gt;qkv_proj_0_7 -->
<g id="edge88" class="edge">
<title>ln1_0_7&#45;&gt;qkv_proj_0_7</title>
<path fill="none" stroke="black" d="M11255.43,-10322.21C11181.43,-10314.56 11088.05,-10305.82 11004.57,-10300.68 10716.78,-10282.99 9990.76,-10317.94 9707.57,-10263.68 9691.27,-10260.56 9674.42,-10255.98 9658.06,-10250.74"/>
<polygon fill="black" stroke="black" points="9659.09,-10247.4 9648.5,-10247.59 9656.9,-10254.04 9659.09,-10247.4"/>
</g>
<!-- qkv_proj_0_8 -->
<g id="node76" class="node">
<title>qkv_proj_0_8</title>
<ellipse fill="orange" stroke="black" cx="9860.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9860.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9860.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9860.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="9860.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9860.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_8&#45;&gt;qkv_proj_0_8 -->
<g id="edge89" class="edge">
<title>ln1_0_8&#45;&gt;qkv_proj_0_8</title>
<path fill="none" stroke="black" d="M11694.18,-10318.16C11648.4,-10311.81 11596.24,-10305.21 11548.57,-10300.68 10984.38,-10247.08 10310.99,-10220.47 10014.09,-10210.63"/>
<polygon fill="black" stroke="black" points="10013.8,-10207.12 10003.69,-10210.29 10013.57,-10214.11 10013.8,-10207.12"/>
</g>
<!-- qkv_proj_0_9 -->
<g id="node77" class="node">
<title>qkv_proj_0_9</title>
<ellipse fill="orange" stroke="black" cx="11507.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11507.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11507.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="11507.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="11507.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11507.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_9&#45;&gt;qkv_proj_0_9 -->
<g id="edge90" class="edge">
<title>ln1_0_9&#45;&gt;qkv_proj_0_9</title>
<path fill="none" stroke="black" d="M12073.47,-10315.82C12042.59,-10310.59 12009.38,-10305.21 11978.57,-10300.68 11945.56,-10295.83 11713.11,-10271.05 11680.57,-10263.68 11661.69,-10259.41 11641.95,-10253.88 11622.84,-10247.95"/>
<polygon fill="black" stroke="black" points="11623.81,-10244.58 11613.22,-10244.91 11621.7,-10251.26 11623.81,-10244.58"/>
</g>
<!-- qkv_proj_0_10 -->
<g id="node78" class="node">
<title>qkv_proj_0_10</title>
<ellipse fill="orange" stroke="black" cx="11833.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11833.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11833.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="11833.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="11833.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11833.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_10&#45;&gt;qkv_proj_0_10 -->
<g id="edge91" class="edge">
<title>ln1_0_10&#45;&gt;qkv_proj_0_10</title>
<path fill="none" stroke="black" d="M12435.19,-10314.65C12407.82,-10309.71 12378.71,-10304.74 12351.57,-10300.68 12211.73,-10279.76 12174.23,-10291.41 12035.57,-10263.68 12009.57,-10258.48 11982.04,-10251.58 11955.95,-10244.37"/>
<polygon fill="black" stroke="black" points="11956.6,-10240.92 11946.03,-10241.59 11954.72,-10247.66 11956.6,-10240.92"/>
</g>
<!-- qkv_proj_0_11 -->
<g id="node79" class="node">
<title>qkv_proj_0_11</title>
<ellipse fill="orange" stroke="black" cx="12188.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12188.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12188.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12188.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="12188.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12188.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_11&#45;&gt;qkv_proj_0_11 -->
<g id="edge92" class="edge">
<title>ln1_0_11&#45;&gt;qkv_proj_0_11</title>
<path fill="none" stroke="black" d="M12780.03,-10314.25C12756.72,-10309.7 12732.37,-10304.99 12709.57,-10300.68 12581.04,-10276.39 12434.44,-10249.85 12329.56,-10231.07"/>
<polygon fill="black" stroke="black" points="12330.01,-10227.59 12319.55,-10229.27 12328.77,-10234.48 12330.01,-10227.59"/>
</g>
<!-- qkv_proj_0_12 -->
<g id="node80" class="node">
<title>qkv_proj_0_12</title>
<ellipse fill="orange" stroke="black" cx="12665.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12665.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12665.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="12665.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="12665.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12665.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_12&#45;&gt;qkv_proj_0_12 -->
<g id="edge93" class="edge">
<title>ln1_0_12&#45;&gt;qkv_proj_0_12</title>
<path fill="none" stroke="black" d="M13118.26,-10312.04C13027.38,-10290.75 12896.67,-10260.13 12799.04,-10237.26"/>
<polygon fill="black" stroke="black" points="12799.64,-10233.81 12789.11,-10234.93 12798.04,-10240.62 12799.64,-10233.81"/>
</g>
<!-- qkv_proj_0_13 -->
<g id="node81" class="node">
<title>qkv_proj_0_13</title>
<ellipse fill="orange" stroke="black" cx="13290.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13290.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13290.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13290.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="13290.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13290.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_13&#45;&gt;qkv_proj_0_13 -->
<g id="edge94" class="edge">
<title>ln1_0_13&#45;&gt;qkv_proj_0_13</title>
<path fill="none" stroke="black" d="M13620.75,-10308.64C13560.08,-10289.78 13479.86,-10264.84 13413.69,-10244.27"/>
<polygon fill="black" stroke="black" points="13414.62,-10240.89 13404.03,-10241.27 13412.54,-10247.58 13414.62,-10240.89"/>
</g>
<!-- qkv_proj_0_14 -->
<g id="node82" class="node">
<title>qkv_proj_0_14</title>
<ellipse fill="orange" stroke="black" cx="13701.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13701.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13701.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13701.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="13701.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13701.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_14&#45;&gt;qkv_proj_0_14 -->
<g id="edge95" class="edge">
<title>ln1_0_14&#45;&gt;qkv_proj_0_14</title>
<path fill="none" stroke="black" d="M14075.49,-10309.92C14004,-10290.05 13906.5,-10262.95 13828.98,-10241.41"/>
<polygon fill="black" stroke="black" points="13829.72,-10237.98 13819.15,-10238.67 13827.85,-10244.72 13829.72,-10237.98"/>
</g>
<!-- qkv_proj_0_15 -->
<g id="node83" class="node">
<title>qkv_proj_0_15</title>
<ellipse fill="orange" stroke="black" cx="14565.57" cy="-10204.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14565.57" y="-10231.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14565.57" y="-10216.29" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14565.57" y="-10201.29" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="14565.57" y="-10186.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14565.57" y="-10171.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_15&#45;&gt;qkv_proj_0_15 -->
<g id="edge96" class="edge">
<title>ln1_0_15&#45;&gt;qkv_proj_0_15</title>
<path fill="none" stroke="black" d="M14587.22,-10300.64C14585.26,-10292.09 14583.12,-10282.71 14580.96,-10273.28"/>
<polygon fill="black" stroke="black" points="14584.36,-10272.44 14578.72,-10263.48 14577.54,-10274 14584.36,-10272.44"/>
</g>
<!-- reshape_qkv_0_0 -->
<g id="node84" class="node">
<title>reshape_qkv_0_0</title>
<ellipse fill="lightcyan" stroke="black" cx="573.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="573.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="573.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="573.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_0&#45;&gt;reshape_qkv_0_0 -->
<g id="edge97" class="edge">
<title>qkv_proj_0_0&#45;&gt;reshape_qkv_0_0</title>
<path fill="none" stroke="black" d="M3404.93,-10197.9C3057.14,-10183.03 2137.78,-10143.56 1370.57,-10109.3 1151.17,-10099.51 897.81,-10087.85 736.73,-10080.39"/>
<polygon fill="black" stroke="black" points="736.88,-10076.89 726.73,-10079.92 736.56,-10083.88 736.88,-10076.89"/>
</g>
<!-- reshape_qkv_0_1 -->
<g id="node97" class="node">
<title>reshape_qkv_0_1</title>
<ellipse fill="lightcyan" stroke="black" cx="1536.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="1536.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1536.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1536.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_1&#45;&gt;reshape_qkv_0_1 -->
<g id="edge112" class="edge">
<title>qkv_proj_0_1&#45;&gt;reshape_qkv_0_1</title>
<path fill="none" stroke="black" d="M5177.83,-10198.47C4895.65,-10187.64 4246.46,-10163.22 3700.57,-10146.3 3076.66,-10126.97 2920.36,-10132.5 2296.57,-10109.3 2090.06,-10101.62 1852.14,-10089.7 1698.31,-10081.59"/>
<polygon fill="black" stroke="black" points="1698.47,-10078.09 1688.3,-10081.06 1698.1,-10085.08 1698.47,-10078.09"/>
</g>
<!-- reshape_qkv_0_2 -->
<g id="node109" class="node">
<title>reshape_qkv_0_2</title>
<ellipse fill="lightcyan" stroke="black" cx="2462.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="2462.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2462.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2462.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_2&#45;&gt;reshape_qkv_0_2 -->
<g id="edge127" class="edge">
<title>qkv_proj_0_2&#45;&gt;reshape_qkv_0_2</title>
<path fill="none" stroke="black" d="M6248.84,-10193.09C6069.11,-10179.64 5748.42,-10157.21 5473.57,-10146.3 4474.23,-10106.64 4223.19,-10141.49 3223.57,-10109.3 3016.6,-10102.64 2778.15,-10090.48 2624.14,-10082.03"/>
<polygon fill="black" stroke="black" points="2624.3,-10078.53 2614.12,-10081.48 2623.92,-10085.52 2624.3,-10078.53"/>
</g>
<!-- reshape_qkv_0_3 -->
<g id="node121" class="node">
<title>reshape_qkv_0_3</title>
<ellipse fill="lightcyan" stroke="black" cx="3389.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="3389.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3389.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3389.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_3&#45;&gt;reshape_qkv_0_3 -->
<g id="edge142" class="edge">
<title>qkv_proj_0_3&#45;&gt;reshape_qkv_0_3</title>
<path fill="none" stroke="black" d="M6753.59,-10177.55C6690.45,-10165.63 6612.82,-10152.79 6542.57,-10146.3 5997.72,-10096.01 4627.43,-10127.85 4080.57,-10109.3 3898.73,-10103.14 3690.18,-10091.49 3550.18,-10083.01"/>
<polygon fill="black" stroke="black" points="3549.99,-10079.49 3539.8,-10082.38 3549.57,-10086.48 3549.99,-10079.49"/>
</g>
<!-- reshape_qkv_0_4 -->
<g id="node134" class="node">
<title>reshape_qkv_0_4</title>
<ellipse fill="lightcyan" stroke="black" cx="4246.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="4246.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4246.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4246.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_4&#45;&gt;reshape_qkv_0_4 -->
<g id="edge158" class="edge">
<title>qkv_proj_0_4&#45;&gt;reshape_qkv_0_4</title>
<path fill="none" stroke="black" d="M8409.02,-10197.91C8140.12,-10186.57 7539.53,-10161.96 7033.57,-10146.3 6680.31,-10135.37 6591.94,-10134.19 6238.57,-10127.3 5707.06,-10116.95 5573.94,-10125.48 5042.57,-10109.3 4823.04,-10102.62 4569.65,-10090.19 4408.84,-10081.71"/>
<polygon fill="black" stroke="black" points="4408.55,-10078.19 4398.38,-10081.16 4408.18,-10085.18 4408.55,-10078.19"/>
</g>
<!-- reshape_qkv_0_5 -->
<g id="node147" class="node">
<title>reshape_qkv_0_5</title>
<ellipse fill="lightcyan" stroke="black" cx="5208.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="5208.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5208.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5208.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_5&#45;&gt;reshape_qkv_0_5 -->
<g id="edge173" class="edge">
<title>qkv_proj_0_5&#45;&gt;reshape_qkv_0_5</title>
<path fill="none" stroke="black" d="M8794.48,-10166.68C8765.59,-10158.37 8734.19,-10150.72 8704.57,-10146.3 8416.29,-10103.28 6372.93,-10117.45 6081.57,-10109.3 5833.72,-10102.38 5546.48,-10089.42 5371.19,-10080.95"/>
<polygon fill="black" stroke="black" points="5371.26,-10077.45 5361.11,-10080.46 5370.93,-10084.44 5371.26,-10077.45"/>
</g>
<!-- reshape_qkv_0_6 -->
<g id="node159" class="node">
<title>reshape_qkv_0_6</title>
<ellipse fill="lightcyan" stroke="black" cx="6247.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="6247.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6247.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6247.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_6&#45;&gt;reshape_qkv_0_6 -->
<g id="edge188" class="edge">
<title>qkv_proj_0_6&#45;&gt;reshape_qkv_0_6</title>
<path fill="none" stroke="black" d="M9128.7,-10164.28C9105.31,-10156.94 9080.35,-10150.32 9056.57,-10146.3 8830.3,-10108.08 7220.93,-10116.98 6991.57,-10109.3 6790.84,-10102.58 6559.84,-10090.58 6409.17,-10082.18"/>
<polygon fill="black" stroke="black" points="6409.1,-10078.67 6398.92,-10081.61 6408.7,-10085.66 6409.1,-10078.67"/>
</g>
<!-- reshape_qkv_0_7 -->
<g id="node171" class="node">
<title>reshape_qkv_0_7</title>
<ellipse fill="lightcyan" stroke="black" cx="7157.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="7157.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7157.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7157.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_7&#45;&gt;reshape_qkv_0_7 -->
<g id="edge203" class="edge">
<title>qkv_proj_0_7&#45;&gt;reshape_qkv_0_7</title>
<path fill="none" stroke="black" d="M9449,-10163.06C9428.34,-10156.24 9406.5,-10150.14 9385.57,-10146.3 9218.75,-10115.73 8029.06,-10115.76 7859.57,-10109.3 7673.94,-10102.23 7460.86,-10090.66 7318.61,-10082.45"/>
<polygon fill="black" stroke="black" points="7318.68,-10078.95 7308.49,-10081.86 7318.27,-10085.93 7318.68,-10078.95"/>
</g>
<!-- reshape_qkv_0_8 -->
<g id="node184" class="node">
<title>reshape_qkv_0_8</title>
<ellipse fill="lightcyan" stroke="black" cx="8025.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8025.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8025.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8025.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_8&#45;&gt;reshape_qkv_0_8 -->
<g id="edge219" class="edge">
<title>qkv_proj_0_8&#45;&gt;reshape_qkv_0_8</title>
<path fill="none" stroke="black" d="M9761.19,-10162.42C9742.04,-10155.93 9721.91,-10150.12 9702.57,-10146.3 9602.2,-10126.52 9344.79,-10132.43 9242.57,-10128.3 9039.45,-10120.11 8988.66,-10118.4 8785.57,-10109.3 8579.45,-10100.07 8341.93,-10088.52 8188.06,-10080.91"/>
<polygon fill="black" stroke="black" points="8188.21,-10077.41 8178.05,-10080.42 8187.86,-10084.41 8188.21,-10077.41"/>
</g>
<!-- reshape_qkv_0_9 -->
<g id="node197" class="node">
<title>reshape_qkv_0_9</title>
<ellipse fill="lightcyan" stroke="black" cx="8951.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8951.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8951.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8951.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_9&#45;&gt;reshape_qkv_0_9 -->
<g id="edge234" class="edge">
<title>qkv_proj_0_9&#45;&gt;reshape_qkv_0_9</title>
<path fill="none" stroke="black" d="M11365.14,-10196.86C11053.06,-10181.21 10285.45,-10142.6 9642.57,-10109.3 9461.6,-10099.93 9253.97,-10088.93 9113.94,-10081.47"/>
<polygon fill="black" stroke="black" points="9113.73,-10077.96 9103.56,-10080.92 9113.36,-10084.95 9113.73,-10077.96"/>
</g>
<!-- reshape_qkv_0_10 -->
<g id="node209" class="node">
<title>reshape_qkv_0_10</title>
<ellipse fill="lightcyan" stroke="black" cx="9808.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9808.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9808.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9808.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_10&#45;&gt;reshape_qkv_0_10 -->
<g id="edge249" class="edge">
<title>qkv_proj_0_10&#45;&gt;reshape_qkv_0_10</title>
<path fill="none" stroke="black" d="M11730.08,-10164.14C11707.49,-10156.95 11683.47,-10150.44 11660.57,-10146.3 11430.81,-10104.84 10843.86,-10118.72 10610.57,-10109.3 10389.08,-10100.36 10133.25,-10088.44 9971.23,-10080.7"/>
<polygon fill="black" stroke="black" points="9971.34,-10077.2 9961.18,-10080.22 9971,-10084.19 9971.34,-10077.2"/>
</g>
<!-- reshape_qkv_0_11 -->
<g id="node221" class="node">
<title>reshape_qkv_0_11</title>
<ellipse fill="lightcyan" stroke="black" cx="10776.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10776.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10776.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10776.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_11&#45;&gt;reshape_qkv_0_11 -->
<g id="edge264" class="edge">
<title>qkv_proj_0_11&#45;&gt;reshape_qkv_0_11</title>
<path fill="none" stroke="black" d="M12077.65,-10167.63C12048.33,-10159.31 12016.5,-10151.42 11986.57,-10146.3 11886.2,-10129.13 11245.93,-10095.91 10939.53,-10080.73"/>
<polygon fill="black" stroke="black" points="10939.38,-10077.21 10929.22,-10080.22 10939.04,-10084.21 10939.38,-10077.21"/>
</g>
<!-- reshape_qkv_0_12 -->
<g id="node234" class="node">
<title>reshape_qkv_0_12</title>
<ellipse fill="lightcyan" stroke="black" cx="11662.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11662.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11662.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11662.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_12&#45;&gt;reshape_qkv_0_12 -->
<g id="edge280" class="edge">
<title>qkv_proj_0_12&#45;&gt;reshape_qkv_0_12</title>
<path fill="none" stroke="black" d="M12536.62,-10178.94C12477.35,-10167.97 12406.05,-10155.52 12341.57,-10146.3 12162.79,-10120.74 11956.39,-10099.58 11818.52,-10086.63"/>
<polygon fill="black" stroke="black" points="11818.58,-10083.12 11808.3,-10085.67 11817.93,-10090.09 11818.58,-10083.12"/>
</g>
<!-- reshape_qkv_0_13 -->
<g id="node247" class="node">
<title>reshape_qkv_0_13</title>
<ellipse fill="lightcyan" stroke="black" cx="12589.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12589.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12589.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12589.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_13&#45;&gt;reshape_qkv_0_13 -->
<g id="edge295" class="edge">
<title>qkv_proj_0_13&#45;&gt;reshape_qkv_0_13</title>
<path fill="none" stroke="black" d="M13160.77,-10179.7C13035.54,-10156.26 12846.93,-10120.97 12721.11,-10097.42"/>
<polygon fill="black" stroke="black" points="12721.5,-10093.93 12711.03,-10095.53 12720.21,-10100.81 12721.5,-10093.93"/>
</g>
<!-- reshape_qkv_0_14 -->
<g id="node259" class="node">
<title>reshape_qkv_0_14</title>
<ellipse fill="lightcyan" stroke="black" cx="13586.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13586.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13586.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13586.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_14&#45;&gt;reshape_qkv_0_14 -->
<g id="edge310" class="edge">
<title>qkv_proj_0_14&#45;&gt;reshape_qkv_0_14</title>
<path fill="none" stroke="black" d="M13653.8,-10149.5C13644.07,-10138.39 13633.95,-10126.85 13624.61,-10116.2"/>
<polygon fill="black" stroke="black" points="13627.19,-10113.83 13617.97,-10108.62 13621.93,-10118.44 13627.19,-10113.83"/>
</g>
<!-- reshape_qkv_0_15 -->
<g id="node271" class="node">
<title>reshape_qkv_0_15</title>
<ellipse fill="lightcyan" stroke="black" cx="14413.57" cy="-10071.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14413.57" y="-10083.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14413.57" y="-10068.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14413.57" y="-10053.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_15&#45;&gt;reshape_qkv_0_15 -->
<g id="edge325" class="edge">
<title>qkv_proj_0_15&#45;&gt;reshape_qkv_0_15</title>
<path fill="none" stroke="black" d="M14505.06,-10151.77C14490.94,-10139.58 14476.08,-10126.75 14462.54,-10115.06"/>
<polygon fill="black" stroke="black" points="14464.59,-10112.21 14454.73,-10108.32 14460.01,-10117.51 14464.59,-10112.21"/>
</g>
<!-- split_q_0_0 -->
<g id="node85" class="node">
<title>split_q_0_0</title>
<ellipse fill="pink" stroke="black" cx="145.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="145.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="145.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="145.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_q_0_0 -->
<g id="edge98" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_q_0_0</title>
<path fill="none" stroke="black" d="M468.87,-10043.89C404.61,-10027.38 322.37,-10006.24 256.92,-9989.42"/>
<polygon fill="black" stroke="black" points="257.54,-9985.97 246.98,-9986.87 255.79,-9992.75 257.54,-9985.97"/>
</g>
<!-- split_k_0_0 -->
<g id="node86" class="node">
<title>split_k_0_0</title>
<ellipse fill="pink" stroke="black" cx="454.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="454.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_k_0_0 -->
<g id="edge99" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_k_0_0</title>
<path fill="none" stroke="black" d="M535.27,-10035.39C524.12,-10025.09 511.83,-10013.73 500.28,-10003.05"/>
<polygon fill="black" stroke="black" points="502.53,-10000.37 492.81,-9996.15 497.78,-10005.51 502.53,-10000.37"/>
</g>
<!-- split_v_0_0 -->
<g id="node87" class="node">
<title>split_v_0_0</title>
<ellipse fill="pink" stroke="black" cx="763.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="763.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_v_0_0 -->
<g id="edge100" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_v_0_0</title>
<path fill="none" stroke="black" d="M632.13,-10036.9C652.55,-10025.08 675.61,-10011.73 696.66,-9999.55"/>
<polygon fill="black" stroke="black" points="698.64,-10002.44 705.54,-9994.4 695.13,-9996.39 698.64,-10002.44"/>
</g>
<!-- transpose_q_0_0 -->
<g id="node88" class="node">
<title>transpose_q_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="145.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="145.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="145.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="145.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_0&#45;&gt;transpose_q_0_0 -->
<g id="edge101" class="edge">
<title>split_q_0_0&#45;&gt;transpose_q_0_0</title>
<path fill="none" stroke="black" d="M145.57,-9922.18C145.57,-9913.73 145.57,-9904.63 145.57,-9895.81"/>
<polygon fill="black" stroke="black" points="149.07,-9895.65 145.57,-9885.65 142.07,-9895.65 149.07,-9895.65"/>
</g>
<!-- transpose_k_0_0 -->
<g id="node89" class="node">
<title>transpose_k_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="454.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="454.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_0&#45;&gt;transpose_k_0_0 -->
<g id="edge102" class="edge">
<title>split_k_0_0&#45;&gt;transpose_k_0_0</title>
<path fill="none" stroke="black" d="M454.57,-9922.18C454.57,-9913.73 454.57,-9904.63 454.57,-9895.81"/>
<polygon fill="black" stroke="black" points="458.07,-9895.65 454.57,-9885.65 451.07,-9895.65 458.07,-9895.65"/>
</g>
<!-- transpose_v_0_0 -->
<g id="node90" class="node">
<title>transpose_v_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="763.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="763.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_0&#45;&gt;transpose_v_0_0 -->
<g id="edge103" class="edge">
<title>split_v_0_0&#45;&gt;transpose_v_0_0</title>
<path fill="none" stroke="black" d="M763.57,-9922.18C763.57,-9913.73 763.57,-9904.63 763.57,-9895.81"/>
<polygon fill="black" stroke="black" points="767.07,-9895.65 763.57,-9885.65 760.07,-9895.65 767.07,-9895.65"/>
</g>
<!-- attn_scores_0_0 -->
<g id="node91" class="node">
<title>attn_scores_0_0</title>
<ellipse fill="gold" stroke="black" cx="454.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="454.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_0&#45;&gt;attn_scores_0_0 -->
<g id="edge104" class="edge">
<title>transpose_q_0_0&#45;&gt;attn_scores_0_0</title>
<path fill="none" stroke="black" d="M229.19,-9817.04C268.91,-9802.9 316.6,-9785.92 357.86,-9771.23"/>
<polygon fill="black" stroke="black" points="359.13,-9774.49 367.38,-9767.84 356.79,-9767.9 359.13,-9774.49"/>
</g>
<!-- transpose_k_0_0&#45;&gt;attn_scores_0_0 -->
<g id="edge105" class="edge">
<title>transpose_k_0_0&#45;&gt;attn_scores_0_0</title>
<path fill="none" stroke="black" d="M454.57,-9810.18C454.57,-9801.73 454.57,-9792.63 454.57,-9783.81"/>
<polygon fill="black" stroke="black" points="458.07,-9783.65 454.57,-9773.65 451.07,-9783.65 458.07,-9783.65"/>
</g>
<!-- attn_output_0_0 -->
<g id="node92" class="node">
<title>attn_output_0_0</title>
<ellipse fill="gold" stroke="black" cx="763.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="763.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_0&#45;&gt;attn_output_0_0 -->
<g id="edge106" class="edge">
<title>transpose_v_0_0&#45;&gt;attn_output_0_0</title>
<path fill="none" stroke="black" d="M763.57,-9810.1C763.57,-9749.06 763.57,-9626.75 763.57,-9559.6"/>
<polygon fill="black" stroke="black" points="767.07,-9559.31 763.57,-9549.31 760.07,-9559.31 767.07,-9559.31"/>
</g>
<!-- softmax_0_0 -->
<g id="node93" class="node">
<title>softmax_0_0</title>
<ellipse fill="gold" stroke="black" cx="540.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="540.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="540.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="540.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_0&#45;&gt;softmax_0_0 -->
<g id="edge107" class="edge">
<title>attn_scores_0_0&#45;&gt;softmax_0_0</title>
<path fill="none" stroke="black" d="M482.73,-9698.79C490.16,-9689.29 498.25,-9678.93 505.98,-9669.06"/>
<polygon fill="black" stroke="black" points="508.95,-9670.94 512.35,-9660.9 503.43,-9666.63 508.95,-9670.94"/>
</g>
<!-- transpose_back_0_0 -->
<g id="node94" class="node">
<title>transpose_back_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="1452.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1452.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="1452.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1452.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_0&#45;&gt;transpose_back_0_0 -->
<g id="edge109" class="edge">
<title>attn_output_0_0&#45;&gt;transpose_back_0_0</title>
<path fill="none" stroke="black" d="M885.56,-9491.33C1007.68,-9471.83 1194.99,-9441.93 1320.54,-9421.88"/>
<polygon fill="black" stroke="black" points="1321.28,-9425.31 1330.6,-9420.28 1320.18,-9418.4 1321.28,-9425.31"/>
</g>
<!-- softmax_0_0&#45;&gt;attn_output_0_0 -->
<g id="edge108" class="edge">
<title>softmax_0_0&#45;&gt;attn_output_0_0</title>
<path fill="none" stroke="black" d="M608.09,-9589.5C633.43,-9577 662.38,-9562.72 688.38,-9549.9"/>
<polygon fill="black" stroke="black" points="690.02,-9552.99 697.44,-9545.43 686.92,-9546.71 690.02,-9552.99"/>
</g>
<!-- reshape_concat_0_0 -->
<g id="node95" class="node">
<title>reshape_concat_0_0</title>
<ellipse fill="lightcyan" stroke="black" cx="1919.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="1919.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="1919.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1919.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_0&#45;&gt;reshape_concat_0_0 -->
<g id="edge110" class="edge">
<title>transpose_back_0_0&#45;&gt;reshape_concat_0_0</title>
<path fill="none" stroke="black" d="M1558.25,-9373.91C1633.06,-9356.29 1733.16,-9332.71 1809.03,-9314.84"/>
<polygon fill="black" stroke="black" points="1810.17,-9318.17 1819.1,-9312.47 1808.56,-9311.36 1810.17,-9318.17"/>
</g>
<!-- allgather_dim_0_0 -->
<g id="node96" class="node">
<title>allgather_dim_0_0</title>
<polygon fill="red" stroke="black" points="2505.57,-9213.3 2332.57,-9160.3 2505.57,-9107.3 2678.57,-9160.3 2505.57,-9213.3"/>
<text text-anchor="middle" x="2505.57" y="-9171.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="2505.57" y="-9156.6" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="2505.57" y="-9141.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_0&#45;&gt;allgather_dim_0_0 -->
<g id="edge111" class="edge">
<title>reshape_concat_0_0&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2018.88,-9262.81C2037.06,-9258.55 2055.87,-9254.23 2073.57,-9250.3 2181.38,-9226.43 2304.79,-9201.21 2392.03,-9183.74"/>
<polygon fill="black" stroke="black" points="2392.84,-9187.15 2401.96,-9181.76 2391.46,-9180.29 2392.84,-9187.15"/>
</g>
<!-- head_group_0_0 -->
<g id="node133" class="node">
<title>head_group_0_0</title>
<polygon fill="lightyellow" stroke="black" points="5514.07,-9070.3 5317.07,-9070.3 5317.07,-9032.3 5514.07,-9032.3 5514.07,-9070.3"/>
<text text-anchor="middle" x="5415.57" y="-9055.1" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="5415.57" y="-9040.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_0&#45;&gt;head_group_0_0 -->
<g id="edge157" class="edge">
<title>allgather_dim_0_0&#45;&gt;head_group_0_0</title>
<path fill="none" stroke="black" d="M2657.17,-9153.73C3174.17,-9134.72 4860.72,-9072.71 5306.62,-9056.31"/>
<polygon fill="black" stroke="black" points="5307.06,-9059.8 5316.92,-9055.93 5306.8,-9052.8 5307.06,-9059.8"/>
</g>
<!-- split_q_0_1 -->
<g id="node98" class="node">
<title>split_q_0_1</title>
<ellipse fill="pink" stroke="black" cx="1072.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1072.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="1072.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1072.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_q_0_1 -->
<g id="edge113" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_q_0_1</title>
<path fill="none" stroke="black" d="M1427.2,-10044.87C1355.29,-10027.83 1261.33,-10005.55 1188.2,-9988.21"/>
<polygon fill="black" stroke="black" points="1188.56,-9984.7 1178.02,-9985.8 1186.94,-9991.51 1188.56,-9984.7"/>
</g>
<!-- split_k_0_1 -->
<g id="node99" class="node">
<title>split_k_0_1</title>
<ellipse fill="pink" stroke="black" cx="1381.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="1381.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_k_0_1 -->
<g id="edge114" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_k_0_1</title>
<path fill="none" stroke="black" d="M1487.53,-10036C1471.9,-10024.9 1454.47,-10012.54 1438.33,-10001.09"/>
<polygon fill="black" stroke="black" points="1440.21,-9998.13 1430.03,-9995.19 1436.16,-10003.84 1440.21,-9998.13"/>
</g>
<!-- split_v_0_1 -->
<g id="node100" class="node">
<title>split_v_0_1</title>
<ellipse fill="pink" stroke="black" cx="1690.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="1690.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_v_0_1 -->
<g id="edge115" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_v_0_1</title>
<path fill="none" stroke="black" d="M1585.3,-10036C1600.83,-10024.9 1618.15,-10012.54 1634.18,-10001.09"/>
<polygon fill="black" stroke="black" points="1636.32,-10003.85 1642.43,-9995.19 1632.26,-9998.16 1636.32,-10003.85"/>
</g>
<!-- transpose_q_0_1 -->
<g id="node101" class="node">
<title>transpose_q_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1072.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1072.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="1072.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1072.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_1&#45;&gt;transpose_q_0_1 -->
<g id="edge116" class="edge">
<title>split_q_0_1&#45;&gt;transpose_q_0_1</title>
<path fill="none" stroke="black" d="M1072.57,-9922.18C1072.57,-9913.73 1072.57,-9904.63 1072.57,-9895.81"/>
<polygon fill="black" stroke="black" points="1076.07,-9895.65 1072.57,-9885.65 1069.07,-9895.65 1076.07,-9895.65"/>
</g>
<!-- transpose_k_0_1 -->
<g id="node102" class="node">
<title>transpose_k_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1381.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="1381.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_1&#45;&gt;transpose_k_0_1 -->
<g id="edge117" class="edge">
<title>split_k_0_1&#45;&gt;transpose_k_0_1</title>
<path fill="none" stroke="black" d="M1381.57,-9922.18C1381.57,-9913.73 1381.57,-9904.63 1381.57,-9895.81"/>
<polygon fill="black" stroke="black" points="1385.07,-9895.65 1381.57,-9885.65 1378.07,-9895.65 1385.07,-9895.65"/>
</g>
<!-- transpose_v_0_1 -->
<g id="node103" class="node">
<title>transpose_v_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1690.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="1690.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_1&#45;&gt;transpose_v_0_1 -->
<g id="edge118" class="edge">
<title>split_v_0_1&#45;&gt;transpose_v_0_1</title>
<path fill="none" stroke="black" d="M1690.57,-9922.18C1690.57,-9913.73 1690.57,-9904.63 1690.57,-9895.81"/>
<polygon fill="black" stroke="black" points="1694.07,-9895.65 1690.57,-9885.65 1687.07,-9895.65 1694.07,-9895.65"/>
</g>
<!-- attn_scores_0_1 -->
<g id="node104" class="node">
<title>attn_scores_0_1</title>
<ellipse fill="gold" stroke="black" cx="1381.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1381.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_1&#45;&gt;attn_scores_0_1 -->
<g id="edge119" class="edge">
<title>transpose_q_0_1&#45;&gt;attn_scores_0_1</title>
<path fill="none" stroke="black" d="M1156.19,-9817.04C1195.91,-9802.9 1243.6,-9785.92 1284.86,-9771.23"/>
<polygon fill="black" stroke="black" points="1286.13,-9774.49 1294.38,-9767.84 1283.79,-9767.9 1286.13,-9774.49"/>
</g>
<!-- transpose_k_0_1&#45;&gt;attn_scores_0_1 -->
<g id="edge120" class="edge">
<title>transpose_k_0_1&#45;&gt;attn_scores_0_1</title>
<path fill="none" stroke="black" d="M1381.57,-9810.18C1381.57,-9801.73 1381.57,-9792.63 1381.57,-9783.81"/>
<polygon fill="black" stroke="black" points="1385.07,-9783.65 1381.57,-9773.65 1378.07,-9783.65 1385.07,-9783.65"/>
</g>
<!-- attn_output_0_1 -->
<g id="node105" class="node">
<title>attn_output_0_1</title>
<ellipse fill="gold" stroke="black" cx="1690.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1690.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_1&#45;&gt;attn_output_0_1 -->
<g id="edge121" class="edge">
<title>transpose_v_0_1&#45;&gt;attn_output_0_1</title>
<path fill="none" stroke="black" d="M1690.57,-9810.1C1690.57,-9749.06 1690.57,-9626.75 1690.57,-9559.6"/>
<polygon fill="black" stroke="black" points="1694.07,-9559.31 1690.57,-9549.31 1687.07,-9559.31 1694.07,-9559.31"/>
</g>
<!-- softmax_0_1 -->
<g id="node106" class="node">
<title>softmax_0_1</title>
<ellipse fill="gold" stroke="black" cx="1467.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="1467.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1467.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1467.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_1&#45;&gt;softmax_0_1 -->
<g id="edge122" class="edge">
<title>attn_scores_0_1&#45;&gt;softmax_0_1</title>
<path fill="none" stroke="black" d="M1409.73,-9698.79C1417.16,-9689.29 1425.25,-9678.93 1432.98,-9669.06"/>
<polygon fill="black" stroke="black" points="1435.95,-9670.94 1439.35,-9660.9 1430.43,-9666.63 1435.95,-9670.94"/>
</g>
<!-- transpose_back_0_1 -->
<g id="node107" class="node">
<title>transpose_back_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1916.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1916.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="1916.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1916.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_1&#45;&gt;transpose_back_0_1 -->
<g id="edge124" class="edge">
<title>attn_output_0_1&#45;&gt;transpose_back_0_1</title>
<path fill="none" stroke="black" d="M1757.16,-9478.4C1783.48,-9465.58 1813.87,-9450.79 1841.01,-9437.58"/>
<polygon fill="black" stroke="black" points="1842.61,-9440.69 1850.07,-9433.17 1839.55,-9434.4 1842.61,-9440.69"/>
</g>
<!-- softmax_0_1&#45;&gt;attn_output_0_1 -->
<g id="edge123" class="edge">
<title>softmax_0_1&#45;&gt;attn_output_0_1</title>
<path fill="none" stroke="black" d="M1535.09,-9589.5C1560.43,-9577 1589.38,-9562.72 1615.38,-9549.9"/>
<polygon fill="black" stroke="black" points="1617.02,-9552.99 1624.44,-9545.43 1613.92,-9546.71 1617.02,-9552.99"/>
</g>
<!-- reshape_concat_0_1 -->
<g id="node108" class="node">
<title>reshape_concat_0_1</title>
<ellipse fill="lightcyan" stroke="black" cx="2215.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2215.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2215.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2215.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_1&#45;&gt;reshape_concat_0_1 -->
<g id="edge125" class="edge">
<title>transpose_back_0_1&#45;&gt;reshape_concat_0_1</title>
<path fill="none" stroke="black" d="M1998.28,-9368.75C2038.05,-9354.11 2085.96,-9336.49 2126.65,-9321.52"/>
<polygon fill="black" stroke="black" points="2128.12,-9324.71 2136.29,-9317.97 2125.7,-9318.14 2128.12,-9324.71"/>
</g>
<!-- reshape_concat_0_1&#45;&gt;allgather_dim_0_0 -->
<g id="edge126" class="edge">
<title>reshape_concat_0_1&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2286.89,-9255.94C2328.92,-9237.75 2382.2,-9214.7 2425.64,-9195.9"/>
<polygon fill="black" stroke="black" points="2427.25,-9199.01 2435.04,-9191.83 2424.47,-9192.59 2427.25,-9199.01"/>
</g>
<!-- split_q_0_2 -->
<g id="node110" class="node">
<title>split_q_0_2</title>
<ellipse fill="pink" stroke="black" cx="1999.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1999.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="1999.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1999.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_q_0_2 -->
<g id="edge128" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_q_0_2</title>
<path fill="none" stroke="black" d="M2353.44,-10044.87C2281.68,-10027.83 2187.93,-10005.55 2114.95,-9988.21"/>
<polygon fill="black" stroke="black" points="2115.33,-9984.71 2104.79,-9985.8 2113.71,-9991.52 2115.33,-9984.71"/>
</g>
<!-- split_k_0_2 -->
<g id="node111" class="node">
<title>split_k_0_2</title>
<ellipse fill="pink" stroke="black" cx="2308.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="2308.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_k_0_2 -->
<g id="edge129" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_k_0_2</title>
<path fill="none" stroke="black" d="M2413.85,-10036C2398.31,-10024.9 2381,-10012.54 2364.97,-10001.09"/>
<polygon fill="black" stroke="black" points="2366.89,-9998.16 2356.72,-9995.19 2362.82,-10003.85 2366.89,-9998.16"/>
</g>
<!-- split_v_0_2 -->
<g id="node112" class="node">
<title>split_v_0_2</title>
<ellipse fill="pink" stroke="black" cx="2617.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2617.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="2617.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2617.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_v_0_2 -->
<g id="edge130" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_v_0_2</title>
<path fill="none" stroke="black" d="M2511.62,-10036C2527.25,-10024.9 2544.68,-10012.54 2560.81,-10001.09"/>
<polygon fill="black" stroke="black" points="2562.99,-10003.84 2569.11,-9995.19 2558.93,-9998.13 2562.99,-10003.84"/>
</g>
<!-- transpose_q_0_2 -->
<g id="node113" class="node">
<title>transpose_q_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="1999.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1999.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="1999.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1999.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_2&#45;&gt;transpose_q_0_2 -->
<g id="edge131" class="edge">
<title>split_q_0_2&#45;&gt;transpose_q_0_2</title>
<path fill="none" stroke="black" d="M1999.57,-9922.18C1999.57,-9913.73 1999.57,-9904.63 1999.57,-9895.81"/>
<polygon fill="black" stroke="black" points="2003.07,-9895.65 1999.57,-9885.65 1996.07,-9895.65 2003.07,-9895.65"/>
</g>
<!-- transpose_k_0_2 -->
<g id="node114" class="node">
<title>transpose_k_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2308.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="2308.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_2&#45;&gt;transpose_k_0_2 -->
<g id="edge132" class="edge">
<title>split_k_0_2&#45;&gt;transpose_k_0_2</title>
<path fill="none" stroke="black" d="M2308.57,-9922.18C2308.57,-9913.73 2308.57,-9904.63 2308.57,-9895.81"/>
<polygon fill="black" stroke="black" points="2312.07,-9895.65 2308.57,-9885.65 2305.07,-9895.65 2312.07,-9895.65"/>
</g>
<!-- transpose_v_0_2 -->
<g id="node115" class="node">
<title>transpose_v_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2617.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2617.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="2617.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2617.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_2&#45;&gt;transpose_v_0_2 -->
<g id="edge133" class="edge">
<title>split_v_0_2&#45;&gt;transpose_v_0_2</title>
<path fill="none" stroke="black" d="M2617.57,-9922.18C2617.57,-9913.73 2617.57,-9904.63 2617.57,-9895.81"/>
<polygon fill="black" stroke="black" points="2621.07,-9895.65 2617.57,-9885.65 2614.07,-9895.65 2621.07,-9895.65"/>
</g>
<!-- attn_scores_0_2 -->
<g id="node116" class="node">
<title>attn_scores_0_2</title>
<ellipse fill="gold" stroke="black" cx="2308.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2308.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_2&#45;&gt;attn_scores_0_2 -->
<g id="edge134" class="edge">
<title>transpose_q_0_2&#45;&gt;attn_scores_0_2</title>
<path fill="none" stroke="black" d="M2083.19,-9817.04C2122.91,-9802.9 2170.6,-9785.92 2211.86,-9771.23"/>
<polygon fill="black" stroke="black" points="2213.13,-9774.49 2221.38,-9767.84 2210.79,-9767.9 2213.13,-9774.49"/>
</g>
<!-- transpose_k_0_2&#45;&gt;attn_scores_0_2 -->
<g id="edge135" class="edge">
<title>transpose_k_0_2&#45;&gt;attn_scores_0_2</title>
<path fill="none" stroke="black" d="M2308.57,-9810.18C2308.57,-9801.73 2308.57,-9792.63 2308.57,-9783.81"/>
<polygon fill="black" stroke="black" points="2312.07,-9783.65 2308.57,-9773.65 2305.07,-9783.65 2312.07,-9783.65"/>
</g>
<!-- attn_output_0_2 -->
<g id="node117" class="node">
<title>attn_output_0_2</title>
<ellipse fill="gold" stroke="black" cx="2505.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2505.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2505.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2505.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_2&#45;&gt;attn_output_0_2 -->
<g id="edge136" class="edge">
<title>transpose_v_0_2&#45;&gt;attn_output_0_2</title>
<path fill="none" stroke="black" d="M2605.37,-9810.42C2584.91,-9749.39 2543.69,-9626.49 2521.16,-9559.29"/>
<polygon fill="black" stroke="black" points="2524.34,-9557.76 2517.84,-9549.39 2517.7,-9559.99 2524.34,-9557.76"/>
</g>
<!-- softmax_0_2 -->
<g id="node118" class="node">
<title>softmax_0_2</title>
<ellipse fill="gold" stroke="black" cx="2337.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="2337.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2337.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2337.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_2&#45;&gt;softmax_0_2 -->
<g id="edge137" class="edge">
<title>attn_scores_0_2&#45;&gt;softmax_0_2</title>
<path fill="none" stroke="black" d="M2318.23,-9698.18C2320.53,-9689.46 2323.01,-9680.04 2325.41,-9670.95"/>
<polygon fill="black" stroke="black" points="2328.79,-9671.83 2327.96,-9661.27 2322.03,-9670.05 2328.79,-9671.83"/>
</g>
<!-- transpose_back_0_2 -->
<g id="node119" class="node">
<title>transpose_back_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2505.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2505.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="2505.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2505.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_2&#45;&gt;transpose_back_0_2 -->
<g id="edge139" class="edge">
<title>attn_output_0_2&#45;&gt;transpose_back_0_2</title>
<path fill="none" stroke="black" d="M2505.57,-9474.18C2505.57,-9465.73 2505.57,-9456.63 2505.57,-9447.81"/>
<polygon fill="black" stroke="black" points="2509.07,-9447.65 2505.57,-9437.65 2502.07,-9447.65 2509.07,-9447.65"/>
</g>
<!-- softmax_0_2&#45;&gt;attn_output_0_2 -->
<g id="edge138" class="edge">
<title>softmax_0_2&#45;&gt;attn_output_0_2</title>
<path fill="none" stroke="black" d="M2390.73,-9588C2407.91,-9576.75 2427.1,-9564.19 2444.79,-9552.6"/>
<polygon fill="black" stroke="black" points="2446.89,-9555.41 2453.34,-9547.01 2443.05,-9549.56 2446.89,-9555.41"/>
</g>
<!-- reshape_concat_0_2 -->
<g id="node120" class="node">
<title>reshape_concat_0_2</title>
<ellipse fill="lightcyan" stroke="black" cx="2505.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2505.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2505.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2505.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_2&#45;&gt;reshape_concat_0_2 -->
<g id="edge140" class="edge">
<title>transpose_back_0_2&#45;&gt;reshape_concat_0_2</title>
<path fill="none" stroke="black" d="M2505.57,-9362.18C2505.57,-9353.73 2505.57,-9344.63 2505.57,-9335.81"/>
<polygon fill="black" stroke="black" points="2509.07,-9335.65 2505.57,-9325.65 2502.07,-9335.65 2509.07,-9335.65"/>
</g>
<!-- reshape_concat_0_2&#45;&gt;allgather_dim_0_0 -->
<g id="edge141" class="edge">
<title>reshape_concat_0_2&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2505.57,-9250.17C2505.57,-9241.86 2505.57,-9232.81 2505.57,-9223.77"/>
<polygon fill="black" stroke="black" points="2509.07,-9223.61 2505.57,-9213.61 2502.07,-9223.61 2509.07,-9223.61"/>
</g>
<!-- split_q_0_3 -->
<g id="node122" class="node">
<title>split_q_0_3</title>
<ellipse fill="pink" stroke="black" cx="2926.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2926.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="2926.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2926.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_q_0_3 -->
<g id="edge143" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_q_0_3</title>
<path fill="none" stroke="black" d="M3280.44,-10044.87C3208.68,-10027.83 3114.93,-10005.55 3041.95,-9988.21"/>
<polygon fill="black" stroke="black" points="3042.33,-9984.71 3031.79,-9985.8 3040.71,-9991.52 3042.33,-9984.71"/>
</g>
<!-- split_k_0_3 -->
<g id="node123" class="node">
<title>split_k_0_3</title>
<ellipse fill="pink" stroke="black" cx="3235.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3235.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="3235.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3235.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_k_0_3 -->
<g id="edge144" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_k_0_3</title>
<path fill="none" stroke="black" d="M3340.85,-10036C3325.31,-10024.9 3308,-10012.54 3291.97,-10001.09"/>
<polygon fill="black" stroke="black" points="3293.89,-9998.16 3283.72,-9995.19 3289.82,-10003.85 3293.89,-9998.16"/>
</g>
<!-- split_v_0_3 -->
<g id="node124" class="node">
<title>split_v_0_3</title>
<ellipse fill="pink" stroke="black" cx="3544.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3544.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="3544.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3544.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_v_0_3 -->
<g id="edge145" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_v_0_3</title>
<path fill="none" stroke="black" d="M3438.62,-10036C3454.25,-10024.9 3471.68,-10012.54 3487.81,-10001.09"/>
<polygon fill="black" stroke="black" points="3489.99,-10003.84 3496.11,-9995.19 3485.93,-9998.13 3489.99,-10003.84"/>
</g>
<!-- transpose_q_0_3 -->
<g id="node125" class="node">
<title>transpose_q_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="2926.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2926.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="2926.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2926.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_3&#45;&gt;transpose_q_0_3 -->
<g id="edge146" class="edge">
<title>split_q_0_3&#45;&gt;transpose_q_0_3</title>
<path fill="none" stroke="black" d="M2926.57,-9922.18C2926.57,-9913.73 2926.57,-9904.63 2926.57,-9895.81"/>
<polygon fill="black" stroke="black" points="2930.07,-9895.65 2926.57,-9885.65 2923.07,-9895.65 2930.07,-9895.65"/>
</g>
<!-- transpose_k_0_3 -->
<g id="node126" class="node">
<title>transpose_k_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="3235.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3235.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="3235.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3235.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_3&#45;&gt;transpose_k_0_3 -->
<g id="edge147" class="edge">
<title>split_k_0_3&#45;&gt;transpose_k_0_3</title>
<path fill="none" stroke="black" d="M3235.57,-9922.18C3235.57,-9913.73 3235.57,-9904.63 3235.57,-9895.81"/>
<polygon fill="black" stroke="black" points="3239.07,-9895.65 3235.57,-9885.65 3232.07,-9895.65 3239.07,-9895.65"/>
</g>
<!-- transpose_v_0_3 -->
<g id="node127" class="node">
<title>transpose_v_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="3544.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3544.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="3544.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3544.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_3&#45;&gt;transpose_v_0_3 -->
<g id="edge148" class="edge">
<title>split_v_0_3&#45;&gt;transpose_v_0_3</title>
<path fill="none" stroke="black" d="M3544.57,-9922.18C3544.57,-9913.73 3544.57,-9904.63 3544.57,-9895.81"/>
<polygon fill="black" stroke="black" points="3548.07,-9895.65 3544.57,-9885.65 3541.07,-9895.65 3548.07,-9895.65"/>
</g>
<!-- attn_scores_0_3 -->
<g id="node128" class="node">
<title>attn_scores_0_3</title>
<ellipse fill="gold" stroke="black" cx="3080.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="3080.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3080.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3080.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_3&#45;&gt;attn_scores_0_3 -->
<g id="edge149" class="edge">
<title>transpose_q_0_3&#45;&gt;attn_scores_0_3</title>
<path fill="none" stroke="black" d="M2974.88,-9812.3C2990.28,-9801.3 3007.46,-9789.03 3023.43,-9777.62"/>
<polygon fill="black" stroke="black" points="3025.54,-9780.41 3031.65,-9771.75 3021.47,-9774.72 3025.54,-9780.41"/>
</g>
<!-- transpose_k_0_3&#45;&gt;attn_scores_0_3 -->
<g id="edge150" class="edge">
<title>transpose_k_0_3&#45;&gt;attn_scores_0_3</title>
<path fill="none" stroke="black" d="M3186.96,-9812.3C3171.46,-9801.3 3154.16,-9789.03 3138.09,-9777.62"/>
<polygon fill="black" stroke="black" points="3140,-9774.69 3129.82,-9771.75 3135.95,-9780.39 3140,-9774.69"/>
</g>
<!-- attn_output_0_3 -->
<g id="node129" class="node">
<title>attn_output_0_3</title>
<ellipse fill="gold" stroke="black" cx="3080.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3080.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3080.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3080.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_3&#45;&gt;attn_output_0_3 -->
<g id="edge151" class="edge">
<title>transpose_v_0_3&#45;&gt;attn_output_0_3</title>
<path fill="none" stroke="black" d="M3512.68,-9811.02C3462.59,-9756.55 3360.46,-9652.23 3256.57,-9586.3 3231.94,-9570.67 3203.41,-9557.09 3176.59,-9546.01"/>
<polygon fill="black" stroke="black" points="3177.77,-9542.71 3167.18,-9542.19 3175.13,-9549.19 3177.77,-9542.71"/>
</g>
<!-- softmax_0_3 -->
<g id="node130" class="node">
<title>softmax_0_3</title>
<ellipse fill="gold" stroke="black" cx="3080.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="3080.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3080.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3080.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_3&#45;&gt;softmax_0_3 -->
<g id="edge152" class="edge">
<title>attn_scores_0_3&#45;&gt;softmax_0_3</title>
<path fill="none" stroke="black" d="M3080.57,-9698.18C3080.57,-9689.73 3080.57,-9680.63 3080.57,-9671.81"/>
<polygon fill="black" stroke="black" points="3084.07,-9671.65 3080.57,-9661.65 3077.07,-9671.65 3084.07,-9671.65"/>
</g>
<!-- transpose_back_0_3 -->
<g id="node131" class="node">
<title>transpose_back_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="3050.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3050.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="3050.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3050.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_3&#45;&gt;transpose_back_0_3 -->
<g id="edge154" class="edge">
<title>attn_output_0_3&#45;&gt;transpose_back_0_3</title>
<path fill="none" stroke="black" d="M3070.58,-9474.18C3068.21,-9465.46 3065.64,-9456.04 3063.16,-9446.95"/>
<polygon fill="black" stroke="black" points="3066.53,-9446 3060.52,-9437.27 3059.77,-9447.84 3066.53,-9446"/>
</g>
<!-- softmax_0_3&#45;&gt;attn_output_0_3 -->
<g id="edge153" class="edge">
<title>softmax_0_3&#45;&gt;attn_output_0_3</title>
<path fill="none" stroke="black" d="M3080.57,-9586.18C3080.57,-9577.73 3080.57,-9568.63 3080.57,-9559.81"/>
<polygon fill="black" stroke="black" points="3084.07,-9559.65 3080.57,-9549.65 3077.07,-9559.65 3084.07,-9559.65"/>
</g>
<!-- reshape_concat_0_3 -->
<g id="node132" class="node">
<title>reshape_concat_0_3</title>
<ellipse fill="lightcyan" stroke="black" cx="2830.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2830.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2830.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2830.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_3&#45;&gt;reshape_concat_0_3 -->
<g id="edge155" class="edge">
<title>transpose_back_0_3&#45;&gt;reshape_concat_0_3</title>
<path fill="none" stroke="black" d="M2985.46,-9366.25C2959.73,-9353.38 2930.05,-9338.54 2903.59,-9325.31"/>
<polygon fill="black" stroke="black" points="2904.89,-9322.05 2894.38,-9320.71 2901.76,-9328.31 2904.89,-9322.05"/>
</g>
<!-- reshape_concat_0_3&#45;&gt;allgather_dim_0_0 -->
<g id="edge156" class="edge">
<title>reshape_concat_0_3&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2753.55,-9257.06C2704.53,-9238.13 2641,-9213.6 2590.51,-9194.1"/>
<polygon fill="black" stroke="black" points="2591.51,-9190.74 2580.92,-9190.4 2588.99,-9197.27 2591.51,-9190.74"/>
</g>
<!-- output_proj_0_0 -->
<g id="node284" class="node">
<title>output_proj_0_0</title>
<ellipse fill="orange" stroke="black" cx="7662.57" cy="-8947.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="7662.57" y="-8966.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7662.57" y="-8951.02" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="7662.57" y="-8936.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7662.57" y="-8921.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_0&#45;&gt;output_proj_0_0 -->
<g id="edge341" class="edge">
<title>head_group_0_0&#45;&gt;output_proj_0_0</title>
<path fill="none" stroke="black" d="M5514.3,-9045.82C5870.12,-9029.65 7088.26,-8974.31 7514.14,-8954.96"/>
<polygon fill="black" stroke="black" points="7514.53,-8958.45 7524.36,-8954.5 7514.21,-8951.46 7514.53,-8958.45"/>
</g>
<!-- split_q_0_4 -->
<g id="node135" class="node">
<title>split_q_0_4</title>
<ellipse fill="pink" stroke="black" cx="3853.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3853.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="3853.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3853.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_q_0_4 -->
<g id="edge159" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_q_0_4</title>
<path fill="none" stroke="black" d="M4146.64,-10042.83C4089.67,-10026.89 4018.29,-10006.91 3960.24,-9990.66"/>
<polygon fill="black" stroke="black" points="3960.88,-9987.2 3950.31,-9987.88 3958.99,-9993.95 3960.88,-9987.2"/>
</g>
<!-- split_k_0_4 -->
<g id="node136" class="node">
<title>split_k_0_4</title>
<ellipse fill="pink" stroke="black" cx="4162.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="4162.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_k_0_4 -->
<g id="edge160" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_k_0_4</title>
<path fill="none" stroke="black" d="M4219.07,-10034.79C4211.82,-10025.29 4203.91,-10014.93 4196.37,-10005.06"/>
<polygon fill="black" stroke="black" points="4198.99,-10002.73 4190.14,-9996.9 4193.43,-10006.97 4198.99,-10002.73"/>
</g>
<!-- split_v_0_4 -->
<g id="node137" class="node">
<title>split_v_0_4</title>
<ellipse fill="pink" stroke="black" cx="4471.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="4471.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_v_0_4 -->
<g id="edge161" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_v_0_4</title>
<path fill="none" stroke="black" d="M4314.08,-10037.8C4339.9,-10025.18 4369.51,-10010.7 4396.03,-9997.73"/>
<polygon fill="black" stroke="black" points="4397.83,-10000.75 4405.28,-9993.22 4394.75,-9994.46 4397.83,-10000.75"/>
</g>
<!-- transpose_q_0_4 -->
<g id="node138" class="node">
<title>transpose_q_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="3853.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3853.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="3853.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3853.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_4&#45;&gt;transpose_q_0_4 -->
<g id="edge162" class="edge">
<title>split_q_0_4&#45;&gt;transpose_q_0_4</title>
<path fill="none" stroke="black" d="M3853.57,-9922.18C3853.57,-9913.73 3853.57,-9904.63 3853.57,-9895.81"/>
<polygon fill="black" stroke="black" points="3857.07,-9895.65 3853.57,-9885.65 3850.07,-9895.65 3857.07,-9895.65"/>
</g>
<!-- transpose_k_0_4 -->
<g id="node139" class="node">
<title>transpose_k_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4162.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="4162.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_4&#45;&gt;transpose_k_0_4 -->
<g id="edge163" class="edge">
<title>split_k_0_4&#45;&gt;transpose_k_0_4</title>
<path fill="none" stroke="black" d="M4162.57,-9922.18C4162.57,-9913.73 4162.57,-9904.63 4162.57,-9895.81"/>
<polygon fill="black" stroke="black" points="4166.07,-9895.65 4162.57,-9885.65 4159.07,-9895.65 4166.07,-9895.65"/>
</g>
<!-- transpose_v_0_4 -->
<g id="node140" class="node">
<title>transpose_v_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4471.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="4471.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_4&#45;&gt;transpose_v_0_4 -->
<g id="edge164" class="edge">
<title>split_v_0_4&#45;&gt;transpose_v_0_4</title>
<path fill="none" stroke="black" d="M4471.57,-9922.18C4471.57,-9913.73 4471.57,-9904.63 4471.57,-9895.81"/>
<polygon fill="black" stroke="black" points="4475.07,-9895.65 4471.57,-9885.65 4468.07,-9895.65 4475.07,-9895.65"/>
</g>
<!-- attn_scores_0_4 -->
<g id="node141" class="node">
<title>attn_scores_0_4</title>
<ellipse fill="gold" stroke="black" cx="4162.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4162.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_4&#45;&gt;attn_scores_0_4 -->
<g id="edge165" class="edge">
<title>transpose_q_0_4&#45;&gt;attn_scores_0_4</title>
<path fill="none" stroke="black" d="M3937.19,-9817.04C3976.91,-9802.9 4024.6,-9785.92 4065.86,-9771.23"/>
<polygon fill="black" stroke="black" points="4067.13,-9774.49 4075.38,-9767.84 4064.79,-9767.9 4067.13,-9774.49"/>
</g>
<!-- transpose_k_0_4&#45;&gt;attn_scores_0_4 -->
<g id="edge166" class="edge">
<title>transpose_k_0_4&#45;&gt;attn_scores_0_4</title>
<path fill="none" stroke="black" d="M4162.57,-9810.18C4162.57,-9801.73 4162.57,-9792.63 4162.57,-9783.81"/>
<polygon fill="black" stroke="black" points="4166.07,-9783.65 4162.57,-9773.65 4159.07,-9783.65 4166.07,-9783.65"/>
</g>
<!-- attn_output_0_4 -->
<g id="node142" class="node">
<title>attn_output_0_4</title>
<ellipse fill="gold" stroke="black" cx="4471.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4471.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_4&#45;&gt;attn_output_0_4 -->
<g id="edge167" class="edge">
<title>transpose_v_0_4&#45;&gt;attn_output_0_4</title>
<path fill="none" stroke="black" d="M4471.57,-9810.1C4471.57,-9749.06 4471.57,-9626.75 4471.57,-9559.6"/>
<polygon fill="black" stroke="black" points="4475.07,-9559.31 4471.57,-9549.31 4468.07,-9559.31 4475.07,-9559.31"/>
</g>
<!-- softmax_0_4 -->
<g id="node143" class="node">
<title>softmax_0_4</title>
<ellipse fill="gold" stroke="black" cx="4219.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="4219.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4219.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4219.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_4&#45;&gt;softmax_0_4 -->
<g id="edge168" class="edge">
<title>attn_scores_0_4&#45;&gt;softmax_0_4</title>
<path fill="none" stroke="black" d="M4181.4,-9698.48C4186.11,-9689.38 4191.23,-9679.5 4196.15,-9670.02"/>
<polygon fill="black" stroke="black" points="4199.28,-9671.58 4200.77,-9661.09 4193.06,-9668.36 4199.28,-9671.58"/>
</g>
<!-- transpose_back_0_4 -->
<g id="node144" class="node">
<title>transpose_back_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4867.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4867.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="4867.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4867.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_4&#45;&gt;transpose_back_0_4 -->
<g id="edge170" class="edge">
<title>attn_output_0_4&#45;&gt;transpose_back_0_4</title>
<path fill="none" stroke="black" d="M4568.7,-9483.82C4626.83,-9467.68 4700.8,-9447.13 4760.6,-9430.52"/>
<polygon fill="black" stroke="black" points="4761.75,-9433.83 4770.45,-9427.78 4759.88,-9427.09 4761.75,-9433.83"/>
</g>
<!-- softmax_0_4&#45;&gt;attn_output_0_4 -->
<g id="edge169" class="edge">
<title>softmax_0_4&#45;&gt;attn_output_0_4</title>
<path fill="none" stroke="black" d="M4294.16,-9590.25C4324.15,-9577.16 4358.83,-9562.02 4389.52,-9548.62"/>
<polygon fill="black" stroke="black" points="4391.15,-9551.73 4398.91,-9544.52 4388.35,-9545.31 4391.15,-9551.73"/>
</g>
<!-- reshape_concat_0_4 -->
<g id="node145" class="node">
<title>reshape_concat_0_4</title>
<ellipse fill="lightcyan" stroke="black" cx="5123.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="5123.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="5123.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="5123.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_4&#45;&gt;reshape_concat_0_4 -->
<g id="edge171" class="edge">
<title>transpose_back_0_4&#45;&gt;reshape_concat_0_4</title>
<path fill="none" stroke="black" d="M4940.93,-9367.28C4972.67,-9353.65 5009.92,-9337.64 5042.48,-9323.65"/>
<polygon fill="black" stroke="black" points="5044.16,-9326.73 5051.97,-9319.57 5041.4,-9320.3 5044.16,-9326.73"/>
</g>
<!-- allgather_dim_0_1 -->
<g id="node146" class="node">
<title>allgather_dim_0_1</title>
<polygon fill="red" stroke="black" points="6102.57,-9213.3 5929.57,-9160.3 6102.57,-9107.3 6275.57,-9160.3 6102.57,-9213.3"/>
<text text-anchor="middle" x="6102.57" y="-9171.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="6102.57" y="-9156.6" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6102.57" y="-9141.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_4&#45;&gt;allgather_dim_0_1 -->
<g id="edge172" class="edge">
<title>reshape_concat_0_4&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M5243.62,-9271.42C5428.59,-9247.7 5781.83,-9202.42 5972.61,-9177.96"/>
<polygon fill="black" stroke="black" points="5973.22,-9181.41 5982.7,-9176.67 5972.33,-9174.47 5973.22,-9181.41"/>
</g>
<!-- head_group_0_1 -->
<g id="node183" class="node">
<title>head_group_0_1</title>
<polygon fill="lightyellow" stroke="black" points="6732.07,-9070.3 6535.07,-9070.3 6535.07,-9032.3 6732.07,-9032.3 6732.07,-9070.3"/>
<text text-anchor="middle" x="6633.57" y="-9055.1" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6633.57" y="-9040.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_1&#45;&gt;head_group_0_1 -->
<g id="edge218" class="edge">
<title>allgather_dim_0_1&#45;&gt;head_group_0_1</title>
<path fill="none" stroke="black" d="M6205.27,-9138.61C6300.1,-9119.5 6440.06,-9091.3 6533.91,-9072.39"/>
<polygon fill="black" stroke="black" points="6534.87,-9075.76 6543.98,-9070.36 6533.49,-9068.9 6534.87,-9075.76"/>
</g>
<!-- split_q_0_5 -->
<g id="node148" class="node">
<title>split_q_0_5</title>
<ellipse fill="pink" stroke="black" cx="4780.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4780.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="4780.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4780.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_q_0_5 -->
<g id="edge174" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_q_0_5</title>
<path fill="none" stroke="black" d="M5103.87,-10043.89C5039.61,-10027.38 4957.37,-10006.24 4891.92,-9989.42"/>
<polygon fill="black" stroke="black" points="4892.54,-9985.97 4881.98,-9986.87 4890.79,-9992.75 4892.54,-9985.97"/>
</g>
<!-- split_k_0_5 -->
<g id="node149" class="node">
<title>split_k_0_5</title>
<ellipse fill="pink" stroke="black" cx="5089.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="5089.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_k_0_5 -->
<g id="edge175" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_k_0_5</title>
<path fill="none" stroke="black" d="M5170.27,-10035.39C5159.12,-10025.09 5146.83,-10013.73 5135.28,-10003.05"/>
<polygon fill="black" stroke="black" points="5137.53,-10000.37 5127.81,-9996.15 5132.78,-10005.51 5137.53,-10000.37"/>
</g>
<!-- split_v_0_5 -->
<g id="node150" class="node">
<title>split_v_0_5</title>
<ellipse fill="pink" stroke="black" cx="5398.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="5398.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_v_0_5 -->
<g id="edge176" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_v_0_5</title>
<path fill="none" stroke="black" d="M5267.13,-10036.9C5287.55,-10025.08 5310.61,-10011.73 5331.66,-9999.55"/>
<polygon fill="black" stroke="black" points="5333.64,-10002.44 5340.54,-9994.4 5330.13,-9996.39 5333.64,-10002.44"/>
</g>
<!-- transpose_q_0_5 -->
<g id="node151" class="node">
<title>transpose_q_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="4780.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4780.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="4780.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4780.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_5&#45;&gt;transpose_q_0_5 -->
<g id="edge177" class="edge">
<title>split_q_0_5&#45;&gt;transpose_q_0_5</title>
<path fill="none" stroke="black" d="M4780.57,-9922.18C4780.57,-9913.73 4780.57,-9904.63 4780.57,-9895.81"/>
<polygon fill="black" stroke="black" points="4784.07,-9895.65 4780.57,-9885.65 4777.07,-9895.65 4784.07,-9895.65"/>
</g>
<!-- transpose_k_0_5 -->
<g id="node152" class="node">
<title>transpose_k_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5089.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="5089.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_5&#45;&gt;transpose_k_0_5 -->
<g id="edge178" class="edge">
<title>split_k_0_5&#45;&gt;transpose_k_0_5</title>
<path fill="none" stroke="black" d="M5089.57,-9922.18C5089.57,-9913.73 5089.57,-9904.63 5089.57,-9895.81"/>
<polygon fill="black" stroke="black" points="5093.07,-9895.65 5089.57,-9885.65 5086.07,-9895.65 5093.07,-9895.65"/>
</g>
<!-- transpose_v_0_5 -->
<g id="node153" class="node">
<title>transpose_v_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5398.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="5398.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_5&#45;&gt;transpose_v_0_5 -->
<g id="edge179" class="edge">
<title>split_v_0_5&#45;&gt;transpose_v_0_5</title>
<path fill="none" stroke="black" d="M5398.57,-9922.18C5398.57,-9913.73 5398.57,-9904.63 5398.57,-9895.81"/>
<polygon fill="black" stroke="black" points="5402.07,-9895.65 5398.57,-9885.65 5395.07,-9895.65 5402.07,-9895.65"/>
</g>
<!-- attn_scores_0_5 -->
<g id="node154" class="node">
<title>attn_scores_0_5</title>
<ellipse fill="gold" stroke="black" cx="5089.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5089.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_5&#45;&gt;attn_scores_0_5 -->
<g id="edge180" class="edge">
<title>transpose_q_0_5&#45;&gt;attn_scores_0_5</title>
<path fill="none" stroke="black" d="M4864.19,-9817.04C4903.91,-9802.9 4951.6,-9785.92 4992.86,-9771.23"/>
<polygon fill="black" stroke="black" points="4994.13,-9774.49 5002.38,-9767.84 4991.79,-9767.9 4994.13,-9774.49"/>
</g>
<!-- transpose_k_0_5&#45;&gt;attn_scores_0_5 -->
<g id="edge181" class="edge">
<title>transpose_k_0_5&#45;&gt;attn_scores_0_5</title>
<path fill="none" stroke="black" d="M5089.57,-9810.18C5089.57,-9801.73 5089.57,-9792.63 5089.57,-9783.81"/>
<polygon fill="black" stroke="black" points="5093.07,-9783.65 5089.57,-9773.65 5086.07,-9783.65 5093.07,-9783.65"/>
</g>
<!-- attn_output_0_5 -->
<g id="node155" class="node">
<title>attn_output_0_5</title>
<ellipse fill="gold" stroke="black" cx="5398.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5398.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_5&#45;&gt;attn_output_0_5 -->
<g id="edge182" class="edge">
<title>transpose_v_0_5&#45;&gt;attn_output_0_5</title>
<path fill="none" stroke="black" d="M5398.57,-9810.1C5398.57,-9749.06 5398.57,-9626.75 5398.57,-9559.6"/>
<polygon fill="black" stroke="black" points="5402.07,-9559.31 5398.57,-9549.31 5395.07,-9559.31 5402.07,-9559.31"/>
</g>
<!-- softmax_0_5 -->
<g id="node156" class="node">
<title>softmax_0_5</title>
<ellipse fill="gold" stroke="black" cx="5146.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="5146.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5146.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5146.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_5&#45;&gt;softmax_0_5 -->
<g id="edge183" class="edge">
<title>attn_scores_0_5&#45;&gt;softmax_0_5</title>
<path fill="none" stroke="black" d="M5108.4,-9698.48C5113.11,-9689.38 5118.23,-9679.5 5123.15,-9670.02"/>
<polygon fill="black" stroke="black" points="5126.28,-9671.58 5127.77,-9661.09 5120.06,-9668.36 5126.28,-9671.58"/>
</g>
<!-- transpose_back_0_5 -->
<g id="node157" class="node">
<title>transpose_back_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5639.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5639.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="5639.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5639.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_5&#45;&gt;transpose_back_0_5 -->
<g id="edge185" class="edge">
<title>attn_output_0_5&#45;&gt;transpose_back_0_5</title>
<path fill="none" stroke="black" d="M5468.6,-9478.84C5497.2,-9465.79 5530.42,-9450.63 5559.93,-9437.16"/>
<polygon fill="black" stroke="black" points="5561.72,-9440.18 5569.37,-9432.85 5558.82,-9433.82 5561.72,-9440.18"/>
</g>
<!-- softmax_0_5&#45;&gt;attn_output_0_5 -->
<g id="edge184" class="edge">
<title>softmax_0_5&#45;&gt;attn_output_0_5</title>
<path fill="none" stroke="black" d="M5221.16,-9590.25C5251.15,-9577.16 5285.83,-9562.02 5316.52,-9548.62"/>
<polygon fill="black" stroke="black" points="5318.15,-9551.73 5325.91,-9544.52 5315.35,-9545.31 5318.15,-9551.73"/>
</g>
<!-- reshape_concat_0_5 -->
<g id="node158" class="node">
<title>reshape_concat_0_5</title>
<ellipse fill="lightcyan" stroke="black" cx="5734.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="5734.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="5734.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5734.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_5&#45;&gt;reshape_concat_0_5 -->
<g id="edge186" class="edge">
<title>transpose_back_0_5&#45;&gt;reshape_concat_0_5</title>
<path fill="none" stroke="black" d="M5670.42,-9363.09C5678.97,-9353.19 5688.34,-9342.34 5697.21,-9332.06"/>
<polygon fill="black" stroke="black" points="5700,-9334.19 5703.88,-9324.34 5694.7,-9329.62 5700,-9334.19"/>
</g>
<!-- reshape_concat_0_5&#45;&gt;allgather_dim_0_1 -->
<g id="edge187" class="edge">
<title>reshape_concat_0_5&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M5817.62,-9258.48C5875.55,-9238.73 5952.82,-9212.37 6012.29,-9192.1"/>
<polygon fill="black" stroke="black" points="6013.71,-9195.31 6022.04,-9188.77 6011.45,-9188.68 6013.71,-9195.31"/>
</g>
<!-- split_q_0_6 -->
<g id="node160" class="node">
<title>split_q_0_6</title>
<ellipse fill="pink" stroke="black" cx="5707.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5707.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="5707.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="5707.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_q_0_6 -->
<g id="edge189" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_q_0_6</title>
<path fill="none" stroke="black" d="M6123.87,-10048.7C6048,-10034.78 5948.97,-10015.97 5861.57,-9997.3 5848.6,-9994.53 5835.04,-9991.51 5821.58,-9988.43"/>
<polygon fill="black" stroke="black" points="5822.34,-9985.01 5811.81,-9986.17 5820.77,-9991.83 5822.34,-9985.01"/>
</g>
<!-- split_k_0_6 -->
<g id="node161" class="node">
<title>split_k_0_6</title>
<ellipse fill="pink" stroke="black" cx="6016.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="6016.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_k_0_6 -->
<g id="edge190" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_k_0_6</title>
<path fill="none" stroke="black" d="M6178.89,-10038.1C6152.13,-10025.35 6121.32,-10010.69 6093.79,-9997.58"/>
<polygon fill="black" stroke="black" points="6095.13,-9994.33 6084.59,-9993.19 6092.12,-10000.65 6095.13,-9994.33"/>
</g>
<!-- split_v_0_6 -->
<g id="node162" class="node">
<title>split_v_0_6</title>
<ellipse fill="pink" stroke="black" cx="6325.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6325.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="6325.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6325.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_v_0_6 -->
<g id="edge191" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_v_0_6</title>
<path fill="none" stroke="black" d="M6273.11,-10034.79C6279.78,-10025.38 6287.04,-10015.14 6293.98,-10005.35"/>
<polygon fill="black" stroke="black" points="6297.05,-10007.08 6299.98,-9996.9 6291.34,-10003.04 6297.05,-10007.08"/>
</g>
<!-- transpose_q_0_6 -->
<g id="node163" class="node">
<title>transpose_q_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="5707.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5707.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="5707.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="5707.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_6&#45;&gt;transpose_q_0_6 -->
<g id="edge192" class="edge">
<title>split_q_0_6&#45;&gt;transpose_q_0_6</title>
<path fill="none" stroke="black" d="M5707.57,-9922.18C5707.57,-9913.73 5707.57,-9904.63 5707.57,-9895.81"/>
<polygon fill="black" stroke="black" points="5711.07,-9895.65 5707.57,-9885.65 5704.07,-9895.65 5711.07,-9895.65"/>
</g>
<!-- transpose_k_0_6 -->
<g id="node164" class="node">
<title>transpose_k_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6016.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="6016.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_6&#45;&gt;transpose_k_0_6 -->
<g id="edge193" class="edge">
<title>split_k_0_6&#45;&gt;transpose_k_0_6</title>
<path fill="none" stroke="black" d="M6016.57,-9922.18C6016.57,-9913.73 6016.57,-9904.63 6016.57,-9895.81"/>
<polygon fill="black" stroke="black" points="6020.07,-9895.65 6016.57,-9885.65 6013.07,-9895.65 6020.07,-9895.65"/>
</g>
<!-- transpose_v_0_6 -->
<g id="node165" class="node">
<title>transpose_v_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6325.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6325.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="6325.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6325.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_6&#45;&gt;transpose_v_0_6 -->
<g id="edge194" class="edge">
<title>split_v_0_6&#45;&gt;transpose_v_0_6</title>
<path fill="none" stroke="black" d="M6325.57,-9922.18C6325.57,-9913.73 6325.57,-9904.63 6325.57,-9895.81"/>
<polygon fill="black" stroke="black" points="6329.07,-9895.65 6325.57,-9885.65 6322.07,-9895.65 6329.07,-9895.65"/>
</g>
<!-- attn_scores_0_6 -->
<g id="node166" class="node">
<title>attn_scores_0_6</title>
<ellipse fill="gold" stroke="black" cx="6016.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6016.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_6&#45;&gt;attn_scores_0_6 -->
<g id="edge195" class="edge">
<title>transpose_q_0_6&#45;&gt;attn_scores_0_6</title>
<path fill="none" stroke="black" d="M5791.19,-9817.04C5830.91,-9802.9 5878.6,-9785.92 5919.86,-9771.23"/>
<polygon fill="black" stroke="black" points="5921.13,-9774.49 5929.38,-9767.84 5918.79,-9767.9 5921.13,-9774.49"/>
</g>
<!-- transpose_k_0_6&#45;&gt;attn_scores_0_6 -->
<g id="edge196" class="edge">
<title>transpose_k_0_6&#45;&gt;attn_scores_0_6</title>
<path fill="none" stroke="black" d="M6016.57,-9810.18C6016.57,-9801.73 6016.57,-9792.63 6016.57,-9783.81"/>
<polygon fill="black" stroke="black" points="6020.07,-9783.65 6016.57,-9773.65 6013.07,-9783.65 6020.07,-9783.65"/>
</g>
<!-- attn_output_0_6 -->
<g id="node167" class="node">
<title>attn_output_0_6</title>
<ellipse fill="gold" stroke="black" cx="6102.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6102.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6102.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6102.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_6&#45;&gt;attn_output_0_6 -->
<g id="edge197" class="edge">
<title>transpose_v_0_6&#45;&gt;attn_output_0_6</title>
<path fill="none" stroke="black" d="M6312.97,-9810.27C6293.41,-9757.11 6251.96,-9657.08 6194.57,-9586.3 6184.96,-9574.45 6173.13,-9563.26 6161.2,-9553.35"/>
<polygon fill="black" stroke="black" points="6163.34,-9550.59 6153.36,-9547.04 6158.95,-9556.04 6163.34,-9550.59"/>
</g>
<!-- softmax_0_6 -->
<g id="node168" class="node">
<title>softmax_0_6</title>
<ellipse fill="gold" stroke="black" cx="6018.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6018.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6018.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6018.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_6&#45;&gt;softmax_0_6 -->
<g id="edge198" class="edge">
<title>attn_scores_0_6&#45;&gt;softmax_0_6</title>
<path fill="none" stroke="black" d="M6017.24,-9698.18C6017.39,-9689.73 6017.56,-9680.63 6017.72,-9671.81"/>
<polygon fill="black" stroke="black" points="6021.22,-9671.71 6017.9,-9661.65 6014.22,-9671.58 6021.22,-9671.71"/>
</g>
<!-- transpose_back_0_6 -->
<g id="node169" class="node">
<title>transpose_back_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6102.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6102.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="6102.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6102.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_6&#45;&gt;transpose_back_0_6 -->
<g id="edge200" class="edge">
<title>attn_output_0_6&#45;&gt;transpose_back_0_6</title>
<path fill="none" stroke="black" d="M6102.57,-9474.18C6102.57,-9465.73 6102.57,-9456.63 6102.57,-9447.81"/>
<polygon fill="black" stroke="black" points="6106.07,-9447.65 6102.57,-9437.65 6099.07,-9447.65 6106.07,-9447.65"/>
</g>
<!-- softmax_0_6&#45;&gt;attn_output_0_6 -->
<g id="edge199" class="edge">
<title>softmax_0_6&#45;&gt;attn_output_0_6</title>
<path fill="none" stroke="black" d="M6046.08,-9586.79C6053.33,-9577.29 6061.24,-9566.93 6068.78,-9557.06"/>
<polygon fill="black" stroke="black" points="6071.72,-9558.97 6075.01,-9548.9 6066.16,-9554.73 6071.72,-9558.97"/>
</g>
<!-- reshape_concat_0_6 -->
<g id="node170" class="node">
<title>reshape_concat_0_6</title>
<ellipse fill="lightcyan" stroke="black" cx="6102.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="6102.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="6102.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6102.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_6&#45;&gt;reshape_concat_0_6 -->
<g id="edge201" class="edge">
<title>transpose_back_0_6&#45;&gt;reshape_concat_0_6</title>
<path fill="none" stroke="black" d="M6102.57,-9362.18C6102.57,-9353.73 6102.57,-9344.63 6102.57,-9335.81"/>
<polygon fill="black" stroke="black" points="6106.07,-9335.65 6102.57,-9325.65 6099.07,-9335.65 6106.07,-9335.65"/>
</g>
<!-- reshape_concat_0_6&#45;&gt;allgather_dim_0_1 -->
<g id="edge202" class="edge">
<title>reshape_concat_0_6&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M6102.57,-9250.17C6102.57,-9241.86 6102.57,-9232.81 6102.57,-9223.77"/>
<polygon fill="black" stroke="black" points="6106.07,-9223.61 6102.57,-9213.61 6099.07,-9223.61 6106.07,-9223.61"/>
</g>
<!-- split_q_0_7 -->
<g id="node172" class="node">
<title>split_q_0_7</title>
<ellipse fill="pink" stroke="black" cx="6634.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6634.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="6634.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6634.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_q_0_7 -->
<g id="edge204" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_q_0_7</title>
<path fill="none" stroke="black" d="M7036.86,-10047.9C6964.68,-10033.92 6871.22,-10015.32 6788.57,-9997.3 6775.61,-9994.48 6762.06,-9991.42 6748.61,-9988.32"/>
<polygon fill="black" stroke="black" points="6749.37,-9984.9 6738.83,-9986.05 6747.79,-9991.72 6749.37,-9984.9"/>
</g>
<!-- split_k_0_7 -->
<g id="node173" class="node">
<title>split_k_0_7</title>
<ellipse fill="pink" stroke="black" cx="6943.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6943.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="6943.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6943.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_k_0_7 -->
<g id="edge205" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_k_0_7</title>
<path fill="none" stroke="black" d="M7092.79,-10037.5C7068.68,-10025.11 7041.17,-10010.97 7016.4,-9998.24"/>
<polygon fill="black" stroke="black" points="7017.9,-9995.07 7007.4,-9993.61 7014.7,-10001.3 7017.9,-9995.07"/>
</g>
<!-- split_v_0_7 -->
<g id="node174" class="node">
<title>split_v_0_7</title>
<ellipse fill="pink" stroke="black" cx="7252.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7252.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="7252.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7252.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_v_0_7 -->
<g id="edge206" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_v_0_7</title>
<path fill="none" stroke="black" d="M7188.68,-10034.79C7197.13,-10025 7206.37,-10014.3 7215.14,-10004.15"/>
<polygon fill="black" stroke="black" points="7217.83,-10006.38 7221.72,-9996.53 7212.54,-10001.81 7217.83,-10006.38"/>
</g>
<!-- transpose_q_0_7 -->
<g id="node175" class="node">
<title>transpose_q_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6634.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6634.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="6634.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6634.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_7&#45;&gt;transpose_q_0_7 -->
<g id="edge207" class="edge">
<title>split_q_0_7&#45;&gt;transpose_q_0_7</title>
<path fill="none" stroke="black" d="M6634.57,-9922.18C6634.57,-9913.73 6634.57,-9904.63 6634.57,-9895.81"/>
<polygon fill="black" stroke="black" points="6638.07,-9895.65 6634.57,-9885.65 6631.07,-9895.65 6638.07,-9895.65"/>
</g>
<!-- transpose_k_0_7 -->
<g id="node176" class="node">
<title>transpose_k_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6943.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6943.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="6943.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6943.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_7&#45;&gt;transpose_k_0_7 -->
<g id="edge208" class="edge">
<title>split_k_0_7&#45;&gt;transpose_k_0_7</title>
<path fill="none" stroke="black" d="M6943.57,-9922.18C6943.57,-9913.73 6943.57,-9904.63 6943.57,-9895.81"/>
<polygon fill="black" stroke="black" points="6947.07,-9895.65 6943.57,-9885.65 6940.07,-9895.65 6947.07,-9895.65"/>
</g>
<!-- transpose_v_0_7 -->
<g id="node177" class="node">
<title>transpose_v_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="7252.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7252.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="7252.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7252.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_7&#45;&gt;transpose_v_0_7 -->
<g id="edge209" class="edge">
<title>split_v_0_7&#45;&gt;transpose_v_0_7</title>
<path fill="none" stroke="black" d="M7252.57,-9922.18C7252.57,-9913.73 7252.57,-9904.63 7252.57,-9895.81"/>
<polygon fill="black" stroke="black" points="7256.07,-9895.65 7252.57,-9885.65 7249.07,-9895.65 7256.07,-9895.65"/>
</g>
<!-- attn_scores_0_7 -->
<g id="node178" class="node">
<title>attn_scores_0_7</title>
<ellipse fill="gold" stroke="black" cx="6938.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6938.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6938.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6938.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_7&#45;&gt;attn_scores_0_7 -->
<g id="edge210" class="edge">
<title>transpose_q_0_7&#45;&gt;attn_scores_0_7</title>
<path fill="none" stroke="black" d="M6717.24,-9816.89C6756.06,-9802.84 6802.56,-9786.02 6842.9,-9771.42"/>
<polygon fill="black" stroke="black" points="6844.26,-9774.65 6852.47,-9767.96 6841.88,-9768.07 6844.26,-9774.65"/>
</g>
<!-- transpose_k_0_7&#45;&gt;attn_scores_0_7 -->
<g id="edge211" class="edge">
<title>transpose_k_0_7&#45;&gt;attn_scores_0_7</title>
<path fill="none" stroke="black" d="M6941.91,-9810.18C6941.52,-9801.73 6941.11,-9792.63 6940.71,-9783.81"/>
<polygon fill="black" stroke="black" points="6944.2,-9783.48 6940.25,-9773.65 6937.21,-9783.8 6944.2,-9783.48"/>
</g>
<!-- attn_output_0_7 -->
<g id="node179" class="node">
<title>attn_output_0_7</title>
<ellipse fill="gold" stroke="black" cx="6938.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6938.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6938.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6938.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_7&#45;&gt;attn_output_0_7 -->
<g id="edge212" class="edge">
<title>transpose_v_0_7&#45;&gt;attn_output_0_7</title>
<path fill="none" stroke="black" d="M7242.04,-9810.28C7224.33,-9754.84 7183.57,-9649.26 7114.57,-9586.3 7094.84,-9568.3 7070.05,-9554.34 7045.37,-9543.66"/>
<polygon fill="black" stroke="black" points="7046.5,-9540.34 7035.93,-9539.73 7043.81,-9546.81 7046.5,-9540.34"/>
</g>
<!-- softmax_0_7 -->
<g id="node180" class="node">
<title>softmax_0_7</title>
<ellipse fill="gold" stroke="black" cx="6938.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6938.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6938.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6938.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_7&#45;&gt;softmax_0_7 -->
<g id="edge213" class="edge">
<title>attn_scores_0_7&#45;&gt;softmax_0_7</title>
<path fill="none" stroke="black" d="M6938.57,-9698.18C6938.57,-9689.73 6938.57,-9680.63 6938.57,-9671.81"/>
<polygon fill="black" stroke="black" points="6942.07,-9671.65 6938.57,-9661.65 6935.07,-9671.65 6942.07,-9671.65"/>
</g>
<!-- transpose_back_0_7 -->
<g id="node181" class="node">
<title>transpose_back_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6818.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6818.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="6818.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6818.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_7&#45;&gt;transpose_back_0_7 -->
<g id="edge215" class="edge">
<title>attn_output_0_7&#45;&gt;transpose_back_0_7</title>
<path fill="none" stroke="black" d="M6899.94,-9475.39C6888.7,-9465.09 6876.31,-9453.73 6864.66,-9443.05"/>
<polygon fill="black" stroke="black" points="6866.87,-9440.33 6857.13,-9436.15 6862.14,-9445.49 6866.87,-9440.33"/>
</g>
<!-- softmax_0_7&#45;&gt;attn_output_0_7 -->
<g id="edge214" class="edge">
<title>softmax_0_7&#45;&gt;attn_output_0_7</title>
<path fill="none" stroke="black" d="M6938.57,-9586.18C6938.57,-9577.73 6938.57,-9568.63 6938.57,-9559.81"/>
<polygon fill="black" stroke="black" points="6942.07,-9559.65 6938.57,-9549.65 6935.07,-9559.65 6942.07,-9559.65"/>
</g>
<!-- reshape_concat_0_7 -->
<g id="node182" class="node">
<title>reshape_concat_0_7</title>
<ellipse fill="lightcyan" stroke="black" cx="6579.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="6579.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="6579.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6579.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_7&#45;&gt;reshape_concat_0_7 -->
<g id="edge216" class="edge">
<title>transpose_back_0_7&#45;&gt;reshape_concat_0_7</title>
<path fill="none" stroke="black" d="M6749.12,-9366.84C6720.15,-9353.5 6686.38,-9337.96 6656.64,-9324.27"/>
<polygon fill="black" stroke="black" points="6658.09,-9321.09 6647.55,-9320.09 6655.17,-9327.45 6658.09,-9321.09"/>
</g>
<!-- reshape_concat_0_7&#45;&gt;allgather_dim_0_1 -->
<g id="edge217" class="edge">
<title>reshape_concat_0_7&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M6483.91,-9261.63C6402.76,-9240.28 6286.69,-9209.74 6203.95,-9187.98"/>
<polygon fill="black" stroke="black" points="6204.6,-9184.53 6194.03,-9185.37 6202.82,-9191.3 6204.6,-9184.53"/>
</g>
<!-- output_proj_0_1 -->
<g id="node285" class="node">
<title>output_proj_0_1</title>
<ellipse fill="orange" stroke="black" cx="8334.57" cy="-8947.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="8334.57" y="-8966.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8334.57" y="-8951.02" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8334.57" y="-8936.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8334.57" y="-8921.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_1&#45;&gt;output_proj_0_1 -->
<g id="edge342" class="edge">
<title>head_group_0_1&#45;&gt;output_proj_0_1</title>
<path fill="none" stroke="black" d="M6732.08,-9047.13C6934.35,-9040.3 7411.07,-9022.57 7810.57,-8995.3 7939.57,-8986.5 8086.13,-8973.03 8191.38,-8962.76"/>
<polygon fill="black" stroke="black" points="8191.83,-8966.23 8201.44,-8961.77 8191.15,-8959.26 8191.83,-8966.23"/>
</g>
<!-- split_q_0_8 -->
<g id="node185" class="node">
<title>split_q_0_8</title>
<ellipse fill="pink" stroke="black" cx="7561.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7561.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7561.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7561.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_q_0_8 -->
<g id="edge220" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_q_0_8</title>
<path fill="none" stroke="black" d="M7916.2,-10044.87C7844.29,-10027.83 7750.33,-10005.55 7677.2,-9988.21"/>
<polygon fill="black" stroke="black" points="7677.56,-9984.7 7667.02,-9985.8 7675.94,-9991.51 7677.56,-9984.7"/>
</g>
<!-- split_k_0_8 -->
<g id="node186" class="node">
<title>split_k_0_8</title>
<ellipse fill="pink" stroke="black" cx="7870.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="7870.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_k_0_8 -->
<g id="edge221" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_k_0_8</title>
<path fill="none" stroke="black" d="M7976.53,-10036C7960.9,-10024.9 7943.47,-10012.54 7927.33,-10001.09"/>
<polygon fill="black" stroke="black" points="7929.21,-9998.13 7919.03,-9995.19 7925.16,-10003.84 7929.21,-9998.13"/>
</g>
<!-- split_v_0_8 -->
<g id="node187" class="node">
<title>split_v_0_8</title>
<ellipse fill="pink" stroke="black" cx="8179.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8179.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_v_0_8 -->
<g id="edge222" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_v_0_8</title>
<path fill="none" stroke="black" d="M8074.3,-10036C8089.83,-10024.9 8107.15,-10012.54 8123.18,-10001.09"/>
<polygon fill="black" stroke="black" points="8125.32,-10003.85 8131.43,-9995.19 8121.26,-9998.16 8125.32,-10003.85"/>
</g>
<!-- transpose_q_0_8 -->
<g id="node188" class="node">
<title>transpose_q_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="7561.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7561.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7561.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7561.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_8&#45;&gt;transpose_q_0_8 -->
<g id="edge223" class="edge">
<title>split_q_0_8&#45;&gt;transpose_q_0_8</title>
<path fill="none" stroke="black" d="M7561.57,-9922.18C7561.57,-9913.73 7561.57,-9904.63 7561.57,-9895.81"/>
<polygon fill="black" stroke="black" points="7565.07,-9895.65 7561.57,-9885.65 7558.07,-9895.65 7565.07,-9895.65"/>
</g>
<!-- transpose_k_0_8 -->
<g id="node189" class="node">
<title>transpose_k_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="7870.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="7870.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_8&#45;&gt;transpose_k_0_8 -->
<g id="edge224" class="edge">
<title>split_k_0_8&#45;&gt;transpose_k_0_8</title>
<path fill="none" stroke="black" d="M7870.57,-9922.18C7870.57,-9913.73 7870.57,-9904.63 7870.57,-9895.81"/>
<polygon fill="black" stroke="black" points="7874.07,-9895.65 7870.57,-9885.65 7867.07,-9895.65 7874.07,-9895.65"/>
</g>
<!-- transpose_v_0_8 -->
<g id="node190" class="node">
<title>transpose_v_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="8179.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8179.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_8&#45;&gt;transpose_v_0_8 -->
<g id="edge225" class="edge">
<title>split_v_0_8&#45;&gt;transpose_v_0_8</title>
<path fill="none" stroke="black" d="M8179.57,-9922.18C8179.57,-9913.73 8179.57,-9904.63 8179.57,-9895.81"/>
<polygon fill="black" stroke="black" points="8183.07,-9895.65 8179.57,-9885.65 8176.07,-9895.65 8183.07,-9895.65"/>
</g>
<!-- attn_scores_0_8 -->
<g id="node191" class="node">
<title>attn_scores_0_8</title>
<ellipse fill="gold" stroke="black" cx="7870.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7870.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_8&#45;&gt;attn_scores_0_8 -->
<g id="edge226" class="edge">
<title>transpose_q_0_8&#45;&gt;attn_scores_0_8</title>
<path fill="none" stroke="black" d="M7645.19,-9817.04C7684.91,-9802.9 7732.6,-9785.92 7773.86,-9771.23"/>
<polygon fill="black" stroke="black" points="7775.13,-9774.49 7783.38,-9767.84 7772.79,-9767.9 7775.13,-9774.49"/>
</g>
<!-- transpose_k_0_8&#45;&gt;attn_scores_0_8 -->
<g id="edge227" class="edge">
<title>transpose_k_0_8&#45;&gt;attn_scores_0_8</title>
<path fill="none" stroke="black" d="M7870.57,-9810.18C7870.57,-9801.73 7870.57,-9792.63 7870.57,-9783.81"/>
<polygon fill="black" stroke="black" points="7874.07,-9783.65 7870.57,-9773.65 7867.07,-9783.65 7874.07,-9783.65"/>
</g>
<!-- attn_output_0_8 -->
<g id="node192" class="node">
<title>attn_output_0_8</title>
<ellipse fill="gold" stroke="black" cx="8179.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8179.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_8&#45;&gt;attn_output_0_8 -->
<g id="edge228" class="edge">
<title>transpose_v_0_8&#45;&gt;attn_output_0_8</title>
<path fill="none" stroke="black" d="M8179.57,-9810.1C8179.57,-9749.06 8179.57,-9626.75 8179.57,-9559.6"/>
<polygon fill="black" stroke="black" points="8183.07,-9559.31 8179.57,-9549.31 8176.07,-9559.31 8183.07,-9559.31"/>
</g>
<!-- softmax_0_8 -->
<g id="node193" class="node">
<title>softmax_0_8</title>
<ellipse fill="gold" stroke="black" cx="7927.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="7927.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7927.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7927.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_8&#45;&gt;softmax_0_8 -->
<g id="edge229" class="edge">
<title>attn_scores_0_8&#45;&gt;softmax_0_8</title>
<path fill="none" stroke="black" d="M7889.4,-9698.48C7894.11,-9689.38 7899.23,-9679.5 7904.15,-9670.02"/>
<polygon fill="black" stroke="black" points="7907.28,-9671.58 7908.77,-9661.09 7901.06,-9668.36 7907.28,-9671.58"/>
</g>
<!-- transpose_back_0_8 -->
<g id="node194" class="node">
<title>transpose_back_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="8416.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8416.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="8416.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8416.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_8&#45;&gt;transpose_back_0_8 -->
<g id="edge231" class="edge">
<title>attn_output_0_8&#45;&gt;transpose_back_0_8</title>
<path fill="none" stroke="black" d="M8248.76,-9478.69C8276.75,-9465.7 8309.2,-9450.64 8338.06,-9437.24"/>
<polygon fill="black" stroke="black" points="8339.7,-9440.34 8347.3,-9432.96 8336.76,-9433.99 8339.7,-9440.34"/>
</g>
<!-- softmax_0_8&#45;&gt;attn_output_0_8 -->
<g id="edge230" class="edge">
<title>softmax_0_8&#45;&gt;attn_output_0_8</title>
<path fill="none" stroke="black" d="M8002.16,-9590.25C8032.15,-9577.16 8066.83,-9562.02 8097.52,-9548.62"/>
<polygon fill="black" stroke="black" points="8099.15,-9551.73 8106.91,-9544.52 8096.35,-9545.31 8099.15,-9551.73"/>
</g>
<!-- reshape_concat_0_8 -->
<g id="node195" class="node">
<title>reshape_concat_0_8</title>
<ellipse fill="lightcyan" stroke="black" cx="8665.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="8665.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="8665.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8665.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_8&#45;&gt;reshape_concat_0_8 -->
<g id="edge232" class="edge">
<title>transpose_back_0_8&#45;&gt;reshape_concat_0_8</title>
<path fill="none" stroke="black" d="M8488.26,-9367.13C8518.86,-9353.62 8554.68,-9337.79 8586.09,-9323.92"/>
<polygon fill="black" stroke="black" points="8587.52,-9327.11 8595.25,-9319.87 8584.69,-9320.71 8587.52,-9327.11"/>
</g>
<!-- allgather_dim_0_2 -->
<g id="node196" class="node">
<title>allgather_dim_0_2</title>
<polygon fill="red" stroke="black" points="9409.57,-9213.3 9236.57,-9160.3 9409.57,-9107.3 9582.57,-9160.3 9409.57,-9213.3"/>
<text text-anchor="middle" x="9409.57" y="-9171.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="9409.57" y="-9156.6" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="9409.57" y="-9141.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_8&#45;&gt;allgather_dim_0_2 -->
<g id="edge233" class="edge">
<title>reshape_concat_0_8&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M8778.17,-9267.81C8916.12,-9244.54 9148.85,-9205.28 9289.94,-9181.48"/>
<polygon fill="black" stroke="black" points="9290.66,-9184.91 9299.94,-9179.8 9289.5,-9178.01 9290.66,-9184.91"/>
</g>
<!-- head_group_0_2 -->
<g id="node233" class="node">
<title>head_group_0_2</title>
<polygon fill="lightyellow" stroke="black" points="9508.07,-9070.3 9311.07,-9070.3 9311.07,-9032.3 9508.07,-9032.3 9508.07,-9070.3"/>
<text text-anchor="middle" x="9409.57" y="-9055.1" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="9409.57" y="-9040.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_2&#45;&gt;head_group_0_2 -->
<g id="edge279" class="edge">
<title>allgather_dim_0_2&#45;&gt;head_group_0_2</title>
<path fill="none" stroke="black" d="M9409.57,-9107.06C9409.57,-9097.91 9409.57,-9088.71 9409.57,-9080.54"/>
<polygon fill="black" stroke="black" points="9413.07,-9080.47 9409.57,-9070.47 9406.07,-9080.47 9413.07,-9080.47"/>
</g>
<!-- split_q_0_9 -->
<g id="node198" class="node">
<title>split_q_0_9</title>
<ellipse fill="pink" stroke="black" cx="8488.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8488.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8488.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8488.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_q_0_9 -->
<g id="edge235" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_q_0_9</title>
<path fill="none" stroke="black" d="M8842.44,-10044.87C8770.68,-10027.83 8676.93,-10005.55 8603.95,-9988.21"/>
<polygon fill="black" stroke="black" points="8604.33,-9984.71 8593.79,-9985.8 8602.71,-9991.52 8604.33,-9984.71"/>
</g>
<!-- split_k_0_9 -->
<g id="node199" class="node">
<title>split_k_0_9</title>
<ellipse fill="pink" stroke="black" cx="8797.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8797.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_k_0_9 -->
<g id="edge236" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_k_0_9</title>
<path fill="none" stroke="black" d="M8902.85,-10036C8887.31,-10024.9 8870,-10012.54 8853.97,-10001.09"/>
<polygon fill="black" stroke="black" points="8855.89,-9998.16 8845.72,-9995.19 8851.82,-10003.85 8855.89,-9998.16"/>
</g>
<!-- split_v_0_9 -->
<g id="node200" class="node">
<title>split_v_0_9</title>
<ellipse fill="pink" stroke="black" cx="9106.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9106.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_v_0_9 -->
<g id="edge237" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_v_0_9</title>
<path fill="none" stroke="black" d="M9000.62,-10036C9016.25,-10024.9 9033.68,-10012.54 9049.81,-10001.09"/>
<polygon fill="black" stroke="black" points="9051.99,-10003.84 9058.11,-9995.19 9047.93,-9998.13 9051.99,-10003.84"/>
</g>
<!-- transpose_q_0_9 -->
<g id="node201" class="node">
<title>transpose_q_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="8488.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8488.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8488.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8488.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_9&#45;&gt;transpose_q_0_9 -->
<g id="edge238" class="edge">
<title>split_q_0_9&#45;&gt;transpose_q_0_9</title>
<path fill="none" stroke="black" d="M8488.57,-9922.18C8488.57,-9913.73 8488.57,-9904.63 8488.57,-9895.81"/>
<polygon fill="black" stroke="black" points="8492.07,-9895.65 8488.57,-9885.65 8485.07,-9895.65 8492.07,-9895.65"/>
</g>
<!-- transpose_k_0_9 -->
<g id="node202" class="node">
<title>transpose_k_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="8797.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8797.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_9&#45;&gt;transpose_k_0_9 -->
<g id="edge239" class="edge">
<title>split_k_0_9&#45;&gt;transpose_k_0_9</title>
<path fill="none" stroke="black" d="M8797.57,-9922.18C8797.57,-9913.73 8797.57,-9904.63 8797.57,-9895.81"/>
<polygon fill="black" stroke="black" points="8801.07,-9895.65 8797.57,-9885.65 8794.07,-9895.65 8801.07,-9895.65"/>
</g>
<!-- transpose_v_0_9 -->
<g id="node203" class="node">
<title>transpose_v_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="9106.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9106.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_9&#45;&gt;transpose_v_0_9 -->
<g id="edge240" class="edge">
<title>split_v_0_9&#45;&gt;transpose_v_0_9</title>
<path fill="none" stroke="black" d="M9106.57,-9922.18C9106.57,-9913.73 9106.57,-9904.63 9106.57,-9895.81"/>
<polygon fill="black" stroke="black" points="9110.07,-9895.65 9106.57,-9885.65 9103.07,-9895.65 9110.07,-9895.65"/>
</g>
<!-- attn_scores_0_9 -->
<g id="node204" class="node">
<title>attn_scores_0_9</title>
<ellipse fill="gold" stroke="black" cx="8797.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8797.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_9&#45;&gt;attn_scores_0_9 -->
<g id="edge241" class="edge">
<title>transpose_q_0_9&#45;&gt;attn_scores_0_9</title>
<path fill="none" stroke="black" d="M8572.19,-9817.04C8611.91,-9802.9 8659.6,-9785.92 8700.86,-9771.23"/>
<polygon fill="black" stroke="black" points="8702.13,-9774.49 8710.38,-9767.84 8699.79,-9767.9 8702.13,-9774.49"/>
</g>
<!-- transpose_k_0_9&#45;&gt;attn_scores_0_9 -->
<g id="edge242" class="edge">
<title>transpose_k_0_9&#45;&gt;attn_scores_0_9</title>
<path fill="none" stroke="black" d="M8797.57,-9810.18C8797.57,-9801.73 8797.57,-9792.63 8797.57,-9783.81"/>
<polygon fill="black" stroke="black" points="8801.07,-9783.65 8797.57,-9773.65 8794.07,-9783.65 8801.07,-9783.65"/>
</g>
<!-- attn_output_0_9 -->
<g id="node205" class="node">
<title>attn_output_0_9</title>
<ellipse fill="gold" stroke="black" cx="9106.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9106.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_9&#45;&gt;attn_output_0_9 -->
<g id="edge243" class="edge">
<title>transpose_v_0_9&#45;&gt;attn_output_0_9</title>
<path fill="none" stroke="black" d="M9106.57,-9810.1C9106.57,-9749.06 9106.57,-9626.75 9106.57,-9559.6"/>
<polygon fill="black" stroke="black" points="9110.07,-9559.31 9106.57,-9549.31 9103.07,-9559.31 9110.07,-9559.31"/>
</g>
<!-- softmax_0_9 -->
<g id="node206" class="node">
<title>softmax_0_9</title>
<ellipse fill="gold" stroke="black" cx="8882.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8882.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8882.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8882.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_9&#45;&gt;softmax_0_9 -->
<g id="edge244" class="edge">
<title>attn_scores_0_9&#45;&gt;softmax_0_9</title>
<path fill="none" stroke="black" d="M8825.41,-9698.79C8832.74,-9689.29 8840.75,-9678.93 8848.38,-9669.06"/>
<polygon fill="black" stroke="black" points="8851.33,-9670.96 8854.68,-9660.9 8845.79,-9666.68 8851.33,-9670.96"/>
</g>
<!-- transpose_back_0_9 -->
<g id="node207" class="node">
<title>transpose_back_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="9188.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9188.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9188.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9188.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_9&#45;&gt;transpose_back_0_9 -->
<g id="edge246" class="edge">
<title>attn_output_0_9&#45;&gt;transpose_back_0_9</title>
<path fill="none" stroke="black" d="M9133.42,-9474.79C9140.5,-9465.29 9148.22,-9454.93 9155.59,-9445.06"/>
<polygon fill="black" stroke="black" points="9158.49,-9447.01 9161.66,-9436.9 9152.88,-9442.83 9158.49,-9447.01"/>
</g>
<!-- softmax_0_9&#45;&gt;attn_output_0_9 -->
<g id="edge245" class="edge">
<title>softmax_0_9&#45;&gt;attn_output_0_9</title>
<path fill="none" stroke="black" d="M8950.39,-9589.5C8975.96,-9576.94 9005.19,-9562.59 9031.4,-9549.72"/>
<polygon fill="black" stroke="black" points="9033.09,-9552.79 9040.53,-9545.24 9030.01,-9546.5 9033.09,-9552.79"/>
</g>
<!-- reshape_concat_0_9 -->
<g id="node208" class="node">
<title>reshape_concat_0_9</title>
<ellipse fill="lightcyan" stroke="black" cx="9274.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9274.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9274.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9274.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_9&#45;&gt;reshape_concat_0_9 -->
<g id="edge247" class="edge">
<title>transpose_back_0_9&#45;&gt;reshape_concat_0_9</title>
<path fill="none" stroke="black" d="M9216.73,-9362.79C9224.31,-9353.1 9232.59,-9342.51 9240.45,-9332.45"/>
<polygon fill="black" stroke="black" points="9243.24,-9334.56 9246.64,-9324.53 9237.73,-9330.25 9243.24,-9334.56"/>
</g>
<!-- reshape_concat_0_9&#45;&gt;allgather_dim_0_2 -->
<g id="edge248" class="edge">
<title>reshape_concat_0_9&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9312.54,-9251.51C9327.15,-9237.93 9344.06,-9222.21 9359.63,-9207.73"/>
<polygon fill="black" stroke="black" points="9362.21,-9210.11 9367.15,-9200.74 9357.44,-9204.99 9362.21,-9210.11"/>
</g>
<!-- split_q_0_10 -->
<g id="node210" class="node">
<title>split_q_0_10</title>
<ellipse fill="pink" stroke="black" cx="9415.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9415.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9415.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9415.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_q_0_10 -->
<g id="edge250" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_q_0_10</title>
<path fill="none" stroke="black" d="M9708.64,-10042.83C9651.67,-10026.89 9580.29,-10006.91 9522.24,-9990.66"/>
<polygon fill="black" stroke="black" points="9522.88,-9987.2 9512.31,-9987.88 9520.99,-9993.95 9522.88,-9987.2"/>
</g>
<!-- split_k_0_10 -->
<g id="node211" class="node">
<title>split_k_0_10</title>
<ellipse fill="pink" stroke="black" cx="9724.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9724.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9724.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9724.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_k_0_10 -->
<g id="edge251" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_k_0_10</title>
<path fill="none" stroke="black" d="M9781.07,-10034.79C9773.82,-10025.29 9765.91,-10014.93 9758.37,-10005.06"/>
<polygon fill="black" stroke="black" points="9760.99,-10002.73 9752.14,-9996.9 9755.43,-10006.97 9760.99,-10002.73"/>
</g>
<!-- split_v_0_10 -->
<g id="node212" class="node">
<title>split_v_0_10</title>
<ellipse fill="pink" stroke="black" cx="10033.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10033.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10033.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="10033.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_v_0_10 -->
<g id="edge252" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_v_0_10</title>
<path fill="none" stroke="black" d="M9876.08,-10037.8C9901.9,-10025.18 9931.51,-10010.7 9958.03,-9997.73"/>
<polygon fill="black" stroke="black" points="9959.83,-10000.75 9967.28,-9993.22 9956.75,-9994.46 9959.83,-10000.75"/>
</g>
<!-- transpose_q_0_10 -->
<g id="node213" class="node">
<title>transpose_q_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9415.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9415.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9415.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9415.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_10&#45;&gt;transpose_q_0_10 -->
<g id="edge253" class="edge">
<title>split_q_0_10&#45;&gt;transpose_q_0_10</title>
<path fill="none" stroke="black" d="M9415.57,-9922.18C9415.57,-9913.73 9415.57,-9904.63 9415.57,-9895.81"/>
<polygon fill="black" stroke="black" points="9419.07,-9895.65 9415.57,-9885.65 9412.07,-9895.65 9419.07,-9895.65"/>
</g>
<!-- transpose_k_0_10 -->
<g id="node214" class="node">
<title>transpose_k_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9724.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9724.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9724.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9724.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_10&#45;&gt;transpose_k_0_10 -->
<g id="edge254" class="edge">
<title>split_k_0_10&#45;&gt;transpose_k_0_10</title>
<path fill="none" stroke="black" d="M9724.57,-9922.18C9724.57,-9913.73 9724.57,-9904.63 9724.57,-9895.81"/>
<polygon fill="black" stroke="black" points="9728.07,-9895.65 9724.57,-9885.65 9721.07,-9895.65 9728.07,-9895.65"/>
</g>
<!-- transpose_v_0_10 -->
<g id="node215" class="node">
<title>transpose_v_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="10033.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10033.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10033.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="10033.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_10&#45;&gt;transpose_v_0_10 -->
<g id="edge255" class="edge">
<title>split_v_0_10&#45;&gt;transpose_v_0_10</title>
<path fill="none" stroke="black" d="M10033.57,-9922.18C10033.57,-9913.73 10033.57,-9904.63 10033.57,-9895.81"/>
<polygon fill="black" stroke="black" points="10037.07,-9895.65 10033.57,-9885.65 10030.07,-9895.65 10037.07,-9895.65"/>
</g>
<!-- attn_scores_0_10 -->
<g id="node216" class="node">
<title>attn_scores_0_10</title>
<ellipse fill="gold" stroke="black" cx="9695.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9695.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9695.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9695.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_10&#45;&gt;attn_scores_0_10 -->
<g id="edge256" class="edge">
<title>transpose_q_0_10&#45;&gt;attn_scores_0_10</title>
<path fill="none" stroke="black" d="M9493.94,-9816.02C9528.4,-9802.48 9569.07,-9786.5 9604.84,-9772.45"/>
<polygon fill="black" stroke="black" points="9606.27,-9775.65 9614.3,-9768.73 9603.71,-9769.13 9606.27,-9775.65"/>
</g>
<!-- transpose_k_0_10&#45;&gt;attn_scores_0_10 -->
<g id="edge257" class="edge">
<title>transpose_k_0_10&#45;&gt;attn_scores_0_10</title>
<path fill="none" stroke="black" d="M9714.92,-9810.18C9712.62,-9801.46 9710.14,-9792.04 9707.74,-9782.95"/>
<polygon fill="black" stroke="black" points="9711.12,-9782.05 9705.19,-9773.27 9704.35,-9783.83 9711.12,-9782.05"/>
</g>
<!-- attn_output_0_10 -->
<g id="node217" class="node">
<title>attn_output_0_10</title>
<ellipse fill="gold" stroke="black" cx="9695.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9695.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9695.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9695.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_10&#45;&gt;attn_output_0_10 -->
<g id="edge258" class="edge">
<title>transpose_v_0_10&#45;&gt;attn_output_0_10</title>
<path fill="none" stroke="black" d="M10019.49,-9810.29C9996.41,-9754.86 9945.6,-9649.29 9871.57,-9586.3 9851,-9568.8 9825.67,-9554.99 9800.7,-9544.29"/>
<polygon fill="black" stroke="black" points="9801.73,-9540.93 9791.15,-9540.34 9799.06,-9547.4 9801.73,-9540.93"/>
</g>
<!-- softmax_0_10 -->
<g id="node218" class="node">
<title>softmax_0_10</title>
<ellipse fill="gold" stroke="black" cx="9695.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9695.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9695.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9695.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_10&#45;&gt;softmax_0_10 -->
<g id="edge259" class="edge">
<title>attn_scores_0_10&#45;&gt;softmax_0_10</title>
<path fill="none" stroke="black" d="M9695.57,-9698.18C9695.57,-9689.73 9695.57,-9680.63 9695.57,-9671.81"/>
<polygon fill="black" stroke="black" points="9699.07,-9671.65 9695.57,-9661.65 9692.07,-9671.65 9699.07,-9671.65"/>
</g>
<!-- transpose_back_0_10 -->
<g id="node219" class="node">
<title>transpose_back_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9651.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9651.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9651.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9651.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_10&#45;&gt;transpose_back_0_10 -->
<g id="edge261" class="edge">
<title>attn_output_0_10&#45;&gt;transpose_back_0_10</title>
<path fill="none" stroke="black" d="M9681.04,-9474.48C9677.51,-9465.66 9673.69,-9456.1 9670.01,-9446.89"/>
<polygon fill="black" stroke="black" points="9673.2,-9445.45 9666.24,-9437.46 9666.7,-9448.05 9673.2,-9445.45"/>
</g>
<!-- softmax_0_10&#45;&gt;attn_output_0_10 -->
<g id="edge260" class="edge">
<title>softmax_0_10&#45;&gt;attn_output_0_10</title>
<path fill="none" stroke="black" d="M9695.57,-9586.18C9695.57,-9577.73 9695.57,-9568.63 9695.57,-9559.81"/>
<polygon fill="black" stroke="black" points="9699.07,-9559.65 9695.57,-9549.65 9692.07,-9559.65 9699.07,-9559.65"/>
</g>
<!-- reshape_concat_0_10 -->
<g id="node220" class="node">
<title>reshape_concat_0_10</title>
<ellipse fill="lightcyan" stroke="black" cx="9599.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9599.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9599.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9599.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_10&#45;&gt;reshape_concat_0_10 -->
<g id="edge262" class="edge">
<title>transpose_back_0_10&#45;&gt;reshape_concat_0_10</title>
<path fill="none" stroke="black" d="M9634.4,-9362.48C9630.14,-9353.47 9625.52,-9343.7 9621.09,-9334.31"/>
<polygon fill="black" stroke="black" points="9624.16,-9332.63 9616.73,-9325.09 9617.84,-9335.63 9624.16,-9332.63"/>
</g>
<!-- reshape_concat_0_10&#45;&gt;allgather_dim_0_2 -->
<g id="edge263" class="edge">
<title>reshape_concat_0_10&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9548.41,-9253.01C9524.91,-9237.49 9496.83,-9218.94 9472.09,-9202.6"/>
<polygon fill="black" stroke="black" points="9473.76,-9199.51 9463.49,-9196.92 9469.9,-9205.35 9473.76,-9199.51"/>
</g>
<!-- split_q_0_11 -->
<g id="node222" class="node">
<title>split_q_0_11</title>
<ellipse fill="pink" stroke="black" cx="10342.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10342.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10342.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10342.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_q_0_11 -->
<g id="edge265" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_q_0_11</title>
<path fill="none" stroke="black" d="M10670.96,-10044.04C10605.31,-10027.4 10521.01,-10006.03 10454.26,-9989.11"/>
<polygon fill="black" stroke="black" points="10455.09,-9985.71 10444.54,-9986.65 10453.37,-9992.5 10455.09,-9985.71"/>
</g>
<!-- split_k_0_11 -->
<g id="node223" class="node">
<title>split_k_0_11</title>
<ellipse fill="pink" stroke="black" cx="10651.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10651.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10651.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10651.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_k_0_11 -->
<g id="edge266" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_k_0_11</title>
<path fill="none" stroke="black" d="M10736.33,-10035.39C10724.63,-10025.09 10711.72,-10013.73 10699.58,-10003.05"/>
<polygon fill="black" stroke="black" points="10701.56,-10000.13 10691.74,-9996.15 10696.93,-10005.38 10701.56,-10000.13"/>
</g>
<!-- split_v_0_11 -->
<g id="node224" class="node">
<title>split_v_0_11</title>
<ellipse fill="pink" stroke="black" cx="10960.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10960.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10960.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10960.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_v_0_11 -->
<g id="edge267" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_v_0_11</title>
<path fill="none" stroke="black" d="M10833.53,-10036.75C10853.12,-10025.05 10875.19,-10011.85 10895.38,-9999.78"/>
<polygon fill="black" stroke="black" points="10897.41,-10002.64 10904.2,-9994.51 10893.82,-9996.63 10897.41,-10002.64"/>
</g>
<!-- transpose_q_0_11 -->
<g id="node225" class="node">
<title>transpose_q_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10342.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10342.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10342.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10342.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_11&#45;&gt;transpose_q_0_11 -->
<g id="edge268" class="edge">
<title>split_q_0_11&#45;&gt;transpose_q_0_11</title>
<path fill="none" stroke="black" d="M10342.57,-9922.18C10342.57,-9913.73 10342.57,-9904.63 10342.57,-9895.81"/>
<polygon fill="black" stroke="black" points="10346.07,-9895.65 10342.57,-9885.65 10339.07,-9895.65 10346.07,-9895.65"/>
</g>
<!-- transpose_k_0_11 -->
<g id="node226" class="node">
<title>transpose_k_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10651.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10651.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10651.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10651.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_11&#45;&gt;transpose_k_0_11 -->
<g id="edge269" class="edge">
<title>split_k_0_11&#45;&gt;transpose_k_0_11</title>
<path fill="none" stroke="black" d="M10651.57,-9922.18C10651.57,-9913.73 10651.57,-9904.63 10651.57,-9895.81"/>
<polygon fill="black" stroke="black" points="10655.07,-9895.65 10651.57,-9885.65 10648.07,-9895.65 10655.07,-9895.65"/>
</g>
<!-- transpose_v_0_11 -->
<g id="node227" class="node">
<title>transpose_v_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10960.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10960.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10960.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10960.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_11&#45;&gt;transpose_v_0_11 -->
<g id="edge270" class="edge">
<title>split_v_0_11&#45;&gt;transpose_v_0_11</title>
<path fill="none" stroke="black" d="M10960.57,-9922.18C10960.57,-9913.73 10960.57,-9904.63 10960.57,-9895.81"/>
<polygon fill="black" stroke="black" points="10964.07,-9895.65 10960.57,-9885.65 10957.07,-9895.65 10964.07,-9895.65"/>
</g>
<!-- attn_scores_0_11 -->
<g id="node228" class="node">
<title>attn_scores_0_11</title>
<ellipse fill="gold" stroke="black" cx="10461.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10461.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10461.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10461.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_11&#45;&gt;attn_scores_0_11 -->
<g id="edge271" class="edge">
<title>transpose_q_0_11&#45;&gt;attn_scores_0_11</title>
<path fill="none" stroke="black" d="M10380.88,-9811.39C10391.92,-9801.19 10404.07,-9789.96 10415.52,-9779.37"/>
<polygon fill="black" stroke="black" points="10417.96,-9781.88 10422.93,-9772.52 10413.21,-9776.74 10417.96,-9781.88"/>
</g>
<!-- transpose_k_0_11&#45;&gt;attn_scores_0_11 -->
<g id="edge272" class="edge">
<title>transpose_k_0_11&#45;&gt;attn_scores_0_11</title>
<path fill="none" stroke="black" d="M10593.79,-9813.35C10573.54,-9801.63 10550.61,-9788.35 10529.59,-9776.18"/>
<polygon fill="black" stroke="black" points="10531.13,-9773.03 10520.72,-9771.05 10527.62,-9779.09 10531.13,-9773.03"/>
</g>
<!-- attn_output_0_11 -->
<g id="node229" class="node">
<title>attn_output_0_11</title>
<ellipse fill="gold" stroke="black" cx="10461.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10461.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10461.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10461.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_11&#45;&gt;attn_output_0_11 -->
<g id="edge273" class="edge">
<title>transpose_v_0_11&#45;&gt;attn_output_0_11</title>
<path fill="none" stroke="black" d="M10923.92,-9811.35C10866.59,-9757.32 10750.53,-9653.58 10637.57,-9586.3 10612.12,-9571.15 10582.97,-9557.61 10555.81,-9546.41"/>
<polygon fill="black" stroke="black" points="10556.88,-9543.06 10546.29,-9542.55 10554.24,-9549.55 10556.88,-9543.06"/>
</g>
<!-- softmax_0_11 -->
<g id="node230" class="node">
<title>softmax_0_11</title>
<ellipse fill="gold" stroke="black" cx="10461.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10461.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10461.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10461.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_11&#45;&gt;softmax_0_11 -->
<g id="edge274" class="edge">
<title>attn_scores_0_11&#45;&gt;softmax_0_11</title>
<path fill="none" stroke="black" d="M10461.57,-9698.18C10461.57,-9689.73 10461.57,-9680.63 10461.57,-9671.81"/>
<polygon fill="black" stroke="black" points="10465.07,-9671.65 10461.57,-9661.65 10458.07,-9671.65 10465.07,-9671.65"/>
</g>
<!-- transpose_back_0_11 -->
<g id="node231" class="node">
<title>transpose_back_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10198.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10198.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10198.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10198.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_11&#45;&gt;transpose_back_0_11 -->
<g id="edge276" class="edge">
<title>attn_output_0_11&#45;&gt;transpose_back_0_11</title>
<path fill="none" stroke="black" d="M10386.91,-9479.58C10354.43,-9465.99 10316.22,-9450.01 10282.73,-9436"/>
<polygon fill="black" stroke="black" points="10284,-9432.74 10273.42,-9432.11 10281.3,-9439.2 10284,-9432.74"/>
</g>
<!-- softmax_0_11&#45;&gt;attn_output_0_11 -->
<g id="edge275" class="edge">
<title>softmax_0_11&#45;&gt;attn_output_0_11</title>
<path fill="none" stroke="black" d="M10461.57,-9586.18C10461.57,-9577.73 10461.57,-9568.63 10461.57,-9559.81"/>
<polygon fill="black" stroke="black" points="10465.07,-9559.65 10461.57,-9549.65 10458.07,-9559.65 10465.07,-9559.65"/>
</g>
<!-- reshape_concat_0_11 -->
<g id="node232" class="node">
<title>reshape_concat_0_11</title>
<ellipse fill="lightcyan" stroke="black" cx="9901.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9901.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9901.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="9901.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_11&#45;&gt;reshape_concat_0_11 -->
<g id="edge277" class="edge">
<title>transpose_back_0_11&#45;&gt;reshape_concat_0_11</title>
<path fill="none" stroke="black" d="M10117.02,-9368.6C10077.68,-9354.03 10030.4,-9336.52 9990.17,-9321.62"/>
<polygon fill="black" stroke="black" points="9991.23,-9318.28 9980.63,-9318.09 9988.8,-9324.84 9991.23,-9318.28"/>
</g>
<!-- reshape_concat_0_11&#45;&gt;allgather_dim_0_2 -->
<g id="edge278" class="edge">
<title>reshape_concat_0_11&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9804.66,-9262.08C9720.29,-9240.56 9598.35,-9209.46 9512.31,-9187.51"/>
<polygon fill="black" stroke="black" points="9513.08,-9184.09 9502.52,-9185.01 9511.35,-9190.88 9513.08,-9184.09"/>
</g>
<!-- output_proj_0_2 -->
<g id="node286" class="node">
<title>output_proj_0_2</title>
<ellipse fill="orange" stroke="black" cx="9409.57" cy="-8947.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="9409.57" y="-8966.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9409.57" y="-8951.02" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="9409.57" y="-8936.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="9409.57" y="-8921.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_2&#45;&gt;output_proj_0_2 -->
<g id="edge343" class="edge">
<title>head_group_0_2&#45;&gt;output_proj_0_2</title>
<path fill="none" stroke="black" d="M9409.57,-9032.05C9409.57,-9024.48 9409.57,-9015.23 9409.57,-9005.68"/>
<polygon fill="black" stroke="black" points="9413.07,-9005.67 9409.57,-8995.67 9406.07,-9005.67 9413.07,-9005.67"/>
</g>
<!-- split_q_0_12 -->
<g id="node235" class="node">
<title>split_q_0_12</title>
<ellipse fill="pink" stroke="black" cx="11269.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11269.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11269.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11269.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_q_0_12 -->
<g id="edge281" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_q_0_12</title>
<path fill="none" stroke="black" d="M11562.64,-10042.83C11505.67,-10026.89 11434.29,-10006.91 11376.24,-9990.66"/>
<polygon fill="black" stroke="black" points="11376.88,-9987.2 11366.31,-9987.88 11374.99,-9993.95 11376.88,-9987.2"/>
</g>
<!-- split_k_0_12 -->
<g id="node236" class="node">
<title>split_k_0_12</title>
<ellipse fill="pink" stroke="black" cx="11578.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11578.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_k_0_12 -->
<g id="edge282" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_k_0_12</title>
<path fill="none" stroke="black" d="M11635.07,-10034.79C11627.82,-10025.29 11619.91,-10014.93 11612.37,-10005.06"/>
<polygon fill="black" stroke="black" points="11614.99,-10002.73 11606.14,-9996.9 11609.43,-10006.97 11614.99,-10002.73"/>
</g>
<!-- split_v_0_12 -->
<g id="node237" class="node">
<title>split_v_0_12</title>
<ellipse fill="pink" stroke="black" cx="11887.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11887.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_v_0_12 -->
<g id="edge283" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_v_0_12</title>
<path fill="none" stroke="black" d="M11730.08,-10037.8C11755.9,-10025.18 11785.51,-10010.7 11812.03,-9997.73"/>
<polygon fill="black" stroke="black" points="11813.83,-10000.75 11821.28,-9993.22 11810.75,-9994.46 11813.83,-10000.75"/>
</g>
<!-- transpose_q_0_12 -->
<g id="node238" class="node">
<title>transpose_q_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11269.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11269.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11269.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11269.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_12&#45;&gt;transpose_q_0_12 -->
<g id="edge284" class="edge">
<title>split_q_0_12&#45;&gt;transpose_q_0_12</title>
<path fill="none" stroke="black" d="M11269.57,-9922.18C11269.57,-9913.73 11269.57,-9904.63 11269.57,-9895.81"/>
<polygon fill="black" stroke="black" points="11273.07,-9895.65 11269.57,-9885.65 11266.07,-9895.65 11273.07,-9895.65"/>
</g>
<!-- transpose_k_0_12 -->
<g id="node239" class="node">
<title>transpose_k_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11578.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11578.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_12&#45;&gt;transpose_k_0_12 -->
<g id="edge285" class="edge">
<title>split_k_0_12&#45;&gt;transpose_k_0_12</title>
<path fill="none" stroke="black" d="M11578.57,-9922.18C11578.57,-9913.73 11578.57,-9904.63 11578.57,-9895.81"/>
<polygon fill="black" stroke="black" points="11582.07,-9895.65 11578.57,-9885.65 11575.07,-9895.65 11582.07,-9895.65"/>
</g>
<!-- transpose_v_0_12 -->
<g id="node240" class="node">
<title>transpose_v_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11887.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11887.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_12&#45;&gt;transpose_v_0_12 -->
<g id="edge286" class="edge">
<title>split_v_0_12&#45;&gt;transpose_v_0_12</title>
<path fill="none" stroke="black" d="M11887.57,-9922.18C11887.57,-9913.73 11887.57,-9904.63 11887.57,-9895.81"/>
<polygon fill="black" stroke="black" points="11891.07,-9895.65 11887.57,-9885.65 11884.07,-9895.65 11891.07,-9895.65"/>
</g>
<!-- attn_scores_0_12 -->
<g id="node241" class="node">
<title>attn_scores_0_12</title>
<ellipse fill="gold" stroke="black" cx="11578.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11578.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_12&#45;&gt;attn_scores_0_12 -->
<g id="edge287" class="edge">
<title>transpose_q_0_12&#45;&gt;attn_scores_0_12</title>
<path fill="none" stroke="black" d="M11353.19,-9817.04C11392.91,-9802.9 11440.6,-9785.92 11481.86,-9771.23"/>
<polygon fill="black" stroke="black" points="11483.13,-9774.49 11491.38,-9767.84 11480.79,-9767.9 11483.13,-9774.49"/>
</g>
<!-- transpose_k_0_12&#45;&gt;attn_scores_0_12 -->
<g id="edge288" class="edge">
<title>transpose_k_0_12&#45;&gt;attn_scores_0_12</title>
<path fill="none" stroke="black" d="M11578.57,-9810.18C11578.57,-9801.73 11578.57,-9792.63 11578.57,-9783.81"/>
<polygon fill="black" stroke="black" points="11582.07,-9783.65 11578.57,-9773.65 11575.07,-9783.65 11582.07,-9783.65"/>
</g>
<!-- attn_output_0_12 -->
<g id="node242" class="node">
<title>attn_output_0_12</title>
<ellipse fill="gold" stroke="black" cx="11887.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11887.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_12&#45;&gt;attn_output_0_12 -->
<g id="edge289" class="edge">
<title>transpose_v_0_12&#45;&gt;attn_output_0_12</title>
<path fill="none" stroke="black" d="M11887.57,-9810.1C11887.57,-9749.06 11887.57,-9626.75 11887.57,-9559.6"/>
<polygon fill="black" stroke="black" points="11891.07,-9559.31 11887.57,-9549.31 11884.07,-9559.31 11891.07,-9559.31"/>
</g>
<!-- softmax_0_12 -->
<g id="node243" class="node">
<title>softmax_0_12</title>
<ellipse fill="gold" stroke="black" cx="11635.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11635.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11635.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11635.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_12&#45;&gt;softmax_0_12 -->
<g id="edge290" class="edge">
<title>attn_scores_0_12&#45;&gt;softmax_0_12</title>
<path fill="none" stroke="black" d="M11597.4,-9698.48C11602.11,-9689.38 11607.23,-9679.5 11612.15,-9670.02"/>
<polygon fill="black" stroke="black" points="11615.28,-9671.58 11616.77,-9661.09 11609.06,-9668.36 11615.28,-9671.58"/>
</g>
<!-- transpose_back_0_12 -->
<g id="node244" class="node">
<title>transpose_back_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11991.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11991.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="11991.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11991.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_12&#45;&gt;transpose_back_0_12 -->
<g id="edge292" class="edge">
<title>attn_output_0_12&#45;&gt;transpose_back_0_12</title>
<path fill="none" stroke="black" d="M11921.34,-9475.09C11930.79,-9465.09 11941.16,-9454.13 11950.96,-9443.76"/>
<polygon fill="black" stroke="black" points="11953.65,-9446.01 11957.98,-9436.34 11948.56,-9441.2 11953.65,-9446.01"/>
</g>
<!-- softmax_0_12&#45;&gt;attn_output_0_12 -->
<g id="edge291" class="edge">
<title>softmax_0_12&#45;&gt;attn_output_0_12</title>
<path fill="none" stroke="black" d="M11710.16,-9590.25C11740.15,-9577.16 11774.83,-9562.02 11805.52,-9548.62"/>
<polygon fill="black" stroke="black" points="11807.15,-9551.73 11814.91,-9544.52 11804.35,-9545.31 11807.15,-9551.73"/>
</g>
<!-- reshape_concat_0_12 -->
<g id="node245" class="node">
<title>reshape_concat_0_12</title>
<ellipse fill="lightcyan" stroke="black" cx="12183.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12183.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12183.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="12183.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_12&#45;&gt;reshape_concat_0_12 -->
<g id="edge293" class="edge">
<title>transpose_back_0_12&#45;&gt;reshape_concat_0_12</title>
<path fill="none" stroke="black" d="M12049.96,-9365.35C12071.2,-9353.19 12095.35,-9339.35 12117.22,-9326.82"/>
<polygon fill="black" stroke="black" points="12119.19,-9329.73 12126.12,-9321.72 12115.71,-9323.65 12119.19,-9329.73"/>
</g>
<!-- allgather_dim_0_3 -->
<g id="node246" class="node">
<title>allgather_dim_0_3</title>
<polygon fill="red" stroke="black" points="12719.57,-9213.3 12546.57,-9160.3 12719.57,-9107.3 12892.57,-9160.3 12719.57,-9213.3"/>
<text text-anchor="middle" x="12719.57" y="-9171.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="12719.57" y="-9156.6" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="12719.57" y="-9141.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_12&#45;&gt;allgather_dim_0_3 -->
<g id="edge294" class="edge">
<title>reshape_concat_0_12&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12284.39,-9263.2C12378.26,-9241.22 12517.69,-9208.57 12613.29,-9186.19"/>
<polygon fill="black" stroke="black" points="12614.33,-9189.54 12623.27,-9183.85 12612.73,-9182.73 12614.33,-9189.54"/>
</g>
<!-- head_group_0_3 -->
<g id="node283" class="node">
<title>head_group_0_3</title>
<polygon fill="lightyellow" stroke="black" points="11906.07,-9070.3 11709.07,-9070.3 11709.07,-9032.3 11906.07,-9032.3 11906.07,-9070.3"/>
<text text-anchor="middle" x="11807.57" y="-9055.1" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="11807.57" y="-9040.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_3&#45;&gt;head_group_0_3 -->
<g id="edge340" class="edge">
<title>allgather_dim_0_3&#45;&gt;head_group_0_3</title>
<path fill="none" stroke="black" d="M12596.58,-9144.87C12417.33,-9123.84 12087.16,-9085.11 11916.33,-9065.06"/>
<polygon fill="black" stroke="black" points="11916.65,-9061.58 11906.31,-9063.89 11915.84,-9068.53 11916.65,-9061.58"/>
</g>
<!-- split_q_0_13 -->
<g id="node248" class="node">
<title>split_q_0_13</title>
<ellipse fill="pink" stroke="black" cx="12196.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12196.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12196.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12196.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_q_0_13 -->
<g id="edge296" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_q_0_13</title>
<path fill="none" stroke="black" d="M12489.64,-10042.83C12432.67,-10026.89 12361.29,-10006.91 12303.24,-9990.66"/>
<polygon fill="black" stroke="black" points="12303.88,-9987.2 12293.31,-9987.88 12301.99,-9993.95 12303.88,-9987.2"/>
</g>
<!-- split_k_0_13 -->
<g id="node249" class="node">
<title>split_k_0_13</title>
<ellipse fill="pink" stroke="black" cx="12505.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12505.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_k_0_13 -->
<g id="edge297" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_k_0_13</title>
<path fill="none" stroke="black" d="M12562.07,-10034.79C12554.82,-10025.29 12546.91,-10014.93 12539.37,-10005.06"/>
<polygon fill="black" stroke="black" points="12541.99,-10002.73 12533.14,-9996.9 12536.43,-10006.97 12541.99,-10002.73"/>
</g>
<!-- split_v_0_13 -->
<g id="node250" class="node">
<title>split_v_0_13</title>
<ellipse fill="pink" stroke="black" cx="12814.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12814.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12814.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12814.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_v_0_13 -->
<g id="edge298" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_v_0_13</title>
<path fill="none" stroke="black" d="M12657.08,-10037.8C12682.9,-10025.18 12712.51,-10010.7 12739.03,-9997.73"/>
<polygon fill="black" stroke="black" points="12740.83,-10000.75 12748.28,-9993.22 12737.75,-9994.46 12740.83,-10000.75"/>
</g>
<!-- transpose_q_0_13 -->
<g id="node251" class="node">
<title>transpose_q_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12196.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12196.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12196.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12196.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_13&#45;&gt;transpose_q_0_13 -->
<g id="edge299" class="edge">
<title>split_q_0_13&#45;&gt;transpose_q_0_13</title>
<path fill="none" stroke="black" d="M12196.57,-9922.18C12196.57,-9913.73 12196.57,-9904.63 12196.57,-9895.81"/>
<polygon fill="black" stroke="black" points="12200.07,-9895.65 12196.57,-9885.65 12193.07,-9895.65 12200.07,-9895.65"/>
</g>
<!-- transpose_k_0_13 -->
<g id="node252" class="node">
<title>transpose_k_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12505.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12505.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_13&#45;&gt;transpose_k_0_13 -->
<g id="edge300" class="edge">
<title>split_k_0_13&#45;&gt;transpose_k_0_13</title>
<path fill="none" stroke="black" d="M12505.57,-9922.18C12505.57,-9913.73 12505.57,-9904.63 12505.57,-9895.81"/>
<polygon fill="black" stroke="black" points="12509.07,-9895.65 12505.57,-9885.65 12502.07,-9895.65 12509.07,-9895.65"/>
</g>
<!-- transpose_v_0_13 -->
<g id="node253" class="node">
<title>transpose_v_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12814.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12814.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12814.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12814.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_13&#45;&gt;transpose_v_0_13 -->
<g id="edge301" class="edge">
<title>split_v_0_13&#45;&gt;transpose_v_0_13</title>
<path fill="none" stroke="black" d="M12814.57,-9922.18C12814.57,-9913.73 12814.57,-9904.63 12814.57,-9895.81"/>
<polygon fill="black" stroke="black" points="12818.07,-9895.65 12814.57,-9885.65 12811.07,-9895.65 12818.07,-9895.65"/>
</g>
<!-- attn_scores_0_13 -->
<g id="node254" class="node">
<title>attn_scores_0_13</title>
<ellipse fill="gold" stroke="black" cx="12505.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12505.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_13&#45;&gt;attn_scores_0_13 -->
<g id="edge302" class="edge">
<title>transpose_q_0_13&#45;&gt;attn_scores_0_13</title>
<path fill="none" stroke="black" d="M12280.19,-9817.04C12319.91,-9802.9 12367.6,-9785.92 12408.86,-9771.23"/>
<polygon fill="black" stroke="black" points="12410.13,-9774.49 12418.38,-9767.84 12407.79,-9767.9 12410.13,-9774.49"/>
</g>
<!-- transpose_k_0_13&#45;&gt;attn_scores_0_13 -->
<g id="edge303" class="edge">
<title>transpose_k_0_13&#45;&gt;attn_scores_0_13</title>
<path fill="none" stroke="black" d="M12505.57,-9810.18C12505.57,-9801.73 12505.57,-9792.63 12505.57,-9783.81"/>
<polygon fill="black" stroke="black" points="12509.07,-9783.65 12505.57,-9773.65 12502.07,-9783.65 12509.07,-9783.65"/>
</g>
<!-- attn_output_0_13 -->
<g id="node255" class="node">
<title>attn_output_0_13</title>
<ellipse fill="gold" stroke="black" cx="12719.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12719.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12719.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_13&#45;&gt;attn_output_0_13 -->
<g id="edge304" class="edge">
<title>transpose_v_0_13&#45;&gt;attn_output_0_13</title>
<path fill="none" stroke="black" d="M12804.14,-9810.1C12786.74,-9748.93 12751.84,-9626.24 12732.76,-9559.18"/>
<polygon fill="black" stroke="black" points="12736.06,-9557.97 12729.96,-9549.31 12729.33,-9559.89 12736.06,-9557.97"/>
</g>
<!-- softmax_0_13 -->
<g id="node256" class="node">
<title>softmax_0_13</title>
<ellipse fill="gold" stroke="black" cx="12530.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12530.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12530.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12530.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_13&#45;&gt;softmax_0_13 -->
<g id="edge305" class="edge">
<title>attn_scores_0_13&#45;&gt;softmax_0_13</title>
<path fill="none" stroke="black" d="M12513.9,-9698.18C12515.86,-9689.55 12517.97,-9680.24 12520.02,-9671.24"/>
<polygon fill="black" stroke="black" points="12523.48,-9671.8 12522.29,-9661.27 12516.66,-9670.25 12523.48,-9671.8"/>
</g>
<!-- transpose_back_0_13 -->
<g id="node257" class="node">
<title>transpose_back_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12719.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12719.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12719.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_13&#45;&gt;transpose_back_0_13 -->
<g id="edge307" class="edge">
<title>attn_output_0_13&#45;&gt;transpose_back_0_13</title>
<path fill="none" stroke="black" d="M12719.57,-9474.18C12719.57,-9465.73 12719.57,-9456.63 12719.57,-9447.81"/>
<polygon fill="black" stroke="black" points="12723.07,-9447.65 12719.57,-9437.65 12716.07,-9447.65 12723.07,-9447.65"/>
</g>
<!-- softmax_0_13&#45;&gt;attn_output_0_13 -->
<g id="edge306" class="edge">
<title>softmax_0_13&#45;&gt;attn_output_0_13</title>
<path fill="none" stroke="black" d="M12589.34,-9588.6C12609.53,-9576.85 12632.28,-9563.61 12653.05,-9551.52"/>
<polygon fill="black" stroke="black" points="12654.94,-9554.47 12661.82,-9546.42 12651.41,-9548.42 12654.94,-9554.47"/>
</g>
<!-- reshape_concat_0_13 -->
<g id="node258" class="node">
<title>reshape_concat_0_13</title>
<ellipse fill="lightcyan" stroke="black" cx="12719.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12719.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12719.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_13&#45;&gt;reshape_concat_0_13 -->
<g id="edge308" class="edge">
<title>transpose_back_0_13&#45;&gt;reshape_concat_0_13</title>
<path fill="none" stroke="black" d="M12719.57,-9362.18C12719.57,-9353.73 12719.57,-9344.63 12719.57,-9335.81"/>
<polygon fill="black" stroke="black" points="12723.07,-9335.65 12719.57,-9325.65 12716.07,-9335.65 12723.07,-9335.65"/>
</g>
<!-- reshape_concat_0_13&#45;&gt;allgather_dim_0_3 -->
<g id="edge309" class="edge">
<title>reshape_concat_0_13&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12719.57,-9250.17C12719.57,-9241.86 12719.57,-9232.81 12719.57,-9223.77"/>
<polygon fill="black" stroke="black" points="12723.07,-9223.61 12719.57,-9213.61 12716.07,-9223.61 12723.07,-9223.61"/>
</g>
<!-- split_q_0_14 -->
<g id="node260" class="node">
<title>split_q_0_14</title>
<ellipse fill="pink" stroke="black" cx="13123.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13123.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13123.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13123.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_q_0_14 -->
<g id="edge311" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_q_0_14</title>
<path fill="none" stroke="black" d="M13477.44,-10044.87C13405.68,-10027.83 13311.93,-10005.55 13238.95,-9988.21"/>
<polygon fill="black" stroke="black" points="13239.33,-9984.71 13228.79,-9985.8 13237.71,-9991.52 13239.33,-9984.71"/>
</g>
<!-- split_k_0_14 -->
<g id="node261" class="node">
<title>split_k_0_14</title>
<ellipse fill="pink" stroke="black" cx="13432.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13432.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13432.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13432.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_k_0_14 -->
<g id="edge312" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_k_0_14</title>
<path fill="none" stroke="black" d="M13537.85,-10036C13522.31,-10024.9 13505,-10012.54 13488.97,-10001.09"/>
<polygon fill="black" stroke="black" points="13490.89,-9998.16 13480.72,-9995.19 13486.82,-10003.85 13490.89,-9998.16"/>
</g>
<!-- split_v_0_14 -->
<g id="node262" class="node">
<title>split_v_0_14</title>
<ellipse fill="pink" stroke="black" cx="13741.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13741.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13741.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13741.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_v_0_14 -->
<g id="edge313" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_v_0_14</title>
<path fill="none" stroke="black" d="M13635.62,-10036C13651.25,-10024.9 13668.68,-10012.54 13684.81,-10001.09"/>
<polygon fill="black" stroke="black" points="13686.99,-10003.84 13693.11,-9995.19 13682.93,-9998.13 13686.99,-10003.84"/>
</g>
<!-- transpose_q_0_14 -->
<g id="node263" class="node">
<title>transpose_q_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13123.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13123.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13123.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13123.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_14&#45;&gt;transpose_q_0_14 -->
<g id="edge314" class="edge">
<title>split_q_0_14&#45;&gt;transpose_q_0_14</title>
<path fill="none" stroke="black" d="M13123.57,-9922.18C13123.57,-9913.73 13123.57,-9904.63 13123.57,-9895.81"/>
<polygon fill="black" stroke="black" points="13127.07,-9895.65 13123.57,-9885.65 13120.07,-9895.65 13127.07,-9895.65"/>
</g>
<!-- transpose_k_0_14 -->
<g id="node264" class="node">
<title>transpose_k_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13432.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13432.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13432.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13432.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_14&#45;&gt;transpose_k_0_14 -->
<g id="edge315" class="edge">
<title>split_k_0_14&#45;&gt;transpose_k_0_14</title>
<path fill="none" stroke="black" d="M13432.57,-9922.18C13432.57,-9913.73 13432.57,-9904.63 13432.57,-9895.81"/>
<polygon fill="black" stroke="black" points="13436.07,-9895.65 13432.57,-9885.65 13429.07,-9895.65 13436.07,-9895.65"/>
</g>
<!-- transpose_v_0_14 -->
<g id="node265" class="node">
<title>transpose_v_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13741.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13741.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13741.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13741.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_14&#45;&gt;transpose_v_0_14 -->
<g id="edge316" class="edge">
<title>split_v_0_14&#45;&gt;transpose_v_0_14</title>
<path fill="none" stroke="black" d="M13741.57,-9922.18C13741.57,-9913.73 13741.57,-9904.63 13741.57,-9895.81"/>
<polygon fill="black" stroke="black" points="13745.07,-9895.65 13741.57,-9885.65 13738.07,-9895.65 13745.07,-9895.65"/>
</g>
<!-- attn_scores_0_14 -->
<g id="node266" class="node">
<title>attn_scores_0_14</title>
<ellipse fill="gold" stroke="black" cx="13242.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13242.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13242.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13242.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_14&#45;&gt;attn_scores_0_14 -->
<g id="edge317" class="edge">
<title>transpose_q_0_14&#45;&gt;attn_scores_0_14</title>
<path fill="none" stroke="black" d="M13161.88,-9811.39C13172.92,-9801.19 13185.07,-9789.96 13196.52,-9779.37"/>
<polygon fill="black" stroke="black" points="13198.96,-9781.88 13203.93,-9772.52 13194.21,-9776.74 13198.96,-9781.88"/>
</g>
<!-- transpose_k_0_14&#45;&gt;attn_scores_0_14 -->
<g id="edge318" class="edge">
<title>transpose_k_0_14&#45;&gt;attn_scores_0_14</title>
<path fill="none" stroke="black" d="M13374.79,-9813.35C13354.54,-9801.63 13331.61,-9788.35 13310.59,-9776.18"/>
<polygon fill="black" stroke="black" points="13312.13,-9773.03 13301.72,-9771.05 13308.62,-9779.09 13312.13,-9773.03"/>
</g>
<!-- attn_output_0_14 -->
<g id="node267" class="node">
<title>attn_output_0_14</title>
<ellipse fill="gold" stroke="black" cx="13242.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13242.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13242.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13242.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_14&#45;&gt;attn_output_0_14 -->
<g id="edge319" class="edge">
<title>transpose_v_0_14&#45;&gt;attn_output_0_14</title>
<path fill="none" stroke="black" d="M13704.92,-9811.35C13647.59,-9757.32 13531.53,-9653.58 13418.57,-9586.3 13393.12,-9571.15 13363.97,-9557.61 13336.81,-9546.41"/>
<polygon fill="black" stroke="black" points="13337.88,-9543.06 13327.29,-9542.55 13335.24,-9549.55 13337.88,-9543.06"/>
</g>
<!-- softmax_0_14 -->
<g id="node268" class="node">
<title>softmax_0_14</title>
<ellipse fill="gold" stroke="black" cx="13242.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13242.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13242.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13242.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_14&#45;&gt;softmax_0_14 -->
<g id="edge320" class="edge">
<title>attn_scores_0_14&#45;&gt;softmax_0_14</title>
<path fill="none" stroke="black" d="M13242.57,-9698.18C13242.57,-9689.73 13242.57,-9680.63 13242.57,-9671.81"/>
<polygon fill="black" stroke="black" points="13246.07,-9671.65 13242.57,-9661.65 13239.07,-9671.65 13246.07,-9671.65"/>
</g>
<!-- transpose_back_0_14 -->
<g id="node269" class="node">
<title>transpose_back_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13097.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13097.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13097.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13097.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_14&#45;&gt;transpose_back_0_14 -->
<g id="edge322" class="edge">
<title>attn_output_0_14&#45;&gt;transpose_back_0_14</title>
<path fill="none" stroke="black" d="M13196.69,-9476C13182.41,-9465.17 13166.53,-9453.12 13151.74,-9441.9"/>
<polygon fill="black" stroke="black" points="13153.73,-9439.02 13143.65,-9435.76 13149.5,-9444.59 13153.73,-9439.02"/>
</g>
<!-- softmax_0_14&#45;&gt;attn_output_0_14 -->
<g id="edge321" class="edge">
<title>softmax_0_14&#45;&gt;attn_output_0_14</title>
<path fill="none" stroke="black" d="M13242.57,-9586.18C13242.57,-9577.73 13242.57,-9568.63 13242.57,-9559.81"/>
<polygon fill="black" stroke="black" points="13246.07,-9559.65 13242.57,-9549.65 13239.07,-9559.65 13246.07,-9559.65"/>
</g>
<!-- reshape_concat_0_14 -->
<g id="node270" class="node">
<title>reshape_concat_0_14</title>
<ellipse fill="lightcyan" stroke="black" cx="13015.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13015.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13015.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13015.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_14&#45;&gt;reshape_concat_0_14 -->
<g id="edge323" class="edge">
<title>transpose_back_0_14&#45;&gt;reshape_concat_0_14</title>
<path fill="none" stroke="black" d="M13070.72,-9362.79C13063.64,-9353.29 13055.92,-9342.93 13048.56,-9333.06"/>
<polygon fill="black" stroke="black" points="13051.27,-9330.83 13042.48,-9324.9 13045.65,-9335.01 13051.27,-9330.83"/>
</g>
<!-- reshape_concat_0_14&#45;&gt;allgather_dim_0_3 -->
<g id="edge324" class="edge">
<title>reshape_concat_0_14&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12943.54,-9256.26C12900.25,-9237.91 12845.05,-9214.5 12800.29,-9195.53"/>
<polygon fill="black" stroke="black" points="12801.47,-9192.23 12790.9,-9191.55 12798.74,-9198.67 12801.47,-9192.23"/>
</g>
<!-- split_q_0_15 -->
<g id="node272" class="node">
<title>split_q_0_15</title>
<ellipse fill="pink" stroke="black" cx="14050.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14050.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14050.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14050.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_q_0_15 -->
<g id="edge326" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_q_0_15</title>
<path fill="none" stroke="black" d="M14318.2,-10041.9C14267.38,-10026.5 14204.84,-10007.55 14153,-9991.84"/>
<polygon fill="black" stroke="black" points="14153.7,-9988.4 14143.12,-9988.85 14151.67,-9995.1 14153.7,-9988.4"/>
</g>
<!-- split_k_0_15 -->
<g id="node273" class="node">
<title>split_k_0_15</title>
<ellipse fill="pink" stroke="black" cx="14359.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14359.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14359.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14359.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_k_0_15 -->
<g id="edge327" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_k_0_15</title>
<path fill="none" stroke="black" d="M14395.74,-10034.48C14391.32,-10025.47 14386.52,-10015.7 14381.91,-10006.31"/>
<polygon fill="black" stroke="black" points="14384.93,-10004.52 14377.39,-9997.09 14378.65,-10007.61 14384.93,-10004.52"/>
</g>
<!-- split_v_0_15 -->
<g id="node274" class="node">
<title>split_v_0_15</title>
<ellipse fill="pink" stroke="black" cx="14668.57" cy="-9959.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14668.57" y="-9971.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14668.57" y="-9956.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14668.57" y="-9941.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_v_0_15 -->
<g id="edge328" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_v_0_15</title>
<path fill="none" stroke="black" d="M14488.02,-10038.69C14518.79,-10025.42 14554.58,-10009.98 14586.14,-9996.36"/>
<polygon fill="black" stroke="black" points="14587.56,-9999.56 14595.36,-9992.39 14584.79,-9993.13 14587.56,-9999.56"/>
</g>
<!-- transpose_q_0_15 -->
<g id="node275" class="node">
<title>transpose_q_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14050.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14050.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14050.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14050.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_15&#45;&gt;transpose_q_0_15 -->
<g id="edge329" class="edge">
<title>split_q_0_15&#45;&gt;transpose_q_0_15</title>
<path fill="none" stroke="black" d="M14050.57,-9922.18C14050.57,-9913.73 14050.57,-9904.63 14050.57,-9895.81"/>
<polygon fill="black" stroke="black" points="14054.07,-9895.65 14050.57,-9885.65 14047.07,-9895.65 14054.07,-9895.65"/>
</g>
<!-- transpose_k_0_15 -->
<g id="node276" class="node">
<title>transpose_k_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14359.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14359.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14359.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14359.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_15&#45;&gt;transpose_k_0_15 -->
<g id="edge330" class="edge">
<title>split_k_0_15&#45;&gt;transpose_k_0_15</title>
<path fill="none" stroke="black" d="M14359.57,-9922.18C14359.57,-9913.73 14359.57,-9904.63 14359.57,-9895.81"/>
<polygon fill="black" stroke="black" points="14363.07,-9895.65 14359.57,-9885.65 14356.07,-9895.65 14363.07,-9895.65"/>
</g>
<!-- transpose_v_0_15 -->
<g id="node277" class="node">
<title>transpose_v_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14668.57" cy="-9847.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14668.57" y="-9859.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14668.57" y="-9844.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14668.57" y="-9829.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_15&#45;&gt;transpose_v_0_15 -->
<g id="edge331" class="edge">
<title>split_v_0_15&#45;&gt;transpose_v_0_15</title>
<path fill="none" stroke="black" d="M14668.57,-9922.18C14668.57,-9913.73 14668.57,-9904.63 14668.57,-9895.81"/>
<polygon fill="black" stroke="black" points="14672.07,-9895.65 14668.57,-9885.65 14665.07,-9895.65 14672.07,-9895.65"/>
</g>
<!-- attn_scores_0_15 -->
<g id="node278" class="node">
<title>attn_scores_0_15</title>
<ellipse fill="gold" stroke="black" cx="14324.57" cy="-9735.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14324.57" y="-9747.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14324.57" y="-9732.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14324.57" y="-9717.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_15&#45;&gt;attn_scores_0_15 -->
<g id="edge332" class="edge">
<title>transpose_q_0_15&#45;&gt;attn_scores_0_15</title>
<path fill="none" stroke="black" d="M14127.63,-9815.87C14161.05,-9802.45 14200.4,-9786.65 14235.11,-9772.72"/>
<polygon fill="black" stroke="black" points="14236.79,-9775.82 14244.76,-9768.85 14234.18,-9769.32 14236.79,-9775.82"/>
</g>
<!-- transpose_k_0_15&#45;&gt;attn_scores_0_15 -->
<g id="edge333" class="edge">
<title>transpose_k_0_15&#45;&gt;attn_scores_0_15</title>
<path fill="none" stroke="black" d="M14347.92,-9810.18C14345.14,-9801.46 14342.15,-9792.04 14339.26,-9782.95"/>
<polygon fill="black" stroke="black" points="14342.54,-9781.74 14336.18,-9773.27 14335.87,-9783.86 14342.54,-9781.74"/>
</g>
<!-- attn_output_0_15 -->
<g id="node279" class="node">
<title>attn_output_0_15</title>
<ellipse fill="gold" stroke="black" cx="14324.57" cy="-9511.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14324.57" y="-9523.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14324.57" y="-9508.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14324.57" y="-9493.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_15&#45;&gt;attn_output_0_15 -->
<g id="edge334" class="edge">
<title>transpose_v_0_15&#45;&gt;attn_output_0_15</title>
<path fill="none" stroke="black" d="M14653.61,-9810.3C14629.2,-9754.89 14575.89,-9649.33 14500.57,-9586.3 14479.65,-9568.8 14453.97,-9554.95 14428.76,-9544.21"/>
<polygon fill="black" stroke="black" points="14430.08,-9540.97 14419.5,-9540.4 14427.41,-9547.44 14430.08,-9540.97"/>
</g>
<!-- softmax_0_15 -->
<g id="node280" class="node">
<title>softmax_0_15</title>
<ellipse fill="gold" stroke="black" cx="14324.57" cy="-9623.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14324.57" y="-9635.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14324.57" y="-9620.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14324.57" y="-9605.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_15&#45;&gt;softmax_0_15 -->
<g id="edge335" class="edge">
<title>attn_scores_0_15&#45;&gt;softmax_0_15</title>
<path fill="none" stroke="black" d="M14324.57,-9698.18C14324.57,-9689.73 14324.57,-9680.63 14324.57,-9671.81"/>
<polygon fill="black" stroke="black" points="14328.07,-9671.65 14324.57,-9661.65 14321.07,-9671.65 14328.07,-9671.65"/>
</g>
<!-- transpose_back_0_15 -->
<g id="node281" class="node">
<title>transpose_back_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="13910.57" cy="-9399.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13910.57" y="-9411.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13910.57" y="-9396.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13910.57" y="-9381.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_15&#45;&gt;transpose_back_0_15 -->
<g id="edge337" class="edge">
<title>attn_output_0_15&#45;&gt;transpose_back_0_15</title>
<path fill="none" stroke="black" d="M14225.15,-9484.39C14163.25,-9467.94 14083.59,-9446.77 14019.91,-9429.86"/>
<polygon fill="black" stroke="black" points="14020.8,-9426.47 14010.24,-9427.29 14019,-9433.24 14020.8,-9426.47"/>
</g>
<!-- softmax_0_15&#45;&gt;attn_output_0_15 -->
<g id="edge336" class="edge">
<title>softmax_0_15&#45;&gt;attn_output_0_15</title>
<path fill="none" stroke="black" d="M14324.57,-9586.18C14324.57,-9577.73 14324.57,-9568.63 14324.57,-9559.81"/>
<polygon fill="black" stroke="black" points="14328.07,-9559.65 14324.57,-9549.65 14321.07,-9559.65 14328.07,-9559.65"/>
</g>
<!-- reshape_concat_0_15 -->
<g id="node282" class="node">
<title>reshape_concat_0_15</title>
<ellipse fill="lightcyan" stroke="black" cx="13851.57" cy="-9287.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13851.57" y="-9299.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13851.57" y="-9284.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13851.57" y="-9269.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_15&#45;&gt;reshape_concat_0_15 -->
<g id="edge338" class="edge">
<title>transpose_back_0_15&#45;&gt;reshape_concat_0_15</title>
<path fill="none" stroke="black" d="M13891.09,-9362.48C13886.21,-9353.38 13880.91,-9343.5 13875.82,-9334.02"/>
<polygon fill="black" stroke="black" points="13878.85,-9332.25 13871.04,-9325.09 13872.68,-9335.56 13878.85,-9332.25"/>
</g>
<!-- reshape_concat_0_15&#45;&gt;allgather_dim_0_3 -->
<g id="edge339" class="edge">
<title>reshape_concat_0_15&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M13728.81,-9273.19C13515.17,-9249.51 13076.64,-9200.89 12854.66,-9176.28"/>
<polygon fill="black" stroke="black" points="12854.91,-9172.79 12844.58,-9175.16 12854.14,-9179.74 12854.91,-9172.79"/>
</g>
<!-- output_proj_0_3 -->
<g id="node287" class="node">
<title>output_proj_0_3</title>
<ellipse fill="orange" stroke="black" cx="11104.57" cy="-8947.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="11104.57" y="-8966.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11104.57" y="-8951.02" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="11104.57" y="-8936.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11104.57" y="-8921.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_3&#45;&gt;output_proj_0_3 -->
<g id="edge344" class="edge">
<title>head_group_0_3&#45;&gt;output_proj_0_3</title>
<path fill="none" stroke="black" d="M11708.71,-9035.95C11587.05,-9018.28 11379.77,-8988.18 11242.49,-8968.25"/>
<polygon fill="black" stroke="black" points="11242.72,-8964.74 11232.32,-8966.77 11241.71,-8971.67 11242.72,-8964.74"/>
</g>
<!-- allreduce_output_0 -->
<g id="node288" class="node">
<title>allreduce_output_0</title>
<polygon fill="red" stroke="black" points="9409.57,-8862.14 9266.57,-8809.14 9409.57,-8756.14 9552.57,-8809.14 9409.57,-8862.14"/>
<text text-anchor="middle" x="9409.57" y="-8820.44" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="9409.57" y="-8805.44" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="9409.57" y="-8790.44" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_0_0&#45;&gt;allreduce_output_0 -->
<g id="edge345" class="edge">
<title>output_proj_0_0&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M7796.34,-8933.54C7901.98,-8923.68 8053.14,-8909.91 8185.57,-8899.14 8584.52,-8866.68 9057.09,-8833.93 9280.39,-8818.8"/>
<polygon fill="black" stroke="black" points="9280.76,-8822.28 9290.5,-8818.11 9280.29,-8815.3 9280.76,-8822.28"/>
</g>
<!-- output_proj_0_1&#45;&gt;allreduce_output_0 -->
<g id="edge346" class="edge">
<title>output_proj_0_1&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M8469.31,-8934.52C8597.24,-8922.89 8794.83,-8903.58 8965.57,-8881.14 9081.95,-8865.84 9214.79,-8844.02 9304.61,-8828.62"/>
<polygon fill="black" stroke="black" points="9305.26,-8832.05 9314.53,-8826.91 9304.08,-8825.16 9305.26,-8832.05"/>
</g>
<!-- output_proj_0_2&#45;&gt;allreduce_output_0 -->
<g id="edge347" class="edge">
<title>output_proj_0_2&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M9409.57,-8899.01C9409.57,-8890.42 9409.57,-8881.34 9409.57,-8872.39"/>
<polygon fill="black" stroke="black" points="9413.07,-8872.38 9409.57,-8862.38 9406.07,-8872.38 9413.07,-8872.38"/>
</g>
<!-- output_proj_0_3&#45;&gt;allreduce_output_0 -->
<g id="edge348" class="edge">
<title>output_proj_0_3&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M10969.09,-8935.34C10648.35,-8909.59 9846.29,-8845.2 9535.43,-8820.24"/>
<polygon fill="black" stroke="black" points="9535.28,-8816.72 9525.03,-8819.41 9534.72,-8823.7 9535.28,-8816.72"/>
</g>
<!-- allreduce_output_0&#45;&gt;residual_0 -->
<g id="edge349" class="edge">
<title>allreduce_output_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M9542.06,-8805.15C10290.49,-8788.28 13985.14,-8705.01 14812.84,-8686.35"/>
<polygon fill="black" stroke="black" points="14813.12,-8689.85 14823.04,-8686.12 14812.96,-8682.85 14813.12,-8689.85"/>
</g>
<!-- mlp_fc1_0_0 -->
<g id="node305" class="node">
<title>mlp_fc1_0_0</title>
<ellipse fill="lightcoral" stroke="black" cx="12626.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="12626.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="12626.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12626.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12626.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_0&#45;&gt;mlp_fc1_0_0 -->
<g id="edge366" class="edge">
<title>ln2_0_0&#45;&gt;mlp_fc1_0_0</title>
<path fill="none" stroke="black" d="M12613.33,-8532.13C12614.67,-8523.58 12616.14,-8514.27 12617.59,-8505.06"/>
<polygon fill="black" stroke="black" points="12621.05,-8505.57 12619.15,-8495.14 12614.14,-8504.48 12621.05,-8505.57"/>
</g>
<!-- mlp_fc1_0_1 -->
<g id="node306" class="node">
<title>mlp_fc1_0_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12928.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="12928.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="12928.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12928.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12928.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_1&#45;&gt;mlp_fc1_0_1 -->
<g id="edge367" class="edge">
<title>ln2_0_1&#45;&gt;mlp_fc1_0_1</title>
<path fill="none" stroke="black" d="M12925.09,-8532.13C12925.44,-8523.67 12925.82,-8514.46 12926.2,-8505.35"/>
<polygon fill="black" stroke="black" points="12929.7,-8505.28 12926.62,-8495.14 12922.71,-8504.99 12929.7,-8505.28"/>
</g>
<!-- mlp_fc1_0_2 -->
<g id="node307" class="node">
<title>mlp_fc1_0_2</title>
<ellipse fill="lightcoral" stroke="black" cx="13292.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13292.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="13292.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13292.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13292.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_2&#45;&gt;mlp_fc1_0_2 -->
<g id="edge368" class="edge">
<title>ln2_0_2&#45;&gt;mlp_fc1_0_2</title>
<path fill="none" stroke="black" d="M13255.62,-8532.13C13259.5,-8523.29 13263.75,-8513.64 13267.92,-8504.13"/>
<polygon fill="black" stroke="black" points="13271.25,-8505.27 13272.07,-8494.71 13264.84,-8502.45 13271.25,-8505.27"/>
</g>
<!-- mlp_fc1_0_3 -->
<g id="node308" class="node">
<title>mlp_fc1_0_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13594.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13594.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="13594.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13594.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13594.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_3&#45;&gt;mlp_fc1_0_3 -->
<g id="edge369" class="edge">
<title>ln2_0_3&#45;&gt;mlp_fc1_0_3</title>
<path fill="none" stroke="black" d="M13567.38,-8532.13C13570.18,-8523.49 13573.22,-8514.07 13576.23,-8504.76"/>
<polygon fill="black" stroke="black" points="13579.6,-8505.74 13579.34,-8495.14 13572.94,-8503.58 13579.6,-8505.74"/>
</g>
<!-- mlp_fc1_0_4 -->
<g id="node309" class="node">
<title>mlp_fc1_0_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13897.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13897.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="13897.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13897.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13897.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_4&#45;&gt;mlp_fc1_0_4 -->
<g id="edge370" class="edge">
<title>ln2_0_4&#45;&gt;mlp_fc1_0_4</title>
<path fill="none" stroke="black" d="M13879.44,-8532.13C13881.29,-8523.58 13883.3,-8514.27 13885.28,-8505.06"/>
<polygon fill="black" stroke="black" points="13888.73,-8505.66 13887.42,-8495.14 13881.89,-8504.18 13888.73,-8505.66"/>
</g>
<!-- mlp_fc1_0_5 -->
<g id="node310" class="node">
<title>mlp_fc1_0_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14197.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14197.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14197.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14197.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14197.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_5&#45;&gt;mlp_fc1_0_5 -->
<g id="edge371" class="edge">
<title>ln2_0_5&#45;&gt;mlp_fc1_0_5</title>
<path fill="none" stroke="black" d="M14190.6,-8532.13C14191.3,-8523.67 14192.07,-8514.46 14192.82,-8505.35"/>
<polygon fill="black" stroke="black" points="14196.33,-8505.4 14193.67,-8495.14 14189.35,-8504.82 14196.33,-8505.4"/>
</g>
<!-- mlp_fc1_0_6 -->
<g id="node311" class="node">
<title>mlp_fc1_0_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14520.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14520.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14520.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14520.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14520.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_6&#45;&gt;mlp_fc1_0_6 -->
<g id="edge372" class="edge">
<title>ln2_0_6&#45;&gt;mlp_fc1_0_6</title>
<path fill="none" stroke="black" d="M14508.72,-8532.13C14509.93,-8523.58 14511.24,-8514.27 14512.54,-8505.06"/>
<polygon fill="black" stroke="black" points="14516,-8505.53 14513.93,-8495.14 14509.07,-8504.56 14516,-8505.53"/>
</g>
<!-- mlp_fc1_0_7 -->
<g id="node312" class="node">
<title>mlp_fc1_0_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14826.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14826.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14826.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14826.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14826.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_7&#45;&gt;mlp_fc1_0_7 -->
<g id="edge373" class="edge">
<title>ln2_0_7&#45;&gt;mlp_fc1_0_7</title>
<path fill="none" stroke="black" d="M14821.69,-8532.13C14822.18,-8523.67 14822.72,-8514.46 14823.25,-8505.35"/>
<polygon fill="black" stroke="black" points="14826.75,-8505.33 14823.84,-8495.14 14819.77,-8504.92 14826.75,-8505.33"/>
</g>
<!-- mlp_fc1_0_8 -->
<g id="node313" class="node">
<title>mlp_fc1_0_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15132.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15132.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15132.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15132.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15132.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_8&#45;&gt;mlp_fc1_0_8 -->
<g id="edge374" class="edge">
<title>ln2_0_8&#45;&gt;mlp_fc1_0_8</title>
<path fill="none" stroke="black" d="M15134.67,-8532.13C15134.45,-8523.67 15134.23,-8514.46 15134,-8505.35"/>
<polygon fill="black" stroke="black" points="15137.49,-8505.05 15133.75,-8495.14 15130.49,-8505.23 15137.49,-8505.05"/>
</g>
<!-- mlp_fc1_0_9 -->
<g id="node314" class="node">
<title>mlp_fc1_0_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15443.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15443.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15443.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15443.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15443.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_9&#45;&gt;mlp_fc1_0_9 -->
<g id="edge375" class="edge">
<title>ln2_0_9&#45;&gt;mlp_fc1_0_9</title>
<path fill="none" stroke="black" d="M15449.15,-8532.13C15448.59,-8523.67 15447.98,-8514.46 15447.37,-8505.35"/>
<polygon fill="black" stroke="black" points="15450.85,-8504.89 15446.7,-8495.14 15443.87,-8505.35 15450.85,-8504.89"/>
</g>
<!-- mlp_fc1_0_10 -->
<g id="node315" class="node">
<title>mlp_fc1_0_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15757.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15757.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15757.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15757.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15757.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_10&#45;&gt;mlp_fc1_0_10 -->
<g id="edge376" class="edge">
<title>ln2_0_10&#45;&gt;mlp_fc1_0_10</title>
<path fill="none" stroke="black" d="M15764.55,-8532.13C15763.84,-8523.67 15763.08,-8514.46 15762.33,-8505.35"/>
<polygon fill="black" stroke="black" points="15765.79,-8504.82 15761.48,-8495.14 15758.82,-8505.4 15765.79,-8504.82"/>
</g>
<!-- mlp_fc1_0_11 -->
<g id="node316" class="node">
<title>mlp_fc1_0_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16072.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16072.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16072.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16072.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16072.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_11&#45;&gt;mlp_fc1_0_11 -->
<g id="edge377" class="edge">
<title>ln2_0_11&#45;&gt;mlp_fc1_0_11</title>
<path fill="none" stroke="black" d="M16080.24,-8532.13C16079.47,-8523.67 16078.63,-8514.46 16077.8,-8505.35"/>
<polygon fill="black" stroke="black" points="16081.26,-8504.78 16076.87,-8495.14 16074.29,-8505.42 16081.26,-8504.78"/>
</g>
<!-- mlp_fc1_0_12 -->
<g id="node317" class="node">
<title>mlp_fc1_0_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16375.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16375.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16375.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16375.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16375.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_12&#45;&gt;mlp_fc1_0_12 -->
<g id="edge378" class="edge">
<title>ln2_0_12&#45;&gt;mlp_fc1_0_12</title>
<path fill="none" stroke="black" d="M16392.31,-8532.13C16390.61,-8523.58 16388.75,-8514.27 16386.92,-8505.06"/>
<polygon fill="black" stroke="black" points="16390.33,-8504.27 16384.95,-8495.14 16383.47,-8505.64 16390.33,-8504.27"/>
</g>
<!-- mlp_fc1_0_13 -->
<g id="node318" class="node">
<title>mlp_fc1_0_13</title>
<ellipse fill="lightcoral" stroke="black" cx="16700.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16700.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16700.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16700.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16700.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_13&#45;&gt;mlp_fc1_0_13 -->
<g id="edge379" class="edge">
<title>ln2_0_13&#45;&gt;mlp_fc1_0_13</title>
<path fill="none" stroke="black" d="M16711.03,-8532.13C16709.98,-8523.67 16708.83,-8514.46 16707.7,-8505.35"/>
<polygon fill="black" stroke="black" points="16711.14,-8504.64 16706.43,-8495.14 16704.19,-8505.5 16711.14,-8504.64"/>
</g>
<!-- mlp_fc1_0_14 -->
<g id="node319" class="node">
<title>mlp_fc1_0_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17020.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17020.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17020.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17020.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17020.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_14&#45;&gt;mlp_fc1_0_14 -->
<g id="edge380" class="edge">
<title>ln2_0_14&#45;&gt;mlp_fc1_0_14</title>
<path fill="none" stroke="black" d="M17028.24,-8532.13C17027.47,-8523.67 17026.63,-8514.46 17025.8,-8505.35"/>
<polygon fill="black" stroke="black" points="17029.26,-8504.78 17024.87,-8495.14 17022.29,-8505.42 17029.26,-8504.78"/>
</g>
<!-- mlp_fc1_0_15 -->
<g id="node320" class="node">
<title>mlp_fc1_0_15</title>
<ellipse fill="lightcoral" stroke="black" cx="17338.57" cy="-8447.05" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17338.57" y="-8465.85" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17338.57" y="-8450.85" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17338.57" y="-8435.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17338.57" y="-8420.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_0_15&#45;&gt;mlp_fc1_0_15 -->
<g id="edge381" class="edge">
<title>ln2_0_15&#45;&gt;mlp_fc1_0_15</title>
<path fill="none" stroke="black" d="M17344.85,-8532.13C17344.22,-8523.67 17343.53,-8514.46 17342.85,-8505.35"/>
<polygon fill="black" stroke="black" points="17346.32,-8504.86 17342.09,-8495.14 17339.34,-8505.38 17346.32,-8504.86"/>
</g>
<!-- mlp_gelu_0_0 -->
<g id="node321" class="node">
<title>mlp_gelu_0_0</title>
<ellipse fill="lightcoral" stroke="black" cx="12679.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="12679.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12679.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12679.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_0&#45;&gt;mlp_gelu_0_0 -->
<g id="edge382" class="edge">
<title>mlp_fc1_0_0&#45;&gt;mlp_gelu_0_0</title>
<path fill="none" stroke="black" d="M12647.06,-8399.43C12651.13,-8390.19 12655.39,-8380.49 12659.44,-8371.27"/>
<polygon fill="black" stroke="black" points="12662.75,-8372.44 12663.57,-8361.87 12656.35,-8369.62 12662.75,-8372.44"/>
</g>
<!-- mlp_gelu_0_1 -->
<g id="node322" class="node">
<title>mlp_gelu_0_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12995.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="12995.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12995.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12995.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_1&#45;&gt;mlp_gelu_0_1 -->
<g id="edge383" class="edge">
<title>mlp_fc1_0_1&#45;&gt;mlp_gelu_0_1</title>
<path fill="none" stroke="black" d="M12954.29,-8399.78C12959.6,-8390.22 12965.19,-8380.15 12970.48,-8370.63"/>
<polygon fill="black" stroke="black" points="12973.65,-8372.14 12975.44,-8361.7 12967.53,-8368.74 12973.65,-8372.14"/>
</g>
<!-- mlp_gelu_0_2 -->
<g id="node323" class="node">
<title>mlp_gelu_0_2</title>
<ellipse fill="lightcoral" stroke="black" cx="13301.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="13301.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13301.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13301.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_2&#45;&gt;mlp_gelu_0_2 -->
<g id="edge384" class="edge">
<title>mlp_fc1_0_2&#45;&gt;mlp_gelu_0_2</title>
<path fill="none" stroke="black" d="M13296.1,-8398.74C13296.76,-8390.02 13297.44,-8380.91 13298.09,-8372.2"/>
<polygon fill="black" stroke="black" points="13301.58,-8372.44 13298.83,-8362.21 13294.6,-8371.92 13301.58,-8372.44"/>
</g>
<!-- mlp_gelu_0_3 -->
<g id="node324" class="node">
<title>mlp_gelu_0_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13609.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="13609.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13609.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13609.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_3&#45;&gt;mlp_gelu_0_3 -->
<g id="edge385" class="edge">
<title>mlp_fc1_0_3&#45;&gt;mlp_gelu_0_3</title>
<path fill="none" stroke="black" d="M13600.46,-8398.74C13601.54,-8390.02 13602.68,-8380.91 13603.76,-8372.2"/>
<polygon fill="black" stroke="black" points="13607.24,-8372.56 13605,-8362.21 13600.3,-8371.7 13607.24,-8372.56"/>
</g>
<!-- mlp_gelu_0_4 -->
<g id="node325" class="node">
<title>mlp_gelu_0_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13925.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="13925.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13925.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13925.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_4&#45;&gt;mlp_gelu_0_4 -->
<g id="edge386" class="edge">
<title>mlp_fc1_0_4&#45;&gt;mlp_gelu_0_4</title>
<path fill="none" stroke="black" d="M13908.48,-8399.09C13910.55,-8390.15 13912.72,-8380.8 13914.8,-8371.88"/>
<polygon fill="black" stroke="black" points="13918.23,-8372.57 13917.08,-8362.04 13911.41,-8370.99 13918.23,-8372.57"/>
</g>
<!-- mlp_gelu_0_5 -->
<g id="node326" class="node">
<title>mlp_gelu_0_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14231.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14231.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14231.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14231.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_5&#45;&gt;mlp_gelu_0_5 -->
<g id="edge387" class="edge">
<title>mlp_fc1_0_5&#45;&gt;mlp_gelu_0_5</title>
<path fill="none" stroke="black" d="M14210.82,-8399.09C14213.34,-8390.15 14215.97,-8380.8 14218.49,-8371.88"/>
<polygon fill="black" stroke="black" points="14221.92,-8372.62 14221.26,-8362.04 14215.18,-8370.72 14221.92,-8372.62"/>
</g>
<!-- mlp_gelu_0_6 -->
<g id="node327" class="node">
<title>mlp_gelu_0_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14533.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14533.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14533.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14533.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_6&#45;&gt;mlp_gelu_0_6 -->
<g id="edge388" class="edge">
<title>mlp_fc1_0_6&#45;&gt;mlp_gelu_0_6</title>
<path fill="none" stroke="black" d="M14525.67,-8398.74C14526.61,-8390.02 14527.6,-8380.91 14528.54,-8372.2"/>
<polygon fill="black" stroke="black" points="14532.02,-8372.53 14529.61,-8362.21 14525.06,-8371.77 14532.02,-8372.53"/>
</g>
<!-- mlp_gelu_0_7 -->
<g id="node328" class="node">
<title>mlp_gelu_0_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14830.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14830.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14830.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14830.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_7&#45;&gt;mlp_gelu_0_7 -->
<g id="edge389" class="edge">
<title>mlp_fc1_0_7&#45;&gt;mlp_gelu_0_7</title>
<path fill="none" stroke="black" d="M14828.14,-8398.74C14828.43,-8390.11 14828.73,-8381.11 14829.01,-8372.49"/>
<polygon fill="black" stroke="black" points="14832.52,-8372.32 14829.35,-8362.21 14825.53,-8372.09 14832.52,-8372.32"/>
</g>
<!-- mlp_gelu_0_8 -->
<g id="node329" class="node">
<title>mlp_gelu_0_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15127.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15127.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15127.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15127.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_8&#45;&gt;mlp_gelu_0_8 -->
<g id="edge390" class="edge">
<title>mlp_fc1_0_8&#45;&gt;mlp_gelu_0_8</title>
<path fill="none" stroke="black" d="M15130.61,-8398.74C15130.25,-8390.02 15129.87,-8380.91 15129.51,-8372.2"/>
<polygon fill="black" stroke="black" points="15133.01,-8372.05 15129.1,-8362.21 15126.01,-8372.34 15133.01,-8372.05"/>
</g>
<!-- mlp_gelu_0_9 -->
<g id="node330" class="node">
<title>mlp_gelu_0_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15424.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15424.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15424.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15424.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_9&#45;&gt;mlp_gelu_0_9 -->
<g id="edge391" class="edge">
<title>mlp_fc1_0_9&#45;&gt;mlp_gelu_0_9</title>
<path fill="none" stroke="black" d="M15436.12,-8398.74C15434.74,-8390.02 15433.31,-8380.91 15431.94,-8372.2"/>
<polygon fill="black" stroke="black" points="15435.38,-8371.54 15430.36,-8362.21 15428.46,-8372.63 15435.38,-8371.54"/>
</g>
<!-- mlp_gelu_0_10 -->
<g id="node331" class="node">
<title>mlp_gelu_0_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15721.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15721.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15721.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15721.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_10&#45;&gt;mlp_gelu_0_10 -->
<g id="edge392" class="edge">
<title>mlp_fc1_0_10&#45;&gt;mlp_gelu_0_10</title>
<path fill="none" stroke="black" d="M15743.55,-8399.09C15740.88,-8390.15 15738.09,-8380.8 15735.43,-8371.88"/>
<polygon fill="black" stroke="black" points="15738.71,-8370.62 15732.49,-8362.04 15732,-8372.62 15738.71,-8370.62"/>
</g>
<!-- mlp_gelu_0_11 -->
<g id="node332" class="node">
<title>mlp_gelu_0_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16018.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16018.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16018.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16018.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_11&#45;&gt;mlp_gelu_0_11 -->
<g id="edge393" class="edge">
<title>mlp_fc1_0_11&#45;&gt;mlp_gelu_0_11</title>
<path fill="none" stroke="black" d="M16051.7,-8399.43C16047.55,-8390.19 16043.21,-8380.49 16039.08,-8371.27"/>
<polygon fill="black" stroke="black" points="16042.16,-8369.57 16034.87,-8361.87 16035.77,-8372.43 16042.16,-8369.57"/>
</g>
<!-- mlp_gelu_0_12 -->
<g id="node333" class="node">
<title>mlp_gelu_0_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16315.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16315.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16315.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16315.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_12&#45;&gt;mlp_gelu_0_12 -->
<g id="edge394" class="edge">
<title>mlp_fc1_0_12&#45;&gt;mlp_gelu_0_12</title>
<path fill="none" stroke="black" d="M16352.38,-8399.43C16347.73,-8390.09 16342.85,-8380.28 16338.22,-8370.98"/>
<polygon fill="black" stroke="black" points="16341.27,-8369.27 16333.69,-8361.87 16335.01,-8372.38 16341.27,-8369.27"/>
</g>
<!-- mlp_gelu_0_13 -->
<g id="node334" class="node">
<title>mlp_gelu_0_13</title>
<ellipse fill="lightcoral" stroke="black" cx="16612.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16612.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16612.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16612.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_13&#45;&gt;mlp_gelu_0_13 -->
<g id="edge395" class="edge">
<title>mlp_fc1_0_13&#45;&gt;mlp_gelu_0_13</title>
<path fill="none" stroke="black" d="M16667.05,-8400.12C16659.77,-8390.14 16652.07,-8379.6 16644.84,-8369.68"/>
<polygon fill="black" stroke="black" points="16647.61,-8367.54 16638.89,-8361.53 16641.95,-8371.67 16647.61,-8367.54"/>
</g>
<!-- mlp_gelu_0_14 -->
<g id="node335" class="node">
<title>mlp_gelu_0_14</title>
<ellipse fill="lightcoral" stroke="black" cx="16909.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16909.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16909.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="16909.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_14&#45;&gt;mlp_gelu_0_14 -->
<g id="edge396" class="edge">
<title>mlp_fc1_0_14&#45;&gt;mlp_gelu_0_14</title>
<path fill="none" stroke="black" d="M16978.93,-8400.81C16969.22,-8390.27 16958.92,-8379.07 16949.3,-8368.63"/>
<polygon fill="black" stroke="black" points="16951.79,-8366.16 16942.44,-8361.17 16946.64,-8370.9 16951.79,-8366.16"/>
</g>
<!-- mlp_gelu_0_15 -->
<g id="node336" class="node">
<title>mlp_gelu_0_15</title>
<ellipse fill="lightcoral" stroke="black" cx="17206.57" cy="-8324.47" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17206.57" y="-8335.77" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17206.57" y="-8320.77" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17206.57" y="-8305.77" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_0_15&#45;&gt;mlp_gelu_0_15 -->
<g id="edge397" class="edge">
<title>mlp_fc1_0_15&#45;&gt;mlp_gelu_0_15</title>
<path fill="none" stroke="black" d="M17290.17,-8401.84C17277.86,-8390.59 17264.67,-8378.55 17252.49,-8367.42"/>
<polygon fill="black" stroke="black" points="17254.8,-8364.79 17245.06,-8360.62 17250.08,-8369.95 17254.8,-8364.79"/>
</g>
<!-- mlp_fc2_0_0 -->
<g id="node337" class="node">
<title>mlp_fc2_0_0</title>
<ellipse fill="lightcoral" stroke="black" cx="12754.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="12754.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="12754.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12754.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12754.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_0&#45;&gt;mlp_fc2_0_0 -->
<g id="edge398" class="edge">
<title>mlp_gelu_0_0&#45;&gt;mlp_fc2_0_0</title>
<path fill="none" stroke="black" d="M12702.08,-8287.29C12707.88,-8277.96 12714.26,-8267.7 12720.52,-8257.64"/>
<polygon fill="black" stroke="black" points="12723.65,-8259.23 12725.96,-8248.89 12717.71,-8255.53 12723.65,-8259.23"/>
</g>
<!-- mlp_fc2_0_1 -->
<g id="node338" class="node">
<title>mlp_fc2_0_1</title>
<ellipse fill="lightcoral" stroke="black" cx="13057.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13057.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13057.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13057.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13057.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_1&#45;&gt;mlp_fc2_0_1 -->
<g id="edge399" class="edge">
<title>mlp_gelu_0_1&#45;&gt;mlp_fc2_0_1</title>
<path fill="none" stroke="black" d="M13014.18,-8287.29C13018.87,-8278.16 13024.02,-8268.14 13029.09,-8258.29"/>
<polygon fill="black" stroke="black" points="13032.23,-8259.82 13033.69,-8249.33 13026.01,-8256.62 13032.23,-8259.82"/>
</g>
<!-- mlp_fc2_0_2 -->
<g id="node339" class="node">
<title>mlp_fc2_0_2</title>
<ellipse fill="lightcoral" stroke="black" cx="13351.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13351.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13351.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13351.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13351.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_2&#45;&gt;mlp_fc2_0_2 -->
<g id="edge400" class="edge">
<title>mlp_gelu_0_2&#45;&gt;mlp_fc2_0_2</title>
<path fill="none" stroke="black" d="M13316.71,-8286.96C13320.38,-8278.13 13324.38,-8268.48 13328.32,-8258.97"/>
<polygon fill="black" stroke="black" points="13331.63,-8260.12 13332.23,-8249.54 13325.17,-8257.44 13331.63,-8260.12"/>
</g>
<!-- mlp_fc2_0_3 -->
<g id="node340" class="node">
<title>mlp_fc2_0_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13640.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13640.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13640.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13640.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13640.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_3&#45;&gt;mlp_fc2_0_3 -->
<g id="edge401" class="edge">
<title>mlp_gelu_0_3&#45;&gt;mlp_fc2_0_3</title>
<path fill="none" stroke="black" d="M13618.96,-8286.96C13621.16,-8278.41 13623.55,-8269.1 13625.92,-8259.89"/>
<polygon fill="black" stroke="black" points="13629.37,-8260.53 13628.47,-8249.98 13622.59,-8258.79 13629.37,-8260.53"/>
</g>
<!-- mlp_fc2_0_4 -->
<g id="node341" class="node">
<title>mlp_fc2_0_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13949.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13949.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13949.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13949.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13949.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_4&#45;&gt;mlp_fc2_0_4 -->
<g id="edge402" class="edge">
<title>mlp_gelu_0_4&#45;&gt;mlp_fc2_0_4</title>
<path fill="none" stroke="black" d="M13932.84,-8286.96C13934.54,-8278.41 13936.4,-8269.1 13938.23,-8259.89"/>
<polygon fill="black" stroke="black" points="13941.68,-8260.47 13940.2,-8249.98 13934.82,-8259.1 13941.68,-8260.47"/>
</g>
<!-- mlp_fc2_0_5 -->
<g id="node342" class="node">
<title>mlp_fc2_0_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14252.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14252.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14252.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14252.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14252.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_5&#45;&gt;mlp_fc2_0_5 -->
<g id="edge403" class="edge">
<title>mlp_gelu_0_5&#45;&gt;mlp_fc2_0_5</title>
<path fill="none" stroke="black" d="M14237.93,-8286.96C14239.42,-8278.41 14241.04,-8269.1 14242.65,-8259.89"/>
<polygon fill="black" stroke="black" points="14246.1,-8260.43 14244.37,-8249.98 14239.21,-8259.23 14246.1,-8260.43"/>
</g>
<!-- mlp_fc2_0_6 -->
<g id="node343" class="node">
<title>mlp_fc2_0_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14546.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14546.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14546.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14546.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14546.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_6&#45;&gt;mlp_fc2_0_6 -->
<g id="edge404" class="edge">
<title>mlp_gelu_0_6&#45;&gt;mlp_fc2_0_6</title>
<path fill="none" stroke="black" d="M14537.51,-8286.96C14538.42,-8278.5 14539.41,-8269.3 14540.4,-8260.18"/>
<polygon fill="black" stroke="black" points="14543.9,-8260.3 14541.5,-8249.98 14536.94,-8259.54 14543.9,-8260.3"/>
</g>
<!-- mlp_fc2_0_7 -->
<g id="node344" class="node">
<title>mlp_fc2_0_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14835.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14835.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14835.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14835.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14835.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_7&#45;&gt;mlp_fc2_0_7 -->
<g id="edge405" class="edge">
<title>mlp_gelu_0_7&#45;&gt;mlp_fc2_0_7</title>
<path fill="none" stroke="black" d="M14832.09,-8286.96C14832.44,-8278.5 14832.82,-8269.3 14833.2,-8260.18"/>
<polygon fill="black" stroke="black" points="14836.7,-8260.11 14833.62,-8249.98 14829.71,-8259.82 14836.7,-8260.11"/>
</g>
<!-- mlp_fc2_0_8 -->
<g id="node345" class="node">
<title>mlp_fc2_0_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15125.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15125.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15125.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15125.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15125.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_8&#45;&gt;mlp_fc2_0_8 -->
<g id="edge406" class="edge">
<title>mlp_gelu_0_8&#45;&gt;mlp_fc2_0_8</title>
<path fill="none" stroke="black" d="M15126.97,-8286.96C15126.83,-8278.5 15126.67,-8269.3 15126.52,-8260.18"/>
<polygon fill="black" stroke="black" points="15130.02,-8259.92 15126.35,-8249.98 15123.02,-8260.03 15130.02,-8259.92"/>
</g>
<!-- mlp_fc2_0_9 -->
<g id="node346" class="node">
<title>mlp_fc2_0_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15419.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15419.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15419.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15419.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15419.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_9&#45;&gt;mlp_fc2_0_9 -->
<g id="edge407" class="edge">
<title>mlp_gelu_0_9&#45;&gt;mlp_fc2_0_9</title>
<path fill="none" stroke="black" d="M15423.06,-8286.96C15422.71,-8278.5 15422.33,-8269.3 15421.95,-8260.18"/>
<polygon fill="black" stroke="black" points="15425.44,-8259.82 15421.53,-8249.98 15418.44,-8260.11 15425.44,-8259.82"/>
</g>
<!-- mlp_fc2_0_10 -->
<g id="node347" class="node">
<title>mlp_fc2_0_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15714.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15714.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15714.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15714.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15714.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_10&#45;&gt;mlp_fc2_0_10 -->
<g id="edge408" class="edge">
<title>mlp_gelu_0_10&#45;&gt;mlp_fc2_0_10</title>
<path fill="none" stroke="black" d="M15719.45,-8286.96C15718.96,-8278.5 15718.43,-8269.3 15717.9,-8260.18"/>
<polygon fill="black" stroke="black" points="15721.38,-8259.76 15717.31,-8249.98 15714.39,-8260.16 15721.38,-8259.76"/>
</g>
<!-- mlp_fc2_0_11 -->
<g id="node348" class="node">
<title>mlp_fc2_0_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16010.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16010.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16010.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16010.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16010.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_11&#45;&gt;mlp_fc2_0_11 -->
<g id="edge409" class="edge">
<title>mlp_gelu_0_11&#45;&gt;mlp_fc2_0_11</title>
<path fill="none" stroke="black" d="M16016.15,-8286.96C16015.59,-8278.5 16014.98,-8269.3 16014.37,-8260.18"/>
<polygon fill="black" stroke="black" points="16017.85,-8259.72 16013.7,-8249.98 16010.87,-8260.19 16017.85,-8259.72"/>
</g>
<!-- mlp_fc2_0_12 -->
<g id="node349" class="node">
<title>mlp_fc2_0_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16307.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16307.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16307.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16307.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16307.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_12&#45;&gt;mlp_fc2_0_12 -->
<g id="edge410" class="edge">
<title>mlp_gelu_0_12&#45;&gt;mlp_fc2_0_12</title>
<path fill="none" stroke="black" d="M16313.15,-8286.96C16312.59,-8278.5 16311.98,-8269.3 16311.37,-8260.18"/>
<polygon fill="black" stroke="black" points="16314.85,-8259.72 16310.7,-8249.98 16307.87,-8260.19 16314.85,-8259.72"/>
</g>
<!-- mlp_fc2_0_13 -->
<g id="node350" class="node">
<title>mlp_fc2_0_13</title>
<ellipse fill="lightcoral" stroke="black" cx="16604.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16604.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16604.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16604.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16604.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_13&#45;&gt;mlp_fc2_0_13 -->
<g id="edge411" class="edge">
<title>mlp_gelu_0_13&#45;&gt;mlp_fc2_0_13</title>
<path fill="none" stroke="black" d="M16610.15,-8286.96C16609.59,-8278.5 16608.98,-8269.3 16608.37,-8260.18"/>
<polygon fill="black" stroke="black" points="16611.85,-8259.72 16607.7,-8249.98 16604.87,-8260.19 16611.85,-8259.72"/>
</g>
<!-- mlp_fc2_0_14 -->
<g id="node351" class="node">
<title>mlp_fc2_0_14</title>
<ellipse fill="lightcoral" stroke="black" cx="16901.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16901.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16901.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="16901.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16901.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_14&#45;&gt;mlp_fc2_0_14 -->
<g id="edge412" class="edge">
<title>mlp_gelu_0_14&#45;&gt;mlp_fc2_0_14</title>
<path fill="none" stroke="black" d="M16907.15,-8286.96C16906.59,-8278.5 16905.98,-8269.3 16905.37,-8260.18"/>
<polygon fill="black" stroke="black" points="16908.85,-8259.72 16904.7,-8249.98 16901.87,-8260.19 16908.85,-8259.72"/>
</g>
<!-- mlp_fc2_0_15 -->
<g id="node352" class="node">
<title>mlp_fc2_0_15</title>
<ellipse fill="lightcoral" stroke="black" cx="17198.57" cy="-8201.89" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17198.57" y="-8220.69" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17198.57" y="-8205.69" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17198.57" y="-8190.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17198.57" y="-8175.69" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_0_15&#45;&gt;mlp_fc2_0_15 -->
<g id="edge413" class="edge">
<title>mlp_gelu_0_15&#45;&gt;mlp_fc2_0_15</title>
<path fill="none" stroke="black" d="M17204.15,-8286.96C17203.59,-8278.5 17202.98,-8269.3 17202.37,-8260.18"/>
<polygon fill="black" stroke="black" points="17205.85,-8259.72 17201.7,-8249.98 17198.87,-8260.19 17205.85,-8259.72"/>
</g>
<!-- allreduce_mlp_0 -->
<g id="node353" class="node">
<title>allreduce_mlp_0</title>
<polygon fill="red" stroke="black" points="14915.57,-8116.8 14790.57,-8063.8 14915.57,-8010.8 15040.57,-8063.8 14915.57,-8116.8"/>
<text text-anchor="middle" x="14915.57" y="-8075.1" font-family="Times,serif" font-size="14.00">AllReduce MLP</text>
<text text-anchor="middle" x="14915.57" y="-8060.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="14915.57" y="-8045.1" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_fc2_0_0&#45;&gt;allreduce_mlp_0 -->
<g id="edge414" class="edge">
<title>mlp_fc2_0_0&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M12851.19,-8168.56C12872.2,-8162.68 12894.46,-8157.31 12915.57,-8153.8 13277.63,-8093.71 14403.44,-8072.2 14786.47,-8066.51"/>
<polygon fill="black" stroke="black" points="14786.54,-8070.01 14796.48,-8066.36 14786.43,-8063.01 14786.54,-8070.01"/>
</g>
<!-- mlp_fc2_0_1&#45;&gt;allreduce_mlp_0 -->
<g id="edge415" class="edge">
<title>mlp_fc2_0_1&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M13151.54,-8167.81C13170.54,-8162.25 13190.53,-8157.2 13209.57,-8153.8 13512.64,-8099.83 14445.97,-8074.87 14788.14,-8067.36"/>
<polygon fill="black" stroke="black" points="14788.41,-8070.85 14798.33,-8067.14 14788.26,-8063.85 14788.41,-8070.85"/>
</g>
<!-- mlp_fc2_0_2&#45;&gt;allreduce_mlp_0 -->
<g id="edge416" class="edge">
<title>mlp_fc2_0_2&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M13444.39,-8167.35C13462.18,-8162.01 13480.8,-8157.16 13498.57,-8153.8 13744.62,-8107.42 14492.51,-8078.6 14790.81,-8068.69"/>
<polygon fill="black" stroke="black" points="14791.35,-8072.17 14801.23,-8068.34 14791.12,-8065.17 14791.35,-8072.17"/>
</g>
<!-- mlp_fc2_0_3&#45;&gt;allreduce_mlp_0 -->
<g id="edge417" class="edge">
<title>mlp_fc2_0_3&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M13739.62,-8169.54C13761.79,-8163.49 13785.34,-8157.79 13807.57,-8153.8 14158.46,-8090.87 14579.87,-8072.42 14787.33,-8067.02"/>
<polygon fill="black" stroke="black" points="14787.44,-8070.52 14797.35,-8066.77 14787.26,-8063.52 14787.44,-8070.52"/>
</g>
<!-- mlp_fc2_0_4&#45;&gt;allreduce_mlp_0 -->
<g id="edge418" class="edge">
<title>mlp_fc2_0_4&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M14047.67,-8169.25C14068.28,-8163.44 14090.01,-8157.91 14110.57,-8153.8 14351.57,-8105.63 14638.74,-8081.75 14796.69,-8071.45"/>
<polygon fill="black" stroke="black" points="14797.15,-8074.92 14806.91,-8070.79 14796.7,-8067.94 14797.15,-8074.92"/>
</g>
<!-- mlp_fc2_0_5&#45;&gt;allreduce_mlp_0 -->
<g id="edge419" class="edge">
<title>mlp_fc2_0_5&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M14349.36,-8168.88C14367.59,-8163.43 14386.58,-8158.14 14404.57,-8153.8 14544.37,-8120.13 14708.59,-8093.83 14812.37,-8078.82"/>
<polygon fill="black" stroke="black" points="14813.13,-8082.24 14822.53,-8077.35 14812.13,-8075.31 14813.13,-8082.24"/>
</g>
<!-- mlp_fc2_0_6&#45;&gt;allreduce_mlp_0 -->
<g id="edge420" class="edge">
<title>mlp_fc2_0_6&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M14638.74,-8166.9C14700.92,-8143.97 14781.95,-8114.08 14840.26,-8092.58"/>
<polygon fill="black" stroke="black" points="14841.6,-8095.81 14849.78,-8089.07 14839.18,-8089.25 14841.6,-8095.81"/>
</g>
<!-- mlp_fc2_0_7&#45;&gt;allreduce_mlp_0 -->
<g id="edge421" class="edge">
<title>mlp_fc2_0_7&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M14862.88,-8154.44C14870.31,-8141.8 14878.39,-8128.05 14885.94,-8115.21"/>
<polygon fill="black" stroke="black" points="14889.02,-8116.88 14891.07,-8106.48 14882.99,-8113.33 14889.02,-8116.88"/>
</g>
<!-- mlp_fc2_0_8&#45;&gt;allreduce_mlp_0 -->
<g id="edge422" class="edge">
<title>mlp_fc2_0_8&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M15061.71,-8159.5C15033.4,-8141.16 15000.35,-8119.74 14972.85,-8101.92"/>
<polygon fill="black" stroke="black" points="14974.42,-8098.77 14964.13,-8096.27 14970.62,-8104.64 14974.42,-8098.77"/>
</g>
<!-- mlp_fc2_0_9&#45;&gt;allreduce_mlp_0 -->
<g id="edge423" class="edge">
<title>mlp_fc2_0_9&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M15320.86,-8169.48C15303.17,-8164.09 15284.86,-8158.66 15267.57,-8153.8 15178.47,-8128.76 15075.77,-8103.16 15004.39,-8085.89"/>
<polygon fill="black" stroke="black" points="15005.07,-8082.45 14994.53,-8083.51 15003.43,-8089.26 15005.07,-8082.45"/>
</g>
<!-- mlp_fc2_0_10&#45;&gt;allreduce_mlp_0 -->
<g id="edge424" class="edge">
<title>mlp_fc2_0_10&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M15618.08,-8168.61C15599.47,-8163.12 15580.03,-8157.89 15561.57,-8153.8 15376.59,-8112.88 15157.41,-8087.43 15027.79,-8074.71"/>
<polygon fill="black" stroke="black" points="15027.75,-8071.19 15017.45,-8073.7 15027.07,-8078.16 15027.75,-8071.19"/>
</g>
<!-- mlp_fc2_0_11&#45;&gt;allreduce_mlp_0 -->
<g id="edge425" class="edge">
<title>mlp_fc2_0_11&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M15914.81,-8168.34C15895.7,-8162.77 15875.63,-8157.58 15856.57,-8153.8 15567.86,-8096.63 15221.79,-8075.88 15040.46,-8068.59"/>
<polygon fill="black" stroke="black" points="15040.49,-8065.08 15030.36,-8068.19 15040.21,-8072.08 15040.49,-8065.08"/>
</g>
<!-- mlp_fc2_0_12&#45;&gt;allreduce_mlp_0 -->
<g id="edge426" class="edge">
<title>mlp_fc2_0_12&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M16212.07,-8168.24C16192.58,-8162.61 16172.07,-8157.42 16152.57,-8153.8 15755.71,-8080.21 15276.76,-8066.67 15048.75,-8064.7"/>
<polygon fill="black" stroke="black" points="15048.78,-8061.2 15038.75,-8064.62 15048.72,-8068.2 15048.78,-8061.2"/>
</g>
<!-- mlp_fc2_0_13&#45;&gt;allreduce_mlp_0 -->
<g id="edge427" class="edge">
<title>mlp_fc2_0_13&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M16509.53,-8168.15C16489.91,-8162.49 16469.23,-8157.31 16449.57,-8153.8 16180.11,-8105.76 15356.96,-8077.55 15040.94,-8068.25"/>
<polygon fill="black" stroke="black" points="15040.93,-8064.75 15030.83,-8067.95 15040.72,-8071.75 15040.93,-8064.75"/>
</g>
<!-- mlp_fc2_0_14&#45;&gt;allreduce_mlp_0 -->
<g id="edge428" class="edge">
<title>mlp_fc2_0_14&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M16806.55,-8168.01C16786.93,-8162.36 16766.25,-8157.22 16746.57,-8153.8 16418.61,-8096.92 15404.14,-8073.58 15044.01,-8066.94"/>
<polygon fill="black" stroke="black" points="15043.87,-8063.44 15033.81,-8066.75 15043.74,-8070.43 15043.87,-8063.44"/>
</g>
<!-- mlp_fc2_0_15&#45;&gt;allreduce_mlp_0 -->
<g id="edge429" class="edge">
<title>mlp_fc2_0_15&#45;&gt;allreduce_mlp_0</title>
<path fill="none" stroke="black" d="M17103.98,-8168.07C17084.23,-8162.38 17063.39,-8157.2 17043.57,-8153.8 16857.65,-8121.92 16808.03,-8142.9 16619.57,-8134.8 16026.77,-8109.35 15317.88,-8080.85 15037.91,-8069.67"/>
<polygon fill="black" stroke="black" points="15037.86,-8066.17 15027.73,-8069.27 15037.58,-8073.16 15037.86,-8066.17"/>
</g>
<!-- residual2_0 -->
<g id="node354" class="node">
<title>residual2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="14915.57" cy="-7936.3" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="14915.57" y="-7947.6" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14915.57" y="-7932.6" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="14915.57" y="-7917.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_mlp_0&#45;&gt;residual2_0 -->
<g id="edge430" class="edge">
<title>allreduce_mlp_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M14915.57,-8010.67C14915.57,-8001.96 14915.57,-7992.96 14915.57,-7984.38"/>
<polygon fill="black" stroke="black" points="14919.07,-7984.18 14915.57,-7974.18 14912.07,-7984.18 14919.07,-7984.18"/>
</g>
<!-- ln1_1_0 -->
<g id="node355" class="node">
<title>ln1_1_0</title>
<ellipse fill="lightgreen" stroke="black" cx="10300.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10300.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10300.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10300.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_0 -->
<g id="edge431" class="edge">
<title>residual2_0&#45;&gt;ln1_1_0</title>
<path fill="none" stroke="black" d="M14760.42,-7932.74C14268.31,-7924.48 12698.18,-7896.98 11398.57,-7861.8 11063.33,-7852.73 10670.61,-7838.9 10457.53,-7831.13"/>
<polygon fill="black" stroke="black" points="10457.64,-7827.63 10447.52,-7830.77 10457.39,-7834.63 10457.64,-7827.63"/>
</g>
<!-- ln1_1_1 -->
<g id="node356" class="node">
<title>ln1_1_1</title>
<ellipse fill="lightgreen" stroke="black" cx="11556.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11556.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11556.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11556.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_1 -->
<g id="edge432" class="edge">
<title>residual2_0&#45;&gt;ln1_1_1</title>
<path fill="none" stroke="black" d="M14761.48,-7930.87C14383.43,-7919.93 13379.83,-7890.43 12542.57,-7861.8 12249.78,-7851.8 11908.13,-7838.87 11713.58,-7831.39"/>
<polygon fill="black" stroke="black" points="11713.69,-7827.89 11703.57,-7831.01 11713.43,-7834.89 11713.69,-7827.89"/>
</g>
<!-- ln1_1_2 -->
<g id="node357" class="node">
<title>ln1_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="12700.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12700.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12700.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12700.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_2 -->
<g id="edge433" class="edge">
<title>residual2_0&#45;&gt;ln1_1_2</title>
<path fill="none" stroke="black" d="M14760.66,-7932.4C14354.61,-7924.35 13266.08,-7899.79 12907.57,-7861.8 12880.75,-7858.96 12852.15,-7854.72 12825.05,-7850.12"/>
<polygon fill="black" stroke="black" points="12825.59,-7846.66 12815.14,-7848.41 12824.4,-7853.56 12825.59,-7846.66"/>
</g>
<!-- ln1_1_3 -->
<g id="node358" class="node">
<title>ln1_1_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13065.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13065.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13065.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13065.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_3 -->
<g id="edge434" class="edge">
<title>residual2_0&#45;&gt;ln1_1_3</title>
<path fill="none" stroke="black" d="M14761.02,-7931.83C14481.52,-7924.69 13873.58,-7905.24 13362.57,-7861.8 13310.88,-7857.41 13254.32,-7850.89 13204.55,-7844.57"/>
<polygon fill="black" stroke="black" points="13204.73,-7841.07 13194.37,-7843.27 13203.84,-7848.01 13204.73,-7841.07"/>
</g>
<!-- ln1_1_4 -->
<g id="node359" class="node">
<title>ln1_1_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13520.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13520.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13520.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13520.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_4 -->
<g id="edge435" class="edge">
<title>residual2_0&#45;&gt;ln1_1_4</title>
<path fill="none" stroke="black" d="M14763.28,-7928.49C14547.72,-7918.11 14141.44,-7895.9 13796.57,-7861.8 13751.3,-7857.33 13702,-7851.21 13657.76,-7845.26"/>
<polygon fill="black" stroke="black" points="13658.2,-7841.79 13647.82,-7843.91 13657.26,-7848.72 13658.2,-7841.79"/>
</g>
<!-- ln1_1_5 -->
<g id="node360" class="node">
<title>ln1_1_5</title>
<ellipse fill="lightgreen" stroke="black" cx="13954.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13954.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13954.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13954.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_5 -->
<g id="edge436" class="edge">
<title>residual2_0&#45;&gt;ln1_1_5</title>
<path fill="none" stroke="black" d="M14768.77,-7923.77C14618.46,-7911.27 14378.23,-7889.36 14171.57,-7861.8 14143.12,-7858.01 14112.67,-7853.3 14083.86,-7848.54"/>
<polygon fill="black" stroke="black" points="14084.18,-7845.04 14073.74,-7846.85 14083.03,-7851.95 14084.18,-7845.04"/>
</g>
<!-- ln1_1_6 -->
<g id="node361" class="node">
<title>ln1_1_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14329.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14329.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14329.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14329.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_6 -->
<g id="edge437" class="edge">
<title>residual2_0&#45;&gt;ln1_1_6</title>
<path fill="none" stroke="black" d="M14793.15,-7912.99C14714.4,-7898.57 14609.91,-7879.29 14517.57,-7861.8 14497.41,-7857.99 14476.04,-7853.89 14455.22,-7849.86"/>
<polygon fill="black" stroke="black" points="14455.86,-7846.42 14445.37,-7847.96 14454.53,-7853.29 14455.86,-7846.42"/>
</g>
<!-- ln1_1_7 -->
<g id="node362" class="node">
<title>ln1_1_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14675.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14675.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14675.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14675.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_7 -->
<g id="edge438" class="edge">
<title>residual2_0&#45;&gt;ln1_1_7</title>
<path fill="none" stroke="black" d="M14844.86,-7902.9C14816.67,-7889.97 14784.07,-7875.03 14755.06,-7861.74"/>
<polygon fill="black" stroke="black" points="14756.33,-7858.47 14745.78,-7857.48 14753.41,-7864.83 14756.33,-7858.47"/>
</g>
<!-- ln1_1_8 -->
<g id="node363" class="node">
<title>ln1_1_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15155.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15155.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15155.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15155.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_8 -->
<g id="edge439" class="edge">
<title>residual2_0&#45;&gt;ln1_1_8</title>
<path fill="none" stroke="black" d="M14986.28,-7902.9C15014.48,-7889.97 15047.07,-7875.03 15076.09,-7861.74"/>
<polygon fill="black" stroke="black" points="15077.74,-7864.83 15085.37,-7857.48 15074.82,-7858.47 15077.74,-7864.83"/>
</g>
<!-- ln1_1_9 -->
<g id="node364" class="node">
<title>ln1_1_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15553.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15553.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15553.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15553.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_9 -->
<g id="edge440" class="edge">
<title>residual2_0&#45;&gt;ln1_1_9</title>
<path fill="none" stroke="black" d="M15040.1,-7913.83C15150.19,-7894.85 15310.26,-7867.26 15422.32,-7847.93"/>
<polygon fill="black" stroke="black" points="15423.08,-7851.36 15432.34,-7846.21 15421.89,-7844.46 15423.08,-7851.36"/>
</g>
<!-- ln1_1_10 -->
<g id="node365" class="node">
<title>ln1_1_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15910.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15910.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15910.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15910.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_10 -->
<g id="edge441" class="edge">
<title>residual2_0&#45;&gt;ln1_1_10</title>
<path fill="none" stroke="black" d="M15064.57,-7925.54C15224.84,-7914.1 15486.95,-7892.71 15711.57,-7861.8 15735.58,-7858.5 15761.1,-7854.33 15785.58,-7849.99"/>
<polygon fill="black" stroke="black" points="15786.4,-7853.4 15795.63,-7848.19 15785.17,-7846.51 15786.4,-7853.4"/>
</g>
<!-- ln1_1_11 -->
<g id="node366" class="node">
<title>ln1_1_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16246.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16246.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16246.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16246.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_11 -->
<g id="edge442" class="edge">
<title>residual2_0&#45;&gt;ln1_1_11</title>
<path fill="none" stroke="black" d="M15070.57,-7932.24C15292.55,-7926.3 15713.45,-7909.3 16068.57,-7861.8 16087.83,-7859.23 16108.13,-7855.78 16127.85,-7852.03"/>
<polygon fill="black" stroke="black" points="16128.63,-7855.44 16137.78,-7850.1 16127.3,-7848.57 16128.63,-7855.44"/>
</g>
<!-- ln1_1_12 -->
<g id="node367" class="node">
<title>ln1_1_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16572.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16572.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16572.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16572.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_12 -->
<g id="edge443" class="edge">
<title>residual2_0&#45;&gt;ln1_1_12</title>
<path fill="none" stroke="black" d="M15071.21,-7936.02C15342.98,-7935.41 15921.24,-7925.8 16404.57,-7861.8 16421.64,-7859.54 16439.54,-7856.45 16457.04,-7853.01"/>
<polygon fill="black" stroke="black" points="16458.18,-7856.35 16467.29,-7850.95 16456.8,-7849.49 16458.18,-7856.35"/>
</g>
<!-- ln1_1_13 -->
<g id="node368" class="node">
<title>ln1_1_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16893.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16893.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16893.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16893.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_13 -->
<g id="edge444" class="edge">
<title>residual2_0&#45;&gt;ln1_1_13</title>
<path fill="none" stroke="black" d="M15068.34,-7929.13C15318.12,-7919.03 15829.51,-7898.36 16262.57,-7880.8 16470.57,-7872.37 16524.17,-7888.88 16730.57,-7861.8 16746.65,-7859.7 16763.47,-7856.77 16779.95,-7853.48"/>
<polygon fill="black" stroke="black" points="16781.07,-7856.82 16790.16,-7851.39 16779.66,-7849.97 16781.07,-7856.82"/>
</g>
<!-- ln1_1_14 -->
<g id="node369" class="node">
<title>ln1_1_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17212.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17212.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17212.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17212.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_14 -->
<g id="edge445" class="edge">
<title>residual2_0&#45;&gt;ln1_1_14</title>
<path fill="none" stroke="black" d="M15070.8,-7933.76C15495.15,-7928.94 16668.41,-7911.38 17051.57,-7861.8 17067.34,-7859.76 17083.84,-7856.89 17100.01,-7853.65"/>
<polygon fill="black" stroke="black" points="17100.94,-7857.03 17110.03,-7851.58 17099.52,-7850.18 17100.94,-7857.03"/>
</g>
<!-- ln1_1_15 -->
<g id="node370" class="node">
<title>ln1_1_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17529.57" cy="-7824.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17529.57" y="-7835.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17529.57" y="-7820.6" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17529.57" y="-7805.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_15 -->
<g id="edge446" class="edge">
<title>residual2_0&#45;&gt;ln1_1_15</title>
<path fill="none" stroke="black" d="M15069.87,-7931.53C15400.16,-7923.34 16200.13,-7902.89 16870.57,-7880.8 17092.84,-7873.48 17150.12,-7891.03 17370.57,-7861.8 17385.77,-7859.79 17401.66,-7856.99 17417.25,-7853.84"/>
<polygon fill="black" stroke="black" points="17418.37,-7857.18 17427.45,-7851.72 17416.95,-7850.33 17418.37,-7857.18"/>
</g>
<!-- qkv_proj_1_0 -->
<g id="node371" class="node">
<title>qkv_proj_1_0</title>
<ellipse fill="orange" stroke="black" cx="8695.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8695.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8695.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8695.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="8695.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8695.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_0&#45;&gt;qkv_proj_1_0 -->
<g id="edge447" class="edge">
<title>ln1_1_0&#45;&gt;qkv_proj_1_0</title>
<path fill="none" stroke="black" d="M10159.9,-7811.81C9859.19,-7787.23 9156.06,-7729.75 8846.47,-7704.45"/>
<polygon fill="black" stroke="black" points="8846.32,-7700.92 8836.07,-7703.6 8845.75,-7707.9 8846.32,-7700.92"/>
</g>
<!-- qkv_proj_1_1 -->
<g id="node372" class="node">
<title>qkv_proj_1_1</title>
<ellipse fill="orange" stroke="black" cx="10084.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10084.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10084.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10084.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="10084.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10084.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_1&#45;&gt;qkv_proj_1_1 -->
<g id="edge448" class="edge">
<title>ln1_1_1&#45;&gt;qkv_proj_1_1</title>
<path fill="none" stroke="black" d="M11417.1,-7810.87C11139.53,-7786.14 10520.16,-7730.94 10234.36,-7705.46"/>
<polygon fill="black" stroke="black" points="10234.6,-7701.97 10224.33,-7704.57 10233.98,-7708.94 10234.6,-7701.97"/>
</g>
<!-- qkv_proj_1_2 -->
<g id="node373" class="node">
<title>qkv_proj_1_2</title>
<ellipse fill="orange" stroke="black" cx="11013.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11013.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11013.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11013.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="11013.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11013.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_2&#45;&gt;qkv_proj_1_2 -->
<g id="edge449" class="edge">
<title>ln1_1_2&#45;&gt;qkv_proj_1_2</title>
<path fill="none" stroke="black" d="M12559.28,-7812.32C12244.6,-7787.85 11488.38,-7729.04 11164.71,-7703.87"/>
<polygon fill="black" stroke="black" points="11164.56,-7700.35 11154.32,-7703.06 11164.02,-7707.32 11164.56,-7700.35"/>
</g>
<!-- qkv_proj_1_3 -->
<g id="node374" class="node">
<title>qkv_proj_1_3</title>
<ellipse fill="orange" stroke="black" cx="12724.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12724.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12724.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12724.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="12724.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12724.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_3&#45;&gt;qkv_proj_1_3 -->
<g id="edge450" class="edge">
<title>ln1_1_3&#45;&gt;qkv_proj_1_3</title>
<path fill="none" stroke="black" d="M12985.62,-7792.55C12941.52,-7775.58 12886.02,-7754.23 12837.55,-7735.58"/>
<polygon fill="black" stroke="black" points="12838.54,-7732.21 12827.95,-7731.89 12836.03,-7738.74 12838.54,-7732.21"/>
</g>
<!-- qkv_proj_1_4 -->
<g id="node375" class="node">
<title>qkv_proj_1_4</title>
<ellipse fill="orange" stroke="black" cx="13167.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13167.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13167.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13167.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="13167.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13167.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_4&#45;&gt;qkv_proj_1_4 -->
<g id="edge451" class="edge">
<title>ln1_1_4&#45;&gt;qkv_proj_1_4</title>
<path fill="none" stroke="black" d="M13438.7,-7792.88C13392.2,-7775.6 13333.27,-7753.69 13282.23,-7734.73"/>
<polygon fill="black" stroke="black" points="13283.39,-7731.42 13272.8,-7731.22 13280.95,-7737.98 13283.39,-7731.42"/>
</g>
<!-- qkv_proj_1_5 -->
<g id="node376" class="node">
<title>qkv_proj_1_5</title>
<ellipse fill="orange" stroke="black" cx="13566.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13566.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13566.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13566.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="13566.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13566.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_5&#45;&gt;qkv_proj_1_5 -->
<g id="edge452" class="edge">
<title>ln1_1_5&#45;&gt;qkv_proj_1_5</title>
<path fill="none" stroke="black" d="M13867.5,-7793.86C13813.95,-7775.76 13744.6,-7752.31 13685.97,-7732.49"/>
<polygon fill="black" stroke="black" points="13686.88,-7729.1 13676.29,-7729.21 13684.64,-7735.73 13686.88,-7729.1"/>
</g>
<!-- qkv_proj_1_6 -->
<g id="node377" class="node">
<title>qkv_proj_1_6</title>
<ellipse fill="orange" stroke="black" cx="14108.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14108.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14108.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14108.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="14108.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14108.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_6&#45;&gt;qkv_proj_1_6 -->
<g id="edge453" class="edge">
<title>ln1_1_6&#45;&gt;qkv_proj_1_6</title>
<path fill="none" stroke="black" d="M14272.66,-7789.52C14249.89,-7776.01 14223.12,-7760.11 14197.89,-7745.13"/>
<polygon fill="black" stroke="black" points="14199.42,-7741.97 14189.03,-7739.88 14195.84,-7747.99 14199.42,-7741.97"/>
</g>
<!-- qkv_proj_1_7 -->
<g id="node378" class="node">
<title>qkv_proj_1_7</title>
<ellipse fill="orange" stroke="black" cx="14671.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14671.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14671.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14671.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="14671.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14671.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_7&#45;&gt;qkv_proj_1_7 -->
<g id="edge454" class="edge">
<title>ln1_1_7&#45;&gt;qkv_proj_1_7</title>
<path fill="none" stroke="black" d="M14674.46,-7786.76C14674.21,-7778.5 14673.93,-7769.46 14673.65,-7760.36"/>
<polygon fill="black" stroke="black" points="14677.14,-7759.98 14673.34,-7750.09 14670.15,-7760.2 14677.14,-7759.98"/>
</g>
<!-- qkv_proj_1_8 -->
<g id="node379" class="node">
<title>qkv_proj_1_8</title>
<ellipse fill="orange" stroke="black" cx="15498.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15498.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15498.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15498.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="15498.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15498.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_8&#45;&gt;qkv_proj_1_8 -->
<g id="edge455" class="edge">
<title>ln1_1_8&#45;&gt;qkv_proj_1_8</title>
<path fill="none" stroke="black" d="M15235.99,-7792.55C15280.54,-7775.51 15336.65,-7754.05 15385.55,-7735.34"/>
<polygon fill="black" stroke="black" points="15386.82,-7738.61 15394.91,-7731.76 15384.32,-7732.07 15386.82,-7738.61"/>
</g>
<!-- qkv_proj_1_9 -->
<g id="node380" class="node">
<title>qkv_proj_1_9</title>
<ellipse fill="orange" stroke="black" cx="15828.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15828.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15828.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15828.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="15828.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15828.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_9&#45;&gt;qkv_proj_1_9 -->
<g id="edge456" class="edge">
<title>ln1_1_9&#45;&gt;qkv_proj_1_9</title>
<path fill="none" stroke="black" d="M15621.55,-7790.88C15653.31,-7775.73 15691.78,-7757.37 15726.9,-7740.62"/>
<polygon fill="black" stroke="black" points="15728.71,-7743.63 15736.22,-7736.17 15725.69,-7737.32 15728.71,-7743.63"/>
</g>
<!-- qkv_proj_1_10 -->
<g id="node381" class="node">
<title>qkv_proj_1_10</title>
<ellipse fill="orange" stroke="black" cx="16146.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16146.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16146.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16146.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="16146.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16146.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_10&#45;&gt;qkv_proj_1_10 -->
<g id="edge457" class="edge">
<title>ln1_1_10&#45;&gt;qkv_proj_1_10</title>
<path fill="none" stroke="black" d="M15970.74,-7789.86C15995.88,-7775.89 16025.67,-7759.33 16053.52,-7743.84"/>
<polygon fill="black" stroke="black" points="16055.44,-7746.78 16062.48,-7738.86 16052.04,-7740.66 16055.44,-7746.78"/>
</g>
<!-- qkv_proj_1_11 -->
<g id="node382" class="node">
<title>qkv_proj_1_11</title>
<ellipse fill="orange" stroke="black" cx="16857.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16857.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16857.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16857.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="16857.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16857.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_11&#45;&gt;qkv_proj_1_11 -->
<g id="edge458" class="edge">
<title>ln1_1_11&#45;&gt;qkv_proj_1_11</title>
<path fill="none" stroke="black" d="M16357.71,-7799.1C16376.68,-7794.99 16396.19,-7790.77 16414.57,-7786.8 16517.29,-7764.67 16633.45,-7739.85 16721.04,-7721.17"/>
<polygon fill="black" stroke="black" points="16721.99,-7724.55 16731.04,-7719.04 16720.53,-7717.7 16721.99,-7724.55"/>
</g>
<!-- qkv_proj_1_12 -->
<g id="node383" class="node">
<title>qkv_proj_1_12</title>
<ellipse fill="orange" stroke="black" cx="17168.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17168.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17168.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17168.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="17168.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17168.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_12&#45;&gt;qkv_proj_1_12 -->
<g id="edge459" class="edge">
<title>ln1_1_12&#45;&gt;qkv_proj_1_12</title>
<path fill="none" stroke="black" d="M16679.27,-7798.02C16697.98,-7793.99 16717.3,-7790.07 16735.57,-7786.8 16856.97,-7765.09 16890.84,-7779.35 17010.57,-7749.8 17025.95,-7746.01 17041.91,-7741.23 17057.5,-7736.06"/>
<polygon fill="black" stroke="black" points="17058.81,-7739.31 17067.16,-7732.8 17056.57,-7732.68 17058.81,-7739.31"/>
</g>
<!-- qkv_proj_1_13 -->
<g id="node384" class="node">
<title>qkv_proj_1_13</title>
<ellipse fill="orange" stroke="black" cx="17476.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17476.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17476.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17476.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="17476.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17476.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_13&#45;&gt;qkv_proj_1_13 -->
<g id="edge460" class="edge">
<title>ln1_1_13&#45;&gt;qkv_proj_1_13</title>
<path fill="none" stroke="black" d="M16999.83,-7797.87C17018.04,-7793.9 17036.81,-7790.04 17054.57,-7786.8 17172.43,-7765.32 17205.41,-7779.1 17321.57,-7749.8 17336.19,-7746.12 17351.33,-7741.52 17366.17,-7736.53"/>
<polygon fill="black" stroke="black" points="17367.54,-7739.76 17375.86,-7733.21 17365.27,-7733.14 17367.54,-7739.76"/>
</g>
<!-- qkv_proj_1_14 -->
<g id="node385" class="node">
<title>qkv_proj_1_14</title>
<ellipse fill="orange" stroke="black" cx="18431.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18431.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18431.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18431.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="18431.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18431.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_14&#45;&gt;qkv_proj_1_14 -->
<g id="edge461" class="edge">
<title>ln1_1_14&#45;&gt;qkv_proj_1_14</title>
<path fill="none" stroke="black" d="M17317.91,-7797.63C17335.76,-7793.71 17354.15,-7789.93 17371.57,-7786.8 17435.98,-7775.25 17452.5,-7774.73 17517.57,-7767.8 17785.43,-7739.3 18098.42,-7715.41 18279.92,-7702.49"/>
<polygon fill="black" stroke="black" points="18280.34,-7705.97 18290.07,-7701.77 18279.85,-7698.99 18280.34,-7705.97"/>
</g>
<!-- qkv_proj_1_15 -->
<g id="node386" class="node">
<title>qkv_proj_1_15</title>
<ellipse fill="orange" stroke="black" cx="19061.57" cy="-7691.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="19061.57" y="-7717.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19061.57" y="-7702.41" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="19061.57" y="-7687.41" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="19061.57" y="-7672.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19061.57" y="-7657.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_15&#45;&gt;qkv_proj_1_15 -->
<g id="edge462" class="edge">
<title>ln1_1_15&#45;&gt;qkv_proj_1_15</title>
<path fill="none" stroke="black" d="M17674.82,-7815.53C17878.42,-7804.09 18260.15,-7780.7 18584.57,-7749.8 18695.84,-7739.21 18821.31,-7723.9 18915.63,-7711.71"/>
<polygon fill="black" stroke="black" points="18916.35,-7715.15 18925.81,-7710.39 18915.45,-7708.21 18916.35,-7715.15"/>
</g>
<!-- reshape_qkv_1_0 -->
<g id="node387" class="node">
<title>reshape_qkv_1_0</title>
<ellipse fill="lightcyan" stroke="black" cx="8293.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8293.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8293.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8293.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_0&#45;&gt;reshape_qkv_1_0 -->
<g id="edge463" class="edge">
<title>qkv_proj_1_0&#45;&gt;reshape_qkv_1_0</title>
<path fill="none" stroke="black" d="M8584.39,-7653.83C8524.74,-7634.36 8451.8,-7610.56 8393.89,-7591.66"/>
<polygon fill="black" stroke="black" points="8394.95,-7588.33 8384.36,-7588.55 8392.78,-7594.98 8394.95,-7588.33"/>
</g>
<!-- reshape_qkv_1_1 -->
<g id="node400" class="node">
<title>reshape_qkv_1_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9255.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9255.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9255.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9255.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_1&#45;&gt;reshape_qkv_1_1 -->
<g id="edge478" class="edge">
<title>qkv_proj_1_1&#45;&gt;reshape_qkv_1_1</title>
<path fill="none" stroke="black" d="M9951.38,-7669.04C9798.66,-7644.87 9549.47,-7605.43 9394.42,-7580.9"/>
<polygon fill="black" stroke="black" points="9394.77,-7577.41 9384.34,-7579.3 9393.67,-7584.32 9394.77,-7577.41"/>
</g>
<!-- reshape_qkv_1_2 -->
<g id="node412" class="node">
<title>reshape_qkv_1_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10112.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10112.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10112.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10112.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_2&#45;&gt;reshape_qkv_1_2 -->
<g id="edge493" class="edge">
<title>qkv_proj_1_2&#45;&gt;reshape_qkv_1_2</title>
<path fill="none" stroke="black" d="M10878.68,-7670.47C10710.94,-7646.05 10425.88,-7604.54 10254.8,-7579.63"/>
<polygon fill="black" stroke="black" points="10255.11,-7576.14 10244.71,-7578.16 10254.1,-7583.07 10255.11,-7576.14"/>
</g>
<!-- reshape_qkv_1_3 -->
<g id="node424" class="node">
<title>reshape_qkv_1_3</title>
<ellipse fill="lightcyan" stroke="black" cx="11039.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11039.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11039.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11039.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_3&#45;&gt;reshape_qkv_1_3 -->
<g id="edge508" class="edge">
<title>qkv_proj_1_3&#45;&gt;reshape_qkv_1_3</title>
<path fill="none" stroke="black" d="M12583.81,-7679.16C12271.94,-7654.87 11524.6,-7596.69 11197.45,-7571.22"/>
<polygon fill="black" stroke="black" points="11197.66,-7567.72 11187.42,-7570.44 11197.12,-7574.7 11197.66,-7567.72"/>
</g>
<!-- reshape_qkv_1_4 -->
<g id="node437" class="node">
<title>reshape_qkv_1_4</title>
<ellipse fill="lightcyan" stroke="black" cx="12007.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12007.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12007.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12007.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_4&#45;&gt;reshape_qkv_1_4 -->
<g id="edge524" class="edge">
<title>qkv_proj_1_4&#45;&gt;reshape_qkv_1_4</title>
<path fill="none" stroke="black" d="M13042.48,-7662.04C12991.55,-7651.45 12931.96,-7640.11 12877.57,-7632.42 12632.25,-7597.77 12345.53,-7577.41 12170.29,-7567.21"/>
<polygon fill="black" stroke="black" points="12170.39,-7563.71 12160.21,-7566.63 12169.99,-7570.7 12170.39,-7563.71"/>
</g>
<!-- reshape_qkv_1_5 -->
<g id="node450" class="node">
<title>reshape_qkv_1_5</title>
<ellipse fill="lightcyan" stroke="black" cx="12893.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12893.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12893.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12893.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_5&#45;&gt;reshape_qkv_1_5 -->
<g id="edge539" class="edge">
<title>qkv_proj_1_5&#45;&gt;reshape_qkv_1_5</title>
<path fill="none" stroke="black" d="M13444.58,-7659.98C13405.12,-7650.64 13361.09,-7640.65 13320.57,-7632.42 13224.94,-7613 13116.58,-7594.39 13032.95,-7580.75"/>
<polygon fill="black" stroke="black" points="13033.31,-7577.26 13022.88,-7579.11 13032.19,-7584.17 13033.31,-7577.26"/>
</g>
<!-- reshape_qkv_1_6 -->
<g id="node462" class="node">
<title>reshape_qkv_1_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13814.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13814.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13814.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13814.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_6&#45;&gt;reshape_qkv_1_6 -->
<g id="edge554" class="edge">
<title>qkv_proj_1_6&#45;&gt;reshape_qkv_1_6</title>
<path fill="none" stroke="black" d="M14012.71,-7647.34C13975.18,-7630.59 13932.57,-7611.58 13896.5,-7595.48"/>
<polygon fill="black" stroke="black" points="13897.56,-7592.12 13887,-7591.24 13894.7,-7598.51 13897.56,-7592.12"/>
</g>
<!-- reshape_qkv_1_7 -->
<g id="node474" class="node">
<title>reshape_qkv_1_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14664.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14664.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14664.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14664.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_7&#45;&gt;reshape_qkv_1_7 -->
<g id="edge569" class="edge">
<title>qkv_proj_1_7&#45;&gt;reshape_qkv_1_7</title>
<path fill="none" stroke="black" d="M14668.48,-7632.19C14668.01,-7623.31 14667.52,-7614.24 14667.07,-7605.64"/>
<polygon fill="black" stroke="black" points="14670.55,-7605.23 14666.52,-7595.43 14663.56,-7605.6 14670.55,-7605.23"/>
</g>
<!-- reshape_qkv_1_8 -->
<g id="node487" class="node">
<title>reshape_qkv_1_8</title>
<ellipse fill="lightcyan" stroke="black" cx="15531.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15531.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15531.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15531.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_8&#45;&gt;reshape_qkv_1_8 -->
<g id="edge585" class="edge">
<title>qkv_proj_1_8&#45;&gt;reshape_qkv_1_8</title>
<path fill="none" stroke="black" d="M15513.05,-7632.57C15515.31,-7623.57 15517.63,-7614.36 15519.82,-7605.63"/>
<polygon fill="black" stroke="black" points="15523.29,-7606.21 15522.33,-7595.66 15516.5,-7604.5 15523.29,-7606.21"/>
</g>
<!-- reshape_qkv_1_9 -->
<g id="node500" class="node">
<title>reshape_qkv_1_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16292.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16292.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16292.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16292.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_9&#45;&gt;reshape_qkv_1_9 -->
<g id="edge600" class="edge">
<title>qkv_proj_1_9&#45;&gt;reshape_qkv_1_9</title>
<path fill="none" stroke="black" d="M15934.6,-7651.37C15954.11,-7644.72 15974.37,-7638.13 15993.57,-7632.42 16050.98,-7615.38 16115.4,-7599.17 16169.71,-7586.34"/>
<polygon fill="black" stroke="black" points="16170.79,-7589.68 16179.72,-7583.98 16169.19,-7582.87 16170.79,-7589.68"/>
</g>
<!-- reshape_qkv_1_10 -->
<g id="node512" class="node">
<title>reshape_qkv_1_10</title>
<ellipse fill="lightcyan" stroke="black" cx="17219.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17219.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17219.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17219.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_10&#45;&gt;reshape_qkv_1_10 -->
<g id="edge615" class="edge">
<title>qkv_proj_1_10&#45;&gt;reshape_qkv_1_10</title>
<path fill="none" stroke="black" d="M16283.56,-7673.37C16485.9,-7648.63 16863.14,-7602.5 17071.6,-7577.02"/>
<polygon fill="black" stroke="black" points="17072.21,-7580.47 17081.71,-7575.78 17071.36,-7573.52 17072.21,-7580.47"/>
</g>
<!-- reshape_qkv_1_11 -->
<g id="node524" class="node">
<title>reshape_qkv_1_11</title>
<ellipse fill="lightcyan" stroke="black" cx="18229.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18229.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18229.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18229.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_11&#45;&gt;reshape_qkv_1_11 -->
<g id="edge630" class="edge">
<title>qkv_proj_1_11&#45;&gt;reshape_qkv_1_11</title>
<path fill="none" stroke="black" d="M16957.45,-7648.73C16976.47,-7642.27 16996.42,-7636.41 17015.57,-7632.42 17115.6,-7611.6 17758.33,-7580.25 18065.95,-7566.19"/>
<polygon fill="black" stroke="black" points="18066.47,-7569.67 18076.3,-7565.72 18066.15,-7562.68 18066.47,-7569.67"/>
</g>
<!-- reshape_qkv_1_12 -->
<g id="node537" class="node">
<title>reshape_qkv_1_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19144.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19144.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19144.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19144.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_12&#45;&gt;reshape_qkv_1_12 -->
<g id="edge646" class="edge">
<title>qkv_proj_1_12&#45;&gt;reshape_qkv_1_12</title>
<path fill="none" stroke="black" d="M17266.84,-7648.18C17285.38,-7641.81 17304.84,-7636.13 17323.57,-7632.42 17557.4,-7586.14 18157.42,-7605.34 18395.57,-7595.42 18597.75,-7587.01 18830.52,-7575.36 18982.22,-7567.5"/>
<polygon fill="black" stroke="black" points="18982.74,-7570.98 18992.54,-7566.97 18982.37,-7563.99 18982.74,-7570.98"/>
</g>
<!-- reshape_qkv_1_13 -->
<g id="node550" class="node">
<title>reshape_qkv_1_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20071.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20071.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20071.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20071.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_13&#45;&gt;reshape_qkv_1_13 -->
<g id="edge661" class="edge">
<title>qkv_proj_1_13&#45;&gt;reshape_qkv_1_13</title>
<path fill="none" stroke="black" d="M17617.01,-7678.48C17777.04,-7665.57 18046.48,-7644.93 18278.57,-7632.42 18736.87,-7607.73 18852.01,-7614.64 19310.57,-7595.42 19517.15,-7586.77 19755.19,-7575.07 19909.25,-7567.28"/>
<polygon fill="black" stroke="black" points="19909.46,-7570.77 19919.27,-7566.77 19909.11,-7563.78 19909.46,-7570.77"/>
</g>
<!-- reshape_qkv_1_14 -->
<g id="node562" class="node">
<title>reshape_qkv_1_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20921.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20921.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20921.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20921.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_14&#45;&gt;reshape_qkv_1_14 -->
<g id="edge676" class="edge">
<title>qkv_proj_1_14&#45;&gt;reshape_qkv_1_14</title>
<path fill="none" stroke="black" d="M18564.85,-7669.27C18689.34,-7650.82 18880.53,-7625.05 19047.57,-7613.42 19575.25,-7576.7 19708.93,-7613.52 20237.57,-7595.42 20416.86,-7589.29 20622.35,-7577.71 20760.92,-7569.23"/>
<polygon fill="black" stroke="black" points="20761.43,-7572.71 20771.2,-7568.6 20761,-7565.72 20761.43,-7572.71"/>
</g>
<!-- reshape_qkv_1_15 -->
<g id="node574" class="node">
<title>reshape_qkv_1_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21924.57" cy="-7557.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21924.57" y="-7569.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21924.57" y="-7554.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21924.57" y="-7539.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_15&#45;&gt;reshape_qkv_1_15 -->
<g id="edge691" class="edge">
<title>qkv_proj_1_15&#45;&gt;reshape_qkv_1_15</title>
<path fill="none" stroke="black" d="M19204.04,-7683.59C19685.49,-7661.52 21250.34,-7589.82 21761.44,-7566.4"/>
<polygon fill="black" stroke="black" points="21761.65,-7569.89 21771.48,-7565.94 21761.33,-7562.9 21761.65,-7569.89"/>
</g>
<!-- split_q_1_0 -->
<g id="node388" class="node">
<title>split_q_1_0</title>
<ellipse fill="pink" stroke="black" cx="7865.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7865.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7865.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7865.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_q_1_0 -->
<g id="edge464" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_q_1_0</title>
<path fill="none" stroke="black" d="M8188.87,-7530.02C8124.61,-7513.5 8042.37,-7492.36 7976.92,-7475.54"/>
<polygon fill="black" stroke="black" points="7977.54,-7472.09 7966.98,-7472.99 7975.79,-7478.87 7977.54,-7472.09"/>
</g>
<!-- split_k_1_0 -->
<g id="node389" class="node">
<title>split_k_1_0</title>
<ellipse fill="pink" stroke="black" cx="8174.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8174.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8174.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8174.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_k_1_0 -->
<g id="edge465" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_k_1_0</title>
<path fill="none" stroke="black" d="M8255.27,-7521.51C8244.12,-7511.21 8231.83,-7499.85 8220.28,-7489.17"/>
<polygon fill="black" stroke="black" points="8222.53,-7486.49 8212.81,-7482.27 8217.78,-7491.63 8222.53,-7486.49"/>
</g>
<!-- split_v_1_0 -->
<g id="node390" class="node">
<title>split_v_1_0</title>
<ellipse fill="pink" stroke="black" cx="8483.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8483.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8483.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8483.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_v_1_0 -->
<g id="edge466" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_v_1_0</title>
<path fill="none" stroke="black" d="M8352.13,-7523.02C8372.55,-7511.2 8395.61,-7497.85 8416.66,-7485.67"/>
<polygon fill="black" stroke="black" points="8418.64,-7488.56 8425.54,-7480.52 8415.13,-7482.51 8418.64,-7488.56"/>
</g>
<!-- transpose_q_1_0 -->
<g id="node391" class="node">
<title>transpose_q_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="7865.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7865.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7865.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7865.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_0&#45;&gt;transpose_q_1_0 -->
<g id="edge467" class="edge">
<title>split_q_1_0&#45;&gt;transpose_q_1_0</title>
<path fill="none" stroke="black" d="M7865.57,-7408.3C7865.57,-7399.85 7865.57,-7390.75 7865.57,-7381.94"/>
<polygon fill="black" stroke="black" points="7869.07,-7381.77 7865.57,-7371.77 7862.07,-7381.77 7869.07,-7381.77"/>
</g>
<!-- transpose_k_1_0 -->
<g id="node392" class="node">
<title>transpose_k_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="8174.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8174.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8174.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8174.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_0&#45;&gt;transpose_k_1_0 -->
<g id="edge468" class="edge">
<title>split_k_1_0&#45;&gt;transpose_k_1_0</title>
<path fill="none" stroke="black" d="M8174.57,-7408.3C8174.57,-7399.85 8174.57,-7390.75 8174.57,-7381.94"/>
<polygon fill="black" stroke="black" points="8178.07,-7381.77 8174.57,-7371.77 8171.07,-7381.77 8178.07,-7381.77"/>
</g>
<!-- transpose_v_1_0 -->
<g id="node393" class="node">
<title>transpose_v_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="8483.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8483.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8483.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8483.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_0&#45;&gt;transpose_v_1_0 -->
<g id="edge469" class="edge">
<title>split_v_1_0&#45;&gt;transpose_v_1_0</title>
<path fill="none" stroke="black" d="M8483.57,-7408.3C8483.57,-7399.85 8483.57,-7390.75 8483.57,-7381.94"/>
<polygon fill="black" stroke="black" points="8487.07,-7381.77 8483.57,-7371.77 8480.07,-7381.77 8487.07,-7381.77"/>
</g>
<!-- attn_scores_1_0 -->
<g id="node394" class="node">
<title>attn_scores_1_0</title>
<ellipse fill="gold" stroke="black" cx="8174.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8174.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8174.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8174.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_0&#45;&gt;attn_scores_1_0 -->
<g id="edge470" class="edge">
<title>transpose_q_1_0&#45;&gt;attn_scores_1_0</title>
<path fill="none" stroke="black" d="M7949.19,-7303.16C7988.91,-7289.02 8036.6,-7272.04 8077.86,-7257.35"/>
<polygon fill="black" stroke="black" points="8079.13,-7260.62 8087.38,-7253.96 8076.79,-7254.02 8079.13,-7260.62"/>
</g>
<!-- transpose_k_1_0&#45;&gt;attn_scores_1_0 -->
<g id="edge471" class="edge">
<title>transpose_k_1_0&#45;&gt;attn_scores_1_0</title>
<path fill="none" stroke="black" d="M8174.57,-7296.3C8174.57,-7287.85 8174.57,-7278.75 8174.57,-7269.94"/>
<polygon fill="black" stroke="black" points="8178.07,-7269.77 8174.57,-7259.77 8171.07,-7269.77 8178.07,-7269.77"/>
</g>
<!-- attn_output_1_0 -->
<g id="node395" class="node">
<title>attn_output_1_0</title>
<ellipse fill="gold" stroke="black" cx="8483.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8483.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8483.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8483.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_0&#45;&gt;attn_output_1_0 -->
<g id="edge472" class="edge">
<title>transpose_v_1_0&#45;&gt;attn_output_1_0</title>
<path fill="none" stroke="black" d="M8483.57,-7296.23C8483.57,-7235.18 8483.57,-7112.87 8483.57,-7045.72"/>
<polygon fill="black" stroke="black" points="8487.07,-7045.43 8483.57,-7035.43 8480.07,-7045.43 8487.07,-7045.43"/>
</g>
<!-- softmax_1_0 -->
<g id="node396" class="node">
<title>softmax_1_0</title>
<ellipse fill="gold" stroke="black" cx="8260.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8260.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8260.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8260.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_0&#45;&gt;softmax_1_0 -->
<g id="edge473" class="edge">
<title>attn_scores_1_0&#45;&gt;softmax_1_0</title>
<path fill="none" stroke="black" d="M8202.73,-7184.91C8210.16,-7175.41 8218.25,-7165.05 8225.98,-7155.18"/>
<polygon fill="black" stroke="black" points="8228.95,-7157.06 8232.35,-7147.02 8223.43,-7152.75 8228.95,-7157.06"/>
</g>
<!-- transpose_back_1_0 -->
<g id="node397" class="node">
<title>transpose_back_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="9566.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9566.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9566.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9566.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_0&#45;&gt;transpose_back_1_0 -->
<g id="edge475" class="edge">
<title>attn_output_1_0&#45;&gt;transpose_back_1_0</title>
<path fill="none" stroke="black" d="M8617.73,-6983.3C8822.46,-6962.5 9211.24,-6923.02 9422.01,-6901.61"/>
<polygon fill="black" stroke="black" points="9422.63,-6905.06 9432.22,-6900.57 9421.92,-6898.1 9422.63,-6905.06"/>
</g>
<!-- softmax_1_0&#45;&gt;attn_output_1_0 -->
<g id="edge474" class="edge">
<title>softmax_1_0&#45;&gt;attn_output_1_0</title>
<path fill="none" stroke="black" d="M8328.09,-7075.62C8353.43,-7063.12 8382.38,-7048.84 8408.38,-7036.02"/>
<polygon fill="black" stroke="black" points="8410.02,-7039.11 8417.44,-7031.55 8406.92,-7032.83 8410.02,-7039.11"/>
</g>
<!-- reshape_concat_1_0 -->
<g id="node398" class="node">
<title>reshape_concat_1_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9666.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9666.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9666.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9666.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_0&#45;&gt;reshape_concat_1_0 -->
<g id="edge476" class="edge">
<title>transpose_back_1_0&#45;&gt;reshape_concat_1_0</title>
<path fill="none" stroke="black" d="M9599.04,-6849.21C9608.13,-6839.22 9618.1,-6828.25 9627.52,-6817.88"/>
<polygon fill="black" stroke="black" points="9630.13,-6820.21 9634.27,-6810.46 9624.95,-6815.5 9630.13,-6820.21"/>
</g>
<!-- allgather_dim_1_0 -->
<g id="node399" class="node">
<title>allgather_dim_1_0</title>
<polygon fill="red" stroke="black" points="10266.57,-6699.42 10093.57,-6646.42 10266.57,-6593.42 10439.57,-6646.42 10266.57,-6699.42"/>
<text text-anchor="middle" x="10266.57" y="-6657.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="10266.57" y="-6642.72" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10266.57" y="-6627.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_0&#45;&gt;allgather_dim_1_0 -->
<g id="edge477" class="edge">
<title>reshape_concat_1_0&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M9765.86,-6748.84C9784.04,-6744.59 9802.86,-6740.29 9820.57,-6736.42 9932.66,-6711.97 10061.19,-6686.6 10151.39,-6669.24"/>
<polygon fill="black" stroke="black" points="10152.21,-6672.64 10161.37,-6667.32 10150.89,-6665.77 10152.21,-6672.64"/>
</g>
<!-- head_group_1_0 -->
<g id="node436" class="node">
<title>head_group_1_0</title>
<polygon fill="lightyellow" stroke="black" points="14445.07,-6556.42 14248.07,-6556.42 14248.07,-6518.42 14445.07,-6518.42 14445.07,-6556.42"/>
<text text-anchor="middle" x="14346.57" y="-6541.22" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="14346.57" y="-6526.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_0&#45;&gt;head_group_1_0 -->
<g id="edge523" class="edge">
<title>allgather_dim_1_0&#45;&gt;head_group_1_0</title>
<path fill="none" stroke="black" d="M10423.08,-6641.32C11088.57,-6623.87 13674.78,-6556.04 14237.92,-6541.27"/>
<polygon fill="black" stroke="black" points="14238.16,-6544.77 14248.07,-6541.01 14237.98,-6537.77 14238.16,-6544.77"/>
</g>
<!-- split_q_1_1 -->
<g id="node401" class="node">
<title>split_q_1_1</title>
<ellipse fill="pink" stroke="black" cx="8792.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8792.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8792.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8792.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_q_1_1 -->
<g id="edge479" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_q_1_1</title>
<path fill="none" stroke="black" d="M9146.44,-7531C9074.68,-7513.95 8980.93,-7491.67 8907.95,-7474.34"/>
<polygon fill="black" stroke="black" points="8908.33,-7470.83 8897.79,-7471.92 8906.71,-7477.64 8908.33,-7470.83"/>
</g>
<!-- split_k_1_1 -->
<g id="node402" class="node">
<title>split_k_1_1</title>
<ellipse fill="pink" stroke="black" cx="9101.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9101.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9101.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9101.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_k_1_1 -->
<g id="edge480" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_k_1_1</title>
<path fill="none" stroke="black" d="M9206.85,-7522.12C9191.31,-7511.02 9174,-7498.66 9157.97,-7487.21"/>
<polygon fill="black" stroke="black" points="9159.89,-7484.28 9149.72,-7481.31 9155.82,-7489.98 9159.89,-7484.28"/>
</g>
<!-- split_v_1_1 -->
<g id="node403" class="node">
<title>split_v_1_1</title>
<ellipse fill="pink" stroke="black" cx="9410.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9410.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9410.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9410.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_v_1_1 -->
<g id="edge481" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_v_1_1</title>
<path fill="none" stroke="black" d="M9304.62,-7522.12C9320.25,-7511.02 9337.68,-7498.66 9353.81,-7487.21"/>
<polygon fill="black" stroke="black" points="9355.99,-7489.96 9362.11,-7481.31 9351.93,-7484.25 9355.99,-7489.96"/>
</g>
<!-- transpose_q_1_1 -->
<g id="node404" class="node">
<title>transpose_q_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="8792.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8792.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8792.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8792.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_1&#45;&gt;transpose_q_1_1 -->
<g id="edge482" class="edge">
<title>split_q_1_1&#45;&gt;transpose_q_1_1</title>
<path fill="none" stroke="black" d="M8792.57,-7408.3C8792.57,-7399.85 8792.57,-7390.75 8792.57,-7381.94"/>
<polygon fill="black" stroke="black" points="8796.07,-7381.77 8792.57,-7371.77 8789.07,-7381.77 8796.07,-7381.77"/>
</g>
<!-- transpose_k_1_1 -->
<g id="node405" class="node">
<title>transpose_k_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="9101.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9101.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9101.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9101.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_1&#45;&gt;transpose_k_1_1 -->
<g id="edge483" class="edge">
<title>split_k_1_1&#45;&gt;transpose_k_1_1</title>
<path fill="none" stroke="black" d="M9101.57,-7408.3C9101.57,-7399.85 9101.57,-7390.75 9101.57,-7381.94"/>
<polygon fill="black" stroke="black" points="9105.07,-7381.77 9101.57,-7371.77 9098.07,-7381.77 9105.07,-7381.77"/>
</g>
<!-- transpose_v_1_1 -->
<g id="node406" class="node">
<title>transpose_v_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="9410.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9410.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9410.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9410.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_1&#45;&gt;transpose_v_1_1 -->
<g id="edge484" class="edge">
<title>split_v_1_1&#45;&gt;transpose_v_1_1</title>
<path fill="none" stroke="black" d="M9410.57,-7408.3C9410.57,-7399.85 9410.57,-7390.75 9410.57,-7381.94"/>
<polygon fill="black" stroke="black" points="9414.07,-7381.77 9410.57,-7371.77 9407.07,-7381.77 9414.07,-7381.77"/>
</g>
<!-- attn_scores_1_1 -->
<g id="node407" class="node">
<title>attn_scores_1_1</title>
<ellipse fill="gold" stroke="black" cx="9101.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9101.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9101.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9101.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_1&#45;&gt;attn_scores_1_1 -->
<g id="edge485" class="edge">
<title>transpose_q_1_1&#45;&gt;attn_scores_1_1</title>
<path fill="none" stroke="black" d="M8876.19,-7303.16C8915.91,-7289.02 8963.6,-7272.04 9004.86,-7257.35"/>
<polygon fill="black" stroke="black" points="9006.13,-7260.62 9014.38,-7253.96 9003.79,-7254.02 9006.13,-7260.62"/>
</g>
<!-- transpose_k_1_1&#45;&gt;attn_scores_1_1 -->
<g id="edge486" class="edge">
<title>transpose_k_1_1&#45;&gt;attn_scores_1_1</title>
<path fill="none" stroke="black" d="M9101.57,-7296.3C9101.57,-7287.85 9101.57,-7278.75 9101.57,-7269.94"/>
<polygon fill="black" stroke="black" points="9105.07,-7269.77 9101.57,-7259.77 9098.07,-7269.77 9105.07,-7269.77"/>
</g>
<!-- attn_output_1_1 -->
<g id="node408" class="node">
<title>attn_output_1_1</title>
<ellipse fill="gold" stroke="black" cx="9410.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9410.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9410.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9410.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_1&#45;&gt;attn_output_1_1 -->
<g id="edge487" class="edge">
<title>transpose_v_1_1&#45;&gt;attn_output_1_1</title>
<path fill="none" stroke="black" d="M9410.57,-7296.23C9410.57,-7235.18 9410.57,-7112.87 9410.57,-7045.72"/>
<polygon fill="black" stroke="black" points="9414.07,-7045.43 9410.57,-7035.43 9407.07,-7045.43 9414.07,-7045.43"/>
</g>
<!-- softmax_1_1 -->
<g id="node409" class="node">
<title>softmax_1_1</title>
<ellipse fill="gold" stroke="black" cx="9158.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9158.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9158.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9158.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_1&#45;&gt;softmax_1_1 -->
<g id="edge488" class="edge">
<title>attn_scores_1_1&#45;&gt;softmax_1_1</title>
<path fill="none" stroke="black" d="M9120.4,-7184.6C9125.11,-7175.5 9130.23,-7165.62 9135.15,-7156.14"/>
<polygon fill="black" stroke="black" points="9138.28,-7157.7 9139.77,-7147.21 9132.06,-7154.48 9138.28,-7157.7"/>
</g>
<!-- transpose_back_1_1 -->
<g id="node410" class="node">
<title>transpose_back_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="9930.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9930.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9930.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9930.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_1&#45;&gt;transpose_back_1_1 -->
<g id="edge490" class="edge">
<title>attn_output_1_1&#45;&gt;transpose_back_1_1</title>
<path fill="none" stroke="black" d="M9521.17,-6973.53C9605.88,-6955.61 9722.6,-6930.92 9809.75,-6912.48"/>
<polygon fill="black" stroke="black" points="9810.63,-6915.87 9819.69,-6910.38 9809.19,-6909.03 9810.63,-6915.87"/>
</g>
<!-- softmax_1_1&#45;&gt;attn_output_1_1 -->
<g id="edge489" class="edge">
<title>softmax_1_1&#45;&gt;attn_output_1_1</title>
<path fill="none" stroke="black" d="M9233.16,-7076.37C9263.15,-7063.28 9297.83,-7048.14 9328.52,-7034.74"/>
<polygon fill="black" stroke="black" points="9330.15,-7037.85 9337.91,-7030.64 9327.35,-7031.43 9330.15,-7037.85"/>
</g>
<!-- reshape_concat_1_1 -->
<g id="node411" class="node">
<title>reshape_concat_1_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9962.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9962.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9962.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9962.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_1&#45;&gt;reshape_concat_1_1 -->
<g id="edge491" class="edge">
<title>transpose_back_1_1&#45;&gt;reshape_concat_1_1</title>
<path fill="none" stroke="black" d="M9941.23,-6848.3C9943.77,-6839.58 9946.51,-6830.16 9949.15,-6821.07"/>
<polygon fill="black" stroke="black" points="9952.53,-6821.97 9951.96,-6811.39 9945.81,-6820.02 9952.53,-6821.97"/>
</g>
<!-- reshape_concat_1_1&#45;&gt;allgather_dim_1_0 -->
<g id="edge492" class="edge">
<title>reshape_concat_1_1&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M10036.16,-6742.54C10081.04,-6724.02 10138.48,-6700.3 10184.78,-6681.19"/>
<polygon fill="black" stroke="black" points="10186.28,-6684.36 10194.19,-6677.31 10183.61,-6677.89 10186.28,-6684.36"/>
</g>
<!-- split_q_1_2 -->
<g id="node413" class="node">
<title>split_q_1_2</title>
<ellipse fill="pink" stroke="black" cx="9719.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9719.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9719.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9719.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_q_1_2 -->
<g id="edge494" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_q_1_2</title>
<path fill="none" stroke="black" d="M10012.64,-7528.95C9955.67,-7513.01 9884.29,-7493.03 9826.24,-7476.78"/>
<polygon fill="black" stroke="black" points="9826.88,-7473.33 9816.31,-7474 9824.99,-7480.07 9826.88,-7473.33"/>
</g>
<!-- split_k_1_2 -->
<g id="node414" class="node">
<title>split_k_1_2</title>
<ellipse fill="pink" stroke="black" cx="10028.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10028.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10028.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10028.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_k_1_2 -->
<g id="edge495" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_k_1_2</title>
<path fill="none" stroke="black" d="M10085.07,-7520.91C10077.82,-7511.41 10069.91,-7501.05 10062.37,-7491.18"/>
<polygon fill="black" stroke="black" points="10064.99,-7488.85 10056.14,-7483.02 10059.43,-7493.1 10064.99,-7488.85"/>
</g>
<!-- split_v_1_2 -->
<g id="node415" class="node">
<title>split_v_1_2</title>
<ellipse fill="pink" stroke="black" cx="10337.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10337.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10337.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10337.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_v_1_2 -->
<g id="edge496" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_v_1_2</title>
<path fill="none" stroke="black" d="M10180.08,-7523.92C10205.9,-7511.3 10235.51,-7496.82 10262.03,-7483.86"/>
<polygon fill="black" stroke="black" points="10263.83,-7486.87 10271.28,-7479.34 10260.75,-7480.58 10263.83,-7486.87"/>
</g>
<!-- transpose_q_1_2 -->
<g id="node416" class="node">
<title>transpose_q_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="9719.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9719.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9719.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9719.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_2&#45;&gt;transpose_q_1_2 -->
<g id="edge497" class="edge">
<title>split_q_1_2&#45;&gt;transpose_q_1_2</title>
<path fill="none" stroke="black" d="M9719.57,-7408.3C9719.57,-7399.85 9719.57,-7390.75 9719.57,-7381.94"/>
<polygon fill="black" stroke="black" points="9723.07,-7381.77 9719.57,-7371.77 9716.07,-7381.77 9723.07,-7381.77"/>
</g>
<!-- transpose_k_1_2 -->
<g id="node417" class="node">
<title>transpose_k_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="10028.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10028.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10028.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10028.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_2&#45;&gt;transpose_k_1_2 -->
<g id="edge498" class="edge">
<title>split_k_1_2&#45;&gt;transpose_k_1_2</title>
<path fill="none" stroke="black" d="M10028.57,-7408.3C10028.57,-7399.85 10028.57,-7390.75 10028.57,-7381.94"/>
<polygon fill="black" stroke="black" points="10032.07,-7381.77 10028.57,-7371.77 10025.07,-7381.77 10032.07,-7381.77"/>
</g>
<!-- transpose_v_1_2 -->
<g id="node418" class="node">
<title>transpose_v_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="10337.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10337.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10337.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10337.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_2&#45;&gt;transpose_v_1_2 -->
<g id="edge499" class="edge">
<title>split_v_1_2&#45;&gt;transpose_v_1_2</title>
<path fill="none" stroke="black" d="M10337.57,-7408.3C10337.57,-7399.85 10337.57,-7390.75 10337.57,-7381.94"/>
<polygon fill="black" stroke="black" points="10341.07,-7381.77 10337.57,-7371.77 10334.07,-7381.77 10341.07,-7381.77"/>
</g>
<!-- attn_scores_1_2 -->
<g id="node419" class="node">
<title>attn_scores_1_2</title>
<ellipse fill="gold" stroke="black" cx="10028.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10028.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10028.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10028.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_2&#45;&gt;attn_scores_1_2 -->
<g id="edge500" class="edge">
<title>transpose_q_1_2&#45;&gt;attn_scores_1_2</title>
<path fill="none" stroke="black" d="M9803.19,-7303.16C9842.91,-7289.02 9890.6,-7272.04 9931.86,-7257.35"/>
<polygon fill="black" stroke="black" points="9933.13,-7260.62 9941.38,-7253.96 9930.79,-7254.02 9933.13,-7260.62"/>
</g>
<!-- transpose_k_1_2&#45;&gt;attn_scores_1_2 -->
<g id="edge501" class="edge">
<title>transpose_k_1_2&#45;&gt;attn_scores_1_2</title>
<path fill="none" stroke="black" d="M10028.57,-7296.3C10028.57,-7287.85 10028.57,-7278.75 10028.57,-7269.94"/>
<polygon fill="black" stroke="black" points="10032.07,-7269.77 10028.57,-7259.77 10025.07,-7269.77 10032.07,-7269.77"/>
</g>
<!-- attn_output_1_2 -->
<g id="node420" class="node">
<title>attn_output_1_2</title>
<ellipse fill="gold" stroke="black" cx="10266.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10266.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10266.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10266.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_2&#45;&gt;attn_output_1_2 -->
<g id="edge502" class="edge">
<title>transpose_v_1_2&#45;&gt;attn_output_1_2</title>
<path fill="none" stroke="black" d="M10329.77,-7296.23C10316.77,-7235.06 10290.69,-7112.36 10276.43,-7045.3"/>
<polygon fill="black" stroke="black" points="10279.84,-7044.48 10274.33,-7035.43 10272.99,-7045.94 10279.84,-7044.48"/>
</g>
<!-- softmax_1_2 -->
<g id="node421" class="node">
<title>softmax_1_2</title>
<ellipse fill="gold" stroke="black" cx="10070.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10070.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10070.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10070.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_2&#45;&gt;softmax_1_2 -->
<g id="edge503" class="edge">
<title>attn_scores_1_2&#45;&gt;softmax_1_2</title>
<path fill="none" stroke="black" d="M10042.56,-7184.3C10045.92,-7175.48 10049.56,-7165.96 10053.06,-7156.78"/>
<polygon fill="black" stroke="black" points="10056.35,-7157.98 10056.65,-7147.39 10049.81,-7155.49 10056.35,-7157.98"/>
</g>
<!-- transpose_back_1_2 -->
<g id="node422" class="node">
<title>transpose_back_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="10266.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10266.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10266.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10266.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_2&#45;&gt;transpose_back_1_2 -->
<g id="edge505" class="edge">
<title>attn_output_1_2&#45;&gt;transpose_back_1_2</title>
<path fill="none" stroke="black" d="M10266.57,-6960.3C10266.57,-6951.85 10266.57,-6942.75 10266.57,-6933.94"/>
<polygon fill="black" stroke="black" points="10270.07,-6933.77 10266.57,-6923.77 10263.07,-6933.77 10270.07,-6933.77"/>
</g>
<!-- softmax_1_2&#45;&gt;attn_output_1_2 -->
<g id="edge504" class="edge">
<title>softmax_1_2&#45;&gt;attn_output_1_2</title>
<path fill="none" stroke="black" d="M10131.25,-7074.87C10152.49,-7062.95 10176.49,-7049.48 10198.31,-7037.23"/>
<polygon fill="black" stroke="black" points="10200.19,-7040.2 10207.2,-7032.25 10196.76,-7034.09 10200.19,-7040.2"/>
</g>
<!-- reshape_concat_1_2 -->
<g id="node423" class="node">
<title>reshape_concat_1_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10266.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10266.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10266.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10266.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_2&#45;&gt;reshape_concat_1_2 -->
<g id="edge506" class="edge">
<title>transpose_back_1_2&#45;&gt;reshape_concat_1_2</title>
<path fill="none" stroke="black" d="M10266.57,-6848.3C10266.57,-6839.85 10266.57,-6830.75 10266.57,-6821.94"/>
<polygon fill="black" stroke="black" points="10270.07,-6821.77 10266.57,-6811.77 10263.07,-6821.77 10270.07,-6821.77"/>
</g>
<!-- reshape_concat_1_2&#45;&gt;allgather_dim_1_0 -->
<g id="edge507" class="edge">
<title>reshape_concat_1_2&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M10266.57,-6736.29C10266.57,-6727.98 10266.57,-6718.93 10266.57,-6709.89"/>
<polygon fill="black" stroke="black" points="10270.07,-6709.73 10266.57,-6699.73 10263.07,-6709.73 10270.07,-6709.73"/>
</g>
<!-- split_q_1_3 -->
<g id="node425" class="node">
<title>split_q_1_3</title>
<ellipse fill="pink" stroke="black" cx="10646.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10646.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10646.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10646.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_q_1_3 -->
<g id="edge509" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_q_1_3</title>
<path fill="none" stroke="black" d="M10939.64,-7528.95C10882.67,-7513.01 10811.29,-7493.03 10753.24,-7476.78"/>
<polygon fill="black" stroke="black" points="10753.88,-7473.33 10743.31,-7474 10751.99,-7480.07 10753.88,-7473.33"/>
</g>
<!-- split_k_1_3 -->
<g id="node426" class="node">
<title>split_k_1_3</title>
<ellipse fill="pink" stroke="black" cx="10955.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10955.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10955.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10955.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_k_1_3 -->
<g id="edge510" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_k_1_3</title>
<path fill="none" stroke="black" d="M11012.07,-7520.91C11004.82,-7511.41 10996.91,-7501.05 10989.37,-7491.18"/>
<polygon fill="black" stroke="black" points="10991.99,-7488.85 10983.14,-7483.02 10986.43,-7493.1 10991.99,-7488.85"/>
</g>
<!-- split_v_1_3 -->
<g id="node427" class="node">
<title>split_v_1_3</title>
<ellipse fill="pink" stroke="black" cx="11264.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11264.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11264.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11264.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_v_1_3 -->
<g id="edge511" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_v_1_3</title>
<path fill="none" stroke="black" d="M11107.08,-7523.92C11132.9,-7511.3 11162.51,-7496.82 11189.03,-7483.86"/>
<polygon fill="black" stroke="black" points="11190.83,-7486.87 11198.28,-7479.34 11187.75,-7480.58 11190.83,-7486.87"/>
</g>
<!-- transpose_q_1_3 -->
<g id="node428" class="node">
<title>transpose_q_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10646.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10646.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10646.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10646.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_3&#45;&gt;transpose_q_1_3 -->
<g id="edge512" class="edge">
<title>split_q_1_3&#45;&gt;transpose_q_1_3</title>
<path fill="none" stroke="black" d="M10646.57,-7408.3C10646.57,-7399.85 10646.57,-7390.75 10646.57,-7381.94"/>
<polygon fill="black" stroke="black" points="10650.07,-7381.77 10646.57,-7371.77 10643.07,-7381.77 10650.07,-7381.77"/>
</g>
<!-- transpose_k_1_3 -->
<g id="node429" class="node">
<title>transpose_k_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10955.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10955.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10955.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10955.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_3&#45;&gt;transpose_k_1_3 -->
<g id="edge513" class="edge">
<title>split_k_1_3&#45;&gt;transpose_k_1_3</title>
<path fill="none" stroke="black" d="M10955.57,-7408.3C10955.57,-7399.85 10955.57,-7390.75 10955.57,-7381.94"/>
<polygon fill="black" stroke="black" points="10959.07,-7381.77 10955.57,-7371.77 10952.07,-7381.77 10959.07,-7381.77"/>
</g>
<!-- transpose_v_1_3 -->
<g id="node430" class="node">
<title>transpose_v_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="11264.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11264.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11264.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11264.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_3&#45;&gt;transpose_v_1_3 -->
<g id="edge514" class="edge">
<title>split_v_1_3&#45;&gt;transpose_v_1_3</title>
<path fill="none" stroke="black" d="M11264.57,-7408.3C11264.57,-7399.85 11264.57,-7390.75 11264.57,-7381.94"/>
<polygon fill="black" stroke="black" points="11268.07,-7381.77 11264.57,-7371.77 11261.07,-7381.77 11268.07,-7381.77"/>
</g>
<!-- attn_scores_1_3 -->
<g id="node431" class="node">
<title>attn_scores_1_3</title>
<ellipse fill="gold" stroke="black" cx="10765.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10765.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10765.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10765.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_3&#45;&gt;attn_scores_1_3 -->
<g id="edge515" class="edge">
<title>transpose_q_1_3&#45;&gt;attn_scores_1_3</title>
<path fill="none" stroke="black" d="M10684.88,-7297.51C10695.92,-7287.31 10708.07,-7276.08 10719.52,-7265.49"/>
<polygon fill="black" stroke="black" points="10721.96,-7268 10726.93,-7258.65 10717.21,-7262.86 10721.96,-7268"/>
</g>
<!-- transpose_k_1_3&#45;&gt;attn_scores_1_3 -->
<g id="edge516" class="edge">
<title>transpose_k_1_3&#45;&gt;attn_scores_1_3</title>
<path fill="none" stroke="black" d="M10897.79,-7299.47C10877.54,-7287.75 10854.61,-7274.47 10833.59,-7262.31"/>
<polygon fill="black" stroke="black" points="10835.13,-7259.15 10824.72,-7257.17 10831.62,-7265.21 10835.13,-7259.15"/>
</g>
<!-- attn_output_1_3 -->
<g id="node432" class="node">
<title>attn_output_1_3</title>
<ellipse fill="gold" stroke="black" cx="10765.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10765.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10765.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10765.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_3&#45;&gt;attn_output_1_3 -->
<g id="edge517" class="edge">
<title>transpose_v_1_3&#45;&gt;attn_output_1_3</title>
<path fill="none" stroke="black" d="M11227.92,-7297.47C11170.59,-7243.44 11054.53,-7139.7 10941.57,-7072.42 10916.12,-7057.27 10886.97,-7043.73 10859.81,-7032.53"/>
<polygon fill="black" stroke="black" points="10860.88,-7029.18 10850.29,-7028.67 10858.24,-7035.67 10860.88,-7029.18"/>
</g>
<!-- softmax_1_3 -->
<g id="node433" class="node">
<title>softmax_1_3</title>
<ellipse fill="gold" stroke="black" cx="10765.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10765.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10765.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10765.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_3&#45;&gt;softmax_1_3 -->
<g id="edge518" class="edge">
<title>attn_scores_1_3&#45;&gt;softmax_1_3</title>
<path fill="none" stroke="black" d="M10765.57,-7184.3C10765.57,-7175.85 10765.57,-7166.75 10765.57,-7157.94"/>
<polygon fill="black" stroke="black" points="10769.07,-7157.77 10765.57,-7147.77 10762.07,-7157.77 10769.07,-7157.77"/>
</g>
<!-- transpose_back_1_3 -->
<g id="node434" class="node">
<title>transpose_back_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10621.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10621.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10621.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10621.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_3&#45;&gt;transpose_back_1_3 -->
<g id="edge520" class="edge">
<title>attn_output_1_3&#45;&gt;transpose_back_1_3</title>
<path fill="none" stroke="black" d="M10720.01,-6962.12C10705.83,-6951.29 10690.06,-6939.24 10675.37,-6928.02"/>
<polygon fill="black" stroke="black" points="10677.41,-6925.17 10667.33,-6921.88 10673.16,-6930.73 10677.41,-6925.17"/>
</g>
<!-- softmax_1_3&#45;&gt;attn_output_1_3 -->
<g id="edge519" class="edge">
<title>softmax_1_3&#45;&gt;attn_output_1_3</title>
<path fill="none" stroke="black" d="M10765.57,-7072.3C10765.57,-7063.85 10765.57,-7054.75 10765.57,-7045.94"/>
<polygon fill="black" stroke="black" points="10769.07,-7045.77 10765.57,-7035.77 10762.07,-7045.77 10769.07,-7045.77"/>
</g>
<!-- reshape_concat_1_3 -->
<g id="node435" class="node">
<title>reshape_concat_1_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10603.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10603.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10603.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10603.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_3&#45;&gt;reshape_concat_1_3 -->
<g id="edge521" class="edge">
<title>transpose_back_1_3&#45;&gt;reshape_concat_1_3</title>
<path fill="none" stroke="black" d="M10615.58,-6848.3C10614.17,-6839.67 10612.64,-6830.36 10611.17,-6821.36"/>
<polygon fill="black" stroke="black" points="10614.61,-6820.7 10609.54,-6811.39 10607.7,-6821.83 10614.61,-6820.7"/>
</g>
<!-- reshape_concat_1_3&#45;&gt;allgather_dim_1_0 -->
<g id="edge522" class="edge">
<title>reshape_concat_1_3&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M10524.99,-6743.66C10473.34,-6724.42 10405.75,-6699.25 10352.65,-6679.48"/>
<polygon fill="black" stroke="black" points="10353.84,-6676.19 10343.25,-6675.98 10351.4,-6682.75 10353.84,-6676.19"/>
</g>
<!-- output_proj_1_0 -->
<g id="node587" class="node">
<title>output_proj_1_0</title>
<ellipse fill="orange" stroke="black" cx="15333.57" cy="-6433.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15333.57" y="-6452.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15333.57" y="-6437.14" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="15333.57" y="-6422.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15333.57" y="-6407.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_0&#45;&gt;output_proj_1_0 -->
<g id="edge707" class="edge">
<title>head_group_1_0&#45;&gt;output_proj_1_0</title>
<path fill="none" stroke="black" d="M14445.1,-6523.96C14460.97,-6522.05 14477.22,-6520.14 14492.57,-6518.42 14736.95,-6491.15 15021.76,-6463.55 15189.35,-6447.74"/>
<polygon fill="black" stroke="black" points="15189.84,-6451.21 15199.47,-6446.79 15189.19,-6444.24 15189.84,-6451.21"/>
</g>
<!-- split_q_1_4 -->
<g id="node438" class="node">
<title>split_q_1_4</title>
<ellipse fill="pink" stroke="black" cx="11573.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11573.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11573.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11573.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_q_1_4 -->
<g id="edge525" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_q_1_4</title>
<path fill="none" stroke="black" d="M11901.96,-7530.16C11836.31,-7513.52 11752.01,-7492.15 11685.26,-7475.23"/>
<polygon fill="black" stroke="black" points="11686.09,-7471.83 11675.54,-7472.77 11684.37,-7478.62 11686.09,-7471.83"/>
</g>
<!-- split_k_1_4 -->
<g id="node439" class="node">
<title>split_k_1_4</title>
<ellipse fill="pink" stroke="black" cx="11882.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11882.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11882.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11882.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_k_1_4 -->
<g id="edge526" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_k_1_4</title>
<path fill="none" stroke="black" d="M11967.33,-7521.51C11955.63,-7511.21 11942.72,-7499.85 11930.58,-7489.17"/>
<polygon fill="black" stroke="black" points="11932.56,-7486.25 11922.74,-7482.27 11927.93,-7491.5 11932.56,-7486.25"/>
</g>
<!-- split_v_1_4 -->
<g id="node440" class="node">
<title>split_v_1_4</title>
<ellipse fill="pink" stroke="black" cx="12191.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12191.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12191.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12191.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_v_1_4 -->
<g id="edge527" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_v_1_4</title>
<path fill="none" stroke="black" d="M12064.53,-7522.87C12084.12,-7511.17 12106.19,-7497.97 12126.38,-7485.9"/>
<polygon fill="black" stroke="black" points="12128.41,-7488.76 12135.2,-7480.63 12124.82,-7482.75 12128.41,-7488.76"/>
</g>
<!-- transpose_q_1_4 -->
<g id="node441" class="node">
<title>transpose_q_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="11573.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11573.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11573.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11573.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_4&#45;&gt;transpose_q_1_4 -->
<g id="edge528" class="edge">
<title>split_q_1_4&#45;&gt;transpose_q_1_4</title>
<path fill="none" stroke="black" d="M11573.57,-7408.3C11573.57,-7399.85 11573.57,-7390.75 11573.57,-7381.94"/>
<polygon fill="black" stroke="black" points="11577.07,-7381.77 11573.57,-7371.77 11570.07,-7381.77 11577.07,-7381.77"/>
</g>
<!-- transpose_k_1_4 -->
<g id="node442" class="node">
<title>transpose_k_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="11882.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11882.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11882.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11882.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_4&#45;&gt;transpose_k_1_4 -->
<g id="edge529" class="edge">
<title>split_k_1_4&#45;&gt;transpose_k_1_4</title>
<path fill="none" stroke="black" d="M11882.57,-7408.3C11882.57,-7399.85 11882.57,-7390.75 11882.57,-7381.94"/>
<polygon fill="black" stroke="black" points="11886.07,-7381.77 11882.57,-7371.77 11879.07,-7381.77 11886.07,-7381.77"/>
</g>
<!-- transpose_v_1_4 -->
<g id="node443" class="node">
<title>transpose_v_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="12191.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12191.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12191.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12191.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_4&#45;&gt;transpose_v_1_4 -->
<g id="edge530" class="edge">
<title>split_v_1_4&#45;&gt;transpose_v_1_4</title>
<path fill="none" stroke="black" d="M12191.57,-7408.3C12191.57,-7399.85 12191.57,-7390.75 12191.57,-7381.94"/>
<polygon fill="black" stroke="black" points="12195.07,-7381.77 12191.57,-7371.77 12188.07,-7381.77 12195.07,-7381.77"/>
</g>
<!-- attn_scores_1_4 -->
<g id="node444" class="node">
<title>attn_scores_1_4</title>
<ellipse fill="gold" stroke="black" cx="11882.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11882.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11882.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11882.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_4&#45;&gt;attn_scores_1_4 -->
<g id="edge531" class="edge">
<title>transpose_q_1_4&#45;&gt;attn_scores_1_4</title>
<path fill="none" stroke="black" d="M11657.19,-7303.16C11696.91,-7289.02 11744.6,-7272.04 11785.86,-7257.35"/>
<polygon fill="black" stroke="black" points="11787.13,-7260.62 11795.38,-7253.96 11784.79,-7254.02 11787.13,-7260.62"/>
</g>
<!-- transpose_k_1_4&#45;&gt;attn_scores_1_4 -->
<g id="edge532" class="edge">
<title>transpose_k_1_4&#45;&gt;attn_scores_1_4</title>
<path fill="none" stroke="black" d="M11882.57,-7296.3C11882.57,-7287.85 11882.57,-7278.75 11882.57,-7269.94"/>
<polygon fill="black" stroke="black" points="11886.07,-7269.77 11882.57,-7259.77 11879.07,-7269.77 11886.07,-7269.77"/>
</g>
<!-- attn_output_1_4 -->
<g id="node445" class="node">
<title>attn_output_1_4</title>
<ellipse fill="gold" stroke="black" cx="12191.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12191.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12191.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12191.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_4&#45;&gt;attn_output_1_4 -->
<g id="edge533" class="edge">
<title>transpose_v_1_4&#45;&gt;attn_output_1_4</title>
<path fill="none" stroke="black" d="M12191.57,-7296.23C12191.57,-7235.18 12191.57,-7112.87 12191.57,-7045.72"/>
<polygon fill="black" stroke="black" points="12195.07,-7045.43 12191.57,-7035.43 12188.07,-7045.43 12195.07,-7045.43"/>
</g>
<!-- softmax_1_4 -->
<g id="node446" class="node">
<title>softmax_1_4</title>
<ellipse fill="gold" stroke="black" cx="11939.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11939.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11939.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11939.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_4&#45;&gt;softmax_1_4 -->
<g id="edge534" class="edge">
<title>attn_scores_1_4&#45;&gt;softmax_1_4</title>
<path fill="none" stroke="black" d="M11901.4,-7184.6C11906.11,-7175.5 11911.23,-7165.62 11916.15,-7156.14"/>
<polygon fill="black" stroke="black" points="11919.28,-7157.7 11920.77,-7147.21 11913.06,-7154.48 11919.28,-7157.7"/>
</g>
<!-- transpose_back_1_4 -->
<g id="node447" class="node">
<title>transpose_back_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="12668.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12668.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12668.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12668.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_4&#45;&gt;transpose_back_1_4 -->
<g id="edge536" class="edge">
<title>attn_output_1_4&#45;&gt;transpose_back_1_4</title>
<path fill="none" stroke="black" d="M12298.32,-6972.31C12373.65,-6954.94 12474.52,-6931.68 12551.95,-6913.82"/>
<polygon fill="black" stroke="black" points="12552.79,-6917.22 12561.75,-6911.56 12551.22,-6910.4 12552.79,-6917.22"/>
</g>
<!-- softmax_1_4&#45;&gt;attn_output_1_4 -->
<g id="edge535" class="edge">
<title>softmax_1_4&#45;&gt;attn_output_1_4</title>
<path fill="none" stroke="black" d="M12014.16,-7076.37C12044.15,-7063.28 12078.83,-7048.14 12109.52,-7034.74"/>
<polygon fill="black" stroke="black" points="12111.15,-7037.85 12118.91,-7030.64 12108.35,-7031.43 12111.15,-7037.85"/>
</g>
<!-- reshape_concat_1_4 -->
<g id="node448" class="node">
<title>reshape_concat_1_4</title>
<ellipse fill="lightcyan" stroke="black" cx="13004.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13004.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13004.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13004.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_4&#45;&gt;reshape_concat_1_4 -->
<g id="edge537" class="edge">
<title>transpose_back_1_4&#45;&gt;reshape_concat_1_4</title>
<path fill="none" stroke="black" d="M12756.85,-6856.02C12803.88,-6840.63 12861.74,-6821.68 12909.72,-6805.98"/>
<polygon fill="black" stroke="black" points="12911.08,-6809.22 12919.49,-6802.78 12908.9,-6802.56 12911.08,-6809.22"/>
</g>
<!-- allgather_dim_1_1 -->
<g id="node449" class="node">
<title>allgather_dim_1_1</title>
<polygon fill="red" stroke="black" points="14010.57,-6699.42 13837.57,-6646.42 14010.57,-6593.42 14183.57,-6646.42 14010.57,-6699.42"/>
<text text-anchor="middle" x="14010.57" y="-6657.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="14010.57" y="-6642.72" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14010.57" y="-6627.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_4&#45;&gt;allgather_dim_1_1 -->
<g id="edge538" class="edge">
<title>reshape_concat_1_4&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M13124.92,-6757.91C13314.98,-6734.2 13683.14,-6688.27 13879.61,-6663.76"/>
<polygon fill="black" stroke="black" points="13880.21,-6667.22 13889.7,-6662.5 13879.34,-6660.27 13880.21,-6667.22"/>
</g>
<!-- head_group_1_1 -->
<g id="node486" class="node">
<title>head_group_1_1</title>
<polygon fill="lightyellow" stroke="black" points="14698.07,-6556.42 14501.07,-6556.42 14501.07,-6518.42 14698.07,-6518.42 14698.07,-6556.42"/>
<text text-anchor="middle" x="14599.57" y="-6541.22" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14599.57" y="-6526.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_1&#45;&gt;head_group_1_1 -->
<g id="edge584" class="edge">
<title>allgather_dim_1_1&#45;&gt;head_group_1_1</title>
<path fill="none" stroke="black" d="M14117.24,-6626.05C14223.06,-6606.82 14384.41,-6577.51 14490.92,-6558.16"/>
<polygon fill="black" stroke="black" points="14491.84,-6561.55 14501.05,-6556.32 14490.58,-6554.67 14491.84,-6561.55"/>
</g>
<!-- split_q_1_5 -->
<g id="node451" class="node">
<title>split_q_1_5</title>
<ellipse fill="pink" stroke="black" cx="12500.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12500.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12500.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12500.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_q_1_5 -->
<g id="edge540" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_q_1_5</title>
<path fill="none" stroke="black" d="M12793.64,-7528.95C12736.67,-7513.01 12665.29,-7493.03 12607.24,-7476.78"/>
<polygon fill="black" stroke="black" points="12607.88,-7473.33 12597.31,-7474 12605.99,-7480.07 12607.88,-7473.33"/>
</g>
<!-- split_k_1_5 -->
<g id="node452" class="node">
<title>split_k_1_5</title>
<ellipse fill="pink" stroke="black" cx="12809.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12809.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12809.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12809.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_k_1_5 -->
<g id="edge541" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_k_1_5</title>
<path fill="none" stroke="black" d="M12866.07,-7520.91C12858.82,-7511.41 12850.91,-7501.05 12843.37,-7491.18"/>
<polygon fill="black" stroke="black" points="12845.99,-7488.85 12837.14,-7483.02 12840.43,-7493.1 12845.99,-7488.85"/>
</g>
<!-- split_v_1_5 -->
<g id="node453" class="node">
<title>split_v_1_5</title>
<ellipse fill="pink" stroke="black" cx="13118.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13118.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13118.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13118.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_v_1_5 -->
<g id="edge542" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_v_1_5</title>
<path fill="none" stroke="black" d="M12961.08,-7523.92C12986.9,-7511.3 13016.51,-7496.82 13043.03,-7483.86"/>
<polygon fill="black" stroke="black" points="13044.83,-7486.87 13052.28,-7479.34 13041.75,-7480.58 13044.83,-7486.87"/>
</g>
<!-- transpose_q_1_5 -->
<g id="node454" class="node">
<title>transpose_q_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="12500.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12500.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12500.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12500.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_5&#45;&gt;transpose_q_1_5 -->
<g id="edge543" class="edge">
<title>split_q_1_5&#45;&gt;transpose_q_1_5</title>
<path fill="none" stroke="black" d="M12500.57,-7408.3C12500.57,-7399.85 12500.57,-7390.75 12500.57,-7381.94"/>
<polygon fill="black" stroke="black" points="12504.07,-7381.77 12500.57,-7371.77 12497.07,-7381.77 12504.07,-7381.77"/>
</g>
<!-- transpose_k_1_5 -->
<g id="node455" class="node">
<title>transpose_k_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="12809.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12809.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12809.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12809.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_5&#45;&gt;transpose_k_1_5 -->
<g id="edge544" class="edge">
<title>split_k_1_5&#45;&gt;transpose_k_1_5</title>
<path fill="none" stroke="black" d="M12809.57,-7408.3C12809.57,-7399.85 12809.57,-7390.75 12809.57,-7381.94"/>
<polygon fill="black" stroke="black" points="12813.07,-7381.77 12809.57,-7371.77 12806.07,-7381.77 12813.07,-7381.77"/>
</g>
<!-- transpose_v_1_5 -->
<g id="node456" class="node">
<title>transpose_v_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="13118.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13118.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13118.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13118.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_5&#45;&gt;transpose_v_1_5 -->
<g id="edge545" class="edge">
<title>split_v_1_5&#45;&gt;transpose_v_1_5</title>
<path fill="none" stroke="black" d="M13118.57,-7408.3C13118.57,-7399.85 13118.57,-7390.75 13118.57,-7381.94"/>
<polygon fill="black" stroke="black" points="13122.07,-7381.77 13118.57,-7371.77 13115.07,-7381.77 13122.07,-7381.77"/>
</g>
<!-- attn_scores_1_5 -->
<g id="node457" class="node">
<title>attn_scores_1_5</title>
<ellipse fill="gold" stroke="black" cx="12809.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12809.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12809.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12809.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_5&#45;&gt;attn_scores_1_5 -->
<g id="edge546" class="edge">
<title>transpose_q_1_5&#45;&gt;attn_scores_1_5</title>
<path fill="none" stroke="black" d="M12584.19,-7303.16C12623.91,-7289.02 12671.6,-7272.04 12712.86,-7257.35"/>
<polygon fill="black" stroke="black" points="12714.13,-7260.62 12722.38,-7253.96 12711.79,-7254.02 12714.13,-7260.62"/>
</g>
<!-- transpose_k_1_5&#45;&gt;attn_scores_1_5 -->
<g id="edge547" class="edge">
<title>transpose_k_1_5&#45;&gt;attn_scores_1_5</title>
<path fill="none" stroke="black" d="M12809.57,-7296.3C12809.57,-7287.85 12809.57,-7278.75 12809.57,-7269.94"/>
<polygon fill="black" stroke="black" points="12813.07,-7269.77 12809.57,-7259.77 12806.07,-7269.77 12813.07,-7269.77"/>
</g>
<!-- attn_output_1_5 -->
<g id="node458" class="node">
<title>attn_output_1_5</title>
<ellipse fill="gold" stroke="black" cx="13118.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13118.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13118.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13118.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_5&#45;&gt;attn_output_1_5 -->
<g id="edge548" class="edge">
<title>transpose_v_1_5&#45;&gt;attn_output_1_5</title>
<path fill="none" stroke="black" d="M13118.57,-7296.23C13118.57,-7235.18 13118.57,-7112.87 13118.57,-7045.72"/>
<polygon fill="black" stroke="black" points="13122.07,-7045.43 13118.57,-7035.43 13115.07,-7045.43 13122.07,-7045.43"/>
</g>
<!-- softmax_1_5 -->
<g id="node459" class="node">
<title>softmax_1_5</title>
<ellipse fill="gold" stroke="black" cx="12894.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12894.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12894.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12894.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_5&#45;&gt;softmax_1_5 -->
<g id="edge549" class="edge">
<title>attn_scores_1_5&#45;&gt;softmax_1_5</title>
<path fill="none" stroke="black" d="M12837.41,-7184.91C12844.74,-7175.41 12852.75,-7165.05 12860.38,-7155.18"/>
<polygon fill="black" stroke="black" points="12863.33,-7157.08 12866.68,-7147.02 12857.79,-7152.8 12863.33,-7157.08"/>
</g>
<!-- transpose_back_1_5 -->
<g id="node460" class="node">
<title>transpose_back_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="13595.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13595.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13595.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13595.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_5&#45;&gt;transpose_back_1_5 -->
<g id="edge551" class="edge">
<title>attn_output_1_5&#45;&gt;transpose_back_1_5</title>
<path fill="none" stroke="black" d="M13225.32,-6972.31C13300.65,-6954.94 13401.52,-6931.68 13478.95,-6913.82"/>
<polygon fill="black" stroke="black" points="13479.79,-6917.22 13488.75,-6911.56 13478.22,-6910.4 13479.79,-6917.22"/>
</g>
<!-- softmax_1_5&#45;&gt;attn_output_1_5 -->
<g id="edge550" class="edge">
<title>softmax_1_5&#45;&gt;attn_output_1_5</title>
<path fill="none" stroke="black" d="M12962.39,-7075.62C12987.96,-7063.07 13017.19,-7048.71 13043.4,-7035.84"/>
<polygon fill="black" stroke="black" points="13045.09,-7038.91 13052.53,-7031.36 13042.01,-7032.62 13045.09,-7038.91"/>
</g>
<!-- reshape_concat_1_5 -->
<g id="node461" class="node">
<title>reshape_concat_1_5</title>
<ellipse fill="lightcyan" stroke="black" cx="13613.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13613.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13613.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13613.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_5&#45;&gt;reshape_concat_1_5 -->
<g id="edge552" class="edge">
<title>transpose_back_1_5&#45;&gt;reshape_concat_1_5</title>
<path fill="none" stroke="black" d="M13601.57,-6848.3C13602.98,-6839.67 13604.5,-6830.36 13605.97,-6821.36"/>
<polygon fill="black" stroke="black" points="13609.44,-6821.83 13607.61,-6811.39 13602.54,-6820.7 13609.44,-6821.83"/>
</g>
<!-- reshape_concat_1_5&#45;&gt;allgather_dim_1_1 -->
<g id="edge553" class="edge">
<title>reshape_concat_1_5&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M13700.7,-6745.38C13764.63,-6725.17 13851.36,-6697.75 13916.81,-6677.07"/>
<polygon fill="black" stroke="black" points="13918.23,-6680.29 13926.71,-6673.93 13916.12,-6673.61 13918.23,-6680.29"/>
</g>
<!-- split_q_1_6 -->
<g id="node463" class="node">
<title>split_q_1_6</title>
<ellipse fill="pink" stroke="black" cx="13427.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13427.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13427.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13427.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_q_1_6 -->
<g id="edge555" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_q_1_6</title>
<path fill="none" stroke="black" d="M13715.66,-7528.81C13659.88,-7512.96 13590.19,-7493.15 13533.32,-7476.98"/>
<polygon fill="black" stroke="black" points="13534.16,-7473.58 13523.59,-7474.22 13532.25,-7480.32 13534.16,-7473.58"/>
</g>
<!-- split_k_1_6 -->
<g id="node464" class="node">
<title>split_k_1_6</title>
<ellipse fill="pink" stroke="black" cx="13736.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13736.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13736.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13736.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_k_1_6 -->
<g id="edge556" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_k_1_6</title>
<path fill="none" stroke="black" d="M13789.03,-7520.91C13782.37,-7511.5 13775.1,-7501.26 13768.16,-7491.47"/>
<polygon fill="black" stroke="black" points="13770.81,-7489.16 13762.17,-7483.02 13765.1,-7493.21 13770.81,-7489.16"/>
</g>
<!-- split_v_1_6 -->
<g id="node465" class="node">
<title>split_v_1_6</title>
<ellipse fill="pink" stroke="black" cx="14045.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14045.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14045.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14045.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_v_1_6 -->
<g id="edge557" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_v_1_6</title>
<path fill="none" stroke="black" d="M13883.26,-7524.22C13910.02,-7511.47 13940.82,-7496.81 13968.35,-7483.7"/>
<polygon fill="black" stroke="black" points="13970.03,-7486.77 13977.55,-7479.31 13967.02,-7480.45 13970.03,-7486.77"/>
</g>
<!-- transpose_q_1_6 -->
<g id="node466" class="node">
<title>transpose_q_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13427.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13427.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13427.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13427.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_6&#45;&gt;transpose_q_1_6 -->
<g id="edge558" class="edge">
<title>split_q_1_6&#45;&gt;transpose_q_1_6</title>
<path fill="none" stroke="black" d="M13427.57,-7408.3C13427.57,-7399.85 13427.57,-7390.75 13427.57,-7381.94"/>
<polygon fill="black" stroke="black" points="13431.07,-7381.77 13427.57,-7371.77 13424.07,-7381.77 13431.07,-7381.77"/>
</g>
<!-- transpose_k_1_6 -->
<g id="node467" class="node">
<title>transpose_k_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13736.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13736.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13736.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13736.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_6&#45;&gt;transpose_k_1_6 -->
<g id="edge559" class="edge">
<title>split_k_1_6&#45;&gt;transpose_k_1_6</title>
<path fill="none" stroke="black" d="M13736.57,-7408.3C13736.57,-7399.85 13736.57,-7390.75 13736.57,-7381.94"/>
<polygon fill="black" stroke="black" points="13740.07,-7381.77 13736.57,-7371.77 13733.07,-7381.77 13740.07,-7381.77"/>
</g>
<!-- transpose_v_1_6 -->
<g id="node468" class="node">
<title>transpose_v_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="14045.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14045.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14045.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14045.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_6&#45;&gt;transpose_v_1_6 -->
<g id="edge560" class="edge">
<title>split_v_1_6&#45;&gt;transpose_v_1_6</title>
<path fill="none" stroke="black" d="M14045.57,-7408.3C14045.57,-7399.85 14045.57,-7390.75 14045.57,-7381.94"/>
<polygon fill="black" stroke="black" points="14049.07,-7381.77 14045.57,-7371.77 14042.07,-7381.77 14049.07,-7381.77"/>
</g>
<!-- attn_scores_1_6 -->
<g id="node469" class="node">
<title>attn_scores_1_6</title>
<ellipse fill="gold" stroke="black" cx="13736.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13736.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13736.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13736.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_6&#45;&gt;attn_scores_1_6 -->
<g id="edge561" class="edge">
<title>transpose_q_1_6&#45;&gt;attn_scores_1_6</title>
<path fill="none" stroke="black" d="M13511.19,-7303.16C13550.91,-7289.02 13598.6,-7272.04 13639.86,-7257.35"/>
<polygon fill="black" stroke="black" points="13641.13,-7260.62 13649.38,-7253.96 13638.79,-7254.02 13641.13,-7260.62"/>
</g>
<!-- transpose_k_1_6&#45;&gt;attn_scores_1_6 -->
<g id="edge562" class="edge">
<title>transpose_k_1_6&#45;&gt;attn_scores_1_6</title>
<path fill="none" stroke="black" d="M13736.57,-7296.3C13736.57,-7287.85 13736.57,-7278.75 13736.57,-7269.94"/>
<polygon fill="black" stroke="black" points="13740.07,-7269.77 13736.57,-7259.77 13733.07,-7269.77 13740.07,-7269.77"/>
</g>
<!-- attn_output_1_6 -->
<g id="node470" class="node">
<title>attn_output_1_6</title>
<ellipse fill="gold" stroke="black" cx="14010.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14010.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14010.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14010.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_6&#45;&gt;attn_output_1_6 -->
<g id="edge563" class="edge">
<title>transpose_v_1_6&#45;&gt;attn_output_1_6</title>
<path fill="none" stroke="black" d="M14041.73,-7296.23C14035.33,-7235.18 14022.51,-7112.87 14015.48,-7045.72"/>
<polygon fill="black" stroke="black" points="14018.92,-7045.01 14014.4,-7035.43 14011.96,-7045.74 14018.92,-7045.01"/>
</g>
<!-- softmax_1_6 -->
<g id="node471" class="node">
<title>softmax_1_6</title>
<ellipse fill="gold" stroke="black" cx="13779.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13779.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13779.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13779.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_6&#45;&gt;softmax_1_6 -->
<g id="edge564" class="edge">
<title>attn_scores_1_6&#45;&gt;softmax_1_6</title>
<path fill="none" stroke="black" d="M13750.89,-7184.3C13754.34,-7175.48 13758.06,-7165.96 13761.65,-7156.78"/>
<polygon fill="black" stroke="black" points="13764.94,-7157.98 13765.32,-7147.39 13758.42,-7155.43 13764.94,-7157.98"/>
</g>
<!-- transpose_back_1_6 -->
<g id="node472" class="node">
<title>transpose_back_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="14010.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14010.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14010.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14010.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_6&#45;&gt;transpose_back_1_6 -->
<g id="edge566" class="edge">
<title>attn_output_1_6&#45;&gt;transpose_back_1_6</title>
<path fill="none" stroke="black" d="M14010.57,-6960.3C14010.57,-6951.85 14010.57,-6942.75 14010.57,-6933.94"/>
<polygon fill="black" stroke="black" points="14014.07,-6933.77 14010.57,-6923.77 14007.07,-6933.77 14014.07,-6933.77"/>
</g>
<!-- softmax_1_6&#45;&gt;attn_output_1_6 -->
<g id="edge565" class="edge">
<title>softmax_1_6&#45;&gt;attn_output_1_6</title>
<path fill="none" stroke="black" d="M13849.19,-7075.77C13875.81,-7063.1 13906.31,-7048.58 13933.57,-7035.59"/>
<polygon fill="black" stroke="black" points="13935.16,-7038.71 13942.68,-7031.25 13932.15,-7032.39 13935.16,-7038.71"/>
</g>
<!-- reshape_concat_1_6 -->
<g id="node473" class="node">
<title>reshape_concat_1_6</title>
<ellipse fill="lightcyan" stroke="black" cx="14010.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14010.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14010.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14010.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_6&#45;&gt;reshape_concat_1_6 -->
<g id="edge567" class="edge">
<title>transpose_back_1_6&#45;&gt;reshape_concat_1_6</title>
<path fill="none" stroke="black" d="M14010.57,-6848.3C14010.57,-6839.85 14010.57,-6830.75 14010.57,-6821.94"/>
<polygon fill="black" stroke="black" points="14014.07,-6821.77 14010.57,-6811.77 14007.07,-6821.77 14014.07,-6821.77"/>
</g>
<!-- reshape_concat_1_6&#45;&gt;allgather_dim_1_1 -->
<g id="edge568" class="edge">
<title>reshape_concat_1_6&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M14010.57,-6736.29C14010.57,-6727.98 14010.57,-6718.93 14010.57,-6709.89"/>
<polygon fill="black" stroke="black" points="14014.07,-6709.73 14010.57,-6699.73 14007.07,-6709.73 14014.07,-6709.73"/>
</g>
<!-- split_q_1_7 -->
<g id="node475" class="node">
<title>split_q_1_7</title>
<ellipse fill="pink" stroke="black" cx="14354.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14354.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14354.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14354.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_q_1_7 -->
<g id="edge570" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_q_1_7</title>
<path fill="none" stroke="black" d="M14578.63,-7526.43C14537.99,-7512.01 14489.38,-7494.76 14447.84,-7480.02"/>
<polygon fill="black" stroke="black" points="14448.87,-7476.67 14438.27,-7476.62 14446.52,-7483.27 14448.87,-7476.67"/>
</g>
<!-- split_k_1_7 -->
<g id="node476" class="node">
<title>split_k_1_7</title>
<ellipse fill="pink" stroke="black" cx="14663.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14663.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14663.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14663.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_k_1_7 -->
<g id="edge571" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_k_1_7</title>
<path fill="none" stroke="black" d="M14664.24,-7520.3C14664.16,-7511.85 14664.08,-7502.75 14664,-7493.94"/>
<polygon fill="black" stroke="black" points="14667.5,-7493.74 14663.91,-7483.77 14660.5,-7493.8 14667.5,-7493.74"/>
</g>
<!-- split_v_1_7 -->
<g id="node477" class="node">
<title>split_v_1_7</title>
<ellipse fill="pink" stroke="black" cx="14972.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14972.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14972.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14972.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_v_1_7 -->
<g id="edge572" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_v_1_7</title>
<path fill="none" stroke="black" d="M14749.96,-7526.43C14790.26,-7512.04 14838.44,-7494.83 14879.65,-7480.11"/>
<polygon fill="black" stroke="black" points="14880.91,-7483.38 14889.15,-7476.72 14878.56,-7476.79 14880.91,-7483.38"/>
</g>
<!-- transpose_q_1_7 -->
<g id="node478" class="node">
<title>transpose_q_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14354.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14354.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14354.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14354.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_7&#45;&gt;transpose_q_1_7 -->
<g id="edge573" class="edge">
<title>split_q_1_7&#45;&gt;transpose_q_1_7</title>
<path fill="none" stroke="black" d="M14354.57,-7408.3C14354.57,-7399.85 14354.57,-7390.75 14354.57,-7381.94"/>
<polygon fill="black" stroke="black" points="14358.07,-7381.77 14354.57,-7371.77 14351.07,-7381.77 14358.07,-7381.77"/>
</g>
<!-- transpose_k_1_7 -->
<g id="node479" class="node">
<title>transpose_k_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14663.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14663.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14663.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14663.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_7&#45;&gt;transpose_k_1_7 -->
<g id="edge574" class="edge">
<title>split_k_1_7&#45;&gt;transpose_k_1_7</title>
<path fill="none" stroke="black" d="M14663.57,-7408.3C14663.57,-7399.85 14663.57,-7390.75 14663.57,-7381.94"/>
<polygon fill="black" stroke="black" points="14667.07,-7381.77 14663.57,-7371.77 14660.07,-7381.77 14667.07,-7381.77"/>
</g>
<!-- transpose_v_1_7 -->
<g id="node480" class="node">
<title>transpose_v_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14972.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14972.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14972.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14972.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_7&#45;&gt;transpose_v_1_7 -->
<g id="edge575" class="edge">
<title>split_v_1_7&#45;&gt;transpose_v_1_7</title>
<path fill="none" stroke="black" d="M14972.57,-7408.3C14972.57,-7399.85 14972.57,-7390.75 14972.57,-7381.94"/>
<polygon fill="black" stroke="black" points="14976.07,-7381.77 14972.57,-7371.77 14969.07,-7381.77 14976.07,-7381.77"/>
</g>
<!-- attn_scores_1_7 -->
<g id="node481" class="node">
<title>attn_scores_1_7</title>
<ellipse fill="gold" stroke="black" cx="14416.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14416.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14416.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14416.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_7&#45;&gt;attn_scores_1_7 -->
<g id="edge576" class="edge">
<title>transpose_q_1_7&#45;&gt;attn_scores_1_7</title>
<path fill="none" stroke="black" d="M14375.05,-7296.6C14380.18,-7287.5 14385.75,-7277.62 14391.09,-7268.14"/>
<polygon fill="black" stroke="black" points="14394.26,-7269.64 14396.12,-7259.21 14388.16,-7266.2 14394.26,-7269.64"/>
</g>
<!-- transpose_k_1_7&#45;&gt;attn_scores_1_7 -->
<g id="edge577" class="edge">
<title>transpose_k_1_7&#45;&gt;attn_scores_1_7</title>
<path fill="none" stroke="black" d="M14592.13,-7301.11C14563.08,-7288.17 14529.32,-7273.14 14499.22,-7259.73"/>
<polygon fill="black" stroke="black" points="14500.56,-7256.5 14490,-7255.62 14497.71,-7262.89 14500.56,-7256.5"/>
</g>
<!-- attn_output_1_7 -->
<g id="node482" class="node">
<title>attn_output_1_7</title>
<ellipse fill="gold" stroke="black" cx="14416.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14416.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14416.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14416.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_7&#45;&gt;attn_output_1_7 -->
<g id="edge578" class="edge">
<title>transpose_v_1_7&#45;&gt;attn_output_1_7</title>
<path fill="none" stroke="black" d="M14928.3,-7298.09C14859.32,-7244.87 14720.8,-7142.19 14592.57,-7072.42 14565.79,-7057.85 14535.5,-7044.25 14507.69,-7032.81"/>
<polygon fill="black" stroke="black" points="14508.95,-7029.54 14498.37,-7029.02 14506.31,-7036.03 14508.95,-7029.54"/>
</g>
<!-- softmax_1_7 -->
<g id="node483" class="node">
<title>softmax_1_7</title>
<ellipse fill="gold" stroke="black" cx="14416.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14416.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14416.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14416.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_7&#45;&gt;softmax_1_7 -->
<g id="edge579" class="edge">
<title>attn_scores_1_7&#45;&gt;softmax_1_7</title>
<path fill="none" stroke="black" d="M14416.57,-7184.3C14416.57,-7175.85 14416.57,-7166.75 14416.57,-7157.94"/>
<polygon fill="black" stroke="black" points="14420.07,-7157.77 14416.57,-7147.77 14413.07,-7157.77 14420.07,-7157.77"/>
</g>
<!-- transpose_back_1_7 -->
<g id="node484" class="node">
<title>transpose_back_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14389.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14389.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14389.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14389.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_7&#45;&gt;transpose_back_1_7 -->
<g id="edge581" class="edge">
<title>attn_output_1_7&#45;&gt;transpose_back_1_7</title>
<path fill="none" stroke="black" d="M14407.58,-6960.3C14405.47,-6951.67 14403.18,-6942.36 14400.97,-6933.36"/>
<polygon fill="black" stroke="black" points="14404.31,-6932.27 14398.52,-6923.39 14397.51,-6933.94 14404.31,-6932.27"/>
</g>
<!-- softmax_1_7&#45;&gt;attn_output_1_7 -->
<g id="edge580" class="edge">
<title>softmax_1_7&#45;&gt;attn_output_1_7</title>
<path fill="none" stroke="black" d="M14416.57,-7072.3C14416.57,-7063.85 14416.57,-7054.75 14416.57,-7045.94"/>
<polygon fill="black" stroke="black" points="14420.07,-7045.77 14416.57,-7035.77 14413.07,-7045.77 14420.07,-7045.77"/>
</g>
<!-- reshape_concat_1_7 -->
<g id="node485" class="node">
<title>reshape_concat_1_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14322.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14322.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14322.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14322.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_7&#45;&gt;reshape_concat_1_7 -->
<g id="edge582" class="edge">
<title>transpose_back_1_7&#45;&gt;reshape_concat_1_7</title>
<path fill="none" stroke="black" d="M14367.45,-6848.6C14361.85,-6839.4 14355.76,-6829.41 14349.93,-6819.84"/>
<polygon fill="black" stroke="black" points="14352.87,-6817.93 14344.67,-6811.21 14346.89,-6821.57 14352.87,-6817.93"/>
</g>
<!-- reshape_concat_1_7&#45;&gt;allgather_dim_1_1 -->
<g id="edge583" class="edge">
<title>reshape_concat_1_7&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M14247.84,-6742.86C14201.36,-6724.17 14141.53,-6700.1 14093.58,-6680.81"/>
<polygon fill="black" stroke="black" points="14094.74,-6677.51 14084.16,-6677.02 14092.13,-6684 14094.74,-6677.51"/>
</g>
<!-- output_proj_1_1 -->
<g id="node588" class="node">
<title>output_proj_1_1</title>
<ellipse fill="orange" stroke="black" cx="15858.57" cy="-6433.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15858.57" y="-6452.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15858.57" y="-6437.14" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15858.57" y="-6422.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15858.57" y="-6407.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_1&#45;&gt;output_proj_1_1 -->
<g id="edge708" class="edge">
<title>head_group_1_1&#45;&gt;output_proj_1_1</title>
<path fill="none" stroke="black" d="M14698.39,-6532.28C14861.8,-6524.98 15198.51,-6508.03 15482.57,-6481.42 15561.39,-6474.04 15649.19,-6463.2 15720.11,-6453.78"/>
<polygon fill="black" stroke="black" points="15721,-6457.19 15730.45,-6452.4 15720.07,-6450.25 15721,-6457.19"/>
</g>
<!-- split_q_1_8 -->
<g id="node488" class="node">
<title>split_q_1_8</title>
<ellipse fill="pink" stroke="black" cx="15281.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15281.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15281.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15281.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_q_1_8 -->
<g id="edge586" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_q_1_8</title>
<path fill="none" stroke="black" d="M15458.25,-7524.66C15428.35,-7511.51 15393.66,-7496.24 15362.98,-7482.74"/>
<polygon fill="black" stroke="black" points="15364.16,-7479.44 15353.6,-7478.62 15361.34,-7485.85 15364.16,-7479.44"/>
</g>
<!-- split_k_1_8 -->
<g id="node489" class="node">
<title>split_k_1_8</title>
<ellipse fill="pink" stroke="black" cx="15590.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15590.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15590.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15590.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_k_1_8 -->
<g id="edge587" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_k_1_8</title>
<path fill="none" stroke="black" d="M15551.06,-7520.6C15555.94,-7511.5 15561.24,-7501.62 15566.32,-7492.14"/>
<polygon fill="black" stroke="black" points="15569.47,-7493.68 15571.11,-7483.21 15563.3,-7490.37 15569.47,-7493.68"/>
</g>
<!-- split_v_1_8 -->
<g id="node490" class="node">
<title>split_v_1_8</title>
<ellipse fill="pink" stroke="black" cx="15899.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15899.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15899.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15899.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_v_1_8 -->
<g id="edge588" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_v_1_8</title>
<path fill="none" stroke="black" d="M15627.78,-7528.17C15679.71,-7512.65 15743.81,-7493.48 15796.73,-7477.67"/>
<polygon fill="black" stroke="black" points="15797.89,-7480.97 15806.47,-7474.75 15795.89,-7474.27 15797.89,-7480.97"/>
</g>
<!-- transpose_q_1_8 -->
<g id="node491" class="node">
<title>transpose_q_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15281.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15281.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15281.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15281.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_8&#45;&gt;transpose_q_1_8 -->
<g id="edge589" class="edge">
<title>split_q_1_8&#45;&gt;transpose_q_1_8</title>
<path fill="none" stroke="black" d="M15281.57,-7408.3C15281.57,-7399.85 15281.57,-7390.75 15281.57,-7381.94"/>
<polygon fill="black" stroke="black" points="15285.07,-7381.77 15281.57,-7371.77 15278.07,-7381.77 15285.07,-7381.77"/>
</g>
<!-- transpose_k_1_8 -->
<g id="node492" class="node">
<title>transpose_k_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15590.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15590.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15590.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15590.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_8&#45;&gt;transpose_k_1_8 -->
<g id="edge590" class="edge">
<title>split_k_1_8&#45;&gt;transpose_k_1_8</title>
<path fill="none" stroke="black" d="M15590.57,-7408.3C15590.57,-7399.85 15590.57,-7390.75 15590.57,-7381.94"/>
<polygon fill="black" stroke="black" points="15594.07,-7381.77 15590.57,-7371.77 15587.07,-7381.77 15594.07,-7381.77"/>
</g>
<!-- transpose_v_1_8 -->
<g id="node493" class="node">
<title>transpose_v_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15899.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15899.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15899.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15899.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_8&#45;&gt;transpose_v_1_8 -->
<g id="edge591" class="edge">
<title>split_v_1_8&#45;&gt;transpose_v_1_8</title>
<path fill="none" stroke="black" d="M15899.57,-7408.3C15899.57,-7399.85 15899.57,-7390.75 15899.57,-7381.94"/>
<polygon fill="black" stroke="black" points="15903.07,-7381.77 15899.57,-7371.77 15896.07,-7381.77 15903.07,-7381.77"/>
</g>
<!-- attn_scores_1_8 -->
<g id="node494" class="node">
<title>attn_scores_1_8</title>
<ellipse fill="gold" stroke="black" cx="15590.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15590.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15590.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15590.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_8&#45;&gt;attn_scores_1_8 -->
<g id="edge592" class="edge">
<title>transpose_q_1_8&#45;&gt;attn_scores_1_8</title>
<path fill="none" stroke="black" d="M15365.19,-7303.16C15404.91,-7289.02 15452.6,-7272.04 15493.86,-7257.35"/>
<polygon fill="black" stroke="black" points="15495.13,-7260.62 15503.38,-7253.96 15492.79,-7254.02 15495.13,-7260.62"/>
</g>
<!-- transpose_k_1_8&#45;&gt;attn_scores_1_8 -->
<g id="edge593" class="edge">
<title>transpose_k_1_8&#45;&gt;attn_scores_1_8</title>
<path fill="none" stroke="black" d="M15590.57,-7296.3C15590.57,-7287.85 15590.57,-7278.75 15590.57,-7269.94"/>
<polygon fill="black" stroke="black" points="15594.07,-7269.77 15590.57,-7259.77 15587.07,-7269.77 15594.07,-7269.77"/>
</g>
<!-- attn_output_1_8 -->
<g id="node495" class="node">
<title>attn_output_1_8</title>
<ellipse fill="gold" stroke="black" cx="15899.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15899.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15899.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15899.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_8&#45;&gt;attn_output_1_8 -->
<g id="edge594" class="edge">
<title>transpose_v_1_8&#45;&gt;attn_output_1_8</title>
<path fill="none" stroke="black" d="M15899.57,-7296.23C15899.57,-7235.18 15899.57,-7112.87 15899.57,-7045.72"/>
<polygon fill="black" stroke="black" points="15903.07,-7045.43 15899.57,-7035.43 15896.07,-7045.43 15903.07,-7045.43"/>
</g>
<!-- softmax_1_8 -->
<g id="node496" class="node">
<title>softmax_1_8</title>
<ellipse fill="gold" stroke="black" cx="15647.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15647.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15647.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15647.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_8&#45;&gt;softmax_1_8 -->
<g id="edge595" class="edge">
<title>attn_scores_1_8&#45;&gt;softmax_1_8</title>
<path fill="none" stroke="black" d="M15609.4,-7184.6C15614.11,-7175.5 15619.23,-7165.62 15624.15,-7156.14"/>
<polygon fill="black" stroke="black" points="15627.28,-7157.7 15628.77,-7147.21 15621.06,-7154.48 15627.28,-7157.7"/>
</g>
<!-- transpose_back_1_8 -->
<g id="node497" class="node">
<title>transpose_back_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="16134.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16134.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16134.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16134.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_8&#45;&gt;transpose_back_1_8 -->
<g id="edge597" class="edge">
<title>attn_output_1_8&#45;&gt;transpose_back_1_8</title>
<path fill="none" stroke="black" d="M15968.18,-6964.81C15995.93,-6951.82 16028.1,-6936.76 16056.73,-6923.36"/>
<polygon fill="black" stroke="black" points="16058.31,-6926.49 16065.88,-6919.08 16055.34,-6920.15 16058.31,-6926.49"/>
</g>
<!-- softmax_1_8&#45;&gt;attn_output_1_8 -->
<g id="edge596" class="edge">
<title>softmax_1_8&#45;&gt;attn_output_1_8</title>
<path fill="none" stroke="black" d="M15722.16,-7076.37C15752.15,-7063.28 15786.83,-7048.14 15817.52,-7034.74"/>
<polygon fill="black" stroke="black" points="15819.15,-7037.85 15826.91,-7030.64 15816.35,-7031.43 15819.15,-7037.85"/>
</g>
<!-- reshape_concat_1_8 -->
<g id="node498" class="node">
<title>reshape_concat_1_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16399.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16399.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16399.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16399.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_8&#45;&gt;reshape_concat_1_8 -->
<g id="edge598" class="edge">
<title>transpose_back_1_8&#45;&gt;reshape_concat_1_8</title>
<path fill="none" stroke="black" d="M16209.8,-6853.7C16243.23,-6839.82 16282.68,-6823.45 16316.93,-6809.23"/>
<polygon fill="black" stroke="black" points="16318.55,-6812.35 16326.44,-6805.28 16315.87,-6805.88 16318.55,-6812.35"/>
</g>
<!-- allgather_dim_1_2 -->
<g id="node499" class="node">
<title>allgather_dim_1_2</title>
<polygon fill="red" stroke="black" points="16695.57,-6699.42 16522.57,-6646.42 16695.57,-6593.42 16868.57,-6646.42 16695.57,-6699.42"/>
<text text-anchor="middle" x="16695.57" y="-6657.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="16695.57" y="-6642.72" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16695.57" y="-6627.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_8&#45;&gt;allgather_dim_1_2 -->
<g id="edge599" class="edge">
<title>reshape_concat_1_8&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16471.6,-6742.38C16514.9,-6724.03 16570.1,-6700.63 16614.86,-6681.65"/>
<polygon fill="black" stroke="black" points="16616.4,-6684.79 16624.25,-6677.67 16613.67,-6678.35 16616.4,-6684.79"/>
</g>
<!-- head_group_1_2 -->
<g id="node536" class="node">
<title>head_group_1_2</title>
<polygon fill="lightyellow" stroke="black" points="16527.07,-6556.42 16330.07,-6556.42 16330.07,-6518.42 16527.07,-6518.42 16527.07,-6556.42"/>
<text text-anchor="middle" x="16428.57" y="-6541.22" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16428.57" y="-6526.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_2&#45;&gt;head_group_1_2 -->
<g id="edge645" class="edge">
<title>allgather_dim_1_2&#45;&gt;head_group_1_2</title>
<path fill="none" stroke="black" d="M16621.91,-6615.9C16577.89,-6598.26 16522.94,-6576.24 16482.88,-6560.19"/>
<polygon fill="black" stroke="black" points="16484.13,-6556.92 16473.55,-6556.45 16481.53,-6563.42 16484.13,-6556.92"/>
</g>
<!-- split_q_1_9 -->
<g id="node501" class="node">
<title>split_q_1_9</title>
<ellipse fill="pink" stroke="black" cx="16208.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16208.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16208.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16208.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_q_1_9 -->
<g id="edge601" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_q_1_9</title>
<path fill="none" stroke="black" d="M16265.07,-7520.91C16257.82,-7511.41 16249.91,-7501.05 16242.37,-7491.18"/>
<polygon fill="black" stroke="black" points="16244.99,-7488.85 16236.14,-7483.02 16239.43,-7493.1 16244.99,-7488.85"/>
</g>
<!-- split_k_1_9 -->
<g id="node502" class="node">
<title>split_k_1_9</title>
<ellipse fill="pink" stroke="black" cx="16517.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16517.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16517.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16517.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_k_1_9 -->
<g id="edge602" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_k_1_9</title>
<path fill="none" stroke="black" d="M16360.08,-7523.92C16385.9,-7511.3 16415.51,-7496.82 16442.03,-7483.86"/>
<polygon fill="black" stroke="black" points="16443.83,-7486.87 16451.28,-7479.34 16440.75,-7480.58 16443.83,-7486.87"/>
</g>
<!-- split_v_1_9 -->
<g id="node503" class="node">
<title>split_v_1_9</title>
<ellipse fill="pink" stroke="black" cx="16826.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16826.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16826.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16826.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_v_1_9 -->
<g id="edge603" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_v_1_9</title>
<path fill="none" stroke="black" d="M16415.2,-7534.55C16489.77,-7520.61 16586.85,-7501.87 16672.57,-7483.42 16685.54,-7480.63 16699.1,-7477.6 16712.56,-7474.51"/>
<polygon fill="black" stroke="black" points="16713.37,-7477.91 16722.33,-7472.25 16711.8,-7471.09 16713.37,-7477.91"/>
</g>
<!-- transpose_q_1_9 -->
<g id="node504" class="node">
<title>transpose_q_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16208.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16208.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16208.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16208.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_9&#45;&gt;transpose_q_1_9 -->
<g id="edge604" class="edge">
<title>split_q_1_9&#45;&gt;transpose_q_1_9</title>
<path fill="none" stroke="black" d="M16208.57,-7408.3C16208.57,-7399.85 16208.57,-7390.75 16208.57,-7381.94"/>
<polygon fill="black" stroke="black" points="16212.07,-7381.77 16208.57,-7371.77 16205.07,-7381.77 16212.07,-7381.77"/>
</g>
<!-- transpose_k_1_9 -->
<g id="node505" class="node">
<title>transpose_k_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16517.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16517.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16517.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16517.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_9&#45;&gt;transpose_k_1_9 -->
<g id="edge605" class="edge">
<title>split_k_1_9&#45;&gt;transpose_k_1_9</title>
<path fill="none" stroke="black" d="M16517.57,-7408.3C16517.57,-7399.85 16517.57,-7390.75 16517.57,-7381.94"/>
<polygon fill="black" stroke="black" points="16521.07,-7381.77 16517.57,-7371.77 16514.07,-7381.77 16521.07,-7381.77"/>
</g>
<!-- transpose_v_1_9 -->
<g id="node506" class="node">
<title>transpose_v_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16826.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16826.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16826.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16826.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_9&#45;&gt;transpose_v_1_9 -->
<g id="edge606" class="edge">
<title>split_v_1_9&#45;&gt;transpose_v_1_9</title>
<path fill="none" stroke="black" d="M16826.57,-7408.3C16826.57,-7399.85 16826.57,-7390.75 16826.57,-7381.94"/>
<polygon fill="black" stroke="black" points="16830.07,-7381.77 16826.57,-7371.77 16823.07,-7381.77 16830.07,-7381.77"/>
</g>
<!-- attn_scores_1_9 -->
<g id="node507" class="node">
<title>attn_scores_1_9</title>
<ellipse fill="gold" stroke="black" cx="16517.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16517.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16517.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16517.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_9&#45;&gt;attn_scores_1_9 -->
<g id="edge607" class="edge">
<title>transpose_q_1_9&#45;&gt;attn_scores_1_9</title>
<path fill="none" stroke="black" d="M16292.19,-7303.16C16331.91,-7289.02 16379.6,-7272.04 16420.86,-7257.35"/>
<polygon fill="black" stroke="black" points="16422.13,-7260.62 16430.38,-7253.96 16419.79,-7254.02 16422.13,-7260.62"/>
</g>
<!-- transpose_k_1_9&#45;&gt;attn_scores_1_9 -->
<g id="edge608" class="edge">
<title>transpose_k_1_9&#45;&gt;attn_scores_1_9</title>
<path fill="none" stroke="black" d="M16517.57,-7296.3C16517.57,-7287.85 16517.57,-7278.75 16517.57,-7269.94"/>
<polygon fill="black" stroke="black" points="16521.07,-7269.77 16517.57,-7259.77 16514.07,-7269.77 16521.07,-7269.77"/>
</g>
<!-- attn_output_1_9 -->
<g id="node508" class="node">
<title>attn_output_1_9</title>
<ellipse fill="gold" stroke="black" cx="16695.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16695.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16695.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16695.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_9&#45;&gt;attn_output_1_9 -->
<g id="edge609" class="edge">
<title>transpose_v_1_9&#45;&gt;attn_output_1_9</title>
<path fill="none" stroke="black" d="M16812.3,-7296.55C16788.29,-7235.31 16739.84,-7111.78 16713.54,-7044.73"/>
<polygon fill="black" stroke="black" points="16716.73,-7043.29 16709.82,-7035.26 16710.22,-7045.85 16716.73,-7043.29"/>
</g>
<!-- softmax_1_9 -->
<g id="node509" class="node">
<title>softmax_1_9</title>
<ellipse fill="gold" stroke="black" cx="16534.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16534.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16534.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16534.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_9&#45;&gt;softmax_1_9 -->
<g id="edge610" class="edge">
<title>attn_scores_1_9&#45;&gt;softmax_1_9</title>
<path fill="none" stroke="black" d="M16523.23,-7184.3C16524.54,-7175.85 16525.95,-7166.75 16527.31,-7157.94"/>
<polygon fill="black" stroke="black" points="16530.81,-7158.19 16528.88,-7147.77 16523.89,-7157.12 16530.81,-7158.19"/>
</g>
<!-- transpose_back_1_9 -->
<g id="node510" class="node">
<title>transpose_back_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16695.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16695.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16695.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16695.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_9&#45;&gt;transpose_back_1_9 -->
<g id="edge612" class="edge">
<title>attn_output_1_9&#45;&gt;transpose_back_1_9</title>
<path fill="none" stroke="black" d="M16695.57,-6960.3C16695.57,-6951.85 16695.57,-6942.75 16695.57,-6933.94"/>
<polygon fill="black" stroke="black" points="16699.07,-6933.77 16695.57,-6923.77 16692.07,-6933.77 16699.07,-6933.77"/>
</g>
<!-- softmax_1_9&#45;&gt;attn_output_1_9 -->
<g id="edge611" class="edge">
<title>softmax_1_9&#45;&gt;attn_output_1_9</title>
<path fill="none" stroke="black" d="M16585.51,-7074.12C16601.75,-7063.02 16619.86,-7050.66 16636.62,-7039.21"/>
<polygon fill="black" stroke="black" points="16638.96,-7041.85 16645.24,-7033.31 16635.01,-7036.07 16638.96,-7041.85"/>
</g>
<!-- reshape_concat_1_9 -->
<g id="node511" class="node">
<title>reshape_concat_1_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16695.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16695.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16695.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16695.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_9&#45;&gt;reshape_concat_1_9 -->
<g id="edge613" class="edge">
<title>transpose_back_1_9&#45;&gt;reshape_concat_1_9</title>
<path fill="none" stroke="black" d="M16695.57,-6848.3C16695.57,-6839.85 16695.57,-6830.75 16695.57,-6821.94"/>
<polygon fill="black" stroke="black" points="16699.07,-6821.77 16695.57,-6811.77 16692.07,-6821.77 16699.07,-6821.77"/>
</g>
<!-- reshape_concat_1_9&#45;&gt;allgather_dim_1_2 -->
<g id="edge614" class="edge">
<title>reshape_concat_1_9&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16695.57,-6736.29C16695.57,-6727.98 16695.57,-6718.93 16695.57,-6709.89"/>
<polygon fill="black" stroke="black" points="16699.07,-6709.73 16695.57,-6699.73 16692.07,-6709.73 16699.07,-6709.73"/>
</g>
<!-- split_q_1_10 -->
<g id="node513" class="node">
<title>split_q_1_10</title>
<ellipse fill="pink" stroke="black" cx="17135.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17135.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17135.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17135.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_q_1_10 -->
<g id="edge616" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_q_1_10</title>
<path fill="none" stroke="black" d="M17192.07,-7520.91C17184.82,-7511.41 17176.91,-7501.05 17169.37,-7491.18"/>
<polygon fill="black" stroke="black" points="17171.99,-7488.85 17163.14,-7483.02 17166.43,-7493.1 17171.99,-7488.85"/>
</g>
<!-- split_k_1_10 -->
<g id="node514" class="node">
<title>split_k_1_10</title>
<ellipse fill="pink" stroke="black" cx="17444.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17444.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17444.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17444.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_k_1_10 -->
<g id="edge617" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_k_1_10</title>
<path fill="none" stroke="black" d="M17287.08,-7523.92C17312.9,-7511.3 17342.51,-7496.82 17369.03,-7483.86"/>
<polygon fill="black" stroke="black" points="17370.83,-7486.87 17378.28,-7479.34 17367.75,-7480.58 17370.83,-7486.87"/>
</g>
<!-- split_v_1_10 -->
<g id="node515" class="node">
<title>split_v_1_10</title>
<ellipse fill="pink" stroke="black" cx="17753.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17753.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17753.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17753.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_v_1_10 -->
<g id="edge618" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_v_1_10</title>
<path fill="none" stroke="black" d="M17342.2,-7534.55C17416.77,-7520.61 17513.85,-7501.87 17599.57,-7483.42 17612.54,-7480.63 17626.1,-7477.6 17639.56,-7474.51"/>
<polygon fill="black" stroke="black" points="17640.37,-7477.91 17649.33,-7472.25 17638.8,-7471.09 17640.37,-7477.91"/>
</g>
<!-- transpose_q_1_10 -->
<g id="node516" class="node">
<title>transpose_q_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17135.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17135.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17135.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17135.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_10&#45;&gt;transpose_q_1_10 -->
<g id="edge619" class="edge">
<title>split_q_1_10&#45;&gt;transpose_q_1_10</title>
<path fill="none" stroke="black" d="M17135.57,-7408.3C17135.57,-7399.85 17135.57,-7390.75 17135.57,-7381.94"/>
<polygon fill="black" stroke="black" points="17139.07,-7381.77 17135.57,-7371.77 17132.07,-7381.77 17139.07,-7381.77"/>
</g>
<!-- transpose_k_1_10 -->
<g id="node517" class="node">
<title>transpose_k_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17444.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17444.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17444.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17444.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_10&#45;&gt;transpose_k_1_10 -->
<g id="edge620" class="edge">
<title>split_k_1_10&#45;&gt;transpose_k_1_10</title>
<path fill="none" stroke="black" d="M17444.57,-7408.3C17444.57,-7399.85 17444.57,-7390.75 17444.57,-7381.94"/>
<polygon fill="black" stroke="black" points="17448.07,-7381.77 17444.57,-7371.77 17441.07,-7381.77 17448.07,-7381.77"/>
</g>
<!-- transpose_v_1_10 -->
<g id="node518" class="node">
<title>transpose_v_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17753.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17753.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17753.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17753.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_10&#45;&gt;transpose_v_1_10 -->
<g id="edge621" class="edge">
<title>split_v_1_10&#45;&gt;transpose_v_1_10</title>
<path fill="none" stroke="black" d="M17753.57,-7408.3C17753.57,-7399.85 17753.57,-7390.75 17753.57,-7381.94"/>
<polygon fill="black" stroke="black" points="17757.07,-7381.77 17753.57,-7371.77 17750.07,-7381.77 17757.07,-7381.77"/>
</g>
<!-- attn_scores_1_10 -->
<g id="node519" class="node">
<title>attn_scores_1_10</title>
<ellipse fill="gold" stroke="black" cx="17276.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17276.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17276.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17276.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_10&#45;&gt;attn_scores_1_10 -->
<g id="edge622" class="edge">
<title>transpose_q_1_10&#45;&gt;attn_scores_1_10</title>
<path fill="none" stroke="black" d="M17180.19,-7298.12C17193.81,-7287.49 17208.93,-7275.69 17223.08,-7264.66"/>
<polygon fill="black" stroke="black" points="17225.55,-7267.17 17231.28,-7258.26 17221.24,-7261.65 17225.55,-7267.17"/>
</g>
<!-- transpose_k_1_10&#45;&gt;attn_scores_1_10 -->
<g id="edge623" class="edge">
<title>transpose_k_1_10&#45;&gt;attn_scores_1_10</title>
<path fill="none" stroke="black" d="M17392.34,-7298.72C17375.2,-7287.5 17356,-7274.93 17338.24,-7263.3"/>
<polygon fill="black" stroke="black" points="17339.93,-7260.22 17329.64,-7257.67 17336.09,-7266.08 17339.93,-7260.22"/>
</g>
<!-- attn_output_1_10 -->
<g id="node520" class="node">
<title>attn_output_1_10</title>
<ellipse fill="gold" stroke="black" cx="17276.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17276.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17276.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17276.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_10&#45;&gt;attn_output_1_10 -->
<g id="edge624" class="edge">
<title>transpose_v_1_10&#45;&gt;attn_output_1_10</title>
<path fill="none" stroke="black" d="M17719.9,-7297.26C17667.12,-7242.95 17559.8,-7138.83 17452.57,-7072.42 17427.52,-7056.91 17398.61,-7043.29 17371.56,-7032.14"/>
<polygon fill="black" stroke="black" points="17372.66,-7028.81 17362.07,-7028.3 17370.03,-7035.3 17372.66,-7028.81"/>
</g>
<!-- softmax_1_10 -->
<g id="node521" class="node">
<title>softmax_1_10</title>
<ellipse fill="gold" stroke="black" cx="17276.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17276.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17276.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17276.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_10&#45;&gt;softmax_1_10 -->
<g id="edge625" class="edge">
<title>attn_scores_1_10&#45;&gt;softmax_1_10</title>
<path fill="none" stroke="black" d="M17276.57,-7184.3C17276.57,-7175.85 17276.57,-7166.75 17276.57,-7157.94"/>
<polygon fill="black" stroke="black" points="17280.07,-7157.77 17276.57,-7147.77 17273.07,-7157.77 17280.07,-7157.77"/>
</g>
<!-- transpose_back_1_10 -->
<g id="node522" class="node">
<title>transpose_back_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17182.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17182.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17182.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17182.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_10&#45;&gt;transpose_back_1_10 -->
<g id="edge627" class="edge">
<title>attn_output_1_10&#45;&gt;transpose_back_1_10</title>
<path fill="none" stroke="black" d="M17246.05,-6961.21C17237.68,-6951.41 17228.51,-6940.68 17219.81,-6930.49"/>
<polygon fill="black" stroke="black" points="17222.42,-6928.16 17213.26,-6922.84 17217.1,-6932.71 17222.42,-6928.16"/>
</g>
<!-- softmax_1_10&#45;&gt;attn_output_1_10 -->
<g id="edge626" class="edge">
<title>softmax_1_10&#45;&gt;attn_output_1_10</title>
<path fill="none" stroke="black" d="M17276.57,-7072.3C17276.57,-7063.85 17276.57,-7054.75 17276.57,-7045.94"/>
<polygon fill="black" stroke="black" points="17280.07,-7045.77 17276.57,-7035.77 17273.07,-7045.77 17280.07,-7045.77"/>
</g>
<!-- reshape_concat_1_10 -->
<g id="node523" class="node">
<title>reshape_concat_1_10</title>
<ellipse fill="lightcyan" stroke="black" cx="16992.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16992.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16992.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16992.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_10&#45;&gt;reshape_concat_1_10 -->
<g id="edge628" class="edge">
<title>transpose_back_1_10&#45;&gt;reshape_concat_1_10</title>
<path fill="none" stroke="black" d="M17124.79,-6851.47C17103.78,-6839.31 17079.88,-6825.47 17058.23,-6812.94"/>
<polygon fill="black" stroke="black" points="17059.83,-6809.82 17049.43,-6807.84 17056.33,-6815.88 17059.83,-6809.82"/>
</g>
<!-- reshape_concat_1_10&#45;&gt;allgather_dim_1_2 -->
<g id="edge629" class="edge">
<title>reshape_concat_1_10&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16920.3,-6742.38C16876.86,-6724.03 16821.47,-6700.63 16776.56,-6681.65"/>
<polygon fill="black" stroke="black" points="16777.72,-6678.34 16767.14,-6677.67 16774.99,-6684.78 16777.72,-6678.34"/>
</g>
<!-- split_q_1_11 -->
<g id="node525" class="node">
<title>split_q_1_11</title>
<ellipse fill="pink" stroke="black" cx="18062.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18062.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18062.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18062.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_q_1_11 -->
<g id="edge631" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_q_1_11</title>
<path fill="none" stroke="black" d="M18177.19,-7522.42C18160.01,-7511.11 18140.78,-7498.44 18123.05,-7486.76"/>
<polygon fill="black" stroke="black" points="18124.76,-7483.69 18114.48,-7481.12 18120.91,-7489.54 18124.76,-7483.69"/>
</g>
<!-- split_k_1_11 -->
<g id="node526" class="node">
<title>split_k_1_11</title>
<ellipse fill="pink" stroke="black" cx="18371.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18371.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18371.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18371.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_k_1_11 -->
<g id="edge632" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_k_1_11</title>
<path fill="none" stroke="black" d="M18274.89,-7521.82C18288.73,-7511.1 18304.08,-7499.21 18318.39,-7488.12"/>
<polygon fill="black" stroke="black" points="18320.92,-7490.59 18326.68,-7481.7 18316.63,-7485.06 18320.92,-7490.59"/>
</g>
<!-- split_v_1_11 -->
<g id="node527" class="node">
<title>split_v_1_11</title>
<ellipse fill="pink" stroke="black" cx="18680.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18680.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18680.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18680.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_v_1_11 -->
<g id="edge633" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_v_1_11</title>
<path fill="none" stroke="black" d="M18337.31,-7530.65C18406.62,-7513.74 18496.56,-7491.81 18566.99,-7474.63"/>
<polygon fill="black" stroke="black" points="18567.91,-7478.01 18576.79,-7472.24 18566.25,-7471.21 18567.91,-7478.01"/>
</g>
<!-- transpose_q_1_11 -->
<g id="node528" class="node">
<title>transpose_q_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="18062.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18062.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18062.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18062.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_11&#45;&gt;transpose_q_1_11 -->
<g id="edge634" class="edge">
<title>split_q_1_11&#45;&gt;transpose_q_1_11</title>
<path fill="none" stroke="black" d="M18062.57,-7408.3C18062.57,-7399.85 18062.57,-7390.75 18062.57,-7381.94"/>
<polygon fill="black" stroke="black" points="18066.07,-7381.77 18062.57,-7371.77 18059.07,-7381.77 18066.07,-7381.77"/>
</g>
<!-- transpose_k_1_11 -->
<g id="node529" class="node">
<title>transpose_k_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="18371.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18371.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18371.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18371.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_11&#45;&gt;transpose_k_1_11 -->
<g id="edge635" class="edge">
<title>split_k_1_11&#45;&gt;transpose_k_1_11</title>
<path fill="none" stroke="black" d="M18371.57,-7408.3C18371.57,-7399.85 18371.57,-7390.75 18371.57,-7381.94"/>
<polygon fill="black" stroke="black" points="18375.07,-7381.77 18371.57,-7371.77 18368.07,-7381.77 18375.07,-7381.77"/>
</g>
<!-- transpose_v_1_11 -->
<g id="node530" class="node">
<title>transpose_v_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="18680.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18680.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18680.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18680.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_11&#45;&gt;transpose_v_1_11 -->
<g id="edge636" class="edge">
<title>split_v_1_11&#45;&gt;transpose_v_1_11</title>
<path fill="none" stroke="black" d="M18680.57,-7408.3C18680.57,-7399.85 18680.57,-7390.75 18680.57,-7381.94"/>
<polygon fill="black" stroke="black" points="18684.07,-7381.77 18680.57,-7371.77 18677.07,-7381.77 18684.07,-7381.77"/>
</g>
<!-- attn_scores_1_11 -->
<g id="node531" class="node">
<title>attn_scores_1_11</title>
<ellipse fill="gold" stroke="black" cx="18194.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18194.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="18194.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18194.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_11&#45;&gt;attn_scores_1_11 -->
<g id="edge637" class="edge">
<title>transpose_q_1_11&#45;&gt;attn_scores_1_11</title>
<path fill="none" stroke="black" d="M18104.7,-7297.82C18117.2,-7287.4 18131.01,-7275.89 18143.99,-7265.08"/>
<polygon fill="black" stroke="black" points="18146.5,-7267.54 18151.94,-7258.45 18142.02,-7262.17 18146.5,-7267.54"/>
</g>
<!-- transpose_k_1_11&#45;&gt;attn_scores_1_11 -->
<g id="edge638" class="edge">
<title>transpose_k_1_11&#45;&gt;attn_scores_1_11</title>
<path fill="none" stroke="black" d="M18317.02,-7299.02C18298.61,-7287.58 18277.89,-7274.71 18258.81,-7262.84"/>
<polygon fill="black" stroke="black" points="18260.51,-7259.78 18250.16,-7257.47 18256.81,-7265.72 18260.51,-7259.78"/>
</g>
<!-- attn_output_1_11 -->
<g id="node532" class="node">
<title>attn_output_1_11</title>
<ellipse fill="gold" stroke="black" cx="18194.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18194.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18194.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18194.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_11&#45;&gt;attn_output_1_11 -->
<g id="edge639" class="edge">
<title>transpose_v_1_11&#45;&gt;attn_output_1_11</title>
<path fill="none" stroke="black" d="M18645.68,-7297.34C18591.03,-7243.15 18480.13,-7139.18 18370.57,-7072.42 18345.4,-7057.09 18316.46,-7043.53 18289.41,-7032.37"/>
<polygon fill="black" stroke="black" points="18290.52,-7029.04 18279.93,-7028.53 18287.88,-7035.53 18290.52,-7029.04"/>
</g>
<!-- softmax_1_11 -->
<g id="node533" class="node">
<title>softmax_1_11</title>
<ellipse fill="gold" stroke="black" cx="18194.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18194.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="18194.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18194.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_11&#45;&gt;softmax_1_11 -->
<g id="edge640" class="edge">
<title>attn_scores_1_11&#45;&gt;softmax_1_11</title>
<path fill="none" stroke="black" d="M18194.57,-7184.3C18194.57,-7175.85 18194.57,-7166.75 18194.57,-7157.94"/>
<polygon fill="black" stroke="black" points="18198.07,-7157.77 18194.57,-7147.77 18191.07,-7157.77 18198.07,-7157.77"/>
</g>
<!-- transpose_back_1_11 -->
<g id="node534" class="node">
<title>transpose_back_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="17995.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17995.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17995.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17995.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_11&#45;&gt;transpose_back_1_11 -->
<g id="edge642" class="edge">
<title>attn_output_1_11&#45;&gt;transpose_back_1_11</title>
<path fill="none" stroke="black" d="M18134.33,-6963.62C18112.31,-6951.45 18087.24,-6937.6 18064.52,-6925.04"/>
<polygon fill="black" stroke="black" points="18066.06,-6921.89 18055.62,-6920.11 18062.67,-6928.01 18066.06,-6921.89"/>
</g>
<!-- softmax_1_11&#45;&gt;attn_output_1_11 -->
<g id="edge641" class="edge">
<title>softmax_1_11&#45;&gt;attn_output_1_11</title>
<path fill="none" stroke="black" d="M18194.57,-7072.3C18194.57,-7063.85 18194.57,-7054.75 18194.57,-7045.94"/>
<polygon fill="black" stroke="black" points="18198.07,-7045.77 18194.57,-7035.77 18191.07,-7045.77 18198.07,-7045.77"/>
</g>
<!-- reshape_concat_1_11 -->
<g id="node535" class="node">
<title>reshape_concat_1_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17588.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17588.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17588.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17588.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_11&#45;&gt;reshape_concat_1_11 -->
<g id="edge643" class="edge">
<title>transpose_back_1_11&#45;&gt;reshape_concat_1_11</title>
<path fill="none" stroke="black" d="M17897.05,-6858.3C17835.3,-6841.61 17755.8,-6820.12 17692.97,-6803.14"/>
<polygon fill="black" stroke="black" points="17693.61,-6799.69 17683.04,-6800.46 17691.78,-6806.44 17693.61,-6799.69"/>
</g>
<!-- reshape_concat_1_11&#45;&gt;allgather_dim_1_2 -->
<g id="edge644" class="edge">
<title>reshape_concat_1_11&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M17470.91,-6756.39C17302.73,-6732.75 16994.87,-6689.49 16821.99,-6665.19"/>
<polygon fill="black" stroke="black" points="16822.47,-6661.72 16812.08,-6663.8 16821.49,-6668.66 16822.47,-6661.72"/>
</g>
<!-- output_proj_1_2 -->
<g id="node589" class="node">
<title>output_proj_1_2</title>
<ellipse fill="orange" stroke="black" cx="16269.57" cy="-6433.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16269.57" y="-6452.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16269.57" y="-6437.14" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16269.57" y="-6422.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16269.57" y="-6407.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_2&#45;&gt;output_proj_1_2 -->
<g id="edge709" class="edge">
<title>head_group_1_2&#45;&gt;output_proj_1_2</title>
<path fill="none" stroke="black" d="M16400.51,-6518.41C16384.52,-6508.14 16363.66,-6494.75 16343.31,-6481.68"/>
<polygon fill="black" stroke="black" points="16344.94,-6478.57 16334.64,-6476.11 16341.16,-6484.46 16344.94,-6478.57"/>
</g>
<!-- split_q_1_12 -->
<g id="node538" class="node">
<title>split_q_1_12</title>
<ellipse fill="pink" stroke="black" cx="18989.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18989.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18989.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18989.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_q_1_12 -->
<g id="edge647" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_q_1_12</title>
<path fill="none" stroke="black" d="M19095.53,-7522.12C19079.9,-7511.02 19062.47,-7498.66 19046.33,-7487.21"/>
<polygon fill="black" stroke="black" points="19048.21,-7484.25 19038.03,-7481.31 19044.16,-7489.96 19048.21,-7484.25"/>
</g>
<!-- split_k_1_12 -->
<g id="node539" class="node">
<title>split_k_1_12</title>
<ellipse fill="pink" stroke="black" cx="19298.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19298.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19298.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19298.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_k_1_12 -->
<g id="edge648" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_k_1_12</title>
<path fill="none" stroke="black" d="M19193.3,-7522.12C19208.83,-7511.02 19226.15,-7498.66 19242.18,-7487.21"/>
<polygon fill="black" stroke="black" points="19244.32,-7489.98 19250.43,-7481.31 19240.26,-7484.28 19244.32,-7489.98"/>
</g>
<!-- split_v_1_12 -->
<g id="node540" class="node">
<title>split_v_1_12</title>
<ellipse fill="pink" stroke="black" cx="19607.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19607.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19607.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19607.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_v_1_12 -->
<g id="edge649" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_v_1_12</title>
<path fill="none" stroke="black" d="M19253.71,-7531C19325.46,-7513.95 19419.22,-7491.67 19492.2,-7474.34"/>
<polygon fill="black" stroke="black" points="19493.43,-7477.64 19502.35,-7471.92 19491.82,-7470.83 19493.43,-7477.64"/>
</g>
<!-- transpose_q_1_12 -->
<g id="node541" class="node">
<title>transpose_q_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="18989.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18989.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18989.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18989.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_12&#45;&gt;transpose_q_1_12 -->
<g id="edge650" class="edge">
<title>split_q_1_12&#45;&gt;transpose_q_1_12</title>
<path fill="none" stroke="black" d="M18989.57,-7408.3C18989.57,-7399.85 18989.57,-7390.75 18989.57,-7381.94"/>
<polygon fill="black" stroke="black" points="18993.07,-7381.77 18989.57,-7371.77 18986.07,-7381.77 18993.07,-7381.77"/>
</g>
<!-- transpose_k_1_12 -->
<g id="node542" class="node">
<title>transpose_k_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19298.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19298.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19298.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19298.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_12&#45;&gt;transpose_k_1_12 -->
<g id="edge651" class="edge">
<title>split_k_1_12&#45;&gt;transpose_k_1_12</title>
<path fill="none" stroke="black" d="M19298.57,-7408.3C19298.57,-7399.85 19298.57,-7390.75 19298.57,-7381.94"/>
<polygon fill="black" stroke="black" points="19302.07,-7381.77 19298.57,-7371.77 19295.07,-7381.77 19302.07,-7381.77"/>
</g>
<!-- transpose_v_1_12 -->
<g id="node543" class="node">
<title>transpose_v_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19607.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19607.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19607.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19607.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_12&#45;&gt;transpose_v_1_12 -->
<g id="edge652" class="edge">
<title>split_v_1_12&#45;&gt;transpose_v_1_12</title>
<path fill="none" stroke="black" d="M19607.57,-7408.3C19607.57,-7399.85 19607.57,-7390.75 19607.57,-7381.94"/>
<polygon fill="black" stroke="black" points="19611.07,-7381.77 19607.57,-7371.77 19604.07,-7381.77 19611.07,-7381.77"/>
</g>
<!-- attn_scores_1_12 -->
<g id="node544" class="node">
<title>attn_scores_1_12</title>
<ellipse fill="gold" stroke="black" cx="19298.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19298.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19298.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19298.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_12&#45;&gt;attn_scores_1_12 -->
<g id="edge653" class="edge">
<title>transpose_q_1_12&#45;&gt;attn_scores_1_12</title>
<path fill="none" stroke="black" d="M19073.19,-7303.16C19112.91,-7289.02 19160.6,-7272.04 19201.86,-7257.35"/>
<polygon fill="black" stroke="black" points="19203.13,-7260.62 19211.38,-7253.96 19200.79,-7254.02 19203.13,-7260.62"/>
</g>
<!-- transpose_k_1_12&#45;&gt;attn_scores_1_12 -->
<g id="edge654" class="edge">
<title>transpose_k_1_12&#45;&gt;attn_scores_1_12</title>
<path fill="none" stroke="black" d="M19298.57,-7296.3C19298.57,-7287.85 19298.57,-7278.75 19298.57,-7269.94"/>
<polygon fill="black" stroke="black" points="19302.07,-7269.77 19298.57,-7259.77 19295.07,-7269.77 19302.07,-7269.77"/>
</g>
<!-- attn_output_1_12 -->
<g id="node545" class="node">
<title>attn_output_1_12</title>
<ellipse fill="gold" stroke="black" cx="19607.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19607.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19607.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19607.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_12&#45;&gt;attn_output_1_12 -->
<g id="edge655" class="edge">
<title>transpose_v_1_12&#45;&gt;attn_output_1_12</title>
<path fill="none" stroke="black" d="M19607.57,-7296.23C19607.57,-7235.18 19607.57,-7112.87 19607.57,-7045.72"/>
<polygon fill="black" stroke="black" points="19611.07,-7045.43 19607.57,-7035.43 19604.07,-7045.43 19611.07,-7045.43"/>
</g>
<!-- softmax_1_12 -->
<g id="node546" class="node">
<title>softmax_1_12</title>
<ellipse fill="gold" stroke="black" cx="19383.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19383.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19383.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19383.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_12&#45;&gt;softmax_1_12 -->
<g id="edge656" class="edge">
<title>attn_scores_1_12&#45;&gt;softmax_1_12</title>
<path fill="none" stroke="black" d="M19326.41,-7184.91C19333.74,-7175.41 19341.75,-7165.05 19349.38,-7155.18"/>
<polygon fill="black" stroke="black" points="19352.33,-7157.08 19355.68,-7147.02 19346.79,-7152.8 19352.33,-7157.08"/>
</g>
<!-- transpose_back_1_12 -->
<g id="node547" class="node">
<title>transpose_back_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19994.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19994.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="19994.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19994.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_12&#45;&gt;transpose_back_1_12 -->
<g id="edge658" class="edge">
<title>attn_output_1_12&#45;&gt;transpose_back_1_12</title>
<path fill="none" stroke="black" d="M19703.73,-6969.59C19759.92,-6953.62 19830.91,-6933.45 19888.68,-6917.02"/>
<polygon fill="black" stroke="black" points="19889.91,-6920.31 19898.57,-6914.21 19888,-6913.58 19889.91,-6920.31"/>
</g>
<!-- softmax_1_12&#45;&gt;attn_output_1_12 -->
<g id="edge657" class="edge">
<title>softmax_1_12&#45;&gt;attn_output_1_12</title>
<path fill="none" stroke="black" d="M19451.39,-7075.62C19476.96,-7063.07 19506.19,-7048.71 19532.4,-7035.84"/>
<polygon fill="black" stroke="black" points="19534.09,-7038.91 19541.53,-7031.36 19531.01,-7032.62 19534.09,-7038.91"/>
</g>
<!-- reshape_concat_1_12 -->
<g id="node548" class="node">
<title>reshape_concat_1_12</title>
<ellipse fill="lightcyan" stroke="black" cx="20161.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20161.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20161.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20161.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_12&#45;&gt;reshape_concat_1_12 -->
<g id="edge659" class="edge">
<title>transpose_back_1_12&#45;&gt;reshape_concat_1_12</title>
<path fill="none" stroke="black" d="M20046.5,-6850.72C20063.94,-6839.23 20083.54,-6826.32 20101.56,-6814.46"/>
<polygon fill="black" stroke="black" points="20103.83,-6817.15 20110.25,-6808.73 20099.98,-6811.31 20103.83,-6817.15"/>
</g>
<!-- allgather_dim_1_3 -->
<g id="node549" class="node">
<title>allgather_dim_1_3</title>
<polygon fill="red" stroke="black" points="20457.57,-6699.42 20284.57,-6646.42 20457.57,-6593.42 20630.57,-6646.42 20457.57,-6699.42"/>
<text text-anchor="middle" x="20457.57" y="-6657.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="20457.57" y="-6642.72" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="20457.57" y="-6627.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_12&#45;&gt;allgather_dim_1_3 -->
<g id="edge660" class="edge">
<title>reshape_concat_1_12&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20233.6,-6742.38C20276.9,-6724.03 20332.1,-6700.63 20376.86,-6681.65"/>
<polygon fill="black" stroke="black" points="20378.4,-6684.79 20386.25,-6677.67 20375.67,-6678.35 20378.4,-6684.79"/>
</g>
<!-- head_group_1_3 -->
<g id="node586" class="node">
<title>head_group_1_3</title>
<polygon fill="lightyellow" stroke="black" points="16815.07,-6556.42 16618.07,-6556.42 16618.07,-6518.42 16815.07,-6518.42 16815.07,-6556.42"/>
<text text-anchor="middle" x="16716.57" y="-6541.22" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16716.57" y="-6526.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_3&#45;&gt;head_group_1_3 -->
<g id="edge706" class="edge">
<title>allgather_dim_1_3&#45;&gt;head_group_1_3</title>
<path fill="none" stroke="black" d="M20302.18,-6640.98C19677.52,-6623.11 17357.6,-6556.76 16825.72,-6541.55"/>
<polygon fill="black" stroke="black" points="16825.47,-6538.04 16815.37,-6541.25 16825.27,-6545.04 16825.47,-6538.04"/>
</g>
<!-- split_q_1_13 -->
<g id="node551" class="node">
<title>split_q_1_13</title>
<ellipse fill="pink" stroke="black" cx="19916.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19916.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19916.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19916.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_q_1_13 -->
<g id="edge662" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_q_1_13</title>
<path fill="none" stroke="black" d="M20022.53,-7522.12C20006.9,-7511.02 19989.47,-7498.66 19973.33,-7487.21"/>
<polygon fill="black" stroke="black" points="19975.21,-7484.25 19965.03,-7481.31 19971.16,-7489.96 19975.21,-7484.25"/>
</g>
<!-- split_k_1_13 -->
<g id="node552" class="node">
<title>split_k_1_13</title>
<ellipse fill="pink" stroke="black" cx="20225.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20225.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20225.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20225.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_k_1_13 -->
<g id="edge663" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_k_1_13</title>
<path fill="none" stroke="black" d="M20120.3,-7522.12C20135.83,-7511.02 20153.15,-7498.66 20169.18,-7487.21"/>
<polygon fill="black" stroke="black" points="20171.32,-7489.98 20177.43,-7481.31 20167.26,-7484.28 20171.32,-7489.98"/>
</g>
<!-- split_v_1_13 -->
<g id="node553" class="node">
<title>split_v_1_13</title>
<ellipse fill="pink" stroke="black" cx="20534.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20534.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20534.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20534.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_v_1_13 -->
<g id="edge664" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_v_1_13</title>
<path fill="none" stroke="black" d="M20180.71,-7531C20252.46,-7513.95 20346.22,-7491.67 20419.2,-7474.34"/>
<polygon fill="black" stroke="black" points="20420.43,-7477.64 20429.35,-7471.92 20418.82,-7470.83 20420.43,-7477.64"/>
</g>
<!-- transpose_q_1_13 -->
<g id="node554" class="node">
<title>transpose_q_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="19916.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19916.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19916.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19916.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_13&#45;&gt;transpose_q_1_13 -->
<g id="edge665" class="edge">
<title>split_q_1_13&#45;&gt;transpose_q_1_13</title>
<path fill="none" stroke="black" d="M19916.57,-7408.3C19916.57,-7399.85 19916.57,-7390.75 19916.57,-7381.94"/>
<polygon fill="black" stroke="black" points="19920.07,-7381.77 19916.57,-7371.77 19913.07,-7381.77 19920.07,-7381.77"/>
</g>
<!-- transpose_k_1_13 -->
<g id="node555" class="node">
<title>transpose_k_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20225.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20225.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20225.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20225.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_13&#45;&gt;transpose_k_1_13 -->
<g id="edge666" class="edge">
<title>split_k_1_13&#45;&gt;transpose_k_1_13</title>
<path fill="none" stroke="black" d="M20225.57,-7408.3C20225.57,-7399.85 20225.57,-7390.75 20225.57,-7381.94"/>
<polygon fill="black" stroke="black" points="20229.07,-7381.77 20225.57,-7371.77 20222.07,-7381.77 20229.07,-7381.77"/>
</g>
<!-- transpose_v_1_13 -->
<g id="node556" class="node">
<title>transpose_v_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20534.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20534.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20534.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20534.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_13&#45;&gt;transpose_v_1_13 -->
<g id="edge667" class="edge">
<title>split_v_1_13&#45;&gt;transpose_v_1_13</title>
<path fill="none" stroke="black" d="M20534.57,-7408.3C20534.57,-7399.85 20534.57,-7390.75 20534.57,-7381.94"/>
<polygon fill="black" stroke="black" points="20538.07,-7381.77 20534.57,-7371.77 20531.07,-7381.77 20538.07,-7381.77"/>
</g>
<!-- attn_scores_1_13 -->
<g id="node557" class="node">
<title>attn_scores_1_13</title>
<ellipse fill="gold" stroke="black" cx="20225.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20225.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20225.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20225.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_13&#45;&gt;attn_scores_1_13 -->
<g id="edge668" class="edge">
<title>transpose_q_1_13&#45;&gt;attn_scores_1_13</title>
<path fill="none" stroke="black" d="M20000.19,-7303.16C20039.91,-7289.02 20087.6,-7272.04 20128.86,-7257.35"/>
<polygon fill="black" stroke="black" points="20130.13,-7260.62 20138.38,-7253.96 20127.79,-7254.02 20130.13,-7260.62"/>
</g>
<!-- transpose_k_1_13&#45;&gt;attn_scores_1_13 -->
<g id="edge669" class="edge">
<title>transpose_k_1_13&#45;&gt;attn_scores_1_13</title>
<path fill="none" stroke="black" d="M20225.57,-7296.3C20225.57,-7287.85 20225.57,-7278.75 20225.57,-7269.94"/>
<polygon fill="black" stroke="black" points="20229.07,-7269.77 20225.57,-7259.77 20222.07,-7269.77 20229.07,-7269.77"/>
</g>
<!-- attn_output_1_13 -->
<g id="node558" class="node">
<title>attn_output_1_13</title>
<ellipse fill="gold" stroke="black" cx="20457.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20457.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20457.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20457.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_13&#45;&gt;attn_output_1_13 -->
<g id="edge670" class="edge">
<title>transpose_v_1_13&#45;&gt;attn_output_1_13</title>
<path fill="none" stroke="black" d="M20526.11,-7296.23C20512.01,-7235.06 20483.73,-7112.36 20468.27,-7045.3"/>
<polygon fill="black" stroke="black" points="20471.65,-7044.39 20465.99,-7035.43 20464.83,-7045.96 20471.65,-7044.39"/>
</g>
<!-- softmax_1_13 -->
<g id="node559" class="node">
<title>softmax_1_13</title>
<ellipse fill="gold" stroke="black" cx="20296.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20296.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20296.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20296.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_13&#45;&gt;softmax_1_13 -->
<g id="edge671" class="edge">
<title>attn_scores_1_13&#45;&gt;softmax_1_13</title>
<path fill="none" stroke="black" d="M20249.02,-7184.6C20254.96,-7175.4 20261.4,-7165.41 20267.58,-7155.84"/>
<polygon fill="black" stroke="black" points="20270.67,-7157.51 20273.15,-7147.21 20264.79,-7153.71 20270.67,-7157.51"/>
</g>
<!-- transpose_back_1_13 -->
<g id="node560" class="node">
<title>transpose_back_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20457.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20457.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20457.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20457.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_13&#45;&gt;transpose_back_1_13 -->
<g id="edge673" class="edge">
<title>attn_output_1_13&#45;&gt;transpose_back_1_13</title>
<path fill="none" stroke="black" d="M20457.57,-6960.3C20457.57,-6951.85 20457.57,-6942.75 20457.57,-6933.94"/>
<polygon fill="black" stroke="black" points="20461.07,-6933.77 20457.57,-6923.77 20454.07,-6933.77 20461.07,-6933.77"/>
</g>
<!-- softmax_1_13&#45;&gt;attn_output_1_13 -->
<g id="edge672" class="edge">
<title>softmax_1_13&#45;&gt;attn_output_1_13</title>
<path fill="none" stroke="black" d="M20347.51,-7074.12C20363.75,-7063.02 20381.86,-7050.66 20398.62,-7039.21"/>
<polygon fill="black" stroke="black" points="20400.96,-7041.85 20407.24,-7033.31 20397.01,-7036.07 20400.96,-7041.85"/>
</g>
<!-- reshape_concat_1_13 -->
<g id="node561" class="node">
<title>reshape_concat_1_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20457.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20457.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20457.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20457.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_13&#45;&gt;reshape_concat_1_13 -->
<g id="edge674" class="edge">
<title>transpose_back_1_13&#45;&gt;reshape_concat_1_13</title>
<path fill="none" stroke="black" d="M20457.57,-6848.3C20457.57,-6839.85 20457.57,-6830.75 20457.57,-6821.94"/>
<polygon fill="black" stroke="black" points="20461.07,-6821.77 20457.57,-6811.77 20454.07,-6821.77 20461.07,-6821.77"/>
</g>
<!-- reshape_concat_1_13&#45;&gt;allgather_dim_1_3 -->
<g id="edge675" class="edge">
<title>reshape_concat_1_13&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20457.57,-6736.29C20457.57,-6727.98 20457.57,-6718.93 20457.57,-6709.89"/>
<polygon fill="black" stroke="black" points="20461.07,-6709.73 20457.57,-6699.73 20454.07,-6709.73 20461.07,-6709.73"/>
</g>
<!-- split_q_1_14 -->
<g id="node563" class="node">
<title>split_q_1_14</title>
<ellipse fill="pink" stroke="black" cx="20843.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20843.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20843.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20843.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_q_1_14 -->
<g id="edge677" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_q_1_14</title>
<path fill="none" stroke="black" d="M20896.03,-7520.91C20889.37,-7511.5 20882.1,-7501.26 20875.16,-7491.47"/>
<polygon fill="black" stroke="black" points="20877.81,-7489.16 20869.17,-7483.02 20872.1,-7493.21 20877.81,-7489.16"/>
</g>
<!-- split_k_1_14 -->
<g id="node564" class="node">
<title>split_k_1_14</title>
<ellipse fill="pink" stroke="black" cx="21152.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21152.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21152.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21152.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_k_1_14 -->
<g id="edge678" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_k_1_14</title>
<path fill="none" stroke="black" d="M20990.26,-7524.22C21017.02,-7511.47 21047.82,-7496.81 21075.35,-7483.7"/>
<polygon fill="black" stroke="black" points="21077.03,-7486.77 21084.55,-7479.31 21074.02,-7480.45 21077.03,-7486.77"/>
</g>
<!-- split_v_1_14 -->
<g id="node565" class="node">
<title>split_v_1_14</title>
<ellipse fill="pink" stroke="black" cx="21461.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21461.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21461.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21461.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_v_1_14 -->
<g id="edge679" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_v_1_14</title>
<path fill="none" stroke="black" d="M21045.28,-7534.82C21121.15,-7520.9 21220.18,-7502.09 21307.57,-7483.42 21320.55,-7480.65 21334.1,-7477.63 21347.56,-7474.55"/>
<polygon fill="black" stroke="black" points="21348.38,-7477.95 21357.34,-7472.29 21346.81,-7471.13 21348.38,-7477.95"/>
</g>
<!-- transpose_q_1_14 -->
<g id="node566" class="node">
<title>transpose_q_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="20843.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20843.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20843.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20843.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_14&#45;&gt;transpose_q_1_14 -->
<g id="edge680" class="edge">
<title>split_q_1_14&#45;&gt;transpose_q_1_14</title>
<path fill="none" stroke="black" d="M20843.57,-7408.3C20843.57,-7399.85 20843.57,-7390.75 20843.57,-7381.94"/>
<polygon fill="black" stroke="black" points="20847.07,-7381.77 20843.57,-7371.77 20840.07,-7381.77 20847.07,-7381.77"/>
</g>
<!-- transpose_k_1_14 -->
<g id="node567" class="node">
<title>transpose_k_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="21152.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21152.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21152.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21152.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_14&#45;&gt;transpose_k_1_14 -->
<g id="edge681" class="edge">
<title>split_k_1_14&#45;&gt;transpose_k_1_14</title>
<path fill="none" stroke="black" d="M21152.57,-7408.3C21152.57,-7399.85 21152.57,-7390.75 21152.57,-7381.94"/>
<polygon fill="black" stroke="black" points="21156.07,-7381.77 21152.57,-7371.77 21149.07,-7381.77 21156.07,-7381.77"/>
</g>
<!-- transpose_v_1_14 -->
<g id="node568" class="node">
<title>transpose_v_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="21461.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21461.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21461.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21461.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_14&#45;&gt;transpose_v_1_14 -->
<g id="edge682" class="edge">
<title>split_v_1_14&#45;&gt;transpose_v_1_14</title>
<path fill="none" stroke="black" d="M21461.57,-7408.3C21461.57,-7399.85 21461.57,-7390.75 21461.57,-7381.94"/>
<polygon fill="black" stroke="black" points="21465.07,-7381.77 21461.57,-7371.77 21458.07,-7381.77 21465.07,-7381.77"/>
</g>
<!-- attn_scores_1_14 -->
<g id="node569" class="node">
<title>attn_scores_1_14</title>
<ellipse fill="gold" stroke="black" cx="21099.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21099.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21099.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21099.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_14&#45;&gt;attn_scores_1_14 -->
<g id="edge683" class="edge">
<title>transpose_q_1_14&#45;&gt;attn_scores_1_14</title>
<path fill="none" stroke="black" d="M20916.93,-7301.4C20947.46,-7288.29 20983.09,-7272.98 21014.73,-7259.38"/>
<polygon fill="black" stroke="black" points="21016.17,-7262.57 21023.98,-7255.41 21013.41,-7256.14 21016.17,-7262.57"/>
</g>
<!-- transpose_k_1_14&#45;&gt;attn_scores_1_14 -->
<g id="edge684" class="edge">
<title>transpose_k_1_14&#45;&gt;attn_scores_1_14</title>
<path fill="none" stroke="black" d="M21135.07,-7296.6C21130.78,-7287.68 21126.12,-7278.02 21121.64,-7268.72"/>
<polygon fill="black" stroke="black" points="21124.73,-7267.07 21117.24,-7259.59 21118.42,-7270.11 21124.73,-7267.07"/>
</g>
<!-- attn_output_1_14 -->
<g id="node570" class="node">
<title>attn_output_1_14</title>
<ellipse fill="gold" stroke="black" cx="21099.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21099.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21099.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21099.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_14&#45;&gt;attn_output_1_14 -->
<g id="edge685" class="edge">
<title>transpose_v_1_14&#45;&gt;attn_output_1_14</title>
<path fill="none" stroke="black" d="M21443.99,-7296.47C21415.63,-7241.12 21354.87,-7135.65 21275.57,-7072.42 21254.01,-7055.23 21227.86,-7041.45 21202.38,-7030.67"/>
<polygon fill="black" stroke="black" points="21203.61,-7027.4 21193.03,-7026.84 21200.95,-7033.87 21203.61,-7027.4"/>
</g>
<!-- softmax_1_14 -->
<g id="node571" class="node">
<title>softmax_1_14</title>
<ellipse fill="gold" stroke="black" cx="21099.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21099.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21099.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21099.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_14&#45;&gt;softmax_1_14 -->
<g id="edge686" class="edge">
<title>attn_scores_1_14&#45;&gt;softmax_1_14</title>
<path fill="none" stroke="black" d="M21099.57,-7184.3C21099.57,-7175.85 21099.57,-7166.75 21099.57,-7157.94"/>
<polygon fill="black" stroke="black" points="21103.07,-7157.77 21099.57,-7147.77 21096.07,-7157.77 21103.07,-7157.77"/>
</g>
<!-- transpose_back_1_14 -->
<g id="node572" class="node">
<title>transpose_back_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="20898.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20898.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20898.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20898.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_14&#45;&gt;transpose_back_1_14 -->
<g id="edge688" class="edge">
<title>attn_output_1_14&#45;&gt;transpose_back_1_14</title>
<path fill="none" stroke="black" d="M21038.99,-6963.77C21016.75,-6951.6 20991.39,-6937.72 20968.39,-6925.13"/>
<polygon fill="black" stroke="black" points="20969.83,-6921.93 20959.38,-6920.2 20966.47,-6928.07 20969.83,-6921.93"/>
</g>
<!-- softmax_1_14&#45;&gt;attn_output_1_14 -->
<g id="edge687" class="edge">
<title>softmax_1_14&#45;&gt;attn_output_1_14</title>
<path fill="none" stroke="black" d="M21099.57,-7072.3C21099.57,-7063.85 21099.57,-7054.75 21099.57,-7045.94"/>
<polygon fill="black" stroke="black" points="21103.07,-7045.77 21099.57,-7035.77 21096.07,-7045.77 21103.07,-7045.77"/>
</g>
<!-- reshape_concat_1_14 -->
<g id="node573" class="node">
<title>reshape_concat_1_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20753.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20753.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20753.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20753.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_14&#45;&gt;reshape_concat_1_14 -->
<g id="edge689" class="edge">
<title>transpose_back_1_14&#45;&gt;reshape_concat_1_14</title>
<path fill="none" stroke="black" d="M20852.69,-6850.12C20838.27,-6839.18 20822.22,-6827 20807.31,-6815.69"/>
<polygon fill="black" stroke="black" points="20809.24,-6812.76 20799.15,-6809.5 20805.01,-6818.34 20809.24,-6812.76"/>
</g>
<!-- reshape_concat_1_14&#45;&gt;allgather_dim_1_3 -->
<g id="edge690" class="edge">
<title>reshape_concat_1_14&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20681.54,-6742.38C20638.25,-6724.03 20583.05,-6700.63 20538.29,-6681.65"/>
<polygon fill="black" stroke="black" points="20539.47,-6678.35 20528.9,-6677.67 20536.74,-6684.79 20539.47,-6678.35"/>
</g>
<!-- split_q_1_15 -->
<g id="node575" class="node">
<title>split_q_1_15</title>
<ellipse fill="pink" stroke="black" cx="21770.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21770.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21770.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21770.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_q_1_15 -->
<g id="edge692" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_q_1_15</title>
<path fill="none" stroke="black" d="M21875.85,-7522.12C21860.31,-7511.02 21843,-7498.66 21826.97,-7487.21"/>
<polygon fill="black" stroke="black" points="21828.89,-7484.28 21818.72,-7481.31 21824.82,-7489.98 21828.89,-7484.28"/>
</g>
<!-- split_k_1_15 -->
<g id="node576" class="node">
<title>split_k_1_15</title>
<ellipse fill="pink" stroke="black" cx="22079.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22079.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="22079.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22079.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_k_1_15 -->
<g id="edge693" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_k_1_15</title>
<path fill="none" stroke="black" d="M21973.62,-7522.12C21989.25,-7511.02 22006.68,-7498.66 22022.81,-7487.21"/>
<polygon fill="black" stroke="black" points="22024.99,-7489.96 22031.11,-7481.31 22020.93,-7484.25 22024.99,-7489.96"/>
</g>
<!-- split_v_1_15 -->
<g id="node577" class="node">
<title>split_v_1_15</title>
<ellipse fill="pink" stroke="black" cx="22388.57" cy="-7445.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22388.57" y="-7457.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22388.57" y="-7442.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22388.57" y="-7427.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_v_1_15 -->
<g id="edge694" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_v_1_15</title>
<path fill="none" stroke="black" d="M22033.95,-7531C22105.85,-7513.95 22199.81,-7491.67 22272.95,-7474.34"/>
<polygon fill="black" stroke="black" points="22274.2,-7477.64 22283.13,-7471.92 22272.59,-7470.82 22274.2,-7477.64"/>
</g>
<!-- transpose_q_1_15 -->
<g id="node578" class="node">
<title>transpose_q_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="21770.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21770.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21770.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21770.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_15&#45;&gt;transpose_q_1_15 -->
<g id="edge695" class="edge">
<title>split_q_1_15&#45;&gt;transpose_q_1_15</title>
<path fill="none" stroke="black" d="M21770.57,-7408.3C21770.57,-7399.85 21770.57,-7390.75 21770.57,-7381.94"/>
<polygon fill="black" stroke="black" points="21774.07,-7381.77 21770.57,-7371.77 21767.07,-7381.77 21774.07,-7381.77"/>
</g>
<!-- transpose_k_1_15 -->
<g id="node579" class="node">
<title>transpose_k_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="22079.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22079.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="22079.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22079.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_15&#45;&gt;transpose_k_1_15 -->
<g id="edge696" class="edge">
<title>split_k_1_15&#45;&gt;transpose_k_1_15</title>
<path fill="none" stroke="black" d="M22079.57,-7408.3C22079.57,-7399.85 22079.57,-7390.75 22079.57,-7381.94"/>
<polygon fill="black" stroke="black" points="22083.07,-7381.77 22079.57,-7371.77 22076.07,-7381.77 22083.07,-7381.77"/>
</g>
<!-- transpose_v_1_15 -->
<g id="node580" class="node">
<title>transpose_v_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="22388.57" cy="-7333.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22388.57" y="-7345.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22388.57" y="-7330.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22388.57" y="-7315.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_15&#45;&gt;transpose_v_1_15 -->
<g id="edge697" class="edge">
<title>split_v_1_15&#45;&gt;transpose_v_1_15</title>
<path fill="none" stroke="black" d="M22388.57,-7408.3C22388.57,-7399.85 22388.57,-7390.75 22388.57,-7381.94"/>
<polygon fill="black" stroke="black" points="22392.07,-7381.77 22388.57,-7371.77 22385.07,-7381.77 22392.07,-7381.77"/>
</g>
<!-- attn_scores_1_15 -->
<g id="node581" class="node">
<title>attn_scores_1_15</title>
<ellipse fill="gold" stroke="black" cx="21902.57" cy="-7221.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21902.57" y="-7233.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21902.57" y="-7218.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21902.57" y="-7203.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_15&#45;&gt;attn_scores_1_15 -->
<g id="edge698" class="edge">
<title>transpose_q_1_15&#45;&gt;attn_scores_1_15</title>
<path fill="none" stroke="black" d="M21812.7,-7297.82C21825.2,-7287.4 21839.01,-7275.89 21851.99,-7265.08"/>
<polygon fill="black" stroke="black" points="21854.5,-7267.54 21859.94,-7258.45 21850.02,-7262.17 21854.5,-7267.54"/>
</g>
<!-- transpose_k_1_15&#45;&gt;attn_scores_1_15 -->
<g id="edge699" class="edge">
<title>transpose_k_1_15&#45;&gt;attn_scores_1_15</title>
<path fill="none" stroke="black" d="M22025.02,-7299.02C22006.61,-7287.58 21985.89,-7274.71 21966.81,-7262.84"/>
<polygon fill="black" stroke="black" points="21968.51,-7259.78 21958.16,-7257.47 21964.81,-7265.72 21968.51,-7259.78"/>
</g>
<!-- attn_output_1_15 -->
<g id="node582" class="node">
<title>attn_output_1_15</title>
<ellipse fill="gold" stroke="black" cx="21902.57" cy="-6997.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21902.57" y="-7009.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21902.57" y="-6994.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21902.57" y="-6979.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_15&#45;&gt;attn_output_1_15 -->
<g id="edge700" class="edge">
<title>transpose_v_1_15&#45;&gt;attn_output_1_15</title>
<path fill="none" stroke="black" d="M22353.68,-7297.34C22299.03,-7243.15 22188.13,-7139.18 22078.57,-7072.42 22053.4,-7057.09 22024.46,-7043.53 21997.41,-7032.37"/>
<polygon fill="black" stroke="black" points="21998.52,-7029.04 21987.93,-7028.53 21995.88,-7035.53 21998.52,-7029.04"/>
</g>
<!-- softmax_1_15 -->
<g id="node583" class="node">
<title>softmax_1_15</title>
<ellipse fill="gold" stroke="black" cx="21902.57" cy="-7109.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21902.57" y="-7121.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21902.57" y="-7106.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21902.57" y="-7091.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_15&#45;&gt;softmax_1_15 -->
<g id="edge701" class="edge">
<title>attn_scores_1_15&#45;&gt;softmax_1_15</title>
<path fill="none" stroke="black" d="M21902.57,-7184.3C21902.57,-7175.85 21902.57,-7166.75 21902.57,-7157.94"/>
<polygon fill="black" stroke="black" points="21906.07,-7157.77 21902.57,-7147.77 21899.07,-7157.77 21906.07,-7157.77"/>
</g>
<!-- transpose_back_1_15 -->
<g id="node584" class="node">
<title>transpose_back_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="21308.57" cy="-6885.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21308.57" y="-6897.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21308.57" y="-6882.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21308.57" y="-6867.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_15&#45;&gt;transpose_back_1_15 -->
<g id="edge703" class="edge">
<title>attn_output_1_15&#45;&gt;transpose_back_1_15</title>
<path fill="none" stroke="black" d="M21785.93,-6975.32C21684.79,-6956.59 21538.74,-6929.55 21434.87,-6910.31"/>
<polygon fill="black" stroke="black" points="21435.42,-6906.86 21424.95,-6908.48 21434.15,-6913.74 21435.42,-6906.86"/>
</g>
<!-- softmax_1_15&#45;&gt;attn_output_1_15 -->
<g id="edge702" class="edge">
<title>softmax_1_15&#45;&gt;attn_output_1_15</title>
<path fill="none" stroke="black" d="M21902.57,-7072.3C21902.57,-7063.85 21902.57,-7054.75 21902.57,-7045.94"/>
<polygon fill="black" stroke="black" points="21906.07,-7045.77 21902.57,-7035.77 21899.07,-7045.77 21906.07,-7045.77"/>
</g>
<!-- reshape_concat_1_15 -->
<g id="node585" class="node">
<title>reshape_concat_1_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21056.57" cy="-6773.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21056.57" y="-6785.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21056.57" y="-6770.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21056.57" y="-6755.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_15&#45;&gt;reshape_concat_1_15 -->
<g id="edge704" class="edge">
<title>transpose_back_1_15&#45;&gt;reshape_concat_1_15</title>
<path fill="none" stroke="black" d="M21236.02,-6853.26C21204.92,-6839.68 21168.49,-6823.78 21136.61,-6809.86"/>
<polygon fill="black" stroke="black" points="21137.87,-6806.59 21127.31,-6805.8 21135.07,-6813.01 21137.87,-6806.59"/>
</g>
<!-- reshape_concat_1_15&#45;&gt;allgather_dim_1_3 -->
<g id="edge705" class="edge">
<title>reshape_concat_1_15&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20955.31,-6749.6C20935.52,-6745.15 20914.91,-6740.58 20895.57,-6736.42 20785.64,-6712.8 20659.81,-6687.4 20571.31,-6669.81"/>
<polygon fill="black" stroke="black" points="20571.74,-6666.32 20561.25,-6667.81 20570.38,-6673.19 20571.74,-6666.32"/>
</g>
<!-- output_proj_1_3 -->
<g id="node590" class="node">
<title>output_proj_1_3</title>
<ellipse fill="orange" stroke="black" cx="16623.57" cy="-6433.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16623.57" y="-6452.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16623.57" y="-6437.14" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16623.57" y="-6422.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16623.57" y="-6407.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_3&#45;&gt;output_proj_1_3 -->
<g id="edge710" class="edge">
<title>head_group_1_3&#45;&gt;output_proj_1_3</title>
<path fill="none" stroke="black" d="M16699.95,-6518.17C16691.97,-6509.41 16681.95,-6498.42 16671.82,-6487.3"/>
<polygon fill="black" stroke="black" points="16674.14,-6484.65 16664.82,-6479.61 16668.96,-6489.36 16674.14,-6484.65"/>
</g>
<!-- allreduce_output_1 -->
<g id="node591" class="node">
<title>allreduce_output_1</title>
<polygon fill="red" stroke="black" points="15995.57,-6348.26 15852.57,-6295.26 15995.57,-6242.26 16138.57,-6295.26 15995.57,-6348.26"/>
<text text-anchor="middle" x="15995.57" y="-6306.56" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="15995.57" y="-6291.56" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="15995.57" y="-6276.56" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_1_0&#45;&gt;allreduce_output_1 -->
<g id="edge711" class="edge">
<title>output_proj_1_0&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M15452.31,-6407.93C15578.7,-6381.95 15776.52,-6341.29 15895.35,-6316.86"/>
<polygon fill="black" stroke="black" points="15896.09,-6320.28 15905.18,-6314.84 15894.68,-6313.42 15896.09,-6320.28"/>
</g>
<!-- output_proj_1_1&#45;&gt;allreduce_output_1 -->
<g id="edge712" class="edge">
<title>output_proj_1_1&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M15903.43,-6387.78C15918.32,-6372.99 15934.91,-6356.52 15949.86,-6341.67"/>
<polygon fill="black" stroke="black" points="15952.42,-6344.05 15957.05,-6334.52 15947.49,-6339.09 15952.42,-6344.05"/>
</g>
<!-- output_proj_1_2&#45;&gt;allreduce_output_1 -->
<g id="edge713" class="edge">
<title>output_proj_1_2&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M16191.06,-6393.35C16151.24,-6373.57 16103.3,-6349.76 16064.86,-6330.67"/>
<polygon fill="black" stroke="black" points="16066.32,-6327.49 16055.81,-6326.17 16063.21,-6333.76 16066.32,-6327.49"/>
</g>
<!-- output_proj_1_3&#45;&gt;allreduce_output_1 -->
<g id="edge714" class="edge">
<title>output_proj_1_3&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M16509.27,-6405.7C16479.75,-6398.92 16448,-6391.73 16418.57,-6385.26 16308.42,-6361.02 16181.8,-6334.57 16096.02,-6316.85"/>
<polygon fill="black" stroke="black" points="16096.53,-6313.38 16086.03,-6314.79 16095.12,-6320.24 16096.53,-6313.38"/>
</g>
<!-- residual_1 -->
<g id="node592" class="node">
<title>residual_1</title>
<ellipse fill="lightgreen" stroke="black" cx="15995.57" cy="-6167.76" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="15995.57" y="-6179.06" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15995.57" y="-6164.06" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="15995.57" y="-6149.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_output_1&#45;&gt;residual_1 -->
<g id="edge715" class="edge">
<title>allreduce_output_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M15995.57,-6242.13C15995.57,-6233.41 15995.57,-6224.42 15995.57,-6215.84"/>
<polygon fill="black" stroke="black" points="15999.07,-6215.63 15995.57,-6205.63 15992.07,-6215.63 15999.07,-6215.63"/>
</g>
<!-- ln2_1_0 -->
<g id="node593" class="node">
<title>ln2_1_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13625.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13625.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13625.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13625.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_0 -->
<g id="edge716" class="edge">
<title>residual_1&#45;&gt;ln2_1_0</title>
<path fill="none" stroke="black" d="M15841.79,-6162.16C15542.39,-6153.13 14860.26,-6132.24 14286.57,-6112.26 14062.99,-6104.47 14005.33,-6122.79 13783.57,-6093.26 13768.58,-6091.26 13752.92,-6088.49 13737.53,-6085.37"/>
<polygon fill="black" stroke="black" points="13737.98,-6081.89 13727.47,-6083.27 13736.54,-6088.74 13737.98,-6081.89"/>
</g>
<!-- ln2_1_1 -->
<g id="node594" class="node">
<title>ln2_1_1</title>
<ellipse fill="lightgreen" stroke="black" cx="13941.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13941.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13941.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13941.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_1 -->
<g id="edge717" class="edge">
<title>residual_1&#45;&gt;ln2_1_1</title>
<path fill="none" stroke="black" d="M15840.37,-6164.51C15449.97,-6158.24 14434.45,-6138.02 14099.57,-6093.26 14084.58,-6091.25 14068.92,-6088.48 14053.53,-6085.36"/>
<polygon fill="black" stroke="black" points="14053.98,-6081.87 14043.47,-6083.25 14052.55,-6088.72 14053.98,-6081.87"/>
</g>
<!-- ln2_1_2 -->
<g id="node595" class="node">
<title>ln2_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14257.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14257.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14257.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14257.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_2 -->
<g id="edge718" class="edge">
<title>residual_1&#45;&gt;ln2_1_2</title>
<path fill="none" stroke="black" d="M15841.21,-6163.13C15499.45,-6154.51 14687.7,-6130.71 14415.57,-6093.26 14400.59,-6091.2 14384.93,-6088.39 14369.55,-6085.25"/>
<polygon fill="black" stroke="black" points="14369.99,-6081.76 14359.49,-6083.14 14368.56,-6088.62 14369.99,-6081.76"/>
</g>
<!-- ln2_1_3 -->
<g id="node596" class="node">
<title>ln2_1_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14573.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14573.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14573.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14573.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_3 -->
<g id="edge719" class="edge">
<title>residual_1&#45;&gt;ln2_1_3</title>
<path fill="none" stroke="black" d="M15840.04,-6166.14C15600.68,-6163.3 15128.12,-6150.17 14731.57,-6093.26 14716.71,-6091.13 14701.19,-6088.3 14685.92,-6085.16"/>
<polygon fill="black" stroke="black" points="14686.45,-6081.69 14675.94,-6083.05 14685,-6088.54 14686.45,-6081.69"/>
</g>
<!-- ln2_1_4 -->
<g id="node597" class="node">
<title>ln2_1_4</title>
<ellipse fill="lightgreen" stroke="black" cx="14889.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14889.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14889.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14889.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_4 -->
<g id="edge720" class="edge">
<title>residual_1&#45;&gt;ln2_1_4</title>
<path fill="none" stroke="black" d="M15841.66,-6161.9C15653.43,-6154.34 15325.57,-6135.9 15047.57,-6093.26 15032.96,-6091.02 15017.7,-6088.16 15002.67,-6085.03"/>
<polygon fill="black" stroke="black" points="15003.34,-6081.6 14992.83,-6082.95 15001.89,-6088.45 15003.34,-6081.6"/>
</g>
<!-- ln2_1_5 -->
<g id="node598" class="node">
<title>ln2_1_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15205.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15205.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15205.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15205.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_5 -->
<g id="edge721" class="edge">
<title>residual_1&#45;&gt;ln2_1_5</title>
<path fill="none" stroke="black" d="M15849.95,-6154.46C15721.43,-6142.51 15529.29,-6121.94 15363.57,-6093.26 15349.49,-6090.82 15334.77,-6087.91 15320.23,-6084.82"/>
<polygon fill="black" stroke="black" points="15320.72,-6081.34 15310.2,-6082.65 15319.24,-6088.18 15320.72,-6081.34"/>
</g>
<!-- ln2_1_6 -->
<g id="node599" class="node">
<title>ln2_1_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15521.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15521.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15521.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15521.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_6 -->
<g id="edge722" class="edge">
<title>residual_1&#45;&gt;ln2_1_6</title>
<path fill="none" stroke="black" d="M15885.34,-6141.18C15811.65,-6124.08 15714.79,-6101.6 15639.55,-6084.14"/>
<polygon fill="black" stroke="black" points="15640.09,-6080.67 15629.55,-6081.82 15638.5,-6087.49 15640.09,-6080.67"/>
</g>
<!-- ln2_1_7 -->
<g id="node600" class="node">
<title>ln2_1_7</title>
<ellipse fill="lightgreen" stroke="black" cx="15837.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15837.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15837.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15837.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_7 -->
<g id="edge723" class="edge">
<title>residual_1&#45;&gt;ln2_1_7</title>
<path fill="none" stroke="black" d="M15945.58,-6131.95C15929.64,-6120.86 15911.88,-6108.49 15895.43,-6097.04"/>
<polygon fill="black" stroke="black" points="15897.18,-6093.99 15886.97,-6091.15 15893.18,-6099.73 15897.18,-6093.99"/>
</g>
<!-- ln2_1_8 -->
<g id="node601" class="node">
<title>ln2_1_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16153.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16153.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16153.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16153.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_8 -->
<g id="edge724" class="edge">
<title>residual_1&#45;&gt;ln2_1_8</title>
<path fill="none" stroke="black" d="M16045.57,-6131.95C16061.5,-6120.86 16079.27,-6108.49 16095.71,-6097.04"/>
<polygon fill="black" stroke="black" points="16097.97,-6099.73 16104.18,-6091.15 16093.97,-6093.99 16097.97,-6099.73"/>
</g>
<!-- ln2_1_9 -->
<g id="node602" class="node">
<title>ln2_1_9</title>
<ellipse fill="lightgreen" stroke="black" cx="16469.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16469.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16469.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16469.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_9 -->
<g id="edge725" class="edge">
<title>residual_1&#45;&gt;ln2_1_9</title>
<path fill="none" stroke="black" d="M16105.81,-6141.18C16179.5,-6124.08 16276.35,-6101.6 16351.59,-6084.14"/>
<polygon fill="black" stroke="black" points="16352.64,-6087.49 16361.59,-6081.82 16351.06,-6080.67 16352.64,-6087.49"/>
</g>
<!-- ln2_1_10 -->
<g id="node603" class="node">
<title>ln2_1_10</title>
<ellipse fill="lightgreen" stroke="black" cx="16785.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16785.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16785.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16785.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_10 -->
<g id="edge726" class="edge">
<title>residual_1&#45;&gt;ln2_1_10</title>
<path fill="none" stroke="black" d="M16141.19,-6154.46C16269.72,-6142.51 16461.86,-6121.94 16627.57,-6093.26 16641.66,-6090.82 16656.38,-6087.91 16670.92,-6084.82"/>
<polygon fill="black" stroke="black" points="16671.91,-6088.18 16680.94,-6082.65 16670.43,-6081.34 16671.91,-6088.18"/>
</g>
<!-- ln2_1_11 -->
<g id="node604" class="node">
<title>ln2_1_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17101.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17101.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17101.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17101.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_11 -->
<g id="edge727" class="edge">
<title>residual_1&#45;&gt;ln2_1_11</title>
<path fill="none" stroke="black" d="M16149.49,-6161.9C16337.71,-6154.34 16665.57,-6135.9 16943.57,-6093.26 16958.18,-6091.02 16973.45,-6088.16 16988.48,-6085.03"/>
<polygon fill="black" stroke="black" points="16989.26,-6088.45 16998.31,-6082.95 16987.81,-6081.6 16989.26,-6088.45"/>
</g>
<!-- ln2_1_12 -->
<g id="node605" class="node">
<title>ln2_1_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17417.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17417.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17417.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17417.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_12 -->
<g id="edge728" class="edge">
<title>residual_1&#45;&gt;ln2_1_12</title>
<path fill="none" stroke="black" d="M16151.11,-6166.14C16390.47,-6163.3 16863.02,-6150.17 17259.57,-6093.26 17274.43,-6091.13 17289.96,-6088.3 17305.22,-6085.16"/>
<polygon fill="black" stroke="black" points="17306.15,-6088.54 17315.21,-6083.05 17304.7,-6081.69 17306.15,-6088.54"/>
</g>
<!-- ln2_1_13 -->
<g id="node606" class="node">
<title>ln2_1_13</title>
<ellipse fill="lightgreen" stroke="black" cx="17733.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17733.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17733.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17733.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_13 -->
<g id="edge729" class="edge">
<title>residual_1&#45;&gt;ln2_1_13</title>
<path fill="none" stroke="black" d="M16149.94,-6163.13C16491.69,-6154.51 17303.45,-6130.71 17575.57,-6093.26 17590.56,-6091.2 17606.21,-6088.39 17621.6,-6085.25"/>
<polygon fill="black" stroke="black" points="17622.59,-6088.62 17631.66,-6083.14 17621.15,-6081.76 17622.59,-6088.62"/>
</g>
<!-- ln2_1_14 -->
<g id="node607" class="node">
<title>ln2_1_14</title>
<ellipse fill="lightgreen" stroke="black" cx="18049.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18049.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18049.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18049.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_14 -->
<g id="edge730" class="edge">
<title>residual_1&#45;&gt;ln2_1_14</title>
<path fill="none" stroke="black" d="M16150.78,-6164.51C16541.18,-6158.24 17556.7,-6138.02 17891.57,-6093.26 17906.57,-6091.25 17922.23,-6088.48 17937.61,-6085.36"/>
<polygon fill="black" stroke="black" points="17938.6,-6088.72 17947.67,-6083.25 17937.17,-6081.87 17938.6,-6088.72"/>
</g>
<!-- ln2_1_15 -->
<g id="node608" class="node">
<title>ln2_1_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18365.57" cy="-6055.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18365.57" y="-6067.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18365.57" y="-6052.06" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18365.57" y="-6037.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_15 -->
<g id="edge731" class="edge">
<title>residual_1&#45;&gt;ln2_1_15</title>
<path fill="none" stroke="black" d="M16149.59,-6162.22C16450.26,-6153.28 17136.5,-6132.51 17713.57,-6112.26 17933.16,-6104.55 17989.79,-6122.34 18207.57,-6093.26 18222.57,-6091.26 18238.23,-6088.49 18253.61,-6085.36"/>
<polygon fill="black" stroke="black" points="18254.6,-6088.73 18263.67,-6083.26 18253.17,-6081.88 18254.6,-6088.73"/>
</g>
<!-- mlp_fc1_1_0 -->
<g id="node609" class="node">
<title>mlp_fc1_1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13702.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13702.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="13702.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13702.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13702.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_0&#45;&gt;mlp_fc1_1_0 -->
<g id="edge732" class="edge">
<title>ln2_1_0&#45;&gt;mlp_fc1_1_0</title>
<path fill="none" stroke="black" d="M13648.68,-6018.58C13654.57,-6009.35 13661.04,-5999.22 13667.39,-5989.28"/>
<polygon fill="black" stroke="black" points="13670.48,-5990.93 13672.92,-5980.62 13664.58,-5987.16 13670.48,-5990.93"/>
</g>
<!-- mlp_fc1_1_1 -->
<g id="node610" class="node">
<title>mlp_fc1_1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14037.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14037.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14037.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14037.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14037.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_1&#45;&gt;mlp_fc1_1_1 -->
<g id="edge733" class="edge">
<title>ln2_1_1&#45;&gt;mlp_fc1_1_1</title>
<path fill="none" stroke="black" d="M13970.12,-6018.91C13977.87,-6009.17 13986.43,-5998.41 13994.79,-5987.92"/>
<polygon fill="black" stroke="black" points="13997.63,-5989.97 14001.12,-5979.97 13992.15,-5985.61 13997.63,-5989.97"/>
</g>
<!-- mlp_fc1_1_2 -->
<g id="node611" class="node">
<title>mlp_fc1_1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14343.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14343.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14343.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14343.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14343.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_2&#45;&gt;mlp_fc1_1_2 -->
<g id="edge734" class="edge">
<title>ln2_1_2&#45;&gt;mlp_fc1_1_2</title>
<path fill="none" stroke="black" d="M14283.38,-6018.58C14290.17,-6009.05 14297.65,-5998.57 14304.96,-5988.32"/>
<polygon fill="black" stroke="black" points="14307.81,-5990.35 14310.76,-5980.18 14302.11,-5986.29 14307.81,-5990.35"/>
</g>
<!-- mlp_fc1_1_3 -->
<g id="node612" class="node">
<title>mlp_fc1_1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14659.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14659.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14659.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14659.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14659.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_3&#45;&gt;mlp_fc1_1_3 -->
<g id="edge735" class="edge">
<title>ln2_1_3&#45;&gt;mlp_fc1_1_3</title>
<path fill="none" stroke="black" d="M14599.38,-6018.58C14606.17,-6009.05 14613.65,-5998.57 14620.96,-5988.32"/>
<polygon fill="black" stroke="black" points="14623.81,-5990.35 14626.76,-5980.18 14618.11,-5986.29 14623.81,-5990.35"/>
</g>
<!-- mlp_fc1_1_4 -->
<g id="node613" class="node">
<title>mlp_fc1_1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="14958.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14958.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14958.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14958.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14958.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_4&#45;&gt;mlp_fc1_1_4 -->
<g id="edge736" class="edge">
<title>ln2_1_4&#45;&gt;mlp_fc1_1_4</title>
<path fill="none" stroke="black" d="M14910.28,-6018.58C14915.5,-6009.44 14921.24,-5999.42 14926.87,-5989.58"/>
<polygon fill="black" stroke="black" points="14930.07,-5991.04 14932,-5980.62 14923.99,-5987.56 14930.07,-5991.04"/>
</g>
<!-- mlp_fc1_1_5 -->
<g id="node614" class="node">
<title>mlp_fc1_1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15260.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15260.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15260.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15260.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15260.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_5&#45;&gt;mlp_fc1_1_5 -->
<g id="edge737" class="edge">
<title>ln2_1_5&#45;&gt;mlp_fc1_1_5</title>
<path fill="none" stroke="black" d="M15222.22,-6018.25C15226.3,-6009.32 15230.75,-5999.56 15235.13,-5989.96"/>
<polygon fill="black" stroke="black" points="15238.33,-5991.38 15239.29,-5980.83 15231.96,-5988.47 15238.33,-5991.38"/>
</g>
<!-- mlp_fc1_1_6 -->
<g id="node615" class="node">
<title>mlp_fc1_1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15558.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15558.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15558.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15558.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15558.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_6&#45;&gt;mlp_fc1_1_6 -->
<g id="edge738" class="edge">
<title>ln2_1_6&#45;&gt;mlp_fc1_1_6</title>
<path fill="none" stroke="black" d="M15532.78,-6018.25C15535.43,-6009.61 15538.32,-6000.19 15541.17,-5990.88"/>
<polygon fill="black" stroke="black" points="15544.54,-5991.85 15544.12,-5981.26 15537.84,-5989.8 15544.54,-5991.85"/>
</g>
<!-- mlp_fc1_1_7 -->
<g id="node616" class="node">
<title>mlp_fc1_1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="15855.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15855.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15855.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15855.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15855.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_7&#45;&gt;mlp_fc1_1_7 -->
<g id="edge739" class="edge">
<title>ln2_1_7&#45;&gt;mlp_fc1_1_7</title>
<path fill="none" stroke="black" d="M15843.02,-6018.25C15844.3,-6009.7 15845.69,-6000.39 15847.06,-5991.18"/>
<polygon fill="black" stroke="black" points="15850.53,-5991.67 15848.54,-5981.26 15843.61,-5990.64 15850.53,-5991.67"/>
</g>
<!-- mlp_fc1_1_8 -->
<g id="node617" class="node">
<title>mlp_fc1_1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16153.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16153.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16153.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16153.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16153.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_8&#45;&gt;mlp_fc1_1_8 -->
<g id="edge740" class="edge">
<title>ln2_1_8&#45;&gt;mlp_fc1_1_8</title>
<path fill="none" stroke="black" d="M16153.57,-6018.25C16153.57,-6009.79 16153.57,-6000.59 16153.57,-5991.47"/>
<polygon fill="black" stroke="black" points="16157.07,-5991.26 16153.57,-5981.26 16150.07,-5991.27 16157.07,-5991.26"/>
</g>
<!-- mlp_fc1_1_9 -->
<g id="node618" class="node">
<title>mlp_fc1_1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16466.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16466.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16466.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16466.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16466.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_9&#45;&gt;mlp_fc1_1_9 -->
<g id="edge741" class="edge">
<title>ln2_1_9&#45;&gt;mlp_fc1_1_9</title>
<path fill="none" stroke="black" d="M16468.67,-6018.25C16468.45,-6009.79 16468.23,-6000.59 16468,-5991.47"/>
<polygon fill="black" stroke="black" points="16471.49,-5991.17 16467.75,-5981.26 16464.49,-5991.35 16471.49,-5991.17"/>
</g>
<!-- mlp_fc1_1_10 -->
<g id="node619" class="node">
<title>mlp_fc1_1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16773.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16773.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16773.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16773.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16773.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_10&#45;&gt;mlp_fc1_1_10 -->
<g id="edge742" class="edge">
<title>ln2_1_10&#45;&gt;mlp_fc1_1_10</title>
<path fill="none" stroke="black" d="M16781.94,-6018.25C16781.1,-6009.79 16780.18,-6000.59 16779.28,-5991.47"/>
<polygon fill="black" stroke="black" points="16782.73,-5990.87 16778.26,-5981.26 16775.77,-5991.56 16782.73,-5990.87"/>
</g>
<!-- mlp_fc1_1_11 -->
<g id="node620" class="node">
<title>mlp_fc1_1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17084.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17084.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17084.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17084.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17084.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_11&#45;&gt;mlp_fc1_1_11 -->
<g id="edge743" class="edge">
<title>ln2_1_11&#45;&gt;mlp_fc1_1_11</title>
<path fill="none" stroke="black" d="M17096.43,-6018.25C17095.22,-6009.7 17093.91,-6000.39 17092.61,-5991.18"/>
<polygon fill="black" stroke="black" points="17096.07,-5990.68 17091.21,-5981.26 17089.14,-5991.66 17096.07,-5990.68"/>
</g>
<!-- mlp_fc1_1_12 -->
<g id="node621" class="node">
<title>mlp_fc1_1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17398.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17398.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17398.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17398.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17398.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_12&#45;&gt;mlp_fc1_1_12 -->
<g id="edge744" class="edge">
<title>ln2_1_12&#45;&gt;mlp_fc1_1_12</title>
<path fill="none" stroke="black" d="M17411.82,-6018.25C17410.47,-6009.7 17409.01,-6000.39 17407.56,-5991.18"/>
<polygon fill="black" stroke="black" points="17411.01,-5990.6 17405.99,-5981.26 17404.09,-5991.69 17411.01,-5990.6"/>
</g>
<!-- mlp_fc1_1_13 -->
<g id="node622" class="node">
<title>mlp_fc1_1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17713.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17713.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17713.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17713.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17713.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_13&#45;&gt;mlp_fc1_1_13 -->
<g id="edge745" class="edge">
<title>ln2_1_13&#45;&gt;mlp_fc1_1_13</title>
<path fill="none" stroke="black" d="M17727.52,-6018.25C17726.1,-6009.7 17724.56,-6000.39 17723.03,-5991.18"/>
<polygon fill="black" stroke="black" points="17726.47,-5990.56 17721.38,-5981.26 17719.57,-5991.7 17726.47,-5990.56"/>
</g>
<!-- mlp_fc1_1_14 -->
<g id="node623" class="node">
<title>mlp_fc1_1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18028.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18028.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18028.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18028.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18028.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_14&#45;&gt;mlp_fc1_1_14 -->
<g id="edge746" class="edge">
<title>ln2_1_14&#45;&gt;mlp_fc1_1_14</title>
<path fill="none" stroke="black" d="M18043.22,-6018.25C18041.73,-6009.7 18040.1,-6000.39 18038.5,-5991.18"/>
<polygon fill="black" stroke="black" points="18041.94,-5990.52 18036.77,-5981.26 18035.04,-5991.72 18041.94,-5990.52"/>
</g>
<!-- mlp_fc1_1_15 -->
<g id="node624" class="node">
<title>mlp_fc1_1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18344.57" cy="-5933.17" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18344.57" y="-5951.97" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18344.57" y="-5936.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18344.57" y="-5921.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18344.57" y="-5906.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_1_15&#45;&gt;mlp_fc1_1_15 -->
<g id="edge747" class="edge">
<title>ln2_1_15&#45;&gt;mlp_fc1_1_15</title>
<path fill="none" stroke="black" d="M18359.22,-6018.25C18357.73,-6009.7 18356.1,-6000.39 18354.5,-5991.18"/>
<polygon fill="black" stroke="black" points="18357.94,-5990.52 18352.77,-5981.26 18351.04,-5991.72 18357.94,-5990.52"/>
</g>
<!-- mlp_gelu_1_0 -->
<g id="node625" class="node">
<title>mlp_gelu_1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13702.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="13702.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13702.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13702.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_0&#45;&gt;mlp_gelu_1_0 -->
<g id="edge748" class="edge">
<title>mlp_fc1_1_0&#45;&gt;mlp_gelu_1_0</title>
<path fill="none" stroke="black" d="M13702.57,-5884.86C13702.57,-5876.23 13702.57,-5867.23 13702.57,-5858.61"/>
<polygon fill="black" stroke="black" points="13706.07,-5858.33 13702.57,-5848.33 13699.07,-5858.33 13706.07,-5858.33"/>
</g>
<!-- mlp_gelu_1_1 -->
<g id="node626" class="node">
<title>mlp_gelu_1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14041.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14041.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14041.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14041.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_1&#45;&gt;mlp_gelu_1_1 -->
<g id="edge749" class="edge">
<title>mlp_fc1_1_1&#45;&gt;mlp_gelu_1_1</title>
<path fill="none" stroke="black" d="M14039.14,-5884.86C14039.43,-5876.23 14039.73,-5867.23 14040.01,-5858.61"/>
<polygon fill="black" stroke="black" points="14043.52,-5858.44 14040.35,-5848.33 14036.53,-5858.21 14043.52,-5858.44"/>
</g>
<!-- mlp_gelu_1_2 -->
<g id="node627" class="node">
<title>mlp_gelu_1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14353.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14353.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14353.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14353.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_2&#45;&gt;mlp_gelu_1_2 -->
<g id="edge750" class="edge">
<title>mlp_fc1_1_2&#45;&gt;mlp_gelu_1_2</title>
<path fill="none" stroke="black" d="M14347.5,-5884.86C14348.22,-5876.14 14348.98,-5867.03 14349.7,-5858.32"/>
<polygon fill="black" stroke="black" points="14353.19,-5858.58 14350.53,-5848.33 14346.21,-5858 14353.19,-5858.58"/>
</g>
<!-- mlp_gelu_1_3 -->
<g id="node628" class="node">
<title>mlp_gelu_1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14667.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14667.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14667.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14667.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_3&#45;&gt;mlp_gelu_1_3 -->
<g id="edge751" class="edge">
<title>mlp_fc1_1_3&#45;&gt;mlp_gelu_1_3</title>
<path fill="none" stroke="black" d="M14662.71,-5884.86C14663.29,-5876.14 14663.9,-5867.03 14664.47,-5858.32"/>
<polygon fill="black" stroke="black" points="14667.97,-5858.54 14665.14,-5848.33 14660.98,-5858.07 14667.97,-5858.54"/>
</g>
<!-- mlp_gelu_1_4 -->
<g id="node629" class="node">
<title>mlp_gelu_1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="14964.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14964.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14964.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14964.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_4&#45;&gt;mlp_gelu_1_4 -->
<g id="edge752" class="edge">
<title>mlp_fc1_1_4&#45;&gt;mlp_gelu_1_4</title>
<path fill="none" stroke="black" d="M14960.93,-5884.86C14961.36,-5876.14 14961.81,-5867.03 14962.25,-5858.32"/>
<polygon fill="black" stroke="black" points="14965.74,-5858.49 14962.75,-5848.33 14958.75,-5858.14 14965.74,-5858.49"/>
</g>
<!-- mlp_gelu_1_5 -->
<g id="node630" class="node">
<title>mlp_gelu_1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15261.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15261.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15261.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15261.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_5&#45;&gt;mlp_gelu_1_5 -->
<g id="edge753" class="edge">
<title>mlp_fc1_1_5&#45;&gt;mlp_gelu_1_5</title>
<path fill="none" stroke="black" d="M15260.97,-5884.86C15261.04,-5876.23 15261.11,-5867.23 15261.18,-5858.61"/>
<polygon fill="black" stroke="black" points="15264.69,-5858.36 15261.27,-5848.33 15257.69,-5858.3 15264.69,-5858.36"/>
</g>
<!-- mlp_gelu_1_6 -->
<g id="node631" class="node">
<title>mlp_gelu_1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15558.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15558.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15558.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15558.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_6&#45;&gt;mlp_gelu_1_6 -->
<g id="edge754" class="edge">
<title>mlp_fc1_1_6&#45;&gt;mlp_gelu_1_6</title>
<path fill="none" stroke="black" d="M15558.57,-5884.86C15558.57,-5876.23 15558.57,-5867.23 15558.57,-5858.61"/>
<polygon fill="black" stroke="black" points="15562.07,-5858.33 15558.57,-5848.33 15555.07,-5858.33 15562.07,-5858.33"/>
</g>
<!-- mlp_gelu_1_7 -->
<g id="node632" class="node">
<title>mlp_gelu_1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="15855.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15855.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15855.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15855.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_7&#45;&gt;mlp_gelu_1_7 -->
<g id="edge755" class="edge">
<title>mlp_fc1_1_7&#45;&gt;mlp_gelu_1_7</title>
<path fill="none" stroke="black" d="M15855.57,-5884.86C15855.57,-5876.23 15855.57,-5867.23 15855.57,-5858.61"/>
<polygon fill="black" stroke="black" points="15859.07,-5858.33 15855.57,-5848.33 15852.07,-5858.33 15859.07,-5858.33"/>
</g>
<!-- mlp_gelu_1_8 -->
<g id="node633" class="node">
<title>mlp_gelu_1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16152.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16152.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16152.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16152.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_8&#45;&gt;mlp_gelu_1_8 -->
<g id="edge756" class="edge">
<title>mlp_fc1_1_8&#45;&gt;mlp_gelu_1_8</title>
<path fill="none" stroke="black" d="M16153.18,-5884.86C16153.11,-5876.23 16153.03,-5867.23 16152.96,-5858.61"/>
<polygon fill="black" stroke="black" points="16156.46,-5858.3 16152.88,-5848.33 16149.46,-5858.36 16156.46,-5858.3"/>
</g>
<!-- mlp_gelu_1_9 -->
<g id="node634" class="node">
<title>mlp_gelu_1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16458.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16458.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16458.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16458.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_9&#45;&gt;mlp_gelu_1_9 -->
<g id="edge757" class="edge">
<title>mlp_fc1_1_9&#45;&gt;mlp_gelu_1_9</title>
<path fill="none" stroke="black" d="M16463.43,-5884.86C16462.86,-5876.14 16462.25,-5867.03 16461.67,-5858.32"/>
<polygon fill="black" stroke="black" points="16465.17,-5858.07 16461.01,-5848.33 16458.18,-5858.54 16465.17,-5858.07"/>
</g>
<!-- mlp_gelu_1_10 -->
<g id="node635" class="node">
<title>mlp_gelu_1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16760.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16760.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16760.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16760.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_10&#45;&gt;mlp_gelu_1_10 -->
<g id="edge758" class="edge">
<title>mlp_fc1_1_10&#45;&gt;mlp_gelu_1_10</title>
<path fill="none" stroke="black" d="M16768.47,-5884.86C16767.53,-5876.14 16766.55,-5867.03 16765.61,-5858.32"/>
<polygon fill="black" stroke="black" points="16769.09,-5857.9 16764.53,-5848.33 16762.13,-5858.65 16769.09,-5857.9"/>
</g>
<!-- mlp_gelu_1_11 -->
<g id="node636" class="node">
<title>mlp_gelu_1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17059.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17059.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17059.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17059.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_11&#45;&gt;mlp_gelu_1_11 -->
<g id="edge759" class="edge">
<title>mlp_fc1_1_11&#45;&gt;mlp_gelu_1_11</title>
<path fill="none" stroke="black" d="M17074.76,-5884.86C17072.96,-5876.14 17071.07,-5867.03 17069.26,-5858.32"/>
<polygon fill="black" stroke="black" points="17072.65,-5857.41 17067.19,-5848.33 17065.79,-5858.83 17072.65,-5857.41"/>
</g>
<!-- mlp_gelu_1_12 -->
<g id="node637" class="node">
<title>mlp_gelu_1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17357.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17357.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17357.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17357.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_12&#45;&gt;mlp_gelu_1_12 -->
<g id="edge760" class="edge">
<title>mlp_fc1_1_12&#45;&gt;mlp_gelu_1_12</title>
<path fill="none" stroke="black" d="M17382.6,-5885.21C17379.53,-5876.18 17376.32,-5866.72 17373.26,-5857.72"/>
<polygon fill="black" stroke="black" points="17376.54,-5856.5 17370.01,-5848.16 17369.91,-5858.76 17376.54,-5856.5"/>
</g>
<!-- mlp_gelu_1_13 -->
<g id="node638" class="node">
<title>mlp_gelu_1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17655.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17655.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17655.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17655.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_13&#45;&gt;mlp_gelu_1_13 -->
<g id="edge761" class="edge">
<title>mlp_fc1_1_13&#45;&gt;mlp_gelu_1_13</title>
<path fill="none" stroke="black" d="M17691.15,-5885.55C17686.65,-5876.21 17681.94,-5866.4 17677.46,-5857.1"/>
<polygon fill="black" stroke="black" points="17680.57,-5855.49 17673.08,-5847.99 17674.26,-5858.52 17680.57,-5855.49"/>
</g>
<!-- mlp_gelu_1_14 -->
<g id="node639" class="node">
<title>mlp_gelu_1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17952.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17952.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17952.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17952.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_14&#45;&gt;mlp_gelu_1_14 -->
<g id="edge762" class="edge">
<title>mlp_fc1_1_14&#45;&gt;mlp_gelu_1_14</title>
<path fill="none" stroke="black" d="M17999.41,-5885.9C17993.32,-5876.24 17986.91,-5866.07 17980.85,-5856.46"/>
<polygon fill="black" stroke="black" points="17983.7,-5854.42 17975.41,-5847.82 17977.78,-5858.15 17983.7,-5854.42"/>
</g>
<!-- mlp_gelu_1_15 -->
<g id="node640" class="node">
<title>mlp_gelu_1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18249.57" cy="-5810.59" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18249.57" y="-5821.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18249.57" y="-5806.89" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18249.57" y="-5791.89" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_1_15&#45;&gt;mlp_gelu_1_15 -->
<g id="edge763" class="edge">
<title>mlp_fc1_1_15&#45;&gt;mlp_gelu_1_15</title>
<path fill="none" stroke="black" d="M18308.66,-5886.59C18300.61,-5876.38 18292.1,-5865.57 18284.11,-5855.43"/>
<polygon fill="black" stroke="black" points="18286.78,-5853.16 18277.84,-5847.47 18281.28,-5857.49 18286.78,-5853.16"/>
</g>
<!-- mlp_fc2_1_0 -->
<g id="node641" class="node">
<title>mlp_fc2_1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13803.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13803.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13803.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13803.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13803.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_0&#45;&gt;mlp_fc2_1_0 -->
<g id="edge764" class="edge">
<title>mlp_gelu_1_0&#45;&gt;mlp_fc2_1_0</title>
<path fill="none" stroke="black" d="M13732.6,-5773.74C13740.93,-5763.8 13750.16,-5752.78 13759.12,-5742.08"/>
<polygon fill="black" stroke="black" points="13761.85,-5744.27 13765.59,-5734.36 13756.48,-5739.78 13761.85,-5744.27"/>
</g>
<!-- mlp_fc2_1_1 -->
<g id="node642" class="node">
<title>mlp_fc2_1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14093.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14093.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14093.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14093.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14093.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_1&#45;&gt;mlp_fc2_1_1 -->
<g id="edge765" class="edge">
<title>mlp_gelu_1_1&#45;&gt;mlp_fc2_1_1</title>
<path fill="none" stroke="black" d="M14057.32,-5773.09C14061.13,-5764.25 14065.29,-5754.6 14069.39,-5745.09"/>
<polygon fill="black" stroke="black" points="14072.71,-5746.23 14073.46,-5735.66 14066.28,-5743.46 14072.71,-5746.23"/>
</g>
<!-- mlp_fc2_1_2 -->
<g id="node643" class="node">
<title>mlp_fc2_1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14380.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14380.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14380.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14380.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14380.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_2&#45;&gt;mlp_fc2_1_2 -->
<g id="edge766" class="edge">
<title>mlp_gelu_1_2&#45;&gt;mlp_fc2_1_2</title>
<path fill="none" stroke="black" d="M14361.75,-5773.09C14363.66,-5764.53 14365.75,-5755.22 14367.81,-5746.01"/>
<polygon fill="black" stroke="black" points="14371.26,-5746.62 14370.03,-5736.1 14364.43,-5745.09 14371.26,-5746.62"/>
</g>
<!-- mlp_fc2_1_3 -->
<g id="node644" class="node">
<title>mlp_fc2_1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14676.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14676.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14676.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14676.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14676.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_3&#45;&gt;mlp_fc2_1_3 -->
<g id="edge767" class="edge">
<title>mlp_gelu_1_3&#45;&gt;mlp_fc2_1_3</title>
<path fill="none" stroke="black" d="M14670.3,-5773.09C14670.93,-5764.62 14671.62,-5755.42 14672.3,-5746.3"/>
<polygon fill="black" stroke="black" points="14675.8,-5746.33 14673.06,-5736.1 14668.82,-5745.81 14675.8,-5746.33"/>
</g>
<!-- mlp_fc2_1_4 -->
<g id="node645" class="node">
<title>mlp_fc2_1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="14986.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14986.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14986.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14986.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14986.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_4&#45;&gt;mlp_fc2_1_4 -->
<g id="edge768" class="edge">
<title>mlp_gelu_1_4&#45;&gt;mlp_fc2_1_4</title>
<path fill="none" stroke="black" d="M14971.23,-5773.09C14972.79,-5764.53 14974.49,-5755.22 14976.17,-5746.01"/>
<polygon fill="black" stroke="black" points="14979.63,-5746.56 14977.98,-5736.1 14972.74,-5745.31 14979.63,-5746.56"/>
</g>
<!-- mlp_fc2_1_5 -->
<g id="node646" class="node">
<title>mlp_fc2_1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15283.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15283.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15283.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15283.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15283.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_5&#45;&gt;mlp_fc2_1_5 -->
<g id="edge769" class="edge">
<title>mlp_gelu_1_5&#45;&gt;mlp_fc2_1_5</title>
<path fill="none" stroke="black" d="M15268.23,-5773.09C15269.79,-5764.53 15271.49,-5755.22 15273.17,-5746.01"/>
<polygon fill="black" stroke="black" points="15276.63,-5746.56 15274.98,-5736.1 15269.74,-5745.31 15276.63,-5746.56"/>
</g>
<!-- mlp_fc2_1_6 -->
<g id="node647" class="node">
<title>mlp_fc2_1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15573.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15573.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15573.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15573.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15573.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_6&#45;&gt;mlp_fc2_1_6 -->
<g id="edge770" class="edge">
<title>mlp_gelu_1_6&#45;&gt;mlp_fc2_1_6</title>
<path fill="none" stroke="black" d="M15563.11,-5773.09C15564.17,-5764.62 15565.31,-5755.42 15566.45,-5746.3"/>
<polygon fill="black" stroke="black" points="15569.95,-5746.45 15567.72,-5736.1 15563.01,-5745.59 15569.95,-5746.45"/>
</g>
<!-- mlp_fc2_1_7 -->
<g id="node648" class="node">
<title>mlp_fc2_1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="15860.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15860.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15860.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15860.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15860.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_7&#45;&gt;mlp_fc2_1_7 -->
<g id="edge771" class="edge">
<title>mlp_gelu_1_7&#45;&gt;mlp_fc2_1_7</title>
<path fill="none" stroke="black" d="M15857.09,-5773.09C15857.44,-5764.62 15857.82,-5755.42 15858.2,-5746.3"/>
<polygon fill="black" stroke="black" points="15861.7,-5746.23 15858.62,-5736.1 15854.71,-5745.94 15861.7,-5746.23"/>
</g>
<!-- mlp_fc2_1_8 -->
<g id="node649" class="node">
<title>mlp_fc2_1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16150.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16150.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16150.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16150.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16150.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_8&#45;&gt;mlp_fc2_1_8 -->
<g id="edge772" class="edge">
<title>mlp_gelu_1_8&#45;&gt;mlp_fc2_1_8</title>
<path fill="none" stroke="black" d="M16151.97,-5773.09C16151.83,-5764.62 16151.67,-5755.42 16151.52,-5746.3"/>
<polygon fill="black" stroke="black" points="16155.02,-5746.04 16151.35,-5736.1 16148.02,-5746.16 16155.02,-5746.04"/>
</g>
<!-- mlp_fc2_1_9 -->
<g id="node650" class="node">
<title>mlp_fc2_1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16444.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16444.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16444.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16444.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16444.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_9&#45;&gt;mlp_fc2_1_9 -->
<g id="edge773" class="edge">
<title>mlp_gelu_1_9&#45;&gt;mlp_fc2_1_9</title>
<path fill="none" stroke="black" d="M16454.33,-5773.09C16453.35,-5764.62 16452.28,-5755.42 16451.23,-5746.3"/>
<polygon fill="black" stroke="black" points="16454.67,-5745.63 16450.04,-5736.1 16447.72,-5746.44 16454.67,-5745.63"/>
</g>
<!-- mlp_fc2_1_10 -->
<g id="node651" class="node">
<title>mlp_fc2_1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16739.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16739.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16739.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16739.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16739.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_10&#45;&gt;mlp_fc2_1_10 -->
<g id="edge774" class="edge">
<title>mlp_gelu_1_10&#45;&gt;mlp_fc2_1_10</title>
<path fill="none" stroke="black" d="M16754.22,-5773.09C16752.73,-5764.53 16751.1,-5755.22 16749.5,-5746.01"/>
<polygon fill="black" stroke="black" points="16752.94,-5745.35 16747.77,-5736.1 16746.04,-5746.55 16752.94,-5745.35"/>
</g>
<!-- mlp_fc2_1_11 -->
<g id="node652" class="node">
<title>mlp_fc2_1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17035.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17035.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17035.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17035.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17035.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_11&#45;&gt;mlp_fc2_1_11 -->
<g id="edge775" class="edge">
<title>mlp_gelu_1_11&#45;&gt;mlp_fc2_1_11</title>
<path fill="none" stroke="black" d="M17052.31,-5773.09C17050.61,-5764.53 17048.75,-5755.22 17046.92,-5746.01"/>
<polygon fill="black" stroke="black" points="17050.33,-5745.22 17044.95,-5736.1 17043.47,-5746.59 17050.33,-5745.22"/>
</g>
<!-- mlp_fc2_1_12 -->
<g id="node653" class="node">
<title>mlp_fc2_1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17332.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17332.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17332.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17332.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17332.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_12&#45;&gt;mlp_fc2_1_12 -->
<g id="edge776" class="edge">
<title>mlp_gelu_1_12&#45;&gt;mlp_fc2_1_12</title>
<path fill="none" stroke="black" d="M17350,-5773.09C17348.23,-5764.53 17346.3,-5755.22 17344.39,-5746.01"/>
<polygon fill="black" stroke="black" points="17347.79,-5745.18 17342.34,-5736.1 17340.94,-5746.6 17347.79,-5745.18"/>
</g>
<!-- mlp_fc2_1_13 -->
<g id="node654" class="node">
<title>mlp_fc2_1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17629.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17629.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17629.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17629.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17629.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_13&#45;&gt;mlp_fc2_1_13 -->
<g id="edge777" class="edge">
<title>mlp_gelu_1_13&#45;&gt;mlp_fc2_1_13</title>
<path fill="none" stroke="black" d="M17647.7,-5773.09C17645.86,-5764.53 17643.85,-5755.22 17641.86,-5746.01"/>
<polygon fill="black" stroke="black" points="17645.26,-5745.14 17639.73,-5736.1 17638.41,-5746.61 17645.26,-5745.14"/>
</g>
<!-- mlp_fc2_1_14 -->
<g id="node655" class="node">
<title>mlp_fc2_1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17926.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17926.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17926.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17926.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17926.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_14&#45;&gt;mlp_fc2_1_14 -->
<g id="edge778" class="edge">
<title>mlp_gelu_1_14&#45;&gt;mlp_fc2_1_14</title>
<path fill="none" stroke="black" d="M17944.7,-5773.09C17942.86,-5764.53 17940.85,-5755.22 17938.86,-5746.01"/>
<polygon fill="black" stroke="black" points="17942.26,-5745.14 17936.73,-5736.1 17935.41,-5746.61 17942.26,-5745.14"/>
</g>
<!-- mlp_fc2_1_15 -->
<g id="node656" class="node">
<title>mlp_fc2_1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18223.57" cy="-5688.01" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18223.57" y="-5706.81" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18223.57" y="-5691.81" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18223.57" y="-5676.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18223.57" y="-5661.81" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_1_15&#45;&gt;mlp_fc2_1_15 -->
<g id="edge779" class="edge">
<title>mlp_gelu_1_15&#45;&gt;mlp_fc2_1_15</title>
<path fill="none" stroke="black" d="M18241.7,-5773.09C18239.86,-5764.53 18237.85,-5755.22 18235.86,-5746.01"/>
<polygon fill="black" stroke="black" points="18239.26,-5745.14 18233.73,-5736.1 18232.41,-5746.61 18239.26,-5745.14"/>
</g>
<!-- allreduce_mlp_1 -->
<g id="node657" class="node">
<title>allreduce_mlp_1</title>
<polygon fill="red" stroke="black" points="15940.57,-5602.93 15815.57,-5549.93 15940.57,-5496.93 16065.57,-5549.93 15940.57,-5602.93"/>
<text text-anchor="middle" x="15940.57" y="-5561.23" font-family="Times,serif" font-size="14.00">AllReduce MLP</text>
<text text-anchor="middle" x="15940.57" y="-5546.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="15940.57" y="-5531.23" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_fc2_1_0&#45;&gt;allreduce_mlp_1 -->
<g id="edge780" class="edge">
<title>mlp_fc2_1_0&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M13896.19,-5653.47C13914.34,-5648.06 13933.39,-5643.18 13951.57,-5639.93 14132.45,-5607.57 14181.01,-5629.22 14364.57,-5620.93 14907.19,-5596.39 15554.94,-5567.86 15819.26,-5556.25"/>
<polygon fill="black" stroke="black" points="15819.43,-5559.74 15829.27,-5555.81 15819.12,-5552.75 15819.43,-5559.74"/>
</g>
<!-- mlp_fc2_1_1&#45;&gt;allreduce_mlp_1 -->
<g id="edge781" class="edge">
<title>mlp_fc2_1_1&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M14185.46,-5653.19C14202.89,-5647.92 14221.14,-5643.15 14238.57,-5639.93 14540.38,-5584.04 15470.82,-5560.28 15812.78,-5553.28"/>
<polygon fill="black" stroke="black" points="15813.05,-5556.78 15822.97,-5553.08 15812.9,-5549.78 15813.05,-5556.78"/>
</g>
<!-- mlp_fc2_1_2&#45;&gt;allreduce_mlp_1 -->
<g id="edge782" class="edge">
<title>mlp_fc2_1_2&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M14475.42,-5654.23C14494.79,-5648.61 14515.18,-5643.45 14534.57,-5639.93 14778.85,-5595.48 15520.02,-5565.55 15816.27,-5555.07"/>
<polygon fill="black" stroke="black" points="15816.75,-5558.56 15826.62,-5554.71 15816.51,-5551.56 15816.75,-5558.56"/>
</g>
<!-- mlp_fc2_1_3&#45;&gt;allreduce_mlp_1 -->
<g id="edge783" class="edge">
<title>mlp_fc2_1_3&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M14775.78,-5655.81C14798.22,-5649.7 14822.06,-5643.95 14844.57,-5639.93 15191.07,-5577.9 15607.01,-5559.05 15812.6,-5553.36"/>
<polygon fill="black" stroke="black" points="15812.93,-5556.85 15822.84,-5553.08 15812.74,-5549.86 15812.93,-5556.85"/>
</g>
<!-- mlp_fc2_1_4&#45;&gt;allreduce_mlp_1 -->
<g id="edge784" class="edge">
<title>mlp_fc2_1_4&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M15083.02,-5654.72C15102.25,-5649.13 15122.43,-5643.86 15141.57,-5639.93 15379.86,-5590.9 15664.05,-5567.37 15821.18,-5557.35"/>
<polygon fill="black" stroke="black" points="15821.59,-5560.83 15831.35,-5556.71 15821.15,-5553.85 15821.59,-5560.83"/>
</g>
<!-- mlp_fc2_1_5&#45;&gt;allreduce_mlp_1 -->
<g id="edge785" class="edge">
<title>mlp_fc2_1_5&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M15379.37,-5654.46C15396.63,-5649.19 15414.55,-5644.1 15431.57,-5639.93 15570.28,-5605.9 15733.31,-5579.78 15836.77,-5564.88"/>
<polygon fill="black" stroke="black" points="15837.51,-5568.31 15846.91,-5563.43 15836.51,-5561.38 15837.51,-5568.31"/>
</g>
<!-- mlp_fc2_1_6&#45;&gt;allreduce_mlp_1 -->
<g id="edge786" class="edge">
<title>mlp_fc2_1_6&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M15665.24,-5653.02C15727.08,-5630.09 15807.67,-5600.2 15865.66,-5578.7"/>
<polygon fill="black" stroke="black" points="15866.97,-5581.95 15875.13,-5575.19 15864.54,-5575.39 15866.97,-5581.95"/>
</g>
<!-- mlp_fc2_1_7&#45;&gt;allreduce_mlp_1 -->
<g id="edge787" class="edge">
<title>mlp_fc2_1_7&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M15887.88,-5640.56C15895.31,-5627.92 15903.39,-5614.17 15910.94,-5601.33"/>
<polygon fill="black" stroke="black" points="15914.02,-5603 15916.07,-5592.61 15907.99,-5599.45 15914.02,-5603"/>
</g>
<!-- mlp_fc2_1_8&#45;&gt;allreduce_mlp_1 -->
<g id="edge788" class="edge">
<title>mlp_fc2_1_8&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M16086.71,-5645.62C16058.4,-5627.28 16025.35,-5605.86 15997.85,-5588.04"/>
<polygon fill="black" stroke="black" points="15999.42,-5584.89 15989.13,-5582.39 15995.62,-5590.77 15999.42,-5584.89"/>
</g>
<!-- mlp_fc2_1_9&#45;&gt;allreduce_mlp_1 -->
<g id="edge789" class="edge">
<title>mlp_fc2_1_9&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M16345.86,-5655.6C16328.17,-5650.21 16309.86,-5644.78 16292.57,-5639.93 16203.47,-5614.88 16100.77,-5589.28 16029.39,-5572.01"/>
<polygon fill="black" stroke="black" points="16030.07,-5568.57 16019.53,-5569.63 16028.43,-5575.38 16030.07,-5568.57"/>
</g>
<!-- mlp_fc2_1_10&#45;&gt;allreduce_mlp_1 -->
<g id="edge790" class="edge">
<title>mlp_fc2_1_10&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M16643.08,-5654.73C16624.47,-5649.24 16605.03,-5644.01 16586.57,-5639.93 16401.59,-5599 16182.41,-5573.55 16052.79,-5560.83"/>
<polygon fill="black" stroke="black" points="16052.75,-5557.31 16042.45,-5559.82 16052.07,-5564.28 16052.75,-5557.31"/>
</g>
<!-- mlp_fc2_1_11&#45;&gt;allreduce_mlp_1 -->
<g id="edge791" class="edge">
<title>mlp_fc2_1_11&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M16939.81,-5654.46C16920.7,-5648.9 16900.63,-5643.7 16881.57,-5639.93 16592.86,-5582.75 16246.79,-5562 16065.46,-5554.71"/>
<polygon fill="black" stroke="black" points="16065.49,-5551.2 16055.36,-5554.31 16065.21,-5558.2 16065.49,-5551.2"/>
</g>
<!-- mlp_fc2_1_12&#45;&gt;allreduce_mlp_1 -->
<g id="edge792" class="edge">
<title>mlp_fc2_1_12&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M17237.07,-5654.37C17217.58,-5648.74 17197.07,-5643.54 17177.57,-5639.93 16780.71,-5566.33 16301.76,-5552.79 16073.75,-5550.82"/>
<polygon fill="black" stroke="black" points="16073.78,-5547.32 16063.75,-5550.74 16073.72,-5554.32 16073.78,-5547.32"/>
</g>
<!-- mlp_fc2_1_13&#45;&gt;allreduce_mlp_1 -->
<g id="edge793" class="edge">
<title>mlp_fc2_1_13&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M17534.53,-5654.27C17514.91,-5648.61 17494.23,-5643.43 17474.57,-5639.93 17205.11,-5591.88 16381.96,-5563.67 16065.94,-5554.37"/>
<polygon fill="black" stroke="black" points="16065.93,-5550.87 16055.83,-5554.08 16065.72,-5557.87 16065.93,-5550.87"/>
</g>
<!-- mlp_fc2_1_14&#45;&gt;allreduce_mlp_1 -->
<g id="edge794" class="edge">
<title>mlp_fc2_1_14&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M17831.55,-5654.13C17811.93,-5648.48 17791.25,-5643.34 17771.57,-5639.93 17443.61,-5583.04 16429.14,-5559.7 16069.01,-5553.06"/>
<polygon fill="black" stroke="black" points="16068.87,-5549.56 16058.81,-5552.87 16068.74,-5556.55 16068.87,-5549.56"/>
</g>
<!-- mlp_fc2_1_15&#45;&gt;allreduce_mlp_1 -->
<g id="edge795" class="edge">
<title>mlp_fc2_1_15&#45;&gt;allreduce_mlp_1</title>
<path fill="none" stroke="black" d="M18128.98,-5654.19C18109.23,-5648.5 18088.39,-5643.32 18068.57,-5639.93 17882.65,-5608.04 17833.03,-5629.02 17644.57,-5620.93 17051.77,-5595.47 16342.88,-5566.97 16062.91,-5555.79"/>
<polygon fill="black" stroke="black" points="16062.86,-5552.29 16052.73,-5555.39 16062.58,-5559.28 16062.86,-5552.29"/>
</g>
<!-- residual2_1 -->
<g id="node658" class="node">
<title>residual2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="15940.57" cy="-5422.43" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="15940.57" y="-5433.73" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15940.57" y="-5418.73" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="15940.57" y="-5403.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_mlp_1&#45;&gt;residual2_1 -->
<g id="edge796" class="edge">
<title>allreduce_mlp_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M15940.57,-5496.79C15940.57,-5488.08 15940.57,-5479.08 15940.57,-5470.51"/>
<polygon fill="black" stroke="black" points="15944.07,-5470.3 15940.57,-5460.3 15937.07,-5470.3 15944.07,-5470.3"/>
</g>
<!-- ln1_2_0 -->
<g id="node659" class="node">
<title>ln1_2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13124.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13124.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13124.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13124.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_0 -->
<g id="edge797" class="edge">
<title>residual2_1&#45;&gt;ln1_2_0</title>
<path fill="none" stroke="black" d="M15785.12,-5420.54C15397.19,-5417.5 14355.28,-5404.3 13488.57,-5347.93 13415.93,-5343.2 13335.37,-5335.39 13268.55,-5328.2"/>
<polygon fill="black" stroke="black" points="13268.68,-5324.7 13258.37,-5327.1 13267.93,-5331.66 13268.68,-5324.7"/>
</g>
<!-- ln1_2_1 -->
<g id="node660" class="node">
<title>ln1_2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="13646.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13646.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13646.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13646.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_1 -->
<g id="edge798" class="edge">
<title>residual2_1&#45;&gt;ln1_2_1</title>
<path fill="none" stroke="black" d="M15784.98,-5421.24C15444.13,-5419.66 14606.17,-5409.24 13907.57,-5347.93 13866.1,-5344.29 13821.13,-5338.62 13780.4,-5332.83"/>
<polygon fill="black" stroke="black" points="13780.81,-5329.35 13770.41,-5331.4 13779.81,-5336.28 13780.81,-5329.35"/>
</g>
<!-- ln1_2_2 -->
<g id="node661" class="node">
<title>ln1_2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14065.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14065.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14065.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14065.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_2 -->
<g id="edge799" class="edge">
<title>residual2_1&#45;&gt;ln1_2_2</title>
<path fill="none" stroke="black" d="M15785.03,-5421.23C15489.72,-5419.39 14827.9,-5408.19 14274.57,-5347.93 14247.34,-5344.96 14218.29,-5340.64 14190.78,-5335.99"/>
<polygon fill="black" stroke="black" points="14191.17,-5332.51 14180.73,-5334.27 14189.99,-5339.41 14191.17,-5332.51"/>
</g>
<!-- ln1_2_3 -->
<g id="node662" class="node">
<title>ln1_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14432.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14432.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14432.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14432.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_3 -->
<g id="edge800" class="edge">
<title>residual2_1&#45;&gt;ln1_2_3</title>
<path fill="none" stroke="black" d="M15785.27,-5419.85C15537.29,-5415.76 15036.97,-5401.02 14616.57,-5347.93 14595.79,-5345.3 14573.84,-5341.69 14552.62,-5337.76"/>
<polygon fill="black" stroke="black" points="14553.07,-5334.28 14542.6,-5335.87 14551.77,-5341.16 14553.07,-5334.28"/>
</g>
<!-- ln1_2_4 -->
<g id="node663" class="node">
<title>ln1_2_4</title>
<ellipse fill="lightgreen" stroke="black" cx="14774.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14774.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14774.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14774.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_4 -->
<g id="edge801" class="edge">
<title>residual2_1&#45;&gt;ln1_2_4</title>
<path fill="none" stroke="black" d="M15786.89,-5416.58C15590.81,-5408.91 15241.57,-5390.25 14945.57,-5347.93 14928.08,-5345.42 14909.7,-5342.17 14891.74,-5338.64"/>
<polygon fill="black" stroke="black" points="14892.3,-5335.19 14881.81,-5336.65 14890.93,-5342.05 14892.3,-5335.19"/>
</g>
<!-- ln1_2_5 -->
<g id="node664" class="node">
<title>ln1_2_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15103.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15103.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15103.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15103.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_5 -->
<g id="edge802" class="edge">
<title>residual2_1&#45;&gt;ln1_2_5</title>
<path fill="none" stroke="black" d="M15793.56,-5410.07C15656.79,-5398.39 15447.6,-5377.7 15267.57,-5347.93 15252.08,-5345.36 15235.86,-5342.27 15219.89,-5338.97"/>
<polygon fill="black" stroke="black" points="15220.49,-5335.52 15209.99,-5336.89 15219.06,-5342.37 15220.49,-5335.52"/>
</g>
<!-- ln1_2_6 -->
<g id="node665" class="node">
<title>ln1_2_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15425.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15425.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15425.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15425.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_6 -->
<g id="edge803" class="edge">
<title>residual2_1&#45;&gt;ln1_2_6</title>
<path fill="none" stroke="black" d="M15823.27,-5397.63C15754.28,-5383.49 15665.39,-5365.04 15586.57,-5347.93 15572.69,-5344.91 15558.15,-5341.7 15543.73,-5338.47"/>
<polygon fill="black" stroke="black" points="15544.29,-5335.01 15533.77,-5336.24 15542.76,-5341.84 15544.29,-5335.01"/>
</g>
<!-- ln1_2_7 -->
<g id="node666" class="node">
<title>ln1_2_7</title>
<ellipse fill="lightgreen" stroke="black" cx="15744.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15744.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15744.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15744.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_7 -->
<g id="edge804" class="edge">
<title>residual2_1&#45;&gt;ln1_2_7</title>
<path fill="none" stroke="black" d="M15880.43,-5387.67C15859.17,-5375.74 15835.1,-5362.23 15813.18,-5349.93"/>
<polygon fill="black" stroke="black" points="15814.69,-5346.77 15804.26,-5344.92 15811.27,-5352.87 15814.69,-5346.77"/>
</g>
<!-- ln1_2_8 -->
<g id="node667" class="node">
<title>ln1_2_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16137.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16137.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16137.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16137.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_8 -->
<g id="edge805" class="edge">
<title>residual2_1&#45;&gt;ln1_2_8</title>
<path fill="none" stroke="black" d="M16000.75,-5387.82C16022.23,-5375.83 16046.59,-5362.23 16068.75,-5349.86"/>
<polygon fill="black" stroke="black" points="16070.74,-5352.75 16077.77,-5344.82 16067.33,-5346.64 16070.74,-5352.75"/>
</g>
<!-- ln1_2_9 -->
<g id="node668" class="node">
<title>ln1_2_9</title>
<ellipse fill="lightgreen" stroke="black" cx="16492.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16492.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16492.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16492.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_9 -->
<g id="edge806" class="edge">
<title>residual2_1&#45;&gt;ln1_2_9</title>
<path fill="none" stroke="black" d="M16058.65,-5397.89C16149.56,-5379.78 16274.92,-5354.8 16367.53,-5336.34"/>
<polygon fill="black" stroke="black" points="16368.4,-5339.74 16377.52,-5334.35 16367.03,-5332.87 16368.4,-5339.74"/>
</g>
<!-- ln1_2_10 -->
<g id="node669" class="node">
<title>ln1_2_10</title>
<ellipse fill="lightgreen" stroke="black" cx="17187.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17187.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17187.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17187.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_10 -->
<g id="edge807" class="edge">
<title>residual2_1&#45;&gt;ln1_2_10</title>
<path fill="none" stroke="black" d="M16085.45,-5408.65C16323.82,-5387.62 16796.33,-5345.94 17037.84,-5324.63"/>
<polygon fill="black" stroke="black" points="17038.45,-5328.09 17048.1,-5323.73 17037.83,-5321.12 17038.45,-5328.09"/>
</g>
<!-- ln1_2_11 -->
<g id="node670" class="node">
<title>ln1_2_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17794.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17794.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17794.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17794.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_11 -->
<g id="edge808" class="edge">
<title>residual2_1&#45;&gt;ln1_2_11</title>
<path fill="none" stroke="black" d="M16092.95,-5414.9C16350.93,-5403.52 16890.13,-5378.34 17345.57,-5347.93 17445.51,-5341.25 17557.82,-5332.12 17645.12,-5324.66"/>
<polygon fill="black" stroke="black" points="17645.43,-5328.15 17655.1,-5323.81 17644.84,-5321.17 17645.43,-5328.15"/>
</g>
<!-- ln1_2_12 -->
<g id="node671" class="node">
<title>ln1_2_12</title>
<ellipse fill="lightgreen" stroke="black" cx="18649.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18649.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18649.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18649.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_12 -->
<g id="edge809" class="edge">
<title>residual2_1&#45;&gt;ln1_2_12</title>
<path fill="none" stroke="black" d="M16094.26,-5416.64C16431,-5405.97 17259.21,-5378.74 17952.57,-5347.93 18139.06,-5339.64 18353.5,-5328.11 18494.73,-5320.24"/>
<polygon fill="black" stroke="black" points="18494.98,-5323.73 18504.77,-5319.68 18494.59,-5316.74 18494.98,-5323.73"/>
</g>
<!-- ln1_2_13 -->
<g id="node672" class="node">
<title>ln1_2_13</title>
<ellipse fill="lightgreen" stroke="black" cx="19619.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="19619.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19619.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19619.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_13 -->
<g id="edge810" class="edge">
<title>residual2_1&#45;&gt;ln1_2_13</title>
<path fill="none" stroke="black" d="M16095.61,-5418.5C16526.03,-5410.16 17772.26,-5384.46 18807.57,-5347.93 19036.01,-5339.86 19300.46,-5327.39 19463.89,-5319.32"/>
<polygon fill="black" stroke="black" points="19464.21,-5322.8 19474.02,-5318.81 19463.86,-5315.81 19464.21,-5322.8"/>
</g>
<!-- ln1_2_14 -->
<g id="node673" class="node">
<title>ln1_2_14</title>
<ellipse fill="lightgreen" stroke="black" cx="20573.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="20573.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20573.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20573.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_14 -->
<g id="edge811" class="edge">
<title>residual2_1&#45;&gt;ln1_2_14</title>
<path fill="none" stroke="black" d="M16095.95,-5419.94C16616.63,-5414.62 18347.52,-5394.4 19777.57,-5347.93 20000.14,-5340.69 20257.52,-5328.12 20417.94,-5319.79"/>
<polygon fill="black" stroke="black" points="20418.56,-5323.26 20428.37,-5319.25 20418.2,-5316.27 20418.56,-5323.26"/>
</g>
<!-- ln1_2_15 -->
<g id="node674" class="node">
<title>ln1_2_15</title>
<ellipse fill="lightgreen" stroke="black" cx="21360.57" cy="-5310.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="21360.57" y="-5321.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21360.57" y="-5306.73" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21360.57" y="-5291.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_15 -->
<g id="edge812" class="edge">
<title>residual2_1&#45;&gt;ln1_2_15</title>
<path fill="none" stroke="black" d="M16096.25,-5421.45C16695.35,-5421.02 18909.45,-5414.74 20731.57,-5347.93 20894.28,-5341.96 21080.42,-5330.59 21207.74,-5322.12"/>
<polygon fill="black" stroke="black" points="21208.21,-5325.6 21217.95,-5321.44 21207.74,-5318.61 21208.21,-5325.6"/>
</g>
<!-- qkv_proj_2_0 -->
<g id="node675" class="node">
<title>qkv_proj_2_0</title>
<ellipse fill="orange" stroke="black" cx="10822.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10822.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10822.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10822.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="10822.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10822.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_0&#45;&gt;qkv_proj_2_0 -->
<g id="edge813" class="edge">
<title>ln1_2_0&#45;&gt;qkv_proj_2_0</title>
<path fill="none" stroke="black" d="M12979.7,-5301.17C12568.17,-5277.72 11394.85,-5210.85 10974.61,-5186.9"/>
<polygon fill="black" stroke="black" points="10974.71,-5183.4 10964.52,-5186.32 10974.31,-5190.39 10974.71,-5183.4"/>
</g>
<!-- qkv_proj_2_1 -->
<g id="node676" class="node">
<title>qkv_proj_2_1</title>
<ellipse fill="orange" stroke="black" cx="13076.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13076.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13076.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13076.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="13076.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13076.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_1&#45;&gt;qkv_proj_2_1 -->
<g id="edge814" class="edge">
<title>ln1_2_1&#45;&gt;qkv_proj_2_1</title>
<path fill="none" stroke="black" d="M13538.36,-5284.52C13445.24,-5263.09 13310.51,-5232.08 13210.59,-5209.08"/>
<polygon fill="black" stroke="black" points="13211.26,-5205.64 13200.73,-5206.81 13209.69,-5212.46 13211.26,-5205.64"/>
</g>
<!-- qkv_proj_2_2 -->
<g id="node677" class="node">
<title>qkv_proj_2_2</title>
<ellipse fill="orange" stroke="black" cx="13557.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13557.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13557.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13557.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="13557.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13557.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_2&#45;&gt;qkv_proj_2_2 -->
<g id="edge815" class="edge">
<title>ln1_2_2&#45;&gt;qkv_proj_2_2</title>
<path fill="none" stroke="black" d="M13963.38,-5283.03C13884.01,-5262.54 13773.4,-5233.97 13687.71,-5211.84"/>
<polygon fill="black" stroke="black" points="13688.47,-5208.42 13677.91,-5209.31 13686.72,-5215.2 13688.47,-5208.42"/>
</g>
<!-- qkv_proj_2_3 -->
<g id="node678" class="node">
<title>qkv_proj_2_3</title>
<ellipse fill="orange" stroke="black" cx="14100.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14100.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14100.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14100.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="14100.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14100.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_3&#45;&gt;qkv_proj_2_3 -->
<g id="edge816" class="edge">
<title>ln1_2_3&#45;&gt;qkv_proj_2_3</title>
<path fill="none" stroke="black" d="M14354.31,-5278.5C14311.99,-5261.78 14258.98,-5240.83 14212.38,-5222.41"/>
<polygon fill="black" stroke="black" points="14213.43,-5219.07 14202.84,-5218.65 14210.85,-5225.58 14213.43,-5219.07"/>
</g>
<!-- qkv_proj_2_4 -->
<g id="node679" class="node">
<title>qkv_proj_2_4</title>
<ellipse fill="orange" stroke="black" cx="14683.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14683.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14683.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14683.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="14683.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14683.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_4&#45;&gt;qkv_proj_2_4 -->
<g id="edge817" class="edge">
<title>ln1_2_4&#45;&gt;qkv_proj_2_4</title>
<path fill="none" stroke="black" d="M14749.47,-5273.23C14742.82,-5263.65 14735.45,-5253.03 14728.11,-5242.44"/>
<polygon fill="black" stroke="black" points="14730.82,-5240.21 14722.25,-5233.99 14725.07,-5244.2 14730.82,-5240.21"/>
</g>
<!-- qkv_proj_2_5 -->
<g id="node680" class="node">
<title>qkv_proj_2_5</title>
<ellipse fill="orange" stroke="black" cx="15030.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15030.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15030.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15030.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="15030.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15030.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_5&#45;&gt;qkv_proj_2_5 -->
<g id="edge818" class="edge">
<title>ln1_2_5&#45;&gt;qkv_proj_2_5</title>
<path fill="none" stroke="black" d="M15083.43,-5273.23C15078.34,-5264.08 15072.71,-5253.97 15067.09,-5243.85"/>
<polygon fill="black" stroke="black" points="15070.07,-5242.02 15062.15,-5234.99 15063.96,-5245.43 15070.07,-5242.02"/>
</g>
<!-- qkv_proj_2_6 -->
<g id="node681" class="node">
<title>qkv_proj_2_6</title>
<ellipse fill="orange" stroke="black" cx="15369.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15369.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15369.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15369.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="15369.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15369.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_6&#45;&gt;qkv_proj_2_6 -->
<g id="edge819" class="edge">
<title>ln1_2_6&#45;&gt;qkv_proj_2_6</title>
<path fill="none" stroke="black" d="M15409.97,-5272.88C15406.2,-5264.03 15402.04,-5254.3 15397.88,-5244.55"/>
<polygon fill="black" stroke="black" points="15401.04,-5243.04 15393.9,-5235.22 15394.6,-5245.79 15401.04,-5243.04"/>
</g>
<!-- qkv_proj_2_7 -->
<g id="node682" class="node">
<title>qkv_proj_2_7</title>
<ellipse fill="orange" stroke="black" cx="15721.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15721.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15721.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15721.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="15721.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15721.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_7&#45;&gt;qkv_proj_2_7 -->
<g id="edge820" class="edge">
<title>ln1_2_7&#45;&gt;qkv_proj_2_7</title>
<path fill="none" stroke="black" d="M15738.17,-5272.88C15736.7,-5264.53 15735.1,-5255.39 15733.49,-5246.19"/>
<polygon fill="black" stroke="black" points="15736.91,-5245.46 15731.74,-5236.22 15730.02,-5246.67 15736.91,-5245.46"/>
</g>
<!-- qkv_proj_2_8 -->
<g id="node683" class="node">
<title>qkv_proj_2_8</title>
<ellipse fill="orange" stroke="black" cx="16332.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16332.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16332.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16332.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="16332.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16332.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_8&#45;&gt;qkv_proj_2_8 -->
<g id="edge821" class="edge">
<title>ln1_2_8&#45;&gt;qkv_proj_2_8</title>
<path fill="none" stroke="black" d="M16188.55,-5275.13C16207.48,-5262.39 16229.46,-5247.6 16250.47,-5233.47"/>
<polygon fill="black" stroke="black" points="16252.43,-5236.37 16258.77,-5227.89 16248.52,-5230.56 16252.43,-5236.37"/>
</g>
<!-- qkv_proj_2_9 -->
<g id="node684" class="node">
<title>qkv_proj_2_9</title>
<ellipse fill="orange" stroke="black" cx="16838.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16838.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16838.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16838.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="16838.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16838.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_9&#45;&gt;qkv_proj_2_9 -->
<g id="edge822" class="edge">
<title>ln1_2_9&#45;&gt;qkv_proj_2_9</title>
<path fill="none" stroke="black" d="M16573.26,-5278.83C16618.38,-5261.73 16675.34,-5240.13 16724.91,-5221.33"/>
<polygon fill="black" stroke="black" points="16726.29,-5224.55 16734.4,-5217.74 16723.8,-5218.01 16726.29,-5224.55"/>
</g>
<!-- qkv_proj_2_10 -->
<g id="node685" class="node">
<title>qkv_proj_2_10</title>
<ellipse fill="orange" stroke="black" cx="17568.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17568.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17568.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17568.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="17568.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17568.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_10&#45;&gt;qkv_proj_2_10 -->
<g id="edge823" class="edge">
<title>ln1_2_10&#45;&gt;qkv_proj_2_10</title>
<path fill="none" stroke="black" d="M17274.03,-5279.66C17326.12,-5261.72 17393.19,-5238.63 17450.17,-5219.01"/>
<polygon fill="black" stroke="black" points="17451.63,-5222.2 17459.95,-5215.64 17449.35,-5215.58 17451.63,-5222.2"/>
</g>
<!-- qkv_proj_2_11 -->
<g id="node686" class="node">
<title>qkv_proj_2_11</title>
<ellipse fill="orange" stroke="black" cx="18086.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18086.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18086.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18086.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="18086.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18086.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_11&#45;&gt;qkv_proj_2_11 -->
<g id="edge824" class="edge">
<title>ln1_2_11&#45;&gt;qkv_proj_2_11</title>
<path fill="none" stroke="black" d="M17866,-5277.33C17900.86,-5261.67 17943.47,-5242.53 17981.91,-5225.26"/>
<polygon fill="black" stroke="black" points="17983.38,-5228.43 17991.07,-5221.14 17980.51,-5222.05 17983.38,-5228.43"/>
</g>
<!-- qkv_proj_2_12 -->
<g id="node687" class="node">
<title>qkv_proj_2_12</title>
<ellipse fill="orange" stroke="black" cx="19189.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="19189.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19189.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19189.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="19189.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19189.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_12&#45;&gt;qkv_proj_2_12 -->
<g id="edge825" class="edge">
<title>ln1_2_12&#45;&gt;qkv_proj_2_12</title>
<path fill="none" stroke="black" d="M18754.97,-5283.82C18841.39,-5262.83 18964.17,-5232.99 19057.2,-5210.39"/>
<polygon fill="black" stroke="black" points="19058.08,-5213.78 19066.97,-5208.02 19056.42,-5206.98 19058.08,-5213.78"/>
</g>
<!-- qkv_proj_2_13 -->
<g id="node688" class="node">
<title>qkv_proj_2_13</title>
<ellipse fill="orange" stroke="black" cx="20275.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20275.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20275.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20275.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="20275.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20275.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_13&#45;&gt;qkv_proj_2_13 -->
<g id="edge826" class="edge">
<title>ln1_2_13&#45;&gt;qkv_proj_2_13</title>
<path fill="none" stroke="black" d="M19734.59,-5286.42C19846.91,-5263.96 20017.92,-5229.76 20137.52,-5205.84"/>
<polygon fill="black" stroke="black" points="20138.37,-5209.24 20147.49,-5203.85 20136.99,-5202.38 20138.37,-5209.24"/>
</g>
<!-- qkv_proj_2_14 -->
<g id="node689" class="node">
<title>qkv_proj_2_14</title>
<ellipse fill="orange" stroke="black" cx="21212.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="21212.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="21212.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21212.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="21212.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="21212.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_14&#45;&gt;qkv_proj_2_14 -->
<g id="edge827" class="edge">
<title>ln1_2_14&#45;&gt;qkv_proj_2_14</title>
<path fill="none" stroke="black" d="M20687.45,-5286.05C20795.96,-5263.77 20959.51,-5230.19 21075.21,-5206.44"/>
<polygon fill="black" stroke="black" points="21076.11,-5209.83 21085.2,-5204.39 21074.7,-5202.97 21076.11,-5209.83"/>
</g>
<!-- qkv_proj_2_15 -->
<g id="node690" class="node">
<title>qkv_proj_2_15</title>
<ellipse fill="orange" stroke="black" cx="21833.57" cy="-5177.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="21833.57" y="-5203.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="21833.57" y="-5188.54" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21833.57" y="-5173.54" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="21833.57" y="-5158.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="21833.57" y="-5143.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_15&#45;&gt;qkv_proj_2_15 -->
<g id="edge828" class="edge">
<title>ln1_2_15&#45;&gt;qkv_proj_2_15</title>
<path fill="none" stroke="black" d="M21458.87,-5282.16C21530.51,-5262.29 21628.22,-5235.19 21705.89,-5213.65"/>
<polygon fill="black" stroke="black" points="21707.05,-5216.96 21715.75,-5210.92 21705.18,-5210.22 21707.05,-5216.96"/>
</g>
<!-- reshape_qkv_2_0 -->
<g id="node691" class="node">
<title>reshape_qkv_2_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9103.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9103.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9103.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9103.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_0&#45;&gt;reshape_qkv_2_0 -->
<g id="edge829" class="edge">
<title>qkv_proj_2_0&#45;&gt;reshape_qkv_2_0</title>
<path fill="none" stroke="black" d="M10681.9,-5165.5C10364.65,-5141.29 9595.21,-5082.57 9261.9,-5057.13"/>
<polygon fill="black" stroke="black" points="9261.91,-5053.62 9251.68,-5056.35 9261.38,-5060.6 9261.91,-5053.62"/>
</g>
<!-- reshape_qkv_2_1 -->
<g id="node704" class="node">
<title>reshape_qkv_2_1</title>
<ellipse fill="lightcyan" stroke="black" cx="10022.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10022.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10022.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10022.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_1&#45;&gt;reshape_qkv_2_1 -->
<g id="edge844" class="edge">
<title>qkv_proj_2_1&#45;&gt;reshape_qkv_2_1</title>
<path fill="none" stroke="black" d="M12933.96,-5170.41C12578.02,-5155.83 11621.85,-5116.45 10824.57,-5081.55 10603.28,-5071.86 10347.66,-5060.13 10185.62,-5052.63"/>
<polygon fill="black" stroke="black" points="10185.72,-5049.13 10175.57,-5052.17 10185.4,-5056.12 10185.72,-5049.13"/>
</g>
<!-- reshape_qkv_2_2 -->
<g id="node716" class="node">
<title>reshape_qkv_2_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10990.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10990.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10990.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10990.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_2&#45;&gt;reshape_qkv_2_2 -->
<g id="edge859" class="edge">
<title>qkv_proj_2_2&#45;&gt;reshape_qkv_2_2</title>
<path fill="none" stroke="black" d="M13430.85,-5149.38C13370.23,-5137.71 13296.46,-5125.2 13229.57,-5118.55 12557.58,-5051.65 12385.41,-5106.87 11710.57,-5081.55 11518.66,-5074.34 11298.14,-5062.66 11152.25,-5054.46"/>
<polygon fill="black" stroke="black" points="11152.06,-5050.94 11141.88,-5053.87 11151.66,-5057.93 11152.06,-5050.94"/>
</g>
<!-- reshape_qkv_2_3 -->
<g id="node728" class="node">
<title>reshape_qkv_2_3</title>
<ellipse fill="lightcyan" stroke="black" cx="11876.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11876.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11876.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11876.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_3&#45;&gt;reshape_qkv_2_3 -->
<g id="edge874" class="edge">
<title>qkv_proj_2_3&#45;&gt;reshape_qkv_2_3</title>
<path fill="none" stroke="black" d="M13969.23,-5153.13C13893.79,-5140.78 13797.13,-5126.52 13710.57,-5118.55 13266.37,-5077.62 13153.29,-5099.55 12707.57,-5081.55 12475.67,-5072.18 12207.42,-5060.18 12039.86,-5052.56"/>
<polygon fill="black" stroke="black" points="12039.87,-5049.05 12029.72,-5052.09 12039.55,-5056.05 12039.87,-5049.05"/>
</g>
<!-- reshape_qkv_2_4 -->
<g id="node741" class="node">
<title>reshape_qkv_2_4</title>
<ellipse fill="lightcyan" stroke="black" cx="12873.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12873.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12873.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12873.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_4&#45;&gt;reshape_qkv_2_4 -->
<g id="edge890" class="edge">
<title>qkv_proj_2_4&#45;&gt;reshape_qkv_2_4</title>
<path fill="none" stroke="black" d="M14549.76,-5155.47C14465.06,-5143.03 14353.13,-5127.86 14253.57,-5118.55 14238.57,-5117.14 13396.98,-5072.66 13035.59,-5053.59"/>
<polygon fill="black" stroke="black" points="13035.74,-5050.09 13025.57,-5053.06 13035.37,-5057.08 13035.74,-5050.09"/>
</g>
<!-- reshape_qkv_2_5 -->
<g id="node754" class="node">
<title>reshape_qkv_2_5</title>
<ellipse fill="lightcyan" stroke="black" cx="13730.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13730.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13730.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13730.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_5&#45;&gt;reshape_qkv_2_5 -->
<g id="edge905" class="edge">
<title>qkv_proj_2_5&#45;&gt;reshape_qkv_2_5</title>
<path fill="none" stroke="black" d="M14921.31,-5139.12C14893.93,-5131.11 14864.41,-5123.55 14836.57,-5118.55 14660.56,-5086.93 14157.15,-5062.48 13894.51,-5051.46"/>
<polygon fill="black" stroke="black" points="13894.64,-5047.96 13884.5,-5051.04 13894.35,-5054.95 13894.64,-5047.96"/>
</g>
<!-- reshape_qkv_2_6 -->
<g id="node766" class="node">
<title>reshape_qkv_2_6</title>
<ellipse fill="lightcyan" stroke="black" cx="14657.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14657.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14657.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14657.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_6&#45;&gt;reshape_qkv_2_6 -->
<g id="edge920" class="edge">
<title>qkv_proj_2_6&#45;&gt;reshape_qkv_2_6</title>
<path fill="none" stroke="black" d="M15260.21,-5139.09C15235.23,-5131.51 15208.65,-5124.15 15183.57,-5118.55 15059.78,-5090.89 14917.15,-5071.73 14811.67,-5059.93"/>
<polygon fill="black" stroke="black" points="14811.9,-5056.43 14801.58,-5058.81 14811.13,-5063.39 14811.9,-5056.43"/>
</g>
<!-- reshape_qkv_2_7 -->
<g id="node778" class="node">
<title>reshape_qkv_2_7</title>
<ellipse fill="lightcyan" stroke="black" cx="15673.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15673.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15673.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15673.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_7&#45;&gt;reshape_qkv_2_7 -->
<g id="edge935" class="edge">
<title>qkv_proj_2_7&#45;&gt;reshape_qkv_2_7</title>
<path fill="none" stroke="black" d="M15700.66,-5119.08C15697.25,-5109.74 15693.75,-5100.18 15690.45,-5091.16"/>
<polygon fill="black" stroke="black" points="15693.68,-5089.81 15686.96,-5081.62 15687.11,-5092.22 15693.68,-5089.81"/>
</g>
<!-- reshape_qkv_2_8 -->
<g id="node791" class="node">
<title>reshape_qkv_2_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16353.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16353.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16353.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16353.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_8&#45;&gt;reshape_qkv_2_8 -->
<g id="edge951" class="edge">
<title>qkv_proj_2_8&#45;&gt;reshape_qkv_2_8</title>
<path fill="none" stroke="black" d="M16341.85,-5118.31C16343.28,-5109.33 16344.75,-5100.16 16346.14,-5091.48"/>
<polygon fill="black" stroke="black" points="16349.61,-5091.98 16347.73,-5081.55 16342.69,-5090.87 16349.61,-5091.98"/>
</g>
<!-- reshape_qkv_2_9 -->
<g id="node804" class="node">
<title>reshape_qkv_2_9</title>
<ellipse fill="lightcyan" stroke="black" cx="17199.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17199.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17199.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17199.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_9&#45;&gt;reshape_qkv_2_9 -->
<g id="edge966" class="edge">
<title>qkv_proj_2_9&#45;&gt;reshape_qkv_2_9</title>
<path fill="none" stroke="black" d="M16944.93,-5137.58C16995.82,-5119.09 17056.23,-5097.14 17105.43,-5079.26"/>
<polygon fill="black" stroke="black" points="17106.92,-5082.44 17115.12,-5075.74 17104.53,-5075.86 17106.92,-5082.44"/>
</g>
<!-- reshape_qkv_2_10 -->
<g id="node816" class="node">
<title>reshape_qkv_2_10</title>
<ellipse fill="lightcyan" stroke="black" cx="18056.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18056.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18056.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18056.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_10&#45;&gt;reshape_qkv_2_10 -->
<g id="edge981" class="edge">
<title>qkv_proj_2_10&#45;&gt;reshape_qkv_2_10</title>
<path fill="none" stroke="black" d="M17687.64,-5144.23C17765.97,-5123.17 17867.83,-5095.79 17944.67,-5075.13"/>
<polygon fill="black" stroke="black" points="17945.64,-5078.49 17954.39,-5072.52 17943.82,-5071.73 17945.64,-5078.49"/>
</g>
<!-- reshape_qkv_2_11 -->
<g id="node828" class="node">
<title>reshape_qkv_2_11</title>
<ellipse fill="lightcyan" stroke="black" cx="19054.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19054.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19054.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19054.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_11&#45;&gt;reshape_qkv_2_11 -->
<g id="edge996" class="edge">
<title>qkv_proj_2_11&#45;&gt;reshape_qkv_2_11</title>
<path fill="none" stroke="black" d="M18222.19,-5157.86C18403.57,-5133.27 18723.81,-5089.87 18909.75,-5064.67"/>
<polygon fill="black" stroke="black" points="18910.44,-5068.11 18919.88,-5063.3 18909.5,-5061.18 18910.44,-5068.11"/>
</g>
<!-- reshape_qkv_2_12 -->
<g id="node841" class="node">
<title>reshape_qkv_2_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19910.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19910.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19910.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19910.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_12&#45;&gt;reshape_qkv_2_12 -->
<g id="edge1012" class="edge">
<title>qkv_proj_2_12&#45;&gt;reshape_qkv_2_12</title>
<path fill="none" stroke="black" d="M19320.14,-5152.48C19449.77,-5128.89 19647.46,-5092.92 19777.84,-5069.2"/>
<polygon fill="black" stroke="black" points="19778.68,-5072.6 19787.89,-5067.37 19777.43,-5065.71 19778.68,-5072.6"/>
</g>
<!-- reshape_qkv_2_13 -->
<g id="node854" class="node">
<title>reshape_qkv_2_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20908.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20908.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20908.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20908.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_13&#45;&gt;reshape_qkv_2_13 -->
<g id="edge1027" class="edge">
<title>qkv_proj_2_13&#45;&gt;reshape_qkv_2_13</title>
<path fill="none" stroke="black" d="M20402.91,-5149.84C20513.3,-5126.97 20672.19,-5094.04 20782.28,-5071.22"/>
<polygon fill="black" stroke="black" points="20783.03,-5074.64 20792.11,-5069.18 20781.6,-5067.79 20783.03,-5074.64"/>
</g>
<!-- reshape_qkv_2_14 -->
<g id="node866" class="node">
<title>reshape_qkv_2_14</title>
<ellipse fill="lightcyan" stroke="black" cx="21835.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21835.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21835.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21835.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_14&#45;&gt;reshape_qkv_2_14 -->
<g id="edge1042" class="edge">
<title>qkv_proj_2_14&#45;&gt;reshape_qkv_2_14</title>
<path fill="none" stroke="black" d="M21339.4,-5149.53C21447.56,-5126.75 21602.2,-5094.19 21710,-5071.49"/>
<polygon fill="black" stroke="black" points="21710.89,-5074.88 21719.96,-5069.39 21709.45,-5068.03 21710.89,-5074.88"/>
</g>
<!-- reshape_qkv_2_15 -->
<g id="node878" class="node">
<title>reshape_qkv_2_15</title>
<ellipse fill="lightcyan" stroke="black" cx="22761.57" cy="-5044.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="22761.57" y="-5055.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="22761.57" y="-5040.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22761.57" y="-5025.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_15&#45;&gt;reshape_qkv_2_15 -->
<g id="edge1057" class="edge">
<title>qkv_proj_2_15&#45;&gt;reshape_qkv_2_15</title>
<path fill="none" stroke="black" d="M21968.51,-5157.16C22141.81,-5132.66 22441.27,-5090.33 22618.44,-5065.28"/>
<polygon fill="black" stroke="black" points="22618.94,-5068.74 22628.35,-5063.88 22617.96,-5061.81 22618.94,-5068.74"/>
</g>
<!-- split_q_2_0 -->
<g id="node692" class="node">
<title>split_q_2_0</title>
<ellipse fill="pink" stroke="black" cx="8702.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8702.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8702.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8702.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_q_2_0 -->
<g id="edge830" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_q_2_0</title>
<path fill="none" stroke="black" d="M9002.64,-5015.36C8943.96,-4999.26 8870.03,-4978.98 8810.24,-4962.58"/>
<polygon fill="black" stroke="black" points="8810.96,-4959.15 8800.39,-4959.88 8809.11,-4965.9 8810.96,-4959.15"/>
</g>
<!-- split_k_2_0 -->
<g id="node693" class="node">
<title>split_k_2_0</title>
<ellipse fill="pink" stroke="black" cx="9011.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9011.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9011.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9011.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_k_2_0 -->
<g id="edge831" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_k_2_0</title>
<path fill="none" stroke="black" d="M9073.45,-5007.03C9065.34,-4997.34 9056.49,-4986.75 9048.08,-4976.69"/>
<polygon fill="black" stroke="black" points="9050.55,-4974.19 9041.45,-4968.77 9045.18,-4978.68 9050.55,-4974.19"/>
</g>
<!-- split_v_2_0 -->
<g id="node694" class="node">
<title>split_v_2_0</title>
<ellipse fill="pink" stroke="black" cx="9320.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9320.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9320.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9320.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_v_2_0 -->
<g id="edge832" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_v_2_0</title>
<path fill="none" stroke="black" d="M9168.97,-5009.89C9193.54,-4997.44 9221.62,-4983.21 9246.88,-4970.4"/>
<polygon fill="black" stroke="black" points="9248.72,-4973.39 9256.05,-4965.75 9245.55,-4967.15 9248.72,-4973.39"/>
</g>
<!-- transpose_q_2_0 -->
<g id="node695" class="node">
<title>transpose_q_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="8702.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8702.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8702.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8702.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_0&#45;&gt;transpose_q_2_0 -->
<g id="edge833" class="edge">
<title>split_q_2_0&#45;&gt;transpose_q_2_0</title>
<path fill="none" stroke="black" d="M8702.57,-4894.42C8702.57,-4885.97 8702.57,-4876.87 8702.57,-4868.06"/>
<polygon fill="black" stroke="black" points="8706.07,-4867.89 8702.57,-4857.89 8699.07,-4867.89 8706.07,-4867.89"/>
</g>
<!-- transpose_k_2_0 -->
<g id="node696" class="node">
<title>transpose_k_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="9011.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9011.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9011.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9011.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_0&#45;&gt;transpose_k_2_0 -->
<g id="edge834" class="edge">
<title>split_k_2_0&#45;&gt;transpose_k_2_0</title>
<path fill="none" stroke="black" d="M9011.57,-4894.42C9011.57,-4885.97 9011.57,-4876.87 9011.57,-4868.06"/>
<polygon fill="black" stroke="black" points="9015.07,-4867.89 9011.57,-4857.89 9008.07,-4867.89 9015.07,-4867.89"/>
</g>
<!-- transpose_v_2_0 -->
<g id="node697" class="node">
<title>transpose_v_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="9320.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9320.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9320.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9320.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_0&#45;&gt;transpose_v_2_0 -->
<g id="edge835" class="edge">
<title>split_v_2_0&#45;&gt;transpose_v_2_0</title>
<path fill="none" stroke="black" d="M9320.57,-4894.42C9320.57,-4885.97 9320.57,-4876.87 9320.57,-4868.06"/>
<polygon fill="black" stroke="black" points="9324.07,-4867.89 9320.57,-4857.89 9317.07,-4867.89 9324.07,-4867.89"/>
</g>
<!-- attn_scores_2_0 -->
<g id="node698" class="node">
<title>attn_scores_2_0</title>
<ellipse fill="gold" stroke="black" cx="9011.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9011.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9011.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9011.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_0&#45;&gt;attn_scores_2_0 -->
<g id="edge836" class="edge">
<title>transpose_q_2_0&#45;&gt;attn_scores_2_0</title>
<path fill="none" stroke="black" d="M8786.19,-4789.28C8825.91,-4775.14 8873.6,-4758.16 8914.86,-4743.47"/>
<polygon fill="black" stroke="black" points="8916.13,-4746.74 8924.38,-4740.08 8913.79,-4740.14 8916.13,-4746.74"/>
</g>
<!-- transpose_k_2_0&#45;&gt;attn_scores_2_0 -->
<g id="edge837" class="edge">
<title>transpose_k_2_0&#45;&gt;attn_scores_2_0</title>
<path fill="none" stroke="black" d="M9011.57,-4782.42C9011.57,-4773.97 9011.57,-4764.87 9011.57,-4756.06"/>
<polygon fill="black" stroke="black" points="9015.07,-4755.89 9011.57,-4745.89 9008.07,-4755.89 9015.07,-4755.89"/>
</g>
<!-- attn_output_2_0 -->
<g id="node699" class="node">
<title>attn_output_2_0</title>
<ellipse fill="gold" stroke="black" cx="9320.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9320.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9320.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9320.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_0&#45;&gt;attn_output_2_0 -->
<g id="edge838" class="edge">
<title>transpose_v_2_0&#45;&gt;attn_output_2_0</title>
<path fill="none" stroke="black" d="M9320.57,-4782.35C9320.57,-4721.3 9320.57,-4598.99 9320.57,-4531.84"/>
<polygon fill="black" stroke="black" points="9324.07,-4531.55 9320.57,-4521.55 9317.07,-4531.55 9324.07,-4531.55"/>
</g>
<!-- softmax_2_0 -->
<g id="node700" class="node">
<title>softmax_2_0</title>
<ellipse fill="gold" stroke="black" cx="9097.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9097.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9097.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9097.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_0&#45;&gt;softmax_2_0 -->
<g id="edge839" class="edge">
<title>attn_scores_2_0&#45;&gt;softmax_2_0</title>
<path fill="none" stroke="black" d="M9039.73,-4671.03C9047.16,-4661.53 9055.25,-4651.17 9062.98,-4641.3"/>
<polygon fill="black" stroke="black" points="9065.95,-4643.18 9069.35,-4633.14 9060.43,-4638.87 9065.95,-4643.18"/>
</g>
<!-- transpose_back_2_0 -->
<g id="node701" class="node">
<title>transpose_back_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="10247.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10247.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10247.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10247.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_0&#45;&gt;transpose_back_2_0 -->
<g id="edge841" class="edge">
<title>attn_output_2_0&#45;&gt;transpose_back_2_0</title>
<path fill="none" stroke="black" d="M9451.42,-4467.52C9624.57,-4446.97 9928.63,-4410.89 10106.68,-4389.76"/>
<polygon fill="black" stroke="black" points="10107.12,-4393.24 10116.64,-4388.58 10106.3,-4386.28 10107.12,-4393.24"/>
</g>
<!-- softmax_2_0&#45;&gt;attn_output_2_0 -->
<g id="edge840" class="edge">
<title>softmax_2_0&#45;&gt;attn_output_2_0</title>
<path fill="none" stroke="black" d="M9165.09,-4561.74C9190.43,-4549.24 9219.38,-4534.96 9245.38,-4522.14"/>
<polygon fill="black" stroke="black" points="9247.02,-4525.23 9254.44,-4517.67 9243.92,-4518.95 9247.02,-4525.23"/>
</g>
<!-- reshape_concat_2_0 -->
<g id="node702" class="node">
<title>reshape_concat_2_0</title>
<ellipse fill="lightcyan" stroke="black" cx="10446.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10446.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10446.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10446.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_0&#45;&gt;reshape_concat_2_0 -->
<g id="edge842" class="edge">
<title>transpose_back_2_0&#45;&gt;reshape_concat_2_0</title>
<path fill="none" stroke="black" d="M10307.82,-4337.74C10330.14,-4325.41 10355.6,-4311.33 10378.56,-4298.64"/>
<polygon fill="black" stroke="black" points="10380.5,-4301.57 10387.56,-4293.67 10377.11,-4295.44 10380.5,-4301.57"/>
</g>
<!-- allgather_dim_2_0 -->
<g id="node703" class="node">
<title>allgather_dim_2_0</title>
<polygon fill="red" stroke="black" points="11116.57,-4185.55 10943.57,-4132.55 11116.57,-4079.55 11289.57,-4132.55 11116.57,-4185.55"/>
<text text-anchor="middle" x="11116.57" y="-4143.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="11116.57" y="-4128.85" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="11116.57" y="-4113.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_0&#45;&gt;allgather_dim_2_0 -->
<g id="edge843" class="edge">
<title>reshape_concat_2_0&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M10555.71,-4238.6C10678.19,-4215.66 10876.06,-4178.6 11001.08,-4155.18"/>
<polygon fill="black" stroke="black" points="11001.89,-4158.59 11011.07,-4153.31 11000.6,-4151.71 11001.89,-4158.59"/>
</g>
<!-- head_group_2_0 -->
<g id="node740" class="node">
<title>head_group_2_0</title>
<polygon fill="lightyellow" stroke="black" points="13773.07,-4042.55 13576.07,-4042.55 13576.07,-4004.55 13773.07,-4004.55 13773.07,-4042.55"/>
<text text-anchor="middle" x="13674.57" y="-4027.35" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13674.57" y="-4012.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_0&#45;&gt;head_group_2_0 -->
<g id="edge889" class="edge">
<title>allgather_dim_2_0&#45;&gt;head_group_2_0</title>
<path fill="none" stroke="black" d="M11266.1,-4125.29C11733.46,-4105.74 13159.78,-4046.08 13565.73,-4029.1"/>
<polygon fill="black" stroke="black" points="13566.15,-4032.58 13575.99,-4028.67 13565.86,-4025.59 13566.15,-4032.58"/>
</g>
<!-- split_q_2_1 -->
<g id="node705" class="node">
<title>split_q_2_1</title>
<ellipse fill="pink" stroke="black" cx="9629.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9629.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9629.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9629.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_q_2_1 -->
<g id="edge845" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_q_2_1</title>
<path fill="none" stroke="black" d="M9922.64,-5015.07C9865.67,-4999.13 9794.29,-4979.15 9736.24,-4962.9"/>
<polygon fill="black" stroke="black" points="9736.88,-4959.45 9726.31,-4960.12 9734.99,-4966.19 9736.88,-4959.45"/>
</g>
<!-- split_k_2_1 -->
<g id="node706" class="node">
<title>split_k_2_1</title>
<ellipse fill="pink" stroke="black" cx="9938.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9938.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9938.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9938.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_k_2_1 -->
<g id="edge846" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_k_2_1</title>
<path fill="none" stroke="black" d="M9995.07,-5007.03C9987.82,-4997.53 9979.91,-4987.17 9972.37,-4977.3"/>
<polygon fill="black" stroke="black" points="9974.99,-4974.97 9966.14,-4969.14 9969.43,-4979.22 9974.99,-4974.97"/>
</g>
<!-- split_v_2_1 -->
<g id="node707" class="node">
<title>split_v_2_1</title>
<ellipse fill="pink" stroke="black" cx="10247.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10247.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10247.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10247.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_v_2_1 -->
<g id="edge847" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_v_2_1</title>
<path fill="none" stroke="black" d="M10090.08,-5010.04C10115.9,-4997.42 10145.51,-4982.94 10172.03,-4969.98"/>
<polygon fill="black" stroke="black" points="10173.83,-4972.99 10181.28,-4965.46 10170.75,-4966.71 10173.83,-4972.99"/>
</g>
<!-- transpose_q_2_1 -->
<g id="node708" class="node">
<title>transpose_q_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="9629.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9629.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9629.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9629.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_1&#45;&gt;transpose_q_2_1 -->
<g id="edge848" class="edge">
<title>split_q_2_1&#45;&gt;transpose_q_2_1</title>
<path fill="none" stroke="black" d="M9629.57,-4894.42C9629.57,-4885.97 9629.57,-4876.87 9629.57,-4868.06"/>
<polygon fill="black" stroke="black" points="9633.07,-4867.89 9629.57,-4857.89 9626.07,-4867.89 9633.07,-4867.89"/>
</g>
<!-- transpose_k_2_1 -->
<g id="node709" class="node">
<title>transpose_k_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="9938.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9938.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9938.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9938.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_1&#45;&gt;transpose_k_2_1 -->
<g id="edge849" class="edge">
<title>split_k_2_1&#45;&gt;transpose_k_2_1</title>
<path fill="none" stroke="black" d="M9938.57,-4894.42C9938.57,-4885.97 9938.57,-4876.87 9938.57,-4868.06"/>
<polygon fill="black" stroke="black" points="9942.07,-4867.89 9938.57,-4857.89 9935.07,-4867.89 9942.07,-4867.89"/>
</g>
<!-- transpose_v_2_1 -->
<g id="node710" class="node">
<title>transpose_v_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="10247.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10247.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10247.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10247.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_1&#45;&gt;transpose_v_2_1 -->
<g id="edge850" class="edge">
<title>split_v_2_1&#45;&gt;transpose_v_2_1</title>
<path fill="none" stroke="black" d="M10247.57,-4894.42C10247.57,-4885.97 10247.57,-4876.87 10247.57,-4868.06"/>
<polygon fill="black" stroke="black" points="10251.07,-4867.89 10247.57,-4857.89 10244.07,-4867.89 10251.07,-4867.89"/>
</g>
<!-- attn_scores_2_1 -->
<g id="node711" class="node">
<title>attn_scores_2_1</title>
<ellipse fill="gold" stroke="black" cx="9938.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9938.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9938.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9938.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_1&#45;&gt;attn_scores_2_1 -->
<g id="edge851" class="edge">
<title>transpose_q_2_1&#45;&gt;attn_scores_2_1</title>
<path fill="none" stroke="black" d="M9713.19,-4789.28C9752.91,-4775.14 9800.6,-4758.16 9841.86,-4743.47"/>
<polygon fill="black" stroke="black" points="9843.13,-4746.74 9851.38,-4740.08 9840.79,-4740.14 9843.13,-4746.74"/>
</g>
<!-- transpose_k_2_1&#45;&gt;attn_scores_2_1 -->
<g id="edge852" class="edge">
<title>transpose_k_2_1&#45;&gt;attn_scores_2_1</title>
<path fill="none" stroke="black" d="M9938.57,-4782.42C9938.57,-4773.97 9938.57,-4764.87 9938.57,-4756.06"/>
<polygon fill="black" stroke="black" points="9942.07,-4755.89 9938.57,-4745.89 9935.07,-4755.89 9942.07,-4755.89"/>
</g>
<!-- attn_output_2_1 -->
<g id="node712" class="node">
<title>attn_output_2_1</title>
<ellipse fill="gold" stroke="black" cx="10247.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10247.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10247.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10247.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_1&#45;&gt;attn_output_2_1 -->
<g id="edge853" class="edge">
<title>transpose_v_2_1&#45;&gt;attn_output_2_1</title>
<path fill="none" stroke="black" d="M10247.57,-4782.35C10247.57,-4721.3 10247.57,-4598.99 10247.57,-4531.84"/>
<polygon fill="black" stroke="black" points="10251.07,-4531.55 10247.57,-4521.55 10244.07,-4531.55 10251.07,-4531.55"/>
</g>
<!-- softmax_2_1 -->
<g id="node713" class="node">
<title>softmax_2_1</title>
<ellipse fill="gold" stroke="black" cx="9995.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9995.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9995.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9995.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_1&#45;&gt;softmax_2_1 -->
<g id="edge854" class="edge">
<title>attn_scores_2_1&#45;&gt;softmax_2_1</title>
<path fill="none" stroke="black" d="M9957.4,-4670.72C9962.11,-4661.62 9967.23,-4651.74 9972.15,-4642.26"/>
<polygon fill="black" stroke="black" points="9975.28,-4643.82 9976.77,-4633.33 9969.06,-4640.6 9975.28,-4643.82"/>
</g>
<!-- transpose_back_2_1 -->
<g id="node714" class="node">
<title>transpose_back_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="10653.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10653.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10653.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10653.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_1&#45;&gt;transpose_back_2_1 -->
<g id="edge856" class="edge">
<title>attn_output_2_1&#45;&gt;transpose_back_2_1</title>
<path fill="none" stroke="black" d="M10346.11,-4456.35C10406.27,-4440.05 10483.24,-4419.2 10545.12,-4402.43"/>
<polygon fill="black" stroke="black" points="10546.18,-4405.77 10554.91,-4399.78 10544.35,-4399.01 10546.18,-4405.77"/>
</g>
<!-- softmax_2_1&#45;&gt;attn_output_2_1 -->
<g id="edge855" class="edge">
<title>softmax_2_1&#45;&gt;attn_output_2_1</title>
<path fill="none" stroke="black" d="M10070.16,-4562.49C10100.15,-4549.4 10134.83,-4534.26 10165.52,-4520.86"/>
<polygon fill="black" stroke="black" points="10167.15,-4523.97 10174.91,-4516.76 10164.35,-4517.55 10167.15,-4523.97"/>
</g>
<!-- reshape_concat_2_1 -->
<g id="node715" class="node">
<title>reshape_concat_2_1</title>
<ellipse fill="lightcyan" stroke="black" cx="10820.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10820.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10820.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10820.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_1&#45;&gt;reshape_concat_2_1 -->
<g id="edge857" class="edge">
<title>transpose_back_2_1&#45;&gt;reshape_concat_2_1</title>
<path fill="none" stroke="black" d="M10705.5,-4336.84C10722.94,-4325.35 10742.54,-4312.44 10760.56,-4300.58"/>
<polygon fill="black" stroke="black" points="10762.83,-4303.27 10769.25,-4294.85 10758.98,-4297.43 10762.83,-4303.27"/>
</g>
<!-- reshape_concat_2_1&#45;&gt;allgather_dim_2_0 -->
<g id="edge858" class="edge">
<title>reshape_concat_2_1&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M10892.6,-4228.51C10935.9,-4210.15 10991.1,-4186.75 11035.86,-4167.77"/>
<polygon fill="black" stroke="black" points="11037.4,-4170.91 11045.25,-4163.79 11034.67,-4164.47 11037.4,-4170.91"/>
</g>
<!-- split_q_2_2 -->
<g id="node717" class="node">
<title>split_q_2_2</title>
<ellipse fill="pink" stroke="black" cx="10556.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10556.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10556.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10556.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_q_2_2 -->
<g id="edge860" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_q_2_2</title>
<path fill="none" stroke="black" d="M10884.96,-5016.28C10819.31,-4999.64 10735.01,-4978.27 10668.26,-4961.35"/>
<polygon fill="black" stroke="black" points="10669.09,-4957.95 10658.54,-4958.89 10667.37,-4964.74 10669.09,-4957.95"/>
</g>
<!-- split_k_2_2 -->
<g id="node718" class="node">
<title>split_k_2_2</title>
<ellipse fill="pink" stroke="black" cx="10865.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10865.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10865.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10865.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_k_2_2 -->
<g id="edge861" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_k_2_2</title>
<path fill="none" stroke="black" d="M10950.33,-5007.64C10938.63,-4997.33 10925.72,-4985.97 10913.58,-4975.29"/>
<polygon fill="black" stroke="black" points="10915.56,-4972.37 10905.74,-4968.39 10910.93,-4977.62 10915.56,-4972.37"/>
</g>
<!-- split_v_2_2 -->
<g id="node719" class="node">
<title>split_v_2_2</title>
<ellipse fill="pink" stroke="black" cx="11174.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11174.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11174.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11174.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_v_2_2 -->
<g id="edge862" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_v_2_2</title>
<path fill="none" stroke="black" d="M11047.53,-5008.99C11067.12,-4997.29 11089.19,-4984.09 11109.38,-4972.02"/>
<polygon fill="black" stroke="black" points="11111.41,-4974.88 11118.2,-4966.75 11107.82,-4968.87 11111.41,-4974.88"/>
</g>
<!-- transpose_q_2_2 -->
<g id="node720" class="node">
<title>transpose_q_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="10556.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10556.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10556.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10556.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_2&#45;&gt;transpose_q_2_2 -->
<g id="edge863" class="edge">
<title>split_q_2_2&#45;&gt;transpose_q_2_2</title>
<path fill="none" stroke="black" d="M10556.57,-4894.42C10556.57,-4885.97 10556.57,-4876.87 10556.57,-4868.06"/>
<polygon fill="black" stroke="black" points="10560.07,-4867.89 10556.57,-4857.89 10553.07,-4867.89 10560.07,-4867.89"/>
</g>
<!-- transpose_k_2_2 -->
<g id="node721" class="node">
<title>transpose_k_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="10865.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10865.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10865.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10865.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_2&#45;&gt;transpose_k_2_2 -->
<g id="edge864" class="edge">
<title>split_k_2_2&#45;&gt;transpose_k_2_2</title>
<path fill="none" stroke="black" d="M10865.57,-4894.42C10865.57,-4885.97 10865.57,-4876.87 10865.57,-4868.06"/>
<polygon fill="black" stroke="black" points="10869.07,-4867.89 10865.57,-4857.89 10862.07,-4867.89 10869.07,-4867.89"/>
</g>
<!-- transpose_v_2_2 -->
<g id="node722" class="node">
<title>transpose_v_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="11174.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11174.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11174.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11174.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_2&#45;&gt;transpose_v_2_2 -->
<g id="edge865" class="edge">
<title>split_v_2_2&#45;&gt;transpose_v_2_2</title>
<path fill="none" stroke="black" d="M11174.57,-4894.42C11174.57,-4885.97 11174.57,-4876.87 11174.57,-4868.06"/>
<polygon fill="black" stroke="black" points="11178.07,-4867.89 11174.57,-4857.89 11171.07,-4867.89 11178.07,-4867.89"/>
</g>
<!-- attn_scores_2_2 -->
<g id="node723" class="node">
<title>attn_scores_2_2</title>
<ellipse fill="gold" stroke="black" cx="10865.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10865.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10865.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10865.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_2&#45;&gt;attn_scores_2_2 -->
<g id="edge866" class="edge">
<title>transpose_q_2_2&#45;&gt;attn_scores_2_2</title>
<path fill="none" stroke="black" d="M10640.19,-4789.28C10679.91,-4775.14 10727.6,-4758.16 10768.86,-4743.47"/>
<polygon fill="black" stroke="black" points="10770.13,-4746.74 10778.38,-4740.08 10767.79,-4740.14 10770.13,-4746.74"/>
</g>
<!-- transpose_k_2_2&#45;&gt;attn_scores_2_2 -->
<g id="edge867" class="edge">
<title>transpose_k_2_2&#45;&gt;attn_scores_2_2</title>
<path fill="none" stroke="black" d="M10865.57,-4782.42C10865.57,-4773.97 10865.57,-4764.87 10865.57,-4756.06"/>
<polygon fill="black" stroke="black" points="10869.07,-4755.89 10865.57,-4745.89 10862.07,-4755.89 10869.07,-4755.89"/>
</g>
<!-- attn_output_2_2 -->
<g id="node724" class="node">
<title>attn_output_2_2</title>
<ellipse fill="gold" stroke="black" cx="11116.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11116.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11116.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11116.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_2&#45;&gt;attn_output_2_2 -->
<g id="edge868" class="edge">
<title>transpose_v_2_2&#45;&gt;attn_output_2_2</title>
<path fill="none" stroke="black" d="M11168.2,-4782.35C11157.58,-4721.18 11136.27,-4598.48 11124.63,-4531.42"/>
<polygon fill="black" stroke="black" points="11128.07,-4530.81 11122.91,-4521.55 11121.18,-4532 11128.07,-4530.81"/>
</g>
<!-- softmax_2_2 -->
<g id="node725" class="node">
<title>softmax_2_2</title>
<ellipse fill="gold" stroke="black" cx="10921.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10921.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10921.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10921.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_2&#45;&gt;softmax_2_2 -->
<g id="edge869" class="edge">
<title>attn_scores_2_2&#45;&gt;softmax_2_2</title>
<path fill="none" stroke="black" d="M10884.07,-4670.72C10888.7,-4661.62 10893.73,-4651.74 10898.56,-4642.26"/>
<polygon fill="black" stroke="black" points="10901.68,-4643.83 10903.1,-4633.33 10895.45,-4640.65 10901.68,-4643.83"/>
</g>
<!-- transpose_back_2_2 -->
<g id="node726" class="node">
<title>transpose_back_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="11116.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11116.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="11116.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11116.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_2&#45;&gt;transpose_back_2_2 -->
<g id="edge871" class="edge">
<title>attn_output_2_2&#45;&gt;transpose_back_2_2</title>
<path fill="none" stroke="black" d="M11116.57,-4446.42C11116.57,-4437.97 11116.57,-4428.87 11116.57,-4420.06"/>
<polygon fill="black" stroke="black" points="11120.07,-4419.89 11116.57,-4409.89 11113.07,-4419.89 11120.07,-4419.89"/>
</g>
<!-- softmax_2_2&#45;&gt;attn_output_2_2 -->
<g id="edge870" class="edge">
<title>softmax_2_2&#45;&gt;attn_output_2_2</title>
<path fill="none" stroke="black" d="M10981.94,-4560.99C11003.07,-4549.07 11026.95,-4535.6 11048.66,-4523.36"/>
<polygon fill="black" stroke="black" points="11050.51,-4526.33 11057.5,-4518.37 11047.07,-4520.23 11050.51,-4526.33"/>
</g>
<!-- reshape_concat_2_2 -->
<g id="node727" class="node">
<title>reshape_concat_2_2</title>
<ellipse fill="lightcyan" stroke="black" cx="11116.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="11116.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="11116.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11116.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_2&#45;&gt;reshape_concat_2_2 -->
<g id="edge872" class="edge">
<title>transpose_back_2_2&#45;&gt;reshape_concat_2_2</title>
<path fill="none" stroke="black" d="M11116.57,-4334.42C11116.57,-4325.97 11116.57,-4316.87 11116.57,-4308.06"/>
<polygon fill="black" stroke="black" points="11120.07,-4307.89 11116.57,-4297.89 11113.07,-4307.89 11120.07,-4307.89"/>
</g>
<!-- reshape_concat_2_2&#45;&gt;allgather_dim_2_0 -->
<g id="edge873" class="edge">
<title>reshape_concat_2_2&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M11116.57,-4222.41C11116.57,-4214.1 11116.57,-4205.05 11116.57,-4196.01"/>
<polygon fill="black" stroke="black" points="11120.07,-4195.85 11116.57,-4185.85 11113.07,-4195.85 11120.07,-4195.85"/>
</g>
<!-- split_q_2_3 -->
<g id="node729" class="node">
<title>split_q_2_3</title>
<ellipse fill="pink" stroke="black" cx="11483.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11483.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11483.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11483.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_q_2_3 -->
<g id="edge875" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_q_2_3</title>
<path fill="none" stroke="black" d="M11776.64,-5015.07C11719.67,-4999.13 11648.29,-4979.15 11590.24,-4962.9"/>
<polygon fill="black" stroke="black" points="11590.88,-4959.45 11580.31,-4960.12 11588.99,-4966.19 11590.88,-4959.45"/>
</g>
<!-- split_k_2_3 -->
<g id="node730" class="node">
<title>split_k_2_3</title>
<ellipse fill="pink" stroke="black" cx="11792.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11792.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11792.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11792.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_k_2_3 -->
<g id="edge876" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_k_2_3</title>
<path fill="none" stroke="black" d="M11849.07,-5007.03C11841.82,-4997.53 11833.91,-4987.17 11826.37,-4977.3"/>
<polygon fill="black" stroke="black" points="11828.99,-4974.97 11820.14,-4969.14 11823.43,-4979.22 11828.99,-4974.97"/>
</g>
<!-- split_v_2_3 -->
<g id="node731" class="node">
<title>split_v_2_3</title>
<ellipse fill="pink" stroke="black" cx="12101.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12101.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12101.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12101.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_v_2_3 -->
<g id="edge877" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_v_2_3</title>
<path fill="none" stroke="black" d="M11944.08,-5010.04C11969.9,-4997.42 11999.51,-4982.94 12026.03,-4969.98"/>
<polygon fill="black" stroke="black" points="12027.83,-4972.99 12035.28,-4965.46 12024.75,-4966.71 12027.83,-4972.99"/>
</g>
<!-- transpose_q_2_3 -->
<g id="node732" class="node">
<title>transpose_q_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="11483.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11483.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11483.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11483.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_3&#45;&gt;transpose_q_2_3 -->
<g id="edge878" class="edge">
<title>split_q_2_3&#45;&gt;transpose_q_2_3</title>
<path fill="none" stroke="black" d="M11483.57,-4894.42C11483.57,-4885.97 11483.57,-4876.87 11483.57,-4868.06"/>
<polygon fill="black" stroke="black" points="11487.07,-4867.89 11483.57,-4857.89 11480.07,-4867.89 11487.07,-4867.89"/>
</g>
<!-- transpose_k_2_3 -->
<g id="node733" class="node">
<title>transpose_k_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="11792.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11792.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11792.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11792.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_3&#45;&gt;transpose_k_2_3 -->
<g id="edge879" class="edge">
<title>split_k_2_3&#45;&gt;transpose_k_2_3</title>
<path fill="none" stroke="black" d="M11792.57,-4894.42C11792.57,-4885.97 11792.57,-4876.87 11792.57,-4868.06"/>
<polygon fill="black" stroke="black" points="11796.07,-4867.89 11792.57,-4857.89 11789.07,-4867.89 11796.07,-4867.89"/>
</g>
<!-- transpose_v_2_3 -->
<g id="node734" class="node">
<title>transpose_v_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="12101.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12101.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12101.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12101.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_3&#45;&gt;transpose_v_2_3 -->
<g id="edge880" class="edge">
<title>split_v_2_3&#45;&gt;transpose_v_2_3</title>
<path fill="none" stroke="black" d="M12101.57,-4894.42C12101.57,-4885.97 12101.57,-4876.87 12101.57,-4868.06"/>
<polygon fill="black" stroke="black" points="12105.07,-4867.89 12101.57,-4857.89 12098.07,-4867.89 12105.07,-4867.89"/>
</g>
<!-- attn_scores_2_3 -->
<g id="node735" class="node">
<title>attn_scores_2_3</title>
<ellipse fill="gold" stroke="black" cx="11681.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11681.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11681.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11681.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_3&#45;&gt;attn_scores_2_3 -->
<g id="edge881" class="edge">
<title>transpose_q_2_3&#45;&gt;attn_scores_2_3</title>
<path fill="none" stroke="black" d="M11543.52,-4785.74C11565.02,-4773.8 11589.45,-4760.22 11611.72,-4747.85"/>
<polygon fill="black" stroke="black" points="11613.42,-4750.91 11620.46,-4742.99 11610.02,-4744.79 11613.42,-4750.91"/>
</g>
<!-- transpose_k_2_3&#45;&gt;attn_scores_2_3 -->
<g id="edge882" class="edge">
<title>transpose_k_2_3&#45;&gt;attn_scores_2_3</title>
<path fill="none" stroke="black" d="M11756.84,-4783.64C11746.65,-4773.53 11735.43,-4762.41 11724.83,-4751.91"/>
<polygon fill="black" stroke="black" points="11727.19,-4749.32 11717.62,-4744.77 11722.26,-4754.29 11727.19,-4749.32"/>
</g>
<!-- attn_output_2_3 -->
<g id="node736" class="node">
<title>attn_output_2_3</title>
<ellipse fill="gold" stroke="black" cx="11681.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11681.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11681.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11681.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_3&#45;&gt;attn_output_2_3 -->
<g id="edge883" class="edge">
<title>transpose_v_2_3&#45;&gt;attn_output_2_3</title>
<path fill="none" stroke="black" d="M12075.76,-4782.9C12034.92,-4727.97 11950.47,-4623.04 11857.57,-4558.55 11834.2,-4542.32 11806.68,-4528.7 11780.43,-4517.77"/>
<polygon fill="black" stroke="black" points="11781.42,-4514.39 11770.83,-4513.87 11778.78,-4520.88 11781.42,-4514.39"/>
</g>
<!-- softmax_2_3 -->
<g id="node737" class="node">
<title>softmax_2_3</title>
<ellipse fill="gold" stroke="black" cx="11681.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11681.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11681.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11681.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_3&#45;&gt;softmax_2_3 -->
<g id="edge884" class="edge">
<title>attn_scores_2_3&#45;&gt;softmax_2_3</title>
<path fill="none" stroke="black" d="M11681.57,-4670.42C11681.57,-4661.97 11681.57,-4652.87 11681.57,-4644.06"/>
<polygon fill="black" stroke="black" points="11685.07,-4643.89 11681.57,-4633.89 11678.07,-4643.89 11685.07,-4643.89"/>
</g>
<!-- transpose_back_2_3 -->
<g id="node738" class="node">
<title>transpose_back_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="11493.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11493.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="11493.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11493.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_3&#45;&gt;transpose_back_2_3 -->
<g id="edge886" class="edge">
<title>attn_output_2_3&#45;&gt;transpose_back_2_3</title>
<path fill="none" stroke="black" d="M11624.15,-4449.44C11603.83,-4437.56 11580.82,-4424.09 11559.83,-4411.81"/>
<polygon fill="black" stroke="black" points="11561.37,-4408.66 11550.97,-4406.63 11557.84,-4414.7 11561.37,-4408.66"/>
</g>
<!-- softmax_2_3&#45;&gt;attn_output_2_3 -->
<g id="edge885" class="edge">
<title>softmax_2_3&#45;&gt;attn_output_2_3</title>
<path fill="none" stroke="black" d="M11681.57,-4558.42C11681.57,-4549.97 11681.57,-4540.87 11681.57,-4532.06"/>
<polygon fill="black" stroke="black" points="11685.07,-4531.89 11681.57,-4521.89 11678.07,-4531.89 11685.07,-4531.89"/>
</g>
<!-- reshape_concat_2_3 -->
<g id="node739" class="node">
<title>reshape_concat_2_3</title>
<ellipse fill="lightcyan" stroke="black" cx="11475.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="11475.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="11475.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11475.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_3&#45;&gt;reshape_concat_2_3 -->
<g id="edge887" class="edge">
<title>transpose_back_2_3&#45;&gt;reshape_concat_2_3</title>
<path fill="none" stroke="black" d="M11487.58,-4334.42C11486.17,-4325.79 11484.64,-4316.48 11483.17,-4307.48"/>
<polygon fill="black" stroke="black" points="11486.61,-4306.82 11481.54,-4297.51 11479.7,-4307.95 11486.61,-4306.82"/>
</g>
<!-- reshape_concat_2_3&#45;&gt;allgather_dim_2_0 -->
<g id="edge888" class="edge">
<title>reshape_concat_2_3&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M11393.66,-4230.41C11337.5,-4210.78 11263.02,-4184.74 11205.43,-4164.61"/>
<polygon fill="black" stroke="black" points="11206.57,-4161.3 11195.97,-4161.3 11204.26,-4167.91 11206.57,-4161.3"/>
</g>
<!-- output_proj_2_0 -->
<g id="node891" class="node">
<title>output_proj_2_0</title>
<ellipse fill="orange" stroke="black" cx="15124.57" cy="-3919.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15124.57" y="-3938.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15124.57" y="-3923.26" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="15124.57" y="-3908.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15124.57" y="-3893.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_0&#45;&gt;output_proj_2_0 -->
<g id="edge1073" class="edge">
<title>head_group_2_0&#45;&gt;output_proj_2_0</title>
<path fill="none" stroke="black" d="M13773.1,-4015.61C14023.03,-3998.01 14682.77,-3951.57 14978.06,-3930.78"/>
<polygon fill="black" stroke="black" points="14978.68,-3934.24 14988.41,-3930.05 14978.19,-3927.26 14978.68,-3934.24"/>
</g>
<!-- split_q_2_4 -->
<g id="node742" class="node">
<title>split_q_2_4</title>
<ellipse fill="pink" stroke="black" cx="12410.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12410.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12410.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12410.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_q_2_4 -->
<g id="edge891" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_q_2_4</title>
<path fill="none" stroke="black" d="M12764.44,-5017.12C12692.68,-5000.07 12598.93,-4977.79 12525.95,-4960.46"/>
<polygon fill="black" stroke="black" points="12526.33,-4956.95 12515.79,-4958.04 12524.71,-4963.76 12526.33,-4956.95"/>
</g>
<!-- split_k_2_4 -->
<g id="node743" class="node">
<title>split_k_2_4</title>
<ellipse fill="pink" stroke="black" cx="12719.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12719.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12719.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_k_2_4 -->
<g id="edge892" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_k_2_4</title>
<path fill="none" stroke="black" d="M12824.85,-5008.24C12809.31,-4997.15 12792,-4984.78 12775.97,-4973.33"/>
<polygon fill="black" stroke="black" points="12777.89,-4970.4 12767.72,-4967.44 12773.82,-4976.1 12777.89,-4970.4"/>
</g>
<!-- split_v_2_4 -->
<g id="node744" class="node">
<title>split_v_2_4</title>
<ellipse fill="pink" stroke="black" cx="13028.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13028.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13028.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13028.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_v_2_4 -->
<g id="edge893" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_v_2_4</title>
<path fill="none" stroke="black" d="M12922.62,-5008.24C12938.25,-4997.15 12955.68,-4984.78 12971.81,-4973.33"/>
<polygon fill="black" stroke="black" points="12973.99,-4976.08 12980.11,-4967.44 12969.93,-4970.37 12973.99,-4976.08"/>
</g>
<!-- transpose_q_2_4 -->
<g id="node745" class="node">
<title>transpose_q_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="12410.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12410.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12410.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12410.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_4&#45;&gt;transpose_q_2_4 -->
<g id="edge894" class="edge">
<title>split_q_2_4&#45;&gt;transpose_q_2_4</title>
<path fill="none" stroke="black" d="M12410.57,-4894.42C12410.57,-4885.97 12410.57,-4876.87 12410.57,-4868.06"/>
<polygon fill="black" stroke="black" points="12414.07,-4867.89 12410.57,-4857.89 12407.07,-4867.89 12414.07,-4867.89"/>
</g>
<!-- transpose_k_2_4 -->
<g id="node746" class="node">
<title>transpose_k_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="12719.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12719.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12719.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_4&#45;&gt;transpose_k_2_4 -->
<g id="edge895" class="edge">
<title>split_k_2_4&#45;&gt;transpose_k_2_4</title>
<path fill="none" stroke="black" d="M12719.57,-4894.42C12719.57,-4885.97 12719.57,-4876.87 12719.57,-4868.06"/>
<polygon fill="black" stroke="black" points="12723.07,-4867.89 12719.57,-4857.89 12716.07,-4867.89 12723.07,-4867.89"/>
</g>
<!-- transpose_v_2_4 -->
<g id="node747" class="node">
<title>transpose_v_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="13028.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13028.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13028.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13028.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_4&#45;&gt;transpose_v_2_4 -->
<g id="edge896" class="edge">
<title>split_v_2_4&#45;&gt;transpose_v_2_4</title>
<path fill="none" stroke="black" d="M13028.57,-4894.42C13028.57,-4885.97 13028.57,-4876.87 13028.57,-4868.06"/>
<polygon fill="black" stroke="black" points="13032.07,-4867.89 13028.57,-4857.89 13025.07,-4867.89 13032.07,-4867.89"/>
</g>
<!-- attn_scores_2_4 -->
<g id="node748" class="node">
<title>attn_scores_2_4</title>
<ellipse fill="gold" stroke="black" cx="12719.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12719.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12719.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12719.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_4&#45;&gt;attn_scores_2_4 -->
<g id="edge897" class="edge">
<title>transpose_q_2_4&#45;&gt;attn_scores_2_4</title>
<path fill="none" stroke="black" d="M12494.19,-4789.28C12533.91,-4775.14 12581.6,-4758.16 12622.86,-4743.47"/>
<polygon fill="black" stroke="black" points="12624.13,-4746.74 12632.38,-4740.08 12621.79,-4740.14 12624.13,-4746.74"/>
</g>
<!-- transpose_k_2_4&#45;&gt;attn_scores_2_4 -->
<g id="edge898" class="edge">
<title>transpose_k_2_4&#45;&gt;attn_scores_2_4</title>
<path fill="none" stroke="black" d="M12719.57,-4782.42C12719.57,-4773.97 12719.57,-4764.87 12719.57,-4756.06"/>
<polygon fill="black" stroke="black" points="12723.07,-4755.89 12719.57,-4745.89 12716.07,-4755.89 12723.07,-4755.89"/>
</g>
<!-- attn_output_2_4 -->
<g id="node749" class="node">
<title>attn_output_2_4</title>
<ellipse fill="gold" stroke="black" cx="13028.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13028.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13028.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13028.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_4&#45;&gt;attn_output_2_4 -->
<g id="edge899" class="edge">
<title>transpose_v_2_4&#45;&gt;attn_output_2_4</title>
<path fill="none" stroke="black" d="M13028.57,-4782.35C13028.57,-4721.3 13028.57,-4598.99 13028.57,-4531.84"/>
<polygon fill="black" stroke="black" points="13032.07,-4531.55 13028.57,-4521.55 13025.07,-4531.55 13032.07,-4531.55"/>
</g>
<!-- softmax_2_4 -->
<g id="node750" class="node">
<title>softmax_2_4</title>
<ellipse fill="gold" stroke="black" cx="12776.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12776.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12776.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12776.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_4&#45;&gt;softmax_2_4 -->
<g id="edge900" class="edge">
<title>attn_scores_2_4&#45;&gt;softmax_2_4</title>
<path fill="none" stroke="black" d="M12738.4,-4670.72C12743.11,-4661.62 12748.23,-4651.74 12753.15,-4642.26"/>
<polygon fill="black" stroke="black" points="12756.28,-4643.82 12757.77,-4633.33 12750.06,-4640.6 12756.28,-4643.82"/>
</g>
<!-- transpose_back_2_4 -->
<g id="node751" class="node">
<title>transpose_back_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="13330.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13330.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13330.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13330.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_4&#45;&gt;transpose_back_2_4 -->
<g id="edge902" class="edge">
<title>attn_output_2_4&#45;&gt;transpose_back_2_4</title>
<path fill="none" stroke="black" d="M13111.1,-4452.99C13150.55,-4438.62 13197.91,-4421.37 13238.52,-4406.57"/>
<polygon fill="black" stroke="black" points="13239.95,-4409.78 13248.15,-4403.07 13237.56,-4403.2 13239.95,-4409.78"/>
</g>
<!-- softmax_2_4&#45;&gt;attn_output_2_4 -->
<g id="edge901" class="edge">
<title>softmax_2_4&#45;&gt;attn_output_2_4</title>
<path fill="none" stroke="black" d="M12851.16,-4562.49C12881.15,-4549.4 12915.83,-4534.26 12946.52,-4520.86"/>
<polygon fill="black" stroke="black" points="12948.15,-4523.97 12955.91,-4516.76 12945.35,-4517.55 12948.15,-4523.97"/>
</g>
<!-- reshape_concat_2_4 -->
<g id="node752" class="node">
<title>reshape_concat_2_4</title>
<ellipse fill="lightcyan" stroke="black" cx="14134.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14134.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14134.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14134.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_4&#45;&gt;reshape_concat_2_4 -->
<g id="edge903" class="edge">
<title>transpose_back_2_4&#45;&gt;reshape_concat_2_4</title>
<path fill="none" stroke="black" d="M13457.53,-4353.68C13607.41,-4333.17 13855.3,-4299.26 14005.92,-4278.65"/>
<polygon fill="black" stroke="black" points="14006.71,-4282.07 14016.14,-4277.25 14005.76,-4275.14 14006.71,-4282.07"/>
</g>
<!-- allgather_dim_2_1 -->
<g id="node753" class="node">
<title>allgather_dim_2_1</title>
<polygon fill="red" stroke="black" points="14875.57,-4185.55 14702.57,-4132.55 14875.57,-4079.55 15048.57,-4132.55 14875.57,-4185.55"/>
<text text-anchor="middle" x="14875.57" y="-4143.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="14875.57" y="-4128.85" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14875.57" y="-4113.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_4&#45;&gt;allgather_dim_2_1 -->
<g id="edge904" class="edge">
<title>reshape_concat_2_4&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M14232.48,-4234.56C14251.05,-4230.28 14270.37,-4226.08 14288.57,-4222.55 14444.82,-4192.24 14626.13,-4166.11 14745.43,-4150.15"/>
<polygon fill="black" stroke="black" points="14745.9,-4153.62 14755.35,-4148.83 14744.97,-4146.68 14745.9,-4153.62"/>
</g>
<!-- head_group_2_1 -->
<g id="node790" class="node">
<title>head_group_2_1</title>
<polygon fill="lightyellow" stroke="black" points="16009.07,-4042.55 15812.07,-4042.55 15812.07,-4004.55 16009.07,-4004.55 16009.07,-4042.55"/>
<text text-anchor="middle" x="15910.57" y="-4027.35" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15910.57" y="-4012.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_1&#45;&gt;head_group_2_1 -->
<g id="edge950" class="edge">
<title>allgather_dim_2_1&#45;&gt;head_group_2_1</title>
<path fill="none" stroke="black" d="M15002.48,-4118.43C15207.71,-4097.21 15608.88,-4055.73 15801.82,-4035.79"/>
<polygon fill="black" stroke="black" points="15802.39,-4039.25 15811.98,-4034.74 15801.67,-4032.29 15802.39,-4039.25"/>
</g>
<!-- split_q_2_5 -->
<g id="node755" class="node">
<title>split_q_2_5</title>
<ellipse fill="pink" stroke="black" cx="13337.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13337.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13337.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13337.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_q_2_5 -->
<g id="edge906" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_q_2_5</title>
<path fill="none" stroke="black" d="M13630.64,-5015.07C13573.67,-4999.13 13502.29,-4979.15 13444.24,-4962.9"/>
<polygon fill="black" stroke="black" points="13444.88,-4959.45 13434.31,-4960.12 13442.99,-4966.19 13444.88,-4959.45"/>
</g>
<!-- split_k_2_5 -->
<g id="node756" class="node">
<title>split_k_2_5</title>
<ellipse fill="pink" stroke="black" cx="13646.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13646.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13646.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13646.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_k_2_5 -->
<g id="edge907" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_k_2_5</title>
<path fill="none" stroke="black" d="M13703.07,-5007.03C13695.82,-4997.53 13687.91,-4987.17 13680.37,-4977.3"/>
<polygon fill="black" stroke="black" points="13682.99,-4974.97 13674.14,-4969.14 13677.43,-4979.22 13682.99,-4974.97"/>
</g>
<!-- split_v_2_5 -->
<g id="node757" class="node">
<title>split_v_2_5</title>
<ellipse fill="pink" stroke="black" cx="13955.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13955.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13955.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13955.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_v_2_5 -->
<g id="edge908" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_v_2_5</title>
<path fill="none" stroke="black" d="M13798.08,-5010.04C13823.9,-4997.42 13853.51,-4982.94 13880.03,-4969.98"/>
<polygon fill="black" stroke="black" points="13881.83,-4972.99 13889.28,-4965.46 13878.75,-4966.71 13881.83,-4972.99"/>
</g>
<!-- transpose_q_2_5 -->
<g id="node758" class="node">
<title>transpose_q_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="13337.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13337.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13337.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13337.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_5&#45;&gt;transpose_q_2_5 -->
<g id="edge909" class="edge">
<title>split_q_2_5&#45;&gt;transpose_q_2_5</title>
<path fill="none" stroke="black" d="M13337.57,-4894.42C13337.57,-4885.97 13337.57,-4876.87 13337.57,-4868.06"/>
<polygon fill="black" stroke="black" points="13341.07,-4867.89 13337.57,-4857.89 13334.07,-4867.89 13341.07,-4867.89"/>
</g>
<!-- transpose_k_2_5 -->
<g id="node759" class="node">
<title>transpose_k_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="13646.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13646.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13646.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13646.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_5&#45;&gt;transpose_k_2_5 -->
<g id="edge910" class="edge">
<title>split_k_2_5&#45;&gt;transpose_k_2_5</title>
<path fill="none" stroke="black" d="M13646.57,-4894.42C13646.57,-4885.97 13646.57,-4876.87 13646.57,-4868.06"/>
<polygon fill="black" stroke="black" points="13650.07,-4867.89 13646.57,-4857.89 13643.07,-4867.89 13650.07,-4867.89"/>
</g>
<!-- transpose_v_2_5 -->
<g id="node760" class="node">
<title>transpose_v_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="13955.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13955.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13955.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13955.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_5&#45;&gt;transpose_v_2_5 -->
<g id="edge911" class="edge">
<title>split_v_2_5&#45;&gt;transpose_v_2_5</title>
<path fill="none" stroke="black" d="M13955.57,-4894.42C13955.57,-4885.97 13955.57,-4876.87 13955.57,-4868.06"/>
<polygon fill="black" stroke="black" points="13959.07,-4867.89 13955.57,-4857.89 13952.07,-4867.89 13959.07,-4867.89"/>
</g>
<!-- attn_scores_2_5 -->
<g id="node761" class="node">
<title>attn_scores_2_5</title>
<ellipse fill="gold" stroke="black" cx="13646.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13646.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13646.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13646.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_5&#45;&gt;attn_scores_2_5 -->
<g id="edge912" class="edge">
<title>transpose_q_2_5&#45;&gt;attn_scores_2_5</title>
<path fill="none" stroke="black" d="M13421.19,-4789.28C13460.91,-4775.14 13508.6,-4758.16 13549.86,-4743.47"/>
<polygon fill="black" stroke="black" points="13551.13,-4746.74 13559.38,-4740.08 13548.79,-4740.14 13551.13,-4746.74"/>
</g>
<!-- transpose_k_2_5&#45;&gt;attn_scores_2_5 -->
<g id="edge913" class="edge">
<title>transpose_k_2_5&#45;&gt;attn_scores_2_5</title>
<path fill="none" stroke="black" d="M13646.57,-4782.42C13646.57,-4773.97 13646.57,-4764.87 13646.57,-4756.06"/>
<polygon fill="black" stroke="black" points="13650.07,-4755.89 13646.57,-4745.89 13643.07,-4755.89 13650.07,-4755.89"/>
</g>
<!-- attn_output_2_5 -->
<g id="node762" class="node">
<title>attn_output_2_5</title>
<ellipse fill="gold" stroke="black" cx="13955.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13955.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13955.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13955.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_5&#45;&gt;attn_output_2_5 -->
<g id="edge914" class="edge">
<title>transpose_v_2_5&#45;&gt;attn_output_2_5</title>
<path fill="none" stroke="black" d="M13955.57,-4782.35C13955.57,-4721.3 13955.57,-4598.99 13955.57,-4531.84"/>
<polygon fill="black" stroke="black" points="13959.07,-4531.55 13955.57,-4521.55 13952.07,-4531.55 13959.07,-4531.55"/>
</g>
<!-- softmax_2_5 -->
<g id="node763" class="node">
<title>softmax_2_5</title>
<ellipse fill="gold" stroke="black" cx="13731.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13731.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13731.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13731.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_5&#45;&gt;softmax_2_5 -->
<g id="edge915" class="edge">
<title>attn_scores_2_5&#45;&gt;softmax_2_5</title>
<path fill="none" stroke="black" d="M13674.41,-4671.03C13681.74,-4661.53 13689.75,-4651.17 13697.38,-4641.3"/>
<polygon fill="black" stroke="black" points="13700.33,-4643.2 13703.68,-4633.14 13694.79,-4638.92 13700.33,-4643.2"/>
</g>
<!-- transpose_back_2_5 -->
<g id="node764" class="node">
<title>transpose_back_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="14257.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14257.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14257.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14257.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_5&#45;&gt;transpose_back_2_5 -->
<g id="edge917" class="edge">
<title>attn_output_2_5&#45;&gt;transpose_back_2_5</title>
<path fill="none" stroke="black" d="M14038.1,-4452.99C14077.55,-4438.62 14124.91,-4421.37 14165.52,-4406.57"/>
<polygon fill="black" stroke="black" points="14166.95,-4409.78 14175.15,-4403.07 14164.56,-4403.2 14166.95,-4409.78"/>
</g>
<!-- softmax_2_5&#45;&gt;attn_output_2_5 -->
<g id="edge916" class="edge">
<title>softmax_2_5&#45;&gt;attn_output_2_5</title>
<path fill="none" stroke="black" d="M13799.39,-4561.74C13824.96,-4549.19 13854.19,-4534.83 13880.4,-4521.96"/>
<polygon fill="black" stroke="black" points="13882.09,-4525.03 13889.53,-4517.48 13879.01,-4518.74 13882.09,-4525.03"/>
</g>
<!-- reshape_concat_2_5 -->
<g id="node765" class="node">
<title>reshape_concat_2_5</title>
<ellipse fill="lightcyan" stroke="black" cx="14430.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14430.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14430.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14430.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_5&#45;&gt;reshape_concat_2_5 -->
<g id="edge918" class="edge">
<title>transpose_back_2_5&#45;&gt;reshape_concat_2_5</title>
<path fill="none" stroke="black" d="M14310.89,-4337.14C14329.32,-4325.43 14350.11,-4312.21 14369.13,-4300.11"/>
<polygon fill="black" stroke="black" points="14371.17,-4302.96 14377.73,-4294.65 14367.41,-4297.06 14371.17,-4302.96"/>
</g>
<!-- reshape_concat_2_5&#45;&gt;allgather_dim_2_1 -->
<g id="edge919" class="edge">
<title>reshape_concat_2_5&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M14523.05,-4232.97C14597.26,-4212.04 14701.19,-4182.72 14776.98,-4161.35"/>
<polygon fill="black" stroke="black" points="14778.33,-4164.61 14787.01,-4158.52 14776.43,-4157.87 14778.33,-4164.61"/>
</g>
<!-- split_q_2_6 -->
<g id="node767" class="node">
<title>split_q_2_6</title>
<ellipse fill="pink" stroke="black" cx="14264.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14264.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14264.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14264.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_q_2_6 -->
<g id="edge921" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_q_2_6</title>
<path fill="none" stroke="black" d="M14557.64,-5015.07C14500.67,-4999.13 14429.29,-4979.15 14371.24,-4962.9"/>
<polygon fill="black" stroke="black" points="14371.88,-4959.45 14361.31,-4960.12 14369.99,-4966.19 14371.88,-4959.45"/>
</g>
<!-- split_k_2_6 -->
<g id="node768" class="node">
<title>split_k_2_6</title>
<ellipse fill="pink" stroke="black" cx="14573.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14573.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14573.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14573.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_k_2_6 -->
<g id="edge922" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_k_2_6</title>
<path fill="none" stroke="black" d="M14630.07,-5007.03C14622.82,-4997.53 14614.91,-4987.17 14607.37,-4977.3"/>
<polygon fill="black" stroke="black" points="14609.99,-4974.97 14601.14,-4969.14 14604.43,-4979.22 14609.99,-4974.97"/>
</g>
<!-- split_v_2_6 -->
<g id="node769" class="node">
<title>split_v_2_6</title>
<ellipse fill="pink" stroke="black" cx="14882.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14882.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14882.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14882.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_v_2_6 -->
<g id="edge923" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_v_2_6</title>
<path fill="none" stroke="black" d="M14725.08,-5010.04C14750.9,-4997.42 14780.51,-4982.94 14807.03,-4969.98"/>
<polygon fill="black" stroke="black" points="14808.83,-4972.99 14816.28,-4965.46 14805.75,-4966.71 14808.83,-4972.99"/>
</g>
<!-- transpose_q_2_6 -->
<g id="node770" class="node">
<title>transpose_q_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14264.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14264.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14264.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14264.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_6&#45;&gt;transpose_q_2_6 -->
<g id="edge924" class="edge">
<title>split_q_2_6&#45;&gt;transpose_q_2_6</title>
<path fill="none" stroke="black" d="M14264.57,-4894.42C14264.57,-4885.97 14264.57,-4876.87 14264.57,-4868.06"/>
<polygon fill="black" stroke="black" points="14268.07,-4867.89 14264.57,-4857.89 14261.07,-4867.89 14268.07,-4867.89"/>
</g>
<!-- transpose_k_2_6 -->
<g id="node771" class="node">
<title>transpose_k_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14573.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14573.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14573.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14573.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_6&#45;&gt;transpose_k_2_6 -->
<g id="edge925" class="edge">
<title>split_k_2_6&#45;&gt;transpose_k_2_6</title>
<path fill="none" stroke="black" d="M14573.57,-4894.42C14573.57,-4885.97 14573.57,-4876.87 14573.57,-4868.06"/>
<polygon fill="black" stroke="black" points="14577.07,-4867.89 14573.57,-4857.89 14570.07,-4867.89 14577.07,-4867.89"/>
</g>
<!-- transpose_v_2_6 -->
<g id="node772" class="node">
<title>transpose_v_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14882.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14882.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14882.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14882.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_6&#45;&gt;transpose_v_2_6 -->
<g id="edge926" class="edge">
<title>split_v_2_6&#45;&gt;transpose_v_2_6</title>
<path fill="none" stroke="black" d="M14882.57,-4894.42C14882.57,-4885.97 14882.57,-4876.87 14882.57,-4868.06"/>
<polygon fill="black" stroke="black" points="14886.07,-4867.89 14882.57,-4857.89 14879.07,-4867.89 14886.07,-4867.89"/>
</g>
<!-- attn_scores_2_6 -->
<g id="node773" class="node">
<title>attn_scores_2_6</title>
<ellipse fill="gold" stroke="black" cx="14573.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14573.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14573.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14573.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_6&#45;&gt;attn_scores_2_6 -->
<g id="edge927" class="edge">
<title>transpose_q_2_6&#45;&gt;attn_scores_2_6</title>
<path fill="none" stroke="black" d="M14348.19,-4789.28C14387.91,-4775.14 14435.6,-4758.16 14476.86,-4743.47"/>
<polygon fill="black" stroke="black" points="14478.13,-4746.74 14486.38,-4740.08 14475.79,-4740.14 14478.13,-4746.74"/>
</g>
<!-- transpose_k_2_6&#45;&gt;attn_scores_2_6 -->
<g id="edge928" class="edge">
<title>transpose_k_2_6&#45;&gt;attn_scores_2_6</title>
<path fill="none" stroke="black" d="M14573.57,-4782.42C14573.57,-4773.97 14573.57,-4764.87 14573.57,-4756.06"/>
<polygon fill="black" stroke="black" points="14577.07,-4755.89 14573.57,-4745.89 14570.07,-4755.89 14577.07,-4755.89"/>
</g>
<!-- attn_output_2_6 -->
<g id="node774" class="node">
<title>attn_output_2_6</title>
<ellipse fill="gold" stroke="black" cx="14875.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14875.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14875.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14875.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_6&#45;&gt;attn_output_2_6 -->
<g id="edge929" class="edge">
<title>transpose_v_2_6&#45;&gt;attn_output_2_6</title>
<path fill="none" stroke="black" d="M14881.8,-4782.35C14880.52,-4721.3 14877.96,-4598.99 14876.55,-4531.84"/>
<polygon fill="black" stroke="black" points="14880.05,-4531.48 14876.34,-4521.55 14873.05,-4531.62 14880.05,-4531.48"/>
</g>
<!-- softmax_2_6 -->
<g id="node775" class="node">
<title>softmax_2_6</title>
<ellipse fill="gold" stroke="black" cx="14624.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14624.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14624.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14624.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_6&#45;&gt;softmax_2_6 -->
<g id="edge930" class="edge">
<title>attn_scores_2_6&#45;&gt;softmax_2_6</title>
<path fill="none" stroke="black" d="M14590.41,-4670.72C14594.55,-4661.8 14599.03,-4652.14 14603.34,-4642.84"/>
<polygon fill="black" stroke="black" points="14606.55,-4644.25 14607.58,-4633.71 14600.19,-4641.31 14606.55,-4644.25"/>
</g>
<!-- transpose_back_2_6 -->
<g id="node776" class="node">
<title>transpose_back_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14875.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14875.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14875.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14875.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_6&#45;&gt;transpose_back_2_6 -->
<g id="edge932" class="edge">
<title>attn_output_2_6&#45;&gt;transpose_back_2_6</title>
<path fill="none" stroke="black" d="M14875.57,-4446.42C14875.57,-4437.97 14875.57,-4428.87 14875.57,-4420.06"/>
<polygon fill="black" stroke="black" points="14879.07,-4419.89 14875.57,-4409.89 14872.07,-4419.89 14879.07,-4419.89"/>
</g>
<!-- softmax_2_6&#45;&gt;attn_output_2_6 -->
<g id="edge931" class="edge">
<title>softmax_2_6&#45;&gt;attn_output_2_6</title>
<path fill="none" stroke="black" d="M14699.2,-4562.34C14729.06,-4549.25 14763.54,-4534.14 14794.06,-4520.77"/>
<polygon fill="black" stroke="black" points="14795.64,-4523.9 14803.39,-4516.68 14792.83,-4517.49 14795.64,-4523.9"/>
</g>
<!-- reshape_concat_2_6 -->
<g id="node777" class="node">
<title>reshape_concat_2_6</title>
<ellipse fill="lightcyan" stroke="black" cx="14875.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14875.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14875.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14875.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_6&#45;&gt;reshape_concat_2_6 -->
<g id="edge933" class="edge">
<title>transpose_back_2_6&#45;&gt;reshape_concat_2_6</title>
<path fill="none" stroke="black" d="M14875.57,-4334.42C14875.57,-4325.97 14875.57,-4316.87 14875.57,-4308.06"/>
<polygon fill="black" stroke="black" points="14879.07,-4307.89 14875.57,-4297.89 14872.07,-4307.89 14879.07,-4307.89"/>
</g>
<!-- reshape_concat_2_6&#45;&gt;allgather_dim_2_1 -->
<g id="edge934" class="edge">
<title>reshape_concat_2_6&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M14875.57,-4222.41C14875.57,-4214.1 14875.57,-4205.05 14875.57,-4196.01"/>
<polygon fill="black" stroke="black" points="14879.07,-4195.85 14875.57,-4185.85 14872.07,-4195.85 14879.07,-4195.85"/>
</g>
<!-- split_q_2_7 -->
<g id="node779" class="node">
<title>split_q_2_7</title>
<ellipse fill="pink" stroke="black" cx="15191.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15191.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15191.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15191.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_q_2_7 -->
<g id="edge936" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_q_2_7</title>
<path fill="none" stroke="black" d="M15560.4,-5018.05C15497.16,-5003.98 15416.94,-4986 15345.57,-4969.55 15332.99,-4966.64 15319.83,-4963.58 15306.73,-4960.5"/>
<polygon fill="black" stroke="black" points="15307.28,-4957.03 15296.74,-4958.15 15305.67,-4963.85 15307.28,-4957.03"/>
</g>
<!-- split_k_2_7 -->
<g id="node780" class="node">
<title>split_k_2_7</title>
<ellipse fill="pink" stroke="black" cx="15500.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15500.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15500.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15500.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_k_2_7 -->
<g id="edge937" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_k_2_7</title>
<path fill="none" stroke="black" d="M15619.31,-5008.54C15601.35,-4997.12 15581.22,-4984.32 15562.71,-4972.55"/>
<polygon fill="black" stroke="black" points="15564.37,-4969.46 15554.05,-4967.05 15560.61,-4975.37 15564.37,-4969.46"/>
</g>
<!-- split_v_2_7 -->
<g id="node781" class="node">
<title>split_v_2_7</title>
<ellipse fill="pink" stroke="black" cx="15809.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15809.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15809.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15809.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_v_2_7 -->
<g id="edge938" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_v_2_7</title>
<path fill="none" stroke="black" d="M15716.98,-5007.94C15730.11,-4997.32 15744.65,-4985.56 15758.24,-4974.57"/>
<polygon fill="black" stroke="black" points="15760.54,-4977.21 15766.11,-4968.2 15756.14,-4971.76 15760.54,-4977.21"/>
</g>
<!-- transpose_q_2_7 -->
<g id="node782" class="node">
<title>transpose_q_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="15191.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15191.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15191.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15191.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_7&#45;&gt;transpose_q_2_7 -->
<g id="edge939" class="edge">
<title>split_q_2_7&#45;&gt;transpose_q_2_7</title>
<path fill="none" stroke="black" d="M15191.57,-4894.42C15191.57,-4885.97 15191.57,-4876.87 15191.57,-4868.06"/>
<polygon fill="black" stroke="black" points="15195.07,-4867.89 15191.57,-4857.89 15188.07,-4867.89 15195.07,-4867.89"/>
</g>
<!-- transpose_k_2_7 -->
<g id="node783" class="node">
<title>transpose_k_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="15500.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15500.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15500.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15500.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_7&#45;&gt;transpose_k_2_7 -->
<g id="edge940" class="edge">
<title>split_k_2_7&#45;&gt;transpose_k_2_7</title>
<path fill="none" stroke="black" d="M15500.57,-4894.42C15500.57,-4885.97 15500.57,-4876.87 15500.57,-4868.06"/>
<polygon fill="black" stroke="black" points="15504.07,-4867.89 15500.57,-4857.89 15497.07,-4867.89 15504.07,-4867.89"/>
</g>
<!-- transpose_v_2_7 -->
<g id="node784" class="node">
<title>transpose_v_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="15809.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15809.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15809.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15809.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_7&#45;&gt;transpose_v_2_7 -->
<g id="edge941" class="edge">
<title>split_v_2_7&#45;&gt;transpose_v_2_7</title>
<path fill="none" stroke="black" d="M15809.57,-4894.42C15809.57,-4885.97 15809.57,-4876.87 15809.57,-4868.06"/>
<polygon fill="black" stroke="black" points="15813.07,-4867.89 15809.57,-4857.89 15806.07,-4867.89 15813.07,-4867.89"/>
</g>
<!-- attn_scores_2_7 -->
<g id="node785" class="node">
<title>attn_scores_2_7</title>
<ellipse fill="gold" stroke="black" cx="15196.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15196.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15196.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15196.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_7&#45;&gt;attn_scores_2_7 -->
<g id="edge942" class="edge">
<title>transpose_q_2_7&#45;&gt;attn_scores_2_7</title>
<path fill="none" stroke="black" d="M15193.24,-4782.42C15193.62,-4773.97 15194.04,-4764.87 15194.44,-4756.06"/>
<polygon fill="black" stroke="black" points="15197.94,-4756.04 15194.9,-4745.89 15190.95,-4755.72 15197.94,-4756.04"/>
</g>
<!-- transpose_k_2_7&#45;&gt;attn_scores_2_7 -->
<g id="edge943" class="edge">
<title>transpose_k_2_7&#45;&gt;attn_scores_2_7</title>
<path fill="none" stroke="black" d="M15417.91,-4789.13C15379.08,-4775.09 15332.58,-4758.26 15292.25,-4743.66"/>
<polygon fill="black" stroke="black" points="15293.27,-4740.31 15282.67,-4740.2 15290.89,-4746.89 15293.27,-4740.31"/>
</g>
<!-- attn_output_2_7 -->
<g id="node786" class="node">
<title>attn_output_2_7</title>
<ellipse fill="gold" stroke="black" cx="15196.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15196.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15196.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15196.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_7&#45;&gt;attn_output_2_7 -->
<g id="edge944" class="edge">
<title>transpose_v_2_7&#45;&gt;attn_output_2_7</title>
<path fill="none" stroke="black" d="M15757.79,-4784.89C15677.33,-4732.57 15516.54,-4631.06 15372.57,-4558.55 15344.94,-4544.63 15314.03,-4531.08 15285.92,-4519.48"/>
<polygon fill="black" stroke="black" points="15287.09,-4516.18 15276.5,-4515.63 15284.43,-4522.65 15287.09,-4516.18"/>
</g>
<!-- softmax_2_7 -->
<g id="node787" class="node">
<title>softmax_2_7</title>
<ellipse fill="gold" stroke="black" cx="15196.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15196.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15196.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15196.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_7&#45;&gt;softmax_2_7 -->
<g id="edge945" class="edge">
<title>attn_scores_2_7&#45;&gt;softmax_2_7</title>
<path fill="none" stroke="black" d="M15196.57,-4670.42C15196.57,-4661.97 15196.57,-4652.87 15196.57,-4644.06"/>
<polygon fill="black" stroke="black" points="15200.07,-4643.89 15196.57,-4633.89 15193.07,-4643.89 15200.07,-4643.89"/>
</g>
<!-- transpose_back_2_7 -->
<g id="node788" class="node">
<title>transpose_back_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="15184.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15184.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="15184.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15184.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_7&#45;&gt;transpose_back_2_7 -->
<g id="edge947" class="edge">
<title>attn_output_2_7&#45;&gt;transpose_back_2_7</title>
<path fill="none" stroke="black" d="M15192.58,-4446.42C15191.66,-4437.97 15190.66,-4428.87 15189.7,-4420.06"/>
<polygon fill="black" stroke="black" points="15193.16,-4419.45 15188.59,-4409.89 15186.2,-4420.21 15193.16,-4419.45"/>
</g>
<!-- softmax_2_7&#45;&gt;attn_output_2_7 -->
<g id="edge946" class="edge">
<title>softmax_2_7&#45;&gt;attn_output_2_7</title>
<path fill="none" stroke="black" d="M15196.57,-4558.42C15196.57,-4549.97 15196.57,-4540.87 15196.57,-4532.06"/>
<polygon fill="black" stroke="black" points="15200.07,-4531.89 15196.57,-4521.89 15193.07,-4531.89 15200.07,-4531.89"/>
</g>
<!-- reshape_concat_2_7 -->
<g id="node789" class="node">
<title>reshape_concat_2_7</title>
<ellipse fill="lightcyan" stroke="black" cx="15165.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="15165.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="15165.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15165.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_7&#45;&gt;reshape_concat_2_7 -->
<g id="edge948" class="edge">
<title>transpose_back_2_7&#45;&gt;reshape_concat_2_7</title>
<path fill="none" stroke="black" d="M15178.25,-4334.42C15176.76,-4325.79 15175.15,-4316.48 15173.59,-4307.48"/>
<polygon fill="black" stroke="black" points="15177.02,-4306.77 15171.87,-4297.51 15170.13,-4307.96 15177.02,-4306.77"/>
</g>
<!-- reshape_concat_2_7&#45;&gt;allgather_dim_2_1 -->
<g id="edge949" class="edge">
<title>reshape_concat_2_7&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M15094.26,-4228.18C15052.23,-4210 14998.95,-4186.94 14955.51,-4168.14"/>
<polygon fill="black" stroke="black" points="14956.68,-4164.83 14946.11,-4164.07 14953.9,-4171.25 14956.68,-4164.83"/>
</g>
<!-- output_proj_2_1 -->
<g id="node892" class="node">
<title>output_proj_2_1</title>
<ellipse fill="orange" stroke="black" cx="16111.57" cy="-3919.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16111.57" y="-3938.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16111.57" y="-3923.26" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16111.57" y="-3908.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16111.57" y="-3893.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_1&#45;&gt;output_proj_2_1 -->
<g id="edge1074" class="edge">
<title>head_group_2_1&#45;&gt;output_proj_2_1</title>
<path fill="none" stroke="black" d="M15946.05,-4004.53C15968.11,-3993.32 15997.51,-3978.39 16025.41,-3964.22"/>
<polygon fill="black" stroke="black" points="16027.07,-3967.31 16034.4,-3959.66 16023.9,-3961.06 16027.07,-3967.31"/>
</g>
<!-- split_q_2_8 -->
<g id="node792" class="node">
<title>split_q_2_8</title>
<ellipse fill="pink" stroke="black" cx="16118.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16118.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16118.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16118.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_q_2_8 -->
<g id="edge952" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_q_2_8</title>
<path fill="none" stroke="black" d="M16283.7,-5010.34C16256.35,-4997.54 16224.86,-4982.8 16196.76,-4969.64"/>
<polygon fill="black" stroke="black" points="16197.91,-4966.32 16187.37,-4965.25 16194.94,-4972.66 16197.91,-4966.32"/>
</g>
<!-- split_k_2_8 -->
<g id="node793" class="node">
<title>split_k_2_8</title>
<ellipse fill="pink" stroke="black" cx="16427.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16427.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16427.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16427.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_k_2_8 -->
<g id="edge953" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_k_2_8</title>
<path fill="none" stroke="black" d="M16378.01,-5006.72C16384.26,-4997.43 16391.06,-4987.33 16397.55,-4977.67"/>
<polygon fill="black" stroke="black" points="16400.49,-4979.58 16403.16,-4969.33 16394.68,-4975.67 16400.49,-4979.58"/>
</g>
<!-- split_v_2_8 -->
<g id="node794" class="node">
<title>split_v_2_8</title>
<ellipse fill="pink" stroke="black" cx="16736.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16736.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16736.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16736.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_v_2_8 -->
<g id="edge954" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_v_2_8</title>
<path fill="none" stroke="black" d="M16452.21,-5014.72C16507.09,-4998.95 16575.41,-4979.33 16631.32,-4963.27"/>
<polygon fill="black" stroke="black" points="16632.61,-4966.55 16641.25,-4960.42 16630.67,-4959.82 16632.61,-4966.55"/>
</g>
<!-- transpose_q_2_8 -->
<g id="node795" class="node">
<title>transpose_q_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="16118.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16118.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16118.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16118.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_8&#45;&gt;transpose_q_2_8 -->
<g id="edge955" class="edge">
<title>split_q_2_8&#45;&gt;transpose_q_2_8</title>
<path fill="none" stroke="black" d="M16118.57,-4894.42C16118.57,-4885.97 16118.57,-4876.87 16118.57,-4868.06"/>
<polygon fill="black" stroke="black" points="16122.07,-4867.89 16118.57,-4857.89 16115.07,-4867.89 16122.07,-4867.89"/>
</g>
<!-- transpose_k_2_8 -->
<g id="node796" class="node">
<title>transpose_k_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="16427.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16427.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16427.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16427.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_8&#45;&gt;transpose_k_2_8 -->
<g id="edge956" class="edge">
<title>split_k_2_8&#45;&gt;transpose_k_2_8</title>
<path fill="none" stroke="black" d="M16427.57,-4894.42C16427.57,-4885.97 16427.57,-4876.87 16427.57,-4868.06"/>
<polygon fill="black" stroke="black" points="16431.07,-4867.89 16427.57,-4857.89 16424.07,-4867.89 16431.07,-4867.89"/>
</g>
<!-- transpose_v_2_8 -->
<g id="node797" class="node">
<title>transpose_v_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="16736.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16736.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16736.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16736.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_8&#45;&gt;transpose_v_2_8 -->
<g id="edge957" class="edge">
<title>split_v_2_8&#45;&gt;transpose_v_2_8</title>
<path fill="none" stroke="black" d="M16736.57,-4894.42C16736.57,-4885.97 16736.57,-4876.87 16736.57,-4868.06"/>
<polygon fill="black" stroke="black" points="16740.07,-4867.89 16736.57,-4857.89 16733.07,-4867.89 16740.07,-4867.89"/>
</g>
<!-- attn_scores_2_8 -->
<g id="node798" class="node">
<title>attn_scores_2_8</title>
<ellipse fill="gold" stroke="black" cx="16427.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16427.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16427.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16427.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_8&#45;&gt;attn_scores_2_8 -->
<g id="edge958" class="edge">
<title>transpose_q_2_8&#45;&gt;attn_scores_2_8</title>
<path fill="none" stroke="black" d="M16202.19,-4789.28C16241.91,-4775.14 16289.6,-4758.16 16330.86,-4743.47"/>
<polygon fill="black" stroke="black" points="16332.13,-4746.74 16340.38,-4740.08 16329.79,-4740.14 16332.13,-4746.74"/>
</g>
<!-- transpose_k_2_8&#45;&gt;attn_scores_2_8 -->
<g id="edge959" class="edge">
<title>transpose_k_2_8&#45;&gt;attn_scores_2_8</title>
<path fill="none" stroke="black" d="M16427.57,-4782.42C16427.57,-4773.97 16427.57,-4764.87 16427.57,-4756.06"/>
<polygon fill="black" stroke="black" points="16431.07,-4755.89 16427.57,-4745.89 16424.07,-4755.89 16431.07,-4755.89"/>
</g>
<!-- attn_output_2_8 -->
<g id="node799" class="node">
<title>attn_output_2_8</title>
<ellipse fill="gold" stroke="black" cx="16736.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16736.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16736.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16736.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_8&#45;&gt;attn_output_2_8 -->
<g id="edge960" class="edge">
<title>transpose_v_2_8&#45;&gt;attn_output_2_8</title>
<path fill="none" stroke="black" d="M16736.57,-4782.35C16736.57,-4721.3 16736.57,-4598.99 16736.57,-4531.84"/>
<polygon fill="black" stroke="black" points="16740.07,-4531.55 16736.57,-4521.55 16733.07,-4531.55 16740.07,-4531.55"/>
</g>
<!-- softmax_2_8 -->
<g id="node800" class="node">
<title>softmax_2_8</title>
<ellipse fill="gold" stroke="black" cx="16512.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16512.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16512.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16512.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_8&#45;&gt;softmax_2_8 -->
<g id="edge961" class="edge">
<title>attn_scores_2_8&#45;&gt;softmax_2_8</title>
<path fill="none" stroke="black" d="M16455.41,-4671.03C16462.74,-4661.53 16470.75,-4651.17 16478.38,-4641.3"/>
<polygon fill="black" stroke="black" points="16481.33,-4643.2 16484.68,-4633.14 16475.79,-4638.92 16481.33,-4643.2"/>
</g>
<!-- transpose_back_2_8 -->
<g id="node801" class="node">
<title>transpose_back_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="16984.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16984.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16984.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16984.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_8&#45;&gt;transpose_back_2_8 -->
<g id="edge963" class="edge">
<title>attn_output_2_8&#45;&gt;transpose_back_2_8</title>
<path fill="none" stroke="black" d="M16808.31,-4451.23C16838.12,-4438 16872.88,-4422.59 16903.61,-4408.96"/>
<polygon fill="black" stroke="black" points="16905.28,-4412.04 16913,-4404.79 16902.44,-4405.65 16905.28,-4412.04"/>
</g>
<!-- softmax_2_8&#45;&gt;attn_output_2_8 -->
<g id="edge962" class="edge">
<title>softmax_2_8&#45;&gt;attn_output_2_8</title>
<path fill="none" stroke="black" d="M16580.39,-4561.74C16605.96,-4549.19 16635.19,-4534.83 16661.4,-4521.96"/>
<polygon fill="black" stroke="black" points="16663.09,-4525.03 16670.53,-4517.48 16660.01,-4518.74 16663.09,-4525.03"/>
</g>
<!-- reshape_concat_2_8 -->
<g id="node802" class="node">
<title>reshape_concat_2_8</title>
<ellipse fill="lightcyan" stroke="black" cx="17185.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17185.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17185.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17185.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_8&#45;&gt;reshape_concat_2_8 -->
<g id="edge964" class="edge">
<title>transpose_back_2_8&#45;&gt;reshape_concat_2_8</title>
<path fill="none" stroke="black" d="M17045.15,-4337.89C17067.8,-4325.5 17093.69,-4311.33 17117.01,-4298.57"/>
<polygon fill="black" stroke="black" points="17118.72,-4301.62 17125.81,-4293.75 17115.36,-4295.48 17118.72,-4301.62"/>
</g>
<!-- allgather_dim_2_2 -->
<g id="node803" class="node">
<title>allgather_dim_2_2</title>
<polygon fill="red" stroke="black" points="17545.57,-4185.55 17372.57,-4132.55 17545.57,-4079.55 17718.57,-4132.55 17545.57,-4185.55"/>
<text text-anchor="middle" x="17545.57" y="-4143.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="17545.57" y="-4128.85" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="17545.57" y="-4113.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_8&#45;&gt;allgather_dim_2_2 -->
<g id="edge965" class="edge">
<title>reshape_concat_2_8&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M17267.71,-4230.41C17324.03,-4210.78 17398.72,-4184.74 17456.47,-4164.61"/>
<polygon fill="black" stroke="black" points="17457.66,-4167.9 17465.95,-4161.3 17455.36,-4161.29 17457.66,-4167.9"/>
</g>
<!-- head_group_2_2 -->
<g id="node840" class="node">
<title>head_group_2_2</title>
<polygon fill="lightyellow" stroke="black" points="17469.07,-4042.55 17272.07,-4042.55 17272.07,-4004.55 17469.07,-4004.55 17469.07,-4042.55"/>
<text text-anchor="middle" x="17370.57" y="-4027.35" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="17370.57" y="-4012.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_2&#45;&gt;head_group_2_2 -->
<g id="edge1011" class="edge">
<title>allgather_dim_2_2&#45;&gt;head_group_2_2</title>
<path fill="none" stroke="black" d="M17488.76,-4096.81C17462.56,-4080.79 17432.17,-4062.2 17408.76,-4047.89"/>
<polygon fill="black" stroke="black" points="17410.51,-4044.86 17400.15,-4042.63 17406.86,-4050.83 17410.51,-4044.86"/>
</g>
<!-- split_q_2_9 -->
<g id="node805" class="node">
<title>split_q_2_9</title>
<ellipse fill="pink" stroke="black" cx="17045.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17045.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17045.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17045.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_q_2_9 -->
<g id="edge967" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_q_2_9</title>
<path fill="none" stroke="black" d="M17150.85,-5008.24C17135.31,-4997.15 17118,-4984.78 17101.97,-4973.33"/>
<polygon fill="black" stroke="black" points="17103.89,-4970.4 17093.72,-4967.44 17099.82,-4976.1 17103.89,-4970.4"/>
</g>
<!-- split_k_2_9 -->
<g id="node806" class="node">
<title>split_k_2_9</title>
<ellipse fill="pink" stroke="black" cx="17354.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17354.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17354.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17354.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_k_2_9 -->
<g id="edge968" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_k_2_9</title>
<path fill="none" stroke="black" d="M17248.62,-5008.24C17264.25,-4997.15 17281.68,-4984.78 17297.81,-4973.33"/>
<polygon fill="black" stroke="black" points="17299.99,-4976.08 17306.11,-4967.44 17295.93,-4970.37 17299.99,-4976.08"/>
</g>
<!-- split_v_2_9 -->
<g id="node807" class="node">
<title>split_v_2_9</title>
<ellipse fill="pink" stroke="black" cx="17663.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17663.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17663.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17663.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_v_2_9 -->
<g id="edge969" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_v_2_9</title>
<path fill="none" stroke="black" d="M17308.95,-5017.12C17380.85,-5000.07 17474.81,-4977.79 17547.95,-4960.46"/>
<polygon fill="black" stroke="black" points="17549.2,-4963.76 17558.13,-4958.04 17547.59,-4956.94 17549.2,-4963.76"/>
</g>
<!-- transpose_q_2_9 -->
<g id="node808" class="node">
<title>transpose_q_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="17045.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17045.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17045.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17045.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_9&#45;&gt;transpose_q_2_9 -->
<g id="edge970" class="edge">
<title>split_q_2_9&#45;&gt;transpose_q_2_9</title>
<path fill="none" stroke="black" d="M17045.57,-4894.42C17045.57,-4885.97 17045.57,-4876.87 17045.57,-4868.06"/>
<polygon fill="black" stroke="black" points="17049.07,-4867.89 17045.57,-4857.89 17042.07,-4867.89 17049.07,-4867.89"/>
</g>
<!-- transpose_k_2_9 -->
<g id="node809" class="node">
<title>transpose_k_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="17354.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17354.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17354.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17354.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_9&#45;&gt;transpose_k_2_9 -->
<g id="edge971" class="edge">
<title>split_k_2_9&#45;&gt;transpose_k_2_9</title>
<path fill="none" stroke="black" d="M17354.57,-4894.42C17354.57,-4885.97 17354.57,-4876.87 17354.57,-4868.06"/>
<polygon fill="black" stroke="black" points="17358.07,-4867.89 17354.57,-4857.89 17351.07,-4867.89 17358.07,-4867.89"/>
</g>
<!-- transpose_v_2_9 -->
<g id="node810" class="node">
<title>transpose_v_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="17663.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17663.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17663.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17663.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_9&#45;&gt;transpose_v_2_9 -->
<g id="edge972" class="edge">
<title>split_v_2_9&#45;&gt;transpose_v_2_9</title>
<path fill="none" stroke="black" d="M17663.57,-4894.42C17663.57,-4885.97 17663.57,-4876.87 17663.57,-4868.06"/>
<polygon fill="black" stroke="black" points="17667.07,-4867.89 17663.57,-4857.89 17660.07,-4867.89 17667.07,-4867.89"/>
</g>
<!-- attn_scores_2_9 -->
<g id="node811" class="node">
<title>attn_scores_2_9</title>
<ellipse fill="gold" stroke="black" cx="17354.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17354.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17354.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17354.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_9&#45;&gt;attn_scores_2_9 -->
<g id="edge973" class="edge">
<title>transpose_q_2_9&#45;&gt;attn_scores_2_9</title>
<path fill="none" stroke="black" d="M17129.19,-4789.28C17168.91,-4775.14 17216.6,-4758.16 17257.86,-4743.47"/>
<polygon fill="black" stroke="black" points="17259.13,-4746.74 17267.38,-4740.08 17256.79,-4740.14 17259.13,-4746.74"/>
</g>
<!-- transpose_k_2_9&#45;&gt;attn_scores_2_9 -->
<g id="edge974" class="edge">
<title>transpose_k_2_9&#45;&gt;attn_scores_2_9</title>
<path fill="none" stroke="black" d="M17354.57,-4782.42C17354.57,-4773.97 17354.57,-4764.87 17354.57,-4756.06"/>
<polygon fill="black" stroke="black" points="17358.07,-4755.89 17354.57,-4745.89 17351.07,-4755.89 17358.07,-4755.89"/>
</g>
<!-- attn_output_2_9 -->
<g id="node812" class="node">
<title>attn_output_2_9</title>
<ellipse fill="gold" stroke="black" cx="17545.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17545.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17545.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17545.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_9&#45;&gt;attn_output_2_9 -->
<g id="edge975" class="edge">
<title>transpose_v_2_9&#45;&gt;attn_output_2_9</title>
<path fill="none" stroke="black" d="M17650.72,-4782.67C17629.11,-4721.51 17585.56,-4598.22 17561.85,-4531.11"/>
<polygon fill="black" stroke="black" points="17565.13,-4529.9 17558.5,-4521.63 17558.53,-4532.23 17565.13,-4529.9"/>
</g>
<!-- softmax_2_9 -->
<g id="node813" class="node">
<title>softmax_2_9</title>
<ellipse fill="gold" stroke="black" cx="17354.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17354.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17354.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17354.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_9&#45;&gt;softmax_2_9 -->
<g id="edge976" class="edge">
<title>attn_scores_2_9&#45;&gt;softmax_2_9</title>
<path fill="none" stroke="black" d="M17354.57,-4670.42C17354.57,-4661.97 17354.57,-4652.87 17354.57,-4644.06"/>
<polygon fill="black" stroke="black" points="17358.07,-4643.89 17354.57,-4633.89 17351.07,-4643.89 17358.07,-4643.89"/>
</g>
<!-- transpose_back_2_9 -->
<g id="node814" class="node">
<title>transpose_back_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="17545.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17545.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17545.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17545.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_9&#45;&gt;transpose_back_2_9 -->
<g id="edge978" class="edge">
<title>attn_output_2_9&#45;&gt;transpose_back_2_9</title>
<path fill="none" stroke="black" d="M17545.57,-4446.42C17545.57,-4437.97 17545.57,-4428.87 17545.57,-4420.06"/>
<polygon fill="black" stroke="black" points="17549.07,-4419.89 17545.57,-4409.89 17542.07,-4419.89 17549.07,-4419.89"/>
</g>
<!-- softmax_2_9&#45;&gt;attn_output_2_9 -->
<g id="edge977" class="edge">
<title>softmax_2_9&#45;&gt;attn_output_2_9</title>
<path fill="none" stroke="black" d="M17413.96,-4560.84C17434.47,-4549.03 17457.58,-4535.72 17478.64,-4523.59"/>
<polygon fill="black" stroke="black" points="17480.61,-4526.5 17487.53,-4518.47 17477.12,-4520.43 17480.61,-4526.5"/>
</g>
<!-- reshape_concat_2_9 -->
<g id="node815" class="node">
<title>reshape_concat_2_9</title>
<ellipse fill="lightcyan" stroke="black" cx="17545.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17545.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17545.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17545.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_9&#45;&gt;reshape_concat_2_9 -->
<g id="edge979" class="edge">
<title>transpose_back_2_9&#45;&gt;reshape_concat_2_9</title>
<path fill="none" stroke="black" d="M17545.57,-4334.42C17545.57,-4325.97 17545.57,-4316.87 17545.57,-4308.06"/>
<polygon fill="black" stroke="black" points="17549.07,-4307.89 17545.57,-4297.89 17542.07,-4307.89 17549.07,-4307.89"/>
</g>
<!-- reshape_concat_2_9&#45;&gt;allgather_dim_2_2 -->
<g id="edge980" class="edge">
<title>reshape_concat_2_9&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M17545.57,-4222.41C17545.57,-4214.1 17545.57,-4205.05 17545.57,-4196.01"/>
<polygon fill="black" stroke="black" points="17549.07,-4195.85 17545.57,-4185.85 17542.07,-4195.85 17549.07,-4195.85"/>
</g>
<!-- split_q_2_10 -->
<g id="node817" class="node">
<title>split_q_2_10</title>
<ellipse fill="pink" stroke="black" cx="17972.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17972.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17972.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17972.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_q_2_10 -->
<g id="edge982" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_q_2_10</title>
<path fill="none" stroke="black" d="M18029.07,-5007.03C18021.82,-4997.53 18013.91,-4987.17 18006.37,-4977.3"/>
<polygon fill="black" stroke="black" points="18008.99,-4974.97 18000.14,-4969.14 18003.43,-4979.22 18008.99,-4974.97"/>
</g>
<!-- split_k_2_10 -->
<g id="node818" class="node">
<title>split_k_2_10</title>
<ellipse fill="pink" stroke="black" cx="18281.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18281.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18281.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18281.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_k_2_10 -->
<g id="edge983" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_k_2_10</title>
<path fill="none" stroke="black" d="M18124.08,-5010.04C18149.9,-4997.42 18179.51,-4982.94 18206.03,-4969.98"/>
<polygon fill="black" stroke="black" points="18207.83,-4972.99 18215.28,-4965.46 18204.75,-4966.71 18207.83,-4972.99"/>
</g>
<!-- split_v_2_10 -->
<g id="node819" class="node">
<title>split_v_2_10</title>
<ellipse fill="pink" stroke="black" cx="18590.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18590.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18590.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18590.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_v_2_10 -->
<g id="edge984" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_v_2_10</title>
<path fill="none" stroke="black" d="M18179.2,-5020.67C18253.77,-5006.73 18350.85,-4987.99 18436.57,-4969.55 18449.54,-4966.76 18463.1,-4963.72 18476.56,-4960.63"/>
<polygon fill="black" stroke="black" points="18477.37,-4964.03 18486.33,-4958.37 18475.8,-4957.21 18477.37,-4964.03"/>
</g>
<!-- transpose_q_2_10 -->
<g id="node820" class="node">
<title>transpose_q_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="17972.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17972.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17972.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17972.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_10&#45;&gt;transpose_q_2_10 -->
<g id="edge985" class="edge">
<title>split_q_2_10&#45;&gt;transpose_q_2_10</title>
<path fill="none" stroke="black" d="M17972.57,-4894.42C17972.57,-4885.97 17972.57,-4876.87 17972.57,-4868.06"/>
<polygon fill="black" stroke="black" points="17976.07,-4867.89 17972.57,-4857.89 17969.07,-4867.89 17976.07,-4867.89"/>
</g>
<!-- transpose_k_2_10 -->
<g id="node821" class="node">
<title>transpose_k_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="18281.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18281.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18281.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18281.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_10&#45;&gt;transpose_k_2_10 -->
<g id="edge986" class="edge">
<title>split_k_2_10&#45;&gt;transpose_k_2_10</title>
<path fill="none" stroke="black" d="M18281.57,-4894.42C18281.57,-4885.97 18281.57,-4876.87 18281.57,-4868.06"/>
<polygon fill="black" stroke="black" points="18285.07,-4867.89 18281.57,-4857.89 18278.07,-4867.89 18285.07,-4867.89"/>
</g>
<!-- transpose_v_2_10 -->
<g id="node822" class="node">
<title>transpose_v_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="18590.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18590.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18590.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18590.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_10&#45;&gt;transpose_v_2_10 -->
<g id="edge987" class="edge">
<title>split_v_2_10&#45;&gt;transpose_v_2_10</title>
<path fill="none" stroke="black" d="M18590.57,-4894.42C18590.57,-4885.97 18590.57,-4876.87 18590.57,-4868.06"/>
<polygon fill="black" stroke="black" points="18594.07,-4867.89 18590.57,-4857.89 18587.07,-4867.89 18594.07,-4867.89"/>
</g>
<!-- attn_scores_2_10 -->
<g id="node823" class="node">
<title>attn_scores_2_10</title>
<ellipse fill="gold" stroke="black" cx="18135.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18135.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="18135.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18135.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_10&#45;&gt;attn_scores_2_10 -->
<g id="edge988" class="edge">
<title>transpose_q_2_10&#45;&gt;attn_scores_2_10</title>
<path fill="none" stroke="black" d="M18023.25,-4784.84C18039.88,-4773.62 18058.51,-4761.05 18075.75,-4749.42"/>
<polygon fill="black" stroke="black" points="18077.75,-4752.29 18084.08,-4743.79 18073.83,-4746.49 18077.75,-4752.29"/>
</g>
<!-- transpose_k_2_10&#45;&gt;attn_scores_2_10 -->
<g id="edge989" class="edge">
<title>transpose_k_2_10&#45;&gt;attn_scores_2_10</title>
<path fill="none" stroke="black" d="M18235.38,-4784.24C18221.07,-4773.46 18205.16,-4761.48 18190.33,-4750.3"/>
<polygon fill="black" stroke="black" points="18192.31,-4747.41 18182.22,-4744.19 18188.1,-4753 18192.31,-4747.41"/>
</g>
<!-- attn_output_2_10 -->
<g id="node824" class="node">
<title>attn_output_2_10</title>
<ellipse fill="gold" stroke="black" cx="18135.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18135.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18135.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18135.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_10&#45;&gt;attn_output_2_10 -->
<g id="edge990" class="edge">
<title>transpose_v_2_10&#45;&gt;attn_output_2_10</title>
<path fill="none" stroke="black" d="M18559.91,-4783.18C18511.71,-4728.61 18413.17,-4624.15 18311.57,-4558.55 18287.06,-4542.72 18258.58,-4529.08 18231.75,-4518"/>
<polygon fill="black" stroke="black" points="18232.92,-4514.7 18222.34,-4514.18 18230.3,-4521.18 18232.92,-4514.7"/>
</g>
<!-- softmax_2_10 -->
<g id="node825" class="node">
<title>softmax_2_10</title>
<ellipse fill="gold" stroke="black" cx="18135.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18135.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="18135.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18135.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_10&#45;&gt;softmax_2_10 -->
<g id="edge991" class="edge">
<title>attn_scores_2_10&#45;&gt;softmax_2_10</title>
<path fill="none" stroke="black" d="M18135.57,-4670.42C18135.57,-4661.97 18135.57,-4652.87 18135.57,-4644.06"/>
<polygon fill="black" stroke="black" points="18139.07,-4643.89 18135.57,-4633.89 18132.07,-4643.89 18139.07,-4643.89"/>
</g>
<!-- transpose_back_2_10 -->
<g id="node826" class="node">
<title>transpose_back_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="18041.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18041.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="18041.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18041.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_10&#45;&gt;transpose_back_2_10 -->
<g id="edge993" class="edge">
<title>attn_output_2_10&#45;&gt;transpose_back_2_10</title>
<path fill="none" stroke="black" d="M18105.05,-4447.33C18096.68,-4437.53 18087.51,-4426.8 18078.81,-4416.61"/>
<polygon fill="black" stroke="black" points="18081.42,-4414.29 18072.26,-4408.96 18076.1,-4418.83 18081.42,-4414.29"/>
</g>
<!-- softmax_2_10&#45;&gt;attn_output_2_10 -->
<g id="edge992" class="edge">
<title>softmax_2_10&#45;&gt;attn_output_2_10</title>
<path fill="none" stroke="black" d="M18135.57,-4558.42C18135.57,-4549.97 18135.57,-4540.87 18135.57,-4532.06"/>
<polygon fill="black" stroke="black" points="18139.07,-4531.89 18135.57,-4521.89 18132.07,-4531.89 18139.07,-4531.89"/>
</g>
<!-- reshape_concat_2_10 -->
<g id="node827" class="node">
<title>reshape_concat_2_10</title>
<ellipse fill="lightcyan" stroke="black" cx="17852.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17852.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17852.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17852.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_10&#45;&gt;reshape_concat_2_10 -->
<g id="edge994" class="edge">
<title>transpose_back_2_10&#45;&gt;reshape_concat_2_10</title>
<path fill="none" stroke="black" d="M17983.84,-4337.44C17963.04,-4325.34 17939.43,-4311.59 17918.01,-4299.13"/>
<polygon fill="black" stroke="black" points="17919.71,-4296.07 17909.3,-4294.06 17916.19,-4302.12 17919.71,-4296.07"/>
</g>
<!-- reshape_concat_2_10&#45;&gt;allgather_dim_2_2 -->
<g id="edge995" class="edge">
<title>reshape_concat_2_10&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M17778.65,-4228.83C17733.17,-4210.23 17674.8,-4186.37 17627.86,-4167.18"/>
<polygon fill="black" stroke="black" points="17628.91,-4163.83 17618.33,-4163.29 17626.26,-4170.31 17628.91,-4163.83"/>
</g>
<!-- split_q_2_11 -->
<g id="node829" class="node">
<title>split_q_2_11</title>
<ellipse fill="pink" stroke="black" cx="18899.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18899.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18899.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18899.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_q_2_11 -->
<g id="edge997" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_q_2_11</title>
<path fill="none" stroke="black" d="M19005.53,-5008.24C18989.9,-4997.15 18972.47,-4984.78 18956.33,-4973.33"/>
<polygon fill="black" stroke="black" points="18958.21,-4970.37 18948.03,-4967.44 18954.16,-4976.08 18958.21,-4970.37"/>
</g>
<!-- split_k_2_11 -->
<g id="node830" class="node">
<title>split_k_2_11</title>
<ellipse fill="pink" stroke="black" cx="19208.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19208.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19208.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19208.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_k_2_11 -->
<g id="edge998" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_k_2_11</title>
<path fill="none" stroke="black" d="M19103.3,-5008.24C19118.83,-4997.15 19136.15,-4984.78 19152.18,-4973.33"/>
<polygon fill="black" stroke="black" points="19154.32,-4976.1 19160.43,-4967.44 19150.26,-4970.4 19154.32,-4976.1"/>
</g>
<!-- split_v_2_11 -->
<g id="node831" class="node">
<title>split_v_2_11</title>
<ellipse fill="pink" stroke="black" cx="19517.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19517.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19517.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19517.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_v_2_11 -->
<g id="edge999" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_v_2_11</title>
<path fill="none" stroke="black" d="M19163.71,-5017.12C19235.46,-5000.07 19329.22,-4977.79 19402.2,-4960.46"/>
<polygon fill="black" stroke="black" points="19403.43,-4963.76 19412.35,-4958.04 19401.82,-4956.95 19403.43,-4963.76"/>
</g>
<!-- transpose_q_2_11 -->
<g id="node832" class="node">
<title>transpose_q_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18899.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18899.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18899.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18899.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_11&#45;&gt;transpose_q_2_11 -->
<g id="edge1000" class="edge">
<title>split_q_2_11&#45;&gt;transpose_q_2_11</title>
<path fill="none" stroke="black" d="M18899.57,-4894.42C18899.57,-4885.97 18899.57,-4876.87 18899.57,-4868.06"/>
<polygon fill="black" stroke="black" points="18903.07,-4867.89 18899.57,-4857.89 18896.07,-4867.89 18903.07,-4867.89"/>
</g>
<!-- transpose_k_2_11 -->
<g id="node833" class="node">
<title>transpose_k_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="19208.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19208.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19208.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19208.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_11&#45;&gt;transpose_k_2_11 -->
<g id="edge1001" class="edge">
<title>split_k_2_11&#45;&gt;transpose_k_2_11</title>
<path fill="none" stroke="black" d="M19208.57,-4894.42C19208.57,-4885.97 19208.57,-4876.87 19208.57,-4868.06"/>
<polygon fill="black" stroke="black" points="19212.07,-4867.89 19208.57,-4857.89 19205.07,-4867.89 19212.07,-4867.89"/>
</g>
<!-- transpose_v_2_11 -->
<g id="node834" class="node">
<title>transpose_v_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="19517.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19517.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19517.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19517.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_11&#45;&gt;transpose_v_2_11 -->
<g id="edge1002" class="edge">
<title>split_v_2_11&#45;&gt;transpose_v_2_11</title>
<path fill="none" stroke="black" d="M19517.57,-4894.42C19517.57,-4885.97 19517.57,-4876.87 19517.57,-4868.06"/>
<polygon fill="black" stroke="black" points="19521.07,-4867.89 19517.57,-4857.89 19514.07,-4867.89 19521.07,-4867.89"/>
</g>
<!-- attn_scores_2_11 -->
<g id="node835" class="node">
<title>attn_scores_2_11</title>
<ellipse fill="gold" stroke="black" cx="19053.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19053.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19053.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19053.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_11&#45;&gt;attn_scores_2_11 -->
<g id="edge1003" class="edge">
<title>transpose_q_2_11&#45;&gt;attn_scores_2_11</title>
<path fill="none" stroke="black" d="M18947.88,-4784.54C18963.28,-4773.54 18980.46,-4761.27 18996.43,-4749.87"/>
<polygon fill="black" stroke="black" points="18998.54,-4752.65 19004.65,-4743.99 18994.47,-4746.96 18998.54,-4752.65"/>
</g>
<!-- transpose_k_2_11&#45;&gt;attn_scores_2_11 -->
<g id="edge1004" class="edge">
<title>transpose_k_2_11&#45;&gt;attn_scores_2_11</title>
<path fill="none" stroke="black" d="M19159.96,-4784.54C19144.46,-4773.54 19127.16,-4761.27 19111.09,-4749.87"/>
<polygon fill="black" stroke="black" points="19113,-4746.93 19102.82,-4743.99 19108.95,-4752.64 19113,-4746.93"/>
</g>
<!-- attn_output_2_11 -->
<g id="node836" class="node">
<title>attn_output_2_11</title>
<ellipse fill="gold" stroke="black" cx="19053.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19053.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19053.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19053.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_11&#45;&gt;attn_output_2_11 -->
<g id="edge1005" class="edge">
<title>transpose_v_2_11&#45;&gt;attn_output_2_11</title>
<path fill="none" stroke="black" d="M19485.68,-4783.26C19435.59,-4728.79 19333.46,-4624.47 19229.57,-4558.55 19204.94,-4542.91 19176.41,-4529.33 19149.59,-4518.25"/>
<polygon fill="black" stroke="black" points="19150.77,-4514.95 19140.18,-4514.43 19148.13,-4521.43 19150.77,-4514.95"/>
</g>
<!-- softmax_2_11 -->
<g id="node837" class="node">
<title>softmax_2_11</title>
<ellipse fill="gold" stroke="black" cx="19053.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19053.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19053.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19053.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_11&#45;&gt;softmax_2_11 -->
<g id="edge1006" class="edge">
<title>attn_scores_2_11&#45;&gt;softmax_2_11</title>
<path fill="none" stroke="black" d="M19053.57,-4670.42C19053.57,-4661.97 19053.57,-4652.87 19053.57,-4644.06"/>
<polygon fill="black" stroke="black" points="19057.07,-4643.89 19053.57,-4633.89 19050.07,-4643.89 19057.07,-4643.89"/>
</g>
<!-- transpose_back_2_11 -->
<g id="node838" class="node">
<title>transpose_back_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18580.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18580.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="18580.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18580.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_11&#45;&gt;transpose_back_2_11 -->
<g id="edge1008" class="edge">
<title>attn_output_2_11&#45;&gt;transpose_back_2_11</title>
<path fill="none" stroke="black" d="M18947.42,-4458.36C18873,-4441.05 18773.54,-4417.92 18696.95,-4400.11"/>
<polygon fill="black" stroke="black" points="18697.31,-4396.6 18686.78,-4397.74 18695.73,-4403.42 18697.31,-4396.6"/>
</g>
<!-- softmax_2_11&#45;&gt;attn_output_2_11 -->
<g id="edge1007" class="edge">
<title>softmax_2_11&#45;&gt;attn_output_2_11</title>
<path fill="none" stroke="black" d="M19053.57,-4558.42C19053.57,-4549.97 19053.57,-4540.87 19053.57,-4532.06"/>
<polygon fill="black" stroke="black" points="19057.07,-4531.89 19053.57,-4521.89 19050.07,-4531.89 19057.07,-4531.89"/>
</g>
<!-- reshape_concat_2_11 -->
<g id="node839" class="node">
<title>reshape_concat_2_11</title>
<ellipse fill="lightcyan" stroke="black" cx="18319.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="18319.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="18319.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18319.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_11&#45;&gt;reshape_concat_2_11 -->
<g id="edge1009" class="edge">
<title>transpose_back_2_11&#45;&gt;reshape_concat_2_11</title>
<path fill="none" stroke="black" d="M18506.13,-4339.67C18473.49,-4325.91 18435.07,-4309.72 18401.61,-4295.62"/>
<polygon fill="black" stroke="black" points="18402.89,-4292.36 18392.31,-4291.7 18400.17,-4298.81 18402.89,-4292.36"/>
</g>
<!-- reshape_concat_2_11&#45;&gt;allgather_dim_2_2 -->
<g id="edge1010" class="edge">
<title>reshape_concat_2_11&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M18205.78,-4240.59C18061.6,-4217.22 17814.17,-4177.1 17666.62,-4153.17"/>
<polygon fill="black" stroke="black" points="17667.04,-4149.7 17656.61,-4151.55 17665.92,-4156.61 17667.04,-4149.7"/>
</g>
<!-- output_proj_2_2 -->
<g id="node893" class="node">
<title>output_proj_2_2</title>
<ellipse fill="orange" stroke="black" cx="16885.57" cy="-3919.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16885.57" y="-3938.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16885.57" y="-3923.26" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16885.57" y="-3908.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16885.57" y="-3893.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_2&#45;&gt;output_proj_2_2 -->
<g id="edge1075" class="edge">
<title>head_group_2_2&#45;&gt;output_proj_2_2</title>
<path fill="none" stroke="black" d="M17284.98,-4004.53C17209.7,-3988.68 17099.06,-3965.4 17013.31,-3947.35"/>
<polygon fill="black" stroke="black" points="17014.02,-3943.92 17003.51,-3945.29 17012.57,-3950.77 17014.02,-3943.92"/>
</g>
<!-- split_q_2_12 -->
<g id="node842" class="node">
<title>split_q_2_12</title>
<ellipse fill="pink" stroke="black" cx="19826.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19826.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19826.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19826.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_q_2_12 -->
<g id="edge1013" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_q_2_12</title>
<path fill="none" stroke="black" d="M19883.07,-5007.03C19875.82,-4997.53 19867.91,-4987.17 19860.37,-4977.3"/>
<polygon fill="black" stroke="black" points="19862.99,-4974.97 19854.14,-4969.14 19857.43,-4979.22 19862.99,-4974.97"/>
</g>
<!-- split_k_2_12 -->
<g id="node843" class="node">
<title>split_k_2_12</title>
<ellipse fill="pink" stroke="black" cx="20135.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20135.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20135.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20135.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_k_2_12 -->
<g id="edge1014" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_k_2_12</title>
<path fill="none" stroke="black" d="M19978.08,-5010.04C20003.9,-4997.42 20033.51,-4982.94 20060.03,-4969.98"/>
<polygon fill="black" stroke="black" points="20061.83,-4972.99 20069.28,-4965.46 20058.75,-4966.71 20061.83,-4972.99"/>
</g>
<!-- split_v_2_12 -->
<g id="node844" class="node">
<title>split_v_2_12</title>
<ellipse fill="pink" stroke="black" cx="20444.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20444.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20444.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20444.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_v_2_12 -->
<g id="edge1015" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_v_2_12</title>
<path fill="none" stroke="black" d="M20033.2,-5020.67C20107.77,-5006.73 20204.85,-4987.99 20290.57,-4969.55 20303.54,-4966.76 20317.1,-4963.72 20330.56,-4960.63"/>
<polygon fill="black" stroke="black" points="20331.37,-4964.03 20340.33,-4958.37 20329.8,-4957.21 20331.37,-4964.03"/>
</g>
<!-- transpose_q_2_12 -->
<g id="node845" class="node">
<title>transpose_q_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="19826.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19826.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19826.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19826.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_12&#45;&gt;transpose_q_2_12 -->
<g id="edge1016" class="edge">
<title>split_q_2_12&#45;&gt;transpose_q_2_12</title>
<path fill="none" stroke="black" d="M19826.57,-4894.42C19826.57,-4885.97 19826.57,-4876.87 19826.57,-4868.06"/>
<polygon fill="black" stroke="black" points="19830.07,-4867.89 19826.57,-4857.89 19823.07,-4867.89 19830.07,-4867.89"/>
</g>
<!-- transpose_k_2_12 -->
<g id="node846" class="node">
<title>transpose_k_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="20135.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20135.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20135.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20135.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_12&#45;&gt;transpose_k_2_12 -->
<g id="edge1017" class="edge">
<title>split_k_2_12&#45;&gt;transpose_k_2_12</title>
<path fill="none" stroke="black" d="M20135.57,-4894.42C20135.57,-4885.97 20135.57,-4876.87 20135.57,-4868.06"/>
<polygon fill="black" stroke="black" points="20139.07,-4867.89 20135.57,-4857.89 20132.07,-4867.89 20139.07,-4867.89"/>
</g>
<!-- transpose_v_2_12 -->
<g id="node847" class="node">
<title>transpose_v_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="20444.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20444.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20444.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20444.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_12&#45;&gt;transpose_v_2_12 -->
<g id="edge1018" class="edge">
<title>split_v_2_12&#45;&gt;transpose_v_2_12</title>
<path fill="none" stroke="black" d="M20444.57,-4894.42C20444.57,-4885.97 20444.57,-4876.87 20444.57,-4868.06"/>
<polygon fill="black" stroke="black" points="20448.07,-4867.89 20444.57,-4857.89 20441.07,-4867.89 20448.07,-4867.89"/>
</g>
<!-- attn_scores_2_12 -->
<g id="node848" class="node">
<title>attn_scores_2_12</title>
<ellipse fill="gold" stroke="black" cx="20135.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20135.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20135.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20135.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_12&#45;&gt;attn_scores_2_12 -->
<g id="edge1019" class="edge">
<title>transpose_q_2_12&#45;&gt;attn_scores_2_12</title>
<path fill="none" stroke="black" d="M19910.19,-4789.28C19949.91,-4775.14 19997.6,-4758.16 20038.86,-4743.47"/>
<polygon fill="black" stroke="black" points="20040.13,-4746.74 20048.38,-4740.08 20037.79,-4740.14 20040.13,-4746.74"/>
</g>
<!-- transpose_k_2_12&#45;&gt;attn_scores_2_12 -->
<g id="edge1020" class="edge">
<title>transpose_k_2_12&#45;&gt;attn_scores_2_12</title>
<path fill="none" stroke="black" d="M20135.57,-4782.42C20135.57,-4773.97 20135.57,-4764.87 20135.57,-4756.06"/>
<polygon fill="black" stroke="black" points="20139.07,-4755.89 20135.57,-4745.89 20132.07,-4755.89 20139.07,-4755.89"/>
</g>
<!-- attn_output_2_12 -->
<g id="node849" class="node">
<title>attn_output_2_12</title>
<ellipse fill="gold" stroke="black" cx="20444.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20444.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20444.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20444.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_12&#45;&gt;attn_output_2_12 -->
<g id="edge1021" class="edge">
<title>transpose_v_2_12&#45;&gt;attn_output_2_12</title>
<path fill="none" stroke="black" d="M20444.57,-4782.35C20444.57,-4721.3 20444.57,-4598.99 20444.57,-4531.84"/>
<polygon fill="black" stroke="black" points="20448.07,-4531.55 20444.57,-4521.55 20441.07,-4531.55 20448.07,-4531.55"/>
</g>
<!-- softmax_2_12 -->
<g id="node850" class="node">
<title>softmax_2_12</title>
<ellipse fill="gold" stroke="black" cx="20221.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20221.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20221.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20221.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_12&#45;&gt;softmax_2_12 -->
<g id="edge1022" class="edge">
<title>attn_scores_2_12&#45;&gt;softmax_2_12</title>
<path fill="none" stroke="black" d="M20163.73,-4671.03C20171.16,-4661.53 20179.25,-4651.17 20186.98,-4641.3"/>
<polygon fill="black" stroke="black" points="20189.95,-4643.18 20193.35,-4633.14 20184.43,-4638.87 20189.95,-4643.18"/>
</g>
<!-- transpose_back_2_12 -->
<g id="node851" class="node">
<title>transpose_back_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="20745.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20745.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20745.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20745.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_12&#45;&gt;transpose_back_2_12 -->
<g id="edge1024" class="edge">
<title>attn_output_2_12&#45;&gt;transpose_back_2_12</title>
<path fill="none" stroke="black" d="M20526.82,-4452.99C20566.14,-4438.62 20613.35,-4421.37 20653.83,-4406.57"/>
<polygon fill="black" stroke="black" points="20655.23,-4409.79 20663.42,-4403.07 20652.83,-4403.21 20655.23,-4409.79"/>
</g>
<!-- softmax_2_12&#45;&gt;attn_output_2_12 -->
<g id="edge1023" class="edge">
<title>softmax_2_12&#45;&gt;attn_output_2_12</title>
<path fill="none" stroke="black" d="M20289.09,-4561.74C20314.43,-4549.24 20343.38,-4534.96 20369.38,-4522.14"/>
<polygon fill="black" stroke="black" points="20371.02,-4525.23 20378.44,-4517.67 20367.92,-4518.95 20371.02,-4525.23"/>
</g>
<!-- reshape_concat_2_12 -->
<g id="node852" class="node">
<title>reshape_concat_2_12</title>
<ellipse fill="lightcyan" stroke="black" cx="20988.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20988.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20988.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20988.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_12&#45;&gt;reshape_concat_2_12 -->
<g id="edge1025" class="edge">
<title>transpose_back_2_12&#45;&gt;reshape_concat_2_12</title>
<path fill="none" stroke="black" d="M20816.19,-4339.08C20845.65,-4325.74 20879.98,-4310.2 20910.22,-4296.51"/>
<polygon fill="black" stroke="black" points="20911.8,-4299.64 20919.46,-4292.33 20908.91,-4293.27 20911.8,-4299.64"/>
</g>
<!-- allgather_dim_2_3 -->
<g id="node853" class="node">
<title>allgather_dim_2_3</title>
<polygon fill="red" stroke="black" points="21284.57,-4185.55 21111.57,-4132.55 21284.57,-4079.55 21457.57,-4132.55 21284.57,-4185.55"/>
<text text-anchor="middle" x="21284.57" y="-4143.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="21284.57" y="-4128.85" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="21284.57" y="-4113.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_12&#45;&gt;allgather_dim_2_3 -->
<g id="edge1026" class="edge">
<title>reshape_concat_2_12&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M21060.6,-4228.51C21103.9,-4210.15 21159.1,-4186.75 21203.86,-4167.77"/>
<polygon fill="black" stroke="black" points="21205.4,-4170.91 21213.25,-4163.79 21202.67,-4164.47 21205.4,-4170.91"/>
</g>
<!-- head_group_2_3 -->
<g id="node890" class="node">
<title>head_group_2_3</title>
<polygon fill="lightyellow" stroke="black" points="17821.07,-4042.55 17624.07,-4042.55 17624.07,-4004.55 17821.07,-4004.55 17821.07,-4042.55"/>
<text text-anchor="middle" x="17722.57" y="-4027.35" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="17722.57" y="-4012.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_3&#45;&gt;head_group_2_3 -->
<g id="edge1072" class="edge">
<title>allgather_dim_2_3&#45;&gt;head_group_2_3</title>
<path fill="none" stroke="black" d="M21129.8,-4126.9C20527.06,-4108.79 18344.72,-4043.23 17831.28,-4027.81"/>
<polygon fill="black" stroke="black" points="17831.38,-4024.31 17821.28,-4027.51 17831.17,-4031.31 17831.38,-4024.31"/>
</g>
<!-- split_q_2_13 -->
<g id="node855" class="node">
<title>split_q_2_13</title>
<ellipse fill="pink" stroke="black" cx="20753.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20753.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20753.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20753.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_q_2_13 -->
<g id="edge1028" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_q_2_13</title>
<path fill="none" stroke="black" d="M20859.53,-5008.24C20843.9,-4997.15 20826.47,-4984.78 20810.33,-4973.33"/>
<polygon fill="black" stroke="black" points="20812.21,-4970.37 20802.03,-4967.44 20808.16,-4976.08 20812.21,-4970.37"/>
</g>
<!-- split_k_2_13 -->
<g id="node856" class="node">
<title>split_k_2_13</title>
<ellipse fill="pink" stroke="black" cx="21062.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21062.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21062.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21062.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_k_2_13 -->
<g id="edge1029" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_k_2_13</title>
<path fill="none" stroke="black" d="M20957.3,-5008.24C20972.83,-4997.15 20990.15,-4984.78 21006.18,-4973.33"/>
<polygon fill="black" stroke="black" points="21008.32,-4976.1 21014.43,-4967.44 21004.26,-4970.4 21008.32,-4976.1"/>
</g>
<!-- split_v_2_13 -->
<g id="node857" class="node">
<title>split_v_2_13</title>
<ellipse fill="pink" stroke="black" cx="21371.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21371.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21371.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21371.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_v_2_13 -->
<g id="edge1030" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_v_2_13</title>
<path fill="none" stroke="black" d="M21017.71,-5017.12C21089.46,-5000.07 21183.22,-4977.79 21256.2,-4960.46"/>
<polygon fill="black" stroke="black" points="21257.43,-4963.76 21266.35,-4958.04 21255.82,-4956.95 21257.43,-4963.76"/>
</g>
<!-- transpose_q_2_13 -->
<g id="node858" class="node">
<title>transpose_q_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="20753.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20753.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20753.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20753.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_13&#45;&gt;transpose_q_2_13 -->
<g id="edge1031" class="edge">
<title>split_q_2_13&#45;&gt;transpose_q_2_13</title>
<path fill="none" stroke="black" d="M20753.57,-4894.42C20753.57,-4885.97 20753.57,-4876.87 20753.57,-4868.06"/>
<polygon fill="black" stroke="black" points="20757.07,-4867.89 20753.57,-4857.89 20750.07,-4867.89 20757.07,-4867.89"/>
</g>
<!-- transpose_k_2_13 -->
<g id="node859" class="node">
<title>transpose_k_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="21062.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21062.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21062.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21062.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_13&#45;&gt;transpose_k_2_13 -->
<g id="edge1032" class="edge">
<title>split_k_2_13&#45;&gt;transpose_k_2_13</title>
<path fill="none" stroke="black" d="M21062.57,-4894.42C21062.57,-4885.97 21062.57,-4876.87 21062.57,-4868.06"/>
<polygon fill="black" stroke="black" points="21066.07,-4867.89 21062.57,-4857.89 21059.07,-4867.89 21066.07,-4867.89"/>
</g>
<!-- transpose_v_2_13 -->
<g id="node860" class="node">
<title>transpose_v_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="21371.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21371.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21371.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21371.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_13&#45;&gt;transpose_v_2_13 -->
<g id="edge1033" class="edge">
<title>split_v_2_13&#45;&gt;transpose_v_2_13</title>
<path fill="none" stroke="black" d="M21371.57,-4894.42C21371.57,-4885.97 21371.57,-4876.87 21371.57,-4868.06"/>
<polygon fill="black" stroke="black" points="21375.07,-4867.89 21371.57,-4857.89 21368.07,-4867.89 21375.07,-4867.89"/>
</g>
<!-- attn_scores_2_13 -->
<g id="node861" class="node">
<title>attn_scores_2_13</title>
<ellipse fill="gold" stroke="black" cx="21062.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21062.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21062.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21062.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_13&#45;&gt;attn_scores_2_13 -->
<g id="edge1034" class="edge">
<title>transpose_q_2_13&#45;&gt;attn_scores_2_13</title>
<path fill="none" stroke="black" d="M20837.19,-4789.28C20876.91,-4775.14 20924.6,-4758.16 20965.86,-4743.47"/>
<polygon fill="black" stroke="black" points="20967.13,-4746.74 20975.38,-4740.08 20964.79,-4740.14 20967.13,-4746.74"/>
</g>
<!-- transpose_k_2_13&#45;&gt;attn_scores_2_13 -->
<g id="edge1035" class="edge">
<title>transpose_k_2_13&#45;&gt;attn_scores_2_13</title>
<path fill="none" stroke="black" d="M21062.57,-4782.42C21062.57,-4773.97 21062.57,-4764.87 21062.57,-4756.06"/>
<polygon fill="black" stroke="black" points="21066.07,-4755.89 21062.57,-4745.89 21059.07,-4755.89 21066.07,-4755.89"/>
</g>
<!-- attn_output_2_13 -->
<g id="node862" class="node">
<title>attn_output_2_13</title>
<ellipse fill="gold" stroke="black" cx="21284.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21284.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21284.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21284.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_13&#45;&gt;attn_output_2_13 -->
<g id="edge1036" class="edge">
<title>transpose_v_2_13&#45;&gt;attn_output_2_13</title>
<path fill="none" stroke="black" d="M21362.3,-4782.33C21349.52,-4731.86 21325.66,-4638.22 21304.57,-4558.55 21302.26,-4549.81 21299.76,-4540.51 21297.34,-4531.56"/>
<polygon fill="black" stroke="black" points="21300.64,-4530.39 21294.64,-4521.66 21293.89,-4532.22 21300.64,-4530.39"/>
</g>
<!-- softmax_2_13 -->
<g id="node863" class="node">
<title>softmax_2_13</title>
<ellipse fill="gold" stroke="black" cx="21128.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21128.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21128.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21128.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_13&#45;&gt;softmax_2_13 -->
<g id="edge1037" class="edge">
<title>attn_scores_2_13&#45;&gt;softmax_2_13</title>
<path fill="none" stroke="black" d="M21084.37,-4670.72C21089.89,-4661.52 21095.88,-4651.53 21101.62,-4641.96"/>
<polygon fill="black" stroke="black" points="21104.66,-4643.71 21106.8,-4633.33 21098.66,-4640.1 21104.66,-4643.71"/>
</g>
<!-- transpose_back_2_13 -->
<g id="node864" class="node">
<title>transpose_back_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="21284.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21284.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21284.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21284.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_13&#45;&gt;transpose_back_2_13 -->
<g id="edge1039" class="edge">
<title>attn_output_2_13&#45;&gt;transpose_back_2_13</title>
<path fill="none" stroke="black" d="M21284.57,-4446.42C21284.57,-4437.97 21284.57,-4428.87 21284.57,-4420.06"/>
<polygon fill="black" stroke="black" points="21288.07,-4419.89 21284.57,-4409.89 21281.07,-4419.89 21288.07,-4419.89"/>
</g>
<!-- softmax_2_13&#45;&gt;attn_output_2_13 -->
<g id="edge1038" class="edge">
<title>softmax_2_13&#45;&gt;attn_output_2_13</title>
<path fill="none" stroke="black" d="M21178.36,-4559.94C21194,-4548.91 21211.4,-4536.65 21227.5,-4525.29"/>
<polygon fill="black" stroke="black" points="21229.64,-4528.07 21235.79,-4519.44 21225.6,-4522.35 21229.64,-4528.07"/>
</g>
<!-- reshape_concat_2_13 -->
<g id="node865" class="node">
<title>reshape_concat_2_13</title>
<ellipse fill="lightcyan" stroke="black" cx="21284.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21284.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21284.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21284.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_13&#45;&gt;reshape_concat_2_13 -->
<g id="edge1040" class="edge">
<title>transpose_back_2_13&#45;&gt;reshape_concat_2_13</title>
<path fill="none" stroke="black" d="M21284.57,-4334.42C21284.57,-4325.97 21284.57,-4316.87 21284.57,-4308.06"/>
<polygon fill="black" stroke="black" points="21288.07,-4307.89 21284.57,-4297.89 21281.07,-4307.89 21288.07,-4307.89"/>
</g>
<!-- reshape_concat_2_13&#45;&gt;allgather_dim_2_3 -->
<g id="edge1041" class="edge">
<title>reshape_concat_2_13&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M21284.57,-4222.41C21284.57,-4214.1 21284.57,-4205.05 21284.57,-4196.01"/>
<polygon fill="black" stroke="black" points="21288.07,-4195.85 21284.57,-4185.85 21281.07,-4195.85 21288.07,-4195.85"/>
</g>
<!-- split_q_2_14 -->
<g id="node867" class="node">
<title>split_q_2_14</title>
<ellipse fill="pink" stroke="black" cx="21680.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21680.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21680.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21680.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_q_2_14 -->
<g id="edge1043" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_q_2_14</title>
<path fill="none" stroke="black" d="M21786.53,-5008.24C21770.9,-4997.15 21753.47,-4984.78 21737.33,-4973.33"/>
<polygon fill="black" stroke="black" points="21739.21,-4970.37 21729.03,-4967.44 21735.16,-4976.08 21739.21,-4970.37"/>
</g>
<!-- split_k_2_14 -->
<g id="node868" class="node">
<title>split_k_2_14</title>
<ellipse fill="pink" stroke="black" cx="21989.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21989.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21989.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21989.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_k_2_14 -->
<g id="edge1044" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_k_2_14</title>
<path fill="none" stroke="black" d="M21884.3,-5008.24C21899.83,-4997.15 21917.15,-4984.78 21933.18,-4973.33"/>
<polygon fill="black" stroke="black" points="21935.32,-4976.1 21941.43,-4967.44 21931.26,-4970.4 21935.32,-4976.1"/>
</g>
<!-- split_v_2_14 -->
<g id="node869" class="node">
<title>split_v_2_14</title>
<ellipse fill="pink" stroke="black" cx="22298.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22298.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22298.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22298.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_v_2_14 -->
<g id="edge1045" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_v_2_14</title>
<path fill="none" stroke="black" d="M21944.71,-5017.12C22016.46,-5000.07 22110.22,-4977.79 22183.2,-4960.46"/>
<polygon fill="black" stroke="black" points="22184.43,-4963.76 22193.35,-4958.04 22182.82,-4956.95 22184.43,-4963.76"/>
</g>
<!-- transpose_q_2_14 -->
<g id="node870" class="node">
<title>transpose_q_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="21680.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21680.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21680.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21680.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_14&#45;&gt;transpose_q_2_14 -->
<g id="edge1046" class="edge">
<title>split_q_2_14&#45;&gt;transpose_q_2_14</title>
<path fill="none" stroke="black" d="M21680.57,-4894.42C21680.57,-4885.97 21680.57,-4876.87 21680.57,-4868.06"/>
<polygon fill="black" stroke="black" points="21684.07,-4867.89 21680.57,-4857.89 21677.07,-4867.89 21684.07,-4867.89"/>
</g>
<!-- transpose_k_2_14 -->
<g id="node871" class="node">
<title>transpose_k_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="21989.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21989.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21989.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21989.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_14&#45;&gt;transpose_k_2_14 -->
<g id="edge1047" class="edge">
<title>split_k_2_14&#45;&gt;transpose_k_2_14</title>
<path fill="none" stroke="black" d="M21989.57,-4894.42C21989.57,-4885.97 21989.57,-4876.87 21989.57,-4868.06"/>
<polygon fill="black" stroke="black" points="21993.07,-4867.89 21989.57,-4857.89 21986.07,-4867.89 21993.07,-4867.89"/>
</g>
<!-- transpose_v_2_14 -->
<g id="node872" class="node">
<title>transpose_v_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="22298.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22298.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22298.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22298.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_14&#45;&gt;transpose_v_2_14 -->
<g id="edge1048" class="edge">
<title>split_v_2_14&#45;&gt;transpose_v_2_14</title>
<path fill="none" stroke="black" d="M22298.57,-4894.42C22298.57,-4885.97 22298.57,-4876.87 22298.57,-4868.06"/>
<polygon fill="black" stroke="black" points="22302.07,-4867.89 22298.57,-4857.89 22295.07,-4867.89 22302.07,-4867.89"/>
</g>
<!-- attn_scores_2_14 -->
<g id="node873" class="node">
<title>attn_scores_2_14</title>
<ellipse fill="gold" stroke="black" cx="21809.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21809.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21809.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21809.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_14&#45;&gt;attn_scores_2_14 -->
<g id="edge1049" class="edge">
<title>transpose_q_2_14&#45;&gt;attn_scores_2_14</title>
<path fill="none" stroke="black" d="M21721.74,-4783.94C21733.96,-4773.52 21747.46,-4762.01 21760.14,-4751.2"/>
<polygon fill="black" stroke="black" points="21762.57,-4753.73 21767.91,-4744.57 21758.03,-4748.4 21762.57,-4753.73"/>
</g>
<!-- transpose_k_2_14&#45;&gt;attn_scores_2_14 -->
<g id="edge1050" class="edge">
<title>transpose_k_2_14&#45;&gt;attn_scores_2_14</title>
<path fill="none" stroke="black" d="M21934.1,-4785.14C21915.2,-4773.6 21893.91,-4760.59 21874.35,-4748.63"/>
<polygon fill="black" stroke="black" points="21876.15,-4745.63 21865.8,-4743.4 21872.5,-4751.6 21876.15,-4745.63"/>
</g>
<!-- attn_output_2_14 -->
<g id="node874" class="node">
<title>attn_output_2_14</title>
<ellipse fill="gold" stroke="black" cx="21809.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21809.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21809.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21809.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_14&#45;&gt;attn_output_2_14 -->
<g id="edge1051" class="edge">
<title>transpose_v_2_14&#45;&gt;attn_output_2_14</title>
<path fill="none" stroke="black" d="M22263.27,-4783.49C22208,-4729.33 22095.92,-4625.42 21985.57,-4558.55 21960.24,-4543.19 21931.12,-4529.6 21903.96,-4518.4"/>
<polygon fill="black" stroke="black" points="21905.02,-4515.06 21894.44,-4514.54 21902.39,-4521.54 21905.02,-4515.06"/>
</g>
<!-- softmax_2_14 -->
<g id="node875" class="node">
<title>softmax_2_14</title>
<ellipse fill="gold" stroke="black" cx="21809.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21809.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21809.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21809.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_14&#45;&gt;softmax_2_14 -->
<g id="edge1052" class="edge">
<title>attn_scores_2_14&#45;&gt;softmax_2_14</title>
<path fill="none" stroke="black" d="M21809.57,-4670.42C21809.57,-4661.97 21809.57,-4652.87 21809.57,-4644.06"/>
<polygon fill="black" stroke="black" points="21813.07,-4643.89 21809.57,-4633.89 21806.07,-4643.89 21813.07,-4643.89"/>
</g>
<!-- transpose_back_2_14 -->
<g id="node876" class="node">
<title>transpose_back_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="21725.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21725.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21725.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21725.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_14&#45;&gt;transpose_back_2_14 -->
<g id="edge1054" class="edge">
<title>attn_output_2_14&#45;&gt;transpose_back_2_14</title>
<path fill="none" stroke="black" d="M21782.07,-4447.03C21774.82,-4437.53 21766.91,-4427.17 21759.37,-4417.3"/>
<polygon fill="black" stroke="black" points="21761.99,-4414.97 21753.14,-4409.14 21756.43,-4419.22 21761.99,-4414.97"/>
</g>
<!-- softmax_2_14&#45;&gt;attn_output_2_14 -->
<g id="edge1053" class="edge">
<title>softmax_2_14&#45;&gt;attn_output_2_14</title>
<path fill="none" stroke="black" d="M21809.57,-4558.42C21809.57,-4549.97 21809.57,-4540.87 21809.57,-4532.06"/>
<polygon fill="black" stroke="black" points="21813.07,-4531.89 21809.57,-4521.89 21806.07,-4531.89 21813.07,-4531.89"/>
</g>
<!-- reshape_concat_2_14 -->
<g id="node877" class="node">
<title>reshape_concat_2_14</title>
<ellipse fill="lightcyan" stroke="black" cx="21580.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21580.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21580.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21580.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_14&#45;&gt;reshape_concat_2_14 -->
<g id="edge1055" class="edge">
<title>transpose_back_2_14&#45;&gt;reshape_concat_2_14</title>
<path fill="none" stroke="black" d="M21679.69,-4336.24C21665.27,-4325.3 21649.22,-4313.12 21634.31,-4301.81"/>
<polygon fill="black" stroke="black" points="21636.24,-4298.88 21626.15,-4295.62 21632.01,-4304.46 21636.24,-4298.88"/>
</g>
<!-- reshape_concat_2_14&#45;&gt;allgather_dim_2_3 -->
<g id="edge1056" class="edge">
<title>reshape_concat_2_14&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M21508.54,-4228.51C21465.25,-4210.15 21410.05,-4186.75 21365.29,-4167.77"/>
<polygon fill="black" stroke="black" points="21366.47,-4164.47 21355.9,-4163.79 21363.74,-4170.91 21366.47,-4164.47"/>
</g>
<!-- split_q_2_15 -->
<g id="node879" class="node">
<title>split_q_2_15</title>
<ellipse fill="pink" stroke="black" cx="22607.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22607.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="22607.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22607.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_q_2_15 -->
<g id="edge1058" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_q_2_15</title>
<path fill="none" stroke="black" d="M22712.85,-5008.24C22697.31,-4997.15 22680,-4984.78 22663.97,-4973.33"/>
<polygon fill="black" stroke="black" points="22665.89,-4970.4 22655.72,-4967.44 22661.82,-4976.1 22665.89,-4970.4"/>
</g>
<!-- split_k_2_15 -->
<g id="node880" class="node">
<title>split_k_2_15</title>
<ellipse fill="pink" stroke="black" cx="22916.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22916.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="22916.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22916.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_k_2_15 -->
<g id="edge1059" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_k_2_15</title>
<path fill="none" stroke="black" d="M22810.62,-5008.24C22826.25,-4997.15 22843.68,-4984.78 22859.81,-4973.33"/>
<polygon fill="black" stroke="black" points="22861.99,-4976.08 22868.11,-4967.44 22857.93,-4970.37 22861.99,-4976.08"/>
</g>
<!-- split_v_2_15 -->
<g id="node881" class="node">
<title>split_v_2_15</title>
<ellipse fill="pink" stroke="black" cx="23225.57" cy="-4932.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23225.57" y="-4943.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="23225.57" y="-4928.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23225.57" y="-4913.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_v_2_15 -->
<g id="edge1060" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_v_2_15</title>
<path fill="none" stroke="black" d="M22870.95,-5017.12C22942.85,-5000.07 23036.81,-4977.79 23109.95,-4960.46"/>
<polygon fill="black" stroke="black" points="23111.2,-4963.76 23120.13,-4958.04 23109.59,-4956.94 23111.2,-4963.76"/>
</g>
<!-- transpose_q_2_15 -->
<g id="node882" class="node">
<title>transpose_q_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="22607.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22607.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="22607.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22607.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_15&#45;&gt;transpose_q_2_15 -->
<g id="edge1061" class="edge">
<title>split_q_2_15&#45;&gt;transpose_q_2_15</title>
<path fill="none" stroke="black" d="M22607.57,-4894.42C22607.57,-4885.97 22607.57,-4876.87 22607.57,-4868.06"/>
<polygon fill="black" stroke="black" points="22611.07,-4867.89 22607.57,-4857.89 22604.07,-4867.89 22611.07,-4867.89"/>
</g>
<!-- transpose_k_2_15 -->
<g id="node883" class="node">
<title>transpose_k_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="22916.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22916.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="22916.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22916.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_15&#45;&gt;transpose_k_2_15 -->
<g id="edge1062" class="edge">
<title>split_k_2_15&#45;&gt;transpose_k_2_15</title>
<path fill="none" stroke="black" d="M22916.57,-4894.42C22916.57,-4885.97 22916.57,-4876.87 22916.57,-4868.06"/>
<polygon fill="black" stroke="black" points="22920.07,-4867.89 22916.57,-4857.89 22913.07,-4867.89 22920.07,-4867.89"/>
</g>
<!-- transpose_v_2_15 -->
<g id="node884" class="node">
<title>transpose_v_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="23225.57" cy="-4820.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23225.57" y="-4831.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="23225.57" y="-4816.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23225.57" y="-4801.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_15&#45;&gt;transpose_v_2_15 -->
<g id="edge1063" class="edge">
<title>split_v_2_15&#45;&gt;transpose_v_2_15</title>
<path fill="none" stroke="black" d="M23225.57,-4894.42C23225.57,-4885.97 23225.57,-4876.87 23225.57,-4868.06"/>
<polygon fill="black" stroke="black" points="23229.07,-4867.89 23225.57,-4857.89 23222.07,-4867.89 23229.07,-4867.89"/>
</g>
<!-- attn_scores_2_15 -->
<g id="node885" class="node">
<title>attn_scores_2_15</title>
<ellipse fill="gold" stroke="black" cx="22739.57" cy="-4708.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="22739.57" y="-4719.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="22739.57" y="-4704.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22739.57" y="-4689.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_15&#45;&gt;attn_scores_2_15 -->
<g id="edge1064" class="edge">
<title>transpose_q_2_15&#45;&gt;attn_scores_2_15</title>
<path fill="none" stroke="black" d="M22649.7,-4783.94C22662.2,-4773.52 22676.01,-4762.01 22688.99,-4751.2"/>
<polygon fill="black" stroke="black" points="22691.5,-4753.66 22696.94,-4744.57 22687.02,-4748.29 22691.5,-4753.66"/>
</g>
<!-- transpose_k_2_15&#45;&gt;attn_scores_2_15 -->
<g id="edge1065" class="edge">
<title>transpose_k_2_15&#45;&gt;attn_scores_2_15</title>
<path fill="none" stroke="black" d="M22862.02,-4785.14C22843.61,-4773.7 22822.89,-4760.83 22803.81,-4748.96"/>
<polygon fill="black" stroke="black" points="22805.51,-4745.9 22795.16,-4743.59 22801.81,-4751.84 22805.51,-4745.9"/>
</g>
<!-- attn_output_2_15 -->
<g id="node886" class="node">
<title>attn_output_2_15</title>
<ellipse fill="gold" stroke="black" cx="22739.57" cy="-4484.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22739.57" y="-4495.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="22739.57" y="-4480.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22739.57" y="-4465.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_15&#45;&gt;attn_output_2_15 -->
<g id="edge1066" class="edge">
<title>transpose_v_2_15&#45;&gt;attn_output_2_15</title>
<path fill="none" stroke="black" d="M23190.68,-4783.46C23136.03,-4729.27 23025.13,-4625.3 22915.57,-4558.55 22890.4,-4543.21 22861.46,-4529.65 22834.41,-4518.49"/>
<polygon fill="black" stroke="black" points="22835.52,-4515.16 22824.93,-4514.65 22832.88,-4521.65 22835.52,-4515.16"/>
</g>
<!-- softmax_2_15 -->
<g id="node887" class="node">
<title>softmax_2_15</title>
<ellipse fill="gold" stroke="black" cx="22739.57" cy="-4596.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="22739.57" y="-4607.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="22739.57" y="-4592.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22739.57" y="-4577.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_15&#45;&gt;softmax_2_15 -->
<g id="edge1067" class="edge">
<title>attn_scores_2_15&#45;&gt;softmax_2_15</title>
<path fill="none" stroke="black" d="M22739.57,-4670.42C22739.57,-4661.97 22739.57,-4652.87 22739.57,-4644.06"/>
<polygon fill="black" stroke="black" points="22743.07,-4643.89 22739.57,-4633.89 22736.07,-4643.89 22743.07,-4643.89"/>
</g>
<!-- transpose_back_2_15 -->
<g id="node888" class="node">
<title>transpose_back_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="22431.57" cy="-4372.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22431.57" y="-4383.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="22431.57" y="-4368.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22431.57" y="-4353.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_15&#45;&gt;transpose_back_2_15 -->
<g id="edge1069" class="edge">
<title>attn_output_2_15&#45;&gt;transpose_back_2_15</title>
<path fill="none" stroke="black" d="M22656.22,-4453.28C22615.57,-4438.76 22566.52,-4421.24 22524.64,-4406.28"/>
<polygon fill="black" stroke="black" points="22525.58,-4402.9 22514.99,-4402.84 22523.23,-4409.5 22525.58,-4402.9"/>
</g>
<!-- softmax_2_15&#45;&gt;attn_output_2_15 -->
<g id="edge1068" class="edge">
<title>softmax_2_15&#45;&gt;attn_output_2_15</title>
<path fill="none" stroke="black" d="M22739.57,-4558.42C22739.57,-4549.97 22739.57,-4540.87 22739.57,-4532.06"/>
<polygon fill="black" stroke="black" points="22743.07,-4531.89 22739.57,-4521.89 22736.07,-4531.89 22743.07,-4531.89"/>
</g>
<!-- reshape_concat_2_15 -->
<g id="node889" class="node">
<title>reshape_concat_2_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21883.57" cy="-4260.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21883.57" y="-4271.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21883.57" y="-4256.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21883.57" y="-4241.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_15&#45;&gt;reshape_concat_2_15 -->
<g id="edge1070" class="edge">
<title>transpose_back_2_15&#45;&gt;reshape_concat_2_15</title>
<path fill="none" stroke="black" d="M22318.36,-4348.32C22225.43,-4329.67 22094.32,-4303.35 22000.41,-4284.5"/>
<polygon fill="black" stroke="black" points="22001.08,-4281.06 21990.59,-4282.53 21999.7,-4287.93 22001.08,-4281.06"/>
</g>
<!-- reshape_concat_2_15&#45;&gt;allgather_dim_2_3 -->
<g id="edge1071" class="edge">
<title>reshape_concat_2_15&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M21782.31,-4235.72C21762.52,-4231.27 21741.91,-4226.7 21722.57,-4222.55 21612.64,-4198.92 21486.81,-4173.52 21398.31,-4155.93"/>
<polygon fill="black" stroke="black" points="21398.74,-4152.45 21388.25,-4153.93 21397.38,-4159.31 21398.74,-4152.45"/>
</g>
<!-- output_proj_2_3 -->
<g id="node894" class="node">
<title>output_proj_2_3</title>
<ellipse fill="orange" stroke="black" cx="17420.57" cy="-3919.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17420.57" y="-3938.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17420.57" y="-3923.26" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="17420.57" y="-3908.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17420.57" y="-3893.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_3&#45;&gt;output_proj_2_3 -->
<g id="edge1076" class="edge">
<title>head_group_2_3&#45;&gt;output_proj_2_3</title>
<path fill="none" stroke="black" d="M17669.28,-4004.53C17630.3,-3991.36 17576.11,-3973.04 17528.26,-3956.86"/>
<polygon fill="black" stroke="black" points="17529.38,-3953.55 17518.78,-3953.66 17527.14,-3960.18 17529.38,-3953.55"/>
</g>
<!-- allreduce_output_2 -->
<g id="node895" class="node">
<title>allreduce_output_2</title>
<polygon fill="red" stroke="black" points="16429.57,-3834.38 16286.57,-3781.38 16429.57,-3728.38 16572.57,-3781.38 16429.57,-3834.38"/>
<text text-anchor="middle" x="16429.57" y="-3792.68" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="16429.57" y="-3777.68" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="16429.57" y="-3762.68" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_2_0&#45;&gt;allreduce_output_2 -->
<g id="edge1077" class="edge">
<title>output_proj_2_0&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M15257.49,-3904.6C15512.34,-3878.03 16066.03,-3820.29 16310.02,-3794.85"/>
<polygon fill="black" stroke="black" points="16310.4,-3798.33 16319.98,-3793.81 16309.67,-3791.36 16310.4,-3798.33"/>
</g>
<!-- output_proj_2_1&#45;&gt;allreduce_output_2 -->
<g id="edge1078" class="edge">
<title>output_proj_2_1&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M16200.92,-3882.47C16223.69,-3873.13 16248.09,-3863 16270.57,-3853.38 16298.92,-3841.25 16329.91,-3827.52 16356.94,-3815.39"/>
<polygon fill="black" stroke="black" points="16358.64,-3818.46 16366.33,-3811.17 16355.77,-3812.08 16358.64,-3818.46"/>
</g>
<!-- output_proj_2_2&#45;&gt;allreduce_output_2 -->
<g id="edge1079" class="edge">
<title>output_proj_2_2&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M16781.53,-3887.41C16701.78,-3863.61 16592.97,-3831.14 16517.54,-3808.63"/>
<polygon fill="black" stroke="black" points="16518.17,-3805.17 16507.58,-3805.66 16516.16,-3811.87 16518.17,-3805.17"/>
</g>
<!-- output_proj_2_3&#45;&gt;allreduce_output_2 -->
<g id="edge1080" class="edge">
<title>output_proj_2_3&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M17291.78,-3900.78C17096.28,-3873.93 16727.8,-3823.33 16542.3,-3797.86"/>
<polygon fill="black" stroke="black" points="16542.63,-3794.37 16532.25,-3796.48 16541.68,-3801.31 16542.63,-3794.37"/>
</g>
<!-- residual_2 -->
<g id="node896" class="node">
<title>residual_2</title>
<ellipse fill="lightgreen" stroke="black" cx="16429.57" cy="-3653.88" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="16429.57" y="-3665.18" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16429.57" y="-3650.18" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="16429.57" y="-3635.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_output_2&#45;&gt;residual_2 -->
<g id="edge1081" class="edge">
<title>allreduce_output_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M16429.57,-3728.25C16429.57,-3719.53 16429.57,-3710.54 16429.57,-3701.96"/>
<polygon fill="black" stroke="black" points="16433.07,-3701.75 16429.57,-3691.75 16426.07,-3701.75 16433.07,-3701.75"/>
</g>
<!-- ln2_2_0 -->
<g id="node897" class="node">
<title>ln2_2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="14059.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14059.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14059.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14059.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_0 -->
<g id="edge1082" class="edge">
<title>residual_2&#45;&gt;ln2_2_0</title>
<path fill="none" stroke="black" d="M16275.79,-3648.28C15976.39,-3639.25 15294.26,-3618.36 14720.57,-3598.38 14496.99,-3590.59 14439.33,-3608.91 14217.57,-3579.38 14202.58,-3577.38 14186.92,-3574.62 14171.53,-3571.49"/>
<polygon fill="black" stroke="black" points="14171.98,-3568.01 14161.47,-3569.39 14170.54,-3574.86 14171.98,-3568.01"/>
</g>
<!-- ln2_2_1 -->
<g id="node898" class="node">
<title>ln2_2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="14375.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14375.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14375.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14375.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_1 -->
<g id="edge1083" class="edge">
<title>residual_2&#45;&gt;ln2_2_1</title>
<path fill="none" stroke="black" d="M16274.37,-3650.63C15883.97,-3644.36 14868.45,-3624.14 14533.57,-3579.38 14518.58,-3577.37 14502.92,-3574.6 14487.53,-3571.48"/>
<polygon fill="black" stroke="black" points="14487.98,-3567.99 14477.47,-3569.37 14486.55,-3574.85 14487.98,-3567.99"/>
</g>
<!-- ln2_2_2 -->
<g id="node899" class="node">
<title>ln2_2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14691.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14691.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14691.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14691.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_2 -->
<g id="edge1084" class="edge">
<title>residual_2&#45;&gt;ln2_2_2</title>
<path fill="none" stroke="black" d="M16275.21,-3649.25C15933.45,-3640.63 15121.7,-3616.83 14849.57,-3579.38 14834.59,-3577.32 14818.93,-3574.51 14803.55,-3571.37"/>
<polygon fill="black" stroke="black" points="14803.99,-3567.89 14793.49,-3569.26 14802.56,-3574.74 14803.99,-3567.89"/>
</g>
<!-- ln2_2_3 -->
<g id="node900" class="node">
<title>ln2_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="15007.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15007.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15007.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15007.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_3 -->
<g id="edge1085" class="edge">
<title>residual_2&#45;&gt;ln2_2_3</title>
<path fill="none" stroke="black" d="M16274.04,-3652.26C16034.68,-3649.42 15562.12,-3636.3 15165.57,-3579.38 15150.71,-3577.25 15135.19,-3574.42 15119.92,-3571.28"/>
<polygon fill="black" stroke="black" points="15120.45,-3567.81 15109.94,-3569.17 15119,-3574.66 15120.45,-3567.81"/>
</g>
<!-- ln2_2_4 -->
<g id="node901" class="node">
<title>ln2_2_4</title>
<ellipse fill="lightgreen" stroke="black" cx="15323.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15323.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15323.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15323.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_4 -->
<g id="edge1086" class="edge">
<title>residual_2&#45;&gt;ln2_2_4</title>
<path fill="none" stroke="black" d="M16275.66,-3648.02C16087.43,-3640.46 15759.57,-3622.02 15481.57,-3579.38 15466.96,-3577.14 15451.7,-3574.28 15436.67,-3571.16"/>
<polygon fill="black" stroke="black" points="15437.34,-3567.72 15426.83,-3569.07 15435.89,-3574.57 15437.34,-3567.72"/>
</g>
<!-- ln2_2_5 -->
<g id="node902" class="node">
<title>ln2_2_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15639.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15639.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15639.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15639.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_5 -->
<g id="edge1087" class="edge">
<title>residual_2&#45;&gt;ln2_2_5</title>
<path fill="none" stroke="black" d="M16283.95,-3640.58C16155.43,-3628.63 15963.29,-3608.06 15797.57,-3579.38 15783.49,-3576.94 15768.77,-3574.03 15754.23,-3570.94"/>
<polygon fill="black" stroke="black" points="15754.72,-3567.46 15744.2,-3568.77 15753.24,-3574.3 15754.72,-3567.46"/>
</g>
<!-- ln2_2_6 -->
<g id="node903" class="node">
<title>ln2_2_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15955.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15955.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15955.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15955.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_6 -->
<g id="edge1088" class="edge">
<title>residual_2&#45;&gt;ln2_2_6</title>
<path fill="none" stroke="black" d="M16319.34,-3627.3C16245.65,-3610.2 16148.79,-3587.72 16073.55,-3570.26"/>
<polygon fill="black" stroke="black" points="16074.09,-3566.79 16063.55,-3567.94 16072.5,-3573.61 16074.09,-3566.79"/>
</g>
<!-- ln2_2_7 -->
<g id="node904" class="node">
<title>ln2_2_7</title>
<ellipse fill="lightgreen" stroke="black" cx="16271.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16271.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16271.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16271.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_7 -->
<g id="edge1089" class="edge">
<title>residual_2&#45;&gt;ln2_2_7</title>
<path fill="none" stroke="black" d="M16379.58,-3618.07C16363.64,-3606.98 16345.88,-3594.61 16329.43,-3583.16"/>
<polygon fill="black" stroke="black" points="16331.18,-3580.11 16320.97,-3577.27 16327.18,-3585.85 16331.18,-3580.11"/>
</g>
<!-- ln2_2_8 -->
<g id="node905" class="node">
<title>ln2_2_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16587.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16587.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16587.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16587.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_8 -->
<g id="edge1090" class="edge">
<title>residual_2&#45;&gt;ln2_2_8</title>
<path fill="none" stroke="black" d="M16479.57,-3618.07C16495.5,-3606.98 16513.27,-3594.61 16529.71,-3583.16"/>
<polygon fill="black" stroke="black" points="16531.97,-3585.85 16538.18,-3577.27 16527.97,-3580.11 16531.97,-3585.85"/>
</g>
<!-- ln2_2_9 -->
<g id="node906" class="node">
<title>ln2_2_9</title>
<ellipse fill="lightgreen" stroke="black" cx="16903.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16903.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16903.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16903.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_9 -->
<g id="edge1091" class="edge">
<title>residual_2&#45;&gt;ln2_2_9</title>
<path fill="none" stroke="black" d="M16539.81,-3627.3C16613.5,-3610.2 16710.35,-3587.72 16785.59,-3570.26"/>
<polygon fill="black" stroke="black" points="16786.64,-3573.61 16795.59,-3567.94 16785.06,-3566.79 16786.64,-3573.61"/>
</g>
<!-- ln2_2_10 -->
<g id="node907" class="node">
<title>ln2_2_10</title>
<ellipse fill="lightgreen" stroke="black" cx="17219.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17219.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17219.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17219.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_10 -->
<g id="edge1092" class="edge">
<title>residual_2&#45;&gt;ln2_2_10</title>
<path fill="none" stroke="black" d="M16575.19,-3640.58C16703.72,-3628.63 16895.86,-3608.06 17061.57,-3579.38 17075.66,-3576.94 17090.38,-3574.03 17104.92,-3570.94"/>
<polygon fill="black" stroke="black" points="17105.91,-3574.3 17114.94,-3568.77 17104.43,-3567.46 17105.91,-3574.3"/>
</g>
<!-- ln2_2_11 -->
<g id="node908" class="node">
<title>ln2_2_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17535.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17535.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17535.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17535.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_11 -->
<g id="edge1093" class="edge">
<title>residual_2&#45;&gt;ln2_2_11</title>
<path fill="none" stroke="black" d="M16583.49,-3648.02C16771.71,-3640.46 17099.57,-3622.02 17377.57,-3579.38 17392.18,-3577.14 17407.45,-3574.28 17422.48,-3571.16"/>
<polygon fill="black" stroke="black" points="17423.26,-3574.57 17432.31,-3569.07 17421.81,-3567.72 17423.26,-3574.57"/>
</g>
<!-- ln2_2_12 -->
<g id="node909" class="node">
<title>ln2_2_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17851.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17851.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17851.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17851.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_12 -->
<g id="edge1094" class="edge">
<title>residual_2&#45;&gt;ln2_2_12</title>
<path fill="none" stroke="black" d="M16585.11,-3652.26C16824.47,-3649.42 17297.02,-3636.3 17693.57,-3579.38 17708.43,-3577.25 17723.96,-3574.42 17739.22,-3571.28"/>
<polygon fill="black" stroke="black" points="17740.15,-3574.66 17749.21,-3569.17 17738.7,-3567.81 17740.15,-3574.66"/>
</g>
<!-- ln2_2_13 -->
<g id="node910" class="node">
<title>ln2_2_13</title>
<ellipse fill="lightgreen" stroke="black" cx="18167.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18167.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18167.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18167.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_13 -->
<g id="edge1095" class="edge">
<title>residual_2&#45;&gt;ln2_2_13</title>
<path fill="none" stroke="black" d="M16583.94,-3649.25C16925.69,-3640.63 17737.45,-3616.83 18009.57,-3579.38 18024.56,-3577.32 18040.21,-3574.51 18055.6,-3571.37"/>
<polygon fill="black" stroke="black" points="18056.59,-3574.74 18065.66,-3569.26 18055.15,-3567.89 18056.59,-3574.74"/>
</g>
<!-- ln2_2_14 -->
<g id="node911" class="node">
<title>ln2_2_14</title>
<ellipse fill="lightgreen" stroke="black" cx="18483.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18483.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18483.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18483.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_14 -->
<g id="edge1096" class="edge">
<title>residual_2&#45;&gt;ln2_2_14</title>
<path fill="none" stroke="black" d="M16584.78,-3650.63C16975.18,-3644.36 17990.7,-3624.14 18325.57,-3579.38 18340.57,-3577.37 18356.23,-3574.6 18371.61,-3571.48"/>
<polygon fill="black" stroke="black" points="18372.6,-3574.85 18381.67,-3569.37 18371.17,-3567.99 18372.6,-3574.85"/>
</g>
<!-- ln2_2_15 -->
<g id="node912" class="node">
<title>ln2_2_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18799.57" cy="-3541.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18799.57" y="-3553.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18799.57" y="-3538.18" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18799.57" y="-3523.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_15 -->
<g id="edge1097" class="edge">
<title>residual_2&#45;&gt;ln2_2_15</title>
<path fill="none" stroke="black" d="M16583.59,-3648.34C16884.26,-3639.4 17570.5,-3618.63 18147.57,-3598.38 18367.16,-3590.67 18423.79,-3608.46 18641.57,-3579.38 18656.57,-3577.38 18672.23,-3574.61 18687.61,-3571.48"/>
<polygon fill="black" stroke="black" points="18688.6,-3574.85 18697.67,-3569.38 18687.17,-3568 18688.6,-3574.85"/>
</g>
<!-- mlp_fc1_2_0 -->
<g id="node913" class="node">
<title>mlp_fc1_2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="14087.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14087.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14087.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14087.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14087.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_0&#45;&gt;mlp_fc1_2_0 -->
<g id="edge1098" class="edge">
<title>ln2_2_0&#45;&gt;mlp_fc1_2_0</title>
<path fill="none" stroke="black" d="M14068.05,-3504.37C14070.04,-3495.82 14072.2,-3486.51 14074.34,-3477.3"/>
<polygon fill="black" stroke="black" points="14077.79,-3477.92 14076.64,-3467.39 14070.97,-3476.33 14077.79,-3477.92"/>
</g>
<!-- mlp_fc1_2_1 -->
<g id="node914" class="node">
<title>mlp_fc1_2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14401.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14401.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14401.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14401.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14401.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_1&#45;&gt;mlp_fc1_2_1 -->
<g id="edge1099" class="edge">
<title>ln2_2_1&#45;&gt;mlp_fc1_2_1</title>
<path fill="none" stroke="black" d="M14383.44,-3504.37C14385.29,-3495.82 14387.3,-3486.51 14389.28,-3477.3"/>
<polygon fill="black" stroke="black" points="14392.73,-3477.9 14391.42,-3467.39 14385.89,-3476.42 14392.73,-3477.9"/>
</g>
<!-- mlp_fc1_2_2 -->
<g id="node915" class="node">
<title>mlp_fc1_2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14703.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14703.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14703.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14703.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14703.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_2&#45;&gt;mlp_fc1_2_2 -->
<g id="edge1100" class="edge">
<title>ln2_2_2&#45;&gt;mlp_fc1_2_2</title>
<path fill="none" stroke="black" d="M14695.21,-3504.37C14696.05,-3495.91 14696.96,-3486.71 14697.87,-3477.59"/>
<polygon fill="black" stroke="black" points="14701.38,-3477.68 14698.89,-3467.39 14694.41,-3476.99 14701.38,-3477.68"/>
</g>
<!-- mlp_fc1_2_3 -->
<g id="node916" class="node">
<title>mlp_fc1_2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="15024.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15024.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15024.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15024.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15024.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_3&#45;&gt;mlp_fc1_2_3 -->
<g id="edge1101" class="edge">
<title>ln2_2_3&#45;&gt;mlp_fc1_2_3</title>
<path fill="none" stroke="black" d="M15012.72,-3504.37C15013.93,-3495.82 15015.24,-3486.51 15016.54,-3477.3"/>
<polygon fill="black" stroke="black" points="15020,-3477.78 15017.93,-3467.39 15013.07,-3476.8 15020,-3477.78"/>
</g>
<!-- mlp_fc1_2_4 -->
<g id="node917" class="node">
<title>mlp_fc1_2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15346.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15346.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15346.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15346.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15346.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_4&#45;&gt;mlp_fc1_2_4 -->
<g id="edge1102" class="edge">
<title>ln2_2_4&#45;&gt;mlp_fc1_2_4</title>
<path fill="none" stroke="black" d="M15330.54,-3504.37C15332.17,-3495.82 15333.94,-3486.51 15335.7,-3477.3"/>
<polygon fill="black" stroke="black" points="15339.16,-3477.86 15337.59,-3467.39 15332.28,-3476.55 15339.16,-3477.86"/>
</g>
<!-- mlp_fc1_2_5 -->
<g id="node918" class="node">
<title>mlp_fc1_2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15671.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15671.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15671.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15671.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15671.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_5&#45;&gt;mlp_fc1_2_5 -->
<g id="edge1103" class="edge">
<title>ln2_2_5&#45;&gt;mlp_fc1_2_5</title>
<path fill="none" stroke="black" d="M15649.26,-3504.37C15651.53,-3495.82 15654,-3486.51 15656.45,-3477.3"/>
<polygon fill="black" stroke="black" points="15659.89,-3477.95 15659.08,-3467.39 15653.13,-3476.15 15659.89,-3477.95"/>
</g>
<!-- mlp_fc1_2_6 -->
<g id="node919" class="node">
<title>mlp_fc1_2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15975.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15975.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15975.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15975.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15975.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_6&#45;&gt;mlp_fc1_2_6 -->
<g id="edge1104" class="edge">
<title>ln2_2_6&#45;&gt;mlp_fc1_2_6</title>
<path fill="none" stroke="black" d="M15961.63,-3504.37C15963.05,-3495.82 15964.59,-3486.51 15966.12,-3477.3"/>
<polygon fill="black" stroke="black" points="15969.58,-3477.82 15967.76,-3467.39 15962.67,-3476.68 15969.58,-3477.82"/>
</g>
<!-- mlp_fc1_2_7 -->
<g id="node920" class="node">
<title>mlp_fc1_2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16278.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16278.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16278.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16278.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16278.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_7&#45;&gt;mlp_fc1_2_7 -->
<g id="edge1105" class="edge">
<title>ln2_2_7&#45;&gt;mlp_fc1_2_7</title>
<path fill="none" stroke="black" d="M16273.69,-3504.37C16274.18,-3495.91 16274.72,-3486.71 16275.25,-3477.59"/>
<polygon fill="black" stroke="black" points="16278.75,-3477.57 16275.84,-3467.39 16271.77,-3477.17 16278.75,-3477.57"/>
</g>
<!-- mlp_fc1_2_8 -->
<g id="node921" class="node">
<title>mlp_fc1_2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16584.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16584.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16584.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16584.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16584.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_8&#45;&gt;mlp_fc1_2_8 -->
<g id="edge1106" class="edge">
<title>ln2_2_8&#45;&gt;mlp_fc1_2_8</title>
<path fill="none" stroke="black" d="M16586.67,-3504.37C16586.45,-3495.91 16586.23,-3486.71 16586,-3477.59"/>
<polygon fill="black" stroke="black" points="16589.49,-3477.3 16585.75,-3467.39 16582.49,-3477.47 16589.49,-3477.3"/>
</g>
<!-- mlp_fc1_2_9 -->
<g id="node922" class="node">
<title>mlp_fc1_2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16895.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16895.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16895.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16895.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16895.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_9&#45;&gt;mlp_fc1_2_9 -->
<g id="edge1107" class="edge">
<title>ln2_2_9&#45;&gt;mlp_fc1_2_9</title>
<path fill="none" stroke="black" d="M16901.15,-3504.37C16900.59,-3495.91 16899.98,-3486.71 16899.37,-3477.59"/>
<polygon fill="black" stroke="black" points="16902.85,-3477.13 16898.7,-3467.39 16895.87,-3477.6 16902.85,-3477.13"/>
</g>
<!-- mlp_fc1_2_10 -->
<g id="node923" class="node">
<title>mlp_fc1_2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="17209.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17209.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17209.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17209.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17209.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_10&#45;&gt;mlp_fc1_2_10 -->
<g id="edge1108" class="edge">
<title>ln2_2_10&#45;&gt;mlp_fc1_2_10</title>
<path fill="none" stroke="black" d="M17216.55,-3504.37C17215.84,-3495.91 17215.08,-3486.71 17214.33,-3477.59"/>
<polygon fill="black" stroke="black" points="17217.79,-3477.06 17213.48,-3467.39 17210.82,-3477.64 17217.79,-3477.06"/>
</g>
<!-- mlp_fc1_2_11 -->
<g id="node924" class="node">
<title>mlp_fc1_2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17524.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17524.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17524.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17524.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17524.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_11&#45;&gt;mlp_fc1_2_11 -->
<g id="edge1109" class="edge">
<title>ln2_2_11&#45;&gt;mlp_fc1_2_11</title>
<path fill="none" stroke="black" d="M17532.24,-3504.37C17531.47,-3495.91 17530.63,-3486.71 17529.8,-3477.59"/>
<polygon fill="black" stroke="black" points="17533.26,-3477.03 17528.87,-3467.39 17526.29,-3477.66 17533.26,-3477.03"/>
</g>
<!-- mlp_fc1_2_12 -->
<g id="node925" class="node">
<title>mlp_fc1_2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17839.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17839.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17839.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17839.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17839.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_12&#45;&gt;mlp_fc1_2_12 -->
<g id="edge1110" class="edge">
<title>ln2_2_12&#45;&gt;mlp_fc1_2_12</title>
<path fill="none" stroke="black" d="M17847.94,-3504.37C17847.1,-3495.91 17846.18,-3486.71 17845.28,-3477.59"/>
<polygon fill="black" stroke="black" points="17848.73,-3476.99 17844.26,-3467.39 17841.77,-3477.68 17848.73,-3476.99"/>
</g>
<!-- mlp_fc1_2_13 -->
<g id="node926" class="node">
<title>mlp_fc1_2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="18155.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18155.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18155.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18155.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18155.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_13&#45;&gt;mlp_fc1_2_13 -->
<g id="edge1111" class="edge">
<title>ln2_2_13&#45;&gt;mlp_fc1_2_13</title>
<path fill="none" stroke="black" d="M18163.94,-3504.37C18163.1,-3495.91 18162.18,-3486.71 18161.28,-3477.59"/>
<polygon fill="black" stroke="black" points="18164.73,-3476.99 18160.26,-3467.39 18157.77,-3477.68 18164.73,-3476.99"/>
</g>
<!-- mlp_fc1_2_14 -->
<g id="node927" class="node">
<title>mlp_fc1_2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18471.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18471.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18471.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18471.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18471.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_14&#45;&gt;mlp_fc1_2_14 -->
<g id="edge1112" class="edge">
<title>ln2_2_14&#45;&gt;mlp_fc1_2_14</title>
<path fill="none" stroke="black" d="M18479.94,-3504.37C18479.1,-3495.91 18478.18,-3486.71 18477.28,-3477.59"/>
<polygon fill="black" stroke="black" points="18480.73,-3476.99 18476.26,-3467.39 18473.77,-3477.68 18480.73,-3476.99"/>
</g>
<!-- mlp_fc1_2_15 -->
<g id="node928" class="node">
<title>mlp_fc1_2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18787.57" cy="-3419.3" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18787.57" y="-3438.1" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18787.57" y="-3423.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18787.57" y="-3408.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18787.57" y="-3393.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_2_15&#45;&gt;mlp_fc1_2_15 -->
<g id="edge1113" class="edge">
<title>ln2_2_15&#45;&gt;mlp_fc1_2_15</title>
<path fill="none" stroke="black" d="M18795.94,-3504.37C18795.1,-3495.91 18794.18,-3486.71 18793.28,-3477.59"/>
<polygon fill="black" stroke="black" points="18796.73,-3476.99 18792.26,-3467.39 18789.77,-3477.68 18796.73,-3476.99"/>
</g>
<!-- mlp_gelu_2_0 -->
<g id="node929" class="node">
<title>mlp_gelu_2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="14131.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14131.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14131.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14131.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_0&#45;&gt;mlp_gelu_2_0 -->
<g id="edge1114" class="edge">
<title>mlp_fc1_2_0&#45;&gt;mlp_gelu_2_0</title>
<path fill="none" stroke="black" d="M14104.71,-3371.33C14108.01,-3362.3 14111.46,-3352.84 14114.74,-3343.84"/>
<polygon fill="black" stroke="black" points="14118.09,-3344.88 14118.23,-3334.28 14111.51,-3342.48 14118.09,-3344.88"/>
</g>
<!-- mlp_gelu_2_1 -->
<g id="node930" class="node">
<title>mlp_gelu_2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14430.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14430.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14430.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14430.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_1&#45;&gt;mlp_gelu_2_1 -->
<g id="edge1115" class="edge">
<title>mlp_fc1_2_1&#45;&gt;mlp_gelu_2_1</title>
<path fill="none" stroke="black" d="M14412.87,-3371.33C14415.02,-3362.39 14417.27,-3353.05 14419.41,-3344.13"/>
<polygon fill="black" stroke="black" points="14422.84,-3344.82 14421.78,-3334.28 14416.04,-3343.19 14422.84,-3344.82"/>
</g>
<!-- mlp_gelu_2_2 -->
<g id="node931" class="node">
<title>mlp_gelu_2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14727.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14727.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14727.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14727.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_2&#45;&gt;mlp_gelu_2_2 -->
<g id="edge1116" class="edge">
<title>mlp_fc1_2_2&#45;&gt;mlp_gelu_2_2</title>
<path fill="none" stroke="black" d="M14712.99,-3370.98C14714.73,-3362.26 14716.54,-3353.15 14718.27,-3344.44"/>
<polygon fill="black" stroke="black" points="14721.74,-3344.94 14720.26,-3334.45 14714.88,-3343.57 14721.74,-3344.94"/>
</g>
<!-- mlp_gelu_2_3 -->
<g id="node932" class="node">
<title>mlp_gelu_2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="15057.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15057.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15057.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15057.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_3&#45;&gt;mlp_gelu_2_3 -->
<g id="edge1117" class="edge">
<title>mlp_fc1_2_3&#45;&gt;mlp_gelu_2_3</title>
<path fill="none" stroke="black" d="M15037.43,-3371.33C15039.87,-3362.39 15042.43,-3353.05 15044.87,-3344.13"/>
<polygon fill="black" stroke="black" points="15048.3,-3344.85 15047.57,-3334.28 15041.55,-3343 15048.3,-3344.85"/>
</g>
<!-- mlp_gelu_2_4 -->
<g id="node933" class="node">
<title>mlp_gelu_2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15392.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15392.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15392.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15392.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_4&#45;&gt;mlp_gelu_2_4 -->
<g id="edge1118" class="edge">
<title>mlp_fc1_2_4&#45;&gt;mlp_gelu_2_4</title>
<path fill="none" stroke="black" d="M15364.49,-3371.33C15367.94,-3362.3 15371.54,-3352.84 15374.98,-3343.84"/>
<polygon fill="black" stroke="black" points="15378.33,-3344.87 15378.62,-3334.28 15371.79,-3342.38 15378.33,-3344.87"/>
</g>
<!-- mlp_gelu_2_5 -->
<g id="node934" class="node">
<title>mlp_gelu_2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15689.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15689.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15689.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15689.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_5&#45;&gt;mlp_gelu_2_5 -->
<g id="edge1119" class="edge">
<title>mlp_fc1_2_5&#45;&gt;mlp_gelu_2_5</title>
<path fill="none" stroke="black" d="M15678.64,-3370.98C15679.94,-3362.26 15681.3,-3353.15 15682.6,-3344.44"/>
<polygon fill="black" stroke="black" points="15686.07,-3344.86 15684.09,-3334.45 15679.15,-3343.82 15686.07,-3344.86"/>
</g>
<!-- mlp_gelu_2_6 -->
<g id="node935" class="node">
<title>mlp_gelu_2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15986.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15986.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15986.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15986.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_6&#45;&gt;mlp_gelu_2_6 -->
<g id="edge1120" class="edge">
<title>mlp_fc1_2_6&#45;&gt;mlp_gelu_2_6</title>
<path fill="none" stroke="black" d="M15979.89,-3370.98C15980.69,-3362.26 15981.52,-3353.15 15982.31,-3344.44"/>
<polygon fill="black" stroke="black" points="15985.8,-3344.73 15983.22,-3334.45 15978.83,-3344.09 15985.8,-3344.73"/>
</g>
<!-- mlp_gelu_2_7 -->
<g id="node936" class="node">
<title>mlp_gelu_2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16283.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16283.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16283.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16283.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_7&#45;&gt;mlp_gelu_2_7 -->
<g id="edge1121" class="edge">
<title>mlp_fc1_2_7&#45;&gt;mlp_gelu_2_7</title>
<path fill="none" stroke="black" d="M16280.54,-3370.98C16280.9,-3362.26 16281.27,-3353.15 16281.64,-3344.44"/>
<polygon fill="black" stroke="black" points="16285.13,-3344.59 16282.05,-3334.45 16278.14,-3344.3 16285.13,-3344.59"/>
</g>
<!-- mlp_gelu_2_8 -->
<g id="node937" class="node">
<title>mlp_gelu_2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16580.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16580.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16580.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16580.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_8&#45;&gt;mlp_gelu_2_8 -->
<g id="edge1122" class="edge">
<title>mlp_fc1_2_8&#45;&gt;mlp_gelu_2_8</title>
<path fill="none" stroke="black" d="M16583,-3370.98C16582.72,-3362.35 16582.42,-3353.35 16582.13,-3344.73"/>
<polygon fill="black" stroke="black" points="16585.62,-3344.33 16581.79,-3334.45 16578.63,-3344.56 16585.62,-3344.33"/>
</g>
<!-- mlp_gelu_2_9 -->
<g id="node938" class="node">
<title>mlp_gelu_2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16877.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16877.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16877.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16877.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_9&#45;&gt;mlp_gelu_2_9 -->
<g id="edge1123" class="edge">
<title>mlp_fc1_2_9&#45;&gt;mlp_gelu_2_9</title>
<path fill="none" stroke="black" d="M16888.51,-3370.98C16887.21,-3362.26 16885.85,-3353.15 16884.55,-3344.44"/>
<polygon fill="black" stroke="black" points="16888,-3343.82 16883.06,-3334.45 16881.07,-3344.86 16888,-3343.82"/>
</g>
<!-- mlp_gelu_2_10 -->
<g id="node939" class="node">
<title>mlp_gelu_2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="17174.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17174.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17174.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17174.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_10&#45;&gt;mlp_gelu_2_10 -->
<g id="edge1124" class="edge">
<title>mlp_fc1_2_10&#45;&gt;mlp_gelu_2_10</title>
<path fill="none" stroke="black" d="M17195.94,-3371.33C17193.35,-3362.39 17190.63,-3353.05 17188.05,-3344.13"/>
<polygon fill="black" stroke="black" points="17191.34,-3342.91 17185.19,-3334.28 17184.61,-3344.86 17191.34,-3342.91"/>
</g>
<!-- mlp_gelu_2_11 -->
<g id="node940" class="node">
<title>mlp_gelu_2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17471.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17471.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17471.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17471.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_11&#45;&gt;mlp_gelu_2_11 -->
<g id="edge1125" class="edge">
<title>mlp_fc1_2_11&#45;&gt;mlp_gelu_2_11</title>
<path fill="none" stroke="black" d="M17504.08,-3371.67C17500.02,-3362.43 17495.75,-3352.73 17491.7,-3343.51"/>
<polygon fill="black" stroke="black" points="17494.8,-3341.86 17487.57,-3334.11 17488.39,-3344.68 17494.8,-3341.86"/>
</g>
<!-- mlp_gelu_2_12 -->
<g id="node941" class="node">
<title>mlp_gelu_2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17786.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17786.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17786.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17786.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_12&#45;&gt;mlp_gelu_2_12 -->
<g id="edge1126" class="edge">
<title>mlp_fc1_2_12&#45;&gt;mlp_gelu_2_12</title>
<path fill="none" stroke="black" d="M17819.08,-3371.67C17815.02,-3362.43 17810.75,-3352.73 17806.7,-3343.51"/>
<polygon fill="black" stroke="black" points="17809.8,-3341.86 17802.57,-3334.11 17803.39,-3344.68 17809.8,-3341.86"/>
</g>
<!-- mlp_gelu_2_13 -->
<g id="node942" class="node">
<title>mlp_gelu_2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="18087.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18087.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18087.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18087.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_13&#45;&gt;mlp_gelu_2_13 -->
<g id="edge1127" class="edge">
<title>mlp_fc1_2_13&#45;&gt;mlp_gelu_2_13</title>
<path fill="none" stroke="black" d="M18129.48,-3372.02C18124.08,-3362.46 18118.41,-3352.4 18113.04,-3342.87"/>
<polygon fill="black" stroke="black" points="18115.97,-3340.93 18108,-3333.94 18109.87,-3344.37 18115.97,-3340.93"/>
</g>
<!-- mlp_gelu_2_14 -->
<g id="node943" class="node">
<title>mlp_gelu_2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18386.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18386.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18386.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18386.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_14&#45;&gt;mlp_gelu_2_14 -->
<g id="edge1128" class="edge">
<title>mlp_fc1_2_14&#45;&gt;mlp_gelu_2_14</title>
<path fill="none" stroke="black" d="M18439.2,-3372.36C18432.23,-3362.48 18424.88,-3352.05 18417.95,-3342.22"/>
<polygon fill="black" stroke="black" points="18420.61,-3339.93 18411.99,-3333.77 18414.89,-3343.96 18420.61,-3339.93"/>
</g>
<!-- mlp_gelu_2_15 -->
<g id="node944" class="node">
<title>mlp_gelu_2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18684.57" cy="-3296.71" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18684.57" y="-3308.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18684.57" y="-3293.01" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18684.57" y="-3278.01" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_2_15&#45;&gt;mlp_gelu_2_15 -->
<g id="edge1129" class="edge">
<title>mlp_fc1_2_15&#45;&gt;mlp_gelu_2_15</title>
<path fill="none" stroke="black" d="M18748.93,-3373.05C18740.01,-3362.61 18730.55,-3351.53 18721.7,-3341.17"/>
<polygon fill="black" stroke="black" points="18724.23,-3338.75 18715.07,-3333.41 18718.9,-3343.29 18724.23,-3338.75"/>
</g>
<!-- mlp_fc2_2_0 -->
<g id="node945" class="node">
<title>mlp_fc2_2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="14140.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14140.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14140.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14140.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14140.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_0&#45;&gt;mlp_fc2_2_0 -->
<g id="edge1130" class="edge">
<title>mlp_gelu_2_0&#45;&gt;mlp_fc2_2_0</title>
<path fill="none" stroke="black" d="M14134.3,-3259.21C14134.93,-3250.75 14135.62,-3241.54 14136.3,-3232.43"/>
<polygon fill="black" stroke="black" points="14139.8,-3232.45 14137.06,-3222.22 14132.82,-3231.93 14139.8,-3232.45"/>
</g>
<!-- mlp_fc2_2_1 -->
<g id="node946" class="node">
<title>mlp_fc2_2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14475.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14475.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14475.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14475.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14475.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_1&#45;&gt;mlp_fc2_2_1 -->
<g id="edge1131" class="edge">
<title>mlp_gelu_2_1&#45;&gt;mlp_fc2_2_1</title>
<path fill="none" stroke="black" d="M14444.2,-3259.21C14447.42,-3250.56 14450.94,-3241.14 14454.41,-3231.84"/>
<polygon fill="black" stroke="black" points="14457.78,-3232.81 14458,-3222.22 14451.22,-3230.36 14457.78,-3232.81"/>
</g>
<!-- mlp_fc2_2_2 -->
<g id="node947" class="node">
<title>mlp_fc2_2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14774.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14774.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14774.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14774.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14774.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_2&#45;&gt;mlp_fc2_2_2 -->
<g id="edge1132" class="edge">
<title>mlp_gelu_2_2&#45;&gt;mlp_fc2_2_2</title>
<path fill="none" stroke="black" d="M14741.8,-3259.21C14745.25,-3250.37 14749.01,-3240.72 14752.72,-3231.21"/>
<polygon fill="black" stroke="black" points="14756.02,-3232.37 14756.39,-3221.78 14749.5,-3229.83 14756.02,-3232.37"/>
</g>
<!-- mlp_fc2_2_3 -->
<g id="node948" class="node">
<title>mlp_fc2_2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="15118.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15118.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15118.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15118.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15118.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_3&#45;&gt;mlp_fc2_2_3 -->
<g id="edge1133" class="edge">
<title>mlp_gelu_2_3&#45;&gt;mlp_fc2_2_3</title>
<path fill="none" stroke="black" d="M15075.88,-3259.53C15080.5,-3250.4 15085.57,-3240.38 15090.55,-3230.53"/>
<polygon fill="black" stroke="black" points="15093.69,-3232.07 15095.08,-3221.57 15087.44,-3228.92 15093.69,-3232.07"/>
</g>
<!-- mlp_fc2_2_4 -->
<g id="node949" class="node">
<title>mlp_fc2_2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15408.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15408.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15408.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15408.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15408.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_4&#45;&gt;mlp_fc2_2_4 -->
<g id="edge1134" class="edge">
<title>mlp_gelu_2_4&#45;&gt;mlp_fc2_2_4</title>
<path fill="none" stroke="black" d="M15397.42,-3259.21C15398.54,-3250.75 15399.76,-3241.54 15400.97,-3232.43"/>
<polygon fill="black" stroke="black" points="15404.48,-3232.59 15402.33,-3222.22 15397.54,-3231.67 15404.48,-3232.59"/>
</g>
<!-- mlp_fc2_2_5 -->
<g id="node950" class="node">
<title>mlp_fc2_2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15701.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15701.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15701.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15701.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15701.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_5&#45;&gt;mlp_fc2_2_5 -->
<g id="edge1135" class="edge">
<title>mlp_gelu_2_5&#45;&gt;mlp_fc2_2_5</title>
<path fill="none" stroke="black" d="M15693.21,-3259.21C15694.05,-3250.75 15694.96,-3241.54 15695.87,-3232.43"/>
<polygon fill="black" stroke="black" points="15699.38,-3232.52 15696.89,-3222.22 15692.41,-3231.82 15699.38,-3232.52"/>
</g>
<!-- mlp_fc2_2_6 -->
<g id="node951" class="node">
<title>mlp_fc2_2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15998.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15998.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15998.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15998.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15998.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_6&#45;&gt;mlp_fc2_2_6 -->
<g id="edge1136" class="edge">
<title>mlp_gelu_2_6&#45;&gt;mlp_fc2_2_6</title>
<path fill="none" stroke="black" d="M15990.21,-3259.21C15991.05,-3250.75 15991.96,-3241.54 15992.87,-3232.43"/>
<polygon fill="black" stroke="black" points="15996.38,-3232.52 15993.89,-3222.22 15989.41,-3231.82 15996.38,-3232.52"/>
</g>
<!-- mlp_fc2_2_7 -->
<g id="node952" class="node">
<title>mlp_fc2_2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16288.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16288.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16288.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16288.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16288.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_7&#45;&gt;mlp_fc2_2_7 -->
<g id="edge1137" class="edge">
<title>mlp_gelu_2_7&#45;&gt;mlp_fc2_2_7</title>
<path fill="none" stroke="black" d="M16285.09,-3259.21C16285.44,-3250.75 16285.82,-3241.54 16286.2,-3232.43"/>
<polygon fill="black" stroke="black" points="16289.7,-3232.36 16286.62,-3222.22 16282.71,-3232.07 16289.7,-3232.36"/>
</g>
<!-- mlp_fc2_2_8 -->
<g id="node953" class="node">
<title>mlp_fc2_2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16578.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16578.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16578.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16578.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16578.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_8&#45;&gt;mlp_fc2_2_8 -->
<g id="edge1138" class="edge">
<title>mlp_gelu_2_8&#45;&gt;mlp_fc2_2_8</title>
<path fill="none" stroke="black" d="M16579.97,-3259.21C16579.83,-3250.75 16579.67,-3241.54 16579.52,-3232.43"/>
<polygon fill="black" stroke="black" points="16583.02,-3232.16 16579.35,-3222.22 16576.02,-3232.28 16583.02,-3232.16"/>
</g>
<!-- mlp_fc2_2_9 -->
<g id="node954" class="node">
<title>mlp_fc2_2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16872.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16872.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16872.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16872.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16872.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_9&#45;&gt;mlp_fc2_2_9 -->
<g id="edge1139" class="edge">
<title>mlp_gelu_2_9&#45;&gt;mlp_fc2_2_9</title>
<path fill="none" stroke="black" d="M16876.06,-3259.21C16875.71,-3250.75 16875.33,-3241.54 16874.95,-3232.43"/>
<polygon fill="black" stroke="black" points="16878.44,-3232.07 16874.53,-3222.22 16871.44,-3232.36 16878.44,-3232.07"/>
</g>
<!-- mlp_fc2_2_10 -->
<g id="node955" class="node">
<title>mlp_fc2_2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="17167.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17167.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17167.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17167.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17167.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_10&#45;&gt;mlp_fc2_2_10 -->
<g id="edge1140" class="edge">
<title>mlp_gelu_2_10&#45;&gt;mlp_fc2_2_10</title>
<path fill="none" stroke="black" d="M17172.45,-3259.21C17171.96,-3250.75 17171.43,-3241.54 17170.9,-3232.43"/>
<polygon fill="black" stroke="black" points="17174.38,-3232 17170.31,-3222.22 17167.39,-3232.41 17174.38,-3232"/>
</g>
<!-- mlp_fc2_2_11 -->
<g id="node956" class="node">
<title>mlp_fc2_2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17463.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17463.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17463.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17463.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17463.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_11&#45;&gt;mlp_fc2_2_11 -->
<g id="edge1141" class="edge">
<title>mlp_gelu_2_11&#45;&gt;mlp_fc2_2_11</title>
<path fill="none" stroke="black" d="M17469.15,-3259.21C17468.59,-3250.75 17467.98,-3241.54 17467.37,-3232.43"/>
<polygon fill="black" stroke="black" points="17470.85,-3231.97 17466.7,-3222.22 17463.87,-3232.43 17470.85,-3231.97"/>
</g>
<!-- mlp_fc2_2_12 -->
<g id="node957" class="node">
<title>mlp_fc2_2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17760.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17760.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17760.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17760.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17760.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_12&#45;&gt;mlp_fc2_2_12 -->
<g id="edge1142" class="edge">
<title>mlp_gelu_2_12&#45;&gt;mlp_fc2_2_12</title>
<path fill="none" stroke="black" d="M17778.7,-3259.21C17776.86,-3250.65 17774.85,-3241.34 17772.86,-3232.13"/>
<polygon fill="black" stroke="black" points="17776.26,-3231.26 17770.73,-3222.22 17769.41,-3232.73 17776.26,-3231.26"/>
</g>
<!-- mlp_fc2_2_13 -->
<g id="node958" class="node">
<title>mlp_fc2_2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="18057.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18057.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18057.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18057.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18057.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_13&#45;&gt;mlp_fc2_2_13 -->
<g id="edge1143" class="edge">
<title>mlp_gelu_2_13&#45;&gt;mlp_fc2_2_13</title>
<path fill="none" stroke="black" d="M18078.49,-3259.21C18076.36,-3250.65 18074.05,-3241.34 18071.76,-3232.13"/>
<polygon fill="black" stroke="black" points="18075.1,-3231.08 18069.29,-3222.22 18068.31,-3232.77 18075.1,-3231.08"/>
</g>
<!-- mlp_fc2_2_14 -->
<g id="node959" class="node">
<title>mlp_fc2_2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18354.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18354.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18354.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18354.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18354.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_14&#45;&gt;mlp_fc2_2_14 -->
<g id="edge1144" class="edge">
<title>mlp_gelu_2_14&#45;&gt;mlp_fc2_2_14</title>
<path fill="none" stroke="black" d="M18376.89,-3259.21C18374.62,-3250.65 18372.14,-3241.34 18369.7,-3232.13"/>
<polygon fill="black" stroke="black" points="18373.02,-3230.99 18367.07,-3222.22 18366.25,-3232.78 18373.02,-3230.99"/>
</g>
<!-- mlp_fc2_2_15 -->
<g id="node960" class="node">
<title>mlp_fc2_2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18651.57" cy="-3174.13" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18651.57" y="-3192.93" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18651.57" y="-3177.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18651.57" y="-3162.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18651.57" y="-3147.93" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_2_15&#45;&gt;mlp_fc2_2_15 -->
<g id="edge1145" class="edge">
<title>mlp_gelu_2_15&#45;&gt;mlp_fc2_2_15</title>
<path fill="none" stroke="black" d="M18674.58,-3259.21C18672.24,-3250.65 18669.69,-3241.34 18667.17,-3232.13"/>
<polygon fill="black" stroke="black" points="18670.48,-3230.94 18664.46,-3222.22 18663.72,-3232.79 18670.48,-3230.94"/>
</g>
<!-- allreduce_mlp_2 -->
<g id="node961" class="node">
<title>allreduce_mlp_2</title>
<polygon fill="red" stroke="black" points="16368.57,-3089.05 16243.57,-3036.05 16368.57,-2983.05 16493.57,-3036.05 16368.57,-3089.05"/>
<text text-anchor="middle" x="16368.57" y="-3047.35" font-family="Times,serif" font-size="14.00">AllReduce MLP</text>
<text text-anchor="middle" x="16368.57" y="-3032.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="16368.57" y="-3017.35" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_fc2_2_0&#45;&gt;allreduce_mlp_2 -->
<g id="edge1146" class="edge">
<title>mlp_fc2_2_0&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M14244.27,-3143.89C14272.98,-3136.88 14304.29,-3130.22 14333.57,-3126.05 14704.35,-3073.23 15854.66,-3046.89 16240.74,-3039.36"/>
<polygon fill="black" stroke="black" points="16240.9,-3042.86 16250.83,-3039.17 16240.76,-3035.86 16240.9,-3042.86"/>
</g>
<!-- mlp_fc2_2_1&#45;&gt;allreduce_mlp_2 -->
<g id="edge1147" class="edge">
<title>mlp_fc2_2_1&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M14571.01,-3140.54C14591.13,-3134.79 14612.38,-3129.54 14632.57,-3126.05 14941.94,-3072.53 15895.25,-3047.21 16241.35,-3039.61"/>
<polygon fill="black" stroke="black" points="16241.49,-3043.11 16251.41,-3039.39 16241.34,-3036.11 16241.49,-3043.11"/>
</g>
<!-- mlp_fc2_2_2&#45;&gt;allreduce_mlp_2 -->
<g id="edge1148" class="edge">
<title>mlp_fc2_2_2&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M14880.61,-3144.95C14911.37,-3137.72 14945.14,-3130.68 14976.57,-3126.05 15437.05,-3058.14 15990.77,-3042.03 16238.13,-3038.22"/>
<polygon fill="black" stroke="black" points="16238.29,-3041.72 16248.24,-3038.07 16238.19,-3034.72 16238.29,-3041.72"/>
</g>
<!-- mlp_fc2_2_3&#45;&gt;allreduce_mlp_2 -->
<g id="edge1149" class="edge">
<title>mlp_fc2_2_3&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M15212.08,-3139.86C15229.99,-3134.49 15248.72,-3129.56 15266.57,-3126.05 15612.61,-3057.95 16029.61,-3041.76 16237.45,-3038.04"/>
<polygon fill="black" stroke="black" points="16237.55,-3041.54 16247.49,-3037.87 16237.43,-3034.54 16237.55,-3041.54"/>
</g>
<!-- mlp_fc2_2_4&#45;&gt;allreduce_mlp_2 -->
<g id="edge1150" class="edge">
<title>mlp_fc2_2_4&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M15503.7,-3140.42C15522.07,-3134.98 15541.3,-3129.86 15559.57,-3126.05 15800.99,-3075.62 16089.28,-3052.58 16248.3,-3043.03"/>
<polygon fill="black" stroke="black" points="16248.81,-3046.5 16258.59,-3042.42 16248.4,-3039.52 16248.81,-3046.5"/>
</g>
<!-- mlp_fc2_2_5&#45;&gt;allreduce_mlp_2 -->
<g id="edge1151" class="edge">
<title>mlp_fc2_2_5&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M15799.47,-3141.41C15818.31,-3135.87 15837.97,-3130.47 15856.57,-3126.05 15996.73,-3092.71 16161.25,-3066.33 16265.2,-3051.2"/>
<polygon fill="black" stroke="black" points="16265.99,-3054.63 16275.38,-3049.73 16264.98,-3047.7 16265.99,-3054.63"/>
</g>
<!-- mlp_fc2_2_6&#45;&gt;allreduce_mlp_2 -->
<g id="edge1152" class="edge">
<title>mlp_fc2_2_6&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M16090.51,-3139.32C16152.95,-3116.35 16234.52,-3086.35 16293.14,-3064.79"/>
<polygon fill="black" stroke="black" points="16294.54,-3068 16302.71,-3061.27 16292.12,-3061.44 16294.54,-3068"/>
</g>
<!-- mlp_fc2_2_7&#45;&gt;allreduce_mlp_2 -->
<g id="edge1153" class="edge">
<title>mlp_fc2_2_7&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M16315.88,-3126.68C16323.31,-3114.04 16331.39,-3100.29 16338.94,-3087.45"/>
<polygon fill="black" stroke="black" points="16342.02,-3089.12 16344.07,-3078.73 16335.99,-3085.57 16342.02,-3089.12"/>
</g>
<!-- mlp_fc2_2_8&#45;&gt;allreduce_mlp_2 -->
<g id="edge1154" class="edge">
<title>mlp_fc2_2_8&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M16514.71,-3131.75C16486.4,-3113.4 16453.35,-3091.98 16425.85,-3074.16"/>
<polygon fill="black" stroke="black" points="16427.42,-3071.01 16417.13,-3068.51 16423.62,-3076.89 16427.42,-3071.01"/>
</g>
<!-- mlp_fc2_2_9&#45;&gt;allreduce_mlp_2 -->
<g id="edge1155" class="edge">
<title>mlp_fc2_2_9&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M16773.86,-3141.73C16756.17,-3136.33 16737.86,-3130.9 16720.57,-3126.05 16631.47,-3101 16528.77,-3075.4 16457.39,-3058.13"/>
<polygon fill="black" stroke="black" points="16458.07,-3054.69 16447.53,-3055.75 16456.43,-3061.5 16458.07,-3054.69"/>
</g>
<!-- mlp_fc2_2_10&#45;&gt;allreduce_mlp_2 -->
<g id="edge1156" class="edge">
<title>mlp_fc2_2_10&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M17071.08,-3140.85C17052.47,-3135.36 17033.03,-3130.13 17014.57,-3126.05 16829.59,-3085.12 16610.41,-3059.67 16480.79,-3046.95"/>
<polygon fill="black" stroke="black" points="16480.75,-3043.43 16470.45,-3045.95 16480.07,-3050.4 16480.75,-3043.43"/>
</g>
<!-- mlp_fc2_2_11&#45;&gt;allreduce_mlp_2 -->
<g id="edge1157" class="edge">
<title>mlp_fc2_2_11&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M17367.81,-3140.58C17348.7,-3135.02 17328.63,-3129.82 17309.57,-3126.05 17020.86,-3068.87 16674.79,-3048.12 16493.46,-3040.83"/>
<polygon fill="black" stroke="black" points="16493.49,-3037.32 16483.36,-3040.43 16493.21,-3044.32 16493.49,-3037.32"/>
</g>
<!-- mlp_fc2_2_12&#45;&gt;allreduce_mlp_2 -->
<g id="edge1158" class="edge">
<title>mlp_fc2_2_12&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M17665.07,-3140.49C17645.58,-3134.86 17625.07,-3129.66 17605.57,-3126.05 17208.71,-3052.45 16729.76,-3038.91 16501.75,-3036.94"/>
<polygon fill="black" stroke="black" points="16501.78,-3033.44 16491.75,-3036.86 16501.72,-3040.44 16501.78,-3033.44"/>
</g>
<!-- mlp_fc2_2_13&#45;&gt;allreduce_mlp_2 -->
<g id="edge1159" class="edge">
<title>mlp_fc2_2_13&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M17962.53,-3140.39C17942.91,-3134.73 17922.23,-3129.55 17902.57,-3126.05 17633.11,-3078 16809.96,-3049.8 16493.94,-3040.49"/>
<polygon fill="black" stroke="black" points="16493.93,-3036.99 16483.83,-3040.2 16493.72,-3043.99 16493.93,-3036.99"/>
</g>
<!-- mlp_fc2_2_14&#45;&gt;allreduce_mlp_2 -->
<g id="edge1160" class="edge">
<title>mlp_fc2_2_14&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M18259.55,-3140.25C18239.93,-3134.6 18219.25,-3129.46 18199.57,-3126.05 17871.61,-3069.16 16857.14,-3045.82 16497.01,-3039.18"/>
<polygon fill="black" stroke="black" points="16496.87,-3035.68 16486.81,-3038.99 16496.74,-3042.68 16496.87,-3035.68"/>
</g>
<!-- mlp_fc2_2_15&#45;&gt;allreduce_mlp_2 -->
<g id="edge1161" class="edge">
<title>mlp_fc2_2_15&#45;&gt;allreduce_mlp_2</title>
<path fill="none" stroke="black" d="M18556.98,-3140.31C18537.23,-3134.62 18516.39,-3129.44 18496.57,-3126.05 18310.65,-3094.16 18261.03,-3115.14 18072.57,-3107.05 17479.77,-3081.59 16770.88,-3053.09 16490.91,-3041.91"/>
<polygon fill="black" stroke="black" points="16490.86,-3038.41 16480.73,-3041.51 16490.58,-3045.4 16490.86,-3038.41"/>
</g>
<!-- residual2_2 -->
<g id="node962" class="node">
<title>residual2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="16368.57" cy="-2908.55" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="16368.57" y="-2919.85" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16368.57" y="-2904.85" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="16368.57" y="-2889.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_mlp_2&#45;&gt;residual2_2 -->
<g id="edge1162" class="edge">
<title>allreduce_mlp_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M16368.57,-2982.91C16368.57,-2974.2 16368.57,-2965.2 16368.57,-2956.63"/>
<polygon fill="black" stroke="black" points="16372.07,-2956.42 16368.57,-2946.42 16365.07,-2956.42 16372.07,-2956.42"/>
</g>
<!-- ln1_3_0 -->
<g id="node963" class="node">
<title>ln1_3_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13112.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13112.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13112.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13112.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_0 -->
<g id="edge1163" class="edge">
<title>residual2_2&#45;&gt;ln1_3_0</title>
<path fill="none" stroke="black" d="M16213.36,-2905.23C15801.8,-2898.66 14648.52,-2877.52 13689.57,-2834.05 13545.38,-2827.51 13381.1,-2816.8 13264.81,-2808.67"/>
<polygon fill="black" stroke="black" points="13264.99,-2805.17 13254.77,-2807.96 13264.5,-2812.15 13264.99,-2805.17"/>
</g>
<!-- ln1_3_1 -->
<g id="node964" class="node">
<title>ln1_3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="13847.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13847.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13847.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13847.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_1 -->
<g id="edge1164" class="edge">
<title>residual2_2&#45;&gt;ln1_3_1</title>
<path fill="none" stroke="black" d="M16213.31,-2905.71C15858.74,-2900.75 14962.43,-2883.94 14214.57,-2834.05 14141.04,-2829.14 14059.45,-2821.27 13991.91,-2814.09"/>
<polygon fill="black" stroke="black" points="13991.93,-2810.57 13981.62,-2812.99 13991.19,-2817.53 13991.93,-2810.57"/>
</g>
<!-- ln1_3_2 -->
<g id="node965" class="node">
<title>ln1_3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14372.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14372.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14372.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14372.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_2 -->
<g id="edge1165" class="edge">
<title>residual2_2&#45;&gt;ln1_3_2</title>
<path fill="none" stroke="black" d="M16213.19,-2905.93C15909.49,-2901.66 15216.1,-2886.52 14635.57,-2834.05 14593.69,-2830.26 14548.26,-2824.54 14507.13,-2818.74"/>
<polygon fill="black" stroke="black" points="14507.44,-2815.25 14497.05,-2817.3 14506.45,-2822.18 14507.44,-2815.25"/>
</g>
<!-- ln1_3_3 -->
<g id="node966" class="node">
<title>ln1_3_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14793.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14793.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14793.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14793.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_3 -->
<g id="edge1166" class="edge">
<title>residual2_2&#45;&gt;ln1_3_3</title>
<path fill="none" stroke="black" d="M16213.52,-2905.16C15959.8,-2899.92 15440.41,-2883.59 15003.57,-2834.05 14976.31,-2830.95 14947.23,-2826.59 14919.66,-2821.95"/>
<polygon fill="black" stroke="black" points="14920.02,-2818.46 14909.58,-2820.23 14918.85,-2825.36 14920.02,-2818.46"/>
</g>
<!-- ln1_3_4 -->
<g id="node967" class="node">
<title>ln1_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="15161.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15161.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15161.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15161.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_4 -->
<g id="edge1167" class="edge">
<title>residual2_2&#45;&gt;ln1_3_4</title>
<path fill="none" stroke="black" d="M16215.01,-2902.46C16014.36,-2894.45 15652.41,-2875.34 15345.57,-2834.05 15324.95,-2831.27 15303.17,-2827.61 15282.08,-2823.67"/>
<polygon fill="black" stroke="black" points="15282.6,-2820.21 15272.12,-2821.79 15281.3,-2827.09 15282.6,-2820.21"/>
</g>
<!-- ln1_3_5 -->
<g id="node968" class="node">
<title>ln1_3_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15503.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15503.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15503.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15503.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_5 -->
<g id="edge1168" class="edge">
<title>residual2_2&#45;&gt;ln1_3_5</title>
<path fill="none" stroke="black" d="M16221.09,-2896.44C16080.19,-2884.76 15862.13,-2863.91 15674.57,-2834.05 15657.53,-2831.33 15639.63,-2828.02 15622.08,-2824.52"/>
<polygon fill="black" stroke="black" points="15622.3,-2820.99 15611.81,-2822.44 15620.91,-2827.85 15622.3,-2820.99"/>
</g>
<!-- ln1_3_6 -->
<g id="node969" class="node">
<title>ln1_3_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15832.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15832.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15832.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15832.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_6 -->
<g id="edge1169" class="edge">
<title>residual2_2&#45;&gt;ln1_3_6</title>
<path fill="none" stroke="black" d="M16248.97,-2884.55C16176.21,-2870.38 16081.44,-2851.63 15997.57,-2834.05 15982.85,-2830.96 15967.41,-2827.65 15952.12,-2824.32"/>
<polygon fill="black" stroke="black" points="15952.63,-2820.85 15942.11,-2822.13 15951.14,-2827.69 15952.63,-2820.85"/>
</g>
<!-- ln1_3_7 -->
<g id="node970" class="node">
<title>ln1_3_7</title>
<ellipse fill="lightgreen" stroke="black" cx="16155.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16155.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16155.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16155.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_7 -->
<g id="edge1170" class="edge">
<title>residual2_2&#45;&gt;ln1_3_7</title>
<path fill="none" stroke="black" d="M16304.09,-2874.24C16280.21,-2861.91 16252.97,-2847.84 16228.39,-2835.15"/>
<polygon fill="black" stroke="black" points="16229.96,-2832.02 16219.47,-2830.55 16226.75,-2838.24 16229.96,-2832.02"/>
</g>
<!-- ln1_3_8 -->
<g id="node971" class="node">
<title>ln1_3_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16582.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16582.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16582.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16582.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_8 -->
<g id="edge1171" class="edge">
<title>residual2_2&#45;&gt;ln1_3_8</title>
<path fill="none" stroke="black" d="M16433.07,-2874.39C16457.18,-2862 16484.74,-2847.84 16509.56,-2835.07"/>
<polygon fill="black" stroke="black" points="16511.28,-2838.13 16518.58,-2830.44 16508.08,-2831.9 16511.28,-2838.13"/>
</g>
<!-- ln1_3_9 -->
<g id="node972" class="node">
<title>ln1_3_9</title>
<ellipse fill="lightgreen" stroke="black" cx="17068.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17068.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17068.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17068.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_9 -->
<g id="edge1172" class="edge">
<title>residual2_2&#45;&gt;ln1_3_9</title>
<path fill="none" stroke="black" d="M16496.96,-2887.37C16620.9,-2867.89 16807.81,-2838.52 16933.84,-2818.72"/>
<polygon fill="black" stroke="black" points="16934.6,-2822.14 16943.94,-2817.13 16933.52,-2815.23 16934.6,-2822.14"/>
</g>
<!-- ln1_3_10 -->
<g id="node973" class="node">
<title>ln1_3_10</title>
<ellipse fill="lightgreen" stroke="black" cx="17469.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17469.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17469.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17469.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_10 -->
<g id="edge1173" class="edge">
<title>residual2_2&#45;&gt;ln1_3_10</title>
<path fill="none" stroke="black" d="M16517.67,-2897.66C16689.04,-2885.64 16978.62,-2863.26 17226.57,-2834.05 17262.2,-2829.85 17300.64,-2824.47 17336.21,-2819.14"/>
<polygon fill="black" stroke="black" points="17336.79,-2822.59 17346.16,-2817.64 17335.75,-2815.67 17336.79,-2822.59"/>
</g>
<!-- ln1_3_11 -->
<g id="node974" class="node">
<title>ln1_3_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17827.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17827.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17827.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17827.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_11 -->
<g id="edge1174" class="edge">
<title>residual2_2&#45;&gt;ln1_3_11</title>
<path fill="none" stroke="black" d="M16523.68,-2904.58C16761.86,-2898.66 17231.65,-2881.55 17627.57,-2834.05 17652.32,-2831.08 17678.64,-2826.97 17703.77,-2822.57"/>
<polygon fill="black" stroke="black" points="17704.48,-2826 17713.71,-2820.81 17703.26,-2819.11 17704.48,-2826"/>
</g>
<!-- ln1_3_12 -->
<g id="node975" class="node">
<title>ln1_3_12</title>
<ellipse fill="lightgreen" stroke="black" cx="18164.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18164.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18164.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18164.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_12 -->
<g id="edge1175" class="edge">
<title>residual2_2&#45;&gt;ln1_3_12</title>
<path fill="none" stroke="black" d="M16524.22,-2908.5C16813.29,-2908.5 17452.2,-2900.14 17985.57,-2834.05 18005.32,-2831.6 18026.14,-2828.16 18046.31,-2824.36"/>
<polygon fill="black" stroke="black" points="18047,-2827.79 18056.16,-2822.47 18045.68,-2820.92 18047,-2827.79"/>
</g>
<!-- ln1_3_13 -->
<g id="node976" class="node">
<title>ln1_3_13</title>
<ellipse fill="lightgreen" stroke="black" cx="18491.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18491.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18491.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18491.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_13 -->
<g id="edge1176" class="edge">
<title>residual2_2&#45;&gt;ln1_3_13</title>
<path fill="none" stroke="black" d="M16521.69,-2901.95C16788.54,-2892.18 17356.14,-2871.3 17835.57,-2853.05 18052.03,-2844.8 18107.68,-2861.23 18322.57,-2834.05 18340.16,-2831.82 18358.63,-2828.68 18376.64,-2825.16"/>
<polygon fill="black" stroke="black" points="18377.46,-2828.57 18386.58,-2823.17 18376.09,-2821.7 18377.46,-2828.57"/>
</g>
<!-- ln1_3_14 -->
<g id="node977" class="node">
<title>ln1_3_14</title>
<ellipse fill="lightgreen" stroke="black" cx="18812.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18812.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18812.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18812.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_14 -->
<g id="edge1177" class="edge">
<title>residual2_2&#45;&gt;ln1_3_14</title>
<path fill="none" stroke="black" d="M16523.87,-2906.35C16967.85,-2902.31 18237.11,-2886.4 18649.57,-2834.05 18665.65,-2832 18682.48,-2829.11 18698.97,-2825.84"/>
<polygon fill="black" stroke="black" points="18700.08,-2829.19 18709.18,-2823.76 18698.68,-2822.33 18700.08,-2829.19"/>
</g>
<!-- ln1_3_15 -->
<g id="node978" class="node">
<title>ln1_3_15</title>
<ellipse fill="lightgreen" stroke="black" cx="19131.57" cy="-2796.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="19131.57" y="-2807.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19131.57" y="-2792.85" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="19131.57" y="-2777.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_15 -->
<g id="edge1178" class="edge">
<title>residual2_2&#45;&gt;ln1_3_15</title>
<path fill="none" stroke="black" d="M16523.15,-2904.14C16870.43,-2896.36 17738.94,-2876.16 18465.57,-2853.05 18690.06,-2845.91 18747.87,-2863.22 18970.57,-2834.05 18986.34,-2831.98 19002.84,-2829.1 19019,-2825.84"/>
<polygon fill="black" stroke="black" points="19019.93,-2829.23 19029.02,-2823.78 19018.52,-2822.37 19019.93,-2829.23"/>
</g>
<!-- qkv_proj_3_0 -->
<g id="node979" class="node">
<title>qkv_proj_3_0</title>
<ellipse fill="orange" stroke="black" cx="11029.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11029.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11029.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11029.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="11029.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11029.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_0&#45;&gt;qkv_proj_3_0 -->
<g id="edge1179" class="edge">
<title>ln1_3_0&#45;&gt;qkv_proj_3_0</title>
<path fill="none" stroke="black" d="M12968.58,-2786.48C12589.88,-2762.63 11568.66,-2698.31 11181.33,-2673.91"/>
<polygon fill="black" stroke="black" points="11181.38,-2670.41 11171.18,-2673.27 11180.94,-2677.4 11181.38,-2670.41"/>
</g>
<!-- qkv_proj_3_1 -->
<g id="node980" class="node">
<title>qkv_proj_3_1</title>
<ellipse fill="orange" stroke="black" cx="12309.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12309.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12309.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12309.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="12309.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12309.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_1&#45;&gt;qkv_proj_3_1 -->
<g id="edge1180" class="edge">
<title>ln1_3_1&#45;&gt;qkv_proj_3_1</title>
<path fill="none" stroke="black" d="M13707.35,-2783.58C13418.03,-2758.91 12757.12,-2702.53 12459.61,-2677.15"/>
<polygon fill="black" stroke="black" points="12459.87,-2673.66 12449.61,-2676.3 12459.28,-2680.64 12459.87,-2673.66"/>
</g>
<!-- qkv_proj_3_2 -->
<g id="node981" class="node">
<title>qkv_proj_3_2</title>
<ellipse fill="orange" stroke="black" cx="13350.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13350.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13350.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13350.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="13350.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13350.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_2&#45;&gt;qkv_proj_3_2 -->
<g id="edge1181" class="edge">
<title>ln1_3_2&#45;&gt;qkv_proj_3_2</title>
<path fill="none" stroke="black" d="M14241.32,-2778.7C14050.15,-2754.16 13696.25,-2708.73 13496.91,-2683.14"/>
<polygon fill="black" stroke="black" points="13497.32,-2679.66 13486.95,-2681.86 13496.43,-2686.61 13497.32,-2679.66"/>
</g>
<!-- qkv_proj_3_3 -->
<g id="node982" class="node">
<title>qkv_proj_3_3</title>
<ellipse fill="orange" stroke="black" cx="14150.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14150.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14150.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14150.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="14150.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14150.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_3&#45;&gt;qkv_proj_3_3 -->
<g id="edge1182" class="edge">
<title>ln1_3_3&#45;&gt;qkv_proj_3_3</title>
<path fill="none" stroke="black" d="M14679.73,-2772.32C14570.37,-2750.01 14405,-2716.27 14288.28,-2692.45"/>
<polygon fill="black" stroke="black" points="14288.7,-2688.97 14278.2,-2690.4 14287.3,-2695.82 14288.7,-2688.97"/>
</g>
<!-- qkv_proj_3_4 -->
<g id="node983" class="node">
<title>qkv_proj_3_4</title>
<ellipse fill="orange" stroke="black" cx="15015.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15015.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15015.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15015.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="15015.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15015.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_4&#45;&gt;qkv_proj_3_4 -->
<g id="edge1183" class="edge">
<title>ln1_3_4&#45;&gt;qkv_proj_3_4</title>
<path fill="none" stroke="black" d="M15122.06,-2760.04C15109.67,-2748.9 15095.62,-2736.28 15081.9,-2723.95"/>
<polygon fill="black" stroke="black" points="15084.09,-2721.22 15074.31,-2717.14 15079.41,-2726.43 15084.09,-2721.22"/>
</g>
<!-- qkv_proj_3_5 -->
<g id="node984" class="node">
<title>qkv_proj_3_5</title>
<ellipse fill="orange" stroke="black" cx="15389.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15389.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15389.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15389.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="15389.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15389.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_5&#45;&gt;qkv_proj_3_5 -->
<g id="edge1184" class="edge">
<title>ln1_3_5&#45;&gt;qkv_proj_3_5</title>
<path fill="none" stroke="black" d="M15472.42,-2759.7C15463.53,-2749.47 15453.57,-2738.01 15443.73,-2726.68"/>
<polygon fill="black" stroke="black" points="15446.15,-2724.13 15436.95,-2718.88 15440.87,-2728.72 15446.15,-2724.13"/>
</g>
<!-- qkv_proj_3_6 -->
<g id="node985" class="node">
<title>qkv_proj_3_6</title>
<ellipse fill="orange" stroke="black" cx="15749.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15749.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15749.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15749.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="15749.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15749.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_6&#45;&gt;qkv_proj_3_6 -->
<g id="edge1185" class="edge">
<title>ln1_3_6&#45;&gt;qkv_proj_3_6</title>
<path fill="none" stroke="black" d="M15809.67,-2759.35C15803.75,-2749.99 15797.19,-2739.62 15790.64,-2729.27"/>
<polygon fill="black" stroke="black" points="15793.47,-2727.19 15785.16,-2720.61 15787.55,-2730.93 15793.47,-2727.19"/>
</g>
<!-- qkv_proj_3_7 -->
<g id="node986" class="node">
<title>qkv_proj_3_7</title>
<ellipse fill="orange" stroke="black" cx="16148.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16148.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16148.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16148.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="16148.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16148.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_7&#45;&gt;qkv_proj_3_7 -->
<g id="edge1186" class="edge">
<title>ln1_3_7&#45;&gt;qkv_proj_3_7</title>
<path fill="none" stroke="black" d="M16153.62,-2759C16153.18,-2750.74 16152.7,-2741.71 16152.22,-2732.6"/>
<polygon fill="black" stroke="black" points="16155.7,-2732.14 16151.67,-2722.34 16148.71,-2732.51 16155.7,-2732.14"/>
</g>
<!-- qkv_proj_3_8 -->
<g id="node987" class="node">
<title>qkv_proj_3_8</title>
<ellipse fill="orange" stroke="black" cx="16621.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16621.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16621.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16621.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="16621.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16621.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_8&#45;&gt;qkv_proj_3_8 -->
<g id="edge1187" class="edge">
<title>ln1_3_8&#45;&gt;qkv_proj_3_8</title>
<path fill="none" stroke="black" d="M16593.44,-2759C16595.98,-2750.45 16598.77,-2741.07 16601.57,-2731.64"/>
<polygon fill="black" stroke="black" points="16604.99,-2732.42 16604.49,-2721.84 16598.28,-2730.43 16604.99,-2732.42"/>
</g>
<!-- qkv_proj_3_9 -->
<g id="node988" class="node">
<title>qkv_proj_3_9</title>
<ellipse fill="orange" stroke="black" cx="17324.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17324.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17324.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17324.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="17324.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17324.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_9&#45;&gt;qkv_proj_3_9 -->
<g id="edge1188" class="edge">
<title>ln1_3_9&#45;&gt;qkv_proj_3_9</title>
<path fill="none" stroke="black" d="M17132.84,-2762.61C17161.29,-2748.03 17195.37,-2730.57 17226.85,-2714.43"/>
<polygon fill="black" stroke="black" points="17228.79,-2717.37 17236.09,-2709.7 17225.6,-2711.14 17228.79,-2717.37"/>
</g>
<!-- qkv_proj_3_10 -->
<g id="node989" class="node">
<title>qkv_proj_3_10</title>
<ellipse fill="orange" stroke="black" cx="17942.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17942.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17942.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17942.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="17942.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17942.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_10&#45;&gt;qkv_proj_3_10 -->
<g id="edge1189" class="edge">
<title>ln1_3_10&#45;&gt;qkv_proj_3_10</title>
<path fill="none" stroke="black" d="M17567.87,-2768.28C17639.51,-2748.41 17737.22,-2721.31 17814.89,-2699.77"/>
<polygon fill="black" stroke="black" points="17816.05,-2703.08 17824.75,-2697.04 17814.18,-2696.34 17816.05,-2703.08"/>
</g>
<!-- qkv_proj_3_11 -->
<g id="node990" class="node">
<title>qkv_proj_3_11</title>
<ellipse fill="orange" stroke="black" cx="18403.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18403.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18403.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18403.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="18403.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18403.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_11&#45;&gt;qkv_proj_3_11 -->
<g id="edge1190" class="edge">
<title>ln1_3_11&#45;&gt;qkv_proj_3_11</title>
<path fill="none" stroke="black" d="M17936.25,-2770.79C18030.67,-2749.29 18167.79,-2718.06 18269.1,-2694.98"/>
<polygon fill="black" stroke="black" points="18270.13,-2698.34 18279.1,-2692.71 18268.57,-2691.51 18270.13,-2698.34"/>
</g>
<!-- qkv_proj_3_12 -->
<g id="node991" class="node">
<title>qkv_proj_3_12</title>
<ellipse fill="orange" stroke="black" cx="18786.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18786.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18786.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18786.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="18786.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18786.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_12&#45;&gt;qkv_proj_3_12 -->
<g id="edge1191" class="edge">
<title>ln1_3_12&#45;&gt;qkv_proj_3_12</title>
<path fill="none" stroke="black" d="M18274.42,-2771.02C18294.08,-2766.86 18314.41,-2762.7 18333.57,-2759.05 18432.26,-2740.21 18458.21,-2742.51 18556.57,-2722.05 18589.36,-2715.23 18624.52,-2706.92 18657.25,-2698.75"/>
<polygon fill="black" stroke="black" points="18658.48,-2702.05 18667.33,-2696.23 18656.78,-2695.26 18658.48,-2702.05"/>
</g>
<!-- qkv_proj_3_13 -->
<g id="node992" class="node">
<title>qkv_proj_3_13</title>
<ellipse fill="orange" stroke="black" cx="19130.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="19130.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19130.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19130.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="19130.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19130.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_13&#45;&gt;qkv_proj_3_13 -->
<g id="edge1192" class="edge">
<title>ln1_3_13&#45;&gt;qkv_proj_3_13</title>
<path fill="none" stroke="black" d="M18598.26,-2770.19C18616.97,-2766.17 18636.3,-2762.27 18654.57,-2759.05 18780.36,-2736.85 18814.68,-2748.82 18939.57,-2722.05 18962.79,-2717.07 18987.27,-2710.62 19010.67,-2703.84"/>
<polygon fill="black" stroke="black" points="19011.67,-2707.2 19020.28,-2701.03 19009.7,-2700.48 19011.67,-2707.2"/>
</g>
<!-- qkv_proj_3_14 -->
<g id="node993" class="node">
<title>qkv_proj_3_14</title>
<ellipse fill="orange" stroke="black" cx="20432.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20432.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20432.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20432.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="20432.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20432.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_14&#45;&gt;qkv_proj_3_14 -->
<g id="edge1193" class="edge">
<title>ln1_3_14&#45;&gt;qkv_proj_3_14</title>
<path fill="none" stroke="black" d="M18918.38,-2770.09C18936.72,-2766.1 18955.66,-2762.24 18973.57,-2759.05 19037.56,-2747.63 19053.86,-2746.14 19118.57,-2740.05 19537.61,-2700.58 20033.91,-2678.72 20279.34,-2669.56"/>
<polygon fill="black" stroke="black" points="20279.54,-2673.06 20289.4,-2669.19 20279.28,-2666.06 20279.54,-2673.06"/>
</g>
<!-- qkv_proj_3_15 -->
<g id="node994" class="node">
<title>qkv_proj_3_15</title>
<ellipse fill="orange" stroke="black" cx="21235.57" cy="-2663.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="21235.57" y="-2689.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="21235.57" y="-2674.66" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21235.57" y="-2659.66" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="21235.57" y="-2644.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="21235.57" y="-2629.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_15&#45;&gt;qkv_proj_3_15 -->
<g id="edge1194" class="edge">
<title>ln1_3_15&#45;&gt;qkv_proj_3_15</title>
<path fill="none" stroke="black" d="M19278.47,-2789.97C19541,-2779.59 20107.92,-2755.3 20585.57,-2722.05 20757.54,-2710.07 20954.72,-2691.95 21086.38,-2679.22"/>
<polygon fill="black" stroke="black" points="21086.92,-2682.69 21096.54,-2678.24 21086.25,-2675.72 21086.92,-2682.69"/>
</g>
<!-- reshape_qkv_3_0 -->
<g id="node995" class="node">
<title>reshape_qkv_3_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9532.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9532.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9532.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9532.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_0&#45;&gt;reshape_qkv_3_0 -->
<g id="edge1195" class="edge">
<title>qkv_proj_3_0&#45;&gt;reshape_qkv_3_0</title>
<path fill="none" stroke="black" d="M10889.41,-2650.07C10609.17,-2625.51 9981.59,-2570.52 9688.69,-2544.85"/>
<polygon fill="black" stroke="black" points="9688.68,-2541.33 9678.41,-2543.95 9688.07,-2548.31 9688.68,-2541.33"/>
</g>
<!-- reshape_qkv_3_1 -->
<g id="node1008" class="node">
<title>reshape_qkv_3_1</title>
<ellipse fill="lightcyan" stroke="black" cx="10529.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10529.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10529.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10529.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_1&#45;&gt;reshape_qkv_3_1 -->
<g id="edge1210" class="edge">
<title>qkv_proj_3_1&#45;&gt;reshape_qkv_3_1</title>
<path fill="none" stroke="black" d="M12168.41,-2651.95C11841.08,-2627.83 11032.08,-2568.2 10688.27,-2542.86"/>
<polygon fill="black" stroke="black" points="10688.46,-2539.37 10678.23,-2542.12 10687.95,-2546.35 10688.46,-2539.37"/>
</g>
<!-- reshape_qkv_3_2 -->
<g id="node1020" class="node">
<title>reshape_qkv_3_2</title>
<ellipse fill="lightcyan" stroke="black" cx="11456.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11456.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11456.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11456.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_2&#45;&gt;reshape_qkv_3_2 -->
<g id="edge1225" class="edge">
<title>qkv_proj_3_2&#45;&gt;reshape_qkv_3_2</title>
<path fill="none" stroke="black" d="M13209.38,-2652.58C12864.24,-2628.67 11979.58,-2567.39 11616.13,-2542.22"/>
<polygon fill="black" stroke="black" points="11616.27,-2538.72 11606.06,-2541.52 11615.79,-2545.7 11616.27,-2538.72"/>
</g>
<!-- reshape_qkv_3_3 -->
<g id="node1032" class="node">
<title>reshape_qkv_3_3</title>
<ellipse fill="lightcyan" stroke="black" cx="12384.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12384.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12384.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12384.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_3&#45;&gt;reshape_qkv_3_3 -->
<g id="edge1240" class="edge">
<title>qkv_proj_3_3&#45;&gt;reshape_qkv_3_3</title>
<path fill="none" stroke="black" d="M14011.19,-2648.98C13880.21,-2636.64 13678.69,-2618.22 13503.57,-2604.67 13162.98,-2578.3 12763.59,-2553.55 12546.01,-2540.58"/>
<polygon fill="black" stroke="black" points="12545.97,-2537.08 12535.78,-2539.97 12545.56,-2544.06 12545.97,-2537.08"/>
</g>
<!-- reshape_qkv_3_4 -->
<g id="node1045" class="node">
<title>reshape_qkv_3_4</title>
<ellipse fill="lightcyan" stroke="black" cx="13240.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13240.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13240.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13240.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_4&#45;&gt;reshape_qkv_3_4 -->
<g id="edge1256" class="edge">
<title>qkv_proj_3_4&#45;&gt;reshape_qkv_3_4</title>
<path fill="none" stroke="black" d="M14875.45,-2650.51C14731.89,-2638.49 14502.22,-2619.58 14303.57,-2604.67 13983.46,-2580.63 13608.88,-2555.41 13400.78,-2541.65"/>
<polygon fill="black" stroke="black" points="13400.89,-2538.15 13390.69,-2540.98 13400.43,-2545.14 13400.89,-2538.15"/>
</g>
<!-- reshape_qkv_3_5 -->
<g id="node1058" class="node">
<title>reshape_qkv_3_5</title>
<ellipse fill="lightcyan" stroke="black" cx="14167.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14167.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14167.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14167.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_5&#45;&gt;reshape_qkv_3_5 -->
<g id="edge1271" class="edge">
<title>qkv_proj_3_5&#45;&gt;reshape_qkv_3_5</title>
<path fill="none" stroke="black" d="M15274.58,-2628.11C15240.71,-2619.17 15203.39,-2610.44 15168.57,-2604.67 14877.32,-2556.37 14533.13,-2539.81 14333.64,-2534.13"/>
<polygon fill="black" stroke="black" points="14333.47,-2530.62 14323.37,-2533.84 14333.27,-2537.62 14333.47,-2530.62"/>
</g>
<!-- reshape_qkv_3_6 -->
<g id="node1070" class="node">
<title>reshape_qkv_3_6</title>
<ellipse fill="lightcyan" stroke="black" cx="15094.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15094.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15094.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15094.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_6&#45;&gt;reshape_qkv_3_6 -->
<g id="edge1286" class="edge">
<title>qkv_proj_3_6&#45;&gt;reshape_qkv_3_6</title>
<path fill="none" stroke="black" d="M15634.9,-2627.99C15605.01,-2619.7 15572.72,-2611.32 15542.57,-2604.67 15442.16,-2582.51 15327.73,-2563.84 15239.65,-2550.87"/>
<polygon fill="black" stroke="black" points="15239.99,-2547.38 15229.59,-2549.39 15238.98,-2554.3 15239.99,-2547.38"/>
</g>
<!-- reshape_qkv_3_7 -->
<g id="node1082" class="node">
<title>reshape_qkv_3_7</title>
<ellipse fill="lightcyan" stroke="black" cx="16071.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16071.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16071.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16071.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_7&#45;&gt;reshape_qkv_3_7 -->
<g id="edge1301" class="edge">
<title>qkv_proj_3_7&#45;&gt;reshape_qkv_3_7</title>
<path fill="none" stroke="black" d="M16115.47,-2605.96C16109.6,-2595.96 16103.57,-2585.68 16097.92,-2576.05"/>
<polygon fill="black" stroke="black" points="16100.94,-2574.28 16092.86,-2567.43 16094.9,-2577.82 16100.94,-2574.28"/>
</g>
<!-- reshape_qkv_3_8 -->
<g id="node1095" class="node">
<title>reshape_qkv_3_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16665.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16665.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16665.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16665.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_8&#45;&gt;reshape_qkv_3_8 -->
<g id="edge1317" class="edge">
<title>qkv_proj_3_8&#45;&gt;reshape_qkv_3_8</title>
<path fill="none" stroke="black" d="M16640.87,-2604.81C16643.93,-2595.71 16647.05,-2586.4 16650,-2577.59"/>
<polygon fill="black" stroke="black" points="16653.39,-2578.49 16653.25,-2567.9 16646.76,-2576.26 16653.39,-2578.49"/>
</g>
<!-- reshape_qkv_3_9 -->
<g id="node1108" class="node">
<title>reshape_qkv_3_9</title>
<ellipse fill="lightcyan" stroke="black" cx="17636.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17636.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17636.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17636.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_9&#45;&gt;reshape_qkv_3_9 -->
<g id="edge1332" class="edge">
<title>qkv_proj_3_9&#45;&gt;reshape_qkv_3_9</title>
<path fill="none" stroke="black" d="M17423.72,-2620.67C17464.69,-2603.44 17511.72,-2583.67 17551.13,-2567.09"/>
<polygon fill="black" stroke="black" points="17552.59,-2570.27 17560.46,-2563.17 17549.88,-2563.82 17552.59,-2570.27"/>
</g>
<!-- reshape_qkv_3_10 -->
<g id="node1120" class="node">
<title>reshape_qkv_3_10</title>
<ellipse fill="lightcyan" stroke="black" cx="18493.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18493.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18493.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18493.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_10&#45;&gt;reshape_qkv_3_10 -->
<g id="edge1347" class="edge">
<title>qkv_proj_3_10&#45;&gt;reshape_qkv_3_10</title>
<path fill="none" stroke="black" d="M18065.54,-2633.08C18157.81,-2611.11 18283.4,-2581.21 18374.67,-2559.48"/>
<polygon fill="black" stroke="black" points="18375.59,-2562.86 18384.51,-2557.13 18373.97,-2556.05 18375.59,-2562.86"/>
</g>
<!-- reshape_qkv_3_11 -->
<g id="node1132" class="node">
<title>reshape_qkv_3_11</title>
<ellipse fill="lightcyan" stroke="black" cx="19420.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19420.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19420.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19420.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_11&#45;&gt;reshape_qkv_3_11 -->
<g id="edge1362" class="edge">
<title>qkv_proj_3_11&#45;&gt;reshape_qkv_3_11</title>
<path fill="none" stroke="black" d="M18520.73,-2629.3C18556.69,-2620.15 18596.55,-2611 18633.57,-2604.67 18847.49,-2568.07 19097.46,-2548.64 19257.3,-2539.13"/>
<polygon fill="black" stroke="black" points="19257.92,-2542.6 19267.7,-2538.52 19257.51,-2535.61 19257.92,-2542.6"/>
</g>
<!-- reshape_qkv_3_12 -->
<g id="node1145" class="node">
<title>reshape_qkv_3_12</title>
<ellipse fill="lightcyan" stroke="black" cx="20427.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20427.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20427.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20427.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_12&#45;&gt;reshape_qkv_3_12 -->
<g id="edge1378" class="edge">
<title>qkv_proj_3_12&#45;&gt;reshape_qkv_3_12</title>
<path fill="none" stroke="black" d="M18894.81,-2624.7C18921.56,-2616.77 18950.36,-2609.39 18977.57,-2604.67 19039.97,-2593.83 19898.21,-2554.7 20264.15,-2538.39"/>
<polygon fill="black" stroke="black" points="20264.46,-2541.88 20274.3,-2537.93 20264.15,-2534.88 20264.46,-2541.88"/>
</g>
<!-- reshape_qkv_3_13 -->
<g id="node1158" class="node">
<title>reshape_qkv_3_13</title>
<ellipse fill="lightcyan" stroke="black" cx="21274.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21274.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21274.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21274.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_13&#45;&gt;reshape_qkv_3_13 -->
<g id="edge1393" class="edge">
<title>qkv_proj_3_13&#45;&gt;reshape_qkv_3_13</title>
<path fill="none" stroke="black" d="M19272.49,-2653.67C19655.64,-2630.23 20709.31,-2565.75 21113.67,-2541.01"/>
<polygon fill="black" stroke="black" points="21113.92,-2544.5 21123.68,-2540.4 21113.49,-2537.52 21113.92,-2544.5"/>
</g>
<!-- reshape_qkv_3_14 -->
<g id="node1170" class="node">
<title>reshape_qkv_3_14</title>
<ellipse fill="lightcyan" stroke="black" cx="22272.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="22272.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="22272.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22272.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_14&#45;&gt;reshape_qkv_3_14 -->
<g id="edge1408" class="edge">
<title>qkv_proj_3_14&#45;&gt;reshape_qkv_3_14</title>
<path fill="none" stroke="black" d="M20570.48,-2647.07C20728.02,-2630.06 20993.6,-2602.71 21222.57,-2585.67 21535.55,-2562.36 21901.75,-2545.78 22108.51,-2537.4"/>
<polygon fill="black" stroke="black" points="22108.69,-2540.89 22118.54,-2536.99 22108.4,-2533.9 22108.69,-2540.89"/>
</g>
<!-- reshape_qkv_3_15 -->
<g id="node1182" class="node">
<title>reshape_qkv_3_15</title>
<ellipse fill="lightcyan" stroke="black" cx="23198.57" cy="-2530.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="23198.57" y="-2541.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="23198.57" y="-2526.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23198.57" y="-2511.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_15&#45;&gt;reshape_qkv_3_15 -->
<g id="edge1423" class="edge">
<title>qkv_proj_3_15&#45;&gt;reshape_qkv_3_15</title>
<path fill="none" stroke="black" d="M21377.14,-2652.89C21733.11,-2629.1 22663.75,-2566.91 23038.65,-2541.85"/>
<polygon fill="black" stroke="black" points="23039.02,-2545.34 23048.76,-2541.18 23038.55,-2538.35 23039.02,-2545.34"/>
</g>
<!-- split_q_3_0 -->
<g id="node996" class="node">
<title>split_q_3_0</title>
<ellipse fill="pink" stroke="black" cx="9139.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9139.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9139.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9139.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_q_3_0 -->
<g id="edge1196" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_q_3_0</title>
<path fill="none" stroke="black" d="M9432.64,-2501.2C9375.67,-2485.25 9304.29,-2465.27 9246.24,-2449.02"/>
<polygon fill="black" stroke="black" points="9246.88,-2445.57 9236.31,-2446.24 9244.99,-2452.31 9246.88,-2445.57"/>
</g>
<!-- split_k_3_0 -->
<g id="node997" class="node">
<title>split_k_3_0</title>
<ellipse fill="pink" stroke="black" cx="9448.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9448.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9448.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9448.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_k_3_0 -->
<g id="edge1197" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_k_3_0</title>
<path fill="none" stroke="black" d="M9505.07,-2493.15C9497.82,-2483.65 9489.91,-2473.29 9482.37,-2463.42"/>
<polygon fill="black" stroke="black" points="9484.99,-2461.09 9476.14,-2455.27 9479.43,-2465.34 9484.99,-2461.09"/>
</g>
<!-- split_v_3_0 -->
<g id="node998" class="node">
<title>split_v_3_0</title>
<ellipse fill="pink" stroke="black" cx="9757.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9757.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9757.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9757.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_v_3_0 -->
<g id="edge1198" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_v_3_0</title>
<path fill="none" stroke="black" d="M9600.08,-2496.16C9625.9,-2483.54 9655.51,-2469.06 9682.03,-2456.1"/>
<polygon fill="black" stroke="black" points="9683.83,-2459.11 9691.28,-2451.58 9680.75,-2452.83 9683.83,-2459.11"/>
</g>
<!-- transpose_q_3_0 -->
<g id="node999" class="node">
<title>transpose_q_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="9139.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9139.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9139.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9139.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_0&#45;&gt;transpose_q_3_0 -->
<g id="edge1199" class="edge">
<title>split_q_3_0&#45;&gt;transpose_q_3_0</title>
<path fill="none" stroke="black" d="M9139.57,-2380.54C9139.57,-2372.09 9139.57,-2362.99 9139.57,-2354.18"/>
<polygon fill="black" stroke="black" points="9143.07,-2354.01 9139.57,-2344.01 9136.07,-2354.01 9143.07,-2354.01"/>
</g>
<!-- transpose_k_3_0 -->
<g id="node1000" class="node">
<title>transpose_k_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="9448.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9448.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9448.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9448.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_0&#45;&gt;transpose_k_3_0 -->
<g id="edge1200" class="edge">
<title>split_k_3_0&#45;&gt;transpose_k_3_0</title>
<path fill="none" stroke="black" d="M9448.57,-2380.54C9448.57,-2372.09 9448.57,-2362.99 9448.57,-2354.18"/>
<polygon fill="black" stroke="black" points="9452.07,-2354.01 9448.57,-2344.01 9445.07,-2354.01 9452.07,-2354.01"/>
</g>
<!-- transpose_v_3_0 -->
<g id="node1001" class="node">
<title>transpose_v_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="9757.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9757.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9757.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9757.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_0&#45;&gt;transpose_v_3_0 -->
<g id="edge1201" class="edge">
<title>split_v_3_0&#45;&gt;transpose_v_3_0</title>
<path fill="none" stroke="black" d="M9757.57,-2380.54C9757.57,-2372.09 9757.57,-2362.99 9757.57,-2354.18"/>
<polygon fill="black" stroke="black" points="9761.07,-2354.01 9757.57,-2344.01 9754.07,-2354.01 9761.07,-2354.01"/>
</g>
<!-- attn_scores_3_0 -->
<g id="node1002" class="node">
<title>attn_scores_3_0</title>
<ellipse fill="gold" stroke="black" cx="9448.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9448.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9448.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9448.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_0&#45;&gt;attn_scores_3_0 -->
<g id="edge1202" class="edge">
<title>transpose_q_3_0&#45;&gt;attn_scores_3_0</title>
<path fill="none" stroke="black" d="M9223.19,-2275.4C9262.91,-2261.26 9310.6,-2244.28 9351.86,-2229.59"/>
<polygon fill="black" stroke="black" points="9353.13,-2232.86 9361.38,-2226.21 9350.79,-2226.26 9353.13,-2232.86"/>
</g>
<!-- transpose_k_3_0&#45;&gt;attn_scores_3_0 -->
<g id="edge1203" class="edge">
<title>transpose_k_3_0&#45;&gt;attn_scores_3_0</title>
<path fill="none" stroke="black" d="M9448.57,-2268.54C9448.57,-2260.09 9448.57,-2250.99 9448.57,-2242.18"/>
<polygon fill="black" stroke="black" points="9452.07,-2242.01 9448.57,-2232.01 9445.07,-2242.01 9452.07,-2242.01"/>
</g>
<!-- attn_output_3_0 -->
<g id="node1003" class="node">
<title>attn_output_3_0</title>
<ellipse fill="gold" stroke="black" cx="9757.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9757.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9757.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9757.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_0&#45;&gt;attn_output_3_0 -->
<g id="edge1204" class="edge">
<title>transpose_v_3_0&#45;&gt;attn_output_3_0</title>
<path fill="none" stroke="black" d="M9757.57,-2268.47C9757.57,-2207.42 9757.57,-2085.11 9757.57,-2017.96"/>
<polygon fill="black" stroke="black" points="9761.07,-2017.67 9757.57,-2007.67 9754.07,-2017.67 9761.07,-2017.67"/>
</g>
<!-- softmax_3_0 -->
<g id="node1004" class="node">
<title>softmax_3_0</title>
<ellipse fill="gold" stroke="black" cx="9505.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9505.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9505.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9505.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_0&#45;&gt;softmax_3_0 -->
<g id="edge1205" class="edge">
<title>attn_scores_3_0&#45;&gt;softmax_3_0</title>
<path fill="none" stroke="black" d="M9467.4,-2156.84C9472.11,-2147.74 9477.23,-2137.86 9482.15,-2128.38"/>
<polygon fill="black" stroke="black" points="9485.28,-2129.94 9486.77,-2119.45 9479.06,-2126.72 9485.28,-2129.94"/>
</g>
<!-- transpose_back_3_0 -->
<g id="node1005" class="node">
<title>transpose_back_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="10667.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10667.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10667.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10667.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_0&#45;&gt;transpose_back_3_0 -->
<g id="edge1207" class="edge">
<title>attn_output_3_0&#45;&gt;transpose_back_3_0</title>
<path fill="none" stroke="black" d="M9887.95,-1953.41C10057.53,-1932.91 10352.63,-1897.24 10527.05,-1876.15"/>
<polygon fill="black" stroke="black" points="10527.56,-1879.62 10537.07,-1874.94 10526.72,-1872.67 10527.56,-1879.62"/>
</g>
<!-- softmax_3_0&#45;&gt;attn_output_3_0 -->
<g id="edge1206" class="edge">
<title>softmax_3_0&#45;&gt;attn_output_3_0</title>
<path fill="none" stroke="black" d="M9580.16,-2048.61C9610.15,-2035.52 9644.83,-2020.38 9675.52,-2006.98"/>
<polygon fill="black" stroke="black" points="9677.15,-2010.09 9684.91,-2002.88 9674.35,-2003.68 9677.15,-2010.09"/>
</g>
<!-- reshape_concat_3_0 -->
<g id="node1006" class="node">
<title>reshape_concat_3_0</title>
<ellipse fill="lightcyan" stroke="black" cx="10988.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10988.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10988.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10988.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_0&#45;&gt;reshape_concat_3_0 -->
<g id="edge1208" class="edge">
<title>transpose_back_3_0&#45;&gt;reshape_concat_3_0</title>
<path fill="none" stroke="black" d="M10753.17,-1827.83C10797.3,-1812.71 10851.17,-1794.25 10896.23,-1778.81"/>
<polygon fill="black" stroke="black" points="10897.38,-1782.12 10905.71,-1775.56 10895.11,-1775.49 10897.38,-1782.12"/>
</g>
<!-- allgather_dim_3_0 -->
<g id="node1007" class="node">
<title>allgather_dim_3_0</title>
<polygon fill="red" stroke="black" points="11583.57,-1671.67 11410.57,-1618.67 11583.57,-1565.67 11756.57,-1618.67 11583.57,-1671.67"/>
<text text-anchor="middle" x="11583.57" y="-1629.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="11583.57" y="-1614.97" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="11583.57" y="-1599.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_0&#45;&gt;allgather_dim_3_0 -->
<g id="edge1209" class="edge">
<title>reshape_concat_3_0&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M11084.45,-1720.11C11100.48,-1716.13 11116.97,-1712.18 11132.57,-1708.67 11245.52,-1683.23 11375.27,-1658.04 11466.52,-1640.99"/>
<polygon fill="black" stroke="black" points="11467.43,-1644.38 11476.62,-1639.11 11466.15,-1637.5 11467.43,-1644.38"/>
</g>
<!-- head_group_3_0 -->
<g id="node1044" class="node">
<title>head_group_3_0</title>
<polygon fill="lightyellow" stroke="black" points="13864.07,-1528.67 13667.07,-1528.67 13667.07,-1490.67 13864.07,-1490.67 13864.07,-1528.67"/>
<text text-anchor="middle" x="13765.57" y="-1513.47" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13765.57" y="-1498.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_0&#45;&gt;head_group_3_0 -->
<g id="edge1255" class="edge">
<title>allgather_dim_3_0&#45;&gt;head_group_3_0</title>
<path fill="none" stroke="black" d="M11730.13,-1610.48C12140.76,-1590.34 13296.04,-1533.69 13656.64,-1516.01"/>
<polygon fill="black" stroke="black" points="13657,-1519.49 13666.82,-1515.51 13656.66,-1512.5 13657,-1519.49"/>
</g>
<!-- split_q_3_1 -->
<g id="node1009" class="node">
<title>split_q_3_1</title>
<ellipse fill="pink" stroke="black" cx="10066.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10066.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10066.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10066.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_q_3_1 -->
<g id="edge1211" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_q_3_1</title>
<path fill="none" stroke="black" d="M10420.44,-2503.24C10348.68,-2486.19 10254.93,-2463.92 10181.95,-2446.58"/>
<polygon fill="black" stroke="black" points="10182.33,-2443.07 10171.79,-2444.16 10180.71,-2449.88 10182.33,-2443.07"/>
</g>
<!-- split_k_3_1 -->
<g id="node1010" class="node">
<title>split_k_3_1</title>
<ellipse fill="pink" stroke="black" cx="10375.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10375.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10375.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10375.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_k_3_1 -->
<g id="edge1212" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_k_3_1</title>
<path fill="none" stroke="black" d="M10480.85,-2494.36C10465.31,-2483.27 10448,-2470.9 10431.97,-2459.45"/>
<polygon fill="black" stroke="black" points="10433.89,-2456.52 10423.72,-2453.56 10429.82,-2462.22 10433.89,-2456.52"/>
</g>
<!-- split_v_3_1 -->
<g id="node1011" class="node">
<title>split_v_3_1</title>
<ellipse fill="pink" stroke="black" cx="10684.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10684.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10684.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10684.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_v_3_1 -->
<g id="edge1213" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_v_3_1</title>
<path fill="none" stroke="black" d="M10578.62,-2494.36C10594.25,-2483.27 10611.68,-2470.9 10627.81,-2459.45"/>
<polygon fill="black" stroke="black" points="10629.99,-2462.2 10636.11,-2453.56 10625.93,-2456.49 10629.99,-2462.2"/>
</g>
<!-- transpose_q_3_1 -->
<g id="node1012" class="node">
<title>transpose_q_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="10066.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10066.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10066.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10066.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_1&#45;&gt;transpose_q_3_1 -->
<g id="edge1214" class="edge">
<title>split_q_3_1&#45;&gt;transpose_q_3_1</title>
<path fill="none" stroke="black" d="M10066.57,-2380.54C10066.57,-2372.09 10066.57,-2362.99 10066.57,-2354.18"/>
<polygon fill="black" stroke="black" points="10070.07,-2354.01 10066.57,-2344.01 10063.07,-2354.01 10070.07,-2354.01"/>
</g>
<!-- transpose_k_3_1 -->
<g id="node1013" class="node">
<title>transpose_k_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="10375.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10375.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10375.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10375.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_1&#45;&gt;transpose_k_3_1 -->
<g id="edge1215" class="edge">
<title>split_k_3_1&#45;&gt;transpose_k_3_1</title>
<path fill="none" stroke="black" d="M10375.57,-2380.54C10375.57,-2372.09 10375.57,-2362.99 10375.57,-2354.18"/>
<polygon fill="black" stroke="black" points="10379.07,-2354.01 10375.57,-2344.01 10372.07,-2354.01 10379.07,-2354.01"/>
</g>
<!-- transpose_v_3_1 -->
<g id="node1014" class="node">
<title>transpose_v_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="10684.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10684.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10684.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10684.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_1&#45;&gt;transpose_v_3_1 -->
<g id="edge1216" class="edge">
<title>split_v_3_1&#45;&gt;transpose_v_3_1</title>
<path fill="none" stroke="black" d="M10684.57,-2380.54C10684.57,-2372.09 10684.57,-2362.99 10684.57,-2354.18"/>
<polygon fill="black" stroke="black" points="10688.07,-2354.01 10684.57,-2344.01 10681.07,-2354.01 10688.07,-2354.01"/>
</g>
<!-- attn_scores_3_1 -->
<g id="node1015" class="node">
<title>attn_scores_3_1</title>
<ellipse fill="gold" stroke="black" cx="10375.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10375.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10375.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10375.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_1&#45;&gt;attn_scores_3_1 -->
<g id="edge1217" class="edge">
<title>transpose_q_3_1&#45;&gt;attn_scores_3_1</title>
<path fill="none" stroke="black" d="M10150.19,-2275.4C10189.91,-2261.26 10237.6,-2244.28 10278.86,-2229.59"/>
<polygon fill="black" stroke="black" points="10280.13,-2232.86 10288.38,-2226.21 10277.79,-2226.26 10280.13,-2232.86"/>
</g>
<!-- transpose_k_3_1&#45;&gt;attn_scores_3_1 -->
<g id="edge1218" class="edge">
<title>transpose_k_3_1&#45;&gt;attn_scores_3_1</title>
<path fill="none" stroke="black" d="M10375.57,-2268.54C10375.57,-2260.09 10375.57,-2250.99 10375.57,-2242.18"/>
<polygon fill="black" stroke="black" points="10379.07,-2242.01 10375.57,-2232.01 10372.07,-2242.01 10379.07,-2242.01"/>
</g>
<!-- attn_output_3_1 -->
<g id="node1016" class="node">
<title>attn_output_3_1</title>
<ellipse fill="gold" stroke="black" cx="10684.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10684.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10684.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10684.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_1&#45;&gt;attn_output_3_1 -->
<g id="edge1219" class="edge">
<title>transpose_v_3_1&#45;&gt;attn_output_3_1</title>
<path fill="none" stroke="black" d="M10684.57,-2268.47C10684.57,-2207.42 10684.57,-2085.11 10684.57,-2017.96"/>
<polygon fill="black" stroke="black" points="10688.07,-2017.67 10684.57,-2007.67 10681.07,-2017.67 10688.07,-2017.67"/>
</g>
<!-- softmax_3_1 -->
<g id="node1017" class="node">
<title>softmax_3_1</title>
<ellipse fill="gold" stroke="black" cx="10460.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10460.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10460.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10460.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_1&#45;&gt;softmax_3_1 -->
<g id="edge1220" class="edge">
<title>attn_scores_3_1&#45;&gt;softmax_3_1</title>
<path fill="none" stroke="black" d="M10403.41,-2157.15C10410.74,-2147.65 10418.75,-2137.29 10426.38,-2127.42"/>
<polygon fill="black" stroke="black" points="10429.33,-2129.32 10432.68,-2119.27 10423.79,-2125.04 10429.33,-2129.32"/>
</g>
<!-- transpose_back_3_1 -->
<g id="node1018" class="node">
<title>transpose_back_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="10988.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10988.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10988.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10988.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_1&#45;&gt;transpose_back_3_1 -->
<g id="edge1222" class="edge">
<title>attn_output_3_1&#45;&gt;transpose_back_3_1</title>
<path fill="none" stroke="black" d="M10767.24,-1939.25C10807.2,-1924.79 10855.31,-1907.39 10896.44,-1892.5"/>
<polygon fill="black" stroke="black" points="10897.71,-1895.77 10905.92,-1889.07 10895.33,-1889.18 10897.71,-1895.77"/>
</g>
<!-- softmax_3_1&#45;&gt;attn_output_3_1 -->
<g id="edge1221" class="edge">
<title>softmax_3_1&#45;&gt;attn_output_3_1</title>
<path fill="none" stroke="black" d="M10528.39,-2047.86C10553.96,-2035.31 10583.19,-2020.95 10609.4,-2008.08"/>
<polygon fill="black" stroke="black" points="10611.09,-2011.15 10618.53,-2003.6 10608.01,-2004.87 10611.09,-2011.15"/>
</g>
<!-- reshape_concat_3_1 -->
<g id="node1019" class="node">
<title>reshape_concat_3_1</title>
<ellipse fill="lightcyan" stroke="black" cx="11274.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="11274.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="11274.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11274.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_1&#45;&gt;reshape_concat_3_1 -->
<g id="edge1223" class="edge">
<title>transpose_back_3_1&#45;&gt;reshape_concat_3_1</title>
<path fill="none" stroke="black" d="M11067.86,-1826.67C11105.2,-1812.31 11149.82,-1795.15 11188.03,-1780.45"/>
<polygon fill="black" stroke="black" points="11189.53,-1783.63 11197.6,-1776.77 11187.01,-1777.09 11189.53,-1783.63"/>
</g>
<!-- reshape_concat_3_1&#45;&gt;allgather_dim_3_0 -->
<g id="edge1224" class="edge">
<title>reshape_concat_3_1&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M11348.98,-1714.95C11394.85,-1696.31 11453.75,-1672.4 11501.05,-1653.18"/>
<polygon fill="black" stroke="black" points="11502.4,-1656.41 11510.35,-1649.41 11499.76,-1649.93 11502.4,-1656.41"/>
</g>
<!-- split_q_3_2 -->
<g id="node1021" class="node">
<title>split_q_3_2</title>
<ellipse fill="pink" stroke="black" cx="10993.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10993.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10993.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10993.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_q_3_2 -->
<g id="edge1226" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_q_3_2</title>
<path fill="none" stroke="black" d="M11347.44,-2503.24C11275.68,-2486.19 11181.93,-2463.92 11108.95,-2446.58"/>
<polygon fill="black" stroke="black" points="11109.33,-2443.07 11098.79,-2444.16 11107.71,-2449.88 11109.33,-2443.07"/>
</g>
<!-- split_k_3_2 -->
<g id="node1022" class="node">
<title>split_k_3_2</title>
<ellipse fill="pink" stroke="black" cx="11302.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11302.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11302.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11302.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_k_3_2 -->
<g id="edge1227" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_k_3_2</title>
<path fill="none" stroke="black" d="M11407.85,-2494.36C11392.31,-2483.27 11375,-2470.9 11358.97,-2459.45"/>
<polygon fill="black" stroke="black" points="11360.89,-2456.52 11350.72,-2453.56 11356.82,-2462.22 11360.89,-2456.52"/>
</g>
<!-- split_v_3_2 -->
<g id="node1023" class="node">
<title>split_v_3_2</title>
<ellipse fill="pink" stroke="black" cx="11611.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11611.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11611.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11611.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_v_3_2 -->
<g id="edge1228" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_v_3_2</title>
<path fill="none" stroke="black" d="M11505.62,-2494.36C11521.25,-2483.27 11538.68,-2470.9 11554.81,-2459.45"/>
<polygon fill="black" stroke="black" points="11556.99,-2462.2 11563.11,-2453.56 11552.93,-2456.49 11556.99,-2462.2"/>
</g>
<!-- transpose_q_3_2 -->
<g id="node1024" class="node">
<title>transpose_q_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="10993.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10993.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10993.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10993.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_2&#45;&gt;transpose_q_3_2 -->
<g id="edge1229" class="edge">
<title>split_q_3_2&#45;&gt;transpose_q_3_2</title>
<path fill="none" stroke="black" d="M10993.57,-2380.54C10993.57,-2372.09 10993.57,-2362.99 10993.57,-2354.18"/>
<polygon fill="black" stroke="black" points="10997.07,-2354.01 10993.57,-2344.01 10990.07,-2354.01 10997.07,-2354.01"/>
</g>
<!-- transpose_k_3_2 -->
<g id="node1025" class="node">
<title>transpose_k_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="11302.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11302.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11302.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11302.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_2&#45;&gt;transpose_k_3_2 -->
<g id="edge1230" class="edge">
<title>split_k_3_2&#45;&gt;transpose_k_3_2</title>
<path fill="none" stroke="black" d="M11302.57,-2380.54C11302.57,-2372.09 11302.57,-2362.99 11302.57,-2354.18"/>
<polygon fill="black" stroke="black" points="11306.07,-2354.01 11302.57,-2344.01 11299.07,-2354.01 11306.07,-2354.01"/>
</g>
<!-- transpose_v_3_2 -->
<g id="node1026" class="node">
<title>transpose_v_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="11611.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11611.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11611.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11611.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_2&#45;&gt;transpose_v_3_2 -->
<g id="edge1231" class="edge">
<title>split_v_3_2&#45;&gt;transpose_v_3_2</title>
<path fill="none" stroke="black" d="M11611.57,-2380.54C11611.57,-2372.09 11611.57,-2362.99 11611.57,-2354.18"/>
<polygon fill="black" stroke="black" points="11615.07,-2354.01 11611.57,-2344.01 11608.07,-2354.01 11615.07,-2354.01"/>
</g>
<!-- attn_scores_3_2 -->
<g id="node1027" class="node">
<title>attn_scores_3_2</title>
<ellipse fill="gold" stroke="black" cx="11302.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11302.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11302.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11302.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_2&#45;&gt;attn_scores_3_2 -->
<g id="edge1232" class="edge">
<title>transpose_q_3_2&#45;&gt;attn_scores_3_2</title>
<path fill="none" stroke="black" d="M11077.19,-2275.4C11116.91,-2261.26 11164.6,-2244.28 11205.86,-2229.59"/>
<polygon fill="black" stroke="black" points="11207.13,-2232.86 11215.38,-2226.21 11204.79,-2226.26 11207.13,-2232.86"/>
</g>
<!-- transpose_k_3_2&#45;&gt;attn_scores_3_2 -->
<g id="edge1233" class="edge">
<title>transpose_k_3_2&#45;&gt;attn_scores_3_2</title>
<path fill="none" stroke="black" d="M11302.57,-2268.54C11302.57,-2260.09 11302.57,-2250.99 11302.57,-2242.18"/>
<polygon fill="black" stroke="black" points="11306.07,-2242.01 11302.57,-2232.01 11299.07,-2242.01 11306.07,-2242.01"/>
</g>
<!-- attn_output_3_2 -->
<g id="node1028" class="node">
<title>attn_output_3_2</title>
<ellipse fill="gold" stroke="black" cx="11583.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11583.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11583.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11583.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_2&#45;&gt;attn_output_3_2 -->
<g id="edge1234" class="edge">
<title>transpose_v_3_2&#45;&gt;attn_output_3_2</title>
<path fill="none" stroke="black" d="M11608.5,-2268.47C11603.38,-2207.42 11593.13,-2085.11 11587.5,-2017.96"/>
<polygon fill="black" stroke="black" points="11590.96,-2017.34 11586.63,-2007.67 11583.98,-2017.93 11590.96,-2017.34"/>
</g>
<!-- softmax_3_2 -->
<g id="node1029" class="node">
<title>softmax_3_2</title>
<ellipse fill="gold" stroke="black" cx="11367.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11367.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11367.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11367.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_2&#45;&gt;softmax_3_2 -->
<g id="edge1235" class="edge">
<title>attn_scores_3_2&#45;&gt;softmax_3_2</title>
<path fill="none" stroke="black" d="M11324.04,-2156.84C11329.47,-2147.64 11335.38,-2137.65 11341.03,-2128.09"/>
<polygon fill="black" stroke="black" points="11344.06,-2129.84 11346.13,-2119.45 11338.03,-2126.28 11344.06,-2129.84"/>
</g>
<!-- transpose_back_3_2 -->
<g id="node1030" class="node">
<title>transpose_back_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="11583.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11583.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="11583.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11583.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_2&#45;&gt;transpose_back_3_2 -->
<g id="edge1237" class="edge">
<title>attn_output_3_2&#45;&gt;transpose_back_3_2</title>
<path fill="none" stroke="black" d="M11583.57,-1932.54C11583.57,-1924.09 11583.57,-1914.99 11583.57,-1906.18"/>
<polygon fill="black" stroke="black" points="11587.07,-1906.01 11583.57,-1896.01 11580.07,-1906.01 11587.07,-1906.01"/>
</g>
<!-- softmax_3_2&#45;&gt;attn_output_3_2 -->
<g id="edge1236" class="edge">
<title>softmax_3_2&#45;&gt;attn_output_3_2</title>
<path fill="none" stroke="black" d="M11433.55,-2047.56C11457.75,-2035.24 11485.29,-2021.22 11510.1,-2008.58"/>
<polygon fill="black" stroke="black" points="11511.79,-2011.65 11519.11,-2004 11508.61,-2005.41 11511.79,-2011.65"/>
</g>
<!-- reshape_concat_3_2 -->
<g id="node1031" class="node">
<title>reshape_concat_3_2</title>
<ellipse fill="lightcyan" stroke="black" cx="11583.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="11583.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="11583.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11583.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_2&#45;&gt;reshape_concat_3_2 -->
<g id="edge1238" class="edge">
<title>transpose_back_3_2&#45;&gt;reshape_concat_3_2</title>
<path fill="none" stroke="black" d="M11583.57,-1820.54C11583.57,-1812.09 11583.57,-1802.99 11583.57,-1794.18"/>
<polygon fill="black" stroke="black" points="11587.07,-1794.01 11583.57,-1784.01 11580.07,-1794.01 11587.07,-1794.01"/>
</g>
<!-- reshape_concat_3_2&#45;&gt;allgather_dim_3_0 -->
<g id="edge1239" class="edge">
<title>reshape_concat_3_2&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M11583.57,-1708.53C11583.57,-1700.22 11583.57,-1691.18 11583.57,-1682.13"/>
<polygon fill="black" stroke="black" points="11587.07,-1681.97 11583.57,-1671.97 11580.07,-1681.97 11587.07,-1681.97"/>
</g>
<!-- split_q_3_3 -->
<g id="node1033" class="node">
<title>split_q_3_3</title>
<ellipse fill="pink" stroke="black" cx="11920.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11920.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11920.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11920.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_q_3_3 -->
<g id="edge1241" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_q_3_3</title>
<path fill="none" stroke="black" d="M12275.2,-2503.24C12203.29,-2486.19 12109.33,-2463.92 12036.2,-2446.58"/>
<polygon fill="black" stroke="black" points="12036.56,-2443.07 12026.02,-2444.16 12034.94,-2449.88 12036.56,-2443.07"/>
</g>
<!-- split_k_3_3 -->
<g id="node1034" class="node">
<title>split_k_3_3</title>
<ellipse fill="pink" stroke="black" cx="12229.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12229.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12229.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12229.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_k_3_3 -->
<g id="edge1242" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_k_3_3</title>
<path fill="none" stroke="black" d="M12335.53,-2494.36C12319.9,-2483.27 12302.47,-2470.9 12286.33,-2459.45"/>
<polygon fill="black" stroke="black" points="12288.21,-2456.49 12278.03,-2453.56 12284.16,-2462.2 12288.21,-2456.49"/>
</g>
<!-- split_v_3_3 -->
<g id="node1035" class="node">
<title>split_v_3_3</title>
<ellipse fill="pink" stroke="black" cx="12538.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12538.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12538.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12538.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_v_3_3 -->
<g id="edge1243" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_v_3_3</title>
<path fill="none" stroke="black" d="M12433.3,-2494.36C12448.83,-2483.27 12466.15,-2470.9 12482.18,-2459.45"/>
<polygon fill="black" stroke="black" points="12484.32,-2462.22 12490.43,-2453.56 12480.26,-2456.52 12484.32,-2462.22"/>
</g>
<!-- transpose_q_3_3 -->
<g id="node1036" class="node">
<title>transpose_q_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="11920.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11920.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11920.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11920.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_3&#45;&gt;transpose_q_3_3 -->
<g id="edge1244" class="edge">
<title>split_q_3_3&#45;&gt;transpose_q_3_3</title>
<path fill="none" stroke="black" d="M11920.57,-2380.54C11920.57,-2372.09 11920.57,-2362.99 11920.57,-2354.18"/>
<polygon fill="black" stroke="black" points="11924.07,-2354.01 11920.57,-2344.01 11917.07,-2354.01 11924.07,-2354.01"/>
</g>
<!-- transpose_k_3_3 -->
<g id="node1037" class="node">
<title>transpose_k_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="12229.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12229.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12229.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12229.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_3&#45;&gt;transpose_k_3_3 -->
<g id="edge1245" class="edge">
<title>split_k_3_3&#45;&gt;transpose_k_3_3</title>
<path fill="none" stroke="black" d="M12229.57,-2380.54C12229.57,-2372.09 12229.57,-2362.99 12229.57,-2354.18"/>
<polygon fill="black" stroke="black" points="12233.07,-2354.01 12229.57,-2344.01 12226.07,-2354.01 12233.07,-2354.01"/>
</g>
<!-- transpose_v_3_3 -->
<g id="node1038" class="node">
<title>transpose_v_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="12538.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12538.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12538.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12538.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_3&#45;&gt;transpose_v_3_3 -->
<g id="edge1246" class="edge">
<title>split_v_3_3&#45;&gt;transpose_v_3_3</title>
<path fill="none" stroke="black" d="M12538.57,-2380.54C12538.57,-2372.09 12538.57,-2362.99 12538.57,-2354.18"/>
<polygon fill="black" stroke="black" points="12542.07,-2354.01 12538.57,-2344.01 12535.07,-2354.01 12542.07,-2354.01"/>
</g>
<!-- attn_scores_3_3 -->
<g id="node1039" class="node">
<title>attn_scores_3_3</title>
<ellipse fill="gold" stroke="black" cx="12032.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12032.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12032.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12032.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_3&#45;&gt;attn_scores_3_3 -->
<g id="edge1247" class="edge">
<title>transpose_q_3_3&#45;&gt;attn_scores_3_3</title>
<path fill="none" stroke="black" d="M11956.63,-2269.76C11966.92,-2259.65 11978.24,-2248.53 11988.92,-2238.04"/>
<polygon fill="black" stroke="black" points="11991.52,-2240.39 11996.2,-2230.89 11986.62,-2235.4 11991.52,-2240.39"/>
</g>
<!-- transpose_k_3_3&#45;&gt;attn_scores_3_3 -->
<g id="edge1248" class="edge">
<title>transpose_k_3_3&#45;&gt;attn_scores_3_3</title>
<path fill="none" stroke="black" d="M12169.93,-2271.86C12148.63,-2259.97 12124.45,-2246.46 12102.37,-2234.14"/>
<polygon fill="black" stroke="black" points="12103.81,-2230.93 12093.37,-2229.12 12100.4,-2237.05 12103.81,-2230.93"/>
</g>
<!-- attn_output_3_3 -->
<g id="node1040" class="node">
<title>attn_output_3_3</title>
<ellipse fill="gold" stroke="black" cx="12032.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12032.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12032.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12032.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_3&#45;&gt;attn_output_3_3 -->
<g id="edge1249" class="edge">
<title>transpose_v_3_3&#45;&gt;attn_output_3_3</title>
<path fill="none" stroke="black" d="M12500.98,-2269.78C12442.21,-2215.85 12323.38,-2112.23 12208.57,-2044.67 12182.92,-2029.57 12153.58,-2016.01 12126.3,-2004.77"/>
<polygon fill="black" stroke="black" points="12127.33,-2001.41 12116.75,-2000.89 12124.7,-2007.9 12127.33,-2001.41"/>
</g>
<!-- softmax_3_3 -->
<g id="node1041" class="node">
<title>softmax_3_3</title>
<ellipse fill="gold" stroke="black" cx="12032.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12032.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12032.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12032.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_3&#45;&gt;softmax_3_3 -->
<g id="edge1250" class="edge">
<title>attn_scores_3_3&#45;&gt;softmax_3_3</title>
<path fill="none" stroke="black" d="M12032.57,-2156.54C12032.57,-2148.09 12032.57,-2138.99 12032.57,-2130.18"/>
<polygon fill="black" stroke="black" points="12036.07,-2130.01 12032.57,-2120.01 12029.07,-2130.01 12036.07,-2130.01"/>
</g>
<!-- transpose_back_3_3 -->
<g id="node1042" class="node">
<title>transpose_back_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="11911.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11911.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="11911.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11911.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_3&#45;&gt;transpose_back_3_3 -->
<g id="edge1252" class="edge">
<title>attn_output_3_3&#45;&gt;transpose_back_3_3</title>
<path fill="none" stroke="black" d="M11993.62,-1933.76C11982.29,-1923.45 11969.79,-1912.09 11958.04,-1901.41"/>
<polygon fill="black" stroke="black" points="11960.21,-1898.65 11950.45,-1894.51 11955.5,-1903.83 11960.21,-1898.65"/>
</g>
<!-- softmax_3_3&#45;&gt;attn_output_3_3 -->
<g id="edge1251" class="edge">
<title>softmax_3_3&#45;&gt;attn_output_3_3</title>
<path fill="none" stroke="black" d="M12032.57,-2044.54C12032.57,-2036.09 12032.57,-2026.99 12032.57,-2018.18"/>
<polygon fill="black" stroke="black" points="12036.07,-2018.01 12032.57,-2008.01 12029.07,-2018.01 12036.07,-2018.01"/>
</g>
<!-- reshape_concat_3_3 -->
<g id="node1043" class="node">
<title>reshape_concat_3_3</title>
<ellipse fill="lightcyan" stroke="black" cx="11879.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="11879.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="11879.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11879.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_3&#45;&gt;reshape_concat_3_3 -->
<g id="edge1253" class="edge">
<title>transpose_back_3_3&#45;&gt;reshape_concat_3_3</title>
<path fill="none" stroke="black" d="M11900.92,-1820.54C11898.38,-1811.82 11895.64,-1802.4 11893,-1793.31"/>
<polygon fill="black" stroke="black" points="11896.34,-1792.26 11890.18,-1783.63 11889.62,-1794.21 11896.34,-1792.26"/>
</g>
<!-- reshape_concat_3_3&#45;&gt;allgather_dim_3_0 -->
<g id="edge1254" class="edge">
<title>reshape_concat_3_3&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M11807.54,-1714.63C11764.25,-1696.27 11709.05,-1672.87 11664.29,-1653.89"/>
<polygon fill="black" stroke="black" points="11665.47,-1650.59 11654.9,-1649.91 11662.74,-1657.03 11665.47,-1650.59"/>
</g>
<!-- output_proj_3_0 -->
<g id="node1195" class="node">
<title>output_proj_3_0</title>
<ellipse fill="orange" stroke="black" cx="15020.57" cy="-1405.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15020.57" y="-1424.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15020.57" y="-1409.38" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="15020.57" y="-1394.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15020.57" y="-1379.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_0&#45;&gt;output_proj_3_0 -->
<g id="edge1439" class="edge">
<title>head_group_3_0&#45;&gt;output_proj_3_0</title>
<path fill="none" stroke="black" d="M13864.31,-1500.63C14084.46,-1482.73 14616.4,-1439.46 14874.82,-1418.44"/>
<polygon fill="black" stroke="black" points="14875.34,-1421.91 14885.03,-1417.61 14874.78,-1414.93 14875.34,-1421.91"/>
</g>
<!-- split_q_3_4 -->
<g id="node1046" class="node">
<title>split_q_3_4</title>
<ellipse fill="pink" stroke="black" cx="12847.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12847.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12847.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12847.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_q_3_4 -->
<g id="edge1257" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_q_3_4</title>
<path fill="none" stroke="black" d="M13140.64,-2501.2C13083.67,-2485.25 13012.29,-2465.27 12954.24,-2449.02"/>
<polygon fill="black" stroke="black" points="12954.88,-2445.57 12944.31,-2446.24 12952.99,-2452.31 12954.88,-2445.57"/>
</g>
<!-- split_k_3_4 -->
<g id="node1047" class="node">
<title>split_k_3_4</title>
<ellipse fill="pink" stroke="black" cx="13156.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13156.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13156.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13156.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_k_3_4 -->
<g id="edge1258" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_k_3_4</title>
<path fill="none" stroke="black" d="M13213.07,-2493.15C13205.82,-2483.65 13197.91,-2473.29 13190.37,-2463.42"/>
<polygon fill="black" stroke="black" points="13192.99,-2461.09 13184.14,-2455.27 13187.43,-2465.34 13192.99,-2461.09"/>
</g>
<!-- split_v_3_4 -->
<g id="node1048" class="node">
<title>split_v_3_4</title>
<ellipse fill="pink" stroke="black" cx="13465.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13465.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13465.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13465.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_v_3_4 -->
<g id="edge1259" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_v_3_4</title>
<path fill="none" stroke="black" d="M13308.08,-2496.16C13333.9,-2483.54 13363.51,-2469.06 13390.03,-2456.1"/>
<polygon fill="black" stroke="black" points="13391.83,-2459.11 13399.28,-2451.58 13388.75,-2452.83 13391.83,-2459.11"/>
</g>
<!-- transpose_q_3_4 -->
<g id="node1049" class="node">
<title>transpose_q_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="12847.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12847.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12847.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12847.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_4&#45;&gt;transpose_q_3_4 -->
<g id="edge1260" class="edge">
<title>split_q_3_4&#45;&gt;transpose_q_3_4</title>
<path fill="none" stroke="black" d="M12847.57,-2380.54C12847.57,-2372.09 12847.57,-2362.99 12847.57,-2354.18"/>
<polygon fill="black" stroke="black" points="12851.07,-2354.01 12847.57,-2344.01 12844.07,-2354.01 12851.07,-2354.01"/>
</g>
<!-- transpose_k_3_4 -->
<g id="node1050" class="node">
<title>transpose_k_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="13156.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13156.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13156.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13156.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_4&#45;&gt;transpose_k_3_4 -->
<g id="edge1261" class="edge">
<title>split_k_3_4&#45;&gt;transpose_k_3_4</title>
<path fill="none" stroke="black" d="M13156.57,-2380.54C13156.57,-2372.09 13156.57,-2362.99 13156.57,-2354.18"/>
<polygon fill="black" stroke="black" points="13160.07,-2354.01 13156.57,-2344.01 13153.07,-2354.01 13160.07,-2354.01"/>
</g>
<!-- transpose_v_3_4 -->
<g id="node1051" class="node">
<title>transpose_v_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="13465.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13465.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13465.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13465.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_4&#45;&gt;transpose_v_3_4 -->
<g id="edge1262" class="edge">
<title>split_v_3_4&#45;&gt;transpose_v_3_4</title>
<path fill="none" stroke="black" d="M13465.57,-2380.54C13465.57,-2372.09 13465.57,-2362.99 13465.57,-2354.18"/>
<polygon fill="black" stroke="black" points="13469.07,-2354.01 13465.57,-2344.01 13462.07,-2354.01 13469.07,-2354.01"/>
</g>
<!-- attn_scores_3_4 -->
<g id="node1052" class="node">
<title>attn_scores_3_4</title>
<ellipse fill="gold" stroke="black" cx="13156.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13156.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13156.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13156.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_4&#45;&gt;attn_scores_3_4 -->
<g id="edge1263" class="edge">
<title>transpose_q_3_4&#45;&gt;attn_scores_3_4</title>
<path fill="none" stroke="black" d="M12931.19,-2275.4C12970.91,-2261.26 13018.6,-2244.28 13059.86,-2229.59"/>
<polygon fill="black" stroke="black" points="13061.13,-2232.86 13069.38,-2226.21 13058.79,-2226.26 13061.13,-2232.86"/>
</g>
<!-- transpose_k_3_4&#45;&gt;attn_scores_3_4 -->
<g id="edge1264" class="edge">
<title>transpose_k_3_4&#45;&gt;attn_scores_3_4</title>
<path fill="none" stroke="black" d="M13156.57,-2268.54C13156.57,-2260.09 13156.57,-2250.99 13156.57,-2242.18"/>
<polygon fill="black" stroke="black" points="13160.07,-2242.01 13156.57,-2232.01 13153.07,-2242.01 13160.07,-2242.01"/>
</g>
<!-- attn_output_3_4 -->
<g id="node1053" class="node">
<title>attn_output_3_4</title>
<ellipse fill="gold" stroke="black" cx="13465.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13465.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13465.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13465.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_4&#45;&gt;attn_output_3_4 -->
<g id="edge1265" class="edge">
<title>transpose_v_3_4&#45;&gt;attn_output_3_4</title>
<path fill="none" stroke="black" d="M13465.57,-2268.47C13465.57,-2207.42 13465.57,-2085.11 13465.57,-2017.96"/>
<polygon fill="black" stroke="black" points="13469.07,-2017.67 13465.57,-2007.67 13462.07,-2017.67 13469.07,-2017.67"/>
</g>
<!-- softmax_3_4 -->
<g id="node1054" class="node">
<title>softmax_3_4</title>
<ellipse fill="gold" stroke="black" cx="13213.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13213.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13213.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13213.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_4&#45;&gt;softmax_3_4 -->
<g id="edge1266" class="edge">
<title>attn_scores_3_4&#45;&gt;softmax_3_4</title>
<path fill="none" stroke="black" d="M13175.4,-2156.84C13180.11,-2147.74 13185.23,-2137.86 13190.15,-2128.38"/>
<polygon fill="black" stroke="black" points="13193.28,-2129.94 13194.77,-2119.45 13187.06,-2126.72 13193.28,-2129.94"/>
</g>
<!-- transpose_back_3_4 -->
<g id="node1055" class="node">
<title>transpose_back_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="13863.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13863.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13863.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13863.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_4&#45;&gt;transpose_back_3_4 -->
<g id="edge1268" class="edge">
<title>attn_output_3_4&#45;&gt;transpose_back_3_4</title>
<path fill="none" stroke="black" d="M13562.94,-1942.26C13621.47,-1926.08 13696.03,-1905.47 13756.26,-1888.82"/>
<polygon fill="black" stroke="black" points="13757.48,-1892.12 13766.18,-1886.08 13755.61,-1885.37 13757.48,-1892.12"/>
</g>
<!-- softmax_3_4&#45;&gt;attn_output_3_4 -->
<g id="edge1267" class="edge">
<title>softmax_3_4&#45;&gt;attn_output_3_4</title>
<path fill="none" stroke="black" d="M13288.16,-2048.61C13318.15,-2035.52 13352.83,-2020.38 13383.52,-2006.98"/>
<polygon fill="black" stroke="black" points="13385.15,-2010.09 13392.91,-2002.88 13382.35,-2003.68 13385.15,-2010.09"/>
</g>
<!-- reshape_concat_3_4 -->
<g id="node1056" class="node">
<title>reshape_concat_3_4</title>
<ellipse fill="lightcyan" stroke="black" cx="14296.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14296.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14296.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14296.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_4&#45;&gt;reshape_concat_3_4 -->
<g id="edge1269" class="edge">
<title>transpose_back_3_4&#45;&gt;reshape_concat_3_4</title>
<path fill="none" stroke="black" d="M13965.37,-1831.31C14032.8,-1814.18 14121.11,-1791.74 14189.58,-1774.35"/>
<polygon fill="black" stroke="black" points="14190.7,-1777.67 14199.53,-1771.82 14188.98,-1770.89 14190.7,-1777.67"/>
</g>
<!-- allgather_dim_3_1 -->
<g id="node1057" class="node">
<title>allgather_dim_3_1</title>
<polygon fill="red" stroke="black" points="15208.57,-1671.67 15035.57,-1618.67 15208.57,-1565.67 15381.57,-1618.67 15208.57,-1671.67"/>
<text text-anchor="middle" x="15208.57" y="-1629.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="15208.57" y="-1614.97" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15208.57" y="-1599.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_4&#45;&gt;allgather_dim_3_1 -->
<g id="edge1270" class="edge">
<title>reshape_concat_3_4&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M14414.87,-1728.89C14586.72,-1705.24 14904.18,-1661.55 15081.07,-1637.21"/>
<polygon fill="black" stroke="black" points="15081.78,-1640.65 15091.21,-1635.82 15080.83,-1633.71 15081.78,-1640.65"/>
</g>
<!-- head_group_3_1 -->
<g id="node1094" class="node">
<title>head_group_3_1</title>
<polygon fill="lightyellow" stroke="black" points="15413.07,-1528.67 15216.07,-1528.67 15216.07,-1490.67 15413.07,-1490.67 15413.07,-1528.67"/>
<text text-anchor="middle" x="15314.57" y="-1513.47" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15314.57" y="-1498.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_1&#45;&gt;head_group_3_1 -->
<g id="edge1316" class="edge">
<title>allgather_dim_3_1&#45;&gt;head_group_3_1</title>
<path fill="none" stroke="black" d="M15248.35,-1577.52C15262.06,-1563.67 15277.05,-1548.55 15289.29,-1536.19"/>
<polygon fill="black" stroke="black" points="15291.96,-1538.46 15296.52,-1528.89 15286.99,-1533.53 15291.96,-1538.46"/>
</g>
<!-- split_q_3_5 -->
<g id="node1059" class="node">
<title>split_q_3_5</title>
<ellipse fill="pink" stroke="black" cx="13774.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13774.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13774.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13774.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_q_3_5 -->
<g id="edge1272" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_q_3_5</title>
<path fill="none" stroke="black" d="M14067.64,-2501.2C14010.67,-2485.25 13939.29,-2465.27 13881.24,-2449.02"/>
<polygon fill="black" stroke="black" points="13881.88,-2445.57 13871.31,-2446.24 13879.99,-2452.31 13881.88,-2445.57"/>
</g>
<!-- split_k_3_5 -->
<g id="node1060" class="node">
<title>split_k_3_5</title>
<ellipse fill="pink" stroke="black" cx="14083.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14083.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14083.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14083.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_k_3_5 -->
<g id="edge1273" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_k_3_5</title>
<path fill="none" stroke="black" d="M14140.07,-2493.15C14132.82,-2483.65 14124.91,-2473.29 14117.37,-2463.42"/>
<polygon fill="black" stroke="black" points="14119.99,-2461.09 14111.14,-2455.27 14114.43,-2465.34 14119.99,-2461.09"/>
</g>
<!-- split_v_3_5 -->
<g id="node1061" class="node">
<title>split_v_3_5</title>
<ellipse fill="pink" stroke="black" cx="14392.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14392.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14392.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14392.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_v_3_5 -->
<g id="edge1274" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_v_3_5</title>
<path fill="none" stroke="black" d="M14235.08,-2496.16C14260.9,-2483.54 14290.51,-2469.06 14317.03,-2456.1"/>
<polygon fill="black" stroke="black" points="14318.83,-2459.11 14326.28,-2451.58 14315.75,-2452.83 14318.83,-2459.11"/>
</g>
<!-- transpose_q_3_5 -->
<g id="node1062" class="node">
<title>transpose_q_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="13774.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13774.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13774.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13774.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_5&#45;&gt;transpose_q_3_5 -->
<g id="edge1275" class="edge">
<title>split_q_3_5&#45;&gt;transpose_q_3_5</title>
<path fill="none" stroke="black" d="M13774.57,-2380.54C13774.57,-2372.09 13774.57,-2362.99 13774.57,-2354.18"/>
<polygon fill="black" stroke="black" points="13778.07,-2354.01 13774.57,-2344.01 13771.07,-2354.01 13778.07,-2354.01"/>
</g>
<!-- transpose_k_3_5 -->
<g id="node1063" class="node">
<title>transpose_k_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="14083.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14083.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14083.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14083.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_5&#45;&gt;transpose_k_3_5 -->
<g id="edge1276" class="edge">
<title>split_k_3_5&#45;&gt;transpose_k_3_5</title>
<path fill="none" stroke="black" d="M14083.57,-2380.54C14083.57,-2372.09 14083.57,-2362.99 14083.57,-2354.18"/>
<polygon fill="black" stroke="black" points="14087.07,-2354.01 14083.57,-2344.01 14080.07,-2354.01 14087.07,-2354.01"/>
</g>
<!-- transpose_v_3_5 -->
<g id="node1064" class="node">
<title>transpose_v_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="14392.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14392.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14392.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14392.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_5&#45;&gt;transpose_v_3_5 -->
<g id="edge1277" class="edge">
<title>split_v_3_5&#45;&gt;transpose_v_3_5</title>
<path fill="none" stroke="black" d="M14392.57,-2380.54C14392.57,-2372.09 14392.57,-2362.99 14392.57,-2354.18"/>
<polygon fill="black" stroke="black" points="14396.07,-2354.01 14392.57,-2344.01 14389.07,-2354.01 14396.07,-2354.01"/>
</g>
<!-- attn_scores_3_5 -->
<g id="node1065" class="node">
<title>attn_scores_3_5</title>
<ellipse fill="gold" stroke="black" cx="14083.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14083.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14083.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14083.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_5&#45;&gt;attn_scores_3_5 -->
<g id="edge1278" class="edge">
<title>transpose_q_3_5&#45;&gt;attn_scores_3_5</title>
<path fill="none" stroke="black" d="M13858.19,-2275.4C13897.91,-2261.26 13945.6,-2244.28 13986.86,-2229.59"/>
<polygon fill="black" stroke="black" points="13988.13,-2232.86 13996.38,-2226.21 13985.79,-2226.26 13988.13,-2232.86"/>
</g>
<!-- transpose_k_3_5&#45;&gt;attn_scores_3_5 -->
<g id="edge1279" class="edge">
<title>transpose_k_3_5&#45;&gt;attn_scores_3_5</title>
<path fill="none" stroke="black" d="M14083.57,-2268.54C14083.57,-2260.09 14083.57,-2250.99 14083.57,-2242.18"/>
<polygon fill="black" stroke="black" points="14087.07,-2242.01 14083.57,-2232.01 14080.07,-2242.01 14087.07,-2242.01"/>
</g>
<!-- attn_output_3_5 -->
<g id="node1066" class="node">
<title>attn_output_3_5</title>
<ellipse fill="gold" stroke="black" cx="14392.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14392.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14392.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14392.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_5&#45;&gt;attn_output_3_5 -->
<g id="edge1280" class="edge">
<title>transpose_v_3_5&#45;&gt;attn_output_3_5</title>
<path fill="none" stroke="black" d="M14392.57,-2268.47C14392.57,-2207.42 14392.57,-2085.11 14392.57,-2017.96"/>
<polygon fill="black" stroke="black" points="14396.07,-2017.67 14392.57,-2007.67 14389.07,-2017.67 14396.07,-2017.67"/>
</g>
<!-- softmax_3_5 -->
<g id="node1067" class="node">
<title>softmax_3_5</title>
<ellipse fill="gold" stroke="black" cx="14140.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14140.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14140.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14140.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_5&#45;&gt;softmax_3_5 -->
<g id="edge1281" class="edge">
<title>attn_scores_3_5&#45;&gt;softmax_3_5</title>
<path fill="none" stroke="black" d="M14102.4,-2156.84C14107.11,-2147.74 14112.23,-2137.86 14117.15,-2128.38"/>
<polygon fill="black" stroke="black" points="14120.28,-2129.94 14121.77,-2119.45 14114.06,-2126.72 14120.28,-2129.94"/>
</g>
<!-- transpose_back_3_5 -->
<g id="node1068" class="node">
<title>transpose_back_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="14561.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14561.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14561.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14561.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_5&#45;&gt;transpose_back_3_5 -->
<g id="edge1283" class="edge">
<title>attn_output_3_5&#45;&gt;transpose_back_3_5</title>
<path fill="none" stroke="black" d="M14445.12,-1934.96C14462.61,-1923.58 14482.23,-1910.81 14500.32,-1899.03"/>
<polygon fill="black" stroke="black" points="14502.59,-1901.74 14509.06,-1893.35 14498.77,-1895.87 14502.59,-1901.74"/>
</g>
<!-- softmax_3_5&#45;&gt;attn_output_3_5 -->
<g id="edge1282" class="edge">
<title>softmax_3_5&#45;&gt;attn_output_3_5</title>
<path fill="none" stroke="black" d="M14215.16,-2048.61C14245.15,-2035.52 14279.83,-2020.38 14310.52,-2006.98"/>
<polygon fill="black" stroke="black" points="14312.15,-2010.09 14319.91,-2002.88 14309.35,-2003.68 14312.15,-2010.09"/>
</g>
<!-- reshape_concat_3_5 -->
<g id="node1069" class="node">
<title>reshape_concat_3_5</title>
<ellipse fill="lightcyan" stroke="black" cx="14901.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14901.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14901.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14901.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_5&#45;&gt;reshape_concat_3_5 -->
<g id="edge1284" class="edge">
<title>transpose_back_3_5&#45;&gt;reshape_concat_3_5</title>
<path fill="none" stroke="black" d="M14650.46,-1828.41C14698.33,-1812.92 14757.4,-1793.81 14806.22,-1778.01"/>
<polygon fill="black" stroke="black" points="14807.41,-1781.31 14815.85,-1774.9 14805.25,-1774.65 14807.41,-1781.31"/>
</g>
<!-- reshape_concat_3_5&#45;&gt;allgather_dim_3_1 -->
<g id="edge1285" class="edge">
<title>reshape_concat_3_5&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M14975.5,-1714.95C15020.98,-1696.35 15079.34,-1672.5 15126.29,-1653.3"/>
<polygon fill="black" stroke="black" points="15127.89,-1656.43 15135.82,-1649.41 15125.24,-1649.95 15127.89,-1656.43"/>
</g>
<!-- split_q_3_6 -->
<g id="node1071" class="node">
<title>split_q_3_6</title>
<ellipse fill="pink" stroke="black" cx="14701.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14701.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14701.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14701.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_q_3_6 -->
<g id="edge1287" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_q_3_6</title>
<path fill="none" stroke="black" d="M14994.64,-2501.2C14937.67,-2485.25 14866.29,-2465.27 14808.24,-2449.02"/>
<polygon fill="black" stroke="black" points="14808.88,-2445.57 14798.31,-2446.24 14806.99,-2452.31 14808.88,-2445.57"/>
</g>
<!-- split_k_3_6 -->
<g id="node1072" class="node">
<title>split_k_3_6</title>
<ellipse fill="pink" stroke="black" cx="15010.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15010.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15010.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15010.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_k_3_6 -->
<g id="edge1288" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_k_3_6</title>
<path fill="none" stroke="black" d="M15067.07,-2493.15C15059.82,-2483.65 15051.91,-2473.29 15044.37,-2463.42"/>
<polygon fill="black" stroke="black" points="15046.99,-2461.09 15038.14,-2455.27 15041.43,-2465.34 15046.99,-2461.09"/>
</g>
<!-- split_v_3_6 -->
<g id="node1073" class="node">
<title>split_v_3_6</title>
<ellipse fill="pink" stroke="black" cx="15319.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15319.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15319.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15319.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_v_3_6 -->
<g id="edge1289" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_v_3_6</title>
<path fill="none" stroke="black" d="M15162.08,-2496.16C15187.9,-2483.54 15217.51,-2469.06 15244.03,-2456.1"/>
<polygon fill="black" stroke="black" points="15245.83,-2459.11 15253.28,-2451.58 15242.75,-2452.83 15245.83,-2459.11"/>
</g>
<!-- transpose_q_3_6 -->
<g id="node1074" class="node">
<title>transpose_q_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="14701.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14701.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14701.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14701.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_6&#45;&gt;transpose_q_3_6 -->
<g id="edge1290" class="edge">
<title>split_q_3_6&#45;&gt;transpose_q_3_6</title>
<path fill="none" stroke="black" d="M14701.57,-2380.54C14701.57,-2372.09 14701.57,-2362.99 14701.57,-2354.18"/>
<polygon fill="black" stroke="black" points="14705.07,-2354.01 14701.57,-2344.01 14698.07,-2354.01 14705.07,-2354.01"/>
</g>
<!-- transpose_k_3_6 -->
<g id="node1075" class="node">
<title>transpose_k_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="15010.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15010.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15010.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15010.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_6&#45;&gt;transpose_k_3_6 -->
<g id="edge1291" class="edge">
<title>split_k_3_6&#45;&gt;transpose_k_3_6</title>
<path fill="none" stroke="black" d="M15010.57,-2380.54C15010.57,-2372.09 15010.57,-2362.99 15010.57,-2354.18"/>
<polygon fill="black" stroke="black" points="15014.07,-2354.01 15010.57,-2344.01 15007.07,-2354.01 15014.07,-2354.01"/>
</g>
<!-- transpose_v_3_6 -->
<g id="node1076" class="node">
<title>transpose_v_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="15319.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15319.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15319.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15319.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_6&#45;&gt;transpose_v_3_6 -->
<g id="edge1292" class="edge">
<title>split_v_3_6&#45;&gt;transpose_v_3_6</title>
<path fill="none" stroke="black" d="M15319.57,-2380.54C15319.57,-2372.09 15319.57,-2362.99 15319.57,-2354.18"/>
<polygon fill="black" stroke="black" points="15323.07,-2354.01 15319.57,-2344.01 15316.07,-2354.01 15323.07,-2354.01"/>
</g>
<!-- attn_scores_3_6 -->
<g id="node1077" class="node">
<title>attn_scores_3_6</title>
<ellipse fill="gold" stroke="black" cx="15010.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15010.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15010.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15010.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_6&#45;&gt;attn_scores_3_6 -->
<g id="edge1293" class="edge">
<title>transpose_q_3_6&#45;&gt;attn_scores_3_6</title>
<path fill="none" stroke="black" d="M14785.19,-2275.4C14824.91,-2261.26 14872.6,-2244.28 14913.86,-2229.59"/>
<polygon fill="black" stroke="black" points="14915.13,-2232.86 14923.38,-2226.21 14912.79,-2226.26 14915.13,-2232.86"/>
</g>
<!-- transpose_k_3_6&#45;&gt;attn_scores_3_6 -->
<g id="edge1294" class="edge">
<title>transpose_k_3_6&#45;&gt;attn_scores_3_6</title>
<path fill="none" stroke="black" d="M15010.57,-2268.54C15010.57,-2260.09 15010.57,-2250.99 15010.57,-2242.18"/>
<polygon fill="black" stroke="black" points="15014.07,-2242.01 15010.57,-2232.01 15007.07,-2242.01 15014.07,-2242.01"/>
</g>
<!-- attn_output_3_6 -->
<g id="node1078" class="node">
<title>attn_output_3_6</title>
<ellipse fill="gold" stroke="black" cx="15208.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15208.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15208.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15208.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_6&#45;&gt;attn_output_3_6 -->
<g id="edge1295" class="edge">
<title>transpose_v_3_6&#45;&gt;attn_output_3_6</title>
<path fill="none" stroke="black" d="M15307.48,-2268.79C15287.2,-2207.76 15246.35,-2084.85 15224.02,-2017.65"/>
<polygon fill="black" stroke="black" points="15227.21,-2016.14 15220.73,-2007.75 15220.57,-2018.35 15227.21,-2016.14"/>
</g>
<!-- softmax_3_6 -->
<g id="node1079" class="node">
<title>softmax_3_6</title>
<ellipse fill="gold" stroke="black" cx="15032.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15032.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15032.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15032.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_6&#45;&gt;softmax_3_6 -->
<g id="edge1296" class="edge">
<title>attn_scores_3_6&#45;&gt;softmax_3_6</title>
<path fill="none" stroke="black" d="M15017.9,-2156.54C15019.62,-2147.91 15021.49,-2138.6 15023.29,-2129.61"/>
<polygon fill="black" stroke="black" points="15026.75,-2130.13 15025.28,-2119.63 15019.89,-2128.75 15026.75,-2130.13"/>
</g>
<!-- transpose_back_3_6 -->
<g id="node1080" class="node">
<title>transpose_back_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="15208.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15208.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="15208.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15208.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_6&#45;&gt;transpose_back_3_6 -->
<g id="edge1298" class="edge">
<title>attn_output_3_6&#45;&gt;transpose_back_3_6</title>
<path fill="none" stroke="black" d="M15208.57,-1932.54C15208.57,-1924.09 15208.57,-1914.99 15208.57,-1906.18"/>
<polygon fill="black" stroke="black" points="15212.07,-1906.01 15208.57,-1896.01 15205.07,-1906.01 15212.07,-1906.01"/>
</g>
<!-- softmax_3_6&#45;&gt;attn_output_3_6 -->
<g id="edge1297" class="edge">
<title>softmax_3_6&#45;&gt;attn_output_3_6</title>
<path fill="none" stroke="black" d="M15087.78,-2046.66C15106.22,-2035.13 15126.91,-2022.2 15145.89,-2010.35"/>
<polygon fill="black" stroke="black" points="15147.84,-2013.25 15154.47,-2004.98 15144.13,-2007.31 15147.84,-2013.25"/>
</g>
<!-- reshape_concat_3_6 -->
<g id="node1081" class="node">
<title>reshape_concat_3_6</title>
<ellipse fill="lightcyan" stroke="black" cx="15208.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="15208.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="15208.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15208.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_6&#45;&gt;reshape_concat_3_6 -->
<g id="edge1299" class="edge">
<title>transpose_back_3_6&#45;&gt;reshape_concat_3_6</title>
<path fill="none" stroke="black" d="M15208.57,-1820.54C15208.57,-1812.09 15208.57,-1802.99 15208.57,-1794.18"/>
<polygon fill="black" stroke="black" points="15212.07,-1794.01 15208.57,-1784.01 15205.07,-1794.01 15212.07,-1794.01"/>
</g>
<!-- reshape_concat_3_6&#45;&gt;allgather_dim_3_1 -->
<g id="edge1300" class="edge">
<title>reshape_concat_3_6&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M15208.57,-1708.53C15208.57,-1700.22 15208.57,-1691.18 15208.57,-1682.13"/>
<polygon fill="black" stroke="black" points="15212.07,-1681.97 15208.57,-1671.97 15205.07,-1681.97 15212.07,-1681.97"/>
</g>
<!-- split_q_3_7 -->
<g id="node1083" class="node">
<title>split_q_3_7</title>
<ellipse fill="pink" stroke="black" cx="15628.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15628.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15628.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15628.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_q_3_7 -->
<g id="edge1302" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_q_3_7</title>
<path fill="none" stroke="black" d="M15964.9,-2502.68C15897.43,-2485.92 15810.31,-2464.29 15741.64,-2447.24"/>
<polygon fill="black" stroke="black" points="15742.2,-2443.77 15731.65,-2444.76 15740.51,-2450.57 15742.2,-2443.77"/>
</g>
<!-- split_k_3_7 -->
<g id="node1084" class="node">
<title>split_k_3_7</title>
<ellipse fill="pink" stroke="black" cx="15937.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15937.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15937.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15937.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_k_3_7 -->
<g id="edge1303" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_k_3_7</title>
<path fill="none" stroke="black" d="M16028.81,-2494.06C16015.87,-2483.44 16001.55,-2471.68 15988.15,-2460.69"/>
<polygon fill="black" stroke="black" points="15990.34,-2457.96 15980.39,-2454.32 15985.9,-2463.37 15990.34,-2457.96"/>
</g>
<!-- split_v_3_7 -->
<g id="node1085" class="node">
<title>split_v_3_7</title>
<ellipse fill="pink" stroke="black" cx="16246.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16246.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16246.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16246.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_v_3_7 -->
<g id="edge1304" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_v_3_7</title>
<path fill="none" stroke="black" d="M16125.99,-2494.96C16144.34,-2483.42 16164.98,-2470.45 16183.93,-2458.54"/>
<polygon fill="black" stroke="black" points="16185.89,-2461.44 16192.5,-2453.16 16182.17,-2455.52 16185.89,-2461.44"/>
</g>
<!-- transpose_q_3_7 -->
<g id="node1086" class="node">
<title>transpose_q_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="15628.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15628.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15628.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15628.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_7&#45;&gt;transpose_q_3_7 -->
<g id="edge1305" class="edge">
<title>split_q_3_7&#45;&gt;transpose_q_3_7</title>
<path fill="none" stroke="black" d="M15628.57,-2380.54C15628.57,-2372.09 15628.57,-2362.99 15628.57,-2354.18"/>
<polygon fill="black" stroke="black" points="15632.07,-2354.01 15628.57,-2344.01 15625.07,-2354.01 15632.07,-2354.01"/>
</g>
<!-- transpose_k_3_7 -->
<g id="node1087" class="node">
<title>transpose_k_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="15937.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15937.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15937.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15937.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_7&#45;&gt;transpose_k_3_7 -->
<g id="edge1306" class="edge">
<title>split_k_3_7&#45;&gt;transpose_k_3_7</title>
<path fill="none" stroke="black" d="M15937.57,-2380.54C15937.57,-2372.09 15937.57,-2362.99 15937.57,-2354.18"/>
<polygon fill="black" stroke="black" points="15941.07,-2354.01 15937.57,-2344.01 15934.07,-2354.01 15941.07,-2354.01"/>
</g>
<!-- transpose_v_3_7 -->
<g id="node1088" class="node">
<title>transpose_v_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="16246.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16246.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16246.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16246.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_7&#45;&gt;transpose_v_3_7 -->
<g id="edge1307" class="edge">
<title>split_v_3_7&#45;&gt;transpose_v_3_7</title>
<path fill="none" stroke="black" d="M16246.57,-2380.54C16246.57,-2372.09 16246.57,-2362.99 16246.57,-2354.18"/>
<polygon fill="black" stroke="black" points="16250.07,-2354.01 16246.57,-2344.01 16243.07,-2354.01 16250.07,-2354.01"/>
</g>
<!-- attn_scores_3_7 -->
<g id="node1089" class="node">
<title>attn_scores_3_7</title>
<ellipse fill="gold" stroke="black" cx="15922.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15922.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15922.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15922.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_7&#45;&gt;attn_scores_3_7 -->
<g id="edge1308" class="edge">
<title>transpose_q_3_7&#45;&gt;attn_scores_3_7</title>
<path fill="none" stroke="black" d="M15709.69,-2274.82C15746.59,-2261.01 15790.47,-2244.59 15828.78,-2230.26"/>
<polygon fill="black" stroke="black" points="15830.25,-2233.44 15838.39,-2226.66 15827.8,-2226.89 15830.25,-2233.44"/>
</g>
<!-- transpose_k_3_7&#45;&gt;attn_scores_3_7 -->
<g id="edge1309" class="edge">
<title>transpose_k_3_7&#45;&gt;attn_scores_3_7</title>
<path fill="none" stroke="black" d="M15932.58,-2268.54C15931.43,-2260.09 15930.19,-2250.99 15928.98,-2242.18"/>
<polygon fill="black" stroke="black" points="15932.42,-2241.44 15927.6,-2232.01 15925.48,-2242.39 15932.42,-2241.44"/>
</g>
<!-- attn_output_3_7 -->
<g id="node1090" class="node">
<title>attn_output_3_7</title>
<ellipse fill="gold" stroke="black" cx="15922.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15922.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15922.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15922.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_7&#45;&gt;attn_output_3_7 -->
<g id="edge1310" class="edge">
<title>transpose_v_3_7&#45;&gt;attn_output_3_7</title>
<path fill="none" stroke="black" d="M16234.55,-2268.64C16214.59,-2213.2 16169.64,-2107.61 16098.57,-2044.67 16078.46,-2026.85 16053.42,-2012.95 16028.59,-2002.26"/>
<polygon fill="black" stroke="black" points="16029.68,-1998.92 16019.1,-1998.32 16026.99,-2005.39 16029.68,-1998.92"/>
</g>
<!-- softmax_3_7 -->
<g id="node1091" class="node">
<title>softmax_3_7</title>
<ellipse fill="gold" stroke="black" cx="15922.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15922.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15922.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15922.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_7&#45;&gt;softmax_3_7 -->
<g id="edge1311" class="edge">
<title>attn_scores_3_7&#45;&gt;softmax_3_7</title>
<path fill="none" stroke="black" d="M15922.57,-2156.54C15922.57,-2148.09 15922.57,-2138.99 15922.57,-2130.18"/>
<polygon fill="black" stroke="black" points="15926.07,-2130.01 15922.57,-2120.01 15919.07,-2130.01 15926.07,-2130.01"/>
</g>
<!-- transpose_back_3_7 -->
<g id="node1092" class="node">
<title>transpose_back_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="15790.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15790.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="15790.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15790.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_7&#45;&gt;transpose_back_3_7 -->
<g id="edge1313" class="edge">
<title>attn_output_3_7&#45;&gt;transpose_back_3_7</title>
<path fill="none" stroke="black" d="M15880.44,-1934.06C15867.82,-1923.54 15853.86,-1911.9 15840.77,-1901"/>
<polygon fill="black" stroke="black" points="15842.68,-1898.03 15832.75,-1894.32 15838.2,-1903.41 15842.68,-1898.03"/>
</g>
<!-- softmax_3_7&#45;&gt;attn_output_3_7 -->
<g id="edge1312" class="edge">
<title>softmax_3_7&#45;&gt;attn_output_3_7</title>
<path fill="none" stroke="black" d="M15922.57,-2044.54C15922.57,-2036.09 15922.57,-2026.99 15922.57,-2018.18"/>
<polygon fill="black" stroke="black" points="15926.07,-2018.01 15922.57,-2008.01 15919.07,-2018.01 15926.07,-2018.01"/>
</g>
<!-- reshape_concat_3_7 -->
<g id="node1093" class="node">
<title>reshape_concat_3_7</title>
<ellipse fill="lightcyan" stroke="black" cx="15592.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="15592.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="15592.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15592.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_7&#45;&gt;reshape_concat_3_7 -->
<g id="edge1314" class="edge">
<title>transpose_back_3_7&#45;&gt;reshape_concat_3_7</title>
<path fill="none" stroke="black" d="M15730.63,-1823.86C15708.52,-1811.58 15683.32,-1797.58 15660.56,-1784.93"/>
<polygon fill="black" stroke="black" points="15662.07,-1781.77 15651.63,-1779.98 15658.67,-1787.89 15662.07,-1781.77"/>
</g>
<!-- reshape_concat_3_7&#45;&gt;allgather_dim_3_1 -->
<g id="edge1315" class="edge">
<title>reshape_concat_3_7&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M15507.35,-1717.31C15445.98,-1697.26 15363.27,-1670.23 15300.44,-1649.69"/>
<polygon fill="black" stroke="black" points="15301.51,-1646.36 15290.92,-1646.58 15299.34,-1653.01 15301.51,-1646.36"/>
</g>
<!-- output_proj_3_1 -->
<g id="node1196" class="node">
<title>output_proj_3_1</title>
<ellipse fill="orange" stroke="black" cx="15526.57" cy="-1405.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15526.57" y="-1424.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15526.57" y="-1409.38" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15526.57" y="-1394.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15526.57" y="-1379.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_1&#45;&gt;output_proj_3_1 -->
<g id="edge1440" class="edge">
<title>head_group_3_1&#45;&gt;output_proj_3_1</title>
<path fill="none" stroke="black" d="M15351.99,-1490.65C15375.69,-1479.24 15407.4,-1463.97 15437.3,-1449.57"/>
<polygon fill="black" stroke="black" points="15439.01,-1452.63 15446.51,-1445.14 15435.98,-1446.32 15439.01,-1452.63"/>
</g>
<!-- split_q_3_8 -->
<g id="node1096" class="node">
<title>split_q_3_8</title>
<ellipse fill="pink" stroke="black" cx="16555.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16555.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16555.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16555.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_q_3_8 -->
<g id="edge1318" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_q_3_8</title>
<path fill="none" stroke="black" d="M16629.86,-2493.45C16619.77,-2483.36 16608.68,-2472.28 16598.23,-2461.82"/>
<polygon fill="black" stroke="black" points="16600.65,-2459.3 16591.11,-2454.7 16595.7,-2464.25 16600.65,-2459.3"/>
</g>
<!-- split_k_3_8 -->
<g id="node1097" class="node">
<title>split_k_3_8</title>
<ellipse fill="pink" stroke="black" cx="16864.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16864.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16864.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16864.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_k_3_8 -->
<g id="edge1319" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_k_3_8</title>
<path fill="none" stroke="black" d="M16726.36,-2495.56C16748.26,-2483.46 16773.12,-2469.72 16795.66,-2457.26"/>
<polygon fill="black" stroke="black" points="16797.44,-2460.27 16804.5,-2452.37 16794.05,-2454.15 16797.44,-2460.27"/>
</g>
<!-- split_v_3_8 -->
<g id="node1098" class="node">
<title>split_v_3_8</title>
<ellipse fill="pink" stroke="black" cx="17173.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17173.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17173.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17173.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_v_3_8 -->
<g id="edge1320" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_v_3_8</title>
<path fill="none" stroke="black" d="M16783.75,-2505.49C16852.64,-2491.47 16941.14,-2473.1 17019.57,-2455.67 17032.29,-2452.84 17045.58,-2449.81 17058.79,-2446.74"/>
<polygon fill="black" stroke="black" points="17059.93,-2450.07 17068.87,-2444.4 17058.34,-2443.26 17059.93,-2450.07"/>
</g>
<!-- transpose_q_3_8 -->
<g id="node1099" class="node">
<title>transpose_q_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="16555.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16555.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16555.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16555.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_8&#45;&gt;transpose_q_3_8 -->
<g id="edge1321" class="edge">
<title>split_q_3_8&#45;&gt;transpose_q_3_8</title>
<path fill="none" stroke="black" d="M16555.57,-2380.54C16555.57,-2372.09 16555.57,-2362.99 16555.57,-2354.18"/>
<polygon fill="black" stroke="black" points="16559.07,-2354.01 16555.57,-2344.01 16552.07,-2354.01 16559.07,-2354.01"/>
</g>
<!-- transpose_k_3_8 -->
<g id="node1100" class="node">
<title>transpose_k_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="16864.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16864.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16864.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16864.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_8&#45;&gt;transpose_k_3_8 -->
<g id="edge1322" class="edge">
<title>split_k_3_8&#45;&gt;transpose_k_3_8</title>
<path fill="none" stroke="black" d="M16864.57,-2380.54C16864.57,-2372.09 16864.57,-2362.99 16864.57,-2354.18"/>
<polygon fill="black" stroke="black" points="16868.07,-2354.01 16864.57,-2344.01 16861.07,-2354.01 16868.07,-2354.01"/>
</g>
<!-- transpose_v_3_8 -->
<g id="node1101" class="node">
<title>transpose_v_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="17173.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17173.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17173.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17173.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_8&#45;&gt;transpose_v_3_8 -->
<g id="edge1323" class="edge">
<title>split_v_3_8&#45;&gt;transpose_v_3_8</title>
<path fill="none" stroke="black" d="M17173.57,-2380.54C17173.57,-2372.09 17173.57,-2362.99 17173.57,-2354.18"/>
<polygon fill="black" stroke="black" points="17177.07,-2354.01 17173.57,-2344.01 17170.07,-2354.01 17177.07,-2354.01"/>
</g>
<!-- attn_scores_3_8 -->
<g id="node1102" class="node">
<title>attn_scores_3_8</title>
<ellipse fill="gold" stroke="black" cx="16864.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16864.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16864.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16864.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_8&#45;&gt;attn_scores_3_8 -->
<g id="edge1324" class="edge">
<title>transpose_q_3_8&#45;&gt;attn_scores_3_8</title>
<path fill="none" stroke="black" d="M16639.19,-2275.4C16678.91,-2261.26 16726.6,-2244.28 16767.86,-2229.59"/>
<polygon fill="black" stroke="black" points="16769.13,-2232.86 16777.38,-2226.21 16766.79,-2226.26 16769.13,-2232.86"/>
</g>
<!-- transpose_k_3_8&#45;&gt;attn_scores_3_8 -->
<g id="edge1325" class="edge">
<title>transpose_k_3_8&#45;&gt;attn_scores_3_8</title>
<path fill="none" stroke="black" d="M16864.57,-2268.54C16864.57,-2260.09 16864.57,-2250.99 16864.57,-2242.18"/>
<polygon fill="black" stroke="black" points="16868.07,-2242.01 16864.57,-2232.01 16861.07,-2242.01 16868.07,-2242.01"/>
</g>
<!-- attn_output_3_8 -->
<g id="node1103" class="node">
<title>attn_output_3_8</title>
<ellipse fill="gold" stroke="black" cx="17173.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17173.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17173.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17173.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_8&#45;&gt;attn_output_3_8 -->
<g id="edge1326" class="edge">
<title>transpose_v_3_8&#45;&gt;attn_output_3_8</title>
<path fill="none" stroke="black" d="M17173.57,-2268.47C17173.57,-2207.42 17173.57,-2085.11 17173.57,-2017.96"/>
<polygon fill="black" stroke="black" points="17177.07,-2017.67 17173.57,-2007.67 17170.07,-2017.67 17177.07,-2017.67"/>
</g>
<!-- softmax_3_8 -->
<g id="node1104" class="node">
<title>softmax_3_8</title>
<ellipse fill="gold" stroke="black" cx="16921.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16921.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16921.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16921.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_8&#45;&gt;softmax_3_8 -->
<g id="edge1327" class="edge">
<title>attn_scores_3_8&#45;&gt;softmax_3_8</title>
<path fill="none" stroke="black" d="M16883.4,-2156.84C16888.11,-2147.74 16893.23,-2137.86 16898.15,-2128.38"/>
<polygon fill="black" stroke="black" points="16901.28,-2129.94 16902.77,-2119.45 16895.06,-2126.72 16901.28,-2129.94"/>
</g>
<!-- transpose_back_3_8 -->
<g id="node1105" class="node">
<title>transpose_back_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="17224.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17224.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17224.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17224.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_8&#45;&gt;transpose_back_3_8 -->
<g id="edge1329" class="edge">
<title>attn_output_3_8&#45;&gt;transpose_back_3_8</title>
<path fill="none" stroke="black" d="M17190.41,-1932.84C17194.59,-1923.83 17199.12,-1914.06 17203.48,-1904.67"/>
<polygon fill="black" stroke="black" points="17206.72,-1906 17207.75,-1895.45 17200.37,-1903.05 17206.72,-1906"/>
</g>
<!-- softmax_3_8&#45;&gt;attn_output_3_8 -->
<g id="edge1328" class="edge">
<title>softmax_3_8&#45;&gt;attn_output_3_8</title>
<path fill="none" stroke="black" d="M16996.16,-2048.61C17026.15,-2035.52 17060.83,-2020.38 17091.52,-2006.98"/>
<polygon fill="black" stroke="black" points="17093.15,-2010.09 17100.91,-2002.88 17090.35,-2003.68 17093.15,-2010.09"/>
</g>
<!-- reshape_concat_3_8 -->
<g id="node1106" class="node">
<title>reshape_concat_3_8</title>
<ellipse fill="lightcyan" stroke="black" cx="17463.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17463.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17463.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17463.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_8&#45;&gt;reshape_concat_3_8 -->
<g id="edge1330" class="edge">
<title>transpose_back_3_8&#45;&gt;reshape_concat_3_8</title>
<path fill="none" stroke="black" d="M17294.02,-1825.2C17323,-1811.86 17356.77,-1796.32 17386.51,-1782.63"/>
<polygon fill="black" stroke="black" points="17387.98,-1785.81 17395.6,-1778.45 17385.05,-1779.45 17387.98,-1785.81"/>
</g>
<!-- allgather_dim_3_2 -->
<g id="node1107" class="node">
<title>allgather_dim_3_2</title>
<polygon fill="red" stroke="black" points="17970.57,-1671.67 17797.57,-1618.67 17970.57,-1565.67 18143.57,-1618.67 17970.57,-1671.67"/>
<text text-anchor="middle" x="17970.57" y="-1629.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="17970.57" y="-1614.97" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="17970.57" y="-1599.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_8&#45;&gt;allgather_dim_3_2 -->
<g id="edge1331" class="edge">
<title>reshape_concat_3_8&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M17561.93,-1720.82C17649.5,-1699.14 17777.2,-1667.53 17866.48,-1645.43"/>
<polygon fill="black" stroke="black" points="17867.48,-1648.79 17876.35,-1642.99 17865.8,-1642 17867.48,-1648.79"/>
</g>
<!-- head_group_3_2 -->
<g id="node1144" class="node">
<title>head_group_3_2</title>
<polygon fill="lightyellow" stroke="black" points="17799.07,-1528.67 17602.07,-1528.67 17602.07,-1490.67 17799.07,-1490.67 17799.07,-1528.67"/>
<text text-anchor="middle" x="17700.57" y="-1513.47" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="17700.57" y="-1498.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_2&#45;&gt;head_group_3_2 -->
<g id="edge1377" class="edge">
<title>allgather_dim_3_2&#45;&gt;head_group_3_2</title>
<path fill="none" stroke="black" d="M17896.44,-1588.29C17851.92,-1570.65 17796.24,-1548.58 17755.64,-1532.49"/>
<polygon fill="black" stroke="black" points="17756.76,-1529.17 17746.18,-1528.74 17754.18,-1535.68 17756.76,-1529.17"/>
</g>
<!-- split_q_3_9 -->
<g id="node1109" class="node">
<title>split_q_3_9</title>
<ellipse fill="pink" stroke="black" cx="17482.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17482.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17482.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17482.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_q_3_9 -->
<g id="edge1333" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_q_3_9</title>
<path fill="none" stroke="black" d="M17587.85,-2494.36C17572.31,-2483.27 17555,-2470.9 17538.97,-2459.45"/>
<polygon fill="black" stroke="black" points="17540.89,-2456.52 17530.72,-2453.56 17536.82,-2462.22 17540.89,-2456.52"/>
</g>
<!-- split_k_3_9 -->
<g id="node1110" class="node">
<title>split_k_3_9</title>
<ellipse fill="pink" stroke="black" cx="17791.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17791.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17791.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17791.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_k_3_9 -->
<g id="edge1334" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_k_3_9</title>
<path fill="none" stroke="black" d="M17685.62,-2494.36C17701.25,-2483.27 17718.68,-2470.9 17734.81,-2459.45"/>
<polygon fill="black" stroke="black" points="17736.99,-2462.2 17743.11,-2453.56 17732.93,-2456.49 17736.99,-2462.2"/>
</g>
<!-- split_v_3_9 -->
<g id="node1111" class="node">
<title>split_v_3_9</title>
<ellipse fill="pink" stroke="black" cx="18100.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18100.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18100.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="18100.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_v_3_9 -->
<g id="edge1335" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_v_3_9</title>
<path fill="none" stroke="black" d="M17745.95,-2503.24C17817.85,-2486.19 17911.81,-2463.92 17984.95,-2446.58"/>
<polygon fill="black" stroke="black" points="17986.2,-2449.88 17995.13,-2444.16 17984.59,-2443.07 17986.2,-2449.88"/>
</g>
<!-- transpose_q_3_9 -->
<g id="node1112" class="node">
<title>transpose_q_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="17482.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17482.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17482.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17482.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_9&#45;&gt;transpose_q_3_9 -->
<g id="edge1336" class="edge">
<title>split_q_3_9&#45;&gt;transpose_q_3_9</title>
<path fill="none" stroke="black" d="M17482.57,-2380.54C17482.57,-2372.09 17482.57,-2362.99 17482.57,-2354.18"/>
<polygon fill="black" stroke="black" points="17486.07,-2354.01 17482.57,-2344.01 17479.07,-2354.01 17486.07,-2354.01"/>
</g>
<!-- transpose_k_3_9 -->
<g id="node1113" class="node">
<title>transpose_k_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="17791.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17791.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17791.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17791.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_9&#45;&gt;transpose_k_3_9 -->
<g id="edge1337" class="edge">
<title>split_k_3_9&#45;&gt;transpose_k_3_9</title>
<path fill="none" stroke="black" d="M17791.57,-2380.54C17791.57,-2372.09 17791.57,-2362.99 17791.57,-2354.18"/>
<polygon fill="black" stroke="black" points="17795.07,-2354.01 17791.57,-2344.01 17788.07,-2354.01 17795.07,-2354.01"/>
</g>
<!-- transpose_v_3_9 -->
<g id="node1114" class="node">
<title>transpose_v_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="18100.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18100.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18100.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="18100.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_9&#45;&gt;transpose_v_3_9 -->
<g id="edge1338" class="edge">
<title>split_v_3_9&#45;&gt;transpose_v_3_9</title>
<path fill="none" stroke="black" d="M18100.57,-2380.54C18100.57,-2372.09 18100.57,-2362.99 18100.57,-2354.18"/>
<polygon fill="black" stroke="black" points="18104.07,-2354.01 18100.57,-2344.01 18097.07,-2354.01 18104.07,-2354.01"/>
</g>
<!-- attn_scores_3_9 -->
<g id="node1115" class="node">
<title>attn_scores_3_9</title>
<ellipse fill="gold" stroke="black" cx="17791.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17791.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17791.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17791.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_9&#45;&gt;attn_scores_3_9 -->
<g id="edge1339" class="edge">
<title>transpose_q_3_9&#45;&gt;attn_scores_3_9</title>
<path fill="none" stroke="black" d="M17566.19,-2275.4C17605.91,-2261.26 17653.6,-2244.28 17694.86,-2229.59"/>
<polygon fill="black" stroke="black" points="17696.13,-2232.86 17704.38,-2226.21 17693.79,-2226.26 17696.13,-2232.86"/>
</g>
<!-- transpose_k_3_9&#45;&gt;attn_scores_3_9 -->
<g id="edge1340" class="edge">
<title>transpose_k_3_9&#45;&gt;attn_scores_3_9</title>
<path fill="none" stroke="black" d="M17791.57,-2268.54C17791.57,-2260.09 17791.57,-2250.99 17791.57,-2242.18"/>
<polygon fill="black" stroke="black" points="17795.07,-2242.01 17791.57,-2232.01 17788.07,-2242.01 17795.07,-2242.01"/>
</g>
<!-- attn_output_3_9 -->
<g id="node1116" class="node">
<title>attn_output_3_9</title>
<ellipse fill="gold" stroke="black" cx="17970.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17970.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17970.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17970.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_9&#45;&gt;attn_output_3_9 -->
<g id="edge1341" class="edge">
<title>transpose_v_3_9&#45;&gt;attn_output_3_9</title>
<path fill="none" stroke="black" d="M18086.41,-2268.79C18062.58,-2207.55 18014.5,-2084.02 17988.4,-2016.97"/>
<polygon fill="black" stroke="black" points="17991.6,-2015.55 17984.72,-2007.5 17985.08,-2018.09 17991.6,-2015.55"/>
</g>
<!-- softmax_3_9 -->
<g id="node1117" class="node">
<title>softmax_3_9</title>
<ellipse fill="gold" stroke="black" cx="17820.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17820.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17820.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17820.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_9&#45;&gt;softmax_3_9 -->
<g id="edge1342" class="edge">
<title>attn_scores_3_9&#45;&gt;softmax_3_9</title>
<path fill="none" stroke="black" d="M17801.23,-2156.54C17803.53,-2147.82 17806.01,-2138.4 17808.41,-2129.31"/>
<polygon fill="black" stroke="black" points="17811.79,-2130.2 17810.96,-2119.63 17805.03,-2128.41 17811.79,-2130.2"/>
</g>
<!-- transpose_back_3_9 -->
<g id="node1118" class="node">
<title>transpose_back_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="17970.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17970.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17970.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17970.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_9&#45;&gt;transpose_back_3_9 -->
<g id="edge1344" class="edge">
<title>attn_output_3_9&#45;&gt;transpose_back_3_9</title>
<path fill="none" stroke="black" d="M17970.57,-1932.54C17970.57,-1924.09 17970.57,-1914.99 17970.57,-1906.18"/>
<polygon fill="black" stroke="black" points="17974.07,-1906.01 17970.57,-1896.01 17967.07,-1906.01 17974.07,-1906.01"/>
</g>
<!-- softmax_3_9&#45;&gt;attn_output_3_9 -->
<g id="edge1343" class="edge">
<title>softmax_3_9&#45;&gt;attn_output_3_9</title>
<path fill="none" stroke="black" d="M17868.45,-2046.06C17883.28,-2035.18 17899.74,-2023.11 17915.05,-2011.89"/>
<polygon fill="black" stroke="black" points="17917.42,-2014.49 17923.41,-2005.75 17913.28,-2008.84 17917.42,-2014.49"/>
</g>
<!-- reshape_concat_3_9 -->
<g id="node1119" class="node">
<title>reshape_concat_3_9</title>
<ellipse fill="lightcyan" stroke="black" cx="17970.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17970.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17970.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="17970.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_9&#45;&gt;reshape_concat_3_9 -->
<g id="edge1345" class="edge">
<title>transpose_back_3_9&#45;&gt;reshape_concat_3_9</title>
<path fill="none" stroke="black" d="M17970.57,-1820.54C17970.57,-1812.09 17970.57,-1802.99 17970.57,-1794.18"/>
<polygon fill="black" stroke="black" points="17974.07,-1794.01 17970.57,-1784.01 17967.07,-1794.01 17974.07,-1794.01"/>
</g>
<!-- reshape_concat_3_9&#45;&gt;allgather_dim_3_2 -->
<g id="edge1346" class="edge">
<title>reshape_concat_3_9&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M17970.57,-1708.53C17970.57,-1700.22 17970.57,-1691.18 17970.57,-1682.13"/>
<polygon fill="black" stroke="black" points="17974.07,-1681.97 17970.57,-1671.97 17967.07,-1681.97 17974.07,-1681.97"/>
</g>
<!-- split_q_3_10 -->
<g id="node1121" class="node">
<title>split_q_3_10</title>
<ellipse fill="pink" stroke="black" cx="18409.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18409.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18409.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18409.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_q_3_10 -->
<g id="edge1348" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_q_3_10</title>
<path fill="none" stroke="black" d="M18466.07,-2493.15C18458.82,-2483.65 18450.91,-2473.29 18443.37,-2463.42"/>
<polygon fill="black" stroke="black" points="18445.99,-2461.09 18437.14,-2455.27 18440.43,-2465.34 18445.99,-2461.09"/>
</g>
<!-- split_k_3_10 -->
<g id="node1122" class="node">
<title>split_k_3_10</title>
<ellipse fill="pink" stroke="black" cx="18718.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18718.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18718.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18718.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_k_3_10 -->
<g id="edge1349" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_k_3_10</title>
<path fill="none" stroke="black" d="M18561.08,-2496.16C18586.9,-2483.54 18616.51,-2469.06 18643.03,-2456.1"/>
<polygon fill="black" stroke="black" points="18644.83,-2459.11 18652.28,-2451.58 18641.75,-2452.83 18644.83,-2459.11"/>
</g>
<!-- split_v_3_10 -->
<g id="node1123" class="node">
<title>split_v_3_10</title>
<ellipse fill="pink" stroke="black" cx="19027.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19027.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19027.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="19027.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_v_3_10 -->
<g id="edge1350" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_v_3_10</title>
<path fill="none" stroke="black" d="M18616.2,-2506.79C18690.77,-2492.85 18787.85,-2474.11 18873.57,-2455.67 18886.54,-2452.88 18900.1,-2449.84 18913.56,-2446.75"/>
<polygon fill="black" stroke="black" points="18914.37,-2450.15 18923.33,-2444.49 18912.8,-2443.33 18914.37,-2450.15"/>
</g>
<!-- transpose_q_3_10 -->
<g id="node1124" class="node">
<title>transpose_q_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="18409.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18409.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18409.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18409.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_10&#45;&gt;transpose_q_3_10 -->
<g id="edge1351" class="edge">
<title>split_q_3_10&#45;&gt;transpose_q_3_10</title>
<path fill="none" stroke="black" d="M18409.57,-2380.54C18409.57,-2372.09 18409.57,-2362.99 18409.57,-2354.18"/>
<polygon fill="black" stroke="black" points="18413.07,-2354.01 18409.57,-2344.01 18406.07,-2354.01 18413.07,-2354.01"/>
</g>
<!-- transpose_k_3_10 -->
<g id="node1125" class="node">
<title>transpose_k_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="18718.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18718.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18718.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18718.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_10&#45;&gt;transpose_k_3_10 -->
<g id="edge1352" class="edge">
<title>split_k_3_10&#45;&gt;transpose_k_3_10</title>
<path fill="none" stroke="black" d="M18718.57,-2380.54C18718.57,-2372.09 18718.57,-2362.99 18718.57,-2354.18"/>
<polygon fill="black" stroke="black" points="18722.07,-2354.01 18718.57,-2344.01 18715.07,-2354.01 18722.07,-2354.01"/>
</g>
<!-- transpose_v_3_10 -->
<g id="node1126" class="node">
<title>transpose_v_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="19027.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19027.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19027.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="19027.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_10&#45;&gt;transpose_v_3_10 -->
<g id="edge1353" class="edge">
<title>split_v_3_10&#45;&gt;transpose_v_3_10</title>
<path fill="none" stroke="black" d="M19027.57,-2380.54C19027.57,-2372.09 19027.57,-2362.99 19027.57,-2354.18"/>
<polygon fill="black" stroke="black" points="19031.07,-2354.01 19027.57,-2344.01 19024.07,-2354.01 19031.07,-2354.01"/>
</g>
<!-- attn_scores_3_10 -->
<g id="node1127" class="node">
<title>attn_scores_3_10</title>
<ellipse fill="gold" stroke="black" cx="18643.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18643.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="18643.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18643.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_10&#45;&gt;attn_scores_3_10 -->
<g id="edge1354" class="edge">
<title>transpose_q_3_10&#45;&gt;attn_scores_3_10</title>
<path fill="none" stroke="black" d="M18478.2,-2272.91C18505.1,-2260.26 18536.14,-2245.67 18564.01,-2232.57"/>
<polygon fill="black" stroke="black" points="18565.76,-2235.61 18573.32,-2228.19 18562.79,-2229.28 18565.76,-2235.61"/>
</g>
<!-- transpose_k_3_10&#45;&gt;attn_scores_3_10 -->
<g id="edge1355" class="edge">
<title>transpose_k_3_10&#45;&gt;attn_scores_3_10</title>
<path fill="none" stroke="black" d="M18694.02,-2269.15C18687.61,-2259.75 18680.62,-2249.5 18673.95,-2239.71"/>
<polygon fill="black" stroke="black" points="18676.71,-2237.56 18668.19,-2231.27 18670.93,-2241.5 18676.71,-2237.56"/>
</g>
<!-- attn_output_3_10 -->
<g id="node1128" class="node">
<title>attn_output_3_10</title>
<ellipse fill="gold" stroke="black" cx="18643.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18643.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18643.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18643.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_10&#45;&gt;attn_output_3_10 -->
<g id="edge1356" class="edge">
<title>transpose_v_3_10&#45;&gt;attn_output_3_10</title>
<path fill="none" stroke="black" d="M19006.83,-2268.81C18973.7,-2213.58 18903.89,-2108.27 18819.57,-2044.67 18797.32,-2027.88 18770.68,-2014.19 18744.94,-2003.37"/>
<polygon fill="black" stroke="black" points="18746.09,-2000.06 18735.51,-1999.51 18743.44,-2006.54 18746.09,-2000.06"/>
</g>
<!-- softmax_3_10 -->
<g id="node1129" class="node">
<title>softmax_3_10</title>
<ellipse fill="gold" stroke="black" cx="18643.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18643.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="18643.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18643.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_10&#45;&gt;softmax_3_10 -->
<g id="edge1357" class="edge">
<title>attn_scores_3_10&#45;&gt;softmax_3_10</title>
<path fill="none" stroke="black" d="M18643.57,-2156.54C18643.57,-2148.09 18643.57,-2138.99 18643.57,-2130.18"/>
<polygon fill="black" stroke="black" points="18647.07,-2130.01 18643.57,-2120.01 18640.07,-2130.01 18647.07,-2130.01"/>
</g>
<!-- transpose_back_3_10 -->
<g id="node1130" class="node">
<title>transpose_back_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="18484.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18484.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="18484.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18484.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_10&#45;&gt;transpose_back_3_10 -->
<g id="edge1359" class="edge">
<title>attn_output_3_10&#45;&gt;transpose_back_3_10</title>
<path fill="none" stroke="black" d="M18593.7,-1934.66C18577.57,-1923.5 18559.54,-1911.03 18542.85,-1899.49"/>
<polygon fill="black" stroke="black" points="18544.48,-1896.36 18534.27,-1893.55 18540.5,-1902.11 18544.48,-1896.36"/>
</g>
<!-- softmax_3_10&#45;&gt;attn_output_3_10 -->
<g id="edge1358" class="edge">
<title>softmax_3_10&#45;&gt;attn_output_3_10</title>
<path fill="none" stroke="black" d="M18643.57,-2044.54C18643.57,-2036.09 18643.57,-2026.99 18643.57,-2018.18"/>
<polygon fill="black" stroke="black" points="18647.07,-2018.01 18643.57,-2008.01 18640.07,-2018.01 18647.07,-2018.01"/>
</g>
<!-- reshape_concat_3_10 -->
<g id="node1131" class="node">
<title>reshape_concat_3_10</title>
<ellipse fill="lightcyan" stroke="black" cx="18313.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="18313.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="18313.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="18313.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_10&#45;&gt;reshape_concat_3_10 -->
<g id="edge1360" class="edge">
<title>transpose_back_3_10&#45;&gt;reshape_concat_3_10</title>
<path fill="none" stroke="black" d="M18431.41,-1822.96C18413.3,-1811.32 18392.92,-1798.21 18374.26,-1786.21"/>
<polygon fill="black" stroke="black" points="18376.13,-1783.25 18365.83,-1780.78 18372.34,-1789.13 18376.13,-1783.25"/>
</g>
<!-- reshape_concat_3_10&#45;&gt;allgather_dim_3_2 -->
<g id="edge1361" class="edge">
<title>reshape_concat_3_10&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M18234.02,-1716.06C18181.28,-1696.76 18112.07,-1671.44 18057.82,-1651.59"/>
<polygon fill="black" stroke="black" points="18058.81,-1648.22 18048.22,-1648.08 18056.41,-1654.8 18058.81,-1648.22"/>
</g>
<!-- split_q_3_11 -->
<g id="node1133" class="node">
<title>split_q_3_11</title>
<ellipse fill="pink" stroke="black" cx="19336.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19336.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19336.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19336.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_q_3_11 -->
<g id="edge1363" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_q_3_11</title>
<path fill="none" stroke="black" d="M19393.07,-2493.15C19385.82,-2483.65 19377.91,-2473.29 19370.37,-2463.42"/>
<polygon fill="black" stroke="black" points="19372.99,-2461.09 19364.14,-2455.27 19367.43,-2465.34 19372.99,-2461.09"/>
</g>
<!-- split_k_3_11 -->
<g id="node1134" class="node">
<title>split_k_3_11</title>
<ellipse fill="pink" stroke="black" cx="19645.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19645.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19645.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19645.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_k_3_11 -->
<g id="edge1364" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_k_3_11</title>
<path fill="none" stroke="black" d="M19488.08,-2496.16C19513.9,-2483.54 19543.51,-2469.06 19570.03,-2456.1"/>
<polygon fill="black" stroke="black" points="19571.83,-2459.11 19579.28,-2451.58 19568.75,-2452.83 19571.83,-2459.11"/>
</g>
<!-- split_v_3_11 -->
<g id="node1135" class="node">
<title>split_v_3_11</title>
<ellipse fill="pink" stroke="black" cx="19954.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19954.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19954.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19954.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_v_3_11 -->
<g id="edge1365" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_v_3_11</title>
<path fill="none" stroke="black" d="M19543.2,-2506.79C19617.77,-2492.85 19714.85,-2474.11 19800.57,-2455.67 19813.54,-2452.88 19827.1,-2449.84 19840.56,-2446.75"/>
<polygon fill="black" stroke="black" points="19841.37,-2450.15 19850.33,-2444.49 19839.8,-2443.33 19841.37,-2450.15"/>
</g>
<!-- transpose_q_3_11 -->
<g id="node1136" class="node">
<title>transpose_q_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="19336.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19336.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19336.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19336.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_11&#45;&gt;transpose_q_3_11 -->
<g id="edge1366" class="edge">
<title>split_q_3_11&#45;&gt;transpose_q_3_11</title>
<path fill="none" stroke="black" d="M19336.57,-2380.54C19336.57,-2372.09 19336.57,-2362.99 19336.57,-2354.18"/>
<polygon fill="black" stroke="black" points="19340.07,-2354.01 19336.57,-2344.01 19333.07,-2354.01 19340.07,-2354.01"/>
</g>
<!-- transpose_k_3_11 -->
<g id="node1137" class="node">
<title>transpose_k_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="19645.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19645.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19645.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19645.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_11&#45;&gt;transpose_k_3_11 -->
<g id="edge1367" class="edge">
<title>split_k_3_11&#45;&gt;transpose_k_3_11</title>
<path fill="none" stroke="black" d="M19645.57,-2380.54C19645.57,-2372.09 19645.57,-2362.99 19645.57,-2354.18"/>
<polygon fill="black" stroke="black" points="19649.07,-2354.01 19645.57,-2344.01 19642.07,-2354.01 19649.07,-2354.01"/>
</g>
<!-- transpose_v_3_11 -->
<g id="node1138" class="node">
<title>transpose_v_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="19954.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19954.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19954.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19954.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_11&#45;&gt;transpose_v_3_11 -->
<g id="edge1368" class="edge">
<title>split_v_3_11&#45;&gt;transpose_v_3_11</title>
<path fill="none" stroke="black" d="M19954.57,-2380.54C19954.57,-2372.09 19954.57,-2362.99 19954.57,-2354.18"/>
<polygon fill="black" stroke="black" points="19958.07,-2354.01 19954.57,-2344.01 19951.07,-2354.01 19958.07,-2354.01"/>
</g>
<!-- attn_scores_3_11 -->
<g id="node1139" class="node">
<title>attn_scores_3_11</title>
<ellipse fill="gold" stroke="black" cx="19600.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19600.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19600.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19600.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_11&#45;&gt;attn_scores_3_11 -->
<g id="edge1369" class="edge">
<title>transpose_q_3_11&#45;&gt;attn_scores_3_11</title>
<path fill="none" stroke="black" d="M19411.52,-2273.94C19443.29,-2260.7 19480.53,-2245.19 19513.51,-2231.44"/>
<polygon fill="black" stroke="black" points="19515.26,-2234.51 19523.14,-2227.43 19512.57,-2228.04 19515.26,-2234.51"/>
</g>
<!-- transpose_k_3_11&#45;&gt;attn_scores_3_11 -->
<g id="edge1370" class="edge">
<title>transpose_k_3_11&#45;&gt;attn_scores_3_11</title>
<path fill="none" stroke="black" d="M19630.71,-2268.84C19627.1,-2260.02 19623.2,-2250.47 19619.43,-2241.26"/>
<polygon fill="black" stroke="black" points="19622.6,-2239.76 19615.57,-2231.83 19616.12,-2242.41 19622.6,-2239.76"/>
</g>
<!-- attn_output_3_11 -->
<g id="node1140" class="node">
<title>attn_output_3_11</title>
<ellipse fill="gold" stroke="black" cx="19600.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19600.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19600.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19600.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_11&#45;&gt;attn_output_3_11 -->
<g id="edge1371" class="edge">
<title>transpose_v_3_11&#45;&gt;attn_output_3_11</title>
<path fill="none" stroke="black" d="M19938.15,-2268.69C19911.54,-2213.3 19854.08,-2107.79 19776.57,-2044.67 19755.31,-2027.35 19729.38,-2013.54 19704.03,-2002.79"/>
<polygon fill="black" stroke="black" points="19705.31,-1999.53 19694.73,-1998.96 19702.64,-2006 19705.31,-1999.53"/>
</g>
<!-- softmax_3_11 -->
<g id="node1141" class="node">
<title>softmax_3_11</title>
<ellipse fill="gold" stroke="black" cx="19600.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19600.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19600.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19600.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_11&#45;&gt;softmax_3_11 -->
<g id="edge1372" class="edge">
<title>attn_scores_3_11&#45;&gt;softmax_3_11</title>
<path fill="none" stroke="black" d="M19600.57,-2156.54C19600.57,-2148.09 19600.57,-2138.99 19600.57,-2130.18"/>
<polygon fill="black" stroke="black" points="19604.07,-2130.01 19600.57,-2120.01 19597.07,-2130.01 19604.07,-2130.01"/>
</g>
<!-- transpose_back_3_11 -->
<g id="node1142" class="node">
<title>transpose_back_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="19388.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19388.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="19388.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19388.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_11&#45;&gt;transpose_back_3_11 -->
<g id="edge1374" class="edge">
<title>attn_output_3_11&#45;&gt;transpose_back_3_11</title>
<path fill="none" stroke="black" d="M19537.25,-1936.31C19513.24,-1923.85 19485.71,-1909.57 19460.93,-1896.71"/>
<polygon fill="black" stroke="black" points="19462.42,-1893.54 19451.93,-1892.04 19459.2,-1899.75 19462.42,-1893.54"/>
</g>
<!-- softmax_3_11&#45;&gt;attn_output_3_11 -->
<g id="edge1373" class="edge">
<title>softmax_3_11&#45;&gt;attn_output_3_11</title>
<path fill="none" stroke="black" d="M19600.57,-2044.54C19600.57,-2036.09 19600.57,-2026.99 19600.57,-2018.18"/>
<polygon fill="black" stroke="black" points="19604.07,-2018.01 19600.57,-2008.01 19597.07,-2018.01 19604.07,-2018.01"/>
</g>
<!-- reshape_concat_3_11 -->
<g id="node1143" class="node">
<title>reshape_concat_3_11</title>
<ellipse fill="lightcyan" stroke="black" cx="19104.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="19104.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="19104.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="19104.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_11&#45;&gt;reshape_concat_3_11 -->
<g id="edge1375" class="edge">
<title>transpose_back_3_11&#45;&gt;reshape_concat_3_11</title>
<path fill="none" stroke="black" d="M19309.46,-1826.52C19272.55,-1812.23 19228.52,-1795.17 19190.76,-1780.55"/>
<polygon fill="black" stroke="black" points="19191.89,-1777.23 19181.3,-1776.88 19189.36,-1783.76 19191.89,-1777.23"/>
</g>
<!-- reshape_concat_3_11&#45;&gt;allgather_dim_3_2 -->
<g id="edge1376" class="edge">
<title>reshape_concat_3_11&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M18981.87,-1731.59C18767.83,-1707.9 18327.88,-1659.21 18105.54,-1634.6"/>
<polygon fill="black" stroke="black" points="18105.77,-1631.11 18095.44,-1633.49 18105,-1638.06 18105.77,-1631.11"/>
</g>
<!-- output_proj_3_2 -->
<g id="node1197" class="node">
<title>output_proj_3_2</title>
<ellipse fill="orange" stroke="black" cx="16973.57" cy="-1405.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16973.57" y="-1424.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16973.57" y="-1409.38" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16973.57" y="-1394.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16973.57" y="-1379.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_2&#45;&gt;output_proj_3_2 -->
<g id="edge1441" class="edge">
<title>head_group_3_2&#45;&gt;output_proj_3_2</title>
<path fill="none" stroke="black" d="M17601.77,-1494.79C17475.23,-1477.02 17255.23,-1446.13 17112.04,-1426.03"/>
<polygon fill="black" stroke="black" points="17112.25,-1422.52 17101.86,-1424.6 17111.28,-1429.45 17112.25,-1422.52"/>
</g>
<!-- split_q_3_12 -->
<g id="node1146" class="node">
<title>split_q_3_12</title>
<ellipse fill="pink" stroke="black" cx="20263.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20263.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20263.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20263.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_q_3_12 -->
<g id="edge1379" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_q_3_12</title>
<path fill="none" stroke="black" d="M20376.13,-2494.66C20359.26,-2483.35 20340.37,-2470.68 20322.96,-2459"/>
<polygon fill="black" stroke="black" points="20324.8,-2456.02 20314.55,-2453.36 20320.91,-2461.83 20324.8,-2456.02"/>
</g>
<!-- split_k_3_12 -->
<g id="node1147" class="node">
<title>split_k_3_12</title>
<ellipse fill="pink" stroke="black" cx="20572.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20572.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20572.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20572.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_k_3_12 -->
<g id="edge1380" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_k_3_12</title>
<path fill="none" stroke="black" d="M20473.85,-2494.06C20488.12,-2483.24 20503.95,-2471.23 20518.68,-2460.05"/>
<polygon fill="black" stroke="black" points="20520.88,-2462.77 20526.73,-2453.94 20516.65,-2457.2 20520.88,-2462.77"/>
</g>
<!-- split_v_3_12 -->
<g id="node1148" class="node">
<title>split_v_3_12</title>
<ellipse fill="pink" stroke="black" cx="20881.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20881.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20881.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20881.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_v_3_12 -->
<g id="edge1381" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_v_3_12</title>
<path fill="none" stroke="black" d="M20535.74,-2502.96C20605.63,-2486.03 20696.44,-2464.02 20767.47,-2446.81"/>
<polygon fill="black" stroke="black" points="20768.47,-2450.17 20777.36,-2444.42 20766.82,-2443.37 20768.47,-2450.17"/>
</g>
<!-- transpose_q_3_12 -->
<g id="node1149" class="node">
<title>transpose_q_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="20263.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20263.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20263.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20263.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_12&#45;&gt;transpose_q_3_12 -->
<g id="edge1382" class="edge">
<title>split_q_3_12&#45;&gt;transpose_q_3_12</title>
<path fill="none" stroke="black" d="M20263.57,-2380.54C20263.57,-2372.09 20263.57,-2362.99 20263.57,-2354.18"/>
<polygon fill="black" stroke="black" points="20267.07,-2354.01 20263.57,-2344.01 20260.07,-2354.01 20267.07,-2354.01"/>
</g>
<!-- transpose_k_3_12 -->
<g id="node1150" class="node">
<title>transpose_k_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="20572.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20572.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20572.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20572.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_12&#45;&gt;transpose_k_3_12 -->
<g id="edge1383" class="edge">
<title>split_k_3_12&#45;&gt;transpose_k_3_12</title>
<path fill="none" stroke="black" d="M20572.57,-2380.54C20572.57,-2372.09 20572.57,-2362.99 20572.57,-2354.18"/>
<polygon fill="black" stroke="black" points="20576.07,-2354.01 20572.57,-2344.01 20569.07,-2354.01 20576.07,-2354.01"/>
</g>
<!-- transpose_v_3_12 -->
<g id="node1151" class="node">
<title>transpose_v_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="20881.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20881.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20881.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20881.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_12&#45;&gt;transpose_v_3_12 -->
<g id="edge1384" class="edge">
<title>split_v_3_12&#45;&gt;transpose_v_3_12</title>
<path fill="none" stroke="black" d="M20881.57,-2380.54C20881.57,-2372.09 20881.57,-2362.99 20881.57,-2354.18"/>
<polygon fill="black" stroke="black" points="20885.07,-2354.01 20881.57,-2344.01 20878.07,-2354.01 20885.07,-2354.01"/>
</g>
<!-- attn_scores_3_12 -->
<g id="node1152" class="node">
<title>attn_scores_3_12</title>
<ellipse fill="gold" stroke="black" cx="20572.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20572.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20572.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20572.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_12&#45;&gt;attn_scores_3_12 -->
<g id="edge1385" class="edge">
<title>transpose_q_3_12&#45;&gt;attn_scores_3_12</title>
<path fill="none" stroke="black" d="M20347.19,-2275.4C20386.91,-2261.26 20434.6,-2244.28 20475.86,-2229.59"/>
<polygon fill="black" stroke="black" points="20477.13,-2232.86 20485.38,-2226.21 20474.79,-2226.26 20477.13,-2232.86"/>
</g>
<!-- transpose_k_3_12&#45;&gt;attn_scores_3_12 -->
<g id="edge1386" class="edge">
<title>transpose_k_3_12&#45;&gt;attn_scores_3_12</title>
<path fill="none" stroke="black" d="M20572.57,-2268.54C20572.57,-2260.09 20572.57,-2250.99 20572.57,-2242.18"/>
<polygon fill="black" stroke="black" points="20576.07,-2242.01 20572.57,-2232.01 20569.07,-2242.01 20576.07,-2242.01"/>
</g>
<!-- attn_output_3_12 -->
<g id="node1153" class="node">
<title>attn_output_3_12</title>
<ellipse fill="gold" stroke="black" cx="20881.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20881.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20881.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20881.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_12&#45;&gt;attn_output_3_12 -->
<g id="edge1387" class="edge">
<title>transpose_v_3_12&#45;&gt;attn_output_3_12</title>
<path fill="none" stroke="black" d="M20881.57,-2268.47C20881.57,-2207.42 20881.57,-2085.11 20881.57,-2017.96"/>
<polygon fill="black" stroke="black" points="20885.07,-2017.67 20881.57,-2007.67 20878.07,-2017.67 20885.07,-2017.67"/>
</g>
<!-- softmax_3_12 -->
<g id="node1154" class="node">
<title>softmax_3_12</title>
<ellipse fill="gold" stroke="black" cx="20629.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20629.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20629.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20629.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_12&#45;&gt;softmax_3_12 -->
<g id="edge1388" class="edge">
<title>attn_scores_3_12&#45;&gt;softmax_3_12</title>
<path fill="none" stroke="black" d="M20591.4,-2156.84C20596.11,-2147.74 20601.23,-2137.86 20606.15,-2128.38"/>
<polygon fill="black" stroke="black" points="20609.28,-2129.94 20610.77,-2119.45 20603.06,-2126.72 20609.28,-2129.94"/>
</g>
<!-- transpose_back_3_12 -->
<g id="node1155" class="node">
<title>transpose_back_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="21093.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21093.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21093.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="21093.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_12&#45;&gt;transpose_back_3_12 -->
<g id="edge1390" class="edge">
<title>attn_output_3_12&#45;&gt;transpose_back_3_12</title>
<path fill="none" stroke="black" d="M20944.89,-1936.31C20968.91,-1923.85 20996.43,-1909.57 21021.22,-1896.71"/>
<polygon fill="black" stroke="black" points="21022.95,-1899.75 21030.21,-1892.04 21019.73,-1893.54 21022.95,-1899.75"/>
</g>
<!-- softmax_3_12&#45;&gt;attn_output_3_12 -->
<g id="edge1389" class="edge">
<title>softmax_3_12&#45;&gt;attn_output_3_12</title>
<path fill="none" stroke="black" d="M20704.16,-2048.61C20734.15,-2035.52 20768.83,-2020.38 20799.52,-2006.98"/>
<polygon fill="black" stroke="black" points="20801.15,-2010.09 20808.91,-2002.88 20798.35,-2003.68 20801.15,-2010.09"/>
</g>
<!-- reshape_concat_3_12 -->
<g id="node1156" class="node">
<title>reshape_concat_3_12</title>
<ellipse fill="lightcyan" stroke="black" cx="21358.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21358.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21358.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="21358.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_12&#45;&gt;reshape_concat_3_12 -->
<g id="edge1391" class="edge">
<title>transpose_back_3_12&#45;&gt;reshape_concat_3_12</title>
<path fill="none" stroke="black" d="M21168.8,-1825.94C21202.23,-1812.06 21241.68,-1795.69 21275.93,-1781.47"/>
<polygon fill="black" stroke="black" points="21277.55,-1784.59 21285.44,-1777.52 21274.87,-1778.12 21277.55,-1784.59"/>
</g>
<!-- allgather_dim_3_3 -->
<g id="node1157" class="node">
<title>allgather_dim_3_3</title>
<polygon fill="red" stroke="black" points="21654.57,-1671.67 21481.57,-1618.67 21654.57,-1565.67 21827.57,-1618.67 21654.57,-1671.67"/>
<text text-anchor="middle" x="21654.57" y="-1629.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="21654.57" y="-1614.97" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="21654.57" y="-1599.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_12&#45;&gt;allgather_dim_3_3 -->
<g id="edge1392" class="edge">
<title>reshape_concat_3_12&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M21430.6,-1714.63C21473.9,-1696.27 21529.1,-1672.87 21573.86,-1653.89"/>
<polygon fill="black" stroke="black" points="21575.4,-1657.03 21583.25,-1649.91 21572.67,-1650.59 21575.4,-1657.03"/>
</g>
<!-- head_group_3_3 -->
<g id="node1194" class="node">
<title>head_group_3_3</title>
<polygon fill="lightyellow" stroke="black" points="18275.07,-1528.67 18078.07,-1528.67 18078.07,-1490.67 18275.07,-1490.67 18275.07,-1528.67"/>
<text text-anchor="middle" x="18176.57" y="-1513.47" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="18176.57" y="-1498.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_3&#45;&gt;head_group_3_3 -->
<g id="edge1438" class="edge">
<title>allgather_dim_3_3&#45;&gt;head_group_3_3</title>
<path fill="none" stroke="black" d="M21500.08,-1612.91C20907.97,-1594.7 18791.36,-1529.58 18285.66,-1514.02"/>
<polygon fill="black" stroke="black" points="18285.55,-1510.52 18275.45,-1513.71 18285.33,-1517.51 18285.55,-1510.52"/>
</g>
<!-- split_q_3_13 -->
<g id="node1159" class="node">
<title>split_q_3_13</title>
<ellipse fill="pink" stroke="black" cx="21190.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21190.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21190.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21190.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_q_3_13 -->
<g id="edge1394" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_q_3_13</title>
<path fill="none" stroke="black" d="M21247.07,-2493.15C21239.82,-2483.65 21231.91,-2473.29 21224.37,-2463.42"/>
<polygon fill="black" stroke="black" points="21226.99,-2461.09 21218.14,-2455.27 21221.43,-2465.34 21226.99,-2461.09"/>
</g>
<!-- split_k_3_13 -->
<g id="node1160" class="node">
<title>split_k_3_13</title>
<ellipse fill="pink" stroke="black" cx="21499.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21499.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21499.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21499.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_k_3_13 -->
<g id="edge1395" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_k_3_13</title>
<path fill="none" stroke="black" d="M21342.08,-2496.16C21367.9,-2483.54 21397.51,-2469.06 21424.03,-2456.1"/>
<polygon fill="black" stroke="black" points="21425.83,-2459.11 21433.28,-2451.58 21422.75,-2452.83 21425.83,-2459.11"/>
</g>
<!-- split_v_3_13 -->
<g id="node1161" class="node">
<title>split_v_3_13</title>
<ellipse fill="pink" stroke="black" cx="21808.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21808.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21808.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21808.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_v_3_13 -->
<g id="edge1396" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_v_3_13</title>
<path fill="none" stroke="black" d="M21397.2,-2506.79C21471.77,-2492.85 21568.85,-2474.11 21654.57,-2455.67 21667.54,-2452.88 21681.1,-2449.84 21694.56,-2446.75"/>
<polygon fill="black" stroke="black" points="21695.37,-2450.15 21704.33,-2444.49 21693.8,-2443.33 21695.37,-2450.15"/>
</g>
<!-- transpose_q_3_13 -->
<g id="node1162" class="node">
<title>transpose_q_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="21190.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21190.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21190.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21190.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_13&#45;&gt;transpose_q_3_13 -->
<g id="edge1397" class="edge">
<title>split_q_3_13&#45;&gt;transpose_q_3_13</title>
<path fill="none" stroke="black" d="M21190.57,-2380.54C21190.57,-2372.09 21190.57,-2362.99 21190.57,-2354.18"/>
<polygon fill="black" stroke="black" points="21194.07,-2354.01 21190.57,-2344.01 21187.07,-2354.01 21194.07,-2354.01"/>
</g>
<!-- transpose_k_3_13 -->
<g id="node1163" class="node">
<title>transpose_k_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="21499.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21499.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21499.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21499.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_13&#45;&gt;transpose_k_3_13 -->
<g id="edge1398" class="edge">
<title>split_k_3_13&#45;&gt;transpose_k_3_13</title>
<path fill="none" stroke="black" d="M21499.57,-2380.54C21499.57,-2372.09 21499.57,-2362.99 21499.57,-2354.18"/>
<polygon fill="black" stroke="black" points="21503.07,-2354.01 21499.57,-2344.01 21496.07,-2354.01 21503.07,-2354.01"/>
</g>
<!-- transpose_v_3_13 -->
<g id="node1164" class="node">
<title>transpose_v_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="21808.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21808.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21808.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21808.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_13&#45;&gt;transpose_v_3_13 -->
<g id="edge1399" class="edge">
<title>split_v_3_13&#45;&gt;transpose_v_3_13</title>
<path fill="none" stroke="black" d="M21808.57,-2380.54C21808.57,-2372.09 21808.57,-2362.99 21808.57,-2354.18"/>
<polygon fill="black" stroke="black" points="21812.07,-2354.01 21808.57,-2344.01 21805.07,-2354.01 21812.07,-2354.01"/>
</g>
<!-- attn_scores_3_13 -->
<g id="node1165" class="node">
<title>attn_scores_3_13</title>
<ellipse fill="gold" stroke="black" cx="21499.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21499.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21499.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21499.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_13&#45;&gt;attn_scores_3_13 -->
<g id="edge1400" class="edge">
<title>transpose_q_3_13&#45;&gt;attn_scores_3_13</title>
<path fill="none" stroke="black" d="M21274.19,-2275.4C21313.91,-2261.26 21361.6,-2244.28 21402.86,-2229.59"/>
<polygon fill="black" stroke="black" points="21404.13,-2232.86 21412.38,-2226.21 21401.79,-2226.26 21404.13,-2232.86"/>
</g>
<!-- transpose_k_3_13&#45;&gt;attn_scores_3_13 -->
<g id="edge1401" class="edge">
<title>transpose_k_3_13&#45;&gt;attn_scores_3_13</title>
<path fill="none" stroke="black" d="M21499.57,-2268.54C21499.57,-2260.09 21499.57,-2250.99 21499.57,-2242.18"/>
<polygon fill="black" stroke="black" points="21503.07,-2242.01 21499.57,-2232.01 21496.07,-2242.01 21503.07,-2242.01"/>
</g>
<!-- attn_output_3_13 -->
<g id="node1166" class="node">
<title>attn_output_3_13</title>
<ellipse fill="gold" stroke="black" cx="21654.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21654.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21654.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21654.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_13&#45;&gt;attn_output_3_13 -->
<g id="edge1402" class="edge">
<title>transpose_v_3_13&#45;&gt;attn_output_3_13</title>
<path fill="none" stroke="black" d="M21800.33,-2268.37C21787.65,-2216.19 21760.24,-2118.77 21717.57,-2044.67 21711.61,-2034.31 21704.1,-2024.04 21696.37,-2014.6"/>
<polygon fill="black" stroke="black" points="21698.97,-2012.26 21689.84,-2006.89 21693.63,-2016.78 21698.97,-2012.26"/>
</g>
<!-- softmax_3_13 -->
<g id="node1167" class="node">
<title>softmax_3_13</title>
<ellipse fill="gold" stroke="black" cx="21541.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21541.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21541.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21541.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_13&#45;&gt;softmax_3_13 -->
<g id="edge1403" class="edge">
<title>attn_scores_3_13&#45;&gt;softmax_3_13</title>
<path fill="none" stroke="black" d="M21513.56,-2156.54C21516.92,-2147.72 21520.56,-2138.2 21524.06,-2129.03"/>
<polygon fill="black" stroke="black" points="21527.35,-2130.23 21527.65,-2119.63 21520.81,-2127.73 21527.35,-2130.23"/>
</g>
<!-- transpose_back_3_13 -->
<g id="node1168" class="node">
<title>transpose_back_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="21654.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21654.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21654.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21654.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_13&#45;&gt;transpose_back_3_13 -->
<g id="edge1405" class="edge">
<title>attn_output_3_13&#45;&gt;transpose_back_3_13</title>
<path fill="none" stroke="black" d="M21654.57,-1932.54C21654.57,-1924.09 21654.57,-1914.99 21654.57,-1906.18"/>
<polygon fill="black" stroke="black" points="21658.07,-1906.01 21654.57,-1896.01 21651.07,-1906.01 21658.07,-1906.01"/>
</g>
<!-- softmax_3_13&#45;&gt;attn_output_3_13 -->
<g id="edge1404" class="edge">
<title>softmax_3_13&#45;&gt;attn_output_3_13</title>
<path fill="none" stroke="black" d="M21578.26,-2045.45C21588.63,-2035.36 21600.02,-2024.28 21610.76,-2013.82"/>
<polygon fill="black" stroke="black" points="21613.35,-2016.18 21618.07,-2006.7 21608.46,-2011.17 21613.35,-2016.18"/>
</g>
<!-- reshape_concat_3_13 -->
<g id="node1169" class="node">
<title>reshape_concat_3_13</title>
<ellipse fill="lightcyan" stroke="black" cx="21654.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21654.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21654.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21654.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_13&#45;&gt;reshape_concat_3_13 -->
<g id="edge1406" class="edge">
<title>transpose_back_3_13&#45;&gt;reshape_concat_3_13</title>
<path fill="none" stroke="black" d="M21654.57,-1820.54C21654.57,-1812.09 21654.57,-1802.99 21654.57,-1794.18"/>
<polygon fill="black" stroke="black" points="21658.07,-1794.01 21654.57,-1784.01 21651.07,-1794.01 21658.07,-1794.01"/>
</g>
<!-- reshape_concat_3_13&#45;&gt;allgather_dim_3_3 -->
<g id="edge1407" class="edge">
<title>reshape_concat_3_13&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M21654.57,-1708.53C21654.57,-1700.22 21654.57,-1691.18 21654.57,-1682.13"/>
<polygon fill="black" stroke="black" points="21658.07,-1681.97 21654.57,-1671.97 21651.07,-1681.97 21658.07,-1681.97"/>
</g>
<!-- split_q_3_14 -->
<g id="node1171" class="node">
<title>split_q_3_14</title>
<ellipse fill="pink" stroke="black" cx="22117.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22117.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="22117.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22117.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_q_3_14 -->
<g id="edge1409" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_q_3_14</title>
<path fill="none" stroke="black" d="M22223.53,-2494.36C22207.9,-2483.27 22190.47,-2470.9 22174.33,-2459.45"/>
<polygon fill="black" stroke="black" points="22176.21,-2456.49 22166.03,-2453.56 22172.16,-2462.2 22176.21,-2456.49"/>
</g>
<!-- split_k_3_14 -->
<g id="node1172" class="node">
<title>split_k_3_14</title>
<ellipse fill="pink" stroke="black" cx="22426.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22426.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="22426.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22426.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_k_3_14 -->
<g id="edge1410" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_k_3_14</title>
<path fill="none" stroke="black" d="M22321.3,-2494.36C22336.83,-2483.27 22354.15,-2470.9 22370.18,-2459.45"/>
<polygon fill="black" stroke="black" points="22372.32,-2462.22 22378.43,-2453.56 22368.26,-2456.52 22372.32,-2462.22"/>
</g>
<!-- split_v_3_14 -->
<g id="node1173" class="node">
<title>split_v_3_14</title>
<ellipse fill="pink" stroke="black" cx="22735.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22735.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22735.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22735.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_v_3_14 -->
<g id="edge1411" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_v_3_14</title>
<path fill="none" stroke="black" d="M22381.71,-2503.24C22453.46,-2486.19 22547.22,-2463.92 22620.2,-2446.58"/>
<polygon fill="black" stroke="black" points="22621.43,-2449.88 22630.35,-2444.16 22619.82,-2443.07 22621.43,-2449.88"/>
</g>
<!-- transpose_q_3_14 -->
<g id="node1174" class="node">
<title>transpose_q_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="22117.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22117.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="22117.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22117.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_14&#45;&gt;transpose_q_3_14 -->
<g id="edge1412" class="edge">
<title>split_q_3_14&#45;&gt;transpose_q_3_14</title>
<path fill="none" stroke="black" d="M22117.57,-2380.54C22117.57,-2372.09 22117.57,-2362.99 22117.57,-2354.18"/>
<polygon fill="black" stroke="black" points="22121.07,-2354.01 22117.57,-2344.01 22114.07,-2354.01 22121.07,-2354.01"/>
</g>
<!-- transpose_k_3_14 -->
<g id="node1175" class="node">
<title>transpose_k_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="22426.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22426.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="22426.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22426.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_14&#45;&gt;transpose_k_3_14 -->
<g id="edge1413" class="edge">
<title>split_k_3_14&#45;&gt;transpose_k_3_14</title>
<path fill="none" stroke="black" d="M22426.57,-2380.54C22426.57,-2372.09 22426.57,-2362.99 22426.57,-2354.18"/>
<polygon fill="black" stroke="black" points="22430.07,-2354.01 22426.57,-2344.01 22423.07,-2354.01 22430.07,-2354.01"/>
</g>
<!-- transpose_v_3_14 -->
<g id="node1176" class="node">
<title>transpose_v_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="22735.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22735.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22735.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22735.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_14&#45;&gt;transpose_v_3_14 -->
<g id="edge1414" class="edge">
<title>split_v_3_14&#45;&gt;transpose_v_3_14</title>
<path fill="none" stroke="black" d="M22735.57,-2380.54C22735.57,-2372.09 22735.57,-2362.99 22735.57,-2354.18"/>
<polygon fill="black" stroke="black" points="22739.07,-2354.01 22735.57,-2344.01 22732.07,-2354.01 22739.07,-2354.01"/>
</g>
<!-- attn_scores_3_14 -->
<g id="node1177" class="node">
<title>attn_scores_3_14</title>
<ellipse fill="gold" stroke="black" cx="22258.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="22258.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="22258.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22258.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_14&#45;&gt;attn_scores_3_14 -->
<g id="edge1415" class="edge">
<title>transpose_q_3_14&#45;&gt;attn_scores_3_14</title>
<path fill="none" stroke="black" d="M22162.19,-2270.36C22175.81,-2259.73 22190.93,-2247.94 22205.08,-2236.9"/>
<polygon fill="black" stroke="black" points="22207.55,-2239.41 22213.28,-2230.5 22203.24,-2233.89 22207.55,-2239.41"/>
</g>
<!-- transpose_k_3_14&#45;&gt;attn_scores_3_14 -->
<g id="edge1416" class="edge">
<title>transpose_k_3_14&#45;&gt;attn_scores_3_14</title>
<path fill="none" stroke="black" d="M22374.34,-2270.96C22357.2,-2259.75 22338,-2247.17 22320.24,-2235.54"/>
<polygon fill="black" stroke="black" points="22321.93,-2232.47 22311.64,-2229.92 22318.09,-2238.32 22321.93,-2232.47"/>
</g>
<!-- attn_output_3_14 -->
<g id="node1178" class="node">
<title>attn_output_3_14</title>
<ellipse fill="gold" stroke="black" cx="22258.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22258.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="22258.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22258.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_14&#45;&gt;attn_output_3_14 -->
<g id="edge1417" class="edge">
<title>transpose_v_3_14&#45;&gt;attn_output_3_14</title>
<path fill="none" stroke="black" d="M22701.9,-2269.5C22649.12,-2215.19 22541.8,-2111.07 22434.57,-2044.67 22409.52,-2029.15 22380.61,-2015.54 22353.56,-2004.38"/>
<polygon fill="black" stroke="black" points="22354.66,-2001.05 22344.07,-2000.54 22352.03,-2007.54 22354.66,-2001.05"/>
</g>
<!-- softmax_3_14 -->
<g id="node1179" class="node">
<title>softmax_3_14</title>
<ellipse fill="gold" stroke="black" cx="22258.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="22258.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="22258.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22258.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_14&#45;&gt;softmax_3_14 -->
<g id="edge1418" class="edge">
<title>attn_scores_3_14&#45;&gt;softmax_3_14</title>
<path fill="none" stroke="black" d="M22258.57,-2156.54C22258.57,-2148.09 22258.57,-2138.99 22258.57,-2130.18"/>
<polygon fill="black" stroke="black" points="22262.07,-2130.01 22258.57,-2120.01 22255.07,-2130.01 22262.07,-2130.01"/>
</g>
<!-- transpose_back_3_14 -->
<g id="node1180" class="node">
<title>transpose_back_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="22020.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22020.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="22020.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="22020.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_14&#45;&gt;transpose_back_3_14 -->
<g id="edge1420" class="edge">
<title>attn_output_3_14&#45;&gt;transpose_back_3_14</title>
<path fill="none" stroke="black" d="M22189.09,-1937.05C22160.99,-1924.06 22128.4,-1909 22099.41,-1895.6"/>
<polygon fill="black" stroke="black" points="22100.68,-1892.34 22090.14,-1891.32 22097.75,-1898.69 22100.68,-1892.34"/>
</g>
<!-- softmax_3_14&#45;&gt;attn_output_3_14 -->
<g id="edge1419" class="edge">
<title>softmax_3_14&#45;&gt;attn_output_3_14</title>
<path fill="none" stroke="black" d="M22258.57,-2044.54C22258.57,-2036.09 22258.57,-2026.99 22258.57,-2018.18"/>
<polygon fill="black" stroke="black" points="22262.07,-2018.01 22258.57,-2008.01 22255.07,-2018.01 22262.07,-2018.01"/>
</g>
<!-- reshape_concat_3_14 -->
<g id="node1181" class="node">
<title>reshape_concat_3_14</title>
<ellipse fill="lightcyan" stroke="black" cx="21950.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21950.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21950.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21950.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_14&#45;&gt;reshape_concat_3_14 -->
<g id="edge1421" class="edge">
<title>transpose_back_3_14&#45;&gt;reshape_concat_3_14</title>
<path fill="none" stroke="black" d="M21997.46,-1820.84C21991.6,-1811.64 21985.25,-1801.65 21979.16,-1792.09"/>
<polygon fill="black" stroke="black" points="21981.99,-1790.01 21973.66,-1783.45 21976.08,-1793.77 21981.99,-1790.01"/>
</g>
<!-- reshape_concat_3_14&#45;&gt;allgather_dim_3_3 -->
<g id="edge1422" class="edge">
<title>reshape_concat_3_14&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M21878.54,-1714.63C21835.25,-1696.27 21780.05,-1672.87 21735.29,-1653.89"/>
<polygon fill="black" stroke="black" points="21736.47,-1650.59 21725.9,-1649.91 21733.74,-1657.03 21736.47,-1650.59"/>
</g>
<!-- split_q_3_15 -->
<g id="node1183" class="node">
<title>split_q_3_15</title>
<ellipse fill="pink" stroke="black" cx="23044.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23044.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="23044.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23044.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_q_3_15 -->
<g id="edge1424" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_q_3_15</title>
<path fill="none" stroke="black" d="M23149.85,-2494.36C23134.31,-2483.27 23117,-2470.9 23100.97,-2459.45"/>
<polygon fill="black" stroke="black" points="23102.89,-2456.52 23092.72,-2453.56 23098.82,-2462.22 23102.89,-2456.52"/>
</g>
<!-- split_k_3_15 -->
<g id="node1184" class="node">
<title>split_k_3_15</title>
<ellipse fill="pink" stroke="black" cx="23353.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23353.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="23353.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23353.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_k_3_15 -->
<g id="edge1425" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_k_3_15</title>
<path fill="none" stroke="black" d="M23247.62,-2494.36C23263.25,-2483.27 23280.68,-2470.9 23296.81,-2459.45"/>
<polygon fill="black" stroke="black" points="23298.99,-2462.2 23305.11,-2453.56 23294.93,-2456.49 23298.99,-2462.2"/>
</g>
<!-- split_v_3_15 -->
<g id="node1185" class="node">
<title>split_v_3_15</title>
<ellipse fill="pink" stroke="black" cx="23662.57" cy="-2418.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23662.57" y="-2429.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="23662.57" y="-2414.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23662.57" y="-2399.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_v_3_15 -->
<g id="edge1426" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_v_3_15</title>
<path fill="none" stroke="black" d="M23307.95,-2503.24C23379.85,-2486.19 23473.81,-2463.92 23546.95,-2446.58"/>
<polygon fill="black" stroke="black" points="23548.2,-2449.88 23557.13,-2444.16 23546.59,-2443.07 23548.2,-2449.88"/>
</g>
<!-- transpose_q_3_15 -->
<g id="node1186" class="node">
<title>transpose_q_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="23044.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23044.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="23044.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23044.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_15&#45;&gt;transpose_q_3_15 -->
<g id="edge1427" class="edge">
<title>split_q_3_15&#45;&gt;transpose_q_3_15</title>
<path fill="none" stroke="black" d="M23044.57,-2380.54C23044.57,-2372.09 23044.57,-2362.99 23044.57,-2354.18"/>
<polygon fill="black" stroke="black" points="23048.07,-2354.01 23044.57,-2344.01 23041.07,-2354.01 23048.07,-2354.01"/>
</g>
<!-- transpose_k_3_15 -->
<g id="node1187" class="node">
<title>transpose_k_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="23353.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23353.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="23353.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23353.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_15&#45;&gt;transpose_k_3_15 -->
<g id="edge1428" class="edge">
<title>split_k_3_15&#45;&gt;transpose_k_3_15</title>
<path fill="none" stroke="black" d="M23353.57,-2380.54C23353.57,-2372.09 23353.57,-2362.99 23353.57,-2354.18"/>
<polygon fill="black" stroke="black" points="23357.07,-2354.01 23353.57,-2344.01 23350.07,-2354.01 23357.07,-2354.01"/>
</g>
<!-- transpose_v_3_15 -->
<g id="node1188" class="node">
<title>transpose_v_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="23662.57" cy="-2306.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23662.57" y="-2317.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="23662.57" y="-2302.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23662.57" y="-2287.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_15&#45;&gt;transpose_v_3_15 -->
<g id="edge1429" class="edge">
<title>split_v_3_15&#45;&gt;transpose_v_3_15</title>
<path fill="none" stroke="black" d="M23662.57,-2380.54C23662.57,-2372.09 23662.57,-2362.99 23662.57,-2354.18"/>
<polygon fill="black" stroke="black" points="23666.07,-2354.01 23662.57,-2344.01 23659.07,-2354.01 23666.07,-2354.01"/>
</g>
<!-- attn_scores_3_15 -->
<g id="node1189" class="node">
<title>attn_scores_3_15</title>
<ellipse fill="gold" stroke="black" cx="23176.57" cy="-2194.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="23176.57" y="-2205.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="23176.57" y="-2190.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23176.57" y="-2175.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_15&#45;&gt;attn_scores_3_15 -->
<g id="edge1430" class="edge">
<title>transpose_q_3_15&#45;&gt;attn_scores_3_15</title>
<path fill="none" stroke="black" d="M23086.7,-2270.06C23099.2,-2259.65 23113.01,-2248.13 23125.99,-2237.32"/>
<polygon fill="black" stroke="black" points="23128.5,-2239.79 23133.94,-2230.69 23124.02,-2234.41 23128.5,-2239.79"/>
</g>
<!-- transpose_k_3_15&#45;&gt;attn_scores_3_15 -->
<g id="edge1431" class="edge">
<title>transpose_k_3_15&#45;&gt;attn_scores_3_15</title>
<path fill="none" stroke="black" d="M23299.02,-2271.26C23280.61,-2259.82 23259.89,-2246.95 23240.81,-2235.08"/>
<polygon fill="black" stroke="black" points="23242.51,-2232.02 23232.16,-2229.71 23238.81,-2237.97 23242.51,-2232.02"/>
</g>
<!-- attn_output_3_15 -->
<g id="node1190" class="node">
<title>attn_output_3_15</title>
<ellipse fill="gold" stroke="black" cx="23176.57" cy="-1970.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="23176.57" y="-1981.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="23176.57" y="-1966.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23176.57" y="-1951.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_15&#45;&gt;attn_output_3_15 -->
<g id="edge1432" class="edge">
<title>transpose_v_3_15&#45;&gt;attn_output_3_15</title>
<path fill="none" stroke="black" d="M23627.68,-2269.58C23573.03,-2215.39 23462.13,-2111.42 23352.57,-2044.67 23327.4,-2029.33 23298.46,-2015.77 23271.41,-2004.61"/>
<polygon fill="black" stroke="black" points="23272.52,-2001.28 23261.93,-2000.77 23269.88,-2007.77 23272.52,-2001.28"/>
</g>
<!-- softmax_3_15 -->
<g id="node1191" class="node">
<title>softmax_3_15</title>
<ellipse fill="gold" stroke="black" cx="23176.57" cy="-2082.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="23176.57" y="-2093.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="23176.57" y="-2078.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="23176.57" y="-2063.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_15&#45;&gt;softmax_3_15 -->
<g id="edge1433" class="edge">
<title>attn_scores_3_15&#45;&gt;softmax_3_15</title>
<path fill="none" stroke="black" d="M23176.57,-2156.54C23176.57,-2148.09 23176.57,-2138.99 23176.57,-2130.18"/>
<polygon fill="black" stroke="black" points="23180.07,-2130.01 23176.57,-2120.01 23173.07,-2130.01 23180.07,-2130.01"/>
</g>
<!-- transpose_back_3_15 -->
<g id="node1192" class="node">
<title>transpose_back_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="22666.57" cy="-1858.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22666.57" y="-1869.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="22666.57" y="-1854.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22666.57" y="-1839.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_15&#45;&gt;transpose_back_3_15 -->
<g id="edge1435" class="edge">
<title>attn_output_3_15&#45;&gt;transpose_back_3_15</title>
<path fill="none" stroke="black" d="M23066.85,-1945.5C22984.34,-1927.7 22871.38,-1903.34 22786.49,-1885.03"/>
<polygon fill="black" stroke="black" points="22787.06,-1881.57 22776.54,-1882.89 22785.58,-1888.42 22787.06,-1881.57"/>
</g>
<!-- softmax_3_15&#45;&gt;attn_output_3_15 -->
<g id="edge1434" class="edge">
<title>softmax_3_15&#45;&gt;attn_output_3_15</title>
<path fill="none" stroke="black" d="M23176.57,-2044.54C23176.57,-2036.09 23176.57,-2026.99 23176.57,-2018.18"/>
<polygon fill="black" stroke="black" points="23180.07,-2018.01 23176.57,-2008.01 23173.07,-2018.01 23180.07,-2018.01"/>
</g>
<!-- reshape_concat_3_15 -->
<g id="node1193" class="node">
<title>reshape_concat_3_15</title>
<ellipse fill="lightcyan" stroke="black" cx="22253.57" cy="-1746.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="22253.57" y="-1757.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="22253.57" y="-1742.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22253.57" y="-1727.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_15&#45;&gt;reshape_concat_3_15 -->
<g id="edge1436" class="edge">
<title>transpose_back_3_15&#45;&gt;reshape_concat_3_15</title>
<path fill="none" stroke="black" d="M22567.12,-1830.68C22504.01,-1813.87 22422.45,-1792.15 22358.34,-1775.07"/>
<polygon fill="black" stroke="black" points="22359.17,-1771.67 22348.61,-1772.48 22357.37,-1778.43 22359.17,-1771.67"/>
</g>
<!-- reshape_concat_3_15&#45;&gt;allgather_dim_3_3 -->
<g id="edge1437" class="edge">
<title>reshape_concat_3_15&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M22152.31,-1721.84C22132.52,-1717.39 22111.91,-1712.82 22092.57,-1708.67 21982.64,-1685.04 21856.81,-1659.64 21768.31,-1642.05"/>
<polygon fill="black" stroke="black" points="21768.74,-1638.57 21758.25,-1640.05 21767.38,-1645.43 21768.74,-1638.57"/>
</g>
<!-- output_proj_3_3 -->
<g id="node1198" class="node">
<title>output_proj_3_3</title>
<ellipse fill="orange" stroke="black" cx="17845.57" cy="-1405.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17845.57" y="-1424.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17845.57" y="-1409.38" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="17845.57" y="-1394.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17845.57" y="-1379.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_3&#45;&gt;output_proj_3_3 -->
<g id="edge1442" class="edge">
<title>head_group_3_3&#45;&gt;output_proj_3_3</title>
<path fill="none" stroke="black" d="M18118.16,-1490.65C18073.86,-1476.99 18011.63,-1457.8 17957.81,-1441.2"/>
<polygon fill="black" stroke="black" points="17958.8,-1437.84 17948.22,-1438.24 17956.74,-1444.53 17958.8,-1437.84"/>
</g>
<!-- allreduce_output_3 -->
<g id="node1199" class="node">
<title>allreduce_output_3</title>
<polygon fill="red" stroke="black" points="16181.57,-1320.5 16038.57,-1267.5 16181.57,-1214.5 16324.57,-1267.5 16181.57,-1320.5"/>
<text text-anchor="middle" x="16181.57" y="-1278.8" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="16181.57" y="-1263.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="16181.57" y="-1248.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_3_0&#45;&gt;allreduce_output_3 -->
<g id="edge1443" class="edge">
<title>output_proj_3_0&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M15149.33,-1387C15217.44,-1377.87 15302.49,-1366.72 15378.57,-1357.5 15620.93,-1328.13 15904.93,-1297.56 16061.91,-1280.99"/>
<polygon fill="black" stroke="black" points="16062.49,-1284.45 16072.06,-1279.92 16061.75,-1277.49 16062.49,-1284.45"/>
</g>
<!-- output_proj_3_1&#45;&gt;allreduce_output_3 -->
<g id="edge1444" class="edge">
<title>output_proj_3_1&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M15663.97,-1397.26C15764.75,-1389.32 15904.1,-1372.96 16022.57,-1339.5 16053.81,-1330.68 16086.81,-1316.77 16114.6,-1303.59"/>
<polygon fill="black" stroke="black" points="16116.32,-1306.65 16123.82,-1299.16 16113.29,-1300.34 16116.32,-1306.65"/>
</g>
<!-- output_proj_3_2&#45;&gt;allreduce_output_3 -->
<g id="edge1445" class="edge">
<title>output_proj_3_2&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M16845.06,-1386.47C16759.94,-1374.12 16645.92,-1356.91 16545.57,-1339.5 16456.21,-1324 16354.97,-1304.06 16281.99,-1289.26"/>
<polygon fill="black" stroke="black" points="16282.38,-1285.76 16271.88,-1287.2 16280.98,-1292.62 16282.38,-1285.76"/>
</g>
<!-- output_proj_3_3&#45;&gt;allreduce_output_3 -->
<g id="edge1446" class="edge">
<title>output_proj_3_3&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M17710.46,-1393.53C17394.82,-1367.72 16612.71,-1303.76 16306.94,-1278.75"/>
<polygon fill="black" stroke="black" points="16306.96,-1275.24 16296.71,-1277.92 16306.39,-1282.22 16306.96,-1275.24"/>
</g>
<!-- residual_3 -->
<g id="node1200" class="node">
<title>residual_3</title>
<ellipse fill="lightgreen" stroke="black" cx="16181.57" cy="-1140" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="16181.57" y="-1151.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16181.57" y="-1136.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="16181.57" y="-1121.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_output_3&#45;&gt;residual_3 -->
<g id="edge1447" class="edge">
<title>allreduce_output_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M16181.57,-1214.37C16181.57,-1205.65 16181.57,-1196.66 16181.57,-1188.08"/>
<polygon fill="black" stroke="black" points="16185.07,-1187.87 16181.57,-1177.87 16178.07,-1187.87 16185.07,-1187.87"/>
</g>
<!-- ln2_3_0 -->
<g id="node1201" class="node">
<title>ln2_3_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13811.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13811.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13811.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13811.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_0 -->
<g id="edge1448" class="edge">
<title>residual_3&#45;&gt;ln2_3_0</title>
<path fill="none" stroke="black" d="M16027.79,-1134.4C15728.39,-1125.37 15046.26,-1104.48 14472.57,-1084.5 14248.99,-1076.71 14191.33,-1095.03 13969.57,-1065.5 13954.58,-1063.5 13938.92,-1060.74 13923.53,-1057.61"/>
<polygon fill="black" stroke="black" points="13923.98,-1054.13 13913.47,-1055.51 13922.54,-1060.98 13923.98,-1054.13"/>
</g>
<!-- ln2_3_1 -->
<g id="node1202" class="node">
<title>ln2_3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="14127.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14127.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14127.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14127.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_1 -->
<g id="edge1449" class="edge">
<title>residual_3&#45;&gt;ln2_3_1</title>
<path fill="none" stroke="black" d="M16026.37,-1136.75C15635.97,-1130.48 14620.45,-1110.26 14285.57,-1065.5 14270.58,-1063.5 14254.92,-1060.72 14239.53,-1057.6"/>
<polygon fill="black" stroke="black" points="14239.98,-1054.11 14229.47,-1055.5 14238.55,-1060.97 14239.98,-1054.11"/>
</g>
<!-- ln2_3_2 -->
<g id="node1203" class="node">
<title>ln2_3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14443.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14443.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14443.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14443.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_2 -->
<g id="edge1450" class="edge">
<title>residual_3&#45;&gt;ln2_3_2</title>
<path fill="none" stroke="black" d="M16027.21,-1135.37C15685.45,-1126.75 14873.7,-1102.95 14601.57,-1065.5 14586.59,-1063.44 14570.93,-1060.63 14555.55,-1057.49"/>
<polygon fill="black" stroke="black" points="14555.99,-1054.01 14545.49,-1055.38 14554.56,-1060.86 14555.99,-1054.01"/>
</g>
<!-- ln2_3_3 -->
<g id="node1204" class="node">
<title>ln2_3_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14759.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14759.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14759.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14759.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_3 -->
<g id="edge1451" class="edge">
<title>residual_3&#45;&gt;ln2_3_3</title>
<path fill="none" stroke="black" d="M16026.04,-1138.39C15786.68,-1135.54 15314.12,-1122.42 14917.57,-1065.5 14902.71,-1063.37 14887.19,-1060.54 14871.92,-1057.4"/>
<polygon fill="black" stroke="black" points="14872.45,-1053.93 14861.94,-1055.29 14871,-1060.78 14872.45,-1053.93"/>
</g>
<!-- ln2_3_4 -->
<g id="node1205" class="node">
<title>ln2_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="15075.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15075.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15075.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15075.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_4 -->
<g id="edge1452" class="edge">
<title>residual_3&#45;&gt;ln2_3_4</title>
<path fill="none" stroke="black" d="M16027.66,-1134.14C15839.43,-1126.58 15511.57,-1108.14 15233.57,-1065.5 15218.96,-1063.26 15203.7,-1060.4 15188.67,-1057.28"/>
<polygon fill="black" stroke="black" points="15189.34,-1053.84 15178.83,-1055.19 15187.89,-1060.69 15189.34,-1053.84"/>
</g>
<!-- ln2_3_5 -->
<g id="node1206" class="node">
<title>ln2_3_5</title>
<ellipse fill="lightgreen" stroke="black" cx="15391.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15391.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15391.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15391.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_5 -->
<g id="edge1453" class="edge">
<title>residual_3&#45;&gt;ln2_3_5</title>
<path fill="none" stroke="black" d="M16035.95,-1126.7C15907.43,-1114.75 15715.29,-1094.18 15549.57,-1065.5 15535.49,-1063.06 15520.77,-1060.15 15506.23,-1057.06"/>
<polygon fill="black" stroke="black" points="15506.72,-1053.58 15496.2,-1054.89 15505.24,-1060.43 15506.72,-1053.58"/>
</g>
<!-- ln2_3_6 -->
<g id="node1207" class="node">
<title>ln2_3_6</title>
<ellipse fill="lightgreen" stroke="black" cx="15707.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15707.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15707.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15707.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_6 -->
<g id="edge1454" class="edge">
<title>residual_3&#45;&gt;ln2_3_6</title>
<path fill="none" stroke="black" d="M16071.34,-1113.42C15997.65,-1096.32 15900.79,-1073.84 15825.55,-1056.38"/>
<polygon fill="black" stroke="black" points="15826.09,-1052.91 15815.55,-1054.06 15824.5,-1059.73 15826.09,-1052.91"/>
</g>
<!-- ln2_3_7 -->
<g id="node1208" class="node">
<title>ln2_3_7</title>
<ellipse fill="lightgreen" stroke="black" cx="16023.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16023.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16023.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16023.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_7 -->
<g id="edge1455" class="edge">
<title>residual_3&#45;&gt;ln2_3_7</title>
<path fill="none" stroke="black" d="M16131.58,-1104.19C16115.64,-1093.1 16097.88,-1080.73 16081.43,-1069.28"/>
<polygon fill="black" stroke="black" points="16083.18,-1066.23 16072.97,-1063.39 16079.18,-1071.98 16083.18,-1066.23"/>
</g>
<!-- ln2_3_8 -->
<g id="node1209" class="node">
<title>ln2_3_8</title>
<ellipse fill="lightgreen" stroke="black" cx="16339.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16339.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16339.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16339.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_8 -->
<g id="edge1456" class="edge">
<title>residual_3&#45;&gt;ln2_3_8</title>
<path fill="none" stroke="black" d="M16231.57,-1104.19C16247.5,-1093.1 16265.27,-1080.73 16281.71,-1069.28"/>
<polygon fill="black" stroke="black" points="16283.97,-1071.98 16290.18,-1063.39 16279.97,-1066.23 16283.97,-1071.98"/>
</g>
<!-- ln2_3_9 -->
<g id="node1210" class="node">
<title>ln2_3_9</title>
<ellipse fill="lightgreen" stroke="black" cx="16655.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16655.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16655.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16655.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_9 -->
<g id="edge1457" class="edge">
<title>residual_3&#45;&gt;ln2_3_9</title>
<path fill="none" stroke="black" d="M16291.81,-1113.42C16365.5,-1096.32 16462.35,-1073.84 16537.59,-1056.38"/>
<polygon fill="black" stroke="black" points="16538.64,-1059.73 16547.59,-1054.06 16537.06,-1052.91 16538.64,-1059.73"/>
</g>
<!-- ln2_3_10 -->
<g id="node1211" class="node">
<title>ln2_3_10</title>
<ellipse fill="lightgreen" stroke="black" cx="16971.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16971.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16971.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16971.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_10 -->
<g id="edge1458" class="edge">
<title>residual_3&#45;&gt;ln2_3_10</title>
<path fill="none" stroke="black" d="M16327.19,-1126.7C16455.72,-1114.75 16647.86,-1094.18 16813.57,-1065.5 16827.66,-1063.06 16842.38,-1060.15 16856.92,-1057.06"/>
<polygon fill="black" stroke="black" points="16857.91,-1060.43 16866.94,-1054.89 16856.43,-1053.58 16857.91,-1060.43"/>
</g>
<!-- ln2_3_11 -->
<g id="node1212" class="node">
<title>ln2_3_11</title>
<ellipse fill="lightgreen" stroke="black" cx="17287.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17287.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17287.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17287.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_11 -->
<g id="edge1459" class="edge">
<title>residual_3&#45;&gt;ln2_3_11</title>
<path fill="none" stroke="black" d="M16335.49,-1134.14C16523.71,-1126.58 16851.57,-1108.14 17129.57,-1065.5 17144.18,-1063.26 17159.45,-1060.4 17174.48,-1057.28"/>
<polygon fill="black" stroke="black" points="17175.26,-1060.69 17184.31,-1055.19 17173.81,-1053.84 17175.26,-1060.69"/>
</g>
<!-- ln2_3_12 -->
<g id="node1213" class="node">
<title>ln2_3_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17603.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17603.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17603.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17603.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_12 -->
<g id="edge1460" class="edge">
<title>residual_3&#45;&gt;ln2_3_12</title>
<path fill="none" stroke="black" d="M16337.11,-1138.39C16576.47,-1135.54 17049.02,-1122.42 17445.57,-1065.5 17460.43,-1063.37 17475.96,-1060.54 17491.22,-1057.4"/>
<polygon fill="black" stroke="black" points="17492.15,-1060.78 17501.21,-1055.29 17490.7,-1053.93 17492.15,-1060.78"/>
</g>
<!-- ln2_3_13 -->
<g id="node1214" class="node">
<title>ln2_3_13</title>
<ellipse fill="lightgreen" stroke="black" cx="17919.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17919.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17919.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17919.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_13 -->
<g id="edge1461" class="edge">
<title>residual_3&#45;&gt;ln2_3_13</title>
<path fill="none" stroke="black" d="M16335.94,-1135.37C16677.69,-1126.75 17489.45,-1102.95 17761.57,-1065.5 17776.56,-1063.44 17792.21,-1060.63 17807.6,-1057.49"/>
<polygon fill="black" stroke="black" points="17808.59,-1060.86 17817.66,-1055.38 17807.15,-1054.01 17808.59,-1060.86"/>
</g>
<!-- ln2_3_14 -->
<g id="node1215" class="node">
<title>ln2_3_14</title>
<ellipse fill="lightgreen" stroke="black" cx="18235.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18235.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18235.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18235.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_14 -->
<g id="edge1462" class="edge">
<title>residual_3&#45;&gt;ln2_3_14</title>
<path fill="none" stroke="black" d="M16336.78,-1136.75C16727.18,-1130.48 17742.7,-1110.26 18077.57,-1065.5 18092.57,-1063.5 18108.23,-1060.72 18123.61,-1057.6"/>
<polygon fill="black" stroke="black" points="18124.6,-1060.97 18133.67,-1055.5 18123.17,-1054.11 18124.6,-1060.97"/>
</g>
<!-- ln2_3_15 -->
<g id="node1216" class="node">
<title>ln2_3_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18551.57" cy="-1028" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18551.57" y="-1039.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18551.57" y="-1024.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18551.57" y="-1009.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_15 -->
<g id="edge1463" class="edge">
<title>residual_3&#45;&gt;ln2_3_15</title>
<path fill="none" stroke="black" d="M16335.59,-1134.46C16636.26,-1125.52 17322.5,-1104.75 17899.57,-1084.5 18119.16,-1076.79 18175.79,-1094.58 18393.57,-1065.5 18408.57,-1063.5 18424.23,-1060.73 18439.61,-1057.6"/>
<polygon fill="black" stroke="black" points="18440.6,-1060.97 18449.67,-1055.5 18439.17,-1054.12 18440.6,-1060.97"/>
</g>
<!-- mlp_fc1_3_0 -->
<g id="node1217" class="node">
<title>mlp_fc1_3_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13839.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13839.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="13839.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13839.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13839.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_0&#45;&gt;mlp_fc1_3_0 -->
<g id="edge1464" class="edge">
<title>ln2_3_0&#45;&gt;mlp_fc1_3_0</title>
<path fill="none" stroke="black" d="M13820.05,-990.49C13822.04,-981.94 13824.2,-972.63 13826.34,-963.42"/>
<polygon fill="black" stroke="black" points="13829.79,-964.04 13828.64,-953.51 13822.97,-962.46 13829.79,-964.04"/>
</g>
<!-- mlp_fc1_3_1 -->
<g id="node1218" class="node">
<title>mlp_fc1_3_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14145.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14145.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14145.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14145.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14145.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_1&#45;&gt;mlp_fc1_3_1 -->
<g id="edge1465" class="edge">
<title>ln2_3_1&#45;&gt;mlp_fc1_3_1</title>
<path fill="none" stroke="black" d="M14133.02,-990.49C14134.3,-981.94 14135.69,-972.63 14137.06,-963.42"/>
<polygon fill="black" stroke="black" points="14140.53,-963.91 14138.54,-953.51 14133.61,-962.88 14140.53,-963.91"/>
</g>
<!-- mlp_fc1_3_2 -->
<g id="node1219" class="node">
<title>mlp_fc1_3_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14447.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14447.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14447.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14447.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14447.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_2&#45;&gt;mlp_fc1_3_2 -->
<g id="edge1466" class="edge">
<title>ln2_3_2&#45;&gt;mlp_fc1_3_2</title>
<path fill="none" stroke="black" d="M14444.78,-990.49C14445.07,-982.03 14445.37,-972.83 14445.67,-963.71"/>
<polygon fill="black" stroke="black" points="14449.18,-963.62 14446.01,-953.51 14442.18,-963.38 14449.18,-963.62"/>
</g>
<!-- mlp_fc1_3_3 -->
<g id="node1220" class="node">
<title>mlp_fc1_3_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14824.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14824.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="14824.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14824.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14824.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_3&#45;&gt;mlp_fc1_3_3 -->
<g id="edge1467" class="edge">
<title>ln2_3_3&#45;&gt;mlp_fc1_3_3</title>
<path fill="none" stroke="black" d="M14779.08,-990.82C14784,-981.69 14789.4,-971.67 14794.71,-961.82"/>
<polygon fill="black" stroke="black" points="14797.87,-963.32 14799.54,-952.86 14791.71,-960 14797.87,-963.32"/>
</g>
<!-- mlp_fc1_3_4 -->
<g id="node1221" class="node">
<title>mlp_fc1_3_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15131.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15131.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15131.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15131.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15131.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_4&#45;&gt;mlp_fc1_3_4 -->
<g id="edge1468" class="edge">
<title>ln2_3_4&#45;&gt;mlp_fc1_3_4</title>
<path fill="none" stroke="black" d="M15092.53,-990.49C15096.67,-981.56 15101.21,-971.8 15105.67,-962.2"/>
<polygon fill="black" stroke="black" points="15108.87,-963.61 15109.91,-953.07 15102.52,-960.66 15108.87,-963.61"/>
</g>
<!-- mlp_fc1_3_5 -->
<g id="node1222" class="node">
<title>mlp_fc1_3_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15433.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15433.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15433.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15433.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15433.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_5&#45;&gt;mlp_fc1_3_5 -->
<g id="edge1469" class="edge">
<title>ln2_3_5&#45;&gt;mlp_fc1_3_5</title>
<path fill="none" stroke="black" d="M15404.29,-990.49C15407.3,-981.85 15410.58,-972.43 15413.82,-963.13"/>
<polygon fill="black" stroke="black" points="15417.19,-964.1 15417.17,-953.51 15410.58,-961.8 15417.19,-964.1"/>
</g>
<!-- mlp_fc1_3_6 -->
<g id="node1223" class="node">
<title>mlp_fc1_3_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15732.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15732.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="15732.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15732.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15732.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_6&#45;&gt;mlp_fc1_3_6 -->
<g id="edge1470" class="edge">
<title>ln2_3_6&#45;&gt;mlp_fc1_3_6</title>
<path fill="none" stroke="black" d="M15715.14,-990.49C15716.92,-981.94 15718.85,-972.63 15720.76,-963.42"/>
<polygon fill="black" stroke="black" points="15724.21,-964.01 15722.81,-953.51 15717.35,-962.59 15724.21,-964.01"/>
</g>
<!-- mlp_fc1_3_7 -->
<g id="node1224" class="node">
<title>mlp_fc1_3_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16030.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16030.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16030.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16030.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16030.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_7&#45;&gt;mlp_fc1_3_7 -->
<g id="edge1471" class="edge">
<title>ln2_3_7&#45;&gt;mlp_fc1_3_7</title>
<path fill="none" stroke="black" d="M16025.69,-990.49C16026.18,-982.03 16026.72,-972.83 16027.25,-963.71"/>
<polygon fill="black" stroke="black" points="16030.75,-963.69 16027.84,-953.51 16023.77,-963.29 16030.75,-963.69"/>
</g>
<!-- mlp_fc1_3_8 -->
<g id="node1225" class="node">
<title>mlp_fc1_3_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16336.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16336.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16336.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16336.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16336.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_8&#45;&gt;mlp_fc1_3_8 -->
<g id="edge1472" class="edge">
<title>ln2_3_8&#45;&gt;mlp_fc1_3_8</title>
<path fill="none" stroke="black" d="M16338.67,-990.49C16338.45,-982.03 16338.23,-972.83 16338,-963.71"/>
<polygon fill="black" stroke="black" points="16341.49,-963.42 16337.75,-953.51 16334.49,-963.59 16341.49,-963.42"/>
</g>
<!-- mlp_fc1_3_9 -->
<g id="node1226" class="node">
<title>mlp_fc1_3_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16643.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16643.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16643.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16643.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16643.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_9&#45;&gt;mlp_fc1_3_9 -->
<g id="edge1473" class="edge">
<title>ln2_3_9&#45;&gt;mlp_fc1_3_9</title>
<path fill="none" stroke="black" d="M16651.94,-990.49C16651.1,-982.03 16650.18,-972.83 16649.28,-963.71"/>
<polygon fill="black" stroke="black" points="16652.73,-963.11 16648.26,-953.51 16645.77,-963.8 16652.73,-963.11"/>
</g>
<!-- mlp_fc1_3_10 -->
<g id="node1227" class="node">
<title>mlp_fc1_3_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16941.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16941.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="16941.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16941.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16941.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_10&#45;&gt;mlp_fc1_3_10 -->
<g id="edge1474" class="edge">
<title>ln2_3_10&#45;&gt;mlp_fc1_3_10</title>
<path fill="none" stroke="black" d="M16962.49,-990.49C16960.36,-981.94 16958.05,-972.63 16955.76,-963.42"/>
<polygon fill="black" stroke="black" points="16959.1,-962.37 16953.29,-953.51 16952.31,-964.06 16959.1,-962.37"/>
</g>
<!-- mlp_fc1_3_11 -->
<g id="node1228" class="node">
<title>mlp_fc1_3_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17266.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17266.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17266.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17266.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17266.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_11&#45;&gt;mlp_fc1_3_11 -->
<g id="edge1475" class="edge">
<title>ln2_3_11&#45;&gt;mlp_fc1_3_11</title>
<path fill="none" stroke="black" d="M17281.22,-990.49C17279.73,-981.94 17278.1,-972.63 17276.5,-963.42"/>
<polygon fill="black" stroke="black" points="17279.94,-962.76 17274.77,-953.51 17273.04,-963.96 17279.94,-962.76"/>
</g>
<!-- mlp_fc1_3_12 -->
<g id="node1229" class="node">
<title>mlp_fc1_3_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17587.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17587.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17587.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17587.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17587.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_12&#45;&gt;mlp_fc1_3_12 -->
<g id="edge1476" class="edge">
<title>ln2_3_12&#45;&gt;mlp_fc1_3_12</title>
<path fill="none" stroke="black" d="M17598.73,-990.49C17597.61,-982.03 17596.39,-972.83 17595.18,-963.71"/>
<polygon fill="black" stroke="black" points="17598.61,-962.96 17593.82,-953.51 17591.67,-963.88 17598.61,-962.96"/>
</g>
<!-- mlp_fc1_3_13 -->
<g id="node1230" class="node">
<title>mlp_fc1_3_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17884.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="17884.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="17884.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17884.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17884.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_13&#45;&gt;mlp_fc1_3_13 -->
<g id="edge1477" class="edge">
<title>ln2_3_13&#45;&gt;mlp_fc1_3_13</title>
<path fill="none" stroke="black" d="M17908.98,-990.49C17906.47,-981.85 17903.73,-972.43 17901.03,-963.13"/>
<polygon fill="black" stroke="black" points="17904.39,-962.13 17898.24,-953.51 17897.67,-964.09 17904.39,-962.13"/>
</g>
<!-- mlp_fc1_3_14 -->
<g id="node1231" class="node">
<title>mlp_fc1_3_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18181.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18181.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18181.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18181.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18181.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_14&#45;&gt;mlp_fc1_3_14 -->
<g id="edge1478" class="edge">
<title>ln2_3_14&#45;&gt;mlp_fc1_3_14</title>
<path fill="none" stroke="black" d="M18219.23,-990.49C18215.23,-981.56 18210.86,-971.8 18206.55,-962.2"/>
<polygon fill="black" stroke="black" points="18209.75,-960.76 18202.47,-953.07 18203.36,-963.63 18209.75,-960.76"/>
</g>
<!-- mlp_fc1_3_15 -->
<g id="node1232" class="node">
<title>mlp_fc1_3_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18478.57" cy="-905.42" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="18478.57" y="-924.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="18478.57" y="-909.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18478.57" y="-894.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18478.57" y="-879.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- ln2_3_15&#45;&gt;mlp_fc1_3_15 -->
<g id="edge1479" class="edge">
<title>ln2_3_15&#45;&gt;mlp_fc1_3_15</title>
<path fill="none" stroke="black" d="M18529.67,-990.82C18524.08,-981.59 18517.95,-971.46 18511.93,-961.52"/>
<polygon fill="black" stroke="black" points="18514.86,-959.6 18506.69,-952.86 18508.87,-963.23 18514.86,-959.6"/>
</g>
<!-- mlp_gelu_3_0 -->
<g id="node1233" class="node">
<title>mlp_gelu_3_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13898.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="13898.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13898.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13898.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_0&#45;&gt;mlp_gelu_3_0 -->
<g id="edge1480" class="edge">
<title>mlp_fc1_3_0&#45;&gt;mlp_gelu_3_0</title>
<path fill="none" stroke="black" d="M13862.38,-857.8C13866.96,-848.45 13871.76,-838.64 13876.31,-829.34"/>
<polygon fill="black" stroke="black" points="13879.51,-830.76 13880.76,-820.23 13873.22,-827.68 13879.51,-830.76"/>
</g>
<!-- mlp_gelu_3_1 -->
<g id="node1234" class="node">
<title>mlp_gelu_3_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14219.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14219.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14219.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14219.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_1&#45;&gt;mlp_gelu_3_1 -->
<g id="edge1481" class="edge">
<title>mlp_fc1_3_1&#45;&gt;mlp_gelu_3_1</title>
<path fill="none" stroke="black" d="M14173.97,-858.14C14179.9,-848.48 14186.14,-838.31 14192.04,-828.7"/>
<polygon fill="black" stroke="black" points="14195.09,-830.42 14197.34,-820.06 14189.13,-826.76 14195.09,-830.42"/>
</g>
<!-- mlp_gelu_3_2 -->
<g id="node1235" class="node">
<title>mlp_gelu_3_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14528.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14528.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14528.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14528.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_2&#45;&gt;mlp_gelu_3_2 -->
<g id="edge1482" class="edge">
<title>mlp_fc1_3_2&#45;&gt;mlp_gelu_3_2</title>
<path fill="none" stroke="black" d="M14478.43,-858.48C14485.07,-848.6 14492.07,-838.17 14498.67,-828.34"/>
<polygon fill="black" stroke="black" points="14501.68,-830.14 14504.35,-819.89 14495.87,-826.24 14501.68,-830.14"/>
</g>
<!-- mlp_gelu_3_3 -->
<g id="node1236" class="node">
<title>mlp_gelu_3_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14831.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="14831.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14831.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14831.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_3&#45;&gt;mlp_gelu_3_3 -->
<g id="edge1483" class="edge">
<title>mlp_fc1_3_3&#45;&gt;mlp_gelu_3_3</title>
<path fill="none" stroke="black" d="M14827.32,-857.1C14827.83,-848.38 14828.36,-839.27 14828.86,-830.56"/>
<polygon fill="black" stroke="black" points="14832.36,-830.76 14829.44,-820.57 14825.37,-830.35 14832.36,-830.76"/>
</g>
<!-- mlp_gelu_3_4 -->
<g id="node1237" class="node">
<title>mlp_gelu_3_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15137.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15137.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15137.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15137.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_4&#45;&gt;mlp_gelu_3_4 -->
<g id="edge1484" class="edge">
<title>mlp_fc1_3_4&#45;&gt;mlp_gelu_3_4</title>
<path fill="none" stroke="black" d="M15133.93,-857.1C15134.36,-848.38 15134.81,-839.27 15135.25,-830.56"/>
<polygon fill="black" stroke="black" points="15138.74,-830.73 15135.75,-820.57 15131.75,-830.38 15138.74,-830.73"/>
</g>
<!-- mlp_gelu_3_5 -->
<g id="node1238" class="node">
<title>mlp_gelu_3_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15434.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15434.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15434.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15434.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_5&#45;&gt;mlp_gelu_3_5 -->
<g id="edge1485" class="edge">
<title>mlp_fc1_3_5&#45;&gt;mlp_gelu_3_5</title>
<path fill="none" stroke="black" d="M15433.97,-857.1C15434.04,-848.47 15434.11,-839.47 15434.18,-830.85"/>
<polygon fill="black" stroke="black" points="15437.69,-830.6 15434.27,-820.57 15430.69,-830.54 15437.69,-830.6"/>
</g>
<!-- mlp_gelu_3_6 -->
<g id="node1239" class="node">
<title>mlp_gelu_3_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15735.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="15735.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15735.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15735.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_6&#45;&gt;mlp_gelu_3_6 -->
<g id="edge1486" class="edge">
<title>mlp_fc1_3_6&#45;&gt;mlp_gelu_3_6</title>
<path fill="none" stroke="black" d="M15733.75,-857.1C15733.97,-848.47 15734.19,-839.47 15734.4,-830.85"/>
<polygon fill="black" stroke="black" points="15737.91,-830.65 15734.66,-820.57 15730.91,-830.48 15737.91,-830.65"/>
</g>
<!-- mlp_gelu_3_7 -->
<g id="node1240" class="node">
<title>mlp_gelu_3_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16032.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16032.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16032.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16032.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_7&#45;&gt;mlp_gelu_3_7 -->
<g id="edge1487" class="edge">
<title>mlp_fc1_3_7&#45;&gt;mlp_gelu_3_7</title>
<path fill="none" stroke="black" d="M16031.36,-857.1C16031.5,-848.47 16031.65,-839.47 16031.79,-830.85"/>
<polygon fill="black" stroke="black" points="16035.3,-830.63 16031.96,-820.57 16028.3,-830.51 16035.3,-830.63"/>
</g>
<!-- mlp_gelu_3_8 -->
<g id="node1241" class="node">
<title>mlp_gelu_3_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16331.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16331.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16331.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16331.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_8&#45;&gt;mlp_gelu_3_8 -->
<g id="edge1488" class="edge">
<title>mlp_fc1_3_8&#45;&gt;mlp_gelu_3_8</title>
<path fill="none" stroke="black" d="M16334.61,-857.1C16334.25,-848.38 16333.87,-839.27 16333.51,-830.56"/>
<polygon fill="black" stroke="black" points="16337.01,-830.42 16333.1,-820.57 16330.01,-830.71 16337.01,-830.42"/>
</g>
<!-- mlp_gelu_3_9 -->
<g id="node1242" class="node">
<title>mlp_gelu_3_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16628.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16628.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16628.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16628.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_9&#45;&gt;mlp_gelu_3_9 -->
<g id="edge1489" class="edge">
<title>mlp_fc1_3_9&#45;&gt;mlp_gelu_3_9</title>
<path fill="none" stroke="black" d="M16637.69,-857.1C16636.6,-848.38 16635.47,-839.27 16634.39,-830.56"/>
<polygon fill="black" stroke="black" points="16637.85,-830.06 16633.14,-820.57 16630.9,-830.93 16637.85,-830.06"/>
</g>
<!-- mlp_gelu_3_10 -->
<g id="node1243" class="node">
<title>mlp_gelu_3_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16925.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="16925.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16925.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16925.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_10&#45;&gt;mlp_gelu_3_10 -->
<g id="edge1490" class="edge">
<title>mlp_fc1_3_10&#45;&gt;mlp_gelu_3_10</title>
<path fill="none" stroke="black" d="M16935.3,-857.1C16934.14,-848.38 16932.93,-839.27 16931.77,-830.56"/>
<polygon fill="black" stroke="black" points="16935.23,-830.02 16930.45,-820.57 16928.29,-830.94 16935.23,-830.02"/>
</g>
<!-- mlp_gelu_3_11 -->
<g id="node1244" class="node">
<title>mlp_gelu_3_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17222.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17222.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17222.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17222.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_11&#45;&gt;mlp_gelu_3_11 -->
<g id="edge1491" class="edge">
<title>mlp_fc1_3_11&#45;&gt;mlp_gelu_3_11</title>
<path fill="none" stroke="black" d="M17249.44,-857.45C17246.14,-848.42 17242.69,-838.96 17239.4,-829.96"/>
<polygon fill="black" stroke="black" points="17242.63,-828.6 17235.92,-820.4 17236.06,-831 17242.63,-828.6"/>
</g>
<!-- mlp_gelu_3_12 -->
<g id="node1245" class="node">
<title>mlp_gelu_3_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17568.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17568.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17568.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17568.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_12&#45;&gt;mlp_gelu_3_12 -->
<g id="edge1492" class="edge">
<title>mlp_fc1_3_12&#45;&gt;mlp_gelu_3_12</title>
<path fill="none" stroke="black" d="M17580.12,-857.1C17578.74,-848.38 17577.31,-839.27 17575.94,-830.56"/>
<polygon fill="black" stroke="black" points="17579.38,-829.9 17574.36,-820.57 17572.46,-830.99 17579.38,-829.9"/>
</g>
<!-- mlp_gelu_3_13 -->
<g id="node1246" class="node">
<title>mlp_gelu_3_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17865.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="17865.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17865.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17865.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_13&#45;&gt;mlp_gelu_3_13 -->
<g id="edge1493" class="edge">
<title>mlp_fc1_3_13&#45;&gt;mlp_gelu_3_13</title>
<path fill="none" stroke="black" d="M17877.12,-857.1C17875.74,-848.38 17874.31,-839.27 17872.94,-830.56"/>
<polygon fill="black" stroke="black" points="17876.38,-829.9 17871.36,-820.57 17869.46,-830.99 17876.38,-829.9"/>
</g>
<!-- mlp_gelu_3_14 -->
<g id="node1247" class="node">
<title>mlp_gelu_3_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18162.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18162.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18162.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18162.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_14&#45;&gt;mlp_gelu_3_14 -->
<g id="edge1494" class="edge">
<title>mlp_fc1_3_14&#45;&gt;mlp_gelu_3_14</title>
<path fill="none" stroke="black" d="M18174.12,-857.1C18172.74,-848.38 18171.31,-839.27 18169.94,-830.56"/>
<polygon fill="black" stroke="black" points="18173.38,-829.9 18168.36,-820.57 18166.46,-830.99 18173.38,-829.9"/>
</g>
<!-- mlp_gelu_3_15 -->
<g id="node1248" class="node">
<title>mlp_gelu_3_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18459.57" cy="-782.83" rx="139.5" ry="37.5"/>
<text text-anchor="middle" x="18459.57" y="-794.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18459.57" y="-779.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18459.57" y="-764.13" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- mlp_fc1_3_15&#45;&gt;mlp_gelu_3_15 -->
<g id="edge1495" class="edge">
<title>mlp_fc1_3_15&#45;&gt;mlp_gelu_3_15</title>
<path fill="none" stroke="black" d="M18471.12,-857.1C18469.74,-848.38 18468.31,-839.27 18466.94,-830.56"/>
<polygon fill="black" stroke="black" points="18470.38,-829.9 18465.36,-820.57 18463.46,-830.99 18470.38,-829.9"/>
</g>
<!-- mlp_fc2_3_0 -->
<g id="node1249" class="node">
<title>mlp_fc2_3_0</title>
<ellipse fill="lightcoral" stroke="black" cx="13966.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="13966.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="13966.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13966.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13966.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_0&#45;&gt;mlp_fc2_3_0 -->
<g id="edge1496" class="edge">
<title>mlp_gelu_3_0&#45;&gt;mlp_fc2_3_0</title>
<path fill="none" stroke="black" d="M13918.98,-745.65C13924.13,-736.52 13929.78,-726.5 13935.33,-716.65"/>
<polygon fill="black" stroke="black" points="13938.52,-718.12 13940.38,-707.69 13932.42,-714.68 13938.52,-718.12"/>
</g>
<!-- mlp_fc2_3_1 -->
<g id="node1250" class="node">
<title>mlp_fc2_3_1</title>
<ellipse fill="lightcoral" stroke="black" cx="14256.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14256.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14256.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14256.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14256.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_1&#45;&gt;mlp_fc2_3_1 -->
<g id="edge1497" class="edge">
<title>mlp_gelu_3_1&#45;&gt;mlp_fc2_3_1</title>
<path fill="none" stroke="black" d="M14230.78,-745.33C14233.43,-736.68 14236.32,-727.26 14239.17,-717.96"/>
<polygon fill="black" stroke="black" points="14242.54,-718.93 14242.12,-708.34 14235.84,-716.87 14242.54,-718.93"/>
</g>
<!-- mlp_fc2_3_2 -->
<g id="node1251" class="node">
<title>mlp_fc2_3_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14543.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14543.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14543.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14543.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14543.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_2&#45;&gt;mlp_fc2_3_2 -->
<g id="edge1498" class="edge">
<title>mlp_gelu_3_2&#45;&gt;mlp_fc2_3_2</title>
<path fill="none" stroke="black" d="M14533.11,-745.33C14534.17,-736.87 14535.31,-727.66 14536.45,-718.55"/>
<polygon fill="black" stroke="black" points="14539.95,-718.7 14537.72,-708.34 14533.01,-717.83 14539.95,-718.7"/>
</g>
<!-- mlp_fc2_3_3 -->
<g id="node1252" class="node">
<title>mlp_fc2_3_3</title>
<ellipse fill="lightcoral" stroke="black" cx="14851.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="14851.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="14851.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14851.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14851.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_3&#45;&gt;mlp_fc2_3_3 -->
<g id="edge1499" class="edge">
<title>mlp_gelu_3_3&#45;&gt;mlp_fc2_3_3</title>
<path fill="none" stroke="black" d="M14837.63,-745.33C14839.05,-736.77 14840.59,-727.46 14842.12,-718.25"/>
<polygon fill="black" stroke="black" points="14845.58,-718.78 14843.76,-708.34 14838.67,-717.63 14845.58,-718.78"/>
</g>
<!-- mlp_fc2_3_4 -->
<g id="node1253" class="node">
<title>mlp_fc2_3_4</title>
<ellipse fill="lightcoral" stroke="black" cx="15149.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15149.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15149.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15149.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15149.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_4&#45;&gt;mlp_fc2_3_4 -->
<g id="edge1500" class="edge">
<title>mlp_gelu_3_4&#45;&gt;mlp_fc2_3_4</title>
<path fill="none" stroke="black" d="M15141.21,-745.33C15142.05,-736.87 15142.96,-727.66 15143.87,-718.55"/>
<polygon fill="black" stroke="black" points="15147.38,-718.64 15144.89,-708.34 15140.41,-717.94 15147.38,-718.64"/>
</g>
<!-- mlp_fc2_3_5 -->
<g id="node1254" class="node">
<title>mlp_fc2_3_5</title>
<ellipse fill="lightcoral" stroke="black" cx="15448.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15448.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15448.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15448.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15448.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_5&#45;&gt;mlp_fc2_3_5 -->
<g id="edge1501" class="edge">
<title>mlp_gelu_3_5&#45;&gt;mlp_fc2_3_5</title>
<path fill="none" stroke="black" d="M15438.81,-745.33C15439.79,-736.87 15440.86,-727.66 15441.92,-718.55"/>
<polygon fill="black" stroke="black" points="15445.43,-718.68 15443.11,-708.34 15438.48,-717.87 15445.43,-718.68"/>
</g>
<!-- mlp_fc2_3_6 -->
<g id="node1255" class="node">
<title>mlp_fc2_3_6</title>
<ellipse fill="lightcoral" stroke="black" cx="15746.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="15746.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="15746.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15746.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15746.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_6&#45;&gt;mlp_fc2_3_6 -->
<g id="edge1502" class="edge">
<title>mlp_gelu_3_6&#45;&gt;mlp_fc2_3_6</title>
<path fill="none" stroke="black" d="M15738.9,-745.33C15739.68,-736.87 15740.52,-727.66 15741.35,-718.55"/>
<polygon fill="black" stroke="black" points="15744.85,-718.62 15742.28,-708.34 15737.88,-717.98 15744.85,-718.62"/>
</g>
<!-- mlp_fc2_3_7 -->
<g id="node1256" class="node">
<title>mlp_fc2_3_7</title>
<ellipse fill="lightcoral" stroke="black" cx="16039.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16039.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16039.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="16039.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16039.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_7&#45;&gt;mlp_fc2_3_7 -->
<g id="edge1503" class="edge">
<title>mlp_gelu_3_7&#45;&gt;mlp_fc2_3_7</title>
<path fill="none" stroke="black" d="M16034.69,-745.33C16035.18,-736.87 16035.72,-727.66 16036.25,-718.55"/>
<polygon fill="black" stroke="black" points="16039.75,-718.53 16036.84,-708.34 16032.77,-718.12 16039.75,-718.53"/>
</g>
<!-- mlp_fc2_3_8 -->
<g id="node1257" class="node">
<title>mlp_fc2_3_8</title>
<ellipse fill="lightcoral" stroke="black" cx="16329.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16329.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16329.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16329.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16329.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_8&#45;&gt;mlp_fc2_3_8 -->
<g id="edge1504" class="edge">
<title>mlp_gelu_3_8&#45;&gt;mlp_fc2_3_8</title>
<path fill="none" stroke="black" d="M16330.97,-745.33C16330.83,-736.87 16330.67,-727.66 16330.52,-718.55"/>
<polygon fill="black" stroke="black" points="16334.02,-718.28 16330.35,-708.34 16327.02,-718.4 16334.02,-718.28"/>
</g>
<!-- mlp_fc2_3_9 -->
<g id="node1258" class="node">
<title>mlp_fc2_3_9</title>
<ellipse fill="lightcoral" stroke="black" cx="16623.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16623.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16623.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16623.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16623.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_9&#45;&gt;mlp_fc2_3_9 -->
<g id="edge1505" class="edge">
<title>mlp_gelu_3_9&#45;&gt;mlp_fc2_3_9</title>
<path fill="none" stroke="black" d="M16627.06,-745.33C16626.71,-736.87 16626.33,-727.66 16625.95,-718.55"/>
<polygon fill="black" stroke="black" points="16629.44,-718.19 16625.53,-708.34 16622.44,-718.48 16629.44,-718.19"/>
</g>
<!-- mlp_fc2_3_10 -->
<g id="node1259" class="node">
<title>mlp_fc2_3_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16918.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="16918.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="16918.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16918.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16918.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_10&#45;&gt;mlp_fc2_3_10 -->
<g id="edge1506" class="edge">
<title>mlp_gelu_3_10&#45;&gt;mlp_fc2_3_10</title>
<path fill="none" stroke="black" d="M16923.45,-745.33C16922.96,-736.87 16922.43,-727.66 16921.9,-718.55"/>
<polygon fill="black" stroke="black" points="16925.38,-718.12 16921.31,-708.34 16918.39,-718.53 16925.38,-718.12"/>
</g>
<!-- mlp_fc2_3_11 -->
<g id="node1260" class="node">
<title>mlp_fc2_3_11</title>
<ellipse fill="lightcoral" stroke="black" cx="17214.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17214.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17214.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17214.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17214.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_11&#45;&gt;mlp_fc2_3_11 -->
<g id="edge1507" class="edge">
<title>mlp_gelu_3_11&#45;&gt;mlp_fc2_3_11</title>
<path fill="none" stroke="black" d="M17220.15,-745.33C17219.59,-736.87 17218.98,-727.66 17218.37,-718.55"/>
<polygon fill="black" stroke="black" points="17221.85,-718.09 17217.7,-708.34 17214.87,-718.55 17221.85,-718.09"/>
</g>
<!-- mlp_fc2_3_12 -->
<g id="node1261" class="node">
<title>mlp_fc2_3_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17511.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17511.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17511.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17511.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17511.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_12&#45;&gt;mlp_fc2_3_12 -->
<g id="edge1508" class="edge">
<title>mlp_gelu_3_12&#45;&gt;mlp_fc2_3_12</title>
<path fill="none" stroke="black" d="M17551.32,-745.33C17547.1,-736.4 17542.48,-726.64 17537.94,-717.03"/>
<polygon fill="black" stroke="black" points="17541.06,-715.45 17533.63,-707.9 17534.74,-718.44 17541.06,-715.45"/>
</g>
<!-- mlp_fc2_3_13 -->
<g id="node1262" class="node">
<title>mlp_fc2_3_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17808.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="17808.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="17808.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17808.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17808.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_13&#45;&gt;mlp_fc2_3_13 -->
<g id="edge1509" class="edge">
<title>mlp_gelu_3_13&#45;&gt;mlp_fc2_3_13</title>
<path fill="none" stroke="black" d="M17848.32,-745.33C17844.1,-736.4 17839.48,-726.64 17834.94,-717.03"/>
<polygon fill="black" stroke="black" points="17838.06,-715.45 17830.63,-707.9 17831.74,-718.44 17838.06,-715.45"/>
</g>
<!-- mlp_fc2_3_14 -->
<g id="node1263" class="node">
<title>mlp_fc2_3_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18105.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18105.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18105.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18105.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18105.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_14&#45;&gt;mlp_fc2_3_14 -->
<g id="edge1510" class="edge">
<title>mlp_gelu_3_14&#45;&gt;mlp_fc2_3_14</title>
<path fill="none" stroke="black" d="M18145.32,-745.33C18141.1,-736.4 18136.48,-726.64 18131.94,-717.03"/>
<polygon fill="black" stroke="black" points="18135.06,-715.45 18127.63,-707.9 18128.74,-718.44 18135.06,-715.45"/>
</g>
<!-- mlp_fc2_3_15 -->
<g id="node1264" class="node">
<title>mlp_fc2_3_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18402.57" cy="-660.25" rx="133" ry="48.17"/>
<text text-anchor="middle" x="18402.57" y="-679.05" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="18402.57" y="-664.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18402.57" y="-649.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18402.57" y="-634.05" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- mlp_gelu_3_15&#45;&gt;mlp_fc2_3_15 -->
<g id="edge1511" class="edge">
<title>mlp_gelu_3_15&#45;&gt;mlp_fc2_3_15</title>
<path fill="none" stroke="black" d="M18442.32,-745.33C18438.1,-736.4 18433.48,-726.64 18428.94,-717.03"/>
<polygon fill="black" stroke="black" points="18432.06,-715.45 18424.63,-707.9 18425.74,-718.44 18432.06,-715.45"/>
</g>
<!-- allreduce_mlp_3 -->
<g id="node1265" class="node">
<title>allreduce_mlp_3</title>
<polygon fill="red" stroke="black" points="16119.57,-575.17 15994.57,-522.17 16119.57,-469.17 16244.57,-522.17 16119.57,-575.17"/>
<text text-anchor="middle" x="16119.57" y="-533.47" font-family="Times,serif" font-size="14.00">AllReduce MLP</text>
<text text-anchor="middle" x="16119.57" y="-518.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="16119.57" y="-503.47" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- mlp_fc2_3_0&#45;&gt;allreduce_mlp_3 -->
<g id="edge1512" class="edge">
<title>mlp_fc2_3_0&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M14059.19,-625.71C14077.34,-620.3 14096.39,-615.42 14114.57,-612.17 14295.89,-579.75 14344.57,-601.44 14528.57,-593.17 15077.04,-568.52 15731.89,-539.99 15998.1,-528.43"/>
<polygon fill="black" stroke="black" points="15998.34,-531.93 16008.18,-528 15998.04,-524.93 15998.34,-531.93"/>
</g>
<!-- mlp_fc2_3_1&#45;&gt;allreduce_mlp_3 -->
<g id="edge1513" class="edge">
<title>mlp_fc2_3_1&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M14348.46,-625.43C14365.89,-620.15 14384.14,-615.39 14401.57,-612.17 14706.57,-555.76 15647.55,-532.3 15991.76,-525.45"/>
<polygon fill="black" stroke="black" points="15991.84,-528.95 16001.77,-525.25 15991.7,-521.95 15991.84,-528.95"/>
</g>
<!-- mlp_fc2_3_2&#45;&gt;allreduce_mlp_3 -->
<g id="edge1514" class="edge">
<title>mlp_fc2_3_2&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M14641.97,-627.61C14664.01,-621.57 14687.43,-615.96 14709.57,-612.17 14955.29,-570.06 15699.81,-538.71 15996.06,-527.58"/>
<polygon fill="black" stroke="black" points="15996.54,-531.06 16006.41,-527.19 15996.28,-524.07 15996.54,-531.06"/>
</g>
<!-- mlp_fc2_3_3&#45;&gt;allreduce_mlp_3 -->
<g id="edge1515" class="edge">
<title>mlp_fc2_3_3&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M14947.31,-626.86C14967.05,-621.17 14987.84,-615.89 15007.57,-612.17 15358.43,-545.96 15780.64,-528.96 15989.48,-524.62"/>
<polygon fill="black" stroke="black" points="15989.64,-528.12 15999.57,-524.42 15989.5,-521.12 15989.64,-528.12"/>
</g>
<!-- mlp_fc2_3_4&#45;&gt;allreduce_mlp_3 -->
<g id="edge1516" class="edge">
<title>mlp_fc2_3_4&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M15246.44,-627.2C15266.17,-621.52 15286.91,-616.16 15306.57,-612.17 15549.97,-562.78 15840.29,-539.33 15999.79,-529.43"/>
<polygon fill="black" stroke="black" points="16000.34,-532.91 16010.11,-528.8 15999.91,-525.92 16000.34,-532.91"/>
</g>
<!-- mlp_fc2_3_5&#45;&gt;allreduce_mlp_3 -->
<g id="edge1517" class="edge">
<title>mlp_fc2_3_5&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M15546.69,-627.65C15565.78,-622.07 15585.71,-616.62 15604.57,-612.17 15745.93,-578.75 15911.89,-552.32 16016.4,-537.21"/>
<polygon fill="black" stroke="black" points="16016.92,-540.67 16026.32,-535.79 16015.92,-533.75 16016.92,-540.67"/>
</g>
<!-- mlp_fc2_3_6&#45;&gt;allreduce_mlp_3 -->
<g id="edge1518" class="edge">
<title>mlp_fc2_3_6&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M15839.25,-625.44C15902.31,-602.43 15984.7,-572.37 16043.82,-550.8"/>
<polygon fill="black" stroke="black" points="16045.28,-554 16053.47,-547.28 16042.88,-547.42 16045.28,-554"/>
</g>
<!-- mlp_fc2_3_7&#45;&gt;allreduce_mlp_3 -->
<g id="edge1519" class="edge">
<title>mlp_fc2_3_7&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M16066.88,-612.8C16074.31,-600.16 16082.39,-586.42 16089.94,-573.57"/>
<polygon fill="black" stroke="black" points="16093.02,-575.24 16095.07,-564.85 16086.99,-571.69 16093.02,-575.24"/>
</g>
<!-- mlp_fc2_3_8&#45;&gt;allreduce_mlp_3 -->
<g id="edge1520" class="edge">
<title>mlp_fc2_3_8&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M16265.71,-617.87C16237.4,-599.52 16204.35,-578.1 16176.85,-560.28"/>
<polygon fill="black" stroke="black" points="16178.42,-557.13 16168.13,-554.63 16174.62,-563.01 16178.42,-557.13"/>
</g>
<!-- mlp_fc2_3_9&#45;&gt;allreduce_mlp_3 -->
<g id="edge1521" class="edge">
<title>mlp_fc2_3_9&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M16524.86,-627.85C16507.17,-622.45 16488.86,-617.03 16471.57,-612.17 16382.47,-587.12 16279.77,-561.52 16208.39,-544.25"/>
<polygon fill="black" stroke="black" points="16209.07,-540.81 16198.53,-541.87 16207.43,-547.62 16209.07,-540.81"/>
</g>
<!-- mlp_fc2_3_10&#45;&gt;allreduce_mlp_3 -->
<g id="edge1522" class="edge">
<title>mlp_fc2_3_10&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M16822.08,-626.97C16803.47,-621.48 16784.03,-616.25 16765.57,-612.17 16580.59,-571.24 16361.41,-545.79 16231.79,-533.07"/>
<polygon fill="black" stroke="black" points="16231.75,-529.55 16221.45,-532.07 16231.07,-536.52 16231.75,-529.55"/>
</g>
<!-- mlp_fc2_3_11&#45;&gt;allreduce_mlp_3 -->
<g id="edge1523" class="edge">
<title>mlp_fc2_3_11&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M17118.81,-626.7C17099.7,-621.14 17079.63,-615.94 17060.57,-612.17 16771.86,-554.99 16425.79,-534.24 16244.46,-526.95"/>
<polygon fill="black" stroke="black" points="16244.49,-523.45 16234.36,-526.55 16244.21,-530.44 16244.49,-523.45"/>
</g>
<!-- mlp_fc2_3_12&#45;&gt;allreduce_mlp_3 -->
<g id="edge1524" class="edge">
<title>mlp_fc2_3_12&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M17416.07,-626.61C17396.58,-620.98 17376.07,-615.78 17356.57,-612.17 16959.71,-538.57 16480.76,-525.03 16252.75,-523.06"/>
<polygon fill="black" stroke="black" points="16252.78,-519.56 16242.75,-522.98 16252.72,-526.56 16252.78,-519.56"/>
</g>
<!-- mlp_fc2_3_13&#45;&gt;allreduce_mlp_3 -->
<g id="edge1525" class="edge">
<title>mlp_fc2_3_13&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M17713.53,-626.51C17693.91,-620.85 17673.23,-615.67 17653.57,-612.17 17384.11,-564.13 16560.96,-535.92 16244.94,-526.61"/>
<polygon fill="black" stroke="black" points="16244.93,-523.11 16234.83,-526.32 16244.72,-530.11 16244.93,-523.11"/>
</g>
<!-- mlp_fc2_3_14&#45;&gt;allreduce_mlp_3 -->
<g id="edge1526" class="edge">
<title>mlp_fc2_3_14&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M18010.55,-626.37C17990.93,-620.72 17970.25,-615.58 17950.57,-612.17 17622.61,-555.28 16608.14,-531.94 16248.01,-525.3"/>
<polygon fill="black" stroke="black" points="16247.87,-521.8 16237.81,-525.11 16247.74,-528.8 16247.87,-521.8"/>
</g>
<!-- mlp_fc2_3_15&#45;&gt;allreduce_mlp_3 -->
<g id="edge1527" class="edge">
<title>mlp_fc2_3_15&#45;&gt;allreduce_mlp_3</title>
<path fill="none" stroke="black" d="M18307.98,-626.43C18288.23,-620.74 18267.39,-615.57 18247.57,-612.17 18061.65,-580.28 18012.03,-601.26 17823.57,-593.17 17230.77,-567.71 16521.88,-539.21 16241.91,-528.04"/>
<polygon fill="black" stroke="black" points="16241.86,-524.53 16231.73,-527.63 16241.58,-531.53 16241.86,-524.53"/>
</g>
<!-- residual2_3 -->
<g id="node1266" class="node">
<title>residual2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="16119.57" cy="-394.67" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="16119.57" y="-405.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16119.57" y="-390.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="16119.57" y="-375.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_mlp_3&#45;&gt;residual2_3 -->
<g id="edge1528" class="edge">
<title>allreduce_mlp_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M16119.57,-469.03C16119.57,-460.32 16119.57,-451.32 16119.57,-442.75"/>
<polygon fill="black" stroke="black" points="16123.07,-442.54 16119.57,-432.54 16116.07,-442.54 16123.07,-442.54"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_0 -->
<g id="edge1529" class="edge">
<title>residual2_3&#45;&gt;final_ln_0</title>
<path fill="none" stroke="black" d="M15964.24,-392.44C15494.18,-388.29 14091.42,-372.6 13636.57,-330.17 13537.81,-320.95 13427.01,-302.63 13344.46,-287.4"/>
<polygon fill="black" stroke="black" points="13345,-283.94 13334.53,-285.56 13343.73,-290.83 13345,-283.94"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_1 -->
<g id="edge1530" class="edge">
<title>residual2_3&#45;&gt;final_ln_1</title>
<path fill="none" stroke="black" d="M15964.08,-392.84C15553.12,-390.02 14444.81,-378.05 14081.57,-330.17 14021.02,-322.18 13954.56,-306.98 13900.86,-293.02"/>
<polygon fill="black" stroke="black" points="13901.55,-289.58 13890.99,-290.43 13899.77,-296.35 13901.55,-289.58"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_2 -->
<g id="edge1531" class="edge">
<title>residual2_3&#45;&gt;final_ln_2</title>
<path fill="none" stroke="black" d="M15964.16,-392.77C15609.34,-389.91 14748.36,-378.08 14462.57,-330.17 14418.62,-322.8 14371.2,-309.27 14331.44,-296.25"/>
<polygon fill="black" stroke="black" points="14332.36,-292.87 14321.76,-293.04 14330.16,-299.51 14332.36,-292.87"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_3 -->
<g id="edge1532" class="edge">
<title>residual2_3&#45;&gt;final_ln_3</title>
<path fill="none" stroke="black" d="M15964.24,-391.81C15666.77,-387.33 15027.02,-372.9 14810.57,-330.17 14774.63,-323.07 14736.31,-310.49 14703.58,-298.1"/>
<polygon fill="black" stroke="black" points="14704.64,-294.76 14694.05,-294.44 14702.13,-301.3 14704.64,-294.76"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_4 -->
<g id="edge1533" class="edge">
<title>residual2_3&#45;&gt;final_ln_4</title>
<path fill="none" stroke="black" d="M15965.52,-389.37C15730.81,-381.85 15294.85,-363.82 15142.57,-330.17 15110.46,-323.07 15076.45,-310.99 15047.1,-298.99"/>
<polygon fill="black" stroke="black" points="15048.32,-295.71 15037.75,-295.1 15045.64,-302.17 15048.32,-295.71"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_5 -->
<g id="edge1534" class="edge">
<title>residual2_3&#45;&gt;final_ln_5</title>
<path fill="none" stroke="black" d="M15964.74,-391.16C15831.08,-386.04 15633.71,-371.35 15466.57,-330.17 15436.45,-322.74 15404.6,-310.86 15376.95,-299.12"/>
<polygon fill="black" stroke="black" points="15378.31,-295.89 15367.74,-295.15 15375.54,-302.32 15378.31,-295.89"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_6 -->
<g id="edge1535" class="edge">
<title>residual2_3&#45;&gt;final_ln_6</title>
<path fill="none" stroke="black" d="M15986.77,-374.97C15924.89,-364.6 15850.71,-349.78 15785.57,-330.17 15757.92,-321.84 15728.54,-310.36 15702.56,-299.23"/>
<polygon fill="black" stroke="black" points="15703.71,-295.91 15693.15,-295.15 15700.93,-302.34 15703.71,-295.91"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_7 -->
<g id="edge1536" class="edge">
<title>residual2_3&#45;&gt;final_ln_7</title>
<path fill="none" stroke="black" d="M16072.41,-358.56C16049.64,-341.61 16022.18,-321.17 15998.47,-303.53"/>
<polygon fill="black" stroke="black" points="16000.37,-300.58 15990.26,-297.41 15996.19,-306.19 16000.37,-300.58"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_8 -->
<g id="edge1537" class="edge">
<title>residual2_3&#45;&gt;final_ln_8</title>
<path fill="none" stroke="black" d="M16166.54,-358.9C16189.54,-341.89 16217.37,-321.29 16241.38,-303.52"/>
<polygon fill="black" stroke="black" points="16243.74,-306.13 16249.69,-297.36 16239.57,-300.5 16243.74,-306.13"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_9 -->
<g id="edge1538" class="edge">
<title>residual2_3&#45;&gt;final_ln_9</title>
<path fill="none" stroke="black" d="M16247.22,-373.17C16310.05,-362.14 16386.7,-347.29 16454.57,-330.17 16493.42,-320.37 16535.58,-307.49 16572.07,-295.61"/>
<polygon fill="black" stroke="black" points="16573.3,-298.89 16581.71,-292.45 16571.12,-292.24 16573.3,-298.89"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_10 -->
<g id="edge1539" class="edge">
<title>residual2_3&#45;&gt;final_ln_10</title>
<path fill="none" stroke="black" d="M16273.79,-389.25C16417.72,-382.9 16637.88,-367.49 16825.57,-330.17 16866.96,-321.94 16911.64,-308.73 16949.56,-296.18"/>
<polygon fill="black" stroke="black" points="16950.68,-299.49 16959.05,-293 16948.45,-292.85 16950.68,-299.49"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_11 -->
<g id="edge1540" class="edge">
<title>residual2_3&#45;&gt;final_ln_11</title>
<path fill="none" stroke="black" d="M16274.14,-390.04C16529.24,-383.14 17027.32,-365.55 17199.57,-330.17 17234.81,-322.93 17272.34,-310.4 17304.47,-298.08"/>
<polygon fill="black" stroke="black" points="17305.77,-301.34 17313.82,-294.45 17303.23,-294.81 17305.77,-301.34"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_12 -->
<g id="edge1541" class="edge">
<title>residual2_3&#45;&gt;final_ln_12</title>
<path fill="none" stroke="black" d="M16275.24,-393.13C16592.98,-390.98 17306.3,-380.52 17544.57,-330.17 17576.88,-323.34 17611.02,-311.17 17640.37,-299.03"/>
<polygon fill="black" stroke="black" points="17641.86,-302.2 17649.72,-295.09 17639.14,-295.75 17641.86,-302.2"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_13 -->
<g id="edge1542" class="edge">
<title>residual2_3&#45;&gt;final_ln_13</title>
<path fill="none" stroke="black" d="M16274.6,-391.17C16674.73,-384.29 17721.71,-363.32 17875.57,-330.17 17906.29,-323.55 17938.59,-311.56 17966.39,-299.51"/>
<polygon fill="black" stroke="black" points="17967.91,-302.67 17975.64,-295.43 17965.08,-296.26 17967.91,-302.67"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_14 -->
<g id="edge1543" class="edge">
<title>residual2_3&#45;&gt;final_ln_14</title>
<path fill="none" stroke="black" d="M16274.85,-392.17C16725.36,-387.38 18012.71,-370.3 18198.57,-330.17 18228.54,-323.69 18259.99,-311.88 18287.11,-299.92"/>
<polygon fill="black" stroke="black" points="18288.83,-302.99 18296.52,-295.7 18285.96,-296.6 18288.83,-302.99"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_15 -->
<g id="edge1544" class="edge">
<title>residual2_3&#45;&gt;final_ln_15</title>
<path fill="none" stroke="black" d="M16274.95,-392.9C16771.58,-389.98 18300.77,-377.24 18518.57,-330.17 18548.23,-323.76 18579.29,-311.96 18606.08,-299.99"/>
<polygon fill="black" stroke="black" points="18607.71,-303.09 18615.36,-295.76 18604.81,-296.72 18607.71,-303.09"/>
</g>
</g>
</svg>
