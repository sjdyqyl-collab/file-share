<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="303pt"
 viewBox="0.00 0.00 1440.00 302.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 2342.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2342.91 11153,-2342.91 11153,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="1687" cy="-1900.43" rx="136.44" ry="37.45"/>
<text text-anchor="middle" x="1687" y="-1911.73" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="1687" y="-1896.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1687" y="-1881.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1 -->
<g id="node56" class="node">
<title>res1</title>
<polygon fill="lightcyan" stroke="black" points="1911.5,-1826.95 1718.5,-1826.95 1718.5,-1773.95 1911.5,-1773.95 1911.5,-1826.95"/>
<text text-anchor="middle" x="1815" y="-1811.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1815" y="-1796.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1815" y="-1781.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge53" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1732.13,-1864.89C1745.6,-1854.58 1760.29,-1843.33 1773.52,-1833.2"/>
<polygon fill="black" stroke="black" points="1775.73,-1835.92 1781.54,-1827.06 1771.47,-1830.36 1775.73,-1835.92"/>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightgray" stroke="black" points="4076.5,-2331.41 3883.5,-2331.41 3883.5,-2278.41 4076.5,-2278.41 4076.5,-2331.41"/>
<text text-anchor="middle" x="3980" y="-2316.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3980" y="-2301.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="3980" y="-2286.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_0_0 -->
<g id="node3" class="node">
<title>qkv_0_0</title>
<polygon fill="lightblue" stroke="black" points="205,-2338.91 21,-2338.91 21,-2270.91 205,-2270.91 205,-2338.91"/>
<text text-anchor="middle" x="113" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="113" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="113" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="113" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_0 -->
<g id="node4" class="node">
<title>attn_0_0</title>
<polygon fill="lightblue" stroke="black" points="226,-2234.91 0,-2234.91 0,-2181.91 226,-2181.91 226,-2234.91"/>
<text text-anchor="middle" x="113" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="113" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="113" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_0_0&#45;&gt;attn_0_0 -->
<g id="edge1" class="edge">
<title>qkv_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M113,-2270.86C113,-2262.62 113,-2253.75 113,-2245.39"/>
<polygon fill="black" stroke="black" points="116.5,-2245.14 113,-2235.14 109.5,-2245.14 116.5,-2245.14"/>
</g>
<!-- out_proj_0_0 -->
<g id="node5" class="node">
<title>out_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="247,-2145.91 63,-2145.91 63,-2077.91 247,-2077.91 247,-2145.91"/>
<text text-anchor="middle" x="155" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="155" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="155" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="155" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_0&#45;&gt;out_proj_0_0 -->
<g id="edge2" class="edge">
<title>attn_0_0&#45;&gt;out_proj_0_0</title>
<path fill="none" stroke="black" d="M124.48,-2181.58C128.08,-2173.47 132.16,-2164.29 136.14,-2155.34"/>
<polygon fill="black" stroke="black" points="139.36,-2156.72 140.22,-2146.16 132.96,-2153.87 139.36,-2156.72"/>
</g>
<!-- concat_dim_0 -->
<g id="node51" class="node">
<title>concat_dim_0</title>
<polygon fill="orange" stroke="black" points="717.5,-2041.91 484.5,-2041.91 484.5,-1973.91 717.5,-1973.91 717.5,-2041.91"/>
<text text-anchor="middle" x="601" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="601" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="601" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="601" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_0_0&#45;&gt;concat_dim_0 -->
<g id="edge33" class="edge">
<title>out_proj_0_0&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M247.12,-2085.42C257.19,-2082.8 267.3,-2080.25 277,-2077.91 341.87,-2062.24 414.5,-2046.6 474.53,-2034.18"/>
<polygon fill="black" stroke="black" points="475.35,-2037.58 484.44,-2032.13 473.93,-2030.73 475.35,-2037.58"/>
</g>
<!-- qkv_0_1 -->
<g id="node6" class="node">
<title>qkv_0_1</title>
<polygon fill="lightcoral" stroke="black" points="449,-2338.91 265,-2338.91 265,-2270.91 449,-2270.91 449,-2338.91"/>
<text text-anchor="middle" x="357" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="357" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="357" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="357" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_1 -->
<g id="node7" class="node">
<title>attn_0_1</title>
<polygon fill="lightcoral" stroke="black" points="470,-2234.91 244,-2234.91 244,-2181.91 470,-2181.91 470,-2234.91"/>
<text text-anchor="middle" x="357" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="357" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="357" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_0_1&#45;&gt;attn_0_1 -->
<g id="edge3" class="edge">
<title>qkv_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M357,-2270.86C357,-2262.62 357,-2253.75 357,-2245.39"/>
<polygon fill="black" stroke="black" points="360.5,-2245.14 357,-2235.14 353.5,-2245.14 360.5,-2245.14"/>
</g>
<!-- out_proj_0_1 -->
<g id="node8" class="node">
<title>out_proj_0_1</title>
<polygon fill="lightcoral" stroke="black" points="470,-2145.91 286,-2145.91 286,-2077.91 470,-2077.91 470,-2145.91"/>
<text text-anchor="middle" x="378" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="378" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="378" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="378" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_1&#45;&gt;out_proj_0_1 -->
<g id="edge4" class="edge">
<title>attn_0_1&#45;&gt;out_proj_0_1</title>
<path fill="none" stroke="black" d="M362.74,-2181.58C364.48,-2173.73 366.45,-2164.87 368.38,-2156.19"/>
<polygon fill="black" stroke="black" points="371.86,-2156.68 370.61,-2146.16 365.02,-2155.16 371.86,-2156.68"/>
</g>
<!-- out_proj_0_1&#45;&gt;concat_dim_0 -->
<g id="edge34" class="edge">
<title>out_proj_0_1&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M450.4,-2077.79C472.42,-2067.72 496.77,-2056.58 519.36,-2046.25"/>
<polygon fill="black" stroke="black" points="520.94,-2049.37 528.58,-2042.03 518.03,-2043.01 520.94,-2049.37"/>
</g>
<!-- qkv_0_2 -->
<g id="node9" class="node">
<title>qkv_0_2</title>
<polygon fill="lightgreen" stroke="black" points="693,-2338.91 509,-2338.91 509,-2270.91 693,-2270.91 693,-2338.91"/>
<text text-anchor="middle" x="601" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="601" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="601" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_2 -->
<g id="node10" class="node">
<title>attn_0_2</title>
<polygon fill="lightgreen" stroke="black" points="714,-2234.91 488,-2234.91 488,-2181.91 714,-2181.91 714,-2234.91"/>
<text text-anchor="middle" x="601" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="601" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_0_2&#45;&gt;attn_0_2 -->
<g id="edge5" class="edge">
<title>qkv_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M601,-2270.86C601,-2262.62 601,-2253.75 601,-2245.39"/>
<polygon fill="black" stroke="black" points="604.5,-2245.14 601,-2235.14 597.5,-2245.14 604.5,-2245.14"/>
</g>
<!-- out_proj_0_2 -->
<g id="node11" class="node">
<title>out_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="693,-2145.91 509,-2145.91 509,-2077.91 693,-2077.91 693,-2145.91"/>
<text text-anchor="middle" x="601" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="601" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="601" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_2&#45;&gt;out_proj_0_2 -->
<g id="edge6" class="edge">
<title>attn_0_2&#45;&gt;out_proj_0_2</title>
<path fill="none" stroke="black" d="M601,-2181.58C601,-2173.73 601,-2164.87 601,-2156.19"/>
<polygon fill="black" stroke="black" points="604.5,-2156.16 601,-2146.16 597.5,-2156.16 604.5,-2156.16"/>
</g>
<!-- out_proj_0_2&#45;&gt;concat_dim_0 -->
<g id="edge35" class="edge">
<title>out_proj_0_2&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M601,-2077.79C601,-2069.68 601,-2060.89 601,-2052.38"/>
<polygon fill="black" stroke="black" points="604.5,-2052.21 601,-2042.21 597.5,-2052.21 604.5,-2052.21"/>
</g>
<!-- qkv_0_3 -->
<g id="node12" class="node">
<title>qkv_0_3</title>
<polygon fill="lightyellow" stroke="black" points="937,-2338.91 753,-2338.91 753,-2270.91 937,-2270.91 937,-2338.91"/>
<text text-anchor="middle" x="845" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="845" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="845" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="845" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_3 -->
<g id="node13" class="node">
<title>attn_0_3</title>
<polygon fill="lightyellow" stroke="black" points="958,-2234.91 732,-2234.91 732,-2181.91 958,-2181.91 958,-2234.91"/>
<text text-anchor="middle" x="845" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="845" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="845" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_0_3&#45;&gt;attn_0_3 -->
<g id="edge7" class="edge">
<title>qkv_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M845,-2270.86C845,-2262.62 845,-2253.75 845,-2245.39"/>
<polygon fill="black" stroke="black" points="848.5,-2245.14 845,-2235.14 841.5,-2245.14 848.5,-2245.14"/>
</g>
<!-- out_proj_0_3 -->
<g id="node14" class="node">
<title>out_proj_0_3</title>
<polygon fill="lightyellow" stroke="black" points="916,-2145.91 732,-2145.91 732,-2077.91 916,-2077.91 916,-2145.91"/>
<text text-anchor="middle" x="824" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="824" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="824" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="824" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_3&#45;&gt;out_proj_0_3 -->
<g id="edge8" class="edge">
<title>attn_0_3&#45;&gt;out_proj_0_3</title>
<path fill="none" stroke="black" d="M839.26,-2181.58C837.52,-2173.73 835.55,-2164.87 833.62,-2156.19"/>
<polygon fill="black" stroke="black" points="836.98,-2155.16 831.39,-2146.16 830.14,-2156.68 836.98,-2155.16"/>
</g>
<!-- out_proj_0_3&#45;&gt;concat_dim_0 -->
<g id="edge36" class="edge">
<title>out_proj_0_3&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M751.6,-2077.79C729.58,-2067.72 705.23,-2056.58 682.64,-2046.25"/>
<polygon fill="black" stroke="black" points="683.97,-2043.01 673.42,-2042.03 681.06,-2049.37 683.97,-2043.01"/>
</g>
<!-- qkv_1_0 -->
<g id="node15" class="node">
<title>qkv_1_0</title>
<polygon fill="lightpink" stroke="black" points="1181,-2338.91 997,-2338.91 997,-2270.91 1181,-2270.91 1181,-2338.91"/>
<text text-anchor="middle" x="1089" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1089" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1089" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1089" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_0 -->
<g id="node16" class="node">
<title>attn_1_0</title>
<polygon fill="lightpink" stroke="black" points="1202,-2234.91 976,-2234.91 976,-2181.91 1202,-2181.91 1202,-2234.91"/>
<text text-anchor="middle" x="1089" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1089" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1089" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_1_0&#45;&gt;attn_1_0 -->
<g id="edge9" class="edge">
<title>qkv_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M1089,-2270.86C1089,-2262.62 1089,-2253.75 1089,-2245.39"/>
<polygon fill="black" stroke="black" points="1092.5,-2245.14 1089,-2235.14 1085.5,-2245.14 1092.5,-2245.14"/>
</g>
<!-- out_proj_1_0 -->
<g id="node17" class="node">
<title>out_proj_1_0</title>
<polygon fill="lightpink" stroke="black" points="1202,-2145.91 1018,-2145.91 1018,-2077.91 1202,-2077.91 1202,-2145.91"/>
<text text-anchor="middle" x="1110" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1110" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1110" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1110" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_0&#45;&gt;out_proj_1_0 -->
<g id="edge10" class="edge">
<title>attn_1_0&#45;&gt;out_proj_1_0</title>
<path fill="none" stroke="black" d="M1094.74,-2181.58C1096.48,-2173.73 1098.45,-2164.87 1100.38,-2156.19"/>
<polygon fill="black" stroke="black" points="1103.86,-2156.68 1102.61,-2146.16 1097.02,-2155.16 1103.86,-2156.68"/>
</g>
<!-- concat_dim_1 -->
<g id="node52" class="node">
<title>concat_dim_1</title>
<polygon fill="orange" stroke="black" points="1693.5,-2041.91 1460.5,-2041.91 1460.5,-1973.91 1693.5,-1973.91 1693.5,-2041.91"/>
<text text-anchor="middle" x="1577" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="1577" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="1577" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1577" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_1_0&#45;&gt;concat_dim_1 -->
<g id="edge37" class="edge">
<title>out_proj_1_0&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1202.26,-2089.37C1219.13,-2085.51 1236.58,-2081.55 1253,-2077.91 1318.02,-2063.48 1390.51,-2047.99 1450.42,-2035.34"/>
<polygon fill="black" stroke="black" points="1451.24,-2038.75 1460.3,-2033.26 1449.79,-2031.9 1451.24,-2038.75"/>
</g>
<!-- qkv_1_1 -->
<g id="node18" class="node">
<title>qkv_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1425,-2338.91 1241,-2338.91 1241,-2270.91 1425,-2270.91 1425,-2338.91"/>
<text text-anchor="middle" x="1333" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1333" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1333" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1333" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_1 -->
<g id="node19" class="node">
<title>attn_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1446,-2234.91 1220,-2234.91 1220,-2181.91 1446,-2181.91 1446,-2234.91"/>
<text text-anchor="middle" x="1333" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1333" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1333" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_1_1&#45;&gt;attn_1_1 -->
<g id="edge11" class="edge">
<title>qkv_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M1333,-2270.86C1333,-2262.62 1333,-2253.75 1333,-2245.39"/>
<polygon fill="black" stroke="black" points="1336.5,-2245.14 1333,-2235.14 1329.5,-2245.14 1336.5,-2245.14"/>
</g>
<!-- out_proj_1_1 -->
<g id="node20" class="node">
<title>out_proj_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1446,-2145.91 1262,-2145.91 1262,-2077.91 1446,-2077.91 1446,-2145.91"/>
<text text-anchor="middle" x="1354" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1354" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1354" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1354" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_1&#45;&gt;out_proj_1_1 -->
<g id="edge12" class="edge">
<title>attn_1_1&#45;&gt;out_proj_1_1</title>
<path fill="none" stroke="black" d="M1338.74,-2181.58C1340.48,-2173.73 1342.45,-2164.87 1344.38,-2156.19"/>
<polygon fill="black" stroke="black" points="1347.86,-2156.68 1346.61,-2146.16 1341.02,-2155.16 1347.86,-2156.68"/>
</g>
<!-- out_proj_1_1&#45;&gt;concat_dim_1 -->
<g id="edge38" class="edge">
<title>out_proj_1_1&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1426.4,-2077.79C1448.42,-2067.72 1472.77,-2056.58 1495.36,-2046.25"/>
<polygon fill="black" stroke="black" points="1496.94,-2049.37 1504.58,-2042.03 1494.03,-2043.01 1496.94,-2049.37"/>
</g>
<!-- qkv_1_2 -->
<g id="node21" class="node">
<title>qkv_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1669,-2338.91 1485,-2338.91 1485,-2270.91 1669,-2270.91 1669,-2338.91"/>
<text text-anchor="middle" x="1577" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1577" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1577" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_2 -->
<g id="node22" class="node">
<title>attn_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1690,-2234.91 1464,-2234.91 1464,-2181.91 1690,-2181.91 1690,-2234.91"/>
<text text-anchor="middle" x="1577" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1577" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_1_2&#45;&gt;attn_1_2 -->
<g id="edge13" class="edge">
<title>qkv_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M1577,-2270.86C1577,-2262.62 1577,-2253.75 1577,-2245.39"/>
<polygon fill="black" stroke="black" points="1580.5,-2245.14 1577,-2235.14 1573.5,-2245.14 1580.5,-2245.14"/>
</g>
<!-- out_proj_1_2 -->
<g id="node23" class="node">
<title>out_proj_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1669,-2145.91 1485,-2145.91 1485,-2077.91 1669,-2077.91 1669,-2145.91"/>
<text text-anchor="middle" x="1577" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1577" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1577" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_2&#45;&gt;out_proj_1_2 -->
<g id="edge14" class="edge">
<title>attn_1_2&#45;&gt;out_proj_1_2</title>
<path fill="none" stroke="black" d="M1577,-2181.58C1577,-2173.73 1577,-2164.87 1577,-2156.19"/>
<polygon fill="black" stroke="black" points="1580.5,-2156.16 1577,-2146.16 1573.5,-2156.16 1580.5,-2156.16"/>
</g>
<!-- out_proj_1_2&#45;&gt;concat_dim_1 -->
<g id="edge39" class="edge">
<title>out_proj_1_2&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1577,-2077.79C1577,-2069.68 1577,-2060.89 1577,-2052.38"/>
<polygon fill="black" stroke="black" points="1580.5,-2052.21 1577,-2042.21 1573.5,-2052.21 1580.5,-2052.21"/>
</g>
<!-- qkv_1_3 -->
<g id="node24" class="node">
<title>qkv_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1913,-2338.91 1729,-2338.91 1729,-2270.91 1913,-2270.91 1913,-2338.91"/>
<text text-anchor="middle" x="1821" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1821" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1821" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1821" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_3 -->
<g id="node25" class="node">
<title>attn_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1934,-2234.91 1708,-2234.91 1708,-2181.91 1934,-2181.91 1934,-2234.91"/>
<text text-anchor="middle" x="1821" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1821" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1821" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_1_3&#45;&gt;attn_1_3 -->
<g id="edge15" class="edge">
<title>qkv_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M1821,-2270.86C1821,-2262.62 1821,-2253.75 1821,-2245.39"/>
<polygon fill="black" stroke="black" points="1824.5,-2245.14 1821,-2235.14 1817.5,-2245.14 1824.5,-2245.14"/>
</g>
<!-- out_proj_1_3 -->
<g id="node26" class="node">
<title>out_proj_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1892,-2145.91 1708,-2145.91 1708,-2077.91 1892,-2077.91 1892,-2145.91"/>
<text text-anchor="middle" x="1800" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1800" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1800" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1800" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_3&#45;&gt;out_proj_1_3 -->
<g id="edge16" class="edge">
<title>attn_1_3&#45;&gt;out_proj_1_3</title>
<path fill="none" stroke="black" d="M1815.26,-2181.58C1813.52,-2173.73 1811.55,-2164.87 1809.62,-2156.19"/>
<polygon fill="black" stroke="black" points="1812.98,-2155.16 1807.39,-2146.16 1806.14,-2156.68 1812.98,-2155.16"/>
</g>
<!-- out_proj_1_3&#45;&gt;concat_dim_1 -->
<g id="edge40" class="edge">
<title>out_proj_1_3&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1727.6,-2077.79C1705.58,-2067.72 1681.23,-2056.58 1658.64,-2046.25"/>
<polygon fill="black" stroke="black" points="1659.97,-2043.01 1649.42,-2042.03 1657.06,-2049.37 1659.97,-2043.01"/>
</g>
<!-- qkv_2_0 -->
<g id="node27" class="node">
<title>qkv_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2157,-2338.91 1973,-2338.91 1973,-2270.91 2157,-2270.91 2157,-2338.91"/>
<text text-anchor="middle" x="2065" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2065" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2065" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2065" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0 -->
<g id="node28" class="node">
<title>attn_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2178,-2234.91 1952,-2234.91 1952,-2181.91 2178,-2181.91 2178,-2234.91"/>
<text text-anchor="middle" x="2065" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2065" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2065" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_0&#45;&gt;attn_2_0 -->
<g id="edge17" class="edge">
<title>qkv_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M2065,-2270.86C2065,-2262.62 2065,-2253.75 2065,-2245.39"/>
<polygon fill="black" stroke="black" points="2068.5,-2245.14 2065,-2235.14 2061.5,-2245.14 2068.5,-2245.14"/>
</g>
<!-- out_proj_2_0 -->
<g id="node29" class="node">
<title>out_proj_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2178,-2145.91 1994,-2145.91 1994,-2077.91 2178,-2077.91 2178,-2145.91"/>
<text text-anchor="middle" x="2086" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2086" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2086" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2086" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0&#45;&gt;out_proj_2_0 -->
<g id="edge18" class="edge">
<title>attn_2_0&#45;&gt;out_proj_2_0</title>
<path fill="none" stroke="black" d="M2070.74,-2181.58C2072.48,-2173.73 2074.45,-2164.87 2076.38,-2156.19"/>
<polygon fill="black" stroke="black" points="2079.86,-2156.68 2078.61,-2146.16 2073.02,-2155.16 2079.86,-2156.68"/>
</g>
<!-- concat_dim_2 -->
<g id="node53" class="node">
<title>concat_dim_2</title>
<polygon fill="orange" stroke="black" points="2425.5,-2041.91 2192.5,-2041.91 2192.5,-1973.91 2425.5,-1973.91 2425.5,-2041.91"/>
<text text-anchor="middle" x="2309" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="2309" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="2309" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="2309" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_0&#45;&gt;concat_dim_2 -->
<g id="edge41" class="edge">
<title>out_proj_2_0&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2158.4,-2077.79C2180.42,-2067.72 2204.77,-2056.58 2227.36,-2046.25"/>
<polygon fill="black" stroke="black" points="2228.94,-2049.37 2236.58,-2042.03 2226.03,-2043.01 2228.94,-2049.37"/>
</g>
<!-- qkv_2_1 -->
<g id="node30" class="node">
<title>qkv_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2401,-2338.91 2217,-2338.91 2217,-2270.91 2401,-2270.91 2401,-2338.91"/>
<text text-anchor="middle" x="2309" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2309" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2309" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1 -->
<g id="node31" class="node">
<title>attn_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2422,-2234.91 2196,-2234.91 2196,-2181.91 2422,-2181.91 2422,-2234.91"/>
<text text-anchor="middle" x="2309" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2309" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_1&#45;&gt;attn_2_1 -->
<g id="edge19" class="edge">
<title>qkv_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M2309,-2270.86C2309,-2262.62 2309,-2253.75 2309,-2245.39"/>
<polygon fill="black" stroke="black" points="2312.5,-2245.14 2309,-2235.14 2305.5,-2245.14 2312.5,-2245.14"/>
</g>
<!-- out_proj_2_1 -->
<g id="node32" class="node">
<title>out_proj_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2401,-2145.91 2217,-2145.91 2217,-2077.91 2401,-2077.91 2401,-2145.91"/>
<text text-anchor="middle" x="2309" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2309" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2309" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1&#45;&gt;out_proj_2_1 -->
<g id="edge20" class="edge">
<title>attn_2_1&#45;&gt;out_proj_2_1</title>
<path fill="none" stroke="black" d="M2309,-2181.58C2309,-2173.73 2309,-2164.87 2309,-2156.19"/>
<polygon fill="black" stroke="black" points="2312.5,-2156.16 2309,-2146.16 2305.5,-2156.16 2312.5,-2156.16"/>
</g>
<!-- out_proj_2_1&#45;&gt;concat_dim_2 -->
<g id="edge42" class="edge">
<title>out_proj_2_1&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2309,-2077.79C2309,-2069.68 2309,-2060.89 2309,-2052.38"/>
<polygon fill="black" stroke="black" points="2312.5,-2052.21 2309,-2042.21 2305.5,-2052.21 2312.5,-2052.21"/>
</g>
<!-- qkv_2_2 -->
<g id="node33" class="node">
<title>qkv_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2645,-2338.91 2461,-2338.91 2461,-2270.91 2645,-2270.91 2645,-2338.91"/>
<text text-anchor="middle" x="2553" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2553" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2553" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2553" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2 -->
<g id="node34" class="node">
<title>attn_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2666,-2234.91 2440,-2234.91 2440,-2181.91 2666,-2181.91 2666,-2234.91"/>
<text text-anchor="middle" x="2553" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2553" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2553" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2&#45;&gt;attn_2_2 -->
<g id="edge21" class="edge">
<title>qkv_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M2553,-2270.86C2553,-2262.62 2553,-2253.75 2553,-2245.39"/>
<polygon fill="black" stroke="black" points="2556.5,-2245.14 2553,-2235.14 2549.5,-2245.14 2556.5,-2245.14"/>
</g>
<!-- out_proj_2_2 -->
<g id="node35" class="node">
<title>out_proj_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2624,-2145.91 2440,-2145.91 2440,-2077.91 2624,-2077.91 2624,-2145.91"/>
<text text-anchor="middle" x="2532" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2532" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2532" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2532" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2&#45;&gt;out_proj_2_2 -->
<g id="edge22" class="edge">
<title>attn_2_2&#45;&gt;out_proj_2_2</title>
<path fill="none" stroke="black" d="M2547.26,-2181.58C2545.52,-2173.73 2543.55,-2164.87 2541.62,-2156.19"/>
<polygon fill="black" stroke="black" points="2544.98,-2155.16 2539.39,-2146.16 2538.14,-2156.68 2544.98,-2155.16"/>
</g>
<!-- out_proj_2_2&#45;&gt;concat_dim_2 -->
<g id="edge43" class="edge">
<title>out_proj_2_2&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2459.6,-2077.79C2437.58,-2067.72 2413.23,-2056.58 2390.64,-2046.25"/>
<polygon fill="black" stroke="black" points="2391.97,-2043.01 2381.42,-2042.03 2389.06,-2049.37 2391.97,-2043.01"/>
</g>
<!-- qkv_2_3 -->
<g id="node36" class="node">
<title>qkv_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2889,-2338.91 2705,-2338.91 2705,-2270.91 2889,-2270.91 2889,-2338.91"/>
<text text-anchor="middle" x="2797" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2797" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2797" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2797" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3 -->
<g id="node37" class="node">
<title>attn_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2910,-2234.91 2684,-2234.91 2684,-2181.91 2910,-2181.91 2910,-2234.91"/>
<text text-anchor="middle" x="2797" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2797" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2797" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_3&#45;&gt;attn_2_3 -->
<g id="edge23" class="edge">
<title>qkv_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M2797,-2270.86C2797,-2262.62 2797,-2253.75 2797,-2245.39"/>
<polygon fill="black" stroke="black" points="2800.5,-2245.14 2797,-2235.14 2793.5,-2245.14 2800.5,-2245.14"/>
</g>
<!-- out_proj_2_3 -->
<g id="node38" class="node">
<title>out_proj_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2858,-2145.91 2674,-2145.91 2674,-2077.91 2858,-2077.91 2858,-2145.91"/>
<text text-anchor="middle" x="2766" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2766" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2766" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2766" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3&#45;&gt;out_proj_2_3 -->
<g id="edge24" class="edge">
<title>attn_2_3&#45;&gt;out_proj_2_3</title>
<path fill="none" stroke="black" d="M2788.53,-2181.58C2785.92,-2173.64 2782.98,-2164.68 2780.11,-2155.91"/>
<polygon fill="black" stroke="black" points="2783.35,-2154.57 2776.91,-2146.16 2776.7,-2156.75 2783.35,-2154.57"/>
</g>
<!-- out_proj_2_3&#45;&gt;concat_dim_2 -->
<g id="edge44" class="edge">
<title>out_proj_2_3&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2673.8,-2087.61C2660.14,-2084.28 2646.21,-2080.95 2633,-2077.91 2568.1,-2062.95 2495.62,-2047.4 2435.69,-2034.86"/>
<polygon fill="black" stroke="black" points="2436.31,-2031.42 2425.8,-2032.8 2434.88,-2038.27 2436.31,-2031.42"/>
</g>
<!-- qkv_3_0 -->
<g id="node39" class="node">
<title>qkv_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3133,-2338.91 2949,-2338.91 2949,-2270.91 3133,-2270.91 3133,-2338.91"/>
<text text-anchor="middle" x="3041" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3041" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3041" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3041" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0 -->
<g id="node40" class="node">
<title>attn_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3154,-2234.91 2928,-2234.91 2928,-2181.91 3154,-2181.91 3154,-2234.91"/>
<text text-anchor="middle" x="3041" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3041" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3041" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_0&#45;&gt;attn_3_0 -->
<g id="edge25" class="edge">
<title>qkv_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M3041,-2270.86C3041,-2262.62 3041,-2253.75 3041,-2245.39"/>
<polygon fill="black" stroke="black" points="3044.5,-2245.14 3041,-2235.14 3037.5,-2245.14 3044.5,-2245.14"/>
</g>
<!-- out_proj_3_0 -->
<g id="node41" class="node">
<title>out_proj_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3154,-2145.91 2970,-2145.91 2970,-2077.91 3154,-2077.91 3154,-2145.91"/>
<text text-anchor="middle" x="3062" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3062" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3062" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3062" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0&#45;&gt;out_proj_3_0 -->
<g id="edge26" class="edge">
<title>attn_3_0&#45;&gt;out_proj_3_0</title>
<path fill="none" stroke="black" d="M3046.74,-2181.58C3048.48,-2173.73 3050.45,-2164.87 3052.38,-2156.19"/>
<polygon fill="black" stroke="black" points="3055.86,-2156.68 3054.61,-2146.16 3049.02,-2155.16 3055.86,-2156.68"/>
</g>
<!-- concat_dim_3 -->
<g id="node54" class="node">
<title>concat_dim_3</title>
<polygon fill="orange" stroke="black" points="3401.5,-2041.91 3168.5,-2041.91 3168.5,-1973.91 3401.5,-1973.91 3401.5,-2041.91"/>
<text text-anchor="middle" x="3285" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="3285" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="3285" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="3285" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_0&#45;&gt;concat_dim_3 -->
<g id="edge45" class="edge">
<title>out_proj_3_0&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3134.4,-2077.79C3156.42,-2067.72 3180.77,-2056.58 3203.36,-2046.25"/>
<polygon fill="black" stroke="black" points="3204.94,-2049.37 3212.58,-2042.03 3202.03,-2043.01 3204.94,-2049.37"/>
</g>
<!-- qkv_3_1 -->
<g id="node42" class="node">
<title>qkv_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3377,-2338.91 3193,-2338.91 3193,-2270.91 3377,-2270.91 3377,-2338.91"/>
<text text-anchor="middle" x="3285" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3285" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="3285" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1 -->
<g id="node43" class="node">
<title>attn_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3398,-2234.91 3172,-2234.91 3172,-2181.91 3398,-2181.91 3398,-2234.91"/>
<text text-anchor="middle" x="3285" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3285" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_1&#45;&gt;attn_3_1 -->
<g id="edge27" class="edge">
<title>qkv_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M3285,-2270.86C3285,-2262.62 3285,-2253.75 3285,-2245.39"/>
<polygon fill="black" stroke="black" points="3288.5,-2245.14 3285,-2235.14 3281.5,-2245.14 3288.5,-2245.14"/>
</g>
<!-- out_proj_3_1 -->
<g id="node44" class="node">
<title>out_proj_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3377,-2145.91 3193,-2145.91 3193,-2077.91 3377,-2077.91 3377,-2145.91"/>
<text text-anchor="middle" x="3285" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3285" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="3285" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1&#45;&gt;out_proj_3_1 -->
<g id="edge28" class="edge">
<title>attn_3_1&#45;&gt;out_proj_3_1</title>
<path fill="none" stroke="black" d="M3285,-2181.58C3285,-2173.73 3285,-2164.87 3285,-2156.19"/>
<polygon fill="black" stroke="black" points="3288.5,-2156.16 3285,-2146.16 3281.5,-2156.16 3288.5,-2156.16"/>
</g>
<!-- out_proj_3_1&#45;&gt;concat_dim_3 -->
<g id="edge46" class="edge">
<title>out_proj_3_1&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3285,-2077.79C3285,-2069.68 3285,-2060.89 3285,-2052.38"/>
<polygon fill="black" stroke="black" points="3288.5,-2052.21 3285,-2042.21 3281.5,-2052.21 3288.5,-2052.21"/>
</g>
<!-- qkv_3_2 -->
<g id="node45" class="node">
<title>qkv_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3621,-2338.91 3437,-2338.91 3437,-2270.91 3621,-2270.91 3621,-2338.91"/>
<text text-anchor="middle" x="3529" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3529" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3529" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3529" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2 -->
<g id="node46" class="node">
<title>attn_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3642,-2234.91 3416,-2234.91 3416,-2181.91 3642,-2181.91 3642,-2234.91"/>
<text text-anchor="middle" x="3529" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3529" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3529" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_2&#45;&gt;attn_3_2 -->
<g id="edge29" class="edge">
<title>qkv_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M3529,-2270.86C3529,-2262.62 3529,-2253.75 3529,-2245.39"/>
<polygon fill="black" stroke="black" points="3532.5,-2245.14 3529,-2235.14 3525.5,-2245.14 3532.5,-2245.14"/>
</g>
<!-- out_proj_3_2 -->
<g id="node47" class="node">
<title>out_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3600,-2145.91 3416,-2145.91 3416,-2077.91 3600,-2077.91 3600,-2145.91"/>
<text text-anchor="middle" x="3508" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3508" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3508" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3508" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2&#45;&gt;out_proj_3_2 -->
<g id="edge30" class="edge">
<title>attn_3_2&#45;&gt;out_proj_3_2</title>
<path fill="none" stroke="black" d="M3523.26,-2181.58C3521.52,-2173.73 3519.55,-2164.87 3517.62,-2156.19"/>
<polygon fill="black" stroke="black" points="3520.98,-2155.16 3515.39,-2146.16 3514.14,-2156.68 3520.98,-2155.16"/>
</g>
<!-- out_proj_3_2&#45;&gt;concat_dim_3 -->
<g id="edge47" class="edge">
<title>out_proj_3_2&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3435.6,-2077.79C3413.58,-2067.72 3389.23,-2056.58 3366.64,-2046.25"/>
<polygon fill="black" stroke="black" points="3367.97,-2043.01 3357.42,-2042.03 3365.06,-2049.37 3367.97,-2043.01"/>
</g>
<!-- qkv_3_3 -->
<g id="node48" class="node">
<title>qkv_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3865,-2338.91 3681,-2338.91 3681,-2270.91 3865,-2270.91 3865,-2338.91"/>
<text text-anchor="middle" x="3773" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3773" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3773" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3773" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3 -->
<g id="node49" class="node">
<title>attn_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3886,-2234.91 3660,-2234.91 3660,-2181.91 3886,-2181.91 3886,-2234.91"/>
<text text-anchor="middle" x="3773" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3773" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3773" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3&#45;&gt;attn_3_3 -->
<g id="edge31" class="edge">
<title>qkv_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M3773,-2270.86C3773,-2262.62 3773,-2253.75 3773,-2245.39"/>
<polygon fill="black" stroke="black" points="3776.5,-2245.14 3773,-2235.14 3769.5,-2245.14 3776.5,-2245.14"/>
</g>
<!-- out_proj_3_3 -->
<g id="node50" class="node">
<title>out_proj_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3844,-2145.91 3660,-2145.91 3660,-2077.91 3844,-2077.91 3844,-2145.91"/>
<text text-anchor="middle" x="3752" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3752" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3752" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3752" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3&#45;&gt;out_proj_3_3 -->
<g id="edge32" class="edge">
<title>attn_3_3&#45;&gt;out_proj_3_3</title>
<path fill="none" stroke="black" d="M3767.26,-2181.58C3765.52,-2173.73 3763.55,-2164.87 3761.62,-2156.19"/>
<polygon fill="black" stroke="black" points="3764.98,-2155.16 3759.39,-2146.16 3758.14,-2156.68 3764.98,-2155.16"/>
</g>
<!-- out_proj_3_3&#45;&gt;concat_dim_3 -->
<g id="edge48" class="edge">
<title>out_proj_3_3&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3659.74,-2089.37C3642.87,-2085.51 3625.42,-2081.55 3609,-2077.91 3543.98,-2063.48 3471.49,-2047.99 3411.58,-2035.34"/>
<polygon fill="black" stroke="black" points="3412.21,-2031.9 3401.7,-2033.26 3410.76,-2038.75 3412.21,-2031.9"/>
</g>
<!-- concat_heads -->
<g id="node55" class="node">
<title>concat_heads</title>
<polygon fill="gold" stroke="black" points="2045,-1926.93 1841,-1926.93 1841,-1873.93 2045,-1873.93 2045,-1926.93"/>
<text text-anchor="middle" x="1943" y="-1911.73" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="1943" y="-1896.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1943" y="-1881.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0&#45;&gt;concat_heads -->
<g id="edge49" class="edge">
<title>concat_dim_0&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M717.62,-2002.11C1003.64,-1990.09 1724.5,-1958.22 1832,-1937.91 1842.87,-1935.85 1854.14,-1933.02 1865.16,-1929.83"/>
<polygon fill="black" stroke="black" points="1866.18,-1933.18 1874.75,-1926.95 1864.17,-1926.47 1866.18,-1933.18"/>
</g>
<!-- concat_dim_1&#45;&gt;concat_heads -->
<g id="edge50" class="edge">
<title>concat_dim_1&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M1693.52,-1976.78C1737.11,-1965.14 1786.97,-1951.39 1832,-1937.91 1840.26,-1935.43 1848.84,-1932.78 1857.4,-1930.06"/>
<polygon fill="black" stroke="black" points="1858.58,-1933.36 1867.04,-1926.99 1856.45,-1926.69 1858.58,-1933.36"/>
</g>
<!-- concat_dim_2&#45;&gt;concat_heads -->
<g id="edge51" class="edge">
<title>concat_dim_2&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M2194.45,-1973.89C2145.31,-1959.73 2088.47,-1943.35 2041.28,-1929.75"/>
<polygon fill="black" stroke="black" points="2042.25,-1926.39 2031.67,-1926.98 2040.31,-1933.12 2042.25,-1926.39"/>
</g>
<!-- concat_dim_3&#45;&gt;concat_heads -->
<g id="edge52" class="edge">
<title>concat_dim_3&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M3168.25,-1997.73C2912.73,-1977.65 2306.72,-1930.02 2055.31,-1910.26"/>
<polygon fill="black" stroke="black" points="2055.3,-1906.75 2045.06,-1909.45 2054.76,-1913.72 2055.3,-1906.75"/>
</g>
<!-- concat_heads&#45;&gt;res1 -->
<g id="edge54" class="edge">
<title>concat_heads&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M1909.37,-1873.69C1893.2,-1861.31 1873.67,-1846.36 1856.57,-1833.28"/>
<polygon fill="black" stroke="black" points="1858.47,-1830.32 1848.41,-1827.02 1854.22,-1835.88 1858.47,-1830.32"/>
</g>
<!-- ln2 -->
<g id="node57" class="node">
<title>ln2</title>
<polygon fill="lightgray" stroke="black" points="1849.5,-1730.45 1656.5,-1730.45 1656.5,-1677.45 1849.5,-1677.45 1849.5,-1730.45"/>
<text text-anchor="middle" x="1753" y="-1715.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1753" y="-1700.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1753" y="-1685.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;ln2 -->
<g id="edge55" class="edge">
<title>res1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M1798.06,-1773.63C1791.09,-1763.01 1782.91,-1750.55 1775.45,-1739.18"/>
<polygon fill="black" stroke="black" points="1778.33,-1737.19 1769.92,-1730.74 1772.48,-1741.03 1778.33,-1737.19"/>
</g>
<!-- res2 -->
<g id="node61" class="node">
<title>res2</title>
<polygon fill="lightcyan" stroke="black" points="1913.5,-1321.95 1720.5,-1321.95 1720.5,-1268.95 1913.5,-1268.95 1913.5,-1321.95"/>
<text text-anchor="middle" x="1817" y="-1306.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1817" y="-1291.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1817" y="-1276.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge59" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1836.87,-1773.74C1844.71,-1763.26 1852.87,-1750.63 1858,-1737.95 1881.14,-1680.79 1880,-1662.62 1880,-1600.95 1880,-1600.95 1880,-1600.95 1880,-1494.95 1880,-1433.28 1880.51,-1415.37 1858,-1357.95 1854.28,-1348.46 1848.91,-1338.93 1843.28,-1330.3"/>
<polygon fill="black" stroke="black" points="1846.15,-1328.29 1837.62,-1322.01 1840.37,-1332.24 1846.15,-1328.29"/>
</g>
<!-- ffn_col -->
<g id="node58" class="node">
<title>ffn_col</title>
<polygon fill="lightgreen" stroke="black" points="1852,-1633.95 1650,-1633.95 1650,-1565.95 1852,-1565.95 1852,-1633.95"/>
<text text-anchor="middle" x="1751" y="-1618.75" font-family="Times,serif" font-size="14.00">FFN Column Parallel</text>
<text text-anchor="middle" x="1751" y="-1603.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="1751" y="-1588.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="1751" y="-1573.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;ffn_col -->
<g id="edge56" class="edge">
<title>ln2&#45;&gt;ffn_col</title>
<path fill="none" stroke="black" d="M1752.5,-1677.21C1752.3,-1667.18 1752.07,-1655.41 1751.85,-1644.15"/>
<polygon fill="black" stroke="black" points="1755.34,-1643.96 1751.65,-1634.03 1748.35,-1644.09 1755.34,-1643.96"/>
</g>
<!-- gelu -->
<g id="node59" class="node">
<title>gelu</title>
<polygon fill="lightyellow" stroke="black" points="1852,-1522.45 1650,-1522.45 1650,-1469.45 1852,-1469.45 1852,-1522.45"/>
<text text-anchor="middle" x="1751" y="-1507.25" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1751" y="-1492.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="1751" y="-1477.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ffn_col&#45;&gt;gelu -->
<g id="edge57" class="edge">
<title>ffn_col&#45;&gt;gelu</title>
<path fill="none" stroke="black" d="M1751,-1565.84C1751,-1555.28 1751,-1543.55 1751,-1532.81"/>
<polygon fill="black" stroke="black" points="1754.5,-1532.47 1751,-1522.47 1747.5,-1532.47 1754.5,-1532.47"/>
</g>
<!-- ffn_row -->
<g id="node60" class="node">
<title>ffn_row</title>
<polygon fill="lightgreen" stroke="black" points="1849.5,-1425.95 1656.5,-1425.95 1656.5,-1357.95 1849.5,-1357.95 1849.5,-1425.95"/>
<text text-anchor="middle" x="1753" y="-1410.75" font-family="Times,serif" font-size="14.00">FFN Row Parallel</text>
<text text-anchor="middle" x="1753" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1753" y="-1380.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="1753" y="-1365.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- gelu&#45;&gt;ffn_row -->
<g id="edge58" class="edge">
<title>gelu&#45;&gt;ffn_row</title>
<path fill="none" stroke="black" d="M1751.5,-1469.21C1751.7,-1459.18 1751.93,-1447.41 1752.15,-1436.15"/>
<polygon fill="black" stroke="black" points="1755.65,-1436.09 1752.35,-1426.03 1748.66,-1435.96 1755.65,-1436.09"/>
</g>
<!-- ffn_row&#45;&gt;res2 -->
<g id="edge60" class="edge">
<title>ffn_row&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M1775.38,-1357.9C1781.39,-1349.03 1787.9,-1339.42 1793.95,-1330.49"/>
<polygon fill="black" stroke="black" points="1796.86,-1332.43 1799.57,-1322.19 1791.06,-1328.51 1796.86,-1332.43"/>
</g>
<!-- ln1_2 -->
<g id="node62" class="node">
<title>ln1_2</title>
<polygon fill="lightgray" stroke="black" points="4287.5,-2331.41 4094.5,-2331.41 4094.5,-2278.41 4287.5,-2278.41 4287.5,-2331.41"/>
<text text-anchor="middle" x="4191" y="-2316.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4191" y="-2301.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="4191" y="-2286.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_2_0_0 -->
<g id="node63" class="node">
<title>qkv_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="7418,-2338.91 7234,-2338.91 7234,-2270.91 7418,-2270.91 7418,-2338.91"/>
<text text-anchor="middle" x="7326" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7326" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7326" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="7326" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_0 -->
<g id="node64" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="7439,-2234.91 7213,-2234.91 7213,-2181.91 7439,-2181.91 7439,-2234.91"/>
<text text-anchor="middle" x="7326" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7326" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7326" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge61" class="edge">
<title>qkv_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M7326,-2270.86C7326,-2262.62 7326,-2253.75 7326,-2245.39"/>
<polygon fill="black" stroke="black" points="7329.5,-2245.14 7326,-2235.14 7322.5,-2245.14 7329.5,-2245.14"/>
</g>
<!-- out_proj_2_0_0 -->
<g id="node65" class="node">
<title>out_proj_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="7439,-2145.91 7255,-2145.91 7255,-2077.91 7439,-2077.91 7439,-2145.91"/>
<text text-anchor="middle" x="7347" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7347" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7347" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="7347" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_0&#45;&gt;out_proj_2_0_0 -->
<g id="edge62" class="edge">
<title>attn_2_0_0&#45;&gt;out_proj_2_0_0</title>
<path fill="none" stroke="black" d="M7331.74,-2181.58C7333.48,-2173.73 7335.45,-2164.87 7337.38,-2156.19"/>
<polygon fill="black" stroke="black" points="7340.86,-2156.68 7339.61,-2146.16 7334.02,-2155.16 7340.86,-2156.68"/>
</g>
<!-- concat_dim_2_0 -->
<g id="node111" class="node">
<title>concat_dim_2_0</title>
<polygon fill="orange" stroke="black" points="7686.5,-2041.91 7453.5,-2041.91 7453.5,-1973.91 7686.5,-1973.91 7686.5,-2041.91"/>
<text text-anchor="middle" x="7570" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7570" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="7570" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="7570" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge93" class="edge">
<title>out_proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M7419.4,-2077.79C7441.42,-2067.72 7465.77,-2056.58 7488.36,-2046.25"/>
<polygon fill="black" stroke="black" points="7489.94,-2049.37 7497.58,-2042.03 7487.03,-2043.01 7489.94,-2049.37"/>
</g>
<!-- qkv_2_0_1 -->
<g id="node66" class="node">
<title>qkv_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7662,-2338.91 7478,-2338.91 7478,-2270.91 7662,-2270.91 7662,-2338.91"/>
<text text-anchor="middle" x="7570" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7570" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7570" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_1 -->
<g id="node67" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7683,-2234.91 7457,-2234.91 7457,-2181.91 7683,-2181.91 7683,-2234.91"/>
<text text-anchor="middle" x="7570" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7570" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge63" class="edge">
<title>qkv_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M7570,-2270.86C7570,-2262.62 7570,-2253.75 7570,-2245.39"/>
<polygon fill="black" stroke="black" points="7573.5,-2245.14 7570,-2235.14 7566.5,-2245.14 7573.5,-2245.14"/>
</g>
<!-- out_proj_2_0_1 -->
<g id="node68" class="node">
<title>out_proj_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7662,-2145.91 7478,-2145.91 7478,-2077.91 7662,-2077.91 7662,-2145.91"/>
<text text-anchor="middle" x="7570" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7570" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7570" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_1&#45;&gt;out_proj_2_0_1 -->
<g id="edge64" class="edge">
<title>attn_2_0_1&#45;&gt;out_proj_2_0_1</title>
<path fill="none" stroke="black" d="M7570,-2181.58C7570,-2173.73 7570,-2164.87 7570,-2156.19"/>
<polygon fill="black" stroke="black" points="7573.5,-2156.16 7570,-2146.16 7566.5,-2156.16 7573.5,-2156.16"/>
</g>
<!-- out_proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge94" class="edge">
<title>out_proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M7570,-2077.79C7570,-2069.68 7570,-2060.89 7570,-2052.38"/>
<polygon fill="black" stroke="black" points="7573.5,-2052.21 7570,-2042.21 7566.5,-2052.21 7573.5,-2052.21"/>
</g>
<!-- qkv_2_0_2 -->
<g id="node69" class="node">
<title>qkv_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7906,-2338.91 7722,-2338.91 7722,-2270.91 7906,-2270.91 7906,-2338.91"/>
<text text-anchor="middle" x="7814" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7814" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7814" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7814" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_2 -->
<g id="node70" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7927,-2234.91 7701,-2234.91 7701,-2181.91 7927,-2181.91 7927,-2234.91"/>
<text text-anchor="middle" x="7814" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7814" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7814" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge65" class="edge">
<title>qkv_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M7814,-2270.86C7814,-2262.62 7814,-2253.75 7814,-2245.39"/>
<polygon fill="black" stroke="black" points="7817.5,-2245.14 7814,-2235.14 7810.5,-2245.14 7817.5,-2245.14"/>
</g>
<!-- out_proj_2_0_2 -->
<g id="node71" class="node">
<title>out_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7885,-2145.91 7701,-2145.91 7701,-2077.91 7885,-2077.91 7885,-2145.91"/>
<text text-anchor="middle" x="7793" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7793" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7793" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7793" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_2&#45;&gt;out_proj_2_0_2 -->
<g id="edge66" class="edge">
<title>attn_2_0_2&#45;&gt;out_proj_2_0_2</title>
<path fill="none" stroke="black" d="M7808.26,-2181.58C7806.52,-2173.73 7804.55,-2164.87 7802.62,-2156.19"/>
<polygon fill="black" stroke="black" points="7805.98,-2155.16 7800.39,-2146.16 7799.14,-2156.68 7805.98,-2155.16"/>
</g>
<!-- out_proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge95" class="edge">
<title>out_proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M7720.6,-2077.79C7698.58,-2067.72 7674.23,-2056.58 7651.64,-2046.25"/>
<polygon fill="black" stroke="black" points="7652.97,-2043.01 7642.42,-2042.03 7650.06,-2049.37 7652.97,-2043.01"/>
</g>
<!-- qkv_2_0_3 -->
<g id="node72" class="node">
<title>qkv_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8150,-2338.91 7966,-2338.91 7966,-2270.91 8150,-2270.91 8150,-2338.91"/>
<text text-anchor="middle" x="8058" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8058" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8058" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8058" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_3 -->
<g id="node73" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8171,-2234.91 7945,-2234.91 7945,-2181.91 8171,-2181.91 8171,-2234.91"/>
<text text-anchor="middle" x="8058" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8058" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8058" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge67" class="edge">
<title>qkv_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M8058,-2270.86C8058,-2262.62 8058,-2253.75 8058,-2245.39"/>
<polygon fill="black" stroke="black" points="8061.5,-2245.14 8058,-2235.14 8054.5,-2245.14 8061.5,-2245.14"/>
</g>
<!-- out_proj_2_0_3 -->
<g id="node74" class="node">
<title>out_proj_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8118,-2145.91 7934,-2145.91 7934,-2077.91 8118,-2077.91 8118,-2145.91"/>
<text text-anchor="middle" x="8026" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8026" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8026" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8026" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_3&#45;&gt;out_proj_2_0_3 -->
<g id="edge68" class="edge">
<title>attn_2_0_3&#45;&gt;out_proj_2_0_3</title>
<path fill="none" stroke="black" d="M8049.26,-2181.58C8046.57,-2173.64 8043.53,-2164.68 8040.56,-2155.91"/>
<polygon fill="black" stroke="black" points="8043.78,-2154.51 8037.26,-2146.16 8037.15,-2156.75 8043.78,-2154.51"/>
</g>
<!-- out_proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge96" class="edge">
<title>out_proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M7933.78,-2087.41C7920.45,-2084.15 7906.89,-2080.89 7894,-2077.91 7829.11,-2062.89 7756.63,-2047.34 7696.7,-2034.81"/>
<polygon fill="black" stroke="black" points="7697.32,-2031.37 7686.82,-2032.75 7695.89,-2038.22 7697.32,-2031.37"/>
</g>
<!-- qkv_2_1_0 -->
<g id="node75" class="node">
<title>qkv_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="4734,-2338.91 4550,-2338.91 4550,-2270.91 4734,-2270.91 4734,-2338.91"/>
<text text-anchor="middle" x="4642" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4642" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4642" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4642" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_0 -->
<g id="node76" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="4755,-2234.91 4529,-2234.91 4529,-2181.91 4755,-2181.91 4755,-2234.91"/>
<text text-anchor="middle" x="4642" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4642" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4642" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge69" class="edge">
<title>qkv_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M4642,-2270.86C4642,-2262.62 4642,-2253.75 4642,-2245.39"/>
<polygon fill="black" stroke="black" points="4645.5,-2245.14 4642,-2235.14 4638.5,-2245.14 4645.5,-2245.14"/>
</g>
<!-- out_proj_2_1_0 -->
<g id="node77" class="node">
<title>out_proj_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="4755,-2145.91 4571,-2145.91 4571,-2077.91 4755,-2077.91 4755,-2145.91"/>
<text text-anchor="middle" x="4663" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4663" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4663" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4663" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_0&#45;&gt;out_proj_2_1_0 -->
<g id="edge70" class="edge">
<title>attn_2_1_0&#45;&gt;out_proj_2_1_0</title>
<path fill="none" stroke="black" d="M4647.74,-2181.58C4649.48,-2173.73 4651.45,-2164.87 4653.38,-2156.19"/>
<polygon fill="black" stroke="black" points="4656.86,-2156.68 4655.61,-2146.16 4650.02,-2155.16 4656.86,-2156.68"/>
</g>
<!-- concat_dim_2_1 -->
<g id="node112" class="node">
<title>concat_dim_2_1</title>
<polygon fill="orange" stroke="black" points="5002.5,-2041.91 4769.5,-2041.91 4769.5,-1973.91 5002.5,-1973.91 5002.5,-2041.91"/>
<text text-anchor="middle" x="4886" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="4886" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="4886" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4886" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge97" class="edge">
<title>out_proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M4735.4,-2077.79C4757.42,-2067.72 4781.77,-2056.58 4804.36,-2046.25"/>
<polygon fill="black" stroke="black" points="4805.94,-2049.37 4813.58,-2042.03 4803.03,-2043.01 4805.94,-2049.37"/>
</g>
<!-- qkv_2_1_1 -->
<g id="node78" class="node">
<title>qkv_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4978,-2338.91 4794,-2338.91 4794,-2270.91 4978,-2270.91 4978,-2338.91"/>
<text text-anchor="middle" x="4886" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4886" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4886" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_1 -->
<g id="node79" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4999,-2234.91 4773,-2234.91 4773,-2181.91 4999,-2181.91 4999,-2234.91"/>
<text text-anchor="middle" x="4886" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4886" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge71" class="edge">
<title>qkv_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M4886,-2270.86C4886,-2262.62 4886,-2253.75 4886,-2245.39"/>
<polygon fill="black" stroke="black" points="4889.5,-2245.14 4886,-2235.14 4882.5,-2245.14 4889.5,-2245.14"/>
</g>
<!-- out_proj_2_1_1 -->
<g id="node80" class="node">
<title>out_proj_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="4978,-2145.91 4794,-2145.91 4794,-2077.91 4978,-2077.91 4978,-2145.91"/>
<text text-anchor="middle" x="4886" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4886" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4886" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_1&#45;&gt;out_proj_2_1_1 -->
<g id="edge72" class="edge">
<title>attn_2_1_1&#45;&gt;out_proj_2_1_1</title>
<path fill="none" stroke="black" d="M4886,-2181.58C4886,-2173.73 4886,-2164.87 4886,-2156.19"/>
<polygon fill="black" stroke="black" points="4889.5,-2156.16 4886,-2146.16 4882.5,-2156.16 4889.5,-2156.16"/>
</g>
<!-- out_proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge98" class="edge">
<title>out_proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M4886,-2077.79C4886,-2069.68 4886,-2060.89 4886,-2052.38"/>
<polygon fill="black" stroke="black" points="4889.5,-2052.21 4886,-2042.21 4882.5,-2052.21 4889.5,-2052.21"/>
</g>
<!-- qkv_2_1_2 -->
<g id="node81" class="node">
<title>qkv_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5222,-2338.91 5038,-2338.91 5038,-2270.91 5222,-2270.91 5222,-2338.91"/>
<text text-anchor="middle" x="5130" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5130" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5130" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5130" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_2 -->
<g id="node82" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5243,-2234.91 5017,-2234.91 5017,-2181.91 5243,-2181.91 5243,-2234.91"/>
<text text-anchor="middle" x="5130" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5130" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5130" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge73" class="edge">
<title>qkv_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M5130,-2270.86C5130,-2262.62 5130,-2253.75 5130,-2245.39"/>
<polygon fill="black" stroke="black" points="5133.5,-2245.14 5130,-2235.14 5126.5,-2245.14 5133.5,-2245.14"/>
</g>
<!-- out_proj_2_1_2 -->
<g id="node83" class="node">
<title>out_proj_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5201,-2145.91 5017,-2145.91 5017,-2077.91 5201,-2077.91 5201,-2145.91"/>
<text text-anchor="middle" x="5109" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5109" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5109" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5109" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_2&#45;&gt;out_proj_2_1_2 -->
<g id="edge74" class="edge">
<title>attn_2_1_2&#45;&gt;out_proj_2_1_2</title>
<path fill="none" stroke="black" d="M5124.26,-2181.58C5122.52,-2173.73 5120.55,-2164.87 5118.62,-2156.19"/>
<polygon fill="black" stroke="black" points="5121.98,-2155.16 5116.39,-2146.16 5115.14,-2156.68 5121.98,-2155.16"/>
</g>
<!-- out_proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge99" class="edge">
<title>out_proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M5036.6,-2077.79C5014.58,-2067.72 4990.23,-2056.58 4967.64,-2046.25"/>
<polygon fill="black" stroke="black" points="4968.97,-2043.01 4958.42,-2042.03 4966.06,-2049.37 4968.97,-2043.01"/>
</g>
<!-- qkv_2_1_3 -->
<g id="node84" class="node">
<title>qkv_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4490,-2338.91 4306,-2338.91 4306,-2270.91 4490,-2270.91 4490,-2338.91"/>
<text text-anchor="middle" x="4398" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4398" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4398" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4398" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_3 -->
<g id="node85" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4511,-2234.91 4285,-2234.91 4285,-2181.91 4511,-2181.91 4511,-2234.91"/>
<text text-anchor="middle" x="4398" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4398" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4398" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge75" class="edge">
<title>qkv_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M4398,-2270.86C4398,-2262.62 4398,-2253.75 4398,-2245.39"/>
<polygon fill="black" stroke="black" points="4401.5,-2245.14 4398,-2235.14 4394.5,-2245.14 4401.5,-2245.14"/>
</g>
<!-- out_proj_2_1_3 -->
<g id="node86" class="node">
<title>out_proj_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="4532,-2145.91 4348,-2145.91 4348,-2077.91 4532,-2077.91 4532,-2145.91"/>
<text text-anchor="middle" x="4440" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4440" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4440" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4440" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_3&#45;&gt;out_proj_2_1_3 -->
<g id="edge76" class="edge">
<title>attn_2_1_3&#45;&gt;out_proj_2_1_3</title>
<path fill="none" stroke="black" d="M4409.48,-2181.58C4413.08,-2173.47 4417.16,-2164.29 4421.14,-2155.34"/>
<polygon fill="black" stroke="black" points="4424.36,-2156.72 4425.22,-2146.16 4417.96,-2153.87 4424.36,-2156.72"/>
</g>
<!-- out_proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge100" class="edge">
<title>out_proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M4532.12,-2085.42C4542.19,-2082.8 4552.3,-2080.25 4562,-2077.91 4626.87,-2062.24 4699.5,-2046.6 4759.53,-2034.18"/>
<polygon fill="black" stroke="black" points="4760.35,-2037.58 4769.44,-2032.13 4758.93,-2030.73 4760.35,-2037.58"/>
</g>
<!-- qkv_2_2_0 -->
<g id="node87" class="node">
<title>qkv_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5710,-2338.91 5526,-2338.91 5526,-2270.91 5710,-2270.91 5710,-2338.91"/>
<text text-anchor="middle" x="5618" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5618" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5618" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5618" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_0 -->
<g id="node88" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5731,-2234.91 5505,-2234.91 5505,-2181.91 5731,-2181.91 5731,-2234.91"/>
<text text-anchor="middle" x="5618" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5618" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5618" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge77" class="edge">
<title>qkv_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M5618,-2270.86C5618,-2262.62 5618,-2253.75 5618,-2245.39"/>
<polygon fill="black" stroke="black" points="5621.5,-2245.14 5618,-2235.14 5614.5,-2245.14 5621.5,-2245.14"/>
</g>
<!-- out_proj_2_2_0 -->
<g id="node89" class="node">
<title>out_proj_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="5731,-2145.91 5547,-2145.91 5547,-2077.91 5731,-2077.91 5731,-2145.91"/>
<text text-anchor="middle" x="5639" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5639" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5639" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5639" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_0&#45;&gt;out_proj_2_2_0 -->
<g id="edge78" class="edge">
<title>attn_2_2_0&#45;&gt;out_proj_2_2_0</title>
<path fill="none" stroke="black" d="M5623.74,-2181.58C5625.48,-2173.73 5627.45,-2164.87 5629.38,-2156.19"/>
<polygon fill="black" stroke="black" points="5632.86,-2156.68 5631.61,-2146.16 5626.02,-2155.16 5632.86,-2156.68"/>
</g>
<!-- concat_dim_2_2 -->
<g id="node113" class="node">
<title>concat_dim_2_2</title>
<polygon fill="orange" stroke="black" points="5978.5,-2041.91 5745.5,-2041.91 5745.5,-1973.91 5978.5,-1973.91 5978.5,-2041.91"/>
<text text-anchor="middle" x="5862" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="5862" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="5862" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="5862" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge101" class="edge">
<title>out_proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5711.4,-2077.79C5733.42,-2067.72 5757.77,-2056.58 5780.36,-2046.25"/>
<polygon fill="black" stroke="black" points="5781.94,-2049.37 5789.58,-2042.03 5779.03,-2043.01 5781.94,-2049.37"/>
</g>
<!-- qkv_2_2_1 -->
<g id="node90" class="node">
<title>qkv_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5954,-2338.91 5770,-2338.91 5770,-2270.91 5954,-2270.91 5954,-2338.91"/>
<text text-anchor="middle" x="5862" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5862" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5862" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_1 -->
<g id="node91" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5975,-2234.91 5749,-2234.91 5749,-2181.91 5975,-2181.91 5975,-2234.91"/>
<text text-anchor="middle" x="5862" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5862" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge79" class="edge">
<title>qkv_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M5862,-2270.86C5862,-2262.62 5862,-2253.75 5862,-2245.39"/>
<polygon fill="black" stroke="black" points="5865.5,-2245.14 5862,-2235.14 5858.5,-2245.14 5865.5,-2245.14"/>
</g>
<!-- out_proj_2_2_1 -->
<g id="node92" class="node">
<title>out_proj_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="5954,-2145.91 5770,-2145.91 5770,-2077.91 5954,-2077.91 5954,-2145.91"/>
<text text-anchor="middle" x="5862" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5862" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5862" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_1&#45;&gt;out_proj_2_2_1 -->
<g id="edge80" class="edge">
<title>attn_2_2_1&#45;&gt;out_proj_2_2_1</title>
<path fill="none" stroke="black" d="M5862,-2181.58C5862,-2173.73 5862,-2164.87 5862,-2156.19"/>
<polygon fill="black" stroke="black" points="5865.5,-2156.16 5862,-2146.16 5858.5,-2156.16 5865.5,-2156.16"/>
</g>
<!-- out_proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge102" class="edge">
<title>out_proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5862,-2077.79C5862,-2069.68 5862,-2060.89 5862,-2052.38"/>
<polygon fill="black" stroke="black" points="5865.5,-2052.21 5862,-2042.21 5858.5,-2052.21 5865.5,-2052.21"/>
</g>
<!-- qkv_2_2_2 -->
<g id="node93" class="node">
<title>qkv_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6198,-2338.91 6014,-2338.91 6014,-2270.91 6198,-2270.91 6198,-2338.91"/>
<text text-anchor="middle" x="6106" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6106" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6106" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6106" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_2 -->
<g id="node94" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6219,-2234.91 5993,-2234.91 5993,-2181.91 6219,-2181.91 6219,-2234.91"/>
<text text-anchor="middle" x="6106" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6106" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6106" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge81" class="edge">
<title>qkv_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M6106,-2270.86C6106,-2262.62 6106,-2253.75 6106,-2245.39"/>
<polygon fill="black" stroke="black" points="6109.5,-2245.14 6106,-2235.14 6102.5,-2245.14 6109.5,-2245.14"/>
</g>
<!-- out_proj_2_2_2 -->
<g id="node95" class="node">
<title>out_proj_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6177,-2145.91 5993,-2145.91 5993,-2077.91 6177,-2077.91 6177,-2145.91"/>
<text text-anchor="middle" x="6085" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6085" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6085" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6085" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_2&#45;&gt;out_proj_2_2_2 -->
<g id="edge82" class="edge">
<title>attn_2_2_2&#45;&gt;out_proj_2_2_2</title>
<path fill="none" stroke="black" d="M6100.26,-2181.58C6098.52,-2173.73 6096.55,-2164.87 6094.62,-2156.19"/>
<polygon fill="black" stroke="black" points="6097.98,-2155.16 6092.39,-2146.16 6091.14,-2156.68 6097.98,-2155.16"/>
</g>
<!-- out_proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge103" class="edge">
<title>out_proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6012.6,-2077.79C5990.58,-2067.72 5966.23,-2056.58 5943.64,-2046.25"/>
<polygon fill="black" stroke="black" points="5944.97,-2043.01 5934.42,-2042.03 5942.06,-2049.37 5944.97,-2043.01"/>
</g>
<!-- qkv_2_2_3 -->
<g id="node96" class="node">
<title>qkv_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5466,-2338.91 5282,-2338.91 5282,-2270.91 5466,-2270.91 5466,-2338.91"/>
<text text-anchor="middle" x="5374" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5374" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5374" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5374" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_3 -->
<g id="node97" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5487,-2234.91 5261,-2234.91 5261,-2181.91 5487,-2181.91 5487,-2234.91"/>
<text text-anchor="middle" x="5374" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5374" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5374" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge83" class="edge">
<title>qkv_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M5374,-2270.86C5374,-2262.62 5374,-2253.75 5374,-2245.39"/>
<polygon fill="black" stroke="black" points="5377.5,-2245.14 5374,-2235.14 5370.5,-2245.14 5377.5,-2245.14"/>
</g>
<!-- out_proj_2_2_3 -->
<g id="node98" class="node">
<title>out_proj_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5497,-2145.91 5313,-2145.91 5313,-2077.91 5497,-2077.91 5497,-2145.91"/>
<text text-anchor="middle" x="5405" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5405" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5405" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5405" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_3&#45;&gt;out_proj_2_2_3 -->
<g id="edge84" class="edge">
<title>attn_2_2_3&#45;&gt;out_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5382.47,-2181.58C5385.08,-2173.64 5388.02,-2164.68 5390.89,-2155.91"/>
<polygon fill="black" stroke="black" points="5394.3,-2156.75 5394.09,-2146.16 5387.65,-2154.57 5394.3,-2156.75"/>
</g>
<!-- out_proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge104" class="edge">
<title>out_proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5497.2,-2087.61C5510.86,-2084.28 5524.79,-2080.95 5538,-2077.91 5602.9,-2062.95 5675.38,-2047.4 5735.31,-2034.86"/>
<polygon fill="black" stroke="black" points="5736.12,-2038.27 5745.2,-2032.8 5734.69,-2031.42 5736.12,-2038.27"/>
</g>
<!-- qkv_2_3_0 -->
<g id="node99" class="node">
<title>qkv_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6686,-2338.91 6502,-2338.91 6502,-2270.91 6686,-2270.91 6686,-2338.91"/>
<text text-anchor="middle" x="6594" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6594" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6594" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_0 -->
<g id="node100" class="node">
<title>attn_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6707,-2234.91 6481,-2234.91 6481,-2181.91 6707,-2181.91 6707,-2234.91"/>
<text text-anchor="middle" x="6594" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6594" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge85" class="edge">
<title>qkv_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M6594,-2270.86C6594,-2262.62 6594,-2253.75 6594,-2245.39"/>
<polygon fill="black" stroke="black" points="6597.5,-2245.14 6594,-2235.14 6590.5,-2245.14 6597.5,-2245.14"/>
</g>
<!-- out_proj_2_3_0 -->
<g id="node101" class="node">
<title>out_proj_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6686,-2145.91 6502,-2145.91 6502,-2077.91 6686,-2077.91 6686,-2145.91"/>
<text text-anchor="middle" x="6594" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6594" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6594" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_0&#45;&gt;out_proj_2_3_0 -->
<g id="edge86" class="edge">
<title>attn_2_3_0&#45;&gt;out_proj_2_3_0</title>
<path fill="none" stroke="black" d="M6594,-2181.58C6594,-2173.73 6594,-2164.87 6594,-2156.19"/>
<polygon fill="black" stroke="black" points="6597.5,-2156.16 6594,-2146.16 6590.5,-2156.16 6597.5,-2156.16"/>
</g>
<!-- concat_dim_2_3 -->
<g id="node114" class="node">
<title>concat_dim_2_3</title>
<polygon fill="orange" stroke="black" points="6710.5,-2041.91 6477.5,-2041.91 6477.5,-1973.91 6710.5,-1973.91 6710.5,-2041.91"/>
<text text-anchor="middle" x="6594" y="-2026.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="6594" y="-2011.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="6594" y="-1996.71" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="6594" y="-1981.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge105" class="edge">
<title>out_proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M6594,-2077.79C6594,-2069.68 6594,-2060.89 6594,-2052.38"/>
<polygon fill="black" stroke="black" points="6597.5,-2052.21 6594,-2042.21 6590.5,-2052.21 6597.5,-2052.21"/>
</g>
<!-- qkv_2_3_1 -->
<g id="node102" class="node">
<title>qkv_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="6930,-2338.91 6746,-2338.91 6746,-2270.91 6930,-2270.91 6930,-2338.91"/>
<text text-anchor="middle" x="6838" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6838" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6838" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6838" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_1 -->
<g id="node103" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="6951,-2234.91 6725,-2234.91 6725,-2181.91 6951,-2181.91 6951,-2234.91"/>
<text text-anchor="middle" x="6838" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6838" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6838" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge87" class="edge">
<title>qkv_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M6838,-2270.86C6838,-2262.62 6838,-2253.75 6838,-2245.39"/>
<polygon fill="black" stroke="black" points="6841.5,-2245.14 6838,-2235.14 6834.5,-2245.14 6841.5,-2245.14"/>
</g>
<!-- out_proj_2_3_1 -->
<g id="node104" class="node">
<title>out_proj_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="6909,-2145.91 6725,-2145.91 6725,-2077.91 6909,-2077.91 6909,-2145.91"/>
<text text-anchor="middle" x="6817" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6817" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6817" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6817" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_1&#45;&gt;out_proj_2_3_1 -->
<g id="edge88" class="edge">
<title>attn_2_3_1&#45;&gt;out_proj_2_3_1</title>
<path fill="none" stroke="black" d="M6832.26,-2181.58C6830.52,-2173.73 6828.55,-2164.87 6826.62,-2156.19"/>
<polygon fill="black" stroke="black" points="6829.98,-2155.16 6824.39,-2146.16 6823.14,-2156.68 6829.98,-2155.16"/>
</g>
<!-- out_proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge106" class="edge">
<title>out_proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M6744.6,-2077.79C6722.58,-2067.72 6698.23,-2056.58 6675.64,-2046.25"/>
<polygon fill="black" stroke="black" points="6676.97,-2043.01 6666.42,-2042.03 6674.06,-2049.37 6676.97,-2043.01"/>
</g>
<!-- qkv_2_3_2 -->
<g id="node105" class="node">
<title>qkv_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7174,-2338.91 6990,-2338.91 6990,-2270.91 7174,-2270.91 7174,-2338.91"/>
<text text-anchor="middle" x="7082" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7082" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7082" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7082" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_2 -->
<g id="node106" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7195,-2234.91 6969,-2234.91 6969,-2181.91 7195,-2181.91 7195,-2234.91"/>
<text text-anchor="middle" x="7082" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7082" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7082" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge89" class="edge">
<title>qkv_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M7082,-2270.86C7082,-2262.62 7082,-2253.75 7082,-2245.39"/>
<polygon fill="black" stroke="black" points="7085.5,-2245.14 7082,-2235.14 7078.5,-2245.14 7085.5,-2245.14"/>
</g>
<!-- out_proj_2_3_2 -->
<g id="node107" class="node">
<title>out_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7143,-2145.91 6959,-2145.91 6959,-2077.91 7143,-2077.91 7143,-2145.91"/>
<text text-anchor="middle" x="7051" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7051" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7051" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7051" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_2&#45;&gt;out_proj_2_3_2 -->
<g id="edge90" class="edge">
<title>attn_2_3_2&#45;&gt;out_proj_2_3_2</title>
<path fill="none" stroke="black" d="M7073.53,-2181.58C7070.92,-2173.64 7067.98,-2164.68 7065.11,-2155.91"/>
<polygon fill="black" stroke="black" points="7068.35,-2154.57 7061.91,-2146.16 7061.7,-2156.75 7068.35,-2154.57"/>
</g>
<!-- out_proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge107" class="edge">
<title>out_proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M6958.8,-2087.61C6945.14,-2084.28 6931.21,-2080.95 6918,-2077.91 6853.1,-2062.95 6780.62,-2047.4 6720.69,-2034.86"/>
<polygon fill="black" stroke="black" points="6721.31,-2031.42 6710.8,-2032.8 6719.88,-2038.27 6721.31,-2031.42"/>
</g>
<!-- qkv_2_3_3 -->
<g id="node108" class="node">
<title>qkv_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="6442,-2338.91 6258,-2338.91 6258,-2270.91 6442,-2270.91 6442,-2338.91"/>
<text text-anchor="middle" x="6350" y="-2323.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6350" y="-2308.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6350" y="-2293.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="6350" y="-2278.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_3 -->
<g id="node109" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="6463,-2234.91 6237,-2234.91 6237,-2181.91 6463,-2181.91 6463,-2234.91"/>
<text text-anchor="middle" x="6350" y="-2219.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6350" y="-2204.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6350" y="-2189.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge91" class="edge">
<title>qkv_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M6350,-2270.86C6350,-2262.62 6350,-2253.75 6350,-2245.39"/>
<polygon fill="black" stroke="black" points="6353.5,-2245.14 6350,-2235.14 6346.5,-2245.14 6353.5,-2245.14"/>
</g>
<!-- out_proj_2_3_3 -->
<g id="node110" class="node">
<title>out_proj_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="6463,-2145.91 6279,-2145.91 6279,-2077.91 6463,-2077.91 6463,-2145.91"/>
<text text-anchor="middle" x="6371" y="-2130.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6371" y="-2115.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6371" y="-2100.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="6371" y="-2085.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_3&#45;&gt;out_proj_2_3_3 -->
<g id="edge92" class="edge">
<title>attn_2_3_3&#45;&gt;out_proj_2_3_3</title>
<path fill="none" stroke="black" d="M6355.74,-2181.58C6357.48,-2173.73 6359.45,-2164.87 6361.38,-2156.19"/>
<polygon fill="black" stroke="black" points="6364.86,-2156.68 6363.61,-2146.16 6358.02,-2155.16 6364.86,-2156.68"/>
</g>
<!-- out_proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge108" class="edge">
<title>out_proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M6443.4,-2077.79C6465.42,-2067.72 6489.77,-2056.58 6512.36,-2046.25"/>
<polygon fill="black" stroke="black" points="6513.94,-2049.37 6521.58,-2042.03 6511.03,-2043.01 6513.94,-2049.37"/>
</g>
<!-- concat_heads_2 -->
<g id="node115" class="node">
<title>concat_heads_2</title>
<polygon fill="gold" stroke="black" points="6330,-1926.93 6126,-1926.93 6126,-1873.93 6330,-1873.93 6330,-1926.93"/>
<text text-anchor="middle" x="6228" y="-1911.73" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="6228" y="-1896.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6228" y="-1881.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge109" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M7453.38,-2002.11C7167.36,-1990.09 6446.5,-1958.22 6339,-1937.91 6328.13,-1935.85 6316.86,-1933.02 6305.84,-1929.83"/>
<polygon fill="black" stroke="black" points="6306.83,-1926.47 6296.25,-1926.95 6304.82,-1933.18 6306.83,-1926.47"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge110" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M5002.75,-1997.73C5258.27,-1977.65 5864.28,-1930.02 6115.69,-1910.26"/>
<polygon fill="black" stroke="black" points="6116.24,-1913.72 6125.94,-1909.45 6115.7,-1906.75 6116.24,-1913.72"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge111" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M5976.55,-1973.89C6025.69,-1959.73 6082.53,-1943.35 6129.72,-1929.75"/>
<polygon fill="black" stroke="black" points="6130.69,-1933.12 6139.33,-1926.98 6128.75,-1926.39 6130.69,-1933.12"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge112" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M6477.48,-1976.78C6433.89,-1965.14 6384.03,-1951.39 6339,-1937.91 6330.74,-1935.43 6322.16,-1932.78 6313.6,-1930.06"/>
<polygon fill="black" stroke="black" points="6314.55,-1926.69 6303.96,-1926.99 6312.42,-1933.36 6314.55,-1926.69"/>
</g>
<!-- res1_2 -->
<g id="node116" class="node">
<title>res1_2</title>
<polygon fill="lightcyan" stroke="black" points="6400.5,-1826.95 6207.5,-1826.95 6207.5,-1773.95 6400.5,-1773.95 6400.5,-1826.95"/>
<text text-anchor="middle" x="6304" y="-1811.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6304" y="-1796.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6304" y="-1781.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads_2&#45;&gt;res1_2 -->
<g id="edge114" class="edge">
<title>concat_heads_2&#45;&gt;res1_2</title>
<path fill="none" stroke="black" d="M6247.97,-1873.69C6257.13,-1861.87 6268.12,-1847.71 6277.92,-1835.07"/>
<polygon fill="black" stroke="black" points="6280.8,-1837.07 6284.17,-1827.02 6275.27,-1832.78 6280.8,-1837.07"/>
</g>
<!-- ln2_2 -->
<g id="node118" class="node">
<title>ln2_2</title>
<polygon fill="lightgray" stroke="black" points="6337.5,-1730.45 6144.5,-1730.45 6144.5,-1677.45 6337.5,-1677.45 6337.5,-1730.45"/>
<text text-anchor="middle" x="6241" y="-1715.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6241" y="-1700.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6241" y="-1685.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_2&#45;&gt;ln2_2 -->
<g id="edge115" class="edge">
<title>res1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M6286.78,-1773.63C6279.7,-1763.01 6271.39,-1750.55 6263.82,-1739.18"/>
<polygon fill="black" stroke="black" points="6266.65,-1737.12 6258.19,-1730.74 6260.83,-1741.01 6266.65,-1737.12"/>
</g>
<!-- res2_2 -->
<g id="node122" class="node">
<title>res2_2</title>
<polygon fill="lightcyan" stroke="black" points="6464.5,-1321.95 6271.5,-1321.95 6271.5,-1268.95 6464.5,-1268.95 6464.5,-1321.95"/>
<text text-anchor="middle" x="6368" y="-1306.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6368" y="-1291.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6368" y="-1276.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_2&#45;&gt;res2_2 -->
<g id="edge119" class="edge">
<title>res1_2&#45;&gt;res2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6325.35,-1773.67C6333.01,-1763.18 6340.97,-1750.56 6346,-1737.95 6368.83,-1680.67 6368,-1662.62 6368,-1600.95 6368,-1600.95 6368,-1600.95 6368,-1494.95 6368,-1438.13 6368,-1372.16 6368,-1332.4"/>
<polygon fill="black" stroke="black" points="6371.5,-1332.15 6368,-1322.15 6364.5,-1332.15 6371.5,-1332.15"/>
</g>
<!-- res2_1 -->
<g id="node117" class="node">
<title>res2_1</title>
<polygon fill="lightgrey" stroke="black" points="6412,-1918.43 6348,-1918.43 6348,-1882.43 6412,-1882.43 6412,-1918.43"/>
<text text-anchor="middle" x="6380" y="-1896.73" font-family="Times,serif" font-size="14.00">res2_1</text>
</g>
<!-- res2_1&#45;&gt;res1_2 -->
<g id="edge113" class="edge">
<title>res2_1&#45;&gt;res1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6366.76,-1882.36C6356.69,-1869.38 6342.52,-1851.11 6330.19,-1835.21"/>
<polygon fill="black" stroke="black" points="6332.83,-1832.91 6323.94,-1827.16 6327.3,-1837.2 6332.83,-1832.91"/>
</g>
<!-- ffn_col_2 -->
<g id="node119" class="node">
<title>ffn_col_2</title>
<polygon fill="lightgreen" stroke="black" points="6340,-1633.95 6138,-1633.95 6138,-1565.95 6340,-1565.95 6340,-1633.95"/>
<text text-anchor="middle" x="6239" y="-1618.75" font-family="Times,serif" font-size="14.00">FFN Column Parallel</text>
<text text-anchor="middle" x="6239" y="-1603.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="6239" y="-1588.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="6239" y="-1573.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2_2&#45;&gt;ffn_col_2 -->
<g id="edge116" class="edge">
<title>ln2_2&#45;&gt;ffn_col_2</title>
<path fill="none" stroke="black" d="M6240.5,-1677.21C6240.3,-1667.18 6240.07,-1655.41 6239.85,-1644.15"/>
<polygon fill="black" stroke="black" points="6243.34,-1643.96 6239.65,-1634.03 6236.35,-1644.09 6243.34,-1643.96"/>
</g>
<!-- gelu_2 -->
<g id="node120" class="node">
<title>gelu_2</title>
<polygon fill="lightyellow" stroke="black" points="6340,-1522.45 6138,-1522.45 6138,-1469.45 6340,-1469.45 6340,-1522.45"/>
<text text-anchor="middle" x="6239" y="-1507.25" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="6239" y="-1492.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="6239" y="-1477.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ffn_col_2&#45;&gt;gelu_2 -->
<g id="edge117" class="edge">
<title>ffn_col_2&#45;&gt;gelu_2</title>
<path fill="none" stroke="black" d="M6239,-1565.84C6239,-1555.28 6239,-1543.55 6239,-1532.81"/>
<polygon fill="black" stroke="black" points="6242.5,-1532.47 6239,-1522.47 6235.5,-1532.47 6242.5,-1532.47"/>
</g>
<!-- ffn_row_2 -->
<g id="node121" class="node">
<title>ffn_row_2</title>
<polygon fill="lightgreen" stroke="black" points="6337.5,-1425.95 6144.5,-1425.95 6144.5,-1357.95 6337.5,-1357.95 6337.5,-1425.95"/>
<text text-anchor="middle" x="6241" y="-1410.75" font-family="Times,serif" font-size="14.00">FFN Row Parallel</text>
<text text-anchor="middle" x="6241" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6241" y="-1380.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="6241" y="-1365.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- gelu_2&#45;&gt;ffn_row_2 -->
<g id="edge118" class="edge">
<title>gelu_2&#45;&gt;ffn_row_2</title>
<path fill="none" stroke="black" d="M6239.5,-1469.21C6239.7,-1459.18 6239.93,-1447.41 6240.15,-1436.15"/>
<polygon fill="black" stroke="black" points="6243.65,-1436.09 6240.35,-1426.03 6236.66,-1435.96 6243.65,-1436.09"/>
</g>
<!-- ffn_row_2&#45;&gt;res2_2 -->
<g id="edge120" class="edge">
<title>ffn_row_2&#45;&gt;res2_2</title>
<path fill="none" stroke="black" d="M6285.42,-1357.9C6298.33,-1348.3 6312.4,-1337.83 6325.2,-1328.3"/>
<polygon fill="black" stroke="black" points="6327.48,-1330.97 6333.41,-1322.19 6323.3,-1325.35 6327.48,-1330.97"/>
</g>
<!-- res1_3 -->
<g id="node177" class="node">
<title>res1_3</title>
<polygon fill="lightcyan" stroke="black" points="7266.5,-1232.95 7073.5,-1232.95 7073.5,-1179.95 7266.5,-1179.95 7266.5,-1232.95"/>
<text text-anchor="middle" x="7170" y="-1217.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7170" y="-1202.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7170" y="-1187.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_2&#45;&gt;res1_3 -->
<g id="edge173" class="edge">
<title>res2_2&#45;&gt;res1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6464.74,-1283.96C6615.68,-1267.59 6906.14,-1236.08 7063.09,-1219.05"/>
<polygon fill="black" stroke="black" points="7063.67,-1222.51 7073.23,-1217.95 7062.91,-1215.55 7063.67,-1222.51"/>
</g>
<!-- ln1_3 -->
<g id="node123" class="node">
<title>ln1_3</title>
<polygon fill="lightgray" stroke="black" points="8361.5,-2331.41 8168.5,-2331.41 8168.5,-2278.41 8361.5,-2278.41 8361.5,-2331.41"/>
<text text-anchor="middle" x="8265" y="-2316.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8265" y="-2301.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="8265" y="-2286.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_3_0_0 -->
<g id="node124" class="node">
<title>qkv_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9041,-1737.95 8857,-1737.95 8857,-1669.95 9041,-1669.95 9041,-1737.95"/>
<text text-anchor="middle" x="8949" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8949" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8949" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8949" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_0 -->
<g id="node125" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9062,-1626.45 8836,-1626.45 8836,-1573.45 9062,-1573.45 9062,-1626.45"/>
<text text-anchor="middle" x="8949" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8949" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8949" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge121" class="edge">
<title>qkv_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M8949,-1669.84C8949,-1659.28 8949,-1647.55 8949,-1636.81"/>
<polygon fill="black" stroke="black" points="8952.5,-1636.47 8949,-1626.47 8945.5,-1636.47 8952.5,-1636.47"/>
</g>
<!-- out_proj_3_0_0 -->
<g id="node126" class="node">
<title>out_proj_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9020,-1529.95 8836,-1529.95 8836,-1461.95 9020,-1461.95 9020,-1529.95"/>
<text text-anchor="middle" x="8928" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8928" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8928" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8928" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_0&#45;&gt;out_proj_3_0_0 -->
<g id="edge122" class="edge">
<title>attn_3_0_0&#45;&gt;out_proj_3_0_0</title>
<path fill="none" stroke="black" d="M8943.7,-1573.21C8941.64,-1563.18 8939.21,-1551.41 8936.89,-1540.15"/>
<polygon fill="black" stroke="black" points="8940.25,-1539.11 8934.81,-1530.03 8933.4,-1540.53 8940.25,-1539.11"/>
</g>
<!-- concat_dim_3_0 -->
<g id="node172" class="node">
<title>concat_dim_3_0</title>
<polygon fill="orange" stroke="black" points="8821.5,-1425.95 8588.5,-1425.95 8588.5,-1357.95 8821.5,-1357.95 8821.5,-1425.95"/>
<text text-anchor="middle" x="8705" y="-1410.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="8705" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="8705" y="-1380.75" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="8705" y="-1365.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge153" class="edge">
<title>out_proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M8855.6,-1461.84C8833.58,-1451.76 8809.23,-1440.63 8786.64,-1430.3"/>
<polygon fill="black" stroke="black" points="8787.97,-1427.05 8777.42,-1426.08 8785.06,-1433.42 8787.97,-1427.05"/>
</g>
<!-- qkv_3_0_1 -->
<g id="node127" class="node">
<title>qkv_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9285,-1737.95 9101,-1737.95 9101,-1669.95 9285,-1669.95 9285,-1737.95"/>
<text text-anchor="middle" x="9193" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9193" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9193" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9193" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_1 -->
<g id="node128" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9306,-1626.45 9080,-1626.45 9080,-1573.45 9306,-1573.45 9306,-1626.45"/>
<text text-anchor="middle" x="9193" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9193" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9193" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge123" class="edge">
<title>qkv_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M9193,-1669.84C9193,-1659.28 9193,-1647.55 9193,-1636.81"/>
<polygon fill="black" stroke="black" points="9196.5,-1636.47 9193,-1626.47 9189.5,-1636.47 9196.5,-1636.47"/>
</g>
<!-- out_proj_3_0_1 -->
<g id="node129" class="node">
<title>out_proj_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9254,-1529.95 9070,-1529.95 9070,-1461.95 9254,-1461.95 9254,-1529.95"/>
<text text-anchor="middle" x="9162" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9162" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9162" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9162" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_1&#45;&gt;out_proj_3_0_1 -->
<g id="edge124" class="edge">
<title>attn_3_0_1&#45;&gt;out_proj_3_0_1</title>
<path fill="none" stroke="black" d="M9185.18,-1573.21C9182.1,-1563.08 9178.48,-1551.17 9175.02,-1539.81"/>
<polygon fill="black" stroke="black" points="9178.31,-1538.58 9172.05,-1530.03 9171.61,-1540.61 9178.31,-1538.58"/>
</g>
<!-- out_proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge154" class="edge">
<title>out_proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M9069.8,-1471.65C9056.14,-1468.32 9042.21,-1465 9029,-1461.95 8964.1,-1447 8891.62,-1431.45 8831.69,-1418.91"/>
<polygon fill="black" stroke="black" points="8832.31,-1415.46 8821.8,-1416.85 8830.88,-1422.32 8832.31,-1415.46"/>
</g>
<!-- qkv_3_0_2 -->
<g id="node130" class="node">
<title>qkv_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8553,-1737.95 8369,-1737.95 8369,-1669.95 8553,-1669.95 8553,-1737.95"/>
<text text-anchor="middle" x="8461" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8461" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8461" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8461" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_2 -->
<g id="node131" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8574,-1626.45 8348,-1626.45 8348,-1573.45 8574,-1573.45 8574,-1626.45"/>
<text text-anchor="middle" x="8461" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8461" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8461" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge125" class="edge">
<title>qkv_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M8461,-1669.84C8461,-1659.28 8461,-1647.55 8461,-1636.81"/>
<polygon fill="black" stroke="black" points="8464.5,-1636.47 8461,-1626.47 8457.5,-1636.47 8464.5,-1636.47"/>
</g>
<!-- out_proj_3_0_2 -->
<g id="node132" class="node">
<title>out_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8574,-1529.95 8390,-1529.95 8390,-1461.95 8574,-1461.95 8574,-1529.95"/>
<text text-anchor="middle" x="8482" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8482" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8482" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8482" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_2&#45;&gt;out_proj_3_0_2 -->
<g id="edge126" class="edge">
<title>attn_3_0_2&#45;&gt;out_proj_3_0_2</title>
<path fill="none" stroke="black" d="M8466.3,-1573.21C8468.36,-1563.18 8470.79,-1551.41 8473.11,-1540.15"/>
<polygon fill="black" stroke="black" points="8476.6,-1540.53 8475.19,-1530.03 8469.75,-1539.11 8476.6,-1540.53"/>
</g>
<!-- out_proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge155" class="edge">
<title>out_proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M8554.4,-1461.84C8576.42,-1451.76 8600.77,-1440.63 8623.36,-1430.3"/>
<polygon fill="black" stroke="black" points="8624.94,-1433.42 8632.58,-1426.08 8622.03,-1427.05 8624.94,-1433.42"/>
</g>
<!-- qkv_3_0_3 -->
<g id="node133" class="node">
<title>qkv_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8797,-1737.95 8613,-1737.95 8613,-1669.95 8797,-1669.95 8797,-1737.95"/>
<text text-anchor="middle" x="8705" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8705" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8705" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8705" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_3 -->
<g id="node134" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8818,-1626.45 8592,-1626.45 8592,-1573.45 8818,-1573.45 8818,-1626.45"/>
<text text-anchor="middle" x="8705" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8705" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8705" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge127" class="edge">
<title>qkv_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M8705,-1669.84C8705,-1659.28 8705,-1647.55 8705,-1636.81"/>
<polygon fill="black" stroke="black" points="8708.5,-1636.47 8705,-1626.47 8701.5,-1636.47 8708.5,-1636.47"/>
</g>
<!-- out_proj_3_0_3 -->
<g id="node135" class="node">
<title>out_proj_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8797,-1529.95 8613,-1529.95 8613,-1461.95 8797,-1461.95 8797,-1529.95"/>
<text text-anchor="middle" x="8705" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8705" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8705" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8705" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_3&#45;&gt;out_proj_3_0_3 -->
<g id="edge128" class="edge">
<title>attn_3_0_3&#45;&gt;out_proj_3_0_3</title>
<path fill="none" stroke="black" d="M8705,-1573.21C8705,-1563.18 8705,-1551.41 8705,-1540.15"/>
<polygon fill="black" stroke="black" points="8708.5,-1540.03 8705,-1530.03 8701.5,-1540.03 8708.5,-1540.03"/>
</g>
<!-- out_proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge156" class="edge">
<title>out_proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M8705,-1461.84C8705,-1453.73 8705,-1444.94 8705,-1436.43"/>
<polygon fill="black" stroke="black" points="8708.5,-1436.25 8705,-1426.25 8701.5,-1436.25 8708.5,-1436.25"/>
</g>
<!-- qkv_3_1_0 -->
<g id="node136" class="node">
<title>qkv_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="10017,-1737.95 9833,-1737.95 9833,-1669.95 10017,-1669.95 10017,-1737.95"/>
<text text-anchor="middle" x="9925" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9925" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9925" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="9925" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_0 -->
<g id="node137" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="10038,-1626.45 9812,-1626.45 9812,-1573.45 10038,-1573.45 10038,-1626.45"/>
<text text-anchor="middle" x="9925" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9925" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9925" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge129" class="edge">
<title>qkv_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M9925,-1669.84C9925,-1659.28 9925,-1647.55 9925,-1636.81"/>
<polygon fill="black" stroke="black" points="9928.5,-1636.47 9925,-1626.47 9921.5,-1636.47 9928.5,-1636.47"/>
</g>
<!-- out_proj_3_1_0 -->
<g id="node138" class="node">
<title>out_proj_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="9996,-1529.95 9812,-1529.95 9812,-1461.95 9996,-1461.95 9996,-1529.95"/>
<text text-anchor="middle" x="9904" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9904" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9904" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="9904" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_0&#45;&gt;out_proj_3_1_0 -->
<g id="edge130" class="edge">
<title>attn_3_1_0&#45;&gt;out_proj_3_1_0</title>
<path fill="none" stroke="black" d="M9919.7,-1573.21C9917.64,-1563.18 9915.21,-1551.41 9912.89,-1540.15"/>
<polygon fill="black" stroke="black" points="9916.25,-1539.11 9910.81,-1530.03 9909.4,-1540.53 9916.25,-1539.11"/>
</g>
<!-- concat_dim_3_1 -->
<g id="node173" class="node">
<title>concat_dim_3_1</title>
<polygon fill="orange" stroke="black" points="9797.5,-1425.95 9564.5,-1425.95 9564.5,-1357.95 9797.5,-1357.95 9797.5,-1425.95"/>
<text text-anchor="middle" x="9681" y="-1410.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="9681" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="9681" y="-1380.75" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9681" y="-1365.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge157" class="edge">
<title>out_proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M9831.6,-1461.84C9809.58,-1451.76 9785.23,-1440.63 9762.64,-1430.3"/>
<polygon fill="black" stroke="black" points="9763.97,-1427.05 9753.42,-1426.08 9761.06,-1433.42 9763.97,-1427.05"/>
</g>
<!-- qkv_3_1_1 -->
<g id="node139" class="node">
<title>qkv_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10261,-1737.95 10077,-1737.95 10077,-1669.95 10261,-1669.95 10261,-1737.95"/>
<text text-anchor="middle" x="10169" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10169" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10169" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10169" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_1 -->
<g id="node140" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10282,-1626.45 10056,-1626.45 10056,-1573.45 10282,-1573.45 10282,-1626.45"/>
<text text-anchor="middle" x="10169" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10169" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10169" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge131" class="edge">
<title>qkv_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M10169,-1669.84C10169,-1659.28 10169,-1647.55 10169,-1636.81"/>
<polygon fill="black" stroke="black" points="10172.5,-1636.47 10169,-1626.47 10165.5,-1636.47 10172.5,-1636.47"/>
</g>
<!-- out_proj_3_1_1 -->
<g id="node141" class="node">
<title>out_proj_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10229,-1529.95 10045,-1529.95 10045,-1461.95 10229,-1461.95 10229,-1529.95"/>
<text text-anchor="middle" x="10137" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10137" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10137" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10137" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_1&#45;&gt;out_proj_3_1_1 -->
<g id="edge132" class="edge">
<title>attn_3_1_1&#45;&gt;out_proj_3_1_1</title>
<path fill="none" stroke="black" d="M10160.93,-1573.21C10157.75,-1563.08 10154.01,-1551.17 10150.44,-1539.81"/>
<polygon fill="black" stroke="black" points="10153.71,-1538.52 10147.38,-1530.03 10147.03,-1540.61 10153.71,-1538.52"/>
</g>
<!-- out_proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge158" class="edge">
<title>out_proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M10044.78,-1471.46C10031.45,-1468.19 10017.89,-1464.94 10005,-1461.95 9940.11,-1446.94 9867.63,-1431.39 9807.7,-1418.86"/>
<polygon fill="black" stroke="black" points="9808.32,-1415.41 9797.82,-1416.8 9806.89,-1422.27 9808.32,-1415.41"/>
</g>
<!-- qkv_3_1_2 -->
<g id="node142" class="node">
<title>qkv_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="9529,-1737.95 9345,-1737.95 9345,-1669.95 9529,-1669.95 9529,-1737.95"/>
<text text-anchor="middle" x="9437" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9437" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9437" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="9437" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_2 -->
<g id="node143" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="9550,-1626.45 9324,-1626.45 9324,-1573.45 9550,-1573.45 9550,-1626.45"/>
<text text-anchor="middle" x="9437" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9437" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9437" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge133" class="edge">
<title>qkv_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M9437,-1669.84C9437,-1659.28 9437,-1647.55 9437,-1636.81"/>
<polygon fill="black" stroke="black" points="9440.5,-1636.47 9437,-1626.47 9433.5,-1636.47 9440.5,-1636.47"/>
</g>
<!-- out_proj_3_1_2 -->
<g id="node144" class="node">
<title>out_proj_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="9550,-1529.95 9366,-1529.95 9366,-1461.95 9550,-1461.95 9550,-1529.95"/>
<text text-anchor="middle" x="9458" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9458" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9458" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="9458" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_2&#45;&gt;out_proj_3_1_2 -->
<g id="edge134" class="edge">
<title>attn_3_1_2&#45;&gt;out_proj_3_1_2</title>
<path fill="none" stroke="black" d="M9442.3,-1573.21C9444.36,-1563.18 9446.79,-1551.41 9449.11,-1540.15"/>
<polygon fill="black" stroke="black" points="9452.6,-1540.53 9451.19,-1530.03 9445.75,-1539.11 9452.6,-1540.53"/>
</g>
<!-- out_proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge159" class="edge">
<title>out_proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M9530.4,-1461.84C9552.42,-1451.76 9576.77,-1440.63 9599.36,-1430.3"/>
<polygon fill="black" stroke="black" points="9600.94,-1433.42 9608.58,-1426.08 9598.03,-1427.05 9600.94,-1433.42"/>
</g>
<!-- qkv_3_1_3 -->
<g id="node145" class="node">
<title>qkv_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="9773,-1737.95 9589,-1737.95 9589,-1669.95 9773,-1669.95 9773,-1737.95"/>
<text text-anchor="middle" x="9681" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9681" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9681" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="9681" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_3 -->
<g id="node146" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="9794,-1626.45 9568,-1626.45 9568,-1573.45 9794,-1573.45 9794,-1626.45"/>
<text text-anchor="middle" x="9681" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9681" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9681" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge135" class="edge">
<title>qkv_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M9681,-1669.84C9681,-1659.28 9681,-1647.55 9681,-1636.81"/>
<polygon fill="black" stroke="black" points="9684.5,-1636.47 9681,-1626.47 9677.5,-1636.47 9684.5,-1636.47"/>
</g>
<!-- out_proj_3_1_3 -->
<g id="node147" class="node">
<title>out_proj_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="9773,-1529.95 9589,-1529.95 9589,-1461.95 9773,-1461.95 9773,-1529.95"/>
<text text-anchor="middle" x="9681" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9681" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9681" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="9681" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_3&#45;&gt;out_proj_3_1_3 -->
<g id="edge136" class="edge">
<title>attn_3_1_3&#45;&gt;out_proj_3_1_3</title>
<path fill="none" stroke="black" d="M9681,-1573.21C9681,-1563.18 9681,-1551.41 9681,-1540.15"/>
<polygon fill="black" stroke="black" points="9684.5,-1540.03 9681,-1530.03 9677.5,-1540.03 9684.5,-1540.03"/>
</g>
<!-- out_proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge160" class="edge">
<title>out_proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M9681,-1461.84C9681,-1453.73 9681,-1444.94 9681,-1436.43"/>
<polygon fill="black" stroke="black" points="9684.5,-1436.25 9681,-1426.25 9677.5,-1436.25 9684.5,-1436.25"/>
</g>
<!-- qkv_3_2_0 -->
<g id="node148" class="node">
<title>qkv_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7089,-1737.95 6905,-1737.95 6905,-1669.95 7089,-1669.95 7089,-1737.95"/>
<text text-anchor="middle" x="6997" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6997" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6997" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="6997" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_0 -->
<g id="node149" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7110,-1626.45 6884,-1626.45 6884,-1573.45 7110,-1573.45 7110,-1626.45"/>
<text text-anchor="middle" x="6997" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6997" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6997" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge137" class="edge">
<title>qkv_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M6997,-1669.84C6997,-1659.28 6997,-1647.55 6997,-1636.81"/>
<polygon fill="black" stroke="black" points="7000.5,-1636.47 6997,-1626.47 6993.5,-1636.47 7000.5,-1636.47"/>
</g>
<!-- out_proj_3_2_0 -->
<g id="node150" class="node">
<title>out_proj_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7089,-1529.95 6905,-1529.95 6905,-1461.95 7089,-1461.95 7089,-1529.95"/>
<text text-anchor="middle" x="6997" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6997" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6997" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="6997" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_0&#45;&gt;out_proj_3_2_0 -->
<g id="edge138" class="edge">
<title>attn_3_2_0&#45;&gt;out_proj_3_2_0</title>
<path fill="none" stroke="black" d="M6997,-1573.21C6997,-1563.18 6997,-1551.41 6997,-1540.15"/>
<polygon fill="black" stroke="black" points="7000.5,-1540.03 6997,-1530.03 6993.5,-1540.03 7000.5,-1540.03"/>
</g>
<!-- concat_dim_3_2 -->
<g id="node174" class="node">
<title>concat_dim_3_2</title>
<polygon fill="orange" stroke="black" points="7113.5,-1425.95 6880.5,-1425.95 6880.5,-1357.95 7113.5,-1357.95 7113.5,-1425.95"/>
<text text-anchor="middle" x="6997" y="-1410.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="6997" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="6997" y="-1380.75" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6997" y="-1365.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge161" class="edge">
<title>out_proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M6997,-1461.84C6997,-1453.73 6997,-1444.94 6997,-1436.43"/>
<polygon fill="black" stroke="black" points="7000.5,-1436.25 6997,-1426.25 6993.5,-1436.25 7000.5,-1436.25"/>
</g>
<!-- qkv_3_2_1 -->
<g id="node151" class="node">
<title>qkv_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7333,-1737.95 7149,-1737.95 7149,-1669.95 7333,-1669.95 7333,-1737.95"/>
<text text-anchor="middle" x="7241" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7241" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7241" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="7241" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_1 -->
<g id="node152" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7354,-1626.45 7128,-1626.45 7128,-1573.45 7354,-1573.45 7354,-1626.45"/>
<text text-anchor="middle" x="7241" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7241" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7241" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge139" class="edge">
<title>qkv_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M7241,-1669.84C7241,-1659.28 7241,-1647.55 7241,-1636.81"/>
<polygon fill="black" stroke="black" points="7244.5,-1636.47 7241,-1626.47 7237.5,-1636.47 7244.5,-1636.47"/>
</g>
<!-- out_proj_3_2_1 -->
<g id="node153" class="node">
<title>out_proj_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="7312,-1529.95 7128,-1529.95 7128,-1461.95 7312,-1461.95 7312,-1529.95"/>
<text text-anchor="middle" x="7220" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7220" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7220" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="7220" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_1&#45;&gt;out_proj_3_2_1 -->
<g id="edge140" class="edge">
<title>attn_3_2_1&#45;&gt;out_proj_3_2_1</title>
<path fill="none" stroke="black" d="M7235.7,-1573.21C7233.64,-1563.18 7231.21,-1551.41 7228.89,-1540.15"/>
<polygon fill="black" stroke="black" points="7232.25,-1539.11 7226.81,-1530.03 7225.4,-1540.53 7232.25,-1539.11"/>
</g>
<!-- out_proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge162" class="edge">
<title>out_proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M7147.6,-1461.84C7125.58,-1451.76 7101.23,-1440.63 7078.64,-1430.3"/>
<polygon fill="black" stroke="black" points="7079.97,-1427.05 7069.42,-1426.08 7077.06,-1433.42 7079.97,-1427.05"/>
</g>
<!-- qkv_3_2_2 -->
<g id="node154" class="node">
<title>qkv_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6601,-1737.95 6417,-1737.95 6417,-1669.95 6601,-1669.95 6601,-1737.95"/>
<text text-anchor="middle" x="6509" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6509" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6509" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6509" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_2 -->
<g id="node155" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6622,-1626.45 6396,-1626.45 6396,-1573.45 6622,-1573.45 6622,-1626.45"/>
<text text-anchor="middle" x="6509" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6509" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6509" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge141" class="edge">
<title>qkv_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M6509,-1669.84C6509,-1659.28 6509,-1647.55 6509,-1636.81"/>
<polygon fill="black" stroke="black" points="6512.5,-1636.47 6509,-1626.47 6505.5,-1636.47 6512.5,-1636.47"/>
</g>
<!-- out_proj_3_2_2 -->
<g id="node156" class="node">
<title>out_proj_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6643,-1529.95 6459,-1529.95 6459,-1461.95 6643,-1461.95 6643,-1529.95"/>
<text text-anchor="middle" x="6551" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6551" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6551" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6551" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_2&#45;&gt;out_proj_3_2_2 -->
<g id="edge142" class="edge">
<title>attn_3_2_2&#45;&gt;out_proj_3_2_2</title>
<path fill="none" stroke="black" d="M6519.6,-1573.21C6523.81,-1562.98 6528.78,-1550.93 6533.5,-1539.46"/>
<polygon fill="black" stroke="black" points="6536.81,-1540.61 6537.38,-1530.03 6530.34,-1537.94 6536.81,-1540.61"/>
</g>
<!-- out_proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge163" class="edge">
<title>out_proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M6643.12,-1469.46C6653.19,-1466.85 6663.3,-1464.3 6673,-1461.95 6737.87,-1446.28 6810.5,-1430.64 6870.53,-1418.22"/>
<polygon fill="black" stroke="black" points="6871.35,-1421.63 6880.44,-1416.18 6869.93,-1414.77 6871.35,-1421.63"/>
</g>
<!-- qkv_3_2_3 -->
<g id="node157" class="node">
<title>qkv_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6845,-1737.95 6661,-1737.95 6661,-1669.95 6845,-1669.95 6845,-1737.95"/>
<text text-anchor="middle" x="6753" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6753" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6753" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6753" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_3 -->
<g id="node158" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6866,-1626.45 6640,-1626.45 6640,-1573.45 6866,-1573.45 6866,-1626.45"/>
<text text-anchor="middle" x="6753" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6753" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6753" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge143" class="edge">
<title>qkv_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M6753,-1669.84C6753,-1659.28 6753,-1647.55 6753,-1636.81"/>
<polygon fill="black" stroke="black" points="6756.5,-1636.47 6753,-1626.47 6749.5,-1636.47 6756.5,-1636.47"/>
</g>
<!-- out_proj_3_2_3 -->
<g id="node159" class="node">
<title>out_proj_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6866,-1529.95 6682,-1529.95 6682,-1461.95 6866,-1461.95 6866,-1529.95"/>
<text text-anchor="middle" x="6774" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6774" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6774" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6774" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_3&#45;&gt;out_proj_3_2_3 -->
<g id="edge144" class="edge">
<title>attn_3_2_3&#45;&gt;out_proj_3_2_3</title>
<path fill="none" stroke="black" d="M6758.3,-1573.21C6760.36,-1563.18 6762.79,-1551.41 6765.11,-1540.15"/>
<polygon fill="black" stroke="black" points="6768.6,-1540.53 6767.19,-1530.03 6761.75,-1539.11 6768.6,-1540.53"/>
</g>
<!-- out_proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge164" class="edge">
<title>out_proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M6846.4,-1461.84C6868.42,-1451.76 6892.77,-1440.63 6915.36,-1430.3"/>
<polygon fill="black" stroke="black" points="6916.94,-1433.42 6924.58,-1426.08 6914.03,-1427.05 6916.94,-1433.42"/>
</g>
<!-- qkv_3_3_0 -->
<g id="node160" class="node">
<title>qkv_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8065,-1737.95 7881,-1737.95 7881,-1669.95 8065,-1669.95 8065,-1737.95"/>
<text text-anchor="middle" x="7973" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7973" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7973" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7973" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_0 -->
<g id="node161" class="node">
<title>attn_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8086,-1626.45 7860,-1626.45 7860,-1573.45 8086,-1573.45 8086,-1626.45"/>
<text text-anchor="middle" x="7973" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7973" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7973" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge145" class="edge">
<title>qkv_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M7973,-1669.84C7973,-1659.28 7973,-1647.55 7973,-1636.81"/>
<polygon fill="black" stroke="black" points="7976.5,-1636.47 7973,-1626.47 7969.5,-1636.47 7976.5,-1636.47"/>
</g>
<!-- out_proj_3_3_0 -->
<g id="node162" class="node">
<title>out_proj_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8055,-1529.95 7871,-1529.95 7871,-1461.95 8055,-1461.95 8055,-1529.95"/>
<text text-anchor="middle" x="7963" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7963" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7963" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7963" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_0&#45;&gt;out_proj_3_3_0 -->
<g id="edge146" class="edge">
<title>attn_3_3_0&#45;&gt;out_proj_3_3_0</title>
<path fill="none" stroke="black" d="M7970.48,-1573.21C7969.49,-1563.18 7968.34,-1551.41 7967.24,-1540.15"/>
<polygon fill="black" stroke="black" points="7970.7,-1539.64 7966.24,-1530.03 7963.73,-1540.32 7970.7,-1539.64"/>
</g>
<!-- concat_dim_3_3 -->
<g id="node175" class="node">
<title>concat_dim_3_3</title>
<polygon fill="orange" stroke="black" points="7968.5,-1425.95 7735.5,-1425.95 7735.5,-1357.95 7968.5,-1357.95 7968.5,-1425.95"/>
<text text-anchor="middle" x="7852" y="-1410.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7852" y="-1395.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="7852" y="-1380.75" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="7852" y="-1365.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge165" class="edge">
<title>out_proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7926.96,-1461.84C7916.98,-1452.66 7906.03,-1442.6 7895.66,-1433.08"/>
<polygon fill="black" stroke="black" points="7897.97,-1430.44 7888.24,-1426.25 7893.23,-1435.6 7897.97,-1430.44"/>
</g>
<!-- qkv_3_3_1 -->
<g id="node163" class="node">
<title>qkv_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="8309,-1737.95 8125,-1737.95 8125,-1669.95 8309,-1669.95 8309,-1737.95"/>
<text text-anchor="middle" x="8217" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8217" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8217" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8217" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_1 -->
<g id="node164" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="8330,-1626.45 8104,-1626.45 8104,-1573.45 8330,-1573.45 8330,-1626.45"/>
<text text-anchor="middle" x="8217" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8217" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8217" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge147" class="edge">
<title>qkv_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M8217,-1669.84C8217,-1659.28 8217,-1647.55 8217,-1636.81"/>
<polygon fill="black" stroke="black" points="8220.5,-1636.47 8217,-1626.47 8213.5,-1636.47 8220.5,-1636.47"/>
</g>
<!-- out_proj_3_3_1 -->
<g id="node165" class="node">
<title>out_proj_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="8288,-1529.95 8104,-1529.95 8104,-1461.95 8288,-1461.95 8288,-1529.95"/>
<text text-anchor="middle" x="8196" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8196" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8196" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8196" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_1&#45;&gt;out_proj_3_3_1 -->
<g id="edge148" class="edge">
<title>attn_3_3_1&#45;&gt;out_proj_3_3_1</title>
<path fill="none" stroke="black" d="M8211.7,-1573.21C8209.64,-1563.18 8207.21,-1551.41 8204.89,-1540.15"/>
<polygon fill="black" stroke="black" points="8208.25,-1539.11 8202.81,-1530.03 8201.4,-1540.53 8208.25,-1539.11"/>
</g>
<!-- out_proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge166" class="edge">
<title>out_proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M8103.81,-1467.62C8063.66,-1455.71 8016.06,-1441.6 7973.11,-1428.86"/>
<polygon fill="black" stroke="black" points="7974.03,-1425.49 7963.45,-1426 7972.04,-1432.2 7974.03,-1425.49"/>
</g>
<!-- qkv_3_3_2 -->
<g id="node166" class="node">
<title>qkv_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7577,-1737.95 7393,-1737.95 7393,-1669.95 7577,-1669.95 7577,-1737.95"/>
<text text-anchor="middle" x="7485" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7485" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7485" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7485" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_2 -->
<g id="node167" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7598,-1626.45 7372,-1626.45 7372,-1573.45 7598,-1573.45 7598,-1626.45"/>
<text text-anchor="middle" x="7485" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7485" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7485" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge149" class="edge">
<title>qkv_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M7485,-1669.84C7485,-1659.28 7485,-1647.55 7485,-1636.81"/>
<polygon fill="black" stroke="black" points="7488.5,-1636.47 7485,-1626.47 7481.5,-1636.47 7488.5,-1636.47"/>
</g>
<!-- out_proj_3_3_2 -->
<g id="node168" class="node">
<title>out_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7608,-1529.95 7424,-1529.95 7424,-1461.95 7608,-1461.95 7608,-1529.95"/>
<text text-anchor="middle" x="7516" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7516" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7516" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7516" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_2&#45;&gt;out_proj_3_3_2 -->
<g id="edge150" class="edge">
<title>attn_3_3_2&#45;&gt;out_proj_3_3_2</title>
<path fill="none" stroke="black" d="M7492.82,-1573.21C7495.9,-1563.08 7499.52,-1551.17 7502.98,-1539.81"/>
<polygon fill="black" stroke="black" points="7506.39,-1540.61 7505.95,-1530.03 7499.69,-1538.58 7506.39,-1540.61"/>
</g>
<!-- out_proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge167" class="edge">
<title>out_proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7608.26,-1466.95C7646.93,-1455.21 7692.37,-1441.41 7733.47,-1428.94"/>
<polygon fill="black" stroke="black" points="7734.71,-1432.22 7743.27,-1425.96 7732.68,-1425.52 7734.71,-1432.22"/>
</g>
<!-- qkv_3_3_3 -->
<g id="node169" class="node">
<title>qkv_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="7821,-1737.95 7637,-1737.95 7637,-1669.95 7821,-1669.95 7821,-1737.95"/>
<text text-anchor="middle" x="7729" y="-1722.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7729" y="-1707.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7729" y="-1692.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="7729" y="-1677.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_3 -->
<g id="node170" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="7842,-1626.45 7616,-1626.45 7616,-1573.45 7842,-1573.45 7842,-1626.45"/>
<text text-anchor="middle" x="7729" y="-1611.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7729" y="-1596.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7729" y="-1581.25" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge151" class="edge">
<title>qkv_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M7729,-1669.84C7729,-1659.28 7729,-1647.55 7729,-1636.81"/>
<polygon fill="black" stroke="black" points="7732.5,-1636.47 7729,-1626.47 7725.5,-1636.47 7732.5,-1636.47"/>
</g>
<!-- out_proj_3_3_3 -->
<g id="node171" class="node">
<title>out_proj_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="7832,-1529.95 7648,-1529.95 7648,-1461.95 7832,-1461.95 7832,-1529.95"/>
<text text-anchor="middle" x="7740" y="-1514.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7740" y="-1499.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7740" y="-1484.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="7740" y="-1469.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_3&#45;&gt;out_proj_3_3_3 -->
<g id="edge152" class="edge">
<title>attn_3_3_3&#45;&gt;out_proj_3_3_3</title>
<path fill="none" stroke="black" d="M7731.78,-1573.21C7732.86,-1563.18 7734.13,-1551.41 7735.34,-1540.15"/>
<polygon fill="black" stroke="black" points="7738.84,-1540.34 7736.43,-1530.03 7731.88,-1539.59 7738.84,-1540.34"/>
</g>
<!-- out_proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge168" class="edge">
<title>out_proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7776.36,-1461.84C7786.44,-1452.66 7797.48,-1442.6 7807.94,-1433.08"/>
<polygon fill="black" stroke="black" points="7810.4,-1435.57 7815.44,-1426.25 7805.69,-1430.4 7810.4,-1435.57"/>
</g>
<!-- concat_heads_3 -->
<g id="node176" class="node">
<title>concat_heads_3</title>
<polygon fill="gold" stroke="black" points="7954,-1321.95 7750,-1321.95 7750,-1268.95 7954,-1268.95 7954,-1321.95"/>
<text text-anchor="middle" x="7852" y="-1306.75" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="7852" y="-1291.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7852" y="-1276.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge169" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M8588.18,-1378.01C8423.72,-1359.79 8125.95,-1326.8 7964.08,-1308.87"/>
<polygon fill="black" stroke="black" points="7964.42,-1305.39 7954.1,-1307.76 7963.65,-1312.34 7964.42,-1305.39"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge170" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M9564.15,-1384.92C9232.9,-1367.8 8290.64,-1319.12 7964.63,-1302.27"/>
<polygon fill="black" stroke="black" points="7964.4,-1298.76 7954.23,-1301.74 7964.04,-1305.75 7964.4,-1298.76"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge171" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M7113.64,-1378.06C7278.47,-1359.84 7577.51,-1326.79 7739.85,-1308.85"/>
<polygon fill="black" stroke="black" points="7740.31,-1312.32 7749.87,-1307.74 7739.55,-1305.36 7740.31,-1312.32"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge172" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M7852,-1357.9C7852,-1349.67 7852,-1340.8 7852,-1332.43"/>
<polygon fill="black" stroke="black" points="7855.5,-1332.19 7852,-1322.19 7848.5,-1332.19 7855.5,-1332.19"/>
</g>
<!-- concat_heads_3&#45;&gt;res1_3 -->
<g id="edge174" class="edge">
<title>concat_heads_3&#45;&gt;res1_3</title>
<path fill="none" stroke="black" d="M7749.9,-1281.43C7622.6,-1265.19 7406.04,-1237.56 7276.65,-1221.06"/>
<polygon fill="black" stroke="black" points="7277.09,-1217.59 7266.72,-1219.79 7276.2,-1224.53 7277.09,-1217.59"/>
</g>
<!-- ln2_3 -->
<g id="node178" class="node">
<title>ln2_3</title>
<polygon fill="lightgray" stroke="black" points="7204.5,-1136.45 7011.5,-1136.45 7011.5,-1083.45 7204.5,-1083.45 7204.5,-1136.45"/>
<text text-anchor="middle" x="7108" y="-1121.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7108" y="-1106.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7108" y="-1091.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_3&#45;&gt;ln2_3 -->
<g id="edge175" class="edge">
<title>res1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M7153.06,-1179.63C7146.09,-1169.01 7137.91,-1156.55 7130.45,-1145.18"/>
<polygon fill="black" stroke="black" points="7133.33,-1143.19 7124.92,-1136.74 7127.48,-1147.03 7133.33,-1143.19"/>
</g>
<!-- res2_3 -->
<g id="node182" class="node">
<title>res2_3</title>
<polygon fill="lightcyan" stroke="black" points="7331.5,-727.95 7138.5,-727.95 7138.5,-674.95 7331.5,-674.95 7331.5,-727.95"/>
<text text-anchor="middle" x="7235" y="-712.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7235" y="-697.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7235" y="-682.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_3&#45;&gt;res2_3 -->
<g id="edge179" class="edge">
<title>res1_3&#45;&gt;res2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7191.87,-1179.74C7199.71,-1169.26 7207.87,-1156.63 7213,-1143.95 7236.14,-1086.79 7235,-1068.62 7235,-1006.95 7235,-1006.95 7235,-1006.95 7235,-900.95 7235,-844.13 7235,-778.16 7235,-738.4"/>
<polygon fill="black" stroke="black" points="7238.5,-738.15 7235,-728.15 7231.5,-738.15 7238.5,-738.15"/>
</g>
<!-- ffn_col_3 -->
<g id="node179" class="node">
<title>ffn_col_3</title>
<polygon fill="lightgreen" stroke="black" points="7207,-1039.95 7005,-1039.95 7005,-971.95 7207,-971.95 7207,-1039.95"/>
<text text-anchor="middle" x="7106" y="-1024.75" font-family="Times,serif" font-size="14.00">FFN Column Parallel</text>
<text text-anchor="middle" x="7106" y="-1009.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="7106" y="-994.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7106" y="-979.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2_3&#45;&gt;ffn_col_3 -->
<g id="edge176" class="edge">
<title>ln2_3&#45;&gt;ffn_col_3</title>
<path fill="none" stroke="black" d="M7107.5,-1083.21C7107.3,-1073.18 7107.07,-1061.41 7106.85,-1050.15"/>
<polygon fill="black" stroke="black" points="7110.34,-1049.96 7106.65,-1040.03 7103.35,-1050.09 7110.34,-1049.96"/>
</g>
<!-- gelu_3 -->
<g id="node180" class="node">
<title>gelu_3</title>
<polygon fill="lightyellow" stroke="black" points="7207,-928.45 7005,-928.45 7005,-875.45 7207,-875.45 7207,-928.45"/>
<text text-anchor="middle" x="7106" y="-913.25" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="7106" y="-898.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="7106" y="-883.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ffn_col_3&#45;&gt;gelu_3 -->
<g id="edge177" class="edge">
<title>ffn_col_3&#45;&gt;gelu_3</title>
<path fill="none" stroke="black" d="M7106,-971.84C7106,-961.28 7106,-949.55 7106,-938.81"/>
<polygon fill="black" stroke="black" points="7109.5,-938.47 7106,-928.47 7102.5,-938.47 7109.5,-938.47"/>
</g>
<!-- ffn_row_3 -->
<g id="node181" class="node">
<title>ffn_row_3</title>
<polygon fill="lightgreen" stroke="black" points="7204.5,-831.95 7011.5,-831.95 7011.5,-763.95 7204.5,-763.95 7204.5,-831.95"/>
<text text-anchor="middle" x="7108" y="-816.75" font-family="Times,serif" font-size="14.00">FFN Row Parallel</text>
<text text-anchor="middle" x="7108" y="-801.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7108" y="-786.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7108" y="-771.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- gelu_3&#45;&gt;ffn_row_3 -->
<g id="edge178" class="edge">
<title>gelu_3&#45;&gt;ffn_row_3</title>
<path fill="none" stroke="black" d="M7106.5,-875.21C7106.7,-865.18 7106.93,-853.41 7107.15,-842.15"/>
<polygon fill="black" stroke="black" points="7110.65,-842.09 7107.35,-832.03 7103.66,-841.96 7110.65,-842.09"/>
</g>
<!-- ffn_row_3&#45;&gt;res2_3 -->
<g id="edge180" class="edge">
<title>ffn_row_3&#45;&gt;res2_3</title>
<path fill="none" stroke="black" d="M7152.42,-763.9C7165.33,-754.3 7179.4,-743.83 7192.2,-734.3"/>
<polygon fill="black" stroke="black" points="7194.48,-736.97 7200.41,-728.19 7190.3,-731.35 7194.48,-736.97"/>
</g>
<!-- res1_4 -->
<g id="node237" class="node">
<title>res1_4</title>
<polygon fill="lightcyan" stroke="black" points="8011.5,-638.95 7818.5,-638.95 7818.5,-585.95 8011.5,-585.95 8011.5,-638.95"/>
<text text-anchor="middle" x="7915" y="-623.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7915" y="-608.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7915" y="-593.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_3&#45;&gt;res1_4 -->
<g id="edge233" class="edge">
<title>res2_3&#45;&gt;res1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7331.71,-688.08C7457.76,-671.95 7677.53,-643.84 7808.32,-627.1"/>
<polygon fill="black" stroke="black" points="7808.88,-630.56 7818.35,-625.82 7807.99,-623.62 7808.88,-630.56"/>
</g>
<!-- ln1_4 -->
<g id="node183" class="node">
<title>ln1_4</title>
<polygon fill="lightgray" stroke="black" points="8572.5,-2331.41 8379.5,-2331.41 8379.5,-2278.41 8572.5,-2278.41 8572.5,-2331.41"/>
<text text-anchor="middle" x="8476" y="-2316.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8476" y="-2301.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="8476" y="-2286.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_4_0_0 -->
<g id="node184" class="node">
<title>qkv_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="9908,-1143.95 9724,-1143.95 9724,-1075.95 9908,-1075.95 9908,-1143.95"/>
<text text-anchor="middle" x="9816" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9816" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9816" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9816" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_0 -->
<g id="node185" class="node">
<title>attn_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="9929,-1032.45 9703,-1032.45 9703,-979.45 9929,-979.45 9929,-1032.45"/>
<text text-anchor="middle" x="9816" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9816" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9816" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge181" class="edge">
<title>qkv_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M9816,-1075.84C9816,-1065.28 9816,-1053.55 9816,-1042.81"/>
<polygon fill="black" stroke="black" points="9819.5,-1042.47 9816,-1032.47 9812.5,-1042.47 9819.5,-1042.47"/>
</g>
<!-- out_proj_4_0_0 -->
<g id="node186" class="node">
<title>out_proj_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="9887,-935.95 9703,-935.95 9703,-867.95 9887,-867.95 9887,-935.95"/>
<text text-anchor="middle" x="9795" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9795" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9795" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9795" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_0&#45;&gt;out_proj_4_0_0 -->
<g id="edge182" class="edge">
<title>attn_4_0_0&#45;&gt;out_proj_4_0_0</title>
<path fill="none" stroke="black" d="M9810.7,-979.21C9808.64,-969.18 9806.21,-957.41 9803.89,-946.15"/>
<polygon fill="black" stroke="black" points="9807.25,-945.11 9801.81,-936.03 9800.4,-946.53 9807.25,-945.11"/>
</g>
<!-- concat_dim_4_0 -->
<g id="node232" class="node">
<title>concat_dim_4_0</title>
<polygon fill="orange" stroke="black" points="9688.5,-831.95 9455.5,-831.95 9455.5,-763.95 9688.5,-763.95 9688.5,-831.95"/>
<text text-anchor="middle" x="9572" y="-816.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="9572" y="-801.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="9572" y="-786.75" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="9572" y="-771.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_0_0&#45;&gt;concat_dim_4_0 -->
<g id="edge213" class="edge">
<title>out_proj_4_0_0&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9722.6,-867.84C9700.58,-857.76 9676.23,-846.63 9653.64,-836.3"/>
<polygon fill="black" stroke="black" points="9654.97,-833.05 9644.42,-832.08 9652.06,-839.42 9654.97,-833.05"/>
</g>
<!-- qkv_4_0_1 -->
<g id="node187" class="node">
<title>qkv_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="10152,-1143.95 9968,-1143.95 9968,-1075.95 10152,-1075.95 10152,-1143.95"/>
<text text-anchor="middle" x="10060" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10060" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10060" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10060" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_1 -->
<g id="node188" class="node">
<title>attn_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="10173,-1032.45 9947,-1032.45 9947,-979.45 10173,-979.45 10173,-1032.45"/>
<text text-anchor="middle" x="10060" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10060" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10060" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge183" class="edge">
<title>qkv_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M10060,-1075.84C10060,-1065.28 10060,-1053.55 10060,-1042.81"/>
<polygon fill="black" stroke="black" points="10063.5,-1042.47 10060,-1032.47 10056.5,-1042.47 10063.5,-1042.47"/>
</g>
<!-- out_proj_4_0_1 -->
<g id="node189" class="node">
<title>out_proj_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="10121,-935.95 9937,-935.95 9937,-867.95 10121,-867.95 10121,-935.95"/>
<text text-anchor="middle" x="10029" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10029" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10029" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10029" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_1&#45;&gt;out_proj_4_0_1 -->
<g id="edge184" class="edge">
<title>attn_4_0_1&#45;&gt;out_proj_4_0_1</title>
<path fill="none" stroke="black" d="M10052.18,-979.21C10049.1,-969.08 10045.48,-957.17 10042.02,-945.81"/>
<polygon fill="black" stroke="black" points="10045.31,-944.58 10039.05,-936.03 10038.61,-946.61 10045.31,-944.58"/>
</g>
<!-- out_proj_4_0_1&#45;&gt;concat_dim_4_0 -->
<g id="edge214" class="edge">
<title>out_proj_4_0_1&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9936.8,-877.65C9923.14,-874.32 9909.21,-871 9896,-867.95 9831.1,-853 9758.62,-837.45 9698.69,-824.91"/>
<polygon fill="black" stroke="black" points="9699.31,-821.46 9688.8,-822.85 9697.88,-828.32 9699.31,-821.46"/>
</g>
<!-- qkv_4_0_2 -->
<g id="node190" class="node">
<title>qkv_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9420,-1143.95 9236,-1143.95 9236,-1075.95 9420,-1075.95 9420,-1143.95"/>
<text text-anchor="middle" x="9328" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9328" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9328" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9328" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_2 -->
<g id="node191" class="node">
<title>attn_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9441,-1032.45 9215,-1032.45 9215,-979.45 9441,-979.45 9441,-1032.45"/>
<text text-anchor="middle" x="9328" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9328" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9328" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge185" class="edge">
<title>qkv_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M9328,-1075.84C9328,-1065.28 9328,-1053.55 9328,-1042.81"/>
<polygon fill="black" stroke="black" points="9331.5,-1042.47 9328,-1032.47 9324.5,-1042.47 9331.5,-1042.47"/>
</g>
<!-- out_proj_4_0_2 -->
<g id="node192" class="node">
<title>out_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9441,-935.95 9257,-935.95 9257,-867.95 9441,-867.95 9441,-935.95"/>
<text text-anchor="middle" x="9349" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9349" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9349" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9349" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_2&#45;&gt;out_proj_4_0_2 -->
<g id="edge186" class="edge">
<title>attn_4_0_2&#45;&gt;out_proj_4_0_2</title>
<path fill="none" stroke="black" d="M9333.3,-979.21C9335.36,-969.18 9337.79,-957.41 9340.11,-946.15"/>
<polygon fill="black" stroke="black" points="9343.6,-946.53 9342.19,-936.03 9336.75,-945.11 9343.6,-946.53"/>
</g>
<!-- out_proj_4_0_2&#45;&gt;concat_dim_4_0 -->
<g id="edge215" class="edge">
<title>out_proj_4_0_2&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9421.4,-867.84C9443.42,-857.76 9467.77,-846.63 9490.36,-836.3"/>
<polygon fill="black" stroke="black" points="9491.94,-839.42 9499.58,-832.08 9489.03,-833.05 9491.94,-839.42"/>
</g>
<!-- qkv_4_0_3 -->
<g id="node193" class="node">
<title>qkv_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9664,-1143.95 9480,-1143.95 9480,-1075.95 9664,-1075.95 9664,-1143.95"/>
<text text-anchor="middle" x="9572" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9572" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9572" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9572" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_3 -->
<g id="node194" class="node">
<title>attn_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9685,-1032.45 9459,-1032.45 9459,-979.45 9685,-979.45 9685,-1032.45"/>
<text text-anchor="middle" x="9572" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9572" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9572" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge187" class="edge">
<title>qkv_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M9572,-1075.84C9572,-1065.28 9572,-1053.55 9572,-1042.81"/>
<polygon fill="black" stroke="black" points="9575.5,-1042.47 9572,-1032.47 9568.5,-1042.47 9575.5,-1042.47"/>
</g>
<!-- out_proj_4_0_3 -->
<g id="node195" class="node">
<title>out_proj_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9664,-935.95 9480,-935.95 9480,-867.95 9664,-867.95 9664,-935.95"/>
<text text-anchor="middle" x="9572" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9572" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9572" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9572" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_3&#45;&gt;out_proj_4_0_3 -->
<g id="edge188" class="edge">
<title>attn_4_0_3&#45;&gt;out_proj_4_0_3</title>
<path fill="none" stroke="black" d="M9572,-979.21C9572,-969.18 9572,-957.41 9572,-946.15"/>
<polygon fill="black" stroke="black" points="9575.5,-946.03 9572,-936.03 9568.5,-946.03 9575.5,-946.03"/>
</g>
<!-- out_proj_4_0_3&#45;&gt;concat_dim_4_0 -->
<g id="edge216" class="edge">
<title>out_proj_4_0_3&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9572,-867.84C9572,-859.73 9572,-850.94 9572,-842.43"/>
<polygon fill="black" stroke="black" points="9575.5,-842.25 9572,-832.25 9568.5,-842.25 9575.5,-842.25"/>
</g>
<!-- qkv_4_1_0 -->
<g id="node196" class="node">
<title>qkv_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="10884,-1143.95 10700,-1143.95 10700,-1075.95 10884,-1075.95 10884,-1143.95"/>
<text text-anchor="middle" x="10792" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10792" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10792" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10792" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_0 -->
<g id="node197" class="node">
<title>attn_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="10905,-1032.45 10679,-1032.45 10679,-979.45 10905,-979.45 10905,-1032.45"/>
<text text-anchor="middle" x="10792" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10792" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10792" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge189" class="edge">
<title>qkv_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M10792,-1075.84C10792,-1065.28 10792,-1053.55 10792,-1042.81"/>
<polygon fill="black" stroke="black" points="10795.5,-1042.47 10792,-1032.47 10788.5,-1042.47 10795.5,-1042.47"/>
</g>
<!-- out_proj_4_1_0 -->
<g id="node198" class="node">
<title>out_proj_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="10863,-935.95 10679,-935.95 10679,-867.95 10863,-867.95 10863,-935.95"/>
<text text-anchor="middle" x="10771" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10771" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10771" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10771" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_0&#45;&gt;out_proj_4_1_0 -->
<g id="edge190" class="edge">
<title>attn_4_1_0&#45;&gt;out_proj_4_1_0</title>
<path fill="none" stroke="black" d="M10786.7,-979.21C10784.64,-969.18 10782.21,-957.41 10779.89,-946.15"/>
<polygon fill="black" stroke="black" points="10783.25,-945.11 10777.81,-936.03 10776.4,-946.53 10783.25,-945.11"/>
</g>
<!-- concat_dim_4_1 -->
<g id="node233" class="node">
<title>concat_dim_4_1</title>
<polygon fill="orange" stroke="black" points="10664.5,-831.95 10431.5,-831.95 10431.5,-763.95 10664.5,-763.95 10664.5,-831.95"/>
<text text-anchor="middle" x="10548" y="-816.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="10548" y="-801.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="10548" y="-786.75" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10548" y="-771.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_1_0&#45;&gt;concat_dim_4_1 -->
<g id="edge217" class="edge">
<title>out_proj_4_1_0&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M10698.6,-867.84C10676.58,-857.76 10652.23,-846.63 10629.64,-836.3"/>
<polygon fill="black" stroke="black" points="10630.97,-833.05 10620.42,-832.08 10628.06,-839.42 10630.97,-833.05"/>
</g>
<!-- qkv_4_1_1 -->
<g id="node199" class="node">
<title>qkv_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="11128,-1143.95 10944,-1143.95 10944,-1075.95 11128,-1075.95 11128,-1143.95"/>
<text text-anchor="middle" x="11036" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11036" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11036" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="11036" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_1 -->
<g id="node200" class="node">
<title>attn_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="11149,-1032.45 10923,-1032.45 10923,-979.45 11149,-979.45 11149,-1032.45"/>
<text text-anchor="middle" x="11036" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11036" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11036" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge191" class="edge">
<title>qkv_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M11036,-1075.84C11036,-1065.28 11036,-1053.55 11036,-1042.81"/>
<polygon fill="black" stroke="black" points="11039.5,-1042.47 11036,-1032.47 11032.5,-1042.47 11039.5,-1042.47"/>
</g>
<!-- out_proj_4_1_1 -->
<g id="node201" class="node">
<title>out_proj_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="11096,-935.95 10912,-935.95 10912,-867.95 11096,-867.95 11096,-935.95"/>
<text text-anchor="middle" x="11004" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11004" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11004" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="11004" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_1&#45;&gt;out_proj_4_1_1 -->
<g id="edge192" class="edge">
<title>attn_4_1_1&#45;&gt;out_proj_4_1_1</title>
<path fill="none" stroke="black" d="M11027.93,-979.21C11024.75,-969.08 11021.01,-957.17 11017.44,-945.81"/>
<polygon fill="black" stroke="black" points="11020.71,-944.52 11014.38,-936.03 11014.03,-946.61 11020.71,-944.52"/>
</g>
<!-- out_proj_4_1_1&#45;&gt;concat_dim_4_1 -->
<g id="edge218" class="edge">
<title>out_proj_4_1_1&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M10911.78,-877.46C10898.45,-874.19 10884.89,-870.94 10872,-867.95 10807.11,-852.94 10734.63,-837.39 10674.7,-824.86"/>
<polygon fill="black" stroke="black" points="10675.32,-821.41 10664.82,-822.8 10673.89,-828.27 10675.32,-821.41"/>
</g>
<!-- qkv_4_1_2 -->
<g id="node202" class="node">
<title>qkv_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10396,-1143.95 10212,-1143.95 10212,-1075.95 10396,-1075.95 10396,-1143.95"/>
<text text-anchor="middle" x="10304" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10304" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10304" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10304" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_2 -->
<g id="node203" class="node">
<title>attn_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10417,-1032.45 10191,-1032.45 10191,-979.45 10417,-979.45 10417,-1032.45"/>
<text text-anchor="middle" x="10304" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10304" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10304" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge193" class="edge">
<title>qkv_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M10304,-1075.84C10304,-1065.28 10304,-1053.55 10304,-1042.81"/>
<polygon fill="black" stroke="black" points="10307.5,-1042.47 10304,-1032.47 10300.5,-1042.47 10307.5,-1042.47"/>
</g>
<!-- out_proj_4_1_2 -->
<g id="node204" class="node">
<title>out_proj_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10417,-935.95 10233,-935.95 10233,-867.95 10417,-867.95 10417,-935.95"/>
<text text-anchor="middle" x="10325" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10325" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10325" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10325" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_2&#45;&gt;out_proj_4_1_2 -->
<g id="edge194" class="edge">
<title>attn_4_1_2&#45;&gt;out_proj_4_1_2</title>
<path fill="none" stroke="black" d="M10309.3,-979.21C10311.36,-969.18 10313.79,-957.41 10316.11,-946.15"/>
<polygon fill="black" stroke="black" points="10319.6,-946.53 10318.19,-936.03 10312.75,-945.11 10319.6,-946.53"/>
</g>
<!-- out_proj_4_1_2&#45;&gt;concat_dim_4_1 -->
<g id="edge219" class="edge">
<title>out_proj_4_1_2&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M10397.4,-867.84C10419.42,-857.76 10443.77,-846.63 10466.36,-836.3"/>
<polygon fill="black" stroke="black" points="10467.94,-839.42 10475.58,-832.08 10465.03,-833.05 10467.94,-839.42"/>
</g>
<!-- qkv_4_1_3 -->
<g id="node205" class="node">
<title>qkv_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10640,-1143.95 10456,-1143.95 10456,-1075.95 10640,-1075.95 10640,-1143.95"/>
<text text-anchor="middle" x="10548" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10548" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10548" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10548" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_3 -->
<g id="node206" class="node">
<title>attn_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10661,-1032.45 10435,-1032.45 10435,-979.45 10661,-979.45 10661,-1032.45"/>
<text text-anchor="middle" x="10548" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10548" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10548" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge195" class="edge">
<title>qkv_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M10548,-1075.84C10548,-1065.28 10548,-1053.55 10548,-1042.81"/>
<polygon fill="black" stroke="black" points="10551.5,-1042.47 10548,-1032.47 10544.5,-1042.47 10551.5,-1042.47"/>
</g>
<!-- out_proj_4_1_3 -->
<g id="node207" class="node">
<title>out_proj_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10640,-935.95 10456,-935.95 10456,-867.95 10640,-867.95 10640,-935.95"/>
<text text-anchor="middle" x="10548" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10548" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10548" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10548" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_3&#45;&gt;out_proj_4_1_3 -->
<g id="edge196" class="edge">
<title>attn_4_1_3&#45;&gt;out_proj_4_1_3</title>
<path fill="none" stroke="black" d="M10548,-979.21C10548,-969.18 10548,-957.41 10548,-946.15"/>
<polygon fill="black" stroke="black" points="10551.5,-946.03 10548,-936.03 10544.5,-946.03 10551.5,-946.03"/>
</g>
<!-- out_proj_4_1_3&#45;&gt;concat_dim_4_1 -->
<g id="edge220" class="edge">
<title>out_proj_4_1_3&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M10548,-867.84C10548,-859.73 10548,-850.94 10548,-842.43"/>
<polygon fill="black" stroke="black" points="10551.5,-842.25 10548,-832.25 10544.5,-842.25 10551.5,-842.25"/>
</g>
<!-- qkv_4_2_0 -->
<g id="node208" class="node">
<title>qkv_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7956,-1143.95 7772,-1143.95 7772,-1075.95 7956,-1075.95 7956,-1143.95"/>
<text text-anchor="middle" x="7864" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7864" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7864" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7864" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_0 -->
<g id="node209" class="node">
<title>attn_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7977,-1032.45 7751,-1032.45 7751,-979.45 7977,-979.45 7977,-1032.45"/>
<text text-anchor="middle" x="7864" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7864" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7864" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge197" class="edge">
<title>qkv_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M7864,-1075.84C7864,-1065.28 7864,-1053.55 7864,-1042.81"/>
<polygon fill="black" stroke="black" points="7867.5,-1042.47 7864,-1032.47 7860.5,-1042.47 7867.5,-1042.47"/>
</g>
<!-- out_proj_4_2_0 -->
<g id="node210" class="node">
<title>out_proj_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7956,-935.95 7772,-935.95 7772,-867.95 7956,-867.95 7956,-935.95"/>
<text text-anchor="middle" x="7864" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7864" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7864" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7864" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_0&#45;&gt;out_proj_4_2_0 -->
<g id="edge198" class="edge">
<title>attn_4_2_0&#45;&gt;out_proj_4_2_0</title>
<path fill="none" stroke="black" d="M7864,-979.21C7864,-969.18 7864,-957.41 7864,-946.15"/>
<polygon fill="black" stroke="black" points="7867.5,-946.03 7864,-936.03 7860.5,-946.03 7867.5,-946.03"/>
</g>
<!-- concat_dim_4_2 -->
<g id="node234" class="node">
<title>concat_dim_4_2</title>
<polygon fill="orange" stroke="black" points="7980.5,-831.95 7747.5,-831.95 7747.5,-763.95 7980.5,-763.95 7980.5,-831.95"/>
<text text-anchor="middle" x="7864" y="-816.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7864" y="-801.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="7864" y="-786.75" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="7864" y="-771.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_2_0&#45;&gt;concat_dim_4_2 -->
<g id="edge221" class="edge">
<title>out_proj_4_2_0&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M7864,-867.84C7864,-859.73 7864,-850.94 7864,-842.43"/>
<polygon fill="black" stroke="black" points="7867.5,-842.25 7864,-832.25 7860.5,-842.25 7867.5,-842.25"/>
</g>
<!-- qkv_4_2_1 -->
<g id="node211" class="node">
<title>qkv_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="8200,-1143.95 8016,-1143.95 8016,-1075.95 8200,-1075.95 8200,-1143.95"/>
<text text-anchor="middle" x="8108" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8108" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8108" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="8108" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_1 -->
<g id="node212" class="node">
<title>attn_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="8221,-1032.45 7995,-1032.45 7995,-979.45 8221,-979.45 8221,-1032.45"/>
<text text-anchor="middle" x="8108" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8108" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8108" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge199" class="edge">
<title>qkv_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M8108,-1075.84C8108,-1065.28 8108,-1053.55 8108,-1042.81"/>
<polygon fill="black" stroke="black" points="8111.5,-1042.47 8108,-1032.47 8104.5,-1042.47 8111.5,-1042.47"/>
</g>
<!-- out_proj_4_2_1 -->
<g id="node213" class="node">
<title>out_proj_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="8179,-935.95 7995,-935.95 7995,-867.95 8179,-867.95 8179,-935.95"/>
<text text-anchor="middle" x="8087" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8087" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8087" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="8087" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_1&#45;&gt;out_proj_4_2_1 -->
<g id="edge200" class="edge">
<title>attn_4_2_1&#45;&gt;out_proj_4_2_1</title>
<path fill="none" stroke="black" d="M8102.7,-979.21C8100.64,-969.18 8098.21,-957.41 8095.89,-946.15"/>
<polygon fill="black" stroke="black" points="8099.25,-945.11 8093.81,-936.03 8092.4,-946.53 8099.25,-945.11"/>
</g>
<!-- out_proj_4_2_1&#45;&gt;concat_dim_4_2 -->
<g id="edge222" class="edge">
<title>out_proj_4_2_1&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M8014.6,-867.84C7992.58,-857.76 7968.23,-846.63 7945.64,-836.3"/>
<polygon fill="black" stroke="black" points="7946.97,-833.05 7936.42,-832.08 7944.06,-839.42 7946.97,-833.05"/>
</g>
<!-- qkv_4_2_2 -->
<g id="node214" class="node">
<title>qkv_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7468,-1143.95 7284,-1143.95 7284,-1075.95 7468,-1075.95 7468,-1143.95"/>
<text text-anchor="middle" x="7376" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7376" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7376" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="7376" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_2 -->
<g id="node215" class="node">
<title>attn_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7489,-1032.45 7263,-1032.45 7263,-979.45 7489,-979.45 7489,-1032.45"/>
<text text-anchor="middle" x="7376" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7376" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7376" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge201" class="edge">
<title>qkv_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M7376,-1075.84C7376,-1065.28 7376,-1053.55 7376,-1042.81"/>
<polygon fill="black" stroke="black" points="7379.5,-1042.47 7376,-1032.47 7372.5,-1042.47 7379.5,-1042.47"/>
</g>
<!-- out_proj_4_2_2 -->
<g id="node216" class="node">
<title>out_proj_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="7510,-935.95 7326,-935.95 7326,-867.95 7510,-867.95 7510,-935.95"/>
<text text-anchor="middle" x="7418" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7418" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7418" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="7418" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_2&#45;&gt;out_proj_4_2_2 -->
<g id="edge202" class="edge">
<title>attn_4_2_2&#45;&gt;out_proj_4_2_2</title>
<path fill="none" stroke="black" d="M7386.6,-979.21C7390.81,-968.98 7395.78,-956.93 7400.5,-945.46"/>
<polygon fill="black" stroke="black" points="7403.81,-946.61 7404.38,-936.03 7397.34,-943.94 7403.81,-946.61"/>
</g>
<!-- out_proj_4_2_2&#45;&gt;concat_dim_4_2 -->
<g id="edge223" class="edge">
<title>out_proj_4_2_2&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M7510.12,-875.46C7520.19,-872.85 7530.3,-870.3 7540,-867.95 7604.87,-852.28 7677.5,-836.64 7737.53,-824.22"/>
<polygon fill="black" stroke="black" points="7738.35,-827.63 7747.44,-822.18 7736.93,-820.77 7738.35,-827.63"/>
</g>
<!-- qkv_4_2_3 -->
<g id="node217" class="node">
<title>qkv_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7712,-1143.95 7528,-1143.95 7528,-1075.95 7712,-1075.95 7712,-1143.95"/>
<text text-anchor="middle" x="7620" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7620" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7620" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7620" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_3 -->
<g id="node218" class="node">
<title>attn_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7733,-1032.45 7507,-1032.45 7507,-979.45 7733,-979.45 7733,-1032.45"/>
<text text-anchor="middle" x="7620" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7620" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7620" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge203" class="edge">
<title>qkv_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M7620,-1075.84C7620,-1065.28 7620,-1053.55 7620,-1042.81"/>
<polygon fill="black" stroke="black" points="7623.5,-1042.47 7620,-1032.47 7616.5,-1042.47 7623.5,-1042.47"/>
</g>
<!-- out_proj_4_2_3 -->
<g id="node219" class="node">
<title>out_proj_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7733,-935.95 7549,-935.95 7549,-867.95 7733,-867.95 7733,-935.95"/>
<text text-anchor="middle" x="7641" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7641" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7641" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7641" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_3&#45;&gt;out_proj_4_2_3 -->
<g id="edge204" class="edge">
<title>attn_4_2_3&#45;&gt;out_proj_4_2_3</title>
<path fill="none" stroke="black" d="M7625.3,-979.21C7627.36,-969.18 7629.79,-957.41 7632.11,-946.15"/>
<polygon fill="black" stroke="black" points="7635.6,-946.53 7634.19,-936.03 7628.75,-945.11 7635.6,-946.53"/>
</g>
<!-- out_proj_4_2_3&#45;&gt;concat_dim_4_2 -->
<g id="edge224" class="edge">
<title>out_proj_4_2_3&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M7713.4,-867.84C7735.42,-857.76 7759.77,-846.63 7782.36,-836.3"/>
<polygon fill="black" stroke="black" points="7783.94,-839.42 7791.58,-832.08 7781.03,-833.05 7783.94,-839.42"/>
</g>
<!-- qkv_4_3_0 -->
<g id="node220" class="node">
<title>qkv_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8932,-1143.95 8748,-1143.95 8748,-1075.95 8932,-1075.95 8932,-1143.95"/>
<text text-anchor="middle" x="8840" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8840" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8840" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8840" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_0 -->
<g id="node221" class="node">
<title>attn_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8953,-1032.45 8727,-1032.45 8727,-979.45 8953,-979.45 8953,-1032.45"/>
<text text-anchor="middle" x="8840" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8840" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8840" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge205" class="edge">
<title>qkv_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M8840,-1075.84C8840,-1065.28 8840,-1053.55 8840,-1042.81"/>
<polygon fill="black" stroke="black" points="8843.5,-1042.47 8840,-1032.47 8836.5,-1042.47 8843.5,-1042.47"/>
</g>
<!-- out_proj_4_3_0 -->
<g id="node222" class="node">
<title>out_proj_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="8911,-935.95 8727,-935.95 8727,-867.95 8911,-867.95 8911,-935.95"/>
<text text-anchor="middle" x="8819" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8819" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8819" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8819" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_0&#45;&gt;out_proj_4_3_0 -->
<g id="edge206" class="edge">
<title>attn_4_3_0&#45;&gt;out_proj_4_3_0</title>
<path fill="none" stroke="black" d="M8834.7,-979.21C8832.64,-969.18 8830.21,-957.41 8827.89,-946.15"/>
<polygon fill="black" stroke="black" points="8831.25,-945.11 8825.81,-936.03 8824.4,-946.53 8831.25,-945.11"/>
</g>
<!-- concat_dim_4_3 -->
<g id="node235" class="node">
<title>concat_dim_4_3</title>
<polygon fill="orange" stroke="black" points="8833.5,-831.95 8600.5,-831.95 8600.5,-763.95 8833.5,-763.95 8833.5,-831.95"/>
<text text-anchor="middle" x="8717" y="-816.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="8717" y="-801.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="8717" y="-786.75" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="8717" y="-771.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_3_0&#45;&gt;concat_dim_4_3 -->
<g id="edge225" class="edge">
<title>out_proj_4_3_0&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M8785.88,-867.84C8776.8,-858.75 8766.85,-848.8 8757.4,-839.35"/>
<polygon fill="black" stroke="black" points="8759.85,-836.85 8750.3,-832.25 8754.9,-841.8 8759.85,-836.85"/>
</g>
<!-- qkv_4_3_1 -->
<g id="node223" class="node">
<title>qkv_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="9176,-1143.95 8992,-1143.95 8992,-1075.95 9176,-1075.95 9176,-1143.95"/>
<text text-anchor="middle" x="9084" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9084" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9084" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9084" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_1 -->
<g id="node224" class="node">
<title>attn_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="9197,-1032.45 8971,-1032.45 8971,-979.45 9197,-979.45 9197,-1032.45"/>
<text text-anchor="middle" x="9084" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9084" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9084" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge207" class="edge">
<title>qkv_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M9084,-1075.84C9084,-1065.28 9084,-1053.55 9084,-1042.81"/>
<polygon fill="black" stroke="black" points="9087.5,-1042.47 9084,-1032.47 9080.5,-1042.47 9087.5,-1042.47"/>
</g>
<!-- out_proj_4_3_1 -->
<g id="node225" class="node">
<title>out_proj_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="9144,-935.95 8960,-935.95 8960,-867.95 9144,-867.95 9144,-935.95"/>
<text text-anchor="middle" x="9052" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9052" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9052" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9052" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_1&#45;&gt;out_proj_4_3_1 -->
<g id="edge208" class="edge">
<title>attn_4_3_1&#45;&gt;out_proj_4_3_1</title>
<path fill="none" stroke="black" d="M9075.93,-979.21C9072.75,-969.08 9069.01,-957.17 9065.44,-945.81"/>
<polygon fill="black" stroke="black" points="9068.71,-944.52 9062.38,-936.03 9062.03,-946.61 9068.71,-944.52"/>
</g>
<!-- out_proj_4_3_1&#45;&gt;concat_dim_4_3 -->
<g id="edge226" class="edge">
<title>out_proj_4_3_1&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M8959.57,-872.81C8921.11,-861.1 8876,-847.36 8835.17,-834.93"/>
<polygon fill="black" stroke="black" points="8836.03,-831.54 8825.44,-831.97 8833.99,-838.23 8836.03,-831.54"/>
</g>
<!-- qkv_4_3_2 -->
<g id="node226" class="node">
<title>qkv_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8444,-1143.95 8260,-1143.95 8260,-1075.95 8444,-1075.95 8444,-1143.95"/>
<text text-anchor="middle" x="8352" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8352" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8352" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="8352" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_2 -->
<g id="node227" class="node">
<title>attn_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8465,-1032.45 8239,-1032.45 8239,-979.45 8465,-979.45 8465,-1032.45"/>
<text text-anchor="middle" x="8352" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8352" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8352" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge209" class="edge">
<title>qkv_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M8352,-1075.84C8352,-1065.28 8352,-1053.55 8352,-1042.81"/>
<polygon fill="black" stroke="black" points="8355.5,-1042.47 8352,-1032.47 8348.5,-1042.47 8355.5,-1042.47"/>
</g>
<!-- out_proj_4_3_2 -->
<g id="node228" class="node">
<title>out_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8475,-935.95 8291,-935.95 8291,-867.95 8475,-867.95 8475,-935.95"/>
<text text-anchor="middle" x="8383" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8383" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8383" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="8383" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_2&#45;&gt;out_proj_4_3_2 -->
<g id="edge210" class="edge">
<title>attn_4_3_2&#45;&gt;out_proj_4_3_2</title>
<path fill="none" stroke="black" d="M8359.82,-979.21C8362.9,-969.08 8366.52,-957.17 8369.98,-945.81"/>
<polygon fill="black" stroke="black" points="8373.39,-946.61 8372.95,-936.03 8366.69,-944.58 8373.39,-946.61"/>
</g>
<!-- out_proj_4_3_2&#45;&gt;concat_dim_4_3 -->
<g id="edge227" class="edge">
<title>out_proj_4_3_2&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M8475.15,-872.81C8513.49,-861.1 8558.48,-847.36 8599.18,-834.93"/>
<polygon fill="black" stroke="black" points="8600.34,-838.24 8608.88,-831.97 8598.29,-831.55 8600.34,-838.24"/>
</g>
<!-- qkv_4_3_3 -->
<g id="node229" class="node">
<title>qkv_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8688,-1143.95 8504,-1143.95 8504,-1075.95 8688,-1075.95 8688,-1143.95"/>
<text text-anchor="middle" x="8596" y="-1128.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8596" y="-1113.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8596" y="-1098.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8596" y="-1083.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_3 -->
<g id="node230" class="node">
<title>attn_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8709,-1032.45 8483,-1032.45 8483,-979.45 8709,-979.45 8709,-1032.45"/>
<text text-anchor="middle" x="8596" y="-1017.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8596" y="-1002.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8596" y="-987.25" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge211" class="edge">
<title>qkv_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M8596,-1075.84C8596,-1065.28 8596,-1053.55 8596,-1042.81"/>
<polygon fill="black" stroke="black" points="8599.5,-1042.47 8596,-1032.47 8592.5,-1042.47 8599.5,-1042.47"/>
</g>
<!-- out_proj_4_3_3 -->
<g id="node231" class="node">
<title>out_proj_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8698,-935.95 8514,-935.95 8514,-867.95 8698,-867.95 8698,-935.95"/>
<text text-anchor="middle" x="8606" y="-920.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8606" y="-905.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8606" y="-890.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8606" y="-875.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_3&#45;&gt;out_proj_4_3_3 -->
<g id="edge212" class="edge">
<title>attn_4_3_3&#45;&gt;out_proj_4_3_3</title>
<path fill="none" stroke="black" d="M8598.52,-979.21C8599.51,-969.18 8600.66,-957.41 8601.76,-946.15"/>
<polygon fill="black" stroke="black" points="8605.27,-946.32 8602.76,-936.03 8598.3,-945.64 8605.27,-946.32"/>
</g>
<!-- out_proj_4_3_3&#45;&gt;concat_dim_4_3 -->
<g id="edge228" class="edge">
<title>out_proj_4_3_3&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M8642.04,-867.84C8652.02,-858.66 8662.97,-848.6 8673.34,-839.08"/>
<polygon fill="black" stroke="black" points="8675.77,-841.6 8680.76,-832.25 8671.03,-836.44 8675.77,-841.6"/>
</g>
<!-- concat_heads_4 -->
<g id="node236" class="node">
<title>concat_heads_4</title>
<polygon fill="gold" stroke="black" points="8819,-727.95 8615,-727.95 8615,-674.95 8819,-674.95 8819,-727.95"/>
<text text-anchor="middle" x="8717" y="-712.75" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="8717" y="-697.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="8717" y="-682.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_4_0&#45;&gt;concat_heads_4 -->
<g id="edge229" class="edge">
<title>concat_dim_4_0&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M9455.36,-784.06C9290.53,-765.84 8991.49,-732.79 8829.15,-714.85"/>
<polygon fill="black" stroke="black" points="8829.45,-711.36 8819.13,-713.74 8828.69,-718.32 8829.45,-711.36"/>
</g>
<!-- concat_dim_4_1&#45;&gt;concat_heads_4 -->
<g id="edge230" class="edge">
<title>concat_dim_4_1&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M10431.38,-790.93C10100,-773.83 9155.8,-725.1 8829.53,-708.26"/>
<polygon fill="black" stroke="black" points="8829.29,-704.74 8819.12,-707.72 8828.93,-711.73 8829.29,-704.74"/>
</g>
<!-- concat_dim_4_2&#45;&gt;concat_heads_4 -->
<g id="edge231" class="edge">
<title>concat_dim_4_2&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M7980.82,-784.01C8145.28,-765.79 8443.05,-732.8 8604.92,-714.87"/>
<polygon fill="black" stroke="black" points="8605.35,-718.34 8614.9,-713.76 8604.58,-711.39 8605.35,-718.34"/>
</g>
<!-- concat_dim_4_3&#45;&gt;concat_heads_4 -->
<g id="edge232" class="edge">
<title>concat_dim_4_3&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M8717,-763.9C8717,-755.67 8717,-746.8 8717,-738.43"/>
<polygon fill="black" stroke="black" points="8720.5,-738.19 8717,-728.19 8713.5,-738.19 8720.5,-738.19"/>
</g>
<!-- concat_heads_4&#45;&gt;res1_4 -->
<g id="edge234" class="edge">
<title>concat_heads_4&#45;&gt;res1_4</title>
<path fill="none" stroke="black" d="M8614.61,-689.35C8462.14,-672.81 8176.78,-641.85 8021.79,-625.04"/>
<polygon fill="black" stroke="black" points="8022.09,-621.55 8011.77,-623.95 8021.34,-628.51 8022.09,-621.55"/>
</g>
<!-- ln2_4 -->
<g id="node238" class="node">
<title>ln2_4</title>
<polygon fill="lightgray" stroke="black" points="7947.5,-549.95 7754.5,-549.95 7754.5,-496.95 7947.5,-496.95 7947.5,-549.95"/>
<text text-anchor="middle" x="7851" y="-534.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7851" y="-519.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7851" y="-504.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_4&#45;&gt;ln2_4 -->
<g id="edge235" class="edge">
<title>res1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M7896.14,-585.82C7889.82,-577.22 7882.67,-567.5 7875.95,-558.37"/>
<polygon fill="black" stroke="black" points="7878.69,-556.18 7869.94,-550.2 7873.05,-560.33 7878.69,-556.18"/>
</g>
<!-- res2_4 -->
<g id="node242" class="node">
<title>res2_4</title>
<polygon fill="lightcyan" stroke="black" points="8010.5,-163.95 7817.5,-163.95 7817.5,-110.95 8010.5,-110.95 8010.5,-163.95"/>
<text text-anchor="middle" x="7914" y="-148.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7914" y="-133.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7914" y="-118.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_4&#45;&gt;res2_4 -->
<g id="edge239" class="edge">
<title>res1_4&#45;&gt;res2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7936.06,-585.94C7943.77,-575.38 7951.86,-562.66 7957,-549.95 7977.65,-498.96 7978,-482.97 7978,-427.95 7978,-427.95 7978,-427.95 7978,-329.45 7978,-271.15 7978.92,-253.98 7957,-199.95 7953.14,-190.45 7947.59,-180.97 7941.75,-172.4"/>
<polygon fill="black" stroke="black" points="7944.53,-170.27 7935.86,-164.17 7938.83,-174.34 7944.53,-170.27"/>
</g>
<!-- ffn_col_4 -->
<g id="node239" class="node">
<title>ffn_col_4</title>
<polygon fill="lightgreen" stroke="black" points="7950,-460.95 7748,-460.95 7748,-392.95 7950,-392.95 7950,-460.95"/>
<text text-anchor="middle" x="7849" y="-445.75" font-family="Times,serif" font-size="14.00">FFN Column Parallel</text>
<text text-anchor="middle" x="7849" y="-430.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="7849" y="-415.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7849" y="-400.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2_4&#45;&gt;ffn_col_4 -->
<g id="edge236" class="edge">
<title>ln2_4&#45;&gt;ffn_col_4</title>
<path fill="none" stroke="black" d="M7850.45,-496.63C7850.29,-488.78 7850.1,-479.92 7849.92,-471.24"/>
<polygon fill="black" stroke="black" points="7853.41,-471.13 7849.7,-461.2 7846.42,-471.28 7853.41,-471.13"/>
</g>
<!-- gelu_4 -->
<g id="node240" class="node">
<title>gelu_4</title>
<polygon fill="lightyellow" stroke="black" points="7950,-356.95 7748,-356.95 7748,-303.95 7950,-303.95 7950,-356.95"/>
<text text-anchor="middle" x="7849" y="-341.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="7849" y="-326.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=32768]</text>
<text text-anchor="middle" x="7849" y="-311.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ffn_col_4&#45;&gt;gelu_4 -->
<g id="edge237" class="edge">
<title>ffn_col_4&#45;&gt;gelu_4</title>
<path fill="none" stroke="black" d="M7849,-392.9C7849,-384.67 7849,-375.8 7849,-367.43"/>
<polygon fill="black" stroke="black" points="7852.5,-367.19 7849,-357.19 7845.5,-367.19 7852.5,-367.19"/>
</g>
<!-- ffn_row_4 -->
<g id="node241" class="node">
<title>ffn_row_4</title>
<polygon fill="lightgreen" stroke="black" points="7947.5,-267.95 7754.5,-267.95 7754.5,-199.95 7947.5,-199.95 7947.5,-267.95"/>
<text text-anchor="middle" x="7851" y="-252.75" font-family="Times,serif" font-size="14.00">FFN Row Parallel</text>
<text text-anchor="middle" x="7851" y="-237.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7851" y="-222.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7851" y="-207.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- gelu_4&#45;&gt;ffn_row_4 -->
<g id="edge238" class="edge">
<title>gelu_4&#45;&gt;ffn_row_4</title>
<path fill="none" stroke="black" d="M7849.55,-303.63C7849.71,-295.78 7849.9,-286.92 7850.08,-278.24"/>
<polygon fill="black" stroke="black" points="7853.58,-278.28 7850.3,-268.2 7846.59,-278.13 7853.58,-278.28"/>
</g>
<!-- ffn_row_4&#45;&gt;res2_4 -->
<g id="edge240" class="edge">
<title>ffn_row_4&#45;&gt;res2_4</title>
<path fill="none" stroke="black" d="M7873.03,-199.9C7878.89,-191.12 7885.22,-181.62 7891.12,-172.77"/>
<polygon fill="black" stroke="black" points="7894.21,-174.45 7896.84,-164.19 7888.38,-170.57 7894.21,-174.45"/>
</g>
<!-- output -->
<g id="node243" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="7914" cy="-37.48" rx="136.44" ry="37.45"/>
<text text-anchor="middle" x="7914" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7914" y="-33.78" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7914" y="-18.78" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_4&#45;&gt;output -->
<g id="edge241" class="edge">
<title>res2_4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7914,-110.71C7914,-102.89 7914,-94.03 7914,-85.27"/>
<polygon fill="black" stroke="black" points="7917.5,-85.1 7914,-75.1 7910.5,-85.1 7917.5,-85.1"/>
</g>
</g>
</svg>
