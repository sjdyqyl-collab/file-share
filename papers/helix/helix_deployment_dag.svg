<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_16GPU_Deployment Pages: 1 -->
<svg width="10296pt" height="5834pt"
 viewBox="0.00 0.00 10296.00 5834.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5830.36)">
<title>Helix_16GPU_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5830.36 10292,-5830.36 10292,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_1</title>
<path fill="#f0f0f0" stroke="#666666" d="M20,-4450.4C20,-4450.4 4891,-4450.4 4891,-4450.4 4897,-4450.4 4903,-4456.4 4903,-4462.4 4903,-4462.4 4903,-5694.62 4903,-5694.62 4903,-5700.62 4897,-5706.62 4891,-5706.62 4891,-5706.62 20,-5706.62 20,-5706.62 14,-5706.62 8,-5700.62 8,-5694.62 8,-5694.62 8,-4462.4 8,-4462.4 8,-4456.4 14,-4450.4 20,-4450.4"/>
<text text-anchor="middle" x="2455.5" y="-5691.42" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_2</title>
<path fill="#f0f0f0" stroke="#666666" d="M1868,-3011.18C1868,-3011.18 6739,-3011.18 6739,-3011.18 6745,-3011.18 6751,-3017.18 6751,-3023.18 6751,-3023.18 6751,-4255.4 6751,-4255.4 6751,-4261.4 6745,-4267.4 6739,-4267.4 6739,-4267.4 1868,-4267.4 1868,-4267.4 1862,-4267.4 1856,-4261.4 1856,-4255.4 1856,-4255.4 1856,-3023.18 1856,-3023.18 1856,-3017.18 1862,-3011.18 1868,-3011.18"/>
<text text-anchor="middle" x="4303.5" y="-4252.2" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_3</title>
<path fill="#f0f0f0" stroke="#666666" d="M3683,-1571.96C3683,-1571.96 8554,-1571.96 8554,-1571.96 8560,-1571.96 8566,-1577.96 8566,-1583.96 8566,-1583.96 8566,-2816.18 8566,-2816.18 8566,-2822.18 8560,-2828.18 8554,-2828.18 8554,-2828.18 3683,-2828.18 3683,-2828.18 3677,-2828.18 3671,-2822.18 3671,-2816.18 3671,-2816.18 3671,-1583.96 3671,-1583.96 3671,-1577.96 3677,-1571.96 3683,-1571.96"/>
<text text-anchor="middle" x="6118.5" y="-2812.98" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_4</title>
<path fill="#f0f0f0" stroke="#666666" d="M5397,-132.74C5397,-132.74 10268,-132.74 10268,-132.74 10274,-132.74 10280,-138.74 10280,-144.74 10280,-144.74 10280,-1376.96 10280,-1376.96 10280,-1382.96 10274,-1388.96 10268,-1388.96 10268,-1388.96 5397,-1388.96 5397,-1388.96 5391,-1388.96 5385,-1382.96 5385,-1376.96 5385,-1376.96 5385,-144.74 5385,-144.74 5385,-138.74 5391,-132.74 5397,-132.74"/>
<text text-anchor="middle" x="7832.5" y="-1373.76" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8f4fd" stroke="#2e86ab" stroke-width="2" cx="2588" cy="-5799.49" rx="147.57" ry="26.74"/>
<text text-anchor="middle" x="2588" y="-5803.29" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2588" y="-5788.29" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- mha_l1_g0 -->
<g id="node2" class="node">
<title>mha_l1_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M211.5,-5652.62C211.5,-5652.62 28.5,-5652.62 28.5,-5652.62 22.5,-5652.62 16.5,-5646.62 16.5,-5640.62 16.5,-5640.62 16.5,-5596.62 16.5,-5596.62 16.5,-5590.62 22.5,-5584.62 28.5,-5584.62 28.5,-5584.62 211.5,-5584.62 211.5,-5584.62 217.5,-5584.62 223.5,-5590.62 223.5,-5596.62 223.5,-5596.62 223.5,-5640.62 223.5,-5640.62 223.5,-5646.62 217.5,-5652.62 211.5,-5652.62"/>
<text text-anchor="middle" x="120" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 0</text>
<text text-anchor="middle" x="120" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="120" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="120" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_l1_g0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_l1_g0</title>
<path fill="none" stroke="black" d="M2486.26,-5819C2021.18,-5819 120,-5819 120,-5819 120,-5819 120,-5663.07 120,-5663.07"/>
<polygon fill="black" stroke="black" points="123.5,-5663.07 120,-5653.07 116.5,-5663.07 123.5,-5663.07"/>
</g>
<!-- mha_l1_g1 -->
<g id="node3" class="node">
<title>mha_l1_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M534.5,-5652.62C534.5,-5652.62 351.5,-5652.62 351.5,-5652.62 345.5,-5652.62 339.5,-5646.62 339.5,-5640.62 339.5,-5640.62 339.5,-5596.62 339.5,-5596.62 339.5,-5590.62 345.5,-5584.62 351.5,-5584.62 351.5,-5584.62 534.5,-5584.62 534.5,-5584.62 540.5,-5584.62 546.5,-5590.62 546.5,-5596.62 546.5,-5596.62 546.5,-5640.62 546.5,-5640.62 546.5,-5646.62 540.5,-5652.62 534.5,-5652.62"/>
<text text-anchor="middle" x="443" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 1</text>
<text text-anchor="middle" x="443" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="443" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="443" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- input&#45;&gt;mha_l1_g1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_l1_g1</title>
<path fill="none" stroke="black" d="M2457.05,-5812C1991.34,-5812 443,-5812 443,-5812 443,-5812 443,-5662.75 443,-5662.75"/>
<polygon fill="black" stroke="black" points="446.5,-5662.75 443,-5652.75 439.5,-5662.75 446.5,-5662.75"/>
</g>
<!-- mha_l1_g2 -->
<g id="node4" class="node">
<title>mha_l1_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M857.5,-5652.62C857.5,-5652.62 674.5,-5652.62 674.5,-5652.62 668.5,-5652.62 662.5,-5646.62 662.5,-5640.62 662.5,-5640.62 662.5,-5596.62 662.5,-5596.62 662.5,-5590.62 668.5,-5584.62 674.5,-5584.62 674.5,-5584.62 857.5,-5584.62 857.5,-5584.62 863.5,-5584.62 869.5,-5590.62 869.5,-5596.62 869.5,-5596.62 869.5,-5640.62 869.5,-5640.62 869.5,-5646.62 863.5,-5652.62 857.5,-5652.62"/>
<text text-anchor="middle" x="766" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 2</text>
<text text-anchor="middle" x="766" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="766" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="766" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- input&#45;&gt;mha_l1_g2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_l1_g2</title>
<path fill="none" stroke="black" d="M2444.27,-5806C2014.04,-5806 766,-5806 766,-5806 766,-5806 766,-5662.99 766,-5662.99"/>
<polygon fill="black" stroke="black" points="769.5,-5662.99 766,-5652.99 762.5,-5662.99 769.5,-5662.99"/>
</g>
<!-- mha_l1_g3 -->
<g id="node5" class="node">
<title>mha_l1_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M1180.5,-5652.62C1180.5,-5652.62 997.5,-5652.62 997.5,-5652.62 991.5,-5652.62 985.5,-5646.62 985.5,-5640.62 985.5,-5640.62 985.5,-5596.62 985.5,-5596.62 985.5,-5590.62 991.5,-5584.62 997.5,-5584.62 997.5,-5584.62 1180.5,-5584.62 1180.5,-5584.62 1186.5,-5584.62 1192.5,-5590.62 1192.5,-5596.62 1192.5,-5596.62 1192.5,-5640.62 1192.5,-5640.62 1192.5,-5646.62 1186.5,-5652.62 1180.5,-5652.62"/>
<text text-anchor="middle" x="1089" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 3</text>
<text text-anchor="middle" x="1089" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="1089" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="1089" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- input&#45;&gt;mha_l1_g3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;mha_l1_g3</title>
<path fill="none" stroke="black" d="M2440.17,-5799C2061.99,-5799 1089,-5799 1089,-5799 1089,-5799 1089,-5662.97 1089,-5662.97"/>
<polygon fill="black" stroke="black" points="1092.5,-5662.97 1089,-5652.97 1085.5,-5662.97 1092.5,-5662.97"/>
</g>
<!-- mha_l1_g4 -->
<g id="node6" class="node">
<title>mha_l1_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M1445.5,-5652.62C1445.5,-5652.62 1262.5,-5652.62 1262.5,-5652.62 1256.5,-5652.62 1250.5,-5646.62 1250.5,-5640.62 1250.5,-5640.62 1250.5,-5596.62 1250.5,-5596.62 1250.5,-5590.62 1256.5,-5584.62 1262.5,-5584.62 1262.5,-5584.62 1445.5,-5584.62 1445.5,-5584.62 1451.5,-5584.62 1457.5,-5590.62 1457.5,-5596.62 1457.5,-5596.62 1457.5,-5640.62 1457.5,-5640.62 1457.5,-5646.62 1451.5,-5652.62 1445.5,-5652.62"/>
<text text-anchor="middle" x="1354" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 4</text>
<text text-anchor="middle" x="1354" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="1354" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="1354" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- input&#45;&gt;mha_l1_g4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;mha_l1_g4</title>
<path fill="none" stroke="black" d="M2445.84,-5792C2121.36,-5792 1354,-5792 1354,-5792 1354,-5792 1354,-5662.88 1354,-5662.88"/>
<polygon fill="black" stroke="black" points="1357.5,-5662.88 1354,-5652.88 1350.5,-5662.88 1357.5,-5662.88"/>
</g>
<!-- mha_l1_g5 -->
<g id="node7" class="node">
<title>mha_l1_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M1768.5,-5652.62C1768.5,-5652.62 1585.5,-5652.62 1585.5,-5652.62 1579.5,-5652.62 1573.5,-5646.62 1573.5,-5640.62 1573.5,-5640.62 1573.5,-5596.62 1573.5,-5596.62 1573.5,-5590.62 1579.5,-5584.62 1585.5,-5584.62 1585.5,-5584.62 1768.5,-5584.62 1768.5,-5584.62 1774.5,-5584.62 1780.5,-5590.62 1780.5,-5596.62 1780.5,-5596.62 1780.5,-5640.62 1780.5,-5640.62 1780.5,-5646.62 1774.5,-5652.62 1768.5,-5652.62"/>
<text text-anchor="middle" x="1677" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 5</text>
<text text-anchor="middle" x="1677" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="1677" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="1677" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- input&#45;&gt;mha_l1_g5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;mha_l1_g5</title>
<path fill="none" stroke="black" d="M2459.89,-5786C2208.97,-5786 1677,-5786 1677,-5786 1677,-5786 1677,-5662.9 1677,-5662.9"/>
<polygon fill="black" stroke="black" points="1680.5,-5662.9 1677,-5652.9 1673.5,-5662.9 1680.5,-5662.9"/>
</g>
<!-- mha_l1_g6 -->
<g id="node8" class="node">
<title>mha_l1_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M2091.5,-5652.62C2091.5,-5652.62 1908.5,-5652.62 1908.5,-5652.62 1902.5,-5652.62 1896.5,-5646.62 1896.5,-5640.62 1896.5,-5640.62 1896.5,-5596.62 1896.5,-5596.62 1896.5,-5590.62 1902.5,-5584.62 1908.5,-5584.62 1908.5,-5584.62 2091.5,-5584.62 2091.5,-5584.62 2097.5,-5584.62 2103.5,-5590.62 2103.5,-5596.62 2103.5,-5596.62 2103.5,-5640.62 2103.5,-5640.62 2103.5,-5646.62 2097.5,-5652.62 2091.5,-5652.62"/>
<text text-anchor="middle" x="2000" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 6</text>
<text text-anchor="middle" x="2000" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="2000" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2000" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- input&#45;&gt;mha_l1_g6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;mha_l1_g6</title>
<path fill="none" stroke="black" d="M2492.22,-5779C2325.6,-5779 2000,-5779 2000,-5779 2000,-5779 2000,-5662.63 2000,-5662.63"/>
<polygon fill="black" stroke="black" points="2003.5,-5662.63 2000,-5652.63 1996.5,-5662.63 2003.5,-5662.63"/>
</g>
<!-- mha_l1_g7 -->
<g id="node9" class="node">
<title>mha_l1_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M2414.5,-5652.62C2414.5,-5652.62 2231.5,-5652.62 2231.5,-5652.62 2225.5,-5652.62 2219.5,-5646.62 2219.5,-5640.62 2219.5,-5640.62 2219.5,-5596.62 2219.5,-5596.62 2219.5,-5590.62 2225.5,-5584.62 2231.5,-5584.62 2231.5,-5584.62 2414.5,-5584.62 2414.5,-5584.62 2420.5,-5584.62 2426.5,-5590.62 2426.5,-5596.62 2426.5,-5596.62 2426.5,-5640.62 2426.5,-5640.62 2426.5,-5646.62 2420.5,-5652.62 2414.5,-5652.62"/>
<text text-anchor="middle" x="2323" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 7</text>
<text text-anchor="middle" x="2323" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="2323" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2323" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- input&#45;&gt;mha_l1_g7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;mha_l1_g7</title>
<path fill="none" stroke="black" d="M2462.36,-5785.25C2462.36,-5742.47 2462.36,-5618 2462.36,-5618 2462.36,-5618 2436.83,-5618 2436.83,-5618"/>
<polygon fill="black" stroke="black" points="2436.83,-5614.5 2426.83,-5618 2436.83,-5621.5 2436.83,-5614.5"/>
</g>
<!-- mha_l1_g8 -->
<g id="node10" class="node">
<title>mha_l1_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M2679.5,-5652.62C2679.5,-5652.62 2496.5,-5652.62 2496.5,-5652.62 2490.5,-5652.62 2484.5,-5646.62 2484.5,-5640.62 2484.5,-5640.62 2484.5,-5596.62 2484.5,-5596.62 2484.5,-5590.62 2490.5,-5584.62 2496.5,-5584.62 2496.5,-5584.62 2679.5,-5584.62 2679.5,-5584.62 2685.5,-5584.62 2691.5,-5590.62 2691.5,-5596.62 2691.5,-5596.62 2691.5,-5640.62 2691.5,-5640.62 2691.5,-5646.62 2685.5,-5652.62 2679.5,-5652.62"/>
<text text-anchor="middle" x="2588" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 8</text>
<text text-anchor="middle" x="2588" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="2588" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2588" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- input&#45;&gt;mha_l1_g8 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;mha_l1_g8</title>
<path fill="none" stroke="black" d="M2588,-5772.41C2588,-5772.41 2588,-5662.68 2588,-5662.68"/>
<polygon fill="black" stroke="black" points="2591.5,-5662.68 2588,-5652.68 2584.5,-5662.68 2591.5,-5662.68"/>
</g>
<!-- mha_l1_g9 -->
<g id="node11" class="node">
<title>mha_l1_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M3002.5,-5652.62C3002.5,-5652.62 2819.5,-5652.62 2819.5,-5652.62 2813.5,-5652.62 2807.5,-5646.62 2807.5,-5640.62 2807.5,-5640.62 2807.5,-5596.62 2807.5,-5596.62 2807.5,-5590.62 2813.5,-5584.62 2819.5,-5584.62 2819.5,-5584.62 3002.5,-5584.62 3002.5,-5584.62 3008.5,-5584.62 3014.5,-5590.62 3014.5,-5596.62 3014.5,-5596.62 3014.5,-5640.62 3014.5,-5640.62 3014.5,-5646.62 3008.5,-5652.62 3002.5,-5652.62"/>
<text text-anchor="middle" x="2911" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 9</text>
<text text-anchor="middle" x="2911" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="2911" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2911" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- input&#45;&gt;mha_l1_g9 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;mha_l1_g9</title>
<path fill="none" stroke="black" d="M2721.02,-5787.77C2721.02,-5749.25 2721.02,-5629 2721.02,-5629 2721.02,-5629 2797.4,-5629 2797.4,-5629"/>
<polygon fill="black" stroke="black" points="2797.4,-5632.5 2807.4,-5629 2797.4,-5625.5 2797.4,-5632.5"/>
</g>
<!-- mha_l1_g10 -->
<g id="node12" class="node">
<title>mha_l1_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M3325.5,-5652.62C3325.5,-5652.62 3142.5,-5652.62 3142.5,-5652.62 3136.5,-5652.62 3130.5,-5646.62 3130.5,-5640.62 3130.5,-5640.62 3130.5,-5596.62 3130.5,-5596.62 3130.5,-5590.62 3136.5,-5584.62 3142.5,-5584.62 3142.5,-5584.62 3325.5,-5584.62 3325.5,-5584.62 3331.5,-5584.62 3337.5,-5590.62 3337.5,-5596.62 3337.5,-5596.62 3337.5,-5640.62 3337.5,-5640.62 3337.5,-5646.62 3331.5,-5652.62 3325.5,-5652.62"/>
<text text-anchor="middle" x="3234" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 10</text>
<text text-anchor="middle" x="3234" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="3234" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3234" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- input&#45;&gt;mha_l1_g10 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;mha_l1_g10</title>
<path fill="none" stroke="black" d="M2690,-5780C2872.04,-5780 3234,-5780 3234,-5780 3234,-5780 3234,-5662.85 3234,-5662.85"/>
<polygon fill="black" stroke="black" points="3237.5,-5662.85 3234,-5652.85 3230.5,-5662.85 3237.5,-5662.85"/>
</g>
<!-- mha_l1_g11 -->
<g id="node13" class="node">
<title>mha_l1_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M3648.5,-5652.62C3648.5,-5652.62 3465.5,-5652.62 3465.5,-5652.62 3459.5,-5652.62 3453.5,-5646.62 3453.5,-5640.62 3453.5,-5640.62 3453.5,-5596.62 3453.5,-5596.62 3453.5,-5590.62 3459.5,-5584.62 3465.5,-5584.62 3465.5,-5584.62 3648.5,-5584.62 3648.5,-5584.62 3654.5,-5584.62 3660.5,-5590.62 3660.5,-5596.62 3660.5,-5596.62 3660.5,-5640.62 3660.5,-5640.62 3660.5,-5646.62 3654.5,-5652.62 3648.5,-5652.62"/>
<text text-anchor="middle" x="3557" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 11</text>
<text text-anchor="middle" x="3557" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="3557" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3557" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- input&#45;&gt;mha_l1_g11 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;mha_l1_g11</title>
<path fill="none" stroke="black" d="M2718.94,-5787C2983.54,-5787 3557,-5787 3557,-5787 3557,-5787 3557,-5662.7 3557,-5662.7"/>
<polygon fill="black" stroke="black" points="3560.5,-5662.7 3557,-5652.7 3553.5,-5662.7 3560.5,-5662.7"/>
</g>
<!-- mha_l1_g12 -->
<g id="node14" class="node">
<title>mha_l1_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M3913.5,-5652.62C3913.5,-5652.62 3730.5,-5652.62 3730.5,-5652.62 3724.5,-5652.62 3718.5,-5646.62 3718.5,-5640.62 3718.5,-5640.62 3718.5,-5596.62 3718.5,-5596.62 3718.5,-5590.62 3724.5,-5584.62 3730.5,-5584.62 3730.5,-5584.62 3913.5,-5584.62 3913.5,-5584.62 3919.5,-5584.62 3925.5,-5590.62 3925.5,-5596.62 3925.5,-5596.62 3925.5,-5640.62 3925.5,-5640.62 3925.5,-5646.62 3919.5,-5652.62 3913.5,-5652.62"/>
<text text-anchor="middle" x="3822" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 12</text>
<text text-anchor="middle" x="3822" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="3822" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3822" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- input&#45;&gt;mha_l1_g12 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;mha_l1_g12</title>
<path fill="none" stroke="black" d="M2733.79,-5795C3060.33,-5795 3822,-5795 3822,-5795 3822,-5795 3822,-5662.63 3822,-5662.63"/>
<polygon fill="black" stroke="black" points="3825.5,-5662.63 3822,-5652.63 3818.5,-5662.63 3825.5,-5662.63"/>
</g>
<!-- mha_l1_g13 -->
<g id="node15" class="node">
<title>mha_l1_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M4236.5,-5652.62C4236.5,-5652.62 4053.5,-5652.62 4053.5,-5652.62 4047.5,-5652.62 4041.5,-5646.62 4041.5,-5640.62 4041.5,-5640.62 4041.5,-5596.62 4041.5,-5596.62 4041.5,-5590.62 4047.5,-5584.62 4053.5,-5584.62 4053.5,-5584.62 4236.5,-5584.62 4236.5,-5584.62 4242.5,-5584.62 4248.5,-5590.62 4248.5,-5596.62 4248.5,-5596.62 4248.5,-5640.62 4248.5,-5640.62 4248.5,-5646.62 4242.5,-5652.62 4236.5,-5652.62"/>
<text text-anchor="middle" x="4145" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 13</text>
<text text-anchor="middle" x="4145" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="4145" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4145" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- input&#45;&gt;mha_l1_g13 -->
<g id="edge14" class="edge">
<title>input&#45;&gt;mha_l1_g13</title>
<path fill="none" stroke="black" d="M2734.83,-5803C3122.69,-5803 4145,-5803 4145,-5803 4145,-5803 4145,-5662.87 4145,-5662.87"/>
<polygon fill="black" stroke="black" points="4148.5,-5662.87 4145,-5652.87 4141.5,-5662.87 4148.5,-5662.87"/>
</g>
<!-- mha_l1_g14 -->
<g id="node16" class="node">
<title>mha_l1_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M4559.5,-5652.62C4559.5,-5652.62 4376.5,-5652.62 4376.5,-5652.62 4370.5,-5652.62 4364.5,-5646.62 4364.5,-5640.62 4364.5,-5640.62 4364.5,-5596.62 4364.5,-5596.62 4364.5,-5590.62 4370.5,-5584.62 4376.5,-5584.62 4376.5,-5584.62 4559.5,-5584.62 4559.5,-5584.62 4565.5,-5584.62 4571.5,-5590.62 4571.5,-5596.62 4571.5,-5596.62 4571.5,-5640.62 4571.5,-5640.62 4571.5,-5646.62 4565.5,-5652.62 4559.5,-5652.62"/>
<text text-anchor="middle" x="4468" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 14</text>
<text text-anchor="middle" x="4468" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="4468" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4468" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- input&#45;&gt;mha_l1_g14 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;mha_l1_g14</title>
<path fill="none" stroke="black" d="M2721.7,-5811C3151.2,-5811 4468,-5811 4468,-5811 4468,-5811 4468,-5663.01 4468,-5663.01"/>
<polygon fill="black" stroke="black" points="4471.5,-5663.01 4468,-5653.01 4464.5,-5663.01 4471.5,-5663.01"/>
</g>
<!-- mha_l1_g15 -->
<g id="node17" class="node">
<title>mha_l1_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M4882.5,-5652.62C4882.5,-5652.62 4699.5,-5652.62 4699.5,-5652.62 4693.5,-5652.62 4687.5,-5646.62 4687.5,-5640.62 4687.5,-5640.62 4687.5,-5596.62 4687.5,-5596.62 4687.5,-5590.62 4693.5,-5584.62 4699.5,-5584.62 4699.5,-5584.62 4882.5,-5584.62 4882.5,-5584.62 4888.5,-5584.62 4894.5,-5590.62 4894.5,-5596.62 4894.5,-5596.62 4894.5,-5640.62 4894.5,-5640.62 4894.5,-5646.62 4888.5,-5652.62 4882.5,-5652.62"/>
<text text-anchor="middle" x="4791" y="-5637.42" font-family="Times,serif" font-size="14.00">MHA Partition 15</text>
<text text-anchor="middle" x="4791" y="-5622.42" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="4791" y="-5607.42" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4791" y="-5592.42" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- input&#45;&gt;mha_l1_g15 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;mha_l1_g15</title>
<path fill="none" stroke="black" d="M2695.37,-5818C3137.11,-5818 4791,-5818 4791,-5818 4791,-5818 4791,-5662.9 4791,-5662.9"/>
<polygon fill="black" stroke="black" points="4794.5,-5662.9 4791,-5652.9 4787.5,-5662.9 4794.5,-5662.9"/>
</g>
<!-- ln1_l1 -->
<g id="node40" class="node">
<title>ln1_l1</title>
<ellipse fill="#e6e6fa" stroke="black" cx="3176" cy="-5084.75" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="3176" y="-5088.55" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="3176" y="-5073.55" font-family="Times,serif" font-size="14.00">L1</text>
</g>
<!-- input&#45;&gt;ln1_l1 -->
<g id="edge38" class="edge">
<title>input&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M2706.26,-5783.2C2706.26,-5676.7 2706.26,-5084 2706.26,-5084 2706.26,-5084 3083.91,-5084 3083.91,-5084"/>
<polygon fill="black" stroke="black" points="3083.91,-5087.5 3093.91,-5084 3083.91,-5080.5 3083.91,-5087.5"/>
</g>
<!-- mha_l1_g0&#45;&gt;mha_l1_g1 -->
<g id="edge297" class="edge">
<title>mha_l1_g0&#45;&gt;mha_l1_g1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M223.53,-5618C223.53,-5618 329.22,-5618 329.22,-5618"/>
<polygon fill="red" stroke="red" points="329.22,-5621.5 339.22,-5618 329.22,-5614.5 329.22,-5621.5"/>
</g>
<!-- mha_l1_g0&#45;&gt;mha_l1_g2 -->
<g id="edge298" class="edge">
<title>mha_l1_g0&#45;&gt;mha_l1_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M171.75,-5584.57C171.75,-5553.04 171.75,-5511 171.75,-5511 171.75,-5511 731.5,-5511 731.5,-5511 731.5,-5511 731.5,-5574.57 731.5,-5574.57"/>
<polygon fill="red" stroke="red" points="728,-5574.57 731.5,-5584.57 735,-5574.57 728,-5574.57"/>
<text text-anchor="middle" x="583" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g0&#45;&gt;mha_l1_g3 -->
<g id="edge299" class="edge">
<title>mha_l1_g0&#45;&gt;mha_l1_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M68.25,-5584.54C68.25,-5550.75 68.25,-5504 68.25,-5504 68.25,-5504 1001.25,-5504 1001.25,-5504 1001.25,-5504 1001.25,-5574.54 1001.25,-5574.54"/>
<polygon fill="red" stroke="red" points="997.75,-5574.54 1001.25,-5584.54 1004.75,-5574.54 997.75,-5574.54"/>
<text text-anchor="middle" x="688" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l1_hg0 -->
<g id="node18" class="node">
<title>concat_l1_hg0</title>
<path fill="#ffb347" stroke="black" d="M754.26,-5495.14C754.26,-5495.14 526.74,-5447.1 526.74,-5447.1 520.87,-5445.86 520.87,-5443.38 526.74,-5442.14 526.74,-5442.14 754.26,-5394.1 754.26,-5394.1 760.13,-5392.86 771.87,-5392.86 777.74,-5394.1 777.74,-5394.1 1005.26,-5442.14 1005.26,-5442.14 1011.13,-5443.38 1011.13,-5445.86 1005.26,-5447.1 1005.26,-5447.1 777.74,-5495.14 777.74,-5495.14 771.87,-5496.38 760.13,-5496.38 754.26,-5495.14"/>
<text text-anchor="middle" x="766" y="-5455.92" font-family="Times,serif" font-size="14.00">Concat Head Group 0</text>
<text text-anchor="middle" x="766" y="-5440.92" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="766" y="-5425.92" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l1_g0&#45;&gt;concat_l1_hg0 -->
<g id="edge17" class="edge">
<title>mha_l1_g0&#45;&gt;concat_l1_hg0</title>
<path fill="none" stroke="black" d="M120,-5584.54C120,-5533.72 120,-5444 120,-5444 120,-5444 507.63,-5444 507.63,-5444"/>
<polygon fill="black" stroke="black" points="507.63,-5447.5 517.63,-5444 507.63,-5440.5 507.63,-5447.5"/>
</g>
<!-- mha_l1_g1&#45;&gt;mha_l1_g2 -->
<g id="edge300" class="edge">
<title>mha_l1_g1&#45;&gt;mha_l1_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.53,-5618C546.53,-5618 652.22,-5618 652.22,-5618"/>
<polygon fill="red" stroke="red" points="652.22,-5621.5 662.22,-5618 652.22,-5614.5 652.22,-5621.5"/>
</g>
<!-- mha_l1_g1&#45;&gt;mha_l1_g3 -->
<g id="edge301" class="edge">
<title>mha_l1_g1&#45;&gt;mha_l1_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M536,-5584.5C536,-5554.98 536,-5517 536,-5517 536,-5517 993.38,-5517 993.38,-5517 993.38,-5517 993.38,-5574.5 993.38,-5574.5"/>
<polygon fill="red" stroke="red" points="989.88,-5574.5 993.38,-5584.5 996.88,-5574.5 989.88,-5574.5"/>
<text text-anchor="middle" x="793" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g1&#45;&gt;concat_l1_hg0 -->
<g id="edge18" class="edge">
<title>mha_l1_g1&#45;&gt;concat_l1_hg0</title>
<path fill="none" stroke="black" d="M525.5,-5584.24C525.5,-5584.24 525.5,-5456.86 525.5,-5456.86"/>
<polygon fill="black" stroke="black" points="529,-5456.86 525.5,-5446.86 522,-5456.86 529,-5456.86"/>
</g>
<!-- mha_l1_g2&#45;&gt;mha_l1_g3 -->
<g id="edge302" class="edge">
<title>mha_l1_g2&#45;&gt;mha_l1_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M869.53,-5618C869.53,-5618 975.22,-5618 975.22,-5618"/>
<polygon fill="red" stroke="red" points="975.22,-5621.5 985.22,-5618 975.22,-5614.5 975.22,-5621.5"/>
</g>
<!-- mha_l1_g2&#45;&gt;concat_l1_hg0 -->
<g id="edge19" class="edge">
<title>mha_l1_g2&#45;&gt;concat_l1_hg0</title>
<path fill="none" stroke="black" d="M800.5,-5584.24C800.5,-5584.24 800.5,-5500.46 800.5,-5500.46"/>
<polygon fill="black" stroke="black" points="804,-5500.46 800.5,-5490.46 797,-5500.46 804,-5500.46"/>
</g>
<!-- mha_l1_g3&#45;&gt;concat_l1_hg0 -->
<g id="edge20" class="edge">
<title>mha_l1_g3&#45;&gt;concat_l1_hg0</title>
<path fill="none" stroke="black" d="M1009.12,-5584.24C1009.12,-5584.24 1009.12,-5456.51 1009.12,-5456.51"/>
<polygon fill="black" stroke="black" points="1012.63,-5456.51 1009.12,-5446.51 1005.63,-5456.51 1012.63,-5456.51"/>
</g>
<!-- mha_l1_g4&#45;&gt;mha_l1_g5 -->
<g id="edge303" class="edge">
<title>mha_l1_g4&#45;&gt;mha_l1_g5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1457.53,-5618C1457.53,-5618 1563.22,-5618 1563.22,-5618"/>
<polygon fill="red" stroke="red" points="1563.22,-5621.5 1573.22,-5618 1563.22,-5614.5 1563.22,-5621.5"/>
</g>
<!-- mha_l1_g4&#45;&gt;mha_l1_g6 -->
<g id="edge304" class="edge">
<title>mha_l1_g4&#45;&gt;mha_l1_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1426.88,-5584.49C1426.88,-5559.89 1426.88,-5531 1426.88,-5531 1426.88,-5531 1965.5,-5531 1965.5,-5531 1965.5,-5531 1965.5,-5574.49 1965.5,-5574.49"/>
<polygon fill="red" stroke="red" points="1962,-5574.49 1965.5,-5584.49 1969,-5574.49 1962,-5574.49"/>
<text text-anchor="middle" x="1796" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g4&#45;&gt;mha_l1_g7 -->
<g id="edge305" class="edge">
<title>mha_l1_g4&#45;&gt;mha_l1_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1365.62,-5584.46C1365.62,-5557.36 1365.62,-5524 1365.62,-5524 1365.62,-5524 2235.25,-5524 2235.25,-5524 2235.25,-5524 2235.25,-5574.46 2235.25,-5574.46"/>
<polygon fill="red" stroke="red" points="2231.75,-5574.46 2235.25,-5584.46 2238.75,-5574.46 2231.75,-5574.46"/>
<text text-anchor="middle" x="1999" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l1_hg1 -->
<g id="node19" class="node">
<title>concat_l1_hg1</title>
<path fill="#ffb347" stroke="black" d="M1988.26,-5495.14C1988.26,-5495.14 1760.74,-5447.1 1760.74,-5447.1 1754.87,-5445.86 1754.87,-5443.38 1760.74,-5442.14 1760.74,-5442.14 1988.26,-5394.1 1988.26,-5394.1 1994.13,-5392.86 2005.87,-5392.86 2011.74,-5394.1 2011.74,-5394.1 2239.26,-5442.14 2239.26,-5442.14 2245.13,-5443.38 2245.13,-5445.86 2239.26,-5447.1 2239.26,-5447.1 2011.74,-5495.14 2011.74,-5495.14 2005.87,-5496.38 1994.13,-5496.38 1988.26,-5495.14"/>
<text text-anchor="middle" x="2000" y="-5455.92" font-family="Times,serif" font-size="14.00">Concat Head Group 1</text>
<text text-anchor="middle" x="2000" y="-5440.92" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="2000" y="-5425.92" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l1_g4&#45;&gt;concat_l1_hg1 -->
<g id="edge21" class="edge">
<title>mha_l1_g4&#45;&gt;concat_l1_hg1</title>
<path fill="none" stroke="black" d="M1396.25,-5584.54C1396.25,-5533.72 1396.25,-5444 1396.25,-5444 1396.25,-5444 1741.82,-5444 1741.82,-5444"/>
<polygon fill="black" stroke="black" points="1741.82,-5447.5 1751.82,-5444 1741.82,-5440.5 1741.82,-5447.5"/>
</g>
<!-- mha_l1_g5&#45;&gt;mha_l1_g6 -->
<g id="edge306" class="edge">
<title>mha_l1_g5&#45;&gt;mha_l1_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1780.53,-5618C1780.53,-5618 1886.22,-5618 1886.22,-5618"/>
<polygon fill="red" stroke="red" points="1886.22,-5621.5 1896.22,-5618 1886.22,-5614.5 1886.22,-5621.5"/>
</g>
<!-- mha_l1_g5&#45;&gt;mha_l1_g7 -->
<g id="edge307" class="edge">
<title>mha_l1_g5&#45;&gt;mha_l1_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1770,-5584.48C1770,-5562.11 1770,-5537 1770,-5537 1770,-5537 2227.38,-5537 2227.38,-5537 2227.38,-5537 2227.38,-5574.48 2227.38,-5574.48"/>
<polygon fill="red" stroke="red" points="2223.88,-5574.48 2227.38,-5584.48 2230.88,-5574.48 2223.88,-5574.48"/>
<text text-anchor="middle" x="2094" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g5&#45;&gt;concat_l1_hg1 -->
<g id="edge22" class="edge">
<title>mha_l1_g5&#45;&gt;concat_l1_hg1</title>
<path fill="none" stroke="black" d="M1759.5,-5584.24C1759.5,-5584.24 1759.5,-5456.86 1759.5,-5456.86"/>
<polygon fill="black" stroke="black" points="1763,-5456.86 1759.5,-5446.86 1756,-5456.86 1763,-5456.86"/>
</g>
<!-- mha_l1_g6&#45;&gt;mha_l1_g7 -->
<g id="edge308" class="edge">
<title>mha_l1_g6&#45;&gt;mha_l1_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2103.53,-5618C2103.53,-5618 2209.22,-5618 2209.22,-5618"/>
<polygon fill="red" stroke="red" points="2209.22,-5621.5 2219.22,-5618 2209.22,-5614.5 2209.22,-5621.5"/>
</g>
<!-- mha_l1_g6&#45;&gt;concat_l1_hg1 -->
<g id="edge23" class="edge">
<title>mha_l1_g6&#45;&gt;concat_l1_hg1</title>
<path fill="none" stroke="black" d="M2034.5,-5584.24C2034.5,-5584.24 2034.5,-5500.46 2034.5,-5500.46"/>
<polygon fill="black" stroke="black" points="2038,-5500.46 2034.5,-5490.46 2031,-5500.46 2038,-5500.46"/>
</g>
<!-- mha_l1_g7&#45;&gt;concat_l1_hg1 -->
<g id="edge24" class="edge">
<title>mha_l1_g7&#45;&gt;concat_l1_hg1</title>
<path fill="none" stroke="black" d="M2243.12,-5584.24C2243.12,-5584.24 2243.12,-5456.51 2243.12,-5456.51"/>
<polygon fill="black" stroke="black" points="2246.63,-5456.51 2243.12,-5446.51 2239.63,-5456.51 2246.63,-5456.51"/>
</g>
<!-- mha_l1_g8&#45;&gt;mha_l1_g9 -->
<g id="edge309" class="edge">
<title>mha_l1_g8&#45;&gt;mha_l1_g9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2691.53,-5607C2691.53,-5607 2797.22,-5607 2797.22,-5607"/>
<polygon fill="red" stroke="red" points="2797.22,-5610.5 2807.22,-5607 2797.22,-5603.5 2797.22,-5610.5"/>
</g>
<!-- mha_l1_g8&#45;&gt;mha_l1_g10 -->
<g id="edge310" class="edge">
<title>mha_l1_g8&#45;&gt;mha_l1_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2673.25,-5584.41C2673.25,-5567.64 2673.25,-5551 2673.25,-5551 2673.25,-5551 3192,-5551 3192,-5551 3192,-5551 3192,-5574.41 3192,-5574.41"/>
<polygon fill="red" stroke="red" points="3188.5,-5574.41 3192,-5584.41 3195.5,-5574.41 3188.5,-5574.41"/>
<text text-anchor="middle" x="2788" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g8&#45;&gt;mha_l1_g11 -->
<g id="edge311" class="edge">
<title>mha_l1_g8&#45;&gt;mha_l1_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2664.12,-5584.37C2664.12,-5564.75 2664.12,-5544 2664.12,-5544 2664.12,-5544 3465.25,-5544 3465.25,-5544 3465.25,-5544 3465.25,-5574.37 3465.25,-5574.37"/>
<polygon fill="red" stroke="red" points="3461.75,-5574.37 3465.25,-5584.37 3468.75,-5574.37 3461.75,-5574.37"/>
<text text-anchor="middle" x="2845" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l1_hg2 -->
<g id="node20" class="node">
<title>concat_l1_hg2</title>
<path fill="#ffb347" stroke="black" d="M3052.26,-5495.14C3052.26,-5495.14 2824.74,-5447.1 2824.74,-5447.1 2818.87,-5445.86 2818.87,-5443.38 2824.74,-5442.14 2824.74,-5442.14 3052.26,-5394.1 3052.26,-5394.1 3058.13,-5392.86 3069.87,-5392.86 3075.74,-5394.1 3075.74,-5394.1 3303.26,-5442.14 3303.26,-5442.14 3309.13,-5443.38 3309.13,-5445.86 3303.26,-5447.1 3303.26,-5447.1 3075.74,-5495.14 3075.74,-5495.14 3069.87,-5496.38 3058.13,-5496.38 3052.26,-5495.14"/>
<text text-anchor="middle" x="3064" y="-5455.92" font-family="Times,serif" font-size="14.00">Concat Head Group 2</text>
<text text-anchor="middle" x="3064" y="-5440.92" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="3064" y="-5425.92" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l1_g8&#45;&gt;concat_l1_hg2 -->
<g id="edge25" class="edge">
<title>mha_l1_g8&#45;&gt;concat_l1_hg2</title>
<path fill="none" stroke="black" d="M2682.38,-5584.54C2682.38,-5533.72 2682.38,-5444 2682.38,-5444 2682.38,-5444 2805.85,-5444 2805.85,-5444"/>
<polygon fill="black" stroke="black" points="2805.85,-5447.5 2815.85,-5444 2805.85,-5440.5 2805.85,-5447.5"/>
</g>
<!-- mha_l1_g9&#45;&gt;mha_l1_g10 -->
<g id="edge312" class="edge">
<title>mha_l1_g9&#45;&gt;mha_l1_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3014.53,-5618C3014.53,-5618 3120.22,-5618 3120.22,-5618"/>
<polygon fill="red" stroke="red" points="3120.22,-5621.5 3130.22,-5618 3120.22,-5614.5 3120.22,-5621.5"/>
</g>
<!-- mha_l1_g9&#45;&gt;mha_l1_g11 -->
<g id="edge313" class="edge">
<title>mha_l1_g9&#45;&gt;mha_l1_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2947.33,-5584.57C2947.33,-5570.32 2947.33,-5557 2947.33,-5557 2947.33,-5557 3459.38,-5557 3459.38,-5557 3459.38,-5557 3459.38,-5574.57 3459.38,-5574.57"/>
<polygon fill="red" stroke="red" points="3455.88,-5574.57 3459.38,-5584.57 3462.88,-5574.57 3455.88,-5574.57"/>
<text text-anchor="middle" x="3135" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g9&#45;&gt;concat_l1_hg2 -->
<g id="edge26" class="edge">
<title>mha_l1_g9&#45;&gt;concat_l1_hg2</title>
<path fill="none" stroke="black" d="M2880.17,-5584.24C2880.17,-5584.24 2880.17,-5468.88 2880.17,-5468.88"/>
<polygon fill="black" stroke="black" points="2883.67,-5468.88 2880.17,-5458.88 2876.67,-5468.88 2883.67,-5468.88"/>
</g>
<!-- mha_l1_g10&#45;&gt;mha_l1_g11 -->
<g id="edge314" class="edge">
<title>mha_l1_g10&#45;&gt;mha_l1_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3337.53,-5618C3337.53,-5618 3443.22,-5618 3443.22,-5618"/>
<polygon fill="red" stroke="red" points="3443.22,-5621.5 3453.22,-5618 3443.22,-5614.5 3443.22,-5621.5"/>
</g>
<!-- mha_l1_g10&#45;&gt;concat_l1_hg2 -->
<g id="edge27" class="edge">
<title>mha_l1_g10&#45;&gt;concat_l1_hg2</title>
<path fill="none" stroke="black" d="M3253.5,-5584.24C3253.5,-5584.24 3253.5,-5467.64 3253.5,-5467.64"/>
<polygon fill="black" stroke="black" points="3257,-5467.64 3253.5,-5457.64 3250,-5467.64 3257,-5467.64"/>
</g>
<!-- mha_l1_g11&#45;&gt;concat_l1_hg2 -->
<g id="edge28" class="edge">
<title>mha_l1_g11&#45;&gt;concat_l1_hg2</title>
<path fill="none" stroke="black" d="M3471.12,-5584.54C3471.12,-5533.72 3471.12,-5444 3471.12,-5444 3471.12,-5444 3322.26,-5444 3322.26,-5444"/>
<polygon fill="black" stroke="black" points="3322.26,-5440.5 3312.26,-5444 3322.26,-5447.5 3322.26,-5440.5"/>
</g>
<!-- mha_l1_g12&#45;&gt;mha_l1_g13 -->
<g id="edge315" class="edge">
<title>mha_l1_g12&#45;&gt;mha_l1_g13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3925.53,-5618C3925.53,-5618 4031.22,-5618 4031.22,-5618"/>
<polygon fill="red" stroke="red" points="4031.22,-5621.5 4041.22,-5618 4031.22,-5614.5 4031.22,-5621.5"/>
</g>
<!-- mha_l1_g12&#45;&gt;mha_l1_g14 -->
<g id="edge316" class="edge">
<title>mha_l1_g12&#45;&gt;mha_l1_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3917.62,-5584.52C3917.62,-5576.89 3917.62,-5571 3917.62,-5571 3917.62,-5571 4375,-5571 4375,-5571 4375,-5571 4375,-5574.52 4375,-5574.52"/>
<polygon fill="red" stroke="red" points="4371.5,-5574.52 4375,-5584.52 4378.5,-5574.52 4371.5,-5574.52"/>
<text text-anchor="middle" x="4184" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g12&#45;&gt;mha_l1_g15 -->
<g id="edge317" class="edge">
<title>mha_l1_g12&#45;&gt;mha_l1_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3909.75,-5584.34C3909.75,-5573.36 3909.75,-5564 3909.75,-5564 3909.75,-5564 4769.62,-5564 4769.62,-5564 4769.62,-5564 4769.62,-5574.34 4769.62,-5574.34"/>
<polygon fill="red" stroke="red" points="4766.13,-5574.34 4769.62,-5584.34 4773.13,-5574.34 4766.13,-5574.34"/>
<text text-anchor="middle" x="4005" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l1_hg3 -->
<g id="node21" class="node">
<title>concat_l1_hg3</title>
<path fill="#ffb347" stroke="black" d="M4133.26,-5495.14C4133.26,-5495.14 3905.74,-5447.1 3905.74,-5447.1 3899.87,-5445.86 3899.87,-5443.38 3905.74,-5442.14 3905.74,-5442.14 4133.26,-5394.1 4133.26,-5394.1 4139.13,-5392.86 4150.87,-5392.86 4156.74,-5394.1 4156.74,-5394.1 4384.26,-5442.14 4384.26,-5442.14 4390.13,-5443.38 4390.13,-5445.86 4384.26,-5447.1 4384.26,-5447.1 4156.74,-5495.14 4156.74,-5495.14 4150.87,-5496.38 4139.13,-5496.38 4133.26,-5495.14"/>
<text text-anchor="middle" x="4145" y="-5455.92" font-family="Times,serif" font-size="14.00">Concat Head Group 3</text>
<text text-anchor="middle" x="4145" y="-5440.92" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="4145" y="-5425.92" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l1_g12&#45;&gt;concat_l1_hg3 -->
<g id="edge29" class="edge">
<title>mha_l1_g12&#45;&gt;concat_l1_hg3</title>
<path fill="none" stroke="black" d="M3901.88,-5584.24C3901.88,-5584.24 3901.88,-5456.51 3901.88,-5456.51"/>
<polygon fill="black" stroke="black" points="3905.38,-5456.51 3901.88,-5446.51 3898.38,-5456.51 3905.38,-5456.51"/>
</g>
<!-- mha_l1_g13&#45;&gt;mha_l1_g14 -->
<g id="edge318" class="edge">
<title>mha_l1_g13&#45;&gt;mha_l1_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4248.53,-5618C4248.53,-5618 4354.22,-5618 4354.22,-5618"/>
<polygon fill="red" stroke="red" points="4354.22,-5621.5 4364.22,-5618 4354.22,-5614.5 4354.22,-5621.5"/>
</g>
<!-- mha_l1_g13&#45;&gt;mha_l1_g15 -->
<g id="edge319" class="edge">
<title>mha_l1_g13&#45;&gt;mha_l1_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4179.5,-5584.25C4179.5,-5579.94 4179.5,-5577 4179.5,-5577 4179.5,-5577 4742.25,-5577 4742.25,-5577 4742.25,-5577 4742.25,-5577.72 4742.25,-5577.72"/>
<polygon fill="red" stroke="red" points="4738.75,-5574.25 4742.25,-5584.25 4745.75,-5574.25 4738.75,-5574.25"/>
<text text-anchor="middle" x="4369" y="-5718.42" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l1_g13&#45;&gt;concat_l1_hg3 -->
<g id="edge30" class="edge">
<title>mha_l1_g13&#45;&gt;concat_l1_hg3</title>
<path fill="none" stroke="black" d="M4110.5,-5584.24C4110.5,-5584.24 4110.5,-5500.46 4110.5,-5500.46"/>
<polygon fill="black" stroke="black" points="4114,-5500.46 4110.5,-5490.46 4107,-5500.46 4114,-5500.46"/>
</g>
<!-- mha_l1_g14&#45;&gt;mha_l1_g15 -->
<g id="edge320" class="edge">
<title>mha_l1_g14&#45;&gt;mha_l1_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4571.53,-5618C4571.53,-5618 4677.22,-5618 4677.22,-5618"/>
<polygon fill="red" stroke="red" points="4677.22,-5621.5 4687.22,-5618 4677.22,-5614.5 4677.22,-5621.5"/>
</g>
<!-- mha_l1_g14&#45;&gt;concat_l1_hg3 -->
<g id="edge31" class="edge">
<title>mha_l1_g14&#45;&gt;concat_l1_hg3</title>
<path fill="none" stroke="black" d="M4385.5,-5584.24C4385.5,-5584.24 4385.5,-5456.86 4385.5,-5456.86"/>
<polygon fill="black" stroke="black" points="4389,-5456.86 4385.5,-5446.86 4382,-5456.86 4389,-5456.86"/>
</g>
<!-- mha_l1_g15&#45;&gt;concat_l1_hg3 -->
<g id="edge32" class="edge">
<title>mha_l1_g15&#45;&gt;concat_l1_hg3</title>
<path fill="none" stroke="black" d="M4714.88,-5584.54C4714.88,-5533.72 4714.88,-5444 4714.88,-5444 4714.88,-5444 4403.3,-5444 4403.3,-5444"/>
<polygon fill="black" stroke="black" points="4403.3,-5440.5 4393.3,-5444 4403.3,-5447.5 4403.3,-5440.5"/>
</g>
<!-- final_concat_l1 -->
<g id="node22" class="node">
<title>final_concat_l1</title>
<path fill="#ff8c00" stroke="black" d="M3052.37,-5301.67C3052.37,-5301.67 2866.63,-5254.57 2866.63,-5254.57 2860.82,-5253.1 2860.82,-5250.15 2866.63,-5248.67 2866.63,-5248.67 3052.37,-5201.57 3052.37,-5201.57 3058.18,-5200.1 3069.82,-5200.1 3075.63,-5201.57 3075.63,-5201.57 3261.37,-5248.67 3261.37,-5248.67 3267.18,-5250.15 3267.18,-5253.1 3261.37,-5254.57 3261.37,-5254.57 3075.63,-5301.67 3075.63,-5301.67 3069.82,-5303.15 3058.18,-5303.15 3052.37,-5301.67"/>
<text text-anchor="middle" x="3064" y="-5262.92" font-family="Times,serif" font-size="14.00">Final Concat</text>
<text text-anchor="middle" x="3064" y="-5247.92" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
<text text-anchor="middle" x="3064" y="-5232.92" font-family="Times,serif" font-size="14.00">All heads combined</text>
</g>
<!-- concat_l1_hg0&#45;&gt;final_concat_l1 -->
<g id="edge33" class="edge">
<title>concat_l1_hg0&#45;&gt;final_concat_l1</title>
<path fill="none" stroke="black" d="M766,-5391.49C766,-5328.81 766,-5233 766,-5233 766,-5233 2918.41,-5233 2918.41,-5233"/>
<polygon fill="black" stroke="black" points="2918.41,-5236.5 2928.41,-5233 2918.41,-5229.5 2918.41,-5236.5"/>
</g>
<!-- concat_l1_hg1&#45;&gt;final_concat_l1 -->
<g id="edge34" class="edge">
<title>concat_l1_hg1&#45;&gt;final_concat_l1</title>
<path fill="none" stroke="black" d="M2233,-5440.62C2233,-5414.48 2233,-5269 2233,-5269 2233,-5269 2913.5,-5269 2913.5,-5269"/>
<polygon fill="black" stroke="black" points="2913.5,-5272.5 2923.5,-5269 2913.5,-5265.5 2913.5,-5272.5"/>
</g>
<!-- concat_l1_hg2&#45;&gt;final_concat_l1 -->
<g id="edge35" class="edge">
<title>concat_l1_hg2&#45;&gt;final_concat_l1</title>
<path fill="none" stroke="black" d="M3064,-5391.37C3064,-5391.37 3064,-5314.7 3064,-5314.7"/>
<polygon fill="black" stroke="black" points="3067.5,-5314.7 3064,-5304.7 3060.5,-5314.7 3067.5,-5314.7"/>
</g>
<!-- concat_l1_hg3&#45;&gt;final_concat_l1 -->
<g id="edge36" class="edge">
<title>concat_l1_hg3&#45;&gt;final_concat_l1</title>
<path fill="none" stroke="black" d="M3905.5,-5442.17C3905.5,-5419.76 3905.5,-5251 3905.5,-5251 3905.5,-5251 3280.66,-5251 3280.66,-5251"/>
<polygon fill="black" stroke="black" points="3280.66,-5247.5 3270.66,-5251 3280.66,-5254.5 3280.66,-5247.5"/>
</g>
<!-- final_concat_l1&#45;&gt;ln1_l1 -->
<g id="edge37" class="edge">
<title>final_concat_l1&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M3176,-5227C3176,-5227 3176,-5121.69 3176,-5121.69"/>
<polygon fill="black" stroke="black" points="3179.5,-5121.69 3176,-5111.69 3172.5,-5121.69 3179.5,-5121.69"/>
</g>
<!-- ffn_l1_g0 -->
<g id="node23" class="node">
<title>ffn_l1_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M1485,-4830.14C1485,-4830.14 1347,-4830.14 1347,-4830.14 1341,-4830.14 1335,-4824.14 1335,-4818.14 1335,-4818.14 1335,-4774.14 1335,-4774.14 1335,-4768.14 1341,-4762.14 1347,-4762.14 1347,-4762.14 1485,-4762.14 1485,-4762.14 1491,-4762.14 1497,-4768.14 1497,-4774.14 1497,-4774.14 1497,-4818.14 1497,-4818.14 1497,-4824.14 1491,-4830.14 1485,-4830.14"/>
<text text-anchor="middle" x="1416" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 0</text>
<text text-anchor="middle" x="1416" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="1416" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="1416" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ffn_concat_l1 -->
<g id="node39" class="node">
<title>ffn_concat_l1</title>
<path fill="#90ee90" stroke="black" d="M3164.19,-4672.99C3164.19,-4672.99 2978.81,-4639.29 2978.81,-4639.29 2972.9,-4638.21 2972.9,-4636.07 2978.81,-4634.99 2978.81,-4634.99 3164.19,-4601.29 3164.19,-4601.29 3170.1,-4600.21 3181.9,-4600.21 3187.81,-4601.29 3187.81,-4601.29 3373.19,-4634.99 3373.19,-4634.99 3379.1,-4636.07 3379.1,-4638.21 3373.19,-4639.29 3373.19,-4639.29 3187.81,-4672.99 3187.81,-4672.99 3181.9,-4674.07 3170.1,-4674.07 3164.19,-4672.99"/>
<text text-anchor="middle" x="3176" y="-4640.94" font-family="Times,serif" font-size="14.00">FFN Concat</text>
<text text-anchor="middle" x="3176" y="-4625.94" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ffn_l1_g0&#45;&gt;ffn_concat_l1 -->
<g id="edge56" class="edge">
<title>ffn_l1_g0&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M1416,-4762.07C1416,-4707.85 1416,-4608 1416,-4608 1416,-4608 3117.09,-4608 3117.09,-4608"/>
<polygon fill="black" stroke="black" points="3117.09,-4611.5 3127.09,-4608 3117.09,-4604.5 3117.09,-4611.5"/>
</g>
<!-- ffn_l1_g1 -->
<g id="node24" class="node">
<title>ffn_l1_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M1705,-4830.14C1705,-4830.14 1567,-4830.14 1567,-4830.14 1561,-4830.14 1555,-4824.14 1555,-4818.14 1555,-4818.14 1555,-4774.14 1555,-4774.14 1555,-4768.14 1561,-4762.14 1567,-4762.14 1567,-4762.14 1705,-4762.14 1705,-4762.14 1711,-4762.14 1717,-4768.14 1717,-4774.14 1717,-4774.14 1717,-4818.14 1717,-4818.14 1717,-4824.14 1711,-4830.14 1705,-4830.14"/>
<text text-anchor="middle" x="1636" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 1</text>
<text text-anchor="middle" x="1636" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="1636" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="1636" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn_l1_g1&#45;&gt;ffn_concat_l1 -->
<g id="edge57" class="edge">
<title>ffn_l1_g1&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M1636,-4761.79C1636,-4710.03 1636,-4618 1636,-4618 1636,-4618 3062.26,-4618 3062.26,-4618"/>
<polygon fill="black" stroke="black" points="3062.26,-4621.5 3072.26,-4618 3062.26,-4614.5 3062.26,-4621.5"/>
</g>
<!-- ffn_l1_g2 -->
<g id="node25" class="node">
<title>ffn_l1_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M1925,-4830.14C1925,-4830.14 1787,-4830.14 1787,-4830.14 1781,-4830.14 1775,-4824.14 1775,-4818.14 1775,-4818.14 1775,-4774.14 1775,-4774.14 1775,-4768.14 1781,-4762.14 1787,-4762.14 1787,-4762.14 1925,-4762.14 1925,-4762.14 1931,-4762.14 1937,-4768.14 1937,-4774.14 1937,-4774.14 1937,-4818.14 1937,-4818.14 1937,-4824.14 1931,-4830.14 1925,-4830.14"/>
<text text-anchor="middle" x="1856" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 2</text>
<text text-anchor="middle" x="1856" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="1856" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="1856" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn_l1_g2&#45;&gt;ffn_concat_l1 -->
<g id="edge58" class="edge">
<title>ffn_l1_g2&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M1900.75,-4761.91C1900.75,-4712.49 1900.75,-4627 1900.75,-4627 1900.75,-4627 3012.49,-4627 3012.49,-4627"/>
<polygon fill="black" stroke="black" points="3012.49,-4630.5 3022.49,-4627 3012.49,-4623.5 3012.49,-4630.5"/>
</g>
<!-- ffn_l1_g3 -->
<g id="node26" class="node">
<title>ffn_l1_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M2145,-4830.14C2145,-4830.14 2007,-4830.14 2007,-4830.14 2001,-4830.14 1995,-4824.14 1995,-4818.14 1995,-4818.14 1995,-4774.14 1995,-4774.14 1995,-4768.14 2001,-4762.14 2007,-4762.14 2007,-4762.14 2145,-4762.14 2145,-4762.14 2151,-4762.14 2157,-4768.14 2157,-4774.14 2157,-4774.14 2157,-4818.14 2157,-4818.14 2157,-4824.14 2151,-4830.14 2145,-4830.14"/>
<text text-anchor="middle" x="2076" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 3</text>
<text text-anchor="middle" x="2076" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="2076" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="2076" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn_l1_g3&#45;&gt;ffn_concat_l1 -->
<g id="edge59" class="edge">
<title>ffn_l1_g3&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M2114.25,-4762C2114.25,-4715.24 2114.25,-4637 2114.25,-4637 2114.25,-4637 2957.5,-4637 2957.5,-4637"/>
<polygon fill="black" stroke="black" points="2957.5,-4640.5 2967.5,-4637 2957.5,-4633.5 2957.5,-4640.5"/>
</g>
<!-- ffn_l1_g4 -->
<g id="node27" class="node">
<title>ffn_l1_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M2365,-4830.14C2365,-4830.14 2227,-4830.14 2227,-4830.14 2221,-4830.14 2215,-4824.14 2215,-4818.14 2215,-4818.14 2215,-4774.14 2215,-4774.14 2215,-4768.14 2221,-4762.14 2227,-4762.14 2227,-4762.14 2365,-4762.14 2365,-4762.14 2371,-4762.14 2377,-4768.14 2377,-4774.14 2377,-4774.14 2377,-4818.14 2377,-4818.14 2377,-4824.14 2371,-4830.14 2365,-4830.14"/>
<text text-anchor="middle" x="2296" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 4</text>
<text text-anchor="middle" x="2296" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="2296" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="2296" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn_l1_g4&#45;&gt;ffn_concat_l1 -->
<g id="edge60" class="edge">
<title>ffn_l1_g4&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M2296,-4762.07C2296,-4717.77 2296,-4646 2296,-4646 2296,-4646 3005.62,-4646 3005.62,-4646"/>
<polygon fill="black" stroke="black" points="3005.62,-4649.5 3015.62,-4646 3005.62,-4642.5 3005.62,-4649.5"/>
</g>
<!-- ffn_l1_g5 -->
<g id="node28" class="node">
<title>ffn_l1_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M2585,-4830.14C2585,-4830.14 2447,-4830.14 2447,-4830.14 2441,-4830.14 2435,-4824.14 2435,-4818.14 2435,-4818.14 2435,-4774.14 2435,-4774.14 2435,-4768.14 2441,-4762.14 2447,-4762.14 2447,-4762.14 2585,-4762.14 2585,-4762.14 2591,-4762.14 2597,-4768.14 2597,-4774.14 2597,-4774.14 2597,-4818.14 2597,-4818.14 2597,-4824.14 2591,-4830.14 2585,-4830.14"/>
<text text-anchor="middle" x="2516" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 5</text>
<text text-anchor="middle" x="2516" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="2516" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="2516" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn_l1_g5&#45;&gt;ffn_concat_l1 -->
<g id="edge61" class="edge">
<title>ffn_l1_g5&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M2539.33,-4761.86C2539.33,-4720.37 2539.33,-4656 2539.33,-4656 2539.33,-4656 3060.51,-4656 3060.51,-4656"/>
<polygon fill="black" stroke="black" points="3060.51,-4659.5 3070.51,-4656 3060.51,-4652.5 3060.51,-4659.5"/>
</g>
<!-- ffn_l1_g6 -->
<g id="node29" class="node">
<title>ffn_l1_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M2805,-4830.14C2805,-4830.14 2667,-4830.14 2667,-4830.14 2661,-4830.14 2655,-4824.14 2655,-4818.14 2655,-4818.14 2655,-4774.14 2655,-4774.14 2655,-4768.14 2661,-4762.14 2667,-4762.14 2667,-4762.14 2805,-4762.14 2805,-4762.14 2811,-4762.14 2817,-4768.14 2817,-4774.14 2817,-4774.14 2817,-4818.14 2817,-4818.14 2817,-4824.14 2811,-4830.14 2805,-4830.14"/>
<text text-anchor="middle" x="2736" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 6</text>
<text text-anchor="middle" x="2736" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="2736" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="2736" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn_l1_g6&#45;&gt;ffn_concat_l1 -->
<g id="edge62" class="edge">
<title>ffn_l1_g6&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M2767.25,-4762.03C2767.25,-4723.17 2767.25,-4665 2767.25,-4665 2767.25,-4665 3110.02,-4665 3110.02,-4665"/>
<polygon fill="black" stroke="black" points="3110.02,-4668.5 3120.02,-4665 3110.02,-4661.5 3110.02,-4668.5"/>
</g>
<!-- ffn_l1_g7 -->
<g id="node30" class="node">
<title>ffn_l1_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M3025,-4830.14C3025,-4830.14 2887,-4830.14 2887,-4830.14 2881,-4830.14 2875,-4824.14 2875,-4818.14 2875,-4818.14 2875,-4774.14 2875,-4774.14 2875,-4768.14 2881,-4762.14 2887,-4762.14 2887,-4762.14 3025,-4762.14 3025,-4762.14 3031,-4762.14 3037,-4768.14 3037,-4774.14 3037,-4774.14 3037,-4818.14 3037,-4818.14 3037,-4824.14 3031,-4830.14 3025,-4830.14"/>
<text text-anchor="middle" x="2956" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 7</text>
<text text-anchor="middle" x="2956" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="2956" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="2956" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn_l1_g7&#45;&gt;ffn_concat_l1 -->
<g id="edge63" class="edge">
<title>ffn_l1_g7&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M3002,-4762.03C3002,-4762.03 3002,-4653.51 3002,-4653.51"/>
<polygon fill="black" stroke="black" points="3005.5,-4653.51 3002,-4643.51 2998.5,-4653.51 3005.5,-4653.51"/>
</g>
<!-- ffn_l1_g8 -->
<g id="node31" class="node">
<title>ffn_l1_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M3245,-4830.14C3245,-4830.14 3107,-4830.14 3107,-4830.14 3101,-4830.14 3095,-4824.14 3095,-4818.14 3095,-4818.14 3095,-4774.14 3095,-4774.14 3095,-4768.14 3101,-4762.14 3107,-4762.14 3107,-4762.14 3245,-4762.14 3245,-4762.14 3251,-4762.14 3257,-4768.14 3257,-4774.14 3257,-4774.14 3257,-4818.14 3257,-4818.14 3257,-4824.14 3251,-4830.14 3245,-4830.14"/>
<text text-anchor="middle" x="3176" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 8</text>
<text text-anchor="middle" x="3176" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3176" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3176" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn_l1_g8&#45;&gt;ffn_concat_l1 -->
<g id="edge64" class="edge">
<title>ffn_l1_g8&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M3176,-4762.03C3176,-4762.03 3176,-4685.38 3176,-4685.38"/>
<polygon fill="black" stroke="black" points="3179.5,-4685.38 3176,-4675.38 3172.5,-4685.38 3179.5,-4685.38"/>
</g>
<!-- ffn_l1_g9 -->
<g id="node32" class="node">
<title>ffn_l1_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M3465,-4830.14C3465,-4830.14 3327,-4830.14 3327,-4830.14 3321,-4830.14 3315,-4824.14 3315,-4818.14 3315,-4818.14 3315,-4774.14 3315,-4774.14 3315,-4768.14 3321,-4762.14 3327,-4762.14 3327,-4762.14 3465,-4762.14 3465,-4762.14 3471,-4762.14 3477,-4768.14 3477,-4774.14 3477,-4774.14 3477,-4818.14 3477,-4818.14 3477,-4824.14 3471,-4830.14 3465,-4830.14"/>
<text text-anchor="middle" x="3396" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 9</text>
<text text-anchor="middle" x="3396" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3396" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3396" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn_l1_g9&#45;&gt;ffn_concat_l1 -->
<g id="edge65" class="edge">
<title>ffn_l1_g9&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M3350,-4762.03C3350,-4762.03 3350,-4653.51 3350,-4653.51"/>
<polygon fill="black" stroke="black" points="3353.5,-4653.51 3350,-4643.51 3346.5,-4653.51 3353.5,-4653.51"/>
</g>
<!-- ffn_l1_g10 -->
<g id="node33" class="node">
<title>ffn_l1_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M3685,-4830.14C3685,-4830.14 3547,-4830.14 3547,-4830.14 3541,-4830.14 3535,-4824.14 3535,-4818.14 3535,-4818.14 3535,-4774.14 3535,-4774.14 3535,-4768.14 3541,-4762.14 3547,-4762.14 3547,-4762.14 3685,-4762.14 3685,-4762.14 3691,-4762.14 3697,-4768.14 3697,-4774.14 3697,-4774.14 3697,-4818.14 3697,-4818.14 3697,-4824.14 3691,-4830.14 3685,-4830.14"/>
<text text-anchor="middle" x="3616" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 10</text>
<text text-anchor="middle" x="3616" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3616" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3616" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn_l1_g10&#45;&gt;ffn_concat_l1 -->
<g id="edge66" class="edge">
<title>ffn_l1_g10&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M3597.33,-4762.11C3597.33,-4722.96 3597.33,-4664 3597.33,-4664 3597.33,-4664 3247.72,-4664 3247.72,-4664"/>
<polygon fill="black" stroke="black" points="3247.72,-4660.5 3237.72,-4664 3247.72,-4667.5 3247.72,-4660.5"/>
</g>
<!-- ffn_l1_g11 -->
<g id="node34" class="node">
<title>ffn_l1_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M3905,-4830.14C3905,-4830.14 3767,-4830.14 3767,-4830.14 3761,-4830.14 3755,-4824.14 3755,-4818.14 3755,-4818.14 3755,-4774.14 3755,-4774.14 3755,-4768.14 3761,-4762.14 3767,-4762.14 3767,-4762.14 3905,-4762.14 3905,-4762.14 3911,-4762.14 3917,-4768.14 3917,-4774.14 3917,-4774.14 3917,-4818.14 3917,-4818.14 3917,-4824.14 3911,-4830.14 3905,-4830.14"/>
<text text-anchor="middle" x="3836" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 11</text>
<text text-anchor="middle" x="3836" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3836" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3836" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn_l1_g11&#45;&gt;ffn_concat_l1 -->
<g id="edge67" class="edge">
<title>ffn_l1_g11&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M3836,-4761.86C3836,-4719.51 3836,-4653 3836,-4653 3836,-4653 3307.82,-4653 3307.82,-4653"/>
<polygon fill="black" stroke="black" points="3307.82,-4649.5 3297.82,-4653 3307.82,-4656.5 3307.82,-4649.5"/>
</g>
<!-- ffn_l1_g12 -->
<g id="node35" class="node">
<title>ffn_l1_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M4125,-4830.14C4125,-4830.14 3987,-4830.14 3987,-4830.14 3981,-4830.14 3975,-4824.14 3975,-4818.14 3975,-4818.14 3975,-4774.14 3975,-4774.14 3975,-4768.14 3981,-4762.14 3987,-4762.14 3987,-4762.14 4125,-4762.14 4125,-4762.14 4131,-4762.14 4137,-4768.14 4137,-4774.14 4137,-4774.14 4137,-4818.14 4137,-4818.14 4137,-4824.14 4131,-4830.14 4125,-4830.14"/>
<text text-anchor="middle" x="4056" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 12</text>
<text text-anchor="middle" x="4056" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4056" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4056" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn_l1_g12&#45;&gt;ffn_concat_l1 -->
<g id="edge68" class="edge">
<title>ffn_l1_g12&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M4021.25,-4761.93C4021.25,-4716.52 4021.25,-4642 4021.25,-4642 4021.25,-4642 3368.37,-4642 3368.37,-4642"/>
<polygon fill="black" stroke="black" points="3368.37,-4638.5 3358.37,-4642 3368.37,-4645.5 3368.37,-4638.5"/>
</g>
<!-- ffn_l1_g13 -->
<g id="node36" class="node">
<title>ffn_l1_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M4345,-4830.14C4345,-4830.14 4207,-4830.14 4207,-4830.14 4201,-4830.14 4195,-4824.14 4195,-4818.14 4195,-4818.14 4195,-4774.14 4195,-4774.14 4195,-4768.14 4201,-4762.14 4207,-4762.14 4207,-4762.14 4345,-4762.14 4345,-4762.14 4351,-4762.14 4357,-4768.14 4357,-4774.14 4357,-4774.14 4357,-4818.14 4357,-4818.14 4357,-4824.14 4351,-4830.14 4345,-4830.14"/>
<text text-anchor="middle" x="4276" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 13</text>
<text text-anchor="middle" x="4276" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4276" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4276" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn_l1_g13&#45;&gt;ffn_concat_l1 -->
<g id="edge69" class="edge">
<title>ffn_l1_g13&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M4221.5,-4761.92C4221.5,-4713.55 4221.5,-4631 4221.5,-4631 4221.5,-4631 3361.29,-4631 3361.29,-4631"/>
<polygon fill="black" stroke="black" points="3361.29,-4627.5 3351.29,-4631 3361.29,-4634.5 3361.29,-4627.5"/>
</g>
<!-- ffn_l1_g14 -->
<g id="node37" class="node">
<title>ffn_l1_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M4565,-4830.14C4565,-4830.14 4427,-4830.14 4427,-4830.14 4421,-4830.14 4415,-4824.14 4415,-4818.14 4415,-4818.14 4415,-4774.14 4415,-4774.14 4415,-4768.14 4421,-4762.14 4427,-4762.14 4427,-4762.14 4565,-4762.14 4565,-4762.14 4571,-4762.14 4577,-4768.14 4577,-4774.14 4577,-4774.14 4577,-4818.14 4577,-4818.14 4577,-4824.14 4571,-4830.14 4565,-4830.14"/>
<text text-anchor="middle" x="4496" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 14</text>
<text text-anchor="middle" x="4496" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4496" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4496" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn_l1_g14&#45;&gt;ffn_concat_l1 -->
<g id="edge70" class="edge">
<title>ffn_l1_g14&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M4466.51,-4761.76C4466.51,-4710.5 4466.51,-4620 4466.51,-4620 4466.51,-4620 3300.81,-4620 3300.81,-4620"/>
<polygon fill="black" stroke="black" points="3300.81,-4616.5 3290.81,-4620 3300.81,-4623.5 3300.81,-4616.5"/>
</g>
<!-- ffn_l1_g15 -->
<g id="node38" class="node">
<title>ffn_l1_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M4785,-4830.14C4785,-4830.14 4647,-4830.14 4647,-4830.14 4641,-4830.14 4635,-4824.14 4635,-4818.14 4635,-4818.14 4635,-4774.14 4635,-4774.14 4635,-4768.14 4641,-4762.14 4647,-4762.14 4647,-4762.14 4785,-4762.14 4785,-4762.14 4791,-4762.14 4797,-4768.14 4797,-4774.14 4797,-4774.14 4797,-4818.14 4797,-4818.14 4797,-4824.14 4791,-4830.14 4785,-4830.14"/>
<text text-anchor="middle" x="4716" y="-4814.94" font-family="Times,serif" font-size="14.00">FFN Partition 15</text>
<text text-anchor="middle" x="4716" y="-4799.94" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4716" y="-4784.94" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4716" y="-4769.94" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn_l1_g15&#45;&gt;ffn_concat_l1 -->
<g id="edge71" class="edge">
<title>ffn_l1_g15&#45;&gt;ffn_concat_l1</title>
<path fill="none" stroke="black" d="M4645.25,-4761.82C4645.25,-4707.79 4645.25,-4609 4645.25,-4609 4645.25,-4609 3240.47,-4609 3240.47,-4609"/>
<polygon fill="black" stroke="black" points="3240.47,-4605.5 3230.47,-4609 3240.47,-4612.5 3240.47,-4605.5"/>
</g>
<!-- ln2_l1 -->
<g id="node41" class="node">
<title>ln2_l1</title>
<ellipse fill="#e6e6fa" stroke="black" cx="4436" cy="-4485.27" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="4436" y="-4489.07" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="4436" y="-4474.07" font-family="Times,serif" font-size="14.00">L1</text>
</g>
<!-- ffn_concat_l1&#45;&gt;ln2_l1 -->
<g id="edge72" class="edge">
<title>ffn_concat_l1&#45;&gt;ln2_l1</title>
<path fill="none" stroke="black" d="M3365,-4633.38C3365,-4609.95 3365,-4485 3365,-4485 3365,-4485 4343.74,-4485 4343.74,-4485"/>
<polygon fill="black" stroke="black" points="4343.74,-4488.5 4353.74,-4485 4343.74,-4481.5 4343.74,-4488.5"/>
</g>
<!-- residual_l1 -->
<g id="node42" class="node">
<title>residual_l1</title>
<ellipse fill="#f5f5dc" stroke="black" cx="3176" cy="-4944.01" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="3176" y="-4947.81" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="3176" y="-4932.81" font-family="Times,serif" font-size="14.00">L1</text>
</g>
<!-- ln1_l1&#45;&gt;residual_l1 -->
<g id="edge39" class="edge">
<title>ln1_l1&#45;&gt;residual_l1</title>
<path fill="none" stroke="black" d="M3176,-5057.62C3176,-5057.62 3176,-4981.06 3176,-4981.06"/>
<polygon fill="black" stroke="black" points="3179.5,-4981.06 3176,-4971.06 3172.5,-4981.06 3179.5,-4981.06"/>
</g>
<!-- layer1_output -->
<g id="node43" class="node">
<title>layer1_output</title>
<path fill="#2e86ab" stroke="#2e86ab" stroke-width="2" d="M4528.5,-4371.4C4528.5,-4371.4 4343.5,-4371.4 4343.5,-4371.4 4337.5,-4371.4 4331.5,-4365.4 4331.5,-4359.4 4331.5,-4359.4 4331.5,-4345.4 4331.5,-4345.4 4331.5,-4339.4 4337.5,-4333.4 4343.5,-4333.4 4343.5,-4333.4 4528.5,-4333.4 4528.5,-4333.4 4534.5,-4333.4 4540.5,-4339.4 4540.5,-4345.4 4540.5,-4345.4 4540.5,-4359.4 4540.5,-4359.4 4540.5,-4365.4 4534.5,-4371.4 4528.5,-4371.4"/>
<text text-anchor="middle" x="4436" y="-4356.2" font-family="Times,serif" font-size="14.00">Layer 1 Output</text>
<text text-anchor="middle" x="4436" y="-4341.2" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ln2_l1&#45;&gt;layer1_output -->
<g id="edge74" class="edge">
<title>ln2_l1&#45;&gt;layer1_output</title>
<path fill="none" stroke="black" d="M4436,-4458.38C4436,-4458.38 4436,-4381.52 4436,-4381.52"/>
<polygon fill="black" stroke="black" points="4439.5,-4381.52 4436,-4371.52 4432.5,-4381.52 4439.5,-4381.52"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g0 -->
<g id="edge40" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g0</title>
<path fill="none" stroke="black" d="M3138.94,-4964C2890.51,-4964 1477.25,-4964 1477.25,-4964 1477.25,-4964 1477.25,-4840.52 1477.25,-4840.52"/>
<polygon fill="black" stroke="black" points="1480.75,-4840.52 1477.25,-4830.52 1473.75,-4840.52 1480.75,-4840.52"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g1 -->
<g id="edge41" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g1</title>
<path fill="none" stroke="black" d="M3128.51,-4958C2870.13,-4958 1645.25,-4958 1645.25,-4958 1645.25,-4958 1645.25,-4840.47 1645.25,-4840.47"/>
<polygon fill="black" stroke="black" points="1648.75,-4840.47 1645.25,-4830.47 1641.75,-4840.47 1648.75,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g2 -->
<g id="edge42" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g2</title>
<path fill="none" stroke="black" d="M3123.03,-4952C2876.8,-4952 1856,-4952 1856,-4952 1856,-4952 1856,-4840.35 1856,-4840.35"/>
<polygon fill="black" stroke="black" points="1859.5,-4840.35 1856,-4830.35 1852.5,-4840.35 1859.5,-4840.35"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g3 -->
<g id="edge43" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g3</title>
<path fill="none" stroke="black" d="M3120.7,-4946C2897.64,-4946 2076,-4946 2076,-4946 2076,-4946 2076,-4840.15 2076,-4840.15"/>
<polygon fill="black" stroke="black" points="2079.5,-4840.15 2076,-4830.15 2072.5,-4840.15 2079.5,-4840.15"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g4 -->
<g id="edge44" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g4</title>
<path fill="none" stroke="black" d="M3121.1,-4941C2931.23,-4941 2314,-4941 2314,-4941 2314,-4941 2314,-4840.47 2314,-4840.47"/>
<polygon fill="black" stroke="black" points="2317.5,-4840.47 2314,-4830.47 2310.5,-4840.47 2317.5,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g5 -->
<g id="edge45" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g5</title>
<path fill="none" stroke="black" d="M3124.01,-4935C2972.3,-4935 2540.75,-4935 2540.75,-4935 2540.75,-4935 2540.75,-4840.47 2540.75,-4840.47"/>
<polygon fill="black" stroke="black" points="2544.25,-4840.47 2540.75,-4830.47 2537.25,-4840.47 2544.25,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g6 -->
<g id="edge46" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g6</title>
<path fill="none" stroke="black" d="M3130.01,-4929C3024.03,-4929 2771.64,-4929 2771.64,-4929 2771.64,-4929 2771.64,-4840.36 2771.64,-4840.36"/>
<polygon fill="black" stroke="black" points="2775.14,-4840.36 2771.64,-4830.36 2768.14,-4840.36 2775.14,-4840.36"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g7 -->
<g id="edge47" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g7</title>
<path fill="none" stroke="black" d="M3141.14,-4923C3079.11,-4923 2956,-4923 2956,-4923 2956,-4923 2956,-4840.47 2956,-4840.47"/>
<polygon fill="black" stroke="black" points="2959.5,-4840.47 2956,-4830.47 2952.5,-4840.47 2959.5,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g8 -->
<g id="edge48" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g8</title>
<path fill="none" stroke="black" d="M3176,-4916.89C3176,-4916.89 3176,-4840.38 3176,-4840.38"/>
<polygon fill="black" stroke="black" points="3179.5,-4840.38 3176,-4830.38 3172.5,-4840.38 3179.5,-4840.38"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g9 -->
<g id="edge49" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g9</title>
<path fill="none" stroke="black" d="M3210.47,-4923C3254.83,-4923 3326.25,-4923 3326.25,-4923 3326.25,-4923 3326.25,-4840.47 3326.25,-4840.47"/>
<polygon fill="black" stroke="black" points="3329.75,-4840.47 3326.25,-4830.47 3322.75,-4840.47 3329.75,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g10 -->
<g id="edge50" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g10</title>
<path fill="none" stroke="black" d="M3221.94,-4929C3331.25,-4929 3597.75,-4929 3597.75,-4929 3597.75,-4929 3597.75,-4840.36 3597.75,-4840.36"/>
<polygon fill="black" stroke="black" points="3601.25,-4840.36 3597.75,-4830.36 3594.25,-4840.36 3601.25,-4840.36"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g11 -->
<g id="edge51" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g11</title>
<path fill="none" stroke="black" d="M3227.97,-4935C3381.86,-4935 3824.5,-4935 3824.5,-4935 3824.5,-4935 3824.5,-4840.47 3824.5,-4840.47"/>
<polygon fill="black" stroke="black" points="3828,-4840.47 3824.5,-4830.47 3821,-4840.47 3828,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g12 -->
<g id="edge52" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g12</title>
<path fill="none" stroke="black" d="M3231.05,-4941C3423.7,-4941 4056,-4941 4056,-4941 4056,-4941 4056,-4840.47 4056,-4840.47"/>
<polygon fill="black" stroke="black" points="4059.5,-4840.47 4056,-4830.47 4052.5,-4840.47 4059.5,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g13 -->
<g id="edge53" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g13</title>
<path fill="none" stroke="black" d="M3231.3,-4946C3454.36,-4946 4276,-4946 4276,-4946 4276,-4946 4276,-4840.15 4276,-4840.15"/>
<polygon fill="black" stroke="black" points="4279.5,-4840.15 4276,-4830.15 4272.5,-4840.15 4279.5,-4840.15"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g14 -->
<g id="edge54" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g14</title>
<path fill="none" stroke="black" d="M3223.27,-4958C3458.68,-4958 4493.25,-4958 4493.25,-4958 4493.25,-4958 4493.25,-4840.47 4493.25,-4840.47"/>
<polygon fill="black" stroke="black" points="4496.75,-4840.47 4493.25,-4830.47 4489.75,-4840.47 4496.75,-4840.47"/>
</g>
<!-- residual_l1&#45;&gt;ffn_l1_g15 -->
<g id="edge55" class="edge">
<title>residual_l1&#45;&gt;ffn_l1_g15</title>
<path fill="none" stroke="black" d="M3213.08,-4964C3442.74,-4964 4661.25,-4964 4661.25,-4964 4661.25,-4964 4661.25,-4840.52 4661.25,-4840.52"/>
<polygon fill="black" stroke="black" points="4664.75,-4840.52 4661.25,-4830.52 4657.75,-4840.52 4664.75,-4840.52"/>
</g>
<!-- residual_l1&#45;&gt;ln2_l1 -->
<g id="edge73" class="edge">
<title>residual_l1&#45;&gt;ln2_l1</title>
<path fill="none" stroke="black" d="M3228.74,-4952C3460.44,-4952 4376.5,-4952 4376.5,-4952 4376.5,-4952 4376.5,-4513.86 4376.5,-4513.86"/>
<polygon fill="black" stroke="black" points="4380,-4513.86 4376.5,-4503.86 4373,-4513.86 4380,-4513.86"/>
</g>
<!-- mha_l2_g0 -->
<g id="node44" class="node">
<title>mha_l2_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M2059.5,-4213.4C2059.5,-4213.4 1876.5,-4213.4 1876.5,-4213.4 1870.5,-4213.4 1864.5,-4207.4 1864.5,-4201.4 1864.5,-4201.4 1864.5,-4157.4 1864.5,-4157.4 1864.5,-4151.4 1870.5,-4145.4 1876.5,-4145.4 1876.5,-4145.4 2059.5,-4145.4 2059.5,-4145.4 2065.5,-4145.4 2071.5,-4151.4 2071.5,-4157.4 2071.5,-4157.4 2071.5,-4201.4 2071.5,-4201.4 2071.5,-4207.4 2065.5,-4213.4 2059.5,-4213.4"/>
<text text-anchor="middle" x="1968" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 0</text>
<text text-anchor="middle" x="1968" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="1968" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="1968" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g0 -->
<g id="edge75" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g0</title>
<path fill="none" stroke="black" d="M4331.16,-4367C3866.3,-4367 2014.12,-4367 2014.12,-4367 2014.12,-4367 2014.12,-4223.81 2014.12,-4223.81"/>
<polygon fill="black" stroke="black" points="2017.63,-4223.81 2014.12,-4213.81 2010.63,-4223.81 2017.63,-4223.81"/>
</g>
<!-- mha_l2_g1 -->
<g id="node45" class="node">
<title>mha_l2_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M2382.5,-4213.4C2382.5,-4213.4 2199.5,-4213.4 2199.5,-4213.4 2193.5,-4213.4 2187.5,-4207.4 2187.5,-4201.4 2187.5,-4201.4 2187.5,-4157.4 2187.5,-4157.4 2187.5,-4151.4 2193.5,-4145.4 2199.5,-4145.4 2199.5,-4145.4 2382.5,-4145.4 2382.5,-4145.4 2388.5,-4145.4 2394.5,-4151.4 2394.5,-4157.4 2394.5,-4157.4 2394.5,-4201.4 2394.5,-4201.4 2394.5,-4207.4 2388.5,-4213.4 2382.5,-4213.4"/>
<text text-anchor="middle" x="2291" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 1</text>
<text text-anchor="middle" x="2291" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="2291" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2291" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g1 -->
<g id="edge76" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g1</title>
<path fill="none" stroke="black" d="M4331.15,-4363C3912.84,-4363 2385.75,-4363 2385.75,-4363 2385.75,-4363 2385.75,-4223.5 2385.75,-4223.5"/>
<polygon fill="black" stroke="black" points="2389.25,-4223.5 2385.75,-4213.5 2382.25,-4223.5 2389.25,-4223.5"/>
</g>
<!-- mha_l2_g2 -->
<g id="node46" class="node">
<title>mha_l2_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M2705.5,-4213.4C2705.5,-4213.4 2522.5,-4213.4 2522.5,-4213.4 2516.5,-4213.4 2510.5,-4207.4 2510.5,-4201.4 2510.5,-4201.4 2510.5,-4157.4 2510.5,-4157.4 2510.5,-4151.4 2516.5,-4145.4 2522.5,-4145.4 2522.5,-4145.4 2705.5,-4145.4 2705.5,-4145.4 2711.5,-4145.4 2717.5,-4151.4 2717.5,-4157.4 2717.5,-4157.4 2717.5,-4201.4 2717.5,-4201.4 2717.5,-4207.4 2711.5,-4213.4 2705.5,-4213.4"/>
<text text-anchor="middle" x="2614" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 2</text>
<text text-anchor="middle" x="2614" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="2614" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2614" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g2 -->
<g id="edge77" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g2</title>
<path fill="none" stroke="black" d="M4331.46,-4360C3954.37,-4360 2686.25,-4360 2686.25,-4360 2686.25,-4360 2686.25,-4223.8 2686.25,-4223.8"/>
<polygon fill="black" stroke="black" points="2689.75,-4223.8 2686.25,-4213.8 2682.75,-4223.8 2689.75,-4223.8"/>
</g>
<!-- mha_l2_g3 -->
<g id="node47" class="node">
<title>mha_l2_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M3028.5,-4213.4C3028.5,-4213.4 2845.5,-4213.4 2845.5,-4213.4 2839.5,-4213.4 2833.5,-4207.4 2833.5,-4201.4 2833.5,-4201.4 2833.5,-4157.4 2833.5,-4157.4 2833.5,-4151.4 2839.5,-4145.4 2845.5,-4145.4 2845.5,-4145.4 3028.5,-4145.4 3028.5,-4145.4 3034.5,-4145.4 3040.5,-4151.4 3040.5,-4157.4 3040.5,-4157.4 3040.5,-4201.4 3040.5,-4201.4 3040.5,-4207.4 3034.5,-4213.4 3028.5,-4213.4"/>
<text text-anchor="middle" x="2937" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 3</text>
<text text-anchor="middle" x="2937" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="2937" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="2937" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g3 -->
<g id="edge78" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g3</title>
<path fill="none" stroke="black" d="M4331.26,-4356C4001.09,-4356 3003.75,-4356 3003.75,-4356 3003.75,-4356 3003.75,-4223.45 3003.75,-4223.45"/>
<polygon fill="black" stroke="black" points="3007.25,-4223.45 3003.75,-4213.45 3000.25,-4223.45 3007.25,-4223.45"/>
</g>
<!-- mha_l2_g4 -->
<g id="node48" class="node">
<title>mha_l2_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M3293.5,-4213.4C3293.5,-4213.4 3110.5,-4213.4 3110.5,-4213.4 3104.5,-4213.4 3098.5,-4207.4 3098.5,-4201.4 3098.5,-4201.4 3098.5,-4157.4 3098.5,-4157.4 3098.5,-4151.4 3104.5,-4145.4 3110.5,-4145.4 3110.5,-4145.4 3293.5,-4145.4 3293.5,-4145.4 3299.5,-4145.4 3305.5,-4151.4 3305.5,-4157.4 3305.5,-4157.4 3305.5,-4201.4 3305.5,-4201.4 3305.5,-4207.4 3299.5,-4213.4 3293.5,-4213.4"/>
<text text-anchor="middle" x="3202" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 4</text>
<text text-anchor="middle" x="3202" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="3202" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3202" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g4 -->
<g id="edge79" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g4</title>
<path fill="none" stroke="black" d="M4331.38,-4352C4027.71,-4352 3167.5,-4352 3167.5,-4352 3167.5,-4352 3167.5,-4223.5 3167.5,-4223.5"/>
<polygon fill="black" stroke="black" points="3171,-4223.5 3167.5,-4213.5 3164,-4223.5 3171,-4223.5"/>
</g>
<!-- mha_l2_g5 -->
<g id="node49" class="node">
<title>mha_l2_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M3616.5,-4213.4C3616.5,-4213.4 3433.5,-4213.4 3433.5,-4213.4 3427.5,-4213.4 3421.5,-4207.4 3421.5,-4201.4 3421.5,-4201.4 3421.5,-4157.4 3421.5,-4157.4 3421.5,-4151.4 3427.5,-4145.4 3433.5,-4145.4 3433.5,-4145.4 3616.5,-4145.4 3616.5,-4145.4 3622.5,-4145.4 3628.5,-4151.4 3628.5,-4157.4 3628.5,-4157.4 3628.5,-4201.4 3628.5,-4201.4 3628.5,-4207.4 3622.5,-4213.4 3616.5,-4213.4"/>
<text text-anchor="middle" x="3525" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 5</text>
<text text-anchor="middle" x="3525" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="3525" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3525" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g5 -->
<g id="edge80" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g5</title>
<path fill="none" stroke="black" d="M4331.08,-4348C4099.73,-4348 3566.17,-4348 3566.17,-4348 3566.17,-4348 3566.17,-4223.52 3566.17,-4223.52"/>
<polygon fill="black" stroke="black" points="3569.67,-4223.52 3566.17,-4213.52 3562.67,-4223.52 3569.67,-4223.52"/>
</g>
<!-- mha_l2_g6 -->
<g id="node50" class="node">
<title>mha_l2_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M3939.5,-4213.4C3939.5,-4213.4 3756.5,-4213.4 3756.5,-4213.4 3750.5,-4213.4 3744.5,-4207.4 3744.5,-4201.4 3744.5,-4201.4 3744.5,-4157.4 3744.5,-4157.4 3744.5,-4151.4 3750.5,-4145.4 3756.5,-4145.4 3756.5,-4145.4 3939.5,-4145.4 3939.5,-4145.4 3945.5,-4145.4 3951.5,-4151.4 3951.5,-4157.4 3951.5,-4157.4 3951.5,-4201.4 3951.5,-4201.4 3951.5,-4207.4 3945.5,-4213.4 3939.5,-4213.4"/>
<text text-anchor="middle" x="3848" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 6</text>
<text text-anchor="middle" x="3848" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="3848" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3848" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g6 -->
<g id="edge81" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g6</title>
<path fill="none" stroke="black" d="M4331.43,-4341C4184.38,-4341 3934.25,-4341 3934.25,-4341 3934.25,-4341 3934.25,-4223.67 3934.25,-4223.67"/>
<polygon fill="black" stroke="black" points="3937.75,-4223.67 3934.25,-4213.67 3930.75,-4223.67 3937.75,-4223.67"/>
</g>
<!-- mha_l2_g7 -->
<g id="node51" class="node">
<title>mha_l2_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M4262.5,-4213.4C4262.5,-4213.4 4079.5,-4213.4 4079.5,-4213.4 4073.5,-4213.4 4067.5,-4207.4 4067.5,-4201.4 4067.5,-4201.4 4067.5,-4157.4 4067.5,-4157.4 4067.5,-4151.4 4073.5,-4145.4 4079.5,-4145.4 4079.5,-4145.4 4262.5,-4145.4 4262.5,-4145.4 4268.5,-4145.4 4274.5,-4151.4 4274.5,-4157.4 4274.5,-4157.4 4274.5,-4201.4 4274.5,-4201.4 4274.5,-4207.4 4268.5,-4213.4 4262.5,-4213.4"/>
<text text-anchor="middle" x="4171" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 7</text>
<text text-anchor="middle" x="4171" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="4171" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4171" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g7 -->
<g id="edge82" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g7</title>
<path fill="none" stroke="black" d="M4331.28,-4337C4288.11,-4337 4248,-4337 4248,-4337 4248,-4337 4248,-4223.6 4248,-4223.6"/>
<polygon fill="black" stroke="black" points="4251.5,-4223.6 4248,-4213.6 4244.5,-4223.6 4251.5,-4223.6"/>
</g>
<!-- mha_l2_g8 -->
<g id="node52" class="node">
<title>mha_l2_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M4527.5,-4213.4C4527.5,-4213.4 4344.5,-4213.4 4344.5,-4213.4 4338.5,-4213.4 4332.5,-4207.4 4332.5,-4201.4 4332.5,-4201.4 4332.5,-4157.4 4332.5,-4157.4 4332.5,-4151.4 4338.5,-4145.4 4344.5,-4145.4 4344.5,-4145.4 4527.5,-4145.4 4527.5,-4145.4 4533.5,-4145.4 4539.5,-4151.4 4539.5,-4157.4 4539.5,-4157.4 4539.5,-4201.4 4539.5,-4201.4 4539.5,-4207.4 4533.5,-4213.4 4527.5,-4213.4"/>
<text text-anchor="middle" x="4436" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 8</text>
<text text-anchor="middle" x="4436" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="4436" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4436" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g8 -->
<g id="edge83" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g8</title>
<path fill="none" stroke="black" d="M4436,-4333.23C4436,-4333.23 4436,-4223.54 4436,-4223.54"/>
<polygon fill="black" stroke="black" points="4439.5,-4223.54 4436,-4213.54 4432.5,-4223.54 4439.5,-4223.54"/>
</g>
<!-- mha_l2_g9 -->
<g id="node53" class="node">
<title>mha_l2_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M4850.5,-4213.4C4850.5,-4213.4 4667.5,-4213.4 4667.5,-4213.4 4661.5,-4213.4 4655.5,-4207.4 4655.5,-4201.4 4655.5,-4201.4 4655.5,-4157.4 4655.5,-4157.4 4655.5,-4151.4 4661.5,-4145.4 4667.5,-4145.4 4667.5,-4145.4 4850.5,-4145.4 4850.5,-4145.4 4856.5,-4145.4 4862.5,-4151.4 4862.5,-4157.4 4862.5,-4157.4 4862.5,-4201.4 4862.5,-4201.4 4862.5,-4207.4 4856.5,-4213.4 4850.5,-4213.4"/>
<text text-anchor="middle" x="4759" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 9</text>
<text text-anchor="middle" x="4759" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="4759" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4759" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g9 -->
<g id="edge84" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g9</title>
<path fill="none" stroke="black" d="M4540.79,-4338C4623.93,-4338 4726.25,-4338 4726.25,-4338 4726.25,-4338 4726.25,-4223.42 4726.25,-4223.42"/>
<polygon fill="black" stroke="black" points="4729.75,-4223.42 4726.25,-4213.42 4722.75,-4223.42 4729.75,-4223.42"/>
</g>
<!-- mha_l2_g10 -->
<g id="node54" class="node">
<title>mha_l2_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M5173.5,-4213.4C5173.5,-4213.4 4990.5,-4213.4 4990.5,-4213.4 4984.5,-4213.4 4978.5,-4207.4 4978.5,-4201.4 4978.5,-4201.4 4978.5,-4157.4 4978.5,-4157.4 4978.5,-4151.4 4984.5,-4145.4 4990.5,-4145.4 4990.5,-4145.4 5173.5,-4145.4 5173.5,-4145.4 5179.5,-4145.4 5185.5,-4151.4 5185.5,-4157.4 5185.5,-4157.4 5185.5,-4201.4 5185.5,-4201.4 5185.5,-4207.4 5179.5,-4213.4 5173.5,-4213.4"/>
<text text-anchor="middle" x="5082" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 10</text>
<text text-anchor="middle" x="5082" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="5082" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5082" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g10 -->
<g id="edge85" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g10</title>
<path fill="none" stroke="black" d="M4540.51,-4342C4723.34,-4342 5082,-4342 5082,-4342 5082,-4342 5082,-4223.49 5082,-4223.49"/>
<polygon fill="black" stroke="black" points="5085.5,-4223.49 5082,-4213.49 5078.5,-4223.49 5085.5,-4223.49"/>
</g>
<!-- mha_l2_g11 -->
<g id="node55" class="node">
<title>mha_l2_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M5496.5,-4213.4C5496.5,-4213.4 5313.5,-4213.4 5313.5,-4213.4 5307.5,-4213.4 5301.5,-4207.4 5301.5,-4201.4 5301.5,-4201.4 5301.5,-4157.4 5301.5,-4157.4 5301.5,-4151.4 5307.5,-4145.4 5313.5,-4145.4 5313.5,-4145.4 5496.5,-4145.4 5496.5,-4145.4 5502.5,-4145.4 5508.5,-4151.4 5508.5,-4157.4 5508.5,-4157.4 5508.5,-4201.4 5508.5,-4201.4 5508.5,-4207.4 5502.5,-4213.4 5496.5,-4213.4"/>
<text text-anchor="middle" x="5405" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 11</text>
<text text-anchor="middle" x="5405" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="5405" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5405" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g11 -->
<g id="edge86" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g11</title>
<path fill="none" stroke="black" d="M4540.62,-4347C4791.18,-4347 5405,-4347 5405,-4347 5405,-4347 5405,-4223.72 5405,-4223.72"/>
<polygon fill="black" stroke="black" points="5408.5,-4223.72 5405,-4213.72 5401.5,-4223.72 5408.5,-4223.72"/>
</g>
<!-- mha_l2_g12 -->
<g id="node56" class="node">
<title>mha_l2_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M5761.5,-4213.4C5761.5,-4213.4 5578.5,-4213.4 5578.5,-4213.4 5572.5,-4213.4 5566.5,-4207.4 5566.5,-4201.4 5566.5,-4201.4 5566.5,-4157.4 5566.5,-4157.4 5566.5,-4151.4 5572.5,-4145.4 5578.5,-4145.4 5578.5,-4145.4 5761.5,-4145.4 5761.5,-4145.4 5767.5,-4145.4 5773.5,-4151.4 5773.5,-4157.4 5773.5,-4157.4 5773.5,-4201.4 5773.5,-4201.4 5773.5,-4207.4 5767.5,-4213.4 5761.5,-4213.4"/>
<text text-anchor="middle" x="5670" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 12</text>
<text text-anchor="middle" x="5670" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="5670" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5670" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g12 -->
<g id="edge87" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g12</title>
<path fill="none" stroke="black" d="M4540.68,-4352C4838.64,-4352 5670,-4352 5670,-4352 5670,-4352 5670,-4223.5 5670,-4223.5"/>
<polygon fill="black" stroke="black" points="5673.5,-4223.5 5670,-4213.5 5666.5,-4223.5 5673.5,-4223.5"/>
</g>
<!-- mha_l2_g13 -->
<g id="node57" class="node">
<title>mha_l2_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M6084.5,-4213.4C6084.5,-4213.4 5901.5,-4213.4 5901.5,-4213.4 5895.5,-4213.4 5889.5,-4207.4 5889.5,-4201.4 5889.5,-4201.4 5889.5,-4157.4 5889.5,-4157.4 5889.5,-4151.4 5895.5,-4145.4 5901.5,-4145.4 5901.5,-4145.4 6084.5,-4145.4 6084.5,-4145.4 6090.5,-4145.4 6096.5,-4151.4 6096.5,-4157.4 6096.5,-4157.4 6096.5,-4201.4 6096.5,-4201.4 6096.5,-4207.4 6090.5,-4213.4 6084.5,-4213.4"/>
<text text-anchor="middle" x="5993" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 13</text>
<text text-anchor="middle" x="5993" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="5993" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5993" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g13 -->
<g id="edge88" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g13</title>
<path fill="none" stroke="black" d="M4540.58,-4357C4889.68,-4357 5993,-4357 5993,-4357 5993,-4357 5993,-4223.64 5993,-4223.64"/>
<polygon fill="black" stroke="black" points="5996.5,-4223.64 5993,-4213.64 5989.5,-4223.64 5996.5,-4223.64"/>
</g>
<!-- mha_l2_g14 -->
<g id="node58" class="node">
<title>mha_l2_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M6407.5,-4213.4C6407.5,-4213.4 6224.5,-4213.4 6224.5,-4213.4 6218.5,-4213.4 6212.5,-4207.4 6212.5,-4201.4 6212.5,-4201.4 6212.5,-4157.4 6212.5,-4157.4 6212.5,-4151.4 6218.5,-4145.4 6224.5,-4145.4 6224.5,-4145.4 6407.5,-4145.4 6407.5,-4145.4 6413.5,-4145.4 6419.5,-4151.4 6419.5,-4157.4 6419.5,-4157.4 6419.5,-4201.4 6419.5,-4201.4 6419.5,-4207.4 6413.5,-4213.4 6407.5,-4213.4"/>
<text text-anchor="middle" x="6316" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 14</text>
<text text-anchor="middle" x="6316" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="6316" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6316" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g14 -->
<g id="edge89" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g14</title>
<path fill="none" stroke="black" d="M4540.77,-4361C4936.24,-4361 6316,-4361 6316,-4361 6316,-4361 6316,-4223.56 6316,-4223.56"/>
<polygon fill="black" stroke="black" points="6319.5,-4223.56 6316,-4213.56 6312.5,-4223.56 6319.5,-4223.56"/>
</g>
<!-- mha_l2_g15 -->
<g id="node59" class="node">
<title>mha_l2_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M6730.5,-4213.4C6730.5,-4213.4 6547.5,-4213.4 6547.5,-4213.4 6541.5,-4213.4 6535.5,-4207.4 6535.5,-4201.4 6535.5,-4201.4 6535.5,-4157.4 6535.5,-4157.4 6535.5,-4151.4 6541.5,-4145.4 6547.5,-4145.4 6547.5,-4145.4 6730.5,-4145.4 6730.5,-4145.4 6736.5,-4145.4 6742.5,-4151.4 6742.5,-4157.4 6742.5,-4157.4 6742.5,-4201.4 6742.5,-4201.4 6742.5,-4207.4 6736.5,-4213.4 6730.5,-4213.4"/>
<text text-anchor="middle" x="6639" y="-4198.2" font-family="Times,serif" font-size="14.00">MHA Partition 15</text>
<text text-anchor="middle" x="6639" y="-4183.2" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="6639" y="-4168.2" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6639" y="-4153.2" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_output&#45;&gt;mha_l2_g15 -->
<g id="edge90" class="edge">
<title>layer1_output&#45;&gt;mha_l2_g15</title>
<path fill="none" stroke="black" d="M4540.77,-4366C4978.58,-4366 6639,-4366 6639,-4366 6639,-4366 6639,-4223.63 6639,-4223.63"/>
<polygon fill="black" stroke="black" points="6642.5,-4223.63 6639,-4213.63 6635.5,-4223.63 6642.5,-4223.63"/>
</g>
<!-- ln1_l2 -->
<g id="node82" class="node">
<title>ln1_l2</title>
<ellipse fill="#e6e6fa" stroke="black" cx="5024" cy="-3645.53" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="5024" y="-3649.33" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="5024" y="-3634.33" font-family="Times,serif" font-size="14.00">L2</text>
</g>
<!-- layer1_output&#45;&gt;ln1_l2 -->
<g id="edge112" class="edge">
<title>layer1_output&#45;&gt;ln1_l2</title>
<path fill="none" stroke="black" d="M4331.47,-4344C4317.15,-4344 4307.25,-4344 4307.25,-4344 4307.25,-4344 4307.25,-3645 4307.25,-3645 4307.25,-3645 4931.78,-3645 4931.78,-3645"/>
<polygon fill="black" stroke="black" points="4931.78,-3648.5 4941.78,-3645 4931.78,-3641.5 4931.78,-3648.5"/>
</g>
<!-- mha_l2_g0&#45;&gt;mha_l2_g1 -->
<g id="edge321" class="edge">
<title>mha_l2_g0&#45;&gt;mha_l2_g1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2071.53,-4179C2071.53,-4179 2177.22,-4179 2177.22,-4179"/>
<polygon fill="red" stroke="red" points="2177.22,-4182.5 2187.22,-4179 2177.22,-4175.5 2177.22,-4182.5"/>
</g>
<!-- mha_l2_g0&#45;&gt;mha_l2_g2 -->
<g id="edge322" class="edge">
<title>mha_l2_g0&#45;&gt;mha_l2_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2052.38,-4213.43C2052.38,-4228.56 2052.38,-4243 2052.38,-4243 2052.38,-4243 2568.17,-4243 2568.17,-4243 2568.17,-4243 2568.17,-4223.43 2568.17,-4223.43"/>
<polygon fill="red" stroke="red" points="2571.67,-4223.43 2568.17,-4213.43 2564.67,-4223.43 2571.67,-4223.43"/>
<text text-anchor="middle" x="2431" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g0&#45;&gt;mha_l2_g3 -->
<g id="edge323" class="edge">
<title>mha_l2_g0&#45;&gt;mha_l2_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2033.25,-4213.5C2033.25,-4250.09 2033.25,-4303 2033.25,-4303 2033.25,-4303 2844.25,-4303 2844.25,-4303 2844.25,-4303 2844.25,-4223.5 2844.25,-4223.5"/>
<polygon fill="red" stroke="red" points="2847.75,-4223.5 2844.25,-4213.5 2840.75,-4223.5 2847.75,-4223.5"/>
<text text-anchor="middle" x="2536" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l2_hg0 -->
<g id="node60" class="node">
<title>concat_l2_hg0</title>
<path fill="#ffb347" stroke="black" d="M2602.26,-4055.92C2602.26,-4055.92 2374.74,-4007.88 2374.74,-4007.88 2368.87,-4006.64 2368.87,-4004.16 2374.74,-4002.92 2374.74,-4002.92 2602.26,-3954.88 2602.26,-3954.88 2608.13,-3953.64 2619.87,-3953.64 2625.74,-3954.88 2625.74,-3954.88 2853.26,-4002.92 2853.26,-4002.92 2859.13,-4004.16 2859.13,-4006.64 2853.26,-4007.88 2853.26,-4007.88 2625.74,-4055.92 2625.74,-4055.92 2619.87,-4057.16 2608.13,-4057.16 2602.26,-4055.92"/>
<text text-anchor="middle" x="2614" y="-4016.7" font-family="Times,serif" font-size="14.00">Concat Head Group 0</text>
<text text-anchor="middle" x="2614" y="-4001.7" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="2614" y="-3986.7" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l2_g0&#45;&gt;concat_l2_hg0 -->
<g id="edge91" class="edge">
<title>mha_l2_g0&#45;&gt;concat_l2_hg0</title>
<path fill="none" stroke="black" d="M1968,-4145.36C1968,-4094.61 1968,-4005 1968,-4005 1968,-4005 2354.7,-4005 2354.7,-4005"/>
<polygon fill="black" stroke="black" points="2354.7,-4008.5 2364.7,-4005 2354.7,-4001.5 2354.7,-4008.5"/>
</g>
<!-- mha_l2_g1&#45;&gt;mha_l2_g2 -->
<g id="edge324" class="edge">
<title>mha_l2_g1&#45;&gt;mha_l2_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2394.53,-4179C2394.53,-4179 2500.22,-4179 2500.22,-4179"/>
<polygon fill="red" stroke="red" points="2500.22,-4182.5 2510.22,-4179 2500.22,-4175.5 2500.22,-4182.5"/>
</g>
<!-- mha_l2_g1&#45;&gt;mha_l2_g3 -->
<g id="edge325" class="edge">
<title>mha_l2_g1&#45;&gt;mha_l2_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2384,-4145.37C2384,-4112.29 2384,-4067 2384,-4067 2384,-4067 2844,-4067 2844,-4067 2844,-4067 2844,-4135.37 2844,-4135.37"/>
<polygon fill="red" stroke="red" points="2840.5,-4135.37 2844,-4145.37 2847.5,-4135.37 2840.5,-4135.37"/>
<text text-anchor="middle" x="2641" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g1&#45;&gt;concat_l2_hg0 -->
<g id="edge92" class="edge">
<title>mha_l2_g1&#45;&gt;concat_l2_hg0</title>
<path fill="none" stroke="black" d="M2373.5,-4145.02C2373.5,-4145.02 2373.5,-4017.64 2373.5,-4017.64"/>
<polygon fill="black" stroke="black" points="2377,-4017.64 2373.5,-4007.64 2370,-4017.64 2377,-4017.64"/>
</g>
<!-- mha_l2_g2&#45;&gt;mha_l2_g3 -->
<g id="edge326" class="edge">
<title>mha_l2_g2&#45;&gt;mha_l2_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2717.53,-4179C2717.53,-4179 2823.22,-4179 2823.22,-4179"/>
<polygon fill="red" stroke="red" points="2823.22,-4182.5 2833.22,-4179 2823.22,-4175.5 2823.22,-4182.5"/>
</g>
<!-- mha_l2_g2&#45;&gt;concat_l2_hg0 -->
<g id="edge93" class="edge">
<title>mha_l2_g2&#45;&gt;concat_l2_hg0</title>
<path fill="none" stroke="black" d="M2614,-4145.02C2614,-4145.02 2614,-4068.55 2614,-4068.55"/>
<polygon fill="black" stroke="black" points="2617.5,-4068.55 2614,-4058.55 2610.5,-4068.55 2617.5,-4068.55"/>
</g>
<!-- mha_l2_g3&#45;&gt;concat_l2_hg0 -->
<g id="edge94" class="edge">
<title>mha_l2_g3&#45;&gt;concat_l2_hg0</title>
<path fill="none" stroke="black" d="M2854.5,-4145.02C2854.5,-4145.02 2854.5,-4017.64 2854.5,-4017.64"/>
<polygon fill="black" stroke="black" points="2858,-4017.64 2854.5,-4007.64 2851,-4017.64 2858,-4017.64"/>
</g>
<!-- mha_l2_g4&#45;&gt;mha_l2_g5 -->
<g id="edge327" class="edge">
<title>mha_l2_g4&#45;&gt;mha_l2_g5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3305.53,-4179C3305.53,-4179 3411.22,-4179 3411.22,-4179"/>
<polygon fill="red" stroke="red" points="3411.22,-4182.5 3421.22,-4179 3411.22,-4175.5 3411.22,-4182.5"/>
</g>
<!-- mha_l2_g4&#45;&gt;mha_l2_g6 -->
<g id="edge328" class="edge">
<title>mha_l2_g4&#45;&gt;mha_l2_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3236.5,-4213.46C3236.5,-4240.22 3236.5,-4273 3236.5,-4273 3236.5,-4273 3749.75,-4273 3749.75,-4273 3749.75,-4273 3749.75,-4223.46 3749.75,-4223.46"/>
<polygon fill="red" stroke="red" points="3753.25,-4223.46 3749.75,-4213.46 3746.25,-4223.46 3753.25,-4223.46"/>
<text text-anchor="middle" x="3624" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g4&#45;&gt;mha_l2_g7 -->
<g id="edge329" class="edge">
<title>mha_l2_g4&#45;&gt;mha_l2_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3223.83,-4145.22C3223.83,-4114.77 3223.83,-4075 3223.83,-4075 3223.83,-4075 4083.25,-4075 4083.25,-4075 4083.25,-4075 4083.25,-4135.22 4083.25,-4135.22"/>
<polygon fill="red" stroke="red" points="4079.75,-4135.22 4083.25,-4145.22 4086.75,-4135.22 4079.75,-4135.22"/>
<text text-anchor="middle" x="3785" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l2_hg1 -->
<g id="node61" class="node">
<title>concat_l2_hg1</title>
<path fill="#ffb347" stroke="black" d="M3836.26,-4055.92C3836.26,-4055.92 3608.74,-4007.88 3608.74,-4007.88 3602.87,-4006.64 3602.87,-4004.16 3608.74,-4002.92 3608.74,-4002.92 3836.26,-3954.88 3836.26,-3954.88 3842.13,-3953.64 3853.87,-3953.64 3859.74,-3954.88 3859.74,-3954.88 4087.26,-4002.92 4087.26,-4002.92 4093.13,-4004.16 4093.13,-4006.64 4087.26,-4007.88 4087.26,-4007.88 3859.74,-4055.92 3859.74,-4055.92 3853.87,-4057.16 3842.13,-4057.16 3836.26,-4055.92"/>
<text text-anchor="middle" x="3848" y="-4016.7" font-family="Times,serif" font-size="14.00">Concat Head Group 1</text>
<text text-anchor="middle" x="3848" y="-4001.7" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="3848" y="-3986.7" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l2_g4&#45;&gt;concat_l2_hg1 -->
<g id="edge95" class="edge">
<title>mha_l2_g4&#45;&gt;concat_l2_hg1</title>
<path fill="none" stroke="black" d="M3264.67,-4145.36C3264.67,-4094.61 3264.67,-4005 3264.67,-4005 3264.67,-4005 3588.5,-4005 3588.5,-4005"/>
<polygon fill="black" stroke="black" points="3588.5,-4008.5 3598.5,-4005 3588.5,-4001.5 3588.5,-4008.5"/>
</g>
<!-- mha_l2_g5&#45;&gt;mha_l2_g6 -->
<g id="edge330" class="edge">
<title>mha_l2_g5&#45;&gt;mha_l2_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3628.53,-4179C3628.53,-4179 3734.22,-4179 3734.22,-4179"/>
<polygon fill="red" stroke="red" points="3734.22,-4182.5 3744.22,-4179 3734.22,-4175.5 3734.22,-4182.5"/>
</g>
<!-- mha_l2_g5&#45;&gt;mha_l2_g7 -->
<g id="edge331" class="edge">
<title>mha_l2_g5&#45;&gt;mha_l2_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3618,-4145.23C3618,-4117.85 3618,-4084 3618,-4084 3618,-4084 4075.38,-4084 4075.38,-4084 4075.38,-4084 4075.38,-4135.23 4075.38,-4135.23"/>
<polygon fill="red" stroke="red" points="4071.88,-4135.23 4075.38,-4145.23 4078.88,-4135.23 4071.88,-4135.23"/>
<text text-anchor="middle" x="3911" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g5&#45;&gt;concat_l2_hg1 -->
<g id="edge96" class="edge">
<title>mha_l2_g5&#45;&gt;concat_l2_hg1</title>
<path fill="none" stroke="black" d="M3607.5,-4145.02C3607.5,-4145.02 3607.5,-4017.64 3607.5,-4017.64"/>
<polygon fill="black" stroke="black" points="3611,-4017.64 3607.5,-4007.64 3604,-4017.64 3611,-4017.64"/>
</g>
<!-- mha_l2_g6&#45;&gt;mha_l2_g7 -->
<g id="edge332" class="edge">
<title>mha_l2_g6&#45;&gt;mha_l2_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3951.53,-4179C3951.53,-4179 4057.22,-4179 4057.22,-4179"/>
<polygon fill="red" stroke="red" points="4057.22,-4182.5 4067.22,-4179 4057.22,-4175.5 4057.22,-4182.5"/>
</g>
<!-- mha_l2_g6&#45;&gt;concat_l2_hg1 -->
<g id="edge97" class="edge">
<title>mha_l2_g6&#45;&gt;concat_l2_hg1</title>
<path fill="none" stroke="black" d="M3848,-4145.02C3848,-4145.02 3848,-4068.55 3848,-4068.55"/>
<polygon fill="black" stroke="black" points="3851.5,-4068.55 3848,-4058.55 3844.5,-4068.55 3851.5,-4068.55"/>
</g>
<!-- mha_l2_g7&#45;&gt;concat_l2_hg1 -->
<g id="edge98" class="edge">
<title>mha_l2_g7&#45;&gt;concat_l2_hg1</title>
<path fill="none" stroke="black" d="M4091.12,-4145.02C4091.12,-4145.02 4091.12,-4017.29 4091.12,-4017.29"/>
<polygon fill="black" stroke="black" points="4094.63,-4017.29 4091.12,-4007.29 4087.63,-4017.29 4094.63,-4017.29"/>
</g>
<!-- mha_l2_g8&#45;&gt;mha_l2_g9 -->
<g id="edge333" class="edge">
<title>mha_l2_g8&#45;&gt;mha_l2_g9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4539.53,-4190C4539.53,-4190 4645.22,-4190 4645.22,-4190"/>
<polygon fill="red" stroke="red" points="4645.22,-4193.5 4655.22,-4190 4645.22,-4186.5 4645.22,-4193.5"/>
</g>
<!-- mha_l2_g8&#45;&gt;mha_l2_g10 -->
<g id="edge334" class="edge">
<title>mha_l2_g8&#45;&gt;mha_l2_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4527.33,-4145.24C4527.33,-4124.11 4527.33,-4101 4527.33,-4101 4527.33,-4101 5001.67,-4101 5001.67,-4101 5001.67,-4101 5001.67,-4135.24 5001.67,-4135.24"/>
<polygon fill="red" stroke="red" points="4998.17,-4135.24 5001.67,-4145.24 5005.17,-4135.24 4998.17,-4135.24"/>
<text text-anchor="middle" x="4636" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g8&#45;&gt;mha_l2_g11 -->
<g id="edge335" class="edge">
<title>mha_l2_g8&#45;&gt;mha_l2_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4515.17,-4145.25C4515.17,-4121.1 4515.17,-4093 4515.17,-4093 4515.17,-4093 5313.25,-4093 5313.25,-4093 5313.25,-4093 5313.25,-4135.25 5313.25,-4135.25"/>
<polygon fill="red" stroke="red" points="5309.75,-4135.25 5313.25,-4145.25 5316.75,-4135.25 5309.75,-4135.25"/>
<text text-anchor="middle" x="4693" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l2_hg2 -->
<g id="node62" class="node">
<title>concat_l2_hg2</title>
<path fill="#ffb347" stroke="black" d="M4785.26,-4055.92C4785.26,-4055.92 4557.74,-4007.88 4557.74,-4007.88 4551.87,-4006.64 4551.87,-4004.16 4557.74,-4002.92 4557.74,-4002.92 4785.26,-3954.88 4785.26,-3954.88 4791.13,-3953.64 4802.87,-3953.64 4808.74,-3954.88 4808.74,-3954.88 5036.26,-4002.92 5036.26,-4002.92 5042.13,-4004.16 5042.13,-4006.64 5036.26,-4007.88 5036.26,-4007.88 4808.74,-4055.92 4808.74,-4055.92 4802.87,-4057.16 4791.13,-4057.16 4785.26,-4055.92"/>
<text text-anchor="middle" x="4797" y="-4016.7" font-family="Times,serif" font-size="14.00">Concat Head Group 2</text>
<text text-anchor="middle" x="4797" y="-4001.7" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="4797" y="-3986.7" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l2_g8&#45;&gt;concat_l2_hg2 -->
<g id="edge99" class="edge">
<title>mha_l2_g8&#45;&gt;concat_l2_hg2</title>
<path fill="none" stroke="black" d="M4539.64,-4168C4552.65,-4168 4561.5,-4168 4561.5,-4168 4561.5,-4168 4561.5,-4018.8 4561.5,-4018.8"/>
<polygon fill="black" stroke="black" points="4565,-4018.8 4561.5,-4008.8 4558,-4018.8 4565,-4018.8"/>
</g>
<!-- mha_l2_g9&#45;&gt;mha_l2_g10 -->
<g id="edge336" class="edge">
<title>mha_l2_g9&#45;&gt;mha_l2_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4862.53,-4179C4862.53,-4179 4968.22,-4179 4968.22,-4179"/>
<polygon fill="red" stroke="red" points="4968.22,-4182.5 4978.22,-4179 4968.22,-4175.5 4968.22,-4182.5"/>
</g>
<!-- mha_l2_g9&#45;&gt;mha_l2_g11 -->
<g id="edge337" class="edge">
<title>mha_l2_g9&#45;&gt;mha_l2_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4793.5,-4145.11C4793.5,-4127.62 4793.5,-4110 4793.5,-4110 4793.5,-4110 5307.38,-4110 5307.38,-4110 5307.38,-4110 5307.38,-4135.11 5307.38,-4135.11"/>
<polygon fill="red" stroke="red" points="5303.88,-4135.11 5307.38,-4145.11 5310.88,-4135.11 5303.88,-4135.11"/>
<text text-anchor="middle" x="4983" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g9&#45;&gt;concat_l2_hg2 -->
<g id="edge100" class="edge">
<title>mha_l2_g9&#45;&gt;concat_l2_hg2</title>
<path fill="none" stroke="black" d="M4724.5,-4145.02C4724.5,-4145.02 4724.5,-4053.33 4724.5,-4053.33"/>
<polygon fill="black" stroke="black" points="4728,-4053.33 4724.5,-4043.33 4721,-4053.33 4728,-4053.33"/>
</g>
<!-- mha_l2_g10&#45;&gt;mha_l2_g11 -->
<g id="edge338" class="edge">
<title>mha_l2_g10&#45;&gt;mha_l2_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5185.53,-4179C5185.53,-4179 5291.22,-4179 5291.22,-4179"/>
<polygon fill="red" stroke="red" points="5291.22,-4182.5 5301.22,-4179 5291.22,-4175.5 5291.22,-4182.5"/>
</g>
<!-- mha_l2_g10&#45;&gt;concat_l2_hg2 -->
<g id="edge101" class="edge">
<title>mha_l2_g10&#45;&gt;concat_l2_hg2</title>
<path fill="none" stroke="black" d="M5024.83,-4145.02C5024.83,-4145.02 5024.83,-4020.32 5024.83,-4020.32"/>
<polygon fill="black" stroke="black" points="5028.33,-4020.32 5024.83,-4010.32 5021.33,-4020.32 5028.33,-4020.32"/>
</g>
<!-- mha_l2_g11&#45;&gt;concat_l2_hg2 -->
<g id="edge102" class="edge">
<title>mha_l2_g11&#45;&gt;concat_l2_hg2</title>
<path fill="none" stroke="black" d="M5319.12,-4145.36C5319.12,-4094.61 5319.12,-4005 5319.12,-4005 5319.12,-4005 5056.21,-4005 5056.21,-4005"/>
<polygon fill="black" stroke="black" points="5056.21,-4001.5 5046.21,-4005 5056.21,-4008.5 5056.21,-4001.5"/>
</g>
<!-- mha_l2_g12&#45;&gt;mha_l2_g13 -->
<g id="edge339" class="edge">
<title>mha_l2_g12&#45;&gt;mha_l2_g13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5773.53,-4179C5773.53,-4179 5879.22,-4179 5879.22,-4179"/>
<polygon fill="red" stroke="red" points="5879.22,-4182.5 5889.22,-4179 5879.22,-4175.5 5879.22,-4182.5"/>
</g>
<!-- mha_l2_g12&#45;&gt;mha_l2_g14 -->
<g id="edge340" class="edge">
<title>mha_l2_g12&#45;&gt;mha_l2_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5765.62,-4145.12C5765.62,-4135.69 5765.62,-4128 5765.62,-4128 5765.62,-4128 6223,-4128 6223,-4128 6223,-4128 6223,-4135.12 6223,-4135.12"/>
<polygon fill="red" stroke="red" points="6219.5,-4135.12 6223,-4145.12 6226.5,-4135.12 6219.5,-4135.12"/>
<text text-anchor="middle" x="6032" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g12&#45;&gt;mha_l2_g15 -->
<g id="edge341" class="edge">
<title>mha_l2_g12&#45;&gt;mha_l2_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5757.75,-4145.32C5757.75,-4131.62 5757.75,-4119 5757.75,-4119 5757.75,-4119 6617.62,-4119 6617.62,-4119 6617.62,-4119 6617.62,-4135.32 6617.62,-4135.32"/>
<polygon fill="red" stroke="red" points="6614.13,-4135.32 6617.62,-4145.32 6621.13,-4135.32 6614.13,-4135.32"/>
<text text-anchor="middle" x="5853" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l2_hg3 -->
<g id="node63" class="node">
<title>concat_l2_hg3</title>
<path fill="#ffb347" stroke="black" d="M5981.26,-4055.92C5981.26,-4055.92 5753.74,-4007.88 5753.74,-4007.88 5747.87,-4006.64 5747.87,-4004.16 5753.74,-4002.92 5753.74,-4002.92 5981.26,-3954.88 5981.26,-3954.88 5987.13,-3953.64 5998.87,-3953.64 6004.74,-3954.88 6004.74,-3954.88 6232.26,-4002.92 6232.26,-4002.92 6238.13,-4004.16 6238.13,-4006.64 6232.26,-4007.88 6232.26,-4007.88 6004.74,-4055.92 6004.74,-4055.92 5998.87,-4057.16 5987.13,-4057.16 5981.26,-4055.92"/>
<text text-anchor="middle" x="5993" y="-4016.7" font-family="Times,serif" font-size="14.00">Concat Head Group 3</text>
<text text-anchor="middle" x="5993" y="-4001.7" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="5993" y="-3986.7" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l2_g12&#45;&gt;concat_l2_hg3 -->
<g id="edge103" class="edge">
<title>mha_l2_g12&#45;&gt;concat_l2_hg3</title>
<path fill="none" stroke="black" d="M5749.88,-4145.02C5749.88,-4145.02 5749.88,-4017.29 5749.88,-4017.29"/>
<polygon fill="black" stroke="black" points="5753.38,-4017.29 5749.88,-4007.29 5746.38,-4017.29 5753.38,-4017.29"/>
</g>
<!-- mha_l2_g13&#45;&gt;mha_l2_g14 -->
<g id="edge342" class="edge">
<title>mha_l2_g13&#45;&gt;mha_l2_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6096.53,-4179C6096.53,-4179 6202.22,-4179 6202.22,-4179"/>
<polygon fill="red" stroke="red" points="6202.22,-4182.5 6212.22,-4179 6202.22,-4175.5 6202.22,-4182.5"/>
</g>
<!-- mha_l2_g13&#45;&gt;mha_l2_g15 -->
<g id="edge343" class="edge">
<title>mha_l2_g13&#45;&gt;mha_l2_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6027.5,-4145.2C6027.5,-4139.83 6027.5,-4136 6027.5,-4136 6027.5,-4136 6590.25,-4136 6590.25,-4136 6590.25,-4136 6590.25,-4136.92 6590.25,-4136.92"/>
<polygon fill="red" stroke="red" points="6586.75,-4135.2 6590.25,-4145.2 6593.75,-4135.2 6586.75,-4135.2"/>
<text text-anchor="middle" x="6197" y="-4279.2" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l2_g13&#45;&gt;concat_l2_hg3 -->
<g id="edge104" class="edge">
<title>mha_l2_g13&#45;&gt;concat_l2_hg3</title>
<path fill="none" stroke="black" d="M5958.5,-4145.02C5958.5,-4145.02 5958.5,-4061.24 5958.5,-4061.24"/>
<polygon fill="black" stroke="black" points="5962,-4061.24 5958.5,-4051.24 5955,-4061.24 5962,-4061.24"/>
</g>
<!-- mha_l2_g14&#45;&gt;mha_l2_g15 -->
<g id="edge344" class="edge">
<title>mha_l2_g14&#45;&gt;mha_l2_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6419.53,-4179C6419.53,-4179 6525.22,-4179 6525.22,-4179"/>
<polygon fill="red" stroke="red" points="6525.22,-4182.5 6535.22,-4179 6525.22,-4175.5 6525.22,-4182.5"/>
</g>
<!-- mha_l2_g14&#45;&gt;concat_l2_hg3 -->
<g id="edge105" class="edge">
<title>mha_l2_g14&#45;&gt;concat_l2_hg3</title>
<path fill="none" stroke="black" d="M6233.5,-4145.02C6233.5,-4145.02 6233.5,-4017.64 6233.5,-4017.64"/>
<polygon fill="black" stroke="black" points="6237,-4017.64 6233.5,-4007.64 6230,-4017.64 6237,-4017.64"/>
</g>
<!-- mha_l2_g15&#45;&gt;concat_l2_hg3 -->
<g id="edge106" class="edge">
<title>mha_l2_g15&#45;&gt;concat_l2_hg3</title>
<path fill="none" stroke="black" d="M6562.88,-4145.36C6562.88,-4094.61 6562.88,-4005 6562.88,-4005 6562.88,-4005 6252.13,-4005 6252.13,-4005"/>
<polygon fill="black" stroke="black" points="6252.13,-4001.5 6242.13,-4005 6252.13,-4008.5 6252.13,-4001.5"/>
</g>
<!-- final_concat_l2 -->
<g id="node64" class="node">
<title>final_concat_l2</title>
<path fill="#ff8c00" stroke="black" d="M4785.37,-3862.45C4785.37,-3862.45 4599.63,-3815.35 4599.63,-3815.35 4593.82,-3813.88 4593.82,-3810.93 4599.63,-3809.45 4599.63,-3809.45 4785.37,-3762.35 4785.37,-3762.35 4791.18,-3760.88 4802.82,-3760.88 4808.63,-3762.35 4808.63,-3762.35 4994.37,-3809.45 4994.37,-3809.45 5000.18,-3810.93 5000.18,-3813.88 4994.37,-3815.35 4994.37,-3815.35 4808.63,-3862.45 4808.63,-3862.45 4802.82,-3863.93 4791.18,-3863.93 4785.37,-3862.45"/>
<text text-anchor="middle" x="4797" y="-3823.7" font-family="Times,serif" font-size="14.00">Final Concat</text>
<text text-anchor="middle" x="4797" y="-3808.7" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
<text text-anchor="middle" x="4797" y="-3793.7" font-family="Times,serif" font-size="14.00">All heads combined</text>
</g>
<!-- concat_l2_hg0&#45;&gt;final_concat_l2 -->
<g id="edge107" class="edge">
<title>concat_l2_hg0&#45;&gt;final_concat_l2</title>
<path fill="none" stroke="black" d="M2614,-3952.33C2614,-3889.71 2614,-3794 2614,-3794 2614,-3794 4650.44,-3794 4650.44,-3794"/>
<polygon fill="black" stroke="black" points="4650.44,-3797.5 4660.44,-3794 4650.44,-3790.5 4650.44,-3797.5"/>
</g>
<!-- concat_l2_hg1&#45;&gt;final_concat_l2 -->
<g id="edge108" class="edge">
<title>concat_l2_hg1&#45;&gt;final_concat_l2</title>
<path fill="none" stroke="black" d="M4081,-4001.41C4081,-3975.3 4081,-3830 4081,-3830 4081,-3830 4647.25,-3830 4647.25,-3830"/>
<polygon fill="black" stroke="black" points="4647.25,-3833.5 4657.25,-3830 4647.25,-3826.5 4647.25,-3833.5"/>
</g>
<!-- concat_l2_hg2&#45;&gt;final_concat_l2 -->
<g id="edge109" class="edge">
<title>concat_l2_hg2&#45;&gt;final_concat_l2</title>
<path fill="none" stroke="black" d="M4797,-3952.15C4797,-3952.15 4797,-3875.48 4797,-3875.48"/>
<polygon fill="black" stroke="black" points="4800.5,-3875.48 4797,-3865.48 4793.5,-3875.48 4800.5,-3875.48"/>
</g>
<!-- concat_l2_hg3&#45;&gt;final_concat_l2 -->
<g id="edge110" class="edge">
<title>concat_l2_hg3&#45;&gt;final_concat_l2</title>
<path fill="none" stroke="black" d="M5753.5,-4002.96C5753.5,-3980.57 5753.5,-3812 5753.5,-3812 5753.5,-3812 5014.55,-3812 5014.55,-3812"/>
<polygon fill="black" stroke="black" points="5014.55,-3808.5 5004.55,-3812 5014.55,-3815.5 5014.55,-3808.5"/>
</g>
<!-- final_concat_l2&#45;&gt;ln1_l2 -->
<g id="edge111" class="edge">
<title>final_concat_l2&#45;&gt;ln1_l2</title>
<path fill="none" stroke="black" d="M4973.99,-3803.9C4973.99,-3803.9 4973.99,-3676.94 4973.99,-3676.94"/>
<polygon fill="black" stroke="black" points="4977.49,-3676.94 4973.99,-3666.94 4970.49,-3676.94 4977.49,-3676.94"/>
</g>
<!-- ffn_l2_g0 -->
<g id="node65" class="node">
<title>ffn_l2_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M3333,-3390.92C3333,-3390.92 3195,-3390.92 3195,-3390.92 3189,-3390.92 3183,-3384.92 3183,-3378.92 3183,-3378.92 3183,-3334.92 3183,-3334.92 3183,-3328.92 3189,-3322.92 3195,-3322.92 3195,-3322.92 3333,-3322.92 3333,-3322.92 3339,-3322.92 3345,-3328.92 3345,-3334.92 3345,-3334.92 3345,-3378.92 3345,-3378.92 3345,-3384.92 3339,-3390.92 3333,-3390.92"/>
<text text-anchor="middle" x="3264" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 0</text>
<text text-anchor="middle" x="3264" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3264" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3264" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ffn_concat_l2 -->
<g id="node81" class="node">
<title>ffn_concat_l2</title>
<path fill="#90ee90" stroke="black" d="M5012.19,-3233.77C5012.19,-3233.77 4826.81,-3200.07 4826.81,-3200.07 4820.9,-3198.99 4820.9,-3196.85 4826.81,-3195.77 4826.81,-3195.77 5012.19,-3162.07 5012.19,-3162.07 5018.1,-3160.99 5029.9,-3160.99 5035.81,-3162.07 5035.81,-3162.07 5221.19,-3195.77 5221.19,-3195.77 5227.1,-3196.85 5227.1,-3198.99 5221.19,-3200.07 5221.19,-3200.07 5035.81,-3233.77 5035.81,-3233.77 5029.9,-3234.85 5018.1,-3234.85 5012.19,-3233.77"/>
<text text-anchor="middle" x="5024" y="-3201.72" font-family="Times,serif" font-size="14.00">FFN Concat</text>
<text text-anchor="middle" x="5024" y="-3186.72" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ffn_l2_g0&#45;&gt;ffn_concat_l2 -->
<g id="edge130" class="edge">
<title>ffn_l2_g0&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M3264,-3322.89C3264,-3268.74 3264,-3169 3264,-3169 3264,-3169 4963.69,-3169 4963.69,-3169"/>
<polygon fill="black" stroke="black" points="4963.69,-3172.5 4973.69,-3169 4963.69,-3165.5 4963.69,-3172.5"/>
</g>
<!-- ffn_l2_g1 -->
<g id="node66" class="node">
<title>ffn_l2_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M3553,-3390.92C3553,-3390.92 3415,-3390.92 3415,-3390.92 3409,-3390.92 3403,-3384.92 3403,-3378.92 3403,-3378.92 3403,-3334.92 3403,-3334.92 3403,-3328.92 3409,-3322.92 3415,-3322.92 3415,-3322.92 3553,-3322.92 3553,-3322.92 3559,-3322.92 3565,-3328.92 3565,-3334.92 3565,-3334.92 3565,-3378.92 3565,-3378.92 3565,-3384.92 3559,-3390.92 3553,-3390.92"/>
<text text-anchor="middle" x="3484" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 1</text>
<text text-anchor="middle" x="3484" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3484" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3484" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn_l2_g1&#45;&gt;ffn_concat_l2 -->
<g id="edge131" class="edge">
<title>ffn_l2_g1&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M3484,-3322.85C3484,-3270.93 3484,-3178 3484,-3178 3484,-3178 4914.44,-3178 4914.44,-3178"/>
<polygon fill="black" stroke="black" points="4914.44,-3181.5 4924.44,-3178 4914.44,-3174.5 4914.44,-3181.5"/>
</g>
<!-- ffn_l2_g2 -->
<g id="node67" class="node">
<title>ffn_l2_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M3773,-3390.92C3773,-3390.92 3635,-3390.92 3635,-3390.92 3629,-3390.92 3623,-3384.92 3623,-3378.92 3623,-3378.92 3623,-3334.92 3623,-3334.92 3623,-3328.92 3629,-3322.92 3635,-3322.92 3635,-3322.92 3773,-3322.92 3773,-3322.92 3779,-3322.92 3785,-3328.92 3785,-3334.92 3785,-3334.92 3785,-3378.92 3785,-3378.92 3785,-3384.92 3779,-3390.92 3773,-3390.92"/>
<text text-anchor="middle" x="3704" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 2</text>
<text text-anchor="middle" x="3704" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3704" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3704" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn_l2_g2&#45;&gt;ffn_concat_l2 -->
<g id="edge132" class="edge">
<title>ffn_l2_g2&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M3732.25,-3322.74C3732.25,-3273.38 3732.25,-3188 3732.25,-3188 3732.25,-3188 4859.47,-3188 4859.47,-3188"/>
<polygon fill="black" stroke="black" points="4859.47,-3191.5 4869.47,-3188 4859.47,-3184.5 4859.47,-3191.5"/>
</g>
<!-- ffn_l2_g3 -->
<g id="node68" class="node">
<title>ffn_l2_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M3993,-3390.92C3993,-3390.92 3855,-3390.92 3855,-3390.92 3849,-3390.92 3843,-3384.92 3843,-3378.92 3843,-3378.92 3843,-3334.92 3843,-3334.92 3843,-3328.92 3849,-3322.92 3855,-3322.92 3855,-3322.92 3993,-3322.92 3993,-3322.92 3999,-3322.92 4005,-3328.92 4005,-3334.92 4005,-3334.92 4005,-3378.92 4005,-3378.92 4005,-3384.92 3999,-3390.92 3993,-3390.92"/>
<text text-anchor="middle" x="3924" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 3</text>
<text text-anchor="middle" x="3924" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="3924" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="3924" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn_l2_g3&#45;&gt;ffn_concat_l2 -->
<g id="edge133" class="edge">
<title>ffn_l2_g3&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M3944.5,-3322.61C3944.5,-3275.62 3944.5,-3197 3944.5,-3197 3944.5,-3197 4810,-3197 4810,-3197"/>
<polygon fill="black" stroke="black" points="4810,-3200.5 4820,-3197 4810,-3193.5 4810,-3200.5"/>
</g>
<!-- ffn_l2_g4 -->
<g id="node69" class="node">
<title>ffn_l2_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M4213,-3390.92C4213,-3390.92 4075,-3390.92 4075,-3390.92 4069,-3390.92 4063,-3384.92 4063,-3378.92 4063,-3378.92 4063,-3334.92 4063,-3334.92 4063,-3328.92 4069,-3322.92 4075,-3322.92 4075,-3322.92 4213,-3322.92 4213,-3322.92 4219,-3322.92 4225,-3328.92 4225,-3334.92 4225,-3334.92 4225,-3378.92 4225,-3378.92 4225,-3384.92 4219,-3390.92 4213,-3390.92"/>
<text text-anchor="middle" x="4144" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 4</text>
<text text-anchor="middle" x="4144" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4144" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4144" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn_l2_g4&#45;&gt;ffn_concat_l2 -->
<g id="edge134" class="edge">
<title>ffn_l2_g4&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M4217.25,-3322.9C4217.25,-3278.67 4217.25,-3207 4217.25,-3207 4217.25,-3207 4854.61,-3207 4854.61,-3207"/>
<polygon fill="black" stroke="black" points="4854.61,-3210.5 4864.61,-3207 4854.61,-3203.5 4854.61,-3210.5"/>
</g>
<!-- ffn_l2_g5 -->
<g id="node70" class="node">
<title>ffn_l2_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M4433,-3390.92C4433,-3390.92 4295,-3390.92 4295,-3390.92 4289,-3390.92 4283,-3384.92 4283,-3378.92 4283,-3378.92 4283,-3334.92 4283,-3334.92 4283,-3328.92 4289,-3322.92 4295,-3322.92 4295,-3322.92 4433,-3322.92 4433,-3322.92 4439,-3322.92 4445,-3328.92 4445,-3334.92 4445,-3334.92 4445,-3378.92 4445,-3378.92 4445,-3384.92 4439,-3390.92 4433,-3390.92"/>
<text text-anchor="middle" x="4364" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 5</text>
<text text-anchor="middle" x="4364" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4364" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4364" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn_l2_g5&#45;&gt;ffn_concat_l2 -->
<g id="edge135" class="edge">
<title>ffn_l2_g5&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M4365.33,-3322.81C4365.33,-3281.1 4365.33,-3216 4365.33,-3216 4365.33,-3216 4904.12,-3216 4904.12,-3216"/>
<polygon fill="black" stroke="black" points="4904.12,-3219.5 4914.12,-3216 4904.12,-3212.5 4904.12,-3219.5"/>
</g>
<!-- ffn_l2_g6 -->
<g id="node71" class="node">
<title>ffn_l2_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M4653,-3390.92C4653,-3390.92 4515,-3390.92 4515,-3390.92 4509,-3390.92 4503,-3384.92 4503,-3378.92 4503,-3378.92 4503,-3334.92 4503,-3334.92 4503,-3328.92 4509,-3322.92 4515,-3322.92 4515,-3322.92 4653,-3322.92 4653,-3322.92 4659,-3322.92 4665,-3328.92 4665,-3334.92 4665,-3334.92 4665,-3378.92 4665,-3378.92 4665,-3384.92 4659,-3390.92 4653,-3390.92"/>
<text text-anchor="middle" x="4584" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 6</text>
<text text-anchor="middle" x="4584" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4584" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4584" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn_l2_g6&#45;&gt;ffn_concat_l2 -->
<g id="edge136" class="edge">
<title>ffn_l2_g6&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M4659.5,-3322.86C4659.5,-3284.07 4659.5,-3226 4659.5,-3226 4659.5,-3226 4959.43,-3226 4959.43,-3226"/>
<polygon fill="black" stroke="black" points="4959.43,-3229.5 4969.43,-3226 4959.43,-3222.5 4959.43,-3229.5"/>
</g>
<!-- ffn_l2_g7 -->
<g id="node72" class="node">
<title>ffn_l2_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M4873,-3390.92C4873,-3390.92 4735,-3390.92 4735,-3390.92 4729,-3390.92 4723,-3384.92 4723,-3378.92 4723,-3378.92 4723,-3334.92 4723,-3334.92 4723,-3328.92 4729,-3322.92 4735,-3322.92 4735,-3322.92 4873,-3322.92 4873,-3322.92 4879,-3322.92 4885,-3328.92 4885,-3334.92 4885,-3334.92 4885,-3378.92 4885,-3378.92 4885,-3384.92 4879,-3390.92 4873,-3390.92"/>
<text text-anchor="middle" x="4804" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 7</text>
<text text-anchor="middle" x="4804" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4804" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4804" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn_l2_g7&#45;&gt;ffn_concat_l2 -->
<g id="edge137" class="edge">
<title>ffn_l2_g7&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M4850,-3322.81C4850,-3322.81 4850,-3214.29 4850,-3214.29"/>
<polygon fill="black" stroke="black" points="4853.5,-3214.29 4850,-3204.29 4846.5,-3214.29 4853.5,-3214.29"/>
</g>
<!-- ffn_l2_g8 -->
<g id="node73" class="node">
<title>ffn_l2_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M5093,-3390.92C5093,-3390.92 4955,-3390.92 4955,-3390.92 4949,-3390.92 4943,-3384.92 4943,-3378.92 4943,-3378.92 4943,-3334.92 4943,-3334.92 4943,-3328.92 4949,-3322.92 4955,-3322.92 4955,-3322.92 5093,-3322.92 5093,-3322.92 5099,-3322.92 5105,-3328.92 5105,-3334.92 5105,-3334.92 5105,-3378.92 5105,-3378.92 5105,-3384.92 5099,-3390.92 5093,-3390.92"/>
<text text-anchor="middle" x="5024" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 8</text>
<text text-anchor="middle" x="5024" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5024" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5024" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn_l2_g8&#45;&gt;ffn_concat_l2 -->
<g id="edge138" class="edge">
<title>ffn_l2_g8&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M5024,-3322.81C5024,-3322.81 5024,-3246.16 5024,-3246.16"/>
<polygon fill="black" stroke="black" points="5027.5,-3246.16 5024,-3236.16 5020.5,-3246.16 5027.5,-3246.16"/>
</g>
<!-- ffn_l2_g9 -->
<g id="node74" class="node">
<title>ffn_l2_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M5313,-3390.92C5313,-3390.92 5175,-3390.92 5175,-3390.92 5169,-3390.92 5163,-3384.92 5163,-3378.92 5163,-3378.92 5163,-3334.92 5163,-3334.92 5163,-3328.92 5169,-3322.92 5175,-3322.92 5175,-3322.92 5313,-3322.92 5313,-3322.92 5319,-3322.92 5325,-3328.92 5325,-3334.92 5325,-3334.92 5325,-3378.92 5325,-3378.92 5325,-3384.92 5319,-3390.92 5313,-3390.92"/>
<text text-anchor="middle" x="5244" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 9</text>
<text text-anchor="middle" x="5244" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5244" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5244" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn_l2_g9&#45;&gt;ffn_concat_l2 -->
<g id="edge139" class="edge">
<title>ffn_l2_g9&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M5198,-3322.81C5198,-3322.81 5198,-3214.29 5198,-3214.29"/>
<polygon fill="black" stroke="black" points="5201.5,-3214.29 5198,-3204.29 5194.5,-3214.29 5201.5,-3214.29"/>
</g>
<!-- ffn_l2_g10 -->
<g id="node75" class="node">
<title>ffn_l2_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M5533,-3390.92C5533,-3390.92 5395,-3390.92 5395,-3390.92 5389,-3390.92 5383,-3384.92 5383,-3378.92 5383,-3378.92 5383,-3334.92 5383,-3334.92 5383,-3328.92 5389,-3322.92 5395,-3322.92 5395,-3322.92 5533,-3322.92 5533,-3322.92 5539,-3322.92 5545,-3328.92 5545,-3334.92 5545,-3334.92 5545,-3378.92 5545,-3378.92 5545,-3384.92 5539,-3390.92 5533,-3390.92"/>
<text text-anchor="middle" x="5464" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 10</text>
<text text-anchor="middle" x="5464" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5464" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5464" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn_l2_g10&#45;&gt;ffn_concat_l2 -->
<g id="edge140" class="edge">
<title>ffn_l2_g10&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M5423.33,-3322.86C5423.33,-3284.07 5423.33,-3226 5423.33,-3226 5423.33,-3226 5088.69,-3226 5088.69,-3226"/>
<polygon fill="black" stroke="black" points="5088.69,-3222.5 5078.69,-3226 5088.69,-3229.5 5088.69,-3222.5"/>
</g>
<!-- ffn_l2_g11 -->
<g id="node76" class="node">
<title>ffn_l2_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M5753,-3390.92C5753,-3390.92 5615,-3390.92 5615,-3390.92 5609,-3390.92 5603,-3384.92 5603,-3378.92 5603,-3378.92 5603,-3334.92 5603,-3334.92 5603,-3328.92 5609,-3322.92 5615,-3322.92 5615,-3322.92 5753,-3322.92 5753,-3322.92 5759,-3322.92 5765,-3328.92 5765,-3334.92 5765,-3334.92 5765,-3378.92 5765,-3378.92 5765,-3384.92 5759,-3390.92 5753,-3390.92"/>
<text text-anchor="middle" x="5684" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 11</text>
<text text-anchor="middle" x="5684" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5684" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5684" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn_l2_g11&#45;&gt;ffn_concat_l2 -->
<g id="edge141" class="edge">
<title>ffn_l2_g11&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M5657,-3322.81C5657,-3281.1 5657,-3216 5657,-3216 5657,-3216 5143.9,-3216 5143.9,-3216"/>
<polygon fill="black" stroke="black" points="5143.9,-3212.5 5133.9,-3216 5143.9,-3219.5 5143.9,-3212.5"/>
</g>
<!-- ffn_l2_g12 -->
<g id="node77" class="node">
<title>ffn_l2_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M5973,-3390.92C5973,-3390.92 5835,-3390.92 5835,-3390.92 5829,-3390.92 5823,-3384.92 5823,-3378.92 5823,-3378.92 5823,-3334.92 5823,-3334.92 5823,-3328.92 5829,-3322.92 5835,-3322.92 5835,-3322.92 5973,-3322.92 5973,-3322.92 5979,-3322.92 5985,-3328.92 5985,-3334.92 5985,-3334.92 5985,-3378.92 5985,-3378.92 5985,-3384.92 5979,-3390.92 5973,-3390.92"/>
<text text-anchor="middle" x="5904" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 12</text>
<text text-anchor="middle" x="5904" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5904" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5904" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn_l2_g12&#45;&gt;ffn_concat_l2 -->
<g id="edge142" class="edge">
<title>ffn_l2_g12&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M5852.75,-3322.9C5852.75,-3278.67 5852.75,-3207 5852.75,-3207 5852.75,-3207 5193.3,-3207 5193.3,-3207"/>
<polygon fill="black" stroke="black" points="5193.3,-3203.5 5183.3,-3207 5193.3,-3210.5 5193.3,-3203.5"/>
</g>
<!-- ffn_l2_g13 -->
<g id="node78" class="node">
<title>ffn_l2_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M6193,-3390.92C6193,-3390.92 6055,-3390.92 6055,-3390.92 6049,-3390.92 6043,-3384.92 6043,-3378.92 6043,-3378.92 6043,-3334.92 6043,-3334.92 6043,-3328.92 6049,-3322.92 6055,-3322.92 6055,-3322.92 6193,-3322.92 6193,-3322.92 6199,-3322.92 6205,-3328.92 6205,-3334.92 6205,-3334.92 6205,-3378.92 6205,-3378.92 6205,-3384.92 6199,-3390.92 6193,-3390.92"/>
<text text-anchor="middle" x="6124" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 13</text>
<text text-anchor="middle" x="6124" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6124" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6124" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn_l2_g13&#45;&gt;ffn_concat_l2 -->
<g id="edge143" class="edge">
<title>ffn_l2_g13&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M6058.5,-3322.61C6058.5,-3275.62 6058.5,-3197 6058.5,-3197 6058.5,-3197 5238.08,-3197 5238.08,-3197"/>
<polygon fill="black" stroke="black" points="5238.08,-3193.5 5228.08,-3197 5238.08,-3200.5 5238.08,-3193.5"/>
</g>
<!-- ffn_l2_g14 -->
<g id="node79" class="node">
<title>ffn_l2_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M6413,-3390.92C6413,-3390.92 6275,-3390.92 6275,-3390.92 6269,-3390.92 6263,-3384.92 6263,-3378.92 6263,-3378.92 6263,-3334.92 6263,-3334.92 6263,-3328.92 6269,-3322.92 6275,-3322.92 6275,-3322.92 6413,-3322.92 6413,-3322.92 6419,-3322.92 6425,-3328.92 6425,-3334.92 6425,-3334.92 6425,-3378.92 6425,-3378.92 6425,-3384.92 6419,-3390.92 6413,-3390.92"/>
<text text-anchor="middle" x="6344" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 14</text>
<text text-anchor="middle" x="6344" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6344" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6344" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn_l2_g14&#45;&gt;ffn_concat_l2 -->
<g id="edge144" class="edge">
<title>ffn_l2_g14&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M6298.01,-3322.74C6298.01,-3273.38 6298.01,-3188 6298.01,-3188 6298.01,-3188 5188.63,-3188 5188.63,-3188"/>
<polygon fill="black" stroke="black" points="5188.63,-3184.5 5178.63,-3188 5188.63,-3191.5 5188.63,-3184.5"/>
</g>
<!-- ffn_l2_g15 -->
<g id="node80" class="node">
<title>ffn_l2_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M6633,-3390.92C6633,-3390.92 6495,-3390.92 6495,-3390.92 6489,-3390.92 6483,-3384.92 6483,-3378.92 6483,-3378.92 6483,-3334.92 6483,-3334.92 6483,-3328.92 6489,-3322.92 6495,-3322.92 6495,-3322.92 6633,-3322.92 6633,-3322.92 6639,-3322.92 6645,-3328.92 6645,-3334.92 6645,-3334.92 6645,-3378.92 6645,-3378.92 6645,-3384.92 6639,-3390.92 6633,-3390.92"/>
<text text-anchor="middle" x="6564" y="-3375.72" font-family="Times,serif" font-size="14.00">FFN Partition 15</text>
<text text-anchor="middle" x="6564" y="-3360.72" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6564" y="-3345.72" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6564" y="-3330.72" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn_l2_g15&#45;&gt;ffn_concat_l2 -->
<g id="edge145" class="edge">
<title>ffn_l2_g15&#45;&gt;ffn_concat_l2</title>
<path fill="none" stroke="black" d="M6564,-3322.85C6564,-3270.93 6564,-3178 6564,-3178 6564,-3178 5133.56,-3178 5133.56,-3178"/>
<polygon fill="black" stroke="black" points="5133.56,-3174.5 5123.56,-3178 5133.56,-3181.5 5133.56,-3174.5"/>
</g>
<!-- ln2_l2 -->
<g id="node83" class="node">
<title>ln2_l2</title>
<ellipse fill="#e6e6fa" stroke="black" cx="6251" cy="-3046.05" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="6251" y="-3049.85" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="6251" y="-3034.85" font-family="Times,serif" font-size="14.00">L2</text>
</g>
<!-- ffn_concat_l2&#45;&gt;ln2_l2 -->
<g id="edge146" class="edge">
<title>ffn_concat_l2&#45;&gt;ln2_l2</title>
<path fill="none" stroke="black" d="M5073.97,-3169C5296.58,-3169 6186.99,-3169 6186.99,-3169 6186.99,-3169 6186.99,-3072.89 6186.99,-3072.89"/>
<polygon fill="black" stroke="black" points="6190.49,-3072.89 6186.99,-3062.89 6183.49,-3072.89 6190.49,-3072.89"/>
</g>
<!-- residual_l2 -->
<g id="node84" class="node">
<title>residual_l2</title>
<ellipse fill="#f5f5dc" stroke="black" cx="5024" cy="-3504.79" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="5024" y="-3508.59" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="5024" y="-3493.59" font-family="Times,serif" font-size="14.00">L2</text>
</g>
<!-- ln1_l2&#45;&gt;residual_l2 -->
<g id="edge113" class="edge">
<title>ln1_l2&#45;&gt;residual_l2</title>
<path fill="none" stroke="black" d="M5024,-3618.39C5024,-3618.39 5024,-3541.84 5024,-3541.84"/>
<polygon fill="black" stroke="black" points="5027.5,-3541.84 5024,-3531.84 5020.5,-3541.84 5027.5,-3541.84"/>
</g>
<!-- layer2_output -->
<g id="node85" class="node">
<title>layer2_output</title>
<path fill="#2e86ab" stroke="#2e86ab" stroke-width="2" d="M6343.5,-2932.18C6343.5,-2932.18 6158.5,-2932.18 6158.5,-2932.18 6152.5,-2932.18 6146.5,-2926.18 6146.5,-2920.18 6146.5,-2920.18 6146.5,-2906.18 6146.5,-2906.18 6146.5,-2900.18 6152.5,-2894.18 6158.5,-2894.18 6158.5,-2894.18 6343.5,-2894.18 6343.5,-2894.18 6349.5,-2894.18 6355.5,-2900.18 6355.5,-2906.18 6355.5,-2906.18 6355.5,-2920.18 6355.5,-2920.18 6355.5,-2926.18 6349.5,-2932.18 6343.5,-2932.18"/>
<text text-anchor="middle" x="6251" y="-2916.98" font-family="Times,serif" font-size="14.00">Layer 2 Output</text>
<text text-anchor="middle" x="6251" y="-2901.98" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ln2_l2&#45;&gt;layer2_output -->
<g id="edge148" class="edge">
<title>ln2_l2&#45;&gt;layer2_output</title>
<path fill="none" stroke="black" d="M6251,-3019.16C6251,-3019.16 6251,-2942.3 6251,-2942.3"/>
<polygon fill="black" stroke="black" points="6254.5,-2942.3 6251,-2932.3 6247.5,-2942.3 6254.5,-2942.3"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g0 -->
<g id="edge114" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g0</title>
<path fill="none" stroke="black" d="M4987.34,-3525C4740.03,-3525 3325.25,-3525 3325.25,-3525 3325.25,-3525 3325.25,-3400.93 3325.25,-3400.93"/>
<polygon fill="black" stroke="black" points="3328.75,-3400.93 3325.25,-3390.93 3321.75,-3400.93 3328.75,-3400.93"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g1 -->
<g id="edge115" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g1</title>
<path fill="none" stroke="black" d="M4976.93,-3519C4719.47,-3519 3493.25,-3519 3493.25,-3519 3493.25,-3519 3493.25,-3401.29 3493.25,-3401.29"/>
<polygon fill="black" stroke="black" points="3496.75,-3401.29 3493.25,-3391.29 3489.75,-3401.29 3496.75,-3401.29"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g2 -->
<g id="edge116" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g2</title>
<path fill="none" stroke="black" d="M4971.44,-3513C4725.94,-3513 3704,-3513 3704,-3513 3704,-3513 3704,-3401.17 3704,-3401.17"/>
<polygon fill="black" stroke="black" points="3707.5,-3401.17 3704,-3391.17 3700.5,-3401.17 3707.5,-3401.17"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g3 -->
<g id="edge117" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g3</title>
<path fill="none" stroke="black" d="M4968.7,-3507C4745.64,-3507 3924,-3507 3924,-3507 3924,-3507 3924,-3400.98 3924,-3400.98"/>
<polygon fill="black" stroke="black" points="3927.5,-3400.98 3924,-3390.98 3920.5,-3400.98 3927.5,-3400.98"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g4 -->
<g id="edge118" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g4</title>
<path fill="none" stroke="black" d="M4969.1,-3501C4779.23,-3501 4162,-3501 4162,-3501 4162,-3501 4162,-3401.07 4162,-3401.07"/>
<polygon fill="black" stroke="black" points="4165.5,-3401.07 4162,-3391.07 4158.5,-3401.07 4165.5,-3401.07"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g5 -->
<g id="edge119" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g5</title>
<path fill="none" stroke="black" d="M4972.55,-3495C4821.32,-3495 4388.75,-3495 4388.75,-3495 4388.75,-3495 4388.75,-3401.05 4388.75,-3401.05"/>
<polygon fill="black" stroke="black" points="4392.25,-3401.05 4388.75,-3391.05 4385.25,-3401.05 4392.25,-3401.05"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g6 -->
<g id="edge120" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g6</title>
<path fill="none" stroke="black" d="M4979.17,-3489C4875.22,-3489 4626.5,-3489 4626.5,-3489 4626.5,-3489 4626.5,-3400.93 4626.5,-3400.93"/>
<polygon fill="black" stroke="black" points="4630,-3400.93 4626.5,-3390.93 4623,-3400.93 4630,-3400.93"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g7 -->
<g id="edge121" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g7</title>
<path fill="none" stroke="black" d="M4991.54,-3483C4930.34,-3483 4804,-3483 4804,-3483 4804,-3483 4804,-3401.04 4804,-3401.04"/>
<polygon fill="black" stroke="black" points="4807.5,-3401.04 4804,-3391.04 4800.5,-3401.04 4807.5,-3401.04"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g8 -->
<g id="edge122" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g8</title>
<path fill="none" stroke="black" d="M5024,-3477.67C5024,-3477.67 5024,-3401.16 5024,-3401.16"/>
<polygon fill="black" stroke="black" points="5027.5,-3401.16 5024,-3391.16 5020.5,-3401.16 5027.5,-3401.16"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g9 -->
<g id="edge123" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g9</title>
<path fill="none" stroke="black" d="M5056.6,-3483C5100.79,-3483 5174.25,-3483 5174.25,-3483 5174.25,-3483 5174.25,-3401.04 5174.25,-3401.04"/>
<polygon fill="black" stroke="black" points="5177.75,-3401.04 5174.25,-3391.04 5170.75,-3401.04 5177.75,-3401.04"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g10 -->
<g id="edge124" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g10</title>
<path fill="none" stroke="black" d="M5068.74,-3489C5177.28,-3489 5445.75,-3489 5445.75,-3489 5445.75,-3489 5445.75,-3400.93 5445.75,-3400.93"/>
<polygon fill="black" stroke="black" points="5449.25,-3400.93 5445.75,-3390.93 5442.25,-3400.93 5449.25,-3400.93"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g11 -->
<g id="edge125" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g11</title>
<path fill="none" stroke="black" d="M5075.43,-3495C5228.81,-3495 5672.5,-3495 5672.5,-3495 5672.5,-3495 5672.5,-3401.05 5672.5,-3401.05"/>
<polygon fill="black" stroke="black" points="5676,-3401.05 5672.5,-3391.05 5669,-3401.05 5676,-3401.05"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g12 -->
<g id="edge126" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g12</title>
<path fill="none" stroke="black" d="M5078.72,-3501C5270.97,-3501 5904,-3501 5904,-3501 5904,-3501 5904,-3401.07 5904,-3401.07"/>
<polygon fill="black" stroke="black" points="5907.5,-3401.07 5904,-3391.07 5900.5,-3401.07 5907.5,-3401.07"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g13 -->
<g id="edge127" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g13</title>
<path fill="none" stroke="black" d="M5079.3,-3507C5302.36,-3507 6124,-3507 6124,-3507 6124,-3507 6124,-3400.98 6124,-3400.98"/>
<polygon fill="black" stroke="black" points="6127.5,-3400.98 6124,-3390.98 6120.5,-3400.98 6127.5,-3400.98"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g14 -->
<g id="edge128" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g14</title>
<path fill="none" stroke="black" d="M5070.88,-3519C5305.54,-3519 6341.25,-3519 6341.25,-3519 6341.25,-3519 6341.25,-3401.29 6341.25,-3401.29"/>
<polygon fill="black" stroke="black" points="6344.75,-3401.29 6341.25,-3391.29 6337.75,-3401.29 6344.75,-3401.29"/>
</g>
<!-- residual_l2&#45;&gt;ffn_l2_g15 -->
<g id="edge129" class="edge">
<title>residual_l2&#45;&gt;ffn_l2_g15</title>
<path fill="none" stroke="black" d="M5060.71,-3525C5289.43,-3525 6509.25,-3525 6509.25,-3525 6509.25,-3525 6509.25,-3400.93 6509.25,-3400.93"/>
<polygon fill="black" stroke="black" points="6512.75,-3400.93 6509.25,-3390.93 6505.75,-3400.93 6512.75,-3400.93"/>
</g>
<!-- residual_l2&#45;&gt;ln2_l2 -->
<g id="edge147" class="edge">
<title>residual_l2&#45;&gt;ln2_l2</title>
<path fill="none" stroke="black" d="M5076.74,-3513C5308.44,-3513 6224.5,-3513 6224.5,-3513 6224.5,-3513 6224.5,-3081.49 6224.5,-3081.49"/>
<polygon fill="black" stroke="black" points="6228,-3081.49 6224.5,-3071.49 6221,-3081.49 6228,-3081.49"/>
</g>
<!-- mha_l3_g0 -->
<g id="node86" class="node">
<title>mha_l3_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M3874.5,-2774.18C3874.5,-2774.18 3691.5,-2774.18 3691.5,-2774.18 3685.5,-2774.18 3679.5,-2768.18 3679.5,-2762.18 3679.5,-2762.18 3679.5,-2718.18 3679.5,-2718.18 3679.5,-2712.18 3685.5,-2706.18 3691.5,-2706.18 3691.5,-2706.18 3874.5,-2706.18 3874.5,-2706.18 3880.5,-2706.18 3886.5,-2712.18 3886.5,-2718.18 3886.5,-2718.18 3886.5,-2762.18 3886.5,-2762.18 3886.5,-2768.18 3880.5,-2774.18 3874.5,-2774.18"/>
<text text-anchor="middle" x="3783" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 0</text>
<text text-anchor="middle" x="3783" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="3783" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="3783" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g0 -->
<g id="edge149" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g0</title>
<path fill="none" stroke="black" d="M6146.46,-2927C5685.08,-2927 3853.88,-2927 3853.88,-2927 3853.88,-2927 3853.88,-2784.45 3853.88,-2784.45"/>
<polygon fill="black" stroke="black" points="3857.38,-2784.45 3853.88,-2774.45 3850.38,-2784.45 3857.38,-2784.45"/>
</g>
<!-- mha_l3_g1 -->
<g id="node87" class="node">
<title>mha_l3_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M4197.5,-2774.18C4197.5,-2774.18 4014.5,-2774.18 4014.5,-2774.18 4008.5,-2774.18 4002.5,-2768.18 4002.5,-2762.18 4002.5,-2762.18 4002.5,-2718.18 4002.5,-2718.18 4002.5,-2712.18 4008.5,-2706.18 4014.5,-2706.18 4014.5,-2706.18 4197.5,-2706.18 4197.5,-2706.18 4203.5,-2706.18 4209.5,-2712.18 4209.5,-2718.18 4209.5,-2718.18 4209.5,-2762.18 4209.5,-2762.18 4209.5,-2768.18 4203.5,-2774.18 4197.5,-2774.18"/>
<text text-anchor="middle" x="4106" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 1</text>
<text text-anchor="middle" x="4106" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="4106" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4106" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g1 -->
<g id="edge150" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g1</title>
<path fill="none" stroke="black" d="M6146.49,-2923C5720.31,-2923 4136.25,-2923 4136.25,-2923 4136.25,-2923 4136.25,-2784.57 4136.25,-2784.57"/>
<polygon fill="black" stroke="black" points="4139.75,-2784.57 4136.25,-2774.57 4132.75,-2784.57 4139.75,-2784.57"/>
</g>
<!-- mha_l3_g2 -->
<g id="node88" class="node">
<title>mha_l3_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M4520.5,-2774.18C4520.5,-2774.18 4337.5,-2774.18 4337.5,-2774.18 4331.5,-2774.18 4325.5,-2768.18 4325.5,-2762.18 4325.5,-2762.18 4325.5,-2718.18 4325.5,-2718.18 4325.5,-2712.18 4331.5,-2706.18 4337.5,-2706.18 4337.5,-2706.18 4520.5,-2706.18 4520.5,-2706.18 4526.5,-2706.18 4532.5,-2712.18 4532.5,-2718.18 4532.5,-2718.18 4532.5,-2762.18 4532.5,-2762.18 4532.5,-2768.18 4526.5,-2774.18 4520.5,-2774.18"/>
<text text-anchor="middle" x="4429" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 2</text>
<text text-anchor="middle" x="4429" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="4429" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4429" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g2 -->
<g id="edge151" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g2</title>
<path fill="none" stroke="black" d="M6146.48,-2919C5771.75,-2919 4517.75,-2919 4517.75,-2919 4517.75,-2919 4517.75,-2784.24 4517.75,-2784.24"/>
<polygon fill="black" stroke="black" points="4521.25,-2784.24 4517.75,-2774.24 4514.25,-2784.24 4521.25,-2784.24"/>
</g>
<!-- mha_l3_g3 -->
<g id="node89" class="node">
<title>mha_l3_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M4843.5,-2774.18C4843.5,-2774.18 4660.5,-2774.18 4660.5,-2774.18 4654.5,-2774.18 4648.5,-2768.18 4648.5,-2762.18 4648.5,-2762.18 4648.5,-2718.18 4648.5,-2718.18 4648.5,-2712.18 4654.5,-2706.18 4660.5,-2706.18 4660.5,-2706.18 4843.5,-2706.18 4843.5,-2706.18 4849.5,-2706.18 4855.5,-2712.18 4855.5,-2718.18 4855.5,-2718.18 4855.5,-2762.18 4855.5,-2762.18 4855.5,-2768.18 4849.5,-2774.18 4843.5,-2774.18"/>
<text text-anchor="middle" x="4752" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 3</text>
<text text-anchor="middle" x="4752" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="4752" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="4752" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g3 -->
<g id="edge152" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g3</title>
<path fill="none" stroke="black" d="M6146.32,-2915C5818.79,-2915 4835.25,-2915 4835.25,-2915 4835.25,-2915 4835.25,-2784.3 4835.25,-2784.3"/>
<polygon fill="black" stroke="black" points="4838.75,-2784.3 4835.25,-2774.3 4831.75,-2784.3 4838.75,-2784.3"/>
</g>
<!-- mha_l3_g4 -->
<g id="node90" class="node">
<title>mha_l3_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M5108.5,-2774.18C5108.5,-2774.18 4925.5,-2774.18 4925.5,-2774.18 4919.5,-2774.18 4913.5,-2768.18 4913.5,-2762.18 4913.5,-2762.18 4913.5,-2718.18 4913.5,-2718.18 4913.5,-2712.18 4919.5,-2706.18 4925.5,-2706.18 4925.5,-2706.18 5108.5,-2706.18 5108.5,-2706.18 5114.5,-2706.18 5120.5,-2712.18 5120.5,-2718.18 5120.5,-2718.18 5120.5,-2762.18 5120.5,-2762.18 5120.5,-2768.18 5114.5,-2774.18 5108.5,-2774.18"/>
<text text-anchor="middle" x="5017" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 4</text>
<text text-anchor="middle" x="5017" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="5017" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5017" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g4 -->
<g id="edge153" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g4</title>
<path fill="none" stroke="black" d="M6146.32,-2911C5848.36,-2911 5017,-2911 5017,-2911 5017,-2911 5017,-2784.34 5017,-2784.34"/>
<polygon fill="black" stroke="black" points="5020.5,-2784.34 5017,-2774.34 5013.5,-2784.34 5020.5,-2784.34"/>
</g>
<!-- mha_l3_g5 -->
<g id="node91" class="node">
<title>mha_l3_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M5431.5,-2774.18C5431.5,-2774.18 5248.5,-2774.18 5248.5,-2774.18 5242.5,-2774.18 5236.5,-2768.18 5236.5,-2762.18 5236.5,-2762.18 5236.5,-2718.18 5236.5,-2718.18 5236.5,-2712.18 5242.5,-2706.18 5248.5,-2706.18 5248.5,-2706.18 5431.5,-2706.18 5431.5,-2706.18 5437.5,-2706.18 5443.5,-2712.18 5443.5,-2718.18 5443.5,-2718.18 5443.5,-2762.18 5443.5,-2762.18 5443.5,-2768.18 5437.5,-2774.18 5431.5,-2774.18"/>
<text text-anchor="middle" x="5340" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 5</text>
<text text-anchor="middle" x="5340" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="5340" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5340" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g5 -->
<g id="edge154" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g5</title>
<path fill="none" stroke="black" d="M6146.19,-2906C5919.35,-2906 5403.17,-2906 5403.17,-2906 5403.17,-2906 5403.17,-2784.54 5403.17,-2784.54"/>
<polygon fill="black" stroke="black" points="5406.67,-2784.54 5403.17,-2774.54 5399.67,-2784.54 5406.67,-2784.54"/>
</g>
<!-- mha_l3_g6 -->
<g id="node92" class="node">
<title>mha_l3_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M5754.5,-2774.18C5754.5,-2774.18 5571.5,-2774.18 5571.5,-2774.18 5565.5,-2774.18 5559.5,-2768.18 5559.5,-2762.18 5559.5,-2762.18 5559.5,-2718.18 5559.5,-2718.18 5559.5,-2712.18 5565.5,-2706.18 5571.5,-2706.18 5571.5,-2706.18 5754.5,-2706.18 5754.5,-2706.18 5760.5,-2706.18 5766.5,-2712.18 5766.5,-2718.18 5766.5,-2718.18 5766.5,-2762.18 5766.5,-2762.18 5766.5,-2768.18 5760.5,-2774.18 5754.5,-2774.18"/>
<text text-anchor="middle" x="5663" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 6</text>
<text text-anchor="middle" x="5663" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="5663" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5663" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g6 -->
<g id="edge155" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g6</title>
<path fill="none" stroke="black" d="M6146.24,-2902C5989.21,-2902 5711,-2902 5711,-2902 5711,-2902 5711,-2784.5 5711,-2784.5"/>
<polygon fill="black" stroke="black" points="5714.5,-2784.5 5711,-2774.5 5707.5,-2784.5 5714.5,-2784.5"/>
</g>
<!-- mha_l3_g7 -->
<g id="node93" class="node">
<title>mha_l3_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M6077.5,-2774.18C6077.5,-2774.18 5894.5,-2774.18 5894.5,-2774.18 5888.5,-2774.18 5882.5,-2768.18 5882.5,-2762.18 5882.5,-2762.18 5882.5,-2718.18 5882.5,-2718.18 5882.5,-2712.18 5888.5,-2706.18 5894.5,-2706.18 5894.5,-2706.18 6077.5,-2706.18 6077.5,-2706.18 6083.5,-2706.18 6089.5,-2712.18 6089.5,-2718.18 6089.5,-2718.18 6089.5,-2762.18 6089.5,-2762.18 6089.5,-2768.18 6083.5,-2774.18 6077.5,-2774.18"/>
<text text-anchor="middle" x="5986" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 7</text>
<text text-anchor="middle" x="5986" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="5986" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5986" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g7 -->
<g id="edge156" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g7</title>
<path fill="none" stroke="black" d="M6146.25,-2898C6108.03,-2898 6074,-2898 6074,-2898 6074,-2898 6074,-2784.43 6074,-2784.43"/>
<polygon fill="black" stroke="black" points="6077.5,-2784.43 6074,-2774.43 6070.5,-2784.43 6077.5,-2784.43"/>
</g>
<!-- mha_l3_g8 -->
<g id="node94" class="node">
<title>mha_l3_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M6342.5,-2774.18C6342.5,-2774.18 6159.5,-2774.18 6159.5,-2774.18 6153.5,-2774.18 6147.5,-2768.18 6147.5,-2762.18 6147.5,-2762.18 6147.5,-2718.18 6147.5,-2718.18 6147.5,-2712.18 6153.5,-2706.18 6159.5,-2706.18 6159.5,-2706.18 6342.5,-2706.18 6342.5,-2706.18 6348.5,-2706.18 6354.5,-2712.18 6354.5,-2718.18 6354.5,-2718.18 6354.5,-2762.18 6354.5,-2762.18 6354.5,-2768.18 6348.5,-2774.18 6342.5,-2774.18"/>
<text text-anchor="middle" x="6251" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 8</text>
<text text-anchor="middle" x="6251" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="6251" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6251" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g8 -->
<g id="edge157" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g8</title>
<path fill="none" stroke="black" d="M6251,-2894.01C6251,-2894.01 6251,-2784.32 6251,-2784.32"/>
<polygon fill="black" stroke="black" points="6254.5,-2784.32 6251,-2774.32 6247.5,-2784.32 6254.5,-2784.32"/>
</g>
<!-- mha_l3_g9 -->
<g id="node95" class="node">
<title>mha_l3_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M6665.5,-2774.18C6665.5,-2774.18 6482.5,-2774.18 6482.5,-2774.18 6476.5,-2774.18 6470.5,-2768.18 6470.5,-2762.18 6470.5,-2762.18 6470.5,-2718.18 6470.5,-2718.18 6470.5,-2712.18 6476.5,-2706.18 6482.5,-2706.18 6482.5,-2706.18 6665.5,-2706.18 6665.5,-2706.18 6671.5,-2706.18 6677.5,-2712.18 6677.5,-2718.18 6677.5,-2718.18 6677.5,-2762.18 6677.5,-2762.18 6677.5,-2768.18 6671.5,-2774.18 6665.5,-2774.18"/>
<text text-anchor="middle" x="6574" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 9</text>
<text text-anchor="middle" x="6574" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="6574" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6574" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g9 -->
<g id="edge158" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g9</title>
<path fill="none" stroke="black" d="M6355.61,-2898C6414.67,-2898 6476.75,-2898 6476.75,-2898 6476.75,-2898 6476.75,-2784.43 6476.75,-2784.43"/>
<polygon fill="black" stroke="black" points="6480.25,-2784.43 6476.75,-2774.43 6473.25,-2784.43 6480.25,-2784.43"/>
</g>
<!-- mha_l3_g10 -->
<g id="node96" class="node">
<title>mha_l3_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M6988.5,-2774.18C6988.5,-2774.18 6805.5,-2774.18 6805.5,-2774.18 6799.5,-2774.18 6793.5,-2768.18 6793.5,-2762.18 6793.5,-2762.18 6793.5,-2718.18 6793.5,-2718.18 6793.5,-2712.18 6799.5,-2706.18 6805.5,-2706.18 6805.5,-2706.18 6988.5,-2706.18 6988.5,-2706.18 6994.5,-2706.18 7000.5,-2712.18 7000.5,-2718.18 7000.5,-2718.18 7000.5,-2762.18 7000.5,-2762.18 7000.5,-2768.18 6994.5,-2774.18 6988.5,-2774.18"/>
<text text-anchor="middle" x="6897" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 10</text>
<text text-anchor="middle" x="6897" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="6897" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6897" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g10 -->
<g id="edge159" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g10</title>
<path fill="none" stroke="black" d="M6355.51,-2902C6538.34,-2902 6897,-2902 6897,-2902 6897,-2902 6897,-2784.5 6897,-2784.5"/>
<polygon fill="black" stroke="black" points="6900.5,-2784.5 6897,-2774.5 6893.5,-2784.5 6900.5,-2784.5"/>
</g>
<!-- mha_l3_g11 -->
<g id="node97" class="node">
<title>mha_l3_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M7311.5,-2774.18C7311.5,-2774.18 7128.5,-2774.18 7128.5,-2774.18 7122.5,-2774.18 7116.5,-2768.18 7116.5,-2762.18 7116.5,-2762.18 7116.5,-2718.18 7116.5,-2718.18 7116.5,-2712.18 7122.5,-2706.18 7128.5,-2706.18 7128.5,-2706.18 7311.5,-2706.18 7311.5,-2706.18 7317.5,-2706.18 7323.5,-2712.18 7323.5,-2718.18 7323.5,-2718.18 7323.5,-2762.18 7323.5,-2762.18 7323.5,-2768.18 7317.5,-2774.18 7311.5,-2774.18"/>
<text text-anchor="middle" x="7220" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 11</text>
<text text-anchor="middle" x="7220" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="7220" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7220" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g11 -->
<g id="edge160" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g11</title>
<path fill="none" stroke="black" d="M6355.55,-2911C6612.57,-2911 7254.5,-2911 7254.5,-2911 7254.5,-2911 7254.5,-2784.34 7254.5,-2784.34"/>
<polygon fill="black" stroke="black" points="7258,-2784.34 7254.5,-2774.34 7251,-2784.34 7258,-2784.34"/>
</g>
<!-- mha_l3_g12 -->
<g id="node98" class="node">
<title>mha_l3_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M7576.5,-2774.18C7576.5,-2774.18 7393.5,-2774.18 7393.5,-2774.18 7387.5,-2774.18 7381.5,-2768.18 7381.5,-2762.18 7381.5,-2762.18 7381.5,-2718.18 7381.5,-2718.18 7381.5,-2712.18 7387.5,-2706.18 7393.5,-2706.18 7393.5,-2706.18 7576.5,-2706.18 7576.5,-2706.18 7582.5,-2706.18 7588.5,-2712.18 7588.5,-2718.18 7588.5,-2718.18 7588.5,-2762.18 7588.5,-2762.18 7588.5,-2768.18 7582.5,-2774.18 7576.5,-2774.18"/>
<text text-anchor="middle" x="7485" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 12</text>
<text text-anchor="middle" x="7485" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="7485" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7485" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g12 -->
<g id="edge161" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g12</title>
<path fill="none" stroke="black" d="M6355.68,-2915C6653.64,-2915 7485,-2915 7485,-2915 7485,-2915 7485,-2784.3 7485,-2784.3"/>
<polygon fill="black" stroke="black" points="7488.5,-2784.3 7485,-2774.3 7481.5,-2784.3 7488.5,-2784.3"/>
</g>
<!-- mha_l3_g13 -->
<g id="node99" class="node">
<title>mha_l3_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M7899.5,-2774.18C7899.5,-2774.18 7716.5,-2774.18 7716.5,-2774.18 7710.5,-2774.18 7704.5,-2768.18 7704.5,-2762.18 7704.5,-2762.18 7704.5,-2718.18 7704.5,-2718.18 7704.5,-2712.18 7710.5,-2706.18 7716.5,-2706.18 7716.5,-2706.18 7899.5,-2706.18 7899.5,-2706.18 7905.5,-2706.18 7911.5,-2712.18 7911.5,-2718.18 7911.5,-2718.18 7911.5,-2762.18 7911.5,-2762.18 7911.5,-2768.18 7905.5,-2774.18 7899.5,-2774.18"/>
<text text-anchor="middle" x="7808" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 13</text>
<text text-anchor="middle" x="7808" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="7808" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7808" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g13 -->
<g id="edge162" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g13</title>
<path fill="none" stroke="black" d="M6355.58,-2919C6704.68,-2919 7808,-2919 7808,-2919 7808,-2919 7808,-2784.24 7808,-2784.24"/>
<polygon fill="black" stroke="black" points="7811.5,-2784.24 7808,-2774.24 7804.5,-2784.24 7811.5,-2784.24"/>
</g>
<!-- mha_l3_g14 -->
<g id="node100" class="node">
<title>mha_l3_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M8222.5,-2774.18C8222.5,-2774.18 8039.5,-2774.18 8039.5,-2774.18 8033.5,-2774.18 8027.5,-2768.18 8027.5,-2762.18 8027.5,-2762.18 8027.5,-2718.18 8027.5,-2718.18 8027.5,-2712.18 8033.5,-2706.18 8039.5,-2706.18 8039.5,-2706.18 8222.5,-2706.18 8222.5,-2706.18 8228.5,-2706.18 8234.5,-2712.18 8234.5,-2718.18 8234.5,-2718.18 8234.5,-2762.18 8234.5,-2762.18 8234.5,-2768.18 8228.5,-2774.18 8222.5,-2774.18"/>
<text text-anchor="middle" x="8131" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 14</text>
<text text-anchor="middle" x="8131" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="8131" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="8131" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g14 -->
<g id="edge163" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g14</title>
<path fill="none" stroke="black" d="M6355.77,-2923C6751.24,-2923 8131,-2923 8131,-2923 8131,-2923 8131,-2784.57 8131,-2784.57"/>
<polygon fill="black" stroke="black" points="8134.5,-2784.57 8131,-2774.57 8127.5,-2784.57 8134.5,-2784.57"/>
</g>
<!-- mha_l3_g15 -->
<g id="node101" class="node">
<title>mha_l3_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M8545.5,-2774.18C8545.5,-2774.18 8362.5,-2774.18 8362.5,-2774.18 8356.5,-2774.18 8350.5,-2768.18 8350.5,-2762.18 8350.5,-2762.18 8350.5,-2718.18 8350.5,-2718.18 8350.5,-2712.18 8356.5,-2706.18 8362.5,-2706.18 8362.5,-2706.18 8545.5,-2706.18 8545.5,-2706.18 8551.5,-2706.18 8557.5,-2712.18 8557.5,-2718.18 8557.5,-2718.18 8557.5,-2762.18 8557.5,-2762.18 8557.5,-2768.18 8551.5,-2774.18 8545.5,-2774.18"/>
<text text-anchor="middle" x="8454" y="-2758.98" font-family="Times,serif" font-size="14.00">MHA Partition 15</text>
<text text-anchor="middle" x="8454" y="-2743.98" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="8454" y="-2728.98" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="8454" y="-2713.98" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_output&#45;&gt;mha_l3_g15 -->
<g id="edge164" class="edge">
<title>layer2_output&#45;&gt;mha_l3_g15</title>
<path fill="none" stroke="black" d="M6355.77,-2927C6793.58,-2927 8454,-2927 8454,-2927 8454,-2927 8454,-2784.45 8454,-2784.45"/>
<polygon fill="black" stroke="black" points="8457.5,-2784.45 8454,-2774.45 8450.5,-2784.45 8457.5,-2784.45"/>
</g>
<!-- ln1_l3 -->
<g id="node124" class="node">
<title>ln1_l3</title>
<ellipse fill="#e6e6fa" stroke="black" cx="6726" cy="-2206.31" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="6726" y="-2210.11" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="6726" y="-2195.11" font-family="Times,serif" font-size="14.00">L3</text>
</g>
<!-- layer2_output&#45;&gt;ln1_l3 -->
<g id="edge186" class="edge">
<title>layer2_output&#45;&gt;ln1_l3</title>
<path fill="none" stroke="black" d="M6355.73,-2906C6358.04,-2906 6359.33,-2906 6359.33,-2906 6359.33,-2906 6359.33,-2206 6359.33,-2206 6359.33,-2206 6633.71,-2206 6633.71,-2206"/>
<polygon fill="black" stroke="black" points="6633.71,-2209.5 6643.71,-2206 6633.71,-2202.5 6633.71,-2209.5"/>
</g>
<!-- mha_l3_g0&#45;&gt;mha_l3_g1 -->
<g id="edge345" class="edge">
<title>mha_l3_g0&#45;&gt;mha_l3_g1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3886.53,-2740C3886.53,-2740 3992.22,-2740 3992.22,-2740"/>
<polygon fill="red" stroke="red" points="3992.22,-2743.5 4002.22,-2740 3992.22,-2736.5 3992.22,-2743.5"/>
</g>
<!-- mha_l3_g0&#45;&gt;mha_l3_g2 -->
<g id="edge346" class="edge">
<title>mha_l3_g0&#45;&gt;mha_l3_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3875.62,-2774.33C3875.62,-2789.51 3875.62,-2804 3875.62,-2804 3875.62,-2804 4405.17,-2804 4405.17,-2804 4405.17,-2804 4405.17,-2784.33 4405.17,-2784.33"/>
<polygon fill="red" stroke="red" points="4408.67,-2784.33 4405.17,-2774.33 4401.67,-2784.33 4408.67,-2784.33"/>
<text text-anchor="middle" x="4246" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g0&#45;&gt;mha_l3_g3 -->
<g id="edge347" class="edge">
<title>mha_l3_g0&#45;&gt;mha_l3_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3864.75,-2774.34C3864.75,-2810.99 3864.75,-2864 3864.75,-2864 3864.75,-2864 4654,-2864 4654,-2864 4654,-2864 4654,-2784.34 4654,-2784.34"/>
<polygon fill="red" stroke="red" points="4657.5,-2784.34 4654,-2774.34 4650.5,-2784.34 4657.5,-2784.34"/>
<text text-anchor="middle" x="4351" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l3_hg0 -->
<g id="node102" class="node">
<title>concat_l3_hg0</title>
<path fill="#ffb347" stroke="black" d="M4417.26,-2616.7C4417.26,-2616.7 4189.74,-2568.66 4189.74,-2568.66 4183.87,-2567.42 4183.87,-2564.94 4189.74,-2563.7 4189.74,-2563.7 4417.26,-2515.66 4417.26,-2515.66 4423.13,-2514.42 4434.87,-2514.42 4440.74,-2515.66 4440.74,-2515.66 4668.26,-2563.7 4668.26,-2563.7 4674.13,-2564.94 4674.13,-2567.42 4668.26,-2568.66 4668.26,-2568.66 4440.74,-2616.7 4440.74,-2616.7 4434.87,-2617.94 4423.13,-2617.94 4417.26,-2616.7"/>
<text text-anchor="middle" x="4429" y="-2577.48" font-family="Times,serif" font-size="14.00">Concat Head Group 0</text>
<text text-anchor="middle" x="4429" y="-2562.48" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="4429" y="-2547.48" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l3_g0&#45;&gt;concat_l3_hg0 -->
<g id="edge165" class="edge">
<title>mha_l3_g0&#45;&gt;concat_l3_hg0</title>
<path fill="none" stroke="black" d="M3783,-2705.77C3783,-2655.01 3783,-2566 3783,-2566 3783,-2566 4168.78,-2566 4168.78,-2566"/>
<polygon fill="black" stroke="black" points="4168.78,-2569.5 4178.78,-2566 4168.78,-2562.5 4168.78,-2569.5"/>
</g>
<!-- mha_l3_g1&#45;&gt;mha_l3_g2 -->
<g id="edge348" class="edge">
<title>mha_l3_g1&#45;&gt;mha_l3_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4209.53,-2740C4209.53,-2740 4315.22,-2740 4315.22,-2740"/>
<polygon fill="red" stroke="red" points="4315.22,-2743.5 4325.22,-2740 4315.22,-2736.5 4315.22,-2743.5"/>
</g>
<!-- mha_l3_g1&#45;&gt;mha_l3_g3 -->
<g id="edge349" class="edge">
<title>mha_l3_g1&#45;&gt;mha_l3_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4199,-2705.92C4199,-2672.6 4199,-2627 4199,-2627 4199,-2627 4659,-2627 4659,-2627 4659,-2627 4659,-2695.92 4659,-2695.92"/>
<polygon fill="red" stroke="red" points="4655.5,-2695.92 4659,-2705.92 4662.5,-2695.92 4655.5,-2695.92"/>
<text text-anchor="middle" x="4456" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g1&#45;&gt;concat_l3_hg0 -->
<g id="edge166" class="edge">
<title>mha_l3_g1&#45;&gt;concat_l3_hg0</title>
<path fill="none" stroke="black" d="M4188.5,-2705.8C4188.5,-2705.8 4188.5,-2578.42 4188.5,-2578.42"/>
<polygon fill="black" stroke="black" points="4192,-2578.42 4188.5,-2568.42 4185,-2578.42 4192,-2578.42"/>
</g>
<!-- mha_l3_g2&#45;&gt;mha_l3_g3 -->
<g id="edge350" class="edge">
<title>mha_l3_g2&#45;&gt;mha_l3_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4532.53,-2740C4532.53,-2740 4638.22,-2740 4638.22,-2740"/>
<polygon fill="red" stroke="red" points="4638.22,-2743.5 4648.22,-2740 4638.22,-2736.5 4638.22,-2743.5"/>
</g>
<!-- mha_l3_g2&#45;&gt;concat_l3_hg0 -->
<g id="edge167" class="edge">
<title>mha_l3_g2&#45;&gt;concat_l3_hg0</title>
<path fill="none" stroke="black" d="M4429,-2705.8C4429,-2705.8 4429,-2629.33 4429,-2629.33"/>
<polygon fill="black" stroke="black" points="4432.5,-2629.33 4429,-2619.33 4425.5,-2629.33 4432.5,-2629.33"/>
</g>
<!-- mha_l3_g3&#45;&gt;concat_l3_hg0 -->
<g id="edge168" class="edge">
<title>mha_l3_g3&#45;&gt;concat_l3_hg0</title>
<path fill="none" stroke="black" d="M4669.5,-2705.8C4669.5,-2705.8 4669.5,-2578.42 4669.5,-2578.42"/>
<polygon fill="black" stroke="black" points="4673,-2578.42 4669.5,-2568.42 4666,-2578.42 4673,-2578.42"/>
</g>
<!-- mha_l3_g4&#45;&gt;mha_l3_g5 -->
<g id="edge351" class="edge">
<title>mha_l3_g4&#45;&gt;mha_l3_g5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5120.53,-2740C5120.53,-2740 5226.22,-2740 5226.22,-2740"/>
<polygon fill="red" stroke="red" points="5226.22,-2743.5 5236.22,-2740 5226.22,-2736.5 5226.22,-2743.5"/>
</g>
<!-- mha_l3_g4&#45;&gt;mha_l3_g6 -->
<g id="edge352" class="edge">
<title>mha_l3_g4&#45;&gt;mha_l3_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5116.62,-2706.09C5116.62,-2678.78 5116.62,-2645 5116.62,-2645 5116.62,-2645 5628.5,-2645 5628.5,-2645 5628.5,-2645 5628.5,-2696.09 5628.5,-2696.09"/>
<polygon fill="red" stroke="red" points="5625,-2696.09 5628.5,-2706.09 5632,-2696.09 5625,-2696.09"/>
<text text-anchor="middle" x="5459" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g4&#45;&gt;mha_l3_g7 -->
<g id="edge353" class="edge">
<title>mha_l3_g4&#45;&gt;mha_l3_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5108.88,-2706.07C5108.88,-2675.68 5108.88,-2636 5108.88,-2636 5108.88,-2636 5898.25,-2636 5898.25,-2636 5898.25,-2636 5898.25,-2696.07 5898.25,-2696.07"/>
<polygon fill="red" stroke="red" points="5894.75,-2696.07 5898.25,-2706.07 5901.75,-2696.07 5894.75,-2696.07"/>
<text text-anchor="middle" x="5662" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l3_hg1 -->
<g id="node103" class="node">
<title>concat_l3_hg1</title>
<path fill="#ffb347" stroke="black" d="M5651.26,-2616.7C5651.26,-2616.7 5423.74,-2568.66 5423.74,-2568.66 5417.87,-2567.42 5417.87,-2564.94 5423.74,-2563.7 5423.74,-2563.7 5651.26,-2515.66 5651.26,-2515.66 5657.13,-2514.42 5668.87,-2514.42 5674.74,-2515.66 5674.74,-2515.66 5902.26,-2563.7 5902.26,-2563.7 5908.13,-2564.94 5908.13,-2567.42 5902.26,-2568.66 5902.26,-2568.66 5674.74,-2616.7 5674.74,-2616.7 5668.87,-2617.94 5657.13,-2617.94 5651.26,-2616.7"/>
<text text-anchor="middle" x="5663" y="-2577.48" font-family="Times,serif" font-size="14.00">Concat Head Group 1</text>
<text text-anchor="middle" x="5663" y="-2562.48" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="5663" y="-2547.48" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l3_g4&#45;&gt;concat_l3_hg1 -->
<g id="edge169" class="edge">
<title>mha_l3_g4&#45;&gt;concat_l3_hg1</title>
<path fill="none" stroke="black" d="M5112.75,-2705.77C5112.75,-2655.01 5112.75,-2566 5112.75,-2566 5112.75,-2566 5402.83,-2566 5402.83,-2566"/>
<polygon fill="black" stroke="black" points="5402.83,-2569.5 5412.83,-2566 5402.83,-2562.5 5402.83,-2569.5"/>
</g>
<!-- mha_l3_g5&#45;&gt;mha_l3_g6 -->
<g id="edge354" class="edge">
<title>mha_l3_g5&#45;&gt;mha_l3_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5443.53,-2740C5443.53,-2740 5549.22,-2740 5549.22,-2740"/>
<polygon fill="red" stroke="red" points="5549.22,-2743.5 5559.22,-2740 5549.22,-2736.5 5549.22,-2743.5"/>
</g>
<!-- mha_l3_g5&#45;&gt;mha_l3_g7 -->
<g id="edge355" class="edge">
<title>mha_l3_g5&#45;&gt;mha_l3_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5433,-2705.97C5433,-2681.55 5433,-2653 5433,-2653 5433,-2653 5890.38,-2653 5890.38,-2653 5890.38,-2653 5890.38,-2695.97 5890.38,-2695.97"/>
<polygon fill="red" stroke="red" points="5886.88,-2695.97 5890.38,-2705.97 5893.88,-2695.97 5886.88,-2695.97"/>
<text text-anchor="middle" x="5757" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g5&#45;&gt;concat_l3_hg1 -->
<g id="edge170" class="edge">
<title>mha_l3_g5&#45;&gt;concat_l3_hg1</title>
<path fill="none" stroke="black" d="M5422.5,-2705.8C5422.5,-2705.8 5422.5,-2578.42 5422.5,-2578.42"/>
<polygon fill="black" stroke="black" points="5426,-2578.42 5422.5,-2568.42 5419,-2578.42 5426,-2578.42"/>
</g>
<!-- mha_l3_g6&#45;&gt;mha_l3_g7 -->
<g id="edge356" class="edge">
<title>mha_l3_g6&#45;&gt;mha_l3_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5766.53,-2740C5766.53,-2740 5872.22,-2740 5872.22,-2740"/>
<polygon fill="red" stroke="red" points="5872.22,-2743.5 5882.22,-2740 5872.22,-2736.5 5872.22,-2743.5"/>
</g>
<!-- mha_l3_g6&#45;&gt;concat_l3_hg1 -->
<g id="edge171" class="edge">
<title>mha_l3_g6&#45;&gt;concat_l3_hg1</title>
<path fill="none" stroke="black" d="M5697.5,-2705.8C5697.5,-2705.8 5697.5,-2622.02 5697.5,-2622.02"/>
<polygon fill="black" stroke="black" points="5701,-2622.02 5697.5,-2612.02 5694,-2622.02 5701,-2622.02"/>
</g>
<!-- mha_l3_g7&#45;&gt;concat_l3_hg1 -->
<g id="edge172" class="edge">
<title>mha_l3_g7&#45;&gt;concat_l3_hg1</title>
<path fill="none" stroke="black" d="M5906.12,-2705.8C5906.12,-2705.8 5906.12,-2578.07 5906.12,-2578.07"/>
<polygon fill="black" stroke="black" points="5909.63,-2578.07 5906.12,-2568.07 5902.63,-2578.07 5909.63,-2578.07"/>
</g>
<!-- mha_l3_g8&#45;&gt;mha_l3_g9 -->
<g id="edge357" class="edge">
<title>mha_l3_g8&#45;&gt;mha_l3_g9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6354.53,-2751C6354.53,-2751 6460.22,-2751 6460.22,-2751"/>
<polygon fill="red" stroke="red" points="6460.22,-2754.5 6470.22,-2751 6460.22,-2747.5 6460.22,-2754.5"/>
</g>
<!-- mha_l3_g8&#45;&gt;mha_l3_g10 -->
<g id="edge358" class="edge">
<title>mha_l3_g8&#45;&gt;mha_l3_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.67,-2706C6304.67,-2688.57 6304.67,-2671 6304.67,-2671 6304.67,-2671 6823,-2671 6823,-2671 6823,-2671 6823,-2696 6823,-2696"/>
<polygon fill="red" stroke="red" points="6819.5,-2696 6823,-2706 6826.5,-2696 6819.5,-2696"/>
<text text-anchor="middle" x="6451" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g8&#45;&gt;mha_l3_g11 -->
<g id="edge359" class="edge">
<title>mha_l3_g8&#45;&gt;mha_l3_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6254.83,-2706.12C6254.83,-2685.05 6254.83,-2662 6254.83,-2662 6254.83,-2662 7160,-2662 7160,-2662 7160,-2662 7160,-2696.12 7160,-2696.12"/>
<polygon fill="red" stroke="red" points="7156.5,-2696.12 7160,-2706.12 7163.5,-2696.12 7156.5,-2696.12"/>
<text text-anchor="middle" x="6508" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l3_hg2 -->
<g id="node104" class="node">
<title>concat_l3_hg2</title>
<path fill="#ffb347" stroke="black" d="M6619.26,-2616.7C6619.26,-2616.7 6391.74,-2568.66 6391.74,-2568.66 6385.87,-2567.42 6385.87,-2564.94 6391.74,-2563.7 6391.74,-2563.7 6619.26,-2515.66 6619.26,-2515.66 6625.13,-2514.42 6636.87,-2514.42 6642.74,-2515.66 6642.74,-2515.66 6870.26,-2563.7 6870.26,-2563.7 6876.13,-2564.94 6876.13,-2567.42 6870.26,-2568.66 6870.26,-2568.66 6642.74,-2616.7 6642.74,-2616.7 6636.87,-2617.94 6625.13,-2617.94 6619.26,-2616.7"/>
<text text-anchor="middle" x="6631" y="-2577.48" font-family="Times,serif" font-size="14.00">Concat Head Group 2</text>
<text text-anchor="middle" x="6631" y="-2562.48" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="6631" y="-2547.48" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l3_g8&#45;&gt;concat_l3_hg2 -->
<g id="edge173" class="edge">
<title>mha_l3_g8&#45;&gt;concat_l3_hg2</title>
<path fill="none" stroke="black" d="M6354.56,-2728C6381.2,-2728 6402.5,-2728 6402.5,-2728 6402.5,-2728 6402.5,-2581.2 6402.5,-2581.2"/>
<polygon fill="black" stroke="black" points="6406,-2581.2 6402.5,-2571.2 6399,-2581.2 6406,-2581.2"/>
</g>
<!-- mha_l3_g9&#45;&gt;mha_l3_g10 -->
<g id="edge360" class="edge">
<title>mha_l3_g9&#45;&gt;mha_l3_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6677.53,-2740C6677.53,-2740 6783.22,-2740 6783.22,-2740"/>
<polygon fill="red" stroke="red" points="6783.22,-2743.5 6793.22,-2740 6783.22,-2736.5 6783.22,-2743.5"/>
</g>
<!-- mha_l3_g9&#45;&gt;mha_l3_g11 -->
<g id="edge361" class="edge">
<title>mha_l3_g9&#45;&gt;mha_l3_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6661.25,-2774.32C6661.25,-2801.14 6661.25,-2834 6661.25,-2834 6661.25,-2834 7185.5,-2834 7185.5,-2834 7185.5,-2834 7185.5,-2784.32 7185.5,-2784.32"/>
<polygon fill="red" stroke="red" points="7189,-2784.32 7185.5,-2774.32 7182,-2784.32 7189,-2784.32"/>
<text text-anchor="middle" x="6798" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g9&#45;&gt;concat_l3_hg2 -->
<g id="edge174" class="edge">
<title>mha_l3_g9&#45;&gt;concat_l3_hg2</title>
<path fill="none" stroke="black" d="M6574,-2705.8C6574,-2705.8 6574,-2617.22 6574,-2617.22"/>
<polygon fill="black" stroke="black" points="6577.5,-2617.22 6574,-2607.22 6570.5,-2617.22 6577.5,-2617.22"/>
</g>
<!-- mha_l3_g10&#45;&gt;mha_l3_g11 -->
<g id="edge362" class="edge">
<title>mha_l3_g10&#45;&gt;mha_l3_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7000.53,-2740C7000.53,-2740 7106.22,-2740 7106.22,-2740"/>
<polygon fill="red" stroke="red" points="7106.22,-2743.5 7116.22,-2740 7106.22,-2736.5 7106.22,-2743.5"/>
</g>
<!-- mha_l3_g10&#45;&gt;concat_l3_hg2 -->
<g id="edge175" class="edge">
<title>mha_l3_g10&#45;&gt;concat_l3_hg2</title>
<path fill="none" stroke="black" d="M6852.5,-2705.8C6852.5,-2705.8 6852.5,-2582.5 6852.5,-2582.5"/>
<polygon fill="black" stroke="black" points="6856,-2582.5 6852.5,-2572.5 6849,-2582.5 6856,-2582.5"/>
</g>
<!-- mha_l3_g11&#45;&gt;concat_l3_hg2 -->
<g id="edge176" class="edge">
<title>mha_l3_g11&#45;&gt;concat_l3_hg2</title>
<path fill="none" stroke="black" d="M7203.5,-2705.77C7203.5,-2655.01 7203.5,-2566 7203.5,-2566 7203.5,-2566 6891.27,-2566 6891.27,-2566"/>
<polygon fill="black" stroke="black" points="6891.27,-2562.5 6881.27,-2566 6891.27,-2569.5 6891.27,-2562.5"/>
</g>
<!-- mha_l3_g12&#45;&gt;mha_l3_g13 -->
<g id="edge363" class="edge">
<title>mha_l3_g12&#45;&gt;mha_l3_g13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7588.53,-2740C7588.53,-2740 7694.22,-2740 7694.22,-2740"/>
<polygon fill="red" stroke="red" points="7694.22,-2743.5 7704.22,-2740 7694.22,-2736.5 7694.22,-2743.5"/>
</g>
<!-- mha_l3_g12&#45;&gt;mha_l3_g14 -->
<g id="edge364" class="edge">
<title>mha_l3_g12&#45;&gt;mha_l3_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7580.62,-2705.96C7580.62,-2696.12 7580.62,-2688 7580.62,-2688 7580.62,-2688 8038,-2688 8038,-2688 8038,-2688 8038,-2695.96 8038,-2695.96"/>
<polygon fill="red" stroke="red" points="8034.5,-2695.96 8038,-2705.96 8041.5,-2695.96 8034.5,-2695.96"/>
<text text-anchor="middle" x="7847" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g12&#45;&gt;mha_l3_g15 -->
<g id="edge365" class="edge">
<title>mha_l3_g12&#45;&gt;mha_l3_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7572.75,-2705.87C7572.75,-2692.36 7572.75,-2680 7572.75,-2680 7572.75,-2680 8381.25,-2680 8381.25,-2680 8381.25,-2680 8381.25,-2695.87 8381.25,-2695.87"/>
<polygon fill="red" stroke="red" points="8377.75,-2695.87 8381.25,-2705.87 8384.75,-2695.87 8377.75,-2695.87"/>
<text text-anchor="middle" x="7668" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l3_hg3 -->
<g id="node105" class="node">
<title>concat_l3_hg3</title>
<path fill="#ffb347" stroke="black" d="M7796.26,-2616.7C7796.26,-2616.7 7568.74,-2568.66 7568.74,-2568.66 7562.87,-2567.42 7562.87,-2564.94 7568.74,-2563.7 7568.74,-2563.7 7796.26,-2515.66 7796.26,-2515.66 7802.13,-2514.42 7813.87,-2514.42 7819.74,-2515.66 7819.74,-2515.66 8047.26,-2563.7 8047.26,-2563.7 8053.13,-2564.94 8053.13,-2567.42 8047.26,-2568.66 8047.26,-2568.66 7819.74,-2616.7 7819.74,-2616.7 7813.87,-2617.94 7802.13,-2617.94 7796.26,-2616.7"/>
<text text-anchor="middle" x="7808" y="-2577.48" font-family="Times,serif" font-size="14.00">Concat Head Group 3</text>
<text text-anchor="middle" x="7808" y="-2562.48" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="7808" y="-2547.48" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l3_g12&#45;&gt;concat_l3_hg3 -->
<g id="edge177" class="edge">
<title>mha_l3_g12&#45;&gt;concat_l3_hg3</title>
<path fill="none" stroke="black" d="M7564.88,-2705.8C7564.88,-2705.8 7564.88,-2578.07 7564.88,-2578.07"/>
<polygon fill="black" stroke="black" points="7568.38,-2578.07 7564.88,-2568.07 7561.38,-2578.07 7568.38,-2578.07"/>
</g>
<!-- mha_l3_g13&#45;&gt;mha_l3_g14 -->
<g id="edge366" class="edge">
<title>mha_l3_g13&#45;&gt;mha_l3_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7911.53,-2740C7911.53,-2740 8017.22,-2740 8017.22,-2740"/>
<polygon fill="red" stroke="red" points="8017.22,-2743.5 8027.22,-2740 8017.22,-2736.5 8017.22,-2743.5"/>
</g>
<!-- mha_l3_g13&#45;&gt;mha_l3_g15 -->
<g id="edge367" class="edge">
<title>mha_l3_g13&#45;&gt;mha_l3_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7842.5,-2706.16C7842.5,-2700.81 7842.5,-2697 7842.5,-2697 7842.5,-2697 8371,-2697 8371,-2697 8371,-2697 8371,-2697.92 8371,-2697.92"/>
<polygon fill="red" stroke="red" points="8367.5,-2696.16 8371,-2706.16 8374.5,-2696.16 8367.5,-2696.16"/>
<text text-anchor="middle" x="8032" y="-2839.98" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l3_g13&#45;&gt;concat_l3_hg3 -->
<g id="edge178" class="edge">
<title>mha_l3_g13&#45;&gt;concat_l3_hg3</title>
<path fill="none" stroke="black" d="M7773.5,-2705.8C7773.5,-2705.8 7773.5,-2622.02 7773.5,-2622.02"/>
<polygon fill="black" stroke="black" points="7777,-2622.02 7773.5,-2612.02 7770,-2622.02 7777,-2622.02"/>
</g>
<!-- mha_l3_g14&#45;&gt;mha_l3_g15 -->
<g id="edge368" class="edge">
<title>mha_l3_g14&#45;&gt;mha_l3_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8234.53,-2740C8234.53,-2740 8340.22,-2740 8340.22,-2740"/>
<polygon fill="red" stroke="red" points="8340.22,-2743.5 8350.22,-2740 8340.22,-2736.5 8340.22,-2743.5"/>
</g>
<!-- mha_l3_g14&#45;&gt;concat_l3_hg3 -->
<g id="edge179" class="edge">
<title>mha_l3_g14&#45;&gt;concat_l3_hg3</title>
<path fill="none" stroke="black" d="M8048.5,-2705.8C8048.5,-2705.8 8048.5,-2578.42 8048.5,-2578.42"/>
<polygon fill="black" stroke="black" points="8052,-2578.42 8048.5,-2568.42 8045,-2578.42 8052,-2578.42"/>
</g>
<!-- mha_l3_g15&#45;&gt;concat_l3_hg3 -->
<g id="edge180" class="edge">
<title>mha_l3_g15&#45;&gt;concat_l3_hg3</title>
<path fill="none" stroke="black" d="M8360.75,-2705.77C8360.75,-2655.01 8360.75,-2566 8360.75,-2566 8360.75,-2566 8068.5,-2566 8068.5,-2566"/>
<polygon fill="black" stroke="black" points="8068.5,-2562.5 8058.5,-2566 8068.5,-2569.5 8068.5,-2562.5"/>
</g>
<!-- final_concat_l3 -->
<g id="node106" class="node">
<title>final_concat_l3</title>
<path fill="#ff8c00" stroke="black" d="M6619.37,-2423.23C6619.37,-2423.23 6433.63,-2376.13 6433.63,-2376.13 6427.82,-2374.66 6427.82,-2371.71 6433.63,-2370.23 6433.63,-2370.23 6619.37,-2323.13 6619.37,-2323.13 6625.18,-2321.66 6636.82,-2321.66 6642.63,-2323.13 6642.63,-2323.13 6828.37,-2370.23 6828.37,-2370.23 6834.18,-2371.71 6834.18,-2374.66 6828.37,-2376.13 6828.37,-2376.13 6642.63,-2423.23 6642.63,-2423.23 6636.82,-2424.71 6625.18,-2424.71 6619.37,-2423.23"/>
<text text-anchor="middle" x="6631" y="-2384.48" font-family="Times,serif" font-size="14.00">Final Concat</text>
<text text-anchor="middle" x="6631" y="-2369.48" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
<text text-anchor="middle" x="6631" y="-2354.48" font-family="Times,serif" font-size="14.00">All heads combined</text>
</g>
<!-- concat_l3_hg0&#45;&gt;final_concat_l3 -->
<g id="edge181" class="edge">
<title>concat_l3_hg0&#45;&gt;final_concat_l3</title>
<path fill="none" stroke="black" d="M4429,-2513.16C4429,-2450.61 4429,-2355 4429,-2355 4429,-2355 6483.67,-2355 6483.67,-2355"/>
<polygon fill="black" stroke="black" points="6483.67,-2358.5 6493.67,-2355 6483.67,-2351.5 6483.67,-2358.5"/>
</g>
<!-- concat_l3_hg1&#45;&gt;final_concat_l3 -->
<g id="edge182" class="edge">
<title>concat_l3_hg1&#45;&gt;final_concat_l3</title>
<path fill="none" stroke="black" d="M5839.5,-2550.24C5839.5,-2506.87 5839.5,-2390 5839.5,-2390 5839.5,-2390 6478.12,-2390 6478.12,-2390"/>
<polygon fill="black" stroke="black" points="6478.12,-2393.5 6488.12,-2390 6478.12,-2386.5 6478.12,-2393.5"/>
</g>
<!-- concat_l3_hg2&#45;&gt;final_concat_l3 -->
<g id="edge183" class="edge">
<title>concat_l3_hg2&#45;&gt;final_concat_l3</title>
<path fill="none" stroke="black" d="M6631,-2512.93C6631,-2512.93 6631,-2436.26 6631,-2436.26"/>
<polygon fill="black" stroke="black" points="6634.5,-2436.26 6631,-2426.26 6627.5,-2436.26 6634.5,-2436.26"/>
</g>
<!-- concat_l3_hg3&#45;&gt;final_concat_l3 -->
<g id="edge184" class="edge">
<title>concat_l3_hg3&#45;&gt;final_concat_l3</title>
<path fill="none" stroke="black" d="M7622,-2552.29C7622,-2507.99 7622,-2373 7622,-2373 7622,-2373 6849.35,-2373 6849.35,-2373"/>
<polygon fill="black" stroke="black" points="6849.35,-2369.5 6839.35,-2373 6849.35,-2376.5 6849.35,-2369.5"/>
</g>
<!-- final_concat_l3&#45;&gt;ln1_l3 -->
<g id="edge185" class="edge">
<title>final_concat_l3&#45;&gt;ln1_l3</title>
<path fill="none" stroke="black" d="M6726,-2344.11C6726,-2344.11 6726,-2243.39 6726,-2243.39"/>
<polygon fill="black" stroke="black" points="6729.5,-2243.39 6726,-2233.39 6722.5,-2243.39 6729.5,-2243.39"/>
</g>
<!-- ffn_l3_g0 -->
<g id="node107" class="node">
<title>ffn_l3_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M5035,-1951.7C5035,-1951.7 4897,-1951.7 4897,-1951.7 4891,-1951.7 4885,-1945.7 4885,-1939.7 4885,-1939.7 4885,-1895.7 4885,-1895.7 4885,-1889.7 4891,-1883.7 4897,-1883.7 4897,-1883.7 5035,-1883.7 5035,-1883.7 5041,-1883.7 5047,-1889.7 5047,-1895.7 5047,-1895.7 5047,-1939.7 5047,-1939.7 5047,-1945.7 5041,-1951.7 5035,-1951.7"/>
<text text-anchor="middle" x="4966" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 0</text>
<text text-anchor="middle" x="4966" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="4966" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="4966" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ffn_concat_l3 -->
<g id="node123" class="node">
<title>ffn_concat_l3</title>
<path fill="#90ee90" stroke="black" d="M6714.19,-1794.55C6714.19,-1794.55 6528.81,-1760.85 6528.81,-1760.85 6522.9,-1759.77 6522.9,-1757.63 6528.81,-1756.55 6528.81,-1756.55 6714.19,-1722.85 6714.19,-1722.85 6720.1,-1721.77 6731.9,-1721.77 6737.81,-1722.85 6737.81,-1722.85 6923.19,-1756.55 6923.19,-1756.55 6929.1,-1757.63 6929.1,-1759.77 6923.19,-1760.85 6923.19,-1760.85 6737.81,-1794.55 6737.81,-1794.55 6731.9,-1795.63 6720.1,-1795.63 6714.19,-1794.55"/>
<text text-anchor="middle" x="6726" y="-1762.5" font-family="Times,serif" font-size="14.00">FFN Concat</text>
<text text-anchor="middle" x="6726" y="-1747.5" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ffn_l3_g0&#45;&gt;ffn_concat_l3 -->
<g id="edge204" class="edge">
<title>ffn_l3_g0&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M4966,-1883.27C4966,-1829.09 4966,-1730 4966,-1730 4966,-1730 6664.75,-1730 6664.75,-1730"/>
<polygon fill="black" stroke="black" points="6664.75,-1733.5 6674.75,-1730 6664.75,-1726.5 6664.75,-1733.5"/>
</g>
<!-- ffn_l3_g1 -->
<g id="node108" class="node">
<title>ffn_l3_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M5255,-1951.7C5255,-1951.7 5117,-1951.7 5117,-1951.7 5111,-1951.7 5105,-1945.7 5105,-1939.7 5105,-1939.7 5105,-1895.7 5105,-1895.7 5105,-1889.7 5111,-1883.7 5117,-1883.7 5117,-1883.7 5255,-1883.7 5255,-1883.7 5261,-1883.7 5267,-1889.7 5267,-1895.7 5267,-1895.7 5267,-1939.7 5267,-1939.7 5267,-1945.7 5261,-1951.7 5255,-1951.7"/>
<text text-anchor="middle" x="5186" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 1</text>
<text text-anchor="middle" x="5186" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5186" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5186" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn_l3_g1&#45;&gt;ffn_concat_l3 -->
<g id="edge205" class="edge">
<title>ffn_l3_g1&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M5186,-1883.67C5186,-1831.82 5186,-1739 5186,-1739 5186,-1739 6615.25,-1739 6615.25,-1739"/>
<polygon fill="black" stroke="black" points="6615.25,-1742.5 6625.25,-1739 6615.25,-1735.5 6615.25,-1742.5"/>
</g>
<!-- ffn_l3_g2 -->
<g id="node109" class="node">
<title>ffn_l3_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M5475,-1951.7C5475,-1951.7 5337,-1951.7 5337,-1951.7 5331,-1951.7 5325,-1945.7 5325,-1939.7 5325,-1939.7 5325,-1895.7 5325,-1895.7 5325,-1889.7 5331,-1883.7 5337,-1883.7 5337,-1883.7 5475,-1883.7 5475,-1883.7 5481,-1883.7 5487,-1889.7 5487,-1895.7 5487,-1895.7 5487,-1939.7 5487,-1939.7 5487,-1945.7 5481,-1951.7 5475,-1951.7"/>
<text text-anchor="middle" x="5406" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 2</text>
<text text-anchor="middle" x="5406" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5406" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5406" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn_l3_g2&#45;&gt;ffn_concat_l3 -->
<g id="edge206" class="edge">
<title>ffn_l3_g2&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M5440.25,-1883.56C5440.25,-1834.27 5440.25,-1749 5440.25,-1749 5440.25,-1749 6560.27,-1749 6560.27,-1749"/>
<polygon fill="black" stroke="black" points="6560.27,-1752.5 6570.27,-1749 6560.27,-1745.5 6560.27,-1752.5"/>
</g>
<!-- ffn_l3_g3 -->
<g id="node110" class="node">
<title>ffn_l3_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M5695,-1951.7C5695,-1951.7 5557,-1951.7 5557,-1951.7 5551,-1951.7 5545,-1945.7 5545,-1939.7 5545,-1939.7 5545,-1895.7 5545,-1895.7 5545,-1889.7 5551,-1883.7 5557,-1883.7 5557,-1883.7 5695,-1883.7 5695,-1883.7 5701,-1883.7 5707,-1889.7 5707,-1895.7 5707,-1895.7 5707,-1939.7 5707,-1939.7 5707,-1945.7 5701,-1951.7 5695,-1951.7"/>
<text text-anchor="middle" x="5626" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 3</text>
<text text-anchor="middle" x="5626" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5626" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5626" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn_l3_g3&#45;&gt;ffn_concat_l3 -->
<g id="edge207" class="edge">
<title>ffn_l3_g3&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M5653.75,-1883.44C5653.75,-1836.52 5653.75,-1758 5653.75,-1758 5653.75,-1758 6510.84,-1758 6510.84,-1758"/>
<polygon fill="black" stroke="black" points="6510.84,-1761.5 6520.84,-1758 6510.84,-1754.5 6510.84,-1761.5"/>
</g>
<!-- ffn_l3_g4 -->
<g id="node111" class="node">
<title>ffn_l3_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M5915,-1951.7C5915,-1951.7 5777,-1951.7 5777,-1951.7 5771,-1951.7 5765,-1945.7 5765,-1939.7 5765,-1939.7 5765,-1895.7 5765,-1895.7 5765,-1889.7 5771,-1883.7 5777,-1883.7 5777,-1883.7 5915,-1883.7 5915,-1883.7 5921,-1883.7 5927,-1889.7 5927,-1895.7 5927,-1895.7 5927,-1939.7 5927,-1939.7 5927,-1945.7 5921,-1951.7 5915,-1951.7"/>
<text text-anchor="middle" x="5846" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 4</text>
<text text-anchor="middle" x="5846" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="5846" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="5846" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn_l3_g4&#45;&gt;ffn_concat_l3 -->
<g id="edge208" class="edge">
<title>ffn_l3_g4&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M5870.67,-1883.36C5870.67,-1839.16 5870.67,-1768 5870.67,-1768 5870.67,-1768 6558.12,-1768 6558.12,-1768"/>
<polygon fill="black" stroke="black" points="6558.12,-1771.5 6568.12,-1768 6558.12,-1764.5 6558.12,-1771.5"/>
</g>
<!-- ffn_l3_g5 -->
<g id="node112" class="node">
<title>ffn_l3_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M6135,-1951.7C6135,-1951.7 5997,-1951.7 5997,-1951.7 5991,-1951.7 5985,-1945.7 5985,-1939.7 5985,-1939.7 5985,-1895.7 5985,-1895.7 5985,-1889.7 5991,-1883.7 5997,-1883.7 5997,-1883.7 6135,-1883.7 6135,-1883.7 6141,-1883.7 6147,-1889.7 6147,-1895.7 6147,-1895.7 6147,-1939.7 6147,-1939.7 6147,-1945.7 6141,-1951.7 6135,-1951.7"/>
<text text-anchor="middle" x="6066" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 5</text>
<text text-anchor="middle" x="6066" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6066" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6066" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn_l3_g5&#45;&gt;ffn_concat_l3 -->
<g id="edge209" class="edge">
<title>ffn_l3_g5&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M6075.33,-1883.64C6075.33,-1842 6075.33,-1777 6075.33,-1777 6075.33,-1777 6607.46,-1777 6607.46,-1777"/>
<polygon fill="black" stroke="black" points="6607.46,-1780.5 6617.46,-1777 6607.46,-1773.5 6607.46,-1780.5"/>
</g>
<!-- ffn_l3_g6 -->
<g id="node113" class="node">
<title>ffn_l3_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M6355,-1951.7C6355,-1951.7 6217,-1951.7 6217,-1951.7 6211,-1951.7 6205,-1945.7 6205,-1939.7 6205,-1939.7 6205,-1895.7 6205,-1895.7 6205,-1889.7 6211,-1883.7 6217,-1883.7 6217,-1883.7 6355,-1883.7 6355,-1883.7 6361,-1883.7 6367,-1889.7 6367,-1895.7 6367,-1895.7 6367,-1939.7 6367,-1939.7 6367,-1945.7 6361,-1951.7 6355,-1951.7"/>
<text text-anchor="middle" x="6286" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 6</text>
<text text-anchor="middle" x="6286" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6286" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6286" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn_l3_g6&#45;&gt;ffn_concat_l3 -->
<g id="edge210" class="edge">
<title>ffn_l3_g6&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M6304.5,-1883.36C6304.5,-1844.64 6304.5,-1787 6304.5,-1787 6304.5,-1787 6662.62,-1787 6662.62,-1787"/>
<polygon fill="black" stroke="black" points="6662.62,-1790.5 6672.62,-1787 6662.62,-1783.5 6662.62,-1790.5"/>
</g>
<!-- ffn_l3_g7 -->
<g id="node114" class="node">
<title>ffn_l3_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M6575,-1951.7C6575,-1951.7 6437,-1951.7 6437,-1951.7 6431,-1951.7 6425,-1945.7 6425,-1939.7 6425,-1939.7 6425,-1895.7 6425,-1895.7 6425,-1889.7 6431,-1883.7 6437,-1883.7 6437,-1883.7 6575,-1883.7 6575,-1883.7 6581,-1883.7 6587,-1889.7 6587,-1895.7 6587,-1895.7 6587,-1939.7 6587,-1939.7 6587,-1945.7 6581,-1951.7 6575,-1951.7"/>
<text text-anchor="middle" x="6506" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 7</text>
<text text-anchor="middle" x="6506" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6506" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6506" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn_l3_g7&#45;&gt;ffn_concat_l3 -->
<g id="edge211" class="edge">
<title>ffn_l3_g7&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M6552,-1883.59C6552,-1883.59 6552,-1775.07 6552,-1775.07"/>
<polygon fill="black" stroke="black" points="6555.5,-1775.07 6552,-1765.07 6548.5,-1775.07 6555.5,-1775.07"/>
</g>
<!-- ffn_l3_g8 -->
<g id="node115" class="node">
<title>ffn_l3_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M6795,-1951.7C6795,-1951.7 6657,-1951.7 6657,-1951.7 6651,-1951.7 6645,-1945.7 6645,-1939.7 6645,-1939.7 6645,-1895.7 6645,-1895.7 6645,-1889.7 6651,-1883.7 6657,-1883.7 6657,-1883.7 6795,-1883.7 6795,-1883.7 6801,-1883.7 6807,-1889.7 6807,-1895.7 6807,-1895.7 6807,-1939.7 6807,-1939.7 6807,-1945.7 6801,-1951.7 6795,-1951.7"/>
<text text-anchor="middle" x="6726" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 8</text>
<text text-anchor="middle" x="6726" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6726" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6726" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn_l3_g8&#45;&gt;ffn_concat_l3 -->
<g id="edge212" class="edge">
<title>ffn_l3_g8&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M6726,-1883.59C6726,-1883.59 6726,-1806.94 6726,-1806.94"/>
<polygon fill="black" stroke="black" points="6729.5,-1806.94 6726,-1796.94 6722.5,-1806.94 6729.5,-1806.94"/>
</g>
<!-- ffn_l3_g9 -->
<g id="node116" class="node">
<title>ffn_l3_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M7015,-1951.7C7015,-1951.7 6877,-1951.7 6877,-1951.7 6871,-1951.7 6865,-1945.7 6865,-1939.7 6865,-1939.7 6865,-1895.7 6865,-1895.7 6865,-1889.7 6871,-1883.7 6877,-1883.7 6877,-1883.7 7015,-1883.7 7015,-1883.7 7021,-1883.7 7027,-1889.7 7027,-1895.7 7027,-1895.7 7027,-1939.7 7027,-1939.7 7027,-1945.7 7021,-1951.7 7015,-1951.7"/>
<text text-anchor="middle" x="6946" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 9</text>
<text text-anchor="middle" x="6946" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6946" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6946" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn_l3_g9&#45;&gt;ffn_concat_l3 -->
<g id="edge213" class="edge">
<title>ffn_l3_g9&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M6900,-1883.59C6900,-1883.59 6900,-1775.07 6900,-1775.07"/>
<polygon fill="black" stroke="black" points="6903.5,-1775.07 6900,-1765.07 6896.5,-1775.07 6903.5,-1775.07"/>
</g>
<!-- ffn_l3_g10 -->
<g id="node117" class="node">
<title>ffn_l3_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M7235,-1951.7C7235,-1951.7 7097,-1951.7 7097,-1951.7 7091,-1951.7 7085,-1945.7 7085,-1939.7 7085,-1939.7 7085,-1895.7 7085,-1895.7 7085,-1889.7 7091,-1883.7 7097,-1883.7 7097,-1883.7 7235,-1883.7 7235,-1883.7 7241,-1883.7 7247,-1889.7 7247,-1895.7 7247,-1895.7 7247,-1939.7 7247,-1939.7 7247,-1945.7 7241,-1951.7 7235,-1951.7"/>
<text text-anchor="middle" x="7166" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 10</text>
<text text-anchor="middle" x="7166" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7166" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7166" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn_l3_g10&#45;&gt;ffn_concat_l3 -->
<g id="edge214" class="edge">
<title>ffn_l3_g10&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M7133.33,-1883.53C7133.33,-1844.21 7133.33,-1785 7133.33,-1785 7133.33,-1785 6800.54,-1785 6800.54,-1785"/>
<polygon fill="black" stroke="black" points="6800.54,-1781.5 6790.54,-1785 6800.54,-1788.5 6800.54,-1781.5"/>
</g>
<!-- ffn_l3_g11 -->
<g id="node118" class="node">
<title>ffn_l3_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M7455,-1951.7C7455,-1951.7 7317,-1951.7 7317,-1951.7 7311,-1951.7 7305,-1945.7 7305,-1939.7 7305,-1939.7 7305,-1895.7 7305,-1895.7 7305,-1889.7 7311,-1883.7 7317,-1883.7 7317,-1883.7 7455,-1883.7 7455,-1883.7 7461,-1883.7 7467,-1889.7 7467,-1895.7 7467,-1895.7 7467,-1939.7 7467,-1939.7 7467,-1945.7 7461,-1951.7 7455,-1951.7"/>
<text text-anchor="middle" x="7386" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 11</text>
<text text-anchor="middle" x="7386" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7386" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7386" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn_l3_g11&#45;&gt;ffn_concat_l3 -->
<g id="edge215" class="edge">
<title>ffn_l3_g11&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M7386,-1883.65C7386,-1841.15 7386,-1774 7386,-1774 7386,-1774 6860.92,-1774 6860.92,-1774"/>
<polygon fill="black" stroke="black" points="6860.92,-1770.5 6850.92,-1774 6860.92,-1777.5 6860.92,-1770.5"/>
</g>
<!-- ffn_l3_g12 -->
<g id="node119" class="node">
<title>ffn_l3_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M7675,-1951.7C7675,-1951.7 7537,-1951.7 7537,-1951.7 7531,-1951.7 7525,-1945.7 7525,-1939.7 7525,-1939.7 7525,-1895.7 7525,-1895.7 7525,-1889.7 7531,-1883.7 7537,-1883.7 7537,-1883.7 7675,-1883.7 7675,-1883.7 7681,-1883.7 7687,-1889.7 7687,-1895.7 7687,-1895.7 7687,-1939.7 7687,-1939.7 7687,-1945.7 7681,-1951.7 7675,-1951.7"/>
<text text-anchor="middle" x="7606" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 12</text>
<text text-anchor="middle" x="7606" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7606" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7606" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn_l3_g12&#45;&gt;ffn_concat_l3 -->
<g id="edge216" class="edge">
<title>ffn_l3_g12&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M7560.75,-1883.59C7560.75,-1838.31 7560.75,-1764 7560.75,-1764 7560.75,-1764 6916.1,-1764 6916.1,-1764"/>
<polygon fill="black" stroke="black" points="6916.1,-1760.5 6906.1,-1764 6916.1,-1767.5 6916.1,-1760.5"/>
</g>
<!-- ffn_l3_g13 -->
<g id="node120" class="node">
<title>ffn_l3_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M7895,-1951.7C7895,-1951.7 7757,-1951.7 7757,-1951.7 7751,-1951.7 7745,-1945.7 7745,-1939.7 7745,-1939.7 7745,-1895.7 7745,-1895.7 7745,-1889.7 7751,-1883.7 7757,-1883.7 7757,-1883.7 7895,-1883.7 7895,-1883.7 7901,-1883.7 7907,-1889.7 7907,-1895.7 7907,-1895.7 7907,-1939.7 7907,-1939.7 7907,-1945.7 7901,-1951.7 7895,-1951.7"/>
<text text-anchor="middle" x="7826" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 13</text>
<text text-anchor="middle" x="7826" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7826" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7826" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn_l3_g13&#45;&gt;ffn_concat_l3 -->
<g id="edge217" class="edge">
<title>ffn_l3_g13&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M7764.5,-1883.57C7764.5,-1835.33 7764.5,-1753 7764.5,-1753 7764.5,-1753 6913.93,-1753 6913.93,-1753"/>
<polygon fill="black" stroke="black" points="6913.93,-1749.5 6903.93,-1753 6913.93,-1756.5 6913.93,-1749.5"/>
</g>
<!-- ffn_l3_g14 -->
<g id="node121" class="node">
<title>ffn_l3_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M8115,-1951.7C8115,-1951.7 7977,-1951.7 7977,-1951.7 7971,-1951.7 7965,-1945.7 7965,-1939.7 7965,-1939.7 7965,-1895.7 7965,-1895.7 7965,-1889.7 7971,-1883.7 7977,-1883.7 7977,-1883.7 8115,-1883.7 8115,-1883.7 8121,-1883.7 8127,-1889.7 8127,-1895.7 8127,-1895.7 8127,-1939.7 8127,-1939.7 8127,-1945.7 8121,-1951.7 8115,-1951.7"/>
<text text-anchor="middle" x="8046" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 14</text>
<text text-anchor="middle" x="8046" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8046" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8046" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn_l3_g14&#45;&gt;ffn_concat_l3 -->
<g id="edge218" class="edge">
<title>ffn_l3_g14&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M8006.01,-1883.41C8006.01,-1832.27 8006.01,-1742 8006.01,-1742 8006.01,-1742 6853.27,-1742 6853.27,-1742"/>
<polygon fill="black" stroke="black" points="6853.27,-1738.5 6843.27,-1742 6853.27,-1745.5 6853.27,-1738.5"/>
</g>
<!-- ffn_l3_g15 -->
<g id="node122" class="node">
<title>ffn_l3_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M8335,-1951.7C8335,-1951.7 8197,-1951.7 8197,-1951.7 8191,-1951.7 8185,-1945.7 8185,-1939.7 8185,-1939.7 8185,-1895.7 8185,-1895.7 8185,-1889.7 8191,-1883.7 8197,-1883.7 8197,-1883.7 8335,-1883.7 8335,-1883.7 8341,-1883.7 8347,-1889.7 8347,-1895.7 8347,-1895.7 8347,-1939.7 8347,-1939.7 8347,-1945.7 8341,-1951.7 8335,-1951.7"/>
<text text-anchor="middle" x="8266" y="-1936.5" font-family="Times,serif" font-size="14.00">FFN Partition 15</text>
<text text-anchor="middle" x="8266" y="-1921.5" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8266" y="-1906.5" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8266" y="-1891.5" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn_l3_g15&#45;&gt;ffn_concat_l3 -->
<g id="edge219" class="edge">
<title>ffn_l3_g15&#45;&gt;ffn_concat_l3</title>
<path fill="none" stroke="black" d="M8239,-1883.46C8239,-1829.56 8239,-1731 8239,-1731 8239,-1731 6793.01,-1731 6793.01,-1731"/>
<polygon fill="black" stroke="black" points="6793.01,-1727.5 6783.01,-1731 6793.01,-1734.5 6793.01,-1727.5"/>
</g>
<!-- ln2_l3 -->
<g id="node125" class="node">
<title>ln2_l3</title>
<ellipse fill="#e6e6fa" stroke="black" cx="7965" cy="-1606.83" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="7965" y="-1610.63" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="7965" y="-1595.63" font-family="Times,serif" font-size="14.00">L3</text>
</g>
<!-- ffn_concat_l3&#45;&gt;ln2_l3 -->
<g id="edge220" class="edge">
<title>ffn_concat_l3&#45;&gt;ln2_l3</title>
<path fill="none" stroke="black" d="M6928.5,-1757.38C6928.5,-1742.46 6928.5,-1606 6928.5,-1606 6928.5,-1606 7872.8,-1606 7872.8,-1606"/>
<polygon fill="black" stroke="black" points="7872.8,-1609.5 7882.8,-1606 7872.8,-1602.5 7872.8,-1609.5"/>
</g>
<!-- residual_l3 -->
<g id="node126" class="node">
<title>residual_l3</title>
<ellipse fill="#f5f5dc" stroke="black" cx="6726" cy="-2065.57" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="6726" y="-2069.37" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="6726" y="-2054.37" font-family="Times,serif" font-size="14.00">L3</text>
</g>
<!-- ln1_l3&#45;&gt;residual_l3 -->
<g id="edge187" class="edge">
<title>ln1_l3&#45;&gt;residual_l3</title>
<path fill="none" stroke="black" d="M6726,-2179.17C6726,-2179.17 6726,-2102.62 6726,-2102.62"/>
<polygon fill="black" stroke="black" points="6729.5,-2102.62 6726,-2092.62 6722.5,-2102.62 6729.5,-2102.62"/>
</g>
<!-- layer3_output -->
<g id="node127" class="node">
<title>layer3_output</title>
<path fill="#2e86ab" stroke="#2e86ab" stroke-width="2" d="M8057.5,-1492.96C8057.5,-1492.96 7872.5,-1492.96 7872.5,-1492.96 7866.5,-1492.96 7860.5,-1486.96 7860.5,-1480.96 7860.5,-1480.96 7860.5,-1466.96 7860.5,-1466.96 7860.5,-1460.96 7866.5,-1454.96 7872.5,-1454.96 7872.5,-1454.96 8057.5,-1454.96 8057.5,-1454.96 8063.5,-1454.96 8069.5,-1460.96 8069.5,-1466.96 8069.5,-1466.96 8069.5,-1480.96 8069.5,-1480.96 8069.5,-1486.96 8063.5,-1492.96 8057.5,-1492.96"/>
<text text-anchor="middle" x="7965" y="-1477.76" font-family="Times,serif" font-size="14.00">Layer 3 Output</text>
<text text-anchor="middle" x="7965" y="-1462.76" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ln2_l3&#45;&gt;layer3_output -->
<g id="edge222" class="edge">
<title>ln2_l3&#45;&gt;layer3_output</title>
<path fill="none" stroke="black" d="M7965,-1579.94C7965,-1579.94 7965,-1503.08 7965,-1503.08"/>
<polygon fill="black" stroke="black" points="7968.5,-1503.08 7965,-1493.08 7961.5,-1503.08 7968.5,-1503.08"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g0 -->
<g id="edge188" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g0</title>
<path fill="none" stroke="black" d="M6689.94,-2086C6440.4,-2086 4980.25,-2086 4980.25,-2086 4980.25,-2086 4980.25,-1961.76 4980.25,-1961.76"/>
<polygon fill="black" stroke="black" points="4983.75,-1961.76 4980.25,-1951.76 4976.75,-1961.76 4983.75,-1961.76"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g1 -->
<g id="edge189" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g1</title>
<path fill="none" stroke="black" d="M6679.44,-2080C6428.85,-2080 5251.75,-2080 5251.75,-2080 5251.75,-2080 5251.75,-1961.72 5251.75,-1961.72"/>
<polygon fill="black" stroke="black" points="5255.25,-1961.72 5251.75,-1951.72 5248.25,-1961.72 5255.25,-1961.72"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g2 -->
<g id="edge190" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g2</title>
<path fill="none" stroke="black" d="M6673.58,-2074C6433.38,-2074 5449.5,-2074 5449.5,-2074 5449.5,-2074 5449.5,-1962 5449.5,-1962"/>
<polygon fill="black" stroke="black" points="5453,-1962 5449.5,-1952 5446,-1962 5453,-1962"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g3 -->
<g id="edge191" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g3</title>
<path fill="none" stroke="black" d="M6670.7,-2068C6447.64,-2068 5626,-2068 5626,-2068 5626,-2068 5626,-1961.81 5626,-1961.81"/>
<polygon fill="black" stroke="black" points="5629.5,-1961.81 5626,-1951.81 5622.5,-1961.81 5629.5,-1961.81"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g4 -->
<g id="edge192" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g4</title>
<path fill="none" stroke="black" d="M6671.27,-2062C6489.97,-2062 5920.5,-2062 5920.5,-2062 5920.5,-2062 5920.5,-1961.9 5920.5,-1961.9"/>
<polygon fill="black" stroke="black" points="5924,-1961.9 5920.5,-1951.9 5917,-1961.9 5924,-1961.9"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g5 -->
<g id="edge193" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g5</title>
<path fill="none" stroke="black" d="M6674.42,-2056C6527.62,-2056 6118,-2056 6118,-2056 6118,-2056 6118,-1961.89 6118,-1961.89"/>
<polygon fill="black" stroke="black" points="6121.5,-1961.89 6118,-1951.89 6114.5,-1961.89 6121.5,-1961.89"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g6 -->
<g id="edge194" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g6</title>
<path fill="none" stroke="black" d="M6680.78,-2050C6583.52,-2050 6363.17,-2050 6363.17,-2050 6363.17,-2050 6363.17,-1961.77 6363.17,-1961.77"/>
<polygon fill="black" stroke="black" points="6366.67,-1961.77 6363.17,-1951.77 6359.67,-1961.77 6366.67,-1961.77"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g7 -->
<g id="edge195" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g7</title>
<path fill="none" stroke="black" d="M6693.06,-2044C6631.69,-2044 6506,-2044 6506,-2044 6506,-2044 6506,-1961.88 6506,-1961.88"/>
<polygon fill="black" stroke="black" points="6509.5,-1961.88 6506,-1951.88 6502.5,-1961.88 6509.5,-1961.88"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g8 -->
<g id="edge196" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g8</title>
<path fill="none" stroke="black" d="M6726,-2038.45C6726,-2038.45 6726,-1961.94 6726,-1961.94"/>
<polygon fill="black" stroke="black" points="6729.5,-1961.94 6726,-1951.94 6722.5,-1961.94 6729.5,-1961.94"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g9 -->
<g id="edge197" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g9</title>
<path fill="none" stroke="black" d="M6759.1,-2044C6802.59,-2044 6873.5,-2044 6873.5,-2044 6873.5,-2044 6873.5,-1961.88 6873.5,-1961.88"/>
<polygon fill="black" stroke="black" points="6877,-1961.88 6873.5,-1951.88 6870,-1961.88 6877,-1961.88"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g10 -->
<g id="edge198" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g10</title>
<path fill="none" stroke="black" d="M6771.2,-2050C6870.88,-2050 7100.75,-2050 7100.75,-2050 7100.75,-2050 7100.75,-1961.77 7100.75,-1961.77"/>
<polygon fill="black" stroke="black" points="7104.25,-1961.77 7100.75,-1951.77 7097.25,-1961.77 7104.25,-1961.77"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g11 -->
<g id="edge199" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g11</title>
<path fill="none" stroke="black" d="M6777.69,-2056C6921.23,-2056 7314.25,-2056 7314.25,-2056 7314.25,-2056 7314.25,-1961.89 7314.25,-1961.89"/>
<polygon fill="black" stroke="black" points="7317.75,-1961.89 7314.25,-1951.89 7310.75,-1961.89 7317.75,-1961.89"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g12 -->
<g id="edge200" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g12</title>
<path fill="none" stroke="black" d="M6780.74,-2062C6963.47,-2062 7541,-2062 7541,-2062 7541,-2062 7541,-1961.9 7541,-1961.9"/>
<polygon fill="black" stroke="black" points="7544.5,-1961.9 7541,-1951.9 7537.5,-1961.9 7544.5,-1961.9"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g13 -->
<g id="edge201" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g13</title>
<path fill="none" stroke="black" d="M6781.3,-2068C7004.36,-2068 7826,-2068 7826,-2068 7826,-2068 7826,-1961.81 7826,-1961.81"/>
<polygon fill="black" stroke="black" points="7829.5,-1961.81 7826,-1951.81 7822.5,-1961.81 7829.5,-1961.81"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g14 -->
<g id="edge202" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g14</title>
<path fill="none" stroke="black" d="M6772.53,-2080C7003.08,-2080 8012,-2080 8012,-2080 8012,-2080 8012,-1961.72 8012,-1961.72"/>
<polygon fill="black" stroke="black" points="8015.5,-1961.72 8012,-1951.72 8008.5,-1961.72 8015.5,-1961.72"/>
</g>
<!-- residual_l3&#45;&gt;ffn_l3_g15 -->
<g id="edge203" class="edge">
<title>residual_l3&#45;&gt;ffn_l3_g15</title>
<path fill="none" stroke="black" d="M6761.94,-2086C6988.53,-2086 8209.75,-2086 8209.75,-2086 8209.75,-2086 8209.75,-1961.76 8209.75,-1961.76"/>
<polygon fill="black" stroke="black" points="8213.25,-1961.76 8209.75,-1951.76 8206.25,-1961.76 8213.25,-1961.76"/>
</g>
<!-- residual_l3&#45;&gt;ln2_l3 -->
<g id="edge221" class="edge">
<title>residual_l3&#45;&gt;ln2_l3</title>
<path fill="none" stroke="black" d="M6778.38,-2074C7010.63,-2074 7936,-2074 7936,-2074 7936,-2074 7936,-1642.28 7936,-1642.28"/>
<polygon fill="black" stroke="black" points="7939.5,-1642.28 7936,-1632.28 7932.5,-1642.28 7939.5,-1642.28"/>
</g>
<!-- mha_l4_g0 -->
<g id="node128" class="node">
<title>mha_l4_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M5588.5,-1334.96C5588.5,-1334.96 5405.5,-1334.96 5405.5,-1334.96 5399.5,-1334.96 5393.5,-1328.96 5393.5,-1322.96 5393.5,-1322.96 5393.5,-1278.96 5393.5,-1278.96 5393.5,-1272.96 5399.5,-1266.96 5405.5,-1266.96 5405.5,-1266.96 5588.5,-1266.96 5588.5,-1266.96 5594.5,-1266.96 5600.5,-1272.96 5600.5,-1278.96 5600.5,-1278.96 5600.5,-1322.96 5600.5,-1322.96 5600.5,-1328.96 5594.5,-1334.96 5588.5,-1334.96"/>
<text text-anchor="middle" x="5497" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 0</text>
<text text-anchor="middle" x="5497" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="5497" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5497" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g0 -->
<g id="edge223" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g0</title>
<path fill="none" stroke="black" d="M7860.45,-1488C7397.98,-1488 5558.88,-1488 5558.88,-1488 5558.88,-1488 5558.88,-1345.27 5558.88,-1345.27"/>
<polygon fill="black" stroke="black" points="5562.38,-1345.27 5558.88,-1335.27 5555.38,-1345.27 5562.38,-1345.27"/>
</g>
<!-- mha_l4_g1 -->
<g id="node129" class="node">
<title>mha_l4_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M5911.5,-1334.96C5911.5,-1334.96 5728.5,-1334.96 5728.5,-1334.96 5722.5,-1334.96 5716.5,-1328.96 5716.5,-1322.96 5716.5,-1322.96 5716.5,-1278.96 5716.5,-1278.96 5716.5,-1272.96 5722.5,-1266.96 5728.5,-1266.96 5728.5,-1266.96 5911.5,-1266.96 5911.5,-1266.96 5917.5,-1266.96 5923.5,-1272.96 5923.5,-1278.96 5923.5,-1278.96 5923.5,-1322.96 5923.5,-1322.96 5923.5,-1328.96 5917.5,-1334.96 5911.5,-1334.96"/>
<text text-anchor="middle" x="5820" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 1</text>
<text text-anchor="middle" x="5820" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="5820" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="5820" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g1 -->
<g id="edge224" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g1</title>
<path fill="none" stroke="black" d="M7860.35,-1484C7429.81,-1484 5817.83,-1484 5817.83,-1484 5817.83,-1484 5817.83,-1345.39 5817.83,-1345.39"/>
<polygon fill="black" stroke="black" points="5821.33,-1345.39 5817.83,-1335.39 5814.33,-1345.39 5821.33,-1345.39"/>
</g>
<!-- mha_l4_g2 -->
<g id="node130" class="node">
<title>mha_l4_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M6234.5,-1334.96C6234.5,-1334.96 6051.5,-1334.96 6051.5,-1334.96 6045.5,-1334.96 6039.5,-1328.96 6039.5,-1322.96 6039.5,-1322.96 6039.5,-1278.96 6039.5,-1278.96 6039.5,-1272.96 6045.5,-1266.96 6051.5,-1266.96 6051.5,-1266.96 6234.5,-1266.96 6234.5,-1266.96 6240.5,-1266.96 6246.5,-1272.96 6246.5,-1278.96 6246.5,-1278.96 6246.5,-1322.96 6246.5,-1322.96 6246.5,-1328.96 6240.5,-1334.96 6234.5,-1334.96"/>
<text text-anchor="middle" x="6143" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 2</text>
<text text-anchor="middle" x="6143" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="6143" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6143" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g2 -->
<g id="edge225" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g2</title>
<path fill="none" stroke="black" d="M7860.44,-1480C7484.81,-1480 6225.75,-1480 6225.75,-1480 6225.75,-1480 6225.75,-1345.06 6225.75,-1345.06"/>
<polygon fill="black" stroke="black" points="6229.25,-1345.06 6225.75,-1335.06 6222.25,-1345.06 6229.25,-1345.06"/>
</g>
<!-- mha_l4_g3 -->
<g id="node131" class="node">
<title>mha_l4_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M6557.5,-1334.96C6557.5,-1334.96 6374.5,-1334.96 6374.5,-1334.96 6368.5,-1334.96 6362.5,-1328.96 6362.5,-1322.96 6362.5,-1322.96 6362.5,-1278.96 6362.5,-1278.96 6362.5,-1272.96 6368.5,-1266.96 6374.5,-1266.96 6374.5,-1266.96 6557.5,-1266.96 6557.5,-1266.96 6563.5,-1266.96 6569.5,-1272.96 6569.5,-1278.96 6569.5,-1278.96 6569.5,-1322.96 6569.5,-1322.96 6569.5,-1328.96 6563.5,-1334.96 6557.5,-1334.96"/>
<text text-anchor="middle" x="6466" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 3</text>
<text text-anchor="middle" x="6466" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="6466" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6466" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g3 -->
<g id="edge226" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g3</title>
<path fill="none" stroke="black" d="M7860.46,-1476C7532.12,-1476 6543.25,-1476 6543.25,-1476 6543.25,-1476 6543.25,-1345.13 6543.25,-1345.13"/>
<polygon fill="black" stroke="black" points="6546.75,-1345.13 6543.25,-1335.13 6539.75,-1345.13 6546.75,-1345.13"/>
</g>
<!-- mha_l4_g4 -->
<g id="node132" class="node">
<title>mha_l4_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M6822.5,-1334.96C6822.5,-1334.96 6639.5,-1334.96 6639.5,-1334.96 6633.5,-1334.96 6627.5,-1328.96 6627.5,-1322.96 6627.5,-1322.96 6627.5,-1278.96 6627.5,-1278.96 6627.5,-1272.96 6633.5,-1266.96 6639.5,-1266.96 6639.5,-1266.96 6822.5,-1266.96 6822.5,-1266.96 6828.5,-1266.96 6834.5,-1272.96 6834.5,-1278.96 6834.5,-1278.96 6834.5,-1322.96 6834.5,-1322.96 6834.5,-1328.96 6828.5,-1334.96 6822.5,-1334.96"/>
<text text-anchor="middle" x="6731" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 4</text>
<text text-anchor="middle" x="6731" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="6731" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="6731" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g4 -->
<g id="edge227" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g4</title>
<path fill="none" stroke="black" d="M7860.38,-1471C7556.71,-1471 6696.5,-1471 6696.5,-1471 6696.5,-1471 6696.5,-1344.96 6696.5,-1344.96"/>
<polygon fill="black" stroke="black" points="6700,-1344.96 6696.5,-1334.96 6693,-1344.96 6700,-1344.96"/>
</g>
<!-- mha_l4_g5 -->
<g id="node133" class="node">
<title>mha_l4_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M7145.5,-1334.96C7145.5,-1334.96 6962.5,-1334.96 6962.5,-1334.96 6956.5,-1334.96 6950.5,-1328.96 6950.5,-1322.96 6950.5,-1322.96 6950.5,-1278.96 6950.5,-1278.96 6950.5,-1272.96 6956.5,-1266.96 6962.5,-1266.96 6962.5,-1266.96 7145.5,-1266.96 7145.5,-1266.96 7151.5,-1266.96 7157.5,-1272.96 7157.5,-1278.96 7157.5,-1278.96 7157.5,-1322.96 7157.5,-1322.96 7157.5,-1328.96 7151.5,-1334.96 7145.5,-1334.96"/>
<text text-anchor="middle" x="7054" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 5</text>
<text text-anchor="middle" x="7054" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="7054" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7054" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g5 -->
<g id="edge228" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g5</title>
<path fill="none" stroke="black" d="M7860.49,-1467C7632.18,-1467 7109.17,-1467 7109.17,-1467 7109.17,-1467 7109.17,-1344.96 7109.17,-1344.96"/>
<polygon fill="black" stroke="black" points="7112.67,-1344.96 7109.17,-1334.96 7105.67,-1344.96 7112.67,-1344.96"/>
</g>
<!-- mha_l4_g6 -->
<g id="node134" class="node">
<title>mha_l4_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M7468.5,-1334.96C7468.5,-1334.96 7285.5,-1334.96 7285.5,-1334.96 7279.5,-1334.96 7273.5,-1328.96 7273.5,-1322.96 7273.5,-1322.96 7273.5,-1278.96 7273.5,-1278.96 7273.5,-1272.96 7279.5,-1266.96 7285.5,-1266.96 7285.5,-1266.96 7468.5,-1266.96 7468.5,-1266.96 7474.5,-1266.96 7480.5,-1272.96 7480.5,-1278.96 7480.5,-1278.96 7480.5,-1322.96 7480.5,-1322.96 7480.5,-1328.96 7474.5,-1334.96 7468.5,-1334.96"/>
<text text-anchor="middle" x="7377" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 6</text>
<text text-anchor="middle" x="7377" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="7377" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7377" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g6 -->
<g id="edge229" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g6</title>
<path fill="none" stroke="black" d="M7860.22,-1463C7715.94,-1463 7473.75,-1463 7473.75,-1463 7473.75,-1463 7473.75,-1345.32 7473.75,-1345.32"/>
<polygon fill="black" stroke="black" points="7477.25,-1345.32 7473.75,-1335.32 7470.25,-1345.32 7477.25,-1345.32"/>
</g>
<!-- mha_l4_g7 -->
<g id="node135" class="node">
<title>mha_l4_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M7791.5,-1334.96C7791.5,-1334.96 7608.5,-1334.96 7608.5,-1334.96 7602.5,-1334.96 7596.5,-1328.96 7596.5,-1322.96 7596.5,-1322.96 7596.5,-1278.96 7596.5,-1278.96 7596.5,-1272.96 7602.5,-1266.96 7608.5,-1266.96 7608.5,-1266.96 7791.5,-1266.96 7791.5,-1266.96 7797.5,-1266.96 7803.5,-1272.96 7803.5,-1278.96 7803.5,-1278.96 7803.5,-1322.96 7803.5,-1322.96 7803.5,-1328.96 7797.5,-1334.96 7791.5,-1334.96"/>
<text text-anchor="middle" x="7700" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 7</text>
<text text-anchor="middle" x="7700" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="7700" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7700" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g7 -->
<g id="edge230" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g7</title>
<path fill="none" stroke="black" d="M7860.5,-1459C7820.37,-1459 7784,-1459 7784,-1459 7784,-1459 7784,-1345.25 7784,-1345.25"/>
<polygon fill="black" stroke="black" points="7787.5,-1345.25 7784,-1335.25 7780.5,-1345.25 7787.5,-1345.25"/>
</g>
<!-- mha_l4_g8 -->
<g id="node136" class="node">
<title>mha_l4_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M8056.5,-1334.96C8056.5,-1334.96 7873.5,-1334.96 7873.5,-1334.96 7867.5,-1334.96 7861.5,-1328.96 7861.5,-1322.96 7861.5,-1322.96 7861.5,-1278.96 7861.5,-1278.96 7861.5,-1272.96 7867.5,-1266.96 7873.5,-1266.96 7873.5,-1266.96 8056.5,-1266.96 8056.5,-1266.96 8062.5,-1266.96 8068.5,-1272.96 8068.5,-1278.96 8068.5,-1278.96 8068.5,-1322.96 8068.5,-1322.96 8068.5,-1328.96 8062.5,-1334.96 8056.5,-1334.96"/>
<text text-anchor="middle" x="7965" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 8</text>
<text text-anchor="middle" x="7965" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="7965" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="7965" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g8 -->
<g id="edge231" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g8</title>
<path fill="none" stroke="black" d="M7965,-1454.79C7965,-1454.79 7965,-1345.1 7965,-1345.1"/>
<polygon fill="black" stroke="black" points="7968.5,-1345.1 7965,-1335.1 7961.5,-1345.1 7968.5,-1345.1"/>
</g>
<!-- mha_l4_g9 -->
<g id="node137" class="node">
<title>mha_l4_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M8379.5,-1334.96C8379.5,-1334.96 8196.5,-1334.96 8196.5,-1334.96 8190.5,-1334.96 8184.5,-1328.96 8184.5,-1322.96 8184.5,-1322.96 8184.5,-1278.96 8184.5,-1278.96 8184.5,-1272.96 8190.5,-1266.96 8196.5,-1266.96 8196.5,-1266.96 8379.5,-1266.96 8379.5,-1266.96 8385.5,-1266.96 8391.5,-1272.96 8391.5,-1278.96 8391.5,-1278.96 8391.5,-1322.96 8391.5,-1322.96 8391.5,-1328.96 8385.5,-1334.96 8379.5,-1334.96"/>
<text text-anchor="middle" x="8288" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 9</text>
<text text-anchor="middle" x="8288" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="8288" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="8288" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g9 -->
<g id="edge232" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g9</title>
<path fill="none" stroke="black" d="M8069.68,-1459C8165.67,-1459 8293,-1459 8293,-1459 8293,-1459 8293,-1345.25 8293,-1345.25"/>
<polygon fill="black" stroke="black" points="8296.5,-1345.25 8293,-1335.25 8289.5,-1345.25 8296.5,-1345.25"/>
</g>
<!-- mha_l4_g10 -->
<g id="node138" class="node">
<title>mha_l4_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M8702.5,-1334.96C8702.5,-1334.96 8519.5,-1334.96 8519.5,-1334.96 8513.5,-1334.96 8507.5,-1328.96 8507.5,-1322.96 8507.5,-1322.96 8507.5,-1278.96 8507.5,-1278.96 8507.5,-1272.96 8513.5,-1266.96 8519.5,-1266.96 8519.5,-1266.96 8702.5,-1266.96 8702.5,-1266.96 8708.5,-1266.96 8714.5,-1272.96 8714.5,-1278.96 8714.5,-1278.96 8714.5,-1322.96 8714.5,-1322.96 8714.5,-1328.96 8708.5,-1334.96 8702.5,-1334.96"/>
<text text-anchor="middle" x="8611" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 10</text>
<text text-anchor="middle" x="8611" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="8611" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="8611" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g10 -->
<g id="edge233" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g10</title>
<path fill="none" stroke="black" d="M8069.75,-1463C8233.73,-1463 8532.5,-1463 8532.5,-1463 8532.5,-1463 8532.5,-1345.32 8532.5,-1345.32"/>
<polygon fill="black" stroke="black" points="8536,-1345.32 8532.5,-1335.32 8529,-1345.32 8536,-1345.32"/>
</g>
<!-- mha_l4_g11 -->
<g id="node139" class="node">
<title>mha_l4_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M9025.5,-1334.96C9025.5,-1334.96 8842.5,-1334.96 8842.5,-1334.96 8836.5,-1334.96 8830.5,-1328.96 8830.5,-1322.96 8830.5,-1322.96 8830.5,-1278.96 8830.5,-1278.96 8830.5,-1272.96 8836.5,-1266.96 8842.5,-1266.96 8842.5,-1266.96 9025.5,-1266.96 9025.5,-1266.96 9031.5,-1266.96 9037.5,-1272.96 9037.5,-1278.96 9037.5,-1278.96 9037.5,-1322.96 9037.5,-1322.96 9037.5,-1328.96 9031.5,-1334.96 9025.5,-1334.96"/>
<text text-anchor="middle" x="8934" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 11</text>
<text text-anchor="middle" x="8934" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="8934" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="8934" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g11 -->
<g id="edge234" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g11</title>
<path fill="none" stroke="black" d="M8069.62,-1471C8320.18,-1471 8934,-1471 8934,-1471 8934,-1471 8934,-1344.96 8934,-1344.96"/>
<polygon fill="black" stroke="black" points="8937.5,-1344.96 8934,-1334.96 8930.5,-1344.96 8937.5,-1344.96"/>
</g>
<!-- mha_l4_g12 -->
<g id="node140" class="node">
<title>mha_l4_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M9290.5,-1334.96C9290.5,-1334.96 9107.5,-1334.96 9107.5,-1334.96 9101.5,-1334.96 9095.5,-1328.96 9095.5,-1322.96 9095.5,-1322.96 9095.5,-1278.96 9095.5,-1278.96 9095.5,-1272.96 9101.5,-1266.96 9107.5,-1266.96 9107.5,-1266.96 9290.5,-1266.96 9290.5,-1266.96 9296.5,-1266.96 9302.5,-1272.96 9302.5,-1278.96 9302.5,-1278.96 9302.5,-1322.96 9302.5,-1322.96 9302.5,-1328.96 9296.5,-1334.96 9290.5,-1334.96"/>
<text text-anchor="middle" x="9199" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 12</text>
<text text-anchor="middle" x="9199" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="9199" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="9199" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g12 -->
<g id="edge235" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g12</title>
<path fill="none" stroke="black" d="M8069.68,-1476C8367.64,-1476 9199,-1476 9199,-1476 9199,-1476 9199,-1345.13 9199,-1345.13"/>
<polygon fill="black" stroke="black" points="9202.5,-1345.13 9199,-1335.13 9195.5,-1345.13 9202.5,-1345.13"/>
</g>
<!-- mha_l4_g13 -->
<g id="node141" class="node">
<title>mha_l4_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M9613.5,-1334.96C9613.5,-1334.96 9430.5,-1334.96 9430.5,-1334.96 9424.5,-1334.96 9418.5,-1328.96 9418.5,-1322.96 9418.5,-1322.96 9418.5,-1278.96 9418.5,-1278.96 9418.5,-1272.96 9424.5,-1266.96 9430.5,-1266.96 9430.5,-1266.96 9613.5,-1266.96 9613.5,-1266.96 9619.5,-1266.96 9625.5,-1272.96 9625.5,-1278.96 9625.5,-1278.96 9625.5,-1322.96 9625.5,-1322.96 9625.5,-1328.96 9619.5,-1334.96 9613.5,-1334.96"/>
<text text-anchor="middle" x="9522" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 13</text>
<text text-anchor="middle" x="9522" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="9522" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="9522" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g13 -->
<g id="edge236" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g13</title>
<path fill="none" stroke="black" d="M8069.58,-1480C8418.68,-1480 9522,-1480 9522,-1480 9522,-1480 9522,-1345.06 9522,-1345.06"/>
<polygon fill="black" stroke="black" points="9525.5,-1345.06 9522,-1335.06 9518.5,-1345.06 9525.5,-1345.06"/>
</g>
<!-- mha_l4_g14 -->
<g id="node142" class="node">
<title>mha_l4_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M9936.5,-1334.96C9936.5,-1334.96 9753.5,-1334.96 9753.5,-1334.96 9747.5,-1334.96 9741.5,-1328.96 9741.5,-1322.96 9741.5,-1322.96 9741.5,-1278.96 9741.5,-1278.96 9741.5,-1272.96 9747.5,-1266.96 9753.5,-1266.96 9753.5,-1266.96 9936.5,-1266.96 9936.5,-1266.96 9942.5,-1266.96 9948.5,-1272.96 9948.5,-1278.96 9948.5,-1278.96 9948.5,-1322.96 9948.5,-1322.96 9948.5,-1328.96 9942.5,-1334.96 9936.5,-1334.96"/>
<text text-anchor="middle" x="9845" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 14</text>
<text text-anchor="middle" x="9845" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="9845" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="9845" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g14 -->
<g id="edge237" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g14</title>
<path fill="none" stroke="black" d="M8069.77,-1484C8465.24,-1484 9845,-1484 9845,-1484 9845,-1484 9845,-1345.39 9845,-1345.39"/>
<polygon fill="black" stroke="black" points="9848.5,-1345.39 9845,-1335.39 9841.5,-1345.39 9848.5,-1345.39"/>
</g>
<!-- mha_l4_g15 -->
<g id="node143" class="node">
<title>mha_l4_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M10259.5,-1334.96C10259.5,-1334.96 10076.5,-1334.96 10076.5,-1334.96 10070.5,-1334.96 10064.5,-1328.96 10064.5,-1322.96 10064.5,-1322.96 10064.5,-1278.96 10064.5,-1278.96 10064.5,-1272.96 10070.5,-1266.96 10076.5,-1266.96 10076.5,-1266.96 10259.5,-1266.96 10259.5,-1266.96 10265.5,-1266.96 10271.5,-1272.96 10271.5,-1278.96 10271.5,-1278.96 10271.5,-1322.96 10271.5,-1322.96 10271.5,-1328.96 10265.5,-1334.96 10259.5,-1334.96"/>
<text text-anchor="middle" x="10168" y="-1319.76" font-family="Times,serif" font-size="14.00">MHA Partition 15</text>
<text text-anchor="middle" x="10168" y="-1304.76" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="10168" y="-1289.76" font-family="Times,serif" font-size="14.00">Q/K/V: 1024×2048×512</text>
<text text-anchor="middle" x="10168" y="-1274.76" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_output&#45;&gt;mha_l4_g15 -->
<g id="edge238" class="edge">
<title>layer3_output&#45;&gt;mha_l4_g15</title>
<path fill="none" stroke="black" d="M8069.77,-1488C8507.58,-1488 10168,-1488 10168,-1488 10168,-1488 10168,-1345.27 10168,-1345.27"/>
<polygon fill="black" stroke="black" points="10171.5,-1345.27 10168,-1335.27 10164.5,-1345.27 10171.5,-1345.27"/>
</g>
<!-- ln1_l4 -->
<g id="node166" class="node">
<title>ln1_l4</title>
<ellipse fill="#e6e6fa" stroke="black" cx="8543" cy="-767.09" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="8543" y="-770.89" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="8543" y="-755.89" font-family="Times,serif" font-size="14.00">L4</text>
</g>
<!-- layer3_output&#45;&gt;ln1_l4 -->
<g id="edge260" class="edge">
<title>layer3_output&#45;&gt;ln1_l4</title>
<path fill="none" stroke="black" d="M8069.66,-1467C8086.35,-1467 8098.25,-1467 8098.25,-1467 8098.25,-1467 8098.25,-767 8098.25,-767 8098.25,-767 8450.91,-767 8450.91,-767"/>
<polygon fill="black" stroke="black" points="8450.91,-770.5 8460.91,-767 8450.91,-763.5 8450.91,-770.5"/>
</g>
<!-- mha_l4_g0&#45;&gt;mha_l4_g1 -->
<g id="edge369" class="edge">
<title>mha_l4_g0&#45;&gt;mha_l4_g1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5600.53,-1300C5600.53,-1300 5706.22,-1300 5706.22,-1300"/>
<polygon fill="red" stroke="red" points="5706.22,-1303.5 5716.22,-1300 5706.22,-1296.5 5706.22,-1303.5"/>
</g>
<!-- mha_l4_g0&#45;&gt;mha_l4_g2 -->
<g id="edge370" class="edge">
<title>mha_l4_g0&#45;&gt;mha_l4_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5586.62,-1335.06C5586.62,-1349.92 5586.62,-1364 5586.62,-1364 5586.62,-1364 6111.17,-1364 6111.17,-1364 6111.17,-1364 6111.17,-1345.06 6111.17,-1345.06"/>
<polygon fill="red" stroke="red" points="6114.67,-1345.06 6111.17,-1335.06 6107.67,-1345.06 6114.67,-1345.06"/>
<text text-anchor="middle" x="5960" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g0&#45;&gt;mha_l4_g3 -->
<g id="edge371" class="edge">
<title>mha_l4_g0&#45;&gt;mha_l4_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5572.75,-1335.23C5572.75,-1371.64 5572.75,-1424 5572.75,-1424 5572.75,-1424 6373.5,-1424 6373.5,-1424 6373.5,-1424 6373.5,-1345.23 6373.5,-1345.23"/>
<polygon fill="red" stroke="red" points="6377,-1345.23 6373.5,-1335.23 6370,-1345.23 6377,-1345.23"/>
<text text-anchor="middle" x="6065" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l4_hg0 -->
<g id="node144" class="node">
<title>concat_l4_hg0</title>
<path fill="#ffb347" stroke="black" d="M6131.26,-1177.48C6131.26,-1177.48 5903.74,-1129.44 5903.74,-1129.44 5897.87,-1128.2 5897.87,-1125.72 5903.74,-1124.48 5903.74,-1124.48 6131.26,-1076.44 6131.26,-1076.44 6137.13,-1075.2 6148.87,-1075.2 6154.74,-1076.44 6154.74,-1076.44 6382.26,-1124.48 6382.26,-1124.48 6388.13,-1125.72 6388.13,-1128.2 6382.26,-1129.44 6382.26,-1129.44 6154.74,-1177.48 6154.74,-1177.48 6148.87,-1178.72 6137.13,-1178.72 6131.26,-1177.48"/>
<text text-anchor="middle" x="6143" y="-1138.26" font-family="Times,serif" font-size="14.00">Concat Head Group 0</text>
<text text-anchor="middle" x="6143" y="-1123.26" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="6143" y="-1108.26" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l4_g0&#45;&gt;concat_l4_hg0 -->
<g id="edge239" class="edge">
<title>mha_l4_g0&#45;&gt;concat_l4_hg0</title>
<path fill="none" stroke="black" d="M5497,-1266.81C5497,-1215.89 5497,-1126 5497,-1126 5497,-1126 5886.47,-1126 5886.47,-1126"/>
<polygon fill="black" stroke="black" points="5886.47,-1129.5 5896.47,-1126 5886.47,-1122.5 5886.47,-1129.5"/>
</g>
<!-- mha_l4_g1&#45;&gt;mha_l4_g2 -->
<g id="edge372" class="edge">
<title>mha_l4_g1&#45;&gt;mha_l4_g2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5923.53,-1300C5923.53,-1300 6029.22,-1300 6029.22,-1300"/>
<polygon fill="red" stroke="red" points="6029.22,-1303.5 6039.22,-1300 6029.22,-1296.5 6029.22,-1303.5"/>
</g>
<!-- mha_l4_g1&#45;&gt;mha_l4_g3 -->
<g id="edge373" class="edge">
<title>mha_l4_g1&#45;&gt;mha_l4_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5913,-1266.76C5913,-1233.51 5913,-1188 5913,-1188 5913,-1188 6373,-1188 6373,-1188 6373,-1188 6373,-1256.76 6373,-1256.76"/>
<polygon fill="red" stroke="red" points="6369.5,-1256.76 6373,-1266.76 6376.5,-1256.76 6369.5,-1256.76"/>
<text text-anchor="middle" x="6170" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g1&#45;&gt;concat_l4_hg0 -->
<g id="edge240" class="edge">
<title>mha_l4_g1&#45;&gt;concat_l4_hg0</title>
<path fill="none" stroke="black" d="M5902.5,-1266.58C5902.5,-1266.58 5902.5,-1139.2 5902.5,-1139.2"/>
<polygon fill="black" stroke="black" points="5906,-1139.2 5902.5,-1129.2 5899,-1139.2 5906,-1139.2"/>
</g>
<!-- mha_l4_g2&#45;&gt;mha_l4_g3 -->
<g id="edge374" class="edge">
<title>mha_l4_g2&#45;&gt;mha_l4_g3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6246.53,-1300C6246.53,-1300 6352.22,-1300 6352.22,-1300"/>
<polygon fill="red" stroke="red" points="6352.22,-1303.5 6362.22,-1300 6352.22,-1296.5 6352.22,-1303.5"/>
</g>
<!-- mha_l4_g2&#45;&gt;concat_l4_hg0 -->
<g id="edge241" class="edge">
<title>mha_l4_g2&#45;&gt;concat_l4_hg0</title>
<path fill="none" stroke="black" d="M6143,-1266.58C6143,-1266.58 6143,-1190.11 6143,-1190.11"/>
<polygon fill="black" stroke="black" points="6146.5,-1190.11 6143,-1180.11 6139.5,-1190.11 6146.5,-1190.11"/>
</g>
<!-- mha_l4_g3&#45;&gt;concat_l4_hg0 -->
<g id="edge242" class="edge">
<title>mha_l4_g3&#45;&gt;concat_l4_hg0</title>
<path fill="none" stroke="black" d="M6383.5,-1266.58C6383.5,-1266.58 6383.5,-1139.2 6383.5,-1139.2"/>
<polygon fill="black" stroke="black" points="6387,-1139.2 6383.5,-1129.2 6380,-1139.2 6387,-1139.2"/>
</g>
<!-- mha_l4_g4&#45;&gt;mha_l4_g5 -->
<g id="edge375" class="edge">
<title>mha_l4_g4&#45;&gt;mha_l4_g5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6834.53,-1300C6834.53,-1300 6940.22,-1300 6940.22,-1300"/>
<polygon fill="red" stroke="red" points="6940.22,-1303.5 6950.22,-1300 6940.22,-1296.5 6940.22,-1303.5"/>
</g>
<!-- mha_l4_g4&#45;&gt;mha_l4_g6 -->
<g id="edge376" class="edge">
<title>mha_l4_g4&#45;&gt;mha_l4_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6765.5,-1335.08C6765.5,-1361.63 6765.5,-1394 6765.5,-1394 6765.5,-1394 7289.25,-1394 7289.25,-1394 7289.25,-1394 7289.25,-1345.08 7289.25,-1345.08"/>
<polygon fill="red" stroke="red" points="7292.75,-1345.08 7289.25,-1335.08 7285.75,-1345.08 7292.75,-1345.08"/>
<text text-anchor="middle" x="7173" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g4&#45;&gt;mha_l4_g7 -->
<g id="edge377" class="edge">
<title>mha_l4_g4&#45;&gt;mha_l4_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6746.17,-1266.92C6746.17,-1236.6 6746.17,-1197 6746.17,-1197 6746.17,-1197 7612.25,-1197 7612.25,-1197 7612.25,-1197 7612.25,-1256.92 7612.25,-1256.92"/>
<polygon fill="red" stroke="red" points="7608.75,-1256.92 7612.25,-1266.92 7615.75,-1256.92 7608.75,-1256.92"/>
<text text-anchor="middle" x="7345" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l4_hg1 -->
<g id="node145" class="node">
<title>concat_l4_hg1</title>
<path fill="#ffb347" stroke="black" d="M7365.26,-1177.48C7365.26,-1177.48 7137.74,-1129.44 7137.74,-1129.44 7131.87,-1128.2 7131.87,-1125.72 7137.74,-1124.48 7137.74,-1124.48 7365.26,-1076.44 7365.26,-1076.44 7371.13,-1075.2 7382.87,-1075.2 7388.74,-1076.44 7388.74,-1076.44 7616.26,-1124.48 7616.26,-1124.48 7622.13,-1125.72 7622.13,-1128.2 7616.26,-1129.44 7616.26,-1129.44 7388.74,-1177.48 7388.74,-1177.48 7382.87,-1178.72 7371.13,-1178.72 7365.26,-1177.48"/>
<text text-anchor="middle" x="7377" y="-1138.26" font-family="Times,serif" font-size="14.00">Concat Head Group 1</text>
<text text-anchor="middle" x="7377" y="-1123.26" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="7377" y="-1108.26" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l4_g4&#45;&gt;concat_l4_hg1 -->
<g id="edge243" class="edge">
<title>mha_l4_g4&#45;&gt;concat_l4_hg1</title>
<path fill="none" stroke="black" d="M6790.33,-1266.81C6790.33,-1215.89 6790.33,-1126 6790.33,-1126 6790.33,-1126 7120.33,-1126 7120.33,-1126"/>
<polygon fill="black" stroke="black" points="7120.33,-1129.5 7130.33,-1126 7120.33,-1122.5 7120.33,-1129.5"/>
</g>
<!-- mha_l4_g5&#45;&gt;mha_l4_g6 -->
<g id="edge378" class="edge">
<title>mha_l4_g5&#45;&gt;mha_l4_g6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7157.53,-1300C7157.53,-1300 7263.22,-1300 7263.22,-1300"/>
<polygon fill="red" stroke="red" points="7263.22,-1303.5 7273.22,-1300 7263.22,-1296.5 7263.22,-1303.5"/>
</g>
<!-- mha_l4_g5&#45;&gt;mha_l4_g7 -->
<g id="edge379" class="edge">
<title>mha_l4_g5&#45;&gt;mha_l4_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7147,-1266.95C7147,-1239.7 7147,-1206 7147,-1206 7147,-1206 7604.38,-1206 7604.38,-1206 7604.38,-1206 7604.38,-1256.95 7604.38,-1256.95"/>
<polygon fill="red" stroke="red" points="7600.88,-1256.95 7604.38,-1266.95 7607.88,-1256.95 7600.88,-1256.95"/>
<text text-anchor="middle" x="7406" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g5&#45;&gt;concat_l4_hg1 -->
<g id="edge244" class="edge">
<title>mha_l4_g5&#45;&gt;concat_l4_hg1</title>
<path fill="none" stroke="black" d="M7136.5,-1266.58C7136.5,-1266.58 7136.5,-1139.2 7136.5,-1139.2"/>
<polygon fill="black" stroke="black" points="7140,-1139.2 7136.5,-1129.2 7133,-1139.2 7140,-1139.2"/>
</g>
<!-- mha_l4_g6&#45;&gt;mha_l4_g7 -->
<g id="edge380" class="edge">
<title>mha_l4_g6&#45;&gt;mha_l4_g7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7480.53,-1300C7480.53,-1300 7586.22,-1300 7586.22,-1300"/>
<polygon fill="red" stroke="red" points="7586.22,-1303.5 7596.22,-1300 7586.22,-1296.5 7586.22,-1303.5"/>
</g>
<!-- mha_l4_g6&#45;&gt;concat_l4_hg1 -->
<g id="edge245" class="edge">
<title>mha_l4_g6&#45;&gt;concat_l4_hg1</title>
<path fill="none" stroke="black" d="M7377,-1266.58C7377,-1266.58 7377,-1190.11 7377,-1190.11"/>
<polygon fill="black" stroke="black" points="7380.5,-1190.11 7377,-1180.11 7373.5,-1190.11 7380.5,-1190.11"/>
</g>
<!-- mha_l4_g7&#45;&gt;concat_l4_hg1 -->
<g id="edge246" class="edge">
<title>mha_l4_g7&#45;&gt;concat_l4_hg1</title>
<path fill="none" stroke="black" d="M7620.12,-1266.58C7620.12,-1266.58 7620.12,-1138.85 7620.12,-1138.85"/>
<polygon fill="black" stroke="black" points="7623.63,-1138.85 7620.12,-1128.85 7616.63,-1138.85 7623.63,-1138.85"/>
</g>
<!-- mha_l4_g8&#45;&gt;mha_l4_g9 -->
<g id="edge381" class="edge">
<title>mha_l4_g8&#45;&gt;mha_l4_g9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8068.53,-1300C8068.53,-1300 8174.22,-1300 8174.22,-1300"/>
<polygon fill="red" stroke="red" points="8174.22,-1303.5 8184.22,-1300 8174.22,-1296.5 8174.22,-1303.5"/>
</g>
<!-- mha_l4_g8&#45;&gt;mha_l4_g10 -->
<g id="edge382" class="edge">
<title>mha_l4_g8&#45;&gt;mha_l4_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8045.25,-1266.54C8045.25,-1245.65 8045.25,-1223 8045.25,-1223 8045.25,-1223 8569,-1223 8569,-1223 8569,-1223 8569,-1256.54 8569,-1256.54"/>
<polygon fill="red" stroke="red" points="8565.5,-1256.54 8569,-1266.54 8572.5,-1256.54 8565.5,-1256.54"/>
<text text-anchor="middle" x="8165" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g8&#45;&gt;mha_l4_g11 -->
<g id="edge383" class="edge">
<title>mha_l4_g8&#45;&gt;mha_l4_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8033.62,-1266.59C8033.62,-1242.28 8033.62,-1214 8033.62,-1214 8033.62,-1214 8837.25,-1214 8837.25,-1214 8837.25,-1214 8837.25,-1256.59 8837.25,-1256.59"/>
<polygon fill="red" stroke="red" points="8833.75,-1256.59 8837.25,-1266.59 8840.75,-1256.59 8833.75,-1256.59"/>
<text text-anchor="middle" x="8222" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l4_hg2 -->
<g id="node146" class="node">
<title>concat_l4_hg2</title>
<path fill="#ffb347" stroke="black" d="M8429.26,-1177.48C8429.26,-1177.48 8201.74,-1129.44 8201.74,-1129.44 8195.87,-1128.2 8195.87,-1125.72 8201.74,-1124.48 8201.74,-1124.48 8429.26,-1076.44 8429.26,-1076.44 8435.13,-1075.2 8446.87,-1075.2 8452.74,-1076.44 8452.74,-1076.44 8680.26,-1124.48 8680.26,-1124.48 8686.13,-1125.72 8686.13,-1128.2 8680.26,-1129.44 8680.26,-1129.44 8452.74,-1177.48 8452.74,-1177.48 8446.87,-1178.72 8435.13,-1178.72 8429.26,-1177.48"/>
<text text-anchor="middle" x="8441" y="-1138.26" font-family="Times,serif" font-size="14.00">Concat Head Group 2</text>
<text text-anchor="middle" x="8441" y="-1123.26" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="8441" y="-1108.26" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l4_g8&#45;&gt;concat_l4_hg2 -->
<g id="edge247" class="edge">
<title>mha_l4_g8&#45;&gt;concat_l4_hg2</title>
<path fill="none" stroke="black" d="M8056.88,-1266.81C8056.88,-1215.89 8056.88,-1126 8056.88,-1126 8056.88,-1126 8184.47,-1126 8184.47,-1126"/>
<polygon fill="black" stroke="black" points="8184.47,-1129.5 8194.47,-1126 8184.47,-1122.5 8184.47,-1129.5"/>
</g>
<!-- mha_l4_g9&#45;&gt;mha_l4_g10 -->
<g id="edge384" class="edge">
<title>mha_l4_g9&#45;&gt;mha_l4_g10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8391.53,-1300C8391.53,-1300 8497.22,-1300 8497.22,-1300"/>
<polygon fill="red" stroke="red" points="8497.22,-1303.5 8507.22,-1300 8497.22,-1296.5 8497.22,-1303.5"/>
</g>
<!-- mha_l4_g9&#45;&gt;mha_l4_g11 -->
<g id="edge385" class="edge">
<title>mha_l4_g9&#45;&gt;mha_l4_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8324.33,-1266.88C8324.33,-1249.51 8324.33,-1232 8324.33,-1232 8324.33,-1232 8833.88,-1232 8833.88,-1232 8833.88,-1232 8833.88,-1256.88 8833.88,-1256.88"/>
<polygon fill="red" stroke="red" points="8830.38,-1256.88 8833.88,-1266.88 8837.38,-1256.88 8830.38,-1256.88"/>
<text text-anchor="middle" x="8512" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g9&#45;&gt;concat_l4_hg2 -->
<g id="edge248" class="edge">
<title>mha_l4_g9&#45;&gt;concat_l4_hg2</title>
<path fill="none" stroke="black" d="M8257.17,-1266.58C8257.17,-1266.58 8257.17,-1151.22 8257.17,-1151.22"/>
<polygon fill="black" stroke="black" points="8260.67,-1151.22 8257.17,-1141.22 8253.67,-1151.22 8260.67,-1151.22"/>
</g>
<!-- mha_l4_g10&#45;&gt;mha_l4_g11 -->
<g id="edge386" class="edge">
<title>mha_l4_g10&#45;&gt;mha_l4_g11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8714.53,-1300C8714.53,-1300 8820.22,-1300 8820.22,-1300"/>
<polygon fill="red" stroke="red" points="8820.22,-1303.5 8830.22,-1300 8820.22,-1296.5 8820.22,-1303.5"/>
</g>
<!-- mha_l4_g10&#45;&gt;concat_l4_hg2 -->
<g id="edge249" class="edge">
<title>mha_l4_g10&#45;&gt;concat_l4_hg2</title>
<path fill="none" stroke="black" d="M8630.5,-1266.58C8630.5,-1266.58 8630.5,-1149.98 8630.5,-1149.98"/>
<polygon fill="black" stroke="black" points="8634,-1149.98 8630.5,-1139.98 8627,-1149.98 8634,-1149.98"/>
</g>
<!-- mha_l4_g11&#45;&gt;concat_l4_hg2 -->
<g id="edge250" class="edge">
<title>mha_l4_g11&#45;&gt;concat_l4_hg2</title>
<path fill="none" stroke="black" d="M8840.62,-1266.81C8840.62,-1215.89 8840.62,-1126 8840.62,-1126 8840.62,-1126 8697.55,-1126 8697.55,-1126"/>
<polygon fill="black" stroke="black" points="8697.55,-1122.5 8687.55,-1126 8697.55,-1129.5 8697.55,-1122.5"/>
</g>
<!-- mha_l4_g12&#45;&gt;mha_l4_g13 -->
<g id="edge387" class="edge">
<title>mha_l4_g12&#45;&gt;mha_l4_g13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9302.53,-1300C9302.53,-1300 9408.22,-1300 9408.22,-1300"/>
<polygon fill="red" stroke="red" points="9408.22,-1303.5 9418.22,-1300 9408.22,-1296.5 9408.22,-1303.5"/>
</g>
<!-- mha_l4_g12&#45;&gt;mha_l4_g14 -->
<g id="edge388" class="edge">
<title>mha_l4_g12&#45;&gt;mha_l4_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9294.62,-1266.88C9294.62,-1257.09 9294.62,-1249 9294.62,-1249 9294.62,-1249 9752,-1249 9752,-1249 9752,-1249 9752,-1256.88 9752,-1256.88"/>
<polygon fill="red" stroke="red" points="9748.5,-1256.88 9752,-1266.88 9755.5,-1256.88 9748.5,-1256.88"/>
<text text-anchor="middle" x="9561" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g12&#45;&gt;mha_l4_g15 -->
<g id="edge389" class="edge">
<title>mha_l4_g12&#45;&gt;mha_l4_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9286.75,-1266.92C9286.75,-1252.95 9286.75,-1240 9286.75,-1240 9286.75,-1240 10139.12,-1240 10139.12,-1240 10139.12,-1240 10139.12,-1256.92 10139.12,-1256.92"/>
<polygon fill="red" stroke="red" points="10135.63,-1256.92 10139.12,-1266.92 10142.63,-1256.92 10135.63,-1256.92"/>
<text text-anchor="middle" x="9382" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- concat_l4_hg3 -->
<g id="node147" class="node">
<title>concat_l4_hg3</title>
<path fill="#ffb347" stroke="black" d="M9510.26,-1177.48C9510.26,-1177.48 9282.74,-1129.44 9282.74,-1129.44 9276.87,-1128.2 9276.87,-1125.72 9282.74,-1124.48 9282.74,-1124.48 9510.26,-1076.44 9510.26,-1076.44 9516.13,-1075.2 9527.87,-1075.2 9533.74,-1076.44 9533.74,-1076.44 9761.26,-1124.48 9761.26,-1124.48 9767.13,-1125.72 9767.13,-1128.2 9761.26,-1129.44 9761.26,-1129.44 9533.74,-1177.48 9533.74,-1177.48 9527.87,-1178.72 9516.13,-1178.72 9510.26,-1177.48"/>
<text text-anchor="middle" x="9522" y="-1138.26" font-family="Times,serif" font-size="14.00">Concat Head Group 3</text>
<text text-anchor="middle" x="9522" y="-1123.26" font-family="Times,serif" font-size="14.00">B=1024, L=2048, H=16, D=128</text>
<text text-anchor="middle" x="9522" y="-1108.26" font-family="Times,serif" font-size="14.00">16 heads × 128 dims = 2048</text>
</g>
<!-- mha_l4_g12&#45;&gt;concat_l4_hg3 -->
<g id="edge251" class="edge">
<title>mha_l4_g12&#45;&gt;concat_l4_hg3</title>
<path fill="none" stroke="black" d="M9278.88,-1266.58C9278.88,-1266.58 9278.88,-1138.85 9278.88,-1138.85"/>
<polygon fill="black" stroke="black" points="9282.38,-1138.85 9278.88,-1128.85 9275.38,-1138.85 9282.38,-1138.85"/>
</g>
<!-- mha_l4_g13&#45;&gt;mha_l4_g14 -->
<g id="edge390" class="edge">
<title>mha_l4_g13&#45;&gt;mha_l4_g14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9625.53,-1300C9625.53,-1300 9731.22,-1300 9731.22,-1300"/>
<polygon fill="red" stroke="red" points="9731.22,-1303.5 9741.22,-1300 9731.22,-1296.5 9731.22,-1303.5"/>
</g>
<!-- mha_l4_g13&#45;&gt;mha_l4_g15 -->
<g id="edge391" class="edge">
<title>mha_l4_g13&#45;&gt;mha_l4_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9556.5,-1266.69C9556.5,-1261.59 9556.5,-1258 9556.5,-1258 9556.5,-1258 10114.25,-1258 10114.25,-1258 10114.25,-1258 10114.25,-1258.87 10114.25,-1258.87"/>
<polygon fill="red" stroke="red" points="10110.75,-1256.69 10114.25,-1266.69 10117.75,-1256.69 10110.75,-1256.69"/>
<text text-anchor="middle" x="9726" y="-1400.76" font-family="Times,serif" font-size="14.00">comm</text>
</g>
<!-- mha_l4_g13&#45;&gt;concat_l4_hg3 -->
<g id="edge252" class="edge">
<title>mha_l4_g13&#45;&gt;concat_l4_hg3</title>
<path fill="none" stroke="black" d="M9487.5,-1266.58C9487.5,-1266.58 9487.5,-1182.8 9487.5,-1182.8"/>
<polygon fill="black" stroke="black" points="9491,-1182.8 9487.5,-1172.8 9484,-1182.8 9491,-1182.8"/>
</g>
<!-- mha_l4_g14&#45;&gt;mha_l4_g15 -->
<g id="edge392" class="edge">
<title>mha_l4_g14&#45;&gt;mha_l4_g15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9948.53,-1300C9948.53,-1300 10054.22,-1300 10054.22,-1300"/>
<polygon fill="red" stroke="red" points="10054.22,-1303.5 10064.22,-1300 10054.22,-1296.5 10054.22,-1303.5"/>
</g>
<!-- mha_l4_g14&#45;&gt;concat_l4_hg3 -->
<g id="edge253" class="edge">
<title>mha_l4_g14&#45;&gt;concat_l4_hg3</title>
<path fill="none" stroke="black" d="M9762.5,-1266.58C9762.5,-1266.58 9762.5,-1139.2 9762.5,-1139.2"/>
<polygon fill="black" stroke="black" points="9766,-1139.2 9762.5,-1129.2 9759,-1139.2 9766,-1139.2"/>
</g>
<!-- mha_l4_g15&#45;&gt;concat_l4_hg3 -->
<g id="edge254" class="edge">
<title>mha_l4_g15&#45;&gt;concat_l4_hg3</title>
<path fill="none" stroke="black" d="M10089.38,-1266.81C10089.38,-1215.89 10089.38,-1126 10089.38,-1126 10089.38,-1126 9778.8,-1126 9778.8,-1126"/>
<polygon fill="black" stroke="black" points="9778.8,-1122.5 9768.8,-1126 9778.8,-1129.5 9778.8,-1122.5"/>
</g>
<!-- final_concat_l4 -->
<g id="node148" class="node">
<title>final_concat_l4</title>
<path fill="#ff8c00" stroke="black" d="M8429.37,-984.01C8429.37,-984.01 8243.63,-936.91 8243.63,-936.91 8237.82,-935.44 8237.82,-932.49 8243.63,-931.01 8243.63,-931.01 8429.37,-883.91 8429.37,-883.91 8435.18,-882.44 8446.82,-882.44 8452.63,-883.91 8452.63,-883.91 8638.37,-931.01 8638.37,-931.01 8644.18,-932.49 8644.18,-935.44 8638.37,-936.91 8638.37,-936.91 8452.63,-984.01 8452.63,-984.01 8446.82,-985.49 8435.18,-985.49 8429.37,-984.01"/>
<text text-anchor="middle" x="8441" y="-945.26" font-family="Times,serif" font-size="14.00">Final Concat</text>
<text text-anchor="middle" x="8441" y="-930.26" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
<text text-anchor="middle" x="8441" y="-915.26" font-family="Times,serif" font-size="14.00">All heads combined</text>
</g>
<!-- concat_l4_hg0&#45;&gt;final_concat_l4 -->
<g id="edge255" class="edge">
<title>concat_l4_hg0&#45;&gt;final_concat_l4</title>
<path fill="none" stroke="black" d="M6143,-1073.73C6143,-1011.23 6143,-916 6143,-916 6143,-916 8292.42,-916 8292.42,-916"/>
<polygon fill="black" stroke="black" points="8292.42,-919.5 8302.42,-916 8292.42,-912.5 8292.42,-919.5"/>
</g>
<!-- concat_l4_hg1&#45;&gt;final_concat_l4 -->
<g id="edge256" class="edge">
<title>concat_l4_hg1&#45;&gt;final_concat_l4</title>
<path fill="none" stroke="black" d="M7605,-1121.88C7605,-1093.03 7605,-951 7605,-951 7605,-951 8289.18,-951 8289.18,-951"/>
<polygon fill="black" stroke="black" points="8289.18,-954.5 8299.18,-951 8289.18,-947.5 8289.18,-954.5"/>
</g>
<!-- concat_l4_hg2&#45;&gt;final_concat_l4 -->
<g id="edge257" class="edge">
<title>concat_l4_hg2&#45;&gt;final_concat_l4</title>
<path fill="none" stroke="black" d="M8441,-1073.71C8441,-1073.71 8441,-997.04 8441,-997.04"/>
<polygon fill="black" stroke="black" points="8444.5,-997.04 8441,-987.04 8437.5,-997.04 8444.5,-997.04"/>
</g>
<!-- concat_l4_hg3&#45;&gt;final_concat_l4 -->
<g id="edge258" class="edge">
<title>concat_l4_hg3&#45;&gt;final_concat_l4</title>
<path fill="none" stroke="black" d="M9277.5,-1125.28C9277.5,-1106.33 9277.5,-933 9277.5,-933 9277.5,-933 8656.43,-933 8656.43,-933"/>
<polygon fill="black" stroke="black" points="8656.43,-929.5 8646.43,-933 8656.43,-936.5 8656.43,-929.5"/>
</g>
<!-- final_concat_l4&#45;&gt;ln1_l4 -->
<g id="edge259" class="edge">
<title>final_concat_l4&#45;&gt;ln1_l4</title>
<path fill="none" stroke="black" d="M8543,-906.78C8543,-906.78 8543,-803.98 8543,-803.98"/>
<polygon fill="black" stroke="black" points="8546.5,-803.98 8543,-793.98 8539.5,-803.98 8546.5,-803.98"/>
</g>
<!-- ffn_l4_g0 -->
<g id="node149" class="node">
<title>ffn_l4_g0</title>
<path fill="#ff6b6b" stroke="black" stroke-width="2" d="M6852,-512.48C6852,-512.48 6714,-512.48 6714,-512.48 6708,-512.48 6702,-506.48 6702,-500.48 6702,-500.48 6702,-456.48 6702,-456.48 6702,-450.48 6708,-444.48 6714,-444.48 6714,-444.48 6852,-444.48 6852,-444.48 6858,-444.48 6864,-450.48 6864,-456.48 6864,-456.48 6864,-500.48 6864,-500.48 6864,-506.48 6858,-512.48 6852,-512.48"/>
<text text-anchor="middle" x="6783" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 0</text>
<text text-anchor="middle" x="6783" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="6783" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="6783" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ffn_concat_l4 -->
<g id="node165" class="node">
<title>ffn_concat_l4</title>
<path fill="#90ee90" stroke="black" d="M8531.19,-355.33C8531.19,-355.33 8345.81,-321.63 8345.81,-321.63 8339.9,-320.55 8339.9,-318.41 8345.81,-317.33 8345.81,-317.33 8531.19,-283.63 8531.19,-283.63 8537.1,-282.55 8548.9,-282.55 8554.81,-283.63 8554.81,-283.63 8740.19,-317.33 8740.19,-317.33 8746.1,-318.41 8746.1,-320.55 8740.19,-321.63 8740.19,-321.63 8554.81,-355.33 8554.81,-355.33 8548.9,-356.41 8537.1,-356.41 8531.19,-355.33"/>
<text text-anchor="middle" x="8543" y="-323.28" font-family="Times,serif" font-size="14.00">FFN Concat</text>
<text text-anchor="middle" x="8543" y="-308.28" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ffn_l4_g0&#45;&gt;ffn_concat_l4 -->
<g id="edge278" class="edge">
<title>ffn_l4_g0&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M6783,-444.35C6783,-390.03 6783,-290 6783,-290 6783,-290 8485.92,-290 8485.92,-290"/>
<polygon fill="black" stroke="black" points="8485.92,-293.5 8495.92,-290 8485.92,-286.5 8485.92,-293.5"/>
</g>
<!-- ffn_l4_g1 -->
<g id="node150" class="node">
<title>ffn_l4_g1</title>
<path fill="#4ecdc4" stroke="black" stroke-width="2" d="M7072,-512.48C7072,-512.48 6934,-512.48 6934,-512.48 6928,-512.48 6922,-506.48 6922,-500.48 6922,-500.48 6922,-456.48 6922,-456.48 6922,-450.48 6928,-444.48 6934,-444.48 6934,-444.48 7072,-444.48 7072,-444.48 7078,-444.48 7084,-450.48 7084,-456.48 7084,-456.48 7084,-500.48 7084,-500.48 7084,-506.48 7078,-512.48 7072,-512.48"/>
<text text-anchor="middle" x="7003" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 1</text>
<text text-anchor="middle" x="7003" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7003" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7003" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn_l4_g1&#45;&gt;ffn_concat_l4 -->
<g id="edge279" class="edge">
<title>ffn_l4_g1&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M7003,-444.07C7003,-392.2 7003,-300 7003,-300 7003,-300 8431.06,-300 8431.06,-300"/>
<polygon fill="black" stroke="black" points="8431.06,-303.5 8441.06,-300 8431.06,-296.5 8431.06,-303.5"/>
</g>
<!-- ffn_l4_g2 -->
<g id="node151" class="node">
<title>ffn_l4_g2</title>
<path fill="#45b7d1" stroke="black" stroke-width="2" d="M7292,-512.48C7292,-512.48 7154,-512.48 7154,-512.48 7148,-512.48 7142,-506.48 7142,-500.48 7142,-500.48 7142,-456.48 7142,-456.48 7142,-450.48 7148,-444.48 7154,-444.48 7154,-444.48 7292,-444.48 7292,-444.48 7298,-444.48 7304,-450.48 7304,-456.48 7304,-456.48 7304,-500.48 7304,-500.48 7304,-506.48 7298,-512.48 7292,-512.48"/>
<text text-anchor="middle" x="7223" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 2</text>
<text text-anchor="middle" x="7223" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7223" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7223" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn_l4_g2&#45;&gt;ffn_concat_l4 -->
<g id="edge280" class="edge">
<title>ffn_l4_g2&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M7223,-444.18C7223,-394.66 7223,-309 7223,-309 7223,-309 8381.58,-309 8381.58,-309"/>
<polygon fill="black" stroke="black" points="8381.58,-312.5 8391.58,-309 8381.58,-305.5 8381.58,-312.5"/>
</g>
<!-- ffn_l4_g3 -->
<g id="node152" class="node">
<title>ffn_l4_g3</title>
<path fill="#96ceb4" stroke="black" stroke-width="2" d="M7512,-512.48C7512,-512.48 7374,-512.48 7374,-512.48 7368,-512.48 7362,-506.48 7362,-500.48 7362,-500.48 7362,-456.48 7362,-456.48 7362,-450.48 7368,-444.48 7374,-444.48 7374,-444.48 7512,-444.48 7512,-444.48 7518,-444.48 7524,-450.48 7524,-456.48 7524,-456.48 7524,-500.48 7524,-500.48 7524,-506.48 7518,-512.48 7512,-512.48"/>
<text text-anchor="middle" x="7443" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 3</text>
<text text-anchor="middle" x="7443" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7443" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7443" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn_l4_g3&#45;&gt;ffn_concat_l4 -->
<g id="edge281" class="edge">
<title>ffn_l4_g3&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M7443,-444.27C7443,-397.41 7443,-319 7443,-319 7443,-319 8326.42,-319 8326.42,-319"/>
<polygon fill="black" stroke="black" points="8326.42,-322.5 8336.42,-319 8326.42,-315.5 8326.42,-322.5"/>
</g>
<!-- ffn_l4_g4 -->
<g id="node153" class="node">
<title>ffn_l4_g4</title>
<path fill="#feca57" stroke="black" stroke-width="2" d="M7732,-512.48C7732,-512.48 7594,-512.48 7594,-512.48 7588,-512.48 7582,-506.48 7582,-500.48 7582,-500.48 7582,-456.48 7582,-456.48 7582,-450.48 7588,-444.48 7594,-444.48 7594,-444.48 7732,-444.48 7732,-444.48 7738,-444.48 7744,-450.48 7744,-456.48 7744,-456.48 7744,-500.48 7744,-500.48 7744,-506.48 7738,-512.48 7732,-512.48"/>
<text text-anchor="middle" x="7663" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 4</text>
<text text-anchor="middle" x="7663" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7663" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7663" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn_l4_g4&#45;&gt;ffn_concat_l4 -->
<g id="edge282" class="edge">
<title>ffn_l4_g4&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M7663,-444.33C7663,-399.94 7663,-328 7663,-328 7663,-328 8370.83,-328 8370.83,-328"/>
<polygon fill="black" stroke="black" points="8370.83,-331.5 8380.83,-328 8370.83,-324.5 8370.83,-331.5"/>
</g>
<!-- ffn_l4_g5 -->
<g id="node154" class="node">
<title>ffn_l4_g5</title>
<path fill="#ff9ff3" stroke="black" stroke-width="2" d="M7952,-512.48C7952,-512.48 7814,-512.48 7814,-512.48 7808,-512.48 7802,-506.48 7802,-500.48 7802,-500.48 7802,-456.48 7802,-456.48 7802,-450.48 7808,-444.48 7814,-444.48 7814,-444.48 7952,-444.48 7952,-444.48 7958,-444.48 7964,-450.48 7964,-456.48 7964,-456.48 7964,-500.48 7964,-500.48 7964,-506.48 7958,-512.48 7952,-512.48"/>
<text text-anchor="middle" x="7883" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 5</text>
<text text-anchor="middle" x="7883" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="7883" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="7883" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn_l4_g5&#45;&gt;ffn_concat_l4 -->
<g id="edge283" class="edge">
<title>ffn_l4_g5&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M7883,-444.47C7883,-402.9 7883,-338 7883,-338 7883,-338 8425.86,-338 8425.86,-338"/>
<polygon fill="black" stroke="black" points="8425.86,-341.5 8435.86,-338 8425.86,-334.5 8425.86,-341.5"/>
</g>
<!-- ffn_l4_g6 -->
<g id="node155" class="node">
<title>ffn_l4_g6</title>
<path fill="#54a0ff" stroke="black" stroke-width="2" d="M8172,-512.48C8172,-512.48 8034,-512.48 8034,-512.48 8028,-512.48 8022,-506.48 8022,-500.48 8022,-500.48 8022,-456.48 8022,-456.48 8022,-450.48 8028,-444.48 8034,-444.48 8034,-444.48 8172,-444.48 8172,-444.48 8178,-444.48 8184,-450.48 8184,-456.48 8184,-456.48 8184,-500.48 8184,-500.48 8184,-506.48 8178,-512.48 8172,-512.48"/>
<text text-anchor="middle" x="8103" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 6</text>
<text text-anchor="middle" x="8103" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8103" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8103" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn_l4_g6&#45;&gt;ffn_concat_l4 -->
<g id="edge284" class="edge">
<title>ffn_l4_g6&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M8103,-444.28C8103,-405.32 8103,-347 8103,-347 8103,-347 8475.03,-347 8475.03,-347"/>
<polygon fill="black" stroke="black" points="8475.03,-350.5 8485.03,-347 8475.03,-343.5 8475.03,-350.5"/>
</g>
<!-- ffn_l4_g7 -->
<g id="node156" class="node">
<title>ffn_l4_g7</title>
<path fill="#5f27cd" stroke="black" stroke-width="2" d="M8392,-512.48C8392,-512.48 8254,-512.48 8254,-512.48 8248,-512.48 8242,-506.48 8242,-500.48 8242,-500.48 8242,-456.48 8242,-456.48 8242,-450.48 8248,-444.48 8254,-444.48 8254,-444.48 8392,-444.48 8392,-444.48 8398,-444.48 8404,-450.48 8404,-456.48 8404,-456.48 8404,-500.48 8404,-500.48 8404,-506.48 8398,-512.48 8392,-512.48"/>
<text text-anchor="middle" x="8323" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 7</text>
<text text-anchor="middle" x="8323" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8323" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8323" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn_l4_g7&#45;&gt;ffn_concat_l4 -->
<g id="edge285" class="edge">
<title>ffn_l4_g7&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M8369,-444.37C8369,-444.37 8369,-335.85 8369,-335.85"/>
<polygon fill="black" stroke="black" points="8372.5,-335.85 8369,-325.85 8365.5,-335.85 8372.5,-335.85"/>
</g>
<!-- ffn_l4_g8 -->
<g id="node157" class="node">
<title>ffn_l4_g8</title>
<path fill="#00d2d3" stroke="black" stroke-width="2" d="M8612,-512.48C8612,-512.48 8474,-512.48 8474,-512.48 8468,-512.48 8462,-506.48 8462,-500.48 8462,-500.48 8462,-456.48 8462,-456.48 8462,-450.48 8468,-444.48 8474,-444.48 8474,-444.48 8612,-444.48 8612,-444.48 8618,-444.48 8624,-450.48 8624,-456.48 8624,-456.48 8624,-500.48 8624,-500.48 8624,-506.48 8618,-512.48 8612,-512.48"/>
<text text-anchor="middle" x="8543" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 8</text>
<text text-anchor="middle" x="8543" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8543" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8543" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn_l4_g8&#45;&gt;ffn_concat_l4 -->
<g id="edge286" class="edge">
<title>ffn_l4_g8&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M8543,-444.37C8543,-444.37 8543,-367.72 8543,-367.72"/>
<polygon fill="black" stroke="black" points="8546.5,-367.72 8543,-357.72 8539.5,-367.72 8546.5,-367.72"/>
</g>
<!-- ffn_l4_g9 -->
<g id="node158" class="node">
<title>ffn_l4_g9</title>
<path fill="#ff9f43" stroke="black" stroke-width="2" d="M8832,-512.48C8832,-512.48 8694,-512.48 8694,-512.48 8688,-512.48 8682,-506.48 8682,-500.48 8682,-500.48 8682,-456.48 8682,-456.48 8682,-450.48 8688,-444.48 8694,-444.48 8694,-444.48 8832,-444.48 8832,-444.48 8838,-444.48 8844,-450.48 8844,-456.48 8844,-456.48 8844,-500.48 8844,-500.48 8844,-506.48 8838,-512.48 8832,-512.48"/>
<text text-anchor="middle" x="8763" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 9</text>
<text text-anchor="middle" x="8763" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8763" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8763" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn_l4_g9&#45;&gt;ffn_concat_l4 -->
<g id="edge287" class="edge">
<title>ffn_l4_g9&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M8717,-444.37C8717,-444.37 8717,-335.85 8717,-335.85"/>
<polygon fill="black" stroke="black" points="8720.5,-335.85 8717,-325.85 8713.5,-335.85 8720.5,-335.85"/>
</g>
<!-- ffn_l4_g10 -->
<g id="node159" class="node">
<title>ffn_l4_g10</title>
<path fill="#10ac84" stroke="black" stroke-width="2" d="M9052,-512.48C9052,-512.48 8914,-512.48 8914,-512.48 8908,-512.48 8902,-506.48 8902,-500.48 8902,-500.48 8902,-456.48 8902,-456.48 8902,-450.48 8908,-444.48 8914,-444.48 8914,-444.48 9052,-444.48 9052,-444.48 9058,-444.48 9064,-450.48 9064,-456.48 9064,-456.48 9064,-500.48 9064,-500.48 9064,-506.48 9058,-512.48 9052,-512.48"/>
<text text-anchor="middle" x="8983" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 10</text>
<text text-anchor="middle" x="8983" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="8983" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="8983" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn_l4_g10&#45;&gt;ffn_concat_l4 -->
<g id="edge288" class="edge">
<title>ffn_l4_g10&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M8983,-444.28C8983,-405.32 8983,-347 8983,-347 8983,-347 8610.97,-347 8610.97,-347"/>
<polygon fill="black" stroke="black" points="8610.97,-343.5 8600.97,-347 8610.97,-350.5 8610.97,-343.5"/>
</g>
<!-- ffn_l4_g11 -->
<g id="node160" class="node">
<title>ffn_l4_g11</title>
<path fill="#ee5a24" stroke="black" stroke-width="2" d="M9272,-512.48C9272,-512.48 9134,-512.48 9134,-512.48 9128,-512.48 9122,-506.48 9122,-500.48 9122,-500.48 9122,-456.48 9122,-456.48 9122,-450.48 9128,-444.48 9134,-444.48 9134,-444.48 9272,-444.48 9272,-444.48 9278,-444.48 9284,-450.48 9284,-456.48 9284,-456.48 9284,-500.48 9284,-500.48 9284,-506.48 9278,-512.48 9272,-512.48"/>
<text text-anchor="middle" x="9203" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 11</text>
<text text-anchor="middle" x="9203" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="9203" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="9203" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn_l4_g11&#45;&gt;ffn_concat_l4 -->
<g id="edge289" class="edge">
<title>ffn_l4_g11&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M9178.61,-444.47C9178.61,-402.9 9178.61,-338 9178.61,-338 9178.61,-338 8660.46,-338 8660.46,-338"/>
<polygon fill="black" stroke="black" points="8660.46,-334.5 8650.46,-338 8660.46,-341.5 8660.46,-334.5"/>
</g>
<!-- ffn_l4_g12 -->
<g id="node161" class="node">
<title>ffn_l4_g12</title>
<path fill="#0097e6" stroke="black" stroke-width="2" d="M9492,-512.48C9492,-512.48 9354,-512.48 9354,-512.48 9348,-512.48 9342,-506.48 9342,-500.48 9342,-500.48 9342,-456.48 9342,-456.48 9342,-450.48 9348,-444.48 9354,-444.48 9354,-444.48 9492,-444.48 9492,-444.48 9498,-444.48 9504,-450.48 9504,-456.48 9504,-456.48 9504,-500.48 9504,-500.48 9504,-506.48 9498,-512.48 9492,-512.48"/>
<text text-anchor="middle" x="9423" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 12</text>
<text text-anchor="middle" x="9423" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="9423" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="9423" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn_l4_g12&#45;&gt;ffn_concat_l4 -->
<g id="edge290" class="edge">
<title>ffn_l4_g12&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M9403.51,-444.33C9403.51,-399.94 9403.51,-328 9403.51,-328 9403.51,-328 8715.36,-328 8715.36,-328"/>
<polygon fill="black" stroke="black" points="8715.36,-324.5 8705.36,-328 8715.36,-331.5 8715.36,-324.5"/>
</g>
<!-- ffn_l4_g13 -->
<g id="node162" class="node">
<title>ffn_l4_g13</title>
<path fill="#40739e" stroke="black" stroke-width="2" d="M9712,-512.48C9712,-512.48 9574,-512.48 9574,-512.48 9568,-512.48 9562,-506.48 9562,-500.48 9562,-500.48 9562,-456.48 9562,-456.48 9562,-450.48 9568,-444.48 9574,-444.48 9574,-444.48 9712,-444.48 9712,-444.48 9718,-444.48 9724,-450.48 9724,-456.48 9724,-456.48 9724,-500.48 9724,-500.48 9724,-506.48 9718,-512.48 9712,-512.48"/>
<text text-anchor="middle" x="9643" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 13</text>
<text text-anchor="middle" x="9643" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="9643" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="9643" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn_l4_g13&#45;&gt;ffn_concat_l4 -->
<g id="edge291" class="edge">
<title>ffn_l4_g13&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M9643,-444.27C9643,-397.41 9643,-319 9643,-319 9643,-319 8759.58,-319 8759.58,-319"/>
<polygon fill="black" stroke="black" points="8759.58,-315.5 8749.58,-319 8759.58,-322.5 8759.58,-315.5"/>
</g>
<!-- ffn_l4_g14 -->
<g id="node163" class="node">
<title>ffn_l4_g14</title>
<path fill="#c44569" stroke="black" stroke-width="2" d="M9932,-512.48C9932,-512.48 9794,-512.48 9794,-512.48 9788,-512.48 9782,-506.48 9782,-500.48 9782,-500.48 9782,-456.48 9782,-456.48 9782,-450.48 9788,-444.48 9794,-444.48 9794,-444.48 9932,-444.48 9932,-444.48 9938,-444.48 9944,-450.48 9944,-456.48 9944,-456.48 9944,-500.48 9944,-500.48 9944,-506.48 9938,-512.48 9932,-512.48"/>
<text text-anchor="middle" x="9863" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 14</text>
<text text-anchor="middle" x="9863" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="9863" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="9863" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn_l4_g14&#45;&gt;ffn_concat_l4 -->
<g id="edge292" class="edge">
<title>ffn_l4_g14&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M9863,-444.18C9863,-394.66 9863,-309 9863,-309 9863,-309 8704.42,-309 8704.42,-309"/>
<polygon fill="black" stroke="black" points="8704.42,-305.5 8694.42,-309 8704.42,-312.5 8704.42,-305.5"/>
</g>
<!-- ffn_l4_g15 -->
<g id="node164" class="node">
<title>ffn_l4_g15</title>
<path fill="#273c75" stroke="black" stroke-width="2" d="M10152,-512.48C10152,-512.48 10014,-512.48 10014,-512.48 10008,-512.48 10002,-506.48 10002,-500.48 10002,-500.48 10002,-456.48 10002,-456.48 10002,-450.48 10008,-444.48 10014,-444.48 10014,-444.48 10152,-444.48 10152,-444.48 10158,-444.48 10164,-450.48 10164,-456.48 10164,-456.48 10164,-500.48 10164,-500.48 10164,-506.48 10158,-512.48 10152,-512.48"/>
<text text-anchor="middle" x="10083" y="-497.28" font-family="Times,serif" font-size="14.00">FFN Partition 15</text>
<text text-anchor="middle" x="10083" y="-482.28" font-family="Times,serif" font-size="14.00">B=1024×2048×512</text>
<text text-anchor="middle" x="10083" y="-467.28" font-family="Times,serif" font-size="14.00">Hidden: 2048</text>
<text text-anchor="middle" x="10083" y="-452.28" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn_l4_g15&#45;&gt;ffn_concat_l4 -->
<g id="edge293" class="edge">
<title>ffn_l4_g15&#45;&gt;ffn_concat_l4</title>
<path fill="none" stroke="black" d="M10083,-444.07C10083,-392.2 10083,-300 10083,-300 10083,-300 8654.94,-300 8654.94,-300"/>
<polygon fill="black" stroke="black" points="8654.94,-296.5 8644.94,-300 8654.94,-303.5 8654.94,-296.5"/>
</g>
<!-- ln2_l4 -->
<g id="node167" class="node">
<title>ln2_l4</title>
<ellipse fill="#e6e6fa" stroke="black" cx="9383" cy="-167.61" rx="82.05" ry="26.74"/>
<text text-anchor="middle" x="9383" y="-171.41" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="9383" y="-156.41" font-family="Times,serif" font-size="14.00">L4</text>
</g>
<!-- ffn_concat_l4&#45;&gt;ln2_l4 -->
<g id="edge294" class="edge">
<title>ffn_concat_l4&#45;&gt;ln2_l4</title>
<path fill="none" stroke="black" d="M8590.11,-290C8757.65,-290 9314.65,-290 9314.65,-290 9314.65,-290 9314.65,-192.62 9314.65,-192.62"/>
<polygon fill="black" stroke="black" points="9318.15,-192.62 9314.65,-182.62 9311.15,-192.62 9318.15,-192.62"/>
</g>
<!-- residual_l4 -->
<g id="node168" class="node">
<title>residual_l4</title>
<ellipse fill="#f5f5dc" stroke="black" cx="8543" cy="-626.35" rx="55.31" ry="26.74"/>
<text text-anchor="middle" x="8543" y="-630.15" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8543" y="-615.15" font-family="Times,serif" font-size="14.00">L4</text>
</g>
<!-- ln1_l4&#45;&gt;residual_l4 -->
<g id="edge261" class="edge">
<title>ln1_l4&#45;&gt;residual_l4</title>
<path fill="none" stroke="black" d="M8543,-739.95C8543,-739.95 8543,-663.4 8543,-663.4"/>
<polygon fill="black" stroke="black" points="8546.5,-663.4 8543,-653.4 8539.5,-663.4 8546.5,-663.4"/>
</g>
<!-- output -->
<g id="node169" class="node">
<title>output</title>
<ellipse fill="#e8f4fd" stroke="#2e86ab" stroke-width="2" cx="9383" cy="-26.87" rx="147.57" ry="26.74"/>
<text text-anchor="middle" x="9383" y="-30.67" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="9383" y="-15.67" font-family="Times,serif" font-size="14.00">B=1024, L=2048, D=8192</text>
</g>
<!-- ln2_l4&#45;&gt;output -->
<g id="edge296" class="edge">
<title>ln2_l4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9383,-140.47C9383,-140.47 9383,-63.92 9383,-63.92"/>
<polygon fill="black" stroke="black" points="9386.5,-63.92 9383,-53.92 9379.5,-63.92 9386.5,-63.92"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g0 -->
<g id="edge262" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g0</title>
<path fill="none" stroke="black" d="M8507.62,-647C8264.4,-647 6849.25,-647 6849.25,-647 6849.25,-647 6849.25,-522.58 6849.25,-522.58"/>
<polygon fill="black" stroke="black" points="6852.75,-522.58 6849.25,-512.58 6845.75,-522.58 6852.75,-522.58"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g1 -->
<g id="edge263" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g1</title>
<path fill="none" stroke="black" d="M8496.5,-641C8240.8,-641 7017.25,-641 7017.25,-641 7017.25,-641 7017.25,-522.55 7017.25,-522.55"/>
<polygon fill="black" stroke="black" points="7020.75,-522.55 7017.25,-512.55 7013.75,-522.55 7020.75,-522.55"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g2 -->
<g id="edge264" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g2</title>
<path fill="none" stroke="black" d="M8490.44,-635C8244.94,-635 7223,-635 7223,-635 7223,-635 7223,-522.83 7223,-522.83"/>
<polygon fill="black" stroke="black" points="7226.5,-522.83 7223,-512.83 7219.5,-522.83 7226.5,-522.83"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g3 -->
<g id="edge265" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g3</title>
<path fill="none" stroke="black" d="M8488.07,-629C8265.56,-629 7443,-629 7443,-629 7443,-629 7443,-522.64 7443,-522.64"/>
<polygon fill="black" stroke="black" points="7446.5,-522.64 7443,-512.64 7439.5,-522.64 7446.5,-522.64"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g4 -->
<g id="edge266" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g4</title>
<path fill="none" stroke="black" d="M8488.09,-623C8298.94,-623 7686,-623 7686,-623 7686,-623 7686,-522.73 7686,-522.73"/>
<polygon fill="black" stroke="black" points="7689.5,-522.73 7686,-512.73 7682.5,-522.73 7689.5,-522.73"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g5 -->
<g id="edge267" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g5</title>
<path fill="none" stroke="black" d="M8491.16,-617C8340.39,-617 7912.75,-617 7912.75,-617 7912.75,-617 7912.75,-522.72 7912.75,-522.72"/>
<polygon fill="black" stroke="black" points="7916.25,-522.72 7912.75,-512.72 7909.25,-522.72 7916.25,-522.72"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g6 -->
<g id="edge268" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g6</title>
<path fill="none" stroke="black" d="M8497.41,-611C8394.98,-611 8155.5,-611 8155.5,-611 8155.5,-611 8155.5,-522.61 8155.5,-522.61"/>
<polygon fill="black" stroke="black" points="8159,-522.61 8155.5,-512.61 8152,-522.61 8159,-522.61"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g7 -->
<g id="edge269" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g7</title>
<path fill="none" stroke="black" d="M8509.11,-605C8447.4,-605 8323,-605 8323,-605 8323,-605 8323,-522.72 8323,-522.72"/>
<polygon fill="black" stroke="black" points="8326.5,-522.72 8323,-512.72 8319.5,-522.72 8326.5,-522.72"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g8 -->
<g id="edge270" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g8</title>
<path fill="none" stroke="black" d="M8543,-599.23C8543,-599.23 8543,-522.72 8543,-522.72"/>
<polygon fill="black" stroke="black" points="8546.5,-522.72 8543,-512.72 8539.5,-522.72 8546.5,-522.72"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g9 -->
<g id="edge271" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g9</title>
<path fill="none" stroke="black" d="M8576.76,-605C8619.32,-605 8687,-605 8687,-605 8687,-605 8687,-522.72 8687,-522.72"/>
<polygon fill="black" stroke="black" points="8690.5,-522.72 8687,-512.72 8683.5,-522.72 8690.5,-522.72"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g10 -->
<g id="edge272" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g10</title>
<path fill="none" stroke="black" d="M8588.67,-611C8698.76,-611 8969.75,-611 8969.75,-611 8969.75,-611 8969.75,-522.61 8969.75,-522.61"/>
<polygon fill="black" stroke="black" points="8973.25,-522.61 8969.75,-512.61 8966.25,-522.61 8973.25,-522.61"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g11 -->
<g id="edge273" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g11</title>
<path fill="none" stroke="black" d="M8594.83,-617C8749.39,-617 9196.5,-617 9196.5,-617 9196.5,-617 9196.5,-522.72 9196.5,-522.72"/>
<polygon fill="black" stroke="black" points="9200,-522.72 9196.5,-512.72 9193,-522.72 9200,-522.72"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g12 -->
<g id="edge274" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g12</title>
<path fill="none" stroke="black" d="M8598.05,-629C8790.7,-629 9423,-629 9423,-629 9423,-629 9423,-522.64 9423,-522.64"/>
<polygon fill="black" stroke="black" points="9426.5,-522.64 9423,-512.64 9419.5,-522.64 9426.5,-522.64"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g13 -->
<g id="edge275" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g13</title>
<path fill="none" stroke="black" d="M8595.32,-635C8813.92,-635 9643,-635 9643,-635 9643,-635 9643,-522.83 9643,-522.83"/>
<polygon fill="black" stroke="black" points="9646.5,-522.83 9643,-512.83 9639.5,-522.83 9646.5,-522.83"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g14 -->
<g id="edge276" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g14</title>
<path fill="none" stroke="black" d="M8589.59,-641C8823.98,-641 9863,-641 9863,-641 9863,-641 9863,-522.55 9863,-522.55"/>
<polygon fill="black" stroke="black" points="9866.5,-522.55 9863,-512.55 9859.5,-522.55 9866.5,-522.55"/>
</g>
<!-- residual_l4&#45;&gt;ffn_l4_g15 -->
<g id="edge277" class="edge">
<title>residual_l4&#45;&gt;ffn_l4_g15</title>
<path fill="none" stroke="black" d="M8578.37,-647C8804.04,-647 10033.25,-647 10033.25,-647 10033.25,-647 10033.25,-522.58 10033.25,-522.58"/>
<polygon fill="black" stroke="black" points="10036.75,-522.58 10033.25,-512.58 10029.75,-522.58 10036.75,-522.58"/>
</g>
<!-- residual_l4&#45;&gt;ln2_l4 -->
<g id="edge295" class="edge">
<title>residual_l4&#45;&gt;ln2_l4</title>
<path fill="none" stroke="black" d="M8597.91,-623C8776.34,-623 9328.33,-623 9328.33,-623 9328.33,-623 9328.33,-197.77 9328.33,-197.77"/>
<polygon fill="black" stroke="black" points="9331.83,-197.77 9328.33,-187.77 9324.83,-197.77 9331.83,-197.77"/>
</g>
</g>
</svg>
