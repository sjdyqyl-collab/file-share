<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: helix_moe_transformer Pages: 1 -->
<svg width="1800pt" height="316pt"
 viewBox="0.00 0.00 1800.00 315.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 2454)">
<title>helix_moe_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2454 14019.13,-2454 14019.13,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="yellow" stroke="black" points="1084.04,-2262.5 931.04,-2262.5 931.04,-2209.5 1084.04,-2209.5 1084.04,-2262.5"/>
<text text-anchor="middle" x="1007.54" y="-2247.3" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1007.54" y="-2232.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1007.54" y="-2217.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_concat_heads -->
<g id="node2" class="node">
<title>layer1_concat_heads</title>
<polygon fill="orange" stroke="black" points="1988.54,-2131 1824.54,-2078 1988.54,-2025 2152.54,-2078 1988.54,-2131"/>
<text text-anchor="middle" x="1988.54" y="-2089.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="1988.54" y="-2074.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="1988.54" y="-2059.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;layer1_concat_heads -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M1032.56,-2209.26C1048.54,-2194.54 1070.52,-2177.21 1093.54,-2168 1223.74,-2115.92 1611.82,-2093.11 1831.82,-2084.13"/>
<polygon fill="black" stroke="black" points="1831.99,-2087.63 1841.84,-2083.73 1831.71,-2080.63 1831.99,-2087.63"/>
</g>
<!-- layer1_router -->
<g id="node39" class="node">
<title>layer1_router</title>
<polygon fill="lightpink" stroke="black" points="2091.54,-1944.5 2040.04,-1988 1937.04,-1988 1885.54,-1944.5 1937.04,-1901 2040.04,-1901 2091.54,-1944.5"/>
<text text-anchor="middle" x="1988.54" y="-1955.8" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="1988.54" y="-1940.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8]</text>
<text text-anchor="middle" x="1988.54" y="-1925.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_router -->
<g id="edge38" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_router</title>
<path fill="none" stroke="black" d="M1988.54,-2024.65C1988.54,-2016.1 1988.54,-2007.22 1988.54,-1998.65"/>
<polygon fill="black" stroke="black" points="1992.04,-1998.38 1988.54,-1988.38 1985.04,-1998.38 1992.04,-1998.38"/>
</g>
<!-- layer1_qkv_hg0_ds0 -->
<g id="node3" class="node">
<title>layer1_qkv_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="718.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="718.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg0_ds0</text>
</g>
<!-- layer1_attn_hg0_ds0 -->
<g id="node4" class="node">
<title>layer1_attn_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="718.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="718.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg0_ds0</text>
</g>
<!-- layer1_qkv_hg0_ds0&#45;&gt;layer1_attn_hg0_ds0 -->
<g id="edge2" class="edge">
<title>layer1_qkv_hg0_ds0&#45;&gt;layer1_attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M718.54,-2413.81C718.54,-2405.79 718.54,-2396.05 718.54,-2387.07"/>
<polygon fill="black" stroke="black" points="722.04,-2387.03 718.54,-2377.03 715.04,-2387.03 722.04,-2387.03"/>
</g>
<!-- layer1_concat_dim_hg0 -->
<g id="node5" class="node">
<title>layer1_concat_dim_hg0</title>
<polygon fill="lightgreen" stroke="black" points="1295.54,-2304 1102.54,-2236 1295.54,-2168 1488.54,-2236 1295.54,-2304"/>
<text text-anchor="middle" x="1295.54" y="-2254.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="1295.54" y="-2239.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="1295.54" y="-2224.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="1295.54" y="-2209.8" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- layer1_attn_hg0_ds0&#45;&gt;layer1_concat_dim_hg0 -->
<g id="edge3" class="edge">
<title>layer1_attn_hg0_ds0&#45;&gt;layer1_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M795.86,-2346.52C808.45,-2344.66 821.36,-2342.77 833.54,-2341 948.61,-2324.28 979.33,-2330.55 1092.54,-2304 1125.7,-2296.23 1161.16,-2285.42 1193.02,-2274.75"/>
<polygon fill="black" stroke="black" points="1194.44,-2277.96 1202.79,-2271.44 1192.2,-2271.33 1194.44,-2277.96"/>
</g>
<!-- layer1_concat_dim_hg0&#45;&gt;layer1_concat_heads -->
<g id="edge34" class="edge">
<title>layer1_concat_dim_hg0&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M1411.92,-2208.8C1543.68,-2179.14 1756.44,-2131.25 1883.37,-2102.67"/>
<polygon fill="black" stroke="black" points="1884.5,-2106.01 1893.49,-2100.4 1882.97,-2099.18 1884.5,-2106.01"/>
</g>
<!-- layer1_qkv_hg0_ds1 -->
<g id="node6" class="node">
<title>layer1_qkv_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="949.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="949.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg0_ds1</text>
</g>
<!-- layer1_attn_hg0_ds1 -->
<g id="node7" class="node">
<title>layer1_attn_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="949.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="949.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg0_ds1</text>
</g>
<!-- layer1_qkv_hg0_ds1&#45;&gt;layer1_attn_hg0_ds1 -->
<g id="edge4" class="edge">
<title>layer1_qkv_hg0_ds1&#45;&gt;layer1_attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M949.54,-2413.81C949.54,-2405.79 949.54,-2396.05 949.54,-2387.07"/>
<polygon fill="black" stroke="black" points="953.04,-2387.03 949.54,-2377.03 946.04,-2387.03 953.04,-2387.03"/>
</g>
<!-- layer1_attn_hg0_ds1&#45;&gt;layer1_concat_dim_hg0 -->
<g id="edge5" class="edge">
<title>layer1_attn_hg0_ds1&#45;&gt;layer1_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M993.71,-2342.55C1043.03,-2325.31 1124.56,-2296.79 1190.46,-2273.75"/>
<polygon fill="black" stroke="black" points="1191.78,-2276.99 1200.07,-2270.39 1189.47,-2270.39 1191.78,-2276.99"/>
</g>
<!-- layer1_qkv_hg0_ds2 -->
<g id="node8" class="node">
<title>layer1_qkv_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="1180.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="1180.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg0_ds2</text>
</g>
<!-- layer1_attn_hg0_ds2 -->
<g id="node9" class="node">
<title>layer1_attn_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="1180.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="1180.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg0_ds2</text>
</g>
<!-- layer1_qkv_hg0_ds2&#45;&gt;layer1_attn_hg0_ds2 -->
<g id="edge6" class="edge">
<title>layer1_qkv_hg0_ds2&#45;&gt;layer1_attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M1180.54,-2413.81C1180.54,-2405.79 1180.54,-2396.05 1180.54,-2387.07"/>
<polygon fill="black" stroke="black" points="1184.04,-2387.03 1180.54,-2377.03 1177.04,-2387.03 1184.04,-2387.03"/>
</g>
<!-- layer1_attn_hg0_ds2&#45;&gt;layer1_concat_dim_hg0 -->
<g id="edge7" class="edge">
<title>layer1_attn_hg0_ds2&#45;&gt;layer1_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M1196.53,-2341.18C1208.14,-2328.96 1224.59,-2311.66 1240.75,-2294.65"/>
<polygon fill="black" stroke="black" points="1243.29,-2297.06 1247.64,-2287.4 1238.21,-2292.24 1243.29,-2297.06"/>
</g>
<!-- layer1_qkv_hg0_ds3 -->
<g id="node10" class="node">
<title>layer1_qkv_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="1411.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="1411.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg0_ds3</text>
</g>
<!-- layer1_attn_hg0_ds3 -->
<g id="node11" class="node">
<title>layer1_attn_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="1411.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="1411.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg0_ds3</text>
</g>
<!-- layer1_qkv_hg0_ds3&#45;&gt;layer1_attn_hg0_ds3 -->
<g id="edge8" class="edge">
<title>layer1_qkv_hg0_ds3&#45;&gt;layer1_attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M1411.54,-2413.81C1411.54,-2405.79 1411.54,-2396.05 1411.54,-2387.07"/>
<polygon fill="black" stroke="black" points="1415.04,-2387.03 1411.54,-2377.03 1408.04,-2387.03 1415.04,-2387.03"/>
</g>
<!-- layer1_attn_hg0_ds3&#45;&gt;layer1_concat_dim_hg0 -->
<g id="edge9" class="edge">
<title>layer1_attn_hg0_ds3&#45;&gt;layer1_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M1395.41,-2341.18C1383.65,-2328.9 1366.96,-2311.49 1350.58,-2294.42"/>
<polygon fill="black" stroke="black" points="1353.05,-2291.93 1343.6,-2287.13 1348,-2296.77 1353.05,-2291.93"/>
</g>
<!-- layer1_qkv_hg1_ds0 -->
<g id="node12" class="node">
<title>layer1_qkv_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="1642.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="1642.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg1_ds0</text>
</g>
<!-- layer1_attn_hg1_ds0 -->
<g id="node13" class="node">
<title>layer1_attn_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="1642.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="1642.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg1_ds0</text>
</g>
<!-- layer1_qkv_hg1_ds0&#45;&gt;layer1_attn_hg1_ds0 -->
<g id="edge10" class="edge">
<title>layer1_qkv_hg1_ds0&#45;&gt;layer1_attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M1642.54,-2413.81C1642.54,-2405.79 1642.54,-2396.05 1642.54,-2387.07"/>
<polygon fill="black" stroke="black" points="1646.04,-2387.03 1642.54,-2377.03 1639.04,-2387.03 1646.04,-2387.03"/>
</g>
<!-- layer1_concat_dim_hg1 -->
<g id="node14" class="node">
<title>layer1_concat_dim_hg1</title>
<polygon fill="lightgreen" stroke="black" points="1988.54,-2304 1795.54,-2236 1988.54,-2168 2181.54,-2236 1988.54,-2304"/>
<text text-anchor="middle" x="1988.54" y="-2254.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="1988.54" y="-2239.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1988.54" y="-2224.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="1988.54" y="-2209.8" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- layer1_attn_hg1_ds0&#45;&gt;layer1_concat_dim_hg1 -->
<g id="edge11" class="edge">
<title>layer1_attn_hg1_ds0&#45;&gt;layer1_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M1686.71,-2342.55C1736.03,-2325.31 1817.56,-2296.79 1883.46,-2273.75"/>
<polygon fill="black" stroke="black" points="1884.78,-2276.99 1893.07,-2270.39 1882.47,-2270.39 1884.78,-2276.99"/>
</g>
<!-- layer1_concat_dim_hg1&#45;&gt;layer1_concat_heads -->
<g id="edge35" class="edge">
<title>layer1_concat_dim_hg1&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M1988.54,-2167.94C1988.54,-2159.15 1988.54,-2150.18 1988.54,-2141.47"/>
<polygon fill="black" stroke="black" points="1992.04,-2141.41 1988.54,-2131.41 1985.04,-2141.41 1992.04,-2141.41"/>
</g>
<!-- layer1_qkv_hg1_ds1 -->
<g id="node15" class="node">
<title>layer1_qkv_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="1873.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="1873.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg1_ds1</text>
</g>
<!-- layer1_attn_hg1_ds1 -->
<g id="node16" class="node">
<title>layer1_attn_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="1873.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="1873.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg1_ds1</text>
</g>
<!-- layer1_qkv_hg1_ds1&#45;&gt;layer1_attn_hg1_ds1 -->
<g id="edge12" class="edge">
<title>layer1_qkv_hg1_ds1&#45;&gt;layer1_attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M1873.54,-2413.81C1873.54,-2405.79 1873.54,-2396.05 1873.54,-2387.07"/>
<polygon fill="black" stroke="black" points="1877.04,-2387.03 1873.54,-2377.03 1870.04,-2387.03 1877.04,-2387.03"/>
</g>
<!-- layer1_attn_hg1_ds1&#45;&gt;layer1_concat_dim_hg1 -->
<g id="edge13" class="edge">
<title>layer1_attn_hg1_ds1&#45;&gt;layer1_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M1889.53,-2341.18C1901.14,-2328.96 1917.59,-2311.66 1933.75,-2294.65"/>
<polygon fill="black" stroke="black" points="1936.29,-2297.06 1940.64,-2287.4 1931.21,-2292.24 1936.29,-2297.06"/>
</g>
<!-- layer1_qkv_hg1_ds2 -->
<g id="node17" class="node">
<title>layer1_qkv_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="2104.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="2104.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg1_ds2</text>
</g>
<!-- layer1_attn_hg1_ds2 -->
<g id="node18" class="node">
<title>layer1_attn_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="2104.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="2104.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg1_ds2</text>
</g>
<!-- layer1_qkv_hg1_ds2&#45;&gt;layer1_attn_hg1_ds2 -->
<g id="edge14" class="edge">
<title>layer1_qkv_hg1_ds2&#45;&gt;layer1_attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M2104.54,-2413.81C2104.54,-2405.79 2104.54,-2396.05 2104.54,-2387.07"/>
<polygon fill="black" stroke="black" points="2108.04,-2387.03 2104.54,-2377.03 2101.04,-2387.03 2108.04,-2387.03"/>
</g>
<!-- layer1_attn_hg1_ds2&#45;&gt;layer1_concat_dim_hg1 -->
<g id="edge15" class="edge">
<title>layer1_attn_hg1_ds2&#45;&gt;layer1_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M2088.41,-2341.18C2076.65,-2328.9 2059.96,-2311.49 2043.58,-2294.42"/>
<polygon fill="black" stroke="black" points="2046.05,-2291.93 2036.6,-2287.13 2041,-2296.77 2046.05,-2291.93"/>
</g>
<!-- layer1_qkv_hg1_ds3 -->
<g id="node19" class="node">
<title>layer1_qkv_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="2335.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="2335.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg1_ds3</text>
</g>
<!-- layer1_attn_hg1_ds3 -->
<g id="node20" class="node">
<title>layer1_attn_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="2335.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="2335.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg1_ds3</text>
</g>
<!-- layer1_qkv_hg1_ds3&#45;&gt;layer1_attn_hg1_ds3 -->
<g id="edge16" class="edge">
<title>layer1_qkv_hg1_ds3&#45;&gt;layer1_attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M2335.54,-2413.81C2335.54,-2405.79 2335.54,-2396.05 2335.54,-2387.07"/>
<polygon fill="black" stroke="black" points="2339.04,-2387.03 2335.54,-2377.03 2332.04,-2387.03 2339.04,-2387.03"/>
</g>
<!-- layer1_attn_hg1_ds3&#45;&gt;layer1_concat_dim_hg1 -->
<g id="edge17" class="edge">
<title>layer1_attn_hg1_ds3&#45;&gt;layer1_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M2291.24,-2342.55C2241.78,-2325.31 2160.01,-2296.79 2093.92,-2273.75"/>
<polygon fill="black" stroke="black" points="2094.88,-2270.38 2084.29,-2270.39 2092.58,-2276.99 2094.88,-2270.38"/>
</g>
<!-- layer1_qkv_hg2_ds0 -->
<g id="node21" class="node">
<title>layer1_qkv_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="2566.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="2566.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg2_ds0</text>
</g>
<!-- layer1_attn_hg2_ds0 -->
<g id="node22" class="node">
<title>layer1_attn_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="2566.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="2566.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg2_ds0</text>
</g>
<!-- layer1_qkv_hg2_ds0&#45;&gt;layer1_attn_hg2_ds0 -->
<g id="edge18" class="edge">
<title>layer1_qkv_hg2_ds0&#45;&gt;layer1_attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M2566.54,-2413.81C2566.54,-2405.79 2566.54,-2396.05 2566.54,-2387.07"/>
<polygon fill="black" stroke="black" points="2570.04,-2387.03 2566.54,-2377.03 2563.04,-2387.03 2570.04,-2387.03"/>
</g>
<!-- layer1_concat_dim_hg2 -->
<g id="node23" class="node">
<title>layer1_concat_dim_hg2</title>
<polygon fill="lightgreen" stroke="black" points="2797.54,-2304 2604.54,-2236 2797.54,-2168 2990.54,-2236 2797.54,-2304"/>
<text text-anchor="middle" x="2797.54" y="-2254.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="2797.54" y="-2239.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="2797.54" y="-2224.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="2797.54" y="-2209.8" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- layer1_attn_hg2_ds0&#45;&gt;layer1_concat_dim_hg2 -->
<g id="edge19" class="edge">
<title>layer1_attn_hg2_ds0&#45;&gt;layer1_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M2597.69,-2341.68C2626.89,-2326.39 2671.89,-2302.81 2711.81,-2281.91"/>
<polygon fill="black" stroke="black" points="2713.53,-2284.95 2720.77,-2277.21 2710.29,-2278.75 2713.53,-2284.95"/>
</g>
<!-- layer1_concat_dim_hg2&#45;&gt;layer1_concat_heads -->
<g id="edge36" class="edge">
<title>layer1_concat_dim_hg2&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M2674.23,-2211.22C2517.71,-2181.04 2250,-2129.42 2099.57,-2100.41"/>
<polygon fill="black" stroke="black" points="2099.87,-2096.9 2089.39,-2098.45 2098.54,-2103.78 2099.87,-2096.9"/>
</g>
<!-- layer1_qkv_hg2_ds1 -->
<g id="node24" class="node">
<title>layer1_qkv_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="2797.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="2797.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg2_ds1</text>
</g>
<!-- layer1_attn_hg2_ds1 -->
<g id="node25" class="node">
<title>layer1_attn_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="2797.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="2797.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg2_ds1</text>
</g>
<!-- layer1_qkv_hg2_ds1&#45;&gt;layer1_attn_hg2_ds1 -->
<g id="edge20" class="edge">
<title>layer1_qkv_hg2_ds1&#45;&gt;layer1_attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M2797.54,-2413.81C2797.54,-2405.79 2797.54,-2396.05 2797.54,-2387.07"/>
<polygon fill="black" stroke="black" points="2801.04,-2387.03 2797.54,-2377.03 2794.04,-2387.03 2801.04,-2387.03"/>
</g>
<!-- layer1_attn_hg2_ds1&#45;&gt;layer1_concat_dim_hg2 -->
<g id="edge21" class="edge">
<title>layer1_attn_hg2_ds1&#45;&gt;layer1_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M2797.54,-2340.92C2797.54,-2333.49 2797.54,-2324.22 2797.54,-2314.3"/>
<polygon fill="black" stroke="black" points="2801.04,-2314.2 2797.54,-2304.2 2794.04,-2314.2 2801.04,-2314.2"/>
</g>
<!-- layer1_qkv_hg2_ds2 -->
<g id="node26" class="node">
<title>layer1_qkv_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="3028.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="3028.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg2_ds2</text>
</g>
<!-- layer1_attn_hg2_ds2 -->
<g id="node27" class="node">
<title>layer1_attn_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="3028.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3028.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg2_ds2</text>
</g>
<!-- layer1_qkv_hg2_ds2&#45;&gt;layer1_attn_hg2_ds2 -->
<g id="edge22" class="edge">
<title>layer1_qkv_hg2_ds2&#45;&gt;layer1_attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M3028.54,-2413.81C3028.54,-2405.79 3028.54,-2396.05 3028.54,-2387.07"/>
<polygon fill="black" stroke="black" points="3032.04,-2387.03 3028.54,-2377.03 3025.04,-2387.03 3032.04,-2387.03"/>
</g>
<!-- layer1_attn_hg2_ds2&#45;&gt;layer1_concat_dim_hg2 -->
<g id="edge23" class="edge">
<title>layer1_attn_hg2_ds2&#45;&gt;layer1_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M2997.39,-2341.68C2968.19,-2326.39 2923.19,-2302.81 2883.27,-2281.91"/>
<polygon fill="black" stroke="black" points="2884.79,-2278.75 2874.31,-2277.21 2881.55,-2284.95 2884.79,-2278.75"/>
</g>
<!-- layer1_qkv_hg2_ds3 -->
<g id="node28" class="node">
<title>layer1_qkv_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="3259.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="3259.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg2_ds3</text>
</g>
<!-- layer1_attn_hg2_ds3 -->
<g id="node29" class="node">
<title>layer1_attn_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="3259.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3259.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg2_ds3</text>
</g>
<!-- layer1_qkv_hg2_ds3&#45;&gt;layer1_attn_hg2_ds3 -->
<g id="edge24" class="edge">
<title>layer1_qkv_hg2_ds3&#45;&gt;layer1_attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M3259.54,-2413.81C3259.54,-2405.79 3259.54,-2396.05 3259.54,-2387.07"/>
<polygon fill="black" stroke="black" points="3263.04,-2387.03 3259.54,-2377.03 3256.04,-2387.03 3263.04,-2387.03"/>
</g>
<!-- layer1_attn_hg2_ds3&#45;&gt;layer1_concat_dim_hg2 -->
<g id="edge25" class="edge">
<title>layer1_attn_hg2_ds3&#45;&gt;layer1_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M3204.27,-2343.52C3133.6,-2325.02 3009.31,-2292.46 2916.66,-2268.2"/>
<polygon fill="black" stroke="black" points="2917.51,-2264.8 2906.95,-2265.65 2915.74,-2271.57 2917.51,-2264.8"/>
</g>
<!-- layer1_qkv_hg3_ds0 -->
<g id="node30" class="node">
<title>layer1_qkv_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="3490.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="3490.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg3_ds0</text>
</g>
<!-- layer1_attn_hg3_ds0 -->
<g id="node31" class="node">
<title>layer1_attn_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="3490.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3490.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg3_ds0</text>
</g>
<!-- layer1_qkv_hg3_ds0&#45;&gt;layer1_attn_hg3_ds0 -->
<g id="edge26" class="edge">
<title>layer1_qkv_hg3_ds0&#45;&gt;layer1_attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M3490.54,-2413.81C3490.54,-2405.79 3490.54,-2396.05 3490.54,-2387.07"/>
<polygon fill="black" stroke="black" points="3494.04,-2387.03 3490.54,-2377.03 3487.04,-2387.03 3494.04,-2387.03"/>
</g>
<!-- layer1_concat_dim_hg3 -->
<g id="node32" class="node">
<title>layer1_concat_dim_hg3</title>
<polygon fill="lightgreen" stroke="black" points="3721.54,-2304 3528.54,-2236 3721.54,-2168 3914.54,-2236 3721.54,-2304"/>
<text text-anchor="middle" x="3721.54" y="-2254.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="3721.54" y="-2239.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="3721.54" y="-2224.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="3721.54" y="-2209.8" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- layer1_attn_hg3_ds0&#45;&gt;layer1_concat_dim_hg3 -->
<g id="edge27" class="edge">
<title>layer1_attn_hg3_ds0&#45;&gt;layer1_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M3521.69,-2341.68C3550.89,-2326.39 3595.89,-2302.81 3635.81,-2281.91"/>
<polygon fill="black" stroke="black" points="3637.53,-2284.95 3644.77,-2277.21 3634.29,-2278.75 3637.53,-2284.95"/>
</g>
<!-- layer1_concat_dim_hg3&#45;&gt;layer1_concat_heads -->
<g id="edge37" class="edge">
<title>layer1_concat_dim_hg3&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M3571.18,-2220.84C3425.14,-2207.13 3197.16,-2185.87 2999.54,-2168 2687.13,-2139.75 2320.3,-2107.75 2125.82,-2090.88"/>
<polygon fill="black" stroke="black" points="2126.1,-2087.39 2115.84,-2090.01 2125.5,-2094.36 2126.1,-2087.39"/>
</g>
<!-- layer1_qkv_hg3_ds1 -->
<g id="node33" class="node">
<title>layer1_qkv_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="3721.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="3721.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg3_ds1</text>
</g>
<!-- layer1_attn_hg3_ds1 -->
<g id="node34" class="node">
<title>layer1_attn_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="3721.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3721.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg3_ds1</text>
</g>
<!-- layer1_qkv_hg3_ds1&#45;&gt;layer1_attn_hg3_ds1 -->
<g id="edge28" class="edge">
<title>layer1_qkv_hg3_ds1&#45;&gt;layer1_attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M3721.54,-2413.81C3721.54,-2405.79 3721.54,-2396.05 3721.54,-2387.07"/>
<polygon fill="black" stroke="black" points="3725.04,-2387.03 3721.54,-2377.03 3718.04,-2387.03 3725.04,-2387.03"/>
</g>
<!-- layer1_attn_hg3_ds1&#45;&gt;layer1_concat_dim_hg3 -->
<g id="edge29" class="edge">
<title>layer1_attn_hg3_ds1&#45;&gt;layer1_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M3721.54,-2340.92C3721.54,-2333.49 3721.54,-2324.22 3721.54,-2314.3"/>
<polygon fill="black" stroke="black" points="3725.04,-2314.2 3721.54,-2304.2 3718.04,-2314.2 3725.04,-2314.2"/>
</g>
<!-- layer1_qkv_hg3_ds2 -->
<g id="node35" class="node">
<title>layer1_qkv_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="3952.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="3952.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg3_ds2</text>
</g>
<!-- layer1_attn_hg3_ds2 -->
<g id="node36" class="node">
<title>layer1_attn_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="3952.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3952.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg3_ds2</text>
</g>
<!-- layer1_qkv_hg3_ds2&#45;&gt;layer1_attn_hg3_ds2 -->
<g id="edge30" class="edge">
<title>layer1_qkv_hg3_ds2&#45;&gt;layer1_attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M3952.54,-2413.81C3952.54,-2405.79 3952.54,-2396.05 3952.54,-2387.07"/>
<polygon fill="black" stroke="black" points="3956.04,-2387.03 3952.54,-2377.03 3949.04,-2387.03 3956.04,-2387.03"/>
</g>
<!-- layer1_attn_hg3_ds2&#45;&gt;layer1_concat_dim_hg3 -->
<g id="edge31" class="edge">
<title>layer1_attn_hg3_ds2&#45;&gt;layer1_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M3921.39,-2341.68C3892.19,-2326.39 3847.19,-2302.81 3807.27,-2281.91"/>
<polygon fill="black" stroke="black" points="3808.79,-2278.75 3798.31,-2277.21 3805.55,-2284.95 3808.79,-2278.75"/>
</g>
<!-- layer1_qkv_hg3_ds3 -->
<g id="node37" class="node">
<title>layer1_qkv_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="4183.54" cy="-2432" rx="104" ry="18"/>
<text text-anchor="middle" x="4183.54" y="-2428.3" font-family="Times,serif" font-size="14.00">layer1_qkv_hg3_ds3</text>
</g>
<!-- layer1_attn_hg3_ds3 -->
<g id="node38" class="node">
<title>layer1_attn_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="4183.54" cy="-2359" rx="106.68" ry="18"/>
<text text-anchor="middle" x="4183.54" y="-2355.3" font-family="Times,serif" font-size="14.00">layer1_attn_hg3_ds3</text>
</g>
<!-- layer1_qkv_hg3_ds3&#45;&gt;layer1_attn_hg3_ds3 -->
<g id="edge32" class="edge">
<title>layer1_qkv_hg3_ds3&#45;&gt;layer1_attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M4183.54,-2413.81C4183.54,-2405.79 4183.54,-2396.05 4183.54,-2387.07"/>
<polygon fill="black" stroke="black" points="4187.04,-2387.03 4183.54,-2377.03 4180.04,-2387.03 4187.04,-2387.03"/>
</g>
<!-- layer1_attn_hg3_ds3&#45;&gt;layer1_concat_dim_hg3 -->
<g id="edge33" class="edge">
<title>layer1_attn_hg3_ds3&#45;&gt;layer1_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M4128.27,-2343.52C4057.6,-2325.02 3933.31,-2292.46 3840.66,-2268.2"/>
<polygon fill="black" stroke="black" points="3841.51,-2264.8 3830.95,-2265.65 3839.74,-2271.57 3841.51,-2264.8"/>
</g>
<!-- layer1_expert0_gpu0 -->
<g id="node40" class="node">
<title>layer1_expert0_gpu0</title>
<ellipse fill="none" stroke="black" cx="108.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="108.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert0_gpu0</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert0_gpu0 -->
<g id="edge39" class="edge">
<title>layer1_router&#45;&gt;layer1_expert0_gpu0</title>
<path fill="none" stroke="black" d="M1889.33,-1941.29C1656.21,-1935.66 1055.37,-1918.65 554.54,-1883 407.96,-1872.57 371.4,-1867.9 225.54,-1850 215.84,-1848.81 205.7,-1847.47 195.61,-1846.09"/>
<polygon fill="black" stroke="black" points="195.96,-1842.6 185.57,-1844.69 194.99,-1849.53 195.96,-1842.6"/>
<text text-anchor="middle" x="586.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer1_expert0_gpu1 -->
<g id="node41" class="node">
<title>layer1_expert0_gpu1</title>
<ellipse fill="none" stroke="black" cx="343.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="343.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert0_gpu1</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert0_gpu1 -->
<g id="edge40" class="edge">
<title>layer1_router&#45;&gt;layer1_expert0_gpu1</title>
<path fill="none" stroke="black" d="M1890.46,-1940.14C1686.2,-1932.78 1200.34,-1913.44 793.54,-1883 645.23,-1871.9 608.17,-1868.03 460.54,-1850 450.84,-1848.81 440.69,-1847.48 430.61,-1846.1"/>
<polygon fill="black" stroke="black" points="430.96,-1842.61 420.57,-1844.7 429.99,-1849.55 430.96,-1842.61"/>
<text text-anchor="middle" x="825.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer1_expert1_gpu2 -->
<g id="node42" class="node">
<title>layer1_expert1_gpu2</title>
<ellipse fill="none" stroke="black" cx="578.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="578.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert1_gpu2</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert1_gpu2 -->
<g id="edge41" class="edge">
<title>layer1_router&#45;&gt;layer1_expert1_gpu2</title>
<path fill="none" stroke="black" d="M1892.52,-1938.45C1720.71,-1929.18 1349.37,-1908.07 1036.54,-1883 884.76,-1870.84 846.7,-1868.29 695.54,-1850 685.84,-1848.83 675.69,-1847.5 665.61,-1846.12"/>
<polygon fill="black" stroke="black" points="665.95,-1842.63 655.57,-1844.73 664.99,-1849.57 665.95,-1842.63"/>
<text text-anchor="middle" x="1068.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer1_expert1_gpu3 -->
<g id="node43" class="node">
<title>layer1_expert1_gpu3</title>
<ellipse fill="none" stroke="black" cx="813.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="813.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert1_gpu3</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert1_gpu3 -->
<g id="edge42" class="edge">
<title>layer1_router&#45;&gt;layer1_expert1_gpu3</title>
<path fill="none" stroke="black" d="M1893.83,-1937.33C1708.46,-1924.76 1284.9,-1893.66 930.54,-1850 920.91,-1848.81 910.86,-1847.49 900.85,-1846.11"/>
<polygon fill="black" stroke="black" points="901.27,-1842.64 890.89,-1844.72 900.31,-1849.57 901.27,-1842.64"/>
<text text-anchor="middle" x="1252.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer1_expert2_gpu4 -->
<g id="node44" class="node">
<title>layer1_expert2_gpu4</title>
<ellipse fill="none" stroke="black" cx="1048.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="1048.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert2_gpu4</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert2_gpu4 -->
<g id="edge43" class="edge">
<title>layer1_router&#45;&gt;layer1_expert2_gpu4</title>
<path fill="none" stroke="black" d="M1897.68,-1934.24C1745.86,-1918.53 1431.08,-1884.93 1165.54,-1850 1156.1,-1848.76 1146.24,-1847.41 1136.42,-1846.03"/>
<polygon fill="black" stroke="black" points="1136.62,-1842.52 1126.22,-1844.59 1135.64,-1849.45 1136.62,-1842.52"/>
<text text-anchor="middle" x="1446.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer1_expert2_gpu5 -->
<g id="node45" class="node">
<title>layer1_expert2_gpu5</title>
<ellipse fill="none" stroke="black" cx="1283.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="1283.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert2_gpu5</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert2_gpu5 -->
<g id="edge44" class="edge">
<title>layer1_router&#45;&gt;layer1_expert2_gpu5</title>
<path fill="none" stroke="black" d="M1902.45,-1930.01C1766.81,-1908.75 1504.9,-1867.69 1369.4,-1846.46"/>
<polygon fill="black" stroke="black" points="1369.89,-1842.99 1359.47,-1844.9 1368.81,-1849.91 1369.89,-1842.99"/>
<text text-anchor="middle" x="1626.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer1_expert3_gpu6 -->
<g id="node46" class="node">
<title>layer1_expert3_gpu6</title>
<ellipse fill="none" stroke="black" cx="1518.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="1518.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert3_gpu6</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert3_gpu6 -->
<g id="edge45" class="edge">
<title>layer1_router&#45;&gt;layer1_expert3_gpu6</title>
<path fill="none" stroke="black" d="M1908.81,-1924.76C1818.87,-1903.61 1674.02,-1869.55 1588.37,-1849.42"/>
<polygon fill="black" stroke="black" points="1589.02,-1845.97 1578.48,-1847.09 1587.41,-1852.79 1589.02,-1845.97"/>
<text text-anchor="middle" x="1757.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer1_expert3_gpu7 -->
<g id="node47" class="node">
<title>layer1_expert3_gpu7</title>
<ellipse fill="none" stroke="black" cx="1753.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="1753.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert3_gpu7</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert3_gpu7 -->
<g id="edge46" class="edge">
<title>layer1_router&#45;&gt;layer1_expert3_gpu7</title>
<path fill="none" stroke="black" d="M1923.08,-1912.72C1882.81,-1893.79 1832.32,-1870.05 1796.96,-1853.42"/>
<polygon fill="black" stroke="black" points="1798.4,-1850.22 1787.86,-1849.14 1795.42,-1856.56 1798.4,-1850.22"/>
<text text-anchor="middle" x="1889.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer1_expert4_gpu8 -->
<g id="node48" class="node">
<title>layer1_expert4_gpu8</title>
<ellipse fill="none" stroke="black" cx="1988.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="1988.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert4_gpu8</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert4_gpu8 -->
<g id="edge47" class="edge">
<title>layer1_router&#45;&gt;layer1_expert4_gpu8</title>
<path fill="none" stroke="black" d="M1988.54,-1900.78C1988.54,-1887.16 1988.54,-1872.46 1988.54,-1860.25"/>
<polygon fill="black" stroke="black" points="1992.04,-1860.24 1988.54,-1850.24 1985.04,-1860.24 1992.04,-1860.24"/>
<text text-anchor="middle" x="2020.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer1_expert4_gpu9 -->
<g id="node49" class="node">
<title>layer1_expert4_gpu9</title>
<ellipse fill="none" stroke="black" cx="2223.54" cy="-1832" rx="108.58" ry="18"/>
<text text-anchor="middle" x="2223.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert4_gpu9</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert4_gpu9 -->
<g id="edge48" class="edge">
<title>layer1_router&#45;&gt;layer1_expert4_gpu9</title>
<path fill="none" stroke="black" d="M2054,-1912.72C2094.27,-1893.79 2144.76,-1870.05 2180.12,-1853.42"/>
<polygon fill="black" stroke="black" points="2181.66,-1856.56 2189.22,-1849.14 2178.68,-1850.22 2181.66,-1856.56"/>
<text text-anchor="middle" x="2179.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer1_expert5_gpu10 -->
<g id="node50" class="node">
<title>layer1_expert5_gpu10</title>
<ellipse fill="none" stroke="black" cx="2464.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="2464.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert5_gpu10</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert5_gpu10 -->
<g id="edge49" class="edge">
<title>layer1_router&#45;&gt;layer1_expert5_gpu10</title>
<path fill="none" stroke="black" d="M2068.48,-1924.94C2159.38,-1903.84 2306.42,-1869.71 2393.47,-1849.5"/>
<polygon fill="black" stroke="black" points="2394.31,-1852.9 2403.26,-1847.23 2392.72,-1846.08 2394.31,-1852.9"/>
<text text-anchor="middle" x="2343.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer1_expert5_gpu11 -->
<g id="node51" class="node">
<title>layer1_expert5_gpu11</title>
<ellipse fill="none" stroke="black" cx="2711.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="2711.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert5_gpu11</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert5_gpu11 -->
<g id="edge50" class="edge">
<title>layer1_router&#45;&gt;layer1_expert5_gpu11</title>
<path fill="none" stroke="black" d="M2075.03,-1930.28C2213.26,-1909.16 2482.57,-1868 2622.43,-1846.62"/>
<polygon fill="black" stroke="black" points="2623.32,-1850.02 2632.68,-1845.05 2622.27,-1843.1 2623.32,-1850.02"/>
<text text-anchor="middle" x="2510.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer1_expert6_gpu12 -->
<g id="node52" class="node">
<title>layer1_expert6_gpu12</title>
<ellipse fill="none" stroke="black" cx="2958.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="2958.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert6_gpu12</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert6_gpu12 -->
<g id="edge51" class="edge">
<title>layer1_router&#45;&gt;layer1_expert6_gpu12</title>
<path fill="none" stroke="black" d="M2079.72,-1934.32C2234.9,-1918.5 2560.18,-1884.47 2834.54,-1850 2844.75,-1848.72 2855.43,-1847.33 2866.05,-1845.91"/>
<polygon fill="black" stroke="black" points="2866.75,-1849.35 2876.2,-1844.55 2865.82,-1842.41 2866.75,-1849.35"/>
<text text-anchor="middle" x="2705.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer1_expert6_gpu13 -->
<g id="node53" class="node">
<title>layer1_expert6_gpu13</title>
<ellipse fill="none" stroke="black" cx="3205.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="3205.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert6_gpu13</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert6_gpu13 -->
<g id="edge52" class="edge">
<title>layer1_router&#45;&gt;layer1_expert6_gpu13</title>
<path fill="none" stroke="black" d="M2083.4,-1937.37C2273.27,-1924.68 2713.38,-1893.03 3081.54,-1850 3092.03,-1848.77 3103.01,-1847.4 3113.92,-1845.98"/>
<polygon fill="black" stroke="black" points="3114.43,-1849.44 3123.89,-1844.66 3113.52,-1842.5 3114.43,-1849.44"/>
<text text-anchor="middle" x="2935.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer1_expert7_gpu14 -->
<g id="node54" class="node">
<title>layer1_expert7_gpu14</title>
<ellipse fill="none" stroke="black" cx="3452.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="3452.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert7_gpu14</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert7_gpu14 -->
<g id="edge53" class="edge">
<title>layer1_router&#45;&gt;layer1_expert7_gpu14</title>
<path fill="none" stroke="black" d="M2084.78,-1938.54C2260.74,-1929.26 2646.11,-1907.94 2970.54,-1883 3129.86,-1870.75 3169.79,-1868.19 3328.54,-1850 3339.04,-1848.8 3350.02,-1847.44 3360.92,-1846.03"/>
<polygon fill="black" stroke="black" points="3361.44,-1849.49 3370.9,-1844.72 3360.53,-1842.55 3361.44,-1849.49"/>
<text text-anchor="middle" x="3188.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer1_expert7_gpu15 -->
<g id="node55" class="node">
<title>layer1_expert7_gpu15</title>
<ellipse fill="none" stroke="black" cx="3699.54" cy="-1832" rx="114.5" ry="18"/>
<text text-anchor="middle" x="3699.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer1_expert7_gpu15</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert7_gpu15 -->
<g id="edge54" class="edge">
<title>layer1_router&#45;&gt;layer1_expert7_gpu15</title>
<path fill="none" stroke="black" d="M2086.69,-1940.18C2295.85,-1932.77 2800.92,-1913.15 3223.54,-1883 3380.27,-1871.82 3419.45,-1868.01 3575.54,-1850 3586.03,-1848.79 3597.02,-1847.43 3607.92,-1846.01"/>
<polygon fill="black" stroke="black" points="3608.44,-1849.47 3617.89,-1844.7 3607.52,-1842.53 3608.44,-1849.47"/>
<text text-anchor="middle" x="3438.04" y="-1871.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer1_expert_concat -->
<g id="node56" class="node">
<title>layer1_expert_concat</title>
<polygon fill="lightyellow" stroke="black" points="2159.54,-1762 2001.54,-1709 2159.54,-1656 2317.54,-1709 2159.54,-1762"/>
<text text-anchor="middle" x="2159.54" y="-1720.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2159.54" y="-1705.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="2159.54" y="-1690.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_concat -->
<g id="edge55" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2089.04,-1942.25C2464.13,-1937.07 3763.82,-1914.53 3822.54,-1850 3833.31,-1838.17 3833.5,-1825.66 3822.54,-1814 3771.31,-1759.47 2716.59,-1725.15 2313.92,-1713.99"/>
<polygon fill="black" stroke="black" points="2313.75,-1710.49 2303.66,-1713.71 2313.56,-1717.48 2313.75,-1710.49"/>
</g>
<!-- layer1_expert0_gpu0&#45;&gt;layer1_expert_concat -->
<g id="edge56" class="edge">
<title>layer1_expert0_gpu0&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M183.94,-1819.02C197.75,-1817.12 212.06,-1815.34 225.54,-1814 884.99,-1748.5 1675.32,-1722.21 2004.17,-1713.58"/>
<polygon fill="black" stroke="black" points="2004.33,-1717.08 2014.24,-1713.32 2004.15,-1710.08 2004.33,-1717.08"/>
</g>
<!-- layer1_expert0_gpu1&#45;&gt;layer1_expert_concat -->
<g id="edge57" class="edge">
<title>layer1_expert0_gpu1&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M419.27,-1819.06C432.98,-1817.16 447.17,-1815.38 460.54,-1814 1029.95,-1755.31 1710.39,-1725.89 2007.83,-1715.05"/>
<polygon fill="black" stroke="black" points="2008.38,-1718.53 2018.25,-1714.67 2008.13,-1711.54 2008.38,-1718.53"/>
</g>
<!-- layer1_expert1_gpu2&#45;&gt;layer1_expert_concat -->
<g id="edge58" class="edge">
<title>layer1_expert1_gpu2&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M654.59,-1819.12C668.2,-1817.23 682.28,-1815.43 695.54,-1814 1176.55,-1762.04 1749.38,-1729.95 2013.23,-1716.83"/>
<polygon fill="black" stroke="black" points="2013.44,-1720.33 2023.26,-1716.34 2013.1,-1713.33 2013.44,-1720.33"/>
</g>
<!-- layer1_expert1_gpu3&#45;&gt;layer1_expert_concat -->
<g id="edge59" class="edge">
<title>layer1_expert1_gpu3&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M890.24,-1819.19C903.65,-1817.31 917.49,-1815.5 930.54,-1814 1324.09,-1768.8 1790.66,-1734.61 2019.19,-1719.13"/>
<polygon fill="black" stroke="black" points="2019.48,-1722.62 2029.22,-1718.45 2019.01,-1715.64 2019.48,-1722.62"/>
</g>
<!-- layer1_expert2_gpu4&#45;&gt;layer1_expert_concat -->
<g id="edge60" class="edge">
<title>layer1_expert2_gpu4&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M1125.89,-1819.31C1139.11,-1817.45 1152.71,-1815.6 1165.54,-1814 1473.81,-1775.49 1837.1,-1739.98 2027.65,-1722.1"/>
<polygon fill="black" stroke="black" points="2028.08,-1725.58 2037.71,-1721.16 2027.43,-1718.61 2028.08,-1725.58"/>
</g>
<!-- layer1_expert2_gpu5&#45;&gt;layer1_expert_concat -->
<g id="edge61" class="edge">
<title>layer1_expert2_gpu5&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M1361.88,-1819.53C1374.79,-1817.66 1388.04,-1815.76 1400.54,-1814 1625.67,-1782.22 1888.58,-1746.51 2038.42,-1726.29"/>
<polygon fill="black" stroke="black" points="2039.13,-1729.72 2048.57,-1724.92 2038.19,-1722.79 2039.13,-1729.72"/>
</g>
<!-- layer1_expert3_gpu6&#45;&gt;layer1_expert_concat -->
<g id="edge62" class="edge">
<title>layer1_expert3_gpu6&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M1587.44,-1817.99C1698.37,-1797.05 1917.49,-1755.69 2050.02,-1730.67"/>
<polygon fill="black" stroke="black" points="2051.02,-1734.05 2060.2,-1728.75 2049.72,-1727.17 2051.02,-1734.05"/>
</g>
<!-- layer1_expert3_gpu7&#45;&gt;layer1_expert_concat -->
<g id="edge63" class="edge">
<title>layer1_expert3_gpu7&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M1804.14,-1815.92C1869.91,-1796.32 1985.99,-1761.72 2067.55,-1737.42"/>
<polygon fill="black" stroke="black" points="2068.73,-1740.72 2077.32,-1734.51 2066.73,-1734.01 2068.73,-1740.72"/>
</g>
<!-- layer1_expert4_gpu8&#45;&gt;layer1_expert_concat -->
<g id="edge64" class="edge">
<title>layer1_expert4_gpu8&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M2012.32,-1814.18C2035.22,-1797.97 2070.77,-1772.82 2101.2,-1751.28"/>
<polygon fill="black" stroke="black" points="2103.49,-1753.95 2109.63,-1745.32 2099.44,-1748.24 2103.49,-1753.95"/>
</g>
<!-- layer1_expert4_gpu9&#45;&gt;layer1_expert_concat -->
<g id="edge65" class="edge">
<title>layer1_expert4_gpu9&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M2214.51,-1813.92C2207.49,-1800.65 2197.36,-1781.5 2187.7,-1763.23"/>
<polygon fill="black" stroke="black" points="2190.78,-1761.58 2183.01,-1754.37 2184.59,-1764.85 2190.78,-1761.58"/>
</g>
<!-- layer1_expert5_gpu10&#45;&gt;layer1_expert_concat -->
<g id="edge66" class="edge">
<title>layer1_expert5_gpu10&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M2424.35,-1815.06C2377.68,-1796.54 2299.5,-1765.52 2240.15,-1741.98"/>
<polygon fill="black" stroke="black" points="2241.38,-1738.7 2230.8,-1738.27 2238.8,-1745.21 2241.38,-1738.7"/>
</g>
<!-- layer1_expert5_gpu11&#45;&gt;layer1_expert_concat -->
<g id="edge67" class="edge">
<title>layer1_expert5_gpu11&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M2647.68,-1817C2553.6,-1796.38 2376.72,-1757.61 2263.7,-1732.83"/>
<polygon fill="black" stroke="black" points="2264.16,-1729.35 2253.64,-1730.63 2262.66,-1736.19 2264.16,-1729.35"/>
</g>
<!-- layer1_expert6_gpu12&#45;&gt;layer1_expert_concat -->
<g id="edge68" class="edge">
<title>layer1_expert6_gpu12&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M2879.01,-1818.96C2737.5,-1797.53 2441.43,-1752.69 2276.62,-1727.73"/>
<polygon fill="black" stroke="black" points="2276.85,-1724.23 2266.44,-1726.19 2275.81,-1731.15 2276.85,-1724.23"/>
</g>
<!-- layer1_expert6_gpu13&#45;&gt;layer1_expert_concat -->
<g id="edge69" class="edge">
<title>layer1_expert6_gpu13&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M3123.2,-1819.43C3109.3,-1817.56 3095.02,-1815.68 3081.54,-1814 2798.72,-1778.67 2466.4,-1742.49 2288.11,-1723.52"/>
<polygon fill="black" stroke="black" points="2288.22,-1720.01 2277.9,-1722.44 2287.48,-1726.97 2288.22,-1720.01"/>
</g>
<!-- layer1_expert7_gpu14&#45;&gt;layer1_expert_concat -->
<g id="edge70" class="edge">
<title>layer1_expert7_gpu14&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M3371.23,-1819.29C3357.02,-1817.4 3342.36,-1815.56 3328.54,-1814 2956.34,-1771.95 2515.89,-1736.67 2297.13,-1720.11"/>
<polygon fill="black" stroke="black" points="2297.12,-1716.6 2286.88,-1719.34 2296.59,-1723.58 2297.12,-1716.6"/>
</g>
<!-- layer1_expert7_gpu15&#45;&gt;layer1_expert_concat -->
<g id="edge71" class="edge">
<title>layer1_expert7_gpu15&#45;&gt;layer1_expert_concat</title>
<path fill="none" stroke="black" d="M3618.92,-1819.2C3604.49,-1817.3 3589.59,-1815.48 3575.54,-1814 3111.98,-1765.25 2560.64,-1731.77 2304.14,-1717.61"/>
<polygon fill="black" stroke="black" points="2304.19,-1714.11 2294.01,-1717.05 2303.81,-1721.09 2304.19,-1714.11"/>
</g>
<!-- layer2_concat_heads -->
<g id="node57" class="node">
<title>layer2_concat_heads</title>
<polygon fill="orange" stroke="black" points="5221.54,-1604 5057.54,-1551 5221.54,-1498 5385.54,-1551 5221.54,-1604"/>
<text text-anchor="middle" x="5221.54" y="-1562.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="5221.54" y="-1547.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="5221.54" y="-1532.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_expert_concat&#45;&gt;layer2_concat_heads -->
<g id="edge72" class="edge">
<title>layer1_expert_concat&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M2294.56,-1701.12C2795.76,-1675.59 4547.45,-1586.34 5072,-1559.62"/>
<polygon fill="black" stroke="black" points="5072.47,-1563.1 5082.28,-1559.09 5072.12,-1556.11 5072.47,-1563.1"/>
</g>
<!-- layer2_router -->
<g id="node94" class="node">
<title>layer2_router</title>
<polygon fill="lightpink" stroke="black" points="5324.54,-1417.5 5273.04,-1461 5170.04,-1461 5118.54,-1417.5 5170.04,-1374 5273.04,-1374 5324.54,-1417.5"/>
<text text-anchor="middle" x="5221.54" y="-1428.8" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="5221.54" y="-1413.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8]</text>
<text text-anchor="middle" x="5221.54" y="-1398.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_router -->
<g id="edge109" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_router</title>
<path fill="none" stroke="black" d="M5221.54,-1497.65C5221.54,-1489.1 5221.54,-1480.22 5221.54,-1471.65"/>
<polygon fill="black" stroke="black" points="5225.04,-1471.38 5221.54,-1461.38 5218.04,-1471.38 5225.04,-1471.38"/>
</g>
<!-- layer2_qkv_hg0_ds0 -->
<g id="node58" class="node">
<title>layer2_qkv_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="3977.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="3977.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg0_ds0</text>
</g>
<!-- layer2_attn_hg0_ds0 -->
<g id="node59" class="node">
<title>layer2_attn_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="3977.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="3977.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg0_ds0</text>
</g>
<!-- layer2_qkv_hg0_ds0&#45;&gt;layer2_attn_hg0_ds0 -->
<g id="edge73" class="edge">
<title>layer2_qkv_hg0_ds0&#45;&gt;layer2_attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M3977.54,-1926.23C3977.54,-1908.56 3977.54,-1880.82 3977.54,-1860.19"/>
<polygon fill="black" stroke="black" points="3981.04,-1860.14 3977.54,-1850.14 3974.04,-1860.14 3981.04,-1860.14"/>
</g>
<!-- layer2_concat_dim_hg0 -->
<g id="node60" class="node">
<title>layer2_concat_dim_hg0</title>
<polygon fill="lightgreen" stroke="black" points="4439.54,-1777 4246.54,-1709 4439.54,-1641 4632.54,-1709 4439.54,-1777"/>
<text text-anchor="middle" x="4439.54" y="-1727.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="4439.54" y="-1712.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="4439.54" y="-1697.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="4439.54" y="-1682.8" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- layer2_attn_hg0_ds0&#45;&gt;layer2_concat_dim_hg0 -->
<g id="edge74" class="edge">
<title>layer2_attn_hg0_ds0&#45;&gt;layer2_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M4032.81,-1816.52C4103.48,-1798.02 4227.77,-1765.46 4320.42,-1741.2"/>
<polygon fill="black" stroke="black" points="4321.34,-1744.57 4330.13,-1738.65 4319.57,-1737.8 4321.34,-1744.57"/>
</g>
<!-- layer2_concat_dim_hg0&#45;&gt;layer2_concat_heads -->
<g id="edge105" class="edge">
<title>layer2_concat_dim_hg0&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M4561.3,-1683.71C4712.16,-1653.62 4966.97,-1602.78 5111.97,-1573.86"/>
<polygon fill="black" stroke="black" points="5112.66,-1577.29 5121.79,-1571.9 5111.29,-1570.42 5112.66,-1577.29"/>
</g>
<!-- layer2_qkv_hg0_ds1 -->
<g id="node61" class="node">
<title>layer2_qkv_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="4208.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="4208.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg0_ds1</text>
</g>
<!-- layer2_attn_hg0_ds1 -->
<g id="node62" class="node">
<title>layer2_attn_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="4208.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="4208.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg0_ds1</text>
</g>
<!-- layer2_qkv_hg0_ds1&#45;&gt;layer2_attn_hg0_ds1 -->
<g id="edge75" class="edge">
<title>layer2_qkv_hg0_ds1&#45;&gt;layer2_attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M4208.54,-1926.23C4208.54,-1908.56 4208.54,-1880.82 4208.54,-1860.19"/>
<polygon fill="black" stroke="black" points="4212.04,-1860.14 4208.54,-1850.14 4205.04,-1860.14 4212.04,-1860.14"/>
</g>
<!-- layer2_attn_hg0_ds1&#45;&gt;layer2_concat_dim_hg0 -->
<g id="edge76" class="edge">
<title>layer2_attn_hg0_ds1&#45;&gt;layer2_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M4239.69,-1814.68C4268.89,-1799.39 4313.89,-1775.81 4353.81,-1754.91"/>
<polygon fill="black" stroke="black" points="4355.53,-1757.95 4362.77,-1750.21 4352.29,-1751.75 4355.53,-1757.95"/>
</g>
<!-- layer2_qkv_hg0_ds2 -->
<g id="node63" class="node">
<title>layer2_qkv_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="4439.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="4439.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg0_ds2</text>
</g>
<!-- layer2_attn_hg0_ds2 -->
<g id="node64" class="node">
<title>layer2_attn_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="4439.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="4439.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg0_ds2</text>
</g>
<!-- layer2_qkv_hg0_ds2&#45;&gt;layer2_attn_hg0_ds2 -->
<g id="edge77" class="edge">
<title>layer2_qkv_hg0_ds2&#45;&gt;layer2_attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M4439.54,-1926.23C4439.54,-1908.56 4439.54,-1880.82 4439.54,-1860.19"/>
<polygon fill="black" stroke="black" points="4443.04,-1860.14 4439.54,-1850.14 4436.04,-1860.14 4443.04,-1860.14"/>
</g>
<!-- layer2_attn_hg0_ds2&#45;&gt;layer2_concat_dim_hg0 -->
<g id="edge78" class="edge">
<title>layer2_attn_hg0_ds2&#45;&gt;layer2_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M4439.54,-1813.92C4439.54,-1806.49 4439.54,-1797.22 4439.54,-1787.3"/>
<polygon fill="black" stroke="black" points="4443.04,-1787.2 4439.54,-1777.2 4436.04,-1787.2 4443.04,-1787.2"/>
</g>
<!-- layer2_qkv_hg0_ds3 -->
<g id="node65" class="node">
<title>layer2_qkv_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="4670.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="4670.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg0_ds3</text>
</g>
<!-- layer2_attn_hg0_ds3 -->
<g id="node66" class="node">
<title>layer2_attn_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="4670.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="4670.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg0_ds3</text>
</g>
<!-- layer2_qkv_hg0_ds3&#45;&gt;layer2_attn_hg0_ds3 -->
<g id="edge79" class="edge">
<title>layer2_qkv_hg0_ds3&#45;&gt;layer2_attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M4670.54,-1926.23C4670.54,-1908.56 4670.54,-1880.82 4670.54,-1860.19"/>
<polygon fill="black" stroke="black" points="4674.04,-1860.14 4670.54,-1850.14 4667.04,-1860.14 4674.04,-1860.14"/>
</g>
<!-- layer2_attn_hg0_ds3&#45;&gt;layer2_concat_dim_hg0 -->
<g id="edge80" class="edge">
<title>layer2_attn_hg0_ds3&#45;&gt;layer2_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M4639.39,-1814.68C4610.19,-1799.39 4565.19,-1775.81 4525.27,-1754.91"/>
<polygon fill="black" stroke="black" points="4526.79,-1751.75 4516.31,-1750.21 4523.55,-1757.95 4526.79,-1751.75"/>
</g>
<!-- layer2_qkv_hg1_ds0 -->
<g id="node67" class="node">
<title>layer2_qkv_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="4901.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="4901.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg1_ds0</text>
</g>
<!-- layer2_attn_hg1_ds0 -->
<g id="node68" class="node">
<title>layer2_attn_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="4901.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="4901.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg1_ds0</text>
</g>
<!-- layer2_qkv_hg1_ds0&#45;&gt;layer2_attn_hg1_ds0 -->
<g id="edge81" class="edge">
<title>layer2_qkv_hg1_ds0&#45;&gt;layer2_attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M4901.54,-1926.23C4901.54,-1908.56 4901.54,-1880.82 4901.54,-1860.19"/>
<polygon fill="black" stroke="black" points="4905.04,-1860.14 4901.54,-1850.14 4898.04,-1860.14 4905.04,-1860.14"/>
</g>
<!-- layer2_concat_dim_hg1 -->
<g id="node69" class="node">
<title>layer2_concat_dim_hg1</title>
<polygon fill="lightgreen" stroke="black" points="5221.54,-1777 5028.54,-1709 5221.54,-1641 5414.54,-1709 5221.54,-1777"/>
<text text-anchor="middle" x="5221.54" y="-1727.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="5221.54" y="-1712.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5221.54" y="-1697.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="5221.54" y="-1682.8" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- layer2_attn_hg1_ds0&#45;&gt;layer2_concat_dim_hg1 -->
<g id="edge82" class="edge">
<title>layer2_attn_hg1_ds0&#45;&gt;layer2_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M4943.05,-1815.31C4987.67,-1798.43 5060.27,-1770.98 5120.16,-1748.33"/>
<polygon fill="black" stroke="black" points="5121.54,-1751.55 5129.66,-1744.74 5119.07,-1745.01 5121.54,-1751.55"/>
</g>
<!-- layer2_concat_dim_hg1&#45;&gt;layer2_concat_heads -->
<g id="edge106" class="edge">
<title>layer2_concat_dim_hg1&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M5221.54,-1640.94C5221.54,-1632.15 5221.54,-1623.18 5221.54,-1614.47"/>
<polygon fill="black" stroke="black" points="5225.04,-1614.41 5221.54,-1604.41 5218.04,-1614.41 5225.04,-1614.41"/>
</g>
<!-- layer2_qkv_hg1_ds1 -->
<g id="node70" class="node">
<title>layer2_qkv_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="5132.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="5132.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg1_ds1</text>
</g>
<!-- layer2_attn_hg1_ds1 -->
<g id="node71" class="node">
<title>layer2_attn_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="5132.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="5132.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg1_ds1</text>
</g>
<!-- layer2_qkv_hg1_ds1&#45;&gt;layer2_attn_hg1_ds1 -->
<g id="edge83" class="edge">
<title>layer2_qkv_hg1_ds1&#45;&gt;layer2_attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M5132.54,-1926.23C5132.54,-1908.56 5132.54,-1880.82 5132.54,-1860.19"/>
<polygon fill="black" stroke="black" points="5136.04,-1860.14 5132.54,-1850.14 5129.04,-1860.14 5136.04,-1860.14"/>
</g>
<!-- layer2_attn_hg1_ds1&#45;&gt;layer2_concat_dim_hg1 -->
<g id="edge84" class="edge">
<title>layer2_attn_hg1_ds1&#45;&gt;layer2_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M5145.1,-1813.92C5153.39,-1802.66 5164.79,-1787.16 5176.26,-1771.56"/>
<polygon fill="black" stroke="black" points="5179.15,-1773.55 5182.25,-1763.42 5173.51,-1769.4 5179.15,-1773.55"/>
</g>
<!-- layer2_qkv_hg1_ds2 -->
<g id="node72" class="node">
<title>layer2_qkv_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="5363.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="5363.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg1_ds2</text>
</g>
<!-- layer2_attn_hg1_ds2 -->
<g id="node73" class="node">
<title>layer2_attn_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="5363.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="5363.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg1_ds2</text>
</g>
<!-- layer2_qkv_hg1_ds2&#45;&gt;layer2_attn_hg1_ds2 -->
<g id="edge85" class="edge">
<title>layer2_qkv_hg1_ds2&#45;&gt;layer2_attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M5363.54,-1926.23C5363.54,-1908.56 5363.54,-1880.82 5363.54,-1860.19"/>
<polygon fill="black" stroke="black" points="5367.04,-1860.14 5363.54,-1850.14 5360.04,-1860.14 5367.04,-1860.14"/>
</g>
<!-- layer2_attn_hg1_ds2&#45;&gt;layer2_concat_dim_hg1 -->
<g id="edge86" class="edge">
<title>layer2_attn_hg1_ds2&#45;&gt;layer2_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M5343.8,-1814.18C5328.46,-1801.1 5306.28,-1782.21 5285.02,-1764.09"/>
<polygon fill="black" stroke="black" points="5287.12,-1761.29 5277.24,-1757.46 5282.58,-1766.61 5287.12,-1761.29"/>
</g>
<!-- layer2_qkv_hg1_ds3 -->
<g id="node74" class="node">
<title>layer2_qkv_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="5594.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="5594.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg1_ds3</text>
</g>
<!-- layer2_attn_hg1_ds3 -->
<g id="node75" class="node">
<title>layer2_attn_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="5594.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="5594.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg1_ds3</text>
</g>
<!-- layer2_qkv_hg1_ds3&#45;&gt;layer2_attn_hg1_ds3 -->
<g id="edge87" class="edge">
<title>layer2_qkv_hg1_ds3&#45;&gt;layer2_attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M5594.54,-1926.23C5594.54,-1908.56 5594.54,-1880.82 5594.54,-1860.19"/>
<polygon fill="black" stroke="black" points="5598.04,-1860.14 5594.54,-1850.14 5591.04,-1860.14 5598.04,-1860.14"/>
</g>
<!-- layer2_attn_hg1_ds3&#45;&gt;layer2_concat_dim_hg1 -->
<g id="edge88" class="edge">
<title>layer2_attn_hg1_ds3&#45;&gt;layer2_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M5547.68,-1815.8C5493.47,-1798.21 5402.42,-1768.68 5330.29,-1745.28"/>
<polygon fill="black" stroke="black" points="5331.28,-1741.92 5320.69,-1742.16 5329.12,-1748.58 5331.28,-1741.92"/>
</g>
<!-- layer2_qkv_hg2_ds0 -->
<g id="node76" class="node">
<title>layer2_qkv_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="5825.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="5825.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg2_ds0</text>
</g>
<!-- layer2_attn_hg2_ds0 -->
<g id="node77" class="node">
<title>layer2_attn_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="5825.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="5825.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg2_ds0</text>
</g>
<!-- layer2_qkv_hg2_ds0&#45;&gt;layer2_attn_hg2_ds0 -->
<g id="edge89" class="edge">
<title>layer2_qkv_hg2_ds0&#45;&gt;layer2_attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M5825.54,-1926.23C5825.54,-1908.56 5825.54,-1880.82 5825.54,-1860.19"/>
<polygon fill="black" stroke="black" points="5829.04,-1860.14 5825.54,-1850.14 5822.04,-1860.14 5829.04,-1860.14"/>
</g>
<!-- layer2_concat_dim_hg2 -->
<g id="node78" class="node">
<title>layer2_concat_dim_hg2</title>
<polygon fill="lightgreen" stroke="black" points="6056.54,-1777 5863.54,-1709 6056.54,-1641 6249.54,-1709 6056.54,-1777"/>
<text text-anchor="middle" x="6056.54" y="-1727.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="6056.54" y="-1712.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6056.54" y="-1697.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="6056.54" y="-1682.8" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- layer2_attn_hg2_ds0&#45;&gt;layer2_concat_dim_hg2 -->
<g id="edge90" class="edge">
<title>layer2_attn_hg2_ds0&#45;&gt;layer2_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M5856.69,-1814.68C5885.89,-1799.39 5930.89,-1775.81 5970.81,-1754.91"/>
<polygon fill="black" stroke="black" points="5972.53,-1757.95 5979.77,-1750.21 5969.29,-1751.75 5972.53,-1757.95"/>
</g>
<!-- layer2_concat_dim_hg2&#45;&gt;layer2_concat_heads -->
<g id="edge107" class="edge">
<title>layer2_concat_dim_hg2&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M5931.98,-1684.73C5769.94,-1654.46 5489.22,-1602.01 5333.58,-1572.93"/>
<polygon fill="black" stroke="black" points="5333.98,-1569.45 5323.51,-1571.05 5332.7,-1576.33 5333.98,-1569.45"/>
</g>
<!-- layer2_qkv_hg2_ds1 -->
<g id="node79" class="node">
<title>layer2_qkv_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="6056.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="6056.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg2_ds1</text>
</g>
<!-- layer2_attn_hg2_ds1 -->
<g id="node80" class="node">
<title>layer2_attn_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="6056.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="6056.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg2_ds1</text>
</g>
<!-- layer2_qkv_hg2_ds1&#45;&gt;layer2_attn_hg2_ds1 -->
<g id="edge91" class="edge">
<title>layer2_qkv_hg2_ds1&#45;&gt;layer2_attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M6056.54,-1926.23C6056.54,-1908.56 6056.54,-1880.82 6056.54,-1860.19"/>
<polygon fill="black" stroke="black" points="6060.04,-1860.14 6056.54,-1850.14 6053.04,-1860.14 6060.04,-1860.14"/>
</g>
<!-- layer2_attn_hg2_ds1&#45;&gt;layer2_concat_dim_hg2 -->
<g id="edge92" class="edge">
<title>layer2_attn_hg2_ds1&#45;&gt;layer2_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M6056.54,-1813.92C6056.54,-1806.49 6056.54,-1797.22 6056.54,-1787.3"/>
<polygon fill="black" stroke="black" points="6060.04,-1787.2 6056.54,-1777.2 6053.04,-1787.2 6060.04,-1787.2"/>
</g>
<!-- layer2_qkv_hg2_ds2 -->
<g id="node81" class="node">
<title>layer2_qkv_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="6287.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="6287.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg2_ds2</text>
</g>
<!-- layer2_attn_hg2_ds2 -->
<g id="node82" class="node">
<title>layer2_attn_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="6287.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="6287.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg2_ds2</text>
</g>
<!-- layer2_qkv_hg2_ds2&#45;&gt;layer2_attn_hg2_ds2 -->
<g id="edge93" class="edge">
<title>layer2_qkv_hg2_ds2&#45;&gt;layer2_attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M6287.54,-1926.23C6287.54,-1908.56 6287.54,-1880.82 6287.54,-1860.19"/>
<polygon fill="black" stroke="black" points="6291.04,-1860.14 6287.54,-1850.14 6284.04,-1860.14 6291.04,-1860.14"/>
</g>
<!-- layer2_attn_hg2_ds2&#45;&gt;layer2_concat_dim_hg2 -->
<g id="edge94" class="edge">
<title>layer2_attn_hg2_ds2&#45;&gt;layer2_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M6256.39,-1814.68C6227.19,-1799.39 6182.19,-1775.81 6142.27,-1754.91"/>
<polygon fill="black" stroke="black" points="6143.79,-1751.75 6133.31,-1750.21 6140.55,-1757.95 6143.79,-1751.75"/>
</g>
<!-- layer2_qkv_hg2_ds3 -->
<g id="node83" class="node">
<title>layer2_qkv_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="6518.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="6518.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg2_ds3</text>
</g>
<!-- layer2_attn_hg2_ds3 -->
<g id="node84" class="node">
<title>layer2_attn_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="6518.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="6518.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg2_ds3</text>
</g>
<!-- layer2_qkv_hg2_ds3&#45;&gt;layer2_attn_hg2_ds3 -->
<g id="edge95" class="edge">
<title>layer2_qkv_hg2_ds3&#45;&gt;layer2_attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M6518.54,-1926.23C6518.54,-1908.56 6518.54,-1880.82 6518.54,-1860.19"/>
<polygon fill="black" stroke="black" points="6522.04,-1860.14 6518.54,-1850.14 6515.04,-1860.14 6522.04,-1860.14"/>
</g>
<!-- layer2_attn_hg2_ds3&#45;&gt;layer2_concat_dim_hg2 -->
<g id="edge96" class="edge">
<title>layer2_attn_hg2_ds3&#45;&gt;layer2_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M6463.27,-1816.52C6392.6,-1798.02 6268.31,-1765.46 6175.66,-1741.2"/>
<polygon fill="black" stroke="black" points="6176.51,-1737.8 6165.95,-1738.65 6174.74,-1744.57 6176.51,-1737.8"/>
</g>
<!-- layer2_qkv_hg3_ds0 -->
<g id="node85" class="node">
<title>layer2_qkv_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="6749.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="6749.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg3_ds0</text>
</g>
<!-- layer2_attn_hg3_ds0 -->
<g id="node86" class="node">
<title>layer2_attn_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="6749.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="6749.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg3_ds0</text>
</g>
<!-- layer2_qkv_hg3_ds0&#45;&gt;layer2_attn_hg3_ds0 -->
<g id="edge97" class="edge">
<title>layer2_qkv_hg3_ds0&#45;&gt;layer2_attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M6749.54,-1926.23C6749.54,-1908.56 6749.54,-1880.82 6749.54,-1860.19"/>
<polygon fill="black" stroke="black" points="6753.04,-1860.14 6749.54,-1850.14 6746.04,-1860.14 6753.04,-1860.14"/>
</g>
<!-- layer2_concat_dim_hg3 -->
<g id="node87" class="node">
<title>layer2_concat_dim_hg3</title>
<polygon fill="lightgreen" stroke="black" points="6980.54,-1777 6787.54,-1709 6980.54,-1641 7173.54,-1709 6980.54,-1777"/>
<text text-anchor="middle" x="6980.54" y="-1727.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="6980.54" y="-1712.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="6980.54" y="-1697.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="6980.54" y="-1682.8" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- layer2_attn_hg3_ds0&#45;&gt;layer2_concat_dim_hg3 -->
<g id="edge98" class="edge">
<title>layer2_attn_hg3_ds0&#45;&gt;layer2_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M6780.69,-1814.68C6809.89,-1799.39 6854.89,-1775.81 6894.81,-1754.91"/>
<polygon fill="black" stroke="black" points="6896.53,-1757.95 6903.77,-1750.21 6893.29,-1751.75 6896.53,-1757.95"/>
</g>
<!-- layer2_concat_dim_hg3&#45;&gt;layer2_concat_heads -->
<g id="edge108" class="edge">
<title>layer2_concat_dim_hg3&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M6830.53,-1693.77C6684.52,-1680 6456.34,-1658.67 6258.54,-1641 5936.8,-1612.26 5558.73,-1580.26 5359.89,-1563.57"/>
<polygon fill="black" stroke="black" points="5359.94,-1560.06 5349.69,-1562.71 5359.36,-1567.04 5359.94,-1560.06"/>
</g>
<!-- layer2_qkv_hg3_ds1 -->
<g id="node88" class="node">
<title>layer2_qkv_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="6980.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="6980.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg3_ds1</text>
</g>
<!-- layer2_attn_hg3_ds1 -->
<g id="node89" class="node">
<title>layer2_attn_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="6980.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="6980.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg3_ds1</text>
</g>
<!-- layer2_qkv_hg3_ds1&#45;&gt;layer2_attn_hg3_ds1 -->
<g id="edge99" class="edge">
<title>layer2_qkv_hg3_ds1&#45;&gt;layer2_attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M6980.54,-1926.23C6980.54,-1908.56 6980.54,-1880.82 6980.54,-1860.19"/>
<polygon fill="black" stroke="black" points="6984.04,-1860.14 6980.54,-1850.14 6977.04,-1860.14 6984.04,-1860.14"/>
</g>
<!-- layer2_attn_hg3_ds1&#45;&gt;layer2_concat_dim_hg3 -->
<g id="edge100" class="edge">
<title>layer2_attn_hg3_ds1&#45;&gt;layer2_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M6980.54,-1813.92C6980.54,-1806.49 6980.54,-1797.22 6980.54,-1787.3"/>
<polygon fill="black" stroke="black" points="6984.04,-1787.2 6980.54,-1777.2 6977.04,-1787.2 6984.04,-1787.2"/>
</g>
<!-- layer2_qkv_hg3_ds2 -->
<g id="node90" class="node">
<title>layer2_qkv_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="7211.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7211.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg3_ds2</text>
</g>
<!-- layer2_attn_hg3_ds2 -->
<g id="node91" class="node">
<title>layer2_attn_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="7211.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7211.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg3_ds2</text>
</g>
<!-- layer2_qkv_hg3_ds2&#45;&gt;layer2_attn_hg3_ds2 -->
<g id="edge101" class="edge">
<title>layer2_qkv_hg3_ds2&#45;&gt;layer2_attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M7211.54,-1926.23C7211.54,-1908.56 7211.54,-1880.82 7211.54,-1860.19"/>
<polygon fill="black" stroke="black" points="7215.04,-1860.14 7211.54,-1850.14 7208.04,-1860.14 7215.04,-1860.14"/>
</g>
<!-- layer2_attn_hg3_ds2&#45;&gt;layer2_concat_dim_hg3 -->
<g id="edge102" class="edge">
<title>layer2_attn_hg3_ds2&#45;&gt;layer2_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M7180.39,-1814.68C7151.19,-1799.39 7106.19,-1775.81 7066.27,-1754.91"/>
<polygon fill="black" stroke="black" points="7067.79,-1751.75 7057.31,-1750.21 7064.55,-1757.95 7067.79,-1751.75"/>
</g>
<!-- layer2_qkv_hg3_ds3 -->
<g id="node92" class="node">
<title>layer2_qkv_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="7442.54" cy="-1944.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7442.54" y="-1940.8" font-family="Times,serif" font-size="14.00">layer2_qkv_hg3_ds3</text>
</g>
<!-- layer2_attn_hg3_ds3 -->
<g id="node93" class="node">
<title>layer2_attn_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="7442.54" cy="-1832" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7442.54" y="-1828.3" font-family="Times,serif" font-size="14.00">layer2_attn_hg3_ds3</text>
</g>
<!-- layer2_qkv_hg3_ds3&#45;&gt;layer2_attn_hg3_ds3 -->
<g id="edge103" class="edge">
<title>layer2_qkv_hg3_ds3&#45;&gt;layer2_attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M7442.54,-1926.23C7442.54,-1908.56 7442.54,-1880.82 7442.54,-1860.19"/>
<polygon fill="black" stroke="black" points="7446.04,-1860.14 7442.54,-1850.14 7439.04,-1860.14 7446.04,-1860.14"/>
</g>
<!-- layer2_attn_hg3_ds3&#45;&gt;layer2_concat_dim_hg3 -->
<g id="edge104" class="edge">
<title>layer2_attn_hg3_ds3&#45;&gt;layer2_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M7387.27,-1816.52C7316.6,-1798.02 7192.31,-1765.46 7099.66,-1741.2"/>
<polygon fill="black" stroke="black" points="7100.51,-1737.8 7089.95,-1738.65 7098.74,-1744.57 7100.51,-1737.8"/>
</g>
<!-- layer2_expert0_gpu0 -->
<g id="node95" class="node">
<title>layer2_expert0_gpu0</title>
<ellipse fill="none" stroke="black" cx="3341.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="3341.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert0_gpu0</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert0_gpu0 -->
<g id="edge110" class="edge">
<title>layer2_router&#45;&gt;layer2_expert0_gpu0</title>
<path fill="none" stroke="black" d="M5122.33,-1414.29C4889.21,-1408.66 4288.37,-1391.65 3787.54,-1356 3640.96,-1345.57 3604.4,-1340.9 3458.54,-1323 3448.84,-1321.81 3438.7,-1320.47 3428.61,-1319.09"/>
<polygon fill="black" stroke="black" points="3428.96,-1315.6 3418.57,-1317.69 3427.99,-1322.53 3428.96,-1315.6"/>
<text text-anchor="middle" x="3819.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer2_expert0_gpu1 -->
<g id="node96" class="node">
<title>layer2_expert0_gpu1</title>
<ellipse fill="none" stroke="black" cx="3576.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="3576.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert0_gpu1</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert0_gpu1 -->
<g id="edge111" class="edge">
<title>layer2_router&#45;&gt;layer2_expert0_gpu1</title>
<path fill="none" stroke="black" d="M5123.46,-1413.14C4919.2,-1405.78 4433.34,-1386.44 4026.54,-1356 3878.23,-1344.9 3841.17,-1341.03 3693.54,-1323 3683.84,-1321.81 3673.69,-1320.48 3663.61,-1319.1"/>
<polygon fill="black" stroke="black" points="3663.96,-1315.61 3653.57,-1317.7 3662.99,-1322.55 3663.96,-1315.61"/>
<text text-anchor="middle" x="4058.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer2_expert1_gpu2 -->
<g id="node97" class="node">
<title>layer2_expert1_gpu2</title>
<ellipse fill="none" stroke="black" cx="3811.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="3811.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert1_gpu2</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert1_gpu2 -->
<g id="edge112" class="edge">
<title>layer2_router&#45;&gt;layer2_expert1_gpu2</title>
<path fill="none" stroke="black" d="M5125.42,-1411.46C4953.43,-1402.21 4581.7,-1381.13 4268.54,-1356 4117.21,-1343.86 4079.26,-1341.25 3928.54,-1323 3918.84,-1321.82 3908.69,-1320.5 3898.61,-1319.12"/>
<polygon fill="black" stroke="black" points="3898.95,-1315.63 3888.57,-1317.72 3897.99,-1322.57 3898.95,-1315.63"/>
<text text-anchor="middle" x="4300.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer2_expert1_gpu3 -->
<g id="node98" class="node">
<title>layer2_expert1_gpu3</title>
<ellipse fill="none" stroke="black" cx="4046.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="4046.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert1_gpu3</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert1_gpu3 -->
<g id="edge113" class="edge">
<title>layer2_router&#45;&gt;layer2_expert1_gpu3</title>
<path fill="none" stroke="black" d="M5126.83,-1410.34C4941.46,-1397.79 4517.89,-1366.71 4163.54,-1323 4153.91,-1321.81 4143.86,-1320.48 4133.85,-1319.11"/>
<polygon fill="black" stroke="black" points="4134.27,-1315.63 4123.89,-1317.72 4133.31,-1322.57 4134.27,-1315.63"/>
<text text-anchor="middle" x="4484.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer2_expert2_gpu4 -->
<g id="node99" class="node">
<title>layer2_expert2_gpu4</title>
<ellipse fill="none" stroke="black" cx="4281.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="4281.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert2_gpu4</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert2_gpu4 -->
<g id="edge114" class="edge">
<title>layer2_router&#45;&gt;layer2_expert2_gpu4</title>
<path fill="none" stroke="black" d="M5130.38,-1407.22C4978.44,-1391.51 4663.9,-1357.96 4398.54,-1323 4389.1,-1321.76 4379.24,-1320.4 4369.42,-1319.03"/>
<polygon fill="black" stroke="black" points="4369.62,-1315.52 4359.22,-1317.58 4368.64,-1322.45 4369.62,-1315.52"/>
<text text-anchor="middle" x="4678.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer2_expert2_gpu5 -->
<g id="node100" class="node">
<title>layer2_expert2_gpu5</title>
<ellipse fill="none" stroke="black" cx="4516.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="4516.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert2_gpu5</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert2_gpu5 -->
<g id="edge115" class="edge">
<title>layer2_router&#45;&gt;layer2_expert2_gpu5</title>
<path fill="none" stroke="black" d="M5135.45,-1403.01C4999.81,-1381.75 4737.9,-1340.69 4602.4,-1319.46"/>
<polygon fill="black" stroke="black" points="4602.89,-1315.99 4592.47,-1317.9 4601.81,-1322.91 4602.89,-1315.99"/>
<text text-anchor="middle" x="4858.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer2_expert3_gpu6 -->
<g id="node101" class="node">
<title>layer2_expert3_gpu6</title>
<ellipse fill="none" stroke="black" cx="4751.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="4751.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert3_gpu6</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert3_gpu6 -->
<g id="edge116" class="edge">
<title>layer2_router&#45;&gt;layer2_expert3_gpu6</title>
<path fill="none" stroke="black" d="M5141.81,-1397.76C5051.87,-1376.61 4907.02,-1342.55 4821.37,-1322.42"/>
<polygon fill="black" stroke="black" points="4822.02,-1318.97 4811.48,-1320.09 4820.41,-1325.79 4822.02,-1318.97"/>
<text text-anchor="middle" x="4989.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer2_expert3_gpu7 -->
<g id="node102" class="node">
<title>layer2_expert3_gpu7</title>
<ellipse fill="none" stroke="black" cx="4986.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="4986.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert3_gpu7</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert3_gpu7 -->
<g id="edge117" class="edge">
<title>layer2_router&#45;&gt;layer2_expert3_gpu7</title>
<path fill="none" stroke="black" d="M5156.08,-1385.72C5115.81,-1366.79 5065.32,-1343.05 5029.96,-1326.42"/>
<polygon fill="black" stroke="black" points="5031.4,-1323.22 5020.86,-1322.14 5028.42,-1329.56 5031.4,-1323.22"/>
<text text-anchor="middle" x="5121.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer2_expert4_gpu8 -->
<g id="node103" class="node">
<title>layer2_expert4_gpu8</title>
<ellipse fill="none" stroke="black" cx="5221.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="5221.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert4_gpu8</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert4_gpu8 -->
<g id="edge118" class="edge">
<title>layer2_router&#45;&gt;layer2_expert4_gpu8</title>
<path fill="none" stroke="black" d="M5221.54,-1373.78C5221.54,-1360.16 5221.54,-1345.46 5221.54,-1333.25"/>
<polygon fill="black" stroke="black" points="5225.04,-1333.24 5221.54,-1323.24 5218.04,-1333.24 5225.04,-1333.24"/>
<text text-anchor="middle" x="5253.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer2_expert4_gpu9 -->
<g id="node104" class="node">
<title>layer2_expert4_gpu9</title>
<ellipse fill="none" stroke="black" cx="5456.54" cy="-1305" rx="108.58" ry="18"/>
<text text-anchor="middle" x="5456.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert4_gpu9</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert4_gpu9 -->
<g id="edge119" class="edge">
<title>layer2_router&#45;&gt;layer2_expert4_gpu9</title>
<path fill="none" stroke="black" d="M5287,-1385.72C5327.27,-1366.79 5377.76,-1343.05 5413.12,-1326.42"/>
<polygon fill="black" stroke="black" points="5414.66,-1329.56 5422.22,-1322.14 5411.68,-1323.22 5414.66,-1329.56"/>
<text text-anchor="middle" x="5411.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer2_expert5_gpu10 -->
<g id="node105" class="node">
<title>layer2_expert5_gpu10</title>
<ellipse fill="none" stroke="black" cx="5697.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="5697.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert5_gpu10</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert5_gpu10 -->
<g id="edge120" class="edge">
<title>layer2_router&#45;&gt;layer2_expert5_gpu10</title>
<path fill="none" stroke="black" d="M5301.48,-1397.94C5392.38,-1376.84 5539.42,-1342.71 5626.47,-1322.5"/>
<polygon fill="black" stroke="black" points="5627.31,-1325.9 5636.26,-1320.23 5625.72,-1319.08 5627.31,-1325.9"/>
<text text-anchor="middle" x="5575.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer2_expert5_gpu11 -->
<g id="node106" class="node">
<title>layer2_expert5_gpu11</title>
<ellipse fill="none" stroke="black" cx="5944.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="5944.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert5_gpu11</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert5_gpu11 -->
<g id="edge121" class="edge">
<title>layer2_router&#45;&gt;layer2_expert5_gpu11</title>
<path fill="none" stroke="black" d="M5308.03,-1403.28C5446.26,-1382.16 5715.57,-1341 5855.43,-1319.62"/>
<polygon fill="black" stroke="black" points="5856.32,-1323.02 5865.68,-1318.05 5855.27,-1316.1 5856.32,-1323.02"/>
<text text-anchor="middle" x="5742.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer2_expert6_gpu12 -->
<g id="node107" class="node">
<title>layer2_expert6_gpu12</title>
<ellipse fill="none" stroke="black" cx="6191.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="6191.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert6_gpu12</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert6_gpu12 -->
<g id="edge122" class="edge">
<title>layer2_router&#45;&gt;layer2_expert6_gpu12</title>
<path fill="none" stroke="black" d="M5312.83,-1407.34C5468.19,-1391.55 5793.87,-1357.55 6068.54,-1323 6078.59,-1321.74 6089.09,-1320.36 6099.55,-1318.96"/>
<polygon fill="black" stroke="black" points="6100.09,-1322.42 6109.54,-1317.62 6099.16,-1315.49 6100.09,-1322.42"/>
<text text-anchor="middle" x="5938.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer2_expert6_gpu13 -->
<g id="node108" class="node">
<title>layer2_expert6_gpu13</title>
<ellipse fill="none" stroke="black" cx="6438.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="6438.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert6_gpu13</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert6_gpu13 -->
<g id="edge123" class="edge">
<title>layer2_router&#45;&gt;layer2_expert6_gpu13</title>
<path fill="none" stroke="black" d="M5316.5,-1410.41C5506.54,-1397.77 5947.07,-1366.22 6315.54,-1323 6325.76,-1321.8 6336.45,-1320.46 6347.07,-1319.07"/>
<polygon fill="black" stroke="black" points="6347.77,-1322.5 6357.22,-1317.72 6346.85,-1315.57 6347.77,-1322.5"/>
<text text-anchor="middle" x="6168.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer2_expert7_gpu14 -->
<g id="node109" class="node">
<title>layer2_expert7_gpu14</title>
<ellipse fill="none" stroke="black" cx="6685.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="6685.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert7_gpu14</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert7_gpu14 -->
<g id="edge124" class="edge">
<title>layer2_router&#45;&gt;layer2_expert7_gpu14</title>
<path fill="none" stroke="black" d="M5317.78,-1411.54C5493.74,-1402.24 5879.1,-1380.9 6203.54,-1356 6363.3,-1343.74 6403.36,-1341.31 6562.54,-1323 6572.85,-1321.81 6583.62,-1320.47 6594.33,-1319.08"/>
<polygon fill="black" stroke="black" points="6595.1,-1322.51 6604.56,-1317.73 6594.19,-1315.57 6595.1,-1322.51"/>
<text text-anchor="middle" x="6420.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer2_expert7_gpu15 -->
<g id="node110" class="node">
<title>layer2_expert7_gpu15</title>
<ellipse fill="none" stroke="black" cx="6932.54" cy="-1305" rx="114.5" ry="18"/>
<text text-anchor="middle" x="6932.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer2_expert7_gpu15</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert7_gpu15 -->
<g id="edge125" class="edge">
<title>layer2_router&#45;&gt;layer2_expert7_gpu15</title>
<path fill="none" stroke="black" d="M5319.61,-1413.16C5528.6,-1405.71 6033.25,-1386.02 6455.54,-1356 6613.16,-1344.8 6652.57,-1341.15 6809.54,-1323 6819.76,-1321.82 6830.45,-1320.48 6841.08,-1319.1"/>
<polygon fill="black" stroke="black" points="6841.77,-1322.54 6851.23,-1317.76 6840.85,-1315.6 6841.77,-1322.54"/>
<text text-anchor="middle" x="6670.04" y="-1344.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer2_expert_concat -->
<g id="node111" class="node">
<title>layer2_expert_concat</title>
<polygon fill="lightyellow" stroke="black" points="5418.54,-1235 5260.54,-1182 5418.54,-1129 5576.54,-1182 5418.54,-1235"/>
<text text-anchor="middle" x="5418.54" y="-1193.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5418.54" y="-1178.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="5418.54" y="-1163.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_concat -->
<g id="edge126" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5322.09,-1415.25C5697.39,-1410.08 6997.77,-1387.55 7056.54,-1323 7067.31,-1311.17 7067.49,-1298.67 7056.54,-1287 7006.18,-1233.34 5970.33,-1198.56 5572.39,-1187.13"/>
<polygon fill="black" stroke="black" points="5572.34,-1183.63 5562.24,-1186.84 5572.14,-1190.62 5572.34,-1183.63"/>
</g>
<!-- layer2_expert0_gpu0&#45;&gt;layer2_expert_concat -->
<g id="edge127" class="edge">
<title>layer2_expert0_gpu0&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M3416.94,-1292.01C3430.75,-1290.11 3445.06,-1288.33 3458.54,-1287 4127.9,-1220.75 4930.32,-1194.84 5262.64,-1186.44"/>
<polygon fill="black" stroke="black" points="5262.91,-1189.93 5272.82,-1186.18 5262.73,-1182.94 5262.91,-1189.93"/>
</g>
<!-- layer2_expert0_gpu1&#45;&gt;layer2_expert_concat -->
<g id="edge128" class="edge">
<title>layer2_expert0_gpu1&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M3652.26,-1292.05C3665.98,-1290.16 3680.17,-1288.37 3693.54,-1287 4273.05,-1227.54 4965.84,-1198.45 5266.68,-1187.86"/>
<polygon fill="black" stroke="black" points="5266.91,-1191.36 5276.78,-1187.51 5266.67,-1184.36 5266.91,-1191.36"/>
</g>
<!-- layer2_expert1_gpu2&#45;&gt;layer2_expert_concat -->
<g id="edge129" class="edge">
<title>layer2_expert1_gpu2&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M3887.59,-1292.11C3901.2,-1290.22 3915.27,-1288.42 3928.54,-1287 4419.19,-1234.31 5003.75,-1202.48 5271.46,-1189.62"/>
<polygon fill="black" stroke="black" points="5271.81,-1193.11 5281.63,-1189.13 5271.47,-1186.12 5271.81,-1193.11"/>
</g>
<!-- layer2_expert1_gpu3&#45;&gt;layer2_expert_concat -->
<g id="edge130" class="edge">
<title>layer2_expert1_gpu3&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M4122.92,-1292.21C4136.43,-1290.32 4150.39,-1288.5 4163.54,-1287 4566.74,-1241.05 5045.02,-1207.06 5277.54,-1191.84"/>
<polygon fill="black" stroke="black" points="5277.99,-1195.32 5287.75,-1191.17 5277.54,-1188.33 5277.99,-1195.32"/>
</g>
<!-- layer2_expert2_gpu4&#45;&gt;layer2_expert_concat -->
<g id="edge131" class="edge">
<title>layer2_expert2_gpu4&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M4358.89,-1292.29C4372.1,-1290.42 4385.71,-1288.59 4398.54,-1287 4716.08,-1247.76 5090.57,-1212.35 5285.49,-1194.74"/>
<polygon fill="black" stroke="black" points="5285.85,-1198.22 5295.49,-1193.84 5285.22,-1191.25 5285.85,-1198.22"/>
</g>
<!-- layer2_expert2_gpu5&#45;&gt;layer2_expert_concat -->
<g id="edge132" class="edge">
<title>layer2_expert2_gpu5&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M4594.88,-1292.48C4607.79,-1290.62 4621.04,-1288.74 4633.54,-1287 4867.88,-1254.45 5141.91,-1218.67 5296.36,-1198.7"/>
<polygon fill="black" stroke="black" points="5296.89,-1202.16 5306.36,-1197.41 5295.99,-1195.22 5296.89,-1202.16"/>
</g>
<!-- layer2_expert3_gpu6&#45;&gt;layer2_expert_concat -->
<g id="edge133" class="edge">
<title>layer2_expert3_gpu6&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M4821.97,-1291.22C4937.87,-1270.2 5169.67,-1228.15 5307.72,-1203.1"/>
<polygon fill="black" stroke="black" points="5308.69,-1206.48 5317.91,-1201.26 5307.44,-1199.6 5308.69,-1206.48"/>
</g>
<!-- layer2_expert3_gpu7&#45;&gt;layer2_expert_concat -->
<g id="edge134" class="edge">
<title>layer2_expert3_gpu7&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M5039.51,-1289.16C5110.31,-1269.33 5236.97,-1233.86 5324.25,-1209.41"/>
<polygon fill="black" stroke="black" points="5325.21,-1212.77 5333.9,-1206.71 5323.33,-1206.03 5325.21,-1212.77"/>
</g>
<!-- layer2_expert4_gpu8&#45;&gt;layer2_expert_concat -->
<g id="edge135" class="edge">
<title>layer2_expert4_gpu8&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M5248.52,-1287.43C5275.72,-1270.72 5318.71,-1244.32 5354.65,-1222.24"/>
<polygon fill="black" stroke="black" points="5356.93,-1224.95 5363.62,-1216.73 5353.27,-1218.98 5356.93,-1224.95"/>
</g>
<!-- layer2_expert4_gpu9&#45;&gt;layer2_expert_concat -->
<g id="edge136" class="edge">
<title>layer2_expert4_gpu9&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M5451.18,-1286.92C5447.31,-1274.61 5441.86,-1257.24 5436.51,-1240.21"/>
<polygon fill="black" stroke="black" points="5439.72,-1238.76 5433.39,-1230.27 5433.04,-1240.86 5439.72,-1238.76"/>
</g>
<!-- layer2_expert5_gpu10&#45;&gt;layer2_expert_concat -->
<g id="edge137" class="edge">
<title>layer2_expert5_gpu10&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M5660.49,-1287.93C5618.68,-1269.8 5549.51,-1239.8 5495.81,-1216.51"/>
<polygon fill="black" stroke="black" points="5496.88,-1213.16 5486.31,-1212.39 5494.09,-1219.58 5496.88,-1213.16"/>
</g>
<!-- layer2_expert5_gpu11&#45;&gt;layer2_expert_concat -->
<g id="edge138" class="edge">
<title>layer2_expert5_gpu11&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M5882.91,-1289.82C5793.86,-1269.34 5628.12,-1231.21 5520.63,-1206.48"/>
<polygon fill="black" stroke="black" points="5521.27,-1203.04 5510.74,-1204.21 5519.7,-1209.86 5521.27,-1203.04"/>
</g>
<!-- layer2_expert6_gpu12&#45;&gt;layer2_expert_concat -->
<g id="edge139" class="edge">
<title>layer2_expert6_gpu12&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M6113.53,-1291.79C5977.08,-1270.43 5694.47,-1226.19 5534.86,-1201.21"/>
<polygon fill="black" stroke="black" points="5534.95,-1197.68 5524.53,-1199.59 5533.87,-1204.59 5534.95,-1197.68"/>
</g>
<!-- layer2_expert6_gpu13&#45;&gt;layer2_expert_concat -->
<g id="edge140" class="edge">
<title>layer2_expert6_gpu13&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M6356.53,-1292.41C6342.85,-1290.55 6328.8,-1288.68 6315.54,-1287 6041.5,-1252.18 5719.75,-1216.02 5545.79,-1196.87"/>
<polygon fill="black" stroke="black" points="5546.15,-1193.38 5535.83,-1195.77 5545.38,-1200.34 5546.15,-1193.38"/>
</g>
<!-- layer2_expert7_gpu14&#45;&gt;layer2_expert_concat -->
<g id="edge141" class="edge">
<title>layer2_expert7_gpu14&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M6604.56,-1292.26C6590.56,-1290.39 6576.14,-1288.56 6562.54,-1287 6199.52,-1245.44 5770.15,-1210.1 5555.34,-1193.36"/>
<polygon fill="black" stroke="black" points="5555.52,-1189.86 5545.28,-1192.58 5554.98,-1196.84 5555.52,-1189.86"/>
</g>
<!-- layer2_expert7_gpu15&#45;&gt;layer2_expert_concat -->
<g id="edge142" class="edge">
<title>layer2_expert7_gpu15&#45;&gt;layer2_expert_concat</title>
<path fill="none" stroke="black" d="M6852.24,-1292.16C6838.03,-1290.28 6823.37,-1288.47 6809.54,-1287 6355.59,-1238.71 5815.93,-1205.14 5562.94,-1190.8"/>
<polygon fill="black" stroke="black" points="5562.77,-1187.29 5552.59,-1190.22 5562.37,-1194.28 5562.77,-1187.29"/>
</g>
<!-- layer3_concat_heads -->
<g id="node112" class="node">
<title>layer3_concat_heads</title>
<polygon fill="orange" stroke="black" points="8454.54,-1077 8290.54,-1024 8454.54,-971 8618.54,-1024 8454.54,-1077"/>
<text text-anchor="middle" x="8454.54" y="-1035.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="8454.54" y="-1020.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="8454.54" y="-1005.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_expert_concat&#45;&gt;layer3_concat_heads -->
<g id="edge143" class="edge">
<title>layer2_expert_concat&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M5553.4,-1174.07C6051.27,-1148.49 7783.89,-1059.46 8305.09,-1032.68"/>
<polygon fill="black" stroke="black" points="8305.5,-1036.16 8315.3,-1032.15 8305.14,-1029.17 8305.5,-1036.16"/>
</g>
<!-- layer3_router -->
<g id="node149" class="node">
<title>layer3_router</title>
<polygon fill="lightpink" stroke="black" points="8557.54,-890.5 8506.04,-934 8403.04,-934 8351.54,-890.5 8403.04,-847 8506.04,-847 8557.54,-890.5"/>
<text text-anchor="middle" x="8454.54" y="-901.8" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="8454.54" y="-886.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8]</text>
<text text-anchor="middle" x="8454.54" y="-871.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_router -->
<g id="edge180" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_router</title>
<path fill="none" stroke="black" d="M8454.54,-970.65C8454.54,-962.1 8454.54,-953.22 8454.54,-944.65"/>
<polygon fill="black" stroke="black" points="8458.04,-944.38 8454.54,-934.38 8451.04,-944.38 8458.04,-944.38"/>
</g>
<!-- layer3_qkv_hg0_ds0 -->
<g id="node113" class="node">
<title>layer3_qkv_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="7210.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7210.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg0_ds0</text>
</g>
<!-- layer3_attn_hg0_ds0 -->
<g id="node114" class="node">
<title>layer3_attn_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="7210.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7210.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg0_ds0</text>
</g>
<!-- layer3_qkv_hg0_ds0&#45;&gt;layer3_attn_hg0_ds0 -->
<g id="edge144" class="edge">
<title>layer3_qkv_hg0_ds0&#45;&gt;layer3_attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M7210.54,-1399.23C7210.54,-1381.56 7210.54,-1353.82 7210.54,-1333.19"/>
<polygon fill="black" stroke="black" points="7214.04,-1333.14 7210.54,-1323.14 7207.04,-1333.14 7214.04,-1333.14"/>
</g>
<!-- layer3_concat_dim_hg0 -->
<g id="node115" class="node">
<title>layer3_concat_dim_hg0</title>
<polygon fill="lightgreen" stroke="black" points="7672.54,-1250 7479.54,-1182 7672.54,-1114 7865.54,-1182 7672.54,-1250"/>
<text text-anchor="middle" x="7672.54" y="-1200.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="7672.54" y="-1185.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="7672.54" y="-1170.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="7672.54" y="-1155.8" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- layer3_attn_hg0_ds0&#45;&gt;layer3_concat_dim_hg0 -->
<g id="edge145" class="edge">
<title>layer3_attn_hg0_ds0&#45;&gt;layer3_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M7265.81,-1289.52C7336.48,-1271.02 7460.77,-1238.46 7553.42,-1214.2"/>
<polygon fill="black" stroke="black" points="7554.34,-1217.57 7563.13,-1211.65 7552.57,-1210.8 7554.34,-1217.57"/>
</g>
<!-- layer3_concat_dim_hg0&#45;&gt;layer3_concat_heads -->
<g id="edge176" class="edge">
<title>layer3_concat_dim_hg0&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M7794.3,-1156.71C7945.16,-1126.62 8199.97,-1075.78 8344.97,-1046.86"/>
<polygon fill="black" stroke="black" points="8345.66,-1050.29 8354.79,-1044.9 8344.29,-1043.42 8345.66,-1050.29"/>
</g>
<!-- layer3_qkv_hg0_ds1 -->
<g id="node116" class="node">
<title>layer3_qkv_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="7441.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7441.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg0_ds1</text>
</g>
<!-- layer3_attn_hg0_ds1 -->
<g id="node117" class="node">
<title>layer3_attn_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="7441.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7441.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg0_ds1</text>
</g>
<!-- layer3_qkv_hg0_ds1&#45;&gt;layer3_attn_hg0_ds1 -->
<g id="edge146" class="edge">
<title>layer3_qkv_hg0_ds1&#45;&gt;layer3_attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M7441.54,-1399.23C7441.54,-1381.56 7441.54,-1353.82 7441.54,-1333.19"/>
<polygon fill="black" stroke="black" points="7445.04,-1333.14 7441.54,-1323.14 7438.04,-1333.14 7445.04,-1333.14"/>
</g>
<!-- layer3_attn_hg0_ds1&#45;&gt;layer3_concat_dim_hg0 -->
<g id="edge147" class="edge">
<title>layer3_attn_hg0_ds1&#45;&gt;layer3_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M7472.69,-1287.68C7501.89,-1272.39 7546.89,-1248.81 7586.81,-1227.91"/>
<polygon fill="black" stroke="black" points="7588.53,-1230.95 7595.77,-1223.21 7585.29,-1224.75 7588.53,-1230.95"/>
</g>
<!-- layer3_qkv_hg0_ds2 -->
<g id="node118" class="node">
<title>layer3_qkv_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="7672.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7672.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg0_ds2</text>
</g>
<!-- layer3_attn_hg0_ds2 -->
<g id="node119" class="node">
<title>layer3_attn_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="7672.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7672.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg0_ds2</text>
</g>
<!-- layer3_qkv_hg0_ds2&#45;&gt;layer3_attn_hg0_ds2 -->
<g id="edge148" class="edge">
<title>layer3_qkv_hg0_ds2&#45;&gt;layer3_attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M7672.54,-1399.23C7672.54,-1381.56 7672.54,-1353.82 7672.54,-1333.19"/>
<polygon fill="black" stroke="black" points="7676.04,-1333.14 7672.54,-1323.14 7669.04,-1333.14 7676.04,-1333.14"/>
</g>
<!-- layer3_attn_hg0_ds2&#45;&gt;layer3_concat_dim_hg0 -->
<g id="edge149" class="edge">
<title>layer3_attn_hg0_ds2&#45;&gt;layer3_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M7672.54,-1286.92C7672.54,-1279.49 7672.54,-1270.22 7672.54,-1260.3"/>
<polygon fill="black" stroke="black" points="7676.04,-1260.2 7672.54,-1250.2 7669.04,-1260.2 7676.04,-1260.2"/>
</g>
<!-- layer3_qkv_hg0_ds3 -->
<g id="node120" class="node">
<title>layer3_qkv_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="7903.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="7903.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg0_ds3</text>
</g>
<!-- layer3_attn_hg0_ds3 -->
<g id="node121" class="node">
<title>layer3_attn_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="7903.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="7903.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg0_ds3</text>
</g>
<!-- layer3_qkv_hg0_ds3&#45;&gt;layer3_attn_hg0_ds3 -->
<g id="edge150" class="edge">
<title>layer3_qkv_hg0_ds3&#45;&gt;layer3_attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M7903.54,-1399.23C7903.54,-1381.56 7903.54,-1353.82 7903.54,-1333.19"/>
<polygon fill="black" stroke="black" points="7907.04,-1333.14 7903.54,-1323.14 7900.04,-1333.14 7907.04,-1333.14"/>
</g>
<!-- layer3_attn_hg0_ds3&#45;&gt;layer3_concat_dim_hg0 -->
<g id="edge151" class="edge">
<title>layer3_attn_hg0_ds3&#45;&gt;layer3_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M7872.39,-1287.68C7843.19,-1272.39 7798.19,-1248.81 7758.27,-1227.91"/>
<polygon fill="black" stroke="black" points="7759.79,-1224.75 7749.31,-1223.21 7756.55,-1230.95 7759.79,-1224.75"/>
</g>
<!-- layer3_qkv_hg1_ds0 -->
<g id="node122" class="node">
<title>layer3_qkv_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="8134.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="8134.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg1_ds0</text>
</g>
<!-- layer3_attn_hg1_ds0 -->
<g id="node123" class="node">
<title>layer3_attn_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="8134.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="8134.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg1_ds0</text>
</g>
<!-- layer3_qkv_hg1_ds0&#45;&gt;layer3_attn_hg1_ds0 -->
<g id="edge152" class="edge">
<title>layer3_qkv_hg1_ds0&#45;&gt;layer3_attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M8134.54,-1399.23C8134.54,-1381.56 8134.54,-1353.82 8134.54,-1333.19"/>
<polygon fill="black" stroke="black" points="8138.04,-1333.14 8134.54,-1323.14 8131.04,-1333.14 8138.04,-1333.14"/>
</g>
<!-- layer3_concat_dim_hg1 -->
<g id="node124" class="node">
<title>layer3_concat_dim_hg1</title>
<polygon fill="lightgreen" stroke="black" points="8454.54,-1250 8261.54,-1182 8454.54,-1114 8647.54,-1182 8454.54,-1250"/>
<text text-anchor="middle" x="8454.54" y="-1200.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="8454.54" y="-1185.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8454.54" y="-1170.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="8454.54" y="-1155.8" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- layer3_attn_hg1_ds0&#45;&gt;layer3_concat_dim_hg1 -->
<g id="edge153" class="edge">
<title>layer3_attn_hg1_ds0&#45;&gt;layer3_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M8176.05,-1288.31C8220.67,-1271.43 8293.27,-1243.98 8353.16,-1221.33"/>
<polygon fill="black" stroke="black" points="8354.54,-1224.55 8362.66,-1217.74 8352.07,-1218.01 8354.54,-1224.55"/>
</g>
<!-- layer3_concat_dim_hg1&#45;&gt;layer3_concat_heads -->
<g id="edge177" class="edge">
<title>layer3_concat_dim_hg1&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M8454.54,-1113.94C8454.54,-1105.15 8454.54,-1096.18 8454.54,-1087.47"/>
<polygon fill="black" stroke="black" points="8458.04,-1087.41 8454.54,-1077.41 8451.04,-1087.41 8458.04,-1087.41"/>
</g>
<!-- layer3_qkv_hg1_ds1 -->
<g id="node125" class="node">
<title>layer3_qkv_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="8365.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="8365.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg1_ds1</text>
</g>
<!-- layer3_attn_hg1_ds1 -->
<g id="node126" class="node">
<title>layer3_attn_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="8365.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="8365.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg1_ds1</text>
</g>
<!-- layer3_qkv_hg1_ds1&#45;&gt;layer3_attn_hg1_ds1 -->
<g id="edge154" class="edge">
<title>layer3_qkv_hg1_ds1&#45;&gt;layer3_attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M8365.54,-1399.23C8365.54,-1381.56 8365.54,-1353.82 8365.54,-1333.19"/>
<polygon fill="black" stroke="black" points="8369.04,-1333.14 8365.54,-1323.14 8362.04,-1333.14 8369.04,-1333.14"/>
</g>
<!-- layer3_attn_hg1_ds1&#45;&gt;layer3_concat_dim_hg1 -->
<g id="edge155" class="edge">
<title>layer3_attn_hg1_ds1&#45;&gt;layer3_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M8378.1,-1286.92C8386.39,-1275.66 8397.79,-1260.16 8409.26,-1244.56"/>
<polygon fill="black" stroke="black" points="8412.15,-1246.55 8415.25,-1236.42 8406.51,-1242.4 8412.15,-1246.55"/>
</g>
<!-- layer3_qkv_hg1_ds2 -->
<g id="node127" class="node">
<title>layer3_qkv_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="8596.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="8596.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg1_ds2</text>
</g>
<!-- layer3_attn_hg1_ds2 -->
<g id="node128" class="node">
<title>layer3_attn_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="8596.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="8596.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg1_ds2</text>
</g>
<!-- layer3_qkv_hg1_ds2&#45;&gt;layer3_attn_hg1_ds2 -->
<g id="edge156" class="edge">
<title>layer3_qkv_hg1_ds2&#45;&gt;layer3_attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M8596.54,-1399.23C8596.54,-1381.56 8596.54,-1353.82 8596.54,-1333.19"/>
<polygon fill="black" stroke="black" points="8600.04,-1333.14 8596.54,-1323.14 8593.04,-1333.14 8600.04,-1333.14"/>
</g>
<!-- layer3_attn_hg1_ds2&#45;&gt;layer3_concat_dim_hg1 -->
<g id="edge157" class="edge">
<title>layer3_attn_hg1_ds2&#45;&gt;layer3_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M8576.8,-1287.18C8561.46,-1274.1 8539.28,-1255.21 8518.02,-1237.09"/>
<polygon fill="black" stroke="black" points="8520.12,-1234.29 8510.24,-1230.46 8515.58,-1239.61 8520.12,-1234.29"/>
</g>
<!-- layer3_qkv_hg1_ds3 -->
<g id="node129" class="node">
<title>layer3_qkv_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="8827.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="8827.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg1_ds3</text>
</g>
<!-- layer3_attn_hg1_ds3 -->
<g id="node130" class="node">
<title>layer3_attn_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="8827.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="8827.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg1_ds3</text>
</g>
<!-- layer3_qkv_hg1_ds3&#45;&gt;layer3_attn_hg1_ds3 -->
<g id="edge158" class="edge">
<title>layer3_qkv_hg1_ds3&#45;&gt;layer3_attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M8827.54,-1399.23C8827.54,-1381.56 8827.54,-1353.82 8827.54,-1333.19"/>
<polygon fill="black" stroke="black" points="8831.04,-1333.14 8827.54,-1323.14 8824.04,-1333.14 8831.04,-1333.14"/>
</g>
<!-- layer3_attn_hg1_ds3&#45;&gt;layer3_concat_dim_hg1 -->
<g id="edge159" class="edge">
<title>layer3_attn_hg1_ds3&#45;&gt;layer3_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M8780.68,-1288.8C8726.47,-1271.21 8635.42,-1241.68 8563.29,-1218.28"/>
<polygon fill="black" stroke="black" points="8564.28,-1214.92 8553.69,-1215.16 8562.12,-1221.58 8564.28,-1214.92"/>
</g>
<!-- layer3_qkv_hg2_ds0 -->
<g id="node131" class="node">
<title>layer3_qkv_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="9058.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="9058.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg2_ds0</text>
</g>
<!-- layer3_attn_hg2_ds0 -->
<g id="node132" class="node">
<title>layer3_attn_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="9058.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="9058.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg2_ds0</text>
</g>
<!-- layer3_qkv_hg2_ds0&#45;&gt;layer3_attn_hg2_ds0 -->
<g id="edge160" class="edge">
<title>layer3_qkv_hg2_ds0&#45;&gt;layer3_attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M9058.54,-1399.23C9058.54,-1381.56 9058.54,-1353.82 9058.54,-1333.19"/>
<polygon fill="black" stroke="black" points="9062.04,-1333.14 9058.54,-1323.14 9055.04,-1333.14 9062.04,-1333.14"/>
</g>
<!-- layer3_concat_dim_hg2 -->
<g id="node133" class="node">
<title>layer3_concat_dim_hg2</title>
<polygon fill="lightgreen" stroke="black" points="9289.54,-1250 9096.54,-1182 9289.54,-1114 9482.54,-1182 9289.54,-1250"/>
<text text-anchor="middle" x="9289.54" y="-1200.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="9289.54" y="-1185.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="9289.54" y="-1170.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="9289.54" y="-1155.8" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- layer3_attn_hg2_ds0&#45;&gt;layer3_concat_dim_hg2 -->
<g id="edge161" class="edge">
<title>layer3_attn_hg2_ds0&#45;&gt;layer3_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M9089.69,-1287.68C9118.89,-1272.39 9163.89,-1248.81 9203.81,-1227.91"/>
<polygon fill="black" stroke="black" points="9205.53,-1230.95 9212.77,-1223.21 9202.29,-1224.75 9205.53,-1230.95"/>
</g>
<!-- layer3_concat_dim_hg2&#45;&gt;layer3_concat_heads -->
<g id="edge178" class="edge">
<title>layer3_concat_dim_hg2&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M9164.98,-1157.73C9002.94,-1127.46 8722.22,-1075.01 8566.58,-1045.93"/>
<polygon fill="black" stroke="black" points="8566.98,-1042.45 8556.51,-1044.05 8565.7,-1049.33 8566.98,-1042.45"/>
</g>
<!-- layer3_qkv_hg2_ds1 -->
<g id="node134" class="node">
<title>layer3_qkv_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="9289.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="9289.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg2_ds1</text>
</g>
<!-- layer3_attn_hg2_ds1 -->
<g id="node135" class="node">
<title>layer3_attn_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="9289.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="9289.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg2_ds1</text>
</g>
<!-- layer3_qkv_hg2_ds1&#45;&gt;layer3_attn_hg2_ds1 -->
<g id="edge162" class="edge">
<title>layer3_qkv_hg2_ds1&#45;&gt;layer3_attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M9289.54,-1399.23C9289.54,-1381.56 9289.54,-1353.82 9289.54,-1333.19"/>
<polygon fill="black" stroke="black" points="9293.04,-1333.14 9289.54,-1323.14 9286.04,-1333.14 9293.04,-1333.14"/>
</g>
<!-- layer3_attn_hg2_ds1&#45;&gt;layer3_concat_dim_hg2 -->
<g id="edge163" class="edge">
<title>layer3_attn_hg2_ds1&#45;&gt;layer3_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M9289.54,-1286.92C9289.54,-1279.49 9289.54,-1270.22 9289.54,-1260.3"/>
<polygon fill="black" stroke="black" points="9293.04,-1260.2 9289.54,-1250.2 9286.04,-1260.2 9293.04,-1260.2"/>
</g>
<!-- layer3_qkv_hg2_ds2 -->
<g id="node136" class="node">
<title>layer3_qkv_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="9520.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="9520.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg2_ds2</text>
</g>
<!-- layer3_attn_hg2_ds2 -->
<g id="node137" class="node">
<title>layer3_attn_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="9520.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="9520.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg2_ds2</text>
</g>
<!-- layer3_qkv_hg2_ds2&#45;&gt;layer3_attn_hg2_ds2 -->
<g id="edge164" class="edge">
<title>layer3_qkv_hg2_ds2&#45;&gt;layer3_attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M9520.54,-1399.23C9520.54,-1381.56 9520.54,-1353.82 9520.54,-1333.19"/>
<polygon fill="black" stroke="black" points="9524.04,-1333.14 9520.54,-1323.14 9517.04,-1333.14 9524.04,-1333.14"/>
</g>
<!-- layer3_attn_hg2_ds2&#45;&gt;layer3_concat_dim_hg2 -->
<g id="edge165" class="edge">
<title>layer3_attn_hg2_ds2&#45;&gt;layer3_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M9489.39,-1287.68C9460.19,-1272.39 9415.19,-1248.81 9375.27,-1227.91"/>
<polygon fill="black" stroke="black" points="9376.79,-1224.75 9366.31,-1223.21 9373.55,-1230.95 9376.79,-1224.75"/>
</g>
<!-- layer3_qkv_hg2_ds3 -->
<g id="node138" class="node">
<title>layer3_qkv_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="9751.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="9751.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg2_ds3</text>
</g>
<!-- layer3_attn_hg2_ds3 -->
<g id="node139" class="node">
<title>layer3_attn_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="9751.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="9751.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg2_ds3</text>
</g>
<!-- layer3_qkv_hg2_ds3&#45;&gt;layer3_attn_hg2_ds3 -->
<g id="edge166" class="edge">
<title>layer3_qkv_hg2_ds3&#45;&gt;layer3_attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M9751.54,-1399.23C9751.54,-1381.56 9751.54,-1353.82 9751.54,-1333.19"/>
<polygon fill="black" stroke="black" points="9755.04,-1333.14 9751.54,-1323.14 9748.04,-1333.14 9755.04,-1333.14"/>
</g>
<!-- layer3_attn_hg2_ds3&#45;&gt;layer3_concat_dim_hg2 -->
<g id="edge167" class="edge">
<title>layer3_attn_hg2_ds3&#45;&gt;layer3_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M9696.27,-1289.52C9625.6,-1271.02 9501.31,-1238.46 9408.66,-1214.2"/>
<polygon fill="black" stroke="black" points="9409.51,-1210.8 9398.95,-1211.65 9407.74,-1217.57 9409.51,-1210.8"/>
</g>
<!-- layer3_qkv_hg3_ds0 -->
<g id="node140" class="node">
<title>layer3_qkv_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="9982.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="9982.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg3_ds0</text>
</g>
<!-- layer3_attn_hg3_ds0 -->
<g id="node141" class="node">
<title>layer3_attn_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="9982.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="9982.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg3_ds0</text>
</g>
<!-- layer3_qkv_hg3_ds0&#45;&gt;layer3_attn_hg3_ds0 -->
<g id="edge168" class="edge">
<title>layer3_qkv_hg3_ds0&#45;&gt;layer3_attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M9982.54,-1399.23C9982.54,-1381.56 9982.54,-1353.82 9982.54,-1333.19"/>
<polygon fill="black" stroke="black" points="9986.04,-1333.14 9982.54,-1323.14 9979.04,-1333.14 9986.04,-1333.14"/>
</g>
<!-- layer3_concat_dim_hg3 -->
<g id="node142" class="node">
<title>layer3_concat_dim_hg3</title>
<polygon fill="lightgreen" stroke="black" points="10213.54,-1250 10020.54,-1182 10213.54,-1114 10406.54,-1182 10213.54,-1250"/>
<text text-anchor="middle" x="10213.54" y="-1200.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="10213.54" y="-1185.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="10213.54" y="-1170.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="10213.54" y="-1155.8" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- layer3_attn_hg3_ds0&#45;&gt;layer3_concat_dim_hg3 -->
<g id="edge169" class="edge">
<title>layer3_attn_hg3_ds0&#45;&gt;layer3_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M10013.69,-1287.68C10042.89,-1272.39 10087.89,-1248.81 10127.81,-1227.91"/>
<polygon fill="black" stroke="black" points="10129.53,-1230.95 10136.77,-1223.21 10126.29,-1224.75 10129.53,-1230.95"/>
</g>
<!-- layer3_concat_dim_hg3&#45;&gt;layer3_concat_heads -->
<g id="edge179" class="edge">
<title>layer3_concat_dim_hg3&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M10063.53,-1166.77C9917.52,-1153 9689.34,-1131.67 9491.54,-1114 9169.8,-1085.26 8791.73,-1053.26 8592.89,-1036.57"/>
<polygon fill="black" stroke="black" points="8592.94,-1033.06 8582.69,-1035.71 8592.36,-1040.04 8592.94,-1033.06"/>
</g>
<!-- layer3_qkv_hg3_ds1 -->
<g id="node143" class="node">
<title>layer3_qkv_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="10213.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10213.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg3_ds1</text>
</g>
<!-- layer3_attn_hg3_ds1 -->
<g id="node144" class="node">
<title>layer3_attn_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="10213.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10213.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg3_ds1</text>
</g>
<!-- layer3_qkv_hg3_ds1&#45;&gt;layer3_attn_hg3_ds1 -->
<g id="edge170" class="edge">
<title>layer3_qkv_hg3_ds1&#45;&gt;layer3_attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M10213.54,-1399.23C10213.54,-1381.56 10213.54,-1353.82 10213.54,-1333.19"/>
<polygon fill="black" stroke="black" points="10217.04,-1333.14 10213.54,-1323.14 10210.04,-1333.14 10217.04,-1333.14"/>
</g>
<!-- layer3_attn_hg3_ds1&#45;&gt;layer3_concat_dim_hg3 -->
<g id="edge171" class="edge">
<title>layer3_attn_hg3_ds1&#45;&gt;layer3_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M10213.54,-1286.92C10213.54,-1279.49 10213.54,-1270.22 10213.54,-1260.3"/>
<polygon fill="black" stroke="black" points="10217.04,-1260.2 10213.54,-1250.2 10210.04,-1260.2 10217.04,-1260.2"/>
</g>
<!-- layer3_qkv_hg3_ds2 -->
<g id="node145" class="node">
<title>layer3_qkv_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="10444.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10444.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg3_ds2</text>
</g>
<!-- layer3_attn_hg3_ds2 -->
<g id="node146" class="node">
<title>layer3_attn_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="10444.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10444.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg3_ds2</text>
</g>
<!-- layer3_qkv_hg3_ds2&#45;&gt;layer3_attn_hg3_ds2 -->
<g id="edge172" class="edge">
<title>layer3_qkv_hg3_ds2&#45;&gt;layer3_attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M10444.54,-1399.23C10444.54,-1381.56 10444.54,-1353.82 10444.54,-1333.19"/>
<polygon fill="black" stroke="black" points="10448.04,-1333.14 10444.54,-1323.14 10441.04,-1333.14 10448.04,-1333.14"/>
</g>
<!-- layer3_attn_hg3_ds2&#45;&gt;layer3_concat_dim_hg3 -->
<g id="edge173" class="edge">
<title>layer3_attn_hg3_ds2&#45;&gt;layer3_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M10413.39,-1287.68C10384.19,-1272.39 10339.19,-1248.81 10299.27,-1227.91"/>
<polygon fill="black" stroke="black" points="10300.79,-1224.75 10290.31,-1223.21 10297.55,-1230.95 10300.79,-1224.75"/>
</g>
<!-- layer3_qkv_hg3_ds3 -->
<g id="node147" class="node">
<title>layer3_qkv_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="10675.54" cy="-1417.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10675.54" y="-1413.8" font-family="Times,serif" font-size="14.00">layer3_qkv_hg3_ds3</text>
</g>
<!-- layer3_attn_hg3_ds3 -->
<g id="node148" class="node">
<title>layer3_attn_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="10675.54" cy="-1305" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10675.54" y="-1301.3" font-family="Times,serif" font-size="14.00">layer3_attn_hg3_ds3</text>
</g>
<!-- layer3_qkv_hg3_ds3&#45;&gt;layer3_attn_hg3_ds3 -->
<g id="edge174" class="edge">
<title>layer3_qkv_hg3_ds3&#45;&gt;layer3_attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M10675.54,-1399.23C10675.54,-1381.56 10675.54,-1353.82 10675.54,-1333.19"/>
<polygon fill="black" stroke="black" points="10679.04,-1333.14 10675.54,-1323.14 10672.04,-1333.14 10679.04,-1333.14"/>
</g>
<!-- layer3_attn_hg3_ds3&#45;&gt;layer3_concat_dim_hg3 -->
<g id="edge175" class="edge">
<title>layer3_attn_hg3_ds3&#45;&gt;layer3_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M10620.27,-1289.52C10549.6,-1271.02 10425.31,-1238.46 10332.66,-1214.2"/>
<polygon fill="black" stroke="black" points="10333.51,-1210.8 10322.95,-1211.65 10331.74,-1217.57 10333.51,-1210.8"/>
</g>
<!-- layer3_expert0_gpu0 -->
<g id="node150" class="node">
<title>layer3_expert0_gpu0</title>
<ellipse fill="none" stroke="black" cx="6574.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="6574.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert0_gpu0</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert0_gpu0 -->
<g id="edge181" class="edge">
<title>layer3_router&#45;&gt;layer3_expert0_gpu0</title>
<path fill="none" stroke="black" d="M8355.26,-887.3C8121.97,-881.7 7520.71,-864.75 7019.54,-829 6873.4,-818.58 6836.96,-813.87 6691.54,-796 6681.84,-794.81 6671.7,-793.47 6661.61,-792.08"/>
<polygon fill="black" stroke="black" points="6661.96,-788.6 6651.57,-790.68 6660.99,-795.53 6661.96,-788.6"/>
<text text-anchor="middle" x="7051.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer3_expert0_gpu1 -->
<g id="node151" class="node">
<title>layer3_expert0_gpu1</title>
<ellipse fill="none" stroke="black" cx="6809.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="6809.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert0_gpu1</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert0_gpu1 -->
<g id="edge182" class="edge">
<title>layer3_router&#45;&gt;layer3_expert0_gpu1</title>
<path fill="none" stroke="black" d="M8356.38,-886.15C8151.95,-878.81 7665.67,-859.51 7258.54,-829 7110.67,-817.92 7073.73,-814 6926.54,-796 6916.84,-794.81 6906.7,-793.48 6896.61,-792.1"/>
<polygon fill="black" stroke="black" points="6896.96,-788.61 6886.57,-790.7 6895.99,-795.54 6896.96,-788.61"/>
<text text-anchor="middle" x="7290.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer3_expert1_gpu2 -->
<g id="node152" class="node">
<title>layer3_expert1_gpu2</title>
<ellipse fill="none" stroke="black" cx="7044.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="7044.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert1_gpu2</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert1_gpu2 -->
<g id="edge183" class="edge">
<title>layer3_router&#45;&gt;layer3_expert1_gpu2</title>
<path fill="none" stroke="black" d="M8358.42,-884.46C8186.43,-875.21 7814.7,-854.13 7501.54,-829 7350.21,-816.86 7312.26,-814.25 7161.54,-796 7151.84,-794.82 7141.69,-793.5 7131.61,-792.12"/>
<polygon fill="black" stroke="black" points="7131.95,-788.63 7121.57,-790.72 7130.99,-795.57 7131.95,-788.63"/>
<text text-anchor="middle" x="7533.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer3_expert1_gpu3 -->
<g id="node153" class="node">
<title>layer3_expert1_gpu3</title>
<ellipse fill="none" stroke="black" cx="7279.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="7279.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert1_gpu3</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert1_gpu3 -->
<g id="edge184" class="edge">
<title>layer3_router&#45;&gt;layer3_expert1_gpu3</title>
<path fill="none" stroke="black" d="M8359.83,-883.34C8174.46,-870.79 7750.89,-839.71 7396.54,-796 7386.91,-794.81 7376.86,-793.48 7366.85,-792.11"/>
<polygon fill="black" stroke="black" points="7367.27,-788.63 7356.89,-790.72 7366.31,-795.57 7367.27,-788.63"/>
<text text-anchor="middle" x="7717.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer3_expert2_gpu4 -->
<g id="node154" class="node">
<title>layer3_expert2_gpu4</title>
<ellipse fill="none" stroke="black" cx="7514.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="7514.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert2_gpu4</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert2_gpu4 -->
<g id="edge185" class="edge">
<title>layer3_router&#45;&gt;layer3_expert2_gpu4</title>
<path fill="none" stroke="black" d="M8363.38,-880.22C8211.44,-864.51 7896.9,-830.96 7631.54,-796 7622.1,-794.76 7612.24,-793.4 7602.42,-792.03"/>
<polygon fill="black" stroke="black" points="7602.62,-788.52 7592.22,-790.58 7601.64,-795.45 7602.62,-788.52"/>
<text text-anchor="middle" x="7911.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer3_expert2_gpu5 -->
<g id="node155" class="node">
<title>layer3_expert2_gpu5</title>
<ellipse fill="none" stroke="black" cx="7749.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="7749.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert2_gpu5</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert2_gpu5 -->
<g id="edge186" class="edge">
<title>layer3_router&#45;&gt;layer3_expert2_gpu5</title>
<path fill="none" stroke="black" d="M8368.45,-876.01C8232.81,-854.75 7970.9,-813.69 7835.4,-792.46"/>
<polygon fill="black" stroke="black" points="7835.89,-788.99 7825.47,-790.9 7834.81,-795.91 7835.89,-788.99"/>
<text text-anchor="middle" x="8091.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer3_expert3_gpu6 -->
<g id="node156" class="node">
<title>layer3_expert3_gpu6</title>
<ellipse fill="none" stroke="black" cx="7984.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="7984.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert3_gpu6</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert3_gpu6 -->
<g id="edge187" class="edge">
<title>layer3_router&#45;&gt;layer3_expert3_gpu6</title>
<path fill="none" stroke="black" d="M8374.81,-870.76C8284.87,-849.61 8140.02,-815.55 8054.37,-795.42"/>
<polygon fill="black" stroke="black" points="8055.02,-791.97 8044.48,-793.09 8053.41,-798.79 8055.02,-791.97"/>
<text text-anchor="middle" x="8222.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer3_expert3_gpu7 -->
<g id="node157" class="node">
<title>layer3_expert3_gpu7</title>
<ellipse fill="none" stroke="black" cx="8219.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="8219.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert3_gpu7</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert3_gpu7 -->
<g id="edge188" class="edge">
<title>layer3_router&#45;&gt;layer3_expert3_gpu7</title>
<path fill="none" stroke="black" d="M8389.08,-858.72C8348.81,-839.79 8298.32,-816.05 8262.96,-799.42"/>
<polygon fill="black" stroke="black" points="8264.4,-796.22 8253.86,-795.14 8261.42,-802.56 8264.4,-796.22"/>
<text text-anchor="middle" x="8354.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer3_expert4_gpu8 -->
<g id="node158" class="node">
<title>layer3_expert4_gpu8</title>
<ellipse fill="none" stroke="black" cx="8454.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="8454.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert4_gpu8</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert4_gpu8 -->
<g id="edge189" class="edge">
<title>layer3_router&#45;&gt;layer3_expert4_gpu8</title>
<path fill="none" stroke="black" d="M8454.54,-846.78C8454.54,-833.16 8454.54,-818.46 8454.54,-806.25"/>
<polygon fill="black" stroke="black" points="8458.04,-806.24 8454.54,-796.24 8451.04,-806.24 8458.04,-806.24"/>
<text text-anchor="middle" x="8486.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer3_expert4_gpu9 -->
<g id="node159" class="node">
<title>layer3_expert4_gpu9</title>
<ellipse fill="none" stroke="black" cx="8689.54" cy="-778" rx="108.58" ry="18"/>
<text text-anchor="middle" x="8689.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert4_gpu9</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert4_gpu9 -->
<g id="edge190" class="edge">
<title>layer3_router&#45;&gt;layer3_expert4_gpu9</title>
<path fill="none" stroke="black" d="M8520,-858.72C8560.27,-839.79 8610.76,-816.05 8646.12,-799.42"/>
<polygon fill="black" stroke="black" points="8647.66,-802.56 8655.22,-795.14 8644.68,-796.22 8647.66,-802.56"/>
<text text-anchor="middle" x="8644.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer3_expert5_gpu10 -->
<g id="node160" class="node">
<title>layer3_expert5_gpu10</title>
<ellipse fill="none" stroke="black" cx="8930.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="8930.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert5_gpu10</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert5_gpu10 -->
<g id="edge191" class="edge">
<title>layer3_router&#45;&gt;layer3_expert5_gpu10</title>
<path fill="none" stroke="black" d="M8534.48,-870.94C8625.38,-849.84 8772.42,-815.71 8859.47,-795.5"/>
<polygon fill="black" stroke="black" points="8860.31,-798.9 8869.26,-793.23 8858.72,-792.08 8860.31,-798.9"/>
<text text-anchor="middle" x="8808.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer3_expert5_gpu11 -->
<g id="node161" class="node">
<title>layer3_expert5_gpu11</title>
<ellipse fill="none" stroke="black" cx="9177.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="9177.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert5_gpu11</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert5_gpu11 -->
<g id="edge192" class="edge">
<title>layer3_router&#45;&gt;layer3_expert5_gpu11</title>
<path fill="none" stroke="black" d="M8541.03,-876.28C8679.26,-855.16 8948.57,-814 9088.43,-792.62"/>
<polygon fill="black" stroke="black" points="9089.32,-796.02 9098.68,-791.05 9088.27,-789.1 9089.32,-796.02"/>
<text text-anchor="middle" x="8975.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer3_expert6_gpu12 -->
<g id="node162" class="node">
<title>layer3_expert6_gpu12</title>
<ellipse fill="none" stroke="black" cx="9424.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="9424.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert6_gpu12</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert6_gpu12 -->
<g id="edge193" class="edge">
<title>layer3_router&#45;&gt;layer3_expert6_gpu12</title>
<path fill="none" stroke="black" d="M8545.83,-880.34C8701.19,-864.55 9026.87,-830.55 9301.54,-796 9311.59,-794.74 9322.09,-793.36 9332.55,-791.96"/>
<polygon fill="black" stroke="black" points="9333.09,-795.42 9342.54,-790.62 9332.16,-788.49 9333.09,-795.42"/>
<text text-anchor="middle" x="9171.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer3_expert6_gpu13 -->
<g id="node163" class="node">
<title>layer3_expert6_gpu13</title>
<ellipse fill="none" stroke="black" cx="9671.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="9671.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert6_gpu13</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert6_gpu13 -->
<g id="edge194" class="edge">
<title>layer3_router&#45;&gt;layer3_expert6_gpu13</title>
<path fill="none" stroke="black" d="M8549.5,-883.41C8739.54,-870.77 9180.07,-839.22 9548.54,-796 9558.76,-794.8 9569.45,-793.46 9580.07,-792.07"/>
<polygon fill="black" stroke="black" points="9580.77,-795.5 9590.22,-790.72 9579.85,-788.57 9580.77,-795.5"/>
<text text-anchor="middle" x="9401.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer3_expert7_gpu14 -->
<g id="node164" class="node">
<title>layer3_expert7_gpu14</title>
<ellipse fill="none" stroke="black" cx="9918.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="9918.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert7_gpu14</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert7_gpu14 -->
<g id="edge195" class="edge">
<title>layer3_router&#45;&gt;layer3_expert7_gpu14</title>
<path fill="none" stroke="black" d="M8550.78,-884.54C8726.74,-875.24 9112.1,-853.9 9436.54,-829 9596.3,-816.74 9636.36,-814.31 9795.54,-796 9805.85,-794.81 9816.62,-793.47 9827.33,-792.08"/>
<polygon fill="black" stroke="black" points="9828.1,-795.51 9837.56,-790.73 9827.19,-788.57 9828.1,-795.51"/>
<text text-anchor="middle" x="9653.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer3_expert7_gpu15 -->
<g id="node165" class="node">
<title>layer3_expert7_gpu15</title>
<ellipse fill="none" stroke="black" cx="10165.54" cy="-778" rx="114.5" ry="18"/>
<text text-anchor="middle" x="10165.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer3_expert7_gpu15</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert7_gpu15 -->
<g id="edge196" class="edge">
<title>layer3_router&#45;&gt;layer3_expert7_gpu15</title>
<path fill="none" stroke="black" d="M8552.61,-886.16C8761.6,-878.71 9266.25,-859.02 9688.54,-829 9846.16,-817.8 9885.57,-814.15 10042.54,-796 10052.76,-794.82 10063.45,-793.48 10074.08,-792.1"/>
<polygon fill="black" stroke="black" points="10074.77,-795.54 10084.23,-790.76 10073.85,-788.6 10074.77,-795.54"/>
<text text-anchor="middle" x="9903.04" y="-817.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer3_expert_concat -->
<g id="node166" class="node">
<title>layer3_expert_concat</title>
<polygon fill="lightyellow" stroke="black" points="8513.54,-708 8355.54,-655 8513.54,-602 8671.54,-655 8513.54,-708"/>
<text text-anchor="middle" x="8513.54" y="-666.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8513.54" y="-651.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="8513.54" y="-636.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_concat -->
<g id="edge197" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8555.09,-888.25C8930.39,-883.08 10230.77,-860.55 10289.54,-796 10300.31,-784.17 10300.52,-771.64 10289.54,-760 10234.34,-701.48 9092.39,-669.32 8669.37,-659.38"/>
<polygon fill="black" stroke="black" points="8669.28,-655.88 8659.2,-659.15 8669.12,-662.88 8669.28,-655.88"/>
</g>
<!-- layer3_expert0_gpu0&#45;&gt;layer3_expert_concat -->
<g id="edge198" class="edge">
<title>layer3_expert0_gpu0&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M6650.26,-765.01C6663.97,-763.12 6678.16,-761.35 6691.54,-760 7308.02,-697.74 8045.89,-669.91 8359.92,-660.24"/>
<polygon fill="black" stroke="black" points="8360.11,-663.74 8370,-659.93 8359.9,-656.74 8360.11,-663.74"/>
</g>
<!-- layer3_expert0_gpu1&#45;&gt;layer3_expert_concat -->
<g id="edge199" class="edge">
<title>layer3_expert0_gpu1&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M6885.58,-765.06C6899.2,-763.18 6913.27,-761.4 6926.54,-760 7453.6,-704.53 8082.45,-673.77 8364.16,-661.86"/>
<polygon fill="black" stroke="black" points="8364.6,-665.34 8374.45,-661.42 8364.31,-658.35 8364.6,-665.34"/>
</g>
<!-- layer3_expert1_gpu2&#45;&gt;layer3_expert_concat -->
<g id="edge200" class="edge">
<title>layer3_expert1_gpu2&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M7120.91,-765.15C7134.43,-763.26 7148.38,-761.46 7161.54,-760 7600.6,-711.27 8122.42,-678.1 8369.76,-663.86"/>
<polygon fill="black" stroke="black" points="8370.11,-667.35 8379.89,-663.28 8369.71,-660.36 8370.11,-667.35"/>
</g>
<!-- layer3_expert1_gpu3&#45;&gt;layer3_expert_concat -->
<g id="edge201" class="edge">
<title>layer3_expert1_gpu3&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M7356.56,-765.23C7369.88,-763.36 7383.6,-761.54 7396.54,-760 7749.03,-718.01 8165.81,-683.09 8376.65,-666.46"/>
<polygon fill="black" stroke="black" points="8377.15,-669.93 8386.84,-665.66 8376.6,-662.96 8377.15,-669.93"/>
</g>
<!-- layer3_expert2_gpu4&#45;&gt;layer3_expert_concat -->
<g id="edge202" class="edge">
<title>layer3_expert2_gpu4&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M7592.22,-765.41C7605.34,-763.54 7618.82,-761.67 7631.54,-760 7899.83,-724.7 8214.8,-688.92 8386.35,-669.91"/>
<polygon fill="black" stroke="black" points="8386.87,-673.37 8396.43,-668.79 8386.1,-666.42 8386.87,-673.37"/>
</g>
<!-- layer3_expert2_gpu5&#45;&gt;layer3_expert_concat -->
<g id="edge203" class="edge">
<title>layer3_expert2_gpu5&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M7825.24,-765.01C7959.31,-743.78 8239.29,-699.43 8397.74,-674.34"/>
<polygon fill="black" stroke="black" points="8398.67,-677.74 8408,-672.71 8397.58,-670.82 8398.67,-677.74"/>
</g>
<!-- layer3_expert3_gpu6&#45;&gt;layer3_expert_concat -->
<g id="edge204" class="edge">
<title>layer3_expert3_gpu6&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M8045.48,-763.06C8134.92,-742.6 8302.87,-704.19 8411.38,-679.37"/>
<polygon fill="black" stroke="black" points="8412.39,-682.73 8421.36,-677.08 8410.83,-675.9 8412.39,-682.73"/>
</g>
<!-- layer3_expert3_gpu7&#45;&gt;layer3_expert_concat -->
<g id="edge205" class="edge">
<title>layer3_expert3_gpu7&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M8258.28,-761.06C8302.88,-742.7 8377.33,-712.06 8434.35,-688.59"/>
<polygon fill="black" stroke="black" points="8435.79,-691.78 8443.7,-684.74 8433.13,-685.31 8435.79,-691.78"/>
</g>
<!-- layer3_expert4_gpu8&#45;&gt;layer3_expert_concat -->
<g id="edge206" class="edge">
<title>layer3_expert4_gpu8&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M8462.87,-759.92C8469.23,-746.88 8478.35,-728.16 8487.12,-710.19"/>
<polygon fill="black" stroke="black" points="8490.41,-711.42 8491.65,-700.9 8484.12,-708.35 8490.41,-711.42"/>
</g>
<!-- layer3_expert4_gpu9&#45;&gt;layer3_expert_concat -->
<g id="edge207" class="edge">
<title>layer3_expert4_gpu9&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M8665.44,-760.43C8641.67,-744.09 8604.42,-718.48 8572.75,-696.71"/>
<polygon fill="black" stroke="black" points="8574.63,-693.75 8564.41,-690.97 8570.66,-699.52 8574.63,-693.75"/>
</g>
<!-- layer3_expert5_gpu10&#45;&gt;layer3_expert_concat -->
<g id="edge208" class="edge">
<title>layer3_expert5_gpu10&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M8878.57,-761.92C8810.63,-742.21 8690.44,-707.33 8606.6,-683"/>
<polygon fill="black" stroke="black" points="8607.4,-679.59 8596.82,-680.17 8605.45,-686.31 8607.4,-679.59"/>
</g>
<!-- layer3_expert5_gpu11&#45;&gt;layer3_expert_concat -->
<g id="edge209" class="edge">
<title>layer3_expert5_gpu11&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M9105.85,-763.94C8990.04,-742.83 8760.97,-701.09 8624.13,-676.15"/>
<polygon fill="black" stroke="black" points="8624.5,-672.66 8614.03,-674.31 8623.24,-679.55 8624.5,-672.66"/>
</g>
<!-- layer3_expert6_gpu12&#45;&gt;layer3_expert_concat -->
<g id="edge210" class="edge">
<title>layer3_expert6_gpu12&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M9341.85,-765.5C9328.38,-763.65 9314.57,-761.76 9301.54,-760 9065.86,-728.16 8790.38,-692.06 8635.49,-671.86"/>
<polygon fill="black" stroke="black" points="8635.84,-668.38 8625.47,-670.55 8634.93,-675.32 8635.84,-668.38"/>
</g>
<!-- layer3_expert6_gpu13&#45;&gt;layer3_expert_concat -->
<g id="edge211" class="edge">
<title>layer3_expert6_gpu13&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M9590.22,-765.33C9576.32,-763.46 9562.03,-761.61 9548.54,-760 9225.11,-721.41 8843.66,-685.57 8646.5,-667.77"/>
<polygon fill="black" stroke="black" points="8646.66,-664.27 8636.38,-666.85 8646.03,-671.24 8646.66,-664.27"/>
</g>
<!-- layer3_expert7_gpu14&#45;&gt;layer3_expert_concat -->
<g id="edge212" class="edge">
<title>layer3_expert7_gpu14&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M9837.9,-765.19C9823.8,-763.32 9809.25,-761.5 9795.54,-760 9381.68,-714.65 8890.64,-680.19 8654.37,-664.82"/>
<polygon fill="black" stroke="black" points="8654.55,-661.32 8644.34,-664.17 8654.1,-668.31 8654.55,-661.32"/>
</g>
<!-- layer3_expert7_gpu15&#45;&gt;layer3_expert_concat -->
<g id="edge213" class="edge">
<title>layer3_expert7_gpu15&#45;&gt;layer3_expert_concat</title>
<path fill="none" stroke="black" d="M10085.25,-765.08C10071.04,-763.21 10056.37,-761.42 10042.54,-760 9536.59,-707.89 8933.66,-675.61 8660.72,-662.61"/>
<polygon fill="black" stroke="black" points="8660.51,-659.09 8650.35,-662.11 8660.18,-666.08 8660.51,-659.09"/>
</g>
<!-- layer4_concat_heads -->
<g id="node167" class="node">
<title>layer4_concat_heads</title>
<polygon fill="orange" stroke="black" points="11713.54,-550 11549.54,-497 11713.54,-444 11877.54,-497 11713.54,-550"/>
<text text-anchor="middle" x="11713.54" y="-508.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="11713.54" y="-493.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="11713.54" y="-478.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_expert_concat&#45;&gt;layer4_concat_heads -->
<g id="edge214" class="edge">
<title>layer3_expert_concat&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M8649,-647.4C9167.03,-622.14 11020.73,-531.77 11563.32,-505.32"/>
<polygon fill="black" stroke="black" points="11563.74,-508.81 11573.56,-504.82 11563.4,-501.82 11563.74,-508.81"/>
</g>
<!-- layer4_router -->
<g id="node204" class="node">
<title>layer4_router</title>
<polygon fill="lightpink" stroke="black" points="11816.54,-363.5 11765.04,-407 11662.04,-407 11610.54,-363.5 11662.04,-320 11765.04,-320 11816.54,-363.5"/>
<text text-anchor="middle" x="11713.54" y="-374.8" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="11713.54" y="-359.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8]</text>
<text text-anchor="middle" x="11713.54" y="-344.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_router -->
<g id="edge251" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_router</title>
<path fill="none" stroke="black" d="M11713.54,-443.65C11713.54,-435.1 11713.54,-426.22 11713.54,-417.65"/>
<polygon fill="black" stroke="black" points="11717.04,-417.38 11713.54,-407.38 11710.04,-417.38 11717.04,-417.38"/>
</g>
<!-- layer4_qkv_hg0_ds0 -->
<g id="node168" class="node">
<title>layer4_qkv_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="10443.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10443.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg0_ds0</text>
</g>
<!-- layer4_attn_hg0_ds0 -->
<g id="node169" class="node">
<title>layer4_attn_hg0_ds0</title>
<ellipse fill="none" stroke="black" cx="10443.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10443.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg0_ds0</text>
</g>
<!-- layer4_qkv_hg0_ds0&#45;&gt;layer4_attn_hg0_ds0 -->
<g id="edge215" class="edge">
<title>layer4_qkv_hg0_ds0&#45;&gt;layer4_attn_hg0_ds0</title>
<path fill="none" stroke="black" d="M10443.54,-872.23C10443.54,-854.56 10443.54,-826.82 10443.54,-806.19"/>
<polygon fill="black" stroke="black" points="10447.04,-806.14 10443.54,-796.14 10440.04,-806.14 10447.04,-806.14"/>
</g>
<!-- layer4_concat_dim_hg0 -->
<g id="node170" class="node">
<title>layer4_concat_dim_hg0</title>
<polygon fill="lightgreen" stroke="black" points="10905.54,-723 10712.54,-655 10905.54,-587 11098.54,-655 10905.54,-723"/>
<text text-anchor="middle" x="10905.54" y="-673.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="10905.54" y="-658.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10905.54" y="-643.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="10905.54" y="-628.8" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- layer4_attn_hg0_ds0&#45;&gt;layer4_concat_dim_hg0 -->
<g id="edge216" class="edge">
<title>layer4_attn_hg0_ds0&#45;&gt;layer4_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M10498.81,-762.52C10569.48,-744.02 10693.77,-711.46 10786.42,-687.2"/>
<polygon fill="black" stroke="black" points="10787.34,-690.57 10796.13,-684.65 10785.57,-683.8 10787.34,-690.57"/>
</g>
<!-- layer4_concat_dim_hg0&#45;&gt;layer4_concat_heads -->
<g id="edge247" class="edge">
<title>layer4_concat_dim_hg0&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M11028.7,-630.22C11184.92,-600.06 11452.04,-548.49 11602.34,-519.47"/>
<polygon fill="black" stroke="black" points="11603.36,-522.84 11612.51,-517.51 11602.03,-515.96 11603.36,-522.84"/>
</g>
<!-- layer4_qkv_hg0_ds1 -->
<g id="node171" class="node">
<title>layer4_qkv_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="10674.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10674.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg0_ds1</text>
</g>
<!-- layer4_attn_hg0_ds1 -->
<g id="node172" class="node">
<title>layer4_attn_hg0_ds1</title>
<ellipse fill="none" stroke="black" cx="10674.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10674.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg0_ds1</text>
</g>
<!-- layer4_qkv_hg0_ds1&#45;&gt;layer4_attn_hg0_ds1 -->
<g id="edge217" class="edge">
<title>layer4_qkv_hg0_ds1&#45;&gt;layer4_attn_hg0_ds1</title>
<path fill="none" stroke="black" d="M10674.54,-872.23C10674.54,-854.56 10674.54,-826.82 10674.54,-806.19"/>
<polygon fill="black" stroke="black" points="10678.04,-806.14 10674.54,-796.14 10671.04,-806.14 10678.04,-806.14"/>
</g>
<!-- layer4_attn_hg0_ds1&#45;&gt;layer4_concat_dim_hg0 -->
<g id="edge218" class="edge">
<title>layer4_attn_hg0_ds1&#45;&gt;layer4_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M10705.69,-760.68C10734.89,-745.39 10779.89,-721.81 10819.81,-700.91"/>
<polygon fill="black" stroke="black" points="10821.53,-703.95 10828.77,-696.21 10818.29,-697.75 10821.53,-703.95"/>
</g>
<!-- layer4_qkv_hg0_ds2 -->
<g id="node173" class="node">
<title>layer4_qkv_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="10905.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="10905.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg0_ds2</text>
</g>
<!-- layer4_attn_hg0_ds2 -->
<g id="node174" class="node">
<title>layer4_attn_hg0_ds2</title>
<ellipse fill="none" stroke="black" cx="10905.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="10905.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg0_ds2</text>
</g>
<!-- layer4_qkv_hg0_ds2&#45;&gt;layer4_attn_hg0_ds2 -->
<g id="edge219" class="edge">
<title>layer4_qkv_hg0_ds2&#45;&gt;layer4_attn_hg0_ds2</title>
<path fill="none" stroke="black" d="M10905.54,-872.23C10905.54,-854.56 10905.54,-826.82 10905.54,-806.19"/>
<polygon fill="black" stroke="black" points="10909.04,-806.14 10905.54,-796.14 10902.04,-806.14 10909.04,-806.14"/>
</g>
<!-- layer4_attn_hg0_ds2&#45;&gt;layer4_concat_dim_hg0 -->
<g id="edge220" class="edge">
<title>layer4_attn_hg0_ds2&#45;&gt;layer4_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M10905.54,-759.92C10905.54,-752.49 10905.54,-743.22 10905.54,-733.3"/>
<polygon fill="black" stroke="black" points="10909.04,-733.2 10905.54,-723.2 10902.04,-733.2 10909.04,-733.2"/>
</g>
<!-- layer4_qkv_hg0_ds3 -->
<g id="node175" class="node">
<title>layer4_qkv_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="11136.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="11136.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg0_ds3</text>
</g>
<!-- layer4_attn_hg0_ds3 -->
<g id="node176" class="node">
<title>layer4_attn_hg0_ds3</title>
<ellipse fill="none" stroke="black" cx="11136.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="11136.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg0_ds3</text>
</g>
<!-- layer4_qkv_hg0_ds3&#45;&gt;layer4_attn_hg0_ds3 -->
<g id="edge221" class="edge">
<title>layer4_qkv_hg0_ds3&#45;&gt;layer4_attn_hg0_ds3</title>
<path fill="none" stroke="black" d="M11136.54,-872.23C11136.54,-854.56 11136.54,-826.82 11136.54,-806.19"/>
<polygon fill="black" stroke="black" points="11140.04,-806.14 11136.54,-796.14 11133.04,-806.14 11140.04,-806.14"/>
</g>
<!-- layer4_attn_hg0_ds3&#45;&gt;layer4_concat_dim_hg0 -->
<g id="edge222" class="edge">
<title>layer4_attn_hg0_ds3&#45;&gt;layer4_concat_dim_hg0</title>
<path fill="none" stroke="black" d="M11105.39,-760.68C11076.19,-745.39 11031.19,-721.81 10991.27,-700.91"/>
<polygon fill="black" stroke="black" points="10992.79,-697.75 10982.31,-696.21 10989.55,-703.95 10992.79,-697.75"/>
</g>
<!-- layer4_qkv_hg1_ds0 -->
<g id="node177" class="node">
<title>layer4_qkv_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="11367.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="11367.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg1_ds0</text>
</g>
<!-- layer4_attn_hg1_ds0 -->
<g id="node178" class="node">
<title>layer4_attn_hg1_ds0</title>
<ellipse fill="none" stroke="black" cx="11367.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="11367.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg1_ds0</text>
</g>
<!-- layer4_qkv_hg1_ds0&#45;&gt;layer4_attn_hg1_ds0 -->
<g id="edge223" class="edge">
<title>layer4_qkv_hg1_ds0&#45;&gt;layer4_attn_hg1_ds0</title>
<path fill="none" stroke="black" d="M11367.54,-872.23C11367.54,-854.56 11367.54,-826.82 11367.54,-806.19"/>
<polygon fill="black" stroke="black" points="11371.04,-806.14 11367.54,-796.14 11364.04,-806.14 11371.04,-806.14"/>
</g>
<!-- layer4_concat_dim_hg1 -->
<g id="node179" class="node">
<title>layer4_concat_dim_hg1</title>
<polygon fill="lightgreen" stroke="black" points="11713.54,-723 11520.54,-655 11713.54,-587 11906.54,-655 11713.54,-723"/>
<text text-anchor="middle" x="11713.54" y="-673.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="11713.54" y="-658.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11713.54" y="-643.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="11713.54" y="-628.8" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- layer4_attn_hg1_ds0&#45;&gt;layer4_concat_dim_hg1 -->
<g id="edge224" class="edge">
<title>layer4_attn_hg1_ds0&#45;&gt;layer4_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M11411.71,-761.55C11461.03,-744.31 11542.56,-715.79 11608.46,-692.75"/>
<polygon fill="black" stroke="black" points="11609.78,-695.99 11618.07,-689.39 11607.47,-689.39 11609.78,-695.99"/>
</g>
<!-- layer4_concat_dim_hg1&#45;&gt;layer4_concat_heads -->
<g id="edge248" class="edge">
<title>layer4_concat_dim_hg1&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M11713.54,-586.94C11713.54,-578.15 11713.54,-569.18 11713.54,-560.47"/>
<polygon fill="black" stroke="black" points="11717.04,-560.41 11713.54,-550.41 11710.04,-560.41 11717.04,-560.41"/>
</g>
<!-- layer4_qkv_hg1_ds1 -->
<g id="node180" class="node">
<title>layer4_qkv_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="11598.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="11598.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg1_ds1</text>
</g>
<!-- layer4_attn_hg1_ds1 -->
<g id="node181" class="node">
<title>layer4_attn_hg1_ds1</title>
<ellipse fill="none" stroke="black" cx="11598.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="11598.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg1_ds1</text>
</g>
<!-- layer4_qkv_hg1_ds1&#45;&gt;layer4_attn_hg1_ds1 -->
<g id="edge225" class="edge">
<title>layer4_qkv_hg1_ds1&#45;&gt;layer4_attn_hg1_ds1</title>
<path fill="none" stroke="black" d="M11598.54,-872.23C11598.54,-854.56 11598.54,-826.82 11598.54,-806.19"/>
<polygon fill="black" stroke="black" points="11602.04,-806.14 11598.54,-796.14 11595.04,-806.14 11602.04,-806.14"/>
</g>
<!-- layer4_attn_hg1_ds1&#45;&gt;layer4_concat_dim_hg1 -->
<g id="edge226" class="edge">
<title>layer4_attn_hg1_ds1&#45;&gt;layer4_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M11614.53,-760.18C11626.14,-747.96 11642.59,-730.66 11658.75,-713.65"/>
<polygon fill="black" stroke="black" points="11661.29,-716.06 11665.64,-706.4 11656.21,-711.24 11661.29,-716.06"/>
</g>
<!-- layer4_qkv_hg1_ds2 -->
<g id="node182" class="node">
<title>layer4_qkv_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="11829.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="11829.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg1_ds2</text>
</g>
<!-- layer4_attn_hg1_ds2 -->
<g id="node183" class="node">
<title>layer4_attn_hg1_ds2</title>
<ellipse fill="none" stroke="black" cx="11829.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="11829.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg1_ds2</text>
</g>
<!-- layer4_qkv_hg1_ds2&#45;&gt;layer4_attn_hg1_ds2 -->
<g id="edge227" class="edge">
<title>layer4_qkv_hg1_ds2&#45;&gt;layer4_attn_hg1_ds2</title>
<path fill="none" stroke="black" d="M11829.54,-872.23C11829.54,-854.56 11829.54,-826.82 11829.54,-806.19"/>
<polygon fill="black" stroke="black" points="11833.04,-806.14 11829.54,-796.14 11826.04,-806.14 11833.04,-806.14"/>
</g>
<!-- layer4_attn_hg1_ds2&#45;&gt;layer4_concat_dim_hg1 -->
<g id="edge228" class="edge">
<title>layer4_attn_hg1_ds2&#45;&gt;layer4_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M11813.41,-760.18C11801.65,-747.9 11784.96,-730.49 11768.58,-713.42"/>
<polygon fill="black" stroke="black" points="11771.05,-710.93 11761.6,-706.13 11766,-715.77 11771.05,-710.93"/>
</g>
<!-- layer4_qkv_hg1_ds3 -->
<g id="node184" class="node">
<title>layer4_qkv_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="12060.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="12060.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg1_ds3</text>
</g>
<!-- layer4_attn_hg1_ds3 -->
<g id="node185" class="node">
<title>layer4_attn_hg1_ds3</title>
<ellipse fill="none" stroke="black" cx="12060.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="12060.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg1_ds3</text>
</g>
<!-- layer4_qkv_hg1_ds3&#45;&gt;layer4_attn_hg1_ds3 -->
<g id="edge229" class="edge">
<title>layer4_qkv_hg1_ds3&#45;&gt;layer4_attn_hg1_ds3</title>
<path fill="none" stroke="black" d="M12060.54,-872.23C12060.54,-854.56 12060.54,-826.82 12060.54,-806.19"/>
<polygon fill="black" stroke="black" points="12064.04,-806.14 12060.54,-796.14 12057.04,-806.14 12064.04,-806.14"/>
</g>
<!-- layer4_attn_hg1_ds3&#45;&gt;layer4_concat_dim_hg1 -->
<g id="edge230" class="edge">
<title>layer4_attn_hg1_ds3&#45;&gt;layer4_concat_dim_hg1</title>
<path fill="none" stroke="black" d="M12016.24,-761.55C11966.78,-744.31 11885.01,-715.79 11818.92,-692.75"/>
<polygon fill="black" stroke="black" points="11819.88,-689.38 11809.29,-689.39 11817.58,-695.99 11819.88,-689.38"/>
</g>
<!-- layer4_qkv_hg2_ds0 -->
<g id="node186" class="node">
<title>layer4_qkv_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="12291.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="12291.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg2_ds0</text>
</g>
<!-- layer4_attn_hg2_ds0 -->
<g id="node187" class="node">
<title>layer4_attn_hg2_ds0</title>
<ellipse fill="none" stroke="black" cx="12291.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="12291.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg2_ds0</text>
</g>
<!-- layer4_qkv_hg2_ds0&#45;&gt;layer4_attn_hg2_ds0 -->
<g id="edge231" class="edge">
<title>layer4_qkv_hg2_ds0&#45;&gt;layer4_attn_hg2_ds0</title>
<path fill="none" stroke="black" d="M12291.54,-872.23C12291.54,-854.56 12291.54,-826.82 12291.54,-806.19"/>
<polygon fill="black" stroke="black" points="12295.04,-806.14 12291.54,-796.14 12288.04,-806.14 12295.04,-806.14"/>
</g>
<!-- layer4_concat_dim_hg2 -->
<g id="node188" class="node">
<title>layer4_concat_dim_hg2</title>
<polygon fill="lightgreen" stroke="black" points="12522.54,-723 12329.54,-655 12522.54,-587 12715.54,-655 12522.54,-723"/>
<text text-anchor="middle" x="12522.54" y="-673.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="12522.54" y="-658.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="12522.54" y="-643.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="12522.54" y="-628.8" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- layer4_attn_hg2_ds0&#45;&gt;layer4_concat_dim_hg2 -->
<g id="edge232" class="edge">
<title>layer4_attn_hg2_ds0&#45;&gt;layer4_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M12322.69,-760.68C12351.89,-745.39 12396.89,-721.81 12436.81,-700.91"/>
<polygon fill="black" stroke="black" points="12438.53,-703.95 12445.77,-696.21 12435.29,-697.75 12438.53,-703.95"/>
</g>
<!-- layer4_concat_dim_hg2&#45;&gt;layer4_concat_heads -->
<g id="edge249" class="edge">
<title>layer4_concat_dim_hg2&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M12399.23,-630.22C12242.71,-600.04 11975,-548.42 11824.57,-519.41"/>
<polygon fill="black" stroke="black" points="11824.87,-515.9 11814.39,-517.45 11823.54,-522.78 11824.87,-515.9"/>
</g>
<!-- layer4_qkv_hg2_ds1 -->
<g id="node189" class="node">
<title>layer4_qkv_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="12522.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="12522.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg2_ds1</text>
</g>
<!-- layer4_attn_hg2_ds1 -->
<g id="node190" class="node">
<title>layer4_attn_hg2_ds1</title>
<ellipse fill="none" stroke="black" cx="12522.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="12522.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg2_ds1</text>
</g>
<!-- layer4_qkv_hg2_ds1&#45;&gt;layer4_attn_hg2_ds1 -->
<g id="edge233" class="edge">
<title>layer4_qkv_hg2_ds1&#45;&gt;layer4_attn_hg2_ds1</title>
<path fill="none" stroke="black" d="M12522.54,-872.23C12522.54,-854.56 12522.54,-826.82 12522.54,-806.19"/>
<polygon fill="black" stroke="black" points="12526.04,-806.14 12522.54,-796.14 12519.04,-806.14 12526.04,-806.14"/>
</g>
<!-- layer4_attn_hg2_ds1&#45;&gt;layer4_concat_dim_hg2 -->
<g id="edge234" class="edge">
<title>layer4_attn_hg2_ds1&#45;&gt;layer4_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M12522.54,-759.92C12522.54,-752.49 12522.54,-743.22 12522.54,-733.3"/>
<polygon fill="black" stroke="black" points="12526.04,-733.2 12522.54,-723.2 12519.04,-733.2 12526.04,-733.2"/>
</g>
<!-- layer4_qkv_hg2_ds2 -->
<g id="node191" class="node">
<title>layer4_qkv_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="12753.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="12753.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg2_ds2</text>
</g>
<!-- layer4_attn_hg2_ds2 -->
<g id="node192" class="node">
<title>layer4_attn_hg2_ds2</title>
<ellipse fill="none" stroke="black" cx="12753.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="12753.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg2_ds2</text>
</g>
<!-- layer4_qkv_hg2_ds2&#45;&gt;layer4_attn_hg2_ds2 -->
<g id="edge235" class="edge">
<title>layer4_qkv_hg2_ds2&#45;&gt;layer4_attn_hg2_ds2</title>
<path fill="none" stroke="black" d="M12753.54,-872.23C12753.54,-854.56 12753.54,-826.82 12753.54,-806.19"/>
<polygon fill="black" stroke="black" points="12757.04,-806.14 12753.54,-796.14 12750.04,-806.14 12757.04,-806.14"/>
</g>
<!-- layer4_attn_hg2_ds2&#45;&gt;layer4_concat_dim_hg2 -->
<g id="edge236" class="edge">
<title>layer4_attn_hg2_ds2&#45;&gt;layer4_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M12722.39,-760.68C12693.19,-745.39 12648.19,-721.81 12608.27,-700.91"/>
<polygon fill="black" stroke="black" points="12609.79,-697.75 12599.31,-696.21 12606.55,-703.95 12609.79,-697.75"/>
</g>
<!-- layer4_qkv_hg2_ds3 -->
<g id="node193" class="node">
<title>layer4_qkv_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="12984.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="12984.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg2_ds3</text>
</g>
<!-- layer4_attn_hg2_ds3 -->
<g id="node194" class="node">
<title>layer4_attn_hg2_ds3</title>
<ellipse fill="none" stroke="black" cx="12984.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="12984.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg2_ds3</text>
</g>
<!-- layer4_qkv_hg2_ds3&#45;&gt;layer4_attn_hg2_ds3 -->
<g id="edge237" class="edge">
<title>layer4_qkv_hg2_ds3&#45;&gt;layer4_attn_hg2_ds3</title>
<path fill="none" stroke="black" d="M12984.54,-872.23C12984.54,-854.56 12984.54,-826.82 12984.54,-806.19"/>
<polygon fill="black" stroke="black" points="12988.04,-806.14 12984.54,-796.14 12981.04,-806.14 12988.04,-806.14"/>
</g>
<!-- layer4_attn_hg2_ds3&#45;&gt;layer4_concat_dim_hg2 -->
<g id="edge238" class="edge">
<title>layer4_attn_hg2_ds3&#45;&gt;layer4_concat_dim_hg2</title>
<path fill="none" stroke="black" d="M12929.27,-762.52C12858.6,-744.02 12734.31,-711.46 12641.66,-687.2"/>
<polygon fill="black" stroke="black" points="12642.51,-683.8 12631.95,-684.65 12640.74,-690.57 12642.51,-683.8"/>
</g>
<!-- layer4_qkv_hg3_ds0 -->
<g id="node195" class="node">
<title>layer4_qkv_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="13215.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="13215.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg3_ds0</text>
</g>
<!-- layer4_attn_hg3_ds0 -->
<g id="node196" class="node">
<title>layer4_attn_hg3_ds0</title>
<ellipse fill="none" stroke="black" cx="13215.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="13215.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg3_ds0</text>
</g>
<!-- layer4_qkv_hg3_ds0&#45;&gt;layer4_attn_hg3_ds0 -->
<g id="edge239" class="edge">
<title>layer4_qkv_hg3_ds0&#45;&gt;layer4_attn_hg3_ds0</title>
<path fill="none" stroke="black" d="M13215.54,-872.23C13215.54,-854.56 13215.54,-826.82 13215.54,-806.19"/>
<polygon fill="black" stroke="black" points="13219.04,-806.14 13215.54,-796.14 13212.04,-806.14 13219.04,-806.14"/>
</g>
<!-- layer4_concat_dim_hg3 -->
<g id="node197" class="node">
<title>layer4_concat_dim_hg3</title>
<polygon fill="lightgreen" stroke="black" points="13446.54,-723 13253.54,-655 13446.54,-587 13639.54,-655 13446.54,-723"/>
<text text-anchor="middle" x="13446.54" y="-673.8" font-family="Times,serif" font-size="14.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="13446.54" y="-658.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="13446.54" y="-643.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 512]</text>
<text text-anchor="middle" x="13446.54" y="-628.8" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- layer4_attn_hg3_ds0&#45;&gt;layer4_concat_dim_hg3 -->
<g id="edge240" class="edge">
<title>layer4_attn_hg3_ds0&#45;&gt;layer4_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M13246.69,-760.68C13275.89,-745.39 13320.89,-721.81 13360.81,-700.91"/>
<polygon fill="black" stroke="black" points="13362.53,-703.95 13369.77,-696.21 13359.29,-697.75 13362.53,-703.95"/>
</g>
<!-- layer4_concat_dim_hg3&#45;&gt;layer4_concat_heads -->
<g id="edge250" class="edge">
<title>layer4_concat_dim_hg3&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M13296.18,-639.84C13150.14,-626.13 12922.16,-604.87 12724.54,-587 12412.13,-558.75 12045.3,-526.75 11850.82,-509.88"/>
<polygon fill="black" stroke="black" points="11851.1,-506.39 11840.84,-509.01 11850.5,-513.36 11851.1,-506.39"/>
</g>
<!-- layer4_qkv_hg3_ds1 -->
<g id="node198" class="node">
<title>layer4_qkv_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="13446.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="13446.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg3_ds1</text>
</g>
<!-- layer4_attn_hg3_ds1 -->
<g id="node199" class="node">
<title>layer4_attn_hg3_ds1</title>
<ellipse fill="none" stroke="black" cx="13446.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="13446.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg3_ds1</text>
</g>
<!-- layer4_qkv_hg3_ds1&#45;&gt;layer4_attn_hg3_ds1 -->
<g id="edge241" class="edge">
<title>layer4_qkv_hg3_ds1&#45;&gt;layer4_attn_hg3_ds1</title>
<path fill="none" stroke="black" d="M13446.54,-872.23C13446.54,-854.56 13446.54,-826.82 13446.54,-806.19"/>
<polygon fill="black" stroke="black" points="13450.04,-806.14 13446.54,-796.14 13443.04,-806.14 13450.04,-806.14"/>
</g>
<!-- layer4_attn_hg3_ds1&#45;&gt;layer4_concat_dim_hg3 -->
<g id="edge242" class="edge">
<title>layer4_attn_hg3_ds1&#45;&gt;layer4_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M13446.54,-759.92C13446.54,-752.49 13446.54,-743.22 13446.54,-733.3"/>
<polygon fill="black" stroke="black" points="13450.04,-733.2 13446.54,-723.2 13443.04,-733.2 13450.04,-733.2"/>
</g>
<!-- layer4_qkv_hg3_ds2 -->
<g id="node200" class="node">
<title>layer4_qkv_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="13677.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="13677.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg3_ds2</text>
</g>
<!-- layer4_attn_hg3_ds2 -->
<g id="node201" class="node">
<title>layer4_attn_hg3_ds2</title>
<ellipse fill="none" stroke="black" cx="13677.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="13677.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg3_ds2</text>
</g>
<!-- layer4_qkv_hg3_ds2&#45;&gt;layer4_attn_hg3_ds2 -->
<g id="edge243" class="edge">
<title>layer4_qkv_hg3_ds2&#45;&gt;layer4_attn_hg3_ds2</title>
<path fill="none" stroke="black" d="M13677.54,-872.23C13677.54,-854.56 13677.54,-826.82 13677.54,-806.19"/>
<polygon fill="black" stroke="black" points="13681.04,-806.14 13677.54,-796.14 13674.04,-806.14 13681.04,-806.14"/>
</g>
<!-- layer4_attn_hg3_ds2&#45;&gt;layer4_concat_dim_hg3 -->
<g id="edge244" class="edge">
<title>layer4_attn_hg3_ds2&#45;&gt;layer4_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M13646.39,-760.68C13617.19,-745.39 13572.19,-721.81 13532.27,-700.91"/>
<polygon fill="black" stroke="black" points="13533.79,-697.75 13523.31,-696.21 13530.55,-703.95 13533.79,-697.75"/>
</g>
<!-- layer4_qkv_hg3_ds3 -->
<g id="node202" class="node">
<title>layer4_qkv_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="13908.54" cy="-890.5" rx="104" ry="18"/>
<text text-anchor="middle" x="13908.54" y="-886.8" font-family="Times,serif" font-size="14.00">layer4_qkv_hg3_ds3</text>
</g>
<!-- layer4_attn_hg3_ds3 -->
<g id="node203" class="node">
<title>layer4_attn_hg3_ds3</title>
<ellipse fill="none" stroke="black" cx="13908.54" cy="-778" rx="106.68" ry="18"/>
<text text-anchor="middle" x="13908.54" y="-774.3" font-family="Times,serif" font-size="14.00">layer4_attn_hg3_ds3</text>
</g>
<!-- layer4_qkv_hg3_ds3&#45;&gt;layer4_attn_hg3_ds3 -->
<g id="edge245" class="edge">
<title>layer4_qkv_hg3_ds3&#45;&gt;layer4_attn_hg3_ds3</title>
<path fill="none" stroke="black" d="M13908.54,-872.23C13908.54,-854.56 13908.54,-826.82 13908.54,-806.19"/>
<polygon fill="black" stroke="black" points="13912.04,-806.14 13908.54,-796.14 13905.04,-806.14 13912.04,-806.14"/>
</g>
<!-- layer4_attn_hg3_ds3&#45;&gt;layer4_concat_dim_hg3 -->
<g id="edge246" class="edge">
<title>layer4_attn_hg3_ds3&#45;&gt;layer4_concat_dim_hg3</title>
<path fill="none" stroke="black" d="M13853.27,-762.52C13782.6,-744.02 13658.31,-711.46 13565.66,-687.2"/>
<polygon fill="black" stroke="black" points="13566.51,-683.8 13555.95,-684.65 13564.74,-690.57 13566.51,-683.8"/>
</g>
<!-- layer4_expert0_gpu0 -->
<g id="node205" class="node">
<title>layer4_expert0_gpu0</title>
<ellipse fill="none" stroke="black" cx="9833.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="9833.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert0_gpu0</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert0_gpu0 -->
<g id="edge252" class="edge">
<title>layer4_router&#45;&gt;layer4_expert0_gpu0</title>
<path fill="none" stroke="black" d="M11614.52,-360.09C11383.24,-354.05 10789.59,-336.27 10294.54,-302 10141.32,-291.39 10103.03,-287.38 9950.54,-269 9940.84,-267.83 9930.69,-266.51 9920.61,-265.13"/>
<polygon fill="black" stroke="black" points="9920.95,-261.64 9910.57,-263.74 9919.99,-268.58 9920.95,-261.64"/>
<text text-anchor="middle" x="10326.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer4_expert0_gpu1 -->
<g id="node206" class="node">
<title>layer4_expert0_gpu1</title>
<ellipse fill="none" stroke="black" cx="10068.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="10068.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert0_gpu1</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert0_gpu1 -->
<g id="edge253" class="edge">
<title>layer4_router&#45;&gt;layer4_expert0_gpu1</title>
<path fill="none" stroke="black" d="M11616.25,-358.5C11418.17,-350.12 10953.86,-329.19 10564.54,-302 10395.87,-290.22 10353.49,-288.5 10185.54,-269 10175.75,-267.86 10165.52,-266.56 10155.36,-265.18"/>
<polygon fill="black" stroke="black" points="10155.62,-261.68 10145.24,-263.79 10154.67,-268.62 10155.62,-261.68"/>
<text text-anchor="middle" x="10596.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- layer4_expert1_gpu2 -->
<g id="node207" class="node">
<title>layer4_expert1_gpu2</title>
<ellipse fill="none" stroke="black" cx="10303.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="10303.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert1_gpu2</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert1_gpu2 -->
<g id="edge254" class="edge">
<title>layer4_router&#45;&gt;layer4_expert1_gpu2</title>
<path fill="none" stroke="black" d="M11616.82,-357.89C11401.47,-347.12 10866.36,-317.44 10420.54,-269 10410.49,-267.91 10399.97,-266.61 10389.55,-265.22"/>
<polygon fill="black" stroke="black" points="10389.97,-261.74 10379.59,-263.86 10389.03,-268.68 10389.97,-261.74"/>
<text text-anchor="middle" x="10770.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer4_expert1_gpu3 -->
<g id="node208" class="node">
<title>layer4_expert1_gpu3</title>
<ellipse fill="none" stroke="black" cx="10538.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="10538.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert1_gpu3</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert1_gpu3 -->
<g id="edge255" class="edge">
<title>layer4_router&#45;&gt;layer4_expert1_gpu3</title>
<path fill="none" stroke="black" d="M11623.15,-352.79C11454.12,-334.73 11096.02,-296.87 10971.54,-287 10831.31,-275.88 10795.5,-283.13 10655.54,-269 10645.4,-267.98 10634.8,-266.71 10624.29,-265.34"/>
<polygon fill="black" stroke="black" points="10624.64,-261.85 10614.26,-263.99 10623.71,-268.79 10624.64,-261.85"/>
<text text-anchor="middle" x="11161.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- layer4_expert2_gpu4 -->
<g id="node209" class="node">
<title>layer4_expert2_gpu4</title>
<ellipse fill="none" stroke="black" cx="10773.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="10773.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert2_gpu4</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert2_gpu4 -->
<g id="edge256" class="edge">
<title>layer4_router&#45;&gt;layer4_expert2_gpu4</title>
<path fill="none" stroke="black" d="M11626.26,-350.13C11542.43,-338.15 11412.26,-319.33 11299.54,-302 11258.16,-295.64 11248.16,-291.53 11206.54,-287 11066.69,-271.78 11030.5,-283.13 10890.54,-269 10880.4,-267.98 10869.8,-266.71 10859.29,-265.34"/>
<polygon fill="black" stroke="black" points="10859.64,-261.85 10849.26,-263.99 10858.71,-268.79 10859.64,-261.85"/>
<text text-anchor="middle" x="11331.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer4_expert2_gpu5 -->
<g id="node210" class="node">
<title>layer4_expert2_gpu5</title>
<ellipse fill="none" stroke="black" cx="11008.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="11008.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert2_gpu5</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert2_gpu5 -->
<g id="edge257" class="edge">
<title>layer4_router&#45;&gt;layer4_expert2_gpu5</title>
<path fill="none" stroke="black" d="M11630.48,-346.53C11572.12,-335 11492.32,-318.59 11422.54,-302 11397.47,-296.04 11391.94,-291.31 11366.54,-287 11260.65,-269.03 11232.31,-280.73 11125.54,-269 11115.67,-267.92 11105.35,-266.63 11095.11,-265.27"/>
<polygon fill="black" stroke="black" points="11095.29,-261.76 11084.91,-263.88 11094.35,-268.7 11095.29,-261.76"/>
<text text-anchor="middle" x="11454.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- layer4_expert3_gpu6 -->
<g id="node211" class="node">
<title>layer4_expert3_gpu6</title>
<ellipse fill="none" stroke="black" cx="11243.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="11243.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert3_gpu6</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert3_gpu6 -->
<g id="edge258" class="edge">
<title>layer4_router&#45;&gt;layer4_expert3_gpu6</title>
<path fill="none" stroke="black" d="M11638.97,-339.4C11604.84,-328.53 11563.97,-315.1 11527.54,-302 11510.45,-295.86 11507.1,-291.62 11489.54,-287 11433.56,-272.27 11417.85,-277.16 11360.54,-269 11351.34,-267.69 11341.74,-266.31 11332.16,-264.93"/>
<polygon fill="black" stroke="black" points="11332.6,-261.46 11322.2,-263.49 11331.6,-268.39 11332.6,-261.46"/>
<text text-anchor="middle" x="11559.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer4_expert3_gpu7 -->
<g id="node212" class="node">
<title>layer4_expert3_gpu7</title>
<ellipse fill="none" stroke="black" cx="11478.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="11478.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert3_gpu7</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert3_gpu7 -->
<g id="edge259" class="edge">
<title>layer4_router&#45;&gt;layer4_expert3_gpu7</title>
<path fill="none" stroke="black" d="M11658.12,-322.93C11638.66,-310.24 11616.23,-296.93 11594.54,-287 11579.49,-280.11 11562.74,-274.15 11546.75,-269.2"/>
<polygon fill="black" stroke="black" points="11547.5,-265.77 11536.91,-266.25 11545.48,-272.48 11547.5,-265.77"/>
<text text-anchor="middle" x="11653.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- layer4_expert4_gpu8 -->
<g id="node213" class="node">
<title>layer4_expert4_gpu8</title>
<ellipse fill="none" stroke="black" cx="11713.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="11713.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert4_gpu8</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert4_gpu8 -->
<g id="edge260" class="edge">
<title>layer4_router&#45;&gt;layer4_expert4_gpu8</title>
<path fill="none" stroke="black" d="M11713.54,-319.78C11713.54,-306.16 11713.54,-291.46 11713.54,-279.25"/>
<polygon fill="black" stroke="black" points="11717.04,-279.24 11713.54,-269.24 11710.04,-279.24 11717.04,-279.24"/>
<text text-anchor="middle" x="11745.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer4_expert4_gpu9 -->
<g id="node214" class="node">
<title>layer4_expert4_gpu9</title>
<ellipse fill="none" stroke="black" cx="11948.54" cy="-251" rx="108.58" ry="18"/>
<text text-anchor="middle" x="11948.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert4_gpu9</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert4_gpu9 -->
<g id="edge261" class="edge">
<title>layer4_router&#45;&gt;layer4_expert4_gpu9</title>
<path fill="none" stroke="black" d="M11779,-331.72C11819.27,-312.79 11869.76,-289.05 11905.12,-272.42"/>
<polygon fill="black" stroke="black" points="11906.66,-275.56 11914.22,-268.14 11903.68,-269.22 11906.66,-275.56"/>
<text text-anchor="middle" x="11903.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- layer4_expert5_gpu10 -->
<g id="node215" class="node">
<title>layer4_expert5_gpu10</title>
<ellipse fill="none" stroke="black" cx="12189.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="12189.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert5_gpu10</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert5_gpu10 -->
<g id="edge262" class="edge">
<title>layer4_router&#45;&gt;layer4_expert5_gpu10</title>
<path fill="none" stroke="black" d="M11793.48,-343.94C11884.38,-322.84 12031.42,-288.71 12118.47,-268.5"/>
<polygon fill="black" stroke="black" points="12119.31,-271.9 12128.26,-266.23 12117.72,-265.08 12119.31,-271.9"/>
<text text-anchor="middle" x="12067.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer4_expert5_gpu11 -->
<g id="node216" class="node">
<title>layer4_expert5_gpu11</title>
<ellipse fill="none" stroke="black" cx="12436.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="12436.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert5_gpu11</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert5_gpu11 -->
<g id="edge263" class="edge">
<title>layer4_router&#45;&gt;layer4_expert5_gpu11</title>
<path fill="none" stroke="black" d="M11800.03,-349.28C11938.26,-328.16 12207.57,-287 12347.43,-265.62"/>
<polygon fill="black" stroke="black" points="12348.32,-269.02 12357.68,-264.05 12347.27,-262.1 12348.32,-269.02"/>
<text text-anchor="middle" x="12234.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- layer4_expert6_gpu12 -->
<g id="node217" class="node">
<title>layer4_expert6_gpu12</title>
<ellipse fill="none" stroke="black" cx="12683.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="12683.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert6_gpu12</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert6_gpu12 -->
<g id="edge264" class="edge">
<title>layer4_router&#45;&gt;layer4_expert6_gpu12</title>
<path fill="none" stroke="black" d="M11804.83,-353.34C11960.19,-337.55 12285.87,-303.55 12560.54,-269 12570.59,-267.74 12581.09,-266.36 12591.55,-264.96"/>
<polygon fill="black" stroke="black" points="12592.09,-268.42 12601.54,-263.62 12591.16,-261.49 12592.09,-268.42"/>
<text text-anchor="middle" x="12430.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer4_expert6_gpu13 -->
<g id="node218" class="node">
<title>layer4_expert6_gpu13</title>
<ellipse fill="none" stroke="black" cx="12930.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="12930.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert6_gpu13</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert6_gpu13 -->
<g id="edge265" class="edge">
<title>layer4_router&#45;&gt;layer4_expert6_gpu13</title>
<path fill="none" stroke="black" d="M11808.5,-356.41C11998.54,-343.77 12439.07,-312.22 12807.54,-269 12817.76,-267.8 12828.45,-266.46 12839.07,-265.07"/>
<polygon fill="black" stroke="black" points="12839.77,-268.5 12849.22,-263.72 12838.85,-261.57 12839.77,-268.5"/>
<text text-anchor="middle" x="12660.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- layer4_expert7_gpu14 -->
<g id="node219" class="node">
<title>layer4_expert7_gpu14</title>
<ellipse fill="none" stroke="black" cx="13177.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="13177.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert7_gpu14</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert7_gpu14 -->
<g id="edge266" class="edge">
<title>layer4_router&#45;&gt;layer4_expert7_gpu14</title>
<path fill="none" stroke="black" d="M11809.78,-357.54C11985.74,-348.24 12371.1,-326.9 12695.54,-302 12855.3,-289.74 12895.36,-287.31 13054.54,-269 13064.85,-267.81 13075.62,-266.47 13086.33,-265.08"/>
<polygon fill="black" stroke="black" points="13087.1,-268.51 13096.56,-263.73 13086.19,-261.57 13087.1,-268.51"/>
<text text-anchor="middle" x="12912.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer4_expert7_gpu15 -->
<g id="node220" class="node">
<title>layer4_expert7_gpu15</title>
<ellipse fill="none" stroke="black" cx="13424.54" cy="-251" rx="114.5" ry="18"/>
<text text-anchor="middle" x="13424.54" y="-247.3" font-family="Times,serif" font-size="14.00">layer4_expert7_gpu15</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert7_gpu15 -->
<g id="edge267" class="edge">
<title>layer4_router&#45;&gt;layer4_expert7_gpu15</title>
<path fill="none" stroke="black" d="M11811.61,-359.16C12020.6,-351.71 12525.25,-332.02 12947.54,-302 13105.16,-290.8 13144.57,-287.15 13301.54,-269 13311.76,-267.82 13322.45,-266.48 13333.08,-265.1"/>
<polygon fill="black" stroke="black" points="13333.77,-268.54 13343.23,-263.76 13332.85,-261.6 13333.77,-268.54"/>
<text text-anchor="middle" x="13162.04" y="-290.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- layer4_expert_concat -->
<g id="node221" class="node">
<title>layer4_expert_concat</title>
<polygon fill="lightyellow" stroke="black" points="11713.54,-196 11555.54,-143 11713.54,-90 11871.54,-143 11713.54,-196"/>
<text text-anchor="middle" x="11713.54" y="-154.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11713.54" y="-139.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 2048]</text>
<text text-anchor="middle" x="11713.54" y="-124.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_concat -->
<g id="edge268" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11813.07,-360.26C12052.02,-354.5 12676.89,-337.06 13197.54,-302 13356.17,-291.32 13658.2,-348.11 13548.54,-233 13491.21,-172.82 12310.23,-151.63 11873.8,-145.84"/>
<polygon fill="black" stroke="black" points="11873.68,-142.34 11863.63,-145.71 11873.59,-149.34 11873.68,-142.34"/>
</g>
<!-- layer4_expert0_gpu0&#45;&gt;layer4_expert_concat -->
<g id="edge269" class="edge">
<title>layer4_expert0_gpu0&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M9908.94,-237.98C9922.75,-236.08 9937.06,-234.32 9950.54,-233 10541.47,-175.28 11247.7,-153.95 11556.27,-146.99"/>
<polygon fill="black" stroke="black" points="11556.71,-150.48 11566.63,-146.76 11556.56,-143.48 11556.71,-150.48"/>
</g>
<!-- layer4_expert0_gpu1&#45;&gt;layer4_expert_concat -->
<g id="edge270" class="edge">
<title>layer4_expert0_gpu1&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M10144.26,-238.03C10157.97,-236.14 10172.16,-234.36 10185.54,-233 10687.58,-182 11285.61,-157.69 11560.96,-148.54"/>
<polygon fill="black" stroke="black" points="11561.14,-152.03 11571.02,-148.2 11560.91,-145.04 11561.14,-152.03"/>
</g>
<!-- layer4_expert1_gpu2&#45;&gt;layer4_expert_concat -->
<g id="edge271" class="edge">
<title>layer4_expert1_gpu2&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M10379.59,-238.1C10393.2,-236.21 10407.27,-234.42 10420.54,-233 10834.66,-188.73 11325.86,-161.95 11566.21,-150.51"/>
<polygon fill="black" stroke="black" points="11566.58,-154 11576.41,-150.03 11566.25,-147.01 11566.58,-154"/>
</g>
<!-- layer4_expert1_gpu3&#45;&gt;layer4_expert_concat -->
<g id="edge272" class="edge">
<title>layer4_expert1_gpu3&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M10615.24,-238.18C10628.65,-236.31 10642.49,-234.5 10655.54,-233 10983.53,-195.41 11370.44,-166.86 11573.28,-153.09"/>
<polygon fill="black" stroke="black" points="11573.66,-156.57 11583.4,-152.41 11573.18,-149.59 11573.66,-156.57"/>
</g>
<!-- layer4_expert2_gpu4&#45;&gt;layer4_expert_concat -->
<g id="edge273" class="edge">
<title>layer4_expert2_gpu4&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M10850.9,-238.35C10864.11,-236.48 10877.71,-234.63 10890.54,-233 11134.76,-202.06 11420.61,-172.68 11583.05,-156.62"/>
<polygon fill="black" stroke="black" points="11583.49,-160.1 11593.09,-155.63 11582.8,-153.13 11583.49,-160.1"/>
</g>
<!-- layer4_expert2_gpu5&#45;&gt;layer4_expert_concat -->
<g id="edge274" class="edge">
<title>layer4_expert2_gpu5&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M11086,-238.35C11209.4,-219.8 11451.39,-183.41 11596.15,-161.65"/>
<polygon fill="black" stroke="black" points="11597.04,-165.06 11606.41,-160.11 11596,-158.13 11597.04,-165.06"/>
</g>
<!-- layer4_expert3_gpu6&#45;&gt;layer4_expert_concat -->
<g id="edge275" class="edge">
<title>layer4_expert3_gpu6&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M11304.98,-236.14C11382.61,-218.64 11517.31,-188.26 11610.72,-167.19"/>
<polygon fill="black" stroke="black" points="11611.5,-170.6 11620.48,-164.99 11609.96,-163.77 11611.5,-170.6"/>
</g>
<!-- layer4_expert3_gpu7&#45;&gt;layer4_expert_concat -->
<g id="edge276" class="edge">
<title>layer4_expert3_gpu7&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M11514.23,-233.9C11546.94,-219.15 11596.44,-196.82 11637.92,-178.11"/>
<polygon fill="black" stroke="black" points="11639.51,-181.23 11647.19,-173.93 11636.63,-174.85 11639.51,-181.23"/>
</g>
<!-- layer4_expert4_gpu8&#45;&gt;layer4_expert_concat -->
<g id="edge277" class="edge">
<title>layer4_expert4_gpu8&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M11713.54,-232.97C11713.54,-225.5 11713.54,-216.22 11713.54,-206.51"/>
<polygon fill="black" stroke="black" points="11717.04,-206.28 11713.54,-196.28 11710.04,-206.28 11717.04,-206.28"/>
</g>
<!-- layer4_expert4_gpu9&#45;&gt;layer4_expert_concat -->
<g id="edge278" class="edge">
<title>layer4_expert4_gpu9&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M11912.85,-233.9C11880.14,-219.15 11830.64,-196.82 11789.16,-178.11"/>
<polygon fill="black" stroke="black" points="11790.45,-174.85 11779.9,-173.93 11787.57,-181.23 11790.45,-174.85"/>
</g>
<!-- layer4_expert5_gpu10&#45;&gt;layer4_expert_concat -->
<g id="edge279" class="edge">
<title>layer4_expert5_gpu10&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M12126.33,-235.92C12047.32,-218.33 11911.02,-187.98 11816.77,-166.99"/>
<polygon fill="black" stroke="black" points="11817.45,-163.55 11806.93,-164.8 11815.93,-170.39 11817.45,-163.55"/>
</g>
<!-- layer4_expert5_gpu11&#45;&gt;layer4_expert_concat -->
<g id="edge280" class="edge">
<title>layer4_expert5_gpu11&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M12355.71,-238.15C12228.1,-219.44 11979.35,-182.97 11831.7,-161.32"/>
<polygon fill="black" stroke="black" points="11832.08,-157.84 11821.68,-159.85 11831.07,-164.77 11832.08,-157.84"/>
</g>
<!-- layer4_expert6_gpu12&#45;&gt;layer4_expert_concat -->
<g id="edge281" class="edge">
<title>layer4_expert6_gpu12&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M12601.88,-238.33C12588.09,-236.47 12573.92,-234.63 12560.54,-233 12307.69,-202.25 12011.59,-172.58 11844.95,-156.47"/>
<polygon fill="black" stroke="black" points="11844.95,-152.95 11834.66,-155.47 11844.27,-159.92 11844.95,-152.95"/>
</g>
<!-- layer4_expert6_gpu13&#45;&gt;layer4_expert_concat -->
<g id="edge282" class="edge">
<title>layer4_expert6_gpu13&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M12849.9,-238.19C12835.8,-236.32 12821.25,-234.5 12807.54,-233 12466.02,-195.54 12062.91,-166.7 11854.37,-152.92"/>
<polygon fill="black" stroke="black" points="11854.49,-149.42 11844.28,-152.25 11854.03,-156.4 11854.49,-149.42"/>
</g>
<!-- layer4_expert7_gpu14&#45;&gt;layer4_expert_concat -->
<g id="edge283" class="edge">
<title>layer4_expert7_gpu14&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M13097.58,-238.11C13083.27,-236.22 13068.48,-234.42 13054.54,-233 12622.12,-188.82 12108.92,-161.81 11861.49,-150.38"/>
<polygon fill="black" stroke="black" points="11861.51,-146.87 11851.36,-149.91 11861.19,-153.87 11861.51,-146.87"/>
</g>
<!-- layer4_expert7_gpu15&#45;&gt;layer4_expert_concat -->
<g id="edge284" class="edge">
<title>layer4_expert7_gpu15&#45;&gt;layer4_expert_concat</title>
<path fill="none" stroke="black" d="M13344.92,-238.03C13330.51,-236.14 13315.59,-234.36 13301.54,-233 12776.39,-182.08 12150.5,-157.59 11866.81,-148.44"/>
<polygon fill="black" stroke="black" points="11866.56,-144.93 11856.45,-148.11 11866.34,-151.93 11866.56,-144.93"/>
</g>
<!-- output -->
<g id="node222" class="node">
<title>output</title>
<polygon fill="yellow" stroke="black" points="11790.04,-53 11637.04,-53 11637.04,0 11790.04,0 11790.04,-53"/>
<text text-anchor="middle" x="11713.54" y="-37.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="11713.54" y="-22.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="11713.54" y="-7.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_expert_concat&#45;&gt;output -->
<g id="edge285" class="edge">
<title>layer4_expert_concat&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11713.54,-89.78C11713.54,-80.82 11713.54,-71.7 11713.54,-63.29"/>
<polygon fill="black" stroke="black" points="11717.04,-63.1 11713.54,-53.1 11710.04,-63.1 11717.04,-63.1"/>
</g>
</g>
</svg>
