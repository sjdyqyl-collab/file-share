<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1800pt" height="128pt"
 viewBox="0.00 0.00 1800.00 127.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.1 0.1) rotate(0) translate(4 1252.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1252.91 17684,-1252.91 17684,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="1989" cy="-792.43" rx="136.44" ry="37.45"/>
<text text-anchor="middle" x="1989" y="-803.73" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="1989" y="-788.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="1989" y="-773.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1 -->
<g id="node56" class="node">
<title>res1</title>
<polygon fill="lightcyan" stroke="black" points="2341.5,-710.45 2148.5,-710.45 2148.5,-657.45 2341.5,-657.45 2341.5,-710.45"/>
<text text-anchor="middle" x="2245" y="-695.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2245" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="2245" y="-665.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge53" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2062.7,-760.78C2097.67,-746.23 2139.28,-728.93 2173.91,-714.52"/>
<polygon fill="black" stroke="black" points="2175.59,-717.61 2183.48,-710.54 2172.9,-711.15 2175.59,-717.61"/>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightgray" stroke="black" points="4076.5,-1241.41 3883.5,-1241.41 3883.5,-1188.41 4076.5,-1188.41 4076.5,-1241.41"/>
<text text-anchor="middle" x="3980" y="-1226.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3980" y="-1211.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="3980" y="-1196.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_0_0 -->
<g id="node3" class="node">
<title>qkv_0_0</title>
<polygon fill="lightblue" stroke="black" points="205,-1248.91 21,-1248.91 21,-1180.91 205,-1180.91 205,-1248.91"/>
<text text-anchor="middle" x="113" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="113" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="113" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="113" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_0 -->
<g id="node4" class="node">
<title>attn_0_0</title>
<polygon fill="lightblue" stroke="black" points="226,-1143.91 0,-1143.91 0,-1090.91 226,-1090.91 226,-1143.91"/>
<text text-anchor="middle" x="113" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="113" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="113" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_0_0&#45;&gt;attn_0_0 -->
<g id="edge1" class="edge">
<title>qkv_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M113,-1180.77C113,-1172.19 113,-1162.92 113,-1154.21"/>
<polygon fill="black" stroke="black" points="116.5,-1153.95 113,-1143.95 109.5,-1153.95 116.5,-1153.95"/>
</g>
<!-- out_proj_0_0 -->
<g id="node5" class="node">
<title>out_proj_0_0</title>
<polygon fill="lightblue" stroke="black" points="258,-1053.91 74,-1053.91 74,-985.91 258,-985.91 258,-1053.91"/>
<text text-anchor="middle" x="166" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="166" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="166" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="166" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_0&#45;&gt;out_proj_0_0 -->
<g id="edge2" class="edge">
<title>attn_0_0&#45;&gt;out_proj_0_0</title>
<path fill="none" stroke="black" d="M127.2,-1090.81C131.94,-1082.27 137.36,-1072.52 142.61,-1063.06"/>
<polygon fill="black" stroke="black" points="145.77,-1064.57 147.56,-1054.13 139.65,-1061.17 145.77,-1064.57"/>
</g>
<!-- concat_dim_0 -->
<g id="node51" class="node">
<title>concat_dim_0</title>
<polygon fill="orange" stroke="black" points="717.5,-948.91 484.5,-948.91 484.5,-880.91 717.5,-880.91 717.5,-948.91"/>
<text text-anchor="middle" x="601" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="601" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="601" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="601" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_0_0&#45;&gt;concat_dim_0 -->
<g id="edge33" class="edge">
<title>out_proj_0_0&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M258.15,-993.52C268.21,-990.89 278.31,-988.3 288,-985.91 349.2,-970.8 417.47,-955.36 474.6,-942.84"/>
<polygon fill="black" stroke="black" points="475.38,-946.26 484.4,-940.7 473.89,-939.42 475.38,-946.26"/>
</g>
<!-- qkv_0_1 -->
<g id="node6" class="node">
<title>qkv_0_1</title>
<polygon fill="lightcoral" stroke="black" points="449,-1248.91 265,-1248.91 265,-1180.91 449,-1180.91 449,-1248.91"/>
<text text-anchor="middle" x="357" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="357" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="357" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="357" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_1 -->
<g id="node7" class="node">
<title>attn_0_1</title>
<polygon fill="lightcoral" stroke="black" points="470,-1143.91 244,-1143.91 244,-1090.91 470,-1090.91 470,-1143.91"/>
<text text-anchor="middle" x="357" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="357" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="357" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_0_1&#45;&gt;attn_0_1 -->
<g id="edge3" class="edge">
<title>qkv_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M357,-1180.77C357,-1172.19 357,-1162.92 357,-1154.21"/>
<polygon fill="black" stroke="black" points="360.5,-1153.95 357,-1143.95 353.5,-1153.95 360.5,-1153.95"/>
</g>
<!-- out_proj_0_1 -->
<g id="node8" class="node">
<title>out_proj_0_1</title>
<polygon fill="lightcoral" stroke="black" points="481,-1053.91 297,-1053.91 297,-985.91 481,-985.91 481,-1053.91"/>
<text text-anchor="middle" x="389" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="389" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="389" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="389" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_1&#45;&gt;out_proj_0_1 -->
<g id="edge4" class="edge">
<title>attn_0_1&#45;&gt;out_proj_0_1</title>
<path fill="none" stroke="black" d="M365.58,-1090.81C368.38,-1082.45 371.57,-1072.92 374.68,-1063.64"/>
<polygon fill="black" stroke="black" points="378.01,-1064.72 377.87,-1054.13 371.37,-1062.5 378.01,-1064.72"/>
</g>
<!-- out_proj_0_1&#45;&gt;concat_dim_0 -->
<g id="edge34" class="edge">
<title>out_proj_0_1&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M456.95,-985.89C478.25,-975.54 501.92,-964.05 523.81,-953.41"/>
<polygon fill="black" stroke="black" points="525.6,-956.43 533.07,-948.91 522.54,-950.13 525.6,-956.43"/>
</g>
<!-- qkv_0_2 -->
<g id="node9" class="node">
<title>qkv_0_2</title>
<polygon fill="lightgreen" stroke="black" points="693,-1248.91 509,-1248.91 509,-1180.91 693,-1180.91 693,-1248.91"/>
<text text-anchor="middle" x="601" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="601" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="601" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_2 -->
<g id="node10" class="node">
<title>attn_0_2</title>
<polygon fill="lightgreen" stroke="black" points="714,-1143.91 488,-1143.91 488,-1090.91 714,-1090.91 714,-1143.91"/>
<text text-anchor="middle" x="601" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="601" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_0_2&#45;&gt;attn_0_2 -->
<g id="edge5" class="edge">
<title>qkv_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M601,-1180.77C601,-1172.19 601,-1162.92 601,-1154.21"/>
<polygon fill="black" stroke="black" points="604.5,-1153.95 601,-1143.95 597.5,-1153.95 604.5,-1153.95"/>
</g>
<!-- out_proj_0_2 -->
<g id="node11" class="node">
<title>out_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="693,-1053.91 509,-1053.91 509,-985.91 693,-985.91 693,-1053.91"/>
<text text-anchor="middle" x="601" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="601" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="601" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="601" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_2&#45;&gt;out_proj_0_2 -->
<g id="edge6" class="edge">
<title>attn_0_2&#45;&gt;out_proj_0_2</title>
<path fill="none" stroke="black" d="M601,-1090.81C601,-1082.63 601,-1073.32 601,-1064.23"/>
<polygon fill="black" stroke="black" points="604.5,-1064.13 601,-1054.13 597.5,-1064.13 604.5,-1064.13"/>
</g>
<!-- out_proj_0_2&#45;&gt;concat_dim_0 -->
<g id="edge35" class="edge">
<title>out_proj_0_2&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M601,-985.75C601,-977.3 601,-968.08 601,-959.21"/>
<polygon fill="black" stroke="black" points="604.5,-959 601,-949 597.5,-959 604.5,-959"/>
</g>
<!-- qkv_0_3 -->
<g id="node12" class="node">
<title>qkv_0_3</title>
<polygon fill="lightyellow" stroke="black" points="937,-1248.91 753,-1248.91 753,-1180.91 937,-1180.91 937,-1248.91"/>
<text text-anchor="middle" x="845" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="845" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="845" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="845" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_0_3 -->
<g id="node13" class="node">
<title>attn_0_3</title>
<polygon fill="lightyellow" stroke="black" points="958,-1143.91 732,-1143.91 732,-1090.91 958,-1090.91 958,-1143.91"/>
<text text-anchor="middle" x="845" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="845" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="845" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_0_3&#45;&gt;attn_0_3 -->
<g id="edge7" class="edge">
<title>qkv_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M845,-1180.77C845,-1172.19 845,-1162.92 845,-1154.21"/>
<polygon fill="black" stroke="black" points="848.5,-1153.95 845,-1143.95 841.5,-1153.95 848.5,-1153.95"/>
</g>
<!-- out_proj_0_3 -->
<g id="node14" class="node">
<title>out_proj_0_3</title>
<polygon fill="lightyellow" stroke="black" points="906,-1053.91 722,-1053.91 722,-985.91 906,-985.91 906,-1053.91"/>
<text text-anchor="middle" x="814" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="814" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="814" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="814" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_3&#45;&gt;out_proj_0_3 -->
<g id="edge8" class="edge">
<title>attn_0_3&#45;&gt;out_proj_0_3</title>
<path fill="none" stroke="black" d="M836.69,-1090.81C833.98,-1082.45 830.88,-1072.92 827.87,-1063.64"/>
<polygon fill="black" stroke="black" points="831.2,-1062.56 824.78,-1054.13 824.54,-1064.72 831.2,-1062.56"/>
</g>
<!-- out_proj_0_3&#45;&gt;concat_dim_0 -->
<g id="edge36" class="edge">
<title>out_proj_0_3&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M745.73,-985.89C724.23,-975.5 700.34,-963.94 678.26,-953.27"/>
<polygon fill="black" stroke="black" points="679.78,-950.11 669.25,-948.91 676.73,-956.42 679.78,-950.11"/>
</g>
<!-- qkv_1_0 -->
<g id="node15" class="node">
<title>qkv_1_0</title>
<polygon fill="lightpink" stroke="black" points="1181,-1248.91 997,-1248.91 997,-1180.91 1181,-1180.91 1181,-1248.91"/>
<text text-anchor="middle" x="1089" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1089" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1089" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1089" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_0 -->
<g id="node16" class="node">
<title>attn_1_0</title>
<polygon fill="lightpink" stroke="black" points="1202,-1143.91 976,-1143.91 976,-1090.91 1202,-1090.91 1202,-1143.91"/>
<text text-anchor="middle" x="1089" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1089" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1089" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_1_0&#45;&gt;attn_1_0 -->
<g id="edge9" class="edge">
<title>qkv_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M1089,-1180.77C1089,-1172.19 1089,-1162.92 1089,-1154.21"/>
<polygon fill="black" stroke="black" points="1092.5,-1153.95 1089,-1143.95 1085.5,-1153.95 1092.5,-1153.95"/>
</g>
<!-- out_proj_1_0 -->
<g id="node17" class="node">
<title>out_proj_1_0</title>
<polygon fill="lightpink" stroke="black" points="1239,-1053.91 1055,-1053.91 1055,-985.91 1239,-985.91 1239,-1053.91"/>
<text text-anchor="middle" x="1147" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1147" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1147" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1147" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_0&#45;&gt;out_proj_1_0 -->
<g id="edge10" class="edge">
<title>attn_1_0&#45;&gt;out_proj_1_0</title>
<path fill="none" stroke="black" d="M1104.54,-1090.81C1109.78,-1082.18 1115.78,-1072.31 1121.58,-1062.76"/>
<polygon fill="black" stroke="black" points="1124.62,-1064.49 1126.82,-1054.13 1118.64,-1060.86 1124.62,-1064.49"/>
</g>
<!-- concat_dim_1 -->
<g id="node52" class="node">
<title>concat_dim_1</title>
<polygon fill="orange" stroke="black" points="1693.5,-948.91 1460.5,-948.91 1460.5,-880.91 1693.5,-880.91 1693.5,-948.91"/>
<text text-anchor="middle" x="1577" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="1577" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="1577" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1577" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_1_0&#45;&gt;concat_dim_1 -->
<g id="edge37" class="edge">
<title>out_proj_1_0&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1239.16,-992.4C1247.54,-990.15 1255.92,-987.95 1264,-985.91 1325.11,-970.47 1393.38,-954.99 1450.53,-942.54"/>
<polygon fill="black" stroke="black" points="1451.3,-945.95 1460.33,-940.41 1449.81,-939.11 1451.3,-945.95"/>
</g>
<!-- qkv_1_1 -->
<g id="node18" class="node">
<title>qkv_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1425,-1248.91 1241,-1248.91 1241,-1180.91 1425,-1180.91 1425,-1248.91"/>
<text text-anchor="middle" x="1333" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1333" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1333" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1333" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_1 -->
<g id="node19" class="node">
<title>attn_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1446,-1143.91 1220,-1143.91 1220,-1090.91 1446,-1090.91 1446,-1143.91"/>
<text text-anchor="middle" x="1333" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1333" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1333" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_1_1&#45;&gt;attn_1_1 -->
<g id="edge11" class="edge">
<title>qkv_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M1333,-1180.77C1333,-1172.19 1333,-1162.92 1333,-1154.21"/>
<polygon fill="black" stroke="black" points="1336.5,-1153.95 1333,-1143.95 1329.5,-1153.95 1336.5,-1153.95"/>
</g>
<!-- out_proj_1_1 -->
<g id="node20" class="node">
<title>out_proj_1_1</title>
<polygon fill="lightcyan" stroke="black" points="1457,-1053.91 1273,-1053.91 1273,-985.91 1457,-985.91 1457,-1053.91"/>
<text text-anchor="middle" x="1365" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1365" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1365" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="1365" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_1&#45;&gt;out_proj_1_1 -->
<g id="edge12" class="edge">
<title>attn_1_1&#45;&gt;out_proj_1_1</title>
<path fill="none" stroke="black" d="M1341.58,-1090.81C1344.38,-1082.45 1347.57,-1072.92 1350.68,-1063.64"/>
<polygon fill="black" stroke="black" points="1354.01,-1064.72 1353.87,-1054.13 1347.37,-1062.5 1354.01,-1064.72"/>
</g>
<!-- out_proj_1_1&#45;&gt;concat_dim_1 -->
<g id="edge38" class="edge">
<title>out_proj_1_1&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1432.95,-985.89C1454.25,-975.54 1477.92,-964.05 1499.81,-953.41"/>
<polygon fill="black" stroke="black" points="1501.6,-956.43 1509.07,-948.91 1498.54,-950.13 1501.6,-956.43"/>
</g>
<!-- qkv_1_2 -->
<g id="node21" class="node">
<title>qkv_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1669,-1248.91 1485,-1248.91 1485,-1180.91 1669,-1180.91 1669,-1248.91"/>
<text text-anchor="middle" x="1577" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1577" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1577" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_2 -->
<g id="node22" class="node">
<title>attn_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1690,-1143.91 1464,-1143.91 1464,-1090.91 1690,-1090.91 1690,-1143.91"/>
<text text-anchor="middle" x="1577" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1577" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_1_2&#45;&gt;attn_1_2 -->
<g id="edge13" class="edge">
<title>qkv_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M1577,-1180.77C1577,-1172.19 1577,-1162.92 1577,-1154.21"/>
<polygon fill="black" stroke="black" points="1580.5,-1153.95 1577,-1143.95 1573.5,-1153.95 1580.5,-1153.95"/>
</g>
<!-- out_proj_1_2 -->
<g id="node23" class="node">
<title>out_proj_1_2</title>
<polygon fill="lightgrey" stroke="black" points="1669,-1053.91 1485,-1053.91 1485,-985.91 1669,-985.91 1669,-1053.91"/>
<text text-anchor="middle" x="1577" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1577" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1577" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="1577" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_2&#45;&gt;out_proj_1_2 -->
<g id="edge14" class="edge">
<title>attn_1_2&#45;&gt;out_proj_1_2</title>
<path fill="none" stroke="black" d="M1577,-1090.81C1577,-1082.63 1577,-1073.32 1577,-1064.23"/>
<polygon fill="black" stroke="black" points="1580.5,-1064.13 1577,-1054.13 1573.5,-1064.13 1580.5,-1064.13"/>
</g>
<!-- out_proj_1_2&#45;&gt;concat_dim_1 -->
<g id="edge39" class="edge">
<title>out_proj_1_2&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1577,-985.75C1577,-977.3 1577,-968.08 1577,-959.21"/>
<polygon fill="black" stroke="black" points="1580.5,-959 1577,-949 1573.5,-959 1580.5,-959"/>
</g>
<!-- qkv_1_3 -->
<g id="node24" class="node">
<title>qkv_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1913,-1248.91 1729,-1248.91 1729,-1180.91 1913,-1180.91 1913,-1248.91"/>
<text text-anchor="middle" x="1821" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1821" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1821" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1821" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_1_3 -->
<g id="node25" class="node">
<title>attn_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1934,-1143.91 1708,-1143.91 1708,-1090.91 1934,-1090.91 1934,-1143.91"/>
<text text-anchor="middle" x="1821" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1821" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1821" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_1_3&#45;&gt;attn_1_3 -->
<g id="edge15" class="edge">
<title>qkv_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M1821,-1180.77C1821,-1172.19 1821,-1162.92 1821,-1154.21"/>
<polygon fill="black" stroke="black" points="1824.5,-1153.95 1821,-1143.95 1817.5,-1153.95 1824.5,-1153.95"/>
</g>
<!-- out_proj_1_3 -->
<g id="node26" class="node">
<title>out_proj_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="1892,-1053.91 1708,-1053.91 1708,-985.91 1892,-985.91 1892,-1053.91"/>
<text text-anchor="middle" x="1800" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1800" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="1800" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="1800" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_3&#45;&gt;out_proj_1_3 -->
<g id="edge16" class="edge">
<title>attn_1_3&#45;&gt;out_proj_1_3</title>
<path fill="none" stroke="black" d="M1815.37,-1090.81C1813.55,-1082.54 1811.48,-1073.12 1809.46,-1063.94"/>
<polygon fill="black" stroke="black" points="1812.87,-1063.14 1807.31,-1054.13 1806.03,-1064.65 1812.87,-1063.14"/>
</g>
<!-- out_proj_1_3&#45;&gt;concat_dim_1 -->
<g id="edge40" class="edge">
<title>out_proj_1_3&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M1728.52,-985.89C1705.92,-975.45 1680.78,-963.84 1657.58,-953.13"/>
<polygon fill="black" stroke="black" points="1659,-949.93 1648.46,-948.91 1656.07,-956.28 1659,-949.93"/>
</g>
<!-- qkv_2_0 -->
<g id="node27" class="node">
<title>qkv_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2157,-1248.91 1973,-1248.91 1973,-1180.91 2157,-1180.91 2157,-1248.91"/>
<text text-anchor="middle" x="2065" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2065" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2065" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2065" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0 -->
<g id="node28" class="node">
<title>attn_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2178,-1143.91 1952,-1143.91 1952,-1090.91 2178,-1090.91 2178,-1143.91"/>
<text text-anchor="middle" x="2065" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2065" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2065" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_0&#45;&gt;attn_2_0 -->
<g id="edge17" class="edge">
<title>qkv_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M2065,-1180.77C2065,-1172.19 2065,-1162.92 2065,-1154.21"/>
<polygon fill="black" stroke="black" points="2068.5,-1153.95 2065,-1143.95 2061.5,-1153.95 2068.5,-1153.95"/>
</g>
<!-- out_proj_2_0 -->
<g id="node29" class="node">
<title>out_proj_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="2178,-1053.91 1994,-1053.91 1994,-985.91 2178,-985.91 2178,-1053.91"/>
<text text-anchor="middle" x="2086" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2086" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2086" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2086" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0&#45;&gt;out_proj_2_0 -->
<g id="edge18" class="edge">
<title>attn_2_0&#45;&gt;out_proj_2_0</title>
<path fill="none" stroke="black" d="M2070.63,-1090.81C2072.45,-1082.54 2074.52,-1073.12 2076.54,-1063.94"/>
<polygon fill="black" stroke="black" points="2079.97,-1064.65 2078.69,-1054.13 2073.13,-1063.14 2079.97,-1064.65"/>
</g>
<!-- concat_dim_2 -->
<g id="node53" class="node">
<title>concat_dim_2</title>
<polygon fill="orange" stroke="black" points="2425.5,-948.91 2192.5,-948.91 2192.5,-880.91 2425.5,-880.91 2425.5,-948.91"/>
<text text-anchor="middle" x="2309" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="2309" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="2309" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="2309" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_0&#45;&gt;concat_dim_2 -->
<g id="edge41" class="edge">
<title>out_proj_2_0&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2157.48,-985.89C2180.08,-975.45 2205.22,-963.84 2228.42,-953.13"/>
<polygon fill="black" stroke="black" points="2229.93,-956.28 2237.54,-948.91 2227,-949.93 2229.93,-956.28"/>
</g>
<!-- qkv_2_1 -->
<g id="node30" class="node">
<title>qkv_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2401,-1248.91 2217,-1248.91 2217,-1180.91 2401,-1180.91 2401,-1248.91"/>
<text text-anchor="middle" x="2309" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2309" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2309" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1 -->
<g id="node31" class="node">
<title>attn_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2422,-1143.91 2196,-1143.91 2196,-1090.91 2422,-1090.91 2422,-1143.91"/>
<text text-anchor="middle" x="2309" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2309" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_1&#45;&gt;attn_2_1 -->
<g id="edge19" class="edge">
<title>qkv_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M2309,-1180.77C2309,-1172.19 2309,-1162.92 2309,-1154.21"/>
<polygon fill="black" stroke="black" points="2312.5,-1153.95 2309,-1143.95 2305.5,-1153.95 2312.5,-1153.95"/>
</g>
<!-- out_proj_2_1 -->
<g id="node32" class="node">
<title>out_proj_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="2401,-1053.91 2217,-1053.91 2217,-985.91 2401,-985.91 2401,-1053.91"/>
<text text-anchor="middle" x="2309" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2309" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2309" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2309" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1&#45;&gt;out_proj_2_1 -->
<g id="edge20" class="edge">
<title>attn_2_1&#45;&gt;out_proj_2_1</title>
<path fill="none" stroke="black" d="M2309,-1090.81C2309,-1082.63 2309,-1073.32 2309,-1064.23"/>
<polygon fill="black" stroke="black" points="2312.5,-1064.13 2309,-1054.13 2305.5,-1064.13 2312.5,-1064.13"/>
</g>
<!-- out_proj_2_1&#45;&gt;concat_dim_2 -->
<g id="edge42" class="edge">
<title>out_proj_2_1&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2309,-985.75C2309,-977.3 2309,-968.08 2309,-959.21"/>
<polygon fill="black" stroke="black" points="2312.5,-959 2309,-949 2305.5,-959 2312.5,-959"/>
</g>
<!-- qkv_2_2 -->
<g id="node33" class="node">
<title>qkv_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2645,-1248.91 2461,-1248.91 2461,-1180.91 2645,-1180.91 2645,-1248.91"/>
<text text-anchor="middle" x="2553" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2553" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2553" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2553" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2 -->
<g id="node34" class="node">
<title>attn_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2666,-1143.91 2440,-1143.91 2440,-1090.91 2666,-1090.91 2666,-1143.91"/>
<text text-anchor="middle" x="2553" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2553" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2553" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2&#45;&gt;attn_2_2 -->
<g id="edge21" class="edge">
<title>qkv_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M2553,-1180.77C2553,-1172.19 2553,-1162.92 2553,-1154.21"/>
<polygon fill="black" stroke="black" points="2556.5,-1153.95 2553,-1143.95 2549.5,-1153.95 2556.5,-1153.95"/>
</g>
<!-- out_proj_2_2 -->
<g id="node35" class="node">
<title>out_proj_2_2</title>
<polygon fill="lightslategray" stroke="black" points="2613,-1053.91 2429,-1053.91 2429,-985.91 2613,-985.91 2613,-1053.91"/>
<text text-anchor="middle" x="2521" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2521" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2521" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="2521" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2&#45;&gt;out_proj_2_2 -->
<g id="edge22" class="edge">
<title>attn_2_2&#45;&gt;out_proj_2_2</title>
<path fill="none" stroke="black" d="M2544.42,-1090.81C2541.62,-1082.45 2538.43,-1072.92 2535.32,-1063.64"/>
<polygon fill="black" stroke="black" points="2538.63,-1062.5 2532.13,-1054.13 2531.99,-1064.72 2538.63,-1062.5"/>
</g>
<!-- out_proj_2_2&#45;&gt;concat_dim_2 -->
<g id="edge43" class="edge">
<title>out_proj_2_2&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2453.05,-985.89C2431.75,-975.54 2408.08,-964.05 2386.19,-953.41"/>
<polygon fill="black" stroke="black" points="2387.46,-950.13 2376.93,-948.91 2384.4,-956.43 2387.46,-950.13"/>
</g>
<!-- qkv_2_3 -->
<g id="node36" class="node">
<title>qkv_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2889,-1248.91 2705,-1248.91 2705,-1180.91 2889,-1180.91 2889,-1248.91"/>
<text text-anchor="middle" x="2797" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2797" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2797" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2797" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3 -->
<g id="node37" class="node">
<title>attn_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2910,-1143.91 2684,-1143.91 2684,-1090.91 2910,-1090.91 2910,-1143.91"/>
<text text-anchor="middle" x="2797" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2797" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2797" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_3&#45;&gt;attn_2_3 -->
<g id="edge23" class="edge">
<title>qkv_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M2797,-1180.77C2797,-1172.19 2797,-1162.92 2797,-1154.21"/>
<polygon fill="black" stroke="black" points="2800.5,-1153.95 2797,-1143.95 2793.5,-1153.95 2800.5,-1153.95"/>
</g>
<!-- out_proj_2_3 -->
<g id="node38" class="node">
<title>out_proj_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="2831,-1053.91 2647,-1053.91 2647,-985.91 2831,-985.91 2831,-1053.91"/>
<text text-anchor="middle" x="2739" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2739" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="2739" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="2739" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3&#45;&gt;out_proj_2_3 -->
<g id="edge24" class="edge">
<title>attn_2_3&#45;&gt;out_proj_2_3</title>
<path fill="none" stroke="black" d="M2781.46,-1090.81C2776.22,-1082.18 2770.22,-1072.31 2764.42,-1062.76"/>
<polygon fill="black" stroke="black" points="2767.36,-1060.86 2759.18,-1054.13 2761.38,-1064.49 2767.36,-1060.86"/>
</g>
<!-- out_proj_2_3&#45;&gt;concat_dim_2 -->
<g id="edge44" class="edge">
<title>out_proj_2_3&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2646.84,-992.4C2638.46,-990.15 2630.08,-987.95 2622,-985.91 2560.89,-970.47 2492.62,-954.99 2435.47,-942.54"/>
<polygon fill="black" stroke="black" points="2436.19,-939.11 2425.67,-940.41 2434.7,-945.95 2436.19,-939.11"/>
</g>
<!-- qkv_3_0 -->
<g id="node39" class="node">
<title>qkv_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3133,-1248.91 2949,-1248.91 2949,-1180.91 3133,-1180.91 3133,-1248.91"/>
<text text-anchor="middle" x="3041" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3041" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3041" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3041" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0 -->
<g id="node40" class="node">
<title>attn_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3154,-1143.91 2928,-1143.91 2928,-1090.91 3154,-1090.91 3154,-1143.91"/>
<text text-anchor="middle" x="3041" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3041" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3041" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_0&#45;&gt;attn_3_0 -->
<g id="edge25" class="edge">
<title>qkv_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M3041,-1180.77C3041,-1172.19 3041,-1162.92 3041,-1154.21"/>
<polygon fill="black" stroke="black" points="3044.5,-1153.95 3041,-1143.95 3037.5,-1153.95 3044.5,-1153.95"/>
</g>
<!-- out_proj_3_0 -->
<g id="node41" class="node">
<title>out_proj_3_0</title>
<polygon fill="#eedd82" stroke="black" points="3165,-1053.91 2981,-1053.91 2981,-985.91 3165,-985.91 3165,-1053.91"/>
<text text-anchor="middle" x="3073" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3073" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3073" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3073" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0&#45;&gt;out_proj_3_0 -->
<g id="edge26" class="edge">
<title>attn_3_0&#45;&gt;out_proj_3_0</title>
<path fill="none" stroke="black" d="M3049.58,-1090.81C3052.38,-1082.45 3055.57,-1072.92 3058.68,-1063.64"/>
<polygon fill="black" stroke="black" points="3062.01,-1064.72 3061.87,-1054.13 3055.37,-1062.5 3062.01,-1064.72"/>
</g>
<!-- concat_dim_3 -->
<g id="node54" class="node">
<title>concat_dim_3</title>
<polygon fill="orange" stroke="black" points="3401.5,-948.91 3168.5,-948.91 3168.5,-880.91 3401.5,-880.91 3401.5,-948.91"/>
<text text-anchor="middle" x="3285" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="3285" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="3285" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="3285" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_0&#45;&gt;concat_dim_3 -->
<g id="edge45" class="edge">
<title>out_proj_3_0&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3140.95,-985.89C3162.25,-975.54 3185.92,-964.05 3207.81,-953.41"/>
<polygon fill="black" stroke="black" points="3209.6,-956.43 3217.07,-948.91 3206.54,-950.13 3209.6,-956.43"/>
</g>
<!-- qkv_3_1 -->
<g id="node42" class="node">
<title>qkv_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3377,-1248.91 3193,-1248.91 3193,-1180.91 3377,-1180.91 3377,-1248.91"/>
<text text-anchor="middle" x="3285" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3285" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="3285" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1 -->
<g id="node43" class="node">
<title>attn_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3398,-1143.91 3172,-1143.91 3172,-1090.91 3398,-1090.91 3398,-1143.91"/>
<text text-anchor="middle" x="3285" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3285" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_1&#45;&gt;attn_3_1 -->
<g id="edge27" class="edge">
<title>qkv_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M3285,-1180.77C3285,-1172.19 3285,-1162.92 3285,-1154.21"/>
<polygon fill="black" stroke="black" points="3288.5,-1153.95 3285,-1143.95 3281.5,-1153.95 3288.5,-1153.95"/>
</g>
<!-- out_proj_3_1 -->
<g id="node44" class="node">
<title>out_proj_3_1</title>
<polygon fill="lightcoral" stroke="black" points="3377,-1053.91 3193,-1053.91 3193,-985.91 3377,-985.91 3377,-1053.91"/>
<text text-anchor="middle" x="3285" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3285" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3285" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="3285" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1&#45;&gt;out_proj_3_1 -->
<g id="edge28" class="edge">
<title>attn_3_1&#45;&gt;out_proj_3_1</title>
<path fill="none" stroke="black" d="M3285,-1090.81C3285,-1082.63 3285,-1073.32 3285,-1064.23"/>
<polygon fill="black" stroke="black" points="3288.5,-1064.13 3285,-1054.13 3281.5,-1064.13 3288.5,-1064.13"/>
</g>
<!-- out_proj_3_1&#45;&gt;concat_dim_3 -->
<g id="edge46" class="edge">
<title>out_proj_3_1&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3285,-985.75C3285,-977.3 3285,-968.08 3285,-959.21"/>
<polygon fill="black" stroke="black" points="3288.5,-959 3285,-949 3281.5,-959 3288.5,-959"/>
</g>
<!-- qkv_3_2 -->
<g id="node45" class="node">
<title>qkv_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3621,-1248.91 3437,-1248.91 3437,-1180.91 3621,-1180.91 3621,-1248.91"/>
<text text-anchor="middle" x="3529" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3529" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3529" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3529" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2 -->
<g id="node46" class="node">
<title>attn_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3642,-1143.91 3416,-1143.91 3416,-1090.91 3642,-1090.91 3642,-1143.91"/>
<text text-anchor="middle" x="3529" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3529" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3529" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_2&#45;&gt;attn_3_2 -->
<g id="edge29" class="edge">
<title>qkv_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M3529,-1180.77C3529,-1172.19 3529,-1162.92 3529,-1154.21"/>
<polygon fill="black" stroke="black" points="3532.5,-1153.95 3529,-1143.95 3525.5,-1153.95 3532.5,-1153.95"/>
</g>
<!-- out_proj_3_2 -->
<g id="node47" class="node">
<title>out_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="3590,-1053.91 3406,-1053.91 3406,-985.91 3590,-985.91 3590,-1053.91"/>
<text text-anchor="middle" x="3498" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3498" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3498" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3498" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2&#45;&gt;out_proj_3_2 -->
<g id="edge30" class="edge">
<title>attn_3_2&#45;&gt;out_proj_3_2</title>
<path fill="none" stroke="black" d="M3520.69,-1090.81C3517.98,-1082.45 3514.88,-1072.92 3511.87,-1063.64"/>
<polygon fill="black" stroke="black" points="3515.2,-1062.56 3508.78,-1054.13 3508.54,-1064.72 3515.2,-1062.56"/>
</g>
<!-- out_proj_3_2&#45;&gt;concat_dim_3 -->
<g id="edge47" class="edge">
<title>out_proj_3_2&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3429.73,-985.89C3408.23,-975.5 3384.34,-963.94 3362.26,-953.27"/>
<polygon fill="black" stroke="black" points="3363.78,-950.11 3353.25,-948.91 3360.73,-956.42 3363.78,-950.11"/>
</g>
<!-- qkv_3_3 -->
<g id="node48" class="node">
<title>qkv_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3865,-1248.91 3681,-1248.91 3681,-1180.91 3865,-1180.91 3865,-1248.91"/>
<text text-anchor="middle" x="3773" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3773" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3773" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3773" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3 -->
<g id="node49" class="node">
<title>attn_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3886,-1143.91 3660,-1143.91 3660,-1090.91 3886,-1090.91 3886,-1143.91"/>
<text text-anchor="middle" x="3773" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3773" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3773" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3&#45;&gt;attn_3_3 -->
<g id="edge31" class="edge">
<title>qkv_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M3773,-1180.77C3773,-1172.19 3773,-1162.92 3773,-1154.21"/>
<polygon fill="black" stroke="black" points="3776.5,-1153.95 3773,-1143.95 3769.5,-1153.95 3776.5,-1153.95"/>
</g>
<!-- out_proj_3_3 -->
<g id="node50" class="node">
<title>out_proj_3_3</title>
<polygon fill="lightyellow" stroke="black" points="3813,-1053.91 3629,-1053.91 3629,-985.91 3813,-985.91 3813,-1053.91"/>
<text text-anchor="middle" x="3721" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3721" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="3721" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3721" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3&#45;&gt;out_proj_3_3 -->
<g id="edge32" class="edge">
<title>attn_3_3&#45;&gt;out_proj_3_3</title>
<path fill="none" stroke="black" d="M3759.06,-1090.81C3754.41,-1082.27 3749.1,-1072.52 3743.95,-1063.06"/>
<polygon fill="black" stroke="black" points="3746.94,-1061.24 3739.09,-1054.13 3740.8,-1064.58 3746.94,-1061.24"/>
</g>
<!-- out_proj_3_3&#45;&gt;concat_dim_3 -->
<g id="edge48" class="edge">
<title>out_proj_3_3&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M3628.85,-993.51C3618.79,-990.88 3608.69,-988.3 3599,-985.91 3537.49,-970.74 3468.83,-955.27 3411.45,-942.74"/>
<polygon fill="black" stroke="black" points="3412.12,-939.31 3401.6,-940.6 3410.63,-946.15 3412.12,-939.31"/>
</g>
<!-- concat_heads -->
<g id="node55" class="node">
<title>concat_heads</title>
<polygon fill="gold" stroke="black" points="2347,-818.93 2143,-818.93 2143,-765.93 2347,-765.93 2347,-818.93"/>
<text text-anchor="middle" x="2245" y="-803.73" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="2245" y="-788.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="2245" y="-773.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0&#45;&gt;concat_heads -->
<g id="edge49" class="edge">
<title>concat_dim_0&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M717.79,-909.28C1051.88,-895.78 1996.4,-855.82 2134,-829.91 2144.87,-827.86 2156.14,-825.03 2167.16,-821.84"/>
<polygon fill="black" stroke="black" points="2168.18,-825.19 2176.76,-818.96 2166.17,-818.49 2168.18,-825.19"/>
</g>
<!-- concat_dim_1&#45;&gt;concat_heads -->
<g id="edge50" class="edge">
<title>concat_dim_1&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M1693.57,-902.1C1807.02,-889.25 1983.8,-865.64 2134,-829.91 2143.62,-827.62 2153.6,-824.88 2163.46,-821.94"/>
<polygon fill="black" stroke="black" points="2164.71,-825.22 2173.25,-818.95 2162.67,-818.52 2164.71,-825.22"/>
</g>
<!-- concat_dim_2&#45;&gt;concat_heads -->
<g id="edge51" class="edge">
<title>concat_dim_2&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M2291.34,-880.67C2282.74,-864.48 2272.4,-845.02 2263.67,-828.58"/>
<polygon fill="black" stroke="black" points="2266.53,-826.5 2258.75,-819.31 2260.35,-829.78 2266.53,-826.5"/>
</g>
<!-- concat_dim_3&#45;&gt;concat_heads -->
<g id="edge52" class="edge">
<title>concat_dim_3&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M3168.22,-913.68C2990.53,-911.02 2642.64,-896.75 2356,-829.91 2346.3,-827.64 2336.23,-824.91 2326.29,-821.96"/>
<polygon fill="black" stroke="black" points="2327.01,-818.52 2316.42,-818.95 2324.97,-825.21 2327.01,-818.52"/>
</g>
<!-- concat_heads&#45;&gt;res1 -->
<g id="edge54" class="edge">
<title>concat_heads&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M2245,-765.93C2245,-752.46 2245,-735.71 2245,-720.94"/>
<polygon fill="black" stroke="black" points="2248.5,-720.62 2245,-710.62 2241.5,-720.62 2248.5,-720.62"/>
</g>
<!-- ln2 -->
<g id="node57" class="node">
<title>ln2</title>
<polygon fill="lightgray" stroke="black" points="2341.5,-591.45 2148.5,-591.45 2148.5,-538.45 2341.5,-538.45 2341.5,-591.45"/>
<text text-anchor="middle" x="2245" y="-576.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2245" y="-561.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="2245" y="-546.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;ln2 -->
<g id="edge55" class="edge">
<title>res1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M2245,-657.28C2245,-640.97 2245,-619.63 2245,-601.68"/>
<polygon fill="black" stroke="black" points="2248.5,-601.57 2245,-591.57 2241.5,-601.57 2248.5,-601.57"/>
</g>
<!-- res2 -->
<g id="node68" class="node">
<title>res2</title>
<polygon fill="lightcyan" stroke="black" points="2917.5,-591.45 2724.5,-591.45 2724.5,-538.45 2917.5,-538.45 2917.5,-591.45"/>
<text text-anchor="middle" x="2821" y="-576.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2821" y="-561.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="2821" y="-546.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge72" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2341.73,-663.3C2444.9,-642.35 2607.82,-609.25 2714.56,-587.57"/>
<polygon fill="black" stroke="black" points="2715.29,-591 2724.39,-585.58 2713.89,-584.14 2715.29,-591"/>
</g>
<!-- gate -->
<g id="node58" class="node">
<title>gate</title>
<polygon fill="lightpink" stroke="black" points="3664.5,-948.91 3471.5,-948.91 3471.5,-880.91 3664.5,-880.91 3664.5,-948.91"/>
<text text-anchor="middle" x="3568" y="-933.71" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="3568" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="3568" y="-903.71" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="3568" y="-888.71" font-family="Times,serif" font-size="14.00">Expert Selection</text>
</g>
<!-- expert_0 -->
<g id="node59" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="3217,-826.43 2945,-826.43 2945,-758.43 3217,-758.43 3217,-826.43"/>
<text text-anchor="middle" x="3081" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3081" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="3081" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3081" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_0 -->
<g id="edge56" class="edge">
<title>gate&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.41,-890.34C3402.89,-873.58 3308.77,-850.48 3226,-829.91 3224.72,-829.59 3223.44,-829.27 3222.16,-828.95"/>
<polygon fill="black" stroke="black" points="3222.74,-825.49 3212.19,-826.47 3221.05,-832.28 3222.74,-825.49"/>
<text text-anchor="middle" x="3403.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_1 -->
<g id="node60" class="node">
<title>expert_1</title>
<polygon fill="lightcoral" stroke="black" points="3507,-826.43 3235,-826.43 3235,-758.43 3507,-758.43 3507,-826.43"/>
<text text-anchor="middle" x="3371" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3371" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="3371" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3371" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_1 -->
<g id="edge57" class="edge">
<title>gate&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3513.91,-880.83C3489.04,-865.62 3459.4,-847.49 3433.57,-831.7"/>
<polygon fill="black" stroke="black" points="3435.33,-828.67 3424.97,-826.44 3431.68,-834.64 3435.33,-828.67"/>
<text text-anchor="middle" x="3527.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2 -->
<g id="node61" class="node">
<title>expert_2</title>
<polygon fill="lightgreen" stroke="black" points="3797,-826.43 3525,-826.43 3525,-758.43 3797,-758.43 3797,-826.43"/>
<text text-anchor="middle" x="3661" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3661" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="3661" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3661" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_2 -->
<g id="edge58" class="edge">
<title>gate&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3593.66,-880.67C3604.64,-866.45 3617.57,-849.69 3629.15,-834.69"/>
<polygon fill="black" stroke="black" points="3632.08,-836.62 3635.42,-826.56 3626.54,-832.34 3632.08,-836.62"/>
<text text-anchor="middle" x="3663.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3 -->
<g id="node62" class="node">
<title>expert_3</title>
<polygon fill="lightyellow" stroke="black" points="4087,-826.43 3815,-826.43 3815,-758.43 4087,-758.43 4087,-826.43"/>
<text text-anchor="middle" x="3951" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3951" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="3951" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3951" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_3 -->
<g id="edge59" class="edge">
<title>gate&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3664.65,-883.51C3716.81,-867.1 3781.52,-846.74 3836.23,-829.53"/>
<polygon fill="black" stroke="black" points="3837.48,-832.81 3845.97,-826.47 3835.38,-826.13 3837.48,-832.81"/>
<text text-anchor="middle" x="3816.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4 -->
<g id="node63" class="node">
<title>expert_4</title>
<polygon fill="lightpink" stroke="black" points="4377,-826.43 4105,-826.43 4105,-758.43 4377,-758.43 4377,-826.43"/>
<text text-anchor="middle" x="4241" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4241" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="4241" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4241" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_4 -->
<g id="edge60" class="edge">
<title>gate&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3664.81,-901.13C3771.06,-886.5 3946.42,-860.56 4096,-829.91 4098.09,-829.48 4100.19,-829.04 4102.3,-828.6"/>
<polygon fill="black" stroke="black" points="4103.23,-831.98 4112.27,-826.44 4101.75,-825.13 4103.23,-831.98"/>
<text text-anchor="middle" x="4041.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_5 -->
<g id="node64" class="node">
<title>expert_5</title>
<polygon fill="lightcyan" stroke="black" points="4667,-826.43 4395,-826.43 4395,-758.43 4667,-758.43 4667,-826.43"/>
<text text-anchor="middle" x="4531" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4531" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="4531" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4531" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_5 -->
<g id="edge61" class="edge">
<title>gate&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3664.69,-908.79C3818.44,-899.57 4127.69,-876.62 4386,-829.91 4388.66,-829.43 4391.35,-828.92 4394.05,-828.4"/>
<polygon fill="black" stroke="black" points="4394.78,-831.82 4403.9,-826.44 4393.41,-824.96 4394.78,-831.82"/>
<text text-anchor="middle" x="4321.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_6 -->
<g id="node65" class="node">
<title>expert_6</title>
<polygon fill="lightgrey" stroke="black" points="2637,-826.43 2365,-826.43 2365,-758.43 2637,-758.43 2637,-826.43"/>
<text text-anchor="middle" x="2501" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2501" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="2501" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2501" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_6 -->
<g id="edge62" class="edge">
<title>gate&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.5,-891.1C3451.28,-887.07 3430.02,-883.38 3410,-880.91 3210.47,-856.27 3158.52,-877.49 2958,-862.91 2818.93,-852.79 2783.29,-854.31 2646,-829.91 2643.34,-829.43 2640.65,-828.94 2637.95,-828.42"/>
<polygon fill="black" stroke="black" points="2638.58,-824.98 2628.09,-826.48 2637.22,-831.85 2638.58,-824.98"/>
<text text-anchor="middle" x="3003.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_7 -->
<g id="node66" class="node">
<title>expert_7</title>
<polygon fill="lightseagreen" stroke="black" points="2927,-826.43 2655,-826.43 2655,-758.43 2927,-758.43 2927,-826.43"/>
<text text-anchor="middle" x="2791" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2791" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="2791" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2791" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate&#45;&gt;expert_7 -->
<g id="edge63" class="edge">
<title>gate&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.4,-891.85C3451.19,-887.76 3429.96,-883.86 3410,-880.91 3319.96,-867.58 3296.52,-872.43 3206,-862.91 3085.77,-850.26 3054.85,-852.03 2936,-829.91 2933.49,-829.44 2930.95,-828.95 2928.41,-828.45"/>
<polygon fill="black" stroke="black" points="2929,-825 2918.51,-826.44 2927.61,-831.86 2929,-825"/>
<text text-anchor="middle" x="3251.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg -->
<g id="node67" class="node">
<title>expert_agg</title>
<polygon fill="gold" stroke="black" points="3467.5,-717.95 3274.5,-717.95 3274.5,-649.95 3467.5,-649.95 3467.5,-717.95"/>
<text text-anchor="middle" x="3371" y="-702.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3371" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="3371" y="-672.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="3371" y="-657.75" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
</g>
<!-- expert_0&#45;&gt;expert_agg -->
<g id="edge64" class="edge">
<title>expert_0&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3171.17,-758.32C3202.95,-746.66 3238.85,-733.47 3271.36,-721.54"/>
<polygon fill="black" stroke="black" points="3272.71,-724.77 3280.89,-718.04 3270.29,-718.2 3272.71,-724.77"/>
</g>
<!-- expert_1&#45;&gt;expert_agg -->
<g id="edge65" class="edge">
<title>expert_1&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3371,-758.32C3371,-748.81 3371,-738.29 3371,-728.26"/>
<polygon fill="black" stroke="black" points="3374.5,-728.04 3371,-718.04 3367.5,-728.04 3374.5,-728.04"/>
</g>
<!-- expert_2&#45;&gt;expert_agg -->
<g id="edge66" class="edge">
<title>expert_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3570.83,-758.32C3539.05,-746.66 3503.15,-733.47 3470.64,-721.54"/>
<polygon fill="black" stroke="black" points="3471.71,-718.2 3461.11,-718.04 3469.29,-724.77 3471.71,-718.2"/>
</g>
<!-- expert_3&#45;&gt;expert_agg -->
<g id="edge67" class="edge">
<title>expert_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3822.26,-758.43C3816.78,-757.22 3811.34,-756.05 3806,-754.95 3694.72,-732.05 3566.14,-712.16 3477.79,-699.5"/>
<polygon fill="black" stroke="black" points="3478.16,-696.01 3467.76,-698.06 3477.17,-702.94 3478.16,-696.01"/>
</g>
<!-- expert_4&#45;&gt;expert_agg -->
<g id="edge68" class="edge">
<title>expert_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4114.31,-758.39C4108.14,-757.15 4102.01,-755.99 4096,-754.95 3878.19,-717.26 3619.8,-698.41 3477.8,-690.24"/>
<polygon fill="black" stroke="black" points="3477.96,-686.74 3467.78,-689.67 3477.57,-693.73 3477.96,-686.74"/>
</g>
<!-- expert_5&#45;&gt;expert_agg -->
<g id="edge69" class="edge">
<title>expert_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4405.53,-758.42C4398.95,-757.14 4392.41,-755.97 4386,-754.95 4057.55,-702.74 3663.18,-689.46 3477.53,-686.1"/>
<polygon fill="black" stroke="black" points="3477.56,-682.6 3467.5,-685.92 3477.44,-689.59 3477.56,-682.6"/>
</g>
<!-- expert_6&#45;&gt;expert_agg -->
<g id="edge70" class="edge">
<title>expert_6&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2627.69,-758.39C2633.86,-757.15 2639.99,-755.99 2646,-754.95 2863.81,-717.26 3122.2,-698.41 3264.2,-690.24"/>
<polygon fill="black" stroke="black" points="3264.43,-693.73 3274.22,-689.67 3264.04,-686.74 3264.43,-693.73"/>
</g>
<!-- expert_7&#45;&gt;expert_agg -->
<g id="edge71" class="edge">
<title>expert_7&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2919.74,-758.43C2925.22,-757.22 2930.66,-756.05 2936,-754.95 3047.28,-732.05 3175.86,-712.16 3264.21,-699.5"/>
<polygon fill="black" stroke="black" points="3264.83,-702.94 3274.24,-698.06 3263.84,-696.01 3264.83,-702.94"/>
</g>
<!-- expert_agg&#45;&gt;res2 -->
<g id="edge73" class="edge">
<title>expert_agg&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M3274.25,-662.37C3177.16,-641.72 3027.96,-609.98 2927.54,-588.62"/>
<polygon fill="black" stroke="black" points="2928.18,-585.17 2917.67,-586.52 2926.72,-592.02 2928.18,-585.17"/>
</g>
<!-- ln1_2 -->
<g id="node69" class="node">
<title>ln1_2</title>
<polygon fill="lightgray" stroke="black" points="4287.5,-1241.41 4094.5,-1241.41 4094.5,-1188.41 4287.5,-1188.41 4287.5,-1241.41"/>
<text text-anchor="middle" x="4191" y="-1226.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4191" y="-1211.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="4191" y="-1196.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_2_0_0 -->
<g id="node70" class="node">
<title>qkv_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4490,-1248.91 4306,-1248.91 4306,-1180.91 4490,-1180.91 4490,-1248.91"/>
<text text-anchor="middle" x="4398" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4398" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4398" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="4398" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_0 -->
<g id="node71" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4511,-1143.91 4285,-1143.91 4285,-1090.91 4511,-1090.91 4511,-1143.91"/>
<text text-anchor="middle" x="4398" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4398" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4398" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge74" class="edge">
<title>qkv_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M4398,-1180.77C4398,-1172.19 4398,-1162.92 4398,-1154.21"/>
<polygon fill="black" stroke="black" points="4401.5,-1153.95 4398,-1143.95 4394.5,-1153.95 4401.5,-1153.95"/>
</g>
<!-- out_proj_2_0_0 -->
<g id="node72" class="node">
<title>out_proj_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="4542,-1053.91 4358,-1053.91 4358,-985.91 4542,-985.91 4542,-1053.91"/>
<text text-anchor="middle" x="4450" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4450" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4450" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="4450" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_0&#45;&gt;out_proj_2_0_0 -->
<g id="edge75" class="edge">
<title>attn_2_0_0&#45;&gt;out_proj_2_0_0</title>
<path fill="none" stroke="black" d="M4411.94,-1090.81C4416.59,-1082.27 4421.9,-1072.52 4427.05,-1063.06"/>
<polygon fill="black" stroke="black" points="4430.2,-1064.58 4431.91,-1054.13 4424.06,-1061.24 4430.2,-1064.58"/>
</g>
<!-- concat_dim_2_0 -->
<g id="node118" class="node">
<title>concat_dim_2_0</title>
<polygon fill="orange" stroke="black" points="5002.5,-948.91 4769.5,-948.91 4769.5,-880.91 5002.5,-880.91 5002.5,-948.91"/>
<text text-anchor="middle" x="4886" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="4886" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="4886" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="4886" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge106" class="edge">
<title>out_proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M4542.15,-993.51C4552.21,-990.88 4562.31,-988.3 4572,-985.91 4633.51,-970.74 4702.17,-955.27 4759.55,-942.74"/>
<polygon fill="black" stroke="black" points="4760.37,-946.15 4769.4,-940.6 4758.88,-939.31 4760.37,-946.15"/>
</g>
<!-- qkv_2_0_1 -->
<g id="node73" class="node">
<title>qkv_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="4734,-1248.91 4550,-1248.91 4550,-1180.91 4734,-1180.91 4734,-1248.91"/>
<text text-anchor="middle" x="4642" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4642" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4642" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4642" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_1 -->
<g id="node74" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="4755,-1143.91 4529,-1143.91 4529,-1090.91 4755,-1090.91 4755,-1143.91"/>
<text text-anchor="middle" x="4642" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4642" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4642" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge76" class="edge">
<title>qkv_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M4642,-1180.77C4642,-1172.19 4642,-1162.92 4642,-1154.21"/>
<polygon fill="black" stroke="black" points="4645.5,-1153.95 4642,-1143.95 4638.5,-1153.95 4645.5,-1153.95"/>
</g>
<!-- out_proj_2_0_1 -->
<g id="node75" class="node">
<title>out_proj_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="4765,-1053.91 4581,-1053.91 4581,-985.91 4765,-985.91 4765,-1053.91"/>
<text text-anchor="middle" x="4673" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4673" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4673" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4673" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_1&#45;&gt;out_proj_2_0_1 -->
<g id="edge77" class="edge">
<title>attn_2_0_1&#45;&gt;out_proj_2_0_1</title>
<path fill="none" stroke="black" d="M4650.31,-1090.81C4653.02,-1082.45 4656.12,-1072.92 4659.13,-1063.64"/>
<polygon fill="black" stroke="black" points="4662.46,-1064.72 4662.22,-1054.13 4655.8,-1062.56 4662.46,-1064.72"/>
</g>
<!-- out_proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge107" class="edge">
<title>out_proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M4741.27,-985.89C4762.77,-975.5 4786.66,-963.94 4808.74,-953.27"/>
<polygon fill="black" stroke="black" points="4810.27,-956.42 4817.75,-948.91 4807.22,-950.11 4810.27,-956.42"/>
</g>
<!-- qkv_2_0_2 -->
<g id="node76" class="node">
<title>qkv_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4978,-1248.91 4794,-1248.91 4794,-1180.91 4978,-1180.91 4978,-1248.91"/>
<text text-anchor="middle" x="4886" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4886" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4886" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_2 -->
<g id="node77" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4999,-1143.91 4773,-1143.91 4773,-1090.91 4999,-1090.91 4999,-1143.91"/>
<text text-anchor="middle" x="4886" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4886" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge78" class="edge">
<title>qkv_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M4886,-1180.77C4886,-1172.19 4886,-1162.92 4886,-1154.21"/>
<polygon fill="black" stroke="black" points="4889.5,-1153.95 4886,-1143.95 4882.5,-1153.95 4889.5,-1153.95"/>
</g>
<!-- out_proj_2_0_2 -->
<g id="node78" class="node">
<title>out_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4978,-1053.91 4794,-1053.91 4794,-985.91 4978,-985.91 4978,-1053.91"/>
<text text-anchor="middle" x="4886" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4886" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="4886" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4886" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_2&#45;&gt;out_proj_2_0_2 -->
<g id="edge79" class="edge">
<title>attn_2_0_2&#45;&gt;out_proj_2_0_2</title>
<path fill="none" stroke="black" d="M4886,-1090.81C4886,-1082.63 4886,-1073.32 4886,-1064.23"/>
<polygon fill="black" stroke="black" points="4889.5,-1064.13 4886,-1054.13 4882.5,-1064.13 4889.5,-1064.13"/>
</g>
<!-- out_proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge108" class="edge">
<title>out_proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M4886,-985.75C4886,-977.3 4886,-968.08 4886,-959.21"/>
<polygon fill="black" stroke="black" points="4889.5,-959 4886,-949 4882.5,-959 4889.5,-959"/>
</g>
<!-- qkv_2_0_3 -->
<g id="node79" class="node">
<title>qkv_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="5222,-1248.91 5038,-1248.91 5038,-1180.91 5222,-1180.91 5222,-1248.91"/>
<text text-anchor="middle" x="5130" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5130" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5130" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5130" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_0_3 -->
<g id="node80" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="5243,-1143.91 5017,-1143.91 5017,-1090.91 5243,-1090.91 5243,-1143.91"/>
<text text-anchor="middle" x="5130" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5130" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5130" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge80" class="edge">
<title>qkv_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M5130,-1180.77C5130,-1172.19 5130,-1162.92 5130,-1154.21"/>
<polygon fill="black" stroke="black" points="5133.5,-1153.95 5130,-1143.95 5126.5,-1153.95 5133.5,-1153.95"/>
</g>
<!-- out_proj_2_0_3 -->
<g id="node81" class="node">
<title>out_proj_2_0_3</title>
<polygon fill="lightyellow" stroke="black" points="5190,-1053.91 5006,-1053.91 5006,-985.91 5190,-985.91 5190,-1053.91"/>
<text text-anchor="middle" x="5098" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5098" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5098" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5098" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0_3&#45;&gt;out_proj_2_0_3 -->
<g id="edge81" class="edge">
<title>attn_2_0_3&#45;&gt;out_proj_2_0_3</title>
<path fill="none" stroke="black" d="M5121.42,-1090.81C5118.62,-1082.45 5115.43,-1072.92 5112.32,-1063.64"/>
<polygon fill="black" stroke="black" points="5115.63,-1062.5 5109.13,-1054.13 5108.99,-1064.72 5115.63,-1062.5"/>
</g>
<!-- out_proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge109" class="edge">
<title>out_proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M5030.05,-985.89C5008.75,-975.54 4985.08,-964.05 4963.19,-953.41"/>
<polygon fill="black" stroke="black" points="4964.46,-950.13 4953.93,-948.91 4961.4,-956.43 4964.46,-950.13"/>
</g>
<!-- qkv_2_1_0 -->
<g id="node82" class="node">
<title>qkv_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="5466,-1248.91 5282,-1248.91 5282,-1180.91 5466,-1180.91 5466,-1248.91"/>
<text text-anchor="middle" x="5374" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5374" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5374" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5374" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_0 -->
<g id="node83" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="5487,-1143.91 5261,-1143.91 5261,-1090.91 5487,-1090.91 5487,-1143.91"/>
<text text-anchor="middle" x="5374" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5374" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5374" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge82" class="edge">
<title>qkv_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M5374,-1180.77C5374,-1172.19 5374,-1162.92 5374,-1154.21"/>
<polygon fill="black" stroke="black" points="5377.5,-1153.95 5374,-1143.95 5370.5,-1153.95 5377.5,-1153.95"/>
</g>
<!-- out_proj_2_1_0 -->
<g id="node84" class="node">
<title>out_proj_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="5521,-1053.91 5337,-1053.91 5337,-985.91 5521,-985.91 5521,-1053.91"/>
<text text-anchor="middle" x="5429" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5429" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5429" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="5429" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_0&#45;&gt;out_proj_2_1_0 -->
<g id="edge83" class="edge">
<title>attn_2_1_0&#45;&gt;out_proj_2_1_0</title>
<path fill="none" stroke="black" d="M5388.74,-1090.81C5393.66,-1082.27 5399.28,-1072.52 5404.73,-1063.06"/>
<polygon fill="black" stroke="black" points="5407.91,-1064.54 5409.87,-1054.13 5401.84,-1061.05 5407.91,-1064.54"/>
</g>
<!-- concat_dim_2_1 -->
<g id="node119" class="node">
<title>concat_dim_2_1</title>
<polygon fill="orange" stroke="black" points="5978.5,-948.91 5745.5,-948.91 5745.5,-880.91 5978.5,-880.91 5978.5,-948.91"/>
<text text-anchor="middle" x="5862" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="5862" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="5862" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5862" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge110" class="edge">
<title>out_proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M5521.26,-993.05C5530.61,-990.58 5539.98,-988.15 5549,-985.91 5610.16,-970.67 5678.44,-955.22 5735.57,-942.72"/>
<polygon fill="black" stroke="black" points="5736.35,-946.14 5745.37,-940.59 5734.86,-939.3 5736.35,-946.14"/>
</g>
<!-- qkv_2_1_1 -->
<g id="node85" class="node">
<title>qkv_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="5710,-1248.91 5526,-1248.91 5526,-1180.91 5710,-1180.91 5710,-1248.91"/>
<text text-anchor="middle" x="5618" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5618" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5618" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5618" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_1 -->
<g id="node86" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="5731,-1143.91 5505,-1143.91 5505,-1090.91 5731,-1090.91 5731,-1143.91"/>
<text text-anchor="middle" x="5618" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5618" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5618" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge84" class="edge">
<title>qkv_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M5618,-1180.77C5618,-1172.19 5618,-1162.92 5618,-1154.21"/>
<polygon fill="black" stroke="black" points="5621.5,-1153.95 5618,-1143.95 5614.5,-1153.95 5621.5,-1153.95"/>
</g>
<!-- out_proj_2_1_1 -->
<g id="node87" class="node">
<title>out_proj_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="5742,-1053.91 5558,-1053.91 5558,-985.91 5742,-985.91 5742,-1053.91"/>
<text text-anchor="middle" x="5650" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5650" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5650" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5650" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_1&#45;&gt;out_proj_2_1_1 -->
<g id="edge85" class="edge">
<title>attn_2_1_1&#45;&gt;out_proj_2_1_1</title>
<path fill="none" stroke="black" d="M5626.58,-1090.81C5629.38,-1082.45 5632.57,-1072.92 5635.68,-1063.64"/>
<polygon fill="black" stroke="black" points="5639.01,-1064.72 5638.87,-1054.13 5632.37,-1062.5 5639.01,-1064.72"/>
</g>
<!-- out_proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge111" class="edge">
<title>out_proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M5717.95,-985.89C5739.25,-975.54 5762.92,-964.05 5784.81,-953.41"/>
<polygon fill="black" stroke="black" points="5786.6,-956.43 5794.07,-948.91 5783.54,-950.13 5786.6,-956.43"/>
</g>
<!-- qkv_2_1_2 -->
<g id="node88" class="node">
<title>qkv_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5954,-1248.91 5770,-1248.91 5770,-1180.91 5954,-1180.91 5954,-1248.91"/>
<text text-anchor="middle" x="5862" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5862" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5862" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_2 -->
<g id="node89" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5975,-1143.91 5749,-1143.91 5749,-1090.91 5975,-1090.91 5975,-1143.91"/>
<text text-anchor="middle" x="5862" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5862" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge86" class="edge">
<title>qkv_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M5862,-1180.77C5862,-1172.19 5862,-1162.92 5862,-1154.21"/>
<polygon fill="black" stroke="black" points="5865.5,-1153.95 5862,-1143.95 5858.5,-1153.95 5865.5,-1153.95"/>
</g>
<!-- out_proj_2_1_2 -->
<g id="node90" class="node">
<title>out_proj_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="5954,-1053.91 5770,-1053.91 5770,-985.91 5954,-985.91 5954,-1053.91"/>
<text text-anchor="middle" x="5862" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5862" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="5862" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5862" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_2&#45;&gt;out_proj_2_1_2 -->
<g id="edge87" class="edge">
<title>attn_2_1_2&#45;&gt;out_proj_2_1_2</title>
<path fill="none" stroke="black" d="M5862,-1090.81C5862,-1082.63 5862,-1073.32 5862,-1064.23"/>
<polygon fill="black" stroke="black" points="5865.5,-1064.13 5862,-1054.13 5858.5,-1064.13 5865.5,-1064.13"/>
</g>
<!-- out_proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge112" class="edge">
<title>out_proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M5862,-985.75C5862,-977.3 5862,-968.08 5862,-959.21"/>
<polygon fill="black" stroke="black" points="5865.5,-959 5862,-949 5858.5,-959 5865.5,-959"/>
</g>
<!-- qkv_2_1_3 -->
<g id="node91" class="node">
<title>qkv_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="6198,-1248.91 6014,-1248.91 6014,-1180.91 6198,-1180.91 6198,-1248.91"/>
<text text-anchor="middle" x="6106" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6106" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6106" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6106" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_1_3 -->
<g id="node92" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="6219,-1143.91 5993,-1143.91 5993,-1090.91 6219,-1090.91 6219,-1143.91"/>
<text text-anchor="middle" x="6106" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6106" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6106" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge88" class="edge">
<title>qkv_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M6106,-1180.77C6106,-1172.19 6106,-1162.92 6106,-1154.21"/>
<polygon fill="black" stroke="black" points="6109.5,-1153.95 6106,-1143.95 6102.5,-1153.95 6109.5,-1153.95"/>
</g>
<!-- out_proj_2_1_3 -->
<g id="node93" class="node">
<title>out_proj_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="6167,-1053.91 5983,-1053.91 5983,-985.91 6167,-985.91 6167,-1053.91"/>
<text text-anchor="middle" x="6075" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6075" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6075" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6075" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1_3&#45;&gt;out_proj_2_1_3 -->
<g id="edge89" class="edge">
<title>attn_2_1_3&#45;&gt;out_proj_2_1_3</title>
<path fill="none" stroke="black" d="M6097.69,-1090.81C6094.98,-1082.45 6091.88,-1072.92 6088.87,-1063.64"/>
<polygon fill="black" stroke="black" points="6092.2,-1062.56 6085.78,-1054.13 6085.54,-1064.72 6092.2,-1062.56"/>
</g>
<!-- out_proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge113" class="edge">
<title>out_proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M6006.73,-985.89C5985.23,-975.5 5961.34,-963.94 5939.26,-953.27"/>
<polygon fill="black" stroke="black" points="5940.78,-950.11 5930.25,-948.91 5937.73,-956.42 5940.78,-950.11"/>
</g>
<!-- qkv_2_2_0 -->
<g id="node94" class="node">
<title>qkv_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6442,-1248.91 6258,-1248.91 6258,-1180.91 6442,-1180.91 6442,-1248.91"/>
<text text-anchor="middle" x="6350" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6350" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6350" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="6350" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_0 -->
<g id="node95" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6463,-1143.91 6237,-1143.91 6237,-1090.91 6463,-1090.91 6463,-1143.91"/>
<text text-anchor="middle" x="6350" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6350" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6350" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge90" class="edge">
<title>qkv_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M6350,-1180.77C6350,-1172.19 6350,-1162.92 6350,-1154.21"/>
<polygon fill="black" stroke="black" points="6353.5,-1153.95 6350,-1143.95 6346.5,-1153.95 6353.5,-1153.95"/>
</g>
<!-- out_proj_2_2_0 -->
<g id="node96" class="node">
<title>out_proj_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="6474,-1053.91 6290,-1053.91 6290,-985.91 6474,-985.91 6474,-1053.91"/>
<text text-anchor="middle" x="6382" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6382" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6382" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="6382" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_0&#45;&gt;out_proj_2_2_0 -->
<g id="edge91" class="edge">
<title>attn_2_2_0&#45;&gt;out_proj_2_2_0</title>
<path fill="none" stroke="black" d="M6358.58,-1090.81C6361.38,-1082.45 6364.57,-1072.92 6367.68,-1063.64"/>
<polygon fill="black" stroke="black" points="6371.01,-1064.72 6370.87,-1054.13 6364.37,-1062.5 6371.01,-1064.72"/>
</g>
<!-- concat_dim_2_2 -->
<g id="node120" class="node">
<title>concat_dim_2_2</title>
<polygon fill="orange" stroke="black" points="6710.5,-948.91 6477.5,-948.91 6477.5,-880.91 6710.5,-880.91 6710.5,-948.91"/>
<text text-anchor="middle" x="6594" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="6594" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="6594" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6594" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge114" class="edge">
<title>out_proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6449.95,-985.89C6471.25,-975.54 6494.92,-964.05 6516.81,-953.41"/>
<polygon fill="black" stroke="black" points="6518.6,-956.43 6526.07,-948.91 6515.54,-950.13 6518.6,-956.43"/>
</g>
<!-- qkv_2_2_1 -->
<g id="node97" class="node">
<title>qkv_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6686,-1248.91 6502,-1248.91 6502,-1180.91 6686,-1180.91 6686,-1248.91"/>
<text text-anchor="middle" x="6594" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6594" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6594" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_1 -->
<g id="node98" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6707,-1143.91 6481,-1143.91 6481,-1090.91 6707,-1090.91 6707,-1143.91"/>
<text text-anchor="middle" x="6594" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6594" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge92" class="edge">
<title>qkv_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M6594,-1180.77C6594,-1172.19 6594,-1162.92 6594,-1154.21"/>
<polygon fill="black" stroke="black" points="6597.5,-1153.95 6594,-1143.95 6590.5,-1153.95 6597.5,-1153.95"/>
</g>
<!-- out_proj_2_2_1 -->
<g id="node99" class="node">
<title>out_proj_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6686,-1053.91 6502,-1053.91 6502,-985.91 6686,-985.91 6686,-1053.91"/>
<text text-anchor="middle" x="6594" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6594" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6594" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6594" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_1&#45;&gt;out_proj_2_2_1 -->
<g id="edge93" class="edge">
<title>attn_2_2_1&#45;&gt;out_proj_2_2_1</title>
<path fill="none" stroke="black" d="M6594,-1090.81C6594,-1082.63 6594,-1073.32 6594,-1064.23"/>
<polygon fill="black" stroke="black" points="6597.5,-1064.13 6594,-1054.13 6590.5,-1064.13 6597.5,-1064.13"/>
</g>
<!-- out_proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge115" class="edge">
<title>out_proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6594,-985.75C6594,-977.3 6594,-968.08 6594,-959.21"/>
<polygon fill="black" stroke="black" points="6597.5,-959 6594,-949 6590.5,-959 6597.5,-959"/>
</g>
<!-- qkv_2_2_2 -->
<g id="node100" class="node">
<title>qkv_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6930,-1248.91 6746,-1248.91 6746,-1180.91 6930,-1180.91 6930,-1248.91"/>
<text text-anchor="middle" x="6838" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6838" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6838" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6838" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_2 -->
<g id="node101" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6951,-1143.91 6725,-1143.91 6725,-1090.91 6951,-1090.91 6951,-1143.91"/>
<text text-anchor="middle" x="6838" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6838" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6838" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge94" class="edge">
<title>qkv_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M6838,-1180.77C6838,-1172.19 6838,-1162.92 6838,-1154.21"/>
<polygon fill="black" stroke="black" points="6841.5,-1153.95 6838,-1143.95 6834.5,-1153.95 6841.5,-1153.95"/>
</g>
<!-- out_proj_2_2_2 -->
<g id="node102" class="node">
<title>out_proj_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6899,-1053.91 6715,-1053.91 6715,-985.91 6899,-985.91 6899,-1053.91"/>
<text text-anchor="middle" x="6807" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6807" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="6807" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6807" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_2&#45;&gt;out_proj_2_2_2 -->
<g id="edge95" class="edge">
<title>attn_2_2_2&#45;&gt;out_proj_2_2_2</title>
<path fill="none" stroke="black" d="M6829.69,-1090.81C6826.98,-1082.45 6823.88,-1072.92 6820.87,-1063.64"/>
<polygon fill="black" stroke="black" points="6824.2,-1062.56 6817.78,-1054.13 6817.54,-1064.72 6824.2,-1062.56"/>
</g>
<!-- out_proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge116" class="edge">
<title>out_proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6738.73,-985.89C6717.23,-975.5 6693.34,-963.94 6671.26,-953.27"/>
<polygon fill="black" stroke="black" points="6672.78,-950.11 6662.25,-948.91 6669.73,-956.42 6672.78,-950.11"/>
</g>
<!-- qkv_2_2_3 -->
<g id="node103" class="node">
<title>qkv_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7174,-1248.91 6990,-1248.91 6990,-1180.91 7174,-1180.91 7174,-1248.91"/>
<text text-anchor="middle" x="7082" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7082" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7082" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7082" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_2_3 -->
<g id="node104" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7195,-1143.91 6969,-1143.91 6969,-1090.91 7195,-1090.91 7195,-1143.91"/>
<text text-anchor="middle" x="7082" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7082" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7082" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge96" class="edge">
<title>qkv_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M7082,-1180.77C7082,-1172.19 7082,-1162.92 7082,-1154.21"/>
<polygon fill="black" stroke="black" points="7085.5,-1153.95 7082,-1143.95 7078.5,-1153.95 7085.5,-1153.95"/>
</g>
<!-- out_proj_2_2_3 -->
<g id="node105" class="node">
<title>out_proj_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7132,-1053.91 6948,-1053.91 6948,-985.91 7132,-985.91 7132,-1053.91"/>
<text text-anchor="middle" x="7040" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7040" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7040" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7040" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2_3&#45;&gt;out_proj_2_2_3 -->
<g id="edge97" class="edge">
<title>attn_2_2_3&#45;&gt;out_proj_2_2_3</title>
<path fill="none" stroke="black" d="M7070.74,-1090.81C7067.03,-1082.36 7062.79,-1072.72 7058.67,-1063.35"/>
<polygon fill="black" stroke="black" points="7061.84,-1061.87 7054.61,-1054.13 7055.43,-1064.69 7061.84,-1061.87"/>
</g>
<!-- out_proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge117" class="edge">
<title>out_proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6947.76,-995.53C6934.43,-992.24 6920.87,-988.95 6908,-985.91 6846.47,-971.36 6777.96,-955.99 6720.67,-943.37"/>
<polygon fill="black" stroke="black" points="6721.36,-939.94 6710.85,-941.21 6719.86,-946.78 6721.36,-939.94"/>
</g>
<!-- qkv_2_3_0 -->
<g id="node106" class="node">
<title>qkv_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="7418,-1248.91 7234,-1248.91 7234,-1180.91 7418,-1180.91 7418,-1248.91"/>
<text text-anchor="middle" x="7326" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7326" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7326" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7326" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_0 -->
<g id="node107" class="node">
<title>attn_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="7439,-1143.91 7213,-1143.91 7213,-1090.91 7439,-1090.91 7439,-1143.91"/>
<text text-anchor="middle" x="7326" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7326" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7326" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge98" class="edge">
<title>qkv_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M7326,-1180.77C7326,-1172.19 7326,-1162.92 7326,-1154.21"/>
<polygon fill="black" stroke="black" points="7329.5,-1153.95 7326,-1143.95 7322.5,-1153.95 7329.5,-1153.95"/>
</g>
<!-- out_proj_2_3_0 -->
<g id="node108" class="node">
<title>out_proj_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="7450,-1053.91 7266,-1053.91 7266,-985.91 7450,-985.91 7450,-1053.91"/>
<text text-anchor="middle" x="7358" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7358" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7358" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7358" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_0&#45;&gt;out_proj_2_3_0 -->
<g id="edge99" class="edge">
<title>attn_2_3_0&#45;&gt;out_proj_2_3_0</title>
<path fill="none" stroke="black" d="M7334.58,-1090.81C7337.38,-1082.45 7340.57,-1072.92 7343.68,-1063.64"/>
<polygon fill="black" stroke="black" points="7347.01,-1064.72 7346.87,-1054.13 7340.37,-1062.5 7347.01,-1064.72"/>
</g>
<!-- concat_dim_2_3 -->
<g id="node121" class="node">
<title>concat_dim_2_3</title>
<polygon fill="orange" stroke="black" points="7686.5,-948.91 7453.5,-948.91 7453.5,-880.91 7686.5,-880.91 7686.5,-948.91"/>
<text text-anchor="middle" x="7570" y="-933.71" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7570" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="7570" y="-903.71" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="7570" y="-888.71" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge118" class="edge">
<title>out_proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M7425.95,-985.89C7447.25,-975.54 7470.92,-964.05 7492.81,-953.41"/>
<polygon fill="black" stroke="black" points="7494.6,-956.43 7502.07,-948.91 7491.54,-950.13 7494.6,-956.43"/>
</g>
<!-- qkv_2_3_1 -->
<g id="node109" class="node">
<title>qkv_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="7662,-1248.91 7478,-1248.91 7478,-1180.91 7662,-1180.91 7662,-1248.91"/>
<text text-anchor="middle" x="7570" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7570" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7570" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_1 -->
<g id="node110" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="7683,-1143.91 7457,-1143.91 7457,-1090.91 7683,-1090.91 7683,-1143.91"/>
<text text-anchor="middle" x="7570" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7570" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge100" class="edge">
<title>qkv_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M7570,-1180.77C7570,-1172.19 7570,-1162.92 7570,-1154.21"/>
<polygon fill="black" stroke="black" points="7573.5,-1153.95 7570,-1143.95 7566.5,-1153.95 7573.5,-1153.95"/>
</g>
<!-- out_proj_2_3_1 -->
<g id="node111" class="node">
<title>out_proj_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="7662,-1053.91 7478,-1053.91 7478,-985.91 7662,-985.91 7662,-1053.91"/>
<text text-anchor="middle" x="7570" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7570" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7570" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="7570" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_1&#45;&gt;out_proj_2_3_1 -->
<g id="edge101" class="edge">
<title>attn_2_3_1&#45;&gt;out_proj_2_3_1</title>
<path fill="none" stroke="black" d="M7570,-1090.81C7570,-1082.63 7570,-1073.32 7570,-1064.23"/>
<polygon fill="black" stroke="black" points="7573.5,-1064.13 7570,-1054.13 7566.5,-1064.13 7573.5,-1064.13"/>
</g>
<!-- out_proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge119" class="edge">
<title>out_proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M7570,-985.75C7570,-977.3 7570,-968.08 7570,-959.21"/>
<polygon fill="black" stroke="black" points="7573.5,-959 7570,-949 7566.5,-959 7573.5,-959"/>
</g>
<!-- qkv_2_3_2 -->
<g id="node112" class="node">
<title>qkv_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7906,-1248.91 7722,-1248.91 7722,-1180.91 7906,-1180.91 7906,-1248.91"/>
<text text-anchor="middle" x="7814" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7814" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7814" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7814" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_2 -->
<g id="node113" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7927,-1143.91 7701,-1143.91 7701,-1090.91 7927,-1090.91 7927,-1143.91"/>
<text text-anchor="middle" x="7814" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7814" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7814" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge102" class="edge">
<title>qkv_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M7814,-1180.77C7814,-1172.19 7814,-1162.92 7814,-1154.21"/>
<polygon fill="black" stroke="black" points="7817.5,-1153.95 7814,-1143.95 7810.5,-1153.95 7817.5,-1153.95"/>
</g>
<!-- out_proj_2_3_2 -->
<g id="node114" class="node">
<title>out_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7874,-1053.91 7690,-1053.91 7690,-985.91 7874,-985.91 7874,-1053.91"/>
<text text-anchor="middle" x="7782" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7782" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="7782" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7782" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_2&#45;&gt;out_proj_2_3_2 -->
<g id="edge103" class="edge">
<title>attn_2_3_2&#45;&gt;out_proj_2_3_2</title>
<path fill="none" stroke="black" d="M7805.42,-1090.81C7802.62,-1082.45 7799.43,-1072.92 7796.32,-1063.64"/>
<polygon fill="black" stroke="black" points="7799.63,-1062.5 7793.13,-1054.13 7792.99,-1064.72 7799.63,-1062.5"/>
</g>
<!-- out_proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge120" class="edge">
<title>out_proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M7714.05,-985.89C7692.75,-975.54 7669.08,-964.05 7647.19,-953.41"/>
<polygon fill="black" stroke="black" points="7648.46,-950.13 7637.93,-948.91 7645.4,-956.43 7648.46,-950.13"/>
</g>
<!-- qkv_2_3_3 -->
<g id="node115" class="node">
<title>qkv_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8150,-1248.91 7966,-1248.91 7966,-1180.91 8150,-1180.91 8150,-1248.91"/>
<text text-anchor="middle" x="8058" y="-1233.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8058" y="-1218.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8058" y="-1203.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8058" y="-1188.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_2_3_3 -->
<g id="node116" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8171,-1143.91 7945,-1143.91 7945,-1090.91 8171,-1090.91 8171,-1143.91"/>
<text text-anchor="middle" x="8058" y="-1128.71" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8058" y="-1113.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8058" y="-1098.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge104" class="edge">
<title>qkv_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M8058,-1180.77C8058,-1172.19 8058,-1162.92 8058,-1154.21"/>
<polygon fill="black" stroke="black" points="8061.5,-1153.95 8058,-1143.95 8054.5,-1153.95 8061.5,-1153.95"/>
</g>
<!-- out_proj_2_3_3 -->
<g id="node117" class="node">
<title>out_proj_2_3_3</title>
<polygon fill="lightyellow" stroke="black" points="8118,-1053.91 7934,-1053.91 7934,-985.91 8118,-985.91 8118,-1053.91"/>
<text text-anchor="middle" x="8026" y="-1038.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8026" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="8026" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="8026" y="-993.71" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3_3&#45;&gt;out_proj_2_3_3 -->
<g id="edge105" class="edge">
<title>attn_2_3_3&#45;&gt;out_proj_2_3_3</title>
<path fill="none" stroke="black" d="M8049.42,-1090.81C8046.62,-1082.45 8043.43,-1072.92 8040.32,-1063.64"/>
<polygon fill="black" stroke="black" points="8043.63,-1062.5 8037.13,-1054.13 8036.99,-1064.72 8043.63,-1062.5"/>
</g>
<!-- out_proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge121" class="edge">
<title>out_proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M7933.71,-997.51C7916.85,-993.63 7899.4,-989.63 7883,-985.91 7821.66,-971.97 7753.51,-956.7 7696.5,-943.99"/>
<polygon fill="black" stroke="black" points="7697.24,-940.57 7686.72,-941.81 7695.72,-947.41 7697.24,-940.57"/>
</g>
<!-- concat_heads_2 -->
<g id="node122" class="node">
<title>concat_heads_2</title>
<polygon fill="gold" stroke="black" points="6659,-818.93 6455,-818.93 6455,-765.93 6659,-765.93 6659,-818.93"/>
<text text-anchor="middle" x="6557" y="-803.73" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="6557" y="-788.73" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6557" y="-773.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge122" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M5002.51,-905.51C5310.25,-883.32 6141.91,-823.36 6444.75,-801.52"/>
<polygon fill="black" stroke="black" points="6445.14,-805 6454.87,-800.79 6444.64,-798.02 6445.14,-805"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge123" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M5978.72,-893.67C6108.5,-871.18 6316.66,-835.09 6444.65,-812.91"/>
<polygon fill="black" stroke="black" points="6445.61,-816.29 6454.86,-811.13 6444.41,-809.39 6445.61,-816.29"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge124" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M6583.79,-880.67C6578.87,-864.63 6572.95,-845.38 6567.94,-829.05"/>
<polygon fill="black" stroke="black" points="6571.23,-827.84 6564.95,-819.31 6564.54,-829.89 6571.23,-827.84"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge125" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M7453.43,-911.39C7280.35,-905.78 6945.93,-887.75 6668,-829.91 6657.66,-827.75 6646.94,-824.97 6636.41,-821.9"/>
<polygon fill="black" stroke="black" points="6637.4,-818.54 6626.82,-819.01 6635.38,-825.24 6637.4,-818.54"/>
</g>
<!-- res1_2 -->
<g id="node123" class="node">
<title>res1_2</title>
<polygon fill="lightcyan" stroke="black" points="6805.5,-710.45 6612.5,-710.45 6612.5,-657.45 6805.5,-657.45 6805.5,-710.45"/>
<text text-anchor="middle" x="6709" y="-695.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6709" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6709" y="-665.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads_2&#45;&gt;res1_2 -->
<g id="edge127" class="edge">
<title>concat_heads_2&#45;&gt;res1_2</title>
<path fill="none" stroke="black" d="M6593.41,-765.93C6614.59,-751.09 6641.47,-732.26 6663.97,-716.5"/>
<polygon fill="black" stroke="black" points="6666.18,-719.22 6672.36,-710.62 6662.16,-713.49 6666.18,-719.22"/>
</g>
<!-- ln2_2 -->
<g id="node125" class="node">
<title>ln2_2</title>
<polygon fill="lightgray" stroke="black" points="6805.5,-591.45 6612.5,-591.45 6612.5,-538.45 6805.5,-538.45 6805.5,-591.45"/>
<text text-anchor="middle" x="6709" y="-576.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6709" y="-561.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="6709" y="-546.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_2&#45;&gt;ln2_2 -->
<g id="edge128" class="edge">
<title>res1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M6709,-657.28C6709,-640.97 6709,-619.63 6709,-601.68"/>
<polygon fill="black" stroke="black" points="6712.5,-601.57 6709,-591.57 6705.5,-601.57 6712.5,-601.57"/>
</g>
<!-- res2_2 -->
<g id="node136" class="node">
<title>res2_2</title>
<polygon fill="lightcyan" stroke="black" points="7989.5,-591.45 7796.5,-591.45 7796.5,-538.45 7989.5,-538.45 7989.5,-591.45"/>
<text text-anchor="middle" x="7893" y="-576.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7893" y="-561.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7893" y="-546.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_2&#45;&gt;res2_2 -->
<g id="edge145" class="edge">
<title>res1_2&#45;&gt;res2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6805.64,-673.4C7024.78,-651.75 7558.07,-599.05 7786.4,-576.49"/>
<polygon fill="black" stroke="black" points="7786.77,-579.97 7796.38,-575.5 7786.08,-573 7786.77,-579.97"/>
</g>
<!-- res2_1 -->
<g id="node124" class="node">
<title>res2_1</title>
<polygon fill="lightgrey" stroke="black" points="6741,-810.43 6677,-810.43 6677,-774.43 6741,-774.43 6741,-810.43"/>
<text text-anchor="middle" x="6709" y="-788.73" font-family="Times,serif" font-size="14.00">res2_1</text>
</g>
<!-- res2_1&#45;&gt;res1_2 -->
<g id="edge126" class="edge">
<title>res2_1&#45;&gt;res1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6709,-774.32C6709,-759.97 6709,-738.99 6709,-720.97"/>
<polygon fill="black" stroke="black" points="6712.5,-720.77 6709,-710.77 6705.5,-720.77 6712.5,-720.77"/>
</g>
<!-- gate_2 -->
<g id="node126" class="node">
<title>gate_2</title>
<polygon fill="lightpink" stroke="black" points="8042.5,-948.91 7849.5,-948.91 7849.5,-880.91 8042.5,-880.91 8042.5,-948.91"/>
<text text-anchor="middle" x="7946" y="-933.71" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7946" y="-918.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7946" y="-903.71" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7946" y="-888.71" font-family="Times,serif" font-size="14.00">Expert Selection</text>
</g>
<!-- expert_2_0 -->
<g id="node127" class="node">
<title>expert_2_0</title>
<polygon fill="lightblue" stroke="black" points="7031,-826.43 6759,-826.43 6759,-758.43 7031,-758.43 7031,-826.43"/>
<text text-anchor="middle" x="6895" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6895" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="6895" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="6895" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge129" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7849.44,-899.41C7803.12,-892.9 7746.78,-885.64 7696,-880.91 7404.83,-853.76 7328.04,-880.39 7040,-829.91 7037.28,-829.43 7034.53,-828.93 7031.77,-828.41"/>
<polygon fill="black" stroke="black" points="7032.18,-824.92 7021.69,-826.43 7030.83,-831.79 7032.18,-824.92"/>
<text text-anchor="middle" x="7367.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_1 -->
<g id="node128" class="node">
<title>expert_2_1</title>
<polygon fill="lightcoral" stroke="black" points="7321,-826.43 7049,-826.43 7049,-758.43 7321,-758.43 7321,-826.43"/>
<text text-anchor="middle" x="7185" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7185" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="7185" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7185" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge130" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7849.3,-901.01C7682.3,-878.69 7355.17,-834.77 7330,-829.91 7327.77,-829.48 7325.53,-829.03 7323.27,-828.58"/>
<polygon fill="black" stroke="black" points="7323.81,-825.11 7313.31,-826.51 7322.39,-831.97 7323.81,-825.11"/>
<text text-anchor="middle" x="7606.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_2 -->
<g id="node129" class="node">
<title>expert_2_2</title>
<polygon fill="lightgreen" stroke="black" points="7611,-826.43 7339,-826.43 7339,-758.43 7611,-758.43 7611,-826.43"/>
<text text-anchor="middle" x="7475" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7475" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="7475" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7475" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge131" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7849.26,-889.16C7781.5,-871.83 7689.92,-848.4 7614.3,-829.06"/>
<polygon fill="black" stroke="black" points="7614.78,-825.57 7604.22,-826.48 7613.04,-832.35 7614.78,-825.57"/>
<text text-anchor="middle" x="7783.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_3 -->
<g id="node130" class="node">
<title>expert_2_3</title>
<polygon fill="lightyellow" stroke="black" points="7901,-826.43 7629,-826.43 7629,-758.43 7901,-758.43 7901,-826.43"/>
<text text-anchor="middle" x="7765" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7765" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="7765" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="7765" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge132" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7896.06,-880.67C7873.51,-865.66 7846.72,-847.82 7823.26,-832.21"/>
<polygon fill="black" stroke="black" points="7825.04,-829.19 7814.78,-826.56 7821.16,-835.02 7825.04,-829.19"/>
<text text-anchor="middle" x="7911.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_4 -->
<g id="node131" class="node">
<title>expert_2_4</title>
<polygon fill="lightpink" stroke="black" points="8191,-826.43 7919,-826.43 7919,-758.43 8191,-758.43 8191,-826.43"/>
<text text-anchor="middle" x="8055" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8055" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="8055" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8055" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_4 -->
<g id="edge133" class="edge">
<title>gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7976.07,-880.67C7989.06,-866.31 8004.38,-849.38 8018.05,-834.27"/>
<polygon fill="black" stroke="black" points="8020.91,-836.32 8025.02,-826.56 8015.72,-831.63 8020.91,-836.32"/>
<text text-anchor="middle" x="8048.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_5 -->
<g id="node132" class="node">
<title>expert_2_5</title>
<polygon fill="lightcyan" stroke="black" points="8481,-826.43 8209,-826.43 8209,-758.43 8481,-758.43 8481,-826.43"/>
<text text-anchor="middle" x="8345" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8345" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="8345" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8345" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_5 -->
<g id="edge134" class="edge">
<title>gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8042.59,-884.74C8097.75,-868.09 8167.37,-847.06 8225.9,-829.39"/>
<polygon fill="black" stroke="black" points="8227.01,-832.71 8235.57,-826.47 8224.99,-826.01 8227.01,-832.71"/>
<text text-anchor="middle" x="8202.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_6 -->
<g id="node133" class="node">
<title>expert_2_6</title>
<polygon fill="lightgrey" stroke="black" points="8771,-826.43 8499,-826.43 8499,-758.43 8771,-758.43 8771,-826.43"/>
<text text-anchor="middle" x="8635" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8635" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="8635" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8635" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_6 -->
<g id="edge135" class="edge">
<title>gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8042.78,-901.74C8151.94,-887.37 8334.52,-861.4 8490,-829.91 8492.09,-829.48 8494.19,-829.05 8496.3,-828.61"/>
<polygon fill="black" stroke="black" points="8497.23,-831.99 8506.27,-826.48 8495.76,-825.15 8497.23,-831.99"/>
<text text-anchor="middle" x="8431.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2_7 -->
<g id="node134" class="node">
<title>expert_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="9061,-826.43 8789,-826.43 8789,-758.43 9061,-758.43 9061,-826.43"/>
<text text-anchor="middle" x="8925" y="-811.23" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8925" y="-796.23" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="8925" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8925" y="-766.23" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_2&#45;&gt;expert_2_7 -->
<g id="edge136" class="edge">
<title>gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8042.68,-909.06C8198.78,-900.15 8515.58,-877.53 8780,-829.91 8782.66,-829.43 8785.35,-828.93 8788.05,-828.41"/>
<polygon fill="black" stroke="black" points="8788.78,-831.83 8797.9,-826.45 8787.41,-824.97 8788.78,-831.83"/>
<text text-anchor="middle" x="8712.5" y="-851.71" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_2 -->
<g id="node135" class="node">
<title>expert_agg_2</title>
<polygon fill="gold" stroke="black" points="7989.5,-717.95 7796.5,-717.95 7796.5,-649.95 7989.5,-649.95 7989.5,-717.95"/>
<text text-anchor="middle" x="7893" y="-702.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7893" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="7893" y="-672.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="7893" y="-657.75" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge137" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M7021.27,-758.36C7027.59,-757.12 7033.85,-755.97 7040,-754.95 7306.08,-710.88 7623.68,-694.11 7785.96,-688.09"/>
<polygon fill="black" stroke="black" points="7786.56,-691.57 7796.42,-687.71 7786.3,-684.57 7786.56,-691.57"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge138" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M7312.9,-758.35C7318.67,-757.14 7324.39,-756 7330,-754.95 7487.65,-725.44 7672.53,-705.15 7786.22,-694.29"/>
<polygon fill="black" stroke="black" points="7786.69,-697.76 7796.31,-693.33 7786.03,-690.79 7786.69,-697.76"/>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge139" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M7604.68,-758.4C7663.02,-743.53 7731.05,-726.21 7786.37,-712.11"/>
<polygon fill="black" stroke="black" points="7787.37,-715.47 7796.19,-709.61 7785.64,-708.69 7787.37,-715.47"/>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge140" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M7804.8,-758.32C7817.68,-747.61 7832.1,-735.61 7845.48,-724.48"/>
<polygon fill="black" stroke="black" points="7847.78,-727.12 7853.23,-718.04 7843.3,-721.74 7847.78,-727.12"/>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge141" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M8004.63,-758.32C7987.87,-747.31 7969.05,-734.94 7951.72,-723.55"/>
<polygon fill="black" stroke="black" points="7953.62,-720.61 7943.34,-718.04 7949.77,-726.46 7953.62,-720.61"/>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge142" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M8214.22,-758.39C8209.42,-757.22 8204.67,-756.07 8200,-754.95 8133.54,-739.02 8058.78,-721.95 7999.67,-708.66"/>
<polygon fill="black" stroke="black" points="8000.1,-705.17 7989.57,-706.39 7998.56,-712 8000.1,-705.17"/>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge143" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M8507.5,-758.38C8501.6,-757.16 8495.74,-756.01 8490,-754.95 8319.95,-723.73 8119.97,-703.6 8000.02,-693.29"/>
<polygon fill="black" stroke="black" points="8000,-689.77 7989.73,-692.41 7999.4,-696.75 8000,-689.77"/>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge144" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M8799.13,-758.42C8792.68,-757.15 8786.28,-755.98 8780,-754.95 8500.84,-709.16 8167.16,-693.06 7999.83,-687.61"/>
<polygon fill="black" stroke="black" points="7999.89,-684.11 7989.78,-687.29 7999.66,-691.1 7999.89,-684.11"/>
</g>
<!-- expert_agg_2&#45;&gt;res2_2 -->
<g id="edge146" class="edge">
<title>expert_agg_2&#45;&gt;res2_2</title>
<path fill="none" stroke="black" d="M7893,-649.74C7893,-634.81 7893,-617.16 7893,-601.91"/>
<polygon fill="black" stroke="black" points="7896.5,-601.81 7893,-591.81 7889.5,-601.81 7896.5,-601.81"/>
</g>
<!-- res1_3 -->
<g id="node191" class="node">
<title>res1_3</title>
<polygon fill="lightcyan" stroke="black" points="10913.5,-486.45 10720.5,-486.45 10720.5,-433.45 10913.5,-433.45 10913.5,-486.45"/>
<text text-anchor="middle" x="10817" y="-471.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10817" y="-456.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="10817" y="-441.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_2&#45;&gt;res1_3 -->
<g id="edge199" class="edge">
<title>res2_2&#45;&gt;res1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7989.87,-560.54C8431.06,-545 10248.65,-480.97 10710.09,-464.72"/>
<polygon fill="black" stroke="black" points="10710.54,-468.21 10720.41,-464.36 10710.29,-461.21 10710.54,-468.21"/>
</g>
<!-- ln1_3 -->
<g id="node137" class="node">
<title>ln1_3</title>
<polygon fill="lightgray" stroke="black" points="8361.5,-1241.41 8168.5,-1241.41 8168.5,-1188.41 8361.5,-1188.41 8361.5,-1241.41"/>
<text text-anchor="middle" x="8265" y="-1226.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8265" y="-1211.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="8265" y="-1196.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_3_0_0 -->
<g id="node138" class="node">
<title>qkv_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9171,-1053.91 8987,-1053.91 8987,-985.91 9171,-985.91 9171,-1053.91"/>
<text text-anchor="middle" x="9079" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9079" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9079" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9079" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_0 -->
<g id="node139" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9192,-941.41 8966,-941.41 8966,-888.41 9192,-888.41 9192,-941.41"/>
<text text-anchor="middle" x="9079" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9079" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9079" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge147" class="edge">
<title>qkv_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M9079,-985.75C9079,-974.88 9079,-962.75 9079,-951.69"/>
<polygon fill="black" stroke="black" points="9082.5,-951.49 9079,-941.49 9075.5,-951.49 9082.5,-951.49"/>
</g>
<!-- out_proj_3_0_0 -->
<g id="node140" class="node">
<title>out_proj_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="9263,-826.43 9079,-826.43 9079,-758.43 9263,-758.43 9263,-826.43"/>
<text text-anchor="middle" x="9171" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9171" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9171" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="9171" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_0&#45;&gt;out_proj_3_0_0 -->
<g id="edge148" class="edge">
<title>attn_3_0_0&#45;&gt;out_proj_3_0_0</title>
<path fill="none" stroke="black" d="M9098.51,-888.36C9110.4,-872.78 9125.88,-852.52 9139.48,-834.71"/>
<polygon fill="black" stroke="black" points="9142.28,-836.8 9145.57,-826.73 9136.72,-832.55 9142.28,-836.8"/>
</g>
<!-- concat_dim_3_0 -->
<g id="node186" class="node">
<title>concat_dim_3_0</title>
<polygon fill="orange" stroke="black" points="9691.5,-717.95 9458.5,-717.95 9458.5,-649.95 9691.5,-649.95 9691.5,-717.95"/>
<text text-anchor="middle" x="9575" y="-702.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="9575" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="9575" y="-672.75" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="9575" y="-657.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge179" class="edge">
<title>out_proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M9260.85,-758.36C9264.61,-757.18 9268.33,-756.03 9272,-754.95 9329.28,-738.06 9393.63,-722.69 9448.25,-710.69"/>
<polygon fill="black" stroke="black" points="9449.31,-714.04 9458.33,-708.49 9447.81,-707.21 9449.31,-714.04"/>
</g>
<!-- qkv_3_0_1 -->
<g id="node141" class="node">
<title>qkv_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9415,-1053.91 9231,-1053.91 9231,-985.91 9415,-985.91 9415,-1053.91"/>
<text text-anchor="middle" x="9323" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9323" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9323" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9323" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_1 -->
<g id="node142" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9436,-941.41 9210,-941.41 9210,-888.41 9436,-888.41 9436,-941.41"/>
<text text-anchor="middle" x="9323" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9323" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9323" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge149" class="edge">
<title>qkv_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M9323,-985.75C9323,-974.88 9323,-962.75 9323,-951.69"/>
<polygon fill="black" stroke="black" points="9326.5,-951.49 9323,-941.49 9319.5,-951.49 9326.5,-951.49"/>
</g>
<!-- out_proj_3_0_1 -->
<g id="node143" class="node">
<title>out_proj_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9465,-826.43 9281,-826.43 9281,-758.43 9465,-758.43 9465,-826.43"/>
<text text-anchor="middle" x="9373" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9373" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9373" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9373" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_1&#45;&gt;out_proj_3_0_1 -->
<g id="edge150" class="edge">
<title>attn_3_0_1&#45;&gt;out_proj_3_0_1</title>
<path fill="none" stroke="black" d="M9333.6,-888.36C9339.89,-873.2 9348.02,-853.61 9355.27,-836.16"/>
<polygon fill="black" stroke="black" points="9358.58,-837.31 9359.18,-826.73 9352.11,-834.62 9358.58,-837.31"/>
</g>
<!-- out_proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge180" class="edge">
<title>out_proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M9435.81,-758.32C9457.18,-747.06 9481.24,-734.38 9503.26,-722.77"/>
<polygon fill="black" stroke="black" points="9505.02,-725.8 9512.23,-718.04 9501.75,-719.61 9505.02,-725.8"/>
</g>
<!-- qkv_3_0_2 -->
<g id="node144" class="node">
<title>qkv_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9659,-1053.91 9475,-1053.91 9475,-985.91 9659,-985.91 9659,-1053.91"/>
<text text-anchor="middle" x="9567" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9567" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9567" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9567" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_2 -->
<g id="node145" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9680,-941.41 9454,-941.41 9454,-888.41 9680,-888.41 9680,-941.41"/>
<text text-anchor="middle" x="9567" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9567" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9567" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge151" class="edge">
<title>qkv_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M9567,-985.75C9567,-974.88 9567,-962.75 9567,-951.69"/>
<polygon fill="black" stroke="black" points="9570.5,-951.49 9567,-941.49 9563.5,-951.49 9570.5,-951.49"/>
</g>
<!-- out_proj_3_0_2 -->
<g id="node146" class="node">
<title>out_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="9667,-826.43 9483,-826.43 9483,-758.43 9667,-758.43 9667,-826.43"/>
<text text-anchor="middle" x="9575" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9575" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9575" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9575" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_2&#45;&gt;out_proj_3_0_2 -->
<g id="edge152" class="edge">
<title>attn_3_0_2&#45;&gt;out_proj_3_0_2</title>
<path fill="none" stroke="black" d="M9568.7,-888.36C9569.68,-873.48 9570.96,-854.33 9572.1,-837.13"/>
<polygon fill="black" stroke="black" points="9575.62,-836.94 9572.79,-826.73 9568.63,-836.48 9575.62,-836.94"/>
</g>
<!-- out_proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge181" class="edge">
<title>out_proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M9575,-758.32C9575,-748.81 9575,-738.29 9575,-728.26"/>
<polygon fill="black" stroke="black" points="9578.5,-728.04 9575,-718.04 9571.5,-728.04 9578.5,-728.04"/>
</g>
<!-- qkv_3_0_3 -->
<g id="node147" class="node">
<title>qkv_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9903,-1053.91 9719,-1053.91 9719,-985.91 9903,-985.91 9903,-1053.91"/>
<text text-anchor="middle" x="9811" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9811" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9811" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9811" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_0_3 -->
<g id="node148" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9924,-941.41 9698,-941.41 9698,-888.41 9924,-888.41 9924,-941.41"/>
<text text-anchor="middle" x="9811" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9811" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9811" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge153" class="edge">
<title>qkv_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M9811,-985.75C9811,-974.88 9811,-962.75 9811,-951.69"/>
<polygon fill="black" stroke="black" points="9814.5,-951.49 9811,-941.49 9807.5,-951.49 9814.5,-951.49"/>
</g>
<!-- out_proj_3_0_3 -->
<g id="node149" class="node">
<title>out_proj_3_0_3</title>
<polygon fill="lightyellow" stroke="black" points="9879,-826.43 9695,-826.43 9695,-758.43 9879,-758.43 9879,-826.43"/>
<text text-anchor="middle" x="9787" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9787" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="9787" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9787" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0_3&#45;&gt;out_proj_3_0_3 -->
<g id="edge154" class="edge">
<title>attn_3_0_3&#45;&gt;out_proj_3_0_3</title>
<path fill="none" stroke="black" d="M9805.91,-888.36C9802.92,-873.34 9799.06,-853.97 9795.61,-836.65"/>
<polygon fill="black" stroke="black" points="9799.02,-835.85 9793.63,-826.73 9792.15,-837.22 9799.02,-835.85"/>
</g>
<!-- out_proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge182" class="edge">
<title>out_proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M9721.08,-758.32C9698.55,-747.01 9673.18,-734.26 9649.99,-722.61"/>
<polygon fill="black" stroke="black" points="9651.38,-719.4 9640.88,-718.04 9648.24,-725.66 9651.38,-719.4"/>
</g>
<!-- qkv_3_1_0 -->
<g id="node150" class="node">
<title>qkv_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="10147,-1053.91 9963,-1053.91 9963,-985.91 10147,-985.91 10147,-1053.91"/>
<text text-anchor="middle" x="10055" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10055" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10055" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10055" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_0 -->
<g id="node151" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="10168,-941.41 9942,-941.41 9942,-888.41 10168,-888.41 10168,-941.41"/>
<text text-anchor="middle" x="10055" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10055" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10055" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge155" class="edge">
<title>qkv_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M10055,-985.75C10055,-974.88 10055,-962.75 10055,-951.69"/>
<polygon fill="black" stroke="black" points="10058.5,-951.49 10055,-941.49 10051.5,-951.49 10058.5,-951.49"/>
</g>
<!-- out_proj_3_1_0 -->
<g id="node152" class="node">
<title>out_proj_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="10179,-826.43 9995,-826.43 9995,-758.43 10179,-758.43 10179,-826.43"/>
<text text-anchor="middle" x="10087" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10087" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10087" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10087" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_0&#45;&gt;out_proj_3_1_0 -->
<g id="edge156" class="edge">
<title>attn_3_1_0&#45;&gt;out_proj_3_1_0</title>
<path fill="none" stroke="black" d="M10061.79,-888.36C10065.77,-873.34 10070.92,-853.97 10075.52,-836.65"/>
<polygon fill="black" stroke="black" points="10078.97,-837.29 10078.16,-826.73 10072.21,-835.5 10078.97,-837.29"/>
</g>
<!-- concat_dim_3_1 -->
<g id="node187" class="node">
<title>concat_dim_3_1</title>
<polygon fill="orange" stroke="black" points="10659.5,-717.95 10426.5,-717.95 10426.5,-649.95 10659.5,-649.95 10659.5,-717.95"/>
<text text-anchor="middle" x="10543" y="-702.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="10543" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="10543" y="-672.75" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10543" y="-657.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge183" class="edge">
<title>out_proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M10179.21,-767.48C10196.08,-763.22 10213.55,-758.89 10230,-754.95 10291.3,-740.28 10359.59,-724.9 10416.7,-712.3"/>
<polygon fill="black" stroke="black" points="10417.49,-715.71 10426.5,-710.14 10415.98,-708.88 10417.49,-715.71"/>
</g>
<!-- qkv_3_1_1 -->
<g id="node153" class="node">
<title>qkv_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10391,-1053.91 10207,-1053.91 10207,-985.91 10391,-985.91 10391,-1053.91"/>
<text text-anchor="middle" x="10299" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10299" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10299" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10299" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_1 -->
<g id="node154" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10412,-941.41 10186,-941.41 10186,-888.41 10412,-888.41 10412,-941.41"/>
<text text-anchor="middle" x="10299" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10299" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10299" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge157" class="edge">
<title>qkv_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M10299,-985.75C10299,-974.88 10299,-962.75 10299,-951.69"/>
<polygon fill="black" stroke="black" points="10302.5,-951.49 10299,-941.49 10295.5,-951.49 10302.5,-951.49"/>
</g>
<!-- out_proj_3_1_1 -->
<g id="node155" class="node">
<title>out_proj_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="10423,-826.43 10239,-826.43 10239,-758.43 10423,-758.43 10423,-826.43"/>
<text text-anchor="middle" x="10331" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10331" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10331" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10331" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_1&#45;&gt;out_proj_3_1_1 -->
<g id="edge158" class="edge">
<title>attn_3_1_1&#45;&gt;out_proj_3_1_1</title>
<path fill="none" stroke="black" d="M10305.79,-888.36C10309.77,-873.34 10314.92,-853.97 10319.52,-836.65"/>
<polygon fill="black" stroke="black" points="10322.97,-837.29 10322.16,-826.73 10316.21,-835.5 10322.97,-837.29"/>
</g>
<!-- out_proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge184" class="edge">
<title>out_proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M10396.92,-758.32C10419.45,-747.01 10444.82,-734.26 10468.01,-722.61"/>
<polygon fill="black" stroke="black" points="10469.76,-725.66 10477.12,-718.04 10466.62,-719.4 10469.76,-725.66"/>
</g>
<!-- qkv_3_1_2 -->
<g id="node156" class="node">
<title>qkv_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10635,-1053.91 10451,-1053.91 10451,-985.91 10635,-985.91 10635,-1053.91"/>
<text text-anchor="middle" x="10543" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10543" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10543" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10543" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_2 -->
<g id="node157" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10656,-941.41 10430,-941.41 10430,-888.41 10656,-888.41 10656,-941.41"/>
<text text-anchor="middle" x="10543" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10543" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10543" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge159" class="edge">
<title>qkv_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M10543,-985.75C10543,-974.88 10543,-962.75 10543,-951.69"/>
<polygon fill="black" stroke="black" points="10546.5,-951.49 10543,-941.49 10539.5,-951.49 10546.5,-951.49"/>
</g>
<!-- out_proj_3_1_2 -->
<g id="node158" class="node">
<title>out_proj_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="10635,-826.43 10451,-826.43 10451,-758.43 10635,-758.43 10635,-826.43"/>
<text text-anchor="middle" x="10543" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10543" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10543" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10543" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_2&#45;&gt;out_proj_3_1_2 -->
<g id="edge160" class="edge">
<title>attn_3_1_2&#45;&gt;out_proj_3_1_2</title>
<path fill="none" stroke="black" d="M10543,-888.36C10543,-873.48 10543,-854.33 10543,-837.13"/>
<polygon fill="black" stroke="black" points="10546.5,-836.73 10543,-826.73 10539.5,-836.73 10546.5,-836.73"/>
</g>
<!-- out_proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge185" class="edge">
<title>out_proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M10543,-758.32C10543,-748.81 10543,-738.29 10543,-728.26"/>
<polygon fill="black" stroke="black" points="10546.5,-728.04 10543,-718.04 10539.5,-728.04 10546.5,-728.04"/>
</g>
<!-- qkv_3_1_3 -->
<g id="node159" class="node">
<title>qkv_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10879,-1053.91 10695,-1053.91 10695,-985.91 10879,-985.91 10879,-1053.91"/>
<text text-anchor="middle" x="10787" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10787" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10787" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10787" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_1_3 -->
<g id="node160" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10900,-941.41 10674,-941.41 10674,-888.41 10900,-888.41 10900,-941.41"/>
<text text-anchor="middle" x="10787" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10787" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10787" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge161" class="edge">
<title>qkv_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M10787,-985.75C10787,-974.88 10787,-962.75 10787,-951.69"/>
<polygon fill="black" stroke="black" points="10790.5,-951.49 10787,-941.49 10783.5,-951.49 10790.5,-951.49"/>
</g>
<!-- out_proj_3_1_3 -->
<g id="node161" class="node">
<title>out_proj_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="10848,-826.43 10664,-826.43 10664,-758.43 10848,-758.43 10848,-826.43"/>
<text text-anchor="middle" x="10756" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10756" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="10756" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10756" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1_3&#45;&gt;out_proj_3_1_3 -->
<g id="edge162" class="edge">
<title>attn_3_1_3&#45;&gt;out_proj_3_1_3</title>
<path fill="none" stroke="black" d="M10780.43,-888.36C10776.56,-873.34 10771.58,-853.97 10767.12,-836.65"/>
<polygon fill="black" stroke="black" points="10770.45,-835.54 10764.57,-826.73 10763.67,-837.29 10770.45,-835.54"/>
</g>
<!-- out_proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge186" class="edge">
<title>out_proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M10689.77,-758.32C10667.13,-747.01 10641.64,-734.26 10618.34,-722.61"/>
<polygon fill="black" stroke="black" points="10619.7,-719.38 10609.19,-718.04 10616.57,-725.64 10619.7,-719.38"/>
</g>
<!-- qkv_3_2_0 -->
<g id="node162" class="node">
<title>qkv_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="11123,-1053.91 10939,-1053.91 10939,-985.91 11123,-985.91 11123,-1053.91"/>
<text text-anchor="middle" x="11031" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11031" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11031" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11031" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_0 -->
<g id="node163" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="11144,-941.41 10918,-941.41 10918,-888.41 11144,-888.41 11144,-941.41"/>
<text text-anchor="middle" x="11031" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11031" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11031" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge163" class="edge">
<title>qkv_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M11031,-985.75C11031,-974.88 11031,-962.75 11031,-951.69"/>
<polygon fill="black" stroke="black" points="11034.5,-951.49 11031,-941.49 11027.5,-951.49 11034.5,-951.49"/>
</g>
<!-- out_proj_3_2_0 -->
<g id="node164" class="node">
<title>out_proj_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="11154,-826.43 10970,-826.43 10970,-758.43 11154,-758.43 11154,-826.43"/>
<text text-anchor="middle" x="11062" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11062" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11062" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="11062" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_0&#45;&gt;out_proj_3_2_0 -->
<g id="edge164" class="edge">
<title>attn_3_2_0&#45;&gt;out_proj_3_2_0</title>
<path fill="none" stroke="black" d="M11037.57,-888.36C11041.44,-873.34 11046.42,-853.97 11050.88,-836.65"/>
<polygon fill="black" stroke="black" points="11054.33,-837.29 11053.43,-826.73 11047.55,-835.54 11054.33,-837.29"/>
</g>
<!-- concat_dim_3_2 -->
<g id="node188" class="node">
<title>concat_dim_3_2</title>
<polygon fill="orange" stroke="black" points="11391.5,-717.95 11158.5,-717.95 11158.5,-649.95 11391.5,-649.95 11391.5,-717.95"/>
<text text-anchor="middle" x="11275" y="-702.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="11275" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="11275" y="-672.75" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="11275" y="-657.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge187" class="edge">
<title>out_proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M11128.23,-758.32C11150.87,-747.01 11176.36,-734.26 11199.66,-722.61"/>
<polygon fill="black" stroke="black" points="11201.43,-725.64 11208.81,-718.04 11198.3,-719.38 11201.43,-725.64"/>
</g>
<!-- qkv_3_2_1 -->
<g id="node165" class="node">
<title>qkv_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11367,-1053.91 11183,-1053.91 11183,-985.91 11367,-985.91 11367,-1053.91"/>
<text text-anchor="middle" x="11275" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11275" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11275" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11275" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_1 -->
<g id="node166" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11388,-941.41 11162,-941.41 11162,-888.41 11388,-888.41 11388,-941.41"/>
<text text-anchor="middle" x="11275" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11275" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11275" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge165" class="edge">
<title>qkv_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M11275,-985.75C11275,-974.88 11275,-962.75 11275,-951.69"/>
<polygon fill="black" stroke="black" points="11278.5,-951.49 11275,-941.49 11271.5,-951.49 11278.5,-951.49"/>
</g>
<!-- out_proj_3_2_1 -->
<g id="node167" class="node">
<title>out_proj_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11367,-826.43 11183,-826.43 11183,-758.43 11367,-758.43 11367,-826.43"/>
<text text-anchor="middle" x="11275" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11275" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11275" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="11275" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_1&#45;&gt;out_proj_3_2_1 -->
<g id="edge166" class="edge">
<title>attn_3_2_1&#45;&gt;out_proj_3_2_1</title>
<path fill="none" stroke="black" d="M11275,-888.36C11275,-873.48 11275,-854.33 11275,-837.13"/>
<polygon fill="black" stroke="black" points="11278.5,-836.73 11275,-826.73 11271.5,-836.73 11278.5,-836.73"/>
</g>
<!-- out_proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge188" class="edge">
<title>out_proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M11275,-758.32C11275,-748.81 11275,-738.29 11275,-728.26"/>
<polygon fill="black" stroke="black" points="11278.5,-728.04 11275,-718.04 11271.5,-728.04 11278.5,-728.04"/>
</g>
<!-- qkv_3_2_2 -->
<g id="node168" class="node">
<title>qkv_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11611,-1053.91 11427,-1053.91 11427,-985.91 11611,-985.91 11611,-1053.91"/>
<text text-anchor="middle" x="11519" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11519" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11519" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11519" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_2 -->
<g id="node169" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11632,-941.41 11406,-941.41 11406,-888.41 11632,-888.41 11632,-941.41"/>
<text text-anchor="middle" x="11519" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11519" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11519" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge167" class="edge">
<title>qkv_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M11519,-985.75C11519,-974.88 11519,-962.75 11519,-951.69"/>
<polygon fill="black" stroke="black" points="11522.5,-951.49 11519,-941.49 11515.5,-951.49 11522.5,-951.49"/>
</g>
<!-- out_proj_3_2_2 -->
<g id="node170" class="node">
<title>out_proj_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11580,-826.43 11396,-826.43 11396,-758.43 11580,-758.43 11580,-826.43"/>
<text text-anchor="middle" x="11488" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11488" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11488" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11488" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_2&#45;&gt;out_proj_3_2_2 -->
<g id="edge168" class="edge">
<title>attn_3_2_2&#45;&gt;out_proj_3_2_2</title>
<path fill="none" stroke="black" d="M11512.43,-888.36C11508.56,-873.34 11503.58,-853.97 11499.12,-836.65"/>
<polygon fill="black" stroke="black" points="11502.45,-835.54 11496.57,-826.73 11495.67,-837.29 11502.45,-835.54"/>
</g>
<!-- out_proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge189" class="edge">
<title>out_proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M11421.77,-758.32C11399.13,-747.01 11373.64,-734.26 11350.34,-722.61"/>
<polygon fill="black" stroke="black" points="11351.7,-719.38 11341.19,-718.04 11348.57,-725.64 11351.7,-719.38"/>
</g>
<!-- qkv_3_2_3 -->
<g id="node171" class="node">
<title>qkv_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11855,-1053.91 11671,-1053.91 11671,-985.91 11855,-985.91 11855,-1053.91"/>
<text text-anchor="middle" x="11763" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11763" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11763" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="11763" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_2_3 -->
<g id="node172" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11876,-941.41 11650,-941.41 11650,-888.41 11876,-888.41 11876,-941.41"/>
<text text-anchor="middle" x="11763" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11763" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11763" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge169" class="edge">
<title>qkv_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M11763,-985.75C11763,-974.88 11763,-962.75 11763,-951.69"/>
<polygon fill="black" stroke="black" points="11766.5,-951.49 11763,-941.49 11759.5,-951.49 11766.5,-951.49"/>
</g>
<!-- out_proj_3_2_3 -->
<g id="node173" class="node">
<title>out_proj_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11803,-826.43 11619,-826.43 11619,-758.43 11803,-758.43 11803,-826.43"/>
<text text-anchor="middle" x="11711" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11711" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="11711" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="11711" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2_3&#45;&gt;out_proj_3_2_3 -->
<g id="edge170" class="edge">
<title>attn_3_2_3&#45;&gt;out_proj_3_2_3</title>
<path fill="none" stroke="black" d="M11751.97,-888.36C11745.43,-873.2 11736.97,-853.61 11729.44,-836.16"/>
<polygon fill="black" stroke="black" points="11732.55,-834.52 11725.37,-826.73 11726.12,-837.3 11732.55,-834.52"/>
</g>
<!-- out_proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge190" class="edge">
<title>out_proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M11618.94,-763.15C11608.86,-760.28 11598.73,-757.49 11589,-754.95 11527.69,-738.98 11459.06,-723.41 11401.64,-711.04"/>
<polygon fill="black" stroke="black" points="11402.3,-707.6 11391.79,-708.92 11400.83,-714.44 11402.3,-707.6"/>
</g>
<!-- qkv_3_3_0 -->
<g id="node174" class="node">
<title>qkv_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="12099,-1053.91 11915,-1053.91 11915,-985.91 12099,-985.91 12099,-1053.91"/>
<text text-anchor="middle" x="12007" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12007" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12007" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12007" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_0 -->
<g id="node175" class="node">
<title>attn_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="12120,-941.41 11894,-941.41 11894,-888.41 12120,-888.41 12120,-941.41"/>
<text text-anchor="middle" x="12007" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12007" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12007" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge171" class="edge">
<title>qkv_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M12007,-985.75C12007,-974.88 12007,-962.75 12007,-951.69"/>
<polygon fill="black" stroke="black" points="12010.5,-951.49 12007,-941.49 12003.5,-951.49 12010.5,-951.49"/>
</g>
<!-- out_proj_3_3_0 -->
<g id="node176" class="node">
<title>out_proj_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="12125,-826.43 11941,-826.43 11941,-758.43 12125,-758.43 12125,-826.43"/>
<text text-anchor="middle" x="12033" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12033" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12033" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12033" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_0&#45;&gt;out_proj_3_3_0 -->
<g id="edge172" class="edge">
<title>attn_3_3_0&#45;&gt;out_proj_3_3_0</title>
<path fill="none" stroke="black" d="M12012.51,-888.36C12015.75,-873.34 12019.93,-853.97 12023.67,-836.65"/>
<polygon fill="black" stroke="black" points="12027.13,-837.24 12025.81,-826.73 12020.28,-835.77 12027.13,-837.24"/>
</g>
<!-- concat_dim_3_3 -->
<g id="node189" class="node">
<title>concat_dim_3_3</title>
<polygon fill="orange" stroke="black" points="12255.5,-717.95 12022.5,-717.95 12022.5,-649.95 12255.5,-649.95 12255.5,-717.95"/>
<text text-anchor="middle" x="12139" y="-702.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="12139" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="12139" y="-672.75" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="12139" y="-657.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge191" class="edge">
<title>out_proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M12065.96,-758.32C12076.33,-747.91 12087.9,-736.29 12098.72,-725.42"/>
<polygon fill="black" stroke="black" points="12101.49,-727.6 12106.06,-718.04 12096.53,-722.66 12101.49,-727.6"/>
</g>
<!-- qkv_3_3_1 -->
<g id="node177" class="node">
<title>qkv_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="12343,-1053.91 12159,-1053.91 12159,-985.91 12343,-985.91 12343,-1053.91"/>
<text text-anchor="middle" x="12251" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12251" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12251" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="12251" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_1 -->
<g id="node178" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="12364,-941.41 12138,-941.41 12138,-888.41 12364,-888.41 12364,-941.41"/>
<text text-anchor="middle" x="12251" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12251" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12251" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge173" class="edge">
<title>qkv_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M12251,-985.75C12251,-974.88 12251,-962.75 12251,-951.69"/>
<polygon fill="black" stroke="black" points="12254.5,-951.49 12251,-941.49 12247.5,-951.49 12254.5,-951.49"/>
</g>
<!-- out_proj_3_3_1 -->
<g id="node179" class="node">
<title>out_proj_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="12330,-826.43 12146,-826.43 12146,-758.43 12330,-758.43 12330,-826.43"/>
<text text-anchor="middle" x="12238" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12238" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12238" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="12238" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_1&#45;&gt;out_proj_3_3_1 -->
<g id="edge174" class="edge">
<title>attn_3_3_1&#45;&gt;out_proj_3_3_1</title>
<path fill="none" stroke="black" d="M12248.24,-888.36C12246.64,-873.48 12244.57,-854.33 12242.72,-837.13"/>
<polygon fill="black" stroke="black" points="12246.15,-836.3 12241.59,-826.73 12239.19,-837.05 12246.15,-836.3"/>
</g>
<!-- out_proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge192" class="edge">
<title>out_proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M12207.22,-758.32C12197.53,-747.91 12186.73,-736.29 12176.62,-725.42"/>
<polygon fill="black" stroke="black" points="12179.14,-722.98 12169.76,-718.04 12174.01,-727.75 12179.14,-722.98"/>
</g>
<!-- qkv_3_3_2 -->
<g id="node180" class="node">
<title>qkv_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12587,-1053.91 12403,-1053.91 12403,-985.91 12587,-985.91 12587,-1053.91"/>
<text text-anchor="middle" x="12495" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12495" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12495" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12495" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_2 -->
<g id="node181" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12608,-941.41 12382,-941.41 12382,-888.41 12608,-888.41 12608,-941.41"/>
<text text-anchor="middle" x="12495" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12495" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12495" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge175" class="edge">
<title>qkv_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M12495,-985.75C12495,-974.88 12495,-962.75 12495,-951.69"/>
<polygon fill="black" stroke="black" points="12498.5,-951.49 12495,-941.49 12491.5,-951.49 12498.5,-951.49"/>
</g>
<!-- out_proj_3_3_2 -->
<g id="node182" class="node">
<title>out_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12549,-826.43 12365,-826.43 12365,-758.43 12549,-758.43 12549,-826.43"/>
<text text-anchor="middle" x="12457" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12457" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12457" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12457" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_2&#45;&gt;out_proj_3_3_2 -->
<g id="edge176" class="edge">
<title>attn_3_3_2&#45;&gt;out_proj_3_3_2</title>
<path fill="none" stroke="black" d="M12486.94,-888.36C12482.21,-873.34 12476.1,-853.97 12470.63,-836.65"/>
<polygon fill="black" stroke="black" points="12473.85,-835.21 12467.5,-826.73 12467.17,-837.32 12473.85,-835.21"/>
</g>
<!-- out_proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge193" class="edge">
<title>out_proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M12364.59,-760.49C12327.91,-748.21 12285.45,-733.99 12247.33,-721.23"/>
<polygon fill="black" stroke="black" points="12248.34,-717.87 12237.74,-718.02 12246.11,-724.51 12248.34,-717.87"/>
</g>
<!-- qkv_3_3_3 -->
<g id="node183" class="node">
<title>qkv_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="12831,-1053.91 12647,-1053.91 12647,-985.91 12831,-985.91 12831,-1053.91"/>
<text text-anchor="middle" x="12739" y="-1038.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12739" y="-1023.71" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12739" y="-1008.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12739" y="-993.71" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_3_3_3 -->
<g id="node184" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="12852,-941.41 12626,-941.41 12626,-888.41 12852,-888.41 12852,-941.41"/>
<text text-anchor="middle" x="12739" y="-926.21" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12739" y="-911.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12739" y="-896.21" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge177" class="edge">
<title>qkv_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M12739,-985.75C12739,-974.88 12739,-962.75 12739,-951.69"/>
<polygon fill="black" stroke="black" points="12742.5,-951.49 12739,-941.49 12735.5,-951.49 12742.5,-951.49"/>
</g>
<!-- out_proj_3_3_3 -->
<g id="node185" class="node">
<title>out_proj_3_3_3</title>
<polygon fill="lightyellow" stroke="black" points="12776,-826.43 12592,-826.43 12592,-758.43 12776,-758.43 12776,-826.43"/>
<text text-anchor="middle" x="12684" y="-811.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12684" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="12684" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12684" y="-766.23" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3_3&#45;&gt;out_proj_3_3_3 -->
<g id="edge178" class="edge">
<title>attn_3_3_3&#45;&gt;out_proj_3_3_3</title>
<path fill="none" stroke="black" d="M12727.34,-888.36C12720.42,-873.2 12711.47,-853.61 12703.51,-836.16"/>
<polygon fill="black" stroke="black" points="12706.54,-834.37 12699.2,-826.73 12700.17,-837.28 12706.54,-834.37"/>
</g>
<!-- out_proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge194" class="edge">
<title>out_proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M12591.86,-762.97C12580.52,-760 12569.04,-757.23 12558,-754.95 12432.6,-729.05 12395.67,-742.17 12265.53,-717.95"/>
<polygon fill="black" stroke="black" points="12266.06,-714.49 12255.58,-716.06 12264.75,-721.36 12266.06,-714.49"/>
</g>
<!-- concat_heads_3 -->
<g id="node190" class="node">
<title>concat_heads_3</title>
<polygon fill="gold" stroke="black" points="10919,-591.45 10715,-591.45 10715,-538.45 10919,-538.45 10919,-591.45"/>
<text text-anchor="middle" x="10817" y="-576.25" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="10817" y="-561.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="10817" y="-546.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge195" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M9691.57,-671.97C9929.86,-649.52 10470.02,-598.64 10704.68,-576.53"/>
<polygon fill="black" stroke="black" points="10705.31,-579.99 10714.94,-575.57 10704.65,-573.02 10705.31,-579.99"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge196" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M10620.42,-649.89C10660.39,-632.83 10708.77,-612.17 10747.53,-595.62"/>
<polygon fill="black" stroke="black" points="10749.34,-598.65 10757.17,-591.5 10746.6,-592.21 10749.34,-598.65"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge197" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M11158.48,-659.12C11121.14,-651.04 11079.71,-641.6 11042,-631.95 10997.82,-620.65 10949.22,-606.61 10908.53,-594.38"/>
<polygon fill="black" stroke="black" points="10909.49,-591.01 10898.91,-591.47 10907.47,-597.71 10909.49,-591.01"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge198" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M12022.39,-675.99C11824.99,-663.72 11412.54,-636 11065,-598.95 11020.52,-594.21 10971.69,-587.94 10929.2,-582.15"/>
<polygon fill="black" stroke="black" points="10929.5,-578.65 10919.12,-580.76 10928.55,-585.59 10929.5,-578.65"/>
</g>
<!-- concat_heads_3&#45;&gt;res1_3 -->
<g id="edge200" class="edge">
<title>concat_heads_3&#45;&gt;res1_3</title>
<path fill="none" stroke="black" d="M10817,-538.23C10817,-525.69 10817,-510.41 10817,-496.76"/>
<polygon fill="black" stroke="black" points="10820.5,-496.71 10817,-486.71 10813.5,-496.71 10820.5,-496.71"/>
</g>
<!-- ln2_3 -->
<g id="node192" class="node">
<title>ln2_3</title>
<polygon fill="lightgray" stroke="black" points="10913.5,-367.45 10720.5,-367.45 10720.5,-314.45 10913.5,-314.45 10913.5,-367.45"/>
<text text-anchor="middle" x="10817" y="-352.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10817" y="-337.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="10817" y="-322.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_3&#45;&gt;ln2_3 -->
<g id="edge201" class="edge">
<title>res1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M10817,-433.28C10817,-416.97 10817,-395.63 10817,-377.68"/>
<polygon fill="black" stroke="black" points="10820.5,-377.57 10817,-367.57 10813.5,-377.57 10820.5,-377.57"/>
</g>
<!-- res2_3 -->
<g id="node203" class="node">
<title>res2_3</title>
<polygon fill="lightcyan" stroke="black" points="12322.5,-367.45 12129.5,-367.45 12129.5,-314.45 12322.5,-314.45 12322.5,-367.45"/>
<text text-anchor="middle" x="12226" y="-352.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12226" y="-337.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="12226" y="-322.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_3&#45;&gt;res2_3 -->
<g id="edge218" class="edge">
<title>res1_3&#45;&gt;res2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10913.57,-450.93C11167.77,-429.83 11854.08,-372.84 12119.33,-350.81"/>
<polygon fill="black" stroke="black" points="12119.68,-354.29 12129.36,-349.98 12119.1,-347.32 12119.68,-354.29"/>
</g>
<!-- gate_3 -->
<g id="node193" class="node">
<title>gate_3</title>
<polygon fill="lightpink" stroke="black" points="12466.5,-717.95 12273.5,-717.95 12273.5,-649.95 12466.5,-649.95 12466.5,-717.95"/>
<text text-anchor="middle" x="12370" y="-702.75" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="12370" y="-687.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="12370" y="-672.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="12370" y="-657.75" font-family="Times,serif" font-size="14.00">Expert Selection</text>
</g>
<!-- expert_3_0 -->
<g id="node194" class="node">
<title>expert_3_0</title>
<polygon fill="lightblue" stroke="black" points="11346,-598.95 11074,-598.95 11074,-530.95 11346,-530.95 11346,-598.95"/>
<text text-anchor="middle" x="11210" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11210" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="11210" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11210" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge202" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12273.27,-651.49C12270.49,-650.93 12267.73,-650.42 12265,-649.95 12135.01,-627.98 11803.54,-640.78 11672,-631.95 11533.98,-622.69 11496.5,-622.07 11356.4,-599.13"/>
<polygon fill="black" stroke="black" points="11356.57,-595.61 11346.13,-597.44 11355.43,-602.51 11356.57,-595.61"/>
<text text-anchor="middle" x="11717.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_1 -->
<g id="node195" class="node">
<title>expert_3_1</title>
<polygon fill="lightcoral" stroke="black" points="11636,-598.95 11364,-598.95 11364,-530.95 11636,-530.95 11636,-598.95"/>
<text text-anchor="middle" x="11500" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11500" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="11500" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="11500" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge203" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12273.25,-651.58C12270.48,-650.99 12267.73,-650.45 12265,-649.95 12117.4,-623.26 12077.45,-644.65 11928,-631.95 11805.03,-621.51 11771.49,-620.42 11646.13,-599.09"/>
<polygon fill="black" stroke="black" points="11646.59,-595.62 11636.14,-597.39 11645.41,-602.52 11646.59,-595.62"/>
<text text-anchor="middle" x="11973.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_2 -->
<g id="node196" class="node">
<title>expert_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11926,-598.95 11654,-598.95 11654,-530.95 11926,-530.95 11926,-598.95"/>
<text text-anchor="middle" x="11790" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11790" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="11790" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11790" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge204" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12273.49,-651.87C12270.64,-651.2 12267.8,-650.55 12265,-649.95 12198.05,-635.63 12179.69,-642.23 12112,-631.95 12035.98,-620.41 12014.98,-615.55 11936.11,-599.17"/>
<polygon fill="black" stroke="black" points="11936.69,-595.72 11926.19,-597.11 11935.27,-602.57 11936.69,-595.72"/>
<text text-anchor="middle" x="12157.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_3 -->
<g id="node197" class="node">
<title>expert_3_3</title>
<polygon fill="lightyellow" stroke="black" points="12216,-598.95 11944,-598.95 11944,-530.95 12216,-530.95 12216,-598.95"/>
<text text-anchor="middle" x="12080" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="12080" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="12080" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12080" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge205" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12288.06,-649.89C12251.7,-635.22 12208.76,-617.9 12171.37,-602.82"/>
<polygon fill="black" stroke="black" points="12172.57,-599.53 12161.99,-599.03 12169.95,-606.02 12172.57,-599.53"/>
<text text-anchor="middle" x="12287.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_4 -->
<g id="node198" class="node">
<title>expert_3_4</title>
<polygon fill="lightpink" stroke="black" points="12506,-598.95 12234,-598.95 12234,-530.95 12506,-530.95 12506,-598.95"/>
<text text-anchor="middle" x="12370" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12370" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="12370" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="12370" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_4 -->
<g id="edge206" class="edge">
<title>gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12370,-649.74C12370,-637.26 12370,-622.89 12370,-609.61"/>
<polygon fill="black" stroke="black" points="12373.5,-609.25 12370,-599.25 12366.5,-609.25 12373.5,-609.25"/>
<text text-anchor="middle" x="12415.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_5 -->
<g id="node199" class="node">
<title>expert_3_5</title>
<polygon fill="lightcyan" stroke="black" points="12796,-598.95 12524,-598.95 12524,-530.95 12796,-530.95 12796,-598.95"/>
<text text-anchor="middle" x="12660" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12660" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="12660" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="12660" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_5 -->
<g id="edge207" class="edge">
<title>gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12451.94,-649.89C12488.3,-635.22 12531.24,-617.9 12568.63,-602.82"/>
<polygon fill="black" stroke="black" points="12570.05,-606.02 12578.01,-599.03 12567.43,-599.53 12570.05,-606.02"/>
<text text-anchor="middle" x="12577.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_6 -->
<g id="node200" class="node">
<title>expert_3_6</title>
<polygon fill="lightgrey" stroke="black" points="13086,-598.95 12814,-598.95 12814,-530.95 13086,-530.95 13086,-598.95"/>
<text text-anchor="middle" x="12950" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12950" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="12950" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12950" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_6 -->
<g id="edge208" class="edge">
<title>gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12466.51,-665.26C12552.45,-649.29 12681.86,-624.71 12803.9,-599.16"/>
<polygon fill="black" stroke="black" points="12804.73,-602.57 12813.8,-597.09 12803.3,-595.72 12804.73,-602.57"/>
<text text-anchor="middle" x="12754.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3_7 -->
<g id="node201" class="node">
<title>expert_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="13376,-598.95 13104,-598.95 13104,-530.95 13376,-530.95 13376,-598.95"/>
<text text-anchor="middle" x="13240" y="-583.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13240" y="-568.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="13240" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13240" y="-538.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_3&#45;&gt;expert_3_7 -->
<g id="edge209" class="edge">
<title>gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12466.64,-675.11C12604.08,-663.22 12863.95,-637.96 13093.97,-599.07"/>
<polygon fill="black" stroke="black" points="13094.59,-602.52 13103.86,-597.39 13093.41,-595.62 13094.59,-602.52"/>
<text text-anchor="middle" x="13022.5" y="-620.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_3 -->
<g id="node202" class="node">
<title>expert_agg_3</title>
<polygon fill="gold" stroke="black" points="12322.5,-493.95 12129.5,-493.95 12129.5,-425.95 12322.5,-425.95 12322.5,-493.95"/>
<text text-anchor="middle" x="12226" y="-478.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12226" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="12226" y="-448.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="12226" y="-433.75" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge210" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11346.12,-532.38C11349.1,-531.88 11352.07,-531.4 11355,-530.95 11628.56,-489.05 11954.55,-471.32 12119.32,-464.59"/>
<polygon fill="black" stroke="black" points="12119.61,-468.08 12129.46,-464.18 12119.32,-461.09 12119.61,-468.08"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge211" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11636.14,-532.54C11639.12,-531.99 11642.07,-531.46 11645,-530.95 11809.62,-502.38 12002.51,-481.63 12119.41,-470.44"/>
<polygon fill="black" stroke="black" points="12119.81,-473.92 12129.43,-469.49 12119.14,-466.95 12119.81,-473.92"/>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge212" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11926.16,-531.79C11988.4,-517.08 12061.04,-499.92 12119.24,-486.17"/>
<polygon fill="black" stroke="black" points="12120.27,-489.53 12129.19,-483.82 12118.66,-482.72 12120.27,-489.53"/>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge213" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12127,-530.8C12140.94,-520.96 12156.33,-510.11 12170.74,-499.94"/>
<polygon fill="black" stroke="black" points="12172.94,-502.67 12179.09,-494.05 12168.9,-496.95 12172.94,-502.67"/>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge214" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12323.64,-530.8C12309.9,-520.96 12294.72,-510.11 12280.51,-499.94"/>
<polygon fill="black" stroke="black" points="12282.44,-497.02 12272.27,-494.05 12278.37,-502.71 12282.44,-497.02"/>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge215" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12523.87,-531.65C12462.18,-517.01 12390.32,-499.95 12332.64,-486.26"/>
<polygon fill="black" stroke="black" points="12333.31,-482.82 12322.78,-483.92 12331.7,-489.64 12333.31,-482.82"/>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge216" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12813.86,-532.54C12810.88,-531.99 12807.93,-531.46 12805,-530.95 12641.18,-502.49 12449.29,-481.74 12332.74,-470.52"/>
<polygon fill="black" stroke="black" points="12333.04,-467.03 12322.75,-469.56 12332.37,-474 12333.04,-467.03"/>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge217" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M13103.88,-532.38C13100.9,-531.88 13097.93,-531.4 13095,-530.95 12822.25,-489.15 12497.26,-471.39 12332.76,-464.62"/>
<polygon fill="black" stroke="black" points="12332.78,-461.12 12322.65,-464.21 12332.5,-468.12 12332.78,-461.12"/>
</g>
<!-- expert_agg_3&#45;&gt;res2_3 -->
<g id="edge219" class="edge">
<title>expert_agg_3&#45;&gt;res2_3</title>
<path fill="none" stroke="black" d="M12226,-425.74C12226,-410.81 12226,-393.16 12226,-377.91"/>
<polygon fill="black" stroke="black" points="12229.5,-377.81 12226,-367.81 12222.5,-377.81 12229.5,-377.81"/>
</g>
<!-- res1_4 -->
<g id="node258" class="node">
<title>res1_4</title>
<polygon fill="lightcyan" stroke="black" points="15093.5,-262.45 14900.5,-262.45 14900.5,-209.45 15093.5,-209.45 15093.5,-262.45"/>
<text text-anchor="middle" x="14997" y="-247.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14997" y="-232.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="14997" y="-217.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_3&#45;&gt;res1_4 -->
<g id="edge272" class="edge">
<title>res2_3&#45;&gt;res1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12322.59,-336.36C12747.1,-320.58 14445.65,-257.45 14890.12,-240.93"/>
<polygon fill="black" stroke="black" points="14890.52,-244.41 14900.38,-240.54 14890.26,-237.42 14890.52,-244.41"/>
</g>
<!-- ln1_4 -->
<g id="node204" class="node">
<title>ln1_4</title>
<polygon fill="lightgray" stroke="black" points="8572.5,-1241.41 8379.5,-1241.41 8379.5,-1188.41 8572.5,-1188.41 8572.5,-1241.41"/>
<text text-anchor="middle" x="8476" y="-1226.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8476" y="-1211.21" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="8476" y="-1196.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- qkv_4_0_0 -->
<g id="node205" class="node">
<title>qkv_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="13481,-826.43 13297,-826.43 13297,-758.43 13481,-758.43 13481,-826.43"/>
<text text-anchor="middle" x="13389" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13389" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13389" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="13389" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_0 -->
<g id="node206" class="node">
<title>attn_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="13502,-710.45 13276,-710.45 13276,-657.45 13502,-657.45 13502,-710.45"/>
<text text-anchor="middle" x="13389" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13389" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13389" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge220" class="edge">
<title>qkv_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M13389,-758.32C13389,-746.43 13389,-732.95 13389,-720.83"/>
<polygon fill="black" stroke="black" points="13392.5,-720.6 13389,-710.6 13385.5,-720.6 13392.5,-720.6"/>
</g>
<!-- out_proj_4_0_0 -->
<g id="node207" class="node">
<title>out_proj_4_0_0</title>
<polygon fill="lightblue" stroke="black" points="13578,-598.95 13394,-598.95 13394,-530.95 13578,-530.95 13578,-598.95"/>
<text text-anchor="middle" x="13486" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13486" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13486" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="13486" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_0&#45;&gt;out_proj_4_0_0 -->
<g id="edge221" class="edge">
<title>attn_4_0_0&#45;&gt;out_proj_4_0_0</title>
<path fill="none" stroke="black" d="M13410.29,-657.28C13422.46,-642.59 13438.02,-623.83 13451.86,-607.14"/>
<polygon fill="black" stroke="black" points="13454.8,-609.07 13458.49,-599.13 13449.41,-604.6 13454.8,-609.07"/>
</g>
<!-- concat_dim_4_0 -->
<g id="node253" class="node">
<title>concat_dim_4_0</title>
<polygon fill="orange" stroke="black" points="14006.5,-493.95 13773.5,-493.95 13773.5,-425.95 14006.5,-425.95 14006.5,-493.95"/>
<text text-anchor="middle" x="13890" y="-478.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="13890" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="13890" y="-448.75" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13890" y="-433.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_0_0&#45;&gt;concat_dim_4_0 -->
<g id="edge252" class="edge">
<title>out_proj_4_0_0&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M13578.1,-533.49C13581.09,-532.62 13584.07,-531.77 13587,-530.95 13644.41,-514.98 13708.65,-499.76 13763.14,-487.63"/>
<polygon fill="black" stroke="black" points="13764.2,-490.98 13773.2,-485.4 13762.68,-484.14 13764.2,-490.98"/>
</g>
<!-- qkv_4_0_1 -->
<g id="node208" class="node">
<title>qkv_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="13725,-826.43 13541,-826.43 13541,-758.43 13725,-758.43 13725,-826.43"/>
<text text-anchor="middle" x="13633" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13633" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13633" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13633" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_1 -->
<g id="node209" class="node">
<title>attn_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="13746,-710.45 13520,-710.45 13520,-657.45 13746,-657.45 13746,-710.45"/>
<text text-anchor="middle" x="13633" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13633" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13633" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge222" class="edge">
<title>qkv_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M13633,-758.32C13633,-746.43 13633,-732.95 13633,-720.83"/>
<polygon fill="black" stroke="black" points="13636.5,-720.6 13633,-710.6 13629.5,-720.6 13636.5,-720.6"/>
</g>
<!-- out_proj_4_0_1 -->
<g id="node210" class="node">
<title>out_proj_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="13780,-598.95 13596,-598.95 13596,-530.95 13780,-530.95 13780,-598.95"/>
<text text-anchor="middle" x="13688" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13688" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13688" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13688" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_1&#45;&gt;out_proj_4_0_1 -->
<g id="edge223" class="edge">
<title>attn_4_0_1&#45;&gt;out_proj_4_0_1</title>
<path fill="none" stroke="black" d="M13645.07,-657.28C13651.78,-642.99 13660.31,-624.85 13668,-608.51"/>
<polygon fill="black" stroke="black" points="13671.32,-609.67 13672.4,-599.13 13664.98,-606.7 13671.32,-609.67"/>
</g>
<!-- out_proj_4_0_1&#45;&gt;concat_dim_4_0 -->
<g id="edge253" class="edge">
<title>out_proj_4_0_1&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M13752.75,-530.94C13772.95,-520.64 13795.39,-509.2 13816.17,-498.6"/>
<polygon fill="black" stroke="black" points="13817.95,-501.62 13825.27,-493.96 13814.77,-495.38 13817.95,-501.62"/>
</g>
<!-- qkv_4_0_2 -->
<g id="node211" class="node">
<title>qkv_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="13969,-826.43 13785,-826.43 13785,-758.43 13969,-758.43 13969,-826.43"/>
<text text-anchor="middle" x="13877" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13877" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13877" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13877" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_2 -->
<g id="node212" class="node">
<title>attn_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="13990,-710.45 13764,-710.45 13764,-657.45 13990,-657.45 13990,-710.45"/>
<text text-anchor="middle" x="13877" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13877" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13877" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge224" class="edge">
<title>qkv_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M13877,-758.32C13877,-746.43 13877,-732.95 13877,-720.83"/>
<polygon fill="black" stroke="black" points="13880.5,-720.6 13877,-710.6 13873.5,-720.6 13880.5,-720.6"/>
</g>
<!-- out_proj_4_0_2 -->
<g id="node213" class="node">
<title>out_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="13982,-598.95 13798,-598.95 13798,-530.95 13982,-530.95 13982,-598.95"/>
<text text-anchor="middle" x="13890" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13890" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="13890" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13890" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_2&#45;&gt;out_proj_4_0_2 -->
<g id="edge225" class="edge">
<title>attn_4_0_2&#45;&gt;out_proj_4_0_2</title>
<path fill="none" stroke="black" d="M13879.85,-657.28C13881.41,-643.26 13883.38,-625.53 13885.17,-609.43"/>
<polygon fill="black" stroke="black" points="13888.69,-609.46 13886.31,-599.13 13881.73,-608.69 13888.69,-609.46"/>
</g>
<!-- out_proj_4_0_2&#45;&gt;concat_dim_4_0 -->
<g id="edge254" class="edge">
<title>out_proj_4_0_2&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M13890,-530.8C13890,-522.34 13890,-513.13 13890,-504.25"/>
<polygon fill="black" stroke="black" points="13893.5,-504.05 13890,-494.05 13886.5,-504.05 13893.5,-504.05"/>
</g>
<!-- qkv_4_0_3 -->
<g id="node214" class="node">
<title>qkv_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="14213,-826.43 14029,-826.43 14029,-758.43 14213,-758.43 14213,-826.43"/>
<text text-anchor="middle" x="14121" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14121" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14121" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14121" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_0_3 -->
<g id="node215" class="node">
<title>attn_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="14234,-710.45 14008,-710.45 14008,-657.45 14234,-657.45 14234,-710.45"/>
<text text-anchor="middle" x="14121" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14121" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14121" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge226" class="edge">
<title>qkv_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M14121,-758.32C14121,-746.43 14121,-732.95 14121,-720.83"/>
<polygon fill="black" stroke="black" points="14124.5,-720.6 14121,-710.6 14117.5,-720.6 14124.5,-720.6"/>
</g>
<!-- out_proj_4_0_3 -->
<g id="node216" class="node">
<title>out_proj_4_0_3</title>
<polygon fill="lightyellow" stroke="black" points="14205,-598.95 14021,-598.95 14021,-530.95 14205,-530.95 14205,-598.95"/>
<text text-anchor="middle" x="14113" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14113" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14113" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14113" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_0_3&#45;&gt;out_proj_4_0_3 -->
<g id="edge227" class="edge">
<title>attn_4_0_3&#45;&gt;out_proj_4_0_3</title>
<path fill="none" stroke="black" d="M14119.24,-657.28C14118.29,-643.26 14117.07,-625.53 14115.97,-609.43"/>
<polygon fill="black" stroke="black" points="14119.44,-608.87 14115.27,-599.13 14112.46,-609.35 14119.44,-608.87"/>
</g>
<!-- out_proj_4_0_3&#45;&gt;concat_dim_4_0 -->
<g id="edge255" class="edge">
<title>out_proj_4_0_3&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M14041.52,-530.94C14018.92,-520.5 13993.78,-508.89 13970.58,-498.17"/>
<polygon fill="black" stroke="black" points="13972,-494.97 13961.46,-493.96 13969.07,-501.33 13972,-494.97"/>
</g>
<!-- qkv_4_1_0 -->
<g id="node217" class="node">
<title>qkv_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="14457,-826.43 14273,-826.43 14273,-758.43 14457,-758.43 14457,-826.43"/>
<text text-anchor="middle" x="14365" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14365" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14365" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14365" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_0 -->
<g id="node218" class="node">
<title>attn_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="14478,-710.45 14252,-710.45 14252,-657.45 14478,-657.45 14478,-710.45"/>
<text text-anchor="middle" x="14365" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14365" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14365" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge228" class="edge">
<title>qkv_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M14365,-758.32C14365,-746.43 14365,-732.95 14365,-720.83"/>
<polygon fill="black" stroke="black" points="14368.5,-720.6 14365,-710.6 14361.5,-720.6 14368.5,-720.6"/>
</g>
<!-- out_proj_4_1_0 -->
<g id="node219" class="node">
<title>out_proj_4_1_0</title>
<polygon fill="lightpink" stroke="black" points="14478,-598.95 14294,-598.95 14294,-530.95 14478,-530.95 14478,-598.95"/>
<text text-anchor="middle" x="14386" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14386" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14386" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14386" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_0&#45;&gt;out_proj_4_1_0 -->
<g id="edge229" class="edge">
<title>attn_4_1_0&#45;&gt;out_proj_4_1_0</title>
<path fill="none" stroke="black" d="M14369.61,-657.28C14372.12,-643.26 14375.31,-625.53 14378.2,-609.43"/>
<polygon fill="black" stroke="black" points="14381.72,-609.6 14380.04,-599.13 14374.83,-608.36 14381.72,-609.6"/>
</g>
<!-- concat_dim_4_1 -->
<g id="node254" class="node">
<title>concat_dim_4_1</title>
<polygon fill="orange" stroke="black" points="14969.5,-493.95 14736.5,-493.95 14736.5,-425.95 14969.5,-425.95 14969.5,-493.95"/>
<text text-anchor="middle" x="14853" y="-478.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="14853" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="14853" y="-448.75" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14853" y="-433.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_1_0&#45;&gt;concat_dim_4_1 -->
<g id="edge256" class="edge">
<title>out_proj_4_1_0&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M14478.27,-542.46C14495.13,-538.59 14512.59,-534.62 14529,-530.95 14594.04,-516.42 14666.54,-500.72 14726.43,-487.87"/>
<polygon fill="black" stroke="black" points="14727.27,-491.27 14736.32,-485.75 14725.81,-484.42 14727.27,-491.27"/>
</g>
<!-- qkv_4_1_1 -->
<g id="node220" class="node">
<title>qkv_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="14701,-826.43 14517,-826.43 14517,-758.43 14701,-758.43 14701,-826.43"/>
<text text-anchor="middle" x="14609" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14609" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14609" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14609" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_1 -->
<g id="node221" class="node">
<title>attn_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="14722,-710.45 14496,-710.45 14496,-657.45 14722,-657.45 14722,-710.45"/>
<text text-anchor="middle" x="14609" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14609" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14609" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge230" class="edge">
<title>qkv_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M14609,-758.32C14609,-746.43 14609,-732.95 14609,-720.83"/>
<polygon fill="black" stroke="black" points="14612.5,-720.6 14609,-710.6 14605.5,-720.6 14612.5,-720.6"/>
</g>
<!-- out_proj_4_1_1 -->
<g id="node222" class="node">
<title>out_proj_4_1_1</title>
<polygon fill="lightcyan" stroke="black" points="14722,-598.95 14538,-598.95 14538,-530.95 14722,-530.95 14722,-598.95"/>
<text text-anchor="middle" x="14630" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14630" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14630" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="14630" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_1&#45;&gt;out_proj_4_1_1 -->
<g id="edge231" class="edge">
<title>attn_4_1_1&#45;&gt;out_proj_4_1_1</title>
<path fill="none" stroke="black" d="M14613.61,-657.28C14616.12,-643.26 14619.31,-625.53 14622.2,-609.43"/>
<polygon fill="black" stroke="black" points="14625.72,-609.6 14624.04,-599.13 14618.83,-608.36 14625.72,-609.6"/>
</g>
<!-- out_proj_4_1_1&#45;&gt;concat_dim_4_1 -->
<g id="edge257" class="edge">
<title>out_proj_4_1_1&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M14701.48,-530.94C14724.08,-520.5 14749.22,-508.89 14772.42,-498.17"/>
<polygon fill="black" stroke="black" points="14773.93,-501.33 14781.54,-493.96 14771,-494.97 14773.93,-501.33"/>
</g>
<!-- qkv_4_1_2 -->
<g id="node223" class="node">
<title>qkv_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="14945,-826.43 14761,-826.43 14761,-758.43 14945,-758.43 14945,-826.43"/>
<text text-anchor="middle" x="14853" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14853" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14853" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14853" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_2 -->
<g id="node224" class="node">
<title>attn_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="14966,-710.45 14740,-710.45 14740,-657.45 14966,-657.45 14966,-710.45"/>
<text text-anchor="middle" x="14853" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14853" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14853" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge232" class="edge">
<title>qkv_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M14853,-758.32C14853,-746.43 14853,-732.95 14853,-720.83"/>
<polygon fill="black" stroke="black" points="14856.5,-720.6 14853,-710.6 14849.5,-720.6 14856.5,-720.6"/>
</g>
<!-- out_proj_4_1_2 -->
<g id="node225" class="node">
<title>out_proj_4_1_2</title>
<polygon fill="lightgrey" stroke="black" points="14945,-598.95 14761,-598.95 14761,-530.95 14945,-530.95 14945,-598.95"/>
<text text-anchor="middle" x="14853" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14853" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="14853" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14853" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_2&#45;&gt;out_proj_4_1_2 -->
<g id="edge233" class="edge">
<title>attn_4_1_2&#45;&gt;out_proj_4_1_2</title>
<path fill="none" stroke="black" d="M14853,-657.28C14853,-643.26 14853,-625.53 14853,-609.43"/>
<polygon fill="black" stroke="black" points="14856.5,-609.13 14853,-599.13 14849.5,-609.13 14856.5,-609.13"/>
</g>
<!-- out_proj_4_1_2&#45;&gt;concat_dim_4_1 -->
<g id="edge258" class="edge">
<title>out_proj_4_1_2&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M14853,-530.8C14853,-522.34 14853,-513.13 14853,-504.25"/>
<polygon fill="black" stroke="black" points="14856.5,-504.05 14853,-494.05 14849.5,-504.05 14856.5,-504.05"/>
</g>
<!-- qkv_4_1_3 -->
<g id="node226" class="node">
<title>qkv_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="15189,-826.43 15005,-826.43 15005,-758.43 15189,-758.43 15189,-826.43"/>
<text text-anchor="middle" x="15097" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15097" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15097" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15097" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_1_3 -->
<g id="node227" class="node">
<title>attn_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="15210,-710.45 14984,-710.45 14984,-657.45 15210,-657.45 15210,-710.45"/>
<text text-anchor="middle" x="15097" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15097" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15097" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge234" class="edge">
<title>qkv_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M15097,-758.32C15097,-746.43 15097,-732.95 15097,-720.83"/>
<polygon fill="black" stroke="black" points="15100.5,-720.6 15097,-710.6 15093.5,-720.6 15100.5,-720.6"/>
</g>
<!-- out_proj_4_1_3 -->
<g id="node228" class="node">
<title>out_proj_4_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="15157,-598.95 14973,-598.95 14973,-530.95 15157,-530.95 15157,-598.95"/>
<text text-anchor="middle" x="15065" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15065" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15065" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="15065" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_1_3&#45;&gt;out_proj_4_1_3 -->
<g id="edge235" class="edge">
<title>attn_4_1_3&#45;&gt;out_proj_4_1_3</title>
<path fill="none" stroke="black" d="M15089.98,-657.28C15086.11,-643.13 15081.2,-625.19 15076.76,-608.97"/>
<polygon fill="black" stroke="black" points="15080.09,-607.86 15074.08,-599.13 15073.34,-609.7 15080.09,-607.86"/>
</g>
<!-- out_proj_4_1_3&#45;&gt;concat_dim_4_1 -->
<g id="edge259" class="edge">
<title>out_proj_4_1_3&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M14997.05,-530.94C14975.75,-520.59 14952.08,-509.09 14930.19,-498.46"/>
<polygon fill="black" stroke="black" points="14931.46,-495.18 14920.93,-493.96 14928.4,-501.48 14931.46,-495.18"/>
</g>
<!-- qkv_4_2_0 -->
<g id="node229" class="node">
<title>qkv_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="15433,-826.43 15249,-826.43 15249,-758.43 15433,-758.43 15433,-826.43"/>
<text text-anchor="middle" x="15341" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15341" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15341" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="15341" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_0 -->
<g id="node230" class="node">
<title>attn_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="15454,-710.45 15228,-710.45 15228,-657.45 15454,-657.45 15454,-710.45"/>
<text text-anchor="middle" x="15341" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15341" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15341" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge236" class="edge">
<title>qkv_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M15341,-758.32C15341,-746.43 15341,-732.95 15341,-720.83"/>
<polygon fill="black" stroke="black" points="15344.5,-720.6 15341,-710.6 15337.5,-720.6 15344.5,-720.6"/>
</g>
<!-- out_proj_4_2_0 -->
<g id="node231" class="node">
<title>out_proj_4_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="15454,-598.95 15270,-598.95 15270,-530.95 15454,-530.95 15454,-598.95"/>
<text text-anchor="middle" x="15362" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15362" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15362" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="15362" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_0&#45;&gt;out_proj_4_2_0 -->
<g id="edge237" class="edge">
<title>attn_4_2_0&#45;&gt;out_proj_4_2_0</title>
<path fill="none" stroke="black" d="M15345.61,-657.28C15348.12,-643.26 15351.31,-625.53 15354.2,-609.43"/>
<polygon fill="black" stroke="black" points="15357.72,-609.6 15356.04,-599.13 15350.83,-608.36 15357.72,-609.6"/>
</g>
<!-- concat_dim_4_2 -->
<g id="node255" class="node">
<title>concat_dim_4_2</title>
<polygon fill="orange" stroke="black" points="15701.5,-493.95 15468.5,-493.95 15468.5,-425.95 15701.5,-425.95 15701.5,-493.95"/>
<text text-anchor="middle" x="15585" y="-478.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="15585" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="15585" y="-448.75" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="15585" y="-433.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_2_0&#45;&gt;concat_dim_4_2 -->
<g id="edge260" class="edge">
<title>out_proj_4_2_0&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M15433.48,-530.94C15456.08,-520.5 15481.22,-508.89 15504.42,-498.17"/>
<polygon fill="black" stroke="black" points="15505.93,-501.33 15513.54,-493.96 15503,-494.97 15505.93,-501.33"/>
</g>
<!-- qkv_4_2_1 -->
<g id="node232" class="node">
<title>qkv_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="15677,-826.43 15493,-826.43 15493,-758.43 15677,-758.43 15677,-826.43"/>
<text text-anchor="middle" x="15585" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15585" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15585" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="15585" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_1 -->
<g id="node233" class="node">
<title>attn_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="15698,-710.45 15472,-710.45 15472,-657.45 15698,-657.45 15698,-710.45"/>
<text text-anchor="middle" x="15585" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15585" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15585" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge238" class="edge">
<title>qkv_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M15585,-758.32C15585,-746.43 15585,-732.95 15585,-720.83"/>
<polygon fill="black" stroke="black" points="15588.5,-720.6 15585,-710.6 15581.5,-720.6 15588.5,-720.6"/>
</g>
<!-- out_proj_4_2_1 -->
<g id="node234" class="node">
<title>out_proj_4_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="15677,-598.95 15493,-598.95 15493,-530.95 15677,-530.95 15677,-598.95"/>
<text text-anchor="middle" x="15585" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15585" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15585" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="15585" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_1&#45;&gt;out_proj_4_2_1 -->
<g id="edge239" class="edge">
<title>attn_4_2_1&#45;&gt;out_proj_4_2_1</title>
<path fill="none" stroke="black" d="M15585,-657.28C15585,-643.26 15585,-625.53 15585,-609.43"/>
<polygon fill="black" stroke="black" points="15588.5,-609.13 15585,-599.13 15581.5,-609.13 15588.5,-609.13"/>
</g>
<!-- out_proj_4_2_1&#45;&gt;concat_dim_4_2 -->
<g id="edge261" class="edge">
<title>out_proj_4_2_1&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M15585,-530.8C15585,-522.34 15585,-513.13 15585,-504.25"/>
<polygon fill="black" stroke="black" points="15588.5,-504.05 15585,-494.05 15581.5,-504.05 15588.5,-504.05"/>
</g>
<!-- qkv_4_2_2 -->
<g id="node235" class="node">
<title>qkv_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="15921,-826.43 15737,-826.43 15737,-758.43 15921,-758.43 15921,-826.43"/>
<text text-anchor="middle" x="15829" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15829" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15829" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="15829" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_2 -->
<g id="node236" class="node">
<title>attn_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="15942,-710.45 15716,-710.45 15716,-657.45 15942,-657.45 15942,-710.45"/>
<text text-anchor="middle" x="15829" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15829" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15829" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge240" class="edge">
<title>qkv_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M15829,-758.32C15829,-746.43 15829,-732.95 15829,-720.83"/>
<polygon fill="black" stroke="black" points="15832.5,-720.6 15829,-710.6 15825.5,-720.6 15832.5,-720.6"/>
</g>
<!-- out_proj_4_2_2 -->
<g id="node237" class="node">
<title>out_proj_4_2_2</title>
<polygon fill="lightslategray" stroke="black" points="15890,-598.95 15706,-598.95 15706,-530.95 15890,-530.95 15890,-598.95"/>
<text text-anchor="middle" x="15798" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15798" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="15798" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="15798" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_2&#45;&gt;out_proj_4_2_2 -->
<g id="edge241" class="edge">
<title>attn_4_2_2&#45;&gt;out_proj_4_2_2</title>
<path fill="none" stroke="black" d="M15822.2,-657.28C15818.45,-643.13 15813.7,-625.19 15809.4,-608.97"/>
<polygon fill="black" stroke="black" points="15812.74,-607.9 15806.79,-599.13 15805.97,-609.7 15812.74,-607.9"/>
</g>
<!-- out_proj_4_2_2&#45;&gt;concat_dim_4_2 -->
<g id="edge262" class="edge">
<title>out_proj_4_2_2&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M15729.73,-530.94C15708.23,-520.54 15684.34,-508.99 15662.26,-498.31"/>
<polygon fill="black" stroke="black" points="15663.78,-495.16 15653.25,-493.96 15660.73,-501.46 15663.78,-495.16"/>
</g>
<!-- qkv_4_2_3 -->
<g id="node238" class="node">
<title>qkv_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16165,-826.43 15981,-826.43 15981,-758.43 16165,-758.43 16165,-826.43"/>
<text text-anchor="middle" x="16073" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16073" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16073" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="16073" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_2_3 -->
<g id="node239" class="node">
<title>attn_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16186,-710.45 15960,-710.45 15960,-657.45 16186,-657.45 16186,-710.45"/>
<text text-anchor="middle" x="16073" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16073" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16073" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge242" class="edge">
<title>qkv_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M16073,-758.32C16073,-746.43 16073,-732.95 16073,-720.83"/>
<polygon fill="black" stroke="black" points="16076.5,-720.6 16073,-710.6 16069.5,-720.6 16076.5,-720.6"/>
</g>
<!-- out_proj_4_2_3 -->
<g id="node240" class="node">
<title>out_proj_4_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16113,-598.95 15929,-598.95 15929,-530.95 16113,-530.95 16113,-598.95"/>
<text text-anchor="middle" x="16021" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16021" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16021" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="16021" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_2_3&#45;&gt;out_proj_4_2_3 -->
<g id="edge243" class="edge">
<title>attn_4_2_3&#45;&gt;out_proj_4_2_3</title>
<path fill="none" stroke="black" d="M16061.59,-657.28C16055.24,-642.99 16047.18,-624.85 16039.91,-608.51"/>
<polygon fill="black" stroke="black" points="16043.01,-606.85 16035.75,-599.13 16036.61,-609.69 16043.01,-606.85"/>
</g>
<!-- out_proj_4_2_3&#45;&gt;concat_dim_4_2 -->
<g id="edge263" class="edge">
<title>out_proj_4_2_3&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M15928.85,-538.56C15918.79,-535.93 15908.69,-533.34 15899,-530.95 15837.49,-515.79 15768.83,-500.31 15711.45,-487.79"/>
<polygon fill="black" stroke="black" points="15712.12,-484.35 15701.6,-485.64 15710.63,-491.19 15712.12,-484.35"/>
</g>
<!-- qkv_4_3_0 -->
<g id="node241" class="node">
<title>qkv_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16409,-826.43 16225,-826.43 16225,-758.43 16409,-758.43 16409,-826.43"/>
<text text-anchor="middle" x="16317" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16317" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16317" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="16317" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_0 -->
<g id="node242" class="node">
<title>attn_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16430,-710.45 16204,-710.45 16204,-657.45 16430,-657.45 16430,-710.45"/>
<text text-anchor="middle" x="16317" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16317" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16317" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge244" class="edge">
<title>qkv_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M16317,-758.32C16317,-746.43 16317,-732.95 16317,-720.83"/>
<polygon fill="black" stroke="black" points="16320.5,-720.6 16317,-710.6 16313.5,-720.6 16320.5,-720.6"/>
</g>
<!-- out_proj_4_3_0 -->
<g id="node243" class="node">
<title>out_proj_4_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16424,-598.95 16240,-598.95 16240,-530.95 16424,-530.95 16424,-598.95"/>
<text text-anchor="middle" x="16332" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16332" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16332" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="16332" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_0&#45;&gt;out_proj_4_3_0 -->
<g id="edge245" class="edge">
<title>attn_4_3_0&#45;&gt;out_proj_4_3_0</title>
<path fill="none" stroke="black" d="M16320.29,-657.28C16322.09,-643.26 16324.36,-625.53 16326.43,-609.43"/>
<polygon fill="black" stroke="black" points="16329.95,-609.5 16327.75,-599.13 16323,-608.61 16329.95,-609.5"/>
</g>
<!-- concat_dim_4_3 -->
<g id="node256" class="node">
<title>concat_dim_4_3</title>
<polygon fill="orange" stroke="black" points="16559.5,-493.95 16326.5,-493.95 16326.5,-425.95 16559.5,-425.95 16559.5,-493.95"/>
<text text-anchor="middle" x="16443" y="-478.75" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="16443" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=2048]</text>
<text text-anchor="middle" x="16443" y="-448.75" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16443" y="-433.75" font-family="Times,serif" font-size="14.00">AllGather</text>
</g>
<!-- out_proj_4_3_0&#45;&gt;concat_dim_4_3 -->
<g id="edge264" class="edge">
<title>out_proj_4_3_0&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M16367.73,-530.8C16377.93,-521.33 16389.16,-510.92 16399.75,-501.08"/>
<polygon fill="black" stroke="black" points="16402.39,-503.42 16407.33,-494.05 16397.62,-498.28 16402.39,-503.42"/>
</g>
<!-- qkv_4_3_1 -->
<g id="node244" class="node">
<title>qkv_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="16653,-826.43 16469,-826.43 16469,-758.43 16653,-758.43 16653,-826.43"/>
<text text-anchor="middle" x="16561" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16561" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16561" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16561" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_1 -->
<g id="node245" class="node">
<title>attn_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="16674,-710.45 16448,-710.45 16448,-657.45 16674,-657.45 16674,-710.45"/>
<text text-anchor="middle" x="16561" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16561" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16561" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge246" class="edge">
<title>qkv_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M16561,-758.32C16561,-746.43 16561,-732.95 16561,-720.83"/>
<polygon fill="black" stroke="black" points="16564.5,-720.6 16561,-710.6 16557.5,-720.6 16564.5,-720.6"/>
</g>
<!-- out_proj_4_3_1 -->
<g id="node246" class="node">
<title>out_proj_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="16647,-598.95 16463,-598.95 16463,-530.95 16647,-530.95 16647,-598.95"/>
<text text-anchor="middle" x="16555" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16555" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16555" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16555" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_1&#45;&gt;out_proj_4_3_1 -->
<g id="edge247" class="edge">
<title>attn_4_3_1&#45;&gt;out_proj_4_3_1</title>
<path fill="none" stroke="black" d="M16559.68,-657.28C16558.96,-643.26 16558.06,-625.53 16557.23,-609.43"/>
<polygon fill="black" stroke="black" points="16560.71,-608.94 16556.7,-599.13 16553.72,-609.3 16560.71,-608.94"/>
</g>
<!-- out_proj_4_3_1&#45;&gt;concat_dim_4_3 -->
<g id="edge265" class="edge">
<title>out_proj_4_3_1&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M16518.95,-530.8C16508.65,-521.33 16497.33,-510.92 16486.64,-501.08"/>
<polygon fill="black" stroke="black" points="16488.72,-498.24 16478.99,-494.05 16483.98,-503.39 16488.72,-498.24"/>
</g>
<!-- qkv_4_3_2 -->
<g id="node247" class="node">
<title>qkv_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="16897,-826.43 16713,-826.43 16713,-758.43 16897,-758.43 16897,-826.43"/>
<text text-anchor="middle" x="16805" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16805" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16805" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16805" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_2 -->
<g id="node248" class="node">
<title>attn_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="16918,-710.45 16692,-710.45 16692,-657.45 16918,-657.45 16918,-710.45"/>
<text text-anchor="middle" x="16805" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16805" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16805" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge248" class="edge">
<title>qkv_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M16805,-758.32C16805,-746.43 16805,-732.95 16805,-720.83"/>
<polygon fill="black" stroke="black" points="16808.5,-720.6 16805,-710.6 16801.5,-720.6 16808.5,-720.6"/>
</g>
<!-- out_proj_4_3_2 -->
<g id="node249" class="node">
<title>out_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="16880,-598.95 16696,-598.95 16696,-530.95 16880,-530.95 16880,-598.95"/>
<text text-anchor="middle" x="16788" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16788" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="16788" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16788" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_2&#45;&gt;out_proj_4_3_2 -->
<g id="edge249" class="edge">
<title>attn_4_3_2&#45;&gt;out_proj_4_3_2</title>
<path fill="none" stroke="black" d="M16801.27,-657.28C16799.23,-643.26 16796.66,-625.53 16794.32,-609.43"/>
<polygon fill="black" stroke="black" points="16797.72,-608.53 16792.82,-599.13 16790.8,-609.53 16797.72,-608.53"/>
</g>
<!-- out_proj_4_3_2&#45;&gt;concat_dim_4_3 -->
<g id="edge266" class="edge">
<title>out_proj_4_3_2&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M16696,-536.49C16655.36,-524.35 16607.03,-509.93 16563.56,-496.95"/>
<polygon fill="black" stroke="black" points="16564.37,-493.54 16553.79,-494.03 16562.37,-500.24 16564.37,-493.54"/>
</g>
<!-- qkv_4_3_3 -->
<g id="node250" class="node">
<title>qkv_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="17141,-826.43 16957,-826.43 16957,-758.43 17141,-758.43 17141,-826.43"/>
<text text-anchor="middle" x="17049" y="-811.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17049" y="-796.23" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="17049" y="-781.23" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17049" y="-766.23" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- attn_4_3_3 -->
<g id="node251" class="node">
<title>attn_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="17162,-710.45 16936,-710.45 16936,-657.45 17162,-657.45 17162,-710.45"/>
<text text-anchor="middle" x="17049" y="-695.25" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17049" y="-680.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="17049" y="-665.25" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge250" class="edge">
<title>qkv_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M17049,-758.32C17049,-746.43 17049,-732.95 17049,-720.83"/>
<polygon fill="black" stroke="black" points="17052.5,-720.6 17049,-710.6 17045.5,-720.6 17052.5,-720.6"/>
</g>
<!-- out_proj_4_3_3 -->
<g id="node252" class="node">
<title>out_proj_4_3_3</title>
<polygon fill="lightyellow" stroke="black" points="17119,-598.95 16935,-598.95 16935,-530.95 17119,-530.95 17119,-598.95"/>
<text text-anchor="middle" x="17027" y="-583.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17027" y="-568.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=512]</text>
<text text-anchor="middle" x="17027" y="-553.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17027" y="-538.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_4_3_3&#45;&gt;out_proj_4_3_3 -->
<g id="edge251" class="edge">
<title>attn_4_3_3&#45;&gt;out_proj_4_3_3</title>
<path fill="none" stroke="black" d="M17044.17,-657.28C17041.51,-643.13 17038.14,-625.19 17035.09,-608.97"/>
<polygon fill="black" stroke="black" points="17038.53,-608.32 17033.24,-599.13 17031.65,-609.61 17038.53,-608.32"/>
</g>
<!-- out_proj_4_3_3&#45;&gt;concat_dim_4_3 -->
<g id="edge267" class="edge">
<title>out_proj_4_3_3&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M16934.9,-540.32C16919.63,-536.86 16903.92,-533.59 16889,-530.95 16751.18,-506.6 16711.48,-519.75 16569.52,-493.94"/>
<polygon fill="black" stroke="black" points="16570.04,-490.48 16559.57,-492.1 16568.77,-497.36 16570.04,-490.48"/>
</g>
<!-- concat_heads_4 -->
<g id="node257" class="node">
<title>concat_heads_4</title>
<polygon fill="gold" stroke="black" points="15099,-367.45 14895,-367.45 14895,-314.45 15099,-314.45 15099,-367.45"/>
<text text-anchor="middle" x="14997" y="-352.25" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="14997" y="-337.25" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="14997" y="-322.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_4_0&#45;&gt;concat_heads_4 -->
<g id="edge268" class="edge">
<title>concat_dim_4_0&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M14006.64,-446.63C14220.73,-424 14673.74,-376.12 14884.62,-353.83"/>
<polygon fill="black" stroke="black" points="14885.2,-357.29 14894.78,-352.76 14884.47,-350.33 14885.2,-357.29"/>
</g>
<!-- concat_dim_4_1&#45;&gt;concat_heads_4 -->
<g id="edge269" class="edge">
<title>concat_dim_4_1&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M14893.88,-425.74C14913.76,-409.59 14937.55,-390.25 14957.28,-374.23"/>
<polygon fill="black" stroke="black" points="14959.62,-376.83 14965.18,-367.81 14955.21,-371.4 14959.62,-376.83"/>
</g>
<!-- concat_dim_4_2&#45;&gt;concat_heads_4 -->
<g id="edge270" class="edge">
<title>concat_dim_4_2&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M15468.34,-444.62C15402.7,-435.75 15319.43,-423.16 15246,-407.95 15195.3,-397.45 15139.54,-382.95 15093.66,-370.22"/>
<polygon fill="black" stroke="black" points="15094.59,-366.85 15084.02,-367.53 15092.71,-373.59 15094.59,-366.85"/>
</g>
<!-- concat_dim_4_3&#45;&gt;concat_heads_4 -->
<g id="edge271" class="edge">
<title>concat_dim_4_3&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M16326.15,-450.29C16128.83,-435.57 15717.03,-404.36 15369,-374.95 15281.84,-367.59 15183.24,-358.82 15109.46,-352.18"/>
<polygon fill="black" stroke="black" points="15109.49,-348.66 15099.22,-351.25 15108.86,-355.64 15109.49,-348.66"/>
</g>
<!-- concat_heads_4&#45;&gt;res1_4 -->
<g id="edge273" class="edge">
<title>concat_heads_4&#45;&gt;res1_4</title>
<path fill="none" stroke="black" d="M14997,-314.23C14997,-301.69 14997,-286.41 14997,-272.76"/>
<polygon fill="black" stroke="black" points="15000.5,-272.71 14997,-262.71 14993.5,-272.71 15000.5,-272.71"/>
</g>
<!-- ln2_4 -->
<g id="node259" class="node">
<title>ln2_4</title>
<polygon fill="lightgray" stroke="black" points="15093.5,-164.95 14900.5,-164.95 14900.5,-111.95 15093.5,-111.95 15093.5,-164.95"/>
<text text-anchor="middle" x="14997" y="-149.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14997" y="-134.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="14997" y="-119.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_4&#45;&gt;ln2_4 -->
<g id="edge274" class="edge">
<title>res1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M14997,-209.36C14997,-198.87 14997,-186.55 14997,-175.19"/>
<polygon fill="black" stroke="black" points="15000.5,-175.12 14997,-165.12 14993.5,-175.12 15000.5,-175.12"/>
</g>
<!-- res2_4 -->
<g id="node270" class="node">
<title>res2_4</title>
<polygon fill="lightcyan" stroke="black" points="15825.5,-164.95 15632.5,-164.95 15632.5,-111.95 15825.5,-111.95 15825.5,-164.95"/>
<text text-anchor="middle" x="15729" y="-149.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15729" y="-134.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="15729" y="-119.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res1_4&#45;&gt;res2_4 -->
<g id="edge291" class="edge">
<title>res1_4&#45;&gt;res2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15093.83,-222.32C15230.81,-204.45 15480.29,-171.9 15622.41,-153.36"/>
<polygon fill="black" stroke="black" points="15622.99,-156.81 15632.45,-152.05 15622.08,-149.87 15622.99,-156.81"/>
</g>
<!-- gate_4 -->
<g id="node260" class="node">
<title>gate_4</title>
<polygon fill="lightpink" stroke="black" points="16770.5,-493.95 16577.5,-493.95 16577.5,-425.95 16770.5,-425.95 16770.5,-493.95"/>
<text text-anchor="middle" x="16674" y="-478.75" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="16674" y="-463.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="16674" y="-448.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="16674" y="-433.75" font-family="Times,serif" font-size="14.00">Expert Selection</text>
</g>
<!-- expert_4_0 -->
<g id="node261" class="node">
<title>expert_4_0</title>
<polygon fill="lightblue" stroke="black" points="15650,-374.95 15378,-374.95 15378,-306.95 15650,-306.95 15650,-374.95"/>
<text text-anchor="middle" x="15514" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15514" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="15514" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="15514" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_0 -->
<g id="edge275" class="edge">
<title>gate_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16577.27,-427.49C16574.49,-426.93 16571.73,-426.42 16569,-425.95 16439.01,-403.98 16107.54,-416.78 15976,-407.95 15837.98,-398.69 15800.5,-398.07 15660.4,-375.13"/>
<polygon fill="black" stroke="black" points="15660.57,-371.61 15650.13,-373.44 15659.43,-378.51 15660.57,-371.61"/>
<text text-anchor="middle" x="16021.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_1 -->
<g id="node262" class="node">
<title>expert_4_1</title>
<polygon fill="lightcoral" stroke="black" points="15940,-374.95 15668,-374.95 15668,-306.95 15940,-306.95 15940,-374.95"/>
<text text-anchor="middle" x="15804" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="15804" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="15804" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="15804" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_1 -->
<g id="edge276" class="edge">
<title>gate_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16577.25,-427.58C16574.48,-426.99 16571.73,-426.45 16569,-425.95 16421.4,-399.26 16381.45,-420.65 16232,-407.95 16109.03,-397.51 16075.49,-396.42 15950.13,-375.09"/>
<polygon fill="black" stroke="black" points="15950.59,-371.62 15940.14,-373.39 15949.41,-378.52 15950.59,-371.62"/>
<text text-anchor="middle" x="16277.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_2 -->
<g id="node263" class="node">
<title>expert_4_2</title>
<polygon fill="lightgreen" stroke="black" points="16230,-374.95 15958,-374.95 15958,-306.95 16230,-306.95 16230,-374.95"/>
<text text-anchor="middle" x="16094" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="16094" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="16094" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="16094" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_2 -->
<g id="edge277" class="edge">
<title>gate_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16577.49,-427.87C16574.64,-427.2 16571.8,-426.55 16569,-425.95 16502.05,-411.63 16483.69,-418.23 16416,-407.95 16339.98,-396.41 16318.98,-391.55 16240.11,-375.17"/>
<polygon fill="black" stroke="black" points="16240.69,-371.72 16230.19,-373.11 16239.27,-378.57 16240.69,-371.72"/>
<text text-anchor="middle" x="16461.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_3 -->
<g id="node264" class="node">
<title>expert_4_3</title>
<polygon fill="lightyellow" stroke="black" points="16520,-374.95 16248,-374.95 16248,-306.95 16520,-306.95 16520,-374.95"/>
<text text-anchor="middle" x="16384" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16384" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="16384" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="16384" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_3 -->
<g id="edge278" class="edge">
<title>gate_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16592.06,-425.89C16555.7,-411.22 16512.76,-393.9 16475.37,-378.82"/>
<polygon fill="black" stroke="black" points="16476.57,-375.53 16465.99,-375.03 16473.95,-382.02 16476.57,-375.53"/>
<text text-anchor="middle" x="16591.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_4 -->
<g id="node265" class="node">
<title>expert_4_4</title>
<polygon fill="lightpink" stroke="black" points="16810,-374.95 16538,-374.95 16538,-306.95 16810,-306.95 16810,-374.95"/>
<text text-anchor="middle" x="16674" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16674" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="16674" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16674" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_4 -->
<g id="edge279" class="edge">
<title>gate_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16674,-425.74C16674,-413.26 16674,-398.89 16674,-385.61"/>
<polygon fill="black" stroke="black" points="16677.5,-385.25 16674,-375.25 16670.5,-385.25 16677.5,-385.25"/>
<text text-anchor="middle" x="16719.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_5 -->
<g id="node266" class="node">
<title>expert_4_5</title>
<polygon fill="lightcyan" stroke="black" points="17100,-374.95 16828,-374.95 16828,-306.95 17100,-306.95 17100,-374.95"/>
<text text-anchor="middle" x="16964" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="16964" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="16964" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="16964" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_5 -->
<g id="edge280" class="edge">
<title>gate_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16755.94,-425.89C16792.3,-411.22 16835.24,-393.9 16872.63,-378.82"/>
<polygon fill="black" stroke="black" points="16874.05,-382.02 16882.01,-375.03 16871.43,-375.53 16874.05,-382.02"/>
<text text-anchor="middle" x="16881.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_6 -->
<g id="node267" class="node">
<title>expert_4_6</title>
<polygon fill="lightgrey" stroke="black" points="17390,-374.95 17118,-374.95 17118,-306.95 17390,-306.95 17390,-374.95"/>
<text text-anchor="middle" x="17254" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="17254" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="17254" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="17254" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_6 -->
<g id="edge281" class="edge">
<title>gate_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16770.51,-441.26C16856.45,-425.29 16985.86,-400.71 17107.9,-375.16"/>
<polygon fill="black" stroke="black" points="17108.73,-378.57 17117.8,-373.09 17107.3,-371.72 17108.73,-378.57"/>
<text text-anchor="middle" x="17058.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4_7 -->
<g id="node268" class="node">
<title>expert_4_7</title>
<polygon fill="lightseagreen" stroke="black" points="17680,-374.95 17408,-374.95 17408,-306.95 17680,-306.95 17680,-374.95"/>
<text text-anchor="middle" x="17544" y="-359.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="17544" y="-344.75" font-family="Times,serif" font-size="14.00">[B=variable, L=variable, D=32768]</text>
<text text-anchor="middle" x="17544" y="-329.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17544" y="-314.75" font-family="Times,serif" font-size="14.00">Column + Row Parallel</text>
</g>
<!-- gate_4&#45;&gt;expert_4_7 -->
<g id="edge282" class="edge">
<title>gate_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16770.64,-451.11C16908.08,-439.22 17167.95,-413.96 17397.97,-375.07"/>
<polygon fill="black" stroke="black" points="17398.59,-378.52 17407.86,-373.39 17397.41,-371.62 17398.59,-378.52"/>
<text text-anchor="middle" x="17326.5" y="-396.75" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_4 -->
<g id="node269" class="node">
<title>expert_agg_4</title>
<polygon fill="gold" stroke="black" points="16480.5,-269.95 16287.5,-269.95 16287.5,-201.95 16480.5,-201.95 16480.5,-269.95"/>
<text text-anchor="middle" x="16384" y="-254.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16384" y="-239.75" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="16384" y="-224.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="16384" y="-209.75" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
</g>
<!-- expert_4_0&#45;&gt;expert_agg_4 -->
<g id="edge283" class="edge">
<title>expert_4_0&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M15650.13,-308.44C15653.11,-307.92 15656.07,-307.43 15659,-306.95 15877.22,-271.73 16135.46,-251.97 16277.32,-242.98"/>
<polygon fill="black" stroke="black" points="16277.57,-246.47 16287.33,-242.35 16277.13,-239.49 16277.57,-246.47"/>
</g>
<!-- expert_4_1&#45;&gt;expert_agg_4 -->
<g id="edge284" class="edge">
<title>expert_4_1&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M15940.17,-308.69C15943.14,-308.1 15946.09,-307.52 15949,-306.95 16060.53,-285.31 16189.07,-265.22 16277.34,-252.16"/>
<polygon fill="black" stroke="black" points="16277.98,-255.61 16287.36,-250.69 16276.96,-248.68 16277.98,-255.61"/>
</g>
<!-- expert_4_2&#45;&gt;expert_agg_4 -->
<g id="edge285" class="edge">
<title>expert_4_2&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16186.95,-306.94C16217.13,-296.22 16250.78,-284.27 16281.61,-273.32"/>
<polygon fill="black" stroke="black" points="16282.82,-276.6 16291.07,-269.96 16280.48,-270.01 16282.82,-276.6"/>
</g>
<!-- expert_4_3&#45;&gt;expert_agg_4 -->
<g id="edge286" class="edge">
<title>expert_4_3&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16384,-306.8C16384,-298.34 16384,-289.13 16384,-280.25"/>
<polygon fill="black" stroke="black" points="16387.5,-280.05 16384,-270.05 16380.5,-280.05 16387.5,-280.05"/>
</g>
<!-- expert_4_4&#45;&gt;expert_agg_4 -->
<g id="edge287" class="edge">
<title>expert_4_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16581.05,-306.94C16550.87,-296.22 16517.22,-284.27 16486.39,-273.32"/>
<polygon fill="black" stroke="black" points="16487.52,-270.01 16476.93,-269.96 16485.18,-276.6 16487.52,-270.01"/>
</g>
<!-- expert_4_5&#45;&gt;expert_agg_4 -->
<g id="edge288" class="edge">
<title>expert_4_5&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16827.83,-308.69C16824.86,-308.1 16821.91,-307.52 16819,-306.95 16707.47,-285.31 16578.93,-265.22 16490.66,-252.16"/>
<polygon fill="black" stroke="black" points="16491.04,-248.68 16480.64,-250.69 16490.02,-255.61 16491.04,-248.68"/>
</g>
<!-- expert_4_6&#45;&gt;expert_agg_4 -->
<g id="edge289" class="edge">
<title>expert_4_6&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17117.87,-308.44C17114.89,-307.92 17111.93,-307.43 17109,-306.95 16890.78,-271.73 16632.54,-251.97 16490.68,-242.98"/>
<polygon fill="black" stroke="black" points="16490.87,-239.49 16480.67,-242.35 16490.43,-246.47 16490.87,-239.49"/>
</g>
<!-- expert_4_7&#45;&gt;expert_agg_4 -->
<g id="edge290" class="edge">
<title>expert_4_7&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17407.89,-308.33C17404.9,-307.85 17401.94,-307.39 17399,-306.95 17070.19,-258.5 16676.39,-243.46 16490.78,-238.89"/>
<polygon fill="black" stroke="black" points="16490.83,-235.39 16480.75,-238.64 16490.66,-242.38 16490.83,-235.39"/>
</g>
<!-- expert_agg_4&#45;&gt;res2_4 -->
<g id="edge292" class="edge">
<title>expert_agg_4&#45;&gt;res2_4</title>
<path fill="none" stroke="black" d="M16287.35,-220.86C16166.61,-203.26 15960.68,-173.23 15835.5,-154.98"/>
<polygon fill="black" stroke="black" points="15835.91,-151.5 15825.51,-153.52 15834.9,-158.43 15835.91,-151.5"/>
</g>
<!-- output -->
<g id="node271" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="15729" cy="-37.48" rx="136.44" ry="37.45"/>
<text text-anchor="middle" x="15729" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="15729" y="-33.78" font-family="Times,serif" font-size="14.00">[B=1024, L=L, D=8192]</text>
<text text-anchor="middle" x="15729" y="-18.78" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- res2_4&#45;&gt;output -->
<g id="edge293" class="edge">
<title>res2_4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15729,-111.71C15729,-103.63 15729,-94.45 15729,-85.39"/>
<polygon fill="black" stroke="black" points="15732.5,-85.27 15729,-75.27 15725.5,-85.27 15732.5,-85.27"/>
</g>
</g>
</svg>
