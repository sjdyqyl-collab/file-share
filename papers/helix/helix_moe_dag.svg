<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1800pt" height="1002pt"
 viewBox="0.00 0.00 1800.00 1002.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.1 0.1) rotate(0) translate(4 9773.13)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9773.13 17555.79,-9773.13 17555.79,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="10290.79,-9769.13 10084.79,-9769.13 10084.79,-9716.13 10290.79,-9716.13 10290.79,-9769.13"/>
<text text-anchor="middle" x="10187.79" y="-9753.93" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="10187.79" y="-9738.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10187.79" y="-9723.93" font-family="Times,serif" font-size="14.00">GPU: All GPUs (broadcast)</text>
</g>
<!-- layer1_ln1_0_0 -->
<g id="node2" class="node">
<title>layer1_ln1_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="5751.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="5751.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5751.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="5751.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5751.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer1_ln1_0_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_ln1_0_0</title>
<path fill="none" stroke="black" d="M10084.54,-9741.25C9539.91,-9739.07 6996.21,-9726.49 6209.79,-9679.13 6103.09,-9672.7 5982.87,-9660.14 5892.39,-9649.61"/>
<polygon fill="black" stroke="black" points="5892.68,-9646.12 5882.34,-9648.43 5891.87,-9653.07 5892.68,-9646.12"/>
</g>
<!-- layer1_ln1_0_1 -->
<g id="node3" class="node">
<title>layer1_ln1_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="6358.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6358.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6358.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="6358.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6358.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;layer1_ln1_0_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer1_ln1_0_1</title>
<path fill="none" stroke="black" d="M10084.6,-9740.82C9593.39,-9736.83 7488.68,-9717.75 6832.79,-9679.13 6720.78,-9672.53 6594.35,-9659.7 6500.26,-9649.1"/>
<polygon fill="black" stroke="black" points="6500.43,-9645.6 6490.1,-9647.95 6499.64,-9652.55 6500.43,-9645.6"/>
</g>
<!-- layer1_ln1_0_2 -->
<g id="node4" class="node">
<title>layer1_ln1_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6981.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6981.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6981.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="6981.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6981.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;layer1_ln1_0_2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer1_ln1_0_2</title>
<path fill="none" stroke="black" d="M10084.47,-9739.73C9618.42,-9731.09 7723.08,-9695.26 7457.79,-9679.13 7345.13,-9672.27 7217.91,-9659.43 7123.36,-9648.88"/>
<polygon fill="black" stroke="black" points="7123.49,-9645.37 7113.16,-9647.74 7122.71,-9652.33 7123.49,-9645.37"/>
</g>
<!-- layer1_ln1_0_3 -->
<g id="node5" class="node">
<title>layer1_ln1_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="7606.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7606.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7606.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="7606.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7606.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;layer1_ln1_0_3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer1_ln1_0_3</title>
<path fill="none" stroke="black" d="M10084.66,-9737.69C9862.94,-9729.34 9324.34,-9709.56 8872.79,-9697.13 8495.96,-9686.75 8400.93,-9704.25 8024.79,-9679.13 7931.68,-9672.91 7827.37,-9661.17 7746.25,-9650.96"/>
<polygon fill="black" stroke="black" points="7746.33,-9647.45 7735.97,-9649.66 7745.45,-9654.39 7746.33,-9647.45"/>
</g>
<!-- layer1_ln1_1_0 -->
<g id="node6" class="node">
<title>layer1_ln1_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="8173.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8173.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8173.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="8173.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8173.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;layer1_ln1_1_0 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;layer1_ln1_1_0</title>
<path fill="none" stroke="black" d="M10084.63,-9735.25C9926.52,-9725.67 9614.74,-9707.6 9349.79,-9697.13 9041.48,-9684.94 8963.75,-9698.14 8655.79,-9679.13 8541.1,-9672.05 8411.5,-9659.11 8315.6,-9648.58"/>
<polygon fill="black" stroke="black" points="8315.87,-9645.09 8305.54,-9647.48 8315.1,-9652.05 8315.87,-9645.09"/>
</g>
<!-- layer1_ln1_1_1 -->
<g id="node7" class="node">
<title>layer1_ln1_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="8804.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8804.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8804.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="8804.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8804.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;layer1_ln1_1_1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;layer1_ln1_1_1</title>
<path fill="none" stroke="black" d="M10084.69,-9733.54C9967.48,-9724.41 9770.4,-9709.25 9600.79,-9697.13 9481.72,-9688.61 9451.81,-9688.43 9332.79,-9679.13 9202.91,-9668.98 9055.22,-9655.65 8949.13,-9645.77"/>
<polygon fill="black" stroke="black" points="8949.28,-9642.27 8939,-9644.83 8948.63,-9649.24 8949.28,-9642.27"/>
</g>
<!-- layer1_ln1_1_2 -->
<g id="node8" class="node">
<title>layer1_ln1_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="9481.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9481.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9481.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="9481.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9481.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;layer1_ln1_1_2 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer1_ln1_1_2</title>
<path fill="none" stroke="black" d="M10084.76,-9725.63C9961.54,-9706.51 9754.88,-9674.43 9618.43,-9653.25"/>
<polygon fill="black" stroke="black" points="9618.74,-9649.76 9608.32,-9651.68 9617.66,-9656.67 9618.74,-9649.76"/>
</g>
<!-- layer1_ln1_1_3 -->
<g id="node9" class="node">
<title>layer1_ln1_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10052.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10052.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10052.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="10052.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10052.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;layer1_ln1_1_3 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;layer1_ln1_1_3</title>
<path fill="none" stroke="black" d="M10156.14,-9715.93C10143.65,-9705.79 10128.84,-9693.78 10114.4,-9682.06"/>
<polygon fill="black" stroke="black" points="10116.41,-9679.17 10106.44,-9675.59 10111.99,-9684.61 10116.41,-9679.17"/>
</g>
<!-- layer1_ln1_2_0 -->
<g id="node10" class="node">
<title>layer1_ln1_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10460.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10460.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10460.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="10460.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10460.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- input&#45;&gt;layer1_ln1_2_0 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;layer1_ln1_2_0</title>
<path fill="none" stroke="black" d="M10251.45,-9716.07C10284.14,-9702.95 10324.71,-9686.67 10361.4,-9671.94"/>
<polygon fill="black" stroke="black" points="10363.16,-9675 10371.14,-9668.03 10360.56,-9668.51 10363.16,-9675"/>
</g>
<!-- layer1_ln1_2_1 -->
<g id="node11" class="node">
<title>layer1_ln1_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="11074.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="11074.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11074.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="11074.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11074.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- input&#45;&gt;layer1_ln1_2_1 -->
<g id="edge10" class="edge">
<title>input&#45;&gt;layer1_ln1_2_1</title>
<path fill="none" stroke="black" d="M10290.84,-9728.9C10449.67,-9709.27 10754.64,-9671.6 10933.8,-9649.46"/>
<polygon fill="black" stroke="black" points="10934.33,-9652.92 10943.82,-9648.22 10933.47,-9645.98 10934.33,-9652.92"/>
</g>
<!-- layer1_ln1_2_2 -->
<g id="node12" class="node">
<title>layer1_ln1_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="11702.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="11702.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11702.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="11702.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11702.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- input&#45;&gt;layer1_ln1_2_2 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;layer1_ln1_2_2</title>
<path fill="none" stroke="black" d="M10290.81,-9736.7C10477.14,-9727.51 10882.5,-9706.18 11223.79,-9679.13 11336.93,-9670.16 11464.84,-9657.45 11560.01,-9647.5"/>
<polygon fill="black" stroke="black" points="11560.41,-9650.98 11569.99,-9646.45 11559.68,-9644.02 11560.41,-9650.98"/>
</g>
<!-- layer1_ln1_2_3 -->
<g id="node13" class="node">
<title>layer1_ln1_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="12353.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12353.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12353.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="12353.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12353.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- input&#45;&gt;layer1_ln1_2_3 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;layer1_ln1_2_3</title>
<path fill="none" stroke="black" d="M10291.1,-9739.76C10552.6,-9734.59 11261.87,-9717.84 11851.79,-9679.13 11973.08,-9671.17 12110.48,-9657.99 12210.84,-9647.6"/>
<polygon fill="black" stroke="black" points="12211.46,-9651.05 12221.04,-9646.54 12210.73,-9644.09 12211.46,-9651.05"/>
</g>
<!-- layer1_ln1_3_0 -->
<g id="node14" class="node">
<title>layer1_ln1_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12997.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12997.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12997.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="12997.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12997.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- input&#45;&gt;layer1_ln1_3_0 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;layer1_ln1_3_0</title>
<path fill="none" stroke="black" d="M10290.87,-9741.34C10616.05,-9739.88 11649.25,-9731.18 12502.79,-9679.13 12621.92,-9671.86 12756.74,-9658.71 12855.57,-9648.15"/>
<polygon fill="black" stroke="black" points="12856.05,-9651.62 12865.62,-9647.07 12855.3,-9644.66 12856.05,-9651.62"/>
</g>
<!-- layer1_ln1_3_1 -->
<g id="node15" class="node">
<title>layer1_ln1_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="13662.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="13662.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13662.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="13662.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13662.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- input&#45;&gt;layer1_ln1_3_1 -->
<g id="edge14" class="edge">
<title>input&#45;&gt;layer1_ln1_3_1</title>
<path fill="none" stroke="black" d="M10291.08,-9742.06C10671.36,-9743.08 12029.36,-9741.83 13146.79,-9679.13 13273.15,-9672.04 13416.47,-9658.52 13519.94,-9647.78"/>
<polygon fill="black" stroke="black" points="13520.56,-9651.23 13530.15,-9646.72 13519.84,-9644.27 13520.56,-9651.23"/>
</g>
<!-- layer1_ln1_3_2 -->
<g id="node16" class="node">
<title>layer1_ln1_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="14340.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="14340.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="14340.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="14340.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14340.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- input&#45;&gt;layer1_ln1_3_2 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;layer1_ln1_3_2</title>
<path fill="none" stroke="black" d="M10291.01,-9740.86C10805.83,-9736.89 13099.39,-9717.33 13811.79,-9679.13 13942.79,-9672.1 14091.59,-9658.34 14197.93,-9647.5"/>
<polygon fill="black" stroke="black" points="14198.5,-9650.96 14208.09,-9646.46 14197.78,-9644 14198.5,-9650.96"/>
</g>
<!-- layer1_ln1_3_3 -->
<g id="node17" class="node">
<title>layer1_ln1_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="14966.79" cy="-9631.04" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="14966.79" y="-9649.84" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="14966.79" y="-9634.84" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="14966.79" y="-9619.84" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14966.79" y="-9604.84" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- input&#45;&gt;layer1_ln1_3_3 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;layer1_ln1_3_3</title>
<path fill="none" stroke="black" d="M10290.89,-9741.33C10861.23,-9739.48 13635,-9728.08 14489.79,-9679.13 14603.03,-9672.64 14730.9,-9659.72 14825.73,-9649.05"/>
<polygon fill="black" stroke="black" points="14826.13,-9652.52 14835.67,-9647.92 14825.34,-9645.57 14826.13,-9652.52"/>
</g>
<!-- layer1_q_proj_0_0 -->
<g id="node18" class="node">
<title>layer1_q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="5551.29,-9545.96 5378.29,-9545.96 5378.29,-9462.96 5551.29,-9462.96 5551.29,-9545.96"/>
<text text-anchor="middle" x="5464.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5464.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="5464.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5464.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5464.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_0&#45;&gt;layer1_q_proj_0_0 -->
<g id="edge17" class="edge">
<title>layer1_ln1_0_0&#45;&gt;layer1_q_proj_0_0</title>
<path fill="none" stroke="black" d="M5666.07,-9592.83C5633.01,-9578.48 5595.03,-9561.99 5561.03,-9547.24"/>
<polygon fill="black" stroke="black" points="5562.13,-9543.9 5551.56,-9543.12 5559.34,-9550.32 5562.13,-9543.9"/>
</g>
<!-- layer1_k_proj_0_0 -->
<g id="node19" class="node">
<title>layer1_k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="5742.29,-9545.96 5569.29,-9545.96 5569.29,-9462.96 5742.29,-9462.96 5742.29,-9545.96"/>
<text text-anchor="middle" x="5655.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5655.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="5655.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5655.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5655.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_0&#45;&gt;layer1_k_proj_0_0 -->
<g id="edge18" class="edge">
<title>layer1_ln1_0_0&#45;&gt;layer1_k_proj_0_0</title>
<path fill="none" stroke="black" d="M5716.59,-9584.36C5709.06,-9574.59 5701.09,-9564.24 5693.47,-9554.36"/>
<polygon fill="black" stroke="black" points="5696.06,-9551.98 5687.18,-9546.19 5690.51,-9556.25 5696.06,-9551.98"/>
</g>
<!-- layer1_v_proj_0_0 -->
<g id="node20" class="node">
<title>layer1_v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="5933.29,-9545.96 5760.29,-9545.96 5760.29,-9462.96 5933.29,-9462.96 5933.29,-9545.96"/>
<text text-anchor="middle" x="5846.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5846.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="5846.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5846.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5846.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_0&#45;&gt;layer1_v_proj_0_0 -->
<g id="edge19" class="edge">
<title>layer1_ln1_0_0&#45;&gt;layer1_v_proj_0_0</title>
<path fill="none" stroke="black" d="M5786.63,-9584.36C5794.07,-9574.59 5801.97,-9564.24 5809.5,-9554.36"/>
<polygon fill="black" stroke="black" points="5812.45,-9556.27 5815.73,-9546.19 5806.88,-9552.02 5812.45,-9556.27"/>
</g>
<!-- layer1_q_proj_0_1 -->
<g id="node21" class="node">
<title>layer1_q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="6141.79,-9545.96 5951.79,-9545.96 5951.79,-9462.96 6141.79,-9462.96 6141.79,-9545.96"/>
<text text-anchor="middle" x="6046.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6046.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="6046.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6046.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="6046.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_1&#45;&gt;layer1_q_proj_0_1 -->
<g id="edge20" class="edge">
<title>layer1_ln1_0_1&#45;&gt;layer1_q_proj_0_1</title>
<path fill="none" stroke="black" d="M6268.55,-9594.01C6231.96,-9579.4 6189.48,-9562.43 6151.54,-9547.29"/>
<polygon fill="black" stroke="black" points="6152.58,-9543.93 6142,-9543.48 6149.98,-9550.43 6152.58,-9543.93"/>
</g>
<!-- layer1_k_proj_0_1 -->
<g id="node22" class="node">
<title>layer1_k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="6349.79,-9545.96 6159.79,-9545.96 6159.79,-9462.96 6349.79,-9462.96 6349.79,-9545.96"/>
<text text-anchor="middle" x="6254.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6254.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="6254.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6254.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="6254.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_1&#45;&gt;layer1_k_proj_0_1 -->
<g id="edge21" class="edge">
<title>layer1_ln1_0_1&#45;&gt;layer1_k_proj_0_1</title>
<path fill="none" stroke="black" d="M6320.95,-9584.71C6312.53,-9574.62 6303.57,-9563.89 6295.05,-9553.69"/>
<polygon fill="black" stroke="black" points="6297.74,-9551.44 6288.64,-9546.01 6292.36,-9555.93 6297.74,-9551.44"/>
</g>
<!-- layer1_v_proj_0_1 -->
<g id="node23" class="node">
<title>layer1_v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="6557.79,-9545.96 6367.79,-9545.96 6367.79,-9462.96 6557.79,-9462.96 6557.79,-9545.96"/>
<text text-anchor="middle" x="6462.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6462.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="6462.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6462.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="6462.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_1&#45;&gt;layer1_v_proj_0_1 -->
<g id="edge22" class="edge">
<title>layer1_ln1_0_1&#45;&gt;layer1_v_proj_0_1</title>
<path fill="none" stroke="black" d="M6396.63,-9584.71C6405.06,-9574.62 6414.01,-9563.89 6422.53,-9553.69"/>
<polygon fill="black" stroke="black" points="6425.22,-9555.93 6428.94,-9546.01 6419.85,-9551.44 6425.22,-9555.93"/>
</g>
<!-- layer1_q_proj_0_2 -->
<g id="node24" class="node">
<title>layer1_q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="6765.79,-9545.96 6575.79,-9545.96 6575.79,-9462.96 6765.79,-9462.96 6765.79,-9545.96"/>
<text text-anchor="middle" x="6670.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6670.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="6670.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6670.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6670.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_2&#45;&gt;layer1_q_proj_0_2 -->
<g id="edge23" class="edge">
<title>layer1_ln1_0_2&#45;&gt;layer1_q_proj_0_2</title>
<path fill="none" stroke="black" d="M6891.84,-9594.01C6855.45,-9579.43 6813.21,-9562.51 6775.46,-9547.39"/>
<polygon fill="black" stroke="black" points="6776.55,-9544.05 6765.96,-9543.59 6773.94,-9550.55 6776.55,-9544.05"/>
</g>
<!-- layer1_k_proj_0_2 -->
<g id="node25" class="node">
<title>layer1_k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="6973.79,-9545.96 6783.79,-9545.96 6783.79,-9462.96 6973.79,-9462.96 6973.79,-9545.96"/>
<text text-anchor="middle" x="6878.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6878.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="6878.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6878.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6878.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_2&#45;&gt;layer1_k_proj_0_2 -->
<g id="edge24" class="edge">
<title>layer1_ln1_0_2&#45;&gt;layer1_k_proj_0_2</title>
<path fill="none" stroke="black" d="M6944.31,-9584.71C6936.05,-9574.72 6927.27,-9564.1 6918.91,-9553.99"/>
<polygon fill="black" stroke="black" points="6921.39,-9551.49 6912.32,-9546.01 6915.99,-9555.95 6921.39,-9551.49"/>
</g>
<!-- layer1_v_proj_0_2 -->
<g id="node26" class="node">
<title>layer1_v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7181.79,-9545.96 6991.79,-9545.96 6991.79,-9462.96 7181.79,-9462.96 7181.79,-9545.96"/>
<text text-anchor="middle" x="7086.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7086.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="7086.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7086.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7086.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_2&#45;&gt;layer1_v_proj_0_2 -->
<g id="edge25" class="edge">
<title>layer1_ln1_0_2&#45;&gt;layer1_v_proj_0_2</title>
<path fill="none" stroke="black" d="M7020,-9584.71C7028.5,-9574.62 7037.55,-9563.89 7046.14,-9553.69"/>
<polygon fill="black" stroke="black" points="7048.85,-9555.91 7052.62,-9546.01 7043.5,-9551.4 7048.85,-9555.91"/>
</g>
<!-- layer1_q_proj_0_3 -->
<g id="node27" class="node">
<title>layer1_q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7389.79,-9545.96 7199.79,-9545.96 7199.79,-9462.96 7389.79,-9462.96 7389.79,-9545.96"/>
<text text-anchor="middle" x="7294.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7294.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="7294.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7294.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7294.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_3&#45;&gt;layer1_q_proj_0_3 -->
<g id="edge26" class="edge">
<title>layer1_ln1_0_3&#45;&gt;layer1_q_proj_0_3</title>
<path fill="none" stroke="black" d="M7516.55,-9594.01C7479.96,-9579.4 7437.48,-9562.43 7399.54,-9547.29"/>
<polygon fill="black" stroke="black" points="7400.58,-9543.93 7390,-9543.48 7397.98,-9550.43 7400.58,-9543.93"/>
</g>
<!-- layer1_k_proj_0_3 -->
<g id="node28" class="node">
<title>layer1_k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7597.79,-9545.96 7407.79,-9545.96 7407.79,-9462.96 7597.79,-9462.96 7597.79,-9545.96"/>
<text text-anchor="middle" x="7502.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7502.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="7502.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7502.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7502.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_3&#45;&gt;layer1_k_proj_0_3 -->
<g id="edge27" class="edge">
<title>layer1_ln1_0_3&#45;&gt;layer1_k_proj_0_3</title>
<path fill="none" stroke="black" d="M7568.95,-9584.71C7560.53,-9574.62 7551.57,-9563.89 7543.05,-9553.69"/>
<polygon fill="black" stroke="black" points="7545.74,-9551.44 7536.64,-9546.01 7540.36,-9555.93 7545.74,-9551.44"/>
</g>
<!-- layer1_v_proj_0_3 -->
<g id="node29" class="node">
<title>layer1_v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7805.79,-9545.96 7615.79,-9545.96 7615.79,-9462.96 7805.79,-9462.96 7805.79,-9545.96"/>
<text text-anchor="middle" x="7710.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7710.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="7710.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7710.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7710.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_0_3&#45;&gt;layer1_v_proj_0_3 -->
<g id="edge28" class="edge">
<title>layer1_ln1_0_3&#45;&gt;layer1_v_proj_0_3</title>
<path fill="none" stroke="black" d="M7644.63,-9584.71C7653.06,-9574.62 7662.01,-9563.89 7670.53,-9553.69"/>
<polygon fill="black" stroke="black" points="7673.22,-9555.93 7676.94,-9546.01 7667.85,-9551.44 7673.22,-9555.93"/>
</g>
<!-- layer1_q_proj_1_0 -->
<g id="node30" class="node">
<title>layer1_q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7997.29,-9545.96 7824.29,-9545.96 7824.29,-9462.96 7997.29,-9462.96 7997.29,-9545.96"/>
<text text-anchor="middle" x="7910.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7910.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="7910.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7910.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7910.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_0&#45;&gt;layer1_q_proj_1_0 -->
<g id="edge29" class="edge">
<title>layer1_ln1_1_0&#45;&gt;layer1_q_proj_1_0</title>
<path fill="none" stroke="black" d="M8092.74,-9591.65C8065.23,-9578.62 8034.24,-9563.94 8005.75,-9550.44"/>
<polygon fill="black" stroke="black" points="8007.13,-9547.22 7996.59,-9546.1 8004.13,-9553.55 8007.13,-9547.22"/>
</g>
<!-- layer1_k_proj_1_0 -->
<g id="node31" class="node">
<title>layer1_k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="8188.29,-9545.96 8015.29,-9545.96 8015.29,-9462.96 8188.29,-9462.96 8188.29,-9545.96"/>
<text text-anchor="middle" x="8101.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8101.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="8101.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8101.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8101.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_0&#45;&gt;layer1_k_proj_1_0 -->
<g id="edge30" class="edge">
<title>layer1_ln1_1_0&#45;&gt;layer1_k_proj_1_0</title>
<path fill="none" stroke="black" d="M8146.98,-9583.65C8141.59,-9574.32 8135.9,-9564.48 8130.45,-9555.04"/>
<polygon fill="black" stroke="black" points="8133.34,-9553.06 8125.31,-9546.15 8127.28,-9556.56 8133.34,-9553.06"/>
</g>
<!-- layer1_v_proj_1_0 -->
<g id="node32" class="node">
<title>layer1_v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="8379.29,-9545.96 8206.29,-9545.96 8206.29,-9462.96 8379.29,-9462.96 8379.29,-9545.96"/>
<text text-anchor="middle" x="8292.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8292.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="8292.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8292.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8292.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_0&#45;&gt;layer1_v_proj_1_0 -->
<g id="edge31" class="edge">
<title>layer1_ln1_1_0&#45;&gt;layer1_v_proj_1_0</title>
<path fill="none" stroke="black" d="M8216.75,-9585.07C8226.5,-9574.86 8236.9,-9563.98 8246.77,-9553.64"/>
<polygon fill="black" stroke="black" points="8249.47,-9555.88 8253.85,-9546.23 8244.41,-9551.05 8249.47,-9555.88"/>
</g>
<!-- layer1_q_proj_1_1 -->
<g id="node33" class="node">
<title>layer1_q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="8587.79,-9545.96 8397.79,-9545.96 8397.79,-9462.96 8587.79,-9462.96 8587.79,-9545.96"/>
<text text-anchor="middle" x="8492.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8492.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="8492.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8492.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8492.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_1&#45;&gt;layer1_q_proj_1_1 -->
<g id="edge32" class="edge">
<title>layer1_ln1_1_1&#45;&gt;layer1_q_proj_1_1</title>
<path fill="none" stroke="black" d="M8714.55,-9594.01C8677.96,-9579.4 8635.48,-9562.43 8597.54,-9547.29"/>
<polygon fill="black" stroke="black" points="8598.58,-9543.93 8588,-9543.48 8595.98,-9550.43 8598.58,-9543.93"/>
</g>
<!-- layer1_k_proj_1_1 -->
<g id="node34" class="node">
<title>layer1_k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="8795.79,-9545.96 8605.79,-9545.96 8605.79,-9462.96 8795.79,-9462.96 8795.79,-9545.96"/>
<text text-anchor="middle" x="8700.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8700.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="8700.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8700.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8700.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_1&#45;&gt;layer1_k_proj_1_1 -->
<g id="edge33" class="edge">
<title>layer1_ln1_1_1&#45;&gt;layer1_k_proj_1_1</title>
<path fill="none" stroke="black" d="M8766.95,-9584.71C8758.53,-9574.62 8749.57,-9563.89 8741.05,-9553.69"/>
<polygon fill="black" stroke="black" points="8743.74,-9551.44 8734.64,-9546.01 8738.36,-9555.93 8743.74,-9551.44"/>
</g>
<!-- layer1_v_proj_1_1 -->
<g id="node35" class="node">
<title>layer1_v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="9003.79,-9545.96 8813.79,-9545.96 8813.79,-9462.96 9003.79,-9462.96 9003.79,-9545.96"/>
<text text-anchor="middle" x="8908.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8908.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="8908.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8908.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8908.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_1&#45;&gt;layer1_v_proj_1_1 -->
<g id="edge34" class="edge">
<title>layer1_ln1_1_1&#45;&gt;layer1_v_proj_1_1</title>
<path fill="none" stroke="black" d="M8842.63,-9584.71C8851.06,-9574.62 8860.01,-9563.89 8868.53,-9553.69"/>
<polygon fill="black" stroke="black" points="8871.22,-9555.93 8874.94,-9546.01 8865.85,-9551.44 8871.22,-9555.93"/>
</g>
<!-- layer1_q_proj_1_2 -->
<g id="node36" class="node">
<title>layer1_q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="9211.79,-9545.96 9021.79,-9545.96 9021.79,-9462.96 9211.79,-9462.96 9211.79,-9545.96"/>
<text text-anchor="middle" x="9116.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9116.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="9116.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9116.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9116.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_2&#45;&gt;layer1_q_proj_1_2 -->
<g id="edge35" class="edge">
<title>layer1_ln1_1_2&#45;&gt;layer1_q_proj_1_2</title>
<path fill="none" stroke="black" d="M9378.74,-9598.4C9333.08,-9584.01 9278.58,-9566.32 9221.48,-9546.16"/>
<polygon fill="black" stroke="black" points="9222.52,-9542.81 9211.92,-9542.77 9220.18,-9549.41 9222.52,-9542.81"/>
</g>
<!-- layer1_k_proj_1_2 -->
<g id="node37" class="node">
<title>layer1_k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="9419.79,-9545.96 9229.79,-9545.96 9229.79,-9462.96 9419.79,-9462.96 9419.79,-9545.96"/>
<text text-anchor="middle" x="9324.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9324.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="9324.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9324.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9324.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_2&#45;&gt;layer1_k_proj_1_2 -->
<g id="edge36" class="edge">
<title>layer1_ln1_1_2&#45;&gt;layer1_k_proj_1_2</title>
<path fill="none" stroke="black" d="M9426.88,-9586.47C9413.06,-9575.5 9398.16,-9563.68 9384.13,-9552.55"/>
<polygon fill="black" stroke="black" points="9385.99,-9549.56 9375.99,-9546.08 9381.64,-9555.04 9385.99,-9549.56"/>
</g>
<!-- layer1_v_proj_1_2 -->
<g id="node38" class="node">
<title>layer1_v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="9627.79,-9545.96 9437.79,-9545.96 9437.79,-9462.96 9627.79,-9462.96 9627.79,-9545.96"/>
<text text-anchor="middle" x="9532.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9532.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="9532.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9532.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9532.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_2&#45;&gt;layer1_v_proj_1_2 -->
<g id="edge37" class="edge">
<title>layer1_ln1_1_2&#45;&gt;layer1_v_proj_1_2</title>
<path fill="none" stroke="black" d="M9500.93,-9583.3C9504.62,-9574.28 9508.5,-9564.8 9512.24,-9555.67"/>
<polygon fill="black" stroke="black" points="9515.51,-9556.91 9516.06,-9546.33 9509.03,-9554.26 9515.51,-9556.91"/>
</g>
<!-- layer1_q_proj_1_3 -->
<g id="node39" class="node">
<title>layer1_q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="9835.79,-9545.96 9645.79,-9545.96 9645.79,-9462.96 9835.79,-9462.96 9835.79,-9545.96"/>
<text text-anchor="middle" x="9740.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9740.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="9740.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9740.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9740.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_3&#45;&gt;layer1_q_proj_1_3 -->
<g id="edge38" class="edge">
<title>layer1_ln1_1_3&#45;&gt;layer1_q_proj_1_3</title>
<path fill="none" stroke="black" d="M9962.55,-9594.01C9925.96,-9579.4 9883.48,-9562.43 9845.54,-9547.29"/>
<polygon fill="black" stroke="black" points="9846.58,-9543.93 9836,-9543.48 9843.98,-9550.43 9846.58,-9543.93"/>
</g>
<!-- layer1_k_proj_1_3 -->
<g id="node40" class="node">
<title>layer1_k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="10043.79,-9545.96 9853.79,-9545.96 9853.79,-9462.96 10043.79,-9462.96 10043.79,-9545.96"/>
<text text-anchor="middle" x="9948.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9948.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="9948.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9948.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9948.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_3&#45;&gt;layer1_k_proj_1_3 -->
<g id="edge39" class="edge">
<title>layer1_ln1_1_3&#45;&gt;layer1_k_proj_1_3</title>
<path fill="none" stroke="black" d="M10014.95,-9584.71C10006.53,-9574.62 9997.57,-9563.89 9989.05,-9553.69"/>
<polygon fill="black" stroke="black" points="9991.74,-9551.44 9982.64,-9546.01 9986.36,-9555.93 9991.74,-9551.44"/>
</g>
<!-- layer1_v_proj_1_3 -->
<g id="node41" class="node">
<title>layer1_v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="10251.79,-9545.96 10061.79,-9545.96 10061.79,-9462.96 10251.79,-9462.96 10251.79,-9545.96"/>
<text text-anchor="middle" x="10156.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10156.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="10156.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10156.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10156.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_1_3&#45;&gt;layer1_v_proj_1_3 -->
<g id="edge40" class="edge">
<title>layer1_ln1_1_3&#45;&gt;layer1_v_proj_1_3</title>
<path fill="none" stroke="black" d="M10090.63,-9584.71C10099.06,-9574.62 10108.01,-9563.89 10116.53,-9553.69"/>
<polygon fill="black" stroke="black" points="10119.22,-9555.93 10122.94,-9546.01 10113.85,-9551.44 10119.22,-9555.93"/>
</g>
<!-- layer1_q_proj_2_0 -->
<g id="node42" class="node">
<title>layer1_q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10451.29,-9545.96 10270.29,-9545.96 10270.29,-9462.96 10451.29,-9462.96 10451.29,-9545.96"/>
<text text-anchor="middle" x="10360.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10360.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="10360.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10360.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10360.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_0&#45;&gt;layer1_q_proj_2_0 -->
<g id="edge41" class="edge">
<title>layer1_ln1_2_0&#45;&gt;layer1_q_proj_2_0</title>
<path fill="none" stroke="black" d="M10424.12,-9584.36C10416.21,-9574.5 10407.81,-9564.03 10399.8,-9554.06"/>
<polygon fill="black" stroke="black" points="10402.48,-9551.8 10393.49,-9546.19 10397.02,-9556.18 10402.48,-9551.8"/>
</g>
<!-- layer1_k_proj_2_0 -->
<g id="node43" class="node">
<title>layer1_k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10650.29,-9545.96 10469.29,-9545.96 10469.29,-9462.96 10650.29,-9462.96 10650.29,-9545.96"/>
<text text-anchor="middle" x="10559.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10559.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="10559.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10559.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10559.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_0&#45;&gt;layer1_k_proj_2_0 -->
<g id="edge42" class="edge">
<title>layer1_ln1_2_0&#45;&gt;layer1_k_proj_2_0</title>
<path fill="none" stroke="black" d="M10497.09,-9584.36C10504.93,-9574.5 10513.25,-9564.03 10521.17,-9554.06"/>
<polygon fill="black" stroke="black" points="10523.94,-9556.2 10527.42,-9546.19 10518.46,-9551.85 10523.94,-9556.2"/>
</g>
<!-- layer1_v_proj_2_0 -->
<g id="node44" class="node">
<title>layer1_v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10849.29,-9545.96 10668.29,-9545.96 10668.29,-9462.96 10849.29,-9462.96 10849.29,-9545.96"/>
<text text-anchor="middle" x="10758.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10758.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="10758.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10758.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10758.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_0&#45;&gt;layer1_v_proj_2_0 -->
<g id="edge43" class="edge">
<title>layer1_ln1_2_0&#45;&gt;layer1_v_proj_2_0</title>
<path fill="none" stroke="black" d="M10548.59,-9593.34C10583.18,-9578.88 10623.1,-9562.19 10658.8,-9547.26"/>
<polygon fill="black" stroke="black" points="10660.39,-9550.39 10668.26,-9543.31 10657.69,-9543.94 10660.39,-9550.39"/>
</g>
<!-- layer1_q_proj_2_1 -->
<g id="node45" class="node">
<title>layer1_q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11066.29,-9545.96 10867.29,-9545.96 10867.29,-9462.96 11066.29,-9462.96 11066.29,-9545.96"/>
<text text-anchor="middle" x="10966.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10966.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="10966.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10966.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10966.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_1&#45;&gt;layer1_q_proj_2_1 -->
<g id="edge44" class="edge">
<title>layer1_ln1_2_1&#45;&gt;layer1_q_proj_2_1</title>
<path fill="none" stroke="black" d="M11035.5,-9584.71C11026.75,-9574.62 11017.44,-9563.89 11008.6,-9553.69"/>
<polygon fill="black" stroke="black" points="11011.14,-9551.27 11001.94,-9546.01 11005.85,-9555.86 11011.14,-9551.27"/>
</g>
<!-- layer1_k_proj_2_1 -->
<g id="node46" class="node">
<title>layer1_k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11283.29,-9545.96 11084.29,-9545.96 11084.29,-9462.96 11283.29,-9462.96 11283.29,-9545.96"/>
<text text-anchor="middle" x="11183.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11183.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="11183.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11183.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11183.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_1&#45;&gt;layer1_k_proj_2_1 -->
<g id="edge45" class="edge">
<title>layer1_ln1_2_1&#45;&gt;layer1_k_proj_2_1</title>
<path fill="none" stroke="black" d="M11114.45,-9584.71C11123.28,-9574.62 11132.67,-9563.89 11141.6,-9553.69"/>
<polygon fill="black" stroke="black" points="11144.36,-9555.84 11148.31,-9546.01 11139.1,-9551.23 11144.36,-9555.84"/>
</g>
<!-- layer1_v_proj_2_1 -->
<g id="node47" class="node">
<title>layer1_v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11500.29,-9545.96 11301.29,-9545.96 11301.29,-9462.96 11500.29,-9462.96 11500.29,-9545.96"/>
<text text-anchor="middle" x="11400.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11400.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="11400.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11400.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11400.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_1&#45;&gt;layer1_v_proj_2_1 -->
<g id="edge46" class="edge">
<title>layer1_ln1_2_1&#45;&gt;layer1_v_proj_2_1</title>
<path fill="none" stroke="black" d="M11167.34,-9594.68C11206.03,-9579.89 11251.27,-9562.6 11291.58,-9547.2"/>
<polygon fill="black" stroke="black" points="11293.08,-9550.37 11301.17,-9543.53 11290.58,-9543.83 11293.08,-9550.37"/>
</g>
<!-- layer1_q_proj_2_2 -->
<g id="node48" class="node">
<title>layer1_q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="11717.29,-9545.96 11518.29,-9545.96 11518.29,-9462.96 11717.29,-9462.96 11717.29,-9545.96"/>
<text text-anchor="middle" x="11617.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11617.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="11617.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11617.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="11617.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_2&#45;&gt;layer1_q_proj_2_2 -->
<g id="edge47" class="edge">
<title>layer1_ln1_2_2&#45;&gt;layer1_q_proj_2_2</title>
<path fill="none" stroke="black" d="M11671.38,-9584.01C11664.8,-9574.36 11657.83,-9564.15 11651.18,-9554.4"/>
<polygon fill="black" stroke="black" points="11653.96,-9552.26 11645.43,-9545.97 11648.18,-9556.2 11653.96,-9552.26"/>
</g>
<!-- layer1_k_proj_2_2 -->
<g id="node49" class="node">
<title>layer1_k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="11934.29,-9545.96 11735.29,-9545.96 11735.29,-9462.96 11934.29,-9462.96 11934.29,-9545.96"/>
<text text-anchor="middle" x="11834.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11834.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="11834.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11834.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="11834.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_2&#45;&gt;layer1_k_proj_2_2 -->
<g id="edge48" class="edge">
<title>layer1_ln1_2_2&#45;&gt;layer1_k_proj_2_2</title>
<path fill="none" stroke="black" d="M11750.07,-9585.42C11761.24,-9574.88 11773.18,-9563.61 11784.48,-9552.95"/>
<polygon fill="black" stroke="black" points="11786.92,-9555.45 11791.79,-9546.04 11782.12,-9550.36 11786.92,-9555.45"/>
</g>
<!-- layer1_v_proj_2_2 -->
<g id="node50" class="node">
<title>layer1_v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="12151.29,-9545.96 11952.29,-9545.96 11952.29,-9462.96 12151.29,-9462.96 12151.29,-9545.96"/>
<text text-anchor="middle" x="12051.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12051.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="12051.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12051.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12051.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_2&#45;&gt;layer1_v_proj_2_2 -->
<g id="edge49" class="edge">
<title>layer1_ln1_2_2&#45;&gt;layer1_v_proj_2_2</title>
<path fill="none" stroke="black" d="M11800.59,-9596.5C11841.89,-9582.19 11890.7,-9565.1 11942.4,-9546.45"/>
<polygon fill="black" stroke="black" points="11943.87,-9549.64 11952.08,-9542.95 11941.49,-9543.06 11943.87,-9549.64"/>
</g>
<!-- layer1_q_proj_2_3 -->
<g id="node51" class="node">
<title>layer1_q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="12368.29,-9545.96 12169.29,-9545.96 12169.29,-9462.96 12368.29,-9462.96 12368.29,-9545.96"/>
<text text-anchor="middle" x="12268.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12268.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="12268.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12268.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="12268.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_3&#45;&gt;layer1_q_proj_2_3 -->
<g id="edge50" class="edge">
<title>layer1_ln1_2_3&#45;&gt;layer1_q_proj_2_3</title>
<path fill="none" stroke="black" d="M12322.38,-9584.01C12315.8,-9574.36 12308.83,-9564.15 12302.18,-9554.4"/>
<polygon fill="black" stroke="black" points="12304.96,-9552.26 12296.43,-9545.97 12299.18,-9556.2 12304.96,-9552.26"/>
</g>
<!-- layer1_k_proj_2_3 -->
<g id="node52" class="node">
<title>layer1_k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="12585.29,-9545.96 12386.29,-9545.96 12386.29,-9462.96 12585.29,-9462.96 12585.29,-9545.96"/>
<text text-anchor="middle" x="12485.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12485.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="12485.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12485.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="12485.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_3&#45;&gt;layer1_k_proj_2_3 -->
<g id="edge51" class="edge">
<title>layer1_ln1_2_3&#45;&gt;layer1_k_proj_2_3</title>
<path fill="none" stroke="black" d="M12401.07,-9585.42C12412.24,-9574.88 12424.18,-9563.61 12435.48,-9552.95"/>
<polygon fill="black" stroke="black" points="12437.92,-9555.45 12442.79,-9546.04 12433.12,-9550.36 12437.92,-9555.45"/>
</g>
<!-- layer1_v_proj_2_3 -->
<g id="node53" class="node">
<title>layer1_v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="12802.29,-9545.96 12603.29,-9545.96 12603.29,-9462.96 12802.29,-9462.96 12802.29,-9545.96"/>
<text text-anchor="middle" x="12702.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12702.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="12702.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12702.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="12702.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_2_3&#45;&gt;layer1_v_proj_2_3 -->
<g id="edge52" class="edge">
<title>layer1_ln1_2_3&#45;&gt;layer1_v_proj_2_3</title>
<path fill="none" stroke="black" d="M12451.59,-9596.5C12492.89,-9582.19 12541.7,-9565.1 12593.4,-9546.45"/>
<polygon fill="black" stroke="black" points="12594.87,-9549.64 12603.08,-9542.95 12592.49,-9543.06 12594.87,-9549.64"/>
</g>
<!-- layer1_q_proj_3_0 -->
<g id="node54" class="node">
<title>layer1_q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13010.79,-9545.96 12820.79,-9545.96 12820.79,-9462.96 13010.79,-9462.96 13010.79,-9545.96"/>
<text text-anchor="middle" x="12915.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12915.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="12915.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12915.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12915.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_0&#45;&gt;layer1_q_proj_3_0 -->
<g id="edge53" class="edge">
<title>layer1_ln1_3_0&#45;&gt;layer1_q_proj_3_0</title>
<path fill="none" stroke="black" d="M12967.49,-9584.01C12961.14,-9574.36 12954.42,-9564.15 12948,-9554.4"/>
<polygon fill="black" stroke="black" points="12950.88,-9552.4 12942.46,-9545.97 12945.03,-9556.25 12950.88,-9552.4"/>
</g>
<!-- layer1_k_proj_3_0 -->
<g id="node55" class="node">
<title>layer1_k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13218.79,-9545.96 13028.79,-9545.96 13028.79,-9462.96 13218.79,-9462.96 13218.79,-9545.96"/>
<text text-anchor="middle" x="13123.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13123.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="13123.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13123.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="13123.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_0&#45;&gt;layer1_k_proj_3_0 -->
<g id="edge54" class="edge">
<title>layer1_ln1_3_0&#45;&gt;layer1_k_proj_3_0</title>
<path fill="none" stroke="black" d="M13042.92,-9585.42C13053.48,-9574.98 13064.77,-9563.82 13075.46,-9553.25"/>
<polygon fill="black" stroke="black" points="13078.1,-9555.56 13082.75,-9546.04 13073.17,-9550.59 13078.1,-9555.56"/>
</g>
<!-- layer1_v_proj_3_0 -->
<g id="node56" class="node">
<title>layer1_v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13426.79,-9545.96 13236.79,-9545.96 13236.79,-9462.96 13426.79,-9462.96 13426.79,-9545.96"/>
<text text-anchor="middle" x="13331.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13331.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="13331.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13331.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="13331.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_0&#45;&gt;layer1_v_proj_3_0 -->
<g id="edge55" class="edge">
<title>layer1_ln1_3_0&#45;&gt;layer1_v_proj_3_0</title>
<path fill="none" stroke="black" d="M13093.07,-9595.71C13132.02,-9581.56 13177.72,-9564.8 13227.03,-9546.23"/>
<polygon fill="black" stroke="black" points="13228.49,-9549.42 13236.61,-9542.62 13226.02,-9542.87 13228.49,-9549.42"/>
</g>
<!-- layer1_q_proj_3_1 -->
<g id="node57" class="node">
<title>layer1_q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13652.79,-9545.96 13444.79,-9545.96 13444.79,-9462.96 13652.79,-9462.96 13652.79,-9545.96"/>
<text text-anchor="middle" x="13548.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13548.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="13548.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13548.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13548.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_1&#45;&gt;layer1_q_proj_3_1 -->
<g id="edge56" class="edge">
<title>layer1_ln1_3_1&#45;&gt;layer1_q_proj_3_1</title>
<path fill="none" stroke="black" d="M13621.63,-9585.07C13612.29,-9574.86 13602.34,-9563.98 13592.88,-9553.64"/>
<polygon fill="black" stroke="black" points="13595.43,-9551.25 13586.1,-9546.23 13590.27,-9555.97 13595.43,-9551.25"/>
</g>
<!-- layer1_k_proj_3_1 -->
<g id="node58" class="node">
<title>layer1_k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13878.79,-9545.96 13670.79,-9545.96 13670.79,-9462.96 13878.79,-9462.96 13878.79,-9545.96"/>
<text text-anchor="middle" x="13774.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13774.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="13774.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13774.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13774.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_1&#45;&gt;layer1_k_proj_3_1 -->
<g id="edge57" class="edge">
<title>layer1_ln1_3_1&#45;&gt;layer1_k_proj_3_1</title>
<path fill="none" stroke="black" d="M13703.54,-9584.71C13712.61,-9574.62 13722.26,-9563.89 13731.43,-9553.69"/>
<polygon fill="black" stroke="black" points="13734.25,-9555.79 13738.34,-9546.01 13729.05,-9551.11 13734.25,-9555.79"/>
</g>
<!-- layer1_v_proj_3_1 -->
<g id="node59" class="node">
<title>layer1_v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="14104.79,-9545.96 13896.79,-9545.96 13896.79,-9462.96 14104.79,-9462.96 14104.79,-9545.96"/>
<text text-anchor="middle" x="14000.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14000.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="14000.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14000.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="14000.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_1&#45;&gt;layer1_v_proj_3_1 -->
<g id="edge58" class="edge">
<title>layer1_ln1_3_1&#45;&gt;layer1_v_proj_3_1</title>
<path fill="none" stroke="black" d="M13756.94,-9595.34C13797.35,-9580.45 13844.91,-9562.92 13887.25,-9547.31"/>
<polygon fill="black" stroke="black" points="13888.58,-9550.55 13896.76,-9543.81 13886.16,-9543.98 13888.58,-9550.55"/>
</g>
<!-- layer1_q_proj_3_2 -->
<g id="node60" class="node">
<title>layer1_q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="14330.79,-9545.96 14122.79,-9545.96 14122.79,-9462.96 14330.79,-9462.96 14330.79,-9545.96"/>
<text text-anchor="middle" x="14226.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14226.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="14226.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14226.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="14226.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_2&#45;&gt;layer1_q_proj_3_2 -->
<g id="edge59" class="edge">
<title>layer1_ln1_3_2&#45;&gt;layer1_q_proj_3_2</title>
<path fill="none" stroke="black" d="M14299.63,-9585.07C14290.29,-9574.86 14280.34,-9563.98 14270.88,-9553.64"/>
<polygon fill="black" stroke="black" points="14273.43,-9551.25 14264.1,-9546.23 14268.27,-9555.97 14273.43,-9551.25"/>
</g>
<!-- layer1_k_proj_3_2 -->
<g id="node61" class="node">
<title>layer1_k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="14556.79,-9545.96 14348.79,-9545.96 14348.79,-9462.96 14556.79,-9462.96 14556.79,-9545.96"/>
<text text-anchor="middle" x="14452.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="14452.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="14452.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14452.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="14452.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_2&#45;&gt;layer1_k_proj_3_2 -->
<g id="edge60" class="edge">
<title>layer1_ln1_3_2&#45;&gt;layer1_k_proj_3_2</title>
<path fill="none" stroke="black" d="M14381.54,-9584.71C14390.61,-9574.62 14400.26,-9563.89 14409.43,-9553.69"/>
<polygon fill="black" stroke="black" points="14412.25,-9555.79 14416.34,-9546.01 14407.05,-9551.11 14412.25,-9555.79"/>
</g>
<!-- layer1_v_proj_3_2 -->
<g id="node62" class="node">
<title>layer1_v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="14782.79,-9545.96 14574.79,-9545.96 14574.79,-9462.96 14782.79,-9462.96 14782.79,-9545.96"/>
<text text-anchor="middle" x="14678.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14678.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="14678.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14678.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="14678.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_2&#45;&gt;layer1_v_proj_3_2 -->
<g id="edge61" class="edge">
<title>layer1_ln1_3_2&#45;&gt;layer1_v_proj_3_2</title>
<path fill="none" stroke="black" d="M14434.94,-9595.34C14475.35,-9580.45 14522.91,-9562.92 14565.25,-9547.31"/>
<polygon fill="black" stroke="black" points="14566.58,-9550.55 14574.76,-9543.81 14564.16,-9543.98 14566.58,-9550.55"/>
</g>
<!-- layer1_q_proj_3_3 -->
<g id="node63" class="node">
<title>layer1_q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="15008.79,-9545.96 14800.79,-9545.96 14800.79,-9462.96 15008.79,-9462.96 15008.79,-9545.96"/>
<text text-anchor="middle" x="14904.79" y="-9530.76" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14904.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="14904.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14904.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14904.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_3&#45;&gt;layer1_q_proj_3_3 -->
<g id="edge62" class="edge">
<title>layer1_ln1_3_3&#45;&gt;layer1_q_proj_3_3</title>
<path fill="none" stroke="black" d="M14943.53,-9583.3C14938.99,-9574.18 14934.22,-9564.6 14929.64,-9555.38"/>
<polygon fill="black" stroke="black" points="14932.72,-9553.72 14925.13,-9546.33 14926.45,-9556.84 14932.72,-9553.72"/>
</g>
<!-- layer1_k_proj_3_3 -->
<g id="node64" class="node">
<title>layer1_k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="15234.79,-9545.96 15026.79,-9545.96 15026.79,-9462.96 15234.79,-9462.96 15234.79,-9545.96"/>
<text text-anchor="middle" x="15130.79" y="-9530.76" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="15130.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="15130.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="15130.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="15130.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_3&#45;&gt;layer1_k_proj_3_3 -->
<g id="edge63" class="edge">
<title>layer1_ln1_3_3&#45;&gt;layer1_k_proj_3_3</title>
<path fill="none" stroke="black" d="M15023.69,-9586.82C15038.37,-9575.67 15054.23,-9563.62 15069.13,-9552.3"/>
<polygon fill="black" stroke="black" points="15071.46,-9554.93 15077.3,-9546.09 15067.22,-9549.36 15071.46,-9554.93"/>
</g>
<!-- layer1_v_proj_3_3 -->
<g id="node65" class="node">
<title>layer1_v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="15460.79,-9545.96 15252.79,-9545.96 15252.79,-9462.96 15460.79,-9462.96 15460.79,-9545.96"/>
<text text-anchor="middle" x="15356.79" y="-9530.76" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="15356.79" y="-9515.76" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="15356.79" y="-9500.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="15356.79" y="-9485.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="15356.79" y="-9470.76" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_ln1_3_3&#45;&gt;layer1_v_proj_3_3 -->
<g id="edge64" class="edge">
<title>layer1_ln1_3_3&#45;&gt;layer1_v_proj_3_3</title>
<path fill="none" stroke="black" d="M15072.41,-9599.32C15121.71,-9584.66 15181.34,-9566.46 15242.99,-9546.19"/>
<polygon fill="black" stroke="black" points="15244.1,-9549.51 15252.5,-9543.05 15241.9,-9542.86 15244.1,-9549.51"/>
</g>
<!-- layer1_attention_0_0 -->
<g id="node66" class="node">
<title>layer1_attention_0_0</title>
<polygon fill="lightcoral" stroke="black" points="5809.79,-9425.96 5583.79,-9342.96 5809.79,-9259.96 6035.79,-9342.96 5809.79,-9425.96"/>
<text text-anchor="middle" x="5809.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5809.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="5809.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5809.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5809.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_q_proj_0_0&#45;&gt;layer1_attention_0_0 -->
<g id="edge65" class="edge">
<title>layer1_q_proj_0_0&#45;&gt;layer1_attention_0_0</title>
<path fill="none" stroke="black" d="M5551.4,-9463.42C5596.97,-9442.35 5653.27,-9416.32 5701.68,-9393.94"/>
<polygon fill="black" stroke="black" points="5703.32,-9397.04 5710.93,-9389.67 5700.39,-9390.68 5703.32,-9397.04"/>
</g>
<!-- layer1_k_proj_0_0&#45;&gt;layer1_attention_0_0 -->
<g id="edge66" class="edge">
<title>layer1_k_proj_0_0&#45;&gt;layer1_attention_0_0</title>
<path fill="none" stroke="black" d="M5695.05,-9462.8C5709.94,-9447.37 5727.34,-9429.36 5744.02,-9412.08"/>
<polygon fill="black" stroke="black" points="5746.68,-9414.36 5751.11,-9404.74 5741.65,-9409.5 5746.68,-9414.36"/>
</g>
<!-- layer1_v_proj_0_0&#45;&gt;layer1_attention_0_0 -->
<g id="edge67" class="edge">
<title>layer1_v_proj_0_0&#45;&gt;layer1_attention_0_0</title>
<path fill="none" stroke="black" d="M5837.36,-9462.8C5834.97,-9452.49 5832.31,-9441.02 5829.61,-9429.39"/>
<polygon fill="black" stroke="black" points="5833.01,-9428.55 5827.34,-9419.6 5826.19,-9430.13 5833.01,-9428.55"/>
</g>
<!-- layer1_attention_0_1 -->
<g id="node67" class="node">
<title>layer1_attention_0_1</title>
<polygon fill="lightcoral" stroke="black" points="6311.79,-9425.96 6085.79,-9342.96 6311.79,-9259.96 6537.79,-9342.96 6311.79,-9425.96"/>
<text text-anchor="middle" x="6311.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6311.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="6311.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6311.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6311.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_q_proj_0_1&#45;&gt;layer1_attention_0_1 -->
<g id="edge68" class="edge">
<title>layer1_q_proj_0_1&#45;&gt;layer1_attention_0_1</title>
<path fill="none" stroke="black" d="M6114.35,-9462.8C6145.87,-9443.82 6183.91,-9420.93 6218.15,-9400.32"/>
<polygon fill="black" stroke="black" points="6220.01,-9403.29 6226.77,-9395.13 6216.4,-9397.29 6220.01,-9403.29"/>
</g>
<!-- layer1_k_proj_0_1&#45;&gt;layer1_attention_0_1 -->
<g id="edge69" class="edge">
<title>layer1_k_proj_0_1&#45;&gt;layer1_attention_0_1</title>
<path fill="none" stroke="black" d="M6269.32,-9462.8C6273.34,-9451.55 6277.86,-9438.91 6282.4,-9426.2"/>
<polygon fill="black" stroke="black" points="6285.81,-9427.07 6285.88,-9416.48 6279.22,-9424.72 6285.81,-9427.07"/>
</g>
<!-- layer1_v_proj_0_1&#45;&gt;layer1_attention_0_1 -->
<g id="edge70" class="edge">
<title>layer1_v_proj_0_1&#45;&gt;layer1_attention_0_1</title>
<path fill="none" stroke="black" d="M6424.3,-9462.8C6409.77,-9447.45 6392.82,-9429.55 6376.54,-9412.35"/>
<polygon fill="black" stroke="black" points="6379.03,-9409.9 6369.62,-9405.04 6373.95,-9414.71 6379.03,-9409.9"/>
</g>
<!-- layer1_attention_0_2 -->
<g id="node68" class="node">
<title>layer1_attention_0_2</title>
<polygon fill="lightcoral" stroke="black" points="6878.79,-9425.96 6652.79,-9342.96 6878.79,-9259.96 7104.79,-9342.96 6878.79,-9425.96"/>
<text text-anchor="middle" x="6878.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6878.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="6878.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6878.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6878.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_q_proj_0_2&#45;&gt;layer1_attention_0_2 -->
<g id="edge71" class="edge">
<title>layer1_q_proj_0_2&#45;&gt;layer1_attention_0_2</title>
<path fill="none" stroke="black" d="M6723.82,-9462.8C6746.41,-9445.48 6773.26,-9424.88 6798.22,-9405.75"/>
<polygon fill="black" stroke="black" points="6800.44,-9408.45 6806.24,-9399.59 6796.18,-9402.9 6800.44,-9408.45"/>
</g>
<!-- layer1_k_proj_0_2&#45;&gt;layer1_attention_0_2 -->
<g id="edge72" class="edge">
<title>layer1_k_proj_0_2&#45;&gt;layer1_attention_0_2</title>
<path fill="none" stroke="black" d="M6878.79,-9462.8C6878.79,-9454.53 6878.79,-9445.52 6878.79,-9436.27"/>
<polygon fill="black" stroke="black" points="6882.29,-9436.17 6878.79,-9426.17 6875.29,-9436.17 6882.29,-9436.17"/>
</g>
<!-- layer1_v_proj_0_2&#45;&gt;layer1_attention_0_2 -->
<g id="edge73" class="edge">
<title>layer1_v_proj_0_2&#45;&gt;layer1_attention_0_2</title>
<path fill="none" stroke="black" d="M7033.77,-9462.8C7011.18,-9445.48 6984.32,-9424.88 6959.37,-9405.75"/>
<polygon fill="black" stroke="black" points="6961.4,-9402.9 6951.34,-9399.59 6957.14,-9408.45 6961.4,-9402.9"/>
</g>
<!-- layer1_attention_0_3 -->
<g id="node69" class="node">
<title>layer1_attention_0_3</title>
<polygon fill="lightcoral" stroke="black" points="7425.79,-9425.96 7199.79,-9342.96 7425.79,-9259.96 7651.79,-9342.96 7425.79,-9425.96"/>
<text text-anchor="middle" x="7425.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7425.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="7425.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7425.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7425.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_q_proj_0_3&#45;&gt;layer1_attention_0_3 -->
<g id="edge74" class="edge">
<title>layer1_q_proj_0_3&#45;&gt;layer1_attention_0_3</title>
<path fill="none" stroke="black" d="M7328.19,-9462.8C7340.11,-9448.28 7353.92,-9431.47 7367.32,-9415.15"/>
<polygon fill="black" stroke="black" points="7370.22,-9417.13 7373.86,-9407.18 7364.81,-9412.69 7370.22,-9417.13"/>
</g>
<!-- layer1_k_proj_0_3&#45;&gt;layer1_attention_0_3 -->
<g id="edge75" class="edge">
<title>layer1_k_proj_0_3&#45;&gt;layer1_attention_0_3</title>
<path fill="none" stroke="black" d="M7483.16,-9462.8C7477.24,-9450.53 7470.53,-9436.63 7463.83,-9422.76"/>
<polygon fill="black" stroke="black" points="7466.95,-9421.16 7459.45,-9413.67 7460.64,-9424.2 7466.95,-9421.16"/>
</g>
<!-- layer1_v_proj_0_3&#45;&gt;layer1_attention_0_3 -->
<g id="edge76" class="edge">
<title>layer1_v_proj_0_3&#45;&gt;layer1_attention_0_3</title>
<path fill="none" stroke="black" d="M7638.14,-9462.8C7603.25,-9443.27 7560.94,-9419.6 7523.3,-9398.53"/>
<polygon fill="black" stroke="black" points="7524.78,-9395.35 7514.34,-9393.52 7521.36,-9401.46 7524.78,-9395.35"/>
</g>
<!-- layer1_attention_1_0 -->
<g id="node70" class="node">
<title>layer1_attention_1_0</title>
<polygon fill="lightcoral" stroke="black" points="8204.79,-9425.96 7978.79,-9342.96 8204.79,-9259.96 8430.79,-9342.96 8204.79,-9425.96"/>
<text text-anchor="middle" x="8204.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8204.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="8204.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8204.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8204.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_q_proj_1_0&#45;&gt;layer1_attention_1_0 -->
<g id="edge77" class="edge">
<title>layer1_q_proj_1_0&#45;&gt;layer1_attention_1_0</title>
<path fill="none" stroke="black" d="M7985.74,-9462.8C8022.2,-9443.02 8066.51,-9418.98 8105.72,-9397.71"/>
<polygon fill="black" stroke="black" points="8107.4,-9400.78 8114.52,-9392.94 8104.06,-9394.63 8107.4,-9400.78"/>
</g>
<!-- layer1_k_proj_1_0&#45;&gt;layer1_attention_1_0 -->
<g id="edge78" class="edge">
<title>layer1_k_proj_1_0&#45;&gt;layer1_attention_1_0</title>
<path fill="none" stroke="black" d="M8128.05,-9462.8C8136.75,-9449.33 8146.73,-9433.88 8156.54,-9418.67"/>
<polygon fill="black" stroke="black" points="8159.49,-9420.56 8161.97,-9410.26 8153.61,-9416.77 8159.49,-9420.56"/>
</g>
<!-- layer1_v_proj_1_0&#45;&gt;layer1_attention_1_0 -->
<g id="edge79" class="edge">
<title>layer1_v_proj_1_0&#45;&gt;layer1_attention_1_0</title>
<path fill="none" stroke="black" d="M8270.36,-9462.8C8263.36,-9450.11 8255.39,-9435.67 8247.48,-9421.33"/>
<polygon fill="black" stroke="black" points="8250.46,-9419.5 8242.57,-9412.43 8244.34,-9422.88 8250.46,-9419.5"/>
</g>
<!-- layer1_attention_1_1 -->
<g id="node71" class="node">
<title>layer1_attention_1_1</title>
<polygon fill="lightcoral" stroke="black" points="8738.79,-9425.96 8512.79,-9342.96 8738.79,-9259.96 8964.79,-9342.96 8738.79,-9425.96"/>
<text text-anchor="middle" x="8738.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8738.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="8738.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8738.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8738.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_q_proj_1_1&#45;&gt;layer1_attention_1_1 -->
<g id="edge80" class="edge">
<title>layer1_q_proj_1_1&#45;&gt;layer1_attention_1_1</title>
<path fill="none" stroke="black" d="M8555.5,-9462.8C8584,-9444.32 8618.23,-9422.13 8649.36,-9401.95"/>
<polygon fill="black" stroke="black" points="8651.56,-9404.69 8658.05,-9396.31 8647.75,-9398.82 8651.56,-9404.69"/>
</g>
<!-- layer1_k_proj_1_1&#45;&gt;layer1_attention_1_1 -->
<g id="edge81" class="edge">
<title>layer1_k_proj_1_1&#45;&gt;layer1_attention_1_1</title>
<path fill="none" stroke="black" d="M8710.48,-9462.8C8712.94,-9452.49 8715.67,-9441.02 8718.44,-9429.39"/>
<polygon fill="black" stroke="black" points="8721.86,-9430.14 8720.77,-9419.6 8715.05,-9428.52 8721.86,-9430.14"/>
</g>
<!-- layer1_v_proj_1_1&#45;&gt;layer1_attention_1_1 -->
<g id="edge82" class="edge">
<title>layer1_v_proj_1_1&#45;&gt;layer1_attention_1_1</title>
<path fill="none" stroke="black" d="M8865.45,-9462.8C8848.34,-9446.75 8828.24,-9427.89 8809.16,-9409.98"/>
<polygon fill="black" stroke="black" points="8811.31,-9407.2 8801.62,-9402.91 8806.52,-9412.31 8811.31,-9407.2"/>
</g>
<!-- layer1_attention_1_2 -->
<g id="node72" class="node">
<title>layer1_attention_1_2</title>
<polygon fill="lightcoral" stroke="black" points="9324.79,-9425.96 9098.79,-9342.96 9324.79,-9259.96 9550.79,-9342.96 9324.79,-9425.96"/>
<text text-anchor="middle" x="9324.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9324.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="9324.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9324.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9324.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_q_proj_1_2&#45;&gt;layer1_attention_1_2 -->
<g id="edge83" class="edge">
<title>layer1_q_proj_1_2&#45;&gt;layer1_attention_1_2</title>
<path fill="none" stroke="black" d="M9169.82,-9462.8C9192.41,-9445.48 9219.26,-9424.88 9244.22,-9405.75"/>
<polygon fill="black" stroke="black" points="9246.44,-9408.45 9252.24,-9399.59 9242.18,-9402.9 9246.44,-9408.45"/>
</g>
<!-- layer1_k_proj_1_2&#45;&gt;layer1_attention_1_2 -->
<g id="edge84" class="edge">
<title>layer1_k_proj_1_2&#45;&gt;layer1_attention_1_2</title>
<path fill="none" stroke="black" d="M9324.79,-9462.8C9324.79,-9454.53 9324.79,-9445.52 9324.79,-9436.27"/>
<polygon fill="black" stroke="black" points="9328.29,-9436.17 9324.79,-9426.17 9321.29,-9436.17 9328.29,-9436.17"/>
</g>
<!-- layer1_v_proj_1_2&#45;&gt;layer1_attention_1_2 -->
<g id="edge85" class="edge">
<title>layer1_v_proj_1_2&#45;&gt;layer1_attention_1_2</title>
<path fill="none" stroke="black" d="M9479.77,-9462.8C9457.18,-9445.48 9430.32,-9424.88 9405.37,-9405.75"/>
<polygon fill="black" stroke="black" points="9407.4,-9402.9 9397.34,-9399.59 9403.14,-9408.45 9407.4,-9402.9"/>
</g>
<!-- layer1_attention_1_3 -->
<g id="node73" class="node">
<title>layer1_attention_1_3</title>
<polygon fill="lightcoral" stroke="black" points="9832.79,-9425.96 9606.79,-9342.96 9832.79,-9259.96 10058.79,-9342.96 9832.79,-9425.96"/>
<text text-anchor="middle" x="9832.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9832.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="9832.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9832.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9832.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_q_proj_1_3&#45;&gt;layer1_attention_1_3 -->
<g id="edge86" class="edge">
<title>layer1_q_proj_1_3&#45;&gt;layer1_attention_1_3</title>
<path fill="none" stroke="black" d="M9764.24,-9462.8C9771.65,-9449.96 9780.09,-9435.32 9788.46,-9420.81"/>
<polygon fill="black" stroke="black" points="9791.69,-9422.22 9793.65,-9411.81 9785.63,-9418.73 9791.69,-9422.22"/>
</g>
<!-- layer1_k_proj_1_3&#45;&gt;layer1_attention_1_3 -->
<g id="edge87" class="edge">
<title>layer1_k_proj_1_3&#45;&gt;layer1_attention_1_3</title>
<path fill="none" stroke="black" d="M9919.22,-9462.8C9909.04,-9448.81 9897.32,-9432.69 9885.85,-9416.92"/>
<polygon fill="black" stroke="black" points="9888.6,-9414.75 9879.89,-9408.72 9882.94,-9418.87 9888.6,-9414.75"/>
</g>
<!-- layer1_v_proj_1_3&#45;&gt;layer1_attention_1_3 -->
<g id="edge88" class="edge">
<title>layer1_v_proj_1_3&#45;&gt;layer1_attention_1_3</title>
<path fill="none" stroke="black" d="M10074.19,-9462.8C10032.62,-9442.33 9981.79,-9417.31 9937.5,-9395.51"/>
<polygon fill="black" stroke="black" points="9938.97,-9392.33 9928.45,-9391.05 9935.88,-9398.61 9938.97,-9392.33"/>
</g>
<!-- layer1_attention_2_0 -->
<g id="node74" class="node">
<title>layer1_attention_2_0</title>
<polygon fill="lightcoral" stroke="black" points="10636.79,-9425.96 10410.79,-9342.96 10636.79,-9259.96 10862.79,-9342.96 10636.79,-9425.96"/>
<text text-anchor="middle" x="10636.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10636.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="10636.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10636.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10636.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_q_proj_2_0&#45;&gt;layer1_attention_2_0 -->
<g id="edge89" class="edge">
<title>layer1_q_proj_2_0&#45;&gt;layer1_attention_2_0</title>
<path fill="none" stroke="black" d="M10431.15,-9462.8C10464.5,-9443.53 10504.85,-9420.21 10540.94,-9399.35"/>
<polygon fill="black" stroke="black" points="10543.11,-9402.14 10550.02,-9394.1 10539.61,-9396.08 10543.11,-9402.14"/>
</g>
<!-- layer1_k_proj_2_0&#45;&gt;layer1_attention_2_0 -->
<g id="edge90" class="edge">
<title>layer1_k_proj_2_0&#45;&gt;layer1_attention_2_0</title>
<path fill="none" stroke="black" d="M10579.42,-9462.8C10585.34,-9450.53 10592.05,-9436.63 10598.75,-9422.76"/>
<polygon fill="black" stroke="black" points="10601.94,-9424.2 10603.14,-9413.67 10595.64,-9421.16 10601.94,-9424.2"/>
</g>
<!-- layer1_v_proj_2_0&#45;&gt;layer1_attention_2_0 -->
<g id="edge91" class="edge">
<title>layer1_v_proj_2_0&#45;&gt;layer1_attention_2_0</title>
<path fill="none" stroke="black" d="M10727.69,-9462.8C10716.87,-9448.65 10704.38,-9432.32 10692.19,-9416.39"/>
<polygon fill="black" stroke="black" points="10694.71,-9413.92 10685.86,-9408.11 10689.15,-9418.18 10694.71,-9413.92"/>
</g>
<!-- layer1_attention_2_1 -->
<g id="node75" class="node">
<title>layer1_attention_2_1</title>
<polygon fill="lightcoral" stroke="black" points="11183.79,-9425.96 10957.79,-9342.96 11183.79,-9259.96 11409.79,-9342.96 11183.79,-9425.96"/>
<text text-anchor="middle" x="11183.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11183.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="11183.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11183.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11183.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_q_proj_2_1&#45;&gt;layer1_attention_2_1 -->
<g id="edge92" class="edge">
<title>layer1_q_proj_2_1&#45;&gt;layer1_attention_2_1</title>
<path fill="none" stroke="black" d="M11022.11,-9462.8C11046.12,-9445.15 11074.75,-9424.11 11101.2,-9404.67"/>
<polygon fill="black" stroke="black" points="11103.34,-9407.44 11109.33,-9398.69 11099.2,-9401.8 11103.34,-9407.44"/>
</g>
<!-- layer1_k_proj_2_1&#45;&gt;layer1_attention_2_1 -->
<g id="edge93" class="edge">
<title>layer1_k_proj_2_1&#45;&gt;layer1_attention_2_1</title>
<path fill="none" stroke="black" d="M11183.79,-9462.8C11183.79,-9454.53 11183.79,-9445.52 11183.79,-9436.27"/>
<polygon fill="black" stroke="black" points="11187.29,-9436.17 11183.79,-9426.17 11180.29,-9436.17 11187.29,-9436.17"/>
</g>
<!-- layer1_v_proj_2_1&#45;&gt;layer1_attention_2_1 -->
<g id="edge94" class="edge">
<title>layer1_v_proj_2_1&#45;&gt;layer1_attention_2_1</title>
<path fill="none" stroke="black" d="M11345.47,-9462.8C11321.46,-9445.15 11292.83,-9424.11 11266.39,-9404.67"/>
<polygon fill="black" stroke="black" points="11268.39,-9401.8 11258.26,-9398.69 11264.24,-9407.44 11268.39,-9401.8"/>
</g>
<!-- layer1_attention_2_2 -->
<g id="node76" class="node">
<title>layer1_attention_2_2</title>
<polygon fill="lightcoral" stroke="black" points="11706.79,-9425.96 11480.79,-9342.96 11706.79,-9259.96 11932.79,-9342.96 11706.79,-9425.96"/>
<text text-anchor="middle" x="11706.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11706.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="11706.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11706.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11706.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_q_proj_2_2&#45;&gt;layer1_attention_2_2 -->
<g id="edge95" class="edge">
<title>layer1_q_proj_2_2&#45;&gt;layer1_attention_2_2</title>
<path fill="none" stroke="black" d="M11640.48,-9462.8C11647.6,-9450.03 11655.72,-9435.5 11663.76,-9421.07"/>
<polygon fill="black" stroke="black" points="11666.94,-9422.56 11668.76,-9412.12 11660.83,-9419.15 11666.94,-9422.56"/>
</g>
<!-- layer1_k_proj_2_2&#45;&gt;layer1_attention_2_2 -->
<g id="edge96" class="edge">
<title>layer1_k_proj_2_2&#45;&gt;layer1_attention_2_2</title>
<path fill="none" stroke="black" d="M11802.16,-9462.8C11790.58,-9448.36 11777.17,-9431.66 11764.13,-9415.42"/>
<polygon fill="black" stroke="black" points="11766.76,-9413.1 11757.78,-9407.49 11761.3,-9417.48 11766.76,-9413.1"/>
</g>
<!-- layer1_v_proj_2_2&#45;&gt;layer1_attention_2_2 -->
<g id="edge97" class="edge">
<title>layer1_v_proj_2_2&#45;&gt;layer1_attention_2_2</title>
<path fill="none" stroke="black" d="M11963.84,-9462.8C11918.55,-9441.86 11862.92,-9416.14 11815.01,-9393.99"/>
<polygon fill="black" stroke="black" points="11816.4,-9390.78 11805.85,-9389.76 11813.46,-9397.13 11816.4,-9390.78"/>
</g>
<!-- layer1_attention_2_3 -->
<g id="node77" class="node">
<title>layer1_attention_2_3</title>
<polygon fill="lightcoral" stroke="black" points="12353.79,-9425.96 12127.79,-9342.96 12353.79,-9259.96 12579.79,-9342.96 12353.79,-9425.96"/>
<text text-anchor="middle" x="12353.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12353.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="12353.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12353.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12353.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_q_proj_2_3&#45;&gt;layer1_attention_2_3 -->
<g id="edge98" class="edge">
<title>layer1_q_proj_2_3&#45;&gt;layer1_attention_2_3</title>
<path fill="none" stroke="black" d="M12290.46,-9462.8C12297.18,-9450.19 12304.83,-9435.84 12312.42,-9421.59"/>
<polygon fill="black" stroke="black" points="12315.52,-9423.21 12317.14,-9412.74 12309.34,-9419.92 12315.52,-9423.21"/>
</g>
<!-- layer1_k_proj_2_3&#45;&gt;layer1_attention_2_3 -->
<g id="edge99" class="edge">
<title>layer1_k_proj_2_3&#45;&gt;layer1_attention_2_3</title>
<path fill="none" stroke="black" d="M12452.14,-9462.8C12440.06,-9448.2 12426.06,-9431.29 12412.48,-9414.88"/>
<polygon fill="black" stroke="black" points="12414.93,-9412.35 12405.86,-9406.88 12409.54,-9416.81 12414.93,-9412.35"/>
</g>
<!-- layer1_v_proj_2_3&#45;&gt;layer1_attention_2_3 -->
<g id="edge100" class="edge">
<title>layer1_v_proj_2_3&#45;&gt;layer1_attention_2_3</title>
<path fill="none" stroke="black" d="M12613.82,-9462.8C12567.81,-9441.77 12511.27,-9415.93 12462.67,-9393.72"/>
<polygon fill="black" stroke="black" points="12463.92,-9390.45 12453.37,-9389.47 12461.02,-9396.81 12463.92,-9390.45"/>
</g>
<!-- layer1_attention_3_0 -->
<g id="node78" class="node">
<title>layer1_attention_3_0</title>
<polygon fill="lightcoral" stroke="black" points="13226.79,-9425.96 13000.79,-9342.96 13226.79,-9259.96 13452.79,-9342.96 13226.79,-9425.96"/>
<text text-anchor="middle" x="13226.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13226.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="13226.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="13226.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="13226.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_q_proj_3_0&#45;&gt;layer1_attention_3_0 -->
<g id="edge101" class="edge">
<title>layer1_q_proj_3_0&#45;&gt;layer1_attention_3_0</title>
<path fill="none" stroke="black" d="M12995.07,-9462.8C13034.39,-9442.63 13082.34,-9418.04 13124.4,-9396.47"/>
<polygon fill="black" stroke="black" points="13126.26,-9399.45 13133.56,-9391.77 13123.07,-9393.22 13126.26,-9399.45"/>
</g>
<!-- layer1_k_proj_3_0&#45;&gt;layer1_attention_3_0 -->
<g id="edge102" class="edge">
<title>layer1_k_proj_3_0&#45;&gt;layer1_attention_3_0</title>
<path fill="none" stroke="black" d="M13150.05,-9462.8C13158.75,-9449.33 13168.73,-9433.88 13178.54,-9418.67"/>
<polygon fill="black" stroke="black" points="13181.49,-9420.56 13183.97,-9410.26 13175.61,-9416.77 13181.49,-9420.56"/>
</g>
<!-- layer1_v_proj_3_0&#45;&gt;layer1_attention_3_0 -->
<g id="edge103" class="edge">
<title>layer1_v_proj_3_0&#45;&gt;layer1_attention_3_0</title>
<path fill="none" stroke="black" d="M13305.02,-9462.8C13296.15,-9449.33 13285.98,-9433.88 13275.97,-9418.67"/>
<polygon fill="black" stroke="black" points="13278.86,-9416.69 13270.44,-9410.26 13273.02,-9420.54 13278.86,-9416.69"/>
</g>
<!-- layer1_attention_3_1 -->
<g id="node79" class="node">
<title>layer1_attention_3_1</title>
<polygon fill="lightcoral" stroke="black" points="13774.79,-9425.96 13548.79,-9342.96 13774.79,-9259.96 14000.79,-9342.96 13774.79,-9425.96"/>
<text text-anchor="middle" x="13774.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13774.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="13774.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="13774.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="13774.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_q_proj_3_1&#45;&gt;layer1_attention_3_1 -->
<g id="edge104" class="edge">
<title>layer1_q_proj_3_1&#45;&gt;layer1_attention_3_1</title>
<path fill="none" stroke="black" d="M13606.41,-9462.8C13631.76,-9444.91 13662.05,-9423.53 13689.91,-9403.86"/>
<polygon fill="black" stroke="black" points="13691.93,-9406.72 13698.08,-9398.1 13687.9,-9401 13691.93,-9406.72"/>
</g>
<!-- layer1_k_proj_3_1&#45;&gt;layer1_attention_3_1 -->
<g id="edge105" class="edge">
<title>layer1_k_proj_3_1&#45;&gt;layer1_attention_3_1</title>
<path fill="none" stroke="black" d="M13774.79,-9462.8C13774.79,-9454.53 13774.79,-9445.52 13774.79,-9436.27"/>
<polygon fill="black" stroke="black" points="13778.29,-9436.17 13774.79,-9426.17 13771.29,-9436.17 13778.29,-9436.17"/>
</g>
<!-- layer1_v_proj_3_1&#45;&gt;layer1_attention_3_1 -->
<g id="edge106" class="edge">
<title>layer1_v_proj_3_1&#45;&gt;layer1_attention_3_1</title>
<path fill="none" stroke="black" d="M13943.18,-9462.8C13917.82,-9444.91 13887.53,-9423.53 13859.67,-9403.86"/>
<polygon fill="black" stroke="black" points="13861.69,-9401 13851.5,-9398.1 13857.65,-9406.72 13861.69,-9401"/>
</g>
<!-- layer1_attention_3_2 -->
<g id="node80" class="node">
<title>layer1_attention_3_2</title>
<polygon fill="lightcoral" stroke="black" points="14402.79,-9425.96 14176.79,-9342.96 14402.79,-9259.96 14628.79,-9342.96 14402.79,-9425.96"/>
<text text-anchor="middle" x="14402.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14402.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="14402.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="14402.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="14402.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_q_proj_3_2&#45;&gt;layer1_attention_3_2 -->
<g id="edge107" class="edge">
<title>layer1_q_proj_3_2&#45;&gt;layer1_attention_3_2</title>
<path fill="none" stroke="black" d="M14271.66,-9462.8C14289.54,-9446.59 14310.58,-9427.53 14330.5,-9409.47"/>
<polygon fill="black" stroke="black" points="14333.02,-9411.92 14338.08,-9402.61 14328.32,-9406.73 14333.02,-9411.92"/>
</g>
<!-- layer1_k_proj_3_2&#45;&gt;layer1_attention_3_2 -->
<g id="edge108" class="edge">
<title>layer1_k_proj_3_2&#45;&gt;layer1_attention_3_2</title>
<path fill="none" stroke="black" d="M14440.04,-9462.8C14436.64,-9451.95 14432.84,-9439.81 14429,-9427.56"/>
<polygon fill="black" stroke="black" points="14432.25,-9426.22 14425.92,-9417.73 14425.57,-9428.31 14432.25,-9426.22"/>
</g>
<!-- layer1_v_proj_3_2&#45;&gt;layer1_attention_3_2 -->
<g id="edge109" class="edge">
<title>layer1_v_proj_3_2&#45;&gt;layer1_attention_3_2</title>
<path fill="none" stroke="black" d="M14608.43,-9462.8C14575.08,-9443.53 14534.73,-9420.21 14498.64,-9399.35"/>
<polygon fill="black" stroke="black" points="14499.97,-9396.08 14489.56,-9394.1 14496.47,-9402.14 14499.97,-9396.08"/>
</g>
<!-- layer1_attention_3_3 -->
<g id="node81" class="node">
<title>layer1_attention_3_3</title>
<polygon fill="lightcoral" stroke="black" points="14930.79,-9425.96 14704.79,-9342.96 14930.79,-9259.96 15156.79,-9342.96 14930.79,-9425.96"/>
<text text-anchor="middle" x="14930.79" y="-9369.26" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14930.79" y="-9354.26" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="14930.79" y="-9339.26" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="14930.79" y="-9324.26" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="14930.79" y="-9309.26" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_q_proj_3_3&#45;&gt;layer1_attention_3_3 -->
<g id="edge110" class="edge">
<title>layer1_q_proj_3_3&#45;&gt;layer1_attention_3_3</title>
<path fill="none" stroke="black" d="M14911.42,-9462.8C14913,-9453.12 14914.74,-9442.42 14916.52,-9431.52"/>
<polygon fill="black" stroke="black" points="14920,-9431.91 14918.16,-9421.48 14913.09,-9430.78 14920,-9431.91"/>
</g>
<!-- layer1_k_proj_3_3&#45;&gt;layer1_attention_3_3 -->
<g id="edge111" class="edge">
<title>layer1_k_proj_3_3&#45;&gt;layer1_attention_3_3</title>
<path fill="none" stroke="black" d="M15079.81,-9462.8C15058.39,-9445.72 15032.98,-9425.46 15009.27,-9406.55"/>
<polygon fill="black" stroke="black" points="15011.3,-9403.69 15001.3,-9400.19 15006.94,-9409.16 15011.3,-9403.69"/>
</g>
<!-- layer1_v_proj_3_3&#45;&gt;layer1_attention_3_3 -->
<g id="edge112" class="edge">
<title>layer1_v_proj_3_3&#45;&gt;layer1_attention_3_3</title>
<path fill="none" stroke="black" d="M15252.58,-9464.44C15191.66,-9441.63 15114.52,-9412.75 15051.04,-9388.98"/>
<polygon fill="black" stroke="black" points="15051.96,-9385.59 15041.37,-9385.36 15049.51,-9392.15 15051.96,-9385.59"/>
</g>
<!-- layer1_concat_dim_0 -->
<g id="node82" class="node">
<title>layer1_concat_dim_0</title>
<polygon fill="orange" stroke="black" points="7014.87,-9222.96 6742.72,-9222.96 6645.79,-9086.96 7111.79,-9086.96 7014.87,-9222.96"/>
<text text-anchor="middle" x="6878.79" y="-9173.76" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="6878.79" y="-9158.76" font-family="Times,serif" font-size="14.00">HeadGroup:0</text>
<text text-anchor="middle" x="6878.79" y="-9143.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6878.79" y="-9128.76" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3 (communication)</text>
</g>
<!-- layer1_attention_0_0&#45;&gt;layer1_concat_dim_0 -->
<g id="edge113" class="edge">
<title>layer1_attention_0_0&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M5924.65,-9302.03C5971.38,-9287.01 6026.2,-9270.93 6076.79,-9259.96 6286.29,-9214.55 6531.16,-9186.31 6694.7,-9170.92"/>
<polygon fill="black" stroke="black" points="6695.23,-9174.38 6704.86,-9169.97 6694.58,-9167.41 6695.23,-9174.38"/>
</g>
<!-- layer1_attention_0_1&#45;&gt;layer1_concat_dim_0 -->
<g id="edge114" class="edge">
<title>layer1_attention_0_1&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M6429.96,-9303.19C6514.05,-9275.61 6627.96,-9238.24 6719.98,-9208.06"/>
<polygon fill="black" stroke="black" points="6721.26,-9211.32 6729.67,-9204.88 6719.08,-9204.67 6721.26,-9211.32"/>
</g>
<!-- layer1_attention_0_2&#45;&gt;layer1_concat_dim_0 -->
<g id="edge115" class="edge">
<title>layer1_attention_0_2&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M6878.79,-9259.84C6878.79,-9251.02 6878.79,-9242.08 6878.79,-9233.32"/>
<polygon fill="black" stroke="black" points="6882.29,-9233.15 6878.79,-9223.15 6875.29,-9233.15 6882.29,-9233.15"/>
</g>
<!-- layer1_attention_0_3&#45;&gt;layer1_concat_dim_0 -->
<g id="edge116" class="edge">
<title>layer1_attention_0_3&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M7309.79,-9302.51C7230.29,-9275.48 7123.86,-9239.29 7036.65,-9209.64"/>
<polygon fill="black" stroke="black" points="7037.52,-9206.24 7026.93,-9206.33 7035.27,-9212.87 7037.52,-9206.24"/>
</g>
<!-- layer1_concat_dim_1 -->
<g id="node83" class="node">
<title>layer1_concat_dim_1</title>
<polygon fill="orange" stroke="black" points="9460.87,-9222.96 9188.72,-9222.96 9091.79,-9086.96 9557.79,-9086.96 9460.87,-9222.96"/>
<text text-anchor="middle" x="9324.79" y="-9173.76" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="9324.79" y="-9158.76" font-family="Times,serif" font-size="14.00">HeadGroup:1</text>
<text text-anchor="middle" x="9324.79" y="-9143.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9324.79" y="-9128.76" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7 (communication)</text>
</g>
<!-- layer1_attention_1_0&#45;&gt;layer1_concat_dim_1 -->
<g id="edge117" class="edge">
<title>layer1_attention_1_0&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M8326.42,-9304.4C8380.34,-9288.84 8444.8,-9271.72 8503.79,-9259.96 8720.92,-9216.66 8974.14,-9187.81 9141.32,-9171.69"/>
<polygon fill="black" stroke="black" points="9141.83,-9175.16 9151.46,-9170.72 9141.17,-9168.19 9141.83,-9175.16"/>
</g>
<!-- layer1_attention_1_1&#45;&gt;layer1_concat_dim_1 -->
<g id="edge118" class="edge">
<title>layer1_attention_1_1&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M8858.79,-9303.87C8947.26,-9275.79 9068.51,-9237.31 9165.15,-9206.63"/>
<polygon fill="black" stroke="black" points="9166.25,-9209.95 9174.72,-9203.59 9164.13,-9203.28 9166.25,-9209.95"/>
</g>
<!-- layer1_attention_1_2&#45;&gt;layer1_concat_dim_1 -->
<g id="edge119" class="edge">
<title>layer1_attention_1_2&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M9324.79,-9259.84C9324.79,-9251.02 9324.79,-9242.08 9324.79,-9233.32"/>
<polygon fill="black" stroke="black" points="9328.29,-9233.15 9324.79,-9223.15 9321.29,-9233.15 9328.29,-9233.15"/>
</g>
<!-- layer1_attention_1_3&#45;&gt;layer1_concat_dim_1 -->
<g id="edge120" class="edge">
<title>layer1_attention_1_3&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M9720.68,-9300.91C9650.06,-9275.06 9557.91,-9241.31 9480.28,-9212.89"/>
<polygon fill="black" stroke="black" points="9481.48,-9209.6 9470.89,-9209.45 9479.07,-9216.18 9481.48,-9209.6"/>
</g>
<!-- layer1_concat_dim_2 -->
<g id="node84" class="node">
<title>layer1_concat_dim_2</title>
<polygon fill="orange" stroke="black" points="11319.87,-9222.96 11047.72,-9222.96 10950.79,-9086.96 11416.79,-9086.96 11319.87,-9222.96"/>
<text text-anchor="middle" x="11183.79" y="-9173.76" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="11183.79" y="-9158.76" font-family="Times,serif" font-size="14.00">HeadGroup:2</text>
<text text-anchor="middle" x="11183.79" y="-9143.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="11183.79" y="-9128.76" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11 (communication)</text>
</g>
<!-- layer1_attention_2_0&#45;&gt;layer1_concat_dim_2 -->
<g id="edge121" class="edge">
<title>layer1_attention_2_0&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M10752.8,-9302.51C10832.29,-9275.48 10938.72,-9239.29 11025.93,-9209.64"/>
<polygon fill="black" stroke="black" points="11027.31,-9212.87 11035.65,-9206.33 11025.06,-9206.24 11027.31,-9212.87"/>
</g>
<!-- layer1_attention_2_1&#45;&gt;layer1_concat_dim_2 -->
<g id="edge122" class="edge">
<title>layer1_attention_2_1&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M11183.79,-9259.84C11183.79,-9251.02 11183.79,-9242.08 11183.79,-9233.32"/>
<polygon fill="black" stroke="black" points="11187.29,-9233.15 11183.79,-9223.15 11180.29,-9233.15 11187.29,-9233.15"/>
</g>
<!-- layer1_attention_2_2&#45;&gt;layer1_concat_dim_2 -->
<g id="edge123" class="edge">
<title>layer1_attention_2_2&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M11593.31,-9301.6C11519.4,-9275.32 11421.98,-9240.67 11340.7,-9211.76"/>
<polygon fill="black" stroke="black" points="11341.46,-9208.32 11330.87,-9208.27 11339.12,-9214.92 11341.46,-9208.32"/>
</g>
<!-- layer1_attention_2_3&#45;&gt;layer1_concat_dim_2 -->
<g id="edge124" class="edge">
<title>layer1_attention_2_3&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M12212.6,-9311.68C12133.24,-9295.2 12032.23,-9275.15 11941.79,-9259.96 11744.55,-9226.83 11517.11,-9196.7 11363.23,-9177.49"/>
<polygon fill="black" stroke="black" points="11363.56,-9174.01 11353.2,-9176.24 11362.69,-9180.95 11363.56,-9174.01"/>
</g>
<!-- layer1_concat_dim_3 -->
<g id="node85" class="node">
<title>layer1_concat_dim_3</title>
<polygon fill="orange" stroke="black" points="13910.87,-9222.96 13638.72,-9222.96 13541.79,-9086.96 14007.79,-9086.96 13910.87,-9222.96"/>
<text text-anchor="middle" x="13774.79" y="-9173.76" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="13774.79" y="-9158.76" font-family="Times,serif" font-size="14.00">HeadGroup:3</text>
<text text-anchor="middle" x="13774.79" y="-9143.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="13774.79" y="-9128.76" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15 (communication)</text>
</g>
<!-- layer1_attention_3_0&#45;&gt;layer1_concat_dim_3 -->
<g id="edge125" class="edge">
<title>layer1_attention_3_0&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M13343.01,-9302.51C13422.81,-9275.43 13529.7,-9239.15 13617.15,-9209.46"/>
<polygon fill="black" stroke="black" points="13618.29,-9212.78 13626.64,-9206.25 13616.04,-9206.15 13618.29,-9212.78"/>
</g>
<!-- layer1_attention_3_1&#45;&gt;layer1_concat_dim_3 -->
<g id="edge126" class="edge">
<title>layer1_attention_3_1&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M13774.79,-9259.84C13774.79,-9251.02 13774.79,-9242.08 13774.79,-9233.32"/>
<polygon fill="black" stroke="black" points="13778.29,-9233.15 13774.79,-9223.15 13771.29,-9233.15 13778.29,-9233.15"/>
</g>
<!-- layer1_attention_3_2&#45;&gt;layer1_concat_dim_3 -->
<g id="edge127" class="edge">
<title>layer1_attention_3_2&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M14279.09,-9305.32C14181.12,-9276.3 14043.45,-9235.53 13936.7,-9203.91"/>
<polygon fill="black" stroke="black" points="13937.38,-9200.46 13926.8,-9200.98 13935.39,-9207.18 13937.38,-9200.46"/>
</g>
<!-- layer1_attention_3_3&#45;&gt;layer1_concat_dim_3 -->
<g id="edge128" class="edge">
<title>layer1_attention_3_3&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M14810.98,-9303.96C14758.3,-9288.41 14695.43,-9271.43 14637.79,-9259.96 14406.21,-9213.88 14135.34,-9185.28 13959.71,-9170"/>
<polygon fill="black" stroke="black" points="13959.85,-9166.5 13949.59,-9169.13 13959.25,-9173.48 13959.85,-9166.5"/>
</g>
<!-- layer1_concat_heads -->
<g id="node86" class="node">
<title>layer1_concat_heads</title>
<polygon fill="gold" stroke="black" points="9913.93,-9049.96 9675.65,-9049.96 9590.79,-8943.96 9998.79,-8943.96 9913.93,-9049.96"/>
<text text-anchor="middle" x="9794.79" y="-9008.26" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="9794.79" y="-8993.26" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9794.79" y="-8978.26" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllGather)</text>
</g>
<!-- layer1_concat_dim_0&#45;&gt;layer1_concat_heads -->
<g id="edge129" class="edge">
<title>layer1_concat_dim_0&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M7071.53,-9143.65C7610.5,-9114.82 9126.6,-9033.71 9630,-9006.78"/>
<polygon fill="black" stroke="black" points="9630.45,-9010.26 9640.25,-9006.23 9630.08,-9003.27 9630.45,-9010.26"/>
</g>
<!-- layer1_concat_dim_1&#45;&gt;layer1_concat_heads -->
<g id="edge130" class="edge">
<title>layer1_concat_dim_1&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M9526.84,-9086.9C9571.16,-9072.19 9617.07,-9056.95 9658.11,-9043.33"/>
<polygon fill="black" stroke="black" points="9659.21,-9046.65 9667.6,-9040.18 9657.01,-9040 9659.21,-9046.65"/>
</g>
<!-- layer1_concat_dim_2&#45;&gt;layer1_concat_heads -->
<g id="edge131" class="edge">
<title>layer1_concat_dim_2&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M10982.19,-9131.32C10703.49,-9100.02 10206.25,-9044.17 9952.79,-9015.7"/>
<polygon fill="black" stroke="black" points="9953.09,-9012.22 9942.76,-9014.58 9952.3,-9019.17 9953.09,-9012.22"/>
</g>
<!-- layer1_concat_dim_3&#45;&gt;layer1_concat_heads -->
<g id="edge132" class="edge">
<title>layer1_concat_dim_3&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M13584.17,-9146.49C12903.75,-9119.82 10601.14,-9029.57 9961.08,-9004.48"/>
<polygon fill="black" stroke="black" points="9960.98,-9000.97 9950.85,-9004.08 9960.71,-9007.97 9960.98,-9000.97"/>
</g>
<!-- layer1_o_proj_0_0 -->
<g id="node87" class="node">
<title>layer1_o_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="8273.79,-8906.96 8075.79,-8906.96 8075.79,-8823.96 8273.79,-8823.96 8273.79,-8906.96"/>
<text text-anchor="middle" x="8174.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8174.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="8174.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8174.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="8174.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_0_0 -->
<g id="edge133" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_0_0</title>
<path fill="none" stroke="black" d="M9629.33,-8992.47C9296.19,-8984.42 8554.1,-8961.12 8283.72,-8906.93"/>
<polygon fill="black" stroke="black" points="8284.41,-8903.5 8273.91,-8904.9 8283,-8910.35 8284.41,-8903.5"/>
</g>
<!-- layer1_o_proj_0_1 -->
<g id="node88" class="node">
<title>layer1_o_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8489.79,-8906.96 8291.79,-8906.96 8291.79,-8823.96 8489.79,-8823.96 8489.79,-8906.96"/>
<text text-anchor="middle" x="8390.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8390.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="8390.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8390.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="8390.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_0_1 -->
<g id="edge134" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_0_1</title>
<path fill="none" stroke="black" d="M9627.86,-8990.51C9332.31,-8979.89 8727.46,-8953.45 8499.82,-8906.95"/>
<polygon fill="black" stroke="black" points="8500.42,-8903.5 8489.92,-8904.87 8498.98,-8910.35 8500.42,-8903.5"/>
</g>
<!-- layer1_o_proj_0_2 -->
<g id="node89" class="node">
<title>layer1_o_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8705.79,-8906.96 8507.79,-8906.96 8507.79,-8823.96 8705.79,-8823.96 8705.79,-8906.96"/>
<text text-anchor="middle" x="8606.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8606.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="8606.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8606.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8606.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_0_2 -->
<g id="edge135" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_0_2</title>
<path fill="none" stroke="black" d="M9632.59,-8996.46C9421.65,-8994.01 9042.55,-8978.97 8716.06,-8907.07"/>
<polygon fill="black" stroke="black" points="8716.45,-8903.57 8705.93,-8904.81 8714.93,-8910.4 8716.45,-8903.57"/>
</g>
<!-- layer1_o_proj_0_3 -->
<g id="node90" class="node">
<title>layer1_o_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="8921.79,-8906.96 8723.79,-8906.96 8723.79,-8823.96 8921.79,-8823.96 8921.79,-8906.96"/>
<text text-anchor="middle" x="8822.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8822.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="8822.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8822.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="8822.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_0_3 -->
<g id="edge136" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_0_3</title>
<path fill="none" stroke="black" d="M9628.68,-8991.44C9455.49,-8983.85 9176.8,-8963.54 8931.75,-8907.02"/>
<polygon fill="black" stroke="black" points="8932.48,-8903.59 8921.95,-8904.73 8930.89,-8910.41 8932.48,-8903.59"/>
</g>
<!-- layer1_o_proj_1_0 -->
<g id="node91" class="node">
<title>layer1_o_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="9137.79,-8906.96 8939.79,-8906.96 8939.79,-8823.96 9137.79,-8823.96 9137.79,-8906.96"/>
<text text-anchor="middle" x="9038.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9038.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="9038.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9038.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9038.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_1_0 -->
<g id="edge137" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_1_0</title>
<path fill="none" stroke="black" d="M9621.57,-8982.71C9492.47,-8970.36 9312.25,-8947.87 9147.79,-8907.06"/>
<polygon fill="black" stroke="black" points="9148.53,-8903.64 9137.98,-8904.6 9146.83,-8910.43 9148.53,-8903.64"/>
</g>
<!-- layer1_o_proj_1_1 -->
<g id="node92" class="node">
<title>layer1_o_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="9353.79,-8906.96 9155.79,-8906.96 9155.79,-8823.96 9353.79,-8823.96 9353.79,-8906.96"/>
<text text-anchor="middle" x="9254.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9254.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="9254.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9254.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="9254.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_1_1 -->
<g id="edge138" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_1_1</title>
<path fill="none" stroke="black" d="M9606.65,-8963.8C9533.14,-8949.59 9448.26,-8931.16 9363.81,-8907.15"/>
<polygon fill="black" stroke="black" points="9364.63,-8903.74 9354.05,-8904.34 9362.7,-8910.47 9364.63,-8903.74"/>
</g>
<!-- layer1_o_proj_1_2 -->
<g id="node93" class="node">
<title>layer1_o_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="9569.79,-8906.96 9371.79,-8906.96 9371.79,-8823.96 9569.79,-8823.96 9569.79,-8906.96"/>
<text text-anchor="middle" x="9470.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9470.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="9470.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9470.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9470.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_1_2 -->
<g id="edge139" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_1_2</title>
<path fill="none" stroke="black" d="M9664.41,-8943.85C9636.25,-8932.59 9606.77,-8920.81 9579.55,-8909.93"/>
<polygon fill="black" stroke="black" points="9580.6,-8906.58 9570.02,-8906.12 9578,-8913.08 9580.6,-8906.58"/>
</g>
<!-- layer1_o_proj_1_3 -->
<g id="node94" class="node">
<title>layer1_o_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="9785.79,-8906.96 9587.79,-8906.96 9587.79,-8823.96 9785.79,-8823.96 9785.79,-8906.96"/>
<text text-anchor="middle" x="9686.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9686.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="9686.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9686.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9686.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_1_3 -->
<g id="edge140" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_1_3</title>
<path fill="none" stroke="black" d="M9751.17,-8943.66C9743.22,-8934.12 9734.95,-8924.2 9727.09,-8914.78"/>
<polygon fill="black" stroke="black" points="9729.7,-8912.44 9720.6,-8907 9724.32,-8916.92 9729.7,-8912.44"/>
</g>
<!-- layer1_o_proj_2_0 -->
<g id="node95" class="node">
<title>layer1_o_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10001.79,-8906.96 9803.79,-8906.96 9803.79,-8823.96 10001.79,-8823.96 10001.79,-8906.96"/>
<text text-anchor="middle" x="9902.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9902.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9902.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9902.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9902.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_2_0 -->
<g id="edge141" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_2_0</title>
<path fill="none" stroke="black" d="M9838.41,-8943.66C9846.37,-8934.12 9854.64,-8924.2 9862.49,-8914.78"/>
<polygon fill="black" stroke="black" points="9865.26,-8916.92 9868.98,-8907 9859.89,-8912.44 9865.26,-8916.92"/>
</g>
<!-- layer1_o_proj_2_1 -->
<g id="node96" class="node">
<title>layer1_o_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10217.79,-8906.96 10019.79,-8906.96 10019.79,-8823.96 10217.79,-8823.96 10217.79,-8906.96"/>
<text text-anchor="middle" x="10118.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10118.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="10118.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10118.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10118.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_2_1 -->
<g id="edge142" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_2_1</title>
<path fill="none" stroke="black" d="M9925.17,-8943.85C9953.33,-8932.59 9982.81,-8920.81 10010.04,-8909.93"/>
<polygon fill="black" stroke="black" points="10011.58,-8913.08 10019.57,-8906.12 10008.98,-8906.58 10011.58,-8913.08"/>
</g>
<!-- layer1_o_proj_2_2 -->
<g id="node97" class="node">
<title>layer1_o_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="10433.79,-8906.96 10235.79,-8906.96 10235.79,-8823.96 10433.79,-8823.96 10433.79,-8906.96"/>
<text text-anchor="middle" x="10334.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10334.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="10334.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10334.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10334.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_2_2 -->
<g id="edge143" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_2_2</title>
<path fill="none" stroke="black" d="M9982.93,-8963.8C10056.44,-8949.59 10141.33,-8931.16 10225.77,-8907.15"/>
<polygon fill="black" stroke="black" points="10226.89,-8910.47 10235.53,-8904.34 10224.96,-8903.74 10226.89,-8910.47"/>
</g>
<!-- layer1_o_proj_2_3 -->
<g id="node98" class="node">
<title>layer1_o_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10649.79,-8906.96 10451.79,-8906.96 10451.79,-8823.96 10649.79,-8823.96 10649.79,-8906.96"/>
<text text-anchor="middle" x="10550.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10550.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="10550.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10550.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10550.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_2_3 -->
<g id="edge144" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_2_3</title>
<path fill="none" stroke="black" d="M9968.01,-8982.71C10097.12,-8970.36 10277.33,-8947.87 10441.79,-8907.06"/>
<polygon fill="black" stroke="black" points="10442.75,-8910.43 10451.6,-8904.6 10441.05,-8903.64 10442.75,-8910.43"/>
</g>
<!-- layer1_o_proj_3_0 -->
<g id="node99" class="node">
<title>layer1_o_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="10865.79,-8906.96 10667.79,-8906.96 10667.79,-8823.96 10865.79,-8823.96 10865.79,-8906.96"/>
<text text-anchor="middle" x="10766.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10766.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="10766.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10766.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10766.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_3_0 -->
<g id="edge145" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_3_0</title>
<path fill="none" stroke="black" d="M9960.9,-8991.44C10134.1,-8983.85 10412.78,-8963.54 10657.83,-8907.02"/>
<polygon fill="black" stroke="black" points="10658.69,-8910.41 10667.63,-8904.73 10657.1,-8903.59 10658.69,-8910.41"/>
</g>
<!-- layer1_o_proj_3_1 -->
<g id="node100" class="node">
<title>layer1_o_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="11081.79,-8906.96 10883.79,-8906.96 10883.79,-8823.96 11081.79,-8823.96 11081.79,-8906.96"/>
<text text-anchor="middle" x="10982.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10982.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="10982.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10982.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="10982.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_3_1 -->
<g id="edge146" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_3_1</title>
<path fill="none" stroke="black" d="M9956.99,-8996.46C10167.93,-8994.01 10547.03,-8978.97 10873.52,-8907.07"/>
<polygon fill="black" stroke="black" points="10874.65,-8910.4 10883.65,-8904.81 10873.13,-8903.57 10874.65,-8910.4"/>
</g>
<!-- layer1_o_proj_3_2 -->
<g id="node101" class="node">
<title>layer1_o_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11297.79,-8906.96 11099.79,-8906.96 11099.79,-8823.96 11297.79,-8823.96 11297.79,-8906.96"/>
<text text-anchor="middle" x="11198.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="11198.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="11198.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="11198.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="11198.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_3_2 -->
<g id="edge147" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_3_2</title>
<path fill="none" stroke="black" d="M9961.72,-8990.51C10257.28,-8979.89 10862.12,-8953.45 11089.76,-8906.95"/>
<polygon fill="black" stroke="black" points="11090.6,-8910.35 11099.66,-8904.87 11089.16,-8903.5 11090.6,-8910.35"/>
</g>
<!-- layer1_o_proj_3_3 -->
<g id="node102" class="node">
<title>layer1_o_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="11513.79,-8906.96 11315.79,-8906.96 11315.79,-8823.96 11513.79,-8823.96 11513.79,-8906.96"/>
<text text-anchor="middle" x="11414.79" y="-8891.76" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="11414.79" y="-8876.76" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="11414.79" y="-8861.76" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="11414.79" y="-8846.76" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="11414.79" y="-8831.76" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_o_proj_3_3 -->
<g id="edge148" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_o_proj_3_3</title>
<path fill="none" stroke="black" d="M9965.54,-8985.97C10196.96,-8972.42 10623.09,-8947.44 10986.79,-8925.96 11125.82,-8917.75 11165.64,-8935.69 11305.85,-8906.96"/>
<polygon fill="black" stroke="black" points="11306.6,-8910.38 11315.67,-8904.9 11305.17,-8903.52 11306.6,-8910.38"/>
</g>
<!-- layer1_res1 -->
<g id="node103" class="node">
<title>layer1_res1</title>
<ellipse fill="lightpink" stroke="black" cx="9746.79" cy="-8641.3" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="9746.79" y="-8652.6" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="9746.79" y="-8637.6" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9746.79" y="-8622.6" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer1_o_proj_0_0&#45;&gt;layer1_res1 -->
<g id="edge149" class="edge">
<title>layer1_o_proj_0_0&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M8273.97,-8826.27C8276.93,-8825.45 8279.87,-8824.68 8282.79,-8823.96 8750.41,-8708.97 9320.85,-8664.9 9590.84,-8649.6"/>
<polygon fill="black" stroke="black" points="9591.31,-8653.08 9601.1,-8649.02 9590.92,-8646.09 9591.31,-8653.08"/>
</g>
<!-- layer1_o_proj_0_1&#45;&gt;layer1_res1 -->
<g id="edge150" class="edge">
<title>layer1_o_proj_0_1&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M8489.99,-8826.35C8492.94,-8825.51 8495.88,-8824.71 8498.79,-8823.96 8884.75,-8724.73 9352.75,-8674.77 9591.03,-8654.18"/>
<polygon fill="black" stroke="black" points="9591.49,-8657.65 9601.15,-8653.31 9590.89,-8650.68 9591.49,-8657.65"/>
</g>
<!-- layer1_o_proj_0_2&#45;&gt;layer1_res1 -->
<g id="edge151" class="edge">
<title>layer1_o_proj_0_2&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M8706.02,-8826.46C8708.96,-8825.59 8711.89,-8824.75 8714.79,-8823.96 9020.7,-8740.45 9388.47,-8686.44 9592.04,-8660.47"/>
<polygon fill="black" stroke="black" points="9592.73,-8663.91 9602.21,-8659.18 9591.85,-8656.97 9592.73,-8663.91"/>
</g>
<!-- layer1_o_proj_0_3&#45;&gt;layer1_res1 -->
<g id="edge152" class="edge">
<title>layer1_o_proj_0_3&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M8922.07,-8826.64C8925,-8825.71 8927.91,-8824.82 8930.79,-8823.96 9158.19,-8756.37 9427.86,-8701.03 9593.12,-8669.86"/>
<polygon fill="black" stroke="black" points="9594.18,-8673.22 9603.36,-8667.93 9592.89,-8666.34 9594.18,-8673.22"/>
</g>
<!-- layer1_o_proj_1_0&#45;&gt;layer1_res1 -->
<g id="edge153" class="edge">
<title>layer1_o_proj_1_0&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M9137.87,-8827.02C9140.87,-8825.98 9143.85,-8824.96 9146.79,-8823.96 9298.98,-8772.45 9475.17,-8719.93 9597.07,-8684.7"/>
<polygon fill="black" stroke="black" points="9598.22,-8688.02 9606.86,-8681.88 9596.28,-8681.29 9598.22,-8688.02"/>
</g>
<!-- layer1_o_proj_1_1&#45;&gt;layer1_res1 -->
<g id="edge154" class="edge">
<title>layer1_o_proj_1_1&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M9344.75,-8823.84C9417.44,-8791.01 9521.11,-8744.2 9604.96,-8706.34"/>
<polygon fill="black" stroke="black" points="9606.63,-8709.43 9614.31,-8702.12 9603.75,-8703.05 9606.63,-8709.43"/>
</g>
<!-- layer1_o_proj_1_2&#45;&gt;layer1_res1 -->
<g id="edge155" class="edge">
<title>layer1_o_proj_1_2&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M9531.72,-8823.69C9539.91,-8817.87 9548.12,-8811.86 9555.79,-8805.96 9580.47,-8786.98 9606.21,-8765.88 9630.51,-8745.32"/>
<polygon fill="black" stroke="black" points="9632.99,-8747.8 9638.35,-8738.66 9628.46,-8742.47 9632.99,-8747.8"/>
</g>
<!-- layer1_o_proj_1_3&#45;&gt;layer1_res1 -->
<g id="edge156" class="edge">
<title>layer1_o_proj_1_3&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M9697.8,-8823.71C9700.39,-8814.12 9703.3,-8803.34 9706.38,-8791.94"/>
<polygon fill="black" stroke="black" points="9709.77,-8792.8 9709,-8782.24 9703.01,-8790.98 9709.77,-8792.8"/>
</g>
<!-- layer1_o_proj_2_0&#45;&gt;layer1_res1 -->
<g id="edge157" class="edge">
<title>layer1_o_proj_2_0&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M9874.18,-8823.71C9863.17,-8808.04 9849.94,-8789.19 9836.22,-8769.66"/>
<polygon fill="black" stroke="black" points="9838.93,-8767.42 9830.32,-8761.25 9833.2,-8771.44 9838.93,-8767.42"/>
</g>
<!-- layer1_o_proj_2_1&#45;&gt;layer1_res1 -->
<g id="edge158" class="edge">
<title>layer1_o_proj_2_1&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M10050.56,-8823.71C10003.08,-8795.35 9938.2,-8756.61 9880.59,-8722.2"/>
<polygon fill="black" stroke="black" points="9882.16,-8719.06 9871.78,-8716.94 9878.57,-8725.07 9882.16,-8719.06"/>
</g>
<!-- layer1_o_proj_2_2&#45;&gt;layer1_res1 -->
<g id="edge159" class="edge">
<title>layer1_o_proj_2_2&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M10235.71,-8827.02C10141.75,-8791.52 9999.44,-8737.76 9892.55,-8697.37"/>
<polygon fill="black" stroke="black" points="9893.56,-8694.01 9882.97,-8693.75 9891.09,-8700.56 9893.56,-8694.01"/>
</g>
<!-- layer1_o_proj_2_3&#45;&gt;layer1_res1 -->
<g id="edge160" class="edge">
<title>layer1_o_proj_2_3&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M10451.77,-8826.87C10448.75,-8825.87 10445.75,-8824.9 10442.79,-8823.96 10257.66,-8765.26 10040.61,-8710.84 9898.73,-8677.16"/>
<polygon fill="black" stroke="black" points="9899.19,-8673.67 9888.65,-8674.77 9897.58,-8680.48 9899.19,-8673.67"/>
</g>
<!-- layer1_o_proj_3_0&#45;&gt;layer1_res1 -->
<g id="edge161" class="edge">
<title>layer1_o_proj_3_0&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M10667.54,-8826.55C10664.6,-8825.65 10661.68,-8824.78 10658.79,-8823.96 10396.76,-8749.27 10083.85,-8694.1 9901.03,-8665.18"/>
<polygon fill="black" stroke="black" points="9901.49,-8661.71 9891.07,-8663.61 9900.4,-8668.63 9901.49,-8661.71"/>
</g>
<!-- layer1_o_proj_3_1&#45;&gt;layer1_res1 -->
<g id="edge162" class="edge">
<title>layer1_o_proj_3_1&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M10883.58,-8826.41C10880.63,-8825.55 10877.69,-8824.73 10874.79,-8823.96 10533.49,-8733.45 10121.42,-8680.97 9902.03,-8657.4"/>
<polygon fill="black" stroke="black" points="9902.37,-8653.92 9892.05,-8656.34 9901.63,-8660.88 9902.37,-8653.92"/>
</g>
<!-- layer1_o_proj_3_2&#45;&gt;layer1_res1 -->
<g id="edge163" class="edge">
<title>layer1_o_proj_3_2&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M11099.6,-8826.31C11096.65,-8825.48 11093.7,-8824.69 11090.79,-8823.96 10668.59,-8717.7 10155.13,-8670.17 9902.5,-8651.96"/>
<polygon fill="black" stroke="black" points="9902.74,-8648.47 9892.52,-8651.25 9902.24,-8655.45 9902.74,-8648.47"/>
</g>
<!-- layer1_o_proj_3_3&#45;&gt;layer1_res1 -->
<g id="edge164" class="edge">
<title>layer1_o_proj_3_3&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M11315.62,-8826.24C11312.66,-8825.43 11309.71,-8824.67 11306.79,-8823.96 10802.53,-8701.97 10186.07,-8660.97 9902.76,-8647.95"/>
<polygon fill="black" stroke="black" points="9902.56,-8644.44 9892.41,-8647.48 9902.24,-8651.43 9902.56,-8644.44"/>
</g>
<!-- layer1_ln2_0_0 -->
<g id="node104" class="node">
<title>layer1_ln2_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="6033.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6033.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6033.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="6033.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6033.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_0_0 -->
<g id="edge165" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_0_0</title>
<path fill="none" stroke="black" d="M9601.24,-8631.33C9003.92,-8594.53 6745.15,-8455.37 6168.48,-8419.85"/>
<polygon fill="black" stroke="black" points="6168.65,-8416.35 6158.45,-8419.23 6168.22,-8423.34 6168.65,-8416.35"/>
</g>
<!-- layer1_ln2_0_1 -->
<g id="node105" class="node">
<title>layer1_ln2_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="11263.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11263.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11263.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="11263.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11263.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_0_1 -->
<g id="edge167" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_0_1</title>
<path fill="none" stroke="black" d="M9890.95,-8618.9C10118.06,-8585.14 10573.07,-8517.31 10958.79,-8458.63 11017.51,-8449.7 11082.56,-8439.67 11137.46,-8431.18"/>
<polygon fill="black" stroke="black" points="11138.24,-8434.6 11147.58,-8429.61 11137.17,-8427.68 11138.24,-8434.6"/>
</g>
<!-- layer1_ln2_0_2 -->
<g id="node106" class="node">
<title>layer1_ln2_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="8998.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8998.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8998.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="8998.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8998.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_0_2 -->
<g id="edge169" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_0_2</title>
<path fill="none" stroke="black" d="M9607.41,-8597.67C9462.27,-8553.28 9238.03,-8484.71 9106.09,-8444.36"/>
<polygon fill="black" stroke="black" points="9106.95,-8440.97 9096.36,-8441.39 9104.9,-8447.66 9106.95,-8440.97"/>
</g>
<!-- layer1_ln2_0_3 -->
<g id="node107" class="node">
<title>layer1_ln2_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10344.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10344.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10344.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="10344.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10344.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_0_3 -->
<g id="edge171" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_0_3</title>
<path fill="none" stroke="black" d="M9882.86,-8588.25C9993.88,-8545.78 10148.04,-8486.81 10247.12,-8448.91"/>
<polygon fill="black" stroke="black" points="10248.44,-8452.15 10256.53,-8445.31 10245.94,-8445.61 10248.44,-8452.15"/>
</g>
<!-- layer1_ln2_1_0 -->
<g id="node108" class="node">
<title>layer1_ln2_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12952.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="12952.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12952.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12952.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12952.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_1_0 -->
<g id="edge173" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_1_0</title>
<path fill="none" stroke="black" d="M9892.65,-8639.75C10328.14,-8636.35 11656.13,-8613.08 12743.79,-8458.63 12775.03,-8454.2 12808.51,-8447.53 12839.32,-8440.6"/>
<polygon fill="black" stroke="black" points="12840.25,-8443.98 12849.22,-8438.34 12838.69,-8437.15 12840.25,-8443.98"/>
</g>
<!-- layer1_ln2_1_1 -->
<g id="node109" class="node">
<title>layer1_ln2_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9295.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9295.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9295.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="9295.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9295.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_1_1 -->
<g id="edge175" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_1_1</title>
<path fill="none" stroke="black" d="M9617.25,-8574.59C9540.94,-8535.89 9446.61,-8488.04 9379.92,-8454.22"/>
<polygon fill="black" stroke="black" points="9381.2,-8450.94 9370.7,-8449.54 9378.03,-8457.19 9381.2,-8450.94"/>
</g>
<!-- layer1_ln2_1_2 -->
<g id="node110" class="node">
<title>layer1_ln2_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7821.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7821.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7821.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="7821.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7821.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_1_2 -->
<g id="edge177" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_1_2</title>
<path fill="none" stroke="black" d="M9601.89,-8624.74C9323.29,-8594.59 8693.65,-8525.29 8164.79,-8458.63 8093.61,-8449.66 8014.24,-8438.82 7949.79,-8429.8"/>
<polygon fill="black" stroke="black" points="7949.96,-8426.29 7939.57,-8428.37 7948.99,-8433.23 7949.96,-8426.29"/>
</g>
<!-- layer1_ln2_1_3 -->
<g id="node111" class="node">
<title>layer1_ln2_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="11619.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11619.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11619.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="11619.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11619.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_1_3 -->
<g id="edge179" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_1_3</title>
<path fill="none" stroke="black" d="M9892.01,-8629.32C10180.54,-8606.41 10845.98,-8548.09 11399.79,-8458.63 11433.66,-8453.16 11470.18,-8445.9 11503.55,-8438.73"/>
<polygon fill="black" stroke="black" points="11504.31,-8442.14 11513.34,-8436.61 11502.82,-8435.3 11504.31,-8442.14"/>
</g>
<!-- layer1_ln2_2_0 -->
<g id="node112" class="node">
<title>layer1_ln2_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10822.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10822.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10822.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="10822.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10822.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_2_0 -->
<g id="edge181" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_2_0</title>
<path fill="none" stroke="black" d="M9889.12,-8610.04C10103.12,-8564.54 10503.91,-8479.34 10703.51,-8436.91"/>
<polygon fill="black" stroke="black" points="10704.39,-8440.3 10713.44,-8434.8 10702.93,-8433.45 10704.39,-8440.3"/>
</g>
<!-- layer1_ln2_2_1 -->
<g id="node113" class="node">
<title>layer1_ln2_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="8300.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8300.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8300.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="8300.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8300.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_2_1 -->
<g id="edge183" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_2_1</title>
<path fill="none" stroke="black" d="M9602.46,-8620.72C9375.71,-8589.48 8922.39,-8525.08 8539.79,-8458.63 8501.06,-8451.91 8458.95,-8443.86 8421.02,-8436.33"/>
<polygon fill="black" stroke="black" points="8421.45,-8432.85 8410.96,-8434.33 8420.08,-8439.72 8421.45,-8432.85"/>
</g>
<!-- layer1_ln2_2_2 -->
<g id="node114" class="node">
<title>layer1_ln2_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="8675.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8675.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8675.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="8675.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8675.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_2_2 -->
<g id="edge185" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_2_2</title>
<path fill="none" stroke="black" d="M9603.6,-8612.88C9428.42,-8578.88 9123.03,-8518.1 8862.79,-8458.63 8838.98,-8453.19 8813.56,-8447.03 8789.37,-8441"/>
<polygon fill="black" stroke="black" points="8790,-8437.55 8779.45,-8438.51 8788.3,-8444.34 8790,-8437.55"/>
</g>
<!-- layer1_ln2_2_3 -->
<g id="node115" class="node">
<title>layer1_ln2_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="12607.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="12607.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12607.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="12607.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12607.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_2_3 -->
<g id="edge187" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_2_3</title>
<path fill="none" stroke="black" d="M9892.55,-8634.82C10285.92,-8619.01 11401.77,-8567.32 12323.79,-8458.63 12376.95,-8452.37 12435.35,-8443.1 12485.29,-8434.44"/>
<polygon fill="black" stroke="black" points="12485.91,-8437.89 12495.16,-8432.72 12484.7,-8430.99 12485.91,-8437.89"/>
</g>
<!-- layer1_ln2_3_0 -->
<g id="node116" class="node">
<title>layer1_ln2_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12187.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="12187.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12187.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="12187.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12187.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_3_0 -->
<g id="edge189" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_3_0</title>
<path fill="none" stroke="black" d="M9892.15,-8628.07C10223.11,-8600.05 11058.18,-8528.18 11755.79,-8458.63 11857.07,-8448.53 11971.58,-8436 12057.24,-8426.41"/>
<polygon fill="black" stroke="black" points="12057.73,-8429.88 12067.28,-8425.28 12056.95,-8422.92 12057.73,-8429.88"/>
</g>
<!-- layer1_ln2_3_1 -->
<g id="node117" class="node">
<title>layer1_ln2_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9914.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9914.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9914.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="9914.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9914.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_3_1 -->
<g id="edge191" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_3_1</title>
<path fill="none" stroke="black" d="M9832.76,-8523.24C9847.61,-8503.03 9862.37,-8482.92 9875.2,-8465.46"/>
<polygon fill="black" stroke="black" points="9878.23,-8467.24 9881.33,-8457.11 9872.59,-8463.1 9878.23,-8467.24"/>
</g>
<!-- layer1_ln2_3_2 -->
<g id="node118" class="node">
<title>layer1_ln2_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7135.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7135.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7135.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="7135.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7135.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_3_2 -->
<g id="edge193" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_3_2</title>
<path fill="none" stroke="black" d="M9601.76,-8627.59C9140.64,-8587.19 7712.56,-8462.08 7268.77,-8423.2"/>
<polygon fill="black" stroke="black" points="7269.06,-8419.71 7258.79,-8422.32 7268.44,-8426.68 7269.06,-8419.71"/>
</g>
<!-- layer1_ln2_3_3 -->
<g id="node119" class="node">
<title>layer1_ln2_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="9579.79" cy="-8410.55" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9579.79" y="-8429.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9579.79" y="-8414.35" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="9579.79" y="-8399.35" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9579.79" y="-8384.35" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2_3_3 -->
<g id="edge195" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2_3_3</title>
<path fill="none" stroke="black" d="M9661.33,-8523.24C9646.58,-8503.03 9631.9,-8482.92 9619.15,-8465.46"/>
<polygon fill="black" stroke="black" points="9621.78,-8463.12 9613.05,-8457.11 9616.12,-8467.25 9621.78,-8463.12"/>
</g>
<!-- layer1_gate_0_0 -->
<g id="node120" class="node">
<title>layer1_gate_0_0</title>
<polygon fill="purple" stroke="black" points="6008.65,-8257.7 5881.72,-8325.24 5627.86,-8325.24 5500.93,-8257.7 5627.86,-8190.16 5881.72,-8190.16 6008.65,-8257.7"/>
<text text-anchor="middle" x="5754.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5754.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="5754.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5754.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5754.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_0_0&#45;&gt;layer1_gate_0_0 -->
<g id="edge166" class="edge">
<title>layer1_ln2_0_0&#45;&gt;layer1_gate_0_0</title>
<path fill="none" stroke="black" d="M5961.94,-8370.7C5939.05,-8358.32 5912.95,-8344.21 5887.18,-8330.28"/>
<polygon fill="black" stroke="black" points="5888.54,-8327.03 5878.08,-8325.36 5885.21,-8333.19 5888.54,-8327.03"/>
</g>
<!-- layer1_gate_0_1 -->
<g id="node121" class="node">
<title>layer1_gate_0_1</title>
<polygon fill="purple" stroke="black" points="11794.65,-8257.7 11667.72,-8325.24 11413.86,-8325.24 11286.93,-8257.7 11413.86,-8190.16 11667.72,-8190.16 11794.65,-8257.7"/>
<text text-anchor="middle" x="11540.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11540.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="11540.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11540.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="11540.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_0_1&#45;&gt;layer1_gate_0_1 -->
<g id="edge168" class="edge">
<title>layer1_ln2_0_1&#45;&gt;layer1_gate_0_1</title>
<path fill="none" stroke="black" d="M11335.13,-8370.7C11357.85,-8358.32 11383.77,-8344.21 11409.35,-8330.28"/>
<polygon fill="black" stroke="black" points="11411.28,-8333.21 11418.39,-8325.36 11407.93,-8327.07 11411.28,-8333.21"/>
</g>
<!-- layer1_gate_0_2 -->
<g id="node122" class="node">
<title>layer1_gate_0_2</title>
<polygon fill="purple" stroke="black" points="8638.65,-8257.7 8511.72,-8325.24 8257.86,-8325.24 8130.93,-8257.7 8257.86,-8190.16 8511.72,-8190.16 8638.65,-8257.7"/>
<text text-anchor="middle" x="8384.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8384.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="8384.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8384.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8384.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_0_2&#45;&gt;layer1_gate_0_2 -->
<g id="edge170" class="edge">
<title>layer1_ln2_0_2&#45;&gt;layer1_gate_0_2</title>
<path fill="none" stroke="black" d="M8895.05,-8382.94C8867.98,-8376.13 8838.82,-8368.92 8811.79,-8362.47 8739.11,-8345.12 8720.45,-8342.88 8647.79,-8325.47 8620.85,-8319.01 8592.4,-8311.99 8564.57,-8305.02"/>
<polygon fill="black" stroke="black" points="8565.3,-8301.59 8554.75,-8302.55 8563.6,-8308.38 8565.3,-8301.59"/>
</g>
<!-- layer1_gate_0_3 -->
<g id="node123" class="node">
<title>layer1_gate_0_3</title>
<polygon fill="purple" stroke="black" points="10742.65,-8257.7 10615.72,-8325.24 10361.86,-8325.24 10234.93,-8257.7 10361.86,-8190.16 10615.72,-8190.16 10742.65,-8257.7"/>
<text text-anchor="middle" x="10488.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10488.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="10488.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10488.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="10488.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_0_3&#45;&gt;layer1_gate_0_3 -->
<g id="edge172" class="edge">
<title>layer1_ln2_0_3&#45;&gt;layer1_gate_0_3</title>
<path fill="none" stroke="black" d="M10387.22,-8365.1C10396.95,-8354.91 10407.55,-8343.8 10418.12,-8332.73"/>
<polygon fill="black" stroke="black" points="10420.67,-8335.12 10425.05,-8325.47 10415.61,-8330.29 10420.67,-8335.12"/>
</g>
<!-- layer1_gate_1_0 -->
<g id="node124" class="node">
<title>layer1_gate_1_0</title>
<polygon fill="purple" stroke="black" points="13898.65,-8257.7 13771.72,-8325.24 13517.86,-8325.24 13390.93,-8257.7 13517.86,-8190.16 13771.72,-8190.16 13898.65,-8257.7"/>
<text text-anchor="middle" x="13644.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13644.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="13644.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="13644.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13644.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_1_0&#45;&gt;layer1_gate_1_0 -->
<g id="edge174" class="edge">
<title>layer1_ln2_1_0&#45;&gt;layer1_gate_1_0</title>
<path fill="none" stroke="black" d="M13066.5,-8389.03C13153.18,-8372.96 13275.35,-8349.39 13381.79,-8325.47 13409.13,-8319.32 13437.97,-8312.43 13466.13,-8305.46"/>
<polygon fill="black" stroke="black" points="13467.19,-8308.8 13476.05,-8303 13465.51,-8302.01 13467.19,-8308.8"/>
</g>
<!-- layer1_gate_1_1 -->
<g id="node125" class="node">
<title>layer1_gate_1_1</title>
<polygon fill="purple" stroke="black" points="9164.65,-8257.7 9037.72,-8325.24 8783.86,-8325.24 8656.93,-8257.7 8783.86,-8190.16 9037.72,-8190.16 9164.65,-8257.7"/>
<text text-anchor="middle" x="8910.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8910.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="8910.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8910.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8910.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_1_1&#45;&gt;layer1_gate_1_1 -->
<g id="edge176" class="edge">
<title>layer1_ln2_1_1&#45;&gt;layer1_gate_1_1</title>
<path fill="none" stroke="black" d="M9208.91,-8375.51C9166.61,-8358.93 9114.47,-8338.5 9065.67,-8319.38"/>
<polygon fill="black" stroke="black" points="9066.87,-8316.09 9056.28,-8315.7 9064.32,-8322.61 9066.87,-8316.09"/>
</g>
<!-- layer1_gate_1_2 -->
<g id="node126" class="node">
<title>layer1_gate_1_2</title>
<polygon fill="purple" stroke="black" points="7060.65,-8257.7 6933.72,-8325.24 6679.86,-8325.24 6552.93,-8257.7 6679.86,-8190.16 6933.72,-8190.16 7060.65,-8257.7"/>
<text text-anchor="middle" x="6806.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6806.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="6806.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6806.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="6806.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_1_2&#45;&gt;layer1_gate_1_2 -->
<g id="edge178" class="edge">
<title>layer1_ln2_1_2&#45;&gt;layer1_gate_1_2</title>
<path fill="none" stroke="black" d="M7697.61,-8400.92C7547.89,-8389.3 7289.03,-8365.36 7069.79,-8325.47 7041.48,-8320.31 7011.7,-8313.82 6982.77,-8306.91"/>
<polygon fill="black" stroke="black" points="6983.53,-8303.5 6972.99,-8304.56 6981.89,-8310.3 6983.53,-8303.5"/>
</g>
<!-- layer1_gate_1_3 -->
<g id="node127" class="node">
<title>layer1_gate_1_3</title>
<polygon fill="purple" stroke="black" points="12320.65,-8257.7 12193.72,-8325.24 11939.86,-8325.24 11812.93,-8257.7 11939.86,-8190.16 12193.72,-8190.16 12320.65,-8257.7"/>
<text text-anchor="middle" x="12066.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12066.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="12066.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="12066.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="12066.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_1_3&#45;&gt;layer1_gate_1_3 -->
<g id="edge180" class="edge">
<title>layer1_ln2_1_3&#45;&gt;layer1_gate_1_3</title>
<path fill="none" stroke="black" d="M11713.23,-8378.02C11768,-8359.53 11838.76,-8335.65 11902.57,-8314.12"/>
<polygon fill="black" stroke="black" points="11903.98,-8317.34 11912.34,-8310.82 11901.74,-8310.7 11903.98,-8317.34"/>
</g>
<!-- layer1_gate_2_0 -->
<g id="node128" class="node">
<title>layer1_gate_2_0</title>
<polygon fill="purple" stroke="black" points="11268.65,-8257.7 11141.72,-8325.24 10887.86,-8325.24 10760.93,-8257.7 10887.86,-8190.16 11141.72,-8190.16 11268.65,-8257.7"/>
<text text-anchor="middle" x="11014.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11014.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="11014.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11014.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11014.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_2_0&#45;&gt;layer1_gate_2_0 -->
<g id="edge182" class="edge">
<title>layer1_ln2_2_0&#45;&gt;layer1_gate_2_0</title>
<path fill="none" stroke="black" d="M10877.04,-8366.93C10891.02,-8355.94 10906.46,-8343.81 10921.8,-8331.76"/>
<polygon fill="black" stroke="black" points="10924.1,-8334.4 10929.8,-8325.47 10919.78,-8328.9 10924.1,-8334.4"/>
</g>
<!-- layer1_gate_2_1 -->
<g id="node129" class="node">
<title>layer1_gate_2_1</title>
<polygon fill="purple" stroke="black" points="7586.65,-8257.7 7459.72,-8325.24 7205.86,-8325.24 7078.93,-8257.7 7205.86,-8190.16 7459.72,-8190.16 7586.65,-8257.7"/>
<text text-anchor="middle" x="7332.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7332.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="7332.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7332.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7332.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_2_1&#45;&gt;layer1_gate_2_1 -->
<g id="edge184" class="edge">
<title>layer1_ln2_2_1&#45;&gt;layer1_gate_2_1</title>
<path fill="none" stroke="black" d="M8183.45,-8392.42C8117.26,-8383.01 8032.99,-8371.47 7957.79,-8362.47 7797.21,-8343.24 7755.04,-8353.66 7595.79,-8325.47 7567.35,-8320.43 7537.44,-8313.98 7508.4,-8307.07"/>
<polygon fill="black" stroke="black" points="7509.13,-8303.65 7498.59,-8304.71 7507.5,-8310.45 7509.13,-8303.65"/>
</g>
<!-- layer1_gate_2_2 -->
<g id="node130" class="node">
<title>layer1_gate_2_2</title>
<polygon fill="purple" stroke="black" points="8112.65,-8257.7 7985.72,-8325.24 7731.86,-8325.24 7604.93,-8257.7 7731.86,-8190.16 7985.72,-8190.16 8112.65,-8257.7"/>
<text text-anchor="middle" x="7858.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7858.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="7858.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7858.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="7858.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_2_2&#45;&gt;layer1_gate_2_2 -->
<g id="edge186" class="edge">
<title>layer1_ln2_2_2&#45;&gt;layer1_gate_2_2</title>
<path fill="none" stroke="black" d="M8566.65,-8386.2C8526,-8377.99 8479.41,-8369.16 8436.79,-8362.47 8297.53,-8340.6 8260.41,-8351.09 8121.79,-8325.47 8093.49,-8320.23 8063.72,-8313.7 8034.79,-8306.78"/>
<polygon fill="black" stroke="black" points="8035.56,-8303.36 8025.02,-8304.42 8033.91,-8310.17 8035.56,-8303.36"/>
</g>
<!-- layer1_gate_2_3 -->
<g id="node131" class="node">
<title>layer1_gate_2_3</title>
<polygon fill="purple" stroke="black" points="13372.65,-8257.7 13245.72,-8325.24 12991.86,-8325.24 12864.93,-8257.7 12991.86,-8190.16 13245.72,-8190.16 13372.65,-8257.7"/>
<text text-anchor="middle" x="13118.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13118.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="13118.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="13118.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13118.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_2_3&#45;&gt;layer1_gate_2_3 -->
<g id="edge188" class="edge">
<title>layer1_ln2_2_3&#45;&gt;layer1_gate_2_3</title>
<path fill="none" stroke="black" d="M12706.62,-8380.37C12774.72,-8360.27 12867,-8333.03 12946.98,-8309.42"/>
<polygon fill="black" stroke="black" points="12948.07,-8312.75 12956.67,-8306.56 12946.08,-8306.03 12948.07,-8312.75"/>
</g>
<!-- layer1_gate_3_0 -->
<g id="node132" class="node">
<title>layer1_gate_3_0</title>
<polygon fill="purple" stroke="black" points="12846.65,-8257.7 12719.72,-8325.24 12465.86,-8325.24 12338.93,-8257.7 12465.86,-8190.16 12719.72,-8190.16 12846.65,-8257.7"/>
<text text-anchor="middle" x="12592.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12592.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="12592.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="12592.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12592.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_3_0&#45;&gt;layer1_gate_3_0 -->
<g id="edge190" class="edge">
<title>layer1_ln2_3_0&#45;&gt;layer1_gate_3_0</title>
<path fill="none" stroke="black" d="M12276.92,-8376.35C12323.17,-8359.12 12381.06,-8337.56 12434.6,-8317.62"/>
<polygon fill="black" stroke="black" points="12436.04,-8320.82 12444.19,-8314.05 12433.6,-8314.26 12436.04,-8320.82"/>
</g>
<!-- layer1_gate_3_1 -->
<g id="node133" class="node">
<title>layer1_gate_3_1</title>
<polygon fill="purple" stroke="black" points="10216.65,-8257.7 10089.72,-8325.24 9835.86,-8325.24 9708.93,-8257.7 9835.86,-8190.16 10089.72,-8190.16 10216.65,-8257.7"/>
<text text-anchor="middle" x="9962.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9962.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="9962.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9962.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9962.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_3_1&#45;&gt;layer1_gate_3_1 -->
<g id="edge192" class="edge">
<title>layer1_ln2_3_1&#45;&gt;layer1_gate_3_1</title>
<path fill="none" stroke="black" d="M9929.72,-8362.65C9932.49,-8353.92 9935.46,-8344.59 9938.44,-8335.24"/>
<polygon fill="black" stroke="black" points="9941.84,-8336.1 9941.53,-8325.51 9935.17,-8333.98 9941.84,-8336.1"/>
</g>
<!-- layer1_gate_3_2 -->
<g id="node134" class="node">
<title>layer1_gate_3_2</title>
<polygon fill="purple" stroke="black" points="6534.65,-8257.7 6407.72,-8325.24 6153.86,-8325.24 6026.93,-8257.7 6153.86,-8190.16 6407.72,-8190.16 6534.65,-8257.7"/>
<text text-anchor="middle" x="6280.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6280.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="6280.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6280.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="6280.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_3_2&#45;&gt;layer1_gate_3_2 -->
<g id="edge194" class="edge">
<title>layer1_ln2_3_2&#45;&gt;layer1_gate_3_2</title>
<path fill="none" stroke="black" d="M7014.68,-8396.21C6894.58,-8382.08 6705.6,-8357.4 6543.79,-8325.47 6515.89,-8319.96 6486.51,-8313.33 6457.92,-8306.43"/>
<polygon fill="black" stroke="black" points="6458.38,-8302.94 6447.84,-8303.97 6456.73,-8309.74 6458.38,-8302.94"/>
</g>
<!-- layer1_gate_3_3 -->
<g id="node135" class="node">
<title>layer1_gate_3_3</title>
<polygon fill="purple" stroke="black" points="9690.65,-8257.7 9563.72,-8325.24 9309.86,-8325.24 9182.93,-8257.7 9309.86,-8190.16 9563.72,-8190.16 9690.65,-8257.7"/>
<text text-anchor="middle" x="9436.79" y="-8284" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9436.79" y="-8269" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="9436.79" y="-8254" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9436.79" y="-8239" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9436.79" y="-8224" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer1_ln2_3_3&#45;&gt;layer1_gate_3_3 -->
<g id="edge196" class="edge">
<title>layer1_ln2_3_3&#45;&gt;layer1_gate_3_3</title>
<path fill="none" stroke="black" d="M9537.66,-8365.1C9528,-8354.91 9517.47,-8343.8 9506.97,-8332.73"/>
<polygon fill="black" stroke="black" points="9509.51,-8330.32 9500.09,-8325.47 9504.43,-8335.14 9509.51,-8330.32"/>
</g>
<!-- layer1_expert1_0 -->
<g id="node136" class="node">
<title>layer1_expert1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="8846.29,-8123.93 8667.29,-8123.93 8667.29,-8055.93 8846.29,-8055.93 8846.29,-8123.93"/>
<text text-anchor="middle" x="8756.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 0 First Linear</text>
<text text-anchor="middle" x="8756.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8756.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="8756.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_0 -->
<g id="edge197" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5917.41,-8208.99C5950.36,-8201.15 5984.97,-8194.19 6017.79,-8189.93 6067.51,-8183.46 7778.98,-8196.32 7822.79,-8171.93 7836.58,-8164.25 7828.18,-8149.92 7841.79,-8141.93 7910.66,-8101.49 8434.38,-8093.11 8657.08,-8091.38"/>
<polygon fill="black" stroke="black" points="8657.16,-8094.88 8667.13,-8091.3 8657.11,-8087.88 8657.16,-8094.88"/>
<text text-anchor="middle" x="7887.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7887.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer1_expert1_1 -->
<g id="node139" class="node">
<title>layer1_expert1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="5198.29,-8123.93 5019.29,-8123.93 5019.29,-8055.93 5198.29,-8055.93 5198.29,-8123.93"/>
<text text-anchor="middle" x="5108.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 1 First Linear</text>
<text text-anchor="middle" x="5108.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5108.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5108.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_1 -->
<g id="edge198" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5511.13,-8252.11C5084.31,-8242.87 4242.16,-8218.78 4197.79,-8171.93 4188.62,-8162.25 4188.63,-8151.62 4197.79,-8141.93 4225.32,-8112.81 4778.59,-8097.86 5009.21,-8092.87"/>
<polygon fill="black" stroke="black" points="5009.36,-8096.37 5019.28,-8092.66 5009.21,-8089.37 5009.36,-8096.37"/>
<text text-anchor="middle" x="4243.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4243.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer1_expert1_2 -->
<g id="node142" class="node">
<title>layer1_expert1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="10556.29,-8123.93 10377.29,-8123.93 10377.29,-8055.93 10556.29,-8055.93 10556.29,-8123.93"/>
<text text-anchor="middle" x="10466.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 2 First Linear</text>
<text text-anchor="middle" x="10466.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10466.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="10466.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_2 -->
<g id="edge199" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5917.05,-8208.94C5950.1,-8201.08 5984.85,-8194.13 6017.79,-8189.93 6067.79,-8183.55 9602.69,-8196.34 9646.79,-8171.93 9660.6,-8164.28 9652.21,-8149.97 9665.79,-8141.93 9724.71,-8107.02 10165.46,-8095.65 10366.89,-8092.25"/>
<polygon fill="black" stroke="black" points="10367.24,-8095.75 10377.18,-8092.08 10367.12,-8088.75 10367.24,-8095.75"/>
<text text-anchor="middle" x="9711.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9711.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer1_expert1_3 -->
<g id="node145" class="node">
<title>layer1_expert1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7022.29,-8123.93 6843.29,-8123.93 6843.29,-8055.93 7022.29,-8055.93 7022.29,-8123.93"/>
<text text-anchor="middle" x="6932.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 3 First Linear</text>
<text text-anchor="middle" x="6932.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6932.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="6932.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_3 -->
<g id="edge200" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5915.14,-8207.8C5943.55,-8197.23 5972.46,-8185.19 5998.79,-8171.93 6019.93,-8161.28 6020.38,-8149.55 6042.79,-8141.93 6115.9,-8117.06 6615.96,-8099.97 6832.82,-8093.64"/>
<polygon fill="black" stroke="black" points="6833.03,-8097.14 6842.93,-8093.35 6832.83,-8090.14 6833.03,-8097.14"/>
<text text-anchor="middle" x="6088.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6088.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer1_expert1_4 -->
<g id="node148" class="node">
<title>layer1_expert1_4</title>
<polygon fill="lightsteelblue" stroke="black" points="16028.29,-8123.93 15849.29,-8123.93 15849.29,-8055.93 16028.29,-8055.93 16028.29,-8123.93"/>
<text text-anchor="middle" x="15938.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 4 First Linear</text>
<text text-anchor="middle" x="15938.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="15938.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="15938.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_4 -->
<g id="edge201" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5917.04,-8208.87C5950.09,-8201.01 5984.84,-8194.08 6017.79,-8189.93 6142.85,-8174.18 14972.19,-8208.57 15092.79,-8171.93 15115.79,-8164.94 15115.02,-8149.62 15137.79,-8141.93 15264.91,-8098.98 15654.07,-8091.79 15839.08,-8090.86"/>
<polygon fill="black" stroke="black" points="15839.1,-8094.36 15849.08,-8090.81 15839.07,-8087.36 15839.1,-8094.36"/>
<text text-anchor="middle" x="15183.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15183.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer1_expert1_5 -->
<g id="node151" class="node">
<title>layer1_expert1_5</title>
<polygon fill="lightsteelblue" stroke="black" points="14204.29,-8123.93 14025.29,-8123.93 14025.29,-8055.93 14204.29,-8055.93 14204.29,-8123.93"/>
<text text-anchor="middle" x="14114.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 5 First Linear</text>
<text text-anchor="middle" x="14114.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14114.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14114.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_5 -->
<g id="edge202" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5917.04,-8208.88C5950.09,-8201.02 5984.84,-8194.09 6017.79,-8189.93 6067.93,-8183.6 13250.55,-8196.35 13294.79,-8171.93 13308.61,-8164.3 13300.21,-8149.97 13313.79,-8141.93 13372.71,-8107.02 13813.46,-8095.65 14014.89,-8092.25"/>
<polygon fill="black" stroke="black" points="14015.24,-8095.75 14025.18,-8092.08 14015.12,-8088.75 14015.24,-8095.75"/>
<text text-anchor="middle" x="13359.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13359.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer1_expert1_6 -->
<g id="node154" class="node">
<title>layer1_expert1_6</title>
<polygon fill="lightsteelblue" stroke="black" points="3488.29,-8123.93 3309.29,-8123.93 3309.29,-8055.93 3488.29,-8055.93 3488.29,-8123.93"/>
<text text-anchor="middle" x="3398.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 6 First Linear</text>
<text text-anchor="middle" x="3398.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3398.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="3398.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_6 -->
<g id="edge203" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5506.09,-8254.84C4752.16,-8248.63 2540.33,-8225.84 2487.79,-8171.93 2478.49,-8162.38 2478.63,-8151.62 2487.79,-8141.93 2515.32,-8112.81 3068.59,-8097.86 3299.21,-8092.87"/>
<polygon fill="black" stroke="black" points="3299.36,-8096.37 3309.28,-8092.66 3299.21,-8089.37 3299.36,-8096.37"/>
<text text-anchor="middle" x="2533.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2533.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer1_expert1_7 -->
<g id="node157" class="node">
<title>layer1_expert1_7</title>
<polygon fill="lightsteelblue" stroke="black" points="12380.29,-8123.93 12201.29,-8123.93 12201.29,-8055.93 12380.29,-8055.93 12380.29,-8123.93"/>
<text text-anchor="middle" x="12290.79" y="-8108.73" font-family="Times,serif" font-size="14.00">Expert 7 First Linear</text>
<text text-anchor="middle" x="12290.79" y="-8093.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12290.79" y="-8078.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12290.79" y="-8063.73" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer1_gate_0_0&#45;&gt;layer1_expert1_7 -->
<g id="edge204" class="edge">
<title>layer1_gate_0_0&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5917.04,-8208.9C5950.1,-8201.04 5984.84,-8194.1 6017.79,-8189.93 6055.36,-8185.17 11437.65,-8190.24 11470.79,-8171.93 11484.61,-8164.29 11476.21,-8149.97 11489.79,-8141.93 11548.71,-8107.02 11989.46,-8095.65 12190.89,-8092.25"/>
<polygon fill="black" stroke="black" points="12191.24,-8095.75 12201.18,-8092.08 12191.12,-8088.75 12191.24,-8095.75"/>
<text text-anchor="middle" x="11535.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11535.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_0 -->
<g id="edge205" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.17,-8208.95C11345.22,-8201.11 11310.61,-8194.17 11277.79,-8189.93 11217.79,-8182.18 9153.94,-8198.92 9099.79,-8171.93 9084.76,-8164.43 9091.22,-8150.53 9076.79,-8141.93 9040.41,-8120.25 8936.14,-8106.43 8856.41,-8098.72"/>
<polygon fill="black" stroke="black" points="8856.61,-8095.23 8846.33,-8097.77 8855.95,-8102.19 8856.61,-8095.23"/>
<text text-anchor="middle" x="9145.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9145.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→0</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_1 -->
<g id="edge206" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.54,-8208.9C11345.49,-8201.03 11310.74,-8194.1 11277.79,-8189.93 11237.65,-8184.85 5488.05,-8189.89 5451.79,-8171.93 5436.74,-8164.47 5443.22,-8150.53 5428.79,-8141.93 5392.41,-8120.25 5288.14,-8106.43 5208.41,-8098.72"/>
<polygon fill="black" stroke="black" points="5208.61,-8095.23 5198.33,-8097.77 5207.95,-8102.19 5208.61,-8095.23"/>
<text text-anchor="middle" x="5497.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5497.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_2 -->
<g id="edge207" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11376.61,-8209.71C11344.1,-8201.91 11310.05,-8194.79 11277.79,-8189.93 11238.85,-8184.05 10958.66,-8190.25 10923.79,-8171.93 10908.92,-8164.11 10915.4,-8150.23 10900.79,-8141.93 10845.55,-8110.53 10676.76,-8098.38 10566.69,-8093.74"/>
<polygon fill="black" stroke="black" points="10566.69,-8090.24 10556.56,-8093.33 10566.4,-8097.23 10566.69,-8090.24"/>
<text text-anchor="middle" x="10969.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10969.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→4</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_3 -->
<g id="edge208" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.54,-8208.93C11345.48,-8201.07 11310.74,-8194.12 11277.79,-8189.93 11222.65,-8182.91 7325.58,-8196.63 7275.79,-8171.93 7260.74,-8164.46 7267.22,-8150.53 7252.79,-8141.93 7216.41,-8120.25 7112.14,-8106.43 7032.41,-8098.72"/>
<polygon fill="black" stroke="black" points="7032.61,-8095.23 7022.33,-8097.77 7031.95,-8102.19 7032.61,-8095.23"/>
<text text-anchor="middle" x="7321.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7321.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→6</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_4 -->
<g id="edge209" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11703.04,-8208.92C11736.1,-8201.05 11770.84,-8194.11 11803.79,-8189.93 11835.27,-8185.93 16350.4,-8194.41 16372.79,-8171.93 16382.2,-8162.48 16381.65,-8151.89 16372.79,-8141.93 16350.94,-8117.36 16159.62,-8102.67 16038.41,-8095.76"/>
<polygon fill="black" stroke="black" points="16038.54,-8092.26 16028.35,-8095.19 16038.14,-8099.25 16038.54,-8092.26"/>
<text text-anchor="middle" x="16424.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16424.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→8</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_5 -->
<g id="edge210" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11703.4,-8208.9C11736.35,-8201.07 11770.97,-8194.14 11803.79,-8189.93 11841.61,-8185.08 14521.92,-8198.97 14548.79,-8171.93 14558.19,-8162.47 14557.65,-8151.89 14548.79,-8141.93 14526.94,-8117.36 14335.62,-8102.67 14214.41,-8095.76"/>
<polygon fill="black" stroke="black" points="14214.54,-8092.26 14204.35,-8095.19 14214.14,-8099.25 14214.54,-8092.26"/>
<text text-anchor="middle" x="14600.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14600.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→10</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_6 -->
<g id="edge211" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.55,-8208.88C11345.49,-8201.02 11310.74,-8194.08 11277.79,-8189.93 11225.87,-8183.38 3788.7,-8195.14 3741.79,-8171.93 3726.73,-8164.48 3733.22,-8150.53 3718.79,-8141.93 3682.41,-8120.25 3578.14,-8106.43 3498.41,-8098.72"/>
<polygon fill="black" stroke="black" points="3498.61,-8095.23 3488.33,-8097.77 3497.95,-8102.19 3498.61,-8095.23"/>
<text text-anchor="middle" x="3787.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3787.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→12</text>
</g>
<!-- layer1_gate_0_1&#45;&gt;layer1_expert1_7 -->
<g id="edge212" class="edge">
<title>layer1_gate_0_1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11703.8,-8209.15C11736.64,-8201.33 11771.11,-8194.34 11803.79,-8189.93 11829.15,-8186.51 12706.88,-8190.2 12724.79,-8171.93 12734.13,-8162.41 12733.65,-8151.89 12724.79,-8141.93 12702.94,-8117.36 12511.62,-8102.67 12390.41,-8095.76"/>
<polygon fill="black" stroke="black" points="12390.54,-8092.26 12380.35,-8095.19 12390.14,-8099.25 12390.54,-8092.26"/>
<text text-anchor="middle" x="12776.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12776.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 1→14</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_0 -->
<g id="edge213" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.31,-8190.15C8400.05,-8172.09 8409.2,-8154.16 8423.79,-8141.93 8458.3,-8113 8571.79,-8100.42 8656.75,-8094.99"/>
<polygon fill="black" stroke="black" points="8657.19,-8098.47 8666.96,-8094.36 8656.76,-8091.48 8657.19,-8098.47"/>
<text text-anchor="middle" x="8469.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8469.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_1 -->
<g id="edge214" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8222.18,-8208.87C8189.23,-8201.04 8154.62,-8194.12 8121.79,-8189.93 8098.69,-8186.98 4784.22,-8188.44 4767.79,-8171.93 4758.39,-8162.47 4759.09,-8152.03 4767.79,-8141.93 4798.45,-8106.34 4919.69,-8095.22 5008.92,-8091.94"/>
<polygon fill="black" stroke="black" points="5009.21,-8095.43 5019.09,-8091.6 5008.97,-8088.44 5009.21,-8095.43"/>
<text text-anchor="middle" x="4813.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4813.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_2 -->
<g id="edge215" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8547.42,-8209.03C8580.37,-8201.18 8614.98,-8194.22 8647.79,-8189.93 8691.01,-8184.27 10178.73,-8193.16 10216.79,-8171.93 10230.57,-8164.24 10222.87,-8150.99 10235.79,-8141.93 10273.92,-8115.18 10323.61,-8102.12 10367.12,-8095.87"/>
<polygon fill="black" stroke="black" points="10367.72,-8099.32 10377.17,-8094.53 10366.8,-8092.38 10367.72,-8099.32"/>
<text text-anchor="middle" x="10281.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10281.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_3 -->
<g id="edge216" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8222.16,-8209.04C8189.21,-8201.19 8154.6,-8194.22 8121.79,-8189.93 8100.72,-8187.17 6606.73,-8187.04 6591.79,-8171.93 6582.42,-8162.44 6583.09,-8152.03 6591.79,-8141.93 6622.45,-8106.34 6743.69,-8095.22 6832.92,-8091.94"/>
<polygon fill="black" stroke="black" points="6833.21,-8095.43 6843.09,-8091.6 6832.97,-8088.44 6833.21,-8095.43"/>
<text text-anchor="middle" x="6637.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6637.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_4 -->
<g id="edge217" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8547.04,-8208.88C8580.09,-8201.02 8614.84,-8194.09 8647.79,-8189.93 8696.3,-8183.8 15645.98,-8195.56 15688.79,-8171.93 15702.61,-8164.3 15694.87,-8150.99 15707.79,-8141.93 15745.92,-8115.18 15795.61,-8102.12 15839.12,-8095.87"/>
<polygon fill="black" stroke="black" points="15839.72,-8099.32 15849.17,-8094.53 15838.8,-8092.38 15839.72,-8099.32"/>
<text text-anchor="middle" x="15753.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15753.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_5 -->
<g id="edge218" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8547.04,-8208.91C8580.1,-8201.04 8614.84,-8194.1 8647.79,-8189.93 8683.73,-8185.37 13833.08,-8189.45 13864.79,-8171.93 13878.61,-8164.29 13870.87,-8150.99 13883.79,-8141.93 13921.92,-8115.18 13971.61,-8102.12 14015.12,-8095.87"/>
<polygon fill="black" stroke="black" points="14015.72,-8099.32 14025.17,-8094.53 14014.8,-8092.38 14015.72,-8099.32"/>
<text text-anchor="middle" x="13929.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13929.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_6 -->
<g id="edge219" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8222.54,-8208.91C8189.49,-8201.04 8154.74,-8194.1 8121.79,-8189.93 8086.9,-8185.5 3082.61,-8196.84 3057.79,-8171.93 3048.38,-8162.48 3049.09,-8152.03 3057.79,-8141.93 3088.45,-8106.34 3209.69,-8095.22 3298.92,-8091.94"/>
<polygon fill="black" stroke="black" points="3299.21,-8095.43 3309.09,-8091.6 3298.97,-8088.44 3299.21,-8095.43"/>
<text text-anchor="middle" x="3103.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3103.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer1_gate_0_2&#45;&gt;layer1_expert1_7 -->
<g id="edge220" class="edge">
<title>layer1_gate_0_2&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8547.4,-8208.87C8580.35,-8201.04 8614.96,-8194.12 8647.79,-8189.93 8694.54,-8183.96 11999.57,-8194.76 12040.79,-8171.93 12054.6,-8164.28 12046.87,-8150.99 12059.79,-8141.93 12097.92,-8115.18 12147.61,-8102.12 12191.12,-8095.87"/>
<polygon fill="black" stroke="black" points="12191.72,-8099.32 12201.17,-8094.53 12190.8,-8092.38 12191.72,-8099.32"/>
<text text-anchor="middle" x="12105.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12105.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_0 -->
<g id="edge221" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10326.16,-8209.08C10293.21,-8201.23 10258.6,-8194.25 10225.79,-8189.93 10188.5,-8185.02 8905.41,-8188.79 8871.79,-8171.93 8856.77,-8164.39 8861.52,-8152.9 8848.79,-8141.93 8843.77,-8137.6 8838.33,-8133.48 8832.68,-8129.58"/>
<polygon fill="black" stroke="black" points="8834.56,-8126.63 8824.29,-8124.05 8830.71,-8132.48 8834.56,-8126.63"/>
<text text-anchor="middle" x="8917.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8917.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_1 -->
<g id="edge222" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10326.54,-8208.91C10293.49,-8201.04 10258.74,-8194.1 10225.79,-8189.93 10156.87,-8181.19 5286.04,-8202.78 5223.79,-8171.93 5208.74,-8164.47 5213.52,-8152.9 5200.79,-8141.93 5195.77,-8137.6 5190.33,-8133.48 5184.68,-8129.58"/>
<polygon fill="black" stroke="black" points="5186.56,-8126.63 5176.29,-8124.05 5182.71,-8132.48 5186.56,-8126.63"/>
<text text-anchor="middle" x="5269.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5269.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→2</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_2 -->
<g id="edge223" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10648.4,-8207.29C10677.67,-8189.98 10693.33,-8168.17 10672.79,-8141.93 10659.01,-8124.32 10612.01,-8111.95 10566.38,-8103.8"/>
<polygon fill="black" stroke="black" points="10566.82,-8100.33 10556.37,-8102.08 10565.63,-8107.23 10566.82,-8100.33"/>
<text text-anchor="middle" x="10727.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10727.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→4</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_3 -->
<g id="edge224" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10326.18,-8208.88C10293.23,-8201.04 10258.62,-8194.12 10225.79,-8189.93 10182.01,-8184.33 7087.32,-8191.57 7047.79,-8171.93 7032.75,-8164.45 7037.52,-8152.9 7024.79,-8141.93 7019.77,-8137.6 7014.33,-8133.48 7008.68,-8129.58"/>
<polygon fill="black" stroke="black" points="7010.56,-8126.63 7000.29,-8124.05 7006.71,-8132.48 7010.56,-8126.63"/>
<text text-anchor="middle" x="7093.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7093.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→6</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_4 -->
<g id="edge225" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10651.04,-8208.9C10684.1,-8201.04 10718.84,-8194.1 10751.79,-8189.93 10788.95,-8185.22 16118.35,-8198.45 16144.79,-8171.93 16185.08,-8131.5 16109.29,-8110.72 16038.55,-8100.4"/>
<polygon fill="black" stroke="black" points="16039,-8096.92 16028.61,-8099.01 16038.03,-8103.86 16039,-8096.92"/>
<text text-anchor="middle" x="16201.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16201.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→8</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_5 -->
<g id="edge226" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10651.05,-8208.95C10684.1,-8201.08 10718.85,-8194.13 10751.79,-8189.93 10776.38,-8186.79 14303.31,-8189.5 14320.79,-8171.93 14361.05,-8131.47 14285.26,-8110.69 14214.53,-8100.38"/>
<polygon fill="black" stroke="black" points="14214.98,-8096.91 14204.6,-8098.99 14214.02,-8103.84 14214.98,-8096.91"/>
<text text-anchor="middle" x="14377.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14377.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→10</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_6 -->
<g id="edge227" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10326.54,-8208.89C10293.49,-8201.02 10258.74,-8194.09 10225.79,-8189.93 10179.55,-8184.09 3555.56,-8192.61 3513.79,-8171.93 3498.73,-8164.47 3503.52,-8152.9 3490.79,-8141.93 3485.77,-8137.6 3480.33,-8133.48 3474.68,-8129.58"/>
<polygon fill="black" stroke="black" points="3476.56,-8126.63 3466.29,-8124.05 3472.71,-8132.48 3476.56,-8126.63"/>
<text text-anchor="middle" x="3559.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3559.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→12</text>
</g>
<!-- layer1_gate_0_3&#45;&gt;layer1_expert1_7 -->
<g id="edge228" class="edge">
<title>layer1_gate_0_3&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10651.42,-8209C10684.36,-8201.16 10718.97,-8194.2 10751.79,-8189.93 10775.83,-8186.8 12479.74,-8189.15 12496.79,-8171.93 12536.94,-8131.36 12461.17,-8110.6 12390.47,-8100.32"/>
<polygon fill="black" stroke="black" points="12390.93,-8096.85 12380.54,-8098.94 12389.97,-8103.78 12390.93,-8096.85"/>
<text text-anchor="middle" x="12553.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12553.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 3→14</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_0 -->
<g id="edge229" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13482.17,-8208.97C13449.22,-8201.12 13414.61,-8194.18 13381.79,-8189.93 13326.64,-8182.78 11429.55,-8196.76 11379.79,-8171.93 11364.76,-8164.43 11371.79,-8149.5 11356.79,-8141.93 11332.29,-8129.56 10396.24,-8124.46 10368.79,-8123.93 9796.35,-8112.85 9109.59,-8098.41 8856.62,-8093.05"/>
<polygon fill="black" stroke="black" points="8856.43,-8089.54 8846.35,-8092.83 8856.28,-8096.54 8856.43,-8089.54"/>
<text text-anchor="middle" x="11425.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11425.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_1 -->
<g id="edge230" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13482.54,-8208.9C13449.49,-8201.03 13414.74,-8194.1 13381.79,-8189.93 13342.84,-8185 7762.16,-8190.91 7727.79,-8171.93 7713.98,-8164.3 7722.54,-8149.67 7708.79,-8141.93 7707.06,-8140.95 5686.14,-8102.03 5208.91,-8092.85"/>
<polygon fill="black" stroke="black" points="5208.67,-8089.35 5198.6,-8092.65 5208.53,-8096.35 5208.67,-8089.35"/>
<text text-anchor="middle" x="7773.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7773.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_2 -->
<g id="edge231" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13478.99,-8210.65C13446.93,-8202.87 13413.45,-8195.52 13381.79,-8189.93 13303.49,-8176.11 13276.88,-8203.24 13203.79,-8171.93 13184.96,-8163.86 13187.94,-8149.21 13168.79,-8141.93 13118.1,-8122.64 12247.01,-8124.95 12192.79,-8123.93 11574.77,-8112.32 10832.28,-8098 10567.01,-8092.87"/>
<polygon fill="black" stroke="black" points="10566.7,-8089.36 10556.63,-8092.67 10566.56,-8096.36 10566.7,-8089.36"/>
<text text-anchor="middle" x="13249.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13249.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_3 -->
<g id="edge232" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13482.54,-8208.94C13449.48,-8201.07 13414.74,-8194.12 13381.79,-8189.93 13329.02,-8183.21 9598.33,-8197.68 9551.79,-8171.93 9537.98,-8164.29 9546.54,-8149.67 9532.79,-8141.93 9531.06,-8140.95 7510.14,-8102.03 7032.91,-8092.85"/>
<polygon fill="black" stroke="black" points="7032.67,-8089.35 7022.6,-8092.65 7032.53,-8096.35 7032.67,-8089.35"/>
<text text-anchor="middle" x="9597.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9597.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_4 -->
<g id="edge233" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13893.53,-8254.88C14650.32,-8248.76 16876.93,-8226.17 16929.79,-8171.93 16939.1,-8162.38 16938.97,-8151.59 16929.79,-8141.93 16899.45,-8109.99 16284.83,-8096.53 16039.07,-8092.41"/>
<polygon fill="black" stroke="black" points="16038.77,-8088.9 16028.71,-8092.24 16038.65,-8095.9 16038.77,-8088.9"/>
<text text-anchor="middle" x="16981.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16981.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_5 -->
<g id="edge234" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13893.05,-8254.67C14633.36,-8248.04 16777.74,-8224.35 16828.79,-8171.93 16838.09,-8162.37 16838.13,-8151.44 16828.79,-8141.93 16809.56,-8122.34 15868.24,-8124.44 15840.79,-8123.93 15222.77,-8112.39 14480.28,-8098.02 14215.01,-8092.87"/>
<polygon fill="black" stroke="black" points="14214.7,-8089.37 14204.63,-8092.67 14214.56,-8096.37 14214.7,-8089.37"/>
<text text-anchor="middle" x="16880.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16880.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_6 -->
<g id="edge235" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13482.55,-8208.88C13449.49,-8201.02 13414.74,-8194.08 13381.79,-8189.93 13330.27,-8183.43 5949.26,-8197.02 5903.79,-8171.93 5889.97,-8164.3 5898.54,-8149.68 5884.79,-8141.93 5884.79,-8141.93 3961.83,-8102.48 3498.39,-8092.97"/>
<polygon fill="black" stroke="black" points="3498.44,-8089.47 3488.37,-8092.76 3498.3,-8096.47 3498.44,-8089.47"/>
<text text-anchor="middle" x="5949.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5949.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer1_gate_1_0&#45;&gt;layer1_expert1_7 -->
<g id="edge236" class="edge">
<title>layer1_gate_1_0&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13884.63,-8250.02C14261.72,-8238.34 14954.54,-8211.6 14991.79,-8171.93 15000.92,-8162.21 15001.13,-8151.44 14991.79,-8141.93 14972.81,-8122.6 14043.87,-8124.44 14016.79,-8123.93 13398.77,-8112.31 12656.28,-8097.99 12391.01,-8092.87"/>
<polygon fill="black" stroke="black" points="12390.7,-8089.36 12380.63,-8092.67 12390.56,-8096.36 12390.7,-8089.36"/>
<text text-anchor="middle" x="15043.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15043.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_0 -->
<g id="edge237" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8743.34,-8211.59C8711.73,-8203.82 8678.84,-8196.22 8647.79,-8189.93 8621.79,-8184.66 8547.08,-8192.05 8529.79,-8171.93 8487.89,-8123.15 8578.1,-8103.75 8656.9,-8096.03"/>
<polygon fill="black" stroke="black" points="8657.31,-8099.5 8666.94,-8095.1 8656.66,-8092.53 8657.31,-8099.5"/>
<text text-anchor="middle" x="8575.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8575.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→0</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_1 -->
<g id="edge238" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8748.54,-8208.94C8715.48,-8201.07 8680.74,-8194.12 8647.79,-8189.93 8621.85,-8186.62 4900.24,-8190.46 4881.79,-8171.93 4836.15,-8126.06 4928.47,-8106.05 5008.74,-8097.4"/>
<polygon fill="black" stroke="black" points="5009.37,-8100.85 5018.96,-8096.35 5008.66,-8093.89 5009.37,-8100.85"/>
<text text-anchor="middle" x="4927.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4927.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→2</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_2 -->
<g id="edge239" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9073.43,-8209.14C9106.38,-8201.28 9140.99,-8194.29 9173.79,-8189.93 9237.52,-8181.46 10274.71,-8203.36 10330.79,-8171.93 10344.56,-8164.21 10337.81,-8152.2 10349.79,-8141.93 10355.46,-8137.07 10361.66,-8132.61 10368.16,-8128.52"/>
<polygon fill="black" stroke="black" points="10370.36,-8131.28 10377.18,-8123.18 10366.79,-8125.26 10370.36,-8131.28"/>
<text text-anchor="middle" x="10395.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10395.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→4</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_3 -->
<g id="edge240" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8748.17,-8208.97C8715.22,-8201.13 8680.61,-8194.18 8647.79,-8189.93 8621.04,-8186.46 6724.78,-8191.09 6705.79,-8171.93 6660.25,-8125.96 6752.55,-8105.97 6832.79,-8097.35"/>
<polygon fill="black" stroke="black" points="6833.41,-8100.8 6843.01,-8096.3 6832.7,-8093.84 6833.41,-8100.8"/>
<text text-anchor="middle" x="6751.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6751.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→6</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_4 -->
<g id="edge241" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9073.04,-8208.89C9106.09,-8201.02 9140.84,-8194.09 9173.79,-8189.93 9219.46,-8184.16 15762.49,-8194.18 15802.79,-8171.93 15816.61,-8164.3 15809.81,-8152.2 15821.79,-8141.93 15827.46,-8137.07 15833.66,-8132.61 15840.16,-8128.52"/>
<polygon fill="black" stroke="black" points="15842.36,-8131.28 15849.18,-8123.18 15838.79,-8125.26 15842.36,-8131.28"/>
<text text-anchor="middle" x="15867.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15867.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→8</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_5 -->
<g id="edge242" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9073.04,-8208.91C9106.1,-8201.05 9140.84,-8194.11 9173.79,-8189.93 9206.89,-8185.73 13949.59,-8188.07 13978.79,-8171.93 13992.6,-8164.29 13985.81,-8152.2 13997.79,-8141.93 14003.46,-8137.07 14009.66,-8132.61 14016.16,-8128.52"/>
<polygon fill="black" stroke="black" points="14018.36,-8131.28 14025.18,-8123.18 14014.79,-8125.26 14018.36,-8131.28"/>
<text text-anchor="middle" x="14043.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14043.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→10</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_6 -->
<g id="edge243" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8748.54,-8208.9C8715.49,-8201.04 8680.74,-8194.1 8647.79,-8189.93 8610.06,-8185.15 3198.64,-8198.86 3171.79,-8171.93 3126.11,-8126.1 3218.44,-8106.08 3298.72,-8097.41"/>
<polygon fill="black" stroke="black" points="3299.36,-8100.87 3308.95,-8096.36 3298.64,-8093.9 3299.36,-8100.87"/>
<text text-anchor="middle" x="3217.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3217.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→12</text>
</g>
<!-- layer1_gate_1_1&#45;&gt;layer1_expert1_7 -->
<g id="edge244" class="edge">
<title>layer1_gate_1_1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9073.4,-8208.89C9106.35,-8201.05 9140.97,-8194.13 9173.79,-8189.93 9214.86,-8184.67 12118.58,-8192 12154.79,-8171.93 12168.6,-8164.28 12161.81,-8152.2 12173.79,-8141.93 12179.46,-8137.07 12185.66,-8132.61 12192.16,-8128.52"/>
<polygon fill="black" stroke="black" points="12194.36,-8131.28 12201.18,-8123.18 12190.79,-8125.26 12194.36,-8131.28"/>
<text text-anchor="middle" x="12219.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12219.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 5→14</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_0 -->
<g id="edge245" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6969.79,-8209.12C7002.64,-8201.3 7037.11,-8194.32 7069.79,-8189.93 7123.82,-8182.67 8003.28,-8198.65 8050.79,-8171.93 8064.55,-8164.19 8056.26,-8150.04 8069.79,-8141.93 8118.87,-8112.49 8478.62,-8098.56 8657.03,-8093.41"/>
<polygon fill="black" stroke="black" points="8657.32,-8096.9 8667.21,-8093.12 8657.12,-8089.9 8657.32,-8096.9"/>
<text text-anchor="middle" x="8115.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8115.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_1 -->
<g id="edge246" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.17,-8208.95C6611.22,-8201.11 6576.61,-8194.17 6543.79,-8189.93 6514.62,-8186.16 4446.5,-8192.82 4425.79,-8171.93 4416.4,-8162.46 4416.72,-8151.7 4425.79,-8141.93 4464.59,-8100.12 4828.91,-8092.33 5008.99,-8091.05"/>
<polygon fill="black" stroke="black" points="5009.03,-8094.55 5019.01,-8090.99 5008.98,-8087.55 5009.03,-8094.55"/>
<text text-anchor="middle" x="4471.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4471.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_2 -->
<g id="edge247" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6969.4,-8208.9C7002.35,-8201.06 7036.97,-8194.14 7069.79,-8189.93 7108.43,-8184.97 9840.72,-8190.82 9874.79,-8171.93 9888.59,-8164.27 9880.32,-8150.14 9893.79,-8141.93 9933.13,-8117.95 10213.42,-8102.04 10366.9,-8095.03"/>
<polygon fill="black" stroke="black" points="10367.44,-8098.51 10377.27,-8094.56 10367.12,-8091.51 10367.44,-8098.51"/>
<text text-anchor="middle" x="9939.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9939.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_3 -->
<g id="edge248" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6642.57,-8209.98C6610.06,-8202.16 6576.02,-8194.96 6543.79,-8189.93 6511.46,-8184.88 6272.22,-8195.77 6249.79,-8171.93 6240.66,-8162.22 6240.72,-8151.7 6249.79,-8141.93 6288.59,-8100.12 6652.91,-8092.33 6832.99,-8091.05"/>
<polygon fill="black" stroke="black" points="6833.03,-8094.55 6843.01,-8090.99 6832.98,-8087.55 6833.03,-8094.55"/>
<text text-anchor="middle" x="6295.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6295.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_4 -->
<g id="edge249" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6969.04,-8208.87C7002.09,-8201.01 7036.84,-8194.08 7069.79,-8189.93 7126.82,-8182.74 15296.46,-8199.7 15346.79,-8171.93 15360.61,-8164.3 15352.32,-8150.14 15365.79,-8141.93 15405.13,-8117.95 15685.42,-8102.04 15838.9,-8095.03"/>
<polygon fill="black" stroke="black" points="15839.44,-8098.51 15849.27,-8094.56 15839.12,-8091.51 15839.44,-8098.51"/>
<text text-anchor="middle" x="15411.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15411.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_5 -->
<g id="edge250" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6969.04,-8208.89C7002.09,-8201.03 7036.84,-8194.09 7069.79,-8189.93 7114.25,-8184.31 13483.56,-8193.59 13522.79,-8171.93 13536.61,-8164.3 13528.32,-8150.14 13541.79,-8141.93 13581.13,-8117.95 13861.42,-8102.04 14014.9,-8095.03"/>
<polygon fill="black" stroke="black" points="14015.44,-8098.51 14025.27,-8094.56 14015.12,-8091.51 14015.44,-8098.51"/>
<text text-anchor="middle" x="13587.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13587.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_6 -->
<g id="edge251" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.54,-8208.94C6611.48,-8201.07 6576.74,-8194.12 6543.79,-8189.93 6517.42,-8186.57 2734.54,-8190.77 2715.79,-8171.93 2706.39,-8162.48 2706.72,-8151.7 2715.79,-8141.93 2754.59,-8100.12 3118.91,-8092.33 3298.99,-8091.05"/>
<polygon fill="black" stroke="black" points="3299.03,-8094.55 3309.01,-8090.99 3298.98,-8087.55 3299.03,-8094.55"/>
<text text-anchor="middle" x="2761.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2761.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer1_gate_1_2&#45;&gt;layer1_expert1_7 -->
<g id="edge252" class="edge">
<title>layer1_gate_1_2&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6969.04,-8208.92C7002.1,-8201.05 7036.84,-8194.11 7069.79,-8189.93 7133.57,-8181.83 11642.53,-8203.04 11698.79,-8171.93 11712.6,-8164.29 11704.32,-8150.14 11717.79,-8141.93 11757.13,-8117.95 12037.42,-8102.04 12190.9,-8095.03"/>
<polygon fill="black" stroke="black" points="12191.44,-8098.51 12201.27,-8094.56 12191.12,-8091.51 12191.44,-8098.51"/>
<text text-anchor="middle" x="11763.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11763.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_0 -->
<g id="edge253" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11904.18,-8208.91C11871.23,-8201.08 11836.62,-8194.14 11803.79,-8189.93 11732.43,-8180.76 9278.2,-8203.99 9213.79,-8171.93 9198.75,-8164.44 9205.4,-8150.23 9190.79,-8141.93 9135.55,-8110.53 8966.76,-8098.38 8856.69,-8093.74"/>
<polygon fill="black" stroke="black" points="8856.69,-8090.24 8846.56,-8093.33 8856.4,-8097.23 8856.69,-8090.24"/>
<text text-anchor="middle" x="9259.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9259.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→0</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_1 -->
<g id="edge254" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11904.54,-8208.89C11871.49,-8201.03 11836.74,-8194.09 11803.79,-8189.93 11760.81,-8184.49 5604.61,-8191.15 5565.79,-8171.93 5550.74,-8164.47 5557.4,-8150.23 5542.79,-8141.93 5487.55,-8110.53 5318.76,-8098.38 5208.69,-8093.74"/>
<polygon fill="black" stroke="black" points="5208.69,-8090.24 5198.56,-8093.33 5208.4,-8097.23 5208.69,-8090.24"/>
<text text-anchor="middle" x="5611.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5611.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→2</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_2 -->
<g id="edge255" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11903.77,-8209.26C11870.93,-8201.42 11836.46,-8194.4 11803.79,-8189.93 11761.62,-8184.15 11075.74,-8191.21 11037.79,-8171.93 11022.81,-8164.32 11029.5,-8150.05 11014.79,-8141.93 10940.13,-8100.68 10703.09,-8092.16 10566.46,-8090.78"/>
<polygon fill="black" stroke="black" points="10566.42,-8087.28 10556.39,-8090.69 10566.36,-8094.28 10566.42,-8087.28"/>
<text text-anchor="middle" x="11083.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11083.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→4</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_3 -->
<g id="edge256" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11904.54,-8208.92C11871.48,-8201.06 11836.74,-8194.11 11803.79,-8189.93 11742.97,-8182.2 7444.71,-8199.17 7389.79,-8171.93 7374.74,-8164.46 7381.4,-8150.23 7366.79,-8141.93 7311.55,-8110.53 7142.76,-8098.38 7032.69,-8093.74"/>
<polygon fill="black" stroke="black" points="7032.69,-8090.24 7022.56,-8093.33 7032.4,-8097.23 7032.69,-8090.24"/>
<text text-anchor="middle" x="7435.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7435.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→6</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_4 -->
<g id="edge257" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12229.04,-8208.93C12262.1,-8201.06 12296.85,-8194.12 12329.79,-8189.93 12358.43,-8186.29 16466.42,-8192.38 16486.79,-8171.93 16496.2,-8162.48 16495.77,-8151.78 16486.79,-8141.93 16457.26,-8109.52 16188.41,-8097.37 16038.57,-8093.08"/>
<polygon fill="black" stroke="black" points="16038.53,-8089.58 16028.43,-8092.8 16038.33,-8096.58 16038.53,-8089.58"/>
<text text-anchor="middle" x="16538.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16538.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→8</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_5 -->
<g id="edge258" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12229.41,-8208.93C12262.36,-8201.09 12296.97,-8194.16 12329.79,-8189.93 12361.93,-8185.79 14639.97,-8194.93 14662.79,-8171.93 14672.18,-8162.46 14671.77,-8151.78 14662.79,-8141.93 14633.26,-8109.52 14364.41,-8097.37 14214.57,-8093.08"/>
<polygon fill="black" stroke="black" points="14214.53,-8089.58 14204.43,-8092.8 14214.33,-8096.58 14214.53,-8089.58"/>
<text text-anchor="middle" x="14714.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14714.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→10</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_6 -->
<g id="edge259" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11904.55,-8208.87C11871.49,-8201.01 11836.74,-8194.08 11803.79,-8189.93 11749.03,-8183.02 3905.26,-8196.41 3855.79,-8171.93 3840.73,-8164.48 3847.4,-8150.23 3832.79,-8141.93 3777.55,-8110.53 3608.76,-8098.38 3498.69,-8093.74"/>
<polygon fill="black" stroke="black" points="3498.69,-8090.24 3488.56,-8093.33 3498.4,-8097.23 3498.69,-8090.24"/>
<text text-anchor="middle" x="3901.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3901.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→12</text>
</g>
<!-- layer1_gate_1_3&#45;&gt;layer1_expert1_7 -->
<g id="edge260" class="edge">
<title>layer1_gate_1_3&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12230.21,-8209.48C12262.94,-8201.65 12297.26,-8194.58 12329.79,-8189.93 12357.8,-8185.92 12819.14,-8192.29 12838.79,-8171.93 12848.05,-8162.33 12847.77,-8151.78 12838.79,-8141.93 12809.26,-8109.52 12540.41,-8097.37 12390.57,-8093.08"/>
<polygon fill="black" stroke="black" points="12390.53,-8089.58 12380.43,-8092.8 12390.33,-8096.58 12390.53,-8089.58"/>
<text text-anchor="middle" x="12890.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12890.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 7→14</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_0 -->
<g id="edge261" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10852.17,-8209C10819.22,-8201.15 10784.61,-8194.2 10751.79,-8189.93 10703.14,-8183.6 9029.67,-8193.86 8985.79,-8171.93 8970.76,-8164.42 8976.85,-8151.13 8962.79,-8141.93 8931.31,-8121.31 8892.15,-8109.03 8856.46,-8101.71"/>
<polygon fill="black" stroke="black" points="8856.97,-8098.25 8846.49,-8099.77 8855.64,-8105.12 8856.97,-8098.25"/>
<text text-anchor="middle" x="9031.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9031.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_1 -->
<g id="edge262" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10852.54,-8208.9C10819.49,-8201.04 10784.74,-8194.1 10751.79,-8189.93 10714.49,-8185.2 5371.48,-8188.62 5337.79,-8171.93 5322.74,-8164.47 5328.85,-8151.13 5314.79,-8141.93 5283.31,-8121.31 5244.15,-8109.03 5208.46,-8101.71"/>
<polygon fill="black" stroke="black" points="5208.97,-8098.25 5198.49,-8099.77 5207.64,-8105.12 5208.97,-8098.25"/>
<text text-anchor="middle" x="5383.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5383.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_2 -->
<g id="edge263" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10865.31,-8202.07C10846.1,-8192.99 10827.11,-8182.91 10809.79,-8171.93 10793.05,-8161.32 10794.64,-8150.56 10776.79,-8141.93 10711.21,-8110.21 10629.67,-8097.71 10566.69,-8093"/>
<polygon fill="black" stroke="black" points="10566.56,-8089.49 10556.35,-8092.29 10566.08,-8096.47 10566.56,-8089.49"/>
<text text-anchor="middle" x="10855.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10855.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_3 -->
<g id="edge264" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10852.54,-8208.95C10819.48,-8201.08 10784.74,-8194.13 10751.79,-8189.93 10702.33,-8183.62 7206.45,-8194.1 7161.79,-8171.93 7146.74,-8164.46 7152.85,-8151.13 7138.79,-8141.93 7107.31,-8121.31 7068.15,-8109.03 7032.46,-8101.71"/>
<polygon fill="black" stroke="black" points="7032.97,-8098.25 7022.49,-8099.77 7031.64,-8105.12 7032.97,-8098.25"/>
<text text-anchor="middle" x="7207.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7207.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_4 -->
<g id="edge265" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11177.04,-8208.91C11210.1,-8201.05 11244.84,-8194.1 11277.79,-8189.93 11312.11,-8185.58 16234.38,-8196.43 16258.79,-8171.93 16268.2,-8162.48 16267.45,-8152.07 16258.79,-8141.93 16230.81,-8109.13 16121.63,-8097.32 16038.51,-8093.13"/>
<polygon fill="black" stroke="black" points="16038.66,-8089.63 16028.51,-8092.66 16038.33,-8096.63 16038.66,-8089.63"/>
<text text-anchor="middle" x="16310.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16310.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_5 -->
<g id="edge266" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11177.4,-8208.88C11210.35,-8201.05 11244.97,-8194.12 11277.79,-8189.93 11299.54,-8187.15 14419.33,-8187.47 14434.79,-8171.93 14444.19,-8162.47 14443.45,-8152.07 14434.79,-8141.93 14406.81,-8109.13 14297.63,-8097.32 14214.51,-8093.13"/>
<polygon fill="black" stroke="black" points="14214.66,-8089.63 14204.51,-8092.66 14214.33,-8096.63 14214.66,-8089.63"/>
<text text-anchor="middle" x="14486.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14486.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_6 -->
<g id="edge267" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10852.54,-8208.88C10819.49,-8201.02 10784.74,-8194.09 10751.79,-8189.93 10702.71,-8183.73 3672.13,-8193.87 3627.79,-8171.93 3612.73,-8164.47 3618.85,-8151.13 3604.79,-8141.93 3573.31,-8121.31 3534.15,-8109.03 3498.46,-8101.71"/>
<polygon fill="black" stroke="black" points="3498.97,-8098.25 3488.49,-8099.77 3497.64,-8105.12 3498.97,-8098.25"/>
<text text-anchor="middle" x="3673.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3673.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer1_gate_2_0&#45;&gt;layer1_expert1_7 -->
<g id="edge268" class="edge">
<title>layer1_gate_2_0&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11177.43,-8209.08C11210.37,-8201.23 11244.98,-8194.25 11277.79,-8189.93 11314.5,-8185.09 12584.78,-8198.29 12610.79,-8171.93 12620.16,-8162.44 12619.45,-8152.07 12610.79,-8141.93 12582.81,-8109.13 12473.63,-8097.32 12390.51,-8093.13"/>
<polygon fill="black" stroke="black" points="12390.66,-8089.63 12380.51,-8092.66 12390.33,-8096.63 12390.66,-8089.63"/>
<text text-anchor="middle" x="12662.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12662.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_0 -->
<g id="edge269" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7496.19,-8209.38C7528.93,-8201.56 7563.26,-8194.52 7595.79,-8189.93 7658.43,-8181.09 8109.86,-8203.3 8164.79,-8171.93 8178.5,-8164.1 8170.32,-8150.14 8183.79,-8141.93 8223.13,-8117.95 8503.42,-8102.04 8656.9,-8095.03"/>
<polygon fill="black" stroke="black" points="8657.44,-8098.51 8667.27,-8094.56 8657.12,-8091.51 8657.44,-8098.51"/>
<text text-anchor="middle" x="8229.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8229.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→0</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_1 -->
<g id="edge270" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7170.18,-8208.92C7137.23,-8201.08 7102.61,-8194.15 7069.79,-8189.93 7034.94,-8185.45 4564.55,-8196.86 4539.79,-8171.93 4472.09,-8103.74 4828.36,-8092.31 5008.95,-8090.82"/>
<polygon fill="black" stroke="black" points="5009.02,-8094.32 5019,-8090.75 5008.97,-8087.32 5009.02,-8094.32"/>
<text text-anchor="middle" x="4585.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4585.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→2</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_2 -->
<g id="edge271" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7495.41,-8208.93C7528.36,-8201.09 7562.97,-8194.15 7595.79,-8189.93 7661.72,-8181.44 9930.68,-8204.2 9988.79,-8171.93 10002.59,-8164.27 9994.41,-8150.29 10007.79,-8141.93 10065.77,-8105.7 10250.18,-8095.11 10366.85,-8092.07"/>
<polygon fill="black" stroke="black" points="10366.97,-8095.57 10376.88,-8091.83 10366.79,-8088.57 10366.97,-8095.57"/>
<text text-anchor="middle" x="10053.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10053.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→4</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_3 -->
<g id="edge272" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7169.76,-8209.31C7136.92,-8201.47 7102.46,-8194.43 7069.79,-8189.93 7030.92,-8184.57 6391.18,-8200.02 6363.79,-8171.93 6296.71,-8103.12 6652.67,-8092 6833.06,-8090.71"/>
<polygon fill="black" stroke="black" points="6833.12,-8094.21 6843.1,-8090.65 6833.08,-8087.21 6833.12,-8094.21"/>
<text text-anchor="middle" x="6409.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6409.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→6</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_4 -->
<g id="edge273" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7495.04,-8208.88C7528.09,-8201.01 7562.84,-8194.08 7595.79,-8189.93 7649.98,-8183.09 15412.97,-8198.32 15460.79,-8171.93 15474.61,-8164.3 15466.41,-8150.29 15479.79,-8141.93 15537.77,-8105.7 15722.18,-8095.11 15838.85,-8092.07"/>
<polygon fill="black" stroke="black" points="15838.97,-8095.57 15848.88,-8091.83 15838.79,-8088.57 15838.97,-8095.57"/>
<text text-anchor="middle" x="15525.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15525.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→8</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_5 -->
<g id="edge274" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7495.04,-8208.89C7528.1,-8201.03 7562.84,-8194.09 7595.79,-8189.93 7637.41,-8184.66 13600.07,-8192.21 13636.79,-8171.93 13650.61,-8164.3 13642.41,-8150.29 13655.79,-8141.93 13713.77,-8105.7 13898.18,-8095.11 14014.85,-8092.07"/>
<polygon fill="black" stroke="black" points="14014.97,-8095.57 14024.88,-8091.83 14014.79,-8088.57 14014.97,-8095.57"/>
<text text-anchor="middle" x="13701.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13701.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→10</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_6 -->
<g id="edge275" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7170.54,-8208.93C7137.48,-8201.06 7102.74,-8194.12 7069.79,-8189.93 7040.58,-8186.21 2850.57,-8192.79 2829.79,-8171.93 2761.99,-8103.84 3118.31,-8092.35 3298.93,-8090.84"/>
<polygon fill="black" stroke="black" points="3299.01,-8094.34 3308.98,-8090.77 3298.96,-8087.34 3299.01,-8094.34"/>
<text text-anchor="middle" x="2875.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2875.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→12</text>
</g>
<!-- layer1_gate_2_1&#45;&gt;layer1_expert1_7 -->
<g id="edge276" class="edge">
<title>layer1_gate_2_1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7495.04,-8208.93C7528.1,-8201.06 7562.85,-8194.12 7595.79,-8189.93 7653.89,-8182.54 11761.54,-8200.28 11812.79,-8171.93 11826.6,-8164.29 11818.41,-8150.29 11831.79,-8141.93 11889.77,-8105.7 12074.18,-8095.11 12190.85,-8092.07"/>
<polygon fill="black" stroke="black" points="12190.97,-8095.57 12200.88,-8091.83 12190.79,-8088.57 12190.97,-8095.57"/>
<text text-anchor="middle" x="11877.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11877.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 9→14</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_0 -->
<g id="edge277" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8025,-8210.91C8056.96,-8203.13 8090.28,-8195.71 8121.79,-8189.93 8190.87,-8177.26 8216.08,-8203.55 8278.79,-8171.93 8295.08,-8163.72 8290.5,-8150.13 8306.79,-8141.93 8366.19,-8112.03 8543.54,-8099.38 8657.05,-8094.23"/>
<polygon fill="black" stroke="black" points="8657.32,-8097.72 8667.15,-8093.79 8657.01,-8090.73 8657.32,-8097.72"/>
<text text-anchor="middle" x="8352.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8352.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_1 -->
<g id="edge278" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7696.18,-8208.89C7663.23,-8201.06 7628.62,-8194.13 7595.79,-8189.93 7555.26,-8184.74 4682.6,-8200.91 4653.79,-8171.93 4644.39,-8162.47 4644.9,-8151.87 4653.79,-8141.93 4677.04,-8115.93 4882.24,-8101.61 5009,-8095.17"/>
<polygon fill="black" stroke="black" points="5009.31,-8098.66 5019.12,-8094.67 5008.96,-8091.67 5009.31,-8098.66"/>
<text text-anchor="middle" x="4699.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4699.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_2 -->
<g id="edge279" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8021.41,-8208.97C8054.36,-8201.13 8088.97,-8194.18 8121.79,-8189.93 8176.37,-8182.86 10054.7,-8198.68 10102.79,-8171.93 10116.58,-8164.25 10108.56,-8150.53 10121.79,-8141.93 10161.22,-8116.29 10279.84,-8102.99 10367.02,-8096.49"/>
<polygon fill="black" stroke="black" points="10367.5,-8099.97 10377.22,-8095.75 10366.99,-8092.98 10367.5,-8099.97"/>
<text text-anchor="middle" x="10167.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10167.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_3 -->
<g id="edge280" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7696.15,-8209.15C7663.2,-8201.29 7628.6,-8194.29 7595.79,-8189.93 7565,-8185.83 6499.58,-8194.07 6477.79,-8171.93 6468.44,-8162.42 6468.9,-8151.87 6477.79,-8141.93 6501.04,-8115.93 6706.24,-8101.61 6833,-8095.17"/>
<polygon fill="black" stroke="black" points="6833.31,-8098.66 6843.12,-8094.67 6832.96,-8091.67 6833.31,-8098.66"/>
<text text-anchor="middle" x="6523.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6523.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_4 -->
<g id="edge281" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8021.04,-8208.88C8054.09,-8201.02 8088.84,-8194.08 8121.79,-8189.93 8173.14,-8183.45 15529.48,-8196.94 15574.79,-8171.93 15588.61,-8164.3 15580.56,-8150.53 15593.79,-8141.93 15633.22,-8116.29 15751.84,-8102.99 15839.02,-8096.49"/>
<polygon fill="black" stroke="black" points="15839.5,-8099.97 15849.22,-8095.75 15838.99,-8092.98 15839.5,-8099.97"/>
<text text-anchor="middle" x="15639.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15639.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_5 -->
<g id="edge282" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8021.04,-8208.9C8054.1,-8201.04 8088.84,-8194.1 8121.79,-8189.93 8160.57,-8185.02 13716.57,-8190.83 13750.79,-8171.93 13764.61,-8164.3 13756.56,-8150.53 13769.79,-8141.93 13809.22,-8116.29 13927.84,-8102.99 14015.02,-8096.49"/>
<polygon fill="black" stroke="black" points="14015.5,-8099.97 14025.22,-8095.75 14014.99,-8092.98 14015.5,-8099.97"/>
<text text-anchor="middle" x="13815.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13815.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_6 -->
<g id="edge283" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7696.54,-8208.92C7663.48,-8201.05 7628.74,-8194.11 7595.79,-8189.93 7563.74,-8185.86 2966.59,-8194.82 2943.79,-8171.93 2934.38,-8162.48 2934.9,-8151.87 2943.79,-8141.93 2967.04,-8115.93 3172.24,-8101.61 3299,-8095.17"/>
<polygon fill="black" stroke="black" points="3299.31,-8098.66 3309.12,-8094.67 3298.96,-8091.67 3299.31,-8098.66"/>
<text text-anchor="middle" x="2989.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2989.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer1_gate_2_2&#45;&gt;layer1_expert1_7 -->
<g id="edge284" class="edge">
<title>layer1_gate_2_2&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8021.04,-8208.94C8054.1,-8201.07 8088.85,-8194.12 8121.79,-8189.93 8174.22,-8183.25 11880.55,-8197.52 11926.79,-8171.93 11940.6,-8164.28 11932.56,-8150.53 11945.79,-8141.93 11985.22,-8116.29 12103.84,-8102.99 12191.02,-8096.49"/>
<polygon fill="black" stroke="black" points="12191.5,-8099.97 12201.22,-8095.75 12190.99,-8092.98 12191.5,-8099.97"/>
<text text-anchor="middle" x="11991.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11991.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_0 -->
<g id="edge285" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12956.54,-8208.95C12923.48,-8201.08 12888.74,-8194.13 12855.79,-8189.93 12808.76,-8183.92 9484.26,-8193.02 9441.79,-8171.93 9426.74,-8164.45 9433.56,-8149.93 9418.79,-8141.93 9370.67,-8115.84 9029.44,-8100.38 8856.6,-8094.15"/>
<polygon fill="black" stroke="black" points="8856.6,-8090.65 8846.48,-8093.79 8856.35,-8097.64 8856.6,-8090.65"/>
<text text-anchor="middle" x="9487.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9487.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→0</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_1 -->
<g id="edge286" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12956.54,-8208.88C12923.49,-8201.02 12888.74,-8194.09 12855.79,-8189.93 12807.14,-8183.78 5837.74,-8193.68 5793.79,-8171.93 5778.73,-8164.47 5785.56,-8149.93 5770.79,-8141.93 5722.67,-8115.84 5381.44,-8100.38 5208.6,-8094.15"/>
<polygon fill="black" stroke="black" points="5208.6,-8090.65 5198.48,-8093.79 5208.35,-8097.64 5208.6,-8090.65"/>
<text text-anchor="middle" x="5839.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5839.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→2</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_2 -->
<g id="edge287" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12956.16,-8209.03C12923.22,-8201.18 12888.61,-8194.22 12855.79,-8189.93 12811.99,-8184.2 11305.29,-8191.7 11265.79,-8171.93 11250.77,-8164.41 11257.61,-8149.85 11242.79,-8141.93 11184.61,-8110.81 10762.83,-8097.48 10566.65,-8092.91"/>
<polygon fill="black" stroke="black" points="10566.7,-8089.41 10556.62,-8092.68 10566.54,-8096.41 10566.7,-8089.41"/>
<text text-anchor="middle" x="11311.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11311.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→4</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_3 -->
<g id="edge288" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12956.54,-8208.91C12923.49,-8201.04 12888.74,-8194.1 12855.79,-8189.93 12783.62,-8180.78 7682.98,-8204.23 7617.79,-8171.93 7602.74,-8164.47 7609.56,-8149.93 7594.79,-8141.93 7546.67,-8115.84 7205.44,-8100.38 7032.6,-8094.15"/>
<polygon fill="black" stroke="black" points="7032.6,-8090.65 7022.48,-8093.79 7032.35,-8097.64 7032.6,-8090.65"/>
<text text-anchor="middle" x="7663.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7663.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→6</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_4 -->
<g id="edge289" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13281.4,-8208.87C13314.35,-8201.04 13348.96,-8194.12 13381.79,-8189.93 13404.75,-8187 16698.47,-8188.34 16714.79,-8171.93 16724.19,-8162.47 16723.91,-8151.66 16714.79,-8141.93 16669.52,-8093.59 16237.78,-8089.39 16038.59,-8090.06"/>
<polygon fill="black" stroke="black" points="16038.4,-8086.56 16028.41,-8090.1 16038.43,-8093.56 16038.4,-8086.56"/>
<text text-anchor="middle" x="16766.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16766.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→8</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_5 -->
<g id="edge290" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13281.42,-8209.04C13314.37,-8201.19 13348.98,-8194.23 13381.79,-8189.93 13402.57,-8187.2 14876.06,-8186.84 14890.79,-8171.93 14900.16,-8162.44 14899.91,-8151.66 14890.79,-8141.93 14845.52,-8093.59 14413.78,-8089.39 14214.59,-8090.06"/>
<polygon fill="black" stroke="black" points="14214.4,-8086.56 14204.41,-8090.1 14214.43,-8093.56 14214.4,-8086.56"/>
<text text-anchor="middle" x="14942.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14942.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→10</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_6 -->
<g id="edge291" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12956.55,-8208.87C12923.49,-8201.01 12888.74,-8194.08 12855.79,-8189.93 12795.44,-8182.32 4153.96,-8192.69 4096.79,-8171.93 4077.22,-8164.82 4080.09,-8149.76 4060.79,-8141.93 3961.64,-8101.66 3658.08,-8092.97 3498.77,-8091.24"/>
<polygon fill="black" stroke="black" points="3498.53,-8087.74 3488.49,-8091.14 3498.46,-8094.74 3498.53,-8087.74"/>
<text text-anchor="middle" x="4142.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4142.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→12</text>
</g>
<!-- layer1_gate_2_3&#45;&gt;layer1_expert1_7 -->
<g id="edge292" class="edge">
<title>layer1_gate_2_3&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13087.83,-8189.92C13075.83,-8171.27 13060.22,-8153.08 13040.79,-8141.93 12985.78,-8110.36 12581.84,-8097.33 12390.62,-8092.88"/>
<polygon fill="black" stroke="black" points="12390.64,-8089.38 12380.57,-8092.65 12390.48,-8096.38 12390.64,-8089.38"/>
<text text-anchor="middle" x="13119.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13119.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 11→14</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_0 -->
<g id="edge293" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12430.18,-8208.89C12397.23,-8201.05 12362.62,-8194.13 12329.79,-8189.93 12288.43,-8184.63 9365.13,-8190.49 9327.79,-8171.93 9312.75,-8164.45 9319.5,-8150.05 9304.79,-8141.93 9230.13,-8100.68 8993.09,-8092.16 8856.46,-8090.78"/>
<polygon fill="black" stroke="black" points="8856.42,-8087.28 8846.39,-8090.69 8856.36,-8094.28 8856.42,-8087.28"/>
<text text-anchor="middle" x="9373.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9373.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_1 -->
<g id="edge294" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12430.54,-8208.89C12397.49,-8201.02 12362.74,-8194.09 12329.79,-8189.93 12283.97,-8184.14 5721.18,-8192.42 5679.79,-8171.93 5664.73,-8164.47 5671.5,-8150.05 5656.79,-8141.93 5582.13,-8100.68 5345.09,-8092.16 5208.46,-8090.78"/>
<polygon fill="black" stroke="black" points="5208.42,-8087.28 5198.39,-8090.69 5208.36,-8094.28 5208.42,-8087.28"/>
<text text-anchor="middle" x="5725.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5725.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_2 -->
<g id="edge295" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12430.15,-8209.13C12397.2,-8201.27 12362.6,-8194.28 12329.79,-8189.93 12264.91,-8181.32 11210.26,-8201.34 11151.79,-8171.93 11136.78,-8164.38 11143.56,-8149.93 11128.79,-8141.93 11080.67,-8115.84 10739.44,-8100.38 10566.6,-8094.15"/>
<polygon fill="black" stroke="black" points="10566.6,-8090.65 10556.48,-8093.79 10566.35,-8097.64 10566.6,-8090.65"/>
<text text-anchor="middle" x="11197.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11197.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_3 -->
<g id="edge296" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12430.54,-8208.91C12397.49,-8201.05 12362.74,-8194.11 12329.79,-8189.93 12263.3,-8181.49 7563.85,-8201.7 7503.79,-8171.93 7488.74,-8164.47 7495.5,-8150.05 7480.79,-8141.93 7406.13,-8100.68 7169.09,-8092.16 7032.46,-8090.78"/>
<polygon fill="black" stroke="black" points="7032.42,-8087.28 7022.39,-8090.69 7032.36,-8094.28 7032.42,-8087.28"/>
<text text-anchor="middle" x="7549.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7549.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_4 -->
<g id="edge297" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12755.05,-8208.94C12788.1,-8201.07 12822.85,-8194.12 12855.79,-8189.93 12881.59,-8186.64 16582.45,-8190.36 16600.79,-8171.93 16610.2,-8162.48 16609.85,-8151.71 16600.79,-8141.93 16563.44,-8101.58 16214.04,-8093.05 16038.48,-8091.32"/>
<polygon fill="black" stroke="black" points="16038.49,-8087.82 16028.46,-8091.22 16038.43,-8094.82 16038.49,-8087.82"/>
<text text-anchor="middle" x="16652.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16652.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_5 -->
<g id="edge298" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12755.41,-8208.98C12788.36,-8201.13 12822.97,-8194.18 12855.79,-8189.93 12882.25,-8186.49 14758.01,-8190.88 14776.79,-8171.93 14786.18,-8162.46 14785.85,-8151.71 14776.79,-8141.93 14739.44,-8101.58 14390.04,-8093.05 14214.48,-8091.32"/>
<polygon fill="black" stroke="black" points="14214.49,-8087.82 14204.46,-8091.22 14214.43,-8094.82 14214.49,-8087.82"/>
<text text-anchor="middle" x="14828.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14828.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_6 -->
<g id="edge299" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12430.55,-8208.87C12397.49,-8201.01 12362.74,-8194.08 12329.79,-8189.93 12272.19,-8182.67 4021.83,-8197.67 3969.79,-8171.93 3954.73,-8164.48 3961.5,-8150.05 3946.79,-8141.93 3872.13,-8100.68 3635.09,-8092.16 3498.46,-8090.78"/>
<polygon fill="black" stroke="black" points="3498.42,-8087.28 3488.39,-8090.69 3498.36,-8094.28 3498.42,-8087.28"/>
<text text-anchor="middle" x="4015.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4015.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer1_gate_3_0&#45;&gt;layer1_expert1_7 -->
<g id="edge300" class="edge">
<title>layer1_gate_3_0&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12762.33,-8212.66C12793.37,-8204.88 12825.52,-8197.01 12855.79,-8189.93 12892.97,-8181.23 12915.79,-8201.62 12939.79,-8171.93 12948.17,-8161.56 12948.84,-8151.72 12939.79,-8141.93 12903.33,-8102.49 12563.19,-8093.5 12390.45,-8091.49"/>
<polygon fill="black" stroke="black" points="12390.37,-8087.98 12380.33,-8091.37 12390.29,-8094.98 12390.37,-8087.98"/>
<text text-anchor="middle" x="12991.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12991.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_0 -->
<g id="edge301" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9799.79,-8209.14C9766.94,-8201.31 9732.47,-8194.33 9699.79,-8189.93 9673.85,-8186.43 8776.23,-8190.5 8757.79,-8171.93 8748.16,-8162.23 8745.69,-8148.21 8746.35,-8134.56"/>
<polygon fill="black" stroke="black" points="8749.87,-8134.57 8747.39,-8124.27 8742.9,-8133.86 8749.87,-8134.57"/>
<text text-anchor="middle" x="8803.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8803.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→0</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_1 -->
<g id="edge302" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9800.54,-8208.92C9767.48,-8201.05 9732.74,-8194.11 9699.79,-8189.93 9668.17,-8185.91 5132.43,-8194.37 5109.79,-8171.93 5099.91,-8162.13 5097.52,-8147.8 5098.3,-8133.9"/>
<polygon fill="black" stroke="black" points="5101.79,-8134.25 5099.37,-8123.94 5094.83,-8133.5 5101.79,-8134.25"/>
<text text-anchor="middle" x="5155.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5155.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→2</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_2 -->
<g id="edge303" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10126.98,-8209.79C10159.49,-8201.99 10193.54,-8194.84 10225.79,-8189.93 10262.42,-8184.34 10533.31,-8198.83 10558.79,-8171.93 10572.38,-8157.59 10564.02,-8143 10547.84,-8130.23"/>
<polygon fill="black" stroke="black" points="10549.5,-8127.11 10539.33,-8124.11 10545.41,-8132.79 10549.5,-8127.11"/>
<text text-anchor="middle" x="10610.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10610.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→4</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_3 -->
<g id="edge304" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9800.18,-8208.9C9767.23,-8201.06 9732.62,-8194.14 9699.79,-8189.93 9661.69,-8185.04 6961.04,-8199.01 6933.79,-8171.93 6924.1,-8162.29 6921.62,-8148.29 6922.28,-8134.63"/>
<polygon fill="black" stroke="black" points="6925.8,-8134.63 6923.33,-8124.33 6918.83,-8133.92 6925.8,-8134.63"/>
<text text-anchor="middle" x="6979.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6979.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→6</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_4 -->
<g id="edge305" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10125.04,-8208.9C10158.1,-8201.03 10192.84,-8194.1 10225.79,-8189.93 10265.79,-8184.87 16002.33,-8200.48 16030.79,-8171.93 16045.06,-8157.62 16036.08,-8142.78 16019.15,-8129.77"/>
<polygon fill="black" stroke="black" points="16021.05,-8126.83 16010.86,-8123.93 16017.02,-8132.55 16021.05,-8126.83"/>
<text text-anchor="middle" x="16083.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16083.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→8</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_5 -->
<g id="edge306" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10125.04,-8208.93C10158.1,-8201.07 10192.85,-8194.12 10225.79,-8189.93 10253.22,-8186.44 14187.29,-8191.52 14206.79,-8171.93 14220.98,-8157.67 14212.15,-8142.9 14195.36,-8129.94"/>
<polygon fill="black" stroke="black" points="14197.33,-8127.04 14187.15,-8124.12 14193.28,-8132.75 14197.33,-8127.04"/>
<text text-anchor="middle" x="14259.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14259.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→10</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_6 -->
<g id="edge307" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9800.54,-8208.89C9767.49,-8201.03 9732.74,-8194.09 9699.79,-8189.93 9678.09,-8187.18 3415.33,-8187.32 3399.79,-8171.93 3389.9,-8162.13 3387.51,-8147.8 3388.3,-8133.91"/>
<polygon fill="black" stroke="black" points="3391.78,-8134.26 3389.37,-8123.94 3384.82,-8133.51 3391.78,-8134.26"/>
<text text-anchor="middle" x="3445.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3445.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→12</text>
</g>
<!-- layer1_gate_3_1&#45;&gt;layer1_expert1_7 -->
<g id="edge308" class="edge">
<title>layer1_gate_3_1&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10125.41,-8208.95C10158.36,-8201.11 10192.97,-8194.17 10225.79,-8189.93 10255.5,-8186.09 12361.7,-8193.2 12382.79,-8171.93 12396.96,-8157.64 12388.12,-8142.87 12371.33,-8129.91"/>
<polygon fill="black" stroke="black" points="12373.3,-8127.01 12363.12,-8124.09 12369.25,-8132.72 12373.3,-8127.01"/>
<text text-anchor="middle" x="12435.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12435.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 13→14</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_0 -->
<g id="edge309" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.42,-8209.07C6476.37,-8201.22 6510.98,-8194.24 6543.79,-8189.93 6582.16,-8184.88 7903.01,-8190.8 7936.79,-8171.93 7950.57,-8164.23 7942.21,-8149.97 7955.79,-8141.93 8014.71,-8107.02 8455.46,-8095.65 8656.89,-8092.25"/>
<polygon fill="black" stroke="black" points="8657.24,-8095.75 8667.18,-8092.08 8657.12,-8088.75 8657.24,-8095.75"/>
<text text-anchor="middle" x="8001.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8001.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_1 -->
<g id="edge310" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6118.17,-8209.01C6085.22,-8201.16 6050.61,-8194.2 6017.79,-8189.93 5994.29,-8186.87 4328.46,-8188.77 4311.79,-8171.93 4302.41,-8162.45 4302.67,-8151.65 4311.79,-8141.93 4335.3,-8116.87 4800.39,-8100.03 5009.01,-8093.72"/>
<polygon fill="black" stroke="black" points="5009.16,-8097.21 5019.05,-8093.41 5008.95,-8090.22 5009.16,-8097.21"/>
<text text-anchor="middle" x="4357.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4357.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_2 -->
<g id="edge311" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.4,-8208.88C6476.35,-8201.04 6510.96,-8194.12 6543.79,-8189.93 6588.11,-8184.26 9721.71,-8193.58 9760.79,-8171.93 9774.6,-8164.28 9766.26,-8150.04 9779.79,-8141.93 9828.87,-8112.49 10188.62,-8098.56 10367.03,-8093.41"/>
<polygon fill="black" stroke="black" points="10367.32,-8096.9 10377.21,-8093.12 10367.12,-8089.9 10367.32,-8096.9"/>
<text text-anchor="middle" x="9825.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9825.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_3 -->
<g id="edge312" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6152.19,-8191.04C6137.16,-8175.6 6132.05,-8158.73 6147.79,-8141.93 6170.88,-8117.29 6626.87,-8100.28 6833.06,-8093.82"/>
<polygon fill="black" stroke="black" points="6833.4,-8097.31 6843.28,-8093.5 6833.18,-8090.31 6833.4,-8097.31"/>
<text text-anchor="middle" x="6193.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6193.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_4 -->
<g id="edge313" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.04,-8208.87C6476.09,-8201.01 6510.84,-8194.08 6543.79,-8189.93 6603.66,-8182.38 15179.96,-8201.08 15232.79,-8171.93 15246.61,-8164.3 15238.26,-8150.04 15251.79,-8141.93 15300.87,-8112.49 15660.62,-8098.56 15839.03,-8093.41"/>
<polygon fill="black" stroke="black" points="15839.32,-8096.9 15849.21,-8093.12 15839.12,-8089.9 15839.32,-8096.9"/>
<text text-anchor="middle" x="15297.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15297.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_5 -->
<g id="edge314" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.04,-8208.88C6476.09,-8201.02 6510.84,-8194.09 6543.79,-8189.93 6591.09,-8183.95 13367.06,-8194.97 13408.79,-8171.93 13422.61,-8164.3 13414.26,-8150.04 13427.79,-8141.93 13476.87,-8112.49 13836.62,-8098.56 14015.03,-8093.41"/>
<polygon fill="black" stroke="black" points="14015.32,-8096.9 14025.21,-8093.12 14015.12,-8089.9 14015.32,-8096.9"/>
<text text-anchor="middle" x="13473.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13473.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_6 -->
<g id="edge315" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6118.54,-8208.95C6085.48,-8201.08 6050.74,-8194.13 6017.79,-8189.93 5994.26,-8186.92 2618.52,-8188.75 2601.79,-8171.93 2592.39,-8162.47 2592.67,-8151.65 2601.79,-8141.93 2625.3,-8116.87 3090.39,-8100.03 3299.01,-8093.72"/>
<polygon fill="black" stroke="black" points="3299.16,-8097.21 3309.05,-8093.41 3298.95,-8090.22 3299.16,-8097.21"/>
<text text-anchor="middle" x="2647.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2647.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer1_gate_3_2&#45;&gt;layer1_expert1_7 -->
<g id="edge316" class="edge">
<title>layer1_gate_3_2&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6443.04,-8208.91C6476.1,-8201.04 6510.84,-8194.1 6543.79,-8189.93 6578.52,-8185.52 11554.15,-8188.86 11584.79,-8171.93 11598.6,-8164.29 11590.26,-8150.04 11603.79,-8141.93 11652.87,-8112.49 12012.62,-8098.56 12191.03,-8093.41"/>
<polygon fill="black" stroke="black" points="12191.32,-8096.9 12201.21,-8093.12 12191.12,-8089.9 12191.32,-8096.9"/>
<text text-anchor="middle" x="11649.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11649.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_0 -->
<g id="edge317" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9273.38,-8209.44C9240.65,-8201.62 9206.32,-8194.55 9173.79,-8189.93 9144.62,-8185.78 8664.27,-8193.11 8643.79,-8171.93 8628.24,-8155.83 8638.77,-8140.77 8658.54,-8128.11"/>
<polygon fill="black" stroke="black" points="8660.36,-8131.1 8667.2,-8123.01 8656.8,-8125.07 8660.36,-8131.1"/>
<text text-anchor="middle" x="8689.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8689.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→0</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_1 -->
<g id="edge318" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9274.54,-8208.93C9241.48,-8201.06 9206.74,-8194.12 9173.79,-8189.93 9145.01,-8186.27 5016.26,-8192.49 4995.79,-8171.93 4979.92,-8155.99 4990.57,-8140.93 5010.54,-8128.21"/>
<polygon fill="black" stroke="black" points="5012.42,-8131.17 5019.27,-8123.09 5008.88,-8125.13 5012.42,-8131.17"/>
<text text-anchor="middle" x="5041.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5041.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→2</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_2 -->
<g id="edge319" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9599.82,-8209.27C9632.65,-8201.43 9667.12,-8194.41 9699.79,-8189.93 9740.81,-8184.3 10412.21,-8197.47 10444.79,-8171.93 10456.33,-8162.88 10462.19,-8148.44 10465.07,-8134.24"/>
<polygon fill="black" stroke="black" points="10468.58,-8134.44 10466.67,-8124.02 10461.66,-8133.36 10468.58,-8134.44"/>
<text text-anchor="middle" x="10508.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10508.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→4</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_3 -->
<g id="edge320" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9274.18,-8208.93C9241.23,-8201.09 9206.61,-8194.16 9173.79,-8189.93 9141.36,-8185.75 6842.82,-8195.13 6819.79,-8171.93 6804.03,-8156.04 6814.51,-8141.04 6834.29,-8128.36"/>
<polygon fill="black" stroke="black" points="6836.11,-8131.35 6842.95,-8123.25 6832.56,-8125.32 6836.11,-8131.35"/>
<text text-anchor="middle" x="6865.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6865.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→6</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_4 -->
<g id="edge321" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9599.04,-8208.89C9632.1,-8201.03 9666.84,-8194.09 9699.79,-8189.93 9742.62,-8184.51 15882.53,-8198.2 15916.79,-8171.93 15928.42,-8163.01 15934.31,-8148.59 15937.17,-8134.38"/>
<polygon fill="black" stroke="black" points="15940.68,-8134.56 15938.76,-8124.14 15933.77,-8133.49 15940.68,-8134.56"/>
<text text-anchor="middle" x="15980.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15980.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→8</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_5 -->
<g id="edge322" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9599.04,-8208.92C9632.1,-8201.06 9666.84,-8194.11 9699.79,-8189.93 9730.06,-8186.08 14068.59,-8190.51 14092.79,-8171.93 14104.42,-8163 14110.3,-8148.58 14113.17,-8134.37"/>
<polygon fill="black" stroke="black" points="14116.68,-8134.55 14114.75,-8124.14 14109.76,-8133.48 14116.68,-8134.55"/>
<text text-anchor="middle" x="14156.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14156.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→10</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_6 -->
<g id="edge323" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9274.54,-8208.9C9241.49,-8201.03 9206.74,-8194.1 9173.79,-8189.93 9133.23,-8184.8 3314.66,-8200.88 3285.79,-8171.93 3269.91,-8156 3280.56,-8140.94 3300.52,-8128.22"/>
<polygon fill="black" stroke="black" points="3302.4,-8131.18 3309.26,-8123.1 3298.87,-8125.14 3302.4,-8131.18"/>
<text text-anchor="middle" x="3331.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3331.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→12</text>
</g>
<!-- layer1_gate_3_3&#45;&gt;layer1_expert1_7 -->
<g id="edge324" class="edge">
<title>layer1_gate_3_3&#45;&gt;layer1_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9599.4,-8208.91C9632.35,-8201.08 9666.97,-8194.15 9699.79,-8189.93 9735.18,-8185.38 12240.52,-8193.7 12268.79,-8171.93 12280.4,-8162.98 12286.29,-8148.56 12289.15,-8134.35"/>
<polygon fill="black" stroke="black" points="12292.66,-8134.54 12290.74,-8124.12 12285.75,-8133.46 12292.66,-8134.54"/>
<text text-anchor="middle" x="12332.29" y="-8160.73" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12332.29" y="-8145.73" font-family="Times,serif" font-size="14.00">GPU 15→14</text>
</g>
<!-- layer1_expert_gelu_0 -->
<g id="node137" class="node">
<title>layer1_expert_gelu_0</title>
<ellipse fill="lightgray" stroke="black" cx="9080.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="9080.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="9080.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9080.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_expert1_0&#45;&gt;layer1_expert_gelu_0 -->
<g id="edge325" class="edge">
<title>layer1_expert1_0&#45;&gt;layer1_expert_gelu_0</title>
<path fill="none" stroke="black" d="M8846.61,-8059.41C8890.67,-8044.93 8943.67,-8027.51 8988.11,-8012.91"/>
<polygon fill="black" stroke="black" points="8989.34,-8016.19 8997.74,-8009.74 8987.15,-8009.54 8989.34,-8016.19"/>
</g>
<!-- layer1_expert2_0 -->
<g id="node138" class="node">
<title>layer1_expert2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="9288.29,-7906.97 9103.29,-7906.97 9103.29,-7838.97 9288.29,-7838.97 9288.29,-7906.97"/>
<text text-anchor="middle" x="9195.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 0 Second Linear</text>
<text text-anchor="middle" x="9195.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9195.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="9195.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_0&#45;&gt;layer1_expert2_0 -->
<g id="edge326" class="edge">
<title>layer1_expert_gelu_0&#45;&gt;layer1_expert2_0</title>
<path fill="none" stroke="black" d="M9118.45,-7945.59C9129.3,-7935.53 9141.24,-7924.48 9152.41,-7914.14"/>
<polygon fill="black" stroke="black" points="9155.05,-7916.47 9160.01,-7907.11 9150.29,-7911.33 9155.05,-7916.47"/>
</g>
<!-- layer1_expert_agg_0_0 -->
<g id="node160" class="node">
<title>layer1_expert_agg_0_0</title>
<polygon fill="darkseagreen" stroke="black" points="4491.88,-7679.13 4491.88,-7731.77 4381.12,-7769 4224.47,-7769 4113.7,-7731.77 4113.7,-7679.13 4224.47,-7641.9 4381.12,-7641.9 4491.88,-7679.13"/>
<polygon fill="none" stroke="black" points="4495.88,-7676.25 4495.88,-7734.65 4381.77,-7773 4223.81,-7773 4109.7,-7734.65 4109.7,-7676.25 4223.81,-7637.9 4381.77,-7637.9 4495.88,-7676.25"/>
<text text-anchor="middle" x="4302.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4302.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="4302.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4302.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4302.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge341" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.47C9100.28,-7839.92 9097.52,-7839.41 9094.79,-7838.97 9061.11,-7833.55 4205.87,-7845.14 4181.79,-7820.97 4165.18,-7804.3 4171.35,-7786.65 4187.51,-7770.34"/>
<polygon fill="black" stroke="black" points="4190.02,-7772.79 4195,-7763.44 4185.28,-7767.64 4190.02,-7772.79"/>
<text text-anchor="middle" x="4231.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4231.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer1_expert_agg_0_1 -->
<g id="node161" class="node">
<title>layer1_expert_agg_0_1</title>
<polygon fill="darkseagreen" stroke="black" points="9371.88,-7679.13 9371.88,-7731.77 9261.12,-7769 9104.47,-7769 8993.7,-7731.77 8993.7,-7679.13 9104.47,-7641.9 9261.12,-7641.9 9371.88,-7679.13"/>
<polygon fill="none" stroke="black" points="9375.88,-7676.25 9375.88,-7734.65 9261.77,-7773 9103.81,-7773 8989.7,-7734.65 8989.7,-7676.25 9103.81,-7637.9 9261.77,-7637.9 9375.88,-7676.25"/>
<text text-anchor="middle" x="9182.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9182.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="9182.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9182.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="9182.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge342" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.13,-7841C9082.09,-7833.09 9064.93,-7825.53 9061.79,-7820.97 9049.59,-7803.27 9054.67,-7786.19 9068.04,-7770.87"/>
<polygon fill="black" stroke="black" points="9070.75,-7773.1 9075.22,-7763.49 9065.74,-7768.21 9070.75,-7773.1"/>
<text text-anchor="middle" x="9111.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9111.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
</g>
<!-- layer1_expert_agg_0_2 -->
<g id="node162" class="node">
<title>layer1_expert_agg_0_2</title>
<polygon fill="darkseagreen" stroke="black" points="7419.88,-7679.13 7419.88,-7731.77 7309.12,-7769 7152.47,-7769 7041.7,-7731.77 7041.7,-7679.13 7152.47,-7641.9 7309.12,-7641.9 7419.88,-7679.13"/>
<polygon fill="none" stroke="black" points="7423.88,-7676.25 7423.88,-7734.65 7309.77,-7773 7151.81,-7773 7037.7,-7734.65 7037.7,-7676.25 7151.81,-7637.9 7309.77,-7637.9 7423.88,-7676.25"/>
<text text-anchor="middle" x="7230.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7230.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="7230.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7230.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7230.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge343" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.49C9100.28,-7839.93 9097.52,-7839.42 9094.79,-7838.97 9067.58,-7834.52 7129.2,-7840.56 7109.79,-7820.97 7093.22,-7804.26 7099.41,-7786.59 7115.57,-7770.28"/>
<polygon fill="black" stroke="black" points="7118.08,-7772.72 7123.07,-7763.37 7113.34,-7767.57 7118.08,-7772.72"/>
<text text-anchor="middle" x="7159.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7159.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer1_expert_agg_0_3 -->
<g id="node163" class="node">
<title>layer1_expert_agg_0_3</title>
<polygon fill="darkseagreen" stroke="black" points="12177.88,-7679.13 12177.88,-7731.77 12067.12,-7769 11910.47,-7769 11799.7,-7731.77 11799.7,-7679.13 11910.47,-7641.9 12067.12,-7641.9 12177.88,-7679.13"/>
<polygon fill="none" stroke="black" points="12181.88,-7676.25 12181.88,-7734.65 12067.77,-7773 11909.81,-7773 11795.7,-7734.65 11795.7,-7676.25 11909.81,-7637.9 12067.77,-7637.9 12181.88,-7676.25"/>
<text text-anchor="middle" x="11988.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11988.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="11988.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11988.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="11988.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge344" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7867.07C9434.51,-7859.54 9727.84,-7845.36 9976.79,-7838.97 10004.42,-7838.27 11945.56,-7838.67 11966.79,-7820.97 11973.49,-7815.39 11978.17,-7800.61 11981.43,-7783.45"/>
<polygon fill="black" stroke="black" points="11984.96,-7783.56 11983.19,-7773.12 11978.06,-7782.39 11984.96,-7783.56"/>
<text text-anchor="middle" x="12028.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12028.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→3</text>
</g>
<!-- layer1_expert_agg_1_0 -->
<g id="node164" class="node">
<title>layer1_expert_agg_1_0</title>
<polygon fill="darkseagreen" stroke="black" points="14129.88,-7679.13 14129.88,-7731.77 14019.12,-7769 13862.47,-7769 13751.7,-7731.77 13751.7,-7679.13 13862.47,-7641.9 14019.12,-7641.9 14129.88,-7679.13"/>
<polygon fill="none" stroke="black" points="14133.88,-7676.25 14133.88,-7734.65 14019.77,-7773 13861.81,-7773 13747.7,-7734.65 13747.7,-7676.25 13861.81,-7637.9 14019.77,-7637.9 14133.88,-7676.25"/>
<text text-anchor="middle" x="13940.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13940.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="13940.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13940.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13940.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge345" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7866.93C9434.5,-7859.23 9727.83,-7844.8 9976.79,-7838.97 10004.16,-7838.33 13897.73,-7838.46 13918.79,-7820.97 13925.5,-7815.41 13930.18,-7800.63 13933.45,-7783.47"/>
<polygon fill="black" stroke="black" points="13936.98,-7783.58 13935.21,-7773.14 13930.08,-7782.41 13936.98,-7783.58"/>
<text text-anchor="middle" x="13980.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13980.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer1_expert_agg_1_1 -->
<g id="node165" class="node">
<title>layer1_expert_agg_1_1</title>
<polygon fill="darkseagreen" stroke="black" points="10225.88,-7679.13 10225.88,-7731.77 10115.12,-7769 9958.47,-7769 9847.7,-7731.77 9847.7,-7679.13 9958.47,-7641.9 10115.12,-7641.9 10225.88,-7679.13"/>
<polygon fill="none" stroke="black" points="10229.88,-7676.25 10229.88,-7734.65 10115.77,-7773 9957.81,-7773 9843.7,-7734.65 9843.7,-7676.25 9957.81,-7637.9 10115.77,-7637.9 10229.88,-7676.25"/>
<text text-anchor="middle" x="10036.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10036.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="10036.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10036.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="10036.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge346" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.54,-7872.48C9491.52,-7872.69 9961.31,-7868.03 10014.79,-7820.97 10021.3,-7815.24 10025.92,-7800.52 10029.18,-7783.46"/>
<polygon fill="black" stroke="black" points="10032.7,-7783.65 10030.95,-7773.2 10025.8,-7782.46 10032.7,-7783.65"/>
<text text-anchor="middle" x="10076.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10076.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→5</text>
</g>
<!-- layer1_expert_agg_1_2 -->
<g id="node166" class="node">
<title>layer1_expert_agg_1_2</title>
<polygon fill="darkseagreen" stroke="black" points="5467.88,-7679.13 5467.88,-7731.77 5357.12,-7769 5200.47,-7769 5089.7,-7731.77 5089.7,-7679.13 5200.47,-7641.9 5357.12,-7641.9 5467.88,-7679.13"/>
<polygon fill="none" stroke="black" points="5471.88,-7676.25 5471.88,-7734.65 5357.77,-7773 5199.81,-7773 5085.7,-7734.65 5085.7,-7676.25 5199.81,-7637.9 5357.77,-7637.9 5471.88,-7676.25"/>
<text text-anchor="middle" x="5278.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5278.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="5278.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5278.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="5278.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge347" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.47C9100.28,-7839.92 9097.52,-7839.42 9094.79,-7838.97 9067.8,-7834.61 5177.08,-7840.35 5157.79,-7820.97 5141.19,-7804.29 5147.36,-7786.64 5163.52,-7770.33"/>
<polygon fill="black" stroke="black" points="5166.03,-7772.77 5171.01,-7763.43 5161.29,-7767.63 5166.03,-7772.77"/>
<text text-anchor="middle" x="5207.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5207.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer1_expert_agg_1_3 -->
<g id="node167" class="node">
<title>layer1_expert_agg_1_3</title>
<polygon fill="darkseagreen" stroke="black" points="17057.88,-7679.13 17057.88,-7731.77 16947.12,-7769 16790.47,-7769 16679.7,-7731.77 16679.7,-7679.13 16790.47,-7641.9 16947.12,-7641.9 17057.88,-7679.13"/>
<polygon fill="none" stroke="black" points="17061.88,-7676.25 17061.88,-7734.65 16947.77,-7773 16789.81,-7773 16675.7,-7734.65 16675.7,-7676.25 16789.81,-7637.9 16947.77,-7637.9 17061.88,-7676.25"/>
<text text-anchor="middle" x="16868.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16868.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="16868.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="16868.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="16868.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge348" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7866.88C9434.5,-7859.09 9727.82,-7844.56 9976.79,-7838.97 10000.64,-7838.44 16828.42,-7836.19 16846.79,-7820.97 16853.5,-7815.41 16858.19,-7800.64 16861.45,-7783.48"/>
<polygon fill="black" stroke="black" points="16864.98,-7783.59 16863.21,-7773.15 16858.08,-7782.42 16864.98,-7783.59"/>
<text text-anchor="middle" x="16908.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16908.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→7</text>
</g>
<!-- layer1_expert_agg_2_0 -->
<g id="node168" class="node">
<title>layer1_expert_agg_2_0</title>
<polygon fill="darkseagreen" stroke="black" points="15105.88,-7679.13 15105.88,-7731.77 14995.12,-7769 14838.47,-7769 14727.7,-7731.77 14727.7,-7679.13 14838.47,-7641.9 14995.12,-7641.9 15105.88,-7679.13"/>
<polygon fill="none" stroke="black" points="15109.88,-7676.25 15109.88,-7734.65 14995.77,-7773 14837.81,-7773 14723.7,-7734.65 14723.7,-7676.25 14837.81,-7637.9 14995.77,-7637.9 15109.88,-7676.25"/>
<text text-anchor="middle" x="14916.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14916.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="14916.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14916.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14916.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge349" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7866.91C9434.5,-7859.17 9727.83,-7844.69 9976.79,-7838.97 10010.94,-7838.19 14868.5,-7842.78 14894.79,-7820.97 14901.5,-7815.41 14906.19,-7800.63 14909.45,-7783.47"/>
<polygon fill="black" stroke="black" points="14912.98,-7783.59 14911.21,-7773.14 14906.08,-7782.41 14912.98,-7783.59"/>
<text text-anchor="middle" x="14956.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14956.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer1_expert_agg_2_1 -->
<g id="node169" class="node">
<title>layer1_expert_agg_2_1</title>
<polygon fill="darkseagreen" stroke="black" points="13153.88,-7679.13 13153.88,-7731.77 13043.12,-7769 12886.47,-7769 12775.7,-7731.77 12775.7,-7679.13 12886.47,-7641.9 13043.12,-7641.9 13153.88,-7679.13"/>
<polygon fill="none" stroke="black" points="13157.88,-7676.25 13157.88,-7734.65 13043.77,-7773 12885.81,-7773 12771.7,-7734.65 12771.7,-7676.25 12885.81,-7637.9 13043.77,-7637.9 13157.88,-7676.25"/>
<text text-anchor="middle" x="12964.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12964.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="12964.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12964.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12964.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge350" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7866.98C9434.5,-7859.34 9727.83,-7844.99 9976.79,-7838.97 9997.38,-7838.48 12926.95,-7834.14 12942.79,-7820.97 12949.49,-7815.4 12954.18,-7800.62 12957.44,-7783.46"/>
<polygon fill="black" stroke="black" points="12960.97,-7783.58 12959.2,-7773.13 12954.07,-7782.4 12960.97,-7783.58"/>
<text text-anchor="middle" x="13004.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13004.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→9</text>
</g>
<!-- layer1_expert_agg_2_2 -->
<g id="node170" class="node">
<title>layer1_expert_agg_2_2</title>
<polygon fill="darkseagreen" stroke="black" points="8395.88,-7679.13 8395.88,-7731.77 8285.12,-7769 8128.47,-7769 8017.7,-7731.77 8017.7,-7679.13 8128.47,-7641.9 8285.12,-7641.9 8395.88,-7679.13"/>
<polygon fill="none" stroke="black" points="8399.88,-7676.25 8399.88,-7734.65 8285.77,-7773 8127.81,-7773 8013.7,-7734.65 8013.7,-7676.25 8127.81,-7637.9 8285.77,-7637.9 8399.88,-7676.25"/>
<text text-anchor="middle" x="8206.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8206.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="8206.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8206.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8206.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge351" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.52C9100.28,-7839.95 9097.52,-7839.43 9094.79,-7838.97 9067.15,-7834.32 8105.44,-7840.97 8085.79,-7820.97 8069.39,-7804.27 8075.45,-7786.68 8091.41,-7770.44"/>
<polygon fill="black" stroke="black" points="8093.87,-7772.93 8098.82,-7763.57 8089.11,-7767.8 8093.87,-7772.93"/>
<text text-anchor="middle" x="8135.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8135.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer1_expert_agg_2_3 -->
<g id="node171" class="node">
<title>layer1_expert_agg_2_3</title>
<polygon fill="darkseagreen" stroke="black" points="11201.88,-7679.13 11201.88,-7731.77 11091.12,-7769 10934.47,-7769 10823.7,-7731.77 10823.7,-7679.13 10934.47,-7641.9 11091.12,-7641.9 11201.88,-7679.13"/>
<polygon fill="none" stroke="black" points="11205.88,-7676.25 11205.88,-7734.65 11091.77,-7773 10933.81,-7773 10819.7,-7734.65 10819.7,-7676.25 10933.81,-7637.9 11091.77,-7637.9 11205.88,-7676.25"/>
<text text-anchor="middle" x="11012.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11012.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="11012.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11012.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11012.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge352" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.34,-7867.33C9434.53,-7860.16 9727.87,-7846.44 9976.79,-7838.97 10004.95,-7838.13 10969.23,-7839.11 10990.79,-7820.97 10997.46,-7815.36 11002.13,-7800.57 11005.4,-7783.41"/>
<polygon fill="black" stroke="black" points="11008.93,-7783.53 11007.16,-7773.08 11002.03,-7782.35 11008.93,-7783.53"/>
<text text-anchor="middle" x="11052.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11052.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→11</text>
</g>
<!-- layer1_expert_agg_3_0 -->
<g id="node172" class="node">
<title>layer1_expert_agg_3_0</title>
<polygon fill="darkseagreen" stroke="black" points="3515.88,-7679.13 3515.88,-7731.77 3405.12,-7769 3248.47,-7769 3137.7,-7731.77 3137.7,-7679.13 3248.47,-7641.9 3405.12,-7641.9 3515.88,-7679.13"/>
<polygon fill="none" stroke="black" points="3519.88,-7676.25 3519.88,-7734.65 3405.77,-7773 3247.81,-7773 3133.7,-7734.65 3133.7,-7676.25 3247.81,-7637.9 3405.77,-7637.9 3519.88,-7676.25"/>
<text text-anchor="middle" x="3326.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3326.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="3326.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3326.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="3326.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge353" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.47C9100.28,-7839.91 9097.52,-7839.41 9094.79,-7838.97 9054.41,-7832.48 3234.66,-7849.94 3205.79,-7820.97 3189.17,-7804.31 3195.35,-7786.66 3211.5,-7770.35"/>
<polygon fill="black" stroke="black" points="3214.01,-7772.79 3219,-7763.44 3209.27,-7767.64 3214.01,-7772.79"/>
<text text-anchor="middle" x="3255.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3255.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer1_expert_agg_3_1 -->
<g id="node173" class="node">
<title>layer1_expert_agg_3_1</title>
<polygon fill="darkseagreen" stroke="black" points="6443.88,-7679.13 6443.88,-7731.77 6333.12,-7769 6176.47,-7769 6065.7,-7731.77 6065.7,-7679.13 6176.47,-7641.9 6333.12,-7641.9 6443.88,-7679.13"/>
<polygon fill="none" stroke="black" points="6447.88,-7676.25 6447.88,-7734.65 6333.77,-7773 6175.81,-7773 6061.7,-7734.65 6061.7,-7676.25 6175.81,-7637.9 6333.77,-7637.9 6447.88,-7676.25"/>
<text text-anchor="middle" x="6254.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6254.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="6254.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6254.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6254.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge354" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.48C9100.28,-7839.92 9097.52,-7839.42 9094.79,-7838.97 9054.2,-7832.38 6162.78,-7850.14 6133.79,-7820.97 6117.2,-7804.28 6123.38,-7786.63 6139.54,-7770.31"/>
<polygon fill="black" stroke="black" points="6142.05,-7772.76 6147.03,-7763.41 6137.3,-7767.61 6142.05,-7772.76"/>
<text text-anchor="middle" x="6183.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6183.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→13</text>
</g>
<!-- layer1_expert_agg_3_2 -->
<g id="node174" class="node">
<title>layer1_expert_agg_3_2</title>
<polygon fill="darkseagreen" stroke="black" points="2661.88,-7679.13 2661.88,-7731.77 2551.12,-7769 2394.47,-7769 2283.7,-7731.77 2283.7,-7679.13 2394.47,-7641.9 2551.12,-7641.9 2661.88,-7679.13"/>
<polygon fill="none" stroke="black" points="2665.88,-7676.25 2665.88,-7734.65 2551.77,-7773 2393.81,-7773 2279.7,-7734.65 2279.7,-7676.25 2393.81,-7637.9 2551.77,-7637.9 2665.88,-7676.25"/>
<text text-anchor="middle" x="2472.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2472.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="2472.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2472.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2472.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge355" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9103.05,-7840.47C9100.28,-7839.91 9097.52,-7839.41 9094.79,-7838.97 9071.67,-7835.26 2368.32,-7837.55 2351.79,-7820.97 2335.17,-7804.31 2341.34,-7786.67 2357.5,-7770.35"/>
<polygon fill="black" stroke="black" points="2360.01,-7772.8 2364.99,-7763.45 2355.27,-7767.65 2360.01,-7772.8"/>
<text text-anchor="middle" x="2401.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2401.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer1_expert_agg_3_3 -->
<g id="node175" class="node">
<title>layer1_expert_agg_3_3</title>
<polygon fill="darkseagreen" stroke="black" points="16081.88,-7679.13 16081.88,-7731.77 15971.12,-7769 15814.47,-7769 15703.7,-7731.77 15703.7,-7679.13 15814.47,-7641.9 15971.12,-7641.9 16081.88,-7679.13"/>
<polygon fill="none" stroke="black" points="16085.88,-7676.25 16085.88,-7734.65 15971.77,-7773 15813.81,-7773 15699.7,-7734.65 15699.7,-7676.25 15813.81,-7637.9 15971.77,-7637.9 16085.88,-7676.25"/>
<text text-anchor="middle" x="15892.79" y="-7731.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15892.79" y="-7716.75" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="15892.79" y="-7701.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="15892.79" y="-7686.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="15892.79" y="-7671.75" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer1_expert2_0&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge356" class="edge">
<title>layer1_expert2_0&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.33,-7866.89C9434.5,-7859.12 9727.83,-7844.61 9976.79,-7838.97 9997.25,-7838.51 15855.03,-7834.03 15870.79,-7820.97 15877.5,-7815.41 15882.19,-7800.64 15885.45,-7783.47"/>
<polygon fill="black" stroke="black" points="15888.98,-7783.59 15887.21,-7773.14 15882.08,-7782.41 15888.98,-7783.59"/>
<text text-anchor="middle" x="15932.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15932.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 0→15</text>
</g>
<!-- layer1_expert_gelu_1 -->
<g id="node140" class="node">
<title>layer1_expert_gelu_1</title>
<ellipse fill="lightgray" stroke="black" cx="6470.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6470.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="6470.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6470.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_expert1_1&#45;&gt;layer1_expert_gelu_1 -->
<g id="edge327" class="edge">
<title>layer1_expert1_1&#45;&gt;layer1_expert_gelu_1</title>
<path fill="none" stroke="black" d="M5198.42,-8081.92C5432.56,-8063.62 6063.43,-8014.3 6338.99,-7992.75"/>
<polygon fill="black" stroke="black" points="6339.35,-7996.24 6349.04,-7991.97 6338.8,-7989.26 6339.35,-7996.24"/>
</g>
<!-- layer1_expert2_1 -->
<g id="node141" class="node">
<title>layer1_expert2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="8882.29,-7906.97 8697.29,-7906.97 8697.29,-7838.97 8882.29,-7838.97 8882.29,-7906.97"/>
<text text-anchor="middle" x="8789.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 1 Second Linear</text>
<text text-anchor="middle" x="8789.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8789.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8789.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_1&#45;&gt;layer1_expert2_1 -->
<g id="edge328" class="edge">
<title>layer1_expert_gelu_1&#45;&gt;layer1_expert2_1</title>
<path fill="none" stroke="black" d="M6597.1,-7978.35C7030.13,-7970.85 8441.08,-7944 8686.85,-7907.03"/>
<polygon fill="black" stroke="black" points="8687.73,-7910.43 8697.04,-7905.37 8686.6,-7903.52 8687.73,-7910.43"/>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge357" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.47C8694.28,-7839.92 8691.52,-7839.41 8688.79,-7838.97 8656.22,-7833.72 3961.08,-7844.35 3937.79,-7820.97 3873.29,-7756.23 3983.61,-7727.99 4099.43,-7715.73"/>
<polygon fill="black" stroke="black" points="4099.97,-7719.19 4109.57,-7714.7 4099.27,-7712.23 4099.97,-7719.19"/>
<text text-anchor="middle" x="3987.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3987.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge358" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8804.2,-7838.79C8813.04,-7822.11 8825.94,-7802.94 8842.79,-7790.97 8882.92,-7762.47 8931.66,-7743.55 8979.55,-7730.99"/>
<polygon fill="black" stroke="black" points="8980.6,-7734.33 8989.43,-7728.48 8978.87,-7727.54 8980.6,-7734.33"/>
<text text-anchor="middle" x="8892.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8892.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→1</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge359" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.49C8694.28,-7839.93 8691.52,-7839.42 8688.79,-7838.97 8663.81,-7834.87 6883.61,-7838.97 6865.79,-7820.97 6801.48,-7756.03 6911.79,-7727.81 7027.56,-7715.61"/>
<polygon fill="black" stroke="black" points="7028.09,-7719.07 7037.69,-7714.58 7027.39,-7712.11 7028.09,-7719.07"/>
<text text-anchor="middle" x="6915.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6915.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge360" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.71C8885.51,-7840.06 8888.67,-7839.48 8891.79,-7838.97 8930.61,-7832.72 11688.4,-7840.04 11722.79,-7820.97 11736.59,-7813.32 11729.4,-7800.75 11741.79,-7790.97 11763.83,-7773.58 11789.67,-7759.66 11816.18,-7748.54"/>
<polygon fill="black" stroke="black" points="11817.63,-7751.73 11825.57,-7744.73 11814.99,-7745.25 11817.63,-7751.73"/>
<text text-anchor="middle" x="11791.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11791.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge361" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.7C8885.51,-7840.05 8888.67,-7839.47 8891.79,-7838.97 8957.39,-7828.5 13616.65,-7853.11 13674.79,-7820.97 13688.6,-7813.34 13681.4,-7800.75 13693.79,-7790.97 13715.83,-7773.58 13741.67,-7759.66 13768.18,-7748.54"/>
<polygon fill="black" stroke="black" points="13769.63,-7751.73 13777.57,-7744.73 13766.99,-7745.25 13769.63,-7751.73"/>
<text text-anchor="middle" x="13743.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13743.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge362" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.34,-7840.76C8885.52,-7840.1 8888.67,-7839.5 8891.79,-7838.97 8939.96,-7830.87 9728.24,-7844.96 9770.79,-7820.97 9784.54,-7813.22 9777.4,-7800.75 9789.79,-7790.97 9811.83,-7773.58 9837.67,-7759.66 9864.18,-7748.54"/>
<polygon fill="black" stroke="black" points="9865.63,-7751.73 9873.57,-7744.73 9862.99,-7745.25 9865.63,-7751.73"/>
<text text-anchor="middle" x="9839.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9839.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→5</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge363" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.47C8694.28,-7839.92 8691.52,-7839.42 8688.79,-7838.97 8662.91,-7834.79 4932.28,-7839.56 4913.79,-7820.97 4849.32,-7756.19 4959.63,-7727.97 5075.45,-7715.71"/>
<polygon fill="black" stroke="black" points="5075.99,-7719.17 5085.59,-7714.68 5075.28,-7712.21 5075.99,-7719.17"/>
<text text-anchor="middle" x="4963.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4963.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge364" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.69C8885.51,-7840.05 8888.67,-7839.47 8891.79,-7838.97 8944.68,-7830.57 16555.91,-7846.85 16602.79,-7820.97 16616.61,-7813.35 16609.4,-7800.75 16621.79,-7790.97 16643.83,-7773.58 16669.67,-7759.66 16696.18,-7748.54"/>
<polygon fill="black" stroke="black" points="16697.63,-7751.73 16705.57,-7744.73 16694.99,-7745.25 16697.63,-7751.73"/>
<text text-anchor="middle" x="16671.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16671.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→7</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge365" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.69C8885.51,-7840.05 8888.67,-7839.47 8891.79,-7838.97 8931.29,-7832.68 14615.78,-7840.31 14650.79,-7820.97 14664.61,-7813.34 14657.4,-7800.75 14669.79,-7790.97 14691.83,-7773.58 14717.67,-7759.66 14744.18,-7748.54"/>
<polygon fill="black" stroke="black" points="14745.63,-7751.73 14753.57,-7744.73 14742.99,-7745.25 14745.63,-7751.73"/>
<text text-anchor="middle" x="14719.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14719.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge366" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.7C8885.51,-7840.05 8888.67,-7839.47 8891.79,-7838.97 8944,-7830.61 12652.53,-7846.58 12698.79,-7820.97 12712.6,-7813.33 12705.4,-7800.75 12717.79,-7790.97 12739.83,-7773.58 12765.67,-7759.66 12792.18,-7748.54"/>
<polygon fill="black" stroke="black" points="12793.63,-7751.73 12801.57,-7744.73 12790.99,-7745.25 12793.63,-7751.73"/>
<text text-anchor="middle" x="12767.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12767.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→9</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge367" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.04,-7840.53C8694.27,-7839.96 8691.52,-7839.44 8688.79,-7838.97 8665.59,-7835.03 7858.25,-7837.79 7841.79,-7820.97 7777.91,-7755.72 7887.94,-7727.53 8003.49,-7715.4"/>
<polygon fill="black" stroke="black" points="8004,-7718.87 8013.6,-7714.38 8003.3,-7711.91 8004,-7718.87"/>
<text text-anchor="middle" x="7891.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7891.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge368" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.34,-7840.72C8885.51,-7840.07 8888.67,-7839.48 8891.79,-7838.97 8942.65,-7830.7 10701.77,-7846.04 10746.79,-7820.97 10760.58,-7813.3 10753.4,-7800.75 10765.79,-7790.97 10787.83,-7773.58 10813.67,-7759.66 10840.18,-7748.54"/>
<polygon fill="black" stroke="black" points="10841.63,-7751.73 10849.57,-7744.73 10838.99,-7745.25 10841.63,-7751.73"/>
<text text-anchor="middle" x="10815.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10815.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→11</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge369" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.47C8694.28,-7839.91 8691.52,-7839.41 8688.79,-7838.97 8649.52,-7832.66 2989.87,-7849.14 2961.79,-7820.97 2897.27,-7756.25 3007.59,-7728.01 3123.42,-7715.74"/>
<polygon fill="black" stroke="black" points="3123.96,-7719.21 3133.56,-7714.71 3123.25,-7712.24 3123.96,-7719.21"/>
<text text-anchor="middle" x="3011.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3011.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge370" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.48C8694.28,-7839.92 8691.52,-7839.42 8688.79,-7838.97 8650.42,-7832.74 5917.19,-7848.55 5889.79,-7820.97 5825.37,-7756.14 5935.68,-7727.92 6051.49,-7715.68"/>
<polygon fill="black" stroke="black" points="6052.03,-7719.14 6061.62,-7714.65 6051.32,-7712.18 6052.03,-7719.14"/>
<text text-anchor="middle" x="5939.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5939.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→13</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge371" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8697.05,-7840.47C8694.28,-7839.91 8691.52,-7839.41 8688.79,-7838.97 8666.23,-7835.35 2123.93,-7837.15 2107.79,-7820.97 2043.25,-7756.26 2153.57,-7728.03 2269.41,-7715.75"/>
<polygon fill="black" stroke="black" points="2269.95,-7719.22 2279.55,-7714.72 2269.24,-7712.25 2269.95,-7719.22"/>
<text text-anchor="middle" x="2157.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2157.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer1_expert2_1&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge372" class="edge">
<title>layer1_expert2_1&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8882.33,-7840.69C8885.51,-7840.05 8888.67,-7839.47 8891.79,-7838.97 8937.98,-7831.62 15585.85,-7843.58 15626.79,-7820.97 15640.61,-7813.35 15633.4,-7800.75 15645.79,-7790.97 15667.83,-7773.58 15693.67,-7759.66 15720.18,-7748.54"/>
<polygon fill="black" stroke="black" points="15721.63,-7751.73 15729.57,-7744.73 15718.99,-7745.25 15721.63,-7751.73"/>
<text text-anchor="middle" x="15695.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15695.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 2→15</text>
</g>
<!-- layer1_expert_gelu_2 -->
<g id="node143" class="node">
<title>layer1_expert_gelu_2</title>
<ellipse fill="lightgray" stroke="black" cx="10331.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="10331.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="10331.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10331.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_expert1_2&#45;&gt;layer1_expert_gelu_2 -->
<g id="edge329" class="edge">
<title>layer1_expert1_2&#45;&gt;layer1_expert_gelu_2</title>
<path fill="none" stroke="black" d="M10424.82,-8055.82C10411.75,-8045.51 10397.18,-8034.02 10383.52,-8023.25"/>
<polygon fill="black" stroke="black" points="10385.63,-8020.45 10375.61,-8017.01 10381.29,-8025.95 10385.63,-8020.45"/>
</g>
<!-- layer1_expert2_2 -->
<g id="node144" class="node">
<title>layer1_expert2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="10170.29,-7906.97 9985.29,-7906.97 9985.29,-7838.97 10170.29,-7838.97 10170.29,-7906.97"/>
<text text-anchor="middle" x="10077.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 2 Second Linear</text>
<text text-anchor="middle" x="10077.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10077.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="10077.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_2&#45;&gt;layer1_expert2_2 -->
<g id="edge330" class="edge">
<title>layer1_expert_gelu_2&#45;&gt;layer1_expert2_2</title>
<path fill="none" stroke="black" d="M10260.36,-7950.51C10231.11,-7938.24 10196.95,-7923.93 10166.15,-7911.01"/>
<polygon fill="black" stroke="black" points="10167.28,-7907.69 10156.71,-7907.06 10164.58,-7914.15 10167.28,-7907.69"/>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge373" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.08,-7866.89C9838.99,-7859.14 9546.27,-7844.68 9297.79,-7838.97 9280.46,-7838.58 4316.08,-7833.2 4303.79,-7820.97 4293.7,-7810.93 4289.17,-7797.54 4287.89,-7783.47"/>
<polygon fill="black" stroke="black" points="4291.37,-7783 4287.5,-7773.14 4284.38,-7783.26 4291.37,-7783"/>
<text text-anchor="middle" x="4353.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4353.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge374" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.06,-7868.34C9759.1,-7859.28 9197.49,-7835.35 9183.79,-7820.97 9174.02,-7810.72 9169.61,-7797.31 9168.33,-7783.29"/>
<polygon fill="black" stroke="black" points="9171.82,-7782.87 9167.92,-7773.01 9164.83,-7783.15 9171.82,-7782.87"/>
<text text-anchor="middle" x="9233.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9233.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→1</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge375" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.07,-7867.04C9838.98,-7859.5 9546.25,-7845.31 9297.79,-7838.97 9269.11,-7838.24 7252.08,-7841.26 7231.79,-7820.97 7221.72,-7810.9 7217.21,-7797.51 7215.93,-7783.43"/>
<polygon fill="black" stroke="black" points="7219.41,-7782.96 7215.54,-7773.1 7212.42,-7783.22 7219.41,-7782.96"/>
<text text-anchor="middle" x="7281.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7281.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge376" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.34,-7840.72C10173.51,-7840.07 10176.67,-7839.48 10179.79,-7838.97 10205.96,-7834.72 12070.13,-7839.81 12088.79,-7820.97 12102.71,-7806.92 12099.91,-7791.28 12088.99,-7776.19"/>
<polygon fill="black" stroke="black" points="12091.63,-7773.88 12082.59,-7768.36 12086.21,-7778.32 12091.63,-7773.88"/>
<text text-anchor="middle" x="12147.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12147.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→3</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge377" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.33,-7840.7C10173.51,-7840.05 10176.67,-7839.47 10179.79,-7838.97 10206.27,-7834.73 14021.88,-7839.98 14040.79,-7820.97 14054.82,-7806.87 14051.93,-7791.15 14040.86,-7775.98"/>
<polygon fill="black" stroke="black" points="14043.43,-7773.6 14034.37,-7768.11 14038.03,-7778.05 14043.43,-7773.6"/>
<text text-anchor="middle" x="14099.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14099.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge378" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10124.62,-7838.94C10129.53,-7833.51 10133.81,-7827.5 10136.79,-7820.97 10142.34,-7808.85 10142.4,-7803.07 10136.79,-7790.97 10134.83,-7786.74 10132.54,-7782.65 10129.98,-7778.69"/>
<polygon fill="black" stroke="black" points="10132.64,-7776.39 10123.99,-7770.26 10126.93,-7780.44 10132.64,-7776.39"/>
<text text-anchor="middle" x="10190.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10190.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→5</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge379" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.08,-7866.92C9838.99,-7859.2 9546.27,-7844.78 9297.79,-7838.97 9269.9,-7838.32 5299.56,-7840.66 5279.79,-7820.97 5269.7,-7810.93 5265.18,-7797.54 5263.9,-7783.46"/>
<polygon fill="black" stroke="black" points="5267.38,-7782.99 5263.5,-7773.13 5260.39,-7783.26 5267.38,-7782.99"/>
<text text-anchor="middle" x="5329.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5329.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge380" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.33,-7840.69C10173.51,-7840.05 10176.67,-7839.47 10179.79,-7838.97 10203.07,-7835.27 16952.14,-7837.66 16968.79,-7820.97 16982.84,-7806.89 16979.95,-7791.17 16968.88,-7776"/>
<polygon fill="black" stroke="black" points="16971.45,-7773.62 16962.39,-7768.13 16966.05,-7778.08 16971.45,-7773.62"/>
<text text-anchor="middle" x="17027.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="17027.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→7</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge381" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.33,-7840.7C10173.51,-7840.05 10176.67,-7839.47 10179.79,-7838.97 10212.96,-7833.68 14993.08,-7844.77 15016.79,-7820.97 15030.83,-7806.88 15027.94,-7791.16 15016.87,-7775.99"/>
<polygon fill="black" stroke="black" points="15019.44,-7773.61 15010.38,-7768.12 15014.04,-7778.06 15019.44,-7773.61"/>
<text text-anchor="middle" x="15075.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15075.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge382" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.33,-7840.71C10173.51,-7840.06 10176.67,-7839.48 10179.79,-7838.97 10219.35,-7832.61 13036.55,-7849.4 13064.79,-7820.97 13078.73,-7806.94 13075.95,-7791.31 13065.03,-7776.22"/>
<polygon fill="black" stroke="black" points="13067.66,-7773.92 13058.62,-7768.39 13062.24,-7778.35 13067.66,-7773.92"/>
<text text-anchor="middle" x="13123.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13123.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→9</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge383" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.07,-7867.28C9838.97,-7860.05 9546.23,-7846.28 9297.79,-7838.97 9267.52,-7838.08 8229.12,-7842.47 8207.79,-7820.97 8197.76,-7810.87 8193.26,-7797.45 8191.99,-7783.37"/>
<polygon fill="black" stroke="black" points="8195.48,-7782.9 8191.6,-7773.04 8188.48,-7783.16 8195.48,-7782.9"/>
<text text-anchor="middle" x="8257.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8257.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge384" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.34,-7840.76C10173.51,-7840.1 10176.67,-7839.5 10179.79,-7838.97 10205.36,-7834.69 11094.64,-7839.48 11112.79,-7820.97 11126.64,-7806.85 11123.82,-7791.19 11112.89,-7776.09"/>
<polygon fill="black" stroke="black" points="11115.52,-7773.78 11106.48,-7768.25 11110.1,-7778.21 11115.52,-7773.78"/>
<text text-anchor="middle" x="11171.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11171.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→11</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge385" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.08,-7866.87C9838.99,-7859.1 9546.27,-7844.6 9297.79,-7838.97 9277.07,-7838.5 3342.49,-7835.59 3327.79,-7820.97 3317.69,-7810.93 3313.17,-7797.55 3311.89,-7783.47"/>
<polygon fill="black" stroke="black" points="3315.37,-7783 3311.49,-7773.14 3308.37,-7783.27 3315.37,-7783"/>
<text text-anchor="middle" x="3377.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3377.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge386" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.07,-7866.96C9838.99,-7859.3 9546.26,-7844.96 9297.79,-7838.97 9276.67,-7838.46 6270.75,-7835.89 6255.79,-7820.97 6245.71,-7810.92 6241.19,-7797.53 6239.91,-7783.45"/>
<polygon fill="black" stroke="black" points="6243.39,-7782.98 6239.52,-7773.12 6236.4,-7783.25 6243.39,-7782.98"/>
<text text-anchor="middle" x="6305.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6305.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→13</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge387" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9985.08,-7866.86C9838.99,-7859.07 9546.27,-7844.56 9297.79,-7838.97 9274.1,-7838.44 2490.6,-7837.68 2473.79,-7820.97 2463.69,-7810.94 2459.16,-7797.55 2457.88,-7783.48"/>
<polygon fill="black" stroke="black" points="2461.37,-7783.01 2457.49,-7773.15 2454.37,-7783.27 2461.37,-7783.01"/>
<text text-anchor="middle" x="2523.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2523.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer1_expert2_2&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge388" class="edge">
<title>layer1_expert2_2&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10170.33,-7840.69C10173.51,-7840.05 10176.67,-7839.47 10179.79,-7838.97 10219.66,-7832.62 15964.29,-7849.56 15992.79,-7820.97 16006.84,-7806.89 16003.94,-7791.17 15992.87,-7776"/>
<polygon fill="black" stroke="black" points="15995.45,-7773.62 15986.38,-7768.13 15990.04,-7778.07 15995.45,-7773.62"/>
<text text-anchor="middle" x="16051.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16051.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 4→15</text>
</g>
<!-- layer1_expert_gelu_3 -->
<g id="node146" class="node">
<title>layer1_expert_gelu_3</title>
<ellipse fill="lightgray" stroke="black" cx="8176.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="8176.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="8176.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8176.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_expert1_3&#45;&gt;layer1_expert_gelu_3 -->
<g id="edge331" class="edge">
<title>layer1_expert1_3&#45;&gt;layer1_expert_gelu_3</title>
<path fill="none" stroke="black" d="M7022.51,-8081.25C7239.31,-8062.69 7792.48,-8015.35 8046.12,-7993.63"/>
<polygon fill="black" stroke="black" points="8046.46,-7997.12 8056.13,-7992.78 8045.87,-7990.14 8046.46,-7997.12"/>
</g>
<!-- layer1_expert2_3 -->
<g id="node147" class="node">
<title>layer1_expert2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="9085.29,-7906.97 8900.29,-7906.97 8900.29,-7838.97 9085.29,-7838.97 9085.29,-7906.97"/>
<text text-anchor="middle" x="8992.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 3 Second Linear</text>
<text text-anchor="middle" x="8992.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8992.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8992.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_3&#45;&gt;layer1_expert2_3 -->
<g id="edge332" class="edge">
<title>layer1_expert_gelu_3&#45;&gt;layer1_expert2_3</title>
<path fill="none" stroke="black" d="M8302.04,-7975.67C8443.53,-7968.43 8680.4,-7950.79 8890.29,-7907.15"/>
<polygon fill="black" stroke="black" points="8891.2,-7910.54 8900.26,-7905.05 8889.76,-7903.69 8891.2,-7910.54"/>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge389" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.47C8897.28,-7839.92 8894.52,-7839.41 8891.79,-7838.97 8858.66,-7833.64 4083.47,-7844.75 4059.79,-7820.97 4025.09,-7786.14 4060.18,-7760.58 4113.46,-7742.55"/>
<polygon fill="black" stroke="black" points="4114.8,-7745.8 4123.24,-7739.39 4112.65,-7739.14 4114.8,-7745.8"/>
<text text-anchor="middle" x="4109.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4109.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge390" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8959.73,-7838.85C8948.63,-7823.68 8941.41,-7805.83 8951.79,-7790.97 8964.74,-7772.45 8982.2,-7757.97 9001.76,-7746.66"/>
<polygon fill="black" stroke="black" points="9003.48,-7749.71 9010.58,-7741.85 9000.13,-7743.57 9003.48,-7749.71"/>
<text text-anchor="middle" x="9001.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9001.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→1</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge391" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.49C8897.28,-7839.93 8894.52,-7839.42 8891.79,-7838.97 8865.69,-7834.69 7006.4,-7839.76 6987.79,-7820.97 6953.19,-7786.04 6988.29,-7760.46 7041.56,-7742.45"/>
<polygon fill="black" stroke="black" points="7042.9,-7745.7 7051.34,-7739.29 7040.75,-7739.04 7042.9,-7745.7"/>
<text text-anchor="middle" x="7037.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7037.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge392" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.71C9088.51,-7840.06 9091.67,-7839.48 9094.79,-7838.97 9132.5,-7832.9 11811.39,-7839.5 11844.79,-7820.97 11858.59,-7813.32 11852.8,-7802.3 11863.79,-7790.97 11869.69,-7784.89 11876.1,-7779 11882.79,-7773.34"/>
<polygon fill="black" stroke="black" points="11885.24,-7775.86 11890.75,-7766.82 11880.8,-7770.45 11885.24,-7775.86"/>
<text text-anchor="middle" x="11913.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11913.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→3</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge393" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.7C9088.51,-7840.05 9091.67,-7839.47 9094.79,-7838.97 9159.28,-7828.67 13739.64,-7852.57 13796.79,-7820.97 13810.6,-7813.34 13804.8,-7802.3 13815.79,-7790.97 13821.69,-7784.89 13828.1,-7779 13834.79,-7773.34"/>
<polygon fill="black" stroke="black" points="13837.24,-7775.86 13842.75,-7766.82 13832.8,-7770.45 13837.24,-7775.86"/>
<text text-anchor="middle" x="13865.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13865.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge394" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.34,-7840.77C9088.52,-7840.11 9091.67,-7839.5 9094.79,-7838.97 9138.51,-7831.57 9854.19,-7842.79 9892.79,-7820.97 9906.53,-7813.21 9900.8,-7802.3 9911.79,-7790.97 9917.69,-7784.89 9924.1,-7779 9930.79,-7773.34"/>
<polygon fill="black" stroke="black" points="9933.24,-7775.86 9938.75,-7766.82 9928.8,-7770.45 9933.24,-7775.86"/>
<text text-anchor="middle" x="9961.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9961.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→5</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge395" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.47C8897.28,-7839.92 8894.52,-7839.42 8891.79,-7838.97 8865.36,-7834.7 5054.68,-7839.95 5035.79,-7820.97 5001.11,-7786.13 5036.2,-7760.56 5089.47,-7742.54"/>
<polygon fill="black" stroke="black" points="5090.82,-7745.78 5099.26,-7739.37 5088.67,-7739.12 5090.82,-7745.78"/>
<text text-anchor="middle" x="5085.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5085.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge396" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.69C9088.51,-7840.05 9091.67,-7839.47 9094.79,-7838.97 9147.12,-7830.66 16678.4,-7846.58 16724.79,-7820.97 16738.61,-7813.35 16732.8,-7802.3 16743.79,-7790.97 16749.69,-7784.89 16756.1,-7779 16762.79,-7773.34"/>
<polygon fill="black" stroke="black" points="16765.24,-7775.86 16770.75,-7766.82 16760.8,-7770.45 16765.24,-7775.86"/>
<text text-anchor="middle" x="16793.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16793.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→7</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge397" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.69C9088.51,-7840.05 9091.67,-7839.47 9094.79,-7838.97 9133.73,-7832.77 14738.28,-7840.04 14772.79,-7820.97 14786.61,-7813.34 14780.8,-7802.3 14791.79,-7790.97 14797.69,-7784.89 14804.1,-7779 14810.79,-7773.34"/>
<polygon fill="black" stroke="black" points="14813.24,-7775.86 14818.75,-7766.82 14808.8,-7770.45 14813.24,-7775.86"/>
<text text-anchor="middle" x="14841.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14841.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge398" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.7C9088.51,-7840.05 9091.67,-7839.47 9094.79,-7838.97 9145.89,-7830.79 12775.51,-7846.04 12820.79,-7820.97 12834.6,-7813.33 12828.8,-7802.3 12839.79,-7790.97 12845.69,-7784.89 12852.1,-7779 12858.79,-7773.34"/>
<polygon fill="black" stroke="black" points="12861.24,-7775.86 12866.75,-7766.82 12856.8,-7770.45 12861.24,-7775.86"/>
<text text-anchor="middle" x="12889.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12889.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→9</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge399" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.04,-7840.53C8897.27,-7839.96 8894.52,-7839.44 8891.79,-7838.97 8866.37,-7834.67 7981.84,-7839.38 7963.79,-7820.97 7929.44,-7785.95 7964.34,-7760.37 8017.39,-7742.39"/>
<polygon fill="black" stroke="black" points="8018.69,-7745.65 8027.12,-7739.24 8016.53,-7738.99 8018.69,-7745.65"/>
<text text-anchor="middle" x="8013.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8013.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge400" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.34,-7840.72C9088.51,-7840.07 9091.67,-7839.48 9094.79,-7838.97 9143.43,-7831.05 10825.74,-7844.95 10868.79,-7820.97 10882.58,-7813.29 10876.8,-7802.3 10887.79,-7790.97 10893.69,-7784.89 10900.1,-7779 10906.79,-7773.34"/>
<polygon fill="black" stroke="black" points="10909.24,-7775.86 10914.75,-7766.82 10904.8,-7770.45 10909.24,-7775.86"/>
<text text-anchor="middle" x="10937.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10937.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→11</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge401" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.47C8897.28,-7839.91 8894.52,-7839.41 8891.79,-7838.97 8851.97,-7832.57 3112.27,-7849.54 3083.79,-7820.97 3049.08,-7786.15 3084.16,-7760.59 3137.45,-7742.57"/>
<polygon fill="black" stroke="black" points="3138.79,-7745.81 3147.23,-7739.4 3136.64,-7739.15 3138.79,-7745.81"/>
<text text-anchor="middle" x="3133.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3133.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge402" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.48C8897.28,-7839.92 8894.52,-7839.42 8891.79,-7838.97 8852.31,-7832.56 6039.99,-7849.35 6011.79,-7820.97 5977.13,-7786.1 6012.23,-7760.53 6065.5,-7742.51"/>
<polygon fill="black" stroke="black" points="6066.85,-7745.75 6075.29,-7739.34 6064.69,-7739.09 6066.85,-7745.75"/>
<text text-anchor="middle" x="6061.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6061.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→13</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge403" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8900.05,-7840.47C8897.28,-7839.91 8894.52,-7839.41 8891.79,-7838.97 8868.95,-7835.31 2246.13,-7837.35 2229.79,-7820.97 2195.07,-7786.16 2230.16,-7760.6 2283.44,-7742.57"/>
<polygon fill="black" stroke="black" points="2284.79,-7745.82 2293.22,-7739.41 2282.63,-7739.16 2284.79,-7745.82"/>
<text text-anchor="middle" x="2279.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2279.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer1_expert2_3&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge404" class="edge">
<title>layer1_expert2_3&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9085.33,-7840.69C9088.51,-7840.05 9091.67,-7839.47 9094.79,-7838.97 9140.43,-7831.71 15708.34,-7843.31 15748.79,-7820.97 15762.61,-7813.35 15756.8,-7802.3 15767.79,-7790.97 15773.69,-7784.89 15780.1,-7779 15786.79,-7773.34"/>
<polygon fill="black" stroke="black" points="15789.24,-7775.86 15794.75,-7766.82 15784.8,-7770.45 15789.24,-7775.86"/>
<text text-anchor="middle" x="15817.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15817.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 6→15</text>
</g>
<!-- layer1_expert_gelu_4 -->
<g id="node149" class="node">
<title>layer1_expert_gelu_4</title>
<ellipse fill="lightgray" stroke="black" cx="12704.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="12704.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="12704.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12704.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert1_4&#45;&gt;layer1_expert_gelu_4 -->
<g id="edge333" class="edge">
<title>layer1_expert1_4&#45;&gt;layer1_expert_gelu_4</title>
<path fill="none" stroke="black" d="M15848.92,-8085.97C15398.22,-8071.13 13384.25,-8004.82 12840.47,-7986.92"/>
<polygon fill="black" stroke="black" points="12840.34,-7983.41 12830.23,-7986.58 12840.11,-7990.41 12840.34,-7983.41"/>
</g>
<!-- layer1_expert2_4 -->
<g id="node150" class="node">
<title>layer1_expert2_4</title>
<polygon fill="lightsteelblue" stroke="black" points="11593.29,-7906.97 11408.29,-7906.97 11408.29,-7838.97 11593.29,-7838.97 11593.29,-7906.97"/>
<text text-anchor="middle" x="11500.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 4 Second Linear</text>
<text text-anchor="middle" x="11500.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11500.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11500.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_4&#45;&gt;layer1_expert2_4 -->
<g id="edge334" class="edge">
<title>layer1_expert_gelu_4&#45;&gt;layer1_expert2_4</title>
<path fill="none" stroke="black" d="M12584.39,-7969.8C12347.57,-7948.86 11825.01,-7902.65 11603.38,-7883.05"/>
<polygon fill="black" stroke="black" points="11603.65,-7879.56 11593.38,-7882.16 11603.03,-7886.53 11603.65,-7879.56"/>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge405" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.65C11243.16,-7860.14 10886.76,-7844.95 10585.79,-7838.97 10517.37,-7837.62 5723.09,-7844.39 5658.79,-7820.97 5639.22,-7813.85 5642.26,-7798.39 5622.79,-7790.97 5566.07,-7769.37 5137.38,-7776.57 5076.79,-7772.97 4882.97,-7761.46 4662.37,-7741.86 4506.4,-7726.9"/>
<polygon fill="black" stroke="black" points="4506.51,-7723.4 4496.22,-7725.93 4505.84,-7730.37 4506.51,-7723.4"/>
<text text-anchor="middle" x="5708.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5708.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge406" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.02,-7871.52C11179.52,-7869.77 10602.52,-7861.36 10525.79,-7820.97 10510.92,-7813.15 10517.76,-7798.61 10502.79,-7790.97 10469.72,-7774.1 9871.84,-7775.36 9834.79,-7772.97 9684.15,-7763.27 9514.54,-7745.76 9386.07,-7731.14"/>
<polygon fill="black" stroke="black" points="9386.45,-7727.66 9376.12,-7730 9385.66,-7734.61 9386.45,-7727.66"/>
<text text-anchor="middle" x="10575.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10575.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→1</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge407" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.81C11243.15,-7860.56 10886.74,-7845.74 10585.79,-7838.97 10557.8,-7838.34 8594.26,-7834.58 8569.79,-7820.97 8556,-7813.3 8564.49,-7798.81 8550.79,-7790.97 8524.45,-7775.9 8035.09,-7774.77 8004.79,-7772.97 7810.97,-7761.46 7590.37,-7741.86 7434.4,-7726.9"/>
<polygon fill="black" stroke="black" points="7434.51,-7723.4 7424.22,-7725.93 7433.84,-7730.37 7434.51,-7723.4"/>
<text text-anchor="middle" x="8619.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8619.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge408" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.45,-7871.27C11974,-7868.15 13398.38,-7854.25 13430.79,-7820.97 13440.09,-7811.42 13440.09,-7800.53 13430.79,-7790.97 13417.84,-7777.67 12781.32,-7774.02 12762.79,-7772.97 12568.93,-7762.04 12348.34,-7742.37 12192.38,-7727.24"/>
<polygon fill="black" stroke="black" points="12192.49,-7723.73 12182.2,-7726.25 12191.82,-7730.7 12192.49,-7723.73"/>
<text text-anchor="middle" x="13486.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13486.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→3</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge409" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.47,-7871.64C12179.59,-7869.42 15348.42,-7855.8 15382.79,-7820.97 15392.16,-7811.48 15392.09,-7800.53 15382.79,-7790.97 15369.84,-7777.67 14733.32,-7774.02 14714.79,-7772.97 14520.93,-7762.04 14300.34,-7742.37 14144.38,-7727.24"/>
<polygon fill="black" stroke="black" points="14144.49,-7723.73 14134.2,-7726.25 14143.82,-7730.7 14144.49,-7723.73"/>
<text text-anchor="middle" x="15438.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15438.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge410" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11499.36,-7838.79C11496.75,-7821.67 11490.44,-7802.1 11475.79,-7790.97 11446.35,-7768.63 10847.69,-7775.06 10810.79,-7772.97 10616.94,-7762.03 10396.34,-7742.36 10240.38,-7727.23"/>
<polygon fill="black" stroke="black" points="10240.49,-7723.73 10230.2,-7726.24 10239.82,-7730.69 10240.49,-7723.73"/>
<text text-anchor="middle" x="11544.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11544.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→5</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge411" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.67C11243.16,-7860.21 10886.75,-7845.09 10585.79,-7838.97 10530.91,-7837.86 6685.23,-7840.13 6633.79,-7820.97 6614.59,-7813.82 6617.89,-7798.4 6598.79,-7790.97 6542.22,-7768.98 6113.38,-7776.57 6052.79,-7772.97 5858.97,-7761.46 5638.37,-7741.86 5482.4,-7726.9"/>
<polygon fill="black" stroke="black" points="5482.51,-7723.4 5472.22,-7725.93 5481.84,-7730.37 5482.51,-7723.4"/>
<text text-anchor="middle" x="6683.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6683.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge412" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.56,-7872.07C12343.71,-7872.74 17390.99,-7875.24 17444.79,-7820.97 17502.53,-7762.74 17260.25,-7732.47 17072.21,-7718.01"/>
<polygon fill="black" stroke="black" points="17072.4,-7714.52 17062.17,-7717.25 17071.88,-7721.5 17072.4,-7714.52"/>
<text text-anchor="middle" x="17502.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="17502.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→7</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge413" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.42,-7871.89C12261.21,-7871.17 16315.24,-7864.98 16358.79,-7820.97 16368.17,-7811.5 16368.09,-7800.53 16358.79,-7790.97 16345.84,-7777.67 15709.32,-7774.02 15690.79,-7772.97 15496.93,-7762.04 15276.34,-7742.37 15120.38,-7727.24"/>
<polygon fill="black" stroke="black" points="15120.49,-7723.73 15110.2,-7726.25 15119.82,-7730.7 15120.49,-7723.73"/>
<text text-anchor="middle" x="16415.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16415.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge414" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.65,-7872.12C12084.48,-7872.65 14356.33,-7872.33 14406.79,-7820.97 14416.14,-7811.46 14416.09,-7800.53 14406.79,-7790.97 14393.84,-7777.67 13757.32,-7774.02 13738.79,-7772.97 13544.93,-7762.04 13324.34,-7742.37 13168.38,-7727.24"/>
<polygon fill="black" stroke="black" points="13168.49,-7723.73 13158.2,-7726.25 13167.82,-7730.7 13168.49,-7723.73"/>
<text text-anchor="middle" x="14462.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14462.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→9</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge415" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.27,-7868.06C11243.13,-7861.21 10886.71,-7847 10585.79,-7838.97 10556.91,-7838.2 9570.98,-7835.12 9545.79,-7820.97 9532.03,-7813.24 9540.49,-7798.81 9526.79,-7790.97 9500.45,-7775.9 9011.09,-7774.77 8980.79,-7772.97 8786.97,-7761.46 8566.37,-7741.86 8410.4,-7726.9"/>
<polygon fill="black" stroke="black" points="8410.51,-7723.4 8400.22,-7725.93 8409.84,-7730.37 8410.51,-7723.4"/>
<text text-anchor="middle" x="9595.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9595.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge416" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.67,-7870.42C11827.76,-7866.05 12425.46,-7851.91 12454.79,-7820.97 12463.96,-7811.3 12464.09,-7800.53 12454.79,-7790.97 12441.84,-7777.67 11805.32,-7774.02 11786.79,-7772.97 11592.93,-7762.04 11372.34,-7742.37 11216.38,-7727.24"/>
<polygon fill="black" stroke="black" points="11216.49,-7723.73 11206.2,-7726.25 11215.82,-7730.7 11216.49,-7723.73"/>
<text text-anchor="middle" x="12510.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12510.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→11</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge417" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.63C11243.16,-7860.1 10886.76,-7844.86 10585.79,-7838.97 10544.81,-7838.17 4721.31,-7834.99 4682.79,-7820.97 4663.22,-7813.85 4666.26,-7798.39 4646.79,-7790.97 4590.07,-7769.37 4161.38,-7776.57 4100.79,-7772.97 3906.97,-7761.46 3686.37,-7741.86 3530.4,-7726.9"/>
<polygon fill="black" stroke="black" points="3530.51,-7723.4 3520.22,-7725.93 3529.84,-7730.37 3530.51,-7723.4"/>
<text text-anchor="middle" x="4732.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4732.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge418" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.72C11243.15,-7860.33 10886.75,-7845.31 10585.79,-7838.97 10544.47,-7838.1 7648.51,-7835.43 7609.79,-7820.97 7590.6,-7813.81 7593.89,-7798.4 7574.79,-7790.97 7518.22,-7768.98 7089.38,-7776.57 7028.79,-7772.97 6834.97,-7761.46 6614.37,-7741.86 6458.4,-7726.9"/>
<polygon fill="black" stroke="black" points="6458.51,-7723.4 6448.22,-7725.93 6457.84,-7730.37 6458.51,-7723.4"/>
<text text-anchor="middle" x="7659.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7659.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→13</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge419" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11408.28,-7867.61C11243.16,-7860.06 10886.76,-7844.79 10585.79,-7838.97 10538.03,-7838.05 3751.69,-7837.3 3706.79,-7820.97 3687.22,-7813.86 3690.26,-7798.39 3670.79,-7790.97 3614.07,-7769.37 3185.35,-7777.06 3124.79,-7772.97 2974.18,-7762.82 2804.57,-7745.32 2676.09,-7730.82"/>
<polygon fill="black" stroke="black" points="2676.47,-7727.34 2666.14,-7729.69 2675.68,-7734.3 2676.47,-7727.34"/>
<text text-anchor="middle" x="3756.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3756.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer1_expert2_4&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge420" class="edge">
<title>layer1_expert2_4&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11593.31,-7872.05C12334.64,-7872.6 17282.02,-7874.21 17334.79,-7820.97 17344.18,-7811.5 17344.09,-7800.53 17334.79,-7790.97 17321.84,-7777.67 16685.32,-7774.02 16666.79,-7772.97 16472.93,-7762.04 16252.34,-7742.37 16096.38,-7727.24"/>
<polygon fill="black" stroke="black" points="16096.49,-7723.73 16086.2,-7726.25 16095.82,-7730.7 16096.49,-7723.73"/>
<text text-anchor="middle" x="17391.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="17391.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 8→15</text>
</g>
<!-- layer1_expert_gelu_5 -->
<g id="node152" class="node">
<title>layer1_expert_gelu_5</title>
<ellipse fill="lightgray" stroke="black" cx="11011.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="11011.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="11011.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11011.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert1_5&#45;&gt;layer1_expert_gelu_5 -->
<g id="edge335" class="edge">
<title>layer1_expert1_5&#45;&gt;layer1_expert_gelu_5</title>
<path fill="none" stroke="black" d="M14025.27,-8085.86C13587.97,-8070.85 11676.08,-8005.24 11147.58,-7987.11"/>
<polygon fill="black" stroke="black" points="11147.36,-7983.6 11137.25,-7986.76 11147.12,-7990.6 11147.36,-7983.6"/>
</g>
<!-- layer1_expert2_5 -->
<g id="node153" class="node">
<title>layer1_expert2_5</title>
<polygon fill="lightsteelblue" stroke="black" points="10576.29,-7906.97 10391.29,-7906.97 10391.29,-7838.97 10576.29,-7838.97 10576.29,-7906.97"/>
<text text-anchor="middle" x="10483.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 5 Second Linear</text>
<text text-anchor="middle" x="10483.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10483.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10483.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_5&#45;&gt;layer1_expert2_5 -->
<g id="edge336" class="edge">
<title>layer1_expert_gelu_5&#45;&gt;layer1_expert2_5</title>
<path fill="none" stroke="black" d="M10908.73,-7959.67C10815.64,-7940.89 10679.37,-7913.41 10586.41,-7894.67"/>
<polygon fill="black" stroke="black" points="10586.92,-7891.2 10576.43,-7892.65 10585.54,-7898.06 10586.92,-7891.2"/>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge421" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.47C10388.28,-7839.91 10385.52,-7839.41 10382.79,-7838.97 10342.78,-7832.54 4584.1,-7838.96 4547.79,-7820.97 4532.74,-7813.52 4538.26,-7801.01 4524.79,-7790.97 4505.39,-7776.52 4483.22,-7764.25 4460.57,-7753.93"/>
<polygon fill="black" stroke="black" points="4461.75,-7750.62 4451.19,-7749.77 4458.91,-7757.02 4461.75,-7750.62"/>
<text text-anchor="middle" x="4597.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4597.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge422" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.53C10388.28,-7839.95 10385.52,-7839.43 10382.79,-7838.97 10330.47,-7830.14 9475.16,-7844.9 9427.79,-7820.97 9412.8,-7813.4 9418.26,-7801.01 9404.79,-7790.97 9385.39,-7776.52 9363.22,-7764.25 9340.57,-7753.93"/>
<polygon fill="black" stroke="black" points="9341.75,-7750.62 9331.19,-7749.77 9338.91,-7757.02 9341.75,-7750.62"/>
<text text-anchor="middle" x="9477.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9477.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→1</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge423" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.48C10388.28,-7839.92 10385.52,-7839.42 10382.79,-7838.97 10342.94,-7832.5 7511.94,-7838.95 7475.79,-7820.97 7460.75,-7813.49 7466.26,-7801.01 7452.79,-7790.97 7433.39,-7776.52 7411.22,-7764.25 7388.57,-7753.93"/>
<polygon fill="black" stroke="black" points="7389.75,-7750.62 7379.19,-7749.77 7386.91,-7757.02 7389.75,-7750.62"/>
<text text-anchor="middle" x="7525.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7525.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge424" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.41,-7868.12C10741.74,-7861.37 11098.55,-7847.31 11399.79,-7838.97 11425.7,-7838.26 12314.64,-7839.48 12332.79,-7820.97 12391.24,-7761.39 12296.85,-7732.8 12192.27,-7719.09"/>
<polygon fill="black" stroke="black" points="12192.48,-7715.59 12182.12,-7717.81 12191.61,-7722.54 12192.48,-7715.59"/>
<text text-anchor="middle" x="12398.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12398.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→3</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge425" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.41,-7867.73C10741.71,-7860.35 11098.5,-7845.34 11399.79,-7838.97 11419.82,-7838.55 14270.67,-7835.19 14284.79,-7820.97 14343.68,-7761.72 14249.05,-7733.12 14144.25,-7719.32"/>
<polygon fill="black" stroke="black" points="14144.45,-7715.82 14134.08,-7718.03 14143.56,-7722.76 14144.45,-7715.82"/>
<text text-anchor="middle" x="14350.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14350.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge426" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10429.87,-7838.78C10421.04,-7833.01 10412.08,-7826.94 10403.79,-7820.97 10386.62,-7808.6 10385.7,-7800.49 10366.79,-7790.97 10324.12,-7769.51 10275.54,-7753.18 10229.01,-7740.88"/>
<polygon fill="black" stroke="black" points="10229.68,-7737.43 10219.12,-7738.31 10227.92,-7744.21 10229.68,-7737.43"/>
<text text-anchor="middle" x="10453.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10453.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→5</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge427" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.47C10388.28,-7839.92 10385.52,-7839.41 10382.79,-7838.97 10316.16,-7828.24 5584.26,-7850.95 5523.79,-7820.97 5508.74,-7813.51 5514.26,-7801.01 5500.79,-7790.97 5481.39,-7776.52 5459.22,-7764.25 5436.57,-7753.93"/>
<polygon fill="black" stroke="black" points="5437.75,-7750.62 5427.19,-7749.77 5434.91,-7757.02 5437.75,-7750.62"/>
<text text-anchor="middle" x="5573.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5573.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge428" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.4,-7867.63C10741.71,-7860.1 11098.49,-7844.87 11399.79,-7838.97 11419.97,-7838.58 17198.54,-7835.27 17212.79,-7820.97 17271.83,-7761.76 17176.97,-7733.16 17072.03,-7719.35"/>
<polygon fill="black" stroke="black" points="17072.21,-7715.84 17061.85,-7718.06 17071.33,-7722.79 17072.21,-7715.84"/>
<text text-anchor="middle" x="17278.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="17278.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→7</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge429" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.4,-7867.68C10741.71,-7860.22 11098.5,-7845.1 11399.79,-7838.97 11426.6,-7838.43 15241.88,-7839.98 15260.79,-7820.97 15319.73,-7761.76 15225.09,-7733.17 15120.29,-7719.35"/>
<polygon fill="black" stroke="black" points="15120.48,-7715.85 15110.12,-7718.06 15119.6,-7722.79 15120.48,-7715.85"/>
<text text-anchor="middle" x="15326.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15326.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge430" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.41,-7867.82C10741.72,-7860.6 11098.51,-7845.82 11399.79,-7838.97 11426.3,-7838.37 13290.13,-7839.81 13308.79,-7820.97 13367.58,-7761.62 13272.96,-7733.03 13168.19,-7719.26"/>
<polygon fill="black" stroke="black" points="13168.38,-7715.75 13158.02,-7717.97 13167.5,-7722.7 13168.38,-7715.75"/>
<text text-anchor="middle" x="13374.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13374.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→9</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge431" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.49C10388.28,-7839.93 10385.52,-7839.42 10382.79,-7838.97 10329.86,-7830.29 8499.78,-7844.93 8451.79,-7820.97 8436.76,-7813.47 8442.26,-7801.01 8428.79,-7790.97 8409.39,-7776.52 8387.22,-7764.25 8364.57,-7753.93"/>
<polygon fill="black" stroke="black" points="8365.75,-7750.62 8355.19,-7749.77 8362.91,-7757.02 8365.75,-7750.62"/>
<text text-anchor="middle" x="8501.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8501.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge432" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.34,-7869.94C10795.59,-7864.68 11330.32,-7849.03 11356.79,-7820.97 11413.96,-7760.37 11320.06,-7731.82 11216.02,-7718.38"/>
<polygon fill="black" stroke="black" points="11216.28,-7714.88 11205.93,-7717.12 11215.42,-7721.83 11216.28,-7714.88"/>
<text text-anchor="middle" x="11422.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11422.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→11</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge433" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.47C10388.28,-7839.91 10385.52,-7839.41 10382.79,-7838.97 10336.09,-7831.47 3614.18,-7841.96 3571.79,-7820.97 3556.73,-7813.52 3562.26,-7801.01 3548.79,-7790.97 3529.39,-7776.52 3507.22,-7764.25 3484.57,-7753.93"/>
<polygon fill="black" stroke="black" points="3485.75,-7750.62 3475.19,-7749.77 3482.91,-7757.02 3485.75,-7750.62"/>
<text text-anchor="middle" x="3621.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3621.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge434" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.47C10388.28,-7839.92 10385.52,-7839.42 10382.79,-7838.97 10329.55,-7830.37 6548.1,-7844.95 6499.79,-7820.97 6484.74,-7813.51 6490.26,-7801.01 6476.79,-7790.97 6457.39,-7776.52 6435.22,-7764.25 6412.57,-7753.93"/>
<polygon fill="black" stroke="black" points="6413.75,-7750.62 6403.19,-7749.77 6410.91,-7757.02 6413.75,-7750.62"/>
<text text-anchor="middle" x="6549.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6549.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→13</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge435" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10391.05,-7840.47C10388.28,-7839.91 10385.52,-7839.41 10382.79,-7838.97 10277.86,-7822.14 2830.68,-7857.27 2730.79,-7820.97 2711.22,-7813.86 2712.77,-7801.49 2694.79,-7790.97 2672.54,-7777.96 2647.91,-7766.26 2623.41,-7756.01"/>
<polygon fill="black" stroke="black" points="2624.6,-7752.72 2614.02,-7752.15 2621.94,-7759.19 2624.6,-7752.72"/>
<text text-anchor="middle" x="2780.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2780.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer1_expert2_5&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge436" class="edge">
<title>layer1_expert2_5&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10576.4,-7867.65C10741.71,-7860.15 11098.5,-7844.96 11399.79,-7838.97 11416.58,-7838.64 16224.94,-7832.87 16236.79,-7820.97 16295.81,-7761.74 16200.95,-7733.14 16096.02,-7719.33"/>
<polygon fill="black" stroke="black" points="16096.2,-7715.83 16085.84,-7718.04 16095.32,-7722.77 16096.2,-7715.83"/>
<text text-anchor="middle" x="16302.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16302.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 10→15</text>
</g>
<!-- layer1_expert_gelu_6 -->
<g id="node155" class="node">
<title>layer1_expert_gelu_6</title>
<ellipse fill="lightgray" stroke="black" cx="5433.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5433.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="5433.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5433.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert1_6&#45;&gt;layer1_expert_gelu_6 -->
<g id="edge337" class="edge">
<title>layer1_expert1_6&#45;&gt;layer1_expert_gelu_6</title>
<path fill="none" stroke="black" d="M3488.53,-8084.23C3811.27,-8067.35 4914.25,-8009.63 5299.6,-7989.47"/>
<polygon fill="black" stroke="black" points="5299.88,-7992.96 5309.68,-7988.94 5299.51,-7985.97 5299.88,-7992.96"/>
</g>
<!-- layer1_expert2_6 -->
<g id="node156" class="node">
<title>layer1_expert2_6</title>
<polygon fill="lightsteelblue" stroke="black" points="8679.29,-7906.97 8494.29,-7906.97 8494.29,-7838.97 8679.29,-7838.97 8679.29,-7906.97"/>
<text text-anchor="middle" x="8586.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 6 Second Linear</text>
<text text-anchor="middle" x="8586.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8586.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8586.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_6&#45;&gt;layer1_expert2_6 -->
<g id="edge338" class="edge">
<title>layer1_expert_gelu_6&#45;&gt;layer1_expert2_6</title>
<path fill="none" stroke="black" d="M5558.76,-7975.02C5732.71,-7967.55 6057.68,-7953.89 6334.79,-7943.97 7164.05,-7914.3 8165.33,-7885.74 8484.13,-7876.82"/>
<polygon fill="black" stroke="black" points="8484.37,-7880.32 8494.27,-7876.54 8484.18,-7873.32 8484.37,-7880.32"/>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge437" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.25,-7871.87C7833.64,-7871.03 3858.52,-7864.17 3815.79,-7820.97 3806.41,-7811.5 3807.21,-7801.18 3815.79,-7790.97 3852.56,-7747.27 3982.78,-7726.16 4099.31,-7715.97"/>
<polygon fill="black" stroke="black" points="4099.8,-7719.44 4109.46,-7715.1 4099.2,-7712.46 4099.8,-7719.44"/>
<text text-anchor="middle" x="3865.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3865.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge438" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8644.69,-7838.81C8654.19,-7833.03 8663.84,-7826.96 8672.79,-7820.97 8691.26,-7808.62 8692.42,-7799.85 8712.79,-7790.97 8796.24,-7754.64 8894.54,-7733.92 8979.62,-7722.11"/>
<polygon fill="black" stroke="black" points="8980.22,-7725.56 8989.66,-7720.75 8979.28,-7718.62 8980.22,-7725.56"/>
<text text-anchor="middle" x="8762.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8762.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→1</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge439" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.28,-7871.15C8124.96,-7867.64 6774.61,-7852.66 6743.79,-7820.97 6734.49,-7811.42 6735.21,-7801.18 6743.79,-7790.97 6780.56,-7747.27 6910.78,-7726.16 7027.31,-7715.97"/>
<polygon fill="black" stroke="black" points="7027.8,-7719.44 7037.46,-7715.1 7027.2,-7712.46 7027.8,-7719.44"/>
<text text-anchor="middle" x="6793.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6793.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge440" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.71C8682.51,-7840.06 8685.67,-7839.48 8688.79,-7838.97 8728.68,-7832.56 11561.81,-7839.35 11597.79,-7820.97 11612.52,-7813.45 11605.98,-7800.06 11619.79,-7790.97 11668.85,-7758.72 11728.6,-7738.68 11785.61,-7726.27"/>
<polygon fill="black" stroke="black" points="11786.41,-7729.67 11795.47,-7724.19 11784.97,-7722.82 11786.41,-7729.67"/>
<text text-anchor="middle" x="11669.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11669.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→3</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge441" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.7C8682.51,-7840.05 8685.67,-7839.47 8688.79,-7838.97 8755.32,-7828.35 13477.18,-7845.87 13539.79,-7820.97 13557.91,-7813.77 13554.58,-7800.13 13571.79,-7790.97 13622.55,-7763.95 13681.72,-7745.53 13737.62,-7732.98"/>
<polygon fill="black" stroke="black" points="13738.63,-7736.34 13747.65,-7730.78 13737.13,-7729.51 13738.63,-7736.34"/>
<text text-anchor="middle" x="13621.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13621.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge442" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.34,-7840.76C8682.51,-7840.09 8685.67,-7839.5 8688.79,-7838.97 8741.4,-7830.17 9602.3,-7847.13 9648.79,-7820.97 9662.55,-7813.24 9654.91,-7800.09 9667.79,-7790.97 9716.1,-7756.8 9776.08,-7736.21 9833.53,-7723.87"/>
<polygon fill="black" stroke="black" points="9834.4,-7727.27 9843.48,-7721.81 9832.98,-7720.41 9834.4,-7727.27"/>
<text text-anchor="middle" x="9717.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9717.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→5</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge443" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8493.87,-7871.61C7914.87,-7869.24 4825.34,-7854.98 4791.79,-7820.97 4782.43,-7811.48 4783.21,-7801.18 4791.79,-7790.97 4828.56,-7747.27 4958.78,-7726.16 5075.31,-7715.97"/>
<polygon fill="black" stroke="black" points="5075.8,-7719.44 5085.46,-7715.1 5075.2,-7712.46 5075.8,-7719.44"/>
<text text-anchor="middle" x="4841.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4841.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge444" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.69C8682.51,-7840.05 8685.67,-7839.47 8688.79,-7838.97 8742.15,-7830.49 16418.73,-7841.3 16468.79,-7820.97 16486.56,-7813.76 16482.94,-7800.12 16499.79,-7790.97 16550.34,-7763.55 16609.44,-7745 16665.34,-7732.46"/>
<polygon fill="black" stroke="black" points="16666.35,-7735.82 16675.37,-7730.27 16664.85,-7728.98 16666.35,-7735.82"/>
<text text-anchor="middle" x="16549.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16549.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→7</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge445" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.69C8682.51,-7840.05 8685.67,-7839.47 8688.79,-7838.97 8768.71,-7826.24 14440.58,-7850.85 14515.79,-7820.97 14533.91,-7813.78 14530.58,-7800.13 14547.79,-7790.97 14598.55,-7763.95 14657.72,-7745.53 14713.62,-7732.98"/>
<polygon fill="black" stroke="black" points="14714.63,-7736.34 14723.65,-7730.78 14713.13,-7729.51 14714.63,-7736.34"/>
<text text-anchor="middle" x="14597.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14597.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge446" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.7C8682.51,-7840.05 8685.67,-7839.47 8688.79,-7838.97 8741.93,-7830.46 12513.79,-7840.88 12563.79,-7820.97 12581.9,-7813.76 12578.58,-7800.13 12595.79,-7790.97 12646.55,-7763.95 12705.72,-7745.53 12761.62,-7732.98"/>
<polygon fill="black" stroke="black" points="12762.63,-7736.34 12771.65,-7730.78 12761.13,-7729.51 12762.63,-7736.34"/>
<text text-anchor="middle" x="12645.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12645.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→9</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge447" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.07,-7869.9C8275.83,-7864.57 7746.04,-7848.81 7719.79,-7820.97 7710.64,-7811.27 7711.21,-7801.18 7719.79,-7790.97 7756.56,-7747.27 7886.78,-7726.16 8003.31,-7715.97"/>
<polygon fill="black" stroke="black" points="8003.8,-7719.44 8013.46,-7715.1 8003.2,-7712.46 8003.8,-7719.44"/>
<text text-anchor="middle" x="7769.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7769.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge448" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.34,-7840.72C8682.51,-7840.07 8685.67,-7839.48 8688.79,-7838.97 8741.88,-7830.35 10577.8,-7847.12 10624.79,-7820.97 10638.58,-7813.3 10630.91,-7800.09 10643.79,-7790.97 10692.1,-7756.8 10752.08,-7736.21 10809.53,-7723.87"/>
<polygon fill="black" stroke="black" points="10810.4,-7727.27 10819.48,-7721.81 10808.98,-7720.41 10810.4,-7727.27"/>
<text text-anchor="middle" x="10693.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10693.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→11</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge449" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.2,-7872.04C7758.95,-7872.48 2891.74,-7873.38 2839.79,-7820.97 2830.41,-7811.5 2831.21,-7801.18 2839.79,-7790.97 2876.56,-7747.27 3006.78,-7726.16 3123.31,-7715.97"/>
<polygon fill="black" stroke="black" points="3123.8,-7719.44 3133.46,-7715.1 3123.2,-7712.46 3123.8,-7719.44"/>
<text text-anchor="middle" x="2889.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2889.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge450" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8493.96,-7872.06C8012.14,-7872.31 5816.64,-7870.71 5767.79,-7820.97 5758.45,-7811.46 5759.21,-7801.18 5767.79,-7790.97 5804.56,-7747.27 5934.78,-7726.16 6051.31,-7715.97"/>
<polygon fill="black" stroke="black" points="6051.8,-7719.44 6061.46,-7715.1 6051.2,-7712.46 6051.8,-7719.44"/>
<text text-anchor="middle" x="5817.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5817.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→13</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge451" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.24,-7871.7C7696.87,-7869.31 2015.81,-7851.23 1985.79,-7820.97 1976.4,-7811.51 1977.21,-7801.18 1985.79,-7790.97 2022.56,-7747.27 2152.78,-7726.16 2269.31,-7715.97"/>
<polygon fill="black" stroke="black" points="2269.8,-7719.44 2279.46,-7715.1 2269.2,-7712.46 2269.8,-7719.44"/>
<text text-anchor="middle" x="2035.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2035.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer1_expert2_6&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge452" class="edge">
<title>layer1_expert2_6&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8679.33,-7840.69C8682.51,-7840.05 8685.67,-7839.47 8688.79,-7838.97 8782.1,-7824.13 15403.97,-7855.84 15491.79,-7820.97 15509.91,-7813.78 15506.58,-7800.13 15523.79,-7790.97 15574.55,-7763.95 15633.72,-7745.53 15689.62,-7732.98"/>
<polygon fill="black" stroke="black" points="15690.63,-7736.34 15699.65,-7730.78 15689.13,-7729.51 15690.63,-7736.34"/>
<text text-anchor="middle" x="15573.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15573.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 12→15</text>
</g>
<!-- layer1_expert_gelu_7 -->
<g id="node158" class="node">
<title>layer1_expert_gelu_7</title>
<ellipse fill="lightgray" stroke="black" cx="10694.79" cy="-7981.45" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="10694.79" y="-7992.75" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="10694.79" y="-7977.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10694.79" y="-7962.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert1_7&#45;&gt;layer1_expert_gelu_7 -->
<g id="edge339" class="edge">
<title>layer1_expert1_7&#45;&gt;layer1_expert_gelu_7</title>
<path fill="none" stroke="black" d="M12200.99,-8089.13C11976.6,-8088.62 11373.69,-8081.06 10875.79,-8018.93 10852.27,-8015.99 10827.24,-8011.71 10803.53,-8007.1"/>
<polygon fill="black" stroke="black" points="10803.95,-8003.62 10793.46,-8005.11 10802.59,-8010.49 10803.95,-8003.62"/>
</g>
<!-- layer1_expert2_7 -->
<g id="node159" class="node">
<title>layer1_expert2_7</title>
<polygon fill="lightsteelblue" stroke="black" points="10373.29,-7906.97 10188.29,-7906.97 10188.29,-7838.97 10373.29,-7838.97 10373.29,-7906.97"/>
<text text-anchor="middle" x="10280.79" y="-7891.77" font-family="Times,serif" font-size="14.00">Expert 7 Second Linear</text>
<text text-anchor="middle" x="10280.79" y="-7876.77" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10280.79" y="-7861.77" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10280.79" y="-7846.77" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer1_expert_gelu_7&#45;&gt;layer1_expert2_7 -->
<g id="edge340" class="edge">
<title>layer1_expert_gelu_7&#45;&gt;layer1_expert2_7</title>
<path fill="none" stroke="black" d="M10593.79,-7958.86C10534.97,-7945.76 10459.25,-7928.02 10383.28,-7907.04"/>
<polygon fill="black" stroke="black" points="10384.1,-7903.64 10373.53,-7904.33 10382.23,-7910.38 10384.1,-7903.64"/>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_0_0 -->
<g id="edge453" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.47C10185.28,-7839.91 10182.52,-7839.41 10179.79,-7838.97 10140.34,-7832.63 4461.6,-7838.71 4425.79,-7820.97 4410.74,-7813.52 4414.39,-7803.13 4402.79,-7790.97 4399.07,-7787.07 4395.17,-7783.16 4391.17,-7779.28"/>
<polygon fill="black" stroke="black" points="4393.53,-7776.69 4383.87,-7772.34 4388.71,-7781.76 4393.53,-7776.69"/>
<text text-anchor="middle" x="4475.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4475.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_0_1 -->
<g id="edge454" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.04,-7840.53C10185.27,-7839.96 10182.52,-7839.44 10179.79,-7838.97 10131.91,-7830.84 9349.12,-7842.91 9305.79,-7820.97 9290.8,-7813.39 9294.39,-7803.13 9282.79,-7790.97 9279.07,-7787.07 9275.17,-7783.16 9271.17,-7779.28"/>
<polygon fill="black" stroke="black" points="9273.53,-7776.69 9263.87,-7772.34 9268.71,-7781.76 9273.53,-7776.69"/>
<text text-anchor="middle" x="9355.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9355.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→1</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_0_2 -->
<g id="edge455" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.48C10185.28,-7839.92 10182.52,-7839.42 10179.79,-7838.97 10102.31,-7826.38 7424.08,-7855.93 7353.79,-7820.97 7338.75,-7813.49 7342.39,-7803.13 7330.79,-7790.97 7327.07,-7787.07 7323.17,-7783.16 7319.17,-7779.28"/>
<polygon fill="black" stroke="black" points="7321.53,-7776.69 7311.87,-7772.34 7316.71,-7781.76 7321.53,-7776.69"/>
<text text-anchor="middle" x="7403.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7403.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_0_3 -->
<g id="edge456" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.34,-7840.72C10376.51,-7840.07 10379.67,-7839.48 10382.79,-7838.97 10407.85,-7834.89 12192.93,-7839.02 12210.79,-7820.97 12241.97,-7789.48 12212.89,-7764.88 12166.68,-7746.69"/>
<polygon fill="black" stroke="black" points="12167.82,-7743.38 12157.23,-7743.14 12165.36,-7749.93 12167.82,-7743.38"/>
<text text-anchor="middle" x="12272.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12272.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→3</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_1_0 -->
<g id="edge457" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.33,-7840.7C10376.51,-7840.05 10379.67,-7839.47 10382.79,-7838.97 10408.71,-7834.82 14144.27,-7839.58 14162.79,-7820.97 14194.13,-7789.49 14164.85,-7764.87 14118.45,-7746.65"/>
<polygon fill="black" stroke="black" points="14119.55,-7743.33 14108.96,-7743.1 14117.09,-7749.88 14119.55,-7743.33"/>
<text text-anchor="middle" x="14225.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14225.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_1_1 -->
<g id="edge458" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10272.03,-7838.96C10266.29,-7822.73 10257.29,-7803.93 10243.79,-7790.97 10229.05,-7776.82 10211.62,-7764.92 10193.23,-7754.93"/>
<polygon fill="black" stroke="black" points="10194.62,-7751.71 10184.13,-7750.19 10191.38,-7757.92 10194.62,-7751.71"/>
<text text-anchor="middle" x="10313.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10313.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→5</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_1_2 -->
<g id="edge459" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.47C10185.28,-7839.92 10182.52,-7839.41 10179.79,-7838.97 10114.28,-7828.42 5461.25,-7850.45 5401.79,-7820.97 5386.74,-7813.51 5390.39,-7803.13 5378.79,-7790.97 5375.07,-7787.07 5371.17,-7783.16 5367.17,-7779.28"/>
<polygon fill="black" stroke="black" points="5369.53,-7776.69 5359.87,-7772.34 5364.71,-7781.76 5369.53,-7776.69"/>
<text text-anchor="middle" x="5451.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5451.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_1_3 -->
<g id="edge460" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.33,-7840.69C10376.51,-7840.05 10379.67,-7839.47 10382.79,-7838.97 10405.79,-7835.31 17074.34,-7837.47 17090.79,-7820.97 17122.16,-7789.52 17092.89,-7764.91 17046.49,-7746.69"/>
<polygon fill="black" stroke="black" points="17047.58,-7743.36 17036.99,-7743.13 17045.13,-7749.92 17047.58,-7743.36"/>
<text text-anchor="middle" x="17153.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="17153.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→7</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_2_0 -->
<g id="edge461" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.33,-7840.7C10376.51,-7840.05 10379.67,-7839.47 10382.79,-7838.97 10415.41,-7833.77 15115.48,-7844.37 15138.79,-7820.97 15170.14,-7789.51 15140.87,-7764.89 15094.47,-7746.67"/>
<polygon fill="black" stroke="black" points="15095.56,-7743.34 15084.97,-7743.11 15093.11,-7749.9 15095.56,-7743.34"/>
<text text-anchor="middle" x="15201.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15201.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_2_1 -->
<g id="edge462" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.33,-7840.71C10376.51,-7840.06 10379.67,-7839.48 10382.79,-7838.97 10421.24,-7832.78 13159.34,-7848.6 13186.79,-7820.97 13218.1,-7789.46 13188.82,-7764.84 13142.42,-7746.63"/>
<polygon fill="black" stroke="black" points="13143.52,-7743.3 13132.93,-7743.07 13141.06,-7749.86 13143.52,-7743.3"/>
<text text-anchor="middle" x="13248.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13248.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→9</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_2_2 -->
<g id="edge463" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.49C10185.28,-7839.93 10182.52,-7839.42 10179.79,-7838.97 10129.08,-7830.65 8375.77,-7843.94 8329.79,-7820.97 8314.76,-7813.47 8318.39,-7803.13 8306.79,-7790.97 8303.07,-7787.07 8299.17,-7783.16 8295.17,-7779.28"/>
<polygon fill="black" stroke="black" points="8297.53,-7776.69 8287.87,-7772.34 8292.71,-7781.76 8297.53,-7776.69"/>
<text text-anchor="middle" x="8379.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8379.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_2_3 -->
<g id="edge464" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.34,-7840.77C10376.52,-7840.1 10379.67,-7839.5 10382.79,-7838.97 10406.13,-7835.04 11218.23,-7837.89 11234.79,-7820.97 11265.72,-7789.38 11236.81,-7764.79 11190.81,-7746.63"/>
<polygon fill="black" stroke="black" points="11191.98,-7743.33 11181.39,-7743.08 11189.52,-7749.88 11191.98,-7743.33"/>
<text text-anchor="middle" x="11296.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11296.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→11</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_3_0 -->
<g id="edge465" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.47C10185.28,-7839.91 10182.52,-7839.41 10179.79,-7838.97 10133.65,-7831.56 3491.68,-7841.71 3449.79,-7820.97 3434.73,-7813.52 3438.39,-7803.13 3426.79,-7790.97 3423.07,-7787.07 3419.17,-7783.16 3415.17,-7779.28"/>
<polygon fill="black" stroke="black" points="3417.53,-7776.69 3407.87,-7772.34 3412.71,-7781.76 3417.53,-7776.69"/>
<text text-anchor="middle" x="3499.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3499.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_3_1 -->
<g id="edge466" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.47C10185.28,-7839.92 10182.52,-7839.42 10179.79,-7838.97 10127.66,-7830.55 6425.09,-7844.45 6377.79,-7820.97 6362.74,-7813.5 6366.39,-7803.13 6354.79,-7790.97 6351.07,-7787.07 6347.17,-7783.16 6343.17,-7779.28"/>
<polygon fill="black" stroke="black" points="6345.53,-7776.69 6335.87,-7772.34 6340.71,-7781.76 6345.53,-7776.69"/>
<text text-anchor="middle" x="6427.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6427.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→13</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_3_2 -->
<g id="edge467" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10188.05,-7840.47C10185.28,-7839.91 10182.52,-7839.41 10179.79,-7838.97 10127.79,-7830.63 2642.99,-7844.33 2595.79,-7820.97 2580.73,-7813.52 2584.39,-7803.13 2572.79,-7790.97 2569.07,-7787.07 2565.17,-7783.16 2561.17,-7779.28"/>
<polygon fill="black" stroke="black" points="2563.53,-7776.69 2553.87,-7772.34 2558.71,-7781.76 2563.53,-7776.69"/>
<text text-anchor="middle" x="2645.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2645.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer1_expert2_7&#45;&gt;layer1_expert_agg_3_3 -->
<g id="edge468" class="edge">
<title>layer1_expert2_7&#45;&gt;layer1_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10373.33,-7840.69C10376.51,-7840.05 10379.67,-7839.47 10382.79,-7838.97 10422.1,-7832.71 16086.69,-7849.17 16114.79,-7820.97 16146.15,-7789.52 16116.88,-7764.9 16070.48,-7746.68"/>
<polygon fill="black" stroke="black" points="16071.57,-7743.36 16060.98,-7743.12 16069.12,-7749.91 16071.57,-7743.36"/>
<text text-anchor="middle" x="16177.29" y="-7809.77" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16177.29" y="-7794.77" font-family="Times,serif" font-size="14.00">GPU 14→15</text>
</g>
<!-- layer1_res2 -->
<g id="node176" class="node">
<title>layer1_res2</title>
<ellipse fill="lightpink" stroke="black" cx="9401.79" cy="-7455.26" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="9401.79" y="-7466.56" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="9401.79" y="-7451.56" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9401.79" y="-7436.56" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer1_expert_agg_0_0&#45;&gt;layer1_res2 -->
<g id="edge469" class="edge">
<title>layer1_expert_agg_0_0&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M4495.85,-7685.49C4652.33,-7670.7 4878.6,-7650.6 5076.79,-7637.92 6705.54,-7533.77 8683.3,-7475.6 9245.85,-7460.34"/>
<polygon fill="black" stroke="black" points="9246.16,-7463.83 9256.06,-7460.07 9245.97,-7456.84 9246.16,-7463.83"/>
</g>
<!-- layer1_expert_agg_0_1&#45;&gt;layer1_res2 -->
<g id="edge470" class="edge">
<title>layer1_expert_agg_0_1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M9241.77,-7637.61C9259.41,-7617.62 9279.29,-7595.08 9298.89,-7572.87"/>
<polygon fill="black" stroke="black" points="9301.53,-7575.17 9305.53,-7565.35 9296.29,-7570.54 9301.53,-7575.17"/>
</g>
<!-- layer1_expert_agg_0_2&#45;&gt;layer1_res2 -->
<g id="edge471" class="edge">
<title>layer1_expert_agg_0_2&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M7423.93,-7682.37C7849.19,-7633.75 8859.39,-7518.27 9246.84,-7473.97"/>
<polygon fill="black" stroke="black" points="9247.46,-7477.43 9257,-7472.81 9246.66,-7470.47 9247.46,-7477.43"/>
</g>
<!-- layer1_expert_agg_0_3&#45;&gt;layer1_res2 -->
<g id="edge472" class="edge">
<title>layer1_expert_agg_0_3&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M11795.67,-7685.92C11302.72,-7638.63 10005.24,-7514.15 9556.85,-7471.13"/>
<polygon fill="black" stroke="black" points="9557.03,-7467.64 9546.74,-7470.16 9556.36,-7474.6 9557.03,-7467.64"/>
</g>
<!-- layer1_expert_agg_1_0&#45;&gt;layer1_res2 -->
<g id="edge473" class="edge">
<title>layer1_expert_agg_1_0&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M13747.71,-7685.83C13591.22,-7671.23 13364.94,-7651.21 13166.79,-7637.92 11767.77,-7544.08 10073.15,-7480.07 9557.81,-7461.69"/>
<polygon fill="black" stroke="black" points="9557.82,-7458.19 9547.71,-7461.33 9557.57,-7465.18 9557.82,-7458.19"/>
</g>
<!-- layer1_expert_agg_1_1&#45;&gt;layer1_res2 -->
<g id="edge474" class="edge">
<title>layer1_expert_agg_1_1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M9908.67,-7654.37C9803.94,-7613.44 9655.9,-7555.58 9546.83,-7512.95"/>
<polygon fill="black" stroke="black" points="9547.98,-7509.64 9537.39,-7509.26 9545.43,-7516.16 9547.98,-7509.64"/>
</g>
<!-- layer1_expert_agg_1_2&#45;&gt;layer1_res2 -->
<g id="edge475" class="edge">
<title>layer1_expert_agg_1_2&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M5471.9,-7686.15C5628.4,-7671.73 5854.68,-7651.81 6052.79,-7637.92 7282.33,-7551.76 8768.28,-7483.88 9245.96,-7462.96"/>
<polygon fill="black" stroke="black" points="9246.19,-7466.45 9256.02,-7462.52 9245.88,-7459.46 9246.19,-7466.45"/>
</g>
<!-- layer1_expert_agg_1_3&#45;&gt;layer1_res2 -->
<g id="edge476" class="edge">
<title>layer1_expert_agg_1_3&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M16675.38,-7684.66C16518.95,-7669.42 16292.9,-7649.12 16094.79,-7637.92 13483.74,-7490.4 10292.68,-7461.87 9557.75,-7457.12"/>
<polygon fill="black" stroke="black" points="9557.66,-7453.62 9547.64,-7457.05 9557.61,-7460.62 9557.66,-7453.62"/>
</g>
<!-- layer1_expert_agg_2_0&#45;&gt;layer1_res2 -->
<g id="edge477" class="edge">
<title>layer1_expert_agg_2_0&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M14723.74,-7685.3C14567.27,-7670.39 14341.01,-7650.23 14142.79,-7637.92 12342.7,-7526.14 10153.58,-7472.68 9557.77,-7459.55"/>
<polygon fill="black" stroke="black" points="9557.48,-7456.04 9547.41,-7459.32 9557.33,-7463.04 9557.48,-7456.04"/>
</g>
<!-- layer1_expert_agg_2_1&#45;&gt;layer1_res2 -->
<g id="edge478" class="edge">
<title>layer1_expert_agg_2_1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M12771.65,-7686.73C12615.12,-7672.64 12388.82,-7652.88 12190.79,-7637.92 11187.99,-7562.18 9980.9,-7490.01 9557.57,-7465.27"/>
<polygon fill="black" stroke="black" points="9557.6,-7461.77 9547.41,-7464.68 9557.19,-7468.76 9557.6,-7461.77"/>
</g>
<!-- layer1_expert_agg_2_2&#45;&gt;layer1_res2 -->
<g id="edge479" class="edge">
<title>layer1_expert_agg_2_2&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M8378.01,-7668.89C8611.39,-7620.42 9025.82,-7534.35 9249.12,-7487.97"/>
<polygon fill="black" stroke="black" points="9249.87,-7491.39 9258.95,-7485.92 9248.45,-7484.53 9249.87,-7491.39"/>
</g>
<!-- layer1_expert_agg_2_3&#45;&gt;layer1_res2 -->
<g id="edge480" class="edge">
<title>layer1_expert_agg_2_3&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M10822.85,-7675.19C10500.3,-7625.5 9851.72,-7525.57 9555.58,-7479.95"/>
<polygon fill="black" stroke="black" points="9556.04,-7476.48 9545.63,-7478.42 9554.98,-7483.4 9556.04,-7476.48"/>
</g>
<!-- layer1_expert_agg_3_0&#45;&gt;layer1_res2 -->
<g id="edge481" class="edge">
<title>layer1_expert_agg_3_0&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M3520.22,-7685.04C3676.67,-7670.02 3902.72,-7649.82 4100.79,-7637.92 6132.45,-7515.88 8607.42,-7469.16 9245.76,-7458.67"/>
<polygon fill="black" stroke="black" points="9246,-7462.17 9255.94,-7458.5 9245.88,-7455.17 9246,-7462.17"/>
</g>
<!-- layer1_expert_agg_3_1&#45;&gt;layer1_res2 -->
<g id="edge482" class="edge">
<title>layer1_expert_agg_3_1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M6447.99,-7687.34C6604.54,-7673.6 6830.85,-7654.01 7028.79,-7637.92 7864.65,-7570.01 8866.72,-7495.59 9246.06,-7467.68"/>
<polygon fill="black" stroke="black" points="9246.56,-7471.15 9256.28,-7466.92 9246.05,-7464.17 9246.56,-7471.15"/>
</g>
<!-- layer1_expert_agg_3_2&#45;&gt;layer1_res2 -->
<g id="edge483" class="edge">
<title>layer1_expert_agg_3_2&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M2666.13,-7681C2795.7,-7666.2 2970.24,-7648.03 3124.79,-7637.92 5560.93,-7478.6 8538.04,-7459.01 9245.67,-7456.6"/>
<polygon fill="black" stroke="black" points="9245.93,-7460.1 9255.92,-7456.56 9245.91,-7453.1 9245.93,-7460.1"/>
</g>
<!-- layer1_expert_agg_3_3&#45;&gt;layer1_res2 -->
<g id="edge484" class="edge">
<title>layer1_expert_agg_3_3&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M15699.37,-7684.91C15542.92,-7669.81 15316.88,-7649.57 15118.79,-7637.92 12914.55,-7508.27 10226.39,-7466.79 9557.87,-7458.13"/>
<polygon fill="black" stroke="black" points="9557.74,-7454.63 9547.69,-7458 9557.65,-7461.63 9557.74,-7454.63"/>
</g>
<!-- layer2_ln1_0_0 -->
<g id="node177" class="node">
<title>layer2_ln1_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="4871.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="4871.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4871.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="4871.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4871.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_0_0 -->
<g id="edge485" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_0_0</title>
<path fill="none" stroke="black" d="M9256.17,-7450.27C8731.5,-7435.33 6888.79,-7378.15 5371.79,-7272.6 5251.23,-7264.21 5114.63,-7251.1 5014.72,-7240.84"/>
<polygon fill="black" stroke="black" points="5014.86,-7237.34 5004.55,-7239.79 5014.14,-7244.3 5014.86,-7237.34"/>
</g>
<!-- layer2_ln1_0_1 -->
<g id="node178" class="node">
<title>layer2_ln1_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="5520.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="5520.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5520.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="5520.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5520.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_0_1 -->
<g id="edge486" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_0_1</title>
<path fill="none" stroke="black" d="M9256.1,-7449.24C8782.12,-7432.33 7241.22,-7372.84 5969.79,-7272.6 5866.72,-7264.47 5750.65,-7252.21 5662.34,-7242.25"/>
<polygon fill="black" stroke="black" points="5662.59,-7238.75 5652.26,-7241.1 5661.8,-7245.71 5662.59,-7238.75"/>
</g>
<!-- layer2_ln1_0_2 -->
<g id="node179" class="node">
<title>layer2_ln1_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6118.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6118.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6118.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="6118.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6118.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_0_2 -->
<g id="edge487" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_0_2</title>
<path fill="none" stroke="black" d="M9256.14,-7446.22C8842.86,-7423.08 7627.59,-7352.84 6619.79,-7272.6 6499.29,-7263 6362.68,-7250.02 6262.58,-7240.12"/>
<polygon fill="black" stroke="black" points="6262.7,-7236.62 6252.4,-7239.11 6262.01,-7243.58 6262.7,-7236.62"/>
</g>
<!-- layer2_ln1_0_3 -->
<g id="node180" class="node">
<title>layer2_ln1_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="6768.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6768.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6768.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="6768.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6768.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_0_3 -->
<g id="edge488" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_0_3</title>
<path fill="none" stroke="black" d="M9256.31,-7444.25C8899.97,-7419.32 7955.21,-7350.84 7168.79,-7272.6 7082.56,-7264.01 6986.07,-7252.71 6909.47,-7243.32"/>
<polygon fill="black" stroke="black" points="6909.62,-7239.82 6899.27,-7242.07 6908.77,-7246.76 6909.62,-7239.82"/>
</g>
<!-- layer2_ln1_1_0 -->
<g id="node181" class="node">
<title>layer2_ln1_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="7317.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7317.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7317.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="7317.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7317.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_1_0 -->
<g id="edge489" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_1_0</title>
<path fill="none" stroke="black" d="M9256.9,-7438.36C8874.34,-7396.36 7840.53,-7282.89 7460.48,-7241.17"/>
<polygon fill="black" stroke="black" points="7460.85,-7237.69 7450.53,-7240.08 7460.08,-7244.65 7460.85,-7237.69"/>
</g>
<!-- layer2_ln1_1_1 -->
<g id="node182" class="node">
<title>layer2_ln1_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7966.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7966.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7966.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7966.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7966.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_1_1 -->
<g id="edge490" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_1_1</title>
<path fill="none" stroke="black" d="M9257.96,-7431.33C8980.3,-7387.07 8373.94,-7290.41 8102.68,-7247.17"/>
<polygon fill="black" stroke="black" points="8103.21,-7243.71 8092.78,-7245.6 8102.1,-7250.63 8103.21,-7243.71"/>
</g>
<!-- layer2_ln1_1_2 -->
<g id="node183" class="node">
<title>layer2_ln1_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="8590.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8590.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8590.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="8590.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8590.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_1_2 -->
<g id="edge491" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_1_2</title>
<path fill="none" stroke="black" d="M9261.45,-7414.68C9104.79,-7370.49 8854.1,-7299.78 8707.66,-7258.48"/>
<polygon fill="black" stroke="black" points="8708.31,-7255.02 8697.74,-7255.68 8706.41,-7261.76 8708.31,-7255.02"/>
</g>
<!-- layer2_ln1_1_3 -->
<g id="node184" class="node">
<title>layer2_ln1_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="9231.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9231.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9231.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="9231.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9231.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_1_3 -->
<g id="edge492" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_1_3</title>
<path fill="none" stroke="black" d="M9315.3,-7337.88C9300.21,-7317.58 9285.19,-7297.36 9272.13,-7279.79"/>
<polygon fill="black" stroke="black" points="9274.66,-7277.33 9265.89,-7271.39 9269.04,-7281.51 9274.66,-7277.33"/>
</g>
<!-- layer2_ln1_2_0 -->
<g id="node185" class="node">
<title>layer2_ln1_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="9573.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9573.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9573.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9573.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9573.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_2_0 -->
<g id="edge493" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_2_0</title>
<path fill="none" stroke="black" d="M9489.05,-7338.21C9504.42,-7317.78 9519.73,-7297.41 9533.02,-7279.73"/>
<polygon fill="black" stroke="black" points="9536.16,-7281.38 9539.38,-7271.28 9530.57,-7277.17 9536.16,-7281.38"/>
</g>
<!-- layer2_ln1_2_1 -->
<g id="node186" class="node">
<title>layer2_ln1_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="10213.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10213.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10213.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="10213.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10213.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_2_1 -->
<g id="edge494" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_2_1</title>
<path fill="none" stroke="black" d="M9541.84,-7414.81C9698.73,-7370.61 9950.21,-7299.76 10096.94,-7258.43"/>
<polygon fill="black" stroke="black" points="10098.21,-7261.71 10106.89,-7255.63 10096.32,-7254.97 10098.21,-7261.71"/>
</g>
<!-- layer2_ln1_2_2 -->
<g id="node187" class="node">
<title>layer2_ln1_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="10864.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10864.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10864.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="10864.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10864.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_2_2 -->
<g id="edge495" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_2_2</title>
<path fill="none" stroke="black" d="M9545.74,-7431.75C9828.25,-7387.58 10451.81,-7290.08 10728.25,-7246.86"/>
<polygon fill="black" stroke="black" points="10729,-7250.29 10738.33,-7245.28 10727.91,-7243.37 10729,-7250.29"/>
</g>
<!-- layer2_ln1_2_3 -->
<g id="node188" class="node">
<title>layer2_ln1_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="11515.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="11515.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11515.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="11515.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11515.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_2_3 -->
<g id="edge496" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_2_3</title>
<path fill="none" stroke="black" d="M9546.68,-7438.58C9933.62,-7396.71 10987.89,-7282.63 11372.73,-7240.99"/>
<polygon fill="black" stroke="black" points="11373.24,-7244.46 11382.8,-7239.9 11372.49,-7237.5 11373.24,-7244.46"/>
</g>
<!-- layer2_ln1_3_0 -->
<g id="node189" class="node">
<title>layer2_ln1_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12181.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12181.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12181.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="12181.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12181.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_3_0 -->
<g id="edge497" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_3_0</title>
<path fill="none" stroke="black" d="M9547.12,-7443.14C9906.43,-7415.52 10865.39,-7341.08 11664.79,-7272.6 11790.59,-7261.82 11933.52,-7248.74 12037.16,-7239.1"/>
<polygon fill="black" stroke="black" points="12037.75,-7242.56 12047.39,-7238.15 12037.1,-7235.59 12037.75,-7242.56"/>
</g>
<!-- layer2_ln1_3_1 -->
<g id="node190" class="node">
<title>layer2_ln1_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="12798.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12798.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12798.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="12798.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12798.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_3_1 -->
<g id="edge498" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_3_1</title>
<path fill="none" stroke="black" d="M9547.46,-7447.2C9975.06,-7426.07 11263.76,-7359.33 12330.79,-7272.6 12440.14,-7263.71 12563.62,-7251.18 12656.28,-7241.28"/>
<polygon fill="black" stroke="black" points="12656.71,-7244.75 12666.28,-7240.21 12655.96,-7237.79 12656.71,-7244.75"/>
</g>
<!-- layer2_ln1_3_2 -->
<g id="node191" class="node">
<title>layer2_ln1_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="13502.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="13502.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13502.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="13502.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13502.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_3_2 -->
<g id="edge499" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_3_2</title>
<path fill="none" stroke="black" d="M9547.56,-7448.54C10031.51,-7429.19 11628.98,-7362.29 12947.79,-7272.6 13087.33,-7263.1 13246.35,-7249.31 13358.3,-7239.1"/>
<polygon fill="black" stroke="black" points="13358.67,-7242.58 13368.31,-7238.19 13358.03,-7235.61 13358.67,-7242.58"/>
</g>
<!-- layer2_ln1_3_3 -->
<g id="node192" class="node">
<title>layer2_ln1_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="14178.79" cy="-7224.51" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="14178.79" y="-7243.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="14178.79" y="-7228.31" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="14178.79" y="-7213.31" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14178.79" y="-7198.31" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1_3_3 -->
<g id="edge500" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1_3_3</title>
<path fill="none" stroke="black" d="M9547.8,-7450.47C10090.7,-7435.88 12044.39,-7378.7 13651.79,-7272.6 13781.65,-7264.02 13929.19,-7250.52 14035.06,-7240.17"/>
<polygon fill="black" stroke="black" points="14035.57,-7243.63 14045.18,-7239.17 14034.88,-7236.67 14035.57,-7243.63"/>
</g>
<!-- layer2_q_proj_0_0 -->
<g id="node193" class="node">
<title>layer2_q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="4713.29,-7139.43 4540.29,-7139.43 4540.29,-7056.43 4713.29,-7056.43 4713.29,-7139.43"/>
<text text-anchor="middle" x="4626.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4626.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="4626.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4626.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4626.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_0&#45;&gt;layer2_q_proj_0_0 -->
<g id="edge501" class="edge">
<title>layer2_ln1_0_0&#45;&gt;layer2_q_proj_0_0</title>
<path fill="none" stroke="black" d="M4794.61,-7184.26C4769.51,-7171.5 4741.47,-7157.24 4715.59,-7144.09"/>
<polygon fill="black" stroke="black" points="4717.04,-7140.89 4706.54,-7139.48 4713.87,-7147.13 4717.04,-7140.89"/>
</g>
<!-- layer2_k_proj_0_0 -->
<g id="node194" class="node">
<title>layer2_k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="4904.29,-7139.43 4731.29,-7139.43 4731.29,-7056.43 4904.29,-7056.43 4904.29,-7139.43"/>
<text text-anchor="middle" x="4817.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4817.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="4817.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4817.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4817.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_0&#45;&gt;layer2_k_proj_0_0 -->
<g id="edge502" class="edge">
<title>layer2_ln1_0_0&#45;&gt;layer2_k_proj_0_0</title>
<path fill="none" stroke="black" d="M4851.53,-7176.77C4847.62,-7167.75 4843.51,-7158.26 4839.56,-7149.14"/>
<polygon fill="black" stroke="black" points="4842.69,-7147.58 4835.51,-7139.8 4836.27,-7150.36 4842.69,-7147.58"/>
</g>
<!-- layer2_v_proj_0_0 -->
<g id="node195" class="node">
<title>layer2_v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="5095.29,-7139.43 4922.29,-7139.43 4922.29,-7056.43 5095.29,-7056.43 5095.29,-7139.43"/>
<text text-anchor="middle" x="5008.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5008.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="5008.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5008.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5008.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_0&#45;&gt;layer2_v_proj_0_0 -->
<g id="edge503" class="edge">
<title>layer2_ln1_0_0&#45;&gt;layer2_v_proj_0_0</title>
<path fill="none" stroke="black" d="M4920.48,-7179.24C4932.09,-7168.68 4944.53,-7157.37 4956.3,-7146.67"/>
<polygon fill="black" stroke="black" points="4958.88,-7149.05 4963.92,-7139.73 4954.17,-7143.87 4958.88,-7149.05"/>
</g>
<!-- layer2_q_proj_0_1 -->
<g id="node196" class="node">
<title>layer2_q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5303.79,-7139.43 5113.79,-7139.43 5113.79,-7056.43 5303.79,-7056.43 5303.79,-7139.43"/>
<text text-anchor="middle" x="5208.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5208.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="5208.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5208.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="5208.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_1&#45;&gt;layer2_q_proj_0_1 -->
<g id="edge504" class="edge">
<title>layer2_ln1_0_1&#45;&gt;layer2_q_proj_0_1</title>
<path fill="none" stroke="black" d="M5430.55,-7187.48C5393.96,-7172.87 5351.48,-7155.9 5313.54,-7140.75"/>
<polygon fill="black" stroke="black" points="5314.58,-7137.4 5304,-7136.94 5311.98,-7143.9 5314.58,-7137.4"/>
</g>
<!-- layer2_k_proj_0_1 -->
<g id="node197" class="node">
<title>layer2_k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5511.79,-7139.43 5321.79,-7139.43 5321.79,-7056.43 5511.79,-7056.43 5511.79,-7139.43"/>
<text text-anchor="middle" x="5416.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5416.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="5416.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5416.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="5416.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_1&#45;&gt;layer2_k_proj_0_1 -->
<g id="edge505" class="edge">
<title>layer2_ln1_0_1&#45;&gt;layer2_k_proj_0_1</title>
<path fill="none" stroke="black" d="M5482.95,-7178.18C5474.53,-7168.09 5465.57,-7157.36 5457.05,-7147.16"/>
<polygon fill="black" stroke="black" points="5459.74,-7144.91 5450.64,-7139.48 5454.36,-7149.4 5459.74,-7144.91"/>
</g>
<!-- layer2_v_proj_0_1 -->
<g id="node198" class="node">
<title>layer2_v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5719.79,-7139.43 5529.79,-7139.43 5529.79,-7056.43 5719.79,-7056.43 5719.79,-7139.43"/>
<text text-anchor="middle" x="5624.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5624.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="5624.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5624.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="5624.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_1&#45;&gt;layer2_v_proj_0_1 -->
<g id="edge506" class="edge">
<title>layer2_ln1_0_1&#45;&gt;layer2_v_proj_0_1</title>
<path fill="none" stroke="black" d="M5558.63,-7178.18C5567.06,-7168.09 5576.01,-7157.36 5584.53,-7147.16"/>
<polygon fill="black" stroke="black" points="5587.22,-7149.4 5590.94,-7139.48 5581.85,-7144.91 5587.22,-7149.4"/>
</g>
<!-- layer2_q_proj_0_2 -->
<g id="node199" class="node">
<title>layer2_q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="5927.79,-7139.43 5737.79,-7139.43 5737.79,-7056.43 5927.79,-7056.43 5927.79,-7139.43"/>
<text text-anchor="middle" x="5832.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5832.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="5832.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5832.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5832.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_2&#45;&gt;layer2_q_proj_0_2 -->
<g id="edge507" class="edge">
<title>layer2_ln1_0_2&#45;&gt;layer2_q_proj_0_2</title>
<path fill="none" stroke="black" d="M6033.37,-7186.3C6002.58,-7172.89 5967.52,-7157.62 5935.42,-7143.63"/>
<polygon fill="black" stroke="black" points="5936.57,-7140.32 5926.01,-7139.53 5933.78,-7146.74 5936.57,-7140.32"/>
</g>
<!-- layer2_k_proj_0_2 -->
<g id="node200" class="node">
<title>layer2_k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="6135.79,-7139.43 5945.79,-7139.43 5945.79,-7056.43 6135.79,-7056.43 6135.79,-7139.43"/>
<text text-anchor="middle" x="6040.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6040.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="6040.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6040.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6040.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_2&#45;&gt;layer2_k_proj_0_2 -->
<g id="edge508" class="edge">
<title>layer2_ln1_0_2&#45;&gt;layer2_k_proj_0_2</title>
<path fill="none" stroke="black" d="M6089.75,-7177.12C6083.84,-7167.69 6077.62,-7157.74 6071.65,-7148.22"/>
<polygon fill="black" stroke="black" points="6074.54,-7146.24 6066.27,-7139.62 6068.61,-7149.95 6074.54,-7146.24"/>
</g>
<!-- layer2_v_proj_0_2 -->
<g id="node201" class="node">
<title>layer2_v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="6343.79,-7139.43 6153.79,-7139.43 6153.79,-7056.43 6343.79,-7056.43 6343.79,-7139.43"/>
<text text-anchor="middle" x="6248.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6248.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="6248.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6248.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6248.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_2&#45;&gt;layer2_v_proj_0_2 -->
<g id="edge509" class="edge">
<title>layer2_ln1_0_2&#45;&gt;layer2_v_proj_0_2</title>
<path fill="none" stroke="black" d="M6165.36,-7178.89C6176.25,-7168.45 6187.89,-7157.29 6198.92,-7146.72"/>
<polygon fill="black" stroke="black" points="6201.65,-7148.96 6206.44,-7139.51 6196.8,-7143.9 6201.65,-7148.96"/>
</g>
<!-- layer2_q_proj_0_3 -->
<g id="node202" class="node">
<title>layer2_q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6551.79,-7139.43 6361.79,-7139.43 6361.79,-7056.43 6551.79,-7056.43 6551.79,-7139.43"/>
<text text-anchor="middle" x="6456.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6456.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="6456.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6456.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6456.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_3&#45;&gt;layer2_q_proj_0_3 -->
<g id="edge510" class="edge">
<title>layer2_ln1_0_3&#45;&gt;layer2_q_proj_0_3</title>
<path fill="none" stroke="black" d="M6678.55,-7187.48C6641.96,-7172.87 6599.48,-7155.9 6561.54,-7140.75"/>
<polygon fill="black" stroke="black" points="6562.58,-7137.4 6552,-7136.94 6559.98,-7143.9 6562.58,-7137.4"/>
</g>
<!-- layer2_k_proj_0_3 -->
<g id="node203" class="node">
<title>layer2_k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6759.79,-7139.43 6569.79,-7139.43 6569.79,-7056.43 6759.79,-7056.43 6759.79,-7139.43"/>
<text text-anchor="middle" x="6664.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6664.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="6664.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6664.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6664.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_3&#45;&gt;layer2_k_proj_0_3 -->
<g id="edge511" class="edge">
<title>layer2_ln1_0_3&#45;&gt;layer2_k_proj_0_3</title>
<path fill="none" stroke="black" d="M6730.95,-7178.18C6722.53,-7168.09 6713.57,-7157.36 6705.05,-7147.16"/>
<polygon fill="black" stroke="black" points="6707.74,-7144.91 6698.64,-7139.48 6702.36,-7149.4 6707.74,-7144.91"/>
</g>
<!-- layer2_v_proj_0_3 -->
<g id="node204" class="node">
<title>layer2_v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6967.79,-7139.43 6777.79,-7139.43 6777.79,-7056.43 6967.79,-7056.43 6967.79,-7139.43"/>
<text text-anchor="middle" x="6872.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6872.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="6872.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6872.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6872.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_0_3&#45;&gt;layer2_v_proj_0_3 -->
<g id="edge512" class="edge">
<title>layer2_ln1_0_3&#45;&gt;layer2_v_proj_0_3</title>
<path fill="none" stroke="black" d="M6806.63,-7178.18C6815.06,-7168.09 6824.01,-7157.36 6832.53,-7147.16"/>
<polygon fill="black" stroke="black" points="6835.22,-7149.4 6838.94,-7139.48 6829.85,-7144.91 6835.22,-7149.4"/>
</g>
<!-- layer2_q_proj_1_0 -->
<g id="node205" class="node">
<title>layer2_q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7159.29,-7139.43 6986.29,-7139.43 6986.29,-7056.43 7159.29,-7056.43 7159.29,-7139.43"/>
<text text-anchor="middle" x="7072.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7072.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="7072.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7072.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7072.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_0&#45;&gt;layer2_q_proj_1_0 -->
<g id="edge513" class="edge">
<title>layer2_ln1_1_0&#45;&gt;layer2_q_proj_1_0</title>
<path fill="none" stroke="black" d="M7240.61,-7184.26C7215.51,-7171.5 7187.47,-7157.24 7161.59,-7144.09"/>
<polygon fill="black" stroke="black" points="7163.04,-7140.89 7152.54,-7139.48 7159.87,-7147.13 7163.04,-7140.89"/>
</g>
<!-- layer2_k_proj_1_0 -->
<g id="node206" class="node">
<title>layer2_k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7350.29,-7139.43 7177.29,-7139.43 7177.29,-7056.43 7350.29,-7056.43 7350.29,-7139.43"/>
<text text-anchor="middle" x="7263.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7263.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="7263.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7263.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7263.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_0&#45;&gt;layer2_k_proj_1_0 -->
<g id="edge514" class="edge">
<title>layer2_ln1_1_0&#45;&gt;layer2_k_proj_1_0</title>
<path fill="none" stroke="black" d="M7297.53,-7176.77C7293.62,-7167.75 7289.51,-7158.26 7285.56,-7149.14"/>
<polygon fill="black" stroke="black" points="7288.69,-7147.58 7281.51,-7139.8 7282.27,-7150.36 7288.69,-7147.58"/>
</g>
<!-- layer2_v_proj_1_0 -->
<g id="node207" class="node">
<title>layer2_v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7541.29,-7139.43 7368.29,-7139.43 7368.29,-7056.43 7541.29,-7056.43 7541.29,-7139.43"/>
<text text-anchor="middle" x="7454.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7454.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="7454.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7454.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7454.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_0&#45;&gt;layer2_v_proj_1_0 -->
<g id="edge515" class="edge">
<title>layer2_ln1_1_0&#45;&gt;layer2_v_proj_1_0</title>
<path fill="none" stroke="black" d="M7366.48,-7179.24C7378.09,-7168.68 7390.53,-7157.37 7402.3,-7146.67"/>
<polygon fill="black" stroke="black" points="7404.88,-7149.05 7409.92,-7139.73 7400.17,-7143.87 7404.88,-7149.05"/>
</g>
<!-- layer2_q_proj_1_1 -->
<g id="node208" class="node">
<title>layer2_q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7749.79,-7139.43 7559.79,-7139.43 7559.79,-7056.43 7749.79,-7056.43 7749.79,-7139.43"/>
<text text-anchor="middle" x="7654.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7654.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="7654.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7654.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7654.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_1&#45;&gt;layer2_q_proj_1_1 -->
<g id="edge516" class="edge">
<title>layer2_ln1_1_1&#45;&gt;layer2_q_proj_1_1</title>
<path fill="none" stroke="black" d="M7876.55,-7187.48C7839.96,-7172.87 7797.48,-7155.9 7759.54,-7140.75"/>
<polygon fill="black" stroke="black" points="7760.58,-7137.4 7750,-7136.94 7757.98,-7143.9 7760.58,-7137.4"/>
</g>
<!-- layer2_k_proj_1_1 -->
<g id="node209" class="node">
<title>layer2_k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7957.79,-7139.43 7767.79,-7139.43 7767.79,-7056.43 7957.79,-7056.43 7957.79,-7139.43"/>
<text text-anchor="middle" x="7862.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7862.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="7862.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7862.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7862.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_1&#45;&gt;layer2_k_proj_1_1 -->
<g id="edge517" class="edge">
<title>layer2_ln1_1_1&#45;&gt;layer2_k_proj_1_1</title>
<path fill="none" stroke="black" d="M7928.95,-7178.18C7920.53,-7168.09 7911.57,-7157.36 7903.05,-7147.16"/>
<polygon fill="black" stroke="black" points="7905.74,-7144.91 7896.64,-7139.48 7900.36,-7149.4 7905.74,-7144.91"/>
</g>
<!-- layer2_v_proj_1_1 -->
<g id="node210" class="node">
<title>layer2_v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="8165.79,-7139.43 7975.79,-7139.43 7975.79,-7056.43 8165.79,-7056.43 8165.79,-7139.43"/>
<text text-anchor="middle" x="8070.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8070.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="8070.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8070.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8070.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_1&#45;&gt;layer2_v_proj_1_1 -->
<g id="edge518" class="edge">
<title>layer2_ln1_1_1&#45;&gt;layer2_v_proj_1_1</title>
<path fill="none" stroke="black" d="M8004.63,-7178.18C8013.06,-7168.09 8022.01,-7157.36 8030.53,-7147.16"/>
<polygon fill="black" stroke="black" points="8033.22,-7149.4 8036.94,-7139.48 8027.85,-7144.91 8033.22,-7149.4"/>
</g>
<!-- layer2_q_proj_1_2 -->
<g id="node211" class="node">
<title>layer2_q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8373.79,-7139.43 8183.79,-7139.43 8183.79,-7056.43 8373.79,-7056.43 8373.79,-7139.43"/>
<text text-anchor="middle" x="8278.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8278.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="8278.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8278.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8278.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_2&#45;&gt;layer2_q_proj_1_2 -->
<g id="edge519" class="edge">
<title>layer2_ln1_1_2&#45;&gt;layer2_q_proj_1_2</title>
<path fill="none" stroke="black" d="M8500.55,-7187.48C8463.96,-7172.87 8421.48,-7155.9 8383.54,-7140.75"/>
<polygon fill="black" stroke="black" points="8384.58,-7137.4 8374,-7136.94 8381.98,-7143.9 8384.58,-7137.4"/>
</g>
<!-- layer2_k_proj_1_2 -->
<g id="node212" class="node">
<title>layer2_k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8581.79,-7139.43 8391.79,-7139.43 8391.79,-7056.43 8581.79,-7056.43 8581.79,-7139.43"/>
<text text-anchor="middle" x="8486.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8486.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="8486.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8486.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8486.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_2&#45;&gt;layer2_k_proj_1_2 -->
<g id="edge520" class="edge">
<title>layer2_ln1_1_2&#45;&gt;layer2_k_proj_1_2</title>
<path fill="none" stroke="black" d="M8552.95,-7178.18C8544.53,-7168.09 8535.57,-7157.36 8527.05,-7147.16"/>
<polygon fill="black" stroke="black" points="8529.74,-7144.91 8520.64,-7139.48 8524.36,-7149.4 8529.74,-7144.91"/>
</g>
<!-- layer2_v_proj_1_2 -->
<g id="node213" class="node">
<title>layer2_v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8789.79,-7139.43 8599.79,-7139.43 8599.79,-7056.43 8789.79,-7056.43 8789.79,-7139.43"/>
<text text-anchor="middle" x="8694.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8694.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="8694.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8694.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8694.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_2&#45;&gt;layer2_v_proj_1_2 -->
<g id="edge521" class="edge">
<title>layer2_ln1_1_2&#45;&gt;layer2_v_proj_1_2</title>
<path fill="none" stroke="black" d="M8628.63,-7178.18C8637.06,-7168.09 8646.01,-7157.36 8654.53,-7147.16"/>
<polygon fill="black" stroke="black" points="8657.22,-7149.4 8660.94,-7139.48 8651.85,-7144.91 8657.22,-7149.4"/>
</g>
<!-- layer2_q_proj_1_3 -->
<g id="node214" class="node">
<title>layer2_q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8997.79,-7139.43 8807.79,-7139.43 8807.79,-7056.43 8997.79,-7056.43 8997.79,-7139.43"/>
<text text-anchor="middle" x="8902.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8902.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="8902.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8902.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8902.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_3&#45;&gt;layer2_q_proj_1_3 -->
<g id="edge522" class="edge">
<title>layer2_ln1_1_3&#45;&gt;layer2_q_proj_1_3</title>
<path fill="none" stroke="black" d="M9137.81,-7188.72C9099.88,-7174.6 9055.49,-7157.97 9007.34,-7139.63"/>
<polygon fill="black" stroke="black" points="9008.58,-7136.35 8997.99,-7136.06 9006.08,-7142.89 9008.58,-7136.35"/>
</g>
<!-- layer2_k_proj_1_3 -->
<g id="node215" class="node">
<title>layer2_k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="9205.79,-7139.43 9015.79,-7139.43 9015.79,-7056.43 9205.79,-7056.43 9205.79,-7139.43"/>
<text text-anchor="middle" x="9110.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9110.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="9110.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9110.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9110.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_3&#45;&gt;layer2_k_proj_1_3 -->
<g id="edge523" class="edge">
<title>layer2_ln1_1_3&#45;&gt;layer2_k_proj_1_3</title>
<path fill="none" stroke="black" d="M9188.11,-7178.53C9178.19,-7168.33 9167.63,-7157.45 9157.59,-7147.11"/>
<polygon fill="black" stroke="black" points="9159.87,-7144.44 9150.39,-7139.7 9154.85,-7149.31 9159.87,-7144.44"/>
</g>
<!-- layer2_v_proj_1_3 -->
<g id="node216" class="node">
<title>layer2_v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="9413.79,-7139.43 9223.79,-7139.43 9223.79,-7056.43 9413.79,-7056.43 9413.79,-7139.43"/>
<text text-anchor="middle" x="9318.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9318.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="9318.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9318.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9318.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_1_3&#45;&gt;layer2_v_proj_1_3 -->
<g id="edge524" class="edge">
<title>layer2_ln1_1_3&#45;&gt;layer2_v_proj_1_3</title>
<path fill="none" stroke="black" d="M9263.94,-7177.48C9270.68,-7167.83 9277.81,-7157.62 9284.62,-7147.86"/>
<polygon fill="black" stroke="black" points="9287.65,-7149.64 9290.5,-7139.44 9281.91,-7145.63 9287.65,-7149.64"/>
</g>
<!-- layer2_q_proj_2_0 -->
<g id="node217" class="node">
<title>layer2_q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9613.29,-7139.43 9432.29,-7139.43 9432.29,-7056.43 9613.29,-7056.43 9613.29,-7139.43"/>
<text text-anchor="middle" x="9522.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9522.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="9522.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9522.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9522.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_0&#45;&gt;layer2_q_proj_2_0 -->
<g id="edge525" class="edge">
<title>layer2_ln1_2_0&#45;&gt;layer2_q_proj_2_0</title>
<path fill="none" stroke="black" d="M9554.66,-7176.77C9550.96,-7167.75 9547.08,-7158.26 9543.35,-7149.14"/>
<polygon fill="black" stroke="black" points="9546.55,-7147.73 9539.52,-7139.8 9540.07,-7150.38 9546.55,-7147.73"/>
</g>
<!-- layer2_k_proj_2_0 -->
<g id="node218" class="node">
<title>layer2_k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9812.29,-7139.43 9631.29,-7139.43 9631.29,-7056.43 9812.29,-7056.43 9812.29,-7139.43"/>
<text text-anchor="middle" x="9721.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9721.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="9721.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9721.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9721.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_0&#45;&gt;layer2_k_proj_2_0 -->
<g id="edge526" class="edge">
<title>layer2_ln1_2_0&#45;&gt;layer2_k_proj_2_0</title>
<path fill="none" stroke="black" d="M9625.97,-7179.59C9638.79,-7168.8 9652.57,-7157.2 9665.57,-7146.26"/>
<polygon fill="black" stroke="black" points="9668.15,-7148.66 9673.55,-7139.54 9663.64,-7143.3 9668.15,-7148.66"/>
</g>
<!-- layer2_v_proj_2_0 -->
<g id="node219" class="node">
<title>layer2_v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10011.29,-7139.43 9830.29,-7139.43 9830.29,-7056.43 10011.29,-7056.43 10011.29,-7139.43"/>
<text text-anchor="middle" x="9920.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9920.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="9920.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9920.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9920.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_0&#45;&gt;layer2_v_proj_2_0 -->
<g id="edge527" class="edge">
<title>layer2_ln1_2_0&#45;&gt;layer2_v_proj_2_0</title>
<path fill="none" stroke="black" d="M9674.44,-7190.95C9717.14,-7176.75 9767.58,-7159.49 9820.65,-7139.8"/>
<polygon fill="black" stroke="black" points="9822.09,-7143 9830.24,-7136.23 9819.65,-7136.44 9822.09,-7143"/>
</g>
<!-- layer2_q_proj_2_1 -->
<g id="node220" class="node">
<title>layer2_q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10228.29,-7139.43 10029.29,-7139.43 10029.29,-7056.43 10228.29,-7056.43 10228.29,-7139.43"/>
<text text-anchor="middle" x="10128.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10128.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="10128.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10128.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10128.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_1&#45;&gt;layer2_q_proj_2_1 -->
<g id="edge528" class="edge">
<title>layer2_ln1_2_1&#45;&gt;layer2_q_proj_2_1</title>
<path fill="none" stroke="black" d="M10182.38,-7177.48C10175.8,-7167.83 10168.83,-7157.62 10162.18,-7147.86"/>
<polygon fill="black" stroke="black" points="10164.96,-7145.73 10156.43,-7139.44 10159.18,-7149.67 10164.96,-7145.73"/>
</g>
<!-- layer2_k_proj_2_1 -->
<g id="node221" class="node">
<title>layer2_k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10445.29,-7139.43 10246.29,-7139.43 10246.29,-7056.43 10445.29,-7056.43 10445.29,-7139.43"/>
<text text-anchor="middle" x="10345.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10345.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="10345.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10345.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10345.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_1&#45;&gt;layer2_k_proj_2_1 -->
<g id="edge529" class="edge">
<title>layer2_ln1_2_1&#45;&gt;layer2_k_proj_2_1</title>
<path fill="none" stroke="black" d="M10261.07,-7178.89C10272.24,-7168.35 10284.18,-7157.07 10295.48,-7146.41"/>
<polygon fill="black" stroke="black" points="10297.92,-7148.92 10302.79,-7139.51 10293.12,-7143.83 10297.92,-7148.92"/>
</g>
<!-- layer2_v_proj_2_1 -->
<g id="node222" class="node">
<title>layer2_v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10662.29,-7139.43 10463.29,-7139.43 10463.29,-7056.43 10662.29,-7056.43 10662.29,-7139.43"/>
<text text-anchor="middle" x="10562.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10562.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="10562.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10562.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10562.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_1&#45;&gt;layer2_v_proj_2_1 -->
<g id="edge530" class="edge">
<title>layer2_ln1_2_1&#45;&gt;layer2_v_proj_2_1</title>
<path fill="none" stroke="black" d="M10311.59,-7189.96C10352.89,-7175.66 10401.7,-7158.57 10453.4,-7139.92"/>
<polygon fill="black" stroke="black" points="10454.87,-7143.11 10463.08,-7136.42 10452.49,-7136.52 10454.87,-7143.11"/>
</g>
<!-- layer2_q_proj_2_2 -->
<g id="node223" class="node">
<title>layer2_q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="10879.29,-7139.43 10680.29,-7139.43 10680.29,-7056.43 10879.29,-7056.43 10879.29,-7139.43"/>
<text text-anchor="middle" x="10779.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10779.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="10779.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10779.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10779.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_2&#45;&gt;layer2_q_proj_2_2 -->
<g id="edge531" class="edge">
<title>layer2_ln1_2_2&#45;&gt;layer2_q_proj_2_2</title>
<path fill="none" stroke="black" d="M10833.38,-7177.48C10826.8,-7167.83 10819.83,-7157.62 10813.18,-7147.86"/>
<polygon fill="black" stroke="black" points="10815.96,-7145.73 10807.43,-7139.44 10810.18,-7149.67 10815.96,-7145.73"/>
</g>
<!-- layer2_k_proj_2_2 -->
<g id="node224" class="node">
<title>layer2_k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="11096.29,-7139.43 10897.29,-7139.43 10897.29,-7056.43 11096.29,-7056.43 11096.29,-7139.43"/>
<text text-anchor="middle" x="10996.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10996.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="10996.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10996.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10996.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_2&#45;&gt;layer2_k_proj_2_2 -->
<g id="edge532" class="edge">
<title>layer2_ln1_2_2&#45;&gt;layer2_k_proj_2_2</title>
<path fill="none" stroke="black" d="M10912.07,-7178.89C10923.24,-7168.35 10935.18,-7157.07 10946.48,-7146.41"/>
<polygon fill="black" stroke="black" points="10948.92,-7148.92 10953.79,-7139.51 10944.12,-7143.83 10948.92,-7148.92"/>
</g>
<!-- layer2_v_proj_2_2 -->
<g id="node225" class="node">
<title>layer2_v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="11313.29,-7139.43 11114.29,-7139.43 11114.29,-7056.43 11313.29,-7056.43 11313.29,-7139.43"/>
<text text-anchor="middle" x="11213.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11213.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="11213.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11213.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="11213.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_2&#45;&gt;layer2_v_proj_2_2 -->
<g id="edge533" class="edge">
<title>layer2_ln1_2_2&#45;&gt;layer2_v_proj_2_2</title>
<path fill="none" stroke="black" d="M10962.59,-7189.96C11003.89,-7175.66 11052.7,-7158.57 11104.4,-7139.92"/>
<polygon fill="black" stroke="black" points="11105.87,-7143.11 11114.08,-7136.42 11103.49,-7136.52 11105.87,-7143.11"/>
</g>
<!-- layer2_q_proj_2_3 -->
<g id="node226" class="node">
<title>layer2_q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="11530.29,-7139.43 11331.29,-7139.43 11331.29,-7056.43 11530.29,-7056.43 11530.29,-7139.43"/>
<text text-anchor="middle" x="11430.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11430.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="11430.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11430.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11430.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_3&#45;&gt;layer2_q_proj_2_3 -->
<g id="edge534" class="edge">
<title>layer2_ln1_2_3&#45;&gt;layer2_q_proj_2_3</title>
<path fill="none" stroke="black" d="M11484.38,-7177.48C11477.8,-7167.83 11470.83,-7157.62 11464.18,-7147.86"/>
<polygon fill="black" stroke="black" points="11466.96,-7145.73 11458.43,-7139.44 11461.18,-7149.67 11466.96,-7145.73"/>
</g>
<!-- layer2_k_proj_2_3 -->
<g id="node227" class="node">
<title>layer2_k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="11747.29,-7139.43 11548.29,-7139.43 11548.29,-7056.43 11747.29,-7056.43 11747.29,-7139.43"/>
<text text-anchor="middle" x="11647.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11647.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="11647.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11647.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11647.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_3&#45;&gt;layer2_k_proj_2_3 -->
<g id="edge535" class="edge">
<title>layer2_ln1_2_3&#45;&gt;layer2_k_proj_2_3</title>
<path fill="none" stroke="black" d="M11563.07,-7178.89C11574.24,-7168.35 11586.18,-7157.07 11597.48,-7146.41"/>
<polygon fill="black" stroke="black" points="11599.92,-7148.92 11604.79,-7139.51 11595.12,-7143.83 11599.92,-7148.92"/>
</g>
<!-- layer2_v_proj_2_3 -->
<g id="node228" class="node">
<title>layer2_v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="11964.29,-7139.43 11765.29,-7139.43 11765.29,-7056.43 11964.29,-7056.43 11964.29,-7139.43"/>
<text text-anchor="middle" x="11864.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11864.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="11864.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11864.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11864.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_2_3&#45;&gt;layer2_v_proj_2_3 -->
<g id="edge536" class="edge">
<title>layer2_ln1_2_3&#45;&gt;layer2_v_proj_2_3</title>
<path fill="none" stroke="black" d="M11613.59,-7189.96C11654.89,-7175.66 11703.7,-7158.57 11755.4,-7139.92"/>
<polygon fill="black" stroke="black" points="11756.87,-7143.11 11765.08,-7136.42 11754.49,-7136.52 11756.87,-7143.11"/>
</g>
<!-- layer2_q_proj_3_0 -->
<g id="node229" class="node">
<title>layer2_q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12172.79,-7139.43 11982.79,-7139.43 11982.79,-7056.43 12172.79,-7056.43 12172.79,-7139.43"/>
<text text-anchor="middle" x="12077.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12077.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="12077.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12077.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12077.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_0&#45;&gt;layer2_q_proj_3_0 -->
<g id="edge537" class="edge">
<title>layer2_ln1_3_0&#45;&gt;layer2_q_proj_3_0</title>
<path fill="none" stroke="black" d="M12143.95,-7178.18C12135.53,-7168.09 12126.57,-7157.36 12118.05,-7147.16"/>
<polygon fill="black" stroke="black" points="12120.74,-7144.91 12111.64,-7139.48 12115.36,-7149.4 12120.74,-7144.91"/>
</g>
<!-- layer2_k_proj_3_0 -->
<g id="node230" class="node">
<title>layer2_k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12380.79,-7139.43 12190.79,-7139.43 12190.79,-7056.43 12380.79,-7056.43 12380.79,-7139.43"/>
<text text-anchor="middle" x="12285.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12285.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="12285.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12285.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12285.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_0&#45;&gt;layer2_k_proj_3_0 -->
<g id="edge538" class="edge">
<title>layer2_ln1_3_0&#45;&gt;layer2_k_proj_3_0</title>
<path fill="none" stroke="black" d="M12219.63,-7178.18C12228.06,-7168.09 12237.01,-7157.36 12245.53,-7147.16"/>
<polygon fill="black" stroke="black" points="12248.22,-7149.4 12251.94,-7139.48 12242.85,-7144.91 12248.22,-7149.4"/>
</g>
<!-- layer2_v_proj_3_0 -->
<g id="node231" class="node">
<title>layer2_v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12588.79,-7139.43 12398.79,-7139.43 12398.79,-7056.43 12588.79,-7056.43 12588.79,-7139.43"/>
<text text-anchor="middle" x="12493.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12493.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="12493.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12493.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12493.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_0&#45;&gt;layer2_v_proj_3_0 -->
<g id="edge539" class="edge">
<title>layer2_ln1_3_0&#45;&gt;layer2_v_proj_3_0</title>
<path fill="none" stroke="black" d="M12272.03,-7187.48C12308.62,-7172.87 12351.11,-7155.9 12389.05,-7140.75"/>
<polygon fill="black" stroke="black" points="12390.6,-7143.9 12398.59,-7136.94 12388,-7137.4 12390.6,-7143.9"/>
</g>
<!-- layer2_q_proj_3_1 -->
<g id="node232" class="node">
<title>layer2_q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="12814.79,-7139.43 12606.79,-7139.43 12606.79,-7056.43 12814.79,-7056.43 12814.79,-7139.43"/>
<text text-anchor="middle" x="12710.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12710.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="12710.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12710.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12710.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_1&#45;&gt;layer2_q_proj_3_1 -->
<g id="edge540" class="edge">
<title>layer2_ln1_3_1&#45;&gt;layer2_q_proj_3_1</title>
<path fill="none" stroke="black" d="M12766.27,-7177.48C12759.46,-7167.83 12752.25,-7157.62 12745.36,-7147.86"/>
<polygon fill="black" stroke="black" points="12748.03,-7145.59 12739.41,-7139.44 12742.32,-7149.63 12748.03,-7145.59"/>
</g>
<!-- layer2_k_proj_3_1 -->
<g id="node233" class="node">
<title>layer2_k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13040.79,-7139.43 12832.79,-7139.43 12832.79,-7056.43 13040.79,-7056.43 13040.79,-7139.43"/>
<text text-anchor="middle" x="12936.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12936.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="12936.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12936.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12936.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_1&#45;&gt;layer2_k_proj_3_1 -->
<g id="edge541" class="edge">
<title>layer2_ln1_3_1&#45;&gt;layer2_k_proj_3_1</title>
<path fill="none" stroke="black" d="M12847.83,-7179.24C12859.53,-7168.68 12872.06,-7157.37 12883.91,-7146.67"/>
<polygon fill="black" stroke="black" points="12886.52,-7149.03 12891.59,-7139.73 12881.82,-7143.84 12886.52,-7149.03"/>
</g>
<!-- layer2_v_proj_3_1 -->
<g id="node234" class="node">
<title>layer2_v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13266.79,-7139.43 13058.79,-7139.43 13058.79,-7056.43 13266.79,-7056.43 13266.79,-7139.43"/>
<text text-anchor="middle" x="13162.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13162.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="13162.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13162.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13162.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_1&#45;&gt;layer2_v_proj_3_1 -->
<g id="edge542" class="edge">
<title>layer2_ln1_3_1&#45;&gt;layer2_v_proj_3_1</title>
<path fill="none" stroke="black" d="M12898.5,-7190.64C12942.1,-7176.14 12994.04,-7158.69 13049.16,-7139.63"/>
<polygon fill="black" stroke="black" points="13050.46,-7142.89 13058.76,-7136.31 13048.17,-7136.27 13050.46,-7142.89"/>
</g>
<!-- layer2_q_proj_3_2 -->
<g id="node235" class="node">
<title>layer2_q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13492.79,-7139.43 13284.79,-7139.43 13284.79,-7056.43 13492.79,-7056.43 13492.79,-7139.43"/>
<text text-anchor="middle" x="13388.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13388.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="13388.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13388.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13388.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_2&#45;&gt;layer2_q_proj_3_2 -->
<g id="edge543" class="edge">
<title>layer2_ln1_3_2&#45;&gt;layer2_q_proj_3_2</title>
<path fill="none" stroke="black" d="M13461.63,-7178.53C13452.29,-7168.33 13442.34,-7157.45 13432.88,-7147.11"/>
<polygon fill="black" stroke="black" points="13435.43,-7144.71 13426.1,-7139.7 13430.27,-7149.44 13435.43,-7144.71"/>
</g>
<!-- layer2_k_proj_3_2 -->
<g id="node236" class="node">
<title>layer2_k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13718.79,-7139.43 13510.79,-7139.43 13510.79,-7056.43 13718.79,-7056.43 13718.79,-7139.43"/>
<text text-anchor="middle" x="13614.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13614.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="13614.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13614.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13614.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_2&#45;&gt;layer2_k_proj_3_2 -->
<g id="edge544" class="edge">
<title>layer2_ln1_3_2&#45;&gt;layer2_k_proj_3_2</title>
<path fill="none" stroke="black" d="M13543.54,-7178.18C13552.61,-7168.09 13562.26,-7157.36 13571.43,-7147.16"/>
<polygon fill="black" stroke="black" points="13574.25,-7149.25 13578.34,-7139.48 13569.05,-7144.57 13574.25,-7149.25"/>
</g>
<!-- layer2_v_proj_3_2 -->
<g id="node237" class="node">
<title>layer2_v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13944.79,-7139.43 13736.79,-7139.43 13736.79,-7056.43 13944.79,-7056.43 13944.79,-7139.43"/>
<text text-anchor="middle" x="13840.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13840.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="13840.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13840.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13840.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_2&#45;&gt;layer2_v_proj_3_2 -->
<g id="edge545" class="edge">
<title>layer2_ln1_3_2&#45;&gt;layer2_v_proj_3_2</title>
<path fill="none" stroke="black" d="M13596.94,-7188.81C13637.35,-7173.92 13684.91,-7156.39 13727.25,-7140.78"/>
<polygon fill="black" stroke="black" points="13728.58,-7144.02 13736.76,-7137.27 13726.16,-7137.45 13728.58,-7144.02"/>
</g>
<!-- layer2_q_proj_3_3 -->
<g id="node238" class="node">
<title>layer2_q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="14170.79,-7139.43 13962.79,-7139.43 13962.79,-7056.43 14170.79,-7056.43 14170.79,-7139.43"/>
<text text-anchor="middle" x="14066.79" y="-7124.23" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14066.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="14066.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14066.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14066.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_3&#45;&gt;layer2_q_proj_3_3 -->
<g id="edge546" class="edge">
<title>layer2_ln1_3_3&#45;&gt;layer2_q_proj_3_3</title>
<path fill="none" stroke="black" d="M14138.04,-7178.18C14128.97,-7168.09 14119.32,-7157.36 14110.15,-7147.16"/>
<polygon fill="black" stroke="black" points="14112.53,-7144.57 14103.25,-7139.48 14107.33,-7149.25 14112.53,-7144.57"/>
</g>
<!-- layer2_k_proj_3_3 -->
<g id="node239" class="node">
<title>layer2_k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="14396.79,-7139.43 14188.79,-7139.43 14188.79,-7056.43 14396.79,-7056.43 14396.79,-7139.43"/>
<text text-anchor="middle" x="14292.79" y="-7124.23" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="14292.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="14292.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14292.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14292.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_3&#45;&gt;layer2_k_proj_3_3 -->
<g id="edge547" class="edge">
<title>layer2_ln1_3_3&#45;&gt;layer2_k_proj_3_3</title>
<path fill="none" stroke="black" d="M14219.95,-7178.53C14229.29,-7168.33 14239.25,-7157.45 14248.7,-7147.11"/>
<polygon fill="black" stroke="black" points="14251.31,-7149.44 14255.48,-7139.7 14246.15,-7144.71 14251.31,-7149.44"/>
</g>
<!-- layer2_v_proj_3_3 -->
<g id="node240" class="node">
<title>layer2_v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="14622.79,-7139.43 14414.79,-7139.43 14414.79,-7056.43 14622.79,-7056.43 14622.79,-7139.43"/>
<text text-anchor="middle" x="14518.79" y="-7124.23" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14518.79" y="-7109.23" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="14518.79" y="-7094.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="14518.79" y="-7079.23" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14518.79" y="-7064.23" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_ln1_3_3&#45;&gt;layer2_v_proj_3_3 -->
<g id="edge548" class="edge">
<title>layer2_ln1_3_3&#45;&gt;layer2_v_proj_3_3</title>
<path fill="none" stroke="black" d="M14273.5,-7188.81C14314.33,-7173.85 14362.42,-7156.23 14405.15,-7140.57"/>
<polygon fill="black" stroke="black" points="14406.56,-7143.78 14414.75,-7137.05 14404.15,-7137.21 14406.56,-7143.78"/>
</g>
<!-- layer2_attention_0_0 -->
<g id="node241" class="node">
<title>layer2_attention_0_0</title>
<polygon fill="lightcoral" stroke="black" points="4936.79,-7019.43 4710.79,-6936.43 4936.79,-6853.43 5162.79,-6936.43 4936.79,-7019.43"/>
<text text-anchor="middle" x="4936.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4936.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="4936.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="4936.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="4936.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_q_proj_0_0&#45;&gt;layer2_attention_0_0 -->
<g id="edge549" class="edge">
<title>layer2_q_proj_0_0&#45;&gt;layer2_attention_0_0</title>
<path fill="none" stroke="black" d="M4705.82,-7056.27C4744.93,-7036.15 4792.6,-7011.61 4834.47,-6990.08"/>
<polygon fill="black" stroke="black" points="4836.29,-6993.07 4843.58,-6985.39 4833.09,-6986.85 4836.29,-6993.07"/>
</g>
<!-- layer2_k_proj_0_0&#45;&gt;layer2_attention_0_0 -->
<g id="edge550" class="edge">
<title>layer2_k_proj_0_0&#45;&gt;layer2_attention_0_0</title>
<path fill="none" stroke="black" d="M4848.13,-7056.27C4858.62,-7042.2 4870.73,-7025.97 4882.56,-7010.12"/>
<polygon fill="black" stroke="black" points="4885.53,-7011.99 4888.7,-7001.88 4879.92,-7007.8 4885.53,-7011.99"/>
</g>
<!-- layer2_v_proj_0_0&#45;&gt;layer2_attention_0_0 -->
<g id="edge551" class="edge">
<title>layer2_v_proj_0_0&#45;&gt;layer2_attention_0_0</title>
<path fill="none" stroke="black" d="M4990.44,-7056.27C4985.05,-7044.34 4978.97,-7030.87 4972.89,-7017.39"/>
<polygon fill="black" stroke="black" points="4975.99,-7015.75 4968.68,-7008.08 4969.61,-7018.63 4975.99,-7015.75"/>
</g>
<!-- layer2_attention_0_1 -->
<g id="node242" class="node">
<title>layer2_attention_0_1</title>
<polygon fill="lightcoral" stroke="black" points="5493.79,-7019.43 5267.79,-6936.43 5493.79,-6853.43 5719.79,-6936.43 5493.79,-7019.43"/>
<text text-anchor="middle" x="5493.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5493.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="5493.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5493.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5493.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_q_proj_0_1&#45;&gt;layer2_attention_0_1 -->
<g id="edge552" class="edge">
<title>layer2_q_proj_0_1&#45;&gt;layer2_attention_0_1</title>
<path fill="none" stroke="black" d="M5281.45,-7056.27C5316.33,-7036.74 5358.64,-7013.07 5396.28,-6992"/>
<polygon fill="black" stroke="black" points="5398.22,-6994.93 5405.24,-6986.99 5394.8,-6988.82 5398.22,-6994.93"/>
</g>
<!-- layer2_k_proj_0_1&#45;&gt;layer2_attention_0_1 -->
<g id="edge553" class="edge">
<title>layer2_k_proj_0_1&#45;&gt;layer2_attention_0_1</title>
<path fill="none" stroke="black" d="M5436.42,-7056.27C5442.34,-7044 5449.05,-7030.1 5455.75,-7016.23"/>
<polygon fill="black" stroke="black" points="5458.94,-7017.67 5460.14,-7007.14 5452.64,-7014.63 5458.94,-7017.67"/>
</g>
<!-- layer2_v_proj_0_1&#45;&gt;layer2_attention_0_1 -->
<g id="edge554" class="edge">
<title>layer2_v_proj_0_1&#45;&gt;layer2_attention_0_1</title>
<path fill="none" stroke="black" d="M5591.4,-7056.27C5579.47,-7041.75 5565.67,-7024.94 5552.26,-7008.62"/>
<polygon fill="black" stroke="black" points="5554.77,-7006.16 5545.72,-7000.65 5549.36,-7010.6 5554.77,-7006.16"/>
</g>
<!-- layer2_attention_0_2 -->
<g id="node243" class="node">
<title>layer2_attention_0_2</title>
<polygon fill="lightcoral" stroke="black" points="6040.79,-7019.43 5814.79,-6936.43 6040.79,-6853.43 6266.79,-6936.43 6040.79,-7019.43"/>
<text text-anchor="middle" x="6040.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6040.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="6040.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6040.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6040.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_q_proj_0_2&#45;&gt;layer2_attention_0_2 -->
<g id="edge555" class="edge">
<title>layer2_q_proj_0_2&#45;&gt;layer2_attention_0_2</title>
<path fill="none" stroke="black" d="M5885.82,-7056.27C5908.41,-7038.94 5935.26,-7018.35 5960.22,-6999.22"/>
<polygon fill="black" stroke="black" points="5962.44,-7001.92 5968.24,-6993.06 5958.18,-6996.37 5962.44,-7001.92"/>
</g>
<!-- layer2_k_proj_0_2&#45;&gt;layer2_attention_0_2 -->
<g id="edge556" class="edge">
<title>layer2_k_proj_0_2&#45;&gt;layer2_attention_0_2</title>
<path fill="none" stroke="black" d="M6040.79,-7056.27C6040.79,-7048 6040.79,-7038.98 6040.79,-7029.74"/>
<polygon fill="black" stroke="black" points="6044.29,-7029.64 6040.79,-7019.64 6037.29,-7029.64 6044.29,-7029.64"/>
</g>
<!-- layer2_v_proj_0_2&#45;&gt;layer2_attention_0_2 -->
<g id="edge557" class="edge">
<title>layer2_v_proj_0_2&#45;&gt;layer2_attention_0_2</title>
<path fill="none" stroke="black" d="M6195.77,-7056.27C6173.18,-7038.94 6146.32,-7018.35 6121.37,-6999.22"/>
<polygon fill="black" stroke="black" points="6123.4,-6996.37 6113.34,-6993.06 6119.14,-7001.92 6123.4,-6996.37"/>
</g>
<!-- layer2_attention_0_3 -->
<g id="node244" class="node">
<title>layer2_attention_0_3</title>
<polygon fill="lightcoral" stroke="black" points="6587.79,-7019.43 6361.79,-6936.43 6587.79,-6853.43 6813.79,-6936.43 6587.79,-7019.43"/>
<text text-anchor="middle" x="6587.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6587.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="6587.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6587.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6587.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_q_proj_0_3&#45;&gt;layer2_attention_0_3 -->
<g id="edge558" class="edge">
<title>layer2_q_proj_0_3&#45;&gt;layer2_attention_0_3</title>
<path fill="none" stroke="black" d="M6490.19,-7056.27C6502.11,-7041.75 6515.92,-7024.94 6529.32,-7008.62"/>
<polygon fill="black" stroke="black" points="6532.22,-7010.6 6535.86,-7000.65 6526.81,-7006.16 6532.22,-7010.6"/>
</g>
<!-- layer2_k_proj_0_3&#45;&gt;layer2_attention_0_3 -->
<g id="edge559" class="edge">
<title>layer2_k_proj_0_3&#45;&gt;layer2_attention_0_3</title>
<path fill="none" stroke="black" d="M6645.16,-7056.27C6639.24,-7044 6632.53,-7030.1 6625.83,-7016.23"/>
<polygon fill="black" stroke="black" points="6628.95,-7014.63 6621.45,-7007.14 6622.64,-7017.67 6628.95,-7014.63"/>
</g>
<!-- layer2_v_proj_0_3&#45;&gt;layer2_attention_0_3 -->
<g id="edge560" class="edge">
<title>layer2_v_proj_0_3&#45;&gt;layer2_attention_0_3</title>
<path fill="none" stroke="black" d="M6800.14,-7056.27C6765.25,-7036.74 6722.94,-7013.07 6685.3,-6992"/>
<polygon fill="black" stroke="black" points="6686.78,-6988.82 6676.34,-6986.99 6683.36,-6994.93 6686.78,-6988.82"/>
</g>
<!-- layer2_attention_1_0 -->
<g id="node245" class="node">
<title>layer2_attention_1_0</title>
<polygon fill="lightcoral" stroke="black" points="7373.79,-7019.43 7147.79,-6936.43 7373.79,-6853.43 7599.79,-6936.43 7373.79,-7019.43"/>
<text text-anchor="middle" x="7373.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7373.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="7373.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7373.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7373.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_q_proj_1_0&#45;&gt;layer2_attention_1_0 -->
<g id="edge561" class="edge">
<title>layer2_q_proj_1_0&#45;&gt;layer2_attention_1_0</title>
<path fill="none" stroke="black" d="M7149.53,-7056.27C7187.09,-7036.36 7232.81,-7012.14 7273.14,-6990.76"/>
<polygon fill="black" stroke="black" points="7274.99,-6993.74 7282.19,-6985.97 7271.72,-6987.56 7274.99,-6993.74"/>
</g>
<!-- layer2_k_proj_1_0&#45;&gt;layer2_attention_1_0 -->
<g id="edge562" class="edge">
<title>layer2_k_proj_1_0&#45;&gt;layer2_attention_1_0</title>
<path fill="none" stroke="black" d="M7291.83,-7056.27C7301.23,-7042.64 7312.03,-7026.99 7322.63,-7011.61"/>
<polygon fill="black" stroke="black" points="7325.69,-7013.33 7328.49,-7003.12 7319.93,-7009.36 7325.69,-7013.33"/>
</g>
<!-- layer2_v_proj_1_0&#45;&gt;layer2_attention_1_0 -->
<g id="edge563" class="edge">
<title>layer2_v_proj_1_0&#45;&gt;layer2_attention_1_0</title>
<path fill="none" stroke="black" d="M7434.14,-7056.27C7427.87,-7043.93 7420.76,-7029.93 7413.68,-7015.97"/>
<polygon fill="black" stroke="black" points="7416.69,-7014.16 7409.04,-7006.83 7410.44,-7017.33 7416.69,-7014.16"/>
</g>
<!-- layer2_attention_1_1 -->
<g id="node246" class="node">
<title>layer2_attention_1_1</title>
<polygon fill="lightcoral" stroke="black" points="7970.79,-7019.43 7744.79,-6936.43 7970.79,-6853.43 8196.79,-6936.43 7970.79,-7019.43"/>
<text text-anchor="middle" x="7970.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7970.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7970.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7970.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7970.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_q_proj_1_1&#45;&gt;layer2_attention_1_1 -->
<g id="edge564" class="edge">
<title>layer2_q_proj_1_1&#45;&gt;layer2_attention_1_1</title>
<path fill="none" stroke="black" d="M7735.35,-7056.27C7775.55,-7035.97 7824.64,-7011.2 7867.57,-6989.53"/>
<polygon fill="black" stroke="black" points="7869.29,-6992.58 7876.64,-6984.95 7866.13,-6986.33 7869.29,-6992.58"/>
</g>
<!-- layer2_k_proj_1_1&#45;&gt;layer2_attention_1_1 -->
<g id="edge565" class="edge">
<title>layer2_k_proj_1_1&#45;&gt;layer2_attention_1_1</title>
<path fill="none" stroke="black" d="M7890.32,-7056.27C7899.55,-7042.64 7910.15,-7026.99 7920.56,-7011.61"/>
<polygon fill="black" stroke="black" points="7923.61,-7013.36 7926.31,-7003.12 7917.81,-7009.43 7923.61,-7013.36"/>
</g>
<!-- layer2_v_proj_1_1&#45;&gt;layer2_attention_1_1 -->
<g id="edge566" class="edge">
<title>layer2_v_proj_1_1&#45;&gt;layer2_attention_1_1</title>
<path fill="none" stroke="black" d="M8045.3,-7056.27C8037.03,-7043.07 8027.57,-7027.98 8018.23,-7013.09"/>
<polygon fill="black" stroke="black" points="8021.03,-7010.96 8012.75,-7004.35 8015.1,-7014.68 8021.03,-7010.96"/>
</g>
<!-- layer2_attention_1_2 -->
<g id="node247" class="node">
<title>layer2_attention_1_2</title>
<polygon fill="lightcoral" stroke="black" points="8486.79,-7019.43 8260.79,-6936.43 8486.79,-6853.43 8712.79,-6936.43 8486.79,-7019.43"/>
<text text-anchor="middle" x="8486.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8486.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="8486.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8486.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8486.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_q_proj_1_2&#45;&gt;layer2_attention_1_2 -->
<g id="edge567" class="edge">
<title>layer2_q_proj_1_2&#45;&gt;layer2_attention_1_2</title>
<path fill="none" stroke="black" d="M8331.82,-7056.27C8354.41,-7038.94 8381.26,-7018.35 8406.22,-6999.22"/>
<polygon fill="black" stroke="black" points="8408.44,-7001.92 8414.24,-6993.06 8404.18,-6996.37 8408.44,-7001.92"/>
</g>
<!-- layer2_k_proj_1_2&#45;&gt;layer2_attention_1_2 -->
<g id="edge568" class="edge">
<title>layer2_k_proj_1_2&#45;&gt;layer2_attention_1_2</title>
<path fill="none" stroke="black" d="M8486.79,-7056.27C8486.79,-7048 8486.79,-7038.98 8486.79,-7029.74"/>
<polygon fill="black" stroke="black" points="8490.29,-7029.64 8486.79,-7019.64 8483.29,-7029.64 8490.29,-7029.64"/>
</g>
<!-- layer2_v_proj_1_2&#45;&gt;layer2_attention_1_2 -->
<g id="edge569" class="edge">
<title>layer2_v_proj_1_2&#45;&gt;layer2_attention_1_2</title>
<path fill="none" stroke="black" d="M8641.77,-7056.27C8619.18,-7038.94 8592.32,-7018.35 8567.37,-6999.22"/>
<polygon fill="black" stroke="black" points="8569.4,-6996.37 8559.34,-6993.06 8565.14,-7001.92 8569.4,-6996.37"/>
</g>
<!-- layer2_attention_1_3 -->
<g id="node248" class="node">
<title>layer2_attention_1_3</title>
<polygon fill="lightcoral" stroke="black" points="9033.79,-7019.43 8807.79,-6936.43 9033.79,-6853.43 9259.79,-6936.43 9033.79,-7019.43"/>
<text text-anchor="middle" x="9033.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9033.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="9033.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9033.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9033.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_q_proj_1_3&#45;&gt;layer2_attention_1_3 -->
<g id="edge570" class="edge">
<title>layer2_q_proj_1_3&#45;&gt;layer2_attention_1_3</title>
<path fill="none" stroke="black" d="M8936.19,-7056.27C8948.11,-7041.75 8961.92,-7024.94 8975.32,-7008.62"/>
<polygon fill="black" stroke="black" points="8978.22,-7010.6 8981.86,-7000.65 8972.81,-7006.16 8978.22,-7010.6"/>
</g>
<!-- layer2_k_proj_1_3&#45;&gt;layer2_attention_1_3 -->
<g id="edge571" class="edge">
<title>layer2_k_proj_1_3&#45;&gt;layer2_attention_1_3</title>
<path fill="none" stroke="black" d="M9091.16,-7056.27C9085.24,-7044 9078.53,-7030.1 9071.83,-7016.23"/>
<polygon fill="black" stroke="black" points="9074.95,-7014.63 9067.45,-7007.14 9068.64,-7017.67 9074.95,-7014.63"/>
</g>
<!-- layer2_v_proj_1_3&#45;&gt;layer2_attention_1_3 -->
<g id="edge572" class="edge">
<title>layer2_v_proj_1_3&#45;&gt;layer2_attention_1_3</title>
<path fill="none" stroke="black" d="M9246.14,-7056.27C9211.25,-7036.74 9168.94,-7013.07 9131.3,-6992"/>
<polygon fill="black" stroke="black" points="9132.78,-6988.82 9122.34,-6986.99 9129.36,-6994.93 9132.78,-6988.82"/>
</g>
<!-- layer2_attention_2_0 -->
<g id="node249" class="node">
<title>layer2_attention_2_0</title>
<polygon fill="lightcoral" stroke="black" points="9811.79,-7019.43 9585.79,-6936.43 9811.79,-6853.43 10037.79,-6936.43 9811.79,-7019.43"/>
<text text-anchor="middle" x="9811.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9811.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9811.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9811.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9811.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_q_proj_2_0&#45;&gt;layer2_attention_2_0 -->
<g id="edge573" class="edge">
<title>layer2_q_proj_2_0&#45;&gt;layer2_attention_2_0</title>
<path fill="none" stroke="black" d="M9596.47,-7056.27C9632,-7036.66 9675.12,-7012.86 9713.41,-6991.72"/>
<polygon fill="black" stroke="black" points="9715.46,-6994.59 9722.52,-6986.7 9712.08,-6988.46 9715.46,-6994.59"/>
</g>
<!-- layer2_k_proj_2_0&#45;&gt;layer2_attention_2_0 -->
<g id="edge574" class="edge">
<title>layer2_k_proj_2_0&#45;&gt;layer2_attention_2_0</title>
<path fill="none" stroke="black" d="M9744.74,-7056.27C9751.94,-7043.5 9760.14,-7028.96 9768.28,-7014.54"/>
<polygon fill="black" stroke="black" points="9771.46,-7016.02 9773.33,-7005.59 9765.37,-7012.58 9771.46,-7016.02"/>
</g>
<!-- layer2_v_proj_2_0&#45;&gt;layer2_attention_2_0 -->
<g id="edge575" class="edge">
<title>layer2_v_proj_2_0&#45;&gt;layer2_attention_2_0</title>
<path fill="none" stroke="black" d="M9893,-7056.27C9883.69,-7042.64 9872.99,-7026.99 9862.49,-7011.61"/>
<polygon fill="black" stroke="black" points="9865.21,-7009.4 9856.68,-7003.12 9859.43,-7013.35 9865.21,-7009.4"/>
</g>
<!-- layer2_attention_2_1 -->
<g id="node250" class="node">
<title>layer2_attention_2_1</title>
<polygon fill="lightcoral" stroke="black" points="10345.79,-7019.43 10119.79,-6936.43 10345.79,-6853.43 10571.79,-6936.43 10345.79,-7019.43"/>
<text text-anchor="middle" x="10345.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10345.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="10345.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10345.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10345.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_q_proj_2_1&#45;&gt;layer2_attention_2_1 -->
<g id="edge576" class="edge">
<title>layer2_q_proj_2_1&#45;&gt;layer2_attention_2_1</title>
<path fill="none" stroke="black" d="M10184.11,-7056.27C10208.12,-7038.62 10236.75,-7017.58 10263.2,-6998.14"/>
<polygon fill="black" stroke="black" points="10265.34,-7000.9 10271.33,-6992.16 10261.2,-6995.26 10265.34,-7000.9"/>
</g>
<!-- layer2_k_proj_2_1&#45;&gt;layer2_attention_2_1 -->
<g id="edge577" class="edge">
<title>layer2_k_proj_2_1&#45;&gt;layer2_attention_2_1</title>
<path fill="none" stroke="black" d="M10345.79,-7056.27C10345.79,-7048 10345.79,-7038.98 10345.79,-7029.74"/>
<polygon fill="black" stroke="black" points="10349.29,-7029.64 10345.79,-7019.64 10342.29,-7029.64 10349.29,-7029.64"/>
</g>
<!-- layer2_v_proj_2_1&#45;&gt;layer2_attention_2_1 -->
<g id="edge578" class="edge">
<title>layer2_v_proj_2_1&#45;&gt;layer2_attention_2_1</title>
<path fill="none" stroke="black" d="M10507.47,-7056.27C10483.46,-7038.62 10454.83,-7017.58 10428.39,-6998.14"/>
<polygon fill="black" stroke="black" points="10430.39,-6995.26 10420.26,-6992.16 10426.24,-7000.9 10430.39,-6995.26"/>
</g>
<!-- layer2_attention_2_2 -->
<g id="node251" class="node">
<title>layer2_attention_2_2</title>
<polygon fill="lightcoral" stroke="black" points="10905.79,-7019.43 10679.79,-6936.43 10905.79,-6853.43 11131.79,-6936.43 10905.79,-7019.43"/>
<text text-anchor="middle" x="10905.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10905.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="10905.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10905.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10905.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_q_proj_2_2&#45;&gt;layer2_attention_2_2 -->
<g id="edge579" class="edge">
<title>layer2_q_proj_2_2&#45;&gt;layer2_attention_2_2</title>
<path fill="none" stroke="black" d="M10811.91,-7056.27C10823.25,-7041.91 10836.37,-7025.31 10849.13,-7009.15"/>
<polygon fill="black" stroke="black" points="10851.91,-7011.28 10855.36,-7001.27 10846.42,-7006.94 10851.91,-7011.28"/>
</g>
<!-- layer2_k_proj_2_2&#45;&gt;layer2_attention_2_2 -->
<g id="edge580" class="edge">
<title>layer2_k_proj_2_2&#45;&gt;layer2_attention_2_2</title>
<path fill="none" stroke="black" d="M10973.59,-7056.27C10966.27,-7043.43 10957.92,-7028.79 10949.64,-7014.28"/>
<polygon fill="black" stroke="black" points="10952.5,-7012.23 10944.5,-7005.28 10946.42,-7015.7 10952.5,-7012.23"/>
</g>
<!-- layer2_v_proj_2_2&#45;&gt;layer2_attention_2_2 -->
<g id="edge581" class="edge">
<title>layer2_v_proj_2_2&#45;&gt;layer2_attention_2_2</title>
<path fill="none" stroke="black" d="M11135.27,-7056.27C11096.5,-7036.19 11049.25,-7011.72 11007.72,-6990.21"/>
<polygon fill="black" stroke="black" points="11009.17,-6987.02 10998.68,-6985.53 11005.95,-6993.24 11009.17,-6987.02"/>
</g>
<!-- layer2_attention_2_3 -->
<g id="node252" class="node">
<title>layer2_attention_2_3</title>
<polygon fill="lightcoral" stroke="black" points="11557.79,-7019.43 11331.79,-6936.43 11557.79,-6853.43 11783.79,-6936.43 11557.79,-7019.43"/>
<text text-anchor="middle" x="11557.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11557.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="11557.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11557.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11557.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_q_proj_2_3&#45;&gt;layer2_attention_2_3 -->
<g id="edge582" class="edge">
<title>layer2_q_proj_2_3&#45;&gt;layer2_attention_2_3</title>
<path fill="none" stroke="black" d="M11463.17,-7056.27C11474.66,-7041.83 11487.96,-7025.13 11500.9,-7008.88"/>
<polygon fill="black" stroke="black" points="11503.71,-7010.96 11507.21,-7000.96 11498.24,-7006.6 11503.71,-7010.96"/>
</g>
<!-- layer2_k_proj_2_3&#45;&gt;layer2_attention_2_3 -->
<g id="edge583" class="edge">
<title>layer2_k_proj_2_3&#45;&gt;layer2_attention_2_3</title>
<path fill="none" stroke="black" d="M11624.85,-7056.27C11617.65,-7043.5 11609.44,-7028.96 11601.3,-7014.54"/>
<polygon fill="black" stroke="black" points="11604.22,-7012.58 11596.25,-7005.59 11598.12,-7016.02 11604.22,-7012.58"/>
</g>
<!-- layer2_v_proj_2_3&#45;&gt;layer2_attention_2_3 -->
<g id="edge584" class="edge">
<title>layer2_v_proj_2_3&#45;&gt;layer2_attention_2_3</title>
<path fill="none" stroke="black" d="M11786.53,-7056.27C11747.88,-7036.19 11700.78,-7011.72 11659.39,-6990.21"/>
<polygon fill="black" stroke="black" points="11660.87,-6987.04 11650.38,-6985.53 11657.64,-6993.25 11660.87,-6987.04"/>
</g>
<!-- layer2_attention_3_0 -->
<g id="node253" class="node">
<title>layer2_attention_3_0</title>
<polygon fill="lightcoral" stroke="black" points="12388.79,-7019.43 12162.79,-6936.43 12388.79,-6853.43 12614.79,-6936.43 12388.79,-7019.43"/>
<text text-anchor="middle" x="12388.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12388.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="12388.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12388.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12388.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_q_proj_3_0&#45;&gt;layer2_attention_3_0 -->
<g id="edge585" class="edge">
<title>layer2_q_proj_3_0&#45;&gt;layer2_attention_3_0</title>
<path fill="none" stroke="black" d="M12157.07,-7056.27C12196.39,-7036.1 12244.34,-7011.51 12286.4,-6989.94"/>
<polygon fill="black" stroke="black" points="12288.26,-6992.92 12295.56,-6985.24 12285.07,-6986.69 12288.26,-6992.92"/>
</g>
<!-- layer2_k_proj_3_0&#45;&gt;layer2_attention_3_0 -->
<g id="edge586" class="edge">
<title>layer2_k_proj_3_0&#45;&gt;layer2_attention_3_0</title>
<path fill="none" stroke="black" d="M12312.05,-7056.27C12320.75,-7042.79 12330.73,-7027.35 12340.54,-7012.14"/>
<polygon fill="black" stroke="black" points="12343.49,-7014.03 12345.97,-7003.73 12337.61,-7010.23 12343.49,-7014.03"/>
</g>
<!-- layer2_v_proj_3_0&#45;&gt;layer2_attention_3_0 -->
<g id="edge587" class="edge">
<title>layer2_v_proj_3_0&#45;&gt;layer2_attention_3_0</title>
<path fill="none" stroke="black" d="M12467.02,-7056.27C12458.15,-7042.79 12447.98,-7027.35 12437.97,-7012.14"/>
<polygon fill="black" stroke="black" points="12440.86,-7010.16 12432.44,-7003.73 12435.02,-7014.01 12440.86,-7010.16"/>
</g>
<!-- layer2_attention_3_1 -->
<g id="node254" class="node">
<title>layer2_attention_3_1</title>
<polygon fill="lightcoral" stroke="black" points="12936.79,-7019.43 12710.79,-6936.43 12936.79,-6853.43 13162.79,-6936.43 12936.79,-7019.43"/>
<text text-anchor="middle" x="12936.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12936.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="12936.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12936.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12936.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_q_proj_3_1&#45;&gt;layer2_attention_3_1 -->
<g id="edge588" class="edge">
<title>layer2_q_proj_3_1&#45;&gt;layer2_attention_3_1</title>
<path fill="none" stroke="black" d="M12768.41,-7056.27C12793.76,-7038.37 12824.05,-7016.99 12851.91,-6997.33"/>
<polygon fill="black" stroke="black" points="12853.93,-7000.19 12860.08,-6991.56 12849.9,-6994.47 12853.93,-7000.19"/>
</g>
<!-- layer2_k_proj_3_1&#45;&gt;layer2_attention_3_1 -->
<g id="edge589" class="edge">
<title>layer2_k_proj_3_1&#45;&gt;layer2_attention_3_1</title>
<path fill="none" stroke="black" d="M12936.79,-7056.27C12936.79,-7048 12936.79,-7038.98 12936.79,-7029.74"/>
<polygon fill="black" stroke="black" points="12940.29,-7029.64 12936.79,-7019.64 12933.29,-7029.64 12940.29,-7029.64"/>
</g>
<!-- layer2_v_proj_3_1&#45;&gt;layer2_attention_3_1 -->
<g id="edge590" class="edge">
<title>layer2_v_proj_3_1&#45;&gt;layer2_attention_3_1</title>
<path fill="none" stroke="black" d="M13105.18,-7056.27C13079.82,-7038.37 13049.53,-7016.99 13021.67,-6997.33"/>
<polygon fill="black" stroke="black" points="13023.69,-6994.47 13013.5,-6991.56 13019.65,-7000.19 13023.69,-6994.47"/>
</g>
<!-- layer2_attention_3_2 -->
<g id="node255" class="node">
<title>layer2_attention_3_2</title>
<polygon fill="lightcoral" stroke="black" points="13452.79,-7019.43 13226.79,-6936.43 13452.79,-6853.43 13678.79,-6936.43 13452.79,-7019.43"/>
<text text-anchor="middle" x="13452.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13452.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="13452.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="13452.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="13452.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_q_proj_3_2&#45;&gt;layer2_attention_3_2 -->
<g id="edge591" class="edge">
<title>layer2_q_proj_3_2&#45;&gt;layer2_attention_3_2</title>
<path fill="none" stroke="black" d="M13405.11,-7056.27C13409.76,-7044.68 13414.99,-7031.63 13420.25,-7018.54"/>
<polygon fill="black" stroke="black" points="13423.59,-7019.59 13424.07,-7009.01 13417.1,-7016.99 13423.59,-7019.59"/>
</g>
<!-- layer2_k_proj_3_2&#45;&gt;layer2_attention_3_2 -->
<g id="edge592" class="edge">
<title>layer2_k_proj_3_2&#45;&gt;layer2_attention_3_2</title>
<path fill="none" stroke="black" d="M13573.49,-7056.27C13557.58,-7040.6 13538.95,-7022.26 13521.16,-7004.74"/>
<polygon fill="black" stroke="black" points="13523.17,-7001.81 13513.59,-6997.29 13518.26,-7006.8 13523.17,-7001.81"/>
</g>
<!-- layer2_v_proj_3_2&#45;&gt;layer2_attention_3_2 -->
<g id="edge593" class="edge">
<title>layer2_v_proj_3_2&#45;&gt;layer2_attention_3_2</title>
<path fill="none" stroke="black" d="M13742.13,-7056.37C13689.07,-7034.56 13623.35,-7007.54 13567.96,-6984.77"/>
<polygon fill="black" stroke="black" points="13569.03,-6981.43 13558.45,-6980.86 13566.37,-6987.9 13569.03,-6981.43"/>
</g>
<!-- layer2_attention_3_3 -->
<g id="node256" class="node">
<title>layer2_attention_3_3</title>
<polygon fill="lightcoral" stroke="black" points="14178.79,-7019.43 13952.79,-6936.43 14178.79,-6853.43 14404.79,-6936.43 14178.79,-7019.43"/>
<text text-anchor="middle" x="14178.79" y="-6962.73" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14178.79" y="-6947.73" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="14178.79" y="-6932.73" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="14178.79" y="-6917.73" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="14178.79" y="-6902.73" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_q_proj_3_3&#45;&gt;layer2_attention_3_3 -->
<g id="edge594" class="edge">
<title>layer2_q_proj_3_3&#45;&gt;layer2_attention_3_3</title>
<path fill="none" stroke="black" d="M14095.34,-7056.27C14104.97,-7042.56 14116.03,-7026.81 14126.88,-7011.35"/>
<polygon fill="black" stroke="black" points="14130,-7013 14132.88,-7002.81 14124.27,-7008.98 14130,-7013"/>
</g>
<!-- layer2_k_proj_3_3&#45;&gt;layer2_attention_3_3 -->
<g id="edge595" class="edge">
<title>layer2_k_proj_3_3&#45;&gt;layer2_attention_3_3</title>
<path fill="none" stroke="black" d="M14263.73,-7056.27C14253.79,-7042.36 14242.34,-7026.34 14231.13,-7010.65"/>
<polygon fill="black" stroke="black" points="14233.96,-7008.6 14225.3,-7002.5 14228.27,-7012.67 14233.96,-7008.6"/>
</g>
<!-- layer2_v_proj_3_3&#45;&gt;layer2_attention_3_3 -->
<g id="edge596" class="edge">
<title>layer2_v_proj_3_3&#45;&gt;layer2_attention_3_3</title>
<path fill="none" stroke="black" d="M14432.12,-7056.27C14387.76,-7035.46 14333.34,-7009.93 14286.33,-6987.87"/>
<polygon fill="black" stroke="black" points="14287.57,-6984.59 14277.03,-6983.51 14284.59,-6990.93 14287.57,-6984.59"/>
</g>
<!-- layer2_concat_dim_0 -->
<g id="node257" class="node">
<title>layer2_concat_dim_0</title>
<polygon fill="orange" stroke="black" points="6176.87,-6816.43 5904.72,-6816.43 5807.79,-6680.43 6273.79,-6680.43 6176.87,-6816.43"/>
<text text-anchor="middle" x="6040.79" y="-6767.23" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="6040.79" y="-6752.23" font-family="Times,serif" font-size="14.00">HeadGroup:0</text>
<text text-anchor="middle" x="6040.79" y="-6737.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6040.79" y="-6722.23" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3 (communication)</text>
</g>
<!-- layer2_attention_0_0&#45;&gt;layer2_concat_dim_0 -->
<g id="edge597" class="edge">
<title>layer2_attention_0_0&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M5062.96,-6899.65C5122.06,-6883.83 5193.66,-6866.01 5258.79,-6853.43 5462.75,-6814.04 5699.52,-6784.82 5858.64,-6767.54"/>
<polygon fill="black" stroke="black" points="5859.44,-6770.98 5869,-6766.42 5858.68,-6764.02 5859.44,-6770.98"/>
</g>
<!-- layer2_attention_0_1&#45;&gt;layer2_concat_dim_0 -->
<g id="edge598" class="edge">
<title>layer2_attention_0_1&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M5609.8,-6895.98C5689.29,-6868.95 5795.72,-6832.76 5882.93,-6803.11"/>
<polygon fill="black" stroke="black" points="5884.31,-6806.33 5892.65,-6799.8 5882.06,-6799.71 5884.31,-6806.33"/>
</g>
<!-- layer2_attention_0_2&#45;&gt;layer2_concat_dim_0 -->
<g id="edge599" class="edge">
<title>layer2_attention_0_2&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M6040.79,-6853.3C6040.79,-6844.49 6040.79,-6835.55 6040.79,-6826.79"/>
<polygon fill="black" stroke="black" points="6044.29,-6826.62 6040.79,-6816.62 6037.29,-6826.62 6044.29,-6826.62"/>
</g>
<!-- layer2_attention_0_3&#45;&gt;layer2_concat_dim_0 -->
<g id="edge600" class="edge">
<title>layer2_attention_0_3&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M6471.79,-6895.98C6392.29,-6868.95 6285.86,-6832.76 6198.65,-6803.11"/>
<polygon fill="black" stroke="black" points="6199.52,-6799.71 6188.93,-6799.8 6197.27,-6806.33 6199.52,-6799.71"/>
</g>
<!-- layer2_concat_dim_1 -->
<g id="node258" class="node">
<title>layer2_concat_dim_1</title>
<polygon fill="orange" stroke="black" points="8622.87,-6816.43 8350.72,-6816.43 8253.79,-6680.43 8719.79,-6680.43 8622.87,-6816.43"/>
<text text-anchor="middle" x="8486.79" y="-6767.23" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="8486.79" y="-6752.23" font-family="Times,serif" font-size="14.00">HeadGroup:1</text>
<text text-anchor="middle" x="8486.79" y="-6737.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8486.79" y="-6722.23" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7 (communication)</text>
</g>
<!-- layer2_attention_1_0&#45;&gt;layer2_concat_dim_1 -->
<g id="edge601" class="edge">
<title>layer2_attention_1_0&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M7507.33,-6902.32C7575.42,-6886.17 7659.72,-6867.29 7735.79,-6853.43 7929.82,-6818.08 8153.99,-6788.49 8306.55,-6770.02"/>
<polygon fill="black" stroke="black" points="8306.99,-6773.49 8316.5,-6768.82 8306.15,-6766.54 8306.99,-6773.49"/>
</g>
<!-- layer2_attention_1_1&#45;&gt;layer2_concat_dim_1 -->
<g id="edge602" class="edge">
<title>layer2_attention_1_1&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M8083.71,-6894.73C8156.1,-6868.63 8251.08,-6834.39 8330.65,-6805.71"/>
<polygon fill="black" stroke="black" points="8332.06,-6808.93 8340.28,-6802.24 8329.68,-6802.34 8332.06,-6808.93"/>
</g>
<!-- layer2_attention_1_2&#45;&gt;layer2_concat_dim_1 -->
<g id="edge603" class="edge">
<title>layer2_attention_1_2&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M8486.79,-6853.3C8486.79,-6844.49 8486.79,-6835.55 8486.79,-6826.79"/>
<polygon fill="black" stroke="black" points="8490.29,-6826.62 8486.79,-6816.62 8483.29,-6826.62 8490.29,-6826.62"/>
</g>
<!-- layer2_attention_1_3&#45;&gt;layer2_concat_dim_1 -->
<g id="edge604" class="edge">
<title>layer2_attention_1_3&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M8917.79,-6895.98C8838.29,-6868.95 8731.86,-6832.76 8644.65,-6803.11"/>
<polygon fill="black" stroke="black" points="8645.52,-6799.71 8634.93,-6799.8 8643.27,-6806.33 8645.52,-6799.71"/>
</g>
<!-- layer2_concat_dim_2 -->
<g id="node259" class="node">
<title>layer2_concat_dim_2</title>
<polygon fill="orange" stroke="black" points="10481.87,-6816.43 10209.72,-6816.43 10112.79,-6680.43 10578.79,-6680.43 10481.87,-6816.43"/>
<text text-anchor="middle" x="10345.79" y="-6767.23" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="10345.79" y="-6752.23" font-family="Times,serif" font-size="14.00">HeadGroup:2</text>
<text text-anchor="middle" x="10345.79" y="-6737.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10345.79" y="-6722.23" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11 (communication)</text>
</g>
<!-- layer2_attention_2_0&#45;&gt;layer2_concat_dim_2 -->
<g id="edge605" class="edge">
<title>layer2_attention_2_0&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M9926.68,-6895.41C10003.12,-6868.79 10104.53,-6833.46 10188.45,-6804.23"/>
<polygon fill="black" stroke="black" points="10189.78,-6807.48 10198.07,-6800.88 10187.48,-6800.86 10189.78,-6807.48"/>
</g>
<!-- layer2_attention_2_1&#45;&gt;layer2_concat_dim_2 -->
<g id="edge606" class="edge">
<title>layer2_attention_2_1&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M10345.79,-6853.3C10345.79,-6844.49 10345.79,-6835.55 10345.79,-6826.79"/>
<polygon fill="black" stroke="black" points="10349.29,-6826.62 10345.79,-6816.62 10342.29,-6826.62 10349.29,-6826.62"/>
</g>
<!-- layer2_attention_2_2&#45;&gt;layer2_concat_dim_2 -->
<g id="edge607" class="edge">
<title>layer2_attention_2_2&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M10788.4,-6896.44C10705.85,-6869.02 10594.44,-6832.01 10504.05,-6801.99"/>
<polygon fill="black" stroke="black" points="10505.13,-6798.66 10494.53,-6798.83 10502.92,-6805.31 10505.13,-6798.66"/>
</g>
<!-- layer2_attention_2_3&#45;&gt;layer2_concat_dim_2 -->
<g id="edge608" class="edge">
<title>layer2_attention_2_3&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M11416.34,-6905.27C11335.8,-6888.69 11232.9,-6868.49 11140.79,-6853.43 10930.55,-6819.04 10687.55,-6788.6 10526.1,-6769.68"/>
<polygon fill="black" stroke="black" points="10526.41,-6766.19 10516.07,-6768.5 10525.59,-6773.14 10526.41,-6766.19"/>
</g>
<!-- layer2_concat_dim_3 -->
<g id="node260" class="node">
<title>layer2_concat_dim_3</title>
<polygon fill="orange" stroke="black" points="13072.87,-6816.43 12800.72,-6816.43 12703.79,-6680.43 13169.79,-6680.43 13072.87,-6816.43"/>
<text text-anchor="middle" x="12936.79" y="-6767.23" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="12936.79" y="-6752.23" font-family="Times,serif" font-size="14.00">HeadGroup:3</text>
<text text-anchor="middle" x="12936.79" y="-6737.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="12936.79" y="-6722.23" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15 (communication)</text>
</g>
<!-- layer2_attention_3_0&#45;&gt;layer2_concat_dim_3 -->
<g id="edge609" class="edge">
<title>layer2_attention_3_0&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M12505.01,-6895.98C12584.81,-6868.9 12691.7,-6832.62 12779.15,-6802.93"/>
<polygon fill="black" stroke="black" points="12780.29,-6806.24 12788.64,-6799.71 12778.04,-6799.61 12780.29,-6806.24"/>
</g>
<!-- layer2_attention_3_1&#45;&gt;layer2_concat_dim_3 -->
<g id="edge610" class="edge">
<title>layer2_attention_3_1&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M12936.79,-6853.3C12936.79,-6844.49 12936.79,-6835.55 12936.79,-6826.79"/>
<polygon fill="black" stroke="black" points="12940.29,-6826.62 12936.79,-6816.62 12933.29,-6826.62 12940.29,-6826.62"/>
</g>
<!-- layer2_attention_3_2&#45;&gt;layer2_concat_dim_3 -->
<g id="edge611" class="edge">
<title>layer2_attention_3_2&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M13339.87,-6894.73C13267.48,-6868.63 13172.5,-6834.39 13092.93,-6805.71"/>
<polygon fill="black" stroke="black" points="13093.9,-6802.34 13083.3,-6802.24 13091.52,-6808.93 13093.9,-6802.34"/>
</g>
<!-- layer2_attention_3_3&#45;&gt;layer2_concat_dim_3 -->
<g id="edge612" class="edge">
<title>layer2_attention_3_3&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M14027.18,-6908.99C13930.23,-6892.36 13801.74,-6870.83 13687.79,-6853.43 13492.19,-6823.56 13267.35,-6792.91 13115.06,-6772.69"/>
<polygon fill="black" stroke="black" points="13115.51,-6769.22 13105.14,-6771.38 13114.59,-6776.16 13115.51,-6769.22"/>
</g>
<!-- layer2_concat_heads -->
<g id="node261" class="node">
<title>layer2_concat_heads</title>
<polygon fill="gold" stroke="black" points="9075.93,-6643.43 8837.65,-6643.43 8752.79,-6537.43 9160.79,-6537.43 9075.93,-6643.43"/>
<text text-anchor="middle" x="8956.79" y="-6601.73" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="8956.79" y="-6586.73" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8956.79" y="-6571.73" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllGather)</text>
</g>
<!-- layer2_concat_dim_0&#45;&gt;layer2_concat_heads -->
<g id="edge613" class="edge">
<title>layer2_concat_dim_0&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M6233.53,-6737.12C6772.5,-6708.28 8288.6,-6627.18 8792,-6600.24"/>
<polygon fill="black" stroke="black" points="8792.45,-6603.73 8802.25,-6599.7 8792.08,-6596.74 8792.45,-6603.73"/>
</g>
<!-- layer2_concat_dim_1&#45;&gt;layer2_concat_heads -->
<g id="edge614" class="edge">
<title>layer2_concat_dim_1&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M8688.84,-6680.37C8733.16,-6665.66 8779.07,-6650.42 8820.11,-6636.8"/>
<polygon fill="black" stroke="black" points="8821.21,-6640.12 8829.6,-6633.64 8819.01,-6633.47 8821.21,-6640.12"/>
</g>
<!-- layer2_concat_dim_2&#45;&gt;layer2_concat_heads -->
<g id="edge615" class="edge">
<title>layer2_concat_dim_2&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M10144.19,-6724.79C9865.49,-6693.49 9368.25,-6637.64 9114.79,-6609.17"/>
<polygon fill="black" stroke="black" points="9115.09,-6605.68 9104.76,-6608.05 9114.3,-6612.64 9115.09,-6605.68"/>
</g>
<!-- layer2_concat_dim_3&#45;&gt;layer2_concat_heads -->
<g id="edge616" class="edge">
<title>layer2_concat_dim_3&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M12746.17,-6739.96C12065.75,-6713.29 9763.14,-6623.03 9123.08,-6597.95"/>
<polygon fill="black" stroke="black" points="9122.98,-6594.44 9112.85,-6597.55 9122.71,-6601.43 9122.98,-6594.44"/>
</g>
<!-- layer2_o_proj_0_0 -->
<g id="node262" class="node">
<title>layer2_o_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="7435.79,-6500.43 7237.79,-6500.43 7237.79,-6417.43 7435.79,-6417.43 7435.79,-6500.43"/>
<text text-anchor="middle" x="7336.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7336.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="7336.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7336.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7336.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_0_0 -->
<g id="edge617" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_0_0</title>
<path fill="none" stroke="black" d="M8791.33,-6585.93C8458.19,-6577.89 7716.1,-6554.59 7445.72,-6500.4"/>
<polygon fill="black" stroke="black" points="7446.41,-6496.97 7435.91,-6498.37 7445,-6503.82 7446.41,-6496.97"/>
</g>
<!-- layer2_o_proj_0_1 -->
<g id="node263" class="node">
<title>layer2_o_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="7651.79,-6500.43 7453.79,-6500.43 7453.79,-6417.43 7651.79,-6417.43 7651.79,-6500.43"/>
<text text-anchor="middle" x="7552.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7552.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="7552.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7552.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="7552.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_0_1 -->
<g id="edge618" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_0_1</title>
<path fill="none" stroke="black" d="M8789.86,-6583.98C8494.31,-6573.36 7889.46,-6546.92 7661.82,-6500.42"/>
<polygon fill="black" stroke="black" points="7662.42,-6496.97 7651.92,-6498.33 7660.98,-6503.82 7662.42,-6496.97"/>
</g>
<!-- layer2_o_proj_0_2 -->
<g id="node264" class="node">
<title>layer2_o_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7867.79,-6500.43 7669.79,-6500.43 7669.79,-6417.43 7867.79,-6417.43 7867.79,-6500.43"/>
<text text-anchor="middle" x="7768.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7768.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="7768.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7768.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7768.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_0_2 -->
<g id="edge619" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_0_2</title>
<path fill="none" stroke="black" d="M8794.59,-6589.93C8583.65,-6587.48 8204.55,-6572.44 7878.06,-6500.53"/>
<polygon fill="black" stroke="black" points="7878.45,-6497.04 7867.93,-6498.28 7876.93,-6503.87 7878.45,-6497.04"/>
</g>
<!-- layer2_o_proj_0_3 -->
<g id="node265" class="node">
<title>layer2_o_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="8083.79,-6500.43 7885.79,-6500.43 7885.79,-6417.43 8083.79,-6417.43 8083.79,-6500.43"/>
<text text-anchor="middle" x="7984.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7984.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="7984.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7984.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7984.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_0_3 -->
<g id="edge620" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_0_3</title>
<path fill="none" stroke="black" d="M8790.68,-6584.91C8617.49,-6577.32 8338.8,-6557.01 8093.75,-6500.49"/>
<polygon fill="black" stroke="black" points="8094.48,-6497.06 8083.95,-6498.2 8092.89,-6503.88 8094.48,-6497.06"/>
</g>
<!-- layer2_o_proj_1_0 -->
<g id="node266" class="node">
<title>layer2_o_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="8299.79,-6500.43 8101.79,-6500.43 8101.79,-6417.43 8299.79,-6417.43 8299.79,-6500.43"/>
<text text-anchor="middle" x="8200.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8200.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="8200.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8200.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8200.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_1_0 -->
<g id="edge621" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_1_0</title>
<path fill="none" stroke="black" d="M8783.57,-6576.18C8654.47,-6563.82 8474.25,-6541.34 8309.79,-6500.53"/>
<polygon fill="black" stroke="black" points="8310.53,-6497.11 8299.98,-6498.07 8308.83,-6503.9 8310.53,-6497.11"/>
</g>
<!-- layer2_o_proj_1_1 -->
<g id="node267" class="node">
<title>layer2_o_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="8515.79,-6500.43 8317.79,-6500.43 8317.79,-6417.43 8515.79,-6417.43 8515.79,-6500.43"/>
<text text-anchor="middle" x="8416.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8416.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="8416.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8416.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8416.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_1_1 -->
<g id="edge622" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_1_1</title>
<path fill="none" stroke="black" d="M8768.65,-6557.27C8695.14,-6543.06 8610.26,-6524.63 8525.81,-6500.61"/>
<polygon fill="black" stroke="black" points="8526.63,-6497.21 8516.05,-6497.81 8524.7,-6503.94 8526.63,-6497.21"/>
</g>
<!-- layer2_o_proj_1_2 -->
<g id="node268" class="node">
<title>layer2_o_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8731.79,-6500.43 8533.79,-6500.43 8533.79,-6417.43 8731.79,-6417.43 8731.79,-6500.43"/>
<text text-anchor="middle" x="8632.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8632.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="8632.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8632.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8632.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_1_2 -->
<g id="edge623" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_1_2</title>
<path fill="none" stroke="black" d="M8826.41,-6537.32C8798.25,-6526.06 8768.77,-6514.28 8741.55,-6503.4"/>
<polygon fill="black" stroke="black" points="8742.6,-6500.05 8732.02,-6499.59 8740,-6506.55 8742.6,-6500.05"/>
</g>
<!-- layer2_o_proj_1_3 -->
<g id="node269" class="node">
<title>layer2_o_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8947.79,-6500.43 8749.79,-6500.43 8749.79,-6417.43 8947.79,-6417.43 8947.79,-6500.43"/>
<text text-anchor="middle" x="8848.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8848.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="8848.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8848.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8848.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_1_3 -->
<g id="edge624" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_1_3</title>
<path fill="none" stroke="black" d="M8913.17,-6537.13C8905.22,-6527.59 8896.95,-6517.67 8889.09,-6508.25"/>
<polygon fill="black" stroke="black" points="8891.7,-6505.91 8882.6,-6500.47 8886.32,-6510.39 8891.7,-6505.91"/>
</g>
<!-- layer2_o_proj_2_0 -->
<g id="node270" class="node">
<title>layer2_o_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9163.79,-6500.43 8965.79,-6500.43 8965.79,-6417.43 9163.79,-6417.43 9163.79,-6500.43"/>
<text text-anchor="middle" x="9064.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9064.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9064.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9064.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9064.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_2_0 -->
<g id="edge625" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_2_0</title>
<path fill="none" stroke="black" d="M9000.41,-6537.13C9008.37,-6527.59 9016.64,-6517.67 9024.49,-6508.25"/>
<polygon fill="black" stroke="black" points="9027.26,-6510.39 9030.98,-6500.47 9021.89,-6505.91 9027.26,-6510.39"/>
</g>
<!-- layer2_o_proj_2_1 -->
<g id="node271" class="node">
<title>layer2_o_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="9379.79,-6500.43 9181.79,-6500.43 9181.79,-6417.43 9379.79,-6417.43 9379.79,-6500.43"/>
<text text-anchor="middle" x="9280.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9280.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="9280.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9280.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9280.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_2_1 -->
<g id="edge626" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_2_1</title>
<path fill="none" stroke="black" d="M9087.17,-6537.32C9115.33,-6526.06 9144.81,-6514.28 9172.04,-6503.4"/>
<polygon fill="black" stroke="black" points="9173.58,-6506.55 9181.57,-6499.59 9170.98,-6500.05 9173.58,-6506.55"/>
</g>
<!-- layer2_o_proj_2_2 -->
<g id="node272" class="node">
<title>layer2_o_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9595.79,-6500.43 9397.79,-6500.43 9397.79,-6417.43 9595.79,-6417.43 9595.79,-6500.43"/>
<text text-anchor="middle" x="9496.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9496.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="9496.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9496.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9496.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_2_2 -->
<g id="edge627" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_2_2</title>
<path fill="none" stroke="black" d="M9144.93,-6557.27C9218.44,-6543.06 9303.33,-6524.63 9387.77,-6500.61"/>
<polygon fill="black" stroke="black" points="9388.89,-6503.94 9397.53,-6497.81 9386.96,-6497.21 9388.89,-6503.94"/>
</g>
<!-- layer2_o_proj_2_3 -->
<g id="node273" class="node">
<title>layer2_o_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="9811.79,-6500.43 9613.79,-6500.43 9613.79,-6417.43 9811.79,-6417.43 9811.79,-6500.43"/>
<text text-anchor="middle" x="9712.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9712.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="9712.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9712.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9712.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_2_3 -->
<g id="edge628" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_2_3</title>
<path fill="none" stroke="black" d="M9130.01,-6576.18C9259.12,-6563.82 9439.33,-6541.34 9603.79,-6500.53"/>
<polygon fill="black" stroke="black" points="9604.75,-6503.9 9613.6,-6498.07 9603.05,-6497.11 9604.75,-6503.9"/>
</g>
<!-- layer2_o_proj_3_0 -->
<g id="node274" class="node">
<title>layer2_o_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="10027.79,-6500.43 9829.79,-6500.43 9829.79,-6417.43 10027.79,-6417.43 10027.79,-6500.43"/>
<text text-anchor="middle" x="9928.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9928.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="9928.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9928.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="9928.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_3_0 -->
<g id="edge629" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_3_0</title>
<path fill="none" stroke="black" d="M9122.9,-6584.91C9296.1,-6577.32 9574.78,-6557.01 9819.83,-6500.49"/>
<polygon fill="black" stroke="black" points="9820.69,-6503.88 9829.63,-6498.2 9819.1,-6497.06 9820.69,-6503.88"/>
</g>
<!-- layer2_o_proj_3_1 -->
<g id="node275" class="node">
<title>layer2_o_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="10243.79,-6500.43 10045.79,-6500.43 10045.79,-6417.43 10243.79,-6417.43 10243.79,-6500.43"/>
<text text-anchor="middle" x="10144.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10144.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="10144.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10144.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="10144.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_3_1 -->
<g id="edge630" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_3_1</title>
<path fill="none" stroke="black" d="M9118.99,-6589.93C9329.93,-6587.48 9709.03,-6572.44 10035.52,-6500.53"/>
<polygon fill="black" stroke="black" points="10036.65,-6503.87 10045.65,-6498.28 10035.13,-6497.04 10036.65,-6503.87"/>
</g>
<!-- layer2_o_proj_3_2 -->
<g id="node276" class="node">
<title>layer2_o_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="10459.79,-6500.43 10261.79,-6500.43 10261.79,-6417.43 10459.79,-6417.43 10459.79,-6500.43"/>
<text text-anchor="middle" x="10360.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10360.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="10360.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10360.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10360.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_3_2 -->
<g id="edge631" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_3_2</title>
<path fill="none" stroke="black" d="M9123.72,-6583.98C9419.28,-6573.36 10024.12,-6546.92 10251.76,-6500.42"/>
<polygon fill="black" stroke="black" points="10252.6,-6503.82 10261.66,-6498.33 10251.16,-6496.97 10252.6,-6503.82"/>
</g>
<!-- layer2_o_proj_3_3 -->
<g id="node277" class="node">
<title>layer2_o_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="10675.79,-6500.43 10477.79,-6500.43 10477.79,-6417.43 10675.79,-6417.43 10675.79,-6500.43"/>
<text text-anchor="middle" x="10576.79" y="-6485.23" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10576.79" y="-6470.23" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="10576.79" y="-6455.23" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10576.79" y="-6440.23" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10576.79" y="-6425.23" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_o_proj_3_3 -->
<g id="edge632" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_o_proj_3_3</title>
<path fill="none" stroke="black" d="M9127.54,-6579.44C9358.96,-6565.89 9785.09,-6540.9 10148.79,-6519.43 10287.82,-6511.22 10327.64,-6529.16 10467.85,-6500.43"/>
<polygon fill="black" stroke="black" points="10468.6,-6503.84 10477.67,-6498.37 10467.17,-6496.99 10468.6,-6503.84"/>
</g>
<!-- layer2_res1 -->
<g id="node278" class="node">
<title>layer2_res1</title>
<ellipse fill="lightpink" stroke="black" cx="8908.79" cy="-6234.76" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="8908.79" y="-6246.06" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="8908.79" y="-6231.06" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8908.79" y="-6216.06" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer2_o_proj_0_0&#45;&gt;layer2_res1 -->
<g id="edge633" class="edge">
<title>layer2_o_proj_0_0&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M7435.97,-6419.74C7438.93,-6418.92 7441.87,-6418.15 7444.79,-6417.43 7912.41,-6302.44 8482.85,-6258.37 8752.84,-6243.07"/>
<polygon fill="black" stroke="black" points="8753.31,-6246.55 8763.1,-6242.49 8752.92,-6239.56 8753.31,-6246.55"/>
</g>
<!-- layer2_o_proj_0_1&#45;&gt;layer2_res1 -->
<g id="edge634" class="edge">
<title>layer2_o_proj_0_1&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M7651.99,-6419.82C7654.94,-6418.98 7657.88,-6418.18 7660.79,-6417.43 8046.75,-6318.19 8514.75,-6268.24 8753.03,-6247.65"/>
<polygon fill="black" stroke="black" points="8753.49,-6251.12 8763.15,-6246.78 8752.89,-6244.15 8753.49,-6251.12"/>
</g>
<!-- layer2_o_proj_0_2&#45;&gt;layer2_res1 -->
<g id="edge635" class="edge">
<title>layer2_o_proj_0_2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M7868.02,-6419.93C7870.96,-6419.06 7873.89,-6418.22 7876.79,-6417.43 8182.7,-6333.91 8550.47,-6279.91 8754.04,-6253.94"/>
<polygon fill="black" stroke="black" points="8754.73,-6257.38 8764.21,-6252.65 8753.85,-6250.44 8754.73,-6257.38"/>
</g>
<!-- layer2_o_proj_0_3&#45;&gt;layer2_res1 -->
<g id="edge636" class="edge">
<title>layer2_o_proj_0_3&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M8084.07,-6420.1C8087,-6419.18 8089.91,-6418.28 8092.79,-6417.43 8320.19,-6349.84 8589.86,-6294.5 8755.12,-6263.32"/>
<polygon fill="black" stroke="black" points="8756.18,-6266.69 8765.36,-6261.4 8754.89,-6259.81 8756.18,-6266.69"/>
</g>
<!-- layer2_o_proj_1_0&#45;&gt;layer2_res1 -->
<g id="edge637" class="edge">
<title>layer2_o_proj_1_0&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M8299.87,-6420.49C8302.87,-6419.45 8305.85,-6418.42 8308.79,-6417.43 8460.98,-6365.91 8637.17,-6313.4 8759.07,-6278.17"/>
<polygon fill="black" stroke="black" points="8760.22,-6281.48 8768.86,-6275.35 8758.28,-6274.76 8760.22,-6281.48"/>
</g>
<!-- layer2_o_proj_1_1&#45;&gt;layer2_res1 -->
<g id="edge638" class="edge">
<title>layer2_o_proj_1_1&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M8506.75,-6417.31C8579.44,-6384.48 8683.11,-6337.67 8766.96,-6299.81"/>
<polygon fill="black" stroke="black" points="8768.63,-6302.89 8776.31,-6295.59 8765.75,-6296.51 8768.63,-6302.89"/>
</g>
<!-- layer2_o_proj_1_2&#45;&gt;layer2_res1 -->
<g id="edge639" class="edge">
<title>layer2_o_proj_1_2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M8683.41,-6417.18C8712.76,-6393.56 8751.07,-6362.72 8787.75,-6333.2"/>
<polygon fill="black" stroke="black" points="8789.95,-6335.92 8795.55,-6326.92 8785.56,-6330.46 8789.95,-6335.92"/>
</g>
<!-- layer2_o_proj_1_3&#45;&gt;layer2_res1 -->
<g id="edge640" class="edge">
<title>layer2_o_proj_1_3&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M8859.8,-6417.18C8862.39,-6407.59 8865.3,-6396.81 8868.38,-6385.41"/>
<polygon fill="black" stroke="black" points="8871.77,-6386.27 8871,-6375.71 8865.01,-6384.45 8871.77,-6386.27"/>
</g>
<!-- layer2_o_proj_2_0&#45;&gt;layer2_res1 -->
<g id="edge641" class="edge">
<title>layer2_o_proj_2_0&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M9036.18,-6417.18C9025.17,-6401.51 9011.94,-6382.66 8998.22,-6363.12"/>
<polygon fill="black" stroke="black" points="9000.93,-6360.89 8992.32,-6354.72 8995.2,-6364.91 9000.93,-6360.89"/>
</g>
<!-- layer2_o_proj_2_1&#45;&gt;layer2_res1 -->
<g id="edge642" class="edge">
<title>layer2_o_proj_2_1&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M9212.56,-6417.18C9165.08,-6388.82 9100.2,-6350.08 9042.59,-6315.67"/>
<polygon fill="black" stroke="black" points="9044.16,-6312.53 9033.78,-6310.41 9040.57,-6318.54 9044.16,-6312.53"/>
</g>
<!-- layer2_o_proj_2_2&#45;&gt;layer2_res1 -->
<g id="edge643" class="edge">
<title>layer2_o_proj_2_2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M9397.71,-6420.49C9303.75,-6384.99 9161.44,-6331.22 9054.55,-6290.84"/>
<polygon fill="black" stroke="black" points="9055.56,-6287.48 9044.97,-6287.22 9053.09,-6294.02 9055.56,-6287.48"/>
</g>
<!-- layer2_o_proj_2_3&#45;&gt;layer2_res1 -->
<g id="edge644" class="edge">
<title>layer2_o_proj_2_3&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M9613.77,-6420.34C9610.75,-6419.34 9607.75,-6418.37 9604.79,-6417.43 9419.66,-6358.73 9202.61,-6304.31 9060.73,-6270.63"/>
<polygon fill="black" stroke="black" points="9061.19,-6267.14 9050.65,-6268.24 9059.58,-6273.95 9061.19,-6267.14"/>
</g>
<!-- layer2_o_proj_3_0&#45;&gt;layer2_res1 -->
<g id="edge645" class="edge">
<title>layer2_o_proj_3_0&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M9829.54,-6420.02C9826.6,-6419.12 9823.68,-6418.25 9820.79,-6417.43 9558.76,-6342.73 9245.85,-6287.57 9063.03,-6258.65"/>
<polygon fill="black" stroke="black" points="9063.49,-6255.18 9053.07,-6257.08 9062.4,-6262.09 9063.49,-6255.18"/>
</g>
<!-- layer2_o_proj_3_1&#45;&gt;layer2_res1 -->
<g id="edge646" class="edge">
<title>layer2_o_proj_3_1&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M10045.58,-6419.88C10042.63,-6419.02 10039.69,-6418.2 10036.79,-6417.43 9695.49,-6326.92 9283.42,-6274.44 9064.03,-6250.87"/>
<polygon fill="black" stroke="black" points="9064.37,-6247.39 9054.05,-6249.8 9063.63,-6254.35 9064.37,-6247.39"/>
</g>
<!-- layer2_o_proj_3_2&#45;&gt;layer2_res1 -->
<g id="edge647" class="edge">
<title>layer2_o_proj_3_2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M10261.6,-6419.78C10258.65,-6418.95 10255.7,-6418.16 10252.79,-6417.43 9830.59,-6311.17 9317.13,-6263.63 9064.5,-6245.43"/>
<polygon fill="black" stroke="black" points="9064.74,-6241.94 9054.52,-6244.72 9064.24,-6248.92 9064.74,-6241.94"/>
</g>
<!-- layer2_o_proj_3_3&#45;&gt;layer2_res1 -->
<g id="edge648" class="edge">
<title>layer2_o_proj_3_3&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M10477.62,-6419.71C10474.66,-6418.9 10471.71,-6418.13 10468.79,-6417.43 9964.53,-6295.44 9348.07,-6254.43 9064.76,-6241.42"/>
<polygon fill="black" stroke="black" points="9064.56,-6237.9 9054.41,-6240.95 9064.24,-6244.9 9064.56,-6237.9"/>
</g>
<!-- layer2_ln2_0_0 -->
<g id="node279" class="node">
<title>layer2_ln2_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="5621.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="5621.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5621.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="5621.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5621.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_0_0 -->
<g id="edge649" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_0_0</title>
<path fill="none" stroke="black" d="M8763.05,-6229.67C8227.24,-6213.96 6367.34,-6153.21 5782.79,-6052.1 5764.1,-6048.87 5744.49,-6044.23 5725.65,-6039.11"/>
<polygon fill="black" stroke="black" points="5726.45,-6035.7 5715.87,-6036.4 5724.57,-6042.45 5726.45,-6035.7"/>
</g>
<!-- layer2_ln2_0_1 -->
<g id="node280" class="node">
<title>layer2_ln2_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="10486.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10486.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10486.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="10486.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10486.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_0_1 -->
<g id="edge651" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_0_1</title>
<path fill="none" stroke="black" d="M9053.01,-6212.86C9358.95,-6168.51 10068.69,-6065.62 10359.27,-6023.5"/>
<polygon fill="black" stroke="black" points="10360.04,-6026.93 10369.43,-6022.03 10359.03,-6020 10360.04,-6026.93"/>
</g>
<!-- layer2_ln2_0_2 -->
<g id="node281" class="node">
<title>layer2_ln2_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="8142.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8142.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8142.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="8142.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8142.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_0_2 -->
<g id="edge653" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_0_2</title>
<path fill="none" stroke="black" d="M8769.19,-6192.07C8620.01,-6147.53 8386.71,-6077.86 8250.9,-6037.3"/>
<polygon fill="black" stroke="black" points="8251.87,-6033.94 8241.29,-6034.43 8249.87,-6040.65 8251.87,-6033.94"/>
</g>
<!-- layer2_ln2_0_3 -->
<g id="node282" class="node">
<title>layer2_ln2_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="9506.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9506.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9506.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="9506.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9506.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_0_3 -->
<g id="edge655" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_0_3</title>
<path fill="none" stroke="black" d="M9044.86,-6181.72C9155.88,-6139.25 9310.04,-6080.28 9409.12,-6042.38"/>
<polygon fill="black" stroke="black" points="9410.44,-6045.62 9418.53,-6038.78 9407.94,-6039.08 9410.44,-6045.62"/>
</g>
<!-- layer2_ln2_1_0 -->
<g id="node283" class="node">
<title>layer2_ln2_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12142.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="12142.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12142.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12142.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12142.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_1_0 -->
<g id="edge657" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_1_0</title>
<path fill="none" stroke="black" d="M9054.6,-6228.83C9582.09,-6210.42 11389.93,-6142.06 11960.79,-6052.1 11984.73,-6048.33 12010.1,-6042.78 12034.06,-6036.81"/>
<polygon fill="black" stroke="black" points="12035.04,-6040.17 12043.87,-6034.32 12033.31,-6033.38 12035.04,-6040.17"/>
</g>
<!-- layer2_ln2_1_1 -->
<g id="node284" class="node">
<title>layer2_ln2_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="8451.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8451.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8451.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="8451.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8451.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_1_1 -->
<g id="edge659" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_1_1</title>
<path fill="none" stroke="black" d="M8778.75,-6168.67C8700.85,-6129.68 8604.07,-6081.24 8536.09,-6047.21"/>
<polygon fill="black" stroke="black" points="8537.62,-6044.06 8527.11,-6042.72 8534.49,-6050.32 8537.62,-6044.06"/>
</g>
<!-- layer2_ln2_1_2 -->
<g id="node285" class="node">
<title>layer2_ln2_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6797.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6797.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6797.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="6797.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6797.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_1_2 -->
<g id="edge661" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_1_2</title>
<path fill="none" stroke="black" d="M8763.69,-6218.04C8372.99,-6175.71 7303.14,-6059.78 6929.04,-6019.24"/>
<polygon fill="black" stroke="black" points="6929.3,-6015.75 6918.98,-6018.15 6928.55,-6022.71 6929.3,-6015.75"/>
</g>
<!-- layer2_ln2_1_3 -->
<g id="node286" class="node">
<title>layer2_ln2_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="11000.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11000.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11000.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="11000.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11000.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_1_3 -->
<g id="edge663" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_1_3</title>
<path fill="none" stroke="black" d="M9053.64,-6219.32C9348.95,-6189.66 10041.82,-6119.07 10622.79,-6052.1 10705.62,-6042.55 10798.54,-6030.99 10871.52,-6021.71"/>
<polygon fill="black" stroke="black" points="10872.21,-6025.15 10881.69,-6020.42 10871.32,-6018.21 10872.21,-6025.15"/>
</g>
<!-- layer2_ln2_2_0 -->
<g id="node287" class="node">
<title>layer2_ln2_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="9984.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9984.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9984.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="9984.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9984.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_2_0 -->
<g id="edge665" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_2_0</title>
<path fill="none" stroke="black" d="M9051.12,-6203.51C9265.12,-6158.01 9665.91,-6072.81 9865.51,-6030.38"/>
<polygon fill="black" stroke="black" points="9866.39,-6033.77 9875.44,-6028.26 9864.93,-6026.92 9866.39,-6033.77"/>
</g>
<!-- layer2_ln2_2_1 -->
<g id="node288" class="node">
<title>layer2_ln2_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7372.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7372.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7372.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="7372.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7372.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_2_1 -->
<g id="edge667" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_2_1</title>
<path fill="none" stroke="black" d="M8764.42,-6213.63C8531.71,-6180.99 8059.32,-6113.92 7659.79,-6052.1 7606.58,-6043.87 7547.9,-6034.32 7497.54,-6025.99"/>
<polygon fill="black" stroke="black" points="7498.02,-6022.52 7487.58,-6024.34 7496.87,-6029.43 7498.02,-6022.52"/>
</g>
<!-- layer2_ln2_2_2 -->
<g id="node289" class="node">
<title>layer2_ln2_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7795.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7795.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7795.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="7795.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7795.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_2_2 -->
<g id="edge669" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_2_2</title>
<path fill="none" stroke="black" d="M8765.66,-6205.89C8587.6,-6171 8274.39,-6108.9 8006.79,-6052.1 7976.39,-6045.65 7943.59,-6038.45 7913.12,-6031.65"/>
<polygon fill="black" stroke="black" points="7913.83,-6028.23 7903.31,-6029.46 7912.31,-6035.06 7913.83,-6028.23"/>
</g>
<!-- layer2_ln2_2_3 -->
<g id="node290" class="node">
<title>layer2_ln2_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="11824.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11824.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11824.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="11824.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11824.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_2_3 -->
<g id="edge671" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_2_3</title>
<path fill="none" stroke="black" d="M9054.76,-6230.83C9459.88,-6221.19 10631.85,-6183.17 11595.79,-6052.1 11632.55,-6047.1 11672.26,-6039.67 11708.12,-6032.18"/>
<polygon fill="black" stroke="black" points="11709.06,-6035.56 11718.12,-6030.07 11707.62,-6028.71 11709.06,-6035.56"/>
</g>
<!-- layer2_ln2_3_0 -->
<g id="node291" class="node">
<title>layer2_ln2_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="11459.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11459.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11459.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="11459.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11459.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_3_0 -->
<g id="edge673" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_3_0</title>
<path fill="none" stroke="black" d="M9054.43,-6225.1C9410.54,-6203.21 10353.52,-6141.03 11136.79,-6052.1 11202,-6044.7 11274.3,-6034.36 11333.94,-6025.25"/>
<polygon fill="black" stroke="black" points="11334.81,-6028.66 11344.16,-6023.69 11333.75,-6021.74 11334.81,-6028.66"/>
</g>
<!-- layer2_ln2_3_1 -->
<g id="node292" class="node">
<title>layer2_ln2_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9076.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9076.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9076.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="9076.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9076.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_3_1 -->
<g id="edge675" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_3_1</title>
<path fill="none" stroke="black" d="M8994.76,-6116.71C9009.61,-6096.5 9024.37,-6076.39 9037.2,-6058.93"/>
<polygon fill="black" stroke="black" points="9040.23,-6060.71 9043.33,-6050.58 9034.59,-6056.57 9040.23,-6060.71"/>
</g>
<!-- layer2_ln2_3_2 -->
<g id="node293" class="node">
<title>layer2_ln2_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="5918.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="5918.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5918.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="5918.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5918.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_3_2 -->
<g id="edge677" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_3_2</title>
<path fill="none" stroke="black" d="M8763.57,-6222.65C8252.94,-6183.59 6544.43,-6052.88 6052.42,-6015.24"/>
<polygon fill="black" stroke="black" points="6052.67,-6011.75 6042.43,-6014.48 6052.14,-6018.73 6052.67,-6011.75"/>
</g>
<!-- layer2_ln2_3_3 -->
<g id="node294" class="node">
<title>layer2_ln2_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="8741.79" cy="-6004.02" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8741.79" y="-6022.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8741.79" y="-6007.82" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="8741.79" y="-5992.82" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8741.79" y="-5977.82" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2_3_3 -->
<g id="edge679" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2_3_3</title>
<path fill="none" stroke="black" d="M8823.33,-6116.71C8808.58,-6096.5 8793.9,-6076.39 8781.15,-6058.93"/>
<polygon fill="black" stroke="black" points="8783.78,-6056.59 8775.05,-6050.58 8778.12,-6060.72 8783.78,-6056.59"/>
</g>
<!-- layer2_gate_0_0 -->
<g id="node295" class="node">
<title>layer2_gate_0_0</title>
<polygon fill="purple" stroke="black" points="5170.65,-5851.16 5043.72,-5918.7 4789.86,-5918.7 4662.93,-5851.16 4789.86,-5783.63 5043.72,-5783.63 5170.65,-5851.16"/>
<text text-anchor="middle" x="4916.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4916.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="4916.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="4916.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4916.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_0_0&#45;&gt;layer2_gate_0_0 -->
<g id="edge650" class="edge">
<title>layer2_ln2_0_0&#45;&gt;layer2_gate_0_0</title>
<path fill="none" stroke="black" d="M5507.39,-5983.22C5417.92,-5967.26 5290.56,-5943.51 5179.79,-5918.93 5152.43,-5912.86 5123.59,-5906.01 5095.43,-5899.07"/>
<polygon fill="black" stroke="black" points="5096.04,-5895.61 5085.5,-5896.61 5094.36,-5902.41 5096.04,-5895.61"/>
</g>
<!-- layer2_gate_0_1 -->
<g id="node296" class="node">
<title>layer2_gate_0_1</title>
<polygon fill="purple" stroke="black" points="10956.65,-5851.16 10829.72,-5918.7 10575.86,-5918.7 10448.93,-5851.16 10575.86,-5783.63 10829.72,-5783.63 10956.65,-5851.16"/>
<text text-anchor="middle" x="10702.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10702.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="10702.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10702.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="10702.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_0_1&#45;&gt;layer2_gate_0_1 -->
<g id="edge652" class="edge">
<title>layer2_ln2_0_1&#45;&gt;layer2_gate_0_1</title>
<path fill="none" stroke="black" d="M10546.39,-5961.4C10562.74,-5949.98 10580.96,-5937.25 10599.02,-5924.64"/>
<polygon fill="black" stroke="black" points="10601.1,-5927.45 10607.3,-5918.86 10597.09,-5921.71 10601.1,-5927.45"/>
</g>
<!-- layer2_gate_0_2 -->
<g id="node297" class="node">
<title>layer2_gate_0_2</title>
<polygon fill="purple" stroke="black" points="7800.65,-5851.16 7673.72,-5918.7 7419.86,-5918.7 7292.93,-5851.16 7419.86,-5783.63 7673.72,-5783.63 7800.65,-5851.16"/>
<text text-anchor="middle" x="7546.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7546.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="7546.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7546.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7546.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_0_2&#45;&gt;layer2_gate_0_2 -->
<g id="edge654" class="edge">
<title>layer2_ln2_0_2&#45;&gt;layer2_gate_0_2</title>
<path fill="none" stroke="black" d="M8038.54,-5976.73C7972.89,-5960.17 7886.38,-5938.33 7809.79,-5918.93 7783.14,-5912.19 7754.96,-5905.04 7727.35,-5898.04"/>
<polygon fill="black" stroke="black" points="7728.17,-5894.63 7717.61,-5895.57 7726.44,-5901.42 7728.17,-5894.63"/>
</g>
<!-- layer2_gate_0_3 -->
<g id="node298" class="node">
<title>layer2_gate_0_3</title>
<polygon fill="purple" stroke="black" points="9904.65,-5851.16 9777.72,-5918.7 9523.86,-5918.7 9396.93,-5851.16 9523.86,-5783.63 9777.72,-5783.63 9904.65,-5851.16"/>
<text text-anchor="middle" x="9650.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9650.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="9650.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9650.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="9650.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_0_3&#45;&gt;layer2_gate_0_3 -->
<g id="edge656" class="edge">
<title>layer2_ln2_0_3&#45;&gt;layer2_gate_0_3</title>
<path fill="none" stroke="black" d="M9549.22,-5958.57C9558.95,-5948.38 9569.55,-5937.27 9580.12,-5926.2"/>
<polygon fill="black" stroke="black" points="9582.67,-5928.59 9587.05,-5918.94 9577.61,-5923.76 9582.67,-5928.59"/>
</g>
<!-- layer2_gate_1_0 -->
<g id="node299" class="node">
<title>layer2_gate_1_0</title>
<polygon fill="purple" stroke="black" points="13060.65,-5851.16 12933.72,-5918.7 12679.86,-5918.7 12552.93,-5851.16 12679.86,-5783.63 12933.72,-5783.63 13060.65,-5851.16"/>
<text text-anchor="middle" x="12806.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12806.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12806.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="12806.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="12806.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_1_0&#45;&gt;layer2_gate_1_0 -->
<g id="edge658" class="edge">
<title>layer2_ln2_1_0&#45;&gt;layer2_gate_1_0</title>
<path fill="none" stroke="black" d="M12254.13,-5980.98C12334.76,-5964.7 12446.26,-5941.53 12543.79,-5918.93 12570.89,-5912.66 12599.47,-5905.72 12627.42,-5898.77"/>
<polygon fill="black" stroke="black" points="12628.42,-5902.13 12637.27,-5896.31 12626.72,-5895.34 12628.42,-5902.13"/>
</g>
<!-- layer2_gate_1_1 -->
<g id="node300" class="node">
<title>layer2_gate_1_1</title>
<polygon fill="purple" stroke="black" points="8326.65,-5851.16 8199.72,-5918.7 7945.86,-5918.7 7818.93,-5851.16 7945.86,-5783.63 8199.72,-5783.63 8326.65,-5851.16"/>
<text text-anchor="middle" x="8072.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8072.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="8072.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8072.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8072.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_1_1&#45;&gt;layer2_gate_1_1 -->
<g id="edge660" class="edge">
<title>layer2_ln2_1_1&#45;&gt;layer2_gate_1_1</title>
<path fill="none" stroke="black" d="M8365.32,-5968.6C8324.25,-5952.25 8273.91,-5932.22 8226.64,-5913.4"/>
<polygon fill="black" stroke="black" points="8227.82,-5910.1 8217.23,-5909.66 8225.23,-5916.61 8227.82,-5910.1"/>
</g>
<!-- layer2_gate_1_2 -->
<g id="node301" class="node">
<title>layer2_gate_1_2</title>
<polygon fill="purple" stroke="black" points="6222.65,-5851.16 6095.72,-5918.7 5841.86,-5918.7 5714.93,-5851.16 5841.86,-5783.63 6095.72,-5783.63 6222.65,-5851.16"/>
<text text-anchor="middle" x="5968.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5968.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="5968.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5968.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="5968.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_1_2&#45;&gt;layer2_gate_1_2 -->
<g id="edge662" class="edge">
<title>layer2_ln2_1_2&#45;&gt;layer2_gate_1_2</title>
<path fill="none" stroke="black" d="M6677.65,-5988.75C6562.66,-5974.25 6384.59,-5949.6 6231.79,-5918.93 6204.01,-5913.36 6174.76,-5906.72 6146.27,-5899.82"/>
<polygon fill="black" stroke="black" points="6146.77,-5896.34 6136.22,-5897.37 6145.11,-5903.14 6146.77,-5896.34"/>
</g>
<!-- layer2_gate_1_3 -->
<g id="node302" class="node">
<title>layer2_gate_1_3</title>
<polygon fill="purple" stroke="black" points="11482.65,-5851.16 11355.72,-5918.7 11101.86,-5918.7 10974.93,-5851.16 11101.86,-5783.63 11355.72,-5783.63 11482.65,-5851.16"/>
<text text-anchor="middle" x="11228.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11228.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="11228.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11228.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="11228.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_1_3&#45;&gt;layer2_gate_1_3 -->
<g id="edge664" class="edge">
<title>layer2_ln2_1_3&#45;&gt;layer2_gate_1_3</title>
<path fill="none" stroke="black" d="M11062.79,-5962C11080.45,-5950.32 11100.22,-5937.23 11119.79,-5924.28"/>
<polygon fill="black" stroke="black" points="11121.75,-5927.18 11128.16,-5918.75 11117.89,-5921.34 11121.75,-5927.18"/>
</g>
<!-- layer2_gate_2_0 -->
<g id="node303" class="node">
<title>layer2_gate_2_0</title>
<polygon fill="purple" stroke="black" points="10430.65,-5851.16 10303.72,-5918.7 10049.86,-5918.7 9922.93,-5851.16 10049.86,-5783.63 10303.72,-5783.63 10430.65,-5851.16"/>
<text text-anchor="middle" x="10176.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10176.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="10176.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10176.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10176.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_2_0&#45;&gt;layer2_gate_2_0 -->
<g id="edge666" class="edge">
<title>layer2_ln2_2_0&#45;&gt;layer2_gate_2_0</title>
<path fill="none" stroke="black" d="M10039.04,-5960.39C10053.02,-5949.41 10068.46,-5937.28 10083.8,-5925.23"/>
<polygon fill="black" stroke="black" points="10086.1,-5927.87 10091.8,-5918.94 10081.78,-5922.37 10086.1,-5927.87"/>
</g>
<!-- layer2_gate_2_1 -->
<g id="node304" class="node">
<title>layer2_gate_2_1</title>
<polygon fill="purple" stroke="black" points="6748.65,-5851.16 6621.72,-5918.7 6367.86,-5918.7 6240.93,-5851.16 6367.86,-5783.63 6621.72,-5783.63 6748.65,-5851.16"/>
<text text-anchor="middle" x="6494.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6494.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="6494.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6494.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="6494.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_2_1&#45;&gt;layer2_gate_2_1 -->
<g id="edge668" class="edge">
<title>layer2_ln2_2_1&#45;&gt;layer2_gate_2_1</title>
<path fill="none" stroke="black" d="M7251.06,-5990.47C7126.51,-5976.68 6927.7,-5952.01 6757.79,-5918.93 6729.87,-5913.5 6700.49,-5906.91 6671.89,-5900.02"/>
<polygon fill="black" stroke="black" points="6672.36,-5896.53 6661.81,-5897.57 6670.7,-5903.34 6672.36,-5896.53"/>
</g>
<!-- layer2_gate_2_2 -->
<g id="node305" class="node">
<title>layer2_gate_2_2</title>
<polygon fill="purple" stroke="black" points="7274.65,-5851.16 7147.72,-5918.7 6893.86,-5918.7 6766.93,-5851.16 6893.86,-5783.63 7147.72,-5783.63 7274.65,-5851.16"/>
<text text-anchor="middle" x="7020.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7020.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="7020.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7020.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="7020.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_2_2&#45;&gt;layer2_gate_2_2 -->
<g id="edge670" class="edge">
<title>layer2_ln2_2_2&#45;&gt;layer2_gate_2_2</title>
<path fill="none" stroke="black" d="M7680.28,-5984.06C7529.65,-5959.34 7285.01,-5919.19 7283.79,-5918.93 7256.15,-5913.17 7227.04,-5906.44 7198.66,-5899.52"/>
<polygon fill="black" stroke="black" points="7199.2,-5896.05 7188.65,-5897.07 7197.53,-5902.85 7199.2,-5896.05"/>
</g>
<!-- layer2_gate_2_3 -->
<g id="node306" class="node">
<title>layer2_gate_2_3</title>
<polygon fill="purple" stroke="black" points="12534.65,-5851.16 12407.72,-5918.7 12153.86,-5918.7 12026.93,-5851.16 12153.86,-5783.63 12407.72,-5783.63 12534.65,-5851.16"/>
<text text-anchor="middle" x="12280.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12280.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="12280.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="12280.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="12280.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_2_3&#45;&gt;layer2_gate_2_3 -->
<g id="edge672" class="edge">
<title>layer2_ln2_2_3&#45;&gt;layer2_gate_2_3</title>
<path fill="none" stroke="black" d="M11919,-5971.85C11975.67,-5953.1 12049.41,-5928.71 12115.52,-5906.84"/>
<polygon fill="black" stroke="black" points="12116.82,-5910.09 12125.22,-5903.63 12114.63,-5903.45 12116.82,-5910.09"/>
</g>
<!-- layer2_gate_3_0 -->
<g id="node307" class="node">
<title>layer2_gate_3_0</title>
<polygon fill="purple" stroke="black" points="12008.65,-5851.16 11881.72,-5918.7 11627.86,-5918.7 11500.93,-5851.16 11627.86,-5783.63 11881.72,-5783.63 12008.65,-5851.16"/>
<text text-anchor="middle" x="11754.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11754.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="11754.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11754.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11754.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_3_0&#45;&gt;layer2_gate_3_0 -->
<g id="edge674" class="edge">
<title>layer2_ln2_3_0&#45;&gt;layer2_gate_3_0</title>
<path fill="none" stroke="black" d="M11534.23,-5964.95C11559.41,-5952.07 11588.4,-5937.25 11616.9,-5922.68"/>
<polygon fill="black" stroke="black" points="11618.82,-5925.63 11626.13,-5917.96 11615.63,-5919.39 11618.82,-5925.63"/>
</g>
<!-- layer2_gate_3_1 -->
<g id="node308" class="node">
<title>layer2_gate_3_1</title>
<polygon fill="purple" stroke="black" points="9378.65,-5851.16 9251.72,-5918.7 8997.86,-5918.7 8870.93,-5851.16 8997.86,-5783.63 9251.72,-5783.63 9378.65,-5851.16"/>
<text text-anchor="middle" x="9124.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9124.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="9124.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9124.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9124.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_3_1&#45;&gt;layer2_gate_3_1 -->
<g id="edge676" class="edge">
<title>layer2_ln2_3_1&#45;&gt;layer2_gate_3_1</title>
<path fill="none" stroke="black" d="M9091.72,-5956.11C9094.49,-5947.38 9097.46,-5938.06 9100.44,-5928.7"/>
<polygon fill="black" stroke="black" points="9103.84,-5929.57 9103.53,-5918.98 9097.17,-5927.44 9103.84,-5929.57"/>
</g>
<!-- layer2_gate_3_2 -->
<g id="node309" class="node">
<title>layer2_gate_3_2</title>
<polygon fill="purple" stroke="black" points="5696.65,-5851.16 5569.72,-5918.7 5315.86,-5918.7 5188.93,-5851.16 5315.86,-5783.63 5569.72,-5783.63 5696.65,-5851.16"/>
<text text-anchor="middle" x="5442.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5442.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="5442.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5442.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="5442.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_3_2&#45;&gt;layer2_gate_3_2 -->
<g id="edge678" class="edge">
<title>layer2_ln2_3_2&#45;&gt;layer2_gate_3_2</title>
<path fill="none" stroke="black" d="M5822.75,-5972.58C5762.06,-5953.35 5681.96,-5927.96 5610.95,-5905.46"/>
<polygon fill="black" stroke="black" points="5611.59,-5901.99 5601,-5902.3 5609.47,-5908.66 5611.59,-5901.99"/>
</g>
<!-- layer2_gate_3_3 -->
<g id="node310" class="node">
<title>layer2_gate_3_3</title>
<polygon fill="purple" stroke="black" points="8852.65,-5851.16 8725.72,-5918.7 8471.86,-5918.7 8344.93,-5851.16 8471.86,-5783.63 8725.72,-5783.63 8852.65,-5851.16"/>
<text text-anchor="middle" x="8598.79" y="-5877.46" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8598.79" y="-5862.46" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="8598.79" y="-5847.46" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8598.79" y="-5832.46" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="8598.79" y="-5817.46" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer2_ln2_3_3&#45;&gt;layer2_gate_3_3 -->
<g id="edge680" class="edge">
<title>layer2_ln2_3_3&#45;&gt;layer2_gate_3_3</title>
<path fill="none" stroke="black" d="M8699.66,-5958.57C8690,-5948.38 8679.47,-5937.27 8668.97,-5926.2"/>
<polygon fill="black" stroke="black" points="8671.51,-5923.79 8662.09,-5918.94 8666.43,-5928.61 8671.51,-5923.79"/>
</g>
<!-- layer2_expert1_0 -->
<g id="node311" class="node">
<title>layer2_expert1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="8008.29,-5717.4 7829.29,-5717.4 7829.29,-5649.4 8008.29,-5649.4 8008.29,-5717.4"/>
<text text-anchor="middle" x="7918.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 0 First Linear</text>
<text text-anchor="middle" x="7918.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7918.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7918.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_0 -->
<g id="edge681" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.41,-5802.46C5112.36,-5794.62 5146.97,-5787.66 5179.79,-5783.4 5229.51,-5776.93 6940.98,-5789.79 6984.79,-5765.4 6998.58,-5757.72 6990.18,-5743.39 7003.79,-5735.4 7072.66,-5694.96 7596.38,-5686.58 7819.08,-5684.85"/>
<polygon fill="black" stroke="black" points="7819.16,-5688.35 7829.13,-5684.77 7819.11,-5681.35 7819.16,-5688.35"/>
<text text-anchor="middle" x="7049.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7049.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer2_expert1_1 -->
<g id="node314" class="node">
<title>layer2_expert1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="4360.29,-5717.4 4181.29,-5717.4 4181.29,-5649.4 4360.29,-5649.4 4360.29,-5717.4"/>
<text text-anchor="middle" x="4270.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 1 First Linear</text>
<text text-anchor="middle" x="4270.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4270.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4270.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_1 -->
<g id="edge682" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4673.13,-5845.58C4246.31,-5836.33 3404.16,-5812.25 3359.79,-5765.4 3350.62,-5755.71 3350.63,-5745.08 3359.79,-5735.4 3387.32,-5706.28 3940.59,-5691.33 4171.21,-5686.34"/>
<polygon fill="black" stroke="black" points="4171.36,-5689.84 4181.28,-5686.12 4171.21,-5682.84 4171.36,-5689.84"/>
<text text-anchor="middle" x="3405.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3405.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer2_expert1_2 -->
<g id="node317" class="node">
<title>layer2_expert1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="9718.29,-5717.4 9539.29,-5717.4 9539.29,-5649.4 9718.29,-5649.4 9718.29,-5717.4"/>
<text text-anchor="middle" x="9628.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 2 First Linear</text>
<text text-anchor="middle" x="9628.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9628.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9628.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_2 -->
<g id="edge683" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.05,-5802.41C5112.1,-5794.55 5146.85,-5787.6 5179.79,-5783.4 5229.79,-5777.02 8764.69,-5789.81 8808.79,-5765.4 8822.6,-5757.75 8814.21,-5743.44 8827.79,-5735.4 8886.71,-5700.49 9327.46,-5689.12 9528.89,-5685.72"/>
<polygon fill="black" stroke="black" points="9529.24,-5689.22 9539.18,-5685.55 9529.12,-5682.22 9529.24,-5689.22"/>
<text text-anchor="middle" x="8873.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8873.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer2_expert1_3 -->
<g id="node320" class="node">
<title>layer2_expert1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6184.29,-5717.4 6005.29,-5717.4 6005.29,-5649.4 6184.29,-5649.4 6184.29,-5717.4"/>
<text text-anchor="middle" x="6094.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 3 First Linear</text>
<text text-anchor="middle" x="6094.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6094.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="6094.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_3 -->
<g id="edge684" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5076.59,-5800.94C5105.13,-5790.38 5134.22,-5778.43 5160.79,-5765.4 5182.7,-5754.64 5183.6,-5743.02 5206.79,-5735.4 5350.53,-5688.14 5794.56,-5683.35 5994.91,-5683.7"/>
<polygon fill="black" stroke="black" points="5995.13,-5687.2 6005.14,-5683.72 5995.15,-5680.2 5995.13,-5687.2"/>
<text text-anchor="middle" x="5252.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5252.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer2_expert1_4 -->
<g id="node323" class="node">
<title>layer2_expert1_4</title>
<polygon fill="lightsteelblue" stroke="black" points="15190.29,-5717.4 15011.29,-5717.4 15011.29,-5649.4 15190.29,-5649.4 15190.29,-5717.4"/>
<text text-anchor="middle" x="15100.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 4 First Linear</text>
<text text-anchor="middle" x="15100.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="15100.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="15100.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_4 -->
<g id="edge685" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.04,-5802.34C5112.09,-5794.47 5146.84,-5787.55 5179.79,-5783.4 5304.85,-5767.64 14134.19,-5802.04 14254.79,-5765.4 14277.79,-5758.41 14277.02,-5743.09 14299.79,-5735.4 14426.91,-5692.45 14816.07,-5685.26 15001.08,-5684.33"/>
<polygon fill="black" stroke="black" points="15001.1,-5687.83 15011.08,-5684.28 15001.07,-5680.83 15001.1,-5687.83"/>
<text text-anchor="middle" x="14345.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14345.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer2_expert1_5 -->
<g id="node326" class="node">
<title>layer2_expert1_5</title>
<polygon fill="lightsteelblue" stroke="black" points="13366.29,-5717.4 13187.29,-5717.4 13187.29,-5649.4 13366.29,-5649.4 13366.29,-5717.4"/>
<text text-anchor="middle" x="13276.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 5 First Linear</text>
<text text-anchor="middle" x="13276.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13276.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="13276.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_5 -->
<g id="edge686" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.04,-5802.35C5112.09,-5794.49 5146.84,-5787.55 5179.79,-5783.4 5229.93,-5777.07 12412.55,-5789.82 12456.79,-5765.4 12470.61,-5757.77 12462.21,-5743.44 12475.79,-5735.4 12534.71,-5700.49 12975.46,-5689.12 13176.89,-5685.72"/>
<polygon fill="black" stroke="black" points="13177.24,-5689.22 13187.18,-5685.55 13177.12,-5682.22 13177.24,-5689.22"/>
<text text-anchor="middle" x="12521.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12521.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer2_expert1_6 -->
<g id="node329" class="node">
<title>layer2_expert1_6</title>
<polygon fill="lightsteelblue" stroke="black" points="2650.29,-5717.4 2471.29,-5717.4 2471.29,-5649.4 2650.29,-5649.4 2650.29,-5717.4"/>
<text text-anchor="middle" x="2560.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 6 First Linear</text>
<text text-anchor="middle" x="2560.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2560.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2560.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_6 -->
<g id="edge687" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4668.09,-5848.31C3914.16,-5842.1 1702.33,-5819.31 1649.79,-5765.4 1640.49,-5755.85 1640.63,-5745.08 1649.79,-5735.4 1677.32,-5706.28 2230.59,-5691.33 2461.21,-5686.34"/>
<polygon fill="black" stroke="black" points="2461.36,-5689.84 2471.28,-5686.12 2461.21,-5682.84 2461.36,-5689.84"/>
<text text-anchor="middle" x="1695.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1695.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer2_expert1_7 -->
<g id="node332" class="node">
<title>layer2_expert1_7</title>
<polygon fill="lightsteelblue" stroke="black" points="11542.29,-5717.4 11363.29,-5717.4 11363.29,-5649.4 11542.29,-5649.4 11542.29,-5717.4"/>
<text text-anchor="middle" x="11452.79" y="-5702.2" font-family="Times,serif" font-size="14.00">Expert 7 First Linear</text>
<text text-anchor="middle" x="11452.79" y="-5687.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11452.79" y="-5672.2" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="11452.79" y="-5657.2" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer2_gate_0_0&#45;&gt;layer2_expert1_7 -->
<g id="edge688" class="edge">
<title>layer2_gate_0_0&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.04,-5802.37C5112.1,-5794.51 5146.84,-5787.57 5179.79,-5783.4 5217.36,-5778.64 10599.65,-5783.71 10632.79,-5765.4 10646.61,-5757.76 10638.21,-5743.44 10651.79,-5735.4 10710.71,-5700.49 11151.46,-5689.12 11352.89,-5685.72"/>
<polygon fill="black" stroke="black" points="11353.24,-5689.22 11363.18,-5685.55 11353.12,-5682.22 11353.24,-5689.22"/>
<text text-anchor="middle" x="10697.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10697.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_0 -->
<g id="edge689" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10540.17,-5802.42C10507.22,-5794.57 10472.61,-5787.63 10439.79,-5783.4 10379.79,-5775.65 8315.94,-5792.39 8261.79,-5765.4 8246.76,-5757.9 8253.22,-5744 8238.79,-5735.4 8202.41,-5713.72 8098.14,-5699.9 8018.41,-5692.19"/>
<polygon fill="black" stroke="black" points="8018.61,-5688.69 8008.33,-5691.24 8017.95,-5695.66 8018.61,-5688.69"/>
<text text-anchor="middle" x="8307.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8307.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→0</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_1 -->
<g id="edge690" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10540.54,-5802.36C10507.49,-5794.5 10472.74,-5787.56 10439.79,-5783.4 10399.65,-5778.32 4650.05,-5783.35 4613.79,-5765.4 4598.74,-5757.94 4605.22,-5744 4590.79,-5735.4 4554.41,-5713.72 4450.14,-5699.9 4370.41,-5692.19"/>
<polygon fill="black" stroke="black" points="4370.61,-5688.69 4360.33,-5691.24 4369.95,-5695.66 4370.61,-5688.69"/>
<text text-anchor="middle" x="4659.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4659.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_2 -->
<g id="edge691" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10538.61,-5803.18C10506.1,-5795.38 10472.05,-5788.26 10439.79,-5783.4 10400.85,-5777.52 10120.66,-5783.71 10085.79,-5765.4 10070.92,-5757.58 10077.4,-5743.7 10062.79,-5735.4 10007.55,-5704 9838.76,-5691.85 9728.69,-5687.21"/>
<polygon fill="black" stroke="black" points="9728.69,-5683.71 9718.56,-5686.79 9728.4,-5690.7 9728.69,-5683.71"/>
<text text-anchor="middle" x="10131.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10131.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→4</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_3 -->
<g id="edge692" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10540.54,-5802.4C10507.48,-5794.53 10472.74,-5787.59 10439.79,-5783.4 10384.65,-5776.38 6487.58,-5790.1 6437.79,-5765.4 6422.74,-5757.93 6429.22,-5744 6414.79,-5735.4 6378.41,-5713.72 6274.14,-5699.9 6194.41,-5692.19"/>
<polygon fill="black" stroke="black" points="6194.61,-5688.69 6184.33,-5691.24 6193.95,-5695.66 6194.61,-5688.69"/>
<text text-anchor="middle" x="6483.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6483.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→6</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_4 -->
<g id="edge693" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10865.04,-5802.39C10898.1,-5794.52 10932.84,-5787.58 10965.79,-5783.4 10997.27,-5779.4 15512.4,-5787.88 15534.79,-5765.4 15544.2,-5755.95 15543.65,-5745.36 15534.79,-5735.4 15512.94,-5710.82 15321.62,-5696.14 15200.41,-5689.23"/>
<polygon fill="black" stroke="black" points="15200.54,-5685.73 15190.35,-5688.66 15200.14,-5692.72 15200.54,-5685.73"/>
<text text-anchor="middle" x="15586.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15586.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→8</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_5 -->
<g id="edge694" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10865.4,-5802.37C10898.35,-5794.53 10932.97,-5787.61 10965.79,-5783.4 11003.61,-5778.54 13683.92,-5792.44 13710.79,-5765.4 13720.19,-5755.94 13719.65,-5745.36 13710.79,-5735.4 13688.94,-5710.82 13497.62,-5696.14 13376.41,-5689.23"/>
<polygon fill="black" stroke="black" points="13376.54,-5685.73 13366.35,-5688.66 13376.14,-5692.72 13376.54,-5685.73"/>
<text text-anchor="middle" x="13762.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13762.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→10</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_6 -->
<g id="edge695" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10540.55,-5802.35C10507.49,-5794.48 10472.74,-5787.55 10439.79,-5783.4 10387.87,-5776.84 2950.7,-5788.61 2903.79,-5765.4 2888.73,-5757.94 2895.22,-5744 2880.79,-5735.4 2844.41,-5713.72 2740.14,-5699.9 2660.41,-5692.19"/>
<polygon fill="black" stroke="black" points="2660.61,-5688.69 2650.33,-5691.24 2659.95,-5695.66 2660.61,-5688.69"/>
<text text-anchor="middle" x="2949.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2949.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→12</text>
</g>
<!-- layer2_gate_0_1&#45;&gt;layer2_expert1_7 -->
<g id="edge696" class="edge">
<title>layer2_gate_0_1&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10865.8,-5802.62C10898.64,-5794.79 10933.11,-5787.8 10965.79,-5783.4 10991.15,-5779.97 11868.88,-5783.67 11886.79,-5765.4 11896.13,-5755.88 11895.65,-5745.36 11886.79,-5735.4 11864.94,-5710.82 11673.62,-5696.14 11552.41,-5689.23"/>
<polygon fill="black" stroke="black" points="11552.54,-5685.73 11542.35,-5688.66 11552.14,-5692.72 11552.54,-5685.73"/>
<text text-anchor="middle" x="11938.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11938.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 1→14</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_0 -->
<g id="edge697" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7556.31,-5783.62C7562.05,-5765.56 7571.2,-5747.63 7585.79,-5735.4 7620.3,-5706.47 7733.79,-5693.89 7818.75,-5688.46"/>
<polygon fill="black" stroke="black" points="7819.19,-5691.94 7828.96,-5687.83 7818.76,-5684.95 7819.19,-5691.94"/>
<text text-anchor="middle" x="7631.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7631.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_1 -->
<g id="edge698" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7384.18,-5802.34C7351.23,-5794.51 7316.62,-5787.59 7283.79,-5783.4 7260.69,-5780.45 3946.22,-5781.91 3929.79,-5765.4 3920.39,-5755.94 3921.09,-5745.5 3929.79,-5735.4 3960.45,-5699.81 4081.69,-5688.69 4170.92,-5685.41"/>
<polygon fill="black" stroke="black" points="4171.21,-5688.9 4181.09,-5685.06 4170.97,-5681.91 4171.21,-5688.9"/>
<text text-anchor="middle" x="3975.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3975.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_2 -->
<g id="edge699" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7709.42,-5802.5C7742.37,-5794.65 7776.98,-5787.69 7809.79,-5783.4 7853.01,-5777.74 9340.73,-5786.63 9378.79,-5765.4 9392.57,-5757.71 9384.87,-5744.46 9397.79,-5735.4 9435.92,-5708.64 9485.61,-5695.59 9529.12,-5689.34"/>
<polygon fill="black" stroke="black" points="9529.72,-5692.79 9539.17,-5688 9528.8,-5685.85 9529.72,-5692.79"/>
<text text-anchor="middle" x="9443.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9443.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_3 -->
<g id="edge700" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7384.16,-5802.51C7351.21,-5794.66 7316.6,-5787.69 7283.79,-5783.4 7262.72,-5780.64 5768.73,-5780.51 5753.79,-5765.4 5744.42,-5755.91 5745.09,-5745.5 5753.79,-5735.4 5784.45,-5699.81 5905.69,-5688.69 5994.92,-5685.41"/>
<polygon fill="black" stroke="black" points="5995.21,-5688.9 6005.09,-5685.06 5994.97,-5681.91 5995.21,-5688.9"/>
<text text-anchor="middle" x="5799.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5799.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_4 -->
<g id="edge701" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7709.04,-5802.35C7742.09,-5794.49 7776.84,-5787.56 7809.79,-5783.4 7858.3,-5777.27 14807.98,-5789.03 14850.79,-5765.4 14864.61,-5757.77 14856.87,-5744.46 14869.79,-5735.4 14907.92,-5708.64 14957.61,-5695.59 15001.12,-5689.34"/>
<polygon fill="black" stroke="black" points="15001.72,-5692.79 15011.17,-5688 15000.8,-5685.85 15001.72,-5692.79"/>
<text text-anchor="middle" x="14915.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14915.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_5 -->
<g id="edge702" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7709.04,-5802.37C7742.1,-5794.51 7776.84,-5787.57 7809.79,-5783.4 7845.73,-5778.84 12995.08,-5782.92 13026.79,-5765.4 13040.61,-5757.76 13032.87,-5744.46 13045.79,-5735.4 13083.92,-5708.64 13133.61,-5695.59 13177.12,-5689.34"/>
<polygon fill="black" stroke="black" points="13177.72,-5692.79 13187.17,-5688 13176.8,-5685.85 13177.72,-5692.79"/>
<text text-anchor="middle" x="13091.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13091.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_6 -->
<g id="edge703" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7384.54,-5802.38C7351.49,-5794.51 7316.74,-5787.57 7283.79,-5783.4 7248.9,-5778.97 2244.61,-5790.31 2219.79,-5765.4 2210.38,-5755.95 2211.09,-5745.5 2219.79,-5735.4 2250.45,-5699.81 2371.69,-5688.69 2460.92,-5685.41"/>
<polygon fill="black" stroke="black" points="2461.21,-5688.9 2471.09,-5685.06 2460.97,-5681.91 2461.21,-5688.9"/>
<text text-anchor="middle" x="2265.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2265.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer2_gate_0_2&#45;&gt;layer2_expert1_7 -->
<g id="edge704" class="edge">
<title>layer2_gate_0_2&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7709.4,-5802.34C7742.35,-5794.5 7776.96,-5787.59 7809.79,-5783.4 7856.54,-5777.43 11161.57,-5788.23 11202.79,-5765.4 11216.6,-5757.75 11208.87,-5744.46 11221.79,-5735.4 11259.92,-5708.64 11309.61,-5695.59 11353.12,-5689.34"/>
<polygon fill="black" stroke="black" points="11353.72,-5692.79 11363.17,-5688 11352.8,-5685.85 11353.72,-5692.79"/>
<text text-anchor="middle" x="11267.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11267.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_0 -->
<g id="edge705" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9488.16,-5802.55C9455.21,-5794.69 9420.6,-5787.72 9387.79,-5783.4 9350.5,-5778.48 8067.41,-5782.26 8033.79,-5765.4 8018.77,-5757.86 8023.52,-5746.37 8010.79,-5735.4 8005.77,-5731.07 8000.33,-5726.95 7994.68,-5723.05"/>
<polygon fill="black" stroke="black" points="7996.56,-5720.1 7986.29,-5717.52 7992.71,-5725.94 7996.56,-5720.1"/>
<text text-anchor="middle" x="8079.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8079.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_1 -->
<g id="edge706" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9488.54,-5802.38C9455.49,-5794.51 9420.74,-5787.57 9387.79,-5783.4 9318.87,-5774.66 4448.04,-5796.25 4385.79,-5765.4 4370.74,-5757.93 4375.52,-5746.37 4362.79,-5735.4 4357.77,-5731.07 4352.33,-5726.95 4346.68,-5723.05"/>
<polygon fill="black" stroke="black" points="4348.56,-5720.1 4338.29,-5717.52 4344.71,-5725.94 4348.56,-5720.1"/>
<text text-anchor="middle" x="4431.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4431.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→2</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_2 -->
<g id="edge707" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9810.4,-5800.76C9839.67,-5783.45 9855.33,-5761.63 9834.79,-5735.4 9821.01,-5717.79 9774.01,-5705.42 9728.38,-5697.27"/>
<polygon fill="black" stroke="black" points="9728.82,-5693.8 9718.37,-5695.55 9727.63,-5700.69 9728.82,-5693.8"/>
<text text-anchor="middle" x="9889.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9889.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→4</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_3 -->
<g id="edge708" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9488.18,-5802.35C9455.23,-5794.51 9420.62,-5787.59 9387.79,-5783.4 9344.01,-5777.8 6249.32,-5785.04 6209.79,-5765.4 6194.75,-5757.92 6199.52,-5746.37 6186.79,-5735.4 6181.77,-5731.07 6176.33,-5726.95 6170.68,-5723.05"/>
<polygon fill="black" stroke="black" points="6172.56,-5720.1 6162.29,-5717.52 6168.71,-5725.94 6172.56,-5720.1"/>
<text text-anchor="middle" x="6255.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6255.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→6</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_4 -->
<g id="edge709" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9813.04,-5802.37C9846.1,-5794.51 9880.84,-5787.57 9913.79,-5783.4 9950.95,-5778.69 15280.35,-5791.92 15306.79,-5765.4 15347.08,-5724.97 15271.29,-5704.19 15200.55,-5693.86"/>
<polygon fill="black" stroke="black" points="15201,-5690.39 15190.61,-5692.48 15200.03,-5697.33 15201,-5690.39"/>
<text text-anchor="middle" x="15363.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15363.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→8</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_5 -->
<g id="edge710" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9813.05,-5802.42C9846.1,-5794.55 9880.85,-5787.6 9913.79,-5783.4 9938.38,-5780.26 13465.31,-5782.97 13482.79,-5765.4 13523.05,-5724.94 13447.26,-5704.16 13376.53,-5693.85"/>
<polygon fill="black" stroke="black" points="13376.98,-5690.38 13366.6,-5692.46 13376.02,-5697.31 13376.98,-5690.38"/>
<text text-anchor="middle" x="13539.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13539.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→10</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_6 -->
<g id="edge711" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9488.54,-5802.35C9455.49,-5794.49 9420.74,-5787.56 9387.79,-5783.4 9341.55,-5777.55 2717.56,-5786.08 2675.79,-5765.4 2660.73,-5757.94 2665.52,-5746.37 2652.79,-5735.4 2647.77,-5731.07 2642.33,-5726.95 2636.68,-5723.05"/>
<polygon fill="black" stroke="black" points="2638.56,-5720.1 2628.29,-5717.52 2634.71,-5725.94 2638.56,-5720.1"/>
<text text-anchor="middle" x="2721.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2721.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→12</text>
</g>
<!-- layer2_gate_0_3&#45;&gt;layer2_expert1_7 -->
<g id="edge712" class="edge">
<title>layer2_gate_0_3&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9813.42,-5802.47C9846.36,-5794.62 9880.97,-5787.67 9913.79,-5783.4 9937.83,-5780.27 11641.74,-5782.62 11658.79,-5765.4 11698.94,-5724.83 11623.17,-5704.07 11552.47,-5693.79"/>
<polygon fill="black" stroke="black" points="11552.93,-5690.32 11542.54,-5692.41 11551.97,-5697.25 11552.93,-5690.32"/>
<text text-anchor="middle" x="11715.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11715.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 3→14</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_0 -->
<g id="edge713" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12644.17,-5802.43C12611.22,-5794.59 12576.61,-5787.65 12543.79,-5783.4 12488.64,-5776.25 10591.55,-5790.23 10541.79,-5765.4 10526.76,-5757.89 10533.79,-5742.97 10518.79,-5735.4 10494.29,-5723.03 9558.24,-5717.93 9530.79,-5717.4 8958.35,-5706.32 8271.59,-5691.88 8018.62,-5686.52"/>
<polygon fill="black" stroke="black" points="8018.43,-5683.01 8008.35,-5686.3 8018.28,-5690.01 8018.43,-5683.01"/>
<text text-anchor="middle" x="10587.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10587.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_1 -->
<g id="edge714" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12644.54,-5802.37C12611.49,-5794.5 12576.74,-5787.57 12543.79,-5783.4 12504.84,-5778.47 6924.16,-5784.38 6889.79,-5765.4 6875.98,-5757.76 6884.54,-5743.14 6870.79,-5735.4 6869.06,-5734.42 4848.14,-5695.5 4370.91,-5686.32"/>
<polygon fill="black" stroke="black" points="4370.67,-5682.81 4360.6,-5686.12 4370.53,-5689.81 4370.67,-5682.81"/>
<text text-anchor="middle" x="6935.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6935.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_2 -->
<g id="edge715" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12640.99,-5804.12C12608.93,-5796.34 12575.45,-5788.98 12543.79,-5783.4 12465.49,-5769.57 12438.88,-5796.7 12365.79,-5765.4 12346.96,-5757.33 12349.94,-5742.68 12330.79,-5735.4 12280.1,-5716.11 11409.01,-5718.41 11354.79,-5717.4 10736.77,-5705.79 9994.28,-5691.46 9729.01,-5686.34"/>
<polygon fill="black" stroke="black" points="9728.7,-5682.83 9718.63,-5686.13 9728.56,-5689.83 9728.7,-5682.83"/>
<text text-anchor="middle" x="12411.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12411.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_3 -->
<g id="edge716" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12644.54,-5802.41C12611.48,-5794.54 12576.74,-5787.59 12543.79,-5783.4 12491.02,-5776.68 8760.33,-5791.15 8713.79,-5765.4 8699.98,-5757.75 8708.54,-5743.14 8694.79,-5735.4 8693.06,-5734.42 6672.14,-5695.5 6194.91,-5686.32"/>
<polygon fill="black" stroke="black" points="6194.67,-5682.81 6184.6,-5686.12 6194.53,-5689.81 6194.67,-5682.81"/>
<text text-anchor="middle" x="8759.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8759.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_4 -->
<g id="edge717" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13055.53,-5848.35C13812.32,-5842.23 16038.93,-5819.64 16091.79,-5765.4 16101.1,-5755.85 16100.97,-5745.06 16091.79,-5735.4 16061.45,-5703.46 15446.83,-5690 15201.07,-5685.88"/>
<polygon fill="black" stroke="black" points="15200.77,-5682.37 15190.71,-5685.7 15200.65,-5689.37 15200.77,-5682.37"/>
<text text-anchor="middle" x="16143.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16143.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_5 -->
<g id="edge718" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13055.05,-5848.14C13795.36,-5841.51 15939.74,-5817.82 15990.79,-5765.4 16000.09,-5755.84 16000.13,-5744.91 15990.79,-5735.4 15971.56,-5715.81 15030.24,-5717.91 15002.79,-5717.4 14384.77,-5705.86 13642.28,-5691.49 13377.01,-5686.34"/>
<polygon fill="black" stroke="black" points="13376.7,-5682.84 13366.63,-5686.14 13376.56,-5689.84 13376.7,-5682.84"/>
<text text-anchor="middle" x="16042.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="16042.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_6 -->
<g id="edge719" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12644.55,-5802.35C12611.49,-5794.48 12576.74,-5787.55 12543.79,-5783.4 12492.27,-5776.89 5111.26,-5790.49 5065.79,-5765.4 5051.97,-5757.77 5060.54,-5743.15 5046.79,-5735.4 5046.79,-5735.4 3123.83,-5695.95 2660.39,-5686.44"/>
<polygon fill="black" stroke="black" points="2660.44,-5682.94 2650.37,-5686.23 2660.3,-5689.94 2660.44,-5682.94"/>
<text text-anchor="middle" x="5111.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5111.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer2_gate_1_0&#45;&gt;layer2_expert1_7 -->
<g id="edge720" class="edge">
<title>layer2_gate_1_0&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13046.63,-5843.49C13423.72,-5831.81 14116.54,-5805.07 14153.79,-5765.4 14162.92,-5755.68 14163.13,-5744.91 14153.79,-5735.4 14134.81,-5716.07 13205.87,-5717.9 13178.79,-5717.4 12560.77,-5705.78 11818.28,-5691.46 11553.01,-5686.33"/>
<polygon fill="black" stroke="black" points="11552.7,-5682.83 11542.63,-5686.13 11552.56,-5689.83 11552.7,-5682.83"/>
<text text-anchor="middle" x="14205.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14205.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_0 -->
<g id="edge721" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7905.34,-5805.06C7873.73,-5797.28 7840.84,-5789.69 7809.79,-5783.4 7783.79,-5778.13 7709.08,-5785.52 7691.79,-5765.4 7649.89,-5716.62 7740.1,-5697.21 7818.9,-5689.49"/>
<polygon fill="black" stroke="black" points="7819.31,-5692.97 7828.94,-5688.57 7818.66,-5686 7819.31,-5692.97"/>
<text text-anchor="middle" x="7737.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7737.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→0</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_1 -->
<g id="edge722" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7910.54,-5802.41C7877.48,-5794.54 7842.74,-5787.59 7809.79,-5783.4 7783.85,-5780.09 4062.24,-5783.93 4043.79,-5765.4 3998.15,-5719.53 4090.47,-5699.52 4170.74,-5690.87"/>
<polygon fill="black" stroke="black" points="4171.37,-5694.32 4180.96,-5689.82 4170.66,-5687.36 4171.37,-5694.32"/>
<text text-anchor="middle" x="4089.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4089.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→2</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_2 -->
<g id="edge723" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8235.43,-5802.6C8268.38,-5794.75 8302.99,-5787.75 8335.79,-5783.4 8399.52,-5774.93 9436.71,-5796.83 9492.79,-5765.4 9506.56,-5757.68 9499.81,-5745.67 9511.79,-5735.4 9517.46,-5730.54 9523.66,-5726.07 9530.16,-5721.99"/>
<polygon fill="black" stroke="black" points="9532.36,-5724.75 9539.18,-5716.65 9528.79,-5718.73 9532.36,-5724.75"/>
<text text-anchor="middle" x="9557.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9557.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→4</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_3 -->
<g id="edge724" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7910.17,-5802.44C7877.22,-5794.6 7842.61,-5787.65 7809.79,-5783.4 7783.04,-5779.93 5886.78,-5784.56 5867.79,-5765.4 5822.25,-5719.43 5914.55,-5699.44 5994.79,-5690.82"/>
<polygon fill="black" stroke="black" points="5995.41,-5694.27 6005.01,-5689.77 5994.7,-5687.31 5995.41,-5694.27"/>
<text text-anchor="middle" x="5913.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5913.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→6</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_4 -->
<g id="edge725" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8235.04,-5802.35C8268.09,-5794.49 8302.84,-5787.56 8335.79,-5783.4 8381.46,-5777.63 14924.49,-5787.65 14964.79,-5765.4 14978.61,-5757.77 14971.81,-5745.67 14983.79,-5735.4 14989.46,-5730.54 14995.66,-5726.07 15002.16,-5721.99"/>
<polygon fill="black" stroke="black" points="15004.36,-5724.75 15011.18,-5716.65 15000.79,-5718.73 15004.36,-5724.75"/>
<text text-anchor="middle" x="15029.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15029.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→8</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_5 -->
<g id="edge726" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8235.04,-5802.38C8268.1,-5794.52 8302.84,-5787.58 8335.79,-5783.4 8368.89,-5779.2 13111.59,-5781.54 13140.79,-5765.4 13154.6,-5757.76 13147.81,-5745.67 13159.79,-5735.4 13165.46,-5730.54 13171.66,-5726.07 13178.16,-5721.99"/>
<polygon fill="black" stroke="black" points="13180.36,-5724.75 13187.18,-5716.65 13176.79,-5718.73 13180.36,-5724.75"/>
<text text-anchor="middle" x="13205.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13205.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→10</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_6 -->
<g id="edge727" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7910.54,-5802.37C7877.49,-5794.51 7842.74,-5787.57 7809.79,-5783.4 7772.06,-5778.62 2360.64,-5792.33 2333.79,-5765.4 2288.11,-5719.57 2380.44,-5699.55 2460.72,-5690.88"/>
<polygon fill="black" stroke="black" points="2461.36,-5694.33 2470.95,-5689.83 2460.64,-5687.37 2461.36,-5694.33"/>
<text text-anchor="middle" x="2379.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2379.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→12</text>
</g>
<!-- layer2_gate_1_1&#45;&gt;layer2_expert1_7 -->
<g id="edge728" class="edge">
<title>layer2_gate_1_1&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8235.4,-5802.36C8268.35,-5794.52 8302.97,-5787.6 8335.79,-5783.4 8376.86,-5778.14 11280.58,-5785.47 11316.79,-5765.4 11330.6,-5757.74 11323.81,-5745.67 11335.79,-5735.4 11341.46,-5730.54 11347.66,-5726.07 11354.16,-5721.99"/>
<polygon fill="black" stroke="black" points="11356.36,-5724.75 11363.18,-5716.65 11352.79,-5718.73 11356.36,-5724.75"/>
<text text-anchor="middle" x="11381.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11381.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 5→14</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_0 -->
<g id="edge729" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6131.79,-5802.59C6164.64,-5794.77 6199.11,-5787.78 6231.79,-5783.4 6285.82,-5776.14 7165.28,-5792.11 7212.79,-5765.4 7226.55,-5757.66 7218.26,-5743.51 7231.79,-5735.4 7280.87,-5705.96 7640.62,-5692.03 7819.03,-5686.88"/>
<polygon fill="black" stroke="black" points="7819.32,-5690.37 7829.21,-5686.59 7819.12,-5683.37 7819.32,-5690.37"/>
<text text-anchor="middle" x="7277.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7277.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_1 -->
<g id="edge730" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5806.17,-5802.42C5773.22,-5794.58 5738.61,-5787.64 5705.79,-5783.4 5676.62,-5779.62 3608.5,-5786.29 3587.79,-5765.4 3578.4,-5755.93 3578.72,-5745.17 3587.79,-5735.4 3626.59,-5693.59 3990.91,-5685.8 4170.99,-5684.52"/>
<polygon fill="black" stroke="black" points="4171.03,-5688.02 4181.01,-5684.46 4170.98,-5681.02 4171.03,-5688.02"/>
<text text-anchor="middle" x="3633.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3633.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_2 -->
<g id="edge731" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6131.4,-5802.37C6164.35,-5794.53 6198.97,-5787.6 6231.79,-5783.4 6270.43,-5778.44 9002.72,-5784.29 9036.79,-5765.4 9050.59,-5757.74 9042.32,-5743.61 9055.79,-5735.4 9095.13,-5711.41 9375.42,-5695.51 9528.9,-5688.5"/>
<polygon fill="black" stroke="black" points="9529.44,-5691.97 9539.27,-5688.03 9529.12,-5684.98 9529.44,-5691.97"/>
<text text-anchor="middle" x="9101.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9101.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_3 -->
<g id="edge732" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5804.57,-5803.44C5772.06,-5795.62 5738.02,-5788.43 5705.79,-5783.4 5673.46,-5778.35 5434.22,-5789.23 5411.79,-5765.4 5402.66,-5755.68 5402.72,-5745.17 5411.79,-5735.4 5450.59,-5693.59 5814.91,-5685.8 5994.99,-5684.52"/>
<polygon fill="black" stroke="black" points="5995.03,-5688.02 6005.01,-5684.46 5994.98,-5681.02 5995.03,-5688.02"/>
<text text-anchor="middle" x="5457.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5457.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_4 -->
<g id="edge733" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6131.04,-5802.34C6164.09,-5794.48 6198.84,-5787.55 6231.79,-5783.4 6288.82,-5776.21 14458.46,-5793.16 14508.79,-5765.4 14522.61,-5757.77 14514.32,-5743.61 14527.79,-5735.4 14567.13,-5711.41 14847.42,-5695.51 15000.9,-5688.5"/>
<polygon fill="black" stroke="black" points="15001.44,-5691.97 15011.27,-5688.03 15001.12,-5684.98 15001.44,-5691.97"/>
<text text-anchor="middle" x="14573.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14573.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_5 -->
<g id="edge734" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6131.04,-5802.36C6164.09,-5794.49 6198.84,-5787.56 6231.79,-5783.4 6276.25,-5777.78 12645.56,-5787.06 12684.79,-5765.4 12698.61,-5757.77 12690.32,-5743.61 12703.79,-5735.4 12743.13,-5711.41 13023.42,-5695.51 13176.9,-5688.5"/>
<polygon fill="black" stroke="black" points="13177.44,-5691.97 13187.27,-5688.03 13177.12,-5684.98 13177.44,-5691.97"/>
<text text-anchor="middle" x="12749.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12749.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_6 -->
<g id="edge735" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5806.54,-5802.41C5773.48,-5794.54 5738.74,-5787.59 5705.79,-5783.4 5679.42,-5780.04 1896.54,-5784.24 1877.79,-5765.4 1868.39,-5755.95 1868.72,-5745.17 1877.79,-5735.4 1916.59,-5693.59 2280.91,-5685.8 2460.99,-5684.52"/>
<polygon fill="black" stroke="black" points="2461.03,-5688.02 2471.01,-5684.46 2460.98,-5681.02 2461.03,-5688.02"/>
<text text-anchor="middle" x="1923.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1923.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer2_gate_1_2&#45;&gt;layer2_expert1_7 -->
<g id="edge736" class="edge">
<title>layer2_gate_1_2&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6131.04,-5802.39C6164.1,-5794.52 6198.84,-5787.58 6231.79,-5783.4 6295.57,-5775.3 10804.53,-5796.5 10860.79,-5765.4 10874.6,-5757.76 10866.32,-5743.61 10879.79,-5735.4 10919.13,-5711.41 11199.42,-5695.51 11352.9,-5688.5"/>
<polygon fill="black" stroke="black" points="11353.44,-5691.97 11363.27,-5688.03 11353.12,-5684.98 11353.44,-5691.97"/>
<text text-anchor="middle" x="10925.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10925.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_0 -->
<g id="edge737" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11066.18,-5802.38C11033.23,-5794.54 10998.62,-5787.61 10965.79,-5783.4 10894.43,-5774.23 8440.2,-5797.45 8375.79,-5765.4 8360.75,-5757.91 8367.4,-5743.7 8352.79,-5735.4 8297.55,-5704 8128.76,-5691.85 8018.69,-5687.21"/>
<polygon fill="black" stroke="black" points="8018.69,-5683.71 8008.56,-5686.79 8018.4,-5690.7 8018.69,-5683.71"/>
<text text-anchor="middle" x="8421.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8421.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→0</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_1 -->
<g id="edge738" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11066.54,-5802.36C11033.49,-5794.5 10998.74,-5787.56 10965.79,-5783.4 10922.81,-5777.96 4766.61,-5784.62 4727.79,-5765.4 4712.74,-5757.94 4719.4,-5743.7 4704.79,-5735.4 4649.55,-5704 4480.76,-5691.85 4370.69,-5687.21"/>
<polygon fill="black" stroke="black" points="4370.69,-5683.71 4360.56,-5686.79 4370.4,-5690.7 4370.69,-5683.71"/>
<text text-anchor="middle" x="4773.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4773.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→2</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_2 -->
<g id="edge739" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11065.77,-5802.73C11032.93,-5794.89 10998.46,-5787.87 10965.79,-5783.4 10923.62,-5777.62 10237.74,-5784.68 10199.79,-5765.4 10184.81,-5757.79 10191.5,-5743.52 10176.79,-5735.4 10102.13,-5694.15 9865.09,-5685.63 9728.46,-5684.25"/>
<polygon fill="black" stroke="black" points="9728.42,-5680.75 9718.39,-5684.16 9728.36,-5687.75 9728.42,-5680.75"/>
<text text-anchor="middle" x="10245.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10245.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→4</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_3 -->
<g id="edge740" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11066.54,-5802.39C11033.48,-5794.52 10998.74,-5787.58 10965.79,-5783.4 10904.97,-5775.67 6606.71,-5792.63 6551.79,-5765.4 6536.74,-5757.93 6543.4,-5743.7 6528.79,-5735.4 6473.55,-5704 6304.76,-5691.85 6194.69,-5687.21"/>
<polygon fill="black" stroke="black" points="6194.69,-5683.71 6184.56,-5686.79 6194.4,-5690.7 6194.69,-5683.71"/>
<text text-anchor="middle" x="6597.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6597.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→6</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_4 -->
<g id="edge741" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11391.04,-5802.4C11424.1,-5794.53 11458.85,-5787.58 11491.79,-5783.4 11520.43,-5779.75 15628.42,-5785.85 15648.79,-5765.4 15658.2,-5755.95 15657.77,-5745.25 15648.79,-5735.4 15619.26,-5702.99 15350.41,-5690.84 15200.57,-5686.55"/>
<polygon fill="black" stroke="black" points="15200.53,-5683.05 15190.43,-5686.27 15200.33,-5690.05 15200.53,-5683.05"/>
<text text-anchor="middle" x="15700.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15700.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→8</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_5 -->
<g id="edge742" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11391.41,-5802.4C11424.36,-5794.56 11458.97,-5787.63 11491.79,-5783.4 11523.93,-5779.25 13801.97,-5788.4 13824.79,-5765.4 13834.18,-5755.93 13833.77,-5745.25 13824.79,-5735.4 13795.26,-5702.99 13526.41,-5690.84 13376.57,-5686.55"/>
<polygon fill="black" stroke="black" points="13376.53,-5683.05 13366.43,-5686.27 13376.33,-5690.05 13376.53,-5683.05"/>
<text text-anchor="middle" x="13876.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13876.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→10</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_6 -->
<g id="edge743" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11066.55,-5802.34C11033.49,-5794.48 10998.74,-5787.55 10965.79,-5783.4 10911.03,-5776.49 3067.26,-5789.87 3017.79,-5765.4 3002.73,-5757.94 3009.4,-5743.7 2994.79,-5735.4 2939.55,-5704 2770.76,-5691.85 2660.69,-5687.21"/>
<polygon fill="black" stroke="black" points="2660.69,-5683.71 2650.56,-5686.79 2660.4,-5690.7 2660.69,-5683.71"/>
<text text-anchor="middle" x="3063.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3063.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→12</text>
</g>
<!-- layer2_gate_1_3&#45;&gt;layer2_expert1_7 -->
<g id="edge744" class="edge">
<title>layer2_gate_1_3&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11392.21,-5802.95C11424.94,-5795.12 11459.26,-5788.05 11491.79,-5783.4 11519.8,-5779.39 11981.14,-5785.75 12000.79,-5765.4 12010.05,-5755.8 12009.77,-5745.25 12000.79,-5735.4 11971.26,-5702.99 11702.41,-5690.84 11552.57,-5686.55"/>
<polygon fill="black" stroke="black" points="11552.53,-5683.05 11542.43,-5686.27 11552.33,-5690.05 11552.53,-5683.05"/>
<text text-anchor="middle" x="12052.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12052.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 7→14</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_0 -->
<g id="edge745" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10014.17,-5802.46C9981.22,-5794.62 9946.61,-5787.67 9913.79,-5783.4 9865.14,-5777.06 8191.67,-5787.33 8147.79,-5765.4 8132.76,-5757.88 8138.85,-5744.6 8124.79,-5735.4 8093.31,-5714.78 8054.15,-5702.5 8018.46,-5695.18"/>
<polygon fill="black" stroke="black" points="8018.97,-5691.71 8008.49,-5693.24 8017.64,-5698.59 8018.97,-5691.71"/>
<text text-anchor="middle" x="8193.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8193.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_1 -->
<g id="edge746" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10014.54,-5802.37C9981.49,-5794.51 9946.74,-5787.57 9913.79,-5783.4 9876.49,-5778.67 4533.48,-5782.09 4499.79,-5765.4 4484.74,-5757.94 4490.85,-5744.6 4476.79,-5735.4 4445.31,-5714.78 4406.15,-5702.5 4370.46,-5695.18"/>
<polygon fill="black" stroke="black" points="4370.97,-5691.71 4360.49,-5693.24 4369.64,-5698.59 4370.97,-5691.71"/>
<text text-anchor="middle" x="4545.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4545.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_2 -->
<g id="edge747" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10027.31,-5795.53C10008.1,-5786.45 9989.11,-5776.38 9971.79,-5765.4 9955.05,-5754.78 9956.64,-5744.02 9938.79,-5735.4 9873.21,-5703.68 9791.67,-5691.18 9728.69,-5686.47"/>
<polygon fill="black" stroke="black" points="9728.56,-5682.95 9718.35,-5685.75 9728.08,-5689.94 9728.56,-5682.95"/>
<text text-anchor="middle" x="10017.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10017.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_3 -->
<g id="edge748" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10014.54,-5802.41C9981.48,-5794.55 9946.74,-5787.6 9913.79,-5783.4 9864.33,-5777.09 6368.45,-5787.57 6323.79,-5765.4 6308.74,-5757.92 6314.85,-5744.6 6300.79,-5735.4 6269.31,-5714.78 6230.15,-5702.5 6194.46,-5695.18"/>
<polygon fill="black" stroke="black" points="6194.97,-5691.71 6184.49,-5693.24 6193.64,-5698.59 6194.97,-5691.71"/>
<text text-anchor="middle" x="6369.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6369.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_4 -->
<g id="edge749" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10339.04,-5802.38C10372.1,-5794.51 10406.84,-5787.57 10439.79,-5783.4 10474.11,-5779.04 15396.38,-5789.9 15420.79,-5765.4 15430.2,-5755.95 15429.45,-5745.54 15420.79,-5735.4 15392.81,-5702.6 15283.63,-5690.79 15200.51,-5686.6"/>
<polygon fill="black" stroke="black" points="15200.66,-5683.1 15190.51,-5686.12 15200.33,-5690.09 15200.66,-5683.1"/>
<text text-anchor="middle" x="15472.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15472.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_5 -->
<g id="edge750" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10339.4,-5802.35C10372.35,-5794.51 10406.97,-5787.59 10439.79,-5783.4 10461.54,-5780.62 13581.33,-5780.94 13596.79,-5765.4 13606.19,-5755.94 13605.45,-5745.54 13596.79,-5735.4 13568.81,-5702.6 13459.63,-5690.79 13376.51,-5686.6"/>
<polygon fill="black" stroke="black" points="13376.66,-5683.1 13366.51,-5686.12 13376.33,-5690.09 13376.66,-5683.1"/>
<text text-anchor="middle" x="13648.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13648.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_6 -->
<g id="edge751" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10014.54,-5802.35C9981.49,-5794.49 9946.74,-5787.56 9913.79,-5783.4 9864.71,-5777.2 2834.13,-5787.34 2789.79,-5765.4 2774.73,-5757.94 2780.85,-5744.6 2766.79,-5735.4 2735.31,-5714.78 2696.15,-5702.5 2660.46,-5695.18"/>
<polygon fill="black" stroke="black" points="2660.97,-5691.71 2650.49,-5693.24 2659.64,-5698.59 2660.97,-5691.71"/>
<text text-anchor="middle" x="2835.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2835.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer2_gate_2_0&#45;&gt;layer2_expert1_7 -->
<g id="edge752" class="edge">
<title>layer2_gate_2_0&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10339.43,-5802.55C10372.37,-5794.7 10406.98,-5787.72 10439.79,-5783.4 10476.5,-5778.56 11746.78,-5791.76 11772.79,-5765.4 11782.16,-5755.9 11781.45,-5745.54 11772.79,-5735.4 11744.81,-5702.6 11635.63,-5690.79 11552.51,-5686.6"/>
<polygon fill="black" stroke="black" points="11552.66,-5683.1 11542.51,-5686.12 11552.33,-5690.09 11552.66,-5683.1"/>
<text text-anchor="middle" x="11824.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11824.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_0 -->
<g id="edge753" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6658.19,-5802.85C6690.93,-5795.03 6725.26,-5787.98 6757.79,-5783.4 6820.43,-5774.56 7271.86,-5796.77 7326.79,-5765.4 7340.5,-5757.57 7332.32,-5743.61 7345.79,-5735.4 7385.13,-5711.41 7665.42,-5695.51 7818.9,-5688.5"/>
<polygon fill="black" stroke="black" points="7819.44,-5691.97 7829.27,-5688.03 7819.12,-5684.98 7819.44,-5691.97"/>
<text text-anchor="middle" x="7391.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7391.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→0</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_1 -->
<g id="edge754" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6332.18,-5802.39C6299.23,-5794.55 6264.61,-5787.62 6231.79,-5783.4 6196.94,-5778.91 3726.55,-5790.33 3701.79,-5765.4 3634.09,-5697.21 3990.36,-5685.77 4170.95,-5684.29"/>
<polygon fill="black" stroke="black" points="4171.02,-5687.79 4181,-5684.22 4170.97,-5680.79 4171.02,-5687.79"/>
<text text-anchor="middle" x="3747.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3747.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→2</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_2 -->
<g id="edge755" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.41,-5802.4C6690.36,-5794.56 6724.97,-5787.62 6757.79,-5783.4 6823.72,-5774.91 9092.68,-5797.67 9150.79,-5765.4 9164.59,-5757.73 9156.41,-5743.76 9169.79,-5735.4 9227.77,-5699.17 9412.18,-5688.58 9528.85,-5685.54"/>
<polygon fill="black" stroke="black" points="9528.97,-5689.04 9538.88,-5685.29 9528.79,-5682.04 9528.97,-5689.04"/>
<text text-anchor="middle" x="9215.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9215.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→4</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_3 -->
<g id="edge756" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6331.76,-5802.78C6298.92,-5794.93 6264.46,-5787.9 6231.79,-5783.4 6192.92,-5778.03 5553.18,-5793.49 5525.79,-5765.4 5458.71,-5696.59 5814.67,-5685.47 5995.06,-5684.18"/>
<polygon fill="black" stroke="black" points="5995.12,-5687.68 6005.1,-5684.12 5995.08,-5680.68 5995.12,-5687.68"/>
<text text-anchor="middle" x="5571.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5571.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→6</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_4 -->
<g id="edge757" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.04,-5802.34C6690.09,-5794.48 6724.84,-5787.55 6757.79,-5783.4 6811.98,-5776.56 14574.97,-5791.78 14622.79,-5765.4 14636.61,-5757.77 14628.41,-5743.76 14641.79,-5735.4 14699.77,-5699.17 14884.18,-5688.58 15000.85,-5685.54"/>
<polygon fill="black" stroke="black" points="15000.97,-5689.04 15010.88,-5685.29 15000.79,-5682.04 15000.97,-5689.04"/>
<text text-anchor="middle" x="14687.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14687.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→8</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_5 -->
<g id="edge758" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.04,-5802.36C6690.1,-5794.5 6724.84,-5787.56 6757.79,-5783.4 6799.41,-5778.13 12762.07,-5785.68 12798.79,-5765.4 12812.61,-5757.77 12804.41,-5743.76 12817.79,-5735.4 12875.77,-5699.17 13060.18,-5688.58 13176.85,-5685.54"/>
<polygon fill="black" stroke="black" points="13176.97,-5689.04 13186.88,-5685.29 13176.79,-5682.04 13176.97,-5689.04"/>
<text text-anchor="middle" x="12863.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12863.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→10</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_6 -->
<g id="edge759" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6332.54,-5802.39C6299.48,-5794.53 6264.74,-5787.58 6231.79,-5783.4 6202.58,-5779.68 2012.57,-5786.26 1991.79,-5765.4 1923.99,-5697.3 2280.31,-5685.82 2460.93,-5684.31"/>
<polygon fill="black" stroke="black" points="2461.01,-5687.81 2470.98,-5684.23 2460.96,-5680.81 2461.01,-5687.81"/>
<text text-anchor="middle" x="2037.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2037.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→12</text>
</g>
<!-- layer2_gate_2_1&#45;&gt;layer2_expert1_7 -->
<g id="edge760" class="edge">
<title>layer2_gate_2_1&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6657.04,-5802.4C6690.1,-5794.53 6724.85,-5787.58 6757.79,-5783.4 6815.89,-5776.01 10923.54,-5793.74 10974.79,-5765.4 10988.6,-5757.76 10980.41,-5743.76 10993.79,-5735.4 11051.77,-5699.17 11236.18,-5688.58 11352.85,-5685.54"/>
<polygon fill="black" stroke="black" points="11352.97,-5689.04 11362.88,-5685.29 11352.79,-5682.04 11352.97,-5689.04"/>
<text text-anchor="middle" x="11039.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11039.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 9→14</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_0 -->
<g id="edge761" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7187,-5804.38C7218.96,-5796.59 7252.28,-5789.17 7283.79,-5783.4 7352.87,-5770.73 7378.08,-5797.02 7440.79,-5765.4 7457.08,-5757.18 7452.5,-5743.6 7468.79,-5735.4 7528.19,-5705.5 7705.54,-5692.84 7819.05,-5687.7"/>
<polygon fill="black" stroke="black" points="7819.32,-5691.19 7829.15,-5687.25 7819.01,-5684.2 7819.32,-5691.19"/>
<text text-anchor="middle" x="7514.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7514.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_1 -->
<g id="edge762" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6858.18,-5802.36C6825.23,-5794.52 6790.62,-5787.6 6757.79,-5783.4 6717.26,-5778.21 3844.6,-5794.38 3815.79,-5765.4 3806.39,-5755.94 3806.9,-5745.33 3815.79,-5735.4 3839.04,-5709.4 4044.24,-5695.08 4171,-5688.64"/>
<polygon fill="black" stroke="black" points="4171.31,-5692.13 4181.12,-5688.14 4170.96,-5685.14 4171.31,-5692.13"/>
<text text-anchor="middle" x="3861.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3861.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_2 -->
<g id="edge763" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7183.41,-5802.44C7216.36,-5794.59 7250.97,-5787.65 7283.79,-5783.4 7338.37,-5776.32 9216.7,-5792.15 9264.79,-5765.4 9278.58,-5757.72 9270.56,-5744 9283.79,-5735.4 9323.22,-5709.76 9441.84,-5696.46 9529.02,-5689.96"/>
<polygon fill="black" stroke="black" points="9529.5,-5693.43 9539.22,-5689.22 9528.99,-5686.45 9529.5,-5693.43"/>
<text text-anchor="middle" x="9329.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9329.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_3 -->
<g id="edge764" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6858.15,-5802.62C6825.2,-5794.76 6790.6,-5787.76 6757.79,-5783.4 6727,-5779.3 5661.58,-5787.53 5639.79,-5765.4 5630.44,-5755.89 5630.9,-5745.33 5639.79,-5735.4 5663.04,-5709.4 5868.24,-5695.08 5995,-5688.64"/>
<polygon fill="black" stroke="black" points="5995.31,-5692.13 6005.12,-5688.14 5994.96,-5685.14 5995.31,-5692.13"/>
<text text-anchor="middle" x="5685.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5685.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_4 -->
<g id="edge765" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7183.04,-5802.35C7216.09,-5794.48 7250.84,-5787.55 7283.79,-5783.4 7335.14,-5776.92 14691.48,-5790.41 14736.79,-5765.4 14750.61,-5757.77 14742.56,-5744 14755.79,-5735.4 14795.22,-5709.76 14913.84,-5696.46 15001.02,-5689.96"/>
<polygon fill="black" stroke="black" points="15001.5,-5693.43 15011.22,-5689.22 15000.99,-5686.45 15001.5,-5693.43"/>
<text text-anchor="middle" x="14801.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14801.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_5 -->
<g id="edge766" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7183.04,-5802.37C7216.1,-5794.5 7250.84,-5787.57 7283.79,-5783.4 7322.57,-5778.49 12878.57,-5784.3 12912.79,-5765.4 12926.61,-5757.76 12918.56,-5744 12931.79,-5735.4 12971.22,-5709.76 13089.84,-5696.46 13177.02,-5689.96"/>
<polygon fill="black" stroke="black" points="13177.5,-5693.43 13187.22,-5689.22 13176.99,-5686.45 13177.5,-5693.43"/>
<text text-anchor="middle" x="12977.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12977.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_6 -->
<g id="edge767" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6858.54,-5802.38C6825.48,-5794.52 6790.74,-5787.58 6757.79,-5783.4 6725.74,-5779.33 2128.59,-5788.28 2105.79,-5765.4 2096.38,-5755.95 2096.9,-5745.33 2105.79,-5735.4 2129.04,-5709.4 2334.24,-5695.08 2461,-5688.64"/>
<polygon fill="black" stroke="black" points="2461.31,-5692.13 2471.12,-5688.14 2460.96,-5685.14 2461.31,-5692.13"/>
<text text-anchor="middle" x="2151.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2151.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer2_gate_2_2&#45;&gt;layer2_expert1_7 -->
<g id="edge768" class="edge">
<title>layer2_gate_2_2&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7183.04,-5802.41C7216.1,-5794.54 7250.85,-5787.59 7283.79,-5783.4 7336.22,-5776.72 11042.55,-5790.99 11088.79,-5765.4 11102.6,-5757.75 11094.56,-5744 11107.79,-5735.4 11147.22,-5709.76 11265.84,-5696.46 11353.02,-5689.96"/>
<polygon fill="black" stroke="black" points="11353.5,-5693.43 11363.22,-5689.22 11352.99,-5686.45 11353.5,-5693.43"/>
<text text-anchor="middle" x="11153.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11153.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_0 -->
<g id="edge769" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.54,-5802.42C12085.48,-5794.55 12050.74,-5787.6 12017.79,-5783.4 11970.76,-5777.39 8646.26,-5786.49 8603.79,-5765.4 8588.74,-5757.92 8595.56,-5743.4 8580.79,-5735.4 8532.67,-5709.3 8191.44,-5693.85 8018.6,-5687.62"/>
<polygon fill="black" stroke="black" points="8018.6,-5684.11 8008.48,-5687.26 8018.35,-5691.11 8018.6,-5684.11"/>
<text text-anchor="middle" x="8649.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8649.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→0</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_1 -->
<g id="edge770" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.54,-5802.35C12085.49,-5794.49 12050.74,-5787.56 12017.79,-5783.4 11969.14,-5777.25 4999.74,-5787.15 4955.79,-5765.4 4940.73,-5757.94 4947.56,-5743.4 4932.79,-5735.4 4884.67,-5709.3 4543.44,-5693.85 4370.6,-5687.62"/>
<polygon fill="black" stroke="black" points="4370.6,-5684.11 4360.48,-5687.26 4370.35,-5691.11 4370.6,-5684.11"/>
<text text-anchor="middle" x="5001.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5001.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→2</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_2 -->
<g id="edge771" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.16,-5802.49C12085.22,-5794.65 12050.61,-5787.68 12017.79,-5783.4 11973.99,-5777.67 10467.29,-5785.16 10427.79,-5765.4 10412.77,-5757.88 10419.61,-5743.32 10404.79,-5735.4 10346.61,-5704.28 9924.83,-5690.95 9728.65,-5686.38"/>
<polygon fill="black" stroke="black" points="9728.7,-5682.88 9718.62,-5686.15 9728.54,-5689.88 9728.7,-5682.88"/>
<text text-anchor="middle" x="10473.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10473.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→4</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_3 -->
<g id="edge772" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.54,-5802.37C12085.49,-5794.51 12050.74,-5787.57 12017.79,-5783.4 11945.62,-5774.25 6844.98,-5797.7 6779.79,-5765.4 6764.74,-5757.94 6771.56,-5743.4 6756.79,-5735.4 6708.67,-5709.3 6367.44,-5693.85 6194.6,-5687.62"/>
<polygon fill="black" stroke="black" points="6194.6,-5684.11 6184.48,-5687.26 6194.35,-5691.11 6194.6,-5684.11"/>
<text text-anchor="middle" x="6825.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6825.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→6</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_4 -->
<g id="edge773" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12443.4,-5802.34C12476.35,-5794.51 12510.96,-5787.59 12543.79,-5783.4 12566.75,-5780.46 15860.47,-5781.81 15876.79,-5765.4 15886.19,-5755.94 15885.91,-5745.13 15876.79,-5735.4 15831.52,-5687.05 15399.78,-5682.86 15200.59,-5683.53"/>
<polygon fill="black" stroke="black" points="15200.4,-5680.03 15190.41,-5683.57 15200.43,-5687.03 15200.4,-5680.03"/>
<text text-anchor="middle" x="15928.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15928.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→8</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_5 -->
<g id="edge774" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12443.42,-5802.51C12476.37,-5794.66 12510.98,-5787.69 12543.79,-5783.4 12564.57,-5780.67 14038.06,-5780.3 14052.79,-5765.4 14062.16,-5755.91 14061.91,-5745.13 14052.79,-5735.4 14007.52,-5687.05 13575.78,-5682.86 13376.59,-5683.53"/>
<polygon fill="black" stroke="black" points="13376.4,-5680.03 13366.41,-5683.57 13376.43,-5687.03 13376.4,-5680.03"/>
<text text-anchor="middle" x="14104.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14104.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→10</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_6 -->
<g id="edge775" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.55,-5802.34C12085.49,-5794.48 12050.74,-5787.55 12017.79,-5783.4 11957.44,-5775.79 3315.96,-5786.16 3258.79,-5765.4 3239.22,-5758.29 3242.09,-5743.23 3222.79,-5735.4 3123.64,-5695.12 2820.08,-5686.44 2660.77,-5684.71"/>
<polygon fill="black" stroke="black" points="2660.53,-5681.21 2650.49,-5684.61 2660.46,-5688.21 2660.53,-5681.21"/>
<text text-anchor="middle" x="3304.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3304.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→12</text>
</g>
<!-- layer2_gate_2_3&#45;&gt;layer2_expert1_7 -->
<g id="edge776" class="edge">
<title>layer2_gate_2_3&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12249.83,-5783.39C12237.83,-5764.74 12222.22,-5746.55 12202.79,-5735.4 12147.78,-5703.83 11743.84,-5690.8 11552.62,-5686.35"/>
<polygon fill="black" stroke="black" points="11552.64,-5682.85 11542.57,-5686.12 11552.48,-5689.85 11552.64,-5682.85"/>
<text text-anchor="middle" x="12281.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12281.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 11→14</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_0 -->
<g id="edge777" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11592.18,-5802.36C11559.23,-5794.52 11524.62,-5787.6 11491.79,-5783.4 11450.43,-5778.1 8527.13,-5783.96 8489.79,-5765.4 8474.75,-5757.92 8481.5,-5743.52 8466.79,-5735.4 8392.13,-5694.15 8155.09,-5685.63 8018.46,-5684.25"/>
<polygon fill="black" stroke="black" points="8018.42,-5680.75 8008.39,-5684.16 8018.36,-5687.75 8018.42,-5680.75"/>
<text text-anchor="middle" x="8535.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8535.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_1 -->
<g id="edge778" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11592.54,-5802.35C11559.49,-5794.49 11524.74,-5787.56 11491.79,-5783.4 11445.97,-5777.61 4883.18,-5785.89 4841.79,-5765.4 4826.73,-5757.94 4833.5,-5743.52 4818.79,-5735.4 4744.13,-5694.15 4507.09,-5685.63 4370.46,-5684.25"/>
<polygon fill="black" stroke="black" points="4370.42,-5680.75 4360.39,-5684.16 4370.36,-5687.75 4370.42,-5680.75"/>
<text text-anchor="middle" x="4887.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4887.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_2 -->
<g id="edge779" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11592.15,-5802.6C11559.2,-5794.74 11524.6,-5787.75 11491.79,-5783.4 11426.91,-5774.78 10372.26,-5794.8 10313.79,-5765.4 10298.78,-5757.85 10305.56,-5743.4 10290.79,-5735.4 10242.67,-5709.3 9901.44,-5693.85 9728.6,-5687.62"/>
<polygon fill="black" stroke="black" points="9728.6,-5684.11 9718.48,-5687.26 9728.35,-5691.11 9728.6,-5684.11"/>
<text text-anchor="middle" x="10359.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10359.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_3 -->
<g id="edge780" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11592.54,-5802.38C11559.49,-5794.52 11524.74,-5787.57 11491.79,-5783.4 11425.3,-5774.96 6725.85,-5795.17 6665.79,-5765.4 6650.74,-5757.93 6657.5,-5743.52 6642.79,-5735.4 6568.13,-5694.15 6331.09,-5685.63 6194.46,-5684.25"/>
<polygon fill="black" stroke="black" points="6194.42,-5680.75 6184.39,-5684.16 6194.36,-5687.75 6194.42,-5680.75"/>
<text text-anchor="middle" x="6711.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6711.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_4 -->
<g id="edge781" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11917.05,-5802.41C11950.1,-5794.54 11984.85,-5787.59 12017.79,-5783.4 12043.59,-5780.11 15744.45,-5783.83 15762.79,-5765.4 15772.2,-5755.94 15771.85,-5745.18 15762.79,-5735.4 15725.44,-5695.05 15376.04,-5686.51 15200.48,-5684.78"/>
<polygon fill="black" stroke="black" points="15200.49,-5681.28 15190.46,-5684.69 15200.43,-5688.28 15200.49,-5681.28"/>
<text text-anchor="middle" x="15814.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15814.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_5 -->
<g id="edge782" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11917.41,-5802.44C11950.36,-5794.6 11984.97,-5787.65 12017.79,-5783.4 12044.25,-5779.96 13920.01,-5784.35 13938.79,-5765.4 13948.18,-5755.92 13947.85,-5745.18 13938.79,-5735.4 13901.44,-5695.05 13552.04,-5686.51 13376.48,-5684.78"/>
<polygon fill="black" stroke="black" points="13376.49,-5681.28 13366.46,-5684.69 13376.43,-5688.28 13376.49,-5681.28"/>
<text text-anchor="middle" x="13990.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13990.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_6 -->
<g id="edge783" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11592.55,-5802.34C11559.49,-5794.48 11524.74,-5787.55 11491.79,-5783.4 11434.19,-5776.14 3183.83,-5791.14 3131.79,-5765.4 3116.73,-5757.95 3123.5,-5743.52 3108.79,-5735.4 3034.13,-5694.15 2797.09,-5685.63 2660.46,-5684.25"/>
<polygon fill="black" stroke="black" points="2660.42,-5680.75 2650.39,-5684.16 2660.36,-5687.75 2660.42,-5680.75"/>
<text text-anchor="middle" x="3177.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3177.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer2_gate_3_0&#45;&gt;layer2_expert1_7 -->
<g id="edge784" class="edge">
<title>layer2_gate_3_0&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11924.33,-5806.13C11955.37,-5798.35 11987.52,-5790.48 12017.79,-5783.4 12054.97,-5774.7 12077.79,-5795.09 12101.79,-5765.4 12110.17,-5755.03 12110.84,-5745.19 12101.79,-5735.4 12065.33,-5695.96 11725.19,-5686.97 11552.45,-5684.95"/>
<polygon fill="black" stroke="black" points="11552.37,-5681.45 11542.33,-5684.84 11552.29,-5688.45 11552.37,-5681.45"/>
<text text-anchor="middle" x="12153.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12153.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_0 -->
<g id="edge785" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8961.79,-5802.61C8928.94,-5794.78 8894.47,-5787.8 8861.79,-5783.4 8835.85,-5779.9 7938.23,-5783.96 7919.79,-5765.4 7910.16,-5755.7 7907.69,-5741.68 7908.35,-5728.03"/>
<polygon fill="black" stroke="black" points="7911.87,-5728.04 7909.39,-5717.74 7904.9,-5727.33 7911.87,-5728.04"/>
<text text-anchor="middle" x="7965.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7965.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→0</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_1 -->
<g id="edge786" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8962.54,-5802.39C8929.48,-5794.52 8894.74,-5787.58 8861.79,-5783.4 8830.17,-5779.38 4294.43,-5787.84 4271.79,-5765.4 4261.91,-5755.59 4259.52,-5741.26 4260.3,-5727.37"/>
<polygon fill="black" stroke="black" points="4263.79,-5727.72 4261.37,-5717.4 4256.83,-5726.97 4263.79,-5727.72"/>
<text text-anchor="middle" x="4317.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4317.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→2</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_2 -->
<g id="edge787" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9288.98,-5803.26C9321.49,-5795.46 9355.54,-5788.31 9387.79,-5783.4 9424.42,-5777.81 9695.31,-5792.29 9720.79,-5765.4 9734.38,-5751.06 9726.02,-5736.47 9709.84,-5723.7"/>
<polygon fill="black" stroke="black" points="9711.5,-5720.58 9701.33,-5717.58 9707.41,-5726.26 9711.5,-5720.58"/>
<text text-anchor="middle" x="9772.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9772.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→4</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_3 -->
<g id="edge788" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8962.18,-5802.37C8929.23,-5794.53 8894.62,-5787.61 8861.79,-5783.4 8823.69,-5778.51 6123.04,-5792.48 6095.79,-5765.4 6086.1,-5755.76 6083.62,-5741.76 6084.28,-5728.1"/>
<polygon fill="black" stroke="black" points="6087.8,-5728.1 6085.33,-5717.8 6080.83,-5727.39 6087.8,-5728.1"/>
<text text-anchor="middle" x="6141.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6141.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→6</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_4 -->
<g id="edge789" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9287.04,-5802.36C9320.1,-5794.5 9354.84,-5787.56 9387.79,-5783.4 9427.79,-5778.34 15164.33,-5793.95 15192.79,-5765.4 15207.06,-5751.08 15198.08,-5736.25 15181.15,-5723.24"/>
<polygon fill="black" stroke="black" points="15183.05,-5720.3 15172.86,-5717.4 15179.02,-5726.02 15183.05,-5720.3"/>
<text text-anchor="middle" x="15245.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15245.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→8</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_5 -->
<g id="edge790" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9287.04,-5802.4C9320.1,-5794.54 9354.85,-5787.59 9387.79,-5783.4 9415.22,-5779.91 13349.29,-5784.99 13368.79,-5765.4 13382.98,-5751.14 13374.15,-5736.37 13357.36,-5723.41"/>
<polygon fill="black" stroke="black" points="13359.33,-5720.51 13349.15,-5717.59 13355.28,-5726.22 13359.33,-5720.51"/>
<text text-anchor="middle" x="13421.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13421.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→10</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_6 -->
<g id="edge791" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8962.54,-5802.36C8929.49,-5794.5 8894.74,-5787.56 8861.79,-5783.4 8840.09,-5780.65 2577.33,-5780.79 2561.79,-5765.4 2551.9,-5755.6 2549.51,-5741.27 2550.3,-5727.38"/>
<polygon fill="black" stroke="black" points="2553.78,-5727.73 2551.37,-5717.41 2546.82,-5726.98 2553.78,-5727.73"/>
<text text-anchor="middle" x="2607.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2607.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→12</text>
</g>
<!-- layer2_gate_3_1&#45;&gt;layer2_expert1_7 -->
<g id="edge792" class="edge">
<title>layer2_gate_3_1&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9287.41,-5802.42C9320.36,-5794.58 9354.97,-5787.64 9387.79,-5783.4 9417.5,-5779.56 11523.7,-5786.67 11544.79,-5765.4 11558.96,-5751.11 11550.12,-5736.33 11533.33,-5723.37"/>
<polygon fill="black" stroke="black" points="11535.3,-5720.48 11525.12,-5717.55 11531.25,-5726.19 11535.3,-5720.48"/>
<text text-anchor="middle" x="11597.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11597.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 13→14</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_0 -->
<g id="edge793" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.42,-5802.54C5638.37,-5794.69 5672.98,-5787.71 5705.79,-5783.4 5744.16,-5778.35 7065.01,-5784.27 7098.79,-5765.4 7112.57,-5757.7 7104.21,-5743.44 7117.79,-5735.4 7176.71,-5700.49 7617.46,-5689.12 7818.89,-5685.72"/>
<polygon fill="black" stroke="black" points="7819.24,-5689.22 7829.18,-5685.55 7819.12,-5682.22 7819.24,-5689.22"/>
<text text-anchor="middle" x="7163.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7163.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_1 -->
<g id="edge794" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5280.17,-5802.47C5247.22,-5794.63 5212.61,-5787.67 5179.79,-5783.4 5156.29,-5780.33 3490.46,-5782.24 3473.79,-5765.4 3464.41,-5755.92 3464.67,-5745.12 3473.79,-5735.4 3497.3,-5710.34 3962.39,-5693.5 4171.01,-5687.18"/>
<polygon fill="black" stroke="black" points="4171.16,-5690.68 4181.05,-5686.88 4170.95,-5683.68 4171.16,-5690.68"/>
<text text-anchor="middle" x="3519.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3519.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_2 -->
<g id="edge795" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.4,-5802.35C5638.35,-5794.51 5672.96,-5787.59 5705.79,-5783.4 5750.11,-5777.73 8883.71,-5787.05 8922.79,-5765.4 8936.6,-5757.75 8928.26,-5743.51 8941.79,-5735.4 8990.87,-5705.96 9350.62,-5692.03 9529.03,-5686.88"/>
<polygon fill="black" stroke="black" points="9529.32,-5690.37 9539.21,-5686.59 9529.12,-5683.37 9529.32,-5690.37"/>
<text text-anchor="middle" x="8987.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8987.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_3 -->
<g id="edge796" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5314.79,-5784.1C5300.1,-5768.75 5295.22,-5752.01 5310.79,-5735.4 5333.84,-5710.8 5788.69,-5693.78 5994.8,-5687.3"/>
<polygon fill="black" stroke="black" points="5995.14,-5690.79 6005.02,-5686.98 5994.92,-5683.8 5995.14,-5690.79"/>
<text text-anchor="middle" x="5356.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5356.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_4 -->
<g id="edge797" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.04,-5802.34C5638.09,-5794.48 5672.84,-5787.55 5705.79,-5783.4 5765.66,-5775.85 14341.96,-5794.54 14394.79,-5765.4 14408.61,-5757.77 14400.26,-5743.51 14413.79,-5735.4 14462.87,-5705.96 14822.62,-5692.03 15001.03,-5686.88"/>
<polygon fill="black" stroke="black" points="15001.32,-5690.37 15011.21,-5686.59 15001.12,-5683.37 15001.32,-5690.37"/>
<text text-anchor="middle" x="14459.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14459.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_5 -->
<g id="edge798" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.04,-5802.35C5638.09,-5794.49 5672.84,-5787.56 5705.79,-5783.4 5753.09,-5777.42 12529.06,-5788.44 12570.79,-5765.4 12584.61,-5757.77 12576.26,-5743.51 12589.79,-5735.4 12638.87,-5705.96 12998.62,-5692.03 13177.03,-5686.88"/>
<polygon fill="black" stroke="black" points="13177.32,-5690.37 13187.21,-5686.59 13177.12,-5683.37 13177.32,-5690.37"/>
<text text-anchor="middle" x="12635.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12635.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_6 -->
<g id="edge799" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5280.54,-5802.42C5247.48,-5794.55 5212.74,-5787.6 5179.79,-5783.4 5156.26,-5780.39 1780.52,-5782.21 1763.79,-5765.4 1754.39,-5755.94 1754.67,-5745.12 1763.79,-5735.4 1787.3,-5710.34 2252.39,-5693.5 2461.01,-5687.18"/>
<polygon fill="black" stroke="black" points="2461.16,-5690.68 2471.05,-5686.88 2460.95,-5683.68 2461.16,-5690.68"/>
<text text-anchor="middle" x="1809.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1809.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer2_gate_3_2&#45;&gt;layer2_expert1_7 -->
<g id="edge800" class="edge">
<title>layer2_gate_3_2&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5605.04,-5802.38C5638.1,-5794.51 5672.84,-5787.57 5705.79,-5783.4 5740.52,-5778.99 10716.15,-5782.33 10746.79,-5765.4 10760.6,-5757.76 10752.26,-5743.51 10765.79,-5735.4 10814.87,-5705.96 11174.62,-5692.03 11353.03,-5686.88"/>
<polygon fill="black" stroke="black" points="11353.32,-5690.37 11363.21,-5686.59 11353.12,-5683.37 11353.32,-5690.37"/>
<text text-anchor="middle" x="10811.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10811.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_0 -->
<g id="edge801" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8435.38,-5802.91C8402.65,-5795.08 8368.32,-5788.02 8335.79,-5783.4 8306.62,-5779.25 7826.27,-5786.58 7805.79,-5765.4 7790.24,-5749.3 7800.77,-5734.24 7820.54,-5721.58"/>
<polygon fill="black" stroke="black" points="7822.36,-5724.57 7829.2,-5716.48 7818.8,-5718.54 7822.36,-5724.57"/>
<text text-anchor="middle" x="7851.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7851.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→0</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_1 -->
<g id="edge802" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8436.54,-5802.4C8403.48,-5794.53 8368.74,-5787.58 8335.79,-5783.4 8307.01,-5779.74 4178.26,-5785.96 4157.79,-5765.4 4141.92,-5749.46 4152.57,-5734.4 4172.54,-5721.68"/>
<polygon fill="black" stroke="black" points="4174.42,-5724.63 4181.27,-5716.56 4170.88,-5718.59 4174.42,-5724.63"/>
<text text-anchor="middle" x="4203.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4203.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→2</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_2 -->
<g id="edge803" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8761.82,-5802.74C8794.65,-5794.9 8829.12,-5787.88 8861.79,-5783.4 8902.81,-5777.77 9574.21,-5790.94 9606.79,-5765.4 9618.33,-5756.35 9624.19,-5741.91 9627.07,-5727.71"/>
<polygon fill="black" stroke="black" points="9630.58,-5727.91 9628.67,-5717.49 9623.66,-5726.83 9630.58,-5727.91"/>
<text text-anchor="middle" x="9670.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9670.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→4</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_3 -->
<g id="edge804" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8436.18,-5802.4C8403.23,-5794.56 8368.61,-5787.62 8335.79,-5783.4 8303.36,-5779.22 6004.82,-5788.6 5981.79,-5765.4 5966.03,-5749.51 5976.51,-5734.5 5996.29,-5721.83"/>
<polygon fill="black" stroke="black" points="5998.11,-5724.82 6004.95,-5716.72 5994.56,-5718.78 5998.11,-5724.82"/>
<text text-anchor="middle" x="6027.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6027.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→6</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_4 -->
<g id="edge805" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8761.04,-5802.36C8794.1,-5794.5 8828.84,-5787.56 8861.79,-5783.4 8904.62,-5777.98 15044.53,-5791.67 15078.79,-5765.4 15090.42,-5756.48 15096.31,-5742.06 15099.17,-5727.85"/>
<polygon fill="black" stroke="black" points="15102.68,-5728.03 15100.76,-5717.61 15095.77,-5726.96 15102.68,-5728.03"/>
<text text-anchor="middle" x="15142.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15142.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→8</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_5 -->
<g id="edge806" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8761.04,-5802.39C8794.1,-5794.52 8828.84,-5787.58 8861.79,-5783.4 8892.06,-5779.55 13230.59,-5783.98 13254.79,-5765.4 13266.42,-5756.47 13272.3,-5742.05 13275.17,-5727.84"/>
<polygon fill="black" stroke="black" points="13278.68,-5728.02 13276.75,-5717.6 13271.76,-5726.95 13278.68,-5728.02"/>
<text text-anchor="middle" x="13318.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13318.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→10</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_6 -->
<g id="edge807" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8436.54,-5802.36C8403.49,-5794.5 8368.74,-5787.56 8335.79,-5783.4 8295.23,-5778.26 2476.66,-5794.35 2447.79,-5765.4 2431.91,-5749.47 2442.56,-5734.41 2462.52,-5721.69"/>
<polygon fill="black" stroke="black" points="2464.4,-5724.65 2471.26,-5716.57 2460.87,-5718.61 2464.4,-5724.65"/>
<text text-anchor="middle" x="2493.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2493.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→12</text>
</g>
<!-- layer2_gate_3_3&#45;&gt;layer2_expert1_7 -->
<g id="edge808" class="edge">
<title>layer2_gate_3_3&#45;&gt;layer2_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8761.4,-5802.38C8794.35,-5794.55 8828.97,-5787.61 8861.79,-5783.4 8897.18,-5778.85 11402.52,-5787.17 11430.79,-5765.4 11442.4,-5756.45 11448.29,-5742.03 11451.15,-5727.82"/>
<polygon fill="black" stroke="black" points="11454.66,-5728.01 11452.74,-5717.59 11447.75,-5726.93 11454.66,-5728.01"/>
<text text-anchor="middle" x="11494.29" y="-5754.2" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11494.29" y="-5739.2" font-family="Times,serif" font-size="14.00">GPU 15→14</text>
</g>
<!-- layer2_expert_gelu_0 -->
<g id="node312" class="node">
<title>layer2_expert_gelu_0</title>
<ellipse fill="lightgray" stroke="black" cx="8169.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="8169.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="8169.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8169.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_expert1_0&#45;&gt;layer2_expert_gelu_0 -->
<g id="edge809" class="edge">
<title>layer2_expert1_0&#45;&gt;layer2_expert_gelu_0</title>
<path fill="none" stroke="black" d="M7996.83,-5649.29C8026.18,-5636.84 8059.59,-5622.67 8089.17,-5610.12"/>
<polygon fill="black" stroke="black" points="8090.79,-5613.24 8098.63,-5606.11 8088.05,-5606.79 8090.79,-5613.24"/>
</g>
<!-- layer2_expert2_0 -->
<g id="node313" class="node">
<title>layer2_expert2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="8737.29,-5500.44 8552.29,-5500.44 8552.29,-5432.44 8737.29,-5432.44 8737.29,-5500.44"/>
<text text-anchor="middle" x="8644.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 0 Second Linear</text>
<text text-anchor="middle" x="8644.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8644.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="8644.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_0&#45;&gt;layer2_expert2_0 -->
<g id="edge810" class="edge">
<title>layer2_expert_gelu_0&#45;&gt;layer2_expert2_0</title>
<path fill="none" stroke="black" d="M8279.41,-5556.01C8351.82,-5543.33 8448.85,-5524.71 8542.28,-5500.75"/>
<polygon fill="black" stroke="black" points="8543.38,-5504.08 8552.18,-5498.19 8541.63,-5497.3 8543.38,-5504.08"/>
</g>
<!-- layer2_expert_agg_0_0 -->
<g id="node335" class="node">
<title>layer2_expert_agg_0_0</title>
<polygon fill="darkseagreen" stroke="black" points="3954.88,-5272.59 3954.88,-5325.24 3844.12,-5362.47 3687.47,-5362.47 3576.7,-5325.24 3576.7,-5272.59 3687.47,-5235.37 3844.12,-5235.37 3954.88,-5272.59"/>
<polygon fill="none" stroke="black" points="3958.88,-5269.72 3958.88,-5328.12 3844.77,-5366.47 3686.81,-5366.47 3572.7,-5328.12 3572.7,-5269.72 3686.81,-5231.37 3844.77,-5231.37 3958.88,-5269.72"/>
<text text-anchor="middle" x="3765.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3765.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="3765.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3765.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3765.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge825" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.94C8549.28,-5433.38 8546.52,-5432.88 8543.79,-5432.44 8510.2,-5427.03 3668.8,-5438.54 3644.79,-5414.44 3628.18,-5397.77 3634.35,-5380.12 3650.51,-5363.81"/>
<polygon fill="black" stroke="black" points="3653.02,-5366.25 3658,-5356.9 3648.28,-5361.1 3653.02,-5366.25"/>
<text text-anchor="middle" x="3694.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3694.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer2_expert_agg_0_1 -->
<g id="node336" class="node">
<title>layer2_expert_agg_0_1</title>
<polygon fill="darkseagreen" stroke="black" points="8834.88,-5272.59 8834.88,-5325.24 8724.12,-5362.47 8567.47,-5362.47 8456.7,-5325.24 8456.7,-5272.59 8567.47,-5235.37 8724.12,-5235.37 8834.88,-5272.59"/>
<polygon fill="none" stroke="black" points="8838.88,-5269.72 8838.88,-5328.12 8724.77,-5366.47 8566.81,-5366.47 8452.7,-5328.12 8452.7,-5269.72 8566.81,-5231.37 8724.77,-5231.37 8838.88,-5269.72"/>
<text text-anchor="middle" x="8645.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8645.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="8645.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8645.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="8645.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge826" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.28,-5433.57C8539.34,-5427.37 8529.01,-5420.81 8524.79,-5414.44 8513.07,-5396.72 8518.04,-5379.73 8531.09,-5364.52"/>
<polygon fill="black" stroke="black" points="8533.71,-5366.84 8538.11,-5357.2 8528.66,-5362 8533.71,-5366.84"/>
<text text-anchor="middle" x="8574.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8574.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
</g>
<!-- layer2_expert_agg_0_2 -->
<g id="node337" class="node">
<title>layer2_expert_agg_0_2</title>
<polygon fill="darkseagreen" stroke="black" points="6882.88,-5272.59 6882.88,-5325.24 6772.12,-5362.47 6615.47,-5362.47 6504.7,-5325.24 6504.7,-5272.59 6615.47,-5235.37 6772.12,-5235.37 6882.88,-5272.59"/>
<polygon fill="none" stroke="black" points="6886.88,-5269.72 6886.88,-5328.12 6772.77,-5366.47 6614.81,-5366.47 6500.7,-5328.12 6500.7,-5269.72 6614.81,-5231.37 6772.77,-5231.37 6886.88,-5269.72"/>
<text text-anchor="middle" x="6693.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6693.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="6693.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6693.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6693.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge827" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.96C8549.28,-5433.4 8546.52,-5432.89 8543.79,-5432.44 8516.78,-5428.01 6592.06,-5433.89 6572.79,-5414.44 6556.22,-5397.72 6562.42,-5380.06 6578.57,-5363.75"/>
<polygon fill="black" stroke="black" points="6581.08,-5366.19 6586.07,-5356.84 6576.34,-5361.04 6581.08,-5366.19"/>
<text text-anchor="middle" x="6622.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6622.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer2_expert_agg_0_3 -->
<g id="node338" class="node">
<title>layer2_expert_agg_0_3</title>
<polygon fill="darkseagreen" stroke="black" points="11640.88,-5272.59 11640.88,-5325.24 11530.12,-5362.47 11373.47,-5362.47 11262.7,-5325.24 11262.7,-5272.59 11373.47,-5235.37 11530.12,-5235.37 11640.88,-5272.59"/>
<polygon fill="none" stroke="black" points="11644.88,-5269.72 11644.88,-5328.12 11530.77,-5366.47 11372.81,-5366.47 11258.7,-5328.12 11258.7,-5269.72 11372.81,-5231.37 11530.77,-5231.37 11644.88,-5269.72"/>
<text text-anchor="middle" x="11451.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11451.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="11451.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11451.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="11451.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge828" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.62C8885.76,-5453.12 9185.52,-5438.87 9439.79,-5432.44 9467.42,-5431.74 11408.56,-5432.14 11429.79,-5414.44 11436.49,-5408.86 11441.17,-5394.08 11444.43,-5376.92"/>
<polygon fill="black" stroke="black" points="11447.96,-5377.03 11446.19,-5366.59 11441.06,-5375.86 11447.96,-5377.03"/>
<text text-anchor="middle" x="11491.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11491.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→3</text>
</g>
<!-- layer2_expert_agg_1_0 -->
<g id="node339" class="node">
<title>layer2_expert_agg_1_0</title>
<polygon fill="darkseagreen" stroke="black" points="13592.88,-5272.59 13592.88,-5325.24 13482.12,-5362.47 13325.47,-5362.47 13214.7,-5325.24 13214.7,-5272.59 13325.47,-5235.37 13482.12,-5235.37 13592.88,-5272.59"/>
<polygon fill="none" stroke="black" points="13596.88,-5269.72 13596.88,-5328.12 13482.77,-5366.47 13324.81,-5366.47 13210.7,-5328.12 13210.7,-5269.72 13324.81,-5231.37 13482.77,-5231.37 13596.88,-5269.72"/>
<text text-anchor="middle" x="13403.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13403.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="13403.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13403.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13403.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge829" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.48C8885.75,-5452.8 9185.51,-5438.3 9439.79,-5432.44 9467.16,-5431.81 13360.73,-5431.93 13381.79,-5414.44 13388.5,-5408.88 13393.18,-5394.1 13396.45,-5376.94"/>
<polygon fill="black" stroke="black" points="13399.98,-5377.05 13398.21,-5366.61 13393.08,-5375.88 13399.98,-5377.05"/>
<text text-anchor="middle" x="13443.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13443.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer2_expert_agg_1_1 -->
<g id="node340" class="node">
<title>layer2_expert_agg_1_1</title>
<polygon fill="darkseagreen" stroke="black" points="9688.88,-5272.59 9688.88,-5325.24 9578.12,-5362.47 9421.47,-5362.47 9310.7,-5325.24 9310.7,-5272.59 9421.47,-5235.37 9578.12,-5235.37 9688.88,-5272.59"/>
<polygon fill="none" stroke="black" points="9692.88,-5269.72 9692.88,-5328.12 9578.77,-5366.47 9420.81,-5366.47 9306.7,-5328.12 9306.7,-5269.72 9420.81,-5231.37 9578.77,-5231.37 9692.88,-5269.72"/>
<text text-anchor="middle" x="9499.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9499.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="9499.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9499.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="9499.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge830" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.58,-5466.05C8943.17,-5466.52 9423.24,-5462.39 9477.79,-5414.44 9484.31,-5408.72 9488.92,-5393.99 9492.19,-5376.94"/>
<polygon fill="black" stroke="black" points="9495.71,-5377.13 9493.95,-5366.68 9488.81,-5375.94 9495.71,-5377.13"/>
<text text-anchor="middle" x="9539.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9539.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→5</text>
</g>
<!-- layer2_expert_agg_1_2 -->
<g id="node341" class="node">
<title>layer2_expert_agg_1_2</title>
<polygon fill="darkseagreen" stroke="black" points="4930.88,-5272.59 4930.88,-5325.24 4820.12,-5362.47 4663.47,-5362.47 4552.7,-5325.24 4552.7,-5272.59 4663.47,-5235.37 4820.12,-5235.37 4930.88,-5272.59"/>
<polygon fill="none" stroke="black" points="4934.88,-5269.72 4934.88,-5328.12 4820.77,-5366.47 4662.81,-5366.47 4548.7,-5328.12 4548.7,-5269.72 4662.81,-5231.37 4820.77,-5231.37 4934.88,-5269.72"/>
<text text-anchor="middle" x="4741.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4741.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="4741.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4741.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="4741.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge831" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.94C8549.28,-5433.39 8546.52,-5432.88 8543.79,-5432.44 8516.9,-5428.1 4640.01,-5433.75 4620.79,-5414.44 4604.19,-5397.76 4610.36,-5380.11 4626.52,-5363.8"/>
<polygon fill="black" stroke="black" points="4629.03,-5366.24 4634.01,-5356.89 4624.29,-5361.09 4629.03,-5366.24"/>
<text text-anchor="middle" x="4670.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4670.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer2_expert_agg_1_3 -->
<g id="node342" class="node">
<title>layer2_expert_agg_1_3</title>
<polygon fill="darkseagreen" stroke="black" points="16520.88,-5272.59 16520.88,-5325.24 16410.12,-5362.47 16253.47,-5362.47 16142.7,-5325.24 16142.7,-5272.59 16253.47,-5235.37 16410.12,-5235.37 16520.88,-5272.59"/>
<polygon fill="none" stroke="black" points="16524.88,-5269.72 16524.88,-5328.12 16410.77,-5366.47 16252.81,-5366.47 16138.7,-5328.12 16138.7,-5269.72 16252.81,-5231.37 16410.77,-5231.37 16524.88,-5269.72"/>
<text text-anchor="middle" x="16331.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16331.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="16331.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="16331.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="16331.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge832" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.43C8885.75,-5452.66 9185.5,-5438.05 9439.79,-5432.44 9463.64,-5431.92 16291.42,-5429.66 16309.79,-5414.44 16316.5,-5408.88 16321.19,-5394.11 16324.45,-5376.94"/>
<polygon fill="black" stroke="black" points="16327.98,-5377.06 16326.21,-5366.61 16321.08,-5375.88 16327.98,-5377.06"/>
<text text-anchor="middle" x="16371.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16371.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→7</text>
</g>
<!-- layer2_expert_agg_2_0 -->
<g id="node343" class="node">
<title>layer2_expert_agg_2_0</title>
<polygon fill="darkseagreen" stroke="black" points="14568.88,-5272.59 14568.88,-5325.24 14458.12,-5362.47 14301.47,-5362.47 14190.7,-5325.24 14190.7,-5272.59 14301.47,-5235.37 14458.12,-5235.37 14568.88,-5272.59"/>
<polygon fill="none" stroke="black" points="14572.88,-5269.72 14572.88,-5328.12 14458.77,-5366.47 14300.81,-5366.47 14186.7,-5328.12 14186.7,-5269.72 14300.81,-5231.37 14458.77,-5231.37 14572.88,-5269.72"/>
<text text-anchor="middle" x="14379.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14379.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="14379.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14379.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14379.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge833" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.46C8885.75,-5452.74 9185.51,-5438.18 9439.79,-5432.44 9473.94,-5431.67 14331.5,-5436.24 14357.79,-5414.44 14364.5,-5408.88 14369.19,-5394.1 14372.45,-5376.94"/>
<polygon fill="black" stroke="black" points="14375.98,-5377.06 14374.21,-5366.61 14369.08,-5375.88 14375.98,-5377.06"/>
<text text-anchor="middle" x="14419.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14419.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer2_expert_agg_2_1 -->
<g id="node344" class="node">
<title>layer2_expert_agg_2_1</title>
<polygon fill="darkseagreen" stroke="black" points="12616.88,-5272.59 12616.88,-5325.24 12506.12,-5362.47 12349.47,-5362.47 12238.7,-5325.24 12238.7,-5272.59 12349.47,-5235.37 12506.12,-5235.37 12616.88,-5272.59"/>
<polygon fill="none" stroke="black" points="12620.88,-5269.72 12620.88,-5328.12 12506.77,-5366.47 12348.81,-5366.47 12234.7,-5328.12 12234.7,-5269.72 12348.81,-5231.37 12506.77,-5231.37 12620.88,-5269.72"/>
<text text-anchor="middle" x="12427.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12427.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="12427.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12427.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12427.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge834" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.53C8885.75,-5452.91 9185.51,-5438.49 9439.79,-5432.44 9460.38,-5431.95 12389.95,-5427.61 12405.79,-5414.44 12412.49,-5408.87 12417.18,-5394.09 12420.44,-5376.93"/>
<polygon fill="black" stroke="black" points="12423.97,-5377.05 12422.2,-5366.6 12417.07,-5375.87 12423.97,-5377.05"/>
<text text-anchor="middle" x="12467.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12467.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→9</text>
</g>
<!-- layer2_expert_agg_2_2 -->
<g id="node345" class="node">
<title>layer2_expert_agg_2_2</title>
<polygon fill="darkseagreen" stroke="black" points="7858.88,-5272.59 7858.88,-5325.24 7748.12,-5362.47 7591.47,-5362.47 7480.7,-5325.24 7480.7,-5272.59 7591.47,-5235.37 7748.12,-5235.37 7858.88,-5272.59"/>
<polygon fill="none" stroke="black" points="7862.88,-5269.72 7862.88,-5328.12 7748.77,-5366.47 7590.81,-5366.47 7476.7,-5328.12 7476.7,-5269.72 7590.81,-5231.37 7748.77,-5231.37 7862.88,-5269.72"/>
<text text-anchor="middle" x="7669.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7669.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="7669.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7669.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="7669.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge835" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.99C8549.28,-5433.42 8546.52,-5432.9 8543.79,-5432.44 8516.53,-5427.85 7568.16,-5434.17 7548.79,-5414.44 7532.39,-5397.74 7538.45,-5380.15 7554.42,-5363.91"/>
<polygon fill="black" stroke="black" points="7556.88,-5366.4 7561.83,-5357.03 7552.12,-5361.27 7556.88,-5366.4"/>
<text text-anchor="middle" x="7598.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7598.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer2_expert_agg_2_3 -->
<g id="node346" class="node">
<title>layer2_expert_agg_2_3</title>
<polygon fill="darkseagreen" stroke="black" points="10664.88,-5272.59 10664.88,-5325.24 10554.12,-5362.47 10397.47,-5362.47 10286.7,-5325.24 10286.7,-5272.59 10397.47,-5235.37 10554.12,-5235.37 10664.88,-5272.59"/>
<polygon fill="none" stroke="black" points="10668.88,-5269.72 10668.88,-5328.12 10554.77,-5366.47 10396.81,-5366.47 10282.7,-5328.12 10282.7,-5269.72 10396.81,-5231.37 10554.77,-5231.37 10668.88,-5269.72"/>
<text text-anchor="middle" x="10475.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10475.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="10475.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10475.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10475.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge836" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.48,-5460.88C8885.77,-5453.74 9185.55,-5439.97 9439.79,-5432.44 9467.95,-5431.61 10432.23,-5432.58 10453.79,-5414.44 10460.46,-5408.83 10465.13,-5394.04 10468.4,-5376.88"/>
<polygon fill="black" stroke="black" points="10471.93,-5377 10470.16,-5366.55 10465.03,-5375.82 10471.93,-5377"/>
<text text-anchor="middle" x="10515.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10515.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→11</text>
</g>
<!-- layer2_expert_agg_3_0 -->
<g id="node347" class="node">
<title>layer2_expert_agg_3_0</title>
<polygon fill="darkseagreen" stroke="black" points="2978.88,-5272.59 2978.88,-5325.24 2868.12,-5362.47 2711.47,-5362.47 2600.7,-5325.24 2600.7,-5272.59 2711.47,-5235.37 2868.12,-5235.37 2978.88,-5272.59"/>
<polygon fill="none" stroke="black" points="2982.88,-5269.72 2982.88,-5328.12 2868.77,-5366.47 2710.81,-5366.47 2596.7,-5328.12 2596.7,-5269.72 2710.81,-5231.37 2868.77,-5231.37 2982.88,-5269.72"/>
<text text-anchor="middle" x="2789.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2789.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="2789.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2789.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2789.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge837" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.94C8549.28,-5433.38 8546.52,-5432.88 8543.79,-5432.44 8503.51,-5425.97 2697.6,-5443.34 2668.79,-5414.44 2652.17,-5397.77 2658.35,-5380.13 2674.5,-5363.82"/>
<polygon fill="black" stroke="black" points="2677.01,-5366.26 2682,-5356.91 2672.27,-5361.11 2677.01,-5366.26"/>
<text text-anchor="middle" x="2718.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2718.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer2_expert_agg_3_1 -->
<g id="node348" class="node">
<title>layer2_expert_agg_3_1</title>
<polygon fill="darkseagreen" stroke="black" points="5906.88,-5272.59 5906.88,-5325.24 5796.12,-5362.47 5639.47,-5362.47 5528.7,-5325.24 5528.7,-5272.59 5639.47,-5235.37 5796.12,-5235.37 5906.88,-5272.59"/>
<polygon fill="none" stroke="black" points="5910.88,-5269.72 5910.88,-5328.12 5796.77,-5366.47 5638.81,-5366.47 5524.7,-5328.12 5524.7,-5269.72 5638.81,-5231.37 5796.77,-5231.37 5910.88,-5269.72"/>
<text text-anchor="middle" x="5717.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5717.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="5717.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5717.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="5717.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge838" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.95C8549.28,-5433.39 8546.52,-5432.89 8543.79,-5432.44 8503.39,-5425.88 5625.65,-5443.47 5596.79,-5414.44 5580.2,-5397.75 5586.38,-5380.1 5602.54,-5363.78"/>
<polygon fill="black" stroke="black" points="5605.05,-5366.23 5610.03,-5356.88 5600.31,-5361.08 5605.05,-5366.23"/>
<text text-anchor="middle" x="5646.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5646.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→13</text>
</g>
<!-- layer2_expert_agg_3_2 -->
<g id="node349" class="node">
<title>layer2_expert_agg_3_2</title>
<polygon fill="darkseagreen" stroke="black" points="2124.88,-5272.59 2124.88,-5325.24 2014.12,-5362.47 1857.47,-5362.47 1746.7,-5325.24 1746.7,-5272.59 1857.47,-5235.37 2014.12,-5235.37 2124.88,-5272.59"/>
<polygon fill="none" stroke="black" points="2128.88,-5269.72 2128.88,-5328.12 2014.77,-5366.47 1856.81,-5366.47 1742.7,-5328.12 1742.7,-5269.72 1856.81,-5231.37 2014.77,-5231.37 2128.88,-5269.72"/>
<text text-anchor="middle" x="1935.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1935.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="1935.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="1935.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="1935.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge839" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8552.05,-5433.94C8549.28,-5433.38 8546.52,-5432.88 8543.79,-5432.44 8520.72,-5428.74 1831.29,-5430.99 1814.79,-5414.44 1798.17,-5397.78 1804.34,-5380.13 1820.5,-5363.82"/>
<polygon fill="black" stroke="black" points="1823.01,-5366.26 1827.99,-5356.92 1818.27,-5361.12 1823.01,-5366.26"/>
<text text-anchor="middle" x="1864.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1864.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer2_expert_agg_3_3 -->
<g id="node350" class="node">
<title>layer2_expert_agg_3_3</title>
<polygon fill="darkseagreen" stroke="black" points="15544.88,-5272.59 15544.88,-5325.24 15434.12,-5362.47 15277.47,-5362.47 15166.7,-5325.24 15166.7,-5272.59 15277.47,-5235.37 15434.12,-5235.37 15544.88,-5272.59"/>
<polygon fill="none" stroke="black" points="15548.88,-5269.72 15548.88,-5328.12 15434.77,-5366.47 15276.81,-5366.47 15162.7,-5328.12 15162.7,-5269.72 15276.81,-5231.37 15434.77,-5231.37 15548.88,-5269.72"/>
<text text-anchor="middle" x="15355.79" y="-5325.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15355.79" y="-5310.22" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="15355.79" y="-5295.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="15355.79" y="-5280.22" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="15355.79" y="-5265.22" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer2_expert2_0&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge840" class="edge">
<title>layer2_expert2_0&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.47,-5460.44C8885.75,-5452.69 9185.5,-5438.11 9439.79,-5432.44 9460.25,-5431.99 15318.03,-5427.5 15333.79,-5414.44 15340.5,-5408.88 15345.19,-5394.1 15348.45,-5376.94"/>
<polygon fill="black" stroke="black" points="15351.98,-5377.06 15350.21,-5366.61 15345.08,-5375.88 15351.98,-5377.06"/>
<text text-anchor="middle" x="15395.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15395.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 0→15</text>
</g>
<!-- layer2_expert_gelu_1 -->
<g id="node315" class="node">
<title>layer2_expert_gelu_1</title>
<ellipse fill="lightgray" stroke="black" cx="5778.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5778.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5778.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5778.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_expert1_1&#45;&gt;layer2_expert_gelu_1 -->
<g id="edge811" class="edge">
<title>layer2_expert1_1&#45;&gt;layer2_expert_gelu_1</title>
<path fill="none" stroke="black" d="M4360.33,-5676.07C4615.07,-5658.09 5344.84,-5606.56 5646.17,-5585.28"/>
<polygon fill="black" stroke="black" points="5646.54,-5588.77 5656.27,-5584.57 5646.05,-5581.78 5646.54,-5588.77"/>
</g>
<!-- layer2_expert2_1 -->
<g id="node316" class="node">
<title>layer2_expert2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="8331.29,-5500.44 8146.29,-5500.44 8146.29,-5432.44 8331.29,-5432.44 8331.29,-5500.44"/>
<text text-anchor="middle" x="8238.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 1 Second Linear</text>
<text text-anchor="middle" x="8238.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8238.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8238.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_1&#45;&gt;layer2_expert2_1 -->
<g id="edge812" class="edge">
<title>layer2_expert_gelu_1&#45;&gt;layer2_expert2_1</title>
<path fill="none" stroke="black" d="M5904.39,-5570.24C6371.28,-5556.56 7987.28,-5508.92 8135.67,-5499.72"/>
<polygon fill="black" stroke="black" points="8136.37,-5503.17 8146.04,-5498.85 8135.78,-5496.19 8136.37,-5503.17"/>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge841" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.94C8143.28,-5433.38 8140.52,-5432.88 8137.79,-5432.44 8105.31,-5427.21 3424.01,-5437.75 3400.79,-5414.44 3336.29,-5349.69 3446.61,-5321.46 3562.43,-5309.2"/>
<polygon fill="black" stroke="black" points="3562.97,-5312.66 3572.57,-5308.17 3562.27,-5305.7 3562.97,-5312.66"/>
<text text-anchor="middle" x="3450.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3450.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge842" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8258.87,-5432.25C8270.58,-5415.56 8286.79,-5396.4 8305.79,-5384.44 8346.85,-5358.6 8395.32,-5340.66 8442.61,-5328.2"/>
<polygon fill="black" stroke="black" points="8443.54,-5331.58 8452.36,-5325.71 8441.81,-5324.8 8443.54,-5331.58"/>
<text text-anchor="middle" x="8355.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8355.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→1</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge843" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.96C8143.28,-5433.4 8140.52,-5432.89 8137.79,-5432.44 8113,-5428.37 6346.47,-5432.3 6328.79,-5414.44 6264.49,-5349.5 6374.79,-5321.28 6490.56,-5309.07"/>
<polygon fill="black" stroke="black" points="6491.1,-5312.54 6500.69,-5308.05 6490.39,-5305.57 6491.1,-5312.54"/>
<text text-anchor="middle" x="6378.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6378.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge844" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.17C8334.51,-5433.53 8337.67,-5432.95 8340.79,-5432.44 8379.8,-5426.16 11151.23,-5433.6 11185.79,-5414.44 11199.59,-5406.79 11192.4,-5394.22 11204.79,-5384.44 11226.83,-5367.05 11252.67,-5353.13 11279.18,-5342.01"/>
<polygon fill="black" stroke="black" points="11280.63,-5345.2 11288.57,-5338.2 11277.99,-5338.72 11280.63,-5345.2"/>
<text text-anchor="middle" x="11254.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11254.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge845" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.16C8334.51,-5433.52 8337.67,-5432.94 8340.79,-5432.44 8406.58,-5421.94 13079.48,-5446.68 13137.79,-5414.44 13151.6,-5406.81 13144.4,-5394.22 13156.79,-5384.44 13178.83,-5367.05 13204.67,-5353.13 13231.18,-5342.01"/>
<polygon fill="black" stroke="black" points="13232.63,-5345.2 13240.57,-5338.2 13229.99,-5338.72 13232.63,-5345.2"/>
<text text-anchor="middle" x="13206.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13206.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge846" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.34,-5434.23C8334.52,-5433.57 8337.67,-5432.97 8340.79,-5432.44 8389.73,-5424.22 9190.56,-5438.8 9233.79,-5414.44 9247.54,-5406.69 9240.4,-5394.22 9252.79,-5384.44 9274.83,-5367.05 9300.67,-5353.13 9327.18,-5342.01"/>
<polygon fill="black" stroke="black" points="9328.63,-5345.2 9336.57,-5338.2 9325.99,-5338.72 9328.63,-5345.2"/>
<text text-anchor="middle" x="9302.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9302.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→5</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge847" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.94C8143.28,-5433.39 8140.52,-5432.88 8137.79,-5432.44 8112.01,-5428.27 4395.22,-5432.95 4376.79,-5414.44 4312.32,-5349.66 4422.63,-5321.43 4538.45,-5309.18"/>
<polygon fill="black" stroke="black" points="4538.99,-5312.64 4548.59,-5308.15 4538.29,-5305.68 4538.99,-5312.64"/>
<text text-anchor="middle" x="4426.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4426.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge848" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.16C8334.51,-5433.52 8337.67,-5432.94 8340.79,-5432.44 8393.77,-5424.02 16018.82,-5440.36 16065.79,-5414.44 16079.61,-5406.82 16072.4,-5394.22 16084.79,-5384.44 16106.83,-5367.05 16132.67,-5353.13 16159.18,-5342.01"/>
<polygon fill="black" stroke="black" points="16160.63,-5345.2 16168.57,-5338.2 16157.99,-5338.72 16160.63,-5345.2"/>
<text text-anchor="middle" x="16134.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16134.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→7</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge849" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.16C8334.51,-5433.52 8337.67,-5432.94 8340.79,-5432.44 8380.38,-5426.13 14078.7,-5433.83 14113.79,-5414.44 14127.61,-5406.81 14120.4,-5394.22 14132.79,-5384.44 14154.83,-5367.05 14180.67,-5353.13 14207.18,-5342.01"/>
<polygon fill="black" stroke="black" points="14208.63,-5345.2 14216.57,-5338.2 14205.99,-5338.72 14208.63,-5345.2"/>
<text text-anchor="middle" x="14182.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14182.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge850" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.17C8334.51,-5433.52 8337.67,-5432.94 8340.79,-5432.44 8393.19,-5424.05 12115.36,-5440.14 12161.79,-5414.44 12175.6,-5406.8 12168.4,-5394.22 12180.79,-5384.44 12202.83,-5367.05 12228.67,-5353.13 12255.18,-5342.01"/>
<polygon fill="black" stroke="black" points="12256.63,-5345.2 12264.57,-5338.2 12253.99,-5338.72 12256.63,-5345.2"/>
<text text-anchor="middle" x="12230.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12230.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→9</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge851" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.04,-5434C8143.27,-5433.43 8140.52,-5432.91 8137.79,-5432.44 8114.98,-5428.56 7320.98,-5430.98 7304.79,-5414.44 7240.92,-5349.18 7350.95,-5320.98 7466.5,-5308.86"/>
<polygon fill="black" stroke="black" points="7467.01,-5312.33 7476.61,-5307.85 7466.31,-5305.37 7467.01,-5312.33"/>
<text text-anchor="middle" x="7354.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7354.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge852" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.34,-5434.19C8334.51,-5433.54 8337.67,-5432.95 8340.79,-5432.44 8392.04,-5424.11 10164.43,-5439.69 10209.79,-5414.44 10223.58,-5406.77 10216.4,-5394.22 10228.79,-5384.44 10250.83,-5367.05 10276.67,-5353.13 10303.18,-5342.01"/>
<polygon fill="black" stroke="black" points="10304.63,-5345.2 10312.57,-5338.2 10301.99,-5338.72 10304.63,-5345.2"/>
<text text-anchor="middle" x="10278.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10278.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→11</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge853" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.94C8143.28,-5433.38 8140.52,-5432.88 8137.79,-5432.44 8098.62,-5426.14 2452.8,-5442.54 2424.79,-5414.44 2360.27,-5349.71 2470.59,-5321.48 2586.42,-5309.21"/>
<polygon fill="black" stroke="black" points="2586.96,-5312.68 2596.56,-5308.18 2586.25,-5305.71 2586.96,-5312.68"/>
<text text-anchor="middle" x="2474.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2474.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge854" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.95C8143.28,-5433.39 8140.52,-5432.89 8137.79,-5432.44 8099.61,-5426.24 5380.05,-5441.88 5352.79,-5414.44 5288.37,-5349.61 5398.69,-5321.38 5514.49,-5309.14"/>
<polygon fill="black" stroke="black" points="5515.03,-5312.61 5524.62,-5308.11 5514.32,-5305.64 5515.03,-5312.61"/>
<text text-anchor="middle" x="5402.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5402.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→13</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge855" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8146.05,-5433.94C8143.28,-5433.38 8140.52,-5432.88 8137.79,-5432.44 8115.28,-5428.83 1586.89,-5430.59 1570.79,-5414.44 1506.25,-5349.73 1616.57,-5321.49 1732.41,-5309.22"/>
<polygon fill="black" stroke="black" points="1732.95,-5312.68 1742.55,-5308.19 1732.24,-5305.72 1732.95,-5312.68"/>
<text text-anchor="middle" x="1620.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1620.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer2_expert2_1&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge856" class="edge">
<title>layer2_expert2_1&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8331.33,-5434.16C8334.51,-5433.52 8337.67,-5432.94 8340.79,-5432.44 8387.08,-5425.08 15048.76,-5437.09 15089.79,-5414.44 15103.61,-5406.81 15096.4,-5394.22 15108.79,-5384.44 15130.83,-5367.05 15156.67,-5353.13 15183.18,-5342.01"/>
<polygon fill="black" stroke="black" points="15184.63,-5345.2 15192.57,-5338.2 15181.99,-5338.72 15184.63,-5345.2"/>
<text text-anchor="middle" x="15158.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15158.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 2→15</text>
</g>
<!-- layer2_expert_gelu_2 -->
<g id="node318" class="node">
<title>layer2_expert_gelu_2</title>
<ellipse fill="lightgray" stroke="black" cx="9573.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="9573.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="9573.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9573.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_expert1_2&#45;&gt;layer2_expert_gelu_2 -->
<g id="edge813" class="edge">
<title>layer2_expert1_2&#45;&gt;layer2_expert_gelu_2</title>
<path fill="none" stroke="black" d="M9611.69,-5649.29C9607.1,-5640.41 9602.06,-5630.65 9597.2,-5621.23"/>
<polygon fill="black" stroke="black" points="9600.3,-5619.62 9592.6,-5612.34 9594.08,-5622.83 9600.3,-5619.62"/>
</g>
<!-- layer2_expert2_2 -->
<g id="node319" class="node">
<title>layer2_expert2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="9633.29,-5500.44 9448.29,-5500.44 9448.29,-5432.44 9633.29,-5432.44 9633.29,-5500.44"/>
<text text-anchor="middle" x="9540.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 2 Second Linear</text>
<text text-anchor="middle" x="9540.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9540.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9540.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_2&#45;&gt;layer2_expert2_2 -->
<g id="edge814" class="edge">
<title>layer2_expert_gelu_2&#45;&gt;layer2_expert2_2</title>
<path fill="none" stroke="black" d="M9562.53,-5537.57C9559.81,-5528.81 9556.89,-5519.37 9554.09,-5510.34"/>
<polygon fill="black" stroke="black" points="9557.42,-5509.28 9551.12,-5500.76 9550.74,-5511.35 9557.42,-5509.28"/>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge857" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.23,-5460.46C9300.14,-5452.73 9000.76,-5438.18 8746.79,-5432.44 8729.5,-5432.05 3779.05,-5426.64 3766.79,-5414.44 3756.7,-5404.4 3752.17,-5391.01 3750.89,-5376.94"/>
<polygon fill="black" stroke="black" points="3754.37,-5376.47 3750.5,-5366.61 3747.38,-5376.73 3754.37,-5376.47"/>
<text text-anchor="middle" x="3816.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3816.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge858" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.06,-5461.81C9222.1,-5452.75 8660.49,-5428.82 8646.79,-5414.44 8637.02,-5404.19 8632.61,-5390.78 8631.33,-5376.76"/>
<polygon fill="black" stroke="black" points="8634.82,-5376.34 8630.92,-5366.48 8627.83,-5376.61 8634.82,-5376.34"/>
<text text-anchor="middle" x="8696.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8696.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→1</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge859" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.22,-5460.61C9300.13,-5453.1 9000.74,-5438.83 8746.79,-5432.44 8718.3,-5431.73 6714.94,-5434.6 6694.79,-5414.44 6684.72,-5404.37 6680.21,-5390.97 6678.93,-5376.9"/>
<polygon fill="black" stroke="black" points="6682.41,-5376.43 6678.54,-5366.57 6675.42,-5376.69 6682.41,-5376.43"/>
<text text-anchor="middle" x="6744.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6744.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge860" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.34,-5434.19C9636.51,-5433.54 9639.67,-5432.95 9642.79,-5432.44 9668.96,-5428.19 11533.13,-5433.28 11551.79,-5414.44 11565.71,-5400.39 11562.91,-5384.75 11551.99,-5369.66"/>
<polygon fill="black" stroke="black" points="11554.63,-5367.35 11545.59,-5361.83 11549.21,-5371.78 11554.63,-5367.35"/>
<text text-anchor="middle" x="11610.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11610.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→3</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge861" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.33,-5434.17C9636.51,-5433.52 9639.67,-5432.94 9642.79,-5432.44 9669.27,-5428.2 13484.88,-5433.45 13503.79,-5414.44 13517.82,-5400.34 13514.93,-5384.62 13503.86,-5369.45"/>
<polygon fill="black" stroke="black" points="13506.43,-5367.07 13497.37,-5361.58 13501.03,-5371.52 13506.43,-5367.07"/>
<text text-anchor="middle" x="13562.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13562.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge862" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9587.62,-5432.4C9592.53,-5426.98 9596.81,-5420.97 9599.79,-5414.44 9605.34,-5402.32 9605.4,-5396.54 9599.79,-5384.44 9597.83,-5380.21 9595.54,-5376.11 9592.98,-5372.16"/>
<polygon fill="black" stroke="black" points="9595.64,-5369.85 9586.99,-5363.73 9589.93,-5373.91 9595.64,-5369.85"/>
<text text-anchor="middle" x="9653.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9653.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→5</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge863" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.23,-5460.48C9300.14,-5452.8 9000.75,-5438.29 8746.79,-5432.44 8718.99,-5431.8 4762.49,-5434.06 4742.79,-5414.44 4732.7,-5404.39 4728.18,-5391.01 4726.9,-5376.93"/>
<polygon fill="black" stroke="black" points="4730.38,-5376.46 4726.5,-5366.6 4723.39,-5376.73 4730.38,-5376.46"/>
<text text-anchor="middle" x="4792.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4792.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge864" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.33,-5434.16C9636.51,-5433.52 9639.67,-5432.94 9642.79,-5432.44 9666.07,-5428.74 16415.14,-5431.13 16431.79,-5414.44 16445.84,-5400.36 16442.95,-5384.64 16431.88,-5369.47"/>
<polygon fill="black" stroke="black" points="16434.45,-5367.09 16425.39,-5361.6 16429.05,-5371.54 16434.45,-5367.09"/>
<text text-anchor="middle" x="16490.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16490.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→7</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge865" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.33,-5434.16C9636.51,-5433.52 9639.67,-5432.94 9642.79,-5432.44 9675.96,-5427.15 14456.08,-5438.24 14479.79,-5414.44 14493.83,-5400.35 14490.94,-5384.63 14479.87,-5369.46"/>
<polygon fill="black" stroke="black" points="14482.44,-5367.08 14473.38,-5361.59 14477.04,-5371.53 14482.44,-5367.08"/>
<text text-anchor="middle" x="14538.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14538.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge866" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.33,-5434.17C9636.51,-5433.53 9639.67,-5432.95 9642.79,-5432.44 9682.35,-5426.08 12499.55,-5442.86 12527.79,-5414.44 12541.73,-5400.41 12538.95,-5384.78 12528.03,-5369.69"/>
<polygon fill="black" stroke="black" points="12530.66,-5367.38 12521.62,-5361.86 12525.24,-5371.82 12530.66,-5367.38"/>
<text text-anchor="middle" x="12586.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12586.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→9</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge867" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.22,-5460.85C9300.11,-5453.67 9000.71,-5439.84 8746.79,-5432.44 8716.91,-5431.57 7691.84,-5435.66 7670.79,-5414.44 7660.76,-5404.33 7656.27,-5390.92 7654.99,-5376.84"/>
<polygon fill="black" stroke="black" points="7658.48,-5376.36 7654.6,-5366.5 7651.48,-5376.63 7658.48,-5376.36"/>
<text text-anchor="middle" x="7720.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7720.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge868" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.34,-5434.23C9636.51,-5433.56 9639.67,-5432.97 9642.79,-5432.44 9668.36,-5428.16 10557.64,-5432.95 10575.79,-5414.44 10589.64,-5400.32 10586.82,-5384.65 10575.89,-5369.56"/>
<polygon fill="black" stroke="black" points="10578.52,-5367.25 10569.48,-5361.72 10573.1,-5371.68 10578.52,-5367.25"/>
<text text-anchor="middle" x="10634.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10634.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→11</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge869" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.23,-5460.44C9300.14,-5452.69 9000.76,-5438.1 8746.79,-5432.44 8726.12,-5431.98 2805.46,-5429.02 2790.79,-5414.44 2780.69,-5404.4 2776.17,-5391.02 2774.89,-5376.94"/>
<polygon fill="black" stroke="black" points="2778.37,-5376.47 2774.49,-5366.61 2771.38,-5376.74 2778.37,-5376.47"/>
<text text-anchor="middle" x="2840.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2840.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge870" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.23,-5460.53C9300.13,-5452.9 9000.75,-5438.47 8746.79,-5432.44 8725.77,-5431.94 5733.68,-5429.29 5718.79,-5414.44 5708.71,-5404.39 5704.19,-5390.99 5702.91,-5376.92"/>
<polygon fill="black" stroke="black" points="5706.39,-5376.45 5702.52,-5366.59 5699.4,-5376.71 5706.39,-5376.45"/>
<text text-anchor="middle" x="5768.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5768.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→13</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge871" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.23,-5460.43C9300.14,-5452.66 9000.76,-5438.05 8746.79,-5432.44 8723.15,-5431.92 1953.56,-5431.11 1936.79,-5414.44 1926.69,-5404.4 1922.16,-5391.02 1920.88,-5376.95"/>
<polygon fill="black" stroke="black" points="1924.37,-5376.47 1920.49,-5366.61 1917.37,-5376.74 1924.37,-5376.47"/>
<text text-anchor="middle" x="1986.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1986.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer2_expert2_2&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge872" class="edge">
<title>layer2_expert2_2&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9633.33,-5434.16C9636.51,-5433.52 9639.67,-5432.94 9642.79,-5432.44 9682.66,-5426.09 15427.29,-5443.03 15455.79,-5414.44 15469.84,-5400.35 15466.94,-5384.64 15455.87,-5369.47"/>
<polygon fill="black" stroke="black" points="15458.45,-5367.09 15449.38,-5361.6 15453.04,-5371.54 15458.45,-5367.09"/>
<text text-anchor="middle" x="15514.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15514.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 4→15</text>
</g>
<!-- layer2_expert_gelu_3 -->
<g id="node321" class="node">
<title>layer2_expert_gelu_3</title>
<ellipse fill="lightgray" stroke="black" cx="7162.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7162.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="7162.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7162.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_expert1_3&#45;&gt;layer2_expert_gelu_3 -->
<g id="edge815" class="edge">
<title>layer2_expert1_3&#45;&gt;layer2_expert_gelu_3</title>
<path fill="none" stroke="black" d="M6184.47,-5673.45C6373.62,-5654.6 6814.04,-5610.69 7033.59,-5588.8"/>
<polygon fill="black" stroke="black" points="7033.95,-5592.28 7043.55,-5587.81 7033.25,-5585.32 7033.95,-5592.28"/>
</g>
<!-- layer2_expert2_3 -->
<g id="node322" class="node">
<title>layer2_expert2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="8534.29,-5500.44 8349.29,-5500.44 8349.29,-5432.44 8534.29,-5432.44 8534.29,-5500.44"/>
<text text-anchor="middle" x="8441.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 3 Second Linear</text>
<text text-anchor="middle" x="8441.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8441.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8441.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_3&#45;&gt;layer2_expert2_3 -->
<g id="edge816" class="edge">
<title>layer2_expert_gelu_3&#45;&gt;layer2_expert2_3</title>
<path fill="none" stroke="black" d="M7288.58,-5570.1C7545.5,-5561.66 8123.73,-5539.16 8339.04,-5500.58"/>
<polygon fill="black" stroke="black" points="8339.82,-5504 8349.02,-5498.73 8338.55,-5497.11 8339.82,-5504"/>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge873" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.94C8346.28,-5433.38 8343.52,-5432.88 8340.79,-5432.44 8307.76,-5427.12 3546.41,-5438.15 3522.79,-5414.44 3488.09,-5379.61 3523.18,-5354.05 3576.46,-5336.02"/>
<polygon fill="black" stroke="black" points="3577.8,-5339.27 3586.24,-5332.86 3575.65,-5332.61 3577.8,-5339.27"/>
<text text-anchor="middle" x="3572.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3572.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge874" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8417.77,-5432.31C8409.64,-5416.8 8404.86,-5398.66 8414.79,-5384.44 8427.74,-5365.92 8445.2,-5351.44 8464.76,-5340.13"/>
<polygon fill="black" stroke="black" points="8466.48,-5343.18 8473.58,-5335.31 8463.13,-5337.04 8466.48,-5343.18"/>
<text text-anchor="middle" x="8464.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8464.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→1</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge875" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.96C8346.28,-5433.4 8343.52,-5432.89 8340.79,-5432.44 8314.89,-5428.19 6469.27,-5433.09 6450.79,-5414.44 6416.19,-5379.51 6451.3,-5353.93 6504.56,-5335.92"/>
<polygon fill="black" stroke="black" points="6505.9,-5339.16 6514.34,-5332.76 6503.75,-5332.5 6505.9,-5339.16"/>
<text text-anchor="middle" x="6500.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6500.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge876" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.18C8537.51,-5433.53 8540.67,-5432.95 8543.79,-5432.44 8581.69,-5426.34 11274.22,-5433.06 11307.79,-5414.44 11321.59,-5406.79 11315.8,-5395.77 11326.79,-5384.44 11332.69,-5378.36 11339.1,-5372.47 11345.79,-5366.81"/>
<polygon fill="black" stroke="black" points="11348.24,-5369.33 11353.75,-5360.28 11343.8,-5363.91 11348.24,-5369.33"/>
<text text-anchor="middle" x="11376.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11376.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→3</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge877" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.16C8537.51,-5433.52 8540.67,-5432.94 8543.79,-5432.44 8608.47,-5422.11 13202.47,-5446.13 13259.79,-5414.44 13273.6,-5406.81 13267.8,-5395.77 13278.79,-5384.44 13284.69,-5378.36 13291.1,-5372.47 13297.79,-5366.81"/>
<polygon fill="black" stroke="black" points="13300.24,-5369.33 13305.75,-5360.28 13295.8,-5363.91 13300.24,-5369.33"/>
<text text-anchor="middle" x="13328.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13328.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge878" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.34,-5434.24C8537.52,-5433.57 8540.67,-5432.97 8543.79,-5432.44 8588.28,-5424.92 9316.5,-5436.63 9355.79,-5414.44 9369.53,-5406.68 9363.8,-5395.77 9374.79,-5384.44 9380.69,-5378.36 9387.1,-5372.47 9393.79,-5366.81"/>
<polygon fill="black" stroke="black" points="9396.24,-5369.33 9401.75,-5360.28 9391.8,-5363.91 9396.24,-5369.33"/>
<text text-anchor="middle" x="9424.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9424.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→5</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge879" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.94C8346.28,-5433.39 8343.52,-5432.88 8340.79,-5432.44 8314.45,-5428.19 4517.61,-5433.35 4498.79,-5414.44 4464.11,-5379.6 4499.2,-5354.03 4552.48,-5336.01"/>
<polygon fill="black" stroke="black" points="4553.82,-5339.25 4562.26,-5332.84 4551.67,-5332.59 4553.82,-5339.25"/>
<text text-anchor="middle" x="4548.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4548.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge880" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.16C8537.51,-5433.52 8540.67,-5432.94 8543.79,-5432.44 8596.22,-5424.11 16141.32,-5440.09 16187.79,-5414.44 16201.61,-5406.82 16195.8,-5395.77 16206.79,-5384.44 16212.69,-5378.36 16219.1,-5372.47 16225.79,-5366.81"/>
<polygon fill="black" stroke="black" points="16228.24,-5369.33 16233.75,-5360.28 16223.8,-5363.91 16228.24,-5369.33"/>
<text text-anchor="middle" x="16256.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16256.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→7</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge881" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.16C8537.51,-5433.52 8540.67,-5432.94 8543.79,-5432.44 8582.83,-5426.22 14201.19,-5433.56 14235.79,-5414.44 14249.61,-5406.81 14243.8,-5395.77 14254.79,-5384.44 14260.69,-5378.36 14267.1,-5372.47 14273.79,-5366.81"/>
<polygon fill="black" stroke="black" points="14276.24,-5369.33 14281.75,-5360.28 14271.8,-5363.91 14276.24,-5369.33"/>
<text text-anchor="middle" x="14304.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14304.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge882" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.17C8537.51,-5433.52 8540.67,-5432.94 8543.79,-5432.44 8595.08,-5424.23 12238.34,-5439.6 12283.79,-5414.44 12297.6,-5406.8 12291.8,-5395.77 12302.79,-5384.44 12308.69,-5378.36 12315.1,-5372.47 12321.79,-5366.81"/>
<polygon fill="black" stroke="black" points="12324.24,-5369.33 12329.75,-5360.28 12319.8,-5363.91 12324.24,-5369.33"/>
<text text-anchor="middle" x="12352.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12352.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→9</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge883" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.04,-5434C8346.27,-5433.43 8343.52,-5432.9 8340.79,-5432.44 8315.75,-5428.2 7444.57,-5432.57 7426.79,-5414.44 7392.45,-5379.41 7427.35,-5353.84 7480.39,-5335.86"/>
<polygon fill="black" stroke="black" points="7481.7,-5339.11 7490.13,-5332.7 7479.54,-5332.45 7481.7,-5339.11"/>
<text text-anchor="middle" x="7476.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7476.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge884" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.34,-5434.19C8537.51,-5433.54 8540.67,-5432.95 8543.79,-5432.44 8592.81,-5424.46 10288.4,-5438.61 10331.79,-5414.44 10345.58,-5406.76 10339.8,-5395.77 10350.79,-5384.44 10356.69,-5378.36 10363.1,-5372.47 10369.79,-5366.81"/>
<polygon fill="black" stroke="black" points="10372.24,-5369.33 10377.75,-5360.28 10367.8,-5363.91 10372.24,-5369.33"/>
<text text-anchor="middle" x="10400.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10400.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→11</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge885" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.94C8346.28,-5433.38 8343.52,-5432.88 8340.79,-5432.44 8301.07,-5426.05 2575.2,-5442.94 2546.79,-5414.44 2512.08,-5379.62 2547.16,-5354.06 2600.45,-5336.03"/>
<polygon fill="black" stroke="black" points="2601.79,-5339.28 2610.23,-5332.87 2599.64,-5332.62 2601.79,-5339.28"/>
<text text-anchor="middle" x="2596.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2596.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge886" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.95C8346.28,-5433.39 8343.52,-5432.89 8340.79,-5432.44 8301.5,-5426.06 5502.85,-5442.68 5474.79,-5414.44 5440.14,-5379.57 5475.23,-5353.99 5528.5,-5335.98"/>
<polygon fill="black" stroke="black" points="5529.85,-5339.22 5538.29,-5332.81 5527.69,-5332.56 5529.85,-5339.22"/>
<text text-anchor="middle" x="5524.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5524.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→13</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge887" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8349.05,-5433.94C8346.28,-5433.38 8343.52,-5432.88 8340.79,-5432.44 8318,-5428.78 1709.09,-5430.79 1692.79,-5414.44 1658.07,-5379.63 1693.16,-5354.07 1746.44,-5336.04"/>
<polygon fill="black" stroke="black" points="1747.79,-5339.28 1756.22,-5332.87 1745.63,-5332.62 1747.79,-5339.28"/>
<text text-anchor="middle" x="1742.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1742.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer2_expert2_3&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge888" class="edge">
<title>layer2_expert2_3&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8534.33,-5434.16C8537.51,-5433.52 8540.67,-5432.94 8543.79,-5432.44 8589.52,-5425.17 15171.25,-5436.82 15211.79,-5414.44 15225.61,-5406.81 15219.8,-5395.77 15230.79,-5384.44 15236.69,-5378.36 15243.1,-5372.47 15249.79,-5366.81"/>
<polygon fill="black" stroke="black" points="15252.24,-5369.33 15257.75,-5360.28 15247.8,-5363.91 15252.24,-5369.33"/>
<text text-anchor="middle" x="15280.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15280.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 6→15</text>
</g>
<!-- layer2_expert_gelu_4 -->
<g id="node324" class="node">
<title>layer2_expert_gelu_4</title>
<ellipse fill="lightgray" stroke="black" cx="11810.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="11810.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="11810.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11810.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert1_4&#45;&gt;layer2_expert_gelu_4 -->
<g id="edge817" class="edge">
<title>layer2_expert1_4&#45;&gt;layer2_expert_gelu_4</title>
<path fill="none" stroke="black" d="M15011.09,-5679.49C14555.45,-5664.75 12497.64,-5598.15 11946.78,-5580.32"/>
<polygon fill="black" stroke="black" points="11946.52,-5576.81 11936.41,-5579.98 11946.29,-5583.81 11946.52,-5576.81"/>
</g>
<!-- layer2_expert2_4 -->
<g id="node325" class="node">
<title>layer2_expert2_4</title>
<polygon fill="lightsteelblue" stroke="black" points="11056.29,-5500.44 10871.29,-5500.44 10871.29,-5432.44 11056.29,-5432.44 11056.29,-5500.44"/>
<text text-anchor="middle" x="10963.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 4 Second Linear</text>
<text text-anchor="middle" x="10963.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10963.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10963.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_4&#45;&gt;layer2_expert2_4 -->
<g id="edge818" class="edge">
<title>layer2_expert_gelu_4&#45;&gt;layer2_expert2_4</title>
<path fill="none" stroke="black" d="M11695.71,-5559.1C11643.8,-5552.44 11581.71,-5544.5 11525.79,-5537.44 11365.53,-5517.21 11179.5,-5494.11 11066.79,-5480.16"/>
<polygon fill="black" stroke="black" points="11067.14,-5476.68 11056.78,-5478.93 11066.28,-5483.63 11067.14,-5476.68"/>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge889" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.11C10706.16,-5453.61 10349.76,-5438.42 10048.79,-5432.44 9980.37,-5431.08 5186.09,-5437.86 5121.79,-5414.44 5102.22,-5407.32 5105.26,-5391.85 5085.79,-5384.44 5029.07,-5362.84 4600.38,-5370.04 4539.79,-5366.44 4345.97,-5354.93 4125.37,-5335.32 3969.4,-5320.37"/>
<polygon fill="black" stroke="black" points="3969.51,-5316.87 3959.22,-5319.39 3968.84,-5323.83 3969.51,-5316.87"/>
<text text-anchor="middle" x="5171.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5171.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge890" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.02,-5464.98C10642.52,-5463.24 10065.52,-5454.83 9988.79,-5414.44 9973.92,-5406.62 9980.76,-5392.08 9965.79,-5384.44 9932.72,-5367.57 9334.84,-5368.83 9297.79,-5366.44 9147.15,-5356.74 8977.54,-5339.23 8849.07,-5324.61"/>
<polygon fill="black" stroke="black" points="8849.45,-5321.13 8839.12,-5323.47 8848.66,-5328.08 8849.45,-5321.13"/>
<text text-anchor="middle" x="10038.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10038.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→1</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge891" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.28C10706.15,-5454.02 10349.74,-5439.21 10048.79,-5432.44 10020.8,-5431.81 8057.26,-5428.05 8032.79,-5414.44 8019,-5406.77 8027.49,-5392.28 8013.79,-5384.44 7987.45,-5369.37 7498.09,-5368.24 7467.79,-5366.44 7273.97,-5354.93 7053.37,-5335.32 6897.4,-5320.37"/>
<polygon fill="black" stroke="black" points="6897.51,-5316.87 6887.22,-5319.39 6896.84,-5323.83 6897.51,-5316.87"/>
<text text-anchor="middle" x="8082.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8082.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge892" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.45,-5464.73C11437,-5461.61 12861.38,-5447.72 12893.79,-5414.44 12903.09,-5404.89 12903.09,-5394 12893.79,-5384.44 12880.84,-5371.14 12244.32,-5367.49 12225.79,-5366.44 12031.93,-5355.51 11811.34,-5335.83 11655.38,-5320.71"/>
<polygon fill="black" stroke="black" points="11655.49,-5317.2 11645.2,-5319.72 11654.82,-5324.17 11655.49,-5317.2"/>
<text text-anchor="middle" x="12949.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12949.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→3</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge893" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.47,-5465.11C11642.59,-5462.89 14811.42,-5449.27 14845.79,-5414.44 14855.16,-5404.95 14855.09,-5394 14845.79,-5384.44 14832.84,-5371.14 14196.32,-5367.49 14177.79,-5366.44 13983.93,-5355.51 13763.34,-5335.83 13607.38,-5320.71"/>
<polygon fill="black" stroke="black" points="13607.49,-5317.2 13597.2,-5319.72 13606.82,-5324.17 13607.49,-5317.2"/>
<text text-anchor="middle" x="14901.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14901.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge894" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10962.36,-5432.26C10959.75,-5415.14 10953.44,-5395.56 10938.79,-5384.44 10909.35,-5362.1 10310.69,-5368.53 10273.79,-5366.44 10079.94,-5355.5 9859.34,-5335.82 9703.38,-5320.7"/>
<polygon fill="black" stroke="black" points="9703.49,-5317.19 9693.2,-5319.71 9702.82,-5324.16 9703.49,-5317.19"/>
<text text-anchor="middle" x="11007.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11007.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→5</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge895" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.14C10706.16,-5453.68 10349.75,-5438.55 10048.79,-5432.44 9993.91,-5431.33 6148.23,-5433.6 6096.79,-5414.44 6077.59,-5407.29 6080.89,-5391.87 6061.79,-5384.44 6005.22,-5362.45 5576.38,-5370.04 5515.79,-5366.44 5321.97,-5354.93 5101.37,-5335.32 4945.4,-5320.37"/>
<polygon fill="black" stroke="black" points="4945.51,-5316.87 4935.22,-5319.39 4944.84,-5323.83 4945.51,-5316.87"/>
<text text-anchor="middle" x="6146.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6146.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge896" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.56,-5465.54C11806.71,-5466.21 16853.99,-5468.71 16907.79,-5414.44 16965.53,-5356.2 16723.25,-5325.93 16535.21,-5311.48"/>
<polygon fill="black" stroke="black" points="16535.4,-5307.99 16525.17,-5310.72 16534.88,-5314.97 16535.4,-5307.99"/>
<text text-anchor="middle" x="16965.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16965.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→7</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge897" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.42,-5465.36C11724.21,-5464.64 15778.24,-5458.45 15821.79,-5414.44 15831.17,-5404.96 15831.09,-5394 15821.79,-5384.44 15808.84,-5371.14 15172.32,-5367.49 15153.79,-5366.44 14959.93,-5355.51 14739.34,-5335.83 14583.38,-5320.71"/>
<polygon fill="black" stroke="black" points="14583.49,-5317.2 14573.2,-5319.72 14582.82,-5324.17 14583.49,-5317.2"/>
<text text-anchor="middle" x="15878.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15878.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge898" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.65,-5465.58C11547.48,-5466.12 13819.33,-5465.8 13869.79,-5414.44 13879.14,-5404.93 13879.09,-5394 13869.79,-5384.44 13856.84,-5371.14 13220.32,-5367.49 13201.79,-5366.44 13007.93,-5355.51 12787.34,-5335.83 12631.38,-5320.71"/>
<polygon fill="black" stroke="black" points="12631.49,-5317.2 12621.2,-5319.72 12630.82,-5324.17 12631.49,-5317.2"/>
<text text-anchor="middle" x="13925.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13925.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→9</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge899" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.27,-5461.53C10706.13,-5454.68 10349.71,-5440.47 10048.79,-5432.44 10019.91,-5431.67 9033.98,-5428.59 9008.79,-5414.44 8995.03,-5406.71 9003.49,-5392.28 8989.79,-5384.44 8963.45,-5369.37 8474.09,-5368.24 8443.79,-5366.44 8249.97,-5354.93 8029.37,-5335.32 7873.4,-5320.37"/>
<polygon fill="black" stroke="black" points="7873.51,-5316.87 7863.22,-5319.39 7872.84,-5323.83 7873.51,-5316.87"/>
<text text-anchor="middle" x="9058.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9058.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge900" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.67,-5463.89C11290.76,-5459.52 11888.46,-5445.38 11917.79,-5414.44 11926.96,-5404.77 11927.09,-5394 11917.79,-5384.44 11904.84,-5371.14 11268.32,-5367.49 11249.79,-5366.44 11055.93,-5355.51 10835.34,-5335.83 10679.38,-5320.71"/>
<polygon fill="black" stroke="black" points="10679.49,-5317.2 10669.2,-5319.72 10678.82,-5324.17 10679.49,-5317.2"/>
<text text-anchor="middle" x="11973.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11973.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→11</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge901" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.1C10706.16,-5453.56 10349.76,-5438.33 10048.79,-5432.44 10007.81,-5431.64 4184.31,-5428.46 4145.79,-5414.44 4126.22,-5407.32 4129.26,-5391.85 4109.79,-5384.44 4053.07,-5362.84 3624.38,-5370.04 3563.79,-5366.44 3369.97,-5354.93 3149.37,-5335.32 2993.4,-5320.37"/>
<polygon fill="black" stroke="black" points="2993.51,-5316.87 2983.22,-5319.39 2992.84,-5323.83 2993.51,-5316.87"/>
<text text-anchor="middle" x="4195.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4195.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge902" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.19C10706.15,-5453.8 10349.75,-5438.78 10048.79,-5432.44 10007.47,-5431.57 7111.51,-5428.9 7072.79,-5414.44 7053.6,-5407.28 7056.89,-5391.87 7037.79,-5384.44 6981.22,-5362.45 6552.38,-5370.04 6491.79,-5366.44 6297.97,-5354.93 6077.37,-5335.32 5921.4,-5320.37"/>
<polygon fill="black" stroke="black" points="5921.51,-5316.87 5911.22,-5319.39 5920.84,-5323.83 5921.51,-5316.87"/>
<text text-anchor="middle" x="7122.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7122.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→13</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge903" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10871.28,-5461.08C10706.16,-5453.53 10349.76,-5438.26 10048.79,-5432.44 10001.03,-5431.52 3214.69,-5430.76 3169.79,-5414.44 3150.22,-5407.33 3153.26,-5391.85 3133.79,-5384.44 3077.07,-5362.84 2648.35,-5370.53 2587.79,-5366.44 2437.18,-5356.29 2267.57,-5338.79 2139.09,-5324.29"/>
<polygon fill="black" stroke="black" points="2139.47,-5320.81 2129.14,-5323.16 2138.68,-5327.77 2139.47,-5320.81"/>
<text text-anchor="middle" x="3219.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3219.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer2_expert2_4&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge904" class="edge">
<title>layer2_expert2_4&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11056.31,-5465.52C11797.64,-5466.06 16745.02,-5467.68 16797.79,-5414.44 16807.18,-5404.97 16807.09,-5394 16797.79,-5384.44 16784.84,-5371.14 16148.32,-5367.49 16129.79,-5366.44 15935.93,-5355.51 15715.34,-5335.83 15559.38,-5320.71"/>
<polygon fill="black" stroke="black" points="15559.49,-5317.2 15549.2,-5319.72 15558.82,-5324.17 15559.49,-5317.2"/>
<text text-anchor="middle" x="16854.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16854.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 8→15</text>
</g>
<!-- layer2_expert_gelu_5 -->
<g id="node327" class="node">
<title>layer2_expert_gelu_5</title>
<ellipse fill="lightgray" stroke="black" cx="11389.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="11389.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="11389.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11389.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert1_5&#45;&gt;layer2_expert_gelu_5 -->
<g id="edge819" class="edge">
<title>layer2_expert1_5&#45;&gt;layer2_expert_gelu_5</title>
<path fill="none" stroke="black" d="M13187.15,-5681.38C12943.6,-5677.99 12249.43,-5664.18 11674.79,-5612.4 11621.34,-5607.58 11562.49,-5600.37 11512.21,-5593.63"/>
<polygon fill="black" stroke="black" points="11512.65,-5590.16 11502.27,-5592.29 11511.71,-5597.09 11512.65,-5590.16"/>
</g>
<!-- layer2_expert2_5 -->
<g id="node328" class="node">
<title>layer2_expert2_5</title>
<polygon fill="lightsteelblue" stroke="black" points="10039.29,-5500.44 9854.29,-5500.44 9854.29,-5432.44 10039.29,-5432.44 10039.29,-5500.44"/>
<text text-anchor="middle" x="9946.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 5 Second Linear</text>
<text text-anchor="middle" x="9946.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9946.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9946.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_5&#45;&gt;layer2_expert2_5 -->
<g id="edge820" class="edge">
<title>layer2_expert_gelu_5&#45;&gt;layer2_expert2_5</title>
<path fill="none" stroke="black" d="M11269.07,-5563.36C11181.57,-5555.82 11060.39,-5545.61 10953.79,-5537.44 10623.45,-5512.14 10231.84,-5486.04 10049.6,-5474.11"/>
<polygon fill="black" stroke="black" points="10049.7,-5470.61 10039.49,-5473.45 10049.25,-5477.59 10049.7,-5470.61"/>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge905" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.94C9851.28,-5433.38 9848.52,-5432.88 9845.79,-5432.44 9805.78,-5426.01 4047.1,-5432.43 4010.79,-5414.44 3995.74,-5406.99 4001.26,-5394.48 3987.79,-5384.44 3968.39,-5369.99 3946.22,-5357.72 3923.57,-5347.39"/>
<polygon fill="black" stroke="black" points="3924.75,-5344.09 3914.19,-5343.24 3921.91,-5350.49 3924.75,-5344.09"/>
<text text-anchor="middle" x="4060.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4060.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge906" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.99C9851.28,-5433.42 9848.52,-5432.9 9845.79,-5432.44 9793.47,-5423.6 8938.16,-5438.37 8890.79,-5414.44 8875.8,-5406.87 8881.26,-5394.48 8867.79,-5384.44 8848.39,-5369.99 8826.22,-5357.72 8803.57,-5347.39"/>
<polygon fill="black" stroke="black" points="8804.75,-5344.09 8794.19,-5343.24 8801.91,-5350.49 8804.75,-5344.09"/>
<text text-anchor="middle" x="8940.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8940.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→1</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge907" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.95C9851.28,-5433.39 9848.52,-5432.89 9845.79,-5432.44 9805.94,-5425.97 6974.94,-5432.42 6938.79,-5414.44 6923.75,-5406.96 6929.26,-5394.48 6915.79,-5384.44 6896.39,-5369.99 6874.22,-5357.72 6851.57,-5347.39"/>
<polygon fill="black" stroke="black" points="6852.75,-5344.09 6842.19,-5343.24 6849.91,-5350.49 6852.75,-5344.09"/>
<text text-anchor="middle" x="6988.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6988.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge908" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.41,-5461.59C10204.74,-5454.84 10561.55,-5440.77 10862.79,-5432.44 10888.7,-5431.73 11777.64,-5432.95 11795.79,-5414.44 11854.24,-5354.86 11759.85,-5326.27 11655.27,-5312.56"/>
<polygon fill="black" stroke="black" points="11655.48,-5309.06 11645.12,-5311.28 11654.61,-5316 11655.48,-5309.06"/>
<text text-anchor="middle" x="11861.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11861.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→3</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge909" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.41,-5461.19C10204.71,-5453.81 10561.5,-5438.81 10862.79,-5432.44 10882.82,-5432.02 13733.67,-5428.65 13747.79,-5414.44 13806.68,-5355.19 13712.05,-5326.59 13607.25,-5312.79"/>
<polygon fill="black" stroke="black" points="13607.45,-5309.29 13597.08,-5311.5 13606.56,-5316.23 13607.45,-5309.29"/>
<text text-anchor="middle" x="13813.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13813.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge910" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9892.87,-5432.25C9884.04,-5426.48 9875.08,-5420.41 9866.79,-5414.44 9849.62,-5402.07 9848.7,-5393.96 9829.79,-5384.44 9787.12,-5362.98 9738.54,-5346.65 9692.01,-5334.35"/>
<polygon fill="black" stroke="black" points="9692.68,-5330.9 9682.12,-5331.78 9690.92,-5337.68 9692.68,-5330.9"/>
<text text-anchor="middle" x="9916.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9916.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→5</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge911" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.94C9851.28,-5433.38 9848.52,-5432.88 9845.79,-5432.44 9779.16,-5421.71 5047.26,-5444.42 4986.79,-5414.44 4971.74,-5406.98 4977.26,-5394.48 4963.79,-5384.44 4944.39,-5369.99 4922.22,-5357.72 4899.57,-5347.39"/>
<polygon fill="black" stroke="black" points="4900.75,-5344.09 4890.19,-5343.24 4897.91,-5350.49 4900.75,-5344.09"/>
<text text-anchor="middle" x="5036.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5036.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge912" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.4,-5461.1C10204.71,-5453.57 10561.49,-5438.33 10862.79,-5432.44 10882.97,-5432.05 16661.54,-5428.74 16675.79,-5414.44 16734.83,-5355.23 16639.97,-5326.63 16535.03,-5312.82"/>
<polygon fill="black" stroke="black" points="16535.21,-5309.31 16524.85,-5311.52 16534.33,-5316.25 16535.21,-5309.31"/>
<text text-anchor="middle" x="16741.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16741.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→7</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge913" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.4,-5461.15C10204.71,-5453.69 10561.5,-5438.57 10862.79,-5432.44 10889.6,-5431.9 14704.88,-5433.45 14723.79,-5414.44 14782.73,-5355.23 14688.09,-5326.63 14583.29,-5312.82"/>
<polygon fill="black" stroke="black" points="14583.48,-5309.32 14573.12,-5311.53 14582.6,-5316.26 14583.48,-5309.32"/>
<text text-anchor="middle" x="14789.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14789.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge914" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.41,-5461.29C10204.72,-5454.06 10561.51,-5439.29 10862.79,-5432.44 10889.3,-5431.84 12753.13,-5433.28 12771.79,-5414.44 12830.58,-5355.09 12735.96,-5326.5 12631.19,-5312.72"/>
<polygon fill="black" stroke="black" points="12631.38,-5309.22 12621.02,-5311.44 12630.5,-5316.17 12631.38,-5309.22"/>
<text text-anchor="middle" x="12837.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12837.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→9</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge915" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.96C9851.28,-5433.4 9848.52,-5432.89 9845.79,-5432.44 9792.86,-5423.76 7962.78,-5438.4 7914.79,-5414.44 7899.76,-5406.94 7905.26,-5394.48 7891.79,-5384.44 7872.39,-5369.99 7850.22,-5357.72 7827.57,-5347.39"/>
<polygon fill="black" stroke="black" points="7828.75,-5344.09 7818.19,-5343.24 7825.91,-5350.49 7828.75,-5344.09"/>
<text text-anchor="middle" x="7964.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7964.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge916" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.34,-5463.41C10258.59,-5458.15 10793.32,-5442.5 10819.79,-5414.44 10876.96,-5353.84 10783.06,-5325.29 10679.02,-5311.85"/>
<polygon fill="black" stroke="black" points="10679.28,-5308.35 10668.93,-5310.59 10678.42,-5315.3 10679.28,-5308.35"/>
<text text-anchor="middle" x="10885.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10885.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→11</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge917" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.94C9851.28,-5433.38 9848.52,-5432.88 9845.79,-5432.44 9799.09,-5424.94 3077.18,-5435.43 3034.79,-5414.44 3019.73,-5406.99 3025.26,-5394.48 3011.79,-5384.44 2992.39,-5369.99 2970.22,-5357.72 2947.57,-5347.39"/>
<polygon fill="black" stroke="black" points="2948.75,-5344.09 2938.19,-5343.24 2945.91,-5350.49 2948.75,-5344.09"/>
<text text-anchor="middle" x="3084.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3084.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge918" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.94C9851.28,-5433.39 9848.52,-5432.88 9845.79,-5432.44 9792.55,-5423.84 6011.1,-5438.42 5962.79,-5414.44 5947.74,-5406.97 5953.26,-5394.48 5939.79,-5384.44 5920.39,-5369.99 5898.22,-5357.72 5875.57,-5347.39"/>
<polygon fill="black" stroke="black" points="5876.75,-5344.09 5866.19,-5343.24 5873.91,-5350.49 5876.75,-5344.09"/>
<text text-anchor="middle" x="6012.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6012.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→13</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge919" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9854.05,-5433.93C9851.28,-5433.38 9848.52,-5432.88 9845.79,-5432.44 9740.86,-5415.61 2293.68,-5450.74 2193.79,-5414.44 2174.22,-5407.33 2175.77,-5394.96 2157.79,-5384.44 2135.54,-5371.43 2110.91,-5359.73 2086.41,-5349.48"/>
<polygon fill="black" stroke="black" points="2087.6,-5346.18 2077.02,-5345.62 2084.94,-5352.66 2087.6,-5346.18"/>
<text text-anchor="middle" x="2243.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2243.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer2_expert2_5&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge920" class="edge">
<title>layer2_expert2_5&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10039.4,-5461.12C10204.71,-5453.62 10561.5,-5438.43 10862.79,-5432.44 10879.58,-5432.11 15687.94,-5426.34 15699.79,-5414.44 15758.81,-5355.21 15663.95,-5326.61 15559.02,-5312.8"/>
<polygon fill="black" stroke="black" points="15559.2,-5309.3 15548.84,-5311.51 15558.32,-5316.24 15559.2,-5309.3"/>
<text text-anchor="middle" x="15765.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15765.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 10→15</text>
</g>
<!-- layer2_expert_gelu_6 -->
<g id="node330" class="node">
<title>layer2_expert_gelu_6</title>
<ellipse fill="lightgray" stroke="black" cx="3639.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="3639.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="3639.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3639.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert1_6&#45;&gt;layer2_expert_gelu_6 -->
<g id="edge821" class="edge">
<title>layer2_expert1_6&#45;&gt;layer2_expert_gelu_6</title>
<path fill="none" stroke="black" d="M2650.47,-5673.55C2841.35,-5654.71 3288.46,-5610.59 3510.28,-5588.7"/>
<polygon fill="black" stroke="black" points="3510.74,-5592.17 3520.34,-5587.71 3510.05,-5585.21 3510.74,-5592.17"/>
</g>
<!-- layer2_expert2_6 -->
<g id="node331" class="node">
<title>layer2_expert2_6</title>
<polygon fill="lightsteelblue" stroke="black" points="8128.29,-5500.44 7943.29,-5500.44 7943.29,-5432.44 8128.29,-5432.44 8128.29,-5500.44"/>
<text text-anchor="middle" x="8035.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 6 Second Linear</text>
<text text-anchor="middle" x="8035.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8035.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8035.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_6&#45;&gt;layer2_expert2_6 -->
<g id="edge822" class="edge">
<title>layer2_expert_gelu_6&#45;&gt;layer2_expert2_6</title>
<path fill="none" stroke="black" d="M3765.73,-5570.87C4411.55,-5555.23 7344.14,-5484.19 7932.73,-5469.94"/>
<polygon fill="black" stroke="black" points="7932.98,-5473.43 7942.89,-5469.69 7932.81,-5466.44 7932.98,-5473.43"/>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge921" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.26,-5465.34C7283.8,-5464.47 3321.39,-5457.5 3278.79,-5414.44 3269.41,-5404.96 3270.21,-5394.64 3278.79,-5384.44 3315.56,-5340.74 3445.78,-5319.63 3562.31,-5309.44"/>
<polygon fill="black" stroke="black" points="3562.8,-5312.91 3572.46,-5308.57 3562.2,-5305.93 3562.8,-5312.91"/>
<text text-anchor="middle" x="3328.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3328.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge922" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8105.86,-5432.4C8116.13,-5426.79 8126.4,-5420.73 8135.79,-5414.44 8152.81,-5403.04 8152.28,-5393.21 8170.79,-5384.44 8254.98,-5344.57 8355.66,-5323.38 8442.63,-5312.18"/>
<polygon fill="black" stroke="black" points="8443.13,-5315.64 8452.62,-5310.93 8442.26,-5308.7 8443.13,-5315.64"/>
<text text-anchor="middle" x="8220.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8220.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→1</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge923" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.05,-5464.59C7575.19,-5461.02 6237.35,-5445.86 6206.79,-5414.44 6197.5,-5404.88 6198.21,-5394.64 6206.79,-5384.44 6243.56,-5340.74 6373.78,-5319.63 6490.31,-5309.44"/>
<polygon fill="black" stroke="black" points="6490.8,-5312.91 6500.46,-5308.57 6490.2,-5305.93 6490.8,-5312.91"/>
<text text-anchor="middle" x="6256.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6256.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge924" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.17C8131.51,-5433.53 8134.67,-5432.94 8137.79,-5432.44 8177.87,-5425.99 11024.63,-5432.9 11060.79,-5414.44 11075.52,-5406.92 11068.98,-5393.53 11082.79,-5384.44 11131.85,-5352.19 11191.6,-5332.15 11248.61,-5319.73"/>
<polygon fill="black" stroke="black" points="11249.41,-5323.14 11258.47,-5317.65 11247.97,-5316.29 11249.41,-5323.14"/>
<text text-anchor="middle" x="11132.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11132.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→3</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge925" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.16C8131.51,-5433.52 8134.67,-5432.94 8137.79,-5432.44 8204.52,-5421.79 12940,-5439.41 13002.79,-5414.44 13020.91,-5407.24 13017.58,-5393.6 13034.79,-5384.44 13085.55,-5357.42 13144.72,-5339 13200.62,-5326.45"/>
<polygon fill="black" stroke="black" points="13201.63,-5329.81 13210.65,-5324.25 13200.13,-5322.97 13201.63,-5329.81"/>
<text text-anchor="middle" x="13084.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13084.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge926" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.34,-5434.22C8131.51,-5433.56 8134.67,-5432.96 8137.79,-5432.44 8191.17,-5423.52 9064.62,-5440.97 9111.79,-5414.44 9125.55,-5406.71 9117.91,-5393.56 9130.79,-5384.44 9179.1,-5350.27 9239.08,-5329.67 9296.53,-5317.34"/>
<polygon fill="black" stroke="black" points="9297.4,-5320.73 9306.48,-5315.28 9295.98,-5313.88 9297.4,-5320.73"/>
<text text-anchor="middle" x="9180.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9180.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→5</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge927" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.21,-5465.07C7366.35,-5462.68 4288.22,-5448.32 4254.79,-5414.44 4245.43,-5404.95 4246.21,-5394.64 4254.79,-5384.44 4291.56,-5340.74 4421.78,-5319.63 4538.31,-5309.44"/>
<polygon fill="black" stroke="black" points="4538.8,-5312.91 4548.46,-5308.57 4538.2,-5305.93 4538.8,-5312.91"/>
<text text-anchor="middle" x="4304.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4304.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge928" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.16C8131.51,-5433.52 8134.67,-5432.94 8137.79,-5432.44 8191.25,-5423.95 15881.64,-5434.8 15931.79,-5414.44 15949.56,-5407.23 15945.94,-5393.59 15962.79,-5384.44 16013.34,-5357.02 16072.44,-5338.47 16128.34,-5325.93"/>
<polygon fill="black" stroke="black" points="16129.35,-5329.29 16138.37,-5323.73 16127.85,-5322.45 16129.35,-5329.29"/>
<text text-anchor="middle" x="16012.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16012.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→7</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge929" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.16C8131.51,-5433.52 8134.67,-5432.94 8137.79,-5432.44 8217.91,-5419.68 13903.4,-5444.39 13978.79,-5414.44 13996.91,-5407.25 13993.58,-5393.6 14010.79,-5384.44 14061.55,-5357.42 14120.72,-5339 14176.62,-5326.45"/>
<polygon fill="black" stroke="black" points="14177.63,-5329.81 14186.65,-5324.25 14176.13,-5322.97 14177.63,-5329.81"/>
<text text-anchor="middle" x="14060.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14060.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge930" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.17C8131.51,-5433.52 8134.67,-5432.94 8137.79,-5432.44 8191.13,-5423.9 11976.61,-5434.42 12026.79,-5414.44 12044.9,-5407.23 12041.58,-5393.6 12058.79,-5384.44 12109.55,-5357.42 12168.72,-5339 12224.62,-5326.45"/>
<polygon fill="black" stroke="black" points="12225.63,-5329.81 12234.65,-5324.25 12224.13,-5322.97 12225.63,-5329.81"/>
<text text-anchor="middle" x="12108.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12108.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→9</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge931" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7942.97,-5463.27C7727.28,-5457.78 7208.54,-5441.78 7182.79,-5414.44 7173.65,-5404.74 7174.21,-5394.64 7182.79,-5384.44 7219.56,-5340.74 7349.78,-5319.63 7466.31,-5309.44"/>
<polygon fill="black" stroke="black" points="7466.8,-5312.91 7476.46,-5308.57 7466.2,-5305.93 7466.8,-5312.91"/>
<text text-anchor="middle" x="7232.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7232.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge932" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.34,-5434.19C8131.51,-5433.54 8134.67,-5432.95 8137.79,-5432.44 8191.26,-5423.76 10040.46,-5440.78 10087.79,-5414.44 10101.58,-5406.77 10093.91,-5393.56 10106.79,-5384.44 10155.1,-5350.27 10215.08,-5329.67 10272.53,-5317.34"/>
<polygon fill="black" stroke="black" points="10273.4,-5320.73 10282.48,-5315.28 10271.98,-5313.88 10273.4,-5320.73"/>
<text text-anchor="middle" x="10156.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10156.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→11</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge933" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.14,-5465.51C7208.68,-5465.93 2354.6,-5466.72 2302.79,-5414.44 2293.41,-5404.97 2294.21,-5394.64 2302.79,-5384.44 2339.56,-5340.74 2469.78,-5319.63 2586.31,-5309.44"/>
<polygon fill="black" stroke="black" points="2586.8,-5312.91 2596.46,-5308.57 2586.2,-5305.93 2586.8,-5312.91"/>
<text text-anchor="middle" x="2352.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2352.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge934" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.03,-5465.52C7462.8,-5465.73 5279.38,-5463.92 5230.79,-5414.44 5221.45,-5404.93 5222.21,-5394.64 5230.79,-5384.44 5267.56,-5340.74 5397.78,-5319.63 5514.31,-5309.44"/>
<polygon fill="black" stroke="black" points="5514.8,-5312.91 5524.46,-5308.57 5514.2,-5305.93 5514.8,-5312.91"/>
<text text-anchor="middle" x="5280.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5280.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→13</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge935" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7943.12,-5465.17C7146.27,-5462.77 1478.75,-5444.63 1448.79,-5414.44 1439.4,-5404.98 1440.21,-5394.64 1448.79,-5384.44 1485.56,-5340.74 1615.78,-5319.63 1732.31,-5309.44"/>
<polygon fill="black" stroke="black" points="1732.8,-5312.91 1742.46,-5308.57 1732.2,-5305.93 1732.8,-5312.91"/>
<text text-anchor="middle" x="1498.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1498.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer2_expert2_6&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge936" class="edge">
<title>layer2_expert2_6&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8128.33,-5434.16C8131.51,-5433.52 8134.67,-5432.94 8137.79,-5432.44 8231.3,-5417.57 14866.79,-5449.38 14954.79,-5414.44 14972.91,-5407.25 14969.58,-5393.6 14986.79,-5384.44 15037.55,-5357.42 15096.72,-5339 15152.62,-5326.45"/>
<polygon fill="black" stroke="black" points="15153.63,-5329.81 15162.65,-5324.25 15152.13,-5322.97 15153.63,-5329.81"/>
<text text-anchor="middle" x="15036.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15036.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 12→15</text>
</g>
<!-- layer2_expert_gelu_7 -->
<g id="node333" class="node">
<title>layer2_expert_gelu_7</title>
<ellipse fill="lightgray" stroke="black" cx="10817.79" cy="-5574.92" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="10817.79" y="-5586.22" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="10817.79" y="-5571.22" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10817.79" y="-5556.22" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert1_7&#45;&gt;layer2_expert_gelu_7 -->
<g id="edge823" class="edge">
<title>layer2_expert1_7&#45;&gt;layer2_expert_gelu_7</title>
<path fill="none" stroke="black" d="M11363.16,-5667.37C11251.48,-5648.64 11060.32,-5616.59 10936.55,-5595.83"/>
<polygon fill="black" stroke="black" points="10937.09,-5592.37 10926.65,-5594.17 10935.93,-5599.28 10937.09,-5592.37"/>
</g>
<!-- layer2_expert2_7 -->
<g id="node334" class="node">
<title>layer2_expert2_7</title>
<polygon fill="lightsteelblue" stroke="black" points="9836.29,-5500.44 9651.29,-5500.44 9651.29,-5432.44 9836.29,-5432.44 9836.29,-5500.44"/>
<text text-anchor="middle" x="9743.79" y="-5485.24" font-family="Times,serif" font-size="14.00">Expert 7 Second Linear</text>
<text text-anchor="middle" x="9743.79" y="-5470.24" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9743.79" y="-5455.24" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9743.79" y="-5440.24" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer2_expert_gelu_7&#45;&gt;layer2_expert2_7 -->
<g id="edge824" class="edge">
<title>layer2_expert_gelu_7&#45;&gt;layer2_expert2_7</title>
<path fill="none" stroke="black" d="M10691.07,-5573.88C10506.31,-5571.71 10152.59,-5559.53 9846.34,-5500.37"/>
<polygon fill="black" stroke="black" points="9846.87,-5496.91 9836.38,-5498.43 9845.53,-5503.78 9846.87,-5496.91"/>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_0_0 -->
<g id="edge937" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.94C9648.28,-5433.38 9645.52,-5432.88 9642.79,-5432.44 9603.34,-5426.1 3924.6,-5432.18 3888.79,-5414.44 3873.74,-5406.98 3877.39,-5396.6 3865.79,-5384.44 3862.07,-5380.53 3858.17,-5376.62 3854.17,-5372.75"/>
<polygon fill="black" stroke="black" points="3856.53,-5370.16 3846.87,-5365.81 3851.71,-5375.23 3856.53,-5370.16"/>
<text text-anchor="middle" x="3938.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3938.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_0_1 -->
<g id="edge938" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.04,-5434C9648.27,-5433.43 9645.52,-5432.91 9642.79,-5432.44 9594.91,-5424.31 8812.12,-5436.38 8768.79,-5414.44 8753.8,-5406.85 8757.39,-5396.6 8745.79,-5384.44 8742.07,-5380.53 8738.17,-5376.62 8734.17,-5372.75"/>
<polygon fill="black" stroke="black" points="8736.53,-5370.16 8726.87,-5365.81 8731.71,-5375.23 8736.53,-5370.16"/>
<text text-anchor="middle" x="8818.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8818.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→1</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_0_2 -->
<g id="edge939" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.95C9648.28,-5433.39 9645.52,-5432.89 9642.79,-5432.44 9565.31,-5419.85 6887.08,-5449.4 6816.79,-5414.44 6801.75,-5406.96 6805.39,-5396.6 6793.79,-5384.44 6790.07,-5380.53 6786.17,-5376.62 6782.17,-5372.75"/>
<polygon fill="black" stroke="black" points="6784.53,-5370.16 6774.87,-5365.81 6779.71,-5375.23 6784.53,-5370.16"/>
<text text-anchor="middle" x="6866.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6866.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_0_3 -->
<g id="edge940" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.34,-5434.19C9839.51,-5433.54 9842.67,-5432.95 9845.79,-5432.44 9870.85,-5428.36 11655.93,-5432.48 11673.79,-5414.44 11704.97,-5382.95 11675.89,-5358.35 11629.68,-5340.16"/>
<polygon fill="black" stroke="black" points="11630.82,-5336.85 11620.23,-5336.61 11628.36,-5343.4 11630.82,-5336.85"/>
<text text-anchor="middle" x="11735.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11735.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→3</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_1_0 -->
<g id="edge941" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.33,-5434.17C9839.51,-5433.52 9842.67,-5432.94 9845.79,-5432.44 9871.71,-5428.29 13607.27,-5433.05 13625.79,-5414.44 13657.13,-5382.96 13627.85,-5358.34 13581.45,-5340.12"/>
<polygon fill="black" stroke="black" points="13582.55,-5336.8 13571.96,-5336.57 13580.09,-5343.35 13582.55,-5336.8"/>
<text text-anchor="middle" x="13688.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13688.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_1_1 -->
<g id="edge942" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9735.03,-5432.43C9729.29,-5416.2 9720.29,-5397.4 9706.79,-5384.44 9692.05,-5370.29 9674.62,-5358.39 9656.23,-5348.4"/>
<polygon fill="black" stroke="black" points="9657.62,-5345.18 9647.13,-5343.65 9654.38,-5351.38 9657.62,-5345.18"/>
<text text-anchor="middle" x="9776.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9776.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→5</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_1_2 -->
<g id="edge943" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.94C9648.28,-5433.38 9645.52,-5432.88 9642.79,-5432.44 9577.28,-5421.88 4924.25,-5443.92 4864.79,-5414.44 4849.74,-5406.98 4853.39,-5396.6 4841.79,-5384.44 4838.07,-5380.53 4834.17,-5376.62 4830.17,-5372.75"/>
<polygon fill="black" stroke="black" points="4832.53,-5370.16 4822.87,-5365.81 4827.71,-5375.23 4832.53,-5370.16"/>
<text text-anchor="middle" x="4914.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4914.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_1_3 -->
<g id="edge944" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.33,-5434.16C9839.51,-5433.52 9842.67,-5432.94 9845.79,-5432.44 9868.79,-5428.78 16537.34,-5430.93 16553.79,-5414.44 16585.16,-5382.99 16555.89,-5358.37 16509.49,-5340.16"/>
<polygon fill="black" stroke="black" points="16510.58,-5336.83 16499.99,-5336.6 16508.13,-5343.39 16510.58,-5336.83"/>
<text text-anchor="middle" x="16616.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16616.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→7</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_2_0 -->
<g id="edge945" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.33,-5434.16C9839.51,-5433.52 9842.67,-5432.94 9845.79,-5432.44 9878.41,-5427.23 14578.48,-5437.84 14601.79,-5414.44 14633.14,-5382.97 14603.87,-5358.35 14557.47,-5340.14"/>
<polygon fill="black" stroke="black" points="14558.56,-5336.81 14547.97,-5336.58 14556.11,-5343.37 14558.56,-5336.81"/>
<text text-anchor="middle" x="14664.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14664.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_2_1 -->
<g id="edge946" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.33,-5434.17C9839.51,-5433.53 9842.67,-5432.95 9845.79,-5432.44 9884.24,-5426.25 12622.34,-5442.07 12649.79,-5414.44 12681.1,-5382.93 12651.82,-5358.3 12605.42,-5340.09"/>
<polygon fill="black" stroke="black" points="12606.52,-5336.77 12595.93,-5336.54 12604.06,-5343.32 12606.52,-5336.77"/>
<text text-anchor="middle" x="12711.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12711.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→9</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_2_2 -->
<g id="edge947" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.96C9648.28,-5433.4 9645.52,-5432.89 9642.79,-5432.44 9592.08,-5424.11 7838.77,-5437.41 7792.79,-5414.44 7777.76,-5406.94 7781.39,-5396.6 7769.79,-5384.44 7766.07,-5380.53 7762.17,-5376.62 7758.17,-5372.75"/>
<polygon fill="black" stroke="black" points="7760.53,-5370.16 7750.87,-5365.81 7755.71,-5375.23 7760.53,-5370.16"/>
<text text-anchor="middle" x="7842.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7842.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_2_3 -->
<g id="edge948" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.34,-5434.23C9839.52,-5433.57 9842.67,-5432.97 9845.79,-5432.44 9869.13,-5428.51 10681.23,-5431.36 10697.79,-5414.44 10728.72,-5382.85 10699.81,-5358.26 10653.81,-5340.1"/>
<polygon fill="black" stroke="black" points="10654.98,-5336.8 10644.39,-5336.55 10652.52,-5343.35 10654.98,-5336.8"/>
<text text-anchor="middle" x="10759.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10759.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→11</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_3_0 -->
<g id="edge949" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.94C9648.28,-5433.38 9645.52,-5432.88 9642.79,-5432.44 9596.65,-5425.03 2954.68,-5435.18 2912.79,-5414.44 2897.73,-5406.99 2901.39,-5396.6 2889.79,-5384.44 2886.07,-5380.53 2882.17,-5376.62 2878.17,-5372.75"/>
<polygon fill="black" stroke="black" points="2880.53,-5370.16 2870.87,-5365.81 2875.71,-5375.23 2880.53,-5370.16"/>
<text text-anchor="middle" x="2962.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2962.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_3_1 -->
<g id="edge950" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.94C9648.28,-5433.39 9645.52,-5432.88 9642.79,-5432.44 9590.66,-5424.02 5888.09,-5437.92 5840.79,-5414.44 5825.74,-5406.97 5829.39,-5396.6 5817.79,-5384.44 5814.07,-5380.53 5810.17,-5376.62 5806.17,-5372.75"/>
<polygon fill="black" stroke="black" points="5808.53,-5370.16 5798.87,-5365.81 5803.71,-5375.23 5808.53,-5370.16"/>
<text text-anchor="middle" x="5890.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5890.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→13</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_3_2 -->
<g id="edge951" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9651.05,-5433.93C9648.28,-5433.38 9645.52,-5432.88 9642.79,-5432.44 9590.79,-5424.1 2105.99,-5437.8 2058.79,-5414.44 2043.73,-5406.99 2047.39,-5396.6 2035.79,-5384.44 2032.07,-5380.53 2028.17,-5376.62 2024.17,-5372.75"/>
<polygon fill="black" stroke="black" points="2026.53,-5370.16 2016.87,-5365.81 2021.71,-5375.23 2026.53,-5370.16"/>
<text text-anchor="middle" x="2108.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2108.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer2_expert2_7&#45;&gt;layer2_expert_agg_3_3 -->
<g id="edge952" class="edge">
<title>layer2_expert2_7&#45;&gt;layer2_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9836.33,-5434.16C9839.51,-5433.52 9842.67,-5432.94 9845.79,-5432.44 9885.1,-5426.18 15549.69,-5442.63 15577.79,-5414.44 15609.15,-5382.98 15579.88,-5358.37 15533.48,-5340.15"/>
<polygon fill="black" stroke="black" points="15534.57,-5336.82 15523.98,-5336.59 15532.12,-5343.38 15534.57,-5336.82"/>
<text text-anchor="middle" x="15640.29" y="-5403.24" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15640.29" y="-5388.24" font-family="Times,serif" font-size="14.00">GPU 14→15</text>
</g>
<!-- layer2_res2 -->
<g id="node351" class="node">
<title>layer2_res2</title>
<ellipse fill="lightpink" stroke="black" cx="8864.79" cy="-5048.73" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="8864.79" y="-5060.03" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="8864.79" y="-5045.03" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8864.79" y="-5030.03" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer2_expert_agg_0_0&#45;&gt;layer2_res2 -->
<g id="edge953" class="edge">
<title>layer2_expert_agg_0_0&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M3958.85,-5278.96C4115.33,-5264.17 4341.6,-5244.06 4539.79,-5231.39 6168.54,-5127.24 8146.3,-5069.06 8708.85,-5053.81"/>
<polygon fill="black" stroke="black" points="8709.16,-5057.3 8719.06,-5053.53 8708.97,-5050.31 8709.16,-5057.3"/>
</g>
<!-- layer2_expert_agg_0_1&#45;&gt;layer2_res2 -->
<g id="edge954" class="edge">
<title>layer2_expert_agg_0_1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M8704.77,-5231.08C8722.41,-5211.09 8742.29,-5188.55 8761.89,-5166.34"/>
<polygon fill="black" stroke="black" points="8764.53,-5168.64 8768.53,-5158.82 8759.29,-5164.01 8764.53,-5168.64"/>
</g>
<!-- layer2_expert_agg_0_2&#45;&gt;layer2_res2 -->
<g id="edge955" class="edge">
<title>layer2_expert_agg_0_2&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M6886.93,-5275.84C7312.19,-5227.22 8322.39,-5111.74 8709.84,-5067.44"/>
<polygon fill="black" stroke="black" points="8710.46,-5070.89 8720,-5066.28 8709.66,-5063.94 8710.46,-5070.89"/>
</g>
<!-- layer2_expert_agg_0_3&#45;&gt;layer2_res2 -->
<g id="edge956" class="edge">
<title>layer2_expert_agg_0_3&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M11258.67,-5279.39C10765.72,-5232.1 9468.24,-5107.62 9019.85,-5064.6"/>
<polygon fill="black" stroke="black" points="9020.03,-5061.1 9009.74,-5063.63 9019.36,-5068.07 9020.03,-5061.1"/>
</g>
<!-- layer2_expert_agg_1_0&#45;&gt;layer2_res2 -->
<g id="edge957" class="edge">
<title>layer2_expert_agg_1_0&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M13210.71,-5279.3C13054.22,-5264.69 12827.94,-5244.68 12629.79,-5231.39 11230.77,-5137.55 9536.15,-5073.53 9020.81,-5055.16"/>
<polygon fill="black" stroke="black" points="9020.82,-5051.65 9010.71,-5054.8 9020.57,-5058.65 9020.82,-5051.65"/>
</g>
<!-- layer2_expert_agg_1_1&#45;&gt;layer2_res2 -->
<g id="edge958" class="edge">
<title>layer2_expert_agg_1_1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M9371.67,-5247.84C9266.94,-5206.91 9118.9,-5149.04 9009.83,-5106.41"/>
<polygon fill="black" stroke="black" points="9010.98,-5103.11 9000.39,-5102.73 9008.43,-5109.63 9010.98,-5103.11"/>
</g>
<!-- layer2_expert_agg_1_2&#45;&gt;layer2_res2 -->
<g id="edge959" class="edge">
<title>layer2_expert_agg_1_2&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M4934.9,-5279.62C5091.4,-5265.2 5317.68,-5245.27 5515.79,-5231.39 6745.33,-5145.23 8231.28,-5077.35 8708.96,-5056.43"/>
<polygon fill="black" stroke="black" points="8709.19,-5059.92 8719.02,-5055.99 8708.88,-5052.93 8709.19,-5059.92"/>
</g>
<!-- layer2_expert_agg_1_3&#45;&gt;layer2_res2 -->
<g id="edge960" class="edge">
<title>layer2_expert_agg_1_3&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M16138.38,-5278.13C15981.95,-5262.88 15755.9,-5242.58 15557.79,-5231.39 12946.74,-5083.87 9755.68,-5055.33 9020.75,-5050.58"/>
<polygon fill="black" stroke="black" points="9020.66,-5047.08 9010.64,-5050.52 9020.61,-5054.08 9020.66,-5047.08"/>
</g>
<!-- layer2_expert_agg_2_0&#45;&gt;layer2_res2 -->
<g id="edge961" class="edge">
<title>layer2_expert_agg_2_0&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M14186.74,-5278.76C14030.27,-5263.86 13804.01,-5243.7 13605.79,-5231.39 11805.7,-5119.61 9616.58,-5066.15 9020.77,-5053.02"/>
<polygon fill="black" stroke="black" points="9020.48,-5049.51 9010.41,-5052.79 9020.33,-5056.51 9020.48,-5049.51"/>
</g>
<!-- layer2_expert_agg_2_1&#45;&gt;layer2_res2 -->
<g id="edge962" class="edge">
<title>layer2_expert_agg_2_1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M12234.65,-5280.2C12078.12,-5266.11 11851.82,-5246.35 11653.79,-5231.39 10650.99,-5155.65 9443.9,-5083.48 9020.57,-5058.74"/>
<polygon fill="black" stroke="black" points="9020.6,-5055.24 9010.41,-5058.15 9020.19,-5062.22 9020.6,-5055.24"/>
</g>
<!-- layer2_expert_agg_2_2&#45;&gt;layer2_res2 -->
<g id="edge963" class="edge">
<title>layer2_expert_agg_2_2&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M7841.01,-5262.36C8074.39,-5213.89 8488.82,-5127.81 8712.12,-5081.44"/>
<polygon fill="black" stroke="black" points="8712.87,-5084.85 8721.95,-5079.39 8711.45,-5078 8712.87,-5084.85"/>
</g>
<!-- layer2_expert_agg_2_3&#45;&gt;layer2_res2 -->
<g id="edge964" class="edge">
<title>layer2_expert_agg_2_3&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M10285.85,-5268.66C9963.3,-5218.96 9314.72,-5119.04 9018.58,-5073.42"/>
<polygon fill="black" stroke="black" points="9019.04,-5069.95 9008.63,-5071.89 9017.98,-5076.87 9019.04,-5069.95"/>
</g>
<!-- layer2_expert_agg_3_0&#45;&gt;layer2_res2 -->
<g id="edge965" class="edge">
<title>layer2_expert_agg_3_0&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M2983.22,-5278.51C3139.67,-5263.48 3365.72,-5243.29 3563.79,-5231.39 5595.45,-5109.35 8070.42,-5062.63 8708.76,-5052.14"/>
<polygon fill="black" stroke="black" points="8709,-5055.64 8718.94,-5051.97 8708.88,-5048.64 8709,-5055.64"/>
</g>
<!-- layer2_expert_agg_3_1&#45;&gt;layer2_res2 -->
<g id="edge966" class="edge">
<title>layer2_expert_agg_3_1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M5910.99,-5280.81C6067.54,-5267.07 6293.85,-5247.47 6491.79,-5231.39 7327.65,-5163.48 8329.72,-5089.06 8709.06,-5061.14"/>
<polygon fill="black" stroke="black" points="8709.56,-5064.62 8719.28,-5060.39 8709.05,-5057.64 8709.56,-5064.62"/>
</g>
<!-- layer2_expert_agg_3_2&#45;&gt;layer2_res2 -->
<g id="edge967" class="edge">
<title>layer2_expert_agg_3_2&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M2129.13,-5274.47C2258.7,-5259.67 2433.24,-5241.5 2587.79,-5231.39 5023.93,-5072.07 8001.04,-5052.47 8708.67,-5050.06"/>
<polygon fill="black" stroke="black" points="8708.93,-5053.56 8718.92,-5050.03 8708.91,-5046.56 8708.93,-5053.56"/>
</g>
<!-- layer2_expert_agg_3_3&#45;&gt;layer2_res2 -->
<g id="edge968" class="edge">
<title>layer2_expert_agg_3_3&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M15162.37,-5278.38C15005.92,-5263.27 14779.88,-5243.04 14581.79,-5231.39 12377.55,-5101.74 9689.39,-5060.26 9020.87,-5051.6"/>
<polygon fill="black" stroke="black" points="9020.74,-5048.1 9010.69,-5051.47 9020.65,-5055.1 9020.74,-5048.1"/>
</g>
<!-- layer3_ln1_0_0 -->
<g id="node352" class="node">
<title>layer3_ln1_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="4311.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="4311.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4311.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="4311.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4311.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_0_0 -->
<g id="edge969" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_0_0</title>
<path fill="none" stroke="black" d="M8719.08,-5043.99C8191,-5029.87 6327.98,-4974.93 4794.79,-4866.06 4680.04,-4857.92 4550.29,-4845.06 4454.19,-4834.85"/>
<polygon fill="black" stroke="black" points="4454.43,-4831.35 4444.12,-4833.77 4453.69,-4838.31 4454.43,-4831.35"/>
</g>
<!-- layer3_ln1_0_1 -->
<g id="node353" class="node">
<title>layer3_ln1_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="4943.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="4943.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4943.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="4943.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4943.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_0_1 -->
<g id="edge970" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_0_1</title>
<path fill="none" stroke="black" d="M8719.26,-5042.23C8245.8,-5023.88 6706.55,-4960.49 5435.79,-4866.06 5318.11,-4857.32 5184.88,-4844.38 5086.77,-4834.28"/>
<polygon fill="black" stroke="black" points="5087.09,-4830.79 5076.78,-4833.25 5086.37,-4837.76 5087.09,-4830.79"/>
</g>
<!-- layer3_ln1_0_2 -->
<g id="node354" class="node">
<title>layer3_ln1_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="5584.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="5584.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5584.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="5584.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5584.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_0_2 -->
<g id="edge971" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_0_2</title>
<path fill="none" stroke="black" d="M8719.28,-5040.79C8299.4,-5020.27 7049.61,-4955.65 6014.79,-4866.06 5918.27,-4857.71 5809.83,-4845.82 5726,-4836.08"/>
<polygon fill="black" stroke="black" points="5726.24,-4832.58 5715.9,-4834.9 5725.43,-4839.53 5726.24,-4832.58"/>
</g>
<!-- layer3_ln1_0_3 -->
<g id="node355" class="node">
<title>layer3_ln1_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="6163.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6163.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6163.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="6163.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6163.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_0_3 -->
<g id="edge972" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_0_3</title>
<path fill="none" stroke="black" d="M8719.6,-5036.56C8365.61,-5009.19 7429.93,-4935.84 6649.79,-4866.06 6534.71,-4855.77 6404.4,-4843.09 6307.7,-4833.48"/>
<polygon fill="black" stroke="black" points="6307.86,-4829.98 6297.57,-4832.48 6307.17,-4836.95 6307.86,-4829.98"/>
</g>
<!-- layer3_ln1_1_0 -->
<g id="node356" class="node">
<title>layer3_ln1_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="6798.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6798.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6798.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="6798.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6798.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_1_0 -->
<g id="edge973" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_1_0</title>
<path fill="none" stroke="black" d="M8719.93,-5031.69C8340.16,-4989.64 7319.14,-4876.59 6941.65,-4834.8"/>
<polygon fill="black" stroke="black" points="6941.81,-4831.29 6931.48,-4833.67 6941.04,-4838.25 6941.81,-4831.29"/>
</g>
<!-- layer3_ln1_1_1 -->
<g id="node357" class="node">
<title>layer3_ln1_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7406.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7406.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7406.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7406.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7406.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_1_1 -->
<g id="edge974" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_1_1</title>
<path fill="none" stroke="black" d="M8721,-5025.17C8439.45,-4980.99 7818.92,-4883.64 7543.31,-4840.4"/>
<polygon fill="black" stroke="black" points="7543.68,-4836.91 7533.26,-4838.82 7542.59,-4843.83 7543.68,-4836.91"/>
</g>
<!-- layer3_ln1_1_2 -->
<g id="node358" class="node">
<title>layer3_ln1_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7985.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7985.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7985.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="7985.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7985.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_1_2 -->
<g id="edge975" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_1_2</title>
<path fill="none" stroke="black" d="M8724.05,-5011.1C8553.03,-4966.6 8267.41,-4892.27 8106.16,-4850.3"/>
<polygon fill="black" stroke="black" points="8106.75,-4846.84 8096.19,-4847.71 8104.99,-4853.62 8106.75,-4846.84"/>
</g>
<!-- layer3_ln1_1_3 -->
<g id="node359" class="node">
<title>layer3_ln1_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="8654.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8654.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8654.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="8654.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8654.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_1_3 -->
<g id="edge976" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_1_3</title>
<path fill="none" stroke="black" d="M8766.55,-4940.72C8744.5,-4916.7 8722.04,-4892.23 8703.1,-4871.6"/>
<polygon fill="black" stroke="black" points="8705.63,-4869.18 8696.29,-4864.18 8700.47,-4873.92 8705.63,-4869.18"/>
</g>
<!-- layer3_ln1_2_0 -->
<g id="node360" class="node">
<title>layer3_ln1_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="9040.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9040.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9040.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9040.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9040.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_2_0 -->
<g id="edge977" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_2_0</title>
<path fill="none" stroke="black" d="M8953.31,-4932.68C8969.42,-4911.75 8985.5,-4890.84 8999.4,-4872.77"/>
<polygon fill="black" stroke="black" points="9002.31,-4874.74 9005.63,-4864.68 8996.76,-4870.47 9002.31,-4874.74"/>
</g>
<!-- layer3_ln1_2_1 -->
<g id="node361" class="node">
<title>layer3_ln1_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9653.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9653.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9653.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="9653.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9653.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_2_1 -->
<g id="edge978" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_2_1</title>
<path fill="none" stroke="black" d="M9004.49,-5007.23C9156.57,-4963.13 9396.96,-4893.44 9538.64,-4852.37"/>
<polygon fill="black" stroke="black" points="9539.61,-4855.73 9548.24,-4849.58 9537.66,-4849 9539.61,-4855.73"/>
</g>
<!-- layer3_ln1_2_2 -->
<g id="node362" class="node">
<title>layer3_ln1_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="10304.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10304.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10304.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="10304.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10304.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_2_2 -->
<g id="edge979" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_2_2</title>
<path fill="none" stroke="black" d="M9008.79,-5024.85C9287.42,-4980.59 9896.77,-4883.8 10168.87,-4840.57"/>
<polygon fill="black" stroke="black" points="10169.47,-4844.02 10178.8,-4838.99 10168.37,-4837.11 10169.47,-4844.02"/>
</g>
<!-- layer3_ln1_2_3 -->
<g id="node363" class="node">
<title>layer3_ln1_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10955.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10955.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10955.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="10955.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10955.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_2_3 -->
<g id="edge980" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_2_3</title>
<path fill="none" stroke="black" d="M9009.75,-5031.87C9393.47,-4989.89 10432.26,-4876.25 10813.23,-4834.58"/>
<polygon fill="black" stroke="black" points="10813.65,-4838.05 10823.21,-4833.48 10812.89,-4831.09 10813.65,-4838.05"/>
</g>
<!-- layer3_ln1_3_0 -->
<g id="node364" class="node">
<title>layer3_ln1_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="11621.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="11621.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11621.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="11621.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11621.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_3_0 -->
<g id="edge981" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_3_0</title>
<path fill="none" stroke="black" d="M9009.95,-5036.46C9366.62,-5008.65 10314.46,-4934.1 11104.79,-4866.06 11230.58,-4855.23 11373.51,-4842.16 11477.16,-4832.54"/>
<polygon fill="black" stroke="black" points="11477.75,-4836 11487.38,-4831.59 11477.1,-4829.03 11477.75,-4836"/>
</g>
<!-- layer3_ln1_3_1 -->
<g id="node365" class="node">
<title>layer3_ln1_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="12264.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12264.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12264.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="12264.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12264.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_3_1 -->
<g id="edge982" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_3_1</title>
<path fill="none" stroke="black" d="M9010.43,-5040.31C9435.76,-5018.27 10712.85,-4949.53 11770.79,-4866.06 11889.01,-4856.74 12022.92,-4843.83 12121.47,-4833.89"/>
<polygon fill="black" stroke="black" points="12121.9,-4837.36 12131.49,-4832.87 12121.19,-4830.4 12121.9,-4837.36"/>
</g>
<!-- layer3_ln1_3_2 -->
<g id="node366" class="node">
<title>layer3_ln1_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="12942.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12942.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12942.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="12942.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12942.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_3_2 -->
<g id="edge983" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_3_2</title>
<path fill="none" stroke="black" d="M9010.7,-5042.23C9495.1,-5023.56 11094.05,-4958.54 12413.79,-4866.06 12544.22,-4856.92 12692.46,-4843.46 12798.77,-4833.27"/>
<polygon fill="black" stroke="black" points="12799.3,-4836.74 12808.92,-4832.3 12798.63,-4829.77 12799.3,-4836.74"/>
</g>
<!-- layer3_ln1_3_3 -->
<g id="node367" class="node">
<title>layer3_ln1_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="13618.79" cy="-4817.98" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="13618.79" y="-4836.78" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13618.79" y="-4821.78" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="13618.79" y="-4806.78" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13618.79" y="-4791.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1_3_3 -->
<g id="edge984" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1_3_3</title>
<path fill="none" stroke="black" d="M9010.47,-5043.9C9551.09,-5029.2 11493.54,-4971.75 13091.79,-4866.06 13221.65,-4857.48 13369.19,-4843.97 13475.06,-4833.63"/>
<polygon fill="black" stroke="black" points="13475.56,-4837.09 13485.18,-4832.63 13474.88,-4830.13 13475.56,-4837.09"/>
</g>
<!-- layer3_q_proj_0_0 -->
<g id="node368" class="node">
<title>layer3_q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="4153.29,-4732.9 3980.29,-4732.9 3980.29,-4649.9 4153.29,-4649.9 4153.29,-4732.9"/>
<text text-anchor="middle" x="4066.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4066.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="4066.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4066.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4066.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_0&#45;&gt;layer3_q_proj_0_0 -->
<g id="edge985" class="edge">
<title>layer3_ln1_0_0&#45;&gt;layer3_q_proj_0_0</title>
<path fill="none" stroke="black" d="M4234.61,-4777.73C4209.51,-4764.97 4181.47,-4750.71 4155.59,-4737.55"/>
<polygon fill="black" stroke="black" points="4157.04,-4734.36 4146.54,-4732.95 4153.87,-4740.6 4157.04,-4734.36"/>
</g>
<!-- layer3_k_proj_0_0 -->
<g id="node369" class="node">
<title>layer3_k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="4344.29,-4732.9 4171.29,-4732.9 4171.29,-4649.9 4344.29,-4649.9 4344.29,-4732.9"/>
<text text-anchor="middle" x="4257.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4257.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="4257.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4257.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4257.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_0&#45;&gt;layer3_k_proj_0_0 -->
<g id="edge986" class="edge">
<title>layer3_ln1_0_0&#45;&gt;layer3_k_proj_0_0</title>
<path fill="none" stroke="black" d="M4291.53,-4770.24C4287.62,-4761.22 4283.51,-4751.73 4279.56,-4742.61"/>
<polygon fill="black" stroke="black" points="4282.69,-4741.05 4275.51,-4733.27 4276.27,-4743.83 4282.69,-4741.05"/>
</g>
<!-- layer3_v_proj_0_0 -->
<g id="node370" class="node">
<title>layer3_v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="4535.29,-4732.9 4362.29,-4732.9 4362.29,-4649.9 4535.29,-4649.9 4535.29,-4732.9"/>
<text text-anchor="middle" x="4448.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4448.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="4448.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4448.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4448.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_0&#45;&gt;layer3_v_proj_0_0 -->
<g id="edge987" class="edge">
<title>layer3_ln1_0_0&#45;&gt;layer3_v_proj_0_0</title>
<path fill="none" stroke="black" d="M4360.48,-4772.71C4372.09,-4762.15 4384.53,-4750.84 4396.3,-4740.13"/>
<polygon fill="black" stroke="black" points="4398.88,-4742.52 4403.92,-4733.2 4394.17,-4737.34 4398.88,-4742.52"/>
</g>
<!-- layer3_q_proj_0_1 -->
<g id="node371" class="node">
<title>layer3_q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4743.79,-4732.9 4553.79,-4732.9 4553.79,-4649.9 4743.79,-4649.9 4743.79,-4732.9"/>
<text text-anchor="middle" x="4648.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4648.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="4648.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4648.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="4648.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_1&#45;&gt;layer3_q_proj_0_1 -->
<g id="edge988" class="edge">
<title>layer3_ln1_0_1&#45;&gt;layer3_q_proj_0_1</title>
<path fill="none" stroke="black" d="M4856.88,-4780.27C4824.41,-4766.56 4787.2,-4750.85 4753.31,-4736.54"/>
<polygon fill="black" stroke="black" points="4754.42,-4733.21 4743.84,-4732.54 4751.69,-4739.65 4754.42,-4733.21"/>
</g>
<!-- layer3_k_proj_0_1 -->
<g id="node372" class="node">
<title>layer3_k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4951.79,-4732.9 4761.79,-4732.9 4761.79,-4649.9 4951.79,-4649.9 4951.79,-4732.9"/>
<text text-anchor="middle" x="4856.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4856.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="4856.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4856.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="4856.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_1&#45;&gt;layer3_k_proj_0_1 -->
<g id="edge989" class="edge">
<title>layer3_ln1_0_1&#45;&gt;layer3_k_proj_0_1</title>
<path fill="none" stroke="black" d="M4911.64,-4770.94C4904.9,-4761.29 4897.77,-4751.08 4890.96,-4741.33"/>
<polygon fill="black" stroke="black" points="4893.68,-4739.1 4885.08,-4732.91 4887.94,-4743.11 4893.68,-4739.1"/>
</g>
<!-- layer3_v_proj_0_1 -->
<g id="node373" class="node">
<title>layer3_v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="5159.79,-4732.9 4969.79,-4732.9 4969.79,-4649.9 5159.79,-4649.9 5159.79,-4732.9"/>
<text text-anchor="middle" x="5064.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5064.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="5064.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5064.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="5064.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_1&#45;&gt;layer3_v_proj_0_1 -->
<g id="edge990" class="edge">
<title>layer3_ln1_0_1&#45;&gt;layer3_v_proj_0_1</title>
<path fill="none" stroke="black" d="M4987.48,-4772C4997.39,-4761.8 5007.96,-4750.91 5017.99,-4740.58"/>
<polygon fill="black" stroke="black" points="5020.74,-4742.78 5025.19,-4733.17 5015.71,-4737.9 5020.74,-4742.78"/>
</g>
<!-- layer3_q_proj_0_2 -->
<g id="node374" class="node">
<title>layer3_q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="5367.79,-4732.9 5177.79,-4732.9 5177.79,-4649.9 5367.79,-4649.9 5367.79,-4732.9"/>
<text text-anchor="middle" x="5272.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5272.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="5272.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5272.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5272.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_2&#45;&gt;layer3_q_proj_0_2 -->
<g id="edge991" class="edge">
<title>layer3_ln1_0_2&#45;&gt;layer3_q_proj_0_2</title>
<path fill="none" stroke="black" d="M5494.55,-4780.95C5457.96,-4766.34 5415.48,-4749.37 5377.54,-4734.22"/>
<polygon fill="black" stroke="black" points="5378.58,-4730.87 5368,-4730.41 5375.98,-4737.37 5378.58,-4730.87"/>
</g>
<!-- layer3_k_proj_0_2 -->
<g id="node375" class="node">
<title>layer3_k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="5575.79,-4732.9 5385.79,-4732.9 5385.79,-4649.9 5575.79,-4649.9 5575.79,-4732.9"/>
<text text-anchor="middle" x="5480.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5480.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="5480.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5480.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5480.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_2&#45;&gt;layer3_k_proj_0_2 -->
<g id="edge992" class="edge">
<title>layer3_ln1_0_2&#45;&gt;layer3_k_proj_0_2</title>
<path fill="none" stroke="black" d="M5546.95,-4771.65C5538.53,-4761.56 5529.57,-4750.83 5521.05,-4740.62"/>
<polygon fill="black" stroke="black" points="5523.74,-4738.38 5514.64,-4732.95 5518.36,-4742.87 5523.74,-4738.38"/>
</g>
<!-- layer3_v_proj_0_2 -->
<g id="node376" class="node">
<title>layer3_v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="5783.79,-4732.9 5593.79,-4732.9 5593.79,-4649.9 5783.79,-4649.9 5783.79,-4732.9"/>
<text text-anchor="middle" x="5688.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5688.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="5688.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5688.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5688.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_2&#45;&gt;layer3_v_proj_0_2 -->
<g id="edge993" class="edge">
<title>layer3_ln1_0_2&#45;&gt;layer3_v_proj_0_2</title>
<path fill="none" stroke="black" d="M5622.63,-4771.65C5631.06,-4761.56 5640.01,-4750.83 5648.53,-4740.62"/>
<polygon fill="black" stroke="black" points="5651.22,-4742.87 5654.94,-4732.95 5645.85,-4738.38 5651.22,-4742.87"/>
</g>
<!-- layer3_q_proj_0_3 -->
<g id="node377" class="node">
<title>layer3_q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="5991.79,-4732.9 5801.79,-4732.9 5801.79,-4649.9 5991.79,-4649.9 5991.79,-4732.9"/>
<text text-anchor="middle" x="5896.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5896.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="5896.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5896.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5896.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_3&#45;&gt;layer3_q_proj_0_3 -->
<g id="edge994" class="edge">
<title>layer3_ln1_0_3&#45;&gt;layer3_q_proj_0_3</title>
<path fill="none" stroke="black" d="M6081.87,-4778.75C6053.79,-4765.65 6022.11,-4750.87 5993.01,-4737.29"/>
<polygon fill="black" stroke="black" points="5994.2,-4733.98 5983.65,-4732.93 5991.24,-4740.33 5994.2,-4733.98"/>
</g>
<!-- layer3_k_proj_0_3 -->
<g id="node378" class="node">
<title>layer3_k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6199.79,-4732.9 6009.79,-4732.9 6009.79,-4649.9 6199.79,-4649.9 6199.79,-4732.9"/>
<text text-anchor="middle" x="6104.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6104.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="6104.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6104.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6104.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_3&#45;&gt;layer3_k_proj_0_3 -->
<g id="edge995" class="edge">
<title>layer3_ln1_0_3&#45;&gt;layer3_k_proj_0_3</title>
<path fill="none" stroke="black" d="M6141.65,-4770.24C6137.34,-4761.12 6132.8,-4751.53 6128.43,-4742.32"/>
<polygon fill="black" stroke="black" points="6131.59,-4740.81 6124.15,-4733.27 6125.26,-4743.8 6131.59,-4740.81"/>
</g>
<!-- layer3_v_proj_0_3 -->
<g id="node379" class="node">
<title>layer3_v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6407.79,-4732.9 6217.79,-4732.9 6217.79,-4649.9 6407.79,-4649.9 6407.79,-4732.9"/>
<text text-anchor="middle" x="6312.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6312.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="6312.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6312.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6312.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_0_3&#45;&gt;layer3_v_proj_0_3 -->
<g id="edge996" class="edge">
<title>layer3_ln1_0_3&#45;&gt;layer3_v_proj_0_3</title>
<path fill="none" stroke="black" d="M6216.32,-4773.06C6229.23,-4762.27 6243.1,-4750.67 6256.19,-4739.72"/>
<polygon fill="black" stroke="black" points="6258.79,-4742.11 6264.22,-4733.01 6254.3,-4736.74 6258.79,-4742.11"/>
</g>
<!-- layer3_q_proj_1_0 -->
<g id="node380" class="node">
<title>layer3_q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6599.29,-4732.9 6426.29,-4732.9 6426.29,-4649.9 6599.29,-4649.9 6599.29,-4732.9"/>
<text text-anchor="middle" x="6512.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6512.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="6512.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6512.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6512.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_0&#45;&gt;layer3_q_proj_1_0 -->
<g id="edge997" class="edge">
<title>layer3_ln1_1_0&#45;&gt;layer3_q_proj_1_0</title>
<path fill="none" stroke="black" d="M6713.37,-4779.77C6680.57,-4765.48 6642.92,-4749.08 6609.16,-4734.38"/>
<polygon fill="black" stroke="black" points="6610.32,-4731.06 6599.75,-4730.28 6607.52,-4737.48 6610.32,-4731.06"/>
</g>
<!-- layer3_k_proj_1_0 -->
<g id="node381" class="node">
<title>layer3_k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6790.29,-4732.9 6617.29,-4732.9 6617.29,-4649.9 6790.29,-4649.9 6790.29,-4732.9"/>
<text text-anchor="middle" x="6703.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6703.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="6703.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6703.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6703.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_0&#45;&gt;layer3_k_proj_1_0 -->
<g id="edge998" class="edge">
<title>layer3_ln1_1_0&#45;&gt;layer3_k_proj_1_0</title>
<path fill="none" stroke="black" d="M6763.96,-4771.3C6756.51,-4761.53 6748.61,-4751.18 6741.08,-4741.3"/>
<polygon fill="black" stroke="black" points="6743.7,-4738.96 6734.85,-4733.13 6738.13,-4743.2 6743.7,-4738.96"/>
</g>
<!-- layer3_v_proj_1_0 -->
<g id="node382" class="node">
<title>layer3_v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6981.29,-4732.9 6808.29,-4732.9 6808.29,-4649.9 6981.29,-4649.9 6981.29,-4732.9"/>
<text text-anchor="middle" x="6894.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6894.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="6894.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6894.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6894.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_0&#45;&gt;layer3_v_proj_1_0 -->
<g id="edge999" class="edge">
<title>layer3_ln1_1_0&#45;&gt;layer3_v_proj_1_0</title>
<path fill="none" stroke="black" d="M6833.99,-4771.3C6841.52,-4761.53 6849.5,-4751.18 6857.11,-4741.3"/>
<polygon fill="black" stroke="black" points="6860.07,-4743.19 6863.4,-4733.13 6854.53,-4738.92 6860.07,-4743.19"/>
</g>
<!-- layer3_q_proj_1_1 -->
<g id="node383" class="node">
<title>layer3_q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7189.79,-4732.9 6999.79,-4732.9 6999.79,-4649.9 7189.79,-4649.9 7189.79,-4732.9"/>
<text text-anchor="middle" x="7094.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7094.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="7094.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7094.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7094.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_1&#45;&gt;layer3_q_proj_1_1 -->
<g id="edge1000" class="edge">
<title>layer3_ln1_1_1&#45;&gt;layer3_q_proj_1_1</title>
<path fill="none" stroke="black" d="M7316.55,-4780.95C7279.96,-4766.34 7237.48,-4749.37 7199.54,-4734.22"/>
<polygon fill="black" stroke="black" points="7200.58,-4730.87 7190,-4730.41 7197.98,-4737.37 7200.58,-4730.87"/>
</g>
<!-- layer3_k_proj_1_1 -->
<g id="node384" class="node">
<title>layer3_k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7397.79,-4732.9 7207.79,-4732.9 7207.79,-4649.9 7397.79,-4649.9 7397.79,-4732.9"/>
<text text-anchor="middle" x="7302.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7302.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="7302.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7302.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7302.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_1&#45;&gt;layer3_k_proj_1_1 -->
<g id="edge1001" class="edge">
<title>layer3_ln1_1_1&#45;&gt;layer3_k_proj_1_1</title>
<path fill="none" stroke="black" d="M7368.95,-4771.65C7360.53,-4761.56 7351.57,-4750.83 7343.05,-4740.62"/>
<polygon fill="black" stroke="black" points="7345.74,-4738.38 7336.64,-4732.95 7340.36,-4742.87 7345.74,-4738.38"/>
</g>
<!-- layer3_v_proj_1_1 -->
<g id="node385" class="node">
<title>layer3_v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7605.79,-4732.9 7415.79,-4732.9 7415.79,-4649.9 7605.79,-4649.9 7605.79,-4732.9"/>
<text text-anchor="middle" x="7510.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7510.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="7510.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7510.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7510.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_1&#45;&gt;layer3_v_proj_1_1 -->
<g id="edge1002" class="edge">
<title>layer3_ln1_1_1&#45;&gt;layer3_v_proj_1_1</title>
<path fill="none" stroke="black" d="M7444.63,-4771.65C7453.06,-4761.56 7462.01,-4750.83 7470.53,-4740.62"/>
<polygon fill="black" stroke="black" points="7473.22,-4742.87 7476.94,-4732.95 7467.85,-4738.38 7473.22,-4742.87"/>
</g>
<!-- layer3_q_proj_1_2 -->
<g id="node386" class="node">
<title>layer3_q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="7813.79,-4732.9 7623.79,-4732.9 7623.79,-4649.9 7813.79,-4649.9 7813.79,-4732.9"/>
<text text-anchor="middle" x="7718.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7718.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="7718.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7718.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7718.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_2&#45;&gt;layer3_q_proj_1_2 -->
<g id="edge1003" class="edge">
<title>layer3_ln1_1_2&#45;&gt;layer3_q_proj_1_2</title>
<path fill="none" stroke="black" d="M7903.87,-4778.75C7875.79,-4765.65 7844.11,-4750.87 7815.01,-4737.29"/>
<polygon fill="black" stroke="black" points="7816.2,-4733.98 7805.65,-4732.93 7813.24,-4740.33 7816.2,-4733.98"/>
</g>
<!-- layer3_k_proj_1_2 -->
<g id="node387" class="node">
<title>layer3_k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8021.79,-4732.9 7831.79,-4732.9 7831.79,-4649.9 8021.79,-4649.9 8021.79,-4732.9"/>
<text text-anchor="middle" x="7926.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7926.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="7926.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7926.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7926.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_2&#45;&gt;layer3_k_proj_1_2 -->
<g id="edge1004" class="edge">
<title>layer3_ln1_1_2&#45;&gt;layer3_k_proj_1_2</title>
<path fill="none" stroke="black" d="M7963.65,-4770.24C7959.34,-4761.12 7954.8,-4751.53 7950.43,-4742.32"/>
<polygon fill="black" stroke="black" points="7953.59,-4740.81 7946.15,-4733.27 7947.26,-4743.8 7953.59,-4740.81"/>
</g>
<!-- layer3_v_proj_1_2 -->
<g id="node388" class="node">
<title>layer3_v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8229.79,-4732.9 8039.79,-4732.9 8039.79,-4649.9 8229.79,-4649.9 8229.79,-4732.9"/>
<text text-anchor="middle" x="8134.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8134.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="8134.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8134.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8134.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_2&#45;&gt;layer3_v_proj_1_2 -->
<g id="edge1005" class="edge">
<title>layer3_ln1_1_2&#45;&gt;layer3_v_proj_1_2</title>
<path fill="none" stroke="black" d="M8038.32,-4773.06C8051.23,-4762.27 8065.1,-4750.67 8078.19,-4739.72"/>
<polygon fill="black" stroke="black" points="8080.79,-4742.11 8086.22,-4733.01 8076.3,-4736.74 8080.79,-4742.11"/>
</g>
<!-- layer3_q_proj_1_3 -->
<g id="node389" class="node">
<title>layer3_q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8437.79,-4732.9 8247.79,-4732.9 8247.79,-4649.9 8437.79,-4649.9 8437.79,-4732.9"/>
<text text-anchor="middle" x="8342.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8342.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="8342.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8342.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8342.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_3&#45;&gt;layer3_q_proj_1_3 -->
<g id="edge1006" class="edge">
<title>layer3_ln1_1_3&#45;&gt;layer3_q_proj_1_3</title>
<path fill="none" stroke="black" d="M8564.55,-4780.95C8527.96,-4766.34 8485.48,-4749.37 8447.54,-4734.22"/>
<polygon fill="black" stroke="black" points="8448.58,-4730.87 8438,-4730.41 8445.98,-4737.37 8448.58,-4730.87"/>
</g>
<!-- layer3_k_proj_1_3 -->
<g id="node390" class="node">
<title>layer3_k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8645.79,-4732.9 8455.79,-4732.9 8455.79,-4649.9 8645.79,-4649.9 8645.79,-4732.9"/>
<text text-anchor="middle" x="8550.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8550.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="8550.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8550.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8550.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_3&#45;&gt;layer3_k_proj_1_3 -->
<g id="edge1007" class="edge">
<title>layer3_ln1_1_3&#45;&gt;layer3_k_proj_1_3</title>
<path fill="none" stroke="black" d="M8616.95,-4771.65C8608.53,-4761.56 8599.57,-4750.83 8591.05,-4740.62"/>
<polygon fill="black" stroke="black" points="8593.74,-4738.38 8584.64,-4732.95 8588.36,-4742.87 8593.74,-4738.38"/>
</g>
<!-- layer3_v_proj_1_3 -->
<g id="node391" class="node">
<title>layer3_v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8853.79,-4732.9 8663.79,-4732.9 8663.79,-4649.9 8853.79,-4649.9 8853.79,-4732.9"/>
<text text-anchor="middle" x="8758.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8758.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="8758.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8758.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8758.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_1_3&#45;&gt;layer3_v_proj_1_3 -->
<g id="edge1008" class="edge">
<title>layer3_ln1_1_3&#45;&gt;layer3_v_proj_1_3</title>
<path fill="none" stroke="black" d="M8692.63,-4771.65C8701.06,-4761.56 8710.01,-4750.83 8718.53,-4740.62"/>
<polygon fill="black" stroke="black" points="8721.22,-4742.87 8724.94,-4732.95 8715.85,-4738.38 8721.22,-4742.87"/>
</g>
<!-- layer3_q_proj_2_0 -->
<g id="node392" class="node">
<title>layer3_q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9053.29,-4732.9 8872.29,-4732.9 8872.29,-4649.9 9053.29,-4649.9 9053.29,-4732.9"/>
<text text-anchor="middle" x="8962.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8962.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="8962.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8962.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8962.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_0&#45;&gt;layer3_q_proj_2_0 -->
<g id="edge1009" class="edge">
<title>layer3_ln1_2_0&#45;&gt;layer3_q_proj_2_0</title>
<path fill="none" stroke="black" d="M9011.75,-4770.59C9005.84,-4761.16 8999.62,-4751.21 8993.65,-4741.69"/>
<polygon fill="black" stroke="black" points="8996.54,-4739.71 8988.27,-4733.09 8990.61,-4743.42 8996.54,-4739.71"/>
</g>
<!-- layer3_k_proj_2_0 -->
<g id="node393" class="node">
<title>layer3_k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9252.29,-4732.9 9071.29,-4732.9 9071.29,-4649.9 9252.29,-4649.9 9252.29,-4732.9"/>
<text text-anchor="middle" x="9161.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9161.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="9161.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9161.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9161.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_0&#45;&gt;layer3_k_proj_2_0 -->
<g id="edge1010" class="edge">
<title>layer3_ln1_2_0&#45;&gt;layer3_k_proj_2_0</title>
<path fill="none" stroke="black" d="M9084.48,-4772C9094.39,-4761.8 9104.96,-4750.91 9114.99,-4740.58"/>
<polygon fill="black" stroke="black" points="9117.74,-4742.78 9122.19,-4733.17 9112.71,-4737.9 9117.74,-4742.78"/>
</g>
<!-- layer3_v_proj_2_0 -->
<g id="node394" class="node">
<title>layer3_v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="9451.29,-4732.9 9270.29,-4732.9 9270.29,-4649.9 9451.29,-4649.9 9451.29,-4732.9"/>
<text text-anchor="middle" x="9360.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9360.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="9360.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9360.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9360.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_0&#45;&gt;layer3_v_proj_2_0 -->
<g id="edge1011" class="edge">
<title>layer3_ln1_2_0&#45;&gt;layer3_v_proj_2_0</title>
<path fill="none" stroke="black" d="M9134,-4782.1C9171.03,-4768.1 9214.2,-4751.61 9260.82,-4733.26"/>
<polygon fill="black" stroke="black" points="9262.17,-4736.49 9270.19,-4729.57 9259.6,-4729.98 9262.17,-4736.49"/>
</g>
<!-- layer3_q_proj_2_1 -->
<g id="node395" class="node">
<title>layer3_q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="9668.29,-4732.9 9469.29,-4732.9 9469.29,-4649.9 9668.29,-4649.9 9668.29,-4732.9"/>
<text text-anchor="middle" x="9568.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9568.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="9568.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9568.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9568.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_1&#45;&gt;layer3_q_proj_2_1 -->
<g id="edge1012" class="edge">
<title>layer3_ln1_2_1&#45;&gt;layer3_q_proj_2_1</title>
<path fill="none" stroke="black" d="M9622.38,-4770.94C9615.8,-4761.29 9608.83,-4751.08 9602.18,-4741.33"/>
<polygon fill="black" stroke="black" points="9604.96,-4739.2 9596.43,-4732.91 9599.18,-4743.14 9604.96,-4739.2"/>
</g>
<!-- layer3_k_proj_2_1 -->
<g id="node396" class="node">
<title>layer3_k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="9885.29,-4732.9 9686.29,-4732.9 9686.29,-4649.9 9885.29,-4649.9 9885.29,-4732.9"/>
<text text-anchor="middle" x="9785.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9785.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="9785.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9785.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9785.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_1&#45;&gt;layer3_k_proj_2_1 -->
<g id="edge1013" class="edge">
<title>layer3_ln1_2_1&#45;&gt;layer3_k_proj_2_1</title>
<path fill="none" stroke="black" d="M9701.07,-4772.35C9712.24,-4761.82 9724.18,-4750.54 9735.48,-4739.88"/>
<polygon fill="black" stroke="black" points="9737.92,-4742.39 9742.79,-4732.98 9733.12,-4737.3 9737.92,-4742.39"/>
</g>
<!-- layer3_v_proj_2_1 -->
<g id="node397" class="node">
<title>layer3_v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10102.29,-4732.9 9903.29,-4732.9 9903.29,-4649.9 10102.29,-4649.9 10102.29,-4732.9"/>
<text text-anchor="middle" x="10002.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10002.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="10002.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10002.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10002.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_1&#45;&gt;layer3_v_proj_2_1 -->
<g id="edge1014" class="edge">
<title>layer3_ln1_2_1&#45;&gt;layer3_v_proj_2_1</title>
<path fill="none" stroke="black" d="M9751.59,-4783.43C9792.89,-4769.13 9841.7,-4752.04 9893.4,-4733.38"/>
<polygon fill="black" stroke="black" points="9894.87,-4736.57 9903.08,-4729.88 9892.49,-4729.99 9894.87,-4736.57"/>
</g>
<!-- layer3_q_proj_2_2 -->
<g id="node398" class="node">
<title>layer3_q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="10319.29,-4732.9 10120.29,-4732.9 10120.29,-4649.9 10319.29,-4649.9 10319.29,-4732.9"/>
<text text-anchor="middle" x="10219.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10219.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="10219.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10219.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10219.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_2&#45;&gt;layer3_q_proj_2_2 -->
<g id="edge1015" class="edge">
<title>layer3_ln1_2_2&#45;&gt;layer3_q_proj_2_2</title>
<path fill="none" stroke="black" d="M10273.38,-4770.94C10266.8,-4761.29 10259.83,-4751.08 10253.18,-4741.33"/>
<polygon fill="black" stroke="black" points="10255.96,-4739.2 10247.43,-4732.91 10250.18,-4743.14 10255.96,-4739.2"/>
</g>
<!-- layer3_k_proj_2_2 -->
<g id="node399" class="node">
<title>layer3_k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="10536.29,-4732.9 10337.29,-4732.9 10337.29,-4649.9 10536.29,-4649.9 10536.29,-4732.9"/>
<text text-anchor="middle" x="10436.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10436.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="10436.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10436.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10436.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_2&#45;&gt;layer3_k_proj_2_2 -->
<g id="edge1016" class="edge">
<title>layer3_ln1_2_2&#45;&gt;layer3_k_proj_2_2</title>
<path fill="none" stroke="black" d="M10352.07,-4772.35C10363.24,-4761.82 10375.18,-4750.54 10386.48,-4739.88"/>
<polygon fill="black" stroke="black" points="10388.92,-4742.39 10393.79,-4732.98 10384.12,-4737.3 10388.92,-4742.39"/>
</g>
<!-- layer3_v_proj_2_2 -->
<g id="node400" class="node">
<title>layer3_v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="10753.29,-4732.9 10554.29,-4732.9 10554.29,-4649.9 10753.29,-4649.9 10753.29,-4732.9"/>
<text text-anchor="middle" x="10653.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10653.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="10653.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10653.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10653.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_2&#45;&gt;layer3_v_proj_2_2 -->
<g id="edge1017" class="edge">
<title>layer3_ln1_2_2&#45;&gt;layer3_v_proj_2_2</title>
<path fill="none" stroke="black" d="M10402.59,-4783.43C10443.89,-4769.13 10492.7,-4752.04 10544.4,-4733.38"/>
<polygon fill="black" stroke="black" points="10545.87,-4736.57 10554.08,-4729.88 10543.49,-4729.99 10545.87,-4736.57"/>
</g>
<!-- layer3_q_proj_2_3 -->
<g id="node401" class="node">
<title>layer3_q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10970.29,-4732.9 10771.29,-4732.9 10771.29,-4649.9 10970.29,-4649.9 10970.29,-4732.9"/>
<text text-anchor="middle" x="10870.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10870.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="10870.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10870.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10870.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_3&#45;&gt;layer3_q_proj_2_3 -->
<g id="edge1018" class="edge">
<title>layer3_ln1_2_3&#45;&gt;layer3_q_proj_2_3</title>
<path fill="none" stroke="black" d="M10924.38,-4770.94C10917.8,-4761.29 10910.83,-4751.08 10904.18,-4741.33"/>
<polygon fill="black" stroke="black" points="10906.96,-4739.2 10898.43,-4732.91 10901.18,-4743.14 10906.96,-4739.2"/>
</g>
<!-- layer3_k_proj_2_3 -->
<g id="node402" class="node">
<title>layer3_k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="11187.29,-4732.9 10988.29,-4732.9 10988.29,-4649.9 11187.29,-4649.9 11187.29,-4732.9"/>
<text text-anchor="middle" x="11087.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11087.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="11087.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11087.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11087.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_3&#45;&gt;layer3_k_proj_2_3 -->
<g id="edge1019" class="edge">
<title>layer3_ln1_2_3&#45;&gt;layer3_k_proj_2_3</title>
<path fill="none" stroke="black" d="M11003.07,-4772.35C11014.24,-4761.82 11026.18,-4750.54 11037.48,-4739.88"/>
<polygon fill="black" stroke="black" points="11039.92,-4742.39 11044.79,-4732.98 11035.12,-4737.3 11039.92,-4742.39"/>
</g>
<!-- layer3_v_proj_2_3 -->
<g id="node403" class="node">
<title>layer3_v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="11404.29,-4732.9 11205.29,-4732.9 11205.29,-4649.9 11404.29,-4649.9 11404.29,-4732.9"/>
<text text-anchor="middle" x="11304.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11304.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="11304.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11304.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11304.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_2_3&#45;&gt;layer3_v_proj_2_3 -->
<g id="edge1020" class="edge">
<title>layer3_ln1_2_3&#45;&gt;layer3_v_proj_2_3</title>
<path fill="none" stroke="black" d="M11053.59,-4783.43C11094.89,-4769.13 11143.7,-4752.04 11195.4,-4733.38"/>
<polygon fill="black" stroke="black" points="11196.87,-4736.57 11205.08,-4729.88 11194.49,-4729.99 11196.87,-4736.57"/>
</g>
<!-- layer3_q_proj_3_0 -->
<g id="node404" class="node">
<title>layer3_q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="11612.79,-4732.9 11422.79,-4732.9 11422.79,-4649.9 11612.79,-4649.9 11612.79,-4732.9"/>
<text text-anchor="middle" x="11517.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11517.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="11517.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11517.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11517.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_0&#45;&gt;layer3_q_proj_3_0 -->
<g id="edge1021" class="edge">
<title>layer3_ln1_3_0&#45;&gt;layer3_q_proj_3_0</title>
<path fill="none" stroke="black" d="M11583.95,-4771.65C11575.53,-4761.56 11566.57,-4750.83 11558.05,-4740.62"/>
<polygon fill="black" stroke="black" points="11560.74,-4738.38 11551.64,-4732.95 11555.36,-4742.87 11560.74,-4738.38"/>
</g>
<!-- layer3_k_proj_3_0 -->
<g id="node405" class="node">
<title>layer3_k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="11820.79,-4732.9 11630.79,-4732.9 11630.79,-4649.9 11820.79,-4649.9 11820.79,-4732.9"/>
<text text-anchor="middle" x="11725.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11725.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="11725.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11725.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11725.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_0&#45;&gt;layer3_k_proj_3_0 -->
<g id="edge1022" class="edge">
<title>layer3_ln1_3_0&#45;&gt;layer3_k_proj_3_0</title>
<path fill="none" stroke="black" d="M11659.63,-4771.65C11668.06,-4761.56 11677.01,-4750.83 11685.53,-4740.62"/>
<polygon fill="black" stroke="black" points="11688.22,-4742.87 11691.94,-4732.95 11682.85,-4738.38 11688.22,-4742.87"/>
</g>
<!-- layer3_v_proj_3_0 -->
<g id="node406" class="node">
<title>layer3_v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12028.79,-4732.9 11838.79,-4732.9 11838.79,-4649.9 12028.79,-4649.9 12028.79,-4732.9"/>
<text text-anchor="middle" x="11933.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11933.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="11933.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11933.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11933.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_0&#45;&gt;layer3_v_proj_3_0 -->
<g id="edge1023" class="edge">
<title>layer3_ln1_3_0&#45;&gt;layer3_v_proj_3_0</title>
<path fill="none" stroke="black" d="M11712.03,-4780.95C11748.62,-4766.34 11791.11,-4749.37 11829.05,-4734.22"/>
<polygon fill="black" stroke="black" points="11830.6,-4737.37 11838.59,-4730.41 11828,-4730.87 11830.6,-4737.37"/>
</g>
<!-- layer3_q_proj_3_1 -->
<g id="node407" class="node">
<title>layer3_q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="12254.79,-4732.9 12046.79,-4732.9 12046.79,-4649.9 12254.79,-4649.9 12254.79,-4732.9"/>
<text text-anchor="middle" x="12150.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12150.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="12150.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12150.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12150.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_1&#45;&gt;layer3_q_proj_3_1 -->
<g id="edge1024" class="edge">
<title>layer3_ln1_3_1&#45;&gt;layer3_q_proj_3_1</title>
<path fill="none" stroke="black" d="M12223.63,-4772C12214.29,-4761.8 12204.34,-4750.91 12194.88,-4740.58"/>
<polygon fill="black" stroke="black" points="12197.43,-4738.18 12188.1,-4733.17 12192.27,-4742.91 12197.43,-4738.18"/>
</g>
<!-- layer3_k_proj_3_1 -->
<g id="node408" class="node">
<title>layer3_k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="12480.79,-4732.9 12272.79,-4732.9 12272.79,-4649.9 12480.79,-4649.9 12480.79,-4732.9"/>
<text text-anchor="middle" x="12376.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12376.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="12376.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12376.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12376.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_1&#45;&gt;layer3_k_proj_3_1 -->
<g id="edge1025" class="edge">
<title>layer3_ln1_3_1&#45;&gt;layer3_k_proj_3_1</title>
<path fill="none" stroke="black" d="M12305.54,-4771.65C12314.61,-4761.56 12324.26,-4750.83 12333.43,-4740.62"/>
<polygon fill="black" stroke="black" points="12336.25,-4742.72 12340.34,-4732.95 12331.05,-4738.04 12336.25,-4742.72"/>
</g>
<!-- layer3_v_proj_3_1 -->
<g id="node409" class="node">
<title>layer3_v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="12706.79,-4732.9 12498.79,-4732.9 12498.79,-4649.9 12706.79,-4649.9 12706.79,-4732.9"/>
<text text-anchor="middle" x="12602.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12602.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="12602.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12602.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12602.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_1&#45;&gt;layer3_v_proj_3_1 -->
<g id="edge1026" class="edge">
<title>layer3_ln1_3_1&#45;&gt;layer3_v_proj_3_1</title>
<path fill="none" stroke="black" d="M12358.94,-4782.28C12399.35,-4767.38 12446.91,-4749.85 12489.25,-4734.25"/>
<polygon fill="black" stroke="black" points="12490.58,-4737.49 12498.76,-4730.74 12488.16,-4730.92 12490.58,-4737.49"/>
</g>
<!-- layer3_q_proj_3_2 -->
<g id="node410" class="node">
<title>layer3_q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12932.79,-4732.9 12724.79,-4732.9 12724.79,-4649.9 12932.79,-4649.9 12932.79,-4732.9"/>
<text text-anchor="middle" x="12828.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12828.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="12828.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12828.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12828.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_2&#45;&gt;layer3_q_proj_3_2 -->
<g id="edge1027" class="edge">
<title>layer3_ln1_3_2&#45;&gt;layer3_q_proj_3_2</title>
<path fill="none" stroke="black" d="M12901.63,-4772C12892.29,-4761.8 12882.34,-4750.91 12872.88,-4740.58"/>
<polygon fill="black" stroke="black" points="12875.43,-4738.18 12866.1,-4733.17 12870.27,-4742.91 12875.43,-4738.18"/>
</g>
<!-- layer3_k_proj_3_2 -->
<g id="node411" class="node">
<title>layer3_k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13158.79,-4732.9 12950.79,-4732.9 12950.79,-4649.9 13158.79,-4649.9 13158.79,-4732.9"/>
<text text-anchor="middle" x="13054.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13054.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="13054.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13054.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13054.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_2&#45;&gt;layer3_k_proj_3_2 -->
<g id="edge1028" class="edge">
<title>layer3_ln1_3_2&#45;&gt;layer3_k_proj_3_2</title>
<path fill="none" stroke="black" d="M12983.54,-4771.65C12992.61,-4761.56 13002.26,-4750.83 13011.43,-4740.62"/>
<polygon fill="black" stroke="black" points="13014.25,-4742.72 13018.34,-4732.95 13009.05,-4738.04 13014.25,-4742.72"/>
</g>
<!-- layer3_v_proj_3_2 -->
<g id="node412" class="node">
<title>layer3_v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13384.79,-4732.9 13176.79,-4732.9 13176.79,-4649.9 13384.79,-4649.9 13384.79,-4732.9"/>
<text text-anchor="middle" x="13280.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13280.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="13280.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13280.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13280.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_2&#45;&gt;layer3_v_proj_3_2 -->
<g id="edge1029" class="edge">
<title>layer3_ln1_3_2&#45;&gt;layer3_v_proj_3_2</title>
<path fill="none" stroke="black" d="M13036.94,-4782.28C13077.35,-4767.38 13124.91,-4749.85 13167.25,-4734.25"/>
<polygon fill="black" stroke="black" points="13168.58,-4737.49 13176.76,-4730.74 13166.16,-4730.92 13168.58,-4737.49"/>
</g>
<!-- layer3_q_proj_3_3 -->
<g id="node413" class="node">
<title>layer3_q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="13610.79,-4732.9 13402.79,-4732.9 13402.79,-4649.9 13610.79,-4649.9 13610.79,-4732.9"/>
<text text-anchor="middle" x="13506.79" y="-4717.7" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13506.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="13506.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13506.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13506.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_3&#45;&gt;layer3_q_proj_3_3 -->
<g id="edge1030" class="edge">
<title>layer3_ln1_3_3&#45;&gt;layer3_q_proj_3_3</title>
<path fill="none" stroke="black" d="M13578.04,-4771.65C13568.97,-4761.56 13559.32,-4750.83 13550.15,-4740.62"/>
<polygon fill="black" stroke="black" points="13552.53,-4738.04 13543.25,-4732.95 13547.33,-4742.72 13552.53,-4738.04"/>
</g>
<!-- layer3_k_proj_3_3 -->
<g id="node414" class="node">
<title>layer3_k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="13836.79,-4732.9 13628.79,-4732.9 13628.79,-4649.9 13836.79,-4649.9 13836.79,-4732.9"/>
<text text-anchor="middle" x="13732.79" y="-4717.7" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13732.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="13732.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13732.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13732.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_3&#45;&gt;layer3_k_proj_3_3 -->
<g id="edge1031" class="edge">
<title>layer3_ln1_3_3&#45;&gt;layer3_k_proj_3_3</title>
<path fill="none" stroke="black" d="M13659.95,-4772C13669.29,-4761.8 13679.25,-4750.91 13688.7,-4740.58"/>
<polygon fill="black" stroke="black" points="13691.31,-4742.91 13695.48,-4733.17 13686.15,-4738.18 13691.31,-4742.91"/>
</g>
<!-- layer3_v_proj_3_3 -->
<g id="node415" class="node">
<title>layer3_v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="14062.79,-4732.9 13854.79,-4732.9 13854.79,-4649.9 14062.79,-4649.9 14062.79,-4732.9"/>
<text text-anchor="middle" x="13958.79" y="-4717.7" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13958.79" y="-4702.7" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="13958.79" y="-4687.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13958.79" y="-4672.7" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13958.79" y="-4657.7" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_ln1_3_3&#45;&gt;layer3_v_proj_3_3 -->
<g id="edge1032" class="edge">
<title>layer3_ln1_3_3&#45;&gt;layer3_v_proj_3_3</title>
<path fill="none" stroke="black" d="M13713.5,-4782.28C13754.33,-4767.32 13802.42,-4749.7 13845.15,-4734.04"/>
<polygon fill="black" stroke="black" points="13846.56,-4737.25 13854.75,-4730.52 13844.15,-4730.68 13846.56,-4737.25"/>
</g>
<!-- layer3_attention_0_0 -->
<g id="node416" class="node">
<title>layer3_attention_0_0</title>
<polygon fill="lightcoral" stroke="black" points="4311.79,-4612.9 4085.79,-4529.9 4311.79,-4446.9 4537.79,-4529.9 4311.79,-4612.9"/>
<text text-anchor="middle" x="4311.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4311.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="4311.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="4311.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="4311.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_q_proj_0_0&#45;&gt;layer3_attention_0_0 -->
<g id="edge1033" class="edge">
<title>layer3_q_proj_0_0&#45;&gt;layer3_attention_0_0</title>
<path fill="none" stroke="black" d="M4129.25,-4649.74C4157.5,-4631.34 4191.41,-4609.27 4222.3,-4589.16"/>
<polygon fill="black" stroke="black" points="4224.45,-4591.94 4230.92,-4583.55 4220.63,-4586.07 4224.45,-4591.94"/>
</g>
<!-- layer3_k_proj_0_0&#45;&gt;layer3_attention_0_0 -->
<g id="edge1034" class="edge">
<title>layer3_k_proj_0_0&#45;&gt;layer3_attention_0_0</title>
<path fill="none" stroke="black" d="M4271.56,-4649.74C4275.32,-4638.63 4279.53,-4626.18 4283.78,-4613.63"/>
<polygon fill="black" stroke="black" points="4287.14,-4614.63 4287.03,-4604.04 4280.51,-4612.39 4287.14,-4614.63"/>
</g>
<!-- layer3_v_proj_0_0&#45;&gt;layer3_attention_0_0 -->
<g id="edge1035" class="edge">
<title>layer3_v_proj_0_0&#45;&gt;layer3_attention_0_0</title>
<path fill="none" stroke="black" d="M4413.87,-4649.74C4401.15,-4634.93 4386.38,-4617.73 4372.09,-4601.1"/>
<polygon fill="black" stroke="black" points="4374.74,-4598.81 4365.57,-4593.51 4369.43,-4603.37 4374.74,-4598.81"/>
</g>
<!-- layer3_attention_0_1 -->
<g id="node417" class="node">
<title>layer3_attention_0_1</title>
<polygon fill="lightcoral" stroke="black" points="4964.79,-4612.9 4738.79,-4529.9 4964.79,-4446.9 5190.79,-4529.9 4964.79,-4612.9"/>
<text text-anchor="middle" x="4964.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4964.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="4964.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="4964.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="4964.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_q_proj_0_1&#45;&gt;layer3_attention_0_1 -->
<g id="edge1036" class="edge">
<title>layer3_q_proj_0_1&#45;&gt;layer3_attention_0_1</title>
<path fill="none" stroke="black" d="M4729.35,-4649.74C4769.55,-4629.44 4818.64,-4604.66 4861.57,-4583"/>
<polygon fill="black" stroke="black" points="4863.29,-4586.05 4870.64,-4578.42 4860.13,-4579.8 4863.29,-4586.05"/>
</g>
<!-- layer3_k_proj_0_1&#45;&gt;layer3_attention_0_1 -->
<g id="edge1037" class="edge">
<title>layer3_k_proj_0_1&#45;&gt;layer3_attention_0_1</title>
<path fill="none" stroke="black" d="M4884.32,-4649.74C4893.55,-4636.11 4904.15,-4620.46 4914.56,-4605.08"/>
<polygon fill="black" stroke="black" points="4917.61,-4606.83 4920.31,-4596.58 4911.81,-4602.9 4917.61,-4606.83"/>
</g>
<!-- layer3_v_proj_0_1&#45;&gt;layer3_attention_0_1 -->
<g id="edge1038" class="edge">
<title>layer3_v_proj_0_1&#45;&gt;layer3_attention_0_1</title>
<path fill="none" stroke="black" d="M5039.3,-4649.74C5031.03,-4636.54 5021.57,-4621.45 5012.23,-4606.55"/>
<polygon fill="black" stroke="black" points="5015.03,-4604.43 5006.75,-4597.82 5009.1,-4608.15 5015.03,-4604.43"/>
</g>
<!-- layer3_attention_0_2 -->
<g id="node418" class="node">
<title>layer3_attention_0_2</title>
<polygon fill="lightcoral" stroke="black" points="5480.79,-4612.9 5254.79,-4529.9 5480.79,-4446.9 5706.79,-4529.9 5480.79,-4612.9"/>
<text text-anchor="middle" x="5480.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5480.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="5480.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5480.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5480.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_q_proj_0_2&#45;&gt;layer3_attention_0_2 -->
<g id="edge1039" class="edge">
<title>layer3_q_proj_0_2&#45;&gt;layer3_attention_0_2</title>
<path fill="none" stroke="black" d="M5325.82,-4649.74C5348.41,-4632.41 5375.26,-4611.82 5400.22,-4592.68"/>
<polygon fill="black" stroke="black" points="5402.44,-4595.39 5408.24,-4586.53 5398.18,-4589.84 5402.44,-4595.39"/>
</g>
<!-- layer3_k_proj_0_2&#45;&gt;layer3_attention_0_2 -->
<g id="edge1040" class="edge">
<title>layer3_k_proj_0_2&#45;&gt;layer3_attention_0_2</title>
<path fill="none" stroke="black" d="M5480.79,-4649.74C5480.79,-4641.47 5480.79,-4632.45 5480.79,-4623.21"/>
<polygon fill="black" stroke="black" points="5484.29,-4623.11 5480.79,-4613.11 5477.29,-4623.11 5484.29,-4623.11"/>
</g>
<!-- layer3_v_proj_0_2&#45;&gt;layer3_attention_0_2 -->
<g id="edge1041" class="edge">
<title>layer3_v_proj_0_2&#45;&gt;layer3_attention_0_2</title>
<path fill="none" stroke="black" d="M5635.77,-4649.74C5613.18,-4632.41 5586.32,-4611.82 5561.37,-4592.68"/>
<polygon fill="black" stroke="black" points="5563.4,-4589.84 5553.34,-4586.53 5559.14,-4595.39 5563.4,-4589.84"/>
</g>
<!-- layer3_attention_0_3 -->
<g id="node419" class="node">
<title>layer3_attention_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5989.79,-4612.9 5763.79,-4529.9 5989.79,-4446.9 6215.79,-4529.9 5989.79,-4612.9"/>
<text text-anchor="middle" x="5989.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5989.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="5989.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5989.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5989.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_q_proj_0_3&#45;&gt;layer3_attention_0_3 -->
<g id="edge1042" class="edge">
<title>layer3_q_proj_0_3&#45;&gt;layer3_attention_0_3</title>
<path fill="none" stroke="black" d="M5920.5,-4649.74C5928.03,-4636.82 5936.62,-4622.08 5945.13,-4607.49"/>
<polygon fill="black" stroke="black" points="5948.4,-4608.84 5950.41,-4598.44 5942.35,-4605.31 5948.4,-4608.84"/>
</g>
<!-- layer3_k_proj_0_3&#45;&gt;layer3_attention_0_3 -->
<g id="edge1043" class="edge">
<title>layer3_k_proj_0_3&#45;&gt;layer3_attention_0_3</title>
<path fill="none" stroke="black" d="M6075.47,-4649.74C6065.44,-4635.82 6053.89,-4619.8 6042.59,-4604.12"/>
<polygon fill="black" stroke="black" points="6045.39,-4602.03 6036.71,-4595.97 6039.72,-4606.13 6045.39,-4602.03"/>
</g>
<!-- layer3_v_proj_0_3&#45;&gt;layer3_attention_0_3 -->
<g id="edge1044" class="edge">
<title>layer3_v_proj_0_3&#45;&gt;layer3_attention_0_3</title>
<path fill="none" stroke="black" d="M6230.45,-4649.74C6189.01,-4629.27 6138.33,-4604.24 6094.18,-4582.44"/>
<polygon fill="black" stroke="black" points="6095.67,-4579.28 6085.15,-4577.99 6092.57,-4585.55 6095.67,-4579.28"/>
</g>
<!-- layer3_attention_1_0 -->
<g id="node420" class="node">
<title>layer3_attention_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6777.79,-4612.9 6551.79,-4529.9 6777.79,-4446.9 7003.79,-4529.9 6777.79,-4612.9"/>
<text text-anchor="middle" x="6777.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6777.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="6777.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6777.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6777.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_q_proj_1_0&#45;&gt;layer3_attention_1_0 -->
<g id="edge1045" class="edge">
<title>layer3_q_proj_1_0&#45;&gt;layer3_attention_1_0</title>
<path fill="none" stroke="black" d="M6580.35,-4649.74C6611.87,-4630.76 6649.91,-4607.87 6684.15,-4587.26"/>
<polygon fill="black" stroke="black" points="6686.01,-4590.22 6692.77,-4582.07 6682.4,-4584.23 6686.01,-4590.22"/>
</g>
<!-- layer3_k_proj_1_0&#45;&gt;layer3_attention_1_0 -->
<g id="edge1046" class="edge">
<title>layer3_k_proj_1_0&#45;&gt;layer3_attention_1_0</title>
<path fill="none" stroke="black" d="M6722.66,-4649.74C6728.22,-4637.74 6734.52,-4624.17 6740.81,-4610.6"/>
<polygon fill="black" stroke="black" points="6744.13,-4611.78 6745.16,-4601.23 6737.78,-4608.83 6744.13,-4611.78"/>
</g>
<!-- layer3_v_proj_1_0&#45;&gt;layer3_attention_1_0 -->
<g id="edge1047" class="edge">
<title>layer3_v_proj_1_0&#45;&gt;layer3_attention_1_0</title>
<path fill="none" stroke="black" d="M6864.96,-4649.74C6854.7,-4635.75 6842.88,-4619.62 6831.31,-4603.86"/>
<polygon fill="black" stroke="black" points="6834.03,-4601.65 6825.3,-4595.66 6828.39,-4605.79 6834.03,-4601.65"/>
</g>
<!-- layer3_attention_1_1 -->
<g id="node421" class="node">
<title>layer3_attention_1_1</title>
<polygon fill="lightcoral" stroke="black" points="7392.79,-4612.9 7166.79,-4529.9 7392.79,-4446.9 7618.79,-4529.9 7392.79,-4612.9"/>
<text text-anchor="middle" x="7392.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7392.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7392.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7392.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7392.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_q_proj_1_1&#45;&gt;layer3_attention_1_1 -->
<g id="edge1048" class="edge">
<title>layer3_q_proj_1_1&#45;&gt;layer3_attention_1_1</title>
<path fill="none" stroke="black" d="M7170.76,-4649.74C7207.87,-4629.87 7253.02,-4605.71 7292.88,-4584.37"/>
<polygon fill="black" stroke="black" points="7294.67,-4587.39 7301.83,-4579.58 7291.36,-4581.21 7294.67,-4587.39"/>
</g>
<!-- layer3_k_proj_1_1&#45;&gt;layer3_attention_1_1 -->
<g id="edge1049" class="edge">
<title>layer3_k_proj_1_1&#45;&gt;layer3_attention_1_1</title>
<path fill="none" stroke="black" d="M7325.74,-4649.74C7332.94,-4636.97 7341.14,-4622.43 7349.28,-4608.01"/>
<polygon fill="black" stroke="black" points="7352.46,-4609.49 7354.33,-4599.06 7346.37,-4606.05 7352.46,-4609.49"/>
</g>
<!-- layer3_v_proj_1_1&#45;&gt;layer3_attention_1_1 -->
<g id="edge1050" class="edge">
<title>layer3_v_proj_1_1&#45;&gt;layer3_attention_1_1</title>
<path fill="none" stroke="black" d="M7480.71,-4649.74C7470.36,-4635.75 7458.43,-4619.62 7446.77,-4603.86"/>
<polygon fill="black" stroke="black" points="7449.46,-4601.62 7440.7,-4595.66 7443.84,-4605.78 7449.46,-4601.62"/>
</g>
<!-- layer3_attention_1_2 -->
<g id="node422" class="node">
<title>layer3_attention_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7926.79,-4612.9 7700.79,-4529.9 7926.79,-4446.9 8152.79,-4529.9 7926.79,-4612.9"/>
<text text-anchor="middle" x="7926.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7926.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="7926.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7926.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7926.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_q_proj_1_2&#45;&gt;layer3_attention_1_2 -->
<g id="edge1051" class="edge">
<title>layer3_q_proj_1_2&#45;&gt;layer3_attention_1_2</title>
<path fill="none" stroke="black" d="M7771.82,-4649.74C7794.41,-4632.41 7821.26,-4611.82 7846.22,-4592.68"/>
<polygon fill="black" stroke="black" points="7848.44,-4595.39 7854.24,-4586.53 7844.18,-4589.84 7848.44,-4595.39"/>
</g>
<!-- layer3_k_proj_1_2&#45;&gt;layer3_attention_1_2 -->
<g id="edge1052" class="edge">
<title>layer3_k_proj_1_2&#45;&gt;layer3_attention_1_2</title>
<path fill="none" stroke="black" d="M7926.79,-4649.74C7926.79,-4641.47 7926.79,-4632.45 7926.79,-4623.21"/>
<polygon fill="black" stroke="black" points="7930.29,-4623.11 7926.79,-4613.11 7923.29,-4623.11 7930.29,-4623.11"/>
</g>
<!-- layer3_v_proj_1_2&#45;&gt;layer3_attention_1_2 -->
<g id="edge1053" class="edge">
<title>layer3_v_proj_1_2&#45;&gt;layer3_attention_1_2</title>
<path fill="none" stroke="black" d="M8081.77,-4649.74C8059.18,-4632.41 8032.32,-4611.82 8007.37,-4592.68"/>
<polygon fill="black" stroke="black" points="8009.4,-4589.84 7999.34,-4586.53 8005.14,-4595.39 8009.4,-4589.84"/>
</g>
<!-- layer3_attention_1_3 -->
<g id="node423" class="node">
<title>layer3_attention_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8473.79,-4612.9 8247.79,-4529.9 8473.79,-4446.9 8699.79,-4529.9 8473.79,-4612.9"/>
<text text-anchor="middle" x="8473.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8473.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="8473.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8473.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8473.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_q_proj_1_3&#45;&gt;layer3_attention_1_3 -->
<g id="edge1054" class="edge">
<title>layer3_q_proj_1_3&#45;&gt;layer3_attention_1_3</title>
<path fill="none" stroke="black" d="M8376.19,-4649.74C8388.11,-4635.22 8401.92,-4618.41 8415.32,-4602.08"/>
<polygon fill="black" stroke="black" points="8418.22,-4604.07 8421.86,-4594.12 8412.81,-4599.63 8418.22,-4604.07"/>
</g>
<!-- layer3_k_proj_1_3&#45;&gt;layer3_attention_1_3 -->
<g id="edge1055" class="edge">
<title>layer3_k_proj_1_3&#45;&gt;layer3_attention_1_3</title>
<path fill="none" stroke="black" d="M8531.16,-4649.74C8525.24,-4637.47 8518.53,-4623.57 8511.83,-4609.7"/>
<polygon fill="black" stroke="black" points="8514.95,-4608.1 8507.45,-4600.61 8508.64,-4611.14 8514.95,-4608.1"/>
</g>
<!-- layer3_v_proj_1_3&#45;&gt;layer3_attention_1_3 -->
<g id="edge1056" class="edge">
<title>layer3_v_proj_1_3&#45;&gt;layer3_attention_1_3</title>
<path fill="none" stroke="black" d="M8686.14,-4649.74C8651.25,-4630.21 8608.94,-4606.53 8571.3,-4585.47"/>
<polygon fill="black" stroke="black" points="8572.78,-4582.29 8562.34,-4580.46 8569.36,-4588.39 8572.78,-4582.29"/>
</g>
<!-- layer3_attention_2_0 -->
<g id="node424" class="node">
<title>layer3_attention_2_0</title>
<polygon fill="lightcoral" stroke="black" points="9238.79,-4612.9 9012.79,-4529.9 9238.79,-4446.9 9464.79,-4529.9 9238.79,-4612.9"/>
<text text-anchor="middle" x="9238.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9238.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="9238.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9238.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9238.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_q_proj_2_0&#45;&gt;layer3_attention_2_0 -->
<g id="edge1057" class="edge">
<title>layer3_q_proj_2_0&#45;&gt;layer3_attention_2_0</title>
<path fill="none" stroke="black" d="M9033.15,-4649.74C9066.5,-4630.46 9106.85,-4607.15 9142.94,-4586.29"/>
<polygon fill="black" stroke="black" points="9145.11,-4589.07 9152.02,-4581.04 9141.61,-4583.01 9145.11,-4589.07"/>
</g>
<!-- layer3_k_proj_2_0&#45;&gt;layer3_attention_2_0 -->
<g id="edge1058" class="edge">
<title>layer3_k_proj_2_0&#45;&gt;layer3_attention_2_0</title>
<path fill="none" stroke="black" d="M9181.42,-4649.74C9187.34,-4637.47 9194.05,-4623.57 9200.75,-4609.7"/>
<polygon fill="black" stroke="black" points="9203.94,-4611.14 9205.14,-4600.61 9197.64,-4608.1 9203.94,-4611.14"/>
</g>
<!-- layer3_v_proj_2_0&#45;&gt;layer3_attention_2_0 -->
<g id="edge1059" class="edge">
<title>layer3_v_proj_2_0&#45;&gt;layer3_attention_2_0</title>
<path fill="none" stroke="black" d="M9329.69,-4649.74C9318.87,-4635.59 9306.38,-4619.26 9294.19,-4603.33"/>
<polygon fill="black" stroke="black" points="9296.71,-4600.86 9287.86,-4595.04 9291.15,-4605.11 9296.71,-4600.86"/>
</g>
<!-- layer3_attention_2_1 -->
<g id="node425" class="node">
<title>layer3_attention_2_1</title>
<polygon fill="lightcoral" stroke="black" points="9785.79,-4612.9 9559.79,-4529.9 9785.79,-4446.9 10011.79,-4529.9 9785.79,-4612.9"/>
<text text-anchor="middle" x="9785.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9785.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="9785.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9785.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9785.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_q_proj_2_1&#45;&gt;layer3_attention_2_1 -->
<g id="edge1060" class="edge">
<title>layer3_q_proj_2_1&#45;&gt;layer3_attention_2_1</title>
<path fill="none" stroke="black" d="M9624.11,-4649.74C9648.12,-4632.09 9676.75,-4611.04 9703.2,-4591.61"/>
<polygon fill="black" stroke="black" points="9705.34,-4594.37 9711.33,-4585.63 9701.2,-4588.73 9705.34,-4594.37"/>
</g>
<!-- layer3_k_proj_2_1&#45;&gt;layer3_attention_2_1 -->
<g id="edge1061" class="edge">
<title>layer3_k_proj_2_1&#45;&gt;layer3_attention_2_1</title>
<path fill="none" stroke="black" d="M9785.79,-4649.74C9785.79,-4641.47 9785.79,-4632.45 9785.79,-4623.21"/>
<polygon fill="black" stroke="black" points="9789.29,-4623.11 9785.79,-4613.11 9782.29,-4623.11 9789.29,-4623.11"/>
</g>
<!-- layer3_v_proj_2_1&#45;&gt;layer3_attention_2_1 -->
<g id="edge1062" class="edge">
<title>layer3_v_proj_2_1&#45;&gt;layer3_attention_2_1</title>
<path fill="none" stroke="black" d="M9947.47,-4649.74C9923.46,-4632.09 9894.83,-4611.04 9868.39,-4591.61"/>
<polygon fill="black" stroke="black" points="9870.39,-4588.73 9860.26,-4585.63 9866.24,-4594.37 9870.39,-4588.73"/>
</g>
<!-- layer3_attention_2_2 -->
<g id="node426" class="node">
<title>layer3_attention_2_2</title>
<polygon fill="lightcoral" stroke="black" points="10340.79,-4612.9 10114.79,-4529.9 10340.79,-4446.9 10566.79,-4529.9 10340.79,-4612.9"/>
<text text-anchor="middle" x="10340.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10340.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="10340.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10340.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10340.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_q_proj_2_2&#45;&gt;layer3_attention_2_2 -->
<g id="edge1063" class="edge">
<title>layer3_q_proj_2_2&#45;&gt;layer3_attention_2_2</title>
<path fill="none" stroke="black" d="M10250.64,-4649.74C10261.37,-4635.59 10273.76,-4619.26 10285.85,-4603.33"/>
<polygon fill="black" stroke="black" points="10288.87,-4605.12 10292.13,-4595.04 10283.3,-4600.89 10288.87,-4605.12"/>
</g>
<!-- layer3_k_proj_2_2&#45;&gt;layer3_attention_2_2 -->
<g id="edge1064" class="edge">
<title>layer3_k_proj_2_2&#45;&gt;layer3_attention_2_2</title>
<path fill="none" stroke="black" d="M10412.32,-4649.74C10404.42,-4636.62 10395.4,-4621.63 10386.49,-4606.82"/>
<polygon fill="black" stroke="black" points="10389.41,-4604.89 10381.26,-4598.13 10383.42,-4608.5 10389.41,-4604.89"/>
</g>
<!-- layer3_v_proj_2_2&#45;&gt;layer3_attention_2_2 -->
<g id="edge1065" class="edge">
<title>layer3_v_proj_2_2&#45;&gt;layer3_attention_2_2</title>
<path fill="none" stroke="black" d="M10574,-4649.74C10534.26,-4629.49 10485.76,-4604.77 10443.3,-4583.13"/>
<polygon fill="black" stroke="black" points="10444.83,-4579.99 10434.34,-4578.57 10441.66,-4586.22 10444.83,-4579.99"/>
</g>
<!-- layer3_attention_2_3 -->
<g id="node427" class="node">
<title>layer3_attention_2_3</title>
<polygon fill="lightcoral" stroke="black" points="10979.79,-4612.9 10753.79,-4529.9 10979.79,-4446.9 11205.79,-4529.9 10979.79,-4612.9"/>
<text text-anchor="middle" x="10979.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10979.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="10979.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10979.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10979.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_q_proj_2_3&#45;&gt;layer3_attention_2_3 -->
<g id="edge1066" class="edge">
<title>layer3_q_proj_2_3&#45;&gt;layer3_attention_2_3</title>
<path fill="none" stroke="black" d="M10898.58,-4649.74C10907.89,-4636.11 10918.59,-4620.46 10929.09,-4605.08"/>
<polygon fill="black" stroke="black" points="10932.15,-4606.81 10934.9,-4596.58 10926.37,-4602.87 10932.15,-4606.81"/>
</g>
<!-- layer3_k_proj_2_3&#45;&gt;layer3_attention_2_3 -->
<g id="edge1067" class="edge">
<title>layer3_k_proj_2_3&#45;&gt;layer3_attention_2_3</title>
<path fill="none" stroke="black" d="M11060.26,-4649.74C11051.03,-4636.11 11040.43,-4620.46 11030.02,-4605.08"/>
<polygon fill="black" stroke="black" points="11032.77,-4602.9 11024.27,-4596.58 11026.98,-4606.83 11032.77,-4602.9"/>
</g>
<!-- layer3_v_proj_2_3&#45;&gt;layer3_attention_2_3 -->
<g id="edge1068" class="edge">
<title>layer3_v_proj_2_3&#45;&gt;layer3_attention_2_3</title>
<path fill="none" stroke="black" d="M11221.94,-4649.74C11180.15,-4629.23 11129.03,-4604.14 11084.55,-4582.31"/>
<polygon fill="black" stroke="black" points="11085.97,-4579.11 11075.45,-4577.84 11082.89,-4585.39 11085.97,-4579.11"/>
</g>
<!-- layer3_attention_3_0 -->
<g id="node428" class="node">
<title>layer3_attention_3_0</title>
<polygon fill="lightcoral" stroke="black" points="11816.79,-4612.9 11590.79,-4529.9 11816.79,-4446.9 12042.79,-4529.9 11816.79,-4612.9"/>
<text text-anchor="middle" x="11816.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11816.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="11816.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11816.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11816.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_q_proj_3_0&#45;&gt;layer3_attention_3_0 -->
<g id="edge1069" class="edge">
<title>layer3_q_proj_3_0&#45;&gt;layer3_attention_3_0</title>
<path fill="none" stroke="black" d="M11594.02,-4649.74C11631.25,-4629.87 11676.55,-4605.71 11716.55,-4584.37"/>
<polygon fill="black" stroke="black" points="11718.35,-4587.38 11725.53,-4579.58 11715.06,-4581.2 11718.35,-4587.38"/>
</g>
<!-- layer3_k_proj_3_0&#45;&gt;layer3_attention_3_0 -->
<g id="edge1070" class="edge">
<title>layer3_k_proj_3_0&#45;&gt;layer3_attention_3_0</title>
<path fill="none" stroke="black" d="M11748.99,-4649.74C11756.32,-4636.89 11764.67,-4622.26 11772.94,-4607.75"/>
<polygon fill="black" stroke="black" points="11776.16,-4609.17 11778.08,-4598.75 11770.08,-4605.7 11776.16,-4609.17"/>
</g>
<!-- layer3_v_proj_3_0&#45;&gt;layer3_attention_3_0 -->
<g id="edge1071" class="edge">
<title>layer3_v_proj_3_0&#45;&gt;layer3_attention_3_0</title>
<path fill="none" stroke="black" d="M11903.96,-4649.74C11893.7,-4635.75 11881.88,-4619.62 11870.31,-4603.86"/>
<polygon fill="black" stroke="black" points="11873.03,-4601.65 11864.3,-4595.66 11867.39,-4605.79 11873.03,-4601.65"/>
</g>
<!-- layer3_attention_3_1 -->
<g id="node429" class="node">
<title>layer3_attention_3_1</title>
<polygon fill="lightcoral" stroke="black" points="12376.79,-4612.9 12150.79,-4529.9 12376.79,-4446.9 12602.79,-4529.9 12376.79,-4612.9"/>
<text text-anchor="middle" x="12376.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12376.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="12376.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12376.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12376.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_q_proj_3_1&#45;&gt;layer3_attention_3_1 -->
<g id="edge1072" class="edge">
<title>layer3_q_proj_3_1&#45;&gt;layer3_attention_3_1</title>
<path fill="none" stroke="black" d="M12208.41,-4649.74C12233.76,-4631.84 12264.05,-4610.46 12291.91,-4590.8"/>
<polygon fill="black" stroke="black" points="12293.93,-4593.66 12300.08,-4585.03 12289.9,-4587.94 12293.93,-4593.66"/>
</g>
<!-- layer3_k_proj_3_1&#45;&gt;layer3_attention_3_1 -->
<g id="edge1073" class="edge">
<title>layer3_k_proj_3_1&#45;&gt;layer3_attention_3_1</title>
<path fill="none" stroke="black" d="M12376.79,-4649.74C12376.79,-4641.47 12376.79,-4632.45 12376.79,-4623.21"/>
<polygon fill="black" stroke="black" points="12380.29,-4623.11 12376.79,-4613.11 12373.29,-4623.11 12380.29,-4623.11"/>
</g>
<!-- layer3_v_proj_3_1&#45;&gt;layer3_attention_3_1 -->
<g id="edge1074" class="edge">
<title>layer3_v_proj_3_1&#45;&gt;layer3_attention_3_1</title>
<path fill="none" stroke="black" d="M12545.18,-4649.74C12519.82,-4631.84 12489.53,-4610.46 12461.67,-4590.8"/>
<polygon fill="black" stroke="black" points="12463.69,-4587.94 12453.5,-4585.03 12459.65,-4593.66 12463.69,-4587.94"/>
</g>
<!-- layer3_attention_3_2 -->
<g id="node430" class="node">
<title>layer3_attention_3_2</title>
<polygon fill="lightcoral" stroke="black" points="12999.79,-4612.9 12773.79,-4529.9 12999.79,-4446.9 13225.79,-4529.9 12999.79,-4612.9"/>
<text text-anchor="middle" x="12999.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12999.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="12999.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12999.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12999.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_q_proj_3_2&#45;&gt;layer3_attention_3_2 -->
<g id="edge1075" class="edge">
<title>layer3_q_proj_3_2&#45;&gt;layer3_attention_3_2</title>
<path fill="none" stroke="black" d="M12872.38,-4649.74C12889.67,-4633.61 12909.99,-4614.66 12929.26,-4596.68"/>
<polygon fill="black" stroke="black" points="12931.67,-4599.23 12936.59,-4589.85 12926.89,-4594.11 12931.67,-4599.23"/>
</g>
<!-- layer3_k_proj_3_2&#45;&gt;layer3_attention_3_2 -->
<g id="edge1076" class="edge">
<title>layer3_k_proj_3_2&#45;&gt;layer3_attention_3_2</title>
<path fill="none" stroke="black" d="M13040.77,-4649.74C13036.92,-4638.56 13032.59,-4626.02 13028.23,-4613.38"/>
<polygon fill="black" stroke="black" points="13031.47,-4612.04 13024.9,-4603.73 13024.86,-4614.32 13031.47,-4612.04"/>
</g>
<!-- layer3_v_proj_3_2&#45;&gt;layer3_attention_3_2 -->
<g id="edge1077" class="edge">
<title>layer3_v_proj_3_2&#45;&gt;layer3_attention_3_2</title>
<path fill="none" stroke="black" d="M13209.16,-4649.74C13174.91,-4630.3 13133.41,-4606.74 13096.42,-4585.74"/>
<polygon fill="black" stroke="black" points="13098.04,-4582.64 13087.62,-4580.75 13094.59,-4588.73 13098.04,-4582.64"/>
</g>
<!-- layer3_attention_3_3 -->
<g id="node431" class="node">
<title>layer3_attention_3_3</title>
<polygon fill="lightcoral" stroke="black" points="13560.79,-4612.9 13334.79,-4529.9 13560.79,-4446.9 13786.79,-4529.9 13560.79,-4612.9"/>
<text text-anchor="middle" x="13560.79" y="-4556.2" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13560.79" y="-4541.2" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="13560.79" y="-4526.2" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="13560.79" y="-4511.2" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="13560.79" y="-4496.2" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_q_proj_3_3&#45;&gt;layer3_attention_3_3 -->
<g id="edge1078" class="edge">
<title>layer3_q_proj_3_3&#45;&gt;layer3_attention_3_3</title>
<path fill="none" stroke="black" d="M13520.56,-4649.74C13524.32,-4638.63 13528.53,-4626.18 13532.78,-4613.63"/>
<polygon fill="black" stroke="black" points="13536.14,-4614.63 13536.03,-4604.04 13529.51,-4612.39 13536.14,-4614.63"/>
</g>
<!-- layer3_k_proj_3_3&#45;&gt;layer3_attention_3_3 -->
<g id="edge1079" class="edge">
<title>layer3_k_proj_3_3&#45;&gt;layer3_attention_3_3</title>
<path fill="none" stroke="black" d="M13688.94,-4649.74C13671.56,-4633.61 13651.12,-4614.66 13631.73,-4596.68"/>
<polygon fill="black" stroke="black" points="13634.07,-4594.08 13624.36,-4589.85 13629.31,-4599.21 13634.07,-4594.08"/>
</g>
<!-- layer3_v_proj_3_3&#45;&gt;layer3_attention_3_3 -->
<g id="edge1080" class="edge">
<title>layer3_v_proj_3_3&#45;&gt;layer3_attention_3_3</title>
<path fill="none" stroke="black" d="M13857.59,-4649.84C13802.61,-4627.81 13734.38,-4600.46 13677.21,-4577.55"/>
<polygon fill="black" stroke="black" points="13678.35,-4574.24 13667.77,-4573.77 13675.75,-4580.74 13678.35,-4574.24"/>
</g>
<!-- layer3_concat_dim_0 -->
<g id="node432" class="node">
<title>layer3_concat_dim_0</title>
<polygon fill="orange" stroke="black" points="5616.87,-4409.9 5344.72,-4409.9 5247.79,-4273.9 5713.79,-4273.9 5616.87,-4409.9"/>
<text text-anchor="middle" x="5480.79" y="-4360.7" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="5480.79" y="-4345.7" font-family="Times,serif" font-size="14.00">HeadGroup:0</text>
<text text-anchor="middle" x="5480.79" y="-4330.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="5480.79" y="-4315.7" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3 (communication)</text>
</g>
<!-- layer3_attention_0_0&#45;&gt;layer3_concat_dim_0 -->
<g id="edge1081" class="edge">
<title>layer3_attention_0_0&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M4454.11,-4498.92C4534.78,-4482.45 4637.7,-4462.29 4729.79,-4446.9 4924.63,-4414.32 5149.13,-4384.2 5301.55,-4364.85"/>
<polygon fill="black" stroke="black" points="5302,-4368.32 5311.49,-4363.59 5301.12,-4361.37 5302,-4368.32"/>
</g>
<!-- layer3_attention_0_1&#45;&gt;layer3_concat_dim_0 -->
<g id="edge1082" class="edge">
<title>layer3_attention_0_1&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M5077.71,-4488.19C5150.1,-4462.1 5245.08,-4427.86 5324.65,-4399.18"/>
<polygon fill="black" stroke="black" points="5326.06,-4402.39 5334.28,-4395.71 5323.68,-4395.81 5326.06,-4402.39"/>
</g>
<!-- layer3_attention_0_2&#45;&gt;layer3_concat_dim_0 -->
<g id="edge1083" class="edge">
<title>layer3_attention_0_2&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M5480.79,-4446.77C5480.79,-4437.96 5480.79,-4429.01 5480.79,-4420.26"/>
<polygon fill="black" stroke="black" points="5484.29,-4420.09 5480.79,-4410.09 5477.29,-4420.09 5484.29,-4420.09"/>
</g>
<!-- layer3_attention_0_3&#45;&gt;layer3_concat_dim_0 -->
<g id="edge1084" class="edge">
<title>layer3_attention_0_3&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M5877.77,-4487.96C5806.89,-4462.06 5714.26,-4428.21 5636.3,-4399.72"/>
<polygon fill="black" stroke="black" points="5637.47,-4396.42 5626.87,-4396.28 5635.06,-4403 5637.47,-4396.42"/>
</g>
<!-- layer3_concat_dim_1 -->
<g id="node433" class="node">
<title>layer3_concat_dim_1</title>
<polygon fill="orange" stroke="black" points="8062.87,-4409.9 7790.72,-4409.9 7693.79,-4273.9 8159.79,-4273.9 8062.87,-4409.9"/>
<text text-anchor="middle" x="7926.79" y="-4360.7" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7926.79" y="-4345.7" font-family="Times,serif" font-size="14.00">HeadGroup:1</text>
<text text-anchor="middle" x="7926.79" y="-4330.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7926.79" y="-4315.7" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7 (communication)</text>
</g>
<!-- layer3_attention_1_0&#45;&gt;layer3_concat_dim_1 -->
<g id="edge1085" class="edge">
<title>layer3_attention_1_0&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M6914.03,-4496.8C6986.22,-4480.48 7076.52,-4461.14 7157.79,-4446.9 7358.25,-4411.77 7589.89,-4381.89 7746.12,-4363.29"/>
<polygon fill="black" stroke="black" points="7746.78,-4366.74 7756.3,-4362.08 7745.96,-4359.78 7746.78,-4366.74"/>
</g>
<!-- layer3_attention_1_1&#45;&gt;layer3_concat_dim_1 -->
<g id="edge1086" class="edge">
<title>layer3_attention_1_1&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M7507.68,-4488.88C7584.12,-4462.25 7685.53,-4426.93 7769.45,-4397.7"/>
<polygon fill="black" stroke="black" points="7770.78,-4400.94 7779.07,-4394.35 7768.48,-4394.33 7770.78,-4400.94"/>
</g>
<!-- layer3_attention_1_2&#45;&gt;layer3_concat_dim_1 -->
<g id="edge1087" class="edge">
<title>layer3_attention_1_2&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M7926.79,-4446.77C7926.79,-4437.96 7926.79,-4429.01 7926.79,-4420.26"/>
<polygon fill="black" stroke="black" points="7930.29,-4420.09 7926.79,-4410.09 7923.29,-4420.09 7930.29,-4420.09"/>
</g>
<!-- layer3_attention_1_3&#45;&gt;layer3_concat_dim_1 -->
<g id="edge1088" class="edge">
<title>layer3_attention_1_3&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M8357.79,-4489.45C8278.29,-4462.42 8171.86,-4426.23 8084.65,-4396.58"/>
<polygon fill="black" stroke="black" points="8085.52,-4393.18 8074.93,-4393.27 8083.27,-4399.8 8085.52,-4393.18"/>
</g>
<!-- layer3_concat_dim_2 -->
<g id="node434" class="node">
<title>layer3_concat_dim_2</title>
<polygon fill="orange" stroke="black" points="9921.87,-4409.9 9649.72,-4409.9 9552.79,-4273.9 10018.79,-4273.9 9921.87,-4409.9"/>
<text text-anchor="middle" x="9785.79" y="-4360.7" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="9785.79" y="-4345.7" font-family="Times,serif" font-size="14.00">HeadGroup:2</text>
<text text-anchor="middle" x="9785.79" y="-4330.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9785.79" y="-4315.7" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11 (communication)</text>
</g>
<!-- layer3_attention_2_0&#45;&gt;layer3_concat_dim_2 -->
<g id="edge1089" class="edge">
<title>layer3_attention_2_0&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M9354.8,-4489.45C9434.29,-4462.42 9540.72,-4426.23 9627.93,-4396.58"/>
<polygon fill="black" stroke="black" points="9629.31,-4399.8 9637.65,-4393.27 9627.06,-4393.18 9629.31,-4399.8"/>
</g>
<!-- layer3_attention_2_1&#45;&gt;layer3_concat_dim_2 -->
<g id="edge1090" class="edge">
<title>layer3_attention_2_1&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M9785.79,-4446.77C9785.79,-4437.96 9785.79,-4429.01 9785.79,-4420.26"/>
<polygon fill="black" stroke="black" points="9789.29,-4420.09 9785.79,-4410.09 9782.29,-4420.09 9789.29,-4420.09"/>
</g>
<!-- layer3_attention_2_2&#45;&gt;layer3_concat_dim_2 -->
<g id="edge1091" class="edge">
<title>layer3_attention_2_2&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M10223.77,-4489.68C10142.45,-4462.43 10033.13,-4425.79 9944.05,-4395.93"/>
<polygon fill="black" stroke="black" points="9944.99,-4392.56 9934.39,-4392.7 9942.76,-4399.2 9944.99,-4392.56"/>
</g>
<!-- layer3_attention_2_3&#45;&gt;layer3_concat_dim_2 -->
<g id="edge1092" class="edge">
<title>layer3_attention_2_3&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M10840.01,-4498.04C10762.42,-4481.54 10664.03,-4461.64 10575.79,-4446.9 10367.47,-4412.09 10126.64,-4381.81 9966.17,-4363.03"/>
<polygon fill="black" stroke="black" points="9966.54,-4359.55 9956.2,-4361.87 9965.73,-4366.51 9966.54,-4359.55"/>
</g>
<!-- layer3_concat_dim_3 -->
<g id="node435" class="node">
<title>layer3_concat_dim_3</title>
<polygon fill="orange" stroke="black" points="12512.87,-4409.9 12240.72,-4409.9 12143.79,-4273.9 12609.79,-4273.9 12512.87,-4409.9"/>
<text text-anchor="middle" x="12376.79" y="-4360.7" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="12376.79" y="-4345.7" font-family="Times,serif" font-size="14.00">HeadGroup:3</text>
<text text-anchor="middle" x="12376.79" y="-4330.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="12376.79" y="-4315.7" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15 (communication)</text>
</g>
<!-- layer3_attention_3_0&#45;&gt;layer3_concat_dim_3 -->
<g id="edge1093" class="edge">
<title>layer3_attention_3_0&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M11934.19,-4489.91C12016.74,-4462.49 12128.15,-4425.48 12218.53,-4395.46"/>
<polygon fill="black" stroke="black" points="12219.66,-4398.77 12228.05,-4392.3 12217.46,-4392.13 12219.66,-4398.77"/>
</g>
<!-- layer3_attention_3_1&#45;&gt;layer3_concat_dim_3 -->
<g id="edge1094" class="edge">
<title>layer3_attention_3_1&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M12376.79,-4446.77C12376.79,-4437.96 12376.79,-4429.01 12376.79,-4420.26"/>
<polygon fill="black" stroke="black" points="12380.29,-4420.09 12376.79,-4410.09 12373.29,-4420.09 12380.29,-4420.09"/>
</g>
<!-- layer3_attention_3_2&#45;&gt;layer3_concat_dim_3 -->
<g id="edge1095" class="edge">
<title>layer3_attention_3_2&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M12876.33,-4492.04C12779.41,-4463.1 12643.68,-4422.58 12538.16,-4391.07"/>
<polygon fill="black" stroke="black" points="12538.95,-4387.66 12528.37,-4388.15 12536.95,-4394.36 12538.95,-4387.66"/>
</g>
<!-- layer3_attention_3_3&#45;&gt;layer3_concat_dim_3 -->
<g id="edge1096" class="edge">
<title>layer3_attention_3_3&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M13434.27,-4493.13C13374.21,-4477.17 13301.21,-4459.22 13234.79,-4446.9 13003.96,-4404.05 12734.79,-4374.73 12560.37,-4358.41"/>
<polygon fill="black" stroke="black" points="12560.6,-4354.91 12550.32,-4357.47 12559.95,-4361.88 12560.6,-4354.91"/>
</g>
<!-- layer3_concat_heads -->
<g id="node436" class="node">
<title>layer3_concat_heads</title>
<polygon fill="gold" stroke="black" points="8515.93,-4236.9 8277.65,-4236.9 8192.79,-4130.9 8600.79,-4130.9 8515.93,-4236.9"/>
<text text-anchor="middle" x="8396.79" y="-4195.2" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="8396.79" y="-4180.2" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8396.79" y="-4165.2" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllGather)</text>
</g>
<!-- layer3_concat_dim_0&#45;&gt;layer3_concat_heads -->
<g id="edge1097" class="edge">
<title>layer3_concat_dim_0&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M5673.53,-4330.59C6212.5,-4301.75 7728.6,-4220.64 8232,-4193.71"/>
<polygon fill="black" stroke="black" points="8232.45,-4197.19 8242.25,-4193.16 8232.08,-4190.2 8232.45,-4197.19"/>
</g>
<!-- layer3_concat_dim_1&#45;&gt;layer3_concat_heads -->
<g id="edge1098" class="edge">
<title>layer3_concat_dim_1&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M8128.84,-4273.83C8173.16,-4259.12 8219.07,-4243.88 8260.11,-4230.26"/>
<polygon fill="black" stroke="black" points="8261.21,-4233.58 8269.6,-4227.11 8259.01,-4226.94 8261.21,-4233.58"/>
</g>
<!-- layer3_concat_dim_2&#45;&gt;layer3_concat_heads -->
<g id="edge1099" class="edge">
<title>layer3_concat_dim_2&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M9584.19,-4318.25C9305.49,-4286.95 8808.25,-4231.11 8554.79,-4202.64"/>
<polygon fill="black" stroke="black" points="8555.09,-4199.15 8544.76,-4201.52 8554.3,-4206.11 8555.09,-4199.15"/>
</g>
<!-- layer3_concat_dim_3&#45;&gt;layer3_concat_heads -->
<g id="edge1100" class="edge">
<title>layer3_concat_dim_3&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M12186.17,-4333.43C11505.75,-4306.76 9203.14,-4216.5 8563.08,-4191.41"/>
<polygon fill="black" stroke="black" points="8562.98,-4187.91 8552.85,-4191.01 8562.71,-4194.9 8562.98,-4187.91"/>
</g>
<!-- layer3_o_proj_0_0 -->
<g id="node437" class="node">
<title>layer3_o_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="6875.79,-4093.9 6677.79,-4093.9 6677.79,-4010.9 6875.79,-4010.9 6875.79,-4093.9"/>
<text text-anchor="middle" x="6776.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6776.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="6776.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6776.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="6776.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_0_0 -->
<g id="edge1101" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_0_0</title>
<path fill="none" stroke="black" d="M8231.33,-4179.4C7898.19,-4171.35 7156.1,-4148.06 6885.72,-4093.86"/>
<polygon fill="black" stroke="black" points="6886.41,-4090.43 6875.91,-4091.84 6885,-4097.29 6886.41,-4090.43"/>
</g>
<!-- layer3_o_proj_0_1 -->
<g id="node438" class="node">
<title>layer3_o_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="7091.79,-4093.9 6893.79,-4093.9 6893.79,-4010.9 7091.79,-4010.9 7091.79,-4093.9"/>
<text text-anchor="middle" x="6992.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6992.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="6992.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6992.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="6992.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_0_1 -->
<g id="edge1102" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_0_1</title>
<path fill="none" stroke="black" d="M8229.86,-4177.45C7934.31,-4166.82 7329.46,-4140.39 7101.82,-4093.89"/>
<polygon fill="black" stroke="black" points="7102.42,-4090.44 7091.92,-4091.8 7100.98,-4097.29 7102.42,-4090.44"/>
</g>
<!-- layer3_o_proj_0_2 -->
<g id="node439" class="node">
<title>layer3_o_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7307.79,-4093.9 7109.79,-4093.9 7109.79,-4010.9 7307.79,-4010.9 7307.79,-4093.9"/>
<text text-anchor="middle" x="7208.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7208.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="7208.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7208.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7208.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_0_2 -->
<g id="edge1103" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_0_2</title>
<path fill="none" stroke="black" d="M8234.59,-4183.4C8023.65,-4180.95 7644.55,-4165.91 7318.06,-4094"/>
<polygon fill="black" stroke="black" points="7318.45,-4090.5 7307.93,-4091.75 7316.93,-4097.34 7318.45,-4090.5"/>
</g>
<!-- layer3_o_proj_0_3 -->
<g id="node440" class="node">
<title>layer3_o_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7523.79,-4093.9 7325.79,-4093.9 7325.79,-4010.9 7523.79,-4010.9 7523.79,-4093.9"/>
<text text-anchor="middle" x="7424.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7424.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="7424.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7424.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7424.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_0_3 -->
<g id="edge1104" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_0_3</title>
<path fill="none" stroke="black" d="M8230.68,-4178.38C8057.49,-4170.79 7778.8,-4150.47 7533.75,-4093.95"/>
<polygon fill="black" stroke="black" points="7534.48,-4090.53 7523.95,-4091.67 7532.89,-4097.35 7534.48,-4090.53"/>
</g>
<!-- layer3_o_proj_1_0 -->
<g id="node441" class="node">
<title>layer3_o_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7739.79,-4093.9 7541.79,-4093.9 7541.79,-4010.9 7739.79,-4010.9 7739.79,-4093.9"/>
<text text-anchor="middle" x="7640.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7640.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="7640.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7640.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="7640.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_1_0 -->
<g id="edge1105" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_1_0</title>
<path fill="none" stroke="black" d="M8223.57,-4169.65C8094.47,-4157.29 7914.25,-4134.81 7749.79,-4094"/>
<polygon fill="black" stroke="black" points="7750.53,-4090.58 7739.98,-4091.54 7748.83,-4097.37 7750.53,-4090.58"/>
</g>
<!-- layer3_o_proj_1_1 -->
<g id="node442" class="node">
<title>layer3_o_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7955.79,-4093.9 7757.79,-4093.9 7757.79,-4010.9 7955.79,-4010.9 7955.79,-4093.9"/>
<text text-anchor="middle" x="7856.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7856.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7856.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7856.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7856.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_1_1 -->
<g id="edge1106" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_1_1</title>
<path fill="none" stroke="black" d="M8208.65,-4150.74C8135.14,-4136.53 8050.26,-4118.1 7965.81,-4094.08"/>
<polygon fill="black" stroke="black" points="7966.63,-4090.68 7956.05,-4091.28 7964.7,-4097.4 7966.63,-4090.68"/>
</g>
<!-- layer3_o_proj_1_2 -->
<g id="node443" class="node">
<title>layer3_o_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="8171.79,-4093.9 7973.79,-4093.9 7973.79,-4010.9 8171.79,-4010.9 8171.79,-4093.9"/>
<text text-anchor="middle" x="8072.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8072.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="8072.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8072.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8072.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_1_2 -->
<g id="edge1107" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_1_2</title>
<path fill="none" stroke="black" d="M8266.41,-4130.78C8238.25,-4119.53 8208.77,-4107.75 8181.55,-4096.87"/>
<polygon fill="black" stroke="black" points="8182.6,-4093.52 8172.02,-4093.06 8180,-4100.02 8182.6,-4093.52"/>
</g>
<!-- layer3_o_proj_1_3 -->
<g id="node444" class="node">
<title>layer3_o_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8387.79,-4093.9 8189.79,-4093.9 8189.79,-4010.9 8387.79,-4010.9 8387.79,-4093.9"/>
<text text-anchor="middle" x="8288.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8288.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="8288.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8288.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="8288.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_1_3 -->
<g id="edge1108" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_1_3</title>
<path fill="none" stroke="black" d="M8353.17,-4130.6C8345.22,-4121.06 8336.95,-4111.14 8329.09,-4101.72"/>
<polygon fill="black" stroke="black" points="8331.7,-4099.38 8322.6,-4093.94 8326.32,-4103.86 8331.7,-4099.38"/>
</g>
<!-- layer3_o_proj_2_0 -->
<g id="node445" class="node">
<title>layer3_o_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="8603.79,-4093.9 8405.79,-4093.9 8405.79,-4010.9 8603.79,-4010.9 8603.79,-4093.9"/>
<text text-anchor="middle" x="8504.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8504.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="8504.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8504.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8504.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_2_0 -->
<g id="edge1109" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_2_0</title>
<path fill="none" stroke="black" d="M8440.41,-4130.6C8448.37,-4121.06 8456.64,-4111.14 8464.49,-4101.72"/>
<polygon fill="black" stroke="black" points="8467.26,-4103.86 8470.98,-4093.94 8461.89,-4099.38 8467.26,-4103.86"/>
</g>
<!-- layer3_o_proj_2_1 -->
<g id="node446" class="node">
<title>layer3_o_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="8819.79,-4093.9 8621.79,-4093.9 8621.79,-4010.9 8819.79,-4010.9 8819.79,-4093.9"/>
<text text-anchor="middle" x="8720.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8720.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="8720.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8720.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8720.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_2_1 -->
<g id="edge1110" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_2_1</title>
<path fill="none" stroke="black" d="M8527.17,-4130.78C8555.33,-4119.53 8584.81,-4107.75 8612.04,-4096.87"/>
<polygon fill="black" stroke="black" points="8613.58,-4100.02 8621.57,-4093.06 8610.98,-4093.52 8613.58,-4100.02"/>
</g>
<!-- layer3_o_proj_2_2 -->
<g id="node447" class="node">
<title>layer3_o_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9035.79,-4093.9 8837.79,-4093.9 8837.79,-4010.9 9035.79,-4010.9 9035.79,-4093.9"/>
<text text-anchor="middle" x="8936.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8936.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="8936.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8936.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8936.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_2_2 -->
<g id="edge1111" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_2_2</title>
<path fill="none" stroke="black" d="M8584.93,-4150.74C8658.44,-4136.53 8743.33,-4118.1 8827.77,-4094.08"/>
<polygon fill="black" stroke="black" points="8828.89,-4097.4 8837.53,-4091.28 8826.96,-4090.68 8828.89,-4097.4"/>
</g>
<!-- layer3_o_proj_2_3 -->
<g id="node448" class="node">
<title>layer3_o_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="9251.79,-4093.9 9053.79,-4093.9 9053.79,-4010.9 9251.79,-4010.9 9251.79,-4093.9"/>
<text text-anchor="middle" x="9152.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9152.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="9152.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9152.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9152.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_2_3 -->
<g id="edge1112" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_2_3</title>
<path fill="none" stroke="black" d="M8570.01,-4169.65C8699.12,-4157.29 8879.33,-4134.81 9043.79,-4094"/>
<polygon fill="black" stroke="black" points="9044.75,-4097.37 9053.6,-4091.54 9043.05,-4090.58 9044.75,-4097.37"/>
</g>
<!-- layer3_o_proj_3_0 -->
<g id="node449" class="node">
<title>layer3_o_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="9467.79,-4093.9 9269.79,-4093.9 9269.79,-4010.9 9467.79,-4010.9 9467.79,-4093.9"/>
<text text-anchor="middle" x="9368.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9368.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="9368.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9368.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="9368.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_3_0 -->
<g id="edge1113" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_3_0</title>
<path fill="none" stroke="black" d="M8562.9,-4178.38C8736.1,-4170.79 9014.78,-4150.47 9259.83,-4093.95"/>
<polygon fill="black" stroke="black" points="9260.69,-4097.35 9269.63,-4091.67 9259.1,-4090.53 9260.69,-4097.35"/>
</g>
<!-- layer3_o_proj_3_1 -->
<g id="node450" class="node">
<title>layer3_o_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="9683.79,-4093.9 9485.79,-4093.9 9485.79,-4010.9 9683.79,-4010.9 9683.79,-4093.9"/>
<text text-anchor="middle" x="9584.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9584.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="9584.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9584.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="9584.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_3_1 -->
<g id="edge1114" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_3_1</title>
<path fill="none" stroke="black" d="M8558.99,-4183.4C8769.93,-4180.95 9149.03,-4165.91 9475.52,-4094"/>
<polygon fill="black" stroke="black" points="9476.65,-4097.34 9485.65,-4091.75 9475.13,-4090.5 9476.65,-4097.34"/>
</g>
<!-- layer3_o_proj_3_2 -->
<g id="node451" class="node">
<title>layer3_o_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="9899.79,-4093.9 9701.79,-4093.9 9701.79,-4010.9 9899.79,-4010.9 9899.79,-4093.9"/>
<text text-anchor="middle" x="9800.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9800.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="9800.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9800.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="9800.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_3_2 -->
<g id="edge1115" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_3_2</title>
<path fill="none" stroke="black" d="M8563.72,-4177.45C8859.28,-4166.82 9464.12,-4140.39 9691.76,-4093.89"/>
<polygon fill="black" stroke="black" points="9692.6,-4097.29 9701.66,-4091.8 9691.16,-4090.44 9692.6,-4097.29"/>
</g>
<!-- layer3_o_proj_3_3 -->
<g id="node452" class="node">
<title>layer3_o_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="10115.79,-4093.9 9917.79,-4093.9 9917.79,-4010.9 10115.79,-4010.9 10115.79,-4093.9"/>
<text text-anchor="middle" x="10016.79" y="-4078.7" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10016.79" y="-4063.7" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="10016.79" y="-4048.7" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="10016.79" y="-4033.7" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="10016.79" y="-4018.7" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_o_proj_3_3 -->
<g id="edge1116" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_o_proj_3_3</title>
<path fill="none" stroke="black" d="M8567.54,-4172.9C8798.96,-4159.35 9225.09,-4134.37 9588.79,-4112.9 9727.82,-4104.69 9767.64,-4122.62 9907.85,-4093.89"/>
<polygon fill="black" stroke="black" points="9908.6,-4097.31 9917.67,-4091.84 9907.17,-4090.46 9908.6,-4097.31"/>
</g>
<!-- layer3_res1 -->
<g id="node453" class="node">
<title>layer3_res1</title>
<ellipse fill="lightpink" stroke="black" cx="8348.79" cy="-3828.23" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="8348.79" y="-3839.53" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="8348.79" y="-3824.53" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8348.79" y="-3809.53" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer3_o_proj_0_0&#45;&gt;layer3_res1 -->
<g id="edge1117" class="edge">
<title>layer3_o_proj_0_0&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M6875.97,-4013.2C6878.93,-4012.39 6881.87,-4011.61 6884.79,-4010.9 7352.41,-3895.91 7922.85,-3851.83 8192.84,-3836.53"/>
<polygon fill="black" stroke="black" points="8193.31,-3840.01 8203.1,-3835.96 8192.92,-3833.02 8193.31,-3840.01"/>
</g>
<!-- layer3_o_proj_0_1&#45;&gt;layer3_res1 -->
<g id="edge1118" class="edge">
<title>layer3_o_proj_0_1&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7091.99,-4013.29C7094.94,-4012.44 7097.88,-4011.64 7100.79,-4010.9 7486.75,-3911.66 7954.75,-3861.71 8193.03,-3841.12"/>
<polygon fill="black" stroke="black" points="8193.49,-3844.59 8203.15,-3840.25 8192.89,-3837.62 8193.49,-3844.59"/>
</g>
<!-- layer3_o_proj_0_2&#45;&gt;layer3_res1 -->
<g id="edge1119" class="edge">
<title>layer3_o_proj_0_2&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7308.02,-4013.4C7310.96,-4012.53 7313.89,-4011.69 7316.79,-4010.9 7622.7,-3927.38 7990.47,-3873.38 8194.04,-3847.41"/>
<polygon fill="black" stroke="black" points="8194.73,-3850.85 8204.21,-3846.12 8193.85,-3843.91 8194.73,-3850.85"/>
</g>
<!-- layer3_o_proj_0_3&#45;&gt;layer3_res1 -->
<g id="edge1120" class="edge">
<title>layer3_o_proj_0_3&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7524.07,-4013.57C7527,-4012.65 7529.91,-4011.75 7532.79,-4010.9 7760.19,-3943.31 8029.86,-3887.97 8195.12,-3856.79"/>
<polygon fill="black" stroke="black" points="8196.18,-3860.15 8205.36,-3854.87 8194.89,-3853.28 8196.18,-3860.15"/>
</g>
<!-- layer3_o_proj_1_0&#45;&gt;layer3_res1 -->
<g id="edge1121" class="edge">
<title>layer3_o_proj_1_0&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7739.87,-4013.96C7742.87,-4012.92 7745.85,-4011.89 7748.79,-4010.9 7900.98,-3959.38 8077.17,-3906.87 8199.07,-3871.64"/>
<polygon fill="black" stroke="black" points="8200.22,-3874.95 8208.86,-3868.82 8198.28,-3868.23 8200.22,-3874.95"/>
</g>
<!-- layer3_o_proj_1_1&#45;&gt;layer3_res1 -->
<g id="edge1122" class="edge">
<title>layer3_o_proj_1_1&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M7946.75,-4010.78C8019.44,-3977.95 8123.11,-3931.14 8206.96,-3893.28"/>
<polygon fill="black" stroke="black" points="8208.63,-3896.36 8216.31,-3889.06 8205.75,-3889.98 8208.63,-3896.36"/>
</g>
<!-- layer3_o_proj_1_2&#45;&gt;layer3_res1 -->
<g id="edge1123" class="edge">
<title>layer3_o_proj_1_2&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M8123.41,-4010.65C8152.76,-3987.02 8191.07,-3956.19 8227.75,-3926.66"/>
<polygon fill="black" stroke="black" points="8229.95,-3929.38 8235.55,-3920.39 8225.56,-3923.93 8229.95,-3929.38"/>
</g>
<!-- layer3_o_proj_1_3&#45;&gt;layer3_res1 -->
<g id="edge1124" class="edge">
<title>layer3_o_proj_1_3&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M8299.8,-4010.65C8302.39,-4001.06 8305.3,-3990.28 8308.38,-3978.88"/>
<polygon fill="black" stroke="black" points="8311.77,-3979.74 8311,-3969.17 8305.01,-3977.92 8311.77,-3979.74"/>
</g>
<!-- layer3_o_proj_2_0&#45;&gt;layer3_res1 -->
<g id="edge1125" class="edge">
<title>layer3_o_proj_2_0&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M8476.18,-4010.65C8465.17,-3994.97 8451.94,-3976.13 8438.22,-3956.59"/>
<polygon fill="black" stroke="black" points="8440.93,-3954.36 8432.32,-3948.19 8435.2,-3958.38 8440.93,-3954.36"/>
</g>
<!-- layer3_o_proj_2_1&#45;&gt;layer3_res1 -->
<g id="edge1126" class="edge">
<title>layer3_o_proj_2_1&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M8652.56,-4010.65C8605.08,-3982.29 8540.2,-3943.54 8482.59,-3909.14"/>
<polygon fill="black" stroke="black" points="8484.16,-3906 8473.78,-3903.88 8480.57,-3912.01 8484.16,-3906"/>
</g>
<!-- layer3_o_proj_2_2&#45;&gt;layer3_res1 -->
<g id="edge1127" class="edge">
<title>layer3_o_proj_2_2&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M8837.71,-4013.96C8743.75,-3978.46 8601.44,-3924.69 8494.55,-3884.3"/>
<polygon fill="black" stroke="black" points="8495.56,-3880.94 8484.97,-3880.68 8493.09,-3887.49 8495.56,-3880.94"/>
</g>
<!-- layer3_o_proj_2_3&#45;&gt;layer3_res1 -->
<g id="edge1128" class="edge">
<title>layer3_o_proj_2_3&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M9053.77,-4013.81C9050.75,-4012.81 9047.75,-4011.83 9044.79,-4010.9 8859.66,-3952.2 8642.61,-3897.77 8500.73,-3864.1"/>
<polygon fill="black" stroke="black" points="8501.19,-3860.61 8490.65,-3861.71 8499.58,-3867.42 8501.19,-3860.61"/>
</g>
<!-- layer3_o_proj_3_0&#45;&gt;layer3_res1 -->
<g id="edge1129" class="edge">
<title>layer3_o_proj_3_0&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M9269.54,-4013.49C9266.6,-4012.59 9263.68,-4011.72 9260.79,-4010.9 8998.76,-3936.2 8685.85,-3881.04 8503.03,-3852.12"/>
<polygon fill="black" stroke="black" points="8503.49,-3848.65 8493.07,-3850.55 8502.4,-3855.56 8503.49,-3848.65"/>
</g>
<!-- layer3_o_proj_3_1&#45;&gt;layer3_res1 -->
<g id="edge1130" class="edge">
<title>layer3_o_proj_3_1&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M9485.58,-4013.34C9482.63,-4012.49 9479.69,-4011.67 9476.79,-4010.9 9135.49,-3920.39 8723.42,-3867.91 8504.03,-3844.34"/>
<polygon fill="black" stroke="black" points="8504.37,-3840.85 8494.05,-3843.27 8503.63,-3847.82 8504.37,-3840.85"/>
</g>
<!-- layer3_o_proj_3_2&#45;&gt;layer3_res1 -->
<g id="edge1131" class="edge">
<title>layer3_o_proj_3_2&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M9701.6,-4013.25C9698.65,-4012.42 9695.7,-4011.63 9692.79,-4010.9 9270.59,-3904.64 8757.13,-3857.1 8504.5,-3838.9"/>
<polygon fill="black" stroke="black" points="8504.74,-3835.41 8494.52,-3838.18 8504.24,-3842.39 8504.74,-3835.41"/>
</g>
<!-- layer3_o_proj_3_3&#45;&gt;layer3_res1 -->
<g id="edge1132" class="edge">
<title>layer3_o_proj_3_3&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M9917.62,-4013.18C9914.66,-4012.37 9911.71,-4011.6 9908.79,-4010.9 9404.53,-3888.91 8788.07,-3847.9 8504.76,-3834.89"/>
<polygon fill="black" stroke="black" points="8504.56,-3831.37 8494.41,-3834.42 8504.24,-3838.37 8504.56,-3831.37"/>
</g>
<!-- layer3_ln2_0_0 -->
<g id="node454" class="node">
<title>layer3_ln2_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="5114.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="5114.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5114.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="5114.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5114.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_0_0 -->
<g id="edge1133" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_0_0</title>
<path fill="none" stroke="black" d="M8203.55,-3816.96C7662.82,-3778.71 5770.71,-3644.88 5248.93,-3607.97"/>
<polygon fill="black" stroke="black" points="5248.95,-3604.47 5238.73,-3607.25 5248.45,-3611.45 5248.95,-3604.47"/>
</g>
<!-- layer3_ln2_0_1 -->
<g id="node455" class="node">
<title>layer3_ln2_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9926.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9926.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9926.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="9926.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9926.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_0_1 -->
<g id="edge1135" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_0_1</title>
<path fill="none" stroke="black" d="M8493.01,-3806.33C8798.95,-3761.98 9508.69,-3659.09 9799.27,-3616.97"/>
<polygon fill="black" stroke="black" points="9800.04,-3620.4 9809.43,-3615.5 9799.03,-3613.47 9800.04,-3620.4"/>
</g>
<!-- layer3_ln2_0_2 -->
<g id="node456" class="node">
<title>layer3_ln2_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7621.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7621.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7621.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="7621.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7621.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_0_2 -->
<g id="edge1137" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_0_2</title>
<path fill="none" stroke="black" d="M8209.84,-3783.99C8092.3,-3747.34 7919.43,-3693.28 7768.79,-3645.57 7755.3,-3641.3 7741.12,-3636.78 7727.11,-3632.31"/>
<polygon fill="black" stroke="black" points="7728.03,-3628.93 7717.44,-3629.22 7725.9,-3635.6 7728.03,-3628.93"/>
</g>
<!-- layer3_ln2_0_3 -->
<g id="node457" class="node">
<title>layer3_ln2_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="8946.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8946.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8946.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="8946.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8946.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_0_3 -->
<g id="edge1139" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_0_3</title>
<path fill="none" stroke="black" d="M8484.86,-3775.18C8595.88,-3732.72 8750.04,-3673.75 8849.12,-3635.85"/>
<polygon fill="black" stroke="black" points="8850.44,-3639.09 8858.53,-3632.25 8847.94,-3632.55 8850.44,-3639.09"/>
</g>
<!-- layer3_ln2_1_0 -->
<g id="node458" class="node">
<title>layer3_ln2_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="12008.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="12008.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12008.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12008.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12008.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_1_0 -->
<g id="edge1141" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_1_0</title>
<path fill="none" stroke="black" d="M8494.53,-3822.52C8954.25,-3806.92 10414.79,-3751.84 11619.79,-3645.57 11707.02,-3637.88 11804.88,-3626.02 11880.62,-3616.12"/>
<polygon fill="black" stroke="black" points="11881.23,-3619.57 11890.69,-3614.8 11880.32,-3612.63 11881.23,-3619.57"/>
</g>
<!-- layer3_ln2_1_1 -->
<g id="node459" class="node">
<title>layer3_ln2_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7904.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7904.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7904.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="7904.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7904.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_1_1 -->
<g id="edge1143" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_1_1</title>
<path fill="none" stroke="black" d="M8219.47,-3760.61C8144.78,-3722.13 8053.02,-3674.85 7987.91,-3641.31"/>
<polygon fill="black" stroke="black" points="7989.39,-3638.13 7978.9,-3636.67 7986.19,-3644.36 7989.39,-3638.13"/>
</g>
<!-- layer3_ln2_1_2 -->
<g id="node460" class="node">
<title>layer3_ln2_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6640.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6640.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6640.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="6640.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6640.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_1_2 -->
<g id="edge1145" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_1_2</title>
<path fill="none" stroke="black" d="M8203.86,-3813.23C7938.62,-3786.76 7357.7,-3724.84 6871.79,-3645.57 6835.05,-3639.57 6795.26,-3631.9 6759.23,-3624.49"/>
<polygon fill="black" stroke="black" points="6759.67,-3621.01 6749.17,-3622.41 6758.25,-3627.86 6759.67,-3621.01"/>
</g>
<!-- layer3_ln2_1_3 -->
<g id="node461" class="node">
<title>layer3_ln2_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10440.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10440.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10440.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="10440.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10440.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_1_3 -->
<g id="edge1147" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_1_3</title>
<path fill="none" stroke="black" d="M8493.64,-3812.79C8788.95,-3783.13 9481.82,-3712.53 10062.79,-3645.57 10145.62,-3636.02 10238.54,-3624.46 10311.52,-3615.18"/>
<polygon fill="black" stroke="black" points="10312.21,-3618.62 10321.69,-3613.89 10311.32,-3611.68 10312.21,-3618.62"/>
</g>
<!-- layer3_ln2_2_0 -->
<g id="node462" class="node">
<title>layer3_ln2_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="9424.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9424.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9424.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="9424.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9424.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_2_0 -->
<g id="edge1149" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_2_0</title>
<path fill="none" stroke="black" d="M8491.12,-3796.98C8705.12,-3751.48 9105.91,-3666.28 9305.51,-3623.84"/>
<polygon fill="black" stroke="black" points="9306.39,-3627.24 9315.44,-3621.73 9304.93,-3620.39 9306.39,-3627.24"/>
</g>
<!-- layer3_ln2_2_1 -->
<g id="node463" class="node">
<title>layer3_ln2_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7007.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7007.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7007.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="7007.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7007.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_2_1 -->
<g id="edge1151" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_2_1</title>
<path fill="none" stroke="black" d="M8204.01,-3809.08C7983.99,-3780.46 7552.76,-3720.34 7190.79,-3645.57 7167.35,-3640.73 7142.42,-3634.82 7118.73,-3628.85"/>
<polygon fill="black" stroke="black" points="7119.58,-3625.46 7109.02,-3626.38 7117.85,-3632.24 7119.58,-3625.46"/>
</g>
<!-- layer3_ln2_2_2 -->
<g id="node464" class="node">
<title>layer3_ln2_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7326.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7326.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7326.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="7326.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7326.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_2_2 -->
<g id="edge1153" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_2_2</title>
<path fill="none" stroke="black" d="M8205.58,-3800.75C8033.71,-3768.12 7737.21,-3709.15 7485.79,-3645.57 7468.72,-3641.25 7450.73,-3636.31 7433.23,-3631.29"/>
<polygon fill="black" stroke="black" points="7434.15,-3627.91 7423.57,-3628.49 7432.2,-3634.63 7434.15,-3627.91"/>
</g>
<!-- layer3_ln2_2_3 -->
<g id="node465" class="node">
<title>layer3_ln2_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="11483.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="11483.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11483.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="11483.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11483.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_2_3 -->
<g id="edge1155" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_2_3</title>
<path fill="none" stroke="black" d="M8494.26,-3820.44C8904.19,-3800.7 10103.66,-3738.74 11096.79,-3645.57 11183.21,-3637.46 11280.16,-3625.66 11355.41,-3615.9"/>
<polygon fill="black" stroke="black" points="11355.95,-3619.36 11365.41,-3614.6 11355.04,-3612.42 11355.95,-3619.36"/>
</g>
<!-- layer3_ln2_3_0 -->
<g id="node466" class="node">
<title>layer3_ln2_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10960.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10960.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10960.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="10960.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10960.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_3_0 -->
<g id="edge1157" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_3_0</title>
<path fill="none" stroke="black" d="M8494.3,-3817.43C8850.14,-3792.99 9792.56,-3725.59 10576.79,-3645.57 10661.83,-3636.89 10757.22,-3625.21 10831.65,-3615.65"/>
<polygon fill="black" stroke="black" points="10832.54,-3619.06 10842.01,-3614.31 10831.64,-3612.12 10832.54,-3619.06"/>
</g>
<!-- layer3_ln2_3_1 -->
<g id="node467" class="node">
<title>layer3_ln2_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="8516.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8516.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8516.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="8516.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8516.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_3_1 -->
<g id="edge1159" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_3_1</title>
<path fill="none" stroke="black" d="M8434.76,-3710.18C8449.61,-3689.96 8464.37,-3669.86 8477.2,-3652.4"/>
<polygon fill="black" stroke="black" points="8480.23,-3654.18 8483.33,-3644.05 8474.59,-3650.03 8480.23,-3654.18"/>
</g>
<!-- layer3_ln2_3_2 -->
<g id="node468" class="node">
<title>layer3_ln2_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6177.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6177.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6177.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="6177.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6177.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_3_2 -->
<g id="edge1161" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_3_2</title>
<path fill="none" stroke="black" d="M8203.62,-3815.16C7892.01,-3788.75 7136.11,-3722.08 6504.79,-3645.57 6438.45,-3637.53 6364.76,-3627.05 6304.15,-3618.03"/>
<polygon fill="black" stroke="black" points="6304.56,-3614.55 6294.16,-3616.53 6303.53,-3621.47 6304.56,-3614.55"/>
</g>
<!-- layer3_ln2_3_3 -->
<g id="node469" class="node">
<title>layer3_ln2_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="8181.79" cy="-3597.49" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8181.79" y="-3616.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8181.79" y="-3601.29" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="8181.79" y="-3586.29" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8181.79" y="-3571.29" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2_3_3 -->
<g id="edge1163" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2_3_3</title>
<path fill="none" stroke="black" d="M8263.33,-3710.18C8248.58,-3689.96 8233.9,-3669.86 8221.15,-3652.4"/>
<polygon fill="black" stroke="black" points="8223.78,-3650.06 8215.05,-3644.05 8218.12,-3654.19 8223.78,-3650.06"/>
</g>
<!-- layer3_gate_0_0 -->
<g id="node470" class="node">
<title>layer3_gate_0_0</title>
<polygon fill="purple" stroke="black" points="4610.65,-3444.63 4483.72,-3512.17 4229.86,-3512.17 4102.93,-3444.63 4229.86,-3377.09 4483.72,-3377.09 4610.65,-3444.63"/>
<text text-anchor="middle" x="4356.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4356.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="4356.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="4356.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4356.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_0_0&#45;&gt;layer3_gate_0_0 -->
<g id="edge1134" class="edge">
<title>layer3_ln2_0_0&#45;&gt;layer3_gate_0_0</title>
<path fill="none" stroke="black" d="M4997.52,-3579.29C4896.91,-3563.88 4748.25,-3539.57 4619.79,-3512.4 4592.17,-3506.56 4563.06,-3499.79 4534.69,-3492.86"/>
<polygon fill="black" stroke="black" points="4535.23,-3489.39 4524.68,-3490.4 4533.56,-3496.18 4535.23,-3489.39"/>
</g>
<!-- layer3_gate_0_1 -->
<g id="node471" class="node">
<title>layer3_gate_0_1</title>
<polygon fill="purple" stroke="black" points="10396.65,-3444.63 10269.72,-3512.17 10015.86,-3512.17 9888.93,-3444.63 10015.86,-3377.09 10269.72,-3377.09 10396.65,-3444.63"/>
<text text-anchor="middle" x="10142.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10142.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="10142.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10142.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="10142.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_0_1&#45;&gt;layer3_gate_0_1 -->
<g id="edge1136" class="edge">
<title>layer3_ln2_0_1&#45;&gt;layer3_gate_0_1</title>
<path fill="none" stroke="black" d="M9986.39,-3554.87C10002.74,-3543.45 10020.96,-3530.72 10039.02,-3518.11"/>
<polygon fill="black" stroke="black" points="10041.1,-3520.92 10047.3,-3512.33 10037.09,-3515.18 10041.1,-3520.92"/>
</g>
<!-- layer3_gate_0_2 -->
<g id="node472" class="node">
<title>layer3_gate_0_2</title>
<polygon fill="purple" stroke="black" points="7240.65,-3444.63 7113.72,-3512.17 6859.86,-3512.17 6732.93,-3444.63 6859.86,-3377.09 7113.72,-3377.09 7240.65,-3444.63"/>
<text text-anchor="middle" x="6986.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6986.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="6986.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6986.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6986.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_0_2&#45;&gt;layer3_gate_0_2 -->
<g id="edge1138" class="edge">
<title>layer3_ln2_0_2&#45;&gt;layer3_gate_0_2</title>
<path fill="none" stroke="black" d="M7525.57,-3566.05C7504.98,-3560.08 7483.25,-3554.19 7462.79,-3549.4 7369.24,-3527.5 7343.76,-3532.46 7249.79,-3512.4 7222.28,-3506.53 7193.3,-3499.77 7165.02,-3492.84"/>
<polygon fill="black" stroke="black" points="7165.6,-3489.38 7155.06,-3490.39 7163.93,-3496.18 7165.6,-3489.38"/>
</g>
<!-- layer3_gate_0_3 -->
<g id="node473" class="node">
<title>layer3_gate_0_3</title>
<polygon fill="purple" stroke="black" points="9344.65,-3444.63 9217.72,-3512.17 8963.86,-3512.17 8836.93,-3444.63 8963.86,-3377.09 9217.72,-3377.09 9344.65,-3444.63"/>
<text text-anchor="middle" x="9090.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9090.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="9090.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9090.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="9090.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_0_3&#45;&gt;layer3_gate_0_3 -->
<g id="edge1140" class="edge">
<title>layer3_ln2_0_3&#45;&gt;layer3_gate_0_3</title>
<path fill="none" stroke="black" d="M8989.22,-3552.04C8998.95,-3541.85 9009.55,-3530.74 9020.12,-3519.67"/>
<polygon fill="black" stroke="black" points="9022.67,-3522.06 9027.05,-3512.41 9017.61,-3517.23 9022.67,-3522.06"/>
</g>
<!-- layer3_gate_1_0 -->
<g id="node474" class="node">
<title>layer3_gate_1_0</title>
<polygon fill="purple" stroke="black" points="12500.65,-3444.63 12373.72,-3512.17 12119.86,-3512.17 11992.93,-3444.63 12119.86,-3377.09 12373.72,-3377.09 12500.65,-3444.63"/>
<text text-anchor="middle" x="12246.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12246.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12246.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="12246.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="12246.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_1_0&#45;&gt;layer3_gate_1_0 -->
<g id="edge1142" class="edge">
<title>layer3_ln2_1_0&#45;&gt;layer3_gate_1_0</title>
<path fill="none" stroke="black" d="M12072.88,-3555.86C12091.52,-3544.05 12112.46,-3530.78 12133.17,-3517.65"/>
<polygon fill="black" stroke="black" points="12135.15,-3520.54 12141.72,-3512.23 12131.4,-3514.63 12135.15,-3520.54"/>
</g>
<!-- layer3_gate_1_1 -->
<g id="node475" class="node">
<title>layer3_gate_1_1</title>
<polygon fill="purple" stroke="black" points="7766.65,-3444.63 7639.72,-3512.17 7385.86,-3512.17 7258.93,-3444.63 7385.86,-3377.09 7639.72,-3377.09 7766.65,-3444.63"/>
<text text-anchor="middle" x="7512.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7512.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="7512.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7512.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7512.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_1_1&#45;&gt;layer3_gate_1_1 -->
<g id="edge1144" class="edge">
<title>layer3_ln2_1_1&#45;&gt;layer3_gate_1_1</title>
<path fill="none" stroke="black" d="M7816.82,-3562.63C7773.15,-3545.83 7719.07,-3525.02 7668.69,-3505.63"/>
<polygon fill="black" stroke="black" points="7669.92,-3502.35 7659.33,-3502.03 7667.41,-3508.88 7669.92,-3502.35"/>
</g>
<!-- layer3_gate_1_2 -->
<g id="node476" class="node">
<title>layer3_gate_1_2</title>
<polygon fill="purple" stroke="black" points="5662.65,-3444.63 5535.72,-3512.17 5281.86,-3512.17 5154.93,-3444.63 5281.86,-3377.09 5535.72,-3377.09 5662.65,-3444.63"/>
<text text-anchor="middle" x="5408.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5408.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="5408.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5408.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="5408.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_1_2&#45;&gt;layer3_gate_1_2 -->
<g id="edge1146" class="edge">
<title>layer3_ln2_1_2&#45;&gt;layer3_gate_1_2</title>
<path fill="none" stroke="black" d="M6525.69,-3577.46C6463.17,-3567.75 6384.41,-3556.51 6313.79,-3549.4 6029.42,-3520.79 5954.26,-3555.99 5671.79,-3512.4 5642.82,-3507.93 5612.4,-3501.69 5582.95,-3494.8"/>
<polygon fill="black" stroke="black" points="5583.53,-3491.35 5573,-3492.45 5581.92,-3498.16 5583.53,-3491.35"/>
</g>
<!-- layer3_gate_1_3 -->
<g id="node477" class="node">
<title>layer3_gate_1_3</title>
<polygon fill="purple" stroke="black" points="10922.65,-3444.63 10795.72,-3512.17 10541.86,-3512.17 10414.93,-3444.63 10541.86,-3377.09 10795.72,-3377.09 10922.65,-3444.63"/>
<text text-anchor="middle" x="10668.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10668.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="10668.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10668.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10668.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_1_3&#45;&gt;layer3_gate_1_3 -->
<g id="edge1148" class="edge">
<title>layer3_ln2_1_3&#45;&gt;layer3_gate_1_3</title>
<path fill="none" stroke="black" d="M10502.79,-3555.46C10520.45,-3543.78 10540.22,-3530.7 10559.79,-3517.75"/>
<polygon fill="black" stroke="black" points="10561.75,-3520.65 10568.16,-3512.21 10557.89,-3514.81 10561.75,-3520.65"/>
</g>
<!-- layer3_gate_2_0 -->
<g id="node478" class="node">
<title>layer3_gate_2_0</title>
<polygon fill="purple" stroke="black" points="9870.65,-3444.63 9743.72,-3512.17 9489.86,-3512.17 9362.93,-3444.63 9489.86,-3377.09 9743.72,-3377.09 9870.65,-3444.63"/>
<text text-anchor="middle" x="9616.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9616.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="9616.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9616.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9616.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_2_0&#45;&gt;layer3_gate_2_0 -->
<g id="edge1150" class="edge">
<title>layer3_ln2_2_0&#45;&gt;layer3_gate_2_0</title>
<path fill="none" stroke="black" d="M9479.04,-3553.86C9493.02,-3542.88 9508.46,-3530.75 9523.8,-3518.7"/>
<polygon fill="black" stroke="black" points="9526.1,-3521.34 9531.8,-3512.41 9521.78,-3515.83 9526.1,-3521.34"/>
</g>
<!-- layer3_gate_2_1 -->
<g id="node479" class="node">
<title>layer3_gate_2_1</title>
<polygon fill="purple" stroke="black" points="6188.65,-3444.63 6061.72,-3512.17 5807.86,-3512.17 5680.93,-3444.63 5807.86,-3377.09 6061.72,-3377.09 6188.65,-3444.63"/>
<text text-anchor="middle" x="5934.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5934.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="5934.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5934.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="5934.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_2_1&#45;&gt;layer3_gate_2_1 -->
<g id="edge1152" class="edge">
<title>layer3_ln2_2_1&#45;&gt;layer3_gate_2_1</title>
<path fill="none" stroke="black" d="M6901.06,-3571.55C6862.15,-3563.3 6817.67,-3554.85 6776.79,-3549.4 6521.19,-3515.35 6452.51,-3552.52 6197.79,-3512.4 6168.94,-3507.86 6138.64,-3501.6 6109.29,-3494.72"/>
<polygon fill="black" stroke="black" points="6109.91,-3491.27 6099.37,-3492.37 6108.29,-3498.09 6109.91,-3491.27"/>
</g>
<!-- layer3_gate_2_2 -->
<g id="node480" class="node">
<title>layer3_gate_2_2</title>
<polygon fill="purple" stroke="black" points="6714.65,-3444.63 6587.72,-3512.17 6333.86,-3512.17 6206.93,-3444.63 6333.86,-3377.09 6587.72,-3377.09 6714.65,-3444.63"/>
<text text-anchor="middle" x="6460.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6460.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="6460.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6460.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="6460.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_2_2&#45;&gt;layer3_gate_2_2 -->
<g id="edge1154" class="edge">
<title>layer3_ln2_2_2&#45;&gt;layer3_gate_2_2</title>
<path fill="none" stroke="black" d="M7227.23,-3567.71C7200.34,-3560.81 7171.11,-3554.09 7143.79,-3549.4 6959.1,-3517.73 6908.54,-3543.78 6723.79,-3512.4 6695.21,-3507.55 6665.17,-3501.17 6636.03,-3494.28"/>
<polygon fill="black" stroke="black" points="6636.72,-3490.85 6626.18,-3491.92 6635.09,-3497.65 6636.72,-3490.85"/>
</g>
<!-- layer3_gate_2_3 -->
<g id="node481" class="node">
<title>layer3_gate_2_3</title>
<polygon fill="purple" stroke="black" points="11974.65,-3444.63 11847.72,-3512.17 11593.86,-3512.17 11466.93,-3444.63 11593.86,-3377.09 11847.72,-3377.09 11974.65,-3444.63"/>
<text text-anchor="middle" x="11720.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11720.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="11720.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11720.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11720.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_2_3&#45;&gt;layer3_gate_2_3 -->
<g id="edge1156" class="edge">
<title>layer3_ln2_2_3&#45;&gt;layer3_gate_2_3</title>
<path fill="none" stroke="black" d="M11547.61,-3555.86C11566.17,-3544.05 11587.02,-3530.78 11607.65,-3517.65"/>
<polygon fill="black" stroke="black" points="11609.6,-3520.55 11616.16,-3512.23 11605.84,-3514.65 11609.6,-3520.55"/>
</g>
<!-- layer3_gate_3_0 -->
<g id="node482" class="node">
<title>layer3_gate_3_0</title>
<polygon fill="purple" stroke="black" points="11448.65,-3444.63 11321.72,-3512.17 11067.86,-3512.17 10940.93,-3444.63 11067.86,-3377.09 11321.72,-3377.09 11448.65,-3444.63"/>
<text text-anchor="middle" x="11194.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11194.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="11194.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11194.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11194.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_3_0&#45;&gt;layer3_gate_3_0 -->
<g id="edge1158" class="edge">
<title>layer3_ln2_3_0&#45;&gt;layer3_gate_3_0</title>
<path fill="none" stroke="black" d="M11024.12,-3555.66C11042.24,-3543.98 11062.55,-3530.89 11082.67,-3517.91"/>
<polygon fill="black" stroke="black" points="11084.76,-3520.73 11091.27,-3512.37 11080.97,-3514.84 11084.76,-3520.73"/>
</g>
<!-- layer3_gate_3_1 -->
<g id="node483" class="node">
<title>layer3_gate_3_1</title>
<polygon fill="purple" stroke="black" points="8818.65,-3444.63 8691.72,-3512.17 8437.86,-3512.17 8310.93,-3444.63 8437.86,-3377.09 8691.72,-3377.09 8818.65,-3444.63"/>
<text text-anchor="middle" x="8564.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8564.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="8564.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8564.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8564.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_3_1&#45;&gt;layer3_gate_3_1 -->
<g id="edge1160" class="edge">
<title>layer3_ln2_3_1&#45;&gt;layer3_gate_3_1</title>
<path fill="none" stroke="black" d="M8531.72,-3549.58C8534.49,-3540.85 8537.46,-3531.52 8540.44,-3522.17"/>
<polygon fill="black" stroke="black" points="8543.84,-3523.03 8543.53,-3512.44 8537.17,-3520.91 8543.84,-3523.03"/>
</g>
<!-- layer3_gate_3_2 -->
<g id="node484" class="node">
<title>layer3_gate_3_2</title>
<polygon fill="purple" stroke="black" points="5136.65,-3444.63 5009.72,-3512.17 4755.86,-3512.17 4628.93,-3444.63 4755.86,-3377.09 5009.72,-3377.09 5136.65,-3444.63"/>
<text text-anchor="middle" x="4882.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4882.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="4882.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="4882.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="4882.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_3_2&#45;&gt;layer3_gate_3_2 -->
<g id="edge1162" class="edge">
<title>layer3_ln2_3_2&#45;&gt;layer3_gate_3_2</title>
<path fill="none" stroke="black" d="M6051.46,-3592.99C5856.09,-3586.07 5469.4,-3566.27 5145.79,-3512.4 5117.09,-3507.62 5086.93,-3501.26 5057.68,-3494.37"/>
<polygon fill="black" stroke="black" points="5058.34,-3490.92 5047.8,-3492.01 5056.71,-3497.73 5058.34,-3490.92"/>
</g>
<!-- layer3_gate_3_3 -->
<g id="node485" class="node">
<title>layer3_gate_3_3</title>
<polygon fill="purple" stroke="black" points="8292.65,-3444.63 8165.72,-3512.17 7911.86,-3512.17 7784.93,-3444.63 7911.86,-3377.09 8165.72,-3377.09 8292.65,-3444.63"/>
<text text-anchor="middle" x="8038.79" y="-3470.93" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8038.79" y="-3455.93" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="8038.79" y="-3440.93" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8038.79" y="-3425.93" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="8038.79" y="-3410.93" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer3_ln2_3_3&#45;&gt;layer3_gate_3_3 -->
<g id="edge1164" class="edge">
<title>layer3_ln2_3_3&#45;&gt;layer3_gate_3_3</title>
<path fill="none" stroke="black" d="M8139.66,-3552.04C8130,-3541.85 8119.47,-3530.74 8108.97,-3519.67"/>
<polygon fill="black" stroke="black" points="8111.51,-3517.26 8102.09,-3512.41 8106.43,-3522.08 8111.51,-3517.26"/>
</g>
<!-- layer3_expert1_0 -->
<g id="node486" class="node">
<title>layer3_expert1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="7448.29,-3310.86 7269.29,-3310.86 7269.29,-3242.86 7448.29,-3242.86 7448.29,-3310.86"/>
<text text-anchor="middle" x="7358.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 0 First Linear</text>
<text text-anchor="middle" x="7358.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7358.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7358.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_0 -->
<g id="edge1165" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4519.41,-3395.93C4552.36,-3388.08 4586.97,-3381.13 4619.79,-3376.86 4669.51,-3370.4 6380.98,-3383.26 6424.79,-3358.86 6438.58,-3351.19 6430.18,-3336.86 6443.79,-3328.86 6512.66,-3288.42 7036.38,-3280.05 7259.08,-3278.31"/>
<polygon fill="black" stroke="black" points="7259.16,-3281.81 7269.13,-3278.24 7259.11,-3274.81 7259.16,-3281.81"/>
<text text-anchor="middle" x="6489.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6489.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer3_expert1_1 -->
<g id="node489" class="node">
<title>layer3_expert1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="3800.29,-3310.86 3621.29,-3310.86 3621.29,-3242.86 3800.29,-3242.86 3800.29,-3310.86"/>
<text text-anchor="middle" x="3710.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 1 First Linear</text>
<text text-anchor="middle" x="3710.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3710.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="3710.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_1 -->
<g id="edge1166" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4113.13,-3439.04C3686.31,-3429.8 2844.16,-3405.72 2799.79,-3358.86 2790.62,-3349.18 2790.63,-3338.55 2799.79,-3328.86 2827.32,-3299.75 3380.59,-3284.8 3611.21,-3279.81"/>
<polygon fill="black" stroke="black" points="3611.36,-3283.31 3621.28,-3279.59 3611.21,-3276.31 3611.36,-3283.31"/>
<text text-anchor="middle" x="2845.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2845.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer3_expert1_2 -->
<g id="node492" class="node">
<title>layer3_expert1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="9158.29,-3310.86 8979.29,-3310.86 8979.29,-3242.86 9158.29,-3242.86 9158.29,-3310.86"/>
<text text-anchor="middle" x="9068.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 2 First Linear</text>
<text text-anchor="middle" x="9068.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9068.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="9068.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_2 -->
<g id="edge1167" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4519.05,-3395.88C4552.1,-3388.01 4586.85,-3381.06 4619.79,-3376.86 4669.79,-3370.49 8204.69,-3383.28 8248.79,-3358.86 8262.6,-3351.22 8254.21,-3336.91 8267.79,-3328.86 8326.71,-3293.95 8767.46,-3282.59 8968.89,-3279.19"/>
<polygon fill="black" stroke="black" points="8969.24,-3282.68 8979.18,-3279.02 8969.12,-3275.68 8969.24,-3282.68"/>
<text text-anchor="middle" x="8313.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8313.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer3_expert1_3 -->
<g id="node495" class="node">
<title>layer3_expert1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5624.29,-3310.86 5445.29,-3310.86 5445.29,-3242.86 5624.29,-3242.86 5624.29,-3310.86"/>
<text text-anchor="middle" x="5534.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 3 First Linear</text>
<text text-anchor="middle" x="5534.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5534.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="5534.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_3 -->
<g id="edge1168" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4516.59,-3394.41C4545.13,-3383.85 4574.22,-3371.9 4600.79,-3358.86 4622.7,-3348.11 4623.6,-3336.49 4646.79,-3328.86 4790.53,-3281.61 5234.56,-3276.82 5434.91,-3277.17"/>
<polygon fill="black" stroke="black" points="5435.13,-3280.67 5445.14,-3277.19 5435.15,-3273.67 5435.13,-3280.67"/>
<text text-anchor="middle" x="4692.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4692.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer3_expert1_4 -->
<g id="node498" class="node">
<title>layer3_expert1_4</title>
<polygon fill="lightsteelblue" stroke="black" points="14630.29,-3310.86 14451.29,-3310.86 14451.29,-3242.86 14630.29,-3242.86 14630.29,-3310.86"/>
<text text-anchor="middle" x="14540.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 4 First Linear</text>
<text text-anchor="middle" x="14540.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14540.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14540.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_4 -->
<g id="edge1169" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4519.04,-3395.8C4552.09,-3387.94 4586.84,-3381.01 4619.79,-3376.86 4744.85,-3361.11 13574.19,-3395.51 13694.79,-3358.86 13717.79,-3351.88 13717.02,-3336.56 13739.79,-3328.86 13866.91,-3285.92 14256.07,-3278.73 14441.08,-3277.8"/>
<polygon fill="black" stroke="black" points="14441.1,-3281.3 14451.08,-3277.75 14441.07,-3274.3 14441.1,-3281.3"/>
<text text-anchor="middle" x="13785.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13785.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer3_expert1_5 -->
<g id="node501" class="node">
<title>layer3_expert1_5</title>
<polygon fill="lightsteelblue" stroke="black" points="12806.29,-3310.86 12627.29,-3310.86 12627.29,-3242.86 12806.29,-3242.86 12806.29,-3310.86"/>
<text text-anchor="middle" x="12716.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 5 First Linear</text>
<text text-anchor="middle" x="12716.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12716.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12716.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_5 -->
<g id="edge1170" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4519.04,-3395.82C4552.09,-3387.95 4586.84,-3381.02 4619.79,-3376.86 4669.93,-3370.54 11852.55,-3383.28 11896.79,-3358.86 11910.61,-3351.24 11902.21,-3336.91 11915.79,-3328.86 11974.71,-3293.95 12415.46,-3282.59 12616.89,-3279.19"/>
<polygon fill="black" stroke="black" points="12617.24,-3282.68 12627.18,-3279.02 12617.12,-3275.68 12617.24,-3282.68"/>
<text text-anchor="middle" x="11961.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11961.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer3_expert1_6 -->
<g id="node504" class="node">
<title>layer3_expert1_6</title>
<polygon fill="lightsteelblue" stroke="black" points="2090.29,-3310.86 1911.29,-3310.86 1911.29,-3242.86 2090.29,-3242.86 2090.29,-3310.86"/>
<text text-anchor="middle" x="2000.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 6 First Linear</text>
<text text-anchor="middle" x="2000.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2000.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2000.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_6 -->
<g id="edge1171" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4108.09,-3441.78C3354.16,-3435.57 1142.33,-3412.78 1089.79,-3358.86 1080.49,-3349.31 1080.63,-3338.55 1089.79,-3328.86 1117.32,-3299.75 1670.59,-3284.8 1901.21,-3279.81"/>
<polygon fill="black" stroke="black" points="1901.36,-3283.31 1911.28,-3279.59 1901.21,-3276.31 1901.36,-3283.31"/>
<text text-anchor="middle" x="1135.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1135.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer3_expert1_7 -->
<g id="node507" class="node">
<title>layer3_expert1_7</title>
<polygon fill="lightsteelblue" stroke="black" points="10982.29,-3310.86 10803.29,-3310.86 10803.29,-3242.86 10982.29,-3242.86 10982.29,-3310.86"/>
<text text-anchor="middle" x="10892.79" y="-3295.66" font-family="Times,serif" font-size="14.00">Expert 7 First Linear</text>
<text text-anchor="middle" x="10892.79" y="-3280.66" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10892.79" y="-3265.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10892.79" y="-3250.66" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer3_gate_0_0&#45;&gt;layer3_expert1_7 -->
<g id="edge1172" class="edge">
<title>layer3_gate_0_0&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4519.04,-3395.84C4552.1,-3387.97 4586.84,-3381.04 4619.79,-3376.86 4657.36,-3372.11 10039.65,-3377.18 10072.79,-3358.86 10086.61,-3351.23 10078.21,-3336.91 10091.79,-3328.86 10150.71,-3293.95 10591.46,-3282.59 10792.89,-3279.19"/>
<polygon fill="black" stroke="black" points="10793.24,-3282.68 10803.18,-3279.02 10793.12,-3275.68 10793.24,-3282.68"/>
<text text-anchor="middle" x="10137.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10137.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_0 -->
<g id="edge1173" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9980.17,-3395.88C9947.22,-3388.04 9912.61,-3381.1 9879.79,-3376.86 9819.79,-3369.11 7755.94,-3385.86 7701.79,-3358.86 7686.76,-3351.37 7693.22,-3337.46 7678.79,-3328.86 7642.41,-3307.19 7538.14,-3293.37 7458.41,-3285.66"/>
<polygon fill="black" stroke="black" points="7458.61,-3282.16 7448.33,-3284.7 7457.95,-3289.13 7458.61,-3282.16"/>
<text text-anchor="middle" x="7747.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7747.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→0</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_1 -->
<g id="edge1174" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9980.54,-3395.83C9947.49,-3387.97 9912.74,-3381.03 9879.79,-3376.86 9839.65,-3371.79 4090.05,-3376.82 4053.79,-3358.86 4038.74,-3351.41 4045.22,-3337.46 4030.79,-3328.86 3994.41,-3307.19 3890.14,-3293.37 3810.41,-3285.66"/>
<polygon fill="black" stroke="black" points="3810.61,-3282.16 3800.33,-3284.7 3809.95,-3289.13 3810.61,-3282.16"/>
<text text-anchor="middle" x="4099.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4099.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_2 -->
<g id="edge1175" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9978.61,-3396.65C9946.1,-3388.85 9912.05,-3381.73 9879.79,-3376.86 9840.85,-3370.99 9560.66,-3377.18 9525.79,-3358.86 9510.92,-3351.05 9517.4,-3337.17 9502.79,-3328.86 9447.55,-3297.46 9278.76,-3285.32 9168.69,-3280.68"/>
<polygon fill="black" stroke="black" points="9168.69,-3277.17 9158.56,-3280.26 9168.4,-3284.17 9168.69,-3277.17"/>
<text text-anchor="middle" x="9571.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9571.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→4</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_3 -->
<g id="edge1176" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9980.54,-3395.87C9947.48,-3388 9912.74,-3381.06 9879.79,-3376.86 9824.65,-3369.85 5927.58,-3383.57 5877.79,-3358.86 5862.74,-3351.4 5869.22,-3337.46 5854.79,-3328.86 5818.41,-3307.19 5714.14,-3293.37 5634.41,-3285.66"/>
<polygon fill="black" stroke="black" points="5634.61,-3282.16 5624.33,-3284.7 5633.95,-3289.13 5634.61,-3282.16"/>
<text text-anchor="middle" x="5923.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5923.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→6</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_4 -->
<g id="edge1177" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10305.04,-3395.85C10338.1,-3387.99 10372.84,-3381.05 10405.79,-3376.86 10437.27,-3372.87 14952.4,-3381.34 14974.79,-3358.86 14984.2,-3349.42 14983.65,-3338.83 14974.79,-3328.86 14952.94,-3304.29 14761.62,-3289.61 14640.41,-3282.69"/>
<polygon fill="black" stroke="black" points="14640.54,-3279.2 14630.35,-3282.13 14640.14,-3286.18 14640.54,-3279.2"/>
<text text-anchor="middle" x="15026.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15026.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→8</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_5 -->
<g id="edge1178" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10305.4,-3395.84C10338.35,-3388 10372.97,-3381.07 10405.79,-3376.86 10443.61,-3372.01 13123.92,-3385.91 13150.79,-3358.86 13160.19,-3349.4 13159.65,-3338.83 13150.79,-3328.86 13128.94,-3304.29 12937.62,-3289.61 12816.41,-3282.69"/>
<polygon fill="black" stroke="black" points="12816.54,-3279.2 12806.35,-3282.13 12816.14,-3286.18 12816.54,-3279.2"/>
<text text-anchor="middle" x="13202.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13202.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→10</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_6 -->
<g id="edge1179" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9980.55,-3395.81C9947.49,-3387.95 9912.74,-3381.02 9879.79,-3376.86 9827.87,-3370.31 2390.7,-3382.08 2343.79,-3358.86 2328.73,-3351.41 2335.22,-3337.46 2320.79,-3328.86 2284.41,-3307.19 2180.14,-3293.37 2100.41,-3285.66"/>
<polygon fill="black" stroke="black" points="2100.61,-3282.16 2090.33,-3284.7 2099.95,-3289.13 2100.61,-3282.16"/>
<text text-anchor="middle" x="2389.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2389.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→12</text>
</g>
<!-- layer3_gate_0_1&#45;&gt;layer3_expert1_7 -->
<g id="edge1180" class="edge">
<title>layer3_gate_0_1&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10305.8,-3396.09C10338.64,-3388.26 10373.11,-3381.27 10405.79,-3376.86 10431.15,-3373.44 11308.88,-3377.13 11326.79,-3358.86 11336.13,-3349.34 11335.65,-3338.83 11326.79,-3328.86 11304.94,-3304.29 11113.62,-3289.61 10992.41,-3282.69"/>
<polygon fill="black" stroke="black" points="10992.54,-3279.2 10982.35,-3282.13 10992.14,-3286.18 10992.54,-3279.2"/>
<text text-anchor="middle" x="11378.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11378.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 1→14</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_0 -->
<g id="edge1181" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6996.31,-3377.09C7002.05,-3359.03 7011.2,-3341.1 7025.79,-3328.86 7060.3,-3299.94 7173.79,-3287.36 7258.75,-3281.92"/>
<polygon fill="black" stroke="black" points="7259.19,-3285.4 7268.96,-3281.3 7258.76,-3278.42 7259.19,-3285.4"/>
<text text-anchor="middle" x="7071.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7071.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_1 -->
<g id="edge1182" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6824.18,-3395.81C6791.23,-3387.97 6756.62,-3381.06 6723.79,-3376.86 6700.69,-3373.91 3386.22,-3375.38 3369.79,-3358.86 3360.39,-3349.41 3361.09,-3338.97 3369.79,-3328.86 3400.45,-3293.28 3521.69,-3282.15 3610.92,-3278.88"/>
<polygon fill="black" stroke="black" points="3611.21,-3282.37 3621.09,-3278.53 3610.97,-3275.37 3611.21,-3282.37"/>
<text text-anchor="middle" x="3415.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3415.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_2 -->
<g id="edge1183" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.42,-3395.97C7182.37,-3388.12 7216.98,-3381.16 7249.79,-3376.86 7293.01,-3371.21 8780.73,-3380.1 8818.79,-3358.86 8832.57,-3351.18 8824.87,-3337.93 8837.79,-3328.86 8875.92,-3302.11 8925.61,-3289.05 8969.12,-3282.81"/>
<polygon fill="black" stroke="black" points="8969.72,-3286.26 8979.17,-3281.47 8968.8,-3279.32 8969.72,-3286.26"/>
<text text-anchor="middle" x="8883.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8883.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_3 -->
<g id="edge1184" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6824.16,-3395.97C6791.21,-3388.13 6756.6,-3381.16 6723.79,-3376.86 6702.72,-3374.1 5208.73,-3373.98 5193.79,-3358.86 5184.42,-3349.38 5185.09,-3338.97 5193.79,-3328.86 5224.45,-3293.28 5345.69,-3282.15 5434.92,-3278.88"/>
<polygon fill="black" stroke="black" points="5435.21,-3282.37 5445.09,-3278.53 5434.97,-3275.37 5435.21,-3282.37"/>
<text text-anchor="middle" x="5239.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5239.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_4 -->
<g id="edge1185" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.04,-3395.82C7182.09,-3387.96 7216.84,-3381.02 7249.79,-3376.86 7298.3,-3370.74 14247.98,-3382.49 14290.79,-3358.86 14304.61,-3351.24 14296.87,-3337.93 14309.79,-3328.86 14347.92,-3302.11 14397.61,-3289.05 14441.12,-3282.81"/>
<polygon fill="black" stroke="black" points="14441.72,-3286.26 14451.17,-3281.47 14440.8,-3279.32 14441.72,-3286.26"/>
<text text-anchor="middle" x="14355.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14355.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_5 -->
<g id="edge1186" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.04,-3395.84C7182.1,-3387.98 7216.84,-3381.04 7249.79,-3376.86 7285.73,-3372.31 12435.08,-3376.39 12466.79,-3358.86 12480.61,-3351.23 12472.87,-3337.93 12485.79,-3328.86 12523.92,-3302.11 12573.61,-3289.05 12617.12,-3282.81"/>
<polygon fill="black" stroke="black" points="12617.72,-3286.26 12627.17,-3281.47 12616.8,-3279.32 12617.72,-3286.26"/>
<text text-anchor="middle" x="12531.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12531.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_6 -->
<g id="edge1187" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6824.54,-3395.84C6791.49,-3387.98 6756.74,-3381.04 6723.79,-3376.86 6688.9,-3372.44 1684.61,-3383.77 1659.79,-3358.86 1650.38,-3349.42 1651.09,-3338.97 1659.79,-3328.86 1690.45,-3293.28 1811.69,-3282.15 1900.92,-3278.88"/>
<polygon fill="black" stroke="black" points="1901.21,-3282.37 1911.09,-3278.53 1900.97,-3275.37 1901.21,-3282.37"/>
<text text-anchor="middle" x="1705.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1705.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer3_gate_0_2&#45;&gt;layer3_expert1_7 -->
<g id="edge1188" class="edge">
<title>layer3_gate_0_2&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.4,-3395.81C7182.35,-3387.97 7216.96,-3381.05 7249.79,-3376.86 7296.54,-3370.9 10601.57,-3381.7 10642.79,-3358.86 10656.6,-3351.22 10648.87,-3337.93 10661.79,-3328.86 10699.92,-3302.11 10749.61,-3289.05 10793.12,-3282.81"/>
<polygon fill="black" stroke="black" points="10793.72,-3286.26 10803.17,-3281.47 10792.8,-3279.32 10793.72,-3286.26"/>
<text text-anchor="middle" x="10707.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10707.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_0 -->
<g id="edge1189" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8928.16,-3396.01C8895.21,-3388.16 8860.6,-3381.19 8827.79,-3376.86 8790.5,-3371.95 7507.41,-3375.73 7473.79,-3358.86 7458.77,-3351.33 7463.52,-3339.83 7450.79,-3328.86 7445.77,-3324.54 7440.33,-3320.41 7434.68,-3316.52"/>
<polygon fill="black" stroke="black" points="7436.56,-3313.57 7426.29,-3310.99 7432.71,-3319.41 7436.56,-3313.57"/>
<text text-anchor="middle" x="7519.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7519.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_1 -->
<g id="edge1190" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8928.54,-3395.85C8895.49,-3387.98 8860.74,-3381.04 8827.79,-3376.86 8758.87,-3368.13 3888.04,-3389.72 3825.79,-3358.86 3810.74,-3351.4 3815.52,-3339.83 3802.79,-3328.86 3797.77,-3324.54 3792.33,-3320.41 3786.68,-3316.52"/>
<polygon fill="black" stroke="black" points="3788.56,-3313.57 3778.29,-3310.99 3784.71,-3319.41 3788.56,-3313.57"/>
<text text-anchor="middle" x="3871.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3871.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→2</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_2 -->
<g id="edge1191" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9250.4,-3394.23C9279.67,-3376.92 9295.33,-3355.1 9274.79,-3328.86 9261.01,-3311.26 9214.01,-3298.89 9168.38,-3290.74"/>
<polygon fill="black" stroke="black" points="9168.82,-3287.26 9158.37,-3289.01 9167.63,-3294.16 9168.82,-3287.26"/>
<text text-anchor="middle" x="9329.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9329.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→4</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_3 -->
<g id="edge1192" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8928.18,-3395.82C8895.23,-3387.98 8860.62,-3381.06 8827.79,-3376.86 8784.01,-3371.27 5689.32,-3378.51 5649.79,-3358.86 5634.75,-3351.39 5639.52,-3339.83 5626.79,-3328.86 5621.77,-3324.54 5616.33,-3320.41 5610.68,-3316.52"/>
<polygon fill="black" stroke="black" points="5612.56,-3313.57 5602.29,-3310.99 5608.71,-3319.41 5612.56,-3313.57"/>
<text text-anchor="middle" x="5695.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5695.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→6</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_4 -->
<g id="edge1193" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9253.04,-3395.84C9286.1,-3387.98 9320.84,-3381.04 9353.79,-3376.86 9390.95,-3372.16 14720.35,-3385.39 14746.79,-3358.86 14787.08,-3318.44 14711.29,-3297.66 14640.55,-3287.33"/>
<polygon fill="black" stroke="black" points="14641,-3283.86 14630.61,-3285.94 14640.03,-3290.79 14641,-3283.86"/>
<text text-anchor="middle" x="14803.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14803.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→8</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_5 -->
<g id="edge1194" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9253.05,-3395.88C9286.1,-3388.02 9320.85,-3381.06 9353.79,-3376.86 9378.38,-3373.73 12905.31,-3376.43 12922.79,-3358.86 12963.05,-3318.41 12887.26,-3297.63 12816.53,-3287.31"/>
<polygon fill="black" stroke="black" points="12816.98,-3283.84 12806.6,-3285.93 12816.02,-3290.78 12816.98,-3283.84"/>
<text text-anchor="middle" x="12979.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12979.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→10</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_6 -->
<g id="edge1195" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8928.54,-3395.82C8895.49,-3387.96 8860.74,-3381.03 8827.79,-3376.86 8781.55,-3371.02 2157.56,-3379.54 2115.79,-3358.86 2100.73,-3351.41 2105.52,-3339.83 2092.79,-3328.86 2087.77,-3324.54 2082.33,-3320.41 2076.68,-3316.52"/>
<polygon fill="black" stroke="black" points="2078.56,-3313.57 2068.29,-3310.99 2074.71,-3319.41 2078.56,-3313.57"/>
<text text-anchor="middle" x="2161.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2161.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→12</text>
</g>
<!-- layer3_gate_0_3&#45;&gt;layer3_expert1_7 -->
<g id="edge1196" class="edge">
<title>layer3_gate_0_3&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9253.42,-3395.94C9286.36,-3388.09 9320.97,-3381.14 9353.79,-3376.86 9377.83,-3373.73 11081.74,-3376.09 11098.79,-3358.86 11138.94,-3318.3 11063.17,-3297.54 10992.47,-3287.26"/>
<polygon fill="black" stroke="black" points="10992.93,-3283.79 10982.54,-3285.88 10991.97,-3290.72 10992.93,-3283.79"/>
<text text-anchor="middle" x="11155.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11155.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 3→14</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_0 -->
<g id="edge1197" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.17,-3395.9C12051.22,-3388.06 12016.61,-3381.11 11983.79,-3376.86 11928.64,-3369.72 10031.55,-3383.7 9981.79,-3358.86 9966.76,-3351.36 9973.79,-3336.43 9958.79,-3328.86 9934.29,-3316.49 8998.24,-3311.39 8970.79,-3310.86 8398.35,-3299.79 7711.59,-3285.35 7458.62,-3279.99"/>
<polygon fill="black" stroke="black" points="7458.43,-3276.48 7448.35,-3279.77 7458.28,-3283.48 7458.43,-3276.48"/>
<text text-anchor="middle" x="10027.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10027.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_1 -->
<g id="edge1198" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.54,-3395.84C12051.49,-3387.97 12016.74,-3381.03 11983.79,-3376.86 11944.84,-3371.93 6364.16,-3377.85 6329.79,-3358.86 6315.98,-3351.23 6324.54,-3336.61 6310.79,-3328.86 6309.06,-3327.89 4288.14,-3288.97 3810.91,-3279.79"/>
<polygon fill="black" stroke="black" points="3810.67,-3276.28 3800.6,-3279.59 3810.53,-3283.28 3810.67,-3276.28"/>
<text text-anchor="middle" x="6375.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6375.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_2 -->
<g id="edge1199" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12080.99,-3397.59C12048.93,-3389.81 12015.45,-3382.45 11983.79,-3376.86 11905.49,-3363.04 11878.88,-3390.17 11805.79,-3358.86 11786.96,-3350.8 11789.94,-3336.15 11770.79,-3328.86 11720.1,-3309.58 10849.01,-3311.88 10794.79,-3310.86 10176.77,-3299.26 9434.28,-3284.93 9169.01,-3279.8"/>
<polygon fill="black" stroke="black" points="9168.7,-3276.3 9158.63,-3279.6 9168.56,-3283.3 9168.7,-3276.3"/>
<text text-anchor="middle" x="11851.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11851.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_3 -->
<g id="edge1200" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.54,-3395.87C12051.48,-3388.01 12016.74,-3381.06 11983.79,-3376.86 11931.02,-3370.14 8200.33,-3384.62 8153.79,-3358.86 8139.98,-3351.22 8148.54,-3336.61 8134.79,-3328.86 8133.06,-3327.89 6112.14,-3288.97 5634.91,-3279.79"/>
<polygon fill="black" stroke="black" points="5634.67,-3276.28 5624.6,-3279.59 5634.53,-3283.28 5634.67,-3276.28"/>
<text text-anchor="middle" x="8199.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8199.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_4 -->
<g id="edge1201" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12495.53,-3441.81C13252.32,-3435.69 15478.93,-3413.1 15531.79,-3358.86 15541.1,-3349.31 15540.97,-3338.53 15531.79,-3328.86 15501.45,-3296.92 14886.83,-3283.46 14641.07,-3279.35"/>
<polygon fill="black" stroke="black" points="14640.77,-3275.84 14630.71,-3279.17 14640.65,-3282.84 14640.77,-3275.84"/>
<text text-anchor="middle" x="15583.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15583.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_5 -->
<g id="edge1202" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12495.05,-3441.61C13235.36,-3434.98 15379.74,-3411.29 15430.79,-3358.86 15440.09,-3349.31 15440.13,-3338.38 15430.79,-3328.86 15411.56,-3309.28 14470.24,-3311.38 14442.79,-3310.86 13824.77,-3299.33 13082.28,-3284.96 12817.01,-3279.81"/>
<polygon fill="black" stroke="black" points="12816.7,-3276.3 12806.63,-3279.61 12816.56,-3283.3 12816.7,-3276.3"/>
<text text-anchor="middle" x="15482.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15482.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_6 -->
<g id="edge1203" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.55,-3395.82C12051.49,-3387.95 12016.74,-3381.02 11983.79,-3376.86 11932.27,-3370.36 4551.26,-3383.96 4505.79,-3358.86 4491.97,-3351.24 4500.54,-3336.61 4486.79,-3328.86 4486.79,-3328.86 2563.83,-3289.41 2100.39,-3279.91"/>
<polygon fill="black" stroke="black" points="2100.44,-3276.41 2090.37,-3279.7 2100.3,-3283.41 2100.44,-3276.41"/>
<text text-anchor="middle" x="4551.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4551.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer3_gate_1_0&#45;&gt;layer3_expert1_7 -->
<g id="edge1204" class="edge">
<title>layer3_gate_1_0&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12486.63,-3436.96C12863.72,-3425.28 13556.54,-3398.54 13593.79,-3358.86 13602.92,-3349.14 13603.13,-3338.38 13593.79,-3328.86 13574.81,-3309.53 12645.87,-3311.37 12618.79,-3310.86 12000.77,-3299.25 11258.28,-3284.93 10993.01,-3279.8"/>
<polygon fill="black" stroke="black" points="10992.7,-3276.3 10982.63,-3279.6 10992.56,-3283.3 10992.7,-3276.3"/>
<text text-anchor="middle" x="13645.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13645.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_0 -->
<g id="edge1205" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345.34,-3398.53C7313.73,-3390.75 7280.84,-3383.16 7249.79,-3376.86 7223.79,-3371.59 7149.08,-3378.98 7131.79,-3358.86 7089.89,-3310.09 7180.1,-3290.68 7258.9,-3282.96"/>
<polygon fill="black" stroke="black" points="7259.31,-3286.44 7268.94,-3282.03 7258.66,-3279.47 7259.31,-3286.44"/>
<text text-anchor="middle" x="7177.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7177.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→0</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_1 -->
<g id="edge1206" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7350.54,-3395.88C7317.48,-3388.01 7282.74,-3381.06 7249.79,-3376.86 7223.85,-3373.56 3502.24,-3377.4 3483.79,-3358.86 3438.15,-3313 3530.47,-3292.99 3610.74,-3284.33"/>
<polygon fill="black" stroke="black" points="3611.37,-3287.79 3620.96,-3283.28 3610.66,-3280.82 3611.37,-3287.79"/>
<text text-anchor="middle" x="3529.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3529.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→2</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_2 -->
<g id="edge1207" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7675.43,-3396.07C7708.38,-3388.22 7742.99,-3381.22 7775.79,-3376.86 7839.52,-3368.4 8876.71,-3390.3 8932.79,-3358.86 8946.56,-3351.15 8939.81,-3339.14 8951.79,-3328.86 8957.46,-3324.01 8963.66,-3319.54 8970.16,-3315.46"/>
<polygon fill="black" stroke="black" points="8972.36,-3318.22 8979.18,-3310.11 8968.79,-3312.2 8972.36,-3318.22"/>
<text text-anchor="middle" x="8997.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8997.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→4</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_3 -->
<g id="edge1208" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7350.17,-3395.91C7317.22,-3388.07 7282.61,-3381.12 7249.79,-3376.86 7223.04,-3373.4 5326.78,-3378.03 5307.79,-3358.86 5262.25,-3312.9 5354.55,-3292.91 5434.79,-3284.29"/>
<polygon fill="black" stroke="black" points="5435.41,-3287.74 5445.01,-3283.24 5434.7,-3280.78 5435.41,-3287.74"/>
<text text-anchor="middle" x="5353.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5353.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→6</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_4 -->
<g id="edge1209" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7675.04,-3395.82C7708.09,-3387.96 7742.84,-3381.03 7775.79,-3376.86 7821.46,-3371.09 14364.49,-3381.11 14404.79,-3358.86 14418.61,-3351.24 14411.81,-3339.14 14423.79,-3328.86 14429.46,-3324.01 14435.66,-3319.54 14442.16,-3315.46"/>
<polygon fill="black" stroke="black" points="14444.36,-3318.22 14451.18,-3310.11 14440.79,-3312.2 14444.36,-3318.22"/>
<text text-anchor="middle" x="14469.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14469.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→8</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_5 -->
<g id="edge1210" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7675.04,-3395.85C7708.1,-3387.98 7742.84,-3381.04 7775.79,-3376.86 7808.89,-3372.66 12551.59,-3375.01 12580.79,-3358.86 12594.6,-3351.23 12587.81,-3339.14 12599.79,-3328.86 12605.46,-3324.01 12611.66,-3319.54 12618.16,-3315.46"/>
<polygon fill="black" stroke="black" points="12620.36,-3318.22 12627.18,-3310.11 12616.79,-3312.2 12620.36,-3318.22"/>
<text text-anchor="middle" x="12645.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12645.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→10</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_6 -->
<g id="edge1211" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7350.54,-3395.84C7317.49,-3387.97 7282.74,-3381.04 7249.79,-3376.86 7212.06,-3372.09 1800.64,-3385.8 1773.79,-3358.86 1728.11,-3313.04 1820.44,-3293.02 1900.72,-3284.35"/>
<polygon fill="black" stroke="black" points="1901.36,-3287.8 1910.95,-3283.3 1900.64,-3280.84 1901.36,-3287.8"/>
<text text-anchor="middle" x="1819.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1819.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→12</text>
</g>
<!-- layer3_gate_1_1&#45;&gt;layer3_expert1_7 -->
<g id="edge1212" class="edge">
<title>layer3_gate_1_1&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7675.4,-3395.83C7708.35,-3387.99 7742.97,-3381.07 7775.79,-3376.86 7816.86,-3371.61 10720.58,-3378.94 10756.79,-3358.86 10770.6,-3351.21 10763.81,-3339.14 10775.79,-3328.86 10781.46,-3324.01 10787.66,-3319.54 10794.16,-3315.46"/>
<polygon fill="black" stroke="black" points="10796.36,-3318.22 10803.18,-3310.11 10792.79,-3312.2 10796.36,-3318.22"/>
<text text-anchor="middle" x="10821.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10821.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 5→14</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_0 -->
<g id="edge1213" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5571.79,-3396.06C5604.64,-3388.23 5639.11,-3381.25 5671.79,-3376.86 5725.82,-3369.61 6605.28,-3385.58 6652.79,-3358.86 6666.55,-3351.13 6658.26,-3336.98 6671.79,-3328.86 6720.87,-3299.43 7080.62,-3285.5 7259.03,-3280.34"/>
<polygon fill="black" stroke="black" points="7259.32,-3283.84 7269.21,-3280.05 7259.12,-3276.84 7259.32,-3283.84"/>
<text text-anchor="middle" x="6717.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6717.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_1 -->
<g id="edge1214" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5246.17,-3395.89C5213.22,-3388.05 5178.61,-3381.11 5145.79,-3376.86 5116.62,-3373.09 3048.5,-3379.75 3027.79,-3358.86 3018.4,-3349.4 3018.72,-3338.64 3027.79,-3328.86 3066.59,-3287.06 3430.91,-3279.27 3610.99,-3277.99"/>
<polygon fill="black" stroke="black" points="3611.03,-3281.49 3621.01,-3277.93 3610.98,-3274.49 3611.03,-3281.49"/>
<text text-anchor="middle" x="3073.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3073.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_2 -->
<g id="edge1215" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5571.4,-3395.84C5604.35,-3388 5638.97,-3381.07 5671.79,-3376.86 5710.43,-3371.91 8442.72,-3377.76 8476.79,-3358.86 8490.59,-3351.21 8482.32,-3337.08 8495.79,-3328.86 8535.13,-3304.88 8815.42,-3288.98 8968.9,-3281.96"/>
<polygon fill="black" stroke="black" points="8969.44,-3285.44 8979.27,-3281.49 8969.12,-3278.45 8969.44,-3285.44"/>
<text text-anchor="middle" x="8541.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8541.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_3 -->
<g id="edge1216" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5244.57,-3396.91C5212.06,-3389.09 5178.02,-3381.9 5145.79,-3376.86 5113.46,-3371.82 4874.22,-3382.7 4851.79,-3358.86 4842.66,-3349.15 4842.72,-3338.64 4851.79,-3328.86 4890.59,-3287.06 5254.91,-3279.27 5434.99,-3277.99"/>
<polygon fill="black" stroke="black" points="5435.03,-3281.49 5445.01,-3277.93 5434.98,-3274.49 5435.03,-3281.49"/>
<text text-anchor="middle" x="4897.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4897.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_4 -->
<g id="edge1217" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5571.04,-3395.81C5604.09,-3387.95 5638.84,-3381.02 5671.79,-3376.86 5728.82,-3369.67 13898.46,-3386.63 13948.79,-3358.86 13962.61,-3351.24 13954.32,-3337.08 13967.79,-3328.86 14007.13,-3304.88 14287.42,-3288.98 14440.9,-3281.96"/>
<polygon fill="black" stroke="black" points="14441.44,-3285.44 14451.27,-3281.49 14441.12,-3278.45 14441.44,-3285.44"/>
<text text-anchor="middle" x="14013.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14013.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_5 -->
<g id="edge1218" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5571.04,-3395.83C5604.09,-3387.96 5638.84,-3381.03 5671.79,-3376.86 5716.25,-3371.25 12085.56,-3380.53 12124.79,-3358.86 12138.61,-3351.24 12130.32,-3337.08 12143.79,-3328.86 12183.13,-3304.88 12463.42,-3288.98 12616.9,-3281.96"/>
<polygon fill="black" stroke="black" points="12617.44,-3285.44 12627.27,-3281.49 12617.12,-3278.45 12617.44,-3285.44"/>
<text text-anchor="middle" x="12189.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12189.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_6 -->
<g id="edge1219" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5246.54,-3395.87C5213.48,-3388.01 5178.74,-3381.06 5145.79,-3376.86 5119.42,-3373.51 1336.54,-3377.71 1317.79,-3358.86 1308.39,-3349.41 1308.72,-3338.64 1317.79,-3328.86 1356.59,-3287.06 1720.91,-3279.27 1900.99,-3277.99"/>
<polygon fill="black" stroke="black" points="1901.03,-3281.49 1911.01,-3277.93 1900.98,-3274.49 1901.03,-3281.49"/>
<text text-anchor="middle" x="1363.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1363.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer3_gate_1_2&#45;&gt;layer3_expert1_7 -->
<g id="edge1220" class="edge">
<title>layer3_gate_1_2&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5571.04,-3395.85C5604.1,-3387.99 5638.84,-3381.05 5671.79,-3376.86 5735.57,-3368.77 10244.53,-3389.97 10300.79,-3358.86 10314.6,-3351.23 10306.32,-3337.08 10319.79,-3328.86 10359.13,-3304.88 10639.42,-3288.98 10792.9,-3281.96"/>
<polygon fill="black" stroke="black" points="10793.44,-3285.44 10803.27,-3281.49 10793.12,-3278.45 10793.44,-3285.44"/>
<text text-anchor="middle" x="10365.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10365.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_0 -->
<g id="edge1221" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10506.18,-3395.85C10473.23,-3388.01 10438.62,-3381.08 10405.79,-3376.86 10334.43,-3367.7 7880.2,-3390.92 7815.79,-3358.86 7800.75,-3351.38 7807.4,-3337.17 7792.79,-3328.86 7737.55,-3297.46 7568.76,-3285.32 7458.69,-3280.68"/>
<polygon fill="black" stroke="black" points="7458.69,-3277.17 7448.56,-3280.26 7458.4,-3284.17 7458.69,-3277.17"/>
<text text-anchor="middle" x="7861.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7861.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→0</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_1 -->
<g id="edge1222" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10506.54,-3395.83C10473.49,-3387.96 10438.74,-3381.03 10405.79,-3376.86 10362.81,-3371.43 4206.61,-3378.09 4167.79,-3358.86 4152.74,-3351.41 4159.4,-3337.17 4144.79,-3328.86 4089.55,-3297.46 3920.76,-3285.32 3810.69,-3280.68"/>
<polygon fill="black" stroke="black" points="3810.69,-3277.17 3800.56,-3280.26 3810.4,-3284.17 3810.69,-3277.17"/>
<text text-anchor="middle" x="4213.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4213.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→2</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_2 -->
<g id="edge1223" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10505.77,-3396.19C10472.93,-3388.36 10438.46,-3381.34 10405.79,-3376.86 10363.62,-3371.09 9677.74,-3378.15 9639.79,-3358.86 9624.81,-3351.25 9631.5,-3336.99 9616.79,-3328.86 9542.13,-3287.62 9305.09,-3279.1 9168.46,-3277.72"/>
<polygon fill="black" stroke="black" points="9168.42,-3274.22 9158.39,-3277.63 9168.36,-3281.22 9168.42,-3274.22"/>
<text text-anchor="middle" x="9685.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9685.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→4</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_3 -->
<g id="edge1224" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10506.54,-3395.86C10473.48,-3387.99 10438.74,-3381.05 10405.79,-3376.86 10344.97,-3369.14 6046.71,-3386.1 5991.79,-3358.86 5976.74,-3351.4 5983.4,-3337.17 5968.79,-3328.86 5913.55,-3297.46 5744.76,-3285.32 5634.69,-3280.68"/>
<polygon fill="black" stroke="black" points="5634.69,-3277.17 5624.56,-3280.26 5634.4,-3284.17 5634.69,-3277.17"/>
<text text-anchor="middle" x="6037.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6037.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→6</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_4 -->
<g id="edge1225" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10831.04,-3395.87C10864.1,-3388 10898.85,-3381.05 10931.79,-3376.86 10960.43,-3373.22 15068.42,-3379.32 15088.79,-3358.86 15098.2,-3349.42 15097.77,-3338.72 15088.79,-3328.86 15059.26,-3296.46 14790.41,-3284.3 14640.57,-3280.02"/>
<polygon fill="black" stroke="black" points="14640.53,-3276.52 14630.43,-3279.74 14640.33,-3283.52 14640.53,-3276.52"/>
<text text-anchor="middle" x="15140.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15140.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→8</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_5 -->
<g id="edge1226" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10831.41,-3395.87C10864.36,-3388.03 10898.97,-3381.09 10931.79,-3376.86 10963.93,-3372.72 13241.97,-3381.87 13264.79,-3358.86 13274.18,-3349.4 13273.77,-3338.72 13264.79,-3328.86 13235.26,-3296.46 12966.41,-3284.3 12816.57,-3280.02"/>
<polygon fill="black" stroke="black" points="12816.53,-3276.52 12806.43,-3279.74 12816.33,-3283.52 12816.53,-3276.52"/>
<text text-anchor="middle" x="13316.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13316.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→10</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_6 -->
<g id="edge1227" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10506.55,-3395.81C10473.49,-3387.95 10438.74,-3381.02 10405.79,-3376.86 10351.03,-3369.96 2507.26,-3383.34 2457.79,-3358.86 2442.73,-3351.41 2449.4,-3337.17 2434.79,-3328.86 2379.55,-3297.46 2210.76,-3285.32 2100.69,-3280.68"/>
<polygon fill="black" stroke="black" points="2100.69,-3277.17 2090.56,-3280.26 2100.4,-3284.17 2100.69,-3277.17"/>
<text text-anchor="middle" x="2503.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2503.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→12</text>
</g>
<!-- layer3_gate_1_3&#45;&gt;layer3_expert1_7 -->
<g id="edge1228" class="edge">
<title>layer3_gate_1_3&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10832.21,-3396.42C10864.94,-3388.59 10899.26,-3381.51 10931.79,-3376.86 10959.8,-3372.86 11421.14,-3379.22 11440.79,-3358.86 11450.05,-3349.27 11449.77,-3338.72 11440.79,-3328.86 11411.26,-3296.46 11142.41,-3284.3 10992.57,-3280.02"/>
<polygon fill="black" stroke="black" points="10992.53,-3276.52 10982.43,-3279.74 10992.33,-3283.52 10992.53,-3276.52"/>
<text text-anchor="middle" x="11492.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11492.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 7→14</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_0 -->
<g id="edge1229" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9454.17,-3395.93C9421.22,-3388.09 9386.61,-3381.13 9353.79,-3376.86 9305.14,-3370.53 7631.67,-3380.79 7587.79,-3358.86 7572.76,-3351.35 7578.85,-3338.07 7564.79,-3328.86 7533.31,-3308.25 7494.15,-3295.97 7458.46,-3288.65"/>
<polygon fill="black" stroke="black" points="7458.97,-3285.18 7448.49,-3286.71 7457.64,-3292.05 7458.97,-3285.18"/>
<text text-anchor="middle" x="7633.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7633.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_1 -->
<g id="edge1230" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9454.54,-3395.84C9421.49,-3387.97 9386.74,-3381.04 9353.79,-3376.86 9316.49,-3372.14 3973.48,-3375.56 3939.79,-3358.86 3924.74,-3351.4 3930.85,-3338.07 3916.79,-3328.86 3885.31,-3308.25 3846.15,-3295.97 3810.46,-3288.65"/>
<polygon fill="black" stroke="black" points="3810.97,-3285.18 3800.49,-3286.71 3809.64,-3292.05 3810.97,-3285.18"/>
<text text-anchor="middle" x="3985.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3985.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_2 -->
<g id="edge1231" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9467.31,-3389C9448.1,-3379.92 9429.11,-3369.84 9411.79,-3358.86 9395.05,-3348.25 9396.64,-3337.49 9378.79,-3328.86 9313.21,-3297.15 9231.67,-3284.64 9168.69,-3279.94"/>
<polygon fill="black" stroke="black" points="9168.56,-3276.42 9158.35,-3279.22 9168.08,-3283.4 9168.56,-3276.42"/>
<text text-anchor="middle" x="9457.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9457.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_3 -->
<g id="edge1232" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9454.54,-3395.88C9421.48,-3388.02 9386.74,-3381.06 9353.79,-3376.86 9304.33,-3370.56 5808.45,-3381.04 5763.79,-3358.86 5748.74,-3351.39 5754.85,-3338.07 5740.79,-3328.86 5709.31,-3308.25 5670.15,-3295.97 5634.46,-3288.65"/>
<polygon fill="black" stroke="black" points="5634.97,-3285.18 5624.49,-3286.71 5633.64,-3292.05 5634.97,-3285.18"/>
<text text-anchor="middle" x="5809.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5809.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_4 -->
<g id="edge1233" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9779.04,-3395.85C9812.1,-3387.98 9846.84,-3381.04 9879.79,-3376.86 9914.11,-3372.51 14836.38,-3383.37 14860.79,-3358.86 14870.2,-3349.42 14869.45,-3339.01 14860.79,-3328.86 14832.81,-3296.07 14723.63,-3284.26 14640.51,-3280.07"/>
<polygon fill="black" stroke="black" points="14640.66,-3276.57 14630.51,-3279.59 14640.33,-3283.56 14640.66,-3276.57"/>
<text text-anchor="middle" x="14912.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14912.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_5 -->
<g id="edge1234" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9779.4,-3395.82C9812.35,-3387.98 9846.97,-3381.06 9879.79,-3376.86 9901.54,-3374.08 13021.33,-3374.41 13036.79,-3358.86 13046.19,-3349.41 13045.45,-3339.01 13036.79,-3328.86 13008.81,-3296.07 12899.63,-3284.26 12816.51,-3280.07"/>
<polygon fill="black" stroke="black" points="12816.66,-3276.57 12806.51,-3279.59 12816.33,-3283.56 12816.66,-3276.57"/>
<text text-anchor="middle" x="13088.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13088.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_6 -->
<g id="edge1235" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9454.54,-3395.82C9421.49,-3387.96 9386.74,-3381.02 9353.79,-3376.86 9304.71,-3370.67 2274.13,-3380.81 2229.79,-3358.86 2214.73,-3351.41 2220.85,-3338.07 2206.79,-3328.86 2175.31,-3308.25 2136.15,-3295.97 2100.46,-3288.65"/>
<polygon fill="black" stroke="black" points="2100.97,-3285.18 2090.49,-3286.71 2099.64,-3292.05 2100.97,-3285.18"/>
<text text-anchor="middle" x="2275.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2275.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer3_gate_2_0&#45;&gt;layer3_expert1_7 -->
<g id="edge1236" class="edge">
<title>layer3_gate_2_0&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9779.43,-3396.02C9812.37,-3388.17 9846.98,-3381.19 9879.79,-3376.86 9916.5,-3372.02 11186.78,-3385.23 11212.79,-3358.86 11222.16,-3349.37 11221.45,-3339.01 11212.79,-3328.86 11184.81,-3296.07 11075.63,-3284.26 10992.51,-3280.07"/>
<polygon fill="black" stroke="black" points="10992.66,-3276.57 10982.51,-3279.59 10992.33,-3283.56 10992.66,-3276.57"/>
<text text-anchor="middle" x="11264.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11264.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_0 -->
<g id="edge1237" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6098.19,-3396.32C6130.93,-3388.5 6165.26,-3381.45 6197.79,-3376.86 6260.43,-3368.03 6711.86,-3390.23 6766.79,-3358.86 6780.5,-3351.04 6772.32,-3337.08 6785.79,-3328.86 6825.13,-3304.88 7105.42,-3288.98 7258.9,-3281.96"/>
<polygon fill="black" stroke="black" points="7259.44,-3285.44 7269.27,-3281.49 7259.12,-3278.45 7259.44,-3285.44"/>
<text text-anchor="middle" x="6831.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6831.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→0</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_1 -->
<g id="edge1238" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5772.18,-3395.85C5739.23,-3388.02 5704.61,-3381.08 5671.79,-3376.86 5636.94,-3372.38 3166.55,-3383.8 3141.79,-3358.86 3074.09,-3290.67 3430.36,-3279.24 3610.95,-3277.76"/>
<polygon fill="black" stroke="black" points="3611.02,-3281.26 3621,-3277.69 3610.97,-3274.26 3611.02,-3281.26"/>
<text text-anchor="middle" x="3187.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3187.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→2</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_2 -->
<g id="edge1239" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6097.41,-3395.86C6130.36,-3388.03 6164.97,-3381.09 6197.79,-3376.86 6263.72,-3368.37 8532.68,-3391.13 8590.79,-3358.86 8604.59,-3351.2 8596.41,-3337.23 8609.79,-3328.86 8667.77,-3292.64 8852.18,-3282.05 8968.85,-3279.01"/>
<polygon fill="black" stroke="black" points="8968.97,-3282.51 8978.88,-3278.76 8968.79,-3275.51 8968.97,-3282.51"/>
<text text-anchor="middle" x="8655.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8655.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→4</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_3 -->
<g id="edge1240" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5771.76,-3396.25C5738.92,-3388.4 5704.46,-3381.37 5671.79,-3376.86 5632.92,-3371.5 4993.18,-3386.96 4965.79,-3358.86 4898.71,-3290.06 5254.67,-3278.93 5435.06,-3277.65"/>
<polygon fill="black" stroke="black" points="5435.12,-3281.15 5445.1,-3277.58 5435.08,-3274.15 5435.12,-3281.15"/>
<text text-anchor="middle" x="5011.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5011.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→6</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_4 -->
<g id="edge1241" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6097.04,-3395.81C6130.09,-3387.95 6164.84,-3381.02 6197.79,-3376.86 6251.98,-3370.03 14014.97,-3385.25 14062.79,-3358.86 14076.61,-3351.24 14068.41,-3337.23 14081.79,-3328.86 14139.77,-3292.64 14324.18,-3282.05 14440.85,-3279.01"/>
<polygon fill="black" stroke="black" points="14440.97,-3282.51 14450.88,-3278.76 14440.79,-3275.51 14440.97,-3282.51"/>
<text text-anchor="middle" x="14127.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14127.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→8</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_5 -->
<g id="edge1242" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6097.04,-3395.83C6130.1,-3387.97 6164.84,-3381.03 6197.79,-3376.86 6239.41,-3371.6 12202.07,-3379.15 12238.79,-3358.86 12252.61,-3351.23 12244.41,-3337.23 12257.79,-3328.86 12315.77,-3292.64 12500.18,-3282.05 12616.85,-3279.01"/>
<polygon fill="black" stroke="black" points="12616.97,-3282.51 12626.88,-3278.76 12616.79,-3275.51 12616.97,-3282.51"/>
<text text-anchor="middle" x="12303.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12303.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→10</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_6 -->
<g id="edge1243" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5772.54,-3395.86C5739.48,-3388 5704.74,-3381.05 5671.79,-3376.86 5642.58,-3373.15 1452.57,-3379.73 1431.79,-3358.86 1363.99,-3290.77 1720.31,-3279.29 1900.93,-3277.78"/>
<polygon fill="black" stroke="black" points="1901.01,-3281.28 1910.98,-3277.7 1900.96,-3274.28 1901.01,-3281.28"/>
<text text-anchor="middle" x="1477.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1477.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→12</text>
</g>
<!-- layer3_gate_2_1&#45;&gt;layer3_expert1_7 -->
<g id="edge1244" class="edge">
<title>layer3_gate_2_1&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6097.04,-3395.86C6130.1,-3388 6164.85,-3381.05 6197.79,-3376.86 6255.89,-3369.48 10363.54,-3387.21 10414.79,-3358.86 10428.6,-3351.22 10420.41,-3337.23 10433.79,-3328.86 10491.77,-3292.64 10676.18,-3282.05 10792.85,-3279.01"/>
<polygon fill="black" stroke="black" points="10792.97,-3282.51 10802.88,-3278.76 10792.79,-3275.51 10792.97,-3282.51"/>
<text text-anchor="middle" x="10479.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10479.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 9→14</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_0 -->
<g id="edge1245" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6627,-3397.84C6658.96,-3390.06 6692.28,-3382.64 6723.79,-3376.86 6792.87,-3364.19 6818.08,-3390.48 6880.79,-3358.86 6897.08,-3350.65 6892.5,-3337.06 6908.79,-3328.86 6968.19,-3298.97 7145.54,-3286.31 7259.05,-3281.17"/>
<polygon fill="black" stroke="black" points="7259.32,-3284.66 7269.15,-3280.72 7259.01,-3277.67 7259.32,-3284.66"/>
<text text-anchor="middle" x="6954.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6954.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_1 -->
<g id="edge1246" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6298.18,-3395.83C6265.23,-3387.99 6230.62,-3381.07 6197.79,-3376.86 6157.26,-3371.67 3284.6,-3387.85 3255.79,-3358.86 3246.39,-3349.41 3246.9,-3338.8 3255.79,-3328.86 3279.04,-3302.87 3484.24,-3288.55 3611,-3282.11"/>
<polygon fill="black" stroke="black" points="3611.31,-3285.6 3621.12,-3281.6 3610.96,-3278.61 3611.31,-3285.6"/>
<text text-anchor="middle" x="3301.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3301.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_2 -->
<g id="edge1247" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6623.41,-3395.9C6656.36,-3388.06 6690.97,-3381.12 6723.79,-3376.86 6778.37,-3369.79 8656.7,-3385.62 8704.79,-3358.86 8718.58,-3351.19 8710.56,-3337.47 8723.79,-3328.86 8763.22,-3303.23 8881.84,-3289.93 8969.02,-3283.43"/>
<polygon fill="black" stroke="black" points="8969.5,-3286.9 8979.22,-3282.69 8968.99,-3279.92 8969.5,-3286.9"/>
<text text-anchor="middle" x="8769.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8769.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_3 -->
<g id="edge1248" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6298.15,-3396.09C6265.2,-3388.23 6230.6,-3381.23 6197.79,-3376.86 6167,-3372.76 5101.58,-3381 5079.79,-3358.86 5070.44,-3349.36 5070.9,-3338.8 5079.79,-3328.86 5103.04,-3302.87 5308.24,-3288.55 5435,-3282.11"/>
<polygon fill="black" stroke="black" points="5435.31,-3285.6 5445.12,-3281.6 5434.96,-3278.61 5435.31,-3285.6"/>
<text text-anchor="middle" x="5125.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5125.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_4 -->
<g id="edge1249" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6623.04,-3395.82C6656.09,-3387.95 6690.84,-3381.02 6723.79,-3376.86 6775.14,-3370.38 14131.48,-3383.87 14176.79,-3358.86 14190.61,-3351.24 14182.56,-3337.47 14195.79,-3328.86 14235.22,-3303.23 14353.84,-3289.93 14441.02,-3283.43"/>
<polygon fill="black" stroke="black" points="14441.5,-3286.9 14451.22,-3282.69 14440.99,-3279.92 14441.5,-3286.9"/>
<text text-anchor="middle" x="14241.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14241.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_5 -->
<g id="edge1250" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6623.04,-3395.84C6656.1,-3387.97 6690.84,-3381.03 6723.79,-3376.86 6762.57,-3371.95 12318.57,-3377.77 12352.79,-3358.86 12366.61,-3351.23 12358.56,-3337.47 12371.79,-3328.86 12411.22,-3303.23 12529.84,-3289.93 12617.02,-3283.43"/>
<polygon fill="black" stroke="black" points="12617.5,-3286.9 12627.22,-3282.69 12616.99,-3279.92 12617.5,-3286.9"/>
<text text-anchor="middle" x="12417.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12417.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_6 -->
<g id="edge1251" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6298.54,-3395.85C6265.48,-3387.99 6230.74,-3381.05 6197.79,-3376.86 6165.74,-3372.8 1568.59,-3381.75 1545.79,-3358.86 1536.38,-3349.42 1536.9,-3338.8 1545.79,-3328.86 1569.04,-3302.87 1774.24,-3288.55 1901,-3282.11"/>
<polygon fill="black" stroke="black" points="1901.31,-3285.6 1911.12,-3281.6 1900.96,-3278.61 1901.31,-3285.6"/>
<text text-anchor="middle" x="1591.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1591.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer3_gate_2_2&#45;&gt;layer3_expert1_7 -->
<g id="edge1252" class="edge">
<title>layer3_gate_2_2&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6623.04,-3395.88C6656.1,-3388.01 6690.85,-3381.06 6723.79,-3376.86 6776.22,-3370.19 10482.55,-3384.45 10528.79,-3358.86 10542.6,-3351.22 10534.56,-3337.47 10547.79,-3328.86 10587.22,-3303.23 10705.84,-3289.93 10793.02,-3283.43"/>
<polygon fill="black" stroke="black" points="10793.5,-3286.9 10803.22,-3282.69 10792.99,-3279.92 10793.5,-3286.9"/>
<text text-anchor="middle" x="10593.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10593.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_0 -->
<g id="edge1253" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11558.54,-3395.89C11525.48,-3388.02 11490.74,-3381.07 11457.79,-3376.86 11410.76,-3370.86 8086.26,-3379.96 8043.79,-3358.86 8028.74,-3351.39 8035.56,-3336.87 8020.79,-3328.86 7972.67,-3302.77 7631.44,-3287.32 7458.6,-3281.09"/>
<polygon fill="black" stroke="black" points="7458.6,-3277.58 7448.48,-3280.72 7458.35,-3284.58 7458.6,-3277.58"/>
<text text-anchor="middle" x="8089.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8089.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→0</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_1 -->
<g id="edge1254" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11558.54,-3395.82C11525.49,-3387.96 11490.74,-3381.02 11457.79,-3376.86 11409.14,-3370.72 4439.74,-3380.62 4395.79,-3358.86 4380.73,-3351.41 4387.56,-3336.87 4372.79,-3328.86 4324.67,-3302.77 3983.44,-3287.32 3810.6,-3281.09"/>
<polygon fill="black" stroke="black" points="3810.6,-3277.58 3800.48,-3280.72 3810.35,-3284.58 3810.6,-3277.58"/>
<text text-anchor="middle" x="4441.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4441.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→2</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_2 -->
<g id="edge1255" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11558.16,-3395.96C11525.22,-3388.12 11490.61,-3381.15 11457.79,-3376.86 11413.99,-3371.14 9907.29,-3378.63 9867.79,-3358.86 9852.77,-3351.34 9859.61,-3336.79 9844.79,-3328.86 9786.61,-3297.74 9364.83,-3284.41 9168.65,-3279.85"/>
<polygon fill="black" stroke="black" points="9168.7,-3276.35 9158.62,-3279.62 9168.54,-3283.35 9168.7,-3276.35"/>
<text text-anchor="middle" x="9913.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9913.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→4</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_3 -->
<g id="edge1256" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11558.54,-3395.84C11525.49,-3387.98 11490.74,-3381.04 11457.79,-3376.86 11385.62,-3367.72 6284.98,-3391.17 6219.79,-3358.86 6204.74,-3351.4 6211.56,-3336.87 6196.79,-3328.86 6148.67,-3302.77 5807.44,-3287.32 5634.6,-3281.09"/>
<polygon fill="black" stroke="black" points="5634.6,-3277.58 5624.48,-3280.72 5634.35,-3284.58 5634.6,-3277.58"/>
<text text-anchor="middle" x="6265.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6265.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→6</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_4 -->
<g id="edge1257" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11883.4,-3395.81C11916.35,-3387.98 11950.96,-3381.06 11983.79,-3376.86 12006.75,-3373.93 15300.47,-3375.27 15316.79,-3358.86 15326.19,-3349.41 15325.91,-3338.6 15316.79,-3328.86 15271.52,-3280.52 14839.78,-3276.32 14640.59,-3277"/>
<polygon fill="black" stroke="black" points="14640.4,-3273.5 14630.41,-3277.04 14640.43,-3280.5 14640.4,-3273.5"/>
<text text-anchor="middle" x="15368.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15368.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→8</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_5 -->
<g id="edge1258" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11883.42,-3395.98C11916.37,-3388.13 11950.98,-3381.16 11983.79,-3376.86 12004.57,-3374.14 13478.06,-3373.77 13492.79,-3358.86 13502.16,-3349.38 13501.91,-3338.6 13492.79,-3328.86 13447.52,-3280.52 13015.78,-3276.32 12816.59,-3277"/>
<polygon fill="black" stroke="black" points="12816.4,-3273.5 12806.41,-3277.04 12816.43,-3280.5 12816.4,-3273.5"/>
<text text-anchor="middle" x="13544.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13544.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→10</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_6 -->
<g id="edge1259" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11558.55,-3395.81C11525.49,-3387.94 11490.74,-3381.02 11457.79,-3376.86 11397.44,-3369.26 2755.96,-3379.63 2698.79,-3358.86 2679.22,-3351.75 2682.09,-3336.7 2662.79,-3328.86 2563.64,-3288.59 2260.08,-3279.91 2100.77,-3278.18"/>
<polygon fill="black" stroke="black" points="2100.53,-3274.68 2090.49,-3278.07 2100.46,-3281.68 2100.53,-3274.68"/>
<text text-anchor="middle" x="2744.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2744.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→12</text>
</g>
<!-- layer3_gate_2_3&#45;&gt;layer3_expert1_7 -->
<g id="edge1260" class="edge">
<title>layer3_gate_2_3&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11689.83,-3376.86C11677.83,-3358.21 11662.22,-3340.01 11642.79,-3328.86 11587.78,-3297.3 11183.84,-3284.26 10992.62,-3279.82"/>
<polygon fill="black" stroke="black" points="10992.64,-3276.32 10982.57,-3279.59 10992.48,-3283.32 10992.64,-3276.32"/>
<text text-anchor="middle" x="11721.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11721.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 11→14</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_0 -->
<g id="edge1261" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11032.18,-3395.82C10999.23,-3387.99 10964.62,-3381.07 10931.79,-3376.86 10890.43,-3371.57 7967.13,-3377.42 7929.79,-3358.86 7914.75,-3351.38 7921.5,-3336.99 7906.79,-3328.86 7832.13,-3287.62 7595.09,-3279.1 7458.46,-3277.72"/>
<polygon fill="black" stroke="black" points="7458.42,-3274.22 7448.39,-3277.63 7458.36,-3281.22 7458.42,-3274.22"/>
<text text-anchor="middle" x="7975.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7975.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_1 -->
<g id="edge1262" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11032.54,-3395.82C10999.49,-3387.96 10964.74,-3381.03 10931.79,-3376.86 10885.97,-3371.08 4323.18,-3379.35 4281.79,-3358.86 4266.73,-3351.41 4273.5,-3336.99 4258.79,-3328.86 4184.13,-3287.62 3947.09,-3279.1 3810.46,-3277.72"/>
<polygon fill="black" stroke="black" points="3810.42,-3274.22 3800.39,-3277.63 3810.36,-3281.22 3810.42,-3274.22"/>
<text text-anchor="middle" x="4327.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4327.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_2 -->
<g id="edge1263" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11032.15,-3396.07C10999.2,-3388.21 10964.6,-3381.22 10931.79,-3376.86 10866.91,-3368.25 9812.26,-3388.27 9753.79,-3358.86 9738.78,-3351.32 9745.56,-3336.87 9730.79,-3328.86 9682.67,-3302.77 9341.44,-3287.32 9168.6,-3281.09"/>
<polygon fill="black" stroke="black" points="9168.6,-3277.58 9158.48,-3280.72 9168.35,-3284.58 9168.6,-3277.58"/>
<text text-anchor="middle" x="9799.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9799.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_3 -->
<g id="edge1264" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11032.54,-3395.85C10999.49,-3387.98 10964.74,-3381.04 10931.79,-3376.86 10865.3,-3368.43 6165.85,-3388.63 6105.79,-3358.86 6090.74,-3351.4 6097.5,-3336.99 6082.79,-3328.86 6008.13,-3287.62 5771.09,-3279.1 5634.46,-3277.72"/>
<polygon fill="black" stroke="black" points="5634.42,-3274.22 5624.39,-3277.63 5634.36,-3281.22 5634.42,-3274.22"/>
<text text-anchor="middle" x="6151.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6151.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_4 -->
<g id="edge1265" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11357.05,-3395.88C11390.1,-3388.01 11424.85,-3381.06 11457.79,-3376.86 11483.59,-3373.58 15184.45,-3377.3 15202.79,-3358.86 15212.2,-3349.41 15211.85,-3338.65 15202.79,-3328.86 15165.44,-3288.52 14816.04,-3279.98 14640.48,-3278.25"/>
<polygon fill="black" stroke="black" points="14640.49,-3274.75 14630.46,-3278.16 14640.43,-3281.75 14640.49,-3274.75"/>
<text text-anchor="middle" x="15254.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="15254.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_5 -->
<g id="edge1266" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11357.41,-3395.91C11390.36,-3388.07 11424.97,-3381.12 11457.79,-3376.86 11484.25,-3373.43 13360.01,-3377.82 13378.79,-3358.86 13388.18,-3349.39 13387.85,-3338.65 13378.79,-3328.86 13341.44,-3288.52 12992.04,-3279.98 12816.48,-3278.25"/>
<polygon fill="black" stroke="black" points="12816.49,-3274.75 12806.46,-3278.16 12816.43,-3281.75 12816.49,-3274.75"/>
<text text-anchor="middle" x="13430.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13430.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_6 -->
<g id="edge1267" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11032.55,-3395.81C10999.49,-3387.95 10964.74,-3381.02 10931.79,-3376.86 10874.19,-3369.6 2623.83,-3384.61 2571.79,-3358.86 2556.73,-3351.41 2563.5,-3336.99 2548.79,-3328.86 2474.13,-3287.62 2237.09,-3279.1 2100.46,-3277.72"/>
<polygon fill="black" stroke="black" points="2100.42,-3274.22 2090.39,-3277.63 2100.36,-3281.22 2100.42,-3274.22"/>
<text text-anchor="middle" x="2617.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2617.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer3_gate_3_0&#45;&gt;layer3_expert1_7 -->
<g id="edge1268" class="edge">
<title>layer3_gate_3_0&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11364.33,-3399.6C11395.37,-3391.82 11427.52,-3383.95 11457.79,-3376.86 11494.97,-3368.16 11517.79,-3388.56 11541.79,-3358.86 11550.17,-3348.5 11550.84,-3338.65 11541.79,-3328.86 11505.33,-3289.43 11165.19,-3280.44 10992.45,-3278.42"/>
<polygon fill="black" stroke="black" points="10992.37,-3274.92 10982.33,-3278.31 10992.29,-3281.92 10992.37,-3274.92"/>
<text text-anchor="middle" x="11593.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11593.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_0 -->
<g id="edge1269" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8401.79,-3396.08C8368.94,-3388.25 8334.47,-3381.26 8301.79,-3376.86 8275.85,-3373.37 7378.23,-3377.43 7359.79,-3358.86 7350.16,-3349.16 7347.69,-3335.15 7348.35,-3321.5"/>
<polygon fill="black" stroke="black" points="7351.87,-3321.5 7349.39,-3311.2 7344.9,-3320.8 7351.87,-3321.5"/>
<text text-anchor="middle" x="7405.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7405.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→0</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_1 -->
<g id="edge1270" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8402.54,-3395.85C8369.48,-3387.99 8334.74,-3381.05 8301.79,-3376.86 8270.17,-3372.85 3734.43,-3381.31 3711.79,-3358.86 3701.91,-3349.06 3699.52,-3334.73 3700.3,-3320.84"/>
<polygon fill="black" stroke="black" points="3703.79,-3321.19 3701.37,-3310.87 3696.83,-3320.44 3703.79,-3321.19"/>
<text text-anchor="middle" x="3757.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3757.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→2</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_2 -->
<g id="edge1271" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8728.98,-3396.73C8761.49,-3388.92 8795.54,-3381.78 8827.79,-3376.86 8864.42,-3371.28 9135.31,-3385.76 9160.79,-3358.86 9174.38,-3344.53 9166.02,-3329.94 9149.84,-3317.16"/>
<polygon fill="black" stroke="black" points="9151.5,-3314.04 9141.33,-3311.05 9147.41,-3319.73 9151.5,-3314.04"/>
<text text-anchor="middle" x="9212.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9212.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→4</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_3 -->
<g id="edge1272" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8402.18,-3395.84C8369.23,-3388 8334.62,-3381.07 8301.79,-3376.86 8263.69,-3371.98 5563.04,-3385.95 5535.79,-3358.86 5526.1,-3349.22 5523.62,-3335.22 5524.28,-3321.57"/>
<polygon fill="black" stroke="black" points="5527.8,-3321.57 5525.33,-3311.27 5520.83,-3320.86 5527.8,-3321.57"/>
<text text-anchor="middle" x="5581.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5581.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→6</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_4 -->
<g id="edge1273" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8727.04,-3395.83C8760.1,-3387.97 8794.84,-3381.03 8827.79,-3376.86 8867.79,-3371.8 14604.33,-3387.41 14632.79,-3358.86 14647.06,-3344.55 14638.08,-3329.71 14621.15,-3316.71"/>
<polygon fill="black" stroke="black" points="14623.05,-3313.77 14612.86,-3310.87 14619.02,-3319.49 14623.05,-3313.77"/>
<text text-anchor="middle" x="14685.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14685.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→8</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_5 -->
<g id="edge1274" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8727.04,-3395.87C8760.1,-3388 8794.85,-3381.06 8827.79,-3376.86 8855.22,-3373.37 12789.29,-3378.46 12808.79,-3358.86 12822.98,-3344.61 12814.15,-3329.84 12797.36,-3316.87"/>
<polygon fill="black" stroke="black" points="12799.33,-3313.98 12789.15,-3311.05 12795.28,-3319.69 12799.33,-3313.98"/>
<text text-anchor="middle" x="12861.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12861.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→10</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_6 -->
<g id="edge1275" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8402.54,-3395.83C8369.49,-3387.96 8334.74,-3381.03 8301.79,-3376.86 8280.09,-3374.12 2017.33,-3374.26 2001.79,-3358.86 1991.9,-3349.07 1989.51,-3334.74 1990.3,-3320.85"/>
<polygon fill="black" stroke="black" points="1993.78,-3321.2 1991.37,-3310.88 1986.82,-3320.45 1993.78,-3321.2"/>
<text text-anchor="middle" x="2047.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2047.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→12</text>
</g>
<!-- layer3_gate_3_1&#45;&gt;layer3_expert1_7 -->
<g id="edge1276" class="edge">
<title>layer3_gate_3_1&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8727.41,-3395.89C8760.36,-3388.05 8794.97,-3381.1 8827.79,-3376.86 8857.5,-3373.03 10963.7,-3380.14 10984.79,-3358.86 10998.96,-3344.58 10990.12,-3329.8 10973.33,-3316.84"/>
<polygon fill="black" stroke="black" points="10975.3,-3313.95 10965.12,-3311.02 10971.25,-3319.66 10975.3,-3313.95"/>
<text text-anchor="middle" x="11037.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11037.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 13→14</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_0 -->
<g id="edge1277" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.42,-3396C5078.37,-3388.15 5112.98,-3381.18 5145.79,-3376.86 5184.16,-3371.82 6505.01,-3377.74 6538.79,-3358.86 6552.57,-3351.17 6544.21,-3336.91 6557.79,-3328.86 6616.71,-3293.95 7057.46,-3282.59 7258.89,-3279.19"/>
<polygon fill="black" stroke="black" points="7259.24,-3282.68 7269.18,-3279.02 7259.12,-3275.68 7259.24,-3282.68"/>
<text text-anchor="middle" x="6603.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6603.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_1 -->
<g id="edge1278" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4720.17,-3395.94C4687.22,-3388.1 4652.61,-3381.14 4619.79,-3376.86 4596.29,-3373.8 2930.46,-3375.71 2913.79,-3358.86 2904.41,-3349.39 2904.67,-3338.59 2913.79,-3328.86 2937.3,-3303.8 3402.39,-3286.97 3611.01,-3280.65"/>
<polygon fill="black" stroke="black" points="3611.16,-3284.15 3621.05,-3280.35 3610.95,-3277.15 3611.16,-3284.15"/>
<text text-anchor="middle" x="2959.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2959.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_2 -->
<g id="edge1279" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.4,-3395.81C5078.35,-3387.98 5112.96,-3381.06 5145.79,-3376.86 5190.11,-3371.2 8323.71,-3380.52 8362.79,-3358.86 8376.6,-3351.22 8368.26,-3336.98 8381.79,-3328.86 8430.87,-3299.43 8790.62,-3285.5 8969.03,-3280.34"/>
<polygon fill="black" stroke="black" points="8969.32,-3283.84 8979.21,-3280.05 8969.12,-3276.84 8969.32,-3283.84"/>
<text text-anchor="middle" x="8427.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8427.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_3 -->
<g id="edge1280" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4754.79,-3377.57C4740.1,-3362.22 4735.22,-3345.48 4750.79,-3328.86 4773.84,-3304.27 5228.69,-3287.25 5434.8,-3280.77"/>
<polygon fill="black" stroke="black" points="5435.14,-3284.26 5445.02,-3280.45 5434.92,-3277.27 5435.14,-3284.26"/>
<text text-anchor="middle" x="4796.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4796.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_4 -->
<g id="edge1281" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.04,-3395.81C5078.09,-3387.94 5112.84,-3381.02 5145.79,-3376.86 5205.66,-3369.32 13781.96,-3388.01 13834.79,-3358.86 13848.61,-3351.24 13840.26,-3336.98 13853.79,-3328.86 13902.87,-3299.43 14262.62,-3285.5 14441.03,-3280.34"/>
<polygon fill="black" stroke="black" points="14441.32,-3283.84 14451.21,-3280.05 14441.12,-3276.84 14441.32,-3283.84"/>
<text text-anchor="middle" x="13899.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13899.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_5 -->
<g id="edge1282" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.04,-3395.82C5078.09,-3387.96 5112.84,-3381.03 5145.79,-3376.86 5193.09,-3370.89 11969.06,-3381.9 12010.79,-3358.86 12024.61,-3351.24 12016.26,-3336.98 12029.79,-3328.86 12078.87,-3299.43 12438.62,-3285.5 12617.03,-3280.34"/>
<polygon fill="black" stroke="black" points="12617.32,-3283.84 12627.21,-3280.05 12617.12,-3276.84 12617.32,-3283.84"/>
<text text-anchor="middle" x="12075.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12075.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_6 -->
<g id="edge1283" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4720.54,-3395.89C4687.48,-3388.02 4652.74,-3381.07 4619.79,-3376.86 4596.26,-3373.86 1220.52,-3375.68 1203.79,-3358.86 1194.39,-3349.41 1194.67,-3338.59 1203.79,-3328.86 1227.3,-3303.8 1692.39,-3286.97 1901.01,-3280.65"/>
<polygon fill="black" stroke="black" points="1901.16,-3284.15 1911.05,-3280.35 1900.95,-3277.15 1901.16,-3284.15"/>
<text text-anchor="middle" x="1249.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1249.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer3_gate_3_2&#45;&gt;layer3_expert1_7 -->
<g id="edge1284" class="edge">
<title>layer3_gate_3_2&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.04,-3395.85C5078.1,-3387.98 5112.84,-3381.04 5145.79,-3376.86 5180.52,-3372.46 10156.15,-3375.8 10186.79,-3358.86 10200.6,-3351.23 10192.26,-3336.98 10205.79,-3328.86 10254.87,-3299.43 10614.62,-3285.5 10793.03,-3280.34"/>
<polygon fill="black" stroke="black" points="10793.32,-3283.84 10803.21,-3280.05 10793.12,-3276.84 10793.32,-3283.84"/>
<text text-anchor="middle" x="10251.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10251.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_0 -->
<g id="edge1285" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7875.38,-3396.38C7842.65,-3388.55 7808.32,-3381.49 7775.79,-3376.86 7746.62,-3372.72 7266.27,-3380.05 7245.79,-3358.86 7230.24,-3342.77 7240.77,-3327.71 7260.54,-3315.04"/>
<polygon fill="black" stroke="black" points="7262.36,-3318.04 7269.2,-3309.95 7258.8,-3312.01 7262.36,-3318.04"/>
<text text-anchor="middle" x="7291.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7291.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→0</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_1 -->
<g id="edge1286" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7876.54,-3395.86C7843.48,-3388 7808.74,-3381.05 7775.79,-3376.86 7747.01,-3373.2 3618.26,-3379.42 3597.79,-3358.86 3581.92,-3342.93 3592.57,-3327.86 3612.54,-3315.15"/>
<polygon fill="black" stroke="black" points="3614.42,-3318.1 3621.27,-3310.03 3610.88,-3312.06 3614.42,-3318.1"/>
<text text-anchor="middle" x="3643.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3643.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→2</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_2 -->
<g id="edge1287" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8201.82,-3396.21C8234.65,-3388.37 8269.12,-3381.35 8301.79,-3376.86 8342.81,-3371.23 9014.21,-3384.41 9046.79,-3358.86 9058.33,-3349.82 9064.19,-3335.38 9067.07,-3321.18"/>
<polygon fill="black" stroke="black" points="9070.58,-3321.38 9068.67,-3310.96 9063.66,-3320.3 9070.58,-3321.38"/>
<text text-anchor="middle" x="9110.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9110.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→4</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_3 -->
<g id="edge1288" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7876.18,-3395.87C7843.23,-3388.03 7808.61,-3381.09 7775.79,-3376.86 7743.36,-3372.69 5444.82,-3382.07 5421.79,-3358.86 5406.03,-3342.98 5416.51,-3327.97 5436.29,-3315.3"/>
<polygon fill="black" stroke="black" points="5438.11,-3318.28 5444.95,-3310.19 5434.56,-3312.25 5438.11,-3318.28"/>
<text text-anchor="middle" x="5467.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5467.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→6</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_4 -->
<g id="edge1289" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8201.04,-3395.83C8234.1,-3387.96 8268.84,-3381.03 8301.79,-3376.86 8344.62,-3371.45 14484.53,-3385.14 14518.79,-3358.86 14530.42,-3349.94 14536.31,-3335.53 14539.17,-3321.31"/>
<polygon fill="black" stroke="black" points="14542.68,-3321.5 14540.76,-3311.08 14535.77,-3320.42 14542.68,-3321.5"/>
<text text-anchor="middle" x="14582.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14582.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→8</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_5 -->
<g id="edge1290" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8201.04,-3395.86C8234.1,-3387.99 8268.84,-3381.05 8301.79,-3376.86 8332.06,-3373.02 12670.59,-3377.44 12694.79,-3358.86 12706.42,-3349.94 12712.3,-3335.52 12715.17,-3321.31"/>
<polygon fill="black" stroke="black" points="12718.68,-3321.49 12716.75,-3311.07 12711.76,-3320.42 12718.68,-3321.49"/>
<text text-anchor="middle" x="12758.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12758.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→10</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_6 -->
<g id="edge1291" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7876.54,-3395.83C7843.49,-3387.97 7808.74,-3381.03 7775.79,-3376.86 7735.23,-3371.73 1916.66,-3387.82 1887.79,-3358.86 1871.91,-3342.94 1882.56,-3327.88 1902.52,-3315.16"/>
<polygon fill="black" stroke="black" points="1904.4,-3318.11 1911.26,-3310.04 1900.87,-3312.07 1904.4,-3318.11"/>
<text text-anchor="middle" x="1933.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1933.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→12</text>
</g>
<!-- layer3_gate_3_3&#45;&gt;layer3_expert1_7 -->
<g id="edge1292" class="edge">
<title>layer3_gate_3_3&#45;&gt;layer3_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8201.4,-3395.85C8234.35,-3388.01 8268.97,-3381.08 8301.79,-3376.86 8337.18,-3372.32 10842.52,-3380.64 10870.79,-3358.86 10882.4,-3349.92 10888.29,-3335.5 10891.15,-3321.29"/>
<polygon fill="black" stroke="black" points="10894.66,-3321.48 10892.74,-3311.06 10887.75,-3320.4 10894.66,-3321.48"/>
<text text-anchor="middle" x="10934.29" y="-3347.66" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10934.29" y="-3332.66" font-family="Times,serif" font-size="14.00">GPU 15→14</text>
</g>
<!-- layer3_expert_gelu_0 -->
<g id="node487" class="node">
<title>layer3_expert_gelu_0</title>
<ellipse fill="lightgray" stroke="black" cx="7549.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7549.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="7549.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7549.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_expert1_0&#45;&gt;layer3_expert_gelu_0 -->
<g id="edge1293" class="edge">
<title>layer3_expert1_0&#45;&gt;layer3_expert_gelu_0</title>
<path fill="none" stroke="black" d="M7418.18,-3242.76C7438.68,-3231.33 7461.79,-3218.44 7482.86,-3206.7"/>
<polygon fill="black" stroke="black" points="7484.72,-3209.67 7491.75,-3201.74 7481.31,-3203.55 7484.72,-3209.67"/>
</g>
<!-- layer3_expert2_0 -->
<g id="node488" class="node">
<title>layer3_expert2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="7929.29,-3093.91 7744.29,-3093.91 7744.29,-3025.91 7929.29,-3025.91 7929.29,-3093.91"/>
<text text-anchor="middle" x="7836.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 0 Second Linear</text>
<text text-anchor="middle" x="7836.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7836.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7836.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_0&#45;&gt;layer3_expert2_0 -->
<g id="edge1294" class="edge">
<title>layer3_expert_gelu_0&#45;&gt;layer3_expert2_0</title>
<path fill="none" stroke="black" d="M7627.46,-3138.57C7661.52,-3125.94 7701.89,-3110.96 7738.06,-3097.54"/>
<polygon fill="black" stroke="black" points="7739.48,-3100.75 7747.64,-3093.99 7737.05,-3094.18 7739.48,-3100.75"/>
</g>
<!-- layer3_expert_agg_0_0 -->
<g id="node510" class="node">
<title>layer3_expert_agg_0_0</title>
<polygon fill="darkseagreen" stroke="black" points="3145.88,-2866.06 3145.88,-2918.71 3035.12,-2955.93 2878.47,-2955.93 2767.7,-2918.71 2767.7,-2866.06 2878.47,-2828.84 3035.12,-2828.84 3145.88,-2866.06"/>
<polygon fill="none" stroke="black" points="3149.88,-2863.19 3149.88,-2921.58 3035.77,-2959.94 2877.81,-2959.94 2763.7,-2921.58 2763.7,-2863.19 2877.81,-2824.83 3035.77,-2824.83 3149.88,-2863.19"/>
<text text-anchor="middle" x="2956.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2956.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="2956.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2956.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="2956.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1309" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.41C7741.28,-3026.85 7738.52,-3026.35 7735.79,-3025.91 7702.2,-3020.5 2859.81,-3032.02 2835.79,-3007.91 2819.18,-2991.24 2825.35,-2973.59 2841.51,-2957.28"/>
<polygon fill="black" stroke="black" points="2844.02,-2959.72 2849,-2950.37 2839.28,-2954.57 2844.02,-2959.72"/>
<text text-anchor="middle" x="2885.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2885.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer3_expert_agg_0_1 -->
<g id="node511" class="node">
<title>layer3_expert_agg_0_1</title>
<polygon fill="darkseagreen" stroke="black" points="8025.88,-2866.06 8025.88,-2918.71 7915.12,-2955.93 7758.47,-2955.93 7647.7,-2918.71 7647.7,-2866.06 7758.47,-2828.84 7915.12,-2828.84 8025.88,-2866.06"/>
<polygon fill="none" stroke="black" points="8029.88,-2863.19 8029.88,-2921.58 7915.77,-2959.94 7757.81,-2959.94 7643.7,-2921.58 7643.7,-2863.19 7757.81,-2824.83 7915.77,-2824.83 8029.88,-2863.19"/>
<text text-anchor="middle" x="7836.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7836.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="7836.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7836.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="7836.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1310" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.09,-3027.38C7730.78,-3021.09 7720.11,-3014.42 7715.79,-3007.91 7703.97,-2990.1 7709.06,-2973.03 7722.28,-2957.75"/>
<polygon fill="black" stroke="black" points="7724.95,-2960.02 7729.38,-2950.4 7719.92,-2955.16 7724.95,-2960.02"/>
<text text-anchor="middle" x="7765.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7765.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
</g>
<!-- layer3_expert_agg_0_2 -->
<g id="node512" class="node">
<title>layer3_expert_agg_0_2</title>
<polygon fill="darkseagreen" stroke="black" points="6073.88,-2866.06 6073.88,-2918.71 5963.12,-2955.93 5806.47,-2955.93 5695.7,-2918.71 5695.7,-2866.06 5806.47,-2828.84 5963.12,-2828.84 6073.88,-2866.06"/>
<polygon fill="none" stroke="black" points="6077.88,-2863.19 6077.88,-2921.58 5963.77,-2959.94 5805.81,-2959.94 5691.7,-2921.58 5691.7,-2863.19 5805.81,-2824.83 5963.77,-2824.83 6077.88,-2863.19"/>
<text text-anchor="middle" x="5884.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5884.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="5884.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5884.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5884.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1311" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.43C7741.28,-3026.87 7738.52,-3026.36 7735.79,-3025.91 7708.76,-3021.48 5783.07,-3027.37 5763.79,-3007.91 5747.22,-2991.19 5753.42,-2973.53 5769.57,-2957.21"/>
<polygon fill="black" stroke="black" points="5772.08,-2959.66 5777.07,-2950.31 5767.34,-2954.51 5772.08,-2959.66"/>
<text text-anchor="middle" x="5813.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5813.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer3_expert_agg_0_3 -->
<g id="node513" class="node">
<title>layer3_expert_agg_0_3</title>
<polygon fill="darkseagreen" stroke="black" points="10831.88,-2866.06 10831.88,-2918.71 10721.12,-2955.93 10564.47,-2955.93 10453.7,-2918.71 10453.7,-2866.06 10564.47,-2828.84 10721.12,-2828.84 10831.88,-2866.06"/>
<polygon fill="none" stroke="black" points="10835.88,-2863.19 10835.88,-2921.58 10721.77,-2959.94 10563.81,-2959.94 10449.7,-2921.58 10449.7,-2863.19 10563.81,-2824.83 10721.77,-2824.83 10835.88,-2863.19"/>
<text text-anchor="middle" x="10642.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10642.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="10642.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10642.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="10642.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1312" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.36,-3054.09C8077.45,-3046.59 8376.84,-3032.33 8630.79,-3025.91 8658.42,-3025.21 10599.56,-3025.61 10620.79,-3007.91 10627.49,-3002.33 10632.17,-2987.55 10635.43,-2970.38"/>
<polygon fill="black" stroke="black" points="10638.96,-2970.5 10637.19,-2960.06 10632.06,-2969.32 10638.96,-2970.5"/>
<text text-anchor="middle" x="10682.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10682.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→3</text>
</g>
<!-- layer3_expert_agg_1_0 -->
<g id="node514" class="node">
<title>layer3_expert_agg_1_0</title>
<polygon fill="darkseagreen" stroke="black" points="12783.88,-2866.06 12783.88,-2918.71 12673.12,-2955.93 12516.47,-2955.93 12405.7,-2918.71 12405.7,-2866.06 12516.47,-2828.84 12673.12,-2828.84 12783.88,-2866.06"/>
<polygon fill="none" stroke="black" points="12787.88,-2863.19 12787.88,-2921.58 12673.77,-2959.94 12515.81,-2959.94 12401.7,-2921.58 12401.7,-2863.19 12515.81,-2824.83 12673.77,-2824.83 12787.88,-2863.19"/>
<text text-anchor="middle" x="12594.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12594.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="12594.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12594.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="12594.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1313" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.36,-3053.95C8077.45,-3046.27 8376.83,-3031.77 8630.79,-3025.91 8658.16,-3025.28 12551.73,-3025.39 12572.79,-3007.91 12579.5,-3002.34 12584.18,-2987.57 12587.45,-2970.4"/>
<polygon fill="black" stroke="black" points="12590.98,-2970.52 12589.21,-2960.07 12584.08,-2969.34 12590.98,-2970.52"/>
<text text-anchor="middle" x="12634.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12634.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer3_expert_agg_1_1 -->
<g id="node515" class="node">
<title>layer3_expert_agg_1_1</title>
<polygon fill="darkseagreen" stroke="black" points="8879.88,-2866.06 8879.88,-2918.71 8769.12,-2955.93 8612.47,-2955.93 8501.7,-2918.71 8501.7,-2866.06 8612.47,-2828.84 8769.12,-2828.84 8879.88,-2866.06"/>
<polygon fill="none" stroke="black" points="8883.88,-2863.19 8883.88,-2921.58 8769.77,-2959.94 8611.81,-2959.94 8497.7,-2921.58 8497.7,-2863.19 8611.81,-2824.83 8769.77,-2824.83 8883.88,-2863.19"/>
<text text-anchor="middle" x="8690.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8690.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="8690.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8690.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8690.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1314" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.47,-3059.51C8134.81,-3059.96 8614.31,-3055.8 8668.79,-3007.91 8675.31,-3002.18 8679.92,-2987.46 8683.19,-2970.41"/>
<polygon fill="black" stroke="black" points="8686.71,-2970.59 8684.95,-2960.14 8679.81,-2969.4 8686.71,-2970.59"/>
<text text-anchor="middle" x="8730.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8730.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→5</text>
</g>
<!-- layer3_expert_agg_1_2 -->
<g id="node516" class="node">
<title>layer3_expert_agg_1_2</title>
<polygon fill="darkseagreen" stroke="black" points="4121.88,-2866.06 4121.88,-2918.71 4011.12,-2955.93 3854.47,-2955.93 3743.7,-2918.71 3743.7,-2866.06 3854.47,-2828.84 4011.12,-2828.84 4121.88,-2866.06"/>
<polygon fill="none" stroke="black" points="4125.88,-2863.19 4125.88,-2921.58 4011.77,-2959.94 3853.81,-2959.94 3739.7,-2921.58 3739.7,-2863.19 3853.81,-2824.83 4011.77,-2824.83 4125.88,-2863.19"/>
<text text-anchor="middle" x="3932.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3932.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="3932.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3932.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="3932.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1315" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.41C7741.28,-3026.85 7738.52,-3026.35 7735.79,-3025.91 7708.89,-3021.56 3831.02,-3027.22 3811.79,-3007.91 3795.19,-2991.23 3801.36,-2973.58 3817.52,-2957.27"/>
<polygon fill="black" stroke="black" points="3820.03,-2959.71 3825.01,-2950.36 3815.29,-2954.56 3820.03,-2959.71"/>
<text text-anchor="middle" x="3861.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3861.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer3_expert_agg_1_3 -->
<g id="node517" class="node">
<title>layer3_expert_agg_1_3</title>
<polygon fill="darkseagreen" stroke="black" points="15711.88,-2866.06 15711.88,-2918.71 15601.12,-2955.93 15444.47,-2955.93 15333.7,-2918.71 15333.7,-2866.06 15444.47,-2828.84 15601.12,-2828.84 15711.88,-2866.06"/>
<polygon fill="none" stroke="black" points="15715.88,-2863.19 15715.88,-2921.58 15601.77,-2959.94 15443.81,-2959.94 15329.7,-2921.58 15329.7,-2863.19 15443.81,-2824.83 15601.77,-2824.83 15715.88,-2863.19"/>
<text text-anchor="middle" x="15522.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15522.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="15522.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="15522.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="15522.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1316" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.35,-3053.89C8077.44,-3046.13 8376.82,-3031.52 8630.79,-3025.91 8654.64,-3025.38 15482.42,-3023.13 15500.79,-3007.91 15507.5,-3002.35 15512.19,-2987.57 15515.45,-2970.41"/>
<polygon fill="black" stroke="black" points="15518.98,-2970.53 15517.21,-2960.08 15512.08,-2969.35 15518.98,-2970.53"/>
<text text-anchor="middle" x="15562.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15562.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→7</text>
</g>
<!-- layer3_expert_agg_2_0 -->
<g id="node518" class="node">
<title>layer3_expert_agg_2_0</title>
<polygon fill="darkseagreen" stroke="black" points="13759.88,-2866.06 13759.88,-2918.71 13649.12,-2955.93 13492.47,-2955.93 13381.7,-2918.71 13381.7,-2866.06 13492.47,-2828.84 13649.12,-2828.84 13759.88,-2866.06"/>
<polygon fill="none" stroke="black" points="13763.88,-2863.19 13763.88,-2921.58 13649.77,-2959.94 13491.81,-2959.94 13377.7,-2921.58 13377.7,-2863.19 13491.81,-2824.83 13649.77,-2824.83 13763.88,-2863.19"/>
<text text-anchor="middle" x="13570.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13570.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="13570.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13570.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="13570.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1317" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.35,-3053.92C8077.44,-3046.2 8376.83,-3031.65 8630.79,-3025.91 8664.94,-3025.14 13522.5,-3029.71 13548.79,-3007.91 13555.5,-3002.35 13560.19,-2987.57 13563.45,-2970.41"/>
<polygon fill="black" stroke="black" points="13566.98,-2970.52 13565.21,-2960.08 13560.08,-2969.35 13566.98,-2970.52"/>
<text text-anchor="middle" x="13610.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13610.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer3_expert_agg_2_1 -->
<g id="node519" class="node">
<title>layer3_expert_agg_2_1</title>
<polygon fill="darkseagreen" stroke="black" points="11807.88,-2866.06 11807.88,-2918.71 11697.12,-2955.93 11540.47,-2955.93 11429.7,-2918.71 11429.7,-2866.06 11540.47,-2828.84 11697.12,-2828.84 11807.88,-2866.06"/>
<polygon fill="none" stroke="black" points="11811.88,-2863.19 11811.88,-2921.58 11697.77,-2959.94 11539.81,-2959.94 11425.7,-2921.58 11425.7,-2863.19 11539.81,-2824.83 11697.77,-2824.83 11811.88,-2863.19"/>
<text text-anchor="middle" x="11618.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11618.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="11618.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11618.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11618.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1318" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.36,-3054C8077.45,-3046.38 8376.83,-3031.96 8630.79,-3025.91 8651.38,-3025.42 11580.95,-3021.08 11596.79,-3007.91 11603.49,-3002.34 11608.18,-2987.56 11611.44,-2970.4"/>
<polygon fill="black" stroke="black" points="11614.97,-2970.51 11613.2,-2960.07 11608.07,-2969.34 11614.97,-2970.51"/>
<text text-anchor="middle" x="11658.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11658.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→9</text>
</g>
<!-- layer3_expert_agg_2_2 -->
<g id="node520" class="node">
<title>layer3_expert_agg_2_2</title>
<polygon fill="darkseagreen" stroke="black" points="7049.88,-2866.06 7049.88,-2918.71 6939.12,-2955.93 6782.47,-2955.93 6671.7,-2918.71 6671.7,-2866.06 6782.47,-2828.84 6939.12,-2828.84 7049.88,-2866.06"/>
<polygon fill="none" stroke="black" points="7053.88,-2863.19 7053.88,-2921.58 6939.77,-2959.94 6781.81,-2959.94 6667.7,-2921.58 6667.7,-2863.19 6781.81,-2824.83 6939.77,-2824.83 7053.88,-2863.19"/>
<text text-anchor="middle" x="6860.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6860.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="6860.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6860.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="6860.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1319" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.46C7741.28,-3026.89 7738.52,-3026.37 7735.79,-3025.91 7708.5,-3021.31 6759.18,-3027.65 6739.79,-3007.91 6723.39,-2991.21 6729.45,-2973.62 6745.42,-2957.37"/>
<polygon fill="black" stroke="black" points="6747.87,-2959.87 6752.83,-2950.5 6743.11,-2954.73 6747.87,-2959.87"/>
<text text-anchor="middle" x="6789.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6789.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer3_expert_agg_2_3 -->
<g id="node521" class="node">
<title>layer3_expert_agg_2_3</title>
<polygon fill="darkseagreen" stroke="black" points="9855.88,-2866.06 9855.88,-2918.71 9745.12,-2955.93 9588.47,-2955.93 9477.7,-2918.71 9477.7,-2866.06 9588.47,-2828.84 9745.12,-2828.84 9855.88,-2866.06"/>
<polygon fill="none" stroke="black" points="9859.88,-2863.19 9859.88,-2921.58 9745.77,-2959.94 9587.81,-2959.94 9473.7,-2921.58 9473.7,-2863.19 9587.81,-2824.83 9745.77,-2824.83 9859.88,-2863.19"/>
<text text-anchor="middle" x="9666.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9666.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="9666.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9666.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9666.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1320" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.37,-3054.35C8077.47,-3047.21 8376.87,-3033.44 8630.79,-3025.91 8658.95,-3025.08 9623.23,-3026.05 9644.79,-3007.91 9651.46,-3002.3 9656.13,-2987.51 9659.4,-2970.35"/>
<polygon fill="black" stroke="black" points="9662.93,-2970.46 9661.16,-2960.02 9656.03,-2969.29 9662.93,-2970.46"/>
<text text-anchor="middle" x="9706.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9706.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→11</text>
</g>
<!-- layer3_expert_agg_3_0 -->
<g id="node522" class="node">
<title>layer3_expert_agg_3_0</title>
<polygon fill="darkseagreen" stroke="black" points="2169.88,-2866.06 2169.88,-2918.71 2059.12,-2955.93 1902.47,-2955.93 1791.7,-2918.71 1791.7,-2866.06 1902.47,-2828.84 2059.12,-2828.84 2169.88,-2866.06"/>
<polygon fill="none" stroke="black" points="2173.88,-2863.19 2173.88,-2921.58 2059.77,-2959.94 1901.81,-2959.94 1787.7,-2921.58 1787.7,-2863.19 1901.81,-2824.83 2059.77,-2824.83 2173.88,-2863.19"/>
<text text-anchor="middle" x="1980.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1980.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="1980.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="1980.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="1980.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1321" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.41C7741.28,-3026.85 7738.52,-3026.35 7735.79,-3025.91 7695.5,-3019.43 1888.6,-3036.81 1859.79,-3007.91 1843.17,-2991.24 1849.35,-2973.6 1865.5,-2957.28"/>
<polygon fill="black" stroke="black" points="1868.01,-2959.73 1873,-2950.38 1863.27,-2954.58 1868.01,-2959.73"/>
<text text-anchor="middle" x="1909.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1909.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer3_expert_agg_3_1 -->
<g id="node523" class="node">
<title>layer3_expert_agg_3_1</title>
<polygon fill="darkseagreen" stroke="black" points="5097.88,-2866.06 5097.88,-2918.71 4987.12,-2955.93 4830.47,-2955.93 4719.7,-2918.71 4719.7,-2866.06 4830.47,-2828.84 4987.12,-2828.84 5097.88,-2866.06"/>
<polygon fill="none" stroke="black" points="5101.88,-2863.19 5101.88,-2921.58 4987.77,-2959.94 4829.81,-2959.94 4715.7,-2921.58 4715.7,-2863.19 4829.81,-2824.83 4987.77,-2824.83 5101.88,-2863.19"/>
<text text-anchor="middle" x="4908.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4908.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="4908.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4908.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="4908.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1322" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.42C7741.28,-3026.86 7738.52,-3026.35 7735.79,-3025.91 7695.38,-3019.35 4816.66,-3036.95 4787.79,-3007.91 4771.2,-2991.22 4777.38,-2973.56 4793.54,-2957.25"/>
<polygon fill="black" stroke="black" points="4796.05,-2959.69 4801.03,-2950.34 4791.31,-2954.54 4796.05,-2959.69"/>
<text text-anchor="middle" x="4837.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4837.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→13</text>
</g>
<!-- layer3_expert_agg_3_2 -->
<g id="node524" class="node">
<title>layer3_expert_agg_3_2</title>
<polygon fill="darkseagreen" stroke="black" points="1315.88,-2866.06 1315.88,-2918.71 1205.12,-2955.93 1048.47,-2955.93 937.7,-2918.71 937.7,-2866.06 1048.47,-2828.84 1205.12,-2828.84 1315.88,-2866.06"/>
<polygon fill="none" stroke="black" points="1319.88,-2863.19 1319.88,-2921.58 1205.77,-2959.94 1047.81,-2959.94 933.7,-2921.58 933.7,-2863.19 1047.81,-2824.83 1205.77,-2824.83 1319.88,-2863.19"/>
<text text-anchor="middle" x="1126.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1126.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="1126.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="1126.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="1126.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1323" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7744.05,-3027.4C7741.28,-3026.85 7738.52,-3026.35 7735.79,-3025.91 7712.72,-3022.21 1022.29,-3024.46 1005.79,-3007.91 989.17,-2991.24 995.34,-2973.6 1011.5,-2957.29"/>
<polygon fill="black" stroke="black" points="1014.01,-2959.73 1018.99,-2950.38 1009.27,-2954.58 1014.01,-2959.73"/>
<text text-anchor="middle" x="1055.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1055.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer3_expert_agg_3_3 -->
<g id="node525" class="node">
<title>layer3_expert_agg_3_3</title>
<polygon fill="darkseagreen" stroke="black" points="14735.88,-2866.06 14735.88,-2918.71 14625.12,-2955.93 14468.47,-2955.93 14357.7,-2918.71 14357.7,-2866.06 14468.47,-2828.84 14625.12,-2828.84 14735.88,-2866.06"/>
<polygon fill="none" stroke="black" points="14739.88,-2863.19 14739.88,-2921.58 14625.77,-2959.94 14467.81,-2959.94 14353.7,-2921.58 14353.7,-2863.19 14467.81,-2824.83 14625.77,-2824.83 14739.88,-2863.19"/>
<text text-anchor="middle" x="14546.79" y="-2918.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14546.79" y="-2903.69" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="14546.79" y="-2888.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14546.79" y="-2873.69" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14546.79" y="-2858.69" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer3_expert2_0&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1324" class="edge">
<title>layer3_expert2_0&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7929.35,-3053.91C8077.44,-3046.16 8376.82,-3031.57 8630.79,-3025.91 8651.25,-3025.45 14509.03,-3020.97 14524.79,-3007.91 14531.5,-3002.35 14536.19,-2987.57 14539.45,-2970.41"/>
<polygon fill="black" stroke="black" points="14542.98,-2970.53 14541.21,-2960.08 14536.08,-2969.35 14542.98,-2970.53"/>
<text text-anchor="middle" x="14586.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14586.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 0→15</text>
</g>
<!-- layer3_expert_gelu_1 -->
<g id="node490" class="node">
<title>layer3_expert_gelu_1</title>
<ellipse fill="lightgray" stroke="black" cx="5402.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="5402.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5402.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5402.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_expert1_1&#45;&gt;layer3_expert_gelu_1 -->
<g id="edge1295" class="edge">
<title>layer3_expert1_1&#45;&gt;layer3_expert_gelu_1</title>
<path fill="none" stroke="black" d="M3800.57,-3270.21C4080.34,-3252.61 4937.54,-3198.67 5269.52,-3177.77"/>
<polygon fill="black" stroke="black" points="5269.9,-3181.26 5279.66,-3177.14 5269.46,-3174.27 5269.9,-3181.26"/>
</g>
<!-- layer3_expert2_1 -->
<g id="node491" class="node">
<title>layer3_expert2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="7523.29,-3093.91 7338.29,-3093.91 7338.29,-3025.91 7523.29,-3025.91 7523.29,-3093.91"/>
<text text-anchor="middle" x="7430.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 1 Second Linear</text>
<text text-anchor="middle" x="7430.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7430.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="7430.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_1&#45;&gt;layer3_expert2_1 -->
<g id="edge1296" class="edge">
<title>layer3_expert_gelu_1&#45;&gt;layer3_expert2_1</title>
<path fill="none" stroke="black" d="M5528.43,-3163.56C5931.32,-3151.15 7173.34,-3111.89 7327.91,-3093.72"/>
<polygon fill="black" stroke="black" points="7328.62,-3097.15 7338.03,-3092.29 7327.64,-3090.22 7328.62,-3097.15"/>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1325" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.41C7335.28,-3026.85 7332.52,-3026.35 7329.79,-3025.91 7297.31,-3020.68 2615.01,-3031.22 2591.79,-3007.91 2527.29,-2943.16 2637.61,-2914.93 2753.43,-2902.67"/>
<polygon fill="black" stroke="black" points="2753.97,-2906.13 2763.57,-2901.64 2753.27,-2899.17 2753.97,-2906.13"/>
<text text-anchor="middle" x="2641.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2641.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1326" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7450.47,-3025.72C7461.98,-3009.03 7477.95,-2989.86 7496.79,-2977.91 7537.87,-2951.85 7586.48,-2933.82 7633.89,-2921.35"/>
<polygon fill="black" stroke="black" points="7634.85,-2924.71 7643.67,-2918.85 7633.12,-2917.93 7634.85,-2924.71"/>
<text text-anchor="middle" x="7546.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7546.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→1</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1327" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.43C7335.28,-3026.87 7332.52,-3026.36 7329.79,-3025.91 7304.98,-3021.83 5537.48,-3025.78 5519.79,-3007.91 5455.49,-2942.96 5565.79,-2914.75 5681.56,-2902.54"/>
<polygon fill="black" stroke="black" points="5682.1,-2906 5691.69,-2901.51 5681.39,-2899.04 5682.1,-2906"/>
<text text-anchor="middle" x="5569.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5569.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1328" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.64C7526.51,-3027 7529.67,-3026.41 7532.79,-3025.91 7571.79,-3019.63 10342.25,-3027.07 10376.79,-3007.91 10390.59,-3000.26 10383.4,-2987.69 10395.79,-2977.91 10417.83,-2960.52 10443.67,-2946.6 10470.18,-2935.48"/>
<polygon fill="black" stroke="black" points="10471.63,-2938.67 10479.57,-2931.67 10468.99,-2932.18 10471.63,-2938.67"/>
<text text-anchor="middle" x="10445.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10445.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1329" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.63C7526.51,-3026.99 7529.67,-3026.41 7532.79,-3025.91 7598.57,-3015.41 12270.49,-3040.14 12328.79,-3007.91 12342.6,-3000.28 12335.4,-2987.69 12347.79,-2977.91 12369.83,-2960.52 12395.67,-2946.6 12422.18,-2935.48"/>
<polygon fill="black" stroke="black" points="12423.63,-2938.67 12431.57,-2931.67 12420.99,-2932.18 12423.63,-2938.67"/>
<text text-anchor="middle" x="12397.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12397.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1330" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.34,-3027.7C7526.52,-3027.04 7529.67,-3026.44 7532.79,-3025.91 7581.67,-3017.69 8381.61,-3032.25 8424.79,-3007.91 8438.54,-3000.16 8431.4,-2987.69 8443.79,-2977.91 8465.83,-2960.52 8491.67,-2946.6 8518.18,-2935.48"/>
<polygon fill="black" stroke="black" points="8519.63,-2938.67 8527.57,-2931.67 8516.99,-2932.18 8519.63,-2938.67"/>
<text text-anchor="middle" x="8493.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8493.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→5</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1331" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.41C7335.28,-3026.86 7332.52,-3026.35 7329.79,-3025.91 7304,-3021.74 3586.22,-3026.43 3567.79,-3007.91 3503.32,-2943.13 3613.63,-2914.9 3729.45,-2902.65"/>
<polygon fill="black" stroke="black" points="3729.99,-2906.11 3739.59,-2901.62 3729.29,-2899.15 3729.99,-2906.11"/>
<text text-anchor="middle" x="3617.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3617.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1332" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.63C7526.51,-3026.98 7529.67,-3026.41 7532.79,-3025.91 7585.77,-3017.49 15209.83,-3033.83 15256.79,-3007.91 15270.61,-3000.28 15263.4,-2987.69 15275.79,-2977.91 15297.83,-2960.52 15323.67,-2946.6 15350.18,-2935.48"/>
<polygon fill="black" stroke="black" points="15351.63,-2938.67 15359.57,-2931.67 15348.99,-2932.18 15351.63,-2938.67"/>
<text text-anchor="middle" x="15325.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15325.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→7</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1333" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.63C7526.51,-3026.99 7529.67,-3026.41 7532.79,-3025.91 7572.38,-3019.6 13269.7,-3027.29 13304.79,-3007.91 13318.61,-3000.28 13311.4,-2987.69 13323.79,-2977.91 13345.83,-2960.52 13371.67,-2946.6 13398.18,-2935.48"/>
<polygon fill="black" stroke="black" points="13399.63,-2938.67 13407.57,-2931.67 13396.99,-2932.18 13399.63,-2938.67"/>
<text text-anchor="middle" x="13373.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13373.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1334" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.64C7526.51,-3026.99 7529.67,-3026.41 7532.79,-3025.91 7585.18,-3017.52 11306.37,-3033.6 11352.79,-3007.91 11366.6,-3000.27 11359.4,-2987.69 11371.79,-2977.91 11393.83,-2960.52 11419.67,-2946.6 11446.18,-2935.48"/>
<polygon fill="black" stroke="black" points="11447.63,-2938.67 11455.57,-2931.67 11444.99,-2932.18 11447.63,-2938.67"/>
<text text-anchor="middle" x="11421.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11421.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→9</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1335" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.04,-3027.47C7335.27,-3026.9 7332.52,-3026.38 7329.79,-3025.91 7306.95,-3022.02 6512,-3024.47 6495.79,-3007.91 6431.92,-2942.65 6541.95,-2914.45 6657.5,-2902.33"/>
<polygon fill="black" stroke="black" points="6658.01,-2905.8 6667.61,-2901.31 6657.31,-2898.83 6658.01,-2905.8"/>
<text text-anchor="middle" x="6545.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6545.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1336" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.34,-3027.66C7526.51,-3027 7529.67,-3026.42 7532.79,-3025.91 7584.01,-3017.58 9355.45,-3033.15 9400.79,-3007.91 9414.58,-3000.23 9407.4,-2987.69 9419.79,-2977.91 9441.83,-2960.52 9467.67,-2946.6 9494.18,-2935.48"/>
<polygon fill="black" stroke="black" points="9495.63,-2938.67 9503.57,-2931.67 9492.99,-2932.18 9495.63,-2938.67"/>
<text text-anchor="middle" x="9469.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9469.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→11</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1337" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.41C7335.28,-3026.85 7332.52,-3026.35 7329.79,-3025.91 7290.61,-3019.61 1643.81,-3036.01 1615.79,-3007.91 1551.27,-2943.18 1661.59,-2914.95 1777.42,-2902.68"/>
<polygon fill="black" stroke="black" points="1777.96,-2906.14 1787.56,-2901.65 1777.25,-2899.18 1777.96,-2906.14"/>
<text text-anchor="middle" x="1665.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1665.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1338" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.42C7335.28,-3026.86 7332.52,-3026.35 7329.79,-3025.91 7291.6,-3019.7 4571.06,-3035.36 4543.79,-3007.91 4479.37,-2943.08 4589.69,-2914.85 4705.49,-2902.61"/>
<polygon fill="black" stroke="black" points="4706.03,-2906.08 4715.62,-2901.58 4705.32,-2899.11 4706.03,-2906.08"/>
<text text-anchor="middle" x="4593.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4593.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→13</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1339" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7338.05,-3027.4C7335.28,-3026.85 7332.52,-3026.35 7329.79,-3025.91 7307.27,-3022.29 777.9,-3024.06 761.79,-3007.91 697.25,-2943.2 807.57,-2914.96 923.41,-2902.69"/>
<polygon fill="black" stroke="black" points="923.95,-2906.15 933.55,-2901.66 923.24,-2899.19 923.95,-2906.15"/>
<text text-anchor="middle" x="811.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="811.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer3_expert2_1&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1340" class="edge">
<title>layer3_expert2_1&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7523.33,-3027.63C7526.51,-3026.98 7529.67,-3026.41 7532.79,-3025.91 7579.07,-3018.55 14239.77,-3030.56 14280.79,-3007.91 14294.61,-3000.28 14287.4,-2987.69 14299.79,-2977.91 14321.83,-2960.52 14347.67,-2946.6 14374.18,-2935.48"/>
<polygon fill="black" stroke="black" points="14375.63,-2938.67 14383.57,-2931.67 14372.99,-2932.18 14375.63,-2938.67"/>
<text text-anchor="middle" x="14349.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14349.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 2→15</text>
</g>
<!-- layer3_expert_gelu_2 -->
<g id="node493" class="node">
<title>layer3_expert_gelu_2</title>
<ellipse fill="lightgray" stroke="black" cx="9044.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="9044.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="9044.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9044.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_expert1_2&#45;&gt;layer3_expert_gelu_2 -->
<g id="edge1297" class="edge">
<title>layer3_expert1_2&#45;&gt;layer3_expert_gelu_2</title>
<path fill="none" stroke="black" d="M9061.33,-3242.76C9059.39,-3234.15 9057.26,-3224.72 9055.2,-3215.57"/>
<polygon fill="black" stroke="black" points="9058.61,-3214.79 9053,-3205.81 9051.79,-3216.33 9058.61,-3214.79"/>
</g>
<!-- layer3_expert2_2 -->
<g id="node494" class="node">
<title>layer3_expert2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="8824.29,-3093.91 8639.29,-3093.91 8639.29,-3025.91 8824.29,-3025.91 8824.29,-3093.91"/>
<text text-anchor="middle" x="8731.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 2 Second Linear</text>
<text text-anchor="middle" x="8731.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8731.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8731.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_2&#45;&gt;layer3_expert2_2 -->
<g id="edge1298" class="edge">
<title>layer3_expert_gelu_2&#45;&gt;layer3_expert2_2</title>
<path fill="none" stroke="black" d="M8963.37,-3139.69C8923.88,-3126.26 8876.03,-3109.98 8834.1,-3095.72"/>
<polygon fill="black" stroke="black" points="8835.01,-3092.33 8824.42,-3092.42 8832.76,-3098.96 8835.01,-3092.33"/>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1341" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3053.91C8491.04,-3046.18 8192.27,-3031.64 7938.79,-3025.91 7921.5,-3025.52 2970.05,-3020.11 2957.79,-3007.91 2947.7,-2997.87 2943.17,-2984.48 2941.89,-2970.41"/>
<polygon fill="black" stroke="black" points="2945.37,-2969.93 2941.5,-2960.07 2938.38,-2970.2 2945.37,-2969.93"/>
<text text-anchor="middle" x="3007.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3007.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1342" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.06,-3055.28C8413.1,-3046.21 7851.49,-3022.29 7837.79,-3007.91 7828.02,-2997.66 7823.61,-2984.25 7822.33,-2970.23"/>
<polygon fill="black" stroke="black" points="7825.82,-2969.8 7821.92,-2959.95 7818.83,-2970.08 7825.82,-2969.8"/>
<text text-anchor="middle" x="7887.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7887.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→1</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1343" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3054.06C8491.03,-3046.55 8192.25,-3032.29 7938.79,-3025.91 7910.29,-3025.19 5905.95,-3028.07 5885.79,-3007.91 5875.72,-2997.84 5871.21,-2984.44 5869.93,-2970.37"/>
<polygon fill="black" stroke="black" points="5873.41,-2969.89 5869.54,-2960.03 5866.42,-2970.16 5873.41,-2969.89"/>
<text text-anchor="middle" x="5935.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5935.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1344" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.34,-3027.66C8827.51,-3027 8830.67,-3026.42 8833.79,-3025.91 8859.96,-3021.66 10724.13,-3026.75 10742.79,-3007.91 10756.71,-2993.86 10753.91,-2978.22 10742.99,-2963.13"/>
<polygon fill="black" stroke="black" points="10745.63,-2960.82 10736.59,-2955.3 10740.21,-2965.25 10745.63,-2960.82"/>
<text text-anchor="middle" x="10801.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10801.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→3</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1345" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.33,-3027.64C8827.51,-3026.99 8830.67,-3026.41 8833.79,-3025.91 8860.27,-3021.67 12675.88,-3026.91 12694.79,-3007.91 12708.82,-2993.81 12705.93,-2978.09 12694.86,-2962.92"/>
<polygon fill="black" stroke="black" points="12697.43,-2960.54 12688.37,-2955.05 12692.03,-2964.99 12697.43,-2960.54"/>
<text text-anchor="middle" x="12753.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12753.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1346" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8778.62,-3025.87C8783.53,-3020.45 8787.81,-3014.44 8790.79,-3007.91 8796.34,-2995.79 8796.4,-2990 8790.79,-2977.91 8788.83,-2973.68 8786.54,-2969.58 8783.98,-2965.63"/>
<polygon fill="black" stroke="black" points="8786.64,-2963.32 8777.99,-2957.19 8780.93,-2967.37 8786.64,-2963.32"/>
<text text-anchor="middle" x="8844.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8844.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→5</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1347" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3053.93C8491.03,-3046.24 8192.26,-3031.75 7938.79,-3025.91 7910.99,-3025.27 3953.5,-3027.54 3933.79,-3007.91 3923.7,-2997.86 3919.18,-2984.47 3917.9,-2970.4"/>
<polygon fill="black" stroke="black" points="3921.38,-2969.93 3917.5,-2960.07 3914.39,-2970.19 3921.38,-2969.93"/>
<text text-anchor="middle" x="3983.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3983.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1348" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.33,-3027.63C8827.51,-3026.98 8830.67,-3026.41 8833.79,-3025.91 8857.07,-3022.21 15606.14,-3024.6 15622.79,-3007.91 15636.84,-2993.83 15633.95,-2978.11 15622.88,-2962.94"/>
<polygon fill="black" stroke="black" points="15625.45,-2960.56 15616.39,-2955.07 15620.05,-2965.01 15625.45,-2960.56"/>
<text text-anchor="middle" x="15681.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15681.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→7</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1349" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.33,-3027.63C8827.51,-3026.99 8830.67,-3026.41 8833.79,-3025.91 8866.96,-3020.62 13647.08,-3031.71 13670.79,-3007.91 13684.83,-2993.82 13681.94,-2978.1 13670.87,-2962.93"/>
<polygon fill="black" stroke="black" points="13673.44,-2960.55 13664.38,-2955.06 13668.04,-2965 13673.44,-2960.55"/>
<text text-anchor="middle" x="13729.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13729.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1350" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.33,-3027.64C8827.51,-3026.99 8830.67,-3026.41 8833.79,-3025.91 8873.35,-3019.54 11690.55,-3036.33 11718.79,-3007.91 11732.73,-2993.88 11729.95,-2978.25 11719.03,-2963.16"/>
<polygon fill="black" stroke="black" points="11721.66,-2960.85 11712.62,-2955.33 11716.24,-2965.29 11721.66,-2960.85"/>
<text text-anchor="middle" x="11777.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11777.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→9</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1351" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.03,-3054.3C8491.01,-3047.12 8192.22,-3033.3 7938.79,-3025.91 7908.88,-3025.04 6882.86,-3029.15 6861.79,-3007.91 6851.76,-2997.8 6847.27,-2984.39 6845.99,-2970.3"/>
<polygon fill="black" stroke="black" points="6849.48,-2969.83 6845.6,-2959.97 6842.48,-2970.1 6849.48,-2969.83"/>
<text text-anchor="middle" x="6911.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6911.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1352" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.34,-3027.7C8827.51,-3027.03 8830.67,-3026.43 8833.79,-3025.91 8859.36,-3021.62 9748.64,-3026.42 9766.79,-3007.91 9780.64,-2993.79 9777.82,-2978.12 9766.89,-2963.02"/>
<polygon fill="black" stroke="black" points="9769.52,-2960.72 9760.48,-2955.19 9764.1,-2965.15 9769.52,-2960.72"/>
<text text-anchor="middle" x="9825.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9825.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→11</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1353" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3053.89C8491.04,-3046.14 8192.27,-3031.57 7938.79,-3025.91 7918.11,-3025.45 1996.46,-3022.49 1981.79,-3007.91 1971.69,-2997.87 1967.17,-2984.48 1965.89,-2970.41"/>
<polygon fill="black" stroke="black" points="1969.37,-2969.94 1965.49,-2960.08 1962.38,-2970.21 1969.37,-2969.94"/>
<text text-anchor="middle" x="2031.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2031.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1354" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3053.98C8491.03,-3046.35 8192.26,-3031.94 7938.79,-3025.91 7917.76,-3025.41 4924.69,-3022.76 4909.79,-3007.91 4899.71,-2997.86 4895.19,-2984.46 4893.91,-2970.39"/>
<polygon fill="black" stroke="black" points="4897.39,-2969.92 4893.52,-2960.06 4890.4,-2970.18 4897.39,-2969.92"/>
<text text-anchor="middle" x="4959.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4959.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→13</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1355" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8639.04,-3053.88C8491.04,-3046.11 8192.27,-3031.52 7938.79,-3025.91 7915.15,-3025.39 1144.56,-3024.58 1127.79,-3007.91 1117.69,-2997.87 1113.16,-2984.49 1111.88,-2970.41"/>
<polygon fill="black" stroke="black" points="1115.37,-2969.94 1111.49,-2960.08 1108.37,-2970.21 1115.37,-2969.94"/>
<text text-anchor="middle" x="1177.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1177.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer3_expert2_2&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1356" class="edge">
<title>layer3_expert2_2&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8824.33,-3027.63C8827.51,-3026.99 8830.67,-3026.41 8833.79,-3025.91 8873.66,-3019.56 14618.29,-3036.5 14646.79,-3007.91 14660.84,-2993.82 14657.94,-2978.1 14646.87,-2962.94"/>
<polygon fill="black" stroke="black" points="14649.45,-2960.55 14640.38,-2955.07 14644.04,-2965.01 14649.45,-2960.55"/>
<text text-anchor="middle" x="14705.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14705.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 4→15</text>
</g>
<!-- layer3_expert_gelu_3 -->
<g id="node496" class="node">
<title>layer3_expert_gelu_3</title>
<ellipse fill="lightgray" stroke="black" cx="6742.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6742.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6742.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6742.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_expert1_3&#45;&gt;layer3_expert_gelu_3 -->
<g id="edge1299" class="edge">
<title>layer3_expert1_3&#45;&gt;layer3_expert_gelu_3</title>
<path fill="none" stroke="black" d="M5624.6,-3267.95C5835.88,-3249.33 6365.11,-3202.68 6612.07,-3180.91"/>
<polygon fill="black" stroke="black" points="6612.52,-3184.38 6622.17,-3180.02 6611.9,-3177.41 6612.52,-3184.38"/>
</g>
<!-- layer3_expert2_3 -->
<g id="node497" class="node">
<title>layer3_expert2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7726.29,-3093.91 7541.29,-3093.91 7541.29,-3025.91 7726.29,-3025.91 7726.29,-3093.91"/>
<text text-anchor="middle" x="7633.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 3 Second Linear</text>
<text text-anchor="middle" x="7633.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7633.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7633.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_3&#45;&gt;layer3_expert2_3 -->
<g id="edge1300" class="edge">
<title>layer3_expert_gelu_3&#45;&gt;layer3_expert2_3</title>
<path fill="none" stroke="black" d="M6868.92,-3164.31C7023.79,-3158.58 7294.12,-3142.25 7531.42,-3094.05"/>
<polygon fill="black" stroke="black" points="7532.18,-3097.47 7541.27,-3092.03 7530.77,-3090.61 7532.18,-3097.47"/>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1357" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.41C7538.28,-3026.85 7535.52,-3026.35 7532.79,-3025.91 7499.75,-3020.59 2737.41,-3031.62 2713.79,-3007.91 2679.09,-2973.08 2714.18,-2947.51 2767.46,-2929.49"/>
<polygon fill="black" stroke="black" points="2768.8,-2932.73 2777.24,-2926.33 2766.65,-2926.07 2768.8,-2932.73"/>
<text text-anchor="middle" x="2763.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2763.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1358" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7609.17,-3025.82C7600.81,-3010.32 7595.82,-2992.18 7605.79,-2977.91 7618.74,-2959.39 7636.2,-2944.91 7655.76,-2933.6"/>
<polygon fill="black" stroke="black" points="7657.48,-2936.65 7664.58,-2928.78 7654.13,-2930.51 7657.48,-2936.65"/>
<text text-anchor="middle" x="7655.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7655.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→1</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1359" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.43C7538.28,-3026.87 7535.52,-3026.36 7532.79,-3025.91 7506.87,-3021.66 5660.27,-3026.57 5641.79,-3007.91 5607.19,-2972.98 5642.3,-2947.4 5695.56,-2929.39"/>
<polygon fill="black" stroke="black" points="5696.9,-2932.63 5705.34,-2926.22 5694.75,-2925.97 5696.9,-2932.63"/>
<text text-anchor="middle" x="5691.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5691.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1360" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.64C7729.51,-3027 7732.67,-3026.41 7735.79,-3025.91 7773.68,-3019.81 10465.23,-3026.52 10498.79,-3007.91 10512.59,-3000.26 10506.8,-2989.24 10517.79,-2977.91 10523.69,-2971.83 10530.1,-2965.94 10536.79,-2960.28"/>
<polygon fill="black" stroke="black" points="10539.24,-2962.8 10544.75,-2953.75 10534.8,-2957.38 10539.24,-2962.8"/>
<text text-anchor="middle" x="10567.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10567.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→3</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1361" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.63C7729.51,-3026.99 7732.67,-3026.41 7735.79,-3025.91 7800.46,-3015.58 12393.48,-3039.59 12450.79,-3007.91 12464.6,-3000.27 12458.8,-2989.24 12469.79,-2977.91 12475.69,-2971.83 12482.1,-2965.94 12488.79,-2960.28"/>
<polygon fill="black" stroke="black" points="12491.24,-2962.8 12496.75,-2953.75 12486.8,-2957.38 12491.24,-2962.8"/>
<text text-anchor="middle" x="12519.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12519.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1362" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.34,-3027.71C7729.52,-3027.04 7732.67,-3026.44 7735.79,-3025.91 7780.23,-3018.4 8507.55,-3030.08 8546.79,-3007.91 8560.53,-3000.15 8554.8,-2989.24 8565.79,-2977.91 8571.69,-2971.83 8578.1,-2965.94 8584.79,-2960.28"/>
<polygon fill="black" stroke="black" points="8587.24,-2962.8 8592.75,-2953.75 8582.8,-2957.38 8587.24,-2962.8"/>
<text text-anchor="middle" x="8615.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8615.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→5</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1363" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.41C7538.28,-3026.86 7535.52,-3026.35 7532.79,-3025.91 7506.45,-3021.65 3708.62,-3026.83 3689.79,-3007.91 3655.11,-2973.06 3690.2,-2947.5 3743.48,-2929.47"/>
<polygon fill="black" stroke="black" points="3744.82,-2932.72 3753.26,-2926.31 3742.67,-2926.06 3744.82,-2932.72"/>
<text text-anchor="middle" x="3739.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3739.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1364" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.63C7729.51,-3026.98 7732.67,-3026.41 7735.79,-3025.91 7788.21,-3017.58 15332.32,-3033.56 15378.79,-3007.91 15392.61,-3000.28 15386.8,-2989.24 15397.79,-2977.91 15403.69,-2971.83 15410.1,-2965.94 15416.79,-2960.28"/>
<polygon fill="black" stroke="black" points="15419.24,-2962.8 15424.75,-2953.75 15414.8,-2957.38 15419.24,-2962.8"/>
<text text-anchor="middle" x="15447.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15447.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→7</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1365" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.63C7729.51,-3026.99 7732.67,-3026.41 7735.79,-3025.91 7774.82,-3019.69 13392.2,-3027.02 13426.79,-3007.91 13440.61,-3000.28 13434.8,-2989.24 13445.79,-2977.91 13451.69,-2971.83 13458.1,-2965.94 13464.79,-2960.28"/>
<polygon fill="black" stroke="black" points="13467.24,-2962.8 13472.75,-2953.75 13462.8,-2957.38 13467.24,-2962.8"/>
<text text-anchor="middle" x="13495.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13495.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1366" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.64C7729.51,-3026.99 7732.67,-3026.41 7735.79,-3025.91 7787.07,-3017.7 11429.36,-3033.06 11474.79,-3007.91 11488.6,-3000.27 11482.8,-2989.24 11493.79,-2977.91 11499.69,-2971.83 11506.1,-2965.94 11512.79,-2960.28"/>
<polygon fill="black" stroke="black" points="11515.24,-2962.8 11520.75,-2953.75 11510.8,-2957.38 11515.24,-2962.8"/>
<text text-anchor="middle" x="11543.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11543.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→9</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1367" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.04,-3027.47C7538.27,-3026.89 7535.52,-3026.37 7532.79,-3025.91 7507.73,-3021.67 6635.59,-3026.06 6617.79,-3007.91 6583.45,-2972.88 6618.35,-2947.31 6671.39,-2929.33"/>
<polygon fill="black" stroke="black" points="6672.7,-2932.58 6681.13,-2926.17 6670.54,-2925.92 6672.7,-2932.58"/>
<text text-anchor="middle" x="6667.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6667.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1368" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.34,-3027.66C7729.51,-3027.01 7732.67,-3026.42 7735.79,-3025.91 7784.79,-3017.93 9479.42,-3032.06 9522.79,-3007.91 9536.58,-3000.23 9530.8,-2989.24 9541.79,-2977.91 9547.69,-2971.83 9554.1,-2965.94 9560.79,-2960.28"/>
<polygon fill="black" stroke="black" points="9563.24,-2962.8 9568.75,-2953.75 9558.8,-2957.38 9563.24,-2962.8"/>
<text text-anchor="middle" x="9591.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9591.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→11</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1369" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.41C7538.28,-3026.85 7535.52,-3026.35 7532.79,-3025.91 7493.06,-3019.52 1766.2,-3036.41 1737.79,-3007.91 1703.08,-2973.09 1738.16,-2947.53 1791.45,-2929.5"/>
<polygon fill="black" stroke="black" points="1792.79,-2932.74 1801.23,-2926.34 1790.64,-2926.08 1792.79,-2932.74"/>
<text text-anchor="middle" x="1787.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1787.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1370" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.42C7538.28,-3026.86 7535.52,-3026.35 7532.79,-3025.91 7493.49,-3019.53 4693.86,-3036.16 4665.79,-3007.91 4631.13,-2973.04 4666.23,-2947.46 4719.5,-2929.44"/>
<polygon fill="black" stroke="black" points="4720.85,-2932.69 4729.29,-2926.28 4718.69,-2926.03 4720.85,-2932.69"/>
<text text-anchor="middle" x="4715.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4715.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→13</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1371" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7541.05,-3027.4C7538.28,-3026.85 7535.52,-3026.35 7532.79,-3025.91 7510,-3022.25 900.09,-3024.26 883.79,-3007.91 849.07,-2973.1 884.16,-2947.54 937.44,-2929.51"/>
<polygon fill="black" stroke="black" points="938.79,-2932.75 947.22,-2926.34 936.63,-2926.09 938.79,-2932.75"/>
<text text-anchor="middle" x="933.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="933.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer3_expert2_3&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1372" class="edge">
<title>layer3_expert2_3&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7726.33,-3027.63C7729.51,-3026.98 7732.67,-3026.41 7735.79,-3025.91 7781.51,-3018.63 14362.26,-3030.29 14402.79,-3007.91 14416.61,-3000.28 14410.8,-2989.24 14421.79,-2977.91 14427.69,-2971.83 14434.1,-2965.94 14440.79,-2960.28"/>
<polygon fill="black" stroke="black" points="14443.24,-2962.8 14448.75,-2953.75 14438.8,-2957.38 14443.24,-2962.8"/>
<text text-anchor="middle" x="14471.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14471.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 6→15</text>
</g>
<!-- layer3_expert_gelu_4 -->
<g id="node499" class="node">
<title>layer3_expert_gelu_4</title>
<ellipse fill="lightgray" stroke="black" cx="12039.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="12039.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="12039.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12039.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert1_4&#45;&gt;layer3_expert_gelu_4 -->
<g id="edge1301" class="edge">
<title>layer3_expert1_4&#45;&gt;layer3_expert_gelu_4</title>
<path fill="none" stroke="black" d="M14451.04,-3272.04C14075.15,-3256.04 12626.08,-3194.35 12174.78,-3175.13"/>
<polygon fill="black" stroke="black" points="12174.77,-3171.63 12164.63,-3174.7 12174.47,-3178.62 12174.77,-3171.63"/>
</g>
<!-- layer3_expert2_4 -->
<g id="node500" class="node">
<title>layer3_expert2_4</title>
<polygon fill="lightsteelblue" stroke="black" points="10247.29,-3093.91 10062.29,-3093.91 10062.29,-3025.91 10247.29,-3025.91 10247.29,-3093.91"/>
<text text-anchor="middle" x="10154.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 4 Second Linear</text>
<text text-anchor="middle" x="10154.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10154.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10154.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_4&#45;&gt;layer3_expert2_4 -->
<g id="edge1302" class="edge">
<title>layer3_expert_gelu_4&#45;&gt;layer3_expert2_4</title>
<path fill="none" stroke="black" d="M11916.64,-3159.69C11795.17,-3152.15 11604.2,-3140.44 11438.79,-3130.91 10999.45,-3105.6 10475.41,-3077.77 10257.59,-3066.3"/>
<polygon fill="black" stroke="black" points="10257.62,-3062.8 10247.45,-3065.77 10257.25,-3069.79 10257.62,-3062.8"/>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1373" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.58C9897.16,-3047.08 9540.76,-3031.89 9239.79,-3025.91 9171.37,-3024.55 4377.09,-3031.32 4312.79,-3007.91 4293.22,-3000.78 4296.26,-2985.32 4276.79,-2977.91 4220.07,-2956.31 3791.38,-2963.51 3730.79,-2959.91 3536.97,-2948.39 3316.37,-2928.79 3160.4,-2913.84"/>
<polygon fill="black" stroke="black" points="3160.51,-2910.33 3150.22,-2912.86 3159.84,-2917.3 3160.51,-2910.33"/>
<text text-anchor="middle" x="4362.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4362.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1374" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.02,-3058.45C9833.52,-3056.7 9256.52,-3048.3 9179.79,-3007.91 9164.92,-3000.09 9171.76,-2985.55 9156.79,-2977.91 9123.72,-2961.04 8525.84,-2962.3 8488.79,-2959.91 8338.15,-2950.21 8168.54,-2932.7 8040.07,-2918.07"/>
<polygon fill="black" stroke="black" points="8040.45,-2914.59 8030.12,-2916.94 8039.66,-2921.55 8040.45,-2914.59"/>
<text text-anchor="middle" x="9229.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9229.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→1</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1375" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.74C9897.15,-3047.49 9540.74,-3032.68 9239.79,-3025.91 9211.8,-3025.28 7248.26,-3021.52 7223.79,-3007.91 7210,-3000.24 7218.49,-2985.75 7204.79,-2977.91 7178.45,-2962.84 6689.09,-2961.71 6658.79,-2959.91 6464.97,-2948.39 6244.37,-2928.79 6088.4,-2913.84"/>
<polygon fill="black" stroke="black" points="6088.51,-2910.33 6078.22,-2912.86 6087.84,-2917.3 6088.51,-2910.33"/>
<text text-anchor="middle" x="7273.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7273.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1376" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.45,-3058.2C10628,-3055.08 12052.38,-3041.19 12084.79,-3007.91 12094.09,-2998.36 12094.09,-2987.46 12084.79,-2977.91 12071.84,-2964.61 11435.32,-2960.96 11416.79,-2959.91 11222.93,-2948.98 11002.34,-2929.3 10846.38,-2914.18"/>
<polygon fill="black" stroke="black" points="10846.49,-2910.67 10836.2,-2913.19 10845.82,-2917.64 10846.49,-2910.67"/>
<text text-anchor="middle" x="12140.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12140.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→3</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1377" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.47,-3058.58C10833.59,-3056.35 14002.42,-3042.74 14036.79,-3007.91 14046.16,-2998.42 14046.09,-2987.46 14036.79,-2977.91 14023.84,-2964.61 13387.32,-2960.96 13368.79,-2959.91 13174.93,-2948.98 12954.34,-2929.3 12798.38,-2914.18"/>
<polygon fill="black" stroke="black" points="12798.49,-2910.67 12788.2,-2913.19 12797.82,-2917.64 12798.49,-2910.67"/>
<text text-anchor="middle" x="14092.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14092.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1378" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10153.36,-3025.72C10150.75,-3008.61 10144.44,-2989.03 10129.79,-2977.91 10100.35,-2955.57 9501.69,-2961.99 9464.79,-2959.91 9270.94,-2948.97 9050.34,-2929.29 8894.38,-2914.17"/>
<polygon fill="black" stroke="black" points="8894.49,-2910.66 8884.2,-2913.18 8893.82,-2917.63 8894.49,-2910.66"/>
<text text-anchor="middle" x="10198.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10198.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→5</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1379" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.61C9897.16,-3047.15 9540.75,-3032.02 9239.79,-3025.91 9184.93,-3024.8 5340.35,-3026.71 5288.79,-3007.91 5269.22,-3000.78 5272.26,-2985.32 5252.79,-2977.91 5196.07,-2956.31 4767.38,-2963.51 4706.79,-2959.91 4512.97,-2948.39 4292.37,-2928.79 4136.4,-2913.84"/>
<polygon fill="black" stroke="black" points="4136.51,-2910.33 4126.22,-2912.86 4135.84,-2917.3 4136.51,-2910.33"/>
<text text-anchor="middle" x="5338.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5338.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1380" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.56,-3059.01C10997.71,-3059.68 16044.99,-3062.18 16098.79,-3007.91 16156.53,-2949.67 15914.25,-2919.4 15726.21,-2904.95"/>
<polygon fill="black" stroke="black" points="15726.4,-2901.45 15716.17,-2904.19 15725.88,-2908.43 15726.4,-2901.45"/>
<text text-anchor="middle" x="16156.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16156.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→7</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1381" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.42,-3058.83C10915.21,-3058.1 14969.24,-3051.92 15012.79,-3007.91 15022.17,-2998.43 15022.09,-2987.46 15012.79,-2977.91 14999.84,-2964.61 14363.32,-2960.96 14344.79,-2959.91 14150.93,-2948.98 13930.34,-2929.3 13774.38,-2914.18"/>
<polygon fill="black" stroke="black" points="13774.49,-2910.67 13764.2,-2913.19 13773.82,-2917.64 13774.49,-2910.67"/>
<text text-anchor="middle" x="15069.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15069.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1382" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.65,-3059.05C10738.48,-3059.58 13010.33,-3059.27 13060.79,-3007.91 13070.14,-2998.4 13070.09,-2987.46 13060.79,-2977.91 13047.84,-2964.61 12411.32,-2960.96 12392.79,-2959.91 12198.93,-2948.98 11978.34,-2929.3 11822.38,-2914.18"/>
<polygon fill="black" stroke="black" points="11822.49,-2910.67 11812.2,-2913.19 11821.82,-2917.64 11822.49,-2910.67"/>
<text text-anchor="middle" x="13116.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13116.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→9</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1383" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.27,-3055C9897.13,-3048.15 9540.71,-3033.94 9239.79,-3025.91 9210.91,-3025.14 8224.98,-3022.06 8199.79,-3007.91 8186.03,-3000.18 8194.49,-2985.75 8180.79,-2977.91 8154.45,-2962.84 7665.09,-2961.71 7634.79,-2959.91 7440.97,-2948.39 7220.37,-2928.79 7064.4,-2913.84"/>
<polygon fill="black" stroke="black" points="7064.51,-2910.33 7054.22,-2912.86 7063.84,-2917.3 7064.51,-2910.33"/>
<text text-anchor="middle" x="8249.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8249.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1384" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.67,-3057.36C10481.76,-3052.99 11079.46,-3038.85 11108.79,-3007.91 11117.96,-2998.23 11118.09,-2987.46 11108.79,-2977.91 11095.84,-2964.61 10459.32,-2960.96 10440.79,-2959.91 10246.93,-2948.98 10026.34,-2929.3 9870.38,-2914.18"/>
<polygon fill="black" stroke="black" points="9870.49,-2910.67 9860.2,-2913.19 9869.82,-2917.64 9870.49,-2910.67"/>
<text text-anchor="middle" x="11164.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11164.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→11</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1385" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.56C9897.16,-3047.03 9540.76,-3031.8 9239.79,-3025.91 9198.81,-3025.11 3375.31,-3021.92 3336.79,-3007.91 3317.22,-3000.79 3320.26,-2985.32 3300.79,-2977.91 3244.07,-2956.31 2815.38,-2963.51 2754.79,-2959.91 2560.97,-2948.39 2340.37,-2928.79 2184.4,-2913.84"/>
<polygon fill="black" stroke="black" points="2184.51,-2910.33 2174.22,-2912.86 2183.84,-2917.3 2184.51,-2910.33"/>
<text text-anchor="middle" x="3386.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3386.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1386" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.66C9897.15,-3047.27 9540.75,-3032.25 9239.79,-3025.91 9198.47,-3025.04 6302.51,-3022.37 6263.79,-3007.91 6244.6,-3000.74 6247.89,-2985.33 6228.79,-2977.91 6172.22,-2955.92 5743.38,-2963.51 5682.79,-2959.91 5488.97,-2948.39 5268.37,-2928.79 5112.4,-2913.84"/>
<polygon fill="black" stroke="black" points="5112.51,-2910.33 5102.22,-2912.86 5111.84,-2917.3 5112.51,-2910.33"/>
<text text-anchor="middle" x="6313.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6313.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→13</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1387" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10062.28,-3054.55C9897.16,-3047 9540.76,-3031.73 9239.79,-3025.91 9192.03,-3024.99 2405.69,-3024.23 2360.79,-3007.91 2341.22,-3000.79 2344.26,-2985.32 2324.79,-2977.91 2268.07,-2956.31 1839.35,-2963.99 1778.79,-2959.91 1628.18,-2949.76 1458.57,-2932.26 1330.09,-2917.76"/>
<polygon fill="black" stroke="black" points="1330.47,-2914.28 1320.14,-2916.63 1329.68,-2921.23 1330.47,-2914.28"/>
<text text-anchor="middle" x="2410.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2410.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer3_expert2_4&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1388" class="edge">
<title>layer3_expert2_4&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10247.31,-3058.99C10988.64,-3059.53 15936.02,-3061.14 15988.79,-3007.91 15998.18,-2998.44 15998.09,-2987.46 15988.79,-2977.91 15975.84,-2964.61 15339.32,-2960.96 15320.79,-2959.91 15126.93,-2948.98 14906.34,-2929.3 14750.38,-2914.18"/>
<polygon fill="black" stroke="black" points="14750.49,-2910.67 14740.2,-2913.19 14749.82,-2917.64 14750.49,-2910.67"/>
<text text-anchor="middle" x="16045.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="16045.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 8→15</text>
</g>
<!-- layer3_expert_gelu_5 -->
<g id="node502" class="node">
<title>layer3_expert_gelu_5</title>
<ellipse fill="lightgray" stroke="black" cx="11302.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="11302.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="11302.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11302.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert1_5&#45;&gt;layer3_expert_gelu_5 -->
<g id="edge1303" class="edge">
<title>layer3_expert1_5&#45;&gt;layer3_expert_gelu_5</title>
<path fill="none" stroke="black" d="M12627.27,-3269.12C12385.82,-3250.94 11720.31,-3200.83 11435.22,-3179.36"/>
<polygon fill="black" stroke="black" points="11435.07,-3175.84 11424.83,-3178.58 11434.54,-3182.82 11435.07,-3175.84"/>
</g>
<!-- layer3_expert2_5 -->
<g id="node503" class="node">
<title>layer3_expert2_5</title>
<polygon fill="lightsteelblue" stroke="black" points="9230.29,-3093.91 9045.29,-3093.91 9045.29,-3025.91 9230.29,-3025.91 9230.29,-3093.91"/>
<text text-anchor="middle" x="9137.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 5 Second Linear</text>
<text text-anchor="middle" x="9137.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9137.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9137.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_5&#45;&gt;layer3_expert2_5 -->
<g id="edge1304" class="edge">
<title>layer3_expert_gelu_5&#45;&gt;layer3_expert2_5</title>
<path fill="none" stroke="black" d="M11178.22,-3161.26C10788.66,-3142.1 9598.21,-3083.55 9240.5,-3065.96"/>
<polygon fill="black" stroke="black" points="9240.58,-3062.46 9230.42,-3065.47 9240.23,-3069.45 9240.58,-3062.46"/>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1389" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.41C9042.28,-3026.85 9039.52,-3026.35 9036.79,-3025.91 8996.78,-3019.48 3238.1,-3025.9 3201.79,-3007.91 3186.74,-3000.45 3192.26,-2987.95 3178.79,-2977.91 3159.39,-2963.46 3137.22,-2951.19 3114.57,-2940.86"/>
<polygon fill="black" stroke="black" points="3115.75,-2937.56 3105.19,-2936.71 3112.91,-2943.96 3115.75,-2937.56"/>
<text text-anchor="middle" x="3251.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3251.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1390" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.46C9042.28,-3026.89 9039.52,-3026.37 9036.79,-3025.91 8984.47,-3017.07 8129.16,-3031.84 8081.79,-3007.91 8066.8,-3000.33 8072.26,-2987.95 8058.79,-2977.91 8039.39,-2963.46 8017.22,-2951.19 7994.57,-2940.86"/>
<polygon fill="black" stroke="black" points="7995.75,-2937.56 7985.19,-2936.71 7992.91,-2943.96 7995.75,-2937.56"/>
<text text-anchor="middle" x="8131.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8131.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→1</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1391" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.42C9042.28,-3026.86 9039.52,-3026.35 9036.79,-3025.91 8996.94,-3019.44 6165.94,-3025.89 6129.79,-3007.91 6114.75,-3000.43 6120.26,-2987.95 6106.79,-2977.91 6087.39,-2963.46 6065.22,-2951.19 6042.57,-2940.86"/>
<polygon fill="black" stroke="black" points="6043.75,-2937.56 6033.19,-2936.71 6040.91,-2943.96 6043.75,-2937.56"/>
<text text-anchor="middle" x="6179.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6179.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1392" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.41,-3055.06C9395.74,-3048.31 9752.55,-3034.24 10053.79,-3025.91 10079.7,-3025.19 10968.64,-3026.42 10986.79,-3007.91 11045.24,-2948.33 10950.85,-2919.74 10846.27,-2906.03"/>
<polygon fill="black" stroke="black" points="10846.48,-2902.53 10836.12,-2904.75 10845.61,-2909.47 10846.48,-2902.53"/>
<text text-anchor="middle" x="11052.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11052.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→3</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1393" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.41,-3054.66C9395.71,-3047.28 9752.5,-3032.28 10053.79,-3025.91 10073.82,-3025.49 12924.67,-3022.12 12938.79,-3007.91 12997.68,-2948.66 12903.05,-2920.06 12798.25,-2906.26"/>
<polygon fill="black" stroke="black" points="12798.45,-2902.75 12788.08,-2904.97 12797.56,-2909.7 12798.45,-2902.75"/>
<text text-anchor="middle" x="13004.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13004.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1394" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9083.87,-3025.72C9075.04,-3019.95 9066.08,-3013.88 9057.79,-3007.91 9040.62,-2995.53 9039.7,-2987.42 9020.79,-2977.91 8978.12,-2956.45 8929.54,-2940.12 8883.01,-2927.81"/>
<polygon fill="black" stroke="black" points="8883.68,-2924.37 8873.12,-2925.25 8881.92,-2931.15 8883.68,-2924.37"/>
<text text-anchor="middle" x="9107.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9107.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→5</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1395" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.41C9042.28,-3026.85 9039.52,-3026.35 9036.79,-3025.91 8970.16,-3015.18 4238.26,-3037.88 4177.79,-3007.91 4162.74,-3000.45 4168.26,-2987.95 4154.79,-2977.91 4135.39,-2963.46 4113.22,-2951.19 4090.57,-2940.86"/>
<polygon fill="black" stroke="black" points="4091.75,-2937.56 4081.19,-2936.71 4088.91,-2943.96 4091.75,-2937.56"/>
<text text-anchor="middle" x="4227.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4227.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1396" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.4,-3054.57C9395.71,-3047.04 9752.49,-3031.8 10053.79,-3025.91 10073.97,-3025.52 15852.54,-3022.2 15866.79,-3007.91 15925.83,-2948.69 15830.97,-2920.1 15726.03,-2906.28"/>
<polygon fill="black" stroke="black" points="15726.21,-2902.78 15715.85,-2904.99 15725.33,-2909.72 15726.21,-2902.78"/>
<text text-anchor="middle" x="15932.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15932.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→7</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1397" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.4,-3054.61C9395.71,-3047.16 9752.5,-3032.04 10053.79,-3025.91 10080.6,-3025.37 13895.88,-3026.91 13914.79,-3007.91 13973.73,-2948.7 13879.09,-2920.1 13774.29,-2906.29"/>
<polygon fill="black" stroke="black" points="13774.48,-2902.79 13764.12,-2905 13773.6,-2909.73 13774.48,-2902.79"/>
<text text-anchor="middle" x="13980.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13980.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1398" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.41,-3054.76C9395.72,-3047.53 9752.51,-3032.76 10053.79,-3025.91 10080.3,-3025.31 11944.13,-3026.75 11962.79,-3007.91 12021.58,-2948.56 11926.96,-2919.97 11822.19,-2906.19"/>
<polygon fill="black" stroke="black" points="11822.38,-2902.69 11812.02,-2904.9 11821.5,-2909.63 11822.38,-2902.69"/>
<text text-anchor="middle" x="12028.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12028.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→9</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1399" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.43C9042.28,-3026.87 9039.52,-3026.36 9036.79,-3025.91 8983.86,-3017.23 7153.78,-3031.87 7105.79,-3007.91 7090.76,-3000.41 7096.26,-2987.95 7082.79,-2977.91 7063.39,-2963.46 7041.22,-2951.19 7018.57,-2940.86"/>
<polygon fill="black" stroke="black" points="7019.75,-2937.56 7009.19,-2936.71 7016.91,-2943.96 7019.75,-2937.56"/>
<text text-anchor="middle" x="7155.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7155.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1400" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.34,-3056.88C9449.59,-3051.62 9984.32,-3035.97 10010.79,-3007.91 10067.96,-2947.31 9974.06,-2918.76 9870.02,-2905.31"/>
<polygon fill="black" stroke="black" points="9870.28,-2901.82 9859.93,-2904.06 9869.42,-2908.77 9870.28,-2901.82"/>
<text text-anchor="middle" x="10076.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10076.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→11</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1401" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.4C9042.28,-3026.85 9039.52,-3026.35 9036.79,-3025.91 8990.09,-3018.41 2268.18,-3028.9 2225.79,-3007.91 2210.73,-3000.46 2216.26,-2987.95 2202.79,-2977.91 2183.39,-2963.46 2161.22,-2951.19 2138.57,-2940.86"/>
<polygon fill="black" stroke="black" points="2139.75,-2937.56 2129.19,-2936.71 2136.91,-2943.96 2139.75,-2937.56"/>
<text text-anchor="middle" x="2275.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2275.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1402" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.41C9042.28,-3026.86 9039.52,-3026.35 9036.79,-3025.91 8983.55,-3017.31 5202.1,-3031.89 5153.79,-3007.91 5138.74,-3000.44 5144.26,-2987.95 5130.79,-2977.91 5111.39,-2963.46 5089.22,-2951.19 5066.57,-2940.86"/>
<polygon fill="black" stroke="black" points="5067.75,-2937.56 5057.19,-2936.71 5064.91,-2943.96 5067.75,-2937.56"/>
<text text-anchor="middle" x="5203.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5203.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→13</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1403" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9045.05,-3027.4C9042.28,-3026.85 9039.52,-3026.35 9036.79,-3025.91 8931.86,-3009.08 1484.68,-3044.21 1384.79,-3007.91 1365.22,-3000.8 1366.77,-2988.43 1348.79,-2977.91 1326.54,-2964.89 1301.91,-2953.19 1277.41,-2942.94"/>
<polygon fill="black" stroke="black" points="1278.6,-2939.65 1268.02,-2939.09 1275.94,-2946.13 1278.6,-2939.65"/>
<text text-anchor="middle" x="1434.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1434.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer3_expert2_5&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1404" class="edge">
<title>layer3_expert2_5&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9230.4,-3054.58C9395.71,-3047.08 9752.5,-3031.9 10053.79,-3025.91 10070.58,-3025.58 14878.94,-3019.81 14890.79,-3007.91 14949.81,-2948.68 14854.95,-2920.08 14750.02,-2906.27"/>
<polygon fill="black" stroke="black" points="14750.2,-2902.77 14739.84,-2904.98 14749.32,-2909.71 14750.2,-2902.77"/>
<text text-anchor="middle" x="14956.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14956.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 10→15</text>
</g>
<!-- layer3_expert_gelu_6 -->
<g id="node505" class="node">
<title>layer3_expert_gelu_6</title>
<ellipse fill="lightgray" stroke="black" cx="4551.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="4551.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="4551.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4551.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert1_6&#45;&gt;layer3_expert_gelu_6 -->
<g id="edge1305" class="edge">
<title>layer3_expert1_6&#45;&gt;layer3_expert_gelu_6</title>
<path fill="none" stroke="black" d="M2090.46,-3272.12C2471.56,-3256.21 3958.23,-3194.16 4416.53,-3175.03"/>
<polygon fill="black" stroke="black" points="4416.99,-3178.52 4426.83,-3174.6 4416.69,-3171.52 4416.99,-3178.52"/>
</g>
<!-- layer3_expert2_6 -->
<g id="node506" class="node">
<title>layer3_expert2_6</title>
<polygon fill="lightsteelblue" stroke="black" points="7320.29,-3093.91 7135.29,-3093.91 7135.29,-3025.91 7320.29,-3025.91 7320.29,-3093.91"/>
<text text-anchor="middle" x="7227.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 6 Second Linear</text>
<text text-anchor="middle" x="7227.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7227.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="7227.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_6&#45;&gt;layer3_expert2_6 -->
<g id="edge1306" class="edge">
<title>layer3_expert_gelu_6&#45;&gt;layer3_expert2_6</title>
<path fill="none" stroke="black" d="M4675.77,-3160.49C4818.33,-3152.68 5059.42,-3139.9 5266.79,-3130.91 5977.35,-3100.11 6833.18,-3072.99 7124.75,-3064.03"/>
<polygon fill="black" stroke="black" points="7125,-3067.53 7134.89,-3063.72 7124.78,-3060.53 7125,-3067.53"/>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1405" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135.24,-3058.8C6475.64,-3057.94 2512.4,-3050.98 2469.79,-3007.91 2460.41,-2998.43 2461.21,-2988.11 2469.79,-2977.91 2506.56,-2934.21 2636.78,-2913.1 2753.31,-2902.9"/>
<polygon fill="black" stroke="black" points="2753.8,-2906.38 2763.46,-2902.04 2753.2,-2899.4 2753.8,-2906.38"/>
<text text-anchor="middle" x="2519.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2519.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1406" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7297.15,-3025.81C7307.32,-3020.21 7317.49,-3014.17 7326.79,-3007.91 7343.79,-2996.48 7343.28,-2986.68 7361.79,-2977.91 7445.98,-2938.03 7546.66,-2916.85 7633.63,-2905.65"/>
<polygon fill="black" stroke="black" points="7634.13,-2909.11 7643.62,-2904.4 7633.26,-2902.17 7634.13,-2909.11"/>
<text text-anchor="middle" x="7411.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7411.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→1</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1407" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135,-3058.06C6766.94,-3054.49 5428.36,-3039.35 5397.79,-3007.91 5388.5,-2998.35 5389.21,-2988.11 5397.79,-2977.91 5434.56,-2934.21 5564.78,-2913.1 5681.31,-2902.9"/>
<polygon fill="black" stroke="black" points="5681.8,-2906.38 5691.46,-2902.04 5681.2,-2899.4 5681.8,-2906.38"/>
<text text-anchor="middle" x="5447.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5447.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1408" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.64C7323.51,-3026.99 7326.67,-3026.41 7329.79,-3025.91 7369.86,-3019.46 10215.65,-3026.37 10251.79,-3007.91 10266.52,-3000.39 10259.98,-2986.99 10273.79,-2977.91 10322.85,-2945.66 10382.6,-2925.62 10439.61,-2913.2"/>
<polygon fill="black" stroke="black" points="10440.41,-2916.61 10449.47,-2911.12 10438.97,-2909.76 10440.41,-2916.61"/>
<text text-anchor="middle" x="10323.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10323.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→3</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1409" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.63C7323.51,-3026.99 7326.67,-3026.41 7329.79,-3025.91 7396.5,-3015.26 12131.02,-3032.87 12193.79,-3007.91 12211.91,-3000.71 12208.58,-2987.07 12225.79,-2977.91 12276.55,-2950.89 12335.72,-2932.47 12391.62,-2919.92"/>
<polygon fill="black" stroke="black" points="12392.63,-2923.28 12401.65,-2917.72 12391.13,-2916.44 12392.63,-2923.28"/>
<text text-anchor="middle" x="12275.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12275.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1410" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.34,-3027.69C7323.51,-3027.03 7326.67,-3026.43 7329.79,-3025.91 7383.12,-3016.99 8255.67,-3034.42 8302.79,-3007.91 8316.55,-3000.17 8308.91,-2987.03 8321.79,-2977.91 8370.1,-2943.73 8430.08,-2923.14 8487.53,-2910.81"/>
<polygon fill="black" stroke="black" points="8488.4,-2914.2 8497.48,-2908.75 8486.98,-2907.35 8488.4,-2914.2"/>
<text text-anchor="middle" x="8371.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8371.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→5</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1411" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135.18,-3058.54C6558.18,-3056.15 3479.23,-3041.8 3445.79,-3007.91 3436.43,-2998.42 3437.21,-2988.11 3445.79,-2977.91 3482.56,-2934.21 3612.78,-2913.1 3729.31,-2902.9"/>
<polygon fill="black" stroke="black" points="3729.8,-2906.38 3739.46,-2902.04 3729.2,-2899.4 3729.8,-2906.38"/>
<text text-anchor="middle" x="3495.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3495.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1412" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.63C7323.51,-3026.98 7326.67,-3026.41 7329.79,-3025.91 7383.24,-3017.42 15072.65,-3028.27 15122.79,-3007.91 15140.56,-3000.7 15136.94,-2987.05 15153.79,-2977.91 15204.34,-2950.49 15263.44,-2931.94 15319.34,-2919.4"/>
<polygon fill="black" stroke="black" points="15320.35,-2922.76 15329.37,-2917.2 15318.85,-2915.92 15320.35,-2922.76"/>
<text text-anchor="middle" x="15203.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15203.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→7</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1413" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.63C7323.51,-3026.99 7326.67,-3026.41 7329.79,-3025.91 7409.89,-3013.15 13094.41,-3037.85 13169.79,-3007.91 13187.91,-3000.71 13184.58,-2987.07 13201.79,-2977.91 13252.55,-2950.89 13311.72,-2932.47 13367.62,-2919.92"/>
<polygon fill="black" stroke="black" points="13368.63,-2923.28 13377.65,-2917.72 13367.13,-2916.44 13368.63,-2923.28"/>
<text text-anchor="middle" x="13251.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13251.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1414" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.64C7323.51,-3026.99 7326.67,-3026.41 7329.79,-3025.91 7383.11,-3017.37 11167.62,-3027.88 11217.79,-3007.91 11235.9,-3000.7 11232.58,-2987.07 11249.79,-2977.91 11300.55,-2950.89 11359.72,-2932.47 11415.62,-2919.92"/>
<polygon fill="black" stroke="black" points="11416.63,-2923.28 11425.65,-2917.72 11415.13,-2916.44 11416.63,-2923.28"/>
<text text-anchor="middle" x="11299.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11299.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→9</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1415" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135.26,-3056.76C6919.56,-3051.28 6399.59,-3035.29 6373.79,-3007.91 6364.65,-2998.21 6365.21,-2988.11 6373.79,-2977.91 6410.56,-2934.21 6540.78,-2913.1 6657.31,-2902.9"/>
<polygon fill="black" stroke="black" points="6657.8,-2906.38 6667.46,-2902.04 6657.2,-2899.4 6657.8,-2906.38"/>
<text text-anchor="middle" x="6423.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6423.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1416" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.34,-3027.65C7323.51,-3027 7326.67,-3026.42 7329.79,-3025.91 7383.23,-3017.23 9231.48,-3034.23 9278.79,-3007.91 9292.58,-3000.24 9284.91,-2987.03 9297.79,-2977.91 9346.1,-2943.73 9406.08,-2923.14 9463.53,-2910.81"/>
<polygon fill="black" stroke="black" points="9464.4,-2914.2 9473.48,-2908.75 9462.98,-2907.35 9464.4,-2914.2"/>
<text text-anchor="middle" x="9347.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9347.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→11</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1417" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135.12,-3058.98C6400.54,-3059.4 1545.61,-3060.19 1493.79,-3007.91 1484.41,-2998.44 1485.21,-2988.11 1493.79,-2977.91 1530.56,-2934.21 1660.78,-2913.1 1777.31,-2902.9"/>
<polygon fill="black" stroke="black" points="1777.8,-2906.38 1787.46,-2902.04 1777.2,-2899.4 1777.8,-2906.38"/>
<text text-anchor="middle" x="1543.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1543.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1418" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7134.99,-3058.99C6654.59,-3059.2 4470.4,-3057.41 4421.79,-3007.91 4412.45,-2998.4 4413.21,-2988.11 4421.79,-2977.91 4458.56,-2934.21 4588.78,-2913.1 4705.31,-2902.9"/>
<polygon fill="black" stroke="black" points="4705.8,-2906.38 4715.46,-2902.04 4705.2,-2899.4 4705.8,-2906.38"/>
<text text-anchor="middle" x="4471.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4471.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→13</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1419" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7135.11,-3058.64C6338.14,-3056.24 669.75,-3038.1 639.79,-3007.91 630.4,-2998.45 631.21,-2988.11 639.79,-2977.91 676.56,-2934.21 806.78,-2913.1 923.31,-2902.9"/>
<polygon fill="black" stroke="black" points="923.8,-2906.38 933.46,-2902.04 923.2,-2899.4 923.8,-2906.38"/>
<text text-anchor="middle" x="689.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="689.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer3_expert2_6&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1420" class="edge">
<title>layer3_expert2_6&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7320.33,-3027.63C7323.51,-3026.98 7326.67,-3026.41 7329.79,-3025.91 7423.28,-3011.04 14057.8,-3042.84 14145.79,-3007.91 14163.91,-3000.72 14160.58,-2987.07 14177.79,-2977.91 14228.55,-2950.89 14287.72,-2932.47 14343.62,-2919.92"/>
<polygon fill="black" stroke="black" points="14344.63,-2923.28 14353.65,-2917.72 14343.13,-2916.44 14344.63,-2923.28"/>
<text text-anchor="middle" x="14227.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14227.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 12→15</text>
</g>
<!-- layer3_expert_gelu_7 -->
<g id="node508" class="node">
<title>layer3_expert_gelu_7</title>
<ellipse fill="lightgray" stroke="black" cx="10219.79" cy="-3168.39" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="10219.79" y="-3179.69" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="10219.79" y="-3164.69" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10219.79" y="-3149.69" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert1_7&#45;&gt;layer3_expert_gelu_7 -->
<g id="edge1307" class="edge">
<title>layer3_expert1_7&#45;&gt;layer3_expert_gelu_7</title>
<path fill="none" stroke="black" d="M10803.07,-3261.67C10683.97,-3242.83 10473.23,-3209.48 10340.33,-3188.46"/>
<polygon fill="black" stroke="black" points="10340.53,-3184.95 10330.1,-3186.84 10339.43,-3191.86 10340.53,-3184.95"/>
</g>
<!-- layer3_expert2_7 -->
<g id="node509" class="node">
<title>layer3_expert2_7</title>
<polygon fill="lightsteelblue" stroke="black" points="9027.29,-3093.91 8842.29,-3093.91 8842.29,-3025.91 9027.29,-3025.91 9027.29,-3093.91"/>
<text text-anchor="middle" x="8934.79" y="-3078.71" font-family="Times,serif" font-size="14.00">Expert 7 Second Linear</text>
<text text-anchor="middle" x="8934.79" y="-3063.71" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8934.79" y="-3048.71" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8934.79" y="-3033.71" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer3_expert_gelu_7&#45;&gt;layer3_expert2_7 -->
<g id="edge1308" class="edge">
<title>layer3_expert_gelu_7&#45;&gt;layer3_expert2_7</title>
<path fill="none" stroke="black" d="M10093.97,-3163.56C9836.23,-3155.09 9254.97,-3132.5 9037.45,-3093.81"/>
<polygon fill="black" stroke="black" points="9037.84,-3090.32 9027.37,-3091.95 9036.57,-3097.2 9037.84,-3090.32"/>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_0_0 -->
<g id="edge1421" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.41C8839.28,-3026.85 8836.52,-3026.35 8833.79,-3025.91 8794.34,-3019.57 3115.6,-3025.65 3079.79,-3007.91 3064.74,-3000.45 3068.39,-2990.07 3056.79,-2977.91 3053.07,-2974 3049.17,-2970.09 3045.17,-2966.21"/>
<polygon fill="black" stroke="black" points="3047.53,-2963.63 3037.87,-2959.28 3042.71,-2968.7 3047.53,-2963.63"/>
<text text-anchor="middle" x="3129.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3129.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_0_1 -->
<g id="edge1422" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.04,-3027.47C8839.27,-3026.9 8836.52,-3026.37 8833.79,-3025.91 8785.91,-3017.78 8003.12,-3029.85 7959.79,-3007.91 7944.8,-3000.32 7948.39,-2990.07 7936.79,-2977.91 7933.07,-2974 7929.17,-2970.09 7925.17,-2966.21"/>
<polygon fill="black" stroke="black" points="7927.53,-2963.63 7917.87,-2959.28 7922.71,-2968.7 7927.53,-2963.63"/>
<text text-anchor="middle" x="8009.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8009.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→1</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_0_2 -->
<g id="edge1423" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.42C8839.28,-3026.86 8836.52,-3026.35 8833.79,-3025.91 8756.31,-3013.32 6078.08,-3042.87 6007.79,-3007.91 5992.75,-3000.43 5996.39,-2990.07 5984.79,-2977.91 5981.07,-2974 5977.17,-2970.09 5973.17,-2966.21"/>
<polygon fill="black" stroke="black" points="5975.53,-2963.63 5965.87,-2959.28 5970.71,-2968.7 5975.53,-2963.63"/>
<text text-anchor="middle" x="6057.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6057.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_0_3 -->
<g id="edge1424" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.34,-3027.66C9030.51,-3027.01 9033.67,-3026.42 9036.79,-3025.91 9061.85,-3021.83 10846.93,-3025.95 10864.79,-3007.91 10895.97,-2976.42 10866.89,-2951.82 10820.68,-2933.63"/>
<polygon fill="black" stroke="black" points="10821.82,-2930.32 10811.23,-2930.08 10819.36,-2936.87 10821.82,-2930.32"/>
<text text-anchor="middle" x="10926.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10926.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→3</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_1_0 -->
<g id="edge1425" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.33,-3027.64C9030.51,-3026.99 9033.67,-3026.41 9036.79,-3025.91 9062.71,-3021.76 12798.27,-3026.52 12816.79,-3007.91 12848.13,-2976.43 12818.85,-2951.8 12772.45,-2933.59"/>
<polygon fill="black" stroke="black" points="12773.55,-2930.26 12762.96,-2930.03 12771.09,-2936.82 12773.55,-2930.26"/>
<text text-anchor="middle" x="12879.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12879.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_1_1 -->
<g id="edge1426" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8926.03,-3025.9C8920.29,-3009.67 8911.29,-2990.87 8897.79,-2977.91 8883.05,-2963.76 8865.62,-2951.86 8847.23,-2941.87"/>
<polygon fill="black" stroke="black" points="8848.62,-2938.65 8838.13,-2937.12 8845.38,-2944.85 8848.62,-2938.65"/>
<text text-anchor="middle" x="8967.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8967.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→5</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_1_2 -->
<g id="edge1427" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.41C8839.28,-3026.85 8836.52,-3026.35 8833.79,-3025.91 8768.28,-3015.35 4115.25,-3037.39 4055.79,-3007.91 4040.74,-3000.45 4044.39,-2990.07 4032.79,-2977.91 4029.07,-2974 4025.17,-2970.09 4021.17,-2966.21"/>
<polygon fill="black" stroke="black" points="4023.53,-2963.63 4013.87,-2959.28 4018.71,-2968.7 4023.53,-2963.63"/>
<text text-anchor="middle" x="4105.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4105.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_1_3 -->
<g id="edge1428" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.33,-3027.63C9030.51,-3026.98 9033.67,-3026.41 9036.79,-3025.91 9059.79,-3022.25 15728.34,-3024.4 15744.79,-3007.91 15776.16,-2976.46 15746.89,-2951.84 15700.49,-2933.63"/>
<polygon fill="black" stroke="black" points="15701.58,-2930.3 15690.99,-2930.07 15699.13,-2936.85 15701.58,-2930.3"/>
<text text-anchor="middle" x="15807.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15807.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→7</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_2_0 -->
<g id="edge1429" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.33,-3027.63C9030.51,-3026.99 9033.67,-3026.41 9036.79,-3025.91 9069.41,-3020.7 13769.48,-3031.31 13792.79,-3007.91 13824.14,-2976.44 13794.87,-2951.82 13748.47,-2933.61"/>
<polygon fill="black" stroke="black" points="13749.56,-2930.28 13738.97,-2930.05 13747.11,-2936.84 13749.56,-2930.28"/>
<text text-anchor="middle" x="13855.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13855.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_2_1 -->
<g id="edge1430" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.33,-3027.64C9030.51,-3027 9033.67,-3026.41 9036.79,-3025.91 9075.24,-3019.72 11813.34,-3035.54 11840.79,-3007.91 11872.1,-2976.4 11842.82,-2951.77 11796.42,-2933.56"/>
<polygon fill="black" stroke="black" points="11797.52,-2930.24 11786.93,-2930.01 11795.06,-2936.79 11797.52,-2930.24"/>
<text text-anchor="middle" x="11902.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11902.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→9</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_2_2 -->
<g id="edge1431" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.43C8839.28,-3026.87 8836.52,-3026.36 8833.79,-3025.91 8783.08,-3017.58 7029.77,-3030.87 6983.79,-3007.91 6968.76,-3000.4 6972.39,-2990.07 6960.79,-2977.91 6957.07,-2974 6953.17,-2970.09 6949.17,-2966.21"/>
<polygon fill="black" stroke="black" points="6951.53,-2963.63 6941.87,-2959.28 6946.71,-2968.7 6951.53,-2963.63"/>
<text text-anchor="middle" x="7033.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7033.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_2_3 -->
<g id="edge1432" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.34,-3027.7C9030.52,-3027.04 9033.67,-3026.44 9036.79,-3025.91 9060.13,-3021.98 9872.23,-3024.83 9888.79,-3007.91 9919.72,-2976.32 9890.81,-2951.72 9844.81,-2933.57"/>
<polygon fill="black" stroke="black" points="9845.98,-2930.27 9835.39,-2930.02 9843.52,-2936.82 9845.98,-2930.27"/>
<text text-anchor="middle" x="9950.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9950.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→11</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_3_0 -->
<g id="edge1433" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.4C8839.28,-3026.85 8836.52,-3026.35 8833.79,-3025.91 8787.65,-3018.5 2145.68,-3028.65 2103.79,-3007.91 2088.73,-3000.46 2092.39,-2990.07 2080.79,-2977.91 2077.07,-2974 2073.17,-2970.09 2069.17,-2966.21"/>
<polygon fill="black" stroke="black" points="2071.53,-2963.63 2061.87,-2959.28 2066.71,-2968.7 2071.53,-2963.63"/>
<text text-anchor="middle" x="2153.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2153.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_3_1 -->
<g id="edge1434" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.41C8839.28,-3026.86 8836.52,-3026.35 8833.79,-3025.91 8781.66,-3017.48 5079.09,-3031.39 5031.79,-3007.91 5016.74,-3000.44 5020.39,-2990.07 5008.79,-2977.91 5005.07,-2974 5001.17,-2970.09 4997.17,-2966.21"/>
<polygon fill="black" stroke="black" points="4999.53,-2963.63 4989.87,-2959.28 4994.71,-2968.7 4999.53,-2963.63"/>
<text text-anchor="middle" x="5081.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5081.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→13</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_3_2 -->
<g id="edge1435" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8842.05,-3027.4C8839.28,-3026.85 8836.52,-3026.35 8833.79,-3025.91 8781.79,-3017.57 1296.99,-3031.27 1249.79,-3007.91 1234.73,-3000.46 1238.39,-2990.07 1226.79,-2977.91 1223.07,-2974 1219.17,-2970.09 1215.17,-2966.21"/>
<polygon fill="black" stroke="black" points="1217.53,-2963.63 1207.87,-2959.28 1212.71,-2968.7 1217.53,-2963.63"/>
<text text-anchor="middle" x="1299.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1299.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer3_expert2_7&#45;&gt;layer3_expert_agg_3_3 -->
<g id="edge1436" class="edge">
<title>layer3_expert2_7&#45;&gt;layer3_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9027.33,-3027.63C9030.51,-3026.99 9033.67,-3026.41 9036.79,-3025.91 9076.1,-3019.65 14740.69,-3036.1 14768.79,-3007.91 14800.15,-2976.45 14770.88,-2951.83 14724.48,-2933.62"/>
<polygon fill="black" stroke="black" points="14725.57,-2930.29 14714.98,-2930.06 14723.12,-2936.85 14725.57,-2930.29"/>
<text text-anchor="middle" x="14831.29" y="-2996.71" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14831.29" y="-2981.71" font-family="Times,serif" font-size="14.00">GPU 14→15</text>
</g>
<!-- layer3_res2 -->
<g id="node526" class="node">
<title>layer3_res2</title>
<ellipse fill="lightpink" stroke="black" cx="8055.79" cy="-2642.2" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="8055.79" y="-2653.5" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="8055.79" y="-2638.5" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8055.79" y="-2623.5" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer3_expert_agg_0_0&#45;&gt;layer3_res2 -->
<g id="edge1437" class="edge">
<title>layer3_expert_agg_0_0&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M3149.85,-2872.43C3306.33,-2857.64 3532.6,-2837.53 3730.79,-2824.86 5359.54,-2720.71 7337.3,-2662.53 7899.85,-2647.28"/>
<polygon fill="black" stroke="black" points="7900.16,-2650.77 7910.06,-2647 7899.97,-2643.77 7900.16,-2650.77"/>
</g>
<!-- layer3_expert_agg_0_1&#45;&gt;layer3_res2 -->
<g id="edge1438" class="edge">
<title>layer3_expert_agg_0_1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M7895.77,-2824.55C7913.41,-2804.55 7933.29,-2782.02 7952.89,-2759.81"/>
<polygon fill="black" stroke="black" points="7955.53,-2762.11 7959.53,-2752.29 7950.29,-2757.47 7955.53,-2762.11"/>
</g>
<!-- layer3_expert_agg_0_2&#45;&gt;layer3_res2 -->
<g id="edge1439" class="edge">
<title>layer3_expert_agg_0_2&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M6077.93,-2869.31C6503.19,-2820.69 7513.39,-2705.2 7900.84,-2660.91"/>
<polygon fill="black" stroke="black" points="7901.46,-2664.36 7911,-2659.75 7900.66,-2657.41 7901.46,-2664.36"/>
</g>
<!-- layer3_expert_agg_0_3&#45;&gt;layer3_res2 -->
<g id="edge1440" class="edge">
<title>layer3_expert_agg_0_3&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M10449.67,-2872.86C9956.72,-2825.57 8659.24,-2701.09 8210.85,-2658.07"/>
<polygon fill="black" stroke="black" points="8211.03,-2654.57 8200.74,-2657.1 8210.36,-2661.54 8211.03,-2654.57"/>
</g>
<!-- layer3_expert_agg_1_0&#45;&gt;layer3_res2 -->
<g id="edge1441" class="edge">
<title>layer3_expert_agg_1_0&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M12401.71,-2872.77C12245.22,-2858.16 12018.94,-2838.15 11820.79,-2824.86 10421.77,-2731.02 8727.15,-2667 8211.81,-2648.62"/>
<polygon fill="black" stroke="black" points="8211.82,-2645.12 8201.71,-2648.26 8211.57,-2652.12 8211.82,-2645.12"/>
</g>
<!-- layer3_expert_agg_1_1&#45;&gt;layer3_res2 -->
<g id="edge1442" class="edge">
<title>layer3_expert_agg_1_1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M8562.67,-2841.31C8457.94,-2800.38 8309.9,-2742.51 8200.83,-2699.88"/>
<polygon fill="black" stroke="black" points="8201.98,-2696.58 8191.39,-2696.2 8199.43,-2703.1 8201.98,-2696.58"/>
</g>
<!-- layer3_expert_agg_1_2&#45;&gt;layer3_res2 -->
<g id="edge1443" class="edge">
<title>layer3_expert_agg_1_2&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M4125.9,-2873.09C4282.4,-2858.67 4508.68,-2838.74 4706.79,-2824.86 5936.33,-2738.69 7422.28,-2670.82 7899.96,-2649.9"/>
<polygon fill="black" stroke="black" points="7900.19,-2653.39 7910.02,-2649.46 7899.88,-2646.4 7900.19,-2653.39"/>
</g>
<!-- layer3_expert_agg_1_3&#45;&gt;layer3_res2 -->
<g id="edge1444" class="edge">
<title>layer3_expert_agg_1_3&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M15329.38,-2871.6C15172.95,-2856.35 14946.9,-2836.05 14748.79,-2824.86 12137.74,-2677.34 8946.68,-2648.8 8211.75,-2644.05"/>
<polygon fill="black" stroke="black" points="8211.66,-2640.55 8201.64,-2643.99 8211.61,-2647.55 8211.66,-2640.55"/>
</g>
<!-- layer3_expert_agg_2_0&#45;&gt;layer3_res2 -->
<g id="edge1445" class="edge">
<title>layer3_expert_agg_2_0&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M13377.74,-2872.23C13221.27,-2857.33 12995.01,-2837.17 12796.79,-2824.86 10996.7,-2713.08 8807.58,-2659.61 8211.77,-2646.48"/>
<polygon fill="black" stroke="black" points="8211.48,-2642.98 8201.41,-2646.26 8211.33,-2649.98 8211.48,-2642.98"/>
</g>
<!-- layer3_expert_agg_2_1&#45;&gt;layer3_res2 -->
<g id="edge1446" class="edge">
<title>layer3_expert_agg_2_1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M11425.65,-2873.67C11269.12,-2859.58 11042.82,-2839.82 10844.79,-2824.86 9841.99,-2749.11 8634.9,-2676.95 8211.57,-2652.21"/>
<polygon fill="black" stroke="black" points="8211.6,-2648.7 8201.41,-2651.61 8211.19,-2655.69 8211.6,-2648.7"/>
</g>
<!-- layer3_expert_agg_2_2&#45;&gt;layer3_res2 -->
<g id="edge1447" class="edge">
<title>layer3_expert_agg_2_2&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M7032.01,-2855.83C7265.39,-2807.35 7679.82,-2721.28 7903.12,-2674.9"/>
<polygon fill="black" stroke="black" points="7903.87,-2678.32 7912.95,-2672.86 7902.45,-2671.47 7903.87,-2678.32"/>
</g>
<!-- layer3_expert_agg_2_3&#45;&gt;layer3_res2 -->
<g id="edge1448" class="edge">
<title>layer3_expert_agg_2_3&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M9476.85,-2862.12C9154.3,-2812.43 8505.72,-2712.51 8209.58,-2666.89"/>
<polygon fill="black" stroke="black" points="8210.04,-2663.42 8199.63,-2665.35 8208.98,-2670.34 8210.04,-2663.42"/>
</g>
<!-- layer3_expert_agg_3_0&#45;&gt;layer3_res2 -->
<g id="edge1449" class="edge">
<title>layer3_expert_agg_3_0&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M2174.22,-2871.98C2330.67,-2856.95 2556.72,-2836.76 2754.79,-2824.86 4786.45,-2702.82 7261.42,-2656.1 7899.76,-2645.61"/>
<polygon fill="black" stroke="black" points="7900,-2649.1 7909.94,-2645.44 7899.88,-2642.11 7900,-2649.1"/>
</g>
<!-- layer3_expert_agg_3_1&#45;&gt;layer3_res2 -->
<g id="edge1450" class="edge">
<title>layer3_expert_agg_3_1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M5101.99,-2874.28C5258.54,-2860.53 5484.85,-2840.94 5682.79,-2824.86 6518.65,-2756.95 7520.72,-2682.53 7900.06,-2654.61"/>
<polygon fill="black" stroke="black" points="7900.56,-2658.08 7910.28,-2653.86 7900.05,-2651.1 7900.56,-2658.08"/>
</g>
<!-- layer3_expert_agg_3_2&#45;&gt;layer3_res2 -->
<g id="edge1451" class="edge">
<title>layer3_expert_agg_3_2&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M1320.13,-2867.93C1449.7,-2853.14 1624.24,-2834.97 1778.79,-2824.86 4214.93,-2665.54 7192.04,-2645.94 7899.67,-2643.53"/>
<polygon fill="black" stroke="black" points="7899.93,-2647.03 7909.92,-2643.5 7899.91,-2640.03 7899.93,-2647.03"/>
</g>
<!-- layer3_expert_agg_3_3&#45;&gt;layer3_res2 -->
<g id="edge1452" class="edge">
<title>layer3_expert_agg_3_3&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M14353.37,-2871.84C14196.92,-2856.74 13970.88,-2836.51 13772.79,-2824.86 11568.55,-2695.21 8880.39,-2653.73 8211.87,-2645.07"/>
<polygon fill="black" stroke="black" points="8211.74,-2641.56 8201.69,-2644.93 8211.65,-2648.56 8211.74,-2641.56"/>
</g>
<!-- layer4_ln1_0_0 -->
<g id="node527" class="node">
<title>layer4_ln1_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="3544.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="3544.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3544.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="3544.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3544.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_0_0 -->
<g id="edge1453" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_0_0</title>
<path fill="none" stroke="black" d="M7910.17,-2638.08C7381.39,-2626.06 5513.17,-2577.35 3976.79,-2459.53 3879.39,-2452.06 3770,-2440.1 3685.66,-2430.11"/>
<polygon fill="black" stroke="black" points="3685.85,-2426.6 3675.51,-2428.9 3685.02,-2433.56 3685.85,-2426.6"/>
</g>
<!-- layer4_ln1_0_1 -->
<g id="node528" class="node">
<title>layer4_ln1_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="4125.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="4125.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4125.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="4125.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4125.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_0_1 -->
<g id="edge1454" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_0_1</title>
<path fill="none" stroke="black" d="M7910.27,-2635.61C7436.83,-2616.99 5897.63,-2552.87 4626.79,-2459.53 4506.02,-2450.66 4369.15,-2437.59 4269.02,-2427.47"/>
<polygon fill="black" stroke="black" points="4269.14,-2423.97 4258.84,-2426.44 4268.44,-2430.93 4269.14,-2423.97"/>
</g>
<!-- layer4_ln1_0_2 -->
<g id="node529" class="node">
<title>layer4_ln1_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="4775.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="4775.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4775.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="4775.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4775.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_0_2 -->
<g id="edge1455" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_0_2</title>
<path fill="none" stroke="black" d="M7910.28,-2634.26C7490.4,-2613.74 6240.61,-2549.12 5205.79,-2459.53 5109.27,-2451.18 5000.83,-2439.28 4917,-2429.54"/>
<polygon fill="black" stroke="black" points="4917.24,-2426.05 4906.9,-2428.37 4916.43,-2433 4917.24,-2426.05"/>
</g>
<!-- layer4_ln1_0_3 -->
<g id="node530" class="node">
<title>layer4_ln1_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="5354.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="5354.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5354.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="5354.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5354.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_0_3 -->
<g id="edge1456" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_0_3</title>
<path fill="none" stroke="black" d="M7910.52,-2630.77C7551.92,-2604.74 6595.97,-2533.7 5799.79,-2459.53 5698.49,-2450.1 5584.39,-2437.99 5497.09,-2428.42"/>
<polygon fill="black" stroke="black" points="5497.44,-2424.94 5487.11,-2427.33 5496.67,-2431.9 5497.44,-2424.94"/>
</g>
<!-- layer4_ln1_1_0 -->
<g id="node531" class="node">
<title>layer4_ln1_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="5948.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="5948.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5948.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="5948.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5948.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_1_0 -->
<g id="edge1457" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_1_0</title>
<path fill="none" stroke="black" d="M7910.97,-2625.47C7525.06,-2583.58 6475.29,-2469.61 6091.65,-2427.96"/>
<polygon fill="black" stroke="black" points="6091.92,-2424.47 6081.6,-2426.87 6091.16,-2431.43 6091.92,-2424.47"/>
</g>
<!-- layer4_ln1_1_1 -->
<g id="node532" class="node">
<title>layer4_ln1_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="6552.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="6552.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6552.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="6552.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6552.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_1_1 -->
<g id="edge1458" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_1_1</title>
<path fill="none" stroke="black" d="M7911.68,-2619.26C7622.13,-2575.2 6973.28,-2476.44 6689.76,-2433.29"/>
<polygon fill="black" stroke="black" points="6690.24,-2429.83 6679.83,-2431.78 6689.19,-2436.75 6690.24,-2429.83"/>
</g>
<!-- layer4_ln1_1_2 -->
<g id="node533" class="node">
<title>layer4_ln1_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="7221.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7221.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7221.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="7221.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7221.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_1_2 -->
<g id="edge1459" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_1_2</title>
<path fill="none" stroke="black" d="M7915.26,-2602.65C7753.66,-2558.33 7491.24,-2486.35 7339.8,-2444.81"/>
<polygon fill="black" stroke="black" points="7340.55,-2441.39 7329.98,-2442.12 7338.7,-2448.14 7340.55,-2441.39"/>
</g>
<!-- layer4_ln1_1_3 -->
<g id="node534" class="node">
<title>layer4_ln1_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="7845.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="7845.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7845.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="7845.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7845.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_1_3 -->
<g id="edge1460" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_1_3</title>
<path fill="none" stroke="black" d="M7957.55,-2534.19C7935.5,-2510.16 7913.04,-2485.7 7894.1,-2465.07"/>
<polygon fill="black" stroke="black" points="7896.63,-2462.65 7887.29,-2457.65 7891.47,-2467.38 7896.63,-2462.65"/>
</g>
<!-- layer4_ln1_2_0 -->
<g id="node535" class="node">
<title>layer4_ln1_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="8231.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8231.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8231.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="8231.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8231.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_2_0 -->
<g id="edge1461" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_2_0</title>
<path fill="none" stroke="black" d="M8144.31,-2526.15C8160.42,-2505.22 8176.5,-2484.31 8190.4,-2466.24"/>
<polygon fill="black" stroke="black" points="8193.31,-2468.21 8196.63,-2458.15 8187.76,-2463.94 8193.31,-2468.21"/>
</g>
<!-- layer4_ln1_2_1 -->
<g id="node536" class="node">
<title>layer4_ln1_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="8844.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="8844.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8844.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="8844.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8844.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_2_1 -->
<g id="edge1462" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_2_1</title>
<path fill="none" stroke="black" d="M8195.49,-2600.7C8347.57,-2556.6 8587.96,-2486.91 8729.64,-2445.83"/>
<polygon fill="black" stroke="black" points="8730.61,-2449.2 8739.24,-2443.05 8728.66,-2442.47 8730.61,-2449.2"/>
</g>
<!-- layer4_ln1_2_2 -->
<g id="node537" class="node">
<title>layer4_ln1_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="9495.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="9495.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9495.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="9495.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9495.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_2_2 -->
<g id="edge1463" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_2_2</title>
<path fill="none" stroke="black" d="M8199.79,-2618.32C8478.42,-2574.06 9087.77,-2477.26 9359.87,-2434.04"/>
<polygon fill="black" stroke="black" points="9360.47,-2437.49 9369.8,-2432.46 9359.37,-2430.57 9360.47,-2437.49"/>
</g>
<!-- layer4_ln1_2_3 -->
<g id="node538" class="node">
<title>layer4_ln1_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10170.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10170.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10170.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="10170.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10170.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_2_3 -->
<g id="edge1464" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_2_3</title>
<path fill="none" stroke="black" d="M8200.75,-2625.52C8587.99,-2583.64 9643.27,-2469.5 10028,-2427.89"/>
<polygon fill="black" stroke="black" points="10028.51,-2431.36 10038.08,-2426.8 10027.76,-2424.4 10028.51,-2431.36"/>
</g>
<!-- layer4_ln1_3_0 -->
<g id="node539" class="node">
<title>layer4_ln1_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10812.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="10812.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10812.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="10812.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10812.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_3_0 -->
<g id="edge1465" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_3_0</title>
<path fill="none" stroke="black" d="M8201.2,-2630.3C8560.72,-2603.18 9520.19,-2529.79 10319.79,-2459.53 10437.38,-2449.2 10570.63,-2436.41 10668.92,-2426.77"/>
<polygon fill="black" stroke="black" points="10669.32,-2430.25 10678.93,-2425.79 10668.63,-2423.28 10669.32,-2430.25"/>
</g>
<!-- layer4_ln1_3_1 -->
<g id="node540" class="node">
<title>layer4_ln1_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="11454.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="11454.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11454.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="11454.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11454.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_3_1 -->
<g id="edge1466" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_3_1</title>
<path fill="none" stroke="black" d="M8201.43,-2633.78C8626.76,-2611.77 9903.86,-2543.1 10961.79,-2459.53 11079.67,-2450.22 11213.18,-2437.33 11311.5,-2427.38"/>
<polygon fill="black" stroke="black" points="11311.91,-2430.86 11321.5,-2426.37 11311.2,-2423.9 11311.91,-2430.86"/>
</g>
<!-- layer4_ln1_3_2 -->
<g id="node541" class="node">
<title>layer4_ln1_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="12131.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12131.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12131.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="12131.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12131.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_3_2 -->
<g id="edge1467" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_3_2</title>
<path fill="none" stroke="black" d="M8201.66,-2635.71C8685.93,-2617.05 10284.43,-2552.1 11603.79,-2459.53 11733.86,-2450.41 11881.68,-2436.96 11987.77,-2426.77"/>
<polygon fill="black" stroke="black" points="11988.28,-2430.24 11997.9,-2425.8 11987.61,-2423.27 11988.28,-2430.24"/>
</g>
<!-- layer4_ln1_3_3 -->
<g id="node542" class="node">
<title>layer4_ln1_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="12810.79" cy="-2411.45" rx="140.01" ry="48.17"/>
<text text-anchor="middle" x="12810.79" y="-2430.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12810.79" y="-2415.25" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="12810.79" y="-2400.25" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12810.79" y="-2385.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1_3_3 -->
<g id="edge1468" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1_3_3</title>
<path fill="none" stroke="black" d="M8201.4,-2637.34C8741.76,-2622.54 10683.27,-2564.78 12280.79,-2459.53 12411.72,-2450.91 12560.53,-2437.36 12667.06,-2427"/>
<polygon fill="black" stroke="black" points="12667.62,-2430.47 12677.24,-2426.01 12666.94,-2423.5 12667.62,-2430.47"/>
</g>
<!-- layer4_q_proj_0_0 -->
<g id="node543" class="node">
<title>layer4_q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="3344.29,-2326.37 3171.29,-2326.37 3171.29,-2243.37 3344.29,-2243.37 3344.29,-2326.37"/>
<text text-anchor="middle" x="3257.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3257.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="3257.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="3257.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3257.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_0&#45;&gt;layer4_q_proj_0_0 -->
<g id="edge1469" class="edge">
<title>layer4_ln1_0_0&#45;&gt;layer4_q_proj_0_0</title>
<path fill="none" stroke="black" d="M3459.07,-2373.24C3426.01,-2358.89 3388.03,-2342.4 3354.03,-2327.64"/>
<polygon fill="black" stroke="black" points="3355.13,-2324.3 3344.56,-2323.53 3352.34,-2330.72 3355.13,-2324.3"/>
</g>
<!-- layer4_k_proj_0_0 -->
<g id="node544" class="node">
<title>layer4_k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="3535.29,-2326.37 3362.29,-2326.37 3362.29,-2243.37 3535.29,-2243.37 3535.29,-2326.37"/>
<text text-anchor="middle" x="3448.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3448.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="3448.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="3448.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3448.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_0&#45;&gt;layer4_k_proj_0_0 -->
<g id="edge1470" class="edge">
<title>layer4_ln1_0_0&#45;&gt;layer4_k_proj_0_0</title>
<path fill="none" stroke="black" d="M3509.59,-2364.77C3502.06,-2355 3494.09,-2344.65 3486.47,-2334.77"/>
<polygon fill="black" stroke="black" points="3489.06,-2332.38 3480.18,-2326.6 3483.51,-2336.66 3489.06,-2332.38"/>
</g>
<!-- layer4_v_proj_0_0 -->
<g id="node545" class="node">
<title>layer4_v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="3726.29,-2326.37 3553.29,-2326.37 3553.29,-2243.37 3726.29,-2243.37 3726.29,-2326.37"/>
<text text-anchor="middle" x="3639.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3639.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 0&#45;127</text>
<text text-anchor="middle" x="3639.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="3639.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3639.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_0&#45;&gt;layer4_v_proj_0_0 -->
<g id="edge1471" class="edge">
<title>layer4_ln1_0_0&#45;&gt;layer4_v_proj_0_0</title>
<path fill="none" stroke="black" d="M3579.63,-2364.77C3587.07,-2355 3594.97,-2344.65 3602.5,-2334.77"/>
<polygon fill="black" stroke="black" points="3605.45,-2336.67 3608.73,-2326.6 3599.88,-2332.43 3605.45,-2336.67"/>
</g>
<!-- layer4_q_proj_0_1 -->
<g id="node546" class="node">
<title>layer4_q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3934.79,-2326.37 3744.79,-2326.37 3744.79,-2243.37 3934.79,-2243.37 3934.79,-2326.37"/>
<text text-anchor="middle" x="3839.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3839.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="3839.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="3839.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="3839.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_1&#45;&gt;layer4_q_proj_0_1 -->
<g id="edge1472" class="edge">
<title>layer4_ln1_0_1&#45;&gt;layer4_q_proj_0_1</title>
<path fill="none" stroke="black" d="M4040.37,-2373.24C4009.58,-2359.83 3974.52,-2344.56 3942.42,-2330.57"/>
<polygon fill="black" stroke="black" points="3943.57,-2327.25 3933.01,-2326.47 3940.78,-2333.67 3943.57,-2327.25"/>
</g>
<!-- layer4_k_proj_0_1 -->
<g id="node547" class="node">
<title>layer4_k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4142.79,-2326.37 3952.79,-2326.37 3952.79,-2243.37 4142.79,-2243.37 4142.79,-2326.37"/>
<text text-anchor="middle" x="4047.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4047.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="4047.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4047.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="4047.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_1&#45;&gt;layer4_k_proj_0_1 -->
<g id="edge1473" class="edge">
<title>layer4_ln1_0_1&#45;&gt;layer4_k_proj_0_1</title>
<path fill="none" stroke="black" d="M4096.75,-2364.06C4090.84,-2354.63 4084.62,-2344.68 4078.65,-2335.16"/>
<polygon fill="black" stroke="black" points="4081.54,-2333.17 4073.27,-2326.56 4075.61,-2336.89 4081.54,-2333.17"/>
</g>
<!-- layer4_v_proj_0_1 -->
<g id="node548" class="node">
<title>layer4_v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4350.79,-2326.37 4160.79,-2326.37 4160.79,-2243.37 4350.79,-2243.37 4350.79,-2326.37"/>
<text text-anchor="middle" x="4255.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4255.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 128&#45;255</text>
<text text-anchor="middle" x="4255.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4255.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="4255.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_1&#45;&gt;layer4_v_proj_0_1 -->
<g id="edge1474" class="edge">
<title>layer4_ln1_0_1&#45;&gt;layer4_v_proj_0_1</title>
<path fill="none" stroke="black" d="M4172.36,-2365.82C4183.25,-2355.38 4194.89,-2344.23 4205.92,-2333.66"/>
<polygon fill="black" stroke="black" points="4208.65,-2335.89 4213.44,-2326.45 4203.8,-2330.84 4208.65,-2335.89"/>
</g>
<!-- layer4_q_proj_0_2 -->
<g id="node549" class="node">
<title>layer4_q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4558.79,-2326.37 4368.79,-2326.37 4368.79,-2243.37 4558.79,-2243.37 4558.79,-2326.37"/>
<text text-anchor="middle" x="4463.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4463.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="4463.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4463.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4463.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_2&#45;&gt;layer4_q_proj_0_2 -->
<g id="edge1475" class="edge">
<title>layer4_ln1_0_2&#45;&gt;layer4_q_proj_0_2</title>
<path fill="none" stroke="black" d="M4685.55,-2374.41C4648.96,-2359.81 4606.48,-2342.84 4568.54,-2327.69"/>
<polygon fill="black" stroke="black" points="4569.58,-2324.34 4559,-2323.88 4566.98,-2330.84 4569.58,-2324.34"/>
</g>
<!-- layer4_k_proj_0_2 -->
<g id="node550" class="node">
<title>layer4_k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4766.79,-2326.37 4576.79,-2326.37 4576.79,-2243.37 4766.79,-2243.37 4766.79,-2326.37"/>
<text text-anchor="middle" x="4671.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4671.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="4671.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4671.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4671.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_2&#45;&gt;layer4_k_proj_0_2 -->
<g id="edge1476" class="edge">
<title>layer4_ln1_0_2&#45;&gt;layer4_k_proj_0_2</title>
<path fill="none" stroke="black" d="M4737.95,-2365.12C4729.53,-2355.03 4720.57,-2344.3 4712.05,-2334.09"/>
<polygon fill="black" stroke="black" points="4714.74,-2331.85 4705.64,-2326.41 4709.36,-2336.33 4714.74,-2331.85"/>
</g>
<!-- layer4_v_proj_0_2 -->
<g id="node551" class="node">
<title>layer4_v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="4974.79,-2326.37 4784.79,-2326.37 4784.79,-2243.37 4974.79,-2243.37 4974.79,-2326.37"/>
<text text-anchor="middle" x="4879.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4879.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 256&#45;383</text>
<text text-anchor="middle" x="4879.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="4879.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4879.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_2&#45;&gt;layer4_v_proj_0_2 -->
<g id="edge1477" class="edge">
<title>layer4_ln1_0_2&#45;&gt;layer4_v_proj_0_2</title>
<path fill="none" stroke="black" d="M4813.63,-2365.12C4822.06,-2355.03 4831.01,-2344.3 4839.53,-2334.09"/>
<polygon fill="black" stroke="black" points="4842.22,-2336.33 4845.94,-2326.41 4836.85,-2331.85 4842.22,-2336.33"/>
</g>
<!-- layer4_q_proj_0_3 -->
<g id="node552" class="node">
<title>layer4_q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="5182.79,-2326.37 4992.79,-2326.37 4992.79,-2243.37 5182.79,-2243.37 5182.79,-2326.37"/>
<text text-anchor="middle" x="5087.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5087.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="5087.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5087.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5087.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_3&#45;&gt;layer4_q_proj_0_3 -->
<g id="edge1478" class="edge">
<title>layer4_ln1_0_3&#45;&gt;layer4_q_proj_0_3</title>
<path fill="none" stroke="black" d="M5272.87,-2372.22C5244.79,-2359.12 5213.11,-2344.34 5184.01,-2330.76"/>
<polygon fill="black" stroke="black" points="5185.2,-2327.45 5174.65,-2326.4 5182.24,-2333.8 5185.2,-2327.45"/>
</g>
<!-- layer4_k_proj_0_3 -->
<g id="node553" class="node">
<title>layer4_k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="5390.79,-2326.37 5200.79,-2326.37 5200.79,-2243.37 5390.79,-2243.37 5390.79,-2326.37"/>
<text text-anchor="middle" x="5295.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5295.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="5295.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5295.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5295.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_3&#45;&gt;layer4_k_proj_0_3 -->
<g id="edge1479" class="edge">
<title>layer4_ln1_0_3&#45;&gt;layer4_k_proj_0_3</title>
<path fill="none" stroke="black" d="M5332.65,-2363.7C5328.34,-2354.59 5323.8,-2345 5319.43,-2335.79"/>
<polygon fill="black" stroke="black" points="5322.59,-2334.27 5315.15,-2326.73 5316.26,-2337.27 5322.59,-2334.27"/>
</g>
<!-- layer4_v_proj_0_3 -->
<g id="node554" class="node">
<title>layer4_v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="5598.79,-2326.37 5408.79,-2326.37 5408.79,-2243.37 5598.79,-2243.37 5598.79,-2326.37"/>
<text text-anchor="middle" x="5503.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5503.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 0&#45;3, Dim 384&#45;511</text>
<text text-anchor="middle" x="5503.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5503.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5503.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_0_3&#45;&gt;layer4_v_proj_0_3 -->
<g id="edge1480" class="edge">
<title>layer4_ln1_0_3&#45;&gt;layer4_v_proj_0_3</title>
<path fill="none" stroke="black" d="M5407.32,-2366.53C5420.23,-2355.73 5434.1,-2344.14 5447.19,-2333.19"/>
<polygon fill="black" stroke="black" points="5449.79,-2335.58 5455.22,-2326.48 5445.3,-2330.21 5449.79,-2335.58"/>
</g>
<!-- layer4_q_proj_1_0 -->
<g id="node555" class="node">
<title>layer4_q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="5790.29,-2326.37 5617.29,-2326.37 5617.29,-2243.37 5790.29,-2243.37 5790.29,-2326.37"/>
<text text-anchor="middle" x="5703.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5703.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="5703.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5703.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="5703.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_0&#45;&gt;layer4_q_proj_1_0 -->
<g id="edge1481" class="edge">
<title>layer4_ln1_1_0&#45;&gt;layer4_q_proj_1_0</title>
<path fill="none" stroke="black" d="M5871.61,-2371.2C5846.51,-2358.44 5818.47,-2344.18 5792.59,-2331.02"/>
<polygon fill="black" stroke="black" points="5794.04,-2327.83 5783.54,-2326.42 5790.87,-2334.07 5794.04,-2327.83"/>
</g>
<!-- layer4_k_proj_1_0 -->
<g id="node556" class="node">
<title>layer4_k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="5981.29,-2326.37 5808.29,-2326.37 5808.29,-2243.37 5981.29,-2243.37 5981.29,-2326.37"/>
<text text-anchor="middle" x="5894.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5894.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="5894.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="5894.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="5894.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_0&#45;&gt;layer4_k_proj_1_0 -->
<g id="edge1482" class="edge">
<title>layer4_ln1_1_0&#45;&gt;layer4_k_proj_1_0</title>
<path fill="none" stroke="black" d="M5928.53,-2363.7C5924.62,-2354.68 5920.51,-2345.2 5916.56,-2336.08"/>
<polygon fill="black" stroke="black" points="5919.69,-2334.52 5912.51,-2326.73 5913.27,-2337.3 5919.69,-2334.52"/>
</g>
<!-- layer4_v_proj_1_0 -->
<g id="node557" class="node">
<title>layer4_v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6172.29,-2326.37 5999.29,-2326.37 5999.29,-2243.37 6172.29,-2243.37 6172.29,-2326.37"/>
<text text-anchor="middle" x="6085.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6085.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 0&#45;127</text>
<text text-anchor="middle" x="6085.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6085.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6085.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_0&#45;&gt;layer4_v_proj_1_0 -->
<g id="edge1483" class="edge">
<title>layer4_ln1_1_0&#45;&gt;layer4_v_proj_1_0</title>
<path fill="none" stroke="black" d="M5997.48,-2366.17C6009.09,-2355.62 6021.53,-2344.31 6033.3,-2333.6"/>
<polygon fill="black" stroke="black" points="6035.88,-2335.99 6040.92,-2326.67 6031.17,-2330.81 6035.88,-2335.99"/>
</g>
<!-- layer4_q_proj_1_1 -->
<g id="node558" class="node">
<title>layer4_q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6380.79,-2326.37 6190.79,-2326.37 6190.79,-2243.37 6380.79,-2243.37 6380.79,-2326.37"/>
<text text-anchor="middle" x="6285.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6285.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="6285.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6285.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="6285.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_1&#45;&gt;layer4_q_proj_1_1 -->
<g id="edge1484" class="edge">
<title>layer4_ln1_1_1&#45;&gt;layer4_q_proj_1_1</title>
<path fill="none" stroke="black" d="M6470.87,-2372.22C6442.79,-2359.12 6411.11,-2344.34 6382.01,-2330.76"/>
<polygon fill="black" stroke="black" points="6383.2,-2327.45 6372.65,-2326.4 6380.24,-2333.8 6383.2,-2327.45"/>
</g>
<!-- layer4_k_proj_1_1 -->
<g id="node559" class="node">
<title>layer4_k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6588.79,-2326.37 6398.79,-2326.37 6398.79,-2243.37 6588.79,-2243.37 6588.79,-2326.37"/>
<text text-anchor="middle" x="6493.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6493.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="6493.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6493.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="6493.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_1&#45;&gt;layer4_k_proj_1_1 -->
<g id="edge1485" class="edge">
<title>layer4_ln1_1_1&#45;&gt;layer4_k_proj_1_1</title>
<path fill="none" stroke="black" d="M6530.65,-2363.7C6526.34,-2354.59 6521.8,-2345 6517.43,-2335.79"/>
<polygon fill="black" stroke="black" points="6520.59,-2334.27 6513.15,-2326.73 6514.26,-2337.27 6520.59,-2334.27"/>
</g>
<!-- layer4_v_proj_1_1 -->
<g id="node560" class="node">
<title>layer4_v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6796.79,-2326.37 6606.79,-2326.37 6606.79,-2243.37 6796.79,-2243.37 6796.79,-2326.37"/>
<text text-anchor="middle" x="6701.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6701.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 128&#45;255</text>
<text text-anchor="middle" x="6701.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6701.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="6701.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_1&#45;&gt;layer4_v_proj_1_1 -->
<g id="edge1486" class="edge">
<title>layer4_ln1_1_1&#45;&gt;layer4_v_proj_1_1</title>
<path fill="none" stroke="black" d="M6605.32,-2366.53C6618.23,-2355.73 6632.1,-2344.14 6645.19,-2333.19"/>
<polygon fill="black" stroke="black" points="6647.79,-2335.58 6653.22,-2326.48 6643.3,-2330.21 6647.79,-2335.58"/>
</g>
<!-- layer4_q_proj_1_2 -->
<g id="node561" class="node">
<title>layer4_q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="7004.79,-2326.37 6814.79,-2326.37 6814.79,-2243.37 7004.79,-2243.37 7004.79,-2326.37"/>
<text text-anchor="middle" x="6909.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6909.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="6909.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="6909.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="6909.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_2&#45;&gt;layer4_q_proj_1_2 -->
<g id="edge1487" class="edge">
<title>layer4_ln1_1_2&#45;&gt;layer4_q_proj_1_2</title>
<path fill="none" stroke="black" d="M7131.55,-2374.41C7094.96,-2359.81 7052.48,-2342.84 7014.54,-2327.69"/>
<polygon fill="black" stroke="black" points="7015.58,-2324.34 7005,-2323.88 7012.98,-2330.84 7015.58,-2324.34"/>
</g>
<!-- layer4_k_proj_1_2 -->
<g id="node562" class="node">
<title>layer4_k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="7212.79,-2326.37 7022.79,-2326.37 7022.79,-2243.37 7212.79,-2243.37 7212.79,-2326.37"/>
<text text-anchor="middle" x="7117.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7117.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="7117.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7117.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7117.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_2&#45;&gt;layer4_k_proj_1_2 -->
<g id="edge1488" class="edge">
<title>layer4_ln1_1_2&#45;&gt;layer4_k_proj_1_2</title>
<path fill="none" stroke="black" d="M7183.95,-2365.12C7175.53,-2355.03 7166.57,-2344.3 7158.05,-2334.09"/>
<polygon fill="black" stroke="black" points="7160.74,-2331.85 7151.64,-2326.41 7155.36,-2336.33 7160.74,-2331.85"/>
</g>
<!-- layer4_v_proj_1_2 -->
<g id="node563" class="node">
<title>layer4_v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="7420.79,-2326.37 7230.79,-2326.37 7230.79,-2243.37 7420.79,-2243.37 7420.79,-2326.37"/>
<text text-anchor="middle" x="7325.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7325.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 256&#45;383</text>
<text text-anchor="middle" x="7325.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7325.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7325.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_2&#45;&gt;layer4_v_proj_1_2 -->
<g id="edge1489" class="edge">
<title>layer4_ln1_1_2&#45;&gt;layer4_v_proj_1_2</title>
<path fill="none" stroke="black" d="M7259.63,-2365.12C7268.06,-2355.03 7277.01,-2344.3 7285.53,-2334.09"/>
<polygon fill="black" stroke="black" points="7288.22,-2336.33 7291.94,-2326.41 7282.85,-2331.85 7288.22,-2336.33"/>
</g>
<!-- layer4_q_proj_1_3 -->
<g id="node564" class="node">
<title>layer4_q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="7628.79,-2326.37 7438.79,-2326.37 7438.79,-2243.37 7628.79,-2243.37 7628.79,-2326.37"/>
<text text-anchor="middle" x="7533.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7533.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="7533.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7533.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="7533.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_3&#45;&gt;layer4_q_proj_1_3 -->
<g id="edge1490" class="edge">
<title>layer4_ln1_1_3&#45;&gt;layer4_q_proj_1_3</title>
<path fill="none" stroke="black" d="M7755.55,-2374.41C7718.96,-2359.81 7676.48,-2342.84 7638.54,-2327.69"/>
<polygon fill="black" stroke="black" points="7639.58,-2324.34 7629,-2323.88 7636.98,-2330.84 7639.58,-2324.34"/>
</g>
<!-- layer4_k_proj_1_3 -->
<g id="node565" class="node">
<title>layer4_k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="7836.79,-2326.37 7646.79,-2326.37 7646.79,-2243.37 7836.79,-2243.37 7836.79,-2326.37"/>
<text text-anchor="middle" x="7741.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7741.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="7741.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7741.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="7741.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_3&#45;&gt;layer4_k_proj_1_3 -->
<g id="edge1491" class="edge">
<title>layer4_ln1_1_3&#45;&gt;layer4_k_proj_1_3</title>
<path fill="none" stroke="black" d="M7807.95,-2365.12C7799.53,-2355.03 7790.57,-2344.3 7782.05,-2334.09"/>
<polygon fill="black" stroke="black" points="7784.74,-2331.85 7775.64,-2326.41 7779.36,-2336.33 7784.74,-2331.85"/>
</g>
<!-- layer4_v_proj_1_3 -->
<g id="node566" class="node">
<title>layer4_v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="8044.79,-2326.37 7854.79,-2326.37 7854.79,-2243.37 8044.79,-2243.37 8044.79,-2326.37"/>
<text text-anchor="middle" x="7949.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7949.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 4&#45;7, Dim 384&#45;511</text>
<text text-anchor="middle" x="7949.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="7949.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="7949.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_1_3&#45;&gt;layer4_v_proj_1_3 -->
<g id="edge1492" class="edge">
<title>layer4_ln1_1_3&#45;&gt;layer4_v_proj_1_3</title>
<path fill="none" stroke="black" d="M7883.63,-2365.12C7892.06,-2355.03 7901.01,-2344.3 7909.53,-2334.09"/>
<polygon fill="black" stroke="black" points="7912.22,-2336.33 7915.94,-2326.41 7906.85,-2331.85 7912.22,-2336.33"/>
</g>
<!-- layer4_q_proj_2_0 -->
<g id="node567" class="node">
<title>layer4_q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="8244.29,-2326.37 8063.29,-2326.37 8063.29,-2243.37 8244.29,-2243.37 8244.29,-2326.37"/>
<text text-anchor="middle" x="8153.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8153.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="8153.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8153.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8153.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_0&#45;&gt;layer4_q_proj_2_0 -->
<g id="edge1493" class="edge">
<title>layer4_ln1_2_0&#45;&gt;layer4_q_proj_2_0</title>
<path fill="none" stroke="black" d="M8202.75,-2364.06C8196.84,-2354.63 8190.62,-2344.68 8184.65,-2335.16"/>
<polygon fill="black" stroke="black" points="8187.54,-2333.17 8179.27,-2326.56 8181.61,-2336.89 8187.54,-2333.17"/>
</g>
<!-- layer4_k_proj_2_0 -->
<g id="node568" class="node">
<title>layer4_k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="8443.29,-2326.37 8262.29,-2326.37 8262.29,-2243.37 8443.29,-2243.37 8443.29,-2326.37"/>
<text text-anchor="middle" x="8352.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8352.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="8352.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8352.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8352.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_0&#45;&gt;layer4_k_proj_2_0 -->
<g id="edge1494" class="edge">
<title>layer4_ln1_2_0&#45;&gt;layer4_k_proj_2_0</title>
<path fill="none" stroke="black" d="M8275.48,-2365.47C8285.39,-2355.26 8295.96,-2344.38 8305.99,-2334.05"/>
<polygon fill="black" stroke="black" points="8308.74,-2336.25 8313.19,-2326.64 8303.71,-2331.37 8308.74,-2336.25"/>
</g>
<!-- layer4_v_proj_2_0 -->
<g id="node569" class="node">
<title>layer4_v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="8642.29,-2326.37 8461.29,-2326.37 8461.29,-2243.37 8642.29,-2243.37 8642.29,-2326.37"/>
<text text-anchor="middle" x="8551.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8551.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 0&#45;127</text>
<text text-anchor="middle" x="8551.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8551.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8551.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_0&#45;&gt;layer4_v_proj_2_0 -->
<g id="edge1495" class="edge">
<title>layer4_ln1_2_0&#45;&gt;layer4_v_proj_2_0</title>
<path fill="none" stroke="black" d="M8325,-2375.57C8362.03,-2361.57 8405.2,-2345.08 8451.82,-2326.73"/>
<polygon fill="black" stroke="black" points="8453.17,-2329.96 8461.19,-2323.03 8450.6,-2323.45 8453.17,-2329.96"/>
</g>
<!-- layer4_q_proj_2_1 -->
<g id="node570" class="node">
<title>layer4_q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="8859.29,-2326.37 8660.29,-2326.37 8660.29,-2243.37 8859.29,-2243.37 8859.29,-2326.37"/>
<text text-anchor="middle" x="8759.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8759.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="8759.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8759.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8759.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_1&#45;&gt;layer4_q_proj_2_1 -->
<g id="edge1496" class="edge">
<title>layer4_ln1_2_1&#45;&gt;layer4_q_proj_2_1</title>
<path fill="none" stroke="black" d="M8813.38,-2364.41C8806.8,-2354.76 8799.83,-2344.55 8793.18,-2334.8"/>
<polygon fill="black" stroke="black" points="8795.96,-2332.66 8787.43,-2326.38 8790.18,-2336.61 8795.96,-2332.66"/>
</g>
<!-- layer4_k_proj_2_1 -->
<g id="node571" class="node">
<title>layer4_k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="9076.29,-2326.37 8877.29,-2326.37 8877.29,-2243.37 9076.29,-2243.37 9076.29,-2326.37"/>
<text text-anchor="middle" x="8976.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8976.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="8976.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="8976.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8976.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_1&#45;&gt;layer4_k_proj_2_1 -->
<g id="edge1497" class="edge">
<title>layer4_ln1_2_1&#45;&gt;layer4_k_proj_2_1</title>
<path fill="none" stroke="black" d="M8892.07,-2365.82C8903.24,-2355.28 8915.18,-2344.01 8926.48,-2333.35"/>
<polygon fill="black" stroke="black" points="8928.92,-2335.86 8933.79,-2326.45 8924.12,-2330.77 8928.92,-2335.86"/>
</g>
<!-- layer4_v_proj_2_1 -->
<g id="node572" class="node">
<title>layer4_v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="9293.29,-2326.37 9094.29,-2326.37 9094.29,-2243.37 9293.29,-2243.37 9293.29,-2326.37"/>
<text text-anchor="middle" x="9193.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9193.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 128&#45;255</text>
<text text-anchor="middle" x="9193.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9193.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9193.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_1&#45;&gt;layer4_v_proj_2_1 -->
<g id="edge1498" class="edge">
<title>layer4_ln1_2_1&#45;&gt;layer4_v_proj_2_1</title>
<path fill="none" stroke="black" d="M8942.59,-2376.9C8983.89,-2362.59 9032.7,-2345.51 9084.4,-2326.85"/>
<polygon fill="black" stroke="black" points="9085.87,-2330.04 9094.08,-2323.35 9083.49,-2323.46 9085.87,-2330.04"/>
</g>
<!-- layer4_q_proj_2_2 -->
<g id="node573" class="node">
<title>layer4_q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9510.29,-2326.37 9311.29,-2326.37 9311.29,-2243.37 9510.29,-2243.37 9510.29,-2326.37"/>
<text text-anchor="middle" x="9410.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9410.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="9410.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9410.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9410.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_2&#45;&gt;layer4_q_proj_2_2 -->
<g id="edge1499" class="edge">
<title>layer4_ln1_2_2&#45;&gt;layer4_q_proj_2_2</title>
<path fill="none" stroke="black" d="M9464.38,-2364.41C9457.8,-2354.76 9450.83,-2344.55 9444.18,-2334.8"/>
<polygon fill="black" stroke="black" points="9446.96,-2332.66 9438.43,-2326.38 9441.18,-2336.61 9446.96,-2332.66"/>
</g>
<!-- layer4_k_proj_2_2 -->
<g id="node574" class="node">
<title>layer4_k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9727.29,-2326.37 9528.29,-2326.37 9528.29,-2243.37 9727.29,-2243.37 9727.29,-2326.37"/>
<text text-anchor="middle" x="9627.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9627.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="9627.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9627.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9627.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_2&#45;&gt;layer4_k_proj_2_2 -->
<g id="edge1500" class="edge">
<title>layer4_ln1_2_2&#45;&gt;layer4_k_proj_2_2</title>
<path fill="none" stroke="black" d="M9543.07,-2365.82C9554.24,-2355.28 9566.18,-2344.01 9577.48,-2333.35"/>
<polygon fill="black" stroke="black" points="9579.92,-2335.86 9584.79,-2326.45 9575.12,-2330.77 9579.92,-2335.86"/>
</g>
<!-- layer4_v_proj_2_2 -->
<g id="node575" class="node">
<title>layer4_v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9944.29,-2326.37 9745.29,-2326.37 9745.29,-2243.37 9944.29,-2243.37 9944.29,-2326.37"/>
<text text-anchor="middle" x="9844.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9844.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 256&#45;383</text>
<text text-anchor="middle" x="9844.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="9844.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9844.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_2&#45;&gt;layer4_v_proj_2_2 -->
<g id="edge1501" class="edge">
<title>layer4_ln1_2_2&#45;&gt;layer4_v_proj_2_2</title>
<path fill="none" stroke="black" d="M9593.59,-2376.9C9634.89,-2362.59 9683.7,-2345.51 9735.4,-2326.85"/>
<polygon fill="black" stroke="black" points="9736.87,-2330.04 9745.08,-2323.35 9734.49,-2323.46 9736.87,-2330.04"/>
</g>
<!-- layer4_q_proj_2_3 -->
<g id="node576" class="node">
<title>layer4_q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10161.29,-2326.37 9962.29,-2326.37 9962.29,-2243.37 10161.29,-2243.37 10161.29,-2326.37"/>
<text text-anchor="middle" x="10061.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10061.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="10061.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10061.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10061.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_3&#45;&gt;layer4_q_proj_2_3 -->
<g id="edge1502" class="edge">
<title>layer4_ln1_2_3&#45;&gt;layer4_q_proj_2_3</title>
<path fill="none" stroke="black" d="M10131.13,-2365.12C10122.3,-2355.03 10112.91,-2344.3 10103.99,-2334.09"/>
<polygon fill="black" stroke="black" points="10106.49,-2331.64 10097.27,-2326.41 10101.22,-2336.25 10106.49,-2331.64"/>
</g>
<!-- layer4_k_proj_2_3 -->
<g id="node577" class="node">
<title>layer4_k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10378.29,-2326.37 10179.29,-2326.37 10179.29,-2243.37 10378.29,-2243.37 10378.29,-2326.37"/>
<text text-anchor="middle" x="10278.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10278.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="10278.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10278.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10278.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_3&#45;&gt;layer4_k_proj_2_3 -->
<g id="edge1503" class="edge">
<title>layer4_ln1_2_3&#45;&gt;layer4_k_proj_2_3</title>
<path fill="none" stroke="black" d="M10210.09,-2365.12C10218.83,-2355.03 10228.14,-2344.3 10236.98,-2334.09"/>
<polygon fill="black" stroke="black" points="10239.73,-2336.26 10243.64,-2326.41 10234.44,-2331.68 10239.73,-2336.26"/>
</g>
<!-- layer4_v_proj_2_3 -->
<g id="node578" class="node">
<title>layer4_v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10595.29,-2326.37 10396.29,-2326.37 10396.29,-2243.37 10595.29,-2243.37 10595.29,-2326.37"/>
<text text-anchor="middle" x="10495.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10495.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 8&#45;11, Dim 384&#45;511</text>
<text text-anchor="middle" x="10495.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10495.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10495.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_2_3&#45;&gt;layer4_v_proj_2_3 -->
<g id="edge1504" class="edge">
<title>layer4_ln1_2_3&#45;&gt;layer4_v_proj_2_3</title>
<path fill="none" stroke="black" d="M10263.05,-2375.08C10301.54,-2360.33 10346.53,-2343.08 10386.64,-2327.71"/>
<polygon fill="black" stroke="black" points="10388.1,-2330.89 10396.19,-2324.05 10385.6,-2324.36 10388.1,-2330.89"/>
</g>
<!-- layer4_q_proj_3_0 -->
<g id="node579" class="node">
<title>layer4_q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="10803.79,-2326.37 10613.79,-2326.37 10613.79,-2243.37 10803.79,-2243.37 10803.79,-2326.37"/>
<text text-anchor="middle" x="10708.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10708.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="10708.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10708.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10708.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_0&#45;&gt;layer4_q_proj_3_0 -->
<g id="edge1505" class="edge">
<title>layer4_ln1_3_0&#45;&gt;layer4_q_proj_3_0</title>
<path fill="none" stroke="black" d="M10774.95,-2365.12C10766.53,-2355.03 10757.57,-2344.3 10749.05,-2334.09"/>
<polygon fill="black" stroke="black" points="10751.74,-2331.85 10742.64,-2326.41 10746.36,-2336.33 10751.74,-2331.85"/>
</g>
<!-- layer4_k_proj_3_0 -->
<g id="node580" class="node">
<title>layer4_k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="11011.79,-2326.37 10821.79,-2326.37 10821.79,-2243.37 11011.79,-2243.37 11011.79,-2326.37"/>
<text text-anchor="middle" x="10916.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10916.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="10916.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="10916.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10916.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_0&#45;&gt;layer4_k_proj_3_0 -->
<g id="edge1506" class="edge">
<title>layer4_ln1_3_0&#45;&gt;layer4_k_proj_3_0</title>
<path fill="none" stroke="black" d="M10850.63,-2365.12C10859.06,-2355.03 10868.01,-2344.3 10876.53,-2334.09"/>
<polygon fill="black" stroke="black" points="10879.22,-2336.33 10882.94,-2326.41 10873.85,-2331.85 10879.22,-2336.33"/>
</g>
<!-- layer4_v_proj_3_0 -->
<g id="node581" class="node">
<title>layer4_v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="11219.79,-2326.37 11029.79,-2326.37 11029.79,-2243.37 11219.79,-2243.37 11219.79,-2326.37"/>
<text text-anchor="middle" x="11124.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11124.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 0&#45;127</text>
<text text-anchor="middle" x="11124.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11124.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11124.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_0&#45;&gt;layer4_v_proj_3_0 -->
<g id="edge1507" class="edge">
<title>layer4_ln1_3_0&#45;&gt;layer4_v_proj_3_0</title>
<path fill="none" stroke="black" d="M10903.03,-2374.41C10939.62,-2359.81 10982.11,-2342.84 11020.05,-2327.69"/>
<polygon fill="black" stroke="black" points="11021.6,-2330.84 11029.59,-2323.88 11019,-2324.34 11021.6,-2330.84"/>
</g>
<!-- layer4_q_proj_3_1 -->
<g id="node582" class="node">
<title>layer4_q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="11445.79,-2326.37 11237.79,-2326.37 11237.79,-2243.37 11445.79,-2243.37 11445.79,-2326.37"/>
<text text-anchor="middle" x="11341.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11341.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="11341.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11341.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11341.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_1&#45;&gt;layer4_q_proj_3_1 -->
<g id="edge1508" class="edge">
<title>layer4_ln1_3_1&#45;&gt;layer4_q_proj_3_1</title>
<path fill="none" stroke="black" d="M11413.68,-2365.12C11404.52,-2355.03 11394.79,-2344.3 11385.54,-2334.09"/>
<polygon fill="black" stroke="black" points="11387.88,-2331.47 11378.57,-2326.41 11382.7,-2336.17 11387.88,-2331.47"/>
</g>
<!-- layer4_k_proj_3_1 -->
<g id="node583" class="node">
<title>layer4_k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="11671.79,-2326.37 11463.79,-2326.37 11463.79,-2243.37 11671.79,-2243.37 11671.79,-2326.37"/>
<text text-anchor="middle" x="11567.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11567.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="11567.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11567.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11567.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_1&#45;&gt;layer4_k_proj_3_1 -->
<g id="edge1509" class="edge">
<title>layer4_ln1_3_1&#45;&gt;layer4_k_proj_3_1</title>
<path fill="none" stroke="black" d="M11495.91,-2365.12C11505.06,-2355.03 11514.79,-2344.3 11524.05,-2334.09"/>
<polygon fill="black" stroke="black" points="11526.89,-2336.17 11531.01,-2326.41 11521.7,-2331.47 11526.89,-2336.17"/>
</g>
<!-- layer4_v_proj_3_1 -->
<g id="node584" class="node">
<title>layer4_v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="11897.79,-2326.37 11689.79,-2326.37 11689.79,-2243.37 11897.79,-2243.37 11897.79,-2326.37"/>
<text text-anchor="middle" x="11793.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11793.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 128&#45;255</text>
<text text-anchor="middle" x="11793.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="11793.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11793.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_1&#45;&gt;layer4_v_proj_3_1 -->
<g id="edge1510" class="edge">
<title>layer4_ln1_3_1&#45;&gt;layer4_v_proj_3_1</title>
<path fill="none" stroke="black" d="M11549.22,-2375.75C11589.84,-2360.82 11637.66,-2343.24 11680.2,-2327.61"/>
<polygon fill="black" stroke="black" points="11681.57,-2330.83 11689.75,-2324.1 11679.16,-2324.26 11681.57,-2330.83"/>
</g>
<!-- layer4_q_proj_3_2 -->
<g id="node585" class="node">
<title>layer4_q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12123.79,-2326.37 11915.79,-2326.37 11915.79,-2243.37 12123.79,-2243.37 12123.79,-2326.37"/>
<text text-anchor="middle" x="12019.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12019.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="12019.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12019.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12019.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_2&#45;&gt;layer4_q_proj_3_2 -->
<g id="edge1511" class="edge">
<title>layer4_ln1_3_2&#45;&gt;layer4_q_proj_3_2</title>
<path fill="none" stroke="black" d="M12091.04,-2365.12C12081.97,-2355.03 12072.32,-2344.3 12063.15,-2334.09"/>
<polygon fill="black" stroke="black" points="12065.53,-2331.51 12056.25,-2326.41 12060.33,-2336.19 12065.53,-2331.51"/>
</g>
<!-- layer4_k_proj_3_2 -->
<g id="node586" class="node">
<title>layer4_k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12349.79,-2326.37 12141.79,-2326.37 12141.79,-2243.37 12349.79,-2243.37 12349.79,-2326.37"/>
<text text-anchor="middle" x="12245.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12245.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="12245.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12245.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12245.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_2&#45;&gt;layer4_k_proj_3_2 -->
<g id="edge1512" class="edge">
<title>layer4_ln1_3_2&#45;&gt;layer4_k_proj_3_2</title>
<path fill="none" stroke="black" d="M12172.95,-2365.47C12182.29,-2355.26 12192.25,-2344.38 12201.7,-2334.05"/>
<polygon fill="black" stroke="black" points="12204.31,-2336.38 12208.48,-2326.64 12199.15,-2331.65 12204.31,-2336.38"/>
</g>
<!-- layer4_v_proj_3_2 -->
<g id="node587" class="node">
<title>layer4_v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12575.79,-2326.37 12367.79,-2326.37 12367.79,-2243.37 12575.79,-2243.37 12575.79,-2326.37"/>
<text text-anchor="middle" x="12471.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12471.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 256&#45;383</text>
<text text-anchor="middle" x="12471.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12471.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12471.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_2&#45;&gt;layer4_v_proj_3_2 -->
<g id="edge1513" class="edge">
<title>layer4_ln1_3_2&#45;&gt;layer4_v_proj_3_2</title>
<path fill="none" stroke="black" d="M12226.5,-2375.75C12267.33,-2360.78 12315.42,-2343.16 12358.15,-2327.51"/>
<polygon fill="black" stroke="black" points="12359.56,-2330.72 12367.75,-2323.99 12357.15,-2324.14 12359.56,-2330.72"/>
</g>
<!-- layer4_q_proj_3_3 -->
<g id="node588" class="node">
<title>layer4_q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12801.79,-2326.37 12593.79,-2326.37 12593.79,-2243.37 12801.79,-2243.37 12801.79,-2326.37"/>
<text text-anchor="middle" x="12697.79" y="-2311.17" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12697.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="12697.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12697.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12697.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_3&#45;&gt;layer4_q_proj_3_3 -->
<g id="edge1514" class="edge">
<title>layer4_ln1_3_3&#45;&gt;layer4_q_proj_3_3</title>
<path fill="none" stroke="black" d="M12769.68,-2365.12C12760.52,-2355.03 12750.79,-2344.3 12741.54,-2334.09"/>
<polygon fill="black" stroke="black" points="12743.88,-2331.47 12734.57,-2326.41 12738.7,-2336.17 12743.88,-2331.47"/>
</g>
<!-- layer4_k_proj_3_3 -->
<g id="node589" class="node">
<title>layer4_k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="13027.79,-2326.37 12819.79,-2326.37 12819.79,-2243.37 13027.79,-2243.37 13027.79,-2326.37"/>
<text text-anchor="middle" x="12923.79" y="-2311.17" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12923.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="12923.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="12923.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12923.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_3&#45;&gt;layer4_k_proj_3_3 -->
<g id="edge1515" class="edge">
<title>layer4_ln1_3_3&#45;&gt;layer4_k_proj_3_3</title>
<path fill="none" stroke="black" d="M12851.91,-2365.12C12861.06,-2355.03 12870.79,-2344.3 12880.05,-2334.09"/>
<polygon fill="black" stroke="black" points="12882.89,-2336.17 12887.01,-2326.41 12877.7,-2331.47 12882.89,-2336.17"/>
</g>
<!-- layer4_v_proj_3_3 -->
<g id="node590" class="node">
<title>layer4_v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="13253.79,-2326.37 13045.79,-2326.37 13045.79,-2243.37 13253.79,-2243.37 13253.79,-2326.37"/>
<text text-anchor="middle" x="13149.79" y="-2311.17" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13149.79" y="-2296.17" font-family="Times,serif" font-size="14.00">Heads 12&#45;15, Dim 384&#45;511</text>
<text text-anchor="middle" x="13149.79" y="-2281.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 512]</text>
<text text-anchor="middle" x="13149.79" y="-2266.17" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13149.79" y="-2251.17" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_ln1_3_3&#45;&gt;layer4_v_proj_3_3 -->
<g id="edge1516" class="edge">
<title>layer4_ln1_3_3&#45;&gt;layer4_v_proj_3_3</title>
<path fill="none" stroke="black" d="M12905.22,-2375.75C12945.84,-2360.82 12993.66,-2343.24 13036.2,-2327.61"/>
<polygon fill="black" stroke="black" points="13037.57,-2330.83 13045.75,-2324.1 13035.16,-2324.26 13037.57,-2330.83"/>
</g>
<!-- layer4_attention_0_0 -->
<g id="node591" class="node">
<title>layer4_attention_0_0</title>
<polygon fill="lightcoral" stroke="black" points="3577.79,-2206.37 3351.79,-2123.37 3577.79,-2040.37 3803.79,-2123.37 3577.79,-2206.37"/>
<text text-anchor="middle" x="3577.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3577.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="3577.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="3577.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="3577.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_q_proj_0_0&#45;&gt;layer4_attention_0_0 -->
<g id="edge1517" class="edge">
<title>layer4_q_proj_0_0&#45;&gt;layer4_attention_0_0</title>
<path fill="none" stroke="black" d="M3339.37,-2243.2C3380.25,-2222.83 3430.22,-2197.92 3473.82,-2176.19"/>
<polygon fill="black" stroke="black" points="3475.64,-2179.19 3483.02,-2171.6 3472.51,-2172.93 3475.64,-2179.19"/>
</g>
<!-- layer4_k_proj_0_0&#45;&gt;layer4_attention_0_0 -->
<g id="edge1518" class="edge">
<title>layer4_k_proj_0_0&#45;&gt;layer4_attention_0_0</title>
<path fill="none" stroke="black" d="M3481.68,-2243.2C3493.42,-2228.69 3507.01,-2211.88 3520.22,-2195.55"/>
<polygon fill="black" stroke="black" points="3523.09,-2197.57 3526.66,-2187.59 3517.65,-2193.16 3523.09,-2197.57"/>
</g>
<!-- layer4_v_proj_0_0&#45;&gt;layer4_attention_0_0 -->
<g id="edge1519" class="edge">
<title>layer4_v_proj_0_0&#45;&gt;layer4_attention_0_0</title>
<path fill="none" stroke="black" d="M3623.99,-2243.2C3619.51,-2231.69 3614.47,-2218.74 3609.42,-2205.72"/>
<polygon fill="black" stroke="black" points="3612.62,-2204.31 3605.74,-2196.26 3606.1,-2206.85 3612.62,-2204.31"/>
</g>
<!-- layer4_attention_0_1 -->
<g id="node592" class="node">
<title>layer4_attention_0_1</title>
<polygon fill="lightcoral" stroke="black" points="4093.79,-2206.37 3867.79,-2123.37 4093.79,-2040.37 4319.79,-2123.37 4093.79,-2206.37"/>
<text text-anchor="middle" x="4093.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4093.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="4093.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="4093.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="4093.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_q_proj_0_1&#45;&gt;layer4_attention_0_1 -->
<g id="edge1520" class="edge">
<title>layer4_q_proj_0_1&#45;&gt;layer4_attention_0_1</title>
<path fill="none" stroke="black" d="M3904.54,-2243.2C3934.36,-2224.48 3970.26,-2201.94 4002.74,-2181.54"/>
<polygon fill="black" stroke="black" points="4004.75,-2184.41 4011.36,-2176.13 4001.03,-2178.48 4004.75,-2184.41"/>
</g>
<!-- layer4_k_proj_0_1&#45;&gt;layer4_attention_0_1 -->
<g id="edge1521" class="edge">
<title>layer4_k_proj_0_1&#45;&gt;layer4_attention_0_1</title>
<path fill="none" stroke="black" d="M4059.52,-2243.2C4062.61,-2232.5 4066.05,-2220.54 4069.54,-2208.46"/>
<polygon fill="black" stroke="black" points="4072.93,-2209.33 4072.34,-2198.76 4066.2,-2207.39 4072.93,-2209.33"/>
</g>
<!-- layer4_v_proj_0_1&#45;&gt;layer4_attention_0_1 -->
<g id="edge1522" class="edge">
<title>layer4_v_proj_0_1&#45;&gt;layer4_attention_0_1</title>
<path fill="none" stroke="black" d="M4214.49,-2243.2C4198.58,-2227.54 4179.95,-2209.2 4162.16,-2191.67"/>
<polygon fill="black" stroke="black" points="4164.17,-2188.75 4154.59,-2184.23 4159.26,-2193.74 4164.17,-2188.75"/>
</g>
<!-- layer4_attention_0_2 -->
<g id="node593" class="node">
<title>layer4_attention_0_2</title>
<polygon fill="lightcoral" stroke="black" points="4671.79,-2206.37 4445.79,-2123.37 4671.79,-2040.37 4897.79,-2123.37 4671.79,-2206.37"/>
<text text-anchor="middle" x="4671.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4671.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="4671.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="4671.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="4671.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_q_proj_0_2&#45;&gt;layer4_attention_0_2 -->
<g id="edge1523" class="edge">
<title>layer4_q_proj_0_2&#45;&gt;layer4_attention_0_2</title>
<path fill="none" stroke="black" d="M4516.82,-2243.2C4539.41,-2225.88 4566.26,-2205.29 4591.22,-2186.15"/>
<polygon fill="black" stroke="black" points="4593.44,-2188.86 4599.24,-2180 4589.18,-2183.3 4593.44,-2188.86"/>
</g>
<!-- layer4_k_proj_0_2&#45;&gt;layer4_attention_0_2 -->
<g id="edge1524" class="edge">
<title>layer4_k_proj_0_2&#45;&gt;layer4_attention_0_2</title>
<path fill="none" stroke="black" d="M4671.79,-2243.2C4671.79,-2234.93 4671.79,-2225.92 4671.79,-2216.68"/>
<polygon fill="black" stroke="black" points="4675.29,-2216.58 4671.79,-2206.58 4668.29,-2216.58 4675.29,-2216.58"/>
</g>
<!-- layer4_v_proj_0_2&#45;&gt;layer4_attention_0_2 -->
<g id="edge1525" class="edge">
<title>layer4_v_proj_0_2&#45;&gt;layer4_attention_0_2</title>
<path fill="none" stroke="black" d="M4826.77,-2243.2C4804.18,-2225.88 4777.32,-2205.29 4752.37,-2186.15"/>
<polygon fill="black" stroke="black" points="4754.4,-2183.3 4744.34,-2180 4750.14,-2188.86 4754.4,-2183.3"/>
</g>
<!-- layer4_attention_0_3 -->
<g id="node594" class="node">
<title>layer4_attention_0_3</title>
<polygon fill="lightcoral" stroke="black" points="5179.79,-2206.37 4953.79,-2123.37 5179.79,-2040.37 5405.79,-2123.37 5179.79,-2206.37"/>
<text text-anchor="middle" x="5179.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5179.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="5179.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5179.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5179.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_q_proj_0_3&#45;&gt;layer4_attention_0_3 -->
<g id="edge1526" class="edge">
<title>layer4_q_proj_0_3&#45;&gt;layer4_attention_0_3</title>
<path fill="none" stroke="black" d="M5111.24,-2243.2C5118.65,-2230.36 5127.09,-2215.73 5135.46,-2201.22"/>
<polygon fill="black" stroke="black" points="5138.69,-2202.63 5140.65,-2192.22 5132.63,-2199.13 5138.69,-2202.63"/>
</g>
<!-- layer4_k_proj_0_3&#45;&gt;layer4_attention_0_3 -->
<g id="edge1527" class="edge">
<title>layer4_k_proj_0_3&#45;&gt;layer4_attention_0_3</title>
<path fill="none" stroke="black" d="M5266.22,-2243.2C5256.04,-2229.21 5244.32,-2213.09 5232.85,-2197.33"/>
<polygon fill="black" stroke="black" points="5235.6,-2195.16 5226.89,-2189.13 5229.94,-2199.27 5235.6,-2195.16"/>
</g>
<!-- layer4_v_proj_0_3&#45;&gt;layer4_attention_0_3 -->
<g id="edge1528" class="edge">
<title>layer4_v_proj_0_3&#45;&gt;layer4_attention_0_3</title>
<path fill="none" stroke="black" d="M5421.19,-2243.2C5379.62,-2222.74 5328.79,-2197.71 5284.5,-2175.91"/>
<polygon fill="black" stroke="black" points="5285.97,-2172.73 5275.45,-2171.46 5282.88,-2179.01 5285.97,-2172.73"/>
</g>
<!-- layer4_attention_1_0 -->
<g id="node595" class="node">
<title>layer4_attention_1_0</title>
<polygon fill="lightcoral" stroke="black" points="5989.79,-2206.37 5763.79,-2123.37 5989.79,-2040.37 6215.79,-2123.37 5989.79,-2206.37"/>
<text text-anchor="middle" x="5989.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5989.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="5989.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="5989.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="5989.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_q_proj_1_0&#45;&gt;layer4_attention_1_0 -->
<g id="edge1529" class="edge">
<title>layer4_q_proj_1_0&#45;&gt;layer4_attention_1_0</title>
<path fill="none" stroke="black" d="M5776.7,-2243.2C5811.71,-2223.68 5854.17,-2200 5891.94,-2178.94"/>
<polygon fill="black" stroke="black" points="5893.9,-2181.85 5900.93,-2173.92 5890.49,-2175.74 5893.9,-2181.85"/>
</g>
<!-- layer4_k_proj_1_0&#45;&gt;layer4_attention_1_0 -->
<g id="edge1530" class="edge">
<title>layer4_k_proj_1_0&#45;&gt;layer4_attention_1_0</title>
<path fill="none" stroke="black" d="M5919.01,-2243.2C5926.78,-2230.16 5935.65,-2215.27 5944.42,-2200.55"/>
<polygon fill="black" stroke="black" points="5947.45,-2202.29 5949.56,-2191.91 5941.44,-2198.71 5947.45,-2202.29"/>
</g>
<!-- layer4_v_proj_1_0&#45;&gt;layer4_attention_1_0 -->
<g id="edge1531" class="edge">
<title>layer4_v_proj_1_0&#45;&gt;layer4_attention_1_0</title>
<path fill="none" stroke="black" d="M6061.32,-2243.2C6053.42,-2230.09 6044.4,-2215.1 6035.49,-2200.28"/>
<polygon fill="black" stroke="black" points="6038.41,-2198.36 6030.26,-2191.6 6032.42,-2201.97 6038.41,-2198.36"/>
</g>
<!-- layer4_attention_1_1 -->
<g id="node596" class="node">
<title>layer4_attention_1_1</title>
<polygon fill="lightcoral" stroke="black" points="6570.79,-2206.37 6344.79,-2123.37 6570.79,-2040.37 6796.79,-2123.37 6570.79,-2206.37"/>
<text text-anchor="middle" x="6570.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6570.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="6570.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="6570.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="6570.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_q_proj_1_1&#45;&gt;layer4_attention_1_1 -->
<g id="edge1532" class="edge">
<title>layer4_q_proj_1_1&#45;&gt;layer4_attention_1_1</title>
<path fill="none" stroke="black" d="M6358.45,-2243.2C6393.33,-2223.68 6435.64,-2200 6473.28,-2178.94"/>
<polygon fill="black" stroke="black" points="6475.22,-2181.86 6482.24,-2173.92 6471.8,-2175.75 6475.22,-2181.86"/>
</g>
<!-- layer4_k_proj_1_1&#45;&gt;layer4_attention_1_1 -->
<g id="edge1533" class="edge">
<title>layer4_k_proj_1_1&#45;&gt;layer4_attention_1_1</title>
<path fill="none" stroke="black" d="M6513.42,-2243.2C6519.34,-2230.94 6526.05,-2217.03 6532.75,-2203.17"/>
<polygon fill="black" stroke="black" points="6535.94,-2204.61 6537.14,-2194.08 6529.64,-2201.56 6535.94,-2204.61"/>
</g>
<!-- layer4_v_proj_1_1&#45;&gt;layer4_attention_1_1 -->
<g id="edge1534" class="edge">
<title>layer4_v_proj_1_1&#45;&gt;layer4_attention_1_1</title>
<path fill="none" stroke="black" d="M6668.4,-2243.2C6656.47,-2228.69 6642.67,-2211.88 6629.26,-2195.55"/>
<polygon fill="black" stroke="black" points="6631.77,-2193.1 6622.72,-2187.59 6626.36,-2197.54 6631.77,-2193.1"/>
</g>
<!-- layer4_attention_1_2 -->
<g id="node597" class="node">
<title>layer4_attention_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7117.79,-2206.37 6891.79,-2123.37 7117.79,-2040.37 7343.79,-2123.37 7117.79,-2206.37"/>
<text text-anchor="middle" x="7117.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7117.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="7117.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7117.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7117.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_q_proj_1_2&#45;&gt;layer4_attention_1_2 -->
<g id="edge1535" class="edge">
<title>layer4_q_proj_1_2&#45;&gt;layer4_attention_1_2</title>
<path fill="none" stroke="black" d="M6962.82,-2243.2C6985.41,-2225.88 7012.26,-2205.29 7037.22,-2186.15"/>
<polygon fill="black" stroke="black" points="7039.44,-2188.86 7045.24,-2180 7035.18,-2183.3 7039.44,-2188.86"/>
</g>
<!-- layer4_k_proj_1_2&#45;&gt;layer4_attention_1_2 -->
<g id="edge1536" class="edge">
<title>layer4_k_proj_1_2&#45;&gt;layer4_attention_1_2</title>
<path fill="none" stroke="black" d="M7117.79,-2243.2C7117.79,-2234.93 7117.79,-2225.92 7117.79,-2216.68"/>
<polygon fill="black" stroke="black" points="7121.29,-2216.58 7117.79,-2206.58 7114.29,-2216.58 7121.29,-2216.58"/>
</g>
<!-- layer4_v_proj_1_2&#45;&gt;layer4_attention_1_2 -->
<g id="edge1537" class="edge">
<title>layer4_v_proj_1_2&#45;&gt;layer4_attention_1_2</title>
<path fill="none" stroke="black" d="M7272.77,-2243.2C7250.18,-2225.88 7223.32,-2205.29 7198.37,-2186.15"/>
<polygon fill="black" stroke="black" points="7200.4,-2183.3 7190.34,-2180 7196.14,-2188.86 7200.4,-2183.3"/>
</g>
<!-- layer4_attention_1_3 -->
<g id="node598" class="node">
<title>layer4_attention_1_3</title>
<polygon fill="lightcoral" stroke="black" points="7664.79,-2206.37 7438.79,-2123.37 7664.79,-2040.37 7890.79,-2123.37 7664.79,-2206.37"/>
<text text-anchor="middle" x="7664.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7664.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="7664.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="7664.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="7664.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_q_proj_1_3&#45;&gt;layer4_attention_1_3 -->
<g id="edge1538" class="edge">
<title>layer4_q_proj_1_3&#45;&gt;layer4_attention_1_3</title>
<path fill="none" stroke="black" d="M7567.19,-2243.2C7579.11,-2228.69 7592.92,-2211.88 7606.32,-2195.55"/>
<polygon fill="black" stroke="black" points="7609.22,-2197.54 7612.86,-2187.59 7603.81,-2193.1 7609.22,-2197.54"/>
</g>
<!-- layer4_k_proj_1_3&#45;&gt;layer4_attention_1_3 -->
<g id="edge1539" class="edge">
<title>layer4_k_proj_1_3&#45;&gt;layer4_attention_1_3</title>
<path fill="none" stroke="black" d="M7722.16,-2243.2C7716.24,-2230.94 7709.53,-2217.03 7702.83,-2203.17"/>
<polygon fill="black" stroke="black" points="7705.95,-2201.56 7698.45,-2194.08 7699.64,-2204.61 7705.95,-2201.56"/>
</g>
<!-- layer4_v_proj_1_3&#45;&gt;layer4_attention_1_3 -->
<g id="edge1540" class="edge">
<title>layer4_v_proj_1_3&#45;&gt;layer4_attention_1_3</title>
<path fill="none" stroke="black" d="M7877.14,-2243.2C7842.25,-2223.68 7799.94,-2200 7762.3,-2178.94"/>
<polygon fill="black" stroke="black" points="7763.78,-2175.75 7753.34,-2173.92 7760.36,-2181.86 7763.78,-2175.75"/>
</g>
<!-- layer4_attention_2_0 -->
<g id="node599" class="node">
<title>layer4_attention_2_0</title>
<polygon fill="lightcoral" stroke="black" points="8429.79,-2206.37 8203.79,-2123.37 8429.79,-2040.37 8655.79,-2123.37 8429.79,-2206.37"/>
<text text-anchor="middle" x="8429.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8429.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="8429.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8429.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8429.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_q_proj_2_0&#45;&gt;layer4_attention_2_0 -->
<g id="edge1541" class="edge">
<title>layer4_q_proj_2_0&#45;&gt;layer4_attention_2_0</title>
<path fill="none" stroke="black" d="M8224.15,-2243.2C8257.5,-2223.93 8297.85,-2200.61 8333.94,-2179.76"/>
<polygon fill="black" stroke="black" points="8336.11,-2182.54 8343.02,-2174.51 8332.61,-2176.48 8336.11,-2182.54"/>
</g>
<!-- layer4_k_proj_2_0&#45;&gt;layer4_attention_2_0 -->
<g id="edge1542" class="edge">
<title>layer4_k_proj_2_0&#45;&gt;layer4_attention_2_0</title>
<path fill="none" stroke="black" d="M8372.42,-2243.2C8378.34,-2230.94 8385.05,-2217.03 8391.75,-2203.17"/>
<polygon fill="black" stroke="black" points="8394.94,-2204.61 8396.14,-2194.08 8388.64,-2201.56 8394.94,-2204.61"/>
</g>
<!-- layer4_v_proj_2_0&#45;&gt;layer4_attention_2_0 -->
<g id="edge1543" class="edge">
<title>layer4_v_proj_2_0&#45;&gt;layer4_attention_2_0</title>
<path fill="none" stroke="black" d="M8520.69,-2243.2C8509.87,-2229.06 8497.38,-2212.73 8485.19,-2196.79"/>
<polygon fill="black" stroke="black" points="8487.71,-2194.33 8478.86,-2188.51 8482.15,-2198.58 8487.71,-2194.33"/>
</g>
<!-- layer4_attention_2_1 -->
<g id="node600" class="node">
<title>layer4_attention_2_1</title>
<polygon fill="lightcoral" stroke="black" points="8976.79,-2206.37 8750.79,-2123.37 8976.79,-2040.37 9202.79,-2123.37 8976.79,-2206.37"/>
<text text-anchor="middle" x="8976.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8976.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="8976.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="8976.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="8976.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_q_proj_2_1&#45;&gt;layer4_attention_2_1 -->
<g id="edge1544" class="edge">
<title>layer4_q_proj_2_1&#45;&gt;layer4_attention_2_1</title>
<path fill="none" stroke="black" d="M8815.11,-2243.2C8839.12,-2225.56 8867.75,-2204.51 8894.2,-2185.07"/>
<polygon fill="black" stroke="black" points="8896.34,-2187.84 8902.33,-2179.1 8892.2,-2182.2 8896.34,-2187.84"/>
</g>
<!-- layer4_k_proj_2_1&#45;&gt;layer4_attention_2_1 -->
<g id="edge1545" class="edge">
<title>layer4_k_proj_2_1&#45;&gt;layer4_attention_2_1</title>
<path fill="none" stroke="black" d="M8976.79,-2243.2C8976.79,-2234.93 8976.79,-2225.92 8976.79,-2216.68"/>
<polygon fill="black" stroke="black" points="8980.29,-2216.58 8976.79,-2206.58 8973.29,-2216.58 8980.29,-2216.58"/>
</g>
<!-- layer4_v_proj_2_1&#45;&gt;layer4_attention_2_1 -->
<g id="edge1546" class="edge">
<title>layer4_v_proj_2_1&#45;&gt;layer4_attention_2_1</title>
<path fill="none" stroke="black" d="M9138.47,-2243.2C9114.46,-2225.56 9085.83,-2204.51 9059.39,-2185.07"/>
<polygon fill="black" stroke="black" points="9061.39,-2182.2 9051.26,-2179.1 9057.24,-2187.84 9061.39,-2182.2"/>
</g>
<!-- layer4_attention_2_2 -->
<g id="node601" class="node">
<title>layer4_attention_2_2</title>
<polygon fill="lightcoral" stroke="black" points="9536.79,-2206.37 9310.79,-2123.37 9536.79,-2040.37 9762.79,-2123.37 9536.79,-2206.37"/>
<text text-anchor="middle" x="9536.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9536.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="9536.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="9536.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="9536.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_q_proj_2_2&#45;&gt;layer4_attention_2_2 -->
<g id="edge1547" class="edge">
<title>layer4_q_proj_2_2&#45;&gt;layer4_attention_2_2</title>
<path fill="none" stroke="black" d="M9442.91,-2243.2C9454.25,-2228.85 9467.37,-2212.25 9480.13,-2196.09"/>
<polygon fill="black" stroke="black" points="9482.91,-2198.22 9486.36,-2188.2 9477.42,-2193.88 9482.91,-2198.22"/>
</g>
<!-- layer4_k_proj_2_2&#45;&gt;layer4_attention_2_2 -->
<g id="edge1548" class="edge">
<title>layer4_k_proj_2_2&#45;&gt;layer4_attention_2_2</title>
<path fill="none" stroke="black" d="M9604.59,-2243.2C9597.27,-2230.36 9588.92,-2215.73 9580.64,-2201.22"/>
<polygon fill="black" stroke="black" points="9583.5,-2199.17 9575.5,-2192.22 9577.42,-2202.64 9583.5,-2199.17"/>
</g>
<!-- layer4_v_proj_2_2&#45;&gt;layer4_attention_2_2 -->
<g id="edge1549" class="edge">
<title>layer4_v_proj_2_2&#45;&gt;layer4_attention_2_2</title>
<path fill="none" stroke="black" d="M9766.27,-2243.2C9727.5,-2223.13 9680.25,-2198.66 9638.72,-2177.15"/>
<polygon fill="black" stroke="black" points="9640.17,-2173.96 9629.68,-2172.47 9636.95,-2180.18 9640.17,-2173.96"/>
</g>
<!-- layer4_attention_2_3 -->
<g id="node602" class="node">
<title>layer4_attention_2_3</title>
<polygon fill="lightcoral" stroke="black" points="10170.79,-2206.37 9944.79,-2123.37 10170.79,-2040.37 10396.79,-2123.37 10170.79,-2206.37"/>
<text text-anchor="middle" x="10170.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10170.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="10170.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="10170.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="10170.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_q_proj_2_3&#45;&gt;layer4_attention_2_3 -->
<g id="edge1550" class="edge">
<title>layer4_q_proj_2_3&#45;&gt;layer4_attention_2_3</title>
<path fill="none" stroke="black" d="M10089.58,-2243.2C10098.89,-2229.58 10109.59,-2213.92 10120.09,-2198.55"/>
<polygon fill="black" stroke="black" points="10123.15,-2200.28 10125.9,-2190.05 10117.37,-2196.33 10123.15,-2200.28"/>
</g>
<!-- layer4_k_proj_2_3&#45;&gt;layer4_attention_2_3 -->
<g id="edge1551" class="edge">
<title>layer4_k_proj_2_3&#45;&gt;layer4_attention_2_3</title>
<path fill="none" stroke="black" d="M10251.26,-2243.2C10242.03,-2229.58 10231.43,-2213.92 10221.02,-2198.55"/>
<polygon fill="black" stroke="black" points="10223.77,-2196.37 10215.27,-2190.05 10217.98,-2200.29 10223.77,-2196.37"/>
</g>
<!-- layer4_v_proj_2_3&#45;&gt;layer4_attention_2_3 -->
<g id="edge1552" class="edge">
<title>layer4_v_proj_2_3&#45;&gt;layer4_attention_2_3</title>
<path fill="none" stroke="black" d="M10412.94,-2243.2C10371.15,-2222.7 10320.03,-2197.61 10275.55,-2175.78"/>
<polygon fill="black" stroke="black" points="10276.97,-2172.58 10266.45,-2171.31 10273.89,-2178.86 10276.97,-2172.58"/>
</g>
<!-- layer4_attention_3_0 -->
<g id="node603" class="node">
<title>layer4_attention_3_0</title>
<polygon fill="lightcoral" stroke="black" points="11007.79,-2206.37 10781.79,-2123.37 11007.79,-2040.37 11233.79,-2123.37 11007.79,-2206.37"/>
<text text-anchor="middle" x="11007.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11007.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="11007.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11007.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11007.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_q_proj_3_0&#45;&gt;layer4_attention_3_0 -->
<g id="edge1553" class="edge">
<title>layer4_q_proj_3_0&#45;&gt;layer4_attention_3_0</title>
<path fill="none" stroke="black" d="M10785.02,-2243.2C10822.25,-2223.34 10867.55,-2199.18 10907.55,-2177.84"/>
<polygon fill="black" stroke="black" points="10909.35,-2180.84 10916.53,-2173.05 10906.06,-2174.67 10909.35,-2180.84"/>
</g>
<!-- layer4_k_proj_3_0&#45;&gt;layer4_attention_3_0 -->
<g id="edge1554" class="edge">
<title>layer4_k_proj_3_0&#45;&gt;layer4_attention_3_0</title>
<path fill="none" stroke="black" d="M10939.99,-2243.2C10947.32,-2230.36 10955.67,-2215.73 10963.94,-2201.22"/>
<polygon fill="black" stroke="black" points="10967.16,-2202.64 10969.08,-2192.22 10961.08,-2199.17 10967.16,-2202.64"/>
</g>
<!-- layer4_v_proj_3_0&#45;&gt;layer4_attention_3_0 -->
<g id="edge1555" class="edge">
<title>layer4_v_proj_3_0&#45;&gt;layer4_attention_3_0</title>
<path fill="none" stroke="black" d="M11094.96,-2243.2C11084.7,-2229.21 11072.88,-2213.09 11061.31,-2197.33"/>
<polygon fill="black" stroke="black" points="11064.03,-2195.12 11055.3,-2189.13 11058.39,-2199.26 11064.03,-2195.12"/>
</g>
<!-- layer4_attention_3_1 -->
<g id="node604" class="node">
<title>layer4_attention_3_1</title>
<polygon fill="lightcoral" stroke="black" points="11567.79,-2206.37 11341.79,-2123.37 11567.79,-2040.37 11793.79,-2123.37 11567.79,-2206.37"/>
<text text-anchor="middle" x="11567.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11567.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="11567.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="11567.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="11567.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_q_proj_3_1&#45;&gt;layer4_attention_3_1 -->
<g id="edge1556" class="edge">
<title>layer4_q_proj_3_1&#45;&gt;layer4_attention_3_1</title>
<path fill="none" stroke="black" d="M11399.41,-2243.2C11424.76,-2225.31 11455.05,-2203.93 11482.91,-2184.27"/>
<polygon fill="black" stroke="black" points="11484.93,-2187.13 11491.08,-2178.5 11480.9,-2181.41 11484.93,-2187.13"/>
</g>
<!-- layer4_k_proj_3_1&#45;&gt;layer4_attention_3_1 -->
<g id="edge1557" class="edge">
<title>layer4_k_proj_3_1&#45;&gt;layer4_attention_3_1</title>
<path fill="none" stroke="black" d="M11567.79,-2243.2C11567.79,-2234.93 11567.79,-2225.92 11567.79,-2216.68"/>
<polygon fill="black" stroke="black" points="11571.29,-2216.58 11567.79,-2206.58 11564.29,-2216.58 11571.29,-2216.58"/>
</g>
<!-- layer4_v_proj_3_1&#45;&gt;layer4_attention_3_1 -->
<g id="edge1558" class="edge">
<title>layer4_v_proj_3_1&#45;&gt;layer4_attention_3_1</title>
<path fill="none" stroke="black" d="M11736.18,-2243.2C11710.82,-2225.31 11680.53,-2203.93 11652.67,-2184.27"/>
<polygon fill="black" stroke="black" points="11654.69,-2181.41 11644.5,-2178.5 11650.65,-2187.13 11654.69,-2181.41"/>
</g>
<!-- layer4_attention_3_2 -->
<g id="node605" class="node">
<title>layer4_attention_3_2</title>
<polygon fill="lightcoral" stroke="black" points="12132.79,-2206.37 11906.79,-2123.37 12132.79,-2040.37 12358.79,-2123.37 12132.79,-2206.37"/>
<text text-anchor="middle" x="12132.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12132.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="12132.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12132.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12132.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_q_proj_3_2&#45;&gt;layer4_attention_3_2 -->
<g id="edge1559" class="edge">
<title>layer4_q_proj_3_2&#45;&gt;layer4_attention_3_2</title>
<path fill="none" stroke="black" d="M12048.6,-2243.2C12058.36,-2229.42 12069.6,-2213.57 12080.61,-2198.02"/>
<polygon fill="black" stroke="black" points="12083.77,-2199.62 12086.69,-2189.43 12078.05,-2195.57 12083.77,-2199.62"/>
</g>
<!-- layer4_k_proj_3_2&#45;&gt;layer4_attention_3_2 -->
<g id="edge1560" class="edge">
<title>layer4_k_proj_3_2&#45;&gt;layer4_attention_3_2</title>
<path fill="none" stroke="black" d="M12216.98,-2243.2C12207.22,-2229.42 12195.99,-2213.57 12184.98,-2198.02"/>
<polygon fill="black" stroke="black" points="12187.53,-2195.57 12178.89,-2189.43 12181.82,-2199.62 12187.53,-2195.57"/>
</g>
<!-- layer4_v_proj_3_2&#45;&gt;layer4_attention_3_2 -->
<g id="edge1561" class="edge">
<title>layer4_v_proj_3_2&#45;&gt;layer4_attention_3_2</title>
<path fill="none" stroke="black" d="M12385.37,-2243.2C12341.14,-2222.39 12286.88,-2196.87 12240.01,-2174.81"/>
<polygon fill="black" stroke="black" points="12241.28,-2171.54 12230.74,-2170.45 12238.3,-2177.87 12241.28,-2171.54"/>
</g>
<!-- layer4_attention_3_3 -->
<g id="node606" class="node">
<title>layer4_attention_3_3</title>
<polygon fill="lightcoral" stroke="black" points="12810.79,-2206.37 12584.79,-2123.37 12810.79,-2040.37 13036.79,-2123.37 12810.79,-2206.37"/>
<text text-anchor="middle" x="12810.79" y="-2149.67" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12810.79" y="-2134.67" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="12810.79" y="-2119.67" font-family="Times,serif" font-size="14.00">QK^T: [1024, 4, L, L]</text>
<text text-anchor="middle" x="12810.79" y="-2104.67" font-family="Times,serif" font-size="14.00">Attn: [1024, 4, L, 128]</text>
<text text-anchor="middle" x="12810.79" y="-2089.67" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_q_proj_3_3&#45;&gt;layer4_attention_3_3 -->
<g id="edge1562" class="edge">
<title>layer4_q_proj_3_3&#45;&gt;layer4_attention_3_3</title>
<path fill="none" stroke="black" d="M12726.6,-2243.2C12736.36,-2229.42 12747.6,-2213.57 12758.61,-2198.02"/>
<polygon fill="black" stroke="black" points="12761.77,-2199.62 12764.69,-2189.43 12756.05,-2195.57 12761.77,-2199.62"/>
</g>
<!-- layer4_k_proj_3_3&#45;&gt;layer4_attention_3_3 -->
<g id="edge1563" class="edge">
<title>layer4_k_proj_3_3&#45;&gt;layer4_attention_3_3</title>
<path fill="none" stroke="black" d="M12894.98,-2243.2C12885.22,-2229.42 12873.99,-2213.57 12862.98,-2198.02"/>
<polygon fill="black" stroke="black" points="12865.53,-2195.57 12856.89,-2189.43 12859.82,-2199.62 12865.53,-2195.57"/>
</g>
<!-- layer4_v_proj_3_3&#45;&gt;layer4_attention_3_3 -->
<g id="edge1564" class="edge">
<title>layer4_v_proj_3_3&#45;&gt;layer4_attention_3_3</title>
<path fill="none" stroke="black" d="M13063.37,-2243.2C13019.14,-2222.39 12964.88,-2196.87 12918.01,-2174.81"/>
<polygon fill="black" stroke="black" points="12919.28,-2171.54 12908.74,-2170.45 12916.3,-2177.87 12919.28,-2171.54"/>
</g>
<!-- layer4_concat_dim_0 -->
<g id="node607" class="node">
<title>layer4_concat_dim_0</title>
<polygon fill="orange" stroke="black" points="4807.87,-2003.37 4535.72,-2003.37 4438.79,-1867.37 4904.79,-1867.37 4807.87,-2003.37"/>
<text text-anchor="middle" x="4671.79" y="-1954.17" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="4671.79" y="-1939.17" font-family="Times,serif" font-size="14.00">HeadGroup:0</text>
<text text-anchor="middle" x="4671.79" y="-1924.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="4671.79" y="-1909.17" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3 (communication)</text>
</g>
<!-- layer4_attention_0_0&#45;&gt;layer4_concat_dim_0 -->
<g id="edge1565" class="edge">
<title>layer4_attention_0_0&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M3695.7,-2083.49C3745.57,-2068.22 3804.56,-2051.67 3858.79,-2040.37 4072.5,-1995.8 4322.03,-1967.3 4487.71,-1951.61"/>
<polygon fill="black" stroke="black" points="4488.38,-1955.07 4498.01,-1950.65 4487.72,-1948.1 4488.38,-1955.07"/>
</g>
<!-- layer4_attention_0_1&#45;&gt;layer4_concat_dim_0 -->
<g id="edge1566" class="edge">
<title>layer4_attention_0_1&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M4212.85,-2084.05C4299.44,-2056.19 4417.58,-2018.17 4512.32,-1987.68"/>
<polygon fill="black" stroke="black" points="4513.55,-1990.96 4521.99,-1984.57 4511.4,-1984.3 4513.55,-1990.96"/>
</g>
<!-- layer4_attention_0_2&#45;&gt;layer4_concat_dim_0 -->
<g id="edge1567" class="edge">
<title>layer4_attention_0_2&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M4671.79,-2040.24C4671.79,-2031.43 4671.79,-2022.48 4671.79,-2013.73"/>
<polygon fill="black" stroke="black" points="4675.29,-2013.56 4671.79,-2003.56 4668.29,-2013.56 4675.29,-2013.56"/>
</g>
<!-- layer4_attention_0_3&#45;&gt;layer4_concat_dim_0 -->
<g id="edge1568" class="edge">
<title>layer4_attention_0_3&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M5067.68,-2081.32C4997.06,-2055.46 4904.91,-2021.72 4827.28,-1993.3"/>
<polygon fill="black" stroke="black" points="4828.48,-1990.01 4817.89,-1989.86 4826.07,-1996.58 4828.48,-1990.01"/>
</g>
<!-- layer4_concat_dim_1 -->
<g id="node608" class="node">
<title>layer4_concat_dim_1</title>
<polygon fill="orange" stroke="black" points="7253.87,-2003.37 6981.72,-2003.37 6884.79,-1867.37 7350.79,-1867.37 7253.87,-2003.37"/>
<text text-anchor="middle" x="7117.79" y="-1954.17" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="7117.79" y="-1939.17" font-family="Times,serif" font-size="14.00">HeadGroup:1</text>
<text text-anchor="middle" x="7117.79" y="-1924.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7117.79" y="-1909.17" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7 (communication)</text>
</g>
<!-- layer4_attention_1_0&#45;&gt;layer4_concat_dim_1 -->
<g id="edge1569" class="edge">
<title>layer4_attention_1_0&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M6120.16,-2088.19C6184.71,-2072.12 6264,-2053.61 6335.79,-2040.37 6540.23,-2002.64 6777.17,-1973.09 6936.18,-1955.28"/>
<polygon fill="black" stroke="black" points="6936.99,-1958.71 6946.54,-1954.13 6936.21,-1951.76 6936.99,-1958.71"/>
</g>
<!-- layer4_attention_1_1&#45;&gt;layer4_concat_dim_1 -->
<g id="edge1570" class="edge">
<title>layer4_attention_1_1&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M6686.8,-2082.92C6766.29,-2055.89 6872.72,-2019.7 6959.93,-1990.04"/>
<polygon fill="black" stroke="black" points="6961.31,-1993.27 6969.65,-1986.74 6959.06,-1986.64 6961.31,-1993.27"/>
</g>
<!-- layer4_attention_1_2&#45;&gt;layer4_concat_dim_1 -->
<g id="edge1571" class="edge">
<title>layer4_attention_1_2&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M7117.79,-2040.24C7117.79,-2031.43 7117.79,-2022.48 7117.79,-2013.73"/>
<polygon fill="black" stroke="black" points="7121.29,-2013.56 7117.79,-2003.56 7114.29,-2013.56 7121.29,-2013.56"/>
</g>
<!-- layer4_attention_1_3&#45;&gt;layer4_concat_dim_1 -->
<g id="edge1572" class="edge">
<title>layer4_attention_1_3&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M7548.79,-2082.92C7469.29,-2055.89 7362.86,-2019.7 7275.65,-1990.04"/>
<polygon fill="black" stroke="black" points="7276.52,-1986.64 7265.93,-1986.74 7274.27,-1993.27 7276.52,-1986.64"/>
</g>
<!-- layer4_concat_dim_2 -->
<g id="node609" class="node">
<title>layer4_concat_dim_2</title>
<polygon fill="orange" stroke="black" points="9112.87,-2003.37 8840.72,-2003.37 8743.79,-1867.37 9209.79,-1867.37 9112.87,-2003.37"/>
<text text-anchor="middle" x="8976.79" y="-1954.17" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="8976.79" y="-1939.17" font-family="Times,serif" font-size="14.00">HeadGroup:2</text>
<text text-anchor="middle" x="8976.79" y="-1924.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8976.79" y="-1909.17" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11 (communication)</text>
</g>
<!-- layer4_attention_2_0&#45;&gt;layer4_concat_dim_2 -->
<g id="edge1573" class="edge">
<title>layer4_attention_2_0&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M8545.8,-2082.92C8625.29,-2055.89 8731.72,-2019.7 8818.93,-1990.04"/>
<polygon fill="black" stroke="black" points="8820.31,-1993.27 8828.65,-1986.74 8818.06,-1986.64 8820.31,-1993.27"/>
</g>
<!-- layer4_attention_2_1&#45;&gt;layer4_concat_dim_2 -->
<g id="edge1574" class="edge">
<title>layer4_attention_2_1&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M8976.79,-2040.24C8976.79,-2031.43 8976.79,-2022.48 8976.79,-2013.73"/>
<polygon fill="black" stroke="black" points="8980.29,-2013.56 8976.79,-2003.56 8973.29,-2013.56 8980.29,-2013.56"/>
</g>
<!-- layer4_attention_2_2&#45;&gt;layer4_concat_dim_2 -->
<g id="edge1575" class="edge">
<title>layer4_attention_2_2&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M9419.4,-2083.37C9336.85,-2055.95 9225.44,-2018.95 9135.05,-1988.93"/>
<polygon fill="black" stroke="black" points="9136.13,-1985.6 9125.53,-1985.77 9133.92,-1992.24 9136.13,-1985.6"/>
</g>
<!-- layer4_attention_2_3&#45;&gt;layer4_concat_dim_2 -->
<g id="edge1576" class="edge">
<title>layer4_attention_2_3&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M10031.84,-2091.23C9955.36,-2074.74 9858.62,-2054.95 9771.79,-2040.37 9561.87,-2005.11 9319.06,-1974.86 9157.56,-1956.22"/>
<polygon fill="black" stroke="black" points="9157.86,-1952.73 9147.53,-1955.07 9157.06,-1959.69 9157.86,-1952.73"/>
</g>
<!-- layer4_concat_dim_3 -->
<g id="node610" class="node">
<title>layer4_concat_dim_3</title>
<polygon fill="orange" stroke="black" points="11703.87,-2003.37 11431.72,-2003.37 11334.79,-1867.37 11800.79,-1867.37 11703.87,-2003.37"/>
<text text-anchor="middle" x="11567.79" y="-1954.17" font-family="Times,serif" font-size="14.00">Concatenate Dimension Slices</text>
<text text-anchor="middle" x="11567.79" y="-1939.17" font-family="Times,serif" font-size="14.00">HeadGroup:3</text>
<text text-anchor="middle" x="11567.79" y="-1924.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="11567.79" y="-1909.17" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15 (communication)</text>
</g>
<!-- layer4_attention_3_0&#45;&gt;layer4_concat_dim_3 -->
<g id="edge1577" class="edge">
<title>layer4_attention_3_0&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M11125.19,-2083.37C11207.74,-2055.95 11319.15,-2018.95 11409.53,-1988.93"/>
<polygon fill="black" stroke="black" points="11410.66,-1992.24 11419.05,-1985.77 11408.46,-1985.6 11410.66,-1992.24"/>
</g>
<!-- layer4_attention_3_1&#45;&gt;layer4_concat_dim_3 -->
<g id="edge1578" class="edge">
<title>layer4_attention_3_1&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M11567.79,-2040.24C11567.79,-2031.43 11567.79,-2022.48 11567.79,-2013.73"/>
<polygon fill="black" stroke="black" points="11571.29,-2013.56 11567.79,-2003.56 11564.29,-2013.56 11571.29,-2013.56"/>
</g>
<!-- layer4_attention_3_2&#45;&gt;layer4_concat_dim_3 -->
<g id="edge1579" class="edge">
<title>layer4_attention_3_2&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M12015.04,-2083.6C11931.4,-2056.07 11818.16,-2018.79 11726.55,-1988.63"/>
<polygon fill="black" stroke="black" points="11727.5,-1985.26 11716.91,-1985.46 11725.31,-1991.91 11727.5,-1985.26"/>
</g>
<!-- layer4_attention_3_3&#45;&gt;layer4_concat_dim_3 -->
<g id="edge1580" class="edge">
<title>layer4_attention_3_3&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M12665.98,-2093.53C12579.6,-2076.84 12467.66,-2056.09 12367.79,-2040.37 12155.54,-2006.95 11910.38,-1976.23 11747.98,-1956.98"/>
<polygon fill="black" stroke="black" points="11748.23,-1953.49 11737.89,-1955.79 11747.41,-1960.44 11748.23,-1953.49"/>
</g>
<!-- layer4_concat_heads -->
<g id="node611" class="node">
<title>layer4_concat_heads</title>
<polygon fill="gold" stroke="black" points="7706.93,-1830.37 7468.65,-1830.37 7383.79,-1724.37 7791.79,-1724.37 7706.93,-1830.37"/>
<text text-anchor="middle" x="7587.79" y="-1788.67" font-family="Times,serif" font-size="14.00">Concatenate Head Groups</text>
<text text-anchor="middle" x="7587.79" y="-1773.67" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7587.79" y="-1758.67" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllGather)</text>
</g>
<!-- layer4_concat_dim_0&#45;&gt;layer4_concat_heads -->
<g id="edge1581" class="edge">
<title>layer4_concat_dim_0&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M4864.53,-1924.05C5403.5,-1895.22 6919.6,-1814.11 7423,-1787.18"/>
<polygon fill="black" stroke="black" points="7423.45,-1790.66 7433.25,-1786.63 7423.08,-1783.67 7423.45,-1790.66"/>
</g>
<!-- layer4_concat_dim_1&#45;&gt;layer4_concat_heads -->
<g id="edge1582" class="edge">
<title>layer4_concat_dim_1&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M7319.84,-1867.3C7364.16,-1852.59 7410.07,-1837.35 7451.11,-1823.73"/>
<polygon fill="black" stroke="black" points="7452.21,-1827.05 7460.6,-1820.58 7450.01,-1820.41 7452.21,-1827.05"/>
</g>
<!-- layer4_concat_dim_2&#45;&gt;layer4_concat_heads -->
<g id="edge1583" class="edge">
<title>layer4_concat_dim_2&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M8775.19,-1911.72C8496.49,-1880.42 7999.25,-1824.58 7745.79,-1796.11"/>
<polygon fill="black" stroke="black" points="7746.09,-1792.62 7735.76,-1794.98 7745.3,-1799.58 7746.09,-1792.62"/>
</g>
<!-- layer4_concat_dim_3&#45;&gt;layer4_concat_heads -->
<g id="edge1584" class="edge">
<title>layer4_concat_dim_3&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M11377.17,-1926.89C10696.75,-1900.22 8394.14,-1809.97 7754.08,-1784.88"/>
<polygon fill="black" stroke="black" points="7753.98,-1781.38 7743.85,-1784.48 7753.71,-1788.37 7753.98,-1781.38"/>
</g>
<!-- layer4_o_proj_0_0 -->
<g id="node612" class="node">
<title>layer4_o_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="6066.79,-1687.37 5868.79,-1687.37 5868.79,-1604.37 6066.79,-1604.37 6066.79,-1687.37"/>
<text text-anchor="middle" x="5967.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5967.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:0</text>
<text text-anchor="middle" x="5967.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="5967.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="5967.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_0_0 -->
<g id="edge1585" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_0_0</title>
<path fill="none" stroke="black" d="M7422.33,-1772.87C7089.19,-1764.82 6347.1,-1741.53 6076.72,-1687.33"/>
<polygon fill="black" stroke="black" points="6077.41,-1683.9 6066.91,-1685.31 6076,-1690.76 6077.41,-1683.9"/>
</g>
<!-- layer4_o_proj_0_1 -->
<g id="node613" class="node">
<title>layer4_o_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="6282.79,-1687.37 6084.79,-1687.37 6084.79,-1604.37 6282.79,-1604.37 6282.79,-1687.37"/>
<text text-anchor="middle" x="6183.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6183.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:1</text>
<text text-anchor="middle" x="6183.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6183.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="6183.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_0_1 -->
<g id="edge1586" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_0_1</title>
<path fill="none" stroke="black" d="M7420.86,-1770.92C7125.31,-1760.29 6520.46,-1733.86 6292.82,-1687.36"/>
<polygon fill="black" stroke="black" points="6293.42,-1683.91 6282.92,-1685.27 6291.98,-1690.76 6293.42,-1683.91"/>
</g>
<!-- layer4_o_proj_0_2 -->
<g id="node614" class="node">
<title>layer4_o_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="6498.79,-1687.37 6300.79,-1687.37 6300.79,-1604.37 6498.79,-1604.37 6498.79,-1687.37"/>
<text text-anchor="middle" x="6399.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6399.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:2</text>
<text text-anchor="middle" x="6399.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6399.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6399.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_0_2 -->
<g id="edge1587" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_0_2</title>
<path fill="none" stroke="black" d="M7425.59,-1776.87C7214.65,-1774.42 6835.55,-1759.38 6509.06,-1687.47"/>
<polygon fill="black" stroke="black" points="6509.45,-1683.97 6498.93,-1685.22 6507.93,-1690.81 6509.45,-1683.97"/>
</g>
<!-- layer4_o_proj_0_3 -->
<g id="node615" class="node">
<title>layer4_o_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="6714.79,-1687.37 6516.79,-1687.37 6516.79,-1604.37 6714.79,-1604.37 6714.79,-1687.37"/>
<text text-anchor="middle" x="6615.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6615.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:0, DimSlice:3</text>
<text text-anchor="middle" x="6615.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6615.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="6615.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_0_3 -->
<g id="edge1588" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_0_3</title>
<path fill="none" stroke="black" d="M7421.68,-1771.84C7248.49,-1764.26 6969.8,-1743.94 6724.75,-1687.42"/>
<polygon fill="black" stroke="black" points="6725.48,-1684 6714.95,-1685.14 6723.89,-1690.82 6725.48,-1684"/>
</g>
<!-- layer4_o_proj_1_0 -->
<g id="node616" class="node">
<title>layer4_o_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6930.79,-1687.37 6732.79,-1687.37 6732.79,-1604.37 6930.79,-1604.37 6930.79,-1687.37"/>
<text text-anchor="middle" x="6831.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6831.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:0</text>
<text text-anchor="middle" x="6831.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="6831.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6831.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_1_0 -->
<g id="edge1589" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_1_0</title>
<path fill="none" stroke="black" d="M7414.57,-1763.11C7285.47,-1750.76 7105.25,-1728.28 6940.79,-1687.47"/>
<polygon fill="black" stroke="black" points="6941.53,-1684.05 6930.98,-1685.01 6939.83,-1690.83 6941.53,-1684.05"/>
</g>
<!-- layer4_o_proj_1_1 -->
<g id="node617" class="node">
<title>layer4_o_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="7146.79,-1687.37 6948.79,-1687.37 6948.79,-1604.37 7146.79,-1604.37 7146.79,-1687.37"/>
<text text-anchor="middle" x="7047.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7047.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:1</text>
<text text-anchor="middle" x="7047.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7047.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7047.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_1_1 -->
<g id="edge1590" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_1_1</title>
<path fill="none" stroke="black" d="M7399.65,-1744.21C7326.14,-1730 7241.26,-1711.57 7156.81,-1687.55"/>
<polygon fill="black" stroke="black" points="7157.63,-1684.14 7147.05,-1684.75 7155.7,-1690.87 7157.63,-1684.14"/>
</g>
<!-- layer4_o_proj_1_2 -->
<g id="node618" class="node">
<title>layer4_o_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="7362.79,-1687.37 7164.79,-1687.37 7164.79,-1604.37 7362.79,-1604.37 7362.79,-1687.37"/>
<text text-anchor="middle" x="7263.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7263.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:2</text>
<text text-anchor="middle" x="7263.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7263.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7263.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_1_2 -->
<g id="edge1591" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_1_2</title>
<path fill="none" stroke="black" d="M7457.41,-1724.25C7429.25,-1713 7399.77,-1701.22 7372.55,-1690.33"/>
<polygon fill="black" stroke="black" points="7373.6,-1686.99 7363.02,-1686.52 7371,-1693.49 7373.6,-1686.99"/>
</g>
<!-- layer4_o_proj_1_3 -->
<g id="node619" class="node">
<title>layer4_o_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="7578.79,-1687.37 7380.79,-1687.37 7380.79,-1604.37 7578.79,-1604.37 7578.79,-1687.37"/>
<text text-anchor="middle" x="7479.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7479.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:1, DimSlice:3</text>
<text text-anchor="middle" x="7479.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7479.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="7479.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_1_3 -->
<g id="edge1592" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_1_3</title>
<path fill="none" stroke="black" d="M7544.17,-1724.07C7536.22,-1714.52 7527.95,-1704.61 7520.09,-1695.19"/>
<polygon fill="black" stroke="black" points="7522.7,-1692.85 7513.6,-1687.41 7517.32,-1697.33 7522.7,-1692.85"/>
</g>
<!-- layer4_o_proj_2_0 -->
<g id="node620" class="node">
<title>layer4_o_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="7794.79,-1687.37 7596.79,-1687.37 7596.79,-1604.37 7794.79,-1604.37 7794.79,-1687.37"/>
<text text-anchor="middle" x="7695.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7695.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:0</text>
<text text-anchor="middle" x="7695.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7695.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7695.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_2_0 -->
<g id="edge1593" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_2_0</title>
<path fill="none" stroke="black" d="M7631.41,-1724.07C7639.37,-1714.52 7647.64,-1704.61 7655.49,-1695.19"/>
<polygon fill="black" stroke="black" points="7658.26,-1697.33 7661.98,-1687.41 7652.89,-1692.85 7658.26,-1697.33"/>
</g>
<!-- layer4_o_proj_2_1 -->
<g id="node621" class="node">
<title>layer4_o_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="8010.79,-1687.37 7812.79,-1687.37 7812.79,-1604.37 8010.79,-1604.37 8010.79,-1687.37"/>
<text text-anchor="middle" x="7911.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7911.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:1</text>
<text text-anchor="middle" x="7911.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="7911.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7911.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_2_1 -->
<g id="edge1594" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_2_1</title>
<path fill="none" stroke="black" d="M7718.17,-1724.25C7746.33,-1713 7775.81,-1701.22 7803.04,-1690.33"/>
<polygon fill="black" stroke="black" points="7804.58,-1693.49 7812.57,-1686.52 7801.98,-1686.99 7804.58,-1693.49"/>
</g>
<!-- layer4_o_proj_2_2 -->
<g id="node622" class="node">
<title>layer4_o_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="8226.79,-1687.37 8028.79,-1687.37 8028.79,-1604.37 8226.79,-1604.37 8226.79,-1687.37"/>
<text text-anchor="middle" x="8127.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8127.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:2</text>
<text text-anchor="middle" x="8127.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8127.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8127.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_2_2 -->
<g id="edge1595" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_2_2</title>
<path fill="none" stroke="black" d="M7775.93,-1744.21C7849.44,-1730 7934.33,-1711.57 8018.77,-1687.55"/>
<polygon fill="black" stroke="black" points="8019.89,-1690.87 8028.53,-1684.75 8017.96,-1684.14 8019.89,-1690.87"/>
</g>
<!-- layer4_o_proj_2_3 -->
<g id="node623" class="node">
<title>layer4_o_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="8442.79,-1687.37 8244.79,-1687.37 8244.79,-1604.37 8442.79,-1604.37 8442.79,-1687.37"/>
<text text-anchor="middle" x="8343.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8343.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:2, DimSlice:3</text>
<text text-anchor="middle" x="8343.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8343.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="8343.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_2_3 -->
<g id="edge1596" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_2_3</title>
<path fill="none" stroke="black" d="M7761.01,-1763.11C7890.12,-1750.76 8070.33,-1728.28 8234.79,-1687.47"/>
<polygon fill="black" stroke="black" points="8235.75,-1690.83 8244.6,-1685.01 8234.05,-1684.05 8235.75,-1690.83"/>
</g>
<!-- layer4_o_proj_3_0 -->
<g id="node624" class="node">
<title>layer4_o_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="8658.79,-1687.37 8460.79,-1687.37 8460.79,-1604.37 8658.79,-1604.37 8658.79,-1687.37"/>
<text text-anchor="middle" x="8559.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8559.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:0</text>
<text text-anchor="middle" x="8559.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8559.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="8559.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_3_0 -->
<g id="edge1597" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_3_0</title>
<path fill="none" stroke="black" d="M7753.9,-1771.84C7927.1,-1764.26 8205.78,-1743.94 8450.83,-1687.42"/>
<polygon fill="black" stroke="black" points="8451.69,-1690.82 8460.63,-1685.14 8450.1,-1684 8451.69,-1690.82"/>
</g>
<!-- layer4_o_proj_3_1 -->
<g id="node625" class="node">
<title>layer4_o_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="8874.79,-1687.37 8676.79,-1687.37 8676.79,-1604.37 8874.79,-1604.37 8874.79,-1687.37"/>
<text text-anchor="middle" x="8775.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8775.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:1</text>
<text text-anchor="middle" x="8775.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8775.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="8775.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_3_1 -->
<g id="edge1598" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_3_1</title>
<path fill="none" stroke="black" d="M7749.99,-1776.87C7960.93,-1774.42 8340.03,-1759.38 8666.52,-1687.47"/>
<polygon fill="black" stroke="black" points="8667.65,-1690.81 8676.65,-1685.22 8666.13,-1683.97 8667.65,-1690.81"/>
</g>
<!-- layer4_o_proj_3_2 -->
<g id="node626" class="node">
<title>layer4_o_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="9090.79,-1687.37 8892.79,-1687.37 8892.79,-1604.37 9090.79,-1604.37 9090.79,-1687.37"/>
<text text-anchor="middle" x="8991.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8991.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:2</text>
<text text-anchor="middle" x="8991.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="8991.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8991.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_3_2 -->
<g id="edge1599" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_3_2</title>
<path fill="none" stroke="black" d="M7754.72,-1770.92C8050.28,-1760.29 8655.12,-1733.86 8882.76,-1687.36"/>
<polygon fill="black" stroke="black" points="8883.6,-1690.76 8892.66,-1685.27 8882.16,-1683.91 8883.6,-1690.76"/>
</g>
<!-- layer4_o_proj_3_3 -->
<g id="node627" class="node">
<title>layer4_o_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="9306.79,-1687.37 9108.79,-1687.37 9108.79,-1604.37 9306.79,-1604.37 9306.79,-1687.37"/>
<text text-anchor="middle" x="9207.79" y="-1672.17" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9207.79" y="-1657.17" font-family="Times,serif" font-size="14.00">HeadGroup:3, DimSlice:3</text>
<text text-anchor="middle" x="9207.79" y="-1642.17" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 2048]</text>
<text text-anchor="middle" x="9207.79" y="-1627.17" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9207.79" y="-1612.17" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_o_proj_3_3 -->
<g id="edge1600" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_o_proj_3_3</title>
<path fill="none" stroke="black" d="M7758.54,-1766.37C7989.96,-1752.82 8416.09,-1727.84 8779.79,-1706.37 8918.82,-1698.16 8958.64,-1716.09 9098.85,-1687.36"/>
<polygon fill="black" stroke="black" points="9099.6,-1690.78 9108.67,-1685.31 9098.17,-1683.93 9099.6,-1690.78"/>
</g>
<!-- layer4_res1 -->
<g id="node628" class="node">
<title>layer4_res1</title>
<ellipse fill="lightpink" stroke="black" cx="7539.79" cy="-1421.7" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="7539.79" y="-1433" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="7539.79" y="-1418" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7539.79" y="-1403" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer4_o_proj_0_0&#45;&gt;layer4_res1 -->
<g id="edge1601" class="edge">
<title>layer4_o_proj_0_0&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M6066.97,-1606.67C6069.93,-1605.85 6072.87,-1605.08 6075.79,-1604.37 6543.41,-1489.38 7113.85,-1445.3 7383.84,-1430"/>
<polygon fill="black" stroke="black" points="7384.31,-1433.48 7394.1,-1429.43 7383.92,-1426.49 7384.31,-1433.48"/>
</g>
<!-- layer4_o_proj_0_1&#45;&gt;layer4_res1 -->
<g id="edge1602" class="edge">
<title>layer4_o_proj_0_1&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M6282.99,-1606.75C6285.94,-1605.91 6288.88,-1605.11 6291.79,-1604.37 6677.75,-1505.13 7145.75,-1455.17 7384.03,-1434.59"/>
<polygon fill="black" stroke="black" points="7384.49,-1438.06 7394.15,-1433.72 7383.89,-1431.09 7384.49,-1438.06"/>
</g>
<!-- layer4_o_proj_0_2&#45;&gt;layer4_res1 -->
<g id="edge1603" class="edge">
<title>layer4_o_proj_0_2&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M6499.02,-1606.87C6501.96,-1605.99 6504.89,-1605.16 6507.79,-1604.37 6813.7,-1520.85 7181.47,-1466.84 7385.04,-1440.88"/>
<polygon fill="black" stroke="black" points="7385.73,-1444.32 7395.21,-1439.59 7384.85,-1437.38 7385.73,-1444.32"/>
</g>
<!-- layer4_o_proj_0_3&#45;&gt;layer4_res1 -->
<g id="edge1604" class="edge">
<title>layer4_o_proj_0_3&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M6715.07,-1607.04C6718,-1606.12 6720.91,-1605.22 6723.79,-1604.37 6951.19,-1536.78 7220.86,-1481.44 7386.12,-1450.26"/>
<polygon fill="black" stroke="black" points="7387.18,-1453.62 7396.36,-1448.33 7385.89,-1446.74 7387.18,-1453.62"/>
</g>
<!-- layer4_o_proj_1_0&#45;&gt;layer4_res1 -->
<g id="edge1605" class="edge">
<title>layer4_o_proj_1_0&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M6930.87,-1607.43C6933.87,-1606.38 6936.85,-1605.36 6939.79,-1604.37 7091.98,-1552.85 7268.17,-1500.34 7390.07,-1465.11"/>
<polygon fill="black" stroke="black" points="7391.22,-1468.42 7399.86,-1462.29 7389.28,-1461.7 7391.22,-1468.42"/>
</g>
<!-- layer4_o_proj_1_1&#45;&gt;layer4_res1 -->
<g id="edge1606" class="edge">
<title>layer4_o_proj_1_1&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7137.75,-1604.25C7210.44,-1571.42 7314.11,-1524.61 7397.96,-1486.74"/>
<polygon fill="black" stroke="black" points="7399.63,-1489.83 7407.31,-1482.52 7396.75,-1483.45 7399.63,-1489.83"/>
</g>
<!-- layer4_o_proj_1_2&#45;&gt;layer4_res1 -->
<g id="edge1607" class="edge">
<title>layer4_o_proj_1_2&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7324.72,-1604.09C7332.91,-1598.28 7341.12,-1592.26 7348.79,-1586.37 7373.47,-1567.39 7399.21,-1546.29 7423.51,-1525.72"/>
<polygon fill="black" stroke="black" points="7425.99,-1528.21 7431.35,-1519.06 7421.46,-1522.87 7425.99,-1528.21"/>
</g>
<!-- layer4_o_proj_1_3&#45;&gt;layer4_res1 -->
<g id="edge1608" class="edge">
<title>layer4_o_proj_1_3&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7490.8,-1604.12C7493.39,-1594.53 7496.3,-1583.75 7499.38,-1572.35"/>
<polygon fill="black" stroke="black" points="7502.77,-1573.21 7502,-1562.64 7496.01,-1571.38 7502.77,-1573.21"/>
</g>
<!-- layer4_o_proj_2_0&#45;&gt;layer4_res1 -->
<g id="edge1609" class="edge">
<title>layer4_o_proj_2_0&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7667.18,-1604.12C7656.17,-1588.44 7642.94,-1569.59 7629.22,-1550.06"/>
<polygon fill="black" stroke="black" points="7631.93,-1547.83 7623.32,-1541.65 7626.2,-1551.85 7631.93,-1547.83"/>
</g>
<!-- layer4_o_proj_2_1&#45;&gt;layer4_res1 -->
<g id="edge1610" class="edge">
<title>layer4_o_proj_2_1&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M7843.56,-1604.12C7796.08,-1575.76 7731.2,-1537.01 7673.59,-1502.61"/>
<polygon fill="black" stroke="black" points="7675.16,-1499.47 7664.78,-1497.34 7671.57,-1505.48 7675.16,-1499.47"/>
</g>
<!-- layer4_o_proj_2_2&#45;&gt;layer4_res1 -->
<g id="edge1611" class="edge">
<title>layer4_o_proj_2_2&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M8028.71,-1607.43C7934.75,-1571.93 7792.44,-1518.16 7685.55,-1477.77"/>
<polygon fill="black" stroke="black" points="7686.56,-1474.41 7675.97,-1474.15 7684.09,-1480.96 7686.56,-1474.41"/>
</g>
<!-- layer4_o_proj_2_3&#45;&gt;layer4_res1 -->
<g id="edge1612" class="edge">
<title>layer4_o_proj_2_3&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M8244.77,-1607.28C8241.75,-1606.28 8238.75,-1605.3 8235.79,-1604.37 8050.66,-1545.67 7833.61,-1491.24 7691.73,-1457.56"/>
<polygon fill="black" stroke="black" points="7692.19,-1454.07 7681.65,-1455.17 7690.58,-1460.89 7692.19,-1454.07"/>
</g>
<!-- layer4_o_proj_3_0&#45;&gt;layer4_res1 -->
<g id="edge1613" class="edge">
<title>layer4_o_proj_3_0&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M8460.54,-1606.96C8457.6,-1606.05 8454.68,-1605.19 8451.79,-1604.37 8189.76,-1529.67 7876.85,-1474.51 7694.03,-1445.59"/>
<polygon fill="black" stroke="black" points="7694.49,-1442.12 7684.07,-1444.02 7693.4,-1449.03 7694.49,-1442.12"/>
</g>
<!-- layer4_o_proj_3_1&#45;&gt;layer4_res1 -->
<g id="edge1614" class="edge">
<title>layer4_o_proj_3_1&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M8676.58,-1606.81C8673.63,-1605.95 8670.69,-1605.14 8667.79,-1604.37 8326.49,-1513.85 7914.42,-1461.38 7695.03,-1437.81"/>
<polygon fill="black" stroke="black" points="7695.37,-1434.32 7685.05,-1436.74 7694.63,-1441.28 7695.37,-1434.32"/>
</g>
<!-- layer4_o_proj_3_2&#45;&gt;layer4_res1 -->
<g id="edge1615" class="edge">
<title>layer4_o_proj_3_2&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M8892.6,-1606.72C8889.65,-1605.88 8886.7,-1605.1 8883.79,-1604.37 8461.59,-1498.1 7948.13,-1450.57 7695.5,-1432.37"/>
<polygon fill="black" stroke="black" points="7695.74,-1428.87 7685.52,-1431.65 7695.24,-1435.86 7695.74,-1428.87"/>
</g>
<!-- layer4_o_proj_3_3&#45;&gt;layer4_res1 -->
<g id="edge1616" class="edge">
<title>layer4_o_proj_3_3&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M9108.62,-1606.64C9105.66,-1605.83 9102.71,-1605.07 9099.79,-1604.37 8595.53,-1482.38 7979.07,-1441.37 7695.76,-1428.35"/>
<polygon fill="black" stroke="black" points="7695.56,-1424.84 7685.41,-1427.88 7695.24,-1431.83 7695.56,-1424.84"/>
</g>
<!-- layer4_ln2_0_0 -->
<g id="node629" class="node">
<title>layer4_ln2_0_0</title>
<ellipse fill="lightyellow" stroke="black" cx="3934.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="3934.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3934.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="3934.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3934.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_0_0 -->
<g id="edge1617" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_0_0</title>
<path fill="none" stroke="black" d="M7394.43,-1411.76C6970.63,-1385.66 5699.51,-1307.1 4644.79,-1239.04 4444.34,-1226.1 4212.1,-1210.6 4069.32,-1201.02"/>
<polygon fill="black" stroke="black" points="4069.4,-1197.52 4059.19,-1200.34 4068.93,-1204.5 4069.4,-1197.52"/>
</g>
<!-- layer4_ln2_0_1 -->
<g id="node630" class="node">
<title>layer4_ln2_0_1</title>
<ellipse fill="lightyellow" stroke="black" cx="9117.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9117.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9117.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="9117.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9117.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_0_1 -->
<g id="edge1619" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_0_1</title>
<path fill="none" stroke="black" d="M7684.01,-1399.79C7989.95,-1355.45 8699.69,-1252.56 8990.27,-1210.44"/>
<polygon fill="black" stroke="black" points="8991.04,-1213.86 9000.43,-1208.97 8990.03,-1206.94 8991.04,-1213.86"/>
</g>
<!-- layer4_ln2_0_2 -->
<g id="node631" class="node">
<title>layer4_ln2_0_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6448.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6448.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6448.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="6448.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6448.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_0_2 -->
<g id="edge1621" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_0_2</title>
<path fill="none" stroke="black" d="M7397.16,-1390.8C7180.18,-1345.3 6771.07,-1259.53 6568.57,-1217.07"/>
<polygon fill="black" stroke="black" points="6569,-1213.58 6558.49,-1214.95 6567.56,-1220.43 6569,-1213.58"/>
</g>
<!-- layer4_ln2_0_3 -->
<g id="node632" class="node">
<title>layer4_ln2_0_3</title>
<ellipse fill="lightyellow" stroke="black" cx="8137.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8137.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8137.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="8137.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8137.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_0_3 -->
<g id="edge1623" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_0_3</title>
<path fill="none" stroke="black" d="M7675.86,-1368.65C7786.88,-1326.19 7941.04,-1267.22 8040.12,-1229.32"/>
<polygon fill="black" stroke="black" points="8041.44,-1232.56 8049.53,-1225.72 8038.94,-1226.02 8041.44,-1232.56"/>
</g>
<!-- layer4_ln2_1_0 -->
<g id="node633" class="node">
<title>layer4_ln2_1_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10979.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10979.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10979.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="10979.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10979.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_1_0 -->
<g id="edge1625" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_1_0</title>
<path fill="none" stroke="black" d="M7685.66,-1419.98C8140.8,-1416.11 9574.58,-1391.76 10749.79,-1239.04 10786.92,-1234.21 10827.02,-1226.79 10863.18,-1219.25"/>
<polygon fill="black" stroke="black" points="10864.2,-1222.61 10873.26,-1217.12 10862.76,-1215.76 10864.2,-1222.61"/>
</g>
<!-- layer4_ln2_1_1 -->
<g id="node634" class="node">
<title>layer4_ln2_1_1</title>
<ellipse fill="lightyellow" stroke="black" cx="6974.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6974.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6974.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="6974.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6974.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_1_1 -->
<g id="edge1627" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_1_1</title>
<path fill="none" stroke="black" d="M7404.82,-1366.06C7301.46,-1324.21 7161.48,-1267.54 7069.7,-1230.38"/>
<polygon fill="black" stroke="black" points="7071,-1227.13 7060.42,-1226.62 7068.38,-1233.62 7071,-1227.13"/>
</g>
<!-- layer4_ln2_1_2 -->
<g id="node635" class="node">
<title>layer4_ln2_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="5339.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="5339.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5339.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="5339.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5339.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_1_2 -->
<g id="edge1629" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_1_2</title>
<path fill="none" stroke="black" d="M7394.49,-1410.6C7073.41,-1387.47 6279.53,-1325.91 5618.79,-1239.04 5567.42,-1232.28 5511.01,-1223.1 5462.44,-1214.64"/>
<polygon fill="black" stroke="black" points="5462.97,-1211.18 5452.52,-1212.9 5461.77,-1218.07 5462.97,-1211.18"/>
</g>
<!-- layer4_ln2_1_3 -->
<g id="node636" class="node">
<title>layer4_ln2_1_3</title>
<ellipse fill="lightyellow" stroke="black" cx="9631.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="9631.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9631.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="9631.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9631.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_1_3 -->
<g id="edge1631" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_1_3</title>
<path fill="none" stroke="black" d="M7684.64,-1406.25C7979.95,-1376.6 8672.82,-1306 9253.79,-1239.04 9336.62,-1229.49 9429.54,-1217.93 9502.52,-1208.65"/>
<polygon fill="black" stroke="black" points="9503.21,-1212.09 9512.69,-1207.36 9502.32,-1205.15 9503.21,-1212.09"/>
</g>
<!-- layer4_ln2_2_0 -->
<g id="node637" class="node">
<title>layer4_ln2_2_0</title>
<ellipse fill="lightyellow" stroke="black" cx="8615.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="8615.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8615.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="8615.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8615.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_2_0 -->
<g id="edge1633" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_2_0</title>
<path fill="none" stroke="black" d="M7682.12,-1390.44C7896.12,-1344.95 8296.91,-1259.75 8496.51,-1217.31"/>
<polygon fill="black" stroke="black" points="8497.39,-1220.7 8506.44,-1215.2 8495.93,-1213.86 8497.39,-1220.7"/>
</g>
<!-- layer4_ln2_2_1 -->
<g id="node638" class="node">
<title>layer4_ln2_2_1</title>
<ellipse fill="lightyellow" stroke="black" cx="5754.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="5754.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5754.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="5754.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5754.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_2_1 -->
<g id="edge1635" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_2_1</title>
<path fill="none" stroke="black" d="M7394.63,-1409.32C7115.68,-1386.27 6485.92,-1328.54 5961.79,-1239.04 5931.68,-1233.9 5899.37,-1227.15 5869.44,-1220.37"/>
<polygon fill="black" stroke="black" points="5869.92,-1216.89 5859.39,-1218.08 5868.36,-1223.72 5869.92,-1216.89"/>
</g>
<!-- layer4_ln2_2_2 -->
<g id="node639" class="node">
<title>layer4_ln2_2_2</title>
<ellipse fill="lightyellow" stroke="black" cx="6097.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="6097.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6097.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="6097.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6097.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_2_2 -->
<g id="edge1637" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_2_2</title>
<path fill="none" stroke="black" d="M7395.23,-1402.57C7165.26,-1372.98 6702.26,-1310.43 6312.79,-1239.04 6280.77,-1233.17 6246.26,-1225.99 6214.45,-1219.03"/>
<polygon fill="black" stroke="black" points="6215.19,-1215.61 6204.67,-1216.87 6213.69,-1222.44 6215.19,-1215.61"/>
</g>
<!-- layer4_ln2_2_3 -->
<g id="node640" class="node">
<title>layer4_ln2_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="10613.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10613.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10613.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="10613.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10613.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_2_3 -->
<g id="edge1639" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_2_3</title>
<path fill="none" stroke="black" d="M7685.37,-1415.05C8095.6,-1398.28 9295.77,-1343.31 10287.79,-1239.04 10354.19,-1232.06 10427.83,-1221.65 10488.29,-1212.4"/>
<polygon fill="black" stroke="black" points="10488.92,-1215.84 10498.27,-1210.86 10487.85,-1208.92 10488.92,-1215.84"/>
</g>
<!-- layer4_ln2_3_0 -->
<g id="node641" class="node">
<title>layer4_ln2_3_0</title>
<ellipse fill="lightyellow" stroke="black" cx="10151.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="10151.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10151.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="10151.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10151.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_3_0 -->
<g id="edge1641" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_3_0</title>
<path fill="none" stroke="black" d="M7685.3,-1410.89C8041.14,-1386.46 8983.56,-1319.05 9767.79,-1239.04 9852.83,-1230.36 9948.22,-1218.67 10022.65,-1209.12"/>
<polygon fill="black" stroke="black" points="10023.54,-1212.53 10033.01,-1207.78 10022.64,-1205.59 10023.54,-1212.53"/>
</g>
<!-- layer4_ln2_3_1 -->
<g id="node642" class="node">
<title>layer4_ln2_3_1</title>
<ellipse fill="lightyellow" stroke="black" cx="7707.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7707.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7707.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="7707.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7707.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_3_1 -->
<g id="edge1643" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_3_1</title>
<path fill="none" stroke="black" d="M7625.76,-1303.65C7640.61,-1283.43 7655.37,-1263.33 7668.2,-1245.86"/>
<polygon fill="black" stroke="black" points="7671.23,-1247.65 7674.33,-1237.51 7665.59,-1243.5 7671.23,-1247.65"/>
</g>
<!-- layer4_ln2_3_2 -->
<g id="node643" class="node">
<title>layer4_ln2_3_2</title>
<ellipse fill="lightyellow" stroke="black" cx="4780.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="4780.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4780.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="4780.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4780.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_3_2 -->
<g id="edge1645" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_3_2</title>
<path fill="none" stroke="black" d="M7394.43,-1411.08C7027.06,-1386.41 6031.71,-1317.29 5203.79,-1239.04 5105.53,-1229.75 4994.65,-1217.34 4911.07,-1207.59"/>
<polygon fill="black" stroke="black" points="4911.36,-1204.1 4901.02,-1206.41 4910.55,-1211.05 4911.36,-1204.1"/>
</g>
<!-- layer4_ln2_3_3 -->
<g id="node644" class="node">
<title>layer4_ln2_3_3</title>
<ellipse fill="lightyellow" stroke="black" cx="7372.79" cy="-1190.95" rx="126.64" ry="48.17"/>
<text text-anchor="middle" x="7372.79" y="-1209.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7372.79" y="-1194.75" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="7372.79" y="-1179.75" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7372.79" y="-1164.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2_3_3 -->
<g id="edge1647" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2_3_3</title>
<path fill="none" stroke="black" d="M7454.33,-1303.65C7439.58,-1283.43 7424.9,-1263.33 7412.15,-1245.86"/>
<polygon fill="black" stroke="black" points="7414.78,-1243.53 7406.05,-1237.51 7409.12,-1247.66 7414.78,-1243.53"/>
</g>
<!-- layer4_gate_0_0 -->
<g id="node645" class="node">
<title>layer4_gate_0_0</title>
<polygon fill="purple" stroke="black" points="3801.65,-1038.1 3674.72,-1105.64 3420.86,-1105.64 3293.93,-1038.1 3420.86,-970.56 3674.72,-970.56 3801.65,-1038.1"/>
<text text-anchor="middle" x="3547.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3547.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="3547.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="3547.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3547.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_0_0&#45;&gt;layer4_gate_0_0 -->
<g id="edge1618" class="edge">
<title>layer4_ln2_0_0&#45;&gt;layer4_gate_0_0</title>
<path fill="none" stroke="black" d="M3847.46,-1155.91C3804.73,-1139.26 3752.01,-1118.7 3702.75,-1099.51"/>
<polygon fill="black" stroke="black" points="3703.87,-1096.18 3693.28,-1095.81 3701.32,-1102.7 3703.87,-1096.18"/>
</g>
<!-- layer4_gate_0_1 -->
<g id="node646" class="node">
<title>layer4_gate_0_1</title>
<polygon fill="purple" stroke="black" points="9587.65,-1038.1 9460.72,-1105.64 9206.86,-1105.64 9079.93,-1038.1 9206.86,-970.56 9460.72,-970.56 9587.65,-1038.1"/>
<text text-anchor="middle" x="9333.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9333.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="9333.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9333.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="9333.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_0_1&#45;&gt;layer4_gate_0_1 -->
<g id="edge1620" class="edge">
<title>layer4_ln2_0_1&#45;&gt;layer4_gate_0_1</title>
<path fill="none" stroke="black" d="M9177.39,-1148.33C9193.74,-1136.91 9211.96,-1124.19 9230.02,-1111.58"/>
<polygon fill="black" stroke="black" points="9232.1,-1114.39 9238.3,-1105.8 9228.09,-1108.65 9232.1,-1114.39"/>
</g>
<!-- layer4_gate_0_2 -->
<g id="node647" class="node">
<title>layer4_gate_0_2</title>
<polygon fill="purple" stroke="black" points="6431.65,-1038.1 6304.72,-1105.64 6050.86,-1105.64 5923.93,-1038.1 6050.86,-970.56 6304.72,-970.56 6431.65,-1038.1"/>
<text text-anchor="middle" x="6177.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6177.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="6177.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6177.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6177.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_0_2&#45;&gt;layer4_gate_0_2 -->
<g id="edge1622" class="edge">
<title>layer4_ln2_0_2&#45;&gt;layer4_gate_0_2</title>
<path fill="none" stroke="black" d="M6378.65,-1150.91C6356.48,-1138.57 6331.25,-1124.52 6306.33,-1110.65"/>
<polygon fill="black" stroke="black" points="6307.98,-1107.56 6297.54,-1105.76 6304.57,-1113.68 6307.98,-1107.56"/>
</g>
<!-- layer4_gate_0_3 -->
<g id="node648" class="node">
<title>layer4_gate_0_3</title>
<polygon fill="purple" stroke="black" points="8535.65,-1038.1 8408.72,-1105.64 8154.86,-1105.64 8027.93,-1038.1 8154.86,-970.56 8408.72,-970.56 8535.65,-1038.1"/>
<text text-anchor="middle" x="8281.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8281.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="8281.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8281.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="8281.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_0_3&#45;&gt;layer4_gate_0_3 -->
<g id="edge1624" class="edge">
<title>layer4_ln2_0_3&#45;&gt;layer4_gate_0_3</title>
<path fill="none" stroke="black" d="M8180.22,-1145.51C8189.95,-1135.31 8200.55,-1124.21 8211.12,-1113.14"/>
<polygon fill="black" stroke="black" points="8213.67,-1115.53 8218.05,-1105.88 8208.61,-1110.7 8213.67,-1115.53"/>
</g>
<!-- layer4_gate_1_0 -->
<g id="node649" class="node">
<title>layer4_gate_1_0</title>
<polygon fill="purple" stroke="black" points="11691.65,-1038.1 11564.72,-1105.64 11310.86,-1105.64 11183.93,-1038.1 11310.86,-970.56 11564.72,-970.56 11691.65,-1038.1"/>
<text text-anchor="middle" x="11437.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11437.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="11437.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="11437.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="11437.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_1_0&#45;&gt;layer4_gate_1_0 -->
<g id="edge1626" class="edge">
<title>layer4_ln2_1_0&#45;&gt;layer4_gate_1_0</title>
<path fill="none" stroke="black" d="M11074.13,-1158.88C11131.16,-1140.1 11205.48,-1115.62 11272.05,-1093.69"/>
<polygon fill="black" stroke="black" points="11273.41,-1096.93 11281.81,-1090.48 11271.22,-1090.28 11273.41,-1096.93"/>
</g>
<!-- layer4_gate_1_1 -->
<g id="node650" class="node">
<title>layer4_gate_1_1</title>
<polygon fill="purple" stroke="black" points="6957.65,-1038.1 6830.72,-1105.64 6576.86,-1105.64 6449.93,-1038.1 6576.86,-970.56 6830.72,-970.56 6957.65,-1038.1"/>
<text text-anchor="middle" x="6703.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6703.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="6703.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="6703.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="6703.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_1_1&#45;&gt;layer4_gate_1_1 -->
<g id="edge1628" class="edge">
<title>layer4_ln2_1_1&#45;&gt;layer4_gate_1_1</title>
<path fill="none" stroke="black" d="M6904.65,-1150.91C6882.48,-1138.57 6857.25,-1124.52 6832.33,-1110.65"/>
<polygon fill="black" stroke="black" points="6833.98,-1107.56 6823.54,-1105.76 6830.57,-1113.68 6833.98,-1107.56"/>
</g>
<!-- layer4_gate_1_2 -->
<g id="node651" class="node">
<title>layer4_gate_1_2</title>
<polygon fill="purple" stroke="black" points="4853.65,-1038.1 4726.72,-1105.64 4472.86,-1105.64 4345.93,-1038.1 4472.86,-970.56 4726.72,-970.56 4853.65,-1038.1"/>
<text text-anchor="middle" x="4599.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4599.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="4599.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="4599.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="4599.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_1_2&#45;&gt;layer4_gate_1_2 -->
<g id="edge1630" class="edge">
<title>layer4_ln2_1_2&#45;&gt;layer4_gate_1_2</title>
<path fill="none" stroke="black" d="M5223.17,-1171.88C5126.31,-1156.27 4985.09,-1132.14 4862.79,-1105.87 4835.29,-1099.96 4806.31,-1093.18 4778.04,-1086.25"/>
<polygon fill="black" stroke="black" points="4778.62,-1082.79 4768.07,-1083.79 4776.94,-1089.59 4778.62,-1082.79"/>
</g>
<!-- layer4_gate_1_3 -->
<g id="node652" class="node">
<title>layer4_gate_1_3</title>
<polygon fill="purple" stroke="black" points="10113.65,-1038.1 9986.72,-1105.64 9732.86,-1105.64 9605.93,-1038.1 9732.86,-970.56 9986.72,-970.56 10113.65,-1038.1"/>
<text text-anchor="middle" x="9859.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9859.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="9859.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="9859.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9859.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_1_3&#45;&gt;layer4_gate_1_3 -->
<g id="edge1632" class="edge">
<title>layer4_ln2_1_3&#45;&gt;layer4_gate_1_3</title>
<path fill="none" stroke="black" d="M9693.79,-1148.93C9711.45,-1137.25 9731.22,-1124.17 9750.79,-1111.22"/>
<polygon fill="black" stroke="black" points="9752.75,-1114.12 9759.16,-1105.68 9748.89,-1108.28 9752.75,-1114.12"/>
</g>
<!-- layer4_gate_2_0 -->
<g id="node653" class="node">
<title>layer4_gate_2_0</title>
<polygon fill="purple" stroke="black" points="9061.65,-1038.1 8934.72,-1105.64 8680.86,-1105.64 8553.93,-1038.1 8680.86,-970.56 8934.72,-970.56 9061.65,-1038.1"/>
<text text-anchor="middle" x="8807.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8807.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="8807.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="8807.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8807.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_2_0&#45;&gt;layer4_gate_2_0 -->
<g id="edge1634" class="edge">
<title>layer4_ln2_2_0&#45;&gt;layer4_gate_2_0</title>
<path fill="none" stroke="black" d="M8670.04,-1147.33C8684.02,-1136.35 8699.46,-1124.22 8714.8,-1112.17"/>
<polygon fill="black" stroke="black" points="8717.1,-1114.81 8722.8,-1105.88 8712.78,-1109.3 8717.1,-1114.81"/>
</g>
<!-- layer4_gate_2_1 -->
<g id="node654" class="node">
<title>layer4_gate_2_1</title>
<polygon fill="purple" stroke="black" points="5379.65,-1038.1 5252.72,-1105.64 4998.86,-1105.64 4871.93,-1038.1 4998.86,-970.56 5252.72,-970.56 5379.65,-1038.1"/>
<text text-anchor="middle" x="5125.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5125.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="5125.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5125.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="5125.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_2_1&#45;&gt;layer4_gate_2_1 -->
<g id="edge1636" class="edge">
<title>layer4_ln2_2_1&#45;&gt;layer4_gate_2_1</title>
<path fill="none" stroke="black" d="M5646.54,-1165.77C5573.6,-1149.3 5475.29,-1126.78 5388.79,-1105.87 5361.86,-1099.36 5333.42,-1092.32 5305.59,-1085.33"/>
<polygon fill="black" stroke="black" points="5306.33,-1081.9 5295.77,-1082.86 5304.62,-1088.69 5306.33,-1081.9"/>
</g>
<!-- layer4_gate_2_2 -->
<g id="node655" class="node">
<title>layer4_gate_2_2</title>
<polygon fill="purple" stroke="black" points="5905.65,-1038.1 5778.72,-1105.64 5524.86,-1105.64 5397.93,-1038.1 5524.86,-970.56 5778.72,-970.56 5905.65,-1038.1"/>
<text text-anchor="middle" x="5651.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5651.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="5651.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="5651.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5651.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_2_2&#45;&gt;layer4_gate_2_2 -->
<g id="edge1638" class="edge">
<title>layer4_ln2_2_2&#45;&gt;layer4_gate_2_2</title>
<path fill="none" stroke="black" d="M6004.57,-1158.42C5949.92,-1139.94 5879.32,-1116.06 5815.65,-1094.52"/>
<polygon fill="black" stroke="black" points="5816.49,-1091.12 5805.9,-1091.23 5814.25,-1097.75 5816.49,-1091.12"/>
</g>
<!-- layer4_gate_2_3 -->
<g id="node656" class="node">
<title>layer4_gate_2_3</title>
<polygon fill="purple" stroke="black" points="11165.65,-1038.1 11038.72,-1105.64 10784.86,-1105.64 10657.93,-1038.1 10784.86,-970.56 11038.72,-970.56 11165.65,-1038.1"/>
<text text-anchor="middle" x="10911.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10911.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="10911.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10911.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10911.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_2_3&#45;&gt;layer4_gate_2_3 -->
<g id="edge1640" class="edge">
<title>layer4_ln2_2_3&#45;&gt;layer4_gate_2_3</title>
<path fill="none" stroke="black" d="M10688.6,-1152.08C10714.39,-1139.03 10744.14,-1123.97 10773.36,-1109.18"/>
<polygon fill="black" stroke="black" points="10775.06,-1112.24 10782.4,-1104.6 10771.9,-1105.99 10775.06,-1112.24"/>
</g>
<!-- layer4_gate_3_0 -->
<g id="node657" class="node">
<title>layer4_gate_3_0</title>
<polygon fill="purple" stroke="black" points="10639.65,-1038.1 10512.72,-1105.64 10258.86,-1105.64 10131.93,-1038.1 10258.86,-970.56 10512.72,-970.56 10639.65,-1038.1"/>
<text text-anchor="middle" x="10385.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10385.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="10385.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="10385.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10385.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_3_0&#45;&gt;layer4_gate_3_0 -->
<g id="edge1642" class="edge">
<title>layer4_ln2_3_0&#45;&gt;layer4_gate_3_0</title>
<path fill="none" stroke="black" d="M10215.12,-1149.13C10233.24,-1137.45 10253.55,-1124.35 10273.67,-1111.38"/>
<polygon fill="black" stroke="black" points="10275.76,-1114.2 10282.27,-1105.84 10271.97,-1108.31 10275.76,-1114.2"/>
</g>
<!-- layer4_gate_3_1 -->
<g id="node658" class="node">
<title>layer4_gate_3_1</title>
<polygon fill="purple" stroke="black" points="8009.65,-1038.1 7882.72,-1105.64 7628.86,-1105.64 7501.93,-1038.1 7628.86,-970.56 7882.72,-970.56 8009.65,-1038.1"/>
<text text-anchor="middle" x="7755.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7755.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="7755.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7755.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7755.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_3_1&#45;&gt;layer4_gate_3_1 -->
<g id="edge1644" class="edge">
<title>layer4_ln2_3_1&#45;&gt;layer4_gate_3_1</title>
<path fill="none" stroke="black" d="M7722.72,-1143.05C7725.49,-1134.32 7728.46,-1124.99 7731.44,-1115.64"/>
<polygon fill="black" stroke="black" points="7734.84,-1116.5 7734.53,-1105.91 7728.17,-1114.38 7734.84,-1116.5"/>
</g>
<!-- layer4_gate_3_2 -->
<g id="node659" class="node">
<title>layer4_gate_3_2</title>
<polygon fill="purple" stroke="black" points="4327.65,-1038.1 4200.72,-1105.64 3946.86,-1105.64 3819.93,-1038.1 3946.86,-970.56 4200.72,-970.56 4327.65,-1038.1"/>
<text text-anchor="middle" x="4073.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4073.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="4073.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="4073.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="4073.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_3_2&#45;&gt;layer4_gate_3_2 -->
<g id="edge1646" class="edge">
<title>layer4_ln2_3_2&#45;&gt;layer4_gate_3_2</title>
<path fill="none" stroke="black" d="M4666.33,-1170.27C4576.43,-1154.33 4448.24,-1130.55 4336.79,-1105.87 4309.43,-1099.81 4280.59,-1092.97 4252.42,-1086.02"/>
<polygon fill="black" stroke="black" points="4253.04,-1082.57 4242.49,-1083.56 4251.36,-1089.36 4253.04,-1082.57"/>
</g>
<!-- layer4_gate_3_3 -->
<g id="node660" class="node">
<title>layer4_gate_3_3</title>
<polygon fill="purple" stroke="black" points="7483.65,-1038.1 7356.72,-1105.64 7102.86,-1105.64 6975.93,-1038.1 7102.86,-970.56 7356.72,-970.56 7483.65,-1038.1"/>
<text text-anchor="middle" x="7229.79" y="-1064.4" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7229.79" y="-1049.4" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="7229.79" y="-1034.4" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8]</text>
<text text-anchor="middle" x="7229.79" y="-1019.4" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7229.79" y="-1004.4" font-family="Times,serif" font-size="14.00">Determines expert assignment per token</text>
</g>
<!-- layer4_ln2_3_3&#45;&gt;layer4_gate_3_3 -->
<g id="edge1648" class="edge">
<title>layer4_ln2_3_3&#45;&gt;layer4_gate_3_3</title>
<path fill="none" stroke="black" d="M7330.66,-1145.51C7321,-1135.31 7310.47,-1124.21 7299.97,-1113.14"/>
<polygon fill="black" stroke="black" points="7302.51,-1110.73 7293.09,-1105.88 7297.43,-1115.54 7302.51,-1110.73"/>
</g>
<!-- layer4_expert1_0 -->
<g id="node661" class="node">
<title>layer4_expert1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="6639.29,-904.33 6460.29,-904.33 6460.29,-836.33 6639.29,-836.33 6639.29,-904.33"/>
<text text-anchor="middle" x="6549.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 0 First Linear</text>
<text text-anchor="middle" x="6549.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6549.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="6549.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_0 -->
<g id="edge1649" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.41,-989.4C3743.36,-981.55 3777.97,-974.6 3810.79,-970.33 3860.51,-963.87 5571.98,-976.73 5615.79,-952.33 5629.58,-944.65 5621.18,-930.32 5634.79,-922.33 5703.66,-881.89 6227.38,-873.52 6450.08,-871.78"/>
<polygon fill="black" stroke="black" points="6450.16,-875.28 6460.13,-871.71 6450.11,-868.28 6450.16,-875.28"/>
<text text-anchor="middle" x="5680.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5680.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer4_expert1_1 -->
<g id="node664" class="node">
<title>layer4_expert1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2991.29,-904.33 2812.29,-904.33 2812.29,-836.33 2991.29,-836.33 2991.29,-904.33"/>
<text text-anchor="middle" x="2901.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 1 First Linear</text>
<text text-anchor="middle" x="2901.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2901.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="2901.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_1 -->
<g id="edge1650" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3304.13,-1032.51C2877.31,-1023.27 2035.16,-999.18 1990.79,-952.33 1981.62,-942.65 1981.63,-932.02 1990.79,-922.33 2018.32,-893.22 2571.59,-878.26 2802.21,-873.28"/>
<polygon fill="black" stroke="black" points="2802.36,-876.77 2812.28,-873.06 2802.21,-869.78 2802.36,-876.77"/>
<text text-anchor="middle" x="2036.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2036.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer4_expert1_2 -->
<g id="node667" class="node">
<title>layer4_expert1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="8349.29,-904.33 8170.29,-904.33 8170.29,-836.33 8349.29,-836.33 8349.29,-904.33"/>
<text text-anchor="middle" x="8259.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 2 First Linear</text>
<text text-anchor="middle" x="8259.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8259.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8259.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_2 -->
<g id="edge1651" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.05,-989.35C3743.1,-981.48 3777.85,-974.53 3810.79,-970.33 3860.79,-963.96 7395.69,-976.74 7439.79,-952.33 7453.6,-944.69 7445.21,-930.38 7458.79,-922.33 7517.71,-887.42 7958.46,-876.05 8159.89,-872.66"/>
<polygon fill="black" stroke="black" points="8160.24,-876.15 8170.18,-872.49 8160.12,-869.15 8160.24,-876.15"/>
<text text-anchor="middle" x="7504.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7504.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer4_expert1_3 -->
<g id="node670" class="node">
<title>layer4_expert1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="4815.29,-904.33 4636.29,-904.33 4636.29,-836.33 4815.29,-836.33 4815.29,-904.33"/>
<text text-anchor="middle" x="4725.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 3 First Linear</text>
<text text-anchor="middle" x="4725.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4725.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="4725.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_3 -->
<g id="edge1652" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3707.59,-987.87C3736.13,-977.32 3765.22,-965.37 3791.79,-952.33 3813.7,-941.58 3814.6,-929.96 3837.79,-922.33 3981.53,-875.08 4425.56,-870.28 4625.91,-870.63"/>
<polygon fill="black" stroke="black" points="4626.13,-874.13 4636.14,-870.66 4626.15,-867.13 4626.13,-874.13"/>
<text text-anchor="middle" x="3883.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3883.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer4_expert1_4 -->
<g id="node673" class="node">
<title>layer4_expert1_4</title>
<polygon fill="lightsteelblue" stroke="black" points="13821.29,-904.33 13642.29,-904.33 13642.29,-836.33 13821.29,-836.33 13821.29,-904.33"/>
<text text-anchor="middle" x="13731.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 4 First Linear</text>
<text text-anchor="middle" x="13731.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13731.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="13731.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_4 -->
<g id="edge1653" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.04,-989.27C3743.09,-981.41 3777.84,-974.48 3810.79,-970.33 3935.85,-954.58 12765.19,-988.98 12885.79,-952.33 12908.79,-945.34 12908.02,-930.03 12930.79,-922.33 13057.91,-879.39 13447.07,-872.19 13632.08,-871.26"/>
<polygon fill="black" stroke="black" points="13632.1,-874.76 13642.08,-871.22 13632.07,-867.76 13632.1,-874.76"/>
<text text-anchor="middle" x="12976.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12976.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer4_expert1_5 -->
<g id="node676" class="node">
<title>layer4_expert1_5</title>
<polygon fill="lightsteelblue" stroke="black" points="11997.29,-904.33 11818.29,-904.33 11818.29,-836.33 11997.29,-836.33 11997.29,-904.33"/>
<text text-anchor="middle" x="11907.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 5 First Linear</text>
<text text-anchor="middle" x="11907.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11907.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="11907.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_5 -->
<g id="edge1654" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.04,-989.29C3743.09,-981.42 3777.84,-974.49 3810.79,-970.33 3860.93,-964 11043.55,-976.75 11087.79,-952.33 11101.61,-944.71 11093.21,-930.38 11106.79,-922.33 11165.71,-887.42 11606.46,-876.05 11807.89,-872.66"/>
<polygon fill="black" stroke="black" points="11808.24,-876.15 11818.18,-872.49 11808.12,-869.15 11808.24,-876.15"/>
<text text-anchor="middle" x="11152.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11152.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer4_expert1_6 -->
<g id="node679" class="node">
<title>layer4_expert1_6</title>
<polygon fill="lightsteelblue" stroke="black" points="1281.29,-904.33 1102.29,-904.33 1102.29,-836.33 1281.29,-836.33 1281.29,-904.33"/>
<text text-anchor="middle" x="1191.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 6 First Linear</text>
<text text-anchor="middle" x="1191.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="1191.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="1191.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_6 -->
<g id="edge1655" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3299.09,-1035.25C2545.16,-1029.04 333.33,-1006.25 280.79,-952.33 271.49,-942.78 271.63,-932.02 280.79,-922.33 308.32,-893.22 861.59,-878.26 1092.21,-873.28"/>
<polygon fill="black" stroke="black" points="1092.36,-876.77 1102.28,-873.06 1092.21,-869.78 1092.36,-876.77"/>
<text text-anchor="middle" x="326.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="326.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer4_expert1_7 -->
<g id="node682" class="node">
<title>layer4_expert1_7</title>
<polygon fill="lightsteelblue" stroke="black" points="10173.29,-904.33 9994.29,-904.33 9994.29,-836.33 10173.29,-836.33 10173.29,-904.33"/>
<text text-anchor="middle" x="10083.79" y="-889.13" font-family="Times,serif" font-size="14.00">Expert 7 First Linear</text>
<text text-anchor="middle" x="10083.79" y="-874.13" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10083.79" y="-859.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="10083.79" y="-844.13" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- layer4_gate_0_0&#45;&gt;layer4_expert1_7 -->
<g id="edge1656" class="edge">
<title>layer4_gate_0_0&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3710.04,-989.31C3743.1,-981.44 3777.84,-974.5 3810.79,-970.33 3848.36,-965.57 9230.65,-970.65 9263.79,-952.33 9277.61,-944.7 9269.21,-930.38 9282.79,-922.33 9341.71,-887.42 9782.46,-876.05 9983.89,-872.66"/>
<polygon fill="black" stroke="black" points="9984.24,-876.15 9994.18,-872.49 9984.12,-869.15 9984.24,-876.15"/>
<text text-anchor="middle" x="9328.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9328.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_0 -->
<g id="edge1657" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9171.17,-989.35C9138.22,-981.51 9103.61,-974.57 9070.79,-970.33 9010.79,-962.58 6946.94,-979.33 6892.79,-952.33 6877.76,-944.84 6884.22,-930.93 6869.79,-922.33 6833.41,-900.65 6729.14,-886.83 6649.41,-879.13"/>
<polygon fill="black" stroke="black" points="6649.61,-875.63 6639.33,-878.17 6648.95,-882.6 6649.61,-875.63"/>
<text text-anchor="middle" x="6938.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6938.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→0</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_1 -->
<g id="edge1658" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9171.54,-989.3C9138.49,-981.44 9103.74,-974.5 9070.79,-970.33 9030.65,-965.25 3281.05,-970.29 3244.79,-952.33 3229.74,-944.87 3236.22,-930.93 3221.79,-922.33 3185.41,-900.65 3081.14,-886.83 3001.41,-879.13"/>
<polygon fill="black" stroke="black" points="3001.61,-875.63 2991.33,-878.17 3000.95,-882.6 3001.61,-875.63"/>
<text text-anchor="middle" x="3290.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3290.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_2 -->
<g id="edge1659" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9169.61,-990.11C9137.1,-982.32 9103.05,-975.2 9070.79,-970.33 9031.85,-964.46 8751.66,-970.65 8716.79,-952.33 8701.92,-944.52 8708.4,-930.63 8693.79,-922.33 8638.55,-890.93 8469.76,-878.79 8359.69,-874.14"/>
<polygon fill="black" stroke="black" points="8359.69,-870.64 8349.56,-873.73 8359.4,-877.64 8359.69,-870.64"/>
<text text-anchor="middle" x="8762.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8762.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→4</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_3 -->
<g id="edge1660" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9171.54,-989.34C9138.48,-981.47 9103.74,-974.52 9070.79,-970.33 9015.65,-963.32 5118.58,-977.04 5068.79,-952.33 5053.74,-944.86 5060.22,-930.93 5045.79,-922.33 5009.41,-900.65 4905.14,-886.83 4825.41,-879.13"/>
<polygon fill="black" stroke="black" points="4825.61,-875.63 4815.33,-878.17 4824.95,-882.6 4825.61,-875.63"/>
<text text-anchor="middle" x="5114.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5114.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→6</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_4 -->
<g id="edge1661" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9496.04,-989.32C9529.1,-981.46 9563.84,-974.52 9596.79,-970.33 9628.27,-966.34 14143.4,-974.81 14165.79,-952.33 14175.2,-942.89 14174.65,-932.3 14165.79,-922.33 14143.94,-897.76 13952.62,-883.08 13831.41,-876.16"/>
<polygon fill="black" stroke="black" points="13831.54,-872.66 13821.35,-875.6 13831.14,-879.65 13831.54,-872.66"/>
<text text-anchor="middle" x="14217.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14217.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→8</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_5 -->
<g id="edge1662" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9496.4,-989.31C9529.35,-981.47 9563.97,-974.54 9596.79,-970.33 9634.61,-965.48 12314.92,-979.38 12341.79,-952.33 12351.19,-942.87 12350.65,-932.3 12341.79,-922.33 12319.94,-897.76 12128.62,-883.08 12007.41,-876.16"/>
<polygon fill="black" stroke="black" points="12007.54,-872.66 11997.35,-875.6 12007.14,-879.65 12007.54,-872.66"/>
<text text-anchor="middle" x="12393.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12393.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→10</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_6 -->
<g id="edge1663" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9171.55,-989.28C9138.49,-981.42 9103.74,-974.49 9070.79,-970.33 9018.87,-963.78 1581.7,-975.54 1534.79,-952.33 1519.73,-944.88 1526.22,-930.93 1511.79,-922.33 1475.41,-900.65 1371.14,-886.83 1291.41,-879.13"/>
<polygon fill="black" stroke="black" points="1291.61,-875.63 1281.33,-878.17 1290.95,-882.6 1291.61,-875.63"/>
<text text-anchor="middle" x="1580.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1580.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→12</text>
</g>
<!-- layer4_gate_0_1&#45;&gt;layer4_expert1_7 -->
<g id="edge1664" class="edge">
<title>layer4_gate_0_1&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9496.8,-989.56C9529.64,-981.73 9564.11,-974.74 9596.79,-970.33 9622.15,-966.91 10499.88,-970.6 10517.79,-952.33 10527.13,-942.81 10526.65,-932.3 10517.79,-922.33 10495.94,-897.76 10304.62,-883.08 10183.41,-876.16"/>
<polygon fill="black" stroke="black" points="10183.54,-872.66 10173.35,-875.6 10183.14,-879.65 10183.54,-872.66"/>
<text text-anchor="middle" x="10569.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10569.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 1→14</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_0 -->
<g id="edge1665" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6187.31,-970.56C6193.05,-952.49 6202.2,-934.57 6216.79,-922.33 6251.3,-893.4 6364.79,-880.82 6449.75,-875.39"/>
<polygon fill="black" stroke="black" points="6450.19,-878.87 6459.96,-874.77 6449.76,-871.89 6450.19,-878.87"/>
<text text-anchor="middle" x="6262.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6262.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_1 -->
<g id="edge1666" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6015.18,-989.28C5982.23,-981.44 5947.62,-974.52 5914.79,-970.33 5891.69,-967.38 2577.22,-968.85 2560.79,-952.33 2551.39,-942.88 2552.09,-932.43 2560.79,-922.33 2591.45,-886.74 2712.69,-875.62 2801.92,-872.35"/>
<polygon fill="black" stroke="black" points="2802.21,-875.84 2812.09,-872 2801.97,-868.84 2802.21,-875.84"/>
<text text-anchor="middle" x="2606.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2606.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_2 -->
<g id="edge1667" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6340.42,-989.43C6373.37,-981.59 6407.98,-974.62 6440.79,-970.33 6484.01,-964.68 7971.73,-973.57 8009.79,-952.33 8023.57,-944.64 8015.87,-931.4 8028.79,-922.33 8066.92,-895.58 8116.61,-882.52 8160.12,-876.28"/>
<polygon fill="black" stroke="black" points="8160.72,-879.73 8170.17,-874.94 8159.8,-872.79 8160.72,-879.73"/>
<text text-anchor="middle" x="8074.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8074.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_3 -->
<g id="edge1668" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6015.16,-989.44C5982.21,-981.59 5947.6,-974.63 5914.79,-970.33 5893.72,-967.57 4399.73,-967.45 4384.79,-952.33 4375.42,-942.85 4376.09,-932.43 4384.79,-922.33 4415.45,-886.74 4536.69,-875.62 4625.92,-872.35"/>
<polygon fill="black" stroke="black" points="4626.21,-875.84 4636.09,-872 4625.97,-868.84 4626.21,-875.84"/>
<text text-anchor="middle" x="4430.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4430.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_4 -->
<g id="edge1669" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6340.04,-989.29C6373.09,-981.42 6407.84,-974.49 6440.79,-970.33 6489.3,-964.21 13438.98,-975.96 13481.79,-952.33 13495.61,-944.7 13487.87,-931.4 13500.79,-922.33 13538.92,-895.58 13588.61,-882.52 13632.12,-876.28"/>
<polygon fill="black" stroke="black" points="13632.72,-879.73 13642.17,-874.94 13631.8,-872.79 13632.72,-879.73"/>
<text text-anchor="middle" x="13546.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13546.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_5 -->
<g id="edge1670" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6340.04,-989.31C6373.1,-981.45 6407.84,-974.51 6440.79,-970.33 6476.73,-965.78 11626.08,-969.86 11657.79,-952.33 11671.61,-944.7 11663.87,-931.4 11676.79,-922.33 11714.92,-895.58 11764.61,-882.52 11808.12,-876.28"/>
<polygon fill="black" stroke="black" points="11808.72,-879.73 11818.17,-874.94 11807.8,-872.79 11808.72,-879.73"/>
<text text-anchor="middle" x="11722.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11722.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_6 -->
<g id="edge1671" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6015.54,-989.31C5982.49,-981.45 5947.74,-974.51 5914.79,-970.33 5879.9,-965.91 875.61,-977.24 850.79,-952.33 841.38,-942.89 842.09,-932.43 850.79,-922.33 881.45,-886.74 1002.69,-875.62 1091.92,-872.35"/>
<polygon fill="black" stroke="black" points="1092.21,-875.84 1102.09,-872 1091.97,-868.84 1092.21,-875.84"/>
<text text-anchor="middle" x="896.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="896.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer4_gate_0_2&#45;&gt;layer4_expert1_7 -->
<g id="edge1672" class="edge">
<title>layer4_gate_0_2&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6340.4,-989.27C6373.35,-981.44 6407.96,-974.52 6440.79,-970.33 6487.54,-964.37 9792.57,-975.16 9833.79,-952.33 9847.6,-944.69 9839.87,-931.4 9852.79,-922.33 9890.92,-895.58 9940.61,-882.52 9984.12,-876.28"/>
<polygon fill="black" stroke="black" points="9984.72,-879.73 9994.17,-874.94 9983.8,-872.79 9984.72,-879.73"/>
<text text-anchor="middle" x="9898.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9898.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_0 -->
<g id="edge1673" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8119.16,-989.48C8086.21,-981.63 8051.6,-974.65 8018.79,-970.33 7981.5,-965.42 6698.41,-969.2 6664.79,-952.33 6649.77,-944.8 6654.52,-933.3 6641.79,-922.33 6636.77,-918.01 6631.33,-913.88 6625.68,-909.99"/>
<polygon fill="black" stroke="black" points="6627.56,-907.04 6617.29,-904.45 6623.71,-912.88 6627.56,-907.04"/>
<text text-anchor="middle" x="6710.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6710.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_1 -->
<g id="edge1674" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8119.54,-989.31C8086.49,-981.45 8051.74,-974.51 8018.79,-970.33 7949.87,-961.59 3079.04,-983.18 3016.79,-952.33 3001.74,-944.87 3006.52,-933.3 2993.79,-922.33 2988.77,-918.01 2983.33,-913.88 2977.68,-909.99"/>
<polygon fill="black" stroke="black" points="2979.56,-907.04 2969.29,-904.45 2975.71,-912.88 2979.56,-907.04"/>
<text text-anchor="middle" x="3062.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3062.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→2</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_2 -->
<g id="edge1675" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8441.4,-987.7C8470.67,-970.38 8486.33,-948.57 8465.79,-922.33 8452.01,-904.73 8405.01,-892.35 8359.38,-884.21"/>
<polygon fill="black" stroke="black" points="8359.82,-880.73 8349.37,-882.48 8358.63,-887.63 8359.82,-880.73"/>
<text text-anchor="middle" x="8520.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8520.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→4</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_3 -->
<g id="edge1676" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8119.18,-989.28C8086.23,-981.45 8051.62,-974.53 8018.79,-970.33 7975.01,-964.74 4880.32,-971.97 4840.79,-952.33 4825.75,-944.86 4830.52,-933.3 4817.79,-922.33 4812.77,-918.01 4807.33,-913.88 4801.68,-909.99"/>
<polygon fill="black" stroke="black" points="4803.56,-907.04 4793.29,-904.45 4799.71,-912.88 4803.56,-907.04"/>
<text text-anchor="middle" x="4886.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4886.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→6</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_4 -->
<g id="edge1677" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8444.04,-989.31C8477.1,-981.44 8511.84,-974.51 8544.79,-970.33 8581.95,-965.63 13911.35,-978.86 13937.79,-952.33 13978.08,-911.91 13902.29,-891.13 13831.55,-880.8"/>
<polygon fill="black" stroke="black" points="13832,-877.33 13821.61,-879.41 13831.03,-884.26 13832,-877.33"/>
<text text-anchor="middle" x="13994.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13994.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→8</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_5 -->
<g id="edge1678" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8444.05,-989.35C8477.1,-981.48 8511.85,-974.53 8544.79,-970.33 8569.38,-967.2 12096.31,-969.9 12113.79,-952.33 12154.05,-911.87 12078.26,-891.1 12007.53,-880.78"/>
<polygon fill="black" stroke="black" points="12007.98,-877.31 11997.6,-879.4 12007.02,-884.24 12007.98,-877.31"/>
<text text-anchor="middle" x="12170.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12170.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→10</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_6 -->
<g id="edge1679" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8119.54,-989.29C8086.49,-981.43 8051.74,-974.49 8018.79,-970.33 7972.55,-964.49 1348.56,-973.01 1306.79,-952.33 1291.73,-944.88 1296.52,-933.3 1283.79,-922.33 1278.77,-918.01 1273.33,-913.88 1267.68,-909.99"/>
<polygon fill="black" stroke="black" points="1269.56,-907.04 1259.29,-904.45 1265.71,-912.88 1269.56,-907.04"/>
<text text-anchor="middle" x="1352.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1352.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→12</text>
</g>
<!-- layer4_gate_0_3&#45;&gt;layer4_expert1_7 -->
<g id="edge1680" class="edge">
<title>layer4_gate_0_3&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8444.42,-989.4C8477.36,-981.56 8511.97,-974.6 8544.79,-970.33 8568.83,-967.2 10272.74,-969.56 10289.79,-952.33 10329.94,-911.77 10254.17,-891.01 10183.47,-880.73"/>
<polygon fill="black" stroke="black" points="10183.93,-877.26 10173.54,-879.34 10182.97,-884.19 10183.93,-877.26"/>
<text text-anchor="middle" x="10346.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10346.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 3→14</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_0 -->
<g id="edge1681" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11275.17,-989.37C11242.22,-981.53 11207.61,-974.58 11174.79,-970.33 11119.64,-963.19 9222.55,-977.16 9172.79,-952.33 9157.76,-944.83 9164.79,-929.9 9149.79,-922.33 9125.29,-909.96 8189.24,-904.86 8161.79,-904.33 7589.35,-893.26 6902.59,-878.81 6649.62,-873.45"/>
<polygon fill="black" stroke="black" points="6649.43,-869.95 6639.35,-873.24 6649.28,-876.95 6649.43,-869.95"/>
<text text-anchor="middle" x="9218.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9218.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_1 -->
<g id="edge1682" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11275.54,-989.3C11242.49,-981.44 11207.74,-974.5 11174.79,-970.33 11135.84,-965.4 5555.16,-971.32 5520.79,-952.33 5506.98,-944.7 5515.54,-930.08 5501.79,-922.33 5500.06,-921.36 3479.14,-882.43 3001.91,-873.26"/>
<polygon fill="black" stroke="black" points="3001.67,-869.75 2991.6,-873.06 3001.53,-876.75 3001.67,-869.75"/>
<text text-anchor="middle" x="5566.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5566.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_2 -->
<g id="edge1683" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11271.99,-991.06C11239.93,-983.27 11206.45,-975.92 11174.79,-970.33 11096.49,-956.51 11069.88,-983.64 10996.79,-952.33 10977.96,-944.27 10980.94,-929.62 10961.79,-922.33 10911.1,-903.05 10040.01,-905.35 9985.79,-904.33 9367.77,-892.73 8625.28,-878.4 8360.01,-873.27"/>
<polygon fill="black" stroke="black" points="8359.7,-869.77 8349.63,-873.07 8359.56,-876.76 8359.7,-869.77"/>
<text text-anchor="middle" x="11042.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11042.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_3 -->
<g id="edge1684" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11275.54,-989.34C11242.48,-981.48 11207.74,-974.53 11174.79,-970.33 11122.02,-963.61 7391.33,-978.09 7344.79,-952.33 7330.98,-944.69 7339.54,-930.08 7325.79,-922.33 7324.06,-921.36 5303.14,-882.43 4825.91,-873.26"/>
<polygon fill="black" stroke="black" points="4825.67,-869.75 4815.6,-873.06 4825.53,-876.75 4825.67,-869.75"/>
<text text-anchor="middle" x="7390.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7390.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_4 -->
<g id="edge1685" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11686.53,-1035.28C12443.32,-1029.16 14669.93,-1006.57 14722.79,-952.33 14732.1,-942.78 14731.97,-932 14722.79,-922.33 14692.45,-890.39 14077.83,-876.93 13832.07,-872.81"/>
<polygon fill="black" stroke="black" points="13831.77,-869.31 13821.71,-872.64 13831.65,-876.31 13831.77,-869.31"/>
<text text-anchor="middle" x="14774.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14774.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_5 -->
<g id="edge1686" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11686.05,-1035.08C12426.36,-1028.45 14570.74,-1004.76 14621.79,-952.33 14631.09,-942.78 14631.13,-931.85 14621.79,-922.33 14602.56,-902.75 13661.24,-904.84 13633.79,-904.33 13015.77,-892.79 12273.28,-878.43 12008.01,-873.28"/>
<polygon fill="black" stroke="black" points="12007.7,-869.77 11997.63,-873.08 12007.56,-876.77 12007.7,-869.77"/>
<text text-anchor="middle" x="14673.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14673.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_6 -->
<g id="edge1687" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11275.55,-989.28C11242.49,-981.42 11207.74,-974.49 11174.79,-970.33 11123.27,-963.83 3742.26,-977.43 3696.79,-952.33 3682.97,-944.71 3691.54,-930.08 3677.79,-922.33 3677.79,-922.33 1754.83,-882.88 1291.39,-873.38"/>
<polygon fill="black" stroke="black" points="1291.44,-869.88 1281.37,-873.17 1291.3,-876.87 1291.44,-869.88"/>
<text text-anchor="middle" x="3742.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3742.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer4_gate_1_0&#45;&gt;layer4_expert1_7 -->
<g id="edge1688" class="edge">
<title>layer4_gate_1_0&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11677.63,-1030.43C12054.72,-1018.75 12747.54,-992.01 12784.79,-952.33 12793.92,-942.61 12794.13,-931.85 12784.79,-922.33 12765.81,-903 11836.87,-904.84 11809.79,-904.33 11191.77,-892.72 10449.28,-878.4 10184.01,-873.27"/>
<polygon fill="black" stroke="black" points="10183.7,-869.76 10173.63,-873.07 10183.56,-876.76 10183.7,-869.76"/>
<text text-anchor="middle" x="12836.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12836.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_0 -->
<g id="edge1689" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6536.34,-992C6504.73,-984.22 6471.84,-976.63 6440.79,-970.33 6414.79,-965.06 6340.08,-972.45 6322.79,-952.33 6280.89,-903.55 6371.1,-884.15 6449.9,-876.43"/>
<polygon fill="black" stroke="black" points="6450.31,-879.91 6459.94,-875.5 6449.66,-872.94 6450.31,-879.91"/>
<text text-anchor="middle" x="6368.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6368.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→0</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_1 -->
<g id="edge1690" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6541.54,-989.34C6508.48,-981.48 6473.74,-974.53 6440.79,-970.33 6414.85,-967.03 2693.24,-970.87 2674.79,-952.33 2629.15,-906.47 2721.47,-886.46 2801.74,-877.8"/>
<polygon fill="black" stroke="black" points="2802.37,-881.26 2811.96,-876.75 2801.66,-874.29 2802.37,-881.26"/>
<text text-anchor="middle" x="2720.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2720.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→2</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_2 -->
<g id="edge1691" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6866.43,-989.54C6899.38,-981.69 6933.99,-974.69 6966.79,-970.33 7030.52,-961.87 8067.71,-983.76 8123.79,-952.33 8137.56,-944.62 8130.81,-932.6 8142.79,-922.33 8148.46,-917.47 8154.66,-913.01 8161.16,-908.92"/>
<polygon fill="black" stroke="black" points="8163.36,-911.69 8170.18,-903.58 8159.79,-905.67 8163.36,-911.69"/>
<text text-anchor="middle" x="8188.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8188.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→4</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_3 -->
<g id="edge1692" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6541.17,-989.38C6508.22,-981.54 6473.61,-974.59 6440.79,-970.33 6414.04,-966.86 4517.78,-971.49 4498.79,-952.33 4453.25,-906.37 4545.55,-886.38 4625.79,-877.75"/>
<polygon fill="black" stroke="black" points="4626.41,-881.21 4636.01,-876.71 4625.7,-874.24 4626.41,-881.21"/>
<text text-anchor="middle" x="4544.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4544.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→6</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_4 -->
<g id="edge1693" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6866.04,-989.29C6899.09,-981.43 6933.84,-974.49 6966.79,-970.33 7012.46,-964.56 13555.49,-974.58 13595.79,-952.33 13609.61,-944.7 13602.81,-932.6 13614.79,-922.33 13620.46,-917.47 13626.66,-913.01 13633.16,-908.92"/>
<polygon fill="black" stroke="black" points="13635.36,-911.69 13642.18,-903.58 13631.79,-905.67 13635.36,-911.69"/>
<text text-anchor="middle" x="13660.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13660.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→8</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_5 -->
<g id="edge1694" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6866.04,-989.32C6899.1,-981.45 6933.84,-974.51 6966.79,-970.33 6999.89,-966.13 11742.59,-968.48 11771.79,-952.33 11785.6,-944.7 11778.81,-932.6 11790.79,-922.33 11796.46,-917.47 11802.66,-913.01 11809.16,-908.92"/>
<polygon fill="black" stroke="black" points="11811.36,-911.69 11818.18,-903.58 11807.79,-905.67 11811.36,-911.69"/>
<text text-anchor="middle" x="11836.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11836.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→10</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_6 -->
<g id="edge1695" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6541.54,-989.31C6508.49,-981.44 6473.74,-974.5 6440.79,-970.33 6403.06,-965.56 991.64,-979.27 964.79,-952.33 919.11,-906.5 1011.44,-886.49 1091.72,-877.82"/>
<polygon fill="black" stroke="black" points="1092.36,-881.27 1101.95,-876.77 1091.64,-874.31 1092.36,-881.27"/>
<text text-anchor="middle" x="1010.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1010.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→12</text>
</g>
<!-- layer4_gate_1_1&#45;&gt;layer4_expert1_7 -->
<g id="edge1696" class="edge">
<title>layer4_gate_1_1&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6866.4,-989.29C6899.35,-981.46 6933.97,-974.53 6966.79,-970.33 7007.86,-965.07 9911.58,-972.4 9947.79,-952.33 9961.6,-944.68 9954.81,-932.6 9966.79,-922.33 9972.46,-917.47 9978.66,-913.01 9985.16,-908.92"/>
<polygon fill="black" stroke="black" points="9987.36,-911.69 9994.18,-903.58 9983.79,-905.67 9987.36,-911.69"/>
<text text-anchor="middle" x="10012.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10012.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 5→14</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_0 -->
<g id="edge1697" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.79,-989.53C4795.64,-981.7 4830.11,-974.72 4862.79,-970.33 4916.82,-963.08 5796.28,-979.05 5843.79,-952.33 5857.55,-944.6 5849.26,-930.45 5862.79,-922.33 5911.87,-892.9 6271.62,-878.97 6450.03,-873.81"/>
<polygon fill="black" stroke="black" points="6450.32,-877.31 6460.21,-873.52 6450.12,-870.31 6450.32,-877.31"/>
<text text-anchor="middle" x="5908.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5908.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_1 -->
<g id="edge1698" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4437.17,-989.36C4404.22,-981.52 4369.61,-974.58 4336.79,-970.33 4307.62,-966.56 2239.5,-973.22 2218.79,-952.33 2209.4,-942.86 2209.72,-932.11 2218.79,-922.33 2257.59,-880.53 2621.91,-872.74 2801.99,-871.46"/>
<polygon fill="black" stroke="black" points="2802.03,-874.96 2812.01,-871.39 2801.98,-867.96 2802.03,-874.96"/>
<text text-anchor="middle" x="2264.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2264.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_2 -->
<g id="edge1699" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.4,-989.3C4795.35,-981.47 4829.97,-974.54 4862.79,-970.33 4901.43,-965.38 7633.72,-971.23 7667.79,-952.33 7681.59,-944.68 7673.32,-930.55 7686.79,-922.33 7726.13,-898.35 8006.42,-882.45 8159.9,-875.43"/>
<polygon fill="black" stroke="black" points="8160.44,-878.91 8170.27,-874.96 8160.12,-871.92 8160.44,-878.91"/>
<text text-anchor="middle" x="7732.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7732.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_3 -->
<g id="edge1700" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4435.57,-990.38C4403.06,-982.56 4369.02,-975.36 4336.79,-970.33 4304.46,-965.28 4065.22,-976.17 4042.79,-952.33 4033.66,-942.62 4033.72,-932.11 4042.79,-922.33 4081.59,-880.53 4445.91,-872.74 4625.99,-871.46"/>
<polygon fill="black" stroke="black" points="4626.03,-874.96 4636.01,-871.39 4625.98,-867.96 4626.03,-874.96"/>
<text text-anchor="middle" x="4088.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4088.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_4 -->
<g id="edge1701" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.04,-989.28C4795.09,-981.42 4829.84,-974.49 4862.79,-970.33 4919.82,-963.14 13089.46,-980.1 13139.79,-952.33 13153.61,-944.71 13145.32,-930.55 13158.79,-922.33 13198.13,-898.35 13478.42,-882.45 13631.9,-875.43"/>
<polygon fill="black" stroke="black" points="13632.44,-878.91 13642.27,-874.96 13632.12,-871.92 13632.44,-878.91"/>
<text text-anchor="middle" x="13204.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13204.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_5 -->
<g id="edge1702" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.04,-989.29C4795.09,-981.43 4829.84,-974.5 4862.79,-970.33 4907.25,-964.71 11276.56,-973.99 11315.79,-952.33 11329.61,-944.7 11321.32,-930.55 11334.79,-922.33 11374.13,-898.35 11654.42,-882.45 11807.9,-875.43"/>
<polygon fill="black" stroke="black" points="11808.44,-878.91 11818.27,-874.96 11808.12,-871.92 11808.44,-878.91"/>
<text text-anchor="middle" x="11380.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11380.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_6 -->
<g id="edge1703" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4437.54,-989.34C4404.48,-981.48 4369.74,-974.53 4336.79,-970.33 4310.42,-966.97 527.54,-971.17 508.79,-952.33 499.39,-942.88 499.72,-932.11 508.79,-922.33 547.59,-880.53 911.91,-872.74 1091.99,-871.46"/>
<polygon fill="black" stroke="black" points="1092.03,-874.96 1102.01,-871.39 1091.98,-867.96 1092.03,-874.96"/>
<text text-anchor="middle" x="554.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="554.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer4_gate_1_2&#45;&gt;layer4_expert1_7 -->
<g id="edge1704" class="edge">
<title>layer4_gate_1_2&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.04,-989.32C4795.1,-981.46 4829.84,-974.51 4862.79,-970.33 4926.57,-962.24 9435.53,-983.44 9491.79,-952.33 9505.6,-944.7 9497.32,-930.55 9510.79,-922.33 9550.13,-898.35 9830.42,-882.45 9983.9,-875.43"/>
<polygon fill="black" stroke="black" points="9984.44,-878.91 9994.27,-874.96 9984.12,-871.92 9984.44,-878.91"/>
<text text-anchor="middle" x="9556.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9556.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_0 -->
<g id="edge1705" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9697.18,-989.32C9664.23,-981.48 9629.62,-974.55 9596.79,-970.33 9525.43,-961.16 7071.2,-984.39 7006.79,-952.33 6991.75,-944.85 6998.4,-930.63 6983.79,-922.33 6928.55,-890.93 6759.76,-878.79 6649.69,-874.14"/>
<polygon fill="black" stroke="black" points="6649.69,-870.64 6639.56,-873.73 6649.4,-877.64 6649.69,-870.64"/>
<text text-anchor="middle" x="7052.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7052.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→0</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_1 -->
<g id="edge1706" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9697.54,-989.3C9664.49,-981.43 9629.74,-974.5 9596.79,-970.33 9553.81,-964.9 3397.61,-971.56 3358.79,-952.33 3343.74,-944.88 3350.4,-930.63 3335.79,-922.33 3280.55,-890.93 3111.76,-878.79 3001.69,-874.14"/>
<polygon fill="black" stroke="black" points="3001.69,-870.64 2991.56,-873.73 3001.4,-877.64 3001.69,-870.64"/>
<text text-anchor="middle" x="3404.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3404.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→2</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_2 -->
<g id="edge1707" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9696.77,-989.66C9663.93,-981.82 9629.46,-974.81 9596.79,-970.33 9554.62,-964.56 8868.74,-971.61 8830.79,-952.33 8815.81,-944.72 8822.5,-930.46 8807.79,-922.33 8733.13,-881.08 8496.09,-872.56 8359.46,-871.18"/>
<polygon fill="black" stroke="black" points="8359.42,-867.68 8349.39,-871.09 8359.36,-874.68 8359.42,-867.68"/>
<text text-anchor="middle" x="8876.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8876.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→4</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_3 -->
<g id="edge1708" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9697.54,-989.33C9664.48,-981.46 9629.74,-974.52 9596.79,-970.33 9535.97,-962.61 5237.71,-979.57 5182.79,-952.33 5167.74,-944.87 5174.4,-930.63 5159.79,-922.33 5104.55,-890.93 4935.76,-878.79 4825.69,-874.14"/>
<polygon fill="black" stroke="black" points="4825.69,-870.64 4815.56,-873.73 4825.4,-877.64 4825.69,-870.64"/>
<text text-anchor="middle" x="5228.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5228.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→6</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_4 -->
<g id="edge1709" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10022.04,-989.33C10055.1,-981.47 10089.85,-974.52 10122.79,-970.33 10151.43,-966.69 14259.42,-972.79 14279.79,-952.33 14289.2,-942.88 14288.77,-932.19 14279.79,-922.33 14250.26,-889.93 13981.41,-877.77 13831.57,-873.49"/>
<polygon fill="black" stroke="black" points="13831.53,-869.99 13821.43,-873.21 13831.33,-876.98 13831.53,-869.99"/>
<text text-anchor="middle" x="14331.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14331.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→8</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_5 -->
<g id="edge1710" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10022.41,-989.34C10055.36,-981.5 10089.97,-974.56 10122.79,-970.33 10154.93,-966.19 12432.97,-975.33 12455.79,-952.33 12465.18,-942.87 12464.77,-932.19 12455.79,-922.33 12426.26,-889.93 12157.41,-877.77 12007.57,-873.49"/>
<polygon fill="black" stroke="black" points="12007.53,-869.99 11997.43,-873.21 12007.33,-876.98 12007.53,-869.99"/>
<text text-anchor="middle" x="12507.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12507.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→10</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_6 -->
<g id="edge1711" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9697.55,-989.28C9664.49,-981.42 9629.74,-974.49 9596.79,-970.33 9542.03,-963.43 1698.26,-976.81 1648.79,-952.33 1633.73,-944.88 1640.4,-930.63 1625.79,-922.33 1570.55,-890.93 1401.76,-878.79 1291.69,-874.14"/>
<polygon fill="black" stroke="black" points="1291.69,-870.64 1281.56,-873.73 1291.4,-877.64 1291.69,-870.64"/>
<text text-anchor="middle" x="1694.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1694.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→12</text>
</g>
<!-- layer4_gate_1_3&#45;&gt;layer4_expert1_7 -->
<g id="edge1712" class="edge">
<title>layer4_gate_1_3&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10023.21,-989.88C10055.94,-982.05 10090.26,-974.98 10122.79,-970.33 10150.8,-966.33 10612.14,-972.69 10631.79,-952.33 10641.05,-942.74 10640.77,-932.19 10631.79,-922.33 10602.26,-889.93 10333.41,-877.77 10183.57,-873.49"/>
<polygon fill="black" stroke="black" points="10183.53,-869.99 10173.43,-873.21 10183.33,-876.98 10183.53,-869.99"/>
<text text-anchor="middle" x="10683.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10683.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 7→14</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_0 -->
<g id="edge1713" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8645.17,-989.4C8612.22,-981.56 8577.61,-974.6 8544.79,-970.33 8496.14,-964 6822.67,-974.26 6778.79,-952.33 6763.76,-944.82 6769.85,-931.54 6755.79,-922.33 6724.31,-901.72 6685.15,-889.43 6649.46,-882.11"/>
<polygon fill="black" stroke="black" points="6649.97,-878.65 6639.49,-880.18 6648.64,-885.52 6649.97,-878.65"/>
<text text-anchor="middle" x="6824.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6824.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_1 -->
<g id="edge1714" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8645.54,-989.31C8612.49,-981.44 8577.74,-974.5 8544.79,-970.33 8507.49,-965.61 3164.48,-969.02 3130.79,-952.33 3115.74,-944.87 3121.85,-931.54 3107.79,-922.33 3076.31,-901.72 3037.15,-889.43 3001.46,-882.11"/>
<polygon fill="black" stroke="black" points="3001.97,-878.65 2991.49,-880.18 3000.64,-885.52 3001.97,-878.65"/>
<text text-anchor="middle" x="3176.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3176.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_2 -->
<g id="edge1715" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8658.31,-982.47C8639.1,-973.39 8620.11,-963.31 8602.79,-952.33 8586.05,-941.72 8587.64,-930.96 8569.79,-922.33 8504.21,-890.62 8422.67,-878.11 8359.69,-873.41"/>
<polygon fill="black" stroke="black" points="8359.56,-869.89 8349.35,-872.69 8359.08,-876.87 8359.56,-869.89"/>
<text text-anchor="middle" x="8648.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8648.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_3 -->
<g id="edge1716" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8645.54,-989.35C8612.48,-981.48 8577.74,-974.53 8544.79,-970.33 8495.33,-964.03 4999.45,-974.51 4954.79,-952.33 4939.74,-944.86 4945.85,-931.54 4931.79,-922.33 4900.31,-901.72 4861.15,-889.43 4825.46,-882.11"/>
<polygon fill="black" stroke="black" points="4825.97,-878.65 4815.49,-880.18 4824.64,-885.52 4825.97,-878.65"/>
<text text-anchor="middle" x="5000.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5000.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_4 -->
<g id="edge1717" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8970.04,-989.31C9003.1,-981.45 9037.84,-974.51 9070.79,-970.33 9105.11,-965.98 14027.38,-976.84 14051.79,-952.33 14061.2,-942.89 14060.45,-932.48 14051.79,-922.33 14023.81,-889.54 13914.63,-877.73 13831.51,-873.54"/>
<polygon fill="black" stroke="black" points="13831.66,-870.04 13821.51,-873.06 13831.33,-877.03 13831.66,-870.04"/>
<text text-anchor="middle" x="14103.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14103.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_5 -->
<g id="edge1718" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8970.4,-989.29C9003.35,-981.45 9037.97,-974.53 9070.79,-970.33 9092.54,-967.55 12212.33,-967.88 12227.79,-952.33 12237.19,-942.88 12236.45,-932.48 12227.79,-922.33 12199.81,-889.54 12090.63,-877.73 12007.51,-873.54"/>
<polygon fill="black" stroke="black" points="12007.66,-870.04 11997.51,-873.06 12007.33,-877.03 12007.66,-870.04"/>
<text text-anchor="middle" x="12279.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12279.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_6 -->
<g id="edge1719" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8645.54,-989.29C8612.49,-981.42 8577.74,-974.49 8544.79,-970.33 8495.71,-964.14 1465.13,-974.28 1420.79,-952.33 1405.73,-944.88 1411.85,-931.54 1397.79,-922.33 1366.31,-901.72 1327.15,-889.43 1291.46,-882.11"/>
<polygon fill="black" stroke="black" points="1291.97,-878.65 1281.49,-880.18 1290.64,-885.52 1291.97,-878.65"/>
<text text-anchor="middle" x="1466.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1466.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer4_gate_2_0&#45;&gt;layer4_expert1_7 -->
<g id="edge1720" class="edge">
<title>layer4_gate_2_0&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8970.43,-989.49C9003.37,-981.64 9037.98,-974.66 9070.79,-970.33 9107.5,-965.49 10377.78,-978.69 10403.79,-952.33 10413.16,-942.84 10412.45,-932.48 10403.79,-922.33 10375.81,-889.54 10266.63,-877.73 10183.51,-873.54"/>
<polygon fill="black" stroke="black" points="10183.66,-870.04 10173.51,-873.06 10183.33,-877.03 10183.66,-870.04"/>
<text text-anchor="middle" x="10455.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10455.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_0 -->
<g id="edge1721" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5289.19,-989.79C5321.93,-981.97 5356.26,-974.92 5388.79,-970.33 5451.43,-961.5 5902.86,-983.7 5957.79,-952.33 5971.5,-944.5 5963.32,-930.55 5976.79,-922.33 6016.13,-898.35 6296.42,-882.45 6449.9,-875.43"/>
<polygon fill="black" stroke="black" points="6450.44,-878.91 6460.27,-874.96 6450.12,-871.92 6450.44,-878.91"/>
<text text-anchor="middle" x="6022.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6022.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→0</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_1 -->
<g id="edge1722" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4963.18,-989.32C4930.23,-981.48 4895.61,-974.55 4862.79,-970.33 4827.94,-965.85 2357.55,-977.27 2332.79,-952.33 2265.09,-884.14 2621.36,-872.71 2801.95,-871.23"/>
<polygon fill="black" stroke="black" points="2802.02,-874.73 2812,-871.16 2801.97,-867.73 2802.02,-874.73"/>
<text text-anchor="middle" x="2378.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2378.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→2</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_2 -->
<g id="edge1723" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5288.41,-989.33C5321.36,-981.49 5355.97,-974.56 5388.79,-970.33 5454.72,-961.84 7723.68,-984.6 7781.79,-952.33 7795.59,-944.67 7787.41,-930.69 7800.79,-922.33 7858.77,-886.11 8043.18,-875.51 8159.85,-872.48"/>
<polygon fill="black" stroke="black" points="8159.97,-875.98 8169.88,-872.23 8159.79,-868.98 8159.97,-875.98"/>
<text text-anchor="middle" x="7846.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7846.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→4</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_3 -->
<g id="edge1724" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4962.76,-989.71C4929.92,-981.87 4895.46,-974.84 4862.79,-970.33 4823.92,-964.97 4184.18,-980.43 4156.79,-952.33 4089.71,-883.52 4445.67,-872.4 4626.06,-871.12"/>
<polygon fill="black" stroke="black" points="4626.12,-874.61 4636.1,-871.05 4626.08,-867.62 4626.12,-874.61"/>
<text text-anchor="middle" x="4202.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4202.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→6</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_4 -->
<g id="edge1725" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5288.04,-989.28C5321.09,-981.42 5355.84,-974.49 5388.79,-970.33 5442.98,-963.5 13205.97,-978.72 13253.79,-952.33 13267.61,-944.71 13259.41,-930.69 13272.79,-922.33 13330.77,-886.11 13515.18,-875.51 13631.85,-872.48"/>
<polygon fill="black" stroke="black" points="13631.97,-875.98 13641.88,-872.23 13631.79,-868.98 13631.97,-875.98"/>
<text text-anchor="middle" x="13318.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13318.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→8</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_5 -->
<g id="edge1726" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5288.04,-989.3C5321.1,-981.43 5355.84,-974.5 5388.79,-970.33 5430.41,-965.07 11393.07,-972.61 11429.79,-952.33 11443.61,-944.7 11435.41,-930.69 11448.79,-922.33 11506.77,-886.11 11691.18,-875.51 11807.85,-872.48"/>
<polygon fill="black" stroke="black" points="11807.97,-875.98 11817.88,-872.23 11807.79,-868.98 11807.97,-875.98"/>
<text text-anchor="middle" x="11494.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11494.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→10</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_6 -->
<g id="edge1727" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4963.54,-989.33C4930.48,-981.47 4895.74,-974.52 4862.79,-970.33 4833.58,-966.62 643.57,-973.2 622.79,-952.33 554.99,-884.24 911.31,-872.76 1091.93,-871.25"/>
<polygon fill="black" stroke="black" points="1092.01,-874.75 1101.98,-871.17 1091.96,-867.75 1092.01,-874.75"/>
<text text-anchor="middle" x="668.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="668.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→12</text>
</g>
<!-- layer4_gate_2_1&#45;&gt;layer4_expert1_7 -->
<g id="edge1728" class="edge">
<title>layer4_gate_2_1&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5288.04,-989.33C5321.1,-981.47 5355.85,-974.52 5388.79,-970.33 5446.89,-962.95 9554.54,-980.68 9605.79,-952.33 9619.6,-944.69 9611.41,-930.69 9624.79,-922.33 9682.77,-886.11 9867.18,-875.51 9983.85,-872.48"/>
<polygon fill="black" stroke="black" points="9983.97,-875.98 9993.88,-872.23 9983.79,-868.98 9983.97,-875.98"/>
<text text-anchor="middle" x="9670.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9670.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 9→14</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_0 -->
<g id="edge1729" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5818,-991.31C5849.96,-983.53 5883.28,-976.11 5914.79,-970.33 5983.87,-957.66 6009.08,-983.95 6071.79,-952.33 6088.08,-944.12 6083.5,-930.53 6099.79,-922.33 6159.19,-892.43 6336.54,-879.78 6450.05,-874.64"/>
<polygon fill="black" stroke="black" points="6450.32,-878.13 6460.15,-874.19 6450.01,-871.13 6450.32,-878.13"/>
<text text-anchor="middle" x="6145.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6145.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_1 -->
<g id="edge1730" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5489.18,-989.3C5456.23,-981.46 5421.62,-974.54 5388.79,-970.33 5348.26,-965.14 2475.6,-981.31 2446.79,-952.33 2437.39,-942.88 2437.9,-932.27 2446.79,-922.33 2470.04,-896.33 2675.24,-882.01 2802,-875.58"/>
<polygon fill="black" stroke="black" points="2802.31,-879.07 2812.12,-875.07 2801.96,-872.08 2802.31,-879.07"/>
<text text-anchor="middle" x="2492.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2492.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_2 -->
<g id="edge1731" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5814.41,-989.37C5847.36,-981.53 5881.97,-974.58 5914.79,-970.33 5969.37,-963.26 7847.7,-979.08 7895.79,-952.33 7909.58,-944.66 7901.56,-930.94 7914.79,-922.33 7954.22,-896.7 8072.84,-883.39 8160.02,-876.9"/>
<polygon fill="black" stroke="black" points="8160.5,-880.37 8170.22,-876.16 8159.99,-873.39 8160.5,-880.37"/>
<text text-anchor="middle" x="7960.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7960.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_3 -->
<g id="edge1732" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5489.15,-989.55C5456.2,-981.7 5421.6,-974.7 5388.79,-970.33 5358,-966.23 4292.58,-974.47 4270.79,-952.33 4261.44,-942.83 4261.9,-932.27 4270.79,-922.33 4294.04,-896.33 4499.24,-882.01 4626,-875.58"/>
<polygon fill="black" stroke="black" points="4626.31,-879.07 4636.12,-875.07 4625.96,-872.08 4626.31,-879.07"/>
<text text-anchor="middle" x="4316.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4316.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_4 -->
<g id="edge1733" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5814.04,-989.28C5847.09,-981.42 5881.84,-974.49 5914.79,-970.33 5966.14,-963.85 13322.48,-977.34 13367.79,-952.33 13381.61,-944.71 13373.56,-930.94 13386.79,-922.33 13426.22,-896.7 13544.84,-883.39 13632.02,-876.9"/>
<polygon fill="black" stroke="black" points="13632.5,-880.37 13642.22,-876.16 13631.99,-873.39 13632.5,-880.37"/>
<text text-anchor="middle" x="13432.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13432.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_5 -->
<g id="edge1734" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5814.04,-989.3C5847.1,-981.44 5881.84,-974.5 5914.79,-970.33 5953.57,-965.42 11509.57,-971.23 11543.79,-952.33 11557.61,-944.7 11549.56,-930.94 11562.79,-922.33 11602.22,-896.7 11720.84,-883.39 11808.02,-876.9"/>
<polygon fill="black" stroke="black" points="11808.5,-880.37 11818.22,-876.16 11807.99,-873.39 11808.5,-880.37"/>
<text text-anchor="middle" x="11608.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11608.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_6 -->
<g id="edge1735" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5489.54,-989.32C5456.48,-981.46 5421.74,-974.51 5388.79,-970.33 5356.74,-966.26 759.59,-975.22 736.79,-952.33 727.38,-942.89 727.9,-932.27 736.79,-922.33 760.04,-896.33 965.24,-882.01 1092,-875.58"/>
<polygon fill="black" stroke="black" points="1092.31,-879.07 1102.12,-875.07 1091.96,-872.08 1092.31,-879.07"/>
<text text-anchor="middle" x="782.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="782.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer4_gate_2_2&#45;&gt;layer4_expert1_7 -->
<g id="edge1736" class="edge">
<title>layer4_gate_2_2&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5814.04,-989.34C5847.1,-981.48 5881.85,-974.53 5914.79,-970.33 5967.22,-963.66 9673.55,-977.92 9719.79,-952.33 9733.6,-944.69 9725.56,-930.94 9738.79,-922.33 9778.22,-896.7 9896.84,-883.39 9984.02,-876.9"/>
<polygon fill="black" stroke="black" points="9984.5,-880.37 9994.22,-876.16 9983.99,-873.39 9984.5,-880.37"/>
<text text-anchor="middle" x="9784.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9784.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_0 -->
<g id="edge1737" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10749.54,-989.36C10716.48,-981.49 10681.74,-974.54 10648.79,-970.33 10601.76,-964.33 7277.26,-973.43 7234.79,-952.33 7219.74,-944.86 7226.56,-930.34 7211.79,-922.33 7163.67,-896.24 6822.44,-880.79 6649.6,-874.55"/>
<polygon fill="black" stroke="black" points="6649.6,-871.05 6639.48,-874.19 6649.35,-878.05 6649.6,-871.05"/>
<text text-anchor="middle" x="7280.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7280.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→0</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_1 -->
<g id="edge1738" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10749.54,-989.29C10716.49,-981.42 10681.74,-974.49 10648.79,-970.33 10600.14,-964.19 3630.74,-974.09 3586.79,-952.33 3571.73,-944.88 3578.56,-930.34 3563.79,-922.33 3515.67,-896.24 3174.44,-880.79 3001.6,-874.55"/>
<polygon fill="black" stroke="black" points="3001.6,-871.05 2991.48,-874.19 3001.35,-878.05 3001.6,-871.05"/>
<text text-anchor="middle" x="3632.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3632.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→2</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_2 -->
<g id="edge1739" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10749.16,-989.43C10716.22,-981.58 10681.61,-974.62 10648.79,-970.33 10604.99,-964.61 9098.29,-972.1 9058.79,-952.33 9043.77,-944.81 9050.61,-930.26 9035.79,-922.33 8977.61,-891.21 8555.83,-877.88 8359.65,-873.32"/>
<polygon fill="black" stroke="black" points="8359.7,-869.82 8349.62,-873.09 8359.54,-876.82 8359.7,-869.82"/>
<text text-anchor="middle" x="9104.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9104.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→4</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_3 -->
<g id="edge1740" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10749.54,-989.31C10716.49,-981.45 10681.74,-974.51 10648.79,-970.33 10576.62,-961.19 5475.98,-984.63 5410.79,-952.33 5395.74,-944.87 5402.56,-930.34 5387.79,-922.33 5339.67,-896.24 4998.44,-880.79 4825.6,-874.55"/>
<polygon fill="black" stroke="black" points="4825.6,-871.05 4815.48,-874.19 4825.35,-878.05 4825.6,-871.05"/>
<text text-anchor="middle" x="5456.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5456.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→6</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_4 -->
<g id="edge1741" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11074.4,-989.28C11107.35,-981.44 11141.96,-974.52 11174.79,-970.33 11197.75,-967.4 14491.47,-968.74 14507.79,-952.33 14517.19,-942.88 14516.91,-932.06 14507.79,-922.33 14462.52,-873.99 14030.78,-869.79 13831.59,-870.47"/>
<polygon fill="black" stroke="black" points="13831.4,-866.97 13821.41,-870.51 13831.43,-873.97 13831.4,-866.97"/>
<text text-anchor="middle" x="14559.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14559.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→8</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_5 -->
<g id="edge1742" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11074.42,-989.45C11107.37,-981.6 11141.98,-974.63 11174.79,-970.33 11195.57,-967.61 12669.06,-967.24 12683.79,-952.33 12693.16,-942.85 12692.91,-932.06 12683.79,-922.33 12638.52,-873.99 12206.78,-869.79 12007.59,-870.47"/>
<polygon fill="black" stroke="black" points="12007.4,-866.97 11997.41,-870.51 12007.43,-873.97 12007.4,-866.97"/>
<text text-anchor="middle" x="12735.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12735.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→10</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_6 -->
<g id="edge1743" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10749.55,-989.27C10716.49,-981.41 10681.74,-974.48 10648.79,-970.33 10588.44,-962.73 1946.96,-973.1 1889.79,-952.33 1870.22,-945.22 1873.09,-930.17 1853.79,-922.33 1754.64,-882.06 1451.08,-873.38 1291.77,-871.65"/>
<polygon fill="black" stroke="black" points="1291.53,-868.14 1281.49,-871.54 1291.46,-875.14 1291.53,-868.14"/>
<text text-anchor="middle" x="1935.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1935.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→12</text>
</g>
<!-- layer4_gate_2_3&#45;&gt;layer4_expert1_7 -->
<g id="edge1744" class="edge">
<title>layer4_gate_2_3&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10880.83,-970.33C10868.83,-951.68 10853.22,-933.48 10833.79,-922.33 10778.78,-890.77 10374.84,-877.73 10183.62,-873.29"/>
<polygon fill="black" stroke="black" points="10183.64,-869.79 10173.57,-873.06 10183.48,-876.79 10183.64,-869.79"/>
<text text-anchor="middle" x="10912.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10912.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 11→14</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_0 -->
<g id="edge1745" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10223.18,-989.29C10190.23,-981.46 10155.62,-974.53 10122.79,-970.33 10081.43,-965.04 7158.13,-970.89 7120.79,-952.33 7105.75,-944.85 7112.5,-930.46 7097.79,-922.33 7023.13,-881.08 6786.09,-872.56 6649.46,-871.18"/>
<polygon fill="black" stroke="black" points="6649.42,-867.68 6639.39,-871.09 6649.36,-874.68 6649.42,-867.68"/>
<text text-anchor="middle" x="7166.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7166.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_1 -->
<g id="edge1746" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10223.54,-989.29C10190.49,-981.43 10155.74,-974.49 10122.79,-970.33 10076.97,-964.54 3514.18,-972.82 3472.79,-952.33 3457.73,-944.88 3464.5,-930.46 3449.79,-922.33 3375.13,-881.08 3138.09,-872.56 3001.46,-871.18"/>
<polygon fill="black" stroke="black" points="3001.42,-867.68 2991.39,-871.09 3001.36,-874.68 3001.42,-867.68"/>
<text text-anchor="middle" x="3518.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3518.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_2 -->
<g id="edge1747" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10223.15,-989.53C10190.2,-981.68 10155.6,-974.69 10122.79,-970.33 10057.91,-961.72 9003.26,-981.74 8944.79,-952.33 8929.78,-944.78 8936.56,-930.34 8921.79,-922.33 8873.67,-896.24 8532.44,-880.79 8359.6,-874.55"/>
<polygon fill="black" stroke="black" points="8359.6,-871.05 8349.48,-874.19 8359.35,-878.05 8359.6,-871.05"/>
<text text-anchor="middle" x="8990.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8990.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_3 -->
<g id="edge1748" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10223.54,-989.32C10190.49,-981.45 10155.74,-974.51 10122.79,-970.33 10056.3,-961.9 5356.85,-982.1 5296.79,-952.33 5281.74,-944.87 5288.5,-930.46 5273.79,-922.33 5199.13,-881.08 4962.09,-872.56 4825.46,-871.18"/>
<polygon fill="black" stroke="black" points="4825.42,-867.68 4815.39,-871.09 4825.36,-874.68 4825.42,-867.68"/>
<text text-anchor="middle" x="5342.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5342.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_4 -->
<g id="edge1749" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10548.05,-989.35C10581.1,-981.48 10615.85,-974.53 10648.79,-970.33 10674.59,-967.05 14375.45,-970.77 14393.79,-952.33 14403.2,-942.88 14402.85,-932.12 14393.79,-922.33 14356.44,-881.99 14007.04,-873.45 13831.48,-871.72"/>
<polygon fill="black" stroke="black" points="13831.49,-868.22 13821.46,-871.63 13831.43,-875.22 13831.49,-868.22"/>
<text text-anchor="middle" x="14445.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="14445.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_5 -->
<g id="edge1750" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10548.41,-989.38C10581.36,-981.54 10615.97,-974.59 10648.79,-970.33 10675.25,-966.9 12551.01,-971.29 12569.79,-952.33 12579.18,-942.86 12578.85,-932.12 12569.79,-922.33 12532.44,-881.99 12183.04,-873.45 12007.48,-871.72"/>
<polygon fill="black" stroke="black" points="12007.49,-868.22 11997.46,-871.63 12007.43,-875.22 12007.49,-868.22"/>
<text text-anchor="middle" x="12621.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12621.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_6 -->
<g id="edge1751" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10223.55,-989.28C10190.49,-981.42 10155.74,-974.49 10122.79,-970.33 10065.19,-963.07 1814.83,-978.08 1762.79,-952.33 1747.73,-944.88 1754.5,-930.46 1739.79,-922.33 1665.13,-881.08 1428.09,-872.56 1291.46,-871.18"/>
<polygon fill="black" stroke="black" points="1291.42,-867.68 1281.39,-871.09 1291.36,-874.68 1291.42,-867.68"/>
<text text-anchor="middle" x="1808.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1808.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer4_gate_3_0&#45;&gt;layer4_expert1_7 -->
<g id="edge1752" class="edge">
<title>layer4_gate_3_0&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10555.33,-993.06C10586.37,-985.29 10618.52,-977.42 10648.79,-970.33 10685.97,-961.63 10708.79,-982.02 10732.79,-952.33 10741.17,-941.96 10741.84,-932.12 10732.79,-922.33 10696.33,-882.89 10356.19,-873.9 10183.45,-871.89"/>
<polygon fill="black" stroke="black" points="10183.37,-868.39 10173.33,-871.78 10183.29,-875.39 10183.37,-868.39"/>
<text text-anchor="middle" x="10784.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10784.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_0 -->
<g id="edge1753" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7592.79,-989.55C7559.94,-981.72 7525.47,-974.73 7492.79,-970.33 7466.85,-966.84 6569.23,-970.9 6550.79,-952.33 6541.16,-942.63 6538.69,-928.62 6539.35,-914.96"/>
<polygon fill="black" stroke="black" points="6542.87,-914.97 6540.39,-904.67 6535.9,-914.27 6542.87,-914.97"/>
<text text-anchor="middle" x="6596.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6596.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→0</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_1 -->
<g id="edge1754" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7593.54,-989.32C7560.48,-981.46 7525.74,-974.51 7492.79,-970.33 7461.17,-966.32 2925.43,-974.78 2902.79,-952.33 2892.91,-942.53 2890.52,-928.2 2891.3,-914.31"/>
<polygon fill="black" stroke="black" points="2894.79,-914.66 2892.37,-904.34 2887.83,-913.91 2894.79,-914.66"/>
<text text-anchor="middle" x="2948.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2948.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→2</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_2 -->
<g id="edge1755" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7919.98,-990.2C7952.49,-982.39 7986.54,-975.25 8018.79,-970.33 8055.42,-964.75 8326.31,-979.23 8351.79,-952.33 8365.38,-937.99 8357.02,-923.41 8340.84,-910.63"/>
<polygon fill="black" stroke="black" points="8342.5,-907.51 8332.33,-904.52 8338.41,-913.2 8342.5,-907.51"/>
<text text-anchor="middle" x="8403.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8403.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→4</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_3 -->
<g id="edge1756" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7593.18,-989.31C7560.23,-981.47 7525.62,-974.54 7492.79,-970.33 7454.69,-965.44 4754.04,-979.42 4726.79,-952.33 4717.1,-942.69 4714.62,-928.69 4715.28,-915.03"/>
<polygon fill="black" stroke="black" points="4718.8,-915.04 4716.33,-904.73 4711.83,-914.33 4718.8,-915.04"/>
<text text-anchor="middle" x="4772.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4772.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→6</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_4 -->
<g id="edge1757" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7918.04,-989.3C7951.1,-981.44 7985.84,-974.5 8018.79,-970.33 8058.79,-965.27 13795.33,-980.88 13823.79,-952.33 13838.06,-938.02 13829.08,-923.18 13812.15,-910.18"/>
<polygon fill="black" stroke="black" points="13814.05,-907.24 13803.86,-904.34 13810.02,-912.96 13814.05,-907.24"/>
<text text-anchor="middle" x="13876.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13876.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→8</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_5 -->
<g id="edge1758" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7918.04,-989.34C7951.1,-981.47 7985.85,-974.52 8018.79,-970.33 8046.22,-966.84 11980.29,-971.93 11999.79,-952.33 12013.98,-938.08 12005.15,-923.31 11988.36,-910.34"/>
<polygon fill="black" stroke="black" points="11990.33,-907.45 11980.15,-904.52 11986.28,-913.16 11990.33,-907.45"/>
<text text-anchor="middle" x="12052.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="12052.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→10</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_6 -->
<g id="edge1759" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7593.54,-989.3C7560.49,-981.43 7525.74,-974.5 7492.79,-970.33 7471.09,-967.59 1208.33,-967.73 1192.79,-952.33 1182.9,-942.54 1180.51,-928.21 1181.3,-914.31"/>
<polygon fill="black" stroke="black" points="1184.78,-914.66 1182.37,-904.35 1177.82,-913.91 1184.78,-914.66"/>
<text text-anchor="middle" x="1238.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1238.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→12</text>
</g>
<!-- layer4_gate_3_1&#45;&gt;layer4_expert1_7 -->
<g id="edge1760" class="edge">
<title>layer4_gate_3_1&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7918.41,-989.35C7951.36,-981.51 7985.97,-974.57 8018.79,-970.33 8048.5,-966.49 10154.7,-973.6 10175.79,-952.33 10189.96,-938.05 10181.12,-923.27 10164.33,-910.31"/>
<polygon fill="black" stroke="black" points="10166.3,-907.41 10156.12,-904.49 10162.25,-913.13 10166.3,-907.41"/>
<text text-anchor="middle" x="10228.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10228.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 13→14</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_0 -->
<g id="edge1761" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4236.42,-989.47C4269.37,-981.62 4303.98,-974.65 4336.79,-970.33 4375.16,-965.29 5696.01,-971.21 5729.79,-952.33 5743.57,-944.63 5735.21,-930.38 5748.79,-922.33 5807.71,-887.42 6248.46,-876.05 6449.89,-872.66"/>
<polygon fill="black" stroke="black" points="6450.24,-876.15 6460.18,-872.49 6450.12,-869.15 6450.24,-876.15"/>
<text text-anchor="middle" x="5794.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="5794.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_1 -->
<g id="edge1762" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3911.17,-989.41C3878.22,-981.57 3843.61,-974.61 3810.79,-970.33 3787.29,-967.27 2121.46,-969.18 2104.79,-952.33 2095.41,-942.85 2095.67,-932.06 2104.79,-922.33 2128.3,-897.27 2593.39,-880.44 2802.01,-874.12"/>
<polygon fill="black" stroke="black" points="2802.16,-877.62 2812.05,-873.82 2801.95,-870.62 2802.16,-877.62"/>
<text text-anchor="middle" x="2150.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2150.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_2 -->
<g id="edge1763" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4236.4,-989.28C4269.35,-981.45 4303.96,-974.53 4336.79,-970.33 4381.11,-964.67 7514.71,-973.98 7553.79,-952.33 7567.6,-944.68 7559.26,-930.45 7572.79,-922.33 7621.87,-892.9 7981.62,-878.97 8160.03,-873.81"/>
<polygon fill="black" stroke="black" points="8160.32,-877.31 8170.21,-873.52 8160.12,-870.31 8160.32,-877.31"/>
<text text-anchor="middle" x="7618.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="7618.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_3 -->
<g id="edge1764" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3945.79,-971.04C3931.1,-955.68 3926.22,-938.95 3941.79,-922.33 3964.84,-897.74 4419.69,-880.72 4625.8,-874.24"/>
<polygon fill="black" stroke="black" points="4626.14,-877.73 4636.02,-873.92 4625.92,-870.73 4626.14,-877.73"/>
<text text-anchor="middle" x="3987.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="3987.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_4 -->
<g id="edge1765" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4236.04,-989.27C4269.09,-981.41 4303.84,-974.48 4336.79,-970.33 4396.66,-962.79 12972.96,-981.48 13025.79,-952.33 13039.61,-944.71 13031.26,-930.45 13044.79,-922.33 13093.87,-892.9 13453.62,-878.97 13632.03,-873.81"/>
<polygon fill="black" stroke="black" points="13632.32,-877.31 13642.21,-873.52 13632.12,-870.31 13632.32,-877.31"/>
<text text-anchor="middle" x="13090.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13090.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_5 -->
<g id="edge1766" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4236.04,-989.29C4269.09,-981.43 4303.84,-974.49 4336.79,-970.33 4384.09,-964.36 11160.06,-975.37 11201.79,-952.33 11215.61,-944.7 11207.26,-930.45 11220.79,-922.33 11269.87,-892.9 11629.62,-878.97 11808.03,-873.81"/>
<polygon fill="black" stroke="black" points="11808.32,-877.31 11818.21,-873.52 11808.12,-870.31 11808.32,-877.31"/>
<text text-anchor="middle" x="11266.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11266.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_6 -->
<g id="edge1767" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3911.54,-989.36C3878.48,-981.49 3843.74,-974.54 3810.79,-970.33 3787.26,-967.33 411.52,-969.15 394.79,-952.33 385.39,-942.88 385.67,-932.06 394.79,-922.33 418.3,-897.27 883.39,-880.44 1092.01,-874.12"/>
<polygon fill="black" stroke="black" points="1092.16,-877.62 1102.05,-873.82 1091.95,-870.62 1092.16,-877.62"/>
<text text-anchor="middle" x="440.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="440.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer4_gate_3_2&#45;&gt;layer4_expert1_7 -->
<g id="edge1768" class="edge">
<title>layer4_gate_3_2&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4236.04,-989.31C4269.1,-981.45 4303.84,-974.51 4336.79,-970.33 4371.52,-965.93 9347.15,-969.27 9377.79,-952.33 9391.6,-944.7 9383.26,-930.45 9396.79,-922.33 9445.87,-892.9 9805.62,-878.97 9984.03,-873.81"/>
<polygon fill="black" stroke="black" points="9984.32,-877.31 9994.21,-873.52 9984.12,-870.31 9984.32,-877.31"/>
<text text-anchor="middle" x="9442.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="9442.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_0 -->
<g id="edge1769" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7066.38,-989.85C7033.65,-982.02 6999.32,-974.96 6966.79,-970.33 6937.62,-966.18 6457.27,-973.52 6436.79,-952.33 6421.24,-936.24 6431.77,-921.18 6451.54,-908.51"/>
<polygon fill="black" stroke="black" points="6453.36,-911.51 6460.2,-903.42 6449.8,-905.47 6453.36,-911.51"/>
<text text-anchor="middle" x="6482.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="6482.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→0</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_1 -->
<g id="edge1770" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7067.54,-989.33C7034.48,-981.47 6999.74,-974.52 6966.79,-970.33 6938.01,-966.67 2809.26,-972.89 2788.79,-952.33 2772.92,-936.4 2783.57,-921.33 2803.54,-908.62"/>
<polygon fill="black" stroke="black" points="2805.42,-911.57 2812.27,-903.5 2801.88,-905.53 2805.42,-911.57"/>
<text text-anchor="middle" x="2834.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="2834.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→2</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_2 -->
<g id="edge1771" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7392.82,-989.68C7425.65,-981.84 7460.12,-974.82 7492.79,-970.33 7533.81,-964.7 8205.21,-977.87 8237.79,-952.33 8249.33,-943.29 8255.19,-928.85 8258.07,-914.65"/>
<polygon fill="black" stroke="black" points="8261.58,-914.85 8259.67,-904.43 8254.66,-913.77 8261.58,-914.85"/>
<text text-anchor="middle" x="8301.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="8301.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→4</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_3 -->
<g id="edge1772" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7067.18,-989.34C7034.23,-981.5 6999.61,-974.56 6966.79,-970.33 6934.36,-966.15 4635.82,-975.54 4612.79,-952.33 4597.03,-936.45 4607.51,-921.44 4627.29,-908.76"/>
<polygon fill="black" stroke="black" points="4629.11,-911.75 4635.95,-903.66 4625.56,-905.72 4629.11,-911.75"/>
<text text-anchor="middle" x="4658.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="4658.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→6</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_4 -->
<g id="edge1773" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7392.04,-989.3C7425.1,-981.43 7459.84,-974.5 7492.79,-970.33 7535.62,-964.92 13675.53,-978.61 13709.79,-952.33 13721.42,-943.41 13727.31,-929 13730.17,-914.78"/>
<polygon fill="black" stroke="black" points="13733.68,-914.97 13731.76,-904.55 13726.77,-913.89 13733.68,-914.97"/>
<text text-anchor="middle" x="13773.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="13773.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→8</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_5 -->
<g id="edge1774" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7392.04,-989.33C7425.1,-981.46 7459.84,-974.52 7492.79,-970.33 7523.06,-966.49 11861.59,-970.91 11885.79,-952.33 11897.42,-943.41 11903.3,-928.99 11906.17,-914.77"/>
<polygon fill="black" stroke="black" points="11909.68,-914.96 11907.75,-904.54 11902.76,-913.89 11909.68,-914.96"/>
<text text-anchor="middle" x="11949.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="11949.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→10</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_6 -->
<g id="edge1775" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7067.54,-989.3C7034.49,-981.44 6999.74,-974.5 6966.79,-970.33 6926.23,-965.2 1107.66,-981.29 1078.79,-952.33 1062.91,-936.41 1073.56,-921.35 1093.52,-908.63"/>
<polygon fill="black" stroke="black" points="1095.4,-911.58 1102.26,-903.51 1091.87,-905.54 1095.4,-911.58"/>
<text text-anchor="middle" x="1124.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="1124.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→12</text>
</g>
<!-- layer4_gate_3_3&#45;&gt;layer4_expert1_7 -->
<g id="edge1776" class="edge">
<title>layer4_gate_3_3&#45;&gt;layer4_expert1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7392.4,-989.32C7425.35,-981.48 7459.97,-974.55 7492.79,-970.33 7528.18,-965.78 10033.52,-974.1 10061.79,-952.33 10073.4,-943.39 10079.29,-928.97 10082.15,-914.76"/>
<polygon fill="black" stroke="black" points="10085.66,-914.94 10083.74,-904.52 10078.75,-913.87 10085.66,-914.94"/>
<text text-anchor="middle" x="10125.29" y="-941.13" font-family="Times,serif" font-size="14.00">route tokens</text>
<text text-anchor="middle" x="10125.29" y="-926.13" font-family="Times,serif" font-size="14.00">GPU 15→14</text>
</g>
<!-- layer4_expert_gelu_0 -->
<g id="node662" class="node">
<title>layer4_expert_gelu_0</title>
<ellipse fill="lightgray" stroke="black" cx="7149.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="7149.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="7149.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7149.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer4_expert1_0&#45;&gt;layer4_expert_gelu_0 -->
<g id="edge1777" class="edge">
<title>layer4_expert1_0&#45;&gt;layer4_expert_gelu_0</title>
<path fill="none" stroke="black" d="M6639.36,-858.16C6731.64,-846.05 6879.42,-824.98 7005.79,-799.33 7019.32,-796.59 7033.48,-793.4 7047.42,-790.07"/>
<polygon fill="black" stroke="black" points="7048.63,-793.38 7057.52,-787.62 7046.98,-786.57 7048.63,-793.38"/>
</g>
<!-- layer4_expert2_0 -->
<g id="node663" class="node">
<title>layer4_expert2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="7296.29,-687.38 7111.29,-687.38 7111.29,-619.38 7296.29,-619.38 7296.29,-687.38"/>
<text text-anchor="middle" x="7203.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 0 Second Linear</text>
<text text-anchor="middle" x="7203.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7203.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="7203.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_0&#45;&gt;layer4_expert2_0 -->
<g id="edge1778" class="edge">
<title>layer4_expert_gelu_0&#45;&gt;layer4_expert2_0</title>
<path fill="none" stroke="black" d="M7168.22,-724.51C7172.76,-715.56 7177.66,-705.91 7182.33,-696.71"/>
<polygon fill="black" stroke="black" points="7185.49,-698.2 7186.89,-687.7 7179.25,-695.03 7185.49,-698.2"/>
</g>
<!-- layer4_expert_agg_0_0 -->
<g id="node685" class="node">
<title>layer4_expert_agg_0_0</title>
<polygon fill="darkseagreen" stroke="black" points="2512.88,-459.53 2512.88,-512.18 2402.12,-549.4 2245.47,-549.4 2134.7,-512.18 2134.7,-459.53 2245.47,-422.3 2402.12,-422.3 2512.88,-459.53"/>
<polygon fill="none" stroke="black" points="2516.88,-456.65 2516.88,-515.05 2402.77,-553.4 2244.81,-553.4 2130.7,-515.05 2130.7,-456.65 2244.81,-418.3 2402.77,-418.3 2516.88,-456.65"/>
<text text-anchor="middle" x="2323.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2323.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:0,0</text>
<text text-anchor="middle" x="2323.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="2323.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="2323.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1793" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.88C7108.28,-620.32 7105.52,-619.82 7102.79,-619.38 7069.2,-613.97 2226.81,-625.48 2202.79,-601.38 2186.18,-584.71 2192.35,-567.06 2208.51,-550.74"/>
<polygon fill="black" stroke="black" points="2211.02,-553.19 2216,-543.84 2206.28,-548.04 2211.02,-553.19"/>
<text text-anchor="middle" x="2252.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2252.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→0</text>
</g>
<!-- layer4_expert_agg_0_1 -->
<g id="node686" class="node">
<title>layer4_expert_agg_0_1</title>
<polygon fill="darkseagreen" stroke="black" points="7392.88,-459.53 7392.88,-512.18 7282.12,-549.4 7125.47,-549.4 7014.7,-512.18 7014.7,-459.53 7125.47,-422.3 7282.12,-422.3 7392.88,-459.53"/>
<polygon fill="none" stroke="black" points="7396.88,-456.65 7396.88,-515.05 7282.77,-553.4 7124.81,-553.4 7010.7,-515.05 7010.7,-456.65 7124.81,-418.3 7282.77,-418.3 7396.88,-456.65"/>
<text text-anchor="middle" x="7203.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7203.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:0,1</text>
<text text-anchor="middle" x="7203.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7203.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="7203.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1794" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.09,-620.85C7097.78,-614.56 7087.11,-607.88 7082.79,-601.38 7070.97,-583.57 7076.06,-566.5 7089.28,-551.22"/>
<polygon fill="black" stroke="black" points="7091.95,-553.49 7096.38,-543.87 7086.92,-548.63 7091.95,-553.49"/>
<text text-anchor="middle" x="7132.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7132.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
</g>
<!-- layer4_expert_agg_0_2 -->
<g id="node687" class="node">
<title>layer4_expert_agg_0_2</title>
<polygon fill="darkseagreen" stroke="black" points="5440.88,-459.53 5440.88,-512.18 5330.12,-549.4 5173.47,-549.4 5062.7,-512.18 5062.7,-459.53 5173.47,-422.3 5330.12,-422.3 5440.88,-459.53"/>
<polygon fill="none" stroke="black" points="5444.88,-456.65 5444.88,-515.05 5330.77,-553.4 5172.81,-553.4 5058.7,-515.05 5058.7,-456.65 5172.81,-418.3 5330.77,-418.3 5444.88,-456.65"/>
<text text-anchor="middle" x="5251.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5251.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:0,2</text>
<text text-anchor="middle" x="5251.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="5251.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="5251.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1795" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.9C7108.28,-620.33 7105.52,-619.83 7102.79,-619.38 7075.76,-614.95 5150.07,-620.83 5130.79,-601.38 5114.22,-584.66 5120.42,-567 5136.57,-550.68"/>
<polygon fill="black" stroke="black" points="5139.08,-553.13 5144.07,-543.78 5134.34,-547.98 5139.08,-553.13"/>
<text text-anchor="middle" x="5180.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5180.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→2</text>
</g>
<!-- layer4_expert_agg_0_3 -->
<g id="node688" class="node">
<title>layer4_expert_agg_0_3</title>
<polygon fill="darkseagreen" stroke="black" points="10198.88,-459.53 10198.88,-512.18 10088.12,-549.4 9931.47,-549.4 9820.7,-512.18 9820.7,-459.53 9931.47,-422.3 10088.12,-422.3 10198.88,-459.53"/>
<polygon fill="none" stroke="black" points="10202.88,-456.65 10202.88,-515.05 10088.77,-553.4 9930.81,-553.4 9816.7,-515.05 9816.7,-456.65 9930.81,-418.3 10088.77,-418.3 10202.88,-456.65"/>
<text text-anchor="middle" x="10009.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10009.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:0,3</text>
<text text-anchor="middle" x="10009.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10009.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="10009.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1796" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.36,-647.55C7444.45,-640.06 7743.84,-625.8 7997.79,-619.38 8025.42,-618.68 9966.56,-619.08 9987.79,-601.38 9994.49,-595.8 9999.17,-581.01 10002.43,-563.85"/>
<polygon fill="black" stroke="black" points="10005.96,-563.97 10004.19,-553.52 9999.06,-562.79 10005.96,-563.97"/>
<text text-anchor="middle" x="10049.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10049.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→3</text>
</g>
<!-- layer4_expert_agg_1_0 -->
<g id="node689" class="node">
<title>layer4_expert_agg_1_0</title>
<polygon fill="darkseagreen" stroke="black" points="12150.88,-459.53 12150.88,-512.18 12040.12,-549.4 11883.47,-549.4 11772.7,-512.18 11772.7,-459.53 11883.47,-422.3 12040.12,-422.3 12150.88,-459.53"/>
<polygon fill="none" stroke="black" points="12154.88,-456.65 12154.88,-515.05 12040.77,-553.4 11882.81,-553.4 11768.7,-515.05 11768.7,-456.65 11882.81,-418.3 12040.77,-418.3 12154.88,-456.65"/>
<text text-anchor="middle" x="11961.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11961.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:1,0</text>
<text text-anchor="middle" x="11961.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11961.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="11961.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1797" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.36,-647.42C7444.45,-639.74 7743.83,-625.23 7997.79,-619.38 8025.16,-618.75 11918.73,-618.86 11939.79,-601.38 11946.5,-595.81 11951.18,-581.03 11954.45,-563.87"/>
<polygon fill="black" stroke="black" points="11957.98,-563.99 11956.21,-553.54 11951.08,-562.81 11957.98,-563.99"/>
<text text-anchor="middle" x="12001.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12001.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→4</text>
</g>
<!-- layer4_expert_agg_1_1 -->
<g id="node690" class="node">
<title>layer4_expert_agg_1_1</title>
<polygon fill="darkseagreen" stroke="black" points="8246.88,-459.53 8246.88,-512.18 8136.12,-549.4 7979.47,-549.4 7868.7,-512.18 7868.7,-459.53 7979.47,-422.3 8136.12,-422.3 8246.88,-459.53"/>
<polygon fill="none" stroke="black" points="8250.88,-456.65 8250.88,-515.05 8136.77,-553.4 7978.81,-553.4 7864.7,-515.05 7864.7,-456.65 7978.81,-418.3 8136.77,-418.3 8250.88,-456.65"/>
<text text-anchor="middle" x="8057.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8057.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:1,1</text>
<text text-anchor="middle" x="8057.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8057.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="8057.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1798" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.47,-652.98C7501.81,-653.43 7981.31,-649.27 8035.79,-601.38 8042.31,-595.65 8046.92,-580.93 8050.19,-563.87"/>
<polygon fill="black" stroke="black" points="8053.71,-564.06 8051.95,-553.61 8046.81,-562.87 8053.71,-564.06"/>
<text text-anchor="middle" x="8097.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8097.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→5</text>
</g>
<!-- layer4_expert_agg_1_2 -->
<g id="node691" class="node">
<title>layer4_expert_agg_1_2</title>
<polygon fill="darkseagreen" stroke="black" points="3488.88,-459.53 3488.88,-512.18 3378.12,-549.4 3221.47,-549.4 3110.7,-512.18 3110.7,-459.53 3221.47,-422.3 3378.12,-422.3 3488.88,-459.53"/>
<polygon fill="none" stroke="black" points="3492.88,-456.65 3492.88,-515.05 3378.77,-553.4 3220.81,-553.4 3106.7,-515.05 3106.7,-456.65 3220.81,-418.3 3378.77,-418.3 3492.88,-456.65"/>
<text text-anchor="middle" x="3299.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3299.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:1,2</text>
<text text-anchor="middle" x="3299.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="3299.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="3299.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1799" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.88C7108.28,-620.32 7105.52,-619.82 7102.79,-619.38 7075.89,-615.03 3198.02,-620.69 3178.79,-601.38 3162.19,-584.7 3168.36,-567.05 3184.52,-550.73"/>
<polygon fill="black" stroke="black" points="3187.03,-553.18 3192.01,-543.83 3182.29,-548.03 3187.03,-553.18"/>
<text text-anchor="middle" x="3228.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3228.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→6</text>
</g>
<!-- layer4_expert_agg_1_3 -->
<g id="node692" class="node">
<title>layer4_expert_agg_1_3</title>
<polygon fill="darkseagreen" stroke="black" points="15078.88,-459.53 15078.88,-512.18 14968.12,-549.4 14811.47,-549.4 14700.7,-512.18 14700.7,-459.53 14811.47,-422.3 14968.12,-422.3 15078.88,-459.53"/>
<polygon fill="none" stroke="black" points="15082.88,-456.65 15082.88,-515.05 14968.77,-553.4 14810.81,-553.4 14696.7,-515.05 14696.7,-456.65 14810.81,-418.3 14968.77,-418.3 15082.88,-456.65"/>
<text text-anchor="middle" x="14889.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14889.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:1,3</text>
<text text-anchor="middle" x="14889.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="14889.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="14889.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1800" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.35,-647.36C7444.44,-639.6 7743.82,-624.99 7997.79,-619.38 8021.64,-618.85 14849.42,-616.6 14867.79,-601.38 14874.5,-595.82 14879.19,-581.04 14882.45,-563.88"/>
<polygon fill="black" stroke="black" points="14885.98,-564 14884.21,-553.55 14879.08,-562.82 14885.98,-564"/>
<text text-anchor="middle" x="14929.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14929.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→7</text>
</g>
<!-- layer4_expert_agg_2_0 -->
<g id="node693" class="node">
<title>layer4_expert_agg_2_0</title>
<polygon fill="darkseagreen" stroke="black" points="13126.88,-459.53 13126.88,-512.18 13016.12,-549.4 12859.47,-549.4 12748.7,-512.18 12748.7,-459.53 12859.47,-422.3 13016.12,-422.3 13126.88,-459.53"/>
<polygon fill="none" stroke="black" points="13130.88,-456.65 13130.88,-515.05 13016.77,-553.4 12858.81,-553.4 12744.7,-515.05 12744.7,-456.65 12858.81,-418.3 13016.77,-418.3 13130.88,-456.65"/>
<text text-anchor="middle" x="12937.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12937.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:2,0</text>
<text text-anchor="middle" x="12937.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="12937.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12937.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1801" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.35,-647.39C7444.44,-639.67 7743.83,-625.12 7997.79,-619.38 8031.94,-618.61 12889.5,-623.18 12915.79,-601.38 12922.5,-595.81 12927.19,-581.04 12930.45,-563.88"/>
<polygon fill="black" stroke="black" points="12933.98,-563.99 12932.21,-553.55 12927.08,-562.82 12933.98,-563.99"/>
<text text-anchor="middle" x="12977.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12977.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→8</text>
</g>
<!-- layer4_expert_agg_2_1 -->
<g id="node694" class="node">
<title>layer4_expert_agg_2_1</title>
<polygon fill="darkseagreen" stroke="black" points="11174.88,-459.53 11174.88,-512.18 11064.12,-549.4 10907.47,-549.4 10796.7,-512.18 10796.7,-459.53 10907.47,-422.3 11064.12,-422.3 11174.88,-459.53"/>
<polygon fill="none" stroke="black" points="11178.88,-456.65 11178.88,-515.05 11064.77,-553.4 10906.81,-553.4 10792.7,-515.05 10792.7,-456.65 10906.81,-418.3 11064.77,-418.3 11178.88,-456.65"/>
<text text-anchor="middle" x="10985.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10985.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:2,1</text>
<text text-anchor="middle" x="10985.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="10985.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10985.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1802" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.36,-647.47C7444.45,-639.84 7743.83,-625.43 7997.79,-619.38 8018.38,-618.89 10947.95,-614.55 10963.79,-601.38 10970.49,-595.81 10975.18,-581.03 10978.44,-563.87"/>
<polygon fill="black" stroke="black" points="10981.97,-563.98 10980.2,-553.54 10975.07,-562.81 10981.97,-563.98"/>
<text text-anchor="middle" x="11025.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11025.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→9</text>
</g>
<!-- layer4_expert_agg_2_2 -->
<g id="node695" class="node">
<title>layer4_expert_agg_2_2</title>
<polygon fill="darkseagreen" stroke="black" points="6416.88,-459.53 6416.88,-512.18 6306.12,-549.4 6149.47,-549.4 6038.7,-512.18 6038.7,-459.53 6149.47,-422.3 6306.12,-422.3 6416.88,-459.53"/>
<polygon fill="none" stroke="black" points="6420.88,-456.65 6420.88,-515.05 6306.77,-553.4 6148.81,-553.4 6034.7,-515.05 6034.7,-456.65 6148.81,-418.3 6306.77,-418.3 6420.88,-456.65"/>
<text text-anchor="middle" x="6227.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6227.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:2,2</text>
<text text-anchor="middle" x="6227.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6227.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="6227.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1803" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.93C7108.28,-620.36 7105.52,-619.84 7102.79,-619.38 7075.5,-614.78 6126.18,-621.12 6106.79,-601.38 6090.39,-584.68 6096.45,-567.09 6112.42,-550.84"/>
<polygon fill="black" stroke="black" points="6114.87,-553.33 6119.83,-543.97 6110.11,-548.2 6114.87,-553.33"/>
<text text-anchor="middle" x="6156.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6156.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→10</text>
</g>
<!-- layer4_expert_agg_2_3 -->
<g id="node696" class="node">
<title>layer4_expert_agg_2_3</title>
<polygon fill="darkseagreen" stroke="black" points="9222.88,-459.53 9222.88,-512.18 9112.12,-549.4 8955.47,-549.4 8844.7,-512.18 8844.7,-459.53 8955.47,-422.3 9112.12,-422.3 9222.88,-459.53"/>
<polygon fill="none" stroke="black" points="9226.88,-456.65 9226.88,-515.05 9112.77,-553.4 8954.81,-553.4 8840.7,-515.05 8840.7,-456.65 8954.81,-418.3 9112.77,-418.3 9226.88,-456.65"/>
<text text-anchor="middle" x="9033.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9033.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:2,3</text>
<text text-anchor="middle" x="9033.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9033.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9033.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1804" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.37,-647.82C7444.47,-640.68 7743.87,-626.91 7997.79,-619.38 8025.95,-618.54 8990.23,-619.51 9011.79,-601.38 9018.46,-595.77 9023.13,-580.98 9026.4,-563.81"/>
<polygon fill="black" stroke="black" points="9029.93,-563.93 9028.16,-553.49 9023.03,-562.75 9029.93,-563.93"/>
<text text-anchor="middle" x="9073.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9073.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→11</text>
</g>
<!-- layer4_expert_agg_3_0 -->
<g id="node697" class="node">
<title>layer4_expert_agg_3_0</title>
<polygon fill="darkseagreen" stroke="black" points="1536.88,-459.53 1536.88,-512.18 1426.12,-549.4 1269.47,-549.4 1158.7,-512.18 1158.7,-459.53 1269.47,-422.3 1426.12,-422.3 1536.88,-459.53"/>
<polygon fill="none" stroke="black" points="1540.88,-456.65 1540.88,-515.05 1426.77,-553.4 1268.81,-553.4 1154.7,-515.05 1154.7,-456.65 1268.81,-418.3 1426.77,-418.3 1540.88,-456.65"/>
<text text-anchor="middle" x="1347.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1347.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:3,0</text>
<text text-anchor="middle" x="1347.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="1347.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="1347.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1805" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.87C7108.28,-620.32 7105.52,-619.82 7102.79,-619.38 7062.5,-612.9 1255.6,-630.28 1226.79,-601.38 1210.17,-584.71 1216.35,-567.07 1232.5,-550.75"/>
<polygon fill="black" stroke="black" points="1235.01,-553.2 1240,-543.85 1230.27,-548.05 1235.01,-553.2"/>
<text text-anchor="middle" x="1276.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1276.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→12</text>
</g>
<!-- layer4_expert_agg_3_1 -->
<g id="node698" class="node">
<title>layer4_expert_agg_3_1</title>
<polygon fill="darkseagreen" stroke="black" points="4464.88,-459.53 4464.88,-512.18 4354.12,-549.4 4197.47,-549.4 4086.7,-512.18 4086.7,-459.53 4197.47,-422.3 4354.12,-422.3 4464.88,-459.53"/>
<polygon fill="none" stroke="black" points="4468.88,-456.65 4468.88,-515.05 4354.77,-553.4 4196.81,-553.4 4082.7,-515.05 4082.7,-456.65 4196.81,-418.3 4354.77,-418.3 4468.88,-456.65"/>
<text text-anchor="middle" x="4275.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4275.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:3,1</text>
<text text-anchor="middle" x="4275.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4275.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="4275.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1806" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.88C7108.28,-620.33 7105.52,-619.82 7102.79,-619.38 7062.38,-612.82 4183.66,-630.42 4154.79,-601.38 4138.2,-584.68 4144.38,-567.03 4160.54,-550.72"/>
<polygon fill="black" stroke="black" points="4163.05,-553.16 4168.03,-543.81 4158.31,-548.01 4163.05,-553.16"/>
<text text-anchor="middle" x="4204.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4204.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→13</text>
</g>
<!-- layer4_expert_agg_3_2 -->
<g id="node699" class="node">
<title>layer4_expert_agg_3_2</title>
<polygon fill="darkseagreen" stroke="black" points="682.88,-459.53 682.88,-512.18 572.12,-549.4 415.47,-549.4 304.7,-512.18 304.7,-459.53 415.47,-422.3 572.12,-422.3 682.88,-459.53"/>
<polygon fill="none" stroke="black" points="686.88,-456.65 686.88,-515.05 572.77,-553.4 414.81,-553.4 300.7,-515.05 300.7,-456.65 414.81,-418.3 572.77,-418.3 686.88,-456.65"/>
<text text-anchor="middle" x="493.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="493.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:3,2</text>
<text text-anchor="middle" x="493.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="493.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="493.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1807" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7111.05,-620.87C7108.28,-620.32 7105.52,-619.82 7102.79,-619.38 7079.72,-615.67 389.29,-617.92 372.79,-601.38 356.17,-584.71 362.34,-567.07 378.5,-550.76"/>
<polygon fill="black" stroke="black" points="381.01,-553.2 385.99,-543.85 376.27,-548.05 381.01,-553.2"/>
<text text-anchor="middle" x="422.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="422.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→14</text>
</g>
<!-- layer4_expert_agg_3_3 -->
<g id="node700" class="node">
<title>layer4_expert_agg_3_3</title>
<polygon fill="darkseagreen" stroke="black" points="14102.88,-459.53 14102.88,-512.18 13992.12,-549.4 13835.47,-549.4 13724.7,-512.18 13724.7,-459.53 13835.47,-422.3 13992.12,-422.3 14102.88,-459.53"/>
<polygon fill="none" stroke="black" points="14106.88,-456.65 14106.88,-515.05 13992.77,-553.4 13834.81,-553.4 13720.7,-515.05 13720.7,-456.65 13834.81,-418.3 13992.77,-418.3 14106.88,-456.65"/>
<text text-anchor="middle" x="13913.79" y="-512.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13913.79" y="-497.15" font-family="Times,serif" font-size="14.00">Partition:3,3</text>
<text text-anchor="middle" x="13913.79" y="-482.15" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="13913.79" y="-467.15" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13913.79" y="-452.15" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- layer4_expert2_0&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1808" class="edge">
<title>layer4_expert2_0&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7296.35,-647.37C7444.44,-639.63 7743.82,-625.04 7997.79,-619.38 8018.25,-618.92 13876.03,-614.44 13891.79,-601.38 13898.5,-595.82 13903.19,-581.04 13906.45,-563.88"/>
<polygon fill="black" stroke="black" points="13909.98,-564 13908.21,-553.55 13903.08,-562.82 13909.98,-564"/>
<text text-anchor="middle" x="13953.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13953.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 0→15</text>
</g>
<!-- layer4_expert_gelu_1 -->
<g id="node665" class="node">
<title>layer4_expert_gelu_1</title>
<ellipse fill="lightgray" stroke="black" cx="6526.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6526.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="6526.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6526.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer4_expert1_1&#45;&gt;layer4_expert_gelu_1 -->
<g id="edge1779" class="edge">
<title>layer4_expert1_1&#45;&gt;layer4_expert_gelu_1</title>
<path fill="none" stroke="black" d="M2991.4,-866.7C3477.93,-852.41 5801.98,-784.15 6390.91,-766.85"/>
<polygon fill="black" stroke="black" points="6391.25,-770.34 6401.14,-766.55 6391.04,-763.34 6391.25,-770.34"/>
</g>
<!-- layer4_expert2_1 -->
<g id="node666" class="node">
<title>layer4_expert2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="6890.29,-687.38 6705.29,-687.38 6705.29,-619.38 6890.29,-619.38 6890.29,-687.38"/>
<text text-anchor="middle" x="6797.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 1 Second Linear</text>
<text text-anchor="middle" x="6797.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6797.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6797.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_1&#45;&gt;layer4_expert2_1 -->
<g id="edge1780" class="edge">
<title>layer4_expert_gelu_1&#45;&gt;layer4_expert2_1</title>
<path fill="none" stroke="black" d="M6601.56,-731.48C6633.35,-718.99 6670.77,-704.29 6704.35,-691.09"/>
<polygon fill="black" stroke="black" points="6705.69,-694.33 6713.72,-687.41 6703.13,-687.81 6705.69,-694.33"/>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1809" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.88C6702.28,-620.32 6699.52,-619.82 6696.79,-619.38 6664.31,-614.14 1982.01,-624.69 1958.79,-601.38 1894.29,-536.63 2004.61,-508.4 2120.43,-496.14"/>
<polygon fill="black" stroke="black" points="2120.97,-499.6 2130.57,-495.1 2120.27,-492.63 2120.97,-499.6"/>
<text text-anchor="middle" x="2008.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2008.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→0</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1810" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6817.47,-619.19C6828.98,-602.5 6844.95,-583.33 6863.79,-571.38 6904.87,-545.31 6953.48,-527.29 7000.89,-514.82"/>
<polygon fill="black" stroke="black" points="7001.85,-518.18 7010.67,-512.32 7000.12,-511.4 7001.85,-518.18"/>
<text text-anchor="middle" x="6913.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6913.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→1</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1811" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.9C6702.28,-620.34 6699.52,-619.83 6696.79,-619.38 6671.98,-615.3 4904.48,-619.24 4886.79,-601.38 4822.49,-536.43 4932.79,-508.22 5048.56,-496.01"/>
<polygon fill="black" stroke="black" points="5049.1,-499.47 5058.69,-494.98 5048.39,-492.51 5049.1,-499.47"/>
<text text-anchor="middle" x="4936.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4936.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→2</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1812" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.11C6893.51,-620.46 6896.67,-619.88 6899.79,-619.38 6938.79,-613.1 9709.25,-620.53 9743.79,-601.38 9757.59,-593.73 9750.4,-581.15 9762.79,-571.38 9784.83,-553.99 9810.67,-540.07 9837.18,-528.95"/>
<polygon fill="black" stroke="black" points="9838.63,-532.14 9846.57,-525.13 9835.99,-525.65 9838.63,-532.14"/>
<text text-anchor="middle" x="9812.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9812.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1813" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.1C6893.51,-620.46 6896.67,-619.88 6899.79,-619.38 6965.57,-608.88 11637.49,-633.61 11695.79,-601.38 11709.6,-593.74 11702.4,-581.15 11714.79,-571.38 11736.83,-553.99 11762.67,-540.07 11789.18,-528.95"/>
<polygon fill="black" stroke="black" points="11790.63,-532.14 11798.57,-525.13 11787.99,-525.65 11790.63,-532.14"/>
<text text-anchor="middle" x="11764.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11764.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→4</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1814" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.34,-621.17C6893.52,-620.5 6896.67,-619.9 6899.79,-619.38 6948.67,-611.16 7748.61,-625.71 7791.79,-601.38 7805.54,-593.63 7798.4,-581.15 7810.79,-571.38 7832.83,-553.99 7858.67,-540.07 7885.18,-528.95"/>
<polygon fill="black" stroke="black" points="7886.63,-532.14 7894.57,-525.13 7883.99,-525.65 7886.63,-532.14"/>
<text text-anchor="middle" x="7860.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7860.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→5</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1815" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.88C6702.28,-620.32 6699.52,-619.82 6696.79,-619.38 6671,-615.21 2953.22,-619.9 2934.79,-601.38 2870.32,-536.6 2980.63,-508.37 3096.45,-496.12"/>
<polygon fill="black" stroke="black" points="3096.99,-499.58 3106.59,-495.08 3096.29,-492.61 3096.99,-499.58"/>
<text text-anchor="middle" x="2984.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2984.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→6</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1816" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.09C6893.51,-620.45 6896.67,-619.88 6899.79,-619.38 6952.77,-610.96 14576.83,-627.3 14623.79,-601.38 14637.61,-593.75 14630.4,-581.15 14642.79,-571.38 14664.83,-553.99 14690.67,-540.07 14717.18,-528.95"/>
<polygon fill="black" stroke="black" points="14718.63,-532.14 14726.57,-525.13 14715.99,-525.65 14718.63,-532.14"/>
<text text-anchor="middle" x="14692.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14692.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→7</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1817" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.1C6893.51,-620.45 6896.67,-619.88 6899.79,-619.38 6939.38,-613.07 12636.7,-620.76 12671.79,-601.38 12685.61,-593.75 12678.4,-581.15 12690.79,-571.38 12712.83,-553.99 12738.67,-540.07 12765.18,-528.95"/>
<polygon fill="black" stroke="black" points="12766.63,-532.14 12774.57,-525.13 12763.99,-525.65 12766.63,-532.14"/>
<text text-anchor="middle" x="12740.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12740.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→8</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1818" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.1C6893.51,-620.46 6896.67,-619.88 6899.79,-619.38 6952.18,-610.99 10673.37,-627.07 10719.79,-601.38 10733.6,-593.74 10726.4,-581.15 10738.79,-571.38 10760.83,-553.99 10786.67,-540.07 10813.18,-528.95"/>
<polygon fill="black" stroke="black" points="10814.63,-532.14 10822.57,-525.13 10811.99,-525.65 10814.63,-532.14"/>
<text text-anchor="middle" x="10788.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10788.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→9</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1819" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.04,-620.94C6702.27,-620.37 6699.52,-619.84 6696.79,-619.38 6673.95,-615.49 5879,-617.94 5862.79,-601.38 5798.92,-536.12 5908.95,-507.92 6024.5,-495.8"/>
<polygon fill="black" stroke="black" points="6025.01,-499.27 6034.61,-494.78 6024.31,-492.3 6025.01,-499.27"/>
<text text-anchor="middle" x="5912.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5912.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→10</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1820" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.34,-621.12C6893.51,-620.47 6896.67,-619.89 6899.79,-619.38 6951.01,-611.05 8722.45,-626.62 8767.79,-601.38 8781.58,-593.7 8774.4,-581.15 8786.79,-571.38 8808.83,-553.99 8834.67,-540.07 8861.18,-528.95"/>
<polygon fill="black" stroke="black" points="8862.63,-532.14 8870.57,-525.13 8859.99,-525.65 8862.63,-532.14"/>
<text text-anchor="middle" x="8836.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8836.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→11</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1821" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.87C6702.28,-620.32 6699.52,-619.82 6696.79,-619.38 6657.61,-613.08 1010.81,-629.48 982.79,-601.38 918.27,-536.65 1028.59,-508.42 1144.42,-496.15"/>
<polygon fill="black" stroke="black" points="1144.96,-499.61 1154.56,-495.12 1144.25,-492.65 1144.96,-499.61"/>
<text text-anchor="middle" x="1032.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1032.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→12</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1822" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.89C6702.28,-620.33 6699.52,-619.82 6696.79,-619.38 6658.6,-613.17 3938.06,-628.83 3910.79,-601.38 3846.37,-536.54 3956.69,-508.32 4072.49,-496.08"/>
<polygon fill="black" stroke="black" points="4073.03,-499.54 4082.62,-495.05 4072.32,-492.58 4073.03,-499.54"/>
<text text-anchor="middle" x="3960.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3960.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→13</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1823" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6705.05,-620.87C6702.28,-620.32 6699.52,-619.82 6696.79,-619.38 6674.27,-615.76 144.9,-617.53 128.79,-601.38 64.25,-536.66 174.57,-508.43 290.41,-496.16"/>
<polygon fill="black" stroke="black" points="290.95,-499.62 300.55,-495.13 290.24,-492.66 290.95,-499.62"/>
<text text-anchor="middle" x="178.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="178.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→14</text>
</g>
<!-- layer4_expert2_1&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1824" class="edge">
<title>layer4_expert2_1&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6890.33,-621.1C6893.51,-620.45 6896.67,-619.88 6899.79,-619.38 6946.07,-612.02 13606.77,-624.03 13647.79,-601.38 13661.61,-593.75 13654.4,-581.15 13666.79,-571.38 13688.83,-553.99 13714.67,-540.07 13741.18,-528.95"/>
<polygon fill="black" stroke="black" points="13742.63,-532.14 13750.57,-525.13 13739.99,-525.65 13742.63,-532.14"/>
<text text-anchor="middle" x="13716.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13716.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 2→15</text>
</g>
<!-- layer4_expert_gelu_2 -->
<g id="node668" class="node">
<title>layer4_expert_gelu_2</title>
<ellipse fill="lightgray" stroke="black" cx="8158.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="8158.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="8158.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8158.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_expert1_2&#45;&gt;layer4_expert_gelu_2 -->
<g id="edge1781" class="edge">
<title>layer4_expert1_2&#45;&gt;layer4_expert_gelu_2</title>
<path fill="none" stroke="black" d="M8228.39,-836.23C8219.16,-826.5 8208.94,-815.72 8199.23,-805.49"/>
<polygon fill="black" stroke="black" points="8201.7,-803 8192.28,-798.16 8196.62,-807.82 8201.7,-803"/>
</g>
<!-- layer4_expert2_2 -->
<g id="node669" class="node">
<title>layer4_expert2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="8191.29,-687.38 8006.29,-687.38 8006.29,-619.38 8191.29,-619.38 8191.29,-687.38"/>
<text text-anchor="middle" x="8098.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 2 Second Linear</text>
<text text-anchor="middle" x="8098.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8098.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8098.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_2&#45;&gt;layer4_expert2_2 -->
<g id="edge1782" class="edge">
<title>layer4_expert_gelu_2&#45;&gt;layer4_expert2_2</title>
<path fill="none" stroke="black" d="M8138.48,-724.81C8133.33,-715.66 8127.75,-705.76 8122.44,-696.35"/>
<polygon fill="black" stroke="black" points="8125.43,-694.52 8117.47,-687.52 8119.33,-697.95 8125.43,-694.52"/>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1825" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.38C7858.04,-639.65 7559.27,-625.11 7305.79,-619.38 7288.5,-618.99 2337.05,-613.58 2324.79,-601.38 2314.7,-591.34 2310.17,-577.95 2308.89,-563.87"/>
<polygon fill="black" stroke="black" points="2312.37,-563.4 2308.5,-553.54 2305.38,-563.67 2312.37,-563.4"/>
<text text-anchor="middle" x="2374.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2374.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→0</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1826" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.06,-648.75C7780.1,-639.68 7218.49,-615.76 7204.79,-601.38 7195.02,-591.13 7190.61,-577.72 7189.33,-563.7"/>
<polygon fill="black" stroke="black" points="7192.82,-563.27 7188.92,-553.42 7185.83,-563.55 7192.82,-563.27"/>
<text text-anchor="middle" x="7254.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7254.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→1</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1827" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.53C7858.03,-640.02 7559.25,-625.76 7305.79,-619.38 7277.29,-618.66 5272.95,-621.54 5252.79,-601.38 5242.72,-591.31 5238.21,-577.91 5236.93,-563.83"/>
<polygon fill="black" stroke="black" points="5240.41,-563.36 5236.54,-553.5 5233.42,-563.63 5240.41,-563.36"/>
<text text-anchor="middle" x="5302.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5302.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→2</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1828" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.34,-621.12C8194.51,-620.47 8197.67,-619.89 8200.79,-619.38 8226.96,-615.12 10091.13,-620.22 10109.79,-601.38 10123.71,-587.33 10120.91,-571.69 10109.99,-556.59"/>
<polygon fill="black" stroke="black" points="10112.63,-554.29 10103.59,-548.76 10107.21,-558.72 10112.63,-554.29"/>
<text text-anchor="middle" x="10168.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10168.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→3</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1829" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.33,-621.1C8194.51,-620.46 8197.67,-619.88 8200.79,-619.38 8227.27,-615.14 12042.88,-620.38 12061.79,-601.38 12075.82,-587.28 12072.93,-571.56 12061.86,-556.39"/>
<polygon fill="black" stroke="black" points="12064.43,-554.01 12055.37,-548.52 12059.03,-558.46 12064.43,-554.01"/>
<text text-anchor="middle" x="12120.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12120.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→4</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1830" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8145.62,-619.34C8150.53,-613.91 8154.81,-607.9 8157.79,-601.38 8163.34,-589.25 8163.4,-583.47 8157.79,-571.38 8155.83,-567.15 8153.54,-563.05 8150.98,-559.09"/>
<polygon fill="black" stroke="black" points="8153.64,-556.79 8144.99,-550.66 8147.93,-560.84 8153.64,-556.79"/>
<text text-anchor="middle" x="8211.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8211.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→5</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1831" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.4C7858.03,-639.71 7559.26,-625.22 7305.79,-619.38 7277.99,-618.74 3320.5,-621 3300.79,-601.38 3290.7,-591.33 3286.18,-577.94 3284.9,-563.87"/>
<polygon fill="black" stroke="black" points="3288.38,-563.4 3284.5,-553.54 3281.39,-563.66 3288.38,-563.4"/>
<text text-anchor="middle" x="3350.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3350.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→6</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1832" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.33,-621.1C8194.51,-620.45 8197.67,-619.88 8200.79,-619.38 8224.07,-615.68 14973.14,-618.07 14989.79,-601.38 15003.84,-587.29 15000.95,-571.58 14989.88,-556.41"/>
<polygon fill="black" stroke="black" points="14992.45,-554.03 14983.39,-548.54 14987.05,-558.48 14992.45,-554.03"/>
<text text-anchor="middle" x="15048.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15048.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→7</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1833" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.33,-621.1C8194.51,-620.46 8197.67,-619.88 8200.79,-619.38 8233.96,-614.08 13014.08,-625.18 13037.79,-601.38 13051.83,-587.29 13048.94,-571.57 13037.87,-556.4"/>
<polygon fill="black" stroke="black" points="13040.44,-554.02 13031.38,-548.53 13035.04,-558.47 13040.44,-554.02"/>
<text text-anchor="middle" x="13096.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13096.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→8</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1834" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.33,-621.11C8194.51,-620.46 8197.67,-619.88 8200.79,-619.38 8240.35,-613.01 11057.55,-629.8 11085.79,-601.38 11099.73,-587.35 11096.95,-571.72 11086.03,-556.63"/>
<polygon fill="black" stroke="black" points="11088.66,-554.32 11079.62,-548.8 11083.24,-558.75 11088.66,-554.32"/>
<text text-anchor="middle" x="11144.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11144.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→9</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1835" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.03,-647.77C7858.01,-640.58 7559.22,-626.77 7305.79,-619.38 7275.88,-618.51 6249.86,-622.62 6228.79,-601.38 6218.76,-591.27 6214.27,-577.85 6212.99,-563.77"/>
<polygon fill="black" stroke="black" points="6216.48,-563.3 6212.6,-553.44 6209.48,-563.56 6216.48,-563.3"/>
<text text-anchor="middle" x="6278.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6278.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→10</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1836" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.34,-621.16C8194.51,-620.5 8197.67,-619.9 8200.79,-619.38 8226.36,-615.09 9115.64,-619.88 9133.79,-601.38 9147.64,-587.26 9144.82,-571.59 9133.89,-556.49"/>
<polygon fill="black" stroke="black" points="9136.52,-554.18 9127.48,-548.66 9131.1,-558.62 9136.52,-554.18"/>
<text text-anchor="middle" x="9192.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9192.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→11</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1837" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.36C7858.04,-639.61 7559.27,-625.03 7305.79,-619.38 7285.11,-618.92 1363.46,-615.96 1348.79,-601.38 1338.69,-591.34 1334.17,-577.95 1332.89,-563.88"/>
<polygon fill="black" stroke="black" points="1336.37,-563.41 1332.49,-553.55 1329.38,-563.67 1336.37,-563.41"/>
<text text-anchor="middle" x="1398.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1398.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→12</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1838" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.45C7858.03,-639.82 7559.26,-625.4 7305.79,-619.38 7284.76,-618.88 4291.69,-616.23 4276.79,-601.38 4266.71,-591.32 4262.19,-577.93 4260.91,-563.86"/>
<polygon fill="black" stroke="black" points="4264.39,-563.38 4260.52,-553.52 4257.4,-563.65 4264.39,-563.38"/>
<text text-anchor="middle" x="4326.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4326.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→13</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1839" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8006.04,-647.35C7858.04,-639.58 7559.27,-624.99 7305.79,-619.38 7282.15,-618.86 511.56,-618.05 494.79,-601.38 484.69,-591.34 480.16,-577.96 478.88,-563.88"/>
<polygon fill="black" stroke="black" points="482.37,-563.41 478.49,-553.55 475.37,-563.68 482.37,-563.41"/>
<text text-anchor="middle" x="544.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="544.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→14</text>
</g>
<!-- layer4_expert2_2&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1840" class="edge">
<title>layer4_expert2_2&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8191.33,-621.1C8194.51,-620.45 8197.67,-619.88 8200.79,-619.38 8240.66,-613.03 13985.29,-629.97 14013.79,-601.38 14027.84,-587.29 14024.94,-571.57 14013.87,-556.4"/>
<polygon fill="black" stroke="black" points="14016.45,-554.02 14007.38,-548.53 14011.04,-558.48 14016.45,-554.02"/>
<text text-anchor="middle" x="14072.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14072.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 4→15</text>
</g>
<!-- layer4_expert_gelu_3 -->
<g id="node671" class="node">
<title>layer4_expert_gelu_3</title>
<ellipse fill="lightgray" stroke="black" cx="6869.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="6869.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6869.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6869.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer4_expert1_3&#45;&gt;layer4_expert_gelu_3 -->
<g id="edge1783" class="edge">
<title>layer4_expert1_3&#45;&gt;layer4_expert_gelu_3</title>
<path fill="none" stroke="black" d="M4815.34,-867.74C5145.92,-861.62 6297.4,-837.94 6662.79,-799.33 6693.44,-796.09 6726.39,-791.02 6756.8,-785.68"/>
<polygon fill="black" stroke="black" points="6757.77,-789.06 6767,-783.86 6756.54,-782.17 6757.77,-789.06"/>
</g>
<!-- layer4_expert2_3 -->
<g id="node672" class="node">
<title>layer4_expert2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="7093.29,-687.38 6908.29,-687.38 6908.29,-619.38 7093.29,-619.38 7093.29,-687.38"/>
<text text-anchor="middle" x="7000.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 3 Second Linear</text>
<text text-anchor="middle" x="7000.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7000.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="7000.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_3&#45;&gt;layer4_expert2_3 -->
<g id="edge1784" class="edge">
<title>layer4_expert_gelu_3&#45;&gt;layer4_expert2_3</title>
<path fill="none" stroke="black" d="M6912.32,-726.29C6924.94,-716.03 6938.87,-704.71 6951.86,-694.15"/>
<polygon fill="black" stroke="black" points="6954.26,-696.71 6959.81,-687.69 6949.84,-691.28 6954.26,-696.71"/>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1841" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.88C6905.28,-620.32 6902.52,-619.82 6899.79,-619.38 6866.75,-614.05 2104.41,-625.09 2080.79,-601.38 2046.09,-566.55 2081.18,-540.98 2134.46,-522.96"/>
<polygon fill="black" stroke="black" points="2135.8,-526.2 2144.24,-519.79 2133.65,-519.54 2135.8,-526.2"/>
<text text-anchor="middle" x="2130.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2130.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→0</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1842" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6976.17,-619.29C6967.81,-603.79 6962.82,-585.65 6972.79,-571.38 6985.74,-552.86 7003.2,-538.38 7022.76,-527.07"/>
<polygon fill="black" stroke="black" points="7024.48,-530.12 7031.58,-522.25 7021.13,-523.97 7024.48,-530.12"/>
<text text-anchor="middle" x="7022.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7022.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→1</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1843" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.9C6905.28,-620.34 6902.52,-619.83 6899.79,-619.38 6873.87,-615.13 5027.27,-620.04 5008.79,-601.38 4974.19,-566.45 5009.3,-540.87 5062.56,-522.85"/>
<polygon fill="black" stroke="black" points="5063.9,-526.1 5072.34,-519.69 5061.75,-519.44 5063.9,-526.1"/>
<text text-anchor="middle" x="5058.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5058.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→2</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1844" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.11C7096.51,-620.46 7099.67,-619.88 7102.79,-619.38 7140.68,-613.28 9832.23,-619.99 9865.79,-601.38 9879.59,-593.72 9873.8,-582.7 9884.79,-571.38 9890.69,-565.3 9897.1,-559.4 9903.79,-553.75"/>
<polygon fill="black" stroke="black" points="9906.24,-556.27 9911.75,-547.22 9901.8,-550.85 9906.24,-556.27"/>
<text text-anchor="middle" x="9934.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9934.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→3</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1845" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.1C7096.51,-620.46 7099.67,-619.88 7102.79,-619.38 7167.46,-609.05 11760.48,-633.06 11817.79,-601.38 11831.6,-593.74 11825.8,-582.7 11836.79,-571.38 11842.69,-565.3 11849.1,-559.4 11855.79,-553.75"/>
<polygon fill="black" stroke="black" points="11858.24,-556.27 11863.75,-547.22 11853.8,-550.85 11858.24,-556.27"/>
<text text-anchor="middle" x="11886.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11886.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→4</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1846" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.34,-621.18C7096.52,-620.51 7099.67,-619.91 7102.79,-619.38 7147.23,-611.86 7874.55,-623.54 7913.79,-601.38 7927.53,-593.62 7921.8,-582.7 7932.79,-571.38 7938.69,-565.3 7945.1,-559.4 7951.79,-553.75"/>
<polygon fill="black" stroke="black" points="7954.24,-556.27 7959.75,-547.22 7949.8,-550.85 7954.24,-556.27"/>
<text text-anchor="middle" x="7982.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7982.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→5</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1847" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.88C6905.28,-620.32 6902.52,-619.82 6899.79,-619.38 6873.45,-615.12 3075.62,-620.29 3056.79,-601.38 3022.11,-566.53 3057.2,-540.96 3110.48,-522.94"/>
<polygon fill="black" stroke="black" points="3111.82,-526.19 3120.26,-519.78 3109.67,-519.53 3111.82,-526.19"/>
<text text-anchor="middle" x="3106.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3106.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→6</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1848" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.09C7096.51,-620.45 7099.67,-619.88 7102.79,-619.38 7155.21,-611.05 14699.32,-627.02 14745.79,-601.38 14759.61,-593.75 14753.8,-582.7 14764.79,-571.38 14770.69,-565.3 14777.1,-559.4 14783.79,-553.75"/>
<polygon fill="black" stroke="black" points="14786.24,-556.27 14791.75,-547.22 14781.8,-550.85 14786.24,-556.27"/>
<text text-anchor="middle" x="14814.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14814.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→7</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1849" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.1C7096.51,-620.45 7099.67,-619.88 7102.79,-619.38 7141.82,-613.16 12759.2,-620.49 12793.79,-601.38 12807.61,-593.75 12801.8,-582.7 12812.79,-571.38 12818.69,-565.3 12825.1,-559.4 12831.79,-553.75"/>
<polygon fill="black" stroke="black" points="12834.24,-556.27 12839.75,-547.22 12829.8,-550.85 12834.24,-556.27"/>
<text text-anchor="middle" x="12862.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12862.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→8</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1850" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.1C7096.51,-620.46 7099.67,-619.88 7102.79,-619.38 7154.07,-611.16 10796.36,-626.53 10841.79,-601.38 10855.6,-593.74 10849.8,-582.7 10860.79,-571.38 10866.69,-565.3 10873.1,-559.4 10879.79,-553.75"/>
<polygon fill="black" stroke="black" points="10882.24,-556.27 10887.75,-547.22 10877.8,-550.85 10882.24,-556.27"/>
<text text-anchor="middle" x="10910.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10910.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→9</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1851" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.04,-620.93C6905.27,-620.36 6902.52,-619.84 6899.79,-619.38 6874.73,-615.13 6002.59,-619.53 5984.79,-601.38 5950.45,-566.35 5985.35,-540.77 6038.39,-522.79"/>
<polygon fill="black" stroke="black" points="6039.7,-526.05 6048.13,-519.64 6037.54,-519.39 6039.7,-526.05"/>
<text text-anchor="middle" x="6034.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6034.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→10</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1852" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.34,-621.13C7096.51,-620.47 7099.67,-619.89 7102.79,-619.38 7151.79,-611.4 8846.42,-625.53 8889.79,-601.38 8903.58,-593.7 8897.8,-582.7 8908.79,-571.38 8914.69,-565.3 8921.1,-559.4 8927.79,-553.75"/>
<polygon fill="black" stroke="black" points="8930.24,-556.27 8935.75,-547.22 8925.8,-550.85 8930.24,-556.27"/>
<text text-anchor="middle" x="8958.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8958.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→11</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1853" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.87C6905.28,-620.32 6902.52,-619.82 6899.79,-619.38 6860.06,-612.99 1133.2,-629.88 1104.79,-601.38 1070.08,-566.56 1105.16,-541 1158.45,-522.97"/>
<polygon fill="black" stroke="black" points="1159.79,-526.21 1168.23,-519.8 1157.64,-519.55 1159.79,-526.21"/>
<text text-anchor="middle" x="1154.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1154.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→12</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1854" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.89C6905.28,-620.33 6902.52,-619.82 6899.79,-619.38 6860.49,-612.99 4060.86,-629.62 4032.79,-601.38 3998.13,-566.5 4033.23,-540.93 4086.5,-522.91"/>
<polygon fill="black" stroke="black" points="4087.85,-526.16 4096.29,-519.75 4085.69,-519.5 4087.85,-526.16"/>
<text text-anchor="middle" x="4082.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4082.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→13</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1855" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6908.05,-620.87C6905.28,-620.32 6902.52,-619.82 6899.79,-619.38 6877,-615.72 267.09,-617.73 250.79,-601.38 216.07,-566.57 251.16,-541 304.44,-522.98"/>
<polygon fill="black" stroke="black" points="305.79,-526.22 314.22,-519.81 303.63,-519.56 305.79,-526.22"/>
<text text-anchor="middle" x="300.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="300.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→14</text>
</g>
<!-- layer4_expert2_3&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1856" class="edge">
<title>layer4_expert2_3&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7093.33,-621.1C7096.51,-620.45 7099.67,-619.88 7102.79,-619.38 7148.51,-612.1 13729.26,-623.76 13769.79,-601.38 13783.61,-593.75 13777.8,-582.7 13788.79,-571.38 13794.69,-565.3 13801.1,-559.4 13807.79,-553.75"/>
<polygon fill="black" stroke="black" points="13810.24,-556.27 13815.75,-547.22 13805.8,-550.85 13810.24,-556.27"/>
<text text-anchor="middle" x="13838.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13838.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 6→15</text>
</g>
<!-- layer4_expert_gelu_4 -->
<g id="node674" class="node">
<title>layer4_expert_gelu_4</title>
<ellipse fill="lightgray" stroke="black" cx="11435.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="11435.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="11435.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="11435.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer4_expert1_4&#45;&gt;layer4_expert_gelu_4 -->
<g id="edge1785" class="edge">
<title>layer4_expert1_4&#45;&gt;layer4_expert_gelu_4</title>
<path fill="none" stroke="black" d="M13642.14,-865.17C13289.13,-848.8 11993.76,-788.73 11570.55,-769.1"/>
<polygon fill="black" stroke="black" points="11570.56,-765.6 11560.41,-768.63 11570.24,-772.59 11570.56,-765.6"/>
</g>
<!-- layer4_expert2_4 -->
<g id="node675" class="node">
<title>layer4_expert2_4</title>
<polygon fill="lightsteelblue" stroke="black" points="9614.29,-687.38 9429.29,-687.38 9429.29,-619.38 9614.29,-619.38 9614.29,-687.38"/>
<text text-anchor="middle" x="9521.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 4 Second Linear</text>
<text text-anchor="middle" x="9521.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9521.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="9521.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_4&#45;&gt;layer4_expert2_4 -->
<g id="edge1786" class="edge">
<title>layer4_expert_gelu_4&#45;&gt;layer4_expert2_4</title>
<path fill="none" stroke="black" d="M11312.05,-753.97C10958.9,-734.33 9950.77,-678.24 9624.81,-660.11"/>
<polygon fill="black" stroke="black" points="9624.61,-656.59 9614.43,-659.53 9624.22,-663.58 9624.61,-656.59"/>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1857" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.05C9264.16,-640.55 8907.76,-625.35 8606.79,-619.38 8538.37,-618.02 3744.09,-624.79 3679.79,-601.38 3660.22,-594.25 3663.26,-578.79 3643.79,-571.38 3587.07,-549.78 3158.38,-556.98 3097.79,-553.38 2903.97,-541.86 2683.37,-522.26 2527.4,-507.31"/>
<polygon fill="black" stroke="black" points="2527.51,-503.8 2517.22,-506.33 2526.84,-510.77 2527.51,-503.8"/>
<text text-anchor="middle" x="3729.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3729.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→0</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1858" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.02,-651.92C9200.52,-650.17 8623.52,-641.76 8546.79,-601.38 8531.92,-593.55 8538.76,-579.02 8523.79,-571.38 8490.72,-554.51 7892.84,-555.76 7855.79,-553.38 7705.15,-543.68 7535.54,-526.16 7407.07,-511.54"/>
<polygon fill="black" stroke="black" points="7407.45,-508.06 7397.12,-510.41 7406.66,-515.02 7407.45,-508.06"/>
<text text-anchor="middle" x="8596.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8596.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→1</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1859" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.21C9264.15,-640.96 8907.74,-626.15 8606.79,-619.38 8578.8,-618.75 6615.26,-614.99 6590.79,-601.38 6577,-593.71 6585.49,-579.22 6571.79,-571.38 6545.45,-556.31 6056.09,-555.18 6025.79,-553.38 5831.97,-541.86 5611.37,-522.26 5455.4,-507.31"/>
<polygon fill="black" stroke="black" points="5455.51,-503.8 5445.22,-506.33 5454.84,-510.77 5455.51,-503.8"/>
<text text-anchor="middle" x="6640.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6640.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→2</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1860" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.45,-651.67C9995,-648.55 11419.38,-634.66 11451.79,-601.38 11461.09,-591.83 11461.09,-580.93 11451.79,-571.38 11438.84,-558.08 10802.32,-554.42 10783.79,-553.38 10589.93,-542.45 10369.34,-522.77 10213.38,-507.64"/>
<polygon fill="black" stroke="black" points="10213.49,-504.14 10203.2,-506.65 10212.82,-511.11 10213.49,-504.14"/>
<text text-anchor="middle" x="11507.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11507.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→3</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1861" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.47,-652.04C10200.59,-649.82 13369.42,-636.21 13403.79,-601.38 13413.16,-591.89 13413.09,-580.93 13403.79,-571.38 13390.84,-558.08 12754.32,-554.42 12735.79,-553.38 12541.93,-542.45 12321.34,-522.77 12165.38,-507.64"/>
<polygon fill="black" stroke="black" points="12165.49,-504.14 12155.2,-506.65 12164.82,-511.11 12165.49,-504.14"/>
<text text-anchor="middle" x="13459.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13459.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→4</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1862" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9520.36,-619.19C9517.75,-602.07 9511.44,-582.5 9496.79,-571.38 9467.35,-549.03 8868.69,-555.46 8831.79,-553.38 8637.94,-542.43 8417.34,-522.76 8261.38,-507.64"/>
<polygon fill="black" stroke="black" points="8261.49,-504.13 8251.2,-506.65 8260.82,-511.1 8261.49,-504.13"/>
<text text-anchor="middle" x="9565.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9565.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→5</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1863" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.08C9264.16,-640.62 8907.75,-625.49 8606.79,-619.38 8551.93,-618.26 4707.35,-620.18 4655.79,-601.38 4636.22,-594.24 4639.26,-578.79 4619.79,-571.38 4563.07,-549.78 4134.38,-556.98 4073.79,-553.38 3879.97,-541.86 3659.37,-522.26 3503.4,-507.31"/>
<polygon fill="black" stroke="black" points="3503.51,-503.8 3493.22,-506.33 3502.84,-510.77 3503.51,-503.8"/>
<text text-anchor="middle" x="4705.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4705.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→6</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1864" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.56,-652.48C10364.71,-653.15 15411.99,-655.65 15465.79,-601.38 15523.53,-543.14 15281.25,-512.87 15093.21,-498.42"/>
<polygon fill="black" stroke="black" points="15093.4,-494.92 15083.17,-497.66 15092.88,-501.9 15093.4,-494.92"/>
<text text-anchor="middle" x="15523.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15523.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→7</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1865" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.42,-652.29C10282.21,-651.57 14336.24,-645.39 14379.79,-601.38 14389.17,-591.9 14389.09,-580.93 14379.79,-571.38 14366.84,-558.08 13730.32,-554.42 13711.79,-553.38 13517.93,-542.45 13297.34,-522.77 13141.38,-507.64"/>
<polygon fill="black" stroke="black" points="13141.49,-504.14 13131.2,-506.65 13140.82,-511.11 13141.49,-504.14"/>
<text text-anchor="middle" x="14436.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14436.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→8</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1866" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.65,-652.52C10105.48,-653.05 12377.33,-652.74 12427.79,-601.38 12437.14,-591.87 12437.09,-580.93 12427.79,-571.38 12414.84,-558.08 11778.32,-554.42 11759.79,-553.38 11565.93,-542.45 11345.34,-522.77 11189.38,-507.64"/>
<polygon fill="black" stroke="black" points="11189.49,-504.14 11179.2,-506.65 11188.82,-511.11 11189.49,-504.14"/>
<text text-anchor="middle" x="12483.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12483.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→9</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1867" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.27,-648.47C9264.13,-641.62 8907.71,-627.41 8606.79,-619.38 8577.91,-618.61 7591.98,-615.53 7566.79,-601.38 7553.03,-593.65 7561.49,-579.22 7547.79,-571.38 7521.45,-556.31 7032.09,-555.18 7001.79,-553.38 6807.97,-541.86 6587.37,-522.26 6431.4,-507.31"/>
<polygon fill="black" stroke="black" points="6431.51,-503.8 6421.22,-506.33 6430.84,-510.77 6431.51,-503.8"/>
<text text-anchor="middle" x="7616.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7616.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→10</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1868" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.67,-650.83C9848.76,-646.46 10446.46,-632.32 10475.79,-601.38 10484.96,-591.7 10485.09,-580.93 10475.79,-571.38 10462.84,-558.08 9826.32,-554.42 9807.79,-553.38 9613.93,-542.45 9393.34,-522.77 9237.38,-507.64"/>
<polygon fill="black" stroke="black" points="9237.49,-504.14 9227.2,-506.65 9236.82,-511.11 9237.49,-504.14"/>
<text text-anchor="middle" x="10531.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10531.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→11</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1869" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.03C9264.16,-640.5 8907.76,-625.26 8606.79,-619.38 8565.81,-618.58 2742.31,-615.39 2703.79,-601.38 2684.22,-594.26 2687.26,-578.79 2667.79,-571.38 2611.07,-549.78 2182.38,-556.98 2121.79,-553.38 1927.97,-541.86 1707.37,-522.26 1551.4,-507.31"/>
<polygon fill="black" stroke="black" points="1551.51,-503.8 1541.22,-506.33 1550.84,-510.77 1551.51,-503.8"/>
<text text-anchor="middle" x="2753.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2753.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→12</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1870" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.12C9264.15,-640.74 8907.75,-625.72 8606.79,-619.38 8565.48,-618.51 5670.6,-615.56 5631.79,-601.38 5612.23,-594.23 5615.26,-578.79 5595.79,-571.38 5539.07,-549.78 5110.38,-556.98 5049.79,-553.38 4855.97,-541.86 4635.37,-522.26 4479.4,-507.31"/>
<polygon fill="black" stroke="black" points="4479.51,-503.8 4469.22,-506.33 4478.84,-510.77 4479.51,-503.8"/>
<text text-anchor="middle" x="5681.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5681.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→13</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1871" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9429.28,-648.02C9264.16,-640.47 8907.76,-625.2 8606.79,-619.38 8559.03,-618.46 1772.69,-617.7 1727.79,-601.38 1708.22,-594.26 1711.26,-578.79 1691.79,-571.38 1635.07,-549.78 1206.35,-557.46 1145.79,-553.38 995.18,-543.22 825.57,-525.73 697.09,-511.23"/>
<polygon fill="black" stroke="black" points="697.47,-507.75 687.14,-510.1 696.68,-514.7 697.47,-507.75"/>
<text text-anchor="middle" x="1777.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1777.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→14</text>
</g>
<!-- layer4_expert2_4&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1872" class="edge">
<title>layer4_expert2_4&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9614.31,-652.46C10355.64,-653 15303.02,-654.61 15355.79,-601.38 15365.18,-591.91 15365.09,-580.93 15355.79,-571.38 15342.84,-558.08 14706.32,-554.42 14687.79,-553.38 14493.93,-542.45 14273.34,-522.77 14117.38,-507.64"/>
<polygon fill="black" stroke="black" points="14117.49,-504.14 14107.2,-506.65 14116.82,-511.11 14117.49,-504.14"/>
<text text-anchor="middle" x="15412.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15412.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 8→15</text>
</g>
<!-- layer4_expert_gelu_5 -->
<g id="node677" class="node">
<title>layer4_expert_gelu_5</title>
<ellipse fill="lightgray" stroke="black" cx="9799.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="9799.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="9799.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="9799.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer4_expert1_5&#45;&gt;layer4_expert_gelu_5 -->
<g id="edge1787" class="edge">
<title>layer4_expert1_5&#45;&gt;layer4_expert_gelu_5</title>
<path fill="none" stroke="black" d="M11818.22,-864.81C11487.07,-848.08 10330.67,-789.67 9934.3,-769.65"/>
<polygon fill="black" stroke="black" points="9934.39,-766.15 9924.23,-769.14 9934.04,-773.14 9934.39,-766.15"/>
</g>
<!-- layer4_expert2_5 -->
<g id="node678" class="node">
<title>layer4_expert2_5</title>
<polygon fill="lightsteelblue" stroke="black" points="8597.29,-687.38 8412.29,-687.38 8412.29,-619.38 8597.29,-619.38 8597.29,-687.38"/>
<text text-anchor="middle" x="8504.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 5 Second Linear</text>
<text text-anchor="middle" x="8504.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8504.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8504.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_5&#45;&gt;layer4_expert2_5 -->
<g id="edge1788" class="edge">
<title>layer4_expert_gelu_5&#45;&gt;layer4_expert2_5</title>
<path fill="none" stroke="black" d="M9678.54,-750.89C9425.3,-730.06 8844.15,-682.28 8607.7,-662.84"/>
<polygon fill="black" stroke="black" points="8607.64,-659.32 8597.38,-661.99 8607.06,-666.3 8607.64,-659.32"/>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1873" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.87C8409.28,-620.32 8406.52,-619.82 8403.79,-619.38 8363.78,-612.95 2605.1,-619.36 2568.79,-601.38 2553.74,-593.92 2559.26,-581.42 2545.79,-571.38 2526.39,-556.92 2504.22,-544.66 2481.57,-534.33"/>
<polygon fill="black" stroke="black" points="2482.75,-531.03 2472.19,-530.17 2479.91,-537.42 2482.75,-531.03"/>
<text text-anchor="middle" x="2618.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2618.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→0</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1874" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.93C8409.28,-620.36 8406.52,-619.84 8403.79,-619.38 8351.47,-610.54 7496.16,-625.31 7448.79,-601.38 7433.8,-593.8 7439.26,-581.42 7425.79,-571.38 7406.39,-556.92 7384.22,-544.66 7361.57,-534.33"/>
<polygon fill="black" stroke="black" points="7362.75,-531.03 7352.19,-530.17 7359.91,-537.42 7362.75,-531.03"/>
<text text-anchor="middle" x="7498.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7498.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→1</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1875" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.88C8409.28,-620.33 8406.52,-619.82 8403.79,-619.38 8363.94,-612.91 5532.94,-619.36 5496.79,-601.38 5481.75,-593.9 5487.26,-581.42 5473.79,-571.38 5454.39,-556.92 5432.22,-544.66 5409.57,-534.33"/>
<polygon fill="black" stroke="black" points="5410.75,-531.03 5400.19,-530.17 5407.91,-537.42 5410.75,-531.03"/>
<text text-anchor="middle" x="5546.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5546.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→2</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1876" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.41,-648.53C8762.74,-641.77 9119.55,-627.71 9420.79,-619.38 9446.7,-618.66 10335.64,-619.88 10353.79,-601.38 10412.24,-541.79 10317.85,-513.21 10213.27,-499.5"/>
<polygon fill="black" stroke="black" points="10213.48,-496 10203.12,-498.22 10212.61,-502.94 10213.48,-496"/>
<text text-anchor="middle" x="10419.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10419.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→3</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1877" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.41,-648.13C8762.71,-640.75 9119.5,-625.74 9420.79,-619.38 9440.82,-618.96 12291.67,-615.59 12305.79,-601.38 12364.68,-542.12 12270.05,-513.53 12165.25,-499.73"/>
<polygon fill="black" stroke="black" points="12165.45,-496.22 12155.08,-498.44 12164.56,-503.17 12165.45,-496.22"/>
<text text-anchor="middle" x="12371.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12371.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→4</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1878" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8450.87,-619.19C8442.04,-613.42 8433.08,-607.35 8424.79,-601.38 8407.62,-589 8406.7,-580.89 8387.79,-571.38 8345.12,-549.92 8296.54,-533.59 8250.01,-521.28"/>
<polygon fill="black" stroke="black" points="8250.68,-517.84 8240.12,-518.72 8248.92,-524.62 8250.68,-517.84"/>
<text text-anchor="middle" x="8474.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8474.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→5</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1879" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.88C8409.28,-620.32 8406.52,-619.82 8403.79,-619.38 8337.16,-608.64 3605.26,-631.35 3544.79,-601.38 3529.74,-593.92 3535.26,-581.42 3521.79,-571.38 3502.39,-556.92 3480.22,-544.66 3457.57,-534.33"/>
<polygon fill="black" stroke="black" points="3458.75,-531.03 3448.19,-530.17 3455.91,-537.42 3458.75,-531.03"/>
<text text-anchor="middle" x="3594.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3594.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→6</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1880" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.4,-648.03C8762.71,-640.5 9119.49,-625.27 9420.79,-619.38 9440.97,-618.98 15219.54,-615.67 15233.79,-601.38 15292.83,-542.16 15197.97,-513.56 15093.03,-499.75"/>
<polygon fill="black" stroke="black" points="15093.21,-496.25 15082.85,-498.46 15092.33,-503.19 15093.21,-496.25"/>
<text text-anchor="middle" x="15299.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15299.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→7</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1881" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.4,-648.08C8762.71,-640.63 9119.5,-625.51 9420.79,-619.38 9447.6,-618.83 13262.88,-620.38 13281.79,-601.38 13340.73,-542.17 13246.09,-513.57 13141.29,-499.76"/>
<polygon fill="black" stroke="black" points="13141.48,-496.25 13131.12,-498.47 13140.6,-503.2 13141.48,-496.25"/>
<text text-anchor="middle" x="13347.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13347.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→8</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1882" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.41,-648.23C8762.72,-641 9119.51,-626.22 9420.79,-619.38 9447.3,-618.78 11311.13,-620.22 11329.79,-601.38 11388.58,-542.03 11293.96,-513.44 11189.19,-499.66"/>
<polygon fill="black" stroke="black" points="11189.38,-496.16 11179.02,-498.37 11188.5,-503.1 11189.38,-496.16"/>
<text text-anchor="middle" x="11395.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11395.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→9</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1883" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.9C8409.28,-620.34 8406.52,-619.83 8403.79,-619.38 8350.86,-610.7 6520.78,-625.34 6472.79,-601.38 6457.76,-593.87 6463.26,-581.42 6449.79,-571.38 6430.39,-556.92 6408.22,-544.66 6385.57,-534.33"/>
<polygon fill="black" stroke="black" points="6386.75,-531.03 6376.19,-530.17 6383.91,-537.42 6386.75,-531.03"/>
<text text-anchor="middle" x="6522.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6522.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→10</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1884" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.34,-650.35C8816.59,-645.09 9351.32,-629.44 9377.79,-601.38 9434.96,-540.78 9341.06,-512.22 9237.02,-498.78"/>
<polygon fill="black" stroke="black" points="9237.28,-495.29 9226.93,-497.53 9236.42,-502.23 9237.28,-495.29"/>
<text text-anchor="middle" x="9443.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9443.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→11</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1885" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.87C8409.28,-620.32 8406.52,-619.82 8403.79,-619.38 8357.09,-611.88 1635.18,-622.36 1592.79,-601.38 1577.73,-593.92 1583.26,-581.42 1569.79,-571.38 1550.39,-556.92 1528.22,-544.66 1505.57,-534.33"/>
<polygon fill="black" stroke="black" points="1506.75,-531.03 1496.19,-530.17 1503.91,-537.42 1506.75,-531.03"/>
<text text-anchor="middle" x="1642.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1642.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→12</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1886" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.88C8409.28,-620.32 8406.52,-619.82 8403.79,-619.38 8350.55,-610.78 4569.1,-625.35 4520.79,-601.38 4505.74,-593.91 4511.26,-581.42 4497.79,-571.38 4478.39,-556.92 4456.22,-544.66 4433.57,-534.33"/>
<polygon fill="black" stroke="black" points="4434.75,-531.03 4424.19,-530.17 4431.91,-537.42 4434.75,-531.03"/>
<text text-anchor="middle" x="4570.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4570.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→13</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1887" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8412.05,-620.87C8409.28,-620.32 8406.52,-619.82 8403.79,-619.38 8298.86,-602.54 851.68,-637.68 751.79,-601.38 732.22,-594.27 733.77,-581.89 715.79,-571.38 693.54,-558.36 668.91,-546.66 644.41,-536.41"/>
<polygon fill="black" stroke="black" points="645.6,-533.12 635.02,-532.55 642.94,-539.59 645.6,-533.12"/>
<text text-anchor="middle" x="801.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="801.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→14</text>
</g>
<!-- layer4_expert2_5&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1888" class="edge">
<title>layer4_expert2_5&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8597.4,-648.05C8762.71,-640.55 9119.5,-625.37 9420.79,-619.38 9437.58,-619.05 14245.94,-613.28 14257.79,-601.38 14316.81,-542.14 14221.95,-513.55 14117.02,-499.74"/>
<polygon fill="black" stroke="black" points="14117.2,-496.23 14106.84,-498.45 14116.32,-503.18 14117.2,-496.23"/>
<text text-anchor="middle" x="14323.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14323.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 10→15</text>
</g>
<!-- layer4_expert_gelu_6 -->
<g id="node680" class="node">
<title>layer4_expert_gelu_6</title>
<ellipse fill="lightgray" stroke="black" cx="4019.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="4019.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="4019.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="4019.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer4_expert1_6&#45;&gt;layer4_expert_gelu_6 -->
<g id="edge1789" class="edge">
<title>layer4_expert1_6&#45;&gt;layer4_expert_gelu_6</title>
<path fill="none" stroke="black" d="M1281.49,-865.95C1691.79,-850.51 3390.86,-786.54 3884.65,-767.94"/>
<polygon fill="black" stroke="black" points="3884.81,-771.44 3894.67,-767.57 3884.54,-764.45 3884.81,-771.44"/>
</g>
<!-- layer4_expert2_6 -->
<g id="node681" class="node">
<title>layer4_expert2_6</title>
<polygon fill="lightsteelblue" stroke="black" points="6687.29,-687.38 6502.29,-687.38 6502.29,-619.38 6687.29,-619.38 6687.29,-687.38"/>
<text text-anchor="middle" x="6594.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 6 Second Linear</text>
<text text-anchor="middle" x="6594.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="6594.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6594.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_6&#45;&gt;layer4_expert2_6 -->
<g id="edge1790" class="edge">
<title>layer4_expert_gelu_6&#45;&gt;layer4_expert2_6</title>
<path fill="none" stroke="black" d="M4144.86,-755.68C4588.97,-737.32 6085.27,-675.45 6492.01,-658.63"/>
<polygon fill="black" stroke="black" points="6492.43,-662.11 6502.28,-658.2 6492.14,-655.12 6492.43,-662.11"/>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1889" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502.24,-652.27C5842.64,-651.41 1879.4,-644.45 1836.79,-601.38 1827.41,-591.9 1828.21,-581.58 1836.79,-571.38 1873.56,-527.67 2003.78,-506.57 2120.31,-496.37"/>
<polygon fill="black" stroke="black" points="2120.8,-499.84 2130.46,-495.51 2120.2,-492.87 2120.8,-499.84"/>
<text text-anchor="middle" x="1886.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1886.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→0</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1890" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6664.15,-619.28C6674.32,-613.68 6684.49,-607.64 6693.79,-601.38 6710.79,-589.94 6710.28,-580.15 6728.79,-571.38 6812.98,-531.5 6913.66,-510.32 7000.63,-499.12"/>
<polygon fill="black" stroke="black" points="7001.13,-502.58 7010.62,-497.86 7000.26,-495.63 7001.13,-502.58"/>
<text text-anchor="middle" x="6778.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6778.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→1</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1891" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502,-651.53C6133.94,-647.96 4795.36,-632.82 4764.79,-601.38 4755.5,-591.82 4756.21,-581.58 4764.79,-571.38 4801.56,-527.67 4931.78,-506.57 5048.31,-496.37"/>
<polygon fill="black" stroke="black" points="5048.8,-499.84 5058.46,-495.51 5048.2,-492.87 5048.8,-499.84"/>
<text text-anchor="middle" x="4814.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4814.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→2</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1892" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.11C6690.51,-620.46 6693.67,-619.88 6696.79,-619.38 6736.86,-612.93 9582.65,-619.83 9618.79,-601.38 9633.52,-593.86 9626.98,-580.46 9640.79,-571.38 9689.85,-539.12 9749.6,-519.09 9806.61,-506.67"/>
<polygon fill="black" stroke="black" points="9807.41,-510.08 9816.47,-504.59 9805.97,-503.23 9807.41,-510.08"/>
<text text-anchor="middle" x="9690.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9690.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→3</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1893" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.1C6690.51,-620.46 6693.67,-619.88 6696.79,-619.38 6763.5,-608.73 11498.02,-626.34 11560.79,-601.38 11578.91,-594.18 11575.58,-580.54 11592.79,-571.38 11643.55,-544.36 11702.72,-525.93 11758.62,-513.39"/>
<polygon fill="black" stroke="black" points="11759.63,-516.75 11768.65,-511.19 11758.13,-509.91 11759.63,-516.75"/>
<text text-anchor="middle" x="11642.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11642.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→4</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1894" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.34,-621.16C6690.51,-620.5 6693.67,-619.9 6696.79,-619.38 6750.12,-610.46 7622.67,-627.88 7669.79,-601.38 7683.55,-593.64 7675.91,-580.49 7688.79,-571.38 7737.1,-537.2 7797.08,-516.61 7854.53,-504.28"/>
<polygon fill="black" stroke="black" points="7855.4,-507.67 7864.48,-502.22 7853.98,-500.82 7855.4,-507.67"/>
<text text-anchor="middle" x="7738.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7738.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→5</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1895" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502.18,-652.01C5925.18,-649.62 2846.23,-635.27 2812.79,-601.38 2803.43,-591.89 2804.21,-581.58 2812.79,-571.38 2849.56,-527.67 2979.78,-506.57 3096.31,-496.37"/>
<polygon fill="black" stroke="black" points="3096.8,-499.84 3106.46,-495.51 3096.2,-492.87 3096.8,-499.84"/>
<text text-anchor="middle" x="2862.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2862.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→6</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1896" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.09C6690.51,-620.45 6693.67,-619.88 6696.79,-619.38 6750.24,-610.88 14439.65,-621.74 14489.79,-601.38 14507.56,-594.17 14503.94,-580.52 14520.79,-571.38 14571.34,-543.96 14630.44,-525.41 14686.34,-512.86"/>
<polygon fill="black" stroke="black" points="14687.35,-516.23 14696.37,-510.67 14685.85,-509.39 14687.35,-516.23"/>
<text text-anchor="middle" x="14570.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14570.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→7</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1897" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.1C6690.51,-620.45 6693.67,-619.88 6696.79,-619.38 6776.89,-606.62 12461.41,-631.32 12536.79,-601.38 12554.91,-594.18 12551.58,-580.54 12568.79,-571.38 12619.55,-544.36 12678.72,-525.93 12734.62,-513.39"/>
<polygon fill="black" stroke="black" points="12735.63,-516.75 12744.65,-511.19 12734.13,-509.91 12735.63,-516.75"/>
<text text-anchor="middle" x="12618.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12618.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→8</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1898" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.1C6690.51,-620.46 6693.67,-619.88 6696.79,-619.38 6750.11,-610.84 10534.62,-621.35 10584.79,-601.38 10602.9,-594.17 10599.58,-580.54 10616.79,-571.38 10667.55,-544.36 10726.72,-525.93 10782.62,-513.39"/>
<polygon fill="black" stroke="black" points="10783.63,-516.75 10792.65,-511.19 10782.13,-509.91 10783.63,-516.75"/>
<text text-anchor="middle" x="10666.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10666.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→9</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1899" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502.26,-650.22C6286.56,-644.75 5766.59,-628.76 5740.79,-601.38 5731.65,-591.67 5732.21,-581.58 5740.79,-571.38 5777.56,-527.67 5907.78,-506.57 6024.31,-496.37"/>
<polygon fill="black" stroke="black" points="6024.8,-499.84 6034.46,-495.51 6024.2,-492.87 6024.8,-499.84"/>
<text text-anchor="middle" x="5790.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5790.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→10</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1900" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.34,-621.12C6690.51,-620.47 6693.67,-619.89 6696.79,-619.38 6750.23,-610.7 8598.48,-627.7 8645.79,-601.38 8659.58,-593.71 8651.91,-580.49 8664.79,-571.38 8713.1,-537.2 8773.08,-516.61 8830.53,-504.28"/>
<polygon fill="black" stroke="black" points="8831.4,-507.67 8840.48,-502.22 8829.98,-500.82 8831.4,-507.67"/>
<text text-anchor="middle" x="8714.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8714.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→11</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1901" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502.12,-652.45C5767.54,-652.87 912.61,-653.66 860.79,-601.38 851.41,-591.91 852.21,-581.58 860.79,-571.38 897.56,-527.67 1027.78,-506.57 1144.31,-496.37"/>
<polygon fill="black" stroke="black" points="1144.8,-499.84 1154.46,-495.51 1144.2,-492.87 1144.8,-499.84"/>
<text text-anchor="middle" x="910.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="910.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→12</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1902" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6501.99,-652.46C6021.59,-652.67 3837.4,-650.88 3788.79,-601.38 3779.45,-591.87 3780.21,-581.58 3788.79,-571.38 3825.56,-527.67 3955.78,-506.57 4072.31,-496.37"/>
<polygon fill="black" stroke="black" points="4072.8,-499.84 4082.46,-495.51 4072.2,-492.87 4072.8,-499.84"/>
<text text-anchor="middle" x="3838.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3838.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→13</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1903" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6502.11,-652.11C5705.14,-649.7 36.75,-631.57 6.79,-601.38 -2.6,-591.91 -1.79,-581.58 6.79,-571.38 43.56,-527.67 173.78,-506.57 290.31,-496.37"/>
<polygon fill="black" stroke="black" points="290.8,-499.84 300.46,-495.51 290.2,-492.87 290.8,-499.84"/>
<text text-anchor="middle" x="56.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="56.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→14</text>
</g>
<!-- layer4_expert2_6&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1904" class="edge">
<title>layer4_expert2_6&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6687.33,-621.1C6690.51,-620.45 6693.67,-619.88 6696.79,-619.38 6790.28,-604.51 13424.8,-636.31 13512.79,-601.38 13530.91,-594.19 13527.58,-580.54 13544.79,-571.38 13595.55,-544.36 13654.72,-525.93 13710.62,-513.39"/>
<polygon fill="black" stroke="black" points="13711.63,-516.75 13720.65,-511.19 13710.13,-509.91 13711.63,-516.75"/>
<text text-anchor="middle" x="13594.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13594.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 12→15</text>
</g>
<!-- layer4_expert_gelu_7 -->
<g id="node683" class="node">
<title>layer4_expert_gelu_7</title>
<ellipse fill="lightgray" stroke="black" cx="8484.79" cy="-761.86" rx="126.64" ry="37.45"/>
<text text-anchor="middle" x="8484.79" y="-773.16" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="8484.79" y="-758.16" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8484.79" y="-743.16" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer4_expert1_7&#45;&gt;layer4_expert_gelu_7 -->
<g id="edge1791" class="edge">
<title>layer4_expert1_7&#45;&gt;layer4_expert_gelu_7</title>
<path fill="none" stroke="black" d="M9994.11,-863.36C9726.8,-845.56 8934.49,-792.8 8617.79,-771.71"/>
<polygon fill="black" stroke="black" points="8617.85,-768.21 8607.64,-771.04 8617.38,-775.19 8617.85,-768.21"/>
</g>
<!-- layer4_expert2_7 -->
<g id="node684" class="node">
<title>layer4_expert2_7</title>
<polygon fill="lightsteelblue" stroke="black" points="8394.29,-687.38 8209.29,-687.38 8209.29,-619.38 8394.29,-619.38 8394.29,-687.38"/>
<text text-anchor="middle" x="8301.79" y="-672.18" font-family="Times,serif" font-size="14.00">Expert 7 Second Linear</text>
<text text-anchor="middle" x="8301.79" y="-657.18" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="8301.79" y="-642.18" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8301.79" y="-627.18" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- layer4_expert_gelu_7&#45;&gt;layer4_expert2_7 -->
<g id="edge1792" class="edge">
<title>layer4_expert_gelu_7&#45;&gt;layer4_expert2_7</title>
<path fill="none" stroke="black" d="M8428.39,-728.04C8409.09,-716.81 8387.33,-704.15 8367.37,-692.53"/>
<polygon fill="black" stroke="black" points="8369.04,-689.46 8358.63,-687.45 8365.52,-695.51 8369.04,-689.46"/>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_0_0 -->
<g id="edge1905" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.87C8206.28,-620.32 8203.52,-619.82 8200.79,-619.38 8161.34,-613.03 2482.6,-619.12 2446.79,-601.38 2431.74,-593.92 2435.39,-583.54 2423.79,-571.38 2420.07,-567.47 2416.17,-563.56 2412.17,-559.68"/>
<polygon fill="black" stroke="black" points="2414.53,-557.1 2404.87,-552.74 2409.71,-562.17 2414.53,-557.1"/>
<text text-anchor="middle" x="2496.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="2496.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→0</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_0_1 -->
<g id="edge1906" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.04,-620.94C8206.27,-620.36 8203.52,-619.84 8200.79,-619.38 8152.91,-611.25 7370.12,-623.32 7326.79,-601.38 7311.8,-593.79 7315.39,-583.54 7303.79,-571.38 7300.07,-567.47 7296.17,-563.56 7292.17,-559.68"/>
<polygon fill="black" stroke="black" points="7294.53,-557.1 7284.87,-552.74 7289.71,-562.17 7294.53,-557.1"/>
<text text-anchor="middle" x="7376.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="7376.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→1</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_0_2 -->
<g id="edge1907" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.89C8206.28,-620.33 8203.52,-619.82 8200.79,-619.38 8123.31,-606.79 5445.08,-636.34 5374.79,-601.38 5359.75,-593.9 5363.39,-583.54 5351.79,-571.38 5348.07,-567.47 5344.17,-563.56 5340.17,-559.68"/>
<polygon fill="black" stroke="black" points="5342.53,-557.1 5332.87,-552.74 5337.71,-562.17 5342.53,-557.1"/>
<text text-anchor="middle" x="5424.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="5424.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→2</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_0_3 -->
<g id="edge1908" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.34,-621.13C8397.51,-620.47 8400.67,-619.89 8403.79,-619.38 8428.85,-615.3 10213.93,-619.42 10231.79,-601.38 10262.97,-569.89 10233.89,-545.29 10187.68,-527.1"/>
<polygon fill="black" stroke="black" points="10188.82,-523.79 10178.23,-523.55 10186.36,-530.34 10188.82,-523.79"/>
<text text-anchor="middle" x="10293.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="10293.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→3</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_1_0 -->
<g id="edge1909" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.33,-621.1C8397.51,-620.46 8400.67,-619.88 8403.79,-619.38 8429.71,-615.23 12165.27,-619.98 12183.79,-601.38 12215.13,-569.9 12185.85,-545.27 12139.45,-527.06"/>
<polygon fill="black" stroke="black" points="12140.55,-523.73 12129.96,-523.5 12138.09,-530.29 12140.55,-523.73"/>
<text text-anchor="middle" x="12246.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="12246.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→4</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_1_1 -->
<g id="edge1910" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8293.03,-619.37C8287.29,-603.14 8278.29,-584.33 8264.79,-571.38 8250.05,-557.23 8232.62,-545.32 8214.23,-535.34"/>
<polygon fill="black" stroke="black" points="8215.62,-532.12 8205.13,-530.59 8212.38,-538.32 8215.62,-532.12"/>
<text text-anchor="middle" x="8334.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="8334.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→5</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_1_2 -->
<g id="edge1911" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.88C8206.28,-620.32 8203.52,-619.82 8200.79,-619.38 8135.28,-608.82 3482.25,-630.85 3422.79,-601.38 3407.74,-593.92 3411.39,-583.54 3399.79,-571.38 3396.07,-567.47 3392.17,-563.56 3388.17,-559.68"/>
<polygon fill="black" stroke="black" points="3390.53,-557.1 3380.87,-552.74 3385.71,-562.17 3390.53,-557.1"/>
<text text-anchor="middle" x="3472.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="3472.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→6</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_1_3 -->
<g id="edge1912" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.33,-621.1C8397.51,-620.45 8400.67,-619.88 8403.79,-619.38 8426.79,-615.72 15095.34,-617.87 15111.79,-601.38 15143.16,-569.93 15113.89,-545.31 15067.49,-527.09"/>
<polygon fill="black" stroke="black" points="15068.58,-523.77 15057.99,-523.54 15066.13,-530.32 15068.58,-523.77"/>
<text text-anchor="middle" x="15174.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="15174.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→7</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_2_0 -->
<g id="edge1913" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.33,-621.1C8397.51,-620.46 8400.67,-619.88 8403.79,-619.38 8436.41,-614.17 13136.48,-624.78 13159.79,-601.38 13191.14,-569.91 13161.87,-545.29 13115.47,-527.08"/>
<polygon fill="black" stroke="black" points="13116.56,-523.75 13105.97,-523.52 13114.11,-530.3 13116.56,-523.75"/>
<text text-anchor="middle" x="13222.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="13222.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→8</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_2_1 -->
<g id="edge1914" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.33,-621.11C8397.51,-620.46 8400.67,-619.88 8403.79,-619.38 8442.24,-613.19 11180.34,-629.01 11207.79,-601.38 11239.1,-569.87 11209.82,-545.24 11163.42,-527.03"/>
<polygon fill="black" stroke="black" points="11164.52,-523.71 11153.93,-523.48 11162.06,-530.26 11164.52,-523.71"/>
<text text-anchor="middle" x="11269.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="11269.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→9</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_2_2 -->
<g id="edge1915" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.9C8206.28,-620.34 8203.52,-619.83 8200.79,-619.38 8150.08,-611.05 6396.77,-624.34 6350.79,-601.38 6335.76,-593.87 6339.39,-583.54 6327.79,-571.38 6324.07,-567.47 6320.17,-563.56 6316.17,-559.68"/>
<polygon fill="black" stroke="black" points="6318.53,-557.1 6308.87,-552.74 6313.71,-562.17 6318.53,-557.1"/>
<text text-anchor="middle" x="6400.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="6400.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→10</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_2_3 -->
<g id="edge1916" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.34,-621.17C8397.52,-620.51 8400.67,-619.9 8403.79,-619.38 8427.13,-615.44 9239.23,-618.29 9255.79,-601.38 9286.72,-569.79 9257.81,-545.19 9211.81,-527.03"/>
<polygon fill="black" stroke="black" points="9212.98,-523.74 9202.39,-523.49 9210.52,-530.29 9212.98,-523.74"/>
<text text-anchor="middle" x="9317.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="9317.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→11</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_3_0 -->
<g id="edge1917" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.87C8206.28,-620.32 8203.52,-619.82 8200.79,-619.38 8154.65,-611.97 1512.68,-622.11 1470.79,-601.38 1455.73,-593.92 1459.39,-583.54 1447.79,-571.38 1444.07,-567.47 1440.17,-563.56 1436.17,-559.68"/>
<polygon fill="black" stroke="black" points="1438.53,-557.1 1428.87,-552.74 1433.71,-562.17 1438.53,-557.1"/>
<text text-anchor="middle" x="1520.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="1520.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→12</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_3_1 -->
<g id="edge1918" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.88C8206.28,-620.32 8203.52,-619.82 8200.79,-619.38 8148.66,-610.95 4446.09,-624.86 4398.79,-601.38 4383.74,-593.91 4387.39,-583.54 4375.79,-571.38 4372.07,-567.47 4368.17,-563.56 4364.17,-559.68"/>
<polygon fill="black" stroke="black" points="4366.53,-557.1 4356.87,-552.74 4361.71,-562.17 4366.53,-557.1"/>
<text text-anchor="middle" x="4448.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="4448.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→13</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_3_2 -->
<g id="edge1919" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8209.05,-620.87C8206.28,-620.32 8203.52,-619.82 8200.79,-619.38 8148.79,-611.04 663.99,-624.74 616.79,-601.38 601.73,-593.93 605.39,-583.54 593.79,-571.38 590.07,-567.47 586.17,-563.56 582.17,-559.68"/>
<polygon fill="black" stroke="black" points="584.53,-557.1 574.87,-552.74 579.71,-562.17 584.53,-557.1"/>
<text text-anchor="middle" x="666.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="666.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→14</text>
</g>
<!-- layer4_expert2_7&#45;&gt;layer4_expert_agg_3_3 -->
<g id="edge1920" class="edge">
<title>layer4_expert2_7&#45;&gt;layer4_expert_agg_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8394.33,-621.1C8397.51,-620.45 8400.67,-619.88 8403.79,-619.38 8443.1,-613.11 14107.69,-629.57 14135.79,-601.38 14167.15,-569.92 14137.88,-545.3 14091.48,-527.09"/>
<polygon fill="black" stroke="black" points="14092.57,-523.76 14081.98,-523.53 14090.12,-530.32 14092.57,-523.76"/>
<text text-anchor="middle" x="14198.29" y="-590.18" font-family="Times,serif" font-size="14.00">expert output</text>
<text text-anchor="middle" x="14198.29" y="-575.18" font-family="Times,serif" font-size="14.00">GPU 14→15</text>
</g>
<!-- layer4_res2 -->
<g id="node701" class="node">
<title>layer4_res2</title>
<ellipse fill="lightpink" stroke="black" cx="7422.79" cy="-235.66" rx="145.83" ry="145.83"/>
<text text-anchor="middle" x="7422.79" y="-246.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="7422.79" y="-231.96" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7422.79" y="-216.96" font-family="Times,serif" font-size="14.00">GPU: All GPUs (AllReduce)</text>
</g>
<!-- layer4_expert_agg_0_0&#45;&gt;layer4_res2 -->
<g id="edge1921" class="edge">
<title>layer4_expert_agg_0_0&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M2516.85,-465.9C2673.33,-451.11 2899.6,-431 3097.79,-418.33 4726.54,-314.18 6704.3,-256 7266.85,-240.75"/>
<polygon fill="black" stroke="black" points="7267.16,-244.24 7277.06,-240.47 7266.97,-237.24 7267.16,-244.24"/>
</g>
<!-- layer4_expert_agg_0_1&#45;&gt;layer4_res2 -->
<g id="edge1922" class="edge">
<title>layer4_expert_agg_0_1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M7262.77,-418.02C7280.41,-398.02 7300.29,-375.49 7319.89,-353.28"/>
<polygon fill="black" stroke="black" points="7322.53,-355.57 7326.53,-345.76 7317.29,-350.94 7322.53,-355.57"/>
</g>
<!-- layer4_expert_agg_0_2&#45;&gt;layer4_res2 -->
<g id="edge1923" class="edge">
<title>layer4_expert_agg_0_2&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M5444.93,-462.77C5870.19,-414.16 6880.39,-298.67 7267.84,-254.38"/>
<polygon fill="black" stroke="black" points="7268.46,-257.83 7278,-253.22 7267.66,-250.88 7268.46,-257.83"/>
</g>
<!-- layer4_expert_agg_0_3&#45;&gt;layer4_res2 -->
<g id="edge1924" class="edge">
<title>layer4_expert_agg_0_3&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M9816.67,-466.33C9323.72,-419.03 8026.24,-294.56 7577.85,-251.54"/>
<polygon fill="black" stroke="black" points="7578.03,-248.04 7567.74,-250.57 7577.36,-255.01 7578.03,-248.04"/>
</g>
<!-- layer4_expert_agg_1_0&#45;&gt;layer4_res2 -->
<g id="edge1925" class="edge">
<title>layer4_expert_agg_1_0&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M11768.71,-466.23C11612.22,-451.63 11385.94,-431.62 11187.79,-418.33 9788.77,-324.49 8094.15,-260.47 7578.81,-242.09"/>
<polygon fill="black" stroke="black" points="7578.82,-238.59 7568.71,-241.73 7578.57,-245.59 7578.82,-238.59"/>
</g>
<!-- layer4_expert_agg_1_1&#45;&gt;layer4_res2 -->
<g id="edge1926" class="edge">
<title>layer4_expert_agg_1_1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M7929.67,-434.78C7824.94,-393.85 7676.9,-335.98 7567.83,-293.35"/>
<polygon fill="black" stroke="black" points="7568.98,-290.04 7558.39,-289.66 7566.43,-296.56 7568.98,-290.04"/>
</g>
<!-- layer4_expert_agg_1_2&#45;&gt;layer4_res2 -->
<g id="edge1927" class="edge">
<title>layer4_expert_agg_1_2&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M3492.9,-466.55C3649.4,-452.13 3875.68,-432.21 4073.79,-418.33 5303.33,-332.16 6789.28,-264.29 7266.96,-243.37"/>
<polygon fill="black" stroke="black" points="7267.19,-246.86 7277.02,-242.93 7266.88,-239.87 7267.19,-246.86"/>
</g>
<!-- layer4_expert_agg_1_3&#45;&gt;layer4_res2 -->
<g id="edge1928" class="edge">
<title>layer4_expert_agg_1_3&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M14696.38,-465.06C14539.95,-449.82 14313.9,-429.52 14115.79,-418.33 11504.74,-270.81 8313.68,-242.27 7578.75,-237.52"/>
<polygon fill="black" stroke="black" points="7578.66,-234.02 7568.64,-237.46 7578.61,-241.02 7578.66,-234.02"/>
</g>
<!-- layer4_expert_agg_2_0&#45;&gt;layer4_res2 -->
<g id="edge1929" class="edge">
<title>layer4_expert_agg_2_0&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M12744.74,-465.7C12588.27,-450.8 12362.01,-430.64 12163.79,-418.33 10363.7,-306.54 8174.58,-253.08 7578.77,-239.95"/>
<polygon fill="black" stroke="black" points="7578.48,-236.45 7568.41,-239.72 7578.33,-243.44 7578.48,-236.45"/>
</g>
<!-- layer4_expert_agg_2_1&#45;&gt;layer4_res2 -->
<g id="edge1930" class="edge">
<title>layer4_expert_agg_2_1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M10792.65,-467.14C10636.12,-453.05 10409.82,-433.29 10211.79,-418.33 9208.99,-342.58 8001.9,-270.41 7578.57,-245.68"/>
<polygon fill="black" stroke="black" points="7578.6,-242.17 7568.41,-245.08 7578.19,-249.16 7578.6,-242.17"/>
</g>
<!-- layer4_expert_agg_2_2&#45;&gt;layer4_res2 -->
<g id="edge1931" class="edge">
<title>layer4_expert_agg_2_2&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M6399.01,-449.29C6632.39,-400.82 7046.82,-314.75 7270.12,-268.37"/>
<polygon fill="black" stroke="black" points="7270.87,-271.79 7279.95,-266.33 7269.45,-264.94 7270.87,-271.79"/>
</g>
<!-- layer4_expert_agg_2_3&#45;&gt;layer4_res2 -->
<g id="edge1932" class="edge">
<title>layer4_expert_agg_2_3&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M8843.85,-455.59C8521.3,-405.9 7872.72,-305.98 7576.58,-260.36"/>
<polygon fill="black" stroke="black" points="7577.04,-256.89 7566.63,-258.82 7575.98,-263.8 7577.04,-256.89"/>
</g>
<!-- layer4_expert_agg_3_0&#45;&gt;layer4_res2 -->
<g id="edge1933" class="edge">
<title>layer4_expert_agg_3_0&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M1541.22,-465.45C1697.67,-450.42 1923.72,-430.23 2121.79,-418.33 4153.45,-296.29 6628.42,-249.56 7266.76,-239.08"/>
<polygon fill="black" stroke="black" points="7267,-242.57 7276.94,-238.91 7266.88,-235.57 7267,-242.57"/>
</g>
<!-- layer4_expert_agg_3_1&#45;&gt;layer4_res2 -->
<g id="edge1934" class="edge">
<title>layer4_expert_agg_3_1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M4468.99,-467.74C4625.54,-454 4851.85,-434.41 5049.79,-418.33 5885.65,-350.41 6887.72,-276 7267.06,-248.08"/>
<polygon fill="black" stroke="black" points="7267.56,-251.55 7277.28,-247.33 7267.05,-244.57 7267.56,-251.55"/>
</g>
<!-- layer4_expert_agg_3_2&#45;&gt;layer4_res2 -->
<g id="edge1935" class="edge">
<title>layer4_expert_agg_3_2&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M687.13,-461.4C816.7,-446.6 991.24,-428.44 1145.79,-418.33 3581.93,-259 6559.04,-239.41 7266.67,-237"/>
<polygon fill="black" stroke="black" points="7266.93,-240.5 7276.92,-236.97 7266.91,-233.5 7266.93,-240.5"/>
</g>
<!-- layer4_expert_agg_3_3&#45;&gt;layer4_res2 -->
<g id="edge1936" class="edge">
<title>layer4_expert_agg_3_3&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M13720.37,-465.31C13563.92,-450.21 13337.88,-429.98 13139.79,-418.33 10935.55,-288.67 8247.39,-247.2 7578.87,-238.53"/>
<polygon fill="black" stroke="black" points="7578.74,-235.03 7568.69,-238.4 7578.65,-242.03 7578.74,-235.03"/>
</g>
<!-- output -->
<g id="node702" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="7512.29,-53 7333.29,-53 7333.29,0 7512.29,0 7512.29,-53"/>
<text text-anchor="middle" x="7422.79" y="-37.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7422.79" y="-22.8" font-family="Times,serif" font-size="14.00">Shape: [1024, L, 8192]</text>
<text text-anchor="middle" x="7422.79" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer4_res2&#45;&gt;output -->
<g id="edge1937" class="edge">
<title>layer4_res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7422.79,-89.94C7422.79,-80.46 7422.79,-71.53 7422.79,-63.54"/>
<polygon fill="black" stroke="black" points="7426.29,-63.29 7422.79,-53.29 7419.29,-63.29 7426.29,-63.29"/>
</g>
</g>
</svg>
