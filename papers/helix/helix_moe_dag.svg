<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Transformer_Helix_16GPUs Pages: 1 -->
<svg width="8909pt" height="2630pt"
 viewBox="0.00 0.00 8909.37 2630.27" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2626.27)">
<title>MoE_Transformer_Helix_16GPUs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2626.27 8905.37,-2626.27 8905.37,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="167.58" cy="-2595.4" rx="167.67" ry="26.74"/>
<text text-anchor="middle" x="167.58" y="-2599.2" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="167.58" y="-2584.2" font-family="Times,serif" font-size="14.00">[B=1024, L=seq_len, D=8192]</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightyellow" stroke="black" points="4292.08,-2481.53 4191.08,-2481.53 4191.08,-2428.53 4292.08,-2428.53 4292.08,-2481.53"/>
<text text-anchor="middle" x="4241.58" y="-2466.33" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4241.58" y="-2451.33" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4241.58" y="-2436.33" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M335.21,-2595C1102.38,-2595 4241.58,-2595 4241.58,-2595 4241.58,-2595 4241.58,-2491.69 4241.58,-2491.69"/>
<polygon fill="black" stroke="black" points="4245.08,-2491.69 4241.58,-2481.69 4238.08,-2491.69 4245.08,-2491.69"/>
</g>
<!-- residual1 -->
<g id="node148" class="node">
<title>residual1</title>
<ellipse fill="lightgray" stroke="black" cx="167.58" cy="-905.25" rx="71.34" ry="71.34"/>
<text text-anchor="middle" x="167.58" y="-916.55" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="167.58" y="-901.55" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="167.58" y="-886.55" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;residual1 -->
<g id="edge242" class="edge">
<title>input&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M148.98,-2568.51C148.98,-2568.51 148.98,-984.57 148.98,-984.57"/>
<polygon fill="black" stroke="black" points="152.48,-984.57 148.98,-974.57 145.48,-984.57 152.48,-984.57"/>
</g>
<!-- qkv_proj_0 -->
<g id="node3" class="node">
<title>qkv_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="1705.08,-2341.53 1532.08,-2341.53 1532.08,-2258.53 1705.08,-2258.53 1705.08,-2341.53"/>
<text text-anchor="middle" x="1618.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1618.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="1618.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1618.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1618.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 0, Slice 0</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_0 -->
<g id="edge2" class="edge">
<title>ln1&#45;&gt;qkv_proj_0</title>
<path fill="none" stroke="black" d="M4190.95,-2461C3826.55,-2461 1618.58,-2461 1618.58,-2461 1618.58,-2461 1618.58,-2351.9 1618.58,-2351.9"/>
<polygon fill="black" stroke="black" points="1622.08,-2351.9 1618.58,-2341.9 1615.08,-2351.9 1622.08,-2351.9"/>
</g>
<!-- qkv_proj_1 -->
<g id="node4" class="node">
<title>qkv_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="611.08,-2341.53 438.08,-2341.53 438.08,-2258.53 611.08,-2258.53 611.08,-2341.53"/>
<text text-anchor="middle" x="524.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="524.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="524.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="524.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="524.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 0, Slice 1</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_1 -->
<g id="edge3" class="edge">
<title>ln1&#45;&gt;qkv_proj_1</title>
<path fill="none" stroke="black" d="M4190.8,-2474C3745.7,-2474 524.58,-2474 524.58,-2474 524.58,-2474 524.58,-2351.7 524.58,-2351.7"/>
<polygon fill="black" stroke="black" points="528.08,-2351.7 524.58,-2341.7 521.08,-2351.7 528.08,-2351.7"/>
</g>
<!-- qkv_proj_2 -->
<g id="node5" class="node">
<title>qkv_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="2252.08,-2341.53 2079.08,-2341.53 2079.08,-2258.53 2252.08,-2258.53 2252.08,-2341.53"/>
<text text-anchor="middle" x="2165.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2165.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="2165.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2165.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2165.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 0, Slice 2</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_2 -->
<g id="edge4" class="edge">
<title>ln1&#45;&gt;qkv_proj_2</title>
<path fill="none" stroke="black" d="M4191.04,-2455C3873.34,-2455 2165.58,-2455 2165.58,-2455 2165.58,-2455 2165.58,-2351.56 2165.58,-2351.56"/>
<polygon fill="black" stroke="black" points="2169.08,-2351.56 2165.58,-2341.56 2162.08,-2351.56 2169.08,-2351.56"/>
</g>
<!-- qkv_proj_3 -->
<g id="node6" class="node">
<title>qkv_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="1122.08,-2341.53 949.08,-2341.53 949.08,-2258.53 1122.08,-2258.53 1122.08,-2341.53"/>
<text text-anchor="middle" x="1035.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1035.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="1035.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1035.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1035.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 0, Slice 3</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_3 -->
<g id="edge5" class="edge">
<title>ln1&#45;&gt;qkv_proj_3</title>
<path fill="none" stroke="black" d="M4190.9,-2468C3781.9,-2468 1035.58,-2468 1035.58,-2468 1035.58,-2468 1035.58,-2351.55 1035.58,-2351.55"/>
<polygon fill="black" stroke="black" points="1039.08,-2351.55 1035.58,-2341.55 1032.08,-2351.55 1039.08,-2351.55"/>
</g>
<!-- qkv_proj_4 -->
<g id="node7" class="node">
<title>qkv_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="2795.08,-2341.53 2622.08,-2341.53 2622.08,-2258.53 2795.08,-2258.53 2795.08,-2341.53"/>
<text text-anchor="middle" x="2708.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2708.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="2708.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2708.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2708.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 1, Slice 0</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_4 -->
<g id="edge6" class="edge">
<title>ln1&#45;&gt;qkv_proj_4</title>
<path fill="none" stroke="black" d="M4191.02,-2448C3925.91,-2448 2708.58,-2448 2708.58,-2448 2708.58,-2448 2708.58,-2351.64 2708.58,-2351.64"/>
<polygon fill="black" stroke="black" points="2712.08,-2351.64 2708.58,-2341.64 2705.08,-2351.64 2712.08,-2351.64"/>
</g>
<!-- qkv_proj_5 -->
<g id="node8" class="node">
<title>qkv_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="4328.08,-2341.53 4155.08,-2341.53 4155.08,-2258.53 4328.08,-2258.53 4328.08,-2341.53"/>
<text text-anchor="middle" x="4241.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4241.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="4241.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4241.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4241.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 1, Slice 1</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_5 -->
<g id="edge7" class="edge">
<title>ln1&#45;&gt;qkv_proj_5</title>
<path fill="none" stroke="black" d="M4241.58,-2428.39C4241.58,-2428.39 4241.58,-2351.78 4241.58,-2351.78"/>
<polygon fill="black" stroke="black" points="4245.08,-2351.78 4241.58,-2341.78 4238.08,-2351.78 4245.08,-2351.78"/>
</g>
<!-- qkv_proj_6 -->
<g id="node9" class="node">
<title>qkv_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="3871.08,-2341.53 3698.08,-2341.53 3698.08,-2258.53 3871.08,-2258.53 3871.08,-2341.53"/>
<text text-anchor="middle" x="3784.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3784.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="3784.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3784.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3784.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 1, Slice 2</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_6 -->
<g id="edge8" class="edge">
<title>ln1&#45;&gt;qkv_proj_6</title>
<path fill="none" stroke="black" d="M4190.93,-2435C4071.95,-2435 3784.58,-2435 3784.58,-2435 3784.58,-2435 3784.58,-2351.63 3784.58,-2351.63"/>
<polygon fill="black" stroke="black" points="3788.08,-2351.63 3784.58,-2341.63 3781.08,-2351.63 3788.08,-2351.63"/>
</g>
<!-- qkv_proj_7 -->
<g id="node10" class="node">
<title>qkv_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="3306.08,-2341.53 3133.08,-2341.53 3133.08,-2258.53 3306.08,-2258.53 3306.08,-2341.53"/>
<text text-anchor="middle" x="3219.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3219.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="3219.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3219.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3219.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 1, Slice 3</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_7 -->
<g id="edge9" class="edge">
<title>ln1&#45;&gt;qkv_proj_7</title>
<path fill="none" stroke="black" d="M4190.9,-2441C3984.68,-2441 3219.58,-2441 3219.58,-2441 3219.58,-2441 3219.58,-2351.56 3219.58,-2351.56"/>
<polygon fill="black" stroke="black" points="3223.08,-2351.56 3219.58,-2341.56 3216.08,-2351.56 3223.08,-2351.56"/>
</g>
<!-- qkv_proj_8 -->
<g id="node11" class="node">
<title>qkv_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="4766.08,-2341.53 4593.08,-2341.53 4593.08,-2258.53 4766.08,-2258.53 4766.08,-2341.53"/>
<text text-anchor="middle" x="4679.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4679.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="4679.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4679.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4679.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 2, Slice 0</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_8 -->
<g id="edge10" class="edge">
<title>ln1&#45;&gt;qkv_proj_8</title>
<path fill="none" stroke="black" d="M4292.26,-2434C4407.55,-2434 4679.58,-2434 4679.58,-2434 4679.58,-2434 4679.58,-2351.69 4679.58,-2351.69"/>
<polygon fill="black" stroke="black" points="4683.08,-2351.69 4679.58,-2341.69 4676.08,-2351.69 4683.08,-2351.69"/>
</g>
<!-- qkv_proj_9 -->
<g id="node12" class="node">
<title>qkv_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="6404.08,-2341.53 6231.08,-2341.53 6231.08,-2258.53 6404.08,-2258.53 6404.08,-2341.53"/>
<text text-anchor="middle" x="6317.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6317.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="6317.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6317.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6317.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 2, Slice 1</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_9 -->
<g id="edge11" class="edge">
<title>ln1&#45;&gt;qkv_proj_9</title>
<path fill="none" stroke="black" d="M4292.13,-2452C4609.83,-2452 6317.58,-2452 6317.58,-2452 6317.58,-2452 6317.58,-2351.56 6317.58,-2351.56"/>
<polygon fill="black" stroke="black" points="6321.08,-2351.56 6317.58,-2341.56 6314.08,-2351.56 6321.08,-2351.56"/>
</g>
<!-- qkv_proj_10 -->
<g id="node13" class="node">
<title>qkv_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="5857.08,-2341.53 5684.08,-2341.53 5684.08,-2258.53 5857.08,-2258.53 5857.08,-2341.53"/>
<text text-anchor="middle" x="5770.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5770.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="5770.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5770.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="5770.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 2, Slice 2</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_10 -->
<g id="edge12" class="edge">
<title>ln1&#45;&gt;qkv_proj_10</title>
<path fill="none" stroke="black" d="M4292.46,-2446C4557.76,-2446 5770.58,-2446 5770.58,-2446 5770.58,-2446 5770.58,-2351.86 5770.58,-2351.86"/>
<polygon fill="black" stroke="black" points="5774.08,-2351.86 5770.58,-2341.86 5767.08,-2351.86 5774.08,-2351.86"/>
</g>
<!-- qkv_proj_11 -->
<g id="node14" class="node">
<title>qkv_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="5312.08,-2341.53 5139.08,-2341.53 5139.08,-2258.53 5312.08,-2258.53 5312.08,-2341.53"/>
<text text-anchor="middle" x="5225.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5225.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="5225.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5225.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="5225.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 2, Slice 3</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_11 -->
<g id="edge13" class="edge">
<title>ln1&#45;&gt;qkv_proj_11</title>
<path fill="none" stroke="black" d="M4292.42,-2440C4493.91,-2440 5225.58,-2440 5225.58,-2440 5225.58,-2440 5225.58,-2351.65 5225.58,-2351.65"/>
<polygon fill="black" stroke="black" points="5229.08,-2351.65 5225.58,-2341.65 5222.08,-2351.65 5229.08,-2351.65"/>
</g>
<!-- qkv_proj_12 -->
<g id="node15" class="node">
<title>qkv_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="6950.08,-2341.53 6777.08,-2341.53 6777.08,-2258.53 6950.08,-2258.53 6950.08,-2341.53"/>
<text text-anchor="middle" x="6863.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6863.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="6863.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6863.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6863.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 3, Slice 0</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_12 -->
<g id="edge14" class="edge">
<title>ln1&#45;&gt;qkv_proj_12</title>
<path fill="none" stroke="black" d="M4292.2,-2457C4656.46,-2457 6863.58,-2457 6863.58,-2457 6863.58,-2457 6863.58,-2351.68 6863.58,-2351.68"/>
<polygon fill="black" stroke="black" points="6867.08,-2351.68 6863.58,-2341.68 6860.08,-2351.68 6867.08,-2351.68"/>
</g>
<!-- qkv_proj_13 -->
<g id="node16" class="node">
<title>qkv_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="8587.08,-2341.53 8414.08,-2341.53 8414.08,-2258.53 8587.08,-2258.53 8587.08,-2341.53"/>
<text text-anchor="middle" x="8500.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8500.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="8500.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8500.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8500.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 3, Slice 1</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_13 -->
<g id="edge15" class="edge">
<title>ln1&#45;&gt;qkv_proj_13</title>
<path fill="none" stroke="black" d="M4292.38,-2475C4772.9,-2475 8500.58,-2475 8500.58,-2475 8500.58,-2475 8500.58,-2351.94 8500.58,-2351.94"/>
<polygon fill="black" stroke="black" points="8504.08,-2351.94 8500.58,-2341.94 8497.08,-2351.94 8504.08,-2351.94"/>
</g>
<!-- qkv_proj_14 -->
<g id="node17" class="node">
<title>qkv_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="8042.08,-2341.53 7869.08,-2341.53 7869.08,-2258.53 8042.08,-2258.53 8042.08,-2341.53"/>
<text text-anchor="middle" x="7955.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7955.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="7955.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7955.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="7955.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 3, Slice 2</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_14 -->
<g id="edge16" class="edge">
<title>ln1&#45;&gt;qkv_proj_14</title>
<path fill="none" stroke="black" d="M4292.32,-2469C4737.07,-2469 7955.58,-2469 7955.58,-2469 7955.58,-2469 7955.58,-2351.8 7955.58,-2351.8"/>
<polygon fill="black" stroke="black" points="7959.08,-2351.8 7955.58,-2341.8 7952.08,-2351.8 7959.08,-2351.8"/>
</g>
<!-- qkv_proj_15 -->
<g id="node18" class="node">
<title>qkv_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="7496.08,-2341.53 7323.08,-2341.53 7323.08,-2258.53 7496.08,-2258.53 7496.08,-2341.53"/>
<text text-anchor="middle" x="7409.58" y="-2326.33" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7409.58" y="-2311.33" font-family="Times,serif" font-size="14.00">[B, L, 1536]</text>
<text text-anchor="middle" x="7409.58" y="-2296.33" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="7409.58" y="-2281.33" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="7409.58" y="-2266.33" font-family="Times,serif" font-size="14.00">Head Group 3, Slice 3</text>
</g>
<!-- ln1&#45;&gt;qkv_proj_15 -->
<g id="edge17" class="edge">
<title>ln1&#45;&gt;qkv_proj_15</title>
<path fill="none" stroke="black" d="M4292.31,-2463C4698.68,-2463 7409.58,-2463 7409.58,-2463 7409.58,-2463 7409.58,-2351.58 7409.58,-2351.58"/>
<polygon fill="black" stroke="black" points="7413.08,-2351.58 7409.58,-2341.58 7406.08,-2351.58 7413.08,-2351.58"/>
</g>
<!-- q_slice_0 -->
<g id="node19" class="node">
<title>q_slice_0</title>
<ellipse fill="lightcoral" stroke="black" cx="1511.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="1511.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="1511.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1511.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_proj_0&#45;&gt;q_slice_0 -->
<g id="edge18" class="edge">
<title>qkv_proj_0&#45;&gt;q_slice_0</title>
<path fill="none" stroke="black" d="M1560.73,-2258.15C1560.73,-2258.15 1560.73,-2173.11 1560.73,-2173.11"/>
<polygon fill="black" stroke="black" points="1564.23,-2173.11 1560.73,-2163.11 1557.23,-2173.11 1564.23,-2173.11"/>
</g>
<!-- k_slice_0 -->
<g id="node20" class="node">
<title>k_slice_0</title>
<ellipse fill="lightcoral" stroke="black" cx="1725.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="1725.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="1725.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1725.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_proj_0&#45;&gt;k_slice_0 -->
<g id="edge19" class="edge">
<title>qkv_proj_0&#45;&gt;k_slice_0</title>
<path fill="none" stroke="black" d="M1676.44,-2258.15C1676.44,-2258.15 1676.44,-2173.11 1676.44,-2173.11"/>
<polygon fill="black" stroke="black" points="1679.94,-2173.11 1676.44,-2163.11 1672.94,-2173.11 1679.94,-2173.11"/>
</g>
<!-- v_slice_0 -->
<g id="node21" class="node">
<title>v_slice_0</title>
<ellipse fill="lightcoral" stroke="black" cx="1405.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="1405.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="1405.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1405.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_proj_0&#45;&gt;v_slice_0 -->
<g id="edge20" class="edge">
<title>qkv_proj_0&#45;&gt;v_slice_0</title>
<path fill="none" stroke="black" d="M1532.07,-2300C1464.08,-2300 1380.8,-2300 1380.8,-2300 1380.8,-2300 1380.8,-1847.95 1380.8,-1847.95"/>
<polygon fill="black" stroke="black" points="1384.3,-1847.95 1380.8,-1837.95 1377.3,-1847.95 1384.3,-1847.95"/>
</g>
<!-- q_slice_1 -->
<g id="node22" class="node">
<title>q_slice_1</title>
<ellipse fill="lightcoral" stroke="black" cx="633.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="633.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="633.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="633.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_proj_1&#45;&gt;q_slice_1 -->
<g id="edge21" class="edge">
<title>qkv_proj_1&#45;&gt;q_slice_1</title>
<path fill="none" stroke="black" d="M583.44,-2258.15C583.44,-2258.15 583.44,-2172.86 583.44,-2172.86"/>
<polygon fill="black" stroke="black" points="586.94,-2172.86 583.44,-2162.86 579.94,-2172.86 586.94,-2172.86"/>
</g>
<!-- k_slice_1 -->
<g id="node23" class="node">
<title>k_slice_1</title>
<ellipse fill="lightcoral" stroke="black" cx="419.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="419.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="419.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="419.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_proj_1&#45;&gt;k_slice_1 -->
<g id="edge22" class="edge">
<title>qkv_proj_1&#45;&gt;k_slice_1</title>
<path fill="none" stroke="black" d="M467.73,-2258.15C467.73,-2258.15 467.73,-2173.63 467.73,-2173.63"/>
<polygon fill="black" stroke="black" points="471.23,-2173.63 467.73,-2163.63 464.23,-2173.63 471.23,-2173.63"/>
</g>
<!-- v_slice_1 -->
<g id="node24" class="node">
<title>v_slice_1</title>
<ellipse fill="lightcoral" stroke="black" cx="279.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="279.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="279.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="279.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_proj_1&#45;&gt;v_slice_1 -->
<g id="edge23" class="edge">
<title>qkv_proj_1&#45;&gt;v_slice_1</title>
<path fill="none" stroke="black" d="M526.58,-2258.43C526.58,-2179.53 526.58,-2016 526.58,-2016 526.58,-2016 367.4,-2016 367.4,-2016"/>
<polygon fill="black" stroke="black" points="367.4,-2012.5 357.4,-2016 367.4,-2019.5 367.4,-2012.5"/>
</g>
<!-- q_slice_2 -->
<g id="node25" class="node">
<title>q_slice_2</title>
<ellipse fill="lightcoral" stroke="black" cx="2057.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2057.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="2057.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2057.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_proj_2&#45;&gt;q_slice_2 -->
<g id="edge24" class="edge">
<title>qkv_proj_2&#45;&gt;q_slice_2</title>
<path fill="none" stroke="black" d="M2107.23,-2258.15C2107.23,-2258.15 2107.23,-2173.11 2107.23,-2173.11"/>
<polygon fill="black" stroke="black" points="2110.73,-2173.11 2107.23,-2163.11 2103.73,-2173.11 2110.73,-2173.11"/>
</g>
<!-- k_slice_2 -->
<g id="node26" class="node">
<title>k_slice_2</title>
<ellipse fill="lightcoral" stroke="black" cx="2271.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2271.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="2271.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2271.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_proj_2&#45;&gt;k_slice_2 -->
<g id="edge25" class="edge">
<title>qkv_proj_2&#45;&gt;k_slice_2</title>
<path fill="none" stroke="black" d="M2222.94,-2258.15C2222.94,-2258.15 2222.94,-2173.37 2222.94,-2173.37"/>
<polygon fill="black" stroke="black" points="2226.44,-2173.37 2222.94,-2163.37 2219.44,-2173.37 2226.44,-2173.37"/>
</g>
<!-- v_slice_2 -->
<g id="node27" class="node">
<title>v_slice_2</title>
<ellipse fill="lightcoral" stroke="black" cx="1935.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="1935.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="1935.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1935.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_proj_2&#45;&gt;v_slice_2 -->
<g id="edge26" class="edge">
<title>qkv_proj_2&#45;&gt;v_slice_2</title>
<path fill="none" stroke="black" d="M2078.93,-2300C2007.82,-2300 1918.8,-2300 1918.8,-2300 1918.8,-2300 1918.8,-1848.76 1918.8,-1848.76"/>
<polygon fill="black" stroke="black" points="1922.3,-1848.76 1918.8,-1838.76 1915.3,-1848.76 1922.3,-1848.76"/>
</g>
<!-- q_slice_3 -->
<g id="node28" class="node">
<title>q_slice_3</title>
<ellipse fill="lightcoral" stroke="black" cx="1179.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="1179.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="1179.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1179.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_proj_3&#45;&gt;q_slice_3 -->
<g id="edge27" class="edge">
<title>qkv_proj_3&#45;&gt;q_slice_3</title>
<path fill="none" stroke="black" d="M1111.94,-2258.15C1111.94,-2258.15 1111.94,-2162.93 1111.94,-2162.93"/>
<polygon fill="black" stroke="black" points="1115.44,-2162.93 1111.94,-2152.93 1108.44,-2162.93 1115.44,-2162.93"/>
</g>
<!-- k_slice_3 -->
<g id="node29" class="node">
<title>k_slice_3</title>
<ellipse fill="lightcoral" stroke="black" cx="965.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="965.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="965.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="965.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_proj_3&#45;&gt;k_slice_3 -->
<g id="edge28" class="edge">
<title>qkv_proj_3&#45;&gt;k_slice_3</title>
<path fill="none" stroke="black" d="M996.23,-2258.15C996.23,-2258.15 996.23,-2178.65 996.23,-2178.65"/>
<polygon fill="black" stroke="black" points="999.73,-2178.65 996.23,-2168.65 992.73,-2178.65 999.73,-2178.65"/>
</g>
<!-- v_slice_3 -->
<g id="node30" class="node">
<title>v_slice_3</title>
<ellipse fill="lightcoral" stroke="black" cx="813.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="813.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="813.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="813.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_proj_3&#45;&gt;v_slice_3 -->
<g id="edge29" class="edge">
<title>qkv_proj_3&#45;&gt;v_slice_3</title>
<path fill="none" stroke="black" d="M949.06,-2300C886.09,-2300 811.8,-2300 811.8,-2300 811.8,-2300 811.8,-2063.8 811.8,-2063.8"/>
<polygon fill="black" stroke="black" points="815.3,-2063.8 811.8,-2053.8 808.3,-2063.8 815.3,-2063.8"/>
</g>
<!-- q_slice_4 -->
<g id="node31" class="node">
<title>q_slice_4</title>
<ellipse fill="lightcoral" stroke="black" cx="2817.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2817.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="2817.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2817.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_proj_4&#45;&gt;q_slice_4 -->
<g id="edge30" class="edge">
<title>qkv_proj_4&#45;&gt;q_slice_4</title>
<path fill="none" stroke="black" d="M2767.44,-2258.15C2767.44,-2258.15 2767.44,-2172.86 2767.44,-2172.86"/>
<polygon fill="black" stroke="black" points="2770.94,-2172.86 2767.44,-2162.86 2763.94,-2172.86 2770.94,-2172.86"/>
</g>
<!-- k_slice_4 -->
<g id="node32" class="node">
<title>k_slice_4</title>
<ellipse fill="lightcoral" stroke="black" cx="2603.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2603.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="2603.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2603.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_proj_4&#45;&gt;k_slice_4 -->
<g id="edge31" class="edge">
<title>qkv_proj_4&#45;&gt;k_slice_4</title>
<path fill="none" stroke="black" d="M2651.73,-2258.15C2651.73,-2258.15 2651.73,-2173.63 2651.73,-2173.63"/>
<polygon fill="black" stroke="black" points="2655.23,-2173.63 2651.73,-2163.63 2648.23,-2173.63 2655.23,-2173.63"/>
</g>
<!-- v_slice_4 -->
<g id="node33" class="node">
<title>v_slice_4</title>
<ellipse fill="lightcoral" stroke="black" cx="2481.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2481.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="2481.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2481.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_proj_4&#45;&gt;v_slice_4 -->
<g id="edge32" class="edge">
<title>qkv_proj_4&#45;&gt;v_slice_4</title>
<path fill="none" stroke="black" d="M2710.58,-2258.43C2710.58,-2179.53 2710.58,-2016 2710.58,-2016 2710.58,-2016 2569.43,-2016 2569.43,-2016"/>
<polygon fill="black" stroke="black" points="2569.43,-2012.5 2559.43,-2016 2569.43,-2019.5 2569.43,-2012.5"/>
</g>
<!-- q_slice_5 -->
<g id="node34" class="node">
<title>q_slice_5</title>
<ellipse fill="lightcoral" stroke="black" cx="4455.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="4455.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="4455.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4455.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_proj_5&#45;&gt;q_slice_5 -->
<g id="edge33" class="edge">
<title>qkv_proj_5&#45;&gt;q_slice_5</title>
<path fill="none" stroke="black" d="M4323.73,-2258.13C4323.73,-2208.95 4323.73,-2134 4323.73,-2134 4323.73,-2134 4367.74,-2134 4367.74,-2134"/>
<polygon fill="black" stroke="black" points="4367.74,-2137.5 4377.74,-2134 4367.74,-2130.5 4367.74,-2137.5"/>
</g>
<!-- k_slice_5 -->
<g id="node35" class="node">
<title>k_slice_5</title>
<ellipse fill="lightcoral" stroke="black" cx="4241.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="4241.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="4241.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4241.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_proj_5&#45;&gt;k_slice_5 -->
<g id="edge34" class="edge">
<title>qkv_proj_5&#45;&gt;k_slice_5</title>
<path fill="none" stroke="black" d="M4241.58,-2258.15C4241.58,-2258.15 4241.58,-2181.67 4241.58,-2181.67"/>
<polygon fill="black" stroke="black" points="4245.08,-2181.67 4241.58,-2171.67 4238.08,-2181.67 4245.08,-2181.67"/>
</g>
<!-- v_slice_5 -->
<g id="node36" class="node">
<title>v_slice_5</title>
<ellipse fill="lightcoral" stroke="black" cx="4077.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="4077.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="4077.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4077.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_proj_5&#45;&gt;v_slice_5 -->
<g id="edge35" class="edge">
<title>qkv_proj_5&#45;&gt;v_slice_5</title>
<path fill="none" stroke="black" d="M4159.58,-2258.43C4159.58,-2138.73 4159.58,-1802 4159.58,-1802 4159.58,-1802 4159.19,-1802 4159.19,-1802"/>
<polygon fill="black" stroke="black" points="4165.63,-1798.5 4155.63,-1802 4165.63,-1805.5 4165.63,-1798.5"/>
</g>
<!-- q_slice_6 -->
<g id="node37" class="node">
<title>q_slice_6</title>
<ellipse fill="lightcoral" stroke="black" cx="3695.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="3695.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="3695.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3695.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_proj_6&#45;&gt;q_slice_6 -->
<g id="edge36" class="edge">
<title>qkv_proj_6&#45;&gt;q_slice_6</title>
<path fill="none" stroke="black" d="M3735.73,-2258.15C3735.73,-2258.15 3735.73,-2176.23 3735.73,-2176.23"/>
<polygon fill="black" stroke="black" points="3739.23,-2176.23 3735.73,-2166.23 3732.23,-2176.23 3739.23,-2176.23"/>
</g>
<!-- k_slice_6 -->
<g id="node38" class="node">
<title>k_slice_6</title>
<ellipse fill="lightcoral" stroke="black" cx="3909.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="3909.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="3909.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3909.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_proj_6&#45;&gt;k_slice_6 -->
<g id="edge37" class="edge">
<title>qkv_proj_6&#45;&gt;k_slice_6</title>
<path fill="none" stroke="black" d="M3851.44,-2258.15C3851.44,-2258.15 3851.44,-2169.38 3851.44,-2169.38"/>
<polygon fill="black" stroke="black" points="3854.94,-2169.38 3851.44,-2159.38 3847.94,-2169.38 3854.94,-2169.38"/>
</g>
<!-- v_slice_6 -->
<g id="node39" class="node">
<title>v_slice_6</title>
<ellipse fill="lightcoral" stroke="black" cx="3540.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="3540.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="3540.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3540.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_proj_6&#45;&gt;v_slice_6 -->
<g id="edge38" class="edge">
<title>qkv_proj_6&#45;&gt;v_slice_6</title>
<path fill="none" stroke="black" d="M3697.77,-2300C3627.56,-2300 3540.3,-2300 3540.3,-2300 3540.3,-2300 3540.3,-2063.8 3540.3,-2063.8"/>
<polygon fill="black" stroke="black" points="3543.8,-2063.8 3540.3,-2053.8 3536.8,-2063.8 3543.8,-2063.8"/>
</g>
<!-- q_slice_7 -->
<g id="node40" class="node">
<title>q_slice_7</title>
<ellipse fill="lightcoral" stroke="black" cx="3363.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="3363.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="3363.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3363.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_proj_7&#45;&gt;q_slice_7 -->
<g id="edge39" class="edge">
<title>qkv_proj_7&#45;&gt;q_slice_7</title>
<path fill="none" stroke="black" d="M3295.94,-2258.15C3295.94,-2258.15 3295.94,-2162.93 3295.94,-2162.93"/>
<polygon fill="black" stroke="black" points="3299.44,-2162.93 3295.94,-2152.93 3292.44,-2162.93 3299.44,-2162.93"/>
</g>
<!-- k_slice_7 -->
<g id="node41" class="node">
<title>k_slice_7</title>
<ellipse fill="lightcoral" stroke="black" cx="3149.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="3149.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="3149.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3149.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_proj_7&#45;&gt;k_slice_7 -->
<g id="edge40" class="edge">
<title>qkv_proj_7&#45;&gt;k_slice_7</title>
<path fill="none" stroke="black" d="M3180.23,-2258.15C3180.23,-2258.15 3180.23,-2178.65 3180.23,-2178.65"/>
<polygon fill="black" stroke="black" points="3183.73,-2178.65 3180.23,-2168.65 3176.73,-2178.65 3183.73,-2178.65"/>
</g>
<!-- v_slice_7 -->
<g id="node42" class="node">
<title>v_slice_7</title>
<ellipse fill="lightcoral" stroke="black" cx="2996.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="2996.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="2996.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2996.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_proj_7&#45;&gt;v_slice_7 -->
<g id="edge41" class="edge">
<title>qkv_proj_7&#45;&gt;v_slice_7</title>
<path fill="none" stroke="black" d="M3132.87,-2300C3069.76,-2300 2995.3,-2300 2995.3,-2300 2995.3,-2300 2995.3,-1849.98 2995.3,-1849.98"/>
<polygon fill="black" stroke="black" points="2998.8,-1849.98 2995.3,-1839.98 2991.8,-1849.98 2998.8,-1849.98"/>
</g>
<!-- q_slice_8 -->
<g id="node43" class="node">
<title>q_slice_8</title>
<ellipse fill="lightcoral" stroke="black" cx="5001.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5001.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="5001.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5001.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_proj_8&#45;&gt;q_slice_8 -->
<g id="edge42" class="edge">
<title>qkv_proj_8&#45;&gt;q_slice_8</title>
<path fill="none" stroke="black" d="M4766.3,-2300C4861.67,-2300 5001.58,-2300 5001.58,-2300 5001.58,-2300 5001.58,-2181.71 5001.58,-2181.71"/>
<polygon fill="black" stroke="black" points="5005.08,-2181.71 5001.58,-2171.71 4998.08,-2181.71 5005.08,-2181.71"/>
</g>
<!-- k_slice_8 -->
<g id="node44" class="node">
<title>k_slice_8</title>
<ellipse fill="lightcoral" stroke="black" cx="4787.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="4787.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="4787.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4787.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_proj_8&#45;&gt;k_slice_8 -->
<g id="edge43" class="edge">
<title>qkv_proj_8&#45;&gt;k_slice_8</title>
<path fill="none" stroke="black" d="M4737.94,-2258.15C4737.94,-2258.15 4737.94,-2173.11 4737.94,-2173.11"/>
<polygon fill="black" stroke="black" points="4741.44,-2173.11 4737.94,-2163.11 4734.44,-2173.11 4741.44,-2173.11"/>
</g>
<!-- v_slice_8 -->
<g id="node45" class="node">
<title>v_slice_8</title>
<ellipse fill="lightcoral" stroke="black" cx="4621.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="4621.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="4621.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4621.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_proj_8&#45;&gt;v_slice_8 -->
<g id="edge44" class="edge">
<title>qkv_proj_8&#45;&gt;v_slice_8</title>
<path fill="none" stroke="black" d="M4646.23,-2258.44C4646.23,-2258.44 4646.23,-2061.96 4646.23,-2061.96"/>
<polygon fill="black" stroke="black" points="4649.73,-2061.96 4646.23,-2051.96 4642.73,-2061.96 4649.73,-2061.96"/>
</g>
<!-- q_slice_9 -->
<g id="node46" class="node">
<title>q_slice_9</title>
<ellipse fill="lightcoral" stroke="black" cx="6639.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6639.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="6639.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6639.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_proj_9&#45;&gt;q_slice_9 -->
<g id="edge45" class="edge">
<title>qkv_proj_9&#45;&gt;q_slice_9</title>
<path fill="none" stroke="black" d="M6404.3,-2300C6499.67,-2300 6639.58,-2300 6639.58,-2300 6639.58,-2300 6639.58,-2181.71 6639.58,-2181.71"/>
<polygon fill="black" stroke="black" points="6643.08,-2181.71 6639.58,-2171.71 6636.08,-2181.71 6643.08,-2181.71"/>
</g>
<!-- k_slice_9 -->
<g id="node47" class="node">
<title>k_slice_9</title>
<ellipse fill="lightcoral" stroke="black" cx="6425.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6425.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="6425.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6425.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_proj_9&#45;&gt;k_slice_9 -->
<g id="edge46" class="edge">
<title>qkv_proj_9&#45;&gt;k_slice_9</title>
<path fill="none" stroke="black" d="M6375.94,-2258.15C6375.94,-2258.15 6375.94,-2173.11 6375.94,-2173.11"/>
<polygon fill="black" stroke="black" points="6379.44,-2173.11 6375.94,-2163.11 6372.44,-2173.11 6379.44,-2173.11"/>
</g>
<!-- v_slice_9 -->
<g id="node48" class="node">
<title>v_slice_9</title>
<ellipse fill="lightcoral" stroke="black" cx="6259.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6259.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="6259.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6259.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_proj_9&#45;&gt;v_slice_9 -->
<g id="edge47" class="edge">
<title>qkv_proj_9&#45;&gt;v_slice_9</title>
<path fill="none" stroke="black" d="M6284.23,-2258.44C6284.23,-2258.44 6284.23,-1847.85 6284.23,-1847.85"/>
<polygon fill="black" stroke="black" points="6287.73,-1847.85 6284.23,-1837.85 6280.73,-1847.85 6287.73,-1847.85"/>
</g>
<!-- q_slice_10 -->
<g id="node49" class="node">
<title>q_slice_10</title>
<ellipse fill="lightcoral" stroke="black" cx="5879.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5879.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="5879.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5879.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_proj_10&#45;&gt;q_slice_10 -->
<g id="edge48" class="edge">
<title>qkv_proj_10&#45;&gt;q_slice_10</title>
<path fill="none" stroke="black" d="M5829.44,-2258.15C5829.44,-2258.15 5829.44,-2172.86 5829.44,-2172.86"/>
<polygon fill="black" stroke="black" points="5832.94,-2172.86 5829.44,-2162.86 5825.94,-2172.86 5832.94,-2172.86"/>
</g>
<!-- k_slice_10 -->
<g id="node50" class="node">
<title>k_slice_10</title>
<ellipse fill="lightcoral" stroke="black" cx="6093.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6093.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="6093.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6093.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_proj_10&#45;&gt;k_slice_10 -->
<g id="edge49" class="edge">
<title>qkv_proj_10&#45;&gt;k_slice_10</title>
<path fill="none" stroke="black" d="M5857.14,-2300C5952.82,-2300 6093.58,-2300 6093.58,-2300 6093.58,-2300 6093.58,-2181.71 6093.58,-2181.71"/>
<polygon fill="black" stroke="black" points="6097.08,-2181.71 6093.58,-2171.71 6090.08,-2181.71 6097.08,-2181.71"/>
</g>
<!-- v_slice_10 -->
<g id="node51" class="node">
<title>v_slice_10</title>
<ellipse fill="lightcoral" stroke="black" cx="5713.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5713.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="5713.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5713.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_proj_10&#45;&gt;v_slice_10 -->
<g id="edge50" class="edge">
<title>qkv_proj_10&#45;&gt;v_slice_10</title>
<path fill="none" stroke="black" d="M5737.73,-2258.44C5737.73,-2258.44 5737.73,-2061.96 5737.73,-2061.96"/>
<polygon fill="black" stroke="black" points="5741.23,-2061.96 5737.73,-2051.96 5734.23,-2061.96 5741.23,-2061.96"/>
</g>
<!-- q_slice_11 -->
<g id="node52" class="node">
<title>q_slice_11</title>
<ellipse fill="lightcoral" stroke="black" cx="5547.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5547.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="5547.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5547.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_proj_11&#45;&gt;q_slice_11 -->
<g id="edge51" class="edge">
<title>qkv_proj_11&#45;&gt;q_slice_11</title>
<path fill="none" stroke="black" d="M5312.3,-2300C5407.67,-2300 5547.58,-2300 5547.58,-2300 5547.58,-2300 5547.58,-2181.71 5547.58,-2181.71"/>
<polygon fill="black" stroke="black" points="5551.08,-2181.71 5547.58,-2171.71 5544.08,-2181.71 5551.08,-2181.71"/>
</g>
<!-- k_slice_11 -->
<g id="node53" class="node">
<title>k_slice_11</title>
<ellipse fill="lightcoral" stroke="black" cx="5333.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5333.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="5333.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5333.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_proj_11&#45;&gt;k_slice_11 -->
<g id="edge52" class="edge">
<title>qkv_proj_11&#45;&gt;k_slice_11</title>
<path fill="none" stroke="black" d="M5283.94,-2258.15C5283.94,-2258.15 5283.94,-2173.11 5283.94,-2173.11"/>
<polygon fill="black" stroke="black" points="5287.44,-2173.11 5283.94,-2163.11 5280.44,-2173.11 5287.44,-2173.11"/>
</g>
<!-- v_slice_11 -->
<g id="node54" class="node">
<title>v_slice_11</title>
<ellipse fill="lightcoral" stroke="black" cx="5167.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5167.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="5167.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5167.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_proj_11&#45;&gt;v_slice_11 -->
<g id="edge53" class="edge">
<title>qkv_proj_11&#45;&gt;v_slice_11</title>
<path fill="none" stroke="black" d="M5192.23,-2258.44C5192.23,-2258.44 5192.23,-1847.85 5192.23,-1847.85"/>
<polygon fill="black" stroke="black" points="5195.73,-1847.85 5192.23,-1837.85 5188.73,-1847.85 5195.73,-1847.85"/>
</g>
<!-- q_slice_12 -->
<g id="node55" class="node">
<title>q_slice_12</title>
<ellipse fill="lightcoral" stroke="black" cx="7185.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7185.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="7185.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7185.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_proj_12&#45;&gt;q_slice_12 -->
<g id="edge54" class="edge">
<title>qkv_proj_12&#45;&gt;q_slice_12</title>
<path fill="none" stroke="black" d="M6950.3,-2300C7045.67,-2300 7185.58,-2300 7185.58,-2300 7185.58,-2300 7185.58,-2181.71 7185.58,-2181.71"/>
<polygon fill="black" stroke="black" points="7189.08,-2181.71 7185.58,-2171.71 7182.08,-2181.71 7189.08,-2181.71"/>
</g>
<!-- k_slice_12 -->
<g id="node56" class="node">
<title>k_slice_12</title>
<ellipse fill="lightcoral" stroke="black" cx="6971.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6971.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="6971.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6971.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_proj_12&#45;&gt;k_slice_12 -->
<g id="edge55" class="edge">
<title>qkv_proj_12&#45;&gt;k_slice_12</title>
<path fill="none" stroke="black" d="M6921.94,-2258.15C6921.94,-2258.15 6921.94,-2173.11 6921.94,-2173.11"/>
<polygon fill="black" stroke="black" points="6925.44,-2173.11 6921.94,-2163.11 6918.44,-2173.11 6925.44,-2173.11"/>
</g>
<!-- v_slice_12 -->
<g id="node57" class="node">
<title>v_slice_12</title>
<ellipse fill="lightcoral" stroke="black" cx="6805.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="6805.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="6805.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6805.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_proj_12&#45;&gt;v_slice_12 -->
<g id="edge56" class="edge">
<title>qkv_proj_12&#45;&gt;v_slice_12</title>
<path fill="none" stroke="black" d="M6830.23,-2258.44C6830.23,-2258.44 6830.23,-2061.96 6830.23,-2061.96"/>
<polygon fill="black" stroke="black" points="6833.73,-2061.96 6830.23,-2051.96 6826.73,-2061.96 6833.73,-2061.96"/>
</g>
<!-- q_slice_13 -->
<g id="node58" class="node">
<title>q_slice_13</title>
<ellipse fill="lightcoral" stroke="black" cx="8823.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8823.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="8823.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8823.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_proj_13&#45;&gt;q_slice_13 -->
<g id="edge57" class="edge">
<title>qkv_proj_13&#45;&gt;q_slice_13</title>
<path fill="none" stroke="black" d="M8587.14,-2300C8682.82,-2300 8823.58,-2300 8823.58,-2300 8823.58,-2300 8823.58,-2181.71 8823.58,-2181.71"/>
<polygon fill="black" stroke="black" points="8827.08,-2181.71 8823.58,-2171.71 8820.08,-2181.71 8827.08,-2181.71"/>
</g>
<!-- k_slice_13 -->
<g id="node59" class="node">
<title>k_slice_13</title>
<ellipse fill="lightcoral" stroke="black" cx="8609.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8609.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="8609.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8609.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_proj_13&#45;&gt;k_slice_13 -->
<g id="edge58" class="edge">
<title>qkv_proj_13&#45;&gt;k_slice_13</title>
<path fill="none" stroke="black" d="M8559.44,-2258.15C8559.44,-2258.15 8559.44,-2172.86 8559.44,-2172.86"/>
<polygon fill="black" stroke="black" points="8562.94,-2172.86 8559.44,-2162.86 8555.94,-2172.86 8562.94,-2172.86"/>
</g>
<!-- v_slice_13 -->
<g id="node60" class="node">
<title>v_slice_13</title>
<ellipse fill="lightcoral" stroke="black" cx="8443.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8443.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="8443.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8443.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_proj_13&#45;&gt;v_slice_13 -->
<g id="edge59" class="edge">
<title>qkv_proj_13&#45;&gt;v_slice_13</title>
<path fill="none" stroke="black" d="M8467.73,-2258.44C8467.73,-2258.44 8467.73,-1847.85 8467.73,-1847.85"/>
<polygon fill="black" stroke="black" points="8471.23,-1847.85 8467.73,-1837.85 8464.23,-1847.85 8471.23,-1847.85"/>
</g>
<!-- q_slice_14 -->
<g id="node61" class="node">
<title>q_slice_14</title>
<ellipse fill="lightcoral" stroke="black" cx="8063.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8063.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="8063.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8063.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_proj_14&#45;&gt;q_slice_14 -->
<g id="edge60" class="edge">
<title>qkv_proj_14&#45;&gt;q_slice_14</title>
<path fill="none" stroke="black" d="M8013.94,-2258.15C8013.94,-2258.15 8013.94,-2173.11 8013.94,-2173.11"/>
<polygon fill="black" stroke="black" points="8017.44,-2173.11 8013.94,-2163.11 8010.44,-2173.11 8017.44,-2173.11"/>
</g>
<!-- k_slice_14 -->
<g id="node62" class="node">
<title>k_slice_14</title>
<ellipse fill="lightcoral" stroke="black" cx="8277.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8277.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="8277.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8277.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_proj_14&#45;&gt;k_slice_14 -->
<g id="edge61" class="edge">
<title>qkv_proj_14&#45;&gt;k_slice_14</title>
<path fill="none" stroke="black" d="M8042.3,-2300C8137.67,-2300 8277.58,-2300 8277.58,-2300 8277.58,-2300 8277.58,-2181.71 8277.58,-2181.71"/>
<polygon fill="black" stroke="black" points="8281.08,-2181.71 8277.58,-2171.71 8274.08,-2181.71 8281.08,-2181.71"/>
</g>
<!-- v_slice_14 -->
<g id="node63" class="node">
<title>v_slice_14</title>
<ellipse fill="lightcoral" stroke="black" cx="7897.58" cy="-2016.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7897.58" y="-2027.4" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="7897.58" y="-2012.4" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7897.58" y="-1997.4" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_proj_14&#45;&gt;v_slice_14 -->
<g id="edge62" class="edge">
<title>qkv_proj_14&#45;&gt;v_slice_14</title>
<path fill="none" stroke="black" d="M7922.23,-2258.44C7922.23,-2258.44 7922.23,-2061.96 7922.23,-2061.96"/>
<polygon fill="black" stroke="black" points="7925.73,-2061.96 7922.23,-2051.96 7918.73,-2061.96 7925.73,-2061.96"/>
</g>
<!-- q_slice_15 -->
<g id="node64" class="node">
<title>q_slice_15</title>
<ellipse fill="lightcoral" stroke="black" cx="7731.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7731.58" y="-2145.35" font-family="Times,serif" font-size="14.00">Q Slice</text>
<text text-anchor="middle" x="7731.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7731.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_proj_15&#45;&gt;q_slice_15 -->
<g id="edge63" class="edge">
<title>qkv_proj_15&#45;&gt;q_slice_15</title>
<path fill="none" stroke="black" d="M7496.3,-2300C7591.67,-2300 7731.58,-2300 7731.58,-2300 7731.58,-2300 7731.58,-2181.71 7731.58,-2181.71"/>
<polygon fill="black" stroke="black" points="7735.08,-2181.71 7731.58,-2171.71 7728.08,-2181.71 7735.08,-2181.71"/>
</g>
<!-- k_slice_15 -->
<g id="node65" class="node">
<title>k_slice_15</title>
<ellipse fill="lightcoral" stroke="black" cx="7517.58" cy="-2134.05" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7517.58" y="-2145.35" font-family="Times,serif" font-size="14.00">K Slice</text>
<text text-anchor="middle" x="7517.58" y="-2130.35" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7517.58" y="-2115.35" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_proj_15&#45;&gt;k_slice_15 -->
<g id="edge64" class="edge">
<title>qkv_proj_15&#45;&gt;k_slice_15</title>
<path fill="none" stroke="black" d="M7467.94,-2258.15C7467.94,-2258.15 7467.94,-2173.11 7467.94,-2173.11"/>
<polygon fill="black" stroke="black" points="7471.44,-2173.11 7467.94,-2163.11 7464.44,-2173.11 7471.44,-2173.11"/>
</g>
<!-- v_slice_15 -->
<g id="node66" class="node">
<title>v_slice_15</title>
<ellipse fill="lightcoral" stroke="black" cx="7351.58" cy="-1802.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7351.58" y="-1813.45" font-family="Times,serif" font-size="14.00">V Slice</text>
<text text-anchor="middle" x="7351.58" y="-1798.45" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7351.58" y="-1783.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_proj_15&#45;&gt;v_slice_15 -->
<g id="edge65" class="edge">
<title>qkv_proj_15&#45;&gt;v_slice_15</title>
<path fill="none" stroke="black" d="M7376.23,-2258.44C7376.23,-2258.44 7376.23,-1847.85 7376.23,-1847.85"/>
<polygon fill="black" stroke="black" points="7379.73,-1847.85 7376.23,-1837.85 7372.73,-1847.85 7379.73,-1847.85"/>
</g>
<!-- attn_scores_0 -->
<g id="node67" class="node">
<title>attn_scores_0</title>
<polygon fill="lightpink" stroke="black" points="1684.58,-1935.62 1548.58,-1935.62 1548.58,-1882.62 1684.58,-1882.62 1684.58,-1935.62"/>
<text text-anchor="middle" x="1616.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1616.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="1616.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_slice_0&#45;&gt;attn_scores_0 -->
<g id="edge66" class="edge">
<title>q_slice_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M1568.98,-2108.69C1568.98,-2108.69 1568.98,-1945.79 1568.98,-1945.79"/>
<polygon fill="black" stroke="black" points="1572.48,-1945.79 1568.98,-1935.79 1565.48,-1945.79 1572.48,-1945.79"/>
</g>
<!-- k_slice_0&#45;&gt;attn_scores_0 -->
<g id="edge67" class="edge">
<title>k_slice_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M1666.19,-2109.55C1666.19,-2109.55 1666.19,-1945.68 1666.19,-1945.68"/>
<polygon fill="black" stroke="black" points="1669.69,-1945.68 1666.19,-1935.68 1662.69,-1945.68 1669.69,-1945.68"/>
</g>
<!-- context_0 -->
<g id="node69" class="node">
<title>context_0</title>
<polygon fill="lightpink" stroke="black" points="1671.58,-1581.67 1561.58,-1581.67 1561.58,-1528.67 1671.58,-1528.67 1671.58,-1581.67"/>
<text text-anchor="middle" x="1616.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1616.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1616.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- v_slice_0&#45;&gt;context_0 -->
<g id="edge70" class="edge">
<title>v_slice_0&#45;&gt;context_0</title>
<path fill="none" stroke="black" d="M1483.48,-1802C1524.38,-1802 1566.08,-1802 1566.08,-1802 1566.08,-1802 1566.08,-1592.06 1566.08,-1592.06"/>
<polygon fill="black" stroke="black" points="1569.58,-1592.06 1566.08,-1582.06 1562.58,-1592.06 1569.58,-1592.06"/>
</g>
<!-- attn_scores_1 -->
<g id="node70" class="node">
<title>attn_scores_1</title>
<polygon fill="lightpink" stroke="black" points="593.58,-1935.62 457.58,-1935.62 457.58,-1882.62 593.58,-1882.62 593.58,-1935.62"/>
<text text-anchor="middle" x="525.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="525.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="525.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_slice_1&#45;&gt;attn_scores_1 -->
<g id="edge71" class="edge">
<title>q_slice_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M574.69,-2109.55C574.69,-2109.55 574.69,-1945.68 574.69,-1945.68"/>
<polygon fill="black" stroke="black" points="578.19,-1945.68 574.69,-1935.68 571.19,-1945.68 578.19,-1945.68"/>
</g>
<!-- k_slice_1&#45;&gt;attn_scores_1 -->
<g id="edge72" class="edge">
<title>k_slice_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M477.48,-2108.69C477.48,-2108.69 477.48,-1945.79 477.48,-1945.79"/>
<polygon fill="black" stroke="black" points="480.98,-1945.79 477.48,-1935.79 473.98,-1945.79 480.98,-1945.79"/>
</g>
<!-- context_1 -->
<g id="node72" class="node">
<title>context_1</title>
<polygon fill="lightpink" stroke="black" points="580.58,-1581.67 470.58,-1581.67 470.58,-1528.67 580.58,-1528.67 580.58,-1581.67"/>
<text text-anchor="middle" x="525.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="525.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="525.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- v_slice_1&#45;&gt;context_1 -->
<g id="edge75" class="edge">
<title>v_slice_1&#45;&gt;context_1</title>
<path fill="none" stroke="black" d="M298.18,-1979.53C298.18,-1870.47 298.18,-1555 298.18,-1555 298.18,-1555 460.54,-1555 460.54,-1555"/>
<polygon fill="black" stroke="black" points="460.54,-1558.5 470.54,-1555 460.54,-1551.5 460.54,-1558.5"/>
</g>
<!-- attn_scores_2 -->
<g id="node73" class="node">
<title>attn_scores_2</title>
<polygon fill="lightpink" stroke="black" points="2269.58,-1935.62 2133.58,-1935.62 2133.58,-1882.62 2269.58,-1882.62 2269.58,-1935.62"/>
<text text-anchor="middle" x="2201.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2201.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="2201.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_slice_2&#45;&gt;attn_scores_2 -->
<g id="edge76" class="edge">
<title>q_slice_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M2135.63,-2134C2152.08,-2134 2164.58,-2134 2164.58,-2134 2164.58,-2134 2164.58,-1945.8 2164.58,-1945.8"/>
<polygon fill="black" stroke="black" points="2168.08,-1945.8 2164.58,-1935.8 2161.08,-1945.8 2168.08,-1945.8"/>
</g>
<!-- k_slice_2&#45;&gt;attn_scores_2 -->
<g id="edge77" class="edge">
<title>k_slice_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M2231.69,-2101.83C2231.69,-2101.83 2231.69,-1945.67 2231.69,-1945.67"/>
<polygon fill="black" stroke="black" points="2235.19,-1945.67 2231.69,-1935.67 2228.19,-1945.67 2235.19,-1945.67"/>
</g>
<!-- context_2 -->
<g id="node75" class="node">
<title>context_2</title>
<polygon fill="lightpink" stroke="black" points="2256.58,-1581.67 2146.58,-1581.67 2146.58,-1528.67 2256.58,-1528.67 2256.58,-1581.67"/>
<text text-anchor="middle" x="2201.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2201.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2201.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- v_slice_2&#45;&gt;context_2 -->
<g id="edge80" class="edge">
<title>v_slice_2&#45;&gt;context_2</title>
<path fill="none" stroke="black" d="M2005.94,-1786.15C2005.94,-1732.76 2005.94,-1564 2005.94,-1564 2005.94,-1564 2136.57,-1564 2136.57,-1564"/>
<polygon fill="black" stroke="black" points="2136.57,-1567.5 2146.57,-1564 2136.57,-1560.5 2136.57,-1567.5"/>
</g>
<!-- attn_scores_3 -->
<g id="node76" class="node">
<title>attn_scores_3</title>
<polygon fill="lightpink" stroke="black" points="1163.58,-1935.62 1027.58,-1935.62 1027.58,-1882.62 1163.58,-1882.62 1163.58,-1935.62"/>
<text text-anchor="middle" x="1095.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1095.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="1095.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_slice_3&#45;&gt;attn_scores_3 -->
<g id="edge81" class="edge">
<title>q_slice_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M1132.69,-2103.72C1132.69,-2103.72 1132.69,-1945.83 1132.69,-1945.83"/>
<polygon fill="black" stroke="black" points="1136.19,-1945.83 1132.69,-1935.83 1129.19,-1945.83 1136.19,-1945.83"/>
</g>
<!-- k_slice_3&#45;&gt;attn_scores_3 -->
<g id="edge82" class="edge">
<title>k_slice_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M1035.48,-2117.51C1035.48,-2117.51 1035.48,-1945.85 1035.48,-1945.85"/>
<polygon fill="black" stroke="black" points="1038.98,-1945.85 1035.48,-1935.85 1031.98,-1945.85 1038.98,-1945.85"/>
</g>
<!-- context_3 -->
<g id="node78" class="node">
<title>context_3</title>
<polygon fill="lightpink" stroke="black" points="1150.58,-1581.67 1040.58,-1581.67 1040.58,-1528.67 1150.58,-1528.67 1150.58,-1581.67"/>
<text text-anchor="middle" x="1095.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1095.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="1095.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- v_slice_3&#45;&gt;context_3 -->
<g id="edge85" class="edge">
<title>v_slice_3&#45;&gt;context_3</title>
<path fill="none" stroke="black" d="M813.58,-1978.37C813.58,-1868.24 813.58,-1555 813.58,-1555 813.58,-1555 1030.54,-1555 1030.54,-1555"/>
<polygon fill="black" stroke="black" points="1030.54,-1558.5 1040.54,-1555 1030.54,-1551.5 1030.54,-1558.5"/>
</g>
<!-- attn_scores_4 -->
<g id="node79" class="node">
<title>attn_scores_4</title>
<polygon fill="lightpink" stroke="black" points="2808.58,-1935.62 2672.58,-1935.62 2672.58,-1882.62 2808.58,-1882.62 2808.58,-1935.62"/>
<text text-anchor="middle" x="2740.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2740.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="2740.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_slice_4&#45;&gt;attn_scores_4 -->
<g id="edge86" class="edge">
<title>q_slice_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M2774.19,-2102.78C2774.19,-2102.78 2774.19,-1945.92 2774.19,-1945.92"/>
<polygon fill="black" stroke="black" points="2777.69,-1945.92 2774.19,-1935.92 2770.69,-1945.92 2777.69,-1945.92"/>
</g>
<!-- k_slice_4&#45;&gt;attn_scores_4 -->
<g id="edge87" class="edge">
<title>k_slice_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M2676.98,-2121.64C2676.98,-2121.64 2676.98,-1945.7 2676.98,-1945.7"/>
<polygon fill="black" stroke="black" points="2680.48,-1945.7 2676.98,-1935.7 2673.48,-1945.7 2680.48,-1945.7"/>
</g>
<!-- context_4 -->
<g id="node81" class="node">
<title>context_4</title>
<polygon fill="lightpink" stroke="black" points="2795.58,-1581.67 2685.58,-1581.67 2685.58,-1528.67 2795.58,-1528.67 2795.58,-1581.67"/>
<text text-anchor="middle" x="2740.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2740.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="2740.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- v_slice_4&#45;&gt;context_4 -->
<g id="edge90" class="edge">
<title>v_slice_4&#45;&gt;context_4</title>
<path fill="none" stroke="black" d="M2552.23,-2000.23C2552.23,-1919.15 2552.23,-1555 2552.23,-1555 2552.23,-1555 2675.34,-1555 2675.34,-1555"/>
<polygon fill="black" stroke="black" points="2675.34,-1558.5 2685.34,-1555 2675.34,-1551.5 2675.34,-1558.5"/>
</g>
<!-- attn_scores_5 -->
<g id="node82" class="node">
<title>attn_scores_5</title>
<polygon fill="lightpink" stroke="black" points="4309.58,-1935.62 4173.58,-1935.62 4173.58,-1882.62 4309.58,-1882.62 4309.58,-1935.62"/>
<text text-anchor="middle" x="4241.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4241.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="4241.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_slice_5&#45;&gt;attn_scores_5 -->
<g id="edge91" class="edge">
<title>q_slice_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M4431.94,-2097.9C4431.94,-2034.28 4431.94,-1909 4431.94,-1909 4431.94,-1909 4319.77,-1909 4319.77,-1909"/>
<polygon fill="black" stroke="black" points="4319.77,-1905.5 4309.77,-1909 4319.77,-1912.5 4319.77,-1905.5"/>
</g>
<!-- k_slice_5&#45;&gt;attn_scores_5 -->
<g id="edge92" class="edge">
<title>k_slice_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M4241.58,-2096.41C4241.58,-2096.41 4241.58,-1945.94 4241.58,-1945.94"/>
<polygon fill="black" stroke="black" points="4245.08,-1945.94 4241.58,-1935.94 4238.08,-1945.94 4245.08,-1945.94"/>
</g>
<!-- context_5 -->
<g id="node84" class="node">
<title>context_5</title>
<polygon fill="lightpink" stroke="black" points="4172.58,-1581.67 4062.58,-1581.67 4062.58,-1528.67 4172.58,-1528.67 4172.58,-1581.67"/>
<text text-anchor="middle" x="4117.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="4117.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4117.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- v_slice_5&#45;&gt;context_5 -->
<g id="edge95" class="edge">
<title>v_slice_5&#45;&gt;context_5</title>
<path fill="none" stroke="black" d="M4108.98,-1767.81C4108.98,-1767.81 4108.98,-1592.02 4108.98,-1592.02"/>
<polygon fill="black" stroke="black" points="4112.48,-1592.02 4108.98,-1582.02 4105.48,-1592.02 4112.48,-1592.02"/>
</g>
<!-- attn_scores_6 -->
<g id="node85" class="node">
<title>attn_scores_6</title>
<polygon fill="lightpink" stroke="black" points="3854.58,-1935.62 3718.58,-1935.62 3718.58,-1882.62 3854.58,-1882.62 3854.58,-1935.62"/>
<text text-anchor="middle" x="3786.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3786.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="3786.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_slice_6&#45;&gt;attn_scores_6 -->
<g id="edge96" class="edge">
<title>q_slice_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M3745.98,-2105.11C3745.98,-2105.11 3745.98,-1945.86 3745.98,-1945.86"/>
<polygon fill="black" stroke="black" points="3749.48,-1945.86 3745.98,-1935.86 3742.48,-1945.86 3749.48,-1945.86"/>
</g>
<!-- k_slice_6&#45;&gt;attn_scores_6 -->
<g id="edge97" class="edge">
<title>k_slice_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M3843.19,-2114.49C3843.19,-2114.49 3843.19,-1945.66 3843.19,-1945.66"/>
<polygon fill="black" stroke="black" points="3846.69,-1945.66 3843.19,-1935.66 3839.69,-1945.66 3846.69,-1945.66"/>
</g>
<!-- context_6 -->
<g id="node87" class="node">
<title>context_6</title>
<polygon fill="lightpink" stroke="black" points="3841.58,-1581.67 3731.58,-1581.67 3731.58,-1528.67 3841.58,-1528.67 3841.58,-1581.67"/>
<text text-anchor="middle" x="3786.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="3786.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3786.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- v_slice_6&#45;&gt;context_6 -->
<g id="edge100" class="edge">
<title>v_slice_6&#45;&gt;context_6</title>
<path fill="none" stroke="black" d="M3566.51,-1980.63C3566.51,-1874.05 3566.51,-1564 3566.51,-1564 3566.51,-1564 3721.33,-1564 3721.33,-1564"/>
<polygon fill="black" stroke="black" points="3721.33,-1567.5 3731.33,-1564 3721.33,-1560.5 3721.33,-1567.5"/>
</g>
<!-- attn_scores_7 -->
<g id="node88" class="node">
<title>attn_scores_7</title>
<polygon fill="lightpink" stroke="black" points="3334.58,-1935.62 3198.58,-1935.62 3198.58,-1882.62 3334.58,-1882.62 3334.58,-1935.62"/>
<text text-anchor="middle" x="3266.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3266.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="3266.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_slice_7&#45;&gt;attn_scores_7 -->
<g id="edge101" class="edge">
<title>q_slice_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M3310.19,-2106.47C3310.19,-2106.47 3310.19,-1945.88 3310.19,-1945.88"/>
<polygon fill="black" stroke="black" points="3313.69,-1945.88 3310.19,-1935.88 3306.69,-1945.88 3313.69,-1945.88"/>
</g>
<!-- k_slice_7&#45;&gt;attn_scores_7 -->
<g id="edge102" class="edge">
<title>k_slice_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M3212.98,-2112.08C3212.98,-2112.08 3212.98,-1945.68 3212.98,-1945.68"/>
<polygon fill="black" stroke="black" points="3216.48,-1945.68 3212.98,-1935.68 3209.48,-1945.68 3216.48,-1945.68"/>
</g>
<!-- context_7 -->
<g id="node90" class="node">
<title>context_7</title>
<polygon fill="lightpink" stroke="black" points="3321.58,-1581.67 3211.58,-1581.67 3211.58,-1528.67 3321.58,-1528.67 3321.58,-1581.67"/>
<text text-anchor="middle" x="3266.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="3266.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="3266.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- v_slice_7&#45;&gt;context_7 -->
<g id="edge105" class="edge">
<title>v_slice_7&#45;&gt;context_7</title>
<path fill="none" stroke="black" d="M3074.59,-1802C3137.68,-1802 3216.08,-1802 3216.08,-1802 3216.08,-1802 3216.08,-1592.06 3216.08,-1592.06"/>
<polygon fill="black" stroke="black" points="3219.58,-1592.06 3216.08,-1582.06 3212.58,-1592.06 3219.58,-1592.06"/>
</g>
<!-- attn_scores_8 -->
<g id="node91" class="node">
<title>attn_scores_8</title>
<polygon fill="lightpink" stroke="black" points="4855.58,-1935.62 4719.58,-1935.62 4719.58,-1882.62 4855.58,-1882.62 4855.58,-1935.62"/>
<text text-anchor="middle" x="4787.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4787.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="4787.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_slice_8&#45;&gt;attn_scores_8 -->
<g id="edge106" class="edge">
<title>q_slice_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M4933.32,-2116.02C4933.32,-2062.61 4933.32,-1909 4933.32,-1909 4933.32,-1909 4865.76,-1909 4865.76,-1909"/>
<polygon fill="black" stroke="black" points="4865.76,-1905.5 4855.76,-1909 4865.76,-1912.5 4865.76,-1905.5"/>
</g>
<!-- k_slice_8&#45;&gt;attn_scores_8 -->
<g id="edge107" class="edge">
<title>k_slice_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M4787.58,-2096.41C4787.58,-2096.41 4787.58,-1945.94 4787.58,-1945.94"/>
<polygon fill="black" stroke="black" points="4791.08,-1945.94 4787.58,-1935.94 4784.08,-1945.94 4791.08,-1945.94"/>
</g>
<!-- context_8 -->
<g id="node93" class="node">
<title>context_8</title>
<polygon fill="lightpink" stroke="black" points="4676.58,-1581.67 4566.58,-1581.67 4566.58,-1528.67 4676.58,-1528.67 4676.58,-1581.67"/>
<text text-anchor="middle" x="4621.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="4621.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="4621.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- v_slice_8&#45;&gt;context_8 -->
<g id="edge110" class="edge">
<title>v_slice_8&#45;&gt;context_8</title>
<path fill="none" stroke="black" d="M4621.58,-1978.38C4621.58,-1978.38 4621.58,-1591.95 4621.58,-1591.95"/>
<polygon fill="black" stroke="black" points="4625.08,-1591.95 4621.58,-1581.95 4618.08,-1591.95 4625.08,-1591.95"/>
</g>
<!-- attn_scores_9 -->
<g id="node94" class="node">
<title>attn_scores_9</title>
<polygon fill="lightpink" stroke="black" points="6493.58,-1935.62 6357.58,-1935.62 6357.58,-1882.62 6493.58,-1882.62 6493.58,-1935.62"/>
<text text-anchor="middle" x="6425.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6425.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="6425.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_slice_9&#45;&gt;attn_scores_9 -->
<g id="edge111" class="edge">
<title>q_slice_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M6604.44,-2100.36C6604.44,-2037.58 6604.44,-1909 6604.44,-1909 6604.44,-1909 6503.71,-1909 6503.71,-1909"/>
<polygon fill="black" stroke="black" points="6503.71,-1905.5 6493.71,-1909 6503.71,-1912.5 6503.71,-1905.5"/>
</g>
<!-- k_slice_9&#45;&gt;attn_scores_9 -->
<g id="edge112" class="edge">
<title>k_slice_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M6425.58,-2096.41C6425.58,-2096.41 6425.58,-1945.94 6425.58,-1945.94"/>
<polygon fill="black" stroke="black" points="6429.08,-1945.94 6425.58,-1935.94 6422.08,-1945.94 6429.08,-1945.94"/>
</g>
<!-- context_9 -->
<g id="node96" class="node">
<title>context_9</title>
<polygon fill="lightpink" stroke="black" points="6314.58,-1581.67 6204.58,-1581.67 6204.58,-1528.67 6314.58,-1528.67 6314.58,-1581.67"/>
<text text-anchor="middle" x="6259.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="6259.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6259.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- v_slice_9&#45;&gt;context_9 -->
<g id="edge115" class="edge">
<title>v_slice_9&#45;&gt;context_9</title>
<path fill="none" stroke="black" d="M6259.58,-1764.64C6259.58,-1764.64 6259.58,-1591.97 6259.58,-1591.97"/>
<polygon fill="black" stroke="black" points="6263.08,-1591.97 6259.58,-1581.97 6256.08,-1591.97 6263.08,-1591.97"/>
</g>
<!-- attn_scores_10 -->
<g id="node97" class="node">
<title>attn_scores_10</title>
<polygon fill="lightpink" stroke="black" points="5947.58,-1935.62 5811.58,-1935.62 5811.58,-1882.62 5947.58,-1882.62 5947.58,-1935.62"/>
<text text-anchor="middle" x="5879.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5879.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="5879.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_slice_10&#45;&gt;attn_scores_10 -->
<g id="edge116" class="edge">
<title>q_slice_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M5879.58,-2096.41C5879.58,-2096.41 5879.58,-1945.94 5879.58,-1945.94"/>
<polygon fill="black" stroke="black" points="5883.08,-1945.94 5879.58,-1935.94 5876.08,-1945.94 5883.08,-1945.94"/>
</g>
<!-- k_slice_10&#45;&gt;attn_scores_10 -->
<g id="edge117" class="edge">
<title>k_slice_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M6096.66,-2096.39C6096.66,-2032.32 6096.66,-1909 6096.66,-1909 6096.66,-1909 5957.67,-1909 5957.67,-1909"/>
<polygon fill="black" stroke="black" points="5957.67,-1905.5 5947.67,-1909 5957.67,-1912.5 5957.67,-1905.5"/>
</g>
<!-- context_10 -->
<g id="node99" class="node">
<title>context_10</title>
<polygon fill="lightpink" stroke="black" points="5768.58,-1581.67 5658.58,-1581.67 5658.58,-1528.67 5768.58,-1528.67 5768.58,-1581.67"/>
<text text-anchor="middle" x="5713.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="5713.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5713.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- v_slice_10&#45;&gt;context_10 -->
<g id="edge120" class="edge">
<title>v_slice_10&#45;&gt;context_10</title>
<path fill="none" stroke="black" d="M5713.58,-1978.38C5713.58,-1978.38 5713.58,-1591.95 5713.58,-1591.95"/>
<polygon fill="black" stroke="black" points="5717.08,-1591.95 5713.58,-1581.95 5710.08,-1591.95 5717.08,-1591.95"/>
</g>
<!-- attn_scores_11 -->
<g id="node100" class="node">
<title>attn_scores_11</title>
<polygon fill="lightpink" stroke="black" points="5401.58,-1935.62 5265.58,-1935.62 5265.58,-1882.62 5401.58,-1882.62 5401.58,-1935.62"/>
<text text-anchor="middle" x="5333.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5333.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="5333.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_slice_11&#45;&gt;attn_scores_11 -->
<g id="edge121" class="edge">
<title>q_slice_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M5491.94,-2107.8C5491.94,-2048.43 5491.94,-1909 5491.94,-1909 5491.94,-1909 5411.66,-1909 5411.66,-1909"/>
<polygon fill="black" stroke="black" points="5411.66,-1905.5 5401.66,-1909 5411.66,-1912.5 5411.66,-1905.5"/>
</g>
<!-- k_slice_11&#45;&gt;attn_scores_11 -->
<g id="edge122" class="edge">
<title>k_slice_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M5333.58,-2096.41C5333.58,-2096.41 5333.58,-1945.94 5333.58,-1945.94"/>
<polygon fill="black" stroke="black" points="5337.08,-1945.94 5333.58,-1935.94 5330.08,-1945.94 5337.08,-1945.94"/>
</g>
<!-- context_11 -->
<g id="node102" class="node">
<title>context_11</title>
<polygon fill="lightpink" stroke="black" points="5222.58,-1581.67 5112.58,-1581.67 5112.58,-1528.67 5222.58,-1528.67 5222.58,-1581.67"/>
<text text-anchor="middle" x="5167.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="5167.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="5167.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- v_slice_11&#45;&gt;context_11 -->
<g id="edge125" class="edge">
<title>v_slice_11&#45;&gt;context_11</title>
<path fill="none" stroke="black" d="M5167.58,-1764.64C5167.58,-1764.64 5167.58,-1591.97 5167.58,-1591.97"/>
<polygon fill="black" stroke="black" points="5171.08,-1591.97 5167.58,-1581.97 5164.08,-1591.97 5171.08,-1591.97"/>
</g>
<!-- attn_scores_12 -->
<g id="node103" class="node">
<title>attn_scores_12</title>
<polygon fill="lightpink" stroke="black" points="7039.58,-1935.62 6903.58,-1935.62 6903.58,-1882.62 7039.58,-1882.62 7039.58,-1935.62"/>
<text text-anchor="middle" x="6971.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6971.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="6971.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_slice_12&#45;&gt;attn_scores_12 -->
<g id="edge126" class="edge">
<title>q_slice_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M7185.58,-2096.39C7185.58,-2032.32 7185.58,-1909 7185.58,-1909 7185.58,-1909 7049.59,-1909 7049.59,-1909"/>
<polygon fill="black" stroke="black" points="7049.59,-1905.5 7039.59,-1909 7049.59,-1912.5 7049.59,-1905.5"/>
</g>
<!-- k_slice_12&#45;&gt;attn_scores_12 -->
<g id="edge127" class="edge">
<title>k_slice_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M6971.58,-2096.41C6971.58,-2096.41 6971.58,-1945.94 6971.58,-1945.94"/>
<polygon fill="black" stroke="black" points="6975.08,-1945.94 6971.58,-1935.94 6968.08,-1945.94 6975.08,-1945.94"/>
</g>
<!-- context_12 -->
<g id="node105" class="node">
<title>context_12</title>
<polygon fill="lightpink" stroke="black" points="6860.58,-1581.67 6750.58,-1581.67 6750.58,-1528.67 6860.58,-1528.67 6860.58,-1581.67"/>
<text text-anchor="middle" x="6805.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="6805.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="6805.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- v_slice_12&#45;&gt;context_12 -->
<g id="edge130" class="edge">
<title>v_slice_12&#45;&gt;context_12</title>
<path fill="none" stroke="black" d="M6805.58,-1978.38C6805.58,-1978.38 6805.58,-1591.95 6805.58,-1591.95"/>
<polygon fill="black" stroke="black" points="6809.08,-1591.95 6805.58,-1581.95 6802.08,-1591.95 6809.08,-1591.95"/>
</g>
<!-- attn_scores_13 -->
<g id="node106" class="node">
<title>attn_scores_13</title>
<polygon fill="lightpink" stroke="black" points="8677.58,-1935.62 8541.58,-1935.62 8541.58,-1882.62 8677.58,-1882.62 8677.58,-1935.62"/>
<text text-anchor="middle" x="8609.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8609.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="8609.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_slice_13&#45;&gt;attn_scores_13 -->
<g id="edge131" class="edge">
<title>q_slice_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M8823.58,-2096.39C8823.58,-2032.32 8823.58,-1909 8823.58,-1909 8823.58,-1909 8687.59,-1909 8687.59,-1909"/>
<polygon fill="black" stroke="black" points="8687.59,-1905.5 8677.59,-1909 8687.59,-1912.5 8687.59,-1905.5"/>
</g>
<!-- k_slice_13&#45;&gt;attn_scores_13 -->
<g id="edge132" class="edge">
<title>k_slice_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M8609.58,-2096.41C8609.58,-2096.41 8609.58,-1945.94 8609.58,-1945.94"/>
<polygon fill="black" stroke="black" points="8613.08,-1945.94 8609.58,-1935.94 8606.08,-1945.94 8613.08,-1945.94"/>
</g>
<!-- context_13 -->
<g id="node108" class="node">
<title>context_13</title>
<polygon fill="lightpink" stroke="black" points="8498.58,-1581.67 8388.58,-1581.67 8388.58,-1528.67 8498.58,-1528.67 8498.58,-1581.67"/>
<text text-anchor="middle" x="8443.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="8443.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="8443.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- v_slice_13&#45;&gt;context_13 -->
<g id="edge135" class="edge">
<title>v_slice_13&#45;&gt;context_13</title>
<path fill="none" stroke="black" d="M8443.58,-1764.64C8443.58,-1764.64 8443.58,-1591.97 8443.58,-1591.97"/>
<polygon fill="black" stroke="black" points="8447.08,-1591.97 8443.58,-1581.97 8440.08,-1591.97 8447.08,-1591.97"/>
</g>
<!-- attn_scores_14 -->
<g id="node109" class="node">
<title>attn_scores_14</title>
<polygon fill="lightpink" stroke="black" points="8131.58,-1935.62 7995.58,-1935.62 7995.58,-1882.62 8131.58,-1882.62 8131.58,-1935.62"/>
<text text-anchor="middle" x="8063.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8063.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="8063.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_slice_14&#45;&gt;attn_scores_14 -->
<g id="edge136" class="edge">
<title>q_slice_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M8063.58,-2096.41C8063.58,-2096.41 8063.58,-1945.94 8063.58,-1945.94"/>
<polygon fill="black" stroke="black" points="8067.08,-1945.94 8063.58,-1935.94 8060.08,-1945.94 8067.08,-1945.94"/>
</g>
<!-- k_slice_14&#45;&gt;attn_scores_14 -->
<g id="edge137" class="edge">
<title>k_slice_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M8277.58,-2096.39C8277.58,-2032.32 8277.58,-1909 8277.58,-1909 8277.58,-1909 8141.59,-1909 8141.59,-1909"/>
<polygon fill="black" stroke="black" points="8141.59,-1905.5 8131.59,-1909 8141.59,-1912.5 8141.59,-1905.5"/>
</g>
<!-- context_14 -->
<g id="node111" class="node">
<title>context_14</title>
<polygon fill="lightpink" stroke="black" points="7952.58,-1581.67 7842.58,-1581.67 7842.58,-1528.67 7952.58,-1528.67 7952.58,-1581.67"/>
<text text-anchor="middle" x="7897.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="7897.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7897.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- v_slice_14&#45;&gt;context_14 -->
<g id="edge140" class="edge">
<title>v_slice_14&#45;&gt;context_14</title>
<path fill="none" stroke="black" d="M7897.58,-1978.38C7897.58,-1978.38 7897.58,-1591.95 7897.58,-1591.95"/>
<polygon fill="black" stroke="black" points="7901.08,-1591.95 7897.58,-1581.95 7894.08,-1591.95 7901.08,-1591.95"/>
</g>
<!-- attn_scores_15 -->
<g id="node112" class="node">
<title>attn_scores_15</title>
<polygon fill="lightpink" stroke="black" points="7585.58,-1935.62 7449.58,-1935.62 7449.58,-1882.62 7585.58,-1882.62 7585.58,-1935.62"/>
<text text-anchor="middle" x="7517.58" y="-1920.42" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7517.58" y="-1905.42" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="7517.58" y="-1890.42" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_slice_15&#45;&gt;attn_scores_15 -->
<g id="edge141" class="edge">
<title>q_slice_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M7731.58,-2096.39C7731.58,-2032.32 7731.58,-1909 7731.58,-1909 7731.58,-1909 7595.59,-1909 7595.59,-1909"/>
<polygon fill="black" stroke="black" points="7595.59,-1905.5 7585.59,-1909 7595.59,-1912.5 7595.59,-1905.5"/>
</g>
<!-- k_slice_15&#45;&gt;attn_scores_15 -->
<g id="edge142" class="edge">
<title>k_slice_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M7517.58,-2096.41C7517.58,-2096.41 7517.58,-1945.94 7517.58,-1945.94"/>
<polygon fill="black" stroke="black" points="7521.08,-1945.94 7517.58,-1935.94 7514.08,-1945.94 7521.08,-1945.94"/>
</g>
<!-- context_15 -->
<g id="node114" class="node">
<title>context_15</title>
<polygon fill="lightpink" stroke="black" points="7406.58,-1581.67 7296.58,-1581.67 7296.58,-1528.67 7406.58,-1528.67 7406.58,-1581.67"/>
<text text-anchor="middle" x="7351.58" y="-1566.47" font-family="Times,serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="7351.58" y="-1551.47" font-family="Times,serif" font-size="14.00">[B, L, 4, 128]</text>
<text text-anchor="middle" x="7351.58" y="-1536.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- v_slice_15&#45;&gt;context_15 -->
<g id="edge145" class="edge">
<title>v_slice_15&#45;&gt;context_15</title>
<path fill="none" stroke="black" d="M7351.58,-1764.64C7351.58,-1764.64 7351.58,-1591.97 7351.58,-1591.97"/>
<polygon fill="black" stroke="black" points="7355.08,-1591.97 7351.58,-1581.97 7348.08,-1591.97 7355.08,-1591.97"/>
</g>
<!-- attn_weights_0 -->
<g id="node68" class="node">
<title>attn_weights_0</title>
<polygon fill="lightpink" stroke="black" points="1662.58,-1721.67 1570.58,-1721.67 1570.58,-1668.67 1662.58,-1668.67 1662.58,-1721.67"/>
<text text-anchor="middle" x="1616.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1616.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="1616.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- attn_scores_0&#45;&gt;attn_weights_0 -->
<g id="edge68" class="edge">
<title>attn_scores_0&#45;&gt;attn_weights_0</title>
<path fill="none" stroke="black" d="M1616.58,-1882.46C1616.58,-1882.46 1616.58,-1731.84 1616.58,-1731.84"/>
<polygon fill="black" stroke="black" points="1620.08,-1731.84 1616.58,-1721.84 1613.08,-1731.84 1620.08,-1731.84"/>
</g>
<!-- attn_weights_0&#45;&gt;context_0 -->
<g id="edge69" class="edge">
<title>attn_weights_0&#45;&gt;context_0</title>
<path fill="none" stroke="black" d="M1616.58,-1668.51C1616.58,-1668.51 1616.58,-1591.73 1616.58,-1591.73"/>
<polygon fill="black" stroke="black" points="1620.08,-1591.73 1616.58,-1581.73 1613.08,-1591.73 1620.08,-1591.73"/>
</g>
<!-- concat_dim_0_0 -->
<g id="node115" class="node">
<title>concat_dim_0_0</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="2188.08,-1441.67 1991.08,-1441.67 1991.08,-1373.67 2188.08,-1373.67 2188.08,-1441.67"/>
<text text-anchor="middle" x="2089.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="2089.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2089.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2089.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 0</text>
</g>
<!-- context_0&#45;&gt;concat_dim_0_0 -->
<g id="edge146" class="edge">
<title>context_0&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" d="M1671.71,-1546C1777.48,-1546 1998.51,-1546 1998.51,-1546 1998.51,-1546 1998.51,-1451.86 1998.51,-1451.86"/>
<polygon fill="black" stroke="black" points="2002.01,-1451.86 1998.51,-1441.86 1995.01,-1451.86 2002.01,-1451.86"/>
</g>
<!-- attn_weights_1 -->
<g id="node71" class="node">
<title>attn_weights_1</title>
<polygon fill="lightpink" stroke="black" points="571.58,-1721.67 479.58,-1721.67 479.58,-1668.67 571.58,-1668.67 571.58,-1721.67"/>
<text text-anchor="middle" x="525.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="525.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="525.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- attn_scores_1&#45;&gt;attn_weights_1 -->
<g id="edge73" class="edge">
<title>attn_scores_1&#45;&gt;attn_weights_1</title>
<path fill="none" stroke="black" d="M525.58,-1882.46C525.58,-1882.46 525.58,-1731.84 525.58,-1731.84"/>
<polygon fill="black" stroke="black" points="529.08,-1731.84 525.58,-1721.84 522.08,-1731.84 529.08,-1731.84"/>
</g>
<!-- attn_weights_1&#45;&gt;context_1 -->
<g id="edge74" class="edge">
<title>attn_weights_1&#45;&gt;context_1</title>
<path fill="none" stroke="black" d="M525.58,-1668.51C525.58,-1668.51 525.58,-1591.73 525.58,-1591.73"/>
<polygon fill="black" stroke="black" points="529.08,-1591.73 525.58,-1581.73 522.08,-1591.73 529.08,-1591.73"/>
</g>
<!-- concat_dim_0_1 -->
<g id="node116" class="node">
<title>concat_dim_0_1</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="1678.08,-1441.67 1481.08,-1441.67 1481.08,-1373.67 1678.08,-1373.67 1678.08,-1441.67"/>
<text text-anchor="middle" x="1579.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="1579.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1579.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1579.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 0</text>
</g>
<!-- context_1&#45;&gt;concat_dim_0_1 -->
<g id="edge147" class="edge">
<title>context_1&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" d="M566.33,-1528.34C566.33,-1485.64 566.33,-1407 566.33,-1407 566.33,-1407 1471.05,-1407 1471.05,-1407"/>
<polygon fill="black" stroke="black" points="1471.05,-1410.5 1481.05,-1407 1471.05,-1403.5 1471.05,-1410.5"/>
</g>
<!-- attn_weights_2 -->
<g id="node74" class="node">
<title>attn_weights_2</title>
<polygon fill="lightpink" stroke="black" points="2247.58,-1721.67 2155.58,-1721.67 2155.58,-1668.67 2247.58,-1668.67 2247.58,-1721.67"/>
<text text-anchor="middle" x="2201.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2201.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="2201.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- attn_scores_2&#45;&gt;attn_weights_2 -->
<g id="edge78" class="edge">
<title>attn_scores_2&#45;&gt;attn_weights_2</title>
<path fill="none" stroke="black" d="M2201.58,-1882.46C2201.58,-1882.46 2201.58,-1731.84 2201.58,-1731.84"/>
<polygon fill="black" stroke="black" points="2205.08,-1731.84 2201.58,-1721.84 2198.08,-1731.84 2205.08,-1731.84"/>
</g>
<!-- attn_weights_2&#45;&gt;context_2 -->
<g id="edge79" class="edge">
<title>attn_weights_2&#45;&gt;context_2</title>
<path fill="none" stroke="black" d="M2201.58,-1668.51C2201.58,-1668.51 2201.58,-1591.73 2201.58,-1591.73"/>
<polygon fill="black" stroke="black" points="2205.08,-1591.73 2201.58,-1581.73 2198.08,-1591.73 2205.08,-1591.73"/>
</g>
<!-- concat_dim_0_2 -->
<g id="node117" class="node">
<title>concat_dim_0_2</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="2443.08,-1441.67 2246.08,-1441.67 2246.08,-1373.67 2443.08,-1373.67 2443.08,-1441.67"/>
<text text-anchor="middle" x="2344.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="2344.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2344.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2344.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 0</text>
</g>
<!-- context_2&#45;&gt;concat_dim_0_2 -->
<g id="edge148" class="edge">
<title>context_2&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" d="M2251.33,-1528.46C2251.33,-1528.46 2251.33,-1451.71 2251.33,-1451.71"/>
<polygon fill="black" stroke="black" points="2254.83,-1451.71 2251.33,-1441.71 2247.83,-1451.71 2254.83,-1451.71"/>
</g>
<!-- attn_weights_3 -->
<g id="node77" class="node">
<title>attn_weights_3</title>
<polygon fill="lightpink" stroke="black" points="1141.58,-1721.67 1049.58,-1721.67 1049.58,-1668.67 1141.58,-1668.67 1141.58,-1721.67"/>
<text text-anchor="middle" x="1095.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1095.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="1095.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- attn_scores_3&#45;&gt;attn_weights_3 -->
<g id="edge83" class="edge">
<title>attn_scores_3&#45;&gt;attn_weights_3</title>
<path fill="none" stroke="black" d="M1095.58,-1882.46C1095.58,-1882.46 1095.58,-1731.84 1095.58,-1731.84"/>
<polygon fill="black" stroke="black" points="1099.08,-1731.84 1095.58,-1721.84 1092.08,-1731.84 1099.08,-1731.84"/>
</g>
<!-- attn_weights_3&#45;&gt;context_3 -->
<g id="edge84" class="edge">
<title>attn_weights_3&#45;&gt;context_3</title>
<path fill="none" stroke="black" d="M1095.58,-1668.51C1095.58,-1668.51 1095.58,-1591.73 1095.58,-1591.73"/>
<polygon fill="black" stroke="black" points="1099.08,-1591.73 1095.58,-1581.73 1092.08,-1591.73 1099.08,-1591.73"/>
</g>
<!-- concat_dim_0_3 -->
<g id="node118" class="node">
<title>concat_dim_0_3</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="1933.08,-1441.67 1736.08,-1441.67 1736.08,-1373.67 1933.08,-1373.67 1933.08,-1441.67"/>
<text text-anchor="middle" x="1834.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="1834.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1834.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1834.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 0</text>
</g>
<!-- context_3&#45;&gt;concat_dim_0_3 -->
<g id="edge149" class="edge">
<title>context_3&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" d="M1095.58,-1528.39C1095.58,-1521.51 1095.58,-1516 1095.58,-1516 1095.58,-1516 1769.73,-1516 1769.73,-1516 1769.73,-1516 1769.73,-1451.95 1769.73,-1451.95"/>
<polygon fill="black" stroke="black" points="1773.23,-1451.95 1769.73,-1441.95 1766.23,-1451.95 1773.23,-1451.95"/>
</g>
<!-- attn_weights_4 -->
<g id="node80" class="node">
<title>attn_weights_4</title>
<polygon fill="lightpink" stroke="black" points="2786.58,-1721.67 2694.58,-1721.67 2694.58,-1668.67 2786.58,-1668.67 2786.58,-1721.67"/>
<text text-anchor="middle" x="2740.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2740.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="2740.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- attn_scores_4&#45;&gt;attn_weights_4 -->
<g id="edge88" class="edge">
<title>attn_scores_4&#45;&gt;attn_weights_4</title>
<path fill="none" stroke="black" d="M2740.58,-1882.46C2740.58,-1882.46 2740.58,-1731.84 2740.58,-1731.84"/>
<polygon fill="black" stroke="black" points="2744.08,-1731.84 2740.58,-1721.84 2737.08,-1731.84 2744.08,-1731.84"/>
</g>
<!-- attn_weights_4&#45;&gt;context_4 -->
<g id="edge89" class="edge">
<title>attn_weights_4&#45;&gt;context_4</title>
<path fill="none" stroke="black" d="M2740.58,-1668.51C2740.58,-1668.51 2740.58,-1591.73 2740.58,-1591.73"/>
<polygon fill="black" stroke="black" points="2744.08,-1591.73 2740.58,-1581.73 2737.08,-1591.73 2744.08,-1591.73"/>
</g>
<!-- concat_dim_1_0 -->
<g id="node119" class="node">
<title>concat_dim_1_0</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3402.08,-1441.67 3205.08,-1441.67 3205.08,-1373.67 3402.08,-1373.67 3402.08,-1441.67"/>
<text text-anchor="middle" x="3303.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="3303.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3303.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="3303.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 1</text>
</g>
<!-- context_4&#45;&gt;concat_dim_1_0 -->
<g id="edge150" class="edge">
<title>context_4&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" d="M2740.58,-1528.34C2740.58,-1485.64 2740.58,-1407 2740.58,-1407 2740.58,-1407 3194.87,-1407 3194.87,-1407"/>
<polygon fill="black" stroke="black" points="3194.87,-1410.5 3204.87,-1407 3194.87,-1403.5 3194.87,-1410.5"/>
</g>
<!-- attn_weights_5 -->
<g id="node83" class="node">
<title>attn_weights_5</title>
<polygon fill="lightpink" stroke="black" points="4267.58,-1721.67 4175.58,-1721.67 4175.58,-1668.67 4267.58,-1668.67 4267.58,-1721.67"/>
<text text-anchor="middle" x="4221.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4221.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="4221.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- attn_scores_5&#45;&gt;attn_weights_5 -->
<g id="edge93" class="edge">
<title>attn_scores_5&#45;&gt;attn_weights_5</title>
<path fill="none" stroke="black" d="M4221.58,-1882.46C4221.58,-1882.46 4221.58,-1731.84 4221.58,-1731.84"/>
<polygon fill="black" stroke="black" points="4225.08,-1731.84 4221.58,-1721.84 4218.08,-1731.84 4225.08,-1731.84"/>
</g>
<!-- attn_weights_5&#45;&gt;context_5 -->
<g id="edge94" class="edge">
<title>attn_weights_5&#45;&gt;context_5</title>
<path fill="none" stroke="black" d="M4175.17,-1695C4170.93,-1695 4168.19,-1695 4168.19,-1695 4168.19,-1695 4168.19,-1591.8 4168.19,-1591.8"/>
<polygon fill="black" stroke="black" points="4171.69,-1591.8 4168.19,-1581.8 4164.69,-1591.8 4171.69,-1591.8"/>
</g>
<!-- concat_dim_1_1 -->
<g id="node120" class="node">
<title>concat_dim_1_1</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4216.08,-1441.67 4019.08,-1441.67 4019.08,-1373.67 4216.08,-1373.67 4216.08,-1441.67"/>
<text text-anchor="middle" x="4117.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="4117.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4117.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4117.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 1</text>
</g>
<!-- context_5&#45;&gt;concat_dim_1_1 -->
<g id="edge151" class="edge">
<title>context_5&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" d="M4117.58,-1528.46C4117.58,-1528.46 4117.58,-1451.71 4117.58,-1451.71"/>
<polygon fill="black" stroke="black" points="4121.08,-1451.71 4117.58,-1441.71 4114.08,-1451.71 4121.08,-1451.71"/>
</g>
<!-- attn_weights_6 -->
<g id="node86" class="node">
<title>attn_weights_6</title>
<polygon fill="lightpink" stroke="black" points="3832.58,-1721.67 3740.58,-1721.67 3740.58,-1668.67 3832.58,-1668.67 3832.58,-1721.67"/>
<text text-anchor="middle" x="3786.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3786.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="3786.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- attn_scores_6&#45;&gt;attn_weights_6 -->
<g id="edge98" class="edge">
<title>attn_scores_6&#45;&gt;attn_weights_6</title>
<path fill="none" stroke="black" d="M3786.58,-1882.46C3786.58,-1882.46 3786.58,-1731.84 3786.58,-1731.84"/>
<polygon fill="black" stroke="black" points="3790.08,-1731.84 3786.58,-1721.84 3783.08,-1731.84 3790.08,-1731.84"/>
</g>
<!-- attn_weights_6&#45;&gt;context_6 -->
<g id="edge99" class="edge">
<title>attn_weights_6&#45;&gt;context_6</title>
<path fill="none" stroke="black" d="M3786.58,-1668.51C3786.58,-1668.51 3786.58,-1591.73 3786.58,-1591.73"/>
<polygon fill="black" stroke="black" points="3790.08,-1591.73 3786.58,-1581.73 3783.08,-1591.73 3790.08,-1591.73"/>
</g>
<!-- concat_dim_1_2 -->
<g id="node121" class="node">
<title>concat_dim_1_2</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3912.08,-1441.67 3715.08,-1441.67 3715.08,-1373.67 3912.08,-1373.67 3912.08,-1441.67"/>
<text text-anchor="middle" x="3813.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="3813.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3813.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3813.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 1</text>
</g>
<!-- context_6&#45;&gt;concat_dim_1_2 -->
<g id="edge152" class="edge">
<title>context_6&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" d="M3786.58,-1528.46C3786.58,-1528.46 3786.58,-1451.71 3786.58,-1451.71"/>
<polygon fill="black" stroke="black" points="3790.08,-1451.71 3786.58,-1441.71 3783.08,-1451.71 3790.08,-1451.71"/>
</g>
<!-- attn_weights_7 -->
<g id="node89" class="node">
<title>attn_weights_7</title>
<polygon fill="lightpink" stroke="black" points="3312.58,-1721.67 3220.58,-1721.67 3220.58,-1668.67 3312.58,-1668.67 3312.58,-1721.67"/>
<text text-anchor="middle" x="3266.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3266.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="3266.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- attn_scores_7&#45;&gt;attn_weights_7 -->
<g id="edge103" class="edge">
<title>attn_scores_7&#45;&gt;attn_weights_7</title>
<path fill="none" stroke="black" d="M3266.58,-1882.46C3266.58,-1882.46 3266.58,-1731.84 3266.58,-1731.84"/>
<polygon fill="black" stroke="black" points="3270.08,-1731.84 3266.58,-1721.84 3263.08,-1731.84 3270.08,-1731.84"/>
</g>
<!-- attn_weights_7&#45;&gt;context_7 -->
<g id="edge104" class="edge">
<title>attn_weights_7&#45;&gt;context_7</title>
<path fill="none" stroke="black" d="M3266.58,-1668.51C3266.58,-1668.51 3266.58,-1591.73 3266.58,-1591.73"/>
<polygon fill="black" stroke="black" points="3270.08,-1591.73 3266.58,-1581.73 3263.08,-1591.73 3270.08,-1591.73"/>
</g>
<!-- concat_dim_1_3 -->
<g id="node122" class="node">
<title>concat_dim_1_3</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3657.08,-1441.67 3460.08,-1441.67 3460.08,-1373.67 3657.08,-1373.67 3657.08,-1441.67"/>
<text text-anchor="middle" x="3558.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="3558.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3558.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3558.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 1</text>
</g>
<!-- context_7&#45;&gt;concat_dim_1_3 -->
<g id="edge153" class="edge">
<title>context_7&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" d="M3321.64,-1546C3394.72,-1546 3514.66,-1546 3514.66,-1546 3514.66,-1546 3514.66,-1451.86 3514.66,-1451.86"/>
<polygon fill="black" stroke="black" points="3518.16,-1451.86 3514.66,-1441.86 3511.16,-1451.86 3518.16,-1451.86"/>
</g>
<!-- attn_weights_8 -->
<g id="node92" class="node">
<title>attn_weights_8</title>
<polygon fill="lightpink" stroke="black" points="4809.58,-1721.67 4717.58,-1721.67 4717.58,-1668.67 4809.58,-1668.67 4809.58,-1721.67"/>
<text text-anchor="middle" x="4763.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4763.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="4763.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- attn_scores_8&#45;&gt;attn_weights_8 -->
<g id="edge108" class="edge">
<title>attn_scores_8&#45;&gt;attn_weights_8</title>
<path fill="none" stroke="black" d="M4764.58,-1882.46C4764.58,-1882.46 4764.58,-1731.84 4764.58,-1731.84"/>
<polygon fill="black" stroke="black" points="4768.08,-1731.84 4764.58,-1721.84 4761.08,-1731.84 4768.08,-1731.84"/>
</g>
<!-- attn_weights_8&#45;&gt;context_8 -->
<g id="edge109" class="edge">
<title>attn_weights_8&#45;&gt;context_8</title>
<path fill="none" stroke="black" d="M4736.38,-1668.5C4736.38,-1625.6 4736.38,-1546 4736.38,-1546 4736.38,-1546 4686.63,-1546 4686.63,-1546"/>
<polygon fill="black" stroke="black" points="4686.63,-1542.5 4676.63,-1546 4686.63,-1549.5 4686.63,-1542.5"/>
</g>
<!-- concat_dim_2_0 -->
<g id="node123" class="node">
<title>concat_dim_2_0</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4683.08,-1441.67 4486.08,-1441.67 4486.08,-1373.67 4683.08,-1373.67 4683.08,-1441.67"/>
<text text-anchor="middle" x="4584.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="4584.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4584.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4584.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 2</text>
</g>
<!-- context_8&#45;&gt;concat_dim_2_0 -->
<g id="edge154" class="edge">
<title>context_8&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M4621.58,-1528.46C4621.58,-1528.46 4621.58,-1451.71 4621.58,-1451.71"/>
<polygon fill="black" stroke="black" points="4625.08,-1451.71 4621.58,-1441.71 4618.08,-1451.71 4625.08,-1451.71"/>
</g>
<!-- attn_weights_9 -->
<g id="node95" class="node">
<title>attn_weights_9</title>
<polygon fill="lightpink" stroke="black" points="6447.58,-1721.67 6355.58,-1721.67 6355.58,-1668.67 6447.58,-1668.67 6447.58,-1721.67"/>
<text text-anchor="middle" x="6401.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6401.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="6401.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- attn_scores_9&#45;&gt;attn_weights_9 -->
<g id="edge113" class="edge">
<title>attn_scores_9&#45;&gt;attn_weights_9</title>
<path fill="none" stroke="black" d="M6402.58,-1882.46C6402.58,-1882.46 6402.58,-1731.84 6402.58,-1731.84"/>
<polygon fill="black" stroke="black" points="6406.08,-1731.84 6402.58,-1721.84 6399.08,-1731.84 6406.08,-1731.84"/>
</g>
<!-- attn_weights_9&#45;&gt;context_9 -->
<g id="edge114" class="edge">
<title>attn_weights_9&#45;&gt;context_9</title>
<path fill="none" stroke="black" d="M6379.92,-1668.48C6379.92,-1627.81 6379.92,-1555 6379.92,-1555 6379.92,-1555 6324.82,-1555 6324.82,-1555"/>
<polygon fill="black" stroke="black" points="6324.82,-1551.5 6314.82,-1555 6324.82,-1558.5 6324.82,-1551.5"/>
</g>
<!-- concat_dim_2_1 -->
<g id="node124" class="node">
<title>concat_dim_2_1</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5448.08,-1441.67 5251.08,-1441.67 5251.08,-1373.67 5448.08,-1373.67 5448.08,-1441.67"/>
<text text-anchor="middle" x="5349.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="5349.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5349.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5349.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 2</text>
</g>
<!-- context_9&#45;&gt;concat_dim_2_1 -->
<g id="edge155" class="edge">
<title>context_9&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M6259.58,-1528.33C6259.58,-1510.74 6259.58,-1491 6259.58,-1491 6259.58,-1491 5429.73,-1491 5429.73,-1491 5429.73,-1491 5429.73,-1452.05 5429.73,-1452.05"/>
<polygon fill="black" stroke="black" points="5433.23,-1452.05 5429.73,-1442.05 5426.23,-1452.05 5433.23,-1452.05"/>
</g>
<!-- attn_weights_10 -->
<g id="node98" class="node">
<title>attn_weights_10</title>
<polygon fill="lightpink" stroke="black" points="5901.58,-1721.67 5809.58,-1721.67 5809.58,-1668.67 5901.58,-1668.67 5901.58,-1721.67"/>
<text text-anchor="middle" x="5855.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5855.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="5855.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- attn_scores_10&#45;&gt;attn_weights_10 -->
<g id="edge118" class="edge">
<title>attn_scores_10&#45;&gt;attn_weights_10</title>
<path fill="none" stroke="black" d="M5856.58,-1882.46C5856.58,-1882.46 5856.58,-1731.84 5856.58,-1731.84"/>
<polygon fill="black" stroke="black" points="5860.08,-1731.84 5856.58,-1721.84 5853.08,-1731.84 5860.08,-1731.84"/>
</g>
<!-- attn_weights_10&#45;&gt;context_10 -->
<g id="edge119" class="edge">
<title>attn_weights_10&#45;&gt;context_10</title>
<path fill="none" stroke="black" d="M5857.92,-1668.48C5857.92,-1627.81 5857.92,-1555 5857.92,-1555 5857.92,-1555 5778.97,-1555 5778.97,-1555"/>
<polygon fill="black" stroke="black" points="5778.97,-1551.5 5768.97,-1555 5778.97,-1558.5 5778.97,-1551.5"/>
</g>
<!-- concat_dim_2_2 -->
<g id="node125" class="node">
<title>concat_dim_2_2</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5193.08,-1441.67 4996.08,-1441.67 4996.08,-1373.67 5193.08,-1373.67 5193.08,-1441.67"/>
<text text-anchor="middle" x="5094.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="5094.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5094.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5094.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 2</text>
</g>
<!-- context_10&#45;&gt;concat_dim_2_2 -->
<g id="edge156" class="edge">
<title>context_10&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5671.83,-1528.47C5671.83,-1515.64 5671.83,-1503 5671.83,-1503 5671.83,-1503 5152.83,-1503 5152.83,-1503 5152.83,-1503 5152.83,-1451.82 5152.83,-1451.82"/>
<polygon fill="black" stroke="black" points="5156.33,-1451.82 5152.83,-1441.82 5149.33,-1451.82 5156.33,-1451.82"/>
</g>
<!-- attn_weights_11 -->
<g id="node101" class="node">
<title>attn_weights_11</title>
<polygon fill="lightpink" stroke="black" points="5355.58,-1721.67 5263.58,-1721.67 5263.58,-1668.67 5355.58,-1668.67 5355.58,-1721.67"/>
<text text-anchor="middle" x="5309.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5309.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="5309.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- attn_scores_11&#45;&gt;attn_weights_11 -->
<g id="edge123" class="edge">
<title>attn_scores_11&#45;&gt;attn_weights_11</title>
<path fill="none" stroke="black" d="M5310.58,-1882.46C5310.58,-1882.46 5310.58,-1731.84 5310.58,-1731.84"/>
<polygon fill="black" stroke="black" points="5314.08,-1731.84 5310.58,-1721.84 5307.08,-1731.84 5314.08,-1731.84"/>
</g>
<!-- attn_weights_11&#45;&gt;context_11 -->
<g id="edge124" class="edge">
<title>attn_weights_11&#45;&gt;context_11</title>
<path fill="none" stroke="black" d="M5309.58,-1668.48C5309.58,-1627.81 5309.58,-1555 5309.58,-1555 5309.58,-1555 5232.89,-1555 5232.89,-1555"/>
<polygon fill="black" stroke="black" points="5232.89,-1551.5 5222.89,-1555 5232.89,-1558.5 5232.89,-1551.5"/>
</g>
<!-- concat_dim_2_3 -->
<g id="node126" class="node">
<title>concat_dim_2_3</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4938.08,-1441.67 4741.08,-1441.67 4741.08,-1373.67 4938.08,-1373.67 4938.08,-1441.67"/>
<text text-anchor="middle" x="4839.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="4839.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4839.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4839.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 2</text>
</g>
<!-- context_11&#45;&gt;concat_dim_2_3 -->
<g id="edge157" class="edge">
<title>context_11&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M5112.45,-1564C5041.86,-1564 4928.56,-1564 4928.56,-1564 4928.56,-1564 4928.56,-1451.98 4928.56,-1451.98"/>
<polygon fill="black" stroke="black" points="4932.06,-1451.98 4928.56,-1441.98 4925.06,-1451.98 4932.06,-1451.98"/>
</g>
<!-- attn_weights_12 -->
<g id="node104" class="node">
<title>attn_weights_12</title>
<polygon fill="lightpink" stroke="black" points="6993.58,-1721.67 6901.58,-1721.67 6901.58,-1668.67 6993.58,-1668.67 6993.58,-1721.67"/>
<text text-anchor="middle" x="6947.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6947.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="6947.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- attn_scores_12&#45;&gt;attn_weights_12 -->
<g id="edge128" class="edge">
<title>attn_scores_12&#45;&gt;attn_weights_12</title>
<path fill="none" stroke="black" d="M6948.58,-1882.46C6948.58,-1882.46 6948.58,-1731.84 6948.58,-1731.84"/>
<polygon fill="black" stroke="black" points="6952.08,-1731.84 6948.58,-1721.84 6945.08,-1731.84 6952.08,-1731.84"/>
</g>
<!-- attn_weights_12&#45;&gt;context_12 -->
<g id="edge129" class="edge">
<title>attn_weights_12&#45;&gt;context_12</title>
<path fill="none" stroke="black" d="M6947.58,-1668.48C6947.58,-1627.81 6947.58,-1555 6947.58,-1555 6947.58,-1555 6870.89,-1555 6870.89,-1555"/>
<polygon fill="black" stroke="black" points="6870.89,-1551.5 6860.89,-1555 6870.89,-1558.5 6870.89,-1551.5"/>
</g>
<!-- concat_dim_3_0 -->
<g id="node127" class="node">
<title>concat_dim_3_0</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5882.08,-1441.67 5685.08,-1441.67 5685.08,-1373.67 5882.08,-1373.67 5882.08,-1441.67"/>
<text text-anchor="middle" x="5783.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="5783.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5783.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5783.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 3</text>
</g>
<!-- context_12&#45;&gt;concat_dim_3_0 -->
<g id="edge158" class="edge">
<title>context_12&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M6805.58,-1528.61C6805.58,-1506.29 6805.58,-1478 6805.58,-1478 6805.58,-1478 5833.75,-1478 5833.75,-1478 5833.75,-1478 5833.75,-1452.01 5833.75,-1452.01"/>
<polygon fill="black" stroke="black" points="5837.25,-1452.01 5833.75,-1442.01 5830.25,-1452.01 5837.25,-1452.01"/>
</g>
<!-- attn_weights_13 -->
<g id="node107" class="node">
<title>attn_weights_13</title>
<polygon fill="lightpink" stroke="black" points="8639.58,-1721.67 8547.58,-1721.67 8547.58,-1668.67 8639.58,-1668.67 8639.58,-1721.67"/>
<text text-anchor="middle" x="8593.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8593.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="8593.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- attn_scores_13&#45;&gt;attn_weights_13 -->
<g id="edge133" class="edge">
<title>attn_scores_13&#45;&gt;attn_weights_13</title>
<path fill="none" stroke="black" d="M8593.58,-1882.46C8593.58,-1882.46 8593.58,-1731.84 8593.58,-1731.84"/>
<polygon fill="black" stroke="black" points="8597.08,-1731.84 8593.58,-1721.84 8590.08,-1731.84 8597.08,-1731.84"/>
</g>
<!-- attn_weights_13&#45;&gt;context_13 -->
<g id="edge134" class="edge">
<title>attn_weights_13&#45;&gt;context_13</title>
<path fill="none" stroke="black" d="M8593.58,-1668.48C8593.58,-1627.81 8593.58,-1555 8593.58,-1555 8593.58,-1555 8508.59,-1555 8508.59,-1555"/>
<polygon fill="black" stroke="black" points="8508.59,-1551.5 8498.59,-1555 8508.59,-1558.5 8508.59,-1551.5"/>
</g>
<!-- concat_dim_3_1 -->
<g id="node128" class="node">
<title>concat_dim_3_1</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="6647.08,-1441.67 6450.08,-1441.67 6450.08,-1373.67 6647.08,-1373.67 6647.08,-1441.67"/>
<text text-anchor="middle" x="6548.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="6548.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6548.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6548.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 3</text>
</g>
<!-- context_13&#45;&gt;concat_dim_3_1 -->
<g id="edge159" class="edge">
<title>context_13&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M8443.58,-1528.34C8443.58,-1485.64 8443.58,-1407 8443.58,-1407 8443.58,-1407 6657.14,-1407 6657.14,-1407"/>
<polygon fill="black" stroke="black" points="6657.14,-1403.5 6647.14,-1407 6657.14,-1410.5 6657.14,-1403.5"/>
</g>
<!-- attn_weights_14 -->
<g id="node110" class="node">
<title>attn_weights_14</title>
<polygon fill="lightpink" stroke="black" points="8093.58,-1721.67 8001.58,-1721.67 8001.58,-1668.67 8093.58,-1668.67 8093.58,-1721.67"/>
<text text-anchor="middle" x="8047.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8047.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="8047.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- attn_scores_14&#45;&gt;attn_weights_14 -->
<g id="edge138" class="edge">
<title>attn_scores_14&#45;&gt;attn_weights_14</title>
<path fill="none" stroke="black" d="M8047.58,-1882.46C8047.58,-1882.46 8047.58,-1731.84 8047.58,-1731.84"/>
<polygon fill="black" stroke="black" points="8051.08,-1731.84 8047.58,-1721.84 8044.08,-1731.84 8051.08,-1731.84"/>
</g>
<!-- attn_weights_14&#45;&gt;context_14 -->
<g id="edge139" class="edge">
<title>attn_weights_14&#45;&gt;context_14</title>
<path fill="none" stroke="black" d="M8047.58,-1668.48C8047.58,-1627.81 8047.58,-1555 8047.58,-1555 8047.58,-1555 7962.59,-1555 7962.59,-1555"/>
<polygon fill="black" stroke="black" points="7962.59,-1551.5 7952.59,-1555 7962.59,-1558.5 7962.59,-1551.5"/>
</g>
<!-- concat_dim_3_2 -->
<g id="node129" class="node">
<title>concat_dim_3_2</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="6392.08,-1441.67 6195.08,-1441.67 6195.08,-1373.67 6392.08,-1373.67 6392.08,-1441.67"/>
<text text-anchor="middle" x="6293.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="6293.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6293.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="6293.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 3</text>
</g>
<!-- context_14&#45;&gt;concat_dim_3_2 -->
<g id="edge160" class="edge">
<title>context_14&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M7897.58,-1528.59C7897.58,-1498.61 7897.58,-1454 7897.58,-1454 7897.58,-1454 6367.75,-1454 6367.75,-1454 6367.75,-1454 6367.75,-1451.83 6367.75,-1451.83"/>
<polygon fill="black" stroke="black" points="6371.25,-1451.83 6367.75,-1441.83 6364.25,-1451.83 6371.25,-1451.83"/>
</g>
<!-- attn_weights_15 -->
<g id="node113" class="node">
<title>attn_weights_15</title>
<polygon fill="lightpink" stroke="black" points="7539.58,-1721.67 7447.58,-1721.67 7447.58,-1668.67 7539.58,-1668.67 7539.58,-1721.67"/>
<text text-anchor="middle" x="7493.58" y="-1706.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7493.58" y="-1691.47" font-family="Times,serif" font-size="14.00">[B, L, L, 4]</text>
<text text-anchor="middle" x="7493.58" y="-1676.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- attn_scores_15&#45;&gt;attn_weights_15 -->
<g id="edge143" class="edge">
<title>attn_scores_15&#45;&gt;attn_weights_15</title>
<path fill="none" stroke="black" d="M7494.58,-1882.46C7494.58,-1882.46 7494.58,-1731.84 7494.58,-1731.84"/>
<polygon fill="black" stroke="black" points="7498.08,-1731.84 7494.58,-1721.84 7491.08,-1731.84 7498.08,-1731.84"/>
</g>
<!-- attn_weights_15&#45;&gt;context_15 -->
<g id="edge144" class="edge">
<title>attn_weights_15&#45;&gt;context_15</title>
<path fill="none" stroke="black" d="M7493.58,-1668.48C7493.58,-1627.81 7493.58,-1555 7493.58,-1555 7493.58,-1555 7416.89,-1555 7416.89,-1555"/>
<polygon fill="black" stroke="black" points="7416.89,-1551.5 7406.89,-1555 7416.89,-1558.5 7416.89,-1551.5"/>
</g>
<!-- concat_dim_3_3 -->
<g id="node130" class="node">
<title>concat_dim_3_3</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="6137.08,-1441.67 5940.08,-1441.67 5940.08,-1373.67 6137.08,-1373.67 6137.08,-1441.67"/>
<text text-anchor="middle" x="6038.58" y="-1426.47" font-family="Times,serif" font-size="14.00">Concat Dim</text>
<text text-anchor="middle" x="6038.58" y="-1411.47" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6038.58" y="-1396.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="6038.58" y="-1381.47" font-family="Times,serif" font-size="14.00">AllGather within Group 3</text>
</g>
<!-- context_15&#45;&gt;concat_dim_3_3 -->
<g id="edge161" class="edge">
<title>context_15&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7351.58,-1528.42C7351.58,-1502.15 7351.58,-1466 7351.58,-1466 7351.58,-1466 6056.23,-1466 6056.23,-1466 6056.23,-1466 6056.23,-1451.94 6056.23,-1451.94"/>
<polygon fill="black" stroke="black" points="6059.73,-1451.94 6056.23,-1441.94 6052.73,-1451.94 6059.73,-1451.94"/>
</g>
<!-- concat_heads_0 -->
<g id="node131" class="node">
<title>concat_heads_0</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="1759.08,-1286.67 1574.08,-1286.67 1574.08,-1218.67 1759.08,-1218.67 1759.08,-1286.67"/>
<text text-anchor="middle" x="1666.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="1666.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="1666.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1666.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_0 -->
<g id="edge162" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M1993.83,-1373.38C1993.83,-1352.57 1993.83,-1330 1993.83,-1330 1993.83,-1330 1747.58,-1330 1747.58,-1330 1747.58,-1330 1747.58,-1296.81 1747.58,-1296.81"/>
<polygon fill="black" stroke="black" points="1751.08,-1296.81 1747.58,-1286.81 1744.08,-1296.81 1751.08,-1296.81"/>
</g>
<!-- concat_heads_1 -->
<g id="node132" class="node">
<title>concat_heads_1</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="2002.08,-1286.67 1817.08,-1286.67 1817.08,-1218.67 2002.08,-1218.67 2002.08,-1286.67"/>
<text text-anchor="middle" x="1909.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="1909.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="1909.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1909.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_1 -->
<g id="edge166" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M1996.58,-1373.66C1996.58,-1373.66 1996.58,-1296.87 1996.58,-1296.87"/>
<polygon fill="black" stroke="black" points="2000.08,-1296.87 1996.58,-1286.87 1993.08,-1296.87 2000.08,-1296.87"/>
</g>
<!-- concat_heads_2 -->
<g id="node133" class="node">
<title>concat_heads_2</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="2514.08,-1286.67 2329.08,-1286.67 2329.08,-1218.67 2514.08,-1218.67 2514.08,-1286.67"/>
<text text-anchor="middle" x="2421.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="2421.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="2421.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2421.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_2 -->
<g id="edge170" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M2164.28,-1373.32C2164.28,-1349.48 2164.28,-1322 2164.28,-1322 2164.28,-1322 2397.48,-1322 2397.48,-1322 2397.48,-1322 2397.48,-1296.93 2397.48,-1296.93"/>
<polygon fill="black" stroke="black" points="2400.98,-1296.93 2397.48,-1286.93 2393.98,-1296.93 2400.98,-1296.93"/>
</g>
<!-- concat_heads_3 -->
<g id="node134" class="node">
<title>concat_heads_3</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="2254.08,-1286.67 2069.08,-1286.67 2069.08,-1218.67 2254.08,-1218.67 2254.08,-1286.67"/>
<text text-anchor="middle" x="2161.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="2161.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="2161.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2161.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_3 -->
<g id="edge174" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M2140.48,-1373.66C2140.48,-1373.66 2140.48,-1296.87 2140.48,-1296.87"/>
<polygon fill="black" stroke="black" points="2143.98,-1296.87 2140.48,-1286.87 2136.98,-1296.87 2143.98,-1296.87"/>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_0 -->
<g id="edge163" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M1594.88,-1373.66C1594.88,-1373.66 1594.88,-1296.87 1594.88,-1296.87"/>
<polygon fill="black" stroke="black" points="1598.38,-1296.87 1594.88,-1286.87 1591.38,-1296.87 1598.38,-1296.87"/>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_1 -->
<g id="edge167" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M1615.68,-1373.51C1615.68,-1345.34 1615.68,-1310 1615.68,-1310 1615.68,-1310 1840.28,-1310 1840.28,-1310 1840.28,-1310 1840.28,-1296.68 1840.28,-1296.68"/>
<polygon fill="black" stroke="black" points="1843.78,-1296.68 1840.28,-1286.68 1836.78,-1296.68 1843.78,-1296.68"/>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_2 -->
<g id="edge171" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M1657.28,-1373.51C1657.28,-1348.17 1657.28,-1318 1657.28,-1318 1657.28,-1318 2351.88,-1318 2351.88,-1318 2351.88,-1318 2351.88,-1296.87 2351.88,-1296.87"/>
<polygon fill="black" stroke="black" points="2355.38,-1296.87 2351.88,-1286.87 2348.38,-1296.87 2355.38,-1296.87"/>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_3 -->
<g id="edge175" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M1636.48,-1373.49C1636.48,-1346.38 1636.48,-1313 1636.48,-1313 1636.48,-1313 2092.88,-1313 2092.88,-1313 2092.88,-1313 2092.88,-1296.71 2092.88,-1296.71"/>
<polygon fill="black" stroke="black" points="2096.38,-1296.71 2092.88,-1286.71 2089.38,-1296.71 2096.38,-1296.71"/>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_0 -->
<g id="edge164" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M2291.58,-1373.46C2291.58,-1351.47 2291.58,-1327 2291.58,-1327 2291.58,-1327 1753.33,-1327 1753.33,-1327 1753.33,-1327 1753.33,-1296.79 1753.33,-1296.79"/>
<polygon fill="black" stroke="black" points="1756.83,-1296.79 1753.33,-1286.79 1749.83,-1296.79 1756.83,-1296.79"/>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_1 -->
<g id="edge168" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M2248.75,-1373.57C2248.75,-1350.8 2248.75,-1325 2248.75,-1325 2248.75,-1325 1999.33,-1325 1999.33,-1325 1999.33,-1325 1999.33,-1296.72 1999.33,-1296.72"/>
<polygon fill="black" stroke="black" points="2002.83,-1296.72 1999.33,-1286.72 1995.83,-1296.72 2002.83,-1296.72"/>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_2 -->
<g id="edge172" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M2420.28,-1373.66C2420.28,-1373.66 2420.28,-1296.87 2420.28,-1296.87"/>
<polygon fill="black" stroke="black" points="2423.78,-1296.87 2420.28,-1286.87 2416.78,-1296.87 2423.78,-1296.87"/>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_3 -->
<g id="edge176" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M2251.42,-1373.66C2251.42,-1373.66 2251.42,-1296.87 2251.42,-1296.87"/>
<polygon fill="black" stroke="black" points="2254.92,-1296.87 2251.42,-1286.87 2247.92,-1296.87 2254.92,-1296.87"/>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_0 -->
<g id="edge165" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M1741.83,-1373.66C1741.83,-1373.66 1741.83,-1296.87 1741.83,-1296.87"/>
<polygon fill="black" stroke="black" points="1745.33,-1296.87 1741.83,-1286.87 1738.33,-1296.87 1745.33,-1296.87"/>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_1 -->
<g id="edge169" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M1863.48,-1373.66C1863.48,-1373.66 1863.48,-1296.87 1863.48,-1296.87"/>
<polygon fill="black" stroke="black" points="1866.98,-1296.87 1863.48,-1286.87 1859.98,-1296.87 1866.98,-1296.87"/>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_2 -->
<g id="edge173" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M1909.88,-1373.52C1909.88,-1348.91 1909.88,-1320 1909.88,-1320 1909.88,-1320 2374.68,-1320 2374.68,-1320 2374.68,-1320 2374.68,-1296.73 2374.68,-1296.73"/>
<polygon fill="black" stroke="black" points="2378.18,-1296.73 2374.68,-1286.73 2371.18,-1296.73 2378.18,-1296.73"/>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_3 -->
<g id="edge177" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M1886.68,-1373.43C1886.68,-1347.03 1886.68,-1315 1886.68,-1315 1886.68,-1315 2116.68,-1315 2116.68,-1315 2116.68,-1315 2116.68,-1296.75 2116.68,-1296.75"/>
<polygon fill="black" stroke="black" points="2120.18,-1296.75 2116.68,-1286.75 2113.18,-1296.75 2120.18,-1296.75"/>
</g>
<!-- concat_heads_4 -->
<g id="node135" class="node">
<title>concat_heads_4</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4227.08,-1286.67 4042.08,-1286.67 4042.08,-1218.67 4227.08,-1218.67 4227.08,-1286.67"/>
<text text-anchor="middle" x="4134.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="4134.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4134.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4134.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_4 -->
<g id="edge178" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M3380.88,-1373.52C3380.88,-1370.18 3380.88,-1368 3380.88,-1368 3380.88,-1368 4085.58,-1368 4085.58,-1368 4085.58,-1368 4085.58,-1296.96 4085.58,-1296.96"/>
<polygon fill="black" stroke="black" points="4089.08,-1296.96 4085.58,-1286.96 4082.08,-1296.96 4089.08,-1296.96"/>
</g>
<!-- concat_heads_5 -->
<g id="node136" class="node">
<title>concat_heads_5</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3976.08,-1286.67 3791.08,-1286.67 3791.08,-1218.67 3976.08,-1218.67 3976.08,-1286.67"/>
<text text-anchor="middle" x="3883.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="3883.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="3883.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3883.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_5 -->
<g id="edge182" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_5</title>
<path fill="none" stroke="black" d="M3359.68,-1373.53C3359.68,-1344 3359.68,-1306 3359.68,-1306 3359.68,-1306 3821.33,-1306 3821.33,-1306 3821.33,-1306 3821.33,-1296.75 3821.33,-1296.75"/>
<polygon fill="black" stroke="black" points="3824.83,-1296.75 3821.33,-1286.75 3817.83,-1296.75 3824.83,-1296.75"/>
</g>
<!-- concat_heads_6 -->
<g id="node137" class="node">
<title>concat_heads_6</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3724.08,-1286.67 3539.08,-1286.67 3539.08,-1218.67 3724.08,-1218.67 3724.08,-1286.67"/>
<text text-anchor="middle" x="3631.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="3631.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="3631.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3631.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_6 -->
<g id="edge186" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_6</title>
<path fill="none" stroke="black" d="M3338.48,-1373.4C3338.48,-1342.87 3338.48,-1303 3338.48,-1303 3338.48,-1303 3562.68,-1303 3562.68,-1303 3562.68,-1303 3562.68,-1296.8 3562.68,-1296.8"/>
<polygon fill="black" stroke="black" points="3566.18,-1296.8 3562.68,-1286.8 3559.18,-1296.8 3566.18,-1296.8"/>
</g>
<!-- concat_heads_7 -->
<g id="node138" class="node">
<title>concat_heads_7</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3481.08,-1286.67 3296.08,-1286.67 3296.08,-1218.67 3481.08,-1218.67 3481.08,-1286.67"/>
<text text-anchor="middle" x="3388.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="3388.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="3388.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3388.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_7 -->
<g id="edge190" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_7</title>
<path fill="none" stroke="black" d="M3317.28,-1373.66C3317.28,-1373.66 3317.28,-1296.87 3317.28,-1296.87"/>
<polygon fill="black" stroke="black" points="3320.78,-1296.87 3317.28,-1286.87 3313.78,-1296.87 3320.78,-1296.87"/>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_4 -->
<g id="edge179" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M4172.58,-1373.66C4172.58,-1373.66 4172.58,-1296.87 4172.58,-1296.87"/>
<polygon fill="black" stroke="black" points="4176.08,-1296.87 4172.58,-1286.87 4169.08,-1296.87 4176.08,-1296.87"/>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_5 -->
<g id="edge183" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_5</title>
<path fill="none" stroke="black" d="M4031.08,-1373.62C4031.08,-1331.14 4031.08,-1264 4031.08,-1264 4031.08,-1264 3986.16,-1264 3986.16,-1264"/>
<polygon fill="black" stroke="black" points="3986.16,-1260.5 3976.16,-1264 3986.16,-1267.5 3986.16,-1260.5"/>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_6 -->
<g id="edge187" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_6</title>
<path fill="none" stroke="black" d="M4027.08,-1373.38C4027.08,-1353.36 4027.08,-1332 4027.08,-1332 4027.08,-1332 3721.83,-1332 3721.83,-1332 3721.83,-1332 3721.83,-1296.77 3721.83,-1296.77"/>
<polygon fill="black" stroke="black" points="3725.33,-1296.77 3721.83,-1286.77 3718.33,-1296.77 3725.33,-1296.77"/>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_7 -->
<g id="edge191" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_7</title>
<path fill="none" stroke="black" d="M4023.08,-1373.46C4023.08,-1354.61 4023.08,-1335 4023.08,-1335 4023.08,-1335 3475.83,-1335 3475.83,-1335 3475.83,-1335 3475.83,-1297.11 3475.83,-1297.11"/>
<polygon fill="black" stroke="black" points="3479.33,-1297.11 3475.83,-1287.11 3472.33,-1297.11 3479.33,-1297.11"/>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_4 -->
<g id="edge180" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M3912.37,-1407C3948.96,-1407 3981.73,-1407 3981.73,-1407 3981.73,-1407 3981.73,-1241 3981.73,-1241 3981.73,-1241 4031.7,-1241 4031.7,-1241"/>
<polygon fill="black" stroke="black" points="4031.7,-1244.5 4041.7,-1241 4031.7,-1237.5 4031.7,-1244.5"/>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_5 -->
<g id="edge184" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_5</title>
<path fill="none" stroke="black" d="M3881.83,-1373.66C3881.83,-1373.66 3881.83,-1296.87 3881.83,-1296.87"/>
<polygon fill="black" stroke="black" points="3885.33,-1296.87 3881.83,-1286.87 3878.33,-1296.87 3885.33,-1296.87"/>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_6 -->
<g id="edge188" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_6</title>
<path fill="none" stroke="black" d="M3719.58,-1373.66C3719.58,-1373.66 3719.58,-1296.87 3719.58,-1296.87"/>
<polygon fill="black" stroke="black" points="3723.08,-1296.87 3719.58,-1286.87 3716.08,-1296.87 3723.08,-1296.87"/>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_7 -->
<g id="edge192" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_7</title>
<path fill="none" stroke="black" d="M3717.33,-1373.58C3717.33,-1355.51 3717.33,-1337 3717.33,-1337 3717.33,-1337 3470.58,-1337 3470.58,-1337 3470.58,-1337 3470.58,-1296.97 3470.58,-1296.97"/>
<polygon fill="black" stroke="black" points="3474.08,-1296.97 3470.58,-1286.97 3467.08,-1296.97 3474.08,-1296.97"/>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_4 -->
<g id="edge181" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M3633.48,-1373.41C3633.48,-1371.9 3633.48,-1371 3633.48,-1371 3633.48,-1371 4129.08,-1371 4129.08,-1371 4129.08,-1371 4129.08,-1296.9 4129.08,-1296.9"/>
<polygon fill="black" stroke="black" points="4132.58,-1296.9 4129.08,-1286.9 4125.58,-1296.9 4132.58,-1296.9"/>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_5 -->
<g id="edge185" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_5</title>
<path fill="none" stroke="black" d="M3609.88,-1373.65C3609.88,-1344.77 3609.88,-1308 3609.88,-1308 3609.88,-1308 3851.58,-1308 3851.58,-1308 3851.58,-1308 3851.58,-1296.77 3851.58,-1296.77"/>
<polygon fill="black" stroke="black" points="3855.08,-1296.77 3851.58,-1286.77 3848.08,-1296.77 3855.08,-1296.77"/>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_6 -->
<g id="edge189" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_6</title>
<path fill="none" stroke="black" d="M3586.28,-1373.66C3586.28,-1373.66 3586.28,-1296.87 3586.28,-1296.87"/>
<polygon fill="black" stroke="black" points="3589.78,-1296.87 3586.28,-1286.87 3582.78,-1296.87 3589.78,-1296.87"/>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_7 -->
<g id="edge193" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_7</title>
<path fill="none" stroke="black" d="M3465.33,-1373.66C3465.33,-1373.66 3465.33,-1296.87 3465.33,-1296.87"/>
<polygon fill="black" stroke="black" points="3468.83,-1296.87 3465.33,-1286.87 3461.83,-1296.87 3468.83,-1296.87"/>
</g>
<!-- concat_heads_8 -->
<g id="node139" class="node">
<title>concat_heads_8</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5255.08,-1286.67 5070.08,-1286.67 5070.08,-1218.67 5255.08,-1218.67 5255.08,-1286.67"/>
<text text-anchor="middle" x="5162.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="5162.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="5162.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5162.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_8 -->
<g id="edge194" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_8</title>
<path fill="none" stroke="black" d="M4651.83,-1373.58C4651.83,-1339.77 4651.83,-1293 4651.83,-1293 4651.83,-1293 5100.83,-1293 5100.83,-1293 5100.83,-1293 5100.83,-1292.37 5100.83,-1292.37"/>
<polygon fill="black" stroke="black" points="5104.33,-1296.7 5100.83,-1286.7 5097.33,-1296.7 5104.33,-1296.7"/>
</g>
<!-- concat_heads_9 -->
<g id="node140" class="node">
<title>concat_heads_9</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4995.08,-1286.67 4810.08,-1286.67 4810.08,-1218.67 4995.08,-1218.67 4995.08,-1286.67"/>
<text text-anchor="middle" x="4902.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="4902.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4902.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4902.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_9 -->
<g id="edge198" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_9</title>
<path fill="none" stroke="black" d="M4620.58,-1373.66C4620.58,-1338.6 4620.58,-1289 4620.58,-1289 4620.58,-1289 4842.08,-1289 4842.08,-1289 4842.08,-1289 4842.08,-1288.8 4842.08,-1288.8"/>
<polygon fill="black" stroke="black" points="4845.58,-1297.05 4842.08,-1287.05 4838.58,-1297.05 4845.58,-1297.05"/>
</g>
<!-- concat_heads_10 -->
<g id="node141" class="node">
<title>concat_heads_10</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4743.08,-1286.67 4558.08,-1286.67 4558.08,-1218.67 4743.08,-1218.67 4743.08,-1286.67"/>
<text text-anchor="middle" x="4650.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="4650.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4650.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="4650.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_10 -->
<g id="edge202" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_10</title>
<path fill="none" stroke="black" d="M4589.33,-1373.66C4589.33,-1373.66 4589.33,-1296.87 4589.33,-1296.87"/>
<polygon fill="black" stroke="black" points="4592.83,-1296.87 4589.33,-1286.87 4585.83,-1296.87 4592.83,-1296.87"/>
</g>
<!-- concat_heads_11 -->
<g id="node142" class="node">
<title>concat_heads_11</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="4500.08,-1286.67 4315.08,-1286.67 4315.08,-1218.67 4500.08,-1218.67 4500.08,-1286.67"/>
<text text-anchor="middle" x="4407.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="4407.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4407.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4407.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_11 -->
<g id="edge206" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_11</title>
<path fill="none" stroke="black" d="M4488.88,-1373.66C4488.88,-1373.66 4488.88,-1296.87 4488.88,-1296.87"/>
<polygon fill="black" stroke="black" points="4492.38,-1296.87 4488.88,-1286.87 4485.38,-1296.87 4492.38,-1296.87"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_8 -->
<g id="edge195" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_8</title>
<path fill="none" stroke="black" d="M5251.03,-1407C5240.76,-1407 5233.98,-1407 5233.98,-1407 5233.98,-1407 5233.98,-1296.92 5233.98,-1296.92"/>
<polygon fill="black" stroke="black" points="5237.48,-1296.92 5233.98,-1286.92 5230.48,-1296.92 5237.48,-1296.92"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_9 -->
<g id="edge199" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_9</title>
<path fill="none" stroke="black" d="M5415.92,-1373.34C5415.92,-1356.17 5415.92,-1339 5415.92,-1339 5415.92,-1339 4976.08,-1339 4976.08,-1339 4976.08,-1339 4976.08,-1296.79 4976.08,-1296.79"/>
<polygon fill="black" stroke="black" points="4979.58,-1296.79 4976.08,-1286.79 4972.58,-1296.79 4979.58,-1296.79"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_10 -->
<g id="edge203" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_10</title>
<path fill="none" stroke="black" d="M5383.75,-1373.3C5383.75,-1357.41 5383.75,-1342 5383.75,-1342 5383.75,-1342 4731.68,-1342 4731.68,-1342 4731.68,-1342 4731.68,-1296.7 4731.68,-1296.7"/>
<polygon fill="black" stroke="black" points="4735.18,-1296.7 4731.68,-1286.7 4728.18,-1296.7 4735.18,-1296.7"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_11 -->
<g id="edge207" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_11</title>
<path fill="none" stroke="black" d="M5351.58,-1373.43C5351.58,-1359.67 5351.58,-1347 5351.58,-1347 5351.58,-1347 4497.28,-1347 4497.28,-1347 4497.28,-1347 4497.28,-1296.73 4497.28,-1296.73"/>
<polygon fill="black" stroke="black" points="4500.78,-1296.73 4497.28,-1286.73 4493.78,-1296.73 4500.78,-1296.73"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_8 -->
<g id="edge196" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_8</title>
<path fill="none" stroke="black" d="M5162.33,-1373.66C5162.33,-1373.66 5162.33,-1296.87 5162.33,-1296.87"/>
<polygon fill="black" stroke="black" points="5165.83,-1296.87 5162.33,-1286.87 5158.83,-1296.87 5165.83,-1296.87"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_9 -->
<g id="edge200" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_9</title>
<path fill="none" stroke="black" d="M4995.75,-1407C4973.89,-1407 4957.08,-1407 4957.08,-1407 4957.08,-1407 4957.08,-1296.92 4957.08,-1296.92"/>
<polygon fill="black" stroke="black" points="4960.58,-1296.92 4957.08,-1286.92 4953.58,-1296.92 4960.58,-1296.92"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_10 -->
<g id="edge204" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_10</title>
<path fill="none" stroke="black" d="M5045.42,-1373.6C5045.42,-1358.46 5045.42,-1344 5045.42,-1344 5045.42,-1344 4726.98,-1344 4726.98,-1344 4726.98,-1344 4726.98,-1296.68 4726.98,-1296.68"/>
<polygon fill="black" stroke="black" points="4730.48,-1296.68 4726.98,-1286.68 4723.48,-1296.68 4730.48,-1296.68"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_11 -->
<g id="edge208" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_11</title>
<path fill="none" stroke="black" d="M5020.75,-1373.54C5020.75,-1360.63 5020.75,-1349 5020.75,-1349 5020.75,-1349 4494.48,-1349 4494.48,-1349 4494.48,-1349 4494.48,-1296.9 4494.48,-1296.9"/>
<polygon fill="black" stroke="black" points="4497.98,-1296.9 4494.48,-1286.9 4490.98,-1296.9 4497.98,-1296.9"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_8 -->
<g id="edge197" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_8</title>
<path fill="none" stroke="black" d="M4906.08,-1373.56C4906.08,-1340.72 4906.08,-1296 4906.08,-1296 4906.08,-1296 5131.58,-1296 5131.58,-1296 5131.58,-1296 5131.58,-1295.08 5131.58,-1295.08"/>
<polygon fill="black" stroke="black" points="5135.08,-1296.81 5131.58,-1286.81 5128.08,-1296.81 5135.08,-1296.81"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_9 -->
<g id="edge201" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_9</title>
<path fill="none" stroke="black" d="M4874.08,-1373.66C4874.08,-1373.66 4874.08,-1296.87 4874.08,-1296.87"/>
<polygon fill="black" stroke="black" points="4877.58,-1296.87 4874.08,-1286.87 4870.58,-1296.87 4877.58,-1296.87"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_10 -->
<g id="edge205" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_10</title>
<path fill="none" stroke="black" d="M4740.87,-1407C4729.73,-1407 4722.28,-1407 4722.28,-1407 4722.28,-1407 4722.28,-1296.92 4722.28,-1296.92"/>
<polygon fill="black" stroke="black" points="4725.78,-1296.92 4722.28,-1286.92 4718.78,-1296.92 4725.78,-1296.92"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_11 -->
<g id="edge209" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_11</title>
<path fill="none" stroke="black" d="M4776.08,-1373.4C4776.08,-1361.46 4776.08,-1351 4776.08,-1351 4776.08,-1351 4491.68,-1351 4491.68,-1351 4491.68,-1351 4491.68,-1296.79 4491.68,-1296.79"/>
<polygon fill="black" stroke="black" points="4495.18,-1296.79 4491.68,-1286.79 4488.18,-1296.79 4495.18,-1296.79"/>
</g>
<!-- concat_heads_12 -->
<g id="node143" class="node">
<title>concat_heads_12</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="6454.08,-1286.67 6269.08,-1286.67 6269.08,-1218.67 6454.08,-1218.67 6454.08,-1286.67"/>
<text text-anchor="middle" x="6361.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="6361.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="6361.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6361.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_12 -->
<g id="edge210" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_12</title>
<path fill="none" stroke="black" d="M5850.83,-1373.57C5850.83,-1341.38 5850.83,-1298 5850.83,-1298 5850.83,-1298 6299.83,-1298 6299.83,-1298 6299.83,-1298 6299.83,-1296.9 6299.83,-1296.9"/>
<polygon fill="black" stroke="black" points="6303.33,-1297.03 6299.83,-1287.03 6296.33,-1297.03 6303.33,-1297.03"/>
</g>
<!-- concat_heads_13 -->
<g id="node144" class="node">
<title>concat_heads_13</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="6194.08,-1286.67 6009.08,-1286.67 6009.08,-1218.67 6194.08,-1218.67 6194.08,-1286.67"/>
<text text-anchor="middle" x="6101.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="6101.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="6101.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6101.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_13 -->
<g id="edge214" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_13</title>
<path fill="none" stroke="black" d="M5819.58,-1373.61C5819.58,-1339.17 5819.58,-1291 5819.58,-1291 5819.58,-1291 6041.08,-1291 6041.08,-1291 6041.08,-1291 6041.08,-1290.59 6041.08,-1290.59"/>
<polygon fill="black" stroke="black" points="6044.58,-1296.9 6041.08,-1286.9 6037.58,-1296.9 6044.58,-1296.9"/>
</g>
<!-- concat_heads_14 -->
<g id="node145" class="node">
<title>concat_heads_14</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5942.08,-1286.67 5757.08,-1286.67 5757.08,-1218.67 5942.08,-1218.67 5942.08,-1286.67"/>
<text text-anchor="middle" x="5849.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="5849.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="5849.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="5849.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_14 -->
<g id="edge218" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_14</title>
<path fill="none" stroke="black" d="M5788.33,-1373.66C5788.33,-1373.66 5788.33,-1296.87 5788.33,-1296.87"/>
<polygon fill="black" stroke="black" points="5791.83,-1296.87 5788.33,-1286.87 5784.83,-1296.87 5791.83,-1296.87"/>
</g>
<!-- concat_heads_15 -->
<g id="node146" class="node">
<title>concat_heads_15</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="5699.08,-1286.67 5514.08,-1286.67 5514.08,-1218.67 5699.08,-1218.67 5699.08,-1286.67"/>
<text text-anchor="middle" x="5606.58" y="-1271.47" font-family="Times,serif" font-size="14.00">Concat Heads</text>
<text text-anchor="middle" x="5606.58" y="-1256.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="5606.58" y="-1241.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5606.58" y="-1226.47" font-family="Times,serif" font-size="14.00">Reduce across all GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_15 -->
<g id="edge222" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_15</title>
<path fill="none" stroke="black" d="M5687.88,-1373.66C5687.88,-1373.66 5687.88,-1296.87 5687.88,-1296.87"/>
<polygon fill="black" stroke="black" points="5691.38,-1296.87 5687.88,-1286.87 5684.38,-1296.87 5691.38,-1296.87"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_12 -->
<g id="edge211" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_12</title>
<path fill="none" stroke="black" d="M6450.02,-1407C6432.57,-1407 6419.83,-1407 6419.83,-1407 6419.83,-1407 6419.83,-1296.92 6419.83,-1296.92"/>
<polygon fill="black" stroke="black" points="6423.33,-1296.92 6419.83,-1286.92 6416.33,-1296.92 6423.33,-1296.92"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_13 -->
<g id="edge215" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_13</title>
<path fill="none" stroke="black" d="M6598.83,-1373.38C6598.83,-1362.86 6598.83,-1354 6598.83,-1354 6598.83,-1354 6189.99,-1354 6189.99,-1354 6189.99,-1354 6189.99,-1296.69 6189.99,-1296.69"/>
<polygon fill="black" stroke="black" points="6193.49,-1296.69 6189.99,-1286.69 6186.49,-1296.69 6193.49,-1296.69"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_14 -->
<g id="edge219" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_14</title>
<path fill="none" stroke="black" d="M6550.58,-1373.49C6550.58,-1363.88 6550.58,-1356 6550.58,-1356 6550.58,-1356 5927.25,-1356 5927.25,-1356 5927.25,-1356 5927.25,-1296.79 5927.25,-1296.79"/>
<polygon fill="black" stroke="black" points="5930.75,-1296.79 5927.25,-1286.79 5923.75,-1296.79 5930.75,-1296.79"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_15 -->
<g id="edge223" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_15</title>
<path fill="none" stroke="black" d="M6502.33,-1373.26C6502.33,-1366.27 6502.33,-1361 6502.33,-1361 6502.33,-1361 5696.28,-1361 5696.28,-1361 5696.28,-1361 5696.28,-1296.95 5696.28,-1296.95"/>
<polygon fill="black" stroke="black" points="5699.78,-1296.95 5696.28,-1286.95 5692.78,-1296.95 5699.78,-1296.95"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_12 -->
<g id="edge212" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_12</title>
<path fill="none" stroke="black" d="M6361.33,-1373.66C6361.33,-1373.66 6361.33,-1296.87 6361.33,-1296.87"/>
<polygon fill="black" stroke="black" points="6364.83,-1296.87 6361.33,-1286.87 6357.83,-1296.87 6364.83,-1296.87"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_13 -->
<g id="edge216" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_13</title>
<path fill="none" stroke="black" d="M6195.08,-1407C6189.37,-1407 6185.9,-1407 6185.9,-1407 6185.9,-1407 6185.9,-1296.92 6185.9,-1296.92"/>
<polygon fill="black" stroke="black" points="6189.4,-1296.92 6185.9,-1286.92 6182.4,-1296.92 6189.4,-1296.92"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_14 -->
<g id="edge220" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_14</title>
<path fill="none" stroke="black" d="M6244.42,-1373.6C6244.42,-1365.42 6244.42,-1359 6244.42,-1359 6244.42,-1359 5914.42,-1359 5914.42,-1359 5914.42,-1359 5914.42,-1296.9 5914.42,-1296.9"/>
<polygon fill="black" stroke="black" points="5917.92,-1296.9 5914.42,-1286.9 5910.92,-1296.9 5917.92,-1296.9"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_15 -->
<g id="edge224" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_15</title>
<path fill="none" stroke="black" d="M6219.75,-1373.26C6219.75,-1367.85 6219.75,-1364 6219.75,-1364 6219.75,-1364 5693.48,-1364 5693.48,-1364 5693.48,-1364 5693.48,-1296.68 5693.48,-1296.68"/>
<polygon fill="black" stroke="black" points="5696.98,-1296.68 5693.48,-1286.68 5689.98,-1296.68 5696.98,-1296.68"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_12 -->
<g id="edge213" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_12</title>
<path fill="none" stroke="black" d="M6105.08,-1373.63C6105.08,-1342.41 6105.08,-1301 6105.08,-1301 6105.08,-1301 6330.58,-1301 6330.58,-1301 6330.58,-1301 6330.58,-1296.76 6330.58,-1296.76"/>
<polygon fill="black" stroke="black" points="6334.08,-1296.76 6330.58,-1286.76 6327.08,-1296.76 6334.08,-1296.76"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_13 -->
<g id="edge217" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_13</title>
<path fill="none" stroke="black" d="M6073.08,-1373.66C6073.08,-1373.66 6073.08,-1296.87 6073.08,-1296.87"/>
<polygon fill="black" stroke="black" points="6076.58,-1296.87 6073.08,-1286.87 6069.58,-1296.87 6076.58,-1296.87"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_14 -->
<g id="edge221" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_14</title>
<path fill="none" stroke="black" d="M5960.75,-1373.51C5960.75,-1327.68 5960.75,-1252 5960.75,-1252 5960.75,-1252 5952.14,-1252 5952.14,-1252"/>
<polygon fill="black" stroke="black" points="5952.14,-1248.5 5942.14,-1252 5952.14,-1255.5 5952.14,-1248.5"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_15 -->
<g id="edge225" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_15</title>
<path fill="none" stroke="black" d="M5951.42,-1373.64C5951.42,-1369.12 5951.42,-1366 5951.42,-1366 5951.42,-1366 5690.68,-1366 5690.68,-1366 5690.68,-1366 5690.68,-1296.67 5690.68,-1296.67"/>
<polygon fill="black" stroke="black" points="5694.18,-1296.67 5690.68,-1286.67 5687.18,-1296.67 5694.18,-1296.67"/>
</g>
<!-- output_proj -->
<g id="node147" class="node">
<title>output_proj</title>
<polygon fill="lightgreen" stroke="black" points="4206.58,-1131.67 4062.58,-1131.67 4062.58,-1063.67 4206.58,-1063.67 4206.58,-1131.67"/>
<text text-anchor="middle" x="4134.58" y="-1116.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4134.58" y="-1101.47" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="4134.58" y="-1086.47" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="4134.58" y="-1071.47" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- concat_heads_0&#45;&gt;output_proj -->
<g id="edge226" class="edge">
<title>concat_heads_0&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M1736.08,-1218.58C1736.08,-1167.75 1736.08,-1078 1736.08,-1078 1736.08,-1078 4052.48,-1078 4052.48,-1078"/>
<polygon fill="black" stroke="black" points="4052.48,-1081.5 4062.48,-1078 4052.48,-1074.5 4052.48,-1081.5"/>
</g>
<!-- concat_heads_1&#45;&gt;output_proj -->
<g id="edge227" class="edge">
<title>concat_heads_1&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M1909.58,-1218.54C1909.58,-1169.78 1909.58,-1086 1909.58,-1086 1909.58,-1086 4052.45,-1086 4052.45,-1086"/>
<polygon fill="black" stroke="black" points="4052.45,-1089.5 4062.45,-1086 4052.45,-1082.5 4052.45,-1089.5"/>
</g>
<!-- concat_heads_2&#45;&gt;output_proj -->
<g id="edge228" class="edge">
<title>concat_heads_2&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M2500.58,-1218.63C2500.58,-1173.92 2500.58,-1101 2500.58,-1101 2500.58,-1101 4052.53,-1101 4052.53,-1101"/>
<polygon fill="black" stroke="black" points="4052.53,-1104.5 4062.53,-1101 4052.53,-1097.5 4052.53,-1104.5"/>
</g>
<!-- concat_heads_3&#45;&gt;output_proj -->
<g id="edge229" class="edge">
<title>concat_heads_3&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M2206.08,-1218.42C2206.08,-1171.5 2206.08,-1093 2206.08,-1093 2206.08,-1093 4052.5,-1093 4052.5,-1093"/>
<polygon fill="black" stroke="black" points="4052.5,-1096.5 4062.5,-1093 4052.5,-1089.5 4052.5,-1096.5"/>
</g>
<!-- concat_heads_4&#45;&gt;output_proj -->
<g id="edge230" class="edge">
<title>concat_heads_4&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4134.58,-1218.66C4134.58,-1218.66 4134.58,-1141.87 4134.58,-1141.87"/>
<polygon fill="black" stroke="black" points="4138.08,-1141.87 4134.58,-1131.87 4131.08,-1141.87 4138.08,-1141.87"/>
</g>
<!-- concat_heads_5&#45;&gt;output_proj -->
<g id="edge231" class="edge">
<title>concat_heads_5&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M3883.58,-1218.53C3883.58,-1180.41 3883.58,-1124 3883.58,-1124 3883.58,-1124 4052.32,-1124 4052.32,-1124"/>
<polygon fill="black" stroke="black" points="4052.32,-1127.5 4062.32,-1124 4052.32,-1120.5 4052.32,-1127.5"/>
</g>
<!-- concat_heads_6&#45;&gt;output_proj -->
<g id="edge232" class="edge">
<title>concat_heads_6&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M3719.58,-1218.54C3719.58,-1178.05 3719.58,-1116 3719.58,-1116 3719.58,-1116 4052.3,-1116 4052.3,-1116"/>
<polygon fill="black" stroke="black" points="4052.3,-1119.5 4062.3,-1116 4052.3,-1112.5 4052.3,-1119.5"/>
</g>
<!-- concat_heads_7&#45;&gt;output_proj -->
<g id="edge233" class="edge">
<title>concat_heads_7&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M3359.58,-1218.62C3359.58,-1176.14 3359.58,-1109 3359.58,-1109 3359.58,-1109 4052.37,-1109 4052.37,-1109"/>
<polygon fill="black" stroke="black" points="4052.37,-1112.5 4062.37,-1109 4052.37,-1105.5 4052.37,-1112.5"/>
</g>
<!-- concat_heads_8&#45;&gt;output_proj -->
<g id="edge234" class="edge">
<title>concat_heads_8&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M5133.08,-1218.63C5133.08,-1173.92 5133.08,-1101 5133.08,-1101 5133.08,-1101 4216.8,-1101 4216.8,-1101"/>
<polygon fill="black" stroke="black" points="4216.8,-1097.5 4206.8,-1101 4216.8,-1104.5 4216.8,-1097.5"/>
</g>
<!-- concat_heads_9&#45;&gt;output_proj -->
<g id="edge235" class="edge">
<title>concat_heads_9&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4838.58,-1218.62C4838.58,-1176.14 4838.58,-1109 4838.58,-1109 4838.58,-1109 4216.62,-1109 4216.62,-1109"/>
<polygon fill="black" stroke="black" points="4216.62,-1105.5 4206.62,-1109 4216.62,-1112.5 4216.62,-1105.5"/>
</g>
<!-- concat_heads_10&#45;&gt;output_proj -->
<g id="edge236" class="edge">
<title>concat_heads_10&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4650.58,-1218.54C4650.58,-1178.05 4650.58,-1116 4650.58,-1116 4650.58,-1116 4216.6,-1116 4216.6,-1116"/>
<polygon fill="black" stroke="black" points="4216.6,-1112.5 4206.6,-1116 4216.6,-1119.5 4216.6,-1112.5"/>
</g>
<!-- concat_heads_11&#45;&gt;output_proj -->
<g id="edge237" class="edge">
<title>concat_heads_11&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M4368.58,-1218.53C4368.58,-1180.41 4368.58,-1124 4368.58,-1124 4368.58,-1124 4216.7,-1124 4216.7,-1124"/>
<polygon fill="black" stroke="black" points="4216.7,-1120.5 4206.7,-1124 4216.7,-1127.5 4216.7,-1120.5"/>
</g>
<!-- concat_heads_12&#45;&gt;output_proj -->
<g id="edge238" class="edge">
<title>concat_heads_12&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M6313.08,-1218.5C6313.08,-1165.87 6313.08,-1071 6313.08,-1071 6313.08,-1071 4216.76,-1071 4216.76,-1071"/>
<polygon fill="black" stroke="black" points="4216.76,-1067.5 4206.76,-1071 4216.76,-1074.5 4216.76,-1067.5"/>
</g>
<!-- concat_heads_13&#45;&gt;output_proj -->
<g id="edge239" class="edge">
<title>concat_heads_13&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M6018.58,-1218.58C6018.58,-1167.75 6018.58,-1078 6018.58,-1078 6018.58,-1078 4216.71,-1078 4216.71,-1078"/>
<polygon fill="black" stroke="black" points="4216.71,-1074.5 4206.71,-1078 4216.71,-1081.5 4216.71,-1074.5"/>
</g>
<!-- concat_heads_14&#45;&gt;output_proj -->
<g id="edge240" class="edge">
<title>concat_heads_14&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M5849.58,-1218.54C5849.58,-1169.78 5849.58,-1086 5849.58,-1086 5849.58,-1086 4216.64,-1086 4216.64,-1086"/>
<polygon fill="black" stroke="black" points="4216.64,-1082.5 4206.64,-1086 4216.64,-1089.5 4216.64,-1082.5"/>
</g>
<!-- concat_heads_15&#45;&gt;output_proj -->
<g id="edge241" class="edge">
<title>concat_heads_15&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M5548.58,-1218.42C5548.58,-1171.5 5548.58,-1093 5548.58,-1093 5548.58,-1093 4216.65,-1093 4216.65,-1093"/>
<polygon fill="black" stroke="black" points="4216.65,-1089.5 4206.65,-1093 4216.65,-1096.5 4216.65,-1089.5"/>
</g>
<!-- output_proj&#45;&gt;residual1 -->
<g id="edge243" class="edge">
<title>output_proj&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M4062.46,-1071C3529.29,-1071 220.4,-1071 220.4,-1071 220.4,-1071 220.4,-963.64 220.4,-963.64"/>
<polygon fill="black" stroke="black" points="223.9,-963.64 220.4,-953.64 216.9,-963.64 223.9,-963.64"/>
</g>
<!-- ln2 -->
<g id="node149" class="node">
<title>ln2</title>
<polygon fill="lightyellow" stroke="black" points="3013.08,-746.84 2912.08,-746.84 2912.08,-693.84 3013.08,-693.84 3013.08,-746.84"/>
<text text-anchor="middle" x="2962.58" y="-731.64" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2962.58" y="-716.64" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="2962.58" y="-701.64" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;ln2 -->
<g id="edge244" class="edge">
<title>residual1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M231.04,-872.21C231.04,-823.98 231.04,-740 231.04,-740 231.04,-740 2901.95,-740 2901.95,-740"/>
<polygon fill="black" stroke="black" points="2901.95,-743.5 2911.95,-740 2901.95,-736.5 2901.95,-743.5"/>
</g>
<!-- output -->
<g id="node168" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="167.58" cy="-71.42" rx="71.34" ry="71.34"/>
<text text-anchor="middle" x="167.58" y="-82.72" font-family="Times,serif" font-size="14.00">Add</text>
<text text-anchor="middle" x="167.58" y="-67.72" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="167.58" y="-52.72" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;output -->
<g id="edge294" class="edge">
<title>residual1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M159.63,-834.16C159.63,-834.16 159.63,-152.63 159.63,-152.63"/>
<polygon fill="black" stroke="black" points="163.13,-152.63 159.63,-142.63 156.13,-152.63 163.13,-152.63"/>
</g>
<!-- gate -->
<g id="node150" class="node">
<title>gate</title>
<polygon fill="orange" stroke="black" points="3203.58,-606.84 3087.58,-606.84 3087.58,-553.84 3203.58,-553.84 3203.58,-606.84"/>
<text text-anchor="middle" x="3145.58" y="-591.64" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="3145.58" y="-576.64" font-family="Times,serif" font-size="14.00">[B, L, 8]</text>
<text text-anchor="middle" x="3145.58" y="-561.64" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln2&#45;&gt;gate -->
<g id="edge245" class="edge">
<title>ln2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M2986.08,-693.63C2986.08,-658.18 2986.08,-600 2986.08,-600 2986.08,-600 3077.55,-600 3077.55,-600"/>
<polygon fill="black" stroke="black" points="3077.55,-603.5 3087.55,-600 3077.55,-596.5 3077.55,-603.5"/>
</g>
<!-- expert_0 -->
<g id="node151" class="node">
<title>expert_0</title>
<polygon fill="lightgreen" stroke="black" points="3261.08,-452.84 2932.08,-452.84 2932.08,-384.84 3261.08,-384.84 3261.08,-452.84"/>
<text text-anchor="middle" x="3096.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3096.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="3096.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3096.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_0 -->
<g id="edge247" class="edge">
<title>ln2&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M2959.08,-693.58C2959.08,-693.58 2959.08,-463.28 2959.08,-463.28"/>
<polygon fill="black" stroke="black" points="2962.58,-463.28 2959.08,-453.28 2955.58,-463.28 2962.58,-463.28"/>
</g>
<!-- expert_1 -->
<g id="node152" class="node">
<title>expert_1</title>
<polygon fill="lightgreen" stroke="black" points="939.08,-452.84 610.08,-452.84 610.08,-384.84 939.08,-384.84 939.08,-452.84"/>
<text text-anchor="middle" x="774.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="774.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="774.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="774.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_1 -->
<g id="edge249" class="edge">
<title>ln2&#45;&gt;expert_1</title>
<path fill="none" stroke="black" d="M2912.03,-726C2596.19,-726 907.27,-726 907.27,-726 907.27,-726 907.27,-462.88 907.27,-462.88"/>
<polygon fill="black" stroke="black" points="910.77,-462.88 907.27,-452.88 903.77,-462.88 910.77,-462.88"/>
</g>
<!-- expert_2 -->
<g id="node153" class="node">
<title>expert_2</title>
<polygon fill="lightgreen" stroke="black" points="5583.08,-452.84 5254.08,-452.84 5254.08,-384.84 5583.08,-384.84 5583.08,-452.84"/>
<text text-anchor="middle" x="5418.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5418.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="5418.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5418.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_2 -->
<g id="edge251" class="edge">
<title>ln2&#45;&gt;expert_2</title>
<path fill="none" stroke="black" d="M3013.17,-729C3355.52,-729 5319.42,-729 5319.42,-729 5319.42,-729 5319.42,-462.92 5319.42,-462.92"/>
<polygon fill="black" stroke="black" points="5322.92,-462.92 5319.42,-452.92 5315.92,-462.92 5322.92,-462.92"/>
</g>
<!-- expert_3 -->
<g id="node154" class="node">
<title>expert_3</title>
<polygon fill="lightgreen" stroke="black" points="1713.08,-452.84 1384.08,-452.84 1384.08,-384.84 1713.08,-384.84 1713.08,-452.84"/>
<text text-anchor="middle" x="1548.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1548.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="1548.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1548.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_3 -->
<g id="edge253" class="edge">
<title>ln2&#45;&gt;expert_3</title>
<path fill="none" stroke="black" d="M2912.01,-713C2667.6,-713 1620.42,-713 1620.42,-713 1620.42,-713 1620.42,-462.87 1620.42,-462.87"/>
<polygon fill="black" stroke="black" points="1623.92,-462.87 1620.42,-452.87 1616.92,-462.87 1623.92,-462.87"/>
</g>
<!-- expert_4 -->
<g id="node155" class="node">
<title>expert_4</title>
<polygon fill="lightgreen" stroke="black" points="4809.08,-452.84 4480.08,-452.84 4480.08,-384.84 4809.08,-384.84 4809.08,-452.84"/>
<text text-anchor="middle" x="4644.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4644.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="4644.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4644.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_4 -->
<g id="edge255" class="edge">
<title>ln2&#45;&gt;expert_4</title>
<path fill="none" stroke="black" d="M3013.52,-717C3279.14,-717 4493.42,-717 4493.42,-717 4493.42,-717 4493.42,-463.04 4493.42,-463.04"/>
<polygon fill="black" stroke="black" points="4496.92,-463.04 4493.42,-453.04 4489.92,-463.04 4496.92,-463.04"/>
</g>
<!-- expert_5 -->
<g id="node156" class="node">
<title>expert_5</title>
<polygon fill="lightgreen" stroke="black" points="2874.08,-452.84 2545.08,-452.84 2545.08,-384.84 2874.08,-384.84 2874.08,-452.84"/>
<text text-anchor="middle" x="2709.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2709.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="2709.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2709.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_5 -->
<g id="edge257" class="edge">
<title>ln2&#45;&gt;expert_5</title>
<path fill="none" stroke="black" d="M2922.08,-693.77C2922.08,-619.99 2922.08,-418 2922.08,-418 2922.08,-418 2884.13,-418 2884.13,-418"/>
<polygon fill="black" stroke="black" points="2884.13,-414.5 2874.13,-418 2884.13,-421.5 2884.13,-414.5"/>
</g>
<!-- expert_6 -->
<g id="node157" class="node">
<title>expert_6</title>
<polygon fill="lightgreen" stroke="black" points="6357.08,-452.84 6028.08,-452.84 6028.08,-384.84 6357.08,-384.84 6357.08,-452.84"/>
<text text-anchor="middle" x="6192.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6192.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="6192.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="6192.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_6 -->
<g id="edge259" class="edge">
<title>ln2&#45;&gt;expert_6</title>
<path fill="none" stroke="black" d="M3013.12,-740C3419.42,-740 6138.75,-740 6138.75,-740 6138.75,-740 6138.75,-462.9 6138.75,-462.9"/>
<polygon fill="black" stroke="black" points="6142.25,-462.9 6138.75,-452.9 6135.25,-462.9 6142.25,-462.9"/>
</g>
<!-- expert_7 -->
<g id="node158" class="node">
<title>expert_7</title>
<polygon fill="lightgreen" stroke="black" points="4422.08,-452.84 4093.08,-452.84 4093.08,-384.84 4422.08,-384.84 4422.08,-452.84"/>
<text text-anchor="middle" x="4257.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4257.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="4257.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4257.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_7 -->
<g id="edge261" class="edge">
<title>ln2&#45;&gt;expert_7</title>
<path fill="none" stroke="black" d="M3013.26,-711C3242.19,-711 4168.75,-711 4168.75,-711 4168.75,-711 4168.75,-462.92 4168.75,-462.92"/>
<polygon fill="black" stroke="black" points="4172.25,-462.92 4168.75,-452.92 4165.25,-462.92 4172.25,-462.92"/>
</g>
<!-- expert_8 -->
<g id="node159" class="node">
<title>expert_8</title>
<polygon fill="lightgreen" stroke="black" points="2100.08,-452.84 1771.08,-452.84 1771.08,-384.84 2100.08,-384.84 2100.08,-452.84"/>
<text text-anchor="middle" x="1935.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1935.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="1935.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1935.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_8 -->
<g id="edge263" class="edge">
<title>ln2&#45;&gt;expert_8</title>
<path fill="none" stroke="black" d="M2911.93,-707C2724.27,-707 2079.42,-707 2079.42,-707 2079.42,-707 2079.42,-463.02 2079.42,-463.02"/>
<polygon fill="black" stroke="black" points="2082.92,-463.02 2079.42,-453.02 2075.92,-463.02 2082.92,-463.02"/>
</g>
<!-- expert_9 -->
<g id="node160" class="node">
<title>expert_9</title>
<polygon fill="lightgreen" stroke="black" points="5196.08,-452.84 4867.08,-452.84 4867.08,-384.84 5196.08,-384.84 5196.08,-452.84"/>
<text text-anchor="middle" x="5031.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5031.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="5031.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5031.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_9 -->
<g id="edge265" class="edge">
<title>ln2&#45;&gt;expert_9</title>
<path fill="none" stroke="black" d="M3013.27,-723C3323.47,-723 4952.42,-723 4952.42,-723 4952.42,-723 4952.42,-462.84 4952.42,-462.84"/>
<polygon fill="black" stroke="black" points="4955.92,-462.84 4952.42,-452.84 4948.92,-462.84 4955.92,-462.84"/>
</g>
<!-- expert_10 -->
<g id="node161" class="node">
<title>expert_10</title>
<polygon fill="lightgreen" stroke="black" points="3648.08,-452.84 3319.08,-452.84 3319.08,-384.84 3648.08,-384.84 3648.08,-452.84"/>
<text text-anchor="middle" x="3483.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3483.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="3483.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3483.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_10 -->
<g id="edge267" class="edge">
<title>ln2&#45;&gt;expert_10</title>
<path fill="none" stroke="black" d="M3013.29,-699C3136.31,-699 3440.58,-699 3440.58,-699 3440.58,-699 3440.58,-462.91 3440.58,-462.91"/>
<polygon fill="black" stroke="black" points="3444.08,-462.91 3440.58,-452.91 3437.08,-462.91 3444.08,-462.91"/>
</g>
<!-- expert_11 -->
<g id="node162" class="node">
<title>expert_11</title>
<polygon fill="lightgreen" stroke="black" points="1326.08,-452.84 997.08,-452.84 997.08,-384.84 1326.08,-384.84 1326.08,-452.84"/>
<text text-anchor="middle" x="1161.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1161.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="1161.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="1161.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_11 -->
<g id="edge269" class="edge">
<title>ln2&#45;&gt;expert_11</title>
<path fill="none" stroke="black" d="M2911.78,-720C2630.85,-720 1280.27,-720 1280.27,-720 1280.27,-720 1280.27,-463.09 1280.27,-463.09"/>
<polygon fill="black" stroke="black" points="1283.77,-463.09 1280.27,-453.09 1276.77,-463.09 1283.77,-463.09"/>
</g>
<!-- expert_12 -->
<g id="node163" class="node">
<title>expert_12</title>
<polygon fill="lightgreen" stroke="black" points="2487.08,-452.84 2158.08,-452.84 2158.08,-384.84 2487.08,-384.84 2487.08,-452.84"/>
<text text-anchor="middle" x="2322.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2322.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="2322.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="2322.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_12 -->
<g id="edge271" class="edge">
<title>ln2&#45;&gt;expert_12</title>
<path fill="none" stroke="black" d="M2912.06,-700C2770.74,-700 2381.75,-700 2381.75,-700 2381.75,-700 2381.75,-463.03 2381.75,-463.03"/>
<polygon fill="black" stroke="black" points="2385.25,-463.03 2381.75,-453.03 2378.25,-463.03 2385.25,-463.03"/>
</g>
<!-- expert_13 -->
<g id="node164" class="node">
<title>expert_13</title>
<polygon fill="lightgreen" stroke="black" points="552.08,-452.84 223.08,-452.84 223.08,-384.84 552.08,-384.84 552.08,-452.84"/>
<text text-anchor="middle" x="387.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="387.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="387.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="387.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_13 -->
<g id="edge273" class="edge">
<title>ln2&#45;&gt;expert_13</title>
<path fill="none" stroke="black" d="M2911.95,-733C2560.45,-733 497.75,-733 497.75,-733 497.75,-733 497.75,-463.05 497.75,-463.05"/>
<polygon fill="black" stroke="black" points="501.25,-463.05 497.75,-453.05 494.25,-463.05 501.25,-463.05"/>
</g>
<!-- expert_14 -->
<g id="node165" class="node">
<title>expert_14</title>
<polygon fill="lightgreen" stroke="black" points="4035.08,-452.84 3706.08,-452.84 3706.08,-384.84 4035.08,-384.84 4035.08,-452.84"/>
<text text-anchor="middle" x="3870.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3870.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="3870.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3870.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_14 -->
<g id="edge275" class="edge">
<title>ln2&#45;&gt;expert_14</title>
<path fill="none" stroke="black" d="M3013.13,-705C3181.85,-705 3715.08,-705 3715.08,-705 3715.08,-705 3715.08,-463.07 3715.08,-463.07"/>
<polygon fill="black" stroke="black" points="3718.58,-463.07 3715.08,-453.07 3711.58,-463.07 3718.58,-463.07"/>
</g>
<!-- expert_15 -->
<g id="node166" class="node">
<title>expert_15</title>
<polygon fill="lightgreen" stroke="black" points="5970.08,-452.84 5641.08,-452.84 5641.08,-384.84 5970.08,-384.84 5970.08,-452.84"/>
<text text-anchor="middle" x="5805.58" y="-437.64" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5805.58" y="-422.64" font-family="Times,serif" font-size="14.00">[B, L, 8192] &#45;&gt; [B, L, 32768] &#45;&gt; [B, L, 8192]</text>
<text text-anchor="middle" x="5805.58" y="-407.64" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5805.58" y="-392.64" font-family="Times,serif" font-size="14.00">FFN Column+Row Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_15 -->
<g id="edge277" class="edge">
<title>ln2&#45;&gt;expert_15</title>
<path fill="none" stroke="black" d="M3013.24,-735C3385.21,-735 5679.75,-735 5679.75,-735 5679.75,-735 5679.75,-462.97 5679.75,-462.97"/>
<polygon fill="black" stroke="black" points="5683.25,-462.97 5679.75,-452.97 5676.25,-462.97 5683.25,-462.97"/>
</g>
<!-- gate&#45;&gt;expert_0 -->
<g id="edge246" class="edge">
<title>gate&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3145.58,-553.67C3145.58,-553.67 3145.58,-462.85 3145.58,-462.85"/>
<polygon fill="black" stroke="black" points="3149.08,-462.85 3145.58,-452.85 3142.08,-462.85 3149.08,-462.85"/>
<text text-anchor="middle" x="3200.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 0</text>
</g>
<!-- gate&#45;&gt;expert_1 -->
<g id="edge248" class="edge">
<title>gate&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.57,-589C2737.61,-589 923.18,-589 923.18,-589 923.18,-589 923.18,-462.86 923.18,-462.86"/>
<polygon fill="black" stroke="black" points="926.68,-462.86 923.18,-452.86 919.68,-462.86 926.68,-462.86"/>
<text text-anchor="middle" x="1497.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 0</text>
</g>
<!-- gate&#45;&gt;expert_2 -->
<g id="edge250" class="edge">
<title>gate&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.7,-589C3546.28,-589 5287.25,-589 5287.25,-589 5287.25,-589 5287.25,-462.86 5287.25,-462.86"/>
<polygon fill="black" stroke="black" points="5290.75,-462.86 5287.25,-452.86 5283.75,-462.86 5290.75,-462.86"/>
<text text-anchor="middle" x="4843.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 1</text>
</g>
<!-- gate&#45;&gt;expert_3 -->
<g id="edge252" class="edge">
<title>gate&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.16,-577C2812.93,-577 1666.75,-577 1666.75,-577 1666.75,-577 1666.75,-463.15 1666.75,-463.15"/>
<polygon fill="black" stroke="black" points="1670.25,-463.15 1666.75,-453.15 1663.25,-463.15 1670.25,-463.15"/>
<text text-anchor="middle" x="2179.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 1</text>
</g>
<!-- gate&#45;&gt;expert_4 -->
<g id="edge254" class="edge">
<title>gate&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.64,-577C3461.07,-577 4486.75,-577 4486.75,-577 4486.75,-577 4486.75,-463.15 4486.75,-463.15"/>
<polygon fill="black" stroke="black" points="4490.25,-463.15 4486.75,-453.15 4483.25,-463.15 4490.25,-463.15"/>
<text text-anchor="middle" x="4093.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 2</text>
</g>
<!-- gate&#45;&gt;expert_5 -->
<g id="edge256" class="edge">
<title>gate&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.28,-559C2998.94,-559 2841.33,-559 2841.33,-559 2841.33,-559 2841.33,-463.12 2841.33,-463.12"/>
<polygon fill="black" stroke="black" points="2844.83,-463.12 2841.33,-453.12 2837.83,-463.12 2844.83,-463.12"/>
<text text-anchor="middle" x="3028.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 2</text>
</g>
<!-- gate&#45;&gt;expert_6 -->
<g id="edge258" class="edge">
<title>gate&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.61,-600C3615.7,-600 6083.42,-600 6083.42,-600 6083.42,-600 6083.42,-462.91 6083.42,-462.91"/>
<polygon fill="black" stroke="black" points="6086.92,-462.91 6083.42,-452.91 6079.92,-462.91 6086.92,-462.91"/>
<text text-anchor="middle" x="5616.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 3</text>
</g>
<!-- gate&#45;&gt;expert_7 -->
<g id="edge260" class="edge">
<title>gate&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.91,-571C3415.57,-571 4130.92,-571 4130.92,-571 4130.92,-571 4130.92,-462.98 4130.92,-462.98"/>
<polygon fill="black" stroke="black" points="4134.42,-462.98 4130.92,-452.98 4127.42,-462.98 4134.42,-462.98"/>
<text text-anchor="middle" x="3781.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 3</text>
</g>
<!-- gate&#45;&gt;expert_8 -->
<g id="edge262" class="edge">
<title>gate&#45;&gt;expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.31,-571C2865.97,-571 2089.75,-571 2089.75,-571 2089.75,-571 2089.75,-462.98 2089.75,-462.98"/>
<polygon fill="black" stroke="black" points="2093.25,-462.98 2089.75,-452.98 2086.25,-462.98 2093.25,-462.98"/>
<text text-anchor="middle" x="2533.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 4</text>
</g>
<!-- gate&#45;&gt;expert_9 -->
<g id="edge264" class="edge">
<title>gate&#45;&gt;expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.78,-583C3508.86,-583 4909.75,-583 4909.75,-583 4909.75,-583 4909.75,-462.85 4909.75,-462.85"/>
<polygon fill="black" stroke="black" points="4913.25,-462.85 4909.75,-452.85 4906.25,-462.85 4913.25,-462.85"/>
<text text-anchor="middle" x="4461.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 4</text>
</g>
<!-- gate&#45;&gt;expert_10 -->
<g id="edge266" class="edge">
<title>gate&#45;&gt;expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.65,-559C3278.77,-559 3400.08,-559 3400.08,-559 3400.08,-559 3400.08,-463.12 3400.08,-463.12"/>
<polygon fill="black" stroke="black" points="3403.58,-463.12 3400.08,-453.12 3396.58,-463.12 3403.58,-463.12"/>
<text text-anchor="middle" x="3372.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 5</text>
</g>
<!-- gate&#45;&gt;expert_11 -->
<g id="edge268" class="edge">
<title>gate&#45;&gt;expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.4,-583C2774.23,-583 1303.18,-583 1303.18,-583 1303.18,-583 1303.18,-462.85 1303.18,-462.85"/>
<polygon fill="black" stroke="black" points="1306.68,-462.85 1303.18,-452.85 1299.68,-462.85 1306.68,-462.85"/>
<text text-anchor="middle" x="1846.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 5</text>
</g>
<!-- gate&#45;&gt;expert_12 -->
<g id="edge270" class="edge">
<title>gate&#45;&gt;expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.39,-565C2917.54,-565 2434.42,-565 2434.42,-565 2434.42,-565 2434.42,-463.1 2434.42,-463.1"/>
<polygon fill="black" stroke="black" points="2437.92,-463.1 2434.42,-453.1 2430.92,-463.1 2437.92,-463.1"/>
<text text-anchor="middle" x="2791.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 6</text>
</g>
<!-- gate&#45;&gt;expert_13 -->
<g id="edge272" class="edge">
<title>gate&#45;&gt;expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3087.48,-595C2701.66,-595 524.92,-595 524.92,-595 524.92,-595 524.92,-463.22 524.92,-463.22"/>
<polygon fill="black" stroke="black" points="528.42,-463.22 524.92,-453.22 521.42,-463.22 528.42,-463.22"/>
<text text-anchor="middle" x="1072.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 6</text>
</g>
<!-- gate&#45;&gt;expert_14 -->
<g id="edge274" class="edge">
<title>gate&#45;&gt;expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.66,-565C3347.84,-565 3710.58,-565 3710.58,-565 3710.58,-565 3710.58,-463.1 3710.58,-463.1"/>
<polygon fill="black" stroke="black" points="3714.08,-463.1 3710.58,-453.1 3707.08,-463.1 3714.08,-463.1"/>
<text text-anchor="middle" x="3544.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 7</text>
</g>
<!-- gate&#45;&gt;expert_15 -->
<g id="edge276" class="edge">
<title>gate&#45;&gt;expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3203.74,-595C3580.52,-595 5660.42,-595 5660.42,-595 5660.42,-595 5660.42,-463.22 5660.42,-463.22"/>
<polygon fill="black" stroke="black" points="5663.92,-463.22 5660.42,-453.22 5656.92,-463.22 5663.92,-463.22"/>
<text text-anchor="middle" x="5229.08" y="-499.64" font-family="Times,serif" font-size="14.00">Route Expert 7</text>
</g>
<!-- expert_agg -->
<g id="node167" class="node">
<title>expert_agg</title>
<polygon fill="lightsteelblue" stroke="black" stroke-dasharray="5,2" points="3175.58,-297.84 3017.58,-297.84 3017.58,-229.84 3175.58,-229.84 3175.58,-297.84"/>
<text text-anchor="middle" x="3096.58" y="-282.64" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3096.58" y="-267.64" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="3096.58" y="-252.64" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="3096.58" y="-237.64" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- expert_0&#45;&gt;expert_agg -->
<g id="edge278" class="edge">
<title>expert_0&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3096.58,-384.82C3096.58,-384.82 3096.58,-308.04 3096.58,-308.04"/>
<polygon fill="black" stroke="black" points="3100.08,-308.04 3096.58,-298.04 3093.08,-308.04 3100.08,-308.04"/>
</g>
<!-- expert_1&#45;&gt;expert_agg -->
<g id="edge279" class="edge">
<title>expert_1&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M774.58,-384.67C774.58,-335.86 774.58,-252 774.58,-252 774.58,-252 3007.33,-252 3007.33,-252"/>
<polygon fill="black" stroke="black" points="3007.33,-255.5 3017.33,-252 3007.33,-248.5 3007.33,-255.5"/>
</g>
<!-- expert_2&#45;&gt;expert_agg -->
<g id="edge280" class="edge">
<title>expert_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5418.58,-384.67C5418.58,-335.86 5418.58,-252 5418.58,-252 5418.58,-252 3185.84,-252 3185.84,-252"/>
<polygon fill="black" stroke="black" points="3185.84,-248.5 3175.84,-252 3185.84,-255.5 3185.84,-248.5"/>
</g>
<!-- expert_3&#45;&gt;expert_agg -->
<g id="edge281" class="edge">
<title>expert_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1548.58,-384.76C1548.58,-339.99 1548.58,-267 1548.58,-267 1548.58,-267 3007.42,-267 3007.42,-267"/>
<polygon fill="black" stroke="black" points="3007.42,-270.5 3017.42,-267 3007.42,-263.5 3007.42,-270.5"/>
</g>
<!-- expert_4&#45;&gt;expert_agg -->
<g id="edge282" class="edge">
<title>expert_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4644.58,-384.76C4644.58,-339.99 4644.58,-267 4644.58,-267 4644.58,-267 3185.75,-267 3185.75,-267"/>
<polygon fill="black" stroke="black" points="3185.75,-263.5 3175.75,-267 3185.75,-270.5 3185.75,-263.5"/>
</g>
<!-- expert_5&#45;&gt;expert_agg -->
<g id="edge283" class="edge">
<title>expert_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2709.58,-384.65C2709.58,-346.48 2709.58,-290 2709.58,-290 2709.58,-290 3007.34,-290 3007.34,-290"/>
<polygon fill="black" stroke="black" points="3007.34,-293.5 3017.34,-290 3007.34,-286.5 3007.34,-293.5"/>
</g>
<!-- expert_6&#45;&gt;expert_agg -->
<g id="edge284" class="edge">
<title>expert_6&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6192.58,-384.63C6192.58,-331.96 6192.58,-237 6192.58,-237 6192.58,-237 3185.83,-237 3185.83,-237"/>
<polygon fill="black" stroke="black" points="3185.83,-233.5 3175.83,-237 3185.83,-240.5 3185.83,-233.5"/>
</g>
<!-- expert_7&#45;&gt;expert_agg -->
<g id="edge285" class="edge">
<title>expert_7&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4257.58,-384.75C4257.58,-342.21 4257.58,-275 4257.58,-275 4257.58,-275 3185.93,-275 3185.93,-275"/>
<polygon fill="black" stroke="black" points="3185.93,-271.5 3175.93,-275 3185.93,-278.5 3185.93,-271.5"/>
</g>
<!-- expert_8&#45;&gt;expert_agg -->
<g id="edge286" class="edge">
<title>expert_8&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1935.58,-384.75C1935.58,-342.21 1935.58,-275 1935.58,-275 1935.58,-275 3007.24,-275 3007.24,-275"/>
<polygon fill="black" stroke="black" points="3007.24,-278.5 3017.24,-275 3007.24,-271.5 3007.24,-278.5"/>
</g>
<!-- expert_9&#45;&gt;expert_agg -->
<g id="edge287" class="edge">
<title>expert_9&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5031.58,-384.76C5031.58,-338.09 5031.58,-260 5031.58,-260 5031.58,-260 3185.74,-260 3185.74,-260"/>
<polygon fill="black" stroke="black" points="3185.74,-256.5 3175.74,-260 3185.74,-263.5 3185.74,-256.5"/>
</g>
<!-- expert_10&#45;&gt;expert_agg -->
<g id="edge288" class="edge">
<title>expert_10&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3483.58,-384.65C3483.58,-346.48 3483.58,-290 3483.58,-290 3483.58,-290 3185.83,-290 3185.83,-290"/>
<polygon fill="black" stroke="black" points="3185.83,-286.5 3175.83,-290 3185.83,-293.5 3185.83,-286.5"/>
</g>
<!-- expert_11&#45;&gt;expert_agg -->
<g id="edge289" class="edge">
<title>expert_11&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1161.58,-384.76C1161.58,-338.09 1161.58,-260 1161.58,-260 1161.58,-260 3007.43,-260 3007.43,-260"/>
<polygon fill="black" stroke="black" points="3007.43,-263.5 3017.43,-260 3007.43,-256.5 3007.43,-263.5"/>
</g>
<!-- expert_12&#45;&gt;expert_agg -->
<g id="edge290" class="edge">
<title>expert_12&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2322.58,-384.66C2322.58,-344.13 2322.58,-282 2322.58,-282 2322.58,-282 3007.39,-282 3007.39,-282"/>
<polygon fill="black" stroke="black" points="3007.39,-285.5 3017.39,-282 3007.39,-278.5 3007.39,-285.5"/>
</g>
<!-- expert_13&#45;&gt;expert_agg -->
<g id="edge291" class="edge">
<title>expert_13&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M395.54,-384.71C395.54,-333.83 395.54,-244 395.54,-244 395.54,-244 3007.57,-244 3007.57,-244"/>
<polygon fill="black" stroke="black" points="3007.57,-247.5 3017.57,-244 3007.57,-240.5 3007.57,-247.5"/>
</g>
<!-- expert_14&#45;&gt;expert_agg -->
<g id="edge292" class="edge">
<title>expert_14&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3870.58,-384.66C3870.58,-344.13 3870.58,-282 3870.58,-282 3870.58,-282 3185.78,-282 3185.78,-282"/>
<polygon fill="black" stroke="black" points="3185.78,-278.5 3175.78,-282 3185.78,-285.5 3185.78,-278.5"/>
</g>
<!-- expert_15&#45;&gt;expert_agg -->
<g id="edge293" class="edge">
<title>expert_15&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5805.58,-384.71C5805.58,-333.83 5805.58,-244 5805.58,-244 5805.58,-244 3185.83,-244 3185.83,-244"/>
<polygon fill="black" stroke="black" points="3185.83,-240.5 3175.83,-244 3185.83,-247.5 3185.83,-240.5"/>
</g>
<!-- expert_agg&#45;&gt;output -->
<g id="edge295" class="edge">
<title>expert_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3017.33,-237C2555.41,-237 231.04,-237 231.04,-237 231.04,-237 231.04,-114.53 231.04,-114.53"/>
<polygon fill="black" stroke="black" points="234.54,-114.53 231.04,-104.53 227.54,-114.53 234.54,-114.53"/>
</g>
</g>
</svg>
