<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Transformer_16GPUs Pages: 1 -->
<svg width="1800pt" height="1008pt"
 viewBox="0.00 0.00 1800.00 1007.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 12627.68)">
<title>MoE_Transformer_16GPUs</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-12627.68 22559.15,-12627.68 22559.15,4 -4,4"/>
<g id="clust17" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9768.57,-12412.68 9768.57,-12615.68 14822.57,-12615.68 14822.57,-12412.68 9768.57,-12412.68"/>
<text text-anchor="middle" x="12295.57" y="-12600.48" font-family="Times,serif" font-size="14.00">Input Embedding</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11632.57,-8 11632.57,-330.17 17870.57,-330.17 17870.57,-8 11632.57,-8"/>
<text text-anchor="middle" x="14751.57" y="-314.97" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input_tensor -->
<g id="node1" class="node">
<title>input_tensor</title>
<polygon fill="lightblue" stroke="black" points="14814.57,-12584.68 14594.57,-12584.68 14594.57,-12546.68 14814.57,-12546.68 14814.57,-12584.68"/>
<text text-anchor="middle" x="14704.57" y="-12569.48" font-family="Times,serif" font-size="14.00">Input Tensor</text>
<text text-anchor="middle" x="14704.57" y="-12554.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- embed_0 -->
<g id="node2" class="node">
<title>embed_0</title>
<ellipse fill="yellow" stroke="black" cx="9925.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="9925.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="9925.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9925.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input_tensor&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M14594.38,-12564.35C13965.65,-12562.39 10844.99,-12551.55 10417.57,-12528.68 10268.62,-12520.72 10230.77,-12519.85 10083.57,-12495.68 10069.24,-12493.33 10054.27,-12490.44 10039.49,-12487.33"/>
<polygon fill="black" stroke="black" points="10039.82,-12483.82 10029.31,-12485.15 10038.35,-12490.67 10039.82,-12483.82"/>
<text text-anchor="middle" x="10470.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_1 -->
<g id="node3" class="node">
<title>embed_1</title>
<ellipse fill="yellow" stroke="black" cx="10241.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10241.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10241.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10241.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_1 -->
<g id="edge2" class="edge">
<title>input_tensor&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M14594.53,-12564.27C13994.25,-12561.97 11127.71,-12549.9 10733.57,-12528.68 10584.62,-12520.67 10546.77,-12519.85 10399.57,-12495.68 10385.24,-12493.33 10370.27,-12490.44 10355.49,-12487.33"/>
<polygon fill="black" stroke="black" points="10355.82,-12483.82 10345.31,-12485.15 10354.35,-12490.67 10355.82,-12483.82"/>
<text text-anchor="middle" x="10786.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_2 -->
<g id="node4" class="node">
<title>embed_2</title>
<ellipse fill="yellow" stroke="black" cx="10557.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10557.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10557.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10557.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_2 -->
<g id="edge3" class="edge">
<title>input_tensor&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M14594.38,-12564.92C14063.4,-12565.84 11765.2,-12567.48 11049.57,-12528.68 10900.62,-12520.61 10862.77,-12519.85 10715.57,-12495.68 10701.24,-12493.33 10686.27,-12490.44 10671.49,-12487.33"/>
<polygon fill="black" stroke="black" points="10671.82,-12483.82 10661.31,-12485.15 10670.35,-12490.67 10671.82,-12483.82"/>
<text text-anchor="middle" x="11102.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_3 -->
<g id="node5" class="node">
<title>embed_3</title>
<ellipse fill="yellow" stroke="black" cx="10873.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="10873.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="10873.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10873.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_3 -->
<g id="edge4" class="edge">
<title>input_tensor&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M14594.45,-12564.8C14092.17,-12565.11 12015.16,-12564.21 11365.57,-12528.68 11216.63,-12520.54 11178.77,-12519.85 11031.57,-12495.68 11017.24,-12493.33 11002.27,-12490.44 10987.49,-12487.33"/>
<polygon fill="black" stroke="black" points="10987.82,-12483.82 10977.31,-12485.15 10986.35,-12490.67 10987.82,-12483.82"/>
<text text-anchor="middle" x="11418.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_4 -->
<g id="node6" class="node">
<title>embed_4</title>
<ellipse fill="yellow" stroke="black" cx="11189.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11189.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11189.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11189.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_4 -->
<g id="edge5" class="edge">
<title>input_tensor&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M14594.37,-12564.65C14121.92,-12564.32 12265.25,-12560.93 11681.57,-12528.68 11532.63,-12520.45 11494.77,-12519.85 11347.57,-12495.68 11333.24,-12493.33 11318.27,-12490.44 11303.49,-12487.33"/>
<polygon fill="black" stroke="black" points="11303.82,-12483.82 11293.31,-12485.15 11302.35,-12490.67 11303.82,-12483.82"/>
<text text-anchor="middle" x="11734.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_5 -->
<g id="node7" class="node">
<title>embed_5</title>
<ellipse fill="yellow" stroke="black" cx="11505.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11505.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11505.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11505.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_5 -->
<g id="edge6" class="edge">
<title>input_tensor&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M14594.53,-12564.48C14153.78,-12563.46 12514.87,-12557.76 11996.57,-12528.68 11848.08,-12520.35 11810.33,-12519.8 11663.57,-12495.68 11649.24,-12493.33 11634.27,-12490.44 11619.49,-12487.33"/>
<polygon fill="black" stroke="black" points="11619.82,-12483.82 11609.31,-12485.14 11618.35,-12490.66 11619.82,-12483.82"/>
<text text-anchor="middle" x="12049.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_6 -->
<g id="node8" class="node">
<title>embed_6</title>
<ellipse fill="yellow" stroke="black" cx="11821.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11821.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="11821.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11821.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_6 -->
<g id="edge7" class="edge">
<title>input_tensor&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M14594.44,-12564.25C14187.02,-12562.47 12765.45,-12554.49 12312.57,-12528.68 12164.09,-12520.22 12126.33,-12519.8 11979.57,-12495.68 11965.24,-12493.33 11950.27,-12490.44 11935.49,-12487.33"/>
<polygon fill="black" stroke="black" points="11935.82,-12483.82 11925.31,-12485.14 11934.35,-12490.66 11935.82,-12483.82"/>
<text text-anchor="middle" x="12365.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_7 -->
<g id="node9" class="node">
<title>embed_7</title>
<ellipse fill="yellow" stroke="black" cx="12137.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12137.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12137.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12137.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_7 -->
<g id="edge8" class="edge">
<title>input_tensor&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M14594.31,-12563.95C14222.59,-12561.3 13017.14,-12551.15 12629.57,-12528.68 12480.66,-12520.05 12442.77,-12519.85 12295.57,-12495.68 12281.24,-12493.33 12266.27,-12490.44 12251.49,-12487.33"/>
<polygon fill="black" stroke="black" points="12251.82,-12483.82 12241.31,-12485.15 12250.35,-12490.67 12251.82,-12483.82"/>
<text text-anchor="middle" x="12682.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_8 -->
<g id="node10" class="node">
<title>embed_8</title>
<ellipse fill="yellow" stroke="black" cx="12453.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12453.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12453.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12453.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_8 -->
<g id="edge9" class="edge">
<title>input_tensor&#45;&gt;embed_8</title>
<path fill="none" stroke="black" d="M14594.53,-12565.37C14317.75,-12566.46 13570.3,-12565.44 12948.57,-12528.68 12798.34,-12519.8 12760.09,-12520 12611.57,-12495.68 12597.24,-12493.34 12582.27,-12490.45 12567.49,-12487.34"/>
<polygon fill="black" stroke="black" points="12567.82,-12483.83 12557.31,-12485.16 12566.35,-12490.68 12567.82,-12483.83"/>
<text text-anchor="middle" x="13001.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_9 -->
<g id="node11" class="node">
<title>embed_9</title>
<ellipse fill="yellow" stroke="black" cx="12769.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12769.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="12769.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12769.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_9 -->
<g id="edge10" class="edge">
<title>input_tensor&#45;&gt;embed_9</title>
<path fill="none" stroke="black" d="M14594.34,-12564.56C14353.9,-12563.71 13764.36,-12558.47 13271.57,-12528.68 13118.26,-12519.42 13079.17,-12520.36 12927.57,-12495.68 12913.24,-12493.35 12898.26,-12490.48 12883.49,-12487.37"/>
<polygon fill="black" stroke="black" points="12883.81,-12483.86 12873.3,-12485.19 12882.35,-12490.71 12883.81,-12483.86"/>
<text text-anchor="middle" x="13324.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_10 -->
<g id="node12" class="node">
<title>embed_10</title>
<ellipse fill="yellow" stroke="black" cx="13085.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13085.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13085.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="13085.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_10 -->
<g id="edge11" class="edge">
<title>input_tensor&#45;&gt;embed_10</title>
<path fill="none" stroke="black" d="M14594.4,-12563.21C14396.2,-12560.08 13966.44,-12551.13 13604.57,-12528.68 13443.77,-12518.71 13402.65,-12521.21 13243.57,-12495.68 13229.23,-12493.38 13214.25,-12490.53 13199.48,-12487.43"/>
<polygon fill="black" stroke="black" points="13199.8,-12483.92 13189.29,-12485.26 13198.34,-12490.77 13199.8,-12483.92"/>
<text text-anchor="middle" x="13657.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_11 -->
<g id="node13" class="node">
<title>embed_11</title>
<ellipse fill="yellow" stroke="black" cx="13401.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13401.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13401.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="13401.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_11 -->
<g id="edge12" class="edge">
<title>input_tensor&#45;&gt;embed_11</title>
<path fill="none" stroke="black" d="M14594.42,-12565.45C14389.36,-12565.23 13935.71,-12557.06 13559.57,-12495.68 13545.24,-12493.34 13530.26,-12490.47 13515.49,-12487.36"/>
<polygon fill="black" stroke="black" points="13515.81,-12483.85 13505.3,-12485.18 13514.35,-12490.69 13515.81,-12483.85"/>
<text text-anchor="middle" x="13860.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_12 -->
<g id="node14" class="node">
<title>embed_12</title>
<ellipse fill="yellow" stroke="black" cx="13717.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13717.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="13717.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13717.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_12 -->
<g id="edge13" class="edge">
<title>input_tensor&#45;&gt;embed_12</title>
<path fill="none" stroke="black" d="M14594.57,-12561.28C14435.12,-12555.04 14130.92,-12538.26 13875.57,-12495.68 13861.36,-12493.31 13846.51,-12490.43 13831.85,-12487.34"/>
<polygon fill="black" stroke="black" points="13832.26,-12483.85 13821.75,-12485.17 13830.79,-12490.69 13832.26,-12483.85"/>
<text text-anchor="middle" x="14177.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_13 -->
<g id="node15" class="node">
<title>embed_13</title>
<ellipse fill="yellow" stroke="black" cx="14033.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14033.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14033.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="14033.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_13 -->
<g id="edge14" class="edge">
<title>input_tensor&#45;&gt;embed_13</title>
<path fill="none" stroke="black" d="M14594.46,-12553.25C14490.22,-12541.63 14329.56,-12521.65 14191.57,-12495.68 14177.75,-12493.08 14163.3,-12490.11 14149,-12487"/>
<polygon fill="black" stroke="black" points="14149.65,-12483.56 14139.13,-12484.83 14148.15,-12490.4 14149.65,-12483.56"/>
<text text-anchor="middle" x="14440.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_14 -->
<g id="node16" class="node">
<title>embed_14</title>
<ellipse fill="yellow" stroke="black" cx="14349.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14349.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14349.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="14349.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_14 -->
<g id="edge15" class="edge">
<title>input_tensor&#45;&gt;embed_14</title>
<path fill="none" stroke="black" d="M14639.37,-12546.66C14619.21,-12541 14596.95,-12534.67 14576.57,-12528.68 14535.47,-12516.61 14490.32,-12502.89 14451.19,-12490.84"/>
<polygon fill="black" stroke="black" points="14451.96,-12487.42 14441.38,-12487.81 14449.9,-12494.11 14451.96,-12487.42"/>
<text text-anchor="middle" x="14629.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- embed_15 -->
<g id="node17" class="node">
<title>embed_15</title>
<ellipse fill="yellow" stroke="black" cx="14665.57" cy="-12458.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14665.57" y="-12469.48" font-family="Times,serif" font-size="14.00">Embedding Slice</text>
<text text-anchor="middle" x="14665.57" y="-12454.48" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14665.57" y="-12439.48" font-family="Times,serif" font-size="14.00">[D/mn=512, V=vocab_size]</text>
</g>
<!-- input_tensor&#45;&gt;embed_15 -->
<g id="edge16" class="edge">
<title>input_tensor&#45;&gt;embed_15</title>
<path fill="none" stroke="black" d="M14697.78,-12546.31C14693.56,-12534.88 14687.92,-12519.64 14682.55,-12505.1"/>
<polygon fill="black" stroke="black" points="14685.82,-12503.86 14679.07,-12495.69 14679.25,-12506.29 14685.82,-12503.86"/>
<text text-anchor="middle" x="14743.07" y="-12517.48" font-family="Times,serif" font-size="14.00">Gather indices</text>
</g>
<!-- residual_0 -->
<g id="node51" class="node">
<title>residual_0</title>
<ellipse fill="none" stroke="black" cx="15121.57" cy="-10709.14" rx="58.5" ry="18"/>
<text text-anchor="middle" x="15121.57" y="-10705.44" font-family="Times,serif" font-size="14.00">residual_0</text>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge49" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14674.3,-12546.66C14743.55,-12532 14842.57,-12505.76 14842.57,-12459.18 14842.57,-12459.18 14842.57,-12459.18 14842.57,-10816.14 14842.57,-10773.25 14842.57,-10720.6 15053.07,-10711.51"/>
<polygon fill="black" stroke="black" points="15053.39,-10715 15063.25,-10711.11 15053.12,-10708 15053.39,-10715"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge50" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14690.22,-12546.66C14761.55,-12532 14860.57,-12505.76 14860.57,-12459.18 14860.57,-12459.18 14860.57,-12459.18 14860.57,-10816.14 14860.57,-10773.56 14860.57,-10721.37 15053.21,-10711.71"/>
<polygon fill="black" stroke="black" points="15053.61,-10715.2 15063.44,-10711.25 15053.29,-10708.21 15053.61,-10715.2"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge51" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14706.13,-12546.66C14779.55,-12532 14878.57,-12505.76 14878.57,-12459.18 14878.57,-12459.18 14878.57,-12459.18 14878.57,-10816.14 14878.57,-10773.94 14878.57,-10722.3 15053.17,-10711.98"/>
<polygon fill="black" stroke="black" points="15053.47,-10715.47 15063.26,-10711.44 15053.09,-10708.48 15053.47,-10715.47"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge52" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14722.05,-12546.66C14797.55,-12532 14896.57,-12505.76 14896.57,-12459.18 14896.57,-12459.18 14896.57,-12459.18 14896.57,-10816.14 14896.57,-10774.36 14896.57,-10723.33 15053.44,-10712.3"/>
<polygon fill="black" stroke="black" points="15053.74,-10715.79 15063.5,-10711.66 15053.3,-10708.8 15053.74,-10715.79"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge53" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14737.97,-12546.66C14815.55,-12532 14914.57,-12505.76 14914.57,-12459.18 14914.57,-12459.18 14914.57,-12459.18 14914.57,-10816.14 14914.57,-10774.89 14914.57,-10724.62 15053.47,-10712.74"/>
<polygon fill="black" stroke="black" points="15054.01,-10716.21 15063.71,-10711.95 15053.48,-10709.23 15054.01,-10716.21"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge54" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14753.88,-12546.66C14833.55,-12532 14932.57,-12505.76 14932.57,-12459.18 14932.57,-12459.18 14932.57,-12459.18 14932.57,-10816.14 14932.57,-10775.51 14932.57,-10726.12 15053.79,-10713.3"/>
<polygon fill="black" stroke="black" points="15054.29,-10716.77 15063.91,-10712.34 15053.62,-10709.8 15054.29,-10716.77"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge55" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14769.8,-12546.66C14851.55,-12532 14950.57,-12505.76 14950.57,-12459.18 14950.57,-12459.18 14950.57,-12459.18 14950.57,-10816.14 14950.57,-10776.3 14950.57,-10728.03 15053.99,-10714.09"/>
<polygon fill="black" stroke="black" points="15054.47,-10717.55 15063.98,-10712.88 15053.64,-10710.6 15054.47,-10717.55"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge56" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14785.72,-12546.66C14869.55,-12532 14968.57,-12505.76 14968.57,-12459.18 14968.57,-12459.18 14968.57,-12459.18 14968.57,-10816.14 14968.57,-10777.25 14968.57,-10730.33 15054.64,-10715.14"/>
<polygon fill="black" stroke="black" points="15055.35,-10718.57 15064.69,-10713.57 15054.27,-10711.66 15055.35,-10718.57"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge57" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14801.63,-12546.66C14887.55,-12532 14986.57,-12505.76 14986.57,-12459.18 14986.57,-12459.18 14986.57,-12459.18 14986.57,-10816.14 14986.57,-10778.48 14986.57,-10733.3 15055.52,-10716.68"/>
<polygon fill="black" stroke="black" points="15056.65,-10720.02 15065.71,-10714.53 15055.2,-10713.17 15056.65,-10720.02"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge58" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.65,-12547.14C14903.36,-12532.57 15004.57,-12506.28 15004.57,-12459.18 15004.57,-12459.18 15004.57,-12459.18 15004.57,-10816.14 15004.57,-10779.95 15004.57,-10736.82 15057.59,-10718.76"/>
<polygon fill="black" stroke="black" points="15058.73,-10722.07 15067.33,-10715.88 15056.75,-10715.36 15058.73,-10722.07"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge59" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.68,-12549.57C14909.17,-12535.58 15022.57,-12509.03 15022.57,-12459.18 15022.57,-12459.18 15022.57,-12459.18 15022.57,-10816.14 15022.57,-10781.83 15022.57,-10741.29 15060.79,-10721.78"/>
<polygon fill="black" stroke="black" points="15062.35,-10724.91 15070.14,-10717.72 15059.57,-10718.49 15062.35,-10724.91"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge60" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.75,-12551.71C14914.74,-12538.35 15040.57,-12511.69 15040.57,-12459.18 15040.57,-12459.18 15040.57,-12459.18 15040.57,-10816.14 15040.57,-10783.98 15040.57,-10746.33 15066.34,-10725.67"/>
<polygon fill="black" stroke="black" points="15068.36,-10728.53 15074.75,-10720.07 15064.48,-10722.7 15068.36,-10728.53"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge61" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.58,-12553.61C14919.91,-12540.94 15058.57,-12514.3 15058.57,-12459.18 15058.57,-12459.18 15058.57,-12459.18 15058.57,-10816.14 15058.57,-10786.11 15058.57,-10751.3 15074.88,-10730"/>
<polygon fill="black" stroke="black" points="15077.62,-10732.2 15081.97,-10722.54 15072.54,-10727.38 15077.62,-10732.2"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge62" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.68,-12555.23C14925.18,-12543.27 15076.57,-12516.78 15076.57,-12459.18 15076.57,-12459.18 15076.57,-12459.18 15076.57,-10816.14 15076.57,-10787.76 15076.57,-10755.12 15086.4,-10733.64"/>
<polygon fill="black" stroke="black" points="15089.49,-10735.3 15091.45,-10724.88 15083.42,-10731.8 15089.49,-10735.3"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge63" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.75,-12556.64C14930.41,-12545.41 15094.57,-12519.16 15094.57,-12459.18 15094.57,-12459.18 15094.57,-12459.18 15094.57,-10816.14 15094.57,-10788.78 15094.57,-10757.45 15099.86,-10735.98"/>
<polygon fill="black" stroke="black" points="15103.25,-10736.89 15102.91,-10726.3 15096.57,-10734.79 15103.25,-10736.89"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge64" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.77,-12557.86C14935.65,-12547.36 15112.57,-12521.45 15112.57,-12459.18 15112.57,-12459.18 15112.57,-12459.18 15112.57,-10816.14 15112.57,-10789.37 15112.57,-10758.81 15114.22,-10737.4"/>
<polygon fill="black" stroke="black" points="15117.71,-10737.69 15115.21,-10727.4 15110.75,-10737 15117.71,-10737.69"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge65" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.7,-12558.91C14940.96,-12549.14 15130.57,-12523.64 15130.57,-12459.18 15130.57,-12459.18 15130.57,-12459.18 15130.57,-10816.14 15130.57,-10789.37 15130.57,-10758.81 15128.92,-10737.4"/>
<polygon fill="black" stroke="black" points="15132.4,-10737 15127.94,-10727.4 15125.44,-10737.69 15132.4,-10737"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge66" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.77,-12559.8C14946.69,-12550.72 15148.57,-12525.69 15148.57,-12459.18 15148.57,-12459.18 15148.57,-12459.18 15148.57,-10816.14 15148.57,-10788.78 15148.57,-10757.45 15143.28,-10735.98"/>
<polygon fill="black" stroke="black" points="15146.58,-10734.79 15140.24,-10726.3 15139.9,-10736.89 15146.58,-10734.79"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge67" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.67,-12560.56C14952.61,-12552.16 15166.57,-12527.65 15166.57,-12459.18 15166.57,-12459.18 15166.57,-12459.18 15166.57,-10816.14 15166.57,-10787.76 15166.57,-10755.12 15156.74,-10733.64"/>
<polygon fill="black" stroke="black" points="15159.72,-10731.8 15151.7,-10724.88 15153.66,-10735.3 15159.72,-10731.8"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge68" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.68,-12561.2C14959.08,-12553.44 15184.57,-12529.47 15184.57,-12459.18 15184.57,-12459.18 15184.57,-12459.18 15184.57,-10816.14 15184.57,-10786.11 15184.57,-10751.3 15168.26,-10730"/>
<polygon fill="black" stroke="black" points="15170.6,-10727.38 15161.18,-10722.54 15165.53,-10732.2 15170.6,-10727.38"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge69" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.79,-12561.73C14966.17,-12554.56 15202.57,-12531.15 15202.57,-12459.18 15202.57,-12459.18 15202.57,-12459.18 15202.57,-10816.14 15202.57,-10783.98 15202.57,-10746.33 15176.81,-10725.67"/>
<polygon fill="black" stroke="black" points="15178.66,-10722.7 15168.4,-10720.07 15174.78,-10728.53 15178.66,-10722.7"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge70" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.7,-12562.18C14973.64,-12555.56 15220.57,-12532.74 15220.57,-12459.18 15220.57,-12459.18 15220.57,-12459.18 15220.57,-10816.14 15220.57,-10781.83 15220.57,-10741.29 15182.36,-10721.78"/>
<polygon fill="black" stroke="black" points="15183.58,-10718.49 15173.01,-10717.72 15180.79,-10724.91 15183.58,-10718.49"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge71" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.73,-12562.55C14981.82,-12556.44 15238.57,-12534.19 15238.57,-12459.18 15238.57,-12459.18 15238.57,-12459.18 15238.57,-10816.14 15238.57,-10779.95 15238.57,-10736.82 15185.56,-10718.76"/>
<polygon fill="black" stroke="black" points="15186.4,-10715.36 15175.82,-10715.88 15184.42,-10722.07 15186.4,-10715.36"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge72" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.59,-12562.86C14990.47,-12557.23 15256.57,-12535.54 15256.57,-12459.18 15256.57,-12459.18 15256.57,-12459.18 15256.57,-10816.14 15256.57,-10778.48 15256.57,-10733.3 15187.63,-10716.68"/>
<polygon fill="black" stroke="black" points="15187.94,-10713.17 15177.44,-10714.53 15186.5,-10720.02 15187.94,-10713.17"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge73" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.66,-12563.12C14999.95,-12557.9 15274.57,-12536.75 15274.57,-12459.18 15274.57,-12459.18 15274.57,-12459.18 15274.57,-10816.14 15274.57,-10777.25 15274.57,-10730.33 15188.51,-10715.14"/>
<polygon fill="black" stroke="black" points="15188.88,-10711.66 15178.46,-10713.57 15187.8,-10718.57 15188.88,-10711.66"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge74" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.65,-12563.34C15009.96,-12558.5 15292.57,-12537.87 15292.57,-12459.18 15292.57,-12459.18 15292.57,-12459.18 15292.57,-10816.14 15292.57,-10776.3 15292.57,-10728.03 15189.15,-10714.09"/>
<polygon fill="black" stroke="black" points="15189.51,-10710.6 15179.16,-10712.88 15188.67,-10717.55 15189.51,-10710.6"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge75" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.6,-12563.52C15020.54,-12559.03 15310.57,-12538.9 15310.57,-12459.18 15310.57,-12459.18 15310.57,-12459.18 15310.57,-10816.14 15310.57,-10775.51 15310.57,-10726.12 15189.35,-10713.3"/>
<polygon fill="black" stroke="black" points="15189.52,-10709.8 15179.24,-10712.34 15188.86,-10716.77 15189.52,-10709.8"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge76" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.59,-12563.67C15031.71,-12559.49 15328.57,-12539.83 15328.57,-12459.18 15328.57,-12459.18 15328.57,-12459.18 15328.57,-10816.14 15328.57,-10774.89 15328.57,-10724.62 15189.67,-10712.74"/>
<polygon fill="black" stroke="black" points="15189.67,-10709.23 15179.43,-10711.95 15189.13,-10716.21 15189.67,-10709.23"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge77" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.68,-12563.79C15043.49,-12559.9 15346.57,-12540.67 15346.57,-12459.18 15346.57,-12459.18 15346.57,-12459.18 15346.57,-10816.14 15346.57,-10774.36 15346.57,-10723.33 15189.71,-10712.3"/>
<polygon fill="black" stroke="black" points="15189.85,-10708.8 15179.65,-10711.66 15189.41,-10715.79 15189.85,-10708.8"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge78" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.95,-12563.9C15055.91,-12560.24 15364.57,-12541.42 15364.57,-12459.18 15364.57,-12459.18 15364.57,-12459.18 15364.57,-10816.14 15364.57,-10773.94 15364.57,-10722.3 15189.97,-10711.98"/>
<polygon fill="black" stroke="black" points="15190.06,-10708.48 15179.88,-10711.44 15189.68,-10715.47 15190.06,-10708.48"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge79" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.62,-12563.99C15068.28,-12560.58 15382.57,-12542.17 15382.57,-12459.18 15382.57,-12459.18 15382.57,-12459.18 15382.57,-10816.14 15382.57,-10773.56 15382.57,-10721.37 15189.93,-10711.71"/>
<polygon fill="black" stroke="black" points="15189.86,-10708.21 15179.71,-10711.25 15189.54,-10715.2 15189.86,-10708.21"/>
</g>
<!-- input_tensor&#45;&gt;residual_0 -->
<g id="edge80" class="edge">
<title>input_tensor&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M14814.58,-12564.07C15081.31,-12560.87 15400.57,-12542.82 15400.57,-12459.18 15400.57,-12459.18 15400.57,-12459.18 15400.57,-10816.14 15400.57,-10773.25 15400.57,-10720.6 15190.08,-10711.51"/>
<polygon fill="black" stroke="black" points="15190.03,-10708 15179.9,-10711.11 15189.75,-10715 15190.03,-10708"/>
</g>
<!-- ln1_0_0 -->
<g id="node52" class="node">
<title>ln1_0_0</title>
<ellipse fill="lightgreen" stroke="black" cx="2213.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="2213.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2213.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="2213.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_0&#45;&gt;ln1_0_0 -->
<g id="edge81" class="edge">
<title>embed_0&#45;&gt;ln1_0_0</title>
<path fill="none" stroke="black" d="M9776.96,-12455.12C9156.97,-12446.5 6715.6,-12412.5 4708.57,-12383.68 3825.76,-12371.01 2767.26,-12355.38 2372.33,-12349.54"/>
<polygon fill="black" stroke="black" points="2372.32,-12346.04 2362.27,-12349.39 2372.22,-12353.03 2372.32,-12346.04"/>
</g>
<!-- ln1_0_1 -->
<g id="node53" class="node">
<title>ln1_0_1</title>
<ellipse fill="lightgreen" stroke="black" cx="4866.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="4866.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4866.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="4866.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_1&#45;&gt;ln1_0_1 -->
<g id="edge82" class="edge">
<title>embed_1&#45;&gt;ln1_0_1</title>
<path fill="none" stroke="black" d="M10153.47,-12427.89C10130.94,-12421.64 10106.57,-12415.95 10083.57,-12412.68 9869.55,-12382.31 6408.71,-12387.46 6192.57,-12383.68 5770.43,-12376.3 5272.86,-12360.77 5024.4,-12352.55"/>
<polygon fill="black" stroke="black" points="5024.32,-12349.05 5014.21,-12352.21 5024.09,-12356.04 5024.32,-12349.05"/>
</g>
<!-- ln1_0_2 -->
<g id="node54" class="node">
<title>ln1_0_2</title>
<ellipse fill="lightgreen" stroke="black" cx="6350.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="6350.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6350.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6350.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_2&#45;&gt;ln1_0_2 -->
<g id="edge83" class="edge">
<title>embed_2&#45;&gt;ln1_0_2</title>
<path fill="none" stroke="black" d="M10469.47,-12427.9C10446.94,-12421.65 10422.57,-12415.95 10399.57,-12412.68 9986.27,-12353.96 7059.12,-12411.23 6642.57,-12383.68 6591.54,-12380.31 6535.77,-12373.99 6486.77,-12367.55"/>
<polygon fill="black" stroke="black" points="6487.12,-12364.07 6476.75,-12366.22 6486.2,-12371.01 6487.12,-12364.07"/>
</g>
<!-- ln1_0_3 -->
<g id="node55" class="node">
<title>ln1_0_3</title>
<ellipse fill="lightgreen" stroke="black" cx="6800.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="6800.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6800.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6800.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_3&#45;&gt;ln1_0_3 -->
<g id="edge84" class="edge">
<title>embed_3&#45;&gt;ln1_0_3</title>
<path fill="none" stroke="black" d="M10785.05,-12427.82C10762.63,-12421.61 10738.42,-12415.96 10715.57,-12412.68 10393.4,-12366.55 8111.94,-12391.32 7786.57,-12383.68 7493.27,-12376.8 7151.09,-12362.79 6956.71,-12354.27"/>
<polygon fill="black" stroke="black" points="6956.85,-12350.77 6946.71,-12353.83 6956.55,-12357.77 6956.85,-12350.77"/>
</g>
<!-- ln1_0_4 -->
<g id="node56" class="node">
<title>ln1_0_4</title>
<ellipse fill="lightgreen" stroke="black" cx="7944.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="7944.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7944.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7944.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_4&#45;&gt;ln1_0_4 -->
<g id="edge85" class="edge">
<title>embed_4&#45;&gt;ln1_0_4</title>
<path fill="none" stroke="black" d="M11101.05,-12427.84C11078.63,-12421.64 11054.42,-12415.97 11031.57,-12412.68 10754.96,-12372.85 8795.84,-12394.2 8516.57,-12383.68 8373.84,-12378.31 8211.33,-12367.49 8096.11,-12359.02"/>
<polygon fill="black" stroke="black" points="8096.03,-12355.5 8085.8,-12358.25 8095.52,-12362.48 8096.03,-12355.5"/>
</g>
<!-- ln1_0_5 -->
<g id="node57" class="node">
<title>ln1_0_5</title>
<ellipse fill="lightgreen" stroke="black" cx="8674.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="8674.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8674.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8674.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_5&#45;&gt;ln1_0_5 -->
<g id="edge86" class="edge">
<title>embed_5&#45;&gt;ln1_0_5</title>
<path fill="none" stroke="black" d="M11417.05,-12427.85C11394.63,-12421.65 11370.42,-12415.98 11347.57,-12412.68 11082.41,-12374.43 9203.72,-12403.82 8936.57,-12383.68 8894.37,-12380.5 8848.6,-12374.88 8807.3,-12368.99"/>
<polygon fill="black" stroke="black" points="8807.58,-12365.5 8797.18,-12367.53 8806.58,-12372.42 8807.58,-12365.5"/>
</g>
<!-- ln1_0_6 -->
<g id="node58" class="node">
<title>ln1_0_6</title>
<ellipse fill="lightgreen" stroke="black" cx="9094.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="9094.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9094.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9094.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_6&#45;&gt;ln1_0_6 -->
<g id="edge87" class="edge">
<title>embed_6&#45;&gt;ln1_0_6</title>
<path fill="none" stroke="black" d="M11733.04,-12427.87C11710.62,-12421.66 11686.42,-12415.99 11663.57,-12412.68 11421.19,-12377.58 9704.09,-12397.49 9459.57,-12383.68 9386.24,-12379.54 9304.91,-12371.72 9237.66,-12364.38"/>
<polygon fill="black" stroke="black" points="9237.74,-12360.87 9227.42,-12363.26 9236.97,-12367.83 9237.74,-12360.87"/>
</g>
<!-- ln1_0_7 -->
<g id="node59" class="node">
<title>ln1_0_7</title>
<ellipse fill="lightgreen" stroke="black" cx="9617.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="9617.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9617.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9617.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_7&#45;&gt;ln1_0_7 -->
<g id="edge88" class="edge">
<title>embed_7&#45;&gt;ln1_0_7</title>
<path fill="none" stroke="black" d="M12048.59,-12427.99C12026.29,-12421.82 12002.25,-12416.14 11979.57,-12412.68 11925.09,-12404.39 10296.89,-12363.85 9776.1,-12351.06"/>
<polygon fill="black" stroke="black" points="9775.97,-12347.55 9765.88,-12350.81 9775.79,-12354.55 9775.97,-12347.55"/>
</g>
<!-- ln1_0_8 -->
<g id="node60" class="node">
<title>ln1_0_8</title>
<ellipse fill="lightgreen" stroke="black" cx="11256.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11256.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11256.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="11256.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_8&#45;&gt;ln1_0_8 -->
<g id="edge89" class="edge">
<title>embed_8&#45;&gt;ln1_0_8</title>
<path fill="none" stroke="black" d="M12364.16,-12428C12341.97,-12421.87 12318.1,-12416.21 12295.57,-12412.68 11940.11,-12357.07 11844.68,-12418.39 11486.57,-12383.68 11453.75,-12380.5 11418.5,-12375.64 11385.69,-12370.5"/>
<polygon fill="black" stroke="black" points="11386.02,-12367.01 11375.59,-12368.89 11384.92,-12373.92 11386.02,-12367.01"/>
</g>
<!-- ln1_0_9 -->
<g id="node61" class="node">
<title>ln1_0_9</title>
<ellipse fill="lightgreen" stroke="black" cx="11644.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11644.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11644.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="11644.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_9&#45;&gt;ln1_0_9 -->
<g id="edge90" class="edge">
<title>embed_9&#45;&gt;ln1_0_9</title>
<path fill="none" stroke="black" d="M12680.15,-12428.04C12657.97,-12421.91 12634.09,-12416.24 12611.57,-12412.68 12278.99,-12360.24 12189.4,-12419.04 11854.57,-12383.68 11827.04,-12380.78 11797.67,-12376.45 11769.88,-12371.79"/>
<polygon fill="black" stroke="black" points="11770.16,-12368.28 11759.72,-12370.05 11768.99,-12375.18 11770.16,-12368.28"/>
</g>
<!-- ln1_0_10 -->
<g id="node62" class="node">
<title>ln1_0_10</title>
<ellipse fill="lightgreen" stroke="black" cx="12012.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12012.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12012.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12012.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_10&#45;&gt;ln1_0_10 -->
<g id="edge91" class="edge">
<title>embed_10&#45;&gt;ln1_0_10</title>
<path fill="none" stroke="black" d="M12995.71,-12428.07C12973.65,-12421.98 12949.94,-12416.31 12927.57,-12412.68 12658.35,-12368.99 12586.37,-12406.51 12314.57,-12383.68 12261.41,-12379.22 12203.18,-12372.6 12152.16,-12366.21"/>
<polygon fill="black" stroke="black" points="12152.42,-12362.72 12142.06,-12364.94 12151.54,-12369.66 12152.42,-12362.72"/>
</g>
<!-- ln1_0_11 -->
<g id="node63" class="node">
<title>ln1_0_11</title>
<ellipse fill="lightgreen" stroke="black" cx="12472.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12472.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12472.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12472.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_11&#45;&gt;ln1_0_11 -->
<g id="edge92" class="edge">
<title>embed_11&#45;&gt;ln1_0_11</title>
<path fill="none" stroke="black" d="M13310.78,-12428.44C13288.95,-12422.41 13265.58,-12416.68 13243.57,-12412.68 13228.5,-12409.95 12843.31,-12377.84 12623.21,-12359.62"/>
<polygon fill="black" stroke="black" points="12623.44,-12356.13 12613.18,-12358.79 12622.86,-12363.1 12623.44,-12356.13"/>
</g>
<!-- ln1_0_12 -->
<g id="node64" class="node">
<title>ln1_0_12</title>
<ellipse fill="lightgreen" stroke="black" cx="13076.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13076.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13076.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13076.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_12&#45;&gt;ln1_0_12 -->
<g id="edge93" class="edge">
<title>embed_12&#45;&gt;ln1_0_12</title>
<path fill="none" stroke="black" d="M13626.32,-12428.51C13604.62,-12422.52 13581.42,-12416.79 13559.57,-12412.68 13428.35,-12388.04 13392.66,-12403.14 13260.57,-12383.68 13240.27,-12380.69 13218.81,-12376.96 13198,-12373.04"/>
<polygon fill="black" stroke="black" points="13198.64,-12369.6 13188.16,-12371.16 13197.33,-12376.47 13198.64,-12369.6"/>
</g>
<!-- ln1_0_13 -->
<g id="node65" class="node">
<title>ln1_0_13</title>
<ellipse fill="lightgreen" stroke="black" cx="13418.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13418.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13418.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13418.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_13&#45;&gt;ln1_0_13 -->
<g id="edge94" class="edge">
<title>embed_13&#45;&gt;ln1_0_13</title>
<path fill="none" stroke="black" d="M13940.51,-12428.77C13919.3,-12422.91 13896.76,-12417.17 13875.57,-12412.68 13772.31,-12390.84 13654.36,-12374.14 13564.15,-12363.07"/>
<polygon fill="black" stroke="black" points="13564.47,-12359.58 13554.12,-12361.85 13563.63,-12366.53 13564.47,-12359.58"/>
</g>
<!-- ln1_0_14 -->
<g id="node66" class="node">
<title>ln1_0_14</title>
<ellipse fill="lightgreen" stroke="black" cx="14079.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14079.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14079.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="14079.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_14&#45;&gt;ln1_0_14 -->
<g id="edge95" class="edge">
<title>embed_14&#45;&gt;ln1_0_14</title>
<path fill="none" stroke="black" d="M14272.92,-12425.96C14239.58,-12412.37 14200.35,-12396.39 14165.97,-12382.38"/>
<polygon fill="black" stroke="black" points="14167,-12379.02 14156.41,-12378.49 14164.35,-12385.5 14167,-12379.02"/>
</g>
<!-- ln1_0_15 -->
<g id="node67" class="node">
<title>ln1_0_15</title>
<ellipse fill="lightgreen" stroke="black" cx="14518.57" cy="-12346.18" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14518.57" y="-12357.48" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14518.57" y="-12342.48" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14518.57" y="-12327.48" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- embed_15&#45;&gt;ln1_0_15 -->
<g id="edge96" class="edge">
<title>embed_15&#45;&gt;ln1_0_15</title>
<path fill="none" stroke="black" d="M14619.06,-12422.38C14604.51,-12411.49 14588.33,-12399.38 14573.27,-12388.11"/>
<polygon fill="black" stroke="black" points="14575.14,-12385.14 14565.03,-12381.95 14570.94,-12390.74 14575.14,-12385.14"/>
</g>
<!-- final_ln_0 -->
<g id="node18" class="node">
<title>final_ln_0</title>
<ellipse fill="lightgreen" stroke="black" cx="11927.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11927.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="11927.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11927.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_0 -->
<g id="node19" class="node">
<title>output_proj_final_0</title>
<ellipse fill="yellow" stroke="black" cx="11826.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="11826.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11826.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11826.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11826.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_0&#45;&gt;output_proj_final_0 -->
<g id="edge17" class="edge">
<title>final_ln_0&#45;&gt;output_proj_final_0</title>
<path fill="none" stroke="black" d="M11897.54,-224.81C11889.48,-215.19 11880.58,-204.56 11871.89,-194.18"/>
<polygon fill="black" stroke="black" points="11874.4,-191.73 11865.3,-186.31 11869.03,-196.23 11874.4,-191.73"/>
</g>
<!-- final_output -->
<g id="node50" class="node">
<title>final_output</title>
<polygon fill="lightblue" stroke="black" points="14869.57,-54 14633.57,-54 14633.57,-16 14869.57,-16 14869.57,-54"/>
<text text-anchor="middle" x="14751.57" y="-38.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="14751.57" y="-23.8" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size]</text>
</g>
<!-- output_proj_final_0&#45;&gt;final_output -->
<g id="edge33" class="edge">
<title>output_proj_final_0&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M11952.78,-103.65C11975.53,-98.58 11999.14,-94.05 12021.57,-91 12275.38,-56.54 12341.51,-78.36 12597.57,-72 13366.14,-52.9 14289.23,-41.26 14623.16,-37.42"/>
<polygon fill="black" stroke="black" points="14623.39,-40.92 14633.35,-37.3 14623.31,-33.92 14623.39,-40.92"/>
</g>
<!-- final_ln_1 -->
<g id="node20" class="node">
<title>final_ln_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12327.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12327.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="12327.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12327.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_1 -->
<g id="node21" class="node">
<title>output_proj_final_1</title>
<ellipse fill="yellow" stroke="black" cx="12216.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="12216.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12216.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12216.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12216.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_1&#45;&gt;output_proj_final_1 -->
<g id="edge18" class="edge">
<title>final_ln_1&#45;&gt;output_proj_final_1</title>
<path fill="none" stroke="black" d="M12294.57,-224.81C12285.62,-215.09 12275.74,-204.35 12266.09,-193.88"/>
<polygon fill="black" stroke="black" points="12268.48,-191.3 12259.13,-186.31 12263.33,-196.04 12268.48,-191.3"/>
</g>
<!-- output_proj_final_1&#45;&gt;final_output -->
<g id="edge34" class="edge">
<title>output_proj_final_1&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M12342.78,-103.64C12365.53,-98.57 12389.14,-94.04 12411.57,-91 12668.47,-56.17 12735.42,-78.88 12994.57,-72 13604.19,-55.82 14332.95,-42.96 14623.17,-38.1"/>
<polygon fill="black" stroke="black" points="14623.37,-41.6 14633.31,-37.93 14623.25,-34.6 14623.37,-41.6"/>
</g>
<!-- final_ln_2 -->
<g id="node22" class="node">
<title>final_ln_2</title>
<ellipse fill="lightgreen" stroke="black" cx="12680.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12680.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="12680.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12680.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_2 -->
<g id="node23" class="node">
<title>output_proj_final_2</title>
<ellipse fill="yellow" stroke="black" cx="12606.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="12606.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12606.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12606.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12606.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_2&#45;&gt;output_proj_final_2 -->
<g id="edge19" class="edge">
<title>final_ln_2&#45;&gt;output_proj_final_2</title>
<path fill="none" stroke="black" d="M12658.37,-224.49C12652.77,-215.37 12646.63,-205.36 12640.6,-195.53"/>
<polygon fill="black" stroke="black" points="12643.56,-193.66 12635.34,-186.97 12637.59,-197.32 12643.56,-193.66"/>
</g>
<!-- output_proj_final_2&#45;&gt;final_output -->
<g id="edge35" class="edge">
<title>output_proj_final_2&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M12732.52,-103.69C12755.35,-98.6 12779.05,-94.05 12801.57,-91 13155.15,-43.15 14247.69,-36.81 14623.24,-36.06"/>
<polygon fill="black" stroke="black" points="14623.34,-39.56 14633.33,-36.04 14623.33,-32.56 14623.34,-39.56"/>
</g>
<!-- final_ln_3 -->
<g id="node24" class="node">
<title>final_ln_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13079.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13079.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="13079.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13079.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_3 -->
<g id="node25" class="node">
<title>output_proj_final_3</title>
<ellipse fill="yellow" stroke="black" cx="12996.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="12996.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12996.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12996.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12996.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_3&#45;&gt;output_proj_final_3 -->
<g id="edge20" class="edge">
<title>final_ln_3&#45;&gt;output_proj_final_3</title>
<path fill="none" stroke="black" d="M13054.67,-224.49C13048.25,-215.17 13041.2,-204.92 13034.29,-194.89"/>
<polygon fill="black" stroke="black" points="13037.09,-192.78 13028.54,-186.53 13031.33,-196.75 13037.09,-192.78"/>
</g>
<!-- output_proj_final_3&#45;&gt;final_output -->
<g id="edge36" class="edge">
<title>output_proj_final_3&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M13122.79,-103.69C13145.53,-98.62 13169.15,-94.07 13191.57,-91 13466.73,-53.32 14301.27,-40.72 14623.09,-37.19"/>
<polygon fill="black" stroke="black" points="14623.43,-40.69 14633.39,-37.08 14623.35,-33.69 14623.43,-40.69"/>
</g>
<!-- final_ln_4 -->
<g id="node26" class="node">
<title>final_ln_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13478.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13478.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="13478.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13478.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_4 -->
<g id="node27" class="node">
<title>output_proj_final_4</title>
<ellipse fill="yellow" stroke="black" cx="13386.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="13386.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13386.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13386.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13386.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_4&#45;&gt;output_proj_final_4 -->
<g id="edge21" class="edge">
<title>final_ln_4&#45;&gt;output_proj_final_4</title>
<path fill="none" stroke="black" d="M13450.97,-224.49C13443.79,-215.07 13435.89,-204.72 13428.16,-194.58"/>
<polygon fill="black" stroke="black" points="13430.86,-192.35 13422.01,-186.53 13425.29,-196.6 13430.86,-192.35"/>
</g>
<!-- output_proj_final_4&#45;&gt;final_output -->
<g id="edge37" class="edge">
<title>output_proj_final_4&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M13513.34,-103.8C13535.93,-98.74 13559.34,-94.18 13581.57,-91 13779.23,-62.75 14362.11,-45.48 14622.9,-38.96"/>
<polygon fill="black" stroke="black" points="14623.27,-42.46 14633.18,-38.71 14623.1,-35.46 14623.27,-42.46"/>
</g>
<!-- final_ln_5 -->
<g id="node28" class="node">
<title>final_ln_5</title>
<ellipse fill="lightgreen" stroke="black" cx="13840.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13840.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="13840.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13840.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_5 -->
<g id="node29" class="node">
<title>output_proj_final_5</title>
<ellipse fill="yellow" stroke="black" cx="13776.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="13776.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13776.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13776.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13776.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_5&#45;&gt;output_proj_final_5 -->
<g id="edge22" class="edge">
<title>final_ln_5&#45;&gt;output_proj_final_5</title>
<path fill="none" stroke="black" d="M13821.2,-224.16C13816.51,-215.34 13811.4,-205.7 13806.36,-196.2"/>
<polygon fill="black" stroke="black" points="13809.35,-194.37 13801.57,-187.17 13803.16,-197.65 13809.35,-194.37"/>
</g>
<!-- output_proj_final_5&#45;&gt;final_output -->
<g id="edge38" class="edge">
<title>output_proj_final_5&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M13904.2,-104.05C13926.53,-99.02 13949.63,-94.4 13971.57,-91 14199.33,-55.73 14468.05,-43.05 14623.23,-38.51"/>
<polygon fill="black" stroke="black" points="14623.39,-42.01 14633.28,-38.22 14623.19,-35.01 14623.39,-42.01"/>
</g>
<!-- final_ln_6 -->
<g id="node30" class="node">
<title>final_ln_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14230.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14230.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14230.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14230.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_6 -->
<g id="node31" class="node">
<title>output_proj_final_6</title>
<ellipse fill="yellow" stroke="black" cx="14166.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="14166.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14166.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14166.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14166.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_6&#45;&gt;output_proj_final_6 -->
<g id="edge23" class="edge">
<title>final_ln_6&#45;&gt;output_proj_final_6</title>
<path fill="none" stroke="black" d="M14211.2,-224.16C14206.51,-215.34 14201.4,-205.7 14196.36,-196.2"/>
<polygon fill="black" stroke="black" points="14199.35,-194.37 14191.57,-187.17 14193.16,-197.65 14199.35,-194.37"/>
</g>
<!-- output_proj_final_6&#45;&gt;final_output -->
<g id="edge39" class="edge">
<title>output_proj_final_6&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14297.05,-104.74C14318.53,-99.78 14340.62,-95 14361.57,-91 14448.35,-74.44 14546.88,-60.59 14623.18,-50.93"/>
<polygon fill="black" stroke="black" points="14623.84,-54.37 14633.33,-49.65 14622.97,-47.43 14623.84,-54.37"/>
</g>
<!-- final_ln_7 -->
<g id="node32" class="node">
<title>final_ln_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14583.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14583.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14583.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14583.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_7 -->
<g id="node33" class="node">
<title>output_proj_final_7</title>
<ellipse fill="yellow" stroke="black" cx="14556.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="14556.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14556.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14556.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14556.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_7&#45;&gt;output_proj_final_7 -->
<g id="edge24" class="edge">
<title>final_ln_7&#45;&gt;output_proj_final_7</title>
<path fill="none" stroke="black" d="M14575.4,-224.16C14573.48,-215.61 14571.4,-206.3 14569.34,-197.09"/>
<polygon fill="black" stroke="black" points="14572.72,-196.17 14567.12,-187.17 14565.89,-197.7 14572.72,-196.17"/>
</g>
<!-- output_proj_final_7&#45;&gt;final_output -->
<g id="edge40" class="edge">
<title>output_proj_final_7&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14637.58,-95.68C14661.64,-83.08 14687.09,-69.76 14707.82,-58.91"/>
<polygon fill="black" stroke="black" points="14709.45,-62 14716.69,-54.26 14706.21,-55.8 14709.45,-62"/>
</g>
<!-- final_ln_8 -->
<g id="node34" class="node">
<title>final_ln_8</title>
<ellipse fill="lightgreen" stroke="black" cx="14936.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14936.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="14936.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14936.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_8 -->
<g id="node35" class="node">
<title>output_proj_final_8</title>
<ellipse fill="yellow" stroke="black" cx="14946.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="14946.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14946.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14946.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14946.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_8&#45;&gt;output_proj_final_8 -->
<g id="edge25" class="edge">
<title>final_ln_8&#45;&gt;output_proj_final_8</title>
<path fill="none" stroke="black" d="M14939.6,-224.16C14940.3,-215.7 14941.07,-206.49 14941.82,-197.38"/>
<polygon fill="black" stroke="black" points="14945.33,-197.43 14942.67,-187.17 14938.35,-196.85 14945.33,-197.43"/>
</g>
<!-- output_proj_final_8&#45;&gt;final_output -->
<g id="edge41" class="edge">
<title>output_proj_final_8&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M14865.57,-95.68C14841.51,-83.08 14816.06,-69.76 14795.33,-58.91"/>
<polygon fill="black" stroke="black" points="14796.94,-55.8 14786.46,-54.26 14793.69,-62 14796.94,-55.8"/>
</g>
<!-- final_ln_9 -->
<g id="node36" class="node">
<title>final_ln_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15307.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15307.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="15307.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15307.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_9 -->
<g id="node37" class="node">
<title>output_proj_final_9</title>
<ellipse fill="yellow" stroke="black" cx="15336.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="15336.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15336.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15336.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15336.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_9&#45;&gt;output_proj_final_9 -->
<g id="edge26" class="edge">
<title>final_ln_9&#45;&gt;output_proj_final_9</title>
<path fill="none" stroke="black" d="M15316.35,-224.16C15318.41,-215.61 15320.65,-206.3 15322.86,-197.09"/>
<polygon fill="black" stroke="black" points="15326.31,-197.71 15325.25,-187.17 15319.51,-196.08 15326.31,-197.71"/>
</g>
<!-- output_proj_final_9&#45;&gt;final_output -->
<g id="edge42" class="edge">
<title>output_proj_final_9&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M15206.1,-104.74C15184.62,-99.78 15162.53,-95 15141.57,-91 15054.79,-74.44 14956.27,-60.59 14879.96,-50.93"/>
<polygon fill="black" stroke="black" points="14880.18,-47.43 14869.82,-49.65 14879.31,-54.37 14880.18,-47.43"/>
</g>
<!-- final_ln_10 -->
<g id="node38" class="node">
<title>final_ln_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15688.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15688.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="15688.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15688.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_10 -->
<g id="node39" class="node">
<title>output_proj_final_10</title>
<ellipse fill="yellow" stroke="black" cx="15726.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="15726.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15726.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15726.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15726.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_10&#45;&gt;output_proj_final_10 -->
<g id="edge27" class="edge">
<title>final_ln_10&#45;&gt;output_proj_final_10</title>
<path fill="none" stroke="black" d="M15700.08,-224.16C15702.8,-215.52 15705.77,-206.1 15708.7,-196.79"/>
<polygon fill="black" stroke="black" points="15712.07,-197.76 15711.73,-187.17 15705.39,-195.66 15712.07,-197.76"/>
</g>
<!-- output_proj_final_10&#45;&gt;final_output -->
<g id="edge43" class="edge">
<title>output_proj_final_10&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M15598.95,-104.05C15576.62,-99.02 15553.51,-94.4 15531.57,-91 15303.82,-55.73 15035.1,-43.05 14879.92,-38.51"/>
<polygon fill="black" stroke="black" points="14879.96,-35.01 14869.86,-38.22 14879.76,-42.01 14879.96,-35.01"/>
</g>
<!-- final_ln_11 -->
<g id="node40" class="node">
<title>final_ln_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16073.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16073.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="16073.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16073.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_11 -->
<g id="node41" class="node">
<title>output_proj_final_11</title>
<ellipse fill="yellow" stroke="black" cx="16116.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="16116.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16116.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16116.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16116.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_11&#45;&gt;output_proj_final_11 -->
<g id="edge28" class="edge">
<title>final_ln_11&#45;&gt;output_proj_final_11</title>
<path fill="none" stroke="black" d="M16086.59,-224.16C16089.67,-215.52 16093.03,-206.1 16096.35,-196.79"/>
<polygon fill="black" stroke="black" points="16099.72,-197.77 16099.78,-187.17 16093.13,-195.42 16099.72,-197.77"/>
</g>
<!-- output_proj_final_11&#45;&gt;final_output -->
<g id="edge44" class="edge">
<title>output_proj_final_11&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M15989.8,-103.8C15967.22,-98.74 15943.81,-94.18 15921.57,-91 15723.92,-62.75 15141.03,-45.48 14880.24,-38.96"/>
<polygon fill="black" stroke="black" points="14880.05,-35.46 14869.97,-38.71 14879.87,-42.46 14880.05,-35.46"/>
</g>
<!-- final_ln_12 -->
<g id="node42" class="node">
<title>final_ln_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16461.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16461.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="16461.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16461.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_12 -->
<g id="node43" class="node">
<title>output_proj_final_12</title>
<ellipse fill="yellow" stroke="black" cx="16506.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="16506.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16506.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16506.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16506.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_12&#45;&gt;output_proj_final_12 -->
<g id="edge29" class="edge">
<title>final_ln_12&#45;&gt;output_proj_final_12</title>
<path fill="none" stroke="black" d="M16475.2,-224.16C16478.42,-215.52 16481.94,-206.1 16485.41,-196.79"/>
<polygon fill="black" stroke="black" points="16488.78,-197.77 16489,-187.17 16482.22,-195.32 16488.78,-197.77"/>
</g>
<!-- output_proj_final_12&#45;&gt;final_output -->
<g id="edge45" class="edge">
<title>output_proj_final_12&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16380.36,-103.69C16357.61,-98.62 16334,-94.07 16311.57,-91 16036.42,-53.32 15201.88,-40.72 14880.06,-37.19"/>
<polygon fill="black" stroke="black" points="14879.79,-33.69 14869.76,-37.08 14879.72,-40.69 14879.79,-33.69"/>
</g>
<!-- final_ln_13 -->
<g id="node44" class="node">
<title>final_ln_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16850.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16850.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="16850.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16850.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_13 -->
<g id="node45" class="node">
<title>output_proj_final_13</title>
<ellipse fill="yellow" stroke="black" cx="16896.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="16896.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16896.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16896.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16896.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_13&#45;&gt;output_proj_final_13 -->
<g id="edge30" class="edge">
<title>final_ln_13&#45;&gt;output_proj_final_13</title>
<path fill="none" stroke="black" d="M16864.5,-224.16C16867.8,-215.52 16871.39,-206.1 16874.94,-196.79"/>
<polygon fill="black" stroke="black" points="16878.32,-197.76 16878.61,-187.17 16871.78,-195.27 16878.32,-197.76"/>
</g>
<!-- output_proj_final_13&#45;&gt;final_output -->
<g id="edge46" class="edge">
<title>output_proj_final_13&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M16770.63,-103.69C16747.8,-98.6 16724.09,-94.05 16701.57,-91 16347.99,-43.15 15255.45,-36.81 14879.91,-36.06"/>
<polygon fill="black" stroke="black" points="14879.82,-32.56 14869.81,-36.04 14879.81,-39.56 14879.82,-32.56"/>
</g>
<!-- final_ln_14 -->
<g id="node46" class="node">
<title>final_ln_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17239.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17239.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="17239.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17239.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_14 -->
<g id="node47" class="node">
<title>output_proj_final_14</title>
<ellipse fill="yellow" stroke="black" cx="17286.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="17286.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17286.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17286.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17286.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_14&#45;&gt;output_proj_final_14 -->
<g id="edge31" class="edge">
<title>final_ln_14&#45;&gt;output_proj_final_14</title>
<path fill="none" stroke="black" d="M17253.8,-224.16C17257.21,-215.43 17260.92,-205.9 17264.58,-196.5"/>
<polygon fill="black" stroke="black" points="17267.85,-197.76 17268.22,-187.17 17261.33,-195.22 17267.85,-197.76"/>
</g>
<!-- output_proj_final_14&#45;&gt;final_output -->
<g id="edge47" class="edge">
<title>output_proj_final_14&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M17160.36,-103.64C17137.62,-98.57 17114.01,-94.04 17091.57,-91 16834.67,-56.17 16767.73,-78.88 16508.57,-72 15898.96,-55.82 15170.19,-42.96 14879.97,-38.1"/>
<polygon fill="black" stroke="black" points="14879.89,-34.6 14869.83,-37.93 14879.77,-41.6 14879.89,-34.6"/>
</g>
<!-- final_ln_15 -->
<g id="node48" class="node">
<title>final_ln_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17629.57" cy="-261.67" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17629.57" y="-272.97" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="17629.57" y="-257.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17629.57" y="-242.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- output_proj_final_15 -->
<g id="node49" class="node">
<title>output_proj_final_15</title>
<ellipse fill="yellow" stroke="black" cx="17676.57" cy="-139.08" rx="186" ry="48.17"/>
<text text-anchor="middle" x="17676.57" y="-157.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17676.57" y="-142.88" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17676.57" y="-127.88" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17676.57" y="-112.88" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, vocab_size//16]</text>
</g>
<!-- final_ln_15&#45;&gt;output_proj_final_15 -->
<g id="edge32" class="edge">
<title>final_ln_15&#45;&gt;output_proj_final_15</title>
<path fill="none" stroke="black" d="M17643.8,-224.16C17647.21,-215.43 17650.92,-205.9 17654.58,-196.5"/>
<polygon fill="black" stroke="black" points="17657.85,-197.76 17658.22,-187.17 17651.33,-195.22 17657.85,-197.76"/>
</g>
<!-- output_proj_final_15&#45;&gt;final_output -->
<g id="edge48" class="edge">
<title>output_proj_final_15&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M17550.91,-103.61C17528,-98.51 17504.19,-93.97 17481.57,-91 17141.29,-46.25 17052.71,-79.38 16709.57,-72 16019.4,-57.16 15192.31,-43.21 14879.66,-38.08"/>
<polygon fill="black" stroke="black" points="14879.71,-34.58 14869.66,-37.92 14879.6,-41.58 14879.71,-34.58"/>
</g>
<!-- ln2_0_0 -->
<g id="node289" class="node">
<title>ln2_0_0</title>
<ellipse fill="lightgreen" stroke="black" cx="12695.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12695.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12695.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12695.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_0 -->
<g id="edge367" class="edge">
<title>residual_0&#45;&gt;ln2_0_0</title>
<path fill="none" stroke="black" d="M15063.16,-10708.14C14755.02,-10707.97 13316.02,-10704.41 12873.57,-10654.14 12853.78,-10651.89 12832.91,-10648.53 12812.71,-10644.74"/>
<polygon fill="black" stroke="black" points="12813.34,-10641.29 12802.86,-10642.85 12812.02,-10648.17 12813.34,-10641.29"/>
</g>
<!-- ln2_0_1 -->
<g id="node290" class="node">
<title>ln2_0_1</title>
<ellipse fill="lightgreen" stroke="black" cx="13031.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13031.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13031.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13031.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_1 -->
<g id="edge368" class="edge">
<title>residual_0&#45;&gt;ln2_0_1</title>
<path fill="none" stroke="black" d="M15063.51,-10706.9C14872.51,-10702.79 14246.34,-10688.94 13728.57,-10673.14 13493.42,-10665.96 13433,-10683.45 13199.57,-10654.14 13182.21,-10651.96 13163.98,-10648.86 13146.2,-10645.38"/>
<polygon fill="black" stroke="black" points="13146.87,-10641.95 13136.38,-10643.41 13145.5,-10648.81 13146.87,-10641.95"/>
</g>
<!-- ln2_0_2 -->
<g id="node291" class="node">
<title>ln2_0_2</title>
<ellipse fill="lightgreen" stroke="black" cx="13357.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13357.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13357.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13357.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_2 -->
<g id="edge369" class="edge">
<title>residual_0&#45;&gt;ln2_0_2</title>
<path fill="none" stroke="black" d="M15063.11,-10707.64C14812.5,-10705.31 13827.78,-10693.73 13520.57,-10654.14 13504.5,-10652.07 13487.67,-10649.16 13471.18,-10645.88"/>
<polygon fill="black" stroke="black" points="13471.47,-10642.37 13460.98,-10643.79 13470.07,-10649.22 13471.47,-10642.37"/>
</g>
<!-- ln2_0_3 -->
<g id="node292" class="node">
<title>ln2_0_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13678.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13678.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13678.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13678.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_3 -->
<g id="edge370" class="edge">
<title>residual_0&#45;&gt;ln2_0_3</title>
<path fill="none" stroke="black" d="M15063.38,-10707.09C14845.92,-10702.93 14081.09,-10686.33 13839.57,-10654.14 13823.93,-10652.05 13807.56,-10649.17 13791.51,-10645.94"/>
<polygon fill="black" stroke="black" points="13792.07,-10642.48 13781.57,-10643.89 13790.65,-10649.34 13792.07,-10642.48"/>
</g>
<!-- ln2_0_4 -->
<g id="node293" class="node">
<title>ln2_0_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13997.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13997.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13997.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13997.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_4 -->
<g id="edge371" class="edge">
<title>residual_0&#45;&gt;ln2_0_4</title>
<path fill="none" stroke="black" d="M15063.04,-10708.31C14912.09,-10708.01 14497.57,-10702.46 14156.57,-10654.14 14141.51,-10652 14125.76,-10649.16 14110.28,-10645.99"/>
<polygon fill="black" stroke="black" points="14110.67,-10642.49 14100.16,-10643.87 14109.23,-10649.35 14110.67,-10642.49"/>
</g>
<!-- ln2_0_5 -->
<g id="node294" class="node">
<title>ln2_0_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14314.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14314.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14314.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14314.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_5 -->
<g id="edge372" class="edge">
<title>residual_0&#45;&gt;ln2_0_5</title>
<path fill="none" stroke="black" d="M15063.6,-10706.08C14949.85,-10701.43 14689.7,-10687.77 14473.57,-10654.14 14458.77,-10651.83 14443.29,-10648.92 14428.05,-10645.75"/>
<polygon fill="black" stroke="black" points="14428.59,-10642.29 14418.08,-10643.64 14427.13,-10649.14 14428.59,-10642.29"/>
</g>
<!-- ln2_0_6 -->
<g id="node295" class="node">
<title>ln2_0_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14631.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14631.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14631.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14631.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_6 -->
<g id="edge373" class="edge">
<title>residual_0&#45;&gt;ln2_0_6</title>
<path fill="none" stroke="black" d="M15069.63,-10700.77C15004.12,-10691.23 14888.13,-10673.51 14789.57,-10654.14 14775.88,-10651.45 14761.57,-10648.43 14747.39,-10645.31"/>
<polygon fill="black" stroke="black" points="14748.13,-10641.89 14737.6,-10643.14 14746.61,-10648.72 14748.13,-10641.89"/>
</g>
<!-- ln2_0_7 -->
<g id="node296" class="node">
<title>ln2_0_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14947.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14947.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14947.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14947.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_7 -->
<g id="edge374" class="edge">
<title>residual_0&#45;&gt;ln2_0_7</title>
<path fill="none" stroke="black" d="M15092.84,-10693.19C15072.98,-10682.86 15045.63,-10668.64 15020,-10655.31"/>
<polygon fill="black" stroke="black" points="15021.52,-10652.15 15011.03,-10650.64 15018.29,-10658.36 15021.52,-10652.15"/>
</g>
<!-- ln2_0_8 -->
<g id="node297" class="node">
<title>ln2_0_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15297.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15297.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15297.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15297.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_8 -->
<g id="edge375" class="edge">
<title>residual_0&#45;&gt;ln2_0_8</title>
<path fill="none" stroke="black" d="M15150.24,-10693.4C15170.37,-10683.05 15198.25,-10668.71 15224.34,-10655.29"/>
<polygon fill="black" stroke="black" points="15226.19,-10658.28 15233.48,-10650.59 15222.99,-10652.05 15226.19,-10658.28"/>
</g>
<!-- ln2_0_9 -->
<g id="node298" class="node">
<title>ln2_0_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15631.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15631.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15631.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15631.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_9 -->
<g id="edge376" class="edge">
<title>residual_0&#45;&gt;ln2_0_9</title>
<path fill="none" stroke="black" d="M15173.19,-10700.52C15238.92,-10690.64 15355.93,-10672.52 15455.57,-10654.14 15473.26,-10650.87 15491.91,-10647.23 15510.18,-10643.54"/>
<polygon fill="black" stroke="black" points="15510.89,-10646.97 15519.99,-10641.55 15509.5,-10640.11 15510.89,-10646.97"/>
</g>
<!-- ln2_0_10 -->
<g id="node299" class="node">
<title>ln2_0_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15956.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15956.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15956.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15956.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_10 -->
<g id="edge377" class="edge">
<title>residual_0&#45;&gt;ln2_0_10</title>
<path fill="none" stroke="black" d="M15179.5,-10706.08C15295.74,-10701.37 15565.46,-10687.53 15789.57,-10654.14 15806.14,-10651.67 15823.51,-10648.52 15840.54,-10645.1"/>
<polygon fill="black" stroke="black" points="15841.41,-10648.49 15850.51,-10643.06 15840.01,-10641.63 15841.41,-10648.49"/>
</g>
<!-- ln2_0_11 -->
<g id="node300" class="node">
<title>ln2_0_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16277.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16277.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16277.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16277.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_11 -->
<g id="edge378" class="edge">
<title>residual_0&#45;&gt;ln2_0_11</title>
<path fill="none" stroke="black" d="M15180.1,-10708.33C15333.96,-10708.12 15762.26,-10702.82 16114.57,-10654.14 16130.51,-10651.94 16147.2,-10648.97 16163.56,-10645.68"/>
<polygon fill="black" stroke="black" points="16164.61,-10649.04 16173.7,-10643.6 16163.2,-10642.19 16164.61,-10649.04"/>
</g>
<!-- ln2_0_12 -->
<g id="node301" class="node">
<title>ln2_0_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16595.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16595.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16595.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16595.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_12 -->
<g id="edge379" class="edge">
<title>residual_0&#45;&gt;ln2_0_12</title>
<path fill="none" stroke="black" d="M15180.08,-10707.16C15401.42,-10703.24 16187.62,-10687.23 16435.57,-10654.14 16451.01,-10652.08 16467.15,-10649.23 16482.98,-10646.03"/>
<polygon fill="black" stroke="black" points="16483.71,-10649.46 16492.8,-10644 16482.29,-10642.6 16483.71,-10649.46"/>
</g>
<!-- ln2_0_13 -->
<g id="node302" class="node">
<title>ln2_0_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16912.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16912.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16912.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16912.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_13 -->
<g id="edge380" class="edge">
<title>residual_0&#45;&gt;ln2_0_13</title>
<path fill="none" stroke="black" d="M15180.32,-10707.74C15434.41,-10705.76 16440.19,-10695.43 16753.57,-10654.14 16768.78,-10652.13 16784.66,-10649.35 16800.26,-10646.19"/>
<polygon fill="black" stroke="black" points="16801.38,-10649.54 16810.45,-10644.07 16799.95,-10642.68 16801.38,-10649.54"/>
</g>
<!-- ln2_0_14 -->
<g id="node303" class="node">
<title>ln2_0_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17229.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17229.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17229.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17229.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_14 -->
<g id="edge381" class="edge">
<title>residual_0&#45;&gt;ln2_0_14</title>
<path fill="none" stroke="black" d="M15179.77,-10706.96C15374.07,-10702.99 16018.2,-10689.38 16550.57,-10673.14 16781.73,-10666.08 16841.29,-10684.37 17070.57,-10654.14 17085.78,-10652.13 17101.66,-10649.34 17117.26,-10646.19"/>
<polygon fill="black" stroke="black" points="17118.38,-10649.53 17127.45,-10644.07 17116.95,-10642.68 17118.38,-10649.53"/>
</g>
<!-- ln2_0_15 -->
<g id="node304" class="node">
<title>ln2_0_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17817.57" cy="-10616.64" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17817.57" y="-10627.94" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17817.57" y="-10612.94" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17817.57" y="-10597.94" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_0&#45;&gt;ln2_0_15 -->
<g id="edge382" class="edge">
<title>residual_0&#45;&gt;ln2_0_15</title>
<path fill="none" stroke="black" d="M15180.28,-10708.14C15439.84,-10707.85 16510.44,-10703.58 17387.57,-10654.14 17481.74,-10648.83 17587.27,-10639.92 17670.22,-10632.23"/>
<polygon fill="black" stroke="black" points="17670.59,-10635.71 17680.22,-10631.3 17669.94,-10628.74 17670.59,-10635.71"/>
</g>
<!-- qkv_proj_0_0 -->
<g id="node68" class="node">
<title>qkv_proj_0_0</title>
<ellipse fill="orange" stroke="black" cx="1447.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="1447.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1447.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1447.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="1447.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1447.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_0&#45;&gt;qkv_proj_0_0 -->
<g id="edge97" class="edge">
<title>ln1_0_0&#45;&gt;qkv_proj_0_0</title>
<path fill="none" stroke="black" d="M2092.2,-12324.4C1955.63,-12301.01 1734.05,-12263.06 1589.56,-12238.31"/>
<polygon fill="black" stroke="black" points="1589.74,-12234.79 1579.29,-12236.55 1588.56,-12241.69 1589.74,-12234.79"/>
</g>
<!-- qkv_proj_0_1 -->
<g id="node69" class="node">
<title>qkv_proj_0_1</title>
<ellipse fill="orange" stroke="black" cx="1985.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="1985.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1985.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1985.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="1985.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1985.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_1&#45;&gt;qkv_proj_0_1 -->
<g id="edge98" class="edge">
<title>ln1_0_1&#45;&gt;qkv_proj_0_1</title>
<path fill="none" stroke="black" d="M4720.24,-12338.52C4228.73,-12316.14 2639.78,-12243.78 2138.54,-12220.96"/>
<polygon fill="black" stroke="black" points="2138.49,-12217.45 2128.34,-12220.49 2138.17,-12224.45 2138.49,-12217.45"/>
</g>
<!-- qkv_proj_0_2 -->
<g id="node70" class="node">
<title>qkv_proj_0_2</title>
<ellipse fill="orange" stroke="black" cx="6011.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="6011.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6011.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6011.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="6011.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6011.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_2&#45;&gt;qkv_proj_0_2 -->
<g id="edge99" class="edge">
<title>ln1_0_2&#45;&gt;qkv_proj_0_2</title>
<path fill="none" stroke="black" d="M6271.09,-12314.43C6227.34,-12297.49 6172.3,-12276.19 6124.19,-12257.57"/>
<polygon fill="black" stroke="black" points="6125.25,-12254.23 6114.66,-12253.89 6122.73,-12260.76 6125.25,-12254.23"/>
</g>
<!-- qkv_proj_0_3 -->
<g id="node71" class="node">
<title>qkv_proj_0_3</title>
<ellipse fill="orange" stroke="black" cx="6522.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="6522.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6522.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6522.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="6522.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="6522.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_3&#45;&gt;qkv_proj_0_3 -->
<g id="edge100" class="edge">
<title>ln1_0_3&#45;&gt;qkv_proj_0_3</title>
<path fill="none" stroke="black" d="M6731.85,-12312.75C6699.6,-12297.54 6660.5,-12279.08 6624.87,-12262.27"/>
<polygon fill="black" stroke="black" points="6625.94,-12258.91 6615.41,-12257.8 6622.96,-12265.24 6625.94,-12258.91"/>
</g>
<!-- qkv_proj_0_4 -->
<g id="node72" class="node">
<title>qkv_proj_0_4</title>
<ellipse fill="orange" stroke="black" cx="7319.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="7319.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7319.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="7319.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="7319.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="7319.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_4&#45;&gt;qkv_proj_0_4 -->
<g id="edge101" class="edge">
<title>ln1_0_4&#45;&gt;qkv_proj_0_4</title>
<path fill="none" stroke="black" d="M7831.75,-12321.5C7726.37,-12299.38 7568.87,-12266.32 7456.37,-12242.71"/>
<polygon fill="black" stroke="black" points="7456.81,-12239.22 7446.31,-12240.6 7455.38,-12246.08 7456.81,-12239.22"/>
</g>
<!-- qkv_proj_0_5 -->
<g id="node73" class="node">
<title>qkv_proj_0_5</title>
<ellipse fill="orange" stroke="black" cx="7962.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="7962.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7962.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7962.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="7962.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="7962.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_5&#45;&gt;qkv_proj_0_5 -->
<g id="edge102" class="edge">
<title>ln1_0_5&#45;&gt;qkv_proj_0_5</title>
<path fill="none" stroke="black" d="M8556.2,-12323.37C8431.53,-12300.4 8235.3,-12264.24 8102.91,-12239.85"/>
<polygon fill="black" stroke="black" points="8103.17,-12236.34 8092.7,-12237.97 8101.9,-12243.22 8103.17,-12236.34"/>
</g>
<!-- qkv_proj_0_6 -->
<g id="node74" class="node">
<title>qkv_proj_0_6</title>
<ellipse fill="orange" stroke="black" cx="8436.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8436.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8436.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8436.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="8436.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8436.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_6&#45;&gt;qkv_proj_0_6 -->
<g id="edge103" class="edge">
<title>ln1_0_6&#45;&gt;qkv_proj_0_6</title>
<path fill="none" stroke="black" d="M8969.82,-12325.62C8885.82,-12311.9 8772.71,-12292.38 8673.57,-12271.68 8638.96,-12264.46 8601.71,-12255.81 8567.22,-12247.43"/>
<polygon fill="black" stroke="black" points="8567.64,-12243.93 8557.1,-12244.96 8565.98,-12250.73 8567.64,-12243.93"/>
</g>
<!-- qkv_proj_0_7 -->
<g id="node75" class="node">
<title>qkv_proj_0_7</title>
<ellipse fill="orange" stroke="black" cx="8826.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8826.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8826.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8826.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="8826.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8826.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_7&#45;&gt;qkv_proj_0_7 -->
<g id="edge104" class="edge">
<title>ln1_0_7&#45;&gt;qkv_proj_0_7</title>
<path fill="none" stroke="black" d="M9480.89,-12331.03C9332.61,-12315.2 9105.68,-12289.45 9020.57,-12271.68 8996.61,-12266.68 8971.33,-12260.13 8947.22,-12253.25"/>
<polygon fill="black" stroke="black" points="8947.9,-12249.8 8937.33,-12250.38 8945.96,-12256.53 8947.9,-12249.8"/>
</g>
<!-- qkv_proj_0_8 -->
<g id="node76" class="node">
<title>qkv_proj_0_8</title>
<ellipse fill="orange" stroke="black" cx="9173.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9173.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9173.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9173.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="9173.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9173.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_8&#45;&gt;qkv_proj_0_8 -->
<g id="edge105" class="edge">
<title>ln1_0_8&#45;&gt;qkv_proj_0_8</title>
<path fill="none" stroke="black" d="M11108.09,-12341.89C10689.24,-12332.26 9517.66,-12302.85 9346.57,-12271.68 9326.9,-12268.1 9306.4,-12262.77 9286.68,-12256.78"/>
<polygon fill="black" stroke="black" points="9287.66,-12253.42 9277.08,-12253.79 9285.58,-12260.1 9287.66,-12253.42"/>
</g>
<!-- qkv_proj_0_9 -->
<g id="node77" class="node">
<title>qkv_proj_0_9</title>
<ellipse fill="orange" stroke="black" cx="9499.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9499.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9499.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9499.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="9499.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9499.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_9&#45;&gt;qkv_proj_0_9 -->
<g id="edge106" class="edge">
<title>ln1_0_9&#45;&gt;qkv_proj_0_9</title>
<path fill="none" stroke="black" d="M11525.54,-12323.58C11489.96,-12317.86 11450.78,-12312.28 11414.57,-12308.68 11010.89,-12268.6 10907.75,-12291.55 10502.57,-12271.68 10200.56,-12256.87 9847.63,-12235.67 9651.24,-12223.52"/>
<polygon fill="black" stroke="black" points="9651.33,-12220.02 9641.13,-12222.89 9650.9,-12227 9651.33,-12220.02"/>
</g>
<!-- qkv_proj_0_10 -->
<g id="node78" class="node">
<title>qkv_proj_0_10</title>
<ellipse fill="orange" stroke="black" cx="10655.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10655.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10655.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="10655.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="10655.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10655.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_10&#45;&gt;qkv_proj_0_10 -->
<g id="edge107" class="edge">
<title>ln1_0_10&#45;&gt;qkv_proj_0_10</title>
<path fill="none" stroke="black" d="M11895.99,-12322.68C11865.67,-12317.44 11832.98,-12312.34 11802.57,-12308.68 11559.33,-12279.44 11496.75,-12291.69 11252.57,-12271.68 11099.64,-12259.15 10924.97,-12241.93 10804.25,-12229.58"/>
<polygon fill="black" stroke="black" points="10804.5,-12226.08 10794.2,-12228.54 10803.79,-12233.05 10804.5,-12226.08"/>
</g>
<!-- qkv_proj_0_11 -->
<g id="node79" class="node">
<title>qkv_proj_0_11</title>
<ellipse fill="orange" stroke="black" cx="11405.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11405.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11405.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="11405.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="11405.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11405.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_11&#45;&gt;qkv_proj_0_11 -->
<g id="edge108" class="edge">
<title>ln1_0_11&#45;&gt;qkv_proj_0_11</title>
<path fill="none" stroke="black" d="M12340.13,-12328.9C12139.84,-12304.27 11761.18,-12257.72 11552.61,-12232.07"/>
<polygon fill="black" stroke="black" points="11552.85,-12228.58 11542.5,-12230.83 11551.99,-12235.52 11552.85,-12228.58"/>
</g>
<!-- qkv_proj_0_12 -->
<g id="node80" class="node">
<title>qkv_proj_0_12</title>
<ellipse fill="orange" stroke="black" cx="12646.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12646.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12646.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="12646.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="12646.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12646.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_12&#45;&gt;qkv_proj_0_12 -->
<g id="edge109" class="edge">
<title>ln1_0_12&#45;&gt;qkv_proj_0_12</title>
<path fill="none" stroke="black" d="M12983.53,-12316.8C12921.16,-12297.77 12838.32,-12272.5 12770.39,-12251.77"/>
<polygon fill="black" stroke="black" points="12771.07,-12248.32 12760.48,-12248.75 12769.03,-12255.01 12771.07,-12248.32"/>
</g>
<!-- qkv_proj_0_13 -->
<g id="node81" class="node">
<title>qkv_proj_0_13</title>
<ellipse fill="orange" stroke="black" cx="13089.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13089.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13089.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13089.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="13089.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13089.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_13&#45;&gt;qkv_proj_0_13 -->
<g id="edge110" class="edge">
<title>ln1_0_13&#45;&gt;qkv_proj_0_13</title>
<path fill="none" stroke="black" d="M13340.61,-12314.09C13298.83,-12297.44 13246.64,-12276.63 13200.69,-12258.3"/>
<polygon fill="black" stroke="black" points="13201.87,-12255.01 13191.29,-12254.55 13199.28,-12261.51 13201.87,-12255.01"/>
</g>
<!-- qkv_proj_0_14 -->
<g id="node82" class="node">
<title>qkv_proj_0_14</title>
<ellipse fill="orange" stroke="black" cx="13973.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13973.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13973.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13973.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="13973.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13973.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_14&#45;&gt;qkv_proj_0_14 -->
<g id="edge111" class="edge">
<title>ln1_0_14&#45;&gt;qkv_proj_0_14</title>
<path fill="none" stroke="black" d="M14050.61,-12309.34C14042.52,-12299.32 14033.48,-12288.14 14024.52,-12277.05"/>
<polygon fill="black" stroke="black" points="14027.04,-12274.59 14018.03,-12269.01 14021.59,-12278.99 14027.04,-12274.59"/>
</g>
<!-- qkv_proj_0_15 -->
<g id="node83" class="node">
<title>qkv_proj_0_15</title>
<ellipse fill="orange" stroke="black" cx="14434.57" cy="-12212.99" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14434.57" y="-12239.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14434.57" y="-12224.29" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14434.57" y="-12209.29" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="14434.57" y="-12194.29" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14434.57" y="-12179.29" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_0_15&#45;&gt;qkv_proj_0_15 -->
<g id="edge112" class="edge">
<title>ln1_0_15&#45;&gt;qkv_proj_0_15</title>
<path fill="none" stroke="black" d="M14495.4,-12308.99C14489.4,-12299.63 14482.76,-12289.26 14476.14,-12278.91"/>
<polygon fill="black" stroke="black" points="14478.93,-12276.78 14470.59,-12270.25 14473.04,-12280.56 14478.93,-12276.78"/>
</g>
<!-- reshape_qkv_0_0 -->
<g id="node84" class="node">
<title>reshape_qkv_0_0</title>
<ellipse fill="lightcyan" stroke="black" cx="623.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="623.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="623.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="623.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_0&#45;&gt;reshape_qkv_0_0 -->
<g id="edge113" class="edge">
<title>qkv_proj_0_0&#45;&gt;reshape_qkv_0_0</title>
<path fill="none" stroke="black" d="M1314.27,-12190.77C1162.62,-12166.63 916.13,-12127.38 762.27,-12102.89"/>
<polygon fill="black" stroke="black" points="762.7,-12099.41 752.28,-12101.29 761.6,-12106.32 762.7,-12099.41"/>
</g>
<!-- reshape_qkv_0_1 -->
<g id="node97" class="node">
<title>reshape_qkv_0_1</title>
<ellipse fill="lightcyan" stroke="black" cx="1599.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="1599.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1599.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1599.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_1&#45;&gt;reshape_qkv_0_1 -->
<g id="edge128" class="edge">
<title>qkv_proj_0_1&#45;&gt;reshape_qkv_0_1</title>
<path fill="none" stroke="black" d="M1876.25,-12174.84C1820,-12155.72 1751.99,-12132.6 1697.47,-12114.08"/>
<polygon fill="black" stroke="black" points="1698.4,-12110.69 1687.8,-12110.79 1696.14,-12117.32 1698.4,-12110.69"/>
</g>
<!-- reshape_qkv_0_2 -->
<g id="node109" class="node">
<title>reshape_qkv_0_2</title>
<ellipse fill="lightcyan" stroke="black" cx="2463.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="2463.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2463.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2463.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_2&#45;&gt;reshape_qkv_0_2 -->
<g id="edge143" class="edge">
<title>qkv_proj_0_2&#45;&gt;reshape_qkv_0_2</title>
<path fill="none" stroke="black" d="M5868.32,-12207.83C5457.03,-12195.73 4237.08,-12158.78 3224.57,-12117.3 3017.99,-12108.84 2779.95,-12097.1 2625.9,-12089.25"/>
<polygon fill="black" stroke="black" points="2626.04,-12085.75 2615.87,-12088.74 2625.68,-12092.74 2626.04,-12085.75"/>
</g>
<!-- reshape_qkv_0_3 -->
<g id="node121" class="node">
<title>reshape_qkv_0_3</title>
<ellipse fill="lightcyan" stroke="black" cx="3390.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="3390.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3390.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3390.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_3&#45;&gt;reshape_qkv_0_3 -->
<g id="edge158" class="edge">
<title>qkv_proj_0_3&#45;&gt;reshape_qkv_0_3</title>
<path fill="none" stroke="black" d="M6393.88,-12186.74C6325.97,-12174.56 6241.07,-12161.14 6164.57,-12154.3 5718.94,-12114.5 4598.74,-12132.13 4151.57,-12117.3 3944.6,-12110.44 3706.16,-12098.32 3552.15,-12089.94"/>
<polygon fill="black" stroke="black" points="3552.3,-12086.44 3542.13,-12089.39 3551.92,-12093.43 3552.3,-12086.44"/>
</g>
<!-- reshape_qkv_0_4 -->
<g id="node134" class="node">
<title>reshape_qkv_0_4</title>
<ellipse fill="lightcyan" stroke="black" cx="4317.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="4317.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4317.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4317.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_4&#45;&gt;reshape_qkv_0_4 -->
<g id="edge174" class="edge">
<title>qkv_proj_0_4&#45;&gt;reshape_qkv_0_4</title>
<path fill="none" stroke="black" d="M7181.27,-12196.94C7050.99,-12183.39 6850.27,-12164.14 6675.57,-12154.3 5966.73,-12114.39 5788.09,-12142.53 5078.57,-12117.3 4871.62,-12109.94 4633.17,-12097.94 4479.15,-12089.72"/>
<polygon fill="black" stroke="black" points="4479.31,-12086.22 4469.13,-12089.18 4478.93,-12093.21 4479.31,-12086.22"/>
</g>
<!-- reshape_qkv_0_5 -->
<g id="node147" class="node">
<title>reshape_qkv_0_5</title>
<ellipse fill="lightcyan" stroke="black" cx="5244.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="5244.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5244.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5244.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_5&#45;&gt;reshape_qkv_0_5 -->
<g id="edge189" class="edge">
<title>qkv_proj_0_5&#45;&gt;reshape_qkv_0_5</title>
<path fill="none" stroke="black" d="M7827.7,-12192.73C7729.45,-12179.52 7593.04,-12162.9 7472.57,-12154.3 6822.02,-12107.9 6657.34,-12141.15 6005.57,-12117.3 5798.79,-12109.74 5560.55,-12097.79 5406.52,-12089.64"/>
<polygon fill="black" stroke="black" points="5406.67,-12086.14 5396.5,-12089.11 5406.3,-12093.13 5406.67,-12086.14"/>
</g>
<!-- reshape_qkv_0_6 -->
<g id="node159" class="node">
<title>reshape_qkv_0_6</title>
<ellipse fill="lightcyan" stroke="black" cx="6171.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="6171.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6171.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6171.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_6&#45;&gt;reshape_qkv_0_6 -->
<g id="edge204" class="edge">
<title>qkv_proj_0_6&#45;&gt;reshape_qkv_0_6</title>
<path fill="none" stroke="black" d="M8310.26,-12184.88C8251.38,-12173.38 8180.19,-12161.08 8115.57,-12154.3 7592.41,-12099.41 7458.2,-12138.13 6932.57,-12117.3 6725.81,-12109.11 6487.57,-12097.3 6333.53,-12089.35"/>
<polygon fill="black" stroke="black" points="6333.67,-12085.86 6323.51,-12088.84 6333.31,-12092.85 6333.67,-12085.86"/>
</g>
<!-- reshape_qkv_0_7 -->
<g id="node171" class="node">
<title>reshape_qkv_0_7</title>
<ellipse fill="lightcyan" stroke="black" cx="7098.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="7098.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7098.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7098.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_7&#45;&gt;reshape_qkv_0_7 -->
<g id="edge219" class="edge">
<title>qkv_proj_0_7&#45;&gt;reshape_qkv_0_7</title>
<path fill="none" stroke="black" d="M8709.6,-12178.84C8671.62,-12169.34 8629.08,-12160.01 8589.57,-12154.3 8252.24,-12105.55 8164,-12134.1 7823.57,-12117.3 7630.24,-12107.77 7407.91,-12096.54 7260.98,-12089.08"/>
<polygon fill="black" stroke="black" points="7261.14,-12085.58 7250.97,-12088.57 7260.78,-12092.57 7261.14,-12085.58"/>
</g>
<!-- reshape_qkv_0_8 -->
<g id="node184" class="node">
<title>reshape_qkv_0_8</title>
<ellipse fill="lightcyan" stroke="black" cx="7989.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="7989.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7989.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7989.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_8&#45;&gt;reshape_qkv_0_8 -->
<g id="edge235" class="edge">
<title>qkv_proj_0_8&#45;&gt;reshape_qkv_0_8</title>
<path fill="none" stroke="black" d="M9064.03,-12174.96C9036.72,-12166.96 9007.31,-12159.4 8979.57,-12154.3 8693.41,-12101.76 8354.15,-12086.56 8156.27,-12082.29"/>
<polygon fill="black" stroke="black" points="8156.14,-12078.79 8146.07,-12082.08 8156,-12085.79 8156.14,-12078.79"/>
</g>
<!-- reshape_qkv_0_9 -->
<g id="node197" class="node">
<title>reshape_qkv_0_9</title>
<ellipse fill="lightcyan" stroke="black" cx="8916.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8916.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8916.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8916.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_9&#45;&gt;reshape_qkv_0_9 -->
<g id="edge250" class="edge">
<title>qkv_proj_0_9&#45;&gt;reshape_qkv_0_9</title>
<path fill="none" stroke="black" d="M9392.78,-12173.71C9371.04,-12166.67 9348.2,-12159.82 9326.57,-12154.3 9238.88,-12131.95 9138.94,-12113.88 9059.69,-12101.26"/>
<polygon fill="black" stroke="black" points="9060.06,-12097.77 9049.64,-12099.67 9058.97,-12104.69 9060.06,-12097.77"/>
</g>
<!-- reshape_qkv_0_10 -->
<g id="node209" class="node">
<title>reshape_qkv_0_10</title>
<ellipse fill="lightcyan" stroke="black" cx="9949.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9949.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9949.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9949.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_10&#45;&gt;reshape_qkv_0_10 -->
<g id="edge265" class="edge">
<title>qkv_proj_0_10&#45;&gt;reshape_qkv_0_10</title>
<path fill="none" stroke="black" d="M10525.67,-12187.86C10399.36,-12164.38 10208.47,-12128.91 10081.48,-12105.32"/>
<polygon fill="black" stroke="black" points="10081.78,-12101.81 10071.31,-12103.43 10080.5,-12108.69 10081.78,-12101.81"/>
</g>
<!-- reshape_qkv_0_11 -->
<g id="node221" class="node">
<title>reshape_qkv_0_11</title>
<ellipse fill="lightcyan" stroke="black" cx="10805.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10805.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10805.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10805.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_11&#45;&gt;reshape_qkv_0_11 -->
<g id="edge280" class="edge">
<title>qkv_proj_0_11&#45;&gt;reshape_qkv_0_11</title>
<path fill="none" stroke="black" d="M11279.79,-12184.49C11176.76,-12161.96 11031.78,-12130.26 10929.31,-12107.86"/>
<polygon fill="black" stroke="black" points="10930.04,-12104.44 10919.53,-12105.72 10928.55,-12111.28 10930.04,-12104.44"/>
</g>
<!-- reshape_qkv_0_12 -->
<g id="node234" class="node">
<title>reshape_qkv_0_12</title>
<ellipse fill="lightcyan" stroke="black" cx="11662.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11662.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11662.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11662.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_12&#45;&gt;reshape_qkv_0_12 -->
<g id="edge296" class="edge">
<title>qkv_proj_0_12&#45;&gt;reshape_qkv_0_12</title>
<path fill="none" stroke="black" d="M12510.79,-12193.89C12326.14,-12169.27 11997.21,-12125.42 11807.79,-12100.16"/>
<polygon fill="black" stroke="black" points="11808.13,-12096.68 11797.76,-12098.83 11807.21,-12103.62 11808.13,-12096.68"/>
</g>
<!-- reshape_qkv_0_13 -->
<g id="node247" class="node">
<title>reshape_qkv_0_13</title>
<ellipse fill="lightcyan" stroke="black" cx="12660.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12660.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12660.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12660.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_13&#45;&gt;reshape_qkv_0_13 -->
<g id="edge311" class="edge">
<title>qkv_proj_0_13&#45;&gt;reshape_qkv_0_13</title>
<path fill="none" stroke="black" d="M12975.74,-12177.18C12910.33,-12157.18 12828.78,-12132.24 12765.03,-12112.75"/>
<polygon fill="black" stroke="black" points="12765.94,-12109.37 12755.35,-12109.79 12763.89,-12116.06 12765.94,-12109.37"/>
</g>
<!-- reshape_qkv_0_14 -->
<g id="node259" class="node">
<title>reshape_qkv_0_14</title>
<ellipse fill="lightcyan" stroke="black" cx="13587.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13587.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13587.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13587.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_14&#45;&gt;reshape_qkv_0_14 -->
<g id="edge326" class="edge">
<title>qkv_proj_0_14&#45;&gt;reshape_qkv_0_14</title>
<path fill="none" stroke="black" d="M13864.25,-12174.84C13808,-12155.72 13739.99,-12132.6 13685.47,-12114.08"/>
<polygon fill="black" stroke="black" points="13686.4,-12110.69 13675.8,-12110.79 13684.14,-12117.32 13686.4,-12110.69"/>
</g>
<!-- reshape_qkv_0_15 -->
<g id="node271" class="node">
<title>reshape_qkv_0_15</title>
<ellipse fill="lightcyan" stroke="black" cx="14389.57" cy="-12079.8" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14389.57" y="-12091.1" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14389.57" y="-12076.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14389.57" y="-12061.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_0_15&#45;&gt;reshape_qkv_0_15 -->
<g id="edge341" class="edge">
<title>qkv_proj_0_15&#45;&gt;reshape_qkv_0_15</title>
<path fill="none" stroke="black" d="M14414.97,-12154.83C14411.77,-12145.5 14408.49,-12135.94 14405.39,-12126.92"/>
<polygon fill="black" stroke="black" points="14408.67,-12125.7 14402.12,-12117.38 14402.05,-12127.97 14408.67,-12125.7"/>
</g>
<!-- split_q_0_0 -->
<g id="node85" class="node">
<title>split_q_0_0</title>
<ellipse fill="pink" stroke="black" cx="145.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="145.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="145.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="145.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_q_0_0 -->
<g id="edge114" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_q_0_0</title>
<path fill="none" stroke="black" d="M511.43,-12053.64C449.02,-12039.57 369.95,-12021.63 299.57,-12005.3 286.99,-12002.39 273.83,-11999.31 260.74,-11996.23"/>
<polygon fill="black" stroke="black" points="261.29,-11992.76 250.75,-11993.87 259.68,-11999.57 261.29,-11992.76"/>
</g>
<!-- split_k_0_0 -->
<g id="node86" class="node">
<title>split_k_0_0</title>
<ellipse fill="pink" stroke="black" cx="454.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="454.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_k_0_0 -->
<g id="edge115" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_k_0_0</title>
<path fill="none" stroke="black" d="M570.56,-12044.3C553.09,-12032.93 533.53,-12020.2 515.52,-12008.47"/>
<polygon fill="black" stroke="black" points="517.11,-12005.33 506.81,-12002.81 513.29,-12011.2 517.11,-12005.33"/>
</g>
<!-- split_v_0_0 -->
<g id="node87" class="node">
<title>split_v_0_0</title>
<ellipse fill="pink" stroke="black" cx="763.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="763.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_0&#45;&gt;split_v_0_0 -->
<g id="edge116" class="edge">
<title>reshape_qkv_0_0&#45;&gt;split_v_0_0</title>
<path fill="none" stroke="black" d="M668.26,-12043.7C681.9,-12032.97 697.03,-12021.09 711.14,-12010"/>
<polygon fill="black" stroke="black" points="713.61,-12012.51 719.32,-12003.58 709.29,-12007 713.61,-12012.51"/>
</g>
<!-- transpose_q_0_0 -->
<g id="node88" class="node">
<title>transpose_q_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="145.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="145.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="145.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="145.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_0&#45;&gt;transpose_q_0_0 -->
<g id="edge117" class="edge">
<title>split_q_0_0&#45;&gt;transpose_q_0_0</title>
<path fill="none" stroke="black" d="M145.57,-11930.18C145.57,-11921.73 145.57,-11912.63 145.57,-11903.81"/>
<polygon fill="black" stroke="black" points="149.07,-11903.65 145.57,-11893.65 142.07,-11903.65 149.07,-11903.65"/>
</g>
<!-- transpose_k_0_0 -->
<g id="node89" class="node">
<title>transpose_k_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="454.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="454.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_0&#45;&gt;transpose_k_0_0 -->
<g id="edge118" class="edge">
<title>split_k_0_0&#45;&gt;transpose_k_0_0</title>
<path fill="none" stroke="black" d="M454.57,-11930.18C454.57,-11921.73 454.57,-11912.63 454.57,-11903.81"/>
<polygon fill="black" stroke="black" points="458.07,-11903.65 454.57,-11893.65 451.07,-11903.65 458.07,-11903.65"/>
</g>
<!-- transpose_v_0_0 -->
<g id="node90" class="node">
<title>transpose_v_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="763.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="763.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_0&#45;&gt;transpose_v_0_0 -->
<g id="edge119" class="edge">
<title>split_v_0_0&#45;&gt;transpose_v_0_0</title>
<path fill="none" stroke="black" d="M763.57,-11930.18C763.57,-11921.73 763.57,-11912.63 763.57,-11903.81"/>
<polygon fill="black" stroke="black" points="767.07,-11903.65 763.57,-11893.65 760.07,-11903.65 767.07,-11903.65"/>
</g>
<!-- attn_scores_0_0 -->
<g id="node91" class="node">
<title>attn_scores_0_0</title>
<ellipse fill="gold" stroke="black" cx="454.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="454.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="454.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="454.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_0&#45;&gt;attn_scores_0_0 -->
<g id="edge120" class="edge">
<title>transpose_q_0_0&#45;&gt;attn_scores_0_0</title>
<path fill="none" stroke="black" d="M229.19,-11825.04C268.91,-11810.9 316.6,-11793.92 357.86,-11779.23"/>
<polygon fill="black" stroke="black" points="359.13,-11782.49 367.38,-11775.84 356.79,-11775.9 359.13,-11782.49"/>
</g>
<!-- transpose_k_0_0&#45;&gt;attn_scores_0_0 -->
<g id="edge121" class="edge">
<title>transpose_k_0_0&#45;&gt;attn_scores_0_0</title>
<path fill="none" stroke="black" d="M454.57,-11818.18C454.57,-11809.73 454.57,-11800.63 454.57,-11791.81"/>
<polygon fill="black" stroke="black" points="458.07,-11791.65 454.57,-11781.65 451.07,-11791.65 458.07,-11791.65"/>
</g>
<!-- attn_output_0_0 -->
<g id="node92" class="node">
<title>attn_output_0_0</title>
<ellipse fill="gold" stroke="black" cx="763.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="763.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="763.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="763.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_0&#45;&gt;attn_output_0_0 -->
<g id="edge122" class="edge">
<title>transpose_v_0_0&#45;&gt;attn_output_0_0</title>
<path fill="none" stroke="black" d="M763.57,-11818.1C763.57,-11757.06 763.57,-11634.75 763.57,-11567.6"/>
<polygon fill="black" stroke="black" points="767.07,-11567.31 763.57,-11557.31 760.07,-11567.31 767.07,-11567.31"/>
</g>
<!-- softmax_0_0 -->
<g id="node93" class="node">
<title>softmax_0_0</title>
<ellipse fill="gold" stroke="black" cx="540.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="540.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="540.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="540.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_0&#45;&gt;softmax_0_0 -->
<g id="edge123" class="edge">
<title>attn_scores_0_0&#45;&gt;softmax_0_0</title>
<path fill="none" stroke="black" d="M482.73,-11706.79C490.16,-11697.29 498.25,-11686.93 505.98,-11677.06"/>
<polygon fill="black" stroke="black" points="508.95,-11678.94 512.35,-11668.9 503.43,-11674.63 508.95,-11678.94"/>
</g>
<!-- transpose_back_0_0 -->
<g id="node94" class="node">
<title>transpose_back_0_0</title>
<ellipse fill="lightgray" stroke="black" cx="1353.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1353.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="1353.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1353.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_0&#45;&gt;transpose_back_0_0 -->
<g id="edge125" class="edge">
<title>attn_output_0_0&#45;&gt;transpose_back_0_0</title>
<path fill="none" stroke="black" d="M879.79,-11497.14C980.04,-11478.45 1124.51,-11451.51 1227.53,-11432.3"/>
<polygon fill="black" stroke="black" points="1228.17,-11435.74 1237.36,-11430.47 1226.89,-11428.86 1228.17,-11435.74"/>
</g>
<!-- softmax_0_0&#45;&gt;attn_output_0_0 -->
<g id="edge124" class="edge">
<title>softmax_0_0&#45;&gt;attn_output_0_0</title>
<path fill="none" stroke="black" d="M608.09,-11597.5C633.43,-11585 662.38,-11570.72 688.38,-11557.9"/>
<polygon fill="black" stroke="black" points="690.02,-11560.99 697.44,-11553.43 686.92,-11554.71 690.02,-11560.99"/>
</g>
<!-- reshape_concat_0_0 -->
<g id="node95" class="node">
<title>reshape_concat_0_0</title>
<ellipse fill="lightcyan" stroke="black" cx="1691.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="1691.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="1691.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1691.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_0&#45;&gt;reshape_concat_0_0 -->
<g id="edge126" class="edge">
<title>transpose_back_0_0&#45;&gt;reshape_concat_0_0</title>
<path fill="none" stroke="black" d="M1442.38,-11377.9C1489.78,-11362.48 1548.14,-11343.48 1596.46,-11327.76"/>
<polygon fill="black" stroke="black" points="1597.56,-11331.08 1605.98,-11324.66 1595.39,-11324.42 1597.56,-11331.08"/>
</g>
<!-- allgather_dim_0_0 -->
<g id="node96" class="node">
<title>allgather_dim_0_0</title>
<polygon fill="red" stroke="black" points="2504.57,-11221.3 2331.57,-11168.3 2504.57,-11115.3 2677.57,-11168.3 2504.57,-11221.3"/>
<text text-anchor="middle" x="2504.57" y="-11179.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="2504.57" y="-11164.6" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="2504.57" y="-11149.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_0&#45;&gt;allgather_dim_0_0 -->
<g id="edge127" class="edge">
<title>reshape_concat_0_0&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M1806.76,-11277.02C1958.82,-11253.55 2225.45,-11212.39 2381.4,-11188.32"/>
<polygon fill="black" stroke="black" points="2382.16,-11191.74 2391.51,-11186.76 2381.09,-11184.82 2382.16,-11191.74"/>
</g>
<!-- head_group_0_0 -->
<g id="node133" class="node">
<title>head_group_0_0</title>
<polygon fill="lightyellow" stroke="black" points="8683.07,-11078.3 8486.07,-11078.3 8486.07,-11040.3 8683.07,-11040.3 8683.07,-11078.3"/>
<text text-anchor="middle" x="8584.57" y="-11063.1" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="8584.57" y="-11048.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_0&#45;&gt;head_group_0_0 -->
<g id="edge173" class="edge">
<title>allgather_dim_0_0&#45;&gt;head_group_0_0</title>
<path fill="none" stroke="black" d="M2665.24,-11164.48C3542.85,-11149.03 7744.25,-11075.09 8475.82,-11062.22"/>
<polygon fill="black" stroke="black" points="8475.89,-11065.72 8485.83,-11062.04 8475.77,-11058.72 8475.89,-11065.72"/>
</g>
<!-- split_q_0_1 -->
<g id="node98" class="node">
<title>split_q_0_1</title>
<ellipse fill="pink" stroke="black" cx="1072.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1072.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="1072.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1072.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_q_0_1 -->
<g id="edge129" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_q_0_1</title>
<path fill="none" stroke="black" d="M1477.96,-12056.06C1404.94,-12042.09 1310.26,-12023.46 1226.57,-12005.3 1213.61,-12002.49 1200.06,-11999.44 1186.6,-11996.34"/>
<polygon fill="black" stroke="black" points="1187.36,-11992.93 1176.83,-11994.08 1185.78,-11999.75 1187.36,-11992.93"/>
</g>
<!-- split_k_0_1 -->
<g id="node99" class="node">
<title>split_k_0_1</title>
<ellipse fill="pink" stroke="black" cx="1381.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="1381.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_k_0_1 -->
<g id="edge130" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_k_0_1</title>
<path fill="none" stroke="black" d="M1533.87,-12045.65C1509.19,-12033.2 1480.98,-12018.97 1455.6,-12006.16"/>
<polygon fill="black" stroke="black" points="1456.9,-12002.89 1446.39,-12001.51 1453.74,-12009.14 1456.9,-12002.89"/>
</g>
<!-- split_v_0_1 -->
<g id="node100" class="node">
<title>split_v_0_1</title>
<ellipse fill="pink" stroke="black" cx="1690.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="1690.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_1&#45;&gt;split_v_0_1 -->
<g id="edge131" class="edge">
<title>reshape_qkv_0_1&#45;&gt;split_v_0_1</title>
<path fill="none" stroke="black" d="M1629.37,-12042.79C1637.39,-12033.1 1646.14,-12022.51 1654.46,-12012.45"/>
<polygon fill="black" stroke="black" points="1657.34,-12014.46 1661.02,-12004.53 1651.95,-12010 1657.34,-12014.46"/>
</g>
<!-- transpose_q_0_1 -->
<g id="node101" class="node">
<title>transpose_q_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1072.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1072.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="1072.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1072.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_1&#45;&gt;transpose_q_0_1 -->
<g id="edge132" class="edge">
<title>split_q_0_1&#45;&gt;transpose_q_0_1</title>
<path fill="none" stroke="black" d="M1072.57,-11930.18C1072.57,-11921.73 1072.57,-11912.63 1072.57,-11903.81"/>
<polygon fill="black" stroke="black" points="1076.07,-11903.65 1072.57,-11893.65 1069.07,-11903.65 1076.07,-11903.65"/>
</g>
<!-- transpose_k_0_1 -->
<g id="node102" class="node">
<title>transpose_k_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1381.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="1381.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_1&#45;&gt;transpose_k_0_1 -->
<g id="edge133" class="edge">
<title>split_k_0_1&#45;&gt;transpose_k_0_1</title>
<path fill="none" stroke="black" d="M1381.57,-11930.18C1381.57,-11921.73 1381.57,-11912.63 1381.57,-11903.81"/>
<polygon fill="black" stroke="black" points="1385.07,-11903.65 1381.57,-11893.65 1378.07,-11903.65 1385.07,-11903.65"/>
</g>
<!-- transpose_v_0_1 -->
<g id="node103" class="node">
<title>transpose_v_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1690.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="1690.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_1&#45;&gt;transpose_v_0_1 -->
<g id="edge134" class="edge">
<title>split_v_0_1&#45;&gt;transpose_v_0_1</title>
<path fill="none" stroke="black" d="M1690.57,-11930.18C1690.57,-11921.73 1690.57,-11912.63 1690.57,-11903.81"/>
<polygon fill="black" stroke="black" points="1694.07,-11903.65 1690.57,-11893.65 1687.07,-11903.65 1694.07,-11903.65"/>
</g>
<!-- attn_scores_0_1 -->
<g id="node104" class="node">
<title>attn_scores_0_1</title>
<ellipse fill="gold" stroke="black" cx="1381.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="1381.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1381.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_1&#45;&gt;attn_scores_0_1 -->
<g id="edge135" class="edge">
<title>transpose_q_0_1&#45;&gt;attn_scores_0_1</title>
<path fill="none" stroke="black" d="M1156.19,-11825.04C1195.91,-11810.9 1243.6,-11793.92 1284.86,-11779.23"/>
<polygon fill="black" stroke="black" points="1286.13,-11782.49 1294.38,-11775.84 1283.79,-11775.9 1286.13,-11782.49"/>
</g>
<!-- transpose_k_0_1&#45;&gt;attn_scores_0_1 -->
<g id="edge136" class="edge">
<title>transpose_k_0_1&#45;&gt;attn_scores_0_1</title>
<path fill="none" stroke="black" d="M1381.57,-11818.18C1381.57,-11809.73 1381.57,-11800.63 1381.57,-11791.81"/>
<polygon fill="black" stroke="black" points="1385.07,-11791.65 1381.57,-11781.65 1378.07,-11791.65 1385.07,-11791.65"/>
</g>
<!-- attn_output_0_1 -->
<g id="node105" class="node">
<title>attn_output_0_1</title>
<ellipse fill="gold" stroke="black" cx="1690.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1690.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1690.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1690.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_1&#45;&gt;attn_output_0_1 -->
<g id="edge137" class="edge">
<title>transpose_v_0_1&#45;&gt;attn_output_0_1</title>
<path fill="none" stroke="black" d="M1690.57,-11818.1C1690.57,-11757.06 1690.57,-11634.75 1690.57,-11567.6"/>
<polygon fill="black" stroke="black" points="1694.07,-11567.31 1690.57,-11557.31 1687.07,-11567.31 1694.07,-11567.31"/>
</g>
<!-- softmax_0_1 -->
<g id="node106" class="node">
<title>softmax_0_1</title>
<ellipse fill="gold" stroke="black" cx="1438.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="1438.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1438.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1438.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_1&#45;&gt;softmax_0_1 -->
<g id="edge138" class="edge">
<title>attn_scores_0_1&#45;&gt;softmax_0_1</title>
<path fill="none" stroke="black" d="M1400.4,-11706.48C1405.11,-11697.38 1410.23,-11687.5 1415.15,-11678.02"/>
<polygon fill="black" stroke="black" points="1418.28,-11679.58 1419.77,-11669.09 1412.06,-11676.36 1418.28,-11679.58"/>
</g>
<!-- transpose_back_0_1 -->
<g id="node107" class="node">
<title>transpose_back_0_1</title>
<ellipse fill="lightgray" stroke="black" cx="1816.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1816.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="1816.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1816.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_1&#45;&gt;transpose_back_0_1 -->
<g id="edge140" class="edge">
<title>attn_output_0_1&#45;&gt;transpose_back_0_1</title>
<path fill="none" stroke="black" d="M1730.79,-11483.7C1742.83,-11473.18 1756.17,-11461.54 1768.66,-11450.63"/>
<polygon fill="black" stroke="black" points="1771.08,-11453.17 1776.31,-11443.95 1766.47,-11447.89 1771.08,-11453.17"/>
</g>
<!-- softmax_0_1&#45;&gt;attn_output_0_1 -->
<g id="edge139" class="edge">
<title>softmax_0_1&#45;&gt;attn_output_0_1</title>
<path fill="none" stroke="black" d="M1513.16,-11598.25C1543.15,-11585.16 1577.83,-11570.02 1608.52,-11556.62"/>
<polygon fill="black" stroke="black" points="1610.15,-11559.73 1617.91,-11552.52 1607.35,-11553.31 1610.15,-11559.73"/>
</g>
<!-- reshape_concat_0_1 -->
<g id="node108" class="node">
<title>reshape_concat_0_1</title>
<ellipse fill="lightcyan" stroke="black" cx="2138.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2138.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2138.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2138.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_1&#45;&gt;reshape_concat_0_1 -->
<g id="edge141" class="edge">
<title>transpose_back_0_1&#45;&gt;reshape_concat_0_1</title>
<path fill="none" stroke="black" d="M1902.44,-11377.47C1946.71,-11362.35 2000.74,-11343.89 2045.94,-11328.45"/>
<polygon fill="black" stroke="black" points="2047.12,-11331.75 2055.45,-11325.2 2044.85,-11325.12 2047.12,-11331.75"/>
</g>
<!-- reshape_concat_0_1&#45;&gt;allgather_dim_0_0 -->
<g id="edge142" class="edge">
<title>reshape_concat_0_1&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2221.62,-11266.33C2279.16,-11246.6 2355.72,-11220.35 2414.69,-11200.13"/>
<polygon fill="black" stroke="black" points="2416.04,-11203.36 2424.37,-11196.81 2413.77,-11196.74 2416.04,-11203.36"/>
</g>
<!-- split_q_0_2 -->
<g id="node110" class="node">
<title>split_q_0_2</title>
<ellipse fill="pink" stroke="black" cx="1999.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1999.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="1999.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1999.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_q_0_2 -->
<g id="edge144" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_q_0_2</title>
<path fill="none" stroke="black" d="M2354.2,-12052.87C2282.29,-12035.83 2188.33,-12013.55 2115.2,-11996.21"/>
<polygon fill="black" stroke="black" points="2115.56,-11992.7 2105.02,-11993.8 2113.94,-11999.51 2115.56,-11992.7"/>
</g>
<!-- split_k_0_2 -->
<g id="node111" class="node">
<title>split_k_0_2</title>
<ellipse fill="pink" stroke="black" cx="2308.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="2308.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_k_0_2 -->
<g id="edge145" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_k_0_2</title>
<path fill="none" stroke="black" d="M2414.53,-12044C2398.9,-12032.9 2381.47,-12020.54 2365.33,-12009.09"/>
<polygon fill="black" stroke="black" points="2367.21,-12006.13 2357.03,-12003.19 2363.16,-12011.84 2367.21,-12006.13"/>
</g>
<!-- split_v_0_2 -->
<g id="node112" class="node">
<title>split_v_0_2</title>
<ellipse fill="pink" stroke="black" cx="2617.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2617.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="2617.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2617.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_2&#45;&gt;split_v_0_2 -->
<g id="edge146" class="edge">
<title>reshape_qkv_0_2&#45;&gt;split_v_0_2</title>
<path fill="none" stroke="black" d="M2512.3,-12044C2527.83,-12032.9 2545.15,-12020.54 2561.18,-12009.09"/>
<polygon fill="black" stroke="black" points="2563.32,-12011.85 2569.43,-12003.19 2559.26,-12006.16 2563.32,-12011.85"/>
</g>
<!-- transpose_q_0_2 -->
<g id="node113" class="node">
<title>transpose_q_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="1999.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="1999.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="1999.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1999.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_2&#45;&gt;transpose_q_0_2 -->
<g id="edge147" class="edge">
<title>split_q_0_2&#45;&gt;transpose_q_0_2</title>
<path fill="none" stroke="black" d="M1999.57,-11930.18C1999.57,-11921.73 1999.57,-11912.63 1999.57,-11903.81"/>
<polygon fill="black" stroke="black" points="2003.07,-11903.65 1999.57,-11893.65 1996.07,-11903.65 2003.07,-11903.65"/>
</g>
<!-- transpose_k_0_2 -->
<g id="node114" class="node">
<title>transpose_k_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2308.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="2308.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_2&#45;&gt;transpose_k_0_2 -->
<g id="edge148" class="edge">
<title>split_k_0_2&#45;&gt;transpose_k_0_2</title>
<path fill="none" stroke="black" d="M2308.57,-11930.18C2308.57,-11921.73 2308.57,-11912.63 2308.57,-11903.81"/>
<polygon fill="black" stroke="black" points="2312.07,-11903.65 2308.57,-11893.65 2305.07,-11903.65 2312.07,-11903.65"/>
</g>
<!-- transpose_v_0_2 -->
<g id="node115" class="node">
<title>transpose_v_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2617.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2617.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="2617.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2617.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_2&#45;&gt;transpose_v_0_2 -->
<g id="edge149" class="edge">
<title>split_v_0_2&#45;&gt;transpose_v_0_2</title>
<path fill="none" stroke="black" d="M2617.57,-11930.18C2617.57,-11921.73 2617.57,-11912.63 2617.57,-11903.81"/>
<polygon fill="black" stroke="black" points="2621.07,-11903.65 2617.57,-11893.65 2614.07,-11903.65 2621.07,-11903.65"/>
</g>
<!-- attn_scores_0_2 -->
<g id="node116" class="node">
<title>attn_scores_0_2</title>
<ellipse fill="gold" stroke="black" cx="2308.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="2308.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2308.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2308.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_2&#45;&gt;attn_scores_0_2 -->
<g id="edge150" class="edge">
<title>transpose_q_0_2&#45;&gt;attn_scores_0_2</title>
<path fill="none" stroke="black" d="M2083.19,-11825.04C2122.91,-11810.9 2170.6,-11793.92 2211.86,-11779.23"/>
<polygon fill="black" stroke="black" points="2213.13,-11782.49 2221.38,-11775.84 2210.79,-11775.9 2213.13,-11782.49"/>
</g>
<!-- transpose_k_0_2&#45;&gt;attn_scores_0_2 -->
<g id="edge151" class="edge">
<title>transpose_k_0_2&#45;&gt;attn_scores_0_2</title>
<path fill="none" stroke="black" d="M2308.57,-11818.18C2308.57,-11809.73 2308.57,-11800.63 2308.57,-11791.81"/>
<polygon fill="black" stroke="black" points="2312.07,-11791.65 2308.57,-11781.65 2305.07,-11791.65 2312.07,-11791.65"/>
</g>
<!-- attn_output_0_2 -->
<g id="node117" class="node">
<title>attn_output_0_2</title>
<ellipse fill="gold" stroke="black" cx="2504.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2504.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2504.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2504.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_2&#45;&gt;attn_output_0_2 -->
<g id="edge152" class="edge">
<title>transpose_v_0_2&#45;&gt;attn_output_0_2</title>
<path fill="none" stroke="black" d="M2605.27,-11818.42C2584.57,-11757.27 2542.86,-11633.98 2520.16,-11566.87"/>
<polygon fill="black" stroke="black" points="2523.47,-11565.74 2516.95,-11557.39 2516.84,-11567.99 2523.47,-11565.74"/>
</g>
<!-- softmax_0_2 -->
<g id="node118" class="node">
<title>softmax_0_2</title>
<ellipse fill="gold" stroke="black" cx="2350.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="2350.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2350.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2350.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_2&#45;&gt;softmax_0_2 -->
<g id="edge153" class="edge">
<title>attn_scores_0_2&#45;&gt;softmax_0_2</title>
<path fill="none" stroke="black" d="M2322.56,-11706.18C2325.92,-11697.36 2329.56,-11687.84 2333.06,-11678.66"/>
<polygon fill="black" stroke="black" points="2336.35,-11679.86 2336.65,-11669.27 2329.81,-11677.37 2336.35,-11679.86"/>
</g>
<!-- transpose_back_0_2 -->
<g id="node119" class="node">
<title>transpose_back_0_2</title>
<ellipse fill="lightgray" stroke="black" cx="2504.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2504.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="2504.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2504.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_2&#45;&gt;transpose_back_0_2 -->
<g id="edge155" class="edge">
<title>attn_output_0_2&#45;&gt;transpose_back_0_2</title>
<path fill="none" stroke="black" d="M2504.57,-11482.18C2504.57,-11473.73 2504.57,-11464.63 2504.57,-11455.81"/>
<polygon fill="black" stroke="black" points="2508.07,-11455.65 2504.57,-11445.65 2501.07,-11455.65 2508.07,-11455.65"/>
</g>
<!-- softmax_0_2&#45;&gt;attn_output_0_2 -->
<g id="edge154" class="edge">
<title>softmax_0_2&#45;&gt;attn_output_0_2</title>
<path fill="none" stroke="black" d="M2399.72,-11595.7C2415.17,-11584.67 2432.33,-11572.4 2448.23,-11561.05"/>
<polygon fill="black" stroke="black" points="2450.31,-11563.86 2456.42,-11555.2 2446.24,-11558.17 2450.31,-11563.86"/>
</g>
<!-- reshape_concat_0_2 -->
<g id="node120" class="node">
<title>reshape_concat_0_2</title>
<ellipse fill="lightcyan" stroke="black" cx="2504.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2504.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2504.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2504.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_2&#45;&gt;reshape_concat_0_2 -->
<g id="edge156" class="edge">
<title>transpose_back_0_2&#45;&gt;reshape_concat_0_2</title>
<path fill="none" stroke="black" d="M2504.57,-11370.18C2504.57,-11361.73 2504.57,-11352.63 2504.57,-11343.81"/>
<polygon fill="black" stroke="black" points="2508.07,-11343.65 2504.57,-11333.65 2501.07,-11343.65 2508.07,-11343.65"/>
</g>
<!-- reshape_concat_0_2&#45;&gt;allgather_dim_0_0 -->
<g id="edge157" class="edge">
<title>reshape_concat_0_2&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2504.57,-11258.17C2504.57,-11249.86 2504.57,-11240.81 2504.57,-11231.77"/>
<polygon fill="black" stroke="black" points="2508.07,-11231.61 2504.57,-11221.61 2501.07,-11231.61 2508.07,-11231.61"/>
</g>
<!-- split_q_0_3 -->
<g id="node122" class="node">
<title>split_q_0_3</title>
<ellipse fill="pink" stroke="black" cx="2926.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2926.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="2926.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2926.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_q_0_3 -->
<g id="edge159" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_q_0_3</title>
<path fill="none" stroke="black" d="M3281.2,-12052.87C3209.29,-12035.83 3115.33,-12013.55 3042.2,-11996.21"/>
<polygon fill="black" stroke="black" points="3042.56,-11992.7 3032.02,-11993.8 3040.94,-11999.51 3042.56,-11992.7"/>
</g>
<!-- split_k_0_3 -->
<g id="node123" class="node">
<title>split_k_0_3</title>
<ellipse fill="pink" stroke="black" cx="3235.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3235.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="3235.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3235.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_k_0_3 -->
<g id="edge160" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_k_0_3</title>
<path fill="none" stroke="black" d="M3341.53,-12044C3325.9,-12032.9 3308.47,-12020.54 3292.33,-12009.09"/>
<polygon fill="black" stroke="black" points="3294.21,-12006.13 3284.03,-12003.19 3290.16,-12011.84 3294.21,-12006.13"/>
</g>
<!-- split_v_0_3 -->
<g id="node124" class="node">
<title>split_v_0_3</title>
<ellipse fill="pink" stroke="black" cx="3544.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3544.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="3544.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3544.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_3&#45;&gt;split_v_0_3 -->
<g id="edge161" class="edge">
<title>reshape_qkv_0_3&#45;&gt;split_v_0_3</title>
<path fill="none" stroke="black" d="M3439.3,-12044C3454.83,-12032.9 3472.15,-12020.54 3488.18,-12009.09"/>
<polygon fill="black" stroke="black" points="3490.32,-12011.85 3496.43,-12003.19 3486.26,-12006.16 3490.32,-12011.85"/>
</g>
<!-- transpose_q_0_3 -->
<g id="node125" class="node">
<title>transpose_q_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="2926.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2926.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="2926.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2926.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_3&#45;&gt;transpose_q_0_3 -->
<g id="edge162" class="edge">
<title>split_q_0_3&#45;&gt;transpose_q_0_3</title>
<path fill="none" stroke="black" d="M2926.57,-11930.18C2926.57,-11921.73 2926.57,-11912.63 2926.57,-11903.81"/>
<polygon fill="black" stroke="black" points="2930.07,-11903.65 2926.57,-11893.65 2923.07,-11903.65 2930.07,-11903.65"/>
</g>
<!-- transpose_k_0_3 -->
<g id="node126" class="node">
<title>transpose_k_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="3235.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3235.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="3235.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3235.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_3&#45;&gt;transpose_k_0_3 -->
<g id="edge163" class="edge">
<title>split_k_0_3&#45;&gt;transpose_k_0_3</title>
<path fill="none" stroke="black" d="M3235.57,-11930.18C3235.57,-11921.73 3235.57,-11912.63 3235.57,-11903.81"/>
<polygon fill="black" stroke="black" points="3239.07,-11903.65 3235.57,-11893.65 3232.07,-11903.65 3239.07,-11903.65"/>
</g>
<!-- transpose_v_0_3 -->
<g id="node127" class="node">
<title>transpose_v_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="3544.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3544.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="3544.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3544.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_3&#45;&gt;transpose_v_0_3 -->
<g id="edge164" class="edge">
<title>split_v_0_3&#45;&gt;transpose_v_0_3</title>
<path fill="none" stroke="black" d="M3544.57,-11930.18C3544.57,-11921.73 3544.57,-11912.63 3544.57,-11903.81"/>
<polygon fill="black" stroke="black" points="3548.07,-11903.65 3544.57,-11893.65 3541.07,-11903.65 3548.07,-11903.65"/>
</g>
<!-- attn_scores_0_3 -->
<g id="node128" class="node">
<title>attn_scores_0_3</title>
<ellipse fill="gold" stroke="black" cx="3067.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="3067.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3067.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3067.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_3&#45;&gt;attn_scores_0_3 -->
<g id="edge165" class="edge">
<title>transpose_q_0_3&#45;&gt;attn_scores_0_3</title>
<path fill="none" stroke="black" d="M2971.19,-11820C2984.81,-11809.37 2999.93,-11797.57 3014.08,-11786.54"/>
<polygon fill="black" stroke="black" points="3016.55,-11789.05 3022.28,-11780.14 3012.24,-11783.53 3016.55,-11789.05"/>
</g>
<!-- transpose_k_0_3&#45;&gt;attn_scores_0_3 -->
<g id="edge166" class="edge">
<title>transpose_k_0_3&#45;&gt;attn_scores_0_3</title>
<path fill="none" stroke="black" d="M3183.34,-11820.6C3166.2,-11809.38 3147,-11796.81 3129.24,-11785.18"/>
<polygon fill="black" stroke="black" points="3130.93,-11782.1 3120.64,-11779.55 3127.09,-11787.96 3130.93,-11782.1"/>
</g>
<!-- attn_output_0_3 -->
<g id="node129" class="node">
<title>attn_output_0_3</title>
<ellipse fill="gold" stroke="black" cx="3067.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3067.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3067.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3067.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_3&#45;&gt;attn_output_0_3 -->
<g id="edge167" class="edge">
<title>transpose_v_0_3&#45;&gt;attn_output_0_3</title>
<path fill="none" stroke="black" d="M3510.9,-11819.14C3458.12,-11764.83 3350.8,-11660.71 3243.57,-11594.3 3218.52,-11578.79 3189.61,-11565.17 3162.56,-11554.02"/>
<polygon fill="black" stroke="black" points="3163.66,-11550.69 3153.07,-11550.18 3161.03,-11557.18 3163.66,-11550.69"/>
</g>
<!-- softmax_0_3 -->
<g id="node130" class="node">
<title>softmax_0_3</title>
<ellipse fill="gold" stroke="black" cx="3067.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="3067.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3067.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3067.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_3&#45;&gt;softmax_0_3 -->
<g id="edge168" class="edge">
<title>attn_scores_0_3&#45;&gt;softmax_0_3</title>
<path fill="none" stroke="black" d="M3067.57,-11706.18C3067.57,-11697.73 3067.57,-11688.63 3067.57,-11679.81"/>
<polygon fill="black" stroke="black" points="3071.07,-11679.65 3067.57,-11669.65 3064.07,-11679.65 3071.07,-11679.65"/>
</g>
<!-- transpose_back_0_3 -->
<g id="node131" class="node">
<title>transpose_back_0_3</title>
<ellipse fill="lightgray" stroke="black" cx="2841.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="2841.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="2841.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2841.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_3&#45;&gt;transpose_back_0_3 -->
<g id="edge170" class="edge">
<title>attn_output_0_3&#45;&gt;transpose_back_0_3</title>
<path fill="none" stroke="black" d="M3000.99,-11486.4C2974.67,-11473.58 2944.28,-11458.79 2917.14,-11445.58"/>
<polygon fill="black" stroke="black" points="2918.6,-11442.4 2908.07,-11441.17 2915.53,-11448.69 2918.6,-11442.4"/>
</g>
<!-- softmax_0_3&#45;&gt;attn_output_0_3 -->
<g id="edge169" class="edge">
<title>softmax_0_3&#45;&gt;attn_output_0_3</title>
<path fill="none" stroke="black" d="M3067.57,-11594.18C3067.57,-11585.73 3067.57,-11576.63 3067.57,-11567.81"/>
<polygon fill="black" stroke="black" points="3071.07,-11567.65 3067.57,-11557.65 3064.07,-11567.65 3071.07,-11567.65"/>
</g>
<!-- reshape_concat_0_3 -->
<g id="node132" class="node">
<title>reshape_concat_0_3</title>
<ellipse fill="lightcyan" stroke="black" cx="2809.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="2809.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="2809.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2809.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_3&#45;&gt;reshape_concat_0_3 -->
<g id="edge171" class="edge">
<title>transpose_back_0_3&#45;&gt;reshape_concat_0_3</title>
<path fill="none" stroke="black" d="M2830.92,-11370.18C2828.38,-11361.46 2825.64,-11352.04 2823,-11342.95"/>
<polygon fill="black" stroke="black" points="2826.34,-11341.9 2820.18,-11333.27 2819.62,-11343.85 2826.34,-11341.9"/>
</g>
<!-- reshape_concat_0_3&#45;&gt;allgather_dim_0_0 -->
<g id="edge172" class="edge">
<title>reshape_concat_0_3&#45;&gt;allgather_dim_0_0</title>
<path fill="none" stroke="black" d="M2735.74,-11264.42C2690.71,-11245.9 2633.09,-11222.18 2586.63,-11203.07"/>
<polygon fill="black" stroke="black" points="2587.78,-11199.76 2577.2,-11199.19 2585.11,-11206.23 2587.78,-11199.76"/>
</g>
<!-- output_proj_0_0 -->
<g id="node284" class="node">
<title>output_proj_0_0</title>
<ellipse fill="orange" stroke="black" cx="9953.57" cy="-10955.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="9953.57" y="-10974.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9953.57" y="-10959.02" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="9953.57" y="-10944.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="9953.57" y="-10929.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_0&#45;&gt;output_proj_0_0 -->
<g id="edge357" class="edge">
<title>head_group_0_0&#45;&gt;output_proj_0_0</title>
<path fill="none" stroke="black" d="M8683.3,-11050.94C8921.22,-11033.2 9527.21,-10988.01 9807.41,-10967.12"/>
<polygon fill="black" stroke="black" points="9807.93,-10970.59 9817.64,-10966.36 9807.41,-10963.61 9807.93,-10970.59"/>
</g>
<!-- split_q_0_4 -->
<g id="node135" class="node">
<title>split_q_0_4</title>
<ellipse fill="pink" stroke="black" cx="3853.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3853.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="3853.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3853.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_q_0_4 -->
<g id="edge175" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_q_0_4</title>
<path fill="none" stroke="black" d="M4208.2,-12052.87C4136.29,-12035.83 4042.33,-12013.55 3969.2,-11996.21"/>
<polygon fill="black" stroke="black" points="3969.56,-11992.7 3959.02,-11993.8 3967.94,-11999.51 3969.56,-11992.7"/>
</g>
<!-- split_k_0_4 -->
<g id="node136" class="node">
<title>split_k_0_4</title>
<ellipse fill="pink" stroke="black" cx="4162.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="4162.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_k_0_4 -->
<g id="edge176" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_k_0_4</title>
<path fill="none" stroke="black" d="M4268.53,-12044C4252.9,-12032.9 4235.47,-12020.54 4219.33,-12009.09"/>
<polygon fill="black" stroke="black" points="4221.21,-12006.13 4211.03,-12003.19 4217.16,-12011.84 4221.21,-12006.13"/>
</g>
<!-- split_v_0_4 -->
<g id="node137" class="node">
<title>split_v_0_4</title>
<ellipse fill="pink" stroke="black" cx="4471.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="4471.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_4&#45;&gt;split_v_0_4 -->
<g id="edge177" class="edge">
<title>reshape_qkv_0_4&#45;&gt;split_v_0_4</title>
<path fill="none" stroke="black" d="M4366.3,-12044C4381.83,-12032.9 4399.15,-12020.54 4415.18,-12009.09"/>
<polygon fill="black" stroke="black" points="4417.32,-12011.85 4423.43,-12003.19 4413.26,-12006.16 4417.32,-12011.85"/>
</g>
<!-- transpose_q_0_4 -->
<g id="node138" class="node">
<title>transpose_q_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="3853.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="3853.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="3853.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3853.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_4&#45;&gt;transpose_q_0_4 -->
<g id="edge178" class="edge">
<title>split_q_0_4&#45;&gt;transpose_q_0_4</title>
<path fill="none" stroke="black" d="M3853.57,-11930.18C3853.57,-11921.73 3853.57,-11912.63 3853.57,-11903.81"/>
<polygon fill="black" stroke="black" points="3857.07,-11903.65 3853.57,-11893.65 3850.07,-11903.65 3857.07,-11903.65"/>
</g>
<!-- transpose_k_0_4 -->
<g id="node139" class="node">
<title>transpose_k_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4162.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="4162.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_4&#45;&gt;transpose_k_0_4 -->
<g id="edge179" class="edge">
<title>split_k_0_4&#45;&gt;transpose_k_0_4</title>
<path fill="none" stroke="black" d="M4162.57,-11930.18C4162.57,-11921.73 4162.57,-11912.63 4162.57,-11903.81"/>
<polygon fill="black" stroke="black" points="4166.07,-11903.65 4162.57,-11893.65 4159.07,-11903.65 4166.07,-11903.65"/>
</g>
<!-- transpose_v_0_4 -->
<g id="node140" class="node">
<title>transpose_v_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4471.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="4471.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_4&#45;&gt;transpose_v_0_4 -->
<g id="edge180" class="edge">
<title>split_v_0_4&#45;&gt;transpose_v_0_4</title>
<path fill="none" stroke="black" d="M4471.57,-11930.18C4471.57,-11921.73 4471.57,-11912.63 4471.57,-11903.81"/>
<polygon fill="black" stroke="black" points="4475.07,-11903.65 4471.57,-11893.65 4468.07,-11903.65 4475.07,-11903.65"/>
</g>
<!-- attn_scores_0_4 -->
<g id="node141" class="node">
<title>attn_scores_0_4</title>
<ellipse fill="gold" stroke="black" cx="4162.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="4162.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4162.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4162.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_4&#45;&gt;attn_scores_0_4 -->
<g id="edge181" class="edge">
<title>transpose_q_0_4&#45;&gt;attn_scores_0_4</title>
<path fill="none" stroke="black" d="M3937.19,-11825.04C3976.91,-11810.9 4024.6,-11793.92 4065.86,-11779.23"/>
<polygon fill="black" stroke="black" points="4067.13,-11782.49 4075.38,-11775.84 4064.79,-11775.9 4067.13,-11782.49"/>
</g>
<!-- transpose_k_0_4&#45;&gt;attn_scores_0_4 -->
<g id="edge182" class="edge">
<title>transpose_k_0_4&#45;&gt;attn_scores_0_4</title>
<path fill="none" stroke="black" d="M4162.57,-11818.18C4162.57,-11809.73 4162.57,-11800.63 4162.57,-11791.81"/>
<polygon fill="black" stroke="black" points="4166.07,-11791.65 4162.57,-11781.65 4159.07,-11791.65 4166.07,-11791.65"/>
</g>
<!-- attn_output_0_4 -->
<g id="node142" class="node">
<title>attn_output_0_4</title>
<ellipse fill="gold" stroke="black" cx="4471.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4471.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4471.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4471.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_4&#45;&gt;attn_output_0_4 -->
<g id="edge183" class="edge">
<title>transpose_v_0_4&#45;&gt;attn_output_0_4</title>
<path fill="none" stroke="black" d="M4471.57,-11818.1C4471.57,-11757.06 4471.57,-11634.75 4471.57,-11567.6"/>
<polygon fill="black" stroke="black" points="4475.07,-11567.31 4471.57,-11557.31 4468.07,-11567.31 4475.07,-11567.31"/>
</g>
<!-- softmax_0_4 -->
<g id="node143" class="node">
<title>softmax_0_4</title>
<ellipse fill="gold" stroke="black" cx="4219.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="4219.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4219.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4219.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_4&#45;&gt;softmax_0_4 -->
<g id="edge184" class="edge">
<title>attn_scores_0_4&#45;&gt;softmax_0_4</title>
<path fill="none" stroke="black" d="M4181.4,-11706.48C4186.11,-11697.38 4191.23,-11687.5 4196.15,-11678.02"/>
<polygon fill="black" stroke="black" points="4199.28,-11679.58 4200.77,-11669.09 4193.06,-11676.36 4199.28,-11679.58"/>
</g>
<!-- transpose_back_0_4 -->
<g id="node144" class="node">
<title>transpose_back_0_4</title>
<ellipse fill="lightgray" stroke="black" cx="4708.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4708.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="4708.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="4708.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_4&#45;&gt;transpose_back_0_4 -->
<g id="edge186" class="edge">
<title>attn_output_0_4&#45;&gt;transpose_back_0_4</title>
<path fill="none" stroke="black" d="M4540.76,-11486.69C4568.75,-11473.7 4601.2,-11458.64 4630.06,-11445.24"/>
<polygon fill="black" stroke="black" points="4631.7,-11448.34 4639.3,-11440.96 4628.76,-11441.99 4631.7,-11448.34"/>
</g>
<!-- softmax_0_4&#45;&gt;attn_output_0_4 -->
<g id="edge185" class="edge">
<title>softmax_0_4&#45;&gt;attn_output_0_4</title>
<path fill="none" stroke="black" d="M4294.16,-11598.25C4324.15,-11585.16 4358.83,-11570.02 4389.52,-11556.62"/>
<polygon fill="black" stroke="black" points="4391.15,-11559.73 4398.91,-11552.52 4388.35,-11553.31 4391.15,-11559.73"/>
</g>
<!-- reshape_concat_0_4 -->
<g id="node145" class="node">
<title>reshape_concat_0_4</title>
<ellipse fill="lightcyan" stroke="black" cx="5158.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="5158.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="5158.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="5158.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_4&#45;&gt;reshape_concat_0_4 -->
<g id="edge187" class="edge">
<title>transpose_back_0_4&#45;&gt;reshape_concat_0_4</title>
<path fill="none" stroke="black" d="M4812.38,-11381.43C4883.4,-11364.07 4977.39,-11341.09 5049.51,-11323.46"/>
<polygon fill="black" stroke="black" points="5050.66,-11326.79 5059.54,-11321.01 5048.99,-11319.99 5050.66,-11326.79"/>
</g>
<!-- allgather_dim_0_1 -->
<g id="node146" class="node">
<title>allgather_dim_0_1</title>
<polygon fill="red" stroke="black" points="6226.57,-11221.3 6053.57,-11168.3 6226.57,-11115.3 6399.57,-11168.3 6226.57,-11221.3"/>
<text text-anchor="middle" x="6226.57" y="-11179.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="6226.57" y="-11164.6" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6226.57" y="-11149.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_4&#45;&gt;allgather_dim_0_1 -->
<g id="edge188" class="edge">
<title>reshape_concat_0_4&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M5280.05,-11280.53C5481.76,-11256.83 5884.28,-11209.53 6093.45,-11184.95"/>
<polygon fill="black" stroke="black" points="6094.05,-11188.4 6103.57,-11183.76 6093.23,-11181.45 6094.05,-11188.4"/>
</g>
<!-- head_group_0_1 -->
<g id="node183" class="node">
<title>head_group_0_1</title>
<polygon fill="lightyellow" stroke="black" points="9732.07,-11078.3 9535.07,-11078.3 9535.07,-11040.3 9732.07,-11040.3 9732.07,-11078.3"/>
<text text-anchor="middle" x="9633.57" y="-11063.1" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9633.57" y="-11048.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_1&#45;&gt;head_group_0_1 -->
<g id="edge234" class="edge">
<title>allgather_dim_0_1&#45;&gt;head_group_0_1</title>
<path fill="none" stroke="black" d="M6380.7,-11162.46C6963.84,-11144.15 9027.22,-11079.35 9524.95,-11063.72"/>
<polygon fill="black" stroke="black" points="9525.12,-11067.21 9535,-11063.4 9524.9,-11060.22 9525.12,-11067.21"/>
</g>
<!-- split_q_0_5 -->
<g id="node148" class="node">
<title>split_q_0_5</title>
<ellipse fill="pink" stroke="black" cx="4780.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4780.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="4780.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4780.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_q_0_5 -->
<g id="edge190" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_q_0_5</title>
<path fill="none" stroke="black" d="M5135.2,-12052.87C5063.29,-12035.83 4969.33,-12013.55 4896.2,-11996.21"/>
<polygon fill="black" stroke="black" points="4896.56,-11992.7 4886.02,-11993.8 4894.94,-11999.51 4896.56,-11992.7"/>
</g>
<!-- split_k_0_5 -->
<g id="node149" class="node">
<title>split_k_0_5</title>
<ellipse fill="pink" stroke="black" cx="5089.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="5089.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_k_0_5 -->
<g id="edge191" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_k_0_5</title>
<path fill="none" stroke="black" d="M5195.53,-12044C5179.9,-12032.9 5162.47,-12020.54 5146.33,-12009.09"/>
<polygon fill="black" stroke="black" points="5148.21,-12006.13 5138.03,-12003.19 5144.16,-12011.84 5148.21,-12006.13"/>
</g>
<!-- split_v_0_5 -->
<g id="node150" class="node">
<title>split_v_0_5</title>
<ellipse fill="pink" stroke="black" cx="5398.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="5398.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_5&#45;&gt;split_v_0_5 -->
<g id="edge192" class="edge">
<title>reshape_qkv_0_5&#45;&gt;split_v_0_5</title>
<path fill="none" stroke="black" d="M5293.3,-12044C5308.83,-12032.9 5326.15,-12020.54 5342.18,-12009.09"/>
<polygon fill="black" stroke="black" points="5344.32,-12011.85 5350.43,-12003.19 5340.26,-12006.16 5344.32,-12011.85"/>
</g>
<!-- transpose_q_0_5 -->
<g id="node151" class="node">
<title>transpose_q_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="4780.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="4780.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="4780.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4780.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_5&#45;&gt;transpose_q_0_5 -->
<g id="edge193" class="edge">
<title>split_q_0_5&#45;&gt;transpose_q_0_5</title>
<path fill="none" stroke="black" d="M4780.57,-11930.18C4780.57,-11921.73 4780.57,-11912.63 4780.57,-11903.81"/>
<polygon fill="black" stroke="black" points="4784.07,-11903.65 4780.57,-11893.65 4777.07,-11903.65 4784.07,-11903.65"/>
</g>
<!-- transpose_k_0_5 -->
<g id="node152" class="node">
<title>transpose_k_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5089.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="5089.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_5&#45;&gt;transpose_k_0_5 -->
<g id="edge194" class="edge">
<title>split_k_0_5&#45;&gt;transpose_k_0_5</title>
<path fill="none" stroke="black" d="M5089.57,-11930.18C5089.57,-11921.73 5089.57,-11912.63 5089.57,-11903.81"/>
<polygon fill="black" stroke="black" points="5093.07,-11903.65 5089.57,-11893.65 5086.07,-11903.65 5093.07,-11903.65"/>
</g>
<!-- transpose_v_0_5 -->
<g id="node153" class="node">
<title>transpose_v_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5398.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="5398.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_5&#45;&gt;transpose_v_0_5 -->
<g id="edge195" class="edge">
<title>split_v_0_5&#45;&gt;transpose_v_0_5</title>
<path fill="none" stroke="black" d="M5398.57,-11930.18C5398.57,-11921.73 5398.57,-11912.63 5398.57,-11903.81"/>
<polygon fill="black" stroke="black" points="5402.07,-11903.65 5398.57,-11893.65 5395.07,-11903.65 5402.07,-11903.65"/>
</g>
<!-- attn_scores_0_5 -->
<g id="node154" class="node">
<title>attn_scores_0_5</title>
<ellipse fill="gold" stroke="black" cx="5089.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="5089.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5089.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5089.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_5&#45;&gt;attn_scores_0_5 -->
<g id="edge196" class="edge">
<title>transpose_q_0_5&#45;&gt;attn_scores_0_5</title>
<path fill="none" stroke="black" d="M4864.19,-11825.04C4903.91,-11810.9 4951.6,-11793.92 4992.86,-11779.23"/>
<polygon fill="black" stroke="black" points="4994.13,-11782.49 5002.38,-11775.84 4991.79,-11775.9 4994.13,-11782.49"/>
</g>
<!-- transpose_k_0_5&#45;&gt;attn_scores_0_5 -->
<g id="edge197" class="edge">
<title>transpose_k_0_5&#45;&gt;attn_scores_0_5</title>
<path fill="none" stroke="black" d="M5089.57,-11818.18C5089.57,-11809.73 5089.57,-11800.63 5089.57,-11791.81"/>
<polygon fill="black" stroke="black" points="5093.07,-11791.65 5089.57,-11781.65 5086.07,-11791.65 5093.07,-11791.65"/>
</g>
<!-- attn_output_0_5 -->
<g id="node155" class="node">
<title>attn_output_0_5</title>
<ellipse fill="gold" stroke="black" cx="5398.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5398.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5398.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5398.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_5&#45;&gt;attn_output_0_5 -->
<g id="edge198" class="edge">
<title>transpose_v_0_5&#45;&gt;attn_output_0_5</title>
<path fill="none" stroke="black" d="M5398.57,-11818.1C5398.57,-11757.06 5398.57,-11634.75 5398.57,-11567.6"/>
<polygon fill="black" stroke="black" points="5402.07,-11567.31 5398.57,-11557.31 5395.07,-11567.31 5402.07,-11567.31"/>
</g>
<!-- softmax_0_5 -->
<g id="node156" class="node">
<title>softmax_0_5</title>
<ellipse fill="gold" stroke="black" cx="5146.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="5146.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5146.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5146.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_5&#45;&gt;softmax_0_5 -->
<g id="edge199" class="edge">
<title>attn_scores_0_5&#45;&gt;softmax_0_5</title>
<path fill="none" stroke="black" d="M5108.4,-11706.48C5113.11,-11697.38 5118.23,-11687.5 5123.15,-11678.02"/>
<polygon fill="black" stroke="black" points="5126.28,-11679.58 5127.77,-11669.09 5120.06,-11676.36 5126.28,-11679.58"/>
</g>
<!-- transpose_back_0_5 -->
<g id="node157" class="node">
<title>transpose_back_0_5</title>
<ellipse fill="lightgray" stroke="black" cx="5763.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5763.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="5763.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5763.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_5&#45;&gt;transpose_back_0_5 -->
<g id="edge201" class="edge">
<title>attn_output_0_5&#45;&gt;transpose_back_0_5</title>
<path fill="none" stroke="black" d="M5491.62,-11490.76C5543.32,-11475.18 5607.74,-11455.77 5660.9,-11439.75"/>
<polygon fill="black" stroke="black" points="5662.13,-11443.03 5670.69,-11436.8 5660.11,-11436.33 5662.13,-11443.03"/>
</g>
<!-- softmax_0_5&#45;&gt;attn_output_0_5 -->
<g id="edge200" class="edge">
<title>softmax_0_5&#45;&gt;attn_output_0_5</title>
<path fill="none" stroke="black" d="M5221.16,-11598.25C5251.15,-11585.16 5285.83,-11570.02 5316.52,-11556.62"/>
<polygon fill="black" stroke="black" points="5318.15,-11559.73 5325.91,-11552.52 5315.35,-11553.31 5318.15,-11559.73"/>
</g>
<!-- reshape_concat_0_5 -->
<g id="node158" class="node">
<title>reshape_concat_0_5</title>
<ellipse fill="lightcyan" stroke="black" cx="5930.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="5930.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="5930.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5930.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_5&#45;&gt;reshape_concat_0_5 -->
<g id="edge202" class="edge">
<title>transpose_back_0_5&#45;&gt;reshape_concat_0_5</title>
<path fill="none" stroke="black" d="M5815.5,-11372.6C5832.94,-11361.11 5852.54,-11348.2 5870.56,-11336.34"/>
<polygon fill="black" stroke="black" points="5872.83,-11339.03 5879.25,-11330.61 5868.98,-11333.18 5872.83,-11339.03"/>
</g>
<!-- reshape_concat_0_5&#45;&gt;allgather_dim_0_1 -->
<g id="edge203" class="edge">
<title>reshape_concat_0_5&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M6002.6,-11264.26C6045.9,-11245.91 6101.1,-11222.5 6145.86,-11203.53"/>
<polygon fill="black" stroke="black" points="6147.4,-11206.67 6155.25,-11199.55 6144.67,-11200.23 6147.4,-11206.67"/>
</g>
<!-- split_q_0_6 -->
<g id="node160" class="node">
<title>split_q_0_6</title>
<ellipse fill="pink" stroke="black" cx="5707.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5707.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="5707.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="5707.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_q_0_6 -->
<g id="edge205" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_q_0_6</title>
<path fill="none" stroke="black" d="M6062.2,-12052.87C5990.29,-12035.83 5896.33,-12013.55 5823.2,-11996.21"/>
<polygon fill="black" stroke="black" points="5823.56,-11992.7 5813.02,-11993.8 5821.94,-11999.51 5823.56,-11992.7"/>
</g>
<!-- split_k_0_6 -->
<g id="node161" class="node">
<title>split_k_0_6</title>
<ellipse fill="pink" stroke="black" cx="6016.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="6016.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_k_0_6 -->
<g id="edge206" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_k_0_6</title>
<path fill="none" stroke="black" d="M6122.53,-12044C6106.9,-12032.9 6089.47,-12020.54 6073.33,-12009.09"/>
<polygon fill="black" stroke="black" points="6075.21,-12006.13 6065.03,-12003.19 6071.16,-12011.84 6075.21,-12006.13"/>
</g>
<!-- split_v_0_6 -->
<g id="node162" class="node">
<title>split_v_0_6</title>
<ellipse fill="pink" stroke="black" cx="6325.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6325.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="6325.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6325.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_6&#45;&gt;split_v_0_6 -->
<g id="edge207" class="edge">
<title>reshape_qkv_0_6&#45;&gt;split_v_0_6</title>
<path fill="none" stroke="black" d="M6220.3,-12044C6235.83,-12032.9 6253.15,-12020.54 6269.18,-12009.09"/>
<polygon fill="black" stroke="black" points="6271.32,-12011.85 6277.43,-12003.19 6267.26,-12006.16 6271.32,-12011.85"/>
</g>
<!-- transpose_q_0_6 -->
<g id="node163" class="node">
<title>transpose_q_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="5707.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="5707.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="5707.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="5707.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_6&#45;&gt;transpose_q_0_6 -->
<g id="edge208" class="edge">
<title>split_q_0_6&#45;&gt;transpose_q_0_6</title>
<path fill="none" stroke="black" d="M5707.57,-11930.18C5707.57,-11921.73 5707.57,-11912.63 5707.57,-11903.81"/>
<polygon fill="black" stroke="black" points="5711.07,-11903.65 5707.57,-11893.65 5704.07,-11903.65 5711.07,-11903.65"/>
</g>
<!-- transpose_k_0_6 -->
<g id="node164" class="node">
<title>transpose_k_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6016.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="6016.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_6&#45;&gt;transpose_k_0_6 -->
<g id="edge209" class="edge">
<title>split_k_0_6&#45;&gt;transpose_k_0_6</title>
<path fill="none" stroke="black" d="M6016.57,-11930.18C6016.57,-11921.73 6016.57,-11912.63 6016.57,-11903.81"/>
<polygon fill="black" stroke="black" points="6020.07,-11903.65 6016.57,-11893.65 6013.07,-11903.65 6020.07,-11903.65"/>
</g>
<!-- transpose_v_0_6 -->
<g id="node165" class="node">
<title>transpose_v_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6325.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6325.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="6325.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6325.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_6&#45;&gt;transpose_v_0_6 -->
<g id="edge210" class="edge">
<title>split_v_0_6&#45;&gt;transpose_v_0_6</title>
<path fill="none" stroke="black" d="M6325.57,-11930.18C6325.57,-11921.73 6325.57,-11912.63 6325.57,-11903.81"/>
<polygon fill="black" stroke="black" points="6329.07,-11903.65 6325.57,-11893.65 6322.07,-11903.65 6329.07,-11903.65"/>
</g>
<!-- attn_scores_0_6 -->
<g id="node166" class="node">
<title>attn_scores_0_6</title>
<ellipse fill="gold" stroke="black" cx="6016.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6016.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6016.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6016.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_6&#45;&gt;attn_scores_0_6 -->
<g id="edge211" class="edge">
<title>transpose_q_0_6&#45;&gt;attn_scores_0_6</title>
<path fill="none" stroke="black" d="M5791.19,-11825.04C5830.91,-11810.9 5878.6,-11793.92 5919.86,-11779.23"/>
<polygon fill="black" stroke="black" points="5921.13,-11782.49 5929.38,-11775.84 5918.79,-11775.9 5921.13,-11782.49"/>
</g>
<!-- transpose_k_0_6&#45;&gt;attn_scores_0_6 -->
<g id="edge212" class="edge">
<title>transpose_k_0_6&#45;&gt;attn_scores_0_6</title>
<path fill="none" stroke="black" d="M6016.57,-11818.18C6016.57,-11809.73 6016.57,-11800.63 6016.57,-11791.81"/>
<polygon fill="black" stroke="black" points="6020.07,-11791.65 6016.57,-11781.65 6013.07,-11791.65 6020.07,-11791.65"/>
</g>
<!-- attn_output_0_6 -->
<g id="node167" class="node">
<title>attn_output_0_6</title>
<ellipse fill="gold" stroke="black" cx="6226.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6226.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6226.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6226.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_6&#45;&gt;attn_output_0_6 -->
<g id="edge213" class="edge">
<title>transpose_v_0_6&#45;&gt;attn_output_0_6</title>
<path fill="none" stroke="black" d="M6314.7,-11818.1C6296.56,-11756.93 6260.2,-11634.24 6240.32,-11567.18"/>
<polygon fill="black" stroke="black" points="6243.59,-11565.9 6237.39,-11557.31 6236.88,-11567.89 6243.59,-11565.9"/>
</g>
<!-- softmax_0_6 -->
<g id="node168" class="node">
<title>softmax_0_6</title>
<ellipse fill="gold" stroke="black" cx="6058.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6058.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6058.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6058.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_6&#45;&gt;softmax_0_6 -->
<g id="edge214" class="edge">
<title>attn_scores_0_6&#45;&gt;softmax_0_6</title>
<path fill="none" stroke="black" d="M6030.56,-11706.18C6033.92,-11697.36 6037.56,-11687.84 6041.06,-11678.66"/>
<polygon fill="black" stroke="black" points="6044.35,-11679.86 6044.65,-11669.27 6037.81,-11677.37 6044.35,-11679.86"/>
</g>
<!-- transpose_back_0_6 -->
<g id="node169" class="node">
<title>transpose_back_0_6</title>
<ellipse fill="lightgray" stroke="black" cx="6226.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6226.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="6226.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6226.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_6&#45;&gt;transpose_back_0_6 -->
<g id="edge216" class="edge">
<title>attn_output_0_6&#45;&gt;transpose_back_0_6</title>
<path fill="none" stroke="black" d="M6226.57,-11482.18C6226.57,-11473.73 6226.57,-11464.63 6226.57,-11455.81"/>
<polygon fill="black" stroke="black" points="6230.07,-11455.65 6226.57,-11445.65 6223.07,-11455.65 6230.07,-11455.65"/>
</g>
<!-- softmax_0_6&#45;&gt;attn_output_0_6 -->
<g id="edge215" class="edge">
<title>softmax_0_6&#45;&gt;attn_output_0_6</title>
<path fill="none" stroke="black" d="M6111.73,-11596C6128.91,-11584.75 6148.1,-11572.19 6165.79,-11560.6"/>
<polygon fill="black" stroke="black" points="6167.89,-11563.41 6174.34,-11555.01 6164.05,-11557.56 6167.89,-11563.41"/>
</g>
<!-- reshape_concat_0_6 -->
<g id="node170" class="node">
<title>reshape_concat_0_6</title>
<ellipse fill="lightcyan" stroke="black" cx="6226.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="6226.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="6226.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="6226.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_6&#45;&gt;reshape_concat_0_6 -->
<g id="edge217" class="edge">
<title>transpose_back_0_6&#45;&gt;reshape_concat_0_6</title>
<path fill="none" stroke="black" d="M6226.57,-11370.18C6226.57,-11361.73 6226.57,-11352.63 6226.57,-11343.81"/>
<polygon fill="black" stroke="black" points="6230.07,-11343.65 6226.57,-11333.65 6223.07,-11343.65 6230.07,-11343.65"/>
</g>
<!-- reshape_concat_0_6&#45;&gt;allgather_dim_0_1 -->
<g id="edge218" class="edge">
<title>reshape_concat_0_6&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M6226.57,-11258.17C6226.57,-11249.86 6226.57,-11240.81 6226.57,-11231.77"/>
<polygon fill="black" stroke="black" points="6230.07,-11231.61 6226.57,-11221.61 6223.07,-11231.61 6230.07,-11231.61"/>
</g>
<!-- split_q_0_7 -->
<g id="node172" class="node">
<title>split_q_0_7</title>
<ellipse fill="pink" stroke="black" cx="6634.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6634.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="6634.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6634.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_q_0_7 -->
<g id="edge220" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_q_0_7</title>
<path fill="none" stroke="black" d="M6989.2,-12052.87C6917.29,-12035.83 6823.33,-12013.55 6750.2,-11996.21"/>
<polygon fill="black" stroke="black" points="6750.56,-11992.7 6740.02,-11993.8 6748.94,-11999.51 6750.56,-11992.7"/>
</g>
<!-- split_k_0_7 -->
<g id="node173" class="node">
<title>split_k_0_7</title>
<ellipse fill="pink" stroke="black" cx="6943.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6943.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="6943.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6943.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_k_0_7 -->
<g id="edge221" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_k_0_7</title>
<path fill="none" stroke="black" d="M7049.53,-12044C7033.9,-12032.9 7016.47,-12020.54 7000.33,-12009.09"/>
<polygon fill="black" stroke="black" points="7002.21,-12006.13 6992.03,-12003.19 6998.16,-12011.84 7002.21,-12006.13"/>
</g>
<!-- split_v_0_7 -->
<g id="node174" class="node">
<title>split_v_0_7</title>
<ellipse fill="pink" stroke="black" cx="7252.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7252.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="7252.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7252.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_7&#45;&gt;split_v_0_7 -->
<g id="edge222" class="edge">
<title>reshape_qkv_0_7&#45;&gt;split_v_0_7</title>
<path fill="none" stroke="black" d="M7147.3,-12044C7162.83,-12032.9 7180.15,-12020.54 7196.18,-12009.09"/>
<polygon fill="black" stroke="black" points="7198.32,-12011.85 7204.43,-12003.19 7194.26,-12006.16 7198.32,-12011.85"/>
</g>
<!-- transpose_q_0_7 -->
<g id="node175" class="node">
<title>transpose_q_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6634.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6634.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="6634.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6634.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_7&#45;&gt;transpose_q_0_7 -->
<g id="edge223" class="edge">
<title>split_q_0_7&#45;&gt;transpose_q_0_7</title>
<path fill="none" stroke="black" d="M6634.57,-11930.18C6634.57,-11921.73 6634.57,-11912.63 6634.57,-11903.81"/>
<polygon fill="black" stroke="black" points="6638.07,-11903.65 6634.57,-11893.65 6631.07,-11903.65 6638.07,-11903.65"/>
</g>
<!-- transpose_k_0_7 -->
<g id="node176" class="node">
<title>transpose_k_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6943.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6943.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="6943.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6943.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_7&#45;&gt;transpose_k_0_7 -->
<g id="edge224" class="edge">
<title>split_k_0_7&#45;&gt;transpose_k_0_7</title>
<path fill="none" stroke="black" d="M6943.57,-11930.18C6943.57,-11921.73 6943.57,-11912.63 6943.57,-11903.81"/>
<polygon fill="black" stroke="black" points="6947.07,-11903.65 6943.57,-11893.65 6940.07,-11903.65 6947.07,-11903.65"/>
</g>
<!-- transpose_v_0_7 -->
<g id="node177" class="node">
<title>transpose_v_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="7252.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7252.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="7252.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7252.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_7&#45;&gt;transpose_v_0_7 -->
<g id="edge225" class="edge">
<title>split_v_0_7&#45;&gt;transpose_v_0_7</title>
<path fill="none" stroke="black" d="M7252.57,-11930.18C7252.57,-11921.73 7252.57,-11912.63 7252.57,-11903.81"/>
<polygon fill="black" stroke="black" points="7256.07,-11903.65 7252.57,-11893.65 7249.07,-11903.65 7256.07,-11903.65"/>
</g>
<!-- attn_scores_0_7 -->
<g id="node178" class="node">
<title>attn_scores_0_7</title>
<ellipse fill="gold" stroke="black" cx="6906.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6906.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6906.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6906.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_7&#45;&gt;attn_scores_0_7 -->
<g id="edge226" class="edge">
<title>transpose_q_0_7&#45;&gt;attn_scores_0_7</title>
<path fill="none" stroke="black" d="M6711.06,-11823.87C6744.24,-11810.45 6783.31,-11794.65 6817.76,-11780.72"/>
<polygon fill="black" stroke="black" points="6819.39,-11783.84 6827.34,-11776.85 6816.76,-11777.35 6819.39,-11783.84"/>
</g>
<!-- transpose_k_0_7&#45;&gt;attn_scores_0_7 -->
<g id="edge227" class="edge">
<title>transpose_k_0_7&#45;&gt;attn_scores_0_7</title>
<path fill="none" stroke="black" d="M6931.25,-11818.18C6928.32,-11809.46 6925.15,-11800.04 6922.1,-11790.95"/>
<polygon fill="black" stroke="black" points="6925.35,-11789.63 6918.84,-11781.27 6918.71,-11791.87 6925.35,-11789.63"/>
</g>
<!-- attn_output_0_7 -->
<g id="node179" class="node">
<title>attn_output_0_7</title>
<ellipse fill="gold" stroke="black" cx="6906.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6906.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6906.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6906.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_7&#45;&gt;attn_output_0_7 -->
<g id="edge228" class="edge">
<title>transpose_v_0_7&#45;&gt;attn_output_0_7</title>
<path fill="none" stroke="black" d="M7237.31,-11818.31C7212.47,-11762.9 7158.33,-11657.35 7082.57,-11594.3 7061.61,-11576.85 7035.91,-11563.02 7010.69,-11552.29"/>
<polygon fill="black" stroke="black" points="7012.01,-11549.05 7001.43,-11548.47 7009.35,-11555.52 7012.01,-11549.05"/>
</g>
<!-- softmax_0_7 -->
<g id="node180" class="node">
<title>softmax_0_7</title>
<ellipse fill="gold" stroke="black" cx="6906.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="6906.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6906.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6906.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_7&#45;&gt;softmax_0_7 -->
<g id="edge229" class="edge">
<title>attn_scores_0_7&#45;&gt;softmax_0_7</title>
<path fill="none" stroke="black" d="M6906.57,-11706.18C6906.57,-11697.73 6906.57,-11688.63 6906.57,-11679.81"/>
<polygon fill="black" stroke="black" points="6910.07,-11679.65 6906.57,-11669.65 6903.07,-11679.65 6910.07,-11679.65"/>
</g>
<!-- transpose_back_0_7 -->
<g id="node181" class="node">
<title>transpose_back_0_7</title>
<ellipse fill="lightgray" stroke="black" cx="6844.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="6844.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="6844.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6844.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_7&#45;&gt;transpose_back_0_7 -->
<g id="edge231" class="edge">
<title>attn_output_0_7&#45;&gt;transpose_back_0_7</title>
<path fill="none" stroke="black" d="M6886.1,-11482.48C6880.97,-11473.38 6875.4,-11463.5 6870.06,-11454.02"/>
<polygon fill="black" stroke="black" points="6872.98,-11452.08 6865.02,-11445.09 6866.89,-11455.52 6872.98,-11452.08"/>
</g>
<!-- softmax_0_7&#45;&gt;attn_output_0_7 -->
<g id="edge230" class="edge">
<title>softmax_0_7&#45;&gt;attn_output_0_7</title>
<path fill="none" stroke="black" d="M6906.57,-11594.18C6906.57,-11585.73 6906.57,-11576.63 6906.57,-11567.81"/>
<polygon fill="black" stroke="black" points="6910.07,-11567.65 6906.57,-11557.65 6903.07,-11567.65 6910.07,-11567.65"/>
</g>
<!-- reshape_concat_0_7 -->
<g id="node182" class="node">
<title>reshape_concat_0_7</title>
<ellipse fill="lightcyan" stroke="black" cx="6522.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="6522.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="6522.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="6522.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_7&#45;&gt;reshape_concat_0_7 -->
<g id="edge232" class="edge">
<title>transpose_back_0_7&#45;&gt;reshape_concat_0_7</title>
<path fill="none" stroke="black" d="M6758.71,-11377.47C6714.44,-11362.35 6660.41,-11343.89 6615.2,-11328.45"/>
<polygon fill="black" stroke="black" points="6616.29,-11325.12 6605.7,-11325.2 6614.03,-11331.75 6616.29,-11325.12"/>
</g>
<!-- reshape_concat_0_7&#45;&gt;allgather_dim_0_1 -->
<g id="edge233" class="edge">
<title>reshape_concat_0_7&#45;&gt;allgather_dim_0_1</title>
<path fill="none" stroke="black" d="M6450.54,-11264.26C6407.25,-11245.91 6352.05,-11222.5 6307.29,-11203.53"/>
<polygon fill="black" stroke="black" points="6308.47,-11200.23 6297.9,-11199.55 6305.74,-11206.67 6308.47,-11200.23"/>
</g>
<!-- output_proj_0_1 -->
<g id="node285" class="node">
<title>output_proj_0_1</title>
<ellipse fill="orange" stroke="black" cx="10507.57" cy="-10955.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="10507.57" y="-10974.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10507.57" y="-10959.02" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10507.57" y="-10944.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="10507.57" y="-10929.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_1&#45;&gt;output_proj_0_1 -->
<g id="edge358" class="edge">
<title>head_group_0_1&#45;&gt;output_proj_0_1</title>
<path fill="none" stroke="black" d="M9732.13,-11046.79C9887.02,-11028.7 10188.05,-10993.54 10366.05,-10972.75"/>
<polygon fill="black" stroke="black" points="10366.49,-10976.22 10376.02,-10971.59 10365.68,-10969.27 10366.49,-10976.22"/>
</g>
<!-- split_q_0_8 -->
<g id="node185" class="node">
<title>split_q_0_8</title>
<ellipse fill="pink" stroke="black" cx="7561.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7561.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7561.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7561.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_q_0_8 -->
<g id="edge236" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_q_0_8</title>
<path fill="none" stroke="black" d="M7884.87,-12051.89C7820.61,-12035.38 7738.37,-12014.24 7672.92,-11997.42"/>
<polygon fill="black" stroke="black" points="7673.54,-11993.97 7662.98,-11994.87 7671.79,-12000.75 7673.54,-11993.97"/>
</g>
<!-- split_k_0_8 -->
<g id="node186" class="node">
<title>split_k_0_8</title>
<ellipse fill="pink" stroke="black" cx="7870.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="7870.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_k_0_8 -->
<g id="edge237" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_k_0_8</title>
<path fill="none" stroke="black" d="M7951.27,-12043.39C7940.12,-12033.09 7927.83,-12021.73 7916.28,-12011.05"/>
<polygon fill="black" stroke="black" points="7918.53,-12008.37 7908.81,-12004.15 7913.78,-12013.51 7918.53,-12008.37"/>
</g>
<!-- split_v_0_8 -->
<g id="node187" class="node">
<title>split_v_0_8</title>
<ellipse fill="pink" stroke="black" cx="8179.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8179.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_8&#45;&gt;split_v_0_8 -->
<g id="edge238" class="edge">
<title>reshape_qkv_0_8&#45;&gt;split_v_0_8</title>
<path fill="none" stroke="black" d="M8048.13,-12044.9C8068.55,-12033.08 8091.61,-12019.73 8112.66,-12007.55"/>
<polygon fill="black" stroke="black" points="8114.64,-12010.44 8121.54,-12002.4 8111.13,-12004.39 8114.64,-12010.44"/>
</g>
<!-- transpose_q_0_8 -->
<g id="node188" class="node">
<title>transpose_q_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="7561.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7561.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7561.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7561.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_8&#45;&gt;transpose_q_0_8 -->
<g id="edge239" class="edge">
<title>split_q_0_8&#45;&gt;transpose_q_0_8</title>
<path fill="none" stroke="black" d="M7561.57,-11930.18C7561.57,-11921.73 7561.57,-11912.63 7561.57,-11903.81"/>
<polygon fill="black" stroke="black" points="7565.07,-11903.65 7561.57,-11893.65 7558.07,-11903.65 7565.07,-11903.65"/>
</g>
<!-- transpose_k_0_8 -->
<g id="node189" class="node">
<title>transpose_k_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="7870.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="7870.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_8&#45;&gt;transpose_k_0_8 -->
<g id="edge240" class="edge">
<title>split_k_0_8&#45;&gt;transpose_k_0_8</title>
<path fill="none" stroke="black" d="M7870.57,-11930.18C7870.57,-11921.73 7870.57,-11912.63 7870.57,-11903.81"/>
<polygon fill="black" stroke="black" points="7874.07,-11903.65 7870.57,-11893.65 7867.07,-11903.65 7874.07,-11903.65"/>
</g>
<!-- transpose_v_0_8 -->
<g id="node190" class="node">
<title>transpose_v_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="8179.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8179.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_8&#45;&gt;transpose_v_0_8 -->
<g id="edge241" class="edge">
<title>split_v_0_8&#45;&gt;transpose_v_0_8</title>
<path fill="none" stroke="black" d="M8179.57,-11930.18C8179.57,-11921.73 8179.57,-11912.63 8179.57,-11903.81"/>
<polygon fill="black" stroke="black" points="8183.07,-11903.65 8179.57,-11893.65 8176.07,-11903.65 8183.07,-11903.65"/>
</g>
<!-- attn_scores_0_8 -->
<g id="node191" class="node">
<title>attn_scores_0_8</title>
<ellipse fill="gold" stroke="black" cx="7870.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="7870.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7870.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7870.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_8&#45;&gt;attn_scores_0_8 -->
<g id="edge242" class="edge">
<title>transpose_q_0_8&#45;&gt;attn_scores_0_8</title>
<path fill="none" stroke="black" d="M7645.19,-11825.04C7684.91,-11810.9 7732.6,-11793.92 7773.86,-11779.23"/>
<polygon fill="black" stroke="black" points="7775.13,-11782.49 7783.38,-11775.84 7772.79,-11775.9 7775.13,-11782.49"/>
</g>
<!-- transpose_k_0_8&#45;&gt;attn_scores_0_8 -->
<g id="edge243" class="edge">
<title>transpose_k_0_8&#45;&gt;attn_scores_0_8</title>
<path fill="none" stroke="black" d="M7870.57,-11818.18C7870.57,-11809.73 7870.57,-11800.63 7870.57,-11791.81"/>
<polygon fill="black" stroke="black" points="7874.07,-11791.65 7870.57,-11781.65 7867.07,-11791.65 7874.07,-11791.65"/>
</g>
<!-- attn_output_0_8 -->
<g id="node192" class="node">
<title>attn_output_0_8</title>
<ellipse fill="gold" stroke="black" cx="8179.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8179.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8179.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8179.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_8&#45;&gt;attn_output_0_8 -->
<g id="edge244" class="edge">
<title>transpose_v_0_8&#45;&gt;attn_output_0_8</title>
<path fill="none" stroke="black" d="M8179.57,-11818.1C8179.57,-11757.06 8179.57,-11634.75 8179.57,-11567.6"/>
<polygon fill="black" stroke="black" points="8183.07,-11567.31 8179.57,-11557.31 8176.07,-11567.31 8183.07,-11567.31"/>
</g>
<!-- softmax_0_8 -->
<g id="node193" class="node">
<title>softmax_0_8</title>
<ellipse fill="gold" stroke="black" cx="7955.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="7955.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7955.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7955.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_8&#45;&gt;softmax_0_8 -->
<g id="edge245" class="edge">
<title>attn_scores_0_8&#45;&gt;softmax_0_8</title>
<path fill="none" stroke="black" d="M7898.41,-11706.79C7905.74,-11697.29 7913.75,-11686.93 7921.38,-11677.06"/>
<polygon fill="black" stroke="black" points="7924.33,-11678.96 7927.68,-11668.9 7918.79,-11674.68 7924.33,-11678.96"/>
</g>
<!-- transpose_back_0_8 -->
<g id="node194" class="node">
<title>transpose_back_0_8</title>
<ellipse fill="lightgray" stroke="black" cx="8652.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8652.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="8652.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8652.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_8&#45;&gt;transpose_back_0_8 -->
<g id="edge247" class="edge">
<title>attn_output_0_8&#45;&gt;transpose_back_0_8</title>
<path fill="none" stroke="black" d="M8285.72,-11494.12C8360.15,-11476.81 8459.61,-11453.68 8536.2,-11435.87"/>
<polygon fill="black" stroke="black" points="8537.42,-11439.18 8546.37,-11433.5 8535.84,-11432.36 8537.42,-11439.18"/>
</g>
<!-- softmax_0_8&#45;&gt;attn_output_0_8 -->
<g id="edge246" class="edge">
<title>softmax_0_8&#45;&gt;attn_output_0_8</title>
<path fill="none" stroke="black" d="M8023.39,-11597.5C8048.96,-11584.94 8078.19,-11570.59 8104.4,-11557.72"/>
<polygon fill="black" stroke="black" points="8106.09,-11560.79 8113.53,-11553.24 8103.01,-11554.5 8106.09,-11560.79"/>
</g>
<!-- reshape_concat_0_8 -->
<g id="node195" class="node">
<title>reshape_concat_0_8</title>
<ellipse fill="lightcyan" stroke="black" cx="8935.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="8935.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="8935.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8935.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_8&#45;&gt;reshape_concat_0_8 -->
<g id="edge248" class="edge">
<title>transpose_back_0_8&#45;&gt;reshape_concat_0_8</title>
<path fill="none" stroke="black" d="M8731.4,-11376.16C8768.19,-11361.86 8812.06,-11344.81 8849.69,-11330.18"/>
<polygon fill="black" stroke="black" points="8851.07,-11333.41 8859.12,-11326.52 8848.53,-11326.88 8851.07,-11333.41"/>
</g>
<!-- allgather_dim_0_2 -->
<g id="node196" class="node">
<title>allgather_dim_0_2</title>
<polygon fill="red" stroke="black" points="9903.57,-11221.3 9730.57,-11168.3 9903.57,-11115.3 10076.57,-11168.3 9903.57,-11221.3"/>
<text text-anchor="middle" x="9903.57" y="-11179.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="9903.57" y="-11164.6" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="9903.57" y="-11149.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_8&#45;&gt;allgather_dim_0_2 -->
<g id="edge249" class="edge">
<title>reshape_concat_0_8&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9051.41,-11277.27C9093.34,-11271.07 9141.06,-11264.19 9184.57,-11258.3 9388.77,-11230.7 9626.05,-11201.98 9770.46,-11184.88"/>
<polygon fill="black" stroke="black" points="9771.18,-11188.32 9780.7,-11183.67 9770.35,-11181.37 9771.18,-11188.32"/>
</g>
<!-- head_group_0_2 -->
<g id="node233" class="node">
<title>head_group_0_2</title>
<polygon fill="lightyellow" stroke="black" points="10427.07,-11078.3 10230.07,-11078.3 10230.07,-11040.3 10427.07,-11040.3 10427.07,-11078.3"/>
<text text-anchor="middle" x="10328.57" y="-11063.1" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="10328.57" y="-11048.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_2&#45;&gt;head_group_0_2 -->
<g id="edge295" class="edge">
<title>allgather_dim_0_2&#45;&gt;head_group_0_2</title>
<path fill="none" stroke="black" d="M9996.84,-11143.82C10071.64,-11124.99 10175.57,-11098.82 10247.07,-11080.82"/>
<polygon fill="black" stroke="black" points="10248.09,-11084.18 10256.93,-11078.34 10246.38,-11077.39 10248.09,-11084.18"/>
</g>
<!-- split_q_0_9 -->
<g id="node198" class="node">
<title>split_q_0_9</title>
<ellipse fill="pink" stroke="black" cx="8488.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8488.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8488.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8488.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_q_0_9 -->
<g id="edge251" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_q_0_9</title>
<path fill="none" stroke="black" d="M8811.87,-12051.89C8747.61,-12035.38 8665.37,-12014.24 8599.92,-11997.42"/>
<polygon fill="black" stroke="black" points="8600.54,-11993.97 8589.98,-11994.87 8598.79,-12000.75 8600.54,-11993.97"/>
</g>
<!-- split_k_0_9 -->
<g id="node199" class="node">
<title>split_k_0_9</title>
<ellipse fill="pink" stroke="black" cx="8797.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8797.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_k_0_9 -->
<g id="edge252" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_k_0_9</title>
<path fill="none" stroke="black" d="M8878.27,-12043.39C8867.12,-12033.09 8854.83,-12021.73 8843.28,-12011.05"/>
<polygon fill="black" stroke="black" points="8845.53,-12008.37 8835.81,-12004.15 8840.78,-12013.51 8845.53,-12008.37"/>
</g>
<!-- split_v_0_9 -->
<g id="node200" class="node">
<title>split_v_0_9</title>
<ellipse fill="pink" stroke="black" cx="9106.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9106.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_9&#45;&gt;split_v_0_9 -->
<g id="edge253" class="edge">
<title>reshape_qkv_0_9&#45;&gt;split_v_0_9</title>
<path fill="none" stroke="black" d="M8975.13,-12044.9C8995.55,-12033.08 9018.61,-12019.73 9039.66,-12007.55"/>
<polygon fill="black" stroke="black" points="9041.64,-12010.44 9048.54,-12002.4 9038.13,-12004.39 9041.64,-12010.44"/>
</g>
<!-- transpose_q_0_9 -->
<g id="node201" class="node">
<title>transpose_q_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="8488.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8488.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8488.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8488.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_9&#45;&gt;transpose_q_0_9 -->
<g id="edge254" class="edge">
<title>split_q_0_9&#45;&gt;transpose_q_0_9</title>
<path fill="none" stroke="black" d="M8488.57,-11930.18C8488.57,-11921.73 8488.57,-11912.63 8488.57,-11903.81"/>
<polygon fill="black" stroke="black" points="8492.07,-11903.65 8488.57,-11893.65 8485.07,-11903.65 8492.07,-11903.65"/>
</g>
<!-- transpose_k_0_9 -->
<g id="node202" class="node">
<title>transpose_k_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="8797.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8797.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_9&#45;&gt;transpose_k_0_9 -->
<g id="edge255" class="edge">
<title>split_k_0_9&#45;&gt;transpose_k_0_9</title>
<path fill="none" stroke="black" d="M8797.57,-11930.18C8797.57,-11921.73 8797.57,-11912.63 8797.57,-11903.81"/>
<polygon fill="black" stroke="black" points="8801.07,-11903.65 8797.57,-11893.65 8794.07,-11903.65 8801.07,-11903.65"/>
</g>
<!-- transpose_v_0_9 -->
<g id="node203" class="node">
<title>transpose_v_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="9106.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9106.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_9&#45;&gt;transpose_v_0_9 -->
<g id="edge256" class="edge">
<title>split_v_0_9&#45;&gt;transpose_v_0_9</title>
<path fill="none" stroke="black" d="M9106.57,-11930.18C9106.57,-11921.73 9106.57,-11912.63 9106.57,-11903.81"/>
<polygon fill="black" stroke="black" points="9110.07,-11903.65 9106.57,-11893.65 9103.07,-11903.65 9110.07,-11903.65"/>
</g>
<!-- attn_scores_0_9 -->
<g id="node204" class="node">
<title>attn_scores_0_9</title>
<ellipse fill="gold" stroke="black" cx="8797.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8797.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8797.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8797.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_9&#45;&gt;attn_scores_0_9 -->
<g id="edge257" class="edge">
<title>transpose_q_0_9&#45;&gt;attn_scores_0_9</title>
<path fill="none" stroke="black" d="M8572.19,-11825.04C8611.91,-11810.9 8659.6,-11793.92 8700.86,-11779.23"/>
<polygon fill="black" stroke="black" points="8702.13,-11782.49 8710.38,-11775.84 8699.79,-11775.9 8702.13,-11782.49"/>
</g>
<!-- transpose_k_0_9&#45;&gt;attn_scores_0_9 -->
<g id="edge258" class="edge">
<title>transpose_k_0_9&#45;&gt;attn_scores_0_9</title>
<path fill="none" stroke="black" d="M8797.57,-11818.18C8797.57,-11809.73 8797.57,-11800.63 8797.57,-11791.81"/>
<polygon fill="black" stroke="black" points="8801.07,-11791.65 8797.57,-11781.65 8794.07,-11791.65 8801.07,-11791.65"/>
</g>
<!-- attn_output_0_9 -->
<g id="node205" class="node">
<title>attn_output_0_9</title>
<ellipse fill="gold" stroke="black" cx="9106.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9106.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9106.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9106.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_9&#45;&gt;attn_output_0_9 -->
<g id="edge259" class="edge">
<title>transpose_v_0_9&#45;&gt;attn_output_0_9</title>
<path fill="none" stroke="black" d="M9106.57,-11818.1C9106.57,-11757.06 9106.57,-11634.75 9106.57,-11567.6"/>
<polygon fill="black" stroke="black" points="9110.07,-11567.31 9106.57,-11557.31 9103.07,-11567.31 9110.07,-11567.31"/>
</g>
<!-- softmax_0_9 -->
<g id="node206" class="node">
<title>softmax_0_9</title>
<ellipse fill="gold" stroke="black" cx="8854.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8854.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8854.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8854.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_9&#45;&gt;softmax_0_9 -->
<g id="edge260" class="edge">
<title>attn_scores_0_9&#45;&gt;softmax_0_9</title>
<path fill="none" stroke="black" d="M8816.4,-11706.48C8821.11,-11697.38 8826.23,-11687.5 8831.15,-11678.02"/>
<polygon fill="black" stroke="black" points="8834.28,-11679.58 8835.77,-11669.09 8828.06,-11676.36 8834.28,-11679.58"/>
</g>
<!-- transpose_back_0_9 -->
<g id="node207" class="node">
<title>transpose_back_0_9</title>
<ellipse fill="lightgray" stroke="black" cx="9270.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9270.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9270.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9270.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_9&#45;&gt;transpose_back_0_9 -->
<g id="edge262" class="edge">
<title>attn_output_0_9&#45;&gt;transpose_back_0_9</title>
<path fill="none" stroke="black" d="M9157.57,-11484.6C9174.53,-11473.22 9193.58,-11460.45 9211.13,-11448.67"/>
<polygon fill="black" stroke="black" points="9213.26,-11451.46 9219.61,-11442.98 9209.36,-11445.65 9213.26,-11451.46"/>
</g>
<!-- softmax_0_9&#45;&gt;attn_output_0_9 -->
<g id="edge261" class="edge">
<title>softmax_0_9&#45;&gt;attn_output_0_9</title>
<path fill="none" stroke="black" d="M8929.16,-11598.25C8959.15,-11585.16 8993.83,-11570.02 9024.52,-11556.62"/>
<polygon fill="black" stroke="black" points="9026.15,-11559.73 9033.91,-11552.52 9023.35,-11553.31 9026.15,-11559.73"/>
</g>
<!-- reshape_concat_0_9 -->
<g id="node208" class="node">
<title>reshape_concat_0_9</title>
<ellipse fill="lightcyan" stroke="black" cx="9326.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9326.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9326.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9326.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_9&#45;&gt;reshape_concat_0_9 -->
<g id="edge263" class="edge">
<title>transpose_back_0_9&#45;&gt;reshape_concat_0_9</title>
<path fill="none" stroke="black" d="M9289.07,-11370.48C9293.7,-11361.38 9298.73,-11351.5 9303.56,-11342.02"/>
<polygon fill="black" stroke="black" points="9306.68,-11343.59 9308.1,-11333.09 9300.45,-11340.41 9306.68,-11343.59"/>
</g>
<!-- reshape_concat_0_9&#45;&gt;allgather_dim_0_2 -->
<g id="edge264" class="edge">
<title>reshape_concat_0_9&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9430.4,-11272.22C9533.02,-11249.9 9689.43,-11215.88 9794.01,-11193.14"/>
<polygon fill="black" stroke="black" points="9794.93,-11196.52 9803.96,-11190.97 9793.45,-11189.68 9794.93,-11196.52"/>
</g>
<!-- split_q_0_10 -->
<g id="node210" class="node">
<title>split_q_0_10</title>
<ellipse fill="pink" stroke="black" cx="9415.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9415.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9415.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9415.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_q_0_10 -->
<g id="edge266" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_q_0_10</title>
<path fill="none" stroke="black" d="M9826.95,-12056.43C9752.37,-12042.49 9655.3,-12023.75 9569.57,-12005.3 9556.6,-12002.51 9543.05,-11999.48 9529.59,-11996.39"/>
<polygon fill="black" stroke="black" points="9530.35,-11992.97 9519.82,-11994.13 9528.77,-11999.79 9530.35,-11992.97"/>
</g>
<!-- split_k_0_10 -->
<g id="node211" class="node">
<title>split_k_0_10</title>
<ellipse fill="pink" stroke="black" cx="9724.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9724.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9724.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9724.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_k_0_10 -->
<g id="edge267" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_k_0_10</title>
<path fill="none" stroke="black" d="M9882.07,-12045.8C9856.24,-12033.18 9826.64,-12018.7 9800.11,-12005.73"/>
<polygon fill="black" stroke="black" points="9801.39,-12002.46 9790.87,-12001.22 9798.32,-12008.75 9801.39,-12002.46"/>
</g>
<!-- split_v_0_10 -->
<g id="node212" class="node">
<title>split_v_0_10</title>
<ellipse fill="pink" stroke="black" cx="10033.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10033.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10033.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="10033.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_10&#45;&gt;split_v_0_10 -->
<g id="edge268" class="edge">
<title>reshape_qkv_0_10&#45;&gt;split_v_0_10</title>
<path fill="none" stroke="black" d="M9977.08,-12042.79C9984.33,-12033.29 9992.24,-12022.93 9999.78,-12013.06"/>
<polygon fill="black" stroke="black" points="10002.72,-12014.97 10006.01,-12004.9 9997.16,-12010.73 10002.72,-12014.97"/>
</g>
<!-- transpose_q_0_10 -->
<g id="node213" class="node">
<title>transpose_q_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9415.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9415.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9415.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9415.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_10&#45;&gt;transpose_q_0_10 -->
<g id="edge269" class="edge">
<title>split_q_0_10&#45;&gt;transpose_q_0_10</title>
<path fill="none" stroke="black" d="M9415.57,-11930.18C9415.57,-11921.73 9415.57,-11912.63 9415.57,-11903.81"/>
<polygon fill="black" stroke="black" points="9419.07,-11903.65 9415.57,-11893.65 9412.07,-11903.65 9419.07,-11903.65"/>
</g>
<!-- transpose_k_0_10 -->
<g id="node214" class="node">
<title>transpose_k_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9724.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9724.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9724.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9724.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_10&#45;&gt;transpose_k_0_10 -->
<g id="edge270" class="edge">
<title>split_k_0_10&#45;&gt;transpose_k_0_10</title>
<path fill="none" stroke="black" d="M9724.57,-11930.18C9724.57,-11921.73 9724.57,-11912.63 9724.57,-11903.81"/>
<polygon fill="black" stroke="black" points="9728.07,-11903.65 9724.57,-11893.65 9721.07,-11903.65 9728.07,-11903.65"/>
</g>
<!-- transpose_v_0_10 -->
<g id="node215" class="node">
<title>transpose_v_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="10033.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10033.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10033.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="10033.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_10&#45;&gt;transpose_v_0_10 -->
<g id="edge271" class="edge">
<title>split_v_0_10&#45;&gt;transpose_v_0_10</title>
<path fill="none" stroke="black" d="M10033.57,-11930.18C10033.57,-11921.73 10033.57,-11912.63 10033.57,-11903.81"/>
<polygon fill="black" stroke="black" points="10037.07,-11903.65 10033.57,-11893.65 10030.07,-11903.65 10037.07,-11903.65"/>
</g>
<!-- attn_scores_0_10 -->
<g id="node216" class="node">
<title>attn_scores_0_10</title>
<ellipse fill="gold" stroke="black" cx="9724.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9724.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9724.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9724.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_10&#45;&gt;attn_scores_0_10 -->
<g id="edge272" class="edge">
<title>transpose_q_0_10&#45;&gt;attn_scores_0_10</title>
<path fill="none" stroke="black" d="M9499.19,-11825.04C9538.91,-11810.9 9586.6,-11793.92 9627.86,-11779.23"/>
<polygon fill="black" stroke="black" points="9629.13,-11782.49 9637.38,-11775.84 9626.79,-11775.9 9629.13,-11782.49"/>
</g>
<!-- transpose_k_0_10&#45;&gt;attn_scores_0_10 -->
<g id="edge273" class="edge">
<title>transpose_k_0_10&#45;&gt;attn_scores_0_10</title>
<path fill="none" stroke="black" d="M9724.57,-11818.18C9724.57,-11809.73 9724.57,-11800.63 9724.57,-11791.81"/>
<polygon fill="black" stroke="black" points="9728.07,-11791.65 9724.57,-11781.65 9721.07,-11791.65 9728.07,-11791.65"/>
</g>
<!-- attn_output_0_10 -->
<g id="node217" class="node">
<title>attn_output_0_10</title>
<ellipse fill="gold" stroke="black" cx="9903.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9903.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9903.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9903.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_10&#45;&gt;attn_output_0_10 -->
<g id="edge274" class="edge">
<title>transpose_v_0_10&#45;&gt;attn_output_0_10</title>
<path fill="none" stroke="black" d="M10019.41,-11818.42C9995.58,-11757.19 9947.5,-11633.66 9921.4,-11566.61"/>
<polygon fill="black" stroke="black" points="9924.6,-11565.19 9917.72,-11557.14 9918.08,-11567.73 9924.6,-11565.19"/>
</g>
<!-- softmax_0_10 -->
<g id="node218" class="node">
<title>softmax_0_10</title>
<ellipse fill="gold" stroke="black" cx="9753.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9753.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9753.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9753.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_10&#45;&gt;softmax_0_10 -->
<g id="edge275" class="edge">
<title>attn_scores_0_10&#45;&gt;softmax_0_10</title>
<path fill="none" stroke="black" d="M9734.23,-11706.18C9736.53,-11697.46 9739.01,-11688.04 9741.41,-11678.95"/>
<polygon fill="black" stroke="black" points="9744.79,-11679.83 9743.96,-11669.27 9738.03,-11678.05 9744.79,-11679.83"/>
</g>
<!-- transpose_back_0_10 -->
<g id="node219" class="node">
<title>transpose_back_0_10</title>
<ellipse fill="lightgray" stroke="black" cx="9903.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9903.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9903.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9903.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_10&#45;&gt;transpose_back_0_10 -->
<g id="edge277" class="edge">
<title>attn_output_0_10&#45;&gt;transpose_back_0_10</title>
<path fill="none" stroke="black" d="M9903.57,-11482.18C9903.57,-11473.73 9903.57,-11464.63 9903.57,-11455.81"/>
<polygon fill="black" stroke="black" points="9907.07,-11455.65 9903.57,-11445.65 9900.07,-11455.65 9907.07,-11455.65"/>
</g>
<!-- softmax_0_10&#45;&gt;attn_output_0_10 -->
<g id="edge276" class="edge">
<title>softmax_0_10&#45;&gt;attn_output_0_10</title>
<path fill="none" stroke="black" d="M9801.45,-11595.7C9816.28,-11584.82 9832.74,-11572.75 9848.05,-11561.52"/>
<polygon fill="black" stroke="black" points="9850.42,-11564.13 9856.41,-11555.39 9846.28,-11558.48 9850.42,-11564.13"/>
</g>
<!-- reshape_concat_0_10 -->
<g id="node220" class="node">
<title>reshape_concat_0_10</title>
<ellipse fill="lightcyan" stroke="black" cx="9903.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9903.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9903.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9903.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_10&#45;&gt;reshape_concat_0_10 -->
<g id="edge278" class="edge">
<title>transpose_back_0_10&#45;&gt;reshape_concat_0_10</title>
<path fill="none" stroke="black" d="M9903.57,-11370.18C9903.57,-11361.73 9903.57,-11352.63 9903.57,-11343.81"/>
<polygon fill="black" stroke="black" points="9907.07,-11343.65 9903.57,-11333.65 9900.07,-11343.65 9907.07,-11343.65"/>
</g>
<!-- reshape_concat_0_10&#45;&gt;allgather_dim_0_2 -->
<g id="edge279" class="edge">
<title>reshape_concat_0_10&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M9903.57,-11258.17C9903.57,-11249.86 9903.57,-11240.81 9903.57,-11231.77"/>
<polygon fill="black" stroke="black" points="9907.07,-11231.61 9903.57,-11221.61 9900.07,-11231.61 9907.07,-11231.61"/>
</g>
<!-- split_q_0_11 -->
<g id="node222" class="node">
<title>split_q_0_11</title>
<ellipse fill="pink" stroke="black" cx="10342.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10342.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10342.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10342.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_q_0_11 -->
<g id="edge281" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_q_0_11</title>
<path fill="none" stroke="black" d="M10696.44,-12052.87C10624.68,-12035.83 10530.93,-12013.55 10457.95,-11996.21"/>
<polygon fill="black" stroke="black" points="10458.33,-11992.71 10447.79,-11993.8 10456.71,-11999.52 10458.33,-11992.71"/>
</g>
<!-- split_k_0_11 -->
<g id="node223" class="node">
<title>split_k_0_11</title>
<ellipse fill="pink" stroke="black" cx="10651.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10651.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10651.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10651.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_k_0_11 -->
<g id="edge282" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_k_0_11</title>
<path fill="none" stroke="black" d="M10756.85,-12044C10741.31,-12032.9 10724,-12020.54 10707.97,-12009.09"/>
<polygon fill="black" stroke="black" points="10709.89,-12006.16 10699.72,-12003.19 10705.82,-12011.85 10709.89,-12006.16"/>
</g>
<!-- split_v_0_11 -->
<g id="node224" class="node">
<title>split_v_0_11</title>
<ellipse fill="pink" stroke="black" cx="10960.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10960.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10960.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10960.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_11&#45;&gt;split_v_0_11 -->
<g id="edge283" class="edge">
<title>reshape_qkv_0_11&#45;&gt;split_v_0_11</title>
<path fill="none" stroke="black" d="M10854.62,-12044C10870.25,-12032.9 10887.68,-12020.54 10903.81,-12009.09"/>
<polygon fill="black" stroke="black" points="10905.99,-12011.84 10912.11,-12003.19 10901.93,-12006.13 10905.99,-12011.84"/>
</g>
<!-- transpose_q_0_11 -->
<g id="node225" class="node">
<title>transpose_q_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10342.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10342.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10342.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10342.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_11&#45;&gt;transpose_q_0_11 -->
<g id="edge284" class="edge">
<title>split_q_0_11&#45;&gt;transpose_q_0_11</title>
<path fill="none" stroke="black" d="M10342.57,-11930.18C10342.57,-11921.73 10342.57,-11912.63 10342.57,-11903.81"/>
<polygon fill="black" stroke="black" points="10346.07,-11903.65 10342.57,-11893.65 10339.07,-11903.65 10346.07,-11903.65"/>
</g>
<!-- transpose_k_0_11 -->
<g id="node226" class="node">
<title>transpose_k_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10651.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10651.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10651.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10651.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_11&#45;&gt;transpose_k_0_11 -->
<g id="edge285" class="edge">
<title>split_k_0_11&#45;&gt;transpose_k_0_11</title>
<path fill="none" stroke="black" d="M10651.57,-11930.18C10651.57,-11921.73 10651.57,-11912.63 10651.57,-11903.81"/>
<polygon fill="black" stroke="black" points="10655.07,-11903.65 10651.57,-11893.65 10648.07,-11903.65 10655.07,-11903.65"/>
</g>
<!-- transpose_v_0_11 -->
<g id="node227" class="node">
<title>transpose_v_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10960.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10960.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10960.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10960.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_11&#45;&gt;transpose_v_0_11 -->
<g id="edge286" class="edge">
<title>split_v_0_11&#45;&gt;transpose_v_0_11</title>
<path fill="none" stroke="black" d="M10960.57,-11930.18C10960.57,-11921.73 10960.57,-11912.63 10960.57,-11903.81"/>
<polygon fill="black" stroke="black" points="10964.07,-11903.65 10960.57,-11893.65 10957.07,-11903.65 10964.07,-11903.65"/>
</g>
<!-- attn_scores_0_11 -->
<g id="node228" class="node">
<title>attn_scores_0_11</title>
<ellipse fill="gold" stroke="black" cx="10622.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10622.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10622.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10622.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_11&#45;&gt;attn_scores_0_11 -->
<g id="edge287" class="edge">
<title>transpose_q_0_11&#45;&gt;attn_scores_0_11</title>
<path fill="none" stroke="black" d="M10420.94,-11824.02C10455.4,-11810.48 10496.07,-11794.5 10531.84,-11780.45"/>
<polygon fill="black" stroke="black" points="10533.27,-11783.65 10541.3,-11776.73 10530.71,-11777.13 10533.27,-11783.65"/>
</g>
<!-- transpose_k_0_11&#45;&gt;attn_scores_0_11 -->
<g id="edge288" class="edge">
<title>transpose_k_0_11&#45;&gt;attn_scores_0_11</title>
<path fill="none" stroke="black" d="M10641.92,-11818.18C10639.62,-11809.46 10637.14,-11800.04 10634.74,-11790.95"/>
<polygon fill="black" stroke="black" points="10638.12,-11790.05 10632.19,-11781.27 10631.35,-11791.83 10638.12,-11790.05"/>
</g>
<!-- attn_output_0_11 -->
<g id="node229" class="node">
<title>attn_output_0_11</title>
<ellipse fill="gold" stroke="black" cx="10622.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10622.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10622.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10622.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_11&#45;&gt;attn_output_0_11 -->
<g id="edge289" class="edge">
<title>transpose_v_0_11&#45;&gt;attn_output_0_11</title>
<path fill="none" stroke="black" d="M10946.49,-11818.29C10923.41,-11762.86 10872.6,-11657.29 10798.57,-11594.3 10778,-11576.8 10752.67,-11562.99 10727.7,-11552.29"/>
<polygon fill="black" stroke="black" points="10728.73,-11548.93 10718.15,-11548.34 10726.06,-11555.4 10728.73,-11548.93"/>
</g>
<!-- softmax_0_11 -->
<g id="node230" class="node">
<title>softmax_0_11</title>
<ellipse fill="gold" stroke="black" cx="10622.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10622.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10622.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10622.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_11&#45;&gt;softmax_0_11 -->
<g id="edge290" class="edge">
<title>attn_scores_0_11&#45;&gt;softmax_0_11</title>
<path fill="none" stroke="black" d="M10622.57,-11706.18C10622.57,-11697.73 10622.57,-11688.63 10622.57,-11679.81"/>
<polygon fill="black" stroke="black" points="10626.07,-11679.65 10622.57,-11669.65 10619.07,-11679.65 10626.07,-11679.65"/>
</g>
<!-- transpose_back_0_11 -->
<g id="node231" class="node">
<title>transpose_back_0_11</title>
<ellipse fill="lightgray" stroke="black" cx="10502.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10502.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10502.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10502.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_11&#45;&gt;transpose_back_0_11 -->
<g id="edge292" class="edge">
<title>attn_output_0_11&#45;&gt;transpose_back_0_11</title>
<path fill="none" stroke="black" d="M10583.94,-11483.39C10572.7,-11473.09 10560.31,-11461.73 10548.66,-11451.05"/>
<polygon fill="black" stroke="black" points="10550.87,-11448.33 10541.13,-11444.15 10546.14,-11453.49 10550.87,-11448.33"/>
</g>
<!-- softmax_0_11&#45;&gt;attn_output_0_11 -->
<g id="edge291" class="edge">
<title>softmax_0_11&#45;&gt;attn_output_0_11</title>
<path fill="none" stroke="black" d="M10622.57,-11594.18C10622.57,-11585.73 10622.57,-11576.63 10622.57,-11567.81"/>
<polygon fill="black" stroke="black" points="10626.07,-11567.65 10622.57,-11557.65 10619.07,-11567.65 10626.07,-11567.65"/>
</g>
<!-- reshape_concat_0_11 -->
<g id="node232" class="node">
<title>reshape_concat_0_11</title>
<ellipse fill="lightcyan" stroke="black" cx="10263.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10263.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10263.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="10263.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_11&#45;&gt;reshape_concat_0_11 -->
<g id="edge293" class="edge">
<title>transpose_back_0_11&#45;&gt;reshape_concat_0_11</title>
<path fill="none" stroke="black" d="M10433.12,-11374.84C10404.15,-11361.5 10370.38,-11345.96 10340.64,-11332.27"/>
<polygon fill="black" stroke="black" points="10342.09,-11329.09 10331.55,-11328.09 10339.17,-11335.45 10342.09,-11329.09"/>
</g>
<!-- reshape_concat_0_11&#45;&gt;allgather_dim_0_2 -->
<g id="edge294" class="edge">
<title>reshape_concat_0_11&#45;&gt;allgather_dim_0_2</title>
<path fill="none" stroke="black" d="M10181.43,-11266.17C10125.11,-11246.54 10050.43,-11220.5 9992.68,-11200.37"/>
<polygon fill="black" stroke="black" points="9993.79,-11197.05 9983.19,-11197.06 9991.48,-11203.66 9993.79,-11197.05"/>
</g>
<!-- output_proj_0_2 -->
<g id="node286" class="node">
<title>output_proj_0_2</title>
<ellipse fill="orange" stroke="black" cx="10932.57" cy="-10955.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="10932.57" y="-10974.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10932.57" y="-10959.02" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="10932.57" y="-10944.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="10932.57" y="-10929.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_2&#45;&gt;output_proj_0_2 -->
<g id="edge359" class="edge">
<title>head_group_0_2&#45;&gt;output_proj_0_2</title>
<path fill="none" stroke="black" d="M10427.32,-11041.74C10492.2,-11030.85 10578.94,-11016.26 10655.57,-11003.3 10702.18,-10995.42 10753.18,-10986.76 10798.58,-10979.04"/>
<polygon fill="black" stroke="black" points="10799.21,-10982.49 10808.48,-10977.36 10798.03,-10975.59 10799.21,-10982.49"/>
</g>
<!-- split_q_0_12 -->
<g id="node235" class="node">
<title>split_q_0_12</title>
<ellipse fill="pink" stroke="black" cx="11269.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11269.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11269.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11269.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_q_0_12 -->
<g id="edge297" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_q_0_12</title>
<path fill="none" stroke="black" d="M11562.64,-12050.83C11505.67,-12034.89 11434.29,-12014.91 11376.24,-11998.66"/>
<polygon fill="black" stroke="black" points="11376.88,-11995.2 11366.31,-11995.88 11374.99,-12001.95 11376.88,-11995.2"/>
</g>
<!-- split_k_0_12 -->
<g id="node236" class="node">
<title>split_k_0_12</title>
<ellipse fill="pink" stroke="black" cx="11578.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11578.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_k_0_12 -->
<g id="edge298" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_k_0_12</title>
<path fill="none" stroke="black" d="M11635.07,-12042.79C11627.82,-12033.29 11619.91,-12022.93 11612.37,-12013.06"/>
<polygon fill="black" stroke="black" points="11614.99,-12010.73 11606.14,-12004.9 11609.43,-12014.97 11614.99,-12010.73"/>
</g>
<!-- split_v_0_12 -->
<g id="node237" class="node">
<title>split_v_0_12</title>
<ellipse fill="pink" stroke="black" cx="11887.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11887.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_12&#45;&gt;split_v_0_12 -->
<g id="edge299" class="edge">
<title>reshape_qkv_0_12&#45;&gt;split_v_0_12</title>
<path fill="none" stroke="black" d="M11730.08,-12045.8C11755.9,-12033.18 11785.51,-12018.7 11812.03,-12005.73"/>
<polygon fill="black" stroke="black" points="11813.83,-12008.75 11821.28,-12001.22 11810.75,-12002.46 11813.83,-12008.75"/>
</g>
<!-- transpose_q_0_12 -->
<g id="node238" class="node">
<title>transpose_q_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11269.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11269.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11269.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11269.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_12&#45;&gt;transpose_q_0_12 -->
<g id="edge300" class="edge">
<title>split_q_0_12&#45;&gt;transpose_q_0_12</title>
<path fill="none" stroke="black" d="M11269.57,-11930.18C11269.57,-11921.73 11269.57,-11912.63 11269.57,-11903.81"/>
<polygon fill="black" stroke="black" points="11273.07,-11903.65 11269.57,-11893.65 11266.07,-11903.65 11273.07,-11903.65"/>
</g>
<!-- transpose_k_0_12 -->
<g id="node239" class="node">
<title>transpose_k_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11578.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11578.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_12&#45;&gt;transpose_k_0_12 -->
<g id="edge301" class="edge">
<title>split_k_0_12&#45;&gt;transpose_k_0_12</title>
<path fill="none" stroke="black" d="M11578.57,-11930.18C11578.57,-11921.73 11578.57,-11912.63 11578.57,-11903.81"/>
<polygon fill="black" stroke="black" points="11582.07,-11903.65 11578.57,-11893.65 11575.07,-11903.65 11582.07,-11903.65"/>
</g>
<!-- transpose_v_0_12 -->
<g id="node240" class="node">
<title>transpose_v_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="11887.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11887.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_12&#45;&gt;transpose_v_0_12 -->
<g id="edge302" class="edge">
<title>split_v_0_12&#45;&gt;transpose_v_0_12</title>
<path fill="none" stroke="black" d="M11887.57,-11930.18C11887.57,-11921.73 11887.57,-11912.63 11887.57,-11903.81"/>
<polygon fill="black" stroke="black" points="11891.07,-11903.65 11887.57,-11893.65 11884.07,-11903.65 11891.07,-11903.65"/>
</g>
<!-- attn_scores_0_12 -->
<g id="node241" class="node">
<title>attn_scores_0_12</title>
<ellipse fill="gold" stroke="black" cx="11578.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11578.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11578.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11578.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_12&#45;&gt;attn_scores_0_12 -->
<g id="edge303" class="edge">
<title>transpose_q_0_12&#45;&gt;attn_scores_0_12</title>
<path fill="none" stroke="black" d="M11353.19,-11825.04C11392.91,-11810.9 11440.6,-11793.92 11481.86,-11779.23"/>
<polygon fill="black" stroke="black" points="11483.13,-11782.49 11491.38,-11775.84 11480.79,-11775.9 11483.13,-11782.49"/>
</g>
<!-- transpose_k_0_12&#45;&gt;attn_scores_0_12 -->
<g id="edge304" class="edge">
<title>transpose_k_0_12&#45;&gt;attn_scores_0_12</title>
<path fill="none" stroke="black" d="M11578.57,-11818.18C11578.57,-11809.73 11578.57,-11800.63 11578.57,-11791.81"/>
<polygon fill="black" stroke="black" points="11582.07,-11791.65 11578.57,-11781.65 11575.07,-11791.65 11582.07,-11791.65"/>
</g>
<!-- attn_output_0_12 -->
<g id="node242" class="node">
<title>attn_output_0_12</title>
<ellipse fill="gold" stroke="black" cx="11887.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11887.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11887.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11887.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_12&#45;&gt;attn_output_0_12 -->
<g id="edge305" class="edge">
<title>transpose_v_0_12&#45;&gt;attn_output_0_12</title>
<path fill="none" stroke="black" d="M11887.57,-11818.1C11887.57,-11757.06 11887.57,-11634.75 11887.57,-11567.6"/>
<polygon fill="black" stroke="black" points="11891.07,-11567.31 11887.57,-11557.31 11884.07,-11567.31 11891.07,-11567.31"/>
</g>
<!-- softmax_0_12 -->
<g id="node243" class="node">
<title>softmax_0_12</title>
<ellipse fill="gold" stroke="black" cx="11635.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11635.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11635.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11635.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_12&#45;&gt;softmax_0_12 -->
<g id="edge306" class="edge">
<title>attn_scores_0_12&#45;&gt;softmax_0_12</title>
<path fill="none" stroke="black" d="M11597.4,-11706.48C11602.11,-11697.38 11607.23,-11687.5 11612.15,-11678.02"/>
<polygon fill="black" stroke="black" points="11615.28,-11679.58 11616.77,-11669.09 11609.06,-11676.36 11615.28,-11679.58"/>
</g>
<!-- transpose_back_0_12 -->
<g id="node244" class="node">
<title>transpose_back_0_12</title>
<ellipse fill="lightgray" stroke="black" cx="12275.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12275.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12275.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="12275.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_12&#45;&gt;transpose_back_0_12 -->
<g id="edge308" class="edge">
<title>attn_output_0_12&#45;&gt;transpose_back_0_12</title>
<path fill="none" stroke="black" d="M11983.98,-11491.47C12040.31,-11475.5 12111.48,-11455.32 12169.41,-11438.9"/>
<polygon fill="black" stroke="black" points="12170.66,-11442.19 12179.33,-11436.09 12168.75,-11435.45 12170.66,-11442.19"/>
</g>
<!-- softmax_0_12&#45;&gt;attn_output_0_12 -->
<g id="edge307" class="edge">
<title>softmax_0_12&#45;&gt;attn_output_0_12</title>
<path fill="none" stroke="black" d="M11710.16,-11598.25C11740.15,-11585.16 11774.83,-11570.02 11805.52,-11556.62"/>
<polygon fill="black" stroke="black" points="11807.15,-11559.73 11814.91,-11552.52 11804.35,-11553.31 11807.15,-11559.73"/>
</g>
<!-- reshape_concat_0_12 -->
<g id="node245" class="node">
<title>reshape_concat_0_12</title>
<ellipse fill="lightcyan" stroke="black" cx="12414.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12414.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12414.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="12414.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_12&#45;&gt;reshape_concat_0_12 -->
<g id="edge309" class="edge">
<title>transpose_back_0_12&#45;&gt;reshape_concat_0_12</title>
<path fill="none" stroke="black" d="M12319.55,-11372C12333.25,-11361.16 12348.48,-11349.11 12362.67,-11337.88"/>
<polygon fill="black" stroke="black" points="12365.21,-11340.33 12370.88,-11331.38 12360.87,-11334.84 12365.21,-11340.33"/>
</g>
<!-- allgather_dim_0_3 -->
<g id="node246" class="node">
<title>allgather_dim_0_3</title>
<polygon fill="red" stroke="black" points="12710.57,-11221.3 12537.57,-11168.3 12710.57,-11115.3 12883.57,-11168.3 12710.57,-11221.3"/>
<text text-anchor="middle" x="12710.57" y="-11179.6" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="12710.57" y="-11164.6" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="12710.57" y="-11149.6" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_0_12&#45;&gt;allgather_dim_0_3 -->
<g id="edge310" class="edge">
<title>reshape_concat_0_12&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12486.6,-11264.26C12529.9,-11245.91 12585.1,-11222.5 12629.86,-11203.53"/>
<polygon fill="black" stroke="black" points="12631.4,-11206.67 12639.25,-11199.55 12628.67,-11200.23 12631.4,-11206.67"/>
</g>
<!-- head_group_0_3 -->
<g id="node283" class="node">
<title>head_group_0_3</title>
<polygon fill="lightyellow" stroke="black" points="11612.07,-11078.3 11415.07,-11078.3 11415.07,-11040.3 11612.07,-11040.3 11612.07,-11078.3"/>
<text text-anchor="middle" x="11513.57" y="-11063.1" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="11513.57" y="-11048.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_0_3&#45;&gt;head_group_0_3 -->
<g id="edge356" class="edge">
<title>allgather_dim_0_3&#45;&gt;head_group_0_3</title>
<path fill="none" stroke="black" d="M12579.05,-11155.55C12340.96,-11134.26 11842.82,-11089.74 11622.44,-11070.04"/>
<polygon fill="black" stroke="black" points="11622.43,-11066.52 11612.16,-11069.12 11621.81,-11073.49 11622.43,-11066.52"/>
</g>
<!-- split_q_0_13 -->
<g id="node248" class="node">
<title>split_q_0_13</title>
<ellipse fill="pink" stroke="black" cx="12196.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12196.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12196.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12196.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_q_0_13 -->
<g id="edge312" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_q_0_13</title>
<path fill="none" stroke="black" d="M12551.2,-12052.87C12479.29,-12035.83 12385.33,-12013.55 12312.2,-11996.21"/>
<polygon fill="black" stroke="black" points="12312.56,-11992.7 12302.02,-11993.8 12310.94,-11999.51 12312.56,-11992.7"/>
</g>
<!-- split_k_0_13 -->
<g id="node249" class="node">
<title>split_k_0_13</title>
<ellipse fill="pink" stroke="black" cx="12505.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12505.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_k_0_13 -->
<g id="edge313" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_k_0_13</title>
<path fill="none" stroke="black" d="M12611.53,-12044C12595.9,-12032.9 12578.47,-12020.54 12562.33,-12009.09"/>
<polygon fill="black" stroke="black" points="12564.21,-12006.13 12554.03,-12003.19 12560.16,-12011.84 12564.21,-12006.13"/>
</g>
<!-- split_v_0_13 -->
<g id="node250" class="node">
<title>split_v_0_13</title>
<ellipse fill="pink" stroke="black" cx="12814.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12814.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12814.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12814.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_13&#45;&gt;split_v_0_13 -->
<g id="edge314" class="edge">
<title>reshape_qkv_0_13&#45;&gt;split_v_0_13</title>
<path fill="none" stroke="black" d="M12709.3,-12044C12724.83,-12032.9 12742.15,-12020.54 12758.18,-12009.09"/>
<polygon fill="black" stroke="black" points="12760.32,-12011.85 12766.43,-12003.19 12756.26,-12006.16 12760.32,-12011.85"/>
</g>
<!-- transpose_q_0_13 -->
<g id="node251" class="node">
<title>transpose_q_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12196.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12196.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12196.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12196.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_13&#45;&gt;transpose_q_0_13 -->
<g id="edge315" class="edge">
<title>split_q_0_13&#45;&gt;transpose_q_0_13</title>
<path fill="none" stroke="black" d="M12196.57,-11930.18C12196.57,-11921.73 12196.57,-11912.63 12196.57,-11903.81"/>
<polygon fill="black" stroke="black" points="12200.07,-11903.65 12196.57,-11893.65 12193.07,-11903.65 12200.07,-11903.65"/>
</g>
<!-- transpose_k_0_13 -->
<g id="node252" class="node">
<title>transpose_k_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12505.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12505.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_13&#45;&gt;transpose_k_0_13 -->
<g id="edge316" class="edge">
<title>split_k_0_13&#45;&gt;transpose_k_0_13</title>
<path fill="none" stroke="black" d="M12505.57,-11930.18C12505.57,-11921.73 12505.57,-11912.63 12505.57,-11903.81"/>
<polygon fill="black" stroke="black" points="12509.07,-11903.65 12505.57,-11893.65 12502.07,-11903.65 12509.07,-11903.65"/>
</g>
<!-- transpose_v_0_13 -->
<g id="node253" class="node">
<title>transpose_v_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12814.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12814.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12814.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12814.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_13&#45;&gt;transpose_v_0_13 -->
<g id="edge317" class="edge">
<title>split_v_0_13&#45;&gt;transpose_v_0_13</title>
<path fill="none" stroke="black" d="M12814.57,-11930.18C12814.57,-11921.73 12814.57,-11912.63 12814.57,-11903.81"/>
<polygon fill="black" stroke="black" points="12818.07,-11903.65 12814.57,-11893.65 12811.07,-11903.65 12818.07,-11903.65"/>
</g>
<!-- attn_scores_0_13 -->
<g id="node254" class="node">
<title>attn_scores_0_13</title>
<ellipse fill="gold" stroke="black" cx="12505.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12505.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12505.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12505.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_13&#45;&gt;attn_scores_0_13 -->
<g id="edge318" class="edge">
<title>transpose_q_0_13&#45;&gt;attn_scores_0_13</title>
<path fill="none" stroke="black" d="M12280.19,-11825.04C12319.91,-11810.9 12367.6,-11793.92 12408.86,-11779.23"/>
<polygon fill="black" stroke="black" points="12410.13,-11782.49 12418.38,-11775.84 12407.79,-11775.9 12410.13,-11782.49"/>
</g>
<!-- transpose_k_0_13&#45;&gt;attn_scores_0_13 -->
<g id="edge319" class="edge">
<title>transpose_k_0_13&#45;&gt;attn_scores_0_13</title>
<path fill="none" stroke="black" d="M12505.57,-11818.18C12505.57,-11809.73 12505.57,-11800.63 12505.57,-11791.81"/>
<polygon fill="black" stroke="black" points="12509.07,-11791.65 12505.57,-11781.65 12502.07,-11791.65 12509.07,-11791.65"/>
</g>
<!-- attn_output_0_13 -->
<g id="node255" class="node">
<title>attn_output_0_13</title>
<ellipse fill="gold" stroke="black" cx="12710.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12710.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12710.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12710.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_13&#45;&gt;attn_output_0_13 -->
<g id="edge320" class="edge">
<title>transpose_v_0_13&#45;&gt;attn_output_0_13</title>
<path fill="none" stroke="black" d="M12804.91,-11818.28C12791.29,-11767.62 12765.11,-11673.35 12738.57,-11594.3 12735.57,-11585.37 12732.16,-11575.91 12728.76,-11566.85"/>
<polygon fill="black" stroke="black" points="12731.93,-11565.34 12725.11,-11557.23 12725.39,-11567.83 12731.93,-11565.34"/>
</g>
<!-- softmax_0_13 -->
<g id="node256" class="node">
<title>softmax_0_13</title>
<ellipse fill="gold" stroke="black" cx="12562.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12562.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12562.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12562.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_13&#45;&gt;softmax_0_13 -->
<g id="edge321" class="edge">
<title>attn_scores_0_13&#45;&gt;softmax_0_13</title>
<path fill="none" stroke="black" d="M12524.4,-11706.48C12529.11,-11697.38 12534.23,-11687.5 12539.15,-11678.02"/>
<polygon fill="black" stroke="black" points="12542.28,-11679.58 12543.77,-11669.09 12536.06,-11676.36 12542.28,-11679.58"/>
</g>
<!-- transpose_back_0_13 -->
<g id="node257" class="node">
<title>transpose_back_0_13</title>
<ellipse fill="lightgray" stroke="black" cx="12710.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12710.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12710.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12710.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_13&#45;&gt;transpose_back_0_13 -->
<g id="edge323" class="edge">
<title>attn_output_0_13&#45;&gt;transpose_back_0_13</title>
<path fill="none" stroke="black" d="M12710.57,-11482.18C12710.57,-11473.73 12710.57,-11464.63 12710.57,-11455.81"/>
<polygon fill="black" stroke="black" points="12714.07,-11455.65 12710.57,-11445.65 12707.07,-11455.65 12714.07,-11455.65"/>
</g>
<!-- softmax_0_13&#45;&gt;attn_output_0_13 -->
<g id="edge322" class="edge">
<title>softmax_0_13&#45;&gt;attn_output_0_13</title>
<path fill="none" stroke="black" d="M12609.81,-11595.7C12624.44,-11584.82 12640.69,-11572.75 12655.79,-11561.52"/>
<polygon fill="black" stroke="black" points="12658.1,-11564.16 12664.04,-11555.39 12653.93,-11558.55 12658.1,-11564.16"/>
</g>
<!-- reshape_concat_0_13 -->
<g id="node258" class="node">
<title>reshape_concat_0_13</title>
<ellipse fill="lightcyan" stroke="black" cx="12710.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12710.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12710.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="12710.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_13&#45;&gt;reshape_concat_0_13 -->
<g id="edge324" class="edge">
<title>transpose_back_0_13&#45;&gt;reshape_concat_0_13</title>
<path fill="none" stroke="black" d="M12710.57,-11370.18C12710.57,-11361.73 12710.57,-11352.63 12710.57,-11343.81"/>
<polygon fill="black" stroke="black" points="12714.07,-11343.65 12710.57,-11333.65 12707.07,-11343.65 12714.07,-11343.65"/>
</g>
<!-- reshape_concat_0_13&#45;&gt;allgather_dim_0_3 -->
<g id="edge325" class="edge">
<title>reshape_concat_0_13&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12710.57,-11258.17C12710.57,-11249.86 12710.57,-11240.81 12710.57,-11231.77"/>
<polygon fill="black" stroke="black" points="12714.07,-11231.61 12710.57,-11221.61 12707.07,-11231.61 12714.07,-11231.61"/>
</g>
<!-- split_q_0_14 -->
<g id="node260" class="node">
<title>split_q_0_14</title>
<ellipse fill="pink" stroke="black" cx="13123.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13123.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13123.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13123.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_q_0_14 -->
<g id="edge327" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_q_0_14</title>
<path fill="none" stroke="black" d="M13478.2,-12052.87C13406.29,-12035.83 13312.33,-12013.55 13239.2,-11996.21"/>
<polygon fill="black" stroke="black" points="13239.56,-11992.7 13229.02,-11993.8 13237.94,-11999.51 13239.56,-11992.7"/>
</g>
<!-- split_k_0_14 -->
<g id="node261" class="node">
<title>split_k_0_14</title>
<ellipse fill="pink" stroke="black" cx="13432.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13432.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13432.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13432.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_k_0_14 -->
<g id="edge328" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_k_0_14</title>
<path fill="none" stroke="black" d="M13538.53,-12044C13522.9,-12032.9 13505.47,-12020.54 13489.33,-12009.09"/>
<polygon fill="black" stroke="black" points="13491.21,-12006.13 13481.03,-12003.19 13487.16,-12011.84 13491.21,-12006.13"/>
</g>
<!-- split_v_0_14 -->
<g id="node262" class="node">
<title>split_v_0_14</title>
<ellipse fill="pink" stroke="black" cx="13741.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13741.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13741.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13741.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_14&#45;&gt;split_v_0_14 -->
<g id="edge329" class="edge">
<title>reshape_qkv_0_14&#45;&gt;split_v_0_14</title>
<path fill="none" stroke="black" d="M13636.3,-12044C13651.83,-12032.9 13669.15,-12020.54 13685.18,-12009.09"/>
<polygon fill="black" stroke="black" points="13687.32,-12011.85 13693.43,-12003.19 13683.26,-12006.16 13687.32,-12011.85"/>
</g>
<!-- transpose_q_0_14 -->
<g id="node263" class="node">
<title>transpose_q_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13123.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13123.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13123.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13123.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_14&#45;&gt;transpose_q_0_14 -->
<g id="edge330" class="edge">
<title>split_q_0_14&#45;&gt;transpose_q_0_14</title>
<path fill="none" stroke="black" d="M13123.57,-11930.18C13123.57,-11921.73 13123.57,-11912.63 13123.57,-11903.81"/>
<polygon fill="black" stroke="black" points="13127.07,-11903.65 13123.57,-11893.65 13120.07,-11903.65 13127.07,-11903.65"/>
</g>
<!-- transpose_k_0_14 -->
<g id="node264" class="node">
<title>transpose_k_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13432.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13432.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13432.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13432.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_14&#45;&gt;transpose_k_0_14 -->
<g id="edge331" class="edge">
<title>split_k_0_14&#45;&gt;transpose_k_0_14</title>
<path fill="none" stroke="black" d="M13432.57,-11930.18C13432.57,-11921.73 13432.57,-11912.63 13432.57,-11903.81"/>
<polygon fill="black" stroke="black" points="13436.07,-11903.65 13432.57,-11893.65 13429.07,-11903.65 13436.07,-11903.65"/>
</g>
<!-- transpose_v_0_14 -->
<g id="node265" class="node">
<title>transpose_v_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13741.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13741.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13741.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13741.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_14&#45;&gt;transpose_v_0_14 -->
<g id="edge332" class="edge">
<title>split_v_0_14&#45;&gt;transpose_v_0_14</title>
<path fill="none" stroke="black" d="M13741.57,-11930.18C13741.57,-11921.73 13741.57,-11912.63 13741.57,-11903.81"/>
<polygon fill="black" stroke="black" points="13745.07,-11903.65 13741.57,-11893.65 13738.07,-11903.65 13745.07,-11903.65"/>
</g>
<!-- attn_scores_0_14 -->
<g id="node266" class="node">
<title>attn_scores_0_14</title>
<ellipse fill="gold" stroke="black" cx="13308.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13308.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13308.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13308.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_14&#45;&gt;attn_scores_0_14 -->
<g id="edge333" class="edge">
<title>transpose_q_0_14&#45;&gt;attn_scores_0_14</title>
<path fill="none" stroke="black" d="M13180.08,-11821.2C13199.62,-11809.59 13221.68,-11796.47 13241.95,-11784.42"/>
<polygon fill="black" stroke="black" points="13244,-11787.27 13250.81,-11779.15 13240.43,-11781.25 13244,-11787.27"/>
</g>
<!-- transpose_k_0_14&#45;&gt;attn_scores_0_14 -->
<g id="edge334" class="edge">
<title>transpose_k_0_14&#45;&gt;attn_scores_0_14</title>
<path fill="none" stroke="black" d="M13393,-11819.7C13381.37,-11809.38 13368.53,-11797.99 13356.44,-11787.26"/>
<polygon fill="black" stroke="black" points="13358.43,-11784.35 13348.62,-11780.33 13353.78,-11789.59 13358.43,-11784.35"/>
</g>
<!-- attn_output_0_14 -->
<g id="node267" class="node">
<title>attn_output_0_14</title>
<ellipse fill="gold" stroke="black" cx="13308.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13308.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13308.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13308.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_14&#45;&gt;attn_output_0_14 -->
<g id="edge335" class="edge">
<title>transpose_v_0_14&#45;&gt;attn_output_0_14</title>
<path fill="none" stroke="black" d="M13713.95,-11818.76C13670.36,-11763.95 13580.66,-11659.18 13484.57,-11594.3 13460.64,-11578.14 13432.58,-11564.46 13405.99,-11553.45"/>
<polygon fill="black" stroke="black" points="13407.24,-11550.18 13396.66,-11549.66 13404.61,-11556.67 13407.24,-11550.18"/>
</g>
<!-- softmax_0_14 -->
<g id="node268" class="node">
<title>softmax_0_14</title>
<ellipse fill="gold" stroke="black" cx="13308.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13308.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13308.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13308.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_14&#45;&gt;softmax_0_14 -->
<g id="edge336" class="edge">
<title>attn_scores_0_14&#45;&gt;softmax_0_14</title>
<path fill="none" stroke="black" d="M13308.57,-11706.18C13308.57,-11697.73 13308.57,-11688.63 13308.57,-11679.81"/>
<polygon fill="black" stroke="black" points="13312.07,-11679.65 13308.57,-11669.65 13305.07,-11679.65 13312.07,-11679.65"/>
</g>
<!-- transpose_back_0_14 -->
<g id="node269" class="node">
<title>transpose_back_0_14</title>
<ellipse fill="lightgray" stroke="black" cx="13054.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13054.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13054.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13054.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_14&#45;&gt;transpose_back_0_14 -->
<g id="edge338" class="edge">
<title>attn_output_0_14&#45;&gt;transpose_back_0_14</title>
<path fill="none" stroke="black" d="M13235.79,-11487.28C13204.83,-11473.88 13168.59,-11458.18 13136.68,-11444.36"/>
<polygon fill="black" stroke="black" points="13137.94,-11441.09 13127.37,-11440.33 13135.16,-11447.52 13137.94,-11441.09"/>
</g>
<!-- softmax_0_14&#45;&gt;attn_output_0_14 -->
<g id="edge337" class="edge">
<title>softmax_0_14&#45;&gt;attn_output_0_14</title>
<path fill="none" stroke="black" d="M13308.57,-11594.18C13308.57,-11585.73 13308.57,-11576.63 13308.57,-11567.81"/>
<polygon fill="black" stroke="black" points="13312.07,-11567.65 13308.57,-11557.65 13305.07,-11567.65 13312.07,-11567.65"/>
</g>
<!-- reshape_concat_0_14 -->
<g id="node270" class="node">
<title>reshape_concat_0_14</title>
<ellipse fill="lightcyan" stroke="black" cx="13009.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13009.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13009.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13009.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_14&#45;&gt;reshape_concat_0_14 -->
<g id="edge339" class="edge">
<title>transpose_back_0_14&#45;&gt;reshape_concat_0_14</title>
<path fill="none" stroke="black" d="M13039.71,-11370.48C13036.07,-11361.56 13032.11,-11351.9 13028.31,-11342.6"/>
<polygon fill="black" stroke="black" points="13031.44,-11341.02 13024.42,-11333.09 13024.96,-11343.67 13031.44,-11341.02"/>
</g>
<!-- reshape_concat_0_14&#45;&gt;allgather_dim_0_3 -->
<g id="edge340" class="edge">
<title>reshape_concat_0_14&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M12936.81,-11264.26C12893,-11245.87 12837.12,-11222.42 12791.86,-11203.42"/>
<polygon fill="black" stroke="black" points="12792.94,-11200.08 12782.37,-11199.44 12790.23,-11206.54 12792.94,-11200.08"/>
</g>
<!-- split_q_0_15 -->
<g id="node272" class="node">
<title>split_q_0_15</title>
<ellipse fill="pink" stroke="black" cx="14050.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14050.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14050.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14050.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_q_0_15 -->
<g id="edge342" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_q_0_15</title>
<path fill="none" stroke="black" d="M14298.28,-12049.18C14252.14,-12034.21 14196.09,-12016.02 14148.99,-12000.74"/>
<polygon fill="black" stroke="black" points="14149.98,-11997.38 14139.39,-11997.62 14147.82,-12004.04 14149.98,-11997.38"/>
</g>
<!-- split_k_0_15 -->
<g id="node273" class="node">
<title>split_k_0_15</title>
<ellipse fill="pink" stroke="black" cx="14359.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14359.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14359.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14359.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_k_0_15 -->
<g id="edge343" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_k_0_15</title>
<path fill="none" stroke="black" d="M14379.58,-12042.18C14377.21,-12033.46 14374.64,-12024.04 14372.16,-12014.95"/>
<polygon fill="black" stroke="black" points="14375.53,-12014 14369.52,-12005.27 14368.77,-12015.84 14375.53,-12014"/>
</g>
<!-- split_v_0_15 -->
<g id="node274" class="node">
<title>split_v_0_15</title>
<ellipse fill="pink" stroke="black" cx="14668.57" cy="-11967.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14668.57" y="-11979.1" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14668.57" y="-11964.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14668.57" y="-11949.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_0_15&#45;&gt;split_v_0_15 -->
<g id="edge344" class="edge">
<title>reshape_qkv_0_15&#45;&gt;split_v_0_15</title>
<path fill="none" stroke="black" d="M14469.15,-12047.43C14504.04,-12033.67 14545.11,-12017.48 14580.88,-12003.38"/>
<polygon fill="black" stroke="black" points="14582.32,-12006.57 14590.34,-11999.65 14579.75,-12000.06 14582.32,-12006.57"/>
</g>
<!-- transpose_q_0_15 -->
<g id="node275" class="node">
<title>transpose_q_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14050.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14050.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14050.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14050.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_0_15&#45;&gt;transpose_q_0_15 -->
<g id="edge345" class="edge">
<title>split_q_0_15&#45;&gt;transpose_q_0_15</title>
<path fill="none" stroke="black" d="M14050.57,-11930.18C14050.57,-11921.73 14050.57,-11912.63 14050.57,-11903.81"/>
<polygon fill="black" stroke="black" points="14054.07,-11903.65 14050.57,-11893.65 14047.07,-11903.65 14054.07,-11903.65"/>
</g>
<!-- transpose_k_0_15 -->
<g id="node276" class="node">
<title>transpose_k_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14359.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14359.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14359.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14359.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_0_15&#45;&gt;transpose_k_0_15 -->
<g id="edge346" class="edge">
<title>split_k_0_15&#45;&gt;transpose_k_0_15</title>
<path fill="none" stroke="black" d="M14359.57,-11930.18C14359.57,-11921.73 14359.57,-11912.63 14359.57,-11903.81"/>
<polygon fill="black" stroke="black" points="14363.07,-11903.65 14359.57,-11893.65 14356.07,-11903.65 14363.07,-11903.65"/>
</g>
<!-- transpose_v_0_15 -->
<g id="node277" class="node">
<title>transpose_v_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="14668.57" cy="-11855.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14668.57" y="-11867.1" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14668.57" y="-11852.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14668.57" y="-11837.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_0_15&#45;&gt;transpose_v_0_15 -->
<g id="edge347" class="edge">
<title>split_v_0_15&#45;&gt;transpose_v_0_15</title>
<path fill="none" stroke="black" d="M14668.57,-11930.18C14668.57,-11921.73 14668.57,-11912.63 14668.57,-11903.81"/>
<polygon fill="black" stroke="black" points="14672.07,-11903.65 14668.57,-11893.65 14665.07,-11903.65 14672.07,-11903.65"/>
</g>
<!-- attn_scores_0_15 -->
<g id="node278" class="node">
<title>attn_scores_0_15</title>
<ellipse fill="gold" stroke="black" cx="14204.57" cy="-11743.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14204.57" y="-11755.1" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14204.57" y="-11740.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14204.57" y="-11725.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_0_15&#45;&gt;attn_scores_0_15 -->
<g id="edge348" class="edge">
<title>transpose_q_0_15&#45;&gt;attn_scores_0_15</title>
<path fill="none" stroke="black" d="M14098.88,-11820.3C14114.28,-11809.3 14131.46,-11797.03 14147.43,-11785.62"/>
<polygon fill="black" stroke="black" points="14149.54,-11788.41 14155.65,-11779.75 14145.47,-11782.72 14149.54,-11788.41"/>
</g>
<!-- transpose_k_0_15&#45;&gt;attn_scores_0_15 -->
<g id="edge349" class="edge">
<title>transpose_k_0_15&#45;&gt;attn_scores_0_15</title>
<path fill="none" stroke="black" d="M14310.96,-11820.3C14295.46,-11809.3 14278.16,-11797.03 14262.09,-11785.62"/>
<polygon fill="black" stroke="black" points="14264,-11782.69 14253.82,-11779.75 14259.95,-11788.39 14264,-11782.69"/>
</g>
<!-- attn_output_0_15 -->
<g id="node279" class="node">
<title>attn_output_0_15</title>
<ellipse fill="gold" stroke="black" cx="14204.57" cy="-11519.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14204.57" y="-11531.1" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14204.57" y="-11516.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14204.57" y="-11501.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_0_15&#45;&gt;attn_output_0_15 -->
<g id="edge350" class="edge">
<title>transpose_v_0_15&#45;&gt;attn_output_0_15</title>
<path fill="none" stroke="black" d="M14636.68,-11819.02C14586.59,-11764.55 14484.46,-11660.23 14380.57,-11594.3 14355.94,-11578.67 14327.41,-11565.09 14300.59,-11554.01"/>
<polygon fill="black" stroke="black" points="14301.77,-11550.71 14291.18,-11550.19 14299.13,-11557.19 14301.77,-11550.71"/>
</g>
<!-- softmax_0_15 -->
<g id="node280" class="node">
<title>softmax_0_15</title>
<ellipse fill="gold" stroke="black" cx="14204.57" cy="-11631.8" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14204.57" y="-11643.1" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14204.57" y="-11628.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="14204.57" y="-11613.1" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_0_15&#45;&gt;softmax_0_15 -->
<g id="edge351" class="edge">
<title>attn_scores_0_15&#45;&gt;softmax_0_15</title>
<path fill="none" stroke="black" d="M14204.57,-11706.18C14204.57,-11697.73 14204.57,-11688.63 14204.57,-11679.81"/>
<polygon fill="black" stroke="black" points="14208.07,-11679.65 14204.57,-11669.65 14201.07,-11679.65 14208.07,-11679.65"/>
</g>
<!-- transpose_back_0_15 -->
<g id="node281" class="node">
<title>transpose_back_0_15</title>
<ellipse fill="lightgray" stroke="black" cx="13380.57" cy="-11407.8" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13380.57" y="-11419.1" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13380.57" y="-11404.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13380.57" y="-11389.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_0_15&#45;&gt;transpose_back_0_15 -->
<g id="edge353" class="edge">
<title>attn_output_0_15&#45;&gt;transpose_back_0_15</title>
<path fill="none" stroke="black" d="M14076.73,-11501.74C13925.34,-11481.53 13674.15,-11448 13518.49,-11427.22"/>
<polygon fill="black" stroke="black" points="13518.76,-11423.72 13508.38,-11425.87 13517.83,-11430.66 13518.76,-11423.72"/>
</g>
<!-- softmax_0_15&#45;&gt;attn_output_0_15 -->
<g id="edge352" class="edge">
<title>softmax_0_15&#45;&gt;attn_output_0_15</title>
<path fill="none" stroke="black" d="M14204.57,-11594.18C14204.57,-11585.73 14204.57,-11576.63 14204.57,-11567.81"/>
<polygon fill="black" stroke="black" points="14208.07,-11567.65 14204.57,-11557.65 14201.07,-11567.65 14208.07,-11567.65"/>
</g>
<!-- reshape_concat_0_15 -->
<g id="node282" class="node">
<title>reshape_concat_0_15</title>
<ellipse fill="lightcyan" stroke="black" cx="13305.57" cy="-11295.8" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13305.57" y="-11307.1" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13305.57" y="-11292.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13305.57" y="-11277.1" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_0_15&#45;&gt;reshape_concat_0_15 -->
<g id="edge354" class="edge">
<title>transpose_back_0_15&#45;&gt;reshape_concat_0_15</title>
<path fill="none" stroke="black" d="M13356.02,-11370.79C13349.61,-11361.38 13342.62,-11351.14 13335.95,-11341.35"/>
<polygon fill="black" stroke="black" points="13338.71,-11339.19 13330.19,-11332.9 13332.93,-11343.14 13338.71,-11339.19"/>
</g>
<!-- reshape_concat_0_15&#45;&gt;allgather_dim_0_3 -->
<g id="edge355" class="edge">
<title>reshape_concat_0_15&#45;&gt;allgather_dim_0_3</title>
<path fill="none" stroke="black" d="M13206.28,-11270.75C13188.1,-11266.5 13169.29,-11262.19 13151.57,-11258.3 13040.9,-11234.03 12914.05,-11208.69 12824.9,-11191.28"/>
<polygon fill="black" stroke="black" points="12825.52,-11187.84 12815.03,-11189.36 12824.18,-11194.71 12825.52,-11187.84"/>
</g>
<!-- output_proj_0_3 -->
<g id="node287" class="node">
<title>output_proj_0_3</title>
<ellipse fill="orange" stroke="black" cx="11293.57" cy="-10955.22" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="11293.57" y="-10974.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11293.57" y="-10959.02" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="11293.57" y="-10944.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11293.57" y="-10929.02" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_0_3&#45;&gt;output_proj_0_3 -->
<g id="edge360" class="edge">
<title>head_group_0_3&#45;&gt;output_proj_0_3</title>
<path fill="none" stroke="black" d="M11474.75,-11040.29C11449.82,-11028.72 11416.36,-11013.19 11384.97,-10998.63"/>
<polygon fill="black" stroke="black" points="11386.29,-10995.38 11375.75,-10994.35 11383.34,-11001.73 11386.29,-10995.38"/>
</g>
<!-- allreduce_output_0 -->
<g id="node288" class="node">
<title>allreduce_output_0</title>
<polygon fill="red" stroke="black" points="11045.57,-10870.14 10902.57,-10817.14 11045.57,-10764.14 11188.57,-10817.14 11045.57,-10870.14"/>
<text text-anchor="middle" x="11045.57" y="-10828.44" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="11045.57" y="-10813.44" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11045.57" y="-10798.44" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_0_0&#45;&gt;allreduce_output_0 -->
<g id="edge361" class="edge">
<title>output_proj_0_0&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M10083.94,-10937.97C10299.14,-10911.16 10725.25,-10858.06 10930.19,-10832.52"/>
<polygon fill="black" stroke="black" points="10930.88,-10835.96 10940.37,-10831.25 10930.02,-10829.01 10930.88,-10835.96"/>
</g>
<!-- output_proj_0_1&#45;&gt;allreduce_output_0 -->
<g id="edge362" class="edge">
<title>output_proj_0_1&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M10618.72,-10926.11C10717.13,-10901.21 10859.17,-10865.29 10951.92,-10841.83"/>
<polygon fill="black" stroke="black" points="10953.02,-10845.16 10961.86,-10839.31 10951.3,-10838.37 10953.02,-10845.16"/>
</g>
<!-- output_proj_0_2&#45;&gt;allreduce_output_0 -->
<g id="edge363" class="edge">
<title>output_proj_0_2&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M10970.2,-10908.91C10981.58,-10895.2 10994.11,-10880.11 11005.63,-10866.24"/>
<polygon fill="black" stroke="black" points="11008.59,-10868.15 11012.29,-10858.23 11003.2,-10863.68 11008.59,-10868.15"/>
</g>
<!-- output_proj_0_3&#45;&gt;allreduce_output_0 -->
<g id="edge364" class="edge">
<title>output_proj_0_3&#45;&gt;allreduce_output_0</title>
<path fill="none" stroke="black" d="M11220.51,-10914.13C11185.88,-10895.13 11144.84,-10872.61 11111.22,-10854.16"/>
<polygon fill="black" stroke="black" points="11112.84,-10851.06 11102.39,-10849.32 11109.48,-10857.19 11112.84,-10851.06"/>
</g>
<!-- allreduce_output_0&#45;&gt;residual_0 -->
<g id="edge365" class="edge">
<title>allreduce_output_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M11176.55,-10812.66C11814.36,-10795.93 14583.3,-10723.92 15053.58,-10711.86"/>
<polygon fill="black" stroke="black" points="15053.71,-10715.35 15063.61,-10711.6 15053.53,-10708.36 15053.71,-10715.35"/>
</g>
<!-- allreduce_output_0&#45;&gt;residual_0 -->
<g id="edge366" class="edge">
<title>allreduce_output_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M11176.86,-10812.79C11815.16,-10796.34 14582.47,-10724.37 15053.35,-10711.96"/>
<polygon fill="black" stroke="black" points="15053.49,-10715.46 15063.4,-10711.7 15053.31,-10708.46 15053.49,-10715.46"/>
</g>
<!-- router_0_0 -->
<g id="node305" class="node">
<title>router_0_0</title>
<ellipse fill="purple" stroke="black" cx="12563.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12563.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12563.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12563.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_0&#45;&gt;router_0_0 -->
<g id="edge383" class="edge">
<title>ln2_0_0&#45;&gt;router_0_0</title>
<path fill="none" stroke="black" d="M12653.44,-10580.53C12640.82,-10570.01 12626.86,-10558.37 12613.77,-10547.47"/>
<polygon fill="black" stroke="black" points="12615.68,-10544.5 12605.75,-10540.79 12611.2,-10549.88 12615.68,-10544.5"/>
</g>
<!-- router_0_1 -->
<g id="node306" class="node">
<title>router_0_1</title>
<ellipse fill="purple" stroke="black" cx="12921.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12921.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12921.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12921.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_1&#45;&gt;router_0_1 -->
<g id="edge384" class="edge">
<title>ln2_0_1&#45;&gt;router_0_1</title>
<path fill="none" stroke="black" d="M12995.86,-10579.92C12985.77,-10569.83 12974.68,-10558.75 12964.23,-10548.29"/>
<polygon fill="black" stroke="black" points="12966.65,-10545.77 12957.11,-10541.17 12961.7,-10550.72 12966.65,-10545.77"/>
</g>
<!-- router_0_2 -->
<g id="node307" class="node">
<title>router_0_2</title>
<ellipse fill="purple" stroke="black" cx="13269.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13269.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13269.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13269.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_2&#45;&gt;router_0_2 -->
<g id="edge385" class="edge">
<title>ln2_0_2&#45;&gt;router_0_2</title>
<path fill="none" stroke="black" d="M13328.76,-10579.62C13321.09,-10570.03 13312.71,-10559.56 13304.74,-10549.59"/>
<polygon fill="black" stroke="black" points="13307.43,-10547.36 13298.45,-10541.74 13301.97,-10551.73 13307.43,-10547.36"/>
</g>
<!-- router_0_3 -->
<g id="node308" class="node">
<title>router_0_3</title>
<ellipse fill="purple" stroke="black" cx="13643.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13643.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13643.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13643.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_3&#45;&gt;router_0_3 -->
<g id="edge386" class="edge">
<title>ln2_0_3&#45;&gt;router_0_3</title>
<path fill="none" stroke="black" d="M13666.92,-10579.01C13664.14,-10570.29 13661.15,-10560.87 13658.26,-10551.79"/>
<polygon fill="black" stroke="black" points="13661.54,-10550.57 13655.18,-10542.11 13654.87,-10552.7 13661.54,-10550.57"/>
</g>
<!-- router_0_4 -->
<g id="node309" class="node">
<title>router_0_4</title>
<ellipse fill="purple" stroke="black" cx="13972.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13972.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13972.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13972.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_4&#45;&gt;router_0_4 -->
<g id="edge387" class="edge">
<title>ln2_0_4&#45;&gt;router_0_4</title>
<path fill="none" stroke="black" d="M13989.25,-10579.01C13987.29,-10570.38 13985.17,-10561.07 13983.13,-10552.08"/>
<polygon fill="black" stroke="black" points="13986.49,-10551.08 13980.86,-10542.11 13979.67,-10552.63 13986.49,-10551.08"/>
</g>
<!-- router_0_5 -->
<g id="node310" class="node">
<title>router_0_5</title>
<ellipse fill="purple" stroke="black" cx="14297.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14297.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14297.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14297.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_5&#45;&gt;router_0_5 -->
<g id="edge388" class="edge">
<title>ln2_0_5&#45;&gt;router_0_5</title>
<path fill="none" stroke="black" d="M14308.91,-10579.01C14307.61,-10570.56 14306.2,-10561.47 14304.84,-10552.65"/>
<polygon fill="black" stroke="black" points="14308.25,-10551.83 14303.27,-10542.48 14301.34,-10552.9 14308.25,-10551.83"/>
</g>
<!-- router_0_6 -->
<g id="node311" class="node">
<title>router_0_6</title>
<ellipse fill="purple" stroke="black" cx="14619.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14619.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14619.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14619.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_6&#45;&gt;router_0_6 -->
<g id="edge389" class="edge">
<title>ln2_0_6&#45;&gt;router_0_6</title>
<path fill="none" stroke="black" d="M14627.58,-10579.01C14626.66,-10570.56 14625.66,-10561.47 14624.7,-10552.65"/>
<polygon fill="black" stroke="black" points="14628.16,-10552.04 14623.59,-10542.48 14621.2,-10552.8 14628.16,-10552.04"/>
</g>
<!-- router_0_7 -->
<g id="node312" class="node">
<title>router_0_7</title>
<ellipse fill="purple" stroke="black" cx="14947.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14947.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14947.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14947.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_7&#45;&gt;router_0_7 -->
<g id="edge390" class="edge">
<title>ln2_0_7&#45;&gt;router_0_7</title>
<path fill="none" stroke="black" d="M14947.57,-10579.01C14947.57,-10570.56 14947.57,-10561.47 14947.57,-10552.65"/>
<polygon fill="black" stroke="black" points="14951.07,-10552.48 14947.57,-10542.48 14944.07,-10552.48 14951.07,-10552.48"/>
</g>
<!-- router_0_8 -->
<g id="node313" class="node">
<title>router_0_8</title>
<ellipse fill="purple" stroke="black" cx="15307.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15307.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15307.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15307.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_8&#45;&gt;router_0_8 -->
<g id="edge391" class="edge">
<title>ln2_0_8&#45;&gt;router_0_8</title>
<path fill="none" stroke="black" d="M15300.9,-10579.01C15301.67,-10570.56 15302.5,-10561.47 15303.3,-10552.65"/>
<polygon fill="black" stroke="black" points="15306.8,-10552.76 15304.22,-10542.48 15299.83,-10552.12 15306.8,-10552.76"/>
</g>
<!-- router_0_9 -->
<g id="node314" class="node">
<title>router_0_9</title>
<ellipse fill="purple" stroke="black" cx="15710.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15710.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15710.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15710.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_9&#45;&gt;router_0_9 -->
<g id="edge392" class="edge">
<title>ln2_0_9&#45;&gt;router_0_9</title>
<path fill="none" stroke="black" d="M15657.44,-10579.62C15664.26,-10570.12 15671.7,-10559.77 15678.79,-10549.89"/>
<polygon fill="black" stroke="black" points="15681.66,-10551.9 15684.65,-10541.74 15675.97,-10547.82 15681.66,-10551.9"/>
</g>
<!-- router_0_10 -->
<g id="node315" class="node">
<title>router_0_10</title>
<ellipse fill="purple" stroke="black" cx="16082.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16082.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16082.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16082.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_10&#45;&gt;router_0_10 -->
<g id="edge393" class="edge">
<title>ln2_0_10&#45;&gt;router_0_10</title>
<path fill="none" stroke="black" d="M15997.13,-10580.23C16009.05,-10569.83 16022.2,-10558.35 16034.53,-10547.58"/>
<polygon fill="black" stroke="black" points="16036.86,-10550.19 16042.09,-10540.98 16032.25,-10544.92 16036.86,-10550.19"/>
</g>
<!-- router_0_11 -->
<g id="node316" class="node">
<title>router_0_11</title>
<ellipse fill="purple" stroke="black" cx="16514.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16514.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16514.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16514.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_11&#45;&gt;router_0_11 -->
<g id="edge394" class="edge">
<title>ln2_0_11&#45;&gt;router_0_11</title>
<path fill="none" stroke="black" d="M16347.08,-10583.38C16374.93,-10570.45 16407.17,-10555.49 16435.88,-10542.16"/>
<polygon fill="black" stroke="black" points="16437.47,-10545.28 16445.07,-10537.9 16434.52,-10538.93 16437.47,-10545.28"/>
</g>
<!-- router_0_12 -->
<g id="node317" class="node">
<title>router_0_12</title>
<ellipse fill="purple" stroke="black" cx="16863.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16863.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16863.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16863.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_12&#45;&gt;router_0_12 -->
<g id="edge395" class="edge">
<title>ln2_0_12&#45;&gt;router_0_12</title>
<path fill="none" stroke="black" d="M16672.01,-10584.26C16705.1,-10570.68 16743.98,-10554.72 16778.03,-10540.75"/>
<polygon fill="black" stroke="black" points="16779.57,-10543.9 16787.5,-10536.86 16776.92,-10537.42 16779.57,-10543.9"/>
</g>
<!-- router_0_13 -->
<g id="node318" class="node">
<title>router_0_13</title>
<ellipse fill="purple" stroke="black" cx="17195.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17195.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17195.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17195.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_13&#45;&gt;router_0_13 -->
<g id="edge396" class="edge">
<title>ln2_0_13&#45;&gt;router_0_13</title>
<path fill="none" stroke="black" d="M16991.78,-10584.85C17027.51,-10570.96 17069.85,-10554.51 17106.66,-10540.2"/>
<polygon fill="black" stroke="black" points="17108.33,-10543.3 17116.38,-10536.42 17105.8,-10536.78 17108.33,-10543.3"/>
</g>
<!-- router_0_14 -->
<g id="node319" class="node">
<title>router_0_14</title>
<ellipse fill="purple" stroke="black" cx="17642.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17642.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17642.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17642.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_14&#45;&gt;router_0_14 -->
<g id="edge397" class="edge">
<title>ln2_0_14&#45;&gt;router_0_14</title>
<path fill="none" stroke="black" d="M17330.08,-10588.87C17391.27,-10572.57 17469.5,-10551.73 17532.38,-10534.99"/>
<polygon fill="black" stroke="black" points="17533.57,-10538.29 17542.34,-10532.34 17531.77,-10531.53 17533.57,-10538.29"/>
</g>
<!-- router_0_15 -->
<g id="node320" class="node">
<title>router_0_15</title>
<ellipse fill="purple" stroke="black" cx="18089.57" cy="-10504.64" rx="148" ry="37.5"/>
<text text-anchor="middle" x="18089.57" y="-10515.94" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="18089.57" y="-10500.94" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18089.57" y="-10485.94" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_0_15&#45;&gt;router_0_15 -->
<g id="edge398" class="edge">
<title>ln2_0_15&#45;&gt;router_0_15</title>
<path fill="none" stroke="black" d="M17894.79,-10584.41C17928.53,-10570.77 17968.24,-10554.71 18002.98,-10540.66"/>
<polygon fill="black" stroke="black" points="18004.68,-10543.75 18012.63,-10536.75 18002.05,-10537.26 18004.68,-10543.75"/>
</g>
<!-- dispatch_0_0 -->
<g id="node321" class="node">
<title>dispatch_0_0</title>
<polygon fill="purple" stroke="black" points="12166.57,-10430.14 11978.57,-10377.14 12166.57,-10324.14 12354.57,-10377.14 12166.57,-10430.14"/>
<text text-anchor="middle" x="12166.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12166.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12166.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_0&#45;&gt;dispatch_0_0 -->
<g id="edge399" class="edge">
<title>router_0_0&#45;&gt;dispatch_0_0</title>
<path fill="none" stroke="black" d="M12472.49,-10474.85C12410,-10455.09 12327.18,-10428.91 12263.48,-10408.77"/>
<polygon fill="black" stroke="black" points="12264.41,-10405.4 12253.82,-10405.72 12262.3,-10412.07 12264.41,-10405.4"/>
</g>
<!-- dispatch_0_1 -->
<g id="node322" class="node">
<title>dispatch_0_1</title>
<polygon fill="purple" stroke="black" points="12565.57,-10430.14 12377.57,-10377.14 12565.57,-10324.14 12753.57,-10377.14 12565.57,-10430.14"/>
<text text-anchor="middle" x="12565.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12565.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12565.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_1&#45;&gt;dispatch_0_1 -->
<g id="edge400" class="edge">
<title>router_0_1&#45;&gt;dispatch_0_1</title>
<path fill="none" stroke="black" d="M12836.75,-10473.74C12782.61,-10454.65 12712.45,-10429.91 12657.06,-10410.39"/>
<polygon fill="black" stroke="black" points="12658.19,-10407.08 12647.6,-10407.05 12655.86,-10413.68 12658.19,-10407.08"/>
</g>
<!-- dispatch_0_2 -->
<g id="node323" class="node">
<title>dispatch_0_2</title>
<polygon fill="purple" stroke="black" points="12967.57,-10430.14 12779.57,-10377.14 12967.57,-10324.14 13155.57,-10377.14 12967.57,-10430.14"/>
<text text-anchor="middle" x="12967.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12967.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12967.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_2&#45;&gt;dispatch_0_2 -->
<g id="edge401" class="edge">
<title>router_0_2&#45;&gt;dispatch_0_2</title>
<path fill="none" stroke="black" d="M13194.15,-10472.29C13150.84,-10454.3 13096.36,-10431.66 13051.68,-10413.09"/>
<polygon fill="black" stroke="black" points="13052.88,-10409.8 13042.3,-10409.19 13050.19,-10416.26 13052.88,-10409.8"/>
</g>
<!-- dispatch_0_3 -->
<g id="node324" class="node">
<title>dispatch_0_3</title>
<polygon fill="purple" stroke="black" points="13362.57,-10430.14 13174.57,-10377.14 13362.57,-10324.14 13550.57,-10377.14 13362.57,-10430.14"/>
<text text-anchor="middle" x="13362.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13362.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13362.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_3&#45;&gt;dispatch_0_3 -->
<g id="edge402" class="edge">
<title>router_0_3&#45;&gt;dispatch_0_3</title>
<path fill="none" stroke="black" d="M13571.94,-10471.64C13532.72,-10454.13 13483.98,-10432.36 13443.4,-10414.24"/>
<polygon fill="black" stroke="black" points="13444.64,-10410.95 13434.08,-10410.07 13441.78,-10417.35 13444.64,-10410.95"/>
</g>
<!-- dispatch_0_4 -->
<g id="node325" class="node">
<title>dispatch_0_4</title>
<polygon fill="purple" stroke="black" points="13757.57,-10430.14 13569.57,-10377.14 13757.57,-10324.14 13945.57,-10377.14 13757.57,-10430.14"/>
<text text-anchor="middle" x="13757.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13757.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13757.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_4&#45;&gt;dispatch_0_4 -->
<g id="edge403" class="edge">
<title>router_0_4&#45;&gt;dispatch_0_4</title>
<path fill="none" stroke="black" d="M13914.96,-10470.01C13887.79,-10454.15 13855.16,-10435.1 13826.68,-10418.47"/>
<polygon fill="black" stroke="black" points="13828.38,-10415.42 13817.98,-10413.4 13824.85,-10421.46 13828.38,-10415.42"/>
</g>
<!-- dispatch_0_5 -->
<g id="node326" class="node">
<title>dispatch_0_5</title>
<polygon fill="purple" stroke="black" points="14151.57,-10430.14 13963.57,-10377.14 14151.57,-10324.14 14339.57,-10377.14 14151.57,-10430.14"/>
<text text-anchor="middle" x="14151.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14151.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14151.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_5&#45;&gt;dispatch_0_5 -->
<g id="edge404" class="edge">
<title>router_0_5&#45;&gt;dispatch_0_5</title>
<path fill="none" stroke="black" d="M14256.52,-10468.34C14240.5,-10454.58 14221.92,-10438.61 14204.89,-10423.97"/>
<polygon fill="black" stroke="black" points="14207.06,-10421.22 14197.19,-10417.35 14202.5,-10426.53 14207.06,-10421.22"/>
</g>
<!-- dispatch_0_6 -->
<g id="node327" class="node">
<title>dispatch_0_6</title>
<polygon fill="purple" stroke="black" points="14545.57,-10430.14 14357.57,-10377.14 14545.57,-10324.14 14733.57,-10377.14 14545.57,-10430.14"/>
<text text-anchor="middle" x="14545.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14545.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14545.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_6&#45;&gt;dispatch_0_6 -->
<g id="edge405" class="edge">
<title>router_0_6&#45;&gt;dispatch_0_6</title>
<path fill="none" stroke="black" d="M14598.17,-10467.34C14591.57,-10456.15 14584.17,-10443.6 14577.05,-10431.51"/>
<polygon fill="black" stroke="black" points="14580.02,-10429.66 14571.92,-10422.83 14573.99,-10433.22 14580.02,-10429.66"/>
</g>
<!-- dispatch_0_7 -->
<g id="node328" class="node">
<title>dispatch_0_7</title>
<polygon fill="purple" stroke="black" points="14939.57,-10430.14 14751.57,-10377.14 14939.57,-10324.14 15127.57,-10377.14 14939.57,-10430.14"/>
<text text-anchor="middle" x="14939.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14939.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14939.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_7&#45;&gt;dispatch_0_7 -->
<g id="edge406" class="edge">
<title>router_0_7&#45;&gt;dispatch_0_7</title>
<path fill="none" stroke="black" d="M14945.24,-10467C14944.69,-10458.39 14944.09,-10448.99 14943.49,-10439.62"/>
<polygon fill="black" stroke="black" points="14946.98,-10439.27 14942.85,-10429.51 14939.99,-10439.71 14946.98,-10439.27"/>
</g>
<!-- dispatch_0_8 -->
<g id="node329" class="node">
<title>dispatch_0_8</title>
<polygon fill="purple" stroke="black" points="15333.57,-10430.14 15145.57,-10377.14 15333.57,-10324.14 15521.57,-10377.14 15333.57,-10430.14"/>
<text text-anchor="middle" x="15333.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15333.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15333.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_8&#45;&gt;dispatch_0_8 -->
<g id="edge407" class="edge">
<title>router_0_8&#45;&gt;dispatch_0_8</title>
<path fill="none" stroke="black" d="M15315.16,-10467C15317.07,-10457.78 15319.18,-10447.63 15321.25,-10437.61"/>
<polygon fill="black" stroke="black" points="15324.71,-10438.15 15323.32,-10427.65 15317.86,-10436.73 15324.71,-10438.15"/>
</g>
<!-- dispatch_0_9 -->
<g id="node330" class="node">
<title>dispatch_0_9</title>
<polygon fill="purple" stroke="black" points="15727.57,-10430.14 15539.57,-10377.14 15727.57,-10324.14 15915.57,-10377.14 15727.57,-10430.14"/>
<text text-anchor="middle" x="15727.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15727.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15727.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_9&#45;&gt;dispatch_0_9 -->
<g id="edge408" class="edge">
<title>router_0_9&#45;&gt;dispatch_0_9</title>
<path fill="none" stroke="black" d="M15715.54,-10467C15716.74,-10458.09 15718.07,-10448.32 15719.38,-10438.62"/>
<polygon fill="black" stroke="black" points="15722.87,-10438.96 15720.74,-10428.58 15715.93,-10438.02 15722.87,-10438.96"/>
</g>
<!-- dispatch_0_10 -->
<g id="node331" class="node">
<title>dispatch_0_10</title>
<polygon fill="purple" stroke="black" points="16121.57,-10430.14 15933.57,-10377.14 16121.57,-10324.14 16309.57,-10377.14 16121.57,-10430.14"/>
<text text-anchor="middle" x="16121.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16121.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16121.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_10&#45;&gt;dispatch_0_10 -->
<g id="edge409" class="edge">
<title>router_0_10&#45;&gt;dispatch_0_10</title>
<path fill="none" stroke="black" d="M16093.96,-10467C16096.99,-10457.25 16100.34,-10446.48 16103.62,-10435.9"/>
<polygon fill="black" stroke="black" points="16106.99,-10436.85 16106.62,-10426.27 16100.31,-10434.78 16106.99,-10436.85"/>
</g>
<!-- dispatch_0_11 -->
<g id="node332" class="node">
<title>dispatch_0_11</title>
<polygon fill="purple" stroke="black" points="16515.57,-10430.14 16327.57,-10377.14 16515.57,-10324.14 16703.57,-10377.14 16515.57,-10430.14"/>
<text text-anchor="middle" x="16515.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16515.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16515.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_11&#45;&gt;dispatch_0_11 -->
<g id="edge410" class="edge">
<title>router_0_11&#45;&gt;dispatch_0_11</title>
<path fill="none" stroke="black" d="M16514.87,-10467C16514.93,-10458.69 16515,-10449.65 16515.08,-10440.61"/>
<polygon fill="black" stroke="black" points="16518.58,-10440.47 16515.16,-10430.44 16511.58,-10440.41 16518.58,-10440.47"/>
</g>
<!-- dispatch_0_12 -->
<g id="node333" class="node">
<title>dispatch_0_12</title>
<polygon fill="purple" stroke="black" points="16912.57,-10430.14 16724.57,-10377.14 16912.57,-10324.14 17100.57,-10377.14 16912.57,-10430.14"/>
<text text-anchor="middle" x="16912.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16912.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16912.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_12&#45;&gt;dispatch_0_12 -->
<g id="edge411" class="edge">
<title>router_0_12&#45;&gt;dispatch_0_12</title>
<path fill="none" stroke="black" d="M16877.88,-10467C16881.81,-10456.93 16886.17,-10445.76 16890.43,-10434.84"/>
<polygon fill="black" stroke="black" points="16893.76,-10435.93 16894.14,-10425.35 16887.24,-10433.39 16893.76,-10435.93"/>
</g>
<!-- dispatch_0_13 -->
<g id="node334" class="node">
<title>dispatch_0_13</title>
<polygon fill="purple" stroke="black" points="17308.57,-10430.14 17120.57,-10377.14 17308.57,-10324.14 17496.57,-10377.14 17308.57,-10430.14"/>
<text text-anchor="middle" x="17308.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17308.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17308.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_13&#45;&gt;dispatch_0_13 -->
<g id="edge412" class="edge">
<title>router_0_13&#45;&gt;dispatch_0_13</title>
<path fill="none" stroke="black" d="M17227.65,-10468.01C17239.1,-10455.29 17252.21,-10440.73 17264.5,-10427.09"/>
<polygon fill="black" stroke="black" points="17267.13,-10429.4 17271.22,-10419.62 17261.93,-10424.71 17267.13,-10429.4"/>
</g>
<!-- dispatch_0_14 -->
<g id="node335" class="node">
<title>dispatch_0_14</title>
<polygon fill="purple" stroke="black" points="17715.57,-10430.14 17527.57,-10377.14 17715.57,-10324.14 17903.57,-10377.14 17715.57,-10430.14"/>
<text text-anchor="middle" x="17715.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17715.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17715.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_14&#45;&gt;dispatch_0_14 -->
<g id="edge413" class="edge">
<title>router_0_14&#45;&gt;dispatch_0_14</title>
<path fill="none" stroke="black" d="M17663.69,-10467.34C17670.19,-10456.15 17677.5,-10443.6 17684.53,-10431.51"/>
<polygon fill="black" stroke="black" points="17687.58,-10433.23 17689.58,-10422.83 17681.53,-10429.71 17687.58,-10433.23"/>
</g>
<!-- dispatch_0_15 -->
<g id="node336" class="node">
<title>dispatch_0_15</title>
<polygon fill="purple" stroke="black" points="18161.57,-10430.14 17973.57,-10377.14 18161.57,-10324.14 18349.57,-10377.14 18161.57,-10430.14"/>
<text text-anchor="middle" x="18161.57" y="-10388.44" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="18161.57" y="-10373.44" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18161.57" y="-10358.44" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_0_15&#45;&gt;dispatch_0_15 -->
<g id="edge414" class="edge">
<title>router_0_15&#45;&gt;dispatch_0_15</title>
<path fill="none" stroke="black" d="M18110.4,-10467.34C18116.69,-10456.38 18123.73,-10444.1 18130.53,-10432.24"/>
<polygon fill="black" stroke="black" points="18133.73,-10433.7 18135.67,-10423.28 18127.66,-10430.21 18133.73,-10433.7"/>
</g>
<!-- expert_0_0_fc1_0 -->
<g id="node337" class="node">
<title>expert_0_0_fc1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11961.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11961.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11961.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11961.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11961.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_0&#45;&gt;expert_0_0_fc1_0 -->
<g id="edge415" class="edge">
<title>dispatch_0_0&#45;&gt;expert_0_0_fc1_0</title>
<path fill="none" stroke="black" d="M12111.37,-10339.49C12086.33,-10322.87 12056.46,-10303.04 12030.02,-10285.49"/>
<polygon fill="black" stroke="black" points="12031.83,-10282.49 12021.56,-10279.87 12027.95,-10288.32 12031.83,-10282.49"/>
</g>
<!-- expert_0_0_fc1_1 -->
<g id="node338" class="node">
<title>expert_0_0_fc1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12380.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12380.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="12380.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12380.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12380.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_1&#45;&gt;expert_0_0_fc1_1 -->
<g id="edge416" class="edge">
<title>dispatch_0_1&#45;&gt;expert_0_0_fc1_1</title>
<path fill="none" stroke="black" d="M12514.04,-10338.23C12492.52,-10322.4 12467.29,-10303.84 12444.6,-10287.15"/>
<polygon fill="black" stroke="black" points="12446.5,-10284.2 12436.37,-10281.09 12442.35,-10289.84 12446.5,-10284.2"/>
</g>
<!-- expert_0_1_fc1_2 -->
<g id="node339" class="node">
<title>expert_0_1_fc1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12958.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12958.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="12958.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12958.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12958.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_2&#45;&gt;expert_0_1_fc1_2 -->
<g id="edge417" class="edge">
<title>dispatch_0_2&#45;&gt;expert_0_1_fc1_2</title>
<path fill="none" stroke="black" d="M12964.2,-10325.08C12963.6,-10316.09 12962.98,-10306.68 12962.37,-10297.53"/>
<polygon fill="black" stroke="black" points="12965.85,-10297.1 12961.7,-10287.35 12958.87,-10297.56 12965.85,-10297.1"/>
</g>
<!-- expert_0_1_fc1_3 -->
<g id="node340" class="node">
<title>expert_0_1_fc1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13335.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13335.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="13335.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13335.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13335.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_3&#45;&gt;expert_0_1_fc1_3 -->
<g id="edge418" class="edge">
<title>dispatch_0_3&#45;&gt;expert_0_1_fc1_3</title>
<path fill="none" stroke="black" d="M13352.75,-10326.62C13350.85,-10317.03 13348.84,-10306.92 13346.89,-10297.11"/>
<polygon fill="black" stroke="black" points="13350.27,-10296.16 13344.9,-10287.04 13343.41,-10297.53 13350.27,-10296.16"/>
</g>
<!-- expert_0_2_fc1_4 -->
<g id="node341" class="node">
<title>expert_0_2_fc1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13759.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13759.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13759.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13759.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13759.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_4&#45;&gt;expert_0_2_fc1_4 -->
<g id="edge419" class="edge">
<title>dispatch_0_4&#45;&gt;expert_0_2_fc1_4</title>
<path fill="none" stroke="black" d="M13758.34,-10324.3C13758.46,-10315.56 13758.6,-10306.43 13758.73,-10297.55"/>
<polygon fill="black" stroke="black" points="13762.23,-10297.33 13758.88,-10287.28 13755.23,-10297.23 13762.23,-10297.33"/>
</g>
<!-- expert_0_2_fc1_5 -->
<g id="node342" class="node">
<title>expert_0_2_fc1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14132.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14132.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="14132.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14132.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14132.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_5&#45;&gt;expert_0_2_fc1_5 -->
<g id="edge420" class="edge">
<title>dispatch_0_5&#45;&gt;expert_0_2_fc1_5</title>
<path fill="none" stroke="black" d="M14144.55,-10325.85C14143.26,-10316.62 14141.91,-10306.92 14140.59,-10297.5"/>
<polygon fill="black" stroke="black" points="14144.04,-10296.84 14139.19,-10287.42 14137.1,-10297.81 14144.04,-10296.84"/>
</g>
<!-- expert_0_3_fc1_6 -->
<g id="node343" class="node">
<title>expert_0_3_fc1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14548.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14548.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14548.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14548.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14548.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_6&#45;&gt;expert_0_3_fc1_6 -->
<g id="edge421" class="edge">
<title>dispatch_0_6&#45;&gt;expert_0_3_fc1_6</title>
<path fill="none" stroke="black" d="M14546.72,-10324.3C14546.91,-10315.56 14547.11,-10306.43 14547.31,-10297.55"/>
<polygon fill="black" stroke="black" points="14550.81,-10297.35 14547.53,-10287.28 14543.81,-10297.2 14550.81,-10297.35"/>
</g>
<!-- expert_0_3_fc1_7 -->
<g id="node344" class="node">
<title>expert_0_3_fc1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14870.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14870.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14870.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14870.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14870.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_7&#45;&gt;expert_0_3_fc1_7 -->
<g id="edge422" class="edge">
<title>dispatch_0_7&#45;&gt;expert_0_3_fc1_7</title>
<path fill="none" stroke="black" d="M14916.41,-10330.45C14910.72,-10319.23 14904.58,-10307.11 14898.69,-10295.5"/>
<polygon fill="black" stroke="black" points="14901.68,-10293.66 14894.03,-10286.32 14895.43,-10296.82 14901.68,-10293.66"/>
</g>
<!-- expert_0_4_fc1_8 -->
<g id="node345" class="node">
<title>expert_0_4_fc1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15349.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15349.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15349.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15349.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15349.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_8&#45;&gt;expert_0_4_fc1_8 -->
<g id="edge423" class="edge">
<title>dispatch_0_8&#45;&gt;expert_0_4_fc1_8</title>
<path fill="none" stroke="black" d="M15339.53,-10325.47C15340.61,-10316.25 15341.75,-10306.59 15342.85,-10297.2"/>
<polygon fill="black" stroke="black" points="15346.34,-10297.51 15344.03,-10287.17 15339.39,-10296.69 15346.34,-10297.51"/>
</g>
<!-- expert_0_4_fc1_9 -->
<g id="node346" class="node">
<title>expert_0_4_fc1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15720.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15720.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15720.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15720.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15720.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_9&#45;&gt;expert_0_4_fc1_9 -->
<g id="edge424" class="edge">
<title>dispatch_0_9&#45;&gt;expert_0_4_fc1_9</title>
<path fill="none" stroke="black" d="M15724.93,-10324.69C15724.47,-10315.83 15724,-10306.57 15723.53,-10297.57"/>
<polygon fill="black" stroke="black" points="15727.03,-10297.35 15723.02,-10287.54 15720.03,-10297.71 15727.03,-10297.35"/>
</g>
<!-- expert_0_5_fc1_10 -->
<g id="node347" class="node">
<title>expert_0_5_fc1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16145.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16145.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16145.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16145.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16145.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_10&#45;&gt;expert_0_5_fc1_10 -->
<g id="edge425" class="edge">
<title>dispatch_0_10&#45;&gt;expert_0_5_fc1_10</title>
<path fill="none" stroke="black" d="M16130.37,-10326.24C16132.04,-10316.78 16133.8,-10306.82 16135.5,-10297.16"/>
<polygon fill="black" stroke="black" points="16138.96,-10297.69 16137.25,-10287.23 16132.07,-10296.47 16138.96,-10297.69"/>
</g>
<!-- expert_0_5_fc1_11 -->
<g id="node348" class="node">
<title>expert_0_5_fc1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16504.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16504.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16504.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16504.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16504.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_11&#45;&gt;expert_0_5_fc1_11 -->
<g id="edge426" class="edge">
<title>dispatch_0_11&#45;&gt;expert_0_5_fc1_11</title>
<path fill="none" stroke="black" d="M16511.45,-10325.08C16510.72,-10316.09 16509.96,-10306.68 16509.22,-10297.53"/>
<polygon fill="black" stroke="black" points="16512.69,-10297.04 16508.4,-10287.35 16505.71,-10297.6 16512.69,-10297.04"/>
</g>
<!-- expert_0_6_fc1_12 -->
<g id="node349" class="node">
<title>expert_0_6_fc1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16940.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16940.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="16940.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16940.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16940.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_12&#45;&gt;expert_0_6_fc1_12 -->
<g id="edge427" class="edge">
<title>dispatch_0_12&#45;&gt;expert_0_6_fc1_12</title>
<path fill="none" stroke="black" d="M16922.76,-10326.62C16924.73,-10317.03 16926.82,-10306.92 16928.83,-10297.11"/>
<polygon fill="black" stroke="black" points="16932.32,-10297.54 16930.91,-10287.04 16925.46,-10296.13 16932.32,-10297.54"/>
</g>
<!-- expert_0_6_fc1_13 -->
<g id="node350" class="node">
<title>expert_0_6_fc1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17314.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17314.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="17314.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17314.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17314.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_13&#45;&gt;expert_0_6_fc1_13 -->
<g id="edge428" class="edge">
<title>dispatch_0_13&#45;&gt;expert_0_6_fc1_13</title>
<path fill="none" stroke="black" d="M17310.84,-10324.69C17311.23,-10315.83 17311.64,-10306.57 17312.04,-10297.57"/>
<polygon fill="black" stroke="black" points="17315.54,-10297.68 17312.48,-10287.54 17308.54,-10297.38 17315.54,-10297.68"/>
</g>
<!-- expert_0_7_fc1_14 -->
<g id="node351" class="node">
<title>expert_0_7_fc1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18042.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18042.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="18042.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18042.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18042.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_14&#45;&gt;expert_0_7_fc1_14 -->
<g id="edge429" class="edge">
<title>dispatch_0_14&#45;&gt;expert_0_7_fc1_14</title>
<path fill="none" stroke="black" d="M17790.18,-10345.09C17838.81,-10324.85 17902.5,-10298.35 17953.73,-10277.03"/>
<polygon fill="black" stroke="black" points="17955.26,-10280.18 17963.15,-10273.11 17952.57,-10273.72 17955.26,-10280.18"/>
</g>
<!-- expert_0_7_fc1_15 -->
<g id="node352" class="node">
<title>expert_0_7_fc1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18312.57" cy="-10239.05" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18312.57" y="-10257.85" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="18312.57" y="-10242.85" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18312.57" y="-10227.85" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18312.57" y="-10212.85" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_0_15&#45;&gt;expert_0_7_fc1_15 -->
<g id="edge430" class="edge">
<title>dispatch_0_15&#45;&gt;expert_0_7_fc1_15</title>
<path fill="none" stroke="black" d="M18205.65,-10336.41C18221.81,-10321.85 18240.3,-10305.19 18257.31,-10289.86"/>
<polygon fill="black" stroke="black" points="18259.92,-10292.22 18265.01,-10282.92 18255.24,-10287.02 18259.92,-10292.22"/>
</g>
<!-- expert_0_0_gelu_0 -->
<g id="node353" class="node">
<title>expert_0_0_gelu_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11910.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="11910.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="11910.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11910.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_0_fc1_0&#45;&gt;expert_0_0_gelu_0 -->
<g id="edge431" class="edge">
<title>expert_0_0_fc1_0&#45;&gt;expert_0_0_gelu_0</title>
<path fill="none" stroke="black" d="M11941.86,-10191.43C11937.94,-10182.19 11933.84,-10172.49 11929.94,-10163.27"/>
<polygon fill="black" stroke="black" points="11933.09,-10161.72 11925.97,-10153.87 11926.64,-10164.45 11933.09,-10161.72"/>
</g>
<!-- expert_0_0_gelu_1 -->
<g id="node356" class="node">
<title>expert_0_0_gelu_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12307.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12307.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="12307.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12307.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_0_fc1_1&#45;&gt;expert_0_0_gelu_1 -->
<g id="edge434" class="edge">
<title>expert_0_0_fc1_1&#45;&gt;expert_0_0_gelu_1</title>
<path fill="none" stroke="black" d="M12352.77,-10192.12C12346.84,-10182.34 12340.6,-10172.02 12334.7,-10162.28"/>
<polygon fill="black" stroke="black" points="12337.57,-10160.27 12329.4,-10153.53 12331.59,-10163.89 12337.57,-10160.27"/>
</g>
<!-- expert_0_1_gelu_2 -->
<g id="node358" class="node">
<title>expert_0_1_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12955.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12955.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="12955.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12955.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_1_fc1_2&#45;&gt;expert_0_1_gelu_2 -->
<g id="edge437" class="edge">
<title>expert_0_1_fc1_2&#45;&gt;expert_0_1_gelu_2</title>
<path fill="none" stroke="black" d="M12957.4,-10190.74C12957.18,-10182.11 12956.96,-10173.11 12956.74,-10164.49"/>
<polygon fill="black" stroke="black" points="12960.24,-10164.12 12956.49,-10154.21 12953.24,-10164.29 12960.24,-10164.12"/>
</g>
<!-- expert_0_1_gelu_3 -->
<g id="node361" class="node">
<title>expert_0_1_gelu_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13282.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13282.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="13282.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13282.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_1_fc1_3&#45;&gt;expert_0_1_gelu_3 -->
<g id="edge440" class="edge">
<title>expert_0_1_fc1_3&#45;&gt;expert_0_1_gelu_3</title>
<path fill="none" stroke="black" d="M13315.08,-10191.43C13311.02,-10182.19 13306.75,-10172.49 13302.7,-10163.27"/>
<polygon fill="black" stroke="black" points="13305.8,-10161.62 13298.57,-10153.87 13299.39,-10164.44 13305.8,-10161.62"/>
</g>
<!-- expert_0_2_gelu_4 -->
<g id="node363" class="node">
<title>expert_0_2_gelu_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13769.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13769.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13769.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13769.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_2_fc1_4&#45;&gt;expert_0_2_gelu_4 -->
<g id="edge443" class="edge">
<title>expert_0_2_fc1_4&#45;&gt;expert_0_2_gelu_4</title>
<path fill="none" stroke="black" d="M13763.5,-10190.74C13764.22,-10182.02 13764.98,-10172.91 13765.7,-10164.2"/>
<polygon fill="black" stroke="black" points="13769.19,-10164.46 13766.53,-10154.21 13762.21,-10163.88 13769.19,-10164.46"/>
</g>
<!-- expert_0_2_gelu_5 -->
<g id="node366" class="node">
<title>expert_0_2_gelu_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14127.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14127.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="14127.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14127.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_2_fc1_5&#45;&gt;expert_0_2_gelu_5 -->
<g id="edge446" class="edge">
<title>expert_0_2_fc1_5&#45;&gt;expert_0_2_gelu_5</title>
<path fill="none" stroke="black" d="M14130.61,-10190.74C14130.25,-10182.02 14129.87,-10172.91 14129.51,-10164.2"/>
<polygon fill="black" stroke="black" points="14133.01,-10164.05 14129.1,-10154.21 14126.01,-10164.34 14133.01,-10164.05"/>
</g>
<!-- expert_0_3_gelu_6 -->
<g id="node368" class="node">
<title>expert_0_3_gelu_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14554.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14554.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14554.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14554.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_3_fc1_6&#45;&gt;expert_0_3_gelu_6 -->
<g id="edge449" class="edge">
<title>expert_0_3_fc1_6&#45;&gt;expert_0_3_gelu_6</title>
<path fill="none" stroke="black" d="M14550.93,-10190.74C14551.36,-10182.02 14551.81,-10172.91 14552.25,-10164.2"/>
<polygon fill="black" stroke="black" points="14555.74,-10164.37 14552.75,-10154.21 14548.75,-10164.02 14555.74,-10164.37"/>
</g>
<!-- expert_0_3_gelu_7 -->
<g id="node371" class="node">
<title>expert_0_3_gelu_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14860.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14860.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14860.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14860.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_3_fc1_7&#45;&gt;expert_0_3_gelu_7 -->
<g id="edge452" class="edge">
<title>expert_0_3_fc1_7&#45;&gt;expert_0_3_gelu_7</title>
<path fill="none" stroke="black" d="M14866.65,-10190.74C14865.93,-10182.02 14865.17,-10172.91 14864.45,-10164.2"/>
<polygon fill="black" stroke="black" points="14867.93,-10163.88 14863.62,-10154.21 14860.96,-10164.46 14867.93,-10163.88"/>
</g>
<!-- expert_0_4_gelu_8 -->
<g id="node373" class="node">
<title>expert_0_4_gelu_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15383.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15383.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15383.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15383.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_4_fc1_8&#45;&gt;expert_0_4_gelu_8 -->
<g id="edge455" class="edge">
<title>expert_0_4_fc1_8&#45;&gt;expert_0_4_gelu_8</title>
<path fill="none" stroke="black" d="M15362.82,-10191.09C15365.34,-10182.15 15367.97,-10172.8 15370.49,-10163.88"/>
<polygon fill="black" stroke="black" points="15373.92,-10164.62 15373.26,-10154.04 15367.18,-10162.72 15373.92,-10164.62"/>
</g>
<!-- expert_0_4_gelu_9 -->
<g id="node376" class="node">
<title>expert_0_4_gelu_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15708.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15708.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15708.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15708.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_4_fc1_9&#45;&gt;expert_0_4_gelu_9 -->
<g id="edge458" class="edge">
<title>expert_0_4_fc1_9&#45;&gt;expert_0_4_gelu_9</title>
<path fill="none" stroke="black" d="M15715.87,-10190.74C15715,-10182.02 15714.09,-10172.91 15713.22,-10164.2"/>
<polygon fill="black" stroke="black" points="15716.7,-10163.81 15712.23,-10154.21 15709.74,-10164.51 15716.7,-10163.81"/>
</g>
<!-- expert_0_5_gelu_10 -->
<g id="node378" class="node">
<title>expert_0_5_gelu_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16185.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16185.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16185.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16185.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_5_fc1_10&#45;&gt;expert_0_5_gelu_10 -->
<g id="edge461" class="edge">
<title>expert_0_5_fc1_10&#45;&gt;expert_0_5_gelu_10</title>
<path fill="none" stroke="black" d="M16161.15,-10191.09C16164.15,-10182.06 16167.29,-10172.6 16170.27,-10163.6"/>
<polygon fill="black" stroke="black" points="16173.62,-10164.63 16173.44,-10154.04 16166.97,-10162.43 16173.62,-10164.63"/>
</g>
<!-- expert_0_5_gelu_11 -->
<g id="node381" class="node">
<title>expert_0_5_gelu_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16504.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16504.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16504.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16504.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_5_fc1_11&#45;&gt;expert_0_5_gelu_11 -->
<g id="edge464" class="edge">
<title>expert_0_5_fc1_11&#45;&gt;expert_0_5_gelu_11</title>
<path fill="none" stroke="black" d="M16504.57,-10190.74C16504.57,-10182.11 16504.57,-10173.11 16504.57,-10164.49"/>
<polygon fill="black" stroke="black" points="16508.07,-10164.21 16504.57,-10154.21 16501.07,-10164.21 16508.07,-10164.21"/>
</g>
<!-- expert_0_6_gelu_12 -->
<g id="node383" class="node">
<title>expert_0_6_gelu_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17001.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17001.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="17001.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17001.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_6_fc1_12&#45;&gt;expert_0_6_gelu_12 -->
<g id="edge467" class="edge">
<title>expert_0_6_fc1_12&#45;&gt;expert_0_6_gelu_12</title>
<path fill="none" stroke="black" d="M16963.98,-10191.78C16968.82,-10182.22 16973.91,-10172.15 16978.73,-10162.63"/>
<polygon fill="black" stroke="black" points="16981.85,-10164.2 16983.25,-10153.7 16975.61,-10161.04 16981.85,-10164.2"/>
</g>
<!-- expert_0_6_gelu_13 -->
<g id="node386" class="node">
<title>expert_0_6_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17326.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17326.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="17326.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17326.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_6_fc1_13&#45;&gt;expert_0_6_gelu_13 -->
<g id="edge470" class="edge">
<title>expert_0_6_fc1_13&#45;&gt;expert_0_6_gelu_13</title>
<path fill="none" stroke="black" d="M17319.28,-10190.74C17320.15,-10182.02 17321.06,-10172.91 17321.92,-10164.2"/>
<polygon fill="black" stroke="black" points="17325.41,-10164.51 17322.92,-10154.21 17318.44,-10163.81 17325.41,-10164.51"/>
</g>
<!-- expert_0_7_gelu_14 -->
<g id="node388" class="node">
<title>expert_0_7_gelu_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18234.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="18234.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="18234.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18234.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_7_fc1_14&#45;&gt;expert_0_7_gelu_14 -->
<g id="edge473" class="edge">
<title>expert_0_7_fc1_14&#45;&gt;expert_0_7_gelu_14</title>
<path fill="none" stroke="black" d="M18104.91,-10198.9C18126.95,-10185.06 18151.7,-10169.52 18173.62,-10155.75"/>
<polygon fill="black" stroke="black" points="18175.58,-10158.65 18182.19,-10150.37 18171.86,-10152.72 18175.58,-10158.65"/>
</g>
<!-- expert_0_7_gelu_15 -->
<g id="node391" class="node">
<title>expert_0_7_gelu_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18491.57" cy="-10116.47" rx="119" ry="37.5"/>
<text text-anchor="middle" x="18491.57" y="-10127.77" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="18491.57" y="-10112.77" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18491.57" y="-10097.77" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_0_7_fc1_15&#45;&gt;expert_0_7_gelu_15 -->
<g id="edge476" class="edge">
<title>expert_0_7_fc1_15&#45;&gt;expert_0_7_gelu_15</title>
<path fill="none" stroke="black" d="M18372.18,-10197.9C18392.11,-10184.47 18414.28,-10169.54 18434.05,-10156.22"/>
<polygon fill="black" stroke="black" points="18436.03,-10159.11 18442.36,-10150.62 18432.12,-10153.3 18436.03,-10159.11"/>
</g>
<!-- expert_0_0_fc2_0 -->
<g id="node354" class="node">
<title>expert_0_0_fc2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11897.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11897.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11897.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11897.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11897.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_0_gelu_0&#45;&gt;expert_0_0_fc2_0 -->
<g id="edge432" class="edge">
<title>expert_0_0_gelu_0&#45;&gt;expert_0_0_fc2_0</title>
<path fill="none" stroke="black" d="M11906.64,-10078.96C11905.73,-10070.5 11904.73,-10061.3 11903.75,-10052.18"/>
<polygon fill="black" stroke="black" points="11907.2,-10051.54 11902.65,-10041.98 11900.24,-10052.3 11907.2,-10051.54"/>
</g>
<!-- allreduce_expert_0_0 -->
<g id="node355" class="node">
<title>allreduce_expert_0_0</title>
<polygon fill="red" stroke="black" points="11894.57,-9908.8 11739.57,-9855.8 11894.57,-9802.8 12049.57,-9855.8 11894.57,-9908.8"/>
<text text-anchor="middle" x="11894.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 0</text>
<text text-anchor="middle" x="11894.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11894.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 0&#45;1</text>
</g>
<!-- expert_0_0_fc2_0&#45;&gt;allreduce_expert_0_0 -->
<g id="edge433" class="edge">
<title>expert_0_0_fc2_0&#45;&gt;allreduce_expert_0_0</title>
<path fill="none" stroke="black" d="M11896.53,-9945.67C11896.34,-9936.97 11896.14,-9927.77 11895.94,-9918.71"/>
<polygon fill="black" stroke="black" points="11899.43,-9918.5 11895.71,-9908.58 11892.44,-9918.66 11899.43,-9918.5"/>
</g>
<!-- combine_experts_0_0 -->
<g id="node393" class="node">
<title>combine_experts_0_0</title>
<polygon fill="purple" stroke="black" points="11373.57,-9765.8 11126.57,-9712.8 11373.57,-9659.8 11620.57,-9712.8 11373.57,-9765.8"/>
<text text-anchor="middle" x="11373.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11373.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11373.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_0&#45;&gt;combine_experts_0_0 -->
<g id="edge479" class="edge">
<title>allreduce_expert_0_0&#45;&gt;combine_experts_0_0</title>
<path fill="none" stroke="black" d="M11809.42,-9831.76C11722.67,-9808.28 11587.5,-9771.7 11490.69,-9745.5"/>
<polygon fill="black" stroke="black" points="11491.43,-9742.07 11480.86,-9742.84 11489.6,-9748.83 11491.43,-9742.07"/>
</g>
<!-- combine_experts_0_1 -->
<g id="node394" class="node">
<title>combine_experts_0_1</title>
<polygon fill="purple" stroke="black" points="11885.57,-9765.8 11638.57,-9712.8 11885.57,-9659.8 12132.57,-9712.8 11885.57,-9765.8"/>
<text text-anchor="middle" x="11885.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11885.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11885.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_0&#45;&gt;combine_experts_0_1 -->
<g id="edge480" class="edge">
<title>allreduce_expert_0_0&#45;&gt;combine_experts_0_1</title>
<path fill="none" stroke="black" d="M11891.32,-9803.9C11890.73,-9794.63 11890.11,-9784.87 11889.5,-9775.33"/>
<polygon fill="black" stroke="black" points="11892.98,-9774.86 11888.85,-9765.11 11885.99,-9775.31 11892.98,-9774.86"/>
</g>
<!-- expert_0_0_fc2_1 -->
<g id="node357" class="node">
<title>expert_0_0_fc2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12164.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12164.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="12164.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12164.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12164.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_0_gelu_1&#45;&gt;expert_0_0_fc2_1 -->
<g id="edge435" class="edge">
<title>expert_0_0_gelu_1&#45;&gt;expert_0_0_fc2_1</title>
<path fill="none" stroke="black" d="M12266.6,-10080.92C12252.82,-10069.3 12237.18,-10056.12 12222.37,-10043.62"/>
<polygon fill="black" stroke="black" points="12224.61,-10040.93 12214.7,-10037.16 12220.09,-10046.28 12224.61,-10040.93"/>
</g>
<!-- expert_0_0_fc2_1&#45;&gt;allreduce_expert_0_0 -->
<g id="edge436" class="edge">
<title>expert_0_0_fc2_1&#45;&gt;allreduce_expert_0_0</title>
<path fill="none" stroke="black" d="M12092.93,-9956.78C12053.59,-9936.95 12004.96,-9912.44 11965.71,-9892.66"/>
<polygon fill="black" stroke="black" points="11966.96,-9889.37 11956.45,-9887.99 11963.81,-9895.62 11966.96,-9889.37"/>
</g>
<!-- expert_0_1_fc2_2 -->
<g id="node359" class="node">
<title>expert_0_1_fc2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12940.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12940.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="12940.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12940.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12940.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_1_gelu_2&#45;&gt;expert_0_1_fc2_2 -->
<g id="edge438" class="edge">
<title>expert_0_1_gelu_2&#45;&gt;expert_0_1_fc2_2</title>
<path fill="none" stroke="black" d="M12951.03,-10078.96C12949.98,-10070.5 12948.83,-10061.3 12947.7,-10052.18"/>
<polygon fill="black" stroke="black" points="12951.14,-10051.47 12946.43,-10041.98 12944.19,-10052.33 12951.14,-10051.47"/>
</g>
<!-- allreduce_expert_0_1 -->
<g id="node360" class="node">
<title>allreduce_expert_0_1</title>
<polygon fill="red" stroke="black" points="12916.57,-9908.8 12761.57,-9855.8 12916.57,-9802.8 13071.57,-9855.8 12916.57,-9908.8"/>
<text text-anchor="middle" x="12916.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 1</text>
<text text-anchor="middle" x="12916.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="12916.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 2&#45;3</text>
</g>
<!-- expert_0_1_fc2_2&#45;&gt;allreduce_expert_0_1 -->
<g id="edge439" class="edge">
<title>expert_0_1_fc2_2&#45;&gt;allreduce_expert_0_1</title>
<path fill="none" stroke="black" d="M12932.25,-9945.67C12930.58,-9936.22 12928.81,-9926.16 12927.08,-9916.35"/>
<polygon fill="black" stroke="black" points="12930.48,-9915.49 12925.29,-9906.25 12923.58,-9916.7 12930.48,-9915.49"/>
</g>
<!-- combine_experts_0_2 -->
<g id="node395" class="node">
<title>combine_experts_0_2</title>
<polygon fill="purple" stroke="black" points="12397.57,-9765.8 12150.57,-9712.8 12397.57,-9659.8 12644.57,-9712.8 12397.57,-9765.8"/>
<text text-anchor="middle" x="12397.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12397.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12397.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_1&#45;&gt;combine_experts_0_2 -->
<g id="edge481" class="edge">
<title>allreduce_expert_0_1&#45;&gt;combine_experts_0_2</title>
<path fill="none" stroke="black" d="M12831.74,-9831.76C12745.47,-9808.32 12611.11,-9771.82 12514.71,-9745.63"/>
<polygon fill="black" stroke="black" points="12515.48,-9742.21 12504.92,-9742.97 12513.65,-9748.97 12515.48,-9742.21"/>
</g>
<!-- combine_experts_0_3 -->
<g id="node396" class="node">
<title>combine_experts_0_3</title>
<polygon fill="purple" stroke="black" points="12909.57,-9765.8 12662.57,-9712.8 12909.57,-9659.8 13156.57,-9712.8 12909.57,-9765.8"/>
<text text-anchor="middle" x="12909.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12909.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12909.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_1&#45;&gt;combine_experts_0_3 -->
<g id="edge482" class="edge">
<title>allreduce_expert_0_1&#45;&gt;combine_experts_0_3</title>
<path fill="none" stroke="black" d="M12914.03,-9803.5C12913.57,-9794.36 12913.1,-9784.76 12912.63,-9775.38"/>
<polygon fill="black" stroke="black" points="12916.12,-9775.12 12912.13,-9765.31 12909.13,-9775.47 12916.12,-9775.12"/>
</g>
<!-- expert_0_1_fc2_3 -->
<g id="node362" class="node">
<title>expert_0_1_fc2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13187.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13187.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="13187.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13187.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13187.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_1_gelu_3&#45;&gt;expert_0_1_fc2_3 -->
<g id="edge441" class="edge">
<title>expert_0_1_gelu_3&#45;&gt;expert_0_1_fc2_3</title>
<path fill="none" stroke="black" d="M13254.58,-10079.94C13246.57,-10069.77 13237.66,-10058.46 13229.01,-10047.49"/>
<polygon fill="black" stroke="black" points="13231.73,-10045.27 13222.79,-10039.58 13226.23,-10049.61 13231.73,-10045.27"/>
</g>
<!-- expert_0_1_fc2_3&#45;&gt;allreduce_expert_0_1 -->
<g id="edge442" class="edge">
<title>expert_0_1_fc2_3&#45;&gt;allreduce_expert_0_1</title>
<path fill="none" stroke="black" d="M13115.66,-9956.78C13076.03,-9936.88 13027.01,-9912.26 12987.53,-9892.44"/>
<polygon fill="black" stroke="black" points="12988.74,-9889.13 12978.23,-9887.77 12985.6,-9895.38 12988.74,-9889.13"/>
</g>
<!-- expert_0_2_fc2_4 -->
<g id="node364" class="node">
<title>expert_0_2_fc2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13808.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13808.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13808.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13808.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13808.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_2_gelu_4&#45;&gt;expert_0_2_fc2_4 -->
<g id="edge444" class="edge">
<title>expert_0_2_gelu_4&#45;&gt;expert_0_2_fc2_4</title>
<path fill="none" stroke="black" d="M13781.38,-10078.96C13784.21,-10070.22 13787.3,-10060.68 13790.34,-10051.26"/>
<polygon fill="black" stroke="black" points="13793.74,-10052.13 13793.49,-10041.54 13787.08,-10049.98 13793.74,-10052.13"/>
</g>
<!-- allreduce_expert_0_2 -->
<g id="node365" class="node">
<title>allreduce_expert_0_2</title>
<polygon fill="red" stroke="black" points="13824.57,-9908.8 13669.57,-9855.8 13824.57,-9802.8 13979.57,-9855.8 13824.57,-9908.8"/>
<text text-anchor="middle" x="13824.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 2</text>
<text text-anchor="middle" x="13824.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13824.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 4&#45;5</text>
</g>
<!-- expert_0_2_fc2_4&#45;&gt;allreduce_expert_0_2 -->
<g id="edge445" class="edge">
<title>expert_0_2_fc2_4&#45;&gt;allreduce_expert_0_2</title>
<path fill="none" stroke="black" d="M13814.12,-9945.67C13815.2,-9936.54 13816.34,-9926.85 13817.45,-9917.36"/>
<polygon fill="black" stroke="black" points="13820.96,-9917.52 13818.65,-9907.18 13814.01,-9916.7 13820.96,-9917.52"/>
</g>
<!-- combine_experts_0_4 -->
<g id="node397" class="node">
<title>combine_experts_0_4</title>
<polygon fill="purple" stroke="black" points="13421.57,-9765.8 13174.57,-9712.8 13421.57,-9659.8 13668.57,-9712.8 13421.57,-9765.8"/>
<text text-anchor="middle" x="13421.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13421.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13421.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_2&#45;&gt;combine_experts_0_4 -->
<g id="edge483" class="edge">
<title>allreduce_expert_0_2&#45;&gt;combine_experts_0_4</title>
<path fill="none" stroke="black" d="M13749.24,-9828.45C13685.6,-9806.18 13593.86,-9774.08 13523.63,-9749.51"/>
<polygon fill="black" stroke="black" points="13524.46,-9746.09 13513.87,-9746.1 13522.15,-9752.7 13524.46,-9746.09"/>
</g>
<!-- combine_experts_0_5 -->
<g id="node398" class="node">
<title>combine_experts_0_5</title>
<polygon fill="purple" stroke="black" points="13933.57,-9765.8 13686.57,-9712.8 13933.57,-9659.8 14180.57,-9712.8 13933.57,-9765.8"/>
<text text-anchor="middle" x="13933.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13933.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13933.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_2&#45;&gt;combine_experts_0_5 -->
<g id="edge484" class="edge">
<title>allreduce_expert_0_2&#45;&gt;combine_experts_0_5</title>
<path fill="none" stroke="black" d="M13856.39,-9813.64C13867.74,-9798.97 13880.68,-9782.23 13892.68,-9766.71"/>
<polygon fill="black" stroke="black" points="13895.51,-9768.77 13898.85,-9758.72 13889.97,-9764.49 13895.51,-9768.77"/>
</g>
<!-- expert_0_2_fc2_5 -->
<g id="node367" class="node">
<title>expert_0_2_fc2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14052.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14052.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="14052.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14052.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14052.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_2_gelu_5&#45;&gt;expert_0_2_fc2_5 -->
<g id="edge447" class="edge">
<title>expert_0_2_gelu_5&#45;&gt;expert_0_2_fc2_5</title>
<path fill="none" stroke="black" d="M14105.27,-10079.62C14099.34,-10070.07 14092.79,-10059.54 14086.38,-10049.25"/>
<polygon fill="black" stroke="black" points="14089.31,-10047.32 14081.05,-10040.68 14083.36,-10051.02 14089.31,-10047.32"/>
</g>
<!-- expert_0_2_fc2_5&#45;&gt;allreduce_expert_0_2 -->
<g id="edge448" class="edge">
<title>expert_0_2_fc2_5&#45;&gt;allreduce_expert_0_2</title>
<path fill="none" stroke="black" d="M13988.15,-9954.44C13957.23,-9935.98 13920.26,-9913.92 13889.3,-9895.44"/>
<polygon fill="black" stroke="black" points="13890.7,-9892.2 13880.32,-9890.08 13887.11,-9898.21 13890.7,-9892.2"/>
</g>
<!-- expert_0_3_fc2_6 -->
<g id="node369" class="node">
<title>expert_0_3_fc2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14575.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14575.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14575.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14575.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14575.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_3_gelu_6&#45;&gt;expert_0_3_fc2_6 -->
<g id="edge450" class="edge">
<title>expert_0_3_gelu_6&#45;&gt;expert_0_3_fc2_6</title>
<path fill="none" stroke="black" d="M14560.93,-10078.96C14562.42,-10070.41 14564.04,-10061.1 14565.65,-10051.89"/>
<polygon fill="black" stroke="black" points="14569.1,-10052.43 14567.37,-10041.98 14562.21,-10051.23 14569.1,-10052.43"/>
</g>
<!-- allreduce_expert_0_3 -->
<g id="node370" class="node">
<title>allreduce_expert_0_3</title>
<polygon fill="red" stroke="black" points="14698.57,-9908.8 14543.57,-9855.8 14698.57,-9802.8 14853.57,-9855.8 14698.57,-9908.8"/>
<text text-anchor="middle" x="14698.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 3</text>
<text text-anchor="middle" x="14698.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="14698.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 6&#45;7</text>
</g>
<!-- expert_0_3_fc2_6&#45;&gt;allreduce_expert_0_3 -->
<g id="edge451" class="edge">
<title>expert_0_3_fc2_6&#45;&gt;allreduce_expert_0_3</title>
<path fill="none" stroke="black" d="M14615.51,-9948.71C14628.41,-9934.43 14642.76,-9918.55 14655.86,-9904.06"/>
<polygon fill="black" stroke="black" points="14658.47,-9906.39 14662.58,-9896.63 14653.28,-9901.7 14658.47,-9906.39"/>
</g>
<!-- combine_experts_0_6 -->
<g id="node399" class="node">
<title>combine_experts_0_6</title>
<polygon fill="purple" stroke="black" points="14445.57,-9765.8 14198.57,-9712.8 14445.57,-9659.8 14692.57,-9712.8 14445.57,-9765.8"/>
<text text-anchor="middle" x="14445.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14445.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14445.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_3&#45;&gt;combine_experts_0_6 -->
<g id="edge485" class="edge">
<title>allreduce_expert_0_3&#45;&gt;combine_experts_0_6</title>
<path fill="none" stroke="black" d="M14640.53,-9822.46C14605.41,-9802.89 14560.23,-9777.7 14522.2,-9756.51"/>
<polygon fill="black" stroke="black" points="14523.64,-9753.31 14513.2,-9751.49 14520.23,-9759.42 14523.64,-9753.31"/>
</g>
<!-- combine_experts_0_7 -->
<g id="node400" class="node">
<title>combine_experts_0_7</title>
<polygon fill="purple" stroke="black" points="14957.57,-9765.8 14710.57,-9712.8 14957.57,-9659.8 15204.57,-9712.8 14957.57,-9765.8"/>
<text text-anchor="middle" x="14957.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14957.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14957.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_3&#45;&gt;combine_experts_0_7 -->
<g id="edge486" class="edge">
<title>allreduce_expert_0_3&#45;&gt;combine_experts_0_7</title>
<path fill="none" stroke="black" d="M14757.34,-9822.81C14793.7,-9803.02 14840.78,-9777.39 14880.15,-9755.95"/>
<polygon fill="black" stroke="black" points="14881.84,-9759.02 14888.95,-9751.16 14878.49,-9752.87 14881.84,-9759.02"/>
</g>
<!-- expert_0_3_fc2_7 -->
<g id="node372" class="node">
<title>expert_0_3_fc2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14819.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14819.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14819.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14819.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14819.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_3_gelu_7&#45;&gt;expert_0_3_fc2_7 -->
<g id="edge453" class="edge">
<title>expert_0_3_gelu_7&#45;&gt;expert_0_3_fc2_7</title>
<path fill="none" stroke="black" d="M14848.16,-10078.96C14845.19,-10070.22 14841.94,-10060.68 14838.74,-10051.26"/>
<polygon fill="black" stroke="black" points="14841.97,-10049.88 14835.44,-10041.54 14835.34,-10052.13 14841.97,-10049.88"/>
</g>
<!-- expert_0_3_fc2_7&#45;&gt;allreduce_expert_0_3 -->
<g id="edge454" class="edge">
<title>expert_0_3_fc2_7&#45;&gt;allreduce_expert_0_3</title>
<path fill="none" stroke="black" d="M14780.29,-9948.71C14767.83,-9934.69 14753.99,-9919.13 14741.3,-9904.86"/>
<polygon fill="black" stroke="black" points="14743.65,-9902.23 14734.39,-9897.08 14738.42,-9906.88 14743.65,-9902.23"/>
</g>
<!-- expert_0_4_fc2_8 -->
<g id="node374" class="node">
<title>expert_0_4_fc2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15444.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15444.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15444.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15444.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15444.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_4_gelu_8&#45;&gt;expert_0_4_fc2_8 -->
<g id="edge456" class="edge">
<title>expert_0_4_gelu_8&#45;&gt;expert_0_4_fc2_8</title>
<path fill="none" stroke="black" d="M15401.88,-10079.29C15406.5,-10070.16 15411.57,-10060.14 15416.55,-10050.29"/>
<polygon fill="black" stroke="black" points="15419.69,-10051.83 15421.08,-10041.33 15413.44,-10048.67 15419.69,-10051.83"/>
</g>
<!-- allreduce_expert_0_4 -->
<g id="node375" class="node">
<title>allreduce_expert_0_4</title>
<polygon fill="red" stroke="black" points="15482.57,-9908.8 15327.57,-9855.8 15482.57,-9802.8 15637.57,-9855.8 15482.57,-9908.8"/>
<text text-anchor="middle" x="15482.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 4</text>
<text text-anchor="middle" x="15482.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="15482.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 8&#45;9</text>
</g>
<!-- expert_0_4_fc2_8&#45;&gt;allreduce_expert_0_4 -->
<g id="edge457" class="edge">
<title>expert_0_4_fc2_8&#45;&gt;allreduce_expert_0_4</title>
<path fill="none" stroke="black" d="M15457.65,-9946.06C15460.48,-9935.92 15463.51,-9925.08 15466.44,-9914.58"/>
<polygon fill="black" stroke="black" points="15469.9,-9915.22 15469.21,-9904.65 15463.15,-9913.34 15469.9,-9915.22"/>
</g>
<!-- combine_experts_0_8 -->
<g id="node401" class="node">
<title>combine_experts_0_8</title>
<polygon fill="purple" stroke="black" points="15469.57,-9765.8 15222.57,-9712.8 15469.57,-9659.8 15716.57,-9712.8 15469.57,-9765.8"/>
<text text-anchor="middle" x="15469.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15469.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15469.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_4&#45;&gt;combine_experts_0_8 -->
<g id="edge487" class="edge">
<title>allreduce_expert_0_4&#45;&gt;combine_experts_0_8</title>
<path fill="none" stroke="black" d="M15477.92,-9804.3C15477.04,-9794.8 15476.12,-9784.77 15475.21,-9774.98"/>
<polygon fill="black" stroke="black" points="15478.69,-9774.54 15474.28,-9764.91 15471.72,-9775.19 15478.69,-9774.54"/>
</g>
<!-- combine_experts_0_9 -->
<g id="node402" class="node">
<title>combine_experts_0_9</title>
<polygon fill="purple" stroke="black" points="15981.57,-9765.8 15734.57,-9712.8 15981.57,-9659.8 16228.57,-9712.8 15981.57,-9765.8"/>
<text text-anchor="middle" x="15981.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15981.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15981.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_4&#45;&gt;combine_experts_0_9 -->
<g id="edge488" class="edge">
<title>allreduce_expert_0_4&#45;&gt;combine_experts_0_9</title>
<path fill="none" stroke="black" d="M15566.09,-9831.2C15648.54,-9807.91 15775.25,-9772.1 15867.06,-9746.16"/>
<polygon fill="black" stroke="black" points="15868.29,-9749.45 15876.96,-9743.37 15866.38,-9742.72 15868.29,-9749.45"/>
</g>
<!-- expert_0_4_fc2_9 -->
<g id="node377" class="node">
<title>expert_0_4_fc2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15689.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15689.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15689.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15689.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15689.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_4_gelu_9&#45;&gt;expert_0_4_fc2_9 -->
<g id="edge459" class="edge">
<title>expert_0_4_gelu_9&#45;&gt;expert_0_4_fc2_9</title>
<path fill="none" stroke="black" d="M15702.82,-10078.96C15701.47,-10070.41 15700.01,-10061.1 15698.56,-10051.89"/>
<polygon fill="black" stroke="black" points="15702.01,-10051.31 15696.99,-10041.98 15695.09,-10052.4 15702.01,-10051.31"/>
</g>
<!-- expert_0_4_fc2_9&#45;&gt;allreduce_expert_0_4 -->
<g id="edge460" class="edge">
<title>expert_0_4_fc2_9&#45;&gt;allreduce_expert_0_4</title>
<path fill="none" stroke="black" d="M15629.14,-9953.16C15602.12,-9935.39 15570.32,-9914.49 15543.26,-9896.7"/>
<polygon fill="black" stroke="black" points="15544.93,-9893.61 15534.65,-9891.04 15541.09,-9899.46 15544.93,-9893.61"/>
</g>
<!-- expert_0_5_fc2_10 -->
<g id="node379" class="node">
<title>expert_0_5_fc2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16224.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16224.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16224.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16224.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16224.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_5_gelu_10&#45;&gt;expert_0_5_fc2_10 -->
<g id="edge462" class="edge">
<title>expert_0_5_gelu_10&#45;&gt;expert_0_5_fc2_10</title>
<path fill="none" stroke="black" d="M16197.38,-10078.96C16200.21,-10070.22 16203.3,-10060.68 16206.34,-10051.26"/>
<polygon fill="black" stroke="black" points="16209.74,-10052.13 16209.49,-10041.54 16203.08,-10049.98 16209.74,-10052.13"/>
</g>
<!-- allreduce_expert_0_5 -->
<g id="node380" class="node">
<title>allreduce_expert_0_5</title>
<polygon fill="red" stroke="black" points="16494.57,-9908.8 16339.57,-9855.8 16494.57,-9802.8 16649.57,-9855.8 16494.57,-9908.8"/>
<text text-anchor="middle" x="16494.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 5</text>
<text text-anchor="middle" x="16494.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="16494.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 10&#45;11</text>
</g>
<!-- expert_0_5_fc2_10&#45;&gt;allreduce_expert_0_5 -->
<g id="edge463" class="edge">
<title>expert_0_5_fc2_10&#45;&gt;allreduce_expert_0_5</title>
<path fill="none" stroke="black" d="M16296.22,-9956.78C16335.56,-9936.95 16384.18,-9912.44 16423.44,-9892.66"/>
<polygon fill="black" stroke="black" points="16425.34,-9895.62 16432.69,-9887.99 16422.19,-9889.37 16425.34,-9895.62"/>
</g>
<!-- combine_experts_0_10 -->
<g id="node403" class="node">
<title>combine_experts_0_10</title>
<polygon fill="purple" stroke="black" points="16493.57,-9765.8 16246.57,-9712.8 16493.57,-9659.8 16740.57,-9712.8 16493.57,-9765.8"/>
<text text-anchor="middle" x="16493.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16493.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16493.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_5&#45;&gt;combine_experts_0_10 -->
<g id="edge489" class="edge">
<title>allreduce_expert_0_5&#45;&gt;combine_experts_0_10</title>
<path fill="none" stroke="black" d="M16494.2,-9802.7C16494.14,-9794.13 16494.08,-9785.17 16494.02,-9776.38"/>
<polygon fill="black" stroke="black" points="16497.52,-9776.14 16493.94,-9766.16 16490.52,-9776.19 16497.52,-9776.14"/>
</g>
<!-- combine_experts_0_11 -->
<g id="node404" class="node">
<title>combine_experts_0_11</title>
<polygon fill="purple" stroke="black" points="17005.57,-9765.8 16758.57,-9712.8 17005.57,-9659.8 17252.57,-9712.8 17005.57,-9765.8"/>
<text text-anchor="middle" x="17005.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17005.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17005.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_5&#45;&gt;combine_experts_0_11 -->
<g id="edge490" class="edge">
<title>allreduce_expert_0_5&#45;&gt;combine_experts_0_11</title>
<path fill="none" stroke="black" d="M16578.95,-9831.52C16663.69,-9808.14 16794.9,-9771.94 16889.44,-9745.85"/>
<polygon fill="black" stroke="black" points="16890.62,-9749.15 16899.33,-9743.12 16888.76,-9742.41 16890.62,-9749.15"/>
</g>
<!-- expert_0_5_fc2_11 -->
<g id="node382" class="node">
<title>expert_0_5_fc2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16501.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16501.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16501.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16501.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16501.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_5_gelu_11&#45;&gt;expert_0_5_fc2_11 -->
<g id="edge465" class="edge">
<title>expert_0_5_gelu_11&#45;&gt;expert_0_5_fc2_11</title>
<path fill="none" stroke="black" d="M16503.67,-10078.96C16503.45,-10070.5 16503.23,-10061.3 16503,-10052.18"/>
<polygon fill="black" stroke="black" points="16506.49,-10051.89 16502.75,-10041.98 16499.49,-10052.06 16506.49,-10051.89"/>
</g>
<!-- expert_0_5_fc2_11&#45;&gt;allreduce_expert_0_5 -->
<g id="edge466" class="edge">
<title>expert_0_5_fc2_11&#45;&gt;allreduce_expert_0_5</title>
<path fill="none" stroke="black" d="M16499.14,-9945.67C16498.69,-9936.86 16498.21,-9927.53 16497.74,-9918.36"/>
<polygon fill="black" stroke="black" points="16501.22,-9917.92 16497.21,-9908.11 16494.23,-9918.28 16501.22,-9917.92"/>
</g>
<!-- expert_0_6_fc2_12 -->
<g id="node384" class="node">
<title>expert_0_6_fc2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17058.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17058.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17058.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17058.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17058.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_6_gelu_12&#45;&gt;expert_0_6_fc2_12 -->
<g id="edge468" class="edge">
<title>expert_0_6_gelu_12&#45;&gt;expert_0_6_fc2_12</title>
<path fill="none" stroke="black" d="M17018.68,-10079.29C17022.95,-10070.25 17027.63,-10060.34 17032.24,-10050.59"/>
<polygon fill="black" stroke="black" points="17035.51,-10051.87 17036.62,-10041.33 17029.18,-10048.88 17035.51,-10051.87"/>
</g>
<!-- allreduce_expert_0_6 -->
<g id="node385" class="node">
<title>allreduce_expert_0_6</title>
<polygon fill="red" stroke="black" points="17408.57,-9908.8 17253.57,-9855.8 17408.57,-9802.8 17563.57,-9855.8 17408.57,-9908.8"/>
<text text-anchor="middle" x="17408.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 6</text>
<text text-anchor="middle" x="17408.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="17408.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 12&#45;13</text>
</g>
<!-- expert_0_6_fc2_12&#45;&gt;allreduce_expert_0_6 -->
<g id="edge469" class="edge">
<title>expert_0_6_fc2_12&#45;&gt;allreduce_expert_0_6</title>
<path fill="none" stroke="black" d="M17140.63,-9960.98C17197.07,-9939.04 17271.68,-9910.03 17327.84,-9888.2"/>
<polygon fill="black" stroke="black" points="17329.34,-9891.37 17337.39,-9884.48 17326.8,-9884.84 17329.34,-9891.37"/>
</g>
<!-- combine_experts_0_12 -->
<g id="node405" class="node">
<title>combine_experts_0_12</title>
<polygon fill="purple" stroke="black" points="17517.57,-9765.8 17270.57,-9712.8 17517.57,-9659.8 17764.57,-9712.8 17517.57,-9765.8"/>
<text text-anchor="middle" x="17517.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17517.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17517.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_6&#45;&gt;combine_experts_0_12 -->
<g id="edge491" class="edge">
<title>allreduce_expert_0_6&#45;&gt;combine_experts_0_12</title>
<path fill="none" stroke="black" d="M17440.39,-9813.64C17451.74,-9798.97 17464.68,-9782.23 17476.68,-9766.71"/>
<polygon fill="black" stroke="black" points="17479.51,-9768.77 17482.85,-9758.72 17473.97,-9764.49 17479.51,-9768.77"/>
</g>
<!-- combine_experts_0_13 -->
<g id="node406" class="node">
<title>combine_experts_0_13</title>
<polygon fill="purple" stroke="black" points="18029.57,-9765.8 17782.57,-9712.8 18029.57,-9659.8 18276.57,-9712.8 18029.57,-9765.8"/>
<text text-anchor="middle" x="18029.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18029.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18029.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_6&#45;&gt;combine_experts_0_13 -->
<g id="edge492" class="edge">
<title>allreduce_expert_0_6&#45;&gt;combine_experts_0_13</title>
<path fill="none" stroke="black" d="M17500.2,-9834C17606.45,-9809.88 17782.25,-9769.96 17901.86,-9742.8"/>
<polygon fill="black" stroke="black" points="17902.83,-9746.17 17911.81,-9740.54 17901.28,-9739.34 17902.83,-9746.17"/>
</g>
<!-- expert_0_6_fc2_13 -->
<g id="node387" class="node">
<title>expert_0_6_fc2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17352.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17352.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17352.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17352.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17352.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_6_gelu_13&#45;&gt;expert_0_6_fc2_13 -->
<g id="edge471" class="edge">
<title>expert_0_6_gelu_13&#45;&gt;expert_0_6_fc2_13</title>
<path fill="none" stroke="black" d="M17334.44,-10078.96C17336.29,-10070.41 17338.3,-10061.1 17340.28,-10051.89"/>
<polygon fill="black" stroke="black" points="17343.73,-10052.49 17342.42,-10041.98 17336.89,-10051.02 17343.73,-10052.49"/>
</g>
<!-- expert_0_6_fc2_13&#45;&gt;allreduce_expert_0_6 -->
<g id="edge472" class="edge">
<title>expert_0_6_fc2_13&#45;&gt;allreduce_expert_0_6</title>
<path fill="none" stroke="black" d="M17371.69,-9946.44C17376.24,-9935.37 17381.15,-9923.45 17385.85,-9912.03"/>
<polygon fill="black" stroke="black" points="17389.17,-9913.17 17389.73,-9902.59 17382.69,-9910.5 17389.17,-9913.17"/>
</g>
<!-- expert_0_7_fc2_14 -->
<g id="node389" class="node">
<title>expert_0_7_fc2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18243.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18243.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18243.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18243.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18243.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_7_gelu_14&#45;&gt;expert_0_7_fc2_14 -->
<g id="edge474" class="edge">
<title>expert_0_7_gelu_14&#45;&gt;expert_0_7_fc2_14</title>
<path fill="none" stroke="black" d="M18237.3,-10078.96C18237.93,-10070.5 18238.62,-10061.3 18239.3,-10052.18"/>
<polygon fill="black" stroke="black" points="18242.8,-10052.21 18240.06,-10041.98 18235.82,-10051.69 18242.8,-10052.21"/>
</g>
<!-- allreduce_expert_0_7 -->
<g id="node390" class="node">
<title>allreduce_expert_0_7</title>
<polygon fill="red" stroke="black" points="18510.57,-9908.8 18355.57,-9855.8 18510.57,-9802.8 18665.57,-9855.8 18510.57,-9908.8"/>
<text text-anchor="middle" x="18510.57" y="-9867.1" font-family="Times,serif" font-size="14.00">AllReduce Expert 7</text>
<text text-anchor="middle" x="18510.57" y="-9852.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="18510.57" y="-9837.1" font-family="Times,serif" font-size="14.00">GPUs 14&#45;15</text>
</g>
<!-- expert_0_7_fc2_14&#45;&gt;allreduce_expert_0_7 -->
<g id="edge475" class="edge">
<title>expert_0_7_fc2_14&#45;&gt;allreduce_expert_0_7</title>
<path fill="none" stroke="black" d="M18314.77,-9956.6C18353.53,-9936.84 18401.32,-9912.49 18439.98,-9892.78"/>
<polygon fill="black" stroke="black" points="18441.77,-9895.8 18449.1,-9888.14 18438.6,-9889.56 18441.77,-9895.8"/>
</g>
<!-- combine_experts_0_14 -->
<g id="node407" class="node">
<title>combine_experts_0_14</title>
<polygon fill="purple" stroke="black" points="18541.57,-9765.8 18294.57,-9712.8 18541.57,-9659.8 18788.57,-9712.8 18541.57,-9765.8"/>
<text text-anchor="middle" x="18541.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18541.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18541.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_7&#45;&gt;combine_experts_0_14 -->
<g id="edge493" class="edge">
<title>allreduce_expert_0_7&#45;&gt;combine_experts_0_14</title>
<path fill="none" stroke="black" d="M18521.24,-9806.28C18523.55,-9795.79 18526.01,-9784.58 18528.4,-9773.71"/>
<polygon fill="black" stroke="black" points="18531.84,-9774.38 18530.57,-9763.86 18525,-9772.87 18531.84,-9774.38"/>
</g>
<!-- combine_experts_0_15 -->
<g id="node408" class="node">
<title>combine_experts_0_15</title>
<polygon fill="purple" stroke="black" points="19053.57,-9765.8 18806.57,-9712.8 19053.57,-9659.8 19300.57,-9712.8 19053.57,-9765.8"/>
<text text-anchor="middle" x="19053.57" y="-9724.1" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="19053.57" y="-9709.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="19053.57" y="-9694.1" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_0_7&#45;&gt;combine_experts_0_15 -->
<g id="edge494" class="edge">
<title>allreduce_expert_0_7&#45;&gt;combine_experts_0_15</title>
<path fill="none" stroke="black" d="M18597.21,-9832.31C18688.29,-9808.66 18832.23,-9771.28 18934.07,-9744.83"/>
<polygon fill="black" stroke="black" points="18934.99,-9748.21 18943.79,-9742.31 18933.24,-9741.44 18934.99,-9748.21"/>
</g>
<!-- expert_0_7_fc2_15 -->
<g id="node392" class="node">
<title>expert_0_7_fc2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18494.57" cy="-9993.89" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18494.57" y="-10012.69" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18494.57" y="-9997.69" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18494.57" y="-9982.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18494.57" y="-9967.69" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_0_7_gelu_15&#45;&gt;expert_0_7_fc2_15 -->
<g id="edge477" class="edge">
<title>expert_0_7_gelu_15&#45;&gt;expert_0_7_fc2_15</title>
<path fill="none" stroke="black" d="M18492.48,-10078.96C18492.69,-10070.5 18492.92,-10061.3 18493.15,-10052.18"/>
<polygon fill="black" stroke="black" points="18496.65,-10052.06 18493.4,-10041.98 18489.65,-10051.89 18496.65,-10052.06"/>
</g>
<!-- expert_0_7_fc2_15&#45;&gt;allreduce_expert_0_7 -->
<g id="edge478" class="edge">
<title>expert_0_7_fc2_15&#45;&gt;allreduce_expert_0_7</title>
<path fill="none" stroke="black" d="M18500.12,-9945.67C18501.2,-9936.54 18502.34,-9926.85 18503.45,-9917.36"/>
<polygon fill="black" stroke="black" points="18506.96,-9917.52 18504.65,-9907.18 18500.01,-9916.7 18506.96,-9917.52"/>
</g>
<!-- allreduce_moe_0 -->
<g id="node409" class="node">
<title>allreduce_moe_0</title>
<polygon fill="red" stroke="black" points="15091.57,-9622.8 14966.57,-9569.8 15091.57,-9516.8 15216.57,-9569.8 15091.57,-9622.8"/>
<text text-anchor="middle" x="15091.57" y="-9581.1" font-family="Times,serif" font-size="14.00">AllReduce MoE</text>
<text text-anchor="middle" x="15091.57" y="-9566.1" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="15091.57" y="-9551.1" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- combine_experts_0_0&#45;&gt;allreduce_moe_0 -->
<g id="edge495" class="edge">
<title>combine_experts_0_0&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M11487.59,-9684.22C11531.67,-9674.72 11582.71,-9665.14 11629.57,-9659.8 11948.07,-9623.54 12030.13,-9649.12 12350.57,-9640.8 13359.09,-9614.64 14576.35,-9583.82 14965.53,-9573.99"/>
<polygon fill="black" stroke="black" points="14965.78,-9577.48 14975.69,-9573.73 14965.6,-9570.48 14965.78,-9577.48"/>
</g>
<!-- combine_experts_0_1&#45;&gt;allreduce_moe_0 -->
<g id="edge496" class="edge">
<title>combine_experts_0_1&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M11999.92,-9684.25C12043.93,-9674.78 12094.83,-9665.22 12141.57,-9659.8 12699.37,-9595.22 14464.45,-9575.99 14960.66,-9571.79"/>
<polygon fill="black" stroke="black" points="14960.76,-9575.29 14970.73,-9571.71 14960.7,-9568.29 14960.76,-9575.29"/>
</g>
<!-- combine_experts_0_2&#45;&gt;allreduce_moe_0 -->
<g id="edge497" class="edge">
<title>combine_experts_0_2&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M12512.25,-9684.34C12556.2,-9674.91 12606.96,-9665.35 12653.57,-9659.8 13107.12,-9605.83 14526.91,-9579.63 14962.92,-9572.72"/>
<polygon fill="black" stroke="black" points="14963.1,-9576.21 14973.04,-9572.56 14962.99,-9569.21 14963.1,-9576.21"/>
</g>
<!-- combine_experts_0_3&#45;&gt;allreduce_moe_0 -->
<g id="edge498" class="edge">
<title>combine_experts_0_3&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M13024.92,-9684.44C13068.72,-9675.09 13119.22,-9665.55 13165.57,-9659.8 13834.12,-9576.96 14641.82,-9569.37 14956.72,-9569.91"/>
<polygon fill="black" stroke="black" points="14956.79,-9573.41 14966.8,-9569.93 14956.81,-9566.41 14956.79,-9573.41"/>
</g>
<!-- combine_experts_0_4&#45;&gt;allreduce_moe_0 -->
<g id="edge499" class="edge">
<title>combine_experts_0_4&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M13537.93,-9684.65C13581.51,-9675.41 13631.6,-9665.89 13677.57,-9659.8 14148.67,-9597.43 14714.04,-9578.51 14963.09,-9572.98"/>
<polygon fill="black" stroke="black" points="14963.34,-9576.48 14973.26,-9572.76 14963.18,-9569.48 14963.34,-9576.48"/>
</g>
<!-- combine_experts_0_5&#45;&gt;allreduce_moe_0 -->
<g id="edge500" class="edge">
<title>combine_experts_0_5&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M14051.98,-9685.13C14095.12,-9676.11 14144.39,-9666.6 14189.57,-9659.8 14470.1,-9617.59 14802.86,-9590.69 14975.15,-9578.48"/>
<polygon fill="black" stroke="black" points="14975.53,-9581.96 14985.26,-9577.76 14975.04,-9574.98 14975.53,-9581.96"/>
</g>
<!-- combine_experts_0_6&#45;&gt;allreduce_moe_0 -->
<g id="edge501" class="edge">
<title>combine_experts_0_6&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M14565.95,-9685.53C14691.74,-9658.08 14886.31,-9615.61 15000.09,-9590.77"/>
<polygon fill="black" stroke="black" points="15001.14,-9594.12 15010.17,-9588.57 14999.65,-9587.29 15001.14,-9594.12"/>
</g>
<!-- combine_experts_0_7&#45;&gt;allreduce_moe_0 -->
<g id="edge502" class="edge">
<title>combine_experts_0_7&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M14998.87,-9668.35C15014.74,-9651.65 15032.88,-9632.56 15048.88,-9615.73"/>
<polygon fill="black" stroke="black" points="15051.71,-9617.83 15056.07,-9608.17 15046.64,-9613 15051.71,-9617.83"/>
</g>
<!-- combine_experts_0_8&#45;&gt;allreduce_moe_0 -->
<g id="edge503" class="edge">
<title>combine_experts_0_8&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M15380.95,-9678.75C15315.81,-9654.45 15228.25,-9621.79 15166.57,-9598.78"/>
<polygon fill="black" stroke="black" points="15167.49,-9595.39 15156.89,-9595.17 15165.04,-9601.94 15167.49,-9595.39"/>
</g>
<!-- combine_experts_0_9&#45;&gt;allreduce_moe_0 -->
<g id="edge504" class="edge">
<title>combine_experts_0_9&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M15860.75,-9685.69C15818.14,-9676.89 15769.83,-9667.4 15725.57,-9659.8 15540.39,-9628.03 15323.32,-9599.41 15197.22,-9583.63"/>
<polygon fill="black" stroke="black" points="15197.54,-9580.15 15187.18,-9582.38 15196.67,-9587.09 15197.54,-9580.15"/>
</g>
<!-- combine_experts_0_10&#45;&gt;allreduce_moe_0 -->
<g id="edge505" class="edge">
<title>combine_experts_0_10&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M16376.53,-9684.88C16333.09,-9675.72 16283.27,-9666.2 16237.57,-9659.8 15867.39,-9608.03 15425.41,-9584.38 15214.87,-9575.41"/>
<polygon fill="black" stroke="black" points="15214.85,-9571.9 15204.71,-9574.98 15214.56,-9578.9 15214.85,-9571.9"/>
</g>
<!-- combine_experts_0_11&#45;&gt;allreduce_moe_0 -->
<g id="edge506" class="edge">
<title>combine_experts_0_11&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M16889.88,-9684.56C16846.16,-9675.25 16795.8,-9665.71 16749.57,-9659.8 16185.03,-9587.71 15505.1,-9573.88 15223.55,-9571.33"/>
<polygon fill="black" stroke="black" points="15223.33,-9567.83 15213.3,-9571.24 15223.27,-9574.83 15223.33,-9567.83"/>
</g>
<!-- combine_experts_0_12&#45;&gt;allreduce_moe_0 -->
<g id="edge507" class="edge">
<title>combine_experts_0_12&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M17402.56,-9684.38C17358.69,-9674.99 17308.06,-9665.44 17261.57,-9659.8 16862.28,-9611.38 15621.36,-9581.85 15218.96,-9573.36"/>
<polygon fill="black" stroke="black" points="15218.81,-9569.86 15208.74,-9573.14 15218.66,-9576.85 15218.81,-9569.86"/>
</g>
<!-- combine_experts_0_13&#45;&gt;allreduce_moe_0 -->
<g id="edge508" class="edge">
<title>combine_experts_0_13&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M17915.22,-9684.32C17871.21,-9674.87 17820.31,-9665.29 17773.57,-9659.8 17270.48,-9600.78 15686.87,-9577.81 15221.43,-9572.24"/>
<polygon fill="black" stroke="black" points="15221.36,-9568.73 15211.31,-9572.11 15221.27,-9575.73 15221.36,-9568.73"/>
</g>
<!-- combine_experts_0_14&#45;&gt;allreduce_moe_0 -->
<g id="edge509" class="edge">
<title>combine_experts_0_14&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M18427.55,-9684.26C18383.47,-9674.76 18332.43,-9665.18 18285.57,-9659.8 17677.86,-9590.14 15746.83,-9574.45 15223.49,-9571.44"/>
<polygon fill="black" stroke="black" points="15223.27,-9567.94 15213.25,-9571.39 15223.23,-9574.94 15223.27,-9567.94"/>
</g>
<!-- combine_experts_0_15&#45;&gt;allreduce_moe_0 -->
<g id="edge510" class="edge">
<title>combine_experts_0_15&#45;&gt;allreduce_moe_0</title>
<path fill="none" stroke="black" d="M18939.56,-9684.24C18895.47,-9674.74 18844.43,-9665.16 18797.57,-9659.8 18488.36,-9624.47 18408.7,-9648.65 18097.57,-9640.8 16981.67,-9612.67 15632.65,-9582.7 15218.54,-9573.59"/>
<polygon fill="black" stroke="black" points="15218.41,-9570.08 15208.33,-9573.36 15218.25,-9577.08 15218.41,-9570.08"/>
</g>
<!-- residual2_0 -->
<g id="node410" class="node">
<title>residual2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="15091.57" cy="-9442.3" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="15091.57" y="-9453.6" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15091.57" y="-9438.6" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="15091.57" y="-9423.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_moe_0&#45;&gt;residual2_0 -->
<g id="edge511" class="edge">
<title>allreduce_moe_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M15091.57,-9516.67C15091.57,-9507.96 15091.57,-9498.96 15091.57,-9490.38"/>
<polygon fill="black" stroke="black" points="15095.07,-9490.18 15091.57,-9480.18 15088.07,-9490.18 15095.07,-9490.18"/>
</g>
<!-- ln1_1_0 -->
<g id="node411" class="node">
<title>ln1_1_0</title>
<ellipse fill="lightgreen" stroke="black" cx="11751.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11751.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11751.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11751.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_0 -->
<g id="edge512" class="edge">
<title>residual2_0&#45;&gt;ln1_1_0</title>
<path fill="none" stroke="black" d="M14936.63,-9438.66C14523.79,-9431.26 13362.9,-9408.24 12397.57,-9367.8 12229.12,-9360.75 12036.14,-9349.42 11905.3,-9341.25"/>
<polygon fill="black" stroke="black" points="11905.4,-9337.75 11895.2,-9340.62 11904.96,-9344.74 11905.4,-9337.75"/>
</g>
<!-- ln1_1_1 -->
<g id="node412" class="node">
<title>ln1_1_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12555.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12555.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12555.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12555.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_1 -->
<g id="edge513" class="edge">
<title>residual2_0&#45;&gt;ln1_1_1</title>
<path fill="none" stroke="black" d="M14936.46,-9438.94C14584.35,-9432.93 13697.77,-9414.12 12957.57,-9367.8 12872.9,-9362.51 12778.41,-9354.06 12702.32,-9346.62"/>
<polygon fill="black" stroke="black" points="12702.48,-9343.12 12692.18,-9345.63 12701.79,-9350.09 12702.48,-9343.12"/>
</g>
<!-- ln1_1_2 -->
<g id="node413" class="node">
<title>ln1_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="13115.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13115.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13115.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13115.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_2 -->
<g id="edge514" class="edge">
<title>residual2_0&#45;&gt;ln1_1_2</title>
<path fill="none" stroke="black" d="M14936.37,-9439.06C14637.58,-9433.74 13961.89,-9416.9 13395.57,-9367.8 13348.71,-9363.74 13297.64,-9357.6 13252.09,-9351.5"/>
<polygon fill="black" stroke="black" points="13252.54,-9348.03 13242.16,-9350.16 13251.6,-9354.97 13252.54,-9348.03"/>
</g>
<!-- ln1_1_3 -->
<g id="node414" class="node">
<title>ln1_1_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13553.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13553.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13553.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13553.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_3 -->
<g id="edge515" class="edge">
<title>residual2_0&#45;&gt;ln1_1_3</title>
<path fill="none" stroke="black" d="M14936.79,-9438.17C14689.9,-9431.93 14192,-9414.3 13772.57,-9367.8 13742.97,-9364.52 13711.29,-9359.9 13681.48,-9355.04"/>
<polygon fill="black" stroke="black" points="13681.88,-9351.56 13671.45,-9353.38 13680.74,-9358.46 13681.88,-9351.56"/>
</g>
<!-- ln1_1_4 -->
<g id="node415" class="node">
<title>ln1_1_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13930.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13930.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13930.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13930.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_4 -->
<g id="edge516" class="edge">
<title>residual2_0&#45;&gt;ln1_1_4</title>
<path fill="none" stroke="black" d="M14938.48,-9435.25C14746.33,-9426.39 14406.93,-9406.55 14118.57,-9367.8 14097.14,-9364.92 14074.47,-9361.15 14052.56,-9357.13"/>
<polygon fill="black" stroke="black" points="14053.03,-9353.65 14042.56,-9355.26 14051.75,-9360.53 14053.03,-9353.65"/>
</g>
<!-- ln1_1_5 -->
<g id="node416" class="node">
<title>ln1_1_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14276.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14276.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14276.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14276.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_5 -->
<g id="edge517" class="edge">
<title>residual2_0&#45;&gt;ln1_1_5</title>
<path fill="none" stroke="black" d="M14946.66,-9428.63C14816.19,-9416.3 14619.42,-9395.38 14449.57,-9367.8 14432.06,-9364.96 14413.64,-9361.54 14395.61,-9357.95"/>
<polygon fill="black" stroke="black" points="14396.14,-9354.49 14385.64,-9355.94 14394.75,-9361.35 14396.14,-9354.49"/>
</g>
<!-- ln1_1_6 -->
<g id="node417" class="node">
<title>ln1_1_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14607.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14607.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14607.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14607.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_6 -->
<g id="edge518" class="edge">
<title>residual2_0&#45;&gt;ln1_1_6</title>
<path fill="none" stroke="black" d="M14980.23,-9416C14904.21,-9398.72 14803.62,-9375.86 14726.11,-9358.24"/>
<polygon fill="black" stroke="black" points="14726.82,-9354.82 14716.29,-9356.01 14725.27,-9361.64 14726.82,-9354.82"/>
</g>
<!-- ln1_1_7 -->
<g id="node418" class="node">
<title>ln1_1_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14931.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14931.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14931.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14931.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_7 -->
<g id="edge519" class="edge">
<title>residual2_0&#45;&gt;ln1_1_7</title>
<path fill="none" stroke="black" d="M15041.39,-9406.8C15025.15,-9395.64 15007.01,-9383.17 14990.22,-9371.62"/>
<polygon fill="black" stroke="black" points="14991.8,-9368.47 14981.58,-9365.68 14987.84,-9374.23 14991.8,-9368.47"/>
</g>
<!-- ln1_1_8 -->
<g id="node419" class="node">
<title>ln1_1_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15251.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15251.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15251.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15251.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_8 -->
<g id="edge520" class="edge">
<title>residual2_0&#45;&gt;ln1_1_8</title>
<path fill="none" stroke="black" d="M15141.76,-9406.8C15157.99,-9395.64 15176.14,-9383.17 15192.93,-9371.62"/>
<polygon fill="black" stroke="black" points="15195.31,-9374.23 15201.57,-9365.68 15191.34,-9368.47 15195.31,-9374.23"/>
</g>
<!-- ln1_1_9 -->
<g id="node420" class="node">
<title>ln1_1_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15569.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15569.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15569.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15569.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_9 -->
<g id="edge521" class="edge">
<title>residual2_0&#45;&gt;ln1_1_9</title>
<path fill="none" stroke="black" d="M15202.14,-9415.86C15276.69,-9398.7 15374.96,-9376.09 15451.12,-9358.56"/>
<polygon fill="black" stroke="black" points="15452.27,-9361.89 15461.24,-9356.24 15450.71,-9355.07 15452.27,-9361.89"/>
</g>
<!-- ln1_1_10 -->
<g id="node421" class="node">
<title>ln1_1_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15886.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15886.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15886.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15886.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_10 -->
<g id="edge522" class="edge">
<title>residual2_0&#45;&gt;ln1_1_10</title>
<path fill="none" stroke="black" d="M15237.15,-9429.1C15366.49,-9417.16 15560.38,-9396.56 15727.57,-9367.8 15741.86,-9365.35 15756.79,-9362.41 15771.54,-9359.29"/>
<polygon fill="black" stroke="black" points="15772.67,-9362.63 15781.71,-9357.1 15771.19,-9355.78 15772.67,-9362.63"/>
</g>
<!-- ln1_1_11 -->
<g id="node422" class="node">
<title>ln1_1_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16202.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16202.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16202.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16202.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_11 -->
<g id="edge523" class="edge">
<title>residual2_0&#45;&gt;ln1_1_11</title>
<path fill="none" stroke="black" d="M15245.47,-9436.54C15434.55,-9429.05 15764.7,-9410.68 16044.57,-9367.8 16059.18,-9365.57 16074.45,-9362.71 16089.48,-9359.59"/>
<polygon fill="black" stroke="black" points="16090.26,-9363 16099.32,-9357.5 16088.81,-9356.15 16090.26,-9363"/>
</g>
<!-- ln1_1_12 -->
<g id="node423" class="node">
<title>ln1_1_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16518.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16518.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16518.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16518.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_12 -->
<g id="edge524" class="edge">
<title>residual2_0&#45;&gt;ln1_1_12</title>
<path fill="none" stroke="black" d="M15247.23,-9440.74C15487.38,-9437.97 15962.18,-9424.94 16360.57,-9367.8 16375.43,-9365.67 16390.96,-9362.85 16406.22,-9359.71"/>
<polygon fill="black" stroke="black" points="16407.15,-9363.09 16416.21,-9357.6 16405.7,-9356.24 16407.15,-9363.09"/>
</g>
<!-- ln1_1_13 -->
<g id="node424" class="node">
<title>ln1_1_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16834.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16834.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16834.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16834.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_13 -->
<g id="edge525" class="edge">
<title>residual2_0&#45;&gt;ln1_1_13</title>
<path fill="none" stroke="black" d="M15246.11,-9437.7C15588.75,-9429.12 16403.5,-9405.36 16676.57,-9367.8 16691.56,-9365.74 16707.21,-9362.94 16722.6,-9359.8"/>
<polygon fill="black" stroke="black" points="16723.59,-9363.16 16732.66,-9357.68 16722.15,-9356.31 16723.59,-9363.16"/>
</g>
<!-- ln1_1_14 -->
<g id="node425" class="node">
<title>ln1_1_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17150.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17150.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17150.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17150.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_14 -->
<g id="edge526" class="edge">
<title>residual2_0&#45;&gt;ln1_1_14</title>
<path fill="none" stroke="black" d="M15246.83,-9439.07C15638,-9432.84 16656.71,-9412.68 16992.57,-9367.8 17007.57,-9365.8 17023.23,-9363.03 17038.61,-9359.9"/>
<polygon fill="black" stroke="black" points="17039.6,-9363.27 17048.67,-9357.8 17038.17,-9356.42 17039.6,-9363.27"/>
</g>
<!-- ln1_1_15 -->
<g id="node426" class="node">
<title>ln1_1_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18804.57" cy="-9330.3" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18804.57" y="-9341.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18804.57" y="-9326.6" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18804.57" y="-9311.6" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1_15 -->
<g id="edge527" class="edge">
<title>residual2_0&#45;&gt;ln1_1_15</title>
<path fill="none" stroke="black" d="M15245.51,-9436.74C15847.36,-9418.91 18038.02,-9354.01 18646.72,-9335.98"/>
<polygon fill="black" stroke="black" points="18646.99,-9339.47 18656.88,-9335.68 18646.78,-9332.48 18646.99,-9339.47"/>
</g>
<!-- qkv_proj_1_0 -->
<g id="node427" class="node">
<title>qkv_proj_1_0</title>
<ellipse fill="orange" stroke="black" cx="9574.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9574.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9574.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9574.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="9574.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9574.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_0&#45;&gt;qkv_proj_1_0 -->
<g id="edge528" class="edge">
<title>ln1_1_0&#45;&gt;qkv_proj_1_0</title>
<path fill="none" stroke="black" d="M11606.45,-9321.57C11365.79,-9308.65 10868.93,-9281.53 10448.57,-9255.8 10194.9,-9240.28 9899.93,-9220.44 9725.71,-9208.53"/>
<polygon fill="black" stroke="black" points="9725.92,-9205.04 9715.7,-9207.85 9725.44,-9212.02 9725.92,-9205.04"/>
</g>
<!-- qkv_proj_1_1 -->
<g id="node428" class="node">
<title>qkv_proj_1_1</title>
<ellipse fill="orange" stroke="black" cx="10601.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10601.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10601.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10601.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="10601.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10601.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_1&#45;&gt;qkv_proj_1_1 -->
<g id="edge529" class="edge">
<title>ln1_1_1&#45;&gt;qkv_proj_1_1</title>
<path fill="none" stroke="black" d="M12412.29,-9319.68C12053.73,-9295.61 11120.24,-9232.94 10753.07,-9208.29"/>
<polygon fill="black" stroke="black" points="10753.12,-9204.78 10742.91,-9207.6 10752.65,-9211.77 10753.12,-9204.78"/>
</g>
<!-- qkv_proj_1_2 -->
<g id="node429" class="node">
<title>qkv_proj_1_2</title>
<ellipse fill="orange" stroke="black" cx="11700.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11700.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11700.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11700.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="11700.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11700.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_2&#45;&gt;qkv_proj_1_2 -->
<g id="edge530" class="edge">
<title>ln1_1_2&#45;&gt;qkv_proj_1_2</title>
<path fill="none" stroke="black" d="M12977,-9316.46C12709.87,-9291.69 12125.76,-9237.54 11850.17,-9211.98"/>
<polygon fill="black" stroke="black" points="11850.37,-9208.49 11840.09,-9211.05 11849.73,-9215.46 11850.37,-9208.49"/>
</g>
<!-- qkv_proj_1_3 -->
<g id="node430" class="node">
<title>qkv_proj_1_3</title>
<ellipse fill="orange" stroke="black" cx="12621.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12621.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12621.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12621.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="12621.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12621.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_3&#45;&gt;qkv_proj_1_3 -->
<g id="edge531" class="edge">
<title>ln1_1_3&#45;&gt;qkv_proj_1_3</title>
<path fill="none" stroke="black" d="M13424.96,-9311.2C13252.57,-9286.93 12947.41,-9243.98 12766.89,-9218.57"/>
<polygon fill="black" stroke="black" points="12767.18,-9215.08 12756.79,-9217.15 12766.21,-9222.01 12767.18,-9215.08"/>
</g>
<!-- qkv_proj_1_4 -->
<g id="node431" class="node">
<title>qkv_proj_1_4</title>
<ellipse fill="orange" stroke="black" cx="13655.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13655.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13655.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13655.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="13655.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13655.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_4&#45;&gt;qkv_proj_1_4 -->
<g id="edge532" class="edge">
<title>ln1_1_4&#45;&gt;qkv_proj_1_4</title>
<path fill="none" stroke="black" d="M13862.6,-9296.88C13830.84,-9281.73 13792.37,-9263.37 13757.25,-9246.62"/>
<polygon fill="black" stroke="black" points="13758.46,-9243.32 13747.92,-9242.17 13755.44,-9249.63 13758.46,-9243.32"/>
</g>
<!-- qkv_proj_1_5 -->
<g id="node432" class="node">
<title>qkv_proj_1_5</title>
<ellipse fill="orange" stroke="black" cx="14075.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14075.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14075.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14075.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="14075.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14075.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_5&#45;&gt;qkv_proj_1_5 -->
<g id="edge533" class="edge">
<title>ln1_1_5&#45;&gt;qkv_proj_1_5</title>
<path fill="none" stroke="black" d="M14224.29,-9295.18C14204.38,-9282.19 14181.17,-9267.03 14159.08,-9252.62"/>
<polygon fill="black" stroke="black" points="14160.97,-9249.67 14150.68,-9247.14 14157.14,-9255.53 14160.97,-9249.67"/>
</g>
<!-- qkv_proj_1_6 -->
<g id="node433" class="node">
<title>qkv_proj_1_6</title>
<ellipse fill="orange" stroke="black" cx="14469.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14469.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14469.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14469.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="14469.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14469.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_6&#45;&gt;qkv_proj_1_6 -->
<g id="edge534" class="edge">
<title>ln1_1_6&#45;&gt;qkv_proj_1_6</title>
<path fill="none" stroke="black" d="M14570.23,-9293.8C14558.75,-9282.89 14545.78,-9270.56 14533.07,-9258.47"/>
<polygon fill="black" stroke="black" points="14535.28,-9255.75 14525.62,-9251.39 14530.46,-9260.82 14535.28,-9255.75"/>
</g>
<!-- qkv_proj_1_7 -->
<g id="node434" class="node">
<title>qkv_proj_1_7</title>
<ellipse fill="orange" stroke="black" cx="14838.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14838.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14838.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14838.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="14838.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14838.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_7&#45;&gt;qkv_proj_1_7 -->
<g id="edge535" class="edge">
<title>ln1_1_7&#45;&gt;qkv_proj_1_7</title>
<path fill="none" stroke="black" d="M14905.91,-9293.11C14899.13,-9283.53 14891.59,-9272.9 14884.09,-9262.32"/>
<polygon fill="black" stroke="black" points="14886.74,-9260 14878.1,-9253.87 14881.03,-9264.05 14886.74,-9260"/>
</g>
<!-- qkv_proj_1_8 -->
<g id="node435" class="node">
<title>qkv_proj_1_8</title>
<ellipse fill="orange" stroke="black" cx="15256.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15256.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15256.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15256.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="15256.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15256.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_8&#45;&gt;qkv_proj_1_8 -->
<g id="edge536" class="edge">
<title>ln1_1_8&#45;&gt;qkv_proj_1_8</title>
<path fill="none" stroke="black" d="M15252.97,-9292.76C15253.28,-9284.5 15253.63,-9275.46 15253.97,-9266.36"/>
<polygon fill="black" stroke="black" points="15257.48,-9266.22 15254.36,-9256.09 15250.49,-9265.95 15257.48,-9266.22"/>
</g>
<!-- qkv_proj_1_9 -->
<g id="node436" class="node">
<title>qkv_proj_1_9</title>
<ellipse fill="orange" stroke="black" cx="15708.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15708.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15708.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15708.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="15708.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15708.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_9&#45;&gt;qkv_proj_1_9 -->
<g id="edge537" class="edge">
<title>ln1_1_9&#45;&gt;qkv_proj_1_9</title>
<path fill="none" stroke="black" d="M15607.19,-9293.8C15618.82,-9282.83 15631.96,-9270.42 15644.85,-9258.26"/>
<polygon fill="black" stroke="black" points="15647.51,-9260.55 15652.39,-9251.15 15642.71,-9255.46 15647.51,-9260.55"/>
</g>
<!-- qkv_proj_1_10 -->
<g id="node437" class="node">
<title>qkv_proj_1_10</title>
<ellipse fill="orange" stroke="black" cx="16180.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16180.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16180.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16180.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="16180.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16180.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_10&#45;&gt;qkv_proj_1_10 -->
<g id="edge538" class="edge">
<title>ln1_1_10&#45;&gt;qkv_proj_1_10</title>
<path fill="none" stroke="black" d="M15958.12,-9297.38C15993.37,-9281.65 16036.55,-9262.38 16075.47,-9245.01"/>
<polygon fill="black" stroke="black" points="16077.03,-9248.15 16084.74,-9240.88 16074.18,-9241.76 16077.03,-9248.15"/>
</g>
<!-- qkv_proj_1_11 -->
<g id="node438" class="node">
<title>qkv_proj_1_11</title>
<ellipse fill="orange" stroke="black" cx="16501.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16501.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16501.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16501.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="16501.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16501.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_11&#45;&gt;qkv_proj_1_11 -->
<g id="edge539" class="edge">
<title>ln1_1_11&#45;&gt;qkv_proj_1_11</title>
<path fill="none" stroke="black" d="M16275.33,-9297.38C16311.42,-9281.55 16355.68,-9262.13 16395.46,-9244.67"/>
<polygon fill="black" stroke="black" points="16396.92,-9247.86 16404.67,-9240.63 16394.11,-9241.44 16396.92,-9247.86"/>
</g>
<!-- qkv_proj_1_12 -->
<g id="node439" class="node">
<title>qkv_proj_1_12</title>
<ellipse fill="orange" stroke="black" cx="16814.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16814.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16814.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16814.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="16814.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16814.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_12&#45;&gt;qkv_proj_1_12 -->
<g id="edge540" class="edge">
<title>ln1_1_12&#45;&gt;qkv_proj_1_12</title>
<path fill="none" stroke="black" d="M16590.6,-9297.38C16626.17,-9281.62 16669.77,-9262.29 16709.02,-9244.9"/>
<polygon fill="black" stroke="black" points="16710.64,-9248.01 16718.36,-9240.76 16707.8,-9241.61 16710.64,-9248.01"/>
</g>
<!-- qkv_proj_1_13 -->
<g id="node440" class="node">
<title>qkv_proj_1_13</title>
<ellipse fill="orange" stroke="black" cx="17123.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17123.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17123.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17123.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="17123.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17123.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_13&#45;&gt;qkv_proj_1_13 -->
<g id="edge541" class="edge">
<title>ln1_1_13&#45;&gt;qkv_proj_1_13</title>
<path fill="none" stroke="black" d="M16905.27,-9297.21C16939.47,-9281.69 16981.21,-9262.74 17018.99,-9245.59"/>
<polygon fill="black" stroke="black" points="17020.85,-9248.59 17028.51,-9241.27 17017.96,-9242.21 17020.85,-9248.59"/>
</g>
<!-- qkv_proj_1_14 -->
<g id="node441" class="node">
<title>qkv_proj_1_14</title>
<ellipse fill="orange" stroke="black" cx="19034.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="19034.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19034.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19034.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="19034.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19034.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_14&#45;&gt;qkv_proj_1_14 -->
<g id="edge542" class="edge">
<title>ln1_1_14&#45;&gt;qkv_proj_1_14</title>
<path fill="none" stroke="black" d="M17293.34,-9319.36C17640.7,-9295.18 18527.45,-9233.43 18883.37,-9208.64"/>
<polygon fill="black" stroke="black" points="18883.75,-9212.13 18893.49,-9207.94 18883.27,-9205.14 18883.75,-9212.13"/>
</g>
<!-- qkv_proj_1_15 -->
<g id="node442" class="node">
<title>qkv_proj_1_15</title>
<ellipse fill="orange" stroke="black" cx="20142.57" cy="-9197.11" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20142.57" y="-9223.41" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20142.57" y="-9208.41" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20142.57" y="-9193.41" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="20142.57" y="-9178.41" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20142.57" y="-9163.41" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_1_15&#45;&gt;qkv_proj_1_15 -->
<g id="edge543" class="edge">
<title>ln1_1_15&#45;&gt;qkv_proj_1_15</title>
<path fill="none" stroke="black" d="M18942.41,-9315.79C19195.35,-9290.99 19731.6,-9238.41 19993.01,-9212.78"/>
<polygon fill="black" stroke="black" points="19993.73,-9216.23 20003.34,-9211.77 19993.05,-9209.26 19993.73,-9216.23"/>
</g>
<!-- reshape_qkv_1_0 -->
<g id="node443" class="node">
<title>reshape_qkv_1_0</title>
<ellipse fill="lightcyan" stroke="black" cx="8035.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8035.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8035.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8035.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_0&#45;&gt;reshape_qkv_1_0 -->
<g id="edge544" class="edge">
<title>qkv_proj_1_0&#45;&gt;reshape_qkv_1_0</title>
<path fill="none" stroke="black" d="M9434.26,-9184.15C9146.76,-9159.65 8492.61,-9103.88 8191.98,-9078.26"/>
<polygon fill="black" stroke="black" points="8192.13,-9074.76 8181.87,-9077.4 8191.54,-9081.73 8192.13,-9074.76"/>
</g>
<!-- reshape_qkv_1_1 -->
<g id="node456" class="node">
<title>reshape_qkv_1_1</title>
<ellipse fill="lightcyan" stroke="black" cx="8968.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8968.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8968.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8968.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_1&#45;&gt;reshape_qkv_1_1 -->
<g id="edge559" class="edge">
<title>qkv_proj_1_1&#45;&gt;reshape_qkv_1_1</title>
<path fill="none" stroke="black" d="M10460.93,-9184.82C10157.67,-9160.45 9444.01,-9103.12 9126.12,-9077.58"/>
<polygon fill="black" stroke="black" points="9126.15,-9074.07 9115.9,-9076.76 9125.59,-9081.05 9126.15,-9074.07"/>
</g>
<!-- reshape_qkv_1_2 -->
<g id="node468" class="node">
<title>reshape_qkv_1_2</title>
<ellipse fill="lightcyan" stroke="black" cx="9936.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9936.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9936.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9936.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_2&#45;&gt;reshape_qkv_1_2 -->
<g id="edge574" class="edge">
<title>qkv_proj_1_2&#45;&gt;reshape_qkv_1_2</title>
<path fill="none" stroke="black" d="M11559.57,-9185.63C11234.87,-9161.48 10436.16,-9102.08 10095.11,-9076.71"/>
<polygon fill="black" stroke="black" points="10095.13,-9073.21 10084.9,-9075.96 10094.61,-9080.19 10095.13,-9073.21"/>
</g>
<!-- reshape_qkv_1_3 -->
<g id="node480" class="node">
<title>reshape_qkv_1_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10892.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10892.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10892.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10892.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_3&#45;&gt;reshape_qkv_1_3 -->
<g id="edge589" class="edge">
<title>qkv_proj_1_3&#45;&gt;reshape_qkv_1_3</title>
<path fill="none" stroke="black" d="M12480.82,-9185.43C12161.93,-9161.24 11386.15,-9102.38 11051.05,-9076.95"/>
<polygon fill="black" stroke="black" points="11051.01,-9073.44 11040.78,-9076.17 11050.48,-9080.42 11051.01,-9073.44"/>
</g>
<!-- reshape_qkv_1_4 -->
<g id="node493" class="node">
<title>reshape_qkv_1_4</title>
<ellipse fill="lightcyan" stroke="black" cx="11749.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11749.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11749.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11749.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_4&#45;&gt;reshape_qkv_1_4 -->
<g id="edge605" class="edge">
<title>qkv_proj_1_4&#45;&gt;reshape_qkv_1_4</title>
<path fill="none" stroke="black" d="M13514.26,-9186.39C13167.12,-9162.49 12274.26,-9101.04 11908.96,-9075.9"/>
<polygon fill="black" stroke="black" points="11909.06,-9072.39 11898.84,-9075.2 11908.58,-9079.38 11909.06,-9072.39"/>
</g>
<!-- reshape_qkv_1_5 -->
<g id="node506" class="node">
<title>reshape_qkv_1_5</title>
<ellipse fill="lightcyan" stroke="black" cx="12746.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12746.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12746.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12746.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_5&#45;&gt;reshape_qkv_1_5 -->
<g id="edge620" class="edge">
<title>qkv_proj_1_5&#45;&gt;reshape_qkv_1_5</title>
<path fill="none" stroke="black" d="M13953.62,-9165.9C13908.33,-9155.71 13856.35,-9145.2 13808.57,-9138.42 13493.51,-9093.72 13121.85,-9075.9 12912.24,-9069.03"/>
<polygon fill="black" stroke="black" points="12912.19,-9065.52 12902.08,-9068.7 12911.96,-9072.52 12912.19,-9065.52"/>
</g>
<!-- reshape_qkv_1_6 -->
<g id="node518" class="node">
<title>reshape_qkv_1_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13674.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13674.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13674.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13674.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_6&#45;&gt;reshape_qkv_1_6 -->
<g id="edge635" class="edge">
<title>qkv_proj_1_6&#45;&gt;reshape_qkv_1_6</title>
<path fill="none" stroke="black" d="M14349.65,-9164.83C14311.16,-9155.49 14268.23,-9145.78 14228.57,-9138.42 14093.49,-9113.37 13938.35,-9093.54 13826.66,-9080.83"/>
<polygon fill="black" stroke="black" points="13827,-9077.34 13816.67,-9079.69 13826.21,-9084.3 13827,-9077.34"/>
</g>
<!-- reshape_qkv_1_7 -->
<g id="node530" class="node">
<title>reshape_qkv_1_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14601.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14601.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14601.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14601.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_7&#45;&gt;reshape_qkv_1_7 -->
<g id="edge650" class="edge">
<title>qkv_proj_1_7&#45;&gt;reshape_qkv_1_7</title>
<path fill="none" stroke="black" d="M14754.35,-9149.49C14727.21,-9134.47 14697.45,-9118 14671.47,-9103.61"/>
<polygon fill="black" stroke="black" points="14672.89,-9100.4 14662.44,-9098.62 14669.5,-9106.52 14672.89,-9100.4"/>
</g>
<!-- reshape_qkv_1_8 -->
<g id="node543" class="node">
<title>reshape_qkv_1_8</title>
<ellipse fill="lightcyan" stroke="black" cx="15258.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15258.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15258.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15258.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_8&#45;&gt;reshape_qkv_1_8 -->
<g id="edge666" class="edge">
<title>qkv_proj_1_8&#45;&gt;reshape_qkv_1_8</title>
<path fill="none" stroke="black" d="M15257.46,-9138.19C15257.59,-9129.31 15257.73,-9120.24 15257.86,-9111.64"/>
<polygon fill="black" stroke="black" points="15261.36,-9111.48 15258.02,-9101.43 15254.36,-9111.38 15261.36,-9111.48"/>
</g>
<!-- reshape_qkv_1_9 -->
<g id="node556" class="node">
<title>reshape_qkv_1_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16074.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16074.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16074.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16074.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_9&#45;&gt;reshape_qkv_1_9 -->
<g id="edge681" class="edge">
<title>qkv_proj_1_9&#45;&gt;reshape_qkv_1_9</title>
<path fill="none" stroke="black" d="M15815.42,-9157.82C15867.45,-9139.17 15929.48,-9116.93 15979.81,-9098.89"/>
<polygon fill="black" stroke="black" points="15981.16,-9102.13 15989.39,-9095.46 15978.79,-9095.54 15981.16,-9102.13"/>
</g>
<!-- reshape_qkv_1_10 -->
<g id="node568" class="node">
<title>reshape_qkv_1_10</title>
<ellipse fill="lightcyan" stroke="black" cx="16971.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16971.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16971.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16971.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_10&#45;&gt;reshape_qkv_1_10 -->
<g id="edge696" class="edge">
<title>qkv_proj_1_10&#45;&gt;reshape_qkv_1_10</title>
<path fill="none" stroke="black" d="M16284.88,-9156.46C16305.74,-9149.62 16327.68,-9143.19 16348.57,-9138.42 16503.14,-9103.19 16683.34,-9084.27 16810.07,-9074.49"/>
<polygon fill="black" stroke="black" points="16810.54,-9077.96 16820.24,-9073.72 16810.01,-9070.98 16810.54,-9077.96"/>
</g>
<!-- reshape_qkv_1_11 -->
<g id="node580" class="node">
<title>reshape_qkv_1_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17929.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17929.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17929.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17929.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_11&#45;&gt;reshape_qkv_1_11 -->
<g id="edge711" class="edge">
<title>qkv_proj_1_11&#45;&gt;reshape_qkv_1_11</title>
<path fill="none" stroke="black" d="M16601.88,-9154.99C16621.39,-9148.41 16641.9,-9142.45 16661.57,-9138.42 16766.89,-9116.86 17447.53,-9085.5 17765.87,-9071.78"/>
<polygon fill="black" stroke="black" points="17766.28,-9075.27 17776.12,-9071.34 17765.97,-9068.27 17766.28,-9075.27"/>
</g>
<!-- reshape_qkv_1_12 -->
<g id="node593" class="node">
<title>reshape_qkv_1_12</title>
<ellipse fill="lightcyan" stroke="black" cx="18856.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18856.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18856.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18856.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_12&#45;&gt;reshape_qkv_1_12 -->
<g id="edge727" class="edge">
<title>qkv_proj_1_12&#45;&gt;reshape_qkv_1_12</title>
<path fill="none" stroke="black" d="M16915.52,-9155.15C16933.64,-9148.85 16952.5,-9142.94 16970.57,-9138.42 17031.06,-9123.3 17047.41,-9124.22 17109.57,-9119.42 17546.57,-9085.69 17657.52,-9115.93 18095.57,-9101.42 18302.55,-9094.57 18540.99,-9082.45 18695,-9074.07"/>
<polygon fill="black" stroke="black" points="18695.23,-9077.56 18705.02,-9073.52 18694.85,-9070.57 18695.23,-9077.56"/>
</g>
<!-- reshape_qkv_1_13 -->
<g id="node606" class="node">
<title>reshape_qkv_1_13</title>
<ellipse fill="lightcyan" stroke="black" cx="19777.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19777.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19777.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19777.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_13&#45;&gt;reshape_qkv_1_13 -->
<g id="edge742" class="edge">
<title>qkv_proj_1_13&#45;&gt;reshape_qkv_1_13</title>
<path fill="none" stroke="black" d="M17265.79,-9189.08C17719.88,-9166.64 19133.29,-9096.77 19614.91,-9072.97"/>
<polygon fill="black" stroke="black" points="19615.26,-9076.45 19625.07,-9072.46 19614.91,-9069.46 19615.26,-9076.45"/>
</g>
<!-- reshape_qkv_1_14 -->
<g id="node618" class="node">
<title>reshape_qkv_1_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20704.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20704.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20704.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20704.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_14&#45;&gt;reshape_qkv_1_14 -->
<g id="edge757" class="edge">
<title>qkv_proj_1_14&#45;&gt;reshape_qkv_1_14</title>
<path fill="none" stroke="black" d="M19175.16,-9185.07C19484.43,-9160.78 20222.05,-9102.83 20546.66,-9077.33"/>
<polygon fill="black" stroke="black" points="20547.39,-9080.78 20557.08,-9076.51 20546.84,-9073.81 20547.39,-9080.78"/>
</g>
<!-- reshape_qkv_1_15 -->
<g id="node630" class="node">
<title>reshape_qkv_1_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21707.57" cy="-9063.92" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21707.57" y="-9075.22" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21707.57" y="-9060.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21707.57" y="-9045.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_1_15&#45;&gt;reshape_qkv_1_15 -->
<g id="edge772" class="edge">
<title>qkv_proj_1_15&#45;&gt;reshape_qkv_1_15</title>
<path fill="none" stroke="black" d="M20282.83,-9184.36C20574.65,-9159.89 21245.33,-9103.67 21550.83,-9078.06"/>
<polygon fill="black" stroke="black" points="21551.43,-9081.53 21561.1,-9077.2 21550.84,-9074.55 21551.43,-9081.53"/>
</g>
<!-- split_q_1_0 -->
<g id="node444" class="node">
<title>split_q_1_0</title>
<ellipse fill="pink" stroke="black" cx="7648.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7648.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7648.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7648.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_q_1_0 -->
<g id="edge545" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_q_1_0</title>
<path fill="none" stroke="black" d="M7936.66,-9034.81C7880.88,-9018.96 7811.19,-8999.15 7754.32,-8982.98"/>
<polygon fill="black" stroke="black" points="7755.16,-8979.58 7744.59,-8980.22 7753.25,-8986.32 7755.16,-8979.58"/>
</g>
<!-- split_k_1_0 -->
<g id="node445" class="node">
<title>split_k_1_0</title>
<ellipse fill="pink" stroke="black" cx="7957.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7957.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="7957.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7957.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_k_1_0 -->
<g id="edge546" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_k_1_0</title>
<path fill="none" stroke="black" d="M8010.03,-9026.91C8003.37,-9017.5 7996.1,-9007.26 7989.16,-8997.47"/>
<polygon fill="black" stroke="black" points="7991.81,-8995.16 7983.17,-8989.02 7986.1,-8999.21 7991.81,-8995.16"/>
</g>
<!-- split_v_1_0 -->
<g id="node446" class="node">
<title>split_v_1_0</title>
<ellipse fill="pink" stroke="black" cx="8266.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8266.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8266.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8266.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_0&#45;&gt;split_v_1_0 -->
<g id="edge547" class="edge">
<title>reshape_qkv_1_0&#45;&gt;split_v_1_0</title>
<path fill="none" stroke="black" d="M8104.26,-9030.22C8131.02,-9017.47 8161.82,-9002.81 8189.35,-8989.7"/>
<polygon fill="black" stroke="black" points="8191.03,-8992.77 8198.55,-8985.31 8188.02,-8986.45 8191.03,-8992.77"/>
</g>
<!-- transpose_q_1_0 -->
<g id="node447" class="node">
<title>transpose_q_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="7648.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7648.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7648.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7648.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_0&#45;&gt;transpose_q_1_0 -->
<g id="edge548" class="edge">
<title>split_q_1_0&#45;&gt;transpose_q_1_0</title>
<path fill="none" stroke="black" d="M7648.57,-8914.3C7648.57,-8905.85 7648.57,-8896.75 7648.57,-8887.94"/>
<polygon fill="black" stroke="black" points="7652.07,-8887.77 7648.57,-8877.77 7645.07,-8887.77 7652.07,-8887.77"/>
</g>
<!-- transpose_k_1_0 -->
<g id="node448" class="node">
<title>transpose_k_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="7957.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7957.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="7957.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7957.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_0&#45;&gt;transpose_k_1_0 -->
<g id="edge549" class="edge">
<title>split_k_1_0&#45;&gt;transpose_k_1_0</title>
<path fill="none" stroke="black" d="M7957.57,-8914.3C7957.57,-8905.85 7957.57,-8896.75 7957.57,-8887.94"/>
<polygon fill="black" stroke="black" points="7961.07,-8887.77 7957.57,-8877.77 7954.07,-8887.77 7961.07,-8887.77"/>
</g>
<!-- transpose_v_1_0 -->
<g id="node449" class="node">
<title>transpose_v_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="8266.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8266.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8266.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8266.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_0&#45;&gt;transpose_v_1_0 -->
<g id="edge550" class="edge">
<title>split_v_1_0&#45;&gt;transpose_v_1_0</title>
<path fill="none" stroke="black" d="M8266.57,-8914.3C8266.57,-8905.85 8266.57,-8896.75 8266.57,-8887.94"/>
<polygon fill="black" stroke="black" points="8270.07,-8887.77 8266.57,-8877.77 8263.07,-8887.77 8270.07,-8887.77"/>
</g>
<!-- attn_scores_1_0 -->
<g id="node450" class="node">
<title>attn_scores_1_0</title>
<ellipse fill="gold" stroke="black" cx="7957.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="7957.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7957.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7957.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_0&#45;&gt;attn_scores_1_0 -->
<g id="edge551" class="edge">
<title>transpose_q_1_0&#45;&gt;attn_scores_1_0</title>
<path fill="none" stroke="black" d="M7732.19,-8809.16C7771.91,-8795.02 7819.6,-8778.04 7860.86,-8763.35"/>
<polygon fill="black" stroke="black" points="7862.13,-8766.62 7870.38,-8759.96 7859.79,-8760.02 7862.13,-8766.62"/>
</g>
<!-- transpose_k_1_0&#45;&gt;attn_scores_1_0 -->
<g id="edge552" class="edge">
<title>transpose_k_1_0&#45;&gt;attn_scores_1_0</title>
<path fill="none" stroke="black" d="M7957.57,-8802.3C7957.57,-8793.85 7957.57,-8784.75 7957.57,-8775.94"/>
<polygon fill="black" stroke="black" points="7961.07,-8775.77 7957.57,-8765.77 7954.07,-8775.77 7961.07,-8775.77"/>
</g>
<!-- attn_output_1_0 -->
<g id="node451" class="node">
<title>attn_output_1_0</title>
<ellipse fill="gold" stroke="black" cx="8266.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8266.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8266.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8266.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_0&#45;&gt;attn_output_1_0 -->
<g id="edge553" class="edge">
<title>transpose_v_1_0&#45;&gt;attn_output_1_0</title>
<path fill="none" stroke="black" d="M8266.57,-8802.23C8266.57,-8741.18 8266.57,-8618.87 8266.57,-8551.72"/>
<polygon fill="black" stroke="black" points="8270.07,-8551.43 8266.57,-8541.43 8263.07,-8551.43 8270.07,-8551.43"/>
</g>
<!-- softmax_1_0 -->
<g id="node452" class="node">
<title>softmax_1_0</title>
<ellipse fill="gold" stroke="black" cx="8014.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8014.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8014.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8014.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_0&#45;&gt;softmax_1_0 -->
<g id="edge554" class="edge">
<title>attn_scores_1_0&#45;&gt;softmax_1_0</title>
<path fill="none" stroke="black" d="M7976.4,-8690.6C7981.11,-8681.5 7986.23,-8671.62 7991.15,-8662.14"/>
<polygon fill="black" stroke="black" points="7994.28,-8663.7 7995.77,-8653.21 7988.06,-8660.48 7994.28,-8663.7"/>
</g>
<!-- transpose_back_1_0 -->
<g id="node453" class="node">
<title>transpose_back_1_0</title>
<ellipse fill="lightgray" stroke="black" cx="8729.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8729.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="8729.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8729.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_0&#45;&gt;transpose_back_1_0 -->
<g id="edge556" class="edge">
<title>attn_output_1_0&#45;&gt;transpose_back_1_0</title>
<path fill="none" stroke="black" d="M8371.64,-8477.96C8443.9,-8460.8 8539.87,-8438 8614.24,-8420.32"/>
<polygon fill="black" stroke="black" points="8615.21,-8423.69 8624.13,-8417.98 8613.59,-8416.88 8615.21,-8423.69"/>
</g>
<!-- softmax_1_0&#45;&gt;attn_output_1_0 -->
<g id="edge555" class="edge">
<title>softmax_1_0&#45;&gt;attn_output_1_0</title>
<path fill="none" stroke="black" d="M8089.16,-8582.37C8119.15,-8569.28 8153.83,-8554.14 8184.52,-8540.74"/>
<polygon fill="black" stroke="black" points="8186.15,-8543.85 8193.91,-8536.64 8183.35,-8537.43 8186.15,-8543.85"/>
</g>
<!-- reshape_concat_1_0 -->
<g id="node454" class="node">
<title>reshape_concat_1_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9360.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9360.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9360.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9360.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_0&#45;&gt;reshape_concat_1_0 -->
<g id="edge557" class="edge">
<title>transpose_back_1_0&#45;&gt;reshape_concat_1_0</title>
<path fill="none" stroke="black" d="M8848.63,-8370.17C8960.26,-8350.71 9126.39,-8321.75 9238.87,-8302.14"/>
<polygon fill="black" stroke="black" points="9239.66,-8305.56 9248.91,-8300.39 9238.46,-8298.66 9239.66,-8305.56"/>
</g>
<!-- allgather_dim_1_0 -->
<g id="node455" class="node">
<title>allgather_dim_1_0</title>
<polygon fill="red" stroke="black" points="10029.57,-8205.42 9856.57,-8152.42 10029.57,-8099.42 10202.57,-8152.42 10029.57,-8205.42"/>
<text text-anchor="middle" x="10029.57" y="-8163.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="10029.57" y="-8148.72" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10029.57" y="-8133.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_0&#45;&gt;allgather_dim_1_0 -->
<g id="edge558" class="edge">
<title>reshape_concat_1_0&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M9465.18,-8256.77C9488.65,-8251.92 9513.44,-8246.91 9536.57,-8242.42 9664.11,-8217.69 9810.66,-8191.52 9910.61,-8174.01"/>
<polygon fill="black" stroke="black" points="9911.49,-8177.41 9920.74,-8172.24 9910.29,-8170.51 9911.49,-8177.41"/>
</g>
<!-- head_group_1_0 -->
<g id="node492" class="node">
<title>head_group_1_0</title>
<polygon fill="lightyellow" stroke="black" points="11524.07,-8062.42 11327.07,-8062.42 11327.07,-8024.42 11524.07,-8024.42 11524.07,-8062.42"/>
<text text-anchor="middle" x="11425.57" y="-8047.22" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="11425.57" y="-8032.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_0&#45;&gt;head_group_1_0 -->
<g id="edge604" class="edge">
<title>allgather_dim_1_0&#45;&gt;head_group_1_0</title>
<path fill="none" stroke="black" d="M10165.65,-8140.99C10442.07,-8119.81 11064.37,-8072.11 11316.45,-8052.79"/>
<polygon fill="black" stroke="black" points="11317.01,-8056.26 11326.72,-8052 11316.48,-8049.28 11317.01,-8056.26"/>
</g>
<!-- split_q_1_1 -->
<g id="node457" class="node">
<title>split_q_1_1</title>
<ellipse fill="pink" stroke="black" cx="8575.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8575.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8575.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8575.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_q_1_1 -->
<g id="edge560" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_q_1_1</title>
<path fill="none" stroke="black" d="M8868.64,-9034.95C8811.67,-9019.01 8740.29,-8999.03 8682.24,-8982.78"/>
<polygon fill="black" stroke="black" points="8682.88,-8979.33 8672.31,-8980 8680.99,-8986.07 8682.88,-8979.33"/>
</g>
<!-- split_k_1_1 -->
<g id="node458" class="node">
<title>split_k_1_1</title>
<ellipse fill="pink" stroke="black" cx="8884.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8884.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8884.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8884.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_k_1_1 -->
<g id="edge561" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_k_1_1</title>
<path fill="none" stroke="black" d="M8941.07,-9026.91C8933.82,-9017.41 8925.91,-9007.05 8918.37,-8997.18"/>
<polygon fill="black" stroke="black" points="8920.99,-8994.85 8912.14,-8989.02 8915.43,-8999.1 8920.99,-8994.85"/>
</g>
<!-- split_v_1_1 -->
<g id="node459" class="node">
<title>split_v_1_1</title>
<ellipse fill="pink" stroke="black" cx="9193.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9193.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9193.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9193.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_1&#45;&gt;split_v_1_1 -->
<g id="edge562" class="edge">
<title>reshape_qkv_1_1&#45;&gt;split_v_1_1</title>
<path fill="none" stroke="black" d="M9036.08,-9029.92C9061.9,-9017.3 9091.51,-9002.82 9118.03,-8989.86"/>
<polygon fill="black" stroke="black" points="9119.83,-8992.87 9127.28,-8985.34 9116.75,-8986.58 9119.83,-8992.87"/>
</g>
<!-- transpose_q_1_1 -->
<g id="node460" class="node">
<title>transpose_q_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="8575.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8575.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8575.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8575.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_1&#45;&gt;transpose_q_1_1 -->
<g id="edge563" class="edge">
<title>split_q_1_1&#45;&gt;transpose_q_1_1</title>
<path fill="none" stroke="black" d="M8575.57,-8914.3C8575.57,-8905.85 8575.57,-8896.75 8575.57,-8887.94"/>
<polygon fill="black" stroke="black" points="8579.07,-8887.77 8575.57,-8877.77 8572.07,-8887.77 8579.07,-8887.77"/>
</g>
<!-- transpose_k_1_1 -->
<g id="node461" class="node">
<title>transpose_k_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="8884.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8884.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8884.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8884.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_1&#45;&gt;transpose_k_1_1 -->
<g id="edge564" class="edge">
<title>split_k_1_1&#45;&gt;transpose_k_1_1</title>
<path fill="none" stroke="black" d="M8884.57,-8914.3C8884.57,-8905.85 8884.57,-8896.75 8884.57,-8887.94"/>
<polygon fill="black" stroke="black" points="8888.07,-8887.77 8884.57,-8877.77 8881.07,-8887.77 8888.07,-8887.77"/>
</g>
<!-- transpose_v_1_1 -->
<g id="node462" class="node">
<title>transpose_v_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="9193.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9193.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9193.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9193.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_1&#45;&gt;transpose_v_1_1 -->
<g id="edge565" class="edge">
<title>split_v_1_1&#45;&gt;transpose_v_1_1</title>
<path fill="none" stroke="black" d="M9193.57,-8914.3C9193.57,-8905.85 9193.57,-8896.75 9193.57,-8887.94"/>
<polygon fill="black" stroke="black" points="9197.07,-8887.77 9193.57,-8877.77 9190.07,-8887.77 9197.07,-8887.77"/>
</g>
<!-- attn_scores_1_1 -->
<g id="node463" class="node">
<title>attn_scores_1_1</title>
<ellipse fill="gold" stroke="black" cx="8884.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8884.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8884.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8884.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_1&#45;&gt;attn_scores_1_1 -->
<g id="edge566" class="edge">
<title>transpose_q_1_1&#45;&gt;attn_scores_1_1</title>
<path fill="none" stroke="black" d="M8659.19,-8809.16C8698.91,-8795.02 8746.6,-8778.04 8787.86,-8763.35"/>
<polygon fill="black" stroke="black" points="8789.13,-8766.62 8797.38,-8759.96 8786.79,-8760.02 8789.13,-8766.62"/>
</g>
<!-- transpose_k_1_1&#45;&gt;attn_scores_1_1 -->
<g id="edge567" class="edge">
<title>transpose_k_1_1&#45;&gt;attn_scores_1_1</title>
<path fill="none" stroke="black" d="M8884.57,-8802.3C8884.57,-8793.85 8884.57,-8784.75 8884.57,-8775.94"/>
<polygon fill="black" stroke="black" points="8888.07,-8775.77 8884.57,-8765.77 8881.07,-8775.77 8888.07,-8775.77"/>
</g>
<!-- attn_output_1_1 -->
<g id="node464" class="node">
<title>attn_output_1_1</title>
<ellipse fill="gold" stroke="black" cx="9193.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9193.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9193.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9193.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_1&#45;&gt;attn_output_1_1 -->
<g id="edge568" class="edge">
<title>transpose_v_1_1&#45;&gt;attn_output_1_1</title>
<path fill="none" stroke="black" d="M9193.57,-8802.23C9193.57,-8741.18 9193.57,-8618.87 9193.57,-8551.72"/>
<polygon fill="black" stroke="black" points="9197.07,-8551.43 9193.57,-8541.43 9190.07,-8551.43 9197.07,-8551.43"/>
</g>
<!-- softmax_1_1 -->
<g id="node465" class="node">
<title>softmax_1_1</title>
<ellipse fill="gold" stroke="black" cx="8969.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8969.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8969.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8969.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_1&#45;&gt;softmax_1_1 -->
<g id="edge569" class="edge">
<title>attn_scores_1_1&#45;&gt;softmax_1_1</title>
<path fill="none" stroke="black" d="M8912.41,-8690.91C8919.74,-8681.41 8927.75,-8671.05 8935.38,-8661.18"/>
<polygon fill="black" stroke="black" points="8938.33,-8663.08 8941.68,-8653.02 8932.79,-8658.8 8938.33,-8663.08"/>
</g>
<!-- transpose_back_1_1 -->
<g id="node466" class="node">
<title>transpose_back_1_1</title>
<ellipse fill="lightgray" stroke="black" cx="9294.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9294.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9294.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9294.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_1&#45;&gt;transpose_back_1_1 -->
<g id="edge571" class="edge">
<title>attn_output_1_1&#45;&gt;transpose_back_1_1</title>
<path fill="none" stroke="black" d="M9226.37,-8467.21C9235.36,-8457.41 9245.22,-8446.68 9254.57,-8436.49"/>
<polygon fill="black" stroke="black" points="9257.42,-8438.57 9261.6,-8428.84 9252.26,-8433.83 9257.42,-8438.57"/>
</g>
<!-- softmax_1_1&#45;&gt;attn_output_1_1 -->
<g id="edge570" class="edge">
<title>softmax_1_1&#45;&gt;attn_output_1_1</title>
<path fill="none" stroke="black" d="M9037.39,-8581.62C9062.96,-8569.07 9092.19,-8554.71 9118.4,-8541.84"/>
<polygon fill="black" stroke="black" points="9120.09,-8544.91 9127.53,-8537.36 9117.01,-8538.62 9120.09,-8544.91"/>
</g>
<!-- reshape_concat_1_1 -->
<g id="node467" class="node">
<title>reshape_concat_1_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9678.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9678.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9678.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9678.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_1&#45;&gt;reshape_concat_1_1 -->
<g id="edge572" class="edge">
<title>transpose_back_1_1&#45;&gt;reshape_concat_1_1</title>
<path fill="none" stroke="black" d="M9389.99,-8363.59C9446.89,-8347.29 9519.1,-8326.61 9577.05,-8310.01"/>
<polygon fill="black" stroke="black" points="9578.31,-8313.29 9586.96,-8307.17 9576.38,-8306.56 9578.31,-8313.29"/>
</g>
<!-- reshape_concat_1_1&#45;&gt;allgather_dim_1_0 -->
<g id="edge573" class="edge">
<title>reshape_concat_1_1&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M9759.54,-8249.97C9813.99,-8230.51 9885.74,-8204.85 9941.6,-8184.88"/>
<polygon fill="black" stroke="black" points="9942.89,-8188.14 9951.13,-8181.47 9940.53,-8181.54 9942.89,-8188.14"/>
</g>
<!-- split_q_1_2 -->
<g id="node469" class="node">
<title>split_q_1_2</title>
<ellipse fill="pink" stroke="black" cx="9502.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9502.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9502.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9502.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_q_1_2 -->
<g id="edge575" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_q_1_2</title>
<path fill="none" stroke="black" d="M9830.96,-9036.16C9765.31,-9019.52 9681.01,-8998.15 9614.26,-8981.23"/>
<polygon fill="black" stroke="black" points="9615.09,-8977.83 9604.54,-8978.77 9613.37,-8984.62 9615.09,-8977.83"/>
</g>
<!-- split_k_1_2 -->
<g id="node470" class="node">
<title>split_k_1_2</title>
<ellipse fill="pink" stroke="black" cx="9811.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9811.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9811.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9811.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_k_1_2 -->
<g id="edge576" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_k_1_2</title>
<path fill="none" stroke="black" d="M9896.33,-9027.51C9884.63,-9017.21 9871.72,-9005.85 9859.58,-8995.17"/>
<polygon fill="black" stroke="black" points="9861.56,-8992.25 9851.74,-8988.27 9856.93,-8997.5 9861.56,-8992.25"/>
</g>
<!-- split_v_1_2 -->
<g id="node471" class="node">
<title>split_v_1_2</title>
<ellipse fill="pink" stroke="black" cx="10120.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10120.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10120.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10120.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_2&#45;&gt;split_v_1_2 -->
<g id="edge577" class="edge">
<title>reshape_qkv_1_2&#45;&gt;split_v_1_2</title>
<path fill="none" stroke="black" d="M9993.53,-9028.87C10013.12,-9017.17 10035.19,-9003.97 10055.38,-8991.9"/>
<polygon fill="black" stroke="black" points="10057.41,-8994.76 10064.2,-8986.63 10053.82,-8988.75 10057.41,-8994.76"/>
</g>
<!-- transpose_q_1_2 -->
<g id="node472" class="node">
<title>transpose_q_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="9502.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9502.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9502.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9502.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_2&#45;&gt;transpose_q_1_2 -->
<g id="edge578" class="edge">
<title>split_q_1_2&#45;&gt;transpose_q_1_2</title>
<path fill="none" stroke="black" d="M9502.57,-8914.3C9502.57,-8905.85 9502.57,-8896.75 9502.57,-8887.94"/>
<polygon fill="black" stroke="black" points="9506.07,-8887.77 9502.57,-8877.77 9499.07,-8887.77 9506.07,-8887.77"/>
</g>
<!-- transpose_k_1_2 -->
<g id="node473" class="node">
<title>transpose_k_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="9811.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9811.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9811.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9811.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_2&#45;&gt;transpose_k_1_2 -->
<g id="edge579" class="edge">
<title>split_k_1_2&#45;&gt;transpose_k_1_2</title>
<path fill="none" stroke="black" d="M9811.57,-8914.3C9811.57,-8905.85 9811.57,-8896.75 9811.57,-8887.94"/>
<polygon fill="black" stroke="black" points="9815.07,-8887.77 9811.57,-8877.77 9808.07,-8887.77 9815.07,-8887.77"/>
</g>
<!-- transpose_v_1_2 -->
<g id="node474" class="node">
<title>transpose_v_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="10120.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10120.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10120.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10120.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_2&#45;&gt;transpose_v_1_2 -->
<g id="edge580" class="edge">
<title>split_v_1_2&#45;&gt;transpose_v_1_2</title>
<path fill="none" stroke="black" d="M10120.57,-8914.3C10120.57,-8905.85 10120.57,-8896.75 10120.57,-8887.94"/>
<polygon fill="black" stroke="black" points="10124.07,-8887.77 10120.57,-8877.77 10117.07,-8887.77 10124.07,-8887.77"/>
</g>
<!-- attn_scores_1_2 -->
<g id="node475" class="node">
<title>attn_scores_1_2</title>
<ellipse fill="gold" stroke="black" cx="9811.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9811.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9811.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9811.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_2&#45;&gt;attn_scores_1_2 -->
<g id="edge581" class="edge">
<title>transpose_q_1_2&#45;&gt;attn_scores_1_2</title>
<path fill="none" stroke="black" d="M9586.19,-8809.16C9625.91,-8795.02 9673.6,-8778.04 9714.86,-8763.35"/>
<polygon fill="black" stroke="black" points="9716.13,-8766.62 9724.38,-8759.96 9713.79,-8760.02 9716.13,-8766.62"/>
</g>
<!-- transpose_k_1_2&#45;&gt;attn_scores_1_2 -->
<g id="edge582" class="edge">
<title>transpose_k_1_2&#45;&gt;attn_scores_1_2</title>
<path fill="none" stroke="black" d="M9811.57,-8802.3C9811.57,-8793.85 9811.57,-8784.75 9811.57,-8775.94"/>
<polygon fill="black" stroke="black" points="9815.07,-8775.77 9811.57,-8765.77 9808.07,-8775.77 9815.07,-8775.77"/>
</g>
<!-- attn_output_1_2 -->
<g id="node476" class="node">
<title>attn_output_1_2</title>
<ellipse fill="gold" stroke="black" cx="10029.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10029.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10029.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10029.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_2&#45;&gt;attn_output_1_2 -->
<g id="edge583" class="edge">
<title>transpose_v_1_2&#45;&gt;attn_output_1_2</title>
<path fill="none" stroke="black" d="M10110.57,-8802.23C10093.91,-8741.06 10060.48,-8618.36 10042.21,-8551.3"/>
<polygon fill="black" stroke="black" points="10045.53,-8550.16 10039.52,-8541.43 10038.77,-8552 10045.53,-8550.16"/>
</g>
<!-- softmax_1_2 -->
<g id="node477" class="node">
<title>softmax_1_2</title>
<ellipse fill="gold" stroke="black" cx="9853.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9853.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9853.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9853.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_2&#45;&gt;softmax_1_2 -->
<g id="edge584" class="edge">
<title>attn_scores_1_2&#45;&gt;softmax_1_2</title>
<path fill="none" stroke="black" d="M9825.56,-8690.3C9828.92,-8681.48 9832.56,-8671.96 9836.06,-8662.78"/>
<polygon fill="black" stroke="black" points="9839.35,-8663.98 9839.65,-8653.39 9832.81,-8661.49 9839.35,-8663.98"/>
</g>
<!-- transpose_back_1_2 -->
<g id="node478" class="node">
<title>transpose_back_1_2</title>
<ellipse fill="lightgray" stroke="black" cx="10029.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10029.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10029.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10029.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_2&#45;&gt;transpose_back_1_2 -->
<g id="edge586" class="edge">
<title>attn_output_1_2&#45;&gt;transpose_back_1_2</title>
<path fill="none" stroke="black" d="M10029.57,-8466.3C10029.57,-8457.85 10029.57,-8448.75 10029.57,-8439.94"/>
<polygon fill="black" stroke="black" points="10033.07,-8439.77 10029.57,-8429.77 10026.07,-8439.77 10033.07,-8439.77"/>
</g>
<!-- softmax_1_2&#45;&gt;attn_output_1_2 -->
<g id="edge585" class="edge">
<title>softmax_1_2&#45;&gt;attn_output_1_2</title>
<path fill="none" stroke="black" d="M9908.78,-8580.42C9927.22,-8568.89 9947.91,-8555.96 9966.89,-8544.1"/>
<polygon fill="black" stroke="black" points="9968.84,-8547.01 9975.47,-8538.74 9965.13,-8541.07 9968.84,-8547.01"/>
</g>
<!-- reshape_concat_1_2 -->
<g id="node479" class="node">
<title>reshape_concat_1_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10029.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10029.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10029.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10029.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_2&#45;&gt;reshape_concat_1_2 -->
<g id="edge587" class="edge">
<title>transpose_back_1_2&#45;&gt;reshape_concat_1_2</title>
<path fill="none" stroke="black" d="M10029.57,-8354.3C10029.57,-8345.85 10029.57,-8336.75 10029.57,-8327.94"/>
<polygon fill="black" stroke="black" points="10033.07,-8327.77 10029.57,-8317.77 10026.07,-8327.77 10033.07,-8327.77"/>
</g>
<!-- reshape_concat_1_2&#45;&gt;allgather_dim_1_0 -->
<g id="edge588" class="edge">
<title>reshape_concat_1_2&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M10029.57,-8242.29C10029.57,-8233.98 10029.57,-8224.93 10029.57,-8215.89"/>
<polygon fill="black" stroke="black" points="10033.07,-8215.73 10029.57,-8205.73 10026.07,-8215.73 10033.07,-8215.73"/>
</g>
<!-- split_q_1_3 -->
<g id="node481" class="node">
<title>split_q_1_3</title>
<ellipse fill="pink" stroke="black" cx="10429.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10429.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10429.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10429.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_q_1_3 -->
<g id="edge590" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_q_1_3</title>
<path fill="none" stroke="black" d="M10783.44,-9037C10711.68,-9019.95 10617.93,-8997.67 10544.95,-8980.34"/>
<polygon fill="black" stroke="black" points="10545.33,-8976.83 10534.79,-8977.92 10543.71,-8983.64 10545.33,-8976.83"/>
</g>
<!-- split_k_1_3 -->
<g id="node482" class="node">
<title>split_k_1_3</title>
<ellipse fill="pink" stroke="black" cx="10738.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10738.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10738.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10738.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_k_1_3 -->
<g id="edge591" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_k_1_3</title>
<path fill="none" stroke="black" d="M10843.85,-9028.12C10828.31,-9017.02 10811,-9004.66 10794.97,-8993.21"/>
<polygon fill="black" stroke="black" points="10796.89,-8990.28 10786.72,-8987.31 10792.82,-8995.98 10796.89,-8990.28"/>
</g>
<!-- split_v_1_3 -->
<g id="node483" class="node">
<title>split_v_1_3</title>
<ellipse fill="pink" stroke="black" cx="11047.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11047.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11047.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11047.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_3&#45;&gt;split_v_1_3 -->
<g id="edge592" class="edge">
<title>reshape_qkv_1_3&#45;&gt;split_v_1_3</title>
<path fill="none" stroke="black" d="M10941.62,-9028.12C10957.25,-9017.02 10974.68,-9004.66 10990.81,-8993.21"/>
<polygon fill="black" stroke="black" points="10992.99,-8995.96 10999.11,-8987.31 10988.93,-8990.25 10992.99,-8995.96"/>
</g>
<!-- transpose_q_1_3 -->
<g id="node484" class="node">
<title>transpose_q_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10429.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10429.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10429.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10429.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_3&#45;&gt;transpose_q_1_3 -->
<g id="edge593" class="edge">
<title>split_q_1_3&#45;&gt;transpose_q_1_3</title>
<path fill="none" stroke="black" d="M10429.57,-8914.3C10429.57,-8905.85 10429.57,-8896.75 10429.57,-8887.94"/>
<polygon fill="black" stroke="black" points="10433.07,-8887.77 10429.57,-8877.77 10426.07,-8887.77 10433.07,-8887.77"/>
</g>
<!-- transpose_k_1_3 -->
<g id="node485" class="node">
<title>transpose_k_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10738.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10738.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10738.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10738.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_3&#45;&gt;transpose_k_1_3 -->
<g id="edge594" class="edge">
<title>split_k_1_3&#45;&gt;transpose_k_1_3</title>
<path fill="none" stroke="black" d="M10738.57,-8914.3C10738.57,-8905.85 10738.57,-8896.75 10738.57,-8887.94"/>
<polygon fill="black" stroke="black" points="10742.07,-8887.77 10738.57,-8877.77 10735.07,-8887.77 10742.07,-8887.77"/>
</g>
<!-- transpose_v_1_3 -->
<g id="node486" class="node">
<title>transpose_v_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="11047.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11047.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11047.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11047.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_3&#45;&gt;transpose_v_1_3 -->
<g id="edge595" class="edge">
<title>split_v_1_3&#45;&gt;transpose_v_1_3</title>
<path fill="none" stroke="black" d="M11047.57,-8914.3C11047.57,-8905.85 11047.57,-8896.75 11047.57,-8887.94"/>
<polygon fill="black" stroke="black" points="11051.07,-8887.77 11047.57,-8877.77 11044.07,-8887.77 11051.07,-8887.77"/>
</g>
<!-- attn_scores_1_3 -->
<g id="node487" class="node">
<title>attn_scores_1_3</title>
<ellipse fill="gold" stroke="black" cx="10631.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10631.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10631.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10631.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_3&#45;&gt;attn_scores_1_3 -->
<g id="edge596" class="edge">
<title>transpose_q_1_3&#45;&gt;attn_scores_1_3</title>
<path fill="none" stroke="black" d="M10490.45,-8805.77C10512.5,-8793.76 10537.6,-8780.1 10560.45,-8767.65"/>
<polygon fill="black" stroke="black" points="10562.31,-8770.63 10569.42,-8762.77 10558.96,-8764.48 10562.31,-8770.63"/>
</g>
<!-- transpose_k_1_3&#45;&gt;attn_scores_1_3 -->
<g id="edge597" class="edge">
<title>transpose_k_1_3&#45;&gt;attn_scores_1_3</title>
<path fill="none" stroke="black" d="M10703.83,-8803.21C10694.21,-8793.32 10683.66,-8782.47 10673.66,-8772.19"/>
<polygon fill="black" stroke="black" points="10675.99,-8769.56 10666.51,-8764.84 10670.97,-8774.44 10675.99,-8769.56"/>
</g>
<!-- attn_output_1_3 -->
<g id="node488" class="node">
<title>attn_output_1_3</title>
<ellipse fill="gold" stroke="black" cx="10631.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10631.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10631.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10631.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_3&#45;&gt;attn_output_1_3 -->
<g id="edge598" class="edge">
<title>transpose_v_1_3&#45;&gt;attn_output_1_3</title>
<path fill="none" stroke="black" d="M11022.31,-8802.76C10982.33,-8747.78 10899.5,-8642.8 10807.57,-8578.42 10784.26,-8562.1 10756.77,-8548.45 10730.52,-8537.52"/>
<polygon fill="black" stroke="black" points="10731.5,-8534.14 10720.92,-8533.62 10728.87,-8540.63 10731.5,-8534.14"/>
</g>
<!-- softmax_1_3 -->
<g id="node489" class="node">
<title>softmax_1_3</title>
<ellipse fill="gold" stroke="black" cx="10631.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10631.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10631.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10631.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_3&#45;&gt;softmax_1_3 -->
<g id="edge599" class="edge">
<title>attn_scores_1_3&#45;&gt;softmax_1_3</title>
<path fill="none" stroke="black" d="M10631.57,-8690.3C10631.57,-8681.85 10631.57,-8672.75 10631.57,-8663.94"/>
<polygon fill="black" stroke="black" points="10635.07,-8663.77 10631.57,-8653.77 10628.07,-8663.77 10635.07,-8663.77"/>
</g>
<!-- transpose_back_1_3 -->
<g id="node490" class="node">
<title>transpose_back_1_3</title>
<ellipse fill="lightgray" stroke="black" cx="10521.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10521.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10521.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10521.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_3&#45;&gt;transpose_back_1_3 -->
<g id="edge601" class="edge">
<title>attn_output_1_3&#45;&gt;transpose_back_1_3</title>
<path fill="none" stroke="black" d="M10596.16,-8467.51C10586.06,-8457.41 10574.94,-8446.29 10564.44,-8435.79"/>
<polygon fill="black" stroke="black" points="10566.84,-8433.24 10557.29,-8428.65 10561.89,-8438.19 10566.84,-8433.24"/>
</g>
<!-- softmax_1_3&#45;&gt;attn_output_1_3 -->
<g id="edge600" class="edge">
<title>softmax_1_3&#45;&gt;attn_output_1_3</title>
<path fill="none" stroke="black" d="M10631.57,-8578.3C10631.57,-8569.85 10631.57,-8560.75 10631.57,-8551.94"/>
<polygon fill="black" stroke="black" points="10635.07,-8551.77 10631.57,-8541.77 10628.07,-8551.77 10635.07,-8551.77"/>
</g>
<!-- reshape_concat_1_3 -->
<g id="node491" class="node">
<title>reshape_concat_1_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10325.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10325.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10325.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10325.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_3&#45;&gt;reshape_concat_1_3 -->
<g id="edge602" class="edge">
<title>transpose_back_1_3&#45;&gt;reshape_concat_1_3</title>
<path fill="none" stroke="black" d="M10462.24,-8357.62C10440.35,-8345.34 10415.41,-8331.34 10392.87,-8318.69"/>
<polygon fill="black" stroke="black" points="10394.47,-8315.58 10384.04,-8313.74 10391.04,-8321.68 10394.47,-8315.58"/>
</g>
<!-- reshape_concat_1_3&#45;&gt;allgather_dim_1_0 -->
<g id="edge603" class="edge">
<title>reshape_concat_1_3&#45;&gt;allgather_dim_1_0</title>
<path fill="none" stroke="black" d="M10253.54,-8248.38C10210.25,-8230.03 10155.05,-8206.63 10110.29,-8187.65"/>
<polygon fill="black" stroke="black" points="10111.47,-8184.35 10100.9,-8183.67 10108.74,-8190.79 10111.47,-8184.35"/>
</g>
<!-- output_proj_1_0 -->
<g id="node643" class="node">
<title>output_proj_1_0</title>
<ellipse fill="orange" stroke="black" cx="13361.57" cy="-7939.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13361.57" y="-7958.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13361.57" y="-7943.14" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13361.57" y="-7928.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13361.57" y="-7913.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_0&#45;&gt;output_proj_1_0 -->
<g id="edge788" class="edge">
<title>head_group_1_0&#45;&gt;output_proj_1_0</title>
<path fill="none" stroke="black" d="M11524.24,-8037.22C11841.32,-8020.5 12835.54,-7968.08 13213.64,-7948.14"/>
<polygon fill="black" stroke="black" points="13214.02,-7951.63 13223.82,-7947.6 13213.65,-7944.64 13214.02,-7951.63"/>
</g>
<!-- split_q_1_4 -->
<g id="node494" class="node">
<title>split_q_1_4</title>
<ellipse fill="pink" stroke="black" cx="11356.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11356.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11356.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11356.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_q_1_4 -->
<g id="edge606" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_q_1_4</title>
<path fill="none" stroke="black" d="M11649.64,-9034.95C11592.67,-9019.01 11521.29,-8999.03 11463.24,-8982.78"/>
<polygon fill="black" stroke="black" points="11463.88,-8979.33 11453.31,-8980 11461.99,-8986.07 11463.88,-8979.33"/>
</g>
<!-- split_k_1_4 -->
<g id="node495" class="node">
<title>split_k_1_4</title>
<ellipse fill="pink" stroke="black" cx="11665.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11665.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11665.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11665.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_k_1_4 -->
<g id="edge607" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_k_1_4</title>
<path fill="none" stroke="black" d="M11722.07,-9026.91C11714.82,-9017.41 11706.91,-9007.05 11699.37,-8997.18"/>
<polygon fill="black" stroke="black" points="11701.99,-8994.85 11693.14,-8989.02 11696.43,-8999.1 11701.99,-8994.85"/>
</g>
<!-- split_v_1_4 -->
<g id="node496" class="node">
<title>split_v_1_4</title>
<ellipse fill="pink" stroke="black" cx="11974.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11974.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11974.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11974.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_4&#45;&gt;split_v_1_4 -->
<g id="edge608" class="edge">
<title>reshape_qkv_1_4&#45;&gt;split_v_1_4</title>
<path fill="none" stroke="black" d="M11817.08,-9029.92C11842.9,-9017.3 11872.51,-9002.82 11899.03,-8989.86"/>
<polygon fill="black" stroke="black" points="11900.83,-8992.87 11908.28,-8985.34 11897.75,-8986.58 11900.83,-8992.87"/>
</g>
<!-- transpose_q_1_4 -->
<g id="node497" class="node">
<title>transpose_q_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="11356.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11356.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11356.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11356.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_4&#45;&gt;transpose_q_1_4 -->
<g id="edge609" class="edge">
<title>split_q_1_4&#45;&gt;transpose_q_1_4</title>
<path fill="none" stroke="black" d="M11356.57,-8914.3C11356.57,-8905.85 11356.57,-8896.75 11356.57,-8887.94"/>
<polygon fill="black" stroke="black" points="11360.07,-8887.77 11356.57,-8877.77 11353.07,-8887.77 11360.07,-8887.77"/>
</g>
<!-- transpose_k_1_4 -->
<g id="node498" class="node">
<title>transpose_k_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="11665.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11665.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11665.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11665.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_4&#45;&gt;transpose_k_1_4 -->
<g id="edge610" class="edge">
<title>split_k_1_4&#45;&gt;transpose_k_1_4</title>
<path fill="none" stroke="black" d="M11665.57,-8914.3C11665.57,-8905.85 11665.57,-8896.75 11665.57,-8887.94"/>
<polygon fill="black" stroke="black" points="11669.07,-8887.77 11665.57,-8877.77 11662.07,-8887.77 11669.07,-8887.77"/>
</g>
<!-- transpose_v_1_4 -->
<g id="node499" class="node">
<title>transpose_v_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="11974.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11974.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11974.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11974.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_4&#45;&gt;transpose_v_1_4 -->
<g id="edge611" class="edge">
<title>split_v_1_4&#45;&gt;transpose_v_1_4</title>
<path fill="none" stroke="black" d="M11974.57,-8914.3C11974.57,-8905.85 11974.57,-8896.75 11974.57,-8887.94"/>
<polygon fill="black" stroke="black" points="11978.07,-8887.77 11974.57,-8877.77 11971.07,-8887.77 11978.07,-8887.77"/>
</g>
<!-- attn_scores_1_4 -->
<g id="node500" class="node">
<title>attn_scores_1_4</title>
<ellipse fill="gold" stroke="black" cx="11665.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11665.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11665.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11665.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_4&#45;&gt;attn_scores_1_4 -->
<g id="edge612" class="edge">
<title>transpose_q_1_4&#45;&gt;attn_scores_1_4</title>
<path fill="none" stroke="black" d="M11440.19,-8809.16C11479.91,-8795.02 11527.6,-8778.04 11568.86,-8763.35"/>
<polygon fill="black" stroke="black" points="11570.13,-8766.62 11578.38,-8759.96 11567.79,-8760.02 11570.13,-8766.62"/>
</g>
<!-- transpose_k_1_4&#45;&gt;attn_scores_1_4 -->
<g id="edge613" class="edge">
<title>transpose_k_1_4&#45;&gt;attn_scores_1_4</title>
<path fill="none" stroke="black" d="M11665.57,-8802.3C11665.57,-8793.85 11665.57,-8784.75 11665.57,-8775.94"/>
<polygon fill="black" stroke="black" points="11669.07,-8775.77 11665.57,-8765.77 11662.07,-8775.77 11669.07,-8775.77"/>
</g>
<!-- attn_output_1_4 -->
<g id="node501" class="node">
<title>attn_output_1_4</title>
<ellipse fill="gold" stroke="black" cx="11974.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11974.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11974.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11974.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_4&#45;&gt;attn_output_1_4 -->
<g id="edge614" class="edge">
<title>transpose_v_1_4&#45;&gt;attn_output_1_4</title>
<path fill="none" stroke="black" d="M11974.57,-8802.23C11974.57,-8741.18 11974.57,-8618.87 11974.57,-8551.72"/>
<polygon fill="black" stroke="black" points="11978.07,-8551.43 11974.57,-8541.43 11971.07,-8551.43 11978.07,-8551.43"/>
</g>
<!-- softmax_1_4 -->
<g id="node502" class="node">
<title>softmax_1_4</title>
<ellipse fill="gold" stroke="black" cx="11750.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11750.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11750.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11750.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_4&#45;&gt;softmax_1_4 -->
<g id="edge615" class="edge">
<title>attn_scores_1_4&#45;&gt;softmax_1_4</title>
<path fill="none" stroke="black" d="M11693.41,-8690.91C11700.74,-8681.41 11708.75,-8671.05 11716.38,-8661.18"/>
<polygon fill="black" stroke="black" points="11719.33,-8663.08 11722.68,-8653.02 11713.79,-8658.8 11719.33,-8663.08"/>
</g>
<!-- transpose_back_1_4 -->
<g id="node503" class="node">
<title>transpose_back_1_4</title>
<ellipse fill="lightgray" stroke="black" cx="12389.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12389.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12389.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12389.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_4&#45;&gt;transpose_back_1_4 -->
<g id="edge617" class="edge">
<title>attn_output_1_4&#45;&gt;transpose_back_1_4</title>
<path fill="none" stroke="black" d="M12074.24,-8476.51C12136.4,-8460.03 12216.44,-8438.82 12280.32,-8421.88"/>
<polygon fill="black" stroke="black" points="12281.26,-8425.26 12290.03,-8419.31 12279.46,-8418.49 12281.26,-8425.26"/>
</g>
<!-- softmax_1_4&#45;&gt;attn_output_1_4 -->
<g id="edge616" class="edge">
<title>softmax_1_4&#45;&gt;attn_output_1_4</title>
<path fill="none" stroke="black" d="M11818.39,-8581.62C11843.96,-8569.07 11873.19,-8554.71 11899.4,-8541.84"/>
<polygon fill="black" stroke="black" points="11901.09,-8544.91 11908.53,-8537.36 11898.01,-8538.62 11901.09,-8544.91"/>
</g>
<!-- reshape_concat_1_4 -->
<g id="node504" class="node">
<title>reshape_concat_1_4</title>
<ellipse fill="lightcyan" stroke="black" cx="12883.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12883.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12883.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12883.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_4&#45;&gt;reshape_concat_1_4 -->
<g id="edge618" class="edge">
<title>transpose_back_1_4&#45;&gt;reshape_concat_1_4</title>
<path fill="none" stroke="black" d="M12497.98,-8366.78C12578.91,-8348.77 12689.17,-8324.21 12771.06,-8305.98"/>
<polygon fill="black" stroke="black" points="12771.9,-8309.38 12780.9,-8303.79 12770.38,-8302.54 12771.9,-8309.38"/>
</g>
<!-- allgather_dim_1_1 -->
<g id="node505" class="node">
<title>allgather_dim_1_1</title>
<polygon fill="red" stroke="black" points="13624.57,-8205.42 13451.57,-8152.42 13624.57,-8099.42 13797.57,-8152.42 13624.57,-8205.42"/>
<text text-anchor="middle" x="13624.57" y="-8163.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="13624.57" y="-8148.72" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13624.57" y="-8133.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_4&#45;&gt;allgather_dim_1_1 -->
<g id="edge619" class="edge">
<title>reshape_concat_1_4&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M12981.48,-8254.44C13000.05,-8250.16 13019.37,-8245.96 13037.57,-8242.42 13193.82,-8212.12 13375.13,-8185.99 13494.43,-8170.03"/>
<polygon fill="black" stroke="black" points="13494.9,-8173.5 13504.35,-8168.71 13493.97,-8166.56 13494.9,-8173.5"/>
</g>
<!-- head_group_1_1 -->
<g id="node542" class="node">
<title>head_group_1_1</title>
<polygon fill="lightyellow" stroke="black" points="13788.07,-8062.42 13591.07,-8062.42 13591.07,-8024.42 13788.07,-8024.42 13788.07,-8062.42"/>
<text text-anchor="middle" x="13689.57" y="-8047.22" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13689.57" y="-8032.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_1&#45;&gt;head_group_1_1 -->
<g id="edge665" class="edge">
<title>allgather_dim_1_1&#45;&gt;head_group_1_1</title>
<path fill="none" stroke="black" d="M13651.39,-8107.29C13658.82,-8095.05 13666.66,-8082.15 13673.29,-8071.23"/>
<polygon fill="black" stroke="black" points="13676.34,-8072.95 13678.54,-8062.59 13670.35,-8069.32 13676.34,-8072.95"/>
</g>
<!-- split_q_1_5 -->
<g id="node507" class="node">
<title>split_q_1_5</title>
<ellipse fill="pink" stroke="black" cx="12283.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12283.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12283.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12283.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_q_1_5 -->
<g id="edge621" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_q_1_5</title>
<path fill="none" stroke="black" d="M12637.44,-9037C12565.68,-9019.95 12471.93,-8997.67 12398.95,-8980.34"/>
<polygon fill="black" stroke="black" points="12399.33,-8976.83 12388.79,-8977.92 12397.71,-8983.64 12399.33,-8976.83"/>
</g>
<!-- split_k_1_5 -->
<g id="node508" class="node">
<title>split_k_1_5</title>
<ellipse fill="pink" stroke="black" cx="12592.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12592.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12592.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12592.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_k_1_5 -->
<g id="edge622" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_k_1_5</title>
<path fill="none" stroke="black" d="M12697.85,-9028.12C12682.31,-9017.02 12665,-9004.66 12648.97,-8993.21"/>
<polygon fill="black" stroke="black" points="12650.89,-8990.28 12640.72,-8987.31 12646.82,-8995.98 12650.89,-8990.28"/>
</g>
<!-- split_v_1_5 -->
<g id="node509" class="node">
<title>split_v_1_5</title>
<ellipse fill="pink" stroke="black" cx="12901.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12901.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12901.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12901.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_5&#45;&gt;split_v_1_5 -->
<g id="edge623" class="edge">
<title>reshape_qkv_1_5&#45;&gt;split_v_1_5</title>
<path fill="none" stroke="black" d="M12795.62,-9028.12C12811.25,-9017.02 12828.68,-9004.66 12844.81,-8993.21"/>
<polygon fill="black" stroke="black" points="12846.99,-8995.96 12853.11,-8987.31 12842.93,-8990.25 12846.99,-8995.96"/>
</g>
<!-- transpose_q_1_5 -->
<g id="node510" class="node">
<title>transpose_q_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="12283.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12283.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12283.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12283.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_5&#45;&gt;transpose_q_1_5 -->
<g id="edge624" class="edge">
<title>split_q_1_5&#45;&gt;transpose_q_1_5</title>
<path fill="none" stroke="black" d="M12283.57,-8914.3C12283.57,-8905.85 12283.57,-8896.75 12283.57,-8887.94"/>
<polygon fill="black" stroke="black" points="12287.07,-8887.77 12283.57,-8877.77 12280.07,-8887.77 12287.07,-8887.77"/>
</g>
<!-- transpose_k_1_5 -->
<g id="node511" class="node">
<title>transpose_k_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="12592.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12592.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12592.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12592.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_5&#45;&gt;transpose_k_1_5 -->
<g id="edge625" class="edge">
<title>split_k_1_5&#45;&gt;transpose_k_1_5</title>
<path fill="none" stroke="black" d="M12592.57,-8914.3C12592.57,-8905.85 12592.57,-8896.75 12592.57,-8887.94"/>
<polygon fill="black" stroke="black" points="12596.07,-8887.77 12592.57,-8877.77 12589.07,-8887.77 12596.07,-8887.77"/>
</g>
<!-- transpose_v_1_5 -->
<g id="node512" class="node">
<title>transpose_v_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="12901.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12901.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12901.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12901.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_5&#45;&gt;transpose_v_1_5 -->
<g id="edge626" class="edge">
<title>split_v_1_5&#45;&gt;transpose_v_1_5</title>
<path fill="none" stroke="black" d="M12901.57,-8914.3C12901.57,-8905.85 12901.57,-8896.75 12901.57,-8887.94"/>
<polygon fill="black" stroke="black" points="12905.07,-8887.77 12901.57,-8877.77 12898.07,-8887.77 12905.07,-8887.77"/>
</g>
<!-- attn_scores_1_5 -->
<g id="node513" class="node">
<title>attn_scores_1_5</title>
<ellipse fill="gold" stroke="black" cx="12592.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12592.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12592.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12592.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_5&#45;&gt;attn_scores_1_5 -->
<g id="edge627" class="edge">
<title>transpose_q_1_5&#45;&gt;attn_scores_1_5</title>
<path fill="none" stroke="black" d="M12367.19,-8809.16C12406.91,-8795.02 12454.6,-8778.04 12495.86,-8763.35"/>
<polygon fill="black" stroke="black" points="12497.13,-8766.62 12505.38,-8759.96 12494.79,-8760.02 12497.13,-8766.62"/>
</g>
<!-- transpose_k_1_5&#45;&gt;attn_scores_1_5 -->
<g id="edge628" class="edge">
<title>transpose_k_1_5&#45;&gt;attn_scores_1_5</title>
<path fill="none" stroke="black" d="M12592.57,-8802.3C12592.57,-8793.85 12592.57,-8784.75 12592.57,-8775.94"/>
<polygon fill="black" stroke="black" points="12596.07,-8775.77 12592.57,-8765.77 12589.07,-8775.77 12596.07,-8775.77"/>
</g>
<!-- attn_output_1_5 -->
<g id="node514" class="node">
<title>attn_output_1_5</title>
<ellipse fill="gold" stroke="black" cx="12901.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12901.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12901.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12901.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_5&#45;&gt;attn_output_1_5 -->
<g id="edge629" class="edge">
<title>transpose_v_1_5&#45;&gt;attn_output_1_5</title>
<path fill="none" stroke="black" d="M12901.57,-8802.23C12901.57,-8741.18 12901.57,-8618.87 12901.57,-8551.72"/>
<polygon fill="black" stroke="black" points="12905.07,-8551.43 12901.57,-8541.43 12898.07,-8551.43 12905.07,-8551.43"/>
</g>
<!-- softmax_1_5 -->
<g id="node515" class="node">
<title>softmax_1_5</title>
<ellipse fill="gold" stroke="black" cx="12677.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12677.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12677.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12677.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_5&#45;&gt;softmax_1_5 -->
<g id="edge630" class="edge">
<title>attn_scores_1_5&#45;&gt;softmax_1_5</title>
<path fill="none" stroke="black" d="M12620.41,-8690.91C12627.74,-8681.41 12635.75,-8671.05 12643.38,-8661.18"/>
<polygon fill="black" stroke="black" points="12646.33,-8663.08 12649.68,-8653.02 12640.79,-8658.8 12646.33,-8663.08"/>
</g>
<!-- transpose_back_1_5 -->
<g id="node516" class="node">
<title>transpose_back_1_5</title>
<ellipse fill="lightgray" stroke="black" cx="13161.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13161.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13161.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13161.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_5&#45;&gt;transpose_back_1_5 -->
<g id="edge632" class="edge">
<title>attn_output_1_5&#45;&gt;transpose_back_1_5</title>
<path fill="none" stroke="black" d="M12975.73,-8471.55C13007.56,-8458.08 13044.91,-8442.28 13077.74,-8428.39"/>
<polygon fill="black" stroke="black" points="13079.47,-8431.46 13087.32,-8424.34 13076.74,-8425.01 13079.47,-8431.46"/>
</g>
<!-- softmax_1_5&#45;&gt;attn_output_1_5 -->
<g id="edge631" class="edge">
<title>softmax_1_5&#45;&gt;attn_output_1_5</title>
<path fill="none" stroke="black" d="M12745.39,-8581.62C12770.96,-8569.07 12800.19,-8554.71 12826.4,-8541.84"/>
<polygon fill="black" stroke="black" points="12828.09,-8544.91 12835.53,-8537.36 12825.01,-8538.62 12828.09,-8544.91"/>
</g>
<!-- reshape_concat_1_5 -->
<g id="node517" class="node">
<title>reshape_concat_1_5</title>
<ellipse fill="lightcyan" stroke="black" cx="13179.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13179.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13179.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13179.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_5&#45;&gt;reshape_concat_1_5 -->
<g id="edge633" class="edge">
<title>transpose_back_1_5&#45;&gt;reshape_concat_1_5</title>
<path fill="none" stroke="black" d="M13167.57,-8354.3C13168.98,-8345.67 13170.5,-8336.36 13171.97,-8327.36"/>
<polygon fill="black" stroke="black" points="13175.44,-8327.83 13173.61,-8317.39 13168.54,-8326.7 13175.44,-8327.83"/>
</g>
<!-- reshape_concat_1_5&#45;&gt;allgather_dim_1_1 -->
<g id="edge634" class="edge">
<title>reshape_concat_1_5&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M13272.05,-8252.84C13346.26,-8231.92 13450.19,-8202.6 13525.98,-8181.23"/>
<polygon fill="black" stroke="black" points="13527.33,-8184.48 13536.01,-8178.4 13525.43,-8177.75 13527.33,-8184.48"/>
</g>
<!-- split_q_1_6 -->
<g id="node519" class="node">
<title>split_q_1_6</title>
<ellipse fill="pink" stroke="black" cx="13210.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13210.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13210.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13210.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_q_1_6 -->
<g id="edge636" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_q_1_6</title>
<path fill="none" stroke="black" d="M13565.2,-9037C13493.29,-9019.95 13399.33,-8997.67 13326.2,-8980.34"/>
<polygon fill="black" stroke="black" points="13326.56,-8976.82 13316.02,-8977.92 13324.94,-8983.64 13326.56,-8976.82"/>
</g>
<!-- split_k_1_6 -->
<g id="node520" class="node">
<title>split_k_1_6</title>
<ellipse fill="pink" stroke="black" cx="13519.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13519.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13519.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13519.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_k_1_6 -->
<g id="edge637" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_k_1_6</title>
<path fill="none" stroke="black" d="M13625.53,-9028.12C13609.9,-9017.02 13592.47,-9004.66 13576.33,-8993.21"/>
<polygon fill="black" stroke="black" points="13578.21,-8990.25 13568.03,-8987.31 13574.16,-8995.96 13578.21,-8990.25"/>
</g>
<!-- split_v_1_6 -->
<g id="node521" class="node">
<title>split_v_1_6</title>
<ellipse fill="pink" stroke="black" cx="13828.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13828.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13828.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13828.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_6&#45;&gt;split_v_1_6 -->
<g id="edge638" class="edge">
<title>reshape_qkv_1_6&#45;&gt;split_v_1_6</title>
<path fill="none" stroke="black" d="M13723.3,-9028.12C13738.83,-9017.02 13756.15,-9004.66 13772.18,-8993.21"/>
<polygon fill="black" stroke="black" points="13774.32,-8995.98 13780.43,-8987.31 13770.26,-8990.28 13774.32,-8995.98"/>
</g>
<!-- transpose_q_1_6 -->
<g id="node522" class="node">
<title>transpose_q_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13210.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13210.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13210.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13210.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_6&#45;&gt;transpose_q_1_6 -->
<g id="edge639" class="edge">
<title>split_q_1_6&#45;&gt;transpose_q_1_6</title>
<path fill="none" stroke="black" d="M13210.57,-8914.3C13210.57,-8905.85 13210.57,-8896.75 13210.57,-8887.94"/>
<polygon fill="black" stroke="black" points="13214.07,-8887.77 13210.57,-8877.77 13207.07,-8887.77 13214.07,-8887.77"/>
</g>
<!-- transpose_k_1_6 -->
<g id="node523" class="node">
<title>transpose_k_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13519.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13519.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13519.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13519.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_6&#45;&gt;transpose_k_1_6 -->
<g id="edge640" class="edge">
<title>split_k_1_6&#45;&gt;transpose_k_1_6</title>
<path fill="none" stroke="black" d="M13519.57,-8914.3C13519.57,-8905.85 13519.57,-8896.75 13519.57,-8887.94"/>
<polygon fill="black" stroke="black" points="13523.07,-8887.77 13519.57,-8877.77 13516.07,-8887.77 13523.07,-8887.77"/>
</g>
<!-- transpose_v_1_6 -->
<g id="node524" class="node">
<title>transpose_v_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13828.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13828.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13828.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13828.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_6&#45;&gt;transpose_v_1_6 -->
<g id="edge641" class="edge">
<title>split_v_1_6&#45;&gt;transpose_v_1_6</title>
<path fill="none" stroke="black" d="M13828.57,-8914.3C13828.57,-8905.85 13828.57,-8896.75 13828.57,-8887.94"/>
<polygon fill="black" stroke="black" points="13832.07,-8887.77 13828.57,-8877.77 13825.07,-8887.77 13832.07,-8887.77"/>
</g>
<!-- attn_scores_1_6 -->
<g id="node525" class="node">
<title>attn_scores_1_6</title>
<ellipse fill="gold" stroke="black" cx="13519.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13519.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13519.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13519.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_6&#45;&gt;attn_scores_1_6 -->
<g id="edge642" class="edge">
<title>transpose_q_1_6&#45;&gt;attn_scores_1_6</title>
<path fill="none" stroke="black" d="M13294.19,-8809.16C13333.91,-8795.02 13381.6,-8778.04 13422.86,-8763.35"/>
<polygon fill="black" stroke="black" points="13424.13,-8766.62 13432.38,-8759.96 13421.79,-8760.02 13424.13,-8766.62"/>
</g>
<!-- transpose_k_1_6&#45;&gt;attn_scores_1_6 -->
<g id="edge643" class="edge">
<title>transpose_k_1_6&#45;&gt;attn_scores_1_6</title>
<path fill="none" stroke="black" d="M13519.57,-8802.3C13519.57,-8793.85 13519.57,-8784.75 13519.57,-8775.94"/>
<polygon fill="black" stroke="black" points="13523.07,-8775.77 13519.57,-8765.77 13516.07,-8775.77 13523.07,-8775.77"/>
</g>
<!-- attn_output_1_6 -->
<g id="node526" class="node">
<title>attn_output_1_6</title>
<ellipse fill="gold" stroke="black" cx="13624.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13624.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13624.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13624.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_6&#45;&gt;attn_output_1_6 -->
<g id="edge644" class="edge">
<title>transpose_v_1_6&#45;&gt;attn_output_1_6</title>
<path fill="none" stroke="black" d="M13831.5,-8802.38C13833.89,-8747.86 13830.58,-8644.56 13779.57,-8578.42 13766.17,-8561.04 13747.63,-8547.58 13728.03,-8537.21"/>
<polygon fill="black" stroke="black" points="13729.47,-8534.02 13718.96,-8532.66 13726.33,-8540.28 13729.47,-8534.02"/>
</g>
<!-- softmax_1_6 -->
<g id="node527" class="node">
<title>softmax_1_6</title>
<ellipse fill="gold" stroke="black" cx="13603.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13603.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13603.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13603.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_6&#45;&gt;softmax_1_6 -->
<g id="edge645" class="edge">
<title>attn_scores_1_6&#45;&gt;softmax_1_6</title>
<path fill="none" stroke="black" d="M13547.08,-8690.91C13554.33,-8681.41 13562.24,-8671.05 13569.78,-8661.18"/>
<polygon fill="black" stroke="black" points="13572.72,-8663.1 13576.01,-8653.02 13567.16,-8658.85 13572.72,-8663.1"/>
</g>
<!-- transpose_back_1_6 -->
<g id="node528" class="node">
<title>transpose_back_1_6</title>
<ellipse fill="lightgray" stroke="black" cx="13624.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13624.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13624.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13624.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_6&#45;&gt;transpose_back_1_6 -->
<g id="edge647" class="edge">
<title>attn_output_1_6&#45;&gt;transpose_back_1_6</title>
<path fill="none" stroke="black" d="M13624.57,-8466.3C13624.57,-8457.85 13624.57,-8448.75 13624.57,-8439.94"/>
<polygon fill="black" stroke="black" points="13628.07,-8439.77 13624.57,-8429.77 13621.07,-8439.77 13628.07,-8439.77"/>
</g>
<!-- softmax_1_6&#45;&gt;attn_output_1_6 -->
<g id="edge646" class="edge">
<title>softmax_1_6&#45;&gt;attn_output_1_6</title>
<path fill="none" stroke="black" d="M13610.57,-8578.3C13612.21,-8569.67 13613.99,-8560.36 13615.71,-8551.36"/>
<polygon fill="black" stroke="black" points="13619.17,-8551.87 13617.61,-8541.39 13612.3,-8550.56 13619.17,-8551.87"/>
</g>
<!-- reshape_concat_1_6 -->
<g id="node529" class="node">
<title>reshape_concat_1_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13624.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13624.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13624.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13624.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_6&#45;&gt;reshape_concat_1_6 -->
<g id="edge648" class="edge">
<title>transpose_back_1_6&#45;&gt;reshape_concat_1_6</title>
<path fill="none" stroke="black" d="M13624.57,-8354.3C13624.57,-8345.85 13624.57,-8336.75 13624.57,-8327.94"/>
<polygon fill="black" stroke="black" points="13628.07,-8327.77 13624.57,-8317.77 13621.07,-8327.77 13628.07,-8327.77"/>
</g>
<!-- reshape_concat_1_6&#45;&gt;allgather_dim_1_1 -->
<g id="edge649" class="edge">
<title>reshape_concat_1_6&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M13624.57,-8242.29C13624.57,-8233.98 13624.57,-8224.93 13624.57,-8215.89"/>
<polygon fill="black" stroke="black" points="13628.07,-8215.73 13624.57,-8205.73 13621.07,-8215.73 13628.07,-8215.73"/>
</g>
<!-- split_q_1_7 -->
<g id="node531" class="node">
<title>split_q_1_7</title>
<ellipse fill="pink" stroke="black" cx="14137.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14137.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14137.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14137.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_q_1_7 -->
<g id="edge651" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_q_1_7</title>
<path fill="none" stroke="black" d="M14492.2,-9037C14420.29,-9019.95 14326.33,-8997.67 14253.2,-8980.34"/>
<polygon fill="black" stroke="black" points="14253.56,-8976.82 14243.02,-8977.92 14251.94,-8983.64 14253.56,-8976.82"/>
</g>
<!-- split_k_1_7 -->
<g id="node532" class="node">
<title>split_k_1_7</title>
<ellipse fill="pink" stroke="black" cx="14446.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14446.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14446.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14446.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_k_1_7 -->
<g id="edge652" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_k_1_7</title>
<path fill="none" stroke="black" d="M14552.53,-9028.12C14536.9,-9017.02 14519.47,-9004.66 14503.33,-8993.21"/>
<polygon fill="black" stroke="black" points="14505.21,-8990.25 14495.03,-8987.31 14501.16,-8995.96 14505.21,-8990.25"/>
</g>
<!-- split_v_1_7 -->
<g id="node533" class="node">
<title>split_v_1_7</title>
<ellipse fill="pink" stroke="black" cx="14755.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14755.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14755.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14755.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_7&#45;&gt;split_v_1_7 -->
<g id="edge653" class="edge">
<title>reshape_qkv_1_7&#45;&gt;split_v_1_7</title>
<path fill="none" stroke="black" d="M14650.3,-9028.12C14665.83,-9017.02 14683.15,-9004.66 14699.18,-8993.21"/>
<polygon fill="black" stroke="black" points="14701.32,-8995.98 14707.43,-8987.31 14697.26,-8990.28 14701.32,-8995.98"/>
</g>
<!-- transpose_q_1_7 -->
<g id="node534" class="node">
<title>transpose_q_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14137.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14137.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14137.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14137.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_7&#45;&gt;transpose_q_1_7 -->
<g id="edge654" class="edge">
<title>split_q_1_7&#45;&gt;transpose_q_1_7</title>
<path fill="none" stroke="black" d="M14137.57,-8914.3C14137.57,-8905.85 14137.57,-8896.75 14137.57,-8887.94"/>
<polygon fill="black" stroke="black" points="14141.07,-8887.77 14137.57,-8877.77 14134.07,-8887.77 14141.07,-8887.77"/>
</g>
<!-- transpose_k_1_7 -->
<g id="node535" class="node">
<title>transpose_k_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14446.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14446.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14446.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14446.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_7&#45;&gt;transpose_k_1_7 -->
<g id="edge655" class="edge">
<title>split_k_1_7&#45;&gt;transpose_k_1_7</title>
<path fill="none" stroke="black" d="M14446.57,-8914.3C14446.57,-8905.85 14446.57,-8896.75 14446.57,-8887.94"/>
<polygon fill="black" stroke="black" points="14450.07,-8887.77 14446.57,-8877.77 14443.07,-8887.77 14450.07,-8887.77"/>
</g>
<!-- transpose_v_1_7 -->
<g id="node536" class="node">
<title>transpose_v_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14755.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14755.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14755.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14755.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_7&#45;&gt;transpose_v_1_7 -->
<g id="edge656" class="edge">
<title>split_v_1_7&#45;&gt;transpose_v_1_7</title>
<path fill="none" stroke="black" d="M14755.57,-8914.3C14755.57,-8905.85 14755.57,-8896.75 14755.57,-8887.94"/>
<polygon fill="black" stroke="black" points="14759.07,-8887.77 14755.57,-8877.77 14752.07,-8887.77 14759.07,-8887.77"/>
</g>
<!-- attn_scores_1_7 -->
<g id="node537" class="node">
<title>attn_scores_1_7</title>
<ellipse fill="gold" stroke="black" cx="14445.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14445.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14445.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14445.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_7&#45;&gt;attn_scores_1_7 -->
<g id="edge657" class="edge">
<title>transpose_q_1_7&#45;&gt;attn_scores_1_7</title>
<path fill="none" stroke="black" d="M14220.92,-8809.16C14260.51,-8795.02 14308.04,-8778.04 14349.17,-8763.35"/>
<polygon fill="black" stroke="black" points="14350.42,-8766.62 14358.66,-8759.96 14348.07,-8760.03 14350.42,-8766.62"/>
</g>
<!-- transpose_k_1_7&#45;&gt;attn_scores_1_7 -->
<g id="edge658" class="edge">
<title>transpose_k_1_7&#45;&gt;attn_scores_1_7</title>
<path fill="none" stroke="black" d="M14446.24,-8802.3C14446.16,-8793.85 14446.08,-8784.75 14446,-8775.94"/>
<polygon fill="black" stroke="black" points="14449.5,-8775.74 14445.91,-8765.77 14442.5,-8775.8 14449.5,-8775.74"/>
</g>
<!-- attn_output_1_7 -->
<g id="node538" class="node">
<title>attn_output_1_7</title>
<ellipse fill="gold" stroke="black" cx="14445.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14445.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14445.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14445.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_7&#45;&gt;attn_output_1_7 -->
<g id="edge659" class="edge">
<title>transpose_v_1_7&#45;&gt;attn_output_1_7</title>
<path fill="none" stroke="black" d="M14745.64,-8802.41C14728.83,-8746.97 14689.76,-8641.4 14621.57,-8578.42 14602.05,-8560.4 14577.48,-8546.45 14552.93,-8535.79"/>
<polygon fill="black" stroke="black" points="14554.11,-8532.49 14543.54,-8531.87 14551.41,-8538.95 14554.11,-8532.49"/>
</g>
<!-- softmax_1_7 -->
<g id="node539" class="node">
<title>softmax_1_7</title>
<ellipse fill="gold" stroke="black" cx="14445.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14445.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14445.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14445.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_7&#45;&gt;softmax_1_7 -->
<g id="edge660" class="edge">
<title>attn_scores_1_7&#45;&gt;softmax_1_7</title>
<path fill="none" stroke="black" d="M14445.57,-8690.3C14445.57,-8681.85 14445.57,-8672.75 14445.57,-8663.94"/>
<polygon fill="black" stroke="black" points="14449.07,-8663.77 14445.57,-8653.77 14442.07,-8663.77 14449.07,-8663.77"/>
</g>
<!-- transpose_back_1_7 -->
<g id="node540" class="node">
<title>transpose_back_1_7</title>
<ellipse fill="lightgray" stroke="black" cx="14218.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14218.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14218.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14218.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_7&#45;&gt;transpose_back_1_7 -->
<g id="edge662" class="edge">
<title>attn_output_1_7&#45;&gt;transpose_back_1_7</title>
<path fill="none" stroke="black" d="M14378.69,-8470.52C14352.26,-8457.71 14321.74,-8442.92 14294.48,-8429.71"/>
<polygon fill="black" stroke="black" points="14295.89,-8426.5 14285.37,-8425.29 14292.84,-8432.8 14295.89,-8426.5"/>
</g>
<!-- softmax_1_7&#45;&gt;attn_output_1_7 -->
<g id="edge661" class="edge">
<title>softmax_1_7&#45;&gt;attn_output_1_7</title>
<path fill="none" stroke="black" d="M14445.57,-8578.3C14445.57,-8569.85 14445.57,-8560.75 14445.57,-8551.94"/>
<polygon fill="black" stroke="black" points="14449.07,-8551.77 14445.57,-8541.77 14442.07,-8551.77 14449.07,-8551.77"/>
</g>
<!-- reshape_concat_1_7 -->
<g id="node541" class="node">
<title>reshape_concat_1_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14101.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14101.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14101.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14101.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_7&#45;&gt;reshape_concat_1_7 -->
<g id="edge663" class="edge">
<title>transpose_back_1_7&#45;&gt;reshape_concat_1_7</title>
<path fill="none" stroke="black" d="M14180.91,-8355.51C14169.95,-8345.21 14157.87,-8333.85 14146.51,-8323.17"/>
<polygon fill="black" stroke="black" points="14148.85,-8320.57 14139.17,-8316.27 14144.05,-8325.67 14148.85,-8320.57"/>
</g>
<!-- reshape_concat_1_7&#45;&gt;allgather_dim_1_1 -->
<g id="edge664" class="edge">
<title>reshape_concat_1_7&#45;&gt;allgather_dim_1_1</title>
<path fill="none" stroke="black" d="M14005.91,-8253.75C13924.76,-8232.4 13808.69,-8201.87 13725.95,-8180.1"/>
<polygon fill="black" stroke="black" points="13726.6,-8176.65 13716.03,-8177.49 13724.82,-8183.42 13726.6,-8176.65"/>
</g>
<!-- output_proj_1_1 -->
<g id="node644" class="node">
<title>output_proj_1_1</title>
<ellipse fill="orange" stroke="black" cx="14060.57" cy="-7939.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14060.57" y="-7958.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14060.57" y="-7943.14" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14060.57" y="-7928.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14060.57" y="-7913.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_1&#45;&gt;output_proj_1_1 -->
<g id="edge789" class="edge">
<title>head_group_1_1&#45;&gt;output_proj_1_1</title>
<path fill="none" stroke="black" d="M13755.05,-8024.41C13806.98,-8010.12 13880.9,-7989.78 13943.03,-7972.68"/>
<polygon fill="black" stroke="black" points="13944.18,-7976 13952.89,-7969.97 13942.32,-7969.25 13944.18,-7976"/>
</g>
<!-- split_q_1_8 -->
<g id="node544" class="node">
<title>split_q_1_8</title>
<ellipse fill="pink" stroke="black" cx="15064.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15064.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15064.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15064.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_q_1_8 -->
<g id="edge667" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_q_1_8</title>
<path fill="none" stroke="black" d="M15199.05,-9029.17C15178,-9017.24 15154.17,-9003.73 15132.48,-8991.43"/>
<polygon fill="black" stroke="black" points="15134.08,-8988.31 15123.65,-8986.42 15130.62,-8994.4 15134.08,-8988.31"/>
</g>
<!-- split_k_1_8 -->
<g id="node545" class="node">
<title>split_k_1_8</title>
<ellipse fill="pink" stroke="black" cx="15373.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15373.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15373.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15373.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_k_1_8 -->
<g id="edge668" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_k_1_8</title>
<path fill="none" stroke="black" d="M15295.91,-9027.21C15306.46,-9017.12 15318.05,-9006.03 15328.98,-8995.58"/>
<polygon fill="black" stroke="black" points="15331.62,-8997.9 15336.42,-8988.46 15326.78,-8992.84 15331.62,-8997.9"/>
</g>
<!-- split_v_1_8 -->
<g id="node546" class="node">
<title>split_v_1_8</title>
<ellipse fill="pink" stroke="black" cx="15682.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15682.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15682.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15682.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_8&#45;&gt;split_v_1_8 -->
<g id="edge669" class="edge">
<title>reshape_qkv_1_8&#45;&gt;split_v_1_8</title>
<path fill="none" stroke="black" d="M15362.84,-9035.87C15426.28,-9019.42 15507.24,-8998.41 15571.83,-8981.66"/>
<polygon fill="black" stroke="black" points="15572.84,-8985.01 15581.64,-8979.11 15571.08,-8978.23 15572.84,-8985.01"/>
</g>
<!-- transpose_q_1_8 -->
<g id="node547" class="node">
<title>transpose_q_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15064.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15064.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15064.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15064.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_8&#45;&gt;transpose_q_1_8 -->
<g id="edge670" class="edge">
<title>split_q_1_8&#45;&gt;transpose_q_1_8</title>
<path fill="none" stroke="black" d="M15064.57,-8914.3C15064.57,-8905.85 15064.57,-8896.75 15064.57,-8887.94"/>
<polygon fill="black" stroke="black" points="15068.07,-8887.77 15064.57,-8877.77 15061.07,-8887.77 15068.07,-8887.77"/>
</g>
<!-- transpose_k_1_8 -->
<g id="node548" class="node">
<title>transpose_k_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15373.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15373.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15373.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15373.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_8&#45;&gt;transpose_k_1_8 -->
<g id="edge671" class="edge">
<title>split_k_1_8&#45;&gt;transpose_k_1_8</title>
<path fill="none" stroke="black" d="M15373.57,-8914.3C15373.57,-8905.85 15373.57,-8896.75 15373.57,-8887.94"/>
<polygon fill="black" stroke="black" points="15377.07,-8887.77 15373.57,-8877.77 15370.07,-8887.77 15377.07,-8887.77"/>
</g>
<!-- transpose_v_1_8 -->
<g id="node549" class="node">
<title>transpose_v_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15682.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15682.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15682.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15682.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_8&#45;&gt;transpose_v_1_8 -->
<g id="edge672" class="edge">
<title>split_v_1_8&#45;&gt;transpose_v_1_8</title>
<path fill="none" stroke="black" d="M15682.57,-8914.3C15682.57,-8905.85 15682.57,-8896.75 15682.57,-8887.94"/>
<polygon fill="black" stroke="black" points="15686.07,-8887.77 15682.57,-8877.77 15679.07,-8887.77 15686.07,-8887.77"/>
</g>
<!-- attn_scores_1_8 -->
<g id="node550" class="node">
<title>attn_scores_1_8</title>
<ellipse fill="gold" stroke="black" cx="15373.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15373.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15373.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15373.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_8&#45;&gt;attn_scores_1_8 -->
<g id="edge673" class="edge">
<title>transpose_q_1_8&#45;&gt;attn_scores_1_8</title>
<path fill="none" stroke="black" d="M15148.19,-8809.16C15187.91,-8795.02 15235.6,-8778.04 15276.86,-8763.35"/>
<polygon fill="black" stroke="black" points="15278.13,-8766.62 15286.38,-8759.96 15275.79,-8760.02 15278.13,-8766.62"/>
</g>
<!-- transpose_k_1_8&#45;&gt;attn_scores_1_8 -->
<g id="edge674" class="edge">
<title>transpose_k_1_8&#45;&gt;attn_scores_1_8</title>
<path fill="none" stroke="black" d="M15373.57,-8802.3C15373.57,-8793.85 15373.57,-8784.75 15373.57,-8775.94"/>
<polygon fill="black" stroke="black" points="15377.07,-8775.77 15373.57,-8765.77 15370.07,-8775.77 15377.07,-8775.77"/>
</g>
<!-- attn_output_1_8 -->
<g id="node551" class="node">
<title>attn_output_1_8</title>
<ellipse fill="gold" stroke="black" cx="15682.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15682.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15682.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15682.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_8&#45;&gt;attn_output_1_8 -->
<g id="edge675" class="edge">
<title>transpose_v_1_8&#45;&gt;attn_output_1_8</title>
<path fill="none" stroke="black" d="M15682.57,-8802.23C15682.57,-8741.18 15682.57,-8618.87 15682.57,-8551.72"/>
<polygon fill="black" stroke="black" points="15686.07,-8551.43 15682.57,-8541.43 15679.07,-8551.43 15686.07,-8551.43"/>
</g>
<!-- softmax_1_8 -->
<g id="node552" class="node">
<title>softmax_1_8</title>
<ellipse fill="gold" stroke="black" cx="15458.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15458.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15458.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15458.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_8&#45;&gt;softmax_1_8 -->
<g id="edge676" class="edge">
<title>attn_scores_1_8&#45;&gt;softmax_1_8</title>
<path fill="none" stroke="black" d="M15401.41,-8690.91C15408.74,-8681.41 15416.75,-8671.05 15424.38,-8661.18"/>
<polygon fill="black" stroke="black" points="15427.33,-8663.08 15430.68,-8653.02 15421.79,-8658.8 15427.33,-8663.08"/>
</g>
<!-- transpose_back_1_8 -->
<g id="node553" class="node">
<title>transpose_back_1_8</title>
<ellipse fill="lightgray" stroke="black" cx="15851.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15851.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="15851.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15851.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_8&#45;&gt;transpose_back_1_8 -->
<g id="edge678" class="edge">
<title>attn_output_1_8&#45;&gt;transpose_back_1_8</title>
<path fill="none" stroke="black" d="M15735.12,-8468.72C15752.61,-8457.34 15772.23,-8444.57 15790.32,-8432.79"/>
<polygon fill="black" stroke="black" points="15792.59,-8435.49 15799.06,-8427.11 15788.77,-8429.63 15792.59,-8435.49"/>
</g>
<!-- softmax_1_8&#45;&gt;attn_output_1_8 -->
<g id="edge677" class="edge">
<title>softmax_1_8&#45;&gt;attn_output_1_8</title>
<path fill="none" stroke="black" d="M15526.39,-8581.62C15551.96,-8569.07 15581.19,-8554.71 15607.4,-8541.84"/>
<polygon fill="black" stroke="black" points="15609.09,-8544.91 15616.53,-8537.36 15606.01,-8538.62 15609.09,-8544.91"/>
</g>
<!-- reshape_concat_1_8 -->
<g id="node554" class="node">
<title>reshape_concat_1_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16098.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16098.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16098.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16098.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_8&#45;&gt;reshape_concat_1_8 -->
<g id="edge679" class="edge">
<title>transpose_back_1_8&#45;&gt;reshape_concat_1_8</title>
<path fill="none" stroke="black" d="M15923.02,-8359.11C15953.23,-8345.65 15988.53,-8329.93 16019.53,-8316.13"/>
<polygon fill="black" stroke="black" points="16021.28,-8319.18 16028.99,-8311.91 16018.44,-8312.78 16021.28,-8319.18"/>
</g>
<!-- allgather_dim_1_2 -->
<g id="node555" class="node">
<title>allgather_dim_1_2</title>
<polygon fill="red" stroke="black" points="16601.57,-8205.42 16428.57,-8152.42 16601.57,-8099.42 16774.57,-8152.42 16601.57,-8205.42"/>
<text text-anchor="middle" x="16601.57" y="-8163.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="16601.57" y="-8148.72" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16601.57" y="-8133.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_8&#45;&gt;allgather_dim_1_2 -->
<g id="edge680" class="edge">
<title>reshape_concat_1_8&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16196.45,-8254.5C16283.23,-8232.85 16409.55,-8201.34 16498,-8179.27"/>
<polygon fill="black" stroke="black" points="16498.93,-8182.64 16507.78,-8176.83 16497.23,-8175.85 16498.93,-8182.64"/>
</g>
<!-- head_group_1_2 -->
<g id="node592" class="node">
<title>head_group_1_2</title>
<polygon fill="lightyellow" stroke="black" points="16687.07,-8062.42 16490.07,-8062.42 16490.07,-8024.42 16687.07,-8024.42 16687.07,-8062.42"/>
<text text-anchor="middle" x="16588.57" y="-8047.22" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16588.57" y="-8032.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_2&#45;&gt;head_group_1_2 -->
<g id="edge726" class="edge">
<title>allgather_dim_1_2&#45;&gt;head_group_1_2</title>
<path fill="none" stroke="black" d="M16595.45,-8101.06C16594.26,-8091.27 16593.06,-8081.34 16592,-8072.59"/>
<polygon fill="black" stroke="black" points="16595.46,-8072.09 16590.78,-8062.59 16588.51,-8072.93 16595.46,-8072.09"/>
</g>
<!-- split_q_1_9 -->
<g id="node557" class="node">
<title>split_q_1_9</title>
<ellipse fill="pink" stroke="black" cx="15991.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15991.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15991.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15991.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_q_1_9 -->
<g id="edge682" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_q_1_9</title>
<path fill="none" stroke="black" d="M16047.4,-9026.91C16040.23,-9017.41 16032.42,-9007.05 16024.96,-8997.18"/>
<polygon fill="black" stroke="black" points="16027.63,-8994.9 16018.81,-8989.02 16022.04,-8999.11 16027.63,-8994.9"/>
</g>
<!-- split_k_1_9 -->
<g id="node558" class="node">
<title>split_k_1_9</title>
<ellipse fill="pink" stroke="black" cx="16300.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16300.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16300.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16300.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_k_1_9 -->
<g id="edge683" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_k_1_9</title>
<path fill="none" stroke="black" d="M16142.07,-9030.07C16168.02,-9017.44 16197.81,-9002.94 16224.51,-8989.95"/>
<polygon fill="black" stroke="black" points="16226.35,-8992.94 16233.81,-8985.42 16223.29,-8986.65 16226.35,-8992.94"/>
</g>
<!-- split_v_1_9 -->
<g id="node559" class="node">
<title>split_v_1_9</title>
<ellipse fill="pink" stroke="black" cx="16609.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16609.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16609.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16609.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_9&#45;&gt;split_v_1_9 -->
<g id="edge684" class="edge">
<title>reshape_qkv_1_9&#45;&gt;split_v_1_9</title>
<path fill="none" stroke="black" d="M16197.52,-9040.57C16272.29,-9026.63 16369.62,-9007.89 16455.57,-8989.42 16468.54,-8986.64 16482.1,-8983.6 16495.56,-8980.52"/>
<polygon fill="black" stroke="black" points="16496.37,-8983.92 16505.33,-8978.26 16494.8,-8977.1 16496.37,-8983.92"/>
</g>
<!-- transpose_q_1_9 -->
<g id="node560" class="node">
<title>transpose_q_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="15991.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15991.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15991.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15991.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_9&#45;&gt;transpose_q_1_9 -->
<g id="edge685" class="edge">
<title>split_q_1_9&#45;&gt;transpose_q_1_9</title>
<path fill="none" stroke="black" d="M15991.57,-8914.3C15991.57,-8905.85 15991.57,-8896.75 15991.57,-8887.94"/>
<polygon fill="black" stroke="black" points="15995.07,-8887.77 15991.57,-8877.77 15988.07,-8887.77 15995.07,-8887.77"/>
</g>
<!-- transpose_k_1_9 -->
<g id="node561" class="node">
<title>transpose_k_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16300.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16300.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16300.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16300.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_9&#45;&gt;transpose_k_1_9 -->
<g id="edge686" class="edge">
<title>split_k_1_9&#45;&gt;transpose_k_1_9</title>
<path fill="none" stroke="black" d="M16300.57,-8914.3C16300.57,-8905.85 16300.57,-8896.75 16300.57,-8887.94"/>
<polygon fill="black" stroke="black" points="16304.07,-8887.77 16300.57,-8877.77 16297.07,-8887.77 16304.07,-8887.77"/>
</g>
<!-- transpose_v_1_9 -->
<g id="node562" class="node">
<title>transpose_v_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16609.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16609.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16609.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16609.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_9&#45;&gt;transpose_v_1_9 -->
<g id="edge687" class="edge">
<title>split_v_1_9&#45;&gt;transpose_v_1_9</title>
<path fill="none" stroke="black" d="M16609.57,-8914.3C16609.57,-8905.85 16609.57,-8896.75 16609.57,-8887.94"/>
<polygon fill="black" stroke="black" points="16613.07,-8887.77 16609.57,-8877.77 16606.07,-8887.77 16613.07,-8887.77"/>
</g>
<!-- attn_scores_1_9 -->
<g id="node563" class="node">
<title>attn_scores_1_9</title>
<ellipse fill="gold" stroke="black" cx="16300.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16300.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16300.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16300.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_9&#45;&gt;attn_scores_1_9 -->
<g id="edge688" class="edge">
<title>transpose_q_1_9&#45;&gt;attn_scores_1_9</title>
<path fill="none" stroke="black" d="M16075.19,-8809.16C16114.91,-8795.02 16162.6,-8778.04 16203.86,-8763.35"/>
<polygon fill="black" stroke="black" points="16205.13,-8766.62 16213.38,-8759.96 16202.79,-8760.02 16205.13,-8766.62"/>
</g>
<!-- transpose_k_1_9&#45;&gt;attn_scores_1_9 -->
<g id="edge689" class="edge">
<title>transpose_k_1_9&#45;&gt;attn_scores_1_9</title>
<path fill="none" stroke="black" d="M16300.57,-8802.3C16300.57,-8793.85 16300.57,-8784.75 16300.57,-8775.94"/>
<polygon fill="black" stroke="black" points="16304.07,-8775.77 16300.57,-8765.77 16297.07,-8775.77 16304.07,-8775.77"/>
</g>
<!-- attn_output_1_9 -->
<g id="node564" class="node">
<title>attn_output_1_9</title>
<ellipse fill="gold" stroke="black" cx="16601.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16601.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16601.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16601.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_9&#45;&gt;attn_output_1_9 -->
<g id="edge690" class="edge">
<title>transpose_v_1_9&#45;&gt;attn_output_1_9</title>
<path fill="none" stroke="black" d="M16608.69,-8802.23C16607.23,-8741.18 16604.3,-8618.87 16602.69,-8551.72"/>
<polygon fill="black" stroke="black" points="16606.19,-8551.34 16602.45,-8541.43 16599.19,-8551.51 16606.19,-8551.34"/>
</g>
<!-- softmax_1_9 -->
<g id="node565" class="node">
<title>softmax_1_9</title>
<ellipse fill="gold" stroke="black" cx="16385.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16385.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16385.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16385.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_9&#45;&gt;softmax_1_9 -->
<g id="edge691" class="edge">
<title>attn_scores_1_9&#45;&gt;softmax_1_9</title>
<path fill="none" stroke="black" d="M16328.41,-8690.91C16335.74,-8681.41 16343.75,-8671.05 16351.38,-8661.18"/>
<polygon fill="black" stroke="black" points="16354.33,-8663.08 16357.68,-8653.02 16348.79,-8658.8 16354.33,-8663.08"/>
</g>
<!-- transpose_back_1_9 -->
<g id="node566" class="node">
<title>transpose_back_1_9</title>
<ellipse fill="lightgray" stroke="black" cx="16601.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16601.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16601.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16601.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_9&#45;&gt;transpose_back_1_9 -->
<g id="edge693" class="edge">
<title>attn_output_1_9&#45;&gt;transpose_back_1_9</title>
<path fill="none" stroke="black" d="M16601.57,-8466.3C16601.57,-8457.85 16601.57,-8448.75 16601.57,-8439.94"/>
<polygon fill="black" stroke="black" points="16605.07,-8439.77 16601.57,-8429.77 16598.07,-8439.77 16605.07,-8439.77"/>
</g>
<!-- softmax_1_9&#45;&gt;attn_output_1_9 -->
<g id="edge692" class="edge">
<title>softmax_1_9&#45;&gt;attn_output_1_9</title>
<path fill="none" stroke="black" d="M16451.55,-8581.32C16475.75,-8569 16503.29,-8554.98 16528.1,-8542.34"/>
<polygon fill="black" stroke="black" points="16529.79,-8545.41 16537.11,-8537.75 16526.61,-8539.17 16529.79,-8545.41"/>
</g>
<!-- reshape_concat_1_9 -->
<g id="node567" class="node">
<title>reshape_concat_1_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16601.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16601.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16601.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16601.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_9&#45;&gt;reshape_concat_1_9 -->
<g id="edge694" class="edge">
<title>transpose_back_1_9&#45;&gt;reshape_concat_1_9</title>
<path fill="none" stroke="black" d="M16601.57,-8354.3C16601.57,-8345.85 16601.57,-8336.75 16601.57,-8327.94"/>
<polygon fill="black" stroke="black" points="16605.07,-8327.77 16601.57,-8317.77 16598.07,-8327.77 16605.07,-8327.77"/>
</g>
<!-- reshape_concat_1_9&#45;&gt;allgather_dim_1_2 -->
<g id="edge695" class="edge">
<title>reshape_concat_1_9&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16601.57,-8242.29C16601.57,-8233.98 16601.57,-8224.93 16601.57,-8215.89"/>
<polygon fill="black" stroke="black" points="16605.07,-8215.73 16601.57,-8205.73 16598.07,-8215.73 16605.07,-8215.73"/>
</g>
<!-- split_q_1_10 -->
<g id="node569" class="node">
<title>split_q_1_10</title>
<ellipse fill="pink" stroke="black" cx="16918.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16918.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16918.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16918.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_q_1_10 -->
<g id="edge697" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_q_1_10</title>
<path fill="none" stroke="black" d="M16954.07,-9026.6C16949.73,-9017.59 16945.02,-9007.82 16940.5,-8998.43"/>
<polygon fill="black" stroke="black" points="16943.55,-8996.7 16936.06,-8989.21 16937.24,-8999.74 16943.55,-8996.7"/>
</g>
<!-- split_k_1_10 -->
<g id="node570" class="node">
<title>split_k_1_10</title>
<ellipse fill="pink" stroke="black" cx="17227.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17227.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17227.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17227.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_k_1_10 -->
<g id="edge698" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_k_1_10</title>
<path fill="none" stroke="black" d="M17046.31,-9030.81C17077.2,-9017.54 17113.13,-9002.1 17144.82,-8988.48"/>
<polygon fill="black" stroke="black" points="17146.27,-8991.67 17154.07,-8984.51 17143.5,-8985.24 17146.27,-8991.67"/>
</g>
<!-- split_v_1_10 -->
<g id="node571" class="node">
<title>split_v_1_10</title>
<ellipse fill="pink" stroke="black" cx="17536.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17536.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17536.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17536.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_10&#45;&gt;split_v_1_10 -->
<g id="edge699" class="edge">
<title>reshape_qkv_1_10&#45;&gt;split_v_1_10</title>
<path fill="none" stroke="black" d="M17098.75,-9042.06C17180.13,-9028.25 17287.83,-9009.11 17382.57,-8989.42 17395.67,-8986.7 17409.36,-8983.7 17422.93,-8980.61"/>
<polygon fill="black" stroke="black" points="17423.82,-8984 17432.79,-8978.36 17422.26,-8977.18 17423.82,-8984"/>
</g>
<!-- transpose_q_1_10 -->
<g id="node572" class="node">
<title>transpose_q_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="16918.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16918.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16918.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16918.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_10&#45;&gt;transpose_q_1_10 -->
<g id="edge700" class="edge">
<title>split_q_1_10&#45;&gt;transpose_q_1_10</title>
<path fill="none" stroke="black" d="M16918.57,-8914.3C16918.57,-8905.85 16918.57,-8896.75 16918.57,-8887.94"/>
<polygon fill="black" stroke="black" points="16922.07,-8887.77 16918.57,-8877.77 16915.07,-8887.77 16922.07,-8887.77"/>
</g>
<!-- transpose_k_1_10 -->
<g id="node573" class="node">
<title>transpose_k_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17227.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17227.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17227.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17227.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_10&#45;&gt;transpose_k_1_10 -->
<g id="edge701" class="edge">
<title>split_k_1_10&#45;&gt;transpose_k_1_10</title>
<path fill="none" stroke="black" d="M17227.57,-8914.3C17227.57,-8905.85 17227.57,-8896.75 17227.57,-8887.94"/>
<polygon fill="black" stroke="black" points="17231.07,-8887.77 17227.57,-8877.77 17224.07,-8887.77 17231.07,-8887.77"/>
</g>
<!-- transpose_v_1_10 -->
<g id="node574" class="node">
<title>transpose_v_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="17536.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17536.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17536.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17536.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_10&#45;&gt;transpose_v_1_10 -->
<g id="edge702" class="edge">
<title>split_v_1_10&#45;&gt;transpose_v_1_10</title>
<path fill="none" stroke="black" d="M17536.57,-8914.3C17536.57,-8905.85 17536.57,-8896.75 17536.57,-8887.94"/>
<polygon fill="black" stroke="black" points="17540.07,-8887.77 17536.57,-8877.77 17533.07,-8887.77 17540.07,-8887.77"/>
</g>
<!-- attn_scores_1_10 -->
<g id="node575" class="node">
<title>attn_scores_1_10</title>
<ellipse fill="gold" stroke="black" cx="16922.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16922.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16922.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16922.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_10&#45;&gt;attn_scores_1_10 -->
<g id="edge703" class="edge">
<title>transpose_q_1_10&#45;&gt;attn_scores_1_10</title>
<path fill="none" stroke="black" d="M16919.91,-8802.3C16920.21,-8793.85 16920.54,-8784.75 16920.86,-8775.94"/>
<polygon fill="black" stroke="black" points="16924.37,-8775.89 16921.23,-8765.77 16917.37,-8775.63 16924.37,-8775.89"/>
</g>
<!-- transpose_k_1_10&#45;&gt;attn_scores_1_10 -->
<g id="edge704" class="edge">
<title>transpose_k_1_10&#45;&gt;attn_scores_1_10</title>
<path fill="none" stroke="black" d="M17144.63,-8809.01C17105.68,-8794.96 17059.03,-8778.14 17018.56,-8763.54"/>
<polygon fill="black" stroke="black" points="17019.55,-8760.18 17008.96,-8760.08 17017.18,-8766.76 17019.55,-8760.18"/>
</g>
<!-- attn_output_1_10 -->
<g id="node576" class="node">
<title>attn_output_1_10</title>
<ellipse fill="gold" stroke="black" cx="16922.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16922.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16922.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16922.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_10&#45;&gt;attn_output_1_10 -->
<g id="edge705" class="edge">
<title>transpose_v_1_10&#45;&gt;attn_output_1_10</title>
<path fill="none" stroke="black" d="M17484.66,-8804.78C17404,-8752.48 17242.82,-8650.98 17098.57,-8578.42 17070.8,-8564.45 17039.73,-8550.84 17011.51,-8539.21"/>
<polygon fill="black" stroke="black" points="17012.64,-8535.89 17002.06,-8535.34 17009.99,-8542.37 17012.64,-8535.89"/>
</g>
<!-- softmax_1_10 -->
<g id="node577" class="node">
<title>softmax_1_10</title>
<ellipse fill="gold" stroke="black" cx="16922.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16922.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16922.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16922.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_10&#45;&gt;softmax_1_10 -->
<g id="edge706" class="edge">
<title>attn_scores_1_10&#45;&gt;softmax_1_10</title>
<path fill="none" stroke="black" d="M16922.57,-8690.3C16922.57,-8681.85 16922.57,-8672.75 16922.57,-8663.94"/>
<polygon fill="black" stroke="black" points="16926.07,-8663.77 16922.57,-8653.77 16919.07,-8663.77 16926.07,-8663.77"/>
</g>
<!-- transpose_back_1_10 -->
<g id="node578" class="node">
<title>transpose_back_1_10</title>
<ellipse fill="lightgray" stroke="black" cx="16910.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16910.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16910.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16910.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_10&#45;&gt;transpose_back_1_10 -->
<g id="edge708" class="edge">
<title>attn_output_1_10&#45;&gt;transpose_back_1_10</title>
<path fill="none" stroke="black" d="M16918.58,-8466.3C16917.66,-8457.85 16916.66,-8448.75 16915.7,-8439.94"/>
<polygon fill="black" stroke="black" points="16919.16,-8439.33 16914.59,-8429.77 16912.2,-8440.09 16919.16,-8439.33"/>
</g>
<!-- softmax_1_10&#45;&gt;attn_output_1_10 -->
<g id="edge707" class="edge">
<title>softmax_1_10&#45;&gt;attn_output_1_10</title>
<path fill="none" stroke="black" d="M16922.57,-8578.3C16922.57,-8569.85 16922.57,-8560.75 16922.57,-8551.94"/>
<polygon fill="black" stroke="black" points="16926.07,-8551.77 16922.57,-8541.77 16919.07,-8551.77 16926.07,-8551.77"/>
</g>
<!-- reshape_concat_1_10 -->
<g id="node579" class="node">
<title>reshape_concat_1_10</title>
<ellipse fill="lightcyan" stroke="black" cx="16892.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16892.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16892.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16892.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_10&#45;&gt;reshape_concat_1_10 -->
<g id="edge709" class="edge">
<title>transpose_back_1_10&#45;&gt;reshape_concat_1_10</title>
<path fill="none" stroke="black" d="M16904.58,-8354.3C16903.17,-8345.67 16901.64,-8336.36 16900.17,-8327.36"/>
<polygon fill="black" stroke="black" points="16903.61,-8326.7 16898.54,-8317.39 16896.7,-8327.83 16903.61,-8326.7"/>
</g>
<!-- reshape_concat_1_10&#45;&gt;allgather_dim_1_2 -->
<g id="edge710" class="edge">
<title>reshape_concat_1_10&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M16821.39,-8248.22C16779.05,-8229.97 16725.24,-8206.76 16681.46,-8187.88"/>
<polygon fill="black" stroke="black" points="16682.85,-8184.66 16672.28,-8183.92 16680.07,-8191.09 16682.85,-8184.66"/>
</g>
<!-- split_q_1_11 -->
<g id="node581" class="node">
<title>split_q_1_11</title>
<ellipse fill="pink" stroke="black" cx="17845.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17845.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17845.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17845.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_q_1_11 -->
<g id="edge712" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_q_1_11</title>
<path fill="none" stroke="black" d="M17902.07,-9026.91C17894.82,-9017.41 17886.91,-9007.05 17879.37,-8997.18"/>
<polygon fill="black" stroke="black" points="17881.99,-8994.85 17873.14,-8989.02 17876.43,-8999.1 17881.99,-8994.85"/>
</g>
<!-- split_k_1_11 -->
<g id="node582" class="node">
<title>split_k_1_11</title>
<ellipse fill="pink" stroke="black" cx="18154.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18154.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18154.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18154.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_k_1_11 -->
<g id="edge713" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_k_1_11</title>
<path fill="none" stroke="black" d="M17997.08,-9029.92C18022.9,-9017.3 18052.51,-9002.82 18079.03,-8989.86"/>
<polygon fill="black" stroke="black" points="18080.83,-8992.87 18088.28,-8985.34 18077.75,-8986.58 18080.83,-8992.87"/>
</g>
<!-- split_v_1_11 -->
<g id="node583" class="node">
<title>split_v_1_11</title>
<ellipse fill="pink" stroke="black" cx="18463.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18463.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18463.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18463.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_11&#45;&gt;split_v_1_11 -->
<g id="edge714" class="edge">
<title>reshape_qkv_1_11&#45;&gt;split_v_1_11</title>
<path fill="none" stroke="black" d="M18052.2,-9040.55C18126.77,-9026.61 18223.85,-9007.87 18309.57,-8989.42 18322.54,-8986.63 18336.1,-8983.6 18349.56,-8980.51"/>
<polygon fill="black" stroke="black" points="18350.37,-8983.91 18359.33,-8978.25 18348.8,-8977.09 18350.37,-8983.91"/>
</g>
<!-- transpose_q_1_11 -->
<g id="node584" class="node">
<title>transpose_q_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="17845.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17845.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17845.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17845.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_11&#45;&gt;transpose_q_1_11 -->
<g id="edge715" class="edge">
<title>split_q_1_11&#45;&gt;transpose_q_1_11</title>
<path fill="none" stroke="black" d="M17845.57,-8914.3C17845.57,-8905.85 17845.57,-8896.75 17845.57,-8887.94"/>
<polygon fill="black" stroke="black" points="17849.07,-8887.77 17845.57,-8877.77 17842.07,-8887.77 17849.07,-8887.77"/>
</g>
<!-- transpose_k_1_11 -->
<g id="node585" class="node">
<title>transpose_k_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="18154.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18154.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18154.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18154.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_11&#45;&gt;transpose_k_1_11 -->
<g id="edge716" class="edge">
<title>split_k_1_11&#45;&gt;transpose_k_1_11</title>
<path fill="none" stroke="black" d="M18154.57,-8914.3C18154.57,-8905.85 18154.57,-8896.75 18154.57,-8887.94"/>
<polygon fill="black" stroke="black" points="18158.07,-8887.77 18154.57,-8877.77 18151.07,-8887.77 18158.07,-8887.77"/>
</g>
<!-- transpose_v_1_11 -->
<g id="node586" class="node">
<title>transpose_v_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="18463.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18463.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18463.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18463.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_11&#45;&gt;transpose_v_1_11 -->
<g id="edge717" class="edge">
<title>split_v_1_11&#45;&gt;transpose_v_1_11</title>
<path fill="none" stroke="black" d="M18463.57,-8914.3C18463.57,-8905.85 18463.57,-8896.75 18463.57,-8887.94"/>
<polygon fill="black" stroke="black" points="18467.07,-8887.77 18463.57,-8877.77 18460.07,-8887.77 18467.07,-8887.77"/>
</g>
<!-- attn_scores_1_11 -->
<g id="node587" class="node">
<title>attn_scores_1_11</title>
<ellipse fill="gold" stroke="black" cx="17957.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17957.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17957.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17957.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_11&#45;&gt;attn_scores_1_11 -->
<g id="edge718" class="edge">
<title>transpose_q_1_11&#45;&gt;attn_scores_1_11</title>
<path fill="none" stroke="black" d="M17881.63,-8803.51C17891.92,-8793.41 17903.24,-8782.29 17913.92,-8771.79"/>
<polygon fill="black" stroke="black" points="17916.52,-8774.15 17921.2,-8764.65 17911.62,-8769.16 17916.52,-8774.15"/>
</g>
<!-- transpose_k_1_11&#45;&gt;attn_scores_1_11 -->
<g id="edge719" class="edge">
<title>transpose_k_1_11&#45;&gt;attn_scores_1_11</title>
<path fill="none" stroke="black" d="M18094.93,-8805.62C18073.63,-8793.73 18049.45,-8780.22 18027.37,-8767.9"/>
<polygon fill="black" stroke="black" points="18028.81,-8764.69 18018.37,-8762.87 18025.4,-8770.81 18028.81,-8764.69"/>
</g>
<!-- attn_output_1_11 -->
<g id="node588" class="node">
<title>attn_output_1_11</title>
<ellipse fill="gold" stroke="black" cx="17957.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17957.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17957.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17957.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_11&#45;&gt;attn_output_1_11 -->
<g id="edge720" class="edge">
<title>transpose_v_1_11&#45;&gt;attn_output_1_11</title>
<path fill="none" stroke="black" d="M18425.98,-8803.54C18367.21,-8749.61 18248.38,-8645.99 18133.57,-8578.42 18107.92,-8563.33 18078.58,-8549.77 18051.3,-8538.53"/>
<polygon fill="black" stroke="black" points="18052.33,-8535.17 18041.75,-8534.65 18049.7,-8541.66 18052.33,-8535.17"/>
</g>
<!-- softmax_1_11 -->
<g id="node589" class="node">
<title>softmax_1_11</title>
<ellipse fill="gold" stroke="black" cx="17957.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17957.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17957.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17957.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_11&#45;&gt;softmax_1_11 -->
<g id="edge721" class="edge">
<title>attn_scores_1_11&#45;&gt;softmax_1_11</title>
<path fill="none" stroke="black" d="M17957.57,-8690.3C17957.57,-8681.85 17957.57,-8672.75 17957.57,-8663.94"/>
<polygon fill="black" stroke="black" points="17961.07,-8663.77 17957.57,-8653.77 17954.07,-8663.77 17961.07,-8663.77"/>
</g>
<!-- transpose_back_1_11 -->
<g id="node590" class="node">
<title>transpose_back_1_11</title>
<ellipse fill="lightgray" stroke="black" cx="17540.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17540.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17540.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17540.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_11&#45;&gt;transpose_back_1_11 -->
<g id="edge723" class="edge">
<title>attn_output_1_11&#45;&gt;transpose_back_1_11</title>
<path fill="none" stroke="black" d="M17857.69,-8476.58C17795.12,-8460.07 17714.45,-8438.79 17650.13,-8421.83"/>
<polygon fill="black" stroke="black" points="17650.92,-8418.41 17640.36,-8419.25 17649.14,-8425.18 17650.92,-8418.41"/>
</g>
<!-- softmax_1_11&#45;&gt;attn_output_1_11 -->
<g id="edge722" class="edge">
<title>softmax_1_11&#45;&gt;attn_output_1_11</title>
<path fill="none" stroke="black" d="M17957.57,-8578.3C17957.57,-8569.85 17957.57,-8560.75 17957.57,-8551.94"/>
<polygon fill="black" stroke="black" points="17961.07,-8551.77 17957.57,-8541.77 17954.07,-8551.77 17961.07,-8551.77"/>
</g>
<!-- reshape_concat_1_11 -->
<g id="node591" class="node">
<title>reshape_concat_1_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17349.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17349.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17349.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17349.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_11&#45;&gt;reshape_concat_1_11 -->
<g id="edge724" class="edge">
<title>transpose_back_1_11&#45;&gt;reshape_concat_1_11</title>
<path fill="none" stroke="black" d="M17482.49,-8357.47C17461.36,-8345.31 17437.34,-8331.47 17415.58,-8318.94"/>
<polygon fill="black" stroke="black" points="17417.14,-8315.8 17406.72,-8313.84 17413.64,-8321.86 17417.14,-8315.8"/>
</g>
<!-- reshape_concat_1_11&#45;&gt;allgather_dim_1_2 -->
<g id="edge725" class="edge">
<title>reshape_concat_1_11&#45;&gt;allgather_dim_1_2</title>
<path fill="none" stroke="black" d="M17236.78,-8260C17097.98,-8236.71 16863.31,-8197.34 16721.38,-8173.53"/>
<polygon fill="black" stroke="black" points="16721.76,-8170.04 16711.32,-8171.84 16720.6,-8176.94 16721.76,-8170.04"/>
</g>
<!-- output_proj_1_2 -->
<g id="node645" class="node">
<title>output_proj_1_2</title>
<ellipse fill="orange" stroke="black" cx="15617.57" cy="-7939.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15617.57" y="-7958.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15617.57" y="-7943.14" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="15617.57" y="-7928.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15617.57" y="-7913.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_2&#45;&gt;output_proj_1_2 -->
<g id="edge790" class="edge">
<title>head_group_1_2&#45;&gt;output_proj_1_2</title>
<path fill="none" stroke="black" d="M16489.67,-8032.03C16316.99,-8013.87 15959.91,-7976.33 15760.38,-7955.36"/>
<polygon fill="black" stroke="black" points="15760.73,-7951.87 15750.41,-7954.31 15759.99,-7958.83 15760.73,-7951.87"/>
</g>
<!-- split_q_1_12 -->
<g id="node594" class="node">
<title>split_q_1_12</title>
<ellipse fill="pink" stroke="black" cx="18772.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18772.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18772.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18772.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_q_1_12 -->
<g id="edge728" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_q_1_12</title>
<path fill="none" stroke="black" d="M18829.07,-9026.91C18821.82,-9017.41 18813.91,-9007.05 18806.37,-8997.18"/>
<polygon fill="black" stroke="black" points="18808.99,-8994.85 18800.14,-8989.02 18803.43,-8999.1 18808.99,-8994.85"/>
</g>
<!-- split_k_1_12 -->
<g id="node595" class="node">
<title>split_k_1_12</title>
<ellipse fill="pink" stroke="black" cx="19081.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19081.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19081.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19081.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_k_1_12 -->
<g id="edge729" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_k_1_12</title>
<path fill="none" stroke="black" d="M18924.08,-9029.92C18949.9,-9017.3 18979.51,-9002.82 19006.03,-8989.86"/>
<polygon fill="black" stroke="black" points="19007.83,-8992.87 19015.28,-8985.34 19004.75,-8986.58 19007.83,-8992.87"/>
</g>
<!-- split_v_1_12 -->
<g id="node596" class="node">
<title>split_v_1_12</title>
<ellipse fill="pink" stroke="black" cx="19390.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19390.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19390.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19390.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_12&#45;&gt;split_v_1_12 -->
<g id="edge730" class="edge">
<title>reshape_qkv_1_12&#45;&gt;split_v_1_12</title>
<path fill="none" stroke="black" d="M18979.2,-9040.55C19053.77,-9026.61 19150.85,-9007.87 19236.57,-8989.42 19249.54,-8986.63 19263.1,-8983.6 19276.56,-8980.51"/>
<polygon fill="black" stroke="black" points="19277.37,-8983.91 19286.33,-8978.25 19275.8,-8977.09 19277.37,-8983.91"/>
</g>
<!-- transpose_q_1_12 -->
<g id="node597" class="node">
<title>transpose_q_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="18772.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18772.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18772.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18772.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_12&#45;&gt;transpose_q_1_12 -->
<g id="edge731" class="edge">
<title>split_q_1_12&#45;&gt;transpose_q_1_12</title>
<path fill="none" stroke="black" d="M18772.57,-8914.3C18772.57,-8905.85 18772.57,-8896.75 18772.57,-8887.94"/>
<polygon fill="black" stroke="black" points="18776.07,-8887.77 18772.57,-8877.77 18769.07,-8887.77 18776.07,-8887.77"/>
</g>
<!-- transpose_k_1_12 -->
<g id="node598" class="node">
<title>transpose_k_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19081.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19081.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19081.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19081.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_12&#45;&gt;transpose_k_1_12 -->
<g id="edge732" class="edge">
<title>split_k_1_12&#45;&gt;transpose_k_1_12</title>
<path fill="none" stroke="black" d="M19081.57,-8914.3C19081.57,-8905.85 19081.57,-8896.75 19081.57,-8887.94"/>
<polygon fill="black" stroke="black" points="19085.07,-8887.77 19081.57,-8877.77 19078.07,-8887.77 19085.07,-8887.77"/>
</g>
<!-- transpose_v_1_12 -->
<g id="node599" class="node">
<title>transpose_v_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19390.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19390.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19390.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19390.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_12&#45;&gt;transpose_v_1_12 -->
<g id="edge733" class="edge">
<title>split_v_1_12&#45;&gt;transpose_v_1_12</title>
<path fill="none" stroke="black" d="M19390.57,-8914.3C19390.57,-8905.85 19390.57,-8896.75 19390.57,-8887.94"/>
<polygon fill="black" stroke="black" points="19394.07,-8887.77 19390.57,-8877.77 19387.07,-8887.77 19394.07,-8887.77"/>
</g>
<!-- attn_scores_1_12 -->
<g id="node600" class="node">
<title>attn_scores_1_12</title>
<ellipse fill="gold" stroke="black" cx="19081.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19081.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19081.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19081.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_12&#45;&gt;attn_scores_1_12 -->
<g id="edge734" class="edge">
<title>transpose_q_1_12&#45;&gt;attn_scores_1_12</title>
<path fill="none" stroke="black" d="M18856.19,-8809.16C18895.91,-8795.02 18943.6,-8778.04 18984.86,-8763.35"/>
<polygon fill="black" stroke="black" points="18986.13,-8766.62 18994.38,-8759.96 18983.79,-8760.02 18986.13,-8766.62"/>
</g>
<!-- transpose_k_1_12&#45;&gt;attn_scores_1_12 -->
<g id="edge735" class="edge">
<title>transpose_k_1_12&#45;&gt;attn_scores_1_12</title>
<path fill="none" stroke="black" d="M19081.57,-8802.3C19081.57,-8793.85 19081.57,-8784.75 19081.57,-8775.94"/>
<polygon fill="black" stroke="black" points="19085.07,-8775.77 19081.57,-8765.77 19078.07,-8775.77 19085.07,-8775.77"/>
</g>
<!-- attn_output_1_12 -->
<g id="node601" class="node">
<title>attn_output_1_12</title>
<ellipse fill="gold" stroke="black" cx="19390.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19390.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19390.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19390.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_12&#45;&gt;attn_output_1_12 -->
<g id="edge736" class="edge">
<title>transpose_v_1_12&#45;&gt;attn_output_1_12</title>
<path fill="none" stroke="black" d="M19390.57,-8802.23C19390.57,-8741.18 19390.57,-8618.87 19390.57,-8551.72"/>
<polygon fill="black" stroke="black" points="19394.07,-8551.43 19390.57,-8541.43 19387.07,-8551.43 19394.07,-8551.43"/>
</g>
<!-- softmax_1_12 -->
<g id="node602" class="node">
<title>softmax_1_12</title>
<ellipse fill="gold" stroke="black" cx="19166.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19166.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19166.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19166.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_12&#45;&gt;softmax_1_12 -->
<g id="edge737" class="edge">
<title>attn_scores_1_12&#45;&gt;softmax_1_12</title>
<path fill="none" stroke="black" d="M19109.41,-8690.91C19116.74,-8681.41 19124.75,-8671.05 19132.38,-8661.18"/>
<polygon fill="black" stroke="black" points="19135.33,-8663.08 19138.68,-8653.02 19129.79,-8658.8 19135.33,-8663.08"/>
</g>
<!-- transpose_back_1_12 -->
<g id="node603" class="node">
<title>transpose_back_1_12</title>
<ellipse fill="lightgray" stroke="black" cx="19748.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19748.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="19748.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19748.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_12&#45;&gt;transpose_back_1_12 -->
<g id="edge739" class="edge">
<title>attn_output_1_12&#45;&gt;transpose_back_1_12</title>
<path fill="none" stroke="black" d="M19482.3,-8474.74C19532.61,-8459.28 19595.1,-8440.08 19646.9,-8424.17"/>
<polygon fill="black" stroke="black" points="19648.24,-8427.41 19656.77,-8421.13 19646.19,-8420.72 19648.24,-8427.41"/>
</g>
<!-- softmax_1_12&#45;&gt;attn_output_1_12 -->
<g id="edge738" class="edge">
<title>softmax_1_12&#45;&gt;attn_output_1_12</title>
<path fill="none" stroke="black" d="M19234.39,-8581.62C19259.96,-8569.07 19289.19,-8554.71 19315.4,-8541.84"/>
<polygon fill="black" stroke="black" points="19317.09,-8544.91 19324.53,-8537.36 19314.01,-8538.62 19317.09,-8544.91"/>
</g>
<!-- reshape_concat_1_12 -->
<g id="node604" class="node">
<title>reshape_concat_1_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19915.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="19915.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="19915.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19915.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_12&#45;&gt;reshape_concat_1_12 -->
<g id="edge740" class="edge">
<title>transpose_back_1_12&#45;&gt;reshape_concat_1_12</title>
<path fill="none" stroke="black" d="M19800.5,-8356.72C19817.94,-8345.23 19837.54,-8332.32 19855.56,-8320.46"/>
<polygon fill="black" stroke="black" points="19857.83,-8323.15 19864.25,-8314.73 19853.98,-8317.31 19857.83,-8323.15"/>
</g>
<!-- allgather_dim_1_3 -->
<g id="node605" class="node">
<title>allgather_dim_1_3</title>
<polygon fill="red" stroke="black" points="20211.57,-8205.42 20038.57,-8152.42 20211.57,-8099.42 20384.57,-8152.42 20211.57,-8205.42"/>
<text text-anchor="middle" x="20211.57" y="-8163.72" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="20211.57" y="-8148.72" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="20211.57" y="-8133.72" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_1_12&#45;&gt;allgather_dim_1_3 -->
<g id="edge741" class="edge">
<title>reshape_concat_1_12&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M19987.6,-8248.38C20030.9,-8230.03 20086.1,-8206.63 20130.86,-8187.65"/>
<polygon fill="black" stroke="black" points="20132.4,-8190.79 20140.25,-8183.67 20129.67,-8184.35 20132.4,-8190.79"/>
</g>
<!-- head_group_1_3 -->
<g id="node642" class="node">
<title>head_group_1_3</title>
<polygon fill="lightyellow" stroke="black" points="18636.07,-8062.42 18439.07,-8062.42 18439.07,-8024.42 18636.07,-8024.42 18636.07,-8062.42"/>
<text text-anchor="middle" x="18537.57" y="-8047.22" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="18537.57" y="-8032.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_1_3&#45;&gt;head_group_1_3 -->
<g id="edge787" class="edge">
<title>allgather_dim_1_3&#45;&gt;head_group_1_3</title>
<path fill="none" stroke="black" d="M20071.01,-8142.44C19744.34,-8121.56 18939.5,-8070.12 18646.5,-8051.39"/>
<polygon fill="black" stroke="black" points="18646.5,-8047.88 18636.3,-8050.73 18646.05,-8054.87 18646.5,-8047.88"/>
</g>
<!-- split_q_1_13 -->
<g id="node607" class="node">
<title>split_q_1_13</title>
<ellipse fill="pink" stroke="black" cx="19699.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19699.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19699.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19699.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_q_1_13 -->
<g id="edge743" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_q_1_13</title>
<path fill="none" stroke="black" d="M19752.03,-9026.91C19745.37,-9017.5 19738.1,-9007.26 19731.16,-8997.47"/>
<polygon fill="black" stroke="black" points="19733.81,-8995.16 19725.17,-8989.02 19728.1,-8999.21 19733.81,-8995.16"/>
</g>
<!-- split_k_1_13 -->
<g id="node608" class="node">
<title>split_k_1_13</title>
<ellipse fill="pink" stroke="black" cx="20008.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20008.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20008.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20008.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_k_1_13 -->
<g id="edge744" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_k_1_13</title>
<path fill="none" stroke="black" d="M19846.26,-9030.22C19873.02,-9017.47 19903.82,-9002.81 19931.35,-8989.7"/>
<polygon fill="black" stroke="black" points="19933.03,-8992.77 19940.55,-8985.31 19930.02,-8986.45 19933.03,-8992.77"/>
</g>
<!-- split_v_1_13 -->
<g id="node609" class="node">
<title>split_v_1_13</title>
<ellipse fill="pink" stroke="black" cx="20317.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20317.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20317.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20317.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_13&#45;&gt;split_v_1_13 -->
<g id="edge745" class="edge">
<title>reshape_qkv_1_13&#45;&gt;split_v_1_13</title>
<path fill="none" stroke="black" d="M19901.28,-9040.82C19977.15,-9026.9 20076.18,-9008.09 20163.57,-8989.42 20176.55,-8986.65 20190.1,-8983.63 20203.56,-8980.55"/>
<polygon fill="black" stroke="black" points="20204.38,-8983.95 20213.34,-8978.29 20202.81,-8977.13 20204.38,-8983.95"/>
</g>
<!-- transpose_q_1_13 -->
<g id="node610" class="node">
<title>transpose_q_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="19699.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19699.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19699.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19699.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_13&#45;&gt;transpose_q_1_13 -->
<g id="edge746" class="edge">
<title>split_q_1_13&#45;&gt;transpose_q_1_13</title>
<path fill="none" stroke="black" d="M19699.57,-8914.3C19699.57,-8905.85 19699.57,-8896.75 19699.57,-8887.94"/>
<polygon fill="black" stroke="black" points="19703.07,-8887.77 19699.57,-8877.77 19696.07,-8887.77 19703.07,-8887.77"/>
</g>
<!-- transpose_k_1_13 -->
<g id="node611" class="node">
<title>transpose_k_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20008.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20008.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20008.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20008.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_13&#45;&gt;transpose_k_1_13 -->
<g id="edge747" class="edge">
<title>split_k_1_13&#45;&gt;transpose_k_1_13</title>
<path fill="none" stroke="black" d="M20008.57,-8914.3C20008.57,-8905.85 20008.57,-8896.75 20008.57,-8887.94"/>
<polygon fill="black" stroke="black" points="20012.07,-8887.77 20008.57,-8877.77 20005.07,-8887.77 20012.07,-8887.77"/>
</g>
<!-- transpose_v_1_13 -->
<g id="node612" class="node">
<title>transpose_v_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20317.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20317.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20317.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20317.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_13&#45;&gt;transpose_v_1_13 -->
<g id="edge748" class="edge">
<title>split_v_1_13&#45;&gt;transpose_v_1_13</title>
<path fill="none" stroke="black" d="M20317.57,-8914.3C20317.57,-8905.85 20317.57,-8896.75 20317.57,-8887.94"/>
<polygon fill="black" stroke="black" points="20321.07,-8887.77 20317.57,-8877.77 20314.07,-8887.77 20321.07,-8887.77"/>
</g>
<!-- attn_scores_1_13 -->
<g id="node613" class="node">
<title>attn_scores_1_13</title>
<ellipse fill="gold" stroke="black" cx="20008.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20008.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20008.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20008.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_13&#45;&gt;attn_scores_1_13 -->
<g id="edge749" class="edge">
<title>transpose_q_1_13&#45;&gt;attn_scores_1_13</title>
<path fill="none" stroke="black" d="M19783.19,-8809.16C19822.91,-8795.02 19870.6,-8778.04 19911.86,-8763.35"/>
<polygon fill="black" stroke="black" points="19913.13,-8766.62 19921.38,-8759.96 19910.79,-8760.02 19913.13,-8766.62"/>
</g>
<!-- transpose_k_1_13&#45;&gt;attn_scores_1_13 -->
<g id="edge750" class="edge">
<title>transpose_k_1_13&#45;&gt;attn_scores_1_13</title>
<path fill="none" stroke="black" d="M20008.57,-8802.3C20008.57,-8793.85 20008.57,-8784.75 20008.57,-8775.94"/>
<polygon fill="black" stroke="black" points="20012.07,-8775.77 20008.57,-8765.77 20005.07,-8775.77 20012.07,-8775.77"/>
</g>
<!-- attn_output_1_13 -->
<g id="node614" class="node">
<title>attn_output_1_13</title>
<ellipse fill="gold" stroke="black" cx="20211.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20211.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20211.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20211.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_13&#45;&gt;attn_output_1_13 -->
<g id="edge751" class="edge">
<title>transpose_v_1_13&#45;&gt;attn_output_1_13</title>
<path fill="none" stroke="black" d="M20305.93,-8802.23C20286.51,-8741.06 20247.57,-8618.36 20226.29,-8551.3"/>
<polygon fill="black" stroke="black" points="20229.52,-8549.9 20223.16,-8541.43 20222.85,-8552.02 20229.52,-8549.9"/>
</g>
<!-- softmax_1_13 -->
<g id="node615" class="node">
<title>softmax_1_13</title>
<ellipse fill="gold" stroke="black" cx="20036.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20036.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20036.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20036.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_13&#45;&gt;softmax_1_13 -->
<g id="edge752" class="edge">
<title>attn_scores_1_13&#45;&gt;softmax_1_13</title>
<path fill="none" stroke="black" d="M20017.9,-8690.3C20020.09,-8681.67 20022.46,-8672.36 20024.75,-8663.36"/>
<polygon fill="black" stroke="black" points="20028.22,-8663.95 20027.29,-8653.39 20021.43,-8662.22 20028.22,-8663.95"/>
</g>
<!-- transpose_back_1_13 -->
<g id="node616" class="node">
<title>transpose_back_1_13</title>
<ellipse fill="lightgray" stroke="black" cx="20211.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20211.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20211.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20211.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_13&#45;&gt;transpose_back_1_13 -->
<g id="edge754" class="edge">
<title>attn_output_1_13&#45;&gt;transpose_back_1_13</title>
<path fill="none" stroke="black" d="M20211.57,-8466.3C20211.57,-8457.85 20211.57,-8448.75 20211.57,-8439.94"/>
<polygon fill="black" stroke="black" points="20215.07,-8439.77 20211.57,-8429.77 20208.07,-8439.77 20215.07,-8439.77"/>
</g>
<!-- softmax_1_13&#45;&gt;attn_output_1_13 -->
<g id="edge753" class="edge">
<title>softmax_1_13&#45;&gt;attn_output_1_13</title>
<path fill="none" stroke="black" d="M20091.46,-8580.42C20109.72,-8568.95 20130.18,-8556.08 20148.97,-8544.27"/>
<polygon fill="black" stroke="black" points="20150.87,-8547.21 20157.48,-8538.93 20147.15,-8541.29 20150.87,-8547.21"/>
</g>
<!-- reshape_concat_1_13 -->
<g id="node617" class="node">
<title>reshape_concat_1_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20211.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20211.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20211.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20211.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_13&#45;&gt;reshape_concat_1_13 -->
<g id="edge755" class="edge">
<title>transpose_back_1_13&#45;&gt;reshape_concat_1_13</title>
<path fill="none" stroke="black" d="M20211.57,-8354.3C20211.57,-8345.85 20211.57,-8336.75 20211.57,-8327.94"/>
<polygon fill="black" stroke="black" points="20215.07,-8327.77 20211.57,-8317.77 20208.07,-8327.77 20215.07,-8327.77"/>
</g>
<!-- reshape_concat_1_13&#45;&gt;allgather_dim_1_3 -->
<g id="edge756" class="edge">
<title>reshape_concat_1_13&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20211.57,-8242.29C20211.57,-8233.98 20211.57,-8224.93 20211.57,-8215.89"/>
<polygon fill="black" stroke="black" points="20215.07,-8215.73 20211.57,-8205.73 20208.07,-8215.73 20215.07,-8215.73"/>
</g>
<!-- split_q_1_14 -->
<g id="node619" class="node">
<title>split_q_1_14</title>
<ellipse fill="pink" stroke="black" cx="20626.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20626.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20626.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20626.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_q_1_14 -->
<g id="edge758" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_q_1_14</title>
<path fill="none" stroke="black" d="M20679.03,-9026.91C20672.37,-9017.5 20665.1,-9007.26 20658.16,-8997.47"/>
<polygon fill="black" stroke="black" points="20660.81,-8995.16 20652.17,-8989.02 20655.1,-8999.21 20660.81,-8995.16"/>
</g>
<!-- split_k_1_14 -->
<g id="node620" class="node">
<title>split_k_1_14</title>
<ellipse fill="pink" stroke="black" cx="20935.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20935.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20935.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20935.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_k_1_14 -->
<g id="edge759" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_k_1_14</title>
<path fill="none" stroke="black" d="M20773.26,-9030.22C20800.02,-9017.47 20830.82,-9002.81 20858.35,-8989.7"/>
<polygon fill="black" stroke="black" points="20860.03,-8992.77 20867.55,-8985.31 20857.02,-8986.45 20860.03,-8992.77"/>
</g>
<!-- split_v_1_14 -->
<g id="node621" class="node">
<title>split_v_1_14</title>
<ellipse fill="pink" stroke="black" cx="21244.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21244.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21244.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21244.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_14&#45;&gt;split_v_1_14 -->
<g id="edge760" class="edge">
<title>reshape_qkv_1_14&#45;&gt;split_v_1_14</title>
<path fill="none" stroke="black" d="M20828.28,-9040.82C20904.15,-9026.9 21003.18,-9008.09 21090.57,-8989.42 21103.55,-8986.65 21117.1,-8983.63 21130.56,-8980.55"/>
<polygon fill="black" stroke="black" points="21131.38,-8983.95 21140.34,-8978.29 21129.81,-8977.13 21131.38,-8983.95"/>
</g>
<!-- transpose_q_1_14 -->
<g id="node622" class="node">
<title>transpose_q_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="20626.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20626.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20626.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20626.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_14&#45;&gt;transpose_q_1_14 -->
<g id="edge761" class="edge">
<title>split_q_1_14&#45;&gt;transpose_q_1_14</title>
<path fill="none" stroke="black" d="M20626.57,-8914.3C20626.57,-8905.85 20626.57,-8896.75 20626.57,-8887.94"/>
<polygon fill="black" stroke="black" points="20630.07,-8887.77 20626.57,-8877.77 20623.07,-8887.77 20630.07,-8887.77"/>
</g>
<!-- transpose_k_1_14 -->
<g id="node623" class="node">
<title>transpose_k_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="20935.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20935.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20935.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20935.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_14&#45;&gt;transpose_k_1_14 -->
<g id="edge762" class="edge">
<title>split_k_1_14&#45;&gt;transpose_k_1_14</title>
<path fill="none" stroke="black" d="M20935.57,-8914.3C20935.57,-8905.85 20935.57,-8896.75 20935.57,-8887.94"/>
<polygon fill="black" stroke="black" points="20939.07,-8887.77 20935.57,-8877.77 20932.07,-8887.77 20939.07,-8887.77"/>
</g>
<!-- transpose_v_1_14 -->
<g id="node624" class="node">
<title>transpose_v_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="21244.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21244.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21244.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21244.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_14&#45;&gt;transpose_v_1_14 -->
<g id="edge763" class="edge">
<title>split_v_1_14&#45;&gt;transpose_v_1_14</title>
<path fill="none" stroke="black" d="M21244.57,-8914.3C21244.57,-8905.85 21244.57,-8896.75 21244.57,-8887.94"/>
<polygon fill="black" stroke="black" points="21248.07,-8887.77 21244.57,-8877.77 21241.07,-8887.77 21248.07,-8887.77"/>
</g>
<!-- attn_scores_1_14 -->
<g id="node625" class="node">
<title>attn_scores_1_14</title>
<ellipse fill="gold" stroke="black" cx="20830.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20830.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20830.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20830.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_14&#45;&gt;attn_scores_1_14 -->
<g id="edge764" class="edge">
<title>transpose_q_1_14&#45;&gt;attn_scores_1_14</title>
<path fill="none" stroke="black" d="M20688.06,-8805.77C20710.32,-8793.76 20735.67,-8780.1 20758.75,-8767.65"/>
<polygon fill="black" stroke="black" points="20760.66,-8770.6 20767.8,-8762.77 20757.34,-8764.44 20760.66,-8770.6"/>
</g>
<!-- transpose_k_1_14&#45;&gt;attn_scores_1_14 -->
<g id="edge765" class="edge">
<title>transpose_k_1_14&#45;&gt;attn_scores_1_14</title>
<path fill="none" stroke="black" d="M20901.48,-8803.21C20892.04,-8793.32 20881.68,-8782.47 20871.88,-8772.19"/>
<polygon fill="black" stroke="black" points="20874.29,-8769.65 20864.85,-8764.84 20869.23,-8774.49 20874.29,-8769.65"/>
</g>
<!-- attn_output_1_14 -->
<g id="node626" class="node">
<title>attn_output_1_14</title>
<ellipse fill="gold" stroke="black" cx="20830.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20830.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20830.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20830.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_14&#45;&gt;attn_output_1_14 -->
<g id="edge766" class="edge">
<title>transpose_v_1_14&#45;&gt;attn_output_1_14</title>
<path fill="none" stroke="black" d="M21219.6,-8802.74C21180.03,-8747.75 21098.01,-8642.75 21006.57,-8578.42 20983.3,-8562.05 20955.81,-8548.39 20929.57,-8537.46"/>
<polygon fill="black" stroke="black" points="20930.55,-8534.08 20919.97,-8533.56 20927.91,-8540.56 20930.55,-8534.08"/>
</g>
<!-- softmax_1_14 -->
<g id="node627" class="node">
<title>softmax_1_14</title>
<ellipse fill="gold" stroke="black" cx="20830.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20830.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20830.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20830.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_14&#45;&gt;softmax_1_14 -->
<g id="edge767" class="edge">
<title>attn_scores_1_14&#45;&gt;softmax_1_14</title>
<path fill="none" stroke="black" d="M20830.57,-8690.3C20830.57,-8681.85 20830.57,-8672.75 20830.57,-8663.94"/>
<polygon fill="black" stroke="black" points="20834.07,-8663.77 20830.57,-8653.77 20827.07,-8663.77 20834.07,-8663.77"/>
</g>
<!-- transpose_back_1_14 -->
<g id="node628" class="node">
<title>transpose_back_1_14</title>
<ellipse fill="lightgray" stroke="black" cx="20655.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20655.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20655.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20655.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_14&#45;&gt;transpose_back_1_14 -->
<g id="edge769" class="edge">
<title>attn_output_1_14&#45;&gt;transpose_back_1_14</title>
<path fill="none" stroke="black" d="M20776.64,-8469.02C20758.18,-8457.42 20737.36,-8444.34 20718.27,-8432.33"/>
<polygon fill="black" stroke="black" points="20719.96,-8429.26 20709.63,-8426.9 20716.23,-8435.19 20719.96,-8429.26"/>
</g>
<!-- softmax_1_14&#45;&gt;attn_output_1_14 -->
<g id="edge768" class="edge">
<title>softmax_1_14&#45;&gt;attn_output_1_14</title>
<path fill="none" stroke="black" d="M20830.57,-8578.3C20830.57,-8569.85 20830.57,-8560.75 20830.57,-8551.94"/>
<polygon fill="black" stroke="black" points="20834.07,-8551.77 20830.57,-8541.77 20827.07,-8551.77 20834.07,-8551.77"/>
</g>
<!-- reshape_concat_1_14 -->
<g id="node629" class="node">
<title>reshape_concat_1_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20507.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20507.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20507.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20507.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_14&#45;&gt;reshape_concat_1_14 -->
<g id="edge770" class="edge">
<title>transpose_back_1_14&#45;&gt;reshape_concat_1_14</title>
<path fill="none" stroke="black" d="M20608.75,-8356.12C20593.88,-8345.07 20577.32,-8332.77 20561.97,-8321.36"/>
<polygon fill="black" stroke="black" points="20563.7,-8318.28 20553.59,-8315.13 20559.53,-8323.9 20563.7,-8318.28"/>
</g>
<!-- reshape_concat_1_14&#45;&gt;allgather_dim_1_3 -->
<g id="edge771" class="edge">
<title>reshape_concat_1_14&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20435.54,-8248.38C20392.25,-8230.03 20337.05,-8206.63 20292.29,-8187.65"/>
<polygon fill="black" stroke="black" points="20293.47,-8184.35 20282.9,-8183.67 20290.74,-8190.79 20293.47,-8184.35"/>
</g>
<!-- split_q_1_15 -->
<g id="node631" class="node">
<title>split_q_1_15</title>
<ellipse fill="pink" stroke="black" cx="21553.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21553.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21553.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21553.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_q_1_15 -->
<g id="edge773" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_q_1_15</title>
<path fill="none" stroke="black" d="M21658.85,-9028.12C21643.31,-9017.02 21626,-9004.66 21609.97,-8993.21"/>
<polygon fill="black" stroke="black" points="21611.89,-8990.28 21601.72,-8987.31 21607.82,-8995.98 21611.89,-8990.28"/>
</g>
<!-- split_k_1_15 -->
<g id="node632" class="node">
<title>split_k_1_15</title>
<ellipse fill="pink" stroke="black" cx="21862.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21862.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21862.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21862.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_k_1_15 -->
<g id="edge774" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_k_1_15</title>
<path fill="none" stroke="black" d="M21756.62,-9028.12C21772.25,-9017.02 21789.68,-9004.66 21805.81,-8993.21"/>
<polygon fill="black" stroke="black" points="21807.99,-8995.96 21814.11,-8987.31 21803.93,-8990.25 21807.99,-8995.96"/>
</g>
<!-- split_v_1_15 -->
<g id="node633" class="node">
<title>split_v_1_15</title>
<ellipse fill="pink" stroke="black" cx="22171.57" cy="-8951.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22171.57" y="-8963.22" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22171.57" y="-8948.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22171.57" y="-8933.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_1_15&#45;&gt;split_v_1_15 -->
<g id="edge775" class="edge">
<title>reshape_qkv_1_15&#45;&gt;split_v_1_15</title>
<path fill="none" stroke="black" d="M21816.95,-9037C21888.85,-9019.95 21982.81,-8997.67 22055.95,-8980.34"/>
<polygon fill="black" stroke="black" points="22057.2,-8983.64 22066.13,-8977.92 22055.59,-8976.82 22057.2,-8983.64"/>
</g>
<!-- transpose_q_1_15 -->
<g id="node634" class="node">
<title>transpose_q_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="21553.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21553.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21553.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21553.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_1_15&#45;&gt;transpose_q_1_15 -->
<g id="edge776" class="edge">
<title>split_q_1_15&#45;&gt;transpose_q_1_15</title>
<path fill="none" stroke="black" d="M21553.57,-8914.3C21553.57,-8905.85 21553.57,-8896.75 21553.57,-8887.94"/>
<polygon fill="black" stroke="black" points="21557.07,-8887.77 21553.57,-8877.77 21550.07,-8887.77 21557.07,-8887.77"/>
</g>
<!-- transpose_k_1_15 -->
<g id="node635" class="node">
<title>transpose_k_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="21862.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21862.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21862.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21862.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_1_15&#45;&gt;transpose_k_1_15 -->
<g id="edge777" class="edge">
<title>split_k_1_15&#45;&gt;transpose_k_1_15</title>
<path fill="none" stroke="black" d="M21862.57,-8914.3C21862.57,-8905.85 21862.57,-8896.75 21862.57,-8887.94"/>
<polygon fill="black" stroke="black" points="21866.07,-8887.77 21862.57,-8877.77 21859.07,-8887.77 21866.07,-8887.77"/>
</g>
<!-- transpose_v_1_15 -->
<g id="node636" class="node">
<title>transpose_v_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="22171.57" cy="-8839.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22171.57" y="-8851.22" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22171.57" y="-8836.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22171.57" y="-8821.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_1_15&#45;&gt;transpose_v_1_15 -->
<g id="edge778" class="edge">
<title>split_v_1_15&#45;&gt;transpose_v_1_15</title>
<path fill="none" stroke="black" d="M22171.57,-8914.3C22171.57,-8905.85 22171.57,-8896.75 22171.57,-8887.94"/>
<polygon fill="black" stroke="black" points="22175.07,-8887.77 22171.57,-8877.77 22168.07,-8887.77 22175.07,-8887.77"/>
</g>
<!-- attn_scores_1_15 -->
<g id="node637" class="node">
<title>attn_scores_1_15</title>
<ellipse fill="gold" stroke="black" cx="21685.57" cy="-8727.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21685.57" y="-8739.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21685.57" y="-8724.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21685.57" y="-8709.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_1_15&#45;&gt;attn_scores_1_15 -->
<g id="edge779" class="edge">
<title>transpose_q_1_15&#45;&gt;attn_scores_1_15</title>
<path fill="none" stroke="black" d="M21595.7,-8803.82C21608.2,-8793.4 21622.01,-8781.89 21634.99,-8771.08"/>
<polygon fill="black" stroke="black" points="21637.5,-8773.54 21642.94,-8764.45 21633.02,-8768.17 21637.5,-8773.54"/>
</g>
<!-- transpose_k_1_15&#45;&gt;attn_scores_1_15 -->
<g id="edge780" class="edge">
<title>transpose_k_1_15&#45;&gt;attn_scores_1_15</title>
<path fill="none" stroke="black" d="M21808.02,-8805.02C21789.61,-8793.58 21768.89,-8780.71 21749.81,-8768.84"/>
<polygon fill="black" stroke="black" points="21751.51,-8765.78 21741.16,-8763.47 21747.81,-8771.72 21751.51,-8765.78"/>
</g>
<!-- attn_output_1_15 -->
<g id="node638" class="node">
<title>attn_output_1_15</title>
<ellipse fill="gold" stroke="black" cx="21685.57" cy="-8503.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21685.57" y="-8515.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21685.57" y="-8500.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21685.57" y="-8485.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_1_15&#45;&gt;attn_output_1_15 -->
<g id="edge781" class="edge">
<title>transpose_v_1_15&#45;&gt;attn_output_1_15</title>
<path fill="none" stroke="black" d="M22136.68,-8803.34C22082.03,-8749.15 21971.13,-8645.18 21861.57,-8578.42 21836.4,-8563.09 21807.46,-8549.53 21780.41,-8538.37"/>
<polygon fill="black" stroke="black" points="21781.52,-8535.04 21770.93,-8534.53 21778.88,-8541.53 21781.52,-8535.04"/>
</g>
<!-- softmax_1_15 -->
<g id="node639" class="node">
<title>softmax_1_15</title>
<ellipse fill="gold" stroke="black" cx="21685.57" cy="-8615.92" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21685.57" y="-8627.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21685.57" y="-8612.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21685.57" y="-8597.22" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_1_15&#45;&gt;softmax_1_15 -->
<g id="edge782" class="edge">
<title>attn_scores_1_15&#45;&gt;softmax_1_15</title>
<path fill="none" stroke="black" d="M21685.57,-8690.3C21685.57,-8681.85 21685.57,-8672.75 21685.57,-8663.94"/>
<polygon fill="black" stroke="black" points="21689.07,-8663.77 21685.57,-8653.77 21682.07,-8663.77 21689.07,-8663.77"/>
</g>
<!-- transpose_back_1_15 -->
<g id="node640" class="node">
<title>transpose_back_1_15</title>
<ellipse fill="lightgray" stroke="black" cx="21360.57" cy="-8391.92" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21360.57" y="-8403.22" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21360.57" y="-8388.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21360.57" y="-8373.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_1_15&#45;&gt;transpose_back_1_15 -->
<g id="edge784" class="edge">
<title>attn_output_1_15&#45;&gt;transpose_back_1_15</title>
<path fill="none" stroke="black" d="M21598.91,-8473.59C21555.02,-8458.74 21501.62,-8440.66 21456.5,-8425.39"/>
<polygon fill="black" stroke="black" points="21457.59,-8422.07 21447,-8422.18 21455.35,-8428.7 21457.59,-8422.07"/>
</g>
<!-- softmax_1_15&#45;&gt;attn_output_1_15 -->
<g id="edge783" class="edge">
<title>softmax_1_15&#45;&gt;attn_output_1_15</title>
<path fill="none" stroke="black" d="M21685.57,-8578.3C21685.57,-8569.85 21685.57,-8560.75 21685.57,-8551.94"/>
<polygon fill="black" stroke="black" points="21689.07,-8551.77 21685.57,-8541.77 21682.07,-8551.77 21689.07,-8551.77"/>
</g>
<!-- reshape_concat_1_15 -->
<g id="node641" class="node">
<title>reshape_concat_1_15</title>
<ellipse fill="lightcyan" stroke="black" cx="20810.57" cy="-8279.92" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20810.57" y="-8291.22" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20810.57" y="-8276.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20810.57" y="-8261.22" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_1_15&#45;&gt;reshape_concat_1_15 -->
<g id="edge785" class="edge">
<title>transpose_back_1_15&#45;&gt;reshape_concat_1_15</title>
<path fill="none" stroke="black" d="M21247.28,-8368.27C21153.89,-8349.59 21021.9,-8323.19 20927.52,-8304.31"/>
<polygon fill="black" stroke="black" points="20928.14,-8300.87 20917.65,-8302.34 20926.77,-8307.73 20928.14,-8300.87"/>
</g>
<!-- reshape_concat_1_15&#45;&gt;allgather_dim_1_3 -->
<g id="edge786" class="edge">
<title>reshape_concat_1_15&#45;&gt;allgather_dim_1_3</title>
<path fill="none" stroke="black" d="M20709.31,-8255.6C20689.52,-8251.15 20668.91,-8246.58 20649.57,-8242.42 20539.64,-8218.8 20413.81,-8193.4 20325.31,-8175.81"/>
<polygon fill="black" stroke="black" points="20325.74,-8172.32 20315.25,-8173.81 20324.38,-8179.19 20325.74,-8172.32"/>
</g>
<!-- output_proj_1_3 -->
<g id="node646" class="node">
<title>output_proj_1_3</title>
<ellipse fill="orange" stroke="black" cx="16544.57" cy="-7939.34" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16544.57" y="-7958.14" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16544.57" y="-7943.14" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16544.57" y="-7928.14" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16544.57" y="-7913.14" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_1_3&#45;&gt;output_proj_1_3 -->
<g id="edge791" class="edge">
<title>head_group_1_3&#45;&gt;output_proj_1_3</title>
<path fill="none" stroke="black" d="M18438.74,-8037.36C18114.09,-8020.73 17079.14,-7967.72 16692.32,-7947.91"/>
<polygon fill="black" stroke="black" points="16692.35,-7944.41 16682.18,-7947.39 16691.99,-7951.4 16692.35,-7944.41"/>
</g>
<!-- allreduce_output_1 -->
<g id="node647" class="node">
<title>allreduce_output_1</title>
<polygon fill="red" stroke="black" points="14907.57,-7854.26 14764.57,-7801.26 14907.57,-7748.26 15050.57,-7801.26 14907.57,-7854.26"/>
<text text-anchor="middle" x="14907.57" y="-7812.56" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="14907.57" y="-7797.56" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14907.57" y="-7782.56" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_1_0&#45;&gt;allreduce_output_1 -->
<g id="edge792" class="edge">
<title>output_proj_1_0&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M13496.07,-7926.5C13792.47,-7900.41 14498.24,-7838.29 14784.14,-7813.12"/>
<polygon fill="black" stroke="black" points="14784.48,-7816.61 14794.13,-7812.24 14783.86,-7809.63 14784.48,-7816.61"/>
</g>
<!-- output_proj_1_1&#45;&gt;allreduce_output_1 -->
<g id="edge793" class="edge">
<title>output_proj_1_1&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M14195.4,-7926.89C14307.35,-7916.31 14470.52,-7898.42 14611.57,-7873.26 14681.04,-7860.87 14758.57,-7842.09 14816.85,-7826.95"/>
<polygon fill="black" stroke="black" points="14817.97,-7830.28 14826.77,-7824.37 14816.21,-7823.5 14817.97,-7830.28"/>
</g>
<!-- output_proj_1_2&#45;&gt;allreduce_output_1 -->
<g id="edge794" class="edge">
<title>output_proj_1_2&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M15482.99,-7926.37C15385.49,-7916.21 15250.94,-7899.1 15134.57,-7873.26 15085.29,-7862.31 15031.31,-7845.63 14988.36,-7831.19"/>
<polygon fill="black" stroke="black" points="14989.4,-7827.84 14978.81,-7827.95 14987.16,-7834.47 14989.4,-7827.84"/>
</g>
<!-- output_proj_1_3&#45;&gt;allreduce_output_1 -->
<g id="edge795" class="edge">
<title>output_proj_1_3&#45;&gt;allreduce_output_1</title>
<path fill="none" stroke="black" d="M16409.57,-7927.12C16098.23,-7901.24 15333.6,-7837.67 15032.41,-7812.64"/>
<polygon fill="black" stroke="black" points="15032.58,-7809.14 15022.33,-7811.8 15032,-7816.11 15032.58,-7809.14"/>
</g>
<!-- residual_1 -->
<g id="node648" class="node">
<title>residual_1</title>
<ellipse fill="none" stroke="black" cx="14907.57" cy="-7693.26" rx="58.5" ry="18"/>
<text text-anchor="middle" x="14907.57" y="-7689.56" font-family="Times,serif" font-size="14.00">residual_1</text>
</g>
<!-- allreduce_output_1&#45;&gt;residual_1 -->
<g id="edge796" class="edge">
<title>allreduce_output_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M14900.84,-7750.67C14900.76,-7740.71 14901.01,-7730.59 14901.57,-7721.72"/>
<polygon fill="black" stroke="black" points="14905.07,-7721.88 14902.42,-7711.62 14898.1,-7721.3 14905.07,-7721.88"/>
</g>
<!-- allreduce_output_1&#45;&gt;residual_1 -->
<g id="edge797" class="edge">
<title>allreduce_output_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M14914.31,-7750.67C14914.38,-7740.71 14914.14,-7730.59 14913.57,-7721.72"/>
<polygon fill="black" stroke="black" points="14917.05,-7721.3 14912.72,-7711.62 14910.07,-7721.88 14917.05,-7721.3"/>
</g>
<!-- ln2_1_0 -->
<g id="node649" class="node">
<title>ln2_1_0</title>
<ellipse fill="lightgreen" stroke="black" cx="12396.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12396.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12396.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12396.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_0 -->
<g id="edge798" class="edge">
<title>residual_1&#45;&gt;ln2_1_0</title>
<path fill="none" stroke="black" d="M14849.17,-7691.27C14633.69,-7687.56 13862.96,-7673.89 13227.57,-7657.26 12959.53,-7650.24 12891.49,-7663.72 12624.57,-7638.26 12592.12,-7635.16 12557.27,-7630.35 12524.82,-7625.22"/>
<polygon fill="black" stroke="black" points="12525.27,-7621.75 12514.84,-7623.62 12524.16,-7628.66 12525.27,-7621.75"/>
</g>
<!-- ln2_1_1 -->
<g id="node650" class="node">
<title>ln2_1_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12782.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12782.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12782.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12782.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_1 -->
<g id="edge799" class="edge">
<title>residual_1&#45;&gt;ln2_1_1</title>
<path fill="none" stroke="black" d="M14848.79,-7691.92C14566.93,-7690.12 13352.02,-7680 12975.57,-7638.26 12952.29,-7635.68 12927.61,-7631.85 12903.96,-7627.64"/>
<polygon fill="black" stroke="black" points="12904.35,-7624.15 12893.89,-7625.81 12903.1,-7631.04 12904.35,-7624.15"/>
</g>
<!-- ln2_1_2 -->
<g id="node651" class="node">
<title>ln2_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="13133.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13133.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13133.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13133.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_2 -->
<g id="edge800" class="edge">
<title>residual_1&#45;&gt;ln2_1_2</title>
<path fill="none" stroke="black" d="M14849.24,-7691.63C14599.16,-7688.73 13616.53,-7675.16 13309.57,-7638.26 13290.36,-7635.95 13270.12,-7632.62 13250.49,-7628.89"/>
<polygon fill="black" stroke="black" points="13251.08,-7625.44 13240.6,-7626.97 13249.75,-7632.31 13251.08,-7625.44"/>
</g>
<!-- ln2_1_3 -->
<g id="node652" class="node">
<title>ln2_1_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13467.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13467.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13467.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13467.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_3 -->
<g id="edge801" class="edge">
<title>residual_1&#45;&gt;ln2_1_3</title>
<path fill="none" stroke="black" d="M14849.43,-7691.13C14633.02,-7686.71 13874.38,-7669.31 13634.57,-7638.26 13617.6,-7636.06 13599.79,-7633 13582.4,-7629.58"/>
<polygon fill="black" stroke="black" points="13582.7,-7626.07 13572.21,-7627.52 13581.32,-7632.93 13582.7,-7626.07"/>
</g>
<!-- ln2_1_4 -->
<g id="node653" class="node">
<title>ln2_1_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13792.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13792.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13792.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13792.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_4 -->
<g id="edge802" class="edge">
<title>residual_1&#45;&gt;ln2_1_4</title>
<path fill="none" stroke="black" d="M14848.96,-7692.29C14699.24,-7691.65 14290.81,-7685.33 13954.57,-7638.26 13938.85,-7636.06 13922.39,-7633.11 13906.25,-7629.85"/>
<polygon fill="black" stroke="black" points="13906.75,-7626.38 13896.25,-7627.78 13905.33,-7633.23 13906.75,-7626.38"/>
</g>
<!-- ln2_1_5 -->
<g id="node654" class="node">
<title>ln2_1_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14112.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14112.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14112.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14112.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_5 -->
<g id="edge803" class="edge">
<title>residual_1&#45;&gt;ln2_1_5</title>
<path fill="none" stroke="black" d="M14849.9,-7690.05C14738,-7685.17 14483.84,-7671.17 14272.57,-7638.26 14257.68,-7635.94 14242.11,-7633.02 14226.77,-7629.84"/>
<polygon fill="black" stroke="black" points="14227.25,-7626.37 14216.74,-7627.73 14225.8,-7633.22 14227.25,-7626.37"/>
</g>
<!-- ln2_1_6 -->
<g id="node655" class="node">
<title>ln2_1_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14430.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14430.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14430.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14430.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_6 -->
<g id="edge804" class="edge">
<title>residual_1&#45;&gt;ln2_1_6</title>
<path fill="none" stroke="black" d="M14856.19,-7684.46C14793.17,-7674.69 14683.21,-7656.94 14589.57,-7638.26 14575.81,-7635.51 14561.41,-7632.46 14547.15,-7629.33"/>
<polygon fill="black" stroke="black" points="14547.82,-7625.89 14537.3,-7627.14 14546.31,-7632.72 14547.82,-7625.89"/>
</g>
<!-- ln2_1_7 -->
<g id="node656" class="node">
<title>ln2_1_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14747.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14747.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14747.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14747.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_7 -->
<g id="edge805" class="edge">
<title>residual_1&#45;&gt;ln2_1_7</title>
<path fill="none" stroke="black" d="M14880.79,-7677.11C14862.89,-7666.98 14838.47,-7653.17 14815.43,-7640.14"/>
<polygon fill="black" stroke="black" points="14817.11,-7637.07 14806.68,-7635.19 14813.66,-7643.16 14817.11,-7637.07"/>
</g>
<!-- ln2_1_8 -->
<g id="node657" class="node">
<title>ln2_1_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15067.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15067.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15067.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15067.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_8 -->
<g id="edge806" class="edge">
<title>residual_1&#45;&gt;ln2_1_8</title>
<path fill="none" stroke="black" d="M14934.35,-7677.11C14952.26,-7666.98 14976.68,-7653.17 14999.72,-7640.14"/>
<polygon fill="black" stroke="black" points="15001.48,-7643.16 15008.47,-7635.19 14998.04,-7637.07 15001.48,-7643.16"/>
</g>
<!-- ln2_1_9 -->
<g id="node658" class="node">
<title>ln2_1_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15385.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15385.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15385.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15385.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_9 -->
<g id="edge807" class="edge">
<title>residual_1&#45;&gt;ln2_1_9</title>
<path fill="none" stroke="black" d="M14958.68,-7684.48C15021.64,-7674.7 15131.79,-7656.9 15225.57,-7638.26 15239.54,-7635.48 15254.15,-7632.4 15268.61,-7629.23"/>
<polygon fill="black" stroke="black" points="15269.59,-7632.6 15278.6,-7627.03 15268.08,-7625.77 15269.59,-7632.6"/>
</g>
<!-- ln2_1_10 -->
<g id="node659" class="node">
<title>ln2_1_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15702.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15702.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15702.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15702.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_10 -->
<g id="edge808" class="edge">
<title>residual_1&#45;&gt;ln2_1_10</title>
<path fill="none" stroke="black" d="M14965.34,-7690.08C15077.43,-7685.26 15332,-7671.36 15543.57,-7638.26 15558.26,-7635.96 15573.62,-7633.07 15588.74,-7629.93"/>
<polygon fill="black" stroke="black" points="15589.58,-7633.33 15598.64,-7627.83 15588.13,-7626.48 15589.58,-7633.33"/>
</g>
<!-- ln2_1_11 -->
<g id="node660" class="node">
<title>ln2_1_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16019.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16019.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16019.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16019.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_11 -->
<g id="edge809" class="edge">
<title>residual_1&#45;&gt;ln2_1_11</title>
<path fill="none" stroke="black" d="M14966.2,-7692.37C15115.95,-7691.92 15524.44,-7686.01 15860.57,-7638.26 15875.64,-7636.12 15891.39,-7633.27 15906.86,-7630.1"/>
<polygon fill="black" stroke="black" points="15907.92,-7633.46 15916.98,-7627.98 15906.48,-7626.61 15907.92,-7633.46"/>
</g>
<!-- ln2_1_12 -->
<g id="node661" class="node">
<title>ln2_1_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16335.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16335.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16335.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16335.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_12 -->
<g id="edge810" class="edge">
<title>residual_1&#45;&gt;ln2_1_12</title>
<path fill="none" stroke="black" d="M14965.96,-7691.21C15182.4,-7687.09 15938.66,-7670.65 16177.57,-7638.26 16192.56,-7636.23 16208.22,-7633.44 16223.61,-7630.3"/>
<polygon fill="black" stroke="black" points="16224.6,-7633.67 16233.67,-7628.2 16223.16,-7626.82 16224.6,-7633.67"/>
</g>
<!-- ln2_1_13 -->
<g id="node662" class="node">
<title>ln2_1_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16651.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16651.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16651.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16651.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_13 -->
<g id="edge811" class="edge">
<title>residual_1&#45;&gt;ln2_1_13</title>
<path fill="none" stroke="black" d="M14965.91,-7691.8C15214.89,-7689.62 16189.57,-7678.63 16493.57,-7638.26 16508.57,-7636.27 16524.23,-7633.5 16539.62,-7630.38"/>
<polygon fill="black" stroke="black" points="16540.6,-7633.75 16549.68,-7628.28 16539.17,-7626.9 16540.6,-7633.75"/>
</g>
<!-- ln2_1_14 -->
<g id="node663" class="node">
<title>ln2_1_14</title>
<ellipse fill="lightgreen" stroke="black" cx="16967.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16967.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16967.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="16967.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_14 -->
<g id="edge812" class="edge">
<title>residual_1&#45;&gt;ln2_1_14</title>
<path fill="none" stroke="black" d="M14965.8,-7691.04C15156.65,-7686.98 15780.61,-7673.31 16296.57,-7657.26 16524.62,-7650.16 16583.4,-7668.29 16809.57,-7638.26 16824.57,-7636.27 16840.23,-7633.5 16855.62,-7630.38"/>
<polygon fill="black" stroke="black" points="16856.6,-7633.75 16865.68,-7628.28 16855.17,-7626.9 16856.6,-7633.75"/>
</g>
<!-- ln2_1_15 -->
<g id="node664" class="node">
<title>ln2_1_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17550.57" cy="-7600.76" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17550.57" y="-7612.06" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17550.57" y="-7597.06" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17550.57" y="-7582.06" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_1&#45;&gt;ln2_1_15 -->
<g id="edge813" class="edge">
<title>residual_1&#45;&gt;ln2_1_15</title>
<path fill="none" stroke="black" d="M14966.32,-7692.23C15222.63,-7691.81 16268.48,-7687.03 17125.57,-7638.26 17217.93,-7633 17321.34,-7624.19 17403.03,-7616.54"/>
<polygon fill="black" stroke="black" points="17403.76,-7619.98 17413.39,-7615.56 17403.1,-7613.01 17403.76,-7619.98"/>
</g>
<!-- router_1_0 -->
<g id="node665" class="node">
<title>router_1_0</title>
<ellipse fill="purple" stroke="black" cx="12142.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12142.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12142.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12142.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_0&#45;&gt;router_1_0 -->
<g id="edge814" class="edge">
<title>ln2_1_0&#45;&gt;router_1_0</title>
<path fill="none" stroke="black" d="M12323.11,-7567.94C12292.44,-7554.66 12256.67,-7539.17 12225.09,-7525.5"/>
<polygon fill="black" stroke="black" points="12226.44,-7522.27 12215.88,-7521.5 12223.66,-7528.69 12226.44,-7522.27"/>
</g>
<!-- router_1_1 -->
<g id="node666" class="node">
<title>router_1_1</title>
<ellipse fill="purple" stroke="black" cx="12457.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12457.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12457.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12457.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_1&#45;&gt;router_1_1 -->
<g id="edge815" class="edge">
<title>ln2_1_1&#45;&gt;router_1_1</title>
<path fill="none" stroke="black" d="M12695.48,-7570.28C12651.95,-7555.55 12599.14,-7537.67 12554.35,-7522.51"/>
<polygon fill="black" stroke="black" points="12555.22,-7519.11 12544.63,-7519.22 12552.98,-7525.74 12555.22,-7519.11"/>
</g>
<!-- router_1_2 -->
<g id="node667" class="node">
<title>router_1_2</title>
<ellipse fill="purple" stroke="black" cx="12917.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12917.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12917.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12917.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_2&#45;&gt;router_1_2 -->
<g id="edge816" class="edge">
<title>ln2_1_2&#45;&gt;router_1_2</title>
<path fill="none" stroke="black" d="M13069.06,-7566.9C13044.59,-7554.44 13016.55,-7540.16 12991.29,-7527.3"/>
<polygon fill="black" stroke="black" points="12992.63,-7524.05 12982.13,-7522.63 12989.45,-7530.29 12992.63,-7524.05"/>
</g>
<!-- router_1_3 -->
<g id="node668" class="node">
<title>router_1_3</title>
<ellipse fill="purple" stroke="black" cx="13348.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13348.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13348.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13348.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_3&#45;&gt;router_1_3 -->
<g id="edge817" class="edge">
<title>ln2_1_3&#45;&gt;router_1_3</title>
<path fill="none" stroke="black" d="M13429.27,-7564.35C13418.12,-7554.04 13405.83,-7542.68 13394.28,-7532"/>
<polygon fill="black" stroke="black" points="13396.53,-7529.32 13386.81,-7525.1 13391.78,-7534.46 13396.53,-7529.32"/>
</g>
<!-- router_1_4 -->
<g id="node669" class="node">
<title>router_1_4</title>
<ellipse fill="purple" stroke="black" cx="13732.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13732.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13732.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13732.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_4&#45;&gt;router_1_4 -->
<g id="edge818" class="edge">
<title>ln2_1_4&#45;&gt;router_1_4</title>
<path fill="none" stroke="black" d="M13772.76,-7563.44C13767.79,-7554.33 13762.41,-7544.45 13757.23,-7534.97"/>
<polygon fill="black" stroke="black" points="13760.23,-7533.15 13752.37,-7526.04 13754.08,-7536.5 13760.23,-7533.15"/>
</g>
<!-- router_1_5 -->
<g id="node670" class="node">
<title>router_1_5</title>
<ellipse fill="purple" stroke="black" cx="14079.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14079.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14079.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14079.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_5&#45;&gt;router_1_5 -->
<g id="edge819" class="edge">
<title>ln2_1_5&#45;&gt;router_1_5</title>
<path fill="none" stroke="black" d="M14101.58,-7563.13C14098.97,-7554.41 14096.14,-7544.99 14093.42,-7535.91"/>
<polygon fill="black" stroke="black" points="14096.74,-7534.8 14090.51,-7526.23 14090.04,-7536.81 14096.74,-7534.8"/>
</g>
<!-- router_1_6 -->
<g id="node671" class="node">
<title>router_1_6</title>
<ellipse fill="purple" stroke="black" cx="14411.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14411.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14411.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14411.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_6&#45;&gt;router_1_6 -->
<g id="edge820" class="edge">
<title>ln2_1_6&#45;&gt;router_1_6</title>
<path fill="none" stroke="black" d="M14424.25,-7563.13C14422.76,-7554.5 14421.15,-7545.19 14419.59,-7536.2"/>
<polygon fill="black" stroke="black" points="14423.02,-7535.48 14417.87,-7526.23 14416.13,-7536.68 14423.02,-7535.48"/>
</g>
<!-- router_1_7 -->
<g id="node672" class="node">
<title>router_1_7</title>
<ellipse fill="purple" stroke="black" cx="14746.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14746.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14746.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14746.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_7&#45;&gt;router_1_7 -->
<g id="edge821" class="edge">
<title>ln2_1_7&#45;&gt;router_1_7</title>
<path fill="none" stroke="black" d="M14747.24,-7563.13C14747.16,-7554.68 14747.08,-7545.59 14747,-7536.77"/>
<polygon fill="black" stroke="black" points="14750.5,-7536.57 14746.91,-7526.6 14743.5,-7536.63 14750.5,-7536.57"/>
</g>
<!-- router_1_8 -->
<g id="node673" class="node">
<title>router_1_8</title>
<ellipse fill="purple" stroke="black" cx="15112.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15112.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15112.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15112.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_8&#45;&gt;router_1_8 -->
<g id="edge822" class="edge">
<title>ln2_1_8&#45;&gt;router_1_8</title>
<path fill="none" stroke="black" d="M15082.43,-7563.44C15086.04,-7554.61 15089.95,-7545.06 15093.72,-7535.85"/>
<polygon fill="black" stroke="black" points="15097.03,-7537 15097.58,-7526.42 15090.55,-7534.35 15097.03,-7537"/>
</g>
<!-- router_1_9 -->
<g id="node674" class="node">
<title>router_1_9</title>
<ellipse fill="purple" stroke="black" cx="15428.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15428.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15428.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15428.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_9&#45;&gt;router_1_9 -->
<g id="edge823" class="edge">
<title>ln2_1_9&#45;&gt;router_1_9</title>
<path fill="none" stroke="black" d="M15399.89,-7563.13C15403.34,-7554.32 15407.06,-7544.79 15410.65,-7535.62"/>
<polygon fill="black" stroke="black" points="15413.94,-7536.81 15414.32,-7526.23 15407.42,-7534.27 15413.94,-7536.81"/>
</g>
<!-- router_1_10 -->
<g id="node675" class="node">
<title>router_1_10</title>
<ellipse fill="purple" stroke="black" cx="15743.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15743.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15743.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15743.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_10&#45;&gt;router_1_10 -->
<g id="edge824" class="edge">
<title>ln2_1_10&#45;&gt;router_1_10</title>
<path fill="none" stroke="black" d="M15716.23,-7563.13C15719.51,-7554.32 15723.06,-7544.79 15726.48,-7535.62"/>
<polygon fill="black" stroke="black" points="15729.77,-7536.82 15729.98,-7526.23 15723.21,-7534.37 15729.77,-7536.82"/>
</g>
<!-- router_1_11 -->
<g id="node676" class="node">
<title>router_1_11</title>
<ellipse fill="purple" stroke="black" cx="16313.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16313.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16313.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16313.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_11&#45;&gt;router_1_11 -->
<g id="edge825" class="edge">
<title>ln2_1_11&#45;&gt;router_1_11</title>
<path fill="none" stroke="black" d="M16101.08,-7569.26C16138.83,-7555.14 16183.83,-7538.3 16222.68,-7523.76"/>
<polygon fill="black" stroke="black" points="16224.28,-7526.9 16232.42,-7520.12 16221.83,-7520.35 16224.28,-7526.9"/>
</g>
<!-- router_1_12 -->
<g id="node677" class="node">
<title>router_1_12</title>
<ellipse fill="purple" stroke="black" cx="16628.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16628.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16628.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16628.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_12&#45;&gt;router_1_12 -->
<g id="edge826" class="edge">
<title>ln2_1_12&#45;&gt;router_1_12</title>
<path fill="none" stroke="black" d="M16416.8,-7569.26C16454.35,-7555.17 16499.09,-7538.37 16537.75,-7523.86"/>
<polygon fill="black" stroke="black" points="16539.31,-7527.01 16547.44,-7520.22 16536.85,-7520.46 16539.31,-7527.01"/>
</g>
<!-- router_1_13 -->
<g id="node678" class="node">
<title>router_1_13</title>
<ellipse fill="purple" stroke="black" cx="16944.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16944.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16944.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16944.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_13&#45;&gt;router_1_13 -->
<g id="edge827" class="edge">
<title>ln2_1_13&#45;&gt;router_1_13</title>
<path fill="none" stroke="black" d="M16732.8,-7569.26C16770.35,-7555.17 16815.09,-7538.37 16853.75,-7523.86"/>
<polygon fill="black" stroke="black" points="16855.31,-7527.01 16863.44,-7520.22 16852.85,-7520.46 16855.31,-7527.01"/>
</g>
<!-- router_1_14 -->
<g id="node679" class="node">
<title>router_1_14</title>
<ellipse fill="purple" stroke="black" cx="17384.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17384.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17384.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17384.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_14&#45;&gt;router_1_14 -->
<g id="edge828" class="edge">
<title>ln2_1_14&#45;&gt;router_1_14</title>
<path fill="none" stroke="black" d="M17068.52,-7573.13C17130.65,-7556.74 17210.33,-7535.72 17274.14,-7518.89"/>
<polygon fill="black" stroke="black" points="17275.06,-7522.27 17283.84,-7516.33 17273.28,-7515.5 17275.06,-7522.27"/>
</g>
<!-- router_1_15 -->
<g id="node680" class="node">
<title>router_1_15</title>
<ellipse fill="purple" stroke="black" cx="17817.57" cy="-7488.76" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17817.57" y="-7500.06" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17817.57" y="-7485.06" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17817.57" y="-7470.06" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_1_15&#45;&gt;router_1_15 -->
<g id="edge829" class="edge">
<title>ln2_1_15&#45;&gt;router_1_15</title>
<path fill="none" stroke="black" d="M17626.73,-7568.38C17659.7,-7554.8 17698.43,-7538.85 17732.35,-7524.87"/>
<polygon fill="black" stroke="black" points="17733.87,-7528.03 17741.78,-7520.98 17731.2,-7521.56 17733.87,-7528.03"/>
</g>
<!-- dispatch_1_0 -->
<g id="node681" class="node">
<title>dispatch_1_0</title>
<polygon fill="purple" stroke="black" points="11950.57,-7414.26 11762.57,-7361.26 11950.57,-7308.26 12138.57,-7361.26 11950.57,-7414.26"/>
<text text-anchor="middle" x="11950.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="11950.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11950.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_0&#45;&gt;dispatch_1_0 -->
<g id="edge830" class="edge">
<title>router_1_0&#45;&gt;dispatch_1_0</title>
<path fill="none" stroke="black" d="M12090.36,-7453.63C12067.12,-7438.44 12039.52,-7420.39 12015,-7404.37"/>
<polygon fill="black" stroke="black" points="12016.76,-7401.34 12006.47,-7398.8 12012.93,-7407.2 12016.76,-7401.34"/>
</g>
<!-- dispatch_1_1 -->
<g id="node682" class="node">
<title>dispatch_1_1</title>
<polygon fill="purple" stroke="black" points="12360.57,-7414.26 12172.57,-7361.26 12360.57,-7308.26 12548.57,-7361.26 12360.57,-7414.26"/>
<text text-anchor="middle" x="12360.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12360.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12360.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_1&#45;&gt;dispatch_1_1 -->
<g id="edge831" class="edge">
<title>router_1_1&#45;&gt;dispatch_1_1</title>
<path fill="none" stroke="black" d="M12429.78,-7451.79C12420.5,-7439.8 12409.99,-7426.19 12400.01,-7413.28"/>
<polygon fill="black" stroke="black" points="12402.76,-7411.12 12393.87,-7405.34 12397.22,-7415.4 12402.76,-7411.12"/>
</g>
<!-- dispatch_1_2 -->
<g id="node683" class="node">
<title>dispatch_1_2</title>
<polygon fill="purple" stroke="black" points="12762.57,-7414.26 12574.57,-7361.26 12762.57,-7308.26 12950.57,-7361.26 12762.57,-7414.26"/>
<text text-anchor="middle" x="12762.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12762.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12762.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_2&#45;&gt;dispatch_1_2 -->
<g id="edge832" class="edge">
<title>router_1_2&#45;&gt;dispatch_1_2</title>
<path fill="none" stroke="black" d="M12874.4,-7452.8C12857,-7438.71 12836.7,-7422.28 12818.22,-7407.31"/>
<polygon fill="black" stroke="black" points="12820.39,-7404.57 12810.42,-7401 12815.99,-7410.01 12820.39,-7404.57"/>
</g>
<!-- dispatch_1_3 -->
<g id="node684" class="node">
<title>dispatch_1_3</title>
<polygon fill="purple" stroke="black" points="13160.57,-7414.26 12972.57,-7361.26 13160.57,-7308.26 13348.57,-7361.26 13160.57,-7414.26"/>
<text text-anchor="middle" x="13160.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13160.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13160.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_3&#45;&gt;dispatch_1_3 -->
<g id="edge833" class="edge">
<title>router_1_3&#45;&gt;dispatch_1_3</title>
<path fill="none" stroke="black" d="M13297.2,-7453.46C13274.64,-7438.4 13247.92,-7420.57 13224.13,-7404.68"/>
<polygon fill="black" stroke="black" points="13225.76,-7401.57 13215.5,-7398.93 13221.88,-7407.39 13225.76,-7401.57"/>
</g>
<!-- dispatch_1_4 -->
<g id="node685" class="node">
<title>dispatch_1_4</title>
<polygon fill="purple" stroke="black" points="13556.57,-7414.26 13368.57,-7361.26 13556.57,-7308.26 13744.57,-7361.26 13556.57,-7414.26"/>
<text text-anchor="middle" x="13556.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13556.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13556.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_4&#45;&gt;dispatch_1_4 -->
<g id="edge834" class="edge">
<title>router_1_4&#45;&gt;dispatch_1_4</title>
<path fill="none" stroke="black" d="M13684.01,-7453.13C13663.35,-7438.4 13639.04,-7421.06 13617.21,-7405.5"/>
<polygon fill="black" stroke="black" points="13619.16,-7402.58 13608.98,-7399.63 13615.09,-7408.28 13619.16,-7402.58"/>
</g>
<!-- dispatch_1_5 -->
<g id="node686" class="node">
<title>dispatch_1_5</title>
<polygon fill="purple" stroke="black" points="13950.57,-7414.26 13762.57,-7361.26 13950.57,-7308.26 14138.57,-7361.26 13950.57,-7414.26"/>
<text text-anchor="middle" x="13950.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13950.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13950.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_5&#45;&gt;dispatch_1_5 -->
<g id="edge835" class="edge">
<title>router_1_5&#45;&gt;dispatch_1_5</title>
<path fill="none" stroke="black" d="M14042.95,-7452.13C14029.5,-7439.05 14014.06,-7424.02 13999.69,-7410.04"/>
<polygon fill="black" stroke="black" points="14001.9,-7407.31 13992.29,-7402.84 13997.02,-7412.32 14001.9,-7407.31"/>
</g>
<!-- dispatch_1_6 -->
<g id="node687" class="node">
<title>dispatch_1_6</title>
<polygon fill="purple" stroke="black" points="14344.57,-7414.26 14156.57,-7361.26 14344.57,-7308.26 14532.57,-7361.26 14344.57,-7414.26"/>
<text text-anchor="middle" x="14344.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14344.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14344.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_6&#45;&gt;dispatch_1_6 -->
<g id="edge836" class="edge">
<title>router_1_6&#45;&gt;dispatch_1_6</title>
<path fill="none" stroke="black" d="M14392.19,-7451.46C14386.4,-7440.61 14379.93,-7428.48 14373.66,-7416.74"/>
<polygon fill="black" stroke="black" points="14376.72,-7415.03 14368.92,-7407.86 14370.54,-7418.33 14376.72,-7415.03"/>
</g>
<!-- dispatch_1_7 -->
<g id="node688" class="node">
<title>dispatch_1_7</title>
<polygon fill="purple" stroke="black" points="14738.57,-7414.26 14550.57,-7361.26 14738.57,-7308.26 14926.57,-7361.26 14738.57,-7414.26"/>
<text text-anchor="middle" x="14738.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14738.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14738.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_7&#45;&gt;dispatch_1_7 -->
<g id="edge837" class="edge">
<title>router_1_7&#45;&gt;dispatch_1_7</title>
<path fill="none" stroke="black" d="M14744.24,-7451.12C14743.69,-7442.51 14743.09,-7433.11 14742.49,-7423.74"/>
<polygon fill="black" stroke="black" points="14745.98,-7423.39 14741.85,-7413.63 14738.99,-7423.83 14745.98,-7423.39"/>
</g>
<!-- dispatch_1_8 -->
<g id="node689" class="node">
<title>dispatch_1_8</title>
<polygon fill="purple" stroke="black" points="15132.57,-7414.26 14944.57,-7361.26 15132.57,-7308.26 15320.57,-7361.26 15132.57,-7414.26"/>
<text text-anchor="middle" x="15132.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15132.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15132.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_8&#45;&gt;dispatch_1_8 -->
<g id="edge838" class="edge">
<title>router_1_8&#45;&gt;dispatch_1_8</title>
<path fill="none" stroke="black" d="M15118.41,-7451.12C15119.85,-7442.1 15121.43,-7432.2 15122.99,-7422.39"/>
<polygon fill="black" stroke="black" points="15126.49,-7422.66 15124.61,-7412.24 15119.58,-7421.56 15126.49,-7422.66"/>
</g>
<!-- dispatch_1_9 -->
<g id="node690" class="node">
<title>dispatch_1_9</title>
<polygon fill="purple" stroke="black" points="15526.57,-7414.26 15338.57,-7361.26 15526.57,-7308.26 15714.57,-7361.26 15526.57,-7414.26"/>
<text text-anchor="middle" x="15526.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15526.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15526.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_9&#45;&gt;dispatch_1_9 -->
<g id="edge839" class="edge">
<title>router_1_9&#45;&gt;dispatch_1_9</title>
<path fill="none" stroke="black" d="M15456.66,-7451.79C15466.12,-7439.68 15476.86,-7425.92 15487.04,-7412.89"/>
<polygon fill="black" stroke="black" points="15489.89,-7414.93 15493.28,-7404.89 15484.37,-7410.62 15489.89,-7414.93"/>
</g>
<!-- dispatch_1_10 -->
<g id="node691" class="node">
<title>dispatch_1_10</title>
<polygon fill="purple" stroke="black" points="15920.57,-7414.26 15732.57,-7361.26 15920.57,-7308.26 16108.57,-7361.26 15920.57,-7414.26"/>
<text text-anchor="middle" x="15920.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15920.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15920.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_10&#45;&gt;dispatch_1_10 -->
<g id="edge840" class="edge">
<title>router_1_10&#45;&gt;dispatch_1_10</title>
<path fill="none" stroke="black" d="M15792.41,-7453.13C15813.19,-7438.4 15837.64,-7421.06 15859.59,-7405.5"/>
<polygon fill="black" stroke="black" points="15861.73,-7408.27 15867.87,-7399.63 15857.69,-7402.56 15861.73,-7408.27"/>
</g>
<!-- dispatch_1_11 -->
<g id="node692" class="node">
<title>dispatch_1_11</title>
<polygon fill="purple" stroke="black" points="16314.57,-7414.26 16126.57,-7361.26 16314.57,-7308.26 16502.57,-7361.26 16314.57,-7414.26"/>
<text text-anchor="middle" x="16314.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16314.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16314.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_11&#45;&gt;dispatch_1_11 -->
<g id="edge841" class="edge">
<title>router_1_11&#45;&gt;dispatch_1_11</title>
<path fill="none" stroke="black" d="M16313.87,-7451.12C16313.93,-7442.82 16314,-7433.77 16314.08,-7424.73"/>
<polygon fill="black" stroke="black" points="16317.58,-7424.59 16314.16,-7414.56 16310.58,-7424.53 16317.58,-7424.59"/>
</g>
<!-- dispatch_1_12 -->
<g id="node693" class="node">
<title>dispatch_1_12</title>
<polygon fill="purple" stroke="black" points="16710.57,-7414.26 16522.57,-7361.26 16710.57,-7308.26 16898.57,-7361.26 16710.57,-7414.26"/>
<text text-anchor="middle" x="16710.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16710.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16710.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_12&#45;&gt;dispatch_1_12 -->
<g id="edge842" class="edge">
<title>router_1_12&#45;&gt;dispatch_1_12</title>
<path fill="none" stroke="black" d="M16652.29,-7451.46C16659.75,-7440.05 16668.14,-7427.21 16676.18,-7414.9"/>
<polygon fill="black" stroke="black" points="16679.13,-7416.78 16681.67,-7406.49 16673.27,-7412.95 16679.13,-7416.78"/>
</g>
<!-- dispatch_1_13 -->
<g id="node694" class="node">
<title>dispatch_1_13</title>
<polygon fill="purple" stroke="black" points="17105.57,-7414.26 16917.57,-7361.26 17105.57,-7308.26 17293.57,-7361.26 17105.57,-7414.26"/>
<text text-anchor="middle" x="17105.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17105.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17105.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_13&#45;&gt;dispatch_1_13 -->
<g id="edge843" class="edge">
<title>router_1_13&#45;&gt;dispatch_1_13</title>
<path fill="none" stroke="black" d="M16989.42,-7452.8C17007.74,-7438.52 17029.14,-7421.84 17048.55,-7406.71"/>
<polygon fill="black" stroke="black" points="17050.71,-7409.46 17056.45,-7400.55 17046.41,-7403.94 17050.71,-7409.46"/>
</g>
<!-- dispatch_1_14 -->
<g id="node695" class="node">
<title>dispatch_1_14</title>
<polygon fill="purple" stroke="black" points="17500.57,-7414.26 17312.57,-7361.26 17500.57,-7308.26 17688.57,-7361.26 17500.57,-7414.26"/>
<text text-anchor="middle" x="17500.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17500.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17500.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_14&#45;&gt;dispatch_1_14 -->
<g id="edge844" class="edge">
<title>router_1_14&#45;&gt;dispatch_1_14</title>
<path fill="none" stroke="black" d="M17417.5,-7452.13C17429.26,-7439.41 17442.72,-7424.85 17455.33,-7411.21"/>
<polygon fill="black" stroke="black" points="17458.01,-7413.46 17462.23,-7403.74 17452.87,-7408.71 17458.01,-7413.46"/>
</g>
<!-- dispatch_1_15 -->
<g id="node696" class="node">
<title>dispatch_1_15</title>
<polygon fill="purple" stroke="black" points="17927.57,-7414.26 17739.57,-7361.26 17927.57,-7308.26 18115.57,-7361.26 17927.57,-7414.26"/>
<text text-anchor="middle" x="17927.57" y="-7372.56" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17927.57" y="-7357.56" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17927.57" y="-7342.56" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_1_15&#45;&gt;dispatch_1_15 -->
<g id="edge845" class="edge">
<title>router_1_15&#45;&gt;dispatch_1_15</title>
<path fill="none" stroke="black" d="M17849.1,-7451.79C17860.03,-7439.32 17872.48,-7425.11 17884.2,-7411.74"/>
<polygon fill="black" stroke="black" points="17887.04,-7413.81 17891,-7403.99 17881.78,-7409.2 17887.04,-7413.81"/>
</g>
<!-- expert_1_0_fc1_0 -->
<g id="node697" class="node">
<title>expert_1_0_fc1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11745.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11745.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11745.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11745.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11745.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_0&#45;&gt;expert_1_0_fc1_0 -->
<g id="edge846" class="edge">
<title>dispatch_1_0&#45;&gt;expert_1_0_fc1_0</title>
<path fill="none" stroke="black" d="M11895.37,-7323.61C11870.33,-7306.99 11840.46,-7287.17 11814.02,-7269.61"/>
<polygon fill="black" stroke="black" points="11815.83,-7266.61 11805.56,-7263.99 11811.95,-7272.44 11815.83,-7266.61"/>
</g>
<!-- expert_1_0_fc1_1 -->
<g id="node698" class="node">
<title>expert_1_0_fc1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12173.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12173.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="12173.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12173.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12173.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_1&#45;&gt;expert_1_0_fc1_1 -->
<g id="edge847" class="edge">
<title>dispatch_1_1&#45;&gt;expert_1_0_fc1_1</title>
<path fill="none" stroke="black" d="M12308.98,-7322.71C12286.93,-7306.67 12260.96,-7287.77 12237.69,-7270.84"/>
<polygon fill="black" stroke="black" points="12239.73,-7267.99 12229.59,-7264.94 12235.61,-7273.65 12239.73,-7267.99"/>
</g>
<!-- expert_1_1_fc1_2 -->
<g id="node699" class="node">
<title>expert_1_1_fc1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12757.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12757.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="12757.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12757.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12757.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_2&#45;&gt;expert_1_1_fc1_2 -->
<g id="edge848" class="edge">
<title>dispatch_1_2&#45;&gt;expert_1_1_fc1_2</title>
<path fill="none" stroke="black" d="M12760.67,-7308.42C12760.35,-7299.68 12760.01,-7290.55 12759.69,-7281.67"/>
<polygon fill="black" stroke="black" points="12763.17,-7281.26 12759.31,-7271.4 12756.18,-7281.52 12763.17,-7281.26"/>
</g>
<!-- expert_1_1_fc1_3 -->
<g id="node700" class="node">
<title>expert_1_1_fc1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13076.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13076.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="13076.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13076.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13076.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_3&#45;&gt;expert_1_1_fc1_3 -->
<g id="edge849" class="edge">
<title>dispatch_1_3&#45;&gt;expert_1_1_fc1_3</title>
<path fill="none" stroke="black" d="M13133.07,-7315.7C13125.75,-7303.85 13117.77,-7290.91 13110.17,-7278.6"/>
<polygon fill="black" stroke="black" points="13112.95,-7276.44 13104.72,-7269.77 13106.99,-7280.11 13112.95,-7276.44"/>
</g>
<!-- expert_1_2_fc1_4 -->
<g id="node701" class="node">
<title>expert_1_2_fc1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13566.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13566.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13566.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13566.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13566.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_4&#45;&gt;expert_1_2_fc1_4 -->
<g id="edge850" class="edge">
<title>dispatch_1_4&#45;&gt;expert_1_2_fc1_4</title>
<path fill="none" stroke="black" d="M13560.33,-7309.2C13560.99,-7300.21 13561.68,-7290.8 13562.35,-7281.66"/>
<polygon fill="black" stroke="black" points="13565.86,-7281.7 13563.1,-7271.47 13558.87,-7281.19 13565.86,-7281.7"/>
</g>
<!-- expert_1_2_fc1_5 -->
<g id="node702" class="node">
<title>expert_1_2_fc1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13947.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13947.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13947.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13947.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13947.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_5&#45;&gt;expert_1_2_fc1_5 -->
<g id="edge851" class="edge">
<title>dispatch_1_5&#45;&gt;expert_1_2_fc1_5</title>
<path fill="none" stroke="black" d="M13949.43,-7308.42C13949.24,-7299.68 13949.04,-7290.55 13948.84,-7281.67"/>
<polygon fill="black" stroke="black" points="13952.33,-7281.32 13948.61,-7271.4 13945.34,-7281.47 13952.33,-7281.32"/>
</g>
<!-- expert_1_3_fc1_6 -->
<g id="node703" class="node">
<title>expert_1_3_fc1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14347.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14347.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14347.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14347.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14347.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_6&#45;&gt;expert_1_3_fc1_6 -->
<g id="edge852" class="edge">
<title>dispatch_1_6&#45;&gt;expert_1_3_fc1_6</title>
<path fill="none" stroke="black" d="M14345.72,-7308.42C14345.91,-7299.68 14346.11,-7290.55 14346.31,-7281.67"/>
<polygon fill="black" stroke="black" points="14349.81,-7281.47 14346.53,-7271.4 14342.81,-7281.32 14349.81,-7281.47"/>
</g>
<!-- expert_1_3_fc1_7 -->
<g id="node704" class="node">
<title>expert_1_3_fc1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14728.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14728.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14728.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14728.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14728.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_7&#45;&gt;expert_1_3_fc1_7 -->
<g id="edge853" class="edge">
<title>dispatch_1_7&#45;&gt;expert_1_3_fc1_7</title>
<path fill="none" stroke="black" d="M14734.82,-7309.2C14734.16,-7300.21 14733.47,-7290.8 14732.8,-7281.66"/>
<polygon fill="black" stroke="black" points="14736.27,-7281.19 14732.05,-7271.47 14729.29,-7281.7 14736.27,-7281.19"/>
</g>
<!-- expert_1_4_fc1_8 -->
<g id="node705" class="node">
<title>expert_1_4_fc1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15144.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15144.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15144.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15144.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15144.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_8&#45;&gt;expert_1_4_fc1_8 -->
<g id="edge854" class="edge">
<title>dispatch_1_8&#45;&gt;expert_1_4_fc1_8</title>
<path fill="none" stroke="black" d="M15137.08,-7309.2C15137.87,-7300.21 15138.7,-7290.8 15139.5,-7281.66"/>
<polygon fill="black" stroke="black" points="15143.01,-7281.74 15140.4,-7271.47 15136.04,-7281.13 15143.01,-7281.74"/>
</g>
<!-- expert_1_4_fc1_9 -->
<g id="node706" class="node">
<title>expert_1_4_fc1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15520.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15520.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15520.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15520.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15520.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_9&#45;&gt;expert_1_4_fc1_9 -->
<g id="edge855" class="edge">
<title>dispatch_1_9&#45;&gt;expert_1_4_fc1_9</title>
<path fill="none" stroke="black" d="M15524.31,-7308.81C15523.91,-7299.95 15523.51,-7290.69 15523.11,-7281.69"/>
<polygon fill="black" stroke="black" points="15526.6,-7281.5 15522.67,-7271.66 15519.61,-7281.8 15526.6,-7281.5"/>
</g>
<!-- expert_1_5_fc1_10 -->
<g id="node707" class="node">
<title>expert_1_5_fc1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15940.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15940.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="15940.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15940.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15940.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_10&#45;&gt;expert_1_5_fc1_10 -->
<g id="edge856" class="edge">
<title>dispatch_1_10&#45;&gt;expert_1_5_fc1_10</title>
<path fill="none" stroke="black" d="M15927.96,-7309.97C15929.32,-7300.74 15930.75,-7291.04 15932.13,-7281.62"/>
<polygon fill="black" stroke="black" points="15935.62,-7281.95 15933.61,-7271.54 15928.69,-7280.93 15935.62,-7281.95"/>
</g>
<!-- expert_1_5_fc1_11 -->
<g id="node708" class="node">
<title>expert_1_5_fc1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16314.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16314.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16314.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16314.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16314.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_11&#45;&gt;expert_1_5_fc1_11 -->
<g id="edge857" class="edge">
<title>dispatch_1_11&#45;&gt;expert_1_5_fc1_11</title>
<path fill="none" stroke="black" d="M16314.57,-7308.03C16314.57,-7299.41 16314.57,-7290.44 16314.57,-7281.7"/>
<polygon fill="black" stroke="black" points="16318.07,-7281.58 16314.57,-7271.58 16311.07,-7281.58 16318.07,-7281.58"/>
</g>
<!-- expert_1_6_fc1_12 -->
<g id="node709" class="node">
<title>expert_1_6_fc1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16766.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16766.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="16766.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16766.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16766.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_12&#45;&gt;expert_1_6_fc1_12 -->
<g id="edge858" class="edge">
<title>dispatch_1_12&#45;&gt;expert_1_6_fc1_12</title>
<path fill="none" stroke="black" d="M16729.85,-7313.43C16734.25,-7302.72 16738.97,-7291.24 16743.52,-7280.2"/>
<polygon fill="black" stroke="black" points="16746.89,-7281.21 16747.46,-7270.63 16740.41,-7278.55 16746.89,-7281.21"/>
</g>
<!-- expert_1_6_fc1_13 -->
<g id="node710" class="node">
<title>expert_1_6_fc1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17260.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17260.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="17260.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17260.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17260.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_13&#45;&gt;expert_1_6_fc1_13 -->
<g id="edge859" class="edge">
<title>dispatch_1_13&#45;&gt;expert_1_6_fc1_13</title>
<path fill="none" stroke="black" d="M17150.82,-7320.53C17167.48,-7305.9 17186.56,-7289.15 17204.09,-7273.76"/>
<polygon fill="black" stroke="black" points="17206.82,-7276.03 17212.02,-7266.8 17202.2,-7270.77 17206.82,-7276.03"/>
</g>
<!-- expert_1_7_fc1_14 -->
<g id="node711" class="node">
<title>expert_1_7_fc1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17506.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17506.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="17506.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17506.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17506.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_14&#45;&gt;expert_1_7_fc1_14 -->
<g id="edge860" class="edge">
<title>dispatch_1_14&#45;&gt;expert_1_7_fc1_14</title>
<path fill="none" stroke="black" d="M17502.84,-7308.81C17503.23,-7299.95 17503.64,-7290.69 17504.04,-7281.69"/>
<polygon fill="black" stroke="black" points="17507.54,-7281.8 17504.48,-7271.66 17500.54,-7281.5 17507.54,-7281.8"/>
</g>
<!-- expert_1_7_fc1_15 -->
<g id="node712" class="node">
<title>expert_1_7_fc1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="17998.57" cy="-7223.17" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17998.57" y="-7241.97" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="17998.57" y="-7226.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17998.57" y="-7211.97" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17998.57" y="-7196.97" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_1_15&#45;&gt;expert_1_7_fc1_15 -->
<g id="edge861" class="edge">
<title>dispatch_1_15&#45;&gt;expert_1_7_fc1_15</title>
<path fill="none" stroke="black" d="M17951.41,-7314.57C17957.26,-7303.36 17963.59,-7291.23 17969.65,-7279.62"/>
<polygon fill="black" stroke="black" points="17972.91,-7280.93 17974.43,-7270.44 17966.71,-7277.69 17972.91,-7280.93"/>
</g>
<!-- expert_1_0_gelu_0 -->
<g id="node713" class="node">
<title>expert_1_0_gelu_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11694.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="11694.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="11694.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11694.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_0_fc1_0&#45;&gt;expert_1_0_gelu_0 -->
<g id="edge862" class="edge">
<title>expert_1_0_fc1_0&#45;&gt;expert_1_0_gelu_0</title>
<path fill="none" stroke="black" d="M11725.86,-7175.55C11721.94,-7166.31 11717.84,-7156.61 11713.94,-7147.39"/>
<polygon fill="black" stroke="black" points="11717.09,-7145.84 11709.97,-7137.99 11710.64,-7148.57 11717.09,-7145.84"/>
</g>
<!-- expert_1_0_gelu_1 -->
<g id="node716" class="node">
<title>expert_1_0_gelu_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12097.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12097.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="12097.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12097.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_0_fc1_1&#45;&gt;expert_1_0_gelu_1 -->
<g id="edge865" class="edge">
<title>expert_1_0_fc1_1&#45;&gt;expert_1_0_gelu_1</title>
<path fill="none" stroke="black" d="M12144.84,-7176.59C12138.53,-7166.58 12131.86,-7156 12125.59,-7146.04"/>
<polygon fill="black" stroke="black" points="12128.48,-7144.07 12120.19,-7137.47 12122.56,-7147.8 12128.48,-7144.07"/>
</g>
<!-- expert_1_1_gelu_2 -->
<g id="node718" class="node">
<title>expert_1_1_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12750.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12750.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="12750.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12750.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_1_fc1_2&#45;&gt;expert_1_1_gelu_2 -->
<g id="edge868" class="edge">
<title>expert_1_1_fc1_2&#45;&gt;expert_1_1_gelu_2</title>
<path fill="none" stroke="black" d="M12754.83,-7174.86C12754.32,-7166.14 12753.79,-7157.03 12753.29,-7148.32"/>
<polygon fill="black" stroke="black" points="12756.78,-7148.11 12752.71,-7138.33 12749.79,-7148.51 12756.78,-7148.11"/>
</g>
<!-- expert_1_1_gelu_3 -->
<g id="node721" class="node">
<title>expert_1_1_gelu_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13055.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13055.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="13055.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13055.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_1_fc1_3&#45;&gt;expert_1_1_gelu_3 -->
<g id="edge871" class="edge">
<title>expert_1_1_fc1_3&#45;&gt;expert_1_1_gelu_3</title>
<path fill="none" stroke="black" d="M13068.39,-7175.21C13066.85,-7166.37 13065.24,-7157.13 13063.71,-7148.29"/>
<polygon fill="black" stroke="black" points="13067.11,-7147.41 13061.94,-7138.16 13060.21,-7148.61 13067.11,-7147.41"/>
</g>
<!-- expert_1_2_gelu_4 -->
<g id="node723" class="node">
<title>expert_1_2_gelu_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13586.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13586.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13586.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13586.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_2_fc1_4&#45;&gt;expert_1_2_gelu_4 -->
<g id="edge874" class="edge">
<title>expert_1_2_fc1_4&#45;&gt;expert_1_2_gelu_4</title>
<path fill="none" stroke="black" d="M13574.42,-7174.86C13575.87,-7166.14 13577.38,-7157.03 13578.82,-7148.32"/>
<polygon fill="black" stroke="black" points="13582.3,-7148.77 13580.48,-7138.33 13575.39,-7147.62 13582.3,-7148.77"/>
</g>
<!-- expert_1_2_gelu_5 -->
<g id="node726" class="node">
<title>expert_1_2_gelu_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13911.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13911.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13911.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13911.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_2_fc1_5&#45;&gt;expert_1_2_gelu_5 -->
<g id="edge877" class="edge">
<title>expert_1_2_fc1_5&#45;&gt;expert_1_2_gelu_5</title>
<path fill="none" stroke="black" d="M13933.55,-7175.21C13930.88,-7166.27 13928.09,-7156.92 13925.43,-7148.01"/>
<polygon fill="black" stroke="black" points="13928.71,-7146.74 13922.49,-7138.16 13922,-7148.75 13928.71,-7146.74"/>
</g>
<!-- expert_1_3_gelu_6 -->
<g id="node728" class="node">
<title>expert_1_3_gelu_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14368.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14368.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14368.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14368.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_3_fc1_6&#45;&gt;expert_1_3_gelu_6 -->
<g id="edge880" class="edge">
<title>expert_1_3_fc1_6&#45;&gt;expert_1_3_gelu_6</title>
<path fill="none" stroke="black" d="M14355.75,-7175.21C14357.29,-7166.37 14358.9,-7157.13 14360.44,-7148.29"/>
<polygon fill="black" stroke="black" points="14363.94,-7148.61 14362.2,-7138.16 14357.04,-7147.41 14363.94,-7148.61"/>
</g>
<!-- expert_1_3_gelu_7 -->
<g id="node731" class="node">
<title>expert_1_3_gelu_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14693.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14693.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14693.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14693.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_3_fc1_7&#45;&gt;expert_1_3_gelu_7 -->
<g id="edge883" class="edge">
<title>expert_1_3_fc1_7&#45;&gt;expert_1_3_gelu_7</title>
<path fill="none" stroke="black" d="M14714.94,-7175.21C14712.35,-7166.27 14709.63,-7156.92 14707.05,-7148.01"/>
<polygon fill="black" stroke="black" points="14710.34,-7146.79 14704.19,-7138.16 14703.61,-7148.74 14710.34,-7146.79"/>
</g>
<!-- expert_1_4_gelu_8 -->
<g id="node733" class="node">
<title>expert_1_4_gelu_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15165.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15165.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15165.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15165.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_4_fc1_8&#45;&gt;expert_1_4_gelu_8 -->
<g id="edge886" class="edge">
<title>expert_1_4_fc1_8&#45;&gt;expert_1_4_gelu_8</title>
<path fill="none" stroke="black" d="M15152.75,-7175.21C15154.29,-7166.37 15155.9,-7157.13 15157.44,-7148.29"/>
<polygon fill="black" stroke="black" points="15160.94,-7148.61 15159.2,-7138.16 15154.04,-7147.41 15160.94,-7148.61"/>
</g>
<!-- expert_1_4_gelu_9 -->
<g id="node736" class="node">
<title>expert_1_4_gelu_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15490.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15490.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15490.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15490.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_4_fc1_9&#45;&gt;expert_1_4_gelu_9 -->
<g id="edge889" class="edge">
<title>expert_1_4_fc1_9&#45;&gt;expert_1_4_gelu_9</title>
<path fill="none" stroke="black" d="M15508.89,-7175.21C15506.67,-7166.27 15504.34,-7156.92 15502.12,-7148.01"/>
<polygon fill="black" stroke="black" points="15505.48,-7147.02 15499.67,-7138.16 15498.69,-7148.71 15505.48,-7147.02"/>
</g>
<!-- expert_1_5_gelu_10 -->
<g id="node738" class="node">
<title>expert_1_5_gelu_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15971.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15971.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="15971.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15971.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_5_fc1_10&#45;&gt;expert_1_5_gelu_10 -->
<g id="edge892" class="edge">
<title>expert_1_5_fc1_10&#45;&gt;expert_1_5_gelu_10</title>
<path fill="none" stroke="black" d="M15952.65,-7175.21C15954.95,-7166.27 15957.35,-7156.92 15959.64,-7148.01"/>
<polygon fill="black" stroke="black" points="15963.07,-7148.72 15962.17,-7138.16 15956.29,-7146.98 15963.07,-7148.72"/>
</g>
<!-- expert_1_5_gelu_11 -->
<g id="node741" class="node">
<title>expert_1_5_gelu_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16296.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16296.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16296.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16296.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_5_fc1_11&#45;&gt;expert_1_5_gelu_11 -->
<g id="edge895" class="edge">
<title>expert_1_5_fc1_11&#45;&gt;expert_1_5_gelu_11</title>
<path fill="none" stroke="black" d="M16307.51,-7174.86C16306.21,-7166.14 16304.85,-7157.03 16303.55,-7148.32"/>
<polygon fill="black" stroke="black" points="16307,-7147.7 16302.06,-7138.33 16300.07,-7148.74 16307,-7147.7"/>
</g>
<!-- expert_1_6_gelu_12 -->
<g id="node743" class="node">
<title>expert_1_6_gelu_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16877.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16877.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="16877.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16877.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_6_fc1_12&#45;&gt;expert_1_6_gelu_12 -->
<g id="edge898" class="edge">
<title>expert_1_6_fc1_12&#45;&gt;expert_1_6_gelu_12</title>
<path fill="none" stroke="black" d="M16807.28,-7177.96C16817.43,-7166.93 16828.3,-7155.12 16838.38,-7144.17"/>
<polygon fill="black" stroke="black" points="16841.02,-7146.47 16845.21,-7136.75 16835.87,-7141.73 16841.02,-7146.47"/>
</g>
<!-- expert_1_6_gelu_13 -->
<g id="node746" class="node">
<title>expert_1_6_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17269.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17269.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="17269.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17269.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_6_fc1_13&#45;&gt;expert_1_6_gelu_13 -->
<g id="edge901" class="edge">
<title>expert_1_6_fc1_13&#45;&gt;expert_1_6_gelu_13</title>
<path fill="none" stroke="black" d="M17264.1,-7174.86C17264.76,-7166.14 17265.44,-7157.03 17266.09,-7148.32"/>
<polygon fill="black" stroke="black" points="17269.58,-7148.56 17266.83,-7138.33 17262.6,-7148.04 17269.58,-7148.56"/>
</g>
<!-- expert_1_7_gelu_14 -->
<g id="node748" class="node">
<title>expert_1_7_gelu_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17702.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17702.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="17702.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17702.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_7_fc1_14&#45;&gt;expert_1_7_gelu_14 -->
<g id="edge904" class="edge">
<title>expert_1_7_fc1_14&#45;&gt;expert_1_7_gelu_14</title>
<path fill="none" stroke="black" d="M17569.67,-7183.36C17592.49,-7169.32 17618.22,-7153.49 17640.92,-7139.52"/>
<polygon fill="black" stroke="black" points="17642.77,-7142.49 17649.46,-7134.27 17639.11,-7136.53 17642.77,-7142.49"/>
</g>
<!-- expert_1_7_gelu_15 -->
<g id="node751" class="node">
<title>expert_1_7_gelu_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18139.57" cy="-7100.59" rx="119" ry="37.5"/>
<text text-anchor="middle" x="18139.57" y="-7111.89" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="18139.57" y="-7096.89" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18139.57" y="-7081.89" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_1_7_fc1_15&#45;&gt;expert_1_7_gelu_15 -->
<g id="edge907" class="edge">
<title>expert_1_7_fc1_15&#45;&gt;expert_1_7_gelu_15</title>
<path fill="none" stroke="black" d="M18048.28,-7179.66C18062.2,-7167.76 18077.31,-7154.84 18091.15,-7143"/>
<polygon fill="black" stroke="black" points="18093.81,-7145.33 18099.14,-7136.17 18089.26,-7140.01 18093.81,-7145.33"/>
</g>
<!-- expert_1_0_fc2_0 -->
<g id="node714" class="node">
<title>expert_1_0_fc2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11681.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11681.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11681.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11681.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11681.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_0_gelu_0&#45;&gt;expert_1_0_fc2_0 -->
<g id="edge863" class="edge">
<title>expert_1_0_gelu_0&#45;&gt;expert_1_0_fc2_0</title>
<path fill="none" stroke="black" d="M11690.64,-7063.09C11689.73,-7054.62 11688.73,-7045.42 11687.75,-7036.3"/>
<polygon fill="black" stroke="black" points="11691.2,-7035.67 11686.65,-7026.1 11684.24,-7036.42 11691.2,-7035.67"/>
</g>
<!-- allreduce_expert_1_0 -->
<g id="node715" class="node">
<title>allreduce_expert_1_0</title>
<polygon fill="red" stroke="black" points="11678.57,-6892.93 11523.57,-6839.93 11678.57,-6786.93 11833.57,-6839.93 11678.57,-6892.93"/>
<text text-anchor="middle" x="11678.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 0</text>
<text text-anchor="middle" x="11678.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11678.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 0&#45;1</text>
</g>
<!-- expert_1_0_fc2_0&#45;&gt;allreduce_expert_1_0 -->
<g id="edge864" class="edge">
<title>expert_1_0_fc2_0&#45;&gt;allreduce_expert_1_0</title>
<path fill="none" stroke="black" d="M11680.53,-6929.79C11680.34,-6921.09 11680.14,-6911.89 11679.94,-6902.83"/>
<polygon fill="black" stroke="black" points="11683.43,-6902.62 11679.71,-6892.7 11676.44,-6902.78 11683.43,-6902.62"/>
</g>
<!-- combine_experts_1_0 -->
<g id="node753" class="node">
<title>combine_experts_1_0</title>
<polygon fill="purple" stroke="black" points="11162.57,-6749.93 10915.57,-6696.93 11162.57,-6643.93 11409.57,-6696.93 11162.57,-6749.93"/>
<text text-anchor="middle" x="11162.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11162.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11162.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_0&#45;&gt;combine_experts_1_0 -->
<g id="edge910" class="edge">
<title>allreduce_expert_1_0&#45;&gt;combine_experts_1_0</title>
<path fill="none" stroke="black" d="M11593.94,-6815.8C11508.12,-6792.35 11374.64,-6755.87 11278.9,-6729.71"/>
<polygon fill="black" stroke="black" points="11279.74,-6726.31 11269.17,-6727.05 11277.9,-6733.07 11279.74,-6726.31"/>
</g>
<!-- combine_experts_1_1 -->
<g id="node754" class="node">
<title>combine_experts_1_1</title>
<polygon fill="purple" stroke="black" points="11674.57,-6749.93 11427.57,-6696.93 11674.57,-6643.93 11921.57,-6696.93 11674.57,-6749.93"/>
<text text-anchor="middle" x="11674.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11674.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11674.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_0&#45;&gt;combine_experts_1_1 -->
<g id="edge911" class="edge">
<title>allreduce_expert_1_0&#45;&gt;combine_experts_1_1</title>
<path fill="none" stroke="black" d="M11677.11,-6787.22C11676.85,-6778.31 11676.59,-6768.97 11676.33,-6759.83"/>
<polygon fill="black" stroke="black" points="11679.82,-6759.52 11676.04,-6749.62 11672.83,-6759.72 11679.82,-6759.52"/>
</g>
<!-- expert_1_0_fc2_1 -->
<g id="node717" class="node">
<title>expert_1_0_fc2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="11945.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11945.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11945.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11945.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11945.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_0_gelu_1&#45;&gt;expert_1_0_fc2_1 -->
<g id="edge866" class="edge">
<title>expert_1_0_gelu_1&#45;&gt;expert_1_0_fc2_1</title>
<path fill="none" stroke="black" d="M12054.42,-7065.36C12039.34,-7053.39 12022.11,-7039.73 12005.89,-7026.86"/>
<polygon fill="black" stroke="black" points="12008.03,-7024.08 11998.02,-7020.61 12003.68,-7029.57 12008.03,-7024.08"/>
</g>
<!-- expert_1_0_fc2_1&#45;&gt;allreduce_expert_1_0 -->
<g id="edge867" class="edge">
<title>expert_1_0_fc2_1&#45;&gt;allreduce_expert_1_0</title>
<path fill="none" stroke="black" d="M11874.37,-6940.72C11835.62,-6920.97 11787.83,-6896.61 11749.17,-6876.9"/>
<polygon fill="black" stroke="black" points="11750.55,-6873.68 11740.05,-6872.26 11747.37,-6879.92 11750.55,-6873.68"/>
</g>
<!-- expert_1_1_fc2_2 -->
<g id="node719" class="node">
<title>expert_1_1_fc2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12737.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12737.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="12737.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12737.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12737.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_1_gelu_2&#45;&gt;expert_1_1_fc2_2 -->
<g id="edge869" class="edge">
<title>expert_1_1_gelu_2&#45;&gt;expert_1_1_fc2_2</title>
<path fill="none" stroke="black" d="M12746.64,-7063.09C12745.73,-7054.62 12744.73,-7045.42 12743.75,-7036.3"/>
<polygon fill="black" stroke="black" points="12747.2,-7035.67 12742.65,-7026.1 12740.24,-7036.42 12747.2,-7035.67"/>
</g>
<!-- allreduce_expert_1_1 -->
<g id="node720" class="node">
<title>allreduce_expert_1_1</title>
<polygon fill="red" stroke="black" points="12711.57,-6892.93 12556.57,-6839.93 12711.57,-6786.93 12866.57,-6839.93 12711.57,-6892.93"/>
<text text-anchor="middle" x="12711.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 1</text>
<text text-anchor="middle" x="12711.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="12711.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 2&#45;3</text>
</g>
<!-- expert_1_1_fc2_2&#45;&gt;allreduce_expert_1_1 -->
<g id="edge870" class="edge">
<title>expert_1_1_fc2_2&#45;&gt;allreduce_expert_1_1</title>
<path fill="none" stroke="black" d="M12728.55,-6929.79C12726.7,-6920.12 12724.74,-6909.83 12722.82,-6899.8"/>
<polygon fill="black" stroke="black" points="12726.25,-6899.07 12720.93,-6889.9 12719.37,-6900.38 12726.25,-6899.07"/>
</g>
<!-- combine_experts_1_2 -->
<g id="node755" class="node">
<title>combine_experts_1_2</title>
<polygon fill="purple" stroke="black" points="12186.57,-6749.93 11939.57,-6696.93 12186.57,-6643.93 12433.57,-6696.93 12186.57,-6749.93"/>
<text text-anchor="middle" x="12186.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12186.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12186.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_1&#45;&gt;combine_experts_1_2 -->
<g id="edge912" class="edge">
<title>allreduce_expert_1_1&#45;&gt;combine_experts_1_2</title>
<path fill="none" stroke="black" d="M12626.35,-6816.04C12538.9,-6792.55 12402.17,-6755.83 12304.39,-6729.57"/>
<polygon fill="black" stroke="black" points="12305.03,-6726.11 12294.46,-6726.9 12303.21,-6732.87 12305.03,-6726.11"/>
</g>
<!-- combine_experts_1_3 -->
<g id="node756" class="node">
<title>combine_experts_1_3</title>
<polygon fill="purple" stroke="black" points="12698.57,-6749.93 12451.57,-6696.93 12698.57,-6643.93 12945.57,-6696.93 12698.57,-6749.93"/>
<text text-anchor="middle" x="12698.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12698.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12698.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_1&#45;&gt;combine_experts_1_3 -->
<g id="edge913" class="edge">
<title>allreduce_expert_1_1&#45;&gt;combine_experts_1_3</title>
<path fill="none" stroke="black" d="M12706.92,-6788.42C12706.04,-6778.92 12705.12,-6768.89 12704.21,-6759.1"/>
<polygon fill="black" stroke="black" points="12707.69,-6758.66 12703.28,-6749.03 12700.72,-6759.31 12707.69,-6758.66"/>
</g>
<!-- expert_1_1_fc2_3 -->
<g id="node722" class="node">
<title>expert_1_1_fc2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13031.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13031.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="13031.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13031.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13031.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_1_gelu_3&#45;&gt;expert_1_1_fc2_3 -->
<g id="edge872" class="edge">
<title>expert_1_1_gelu_3&#45;&gt;expert_1_1_fc2_3</title>
<path fill="none" stroke="black" d="M13048.31,-7063.09C13046.61,-7054.53 13044.75,-7045.22 13042.92,-7036.01"/>
<polygon fill="black" stroke="black" points="13046.33,-7035.22 13040.95,-7026.1 13039.47,-7036.59 13046.33,-7035.22"/>
</g>
<!-- expert_1_1_fc2_3&#45;&gt;allreduce_expert_1_1 -->
<g id="edge873" class="edge">
<title>expert_1_1_fc2_3&#45;&gt;allreduce_expert_1_1</title>
<path fill="none" stroke="black" d="M12952.88,-6943.54C12902.9,-6922.29 12838.5,-6894.9 12788.8,-6873.77"/>
<polygon fill="black" stroke="black" points="12789.96,-6870.45 12779.38,-6869.76 12787.22,-6876.9 12789.96,-6870.45"/>
</g>
<!-- expert_1_2_fc2_4 -->
<g id="node724" class="node">
<title>expert_1_2_fc2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13594.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13594.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13594.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13594.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13594.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_2_gelu_4&#45;&gt;expert_1_2_fc2_4 -->
<g id="edge875" class="edge">
<title>expert_1_2_gelu_4&#45;&gt;expert_1_2_fc2_4</title>
<path fill="none" stroke="black" d="M13589,-7063.09C13589.56,-7054.62 13590.17,-7045.42 13590.77,-7036.3"/>
<polygon fill="black" stroke="black" points="13594.28,-7036.31 13591.45,-7026.1 13587.29,-7035.84 13594.28,-7036.31"/>
</g>
<!-- allreduce_expert_1_2 -->
<g id="node725" class="node">
<title>allreduce_expert_1_2</title>
<polygon fill="red" stroke="black" points="13606.57,-6892.93 13451.57,-6839.93 13606.57,-6786.93 13761.57,-6839.93 13606.57,-6892.93"/>
<text text-anchor="middle" x="13606.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 2</text>
<text text-anchor="middle" x="13606.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13606.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 4&#45;5</text>
</g>
<!-- expert_1_2_fc2_4&#45;&gt;allreduce_expert_1_2 -->
<g id="edge876" class="edge">
<title>expert_1_2_fc2_4&#45;&gt;allreduce_expert_1_2</title>
<path fill="none" stroke="black" d="M13598.74,-6929.79C13599.53,-6920.77 13600.38,-6911.21 13601.2,-6901.84"/>
<polygon fill="black" stroke="black" points="13604.7,-6902.04 13602.09,-6891.77 13597.73,-6901.42 13604.7,-6902.04"/>
</g>
<!-- combine_experts_1_4 -->
<g id="node757" class="node">
<title>combine_experts_1_4</title>
<polygon fill="purple" stroke="black" points="13210.57,-6749.93 12963.57,-6696.93 13210.57,-6643.93 13457.57,-6696.93 13210.57,-6749.93"/>
<text text-anchor="middle" x="13210.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13210.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13210.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_2&#45;&gt;combine_experts_1_4 -->
<g id="edge914" class="edge">
<title>allreduce_expert_1_2&#45;&gt;combine_experts_1_4</title>
<path fill="none" stroke="black" d="M13531.62,-6812.24C13469.3,-6790.05 13380.04,-6758.27 13311.45,-6733.84"/>
<polygon fill="black" stroke="black" points="13312.51,-6730.5 13301.91,-6730.45 13310.16,-6737.1 13312.51,-6730.5"/>
</g>
<!-- combine_experts_1_5 -->
<g id="node758" class="node">
<title>combine_experts_1_5</title>
<polygon fill="purple" stroke="black" points="13722.57,-6749.93 13475.57,-6696.93 13722.57,-6643.93 13969.57,-6696.93 13722.57,-6749.93"/>
<text text-anchor="middle" x="13722.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13722.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13722.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_2&#45;&gt;combine_experts_1_5 -->
<g id="edge915" class="edge">
<title>allreduce_expert_1_2&#45;&gt;combine_experts_1_5</title>
<path fill="none" stroke="black" d="M13640.13,-6798.14C13652.32,-6783.32 13666.28,-6766.35 13679.2,-6750.65"/>
<polygon fill="black" stroke="black" points="13682.2,-6752.51 13685.85,-6742.57 13676.79,-6748.06 13682.2,-6752.51"/>
</g>
<!-- expert_1_2_fc2_5 -->
<g id="node727" class="node">
<title>expert_1_2_fc2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13871.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13871.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13871.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13871.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13871.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_2_gelu_5&#45;&gt;expert_1_2_fc2_5 -->
<g id="edge878" class="edge">
<title>expert_1_2_gelu_5&#45;&gt;expert_1_2_fc2_5</title>
<path fill="none" stroke="black" d="M13899.46,-7063.09C13896.56,-7054.34 13893.4,-7044.8 13890.27,-7035.38"/>
<polygon fill="black" stroke="black" points="13893.52,-7034.05 13887.05,-7025.66 13886.88,-7036.25 13893.52,-7034.05"/>
</g>
<!-- expert_1_2_fc2_5&#45;&gt;allreduce_expert_1_2 -->
<g id="edge879" class="edge">
<title>expert_1_2_fc2_5&#45;&gt;allreduce_expert_1_2</title>
<path fill="none" stroke="black" d="M13800.56,-6940.54C13762.09,-6920.79 13714.75,-6896.47 13676.46,-6876.81"/>
<polygon fill="black" stroke="black" points="13677.93,-6873.63 13667.43,-6872.18 13674.73,-6879.86 13677.93,-6873.63"/>
</g>
<!-- expert_1_3_fc2_6 -->
<g id="node729" class="node">
<title>expert_1_3_fc2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14407.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14407.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14407.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14407.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14407.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_3_gelu_6&#45;&gt;expert_1_3_fc2_6 -->
<g id="edge881" class="edge">
<title>expert_1_3_gelu_6&#45;&gt;expert_1_3_fc2_6</title>
<path fill="none" stroke="black" d="M14380.38,-7063.09C14383.21,-7054.34 14386.3,-7044.8 14389.34,-7035.38"/>
<polygon fill="black" stroke="black" points="14392.74,-7036.25 14392.49,-7025.66 14386.08,-7034.1 14392.74,-7036.25"/>
</g>
<!-- allreduce_expert_1_3 -->
<g id="node730" class="node">
<title>allreduce_expert_1_3</title>
<polygon fill="red" stroke="black" points="14577.57,-6892.93 14422.57,-6839.93 14577.57,-6786.93 14732.57,-6839.93 14577.57,-6892.93"/>
<text text-anchor="middle" x="14577.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 3</text>
<text text-anchor="middle" x="14577.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14577.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 6&#45;7</text>
</g>
<!-- expert_1_3_fc2_6&#45;&gt;allreduce_expert_1_3 -->
<g id="edge882" class="edge">
<title>expert_1_3_fc2_6&#45;&gt;allreduce_expert_1_3</title>
<path fill="none" stroke="black" d="M14459.97,-6935.07C14480.29,-6918.8 14503.55,-6900.18 14523.99,-6883.82"/>
<polygon fill="black" stroke="black" points="14526.34,-6886.42 14531.96,-6877.43 14521.97,-6880.95 14526.34,-6886.42"/>
</g>
<!-- combine_experts_1_6 -->
<g id="node759" class="node">
<title>combine_experts_1_6</title>
<polygon fill="purple" stroke="black" points="14234.57,-6749.93 13987.57,-6696.93 14234.57,-6643.93 14481.57,-6696.93 14234.57,-6749.93"/>
<text text-anchor="middle" x="14234.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14234.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14234.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_3&#45;&gt;combine_experts_1_6 -->
<g id="edge916" class="edge">
<title>allreduce_expert_1_3&#45;&gt;combine_experts_1_6</title>
<path fill="none" stroke="black" d="M14508.16,-6810.39C14456.06,-6788.97 14384.18,-6759.43 14327.18,-6735.99"/>
<polygon fill="black" stroke="black" points="14328.38,-6732.7 14317.8,-6732.14 14325.72,-6739.18 14328.38,-6732.7"/>
</g>
<!-- combine_experts_1_7 -->
<g id="node760" class="node">
<title>combine_experts_1_7</title>
<polygon fill="purple" stroke="black" points="14746.57,-6749.93 14499.57,-6696.93 14746.57,-6643.93 14993.57,-6696.93 14746.57,-6749.93"/>
<text text-anchor="middle" x="14746.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14746.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14746.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_3&#45;&gt;combine_experts_1_7 -->
<g id="edge917" class="edge">
<title>allreduce_expert_1_3&#45;&gt;combine_experts_1_7</title>
<path fill="none" stroke="black" d="M14621.98,-6801.88C14642.44,-6784.8 14667,-6764.32 14688.88,-6746.06"/>
<polygon fill="black" stroke="black" points="14691.37,-6748.54 14696.81,-6739.45 14686.89,-6743.17 14691.37,-6748.54"/>
</g>
<!-- expert_1_3_fc2_7 -->
<g id="node732" class="node">
<title>expert_1_3_fc2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14669.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14669.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14669.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14669.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14669.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_3_gelu_7&#45;&gt;expert_1_3_fc2_7 -->
<g id="edge884" class="edge">
<title>expert_1_3_gelu_7&#45;&gt;expert_1_3_fc2_7</title>
<path fill="none" stroke="black" d="M14686.31,-7063.09C14684.61,-7054.53 14682.75,-7045.22 14680.92,-7036.01"/>
<polygon fill="black" stroke="black" points="14684.33,-7035.22 14678.95,-7026.1 14677.47,-7036.59 14684.33,-7035.22"/>
</g>
<!-- expert_1_3_fc2_7&#45;&gt;allreduce_expert_1_3 -->
<g id="edge885" class="edge">
<title>expert_1_3_fc2_7&#45;&gt;allreduce_expert_1_3</title>
<path fill="none" stroke="black" d="M14638.94,-6931.69C14630.28,-6918.88 14620.79,-6904.86 14611.93,-6891.74"/>
<polygon fill="black" stroke="black" points="14614.71,-6889.6 14606.21,-6883.28 14608.91,-6893.53 14614.71,-6889.6"/>
</g>
<!-- expert_1_4_fc2_8 -->
<g id="node734" class="node">
<title>expert_1_4_fc2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15204.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15204.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15204.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15204.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15204.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_4_gelu_8&#45;&gt;expert_1_4_fc2_8 -->
<g id="edge887" class="edge">
<title>expert_1_4_gelu_8&#45;&gt;expert_1_4_fc2_8</title>
<path fill="none" stroke="black" d="M15177.38,-7063.09C15180.21,-7054.34 15183.3,-7044.8 15186.34,-7035.38"/>
<polygon fill="black" stroke="black" points="15189.74,-7036.25 15189.49,-7025.66 15183.08,-7034.1 15189.74,-7036.25"/>
</g>
<!-- allreduce_expert_1_4 -->
<g id="node735" class="node">
<title>allreduce_expert_1_4</title>
<polygon fill="red" stroke="black" points="15320.57,-6892.93 15165.57,-6839.93 15320.57,-6786.93 15475.57,-6839.93 15320.57,-6892.93"/>
<text text-anchor="middle" x="15320.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 4</text>
<text text-anchor="middle" x="15320.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="15320.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 8&#45;9</text>
</g>
<!-- expert_1_4_fc2_8&#45;&gt;allreduce_expert_1_4 -->
<g id="edge888" class="edge">
<title>expert_1_4_fc2_8&#45;&gt;allreduce_expert_1_4</title>
<path fill="none" stroke="black" d="M15242.56,-6932.45C15254.38,-6918.58 15267.46,-6903.24 15279.48,-6889.13"/>
<polygon fill="black" stroke="black" points="15282.21,-6891.32 15286.03,-6881.44 15276.88,-6886.78 15282.21,-6891.32"/>
</g>
<!-- combine_experts_1_8 -->
<g id="node761" class="node">
<title>combine_experts_1_8</title>
<polygon fill="purple" stroke="black" points="15258.57,-6749.93 15011.57,-6696.93 15258.57,-6643.93 15505.57,-6696.93 15258.57,-6749.93"/>
<text text-anchor="middle" x="15258.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15258.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15258.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_4&#45;&gt;combine_experts_1_8 -->
<g id="edge918" class="edge">
<title>allreduce_expert_1_4&#45;&gt;combine_experts_1_8</title>
<path fill="none" stroke="black" d="M15300.61,-6793.54C15295.2,-6781.23 15289.27,-6767.74 15283.62,-6754.89"/>
<polygon fill="black" stroke="black" points="15286.79,-6753.4 15279.56,-6745.66 15280.38,-6756.22 15286.79,-6753.4"/>
</g>
<!-- combine_experts_1_9 -->
<g id="node762" class="node">
<title>combine_experts_1_9</title>
<polygon fill="purple" stroke="black" points="15770.57,-6749.93 15523.57,-6696.93 15770.57,-6643.93 16017.57,-6696.93 15770.57,-6749.93"/>
<text text-anchor="middle" x="15770.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15770.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15770.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_4&#45;&gt;combine_experts_1_9 -->
<g id="edge919" class="edge">
<title>allreduce_expert_1_4&#45;&gt;combine_experts_1_9</title>
<path fill="none" stroke="black" d="M15399.99,-6814.04C15472.85,-6791.21 15581.4,-6757.2 15662.21,-6731.88"/>
<polygon fill="black" stroke="black" points="15663.43,-6735.17 15671.92,-6728.84 15661.33,-6728.49 15663.43,-6735.17"/>
</g>
<!-- expert_1_4_fc2_9 -->
<g id="node737" class="node">
<title>expert_1_4_fc2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15466.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15466.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15466.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15466.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15466.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_4_gelu_9&#45;&gt;expert_1_4_fc2_9 -->
<g id="edge890" class="edge">
<title>expert_1_4_gelu_9&#45;&gt;expert_1_4_fc2_9</title>
<path fill="none" stroke="black" d="M15483.31,-7063.09C15481.61,-7054.53 15479.75,-7045.22 15477.92,-7036.01"/>
<polygon fill="black" stroke="black" points="15481.33,-7035.22 15475.95,-7026.1 15474.47,-7036.59 15481.33,-7035.22"/>
</g>
<!-- expert_1_4_fc2_9&#45;&gt;allreduce_expert_1_4 -->
<g id="edge891" class="edge">
<title>expert_1_4_fc2_9&#45;&gt;allreduce_expert_1_4</title>
<path fill="none" stroke="black" d="M15420.38,-6933.95C15404.01,-6918.69 15385.54,-6901.48 15368.99,-6886.05"/>
<polygon fill="black" stroke="black" points="15371.24,-6883.36 15361.53,-6879.1 15366.46,-6888.48 15371.24,-6883.36"/>
</g>
<!-- expert_1_5_fc2_10 -->
<g id="node739" class="node">
<title>expert_1_5_fc2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16047.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16047.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16047.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16047.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16047.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_5_gelu_10&#45;&gt;expert_1_5_fc2_10 -->
<g id="edge893" class="edge">
<title>expert_1_5_gelu_10&#45;&gt;expert_1_5_fc2_10</title>
<path fill="none" stroke="black" d="M15994.17,-7063.74C16000.19,-7054.19 16006.82,-7043.66 16013.31,-7033.37"/>
<polygon fill="black" stroke="black" points="16016.34,-7035.13 16018.71,-7024.8 16010.42,-7031.39 16016.34,-7035.13"/>
</g>
<!-- allreduce_expert_1_5 -->
<g id="node740" class="node">
<title>allreduce_expert_1_5</title>
<polygon fill="red" stroke="black" points="16289.57,-6892.93 16134.57,-6839.93 16289.57,-6786.93 16444.57,-6839.93 16289.57,-6892.93"/>
<text text-anchor="middle" x="16289.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 5</text>
<text text-anchor="middle" x="16289.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="16289.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 10&#45;11</text>
</g>
<!-- expert_1_5_fc2_10&#45;&gt;allreduce_expert_1_5 -->
<g id="edge894" class="edge">
<title>expert_1_5_fc2_10&#45;&gt;allreduce_expert_1_5</title>
<path fill="none" stroke="black" d="M16114.66,-6939.28C16148.43,-6920.29 16189.25,-6897.34 16222.95,-6878.39"/>
<polygon fill="black" stroke="black" points="16224.81,-6881.36 16231.81,-6873.41 16221.38,-6875.26 16224.81,-6881.36"/>
</g>
<!-- combine_experts_1_10 -->
<g id="node763" class="node">
<title>combine_experts_1_10</title>
<polygon fill="purple" stroke="black" points="16282.57,-6749.93 16035.57,-6696.93 16282.57,-6643.93 16529.57,-6696.93 16282.57,-6749.93"/>
<text text-anchor="middle" x="16282.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16282.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16282.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_5&#45;&gt;combine_experts_1_10 -->
<g id="edge920" class="edge">
<title>allreduce_expert_1_5&#45;&gt;combine_experts_1_10</title>
<path fill="none" stroke="black" d="M16287.03,-6787.62C16286.57,-6778.49 16286.1,-6768.88 16285.63,-6759.5"/>
<polygon fill="black" stroke="black" points="16289.12,-6759.24 16285.13,-6749.43 16282.13,-6759.59 16289.12,-6759.24"/>
</g>
<!-- combine_experts_1_11 -->
<g id="node764" class="node">
<title>combine_experts_1_11</title>
<polygon fill="purple" stroke="black" points="16794.57,-6749.93 16547.57,-6696.93 16794.57,-6643.93 17041.57,-6696.93 16794.57,-6749.93"/>
<text text-anchor="middle" x="16794.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16794.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16794.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_5&#45;&gt;combine_experts_1_11 -->
<g id="edge921" class="edge">
<title>allreduce_expert_1_5&#45;&gt;combine_experts_1_11</title>
<path fill="none" stroke="black" d="M16373.53,-6815.48C16457.1,-6792.15 16585.99,-6756.16 16679.16,-6730.15"/>
<polygon fill="black" stroke="black" points="16680.22,-6733.49 16688.91,-6727.43 16678.34,-6726.75 16680.22,-6733.49"/>
</g>
<!-- expert_1_5_fc2_11 -->
<g id="node742" class="node">
<title>expert_1_5_fc2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16296.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16296.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16296.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16296.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16296.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_5_gelu_11&#45;&gt;expert_1_5_fc2_11 -->
<g id="edge896" class="edge">
<title>expert_1_5_gelu_11&#45;&gt;expert_1_5_fc2_11</title>
<path fill="none" stroke="black" d="M16296.57,-7063.09C16296.57,-7054.62 16296.57,-7045.42 16296.57,-7036.3"/>
<polygon fill="black" stroke="black" points="16300.07,-7036.1 16296.57,-7026.1 16293.07,-7036.1 16300.07,-7036.1"/>
</g>
<!-- expert_1_5_fc2_11&#45;&gt;allreduce_expert_1_5 -->
<g id="edge897" class="edge">
<title>expert_1_5_fc2_11&#45;&gt;allreduce_expert_1_5</title>
<path fill="none" stroke="black" d="M16294.14,-6929.79C16293.69,-6920.98 16293.21,-6911.65 16292.74,-6902.48"/>
<polygon fill="black" stroke="black" points="16296.22,-6902.04 16292.21,-6892.23 16289.23,-6902.4 16296.22,-6902.04"/>
</g>
<!-- expert_1_6_fc2_12 -->
<g id="node744" class="node">
<title>expert_1_6_fc2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16910.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16910.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="16910.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16910.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16910.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_6_gelu_12&#45;&gt;expert_1_6_fc2_12 -->
<g id="edge899" class="edge">
<title>expert_1_6_gelu_12&#45;&gt;expert_1_6_fc2_12</title>
<path fill="none" stroke="black" d="M16887.56,-7063.09C16889.9,-7054.53 16892.45,-7045.22 16894.97,-7036.01"/>
<polygon fill="black" stroke="black" points="16898.42,-7036.67 16897.69,-7026.1 16891.67,-7034.82 16898.42,-7036.67"/>
</g>
<!-- allreduce_expert_1_6 -->
<g id="node745" class="node">
<title>allreduce_expert_1_6</title>
<polygon fill="red" stroke="black" points="17306.57,-6892.93 17151.57,-6839.93 17306.57,-6786.93 17461.57,-6839.93 17306.57,-6892.93"/>
<text text-anchor="middle" x="17306.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 6</text>
<text text-anchor="middle" x="17306.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="17306.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 12&#45;13</text>
</g>
<!-- expert_1_6_fc2_12&#45;&gt;allreduce_expert_1_6 -->
<g id="edge900" class="edge">
<title>expert_1_6_fc2_12&#45;&gt;allreduce_expert_1_6</title>
<path fill="none" stroke="black" d="M16997.48,-6947.14C17063.88,-6924.33 17154.93,-6893.04 17221,-6870.33"/>
<polygon fill="black" stroke="black" points="17222.24,-6873.61 17230.56,-6867.05 17219.97,-6866.99 17222.24,-6873.61"/>
</g>
<!-- combine_experts_1_12 -->
<g id="node765" class="node">
<title>combine_experts_1_12</title>
<polygon fill="purple" stroke="black" points="17306.57,-6749.93 17059.57,-6696.93 17306.57,-6643.93 17553.57,-6696.93 17306.57,-6749.93"/>
<text text-anchor="middle" x="17306.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17306.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17306.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_6&#45;&gt;combine_experts_1_12 -->
<g id="edge922" class="edge">
<title>allreduce_expert_1_6&#45;&gt;combine_experts_1_12</title>
<path fill="none" stroke="black" d="M17306.57,-6786.82C17306.57,-6778.25 17306.57,-6769.29 17306.57,-6760.5"/>
<polygon fill="black" stroke="black" points="17310.07,-6760.28 17306.57,-6750.28 17303.07,-6760.28 17310.07,-6760.28"/>
</g>
<!-- combine_experts_1_13 -->
<g id="node766" class="node">
<title>combine_experts_1_13</title>
<polygon fill="purple" stroke="black" points="17818.57,-6749.93 17571.57,-6696.93 17818.57,-6643.93 18065.57,-6696.93 17818.57,-6749.93"/>
<text text-anchor="middle" x="17818.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17818.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17818.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_6&#45;&gt;combine_experts_1_13 -->
<g id="edge923" class="edge">
<title>allreduce_expert_1_6&#45;&gt;combine_experts_1_13</title>
<path fill="none" stroke="black" d="M17390.83,-6815.72C17475.69,-6792.35 17607.26,-6756.12 17702.07,-6730.01"/>
<polygon fill="black" stroke="black" points="17703.29,-6733.3 17712,-6727.27 17701.43,-6726.56 17703.29,-6733.3"/>
</g>
<!-- expert_1_6_fc2_13 -->
<g id="node747" class="node">
<title>expert_1_6_fc2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17304.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17304.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17304.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17304.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17304.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_6_gelu_13&#45;&gt;expert_1_6_fc2_13 -->
<g id="edge902" class="edge">
<title>expert_1_6_gelu_13&#45;&gt;expert_1_6_fc2_13</title>
<path fill="none" stroke="black" d="M17280.17,-7063.09C17282.68,-7054.44 17285.41,-7045.02 17288.11,-7035.72"/>
<polygon fill="black" stroke="black" points="17291.48,-7036.68 17290.91,-7026.1 17284.76,-7034.73 17291.48,-7036.68"/>
</g>
<!-- expert_1_6_fc2_13&#45;&gt;allreduce_expert_1_6 -->
<g id="edge903" class="edge">
<title>expert_1_6_fc2_13&#45;&gt;allreduce_expert_1_6</title>
<path fill="none" stroke="black" d="M17305.27,-6929.79C17305.4,-6921.09 17305.53,-6911.89 17305.66,-6902.83"/>
<polygon fill="black" stroke="black" points="17309.17,-6902.75 17305.81,-6892.7 17302.17,-6902.65 17309.17,-6902.75"/>
</g>
<!-- expert_1_7_fc2_14 -->
<g id="node749" class="node">
<title>expert_1_7_fc2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17989.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17989.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="17989.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17989.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17989.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_7_gelu_14&#45;&gt;expert_1_7_fc2_14 -->
<g id="edge905" class="edge">
<title>expert_1_7_gelu_14&#45;&gt;expert_1_7_fc2_14</title>
<path fill="none" stroke="black" d="M17772.78,-7070.09C17811.51,-7053.82 17859.96,-7033.46 17901.24,-7016.12"/>
<polygon fill="black" stroke="black" points="17902.61,-7019.34 17910.47,-7012.24 17899.9,-7012.89 17902.61,-7019.34"/>
</g>
<!-- allreduce_expert_1_7 -->
<g id="node750" class="node">
<title>allreduce_expert_1_7</title>
<polygon fill="red" stroke="black" points="18321.57,-6892.93 18166.57,-6839.93 18321.57,-6786.93 18476.57,-6839.93 18321.57,-6892.93"/>
<text text-anchor="middle" x="18321.57" y="-6851.23" font-family="Times,serif" font-size="14.00">AllReduce Expert 7</text>
<text text-anchor="middle" x="18321.57" y="-6836.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="18321.57" y="-6821.23" font-family="Times,serif" font-size="14.00">GPUs 14&#45;15</text>
</g>
<!-- expert_1_7_fc2_14&#45;&gt;allreduce_expert_1_7 -->
<g id="edge906" class="edge">
<title>expert_1_7_fc2_14&#45;&gt;allreduce_expert_1_7</title>
<path fill="none" stroke="black" d="M18069.94,-6944.07C18122.42,-6922.55 18190.63,-6894.6 18242.79,-6873.22"/>
<polygon fill="black" stroke="black" points="18244.41,-6876.34 18252.34,-6869.3 18241.76,-6869.86 18244.41,-6876.34"/>
</g>
<!-- combine_experts_1_14 -->
<g id="node767" class="node">
<title>combine_experts_1_14</title>
<polygon fill="purple" stroke="black" points="18330.57,-6749.93 18083.57,-6696.93 18330.57,-6643.93 18577.57,-6696.93 18330.57,-6749.93"/>
<text text-anchor="middle" x="18330.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18330.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18330.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_7&#45;&gt;combine_experts_1_14 -->
<g id="edge924" class="edge">
<title>allreduce_expert_1_7&#45;&gt;combine_experts_1_14</title>
<path fill="none" stroke="black" d="M18324.82,-6788.02C18325.41,-6778.75 18326.04,-6768.99 18326.65,-6759.46"/>
<polygon fill="black" stroke="black" points="18330.15,-6759.43 18327.3,-6749.23 18323.17,-6758.98 18330.15,-6759.43"/>
</g>
<!-- combine_experts_1_15 -->
<g id="node768" class="node">
<title>combine_experts_1_15</title>
<polygon fill="purple" stroke="black" points="18842.57,-6749.93 18595.57,-6696.93 18842.57,-6643.93 19089.57,-6696.93 18842.57,-6749.93"/>
<text text-anchor="middle" x="18842.57" y="-6708.23" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18842.57" y="-6693.23" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18842.57" y="-6678.23" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_1_7&#45;&gt;combine_experts_1_15 -->
<g id="edge925" class="edge">
<title>allreduce_expert_1_7&#45;&gt;combine_experts_1_15</title>
<path fill="none" stroke="black" d="M18406.73,-6815.88C18493.48,-6792.4 18628.65,-6755.82 18725.45,-6729.62"/>
<polygon fill="black" stroke="black" points="18726.55,-6732.95 18735.29,-6726.96 18724.72,-6726.19 18726.55,-6732.95"/>
</g>
<!-- expert_1_7_fc2_15 -->
<g id="node752" class="node">
<title>expert_1_7_fc2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18301.57" cy="-6978.01" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18301.57" y="-6996.81" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18301.57" y="-6981.81" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18301.57" y="-6966.81" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18301.57" y="-6951.81" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_1_7_gelu_15&#45;&gt;expert_1_7_fc2_15 -->
<g id="edge908" class="edge">
<title>expert_1_7_gelu_15&#45;&gt;expert_1_7_fc2_15</title>
<path fill="none" stroke="black" d="M18185.13,-7065.68C18201.61,-7053.42 18220.52,-7039.34 18238.24,-7026.15"/>
<polygon fill="black" stroke="black" points="18240.36,-7028.94 18246.29,-7020.16 18236.18,-7023.32 18240.36,-7028.94"/>
</g>
<!-- expert_1_7_fc2_15&#45;&gt;allreduce_expert_1_7 -->
<g id="edge909" class="edge">
<title>expert_1_7_fc2_15&#45;&gt;allreduce_expert_1_7</title>
<path fill="none" stroke="black" d="M18308.51,-6929.79C18309.89,-6920.45 18311.34,-6910.53 18312.77,-6900.83"/>
<polygon fill="black" stroke="black" points="18316.25,-6901.24 18314.24,-6890.83 18309.32,-6900.22 18316.25,-6901.24"/>
</g>
<!-- allreduce_moe_1 -->
<g id="node769" class="node">
<title>allreduce_moe_1</title>
<polygon fill="red" stroke="black" points="14944.57,-6606.93 14819.57,-6553.93 14944.57,-6500.93 15069.57,-6553.93 14944.57,-6606.93"/>
<text text-anchor="middle" x="14944.57" y="-6565.23" font-family="Times,serif" font-size="14.00">AllReduce MoE</text>
<text text-anchor="middle" x="14944.57" y="-6550.23" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14944.57" y="-6535.23" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- combine_experts_1_0&#45;&gt;allreduce_moe_1 -->
<g id="edge926" class="edge">
<title>combine_experts_1_0&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M11276.59,-6668.35C11320.67,-6658.85 11371.71,-6649.27 11418.57,-6643.93 11732.65,-6608.11 11813.57,-6633.08 12129.57,-6624.93 13167.98,-6598.14 14421.9,-6567.59 14818.21,-6557.98"/>
<polygon fill="black" stroke="black" points="14818.35,-6561.48 14828.26,-6557.74 14818.18,-6554.48 14818.35,-6561.48"/>
</g>
<!-- combine_experts_1_1&#45;&gt;allreduce_moe_1 -->
<g id="edge927" class="edge">
<title>combine_experts_1_1&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M11788.92,-6668.35C11832.93,-6658.89 11883.83,-6649.32 11930.57,-6643.93 12501.45,-6578.01 14309.98,-6559.69 14813.39,-6555.82"/>
<polygon fill="black" stroke="black" points="14813.63,-6559.31 14823.6,-6555.74 14813.58,-6552.31 14813.63,-6559.31"/>
</g>
<!-- combine_experts_1_2&#45;&gt;allreduce_moe_1 -->
<g id="edge928" class="edge">
<title>combine_experts_1_2&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M12301.25,-6668.43C12345.19,-6659.01 12395.96,-6649.45 12442.57,-6643.93 12908.97,-6588.64 14370.96,-6563.27 14815.24,-6556.71"/>
<polygon fill="black" stroke="black" points="14815.59,-6560.2 14825.54,-6556.56 14815.49,-6553.2 14815.59,-6560.2"/>
</g>
<!-- combine_experts_1_3&#45;&gt;allreduce_moe_1 -->
<g id="edge929" class="edge">
<title>combine_experts_1_3&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M12813.6,-6668.59C12857.47,-6659.21 12908.1,-6649.65 12954.57,-6643.93 13317.67,-6599.2 14439.82,-6567.61 14818.37,-6558"/>
<polygon fill="black" stroke="black" points="14818.63,-6561.49 14828.54,-6557.74 14818.45,-6554.49 14818.63,-6561.49"/>
</g>
<!-- combine_experts_1_4&#45;&gt;allreduce_moe_1 -->
<g id="edge930" class="edge">
<title>combine_experts_1_4&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M13326.6,-6668.77C13370.26,-6659.5 13420.48,-6649.96 13466.57,-6643.93 13962.07,-6579.01 14557.34,-6561.36 14815.11,-6556.63"/>
<polygon fill="black" stroke="black" points="14815.32,-6560.13 14825.26,-6556.45 14815.19,-6553.13 14815.32,-6560.13"/>
</g>
<!-- combine_experts_1_5&#45;&gt;allreduce_moe_1 -->
<g id="edge931" class="edge">
<title>combine_experts_1_5&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M13840.63,-6669.16C13883.85,-6660.1 13933.26,-6650.6 13978.57,-6643.93 14282.33,-6599.22 14643.34,-6573.05 14826.02,-6561.69"/>
<polygon fill="black" stroke="black" points="14826.42,-6565.17 14836.19,-6561.06 14825.99,-6558.19 14826.42,-6565.17"/>
</g>
<!-- combine_experts_1_6&#45;&gt;allreduce_moe_1 -->
<g id="edge932" class="edge">
<title>combine_experts_1_6&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M14358.89,-6670.5C14400.72,-6661.99 14447.66,-6652.49 14490.57,-6643.93 14614.83,-6619.13 14758.34,-6591.1 14850.2,-6573.23"/>
<polygon fill="black" stroke="black" points="14850.88,-6576.66 14860.03,-6571.32 14849.54,-6569.79 14850.88,-6576.66"/>
</g>
<!-- combine_experts_1_7&#45;&gt;allreduce_moe_1 -->
<g id="edge933" class="edge">
<title>combine_experts_1_7&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M14802.78,-6655.9C14830.24,-6636.34 14863.14,-6612.92 14890.33,-6593.56"/>
<polygon fill="black" stroke="black" points="14892.45,-6596.34 14898.57,-6587.69 14888.39,-6590.64 14892.45,-6596.34"/>
</g>
<!-- combine_experts_1_8&#45;&gt;allreduce_moe_1 -->
<g id="edge934" class="edge">
<title>combine_experts_1_8&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M15180.15,-6660.71C15128.95,-6637.72 15062.74,-6607.99 15013.55,-6585.9"/>
<polygon fill="black" stroke="black" points="15014.82,-6582.63 15004.26,-6581.73 15011.95,-6589.02 15014.82,-6582.63"/>
</g>
<!-- combine_experts_1_9&#45;&gt;allreduce_moe_1 -->
<g id="edge935" class="edge">
<title>combine_experts_1_9&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M15648.71,-6669.99C15606.33,-6661.29 15558.43,-6651.8 15514.57,-6643.93 15351.42,-6614.63 15160.98,-6586.02 15046.73,-6569.45"/>
<polygon fill="black" stroke="black" points="15047,-6565.95 15036.6,-6567.98 15046,-6572.88 15047,-6565.95"/>
</g>
<!-- combine_experts_1_10&#45;&gt;allreduce_moe_1 -->
<g id="edge936" class="edge">
<title>combine_experts_1_10&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M16165.19,-6669.05C16121.83,-6659.92 16072.15,-6650.4 16026.57,-6643.93 15680.15,-6594.67 15267.15,-6570.05 15066.32,-6560.24"/>
<polygon fill="black" stroke="black" points="15066.2,-6556.73 15056.04,-6559.74 15065.86,-6563.72 15066.2,-6556.73"/>
</g>
<!-- combine_experts_1_11&#45;&gt;allreduce_moe_1 -->
<g id="edge937" class="edge">
<title>combine_experts_1_11&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M16678.88,-6668.73C16635.15,-6659.43 16584.79,-6649.88 16538.57,-6643.93 15998.64,-6574.39 15348.91,-6559.16 15075.7,-6555.84"/>
<polygon fill="black" stroke="black" points="15075.39,-6552.34 15065.35,-6555.72 15075.3,-6559.34 15075.39,-6552.34"/>
</g>
<!-- combine_experts_1_12&#45;&gt;allreduce_moe_1 -->
<g id="edge938" class="edge">
<title>combine_experts_1_12&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M17191.56,-6668.53C17147.69,-6659.15 17097.06,-6649.59 17050.57,-6643.93 16664.19,-6596.82 15465.73,-6566.54 15071.62,-6557.66"/>
<polygon fill="black" stroke="black" points="15071.69,-6554.16 15061.61,-6557.43 15071.53,-6561.16 15071.69,-6554.16"/>
</g>
<!-- combine_experts_1_13&#45;&gt;allreduce_moe_1 -->
<g id="edge939" class="edge">
<title>combine_experts_1_13&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M17704.22,-6668.46C17660.2,-6659.01 17609.3,-6649.43 17562.57,-6643.93 17072.59,-6586.24 15532.59,-6562.4 15074.41,-6556.48"/>
<polygon fill="black" stroke="black" points="15074.16,-6552.97 15064.12,-6556.35 15074.07,-6559.97 15074.16,-6552.97"/>
</g>
<!-- combine_experts_1_14&#45;&gt;allreduce_moe_1 -->
<g id="edge940" class="edge">
<title>combine_experts_1_14&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M18216.23,-6668.32C18172.22,-6658.86 18121.32,-6649.3 18074.57,-6643.93 17479.89,-6575.59 15592.03,-6558.96 15076.02,-6555.65"/>
<polygon fill="black" stroke="black" points="15075.95,-6552.15 15065.93,-6555.59 15075.9,-6559.15 15075.95,-6552.15"/>
</g>
<!-- combine_experts_1_15&#45;&gt;allreduce_moe_1 -->
<g id="edge941" class="edge">
<title>combine_experts_1_15&#45;&gt;allreduce_moe_1</title>
<path fill="none" stroke="black" d="M18728.56,-6668.35C18684.47,-6658.85 18633.44,-6649.27 18586.57,-6643.93 18272.94,-6608.15 18192.14,-6632.91 17876.57,-6624.93 16790.66,-6597.43 15478.43,-6567.15 15071.23,-6557.82"/>
<polygon fill="black" stroke="black" points="15071.28,-6554.32 15061.2,-6557.59 15071.12,-6561.32 15071.28,-6554.32"/>
</g>
<!-- residual2_1 -->
<g id="node770" class="node">
<title>residual2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="14944.57" cy="-6426.43" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="14944.57" y="-6437.73" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14944.57" y="-6422.73" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14944.57" y="-6407.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_moe_1&#45;&gt;residual2_1 -->
<g id="edge942" class="edge">
<title>allreduce_moe_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M14944.57,-6500.79C14944.57,-6492.08 14944.57,-6483.08 14944.57,-6474.51"/>
<polygon fill="black" stroke="black" points="14948.07,-6474.3 14944.57,-6464.3 14941.07,-6474.3 14948.07,-6474.3"/>
</g>
<!-- ln1_2_0 -->
<g id="node771" class="node">
<title>ln1_2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="11753.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11753.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11753.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11753.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_0 -->
<g id="edge943" class="edge">
<title>residual2_1&#45;&gt;ln1_2_0</title>
<path fill="none" stroke="black" d="M14789.47,-6423.23C14381.51,-6416.98 13244.84,-6396.64 12299.57,-6351.93 12166.14,-6345.61 12014.56,-6335.22 11905.03,-6327.14"/>
<polygon fill="black" stroke="black" points="11905.13,-6323.64 11894.9,-6326.39 11904.61,-6330.62 11905.13,-6323.64"/>
</g>
<!-- ln1_2_1 -->
<g id="node772" class="node">
<title>ln1_2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12457.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12457.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12457.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12457.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_1 -->
<g id="edge944" class="edge">
<title>residual2_1&#45;&gt;ln1_2_1</title>
<path fill="none" stroke="black" d="M14789.34,-6423.74C14436.98,-6419.13 13549.8,-6402.98 12809.57,-6351.93 12740.77,-6347.18 12664.64,-6339.58 12600.82,-6332.54"/>
<polygon fill="black" stroke="black" points="12601.01,-6329.04 12590.69,-6331.41 12600.24,-6336 12601.01,-6329.04"/>
</g>
<!-- ln1_2_2 -->
<g id="node773" class="node">
<title>ln1_2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="12967.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12967.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12967.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12967.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_2 -->
<g id="edge945" class="edge">
<title>residual2_1&#45;&gt;ln1_2_2</title>
<path fill="none" stroke="black" d="M14789.28,-6423.97C14487.02,-6419.99 13798.74,-6405.32 13222.57,-6351.93 13183.02,-6348.26 13140.22,-6342.74 13101.19,-6337.1"/>
<polygon fill="black" stroke="black" points="13101.22,-6333.57 13090.82,-6335.59 13100.21,-6340.5 13101.22,-6333.57"/>
</g>
<!-- ln1_2_3 -->
<g id="node774" class="node">
<title>ln1_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13380.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13380.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13380.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13380.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_3 -->
<g id="edge946" class="edge">
<title>residual2_1&#45;&gt;ln1_2_3</title>
<path fill="none" stroke="black" d="M14789.53,-6423.14C14536.81,-6418.05 14020.65,-6401.94 13586.57,-6351.93 13560.34,-6348.9 13532.39,-6344.65 13505.81,-6340.12"/>
<polygon fill="black" stroke="black" points="13506.15,-6336.62 13495.7,-6338.36 13504.96,-6343.52 13506.15,-6336.62"/>
</g>
<!-- ln1_2_4 -->
<g id="node775" class="node">
<title>ln1_2_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13744.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13744.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13744.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13744.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_4 -->
<g id="edge947" class="edge">
<title>residual2_1&#45;&gt;ln1_2_4</title>
<path fill="none" stroke="black" d="M14790.89,-6420.35C14591.03,-6412.38 14231.43,-6393.33 13926.57,-6351.93 13906.54,-6349.2 13885.4,-6345.62 13864.89,-6341.77"/>
<polygon fill="black" stroke="black" points="13865.36,-6338.3 13854.88,-6339.86 13864.05,-6345.17 13865.36,-6338.3"/>
</g>
<!-- ln1_2_5 -->
<g id="node776" class="node">
<title>ln1_2_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14084.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14084.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14084.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14084.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_5 -->
<g id="edge948" class="edge">
<title>residual2_1&#45;&gt;ln1_2_5</title>
<path fill="none" stroke="black" d="M14797.26,-6414.26C14657.15,-6402.57 14440.74,-6381.74 14254.57,-6351.93 14237.75,-6349.23 14220.09,-6345.95 14202.77,-6342.48"/>
<polygon fill="black" stroke="black" points="14203.12,-6338.98 14192.62,-6340.41 14201.72,-6345.83 14203.12,-6338.98"/>
</g>
<!-- ln1_2_6 -->
<g id="node777" class="node">
<title>ln1_2_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14412.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14412.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14412.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14412.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_6 -->
<g id="edge949" class="edge">
<title>residual2_1&#45;&gt;ln1_2_6</title>
<path fill="none" stroke="black" d="M14825.11,-6402.25C14753.05,-6388.1 14659.44,-6369.42 14576.57,-6351.93 14562.06,-6348.86 14546.84,-6345.57 14531.76,-6342.27"/>
<polygon fill="black" stroke="black" points="14532.41,-6338.83 14521.89,-6340.1 14530.91,-6345.67 14532.41,-6338.83"/>
</g>
<!-- ln1_2_7 -->
<g id="node778" class="node">
<title>ln1_2_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14734.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14734.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14734.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14734.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_7 -->
<g id="edge950" class="edge">
<title>residual2_1&#45;&gt;ln1_2_7</title>
<path fill="none" stroke="black" d="M14881,-6392.12C14857.55,-6379.84 14830.83,-6365.85 14806.69,-6353.2"/>
<polygon fill="black" stroke="black" points="14808.05,-6349.96 14797.57,-6348.42 14804.81,-6356.17 14808.05,-6349.96"/>
</g>
<!-- ln1_2_8 -->
<g id="node779" class="node">
<title>ln1_2_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15156.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15156.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15156.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15156.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_8 -->
<g id="edge951" class="edge">
<title>residual2_1&#45;&gt;ln1_2_8</title>
<path fill="none" stroke="black" d="M15008.76,-6392.12C15032.53,-6379.79 15059.64,-6365.72 15084.09,-6353.03"/>
<polygon fill="black" stroke="black" points="15085.71,-6356.14 15092.97,-6348.42 15082.49,-6349.92 15085.71,-6356.14"/>
</g>
<!-- ln1_2_9 -->
<g id="node780" class="node">
<title>ln1_2_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15525.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15525.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15525.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15525.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_9 -->
<g id="edge952" class="edge">
<title>residual2_1&#45;&gt;ln1_2_9</title>
<path fill="none" stroke="black" d="M15064.96,-6402.63C15162.32,-6384.2 15299.06,-6358.31 15398.24,-6339.53"/>
<polygon fill="black" stroke="black" points="15399.15,-6342.92 15408.32,-6337.62 15397.85,-6336.05 15399.15,-6342.92"/>
</g>
<!-- ln1_2_10 -->
<g id="node781" class="node">
<title>ln1_2_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15868.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15868.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15868.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15868.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_10 -->
<g id="edge953" class="edge">
<title>residual2_1&#45;&gt;ln1_2_10</title>
<path fill="none" stroke="black" d="M15092.66,-6414.89C15242.22,-6403.26 15479.67,-6382.11 15683.57,-6351.93 15703.98,-6348.9 15725.55,-6345.16 15746.48,-6341.23"/>
<polygon fill="black" stroke="black" points="15747.19,-6344.65 15756.36,-6339.35 15745.89,-6337.78 15747.19,-6344.65"/>
</g>
<!-- ln1_2_11 -->
<g id="node782" class="node">
<title>ln1_2_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16743.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16743.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16743.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16743.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_11 -->
<g id="edge954" class="edge">
<title>residual2_1&#45;&gt;ln1_2_11</title>
<path fill="none" stroke="black" d="M15094.48,-6416.26C15431.86,-6395.63 16247.99,-6345.73 16589.39,-6324.85"/>
<polygon fill="black" stroke="black" points="16589.83,-6328.33 16599.59,-6324.23 16589.4,-6321.35 16589.83,-6328.33"/>
</g>
<!-- ln1_2_12 -->
<g id="node783" class="node">
<title>ln1_2_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17616.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17616.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17616.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17616.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_12 -->
<g id="edge955" class="edge">
<title>residual2_1&#45;&gt;ln1_2_12</title>
<path fill="none" stroke="black" d="M15098.1,-6420.36C15428.17,-6409.32 16229.89,-6381.68 16901.57,-6351.93 17094.53,-6343.38 17316.69,-6331.76 17461.49,-6323.95"/>
<polygon fill="black" stroke="black" points="17461.99,-6327.42 17471.78,-6323.39 17461.61,-6320.43 17461.99,-6327.42"/>
</g>
<!-- ln1_2_13 -->
<g id="node784" class="node">
<title>ln1_2_13</title>
<ellipse fill="lightgreen" stroke="black" cx="18211.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18211.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18211.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18211.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_13 -->
<g id="edge956" class="edge">
<title>residual2_1&#45;&gt;ln1_2_13</title>
<path fill="none" stroke="black" d="M15100,-6424.52C15527.24,-6421.35 16755.34,-6407.68 17774.57,-6351.93 17871,-6346.65 17979.15,-6337.64 18063.74,-6329.89"/>
<polygon fill="black" stroke="black" points="18064.3,-6333.36 18073.94,-6328.96 18063.66,-6326.39 18064.3,-6333.36"/>
</g>
<!-- ln1_2_14 -->
<g id="node785" class="node">
<title>ln1_2_14</title>
<ellipse fill="lightgreen" stroke="black" cx="19303.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="19303.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19303.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19303.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_14 -->
<g id="edge957" class="edge">
<title>residual2_1&#45;&gt;ln1_2_14</title>
<path fill="none" stroke="black" d="M15099.49,-6423.07C15583.02,-6415.52 17107.41,-6390.13 18369.57,-6351.93 18643.12,-6343.65 18961.6,-6330.43 19147.09,-6322.38"/>
<polygon fill="black" stroke="black" points="19147.36,-6325.87 19157.2,-6321.94 19147.05,-6318.88 19147.36,-6325.87"/>
</g>
<!-- ln1_2_15 -->
<g id="node786" class="node">
<title>ln1_2_15</title>
<ellipse fill="lightgreen" stroke="black" cx="20200.57" cy="-6314.43" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="20200.57" y="-6325.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20200.57" y="-6310.73" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20200.57" y="-6295.73" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2_15 -->
<g id="edge958" class="edge">
<title>residual2_1&#45;&gt;ln1_2_15</title>
<path fill="none" stroke="black" d="M15100.15,-6424.76C15677.52,-6421.88 17752.22,-6408.03 19461.57,-6351.93 19663.63,-6345.29 19896.56,-6333.02 20046.03,-6324.55"/>
<polygon fill="black" stroke="black" points="20046.41,-6328.03 20056.19,-6323.97 20046.01,-6321.04 20046.41,-6328.03"/>
</g>
<!-- qkv_proj_2_0 -->
<g id="node787" class="node">
<title>qkv_proj_2_0</title>
<ellipse fill="orange" stroke="black" cx="9834.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="9834.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9834.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9834.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="9834.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="9834.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_0&#45;&gt;qkv_proj_2_0 -->
<g id="edge959" class="edge">
<title>ln1_2_0&#45;&gt;qkv_proj_2_0</title>
<path fill="none" stroke="black" d="M11610.51,-6303.64C11257.48,-6279.51 10347.33,-6217.29 9985.84,-6192.58"/>
<polygon fill="black" stroke="black" points="9986.04,-6189.08 9975.83,-6191.89 9985.56,-6196.07 9986.04,-6189.08"/>
</g>
<!-- qkv_proj_2_1 -->
<g id="node788" class="node">
<title>qkv_proj_2_1</title>
<ellipse fill="orange" stroke="black" cx="10839.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10839.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10839.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10839.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="10839.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10839.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_1&#45;&gt;qkv_proj_2_1 -->
<g id="edge960" class="edge">
<title>ln1_2_1&#45;&gt;qkv_proj_2_1</title>
<path fill="none" stroke="black" d="M12316.82,-6302.01C12013.72,-6277.44 11301.6,-6219.7 10990.01,-6194.43"/>
<polygon fill="black" stroke="black" points="10990.25,-6190.94 10980,-6193.62 10989.69,-6197.92 10990.25,-6190.94"/>
</g>
<!-- qkv_proj_2_2 -->
<g id="node789" class="node">
<title>qkv_proj_2_2</title>
<ellipse fill="orange" stroke="black" cx="11824.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11824.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11824.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11824.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="11824.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11824.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_2&#45;&gt;qkv_proj_2_2 -->
<g id="edge961" class="edge">
<title>ln1_2_2&#45;&gt;qkv_proj_2_2</title>
<path fill="none" stroke="black" d="M12833.38,-6298.02C12617.87,-6273.29 12196.18,-6224.89 11972.35,-6199.2"/>
<polygon fill="black" stroke="black" points="11972.51,-6195.69 11962.17,-6198.03 11971.71,-6202.65 11972.51,-6195.69"/>
</g>
<!-- qkv_proj_2_3 -->
<g id="node790" class="node">
<title>qkv_proj_2_3</title>
<ellipse fill="orange" stroke="black" cx="12636.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12636.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12636.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12636.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="12636.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12636.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_3&#45;&gt;qkv_proj_2_3 -->
<g id="edge962" class="edge">
<title>ln1_2_3&#45;&gt;qkv_proj_2_3</title>
<path fill="none" stroke="black" d="M13260.21,-6292.2C13128.38,-6268.96 12917.16,-6231.71 12777.65,-6207.11"/>
<polygon fill="black" stroke="black" points="12778.18,-6203.65 12767.73,-6205.36 12776.97,-6210.55 12778.18,-6203.65"/>
</g>
<!-- qkv_proj_2_4 -->
<g id="node791" class="node">
<title>qkv_proj_2_4</title>
<ellipse fill="orange" stroke="black" cx="13534.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13534.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13534.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13534.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="13534.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13534.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_4&#45;&gt;qkv_proj_2_4 -->
<g id="edge963" class="edge">
<title>ln1_2_4&#45;&gt;qkv_proj_2_4</title>
<path fill="none" stroke="black" d="M13690.22,-6279.47C13669.11,-6266.28 13644.42,-6250.86 13621,-6236.22"/>
<polygon fill="black" stroke="black" points="13622.77,-6233.21 13612.43,-6230.88 13619.06,-6239.14 13622.77,-6233.21"/>
</g>
<!-- qkv_proj_2_5 -->
<g id="node792" class="node">
<title>qkv_proj_2_5</title>
<ellipse fill="orange" stroke="black" cx="13928.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13928.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13928.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13928.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="13928.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13928.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_5&#45;&gt;qkv_proj_2_5 -->
<g id="edge964" class="edge">
<title>ln1_2_5&#45;&gt;qkv_proj_2_5</title>
<path fill="none" stroke="black" d="M14042.77,-6278.27C14029.09,-6266.76 14013.5,-6253.65 13998.33,-6240.9"/>
<polygon fill="black" stroke="black" points="14000.36,-6238.03 13990.45,-6234.27 13995.85,-6243.39 14000.36,-6238.03"/>
</g>
<!-- qkv_proj_2_6 -->
<g id="node793" class="node">
<title>qkv_proj_2_6</title>
<ellipse fill="orange" stroke="black" cx="14303.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14303.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14303.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14303.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="14303.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14303.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_6&#45;&gt;qkv_proj_2_6 -->
<g id="edge965" class="edge">
<title>ln1_2_6&#45;&gt;qkv_proj_2_6</title>
<path fill="none" stroke="black" d="M14382.79,-6277.58C14374.39,-6267.47 14365,-6256.16 14355.7,-6244.97"/>
<polygon fill="black" stroke="black" points="14358.37,-6242.71 14349.29,-6237.25 14352.98,-6247.18 14358.37,-6242.71"/>
</g>
<!-- qkv_proj_2_7 -->
<g id="node794" class="node">
<title>qkv_proj_2_7</title>
<ellipse fill="orange" stroke="black" cx="14729.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14729.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14729.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14729.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="14729.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14729.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_7&#45;&gt;qkv_proj_2_7 -->
<g id="edge966" class="edge">
<title>ln1_2_7&#45;&gt;qkv_proj_2_7</title>
<path fill="none" stroke="black" d="M14733.18,-6276.88C14732.87,-6268.62 14732.52,-6259.59 14732.17,-6250.48"/>
<polygon fill="black" stroke="black" points="14735.66,-6250.08 14731.78,-6240.22 14728.67,-6250.34 14735.66,-6250.08"/>
</g>
<!-- qkv_proj_2_8 -->
<g id="node795" class="node">
<title>qkv_proj_2_8</title>
<ellipse fill="orange" stroke="black" cx="15606.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15606.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15606.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15606.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="15606.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15606.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_8&#45;&gt;qkv_proj_2_8 -->
<g id="edge967" class="edge">
<title>ln1_2_8&#45;&gt;qkv_proj_2_8</title>
<path fill="none" stroke="black" d="M15252.01,-6285.6C15318.67,-6266.17 15408.36,-6240.02 15480.85,-6218.89"/>
<polygon fill="black" stroke="black" points="15481.88,-6222.23 15490.5,-6216.07 15479.92,-6215.51 15481.88,-6222.23"/>
</g>
<!-- qkv_proj_2_9 -->
<g id="node796" class="node">
<title>qkv_proj_2_9</title>
<ellipse fill="orange" stroke="black" cx="16151.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16151.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16151.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16151.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="16151.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16151.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_9&#45;&gt;qkv_proj_2_9 -->
<g id="edge968" class="edge">
<title>ln1_2_9&#45;&gt;qkv_proj_2_9</title>
<path fill="none" stroke="black" d="M15638.21,-6289.82C15743.8,-6267.69 15901.86,-6234.57 16014.67,-6210.93"/>
<polygon fill="black" stroke="black" points="16015.69,-6214.29 16024.76,-6208.81 16014.26,-6207.44 16015.69,-6214.29"/>
</g>
<!-- qkv_proj_2_10 -->
<g id="node797" class="node">
<title>qkv_proj_2_10</title>
<ellipse fill="orange" stroke="black" cx="16817.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16817.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16817.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16817.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="16817.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16817.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_10&#45;&gt;qkv_proj_2_10 -->
<g id="edge969" class="edge">
<title>ln1_2_10&#45;&gt;qkv_proj_2_10</title>
<path fill="none" stroke="black" d="M15997.55,-6295.6C16173.46,-6271.28 16487.75,-6227.83 16671.94,-6202.37"/>
<polygon fill="black" stroke="black" points="16672.55,-6205.82 16681.98,-6200.98 16671.59,-6198.88 16672.55,-6205.82"/>
</g>
<!-- qkv_proj_2_11 -->
<g id="node798" class="node">
<title>qkv_proj_2_11</title>
<ellipse fill="orange" stroke="black" cx="17303.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17303.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17303.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17303.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="17303.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17303.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_11&#45;&gt;qkv_proj_2_11 -->
<g id="edge970" class="edge">
<title>ln1_2_11&#45;&gt;qkv_proj_2_11</title>
<path fill="none" stroke="black" d="M16850.88,-6288.29C16941.77,-6266.99 17072.48,-6236.37 17170.1,-6213.5"/>
<polygon fill="black" stroke="black" points="17171.1,-6216.86 17180.04,-6211.18 17169.51,-6210.05 17171.1,-6216.86"/>
</g>
<!-- qkv_proj_2_12 -->
<g id="node799" class="node">
<title>qkv_proj_2_12</title>
<ellipse fill="orange" stroke="black" cx="18320.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18320.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18320.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18320.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="18320.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18320.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_12&#45;&gt;qkv_proj_2_12 -->
<g id="edge971" class="edge">
<title>ln1_2_12&#45;&gt;qkv_proj_2_12</title>
<path fill="none" stroke="black" d="M17734.8,-6291.39C17857.81,-6268.47 18050.32,-6232.6 18180.78,-6208.29"/>
<polygon fill="black" stroke="black" points="18181.66,-6211.68 18190.85,-6206.41 18180.38,-6204.8 18181.66,-6211.68"/>
</g>
<!-- qkv_proj_2_13 -->
<g id="node800" class="node">
<title>qkv_proj_2_13</title>
<ellipse fill="orange" stroke="black" cx="18981.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18981.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18981.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18981.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="18981.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18981.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_13&#45;&gt;qkv_proj_2_13 -->
<g id="edge972" class="edge">
<title>ln1_2_13&#45;&gt;qkv_proj_2_13</title>
<path fill="none" stroke="black" d="M18333.16,-6292.71C18470.7,-6269.28 18694.4,-6231.16 18839.77,-6206.39"/>
<polygon fill="black" stroke="black" points="18840.4,-6209.84 18849.67,-6204.71 18839.22,-6202.94 18840.4,-6209.84"/>
</g>
<!-- qkv_proj_2_14 -->
<g id="node801" class="node">
<title>qkv_proj_2_14</title>
<ellipse fill="orange" stroke="black" cx="20080.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20080.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20080.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20080.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="20080.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20080.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_14&#45;&gt;qkv_proj_2_14 -->
<g id="edge973" class="edge">
<title>ln1_2_14&#45;&gt;qkv_proj_2_14</title>
<path fill="none" stroke="black" d="M19425.83,-6292.78C19564.95,-6269.29 19791.83,-6230.99 19938.64,-6206.2"/>
<polygon fill="black" stroke="black" points="19939.36,-6209.63 19948.63,-6204.51 19938.19,-6202.73 19939.36,-6209.63"/>
</g>
<!-- qkv_proj_2_15 -->
<g id="node802" class="node">
<title>qkv_proj_2_15</title>
<ellipse fill="orange" stroke="black" cx="20782.57" cy="-6181.24" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20782.57" y="-6207.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20782.57" y="-6192.54" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20782.57" y="-6177.54" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="20782.57" y="-6162.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20782.57" y="-6147.54" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_2_15&#45;&gt;qkv_proj_2_15 -->
<g id="edge974" class="edge">
<title>ln1_2_15&#45;&gt;qkv_proj_2_15</title>
<path fill="none" stroke="black" d="M20309.7,-6288.83C20405.52,-6267.23 20545.25,-6235.73 20647.97,-6212.58"/>
<polygon fill="black" stroke="black" points="20648.81,-6215.97 20657.8,-6210.36 20647.27,-6209.15 20648.81,-6215.97"/>
</g>
<!-- reshape_qkv_2_0 -->
<g id="node803" class="node">
<title>reshape_qkv_2_0</title>
<ellipse fill="lightcyan" stroke="black" cx="8320.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8320.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8320.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8320.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_0&#45;&gt;reshape_qkv_2_0 -->
<g id="edge975" class="edge">
<title>qkv_proj_2_0&#45;&gt;reshape_qkv_2_0</title>
<path fill="none" stroke="black" d="M9694.52,-6168.1C9411.44,-6143.57 8773.05,-6088.25 8476.91,-6062.59"/>
<polygon fill="black" stroke="black" points="8476.78,-6059.07 8466.52,-6061.69 8476.18,-6066.04 8476.78,-6059.07"/>
</g>
<!-- reshape_qkv_2_1 -->
<g id="node816" class="node">
<title>reshape_qkv_2_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9206.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9206.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9206.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9206.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_1&#45;&gt;reshape_qkv_2_1 -->
<g id="edge990" class="edge">
<title>qkv_proj_2_1&#45;&gt;reshape_qkv_2_1</title>
<path fill="none" stroke="black" d="M10698.93,-6168.94C10395.67,-6144.57 9682.01,-6087.24 9364.12,-6061.7"/>
<polygon fill="black" stroke="black" points="9364.15,-6058.19 9353.9,-6060.88 9363.59,-6065.17 9364.15,-6058.19"/>
</g>
<!-- reshape_qkv_2_2 -->
<g id="node828" class="node">
<title>reshape_qkv_2_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10133.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10133.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10133.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10133.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_2&#45;&gt;reshape_qkv_2_2 -->
<g id="edge1005" class="edge">
<title>qkv_proj_2_2&#45;&gt;reshape_qkv_2_2</title>
<path fill="none" stroke="black" d="M11683.67,-6169.3C11370.74,-6145.03 10619.65,-6086.76 10291.49,-6061.3"/>
<polygon fill="black" stroke="black" points="10291.66,-6057.8 10281.42,-6060.52 10291.12,-6064.78 10291.66,-6057.8"/>
</g>
<!-- reshape_qkv_2_3 -->
<g id="node840" class="node">
<title>reshape_qkv_2_3</title>
<ellipse fill="lightcyan" stroke="black" cx="11060.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11060.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11060.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11060.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_3&#45;&gt;reshape_qkv_2_3 -->
<g id="edge1020" class="edge">
<title>qkv_proj_2_3&#45;&gt;reshape_qkv_2_3</title>
<path fill="none" stroke="black" d="M12496.79,-6167.7C12363.41,-6155.81 12156.82,-6137.57 11977.57,-6122.55 11711.25,-6100.22 11401.29,-6075.67 11218.53,-6061.35"/>
<polygon fill="black" stroke="black" points="11218.55,-6057.84 11208.3,-6060.55 11218,-6064.82 11218.55,-6057.84"/>
</g>
<!-- reshape_qkv_2_4 -->
<g id="node853" class="node">
<title>reshape_qkv_2_4</title>
<ellipse fill="lightcyan" stroke="black" cx="12028.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12028.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12028.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12028.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_4&#45;&gt;reshape_qkv_2_4 -->
<g id="edge1036" class="edge">
<title>qkv_proj_2_4&#45;&gt;reshape_qkv_2_4</title>
<path fill="none" stroke="black" d="M13394.58,-6168.04C13112.88,-6143.5 12479.39,-6088.32 12184.76,-6062.65"/>
<polygon fill="black" stroke="black" points="12184.69,-6059.13 12174.42,-6061.75 12184.08,-6066.11 12184.69,-6059.13"/>
</g>
<!-- reshape_qkv_2_5 -->
<g id="node866" class="node">
<title>reshape_qkv_2_5</title>
<ellipse fill="lightcyan" stroke="black" cx="12914.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12914.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12914.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12914.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_5&#45;&gt;reshape_qkv_2_5 -->
<g id="edge1051" class="edge">
<title>qkv_proj_2_5&#45;&gt;reshape_qkv_2_5</title>
<path fill="none" stroke="black" d="M13809.73,-6148.29C13771.01,-6138.83 13727.68,-6129.22 13687.57,-6122.55 13478.08,-6087.69 13233.68,-6067.9 13076.68,-6057.83"/>
<polygon fill="black" stroke="black" points="13076.67,-6054.32 13066.47,-6057.18 13076.23,-6061.31 13076.67,-6054.32"/>
</g>
<!-- reshape_qkv_2_6 -->
<g id="node878" class="node">
<title>reshape_qkv_2_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13841.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13841.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13841.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13841.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_6&#45;&gt;reshape_qkv_2_6 -->
<g id="edge1066" class="edge">
<title>qkv_proj_2_6&#45;&gt;reshape_qkv_2_6</title>
<path fill="none" stroke="black" d="M14186.69,-6147.05C14114.18,-6126.46 14021.64,-6100.18 13950.64,-6080.02"/>
<polygon fill="black" stroke="black" points="13951.35,-6076.58 13940.77,-6077.21 13949.43,-6083.31 13951.35,-6076.58"/>
</g>
<!-- reshape_qkv_2_7 -->
<g id="node890" class="node">
<title>reshape_qkv_2_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14718.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14718.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14718.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14718.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_7&#45;&gt;reshape_qkv_2_7 -->
<g id="edge1081" class="edge">
<title>qkv_proj_2_7&#45;&gt;reshape_qkv_2_7</title>
<path fill="none" stroke="black" d="M14724.72,-6122.31C14723.97,-6113.43 14723.21,-6104.36 14722.49,-6095.76"/>
<polygon fill="black" stroke="black" points="14725.96,-6095.22 14721.63,-6085.55 14718.98,-6095.81 14725.96,-6095.22"/>
</g>
<!-- reshape_qkv_2_8 -->
<g id="node903" class="node">
<title>reshape_qkv_2_8</title>
<ellipse fill="lightcyan" stroke="black" cx="15608.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15608.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15608.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15608.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_8&#45;&gt;reshape_qkv_2_8 -->
<g id="edge1097" class="edge">
<title>qkv_proj_2_8&#45;&gt;reshape_qkv_2_8</title>
<path fill="none" stroke="black" d="M15607.46,-6122.31C15607.59,-6113.43 15607.73,-6104.36 15607.86,-6095.76"/>
<polygon fill="black" stroke="black" points="15611.36,-6095.6 15608.02,-6085.55 15604.36,-6095.5 15611.36,-6095.6"/>
</g>
<!-- reshape_qkv_2_9 -->
<g id="node916" class="node">
<title>reshape_qkv_2_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16313.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16313.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16313.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16313.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_9&#45;&gt;reshape_qkv_2_9 -->
<g id="edge1112" class="edge">
<title>qkv_proj_2_9&#45;&gt;reshape_qkv_2_9</title>
<path fill="none" stroke="black" d="M16215.6,-6128.39C16230.97,-6115.94 16247.2,-6102.8 16261.93,-6090.87"/>
<polygon fill="black" stroke="black" points="16264.37,-6093.39 16269.94,-6084.38 16259.97,-6087.95 16264.37,-6093.39"/>
</g>
<!-- reshape_qkv_2_10 -->
<g id="node928" class="node">
<title>reshape_qkv_2_10</title>
<ellipse fill="lightcyan" stroke="black" cx="17240.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17240.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17240.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17240.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_10&#45;&gt;reshape_qkv_2_10 -->
<g id="edge1127" class="edge">
<title>qkv_proj_2_10&#45;&gt;reshape_qkv_2_10</title>
<path fill="none" stroke="black" d="M16930.93,-6145.08C16995.04,-6125.19 17074.62,-6100.52 17137.04,-6081.15"/>
<polygon fill="black" stroke="black" points="17138.39,-6084.4 17146.91,-6078.09 17136.32,-6077.71 17138.39,-6084.4"/>
</g>
<!-- reshape_qkv_2_11 -->
<g id="node940" class="node">
<title>reshape_qkv_2_11</title>
<ellipse fill="lightcyan" stroke="black" cx="18238.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18238.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18238.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18238.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_11&#45;&gt;reshape_qkv_2_11 -->
<g id="edge1142" class="edge">
<title>qkv_proj_2_11&#45;&gt;reshape_qkv_2_11</title>
<path fill="none" stroke="black" d="M17439.03,-6161.23C17613.87,-6136.7 17916.78,-6094.2 18095.33,-6069.14"/>
<polygon fill="black" stroke="black" points="18095.91,-6072.6 18105.32,-6067.74 18094.94,-6065.67 18095.91,-6072.6"/>
</g>
<!-- reshape_qkv_2_12 -->
<g id="node953" class="node">
<title>reshape_qkv_2_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19094.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19094.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19094.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19094.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_12&#45;&gt;reshape_qkv_2_12 -->
<g id="edge1158" class="edge">
<title>qkv_proj_2_12&#45;&gt;reshape_qkv_2_12</title>
<path fill="none" stroke="black" d="M18452.31,-6157.91C18593.28,-6134.01 18815.8,-6096.3 18958.44,-6072.12"/>
<polygon fill="black" stroke="black" points="18959.29,-6075.53 18968.57,-6070.4 18958.12,-6068.62 18959.29,-6075.53"/>
</g>
<!-- reshape_qkv_2_13 -->
<g id="node966" class="node">
<title>reshape_qkv_2_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20092.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20092.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20092.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20092.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_13&#45;&gt;reshape_qkv_2_13 -->
<g id="edge1173" class="edge">
<title>qkv_proj_2_13&#45;&gt;reshape_qkv_2_13</title>
<path fill="none" stroke="black" d="M19118.92,-6164.02C19328.66,-6139.25 19727.16,-6092.19 19943.63,-6066.63"/>
<polygon fill="black" stroke="black" points="19944.28,-6070.08 19953.8,-6065.43 19943.46,-6063.13 19944.28,-6070.08"/>
</g>
<!-- reshape_qkv_2_14 -->
<g id="node978" class="node">
<title>reshape_qkv_2_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20942.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20942.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20942.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20942.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_14&#45;&gt;reshape_qkv_2_14 -->
<g id="edge1188" class="edge">
<title>qkv_proj_2_14&#45;&gt;reshape_qkv_2_14</title>
<path fill="none" stroke="black" d="M20214.32,-6159.88C20373.88,-6135.6 20639.44,-6095.18 20801.98,-6070.44"/>
<polygon fill="black" stroke="black" points="20802.69,-6073.87 20812.05,-6068.91 20801.64,-6066.95 20802.69,-6073.87"/>
</g>
<!-- reshape_qkv_2_15 -->
<g id="node990" class="node">
<title>reshape_qkv_2_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21945.57" cy="-6048.05" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21945.57" y="-6059.35" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21945.57" y="-6044.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21945.57" y="-6029.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_2_15&#45;&gt;reshape_qkv_2_15 -->
<g id="edge1203" class="edge">
<title>qkv_proj_2_15&#45;&gt;reshape_qkv_2_15</title>
<path fill="none" stroke="black" d="M20920.55,-6164.67C21140.36,-6139.88 21568.34,-6091.6 21795.51,-6065.97"/>
<polygon fill="black" stroke="black" points="21795.97,-6069.44 21805.51,-6064.84 21795.18,-6062.49 21795.97,-6069.44"/>
</g>
<!-- split_q_2_0 -->
<g id="node804" class="node">
<title>split_q_2_0</title>
<ellipse fill="pink" stroke="black" cx="7886.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7886.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7886.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7886.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_q_2_0 -->
<g id="edge976" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_q_2_0</title>
<path fill="none" stroke="black" d="M8214.96,-6020.28C8149.31,-6003.64 8065.01,-5982.27 7998.26,-5965.35"/>
<polygon fill="black" stroke="black" points="7999.09,-5961.95 7988.54,-5962.89 7997.37,-5968.74 7999.09,-5961.95"/>
</g>
<!-- split_k_2_0 -->
<g id="node805" class="node">
<title>split_k_2_0</title>
<ellipse fill="pink" stroke="black" cx="8195.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8195.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8195.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8195.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_k_2_0 -->
<g id="edge977" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_k_2_0</title>
<path fill="none" stroke="black" d="M8280.33,-6011.64C8268.63,-6001.33 8255.72,-5989.97 8243.58,-5979.29"/>
<polygon fill="black" stroke="black" points="8245.56,-5976.37 8235.74,-5972.39 8240.93,-5981.62 8245.56,-5976.37"/>
</g>
<!-- split_v_2_0 -->
<g id="node806" class="node">
<title>split_v_2_0</title>
<ellipse fill="pink" stroke="black" cx="8504.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8504.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8504.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8504.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_0&#45;&gt;split_v_2_0 -->
<g id="edge978" class="edge">
<title>reshape_qkv_2_0&#45;&gt;split_v_2_0</title>
<path fill="none" stroke="black" d="M8377.53,-6012.99C8397.12,-6001.29 8419.19,-5988.09 8439.38,-5976.02"/>
<polygon fill="black" stroke="black" points="8441.41,-5978.88 8448.2,-5970.75 8437.82,-5972.87 8441.41,-5978.88"/>
</g>
<!-- transpose_q_2_0 -->
<g id="node807" class="node">
<title>transpose_q_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="7886.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7886.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7886.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7886.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_0&#45;&gt;transpose_q_2_0 -->
<g id="edge979" class="edge">
<title>split_q_2_0&#45;&gt;transpose_q_2_0</title>
<path fill="none" stroke="black" d="M7886.57,-5898.42C7886.57,-5889.97 7886.57,-5880.87 7886.57,-5872.06"/>
<polygon fill="black" stroke="black" points="7890.07,-5871.89 7886.57,-5861.89 7883.07,-5871.89 7890.07,-5871.89"/>
</g>
<!-- transpose_k_2_0 -->
<g id="node808" class="node">
<title>transpose_k_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="8195.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8195.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8195.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8195.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_0&#45;&gt;transpose_k_2_0 -->
<g id="edge980" class="edge">
<title>split_k_2_0&#45;&gt;transpose_k_2_0</title>
<path fill="none" stroke="black" d="M8195.57,-5898.42C8195.57,-5889.97 8195.57,-5880.87 8195.57,-5872.06"/>
<polygon fill="black" stroke="black" points="8199.07,-5871.89 8195.57,-5861.89 8192.07,-5871.89 8199.07,-5871.89"/>
</g>
<!-- transpose_v_2_0 -->
<g id="node809" class="node">
<title>transpose_v_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="8504.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8504.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8504.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8504.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_0&#45;&gt;transpose_v_2_0 -->
<g id="edge981" class="edge">
<title>split_v_2_0&#45;&gt;transpose_v_2_0</title>
<path fill="none" stroke="black" d="M8504.57,-5898.42C8504.57,-5889.97 8504.57,-5880.87 8504.57,-5872.06"/>
<polygon fill="black" stroke="black" points="8508.07,-5871.89 8504.57,-5861.89 8501.07,-5871.89 8508.07,-5871.89"/>
</g>
<!-- attn_scores_2_0 -->
<g id="node810" class="node">
<title>attn_scores_2_0</title>
<ellipse fill="gold" stroke="black" cx="8195.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8195.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8195.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8195.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_0&#45;&gt;attn_scores_2_0 -->
<g id="edge982" class="edge">
<title>transpose_q_2_0&#45;&gt;attn_scores_2_0</title>
<path fill="none" stroke="black" d="M7970.19,-5793.28C8009.91,-5779.14 8057.6,-5762.16 8098.86,-5747.47"/>
<polygon fill="black" stroke="black" points="8100.13,-5750.74 8108.38,-5744.08 8097.79,-5744.14 8100.13,-5750.74"/>
</g>
<!-- transpose_k_2_0&#45;&gt;attn_scores_2_0 -->
<g id="edge983" class="edge">
<title>transpose_k_2_0&#45;&gt;attn_scores_2_0</title>
<path fill="none" stroke="black" d="M8195.57,-5786.42C8195.57,-5777.97 8195.57,-5768.87 8195.57,-5760.06"/>
<polygon fill="black" stroke="black" points="8199.07,-5759.89 8195.57,-5749.89 8192.07,-5759.89 8199.07,-5759.89"/>
</g>
<!-- attn_output_2_0 -->
<g id="node811" class="node">
<title>attn_output_2_0</title>
<ellipse fill="gold" stroke="black" cx="8504.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8504.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8504.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8504.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_0&#45;&gt;attn_output_2_0 -->
<g id="edge984" class="edge">
<title>transpose_v_2_0&#45;&gt;attn_output_2_0</title>
<path fill="none" stroke="black" d="M8504.57,-5786.35C8504.57,-5725.3 8504.57,-5602.99 8504.57,-5535.84"/>
<polygon fill="black" stroke="black" points="8508.07,-5535.55 8504.57,-5525.55 8501.07,-5535.55 8508.07,-5535.55"/>
</g>
<!-- softmax_2_0 -->
<g id="node812" class="node">
<title>softmax_2_0</title>
<ellipse fill="gold" stroke="black" cx="8252.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8252.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8252.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8252.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_0&#45;&gt;softmax_2_0 -->
<g id="edge985" class="edge">
<title>attn_scores_2_0&#45;&gt;softmax_2_0</title>
<path fill="none" stroke="black" d="M8214.4,-5674.72C8219.11,-5665.62 8224.23,-5655.74 8229.15,-5646.26"/>
<polygon fill="black" stroke="black" points="8232.28,-5647.82 8233.77,-5637.33 8226.06,-5644.6 8232.28,-5647.82"/>
</g>
<!-- transpose_back_2_0 -->
<g id="node813" class="node">
<title>transpose_back_2_0</title>
<ellipse fill="lightgray" stroke="black" cx="9023.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9023.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9023.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9023.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_0&#45;&gt;transpose_back_2_0 -->
<g id="edge987" class="edge">
<title>attn_output_2_0&#45;&gt;transpose_back_2_0</title>
<path fill="none" stroke="black" d="M8615.28,-5463.58C8699.84,-5445.66 8816.24,-5420.99 8903.13,-5402.57"/>
<polygon fill="black" stroke="black" points="8903.98,-5405.97 8913.04,-5400.47 8902.53,-5399.12 8903.98,-5405.97"/>
</g>
<!-- softmax_2_0&#45;&gt;attn_output_2_0 -->
<g id="edge986" class="edge">
<title>softmax_2_0&#45;&gt;attn_output_2_0</title>
<path fill="none" stroke="black" d="M8327.16,-5566.49C8357.15,-5553.4 8391.83,-5538.26 8422.52,-5524.86"/>
<polygon fill="black" stroke="black" points="8424.15,-5527.97 8431.91,-5520.76 8421.35,-5521.55 8424.15,-5527.97"/>
</g>
<!-- reshape_concat_2_0 -->
<g id="node814" class="node">
<title>reshape_concat_2_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9417.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9417.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9417.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9417.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_0&#45;&gt;reshape_concat_2_0 -->
<g id="edge988" class="edge">
<title>transpose_back_2_0&#45;&gt;reshape_concat_2_0</title>
<path fill="none" stroke="black" d="M9120.46,-5348C9179.49,-5331.51 9254.86,-5310.47 9314.91,-5293.71"/>
<polygon fill="black" stroke="black" points="9316.1,-5297.01 9324.79,-5290.95 9314.22,-5290.27 9316.1,-5297.01"/>
</g>
<!-- allgather_dim_2_0 -->
<g id="node815" class="node">
<title>allgather_dim_2_0</title>
<polygon fill="red" stroke="black" points="10086.57,-5189.55 9913.57,-5136.55 10086.57,-5083.55 10259.57,-5136.55 10086.57,-5189.55"/>
<text text-anchor="middle" x="10086.57" y="-5147.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="10086.57" y="-5132.85" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10086.57" y="-5117.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_0&#45;&gt;allgather_dim_2_0 -->
<g id="edge989" class="edge">
<title>reshape_concat_2_0&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M9518.32,-5239.4C9538.25,-5234.95 9559.04,-5230.47 9578.57,-5226.55 9710.15,-5200.12 9861.79,-5174.13 9964.9,-5157.12"/>
<polygon fill="black" stroke="black" points="9965.74,-5160.53 9975.04,-5155.46 9964.6,-5153.63 9965.74,-5160.53"/>
</g>
<!-- head_group_2_0 -->
<g id="node852" class="node">
<title>head_group_2_0</title>
<polygon fill="lightyellow" stroke="black" points="10857.07,-5046.55 10660.07,-5046.55 10660.07,-5008.55 10857.07,-5008.55 10857.07,-5046.55"/>
<text text-anchor="middle" x="10758.57" y="-5031.35" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10758.57" y="-5016.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_0&#45;&gt;head_group_2_0 -->
<g id="edge1035" class="edge">
<title>allgather_dim_2_0&#45;&gt;head_group_2_0</title>
<path fill="none" stroke="black" d="M10198.29,-5117.76C10323.75,-5097.78 10525.98,-5065.58 10650.09,-5045.82"/>
<polygon fill="black" stroke="black" points="10650.67,-5049.27 10660,-5044.24 10649.57,-5042.36 10650.67,-5049.27"/>
</g>
<!-- split_q_2_1 -->
<g id="node817" class="node">
<title>split_q_2_1</title>
<ellipse fill="pink" stroke="black" cx="8813.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8813.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8813.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8813.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_q_2_1 -->
<g id="edge991" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_q_2_1</title>
<path fill="none" stroke="black" d="M9106.64,-6019.07C9049.67,-6003.13 8978.29,-5983.15 8920.24,-5966.9"/>
<polygon fill="black" stroke="black" points="8920.88,-5963.45 8910.31,-5964.12 8918.99,-5970.19 8920.88,-5963.45"/>
</g>
<!-- split_k_2_1 -->
<g id="node818" class="node">
<title>split_k_2_1</title>
<ellipse fill="pink" stroke="black" cx="9122.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9122.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9122.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9122.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_k_2_1 -->
<g id="edge992" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_k_2_1</title>
<path fill="none" stroke="black" d="M9179.07,-6011.03C9171.82,-6001.53 9163.91,-5991.17 9156.37,-5981.3"/>
<polygon fill="black" stroke="black" points="9158.99,-5978.97 9150.14,-5973.14 9153.43,-5983.22 9158.99,-5978.97"/>
</g>
<!-- split_v_2_1 -->
<g id="node819" class="node">
<title>split_v_2_1</title>
<ellipse fill="pink" stroke="black" cx="9431.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9431.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9431.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9431.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_1&#45;&gt;split_v_2_1 -->
<g id="edge993" class="edge">
<title>reshape_qkv_2_1&#45;&gt;split_v_2_1</title>
<path fill="none" stroke="black" d="M9274.08,-6014.04C9299.9,-6001.42 9329.51,-5986.94 9356.03,-5973.98"/>
<polygon fill="black" stroke="black" points="9357.83,-5976.99 9365.28,-5969.46 9354.75,-5970.71 9357.83,-5976.99"/>
</g>
<!-- transpose_q_2_1 -->
<g id="node820" class="node">
<title>transpose_q_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="8813.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8813.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8813.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8813.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_1&#45;&gt;transpose_q_2_1 -->
<g id="edge994" class="edge">
<title>split_q_2_1&#45;&gt;transpose_q_2_1</title>
<path fill="none" stroke="black" d="M8813.57,-5898.42C8813.57,-5889.97 8813.57,-5880.87 8813.57,-5872.06"/>
<polygon fill="black" stroke="black" points="8817.07,-5871.89 8813.57,-5861.89 8810.07,-5871.89 8817.07,-5871.89"/>
</g>
<!-- transpose_k_2_1 -->
<g id="node821" class="node">
<title>transpose_k_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="9122.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9122.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9122.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9122.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_1&#45;&gt;transpose_k_2_1 -->
<g id="edge995" class="edge">
<title>split_k_2_1&#45;&gt;transpose_k_2_1</title>
<path fill="none" stroke="black" d="M9122.57,-5898.42C9122.57,-5889.97 9122.57,-5880.87 9122.57,-5872.06"/>
<polygon fill="black" stroke="black" points="9126.07,-5871.89 9122.57,-5861.89 9119.07,-5871.89 9126.07,-5871.89"/>
</g>
<!-- transpose_v_2_1 -->
<g id="node822" class="node">
<title>transpose_v_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="9431.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9431.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9431.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9431.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_1&#45;&gt;transpose_v_2_1 -->
<g id="edge996" class="edge">
<title>split_v_2_1&#45;&gt;transpose_v_2_1</title>
<path fill="none" stroke="black" d="M9431.57,-5898.42C9431.57,-5889.97 9431.57,-5880.87 9431.57,-5872.06"/>
<polygon fill="black" stroke="black" points="9435.07,-5871.89 9431.57,-5861.89 9428.07,-5871.89 9435.07,-5871.89"/>
</g>
<!-- attn_scores_2_1 -->
<g id="node823" class="node">
<title>attn_scores_2_1</title>
<ellipse fill="gold" stroke="black" cx="9122.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9122.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9122.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9122.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_1&#45;&gt;attn_scores_2_1 -->
<g id="edge997" class="edge">
<title>transpose_q_2_1&#45;&gt;attn_scores_2_1</title>
<path fill="none" stroke="black" d="M8897.19,-5793.28C8936.91,-5779.14 8984.6,-5762.16 9025.86,-5747.47"/>
<polygon fill="black" stroke="black" points="9027.13,-5750.74 9035.38,-5744.08 9024.79,-5744.14 9027.13,-5750.74"/>
</g>
<!-- transpose_k_2_1&#45;&gt;attn_scores_2_1 -->
<g id="edge998" class="edge">
<title>transpose_k_2_1&#45;&gt;attn_scores_2_1</title>
<path fill="none" stroke="black" d="M9122.57,-5786.42C9122.57,-5777.97 9122.57,-5768.87 9122.57,-5760.06"/>
<polygon fill="black" stroke="black" points="9126.07,-5759.89 9122.57,-5749.89 9119.07,-5759.89 9126.07,-5759.89"/>
</g>
<!-- attn_output_2_1 -->
<g id="node824" class="node">
<title>attn_output_2_1</title>
<ellipse fill="gold" stroke="black" cx="9431.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9431.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9431.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9431.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_1&#45;&gt;attn_output_2_1 -->
<g id="edge999" class="edge">
<title>transpose_v_2_1&#45;&gt;attn_output_2_1</title>
<path fill="none" stroke="black" d="M9431.57,-5786.35C9431.57,-5725.3 9431.57,-5602.99 9431.57,-5535.84"/>
<polygon fill="black" stroke="black" points="9435.07,-5535.55 9431.57,-5525.55 9428.07,-5535.55 9435.07,-5535.55"/>
</g>
<!-- softmax_2_1 -->
<g id="node825" class="node">
<title>softmax_2_1</title>
<ellipse fill="gold" stroke="black" cx="9207.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9207.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9207.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9207.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_1&#45;&gt;softmax_2_1 -->
<g id="edge1000" class="edge">
<title>attn_scores_2_1&#45;&gt;softmax_2_1</title>
<path fill="none" stroke="black" d="M9150.41,-5675.03C9157.74,-5665.53 9165.75,-5655.17 9173.38,-5645.3"/>
<polygon fill="black" stroke="black" points="9176.33,-5647.2 9179.68,-5637.14 9170.79,-5642.92 9176.33,-5647.2"/>
</g>
<!-- transpose_back_2_1 -->
<g id="node826" class="node">
<title>transpose_back_2_1</title>
<ellipse fill="lightgray" stroke="black" cx="9509.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9509.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9509.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9509.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_1&#45;&gt;transpose_back_2_1 -->
<g id="edge1002" class="edge">
<title>attn_output_2_1&#45;&gt;transpose_back_2_1</title>
<path fill="none" stroke="black" d="M9457.11,-5451.03C9463.78,-5441.63 9471.04,-5431.38 9477.98,-5421.59"/>
<polygon fill="black" stroke="black" points="9481.05,-5423.33 9483.98,-5413.14 9475.34,-5419.28 9481.05,-5423.33"/>
</g>
<!-- softmax_2_1&#45;&gt;attn_output_2_1 -->
<g id="edge1001" class="edge">
<title>softmax_2_1&#45;&gt;attn_output_2_1</title>
<path fill="none" stroke="black" d="M9275.39,-5565.74C9300.96,-5553.19 9330.19,-5538.83 9356.4,-5525.96"/>
<polygon fill="black" stroke="black" points="9358.09,-5529.03 9365.53,-5521.48 9355.01,-5522.74 9358.09,-5529.03"/>
</g>
<!-- reshape_concat_2_1 -->
<g id="node827" class="node">
<title>reshape_concat_2_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9720.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9720.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9720.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9720.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_1&#45;&gt;reshape_concat_2_1 -->
<g id="edge1003" class="edge">
<title>transpose_back_2_1&#45;&gt;reshape_concat_2_1</title>
<path fill="none" stroke="black" d="M9572.59,-5342.19C9596.82,-5329.56 9624.63,-5315.06 9649.56,-5302.07"/>
<polygon fill="black" stroke="black" points="9651.35,-5305.08 9658.6,-5297.35 9648.12,-5298.87 9651.35,-5305.08"/>
</g>
<!-- reshape_concat_2_1&#45;&gt;allgather_dim_2_0 -->
<g id="edge1004" class="edge">
<title>reshape_concat_2_1&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M9803.62,-5234.57C9861.16,-5214.84 9937.72,-5188.59 9996.69,-5168.37"/>
<polygon fill="black" stroke="black" points="9998.04,-5171.6 10006.37,-5165.05 9995.77,-5164.98 9998.04,-5171.6"/>
</g>
<!-- split_q_2_2 -->
<g id="node829" class="node">
<title>split_q_2_2</title>
<ellipse fill="pink" stroke="black" cx="9740.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9740.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9740.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9740.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_q_2_2 -->
<g id="edge1006" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_q_2_2</title>
<path fill="none" stroke="black" d="M10033.64,-6019.07C9976.67,-6003.13 9905.29,-5983.15 9847.24,-5966.9"/>
<polygon fill="black" stroke="black" points="9847.88,-5963.45 9837.31,-5964.12 9845.99,-5970.19 9847.88,-5963.45"/>
</g>
<!-- split_k_2_2 -->
<g id="node830" class="node">
<title>split_k_2_2</title>
<ellipse fill="pink" stroke="black" cx="10049.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10049.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10049.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10049.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_k_2_2 -->
<g id="edge1007" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_k_2_2</title>
<path fill="none" stroke="black" d="M10106.07,-6011.03C10098.82,-6001.53 10090.91,-5991.17 10083.37,-5981.3"/>
<polygon fill="black" stroke="black" points="10085.99,-5978.97 10077.14,-5973.14 10080.43,-5983.22 10085.99,-5978.97"/>
</g>
<!-- split_v_2_2 -->
<g id="node831" class="node">
<title>split_v_2_2</title>
<ellipse fill="pink" stroke="black" cx="10358.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10358.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10358.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10358.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_2&#45;&gt;split_v_2_2 -->
<g id="edge1008" class="edge">
<title>reshape_qkv_2_2&#45;&gt;split_v_2_2</title>
<path fill="none" stroke="black" d="M10201.08,-6014.04C10226.9,-6001.42 10256.51,-5986.94 10283.03,-5973.98"/>
<polygon fill="black" stroke="black" points="10284.83,-5976.99 10292.28,-5969.46 10281.75,-5970.71 10284.83,-5976.99"/>
</g>
<!-- transpose_q_2_2 -->
<g id="node832" class="node">
<title>transpose_q_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="9740.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9740.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9740.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9740.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_2&#45;&gt;transpose_q_2_2 -->
<g id="edge1009" class="edge">
<title>split_q_2_2&#45;&gt;transpose_q_2_2</title>
<path fill="none" stroke="black" d="M9740.57,-5898.42C9740.57,-5889.97 9740.57,-5880.87 9740.57,-5872.06"/>
<polygon fill="black" stroke="black" points="9744.07,-5871.89 9740.57,-5861.89 9737.07,-5871.89 9744.07,-5871.89"/>
</g>
<!-- transpose_k_2_2 -->
<g id="node833" class="node">
<title>transpose_k_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="10049.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10049.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10049.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10049.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_2&#45;&gt;transpose_k_2_2 -->
<g id="edge1010" class="edge">
<title>split_k_2_2&#45;&gt;transpose_k_2_2</title>
<path fill="none" stroke="black" d="M10049.57,-5898.42C10049.57,-5889.97 10049.57,-5880.87 10049.57,-5872.06"/>
<polygon fill="black" stroke="black" points="10053.07,-5871.89 10049.57,-5861.89 10046.07,-5871.89 10053.07,-5871.89"/>
</g>
<!-- transpose_v_2_2 -->
<g id="node834" class="node">
<title>transpose_v_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="10358.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10358.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10358.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10358.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_2&#45;&gt;transpose_v_2_2 -->
<g id="edge1011" class="edge">
<title>split_v_2_2&#45;&gt;transpose_v_2_2</title>
<path fill="none" stroke="black" d="M10358.57,-5898.42C10358.57,-5889.97 10358.57,-5880.87 10358.57,-5872.06"/>
<polygon fill="black" stroke="black" points="10362.07,-5871.89 10358.57,-5861.89 10355.07,-5871.89 10362.07,-5871.89"/>
</g>
<!-- attn_scores_2_2 -->
<g id="node835" class="node">
<title>attn_scores_2_2</title>
<ellipse fill="gold" stroke="black" cx="10049.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10049.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10049.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10049.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_2&#45;&gt;attn_scores_2_2 -->
<g id="edge1012" class="edge">
<title>transpose_q_2_2&#45;&gt;attn_scores_2_2</title>
<path fill="none" stroke="black" d="M9824.19,-5793.28C9863.91,-5779.14 9911.6,-5762.16 9952.86,-5747.47"/>
<polygon fill="black" stroke="black" points="9954.13,-5750.74 9962.38,-5744.08 9951.79,-5744.14 9954.13,-5750.74"/>
</g>
<!-- transpose_k_2_2&#45;&gt;attn_scores_2_2 -->
<g id="edge1013" class="edge">
<title>transpose_k_2_2&#45;&gt;attn_scores_2_2</title>
<path fill="none" stroke="black" d="M10049.57,-5786.42C10049.57,-5777.97 10049.57,-5768.87 10049.57,-5760.06"/>
<polygon fill="black" stroke="black" points="10053.07,-5759.89 10049.57,-5749.89 10046.07,-5759.89 10053.07,-5759.89"/>
</g>
<!-- attn_output_2_2 -->
<g id="node836" class="node">
<title>attn_output_2_2</title>
<ellipse fill="gold" stroke="black" cx="10086.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10086.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10086.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10086.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_2&#45;&gt;attn_output_2_2 -->
<g id="edge1014" class="edge">
<title>transpose_v_2_2&#45;&gt;attn_output_2_2</title>
<path fill="none" stroke="black" d="M10352.46,-5786.33C10341.49,-5731.12 10313.57,-5626.38 10251.57,-5562.55 10234.58,-5545.05 10212.68,-5531.4 10190.43,-5520.87"/>
<polygon fill="black" stroke="black" points="10191.77,-5517.64 10181.22,-5516.7 10188.88,-5524.01 10191.77,-5517.64"/>
</g>
<!-- softmax_2_2 -->
<g id="node837" class="node">
<title>softmax_2_2</title>
<ellipse fill="gold" stroke="black" cx="10075.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10075.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10075.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10075.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_2&#45;&gt;softmax_2_2 -->
<g id="edge1015" class="edge">
<title>attn_scores_2_2&#45;&gt;softmax_2_2</title>
<path fill="none" stroke="black" d="M10058.23,-5674.42C10060.27,-5665.79 10062.47,-5656.48 10064.6,-5647.48"/>
<polygon fill="black" stroke="black" points="10068.06,-5648.05 10066.95,-5637.51 10061.25,-5646.44 10068.06,-5648.05"/>
</g>
<!-- transpose_back_2_2 -->
<g id="node838" class="node">
<title>transpose_back_2_2</title>
<ellipse fill="lightgray" stroke="black" cx="10086.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10086.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10086.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10086.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_2&#45;&gt;transpose_back_2_2 -->
<g id="edge1017" class="edge">
<title>attn_output_2_2&#45;&gt;transpose_back_2_2</title>
<path fill="none" stroke="black" d="M10086.57,-5450.42C10086.57,-5441.97 10086.57,-5432.87 10086.57,-5424.06"/>
<polygon fill="black" stroke="black" points="10090.07,-5423.89 10086.57,-5413.89 10083.07,-5423.89 10090.07,-5423.89"/>
</g>
<!-- softmax_2_2&#45;&gt;attn_output_2_2 -->
<g id="edge1016" class="edge">
<title>softmax_2_2&#45;&gt;attn_output_2_2</title>
<path fill="none" stroke="black" d="M10079.24,-5562.42C10080.08,-5553.97 10080.99,-5544.87 10081.87,-5536.06"/>
<polygon fill="black" stroke="black" points="10085.38,-5536.19 10082.89,-5525.89 10078.41,-5535.49 10085.38,-5536.19"/>
</g>
<!-- reshape_concat_2_2 -->
<g id="node839" class="node">
<title>reshape_concat_2_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10086.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10086.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10086.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10086.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_2&#45;&gt;reshape_concat_2_2 -->
<g id="edge1018" class="edge">
<title>transpose_back_2_2&#45;&gt;reshape_concat_2_2</title>
<path fill="none" stroke="black" d="M10086.57,-5338.42C10086.57,-5329.97 10086.57,-5320.87 10086.57,-5312.06"/>
<polygon fill="black" stroke="black" points="10090.07,-5311.89 10086.57,-5301.89 10083.07,-5311.89 10090.07,-5311.89"/>
</g>
<!-- reshape_concat_2_2&#45;&gt;allgather_dim_2_0 -->
<g id="edge1019" class="edge">
<title>reshape_concat_2_2&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M10086.57,-5226.41C10086.57,-5218.1 10086.57,-5209.05 10086.57,-5200.01"/>
<polygon fill="black" stroke="black" points="10090.07,-5199.85 10086.57,-5189.85 10083.07,-5199.85 10090.07,-5199.85"/>
</g>
<!-- split_q_2_3 -->
<g id="node841" class="node">
<title>split_q_2_3</title>
<ellipse fill="pink" stroke="black" cx="10667.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10667.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10667.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10667.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_q_2_3 -->
<g id="edge1021" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_q_2_3</title>
<path fill="none" stroke="black" d="M10960.64,-6019.07C10903.67,-6003.13 10832.29,-5983.15 10774.24,-5966.9"/>
<polygon fill="black" stroke="black" points="10774.88,-5963.45 10764.31,-5964.12 10772.99,-5970.19 10774.88,-5963.45"/>
</g>
<!-- split_k_2_3 -->
<g id="node842" class="node">
<title>split_k_2_3</title>
<ellipse fill="pink" stroke="black" cx="10976.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10976.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10976.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10976.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_k_2_3 -->
<g id="edge1022" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_k_2_3</title>
<path fill="none" stroke="black" d="M11033.07,-6011.03C11025.82,-6001.53 11017.91,-5991.17 11010.37,-5981.3"/>
<polygon fill="black" stroke="black" points="11012.99,-5978.97 11004.14,-5973.14 11007.43,-5983.22 11012.99,-5978.97"/>
</g>
<!-- split_v_2_3 -->
<g id="node843" class="node">
<title>split_v_2_3</title>
<ellipse fill="pink" stroke="black" cx="11285.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11285.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11285.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11285.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_3&#45;&gt;split_v_2_3 -->
<g id="edge1023" class="edge">
<title>reshape_qkv_2_3&#45;&gt;split_v_2_3</title>
<path fill="none" stroke="black" d="M11128.08,-6014.04C11153.9,-6001.42 11183.51,-5986.94 11210.03,-5973.98"/>
<polygon fill="black" stroke="black" points="11211.83,-5976.99 11219.28,-5969.46 11208.75,-5970.71 11211.83,-5976.99"/>
</g>
<!-- transpose_q_2_3 -->
<g id="node844" class="node">
<title>transpose_q_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="10667.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10667.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10667.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10667.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_3&#45;&gt;transpose_q_2_3 -->
<g id="edge1024" class="edge">
<title>split_q_2_3&#45;&gt;transpose_q_2_3</title>
<path fill="none" stroke="black" d="M10667.57,-5898.42C10667.57,-5889.97 10667.57,-5880.87 10667.57,-5872.06"/>
<polygon fill="black" stroke="black" points="10671.07,-5871.89 10667.57,-5861.89 10664.07,-5871.89 10671.07,-5871.89"/>
</g>
<!-- transpose_k_2_3 -->
<g id="node845" class="node">
<title>transpose_k_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="10976.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10976.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10976.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10976.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_3&#45;&gt;transpose_k_2_3 -->
<g id="edge1025" class="edge">
<title>split_k_2_3&#45;&gt;transpose_k_2_3</title>
<path fill="none" stroke="black" d="M10976.57,-5898.42C10976.57,-5889.97 10976.57,-5880.87 10976.57,-5872.06"/>
<polygon fill="black" stroke="black" points="10980.07,-5871.89 10976.57,-5861.89 10973.07,-5871.89 10980.07,-5871.89"/>
</g>
<!-- transpose_v_2_3 -->
<g id="node846" class="node">
<title>transpose_v_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="11285.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11285.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11285.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11285.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_3&#45;&gt;transpose_v_2_3 -->
<g id="edge1026" class="edge">
<title>split_v_2_3&#45;&gt;transpose_v_2_3</title>
<path fill="none" stroke="black" d="M11285.57,-5898.42C11285.57,-5889.97 11285.57,-5880.87 11285.57,-5872.06"/>
<polygon fill="black" stroke="black" points="11289.07,-5871.89 11285.57,-5861.89 11282.07,-5871.89 11289.07,-5871.89"/>
</g>
<!-- attn_scores_2_3 -->
<g id="node847" class="node">
<title>attn_scores_2_3</title>
<ellipse fill="gold" stroke="black" cx="10808.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10808.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10808.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10808.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_3&#45;&gt;attn_scores_2_3 -->
<g id="edge1027" class="edge">
<title>transpose_q_2_3&#45;&gt;attn_scores_2_3</title>
<path fill="none" stroke="black" d="M10712.19,-5788.24C10725.81,-5777.61 10740.93,-5765.82 10755.08,-5754.78"/>
<polygon fill="black" stroke="black" points="10757.55,-5757.29 10763.28,-5748.38 10753.24,-5751.77 10757.55,-5757.29"/>
</g>
<!-- transpose_k_2_3&#45;&gt;attn_scores_2_3 -->
<g id="edge1028" class="edge">
<title>transpose_k_2_3&#45;&gt;attn_scores_2_3</title>
<path fill="none" stroke="black" d="M10924.34,-5788.84C10907.2,-5777.62 10888,-5765.05 10870.24,-5753.42"/>
<polygon fill="black" stroke="black" points="10871.93,-5750.34 10861.64,-5747.79 10868.09,-5756.2 10871.93,-5750.34"/>
</g>
<!-- attn_output_2_3 -->
<g id="node848" class="node">
<title>attn_output_2_3</title>
<ellipse fill="gold" stroke="black" cx="10808.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10808.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10808.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10808.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_3&#45;&gt;attn_output_2_3 -->
<g id="edge1029" class="edge">
<title>transpose_v_2_3&#45;&gt;attn_output_2_3</title>
<path fill="none" stroke="black" d="M11251.9,-5787.38C11199.12,-5733.07 11091.8,-5628.95 10984.57,-5562.55 10959.52,-5547.03 10930.61,-5533.42 10903.56,-5522.26"/>
<polygon fill="black" stroke="black" points="10904.66,-5518.93 10894.07,-5518.42 10902.03,-5525.42 10904.66,-5518.93"/>
</g>
<!-- softmax_2_3 -->
<g id="node849" class="node">
<title>softmax_2_3</title>
<ellipse fill="gold" stroke="black" cx="10808.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10808.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10808.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10808.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_3&#45;&gt;softmax_2_3 -->
<g id="edge1030" class="edge">
<title>attn_scores_2_3&#45;&gt;softmax_2_3</title>
<path fill="none" stroke="black" d="M10808.57,-5674.42C10808.57,-5665.97 10808.57,-5656.87 10808.57,-5648.06"/>
<polygon fill="black" stroke="black" points="10812.07,-5647.89 10808.57,-5637.89 10805.07,-5647.89 10812.07,-5647.89"/>
</g>
<!-- transpose_back_2_3 -->
<g id="node850" class="node">
<title>transpose_back_2_3</title>
<ellipse fill="lightgray" stroke="black" cx="10763.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10763.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10763.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10763.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_3&#45;&gt;transpose_back_2_3 -->
<g id="edge1032" class="edge">
<title>attn_output_2_3&#45;&gt;transpose_back_2_3</title>
<path fill="none" stroke="black" d="M10793.71,-5450.72C10790.1,-5441.9 10786.2,-5432.35 10782.43,-5423.14"/>
<polygon fill="black" stroke="black" points="10785.6,-5421.64 10778.57,-5413.71 10779.12,-5424.29 10785.6,-5421.64"/>
</g>
<!-- softmax_2_3&#45;&gt;attn_output_2_3 -->
<g id="edge1031" class="edge">
<title>softmax_2_3&#45;&gt;attn_output_2_3</title>
<path fill="none" stroke="black" d="M10808.57,-5562.42C10808.57,-5553.97 10808.57,-5544.87 10808.57,-5536.06"/>
<polygon fill="black" stroke="black" points="10812.07,-5535.89 10808.57,-5525.89 10805.07,-5535.89 10812.07,-5535.89"/>
</g>
<!-- reshape_concat_2_3 -->
<g id="node851" class="node">
<title>reshape_concat_2_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10537.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10537.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10537.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10537.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_3&#45;&gt;reshape_concat_2_3 -->
<g id="edge1033" class="edge">
<title>transpose_back_2_3&#45;&gt;reshape_concat_2_3</title>
<path fill="none" stroke="black" d="M10696.99,-5342.64C10670.32,-5329.66 10639.47,-5314.64 10612.06,-5301.3"/>
<polygon fill="black" stroke="black" points="10613.43,-5298.07 10602.9,-5296.84 10610.36,-5304.37 10613.43,-5298.07"/>
</g>
<!-- reshape_concat_2_3&#45;&gt;allgather_dim_2_0 -->
<g id="edge1034" class="edge">
<title>reshape_concat_2_3&#45;&gt;allgather_dim_2_0</title>
<path fill="none" stroke="black" d="M10444.67,-5237.19C10369.13,-5216.17 10262.79,-5186.58 10185.63,-5165.11"/>
<polygon fill="black" stroke="black" points="10186.47,-5161.71 10175.9,-5162.4 10184.59,-5168.45 10186.47,-5161.71"/>
</g>
<!-- output_proj_2_0 -->
<g id="node1003" class="node">
<title>output_proj_2_0</title>
<ellipse fill="orange" stroke="black" cx="12358.57" cy="-4923.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="12358.57" y="-4942.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12358.57" y="-4927.26" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="12358.57" y="-4912.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12358.57" y="-4897.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_0&#45;&gt;output_proj_2_0 -->
<g id="edge1219" class="edge">
<title>head_group_2_0&#45;&gt;output_proj_2_0</title>
<path fill="none" stroke="black" d="M10857.15,-5020.26C11128.83,-5002.92 11889.47,-4954.39 12211.54,-4933.84"/>
<polygon fill="black" stroke="black" points="12212.12,-4937.31 12221.87,-4933.18 12211.67,-4930.33 12212.12,-4937.31"/>
</g>
<!-- split_q_2_4 -->
<g id="node854" class="node">
<title>split_q_2_4</title>
<ellipse fill="pink" stroke="black" cx="11594.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11594.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11594.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11594.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_q_2_4 -->
<g id="edge1037" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_q_2_4</title>
<path fill="none" stroke="black" d="M11922.96,-6020.28C11857.31,-6003.64 11773.01,-5982.27 11706.26,-5965.35"/>
<polygon fill="black" stroke="black" points="11707.09,-5961.95 11696.54,-5962.89 11705.37,-5968.74 11707.09,-5961.95"/>
</g>
<!-- split_k_2_4 -->
<g id="node855" class="node">
<title>split_k_2_4</title>
<ellipse fill="pink" stroke="black" cx="11903.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11903.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11903.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11903.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_k_2_4 -->
<g id="edge1038" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_k_2_4</title>
<path fill="none" stroke="black" d="M11988.33,-6011.64C11976.63,-6001.33 11963.72,-5989.97 11951.58,-5979.29"/>
<polygon fill="black" stroke="black" points="11953.56,-5976.37 11943.74,-5972.39 11948.93,-5981.62 11953.56,-5976.37"/>
</g>
<!-- split_v_2_4 -->
<g id="node856" class="node">
<title>split_v_2_4</title>
<ellipse fill="pink" stroke="black" cx="12212.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12212.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12212.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12212.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_4&#45;&gt;split_v_2_4 -->
<g id="edge1039" class="edge">
<title>reshape_qkv_2_4&#45;&gt;split_v_2_4</title>
<path fill="none" stroke="black" d="M12085.53,-6012.99C12105.12,-6001.29 12127.19,-5988.09 12147.38,-5976.02"/>
<polygon fill="black" stroke="black" points="12149.41,-5978.88 12156.2,-5970.75 12145.82,-5972.87 12149.41,-5978.88"/>
</g>
<!-- transpose_q_2_4 -->
<g id="node857" class="node">
<title>transpose_q_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="11594.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11594.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11594.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11594.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_4&#45;&gt;transpose_q_2_4 -->
<g id="edge1040" class="edge">
<title>split_q_2_4&#45;&gt;transpose_q_2_4</title>
<path fill="none" stroke="black" d="M11594.57,-5898.42C11594.57,-5889.97 11594.57,-5880.87 11594.57,-5872.06"/>
<polygon fill="black" stroke="black" points="11598.07,-5871.89 11594.57,-5861.89 11591.07,-5871.89 11598.07,-5871.89"/>
</g>
<!-- transpose_k_2_4 -->
<g id="node858" class="node">
<title>transpose_k_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="11903.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11903.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11903.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11903.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_4&#45;&gt;transpose_k_2_4 -->
<g id="edge1041" class="edge">
<title>split_k_2_4&#45;&gt;transpose_k_2_4</title>
<path fill="none" stroke="black" d="M11903.57,-5898.42C11903.57,-5889.97 11903.57,-5880.87 11903.57,-5872.06"/>
<polygon fill="black" stroke="black" points="11907.07,-5871.89 11903.57,-5861.89 11900.07,-5871.89 11907.07,-5871.89"/>
</g>
<!-- transpose_v_2_4 -->
<g id="node859" class="node">
<title>transpose_v_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="12212.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12212.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12212.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12212.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_4&#45;&gt;transpose_v_2_4 -->
<g id="edge1042" class="edge">
<title>split_v_2_4&#45;&gt;transpose_v_2_4</title>
<path fill="none" stroke="black" d="M12212.57,-5898.42C12212.57,-5889.97 12212.57,-5880.87 12212.57,-5872.06"/>
<polygon fill="black" stroke="black" points="12216.07,-5871.89 12212.57,-5861.89 12209.07,-5871.89 12216.07,-5871.89"/>
</g>
<!-- attn_scores_2_4 -->
<g id="node860" class="node">
<title>attn_scores_2_4</title>
<ellipse fill="gold" stroke="black" cx="11903.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11903.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11903.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11903.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_4&#45;&gt;attn_scores_2_4 -->
<g id="edge1043" class="edge">
<title>transpose_q_2_4&#45;&gt;attn_scores_2_4</title>
<path fill="none" stroke="black" d="M11678.19,-5793.28C11717.91,-5779.14 11765.6,-5762.16 11806.86,-5747.47"/>
<polygon fill="black" stroke="black" points="11808.13,-5750.74 11816.38,-5744.08 11805.79,-5744.14 11808.13,-5750.74"/>
</g>
<!-- transpose_k_2_4&#45;&gt;attn_scores_2_4 -->
<g id="edge1044" class="edge">
<title>transpose_k_2_4&#45;&gt;attn_scores_2_4</title>
<path fill="none" stroke="black" d="M11903.57,-5786.42C11903.57,-5777.97 11903.57,-5768.87 11903.57,-5760.06"/>
<polygon fill="black" stroke="black" points="11907.07,-5759.89 11903.57,-5749.89 11900.07,-5759.89 11907.07,-5759.89"/>
</g>
<!-- attn_output_2_4 -->
<g id="node861" class="node">
<title>attn_output_2_4</title>
<ellipse fill="gold" stroke="black" cx="12212.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12212.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12212.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12212.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_4&#45;&gt;attn_output_2_4 -->
<g id="edge1045" class="edge">
<title>transpose_v_2_4&#45;&gt;attn_output_2_4</title>
<path fill="none" stroke="black" d="M12212.57,-5786.35C12212.57,-5725.3 12212.57,-5602.99 12212.57,-5535.84"/>
<polygon fill="black" stroke="black" points="12216.07,-5535.55 12212.57,-5525.55 12209.07,-5535.55 12216.07,-5535.55"/>
</g>
<!-- softmax_2_4 -->
<g id="node862" class="node">
<title>softmax_2_4</title>
<ellipse fill="gold" stroke="black" cx="11960.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11960.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11960.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11960.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_4&#45;&gt;softmax_2_4 -->
<g id="edge1046" class="edge">
<title>attn_scores_2_4&#45;&gt;softmax_2_4</title>
<path fill="none" stroke="black" d="M11922.4,-5674.72C11927.11,-5665.62 11932.23,-5655.74 11937.15,-5646.26"/>
<polygon fill="black" stroke="black" points="11940.28,-5647.82 11941.77,-5637.33 11934.06,-5644.6 11940.28,-5647.82"/>
</g>
<!-- transpose_back_2_4 -->
<g id="node863" class="node">
<title>transpose_back_2_4</title>
<ellipse fill="lightgray" stroke="black" cx="12768.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12768.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12768.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12768.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_4&#45;&gt;transpose_back_2_4 -->
<g id="edge1048" class="edge">
<title>attn_output_2_4&#45;&gt;transpose_back_2_4</title>
<path fill="none" stroke="black" d="M12326.43,-5464.52C12419.1,-5446.19 12549.68,-5420.35 12644.9,-5401.51"/>
<polygon fill="black" stroke="black" points="12645.74,-5404.92 12654.87,-5399.54 12644.38,-5398.05 12645.74,-5404.92"/>
</g>
<!-- softmax_2_4&#45;&gt;attn_output_2_4 -->
<g id="edge1047" class="edge">
<title>softmax_2_4&#45;&gt;attn_output_2_4</title>
<path fill="none" stroke="black" d="M12035.16,-5566.49C12065.15,-5553.4 12099.83,-5538.26 12130.52,-5524.86"/>
<polygon fill="black" stroke="black" points="12132.15,-5527.97 12139.91,-5520.76 12129.35,-5521.55 12132.15,-5527.97"/>
</g>
<!-- reshape_concat_2_4 -->
<g id="node864" class="node">
<title>reshape_concat_2_4</title>
<ellipse fill="lightcyan" stroke="black" cx="13118.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13118.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13118.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13118.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_4&#45;&gt;reshape_concat_2_4 -->
<g id="edge1049" class="edge">
<title>transpose_back_2_4&#45;&gt;reshape_concat_2_4</title>
<path fill="none" stroke="black" d="M12859.16,-5346.57C12909.02,-5330.91 12970.89,-5311.46 13021.7,-5295.49"/>
<polygon fill="black" stroke="black" points="13022.89,-5298.79 13031.38,-5292.45 13020.79,-5292.11 13022.89,-5298.79"/>
</g>
<!-- allgather_dim_2_1 -->
<g id="node865" class="node">
<title>allgather_dim_2_1</title>
<polygon fill="red" stroke="black" points="14021.57,-5189.55 13848.57,-5136.55 14021.57,-5083.55 14194.57,-5136.55 14021.57,-5189.55"/>
<text text-anchor="middle" x="14021.57" y="-5147.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="14021.57" y="-5132.85" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14021.57" y="-5117.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_4&#45;&gt;allgather_dim_2_1 -->
<g id="edge1050" class="edge">
<title>reshape_concat_2_4&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M13236.62,-5246.64C13406.74,-5223 13719.55,-5179.52 13894.53,-5155.2"/>
<polygon fill="black" stroke="black" points="13895.14,-5158.65 13904.57,-5153.81 13894.18,-5151.72 13895.14,-5158.65"/>
</g>
<!-- head_group_2_1 -->
<g id="node902" class="node">
<title>head_group_2_1</title>
<polygon fill="lightyellow" stroke="black" points="14280.07,-5046.55 14083.07,-5046.55 14083.07,-5008.55 14280.07,-5008.55 14280.07,-5046.55"/>
<text text-anchor="middle" x="14181.57" y="-5031.35" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14181.57" y="-5016.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_1&#45;&gt;head_group_2_1 -->
<g id="edge1096" class="edge">
<title>allgather_dim_2_1&#45;&gt;head_group_2_1</title>
<path fill="none" stroke="black" d="M14075.3,-5099.62C14098.49,-5084.11 14125,-5066.38 14145.74,-5052.51"/>
<polygon fill="black" stroke="black" points="14147.89,-5055.28 14154.25,-5046.82 14143.99,-5049.47 14147.89,-5055.28"/>
</g>
<!-- split_q_2_5 -->
<g id="node867" class="node">
<title>split_q_2_5</title>
<ellipse fill="pink" stroke="black" cx="12521.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12521.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12521.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12521.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_q_2_5 -->
<g id="edge1052" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_q_2_5</title>
<path fill="none" stroke="black" d="M12814.64,-6019.07C12757.67,-6003.13 12686.29,-5983.15 12628.24,-5966.9"/>
<polygon fill="black" stroke="black" points="12628.88,-5963.45 12618.31,-5964.12 12626.99,-5970.19 12628.88,-5963.45"/>
</g>
<!-- split_k_2_5 -->
<g id="node868" class="node">
<title>split_k_2_5</title>
<ellipse fill="pink" stroke="black" cx="12830.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12830.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12830.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12830.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_k_2_5 -->
<g id="edge1053" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_k_2_5</title>
<path fill="none" stroke="black" d="M12887.07,-6011.03C12879.82,-6001.53 12871.91,-5991.17 12864.37,-5981.3"/>
<polygon fill="black" stroke="black" points="12866.99,-5978.97 12858.14,-5973.14 12861.43,-5983.22 12866.99,-5978.97"/>
</g>
<!-- split_v_2_5 -->
<g id="node869" class="node">
<title>split_v_2_5</title>
<ellipse fill="pink" stroke="black" cx="13139.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13139.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13139.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13139.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_5&#45;&gt;split_v_2_5 -->
<g id="edge1054" class="edge">
<title>reshape_qkv_2_5&#45;&gt;split_v_2_5</title>
<path fill="none" stroke="black" d="M12982.08,-6014.04C13007.9,-6001.42 13037.51,-5986.94 13064.03,-5973.98"/>
<polygon fill="black" stroke="black" points="13065.83,-5976.99 13073.28,-5969.46 13062.75,-5970.71 13065.83,-5976.99"/>
</g>
<!-- transpose_q_2_5 -->
<g id="node870" class="node">
<title>transpose_q_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="12521.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12521.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12521.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12521.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_5&#45;&gt;transpose_q_2_5 -->
<g id="edge1055" class="edge">
<title>split_q_2_5&#45;&gt;transpose_q_2_5</title>
<path fill="none" stroke="black" d="M12521.57,-5898.42C12521.57,-5889.97 12521.57,-5880.87 12521.57,-5872.06"/>
<polygon fill="black" stroke="black" points="12525.07,-5871.89 12521.57,-5861.89 12518.07,-5871.89 12525.07,-5871.89"/>
</g>
<!-- transpose_k_2_5 -->
<g id="node871" class="node">
<title>transpose_k_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="12830.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12830.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12830.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12830.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_5&#45;&gt;transpose_k_2_5 -->
<g id="edge1056" class="edge">
<title>split_k_2_5&#45;&gt;transpose_k_2_5</title>
<path fill="none" stroke="black" d="M12830.57,-5898.42C12830.57,-5889.97 12830.57,-5880.87 12830.57,-5872.06"/>
<polygon fill="black" stroke="black" points="12834.07,-5871.89 12830.57,-5861.89 12827.07,-5871.89 12834.07,-5871.89"/>
</g>
<!-- transpose_v_2_5 -->
<g id="node872" class="node">
<title>transpose_v_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="13139.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13139.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13139.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13139.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_5&#45;&gt;transpose_v_2_5 -->
<g id="edge1057" class="edge">
<title>split_v_2_5&#45;&gt;transpose_v_2_5</title>
<path fill="none" stroke="black" d="M13139.57,-5898.42C13139.57,-5889.97 13139.57,-5880.87 13139.57,-5872.06"/>
<polygon fill="black" stroke="black" points="13143.07,-5871.89 13139.57,-5861.89 13136.07,-5871.89 13143.07,-5871.89"/>
</g>
<!-- attn_scores_2_5 -->
<g id="node873" class="node">
<title>attn_scores_2_5</title>
<ellipse fill="gold" stroke="black" cx="12830.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12830.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12830.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12830.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_5&#45;&gt;attn_scores_2_5 -->
<g id="edge1058" class="edge">
<title>transpose_q_2_5&#45;&gt;attn_scores_2_5</title>
<path fill="none" stroke="black" d="M12605.19,-5793.28C12644.91,-5779.14 12692.6,-5762.16 12733.86,-5747.47"/>
<polygon fill="black" stroke="black" points="12735.13,-5750.74 12743.38,-5744.08 12732.79,-5744.14 12735.13,-5750.74"/>
</g>
<!-- transpose_k_2_5&#45;&gt;attn_scores_2_5 -->
<g id="edge1059" class="edge">
<title>transpose_k_2_5&#45;&gt;attn_scores_2_5</title>
<path fill="none" stroke="black" d="M12830.57,-5786.42C12830.57,-5777.97 12830.57,-5768.87 12830.57,-5760.06"/>
<polygon fill="black" stroke="black" points="12834.07,-5759.89 12830.57,-5749.89 12827.07,-5759.89 12834.07,-5759.89"/>
</g>
<!-- attn_output_2_5 -->
<g id="node874" class="node">
<title>attn_output_2_5</title>
<ellipse fill="gold" stroke="black" cx="13139.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13139.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13139.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13139.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_5&#45;&gt;attn_output_2_5 -->
<g id="edge1060" class="edge">
<title>transpose_v_2_5&#45;&gt;attn_output_2_5</title>
<path fill="none" stroke="black" d="M13139.57,-5786.35C13139.57,-5725.3 13139.57,-5602.99 13139.57,-5535.84"/>
<polygon fill="black" stroke="black" points="13143.07,-5535.55 13139.57,-5525.55 13136.07,-5535.55 13143.07,-5535.55"/>
</g>
<!-- softmax_2_5 -->
<g id="node875" class="node">
<title>softmax_2_5</title>
<ellipse fill="gold" stroke="black" cx="12887.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12887.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12887.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12887.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_5&#45;&gt;softmax_2_5 -->
<g id="edge1061" class="edge">
<title>attn_scores_2_5&#45;&gt;softmax_2_5</title>
<path fill="none" stroke="black" d="M12849.4,-5674.72C12854.11,-5665.62 12859.23,-5655.74 12864.15,-5646.26"/>
<polygon fill="black" stroke="black" points="12867.28,-5647.82 12868.77,-5637.33 12861.06,-5644.6 12867.28,-5647.82"/>
</g>
<!-- transpose_back_2_5 -->
<g id="node876" class="node">
<title>transpose_back_2_5</title>
<ellipse fill="lightgray" stroke="black" cx="13386.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13386.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13386.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13386.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_5&#45;&gt;transpose_back_2_5 -->
<g id="edge1063" class="edge">
<title>attn_output_2_5&#45;&gt;transpose_back_2_5</title>
<path fill="none" stroke="black" d="M13211.02,-5455.23C13240.71,-5442 13275.33,-5426.59 13305.93,-5412.96"/>
<polygon fill="black" stroke="black" points="13307.58,-5416.06 13315.29,-5408.79 13304.73,-5409.66 13307.58,-5416.06"/>
</g>
<!-- softmax_2_5&#45;&gt;attn_output_2_5 -->
<g id="edge1062" class="edge">
<title>softmax_2_5&#45;&gt;attn_output_2_5</title>
<path fill="none" stroke="black" d="M12962.16,-5566.49C12992.15,-5553.4 13026.83,-5538.26 13057.52,-5524.86"/>
<polygon fill="black" stroke="black" points="13059.15,-5527.97 13066.91,-5520.76 13056.35,-5521.55 13059.15,-5527.97"/>
</g>
<!-- reshape_concat_2_5 -->
<g id="node877" class="node">
<title>reshape_concat_2_5</title>
<ellipse fill="lightcyan" stroke="black" cx="13679.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13679.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13679.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13679.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_5&#45;&gt;reshape_concat_2_5 -->
<g id="edge1064" class="edge">
<title>transpose_back_2_5&#45;&gt;reshape_concat_2_5</title>
<path fill="none" stroke="black" d="M13467.41,-5344.7C13505.9,-5330.25 13552.02,-5312.93 13591.41,-5298.14"/>
<polygon fill="black" stroke="black" points="13593.14,-5301.23 13601.27,-5294.44 13590.68,-5294.68 13593.14,-5301.23"/>
</g>
<!-- reshape_concat_2_5&#45;&gt;allgather_dim_2_1 -->
<g id="edge1065" class="edge">
<title>reshape_concat_2_5&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M13758.89,-5233.94C13811.48,-5214.64 13880.49,-5189.32 13934.58,-5169.47"/>
<polygon fill="black" stroke="black" points="13935.97,-5172.69 13944.16,-5165.95 13933.56,-5166.11 13935.97,-5172.69"/>
</g>
<!-- split_q_2_6 -->
<g id="node879" class="node">
<title>split_q_2_6</title>
<ellipse fill="pink" stroke="black" cx="13448.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13448.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13448.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13448.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_q_2_6 -->
<g id="edge1067" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_q_2_6</title>
<path fill="none" stroke="black" d="M13741.64,-6019.07C13684.67,-6003.13 13613.29,-5983.15 13555.24,-5966.9"/>
<polygon fill="black" stroke="black" points="13555.88,-5963.45 13545.31,-5964.12 13553.99,-5970.19 13555.88,-5963.45"/>
</g>
<!-- split_k_2_6 -->
<g id="node880" class="node">
<title>split_k_2_6</title>
<ellipse fill="pink" stroke="black" cx="13757.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13757.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13757.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13757.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_k_2_6 -->
<g id="edge1068" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_k_2_6</title>
<path fill="none" stroke="black" d="M13814.07,-6011.03C13806.82,-6001.53 13798.91,-5991.17 13791.37,-5981.3"/>
<polygon fill="black" stroke="black" points="13793.99,-5978.97 13785.14,-5973.14 13788.43,-5983.22 13793.99,-5978.97"/>
</g>
<!-- split_v_2_6 -->
<g id="node881" class="node">
<title>split_v_2_6</title>
<ellipse fill="pink" stroke="black" cx="14066.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14066.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14066.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14066.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_6&#45;&gt;split_v_2_6 -->
<g id="edge1069" class="edge">
<title>reshape_qkv_2_6&#45;&gt;split_v_2_6</title>
<path fill="none" stroke="black" d="M13909.08,-6014.04C13934.9,-6001.42 13964.51,-5986.94 13991.03,-5973.98"/>
<polygon fill="black" stroke="black" points="13992.83,-5976.99 14000.28,-5969.46 13989.75,-5970.71 13992.83,-5976.99"/>
</g>
<!-- transpose_q_2_6 -->
<g id="node882" class="node">
<title>transpose_q_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="13448.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13448.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13448.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13448.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_6&#45;&gt;transpose_q_2_6 -->
<g id="edge1070" class="edge">
<title>split_q_2_6&#45;&gt;transpose_q_2_6</title>
<path fill="none" stroke="black" d="M13448.57,-5898.42C13448.57,-5889.97 13448.57,-5880.87 13448.57,-5872.06"/>
<polygon fill="black" stroke="black" points="13452.07,-5871.89 13448.57,-5861.89 13445.07,-5871.89 13452.07,-5871.89"/>
</g>
<!-- transpose_k_2_6 -->
<g id="node883" class="node">
<title>transpose_k_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="13757.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13757.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13757.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13757.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_6&#45;&gt;transpose_k_2_6 -->
<g id="edge1071" class="edge">
<title>split_k_2_6&#45;&gt;transpose_k_2_6</title>
<path fill="none" stroke="black" d="M13757.57,-5898.42C13757.57,-5889.97 13757.57,-5880.87 13757.57,-5872.06"/>
<polygon fill="black" stroke="black" points="13761.07,-5871.89 13757.57,-5861.89 13754.07,-5871.89 13761.07,-5871.89"/>
</g>
<!-- transpose_v_2_6 -->
<g id="node884" class="node">
<title>transpose_v_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14066.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14066.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14066.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14066.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_6&#45;&gt;transpose_v_2_6 -->
<g id="edge1072" class="edge">
<title>split_v_2_6&#45;&gt;transpose_v_2_6</title>
<path fill="none" stroke="black" d="M14066.57,-5898.42C14066.57,-5889.97 14066.57,-5880.87 14066.57,-5872.06"/>
<polygon fill="black" stroke="black" points="14070.07,-5871.89 14066.57,-5861.89 14063.07,-5871.89 14070.07,-5871.89"/>
</g>
<!-- attn_scores_2_6 -->
<g id="node885" class="node">
<title>attn_scores_2_6</title>
<ellipse fill="gold" stroke="black" cx="13757.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13757.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13757.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13757.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_6&#45;&gt;attn_scores_2_6 -->
<g id="edge1073" class="edge">
<title>transpose_q_2_6&#45;&gt;attn_scores_2_6</title>
<path fill="none" stroke="black" d="M13532.19,-5793.28C13571.91,-5779.14 13619.6,-5762.16 13660.86,-5747.47"/>
<polygon fill="black" stroke="black" points="13662.13,-5750.74 13670.38,-5744.08 13659.79,-5744.14 13662.13,-5750.74"/>
</g>
<!-- transpose_k_2_6&#45;&gt;attn_scores_2_6 -->
<g id="edge1074" class="edge">
<title>transpose_k_2_6&#45;&gt;attn_scores_2_6</title>
<path fill="none" stroke="black" d="M13757.57,-5786.42C13757.57,-5777.97 13757.57,-5768.87 13757.57,-5760.06"/>
<polygon fill="black" stroke="black" points="13761.07,-5759.89 13757.57,-5749.89 13754.07,-5759.89 13761.07,-5759.89"/>
</g>
<!-- attn_output_2_6 -->
<g id="node886" class="node">
<title>attn_output_2_6</title>
<ellipse fill="gold" stroke="black" cx="14021.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14021.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14021.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14021.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_6&#45;&gt;attn_output_2_6 -->
<g id="edge1075" class="edge">
<title>transpose_v_2_6&#45;&gt;attn_output_2_6</title>
<path fill="none" stroke="black" d="M14061.63,-5786.35C14053.4,-5725.3 14036.92,-5602.99 14027.88,-5535.84"/>
<polygon fill="black" stroke="black" points="14031.3,-5534.99 14026.49,-5525.55 14024.36,-5535.93 14031.3,-5534.99"/>
</g>
<!-- softmax_2_6 -->
<g id="node887" class="node">
<title>softmax_2_6</title>
<ellipse fill="gold" stroke="black" cx="13799.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13799.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13799.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13799.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_6&#45;&gt;softmax_2_6 -->
<g id="edge1076" class="edge">
<title>attn_scores_2_6&#45;&gt;softmax_2_6</title>
<path fill="none" stroke="black" d="M13771.56,-5674.42C13774.92,-5665.6 13778.56,-5656.08 13782.06,-5646.9"/>
<polygon fill="black" stroke="black" points="13785.35,-5648.1 13785.65,-5637.51 13778.81,-5645.61 13785.35,-5648.1"/>
</g>
<!-- transpose_back_2_6 -->
<g id="node888" class="node">
<title>transpose_back_2_6</title>
<ellipse fill="lightgray" stroke="black" cx="14021.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14021.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14021.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14021.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_6&#45;&gt;transpose_back_2_6 -->
<g id="edge1078" class="edge">
<title>attn_output_2_6&#45;&gt;transpose_back_2_6</title>
<path fill="none" stroke="black" d="M14021.57,-5450.42C14021.57,-5441.97 14021.57,-5432.87 14021.57,-5424.06"/>
<polygon fill="black" stroke="black" points="14025.07,-5423.89 14021.57,-5413.89 14018.07,-5423.89 14025.07,-5423.89"/>
</g>
<!-- softmax_2_6&#45;&gt;attn_output_2_6 -->
<g id="edge1077" class="edge">
<title>softmax_2_6&#45;&gt;attn_output_2_6</title>
<path fill="none" stroke="black" d="M13867.08,-5565.59C13892.3,-5553.1 13921.08,-5538.84 13946.91,-5526.04"/>
<polygon fill="black" stroke="black" points="13948.5,-5529.16 13955.91,-5521.58 13945.39,-5522.89 13948.5,-5529.16"/>
</g>
<!-- reshape_concat_2_6 -->
<g id="node889" class="node">
<title>reshape_concat_2_6</title>
<ellipse fill="lightcyan" stroke="black" cx="14021.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14021.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14021.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14021.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_6&#45;&gt;reshape_concat_2_6 -->
<g id="edge1079" class="edge">
<title>transpose_back_2_6&#45;&gt;reshape_concat_2_6</title>
<path fill="none" stroke="black" d="M14021.57,-5338.42C14021.57,-5329.97 14021.57,-5320.87 14021.57,-5312.06"/>
<polygon fill="black" stroke="black" points="14025.07,-5311.89 14021.57,-5301.89 14018.07,-5311.89 14025.07,-5311.89"/>
</g>
<!-- reshape_concat_2_6&#45;&gt;allgather_dim_2_1 -->
<g id="edge1080" class="edge">
<title>reshape_concat_2_6&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M14021.57,-5226.41C14021.57,-5218.1 14021.57,-5209.05 14021.57,-5200.01"/>
<polygon fill="black" stroke="black" points="14025.07,-5199.85 14021.57,-5189.85 14018.07,-5199.85 14025.07,-5199.85"/>
</g>
<!-- split_q_2_7 -->
<g id="node891" class="node">
<title>split_q_2_7</title>
<ellipse fill="pink" stroke="black" cx="14375.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14375.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14375.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14375.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_q_2_7 -->
<g id="edge1082" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_q_2_7</title>
<path fill="none" stroke="black" d="M14626.66,-6017.57C14579.78,-6002.53 14522.71,-5984.23 14474.83,-5968.88"/>
<polygon fill="black" stroke="black" points="14475.67,-5965.47 14465.08,-5965.75 14473.53,-5972.14 14475.67,-5965.47"/>
</g>
<!-- split_k_2_7 -->
<g id="node892" class="node">
<title>split_k_2_7</title>
<ellipse fill="pink" stroke="black" cx="14684.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14684.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14684.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14684.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_k_2_7 -->
<g id="edge1083" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_k_2_7</title>
<path fill="none" stroke="black" d="M14707.25,-6010.42C14704.56,-6001.7 14701.65,-5992.28 14698.84,-5983.19"/>
<polygon fill="black" stroke="black" points="14702.14,-5982.03 14695.85,-5973.51 14695.45,-5984.1 14702.14,-5982.03"/>
</g>
<!-- split_v_2_7 -->
<g id="node893" class="node">
<title>split_v_2_7</title>
<ellipse fill="pink" stroke="black" cx="14993.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14993.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14993.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14993.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_7&#45;&gt;split_v_2_7 -->
<g id="edge1084" class="edge">
<title>reshape_qkv_2_7&#45;&gt;split_v_2_7</title>
<path fill="none" stroke="black" d="M14797.38,-6015.52C14831.47,-6001.89 14871.49,-5985.88 14906.46,-5971.89"/>
<polygon fill="black" stroke="black" points="14908.2,-5974.97 14916.18,-5968 14905.6,-5968.47 14908.2,-5974.97"/>
</g>
<!-- transpose_q_2_7 -->
<g id="node894" class="node">
<title>transpose_q_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="14375.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14375.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14375.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14375.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_7&#45;&gt;transpose_q_2_7 -->
<g id="edge1085" class="edge">
<title>split_q_2_7&#45;&gt;transpose_q_2_7</title>
<path fill="none" stroke="black" d="M14375.57,-5898.42C14375.57,-5889.97 14375.57,-5880.87 14375.57,-5872.06"/>
<polygon fill="black" stroke="black" points="14379.07,-5871.89 14375.57,-5861.89 14372.07,-5871.89 14379.07,-5871.89"/>
</g>
<!-- transpose_k_2_7 -->
<g id="node895" class="node">
<title>transpose_k_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="14684.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14684.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14684.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14684.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_7&#45;&gt;transpose_k_2_7 -->
<g id="edge1086" class="edge">
<title>split_k_2_7&#45;&gt;transpose_k_2_7</title>
<path fill="none" stroke="black" d="M14684.57,-5898.42C14684.57,-5889.97 14684.57,-5880.87 14684.57,-5872.06"/>
<polygon fill="black" stroke="black" points="14688.07,-5871.89 14684.57,-5861.89 14681.07,-5871.89 14688.07,-5871.89"/>
</g>
<!-- transpose_v_2_7 -->
<g id="node896" class="node">
<title>transpose_v_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="14993.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14993.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14993.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14993.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_7&#45;&gt;transpose_v_2_7 -->
<g id="edge1087" class="edge">
<title>split_v_2_7&#45;&gt;transpose_v_2_7</title>
<path fill="none" stroke="black" d="M14993.57,-5898.42C14993.57,-5889.97 14993.57,-5880.87 14993.57,-5872.06"/>
<polygon fill="black" stroke="black" points="14997.07,-5871.89 14993.57,-5861.89 14990.07,-5871.89 14997.07,-5871.89"/>
</g>
<!-- attn_scores_2_7 -->
<g id="node897" class="node">
<title>attn_scores_2_7</title>
<ellipse fill="gold" stroke="black" cx="14571.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14571.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14571.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14571.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_7&#45;&gt;attn_scores_2_7 -->
<g id="edge1088" class="edge">
<title>transpose_q_2_7&#45;&gt;attn_scores_2_7</title>
<path fill="none" stroke="black" d="M14434.91,-5789.74C14456,-5777.91 14479.94,-5764.47 14501.83,-5752.19"/>
<polygon fill="black" stroke="black" points="14503.73,-5755.13 14510.74,-5747.19 14500.31,-5749.03 14503.73,-5755.13"/>
</g>
<!-- transpose_k_2_7&#45;&gt;attn_scores_2_7 -->
<g id="edge1089" class="edge">
<title>transpose_k_2_7&#45;&gt;attn_scores_2_7</title>
<path fill="none" stroke="black" d="M14648.2,-5787.64C14637.82,-5777.53 14626.4,-5766.41 14615.61,-5755.91"/>
<polygon fill="black" stroke="black" points="14617.88,-5753.23 14608.27,-5748.77 14612.99,-5758.25 14617.88,-5753.23"/>
</g>
<!-- attn_output_2_7 -->
<g id="node898" class="node">
<title>attn_output_2_7</title>
<ellipse fill="gold" stroke="black" cx="14571.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14571.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14571.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14571.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_7&#45;&gt;attn_output_2_7 -->
<g id="edge1090" class="edge">
<title>transpose_v_2_7&#45;&gt;attn_output_2_7</title>
<path fill="none" stroke="black" d="M14967.48,-5786.92C14926.22,-5732 14840.96,-5627.09 14747.57,-5562.55 14724.16,-5546.36 14696.63,-5532.76 14670.39,-5521.83"/>
<polygon fill="black" stroke="black" points="14671.37,-5518.45 14660.79,-5517.93 14668.73,-5524.94 14671.37,-5518.45"/>
</g>
<!-- softmax_2_7 -->
<g id="node899" class="node">
<title>softmax_2_7</title>
<ellipse fill="gold" stroke="black" cx="14571.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14571.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14571.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14571.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_7&#45;&gt;softmax_2_7 -->
<g id="edge1091" class="edge">
<title>attn_scores_2_7&#45;&gt;softmax_2_7</title>
<path fill="none" stroke="black" d="M14571.57,-5674.42C14571.57,-5665.97 14571.57,-5656.87 14571.57,-5648.06"/>
<polygon fill="black" stroke="black" points="14575.07,-5647.89 14571.57,-5637.89 14568.07,-5647.89 14575.07,-5647.89"/>
</g>
<!-- transpose_back_2_7 -->
<g id="node900" class="node">
<title>transpose_back_2_7</title>
<ellipse fill="lightgray" stroke="black" cx="14566.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14566.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14566.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14566.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_7&#45;&gt;transpose_back_2_7 -->
<g id="edge1093" class="edge">
<title>attn_output_2_7&#45;&gt;transpose_back_2_7</title>
<path fill="none" stroke="black" d="M14569.91,-5450.42C14569.52,-5441.97 14569.11,-5432.87 14568.71,-5424.06"/>
<polygon fill="black" stroke="black" points="14572.2,-5423.72 14568.25,-5413.89 14565.21,-5424.04 14572.2,-5423.72"/>
</g>
<!-- softmax_2_7&#45;&gt;attn_output_2_7 -->
<g id="edge1092" class="edge">
<title>softmax_2_7&#45;&gt;attn_output_2_7</title>
<path fill="none" stroke="black" d="M14571.57,-5562.42C14571.57,-5553.97 14571.57,-5544.87 14571.57,-5536.06"/>
<polygon fill="black" stroke="black" points="14575.07,-5535.89 14571.57,-5525.89 14568.07,-5535.89 14575.07,-5535.89"/>
</g>
<!-- reshape_concat_2_7 -->
<g id="node901" class="node">
<title>reshape_concat_2_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14335.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14335.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14335.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14335.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_7&#45;&gt;reshape_concat_2_7 -->
<g id="edge1094" class="edge">
<title>transpose_back_2_7&#45;&gt;reshape_concat_2_7</title>
<path fill="none" stroke="black" d="M14498.83,-5342.79C14471.32,-5329.69 14439.42,-5314.5 14411.16,-5301.04"/>
<polygon fill="black" stroke="black" points="14412.66,-5297.88 14402.12,-5296.74 14409.65,-5304.2 14412.66,-5297.88"/>
</g>
<!-- reshape_concat_2_7&#45;&gt;allgather_dim_2_1 -->
<g id="edge1095" class="edge">
<title>reshape_concat_2_7&#45;&gt;allgather_dim_2_1</title>
<path fill="none" stroke="black" d="M14260.36,-5232.99C14213.5,-5214.26 14153.15,-5190.14 14104.85,-5170.83"/>
<polygon fill="black" stroke="black" points="14105.94,-5167.5 14095.36,-5167.04 14103.34,-5174 14105.94,-5167.5"/>
</g>
<!-- output_proj_2_1 -->
<g id="node1004" class="node">
<title>output_proj_2_1</title>
<ellipse fill="orange" stroke="black" cx="14526.57" cy="-4923.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14526.57" y="-4942.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14526.57" y="-4927.26" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14526.57" y="-4912.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14526.57" y="-4897.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_1&#45;&gt;output_proj_2_1 -->
<g id="edge1220" class="edge">
<title>head_group_2_1&#45;&gt;output_proj_2_1</title>
<path fill="none" stroke="black" d="M14242.46,-5008.53C14289.36,-4994.65 14355.56,-4975.06 14412.26,-4958.29"/>
<polygon fill="black" stroke="black" points="14413.4,-4961.6 14422,-4955.4 14411.42,-4954.89 14413.4,-4961.6"/>
</g>
<!-- split_q_2_8 -->
<g id="node904" class="node">
<title>split_q_2_8</title>
<ellipse fill="pink" stroke="black" cx="15302.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15302.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15302.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15302.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_q_2_8 -->
<g id="edge1098" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_q_2_8</title>
<path fill="none" stroke="black" d="M15523.34,-6016.4C15483.55,-6002.1 15436.11,-5985.05 15395.42,-5970.42"/>
<polygon fill="black" stroke="black" points="15396.36,-5967.04 15385.77,-5966.95 15394,-5973.63 15396.36,-5967.04"/>
</g>
<!-- split_k_2_8 -->
<g id="node905" class="node">
<title>split_k_2_8</title>
<ellipse fill="pink" stroke="black" cx="15611.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15611.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15611.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15611.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_k_2_8 -->
<g id="edge1099" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_k_2_8</title>
<path fill="none" stroke="black" d="M15609.57,-6010.42C15609.8,-6001.97 15610.05,-5992.87 15610.29,-5984.06"/>
<polygon fill="black" stroke="black" points="15613.79,-5983.98 15610.57,-5973.89 15606.8,-5983.79 15613.79,-5983.98"/>
</g>
<!-- split_v_2_8 -->
<g id="node906" class="node">
<title>split_v_2_8</title>
<ellipse fill="pink" stroke="black" cx="15920.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15920.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15920.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15920.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_8&#45;&gt;split_v_2_8 -->
<g id="edge1100" class="edge">
<title>reshape_qkv_2_8&#45;&gt;split_v_2_8</title>
<path fill="none" stroke="black" d="M15694.65,-6016.7C15735.65,-6002.24 15784.77,-5984.92 15826.72,-5970.13"/>
<polygon fill="black" stroke="black" points="15828.12,-5973.35 15836.39,-5966.73 15825.8,-5966.75 15828.12,-5973.35"/>
</g>
<!-- transpose_q_2_8 -->
<g id="node907" class="node">
<title>transpose_q_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="15302.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15302.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15302.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15302.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_8&#45;&gt;transpose_q_2_8 -->
<g id="edge1101" class="edge">
<title>split_q_2_8&#45;&gt;transpose_q_2_8</title>
<path fill="none" stroke="black" d="M15302.57,-5898.42C15302.57,-5889.97 15302.57,-5880.87 15302.57,-5872.06"/>
<polygon fill="black" stroke="black" points="15306.07,-5871.89 15302.57,-5861.89 15299.07,-5871.89 15306.07,-5871.89"/>
</g>
<!-- transpose_k_2_8 -->
<g id="node908" class="node">
<title>transpose_k_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="15611.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15611.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15611.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15611.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_8&#45;&gt;transpose_k_2_8 -->
<g id="edge1102" class="edge">
<title>split_k_2_8&#45;&gt;transpose_k_2_8</title>
<path fill="none" stroke="black" d="M15611.57,-5898.42C15611.57,-5889.97 15611.57,-5880.87 15611.57,-5872.06"/>
<polygon fill="black" stroke="black" points="15615.07,-5871.89 15611.57,-5861.89 15608.07,-5871.89 15615.07,-5871.89"/>
</g>
<!-- transpose_v_2_8 -->
<g id="node909" class="node">
<title>transpose_v_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="15920.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15920.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15920.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15920.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_8&#45;&gt;transpose_v_2_8 -->
<g id="edge1103" class="edge">
<title>split_v_2_8&#45;&gt;transpose_v_2_8</title>
<path fill="none" stroke="black" d="M15920.57,-5898.42C15920.57,-5889.97 15920.57,-5880.87 15920.57,-5872.06"/>
<polygon fill="black" stroke="black" points="15924.07,-5871.89 15920.57,-5861.89 15917.07,-5871.89 15924.07,-5871.89"/>
</g>
<!-- attn_scores_2_8 -->
<g id="node910" class="node">
<title>attn_scores_2_8</title>
<ellipse fill="gold" stroke="black" cx="15611.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15611.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15611.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15611.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_8&#45;&gt;attn_scores_2_8 -->
<g id="edge1104" class="edge">
<title>transpose_q_2_8&#45;&gt;attn_scores_2_8</title>
<path fill="none" stroke="black" d="M15386.19,-5793.28C15425.91,-5779.14 15473.6,-5762.16 15514.86,-5747.47"/>
<polygon fill="black" stroke="black" points="15516.13,-5750.74 15524.38,-5744.08 15513.79,-5744.14 15516.13,-5750.74"/>
</g>
<!-- transpose_k_2_8&#45;&gt;attn_scores_2_8 -->
<g id="edge1105" class="edge">
<title>transpose_k_2_8&#45;&gt;attn_scores_2_8</title>
<path fill="none" stroke="black" d="M15611.57,-5786.42C15611.57,-5777.97 15611.57,-5768.87 15611.57,-5760.06"/>
<polygon fill="black" stroke="black" points="15615.07,-5759.89 15611.57,-5749.89 15608.07,-5759.89 15615.07,-5759.89"/>
</g>
<!-- attn_output_2_8 -->
<g id="node911" class="node">
<title>attn_output_2_8</title>
<ellipse fill="gold" stroke="black" cx="15920.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15920.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15920.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15920.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_8&#45;&gt;attn_output_2_8 -->
<g id="edge1106" class="edge">
<title>transpose_v_2_8&#45;&gt;attn_output_2_8</title>
<path fill="none" stroke="black" d="M15920.57,-5786.35C15920.57,-5725.3 15920.57,-5602.99 15920.57,-5535.84"/>
<polygon fill="black" stroke="black" points="15924.07,-5535.55 15920.57,-5525.55 15917.07,-5535.55 15924.07,-5535.55"/>
</g>
<!-- softmax_2_8 -->
<g id="node912" class="node">
<title>softmax_2_8</title>
<ellipse fill="gold" stroke="black" cx="15696.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15696.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15696.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15696.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_8&#45;&gt;softmax_2_8 -->
<g id="edge1107" class="edge">
<title>attn_scores_2_8&#45;&gt;softmax_2_8</title>
<path fill="none" stroke="black" d="M15639.41,-5675.03C15646.74,-5665.53 15654.75,-5655.17 15662.38,-5645.3"/>
<polygon fill="black" stroke="black" points="15665.33,-5647.2 15668.68,-5637.14 15659.79,-5642.92 15665.33,-5647.2"/>
</g>
<!-- transpose_back_2_8 -->
<g id="node913" class="node">
<title>transpose_back_2_8</title>
<ellipse fill="lightgray" stroke="black" cx="16026.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16026.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16026.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16026.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_8&#45;&gt;transpose_back_2_8 -->
<g id="edge1109" class="edge">
<title>attn_output_2_8&#45;&gt;transpose_back_2_8</title>
<path fill="none" stroke="black" d="M15954.99,-5451.33C15964.62,-5441.34 15975.19,-5430.37 15985.18,-5420"/>
<polygon fill="black" stroke="black" points="15987.91,-5422.21 15992.33,-5412.58 15982.87,-5417.35 15987.91,-5422.21"/>
</g>
<!-- softmax_2_8&#45;&gt;attn_output_2_8 -->
<g id="edge1108" class="edge">
<title>softmax_2_8&#45;&gt;attn_output_2_8</title>
<path fill="none" stroke="black" d="M15764.39,-5565.74C15789.96,-5553.19 15819.19,-5538.83 15845.4,-5525.96"/>
<polygon fill="black" stroke="black" points="15847.09,-5529.03 15854.53,-5521.48 15844.01,-5522.74 15847.09,-5529.03"/>
</g>
<!-- reshape_concat_2_8 -->
<g id="node914" class="node">
<title>reshape_concat_2_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16202.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16202.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16202.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16202.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_8&#45;&gt;reshape_concat_2_8 -->
<g id="edge1110" class="edge">
<title>transpose_back_2_8&#45;&gt;reshape_concat_2_8</title>
<path fill="none" stroke="black" d="M16080.82,-5341.14C16099.73,-5329.32 16121.1,-5315.97 16140.6,-5303.78"/>
<polygon fill="black" stroke="black" points="16142.49,-5306.72 16149.12,-5298.46 16138.78,-5300.79 16142.49,-5306.72"/>
</g>
<!-- allgather_dim_2_2 -->
<g id="node915" class="node">
<title>allgather_dim_2_2</title>
<polygon fill="red" stroke="black" points="16807.57,-5189.55 16634.57,-5136.55 16807.57,-5083.55 16980.57,-5136.55 16807.57,-5189.55"/>
<text text-anchor="middle" x="16807.57" y="-5147.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="16807.57" y="-5132.85" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16807.57" y="-5117.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_8&#45;&gt;allgather_dim_2_2 -->
<g id="edge1111" class="edge">
<title>reshape_concat_2_8&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M16308.3,-5241.11C16417.05,-5218.55 16585.74,-5183.56 16696.43,-5160.6"/>
<polygon fill="black" stroke="black" points="16697.21,-5164.01 16706.29,-5158.56 16695.78,-5157.16 16697.21,-5164.01"/>
</g>
<!-- head_group_2_2 -->
<g id="node952" class="node">
<title>head_group_2_2</title>
<polygon fill="lightyellow" stroke="black" points="16701.07,-5046.55 16504.07,-5046.55 16504.07,-5008.55 16701.07,-5008.55 16701.07,-5046.55"/>
<text text-anchor="middle" x="16602.57" y="-5031.35" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16602.57" y="-5016.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_2&#45;&gt;head_group_2_2 -->
<g id="edge1157" class="edge">
<title>allgather_dim_2_2&#45;&gt;head_group_2_2</title>
<path fill="none" stroke="black" d="M16744.67,-5102.71C16712.81,-5086.08 16674.92,-5066.31 16646.28,-5051.36"/>
<polygon fill="black" stroke="black" points="16647.81,-5048.21 16637.33,-5046.68 16644.57,-5054.41 16647.81,-5048.21"/>
</g>
<!-- split_q_2_9 -->
<g id="node917" class="node">
<title>split_q_2_9</title>
<ellipse fill="pink" stroke="black" cx="16229.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16229.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16229.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16229.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_q_2_9 -->
<g id="edge1113" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_q_2_9</title>
<path fill="none" stroke="black" d="M16286.07,-6011.03C16278.82,-6001.53 16270.91,-5991.17 16263.37,-5981.3"/>
<polygon fill="black" stroke="black" points="16265.99,-5978.97 16257.14,-5973.14 16260.43,-5983.22 16265.99,-5978.97"/>
</g>
<!-- split_k_2_9 -->
<g id="node918" class="node">
<title>split_k_2_9</title>
<ellipse fill="pink" stroke="black" cx="16538.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16538.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16538.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16538.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_k_2_9 -->
<g id="edge1114" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_k_2_9</title>
<path fill="none" stroke="black" d="M16381.08,-6014.04C16406.9,-6001.42 16436.51,-5986.94 16463.03,-5973.98"/>
<polygon fill="black" stroke="black" points="16464.83,-5976.99 16472.28,-5969.46 16461.75,-5970.71 16464.83,-5976.99"/>
</g>
<!-- split_v_2_9 -->
<g id="node919" class="node">
<title>split_v_2_9</title>
<ellipse fill="pink" stroke="black" cx="16847.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16847.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16847.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16847.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_9&#45;&gt;split_v_2_9 -->
<g id="edge1115" class="edge">
<title>reshape_qkv_2_9&#45;&gt;split_v_2_9</title>
<path fill="none" stroke="black" d="M16436.2,-6024.67C16510.77,-6010.73 16607.85,-5991.99 16693.57,-5973.55 16706.54,-5970.76 16720.1,-5967.72 16733.56,-5964.63"/>
<polygon fill="black" stroke="black" points="16734.37,-5968.03 16743.33,-5962.37 16732.8,-5961.21 16734.37,-5968.03"/>
</g>
<!-- transpose_q_2_9 -->
<g id="node920" class="node">
<title>transpose_q_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="16229.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16229.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16229.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16229.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_9&#45;&gt;transpose_q_2_9 -->
<g id="edge1116" class="edge">
<title>split_q_2_9&#45;&gt;transpose_q_2_9</title>
<path fill="none" stroke="black" d="M16229.57,-5898.42C16229.57,-5889.97 16229.57,-5880.87 16229.57,-5872.06"/>
<polygon fill="black" stroke="black" points="16233.07,-5871.89 16229.57,-5861.89 16226.07,-5871.89 16233.07,-5871.89"/>
</g>
<!-- transpose_k_2_9 -->
<g id="node921" class="node">
<title>transpose_k_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="16538.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16538.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16538.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16538.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_9&#45;&gt;transpose_k_2_9 -->
<g id="edge1117" class="edge">
<title>split_k_2_9&#45;&gt;transpose_k_2_9</title>
<path fill="none" stroke="black" d="M16538.57,-5898.42C16538.57,-5889.97 16538.57,-5880.87 16538.57,-5872.06"/>
<polygon fill="black" stroke="black" points="16542.07,-5871.89 16538.57,-5861.89 16535.07,-5871.89 16542.07,-5871.89"/>
</g>
<!-- transpose_v_2_9 -->
<g id="node922" class="node">
<title>transpose_v_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="16847.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16847.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16847.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16847.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_9&#45;&gt;transpose_v_2_9 -->
<g id="edge1118" class="edge">
<title>split_v_2_9&#45;&gt;transpose_v_2_9</title>
<path fill="none" stroke="black" d="M16847.57,-5898.42C16847.57,-5889.97 16847.57,-5880.87 16847.57,-5872.06"/>
<polygon fill="black" stroke="black" points="16851.07,-5871.89 16847.57,-5861.89 16844.07,-5871.89 16851.07,-5871.89"/>
</g>
<!-- attn_scores_2_9 -->
<g id="node923" class="node">
<title>attn_scores_2_9</title>
<ellipse fill="gold" stroke="black" cx="16538.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16538.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16538.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16538.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_9&#45;&gt;attn_scores_2_9 -->
<g id="edge1119" class="edge">
<title>transpose_q_2_9&#45;&gt;attn_scores_2_9</title>
<path fill="none" stroke="black" d="M16313.19,-5793.28C16352.91,-5779.14 16400.6,-5762.16 16441.86,-5747.47"/>
<polygon fill="black" stroke="black" points="16443.13,-5750.74 16451.38,-5744.08 16440.79,-5744.14 16443.13,-5750.74"/>
</g>
<!-- transpose_k_2_9&#45;&gt;attn_scores_2_9 -->
<g id="edge1120" class="edge">
<title>transpose_k_2_9&#45;&gt;attn_scores_2_9</title>
<path fill="none" stroke="black" d="M16538.57,-5786.42C16538.57,-5777.97 16538.57,-5768.87 16538.57,-5760.06"/>
<polygon fill="black" stroke="black" points="16542.07,-5759.89 16538.57,-5749.89 16535.07,-5759.89 16542.07,-5759.89"/>
</g>
<!-- attn_output_2_9 -->
<g id="node924" class="node">
<title>attn_output_2_9</title>
<ellipse fill="gold" stroke="black" cx="16807.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16807.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16807.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16807.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_9&#45;&gt;attn_output_2_9 -->
<g id="edge1121" class="edge">
<title>transpose_v_2_9&#45;&gt;attn_output_2_9</title>
<path fill="none" stroke="black" d="M16843.18,-5786.35C16835.87,-5725.3 16821.22,-5602.99 16813.18,-5535.84"/>
<polygon fill="black" stroke="black" points="16816.61,-5535.06 16811.95,-5525.55 16809.66,-5535.9 16816.61,-5535.06"/>
</g>
<!-- softmax_2_9 -->
<g id="node925" class="node">
<title>softmax_2_9</title>
<ellipse fill="gold" stroke="black" cx="16609.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16609.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16609.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16609.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_9&#45;&gt;softmax_2_9 -->
<g id="edge1122" class="edge">
<title>attn_scores_2_9&#45;&gt;softmax_2_9</title>
<path fill="none" stroke="black" d="M16562.02,-5674.72C16567.96,-5665.52 16574.4,-5655.53 16580.58,-5645.96"/>
<polygon fill="black" stroke="black" points="16583.67,-5647.63 16586.15,-5637.33 16577.79,-5643.83 16583.67,-5647.63"/>
</g>
<!-- transpose_back_2_9 -->
<g id="node926" class="node">
<title>transpose_back_2_9</title>
<ellipse fill="lightgray" stroke="black" cx="16807.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16807.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16807.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16807.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_9&#45;&gt;transpose_back_2_9 -->
<g id="edge1124" class="edge">
<title>attn_output_2_9&#45;&gt;transpose_back_2_9</title>
<path fill="none" stroke="black" d="M16807.57,-5450.42C16807.57,-5441.97 16807.57,-5432.87 16807.57,-5424.06"/>
<polygon fill="black" stroke="black" points="16811.07,-5423.89 16807.57,-5413.89 16804.07,-5423.89 16811.07,-5423.89"/>
</g>
<!-- softmax_2_9&#45;&gt;attn_output_2_9 -->
<g id="edge1123" class="edge">
<title>softmax_2_9&#45;&gt;attn_output_2_9</title>
<path fill="none" stroke="black" d="M16670.87,-5564.99C16692.33,-5553.07 16716.57,-5539.6 16738.61,-5527.36"/>
<polygon fill="black" stroke="black" points="16740.55,-5530.29 16747.59,-5522.37 16737.15,-5524.17 16740.55,-5530.29"/>
</g>
<!-- reshape_concat_2_9 -->
<g id="node927" class="node">
<title>reshape_concat_2_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16807.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16807.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16807.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16807.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_9&#45;&gt;reshape_concat_2_9 -->
<g id="edge1125" class="edge">
<title>transpose_back_2_9&#45;&gt;reshape_concat_2_9</title>
<path fill="none" stroke="black" d="M16807.57,-5338.42C16807.57,-5329.97 16807.57,-5320.87 16807.57,-5312.06"/>
<polygon fill="black" stroke="black" points="16811.07,-5311.89 16807.57,-5301.89 16804.07,-5311.89 16811.07,-5311.89"/>
</g>
<!-- reshape_concat_2_9&#45;&gt;allgather_dim_2_2 -->
<g id="edge1126" class="edge">
<title>reshape_concat_2_9&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M16807.57,-5226.41C16807.57,-5218.1 16807.57,-5209.05 16807.57,-5200.01"/>
<polygon fill="black" stroke="black" points="16811.07,-5199.85 16807.57,-5189.85 16804.07,-5199.85 16811.07,-5199.85"/>
</g>
<!-- split_q_2_10 -->
<g id="node929" class="node">
<title>split_q_2_10</title>
<ellipse fill="pink" stroke="black" cx="17156.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17156.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17156.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17156.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_q_2_10 -->
<g id="edge1128" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_q_2_10</title>
<path fill="none" stroke="black" d="M17213.07,-6011.03C17205.82,-6001.53 17197.91,-5991.17 17190.37,-5981.3"/>
<polygon fill="black" stroke="black" points="17192.99,-5978.97 17184.14,-5973.14 17187.43,-5983.22 17192.99,-5978.97"/>
</g>
<!-- split_k_2_10 -->
<g id="node930" class="node">
<title>split_k_2_10</title>
<ellipse fill="pink" stroke="black" cx="17465.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17465.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17465.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17465.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_k_2_10 -->
<g id="edge1129" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_k_2_10</title>
<path fill="none" stroke="black" d="M17308.08,-6014.04C17333.9,-6001.42 17363.51,-5986.94 17390.03,-5973.98"/>
<polygon fill="black" stroke="black" points="17391.83,-5976.99 17399.28,-5969.46 17388.75,-5970.71 17391.83,-5976.99"/>
</g>
<!-- split_v_2_10 -->
<g id="node931" class="node">
<title>split_v_2_10</title>
<ellipse fill="pink" stroke="black" cx="17774.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17774.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17774.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17774.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_10&#45;&gt;split_v_2_10 -->
<g id="edge1130" class="edge">
<title>reshape_qkv_2_10&#45;&gt;split_v_2_10</title>
<path fill="none" stroke="black" d="M17363.2,-6024.67C17437.77,-6010.73 17534.85,-5991.99 17620.57,-5973.55 17633.54,-5970.76 17647.1,-5967.72 17660.56,-5964.63"/>
<polygon fill="black" stroke="black" points="17661.37,-5968.03 17670.33,-5962.37 17659.8,-5961.21 17661.37,-5968.03"/>
</g>
<!-- transpose_q_2_10 -->
<g id="node932" class="node">
<title>transpose_q_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="17156.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17156.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17156.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17156.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_10&#45;&gt;transpose_q_2_10 -->
<g id="edge1131" class="edge">
<title>split_q_2_10&#45;&gt;transpose_q_2_10</title>
<path fill="none" stroke="black" d="M17156.57,-5898.42C17156.57,-5889.97 17156.57,-5880.87 17156.57,-5872.06"/>
<polygon fill="black" stroke="black" points="17160.07,-5871.89 17156.57,-5861.89 17153.07,-5871.89 17160.07,-5871.89"/>
</g>
<!-- transpose_k_2_10 -->
<g id="node933" class="node">
<title>transpose_k_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="17465.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17465.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17465.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17465.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_10&#45;&gt;transpose_k_2_10 -->
<g id="edge1132" class="edge">
<title>split_k_2_10&#45;&gt;transpose_k_2_10</title>
<path fill="none" stroke="black" d="M17465.57,-5898.42C17465.57,-5889.97 17465.57,-5880.87 17465.57,-5872.06"/>
<polygon fill="black" stroke="black" points="17469.07,-5871.89 17465.57,-5861.89 17462.07,-5871.89 17469.07,-5871.89"/>
</g>
<!-- transpose_v_2_10 -->
<g id="node934" class="node">
<title>transpose_v_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="17774.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17774.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17774.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17774.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_10&#45;&gt;transpose_v_2_10 -->
<g id="edge1133" class="edge">
<title>split_v_2_10&#45;&gt;transpose_v_2_10</title>
<path fill="none" stroke="black" d="M17774.57,-5898.42C17774.57,-5889.97 17774.57,-5880.87 17774.57,-5872.06"/>
<polygon fill="black" stroke="black" points="17778.07,-5871.89 17774.57,-5861.89 17771.07,-5871.89 17778.07,-5871.89"/>
</g>
<!-- attn_scores_2_10 -->
<g id="node935" class="node">
<title>attn_scores_2_10</title>
<ellipse fill="gold" stroke="black" cx="17329.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17329.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17329.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17329.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_10&#45;&gt;attn_scores_2_10 -->
<g id="edge1134" class="edge">
<title>transpose_q_2_10&#45;&gt;attn_scores_2_10</title>
<path fill="none" stroke="black" d="M17209.89,-5789.14C17227.88,-5777.7 17248.14,-5764.83 17266.79,-5752.96"/>
<polygon fill="black" stroke="black" points="17268.68,-5755.91 17275.24,-5747.59 17264.92,-5750.01 17268.68,-5755.91"/>
</g>
<!-- transpose_k_2_10&#45;&gt;attn_scores_2_10 -->
<g id="edge1135" class="edge">
<title>transpose_k_2_10&#45;&gt;attn_scores_2_10</title>
<path fill="none" stroke="black" d="M17422.17,-5787.94C17409.17,-5777.43 17394.79,-5765.79 17381.31,-5754.89"/>
<polygon fill="black" stroke="black" points="17383.48,-5752.14 17373.5,-5748.57 17379.07,-5757.58 17383.48,-5752.14"/>
</g>
<!-- attn_output_2_10 -->
<g id="node936" class="node">
<title>attn_output_2_10</title>
<ellipse fill="gold" stroke="black" cx="17329.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17329.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17329.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17329.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_10&#45;&gt;attn_output_2_10 -->
<g id="edge1136" class="edge">
<title>transpose_v_2_10&#45;&gt;attn_output_2_10</title>
<path fill="none" stroke="black" d="M17745.29,-5787.1C17699.18,-5732.41 17604.65,-5627.81 17505.57,-5562.55 17481.33,-5546.58 17453.05,-5532.93 17426.35,-5521.88"/>
<polygon fill="black" stroke="black" points="17427.56,-5518.59 17416.98,-5518.08 17424.93,-5525.08 17427.56,-5518.59"/>
</g>
<!-- softmax_2_10 -->
<g id="node937" class="node">
<title>softmax_2_10</title>
<ellipse fill="gold" stroke="black" cx="17329.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17329.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17329.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17329.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_10&#45;&gt;softmax_2_10 -->
<g id="edge1137" class="edge">
<title>attn_scores_2_10&#45;&gt;softmax_2_10</title>
<path fill="none" stroke="black" d="M17329.57,-5674.42C17329.57,-5665.97 17329.57,-5656.87 17329.57,-5648.06"/>
<polygon fill="black" stroke="black" points="17333.07,-5647.89 17329.57,-5637.89 17326.07,-5647.89 17333.07,-5647.89"/>
</g>
<!-- transpose_back_2_10 -->
<g id="node938" class="node">
<title>transpose_back_2_10</title>
<ellipse fill="lightgray" stroke="black" cx="17116.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17116.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17116.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17116.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_10&#45;&gt;transpose_back_2_10 -->
<g id="edge1139" class="edge">
<title>attn_output_2_10&#45;&gt;transpose_back_2_10</title>
<path fill="none" stroke="black" d="M17265.95,-5454.19C17241.83,-5441.73 17214.17,-5427.45 17189.27,-5414.59"/>
<polygon fill="black" stroke="black" points="17190.72,-5411.4 17180.23,-5409.92 17187.51,-5417.62 17190.72,-5411.4"/>
</g>
<!-- softmax_2_10&#45;&gt;attn_output_2_10 -->
<g id="edge1138" class="edge">
<title>softmax_2_10&#45;&gt;attn_output_2_10</title>
<path fill="none" stroke="black" d="M17329.57,-5562.42C17329.57,-5553.97 17329.57,-5544.87 17329.57,-5536.06"/>
<polygon fill="black" stroke="black" points="17333.07,-5535.89 17329.57,-5525.89 17326.07,-5535.89 17333.07,-5535.89"/>
</g>
<!-- reshape_concat_2_10 -->
<g id="node939" class="node">
<title>reshape_concat_2_10</title>
<ellipse fill="lightcyan" stroke="black" cx="17098.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17098.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17098.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17098.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_10&#45;&gt;reshape_concat_2_10 -->
<g id="edge1140" class="edge">
<title>transpose_back_2_10&#45;&gt;reshape_concat_2_10</title>
<path fill="none" stroke="black" d="M17110.58,-5338.42C17109.17,-5329.79 17107.64,-5320.48 17106.17,-5311.48"/>
<polygon fill="black" stroke="black" points="17109.61,-5310.82 17104.54,-5301.51 17102.7,-5311.95 17109.61,-5310.82"/>
</g>
<!-- reshape_concat_2_10&#45;&gt;allgather_dim_2_2 -->
<g id="edge1141" class="edge">
<title>reshape_concat_2_10&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M17027.39,-5232.34C16985.05,-5214.09 16931.24,-5190.88 16887.46,-5172"/>
<polygon fill="black" stroke="black" points="16888.85,-5168.78 16878.28,-5168.04 16886.07,-5175.21 16888.85,-5168.78"/>
</g>
<!-- split_q_2_11 -->
<g id="node941" class="node">
<title>split_q_2_11</title>
<ellipse fill="pink" stroke="black" cx="18083.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18083.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18083.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18083.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_q_2_11 -->
<g id="edge1143" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_q_2_11</title>
<path fill="none" stroke="black" d="M18189.53,-6012.24C18173.9,-6001.15 18156.47,-5988.78 18140.33,-5977.33"/>
<polygon fill="black" stroke="black" points="18142.21,-5974.37 18132.03,-5971.44 18138.16,-5980.08 18142.21,-5974.37"/>
</g>
<!-- split_k_2_11 -->
<g id="node942" class="node">
<title>split_k_2_11</title>
<ellipse fill="pink" stroke="black" cx="18392.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18392.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18392.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18392.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_k_2_11 -->
<g id="edge1144" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_k_2_11</title>
<path fill="none" stroke="black" d="M18287.3,-6012.24C18302.83,-6001.15 18320.15,-5988.78 18336.18,-5977.33"/>
<polygon fill="black" stroke="black" points="18338.32,-5980.1 18344.43,-5971.44 18334.26,-5974.4 18338.32,-5980.1"/>
</g>
<!-- split_v_2_11 -->
<g id="node943" class="node">
<title>split_v_2_11</title>
<ellipse fill="pink" stroke="black" cx="18701.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18701.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18701.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18701.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_11&#45;&gt;split_v_2_11 -->
<g id="edge1145" class="edge">
<title>reshape_qkv_2_11&#45;&gt;split_v_2_11</title>
<path fill="none" stroke="black" d="M18347.71,-6021.12C18419.46,-6004.07 18513.22,-5981.79 18586.2,-5964.46"/>
<polygon fill="black" stroke="black" points="18587.43,-5967.76 18596.35,-5962.04 18585.82,-5960.95 18587.43,-5967.76"/>
</g>
<!-- transpose_q_2_11 -->
<g id="node944" class="node">
<title>transpose_q_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18083.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18083.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18083.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18083.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_11&#45;&gt;transpose_q_2_11 -->
<g id="edge1146" class="edge">
<title>split_q_2_11&#45;&gt;transpose_q_2_11</title>
<path fill="none" stroke="black" d="M18083.57,-5898.42C18083.57,-5889.97 18083.57,-5880.87 18083.57,-5872.06"/>
<polygon fill="black" stroke="black" points="18087.07,-5871.89 18083.57,-5861.89 18080.07,-5871.89 18087.07,-5871.89"/>
</g>
<!-- transpose_k_2_11 -->
<g id="node945" class="node">
<title>transpose_k_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18392.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18392.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18392.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18392.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_11&#45;&gt;transpose_k_2_11 -->
<g id="edge1147" class="edge">
<title>split_k_2_11&#45;&gt;transpose_k_2_11</title>
<path fill="none" stroke="black" d="M18392.57,-5898.42C18392.57,-5889.97 18392.57,-5880.87 18392.57,-5872.06"/>
<polygon fill="black" stroke="black" points="18396.07,-5871.89 18392.57,-5861.89 18389.07,-5871.89 18396.07,-5871.89"/>
</g>
<!-- transpose_v_2_11 -->
<g id="node946" class="node">
<title>transpose_v_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18701.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18701.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18701.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18701.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_11&#45;&gt;transpose_v_2_11 -->
<g id="edge1148" class="edge">
<title>split_v_2_11&#45;&gt;transpose_v_2_11</title>
<path fill="none" stroke="black" d="M18701.57,-5898.42C18701.57,-5889.97 18701.57,-5880.87 18701.57,-5872.06"/>
<polygon fill="black" stroke="black" points="18705.07,-5871.89 18701.57,-5861.89 18698.07,-5871.89 18705.07,-5871.89"/>
</g>
<!-- attn_scores_2_11 -->
<g id="node947" class="node">
<title>attn_scores_2_11</title>
<ellipse fill="gold" stroke="black" cx="18215.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18215.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="18215.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18215.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_11&#45;&gt;attn_scores_2_11 -->
<g id="edge1149" class="edge">
<title>transpose_q_2_11&#45;&gt;attn_scores_2_11</title>
<path fill="none" stroke="black" d="M18125.7,-5787.94C18138.2,-5777.52 18152.01,-5766.01 18164.99,-5755.2"/>
<polygon fill="black" stroke="black" points="18167.5,-5757.66 18172.94,-5748.57 18163.02,-5752.29 18167.5,-5757.66"/>
</g>
<!-- transpose_k_2_11&#45;&gt;attn_scores_2_11 -->
<g id="edge1150" class="edge">
<title>transpose_k_2_11&#45;&gt;attn_scores_2_11</title>
<path fill="none" stroke="black" d="M18338.02,-5789.14C18319.61,-5777.7 18298.89,-5764.83 18279.81,-5752.96"/>
<polygon fill="black" stroke="black" points="18281.51,-5749.9 18271.16,-5747.59 18277.81,-5755.84 18281.51,-5749.9"/>
</g>
<!-- attn_output_2_11 -->
<g id="node948" class="node">
<title>attn_output_2_11</title>
<ellipse fill="gold" stroke="black" cx="18215.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18215.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18215.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18215.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_11&#45;&gt;attn_output_2_11 -->
<g id="edge1151" class="edge">
<title>transpose_v_2_11&#45;&gt;attn_output_2_11</title>
<path fill="none" stroke="black" d="M18666.68,-5787.46C18612.03,-5733.27 18501.13,-5629.3 18391.57,-5562.55 18366.4,-5547.21 18337.46,-5533.65 18310.41,-5522.49"/>
<polygon fill="black" stroke="black" points="18311.52,-5519.16 18300.93,-5518.65 18308.88,-5525.65 18311.52,-5519.16"/>
</g>
<!-- softmax_2_11 -->
<g id="node949" class="node">
<title>softmax_2_11</title>
<ellipse fill="gold" stroke="black" cx="18215.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18215.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="18215.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18215.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_11&#45;&gt;softmax_2_11 -->
<g id="edge1152" class="edge">
<title>attn_scores_2_11&#45;&gt;softmax_2_11</title>
<path fill="none" stroke="black" d="M18215.57,-5674.42C18215.57,-5665.97 18215.57,-5656.87 18215.57,-5648.06"/>
<polygon fill="black" stroke="black" points="18219.07,-5647.89 18215.57,-5637.89 18212.07,-5647.89 18219.07,-5647.89"/>
</g>
<!-- transpose_back_2_11 -->
<g id="node950" class="node">
<title>transpose_back_2_11</title>
<ellipse fill="lightgray" stroke="black" cx="18041.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18041.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="18041.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18041.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_11&#45;&gt;transpose_back_2_11 -->
<g id="edge1154" class="edge">
<title>attn_output_2_11&#45;&gt;transpose_back_2_11</title>
<path fill="none" stroke="black" d="M18161.95,-5453.14C18143.59,-5441.54 18122.9,-5428.46 18103.91,-5416.45"/>
<polygon fill="black" stroke="black" points="18105.64,-5413.41 18095.32,-5411.02 18101.9,-5419.33 18105.64,-5413.41"/>
</g>
<!-- softmax_2_11&#45;&gt;attn_output_2_11 -->
<g id="edge1153" class="edge">
<title>softmax_2_11&#45;&gt;attn_output_2_11</title>
<path fill="none" stroke="black" d="M18215.57,-5562.42C18215.57,-5553.97 18215.57,-5544.87 18215.57,-5536.06"/>
<polygon fill="black" stroke="black" points="18219.07,-5535.89 18215.57,-5525.89 18212.07,-5535.89 18219.07,-5535.89"/>
</g>
<!-- reshape_concat_2_11 -->
<g id="node951" class="node">
<title>reshape_concat_2_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17758.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17758.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17758.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17758.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_11&#45;&gt;reshape_concat_2_11 -->
<g id="edge1155" class="edge">
<title>transpose_back_2_11&#45;&gt;reshape_concat_2_11</title>
<path fill="none" stroke="black" d="M17962.74,-5344.4C17925.95,-5330.1 17882.08,-5313.05 17844.45,-5298.43"/>
<polygon fill="black" stroke="black" points="17845.62,-5295.12 17835.03,-5294.76 17843.08,-5301.65 17845.62,-5295.12"/>
</g>
<!-- reshape_concat_2_11&#45;&gt;allgather_dim_2_2 -->
<g id="edge1156" class="edge">
<title>reshape_concat_2_11&#45;&gt;allgather_dim_2_2</title>
<path fill="none" stroke="black" d="M17639.09,-5247.28C17459.56,-5223.59 17121.6,-5178.99 16936.62,-5154.58"/>
<polygon fill="black" stroke="black" points="16936.94,-5151.09 16926.57,-5153.25 16936.02,-5158.03 16936.94,-5151.09"/>
</g>
<!-- output_proj_2_2 -->
<g id="node1005" class="node">
<title>output_proj_2_2</title>
<ellipse fill="orange" stroke="black" cx="15823.57" cy="-4923.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15823.57" y="-4942.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15823.57" y="-4927.26" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="15823.57" y="-4912.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15823.57" y="-4897.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_2&#45;&gt;output_proj_2_2 -->
<g id="edge1221" class="edge">
<title>head_group_2_2&#45;&gt;output_proj_2_2</title>
<path fill="none" stroke="black" d="M16503.91,-5013.62C16367.1,-4995.69 16119.07,-4963.19 15963.28,-4942.77"/>
<polygon fill="black" stroke="black" points="15963.52,-4939.27 15953.15,-4941.44 15962.61,-4946.21 15963.52,-4939.27"/>
</g>
<!-- split_q_2_12 -->
<g id="node954" class="node">
<title>split_q_2_12</title>
<ellipse fill="pink" stroke="black" cx="19010.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19010.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19010.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19010.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_q_2_12 -->
<g id="edge1159" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_q_2_12</title>
<path fill="none" stroke="black" d="M19067.07,-6011.03C19059.82,-6001.53 19051.91,-5991.17 19044.37,-5981.3"/>
<polygon fill="black" stroke="black" points="19046.99,-5978.97 19038.14,-5973.14 19041.43,-5983.22 19046.99,-5978.97"/>
</g>
<!-- split_k_2_12 -->
<g id="node955" class="node">
<title>split_k_2_12</title>
<ellipse fill="pink" stroke="black" cx="19319.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19319.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19319.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19319.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_k_2_12 -->
<g id="edge1160" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_k_2_12</title>
<path fill="none" stroke="black" d="M19162.08,-6014.04C19187.9,-6001.42 19217.51,-5986.94 19244.03,-5973.98"/>
<polygon fill="black" stroke="black" points="19245.83,-5976.99 19253.28,-5969.46 19242.75,-5970.71 19245.83,-5976.99"/>
</g>
<!-- split_v_2_12 -->
<g id="node956" class="node">
<title>split_v_2_12</title>
<ellipse fill="pink" stroke="black" cx="19628.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19628.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19628.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19628.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_12&#45;&gt;split_v_2_12 -->
<g id="edge1161" class="edge">
<title>reshape_qkv_2_12&#45;&gt;split_v_2_12</title>
<path fill="none" stroke="black" d="M19217.2,-6024.67C19291.77,-6010.73 19388.85,-5991.99 19474.57,-5973.55 19487.54,-5970.76 19501.1,-5967.72 19514.56,-5964.63"/>
<polygon fill="black" stroke="black" points="19515.37,-5968.03 19524.33,-5962.37 19513.8,-5961.21 19515.37,-5968.03"/>
</g>
<!-- transpose_q_2_12 -->
<g id="node957" class="node">
<title>transpose_q_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="19010.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19010.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19010.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19010.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_12&#45;&gt;transpose_q_2_12 -->
<g id="edge1162" class="edge">
<title>split_q_2_12&#45;&gt;transpose_q_2_12</title>
<path fill="none" stroke="black" d="M19010.57,-5898.42C19010.57,-5889.97 19010.57,-5880.87 19010.57,-5872.06"/>
<polygon fill="black" stroke="black" points="19014.07,-5871.89 19010.57,-5861.89 19007.07,-5871.89 19014.07,-5871.89"/>
</g>
<!-- transpose_k_2_12 -->
<g id="node958" class="node">
<title>transpose_k_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="19319.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19319.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19319.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19319.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_12&#45;&gt;transpose_k_2_12 -->
<g id="edge1163" class="edge">
<title>split_k_2_12&#45;&gt;transpose_k_2_12</title>
<path fill="none" stroke="black" d="M19319.57,-5898.42C19319.57,-5889.97 19319.57,-5880.87 19319.57,-5872.06"/>
<polygon fill="black" stroke="black" points="19323.07,-5871.89 19319.57,-5861.89 19316.07,-5871.89 19323.07,-5871.89"/>
</g>
<!-- transpose_v_2_12 -->
<g id="node959" class="node">
<title>transpose_v_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="19628.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19628.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19628.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19628.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_12&#45;&gt;transpose_v_2_12 -->
<g id="edge1164" class="edge">
<title>split_v_2_12&#45;&gt;transpose_v_2_12</title>
<path fill="none" stroke="black" d="M19628.57,-5898.42C19628.57,-5889.97 19628.57,-5880.87 19628.57,-5872.06"/>
<polygon fill="black" stroke="black" points="19632.07,-5871.89 19628.57,-5861.89 19625.07,-5871.89 19632.07,-5871.89"/>
</g>
<!-- attn_scores_2_12 -->
<g id="node960" class="node">
<title>attn_scores_2_12</title>
<ellipse fill="gold" stroke="black" cx="19319.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19319.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19319.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19319.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_12&#45;&gt;attn_scores_2_12 -->
<g id="edge1165" class="edge">
<title>transpose_q_2_12&#45;&gt;attn_scores_2_12</title>
<path fill="none" stroke="black" d="M19094.19,-5793.28C19133.91,-5779.14 19181.6,-5762.16 19222.86,-5747.47"/>
<polygon fill="black" stroke="black" points="19224.13,-5750.74 19232.38,-5744.08 19221.79,-5744.14 19224.13,-5750.74"/>
</g>
<!-- transpose_k_2_12&#45;&gt;attn_scores_2_12 -->
<g id="edge1166" class="edge">
<title>transpose_k_2_12&#45;&gt;attn_scores_2_12</title>
<path fill="none" stroke="black" d="M19319.57,-5786.42C19319.57,-5777.97 19319.57,-5768.87 19319.57,-5760.06"/>
<polygon fill="black" stroke="black" points="19323.07,-5759.89 19319.57,-5749.89 19316.07,-5759.89 19323.07,-5759.89"/>
</g>
<!-- attn_output_2_12 -->
<g id="node961" class="node">
<title>attn_output_2_12</title>
<ellipse fill="gold" stroke="black" cx="19628.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19628.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19628.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19628.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_12&#45;&gt;attn_output_2_12 -->
<g id="edge1167" class="edge">
<title>transpose_v_2_12&#45;&gt;attn_output_2_12</title>
<path fill="none" stroke="black" d="M19628.57,-5786.35C19628.57,-5725.3 19628.57,-5602.99 19628.57,-5535.84"/>
<polygon fill="black" stroke="black" points="19632.07,-5535.55 19628.57,-5525.55 19625.07,-5535.55 19632.07,-5535.55"/>
</g>
<!-- softmax_2_12 -->
<g id="node962" class="node">
<title>softmax_2_12</title>
<ellipse fill="gold" stroke="black" cx="19376.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19376.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19376.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19376.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_12&#45;&gt;softmax_2_12 -->
<g id="edge1168" class="edge">
<title>attn_scores_2_12&#45;&gt;softmax_2_12</title>
<path fill="none" stroke="black" d="M19338.4,-5674.72C19343.11,-5665.62 19348.23,-5655.74 19353.15,-5646.26"/>
<polygon fill="black" stroke="black" points="19356.28,-5647.82 19357.77,-5637.33 19350.06,-5644.6 19356.28,-5647.82"/>
</g>
<!-- transpose_back_2_12 -->
<g id="node963" class="node">
<title>transpose_back_2_12</title>
<ellipse fill="lightgray" stroke="black" cx="19772.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19772.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="19772.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19772.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_12&#45;&gt;transpose_back_2_12 -->
<g id="edge1170" class="edge">
<title>attn_output_2_12&#45;&gt;transpose_back_2_12</title>
<path fill="none" stroke="black" d="M19674.14,-5452.24C19688.32,-5441.41 19704.09,-5429.36 19718.78,-5418.14"/>
<polygon fill="black" stroke="black" points="19720.99,-5420.85 19726.81,-5412 19716.74,-5415.29 19720.99,-5420.85"/>
</g>
<!-- softmax_2_12&#45;&gt;attn_output_2_12 -->
<g id="edge1169" class="edge">
<title>softmax_2_12&#45;&gt;attn_output_2_12</title>
<path fill="none" stroke="black" d="M19451.16,-5566.49C19481.15,-5553.4 19515.83,-5538.26 19546.52,-5524.86"/>
<polygon fill="black" stroke="black" points="19548.15,-5527.97 19555.91,-5520.76 19545.35,-5521.55 19548.15,-5527.97"/>
</g>
<!-- reshape_concat_2_12 -->
<g id="node964" class="node">
<title>reshape_concat_2_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19986.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="19986.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="19986.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19986.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_12&#45;&gt;reshape_concat_2_12 -->
<g id="edge1171" class="edge">
<title>transpose_back_2_12&#45;&gt;reshape_concat_2_12</title>
<path fill="none" stroke="black" d="M19836.49,-5342.19C19861.17,-5329.5 19889.52,-5314.93 19914.89,-5301.89"/>
<polygon fill="black" stroke="black" points="19916.8,-5304.85 19924.09,-5297.16 19913.6,-5298.62 19916.8,-5304.85"/>
</g>
<!-- allgather_dim_2_3 -->
<g id="node965" class="node">
<title>allgather_dim_2_3</title>
<polygon fill="red" stroke="black" points="20437.57,-5189.55 20264.57,-5136.55 20437.57,-5083.55 20610.57,-5136.55 20437.57,-5189.55"/>
<text text-anchor="middle" x="20437.57" y="-5147.85" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="20437.57" y="-5132.85" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="20437.57" y="-5117.85" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_2_12&#45;&gt;allgather_dim_2_3 -->
<g id="edge1172" class="edge">
<title>reshape_concat_2_12&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M20079.47,-5237.19C20155.02,-5216.17 20261.36,-5186.58 20338.52,-5165.11"/>
<polygon fill="black" stroke="black" points="20339.56,-5168.45 20348.25,-5162.4 20337.68,-5161.71 20339.56,-5168.45"/>
</g>
<!-- head_group_2_3 -->
<g id="node1002" class="node">
<title>head_group_2_3</title>
<polygon fill="lightyellow" stroke="black" points="17065.07,-5046.55 16868.07,-5046.55 16868.07,-5008.55 17065.07,-5008.55 17065.07,-5046.55"/>
<text text-anchor="middle" x="16966.57" y="-5031.35" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16966.57" y="-5016.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_2_3&#45;&gt;head_group_2_3 -->
<g id="edge1218" class="edge">
<title>allgather_dim_2_3&#45;&gt;head_group_2_3</title>
<path fill="none" stroke="black" d="M20283.1,-5130.78C19691.79,-5112.56 17579.96,-5047.45 17075.41,-5031.9"/>
<polygon fill="black" stroke="black" points="17075.32,-5028.4 17065.22,-5031.59 17075.11,-5035.39 17075.32,-5028.4"/>
</g>
<!-- split_q_2_13 -->
<g id="node967" class="node">
<title>split_q_2_13</title>
<ellipse fill="pink" stroke="black" cx="19937.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19937.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19937.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19937.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_q_2_13 -->
<g id="edge1174" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_q_2_13</title>
<path fill="none" stroke="black" d="M20043.53,-6012.24C20027.9,-6001.15 20010.47,-5988.78 19994.33,-5977.33"/>
<polygon fill="black" stroke="black" points="19996.21,-5974.37 19986.03,-5971.44 19992.16,-5980.08 19996.21,-5974.37"/>
</g>
<!-- split_k_2_13 -->
<g id="node968" class="node">
<title>split_k_2_13</title>
<ellipse fill="pink" stroke="black" cx="20246.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20246.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20246.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20246.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_k_2_13 -->
<g id="edge1175" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_k_2_13</title>
<path fill="none" stroke="black" d="M20141.3,-6012.24C20156.83,-6001.15 20174.15,-5988.78 20190.18,-5977.33"/>
<polygon fill="black" stroke="black" points="20192.32,-5980.1 20198.43,-5971.44 20188.26,-5974.4 20192.32,-5980.1"/>
</g>
<!-- split_v_2_13 -->
<g id="node969" class="node">
<title>split_v_2_13</title>
<ellipse fill="pink" stroke="black" cx="20555.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20555.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20555.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20555.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_13&#45;&gt;split_v_2_13 -->
<g id="edge1176" class="edge">
<title>reshape_qkv_2_13&#45;&gt;split_v_2_13</title>
<path fill="none" stroke="black" d="M20201.71,-6021.12C20273.46,-6004.07 20367.22,-5981.79 20440.2,-5964.46"/>
<polygon fill="black" stroke="black" points="20441.43,-5967.76 20450.35,-5962.04 20439.82,-5960.95 20441.43,-5967.76"/>
</g>
<!-- transpose_q_2_13 -->
<g id="node970" class="node">
<title>transpose_q_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="19937.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19937.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19937.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19937.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_13&#45;&gt;transpose_q_2_13 -->
<g id="edge1177" class="edge">
<title>split_q_2_13&#45;&gt;transpose_q_2_13</title>
<path fill="none" stroke="black" d="M19937.57,-5898.42C19937.57,-5889.97 19937.57,-5880.87 19937.57,-5872.06"/>
<polygon fill="black" stroke="black" points="19941.07,-5871.89 19937.57,-5861.89 19934.07,-5871.89 19941.07,-5871.89"/>
</g>
<!-- transpose_k_2_13 -->
<g id="node971" class="node">
<title>transpose_k_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="20246.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20246.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20246.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20246.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_13&#45;&gt;transpose_k_2_13 -->
<g id="edge1178" class="edge">
<title>split_k_2_13&#45;&gt;transpose_k_2_13</title>
<path fill="none" stroke="black" d="M20246.57,-5898.42C20246.57,-5889.97 20246.57,-5880.87 20246.57,-5872.06"/>
<polygon fill="black" stroke="black" points="20250.07,-5871.89 20246.57,-5861.89 20243.07,-5871.89 20250.07,-5871.89"/>
</g>
<!-- transpose_v_2_13 -->
<g id="node972" class="node">
<title>transpose_v_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="20555.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20555.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20555.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20555.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_13&#45;&gt;transpose_v_2_13 -->
<g id="edge1179" class="edge">
<title>split_v_2_13&#45;&gt;transpose_v_2_13</title>
<path fill="none" stroke="black" d="M20555.57,-5898.42C20555.57,-5889.97 20555.57,-5880.87 20555.57,-5872.06"/>
<polygon fill="black" stroke="black" points="20559.07,-5871.89 20555.57,-5861.89 20552.07,-5871.89 20559.07,-5871.89"/>
</g>
<!-- attn_scores_2_13 -->
<g id="node973" class="node">
<title>attn_scores_2_13</title>
<ellipse fill="gold" stroke="black" cx="20246.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20246.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20246.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20246.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_13&#45;&gt;attn_scores_2_13 -->
<g id="edge1180" class="edge">
<title>transpose_q_2_13&#45;&gt;attn_scores_2_13</title>
<path fill="none" stroke="black" d="M20021.19,-5793.28C20060.91,-5779.14 20108.6,-5762.16 20149.86,-5747.47"/>
<polygon fill="black" stroke="black" points="20151.13,-5750.74 20159.38,-5744.08 20148.79,-5744.14 20151.13,-5750.74"/>
</g>
<!-- transpose_k_2_13&#45;&gt;attn_scores_2_13 -->
<g id="edge1181" class="edge">
<title>transpose_k_2_13&#45;&gt;attn_scores_2_13</title>
<path fill="none" stroke="black" d="M20246.57,-5786.42C20246.57,-5777.97 20246.57,-5768.87 20246.57,-5760.06"/>
<polygon fill="black" stroke="black" points="20250.07,-5759.89 20246.57,-5749.89 20243.07,-5759.89 20250.07,-5759.89"/>
</g>
<!-- attn_output_2_13 -->
<g id="node974" class="node">
<title>attn_output_2_13</title>
<ellipse fill="gold" stroke="black" cx="20437.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20437.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20437.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20437.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_13&#45;&gt;attn_output_2_13 -->
<g id="edge1182" class="edge">
<title>transpose_v_2_13&#45;&gt;attn_output_2_13</title>
<path fill="none" stroke="black" d="M20542.95,-5786.31C20525.54,-5735.81 20493.09,-5642.14 20464.57,-5562.55 20461.41,-5553.71 20457.99,-5544.3 20454.68,-5535.26"/>
<polygon fill="black" stroke="black" points="20457.88,-5533.82 20451.15,-5525.64 20451.31,-5536.24 20457.88,-5533.82"/>
</g>
<!-- softmax_2_13 -->
<g id="node975" class="node">
<title>softmax_2_13</title>
<ellipse fill="gold" stroke="black" cx="20288.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20288.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20288.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20288.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_13&#45;&gt;softmax_2_13 -->
<g id="edge1183" class="edge">
<title>attn_scores_2_13&#45;&gt;softmax_2_13</title>
<path fill="none" stroke="black" d="M20260.56,-5674.42C20263.92,-5665.6 20267.56,-5656.08 20271.06,-5646.9"/>
<polygon fill="black" stroke="black" points="20274.35,-5648.1 20274.65,-5637.51 20267.81,-5645.61 20274.35,-5648.1"/>
</g>
<!-- transpose_back_2_13 -->
<g id="node976" class="node">
<title>transpose_back_2_13</title>
<ellipse fill="lightgray" stroke="black" cx="20437.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20437.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20437.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20437.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_13&#45;&gt;transpose_back_2_13 -->
<g id="edge1185" class="edge">
<title>attn_output_2_13&#45;&gt;transpose_back_2_13</title>
<path fill="none" stroke="black" d="M20437.57,-5450.42C20437.57,-5441.97 20437.57,-5432.87 20437.57,-5424.06"/>
<polygon fill="black" stroke="black" points="20441.07,-5423.89 20437.57,-5413.89 20434.07,-5423.89 20441.07,-5423.89"/>
</g>
<!-- softmax_2_13&#45;&gt;attn_output_2_13 -->
<g id="edge1184" class="edge">
<title>softmax_2_13&#45;&gt;attn_output_2_13</title>
<path fill="none" stroke="black" d="M20336.13,-5563.94C20350.86,-5553.06 20367.21,-5540.99 20382.42,-5529.77"/>
<polygon fill="black" stroke="black" points="20384.76,-5532.39 20390.73,-5523.63 20380.6,-5526.75 20384.76,-5532.39"/>
</g>
<!-- reshape_concat_2_13 -->
<g id="node977" class="node">
<title>reshape_concat_2_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20437.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20437.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20437.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20437.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_13&#45;&gt;reshape_concat_2_13 -->
<g id="edge1186" class="edge">
<title>transpose_back_2_13&#45;&gt;reshape_concat_2_13</title>
<path fill="none" stroke="black" d="M20437.57,-5338.42C20437.57,-5329.97 20437.57,-5320.87 20437.57,-5312.06"/>
<polygon fill="black" stroke="black" points="20441.07,-5311.89 20437.57,-5301.89 20434.07,-5311.89 20441.07,-5311.89"/>
</g>
<!-- reshape_concat_2_13&#45;&gt;allgather_dim_2_3 -->
<g id="edge1187" class="edge">
<title>reshape_concat_2_13&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M20437.57,-5226.41C20437.57,-5218.1 20437.57,-5209.05 20437.57,-5200.01"/>
<polygon fill="black" stroke="black" points="20441.07,-5199.85 20437.57,-5189.85 20434.07,-5199.85 20441.07,-5199.85"/>
</g>
<!-- split_q_2_14 -->
<g id="node979" class="node">
<title>split_q_2_14</title>
<ellipse fill="pink" stroke="black" cx="20864.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20864.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20864.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20864.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_q_2_14 -->
<g id="edge1189" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_q_2_14</title>
<path fill="none" stroke="black" d="M20917.03,-6011.03C20910.37,-6001.63 20903.1,-5991.38 20896.16,-5981.59"/>
<polygon fill="black" stroke="black" points="20898.81,-5979.28 20890.17,-5973.14 20893.1,-5983.33 20898.81,-5979.28"/>
</g>
<!-- split_k_2_14 -->
<g id="node980" class="node">
<title>split_k_2_14</title>
<ellipse fill="pink" stroke="black" cx="21173.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21173.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21173.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21173.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_k_2_14 -->
<g id="edge1190" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_k_2_14</title>
<path fill="none" stroke="black" d="M21011.26,-6014.34C21038.02,-6001.59 21068.82,-5986.93 21096.35,-5973.82"/>
<polygon fill="black" stroke="black" points="21098.03,-5976.89 21105.55,-5969.44 21095.02,-5970.57 21098.03,-5976.89"/>
</g>
<!-- split_v_2_14 -->
<g id="node981" class="node">
<title>split_v_2_14</title>
<ellipse fill="pink" stroke="black" cx="21482.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21482.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21482.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21482.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_14&#45;&gt;split_v_2_14 -->
<g id="edge1191" class="edge">
<title>reshape_qkv_2_14&#45;&gt;split_v_2_14</title>
<path fill="none" stroke="black" d="M21066.28,-6024.94C21142.15,-6011.02 21241.18,-5992.21 21328.57,-5973.55 21341.55,-5970.77 21355.1,-5967.75 21368.56,-5964.67"/>
<polygon fill="black" stroke="black" points="21369.38,-5968.07 21378.34,-5962.41 21367.81,-5961.25 21369.38,-5968.07"/>
</g>
<!-- transpose_q_2_14 -->
<g id="node982" class="node">
<title>transpose_q_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="20864.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20864.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20864.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20864.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_14&#45;&gt;transpose_q_2_14 -->
<g id="edge1192" class="edge">
<title>split_q_2_14&#45;&gt;transpose_q_2_14</title>
<path fill="none" stroke="black" d="M20864.57,-5898.42C20864.57,-5889.97 20864.57,-5880.87 20864.57,-5872.06"/>
<polygon fill="black" stroke="black" points="20868.07,-5871.89 20864.57,-5861.89 20861.07,-5871.89 20868.07,-5871.89"/>
</g>
<!-- transpose_k_2_14 -->
<g id="node983" class="node">
<title>transpose_k_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="21173.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21173.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21173.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21173.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_14&#45;&gt;transpose_k_2_14 -->
<g id="edge1193" class="edge">
<title>split_k_2_14&#45;&gt;transpose_k_2_14</title>
<path fill="none" stroke="black" d="M21173.57,-5898.42C21173.57,-5889.97 21173.57,-5880.87 21173.57,-5872.06"/>
<polygon fill="black" stroke="black" points="21177.07,-5871.89 21173.57,-5861.89 21170.07,-5871.89 21177.07,-5871.89"/>
</g>
<!-- transpose_v_2_14 -->
<g id="node984" class="node">
<title>transpose_v_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="21482.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21482.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21482.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21482.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_14&#45;&gt;transpose_v_2_14 -->
<g id="edge1194" class="edge">
<title>split_v_2_14&#45;&gt;transpose_v_2_14</title>
<path fill="none" stroke="black" d="M21482.57,-5898.42C21482.57,-5889.97 21482.57,-5880.87 21482.57,-5872.06"/>
<polygon fill="black" stroke="black" points="21486.07,-5871.89 21482.57,-5861.89 21479.07,-5871.89 21486.07,-5871.89"/>
</g>
<!-- attn_scores_2_14 -->
<g id="node985" class="node">
<title>attn_scores_2_14</title>
<ellipse fill="gold" stroke="black" cx="20979.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20979.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20979.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20979.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_14&#45;&gt;attn_scores_2_14 -->
<g id="edge1195" class="edge">
<title>transpose_q_2_14&#45;&gt;attn_scores_2_14</title>
<path fill="none" stroke="black" d="M20901.59,-5787.64C20912.16,-5777.53 20923.78,-5766.41 20934.76,-5755.91"/>
<polygon fill="black" stroke="black" points="20937.42,-5758.21 20942.23,-5748.77 20932.58,-5753.15 20937.42,-5758.21"/>
</g>
<!-- transpose_k_2_14&#45;&gt;attn_scores_2_14 -->
<g id="edge1196" class="edge">
<title>transpose_k_2_14&#45;&gt;attn_scores_2_14</title>
<path fill="none" stroke="black" d="M21114.58,-5789.59C21093.71,-5777.76 21070.05,-5764.35 21048.43,-5752.09"/>
<polygon fill="black" stroke="black" points="21050.05,-5748.99 21039.63,-5747.1 21046.6,-5755.07 21050.05,-5748.99"/>
</g>
<!-- attn_output_2_14 -->
<g id="node986" class="node">
<title>attn_output_2_14</title>
<ellipse fill="gold" stroke="black" cx="20979.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20979.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20979.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20979.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_14&#45;&gt;attn_output_2_14 -->
<g id="edge1197" class="edge">
<title>transpose_v_2_14&#45;&gt;attn_output_2_14</title>
<path fill="none" stroke="black" d="M21445.38,-5787.63C21387.23,-5733.66 21269.59,-5629.98 21155.57,-5562.55 21129.95,-5547.39 21100.62,-5533.81 21073.34,-5522.58"/>
<polygon fill="black" stroke="black" points="21074.37,-5519.22 21063.79,-5518.7 21071.74,-5525.71 21074.37,-5519.22"/>
</g>
<!-- softmax_2_14 -->
<g id="node987" class="node">
<title>softmax_2_14</title>
<ellipse fill="gold" stroke="black" cx="20979.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20979.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20979.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20979.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_14&#45;&gt;softmax_2_14 -->
<g id="edge1198" class="edge">
<title>attn_scores_2_14&#45;&gt;softmax_2_14</title>
<path fill="none" stroke="black" d="M20979.57,-5674.42C20979.57,-5665.97 20979.57,-5656.87 20979.57,-5648.06"/>
<polygon fill="black" stroke="black" points="20983.07,-5647.89 20979.57,-5637.89 20976.07,-5647.89 20983.07,-5647.89"/>
</g>
<!-- transpose_back_2_14 -->
<g id="node988" class="node">
<title>transpose_back_2_14</title>
<ellipse fill="lightgray" stroke="black" cx="20771.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20771.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20771.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20771.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_14&#45;&gt;transpose_back_2_14 -->
<g id="edge1200" class="edge">
<title>attn_output_2_14&#45;&gt;transpose_back_2_14</title>
<path fill="none" stroke="black" d="M20917.17,-5454.04C20893.82,-5441.7 20867.13,-5427.58 20843.03,-5414.84"/>
<polygon fill="black" stroke="black" points="20844.41,-5411.61 20833.94,-5410.03 20841.14,-5417.79 20844.41,-5411.61"/>
</g>
<!-- softmax_2_14&#45;&gt;attn_output_2_14 -->
<g id="edge1199" class="edge">
<title>softmax_2_14&#45;&gt;attn_output_2_14</title>
<path fill="none" stroke="black" d="M20979.57,-5562.42C20979.57,-5553.97 20979.57,-5544.87 20979.57,-5536.06"/>
<polygon fill="black" stroke="black" points="20983.07,-5535.89 20979.57,-5525.89 20976.07,-5535.89 20983.07,-5535.89"/>
</g>
<!-- reshape_concat_2_14 -->
<g id="node989" class="node">
<title>reshape_concat_2_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20733.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20733.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20733.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20733.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_14&#45;&gt;reshape_concat_2_14 -->
<g id="edge1201" class="edge">
<title>transpose_back_2_14&#45;&gt;reshape_concat_2_14</title>
<path fill="none" stroke="black" d="M20758.92,-5338.42C20755.91,-5329.7 20752.65,-5320.28 20749.52,-5311.19"/>
<polygon fill="black" stroke="black" points="20752.75,-5309.82 20746.17,-5301.51 20746.13,-5312.11 20752.75,-5309.82"/>
</g>
<!-- reshape_concat_2_14&#45;&gt;allgather_dim_2_3 -->
<g id="edge1202" class="edge">
<title>reshape_concat_2_14&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M20661.54,-5232.51C20618.25,-5214.15 20563.05,-5190.75 20518.29,-5171.77"/>
<polygon fill="black" stroke="black" points="20519.47,-5168.47 20508.9,-5167.79 20516.74,-5174.91 20519.47,-5168.47"/>
</g>
<!-- split_q_2_15 -->
<g id="node991" class="node">
<title>split_q_2_15</title>
<ellipse fill="pink" stroke="black" cx="21791.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21791.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21791.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21791.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_q_2_15 -->
<g id="edge1204" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_q_2_15</title>
<path fill="none" stroke="black" d="M21896.85,-6012.24C21881.31,-6001.15 21864,-5988.78 21847.97,-5977.33"/>
<polygon fill="black" stroke="black" points="21849.89,-5974.4 21839.72,-5971.44 21845.82,-5980.1 21849.89,-5974.4"/>
</g>
<!-- split_k_2_15 -->
<g id="node992" class="node">
<title>split_k_2_15</title>
<ellipse fill="pink" stroke="black" cx="22100.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22100.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="22100.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22100.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_k_2_15 -->
<g id="edge1205" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_k_2_15</title>
<path fill="none" stroke="black" d="M21994.62,-6012.24C22010.25,-6001.15 22027.68,-5988.78 22043.81,-5977.33"/>
<polygon fill="black" stroke="black" points="22045.99,-5980.08 22052.11,-5971.44 22041.93,-5974.37 22045.99,-5980.08"/>
</g>
<!-- split_v_2_15 -->
<g id="node993" class="node">
<title>split_v_2_15</title>
<ellipse fill="pink" stroke="black" cx="22409.57" cy="-5936.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22409.57" y="-5947.35" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22409.57" y="-5932.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22409.57" y="-5917.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_2_15&#45;&gt;split_v_2_15 -->
<g id="edge1206" class="edge">
<title>reshape_qkv_2_15&#45;&gt;split_v_2_15</title>
<path fill="none" stroke="black" d="M22054.95,-6021.12C22126.85,-6004.07 22220.81,-5981.79 22293.95,-5964.46"/>
<polygon fill="black" stroke="black" points="22295.2,-5967.76 22304.13,-5962.04 22293.59,-5960.94 22295.2,-5967.76"/>
</g>
<!-- transpose_q_2_15 -->
<g id="node994" class="node">
<title>transpose_q_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="21791.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21791.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21791.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21791.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_2_15&#45;&gt;transpose_q_2_15 -->
<g id="edge1207" class="edge">
<title>split_q_2_15&#45;&gt;transpose_q_2_15</title>
<path fill="none" stroke="black" d="M21791.57,-5898.42C21791.57,-5889.97 21791.57,-5880.87 21791.57,-5872.06"/>
<polygon fill="black" stroke="black" points="21795.07,-5871.89 21791.57,-5861.89 21788.07,-5871.89 21795.07,-5871.89"/>
</g>
<!-- transpose_k_2_15 -->
<g id="node995" class="node">
<title>transpose_k_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="22100.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22100.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="22100.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22100.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_2_15&#45;&gt;transpose_k_2_15 -->
<g id="edge1208" class="edge">
<title>split_k_2_15&#45;&gt;transpose_k_2_15</title>
<path fill="none" stroke="black" d="M22100.57,-5898.42C22100.57,-5889.97 22100.57,-5880.87 22100.57,-5872.06"/>
<polygon fill="black" stroke="black" points="22104.07,-5871.89 22100.57,-5861.89 22097.07,-5871.89 22104.07,-5871.89"/>
</g>
<!-- transpose_v_2_15 -->
<g id="node996" class="node">
<title>transpose_v_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="22409.57" cy="-5824.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22409.57" y="-5835.35" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22409.57" y="-5820.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22409.57" y="-5805.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_2_15&#45;&gt;transpose_v_2_15 -->
<g id="edge1209" class="edge">
<title>split_v_2_15&#45;&gt;transpose_v_2_15</title>
<path fill="none" stroke="black" d="M22409.57,-5898.42C22409.57,-5889.97 22409.57,-5880.87 22409.57,-5872.06"/>
<polygon fill="black" stroke="black" points="22413.07,-5871.89 22409.57,-5861.89 22406.07,-5871.89 22413.07,-5871.89"/>
</g>
<!-- attn_scores_2_15 -->
<g id="node997" class="node">
<title>attn_scores_2_15</title>
<ellipse fill="gold" stroke="black" cx="21923.57" cy="-5712.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21923.57" y="-5723.35" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21923.57" y="-5708.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21923.57" y="-5693.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_2_15&#45;&gt;attn_scores_2_15 -->
<g id="edge1210" class="edge">
<title>transpose_q_2_15&#45;&gt;attn_scores_2_15</title>
<path fill="none" stroke="black" d="M21833.7,-5787.94C21846.2,-5777.52 21860.01,-5766.01 21872.99,-5755.2"/>
<polygon fill="black" stroke="black" points="21875.5,-5757.66 21880.94,-5748.57 21871.02,-5752.29 21875.5,-5757.66"/>
</g>
<!-- transpose_k_2_15&#45;&gt;attn_scores_2_15 -->
<g id="edge1211" class="edge">
<title>transpose_k_2_15&#45;&gt;attn_scores_2_15</title>
<path fill="none" stroke="black" d="M22046.02,-5789.14C22027.61,-5777.7 22006.89,-5764.83 21987.81,-5752.96"/>
<polygon fill="black" stroke="black" points="21989.51,-5749.9 21979.16,-5747.59 21985.81,-5755.84 21989.51,-5749.9"/>
</g>
<!-- attn_output_2_15 -->
<g id="node998" class="node">
<title>attn_output_2_15</title>
<ellipse fill="gold" stroke="black" cx="21923.57" cy="-5488.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21923.57" y="-5499.35" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21923.57" y="-5484.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21923.57" y="-5469.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_2_15&#45;&gt;attn_output_2_15 -->
<g id="edge1212" class="edge">
<title>transpose_v_2_15&#45;&gt;attn_output_2_15</title>
<path fill="none" stroke="black" d="M22374.68,-5787.46C22320.03,-5733.27 22209.13,-5629.3 22099.57,-5562.55 22074.4,-5547.21 22045.46,-5533.65 22018.41,-5522.49"/>
<polygon fill="black" stroke="black" points="22019.52,-5519.16 22008.93,-5518.65 22016.88,-5525.65 22019.52,-5519.16"/>
</g>
<!-- softmax_2_15 -->
<g id="node999" class="node">
<title>softmax_2_15</title>
<ellipse fill="gold" stroke="black" cx="21923.57" cy="-5600.05" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21923.57" y="-5611.35" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21923.57" y="-5596.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21923.57" y="-5581.35" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_2_15&#45;&gt;softmax_2_15 -->
<g id="edge1213" class="edge">
<title>attn_scores_2_15&#45;&gt;softmax_2_15</title>
<path fill="none" stroke="black" d="M21923.57,-5674.42C21923.57,-5665.97 21923.57,-5656.87 21923.57,-5648.06"/>
<polygon fill="black" stroke="black" points="21927.07,-5647.89 21923.57,-5637.89 21920.07,-5647.89 21927.07,-5647.89"/>
</g>
<!-- transpose_back_2_15 -->
<g id="node1000" class="node">
<title>transpose_back_2_15</title>
<ellipse fill="lightgray" stroke="black" cx="21092.57" cy="-5376.05" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21092.57" y="-5387.35" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21092.57" y="-5372.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21092.57" y="-5357.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_2_15&#45;&gt;transpose_back_2_15 -->
<g id="edge1215" class="edge">
<title>attn_output_2_15&#45;&gt;transpose_back_2_15</title>
<path fill="none" stroke="black" d="M21795.55,-5470.1C21642.75,-5449.87 21388.19,-5416.18 21230.96,-5395.36"/>
<polygon fill="black" stroke="black" points="21231.11,-5391.85 21220.74,-5394.01 21230.2,-5398.79 21231.11,-5391.85"/>
</g>
<!-- softmax_2_15&#45;&gt;attn_output_2_15 -->
<g id="edge1214" class="edge">
<title>softmax_2_15&#45;&gt;attn_output_2_15</title>
<path fill="none" stroke="black" d="M21923.57,-5562.42C21923.57,-5553.97 21923.57,-5544.87 21923.57,-5536.06"/>
<polygon fill="black" stroke="black" points="21927.07,-5535.89 21923.57,-5525.89 21920.07,-5535.89 21927.07,-5535.89"/>
</g>
<!-- reshape_concat_2_15 -->
<g id="node1001" class="node">
<title>reshape_concat_2_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21036.57" cy="-5264.05" rx="133" ry="37.5"/>
<text text-anchor="middle" x="21036.57" y="-5275.35" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="21036.57" y="-5260.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21036.57" y="-5245.35" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_2_15&#45;&gt;reshape_concat_2_15 -->
<g id="edge1216" class="edge">
<title>transpose_back_2_15&#45;&gt;reshape_concat_2_15</title>
<path fill="none" stroke="black" d="M21074.08,-5338.72C21069.45,-5329.62 21064.42,-5319.74 21059.59,-5310.26"/>
<polygon fill="black" stroke="black" points="21062.7,-5308.65 21055.05,-5301.33 21056.46,-5311.83 21062.7,-5308.65"/>
</g>
<!-- reshape_concat_2_15&#45;&gt;allgather_dim_2_3 -->
<g id="edge1217" class="edge">
<title>reshape_concat_2_15&#45;&gt;allgather_dim_2_3</title>
<path fill="none" stroke="black" d="M20935.31,-5239.72C20915.52,-5235.27 20894.91,-5230.7 20875.57,-5226.55 20765.64,-5202.92 20639.81,-5177.52 20551.31,-5159.93"/>
<polygon fill="black" stroke="black" points="20551.74,-5156.45 20541.25,-5157.93 20550.38,-5163.31 20551.74,-5156.45"/>
</g>
<!-- output_proj_2_3 -->
<g id="node1006" class="node">
<title>output_proj_2_3</title>
<ellipse fill="orange" stroke="black" cx="16620.57" cy="-4923.46" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16620.57" y="-4942.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16620.57" y="-4927.26" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16620.57" y="-4912.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16620.57" y="-4897.26" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_2_3&#45;&gt;output_proj_2_3 -->
<g id="edge1222" class="edge">
<title>head_group_2_3&#45;&gt;output_proj_2_3</title>
<path fill="none" stroke="black" d="M16905.51,-5008.53C16858.38,-4994.62 16791.82,-4974.99 16734.88,-4958.19"/>
<polygon fill="black" stroke="black" points="16735.69,-4954.78 16725.11,-4955.3 16733.71,-4961.49 16735.69,-4954.78"/>
</g>
<!-- allreduce_output_2 -->
<g id="node1007" class="node">
<title>allreduce_output_2</title>
<polygon fill="red" stroke="black" points="15106.57,-4838.38 14963.57,-4785.38 15106.57,-4732.38 15249.57,-4785.38 15106.57,-4838.38"/>
<text text-anchor="middle" x="15106.57" y="-4796.68" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="15106.57" y="-4781.68" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="15106.57" y="-4766.68" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_2_0&#45;&gt;allreduce_output_2 -->
<g id="edge1223" class="edge">
<title>output_proj_2_0&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M12496.26,-4915.64C12966.73,-4892.35 14507.07,-4816.07 14972.31,-4793.03"/>
<polygon fill="black" stroke="black" points="14972.62,-4796.52 14982.43,-4792.53 14972.27,-4789.53 14972.62,-4796.52"/>
</g>
<!-- output_proj_2_1&#45;&gt;allreduce_output_2 -->
<g id="edge1224" class="edge">
<title>output_proj_2_1&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M14661.3,-4910.88C14744.93,-4901.42 14853.93,-4884.98 14947.57,-4857.38 14978.58,-4848.24 15011.42,-4834.35 15039.15,-4821.27"/>
<polygon fill="black" stroke="black" points="15040.84,-4824.35 15048.35,-4816.88 15037.82,-4818.03 15040.84,-4824.35"/>
</g>
<!-- output_proj_2_2&#45;&gt;allreduce_output_2 -->
<g id="edge1225" class="edge">
<title>output_proj_2_2&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M15700.99,-4900.18C15633.06,-4887.75 15547.11,-4871.9 15470.57,-4857.38 15381.91,-4840.56 15281.23,-4820.87 15208.26,-4806.5"/>
<polygon fill="black" stroke="black" points="15208.64,-4803.01 15198.15,-4804.51 15207.28,-4809.88 15208.64,-4803.01"/>
</g>
<!-- output_proj_2_3&#45;&gt;allreduce_output_2 -->
<g id="edge1226" class="edge">
<title>output_proj_2_3&#45;&gt;allreduce_output_2</title>
<path fill="none" stroke="black" d="M16486.22,-4910.39C16195.27,-4884.23 15510.59,-4822.69 15229.9,-4797.46"/>
<polygon fill="black" stroke="black" points="15229.96,-4793.95 15219.68,-4796.55 15229.33,-4800.93 15229.96,-4793.95"/>
</g>
<!-- residual_2 -->
<g id="node1008" class="node">
<title>residual_2</title>
<ellipse fill="none" stroke="black" cx="15106.57" cy="-4677.38" rx="58.5" ry="18"/>
<text text-anchor="middle" x="15106.57" y="-4673.68" font-family="Times,serif" font-size="14.00">residual_2</text>
</g>
<!-- allreduce_output_2&#45;&gt;residual_2 -->
<g id="edge1227" class="edge">
<title>allreduce_output_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M15099.84,-4734.79C15099.76,-4724.83 15100.01,-4714.71 15100.57,-4705.84"/>
<polygon fill="black" stroke="black" points="15104.07,-4706 15101.42,-4695.74 15097.1,-4705.42 15104.07,-4706"/>
</g>
<!-- allreduce_output_2&#45;&gt;residual_2 -->
<g id="edge1228" class="edge">
<title>allreduce_output_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M15113.31,-4734.79C15113.38,-4724.83 15113.14,-4714.71 15112.57,-4705.84"/>
<polygon fill="black" stroke="black" points="15116.05,-4705.42 15111.72,-4695.74 15109.07,-4706 15116.05,-4705.42"/>
</g>
<!-- ln2_2_0 -->
<g id="node1009" class="node">
<title>ln2_2_0</title>
<ellipse fill="lightgreen" stroke="black" cx="12379.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12379.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12379.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12379.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_0 -->
<g id="edge1229" class="edge">
<title>residual_2&#45;&gt;ln2_2_0</title>
<path fill="none" stroke="black" d="M15048.18,-4675.85C14726.91,-4672.85 13171.59,-4656.73 12692.57,-4622.38 12635.68,-4618.3 12573.21,-4611.49 12519.15,-4604.85"/>
<polygon fill="black" stroke="black" points="12519.51,-4601.37 12509.15,-4603.61 12518.65,-4608.31 12519.51,-4601.37"/>
</g>
<!-- ln2_2_1 -->
<g id="node1010" class="node">
<title>ln2_2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12850.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12850.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12850.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12850.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_1 -->
<g id="edge1230" class="edge">
<title>residual_2&#45;&gt;ln2_2_1</title>
<path fill="none" stroke="black" d="M15048.02,-4675.86C14758.85,-4673.13 13481.37,-4659.16 13085.57,-4622.38 13051.24,-4619.19 13014.3,-4614.2 12980.11,-4608.92"/>
<polygon fill="black" stroke="black" points="12980.49,-4605.43 12970.07,-4607.35 12979.41,-4612.35 12980.49,-4605.43"/>
</g>
<!-- ln2_2_2 -->
<g id="node1011" class="node">
<title>ln2_2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="13243.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13243.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13243.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13243.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_2 -->
<g id="edge1231" class="edge">
<title>residual_2&#45;&gt;ln2_2_2</title>
<path fill="none" stroke="black" d="M15047.95,-4675.67C14790.89,-4672.4 13761.89,-4657.34 13440.57,-4622.38 13416.26,-4619.73 13390.44,-4615.79 13365.78,-4611.46"/>
<polygon fill="black" stroke="black" points="13366.12,-4607.96 13355.66,-4609.65 13364.88,-4614.85 13366.12,-4607.96"/>
</g>
<!-- ln2_2_3 -->
<g id="node1012" class="node">
<title>ln2_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13598.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13598.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13598.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13598.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_3 -->
<g id="edge1232" class="edge">
<title>residual_2&#45;&gt;ln2_2_3</title>
<path fill="none" stroke="black" d="M15048.1,-4675.27C14825.02,-4670.86 14027.36,-4653.24 13775.57,-4622.38 13756.26,-4620.01 13735.91,-4616.65 13716.17,-4612.91"/>
<polygon fill="black" stroke="black" points="13716.71,-4609.45 13706.22,-4610.99 13715.38,-4616.32 13716.71,-4609.45"/>
</g>
<!-- ln2_2_4 -->
<g id="node1013" class="node">
<title>ln2_2_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13933.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13933.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13933.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13933.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_4 -->
<g id="edge1233" class="edge">
<title>residual_2&#45;&gt;ln2_2_4</title>
<path fill="none" stroke="black" d="M15047.93,-4676.5C14892.73,-4676.12 14458.73,-4670.46 14101.57,-4622.38 14084.51,-4620.08 14066.61,-4616.97 14049.11,-4613.52"/>
<polygon fill="black" stroke="black" points="14049.36,-4610 14038.87,-4611.46 14047.98,-4616.86 14049.36,-4610"/>
</g>
<!-- ln2_2_5 -->
<g id="node1014" class="node">
<title>ln2_2_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14259.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14259.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14259.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14259.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_5 -->
<g id="edge1234" class="edge">
<title>residual_2&#45;&gt;ln2_2_5</title>
<path fill="none" stroke="black" d="M15048.61,-4674.57C14930.32,-4670.27 14652.85,-4657.07 14422.57,-4622.38 14406.9,-4620.02 14390.49,-4617 14374.37,-4613.72"/>
<polygon fill="black" stroke="black" points="14374.88,-4610.25 14364.38,-4611.64 14373.46,-4617.1 14374.88,-4610.25"/>
</g>
<!-- ln2_2_6 -->
<g id="node1015" class="node">
<title>ln2_2_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14580.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14580.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14580.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14580.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_6 -->
<g id="edge1235" class="edge">
<title>residual_2&#45;&gt;ln2_2_6</title>
<path fill="none" stroke="black" d="M15053.32,-4669.84C14981.89,-4660.77 14851.21,-4643.13 14740.57,-4622.38 14726.35,-4619.71 14711.48,-4616.67 14696.77,-4613.5"/>
<polygon fill="black" stroke="black" points="14697.14,-4610 14686.62,-4611.29 14695.65,-4616.84 14697.14,-4610"/>
</g>
<!-- ln2_2_7 -->
<g id="node1016" class="node">
<title>ln2_2_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14898.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14898.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14898.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14898.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_7 -->
<g id="edge1236" class="edge">
<title>residual_2&#45;&gt;ln2_2_7</title>
<path fill="none" stroke="black" d="M15074.07,-4662.24C15049.22,-4651.42 15013.81,-4636.02 14981.29,-4621.87"/>
<polygon fill="black" stroke="black" points="14982.33,-4618.5 14971.76,-4617.72 14979.53,-4624.92 14982.33,-4618.5"/>
</g>
<!-- ln2_2_8 -->
<g id="node1017" class="node">
<title>ln2_2_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15231.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15231.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15231.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15231.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_8 -->
<g id="edge1237" class="edge">
<title>residual_2&#45;&gt;ln2_2_8</title>
<path fill="none" stroke="black" d="M15128.35,-4660.61C15141.45,-4651.13 15158.79,-4638.58 15175.5,-4626.47"/>
<polygon fill="black" stroke="black" points="15177.59,-4629.28 15183.64,-4620.59 15173.48,-4623.61 15177.59,-4629.28"/>
</g>
<!-- ln2_2_9 -->
<g id="node1018" class="node">
<title>ln2_2_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15575.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15575.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15575.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15575.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_9 -->
<g id="edge1238" class="edge">
<title>residual_2&#45;&gt;ln2_2_9</title>
<path fill="none" stroke="black" d="M15154.91,-4667.24C15211.26,-4656.56 15307.2,-4638.32 15389.57,-4622.38 15409.15,-4618.59 15429.87,-4614.55 15450.11,-4610.59"/>
<polygon fill="black" stroke="black" points="15450.86,-4614.01 15460,-4608.66 15449.51,-4607.14 15450.86,-4614.01"/>
</g>
<!-- ln2_2_10 -->
<g id="node1019" class="node">
<title>ln2_2_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15955.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15955.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15955.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15955.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_10 -->
<g id="edge1239" class="edge">
<title>residual_2&#45;&gt;ln2_2_10</title>
<path fill="none" stroke="black" d="M15163.36,-4672.96C15273.57,-4666 15524.07,-4648.58 15733.57,-4622.38 15763.43,-4618.64 15795.43,-4613.85 15825.56,-4608.98"/>
<polygon fill="black" stroke="black" points="15826.4,-4612.39 15835.71,-4607.32 15825.27,-4605.48 15826.4,-4612.39"/>
</g>
<!-- ln2_2_11 -->
<g id="node1020" class="node">
<title>ln2_2_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16303.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16303.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16303.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16303.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_11 -->
<g id="edge1240" class="edge">
<title>residual_2&#45;&gt;ln2_2_11</title>
<path fill="none" stroke="black" d="M15164.99,-4676.02C15320.1,-4674.48 15754.93,-4666.24 16113.57,-4622.38 16135.86,-4619.65 16159.47,-4615.86 16182.19,-4611.75"/>
<polygon fill="black" stroke="black" points="16183,-4615.16 16192.2,-4609.9 16181.74,-4608.27 16183,-4615.16"/>
</g>
<!-- ln2_2_12 -->
<g id="node1021" class="node">
<title>ln2_2_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16635.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16635.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16635.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16635.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_12 -->
<g id="edge1241" class="edge">
<title>residual_2&#45;&gt;ln2_2_12</title>
<path fill="none" stroke="black" d="M15164.94,-4675.35C15390.44,-4671.18 16204.86,-4654.19 16461.57,-4622.38 16480.22,-4620.07 16499.85,-4616.79 16518.92,-4613.14"/>
<polygon fill="black" stroke="black" points="16519.7,-4616.55 16528.84,-4611.2 16518.35,-4609.68 16519.7,-4616.55"/>
</g>
<!-- ln2_2_13 -->
<g id="node1022" class="node">
<title>ln2_2_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16972.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16972.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16972.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16972.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_13 -->
<g id="edge1242" class="edge">
<title>residual_2&#45;&gt;ln2_2_13</title>
<path fill="none" stroke="black" d="M15165.08,-4675.86C15423.99,-4673.35 16468.21,-4660.97 16793.57,-4622.38 16813.47,-4620.02 16834.44,-4616.6 16854.75,-4612.79"/>
<polygon fill="black" stroke="black" points="16855.5,-4616.21 16864.66,-4610.89 16854.18,-4609.34 16855.5,-4616.21"/>
</g>
<!-- ln2_2_14 -->
<g id="node1023" class="node">
<title>ln2_2_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17299.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17299.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17299.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17299.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_14 -->
<g id="edge1243" class="edge">
<title>residual_2&#45;&gt;ln2_2_14</title>
<path fill="none" stroke="black" d="M15164.96,-4675.18C15362.07,-4671.09 16021.05,-4657.07 16565.57,-4641.38 16816.72,-4634.14 16881.22,-4653.25 17130.57,-4622.38 17148.17,-4620.2 17166.64,-4617.09 17184.65,-4613.58"/>
<polygon fill="black" stroke="black" points="17185.47,-4616.98 17194.59,-4611.6 17184.1,-4610.12 17185.47,-4616.98"/>
</g>
<!-- ln2_2_15 -->
<g id="node1024" class="node">
<title>ln2_2_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17803.57" cy="-4584.88" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17803.57" y="-4596.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17803.57" y="-4581.18" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17803.57" y="-4566.18" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_2&#45;&gt;ln2_2_15 -->
<g id="edge1244" class="edge">
<title>residual_2&#45;&gt;ln2_2_15</title>
<path fill="none" stroke="black" d="M15164.98,-4675.72C15481.25,-4672.03 16991.63,-4653.07 17457.57,-4622.38 17524.52,-4617.97 17598.5,-4610.52 17660.81,-4603.49"/>
<polygon fill="black" stroke="black" points="17661.57,-4606.93 17671.11,-4602.32 17660.78,-4599.97 17661.57,-4606.93"/>
</g>
<!-- router_2_0 -->
<g id="node1025" class="node">
<title>router_2_0</title>
<ellipse fill="purple" stroke="black" cx="12183.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12183.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12183.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12183.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_0&#45;&gt;router_2_0 -->
<g id="edge1245" class="edge">
<title>ln2_2_0&#45;&gt;router_2_0</title>
<path fill="none" stroke="black" d="M12319.97,-4550.43C12298.59,-4538.43 12274.31,-4524.8 12252.22,-4512.41"/>
<polygon fill="black" stroke="black" points="12253.67,-4509.2 12243.23,-4507.36 12250.24,-4515.31 12253.67,-4509.2"/>
</g>
<!-- router_2_1 -->
<g id="node1026" class="node">
<title>router_2_1</title>
<ellipse fill="purple" stroke="black" cx="12767.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12767.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12767.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12767.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_1&#45;&gt;router_2_1 -->
<g id="edge1246" class="edge">
<title>ln2_2_1&#45;&gt;router_2_1</title>
<path fill="none" stroke="black" d="M12823.4,-4547.86C12816.23,-4538.36 12808.42,-4528.01 12800.96,-4518.13"/>
<polygon fill="black" stroke="black" points="12803.63,-4515.85 12794.81,-4509.98 12798.04,-4520.07 12803.63,-4515.85"/>
</g>
<!-- router_2_2 -->
<g id="node1027" class="node">
<title>router_2_2</title>
<ellipse fill="purple" stroke="black" cx="13098.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13098.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13098.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13098.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_2&#45;&gt;router_2_2 -->
<g id="edge1247" class="edge">
<title>ln2_2_2&#45;&gt;router_2_2</title>
<path fill="none" stroke="black" d="M13197.69,-4549.07C13183.41,-4538.24 13167.53,-4526.19 13152.74,-4514.97"/>
<polygon fill="black" stroke="black" points="13154.73,-4512.09 13144.65,-4508.83 13150.5,-4517.67 13154.73,-4512.09"/>
</g>
<!-- router_2_3 -->
<g id="node1028" class="node">
<title>router_2_3</title>
<ellipse fill="purple" stroke="black" cx="13481.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13481.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13481.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13481.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_3&#45;&gt;router_2_3 -->
<g id="edge1248" class="edge">
<title>ln2_2_3&#45;&gt;router_2_3</title>
<path fill="none" stroke="black" d="M13560.91,-4548.47C13549.95,-4538.16 13537.87,-4526.81 13526.51,-4516.13"/>
<polygon fill="black" stroke="black" points="13528.85,-4513.52 13519.17,-4509.22 13524.05,-4518.62 13528.85,-4513.52"/>
</g>
<!-- router_2_4 -->
<g id="node1029" class="node">
<title>router_2_4</title>
<ellipse fill="purple" stroke="black" cx="13853.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13853.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13853.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13853.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_4&#45;&gt;router_2_4 -->
<g id="edge1249" class="edge">
<title>ln2_2_4&#45;&gt;router_2_4</title>
<path fill="none" stroke="black" d="M13907.38,-4547.86C13900.47,-4538.36 13892.94,-4528.01 13885.76,-4518.13"/>
<polygon fill="black" stroke="black" points="13888.54,-4516.01 13879.83,-4509.98 13882.88,-4520.12 13888.54,-4516.01"/>
</g>
<!-- router_2_5 -->
<g id="node1030" class="node">
<title>router_2_5</title>
<ellipse fill="purple" stroke="black" cx="14211.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14211.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14211.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14211.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_5&#45;&gt;router_2_5 -->
<g id="edge1250" class="edge">
<title>ln2_2_5&#45;&gt;router_2_5</title>
<path fill="none" stroke="black" d="M14243.72,-4547.56C14239.79,-4538.54 14235.53,-4528.77 14231.43,-4519.38"/>
<polygon fill="black" stroke="black" points="14234.61,-4517.93 14227.41,-4510.16 14228.2,-4520.73 14234.61,-4517.93"/>
</g>
<!-- router_2_6 -->
<g id="node1031" class="node">
<title>router_2_6</title>
<ellipse fill="purple" stroke="black" cx="14552.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14552.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14552.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14552.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_6&#45;&gt;router_2_6 -->
<g id="edge1251" class="edge">
<title>ln2_2_6&#45;&gt;router_2_6</title>
<path fill="none" stroke="black" d="M14571.25,-4547.25C14569.05,-4538.62 14566.68,-4529.31 14564.39,-4520.32"/>
<polygon fill="black" stroke="black" points="14567.72,-4519.17 14561.86,-4510.35 14560.93,-4520.9 14567.72,-4519.17"/>
</g>
<!-- router_2_7 -->
<g id="node1032" class="node">
<title>router_2_7</title>
<ellipse fill="purple" stroke="black" cx="14892.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14892.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14892.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14892.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_7&#45;&gt;router_2_7 -->
<g id="edge1252" class="edge">
<title>ln2_2_7&#45;&gt;router_2_7</title>
<path fill="none" stroke="black" d="M14896.58,-4547.25C14896.11,-4538.81 14895.62,-4529.71 14895.14,-4520.89"/>
<polygon fill="black" stroke="black" points="14898.62,-4520.52 14894.58,-4510.72 14891.63,-4520.9 14898.62,-4520.52"/>
</g>
<!-- router_2_8 -->
<g id="node1033" class="node">
<title>router_2_8</title>
<ellipse fill="purple" stroke="black" cx="15236.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15236.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15236.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15236.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_8&#45;&gt;router_2_8 -->
<g id="edge1253" class="edge">
<title>ln2_2_8&#45;&gt;router_2_8</title>
<path fill="none" stroke="black" d="M15233.24,-4547.25C15233.62,-4538.81 15234.04,-4529.71 15234.44,-4520.89"/>
<polygon fill="black" stroke="black" points="15237.94,-4520.87 15234.9,-4510.72 15230.95,-4520.55 15237.94,-4520.87"/>
</g>
<!-- router_2_9 -->
<g id="node1034" class="node">
<title>router_2_9</title>
<ellipse fill="purple" stroke="black" cx="15654.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15654.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15654.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15654.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_9&#45;&gt;router_2_9 -->
<g id="edge1254" class="edge">
<title>ln2_2_9&#45;&gt;router_2_9</title>
<path fill="none" stroke="black" d="M15601.44,-4547.86C15608.26,-4538.36 15615.7,-4528.01 15622.79,-4518.13"/>
<polygon fill="black" stroke="black" points="15625.66,-4520.14 15628.65,-4509.98 15619.97,-4516.06 15625.66,-4520.14"/>
</g>
<!-- router_2_10 -->
<g id="node1035" class="node">
<title>router_2_10</title>
<ellipse fill="purple" stroke="black" cx="16003.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16003.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16003.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16003.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_10&#45;&gt;router_2_10 -->
<g id="edge1255" class="edge">
<title>ln2_2_10&#45;&gt;router_2_10</title>
<path fill="none" stroke="black" d="M15971.42,-4547.56C15975.36,-4538.54 15979.62,-4528.77 15983.72,-4519.38"/>
<polygon fill="black" stroke="black" points="15986.95,-4520.73 15987.74,-4510.16 15980.53,-4517.93 15986.95,-4520.73"/>
</g>
<!-- router_2_11 -->
<g id="node1036" class="node">
<title>router_2_11</title>
<ellipse fill="purple" stroke="black" cx="16456.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16456.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16456.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16456.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_11&#45;&gt;router_2_11 -->
<g id="edge1256" class="edge">
<title>ln2_2_11&#45;&gt;router_2_11</title>
<path fill="none" stroke="black" d="M16351.98,-4549.07C16367.34,-4538.03 16384.45,-4525.73 16400.31,-4514.33"/>
<polygon fill="black" stroke="black" points="16402.4,-4517.14 16408.48,-4508.46 16398.32,-4511.45 16402.4,-4517.14"/>
</g>
<!-- router_2_12 -->
<g id="node1037" class="node">
<title>router_2_12</title>
<ellipse fill="purple" stroke="black" cx="16810.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16810.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16810.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16810.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_12&#45;&gt;router_2_12 -->
<g id="edge1257" class="edge">
<title>ln2_2_12&#45;&gt;router_2_12</title>
<path fill="none" stroke="black" d="M16689.99,-4549.68C16708.34,-4538.14 16728.98,-4525.16 16747.93,-4513.26"/>
<polygon fill="black" stroke="black" points="16749.89,-4516.16 16756.5,-4507.87 16746.17,-4510.23 16749.89,-4516.16"/>
</g>
<!-- router_2_13 -->
<g id="node1038" class="node">
<title>router_2_13</title>
<ellipse fill="purple" stroke="black" cx="17185.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17185.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17185.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17185.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_13&#45;&gt;router_2_13 -->
<g id="edge1258" class="edge">
<title>ln2_2_13&#45;&gt;router_2_13</title>
<path fill="none" stroke="black" d="M17036.48,-4550.88C17060.49,-4538.48 17087.96,-4524.29 17112.72,-4511.5"/>
<polygon fill="black" stroke="black" points="17114.43,-4514.56 17121.71,-4506.86 17111.22,-4508.34 17114.43,-4514.56"/>
</g>
<!-- router_2_14 -->
<g id="node1039" class="node">
<title>router_2_14</title>
<ellipse fill="purple" stroke="black" cx="17581.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17581.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17581.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17581.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_14&#45;&gt;router_2_14 -->
<g id="edge1259" class="edge">
<title>ln2_2_14&#45;&gt;router_2_14</title>
<path fill="none" stroke="black" d="M17378.88,-4552.94C17414.32,-4539.12 17456.24,-4522.77 17492.73,-4508.53"/>
<polygon fill="black" stroke="black" points="17494.33,-4511.67 17502.38,-4504.77 17491.79,-4505.14 17494.33,-4511.67"/>
</g>
<!-- router_2_15 -->
<g id="node1040" class="node">
<title>router_2_15</title>
<ellipse fill="purple" stroke="black" cx="17982.57" cy="-4472.88" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17982.57" y="-4484.18" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17982.57" y="-4469.18" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17982.57" y="-4454.18" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_2_15&#45;&gt;router_2_15 -->
<g id="edge1260" class="edge">
<title>ln2_2_15&#45;&gt;router_2_15</title>
<path fill="none" stroke="black" d="M17858.74,-4549.98C17877.71,-4538.32 17899.11,-4525.17 17918.71,-4513.12"/>
<polygon fill="black" stroke="black" points="17920.59,-4516.08 17927.28,-4507.86 17916.93,-4510.11 17920.59,-4516.08"/>
</g>
<!-- dispatch_2_0 -->
<g id="node1041" class="node">
<title>dispatch_2_0</title>
<polygon fill="purple" stroke="black" points="12123.57,-4398.38 11935.57,-4345.38 12123.57,-4292.38 12311.57,-4345.38 12123.57,-4398.38"/>
<text text-anchor="middle" x="12123.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12123.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="12123.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_0&#45;&gt;dispatch_2_0 -->
<g id="edge1261" class="edge">
<title>router_2_0&#45;&gt;dispatch_2_0</title>
<path fill="none" stroke="black" d="M12166.22,-4435.58C12161.14,-4424.95 12155.47,-4413.09 12149.96,-4401.57"/>
<polygon fill="black" stroke="black" points="12153.07,-4399.95 12145.59,-4392.44 12146.75,-4402.97 12153.07,-4399.95"/>
</g>
<!-- dispatch_2_1 -->
<g id="node1042" class="node">
<title>dispatch_2_1</title>
<polygon fill="purple" stroke="black" points="12517.57,-4398.38 12329.57,-4345.38 12517.57,-4292.38 12705.57,-4345.38 12517.57,-4398.38"/>
<text text-anchor="middle" x="12517.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12517.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12517.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_1&#45;&gt;dispatch_2_1 -->
<g id="edge1262" class="edge">
<title>router_2_1&#45;&gt;dispatch_2_1</title>
<path fill="none" stroke="black" d="M12702.22,-4439.07C12668.88,-4422.34 12628.16,-4401.89 12593.44,-4384.47"/>
<polygon fill="black" stroke="black" points="12594.8,-4381.23 12584.29,-4379.87 12591.66,-4387.48 12594.8,-4381.23"/>
</g>
<!-- dispatch_2_2 -->
<g id="node1043" class="node">
<title>dispatch_2_2</title>
<polygon fill="purple" stroke="black" points="12911.57,-4398.38 12723.57,-4345.38 12911.57,-4292.38 13099.57,-4345.38 12911.57,-4398.38"/>
<text text-anchor="middle" x="12911.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12911.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12911.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_2&#45;&gt;dispatch_2_2 -->
<g id="edge1263" class="edge">
<title>router_2_2&#45;&gt;dispatch_2_2</title>
<path fill="none" stroke="black" d="M13047.47,-4437.59C13025.03,-4422.53 12998.46,-4404.69 12974.79,-4388.8"/>
<polygon fill="black" stroke="black" points="12976.47,-4385.71 12966.21,-4383.05 12972.56,-4391.53 12976.47,-4385.71"/>
</g>
<!-- dispatch_2_3 -->
<g id="node1044" class="node">
<title>dispatch_2_3</title>
<polygon fill="purple" stroke="black" points="13305.57,-4398.38 13117.57,-4345.38 13305.57,-4292.38 13493.57,-4345.38 13305.57,-4398.38"/>
<text text-anchor="middle" x="13305.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13305.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13305.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_3&#45;&gt;dispatch_2_3 -->
<g id="edge1264" class="edge">
<title>router_2_3&#45;&gt;dispatch_2_3</title>
<path fill="none" stroke="black" d="M13433.01,-4437.25C13412.35,-4422.52 13388.04,-4405.18 13366.21,-4389.62"/>
<polygon fill="black" stroke="black" points="13368.16,-4386.71 13357.98,-4383.75 13364.09,-4392.41 13368.16,-4386.71"/>
</g>
<!-- dispatch_2_4 -->
<g id="node1045" class="node">
<title>dispatch_2_4</title>
<polygon fill="purple" stroke="black" points="13699.57,-4398.38 13511.57,-4345.38 13699.57,-4292.38 13887.57,-4345.38 13699.57,-4398.38"/>
<text text-anchor="middle" x="13699.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13699.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13699.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_4&#45;&gt;dispatch_2_4 -->
<g id="edge1265" class="edge">
<title>router_2_4&#45;&gt;dispatch_2_4</title>
<path fill="none" stroke="black" d="M13810.68,-4436.92C13793.54,-4422.96 13773.59,-4406.69 13755.35,-4391.83"/>
<polygon fill="black" stroke="black" points="13757.07,-4388.72 13747.11,-4385.12 13752.65,-4394.15 13757.07,-4388.72"/>
</g>
<!-- dispatch_2_5 -->
<g id="node1046" class="node">
<title>dispatch_2_5</title>
<polygon fill="purple" stroke="black" points="14093.57,-4398.38 13905.57,-4345.38 14093.57,-4292.38 14281.57,-4345.38 14093.57,-4398.38"/>
<text text-anchor="middle" x="14093.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14093.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14093.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_5&#45;&gt;dispatch_2_5 -->
<g id="edge1266" class="edge">
<title>router_2_5&#45;&gt;dispatch_2_5</title>
<path fill="none" stroke="black" d="M14178.08,-4436.25C14166.12,-4423.53 14152.43,-4408.97 14139.6,-4395.33"/>
<polygon fill="black" stroke="black" points="14141.98,-4392.75 14132.58,-4387.86 14136.88,-4397.55 14141.98,-4392.75"/>
</g>
<!-- dispatch_2_6 -->
<g id="node1047" class="node">
<title>dispatch_2_6</title>
<polygon fill="purple" stroke="black" points="14487.57,-4398.38 14299.57,-4345.38 14487.57,-4292.38 14675.57,-4345.38 14487.57,-4398.38"/>
<text text-anchor="middle" x="14487.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14487.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14487.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_6&#45;&gt;dispatch_2_6 -->
<g id="edge1267" class="edge">
<title>router_2_6&#45;&gt;dispatch_2_6</title>
<path fill="none" stroke="black" d="M14533.77,-4435.58C14528.21,-4424.84 14521.99,-4412.84 14515.97,-4401.2"/>
<polygon fill="black" stroke="black" points="14518.9,-4399.25 14511.19,-4391.98 14512.68,-4402.47 14518.9,-4399.25"/>
</g>
<!-- dispatch_2_7 -->
<g id="node1048" class="node">
<title>dispatch_2_7</title>
<polygon fill="purple" stroke="black" points="14881.57,-4398.38 14693.57,-4345.38 14881.57,-4292.38 15069.57,-4345.38 14881.57,-4398.38"/>
<text text-anchor="middle" x="14881.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14881.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14881.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_7&#45;&gt;dispatch_2_7 -->
<g id="edge1268" class="edge">
<title>router_2_7&#45;&gt;dispatch_2_7</title>
<path fill="none" stroke="black" d="M14889.36,-4435.24C14888.6,-4426.53 14887.76,-4417 14886.93,-4407.51"/>
<polygon fill="black" stroke="black" points="14890.4,-4406.94 14886.04,-4397.29 14883.42,-4407.55 14890.4,-4406.94"/>
</g>
<!-- dispatch_2_8 -->
<g id="node1049" class="node">
<title>dispatch_2_8</title>
<polygon fill="purple" stroke="black" points="15275.57,-4398.38 15087.57,-4345.38 15275.57,-4292.38 15463.57,-4345.38 15275.57,-4398.38"/>
<text text-anchor="middle" x="15275.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15275.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15275.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_8&#45;&gt;dispatch_2_8 -->
<g id="edge1269" class="edge">
<title>router_2_8&#45;&gt;dispatch_2_8</title>
<path fill="none" stroke="black" d="M15247.96,-4435.24C15250.99,-4425.49 15254.34,-4414.72 15257.62,-4404.14"/>
<polygon fill="black" stroke="black" points="15260.99,-4405.1 15260.62,-4394.51 15254.31,-4403.02 15260.99,-4405.1"/>
</g>
<!-- dispatch_2_9 -->
<g id="node1050" class="node">
<title>dispatch_2_9</title>
<polygon fill="purple" stroke="black" points="15669.57,-4398.38 15481.57,-4345.38 15669.57,-4292.38 15857.57,-4345.38 15669.57,-4398.38"/>
<text text-anchor="middle" x="15669.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15669.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15669.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_9&#45;&gt;dispatch_2_9 -->
<g id="edge1270" class="edge">
<title>router_2_9&#45;&gt;dispatch_2_9</title>
<path fill="none" stroke="black" d="M15658.95,-4435.24C15660.02,-4426.33 15661.19,-4416.56 15662.34,-4406.86"/>
<polygon fill="black" stroke="black" points="15665.83,-4407.17 15663.54,-4396.82 15658.88,-4406.34 15665.83,-4407.17"/>
</g>
<!-- dispatch_2_10 -->
<g id="node1051" class="node">
<title>dispatch_2_10</title>
<polygon fill="purple" stroke="black" points="16063.57,-4398.38 15875.57,-4345.38 16063.57,-4292.38 16251.57,-4345.38 16063.57,-4398.38"/>
<text text-anchor="middle" x="16063.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16063.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16063.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_10&#45;&gt;dispatch_2_10 -->
<g id="edge1271" class="edge">
<title>router_2_10&#45;&gt;dispatch_2_10</title>
<path fill="none" stroke="black" d="M16020.93,-4435.58C16026.01,-4424.95 16031.68,-4413.09 16037.19,-4401.57"/>
<polygon fill="black" stroke="black" points="16040.4,-4402.97 16041.55,-4392.44 16034.08,-4399.95 16040.4,-4402.97"/>
</g>
<!-- dispatch_2_11 -->
<g id="node1052" class="node">
<title>dispatch_2_11</title>
<polygon fill="purple" stroke="black" points="16457.57,-4398.38 16269.57,-4345.38 16457.57,-4292.38 16645.57,-4345.38 16457.57,-4398.38"/>
<text text-anchor="middle" x="16457.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16457.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16457.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_11&#45;&gt;dispatch_2_11 -->
<g id="edge1272" class="edge">
<title>router_2_11&#45;&gt;dispatch_2_11</title>
<path fill="none" stroke="black" d="M16456.87,-4435.24C16456.93,-4426.94 16457,-4417.89 16457.08,-4408.85"/>
<polygon fill="black" stroke="black" points="16460.58,-4408.71 16457.16,-4398.68 16453.58,-4408.66 16460.58,-4408.71"/>
</g>
<!-- dispatch_2_12 -->
<g id="node1053" class="node">
<title>dispatch_2_12</title>
<polygon fill="purple" stroke="black" points="16852.57,-4398.38 16664.57,-4345.38 16852.57,-4292.38 17040.57,-4345.38 16852.57,-4398.38"/>
<text text-anchor="middle" x="16852.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16852.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16852.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_12&#45;&gt;dispatch_2_12 -->
<g id="edge1273" class="edge">
<title>router_2_12&#45;&gt;dispatch_2_12</title>
<path fill="none" stroke="black" d="M16822.83,-4435.24C16826.13,-4425.38 16829.78,-4414.47 16833.36,-4403.78"/>
<polygon fill="black" stroke="black" points="16836.77,-4404.64 16836.62,-4394.05 16830.13,-4402.42 16836.77,-4404.64"/>
</g>
<!-- dispatch_2_13 -->
<g id="node1054" class="node">
<title>dispatch_2_13</title>
<polygon fill="purple" stroke="black" points="17247.57,-4398.38 17059.57,-4345.38 17247.57,-4292.38 17435.57,-4345.38 17247.57,-4398.38"/>
<text text-anchor="middle" x="17247.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17247.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17247.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_13&#45;&gt;dispatch_2_13 -->
<g id="edge1274" class="edge">
<title>router_2_13&#45;&gt;dispatch_2_13</title>
<path fill="none" stroke="black" d="M17203.51,-4435.58C17208.76,-4424.95 17214.62,-4413.09 17220.31,-4401.57"/>
<polygon fill="black" stroke="black" points="17223.53,-4402.96 17224.82,-4392.44 17217.25,-4399.85 17223.53,-4402.96"/>
</g>
<!-- dispatch_2_14 -->
<g id="node1055" class="node">
<title>dispatch_2_14</title>
<polygon fill="purple" stroke="black" points="17664.57,-4398.38 17476.57,-4345.38 17664.57,-4292.38 17852.57,-4345.38 17664.57,-4398.38"/>
<text text-anchor="middle" x="17664.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17664.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17664.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_14&#45;&gt;dispatch_2_14 -->
<g id="edge1275" class="edge">
<title>router_2_14&#45;&gt;dispatch_2_14</title>
<path fill="none" stroke="black" d="M17605.58,-4435.58C17613.13,-4424.17 17621.62,-4411.33 17629.76,-4399.02"/>
<polygon fill="black" stroke="black" points="17632.72,-4400.88 17635.32,-4390.61 17626.88,-4397.02 17632.72,-4400.88"/>
</g>
<!-- dispatch_2_15 -->
<g id="node1056" class="node">
<title>dispatch_2_15</title>
<polygon fill="purple" stroke="black" points="18070.57,-4398.38 17882.57,-4345.38 18070.57,-4292.38 18258.57,-4345.38 18070.57,-4398.38"/>
<text text-anchor="middle" x="18070.57" y="-4356.68" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="18070.57" y="-4341.68" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18070.57" y="-4326.68" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_2_15&#45;&gt;dispatch_2_15 -->
<g id="edge1276" class="edge">
<title>router_2_15&#45;&gt;dispatch_2_15</title>
<path fill="none" stroke="black" d="M18007.79,-4435.92C18016.04,-4424.15 18025.37,-4410.84 18034.27,-4398.15"/>
<polygon fill="black" stroke="black" points="18037.17,-4400.12 18040.04,-4389.92 18031.44,-4396.1 18037.17,-4400.12"/>
</g>
<!-- expert_2_0_fc1_0 -->
<g id="node1057" class="node">
<title>expert_2_0_fc1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11784.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11784.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11784.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11784.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11784.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_0&#45;&gt;expert_2_0_fc1_0 -->
<g id="edge1277" class="edge">
<title>dispatch_2_0&#45;&gt;expert_2_0_fc1_0</title>
<path fill="none" stroke="black" d="M12047.07,-4313.67C11996.04,-4293.18 11928.73,-4266.16 11875.04,-4244.61"/>
<polygon fill="black" stroke="black" points="11876.11,-4241.27 11865.52,-4240.79 11873.5,-4247.76 11876.11,-4241.27"/>
</g>
<!-- expert_2_0_fc1_1 -->
<g id="node1058" class="node">
<title>expert_2_0_fc1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12456.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12456.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="12456.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12456.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12456.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_1&#45;&gt;expert_2_0_fc1_1 -->
<g id="edge1278" class="edge">
<title>dispatch_2_1&#45;&gt;expert_2_0_fc1_1</title>
<path fill="none" stroke="black" d="M12496.75,-4297.93C12491.9,-4287.1 12486.68,-4275.46 12481.66,-4264.27"/>
<polygon fill="black" stroke="black" points="12484.79,-4262.69 12477.51,-4255 12478.41,-4265.56 12484.79,-4262.69"/>
</g>
<!-- expert_2_1_fc1_2 -->
<g id="node1059" class="node">
<title>expert_2_1_fc1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12905.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12905.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="12905.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12905.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12905.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_2&#45;&gt;expert_2_1_fc1_2 -->
<g id="edge1279" class="edge">
<title>dispatch_2_2&#45;&gt;expert_2_1_fc1_2</title>
<path fill="none" stroke="black" d="M12909.31,-4292.93C12908.91,-4284.07 12908.51,-4274.81 12908.11,-4265.81"/>
<polygon fill="black" stroke="black" points="12911.6,-4265.62 12907.67,-4255.78 12904.61,-4265.92 12911.6,-4265.62"/>
</g>
<!-- expert_2_1_fc1_3 -->
<g id="node1060" class="node">
<title>expert_2_1_fc1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13233.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13233.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="13233.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13233.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13233.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_3&#45;&gt;expert_2_1_fc1_3 -->
<g id="edge1280" class="edge">
<title>dispatch_2_3&#45;&gt;expert_2_1_fc1_3</title>
<path fill="none" stroke="black" d="M13281.6,-4299.07C13275.54,-4287.61 13268.96,-4275.17 13262.67,-4263.29"/>
<polygon fill="black" stroke="black" points="13265.71,-4261.54 13257.94,-4254.34 13259.52,-4264.82 13265.71,-4261.54"/>
</g>
<!-- expert_2_2_fc1_4 -->
<g id="node1061" class="node">
<title>expert_2_2_fc1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13702.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13702.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13702.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13702.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13702.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_4&#45;&gt;expert_2_2_fc1_4 -->
<g id="edge1281" class="edge">
<title>dispatch_2_4&#45;&gt;expert_2_2_fc1_4</title>
<path fill="none" stroke="black" d="M13700.72,-4292.54C13700.91,-4283.8 13701.11,-4274.67 13701.31,-4265.79"/>
<polygon fill="black" stroke="black" points="13704.81,-4265.59 13701.53,-4255.52 13697.81,-4265.44 13704.81,-4265.59"/>
</g>
<!-- expert_2_2_fc1_5 -->
<g id="node1062" class="node">
<title>expert_2_2_fc1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14085.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14085.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="14085.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14085.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14085.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_5&#45;&gt;expert_2_2_fc1_5 -->
<g id="edge1282" class="edge">
<title>dispatch_2_5&#45;&gt;expert_2_2_fc1_5</title>
<path fill="none" stroke="black" d="M14090.55,-4292.93C14090.03,-4284.07 14089.48,-4274.81 14088.95,-4265.81"/>
<polygon fill="black" stroke="black" points="14092.45,-4265.56 14088.36,-4255.78 14085.46,-4265.97 14092.45,-4265.56"/>
</g>
<!-- expert_2_3_fc1_6 -->
<g id="node1063" class="node">
<title>expert_2_3_fc1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14488.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14488.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14488.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14488.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14488.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_6&#45;&gt;expert_2_3_fc1_6 -->
<g id="edge1283" class="edge">
<title>dispatch_2_6&#45;&gt;expert_2_3_fc1_6</title>
<path fill="none" stroke="black" d="M14487.96,-4292.15C14488.02,-4283.54 14488.09,-4274.56 14488.15,-4265.82"/>
<polygon fill="black" stroke="black" points="14491.65,-4265.73 14488.23,-4255.7 14484.65,-4265.67 14491.65,-4265.73"/>
</g>
<!-- expert_2_3_fc1_7 -->
<g id="node1064" class="node">
<title>expert_2_3_fc1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14797.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14797.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14797.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14797.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14797.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_7&#45;&gt;expert_2_3_fc1_7 -->
<g id="edge1284" class="edge">
<title>dispatch_2_7&#45;&gt;expert_2_3_fc1_7</title>
<path fill="none" stroke="black" d="M14854.07,-4299.82C14846.75,-4287.97 14838.77,-4275.03 14831.17,-4262.72"/>
<polygon fill="black" stroke="black" points="14833.95,-4260.56 14825.72,-4253.89 14827.99,-4264.24 14833.95,-4260.56"/>
</g>
<!-- expert_2_4_fc1_8 -->
<g id="node1065" class="node">
<title>expert_2_4_fc1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15280.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15280.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15280.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15280.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15280.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_8&#45;&gt;expert_2_4_fc1_8 -->
<g id="edge1285" class="edge">
<title>dispatch_2_8&#45;&gt;expert_2_4_fc1_8</title>
<path fill="none" stroke="black" d="M15277.48,-4292.54C15277.8,-4283.8 15278.13,-4274.67 15278.46,-4265.79"/>
<polygon fill="black" stroke="black" points="15281.97,-4265.64 15278.84,-4255.52 15274.97,-4265.38 15281.97,-4265.64"/>
</g>
<!-- expert_2_4_fc1_9 -->
<g id="node1066" class="node">
<title>expert_2_4_fc1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15666.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15666.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15666.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15666.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15666.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_9&#45;&gt;expert_2_4_fc1_9 -->
<g id="edge1286" class="edge">
<title>dispatch_2_9&#45;&gt;expert_2_4_fc1_9</title>
<path fill="none" stroke="black" d="M15668.43,-4292.54C15668.24,-4283.8 15668.04,-4274.67 15667.84,-4265.79"/>
<polygon fill="black" stroke="black" points="15671.33,-4265.44 15667.61,-4255.52 15664.34,-4265.59 15671.33,-4265.44"/>
</g>
<!-- expert_2_5_fc1_10 -->
<g id="node1067" class="node">
<title>expert_2_5_fc1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16074.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16074.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16074.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16074.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16074.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_10&#45;&gt;expert_2_5_fc1_10 -->
<g id="edge1287" class="edge">
<title>dispatch_2_10&#45;&gt;expert_2_5_fc1_10</title>
<path fill="none" stroke="black" d="M16067.7,-4293.32C16068.43,-4284.33 16069.19,-4274.92 16069.93,-4265.78"/>
<polygon fill="black" stroke="black" points="16073.43,-4265.84 16070.75,-4255.6 16066.46,-4265.28 16073.43,-4265.84"/>
</g>
<!-- expert_2_5_fc1_11 -->
<g id="node1068" class="node">
<title>expert_2_5_fc1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16456.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16456.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16456.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16456.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16456.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_11&#45;&gt;expert_2_5_fc1_11 -->
<g id="edge1288" class="edge">
<title>dispatch_2_11&#45;&gt;expert_2_5_fc1_11</title>
<path fill="none" stroke="black" d="M16457.19,-4292.15C16457.13,-4283.54 16457.06,-4274.56 16457,-4265.82"/>
<polygon fill="black" stroke="black" points="16460.5,-4265.67 16456.92,-4255.7 16453.5,-4265.73 16460.5,-4265.67"/>
</g>
<!-- expert_2_6_fc1_12 -->
<g id="node1069" class="node">
<title>expert_2_6_fc1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16971.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16971.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="16971.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16971.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16971.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_12&#45;&gt;expert_2_6_fc1_12 -->
<g id="edge1289" class="edge">
<title>dispatch_2_12&#45;&gt;expert_2_6_fc1_12</title>
<path fill="none" stroke="black" d="M16889.25,-4302.44C16900.89,-4289.13 16913.9,-4274.25 16926.08,-4260.32"/>
<polygon fill="black" stroke="black" points="16928.8,-4262.52 16932.75,-4252.69 16923.53,-4257.91 16928.8,-4262.52"/>
</g>
<!-- expert_2_6_fc1_13 -->
<g id="node1070" class="node">
<title>expert_2_6_fc1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17253.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17253.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="17253.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17253.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17253.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_13&#45;&gt;expert_2_6_fc1_13 -->
<g id="edge1290" class="edge">
<title>dispatch_2_13&#45;&gt;expert_2_6_fc1_13</title>
<path fill="none" stroke="black" d="M17249.84,-4292.93C17250.23,-4284.07 17250.64,-4274.81 17251.04,-4265.81"/>
<polygon fill="black" stroke="black" points="17254.54,-4265.92 17251.48,-4255.78 17247.54,-4265.62 17254.54,-4265.92"/>
</g>
<!-- expert_2_7_fc1_14 -->
<g id="node1071" class="node">
<title>expert_2_7_fc1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17815.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17815.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="17815.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17815.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17815.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_14&#45;&gt;expert_2_7_fc1_14 -->
<g id="edge1291" class="edge">
<title>dispatch_2_14&#45;&gt;expert_2_7_fc1_14</title>
<path fill="none" stroke="black" d="M17708.65,-4304.65C17724.81,-4290.09 17743.3,-4273.43 17760.31,-4258.1"/>
<polygon fill="black" stroke="black" points="17762.92,-4260.46 17768.01,-4251.16 17758.24,-4255.26 17762.92,-4260.46"/>
</g>
<!-- expert_2_7_fc1_15 -->
<g id="node1072" class="node">
<title>expert_2_7_fc1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18119.57" cy="-4207.3" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18119.57" y="-4226.1" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="18119.57" y="-4211.1" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18119.57" y="-4196.1" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18119.57" y="-4181.1" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_2_15&#45;&gt;expert_2_7_fc1_15 -->
<g id="edge1292" class="edge">
<title>dispatch_2_15&#45;&gt;expert_2_7_fc1_15</title>
<path fill="none" stroke="black" d="M18087.57,-4297.17C18091.38,-4286.6 18095.45,-4275.29 18099.37,-4264.4"/>
<polygon fill="black" stroke="black" points="18102.67,-4265.56 18102.77,-4254.97 18096.09,-4263.19 18102.67,-4265.56"/>
</g>
<!-- expert_2_0_gelu_0 -->
<g id="node1073" class="node">
<title>expert_2_0_gelu_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11775.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="11775.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="11775.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11775.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_0_fc1_0&#45;&gt;expert_2_0_gelu_0 -->
<g id="edge1293" class="edge">
<title>expert_2_0_fc1_0&#45;&gt;expert_2_0_gelu_0</title>
<path fill="none" stroke="black" d="M11781.04,-4158.98C11780.39,-4150.26 11779.71,-4141.15 11779.06,-4132.44"/>
<polygon fill="black" stroke="black" points="11782.55,-4132.16 11778.32,-4122.45 11775.57,-4132.68 11782.55,-4132.16"/>
</g>
<!-- expert_2_0_gelu_1 -->
<g id="node1076" class="node">
<title>expert_2_0_gelu_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12274.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12274.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="12274.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12274.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_0_fc1_1&#45;&gt;expert_2_0_gelu_1 -->
<g id="edge1296" class="edge">
<title>expert_2_0_fc1_1&#45;&gt;expert_2_0_gelu_1</title>
<path fill="none" stroke="black" d="M12396.48,-4166.48C12376.09,-4152.97 12353.36,-4137.91 12333.1,-4124.49"/>
<polygon fill="black" stroke="black" points="12334.85,-4121.45 12324.58,-4118.84 12330.98,-4127.29 12334.85,-4121.45"/>
</g>
<!-- expert_2_1_gelu_2 -->
<g id="node1078" class="node">
<title>expert_2_1_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12894.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12894.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="12894.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12894.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_1_fc1_2&#45;&gt;expert_2_1_gelu_2 -->
<g id="edge1299" class="edge">
<title>expert_2_1_fc1_2&#45;&gt;expert_2_1_gelu_2</title>
<path fill="none" stroke="black" d="M12901.26,-4158.98C12900.46,-4150.26 12899.63,-4141.15 12898.84,-4132.44"/>
<polygon fill="black" stroke="black" points="12902.32,-4132.09 12897.92,-4122.45 12895.35,-4132.73 12902.32,-4132.09"/>
</g>
<!-- expert_2_1_gelu_3 -->
<g id="node1081" class="node">
<title>expert_2_1_gelu_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13195.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13195.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="13195.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13195.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_1_fc1_3&#45;&gt;expert_2_1_gelu_3 -->
<g id="edge1302" class="edge">
<title>expert_2_1_fc1_3&#45;&gt;expert_2_1_gelu_3</title>
<path fill="none" stroke="black" d="M13218.77,-4159.33C13215.93,-4150.3 13212.95,-4140.84 13210.11,-4131.84"/>
<polygon fill="black" stroke="black" points="13213.44,-4130.77 13207.1,-4122.28 13206.77,-4132.87 13213.44,-4130.77"/>
</g>
<!-- expert_2_2_gelu_4 -->
<g id="node1083" class="node">
<title>expert_2_2_gelu_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13707.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13707.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13707.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13707.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_2_fc1_4&#45;&gt;expert_2_2_gelu_4 -->
<g id="edge1305" class="edge">
<title>expert_2_2_fc1_4&#45;&gt;expert_2_2_gelu_4</title>
<path fill="none" stroke="black" d="M13704.54,-4158.98C13704.9,-4150.26 13705.27,-4141.15 13705.64,-4132.44"/>
<polygon fill="black" stroke="black" points="13709.13,-4132.59 13706.05,-4122.45 13702.14,-4132.3 13709.13,-4132.59"/>
</g>
<!-- expert_2_2_gelu_5 -->
<g id="node1086" class="node">
<title>expert_2_2_gelu_5</title>
<ellipse fill="lightcoral" stroke="black" cx="14035.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14035.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="14035.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14035.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_2_fc1_5&#45;&gt;expert_2_2_gelu_5 -->
<g id="edge1308" class="edge">
<title>expert_2_2_fc1_5&#45;&gt;expert_2_2_gelu_5</title>
<path fill="none" stroke="black" d="M14066.24,-4159.67C14062.41,-4150.43 14058.39,-4140.73 14054.56,-4131.51"/>
<polygon fill="black" stroke="black" points="14057.73,-4130.01 14050.67,-4122.11 14051.26,-4132.69 14057.73,-4130.01"/>
</g>
<!-- expert_2_3_gelu_6 -->
<g id="node1088" class="node">
<title>expert_2_3_gelu_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14488.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14488.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14488.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14488.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_3_fc1_6&#45;&gt;expert_2_3_gelu_6 -->
<g id="edge1311" class="edge">
<title>expert_2_3_fc1_6&#45;&gt;expert_2_3_gelu_6</title>
<path fill="none" stroke="black" d="M14488.57,-4158.98C14488.57,-4150.35 14488.57,-4141.35 14488.57,-4132.73"/>
<polygon fill="black" stroke="black" points="14492.07,-4132.45 14488.57,-4122.45 14485.07,-4132.45 14492.07,-4132.45"/>
</g>
<!-- expert_2_3_gelu_7 -->
<g id="node1091" class="node">
<title>expert_2_3_gelu_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14746.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14746.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14746.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14746.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_3_fc1_7&#45;&gt;expert_2_3_gelu_7 -->
<g id="edge1314" class="edge">
<title>expert_2_3_fc1_7&#45;&gt;expert_2_3_gelu_7</title>
<path fill="none" stroke="black" d="M14777.86,-4159.67C14773.94,-4150.43 14769.84,-4140.73 14765.94,-4131.51"/>
<polygon fill="black" stroke="black" points="14769.09,-4129.96 14761.97,-4122.11 14762.64,-4132.69 14769.09,-4129.96"/>
</g>
<!-- expert_2_4_gelu_8 -->
<g id="node1093" class="node">
<title>expert_2_4_gelu_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15291.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15291.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15291.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15291.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_4_fc1_8&#45;&gt;expert_2_4_gelu_8 -->
<g id="edge1317" class="edge">
<title>expert_2_4_fc1_8&#45;&gt;expert_2_4_gelu_8</title>
<path fill="none" stroke="black" d="M15284.89,-4158.98C15285.69,-4150.26 15286.52,-4141.15 15287.31,-4132.44"/>
<polygon fill="black" stroke="black" points="15290.8,-4132.73 15288.22,-4122.45 15283.83,-4132.09 15290.8,-4132.73"/>
</g>
<!-- expert_2_4_gelu_9 -->
<g id="node1096" class="node">
<title>expert_2_4_gelu_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15597.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15597.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15597.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15597.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_4_fc1_9&#45;&gt;expert_2_4_gelu_9 -->
<g id="edge1320" class="edge">
<title>expert_2_4_fc1_9&#45;&gt;expert_2_4_gelu_9</title>
<path fill="none" stroke="black" d="M15640.29,-4160.36C15634.69,-4150.58 15628.79,-4140.26 15623.21,-4130.52"/>
<polygon fill="black" stroke="black" points="15626.21,-4128.71 15618.21,-4121.77 15620.13,-4132.19 15626.21,-4128.71"/>
</g>
<!-- expert_2_5_gelu_10 -->
<g id="node1098" class="node">
<title>expert_2_5_gelu_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16095.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16095.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16095.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16095.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_5_fc1_10&#45;&gt;expert_2_5_gelu_10 -->
<g id="edge1323" class="edge">
<title>expert_2_5_fc1_10&#45;&gt;expert_2_5_gelu_10</title>
<path fill="none" stroke="black" d="M16082.75,-4159.33C16084.29,-4150.49 16085.9,-4141.25 16087.44,-4132.41"/>
<polygon fill="black" stroke="black" points="16090.94,-4132.73 16089.2,-4122.28 16084.04,-4131.53 16090.94,-4132.73"/>
</g>
<!-- expert_2_5_gelu_11 -->
<g id="node1101" class="node">
<title>expert_2_5_gelu_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16420.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16420.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16420.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16420.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_5_fc1_11&#45;&gt;expert_2_5_gelu_11 -->
<g id="edge1326" class="edge">
<title>expert_2_5_fc1_11&#45;&gt;expert_2_5_gelu_11</title>
<path fill="none" stroke="black" d="M16442.55,-4159.33C16439.88,-4150.39 16437.09,-4141.05 16434.43,-4132.13"/>
<polygon fill="black" stroke="black" points="16437.71,-4130.86 16431.49,-4122.28 16431,-4132.87 16437.71,-4130.86"/>
</g>
<!-- expert_2_6_gelu_12 -->
<g id="node1103" class="node">
<title>expert_2_6_gelu_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16976.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16976.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="16976.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16976.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_6_fc1_12&#45;&gt;expert_2_6_gelu_12 -->
<g id="edge1329" class="edge">
<title>expert_2_6_fc1_12&#45;&gt;expert_2_6_gelu_12</title>
<path fill="none" stroke="black" d="M16973.54,-4158.98C16973.9,-4150.26 16974.27,-4141.15 16974.64,-4132.44"/>
<polygon fill="black" stroke="black" points="16978.13,-4132.59 16975.05,-4122.45 16971.14,-4132.3 16978.13,-4132.59"/>
</g>
<!-- expert_2_6_gelu_13 -->
<g id="node1106" class="node">
<title>expert_2_6_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17268.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17268.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="17268.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17268.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_6_fc1_13&#45;&gt;expert_2_6_gelu_13 -->
<g id="edge1332" class="edge">
<title>expert_2_6_fc1_13&#45;&gt;expert_2_6_gelu_13</title>
<path fill="none" stroke="black" d="M17259.46,-4158.98C17260.54,-4150.26 17261.68,-4141.15 17262.76,-4132.44"/>
<polygon fill="black" stroke="black" points="17266.24,-4132.8 17264,-4122.45 17259.3,-4131.94 17266.24,-4132.8"/>
</g>
<!-- expert_2_7_gelu_14 -->
<g id="node1108" class="node">
<title>expert_2_7_gelu_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17853.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17853.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="17853.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17853.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_7_fc1_14&#45;&gt;expert_2_7_gelu_14 -->
<g id="edge1335" class="edge">
<title>expert_2_7_fc1_14&#45;&gt;expert_2_7_gelu_14</title>
<path fill="none" stroke="black" d="M17830.37,-4159.33C17833.22,-4150.3 17836.2,-4140.84 17839.04,-4131.84"/>
<polygon fill="black" stroke="black" points="17842.38,-4132.87 17842.05,-4122.28 17835.71,-4130.77 17842.38,-4132.87"/>
</g>
<!-- expert_2_7_gelu_15 -->
<g id="node1111" class="node">
<title>expert_2_7_gelu_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18182.57" cy="-4084.71" rx="119" ry="37.5"/>
<text text-anchor="middle" x="18182.57" y="-4096.01" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="18182.57" y="-4081.01" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18182.57" y="-4066.01" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_2_7_fc1_15&#45;&gt;expert_2_7_gelu_15 -->
<g id="edge1338" class="edge">
<title>expert_2_7_fc1_15&#45;&gt;expert_2_7_gelu_15</title>
<path fill="none" stroke="black" d="M18143.75,-4160.02C18148.75,-4150.46 18154,-4140.4 18158.98,-4130.87"/>
<polygon fill="black" stroke="black" points="18162.12,-4132.43 18163.64,-4121.94 18155.91,-4129.18 18162.12,-4132.43"/>
</g>
<!-- expert_2_0_fc2_0 -->
<g id="node1074" class="node">
<title>expert_2_0_fc2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11697.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11697.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11697.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11697.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11697.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_0_gelu_0&#45;&gt;expert_2_0_fc2_0 -->
<g id="edge1294" class="edge">
<title>expert_2_0_gelu_0&#45;&gt;expert_2_0_fc2_0</title>
<path fill="none" stroke="black" d="M11752.38,-4047.86C11746.21,-4038.31 11739.4,-4027.78 11732.74,-4017.49"/>
<polygon fill="black" stroke="black" points="11735.56,-4015.42 11727.19,-4008.92 11729.69,-4019.22 11735.56,-4015.42"/>
</g>
<!-- allreduce_expert_2_0 -->
<g id="node1075" class="node">
<title>allreduce_expert_2_0</title>
<polygon fill="red" stroke="black" points="11683.57,-3877.05 11528.57,-3824.05 11683.57,-3771.05 11838.57,-3824.05 11683.57,-3877.05"/>
<text text-anchor="middle" x="11683.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 0</text>
<text text-anchor="middle" x="11683.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="11683.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 0&#45;1</text>
</g>
<!-- expert_2_0_fc2_0&#45;&gt;allreduce_expert_2_0 -->
<g id="edge1295" class="edge">
<title>expert_2_0_fc2_0&#45;&gt;allreduce_expert_2_0</title>
<path fill="none" stroke="black" d="M11692.72,-3913.92C11691.78,-3904.78 11690.78,-3895.1 11689.8,-3885.61"/>
<polygon fill="black" stroke="black" points="11693.26,-3885.01 11688.76,-3875.42 11686.3,-3885.73 11693.26,-3885.01"/>
</g>
<!-- combine_experts_2_0 -->
<g id="node1113" class="node">
<title>combine_experts_2_0</title>
<polygon fill="purple" stroke="black" points="11165.57,-3734.05 10918.57,-3681.05 11165.57,-3628.05 11412.57,-3681.05 11165.57,-3734.05"/>
<text text-anchor="middle" x="11165.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11165.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11165.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_0&#45;&gt;combine_experts_2_0 -->
<g id="edge1341" class="edge">
<title>allreduce_expert_2_0&#45;&gt;combine_experts_2_0</title>
<path fill="none" stroke="black" d="M11598.62,-3799.92C11512.46,-3776.47 11378.47,-3740 11282.35,-3713.83"/>
<polygon fill="black" stroke="black" points="11283.15,-3710.42 11272.59,-3711.17 11281.32,-3717.18 11283.15,-3710.42"/>
</g>
<!-- combine_experts_2_1 -->
<g id="node1114" class="node">
<title>combine_experts_2_1</title>
<polygon fill="purple" stroke="black" points="11677.57,-3734.05 11430.57,-3681.05 11677.57,-3628.05 11924.57,-3681.05 11677.57,-3734.05"/>
<text text-anchor="middle" x="11677.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11677.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11677.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_0&#45;&gt;combine_experts_2_1 -->
<g id="edge1342" class="edge">
<title>allreduce_expert_2_0&#45;&gt;combine_experts_2_1</title>
<path fill="none" stroke="black" d="M11681.39,-3771.74C11681.01,-3762.82 11680.61,-3753.45 11680.22,-3744.27"/>
<polygon fill="black" stroke="black" points="11683.71,-3743.86 11679.79,-3734.02 11676.71,-3744.16 11683.71,-3743.86"/>
</g>
<!-- expert_2_0_fc2_1 -->
<g id="node1077" class="node">
<title>expert_2_0_fc2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="12085.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12085.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="12085.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12085.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12085.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_0_gelu_1&#45;&gt;expert_2_0_fc2_1 -->
<g id="edge1297" class="edge">
<title>expert_2_0_gelu_1&#45;&gt;expert_2_0_fc2_1</title>
<path fill="none" stroke="black" d="M12222.93,-4050.76C12202.19,-4037.53 12177.96,-4022.07 12155.67,-4007.85"/>
<polygon fill="black" stroke="black" points="12157.54,-4004.89 12147.23,-4002.47 12153.78,-4010.8 12157.54,-4004.89"/>
</g>
<!-- expert_2_0_fc2_1&#45;&gt;allreduce_expert_2_0 -->
<g id="edge1298" class="edge">
<title>expert_2_0_fc2_1&#45;&gt;allreduce_expert_2_0</title>
<path fill="none" stroke="black" d="M11998.35,-3931.6C11930.67,-3908.69 11837.33,-3877.09 11769.88,-3854.26"/>
<polygon fill="black" stroke="black" points="11770.72,-3850.85 11760.12,-3850.96 11768.47,-3857.48 11770.72,-3850.85"/>
</g>
<!-- expert_2_1_fc2_2 -->
<g id="node1079" class="node">
<title>expert_2_1_fc2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12866.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12866.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="12866.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12866.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12866.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_1_gelu_2&#45;&gt;expert_2_1_fc2_2 -->
<g id="edge1300" class="edge">
<title>expert_2_1_gelu_2&#45;&gt;expert_2_1_fc2_2</title>
<path fill="none" stroke="black" d="M12886.1,-4047.21C12884.11,-4038.65 12881.95,-4029.34 12879.81,-4020.13"/>
<polygon fill="black" stroke="black" points="12883.18,-4019.17 12877.51,-4010.22 12876.36,-4020.75 12883.18,-4019.17"/>
</g>
<!-- allreduce_expert_2_1 -->
<g id="node1080" class="node">
<title>allreduce_expert_2_1</title>
<polygon fill="red" stroke="black" points="12809.57,-3877.05 12654.57,-3824.05 12809.57,-3771.05 12964.57,-3824.05 12809.57,-3877.05"/>
<text text-anchor="middle" x="12809.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 1</text>
<text text-anchor="middle" x="12809.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12809.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 2&#45;3</text>
</g>
<!-- expert_2_1_fc2_2&#45;&gt;allreduce_expert_2_1 -->
<g id="edge1301" class="edge">
<title>expert_2_1_fc2_2&#45;&gt;allreduce_expert_2_1</title>
<path fill="none" stroke="black" d="M12847.12,-3914.68C12842.48,-3903.61 12837.49,-3891.69 12832.71,-3880.27"/>
<polygon fill="black" stroke="black" points="12835.84,-3878.7 12828.75,-3870.83 12829.38,-3881.4 12835.84,-3878.7"/>
</g>
<!-- combine_experts_2_2 -->
<g id="node1115" class="node">
<title>combine_experts_2_2</title>
<polygon fill="purple" stroke="black" points="12189.57,-3734.05 11942.57,-3681.05 12189.57,-3628.05 12436.57,-3681.05 12189.57,-3734.05"/>
<text text-anchor="middle" x="12189.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12189.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12189.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_1&#45;&gt;combine_experts_2_2 -->
<g id="edge1343" class="edge">
<title>allreduce_expert_2_1&#45;&gt;combine_experts_2_2</title>
<path fill="none" stroke="black" d="M12718.09,-3802.24C12612.1,-3778.14 12436.77,-3738.26 12317.36,-3711.11"/>
<polygon fill="black" stroke="black" points="12317.95,-3707.65 12307.43,-3708.85 12316.4,-3714.48 12317.95,-3707.65"/>
</g>
<!-- combine_experts_2_3 -->
<g id="node1116" class="node">
<title>combine_experts_2_3</title>
<polygon fill="purple" stroke="black" points="12701.57,-3734.05 12454.57,-3681.05 12701.57,-3628.05 12948.57,-3681.05 12701.57,-3734.05"/>
<text text-anchor="middle" x="12701.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12701.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12701.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_1&#45;&gt;combine_experts_2_3 -->
<g id="edge1344" class="edge">
<title>allreduce_expert_2_1&#45;&gt;combine_experts_2_3</title>
<path fill="none" stroke="black" d="M12777.75,-3781.5C12766.52,-3766.84 12753.74,-3750.15 12741.9,-3734.69"/>
<polygon fill="black" stroke="black" points="12744.66,-3732.54 12735.8,-3726.73 12739.1,-3736.8 12744.66,-3732.54"/>
</g>
<!-- expert_2_1_fc2_3 -->
<g id="node1082" class="node">
<title>expert_2_1_fc2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="13113.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13113.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="13113.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13113.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13113.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_1_gelu_3&#45;&gt;expert_2_1_fc2_3 -->
<g id="edge1303" class="edge">
<title>expert_2_1_gelu_3&#45;&gt;expert_2_1_fc2_3</title>
<path fill="none" stroke="black" d="M13171.19,-4047.86C13164.56,-4038.11 13157.23,-4027.33 13150.09,-4016.83"/>
<polygon fill="black" stroke="black" points="13152.93,-4014.78 13144.41,-4008.48 13147.14,-4018.72 13152.93,-4014.78"/>
</g>
<!-- expert_2_1_fc2_3&#45;&gt;allreduce_expert_2_1 -->
<g id="edge1304" class="edge">
<title>expert_2_1_fc2_3&#45;&gt;allreduce_expert_2_1</title>
<path fill="none" stroke="black" d="M13036.86,-3926.79C12990.29,-3905.94 12931.11,-3879.45 12884.81,-3858.72"/>
<polygon fill="black" stroke="black" points="12885.99,-3855.42 12875.43,-3854.53 12883.13,-3861.81 12885.99,-3855.42"/>
</g>
<!-- expert_2_2_fc2_4 -->
<g id="node1084" class="node">
<title>expert_2_2_fc2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13712.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13712.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13712.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13712.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13712.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_2_gelu_4&#45;&gt;expert_2_2_fc2_4 -->
<g id="edge1306" class="edge">
<title>expert_2_2_gelu_4&#45;&gt;expert_2_2_fc2_4</title>
<path fill="none" stroke="black" d="M13709.09,-4047.21C13709.44,-4038.75 13709.82,-4029.54 13710.2,-4020.43"/>
<polygon fill="black" stroke="black" points="13713.7,-4020.36 13710.62,-4010.22 13706.71,-4020.07 13713.7,-4020.36"/>
</g>
<!-- allreduce_expert_2_2 -->
<g id="node1085" class="node">
<title>allreduce_expert_2_2</title>
<polygon fill="red" stroke="black" points="13723.57,-3877.05 13568.57,-3824.05 13723.57,-3771.05 13878.57,-3824.05 13723.57,-3877.05"/>
<text text-anchor="middle" x="13723.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 2</text>
<text text-anchor="middle" x="13723.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="13723.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 4&#45;5</text>
</g>
<!-- expert_2_2_fc2_4&#45;&gt;allreduce_expert_2_2 -->
<g id="edge1307" class="edge">
<title>expert_2_2_fc2_4&#45;&gt;allreduce_expert_2_2</title>
<path fill="none" stroke="black" d="M13716.39,-3913.92C13717.12,-3904.9 13717.89,-3895.34 13718.65,-3885.96"/>
<polygon fill="black" stroke="black" points="13722.15,-3886.14 13719.46,-3875.89 13715.17,-3885.57 13722.15,-3886.14"/>
</g>
<!-- combine_experts_2_4 -->
<g id="node1117" class="node">
<title>combine_experts_2_4</title>
<polygon fill="purple" stroke="black" points="13213.57,-3734.05 12966.57,-3681.05 13213.57,-3628.05 13460.57,-3681.05 13213.57,-3734.05"/>
<text text-anchor="middle" x="13213.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13213.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13213.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_2&#45;&gt;combine_experts_2_4 -->
<g id="edge1345" class="edge">
<title>allreduce_expert_2_2&#45;&gt;combine_experts_2_4</title>
<path fill="none" stroke="black" d="M13639.36,-3799.76C13554.79,-3776.38 13423.83,-3740.18 13329.48,-3714.09"/>
<polygon fill="black" stroke="black" points="13330.18,-3710.65 13319.61,-3711.36 13328.31,-3717.4 13330.18,-3710.65"/>
</g>
<!-- combine_experts_2_5 -->
<g id="node1118" class="node">
<title>combine_experts_2_5</title>
<polygon fill="purple" stroke="black" points="13725.57,-3734.05 13478.57,-3681.05 13725.57,-3628.05 13972.57,-3681.05 13725.57,-3734.05"/>
<text text-anchor="middle" x="13725.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13725.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13725.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_2&#45;&gt;combine_experts_2_5 -->
<g id="edge1346" class="edge">
<title>allreduce_expert_2_2&#45;&gt;combine_experts_2_5</title>
<path fill="none" stroke="black" d="M13724.31,-3770.94C13724.44,-3762.17 13724.57,-3752.98 13724.69,-3743.98"/>
<polygon fill="black" stroke="black" points="13728.2,-3743.98 13724.84,-3733.93 13721.2,-3743.88 13728.2,-3743.98"/>
</g>
<!-- expert_2_2_fc2_5 -->
<g id="node1087" class="node">
<title>expert_2_2_fc2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13957.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13957.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13957.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13957.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13957.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_2_gelu_5&#45;&gt;expert_2_2_fc2_5 -->
<g id="edge1309" class="edge">
<title>expert_2_2_gelu_5&#45;&gt;expert_2_2_fc2_5</title>
<path fill="none" stroke="black" d="M14012.38,-4047.86C14006.21,-4038.31 13999.4,-4027.78 13992.74,-4017.49"/>
<polygon fill="black" stroke="black" points="13995.56,-4015.42 13987.19,-4008.92 13989.69,-4019.22 13995.56,-4015.42"/>
</g>
<!-- expert_2_2_fc2_5&#45;&gt;allreduce_expert_2_2 -->
<g id="edge1310" class="edge">
<title>expert_2_2_fc2_5&#45;&gt;allreduce_expert_2_2</title>
<path fill="none" stroke="black" d="M13891.77,-3922.86C13859.64,-3904.18 13821.1,-3881.76 13789.02,-3863.11"/>
<polygon fill="black" stroke="black" points="13790.56,-3859.95 13780.16,-3857.95 13787.04,-3866.01 13790.56,-3859.95"/>
</g>
<!-- expert_2_3_fc2_6 -->
<g id="node1089" class="node">
<title>expert_2_3_fc2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14497.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14497.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14497.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14497.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14497.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_3_gelu_6&#45;&gt;expert_2_3_fc2_6 -->
<g id="edge1312" class="edge">
<title>expert_2_3_gelu_6&#45;&gt;expert_2_3_fc2_6</title>
<path fill="none" stroke="black" d="M14491.3,-4047.21C14491.93,-4038.75 14492.62,-4029.54 14493.3,-4020.43"/>
<polygon fill="black" stroke="black" points="14496.8,-4020.45 14494.06,-4010.22 14489.82,-4019.93 14496.8,-4020.45"/>
</g>
<!-- allreduce_expert_2_3 -->
<g id="node1090" class="node">
<title>allreduce_expert_2_3</title>
<polygon fill="red" stroke="black" points="14746.57,-3877.05 14591.57,-3824.05 14746.57,-3771.05 14901.57,-3824.05 14746.57,-3877.05"/>
<text text-anchor="middle" x="14746.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 3</text>
<text text-anchor="middle" x="14746.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14746.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 6&#45;7</text>
</g>
<!-- expert_2_3_fc2_6&#45;&gt;allreduce_expert_2_3 -->
<g id="edge1313" class="edge">
<title>expert_2_3_fc2_6&#45;&gt;allreduce_expert_2_3</title>
<path fill="none" stroke="black" d="M14565.94,-3923.76C14600.97,-3904.62 14643.48,-3881.39 14678.47,-3862.27"/>
<polygon fill="black" stroke="black" points="14680.56,-3865.11 14687.66,-3857.24 14677.2,-3858.97 14680.56,-3865.11"/>
</g>
<!-- combine_experts_2_6 -->
<g id="node1119" class="node">
<title>combine_experts_2_6</title>
<polygon fill="purple" stroke="black" points="14237.57,-3734.05 13990.57,-3681.05 14237.57,-3628.05 14484.57,-3681.05 14237.57,-3734.05"/>
<text text-anchor="middle" x="14237.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14237.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14237.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_3&#45;&gt;combine_experts_2_6 -->
<g id="edge1347" class="edge">
<title>allreduce_expert_2_3&#45;&gt;combine_experts_2_6</title>
<path fill="none" stroke="black" d="M14662.52,-3799.76C14578.12,-3776.38 14447.42,-3740.18 14353.26,-3714.09"/>
<polygon fill="black" stroke="black" points="14353.97,-3710.66 14343.4,-3711.36 14352.1,-3717.4 14353.97,-3710.66"/>
</g>
<!-- combine_experts_2_7 -->
<g id="node1120" class="node">
<title>combine_experts_2_7</title>
<polygon fill="purple" stroke="black" points="14749.57,-3734.05 14502.57,-3681.05 14749.57,-3628.05 14996.57,-3681.05 14749.57,-3734.05"/>
<text text-anchor="middle" x="14749.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14749.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14749.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_3&#45;&gt;combine_experts_2_7 -->
<g id="edge1348" class="edge">
<title>allreduce_expert_2_3&#45;&gt;combine_experts_2_7</title>
<path fill="none" stroke="black" d="M14747.67,-3771.34C14747.86,-3762.55 14748.06,-3753.33 14748.25,-3744.3"/>
<polygon fill="black" stroke="black" points="14751.75,-3744.29 14748.46,-3734.21 14744.75,-3744.14 14751.75,-3744.29"/>
</g>
<!-- expert_2_3_fc2_7 -->
<g id="node1092" class="node">
<title>expert_2_3_fc2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14746.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14746.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14746.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14746.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14746.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_3_gelu_7&#45;&gt;expert_2_3_fc2_7 -->
<g id="edge1315" class="edge">
<title>expert_2_3_gelu_7&#45;&gt;expert_2_3_fc2_7</title>
<path fill="none" stroke="black" d="M14746.57,-4047.21C14746.57,-4038.75 14746.57,-4029.54 14746.57,-4020.43"/>
<polygon fill="black" stroke="black" points="14750.07,-4020.22 14746.57,-4010.22 14743.07,-4020.22 14750.07,-4020.22"/>
</g>
<!-- expert_2_3_fc2_7&#45;&gt;allreduce_expert_2_3 -->
<g id="edge1316" class="edge">
<title>expert_2_3_fc2_7&#45;&gt;allreduce_expert_2_3</title>
<path fill="none" stroke="black" d="M14746.57,-3913.92C14746.57,-3905.33 14746.57,-3896.25 14746.57,-3887.3"/>
<polygon fill="black" stroke="black" points="14750.07,-3887.29 14746.57,-3877.29 14743.07,-3887.29 14750.07,-3887.29"/>
</g>
<!-- expert_2_4_fc2_8 -->
<g id="node1094" class="node">
<title>expert_2_4_fc2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="15312.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15312.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15312.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15312.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15312.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_4_gelu_8&#45;&gt;expert_2_4_fc2_8 -->
<g id="edge1318" class="edge">
<title>expert_2_4_gelu_8&#45;&gt;expert_2_4_fc2_8</title>
<path fill="none" stroke="black" d="M15297.93,-4047.21C15299.42,-4038.65 15301.04,-4029.34 15302.65,-4020.13"/>
<polygon fill="black" stroke="black" points="15306.1,-4020.67 15304.37,-4010.22 15299.21,-4019.47 15306.1,-4020.67"/>
</g>
<!-- allreduce_expert_2_4 -->
<g id="node1095" class="node">
<title>allreduce_expert_2_4</title>
<polygon fill="red" stroke="black" points="15459.57,-3877.05 15304.57,-3824.05 15459.57,-3771.05 15614.57,-3824.05 15459.57,-3877.05"/>
<text text-anchor="middle" x="15459.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 4</text>
<text text-anchor="middle" x="15459.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="15459.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 8&#45;9</text>
</g>
<!-- expert_2_4_fc2_8&#45;&gt;allreduce_expert_2_4 -->
<g id="edge1319" class="edge">
<title>expert_2_4_fc2_8&#45;&gt;allreduce_expert_2_4</title>
<path fill="none" stroke="black" d="M15359.09,-3918.07C15375.57,-3902.81 15394.16,-3885.6 15410.82,-3870.17"/>
<polygon fill="black" stroke="black" points="15413.37,-3872.59 15418.33,-3863.22 15408.62,-3867.45 15413.37,-3872.59"/>
</g>
<!-- combine_experts_2_8 -->
<g id="node1121" class="node">
<title>combine_experts_2_8</title>
<polygon fill="purple" stroke="black" points="15261.57,-3734.05 15014.57,-3681.05 15261.57,-3628.05 15508.57,-3681.05 15261.57,-3734.05"/>
<text text-anchor="middle" x="15261.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15261.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15261.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_4&#45;&gt;combine_experts_2_8 -->
<g id="edge1349" class="edge">
<title>allreduce_expert_2_4&#45;&gt;combine_experts_2_8</title>
<path fill="none" stroke="black" d="M15410.12,-3787.83C15384.69,-3769.72 15353.38,-3747.42 15326.07,-3727.98"/>
<polygon fill="black" stroke="black" points="15327.91,-3724.99 15317.74,-3722.04 15323.85,-3730.69 15327.91,-3724.99"/>
</g>
<!-- combine_experts_2_9 -->
<g id="node1122" class="node">
<title>combine_experts_2_9</title>
<polygon fill="purple" stroke="black" points="15773.57,-3734.05 15526.57,-3681.05 15773.57,-3628.05 16020.57,-3681.05 15773.57,-3734.05"/>
<text text-anchor="middle" x="15773.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15773.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15773.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_4&#45;&gt;combine_experts_2_9 -->
<g id="edge1350" class="edge">
<title>allreduce_expert_2_4&#45;&gt;combine_experts_2_9</title>
<path fill="none" stroke="black" d="M15525.4,-3793.49C15571.95,-3772.58 15634.88,-3744.33 15685.72,-3721.5"/>
<polygon fill="black" stroke="black" points="15687.38,-3724.59 15695.06,-3717.3 15684.51,-3718.2 15687.38,-3724.59"/>
</g>
<!-- expert_2_4_fc2_9 -->
<g id="node1097" class="node">
<title>expert_2_4_fc2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15596.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15596.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15596.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15596.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15596.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_4_gelu_9&#45;&gt;expert_2_4_fc2_9 -->
<g id="edge1321" class="edge">
<title>expert_2_4_gelu_9&#45;&gt;expert_2_4_fc2_9</title>
<path fill="none" stroke="black" d="M15597.27,-4047.21C15597.2,-4038.75 15597.12,-4029.54 15597.05,-4020.43"/>
<polygon fill="black" stroke="black" points="15600.55,-4020.19 15596.96,-4010.22 15593.55,-4020.25 15600.55,-4020.19"/>
</g>
<!-- expert_2_4_fc2_9&#45;&gt;allreduce_expert_2_4 -->
<g id="edge1322" class="edge">
<title>expert_2_4_fc2_9&#45;&gt;allreduce_expert_2_4</title>
<path fill="none" stroke="black" d="M15552.85,-3917.7C15537.91,-3902.86 15521.15,-3886.21 15506.01,-3871.17"/>
<polygon fill="black" stroke="black" points="15508.28,-3868.49 15498.72,-3863.93 15503.34,-3873.46 15508.28,-3868.49"/>
</g>
<!-- expert_2_5_fc2_10 -->
<g id="node1099" class="node">
<title>expert_2_5_fc2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="16156.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16156.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16156.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16156.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16156.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_5_gelu_10&#45;&gt;expert_2_5_fc2_10 -->
<g id="edge1324" class="edge">
<title>expert_2_5_gelu_10&#45;&gt;expert_2_5_fc2_10</title>
<path fill="none" stroke="black" d="M16113.88,-4047.53C16118.5,-4038.4 16123.57,-4028.38 16128.55,-4018.53"/>
<polygon fill="black" stroke="black" points="16131.69,-4020.07 16133.08,-4009.57 16125.44,-4016.92 16131.69,-4020.07"/>
</g>
<!-- allreduce_expert_2_5 -->
<g id="node1100" class="node">
<title>allreduce_expert_2_5</title>
<polygon fill="red" stroke="black" points="16310.57,-3877.05 16155.57,-3824.05 16310.57,-3771.05 16465.57,-3824.05 16310.57,-3877.05"/>
<text text-anchor="middle" x="16310.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 5</text>
<text text-anchor="middle" x="16310.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="16310.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 10&#45;11</text>
</g>
<!-- expert_2_5_fc2_10&#45;&gt;allreduce_expert_2_5 -->
<g id="edge1325" class="edge">
<title>expert_2_5_fc2_10&#45;&gt;allreduce_expert_2_5</title>
<path fill="none" stroke="black" d="M16204.88,-3918.44C16222.55,-3902.83 16242.58,-3885.13 16260.41,-3869.37"/>
<polygon fill="black" stroke="black" points="16262.73,-3871.99 16267.91,-3862.75 16258.1,-3866.74 16262.73,-3871.99"/>
</g>
<!-- combine_experts_2_10 -->
<g id="node1123" class="node">
<title>combine_experts_2_10</title>
<polygon fill="purple" stroke="black" points="16285.57,-3734.05 16038.57,-3681.05 16285.57,-3628.05 16532.57,-3681.05 16285.57,-3734.05"/>
<text text-anchor="middle" x="16285.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16285.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16285.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_5&#45;&gt;combine_experts_2_10 -->
<g id="edge1351" class="edge">
<title>allreduce_expert_2_5&#45;&gt;combine_experts_2_10</title>
<path fill="none" stroke="black" d="M16301.83,-3773.73C16300.04,-3763.62 16298.13,-3752.87 16296.28,-3742.42"/>
<polygon fill="black" stroke="black" points="16299.72,-3741.76 16294.52,-3732.53 16292.82,-3742.98 16299.72,-3741.76"/>
</g>
<!-- combine_experts_2_11 -->
<g id="node1124" class="node">
<title>combine_experts_2_11</title>
<polygon fill="purple" stroke="black" points="16797.57,-3734.05 16550.57,-3681.05 16797.57,-3628.05 17044.57,-3681.05 16797.57,-3734.05"/>
<text text-anchor="middle" x="16797.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16797.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16797.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_5&#45;&gt;combine_experts_2_11 -->
<g id="edge1352" class="edge">
<title>allreduce_expert_2_5&#45;&gt;combine_experts_2_11</title>
<path fill="none" stroke="black" d="M16393.19,-3799.13C16473.23,-3775.95 16595.24,-3740.63 16684.32,-3714.84"/>
<polygon fill="black" stroke="black" points="16685.56,-3718.12 16694.19,-3711.98 16683.61,-3711.4 16685.56,-3718.12"/>
</g>
<!-- expert_2_5_fc2_11 -->
<g id="node1102" class="node">
<title>expert_2_5_fc2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16405.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16405.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16405.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16405.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16405.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_5_gelu_11&#45;&gt;expert_2_5_fc2_11 -->
<g id="edge1327" class="edge">
<title>expert_2_5_gelu_11&#45;&gt;expert_2_5_fc2_11</title>
<path fill="none" stroke="black" d="M16416.03,-4047.21C16414.98,-4038.75 16413.83,-4029.54 16412.7,-4020.43"/>
<polygon fill="black" stroke="black" points="16416.14,-4019.71 16411.43,-4010.22 16409.19,-4020.57 16416.14,-4019.71"/>
</g>
<!-- expert_2_5_fc2_11&#45;&gt;allreduce_expert_2_5 -->
<g id="edge1328" class="edge">
<title>expert_2_5_fc2_11&#45;&gt;allreduce_expert_2_5</title>
<path fill="none" stroke="black" d="M16373.94,-3915.82C16365,-3903 16355.2,-3888.98 16346.05,-3875.86"/>
<polygon fill="black" stroke="black" points="16348.74,-3873.6 16340.14,-3867.4 16343,-3877.6 16348.74,-3873.6"/>
</g>
<!-- expert_2_6_fc2_12 -->
<g id="node1104" class="node">
<title>expert_2_6_fc2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="17026.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17026.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17026.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17026.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17026.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_6_gelu_12&#45;&gt;expert_2_6_fc2_12 -->
<g id="edge1330" class="edge">
<title>expert_2_6_gelu_12&#45;&gt;expert_2_6_fc2_12</title>
<path fill="none" stroke="black" d="M16991.71,-4047.21C16995.38,-4038.37 16999.38,-4028.72 17003.32,-4019.21"/>
<polygon fill="black" stroke="black" points="17006.63,-4020.36 17007.23,-4009.78 17000.17,-4017.68 17006.63,-4020.36"/>
</g>
<!-- allreduce_expert_2_6 -->
<g id="node1105" class="node">
<title>allreduce_expert_2_6</title>
<polygon fill="red" stroke="black" points="17309.57,-3877.05 17154.57,-3824.05 17309.57,-3771.05 17464.57,-3824.05 17309.57,-3877.05"/>
<text text-anchor="middle" x="17309.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 6</text>
<text text-anchor="middle" x="17309.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="17309.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 12&#45;13</text>
</g>
<!-- expert_2_6_fc2_12&#45;&gt;allreduce_expert_2_6 -->
<g id="edge1331" class="edge">
<title>expert_2_6_fc2_12&#45;&gt;allreduce_expert_2_6</title>
<path fill="none" stroke="black" d="M17100.19,-3925.73C17142.3,-3905.48 17194.92,-3880.18 17236.88,-3860"/>
<polygon fill="black" stroke="black" points="17238.44,-3863.13 17245.94,-3855.65 17235.41,-3856.83 17238.44,-3863.13"/>
</g>
<!-- combine_experts_2_12 -->
<g id="node1125" class="node">
<title>combine_experts_2_12</title>
<polygon fill="purple" stroke="black" points="17309.57,-3734.05 17062.57,-3681.05 17309.57,-3628.05 17556.57,-3681.05 17309.57,-3734.05"/>
<text text-anchor="middle" x="17309.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17309.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17309.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_6&#45;&gt;combine_experts_2_12 -->
<g id="edge1353" class="edge">
<title>allreduce_expert_2_6&#45;&gt;combine_experts_2_12</title>
<path fill="none" stroke="black" d="M17309.57,-3770.94C17309.57,-3762.37 17309.57,-3753.41 17309.57,-3744.62"/>
<polygon fill="black" stroke="black" points="17313.07,-3744.4 17309.57,-3734.4 17306.07,-3744.41 17313.07,-3744.4"/>
</g>
<!-- combine_experts_2_13 -->
<g id="node1126" class="node">
<title>combine_experts_2_13</title>
<polygon fill="purple" stroke="black" points="17821.57,-3734.05 17574.57,-3681.05 17821.57,-3628.05 18068.57,-3681.05 17821.57,-3734.05"/>
<text text-anchor="middle" x="17821.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17821.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17821.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_6&#45;&gt;combine_experts_2_13 -->
<g id="edge1354" class="edge">
<title>allreduce_expert_2_6&#45;&gt;combine_experts_2_13</title>
<path fill="none" stroke="black" d="M17393.83,-3799.84C17478.69,-3776.47 17610.26,-3740.24 17705.07,-3714.13"/>
<polygon fill="black" stroke="black" points="17706.29,-3717.42 17715,-3711.4 17704.43,-3710.68 17706.29,-3717.42"/>
</g>
<!-- expert_2_6_fc2_13 -->
<g id="node1107" class="node">
<title>expert_2_6_fc2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17287.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17287.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17287.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17287.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17287.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_6_gelu_13&#45;&gt;expert_2_6_fc2_13 -->
<g id="edge1333" class="edge">
<title>expert_2_6_gelu_13&#45;&gt;expert_2_6_fc2_13</title>
<path fill="none" stroke="black" d="M17274.33,-4047.21C17275.67,-4038.65 17277.14,-4029.34 17278.59,-4020.13"/>
<polygon fill="black" stroke="black" points="17282.05,-4020.64 17280.15,-4010.22 17275.14,-4019.55 17282.05,-4020.64"/>
</g>
<!-- expert_2_6_fc2_13&#45;&gt;allreduce_expert_2_6 -->
<g id="edge1334" class="edge">
<title>expert_2_6_fc2_13&#45;&gt;allreduce_expert_2_6</title>
<path fill="none" stroke="black" d="M17295.21,-3913.92C17296.74,-3904.46 17298.36,-3894.41 17299.95,-3884.59"/>
<polygon fill="black" stroke="black" points="17303.44,-3884.92 17301.58,-3874.49 17296.53,-3883.8 17303.44,-3884.92"/>
</g>
<!-- expert_2_7_fc2_14 -->
<g id="node1109" class="node">
<title>expert_2_7_fc2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="18073.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18073.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18073.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18073.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18073.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_7_gelu_14&#45;&gt;expert_2_7_fc2_14 -->
<g id="edge1336" class="edge">
<title>expert_2_7_gelu_14&#45;&gt;expert_2_7_fc2_14</title>
<path fill="none" stroke="black" d="M17911.66,-4051.87C17937.62,-4037.64 17968.59,-4020.67 17996.46,-4005.4"/>
<polygon fill="black" stroke="black" points="17998.3,-4008.38 18005.38,-4000.5 17994.93,-4002.24 17998.3,-4008.38"/>
</g>
<!-- allreduce_expert_2_7 -->
<g id="node1110" class="node">
<title>allreduce_expert_2_7</title>
<polygon fill="red" stroke="black" points="18326.57,-3877.05 18171.57,-3824.05 18326.57,-3771.05 18481.57,-3824.05 18326.57,-3877.05"/>
<text text-anchor="middle" x="18326.57" y="-3835.35" font-family="Times,serif" font-size="14.00">AllReduce Expert 7</text>
<text text-anchor="middle" x="18326.57" y="-3820.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="18326.57" y="-3805.35" font-family="Times,serif" font-size="14.00">GPUs 14&#45;15</text>
</g>
<!-- expert_2_7_fc2_14&#45;&gt;allreduce_expert_2_7 -->
<g id="edge1337" class="edge">
<title>expert_2_7_fc2_14&#45;&gt;allreduce_expert_2_7</title>
<path fill="none" stroke="black" d="M18142.71,-3923.94C18178.72,-3904.57 18222.6,-3880.97 18258.46,-3861.68"/>
<polygon fill="black" stroke="black" points="18260.25,-3864.7 18267.4,-3856.88 18256.93,-3858.53 18260.25,-3864.7"/>
</g>
<!-- combine_experts_2_14 -->
<g id="node1127" class="node">
<title>combine_experts_2_14</title>
<polygon fill="purple" stroke="black" points="18333.57,-3734.05 18086.57,-3681.05 18333.57,-3628.05 18580.57,-3681.05 18333.57,-3734.05"/>
<text text-anchor="middle" x="18333.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18333.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18333.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_7&#45;&gt;combine_experts_2_14 -->
<g id="edge1355" class="edge">
<title>allreduce_expert_2_7&#45;&gt;combine_experts_2_14</title>
<path fill="none" stroke="black" d="M18329.12,-3771.74C18329.57,-3762.61 18330.05,-3753 18330.52,-3743.62"/>
<polygon fill="black" stroke="black" points="18334.02,-3743.71 18331.02,-3733.55 18327.03,-3743.36 18334.02,-3743.71"/>
</g>
<!-- combine_experts_2_15 -->
<g id="node1128" class="node">
<title>combine_experts_2_15</title>
<polygon fill="purple" stroke="black" points="18845.57,-3734.05 18598.57,-3681.05 18845.57,-3628.05 19092.57,-3681.05 18845.57,-3734.05"/>
<text text-anchor="middle" x="18845.57" y="-3692.35" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18845.57" y="-3677.35" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18845.57" y="-3662.35" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_2_7&#45;&gt;combine_experts_2_15 -->
<g id="edge1356" class="edge">
<title>allreduce_expert_2_7&#45;&gt;combine_experts_2_15</title>
<path fill="none" stroke="black" d="M18411.4,-3800C18497.68,-3776.56 18632.04,-3740.06 18728.44,-3713.87"/>
<polygon fill="black" stroke="black" points="18729.5,-3717.21 18738.23,-3711.21 18727.66,-3710.45 18729.5,-3717.21"/>
</g>
<!-- expert_2_7_fc2_15 -->
<g id="node1112" class="node">
<title>expert_2_7_fc2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18322.57" cy="-3962.13" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18322.57" y="-3980.93" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18322.57" y="-3965.93" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18322.57" y="-3950.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18322.57" y="-3935.93" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_2_7_gelu_15&#45;&gt;expert_2_7_fc2_15 -->
<g id="edge1339" class="edge">
<title>expert_2_7_gelu_15&#45;&gt;expert_2_7_fc2_15</title>
<path fill="none" stroke="black" d="M18222.69,-4049.16C18236.05,-4037.65 18251.2,-4024.6 18265.59,-4012.21"/>
<polygon fill="black" stroke="black" points="18268.2,-4014.58 18273.49,-4005.4 18263.63,-4009.28 18268.2,-4014.58"/>
</g>
<!-- expert_2_7_fc2_15&#45;&gt;allreduce_expert_2_7 -->
<g id="edge1340" class="edge">
<title>expert_2_7_fc2_15&#45;&gt;allreduce_expert_2_7</title>
<path fill="none" stroke="black" d="M18323.96,-3913.92C18324.22,-3905.21 18324.49,-3896.01 18324.75,-3886.95"/>
<polygon fill="black" stroke="black" points="18328.26,-3886.92 18325.05,-3876.82 18321.26,-3886.72 18328.26,-3886.92"/>
</g>
<!-- allreduce_moe_2 -->
<g id="node1129" class="node">
<title>allreduce_moe_2</title>
<polygon fill="red" stroke="black" points="14883.57,-3591.05 14758.57,-3538.05 14883.57,-3485.05 15008.57,-3538.05 14883.57,-3591.05"/>
<text text-anchor="middle" x="14883.57" y="-3549.35" font-family="Times,serif" font-size="14.00">AllReduce MoE</text>
<text text-anchor="middle" x="14883.57" y="-3534.35" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14883.57" y="-3519.35" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- combine_experts_2_0&#45;&gt;allreduce_moe_2 -->
<g id="edge1357" class="edge">
<title>combine_experts_2_0&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M11279.59,-3652.46C11323.67,-3642.96 11374.71,-3633.38 11421.57,-3628.05 11740.07,-3591.78 11822.13,-3617.36 12142.57,-3609.05 13151.09,-3582.88 14368.35,-3552.06 14757.53,-3542.23"/>
<polygon fill="black" stroke="black" points="14757.78,-3545.72 14767.69,-3541.97 14757.6,-3538.73 14757.78,-3545.72"/>
</g>
<!-- combine_experts_2_1&#45;&gt;allreduce_moe_2 -->
<g id="edge1358" class="edge">
<title>combine_experts_2_1&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M11791.92,-3652.49C11835.93,-3643.02 11886.83,-3633.46 11933.57,-3628.05 12491.37,-3563.46 14256.45,-3544.23 14752.66,-3540.03"/>
<polygon fill="black" stroke="black" points="14752.76,-3543.53 14762.73,-3539.95 14752.7,-3536.53 14752.76,-3543.53"/>
</g>
<!-- combine_experts_2_2&#45;&gt;allreduce_moe_2 -->
<g id="edge1359" class="edge">
<title>combine_experts_2_2&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M12304.25,-3652.58C12348.2,-3643.15 12398.96,-3633.59 12445.57,-3628.05 12899.12,-3574.07 14318.91,-3547.87 14754.92,-3540.96"/>
<polygon fill="black" stroke="black" points="14755.1,-3544.46 14765.04,-3540.8 14754.99,-3537.46 14755.1,-3544.46"/>
</g>
<!-- combine_experts_2_3&#45;&gt;allreduce_moe_2 -->
<g id="edge1360" class="edge">
<title>combine_experts_2_3&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M12816.92,-3652.68C12860.72,-3643.33 12911.22,-3633.79 12957.57,-3628.05 13626.12,-3545.2 14433.82,-3537.61 14748.72,-3538.15"/>
<polygon fill="black" stroke="black" points="14748.79,-3541.65 14758.8,-3538.17 14748.81,-3534.65 14748.79,-3541.65"/>
</g>
<!-- combine_experts_2_4&#45;&gt;allreduce_moe_2 -->
<g id="edge1361" class="edge">
<title>combine_experts_2_4&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M13329.93,-3652.89C13373.51,-3643.65 13423.6,-3634.13 13469.57,-3628.05 13940.67,-3565.67 14506.04,-3546.75 14755.09,-3541.23"/>
<polygon fill="black" stroke="black" points="14755.34,-3544.72 14765.26,-3541 14755.18,-3537.72 14755.34,-3544.72"/>
</g>
<!-- combine_experts_2_5&#45;&gt;allreduce_moe_2 -->
<g id="edge1362" class="edge">
<title>combine_experts_2_5&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M13843.98,-3653.37C13887.12,-3644.35 13936.39,-3634.85 13981.57,-3628.05 14262.1,-3585.83 14594.86,-3558.93 14767.15,-3546.72"/>
<polygon fill="black" stroke="black" points="14767.53,-3550.2 14777.26,-3546 14767.04,-3543.22 14767.53,-3550.2"/>
</g>
<!-- combine_experts_2_6&#45;&gt;allreduce_moe_2 -->
<g id="edge1363" class="edge">
<title>combine_experts_2_6&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M14357.95,-3653.77C14483.74,-3626.32 14678.31,-3583.85 14792.09,-3559.01"/>
<polygon fill="black" stroke="black" points="14793.14,-3562.37 14802.17,-3556.81 14791.65,-3555.53 14793.14,-3562.37"/>
</g>
<!-- combine_experts_2_7&#45;&gt;allreduce_moe_2 -->
<g id="edge1364" class="edge">
<title>combine_experts_2_7&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M14790.87,-3636.59C14806.74,-3619.89 14824.88,-3600.8 14840.88,-3583.97"/>
<polygon fill="black" stroke="black" points="14843.71,-3586.07 14848.07,-3576.41 14838.64,-3581.25 14843.71,-3586.07"/>
</g>
<!-- combine_experts_2_8&#45;&gt;allreduce_moe_2 -->
<g id="edge1365" class="edge">
<title>combine_experts_2_8&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M15172.95,-3646.99C15107.81,-3622.69 15020.25,-3590.03 14958.57,-3567.02"/>
<polygon fill="black" stroke="black" points="14959.49,-3563.63 14948.89,-3563.41 14957.04,-3570.19 14959.49,-3563.63"/>
</g>
<!-- combine_experts_2_9&#45;&gt;allreduce_moe_2 -->
<g id="edge1366" class="edge">
<title>combine_experts_2_9&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M15652.75,-3653.93C15610.14,-3645.14 15561.83,-3635.64 15517.57,-3628.05 15332.39,-3596.27 15115.32,-3567.65 14989.22,-3551.88"/>
<polygon fill="black" stroke="black" points="14989.54,-3548.39 14979.18,-3550.62 14988.67,-3555.33 14989.54,-3548.39"/>
</g>
<!-- combine_experts_2_10&#45;&gt;allreduce_moe_2 -->
<g id="edge1367" class="edge">
<title>combine_experts_2_10&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M16168.53,-3653.12C16125.09,-3643.96 16075.27,-3634.44 16029.57,-3628.05 15659.39,-3576.27 15217.41,-3552.62 15006.87,-3543.65"/>
<polygon fill="black" stroke="black" points="15006.85,-3540.14 14996.71,-3543.22 15006.56,-3547.14 15006.85,-3540.14"/>
</g>
<!-- combine_experts_2_11&#45;&gt;allreduce_moe_2 -->
<g id="edge1368" class="edge">
<title>combine_experts_2_11&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M16681.88,-3652.8C16638.16,-3643.49 16587.8,-3633.95 16541.57,-3628.05 15977.03,-3555.95 15297.1,-3542.12 15015.55,-3539.57"/>
<polygon fill="black" stroke="black" points="15015.33,-3536.07 15005.3,-3539.48 15015.27,-3543.07 15015.33,-3536.07"/>
</g>
<!-- combine_experts_2_12&#45;&gt;allreduce_moe_2 -->
<g id="edge1369" class="edge">
<title>combine_experts_2_12&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M17194.56,-3652.62C17150.69,-3643.23 17100.06,-3633.68 17053.57,-3628.05 16654.28,-3579.62 15413.36,-3550.09 15010.96,-3541.6"/>
<polygon fill="black" stroke="black" points="15010.81,-3538.1 15000.74,-3541.39 15010.66,-3545.1 15010.81,-3538.1"/>
</g>
<!-- combine_experts_2_13&#45;&gt;allreduce_moe_2 -->
<g id="edge1370" class="edge">
<title>combine_experts_2_13&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M17707.22,-3652.56C17663.21,-3643.11 17612.31,-3633.53 17565.57,-3628.05 17062.48,-3569.02 15478.87,-3546.05 15013.43,-3540.48"/>
<polygon fill="black" stroke="black" points="15013.36,-3536.98 15003.31,-3540.36 15013.27,-3543.98 15013.36,-3536.98"/>
</g>
<!-- combine_experts_2_14&#45;&gt;allreduce_moe_2 -->
<g id="edge1371" class="edge">
<title>combine_experts_2_14&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M18219.55,-3652.5C18175.47,-3643.01 18124.43,-3633.42 18077.57,-3628.05 17469.86,-3558.39 15538.83,-3542.7 15015.49,-3539.69"/>
<polygon fill="black" stroke="black" points="15015.27,-3536.18 15005.25,-3539.63 15015.23,-3543.18 15015.27,-3536.18"/>
</g>
<!-- combine_experts_2_15&#45;&gt;allreduce_moe_2 -->
<g id="edge1372" class="edge">
<title>combine_experts_2_15&#45;&gt;allreduce_moe_2</title>
<path fill="none" stroke="black" d="M18731.56,-3652.48C18687.47,-3642.99 18636.43,-3633.4 18589.57,-3628.05 18280.36,-3592.71 18200.7,-3616.89 17889.57,-3609.05 16773.67,-3580.91 15424.65,-3550.94 15010.54,-3541.83"/>
<polygon fill="black" stroke="black" points="15010.41,-3538.32 15000.33,-3541.6 15010.25,-3545.32 15010.41,-3538.32"/>
</g>
<!-- residual2_2 -->
<g id="node1130" class="node">
<title>residual2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="14883.57" cy="-3410.55" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="14883.57" y="-3421.85" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14883.57" y="-3406.85" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14883.57" y="-3391.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_moe_2&#45;&gt;residual2_2 -->
<g id="edge1373" class="edge">
<title>allreduce_moe_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M14883.57,-3484.91C14883.57,-3476.2 14883.57,-3467.2 14883.57,-3458.63"/>
<polygon fill="black" stroke="black" points="14887.07,-3458.42 14883.57,-3448.42 14880.07,-3458.42 14887.07,-3458.42"/>
</g>
<!-- ln1_3_0 -->
<g id="node1131" class="node">
<title>ln1_3_0</title>
<ellipse fill="lightgreen" stroke="black" cx="11851.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11851.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11851.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11851.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_0 -->
<g id="edge1374" class="edge">
<title>residual2_2&#45;&gt;ln1_3_0</title>
<path fill="none" stroke="black" d="M14728.12,-3408.23C14217.92,-3403.5 12597.43,-3384.89 12076.57,-3336.05 12044.93,-3333.08 12011,-3328.38 11979.33,-3323.33"/>
<polygon fill="black" stroke="black" points="11979.56,-3319.82 11969.13,-3321.68 11978.44,-3326.73 11979.56,-3319.82"/>
</g>
<!-- ln1_3_1 -->
<g id="node1132" class="node">
<title>ln1_3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12234.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12234.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12234.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12234.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_1 -->
<g id="edge1375" class="edge">
<title>residual2_2&#45;&gt;ln1_3_1</title>
<path fill="none" stroke="black" d="M14728.8,-3406.79C14370.54,-3399.87 13456.53,-3379.16 12693.57,-3336.05 12589.91,-3330.19 12473.29,-3320.88 12383.54,-3313.13"/>
<polygon fill="black" stroke="black" points="12383.82,-3309.64 12373.56,-3312.26 12383.22,-3316.61 12383.82,-3309.64"/>
</g>
<!-- ln1_3_2 -->
<g id="node1133" class="node">
<title>ln1_3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="12851.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12851.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12851.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12851.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_2 -->
<g id="edge1376" class="edge">
<title>residual2_2&#45;&gt;ln1_3_2</title>
<path fill="none" stroke="black" d="M14728.79,-3406.85C14426.67,-3400.74 13737.39,-3382.53 13159.57,-3336.05 13104.49,-3331.61 13044.06,-3324.87 12991.44,-3318.38"/>
<polygon fill="black" stroke="black" points="12991.72,-3314.89 12981.36,-3317.13 12990.86,-3321.83 12991.72,-3314.89"/>
</g>
<!-- ln1_3_3 -->
<g id="node1134" class="node">
<title>ln1_3_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13317.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13317.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13317.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13317.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_3 -->
<g id="edge1377" class="edge">
<title>residual2_2&#45;&gt;ln1_3_3</title>
<path fill="none" stroke="black" d="M14728.98,-3406.05C14480.16,-3399.3 13975.69,-3380.95 13550.57,-3336.05 13517.27,-3332.53 13481.46,-3327.53 13448.15,-3322.36"/>
<polygon fill="black" stroke="black" points="13448.32,-3318.85 13437.9,-3320.75 13447.24,-3325.76 13448.32,-3318.85"/>
</g>
<!-- ln1_3_4 -->
<g id="node1135" class="node">
<title>ln1_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13708.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13708.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13708.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13708.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_4 -->
<g id="edge1378" class="edge">
<title>residual2_2&#45;&gt;ln1_3_4</title>
<path fill="none" stroke="black" d="M14730.85,-3403.25C14537.78,-3394.1 14195.49,-3373.94 13904.57,-3336.05 13881.04,-3332.98 13856.06,-3328.94 13832.09,-3324.67"/>
<polygon fill="black" stroke="black" points="13832.71,-3321.22 13822.25,-3322.89 13831.46,-3328.11 13832.71,-3321.22"/>
</g>
<!-- ln1_3_5 -->
<g id="node1136" class="node">
<title>ln1_3_5</title>
<ellipse fill="lightgreen" stroke="black" cx="14062.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14062.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14062.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="14062.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_5 -->
<g id="edge1379" class="edge">
<title>residual2_2&#45;&gt;ln1_3_5</title>
<path fill="none" stroke="black" d="M14738.88,-3396.78C14608.02,-3384.34 14410.28,-3363.33 14239.57,-3336.05 14221.11,-3333.09 14201.64,-3329.54 14182.65,-3325.82"/>
<polygon fill="black" stroke="black" points="14183.25,-3322.37 14172.76,-3323.86 14181.89,-3329.24 14183.25,-3322.37"/>
</g>
<!-- ln1_3_6 -->
<g id="node1137" class="node">
<title>ln1_3_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14397.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14397.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14397.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14397.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_6 -->
<g id="edge1380" class="edge">
<title>residual2_2&#45;&gt;ln1_3_6</title>
<path fill="none" stroke="black" d="M14772.08,-3384.31C14695.62,-3367 14594.3,-3344.07 14516.33,-3326.43"/>
<polygon fill="black" stroke="black" points="14516.99,-3322.98 14506.46,-3324.19 14515.44,-3329.81 14516.99,-3322.98"/>
</g>
<!-- ln1_3_7 -->
<g id="node1138" class="node">
<title>ln1_3_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14722.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14722.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14722.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14722.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_7 -->
<g id="edge1381" class="edge">
<title>residual2_2&#45;&gt;ln1_3_7</title>
<path fill="none" stroke="black" d="M14833.07,-3375.04C14816.74,-3363.88 14798.48,-3351.41 14781.59,-3339.87"/>
<polygon fill="black" stroke="black" points="14783.13,-3336.68 14772.89,-3333.93 14779.18,-3342.46 14783.13,-3336.68"/>
</g>
<!-- ln1_3_8 -->
<g id="node1139" class="node">
<title>ln1_3_8</title>
<ellipse fill="lightgreen" stroke="black" cx="15162.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15162.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15162.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15162.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_8 -->
<g id="edge1382" class="edge">
<title>residual2_2&#45;&gt;ln1_3_8</title>
<path fill="none" stroke="black" d="M14963.15,-3378.17C14997.9,-3364.47 15038.76,-3348.36 15074.43,-3334.3"/>
<polygon fill="black" stroke="black" points="15075.84,-3337.51 15083.86,-3330.58 15073.27,-3330.99 15075.84,-3337.51"/>
</g>
<!-- ln1_3_9 -->
<g id="node1140" class="node">
<title>ln1_3_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15843.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15843.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15843.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15843.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_9 -->
<g id="edge1383" class="edge">
<title>residual2_2&#45;&gt;ln1_3_9</title>
<path fill="none" stroke="black" d="M15022.4,-3393.64C15202.83,-3372.96 15516.4,-3337.03 15699.42,-3316.06"/>
<polygon fill="black" stroke="black" points="15699.85,-3319.54 15709.38,-3314.92 15699.05,-3312.58 15699.85,-3319.54"/>
</g>
<!-- ln1_3_10 -->
<g id="node1141" class="node">
<title>ln1_3_10</title>
<ellipse fill="lightgreen" stroke="black" cx="16341.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16341.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16341.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16341.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_10 -->
<g id="edge1384" class="edge">
<title>residual2_2&#45;&gt;ln1_3_10</title>
<path fill="none" stroke="black" d="M15034.72,-3401.59C15249.72,-3389.83 15656.14,-3365.93 16001.57,-3336.05 16066,-3330.47 16137.17,-3323.03 16197.66,-3316.32"/>
<polygon fill="black" stroke="black" points="16198.11,-3319.8 16207.67,-3315.21 16197.34,-3312.84 16198.11,-3319.8"/>
</g>
<!-- ln1_3_11 -->
<g id="node1142" class="node">
<title>ln1_3_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16748.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16748.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16748.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16748.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_11 -->
<g id="edge1385" class="edge">
<title>residual2_2&#45;&gt;ln1_3_11</title>
<path fill="none" stroke="black" d="M15038.81,-3407.65C15327.19,-3402.98 15964.9,-3387.26 16499.57,-3336.05 16537.5,-3332.41 16578.48,-3327.02 16616.04,-3321.49"/>
<polygon fill="black" stroke="black" points="16616.64,-3324.93 16626.02,-3320 16615.61,-3318.01 16616.64,-3324.93"/>
</g>
<!-- ln1_3_12 -->
<g id="node1143" class="node">
<title>ln1_3_12</title>
<ellipse fill="lightgreen" stroke="black" cx="17131.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17131.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17131.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17131.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_12 -->
<g id="edge1386" class="edge">
<title>residual2_2&#45;&gt;ln1_3_12</title>
<path fill="none" stroke="black" d="M15039.15,-3410.48C15378.95,-3411.07 16212.56,-3404.68 16906.57,-3336.05 16938.02,-3332.94 16971.74,-3328.21 17003.26,-3323.19"/>
<polygon fill="black" stroke="black" points="17004.1,-3326.6 17013.41,-3321.55 17002.98,-3319.69 17004.1,-3326.6"/>
</g>
<!-- ln1_3_13 -->
<g id="node1144" class="node">
<title>ln1_3_13</title>
<ellipse fill="lightgreen" stroke="black" cx="17481.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17481.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17481.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17481.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_13 -->
<g id="edge1387" class="edge">
<title>residual2_2&#45;&gt;ln1_3_13</title>
<path fill="none" stroke="black" d="M15037.69,-3405.14C15352.81,-3396.08 16093.61,-3374.59 16715.57,-3355.05 16970.7,-3347.03 17035.88,-3364.19 17289.57,-3336.05 17312.66,-3333.48 17337.14,-3329.68 17360.6,-3325.49"/>
<polygon fill="black" stroke="black" points="17361.38,-3328.9 17370.59,-3323.67 17360.12,-3322.02 17361.38,-3328.9"/>
</g>
<!-- ln1_3_14 -->
<g id="node1145" class="node">
<title>ln1_3_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17814.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17814.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17814.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17814.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_14 -->
<g id="edge1388" class="edge">
<title>residual2_2&#45;&gt;ln1_3_14</title>
<path fill="none" stroke="black" d="M15039.37,-3409.06C15544.01,-3406.9 17130.43,-3395.45 17639.57,-3336.05 17658.69,-3333.82 17678.82,-3330.52 17698.34,-3326.81"/>
<polygon fill="black" stroke="black" points="17699.03,-3330.25 17708.18,-3324.9 17697.7,-3323.38 17699.03,-3330.25"/>
</g>
<!-- ln1_3_15 -->
<g id="node1146" class="node">
<title>ln1_3_15</title>
<ellipse fill="lightgreen" stroke="black" cx="18138.57" cy="-3298.55" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="18138.57" y="-3309.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18138.57" y="-3294.85" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18138.57" y="-3279.85" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3_15 -->
<g id="edge1389" class="edge">
<title>residual2_2&#45;&gt;ln1_3_15</title>
<path fill="none" stroke="black" d="M15038.58,-3407.02C15437.25,-3400.37 16530.78,-3381.04 17441.57,-3355.05 17677.63,-3348.31 17738.3,-3365.75 17972.57,-3336.05 17989.46,-3333.91 18007.16,-3330.88 18024.46,-3327.47"/>
<polygon fill="black" stroke="black" points="18025.48,-3330.83 18034.58,-3325.42 18024.09,-3323.97 18025.48,-3330.83"/>
</g>
<!-- qkv_proj_3_0 -->
<g id="node1147" class="node">
<title>qkv_proj_3_0</title>
<ellipse fill="orange" stroke="black" cx="8875.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="8875.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8875.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8875.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(0,0)</text>
<text text-anchor="middle" x="8875.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="8875.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_0&#45;&gt;qkv_proj_3_0 -->
<g id="edge1390" class="edge">
<title>ln1_3_0&#45;&gt;qkv_proj_3_0</title>
<path fill="none" stroke="black" d="M11704.46,-3292.17C11393.16,-3280.68 10644.89,-3252.46 10017.57,-3224.05 9663.26,-3208 9247.26,-3186.25 9028.26,-3174.58"/>
<polygon fill="black" stroke="black" points="9028.15,-3171.07 9017.98,-3174.03 9027.78,-3178.06 9028.15,-3171.07"/>
</g>
<!-- qkv_proj_3_1 -->
<g id="node1148" class="node">
<title>qkv_proj_3_1</title>
<ellipse fill="orange" stroke="black" cx="10170.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="10170.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10170.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="10170.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(0,1)</text>
<text text-anchor="middle" x="10170.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="10170.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_1&#45;&gt;qkv_proj_3_1 -->
<g id="edge1391" class="edge">
<title>ln1_3_1&#45;&gt;qkv_proj_3_1</title>
<path fill="none" stroke="black" d="M12116.11,-3275.65C12081.84,-3270.05 12044.32,-3264.6 12009.57,-3261.05 11631.2,-3222.3 11534.44,-3243.4 11154.57,-3224.05 10859.91,-3209.03 10515.81,-3188.07 10322.53,-3175.99"/>
<polygon fill="black" stroke="black" points="10322.5,-3172.48 10312.3,-3175.35 10322.07,-3179.47 10322.5,-3172.48"/>
</g>
<!-- qkv_proj_3_2 -->
<g id="node1149" class="node">
<title>qkv_proj_3_2</title>
<ellipse fill="orange" stroke="black" cx="11307.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="11307.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11307.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11307.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(0,2)</text>
<text text-anchor="middle" x="11307.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11307.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_2&#45;&gt;qkv_proj_3_2 -->
<g id="edge1392" class="edge">
<title>ln1_3_2&#45;&gt;qkv_proj_3_2</title>
<path fill="none" stroke="black" d="M12711.49,-3285.64C12421.26,-3260.98 11756.51,-3204.5 11457.79,-3179.12"/>
<polygon fill="black" stroke="black" points="11458.02,-3175.63 11447.76,-3178.27 11457.42,-3182.6 11458.02,-3175.63"/>
</g>
<!-- qkv_proj_3_3 -->
<g id="node1150" class="node">
<title>qkv_proj_3_3</title>
<ellipse fill="orange" stroke="black" cx="12358.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="12358.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12358.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12358.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(0,3)</text>
<text text-anchor="middle" x="12358.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12358.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_3&#45;&gt;qkv_proj_3_3 -->
<g id="edge1393" class="edge">
<title>ln1_3_3&#45;&gt;qkv_proj_3_3</title>
<path fill="none" stroke="black" d="M13188.24,-3279.85C13010.15,-3255.49 12690.35,-3211.74 12504.1,-3186.26"/>
<polygon fill="black" stroke="black" points="12504.34,-3182.76 12493.96,-3184.88 12503.39,-3189.7 12504.34,-3182.76"/>
</g>
<!-- qkv_proj_3_4 -->
<g id="node1151" class="node">
<title>qkv_proj_3_4</title>
<ellipse fill="orange" stroke="black" cx="13392.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13392.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13392.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13392.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(1,0)</text>
<text text-anchor="middle" x="13392.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13392.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_4&#45;&gt;qkv_proj_3_4 -->
<g id="edge1394" class="edge">
<title>ln1_3_4&#45;&gt;qkv_proj_3_4</title>
<path fill="none" stroke="black" d="M13632.88,-3266.12C13593.59,-3249.81 13544.87,-3229.58 13501.59,-3211.62"/>
<polygon fill="black" stroke="black" points="13502.74,-3208.3 13492.16,-3207.7 13500.05,-3214.77 13502.74,-3208.3"/>
</g>
<!-- qkv_proj_3_5 -->
<g id="node1152" class="node">
<title>qkv_proj_3_5</title>
<ellipse fill="orange" stroke="black" cx="13795.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="13795.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13795.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13795.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(1,1)</text>
<text text-anchor="middle" x="13795.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13795.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_5&#45;&gt;qkv_proj_3_5 -->
<g id="edge1395" class="edge">
<title>ln1_3_5&#45;&gt;qkv_proj_3_5</title>
<path fill="none" stroke="black" d="M13996.23,-3264.95C13965.88,-3250.03 13929.26,-3232.04 13895.67,-3215.54"/>
<polygon fill="black" stroke="black" points="13896.8,-3212.19 13886.28,-3210.92 13893.71,-3218.47 13896.8,-3212.19"/>
</g>
<!-- qkv_proj_3_6 -->
<g id="node1153" class="node">
<title>qkv_proj_3_6</title>
<ellipse fill="orange" stroke="black" cx="14221.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14221.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14221.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14221.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(1,2)</text>
<text text-anchor="middle" x="14221.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14221.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_6&#45;&gt;qkv_proj_3_6 -->
<g id="edge1396" class="edge">
<title>ln1_3_6&#45;&gt;qkv_proj_3_6</title>
<path fill="none" stroke="black" d="M14350.87,-3262.73C14334.62,-3250.62 14315.94,-3236.7 14297.93,-3223.27"/>
<polygon fill="black" stroke="black" points="14299.82,-3220.31 14289.71,-3217.14 14295.63,-3225.92 14299.82,-3220.31"/>
</g>
<!-- qkv_proj_3_7 -->
<g id="node1154" class="node">
<title>qkv_proj_3_7</title>
<ellipse fill="orange" stroke="black" cx="14673.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="14673.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14673.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14673.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(1,3)</text>
<text text-anchor="middle" x="14673.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14673.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_7&#45;&gt;qkv_proj_3_7 -->
<g id="edge1397" class="edge">
<title>ln1_3_7&#45;&gt;qkv_proj_3_7</title>
<path fill="none" stroke="black" d="M14708.92,-3261C14705.7,-3252.36 14702.15,-3242.87 14698.59,-3233.35"/>
<polygon fill="black" stroke="black" points="14701.82,-3231.98 14695.04,-3223.84 14695.26,-3234.43 14701.82,-3231.98"/>
</g>
<!-- qkv_proj_3_8 -->
<g id="node1155" class="node">
<title>qkv_proj_3_8</title>
<ellipse fill="orange" stroke="black" cx="15203.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="15203.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15203.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15203.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(2,0)</text>
<text text-anchor="middle" x="15203.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15203.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_8&#45;&gt;qkv_proj_3_8 -->
<g id="edge1398" class="edge">
<title>ln1_3_8&#45;&gt;qkv_proj_3_8</title>
<path fill="none" stroke="black" d="M15173.99,-3261C15176.67,-3252.45 15179.6,-3243.07 15182.54,-3233.64"/>
<polygon fill="black" stroke="black" points="15185.97,-3234.43 15185.61,-3223.84 15179.29,-3232.34 15185.97,-3234.43"/>
</g>
<!-- qkv_proj_3_9 -->
<g id="node1156" class="node">
<title>qkv_proj_3_9</title>
<ellipse fill="orange" stroke="black" cx="16141.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16141.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16141.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16141.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(2,1)</text>
<text text-anchor="middle" x="16141.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16141.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_9&#45;&gt;qkv_proj_3_9 -->
<g id="edge1399" class="edge">
<title>ln1_3_9&#45;&gt;qkv_proj_3_9</title>
<path fill="none" stroke="black" d="M15916.09,-3265.62C15952.05,-3249.79 15996.17,-3230.37 16035.82,-3212.91"/>
<polygon fill="black" stroke="black" points="16037.25,-3216.11 16044.99,-3208.87 16034.43,-3209.7 16037.25,-3216.11"/>
</g>
<!-- qkv_proj_3_10 -->
<g id="node1157" class="node">
<title>qkv_proj_3_10</title>
<ellipse fill="orange" stroke="black" cx="16457.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16457.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16457.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16457.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(2,2)</text>
<text text-anchor="middle" x="16457.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16457.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_10&#45;&gt;qkv_proj_3_10 -->
<g id="edge1400" class="edge">
<title>ln1_3_10&#45;&gt;qkv_proj_3_10</title>
<path fill="none" stroke="black" d="M16373.27,-3261.7C16382.32,-3251.47 16392.45,-3240.01 16402.47,-3228.68"/>
<polygon fill="black" stroke="black" points="16405.36,-3230.69 16409.37,-3220.88 16400.12,-3226.05 16405.36,-3230.69"/>
</g>
<!-- qkv_proj_3_11 -->
<g id="node1158" class="node">
<title>qkv_proj_3_11</title>
<ellipse fill="orange" stroke="black" cx="16767.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="16767.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16767.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16767.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(2,3)</text>
<text text-anchor="middle" x="16767.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16767.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_11&#45;&gt;qkv_proj_3_11 -->
<g id="edge1401" class="edge">
<title>ln1_3_11&#45;&gt;qkv_proj_3_11</title>
<path fill="none" stroke="black" d="M16753.87,-3261C16755.08,-3252.65 16756.4,-3243.51 16757.73,-3234.31"/>
<polygon fill="black" stroke="black" points="16761.21,-3234.73 16759.18,-3224.34 16754.28,-3233.73 16761.21,-3234.73"/>
</g>
<!-- qkv_proj_3_12 -->
<g id="node1159" class="node">
<title>qkv_proj_3_12</title>
<ellipse fill="orange" stroke="black" cx="17533.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17533.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17533.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17533.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(3,0)</text>
<text text-anchor="middle" x="17533.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17533.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_12&#45;&gt;qkv_proj_3_12 -->
<g id="edge1402" class="edge">
<title>ln1_3_12&#45;&gt;qkv_proj_3_12</title>
<path fill="none" stroke="black" d="M17220.79,-3268.43C17277.22,-3250.02 17350.88,-3225.98 17412.55,-3205.85"/>
<polygon fill="black" stroke="black" points="17413.92,-3209.09 17422.34,-3202.66 17411.74,-3202.43 17413.92,-3209.09"/>
</g>
<!-- qkv_proj_3_13 -->
<g id="node1160" class="node">
<title>qkv_proj_3_13</title>
<ellipse fill="orange" stroke="black" cx="17843.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="17843.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17843.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17843.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(3,1)</text>
<text text-anchor="middle" x="17843.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17843.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_13&#45;&gt;qkv_proj_3_13 -->
<g id="edge1403" class="edge">
<title>ln1_3_13&#45;&gt;qkv_proj_3_13</title>
<path fill="none" stroke="black" d="M17565.91,-3267.48C17602.95,-3254.23 17646.95,-3238.43 17686.57,-3224.05 17700.1,-3219.14 17714.28,-3213.96 17728.34,-3208.82"/>
<polygon fill="black" stroke="black" points="17729.86,-3211.99 17738.05,-3205.26 17727.46,-3205.41 17729.86,-3211.99"/>
</g>
<!-- qkv_proj_3_14 -->
<g id="node1161" class="node">
<title>qkv_proj_3_14</title>
<ellipse fill="orange" stroke="black" cx="18737.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="18737.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18737.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18737.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(3,2)</text>
<text text-anchor="middle" x="18737.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18737.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_14&#45;&gt;qkv_proj_3_14 -->
<g id="edge1404" class="edge">
<title>ln1_3_14&#45;&gt;qkv_proj_3_14</title>
<path fill="none" stroke="black" d="M17921.89,-3272.44C17941.36,-3268.31 17961.53,-3264.32 17980.57,-3261.05 18190.36,-3224.94 18435.11,-3196.85 18588.23,-3180.94"/>
<polygon fill="black" stroke="black" points="18588.59,-3184.42 18598.18,-3179.91 18587.87,-3177.46 18588.59,-3184.42"/>
</g>
<!-- qkv_proj_3_15 -->
<g id="node1162" class="node">
<title>qkv_proj_3_15</title>
<ellipse fill="orange" stroke="black" cx="20560.57" cy="-3165.36" rx="143.59" ry="58.88"/>
<text text-anchor="middle" x="20560.57" y="-3191.66" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20560.57" y="-3176.66" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20560.57" y="-3161.66" font-family="Times,serif" font-size="14.00">Partition(3,3)</text>
<text text-anchor="middle" x="20560.57" y="-3146.66" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20560.57" y="-3131.66" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 3*512]</text>
</g>
<!-- ln1_3_15&#45;&gt;qkv_proj_3_15 -->
<g id="edge1405" class="edge">
<title>ln1_3_15&#45;&gt;qkv_proj_3_15</title>
<path fill="none" stroke="black" d="M18283.73,-3289.68C18712.43,-3266.46 19970.29,-3198.33 20408.18,-3174.61"/>
<polygon fill="black" stroke="black" points="20408.57,-3178.09 20418.37,-3174.06 20408.2,-3171.1 20408.57,-3178.09"/>
</g>
<!-- reshape_qkv_3_0 -->
<g id="node1163" class="node">
<title>reshape_qkv_3_0</title>
<ellipse fill="lightcyan" stroke="black" cx="8131.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="8131.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8131.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8131.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_0&#45;&gt;reshape_qkv_3_0 -->
<g id="edge1406" class="edge">
<title>qkv_proj_3_0&#45;&gt;reshape_qkv_3_0</title>
<path fill="none" stroke="black" d="M8744.27,-3141.2C8609.67,-3117.47 8401.37,-3080.74 8265.73,-3056.82"/>
<polygon fill="black" stroke="black" points="8266.14,-3053.34 8255.69,-3055.05 8264.93,-3060.23 8266.14,-3053.34"/>
</g>
<!-- reshape_qkv_3_1 -->
<g id="node1176" class="node">
<title>reshape_qkv_3_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9094.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9094.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9094.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9094.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_1&#45;&gt;reshape_qkv_3_1 -->
<g id="edge1421" class="edge">
<title>qkv_proj_3_1&#45;&gt;reshape_qkv_3_1</title>
<path fill="none" stroke="black" d="M10033.48,-3147.64C9830.53,-3122.9 9451.68,-3076.71 9242.61,-3051.22"/>
<polygon fill="black" stroke="black" points="9242.83,-3047.72 9232.48,-3049.98 9241.98,-3054.66 9242.83,-3047.72"/>
</g>
<!-- reshape_qkv_3_2 -->
<g id="node1188" class="node">
<title>reshape_qkv_3_2</title>
<ellipse fill="lightcyan" stroke="black" cx="9950.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="9950.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9950.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9950.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_2&#45;&gt;reshape_qkv_3_2 -->
<g id="edge1436" class="edge">
<title>qkv_proj_3_2&#45;&gt;reshape_qkv_3_2</title>
<path fill="none" stroke="black" d="M11168.41,-3150.9C10912.82,-3126.19 10370.49,-3073.76 10104.37,-3048.03"/>
<polygon fill="black" stroke="black" points="10104.53,-3044.53 10094.24,-3047.06 10103.86,-3051.5 10104.53,-3044.53"/>
</g>
<!-- reshape_qkv_3_3 -->
<g id="node1200" class="node">
<title>reshape_qkv_3_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10877.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="10877.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="10877.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10877.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_3&#45;&gt;reshape_qkv_3_3 -->
<g id="edge1451" class="edge">
<title>qkv_proj_3_3&#45;&gt;reshape_qkv_3_3</title>
<path fill="none" stroke="black" d="M12218.58,-3151.95C11941.11,-3127.38 11323.21,-3072.64 11033.35,-3046.97"/>
<polygon fill="black" stroke="black" points="11033.45,-3043.46 11023.18,-3046.06 11032.83,-3050.43 11033.45,-3043.46"/>
</g>
<!-- reshape_qkv_3_4 -->
<g id="node1213" class="node">
<title>reshape_qkv_3_4</title>
<ellipse fill="lightcyan" stroke="black" cx="11874.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="11874.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="11874.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11874.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_4&#45;&gt;reshape_qkv_3_4 -->
<g id="edge1467" class="edge">
<title>qkv_proj_3_4&#45;&gt;reshape_qkv_3_4</title>
<path fill="none" stroke="black" d="M13252.48,-3152.25C12968.54,-3127.71 12327.03,-3072.27 12030.4,-3046.63"/>
<polygon fill="black" stroke="black" points="12030.69,-3043.15 12020.43,-3045.77 12030.09,-3050.12 12030.69,-3043.15"/>
</g>
<!-- reshape_qkv_3_5 -->
<g id="node1226" class="node">
<title>reshape_qkv_3_5</title>
<ellipse fill="lightcyan" stroke="black" cx="12731.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="12731.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="12731.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12731.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_5&#45;&gt;reshape_qkv_3_5 -->
<g id="edge1482" class="edge">
<title>qkv_proj_3_5&#45;&gt;reshape_qkv_3_5</title>
<path fill="none" stroke="black" d="M13675.43,-3133.13C13634.47,-3123.42 13588.24,-3113.48 13545.57,-3106.67 13321.35,-3070.84 13059.38,-3051.09 12894.47,-3041.31"/>
<polygon fill="black" stroke="black" points="12894.43,-3037.8 12884.24,-3040.71 12894.02,-3044.79 12894.43,-3037.8"/>
</g>
<!-- reshape_qkv_3_6 -->
<g id="node1238" class="node">
<title>reshape_qkv_3_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13658.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="13658.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="13658.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13658.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_6&#45;&gt;reshape_qkv_3_6 -->
<g id="edge1497" class="edge">
<title>qkv_proj_3_6&#45;&gt;reshape_qkv_3_6</title>
<path fill="none" stroke="black" d="M14097.67,-3135.48C14002.77,-3113.37 13872.61,-3083.04 13778.67,-3061.15"/>
<polygon fill="black" stroke="black" points="13779.37,-3057.72 13768.83,-3058.86 13777.78,-3064.54 13779.37,-3057.72"/>
</g>
<!-- reshape_qkv_3_7 -->
<g id="node1250" class="node">
<title>reshape_qkv_3_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14506.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="14506.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="14506.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14506.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_7&#45;&gt;reshape_qkv_3_7 -->
<g id="edge1512" class="edge">
<title>qkv_proj_3_7&#45;&gt;reshape_qkv_3_7</title>
<path fill="none" stroke="black" d="M14608.05,-3112.88C14591.86,-3100.17 14574.73,-3086.71 14559.25,-3074.54"/>
<polygon fill="black" stroke="black" points="14561.34,-3071.74 14551.31,-3068.31 14557.01,-3077.24 14561.34,-3071.74"/>
</g>
<!-- reshape_qkv_3_8 -->
<g id="node1263" class="node">
<title>reshape_qkv_3_8</title>
<ellipse fill="lightcyan" stroke="black" cx="15297.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="15297.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="15297.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15297.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_8&#45;&gt;reshape_qkv_3_8 -->
<g id="edge1528" class="edge">
<title>qkv_proj_3_8&#45;&gt;reshape_qkv_3_8</title>
<path fill="none" stroke="black" d="M15243.44,-3108.72C15250.87,-3098.35 15258.54,-3087.65 15265.69,-3077.67"/>
<polygon fill="black" stroke="black" points="15268.57,-3079.65 15271.55,-3069.48 15262.88,-3075.57 15268.57,-3079.65"/>
</g>
<!-- reshape_qkv_3_9 -->
<g id="node1276" class="node">
<title>reshape_qkv_3_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16169.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="16169.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="16169.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16169.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_9&#45;&gt;reshape_qkv_3_9 -->
<g id="edge1543" class="edge">
<title>qkv_proj_3_9&#45;&gt;reshape_qkv_3_9</title>
<path fill="none" stroke="black" d="M16153.85,-3106.81C16155.78,-3097.81 16157.74,-3088.6 16159.6,-3079.87"/>
<polygon fill="black" stroke="black" points="16163.07,-3080.41 16161.73,-3069.9 16156.22,-3078.95 16163.07,-3080.41"/>
</g>
<!-- reshape_qkv_3_10 -->
<g id="node1288" class="node">
<title>reshape_qkv_3_10</title>
<ellipse fill="lightcyan" stroke="black" cx="17057.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17057.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17057.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17057.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_10&#45;&gt;reshape_qkv_3_10 -->
<g id="edge1558" class="edge">
<title>qkv_proj_3_10&#45;&gt;reshape_qkv_3_10</title>
<path fill="none" stroke="black" d="M16559.3,-3123.84C16577.51,-3117.49 16596.46,-3111.45 16614.57,-3106.67 16711.1,-3081.17 16821.92,-3062.78 16908.56,-3050.78"/>
<polygon fill="black" stroke="black" points="16909.04,-3054.25 16918.47,-3049.42 16908.09,-3047.31 16909.04,-3054.25"/>
</g>
<!-- reshape_qkv_3_11 -->
<g id="node1300" class="node">
<title>reshape_qkv_3_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17984.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="17984.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="17984.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17984.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_11&#45;&gt;reshape_qkv_3_11 -->
<g id="edge1573" class="edge">
<title>qkv_proj_3_11&#45;&gt;reshape_qkv_3_11</title>
<path fill="none" stroke="black" d="M16905.99,-3149.43C17135.85,-3124.66 17594.51,-3075.21 17832.86,-3049.52"/>
<polygon fill="black" stroke="black" points="17833.43,-3052.98 17843,-3048.43 17832.68,-3046.02 17833.43,-3052.98"/>
</g>
<!-- reshape_qkv_3_12 -->
<g id="node1313" class="node">
<title>reshape_qkv_3_12</title>
<ellipse fill="lightcyan" stroke="black" cx="18911.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="18911.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="18911.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18911.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_12&#45;&gt;reshape_qkv_3_12 -->
<g id="edge1589" class="edge">
<title>qkv_proj_3_12&#45;&gt;reshape_qkv_3_12</title>
<path fill="none" stroke="black" d="M17633.22,-3122.82C17652,-3116.41 17671.67,-3110.62 17690.57,-3106.67 17791.25,-3085.61 18438.84,-3054.33 18747.89,-3040.36"/>
<polygon fill="black" stroke="black" points="18748.46,-3043.84 18758.29,-3039.89 18748.14,-3036.84 18748.46,-3043.84"/>
</g>
<!-- reshape_qkv_3_13 -->
<g id="node1326" class="node">
<title>reshape_qkv_3_13</title>
<ellipse fill="lightcyan" stroke="black" cx="19990.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="19990.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="19990.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19990.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_13&#45;&gt;reshape_qkv_3_13 -->
<g id="edge1604" class="edge">
<title>qkv_proj_3_13&#45;&gt;reshape_qkv_3_13</title>
<path fill="none" stroke="black" d="M17983.83,-3152.37C18132.79,-3139.88 18375.17,-3120.29 18584.57,-3106.67 19033.93,-3077.43 19564.67,-3052.21 19826.95,-3040.37"/>
<polygon fill="black" stroke="black" points="19827.49,-3043.84 19837.32,-3039.9 19827.17,-3036.85 19827.49,-3043.84"/>
</g>
<!-- reshape_qkv_3_14 -->
<g id="node1338" class="node">
<title>reshape_qkv_3_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20836.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="20836.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="20836.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20836.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_14&#45;&gt;reshape_qkv_3_14 -->
<g id="edge1619" class="edge">
<title>qkv_proj_3_14&#45;&gt;reshape_qkv_3_14</title>
<path fill="none" stroke="black" d="M18879.46,-3156.02C19111.74,-3142.33 19587.65,-3114.05 19990.57,-3088.67 20229.66,-3073.6 20506.7,-3055.26 20676.79,-3043.9"/>
<polygon fill="black" stroke="black" points="20677.08,-3047.38 20686.82,-3043.22 20676.61,-3040.4 20677.08,-3047.38"/>
</g>
<!-- reshape_qkv_3_15 -->
<g id="node1350" class="node">
<title>reshape_qkv_3_15</title>
<ellipse fill="lightcyan" stroke="black" cx="21762.57" cy="-3032.17" rx="156.5" ry="37.5"/>
<text text-anchor="middle" x="21762.57" y="-3043.47" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="21762.57" y="-3028.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21762.57" y="-3013.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 3*128]</text>
</g>
<!-- qkv_proj_3_15&#45;&gt;reshape_qkv_3_15 -->
<g id="edge1634" class="edge">
<title>qkv_proj_3_15&#45;&gt;reshape_qkv_3_15</title>
<path fill="none" stroke="black" d="M20698.75,-3149.27C20925.93,-3124.48 21376.56,-3075.3 21611.74,-3049.63"/>
<polygon fill="black" stroke="black" points="21612.18,-3053.1 21621.74,-3048.54 21611.42,-3046.14 21612.18,-3053.1"/>
</g>
<!-- split_q_3_0 -->
<g id="node1164" class="node">
<title>split_q_3_0</title>
<ellipse fill="pink" stroke="black" cx="7703.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7703.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="7703.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7703.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_q_3_0 -->
<g id="edge1407" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_q_3_0</title>
<path fill="none" stroke="black" d="M8026.87,-3004.26C7962.61,-2987.74 7880.37,-2966.61 7814.92,-2949.78"/>
<polygon fill="black" stroke="black" points="7815.54,-2946.33 7804.98,-2947.23 7813.79,-2953.11 7815.54,-2946.33"/>
</g>
<!-- split_k_3_0 -->
<g id="node1165" class="node">
<title>split_k_3_0</title>
<ellipse fill="pink" stroke="black" cx="8012.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8012.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8012.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8012.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_k_3_0 -->
<g id="edge1408" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_k_3_0</title>
<path fill="none" stroke="black" d="M8093.27,-2995.76C8082.12,-2985.45 8069.83,-2974.09 8058.28,-2963.41"/>
<polygon fill="black" stroke="black" points="8060.53,-2960.73 8050.81,-2956.51 8055.78,-2965.87 8060.53,-2960.73"/>
</g>
<!-- split_v_3_0 -->
<g id="node1166" class="node">
<title>split_v_3_0</title>
<ellipse fill="pink" stroke="black" cx="8321.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8321.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="8321.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8321.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_0&#45;&gt;split_v_3_0 -->
<g id="edge1409" class="edge">
<title>reshape_qkv_3_0&#45;&gt;split_v_3_0</title>
<path fill="none" stroke="black" d="M8190.13,-2997.26C8210.55,-2985.44 8233.61,-2972.09 8254.66,-2959.91"/>
<polygon fill="black" stroke="black" points="8256.64,-2962.81 8263.54,-2954.77 8253.13,-2956.75 8256.64,-2962.81"/>
</g>
<!-- transpose_q_3_0 -->
<g id="node1167" class="node">
<title>transpose_q_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="7703.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="7703.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="7703.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="7703.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_0&#45;&gt;transpose_q_3_0 -->
<g id="edge1410" class="edge">
<title>split_q_3_0&#45;&gt;transpose_q_3_0</title>
<path fill="none" stroke="black" d="M7703.57,-2882.54C7703.57,-2874.09 7703.57,-2864.99 7703.57,-2856.18"/>
<polygon fill="black" stroke="black" points="7707.07,-2856.01 7703.57,-2846.01 7700.07,-2856.01 7707.07,-2856.01"/>
</g>
<!-- transpose_k_3_0 -->
<g id="node1168" class="node">
<title>transpose_k_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="8012.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8012.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8012.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8012.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_0&#45;&gt;transpose_k_3_0 -->
<g id="edge1411" class="edge">
<title>split_k_3_0&#45;&gt;transpose_k_3_0</title>
<path fill="none" stroke="black" d="M8012.57,-2882.54C8012.57,-2874.09 8012.57,-2864.99 8012.57,-2856.18"/>
<polygon fill="black" stroke="black" points="8016.07,-2856.01 8012.57,-2846.01 8009.07,-2856.01 8016.07,-2856.01"/>
</g>
<!-- transpose_v_3_0 -->
<g id="node1169" class="node">
<title>transpose_v_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="8321.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8321.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="8321.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8321.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_0&#45;&gt;transpose_v_3_0 -->
<g id="edge1412" class="edge">
<title>split_v_3_0&#45;&gt;transpose_v_3_0</title>
<path fill="none" stroke="black" d="M8321.57,-2882.54C8321.57,-2874.09 8321.57,-2864.99 8321.57,-2856.18"/>
<polygon fill="black" stroke="black" points="8325.07,-2856.01 8321.57,-2846.01 8318.07,-2856.01 8325.07,-2856.01"/>
</g>
<!-- attn_scores_3_0 -->
<g id="node1170" class="node">
<title>attn_scores_3_0</title>
<ellipse fill="gold" stroke="black" cx="8012.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8012.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8012.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8012.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_0&#45;&gt;attn_scores_3_0 -->
<g id="edge1413" class="edge">
<title>transpose_q_3_0&#45;&gt;attn_scores_3_0</title>
<path fill="none" stroke="black" d="M7787.19,-2777.4C7826.91,-2763.26 7874.6,-2746.28 7915.86,-2731.59"/>
<polygon fill="black" stroke="black" points="7917.13,-2734.86 7925.38,-2728.21 7914.79,-2728.26 7917.13,-2734.86"/>
</g>
<!-- transpose_k_3_0&#45;&gt;attn_scores_3_0 -->
<g id="edge1414" class="edge">
<title>transpose_k_3_0&#45;&gt;attn_scores_3_0</title>
<path fill="none" stroke="black" d="M8012.57,-2770.54C8012.57,-2762.09 8012.57,-2752.99 8012.57,-2744.18"/>
<polygon fill="black" stroke="black" points="8016.07,-2744.01 8012.57,-2734.01 8009.07,-2744.01 8016.07,-2744.01"/>
</g>
<!-- attn_output_3_0 -->
<g id="node1171" class="node">
<title>attn_output_3_0</title>
<ellipse fill="gold" stroke="black" cx="8321.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8321.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8321.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8321.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_0&#45;&gt;attn_output_3_0 -->
<g id="edge1415" class="edge">
<title>transpose_v_3_0&#45;&gt;attn_output_3_0</title>
<path fill="none" stroke="black" d="M8321.57,-2770.47C8321.57,-2709.42 8321.57,-2587.11 8321.57,-2519.96"/>
<polygon fill="black" stroke="black" points="8325.07,-2519.67 8321.57,-2509.67 8318.07,-2519.67 8325.07,-2519.67"/>
</g>
<!-- softmax_3_0 -->
<g id="node1172" class="node">
<title>softmax_3_0</title>
<ellipse fill="gold" stroke="black" cx="8098.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8098.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8098.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8098.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_0&#45;&gt;softmax_3_0 -->
<g id="edge1416" class="edge">
<title>attn_scores_3_0&#45;&gt;softmax_3_0</title>
<path fill="none" stroke="black" d="M8040.73,-2659.15C8048.16,-2649.65 8056.25,-2639.29 8063.98,-2629.42"/>
<polygon fill="black" stroke="black" points="8066.95,-2631.3 8070.35,-2621.27 8061.43,-2626.99 8066.95,-2631.3"/>
</g>
<!-- transpose_back_3_0 -->
<g id="node1173" class="node">
<title>transpose_back_3_0</title>
<ellipse fill="lightgray" stroke="black" cx="9093.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9093.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9093.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9093.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_0&#45;&gt;transpose_back_3_0 -->
<g id="edge1418" class="edge">
<title>attn_output_3_0&#45;&gt;transpose_back_3_0</title>
<path fill="none" stroke="black" d="M8447.33,-2453.25C8587.42,-2433.29 8813.11,-2401.13 8957.31,-2380.58"/>
<polygon fill="black" stroke="black" points="8958.15,-2384 8967.55,-2379.12 8957.16,-2377.07 8958.15,-2384"/>
</g>
<!-- softmax_3_0&#45;&gt;attn_output_3_0 -->
<g id="edge1417" class="edge">
<title>softmax_3_0&#45;&gt;attn_output_3_0</title>
<path fill="none" stroke="black" d="M8166.09,-2549.86C8191.43,-2537.36 8220.38,-2523.08 8246.38,-2510.26"/>
<polygon fill="black" stroke="black" points="8248.02,-2513.35 8255.44,-2505.79 8244.92,-2507.07 8248.02,-2513.35"/>
</g>
<!-- reshape_concat_3_0 -->
<g id="node1174" class="node">
<title>reshape_concat_3_0</title>
<ellipse fill="lightcyan" stroke="black" cx="9516.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9516.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9516.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9516.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_0&#45;&gt;reshape_concat_3_0 -->
<g id="edge1419" class="edge">
<title>transpose_back_3_0&#45;&gt;reshape_concat_3_0</title>
<path fill="none" stroke="black" d="M9194.09,-2333.03C9259.28,-2316.08 9344.1,-2294.02 9410.38,-2276.78"/>
<polygon fill="black" stroke="black" points="9411.64,-2280.07 9420.44,-2274.17 9409.88,-2273.29 9411.64,-2280.07"/>
</g>
<!-- allgather_dim_3_0 -->
<g id="node1175" class="node">
<title>allgather_dim_3_0</title>
<polygon fill="red" stroke="black" points="10119.57,-2173.67 9946.57,-2120.67 10119.57,-2067.67 10292.57,-2120.67 10119.57,-2173.67"/>
<text text-anchor="middle" x="10119.57" y="-2131.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="10119.57" y="-2116.97" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="10119.57" y="-2101.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_0&#45;&gt;allgather_dim_3_0 -->
<g id="edge1420" class="edge">
<title>reshape_concat_3_0&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M9613.94,-2222.44C9630.79,-2218.36 9648.16,-2214.29 9664.57,-2210.67 9779.08,-2185.36 9910.62,-2160.03 10002.72,-2142.91"/>
<polygon fill="black" stroke="black" points="10003.43,-2146.33 10012.63,-2141.07 10002.16,-2139.45 10003.43,-2146.33"/>
</g>
<!-- head_group_3_0 -->
<g id="node1212" class="node">
<title>head_group_3_0</title>
<polygon fill="lightyellow" stroke="black" points="12460.07,-2030.67 12263.07,-2030.67 12263.07,-1992.67 12460.07,-1992.67 12460.07,-2030.67"/>
<text text-anchor="middle" x="12361.57" y="-2015.47" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="12361.57" y="-2000.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_0&#45;&gt;head_group_3_0 -->
<g id="edge1466" class="edge">
<title>allgather_dim_3_0&#45;&gt;head_group_3_0</title>
<path fill="none" stroke="black" d="M10266.68,-2112.65C10686.76,-2092.6 11885.2,-2035.4 12252.94,-2017.85"/>
<polygon fill="black" stroke="black" points="12253.23,-2021.34 12263.05,-2017.37 12252.89,-2014.35 12253.23,-2021.34"/>
</g>
<!-- split_q_3_1 -->
<g id="node1177" class="node">
<title>split_q_3_1</title>
<ellipse fill="pink" stroke="black" cx="8630.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8630.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="8630.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8630.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_q_3_1 -->
<g id="edge1422" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_q_3_1</title>
<path fill="none" stroke="black" d="M8985.2,-3005.24C8913.29,-2988.19 8819.33,-2965.92 8746.2,-2948.58"/>
<polygon fill="black" stroke="black" points="8746.56,-2945.07 8736.02,-2946.16 8744.94,-2951.88 8746.56,-2945.07"/>
</g>
<!-- split_k_3_1 -->
<g id="node1178" class="node">
<title>split_k_3_1</title>
<ellipse fill="pink" stroke="black" cx="8939.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8939.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="8939.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8939.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_k_3_1 -->
<g id="edge1423" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_k_3_1</title>
<path fill="none" stroke="black" d="M9045.53,-2996.36C9029.9,-2985.27 9012.47,-2972.9 8996.33,-2961.45"/>
<polygon fill="black" stroke="black" points="8998.21,-2958.49 8988.03,-2955.56 8994.16,-2964.2 8998.21,-2958.49"/>
</g>
<!-- split_v_3_1 -->
<g id="node1179" class="node">
<title>split_v_3_1</title>
<ellipse fill="pink" stroke="black" cx="9248.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9248.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="9248.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9248.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_1&#45;&gt;split_v_3_1 -->
<g id="edge1424" class="edge">
<title>reshape_qkv_3_1&#45;&gt;split_v_3_1</title>
<path fill="none" stroke="black" d="M9143.3,-2996.36C9158.83,-2985.27 9176.15,-2972.9 9192.18,-2961.45"/>
<polygon fill="black" stroke="black" points="9194.32,-2964.22 9200.43,-2955.56 9190.26,-2958.52 9194.32,-2964.22"/>
</g>
<!-- transpose_q_3_1 -->
<g id="node1180" class="node">
<title>transpose_q_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="8630.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8630.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="8630.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8630.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_1&#45;&gt;transpose_q_3_1 -->
<g id="edge1425" class="edge">
<title>split_q_3_1&#45;&gt;transpose_q_3_1</title>
<path fill="none" stroke="black" d="M8630.57,-2882.54C8630.57,-2874.09 8630.57,-2864.99 8630.57,-2856.18"/>
<polygon fill="black" stroke="black" points="8634.07,-2856.01 8630.57,-2846.01 8627.07,-2856.01 8634.07,-2856.01"/>
</g>
<!-- transpose_k_3_1 -->
<g id="node1181" class="node">
<title>transpose_k_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="8939.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="8939.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="8939.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8939.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_1&#45;&gt;transpose_k_3_1 -->
<g id="edge1426" class="edge">
<title>split_k_3_1&#45;&gt;transpose_k_3_1</title>
<path fill="none" stroke="black" d="M8939.57,-2882.54C8939.57,-2874.09 8939.57,-2864.99 8939.57,-2856.18"/>
<polygon fill="black" stroke="black" points="8943.07,-2856.01 8939.57,-2846.01 8936.07,-2856.01 8943.07,-2856.01"/>
</g>
<!-- transpose_v_3_1 -->
<g id="node1182" class="node">
<title>transpose_v_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="9248.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9248.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="9248.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9248.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_1&#45;&gt;transpose_v_3_1 -->
<g id="edge1427" class="edge">
<title>split_v_3_1&#45;&gt;transpose_v_3_1</title>
<path fill="none" stroke="black" d="M9248.57,-2882.54C9248.57,-2874.09 9248.57,-2864.99 9248.57,-2856.18"/>
<polygon fill="black" stroke="black" points="9252.07,-2856.01 9248.57,-2846.01 9245.07,-2856.01 9252.07,-2856.01"/>
</g>
<!-- attn_scores_3_1 -->
<g id="node1183" class="node">
<title>attn_scores_3_1</title>
<ellipse fill="gold" stroke="black" cx="8939.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="8939.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8939.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="8939.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_1&#45;&gt;attn_scores_3_1 -->
<g id="edge1428" class="edge">
<title>transpose_q_3_1&#45;&gt;attn_scores_3_1</title>
<path fill="none" stroke="black" d="M8714.19,-2777.4C8753.91,-2763.26 8801.6,-2746.28 8842.86,-2731.59"/>
<polygon fill="black" stroke="black" points="8844.13,-2734.86 8852.38,-2728.21 8841.79,-2728.26 8844.13,-2734.86"/>
</g>
<!-- transpose_k_3_1&#45;&gt;attn_scores_3_1 -->
<g id="edge1429" class="edge">
<title>transpose_k_3_1&#45;&gt;attn_scores_3_1</title>
<path fill="none" stroke="black" d="M8939.57,-2770.54C8939.57,-2762.09 8939.57,-2752.99 8939.57,-2744.18"/>
<polygon fill="black" stroke="black" points="8943.07,-2744.01 8939.57,-2734.01 8936.07,-2744.01 8943.07,-2744.01"/>
</g>
<!-- attn_output_3_1 -->
<g id="node1184" class="node">
<title>attn_output_3_1</title>
<ellipse fill="gold" stroke="black" cx="9248.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9248.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9248.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9248.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_1&#45;&gt;attn_output_3_1 -->
<g id="edge1430" class="edge">
<title>transpose_v_3_1&#45;&gt;attn_output_3_1</title>
<path fill="none" stroke="black" d="M9248.57,-2770.47C9248.57,-2709.42 9248.57,-2587.11 9248.57,-2519.96"/>
<polygon fill="black" stroke="black" points="9252.07,-2519.67 9248.57,-2509.67 9245.07,-2519.67 9252.07,-2519.67"/>
</g>
<!-- softmax_3_1 -->
<g id="node1185" class="node">
<title>softmax_3_1</title>
<ellipse fill="gold" stroke="black" cx="9024.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9024.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9024.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9024.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_1&#45;&gt;softmax_3_1 -->
<g id="edge1431" class="edge">
<title>attn_scores_3_1&#45;&gt;softmax_3_1</title>
<path fill="none" stroke="black" d="M8967.41,-2659.15C8974.74,-2649.65 8982.75,-2639.29 8990.38,-2629.42"/>
<polygon fill="black" stroke="black" points="8993.33,-2631.32 8996.68,-2621.27 8987.79,-2627.04 8993.33,-2631.32"/>
</g>
<!-- transpose_back_3_1 -->
<g id="node1186" class="node">
<title>transpose_back_3_1</title>
<ellipse fill="lightgray" stroke="black" cx="9556.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9556.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="9556.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9556.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_1&#45;&gt;transpose_back_3_1 -->
<g id="edge1433" class="edge">
<title>attn_output_3_1&#45;&gt;transpose_back_3_1</title>
<path fill="none" stroke="black" d="M9331.92,-2441.4C9372.58,-2426.88 9421.63,-2409.36 9463.51,-2394.4"/>
<polygon fill="black" stroke="black" points="9464.92,-2397.62 9473.16,-2390.96 9462.56,-2391.02 9464.92,-2397.62"/>
</g>
<!-- softmax_3_1&#45;&gt;attn_output_3_1 -->
<g id="edge1432" class="edge">
<title>softmax_3_1&#45;&gt;attn_output_3_1</title>
<path fill="none" stroke="black" d="M9092.39,-2549.86C9117.96,-2537.31 9147.19,-2522.95 9173.4,-2510.08"/>
<polygon fill="black" stroke="black" points="9175.09,-2513.15 9182.53,-2505.6 9172.01,-2506.87 9175.09,-2513.15"/>
</g>
<!-- reshape_concat_3_1 -->
<g id="node1187" class="node">
<title>reshape_concat_3_1</title>
<ellipse fill="lightcyan" stroke="black" cx="9806.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="9806.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="9806.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9806.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_1&#45;&gt;reshape_concat_3_1 -->
<g id="edge1434" class="edge">
<title>transpose_back_3_1&#45;&gt;reshape_concat_3_1</title>
<path fill="none" stroke="black" d="M9628.55,-2327.5C9659.4,-2313.92 9695.54,-2298.02 9727.17,-2284.1"/>
<polygon fill="black" stroke="black" points="9728.66,-2287.27 9736.4,-2280.04 9725.84,-2280.87 9728.66,-2287.27"/>
</g>
<!-- reshape_concat_3_1&#45;&gt;allgather_dim_3_0 -->
<g id="edge1435" class="edge">
<title>reshape_concat_3_1&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M9881.54,-2217.11C9928.26,-2198.38 9988.41,-2174.26 10036.56,-2154.95"/>
<polygon fill="black" stroke="black" points="10038.05,-2158.13 10046.02,-2151.16 10035.44,-2151.63 10038.05,-2158.13"/>
</g>
<!-- split_q_3_2 -->
<g id="node1189" class="node">
<title>split_q_3_2</title>
<ellipse fill="pink" stroke="black" cx="9557.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9557.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="9557.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9557.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_q_3_2 -->
<g id="edge1437" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_q_3_2</title>
<path fill="none" stroke="black" d="M9850.64,-3003.2C9793.67,-2987.25 9722.29,-2967.27 9664.24,-2951.02"/>
<polygon fill="black" stroke="black" points="9664.88,-2947.57 9654.31,-2948.24 9662.99,-2954.31 9664.88,-2947.57"/>
</g>
<!-- split_k_3_2 -->
<g id="node1190" class="node">
<title>split_k_3_2</title>
<ellipse fill="pink" stroke="black" cx="9866.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9866.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="9866.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9866.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_k_3_2 -->
<g id="edge1438" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_k_3_2</title>
<path fill="none" stroke="black" d="M9923.07,-2995.15C9915.82,-2985.65 9907.91,-2975.29 9900.37,-2965.42"/>
<polygon fill="black" stroke="black" points="9902.99,-2963.09 9894.14,-2957.27 9897.43,-2967.34 9902.99,-2963.09"/>
</g>
<!-- split_v_3_2 -->
<g id="node1191" class="node">
<title>split_v_3_2</title>
<ellipse fill="pink" stroke="black" cx="10175.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10175.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="10175.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10175.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_2&#45;&gt;split_v_3_2 -->
<g id="edge1439" class="edge">
<title>reshape_qkv_3_2&#45;&gt;split_v_3_2</title>
<path fill="none" stroke="black" d="M10018.08,-2998.16C10043.9,-2985.54 10073.51,-2971.06 10100.03,-2958.1"/>
<polygon fill="black" stroke="black" points="10101.83,-2961.11 10109.28,-2953.58 10098.75,-2954.83 10101.83,-2961.11"/>
</g>
<!-- transpose_q_3_2 -->
<g id="node1192" class="node">
<title>transpose_q_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="9557.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9557.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="9557.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9557.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_2&#45;&gt;transpose_q_3_2 -->
<g id="edge1440" class="edge">
<title>split_q_3_2&#45;&gt;transpose_q_3_2</title>
<path fill="none" stroke="black" d="M9557.57,-2882.54C9557.57,-2874.09 9557.57,-2864.99 9557.57,-2856.18"/>
<polygon fill="black" stroke="black" points="9561.07,-2856.01 9557.57,-2846.01 9554.07,-2856.01 9561.07,-2856.01"/>
</g>
<!-- transpose_k_3_2 -->
<g id="node1193" class="node">
<title>transpose_k_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="9866.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="9866.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="9866.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9866.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_2&#45;&gt;transpose_k_3_2 -->
<g id="edge1441" class="edge">
<title>split_k_3_2&#45;&gt;transpose_k_3_2</title>
<path fill="none" stroke="black" d="M9866.57,-2882.54C9866.57,-2874.09 9866.57,-2864.99 9866.57,-2856.18"/>
<polygon fill="black" stroke="black" points="9870.07,-2856.01 9866.57,-2846.01 9863.07,-2856.01 9870.07,-2856.01"/>
</g>
<!-- transpose_v_3_2 -->
<g id="node1194" class="node">
<title>transpose_v_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="10175.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10175.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="10175.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10175.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_2&#45;&gt;transpose_v_3_2 -->
<g id="edge1442" class="edge">
<title>split_v_3_2&#45;&gt;transpose_v_3_2</title>
<path fill="none" stroke="black" d="M10175.57,-2882.54C10175.57,-2874.09 10175.57,-2864.99 10175.57,-2856.18"/>
<polygon fill="black" stroke="black" points="10179.07,-2856.01 10175.57,-2846.01 10172.07,-2856.01 10179.07,-2856.01"/>
</g>
<!-- attn_scores_3_2 -->
<g id="node1195" class="node">
<title>attn_scores_3_2</title>
<ellipse fill="gold" stroke="black" cx="9866.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9866.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9866.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9866.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_2&#45;&gt;attn_scores_3_2 -->
<g id="edge1443" class="edge">
<title>transpose_q_3_2&#45;&gt;attn_scores_3_2</title>
<path fill="none" stroke="black" d="M9641.19,-2777.4C9680.91,-2763.26 9728.6,-2746.28 9769.86,-2731.59"/>
<polygon fill="black" stroke="black" points="9771.13,-2734.86 9779.38,-2728.21 9768.79,-2728.26 9771.13,-2734.86"/>
</g>
<!-- transpose_k_3_2&#45;&gt;attn_scores_3_2 -->
<g id="edge1444" class="edge">
<title>transpose_k_3_2&#45;&gt;attn_scores_3_2</title>
<path fill="none" stroke="black" d="M9866.57,-2770.54C9866.57,-2762.09 9866.57,-2752.99 9866.57,-2744.18"/>
<polygon fill="black" stroke="black" points="9870.07,-2744.01 9866.57,-2734.01 9863.07,-2744.01 9870.07,-2744.01"/>
</g>
<!-- attn_output_3_2 -->
<g id="node1196" class="node">
<title>attn_output_3_2</title>
<ellipse fill="gold" stroke="black" cx="10119.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10119.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10119.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10119.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_2&#45;&gt;attn_output_3_2 -->
<g id="edge1445" class="edge">
<title>transpose_v_3_2&#45;&gt;attn_output_3_2</title>
<path fill="none" stroke="black" d="M10169.42,-2770.47C10159.16,-2709.3 10138.59,-2586.6 10127.35,-2519.54"/>
<polygon fill="black" stroke="black" points="10130.8,-2518.96 10125.69,-2509.67 10123.9,-2520.11 10130.8,-2518.96"/>
</g>
<!-- softmax_3_2 -->
<g id="node1197" class="node">
<title>softmax_3_2</title>
<ellipse fill="gold" stroke="black" cx="9895.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="9895.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9895.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9895.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_2&#45;&gt;softmax_3_2 -->
<g id="edge1446" class="edge">
<title>attn_scores_3_2&#45;&gt;softmax_3_2</title>
<path fill="none" stroke="black" d="M9876.23,-2658.54C9878.53,-2649.82 9881.01,-2640.4 9883.41,-2631.31"/>
<polygon fill="black" stroke="black" points="9886.79,-2632.2 9885.96,-2621.63 9880.03,-2630.41 9886.79,-2632.2"/>
</g>
<!-- transpose_back_3_2 -->
<g id="node1198" class="node">
<title>transpose_back_3_2</title>
<ellipse fill="lightgray" stroke="black" cx="10119.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10119.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10119.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10119.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_2&#45;&gt;transpose_back_3_2 -->
<g id="edge1448" class="edge">
<title>attn_output_3_2&#45;&gt;transpose_back_3_2</title>
<path fill="none" stroke="black" d="M10119.57,-2434.54C10119.57,-2426.09 10119.57,-2416.99 10119.57,-2408.18"/>
<polygon fill="black" stroke="black" points="10123.07,-2408.01 10119.57,-2398.01 10116.07,-2408.01 10123.07,-2408.01"/>
</g>
<!-- softmax_3_2&#45;&gt;attn_output_3_2 -->
<g id="edge1447" class="edge">
<title>softmax_3_2&#45;&gt;attn_output_3_2</title>
<path fill="none" stroke="black" d="M9963.39,-2549.86C9988.96,-2537.31 10018.19,-2522.95 10044.4,-2510.08"/>
<polygon fill="black" stroke="black" points="10046.09,-2513.15 10053.53,-2505.6 10043.01,-2506.87 10046.09,-2513.15"/>
</g>
<!-- reshape_concat_3_2 -->
<g id="node1199" class="node">
<title>reshape_concat_3_2</title>
<ellipse fill="lightcyan" stroke="black" cx="10119.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10119.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10119.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="10119.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_2&#45;&gt;reshape_concat_3_2 -->
<g id="edge1449" class="edge">
<title>transpose_back_3_2&#45;&gt;reshape_concat_3_2</title>
<path fill="none" stroke="black" d="M10119.57,-2322.54C10119.57,-2314.09 10119.57,-2304.99 10119.57,-2296.18"/>
<polygon fill="black" stroke="black" points="10123.07,-2296.01 10119.57,-2286.01 10116.07,-2296.01 10123.07,-2296.01"/>
</g>
<!-- reshape_concat_3_2&#45;&gt;allgather_dim_3_0 -->
<g id="edge1450" class="edge">
<title>reshape_concat_3_2&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M10119.57,-2210.53C10119.57,-2202.22 10119.57,-2193.18 10119.57,-2184.13"/>
<polygon fill="black" stroke="black" points="10123.07,-2183.97 10119.57,-2173.97 10116.07,-2183.97 10123.07,-2183.97"/>
</g>
<!-- split_q_3_3 -->
<g id="node1201" class="node">
<title>split_q_3_3</title>
<ellipse fill="pink" stroke="black" cx="10484.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10484.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="10484.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10484.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_q_3_3 -->
<g id="edge1452" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_q_3_3</title>
<path fill="none" stroke="black" d="M10777.64,-3003.2C10720.67,-2987.25 10649.29,-2967.27 10591.24,-2951.02"/>
<polygon fill="black" stroke="black" points="10591.88,-2947.57 10581.31,-2948.24 10589.99,-2954.31 10591.88,-2947.57"/>
</g>
<!-- split_k_3_3 -->
<g id="node1202" class="node">
<title>split_k_3_3</title>
<ellipse fill="pink" stroke="black" cx="10793.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10793.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="10793.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10793.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_k_3_3 -->
<g id="edge1453" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_k_3_3</title>
<path fill="none" stroke="black" d="M10850.07,-2995.15C10842.82,-2985.65 10834.91,-2975.29 10827.37,-2965.42"/>
<polygon fill="black" stroke="black" points="10829.99,-2963.09 10821.14,-2957.27 10824.43,-2967.34 10829.99,-2963.09"/>
</g>
<!-- split_v_3_3 -->
<g id="node1203" class="node">
<title>split_v_3_3</title>
<ellipse fill="pink" stroke="black" cx="11102.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11102.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="11102.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11102.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_3&#45;&gt;split_v_3_3 -->
<g id="edge1454" class="edge">
<title>reshape_qkv_3_3&#45;&gt;split_v_3_3</title>
<path fill="none" stroke="black" d="M10945.08,-2998.16C10970.9,-2985.54 11000.51,-2971.06 11027.03,-2958.1"/>
<polygon fill="black" stroke="black" points="11028.83,-2961.11 11036.28,-2953.58 11025.75,-2954.83 11028.83,-2961.11"/>
</g>
<!-- transpose_q_3_3 -->
<g id="node1204" class="node">
<title>transpose_q_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="10484.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10484.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="10484.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10484.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_3&#45;&gt;transpose_q_3_3 -->
<g id="edge1455" class="edge">
<title>split_q_3_3&#45;&gt;transpose_q_3_3</title>
<path fill="none" stroke="black" d="M10484.57,-2882.54C10484.57,-2874.09 10484.57,-2864.99 10484.57,-2856.18"/>
<polygon fill="black" stroke="black" points="10488.07,-2856.01 10484.57,-2846.01 10481.07,-2856.01 10488.07,-2856.01"/>
</g>
<!-- transpose_k_3_3 -->
<g id="node1205" class="node">
<title>transpose_k_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="10793.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10793.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="10793.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10793.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_3&#45;&gt;transpose_k_3_3 -->
<g id="edge1456" class="edge">
<title>split_k_3_3&#45;&gt;transpose_k_3_3</title>
<path fill="none" stroke="black" d="M10793.57,-2882.54C10793.57,-2874.09 10793.57,-2864.99 10793.57,-2856.18"/>
<polygon fill="black" stroke="black" points="10797.07,-2856.01 10793.57,-2846.01 10790.07,-2856.01 10797.07,-2856.01"/>
</g>
<!-- transpose_v_3_3 -->
<g id="node1206" class="node">
<title>transpose_v_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="11102.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11102.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="11102.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11102.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_3&#45;&gt;transpose_v_3_3 -->
<g id="edge1457" class="edge">
<title>split_v_3_3&#45;&gt;transpose_v_3_3</title>
<path fill="none" stroke="black" d="M11102.57,-2882.54C11102.57,-2874.09 11102.57,-2864.99 11102.57,-2856.18"/>
<polygon fill="black" stroke="black" points="11106.07,-2856.01 11102.57,-2846.01 11099.07,-2856.01 11106.07,-2856.01"/>
</g>
<!-- attn_scores_3_3 -->
<g id="node1207" class="node">
<title>attn_scores_3_3</title>
<ellipse fill="gold" stroke="black" cx="10683.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10683.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10683.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10683.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_3&#45;&gt;attn_scores_3_3 -->
<g id="edge1458" class="edge">
<title>transpose_q_3_3&#45;&gt;attn_scores_3_3</title>
<path fill="none" stroke="black" d="M10544.82,-2773.86C10566.43,-2761.92 10590.99,-2748.34 10613.37,-2735.97"/>
<polygon fill="black" stroke="black" points="10615.1,-2739.02 10622.16,-2731.12 10611.71,-2732.89 10615.1,-2739.02"/>
</g>
<!-- transpose_k_3_3&#45;&gt;attn_scores_3_3 -->
<g id="edge1459" class="edge">
<title>transpose_k_3_3&#45;&gt;attn_scores_3_3</title>
<path fill="none" stroke="black" d="M10758.16,-2771.76C10748.06,-2761.65 10736.94,-2750.53 10726.44,-2740.04"/>
<polygon fill="black" stroke="black" points="10728.84,-2737.48 10719.29,-2732.89 10723.89,-2742.43 10728.84,-2737.48"/>
</g>
<!-- attn_output_3_3 -->
<g id="node1208" class="node">
<title>attn_output_3_3</title>
<ellipse fill="gold" stroke="black" cx="10683.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10683.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10683.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10683.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_3&#45;&gt;attn_output_3_3 -->
<g id="edge1460" class="edge">
<title>transpose_v_3_3&#45;&gt;attn_output_3_3</title>
<path fill="none" stroke="black" d="M11076.9,-2771.02C11036.27,-2716.07 10952.23,-2611.13 10859.57,-2546.67 10836.21,-2530.41 10808.7,-2516.79 10782.46,-2505.86"/>
<polygon fill="black" stroke="black" points="10783.44,-2502.48 10772.86,-2501.96 10780.8,-2508.96 10783.44,-2502.48"/>
</g>
<!-- softmax_3_3 -->
<g id="node1209" class="node">
<title>softmax_3_3</title>
<ellipse fill="gold" stroke="black" cx="10683.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="10683.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10683.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10683.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_3&#45;&gt;softmax_3_3 -->
<g id="edge1461" class="edge">
<title>attn_scores_3_3&#45;&gt;softmax_3_3</title>
<path fill="none" stroke="black" d="M10683.57,-2658.54C10683.57,-2650.09 10683.57,-2640.99 10683.57,-2632.18"/>
<polygon fill="black" stroke="black" points="10687.07,-2632.01 10683.57,-2622.01 10680.07,-2632.01 10687.07,-2632.01"/>
</g>
<!-- transpose_back_3_3 -->
<g id="node1210" class="node">
<title>transpose_back_3_3</title>
<ellipse fill="lightgray" stroke="black" cx="10582.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="10582.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="10582.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10582.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_3&#45;&gt;transpose_back_3_3 -->
<g id="edge1463" class="edge">
<title>attn_output_3_3&#45;&gt;transpose_back_3_3</title>
<path fill="none" stroke="black" d="M10650.78,-2435.45C10641.79,-2425.65 10631.93,-2414.92 10622.58,-2404.74"/>
<polygon fill="black" stroke="black" points="10624.89,-2402.08 10615.55,-2397.08 10619.73,-2406.81 10624.89,-2402.08"/>
</g>
<!-- softmax_3_3&#45;&gt;attn_output_3_3 -->
<g id="edge1462" class="edge">
<title>softmax_3_3&#45;&gt;attn_output_3_3</title>
<path fill="none" stroke="black" d="M10683.57,-2546.54C10683.57,-2538.09 10683.57,-2528.99 10683.57,-2520.18"/>
<polygon fill="black" stroke="black" points="10687.07,-2520.01 10683.57,-2510.01 10680.07,-2520.01 10687.07,-2520.01"/>
</g>
<!-- reshape_concat_3_3 -->
<g id="node1211" class="node">
<title>reshape_concat_3_3</title>
<ellipse fill="lightcyan" stroke="black" cx="10415.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="10415.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="10415.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="10415.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_3&#45;&gt;reshape_concat_3_3 -->
<g id="edge1464" class="edge">
<title>transpose_back_3_3&#45;&gt;reshape_concat_3_3</title>
<path fill="none" stroke="black" d="M10530.65,-2324.96C10513.2,-2313.47 10493.6,-2300.56 10475.59,-2288.7"/>
<polygon fill="black" stroke="black" points="10477.17,-2285.55 10466.89,-2282.97 10473.32,-2291.39 10477.17,-2285.55"/>
</g>
<!-- reshape_concat_3_3&#45;&gt;allgather_dim_3_0 -->
<g id="edge1465" class="edge">
<title>reshape_concat_3_3&#45;&gt;allgather_dim_3_0</title>
<path fill="none" stroke="black" d="M10343.54,-2216.63C10300.25,-2198.27 10245.05,-2174.87 10200.29,-2155.89"/>
<polygon fill="black" stroke="black" points="10201.47,-2152.59 10190.9,-2151.91 10198.74,-2159.03 10201.47,-2152.59"/>
</g>
<!-- output_proj_3_0 -->
<g id="node1363" class="node">
<title>output_proj_3_0</title>
<ellipse fill="orange" stroke="black" cx="13524.57" cy="-1907.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="13524.57" y="-1926.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13524.57" y="-1911.38" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="13524.57" y="-1896.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13524.57" y="-1881.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_0&#45;&gt;output_proj_3_0 -->
<g id="edge1650" class="edge">
<title>head_group_3_0&#45;&gt;output_proj_3_0</title>
<path fill="none" stroke="black" d="M12460.23,-2002.01C12665.56,-1983.98 13139.67,-1942.37 13379.71,-1921.3"/>
<polygon fill="black" stroke="black" points="13380.25,-1924.76 13389.91,-1920.4 13379.64,-1917.79 13380.25,-1924.76"/>
</g>
<!-- split_q_3_4 -->
<g id="node1214" class="node">
<title>split_q_3_4</title>
<ellipse fill="pink" stroke="black" cx="11411.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11411.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="11411.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11411.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_q_3_4 -->
<g id="edge1468" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_q_3_4</title>
<path fill="none" stroke="black" d="M11765.44,-3005.24C11693.68,-2988.19 11599.93,-2965.92 11526.95,-2948.58"/>
<polygon fill="black" stroke="black" points="11527.33,-2945.07 11516.79,-2946.16 11525.71,-2951.88 11527.33,-2945.07"/>
</g>
<!-- split_k_3_4 -->
<g id="node1215" class="node">
<title>split_k_3_4</title>
<ellipse fill="pink" stroke="black" cx="11720.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11720.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="11720.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11720.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_k_3_4 -->
<g id="edge1469" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_k_3_4</title>
<path fill="none" stroke="black" d="M11825.85,-2996.36C11810.31,-2985.27 11793,-2972.9 11776.97,-2961.45"/>
<polygon fill="black" stroke="black" points="11778.89,-2958.52 11768.72,-2955.56 11774.82,-2964.22 11778.89,-2958.52"/>
</g>
<!-- split_v_3_4 -->
<g id="node1216" class="node">
<title>split_v_3_4</title>
<ellipse fill="pink" stroke="black" cx="12029.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12029.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12029.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12029.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_4&#45;&gt;split_v_3_4 -->
<g id="edge1470" class="edge">
<title>reshape_qkv_3_4&#45;&gt;split_v_3_4</title>
<path fill="none" stroke="black" d="M11923.62,-2996.36C11939.25,-2985.27 11956.68,-2972.9 11972.81,-2961.45"/>
<polygon fill="black" stroke="black" points="11974.99,-2964.2 11981.11,-2955.56 11970.93,-2958.49 11974.99,-2964.2"/>
</g>
<!-- transpose_q_3_4 -->
<g id="node1217" class="node">
<title>transpose_q_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="11411.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11411.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="11411.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11411.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_4&#45;&gt;transpose_q_3_4 -->
<g id="edge1471" class="edge">
<title>split_q_3_4&#45;&gt;transpose_q_3_4</title>
<path fill="none" stroke="black" d="M11411.57,-2882.54C11411.57,-2874.09 11411.57,-2864.99 11411.57,-2856.18"/>
<polygon fill="black" stroke="black" points="11415.07,-2856.01 11411.57,-2846.01 11408.07,-2856.01 11415.07,-2856.01"/>
</g>
<!-- transpose_k_3_4 -->
<g id="node1218" class="node">
<title>transpose_k_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="11720.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="11720.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="11720.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11720.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_4&#45;&gt;transpose_k_3_4 -->
<g id="edge1472" class="edge">
<title>split_k_3_4&#45;&gt;transpose_k_3_4</title>
<path fill="none" stroke="black" d="M11720.57,-2882.54C11720.57,-2874.09 11720.57,-2864.99 11720.57,-2856.18"/>
<polygon fill="black" stroke="black" points="11724.07,-2856.01 11720.57,-2846.01 11717.07,-2856.01 11724.07,-2856.01"/>
</g>
<!-- transpose_v_3_4 -->
<g id="node1219" class="node">
<title>transpose_v_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="12029.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12029.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12029.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12029.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_4&#45;&gt;transpose_v_3_4 -->
<g id="edge1473" class="edge">
<title>split_v_3_4&#45;&gt;transpose_v_3_4</title>
<path fill="none" stroke="black" d="M12029.57,-2882.54C12029.57,-2874.09 12029.57,-2864.99 12029.57,-2856.18"/>
<polygon fill="black" stroke="black" points="12033.07,-2856.01 12029.57,-2846.01 12026.07,-2856.01 12033.07,-2856.01"/>
</g>
<!-- attn_scores_3_4 -->
<g id="node1220" class="node">
<title>attn_scores_3_4</title>
<ellipse fill="gold" stroke="black" cx="11720.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11720.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11720.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11720.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_4&#45;&gt;attn_scores_3_4 -->
<g id="edge1474" class="edge">
<title>transpose_q_3_4&#45;&gt;attn_scores_3_4</title>
<path fill="none" stroke="black" d="M11495.19,-2777.4C11534.91,-2763.26 11582.6,-2746.28 11623.86,-2731.59"/>
<polygon fill="black" stroke="black" points="11625.13,-2734.86 11633.38,-2728.21 11622.79,-2728.26 11625.13,-2734.86"/>
</g>
<!-- transpose_k_3_4&#45;&gt;attn_scores_3_4 -->
<g id="edge1475" class="edge">
<title>transpose_k_3_4&#45;&gt;attn_scores_3_4</title>
<path fill="none" stroke="black" d="M11720.57,-2770.54C11720.57,-2762.09 11720.57,-2752.99 11720.57,-2744.18"/>
<polygon fill="black" stroke="black" points="11724.07,-2744.01 11720.57,-2734.01 11717.07,-2744.01 11724.07,-2744.01"/>
</g>
<!-- attn_output_3_4 -->
<g id="node1221" class="node">
<title>attn_output_3_4</title>
<ellipse fill="gold" stroke="black" cx="12029.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12029.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12029.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12029.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_4&#45;&gt;attn_output_3_4 -->
<g id="edge1476" class="edge">
<title>transpose_v_3_4&#45;&gt;attn_output_3_4</title>
<path fill="none" stroke="black" d="M12029.57,-2770.47C12029.57,-2709.42 12029.57,-2587.11 12029.57,-2519.96"/>
<polygon fill="black" stroke="black" points="12033.07,-2519.67 12029.57,-2509.67 12026.07,-2519.67 12033.07,-2519.67"/>
</g>
<!-- softmax_3_4 -->
<g id="node1222" class="node">
<title>softmax_3_4</title>
<ellipse fill="gold" stroke="black" cx="11777.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="11777.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11777.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11777.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_4&#45;&gt;softmax_3_4 -->
<g id="edge1477" class="edge">
<title>attn_scores_3_4&#45;&gt;softmax_3_4</title>
<path fill="none" stroke="black" d="M11739.4,-2658.84C11744.11,-2649.74 11749.23,-2639.86 11754.15,-2630.38"/>
<polygon fill="black" stroke="black" points="11757.28,-2631.94 11758.77,-2621.45 11751.06,-2628.72 11757.28,-2631.94"/>
</g>
<!-- transpose_back_3_4 -->
<g id="node1223" class="node">
<title>transpose_back_3_4</title>
<ellipse fill="lightgray" stroke="black" cx="12400.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12400.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="12400.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12400.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_4&#45;&gt;transpose_back_3_4 -->
<g id="edge1479" class="edge">
<title>attn_output_3_4&#45;&gt;transpose_back_3_4</title>
<path fill="none" stroke="black" d="M12123.19,-2443.41C12176.25,-2427.68 12242.72,-2407.97 12297.29,-2391.79"/>
<polygon fill="black" stroke="black" points="12298.39,-2395.11 12306.98,-2388.91 12296.4,-2388.4 12298.39,-2395.11"/>
</g>
<!-- softmax_3_4&#45;&gt;attn_output_3_4 -->
<g id="edge1478" class="edge">
<title>softmax_3_4&#45;&gt;attn_output_3_4</title>
<path fill="none" stroke="black" d="M11852.16,-2550.61C11882.15,-2537.52 11916.83,-2522.38 11947.52,-2508.98"/>
<polygon fill="black" stroke="black" points="11949.15,-2512.09 11956.91,-2504.88 11946.35,-2505.68 11949.15,-2512.09"/>
</g>
<!-- reshape_concat_3_4 -->
<g id="node1224" class="node">
<title>reshape_concat_3_4</title>
<ellipse fill="lightcyan" stroke="black" cx="12959.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="12959.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="12959.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12959.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_4&#45;&gt;reshape_concat_3_4 -->
<g id="edge1480" class="edge">
<title>transpose_back_3_4&#45;&gt;reshape_concat_3_4</title>
<path fill="none" stroke="black" d="M12514.37,-2336.77C12609.79,-2318 12745.55,-2291.28 12842.01,-2272.3"/>
<polygon fill="black" stroke="black" points="12842.96,-2275.68 12852.1,-2270.31 12841.61,-2268.81 12842.96,-2275.68"/>
</g>
<!-- allgather_dim_3_1 -->
<g id="node1225" class="node">
<title>allgather_dim_3_1</title>
<polygon fill="red" stroke="black" points="13635.57,-2173.67 13462.57,-2120.67 13635.57,-2067.67 13808.57,-2120.67 13635.57,-2173.67"/>
<text text-anchor="middle" x="13635.57" y="-2131.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="13635.57" y="-2116.97" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13635.57" y="-2101.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_4&#45;&gt;allgather_dim_3_1 -->
<g id="edge1481" class="edge">
<title>reshape_concat_3_4&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M13061.88,-2224.09C13083.22,-2219.48 13105.61,-2214.79 13126.57,-2210.67 13258.83,-2184.66 13411.17,-2158.53 13514.46,-2141.37"/>
<polygon fill="black" stroke="black" points="13515.32,-2144.77 13524.61,-2139.69 13514.18,-2137.87 13515.32,-2144.77"/>
</g>
<!-- head_group_3_1 -->
<g id="node1262" class="node">
<title>head_group_3_1</title>
<polygon fill="lightyellow" stroke="black" points="13816.07,-2030.67 13619.07,-2030.67 13619.07,-1992.67 13816.07,-1992.67 13816.07,-2030.67"/>
<text text-anchor="middle" x="13717.57" y="-2015.47" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13717.57" y="-2000.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_1&#45;&gt;head_group_3_1 -->
<g id="edge1527" class="edge">
<title>allgather_dim_3_1&#45;&gt;head_group_3_1</title>
<path fill="none" stroke="black" d="M13667.98,-2077.38C13678,-2064.31 13688.73,-2050.31 13697.64,-2038.68"/>
<polygon fill="black" stroke="black" points="13700.46,-2040.75 13703.76,-2030.68 13694.9,-2036.49 13700.46,-2040.75"/>
</g>
<!-- split_q_3_5 -->
<g id="node1227" class="node">
<title>split_q_3_5</title>
<ellipse fill="pink" stroke="black" cx="12338.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12338.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="12338.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12338.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_q_3_5 -->
<g id="edge1483" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_q_3_5</title>
<path fill="none" stroke="black" d="M12631.64,-3003.2C12574.67,-2987.25 12503.29,-2967.27 12445.24,-2951.02"/>
<polygon fill="black" stroke="black" points="12445.88,-2947.57 12435.31,-2948.24 12443.99,-2954.31 12445.88,-2947.57"/>
</g>
<!-- split_k_3_5 -->
<g id="node1228" class="node">
<title>split_k_3_5</title>
<ellipse fill="pink" stroke="black" cx="12647.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12647.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="12647.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12647.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_k_3_5 -->
<g id="edge1484" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_k_3_5</title>
<path fill="none" stroke="black" d="M12704.07,-2995.15C12696.82,-2985.65 12688.91,-2975.29 12681.37,-2965.42"/>
<polygon fill="black" stroke="black" points="12683.99,-2963.09 12675.14,-2957.27 12678.43,-2967.34 12683.99,-2963.09"/>
</g>
<!-- split_v_3_5 -->
<g id="node1229" class="node">
<title>split_v_3_5</title>
<ellipse fill="pink" stroke="black" cx="12956.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12956.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="12956.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12956.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_5&#45;&gt;split_v_3_5 -->
<g id="edge1485" class="edge">
<title>reshape_qkv_3_5&#45;&gt;split_v_3_5</title>
<path fill="none" stroke="black" d="M12799.08,-2998.16C12824.9,-2985.54 12854.51,-2971.06 12881.03,-2958.1"/>
<polygon fill="black" stroke="black" points="12882.83,-2961.11 12890.28,-2953.58 12879.75,-2954.83 12882.83,-2961.11"/>
</g>
<!-- transpose_q_3_5 -->
<g id="node1230" class="node">
<title>transpose_q_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="12338.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12338.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="12338.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12338.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_5&#45;&gt;transpose_q_3_5 -->
<g id="edge1486" class="edge">
<title>split_q_3_5&#45;&gt;transpose_q_3_5</title>
<path fill="none" stroke="black" d="M12338.57,-2882.54C12338.57,-2874.09 12338.57,-2864.99 12338.57,-2856.18"/>
<polygon fill="black" stroke="black" points="12342.07,-2856.01 12338.57,-2846.01 12335.07,-2856.01 12342.07,-2856.01"/>
</g>
<!-- transpose_k_3_5 -->
<g id="node1231" class="node">
<title>transpose_k_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="12647.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12647.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="12647.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12647.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_5&#45;&gt;transpose_k_3_5 -->
<g id="edge1487" class="edge">
<title>split_k_3_5&#45;&gt;transpose_k_3_5</title>
<path fill="none" stroke="black" d="M12647.57,-2882.54C12647.57,-2874.09 12647.57,-2864.99 12647.57,-2856.18"/>
<polygon fill="black" stroke="black" points="12651.07,-2856.01 12647.57,-2846.01 12644.07,-2856.01 12651.07,-2856.01"/>
</g>
<!-- transpose_v_3_5 -->
<g id="node1232" class="node">
<title>transpose_v_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="12956.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12956.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="12956.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12956.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_5&#45;&gt;transpose_v_3_5 -->
<g id="edge1488" class="edge">
<title>split_v_3_5&#45;&gt;transpose_v_3_5</title>
<path fill="none" stroke="black" d="M12956.57,-2882.54C12956.57,-2874.09 12956.57,-2864.99 12956.57,-2856.18"/>
<polygon fill="black" stroke="black" points="12960.07,-2856.01 12956.57,-2846.01 12953.07,-2856.01 12960.07,-2856.01"/>
</g>
<!-- attn_scores_3_5 -->
<g id="node1233" class="node">
<title>attn_scores_3_5</title>
<ellipse fill="gold" stroke="black" cx="12647.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12647.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12647.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12647.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_5&#45;&gt;attn_scores_3_5 -->
<g id="edge1489" class="edge">
<title>transpose_q_3_5&#45;&gt;attn_scores_3_5</title>
<path fill="none" stroke="black" d="M12422.19,-2777.4C12461.91,-2763.26 12509.6,-2746.28 12550.86,-2731.59"/>
<polygon fill="black" stroke="black" points="12552.13,-2734.86 12560.38,-2728.21 12549.79,-2728.26 12552.13,-2734.86"/>
</g>
<!-- transpose_k_3_5&#45;&gt;attn_scores_3_5 -->
<g id="edge1490" class="edge">
<title>transpose_k_3_5&#45;&gt;attn_scores_3_5</title>
<path fill="none" stroke="black" d="M12647.57,-2770.54C12647.57,-2762.09 12647.57,-2752.99 12647.57,-2744.18"/>
<polygon fill="black" stroke="black" points="12651.07,-2744.01 12647.57,-2734.01 12644.07,-2744.01 12651.07,-2744.01"/>
</g>
<!-- attn_output_3_5 -->
<g id="node1234" class="node">
<title>attn_output_3_5</title>
<ellipse fill="gold" stroke="black" cx="12956.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="12956.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12956.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12956.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_5&#45;&gt;attn_output_3_5 -->
<g id="edge1491" class="edge">
<title>transpose_v_3_5&#45;&gt;attn_output_3_5</title>
<path fill="none" stroke="black" d="M12956.57,-2770.47C12956.57,-2709.42 12956.57,-2587.11 12956.57,-2519.96"/>
<polygon fill="black" stroke="black" points="12960.07,-2519.67 12956.57,-2509.67 12953.07,-2519.67 12960.07,-2519.67"/>
</g>
<!-- softmax_3_5 -->
<g id="node1235" class="node">
<title>softmax_3_5</title>
<ellipse fill="gold" stroke="black" cx="12733.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="12733.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12733.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12733.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_5&#45;&gt;softmax_3_5 -->
<g id="edge1492" class="edge">
<title>attn_scores_3_5&#45;&gt;softmax_3_5</title>
<path fill="none" stroke="black" d="M12675.73,-2659.15C12683.16,-2649.65 12691.25,-2639.29 12698.98,-2629.42"/>
<polygon fill="black" stroke="black" points="12701.95,-2631.3 12705.35,-2621.27 12696.43,-2626.99 12701.95,-2631.3"/>
</g>
<!-- transpose_back_3_5 -->
<g id="node1236" class="node">
<title>transpose_back_3_5</title>
<ellipse fill="lightgray" stroke="black" cx="13172.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13172.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13172.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13172.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_5&#45;&gt;transpose_back_3_5 -->
<g id="edge1494" class="edge">
<title>attn_output_3_5&#45;&gt;transpose_back_3_5</title>
<path fill="none" stroke="black" d="M13020.8,-2438.46C13045.38,-2425.94 13073.62,-2411.56 13099.01,-2398.63"/>
<polygon fill="black" stroke="black" points="13100.9,-2401.59 13108.23,-2393.94 13097.73,-2395.36 13100.9,-2401.59"/>
</g>
<!-- softmax_3_5&#45;&gt;attn_output_3_5 -->
<g id="edge1493" class="edge">
<title>softmax_3_5&#45;&gt;attn_output_3_5</title>
<path fill="none" stroke="black" d="M12801.09,-2549.86C12826.43,-2537.36 12855.38,-2523.08 12881.38,-2510.26"/>
<polygon fill="black" stroke="black" points="12883.02,-2513.35 12890.44,-2505.79 12879.92,-2507.07 12883.02,-2513.35"/>
</g>
<!-- reshape_concat_3_5 -->
<g id="node1237" class="node">
<title>reshape_concat_3_5</title>
<ellipse fill="lightcyan" stroke="black" cx="13268.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13268.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13268.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13268.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_5&#45;&gt;reshape_concat_3_5 -->
<g id="edge1495" class="edge">
<title>transpose_back_3_5&#45;&gt;reshape_concat_3_5</title>
<path fill="none" stroke="black" d="M13203.74,-2323.45C13212.38,-2313.55 13221.85,-2302.7 13230.82,-2292.42"/>
<polygon fill="black" stroke="black" points="13233.62,-2294.54 13237.56,-2284.7 13228.35,-2289.93 13233.62,-2294.54"/>
</g>
<!-- reshape_concat_3_5&#45;&gt;allgather_dim_3_1 -->
<g id="edge1496" class="edge">
<title>reshape_concat_3_5&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M13351.85,-2218.69C13409.55,-2198.96 13486.31,-2172.71 13545.44,-2152.49"/>
<polygon fill="black" stroke="black" points="13546.82,-2155.72 13555.15,-2149.17 13544.55,-2149.09 13546.82,-2155.72"/>
</g>
<!-- split_q_3_6 -->
<g id="node1239" class="node">
<title>split_q_3_6</title>
<ellipse fill="pink" stroke="black" cx="13265.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13265.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="13265.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13265.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_q_3_6 -->
<g id="edge1498" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_q_3_6</title>
<path fill="none" stroke="black" d="M13558.64,-3003.2C13501.67,-2987.25 13430.29,-2967.27 13372.24,-2951.02"/>
<polygon fill="black" stroke="black" points="13372.88,-2947.57 13362.31,-2948.24 13370.99,-2954.31 13372.88,-2947.57"/>
</g>
<!-- split_k_3_6 -->
<g id="node1240" class="node">
<title>split_k_3_6</title>
<ellipse fill="pink" stroke="black" cx="13574.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13574.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="13574.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13574.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_k_3_6 -->
<g id="edge1499" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_k_3_6</title>
<path fill="none" stroke="black" d="M13631.07,-2995.15C13623.82,-2985.65 13615.91,-2975.29 13608.37,-2965.42"/>
<polygon fill="black" stroke="black" points="13610.99,-2963.09 13602.14,-2957.27 13605.43,-2967.34 13610.99,-2963.09"/>
</g>
<!-- split_v_3_6 -->
<g id="node1241" class="node">
<title>split_v_3_6</title>
<ellipse fill="pink" stroke="black" cx="13883.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13883.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="13883.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13883.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_6&#45;&gt;split_v_3_6 -->
<g id="edge1500" class="edge">
<title>reshape_qkv_3_6&#45;&gt;split_v_3_6</title>
<path fill="none" stroke="black" d="M13726.08,-2998.16C13751.9,-2985.54 13781.51,-2971.06 13808.03,-2958.1"/>
<polygon fill="black" stroke="black" points="13809.83,-2961.11 13817.28,-2953.58 13806.75,-2954.83 13809.83,-2961.11"/>
</g>
<!-- transpose_q_3_6 -->
<g id="node1242" class="node">
<title>transpose_q_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="13265.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13265.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="13265.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13265.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_6&#45;&gt;transpose_q_3_6 -->
<g id="edge1501" class="edge">
<title>split_q_3_6&#45;&gt;transpose_q_3_6</title>
<path fill="none" stroke="black" d="M13265.57,-2882.54C13265.57,-2874.09 13265.57,-2864.99 13265.57,-2856.18"/>
<polygon fill="black" stroke="black" points="13269.07,-2856.01 13265.57,-2846.01 13262.07,-2856.01 13269.07,-2856.01"/>
</g>
<!-- transpose_k_3_6 -->
<g id="node1243" class="node">
<title>transpose_k_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="13574.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13574.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="13574.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13574.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_6&#45;&gt;transpose_k_3_6 -->
<g id="edge1502" class="edge">
<title>split_k_3_6&#45;&gt;transpose_k_3_6</title>
<path fill="none" stroke="black" d="M13574.57,-2882.54C13574.57,-2874.09 13574.57,-2864.99 13574.57,-2856.18"/>
<polygon fill="black" stroke="black" points="13578.07,-2856.01 13574.57,-2846.01 13571.07,-2856.01 13578.07,-2856.01"/>
</g>
<!-- transpose_v_3_6 -->
<g id="node1244" class="node">
<title>transpose_v_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="13883.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13883.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="13883.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13883.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_6&#45;&gt;transpose_v_3_6 -->
<g id="edge1503" class="edge">
<title>split_v_3_6&#45;&gt;transpose_v_3_6</title>
<path fill="none" stroke="black" d="M13883.57,-2882.54C13883.57,-2874.09 13883.57,-2864.99 13883.57,-2856.18"/>
<polygon fill="black" stroke="black" points="13887.07,-2856.01 13883.57,-2846.01 13880.07,-2856.01 13887.07,-2856.01"/>
</g>
<!-- attn_scores_3_6 -->
<g id="node1245" class="node">
<title>attn_scores_3_6</title>
<ellipse fill="gold" stroke="black" cx="13574.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13574.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="13574.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13574.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_6&#45;&gt;attn_scores_3_6 -->
<g id="edge1504" class="edge">
<title>transpose_q_3_6&#45;&gt;attn_scores_3_6</title>
<path fill="none" stroke="black" d="M13349.19,-2777.4C13388.91,-2763.26 13436.6,-2746.28 13477.86,-2731.59"/>
<polygon fill="black" stroke="black" points="13479.13,-2734.86 13487.38,-2728.21 13476.79,-2728.26 13479.13,-2734.86"/>
</g>
<!-- transpose_k_3_6&#45;&gt;attn_scores_3_6 -->
<g id="edge1505" class="edge">
<title>transpose_k_3_6&#45;&gt;attn_scores_3_6</title>
<path fill="none" stroke="black" d="M13574.57,-2770.54C13574.57,-2762.09 13574.57,-2752.99 13574.57,-2744.18"/>
<polygon fill="black" stroke="black" points="13578.07,-2744.01 13574.57,-2734.01 13571.07,-2744.01 13578.07,-2744.01"/>
</g>
<!-- attn_output_3_6 -->
<g id="node1246" class="node">
<title>attn_output_3_6</title>
<ellipse fill="gold" stroke="black" cx="13635.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13635.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="13635.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13635.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_6&#45;&gt;attn_output_3_6 -->
<g id="edge1506" class="edge">
<title>transpose_v_3_6&#45;&gt;attn_output_3_6</title>
<path fill="none" stroke="black" d="M13877.95,-2770.36C13867.84,-2715.5 13841.84,-2611.77 13782.57,-2546.67 13768.06,-2530.73 13749.32,-2517.8 13730.1,-2507.48"/>
<polygon fill="black" stroke="black" points="13731.44,-2504.24 13720.95,-2502.78 13728.24,-2510.47 13731.44,-2504.24"/>
</g>
<!-- softmax_3_6 -->
<g id="node1247" class="node">
<title>softmax_3_6</title>
<ellipse fill="gold" stroke="black" cx="13606.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="13606.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13606.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13606.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_6&#45;&gt;softmax_3_6 -->
<g id="edge1507" class="edge">
<title>attn_scores_3_6&#45;&gt;softmax_3_6</title>
<path fill="none" stroke="black" d="M13585.23,-2658.54C13587.77,-2649.82 13590.51,-2640.4 13593.15,-2631.31"/>
<polygon fill="black" stroke="black" points="13596.53,-2632.21 13595.96,-2621.63 13589.81,-2630.26 13596.53,-2632.21"/>
</g>
<!-- transpose_back_3_6 -->
<g id="node1248" class="node">
<title>transpose_back_3_6</title>
<ellipse fill="lightgray" stroke="black" cx="13635.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="13635.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="13635.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13635.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_6&#45;&gt;transpose_back_3_6 -->
<g id="edge1509" class="edge">
<title>attn_output_3_6&#45;&gt;transpose_back_3_6</title>
<path fill="none" stroke="black" d="M13635.57,-2434.54C13635.57,-2426.09 13635.57,-2416.99 13635.57,-2408.18"/>
<polygon fill="black" stroke="black" points="13639.07,-2408.01 13635.57,-2398.01 13632.07,-2408.01 13639.07,-2408.01"/>
</g>
<!-- softmax_3_6&#45;&gt;attn_output_3_6 -->
<g id="edge1508" class="edge">
<title>softmax_3_6&#45;&gt;attn_output_3_6</title>
<path fill="none" stroke="black" d="M13616.23,-2546.54C13618.53,-2537.82 13621.01,-2528.4 13623.41,-2519.31"/>
<polygon fill="black" stroke="black" points="13626.79,-2520.2 13625.96,-2509.63 13620.03,-2518.41 13626.79,-2520.2"/>
</g>
<!-- reshape_concat_3_6 -->
<g id="node1249" class="node">
<title>reshape_concat_3_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13635.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="13635.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="13635.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="13635.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_6&#45;&gt;reshape_concat_3_6 -->
<g id="edge1510" class="edge">
<title>transpose_back_3_6&#45;&gt;reshape_concat_3_6</title>
<path fill="none" stroke="black" d="M13635.57,-2322.54C13635.57,-2314.09 13635.57,-2304.99 13635.57,-2296.18"/>
<polygon fill="black" stroke="black" points="13639.07,-2296.01 13635.57,-2286.01 13632.07,-2296.01 13639.07,-2296.01"/>
</g>
<!-- reshape_concat_3_6&#45;&gt;allgather_dim_3_1 -->
<g id="edge1511" class="edge">
<title>reshape_concat_3_6&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M13635.57,-2210.53C13635.57,-2202.22 13635.57,-2193.18 13635.57,-2184.13"/>
<polygon fill="black" stroke="black" points="13639.07,-2183.97 13635.57,-2173.97 13632.07,-2183.97 13639.07,-2183.97"/>
</g>
<!-- split_q_3_7 -->
<g id="node1251" class="node">
<title>split_q_3_7</title>
<ellipse fill="pink" stroke="black" cx="14192.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14192.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="14192.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14192.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_q_3_7 -->
<g id="edge1513" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_q_3_7</title>
<path fill="none" stroke="black" d="M14419.94,-3000.82C14378.51,-2986.3 14328.83,-2968.9 14286.5,-2954.07"/>
<polygon fill="black" stroke="black" points="14287.62,-2950.75 14277.03,-2950.75 14285.31,-2957.36 14287.62,-2950.75"/>
</g>
<!-- split_k_3_7 -->
<g id="node1252" class="node">
<title>split_k_3_7</title>
<ellipse fill="pink" stroke="black" cx="14501.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14501.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="14501.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14501.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_k_3_7 -->
<g id="edge1514" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_k_3_7</title>
<path fill="none" stroke="black" d="M14504.91,-2994.54C14504.52,-2986.09 14504.11,-2976.99 14503.71,-2968.18"/>
<polygon fill="black" stroke="black" points="14507.2,-2967.84 14503.25,-2958.01 14500.21,-2968.16 14507.2,-2967.84"/>
</g>
<!-- split_v_3_7 -->
<g id="node1253" class="node">
<title>split_v_3_7</title>
<ellipse fill="pink" stroke="black" cx="14810.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14810.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="14810.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14810.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_7&#45;&gt;split_v_3_7 -->
<g id="edge1515" class="edge">
<title>reshape_qkv_3_7&#45;&gt;split_v_3_7</title>
<path fill="none" stroke="black" d="M14591.25,-3000.52C14630.78,-2986.22 14677.91,-2969.17 14718.34,-2954.54"/>
<polygon fill="black" stroke="black" points="14719.71,-2957.77 14727.92,-2951.07 14717.33,-2951.18 14719.71,-2957.77"/>
</g>
<!-- transpose_q_3_7 -->
<g id="node1254" class="node">
<title>transpose_q_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="14192.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14192.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="14192.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14192.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_7&#45;&gt;transpose_q_3_7 -->
<g id="edge1516" class="edge">
<title>split_q_3_7&#45;&gt;transpose_q_3_7</title>
<path fill="none" stroke="black" d="M14192.57,-2882.54C14192.57,-2874.09 14192.57,-2864.99 14192.57,-2856.18"/>
<polygon fill="black" stroke="black" points="14196.07,-2856.01 14192.57,-2846.01 14189.07,-2856.01 14196.07,-2856.01"/>
</g>
<!-- transpose_k_3_7 -->
<g id="node1255" class="node">
<title>transpose_k_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="14501.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14501.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="14501.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14501.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_7&#45;&gt;transpose_k_3_7 -->
<g id="edge1517" class="edge">
<title>split_k_3_7&#45;&gt;transpose_k_3_7</title>
<path fill="none" stroke="black" d="M14501.57,-2882.54C14501.57,-2874.09 14501.57,-2864.99 14501.57,-2856.18"/>
<polygon fill="black" stroke="black" points="14505.07,-2856.01 14501.57,-2846.01 14498.07,-2856.01 14505.07,-2856.01"/>
</g>
<!-- transpose_v_3_7 -->
<g id="node1256" class="node">
<title>transpose_v_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="14810.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14810.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="14810.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14810.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_7&#45;&gt;transpose_v_3_7 -->
<g id="edge1518" class="edge">
<title>split_v_3_7&#45;&gt;transpose_v_3_7</title>
<path fill="none" stroke="black" d="M14810.57,-2882.54C14810.57,-2874.09 14810.57,-2864.99 14810.57,-2856.18"/>
<polygon fill="black" stroke="black" points="14814.07,-2856.01 14810.57,-2846.01 14807.07,-2856.01 14814.07,-2856.01"/>
</g>
<!-- attn_scores_3_7 -->
<g id="node1257" class="node">
<title>attn_scores_3_7</title>
<ellipse fill="gold" stroke="black" cx="14458.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14458.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="14458.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14458.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_7&#45;&gt;attn_scores_3_7 -->
<g id="edge1519" class="edge">
<title>transpose_q_3_7&#45;&gt;attn_scores_3_7</title>
<path fill="none" stroke="black" d="M14268.09,-2775.94C14300.24,-2762.64 14337.94,-2747.05 14371.28,-2733.27"/>
<polygon fill="black" stroke="black" points="14372.65,-2736.48 14380.56,-2729.43 14369.98,-2730.02 14372.65,-2736.48"/>
</g>
<!-- transpose_k_3_7&#45;&gt;attn_scores_3_7 -->
<g id="edge1520" class="edge">
<title>transpose_k_3_7&#45;&gt;attn_scores_3_7</title>
<path fill="none" stroke="black" d="M14487.37,-2770.84C14483.92,-2762.02 14480.19,-2752.47 14476.59,-2743.26"/>
<polygon fill="black" stroke="black" points="14479.81,-2741.87 14472.9,-2733.83 14473.29,-2744.41 14479.81,-2741.87"/>
</g>
<!-- attn_output_3_7 -->
<g id="node1258" class="node">
<title>attn_output_3_7</title>
<ellipse fill="gold" stroke="black" cx="14458.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14458.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="14458.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14458.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_7&#45;&gt;attn_output_3_7 -->
<g id="edge1521" class="edge">
<title>transpose_v_3_7&#45;&gt;attn_output_3_7</title>
<path fill="none" stroke="black" d="M14794.44,-2770.68C14768.27,-2715.29 14711.64,-2609.77 14634.57,-2546.67 14613.35,-2529.29 14587.44,-2515.46 14562.09,-2504.71"/>
<polygon fill="black" stroke="black" points="14563.37,-2501.45 14552.79,-2500.89 14560.71,-2507.92 14563.37,-2501.45"/>
</g>
<!-- softmax_3_7 -->
<g id="node1259" class="node">
<title>softmax_3_7</title>
<ellipse fill="gold" stroke="black" cx="14458.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="14458.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14458.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14458.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_7&#45;&gt;softmax_3_7 -->
<g id="edge1522" class="edge">
<title>attn_scores_3_7&#45;&gt;softmax_3_7</title>
<path fill="none" stroke="black" d="M14458.57,-2658.54C14458.57,-2650.09 14458.57,-2640.99 14458.57,-2632.18"/>
<polygon fill="black" stroke="black" points="14462.07,-2632.01 14458.57,-2622.01 14455.07,-2632.01 14462.07,-2632.01"/>
</g>
<!-- transpose_back_3_7 -->
<g id="node1260" class="node">
<title>transpose_back_3_7</title>
<ellipse fill="lightgray" stroke="black" cx="14343.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="14343.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="14343.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14343.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_7&#45;&gt;transpose_back_3_7 -->
<g id="edge1524" class="edge">
<title>attn_output_3_7&#45;&gt;transpose_back_3_7</title>
<path fill="none" stroke="black" d="M14421.55,-2435.76C14410.88,-2425.55 14399.13,-2414.31 14388.06,-2403.72"/>
<polygon fill="black" stroke="black" points="14390.17,-2400.89 14380.52,-2396.51 14385.33,-2405.95 14390.17,-2400.89"/>
</g>
<!-- softmax_3_7&#45;&gt;attn_output_3_7 -->
<g id="edge1523" class="edge">
<title>softmax_3_7&#45;&gt;attn_output_3_7</title>
<path fill="none" stroke="black" d="M14458.57,-2546.54C14458.57,-2538.09 14458.57,-2528.99 14458.57,-2520.18"/>
<polygon fill="black" stroke="black" points="14462.07,-2520.01 14458.57,-2510.01 14455.07,-2520.01 14462.07,-2520.01"/>
</g>
<!-- reshape_concat_3_7 -->
<g id="node1261" class="node">
<title>reshape_concat_3_7</title>
<ellipse fill="lightcyan" stroke="black" cx="14113.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="14113.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="14113.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14113.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_7&#45;&gt;reshape_concat_3_7 -->
<g id="edge1525" class="edge">
<title>transpose_back_3_7&#45;&gt;reshape_concat_3_7</title>
<path fill="none" stroke="black" d="M14276.12,-2326.91C14248.85,-2313.86 14217.25,-2298.75 14189.2,-2285.34"/>
<polygon fill="black" stroke="black" points="14190.37,-2282.01 14179.84,-2280.86 14187.35,-2288.33 14190.37,-2282.01"/>
</g>
<!-- reshape_concat_3_7&#45;&gt;allgather_dim_3_1 -->
<g id="edge1526" class="edge">
<title>reshape_concat_3_7&#45;&gt;allgather_dim_3_1</title>
<path fill="none" stroke="black" d="M14017.99,-2222.07C13936.62,-2200.71 13820.05,-2170.1 13737.04,-2148.31"/>
<polygon fill="black" stroke="black" points="13737.9,-2144.91 13727.34,-2145.76 13736.12,-2151.68 13737.9,-2144.91"/>
</g>
<!-- output_proj_3_1 -->
<g id="node1364" class="node">
<title>output_proj_3_1</title>
<ellipse fill="orange" stroke="black" cx="14015.57" cy="-1907.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="14015.57" y="-1926.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14015.57" y="-1911.38" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14015.57" y="-1896.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14015.57" y="-1881.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_1&#45;&gt;output_proj_3_1 -->
<g id="edge1651" class="edge">
<title>head_group_3_1&#45;&gt;output_proj_3_1</title>
<path fill="none" stroke="black" d="M13770.16,-1992.65C13808.38,-1979.56 13861.44,-1961.38 13908.44,-1945.28"/>
<polygon fill="black" stroke="black" points="13909.73,-1948.54 13918.06,-1941.99 13907.47,-1941.92 13909.73,-1948.54"/>
</g>
<!-- split_q_3_8 -->
<g id="node1264" class="node">
<title>split_q_3_8</title>
<ellipse fill="pink" stroke="black" cx="15119.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15119.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="15119.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15119.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_q_3_8 -->
<g id="edge1529" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_q_3_8</title>
<path fill="none" stroke="black" d="M15242.23,-2996.96C15223.47,-2985.37 15202.36,-2972.33 15183.02,-2960.38"/>
<polygon fill="black" stroke="black" points="15184.62,-2957.25 15174.27,-2954.97 15180.94,-2963.2 15184.62,-2957.25"/>
</g>
<!-- split_k_3_8 -->
<g id="node1265" class="node">
<title>split_k_3_8</title>
<ellipse fill="pink" stroke="black" cx="15428.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15428.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="15428.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15428.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_k_3_8 -->
<g id="edge1530" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_k_3_8</title>
<path fill="none" stroke="black" d="M15339.74,-2995.76C15352.26,-2985.25 15366.07,-2973.65 15379.01,-2962.78"/>
<polygon fill="black" stroke="black" points="15381.52,-2965.24 15386.93,-2956.13 15377.02,-2959.88 15381.52,-2965.24"/>
</g>
<!-- split_v_3_8 -->
<g id="node1266" class="node">
<title>split_v_3_8</title>
<ellipse fill="pink" stroke="black" cx="15737.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15737.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="15737.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15737.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_8&#45;&gt;split_v_3_8 -->
<g id="edge1531" class="edge">
<title>reshape_qkv_3_8&#45;&gt;split_v_3_8</title>
<path fill="none" stroke="black" d="M15403.8,-3004.61C15470.7,-2987.88 15556.97,-2966.32 15625.04,-2949.3"/>
<polygon fill="black" stroke="black" points="15626.09,-2952.64 15634.94,-2946.82 15624.39,-2945.85 15626.09,-2952.64"/>
</g>
<!-- transpose_q_3_8 -->
<g id="node1267" class="node">
<title>transpose_q_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="15119.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15119.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="15119.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15119.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_8&#45;&gt;transpose_q_3_8 -->
<g id="edge1532" class="edge">
<title>split_q_3_8&#45;&gt;transpose_q_3_8</title>
<path fill="none" stroke="black" d="M15119.57,-2882.54C15119.57,-2874.09 15119.57,-2864.99 15119.57,-2856.18"/>
<polygon fill="black" stroke="black" points="15123.07,-2856.01 15119.57,-2846.01 15116.07,-2856.01 15123.07,-2856.01"/>
</g>
<!-- transpose_k_3_8 -->
<g id="node1268" class="node">
<title>transpose_k_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="15428.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15428.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="15428.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15428.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_8&#45;&gt;transpose_k_3_8 -->
<g id="edge1533" class="edge">
<title>split_k_3_8&#45;&gt;transpose_k_3_8</title>
<path fill="none" stroke="black" d="M15428.57,-2882.54C15428.57,-2874.09 15428.57,-2864.99 15428.57,-2856.18"/>
<polygon fill="black" stroke="black" points="15432.07,-2856.01 15428.57,-2846.01 15425.07,-2856.01 15432.07,-2856.01"/>
</g>
<!-- transpose_v_3_8 -->
<g id="node1269" class="node">
<title>transpose_v_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="15737.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15737.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="15737.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15737.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_8&#45;&gt;transpose_v_3_8 -->
<g id="edge1534" class="edge">
<title>split_v_3_8&#45;&gt;transpose_v_3_8</title>
<path fill="none" stroke="black" d="M15737.57,-2882.54C15737.57,-2874.09 15737.57,-2864.99 15737.57,-2856.18"/>
<polygon fill="black" stroke="black" points="15741.07,-2856.01 15737.57,-2846.01 15734.07,-2856.01 15741.07,-2856.01"/>
</g>
<!-- attn_scores_3_8 -->
<g id="node1270" class="node">
<title>attn_scores_3_8</title>
<ellipse fill="gold" stroke="black" cx="15428.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15428.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="15428.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15428.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_8&#45;&gt;attn_scores_3_8 -->
<g id="edge1535" class="edge">
<title>transpose_q_3_8&#45;&gt;attn_scores_3_8</title>
<path fill="none" stroke="black" d="M15203.19,-2777.4C15242.91,-2763.26 15290.6,-2746.28 15331.86,-2731.59"/>
<polygon fill="black" stroke="black" points="15333.13,-2734.86 15341.38,-2728.21 15330.79,-2728.26 15333.13,-2734.86"/>
</g>
<!-- transpose_k_3_8&#45;&gt;attn_scores_3_8 -->
<g id="edge1536" class="edge">
<title>transpose_k_3_8&#45;&gt;attn_scores_3_8</title>
<path fill="none" stroke="black" d="M15428.57,-2770.54C15428.57,-2762.09 15428.57,-2752.99 15428.57,-2744.18"/>
<polygon fill="black" stroke="black" points="15432.07,-2744.01 15428.57,-2734.01 15425.07,-2744.01 15432.07,-2744.01"/>
</g>
<!-- attn_output_3_8 -->
<g id="node1271" class="node">
<title>attn_output_3_8</title>
<ellipse fill="gold" stroke="black" cx="15737.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15737.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="15737.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15737.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_8&#45;&gt;attn_output_3_8 -->
<g id="edge1537" class="edge">
<title>transpose_v_3_8&#45;&gt;attn_output_3_8</title>
<path fill="none" stroke="black" d="M15737.57,-2770.47C15737.57,-2709.42 15737.57,-2587.11 15737.57,-2519.96"/>
<polygon fill="black" stroke="black" points="15741.07,-2519.67 15737.57,-2509.67 15734.07,-2519.67 15741.07,-2519.67"/>
</g>
<!-- softmax_3_8 -->
<g id="node1272" class="node">
<title>softmax_3_8</title>
<ellipse fill="gold" stroke="black" cx="15513.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="15513.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="15513.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15513.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_8&#45;&gt;softmax_3_8 -->
<g id="edge1538" class="edge">
<title>attn_scores_3_8&#45;&gt;softmax_3_8</title>
<path fill="none" stroke="black" d="M15456.41,-2659.15C15463.74,-2649.65 15471.75,-2639.29 15479.38,-2629.42"/>
<polygon fill="black" stroke="black" points="15482.33,-2631.32 15485.68,-2621.27 15476.79,-2627.04 15482.33,-2631.32"/>
</g>
<!-- transpose_back_3_8 -->
<g id="node1273" class="node">
<title>transpose_back_3_8</title>
<ellipse fill="lightgray" stroke="black" cx="15988.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="15988.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="15988.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15988.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_8&#45;&gt;transpose_back_3_8 -->
<g id="edge1540" class="edge">
<title>attn_output_3_8&#45;&gt;transpose_back_3_8</title>
<path fill="none" stroke="black" d="M15809.84,-2439.5C15840.15,-2426.21 15875.56,-2410.69 15906.83,-2396.99"/>
<polygon fill="black" stroke="black" points="15908.63,-2400.02 15916.39,-2392.8 15905.82,-2393.61 15908.63,-2400.02"/>
</g>
<!-- softmax_3_8&#45;&gt;attn_output_3_8 -->
<g id="edge1539" class="edge">
<title>softmax_3_8&#45;&gt;attn_output_3_8</title>
<path fill="none" stroke="black" d="M15581.39,-2549.86C15606.96,-2537.31 15636.19,-2522.95 15662.4,-2510.08"/>
<polygon fill="black" stroke="black" points="15664.09,-2513.15 15671.53,-2505.6 15661.01,-2506.87 15664.09,-2513.15"/>
</g>
<!-- reshape_concat_3_8 -->
<g id="node1274" class="node">
<title>reshape_concat_3_8</title>
<ellipse fill="lightcyan" stroke="black" cx="16253.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16253.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16253.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16253.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_8&#45;&gt;reshape_concat_3_8 -->
<g id="edge1541" class="edge">
<title>transpose_back_3_8&#45;&gt;reshape_concat_3_8</title>
<path fill="none" stroke="black" d="M16063.8,-2327.94C16097.23,-2314.06 16136.68,-2297.69 16170.93,-2283.47"/>
<polygon fill="black" stroke="black" points="16172.55,-2286.59 16180.44,-2279.52 16169.87,-2280.12 16172.55,-2286.59"/>
</g>
<!-- allgather_dim_3_2 -->
<g id="node1275" class="node">
<title>allgather_dim_3_2</title>
<polygon fill="red" stroke="black" points="16549.57,-2173.67 16376.57,-2120.67 16549.57,-2067.67 16722.57,-2120.67 16549.57,-2173.67"/>
<text text-anchor="middle" x="16549.57" y="-2131.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="16549.57" y="-2116.97" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16549.57" y="-2101.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_8&#45;&gt;allgather_dim_3_2 -->
<g id="edge1542" class="edge">
<title>reshape_concat_3_8&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M16325.6,-2216.63C16368.9,-2198.27 16424.1,-2174.87 16468.86,-2155.89"/>
<polygon fill="black" stroke="black" points="16470.4,-2159.03 16478.25,-2151.91 16467.67,-2152.59 16470.4,-2159.03"/>
</g>
<!-- head_group_3_2 -->
<g id="node1312" class="node">
<title>head_group_3_2</title>
<polygon fill="lightyellow" stroke="black" points="16484.07,-2030.67 16287.07,-2030.67 16287.07,-1992.67 16484.07,-1992.67 16484.07,-2030.67"/>
<text text-anchor="middle" x="16385.57" y="-2015.47" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="16385.57" y="-2000.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_2&#45;&gt;head_group_3_2 -->
<g id="edge1588" class="edge">
<title>allgather_dim_3_2&#45;&gt;head_group_3_2</title>
<path fill="none" stroke="black" d="M16494.96,-2084.04C16470.89,-2068.33 16443.25,-2050.3 16421.78,-2036.29"/>
<polygon fill="black" stroke="black" points="16423.57,-2033.28 16413.28,-2030.74 16419.74,-2039.14 16423.57,-2033.28"/>
</g>
<!-- split_q_3_9 -->
<g id="node1277" class="node">
<title>split_q_3_9</title>
<ellipse fill="pink" stroke="black" cx="16046.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16046.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16046.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16046.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_q_3_9 -->
<g id="edge1544" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_q_3_9</title>
<path fill="none" stroke="black" d="M16129.98,-2995.76C16118.46,-2985.45 16105.75,-2974.09 16093.81,-2963.41"/>
<polygon fill="black" stroke="black" points="16095.88,-2960.57 16086.09,-2956.51 16091.22,-2965.79 16095.88,-2960.57"/>
</g>
<!-- split_k_3_9 -->
<g id="node1278" class="node">
<title>split_k_3_9</title>
<ellipse fill="pink" stroke="black" cx="16355.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16355.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="16355.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16355.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_k_3_9 -->
<g id="edge1545" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_k_3_9</title>
<path fill="none" stroke="black" d="M16226.9,-2997.26C16246.88,-2985.44 16269.46,-2972.09 16290.06,-2959.91"/>
<polygon fill="black" stroke="black" points="16291.93,-2962.87 16298.76,-2954.77 16288.37,-2956.84 16291.93,-2962.87"/>
</g>
<!-- split_v_3_9 -->
<g id="node1279" class="node">
<title>split_v_3_9</title>
<ellipse fill="pink" stroke="black" cx="16664.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16664.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="16664.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16664.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_9&#45;&gt;split_v_3_9 -->
<g id="edge1546" class="edge">
<title>reshape_qkv_3_9&#45;&gt;split_v_3_9</title>
<path fill="none" stroke="black" d="M16285.32,-3006.83C16351.38,-2992.79 16435.7,-2974.61 16510.57,-2957.67 16523.28,-2954.79 16536.56,-2951.73 16549.77,-2948.65"/>
<polygon fill="black" stroke="black" points="16550.91,-2951.98 16559.85,-2946.29 16549.31,-2945.16 16550.91,-2951.98"/>
</g>
<!-- transpose_q_3_9 -->
<g id="node1280" class="node">
<title>transpose_q_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="16046.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16046.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16046.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16046.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_9&#45;&gt;transpose_q_3_9 -->
<g id="edge1547" class="edge">
<title>split_q_3_9&#45;&gt;transpose_q_3_9</title>
<path fill="none" stroke="black" d="M16046.57,-2882.54C16046.57,-2874.09 16046.57,-2864.99 16046.57,-2856.18"/>
<polygon fill="black" stroke="black" points="16050.07,-2856.01 16046.57,-2846.01 16043.07,-2856.01 16050.07,-2856.01"/>
</g>
<!-- transpose_k_3_9 -->
<g id="node1281" class="node">
<title>transpose_k_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="16355.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16355.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="16355.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16355.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_9&#45;&gt;transpose_k_3_9 -->
<g id="edge1548" class="edge">
<title>split_k_3_9&#45;&gt;transpose_k_3_9</title>
<path fill="none" stroke="black" d="M16355.57,-2882.54C16355.57,-2874.09 16355.57,-2864.99 16355.57,-2856.18"/>
<polygon fill="black" stroke="black" points="16359.07,-2856.01 16355.57,-2846.01 16352.07,-2856.01 16359.07,-2856.01"/>
</g>
<!-- transpose_v_3_9 -->
<g id="node1282" class="node">
<title>transpose_v_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="16664.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16664.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="16664.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16664.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_9&#45;&gt;transpose_v_3_9 -->
<g id="edge1549" class="edge">
<title>split_v_3_9&#45;&gt;transpose_v_3_9</title>
<path fill="none" stroke="black" d="M16664.57,-2882.54C16664.57,-2874.09 16664.57,-2864.99 16664.57,-2856.18"/>
<polygon fill="black" stroke="black" points="16668.07,-2856.01 16664.57,-2846.01 16661.07,-2856.01 16668.07,-2856.01"/>
</g>
<!-- attn_scores_3_9 -->
<g id="node1283" class="node">
<title>attn_scores_3_9</title>
<ellipse fill="gold" stroke="black" cx="16355.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16355.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="16355.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16355.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_9&#45;&gt;attn_scores_3_9 -->
<g id="edge1550" class="edge">
<title>transpose_q_3_9&#45;&gt;attn_scores_3_9</title>
<path fill="none" stroke="black" d="M16130.19,-2777.4C16169.91,-2763.26 16217.6,-2746.28 16258.86,-2731.59"/>
<polygon fill="black" stroke="black" points="16260.13,-2734.86 16268.38,-2728.21 16257.79,-2728.26 16260.13,-2734.86"/>
</g>
<!-- transpose_k_3_9&#45;&gt;attn_scores_3_9 -->
<g id="edge1551" class="edge">
<title>transpose_k_3_9&#45;&gt;attn_scores_3_9</title>
<path fill="none" stroke="black" d="M16355.57,-2770.54C16355.57,-2762.09 16355.57,-2752.99 16355.57,-2744.18"/>
<polygon fill="black" stroke="black" points="16359.07,-2744.01 16355.57,-2734.01 16352.07,-2744.01 16359.07,-2744.01"/>
</g>
<!-- attn_output_3_9 -->
<g id="node1284" class="node">
<title>attn_output_3_9</title>
<ellipse fill="gold" stroke="black" cx="16549.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16549.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="16549.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16549.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_9&#45;&gt;attn_output_3_9 -->
<g id="edge1552" class="edge">
<title>transpose_v_3_9&#45;&gt;attn_output_3_9</title>
<path fill="none" stroke="black" d="M16664.09,-2770.65C16662.06,-2718.38 16653.17,-2620.4 16616.57,-2546.67 16611.24,-2535.91 16603.86,-2525.58 16595.94,-2516.23"/>
<polygon fill="black" stroke="black" points="16598.44,-2513.78 16589.19,-2508.62 16593.2,-2518.42 16598.44,-2513.78"/>
</g>
<!-- softmax_3_9 -->
<g id="node1285" class="node">
<title>softmax_3_9</title>
<ellipse fill="gold" stroke="black" cx="16440.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="16440.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16440.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16440.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_9&#45;&gt;softmax_3_9 -->
<g id="edge1553" class="edge">
<title>attn_scores_3_9&#45;&gt;softmax_3_9</title>
<path fill="none" stroke="black" d="M16383.41,-2659.15C16390.74,-2649.65 16398.75,-2639.29 16406.38,-2629.42"/>
<polygon fill="black" stroke="black" points="16409.33,-2631.32 16412.68,-2621.27 16403.79,-2627.04 16409.33,-2631.32"/>
</g>
<!-- transpose_back_3_9 -->
<g id="node1286" class="node">
<title>transpose_back_3_9</title>
<ellipse fill="lightgray" stroke="black" cx="16549.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16549.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="16549.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16549.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_9&#45;&gt;transpose_back_3_9 -->
<g id="edge1555" class="edge">
<title>attn_output_3_9&#45;&gt;transpose_back_3_9</title>
<path fill="none" stroke="black" d="M16549.57,-2434.54C16549.57,-2426.09 16549.57,-2416.99 16549.57,-2408.18"/>
<polygon fill="black" stroke="black" points="16553.07,-2408.01 16549.57,-2398.01 16546.07,-2408.01 16553.07,-2408.01"/>
</g>
<!-- softmax_3_9&#45;&gt;attn_output_3_9 -->
<g id="edge1554" class="edge">
<title>softmax_3_9&#45;&gt;attn_output_3_9</title>
<path fill="none" stroke="black" d="M16475.96,-2547.45C16485.96,-2537.36 16496.95,-2526.28 16507.31,-2515.82"/>
<polygon fill="black" stroke="black" points="16509.81,-2518.27 16514.36,-2508.7 16504.84,-2513.34 16509.81,-2518.27"/>
</g>
<!-- reshape_concat_3_9 -->
<g id="node1287" class="node">
<title>reshape_concat_3_9</title>
<ellipse fill="lightcyan" stroke="black" cx="16549.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16549.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16549.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16549.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_9&#45;&gt;reshape_concat_3_9 -->
<g id="edge1556" class="edge">
<title>transpose_back_3_9&#45;&gt;reshape_concat_3_9</title>
<path fill="none" stroke="black" d="M16549.57,-2322.54C16549.57,-2314.09 16549.57,-2304.99 16549.57,-2296.18"/>
<polygon fill="black" stroke="black" points="16553.07,-2296.01 16549.57,-2286.01 16546.07,-2296.01 16553.07,-2296.01"/>
</g>
<!-- reshape_concat_3_9&#45;&gt;allgather_dim_3_2 -->
<g id="edge1557" class="edge">
<title>reshape_concat_3_9&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M16549.57,-2210.53C16549.57,-2202.22 16549.57,-2193.18 16549.57,-2184.13"/>
<polygon fill="black" stroke="black" points="16553.07,-2183.97 16549.57,-2173.97 16546.07,-2183.97 16553.07,-2183.97"/>
</g>
<!-- split_q_3_10 -->
<g id="node1289" class="node">
<title>split_q_3_10</title>
<ellipse fill="pink" stroke="black" cx="16973.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16973.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="16973.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16973.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_q_3_10 -->
<g id="edge1559" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_q_3_10</title>
<path fill="none" stroke="black" d="M17030.07,-2995.15C17022.82,-2985.65 17014.91,-2975.29 17007.37,-2965.42"/>
<polygon fill="black" stroke="black" points="17009.99,-2963.09 17001.14,-2957.27 17004.43,-2967.34 17009.99,-2963.09"/>
</g>
<!-- split_k_3_10 -->
<g id="node1290" class="node">
<title>split_k_3_10</title>
<ellipse fill="pink" stroke="black" cx="17282.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17282.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="17282.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17282.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_k_3_10 -->
<g id="edge1560" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_k_3_10</title>
<path fill="none" stroke="black" d="M17125.08,-2998.16C17150.9,-2985.54 17180.51,-2971.06 17207.03,-2958.1"/>
<polygon fill="black" stroke="black" points="17208.83,-2961.11 17216.28,-2953.58 17205.75,-2954.83 17208.83,-2961.11"/>
</g>
<!-- split_v_3_10 -->
<g id="node1291" class="node">
<title>split_v_3_10</title>
<ellipse fill="pink" stroke="black" cx="17591.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17591.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="17591.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17591.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_10&#45;&gt;split_v_3_10 -->
<g id="edge1561" class="edge">
<title>reshape_qkv_3_10&#45;&gt;split_v_3_10</title>
<path fill="none" stroke="black" d="M17180.2,-3008.79C17254.77,-2994.85 17351.85,-2976.11 17437.57,-2957.67 17450.54,-2954.88 17464.1,-2951.84 17477.56,-2948.75"/>
<polygon fill="black" stroke="black" points="17478.37,-2952.15 17487.33,-2946.49 17476.8,-2945.33 17478.37,-2952.15"/>
</g>
<!-- transpose_q_3_10 -->
<g id="node1292" class="node">
<title>transpose_q_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="16973.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="16973.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="16973.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16973.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_10&#45;&gt;transpose_q_3_10 -->
<g id="edge1562" class="edge">
<title>split_q_3_10&#45;&gt;transpose_q_3_10</title>
<path fill="none" stroke="black" d="M16973.57,-2882.54C16973.57,-2874.09 16973.57,-2864.99 16973.57,-2856.18"/>
<polygon fill="black" stroke="black" points="16977.07,-2856.01 16973.57,-2846.01 16970.07,-2856.01 16977.07,-2856.01"/>
</g>
<!-- transpose_k_3_10 -->
<g id="node1293" class="node">
<title>transpose_k_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="17282.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17282.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="17282.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17282.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_10&#45;&gt;transpose_k_3_10 -->
<g id="edge1563" class="edge">
<title>split_k_3_10&#45;&gt;transpose_k_3_10</title>
<path fill="none" stroke="black" d="M17282.57,-2882.54C17282.57,-2874.09 17282.57,-2864.99 17282.57,-2856.18"/>
<polygon fill="black" stroke="black" points="17286.07,-2856.01 17282.57,-2846.01 17279.07,-2856.01 17286.07,-2856.01"/>
</g>
<!-- transpose_v_3_10 -->
<g id="node1294" class="node">
<title>transpose_v_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="17591.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17591.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="17591.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17591.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_10&#45;&gt;transpose_v_3_10 -->
<g id="edge1564" class="edge">
<title>split_v_3_10&#45;&gt;transpose_v_3_10</title>
<path fill="none" stroke="black" d="M17591.57,-2882.54C17591.57,-2874.09 17591.57,-2864.99 17591.57,-2856.18"/>
<polygon fill="black" stroke="black" points="17595.07,-2856.01 17591.57,-2846.01 17588.07,-2856.01 17595.07,-2856.01"/>
</g>
<!-- attn_scores_3_10 -->
<g id="node1295" class="node">
<title>attn_scores_3_10</title>
<ellipse fill="gold" stroke="black" cx="17150.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17150.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="17150.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17150.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_10&#45;&gt;attn_scores_3_10 -->
<g id="edge1565" class="edge">
<title>transpose_q_3_10&#45;&gt;attn_scores_3_10</title>
<path fill="none" stroke="black" d="M17028.12,-2773.26C17046.53,-2761.82 17067.25,-2748.95 17086.34,-2737.08"/>
<polygon fill="black" stroke="black" points="17088.34,-2739.97 17094.98,-2731.71 17084.64,-2734.02 17088.34,-2739.97"/>
</g>
<!-- transpose_k_3_10&#45;&gt;attn_scores_3_10 -->
<g id="edge1566" class="edge">
<title>transpose_k_3_10&#45;&gt;attn_scores_3_10</title>
<path fill="none" stroke="black" d="M17240.44,-2772.06C17227.95,-2761.65 17214.13,-2750.13 17201.16,-2739.32"/>
<polygon fill="black" stroke="black" points="17203.13,-2736.41 17193.21,-2732.69 17198.65,-2741.79 17203.13,-2736.41"/>
</g>
<!-- attn_output_3_10 -->
<g id="node1296" class="node">
<title>attn_output_3_10</title>
<ellipse fill="gold" stroke="black" cx="17150.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17150.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="17150.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17150.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_10&#45;&gt;attn_output_3_10 -->
<g id="edge1567" class="edge">
<title>transpose_v_3_10&#45;&gt;attn_output_3_10</title>
<path fill="none" stroke="black" d="M17562.84,-2771.18C17517.57,-2716.46 17424.65,-2611.8 17326.57,-2546.67 17302.52,-2530.69 17274.42,-2517.07 17247.83,-2506.05"/>
<polygon fill="black" stroke="black" points="17249.08,-2502.78 17238.5,-2502.26 17246.45,-2509.27 17249.08,-2502.78"/>
</g>
<!-- softmax_3_10 -->
<g id="node1297" class="node">
<title>softmax_3_10</title>
<ellipse fill="gold" stroke="black" cx="17150.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="17150.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17150.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17150.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_10&#45;&gt;softmax_3_10 -->
<g id="edge1568" class="edge">
<title>attn_scores_3_10&#45;&gt;softmax_3_10</title>
<path fill="none" stroke="black" d="M17150.57,-2658.54C17150.57,-2650.09 17150.57,-2640.99 17150.57,-2632.18"/>
<polygon fill="black" stroke="black" points="17154.07,-2632.01 17150.57,-2622.01 17147.07,-2632.01 17154.07,-2632.01"/>
</g>
<!-- transpose_back_3_10 -->
<g id="node1298" class="node">
<title>transpose_back_3_10</title>
<ellipse fill="lightgray" stroke="black" cx="17069.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17069.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17069.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17069.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_10&#45;&gt;transpose_back_3_10 -->
<g id="edge1570" class="edge">
<title>attn_output_3_10&#45;&gt;transpose_back_3_10</title>
<path fill="none" stroke="black" d="M17124.05,-2435.15C17117.06,-2425.65 17109.43,-2415.29 17102.16,-2405.42"/>
<polygon fill="black" stroke="black" points="17104.9,-2403.24 17096.16,-2397.27 17099.27,-2407.39 17104.9,-2403.24"/>
</g>
<!-- softmax_3_10&#45;&gt;attn_output_3_10 -->
<g id="edge1569" class="edge">
<title>softmax_3_10&#45;&gt;attn_output_3_10</title>
<path fill="none" stroke="black" d="M17150.57,-2546.54C17150.57,-2538.09 17150.57,-2528.99 17150.57,-2520.18"/>
<polygon fill="black" stroke="black" points="17154.07,-2520.01 17150.57,-2510.01 17147.07,-2520.01 17154.07,-2520.01"/>
</g>
<!-- reshape_concat_3_10 -->
<g id="node1299" class="node">
<title>reshape_concat_3_10</title>
<ellipse fill="lightcyan" stroke="black" cx="16845.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="16845.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="16845.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16845.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_10&#45;&gt;reshape_concat_3_10 -->
<g id="edge1571" class="edge">
<title>transpose_back_3_10&#45;&gt;reshape_concat_3_10</title>
<path fill="none" stroke="black" d="M17003.28,-2326.61C16976.96,-2313.69 16946.59,-2298.77 16919.57,-2285.5"/>
<polygon fill="black" stroke="black" points="16921.06,-2282.34 16910.54,-2281.07 16917.98,-2288.62 16921.06,-2282.34"/>
</g>
<!-- reshape_concat_3_10&#45;&gt;allgather_dim_3_2 -->
<g id="edge1572" class="edge">
<title>reshape_concat_3_10&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M16773.54,-2216.63C16730.25,-2198.27 16675.05,-2174.87 16630.29,-2155.89"/>
<polygon fill="black" stroke="black" points="16631.47,-2152.59 16620.9,-2151.91 16628.74,-2159.03 16631.47,-2152.59"/>
</g>
<!-- split_q_3_11 -->
<g id="node1301" class="node">
<title>split_q_3_11</title>
<ellipse fill="pink" stroke="black" cx="17900.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17900.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="17900.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17900.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_q_3_11 -->
<g id="edge1574" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_q_3_11</title>
<path fill="none" stroke="black" d="M17957.07,-2995.15C17949.82,-2985.65 17941.91,-2975.29 17934.37,-2965.42"/>
<polygon fill="black" stroke="black" points="17936.99,-2963.09 17928.14,-2957.27 17931.43,-2967.34 17936.99,-2963.09"/>
</g>
<!-- split_k_3_11 -->
<g id="node1302" class="node">
<title>split_k_3_11</title>
<ellipse fill="pink" stroke="black" cx="18209.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18209.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="18209.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18209.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_k_3_11 -->
<g id="edge1575" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_k_3_11</title>
<path fill="none" stroke="black" d="M18052.08,-2998.16C18077.9,-2985.54 18107.51,-2971.06 18134.03,-2958.1"/>
<polygon fill="black" stroke="black" points="18135.83,-2961.11 18143.28,-2953.58 18132.75,-2954.83 18135.83,-2961.11"/>
</g>
<!-- split_v_3_11 -->
<g id="node1303" class="node">
<title>split_v_3_11</title>
<ellipse fill="pink" stroke="black" cx="18518.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18518.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="18518.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18518.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_11&#45;&gt;split_v_3_11 -->
<g id="edge1576" class="edge">
<title>reshape_qkv_3_11&#45;&gt;split_v_3_11</title>
<path fill="none" stroke="black" d="M18107.2,-3008.79C18181.77,-2994.85 18278.85,-2976.11 18364.57,-2957.67 18377.54,-2954.88 18391.1,-2951.84 18404.56,-2948.75"/>
<polygon fill="black" stroke="black" points="18405.37,-2952.15 18414.33,-2946.49 18403.8,-2945.33 18405.37,-2952.15"/>
</g>
<!-- transpose_q_3_11 -->
<g id="node1304" class="node">
<title>transpose_q_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="17900.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17900.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="17900.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17900.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_11&#45;&gt;transpose_q_3_11 -->
<g id="edge1577" class="edge">
<title>split_q_3_11&#45;&gt;transpose_q_3_11</title>
<path fill="none" stroke="black" d="M17900.57,-2882.54C17900.57,-2874.09 17900.57,-2864.99 17900.57,-2856.18"/>
<polygon fill="black" stroke="black" points="17904.07,-2856.01 17900.57,-2846.01 17897.07,-2856.01 17904.07,-2856.01"/>
</g>
<!-- transpose_k_3_11 -->
<g id="node1305" class="node">
<title>transpose_k_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="18209.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18209.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="18209.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18209.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_11&#45;&gt;transpose_k_3_11 -->
<g id="edge1578" class="edge">
<title>split_k_3_11&#45;&gt;transpose_k_3_11</title>
<path fill="none" stroke="black" d="M18209.57,-2882.54C18209.57,-2874.09 18209.57,-2864.99 18209.57,-2856.18"/>
<polygon fill="black" stroke="black" points="18213.07,-2856.01 18209.57,-2846.01 18206.07,-2856.01 18213.07,-2856.01"/>
</g>
<!-- transpose_v_3_11 -->
<g id="node1306" class="node">
<title>transpose_v_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="18518.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18518.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="18518.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18518.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_11&#45;&gt;transpose_v_3_11 -->
<g id="edge1579" class="edge">
<title>split_v_3_11&#45;&gt;transpose_v_3_11</title>
<path fill="none" stroke="black" d="M18518.57,-2882.54C18518.57,-2874.09 18518.57,-2864.99 18518.57,-2856.18"/>
<polygon fill="black" stroke="black" points="18522.07,-2856.01 18518.57,-2846.01 18515.07,-2856.01 18522.07,-2856.01"/>
</g>
<!-- attn_scores_3_11 -->
<g id="node1307" class="node">
<title>attn_scores_3_11</title>
<ellipse fill="gold" stroke="black" cx="18042.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18042.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="18042.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18042.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_11&#45;&gt;attn_scores_3_11 -->
<g id="edge1580" class="edge">
<title>transpose_q_3_11&#45;&gt;attn_scores_3_11</title>
<path fill="none" stroke="black" d="M17945.5,-2772.36C17959.22,-2761.73 17974.45,-2749.94 17988.7,-2738.9"/>
<polygon fill="black" stroke="black" points="17991.2,-2741.39 17996.96,-2732.5 17986.91,-2735.86 17991.2,-2741.39"/>
</g>
<!-- transpose_k_3_11&#45;&gt;attn_scores_3_11 -->
<g id="edge1581" class="edge">
<title>transpose_k_3_11&#45;&gt;attn_scores_3_11</title>
<path fill="none" stroke="black" d="M18157.65,-2772.96C18140.62,-2761.75 18121.53,-2749.17 18103.87,-2737.54"/>
<polygon fill="black" stroke="black" points="18105.61,-2734.49 18095.33,-2731.92 18101.75,-2740.34 18105.61,-2734.49"/>
</g>
<!-- attn_output_3_11 -->
<g id="node1308" class="node">
<title>attn_output_3_11</title>
<ellipse fill="gold" stroke="black" cx="18042.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18042.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="18042.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18042.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_11&#45;&gt;attn_output_3_11 -->
<g id="edge1582" class="edge">
<title>transpose_v_3_11&#45;&gt;attn_output_3_11</title>
<path fill="none" stroke="black" d="M18485.04,-2771.49C18432.46,-2717.17 18325.54,-2613.03 18218.57,-2546.67 18193.66,-2531.21 18164.92,-2517.65 18137.98,-2506.52"/>
<polygon fill="black" stroke="black" points="18139.12,-2503.21 18128.54,-2502.69 18136.49,-2509.69 18139.12,-2503.21"/>
</g>
<!-- softmax_3_11 -->
<g id="node1309" class="node">
<title>softmax_3_11</title>
<ellipse fill="gold" stroke="black" cx="18042.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="18042.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="18042.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18042.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_11&#45;&gt;softmax_3_11 -->
<g id="edge1583" class="edge">
<title>attn_scores_3_11&#45;&gt;softmax_3_11</title>
<path fill="none" stroke="black" d="M18042.57,-2658.54C18042.57,-2650.09 18042.57,-2640.99 18042.57,-2632.18"/>
<polygon fill="black" stroke="black" points="18046.07,-2632.01 18042.57,-2622.01 18039.07,-2632.01 18046.07,-2632.01"/>
</g>
<!-- transpose_back_3_11 -->
<g id="node1310" class="node">
<title>transpose_back_3_11</title>
<ellipse fill="lightgray" stroke="black" cx="17744.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="17744.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="17744.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17744.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_11&#45;&gt;transpose_back_3_11 -->
<g id="edge1585" class="edge">
<title>attn_output_3_11&#45;&gt;transpose_back_3_11</title>
<path fill="none" stroke="black" d="M17960.75,-2440.96C17921.99,-2426.65 17875.55,-2409.51 17835.67,-2394.79"/>
<polygon fill="black" stroke="black" points="17836.81,-2391.48 17826.21,-2391.3 17834.38,-2398.05 17836.81,-2391.48"/>
</g>
<!-- softmax_3_11&#45;&gt;attn_output_3_11 -->
<g id="edge1584" class="edge">
<title>softmax_3_11&#45;&gt;attn_output_3_11</title>
<path fill="none" stroke="black" d="M18042.57,-2546.54C18042.57,-2538.09 18042.57,-2528.99 18042.57,-2520.18"/>
<polygon fill="black" stroke="black" points="18046.07,-2520.01 18042.57,-2510.01 18039.07,-2520.01 18046.07,-2520.01"/>
</g>
<!-- reshape_concat_3_11 -->
<g id="node1311" class="node">
<title>reshape_concat_3_11</title>
<ellipse fill="lightcyan" stroke="black" cx="17155.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="17155.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="17155.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="17155.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_11&#45;&gt;reshape_concat_3_11 -->
<g id="edge1586" class="edge">
<title>transpose_back_3_11&#45;&gt;reshape_concat_3_11</title>
<path fill="none" stroke="black" d="M17628.56,-2337.5C17526.29,-2318.4 17377.91,-2290.69 17274.71,-2271.42"/>
<polygon fill="black" stroke="black" points="17275.34,-2267.97 17264.87,-2269.58 17274.06,-2274.85 17275.34,-2267.97"/>
</g>
<!-- reshape_concat_3_11&#45;&gt;allgather_dim_3_2 -->
<g id="edge1587" class="edge">
<title>reshape_concat_3_11&#45;&gt;allgather_dim_3_2</title>
<path fill="none" stroke="black" d="M17052.11,-2224.46C17030.78,-2219.84 17008.46,-2215.06 16987.57,-2210.67 16877.35,-2187.49 16751.3,-2161.99 16662.81,-2144.24"/>
<polygon fill="black" stroke="black" points="16663.25,-2140.76 16652.75,-2142.22 16661.87,-2147.62 16663.25,-2140.76"/>
</g>
<!-- output_proj_3_2 -->
<g id="node1365" class="node">
<title>output_proj_3_2</title>
<ellipse fill="orange" stroke="black" cx="15477.57" cy="-1907.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="15477.57" y="-1926.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15477.57" y="-1911.38" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="15477.57" y="-1896.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15477.57" y="-1881.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_2&#45;&gt;output_proj_3_2 -->
<g id="edge1652" class="edge">
<title>head_group_3_2&#45;&gt;output_proj_3_2</title>
<path fill="none" stroke="black" d="M16286.67,-1999.55C16125.43,-1981.42 15805.33,-1945.43 15619.74,-1924.57"/>
<polygon fill="black" stroke="black" points="15619.96,-1921.07 15609.63,-1923.43 15619.18,-1928.03 15619.96,-1921.07"/>
</g>
<!-- split_q_3_12 -->
<g id="node1314" class="node">
<title>split_q_3_12</title>
<ellipse fill="pink" stroke="black" cx="18827.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18827.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="18827.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18827.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_q_3_12 -->
<g id="edge1590" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_q_3_12</title>
<path fill="none" stroke="black" d="M18884.07,-2995.15C18876.82,-2985.65 18868.91,-2975.29 18861.37,-2965.42"/>
<polygon fill="black" stroke="black" points="18863.99,-2963.09 18855.14,-2957.27 18858.43,-2967.34 18863.99,-2963.09"/>
</g>
<!-- split_k_3_12 -->
<g id="node1315" class="node">
<title>split_k_3_12</title>
<ellipse fill="pink" stroke="black" cx="19136.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19136.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="19136.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19136.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_k_3_12 -->
<g id="edge1591" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_k_3_12</title>
<path fill="none" stroke="black" d="M18979.08,-2998.16C19004.9,-2985.54 19034.51,-2971.06 19061.03,-2958.1"/>
<polygon fill="black" stroke="black" points="19062.83,-2961.11 19070.28,-2953.58 19059.75,-2954.83 19062.83,-2961.11"/>
</g>
<!-- split_v_3_12 -->
<g id="node1316" class="node">
<title>split_v_3_12</title>
<ellipse fill="pink" stroke="black" cx="19445.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19445.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="19445.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19445.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_12&#45;&gt;split_v_3_12 -->
<g id="edge1592" class="edge">
<title>reshape_qkv_3_12&#45;&gt;split_v_3_12</title>
<path fill="none" stroke="black" d="M19034.2,-3008.79C19108.77,-2994.85 19205.85,-2976.11 19291.57,-2957.67 19304.54,-2954.88 19318.1,-2951.84 19331.56,-2948.75"/>
<polygon fill="black" stroke="black" points="19332.37,-2952.15 19341.33,-2946.49 19330.8,-2945.33 19332.37,-2952.15"/>
</g>
<!-- transpose_q_3_12 -->
<g id="node1317" class="node">
<title>transpose_q_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="18827.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="18827.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="18827.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18827.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_12&#45;&gt;transpose_q_3_12 -->
<g id="edge1593" class="edge">
<title>split_q_3_12&#45;&gt;transpose_q_3_12</title>
<path fill="none" stroke="black" d="M18827.57,-2882.54C18827.57,-2874.09 18827.57,-2864.99 18827.57,-2856.18"/>
<polygon fill="black" stroke="black" points="18831.07,-2856.01 18827.57,-2846.01 18824.07,-2856.01 18831.07,-2856.01"/>
</g>
<!-- transpose_k_3_12 -->
<g id="node1318" class="node">
<title>transpose_k_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="19136.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19136.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="19136.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19136.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_12&#45;&gt;transpose_k_3_12 -->
<g id="edge1594" class="edge">
<title>split_k_3_12&#45;&gt;transpose_k_3_12</title>
<path fill="none" stroke="black" d="M19136.57,-2882.54C19136.57,-2874.09 19136.57,-2864.99 19136.57,-2856.18"/>
<polygon fill="black" stroke="black" points="19140.07,-2856.01 19136.57,-2846.01 19133.07,-2856.01 19140.07,-2856.01"/>
</g>
<!-- transpose_v_3_12 -->
<g id="node1319" class="node">
<title>transpose_v_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="19445.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19445.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="19445.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19445.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_12&#45;&gt;transpose_v_3_12 -->
<g id="edge1595" class="edge">
<title>split_v_3_12&#45;&gt;transpose_v_3_12</title>
<path fill="none" stroke="black" d="M19445.57,-2882.54C19445.57,-2874.09 19445.57,-2864.99 19445.57,-2856.18"/>
<polygon fill="black" stroke="black" points="19449.07,-2856.01 19445.57,-2846.01 19442.07,-2856.01 19449.07,-2856.01"/>
</g>
<!-- attn_scores_3_12 -->
<g id="node1320" class="node">
<title>attn_scores_3_12</title>
<ellipse fill="gold" stroke="black" cx="19136.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19136.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="19136.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19136.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_12&#45;&gt;attn_scores_3_12 -->
<g id="edge1596" class="edge">
<title>transpose_q_3_12&#45;&gt;attn_scores_3_12</title>
<path fill="none" stroke="black" d="M18911.19,-2777.4C18950.91,-2763.26 18998.6,-2746.28 19039.86,-2731.59"/>
<polygon fill="black" stroke="black" points="19041.13,-2734.86 19049.38,-2728.21 19038.79,-2728.26 19041.13,-2734.86"/>
</g>
<!-- transpose_k_3_12&#45;&gt;attn_scores_3_12 -->
<g id="edge1597" class="edge">
<title>transpose_k_3_12&#45;&gt;attn_scores_3_12</title>
<path fill="none" stroke="black" d="M19136.57,-2770.54C19136.57,-2762.09 19136.57,-2752.99 19136.57,-2744.18"/>
<polygon fill="black" stroke="black" points="19140.07,-2744.01 19136.57,-2734.01 19133.07,-2744.01 19140.07,-2744.01"/>
</g>
<!-- attn_output_3_12 -->
<g id="node1321" class="node">
<title>attn_output_3_12</title>
<ellipse fill="gold" stroke="black" cx="19445.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19445.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="19445.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19445.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_12&#45;&gt;attn_output_3_12 -->
<g id="edge1598" class="edge">
<title>transpose_v_3_12&#45;&gt;attn_output_3_12</title>
<path fill="none" stroke="black" d="M19445.57,-2770.47C19445.57,-2709.42 19445.57,-2587.11 19445.57,-2519.96"/>
<polygon fill="black" stroke="black" points="19449.07,-2519.67 19445.57,-2509.67 19442.07,-2519.67 19449.07,-2519.67"/>
</g>
<!-- softmax_3_12 -->
<g id="node1322" class="node">
<title>softmax_3_12</title>
<ellipse fill="gold" stroke="black" cx="19193.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="19193.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19193.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19193.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_12&#45;&gt;softmax_3_12 -->
<g id="edge1599" class="edge">
<title>attn_scores_3_12&#45;&gt;softmax_3_12</title>
<path fill="none" stroke="black" d="M19155.4,-2658.84C19160.11,-2649.74 19165.23,-2639.86 19170.15,-2630.38"/>
<polygon fill="black" stroke="black" points="19173.28,-2631.94 19174.77,-2621.45 19167.06,-2628.72 19173.28,-2631.94"/>
</g>
<!-- transpose_back_3_12 -->
<g id="node1323" class="node">
<title>transpose_back_3_12</title>
<ellipse fill="lightgray" stroke="black" cx="19816.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19816.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="19816.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19816.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_12&#45;&gt;transpose_back_3_12 -->
<g id="edge1601" class="edge">
<title>attn_output_3_12&#45;&gt;transpose_back_3_12</title>
<path fill="none" stroke="black" d="M19539.19,-2443.41C19592.25,-2427.68 19658.72,-2407.97 19713.29,-2391.79"/>
<polygon fill="black" stroke="black" points="19714.39,-2395.11 19722.98,-2388.91 19712.4,-2388.4 19714.39,-2395.11"/>
</g>
<!-- softmax_3_12&#45;&gt;attn_output_3_12 -->
<g id="edge1600" class="edge">
<title>softmax_3_12&#45;&gt;attn_output_3_12</title>
<path fill="none" stroke="black" d="M19268.16,-2550.61C19298.15,-2537.52 19332.83,-2522.38 19363.52,-2508.98"/>
<polygon fill="black" stroke="black" points="19365.15,-2512.09 19372.91,-2504.88 19362.35,-2505.68 19365.15,-2512.09"/>
</g>
<!-- reshape_concat_3_12 -->
<g id="node1324" class="node">
<title>reshape_concat_3_12</title>
<ellipse fill="lightcyan" stroke="black" cx="19983.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="19983.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="19983.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19983.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_12&#45;&gt;reshape_concat_3_12 -->
<g id="edge1602" class="edge">
<title>transpose_back_3_12&#45;&gt;reshape_concat_3_12</title>
<path fill="none" stroke="black" d="M19868.5,-2324.96C19885.94,-2313.47 19905.54,-2300.56 19923.56,-2288.7"/>
<polygon fill="black" stroke="black" points="19925.83,-2291.39 19932.25,-2282.97 19921.98,-2285.55 19925.83,-2291.39"/>
</g>
<!-- allgather_dim_3_3 -->
<g id="node1325" class="node">
<title>allgather_dim_3_3</title>
<polygon fill="red" stroke="black" points="20279.57,-2173.67 20106.57,-2120.67 20279.57,-2067.67 20452.57,-2120.67 20279.57,-2173.67"/>
<text text-anchor="middle" x="20279.57" y="-2131.97" font-family="Times,serif" font-size="14.00">AllGather Dimensions</text>
<text text-anchor="middle" x="20279.57" y="-2116.97" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="20279.57" y="-2101.97" font-family="Times,serif" font-size="14.00">All GPUs in group</text>
</g>
<!-- reshape_concat_3_12&#45;&gt;allgather_dim_3_3 -->
<g id="edge1603" class="edge">
<title>reshape_concat_3_12&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M20055.6,-2216.63C20098.9,-2198.27 20154.1,-2174.87 20198.86,-2155.89"/>
<polygon fill="black" stroke="black" points="20200.4,-2159.03 20208.25,-2151.91 20197.67,-2152.59 20200.4,-2159.03"/>
</g>
<!-- head_group_3_3 -->
<g id="node1362" class="node">
<title>head_group_3_3</title>
<polygon fill="lightyellow" stroke="black" points="16832.07,-2030.67 16635.07,-2030.67 16635.07,-1992.67 16832.07,-1992.67 16832.07,-2030.67"/>
<text text-anchor="middle" x="16733.57" y="-2015.47" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16733.57" y="-2000.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- allgather_dim_3_3&#45;&gt;head_group_3_3 -->
<g id="edge1649" class="edge">
<title>allgather_dim_3_3&#45;&gt;head_group_3_3</title>
<path fill="none" stroke="black" d="M20124.93,-2115C19524.37,-2096.88 17354.86,-2031.41 16842.54,-2015.95"/>
<polygon fill="black" stroke="black" points="16842.29,-2012.45 16832.19,-2015.64 16842.08,-2019.44 16842.29,-2012.45"/>
</g>
<!-- split_q_3_13 -->
<g id="node1327" class="node">
<title>split_q_3_13</title>
<ellipse fill="pink" stroke="black" cx="19754.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19754.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="19754.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19754.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_q_3_13 -->
<g id="edge1605" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_q_3_13</title>
<path fill="none" stroke="black" d="M19920.4,-2998.46C19892.94,-2985.66 19861.31,-2970.92 19833.09,-2957.76"/>
<polygon fill="black" stroke="black" points="19834.2,-2954.42 19823.66,-2953.37 19831.24,-2960.76 19834.2,-2954.42"/>
</g>
<!-- split_k_3_13 -->
<g id="node1328" class="node">
<title>split_k_3_13</title>
<ellipse fill="pink" stroke="black" cx="20063.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20063.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20063.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20063.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_k_3_13 -->
<g id="edge1606" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_k_3_13</title>
<path fill="none" stroke="black" d="M20014.68,-2994.84C20020.85,-2985.55 20027.55,-2975.45 20033.96,-2965.79"/>
<polygon fill="black" stroke="black" points="20036.88,-2967.72 20039.49,-2957.45 20031.05,-2963.85 20036.88,-2967.72"/>
</g>
<!-- split_v_3_13 -->
<g id="node1329" class="node">
<title>split_v_3_13</title>
<ellipse fill="pink" stroke="black" cx="20372.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20372.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="20372.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20372.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_13&#45;&gt;split_v_3_13 -->
<g id="edge1607" class="edge">
<title>reshape_qkv_3_13&#45;&gt;split_v_3_13</title>
<path fill="none" stroke="black" d="M20088.95,-3002.84C20143.59,-2987.1 20211.57,-2967.53 20267.28,-2951.49"/>
<polygon fill="black" stroke="black" points="20268.53,-2954.77 20277.17,-2948.64 20266.59,-2948.04 20268.53,-2954.77"/>
</g>
<!-- transpose_q_3_13 -->
<g id="node1330" class="node">
<title>transpose_q_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="19754.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="19754.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="19754.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="19754.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_13&#45;&gt;transpose_q_3_13 -->
<g id="edge1608" class="edge">
<title>split_q_3_13&#45;&gt;transpose_q_3_13</title>
<path fill="none" stroke="black" d="M19754.57,-2882.54C19754.57,-2874.09 19754.57,-2864.99 19754.57,-2856.18"/>
<polygon fill="black" stroke="black" points="19758.07,-2856.01 19754.57,-2846.01 19751.07,-2856.01 19758.07,-2856.01"/>
</g>
<!-- transpose_k_3_13 -->
<g id="node1331" class="node">
<title>transpose_k_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="20063.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20063.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20063.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20063.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_13&#45;&gt;transpose_k_3_13 -->
<g id="edge1609" class="edge">
<title>split_k_3_13&#45;&gt;transpose_k_3_13</title>
<path fill="none" stroke="black" d="M20063.57,-2882.54C20063.57,-2874.09 20063.57,-2864.99 20063.57,-2856.18"/>
<polygon fill="black" stroke="black" points="20067.07,-2856.01 20063.57,-2846.01 20060.07,-2856.01 20067.07,-2856.01"/>
</g>
<!-- transpose_v_3_13 -->
<g id="node1332" class="node">
<title>transpose_v_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="20372.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20372.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="20372.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20372.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_13&#45;&gt;transpose_v_3_13 -->
<g id="edge1610" class="edge">
<title>split_v_3_13&#45;&gt;transpose_v_3_13</title>
<path fill="none" stroke="black" d="M20372.57,-2882.54C20372.57,-2874.09 20372.57,-2864.99 20372.57,-2856.18"/>
<polygon fill="black" stroke="black" points="20376.07,-2856.01 20372.57,-2846.01 20369.07,-2856.01 20376.07,-2856.01"/>
</g>
<!-- attn_scores_3_13 -->
<g id="node1333" class="node">
<title>attn_scores_3_13</title>
<ellipse fill="gold" stroke="black" cx="20063.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20063.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20063.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20063.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_13&#45;&gt;attn_scores_3_13 -->
<g id="edge1611" class="edge">
<title>transpose_q_3_13&#45;&gt;attn_scores_3_13</title>
<path fill="none" stroke="black" d="M19838.19,-2777.4C19877.91,-2763.26 19925.6,-2746.28 19966.86,-2731.59"/>
<polygon fill="black" stroke="black" points="19968.13,-2734.86 19976.38,-2728.21 19965.79,-2728.26 19968.13,-2734.86"/>
</g>
<!-- transpose_k_3_13&#45;&gt;attn_scores_3_13 -->
<g id="edge1612" class="edge">
<title>transpose_k_3_13&#45;&gt;attn_scores_3_13</title>
<path fill="none" stroke="black" d="M20063.57,-2770.54C20063.57,-2762.09 20063.57,-2752.99 20063.57,-2744.18"/>
<polygon fill="black" stroke="black" points="20067.07,-2744.01 20063.57,-2734.01 20060.07,-2744.01 20067.07,-2744.01"/>
</g>
<!-- attn_output_3_13 -->
<g id="node1334" class="node">
<title>attn_output_3_13</title>
<ellipse fill="gold" stroke="black" cx="20279.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20279.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20279.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20279.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_13&#45;&gt;attn_output_3_13 -->
<g id="edge1613" class="edge">
<title>transpose_v_3_13&#45;&gt;attn_output_3_13</title>
<path fill="none" stroke="black" d="M20362.35,-2770.47C20345.32,-2709.3 20311.16,-2586.6 20292.49,-2519.54"/>
<polygon fill="black" stroke="black" points="20295.79,-2518.37 20289.74,-2509.67 20289.05,-2520.24 20295.79,-2518.37"/>
</g>
<!-- softmax_3_13 -->
<g id="node1335" class="node">
<title>softmax_3_13</title>
<ellipse fill="gold" stroke="black" cx="20105.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20105.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20105.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20105.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_13&#45;&gt;softmax_3_13 -->
<g id="edge1614" class="edge">
<title>attn_scores_3_13&#45;&gt;softmax_3_13</title>
<path fill="none" stroke="black" d="M20077.56,-2658.54C20080.92,-2649.72 20084.56,-2640.2 20088.06,-2631.03"/>
<polygon fill="black" stroke="black" points="20091.35,-2632.23 20091.65,-2621.63 20084.81,-2629.73 20091.35,-2632.23"/>
</g>
<!-- transpose_back_3_13 -->
<g id="node1336" class="node">
<title>transpose_back_3_13</title>
<ellipse fill="lightgray" stroke="black" cx="20279.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20279.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20279.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20279.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_13&#45;&gt;transpose_back_3_13 -->
<g id="edge1616" class="edge">
<title>attn_output_3_13&#45;&gt;transpose_back_3_13</title>
<path fill="none" stroke="black" d="M20279.57,-2434.54C20279.57,-2426.09 20279.57,-2416.99 20279.57,-2408.18"/>
<polygon fill="black" stroke="black" points="20283.07,-2408.01 20279.57,-2398.01 20276.07,-2408.01 20283.07,-2408.01"/>
</g>
<!-- softmax_3_13&#45;&gt;attn_output_3_13 -->
<g id="edge1615" class="edge">
<title>softmax_3_13&#45;&gt;attn_output_3_13</title>
<path fill="none" stroke="black" d="M20160.15,-2548.66C20178.3,-2537.19 20198.65,-2524.33 20217.33,-2512.51"/>
<polygon fill="black" stroke="black" points="20219.2,-2515.47 20225.79,-2507.17 20215.46,-2509.55 20219.2,-2515.47"/>
</g>
<!-- reshape_concat_3_13 -->
<g id="node1337" class="node">
<title>reshape_concat_3_13</title>
<ellipse fill="lightcyan" stroke="black" cx="20279.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20279.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20279.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20279.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_13&#45;&gt;reshape_concat_3_13 -->
<g id="edge1617" class="edge">
<title>transpose_back_3_13&#45;&gt;reshape_concat_3_13</title>
<path fill="none" stroke="black" d="M20279.57,-2322.54C20279.57,-2314.09 20279.57,-2304.99 20279.57,-2296.18"/>
<polygon fill="black" stroke="black" points="20283.07,-2296.01 20279.57,-2286.01 20276.07,-2296.01 20283.07,-2296.01"/>
</g>
<!-- reshape_concat_3_13&#45;&gt;allgather_dim_3_3 -->
<g id="edge1618" class="edge">
<title>reshape_concat_3_13&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M20279.57,-2210.53C20279.57,-2202.22 20279.57,-2193.18 20279.57,-2184.13"/>
<polygon fill="black" stroke="black" points="20283.07,-2183.97 20279.57,-2173.97 20276.07,-2183.97 20283.07,-2183.97"/>
</g>
<!-- split_q_3_14 -->
<g id="node1339" class="node">
<title>split_q_3_14</title>
<ellipse fill="pink" stroke="black" cx="20681.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20681.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="20681.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20681.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_q_3_14 -->
<g id="edge1620" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_q_3_14</title>
<path fill="none" stroke="black" d="M20787.53,-2996.36C20771.9,-2985.27 20754.47,-2972.9 20738.33,-2961.45"/>
<polygon fill="black" stroke="black" points="20740.21,-2958.49 20730.03,-2955.56 20736.16,-2964.2 20740.21,-2958.49"/>
</g>
<!-- split_k_3_14 -->
<g id="node1340" class="node">
<title>split_k_3_14</title>
<ellipse fill="pink" stroke="black" cx="20990.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20990.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="20990.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20990.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_k_3_14 -->
<g id="edge1621" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_k_3_14</title>
<path fill="none" stroke="black" d="M20885.3,-2996.36C20900.83,-2985.27 20918.15,-2972.9 20934.18,-2961.45"/>
<polygon fill="black" stroke="black" points="20936.32,-2964.22 20942.43,-2955.56 20932.26,-2958.52 20936.32,-2964.22"/>
</g>
<!-- split_v_3_14 -->
<g id="node1341" class="node">
<title>split_v_3_14</title>
<ellipse fill="pink" stroke="black" cx="21299.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21299.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="21299.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21299.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_14&#45;&gt;split_v_3_14 -->
<g id="edge1622" class="edge">
<title>reshape_qkv_3_14&#45;&gt;split_v_3_14</title>
<path fill="none" stroke="black" d="M20945.71,-3005.24C21017.46,-2988.19 21111.22,-2965.92 21184.2,-2948.58"/>
<polygon fill="black" stroke="black" points="21185.43,-2951.88 21194.35,-2946.16 21183.82,-2945.07 21185.43,-2951.88"/>
</g>
<!-- transpose_q_3_14 -->
<g id="node1342" class="node">
<title>transpose_q_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="20681.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20681.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="20681.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20681.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_14&#45;&gt;transpose_q_3_14 -->
<g id="edge1623" class="edge">
<title>split_q_3_14&#45;&gt;transpose_q_3_14</title>
<path fill="none" stroke="black" d="M20681.57,-2882.54C20681.57,-2874.09 20681.57,-2864.99 20681.57,-2856.18"/>
<polygon fill="black" stroke="black" points="20685.07,-2856.01 20681.57,-2846.01 20678.07,-2856.01 20685.07,-2856.01"/>
</g>
<!-- transpose_k_3_14 -->
<g id="node1343" class="node">
<title>transpose_k_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="20990.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20990.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="20990.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20990.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_14&#45;&gt;transpose_k_3_14 -->
<g id="edge1624" class="edge">
<title>split_k_3_14&#45;&gt;transpose_k_3_14</title>
<path fill="none" stroke="black" d="M20990.57,-2882.54C20990.57,-2874.09 20990.57,-2864.99 20990.57,-2856.18"/>
<polygon fill="black" stroke="black" points="20994.07,-2856.01 20990.57,-2846.01 20987.07,-2856.01 20994.07,-2856.01"/>
</g>
<!-- transpose_v_3_14 -->
<g id="node1344" class="node">
<title>transpose_v_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="21299.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21299.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="21299.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21299.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_14&#45;&gt;transpose_v_3_14 -->
<g id="edge1625" class="edge">
<title>split_v_3_14&#45;&gt;transpose_v_3_14</title>
<path fill="none" stroke="black" d="M21299.57,-2882.54C21299.57,-2874.09 21299.57,-2864.99 21299.57,-2856.18"/>
<polygon fill="black" stroke="black" points="21303.07,-2856.01 21299.57,-2846.01 21296.07,-2856.01 21303.07,-2856.01"/>
</g>
<!-- attn_scores_3_14 -->
<g id="node1345" class="node">
<title>attn_scores_3_14</title>
<ellipse fill="gold" stroke="black" cx="20955.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20955.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="20955.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20955.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_14&#45;&gt;attn_scores_3_14 -->
<g id="edge1626" class="edge">
<title>transpose_q_3_14&#45;&gt;attn_scores_3_14</title>
<path fill="none" stroke="black" d="M20758.63,-2776.23C20792.05,-2762.81 20831.4,-2747.02 20866.11,-2733.08"/>
<polygon fill="black" stroke="black" points="20867.79,-2736.18 20875.76,-2729.21 20865.18,-2729.68 20867.79,-2736.18"/>
</g>
<!-- transpose_k_3_14&#45;&gt;attn_scores_3_14 -->
<g id="edge1627" class="edge">
<title>transpose_k_3_14&#45;&gt;attn_scores_3_14</title>
<path fill="none" stroke="black" d="M20978.92,-2770.54C20976.14,-2761.82 20973.15,-2752.4 20970.26,-2743.31"/>
<polygon fill="black" stroke="black" points="20973.54,-2742.1 20967.18,-2733.63 20966.87,-2744.23 20973.54,-2742.1"/>
</g>
<!-- attn_output_3_14 -->
<g id="node1346" class="node">
<title>attn_output_3_14</title>
<ellipse fill="gold" stroke="black" cx="20955.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20955.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="20955.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20955.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_14&#45;&gt;attn_output_3_14 -->
<g id="edge1628" class="edge">
<title>transpose_v_3_14&#45;&gt;attn_output_3_14</title>
<path fill="none" stroke="black" d="M21284.61,-2770.66C21260.2,-2715.25 21206.89,-2609.7 21131.57,-2546.67 21110.65,-2529.16 21084.97,-2515.31 21059.76,-2504.57"/>
<polygon fill="black" stroke="black" points="21061.08,-2501.33 21050.5,-2500.76 21058.41,-2507.8 21061.08,-2501.33"/>
</g>
<!-- softmax_3_14 -->
<g id="node1347" class="node">
<title>softmax_3_14</title>
<ellipse fill="gold" stroke="black" cx="20955.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="20955.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="20955.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20955.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_14&#45;&gt;softmax_3_14 -->
<g id="edge1629" class="edge">
<title>attn_scores_3_14&#45;&gt;softmax_3_14</title>
<path fill="none" stroke="black" d="M20955.57,-2658.54C20955.57,-2650.09 20955.57,-2640.99 20955.57,-2632.18"/>
<polygon fill="black" stroke="black" points="20959.07,-2632.01 20955.57,-2622.01 20952.07,-2632.01 20959.07,-2632.01"/>
</g>
<!-- transpose_back_3_14 -->
<g id="node1348" class="node">
<title>transpose_back_3_14</title>
<ellipse fill="lightgray" stroke="black" cx="20897.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="20897.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="20897.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20897.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_14&#45;&gt;transpose_back_3_14 -->
<g id="edge1631" class="edge">
<title>attn_output_3_14&#45;&gt;transpose_back_3_14</title>
<path fill="none" stroke="black" d="M20936.42,-2434.84C20931.62,-2425.74 20926.41,-2415.86 20921.41,-2406.38"/>
<polygon fill="black" stroke="black" points="20924.47,-2404.66 20916.71,-2397.45 20918.27,-2407.93 20924.47,-2404.66"/>
</g>
<!-- softmax_3_14&#45;&gt;attn_output_3_14 -->
<g id="edge1630" class="edge">
<title>softmax_3_14&#45;&gt;attn_output_3_14</title>
<path fill="none" stroke="black" d="M20955.57,-2546.54C20955.57,-2538.09 20955.57,-2528.99 20955.57,-2520.18"/>
<polygon fill="black" stroke="black" points="20959.07,-2520.01 20955.57,-2510.01 20952.07,-2520.01 20959.07,-2520.01"/>
</g>
<!-- reshape_concat_3_14 -->
<g id="node1349" class="node">
<title>reshape_concat_3_14</title>
<ellipse fill="lightcyan" stroke="black" cx="20575.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20575.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20575.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20575.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_14&#45;&gt;reshape_concat_3_14 -->
<g id="edge1632" class="edge">
<title>transpose_back_3_14&#45;&gt;reshape_concat_3_14</title>
<path fill="none" stroke="black" d="M20811.71,-2329.83C20767.44,-2314.71 20713.41,-2296.25 20668.2,-2280.81"/>
<polygon fill="black" stroke="black" points="20669.29,-2277.48 20658.7,-2277.56 20667.03,-2284.11 20669.29,-2277.48"/>
</g>
<!-- reshape_concat_3_14&#45;&gt;allgather_dim_3_3 -->
<g id="edge1633" class="edge">
<title>reshape_concat_3_14&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M20503.54,-2216.63C20460.25,-2198.27 20405.05,-2174.87 20360.29,-2155.89"/>
<polygon fill="black" stroke="black" points="20361.47,-2152.59 20350.9,-2151.91 20358.74,-2159.03 20361.47,-2152.59"/>
</g>
<!-- split_q_3_15 -->
<g id="node1351" class="node">
<title>split_q_3_15</title>
<ellipse fill="pink" stroke="black" cx="21608.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21608.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Query</text>
<text text-anchor="middle" x="21608.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21608.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_q_3_15 -->
<g id="edge1635" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_q_3_15</title>
<path fill="none" stroke="black" d="M21713.85,-2996.36C21698.31,-2985.27 21681,-2972.9 21664.97,-2961.45"/>
<polygon fill="black" stroke="black" points="21666.89,-2958.52 21656.72,-2955.56 21662.82,-2964.22 21666.89,-2958.52"/>
</g>
<!-- split_k_3_15 -->
<g id="node1352" class="node">
<title>split_k_3_15</title>
<ellipse fill="pink" stroke="black" cx="21917.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21917.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Key</text>
<text text-anchor="middle" x="21917.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21917.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_k_3_15 -->
<g id="edge1636" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_k_3_15</title>
<path fill="none" stroke="black" d="M21811.62,-2996.36C21827.25,-2985.27 21844.68,-2972.9 21860.81,-2961.45"/>
<polygon fill="black" stroke="black" points="21862.99,-2964.2 21869.11,-2955.56 21858.93,-2958.49 21862.99,-2964.2"/>
</g>
<!-- split_v_3_15 -->
<g id="node1353" class="node">
<title>split_v_3_15</title>
<ellipse fill="pink" stroke="black" cx="22226.57" cy="-2920.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22226.57" y="-2931.47" font-family="Times,serif" font-size="14.00">Value</text>
<text text-anchor="middle" x="22226.57" y="-2916.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22226.57" y="-2901.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- reshape_qkv_3_15&#45;&gt;split_v_3_15 -->
<g id="edge1637" class="edge">
<title>reshape_qkv_3_15&#45;&gt;split_v_3_15</title>
<path fill="none" stroke="black" d="M21871.95,-3005.24C21943.85,-2988.19 22037.81,-2965.92 22110.95,-2948.58"/>
<polygon fill="black" stroke="black" points="22112.2,-2951.88 22121.13,-2946.16 22110.59,-2945.07 22112.2,-2951.88"/>
</g>
<!-- transpose_q_3_15 -->
<g id="node1354" class="node">
<title>transpose_q_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="21608.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21608.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose Q</text>
<text text-anchor="middle" x="21608.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21608.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_q_3_15&#45;&gt;transpose_q_3_15 -->
<g id="edge1638" class="edge">
<title>split_q_3_15&#45;&gt;transpose_q_3_15</title>
<path fill="none" stroke="black" d="M21608.57,-2882.54C21608.57,-2874.09 21608.57,-2864.99 21608.57,-2856.18"/>
<polygon fill="black" stroke="black" points="21612.07,-2856.01 21608.57,-2846.01 21605.07,-2856.01 21612.07,-2856.01"/>
</g>
<!-- transpose_k_3_15 -->
<g id="node1355" class="node">
<title>transpose_k_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="21917.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21917.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose K</text>
<text text-anchor="middle" x="21917.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21917.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_k_3_15&#45;&gt;transpose_k_3_15 -->
<g id="edge1639" class="edge">
<title>split_k_3_15&#45;&gt;transpose_k_3_15</title>
<path fill="none" stroke="black" d="M21917.57,-2882.54C21917.57,-2874.09 21917.57,-2864.99 21917.57,-2856.18"/>
<polygon fill="black" stroke="black" points="21921.07,-2856.01 21917.57,-2846.01 21914.07,-2856.01 21921.07,-2856.01"/>
</g>
<!-- transpose_v_3_15 -->
<g id="node1356" class="node">
<title>transpose_v_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="22226.57" cy="-2808.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="22226.57" y="-2819.47" font-family="Times,serif" font-size="14.00">Transpose V</text>
<text text-anchor="middle" x="22226.57" y="-2804.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22226.57" y="-2789.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- split_v_3_15&#45;&gt;transpose_v_3_15 -->
<g id="edge1640" class="edge">
<title>split_v_3_15&#45;&gt;transpose_v_3_15</title>
<path fill="none" stroke="black" d="M22226.57,-2882.54C22226.57,-2874.09 22226.57,-2864.99 22226.57,-2856.18"/>
<polygon fill="black" stroke="black" points="22230.07,-2856.01 22226.57,-2846.01 22223.07,-2856.01 22230.07,-2856.01"/>
</g>
<!-- attn_scores_3_15 -->
<g id="node1357" class="node">
<title>attn_scores_3_15</title>
<ellipse fill="gold" stroke="black" cx="21740.57" cy="-2696.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21740.57" y="-2707.47" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="21740.57" y="-2692.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21740.57" y="-2677.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- transpose_q_3_15&#45;&gt;attn_scores_3_15 -->
<g id="edge1641" class="edge">
<title>transpose_q_3_15&#45;&gt;attn_scores_3_15</title>
<path fill="none" stroke="black" d="M21650.7,-2772.06C21663.2,-2761.65 21677.01,-2750.13 21689.99,-2739.32"/>
<polygon fill="black" stroke="black" points="21692.5,-2741.79 21697.94,-2732.69 21688.02,-2736.41 21692.5,-2741.79"/>
</g>
<!-- transpose_k_3_15&#45;&gt;attn_scores_3_15 -->
<g id="edge1642" class="edge">
<title>transpose_k_3_15&#45;&gt;attn_scores_3_15</title>
<path fill="none" stroke="black" d="M21863.02,-2773.26C21844.61,-2761.82 21823.89,-2748.95 21804.81,-2737.08"/>
<polygon fill="black" stroke="black" points="21806.51,-2734.02 21796.16,-2731.71 21802.81,-2739.97 21806.51,-2734.02"/>
</g>
<!-- attn_output_3_15 -->
<g id="node1358" class="node">
<title>attn_output_3_15</title>
<ellipse fill="gold" stroke="black" cx="21740.57" cy="-2472.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21740.57" y="-2483.47" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="21740.57" y="-2468.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21740.57" y="-2453.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, 128]</text>
</g>
<!-- transpose_v_3_15&#45;&gt;attn_output_3_15 -->
<g id="edge1643" class="edge">
<title>transpose_v_3_15&#45;&gt;attn_output_3_15</title>
<path fill="none" stroke="black" d="M22191.68,-2771.58C22137.03,-2717.39 22026.13,-2613.42 21916.57,-2546.67 21891.4,-2531.33 21862.46,-2517.77 21835.41,-2506.61"/>
<polygon fill="black" stroke="black" points="21836.52,-2503.28 21825.93,-2502.77 21833.88,-2509.77 21836.52,-2503.28"/>
</g>
<!-- softmax_3_15 -->
<g id="node1359" class="node">
<title>softmax_3_15</title>
<ellipse fill="gold" stroke="black" cx="21740.57" cy="-2584.17" rx="167" ry="37.5"/>
<text text-anchor="middle" x="21740.57" y="-2595.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="21740.57" y="-2580.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21740.57" y="-2565.47" font-family="Times,serif" font-size="14.00">[B=1024, 4, L=2048, L=2048]</text>
</g>
<!-- attn_scores_3_15&#45;&gt;softmax_3_15 -->
<g id="edge1644" class="edge">
<title>attn_scores_3_15&#45;&gt;softmax_3_15</title>
<path fill="none" stroke="black" d="M21740.57,-2658.54C21740.57,-2650.09 21740.57,-2640.99 21740.57,-2632.18"/>
<polygon fill="black" stroke="black" points="21744.07,-2632.01 21740.57,-2622.01 21737.07,-2632.01 21744.07,-2632.01"/>
</g>
<!-- transpose_back_3_15 -->
<g id="node1360" class="node">
<title>transpose_back_3_15</title>
<ellipse fill="lightgray" stroke="black" cx="21515.57" cy="-2360.17" rx="145.65" ry="37.5"/>
<text text-anchor="middle" x="21515.57" y="-2371.47" font-family="Times,serif" font-size="14.00">Transpose Back</text>
<text text-anchor="middle" x="21515.57" y="-2356.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="21515.57" y="-2341.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 4, 128]</text>
</g>
<!-- attn_output_3_15&#45;&gt;transpose_back_3_15 -->
<g id="edge1646" class="edge">
<title>attn_output_3_15&#45;&gt;transpose_back_3_15</title>
<path fill="none" stroke="black" d="M21674.28,-2438.76C21648.2,-2426 21618.1,-2411.29 21591.17,-2398.12"/>
<polygon fill="black" stroke="black" points="21592.69,-2394.97 21582.17,-2393.72 21589.61,-2401.26 21592.69,-2394.97"/>
</g>
<!-- softmax_3_15&#45;&gt;attn_output_3_15 -->
<g id="edge1645" class="edge">
<title>softmax_3_15&#45;&gt;attn_output_3_15</title>
<path fill="none" stroke="black" d="M21740.57,-2546.54C21740.57,-2538.09 21740.57,-2528.99 21740.57,-2520.18"/>
<polygon fill="black" stroke="black" points="21744.07,-2520.01 21740.57,-2510.01 21737.07,-2520.01 21744.07,-2520.01"/>
</g>
<!-- reshape_concat_3_15 -->
<g id="node1361" class="node">
<title>reshape_concat_3_15</title>
<ellipse fill="lightcyan" stroke="black" cx="20878.57" cy="-2248.17" rx="133" ry="37.5"/>
<text text-anchor="middle" x="20878.57" y="-2259.47" font-family="Times,serif" font-size="14.00">Reshape Concat</text>
<text text-anchor="middle" x="20878.57" y="-2244.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20878.57" y="-2229.47" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 512]</text>
</g>
<!-- transpose_back_3_15&#45;&gt;reshape_concat_3_15 -->
<g id="edge1647" class="edge">
<title>transpose_back_3_15&#45;&gt;reshape_concat_3_15</title>
<path fill="none" stroke="black" d="M21396.13,-2338.54C21283.18,-2319.04 21114.48,-2289.9 21000.67,-2270.25"/>
<polygon fill="black" stroke="black" points="21000.96,-2266.75 20990.51,-2268.5 20999.77,-2273.65 21000.96,-2266.75"/>
</g>
<!-- reshape_concat_3_15&#45;&gt;allgather_dim_3_3 -->
<g id="edge1648" class="edge">
<title>reshape_concat_3_15&#45;&gt;allgather_dim_3_3</title>
<path fill="none" stroke="black" d="M20777.31,-2223.84C20757.52,-2219.39 20736.91,-2214.82 20717.57,-2210.67 20607.64,-2187.04 20481.81,-2161.64 20393.31,-2144.05"/>
<polygon fill="black" stroke="black" points="20393.74,-2140.57 20383.25,-2142.05 20392.38,-2147.43 20393.74,-2140.57"/>
</g>
<!-- output_proj_3_3 -->
<g id="node1366" class="node">
<title>output_proj_3_3</title>
<ellipse fill="orange" stroke="black" cx="16357.57" cy="-1907.58" rx="139.5" ry="48.17"/>
<text text-anchor="middle" x="16357.57" y="-1926.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16357.57" y="-1911.38" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="16357.57" y="-1896.38" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16357.57" y="-1881.38" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, 2048]</text>
</g>
<!-- head_group_3_3&#45;&gt;output_proj_3_3 -->
<g id="edge1653" class="edge">
<title>head_group_3_3&#45;&gt;output_proj_3_3</title>
<path fill="none" stroke="black" d="M16667.22,-1992.65C16614.39,-1978.31 16539.09,-1957.87 16475.98,-1940.73"/>
<polygon fill="black" stroke="black" points="16476.53,-1937.25 16465.97,-1938.01 16474.7,-1944.01 16476.53,-1937.25"/>
</g>
<!-- allreduce_output_3 -->
<g id="node1367" class="node">
<title>allreduce_output_3</title>
<polygon fill="red" stroke="black" points="14677.57,-1822.5 14534.57,-1769.5 14677.57,-1716.5 14820.57,-1769.5 14677.57,-1822.5"/>
<text text-anchor="middle" x="14677.57" y="-1780.8" font-family="Times,serif" font-size="14.00">AllReduce Output</text>
<text text-anchor="middle" x="14677.57" y="-1765.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14677.57" y="-1750.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- output_proj_3_0&#45;&gt;allreduce_output_3 -->
<g id="edge1654" class="edge">
<title>output_proj_3_0&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M13652.33,-1888.21C13716.81,-1879.15 13796.29,-1868.31 13867.57,-1859.5 14111.95,-1829.31 14398.46,-1799.03 14556.84,-1782.74"/>
<polygon fill="black" stroke="black" points="14557.49,-1786.19 14567.08,-1781.69 14556.78,-1779.23 14557.49,-1786.19"/>
</g>
<!-- output_proj_3_1&#45;&gt;allreduce_output_3 -->
<g id="edge1655" class="edge">
<title>output_proj_3_1&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M14153.29,-1899.59C14255.62,-1891.81 14397.79,-1875.49 14518.57,-1841.5 14549.82,-1832.71 14582.82,-1818.8 14610.61,-1805.62"/>
<polygon fill="black" stroke="black" points="14612.33,-1808.67 14619.83,-1801.18 14609.3,-1802.37 14612.33,-1808.67"/>
</g>
<!-- output_proj_3_2&#45;&gt;allreduce_output_3 -->
<g id="edge1656" class="edge">
<title>output_proj_3_2&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M15348.56,-1888.86C15261.65,-1876.54 15144.53,-1859.22 15041.57,-1841.5 14952.03,-1826.09 14850.61,-1806.1 14777.6,-1791.25"/>
<polygon fill="black" stroke="black" points="14777.99,-1787.76 14767.5,-1789.19 14776.6,-1794.62 14777.99,-1787.76"/>
</g>
<!-- output_proj_3_3&#45;&gt;allreduce_output_3 -->
<g id="edge1657" class="edge">
<title>output_proj_3_3&#45;&gt;allreduce_output_3</title>
<path fill="none" stroke="black" d="M16222.22,-1895.62C15903.94,-1869.84 15111.64,-1805.66 14803.23,-1780.68"/>
<polygon fill="black" stroke="black" points="14803.16,-1777.16 14792.91,-1779.84 14802.6,-1784.14 14803.16,-1777.16"/>
</g>
<!-- residual_3 -->
<g id="node1368" class="node">
<title>residual_3</title>
<ellipse fill="none" stroke="black" cx="14677.57" cy="-1661.5" rx="58.5" ry="18"/>
<text text-anchor="middle" x="14677.57" y="-1657.8" font-family="Times,serif" font-size="14.00">residual_3</text>
</g>
<!-- allreduce_output_3&#45;&gt;residual_3 -->
<g id="edge1658" class="edge">
<title>allreduce_output_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M14670.84,-1718.91C14670.76,-1708.95 14671.01,-1698.83 14671.57,-1689.96"/>
<polygon fill="black" stroke="black" points="14675.07,-1690.12 14672.42,-1679.86 14668.1,-1689.54 14675.07,-1690.12"/>
</g>
<!-- allreduce_output_3&#45;&gt;residual_3 -->
<g id="edge1659" class="edge">
<title>allreduce_output_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M14684.31,-1718.91C14684.38,-1708.95 14684.14,-1698.83 14683.57,-1689.96"/>
<polygon fill="black" stroke="black" points="14687.05,-1689.54 14682.72,-1679.86 14680.07,-1690.12 14687.05,-1689.54"/>
</g>
<!-- ln2_3_0 -->
<g id="node1369" class="node">
<title>ln2_3_0</title>
<ellipse fill="lightgreen" stroke="black" cx="11979.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="11979.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="11979.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11979.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_0 -->
<g id="edge1660" class="edge">
<title>residual_3&#45;&gt;ln2_3_0</title>
<path fill="none" stroke="black" d="M14619.12,-1659.81C14305.08,-1656 12815.41,-1636.63 12355.57,-1606.5 12279.16,-1601.49 12194.24,-1593.46 12124.46,-1586.2"/>
<polygon fill="black" stroke="black" points="12124.59,-1582.7 12114.28,-1585.14 12123.86,-1589.66 12124.59,-1582.7"/>
</g>
<!-- ln2_3_1 -->
<g id="node1370" class="node">
<title>ln2_3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="12513.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12513.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12513.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12513.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_1 -->
<g id="edge1661" class="edge">
<title>residual_3&#45;&gt;ln2_3_1</title>
<path fill="none" stroke="black" d="M14619.33,-1659.35C14421.97,-1655.39 13760.27,-1641.71 13213.57,-1625.5 12974.86,-1618.42 12913.44,-1636.94 12676.57,-1606.5 12660.5,-1604.43 12643.67,-1601.53 12627.18,-1598.25"/>
<polygon fill="black" stroke="black" points="12627.47,-1594.74 12616.97,-1596.17 12626.07,-1601.6 12627.47,-1594.74"/>
</g>
<!-- ln2_3_2 -->
<g id="node1371" class="node">
<title>ln2_3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="12834.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="12834.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12834.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12834.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_2 -->
<g id="edge1662" class="edge">
<title>residual_3&#45;&gt;ln2_3_2</title>
<path fill="none" stroke="black" d="M14619.22,-1660.13C14360.99,-1658.27 13319.57,-1648.27 12995.57,-1606.5 12979.8,-1604.47 12963.3,-1601.6 12947.14,-1598.36"/>
<polygon fill="black" stroke="black" points="12947.62,-1594.88 12937.12,-1596.29 12946.21,-1601.74 12947.62,-1594.88"/>
</g>
<!-- ln2_3_3 -->
<g id="node1372" class="node">
<title>ln2_3_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13153.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13153.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13153.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13153.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_3 -->
<g id="edge1663" class="edge">
<title>residual_3&#45;&gt;ln2_3_3</title>
<path fill="none" stroke="black" d="M14619.08,-1659.45C14394.04,-1655.2 13584.02,-1638.03 13328.57,-1606.5 13309.69,-1604.17 13289.81,-1600.86 13270.5,-1597.18"/>
<polygon fill="black" stroke="black" points="13270.95,-1593.7 13260.46,-1595.22 13269.61,-1600.57 13270.95,-1593.7"/>
</g>
<!-- ln2_3_4 -->
<g id="node1373" class="node">
<title>ln2_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="13486.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13486.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13486.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13486.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_4 -->
<g id="edge1664" class="edge">
<title>residual_3&#45;&gt;ln2_3_4</title>
<path fill="none" stroke="black" d="M14619.55,-1658.96C14471.76,-1654.64 14069.25,-1640.45 13735.57,-1606.5 13697.87,-1602.66 13657.12,-1597.24 13619.73,-1591.74"/>
<polygon fill="black" stroke="black" points="13620.2,-1588.27 13609.79,-1590.26 13619.17,-1595.19 13620.2,-1588.27"/>
</g>
<!-- ln2_3_5 -->
<g id="node1374" class="node">
<title>ln2_3_5</title>
<ellipse fill="lightgreen" stroke="black" cx="13893.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="13893.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13893.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13893.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_5 -->
<g id="edge1665" class="edge">
<title>residual_3&#45;&gt;ln2_3_5</title>
<path fill="none" stroke="black" d="M14620.9,-1656.84C14516.75,-1649.77 14288.04,-1632.56 14096.57,-1606.5 14071.59,-1603.1 14045,-1598.81 14019.57,-1594.37"/>
<polygon fill="black" stroke="black" points="14019.96,-1590.89 14009.51,-1592.6 14018.75,-1597.78 14019.96,-1590.89"/>
</g>
<!-- ln2_3_6 -->
<g id="node1375" class="node">
<title>ln2_3_6</title>
<ellipse fill="lightgreen" stroke="black" cx="14254.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14254.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14254.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14254.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_6 -->
<g id="edge1666" class="edge">
<title>residual_3&#45;&gt;ln2_3_6</title>
<path fill="none" stroke="black" d="M14631.1,-1650.56C14570.3,-1637.55 14461.51,-1614.27 14376.46,-1596.08"/>
<polygon fill="black" stroke="black" points="14376.98,-1592.61 14366.47,-1593.94 14375.51,-1599.45 14376.98,-1592.61"/>
</g>
<!-- ln2_3_7 -->
<g id="node1376" class="node">
<title>ln2_3_7</title>
<ellipse fill="lightgreen" stroke="black" cx="14593.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14593.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14593.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14593.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_7 -->
<g id="edge1667" class="edge">
<title>residual_3&#45;&gt;ln2_3_7</title>
<path fill="none" stroke="black" d="M14662.17,-1643.9C14654.09,-1635.19 14643.77,-1624.08 14633.61,-1613.14"/>
<polygon fill="black" stroke="black" points="14636,-1610.57 14626.63,-1605.62 14630.87,-1615.33 14636,-1610.57"/>
</g>
<!-- ln2_3_8 -->
<g id="node1377" class="node">
<title>ln2_3_8</title>
<ellipse fill="lightgreen" stroke="black" cx="14919.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="14919.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14919.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14919.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_8 -->
<g id="edge1668" class="edge">
<title>residual_3&#45;&gt;ln2_3_8</title>
<path fill="none" stroke="black" d="M14713.28,-1647.15C14743.59,-1635.81 14788.42,-1619.05 14828.56,-1604.04"/>
<polygon fill="black" stroke="black" points="14829.97,-1607.24 14838.11,-1600.46 14827.52,-1600.69 14829.97,-1607.24"/>
</g>
<!-- ln2_3_9 -->
<g id="node1378" class="node">
<title>ln2_3_9</title>
<ellipse fill="lightgreen" stroke="black" cx="15278.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15278.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15278.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15278.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_9 -->
<g id="edge1669" class="edge">
<title>residual_3&#45;&gt;ln2_3_9</title>
<path fill="none" stroke="black" d="M14731.06,-1654.06C14807.89,-1644.64 14953.85,-1626.07 15077.57,-1606.5 15101.43,-1602.72 15126.83,-1598.37 15151.25,-1594.02"/>
<polygon fill="black" stroke="black" points="15152.06,-1597.43 15161.28,-1592.22 15150.82,-1590.54 15152.06,-1597.43"/>
</g>
<!-- ln2_3_10 -->
<g id="node1379" class="node">
<title>ln2_3_10</title>
<ellipse fill="lightgreen" stroke="black" cx="15616.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="15616.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15616.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15616.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_10 -->
<g id="edge1670" class="edge">
<title>residual_3&#45;&gt;ln2_3_10</title>
<path fill="none" stroke="black" d="M14735.92,-1658.91C14863.52,-1654.88 15176.75,-1641.93 15436.57,-1606.5 15456.26,-1603.81 15477.02,-1600.28 15497.18,-1596.46"/>
<polygon fill="black" stroke="black" points="15497.86,-1599.89 15507.01,-1594.56 15496.53,-1593.02 15497.86,-1599.89"/>
</g>
<!-- ln2_3_11 -->
<g id="node1380" class="node">
<title>ln2_3_11</title>
<ellipse fill="lightgreen" stroke="black" cx="16009.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16009.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16009.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16009.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_11 -->
<g id="edge1671" class="edge">
<title>residual_3&#45;&gt;ln2_3_11</title>
<path fill="none" stroke="black" d="M14736.01,-1659.78C14900.12,-1657.29 15379.05,-1646.84 15774.57,-1606.5 15808.59,-1603.03 15845.2,-1597.98 15879.15,-1592.75"/>
<polygon fill="black" stroke="black" points="15879.79,-1596.19 15889.13,-1591.19 15878.71,-1589.27 15879.79,-1596.19"/>
</g>
<!-- ln2_3_12 -->
<g id="node1381" class="node">
<title>ln2_3_12</title>
<ellipse fill="lightgreen" stroke="black" cx="16364.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16364.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16364.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16364.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_12 -->
<g id="edge1672" class="edge">
<title>residual_3&#45;&gt;ln2_3_12</title>
<path fill="none" stroke="black" d="M14735.94,-1659.53C14975.31,-1655.39 15882.62,-1637.89 16167.57,-1606.5 16191.81,-1603.83 16217.54,-1599.89 16242.13,-1595.57"/>
<polygon fill="black" stroke="black" points="16243,-1598.97 16252.23,-1593.76 16241.77,-1592.08 16243,-1598.97"/>
</g>
<!-- ln2_3_13 -->
<g id="node1382" class="node">
<title>ln2_3_13</title>
<ellipse fill="lightgreen" stroke="black" cx="16699.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="16699.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16699.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16699.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_13 -->
<g id="edge1673" class="edge">
<title>residual_3&#45;&gt;ln2_3_13</title>
<path fill="none" stroke="black" d="M14735.98,-1660.18C15009.36,-1658.45 16164.35,-1648.73 16522.57,-1606.5 16542.03,-1604.21 16562.53,-1600.86 16582.4,-1597.11"/>
<polygon fill="black" stroke="black" points="16583.26,-1600.51 16592.41,-1595.18 16581.93,-1593.64 16583.26,-1600.51"/>
</g>
<!-- ln2_3_14 -->
<g id="node1383" class="node">
<title>ln2_3_14</title>
<ellipse fill="lightgreen" stroke="black" cx="17025.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17025.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17025.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17025.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_14 -->
<g id="edge1674" class="edge">
<title>residual_3&#45;&gt;ln2_3_14</title>
<path fill="none" stroke="black" d="M14735.84,-1659.49C14945.79,-1655.78 15683.26,-1642.3 16291.57,-1625.5 16543.17,-1618.55 16607.8,-1637.57 16857.57,-1606.5 16874.94,-1604.34 16893.17,-1601.25 16910.95,-1597.78"/>
<polygon fill="black" stroke="black" points="16911.65,-1601.21 16920.77,-1595.81 16910.28,-1594.34 16911.65,-1601.21"/>
</g>
<!-- ln2_3_15 -->
<g id="node1384" class="node">
<title>ln2_3_15</title>
<ellipse fill="lightgreen" stroke="black" cx="17346.57" cy="-1569" rx="149.21" ry="37.5"/>
<text text-anchor="middle" x="17346.57" y="-1580.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17346.57" y="-1565.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17346.57" y="-1550.3" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=512]</text>
</g>
<!-- residual_3&#45;&gt;ln2_3_15 -->
<g id="edge1675" class="edge">
<title>residual_3&#45;&gt;ln2_3_15</title>
<path fill="none" stroke="black" d="M14736.01,-1659.51C14960.42,-1655.68 15788.52,-1641.24 16470.57,-1625.5 16787.49,-1618.18 16868.99,-1645.54 17183.57,-1606.5 17199.93,-1604.47 17217.06,-1601.54 17233.82,-1598.21"/>
<polygon fill="black" stroke="black" points="17234.53,-1601.64 17243.63,-1596.21 17233.13,-1594.78 17234.53,-1601.64"/>
</g>
<!-- router_3_0 -->
<g id="node1385" class="node">
<title>router_3_0</title>
<ellipse fill="purple" stroke="black" cx="11619.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="11619.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="11619.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11619.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_0&#45;&gt;router_3_0 -->
<g id="edge1676" class="edge">
<title>ln2_3_0&#45;&gt;router_3_0</title>
<path fill="none" stroke="black" d="M11886.4,-1539.53C11836.1,-1524.16 11773.9,-1505.16 11722.22,-1489.36"/>
<polygon fill="black" stroke="black" points="11722.95,-1485.93 11712.36,-1486.35 11720.9,-1492.62 11722.95,-1485.93"/>
</g>
<!-- router_3_1 -->
<g id="node1386" class="node">
<title>router_3_1</title>
<ellipse fill="purple" stroke="black" cx="12177.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12177.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12177.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12177.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_1&#45;&gt;router_3_1 -->
<g id="edge1677" class="edge">
<title>ln2_3_1&#45;&gt;router_3_1</title>
<path fill="none" stroke="black" d="M12424.41,-1538.81C12378.67,-1523.83 12322.84,-1505.56 12275.85,-1490.17"/>
<polygon fill="black" stroke="black" points="12276.87,-1486.82 12266.27,-1487.04 12274.69,-1493.48 12276.87,-1486.82"/>
</g>
<!-- router_3_2 -->
<g id="node1387" class="node">
<title>router_3_2</title>
<ellipse fill="purple" stroke="black" cx="12675.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="12675.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="12675.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12675.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_2&#45;&gt;router_3_2 -->
<g id="edge1678" class="edge">
<title>ln2_3_2&#45;&gt;router_3_2</title>
<path fill="none" stroke="black" d="M12784.7,-1533.5C12768.57,-1522.34 12750.54,-1509.86 12733.85,-1498.32"/>
<polygon fill="black" stroke="black" points="12735.48,-1495.19 12725.27,-1492.38 12731.5,-1500.95 12735.48,-1495.19"/>
</g>
<!-- router_3_3 -->
<g id="node1388" class="node">
<title>router_3_3</title>
<ellipse fill="purple" stroke="black" cx="13132.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13132.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13132.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13132.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_3&#45;&gt;router_3_3 -->
<g id="edge1679" class="edge">
<title>ln2_3_3&#45;&gt;router_3_3</title>
<path fill="none" stroke="black" d="M13146.58,-1531.37C13144.93,-1522.74 13143.16,-1513.43 13141.44,-1504.44"/>
<polygon fill="black" stroke="black" points="13144.85,-1503.63 13139.54,-1494.47 13137.97,-1504.95 13144.85,-1503.63"/>
</g>
<!-- router_3_4 -->
<g id="node1389" class="node">
<title>router_3_4</title>
<ellipse fill="purple" stroke="black" cx="13467.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13467.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13467.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13467.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_4&#45;&gt;router_3_4 -->
<g id="edge1680" class="edge">
<title>ln2_3_4&#45;&gt;router_3_4</title>
<path fill="none" stroke="black" d="M13480.25,-1531.37C13478.76,-1522.74 13477.15,-1513.43 13475.59,-1504.44"/>
<polygon fill="black" stroke="black" points="13479.02,-1503.73 13473.87,-1494.47 13472.13,-1504.92 13479.02,-1503.73"/>
</g>
<!-- router_3_5 -->
<g id="node1390" class="node">
<title>router_3_5</title>
<ellipse fill="purple" stroke="black" cx="13792.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="13792.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="13792.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13792.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_5&#45;&gt;router_3_5 -->
<g id="edge1681" class="edge">
<title>ln2_3_5&#45;&gt;router_3_5</title>
<path fill="none" stroke="black" d="M13860.78,-1532.29C13851.79,-1522.49 13841.93,-1511.75 13832.58,-1501.57"/>
<polygon fill="black" stroke="black" points="13834.89,-1498.91 13825.55,-1493.91 13829.73,-1503.64 13834.89,-1498.91"/>
</g>
<!-- router_3_6 -->
<g id="node1391" class="node">
<title>router_3_6</title>
<ellipse fill="purple" stroke="black" cx="14190.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14190.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14190.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14190.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_6&#45;&gt;router_3_6 -->
<g id="edge1682" class="edge">
<title>ln2_3_6&#45;&gt;router_3_6</title>
<path fill="none" stroke="black" d="M14233.44,-1531.68C14228.14,-1522.57 14222.39,-1512.69 14216.88,-1503.21"/>
<polygon fill="black" stroke="black" points="14219.74,-1501.17 14211.68,-1494.28 14213.69,-1504.69 14219.74,-1501.17"/>
</g>
<!-- router_3_7 -->
<g id="node1392" class="node">
<title>router_3_7</title>
<ellipse fill="purple" stroke="black" cx="14573.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14573.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14573.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14573.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_7&#45;&gt;router_3_7 -->
<g id="edge1683" class="edge">
<title>ln2_3_7&#45;&gt;router_3_7</title>
<path fill="none" stroke="black" d="M14586.91,-1531.37C14585.35,-1522.74 14583.65,-1513.43 14582.02,-1504.44"/>
<polygon fill="black" stroke="black" points="14585.44,-1503.68 14580.2,-1494.47 14578.55,-1504.93 14585.44,-1503.68"/>
</g>
<!-- router_3_8 -->
<g id="node1393" class="node">
<title>router_3_8</title>
<ellipse fill="purple" stroke="black" cx="14922.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="14922.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="14922.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14922.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_8&#45;&gt;router_3_8 -->
<g id="edge1684" class="edge">
<title>ln2_3_8&#45;&gt;router_3_8</title>
<path fill="none" stroke="black" d="M14920.57,-1531.37C14920.8,-1522.93 14921.05,-1513.83 14921.29,-1505.01"/>
<polygon fill="black" stroke="black" points="14924.79,-1504.93 14921.57,-1494.84 14917.8,-1504.74 14924.79,-1504.93"/>
</g>
<!-- router_3_9 -->
<g id="node1394" class="node">
<title>router_3_9</title>
<ellipse fill="purple" stroke="black" cx="15307.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15307.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15307.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15307.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_9&#45;&gt;router_3_9 -->
<g id="edge1685" class="edge">
<title>ln2_3_9&#45;&gt;router_3_9</title>
<path fill="none" stroke="black" d="M15288.23,-1531.37C15290.53,-1522.65 15293.01,-1513.23 15295.41,-1504.15"/>
<polygon fill="black" stroke="black" points="15298.79,-1505.03 15297.96,-1494.47 15292.03,-1503.25 15298.79,-1505.03"/>
</g>
<!-- router_3_10 -->
<g id="node1395" class="node">
<title>router_3_10</title>
<ellipse fill="purple" stroke="black" cx="15622.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="15622.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="15622.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15622.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_10&#45;&gt;router_3_10 -->
<g id="edge1686" class="edge">
<title>ln2_3_10&#45;&gt;router_3_10</title>
<path fill="none" stroke="black" d="M15618.57,-1531.37C15619.03,-1522.93 15619.53,-1513.83 15620.01,-1505.01"/>
<polygon fill="black" stroke="black" points="15623.51,-1505.02 15620.56,-1494.84 15616.52,-1504.64 15623.51,-1505.02"/>
</g>
<!-- router_3_11 -->
<g id="node1396" class="node">
<title>router_3_11</title>
<ellipse fill="purple" stroke="black" cx="16030.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16030.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16030.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16030.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_11&#45;&gt;router_3_11 -->
<g id="edge1687" class="edge">
<title>ln2_3_11&#45;&gt;router_3_11</title>
<path fill="none" stroke="black" d="M16016.57,-1531.37C16018.21,-1522.74 16019.99,-1513.43 16021.71,-1504.44"/>
<polygon fill="black" stroke="black" points="16025.17,-1504.95 16023.61,-1494.47 16018.3,-1503.63 16025.17,-1504.95"/>
</g>
<!-- router_3_12 -->
<g id="node1397" class="node">
<title>router_3_12</title>
<ellipse fill="purple" stroke="black" cx="16400.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16400.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16400.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16400.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_12&#45;&gt;router_3_12 -->
<g id="edge1688" class="edge">
<title>ln2_3_12&#45;&gt;router_3_12</title>
<path fill="none" stroke="black" d="M16376.56,-1531.37C16379.41,-1522.65 16382.5,-1513.23 16385.47,-1504.15"/>
<polygon fill="black" stroke="black" points="16388.85,-1505.06 16388.64,-1494.47 16382.2,-1502.88 16388.85,-1505.06"/>
</g>
<!-- router_3_13 -->
<g id="node1398" class="node">
<title>router_3_13</title>
<ellipse fill="purple" stroke="black" cx="16860.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="16860.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="16860.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16860.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_13&#45;&gt;router_3_13 -->
<g id="edge1689" class="edge">
<title>ln2_3_13&#45;&gt;router_3_13</title>
<path fill="none" stroke="black" d="M16750.07,-1533.5C16766.41,-1522.34 16784.66,-1509.86 16801.56,-1498.32"/>
<polygon fill="black" stroke="black" points="16803.97,-1500.91 16810.25,-1492.38 16800.02,-1495.13 16803.97,-1500.91"/>
</g>
<!-- router_3_14 -->
<g id="node1399" class="node">
<title>router_3_14</title>
<ellipse fill="purple" stroke="black" cx="17176.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17176.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17176.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17176.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_14&#45;&gt;router_3_14 -->
<g id="edge1690" class="edge">
<title>ln2_3_14&#45;&gt;router_3_14</title>
<path fill="none" stroke="black" d="M17073.35,-1533.19C17088.37,-1522.25 17105.09,-1510.08 17120.62,-1498.76"/>
<polygon fill="black" stroke="black" points="17123.09,-1501.29 17129.11,-1492.58 17118.96,-1495.64 17123.09,-1501.29"/>
</g>
<!-- router_3_15 -->
<g id="node1400" class="node">
<title>router_3_15</title>
<ellipse fill="purple" stroke="black" cx="17491.57" cy="-1457" rx="148" ry="37.5"/>
<text text-anchor="middle" x="17491.57" y="-1468.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="17491.57" y="-1453.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17491.57" y="-1438.3" font-family="Times,serif" font-size="14.00">[B=1024*L=2048, D=512]</text>
</g>
<!-- ln2_3_15&#45;&gt;router_3_15 -->
<g id="edge1691" class="edge">
<title>ln2_3_15&#45;&gt;router_3_15</title>
<path fill="none" stroke="black" d="M17392.45,-1533.19C17406.73,-1522.36 17422.62,-1510.31 17437.41,-1499.09"/>
<polygon fill="black" stroke="black" points="17439.64,-1501.79 17445.5,-1492.96 17435.41,-1496.21 17439.64,-1501.79"/>
</g>
<!-- dispatch_3_0 -->
<g id="node1401" class="node">
<title>dispatch_3_0</title>
<polygon fill="purple" stroke="black" points="11529.57,-1382.5 11341.57,-1329.5 11529.57,-1276.5 11717.57,-1329.5 11529.57,-1382.5"/>
<text text-anchor="middle" x="11529.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="11529.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11529.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_0&#45;&gt;dispatch_3_0 -->
<g id="edge1692" class="edge">
<title>router_3_0&#45;&gt;dispatch_3_0</title>
<path fill="none" stroke="black" d="M11593.78,-1420.04C11585.35,-1408.27 11575.8,-1394.96 11566.7,-1382.27"/>
<polygon fill="black" stroke="black" points="11569.47,-1380.13 11560.8,-1374.04 11563.78,-1384.21 11569.47,-1380.13"/>
</g>
<!-- dispatch_3_1 -->
<g id="node1402" class="node">
<title>dispatch_3_1</title>
<polygon fill="purple" stroke="black" points="12046.57,-1382.5 11858.57,-1329.5 12046.57,-1276.5 12234.57,-1329.5 12046.57,-1382.5"/>
<text text-anchor="middle" x="12046.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12046.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12046.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_1&#45;&gt;dispatch_3_1 -->
<g id="edge1693" class="edge">
<title>router_3_1&#45;&gt;dispatch_3_1</title>
<path fill="none" stroke="black" d="M12140.38,-1420.37C12126.73,-1407.29 12111.04,-1392.26 12096.45,-1378.28"/>
<polygon fill="black" stroke="black" points="12098.58,-1375.47 12088.94,-1371.08 12093.74,-1380.53 12098.58,-1375.47"/>
</g>
<!-- dispatch_3_2 -->
<g id="node1403" class="node">
<title>dispatch_3_2</title>
<polygon fill="purple" stroke="black" points="12561.57,-1382.5 12373.57,-1329.5 12561.57,-1276.5 12749.57,-1329.5 12561.57,-1382.5"/>
<text text-anchor="middle" x="12561.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12561.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12561.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_2&#45;&gt;dispatch_3_2 -->
<g id="edge1694" class="edge">
<title>router_3_2&#45;&gt;dispatch_3_2</title>
<path fill="none" stroke="black" d="M12643.21,-1420.37C12631.66,-1407.65 12618.43,-1393.1 12606.04,-1379.45"/>
<polygon fill="black" stroke="black" points="12608.57,-1377.03 12599.26,-1371.98 12603.39,-1381.74 12608.57,-1377.03"/>
</g>
<!-- dispatch_3_3 -->
<g id="node1404" class="node">
<title>dispatch_3_3</title>
<polygon fill="purple" stroke="black" points="12956.57,-1382.5 12768.57,-1329.5 12956.57,-1276.5 13144.57,-1329.5 12956.57,-1382.5"/>
<text text-anchor="middle" x="12956.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="12956.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12956.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_3&#45;&gt;dispatch_3_3 -->
<g id="edge1695" class="edge">
<title>router_3_3&#45;&gt;dispatch_3_3</title>
<path fill="none" stroke="black" d="M13084.01,-1421.37C13063.35,-1406.64 13039.04,-1389.3 13017.21,-1373.74"/>
<polygon fill="black" stroke="black" points="13019.16,-1370.83 13008.98,-1367.87 13015.09,-1376.53 13019.16,-1370.83"/>
</g>
<!-- dispatch_3_4 -->
<g id="node1405" class="node">
<title>dispatch_3_4</title>
<polygon fill="purple" stroke="black" points="13351.57,-1382.5 13163.57,-1329.5 13351.57,-1276.5 13539.57,-1329.5 13351.57,-1382.5"/>
<text text-anchor="middle" x="13351.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13351.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13351.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_4&#45;&gt;dispatch_3_4 -->
<g id="edge1696" class="edge">
<title>router_3_4&#45;&gt;dispatch_3_4</title>
<path fill="none" stroke="black" d="M13434.64,-1420.37C13422.89,-1407.65 13409.43,-1393.1 13396.82,-1379.45"/>
<polygon fill="black" stroke="black" points="13399.28,-1376.95 13389.92,-1371.98 13394.14,-1381.7 13399.28,-1376.95"/>
</g>
<!-- dispatch_3_5 -->
<g id="node1406" class="node">
<title>dispatch_3_5</title>
<polygon fill="purple" stroke="black" points="13745.57,-1382.5 13557.57,-1329.5 13745.57,-1276.5 13933.57,-1329.5 13745.57,-1382.5"/>
<text text-anchor="middle" x="13745.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="13745.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13745.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_5&#45;&gt;dispatch_3_5 -->
<g id="edge1697" class="edge">
<title>router_3_5&#45;&gt;dispatch_3_5</title>
<path fill="none" stroke="black" d="M13778.85,-1419.36C13775.08,-1409.29 13770.9,-1398.12 13766.81,-1387.21"/>
<polygon fill="black" stroke="black" points="13770.04,-1385.85 13763.25,-1377.71 13763.48,-1388.3 13770.04,-1385.85"/>
</g>
<!-- dispatch_3_6 -->
<g id="node1407" class="node">
<title>dispatch_3_6</title>
<polygon fill="purple" stroke="black" points="14139.57,-1382.5 13951.57,-1329.5 14139.57,-1276.5 14327.57,-1329.5 14139.57,-1382.5"/>
<text text-anchor="middle" x="14139.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14139.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14139.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_6&#45;&gt;dispatch_3_6 -->
<g id="edge1698" class="edge">
<title>router_3_6&#45;&gt;dispatch_3_6</title>
<path fill="none" stroke="black" d="M14175.69,-1419.36C14171.55,-1409.18 14166.95,-1397.88 14162.47,-1386.84"/>
<polygon fill="black" stroke="black" points="14165.58,-1385.2 14158.57,-1377.25 14159.09,-1387.83 14165.58,-1385.2"/>
</g>
<!-- dispatch_3_7 -->
<g id="node1408" class="node">
<title>dispatch_3_7</title>
<polygon fill="purple" stroke="black" points="14533.57,-1382.5 14345.57,-1329.5 14533.57,-1276.5 14721.57,-1329.5 14533.57,-1382.5"/>
<text text-anchor="middle" x="14533.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14533.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14533.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_7&#45;&gt;dispatch_3_7 -->
<g id="edge1699" class="edge">
<title>router_3_7&#45;&gt;dispatch_3_7</title>
<path fill="none" stroke="black" d="M14561.9,-1419.36C14558.79,-1409.61 14555.36,-1398.84 14551.98,-1388.26"/>
<polygon fill="black" stroke="black" points="14555.28,-1387.09 14548.91,-1378.63 14548.62,-1389.22 14555.28,-1387.09"/>
</g>
<!-- dispatch_3_8 -->
<g id="node1409" class="node">
<title>dispatch_3_8</title>
<polygon fill="purple" stroke="black" points="14927.57,-1382.5 14739.57,-1329.5 14927.57,-1276.5 15115.57,-1329.5 14927.57,-1382.5"/>
<text text-anchor="middle" x="14927.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="14927.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14927.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_8&#45;&gt;dispatch_3_8 -->
<g id="edge1700" class="edge">
<title>router_3_8&#45;&gt;dispatch_3_8</title>
<path fill="none" stroke="black" d="M14924.03,-1419.36C14924.37,-1410.95 14924.73,-1401.78 14925.1,-1392.62"/>
<polygon fill="black" stroke="black" points="14928.61,-1392.47 14925.51,-1382.34 14921.61,-1392.19 14928.61,-1392.47"/>
</g>
<!-- dispatch_3_9 -->
<g id="node1410" class="node">
<title>dispatch_3_9</title>
<polygon fill="purple" stroke="black" points="15321.57,-1382.5 15133.57,-1329.5 15321.57,-1276.5 15509.57,-1329.5 15321.57,-1382.5"/>
<text text-anchor="middle" x="15321.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15321.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15321.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_9&#45;&gt;dispatch_3_9 -->
<g id="edge1701" class="edge">
<title>router_3_9&#45;&gt;dispatch_3_9</title>
<path fill="none" stroke="black" d="M15311.66,-1419.36C15312.65,-1410.45 15313.74,-1400.68 15314.83,-1390.98"/>
<polygon fill="black" stroke="black" points="15318.32,-1391.27 15315.95,-1380.94 15311.36,-1390.49 15318.32,-1391.27"/>
</g>
<!-- dispatch_3_10 -->
<g id="node1411" class="node">
<title>dispatch_3_10</title>
<polygon fill="purple" stroke="black" points="15715.57,-1382.5 15527.57,-1329.5 15715.57,-1276.5 15903.57,-1329.5 15715.57,-1382.5"/>
<text text-anchor="middle" x="15715.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="15715.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15715.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_10&#45;&gt;dispatch_3_10 -->
<g id="edge1702" class="edge">
<title>router_3_10&#45;&gt;dispatch_3_10</title>
<path fill="none" stroke="black" d="M15649.22,-1420.04C15658.03,-1408.15 15668,-1394.69 15677.5,-1381.88"/>
<polygon fill="black" stroke="black" points="15680.5,-1383.7 15683.65,-1373.59 15674.88,-1379.54 15680.5,-1383.7"/>
</g>
<!-- dispatch_3_11 -->
<g id="node1412" class="node">
<title>dispatch_3_11</title>
<polygon fill="purple" stroke="black" points="16109.57,-1382.5 15921.57,-1329.5 16109.57,-1276.5 16297.57,-1329.5 16109.57,-1382.5"/>
<text text-anchor="middle" x="16109.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16109.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16109.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_11&#45;&gt;dispatch_3_11 -->
<g id="edge1703" class="edge">
<title>router_3_11&#45;&gt;dispatch_3_11</title>
<path fill="none" stroke="black" d="M16053.42,-1419.7C16060.54,-1408.4 16068.53,-1395.7 16076.21,-1383.5"/>
<polygon fill="black" stroke="black" points="16079.36,-1385.06 16081.73,-1374.73 16073.44,-1381.33 16079.36,-1385.06"/>
</g>
<!-- dispatch_3_12 -->
<g id="node1413" class="node">
<title>dispatch_3_12</title>
<polygon fill="purple" stroke="black" points="16507.57,-1382.5 16319.57,-1329.5 16507.57,-1276.5 16695.57,-1329.5 16507.57,-1382.5"/>
<text text-anchor="middle" x="16507.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16507.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16507.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_12&#45;&gt;dispatch_3_12 -->
<g id="edge1704" class="edge">
<title>router_3_12&#45;&gt;dispatch_3_12</title>
<path fill="none" stroke="black" d="M16431.24,-1420.04C16441.77,-1407.68 16453.75,-1393.63 16465.05,-1380.37"/>
<polygon fill="black" stroke="black" points="16467.79,-1382.56 16471.61,-1372.68 16462.46,-1378.02 16467.79,-1382.56"/>
</g>
<!-- dispatch_3_13 -->
<g id="node1414" class="node">
<title>dispatch_3_13</title>
<polygon fill="purple" stroke="black" points="16930.57,-1382.5 16742.57,-1329.5 16930.57,-1276.5 17118.57,-1329.5 16930.57,-1382.5"/>
<text text-anchor="middle" x="16930.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="16930.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16930.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_13&#45;&gt;dispatch_3_13 -->
<g id="edge1705" class="edge">
<title>router_3_13&#45;&gt;dispatch_3_13</title>
<path fill="none" stroke="black" d="M16880.82,-1419.7C16886.93,-1408.74 16893.78,-1396.46 16900.4,-1384.6"/>
<polygon fill="black" stroke="black" points="16903.58,-1386.08 16905.39,-1375.64 16897.47,-1382.67 16903.58,-1386.08"/>
</g>
<!-- dispatch_3_14 -->
<g id="node1415" class="node">
<title>dispatch_3_14</title>
<polygon fill="purple" stroke="black" points="17409.57,-1382.5 17221.57,-1329.5 17409.57,-1276.5 17597.57,-1329.5 17409.57,-1382.5"/>
<text text-anchor="middle" x="17409.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17409.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17409.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_14&#45;&gt;dispatch_3_14 -->
<g id="edge1706" class="edge">
<title>router_3_14&#45;&gt;dispatch_3_14</title>
<path fill="none" stroke="black" d="M17238.1,-1422.86C17268.54,-1406.47 17305.47,-1386.57 17337.26,-1369.45"/>
<polygon fill="black" stroke="black" points="17338.93,-1372.52 17346.08,-1364.7 17335.62,-1366.36 17338.93,-1372.52"/>
</g>
<!-- dispatch_3_15 -->
<g id="node1416" class="node">
<title>dispatch_3_15</title>
<polygon fill="purple" stroke="black" points="17846.57,-1382.5 17658.57,-1329.5 17846.57,-1276.5 18034.57,-1329.5 17846.57,-1382.5"/>
<text text-anchor="middle" x="17846.57" y="-1340.8" font-family="Times,serif" font-size="14.00">Dispatch</text>
<text text-anchor="middle" x="17846.57" y="-1325.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17846.57" y="-1310.8" font-family="Times,serif" font-size="14.00">Route tokens to experts</text>
</g>
<!-- router_3_15&#45;&gt;dispatch_3_15 -->
<g id="edge1707" class="edge">
<title>router_3_15&#45;&gt;dispatch_3_15</title>
<path fill="none" stroke="black" d="M17576.15,-1426.1C17629.94,-1407.09 17699.57,-1382.47 17754.71,-1362.98"/>
<polygon fill="black" stroke="black" points="17756.21,-1366.16 17764.48,-1359.52 17753.88,-1359.56 17756.21,-1366.16"/>
</g>
<!-- expert_3_0_fc1_0 -->
<g id="node1417" class="node">
<title>expert_3_0_fc1_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11507.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11507.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11507.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11507.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11507.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_0&#45;&gt;expert_3_0_fc1_0 -->
<g id="edge1708" class="edge">
<title>dispatch_3_0&#45;&gt;expert_3_0_fc1_0</title>
<path fill="none" stroke="black" d="M11521.51,-1278.6C11519.98,-1269.14 11518.37,-1259.18 11516.8,-1249.52"/>
<polygon fill="black" stroke="black" points="11520.25,-1248.91 11515.2,-1239.59 11513.34,-1250.02 11520.25,-1248.91"/>
</g>
<!-- expert_3_0_fc1_1 -->
<g id="node1418" class="node">
<title>expert_3_0_fc1_1</title>
<ellipse fill="lightcoral" stroke="black" cx="11903.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11903.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="11903.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11903.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11903.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_1&#45;&gt;expert_3_0_fc1_1 -->
<g id="edge1709" class="edge">
<title>dispatch_3_1&#45;&gt;expert_3_0_fc1_1</title>
<path fill="none" stroke="black" d="M12004.06,-1288.04C11989.13,-1273.83 11972.17,-1257.69 11956.49,-1242.78"/>
<polygon fill="black" stroke="black" points="11958.57,-1239.92 11948.91,-1235.56 11953.75,-1244.99 11958.57,-1239.92"/>
</g>
<!-- expert_3_1_fc1_2 -->
<g id="node1419" class="node">
<title>expert_3_1_fc1_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12551.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12551.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="12551.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12551.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12551.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_2&#45;&gt;expert_3_1_fc1_2 -->
<g id="edge1710" class="edge">
<title>dispatch_3_2&#45;&gt;expert_3_1_fc1_2</title>
<path fill="none" stroke="black" d="M12557.82,-1277.44C12557.16,-1268.45 12556.47,-1259.04 12555.8,-1249.9"/>
<polygon fill="black" stroke="black" points="12559.27,-1249.43 12555.05,-1239.72 12552.29,-1249.95 12559.27,-1249.43"/>
</g>
<!-- expert_3_1_fc1_3 -->
<g id="node1420" class="node">
<title>expert_3_1_fc1_3</title>
<ellipse fill="lightcoral" stroke="black" cx="12910.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12910.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="12910.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12910.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12910.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_3&#45;&gt;expert_3_1_fc1_3 -->
<g id="edge1711" class="edge">
<title>dispatch_3_3&#45;&gt;expert_3_1_fc1_3</title>
<path fill="none" stroke="black" d="M12940.48,-1280.9C12936.99,-1270.58 12933.27,-1259.56 12929.67,-1248.92"/>
<polygon fill="black" stroke="black" points="12932.94,-1247.65 12926.42,-1239.3 12926.31,-1249.89 12932.94,-1247.65"/>
</g>
<!-- expert_3_2_fc1_4 -->
<g id="node1421" class="node">
<title>expert_3_2_fc1_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13356.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13356.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13356.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13356.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13356.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_4&#45;&gt;expert_3_2_fc1_4 -->
<g id="edge1712" class="edge">
<title>dispatch_3_4&#45;&gt;expert_3_2_fc1_4</title>
<path fill="none" stroke="black" d="M13353.48,-1276.66C13353.8,-1267.92 13354.13,-1258.79 13354.46,-1249.91"/>
<polygon fill="black" stroke="black" points="13357.97,-1249.76 13354.84,-1239.64 13350.97,-1249.5 13357.97,-1249.76"/>
</g>
<!-- expert_3_2_fc1_5 -->
<g id="node1422" class="node">
<title>expert_3_2_fc1_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13707.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13707.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="13707.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13707.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13707.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_5&#45;&gt;expert_3_2_fc1_5 -->
<g id="edge1713" class="edge">
<title>dispatch_3_5&#45;&gt;expert_3_2_fc1_5</title>
<path fill="none" stroke="black" d="M13732.07,-1280.14C13729.26,-1270.07 13726.27,-1259.36 13723.38,-1249.02"/>
<polygon fill="black" stroke="black" points="13726.71,-1247.94 13720.65,-1239.25 13719.97,-1249.82 13726.71,-1247.94"/>
</g>
<!-- expert_3_3_fc1_6 -->
<g id="node1423" class="node">
<title>expert_3_3_fc1_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14142.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14142.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14142.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14142.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14142.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_6&#45;&gt;expert_3_3_fc1_6 -->
<g id="edge1714" class="edge">
<title>dispatch_3_6&#45;&gt;expert_3_3_fc1_6</title>
<path fill="none" stroke="black" d="M14140.72,-1276.66C14140.91,-1267.92 14141.11,-1258.79 14141.31,-1249.91"/>
<polygon fill="black" stroke="black" points="14144.81,-1249.71 14141.53,-1239.64 14137.81,-1249.56 14144.81,-1249.71"/>
</g>
<!-- expert_3_3_fc1_7 -->
<g id="node1424" class="node">
<title>expert_3_3_fc1_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14523.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14523.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="14523.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14523.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14523.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_7&#45;&gt;expert_3_3_fc1_7 -->
<g id="edge1715" class="edge">
<title>dispatch_3_7&#45;&gt;expert_3_3_fc1_7</title>
<path fill="none" stroke="black" d="M14529.82,-1277.44C14529.16,-1268.45 14528.47,-1259.04 14527.8,-1249.9"/>
<polygon fill="black" stroke="black" points="14531.27,-1249.43 14527.05,-1239.72 14524.29,-1249.95 14531.27,-1249.43"/>
</g>
<!-- expert_3_4_fc1_8 -->
<g id="node1425" class="node">
<title>expert_3_4_fc1_8</title>
<ellipse fill="lightcoral" stroke="black" cx="14930.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14930.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="14930.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14930.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14930.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_8&#45;&gt;expert_3_4_fc1_8 -->
<g id="edge1716" class="edge">
<title>dispatch_3_8&#45;&gt;expert_3_4_fc1_8</title>
<path fill="none" stroke="black" d="M14928.72,-1276.66C14928.91,-1267.92 14929.11,-1258.79 14929.31,-1249.91"/>
<polygon fill="black" stroke="black" points="14932.81,-1249.71 14929.53,-1239.64 14925.81,-1249.56 14932.81,-1249.71"/>
</g>
<!-- expert_3_4_fc1_9 -->
<g id="node1426" class="node">
<title>expert_3_4_fc1_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15220.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15220.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="15220.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15220.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15220.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_9&#45;&gt;expert_3_4_fc1_9 -->
<g id="edge1717" class="edge">
<title>dispatch_3_9&#45;&gt;expert_3_4_fc1_9</title>
<path fill="none" stroke="black" d="M15289.62,-1285.44C15280.24,-1272.8 15269.86,-1258.83 15260.07,-1245.64"/>
<polygon fill="black" stroke="black" points="15262.84,-1243.49 15254.06,-1237.54 15257.21,-1247.66 15262.84,-1243.49"/>
</g>
<!-- expert_3_5_fc1_10 -->
<g id="node1427" class="node">
<title>expert_3_5_fc1_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15726.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15726.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="15726.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15726.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="15726.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_10&#45;&gt;expert_3_5_fc1_10 -->
<g id="edge1718" class="edge">
<title>dispatch_3_10&#45;&gt;expert_3_5_fc1_10</title>
<path fill="none" stroke="black" d="M15719.7,-1277.44C15720.43,-1268.45 15721.19,-1259.04 15721.93,-1249.9"/>
<polygon fill="black" stroke="black" points="15725.43,-1249.97 15722.75,-1239.72 15718.46,-1249.4 15725.43,-1249.97"/>
</g>
<!-- expert_3_5_fc1_11 -->
<g id="node1428" class="node">
<title>expert_3_5_fc1_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16108.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16108.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="16108.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16108.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16108.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_11&#45;&gt;expert_3_5_fc1_11 -->
<g id="edge1719" class="edge">
<title>dispatch_3_11&#45;&gt;expert_3_5_fc1_11</title>
<path fill="none" stroke="black" d="M16109.19,-1276.28C16109.13,-1267.66 16109.06,-1258.68 16109,-1249.94"/>
<polygon fill="black" stroke="black" points="16112.5,-1249.79 16108.92,-1239.82 16105.5,-1249.85 16112.5,-1249.79"/>
</g>
<!-- expert_3_6_fc1_12 -->
<g id="node1429" class="node">
<title>expert_3_6_fc1_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16566.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16566.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="16566.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16566.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16566.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_12&#45;&gt;expert_3_6_fc1_12 -->
<g id="edge1720" class="edge">
<title>dispatch_3_12&#45;&gt;expert_3_6_fc1_12</title>
<path fill="none" stroke="black" d="M16527.71,-1282.05C16532.41,-1271.22 16537.45,-1259.58 16542.31,-1248.39"/>
<polygon fill="black" stroke="black" points="16545.56,-1249.69 16546.32,-1239.12 16539.14,-1246.9 16545.56,-1249.69"/>
</g>
<!-- expert_3_6_fc1_13 -->
<g id="node1430" class="node">
<title>expert_3_6_fc1_13</title>
<ellipse fill="lightcoral" stroke="black" cx="16938.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16938.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="16938.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16938.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="16938.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_13&#45;&gt;expert_3_6_fc1_13 -->
<g id="edge1721" class="edge">
<title>dispatch_3_13&#45;&gt;expert_3_6_fc1_13</title>
<path fill="none" stroke="black" d="M16933.6,-1277.05C16934.12,-1268.19 16934.66,-1258.93 16935.19,-1249.93"/>
<polygon fill="black" stroke="black" points="16938.69,-1250.09 16935.78,-1239.9 16931.7,-1249.68 16938.69,-1250.09"/>
</g>
<!-- expert_3_7_fc1_14 -->
<g id="node1431" class="node">
<title>expert_3_7_fc1_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17699.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17699.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="17699.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17699.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17699.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_14&#45;&gt;expert_3_7_fc1_14 -->
<g id="edge1722" class="edge">
<title>dispatch_3_14&#45;&gt;expert_3_7_fc1_14</title>
<path fill="none" stroke="black" d="M17479.04,-1295.9C17520.1,-1276.63 17572.38,-1252.1 17615.73,-1231.76"/>
<polygon fill="black" stroke="black" points="17617.27,-1234.9 17624.84,-1227.49 17614.3,-1228.57 17617.27,-1234.9"/>
</g>
<!-- expert_3_7_fc1_15 -->
<g id="node1432" class="node">
<title>expert_3_7_fc1_15</title>
<ellipse fill="lightcoral" stroke="black" cx="17982.57" cy="-1191.42" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17982.57" y="-1210.22" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="17982.57" y="-1195.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17982.57" y="-1180.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17982.57" y="-1165.22" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- dispatch_3_15&#45;&gt;expert_3_7_fc1_15 -->
<g id="edge1723" class="edge">
<title>dispatch_3_15&#45;&gt;expert_3_7_fc1_15</title>
<path fill="none" stroke="black" d="M17887.38,-1287.67C17901.36,-1273.68 17917.19,-1257.84 17931.86,-1243.16"/>
<polygon fill="black" stroke="black" points="17934.36,-1245.61 17938.96,-1236.06 17929.41,-1240.66 17934.36,-1245.61"/>
</g>
<!-- expert_3_0_gelu_0 -->
<g id="node1433" class="node">
<title>expert_3_0_gelu_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11501.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="11501.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="11501.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11501.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_0_fc1_0&#45;&gt;expert_3_0_gelu_0 -->
<g id="edge1724" class="edge">
<title>expert_3_0_fc1_0&#45;&gt;expert_3_0_gelu_0</title>
<path fill="none" stroke="black" d="M11505.22,-1143.1C11504.79,-1134.38 11504.33,-1125.27 11503.9,-1116.56"/>
<polygon fill="black" stroke="black" points="11507.39,-1116.38 11503.4,-1106.57 11500.4,-1116.73 11507.39,-1116.38"/>
</g>
<!-- expert_3_0_gelu_1 -->
<g id="node1436" class="node">
<title>expert_3_0_gelu_1</title>
<ellipse fill="lightcoral" stroke="black" cx="11805.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="11805.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="11805.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11805.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_0_fc1_1&#45;&gt;expert_3_0_gelu_1 -->
<g id="edge1727" class="edge">
<title>expert_3_0_fc1_1&#45;&gt;expert_3_0_gelu_1</title>
<path fill="none" stroke="black" d="M11867.36,-1145.86C11858.76,-1135.27 11849.59,-1123.99 11841.02,-1113.45"/>
<polygon fill="black" stroke="black" points="11843.63,-1111.11 11834.6,-1105.55 11838.2,-1115.52 11843.63,-1111.11"/>
</g>
<!-- expert_3_1_gelu_2 -->
<g id="node1438" class="node">
<title>expert_3_1_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12545.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12545.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="12545.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12545.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_1_fc1_2&#45;&gt;expert_3_1_gelu_2 -->
<g id="edge1730" class="edge">
<title>expert_3_1_fc1_2&#45;&gt;expert_3_1_gelu_2</title>
<path fill="none" stroke="black" d="M12549.22,-1143.1C12548.79,-1134.38 12548.33,-1125.27 12547.9,-1116.56"/>
<polygon fill="black" stroke="black" points="12551.39,-1116.38 12547.4,-1106.57 12544.4,-1116.73 12551.39,-1116.38"/>
</g>
<!-- expert_3_1_gelu_3 -->
<g id="node1441" class="node">
<title>expert_3_1_gelu_3</title>
<ellipse fill="lightcoral" stroke="black" cx="12884.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="12884.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="12884.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12884.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_1_fc1_3&#45;&gt;expert_3_1_gelu_3 -->
<g id="edge1733" class="edge">
<title>expert_3_1_fc1_3&#45;&gt;expert_3_1_gelu_3</title>
<path fill="none" stroke="black" d="M12900.45,-1143.45C12898.52,-1134.51 12896.5,-1125.17 12894.58,-1116.25"/>
<polygon fill="black" stroke="black" points="12897.99,-1115.44 12892.46,-1106.4 12891.15,-1116.92 12897.99,-1115.44"/>
</g>
<!-- expert_3_2_gelu_4 -->
<g id="node1443" class="node">
<title>expert_3_2_gelu_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13376.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13376.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13376.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13376.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_2_fc1_4&#45;&gt;expert_3_2_gelu_4 -->
<g id="edge1736" class="edge">
<title>expert_3_2_fc1_4&#45;&gt;expert_3_2_gelu_4</title>
<path fill="none" stroke="black" d="M13364.42,-1143.1C13365.87,-1134.38 13367.38,-1125.27 13368.82,-1116.56"/>
<polygon fill="black" stroke="black" points="13372.3,-1117.01 13370.48,-1106.57 13365.39,-1115.86 13372.3,-1117.01"/>
</g>
<!-- expert_3_2_gelu_5 -->
<g id="node1446" class="node">
<title>expert_3_2_gelu_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13698.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="13698.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="13698.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13698.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_2_fc1_5&#45;&gt;expert_3_2_gelu_5 -->
<g id="edge1739" class="edge">
<title>expert_3_2_fc1_5&#45;&gt;expert_3_2_gelu_5</title>
<path fill="none" stroke="black" d="M13704.04,-1143.1C13703.39,-1134.38 13702.71,-1125.27 13702.06,-1116.56"/>
<polygon fill="black" stroke="black" points="13705.55,-1116.28 13701.32,-1106.57 13698.57,-1116.8 13705.55,-1116.28"/>
</g>
<!-- expert_3_3_gelu_6 -->
<g id="node1448" class="node">
<title>expert_3_3_gelu_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14163.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14163.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14163.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14163.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_3_fc1_6&#45;&gt;expert_3_3_gelu_6 -->
<g id="edge1742" class="edge">
<title>expert_3_3_fc1_6&#45;&gt;expert_3_3_gelu_6</title>
<path fill="none" stroke="black" d="M14150.75,-1143.45C14152.29,-1134.61 14153.9,-1125.37 14155.44,-1116.53"/>
<polygon fill="black" stroke="black" points="14158.94,-1116.86 14157.2,-1106.4 14152.04,-1115.65 14158.94,-1116.86"/>
</g>
<!-- expert_3_3_gelu_7 -->
<g id="node1451" class="node">
<title>expert_3_3_gelu_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14488.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14488.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="14488.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14488.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_3_fc1_7&#45;&gt;expert_3_3_gelu_7 -->
<g id="edge1745" class="edge">
<title>expert_3_3_fc1_7&#45;&gt;expert_3_3_gelu_7</title>
<path fill="none" stroke="black" d="M14509.94,-1143.45C14507.35,-1134.51 14504.63,-1125.17 14502.05,-1116.25"/>
<polygon fill="black" stroke="black" points="14505.34,-1115.03 14499.19,-1106.4 14498.61,-1116.98 14505.34,-1115.03"/>
</g>
<!-- expert_3_4_gelu_8 -->
<g id="node1453" class="node">
<title>expert_3_4_gelu_8</title>
<ellipse fill="lightcoral" stroke="black" cx="14944.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="14944.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="14944.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14944.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_4_fc1_8&#45;&gt;expert_3_4_gelu_8 -->
<g id="edge1748" class="edge">
<title>expert_3_4_fc1_8&#45;&gt;expert_3_4_gelu_8</title>
<path fill="none" stroke="black" d="M14936.07,-1143.1C14937.08,-1134.38 14938.14,-1125.27 14939.15,-1116.56"/>
<polygon fill="black" stroke="black" points="14942.63,-1116.91 14940.31,-1106.57 14935.68,-1116.1 14942.63,-1116.91"/>
</g>
<!-- expert_3_4_gelu_9 -->
<g id="node1456" class="node">
<title>expert_3_4_gelu_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15218.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15218.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="15218.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15218.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_4_fc1_9&#45;&gt;expert_3_4_gelu_9 -->
<g id="edge1751" class="edge">
<title>expert_3_4_fc1_9&#45;&gt;expert_3_4_gelu_9</title>
<path fill="none" stroke="black" d="M15219.79,-1143.1C15219.65,-1134.47 15219.5,-1125.47 15219.35,-1116.85"/>
<polygon fill="black" stroke="black" points="15222.85,-1116.51 15219.18,-1106.57 15215.85,-1116.63 15222.85,-1116.51"/>
</g>
<!-- expert_3_5_gelu_10 -->
<g id="node1458" class="node">
<title>expert_3_5_gelu_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15749.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="15749.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="15749.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15749.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_5_fc1_10&#45;&gt;expert_3_5_gelu_10 -->
<g id="edge1754" class="edge">
<title>expert_3_5_fc1_10&#45;&gt;expert_3_5_gelu_10</title>
<path fill="none" stroke="black" d="M15735.53,-1143.45C15737.24,-1134.51 15739.02,-1125.17 15740.72,-1116.25"/>
<polygon fill="black" stroke="black" points="15744.16,-1116.88 15742.6,-1106.4 15737.29,-1115.57 15744.16,-1116.88"/>
</g>
<!-- expert_3_5_gelu_11 -->
<g id="node1461" class="node">
<title>expert_3_5_gelu_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16108.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16108.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="16108.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16108.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_5_fc1_11&#45;&gt;expert_3_5_gelu_11 -->
<g id="edge1757" class="edge">
<title>expert_3_5_fc1_11&#45;&gt;expert_3_5_gelu_11</title>
<path fill="none" stroke="black" d="M16108.57,-1143.1C16108.57,-1134.47 16108.57,-1125.47 16108.57,-1116.85"/>
<polygon fill="black" stroke="black" points="16112.07,-1116.57 16108.57,-1106.57 16105.07,-1116.57 16112.07,-1116.57"/>
</g>
<!-- expert_3_6_gelu_12 -->
<g id="node1463" class="node">
<title>expert_3_6_gelu_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16598.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16598.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="16598.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16598.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_6_fc1_12&#45;&gt;expert_3_6_gelu_12 -->
<g id="edge1760" class="edge">
<title>expert_3_6_fc1_12&#45;&gt;expert_3_6_gelu_12</title>
<path fill="none" stroke="black" d="M16579.04,-1143.45C16581.41,-1134.51 16583.89,-1125.17 16586.26,-1116.25"/>
<polygon fill="black" stroke="black" points="16589.69,-1116.97 16588.87,-1106.4 16582.92,-1115.17 16589.69,-1116.97"/>
</g>
<!-- expert_3_6_gelu_13 -->
<g id="node1466" class="node">
<title>expert_3_6_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="16952.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="16952.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="16952.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="16952.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_6_fc1_13&#45;&gt;expert_3_6_gelu_13 -->
<g id="edge1763" class="edge">
<title>expert_3_6_fc1_13&#45;&gt;expert_3_6_gelu_13</title>
<path fill="none" stroke="black" d="M16944.07,-1143.1C16945.08,-1134.38 16946.14,-1125.27 16947.15,-1116.56"/>
<polygon fill="black" stroke="black" points="16950.63,-1116.91 16948.31,-1106.57 16943.68,-1116.1 16950.63,-1116.91"/>
</g>
<!-- expert_3_7_gelu_14 -->
<g id="node1468" class="node">
<title>expert_3_7_gelu_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17870.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="17870.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="17870.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17870.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_7_fc1_14&#45;&gt;expert_3_7_gelu_14 -->
<g id="edge1766" class="edge">
<title>expert_3_7_fc1_14&#45;&gt;expert_3_7_gelu_14</title>
<path fill="none" stroke="black" d="M17756.99,-1149.93C17775.58,-1136.82 17796.17,-1122.3 17814.66,-1109.26"/>
<polygon fill="black" stroke="black" points="17816.83,-1112.01 17822.99,-1103.39 17812.8,-1106.29 17816.83,-1112.01"/>
</g>
<!-- expert_3_7_gelu_15 -->
<g id="node1471" class="node">
<title>expert_3_7_gelu_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18127.57" cy="-1068.83" rx="119" ry="37.5"/>
<text text-anchor="middle" x="18127.57" y="-1080.13" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="18127.57" y="-1065.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18127.57" y="-1050.13" font-family="Times,serif" font-size="14.00">[B_expert, D=16384]</text>
</g>
<!-- expert_3_7_fc1_15&#45;&gt;expert_3_7_gelu_15 -->
<g id="edge1769" class="edge">
<title>expert_3_7_fc1_15&#45;&gt;expert_3_7_gelu_15</title>
<path fill="none" stroke="black" d="M18033.29,-1148.24C18047.9,-1136.09 18063.8,-1122.86 18078.32,-1110.79"/>
<polygon fill="black" stroke="black" points="18080.78,-1113.3 18086.23,-1104.22 18076.3,-1107.92 18080.78,-1113.3"/>
</g>
<!-- expert_3_0_fc2_0 -->
<g id="node1434" class="node">
<title>expert_3_0_fc2_0</title>
<ellipse fill="lightcoral" stroke="black" cx="11500.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11500.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11500.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11500.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11500.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_0_gelu_0&#45;&gt;expert_3_0_fc2_0 -->
<g id="edge1725" class="edge">
<title>expert_3_0_gelu_0&#45;&gt;expert_3_0_fc2_0</title>
<path fill="none" stroke="black" d="M11501.27,-1031.33C11501.2,-1022.87 11501.12,-1013.66 11501.05,-1004.55"/>
<polygon fill="black" stroke="black" points="11504.55,-1004.31 11500.96,-994.34 11497.55,-1004.37 11504.55,-1004.31"/>
</g>
<!-- allreduce_expert_3_0 -->
<g id="node1435" class="node">
<title>allreduce_expert_3_0</title>
<polygon fill="red" stroke="black" points="11500.57,-861.17 11345.57,-808.17 11500.57,-755.17 11655.57,-808.17 11500.57,-861.17"/>
<text text-anchor="middle" x="11500.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 0</text>
<text text-anchor="middle" x="11500.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11500.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 0&#45;1</text>
</g>
<!-- expert_3_0_fc2_0&#45;&gt;allreduce_expert_3_0 -->
<g id="edge1726" class="edge">
<title>expert_3_0_fc2_0&#45;&gt;allreduce_expert_3_0</title>
<path fill="none" stroke="black" d="M11500.57,-898.04C11500.57,-889.45 11500.57,-880.37 11500.57,-871.42"/>
<polygon fill="black" stroke="black" points="11504.07,-871.41 11500.57,-861.41 11497.07,-871.41 11504.07,-871.41"/>
</g>
<!-- combine_experts_3_0 -->
<g id="node1473" class="node">
<title>combine_experts_3_0</title>
<polygon fill="purple" stroke="black" points="10987.57,-718.17 10740.57,-665.17 10987.57,-612.17 11234.57,-665.17 10987.57,-718.17"/>
<text text-anchor="middle" x="10987.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="10987.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10987.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_0&#45;&gt;combine_experts_3_0 -->
<g id="edge1772" class="edge">
<title>allreduce_expert_3_0&#45;&gt;combine_experts_3_0</title>
<path fill="none" stroke="black" d="M11416.15,-783.96C11330.91,-760.53 11198.61,-724.17 11103.55,-698.04"/>
<polygon fill="black" stroke="black" points="11104.46,-694.66 11093.89,-695.39 11102.61,-701.41 11104.46,-694.66"/>
</g>
<!-- combine_experts_3_1 -->
<g id="node1474" class="node">
<title>combine_experts_3_1</title>
<polygon fill="purple" stroke="black" points="11499.57,-718.17 11252.57,-665.17 11499.57,-612.17 11746.57,-665.17 11499.57,-718.17"/>
<text text-anchor="middle" x="11499.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="11499.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11499.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_0&#45;&gt;combine_experts_3_1 -->
<g id="edge1773" class="edge">
<title>allreduce_expert_3_0&#45;&gt;combine_experts_3_1</title>
<path fill="none" stroke="black" d="M11500.2,-755.06C11500.14,-746.49 11500.08,-737.53 11500.02,-728.74"/>
<polygon fill="black" stroke="black" points="11503.52,-728.5 11499.94,-718.53 11496.52,-728.55 11503.52,-728.5"/>
</g>
<!-- expert_3_0_fc2_1 -->
<g id="node1437" class="node">
<title>expert_3_0_fc2_1</title>
<ellipse fill="lightcoral" stroke="black" cx="11750.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="11750.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="11750.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11750.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11750.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_0_gelu_1&#45;&gt;expert_3_0_fc2_1 -->
<g id="edge1728" class="edge">
<title>expert_3_0_gelu_1&#45;&gt;expert_3_0_fc2_1</title>
<path fill="none" stroke="black" d="M11789.07,-1031.65C11784.95,-1022.61 11780.43,-1012.7 11775.98,-1002.96"/>
<polygon fill="black" stroke="black" points="11779.09,-1001.34 11771.76,-993.69 11772.72,-1004.24 11779.09,-1001.34"/>
</g>
<!-- expert_3_0_fc2_1&#45;&gt;allreduce_expert_3_0 -->
<g id="edge1729" class="edge">
<title>expert_3_0_fc2_1&#45;&gt;allreduce_expert_3_0</title>
<path fill="none" stroke="black" d="M11681.93,-907.88C11646.48,-888.59 11603.39,-865.13 11568.1,-845.93"/>
<polygon fill="black" stroke="black" points="11569.77,-842.85 11559.31,-841.14 11566.42,-848.99 11569.77,-842.85"/>
</g>
<!-- expert_3_1_fc2_2 -->
<g id="node1439" class="node">
<title>expert_3_1_fc2_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12542.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12542.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="12542.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12542.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12542.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_1_gelu_2&#45;&gt;expert_3_1_fc2_2 -->
<g id="edge1731" class="edge">
<title>expert_3_1_gelu_2&#45;&gt;expert_3_1_fc2_2</title>
<path fill="none" stroke="black" d="M12544.67,-1031.33C12544.45,-1022.87 12544.23,-1013.66 12544,-1004.55"/>
<polygon fill="black" stroke="black" points="12547.49,-1004.25 12543.75,-994.34 12540.49,-1004.42 12547.49,-1004.25"/>
</g>
<!-- allreduce_expert_3_1 -->
<g id="node1440" class="node">
<title>allreduce_expert_3_1</title>
<polygon fill="red" stroke="black" points="12542.57,-861.17 12387.57,-808.17 12542.57,-755.17 12697.57,-808.17 12542.57,-861.17"/>
<text text-anchor="middle" x="12542.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 1</text>
<text text-anchor="middle" x="12542.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12542.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 2&#45;3</text>
</g>
<!-- expert_3_1_fc2_2&#45;&gt;allreduce_expert_3_1 -->
<g id="edge1732" class="edge">
<title>expert_3_1_fc2_2&#45;&gt;allreduce_expert_3_1</title>
<path fill="none" stroke="black" d="M12542.57,-898.04C12542.57,-889.45 12542.57,-880.37 12542.57,-871.42"/>
<polygon fill="black" stroke="black" points="12546.07,-871.41 12542.57,-861.41 12539.07,-871.41 12546.07,-871.41"/>
</g>
<!-- combine_experts_3_2 -->
<g id="node1475" class="node">
<title>combine_experts_3_2</title>
<polygon fill="purple" stroke="black" points="12011.57,-718.17 11764.57,-665.17 12011.57,-612.17 12258.57,-665.17 12011.57,-718.17"/>
<text text-anchor="middle" x="12011.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12011.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12011.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_1&#45;&gt;combine_experts_3_2 -->
<g id="edge1774" class="edge">
<title>allreduce_expert_3_1&#45;&gt;combine_experts_3_2</title>
<path fill="none" stroke="black" d="M12456.96,-784.43C12368.25,-760.88 12228.94,-723.88 12129.76,-697.55"/>
<polygon fill="black" stroke="black" points="12130.55,-694.14 12119.99,-694.95 12128.75,-700.9 12130.55,-694.14"/>
</g>
<!-- combine_experts_3_3 -->
<g id="node1476" class="node">
<title>combine_experts_3_3</title>
<polygon fill="purple" stroke="black" points="12523.57,-718.17 12276.57,-665.17 12523.57,-612.17 12770.57,-665.17 12523.57,-718.17"/>
<text text-anchor="middle" x="12523.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="12523.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12523.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_1&#45;&gt;combine_experts_3_3 -->
<g id="edge1775" class="edge">
<title>allreduce_expert_3_1&#45;&gt;combine_experts_3_3</title>
<path fill="none" stroke="black" d="M12535.87,-757.46C12534.54,-747.58 12533.13,-737.12 12531.76,-726.92"/>
<polygon fill="black" stroke="black" points="12535.21,-726.3 12530.4,-716.86 12528.27,-727.24 12535.21,-726.3"/>
</g>
<!-- expert_3_1_fc2_3 -->
<g id="node1442" class="node">
<title>expert_3_1_fc2_3</title>
<ellipse fill="lightcoral" stroke="black" cx="12788.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="12788.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="12788.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12788.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="12788.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_1_gelu_3&#45;&gt;expert_3_1_fc2_3 -->
<g id="edge1734" class="edge">
<title>expert_3_1_gelu_3&#45;&gt;expert_3_1_fc2_3</title>
<path fill="none" stroke="black" d="M12856.29,-1032.31C12848.19,-1022.13 12839.18,-1010.82 12830.45,-999.85"/>
<polygon fill="black" stroke="black" points="12833.13,-997.59 12824.16,-991.95 12827.65,-1001.95 12833.13,-997.59"/>
</g>
<!-- expert_3_1_fc2_3&#45;&gt;allreduce_expert_3_1 -->
<g id="edge1735" class="edge">
<title>expert_3_1_fc2_3&#45;&gt;allreduce_expert_3_1</title>
<path fill="none" stroke="black" d="M12720.7,-907.7C12686.24,-888.64 12644.49,-865.55 12610.08,-846.51"/>
<polygon fill="black" stroke="black" points="12611.48,-843.29 12601.04,-841.51 12608.09,-849.41 12611.48,-843.29"/>
</g>
<!-- expert_3_2_fc2_4 -->
<g id="node1444" class="node">
<title>expert_3_2_fc2_4</title>
<ellipse fill="lightcoral" stroke="black" cx="13379.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13379.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13379.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13379.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13379.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_2_gelu_4&#45;&gt;expert_3_2_fc2_4 -->
<g id="edge1737" class="edge">
<title>expert_3_2_gelu_4&#45;&gt;expert_3_2_fc2_4</title>
<path fill="none" stroke="black" d="M13377.48,-1031.33C13377.69,-1022.87 13377.92,-1013.66 13378.15,-1004.55"/>
<polygon fill="black" stroke="black" points="13381.65,-1004.42 13378.4,-994.34 13374.65,-1004.25 13381.65,-1004.42"/>
</g>
<!-- allreduce_expert_3_2 -->
<g id="node1445" class="node">
<title>allreduce_expert_3_2</title>
<polygon fill="red" stroke="black" points="13413.57,-861.17 13258.57,-808.17 13413.57,-755.17 13568.57,-808.17 13413.57,-861.17"/>
<text text-anchor="middle" x="13413.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 2</text>
<text text-anchor="middle" x="13413.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="13413.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 4&#45;5</text>
</g>
<!-- expert_3_2_fc2_4&#45;&gt;allreduce_expert_3_2 -->
<g id="edge1738" class="edge">
<title>expert_3_2_fc2_4&#45;&gt;allreduce_expert_3_2</title>
<path fill="none" stroke="black" d="M13391.27,-898.42C13393.78,-888.4 13396.45,-877.69 13399.05,-867.3"/>
<polygon fill="black" stroke="black" points="13402.48,-868.02 13401.5,-857.47 13395.68,-866.33 13402.48,-868.02"/>
</g>
<!-- combine_experts_3_4 -->
<g id="node1477" class="node">
<title>combine_experts_3_4</title>
<polygon fill="purple" stroke="black" points="13035.57,-718.17 12788.57,-665.17 13035.57,-612.17 13282.57,-665.17 13035.57,-718.17"/>
<text text-anchor="middle" x="13035.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13035.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13035.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_2&#45;&gt;combine_experts_3_4 -->
<g id="edge1776" class="edge">
<title>allreduce_expert_3_2&#45;&gt;combine_experts_3_4</title>
<path fill="none" stroke="black" d="M13340.69,-779.98C13281.8,-758.01 13198.35,-726.89 13133.61,-702.74"/>
<polygon fill="black" stroke="black" points="13134.79,-699.44 13124.2,-699.22 13132.34,-706 13134.79,-699.44"/>
</g>
<!-- combine_experts_3_5 -->
<g id="node1478" class="node">
<title>combine_experts_3_5</title>
<polygon fill="purple" stroke="black" points="13547.57,-718.17 13300.57,-665.17 13547.57,-612.17 13794.57,-665.17 13547.57,-718.17"/>
<text text-anchor="middle" x="13547.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="13547.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13547.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_2&#45;&gt;combine_experts_3_5 -->
<g id="edge1777" class="edge">
<title>allreduce_expert_3_2&#45;&gt;combine_experts_3_5</title>
<path fill="none" stroke="black" d="M13450.9,-767.89C13465.88,-752.13 13483.33,-733.77 13499.25,-717.01"/>
<polygon fill="black" stroke="black" points="13502.1,-719.1 13506.45,-709.44 13497.02,-714.28 13502.1,-719.1"/>
</g>
<!-- expert_3_2_fc2_5 -->
<g id="node1447" class="node">
<title>expert_3_2_fc2_5</title>
<ellipse fill="lightcoral" stroke="black" cx="13697.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="13697.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="13697.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13697.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13697.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_2_gelu_5&#45;&gt;expert_3_2_fc2_5 -->
<g id="edge1740" class="edge">
<title>expert_3_2_gelu_5&#45;&gt;expert_3_2_fc2_5</title>
<path fill="none" stroke="black" d="M13698.27,-1031.33C13698.2,-1022.87 13698.12,-1013.66 13698.05,-1004.55"/>
<polygon fill="black" stroke="black" points="13701.55,-1004.31 13697.96,-994.34 13694.55,-1004.37 13701.55,-1004.31"/>
</g>
<!-- expert_3_2_fc2_5&#45;&gt;allreduce_expert_3_2 -->
<g id="edge1741" class="edge">
<title>expert_3_2_fc2_5&#45;&gt;allreduce_expert_3_2</title>
<path fill="none" stroke="black" d="M13623.7,-909.85C13581.28,-889.53 13528.24,-864.11 13486.07,-843.9"/>
<polygon fill="black" stroke="black" points="13487.5,-840.71 13476.96,-839.54 13484.47,-847.02 13487.5,-840.71"/>
</g>
<!-- expert_3_3_fc2_6 -->
<g id="node1449" class="node">
<title>expert_3_3_fc2_6</title>
<ellipse fill="lightcoral" stroke="black" cx="14202.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14202.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14202.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14202.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14202.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_3_gelu_6&#45;&gt;expert_3_3_fc2_6 -->
<g id="edge1743" class="edge">
<title>expert_3_3_gelu_6&#45;&gt;expert_3_3_fc2_6</title>
<path fill="none" stroke="black" d="M14175.38,-1031.33C14178.21,-1022.58 14181.3,-1013.04 14184.34,-1003.63"/>
<polygon fill="black" stroke="black" points="14187.74,-1004.49 14187.49,-993.9 14181.08,-1002.34 14187.74,-1004.49"/>
</g>
<!-- allreduce_expert_3_3 -->
<g id="node1450" class="node">
<title>allreduce_expert_3_3</title>
<polygon fill="red" stroke="black" points="14372.57,-861.17 14217.57,-808.17 14372.57,-755.17 14527.57,-808.17 14372.57,-861.17"/>
<text text-anchor="middle" x="14372.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 3</text>
<text text-anchor="middle" x="14372.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14372.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 6&#45;7</text>
</g>
<!-- expert_3_3_fc2_6&#45;&gt;allreduce_expert_3_3 -->
<g id="edge1744" class="edge">
<title>expert_3_3_fc2_6&#45;&gt;allreduce_expert_3_3</title>
<path fill="none" stroke="black" d="M14254.97,-903.31C14275.29,-887.04 14298.55,-868.42 14318.99,-852.06"/>
<polygon fill="black" stroke="black" points="14321.34,-854.66 14326.96,-845.68 14316.97,-849.19 14321.34,-854.66"/>
</g>
<!-- combine_experts_3_6 -->
<g id="node1479" class="node">
<title>combine_experts_3_6</title>
<polygon fill="purple" stroke="black" points="14059.57,-718.17 13812.57,-665.17 14059.57,-612.17 14306.57,-665.17 14059.57,-718.17"/>
<text text-anchor="middle" x="14059.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14059.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14059.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_3&#45;&gt;combine_experts_3_6 -->
<g id="edge1778" class="edge">
<title>allreduce_expert_3_3&#45;&gt;combine_experts_3_6</title>
<path fill="none" stroke="black" d="M14306.58,-777.44C14260.23,-756.56 14197.74,-728.41 14147.22,-705.65"/>
<polygon fill="black" stroke="black" points="14148.49,-702.38 14137.93,-701.46 14145.61,-708.76 14148.49,-702.38"/>
</g>
<!-- combine_experts_3_7 -->
<g id="node1480" class="node">
<title>combine_experts_3_7</title>
<polygon fill="purple" stroke="black" points="14571.57,-718.17 14324.57,-665.17 14571.57,-612.17 14818.57,-665.17 14571.57,-718.17"/>
<text text-anchor="middle" x="14571.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="14571.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14571.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_3&#45;&gt;combine_experts_3_7 -->
<g id="edge1779" class="edge">
<title>allreduce_expert_3_3&#45;&gt;combine_experts_3_7</title>
<path fill="none" stroke="black" d="M14422.28,-771.95C14447.84,-753.84 14479.3,-731.54 14506.75,-712.1"/>
<polygon fill="black" stroke="black" points="14508.99,-714.8 14515.13,-706.16 14504.94,-709.09 14508.99,-714.8"/>
</g>
<!-- expert_3_3_fc2_7 -->
<g id="node1452" class="node">
<title>expert_3_3_fc2_7</title>
<ellipse fill="lightcoral" stroke="black" cx="14464.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14464.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="14464.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14464.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14464.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_3_gelu_7&#45;&gt;expert_3_3_fc2_7 -->
<g id="edge1746" class="edge">
<title>expert_3_3_gelu_7&#45;&gt;expert_3_3_fc2_7</title>
<path fill="none" stroke="black" d="M14481.31,-1031.33C14479.61,-1022.77 14477.75,-1013.46 14475.92,-1004.25"/>
<polygon fill="black" stroke="black" points="14479.33,-1003.46 14473.95,-994.34 14472.47,-1004.83 14479.33,-1003.46"/>
</g>
<!-- expert_3_3_fc2_7&#45;&gt;allreduce_expert_3_3 -->
<g id="edge1747" class="edge">
<title>expert_3_3_fc2_7&#45;&gt;allreduce_expert_3_3</title>
<path fill="none" stroke="black" d="M14433.94,-899.94C14425.28,-887.12 14415.79,-873.1 14406.93,-859.98"/>
<polygon fill="black" stroke="black" points="14409.71,-857.85 14401.21,-851.52 14403.91,-861.77 14409.71,-857.85"/>
</g>
<!-- expert_3_4_fc2_8 -->
<g id="node1454" class="node">
<title>expert_3_4_fc2_8</title>
<ellipse fill="lightcoral" stroke="black" cx="14958.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="14958.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="14958.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="14958.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14958.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_4_gelu_8&#45;&gt;expert_3_4_fc2_8 -->
<g id="edge1749" class="edge">
<title>expert_3_4_gelu_8&#45;&gt;expert_3_4_fc2_8</title>
<path fill="none" stroke="black" d="M14948.81,-1031.33C14949.79,-1022.87 14950.86,-1013.66 14951.92,-1004.55"/>
<polygon fill="black" stroke="black" points="14955.43,-1004.68 14953.11,-994.34 14948.48,-1003.87 14955.43,-1004.68"/>
</g>
<!-- allreduce_expert_3_4 -->
<g id="node1455" class="node">
<title>allreduce_expert_3_4</title>
<polygon fill="red" stroke="black" points="15115.57,-861.17 14960.57,-808.17 15115.57,-755.17 15270.57,-808.17 15115.57,-861.17"/>
<text text-anchor="middle" x="15115.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 4</text>
<text text-anchor="middle" x="15115.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="15115.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 8&#45;9</text>
</g>
<!-- expert_3_4_fc2_8&#45;&gt;allreduce_expert_3_4 -->
<g id="edge1750" class="edge">
<title>expert_3_4_fc2_8&#45;&gt;allreduce_expert_3_4</title>
<path fill="none" stroke="black" d="M15007.82,-902.57C15025.92,-886.88 15046.44,-869.09 15064.68,-853.28"/>
<polygon fill="black" stroke="black" points="15067.08,-855.83 15072.34,-846.64 15062.49,-850.55 15067.08,-855.83"/>
</g>
<!-- combine_experts_3_8 -->
<g id="node1481" class="node">
<title>combine_experts_3_8</title>
<polygon fill="purple" stroke="black" points="15083.57,-718.17 14836.57,-665.17 15083.57,-612.17 15330.57,-665.17 15083.57,-718.17"/>
<text text-anchor="middle" x="15083.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15083.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15083.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_4&#45;&gt;combine_experts_3_8 -->
<g id="edge1780" class="edge">
<title>allreduce_expert_3_4&#45;&gt;combine_experts_3_8</title>
<path fill="none" stroke="black" d="M15104.56,-758.64C15102.18,-748.15 15099.64,-736.94 15097.17,-726.07"/>
<polygon fill="black" stroke="black" points="15100.56,-725.2 15094.93,-716.22 15093.73,-726.75 15100.56,-725.2"/>
</g>
<!-- combine_experts_3_9 -->
<g id="node1482" class="node">
<title>combine_experts_3_9</title>
<polygon fill="purple" stroke="black" points="15595.57,-718.17 15348.57,-665.17 15595.57,-612.17 15842.57,-665.17 15595.57,-718.17"/>
<text text-anchor="middle" x="15595.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="15595.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15595.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_4&#45;&gt;combine_experts_3_9 -->
<g id="edge1781" class="edge">
<title>allreduce_expert_3_4&#45;&gt;combine_experts_3_9</title>
<path fill="none" stroke="black" d="M15197.54,-783.09C15276.26,-759.97 15395.8,-724.85 15483.34,-699.13"/>
<polygon fill="black" stroke="black" points="15484.44,-702.46 15493.05,-696.28 15482.47,-695.74 15484.44,-702.46"/>
</g>
<!-- expert_3_4_fc2_9 -->
<g id="node1457" class="node">
<title>expert_3_4_fc2_9</title>
<ellipse fill="lightcoral" stroke="black" cx="15207.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15207.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="15207.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15207.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15207.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_4_gelu_9&#45;&gt;expert_3_4_fc2_9 -->
<g id="edge1752" class="edge">
<title>expert_3_4_gelu_9&#45;&gt;expert_3_4_fc2_9</title>
<path fill="none" stroke="black" d="M15215.24,-1031.33C15214.47,-1022.87 15213.63,-1013.66 15212.8,-1004.55"/>
<polygon fill="black" stroke="black" points="15216.26,-1003.98 15211.87,-994.34 15209.29,-1004.62 15216.26,-1003.98"/>
</g>
<!-- expert_3_4_fc2_9&#45;&gt;allreduce_expert_3_4 -->
<g id="edge1753" class="edge">
<title>expert_3_4_fc2_9&#45;&gt;allreduce_expert_3_4</title>
<path fill="none" stroke="black" d="M15176.94,-899.94C15168.28,-887.12 15158.79,-873.1 15149.93,-859.98"/>
<polygon fill="black" stroke="black" points="15152.71,-857.85 15144.21,-851.52 15146.91,-861.77 15152.71,-857.85"/>
</g>
<!-- expert_3_5_fc2_10 -->
<g id="node1459" class="node">
<title>expert_3_5_fc2_10</title>
<ellipse fill="lightcoral" stroke="black" cx="15790.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="15790.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="15790.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="15790.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15790.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_5_gelu_10&#45;&gt;expert_3_5_fc2_10 -->
<g id="edge1755" class="edge">
<title>expert_3_5_gelu_10&#45;&gt;expert_3_5_fc2_10</title>
<path fill="none" stroke="black" d="M15761.99,-1031.33C15764.96,-1022.58 15768.2,-1013.04 15771.4,-1003.63"/>
<polygon fill="black" stroke="black" points="15774.81,-1004.5 15774.71,-993.9 15768.18,-1002.24 15774.81,-1004.5"/>
</g>
<!-- allreduce_expert_3_5 -->
<g id="node1460" class="node">
<title>allreduce_expert_3_5</title>
<polygon fill="red" stroke="black" points="16107.57,-861.17 15952.57,-808.17 16107.57,-755.17 16262.57,-808.17 16107.57,-861.17"/>
<text text-anchor="middle" x="16107.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 5</text>
<text text-anchor="middle" x="16107.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="16107.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 10&#45;11</text>
</g>
<!-- expert_3_5_fc2_10&#45;&gt;allreduce_expert_3_5 -->
<g id="edge1756" class="edge">
<title>expert_3_5_fc2_10&#45;&gt;allreduce_expert_3_5</title>
<path fill="none" stroke="black" d="M15868.93,-911.61C15918.28,-890.43 15981.69,-863.2 16030.75,-842.15"/>
<polygon fill="black" stroke="black" points="16032.24,-845.32 16040.04,-838.16 16029.47,-838.88 16032.24,-845.32"/>
</g>
<!-- combine_experts_3_10 -->
<g id="node1483" class="node">
<title>combine_experts_3_10</title>
<polygon fill="purple" stroke="black" points="16107.57,-718.17 15860.57,-665.17 16107.57,-612.17 16354.57,-665.17 16107.57,-718.17"/>
<text text-anchor="middle" x="16107.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16107.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="16107.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_5&#45;&gt;combine_experts_3_10 -->
<g id="edge1782" class="edge">
<title>allreduce_expert_3_5&#45;&gt;combine_experts_3_10</title>
<path fill="none" stroke="black" d="M16107.57,-755.06C16107.57,-746.49 16107.57,-737.53 16107.57,-728.74"/>
<polygon fill="black" stroke="black" points="16111.07,-728.53 16107.57,-718.53 16104.07,-728.53 16111.07,-728.53"/>
</g>
<!-- combine_experts_3_11 -->
<g id="node1484" class="node">
<title>combine_experts_3_11</title>
<polygon fill="purple" stroke="black" points="16619.57,-718.17 16372.57,-665.17 16619.57,-612.17 16866.57,-665.17 16619.57,-718.17"/>
<text text-anchor="middle" x="16619.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="16619.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16619.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_5&#45;&gt;combine_experts_3_11 -->
<g id="edge1783" class="edge">
<title>allreduce_expert_3_5&#45;&gt;combine_experts_3_11</title>
<path fill="none" stroke="black" d="M16191.83,-783.96C16276.69,-760.59 16408.26,-724.36 16503.07,-698.25"/>
<polygon fill="black" stroke="black" points="16504.29,-701.55 16513,-695.52 16502.43,-694.8 16504.29,-701.55"/>
</g>
<!-- expert_3_5_fc2_11 -->
<g id="node1462" class="node">
<title>expert_3_5_fc2_11</title>
<ellipse fill="lightcoral" stroke="black" cx="16108.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16108.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="16108.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="16108.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16108.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_5_gelu_11&#45;&gt;expert_3_5_fc2_11 -->
<g id="edge1758" class="edge">
<title>expert_3_5_gelu_11&#45;&gt;expert_3_5_fc2_11</title>
<path fill="none" stroke="black" d="M16108.57,-1031.33C16108.57,-1022.87 16108.57,-1013.66 16108.57,-1004.55"/>
<polygon fill="black" stroke="black" points="16112.07,-1004.34 16108.57,-994.34 16105.07,-1004.34 16112.07,-1004.34"/>
</g>
<!-- expert_3_5_fc2_11&#45;&gt;allreduce_expert_3_5 -->
<g id="edge1759" class="edge">
<title>expert_3_5_fc2_11&#45;&gt;allreduce_expert_3_5</title>
<path fill="none" stroke="black" d="M16108.23,-898.04C16108.16,-889.45 16108.1,-880.37 16108.03,-871.42"/>
<polygon fill="black" stroke="black" points="16111.53,-871.39 16107.96,-861.41 16104.53,-871.44 16111.53,-871.39"/>
</g>
<!-- expert_3_6_fc2_12 -->
<g id="node1464" class="node">
<title>expert_3_6_fc2_12</title>
<ellipse fill="lightcoral" stroke="black" cx="16773.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="16773.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="16773.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="16773.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16773.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_6_gelu_12&#45;&gt;expert_3_6_fc2_12 -->
<g id="edge1761" class="edge">
<title>expert_3_6_gelu_12&#45;&gt;expert_3_6_fc2_12</title>
<path fill="none" stroke="black" d="M16647.32,-1034.24C16665.73,-1021.56 16687,-1006.9 16706.78,-993.28"/>
<polygon fill="black" stroke="black" points="16708.9,-996.06 16715.15,-987.51 16704.93,-990.3 16708.9,-996.06"/>
</g>
<!-- allreduce_expert_3_6 -->
<g id="node1465" class="node">
<title>allreduce_expert_3_6</title>
<polygon fill="red" stroke="black" points="17131.57,-861.17 16976.57,-808.17 17131.57,-755.17 17286.57,-808.17 17131.57,-861.17"/>
<text text-anchor="middle" x="17131.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 6</text>
<text text-anchor="middle" x="17131.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="17131.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 12&#45;13</text>
</g>
<!-- expert_3_6_fc2_12&#45;&gt;allreduce_expert_3_6 -->
<g id="edge1762" class="edge">
<title>expert_3_6_fc2_12&#45;&gt;allreduce_expert_3_6</title>
<path fill="none" stroke="black" d="M16856.61,-913.69C16914.72,-891.6 16991.99,-862.23 17049.82,-840.24"/>
<polygon fill="black" stroke="black" points="17051.18,-843.47 17059.29,-836.64 17048.7,-836.93 17051.18,-843.47"/>
</g>
<!-- combine_experts_3_12 -->
<g id="node1485" class="node">
<title>combine_experts_3_12</title>
<polygon fill="purple" stroke="black" points="17131.57,-718.17 16884.57,-665.17 17131.57,-612.17 17378.57,-665.17 17131.57,-718.17"/>
<text text-anchor="middle" x="17131.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17131.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17131.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_6&#45;&gt;combine_experts_3_12 -->
<g id="edge1784" class="edge">
<title>allreduce_expert_3_6&#45;&gt;combine_experts_3_12</title>
<path fill="none" stroke="black" d="M17131.57,-755.06C17131.57,-746.49 17131.57,-737.53 17131.57,-728.74"/>
<polygon fill="black" stroke="black" points="17135.07,-728.53 17131.57,-718.53 17128.07,-728.53 17135.07,-728.53"/>
</g>
<!-- combine_experts_3_13 -->
<g id="node1486" class="node">
<title>combine_experts_3_13</title>
<polygon fill="purple" stroke="black" points="17643.57,-718.17 17396.57,-665.17 17643.57,-612.17 17890.57,-665.17 17643.57,-718.17"/>
<text text-anchor="middle" x="17643.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="17643.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17643.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_6&#45;&gt;combine_experts_3_13 -->
<g id="edge1785" class="edge">
<title>allreduce_expert_3_6&#45;&gt;combine_experts_3_13</title>
<path fill="none" stroke="black" d="M17215.83,-783.96C17300.69,-760.59 17432.26,-724.36 17527.07,-698.25"/>
<polygon fill="black" stroke="black" points="17528.29,-701.55 17537,-695.52 17526.43,-694.8 17528.29,-701.55"/>
</g>
<!-- expert_3_6_fc2_13 -->
<g id="node1467" class="node">
<title>expert_3_6_fc2_13</title>
<ellipse fill="lightcoral" stroke="black" cx="17129.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17129.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="17129.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="17129.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17129.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_6_gelu_13&#45;&gt;expert_3_6_fc2_13 -->
<g id="edge1764" class="edge">
<title>expert_3_6_gelu_13&#45;&gt;expert_3_6_fc2_13</title>
<path fill="none" stroke="black" d="M17001.41,-1034.56C17020.29,-1021.7 17042.22,-1006.76 17062.54,-992.92"/>
<polygon fill="black" stroke="black" points="17064.54,-995.79 17070.83,-987.27 17060.6,-990.01 17064.54,-995.79"/>
</g>
<!-- expert_3_6_fc2_13&#45;&gt;allreduce_expert_3_6 -->
<g id="edge1765" class="edge">
<title>expert_3_6_fc2_13&#45;&gt;allreduce_expert_3_6</title>
<path fill="none" stroke="black" d="M17130.27,-898.04C17130.4,-889.34 17130.53,-880.13 17130.66,-871.07"/>
<polygon fill="black" stroke="black" points="17134.17,-870.99 17130.81,-860.94 17127.17,-870.89 17134.17,-870.99"/>
</g>
<!-- expert_3_7_fc2_14 -->
<g id="node1469" class="node">
<title>expert_3_7_fc2_14</title>
<ellipse fill="lightcoral" stroke="black" cx="17881.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="17881.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="17881.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="17881.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17881.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_7_gelu_14&#45;&gt;expert_3_7_fc2_14 -->
<g id="edge1767" class="edge">
<title>expert_3_7_gelu_14&#45;&gt;expert_3_7_fc2_14</title>
<path fill="none" stroke="black" d="M17873.9,-1031.33C17874.68,-1022.87 17875.52,-1013.66 17876.35,-1004.55"/>
<polygon fill="black" stroke="black" points="17879.85,-1004.62 17877.28,-994.34 17872.88,-1003.98 17879.85,-1004.62"/>
</g>
<!-- allreduce_expert_3_7 -->
<g id="node1470" class="node">
<title>allreduce_expert_3_7</title>
<polygon fill="red" stroke="black" points="18144.57,-861.17 17989.57,-808.17 18144.57,-755.17 18299.57,-808.17 18144.57,-861.17"/>
<text text-anchor="middle" x="18144.57" y="-819.47" font-family="Times,serif" font-size="14.00">AllReduce Expert 7</text>
<text text-anchor="middle" x="18144.57" y="-804.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="18144.57" y="-789.47" font-family="Times,serif" font-size="14.00">GPUs 14&#45;15</text>
</g>
<!-- expert_3_7_fc2_14&#45;&gt;allreduce_expert_3_7 -->
<g id="edge1768" class="edge">
<title>expert_3_7_fc2_14&#45;&gt;allreduce_expert_3_7</title>
<path fill="none" stroke="black" d="M17952.4,-908.6C17990.43,-888.93 18037.13,-864.76 18074.97,-845.18"/>
<polygon fill="black" stroke="black" points="18076.62,-848.27 18083.89,-840.56 18073.4,-842.05 18076.62,-848.27"/>
</g>
<!-- combine_experts_3_14 -->
<g id="node1487" class="node">
<title>combine_experts_3_14</title>
<polygon fill="purple" stroke="black" points="18155.57,-718.17 17908.57,-665.17 18155.57,-612.17 18402.57,-665.17 18155.57,-718.17"/>
<text text-anchor="middle" x="18155.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18155.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="18155.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_7&#45;&gt;combine_experts_3_14 -->
<g id="edge1786" class="edge">
<title>allreduce_expert_3_7&#45;&gt;combine_experts_3_14</title>
<path fill="none" stroke="black" d="M18148.54,-756.26C18149.27,-746.99 18150.03,-737.23 18150.77,-727.7"/>
<polygon fill="black" stroke="black" points="18154.28,-727.71 18151.57,-717.47 18147.3,-727.17 18154.28,-727.71"/>
</g>
<!-- combine_experts_3_15 -->
<g id="node1488" class="node">
<title>combine_experts_3_15</title>
<polygon fill="purple" stroke="black" points="18667.57,-718.17 18420.57,-665.17 18667.57,-612.17 18914.57,-665.17 18667.57,-718.17"/>
<text text-anchor="middle" x="18667.57" y="-676.47" font-family="Times,serif" font-size="14.00">Combine Experts</text>
<text text-anchor="middle" x="18667.57" y="-661.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18667.57" y="-646.47" font-family="Times,serif" font-size="14.00">Weighted sum of expert outputs</text>
</g>
<!-- allreduce_expert_3_7&#45;&gt;combine_experts_3_15 -->
<g id="edge1787" class="edge">
<title>allreduce_expert_3_7&#45;&gt;combine_experts_3_15</title>
<path fill="none" stroke="black" d="M18229.77,-784.2C18316.8,-760.74 18452.59,-724.12 18549.87,-697.9"/>
<polygon fill="black" stroke="black" points="18551.01,-701.22 18559.75,-695.24 18549.18,-694.46 18551.01,-701.22"/>
</g>
<!-- expert_3_7_fc2_15 -->
<g id="node1472" class="node">
<title>expert_3_7_fc2_15</title>
<ellipse fill="lightcoral" stroke="black" cx="18133.57" cy="-946.25" rx="112.5" ry="48.17"/>
<text text-anchor="middle" x="18133.57" y="-965.05" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="18133.57" y="-950.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="18133.57" y="-935.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18133.57" y="-920.05" font-family="Times,serif" font-size="14.00">[B_expert, D=4096]</text>
</g>
<!-- expert_3_7_gelu_15&#45;&gt;expert_3_7_fc2_15 -->
<g id="edge1770" class="edge">
<title>expert_3_7_gelu_15&#45;&gt;expert_3_7_fc2_15</title>
<path fill="none" stroke="black" d="M18129.39,-1031.33C18129.81,-1022.87 18130.27,-1013.66 18130.72,-1004.55"/>
<polygon fill="black" stroke="black" points="18134.23,-1004.5 18131.23,-994.34 18127.24,-1004.15 18134.23,-1004.5"/>
</g>
<!-- expert_3_7_fc2_15&#45;&gt;allreduce_expert_3_7 -->
<g id="edge1771" class="edge">
<title>expert_3_7_fc2_15&#45;&gt;allreduce_expert_3_7</title>
<path fill="none" stroke="black" d="M18137.39,-898.04C18138.12,-889.02 18138.89,-879.46 18139.65,-870.08"/>
<polygon fill="black" stroke="black" points="18143.15,-870.26 18140.46,-860.01 18136.17,-869.69 18143.15,-870.26"/>
</g>
<!-- allreduce_moe_3 -->
<g id="node1489" class="node">
<title>allreduce_moe_3</title>
<polygon fill="red" stroke="black" points="14705.57,-575.17 14580.57,-522.17 14705.57,-469.17 14830.57,-522.17 14705.57,-575.17"/>
<text text-anchor="middle" x="14705.57" y="-533.47" font-family="Times,serif" font-size="14.00">AllReduce MoE</text>
<text text-anchor="middle" x="14705.57" y="-518.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14705.57" y="-503.47" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- combine_experts_3_0&#45;&gt;allreduce_moe_3 -->
<g id="edge1788" class="edge">
<title>combine_experts_3_0&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M11101.59,-636.58C11145.67,-627.08 11196.71,-617.5 11243.57,-612.17 11562.07,-575.9 11644.13,-601.48 11964.57,-593.17 12973.09,-567 14190.35,-536.18 14579.53,-526.35"/>
<polygon fill="black" stroke="black" points="14579.78,-529.84 14589.69,-526.09 14579.6,-522.85 14579.78,-529.84"/>
</g>
<!-- combine_experts_3_1&#45;&gt;allreduce_moe_3 -->
<g id="edge1789" class="edge">
<title>combine_experts_3_1&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M11613.92,-636.61C11657.93,-627.14 11708.83,-617.58 11755.57,-612.17 12313.37,-547.58 14078.45,-528.35 14574.66,-524.15"/>
<polygon fill="black" stroke="black" points="14574.76,-527.65 14584.73,-524.07 14574.7,-520.65 14574.76,-527.65"/>
</g>
<!-- combine_experts_3_2&#45;&gt;allreduce_moe_3 -->
<g id="edge1790" class="edge">
<title>combine_experts_3_2&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M12126.25,-636.7C12170.2,-627.27 12220.96,-617.71 12267.57,-612.17 12721.12,-558.19 14140.91,-531.99 14576.92,-525.08"/>
<polygon fill="black" stroke="black" points="14577.1,-528.58 14587.04,-524.92 14576.99,-521.58 14577.1,-528.58"/>
</g>
<!-- combine_experts_3_3&#45;&gt;allreduce_moe_3 -->
<g id="edge1791" class="edge">
<title>combine_experts_3_3&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M12638.92,-636.8C12682.72,-627.45 12733.22,-617.91 12779.57,-612.17 13448.12,-529.32 14255.82,-521.73 14570.72,-522.27"/>
<polygon fill="black" stroke="black" points="14570.79,-525.77 14580.8,-522.29 14570.81,-518.77 14570.79,-525.77"/>
</g>
<!-- combine_experts_3_4&#45;&gt;allreduce_moe_3 -->
<g id="edge1792" class="edge">
<title>combine_experts_3_4&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M13151.93,-637.01C13195.51,-627.77 13245.6,-618.25 13291.57,-612.17 13762.67,-549.8 14328.04,-530.88 14577.09,-525.35"/>
<polygon fill="black" stroke="black" points="14577.34,-528.84 14587.26,-525.12 14577.18,-521.84 14577.34,-528.84"/>
</g>
<!-- combine_experts_3_5&#45;&gt;allreduce_moe_3 -->
<g id="edge1793" class="edge">
<title>combine_experts_3_5&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M13665.98,-637.49C13709.12,-628.47 13758.39,-618.97 13803.57,-612.17 14084.1,-569.95 14416.86,-543.05 14589.15,-530.84"/>
<polygon fill="black" stroke="black" points="14589.53,-534.32 14599.26,-530.13 14589.04,-527.34 14589.53,-534.32"/>
</g>
<!-- combine_experts_3_6&#45;&gt;allreduce_moe_3 -->
<g id="edge1794" class="edge">
<title>combine_experts_3_6&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M14179.95,-637.89C14305.74,-610.44 14500.31,-567.97 14614.09,-543.13"/>
<polygon fill="black" stroke="black" points="14615.14,-546.49 14624.17,-540.93 14613.65,-539.65 14615.14,-546.49"/>
</g>
<!-- combine_experts_3_7&#45;&gt;allreduce_moe_3 -->
<g id="edge1795" class="edge">
<title>combine_experts_3_7&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M14612.87,-620.71C14628.74,-604.01 14646.88,-584.92 14662.88,-568.09"/>
<polygon fill="black" stroke="black" points="14665.71,-570.19 14670.07,-560.53 14660.64,-565.37 14665.71,-570.19"/>
</g>
<!-- combine_experts_3_8&#45;&gt;allreduce_moe_3 -->
<g id="edge1796" class="edge">
<title>combine_experts_3_8&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M14994.95,-631.11C14929.81,-606.81 14842.25,-574.15 14780.57,-551.14"/>
<polygon fill="black" stroke="black" points="14781.49,-547.75 14770.89,-547.53 14779.04,-554.31 14781.49,-547.75"/>
</g>
<!-- combine_experts_3_9&#45;&gt;allreduce_moe_3 -->
<g id="edge1797" class="edge">
<title>combine_experts_3_9&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M15474.75,-638.05C15432.14,-629.26 15383.83,-619.76 15339.57,-612.17 15154.39,-580.39 14937.32,-551.77 14811.22,-536"/>
<polygon fill="black" stroke="black" points="14811.54,-532.51 14801.18,-534.74 14810.67,-539.46 14811.54,-532.51"/>
</g>
<!-- combine_experts_3_10&#45;&gt;allreduce_moe_3 -->
<g id="edge1798" class="edge">
<title>combine_experts_3_10&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M15990.53,-637.24C15947.09,-628.08 15897.27,-618.56 15851.57,-612.17 15481.39,-560.4 15039.41,-536.74 14828.87,-527.77"/>
<polygon fill="black" stroke="black" points="14828.85,-524.27 14818.71,-527.34 14828.56,-531.26 14828.85,-524.27"/>
</g>
<!-- combine_experts_3_11&#45;&gt;allreduce_moe_3 -->
<g id="edge1799" class="edge">
<title>combine_experts_3_11&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M16503.88,-636.92C16460.16,-627.61 16409.8,-618.07 16363.57,-612.17 15799.03,-540.07 15119.1,-526.24 14837.55,-523.69"/>
<polygon fill="black" stroke="black" points="14837.33,-520.19 14827.3,-523.6 14837.27,-527.19 14837.33,-520.19"/>
</g>
<!-- combine_experts_3_12&#45;&gt;allreduce_moe_3 -->
<g id="edge1800" class="edge">
<title>combine_experts_3_12&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M17016.56,-636.74C16972.69,-627.35 16922.06,-617.8 16875.57,-612.17 16476.28,-563.74 15235.36,-534.22 14832.96,-525.72"/>
<polygon fill="black" stroke="black" points="14832.81,-522.22 14822.74,-525.51 14832.66,-529.22 14832.81,-522.22"/>
</g>
<!-- combine_experts_3_13&#45;&gt;allreduce_moe_3 -->
<g id="edge1801" class="edge">
<title>combine_experts_3_13&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M17529.22,-636.68C17485.21,-627.23 17434.31,-617.65 17387.57,-612.17 16884.48,-553.14 15300.87,-530.18 14835.43,-524.6"/>
<polygon fill="black" stroke="black" points="14835.36,-521.1 14825.31,-524.48 14835.27,-528.1 14835.36,-521.1"/>
</g>
<!-- combine_experts_3_14&#45;&gt;allreduce_moe_3 -->
<g id="edge1802" class="edge">
<title>combine_experts_3_14&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M18041.55,-636.62C17997.47,-627.13 17946.43,-617.54 17899.57,-612.17 17291.86,-542.51 15360.83,-526.82 14837.49,-523.81"/>
<polygon fill="black" stroke="black" points="14837.27,-520.31 14827.25,-523.75 14837.23,-527.31 14837.27,-520.31"/>
</g>
<!-- combine_experts_3_15&#45;&gt;allreduce_moe_3 -->
<g id="edge1803" class="edge">
<title>combine_experts_3_15&#45;&gt;allreduce_moe_3</title>
<path fill="none" stroke="black" d="M18553.56,-636.6C18509.47,-627.11 18458.43,-617.52 18411.57,-612.17 18102.36,-576.84 18022.7,-601.01 17711.57,-593.17 16595.67,-565.03 15246.65,-535.06 14832.54,-525.95"/>
<polygon fill="black" stroke="black" points="14832.41,-522.44 14822.33,-525.72 14832.25,-529.44 14832.41,-522.44"/>
</g>
<!-- residual2_3 -->
<g id="node1490" class="node">
<title>residual2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14705.57" cy="-394.67" rx="155.5" ry="37.5"/>
<text text-anchor="middle" x="14705.57" y="-405.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14705.57" y="-390.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14705.57" y="-375.97" font-family="Times,serif" font-size="14.00">[B=1024, L=2048, D=8192]</text>
</g>
<!-- allreduce_moe_3&#45;&gt;residual2_3 -->
<g id="edge1804" class="edge">
<title>allreduce_moe_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M14705.57,-469.03C14705.57,-460.32 14705.57,-451.32 14705.57,-442.75"/>
<polygon fill="black" stroke="black" points="14709.07,-442.54 14705.57,-432.54 14702.07,-442.54 14709.07,-442.54"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_0 -->
<g id="edge1805" class="edge">
<title>residual2_3&#45;&gt;final_ln_0</title>
<path fill="none" stroke="black" d="M14550.18,-392.01C14035.2,-386.2 12403.83,-365.22 12169.57,-330.17 12120.65,-322.85 12067.57,-308.76 12023.63,-295.34"/>
<polygon fill="black" stroke="black" points="12024.4,-291.92 12013.82,-292.32 12022.34,-298.61 12024.4,-291.92"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_1 -->
<g id="edge1806" class="edge">
<title>residual2_3&#45;&gt;final_ln_1</title>
<path fill="none" stroke="black" d="M14550.15,-391.87C14084.38,-386.11 12720,-366.33 12522.57,-330.17 12485.05,-323.29 12445,-310.46 12411.02,-297.81"/>
<polygon fill="black" stroke="black" points="12412.2,-294.51 12401.61,-294.25 12409.72,-301.06 12412.2,-294.51"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_2 -->
<g id="edge1807" class="edge">
<title>residual2_3&#45;&gt;final_ln_2</title>
<path fill="none" stroke="black" d="M14550.23,-392.86C14176.11,-390.17 13233.07,-378.63 12921.57,-330.17 12873.08,-322.62 12820.46,-308.59 12776.79,-295.27"/>
<polygon fill="black" stroke="black" points="12777.63,-291.87 12767.05,-292.26 12775.57,-298.56 12777.63,-291.87"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_3 -->
<g id="edge1808" class="edge">
<title>residual2_3&#45;&gt;final_ln_3</title>
<path fill="none" stroke="black" d="M14550.78,-391C14240.73,-384.92 13553.32,-367.6 13320.57,-330.17 13272.32,-322.41 13219.93,-308.43 13176.37,-295.2"/>
<polygon fill="black" stroke="black" points="13177.23,-291.81 13166.64,-292.22 13175.18,-298.5 13177.23,-291.81"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_4 -->
<g id="edge1809" class="edge">
<title>residual2_3&#45;&gt;final_ln_4</title>
<path fill="none" stroke="black" d="M14551.44,-388.96C14307.71,-380.69 13844.41,-361.42 13682.57,-330.17 13643.74,-322.67 13602.07,-309.8 13566.59,-297.3"/>
<polygon fill="black" stroke="black" points="13567.35,-293.85 13556.75,-293.79 13564.99,-300.45 13567.35,-293.85"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_5 -->
<g id="edge1810" class="edge">
<title>residual2_3&#45;&gt;final_ln_5</title>
<path fill="none" stroke="black" d="M14553.84,-386.27C14424.9,-378.12 14235.35,-361.73 14072.57,-330.17 14027.59,-321.44 13978.75,-307.87 13937.54,-295.18"/>
<polygon fill="black" stroke="black" points="13938.37,-291.77 13927.78,-292.15 13936.29,-298.46 13938.37,-291.77"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_6 -->
<g id="edge1811" class="edge">
<title>residual2_3&#45;&gt;final_ln_6</title>
<path fill="none" stroke="black" d="M14588.02,-370.03C14537.68,-359.12 14478.42,-345.25 14425.57,-330.17 14391.24,-320.36 14354.09,-307.96 14321.51,-296.47"/>
<polygon fill="black" stroke="black" points="14322.6,-293.15 14312,-293.1 14320.26,-299.74 14322.6,-293.15"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_7 -->
<g id="edge1812" class="edge">
<title>residual2_3&#45;&gt;final_ln_7</title>
<path fill="none" stroke="black" d="M14672.24,-357.87C14657.31,-341.84 14639.58,-322.8 14623.91,-305.98"/>
<polygon fill="black" stroke="black" points="14626.25,-303.35 14616.87,-298.42 14621.12,-308.12 14626.25,-303.35"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_8 -->
<g id="edge1813" class="edge">
<title>residual2_3&#45;&gt;final_ln_8</title>
<path fill="none" stroke="black" d="M14765.06,-359.93C14796.59,-342.05 14835.46,-320.01 14868.22,-301.43"/>
<polygon fill="black" stroke="black" points="14870.31,-304.27 14877.29,-296.29 14866.86,-298.18 14870.31,-304.27"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_9 -->
<g id="edge1814" class="edge">
<title>residual2_3&#45;&gt;final_ln_9</title>
<path fill="none" stroke="black" d="M14841.55,-376.4C14916.68,-365.63 15011.38,-350.03 15094.57,-330.17 15133.89,-320.78 15176.48,-307.85 15213.17,-295.82"/>
<polygon fill="black" stroke="black" points="15214.46,-299.08 15222.86,-292.62 15212.27,-292.44 15214.46,-299.08"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_10 -->
<g id="edge1815" class="edge">
<title>residual2_3&#45;&gt;final_ln_10</title>
<path fill="none" stroke="black" d="M14860.07,-390.27C15014.54,-384.65 15258.3,-369.74 15465.57,-330.17 15508.61,-321.95 15555.15,-308.6 15594.53,-295.94"/>
<polygon fill="black" stroke="black" points="15595.95,-299.15 15604.38,-292.73 15593.79,-292.5 15595.95,-299.15"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_11 -->
<g id="edge1816" class="edge">
<title>residual2_3&#45;&gt;final_ln_11</title>
<path fill="none" stroke="black" d="M14859.85,-389.54C15126.21,-381.67 15661.56,-362.37 15846.57,-330.17 15891.2,-322.4 15939.45,-308.82 15979.95,-295.86"/>
<polygon fill="black" stroke="black" points="15981.1,-299.17 15989.54,-292.76 15978.95,-292.51 15981.1,-299.17"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_12 -->
<g id="edge1817" class="edge">
<title>residual2_3&#45;&gt;final_ln_12</title>
<path fill="none" stroke="black" d="M14860.76,-392C15194.52,-387.65 15971.42,-373.09 16231.57,-330.17 16277.19,-322.64 16326.53,-308.93 16367.77,-295.83"/>
<polygon fill="black" stroke="black" points="16369.07,-299.09 16377.52,-292.69 16366.93,-292.42 16369.07,-299.09"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_13 -->
<g id="edge1818" class="edge">
<title>residual2_3&#45;&gt;final_ln_13</title>
<path fill="none" stroke="black" d="M14861.33,-393.53C15255.02,-392.37 16282.56,-384.11 16619.57,-330.17 16665.69,-322.78 16715.59,-308.98 16757.16,-295.76"/>
<polygon fill="black" stroke="black" points="16758.27,-299.08 16766.72,-292.69 16756.12,-292.42 16758.27,-299.08"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_14 -->
<g id="edge1819" class="edge">
<title>residual2_3&#45;&gt;final_ln_14</title>
<path fill="none" stroke="black" d="M14860.86,-391.69C15343.58,-385.24 16798.17,-363.24 17008.57,-330.17 17054.71,-322.91 17104.61,-309.12 17146.18,-295.89"/>
<polygon fill="black" stroke="black" points="17147.29,-299.21 17155.73,-292.81 17145.14,-292.54 17147.29,-299.21"/>
</g>
<!-- residual2_3&#45;&gt;final_ln_15 -->
<g id="edge1820" class="edge">
<title>residual2_3&#45;&gt;final_ln_15</title>
<path fill="none" stroke="black" d="M14861.13,-392.35C15397.07,-387.49 17147.66,-368.8 17397.57,-330.17 17444.11,-322.97 17494.44,-309.11 17536.3,-295.81"/>
<polygon fill="black" stroke="black" points="17537.47,-299.11 17545.92,-292.71 17535.32,-292.44 17537.47,-299.11"/>
</g>
</g>
</svg>
