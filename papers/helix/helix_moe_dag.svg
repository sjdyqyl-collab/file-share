<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="192pt"
 viewBox="0.00 0.00 1440.00 191.56" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 2751)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2751 20705.5,-2751 20705.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M20,-1928C20,-1928 5123,-1928 5123,-1928 5129,-1928 5135,-1934 5135,-1940 5135,-1940 5135,-2655 5135,-2655 5135,-2661 5129,-2667 5123,-2667 5123,-2667 20,-2667 20,-2667 14,-2667 8,-2661 8,-2655 8,-2655 8,-1940 8,-1940 8,-1934 14,-1928 20,-1928"/>
<text text-anchor="middle" x="2571.5" y="-2651.8" font-family="Times,serif" font-size="14.00">Layer 1 (MoE)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M5155,-1281C5155,-1281 10258,-1281 10258,-1281 10264,-1281 10270,-1287 10270,-1293 10270,-1293 10270,-2008 10270,-2008 10270,-2014 10264,-2020 10258,-2020 10258,-2020 5155,-2020 5155,-2020 5149,-2020 5143,-2014 5143,-2008 5143,-2008 5143,-1293 5143,-1293 5143,-1287 5149,-1281 5155,-1281"/>
<text text-anchor="middle" x="7706.5" y="-2004.8" font-family="Times,serif" font-size="14.00">Layer 2 (MoE)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M10290,-634C10290,-634 15393,-634 15393,-634 15399,-634 15405,-640 15405,-646 15405,-646 15405,-1361 15405,-1361 15405,-1367 15399,-1373 15393,-1373 15393,-1373 10290,-1373 10290,-1373 10284,-1373 10278,-1367 10278,-1361 10278,-1361 10278,-646 10278,-646 10278,-640 10284,-634 10290,-634"/>
<text text-anchor="middle" x="12841.5" y="-1357.8" font-family="Times,serif" font-size="14.00">Layer 3 (MoE)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M15425,-8C15425,-8 20528,-8 20528,-8 20534,-8 20540,-14 20540,-20 20540,-20 20540,-714 20540,-714 20540,-720 20534,-726 20528,-726 20528,-726 15425,-726 15425,-726 15419,-726 15413,-720 15413,-714 15413,-714 15413,-20 15413,-20 15413,-14 15419,-8 15425,-8"/>
<text text-anchor="middle" x="17976.5" y="-710.8" font-family="Times,serif" font-size="14.00">Layer 4 (MoE)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="white" stroke="black" points="4627,-2747 4421,-2747 4421,-2694 4627,-2694 4627,-2747"/>
<text text-anchor="middle" x="4524" y="-2731.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4524" y="-2716.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 1024, 8192]</text>
<text text-anchor="middle" x="4524" y="-2701.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln1_0 -->
<g id="node33" class="node">
<title>ln1_0</title>
<polygon fill="white" stroke="black" points="4227.5,-2636 4074.5,-2636 4074.5,-2583 4227.5,-2583 4227.5,-2636"/>
<text text-anchor="middle" x="4151" y="-2620.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4151" y="-2605.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4151" y="-2590.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1_0 -->
<g id="edge145" class="edge">
<title>input&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M4436.55,-2693.94C4376.58,-2676.42 4297.37,-2653.27 4237.58,-2635.8"/>
<polygon fill="black" stroke="black" points="4238.37,-2632.38 4227.79,-2632.94 4236.4,-2639.1 4238.37,-2632.38"/>
</g>
<!-- residual1_0 -->
<g id="node82" class="node">
<title>residual1_0</title>
<polygon fill="orange" stroke="black" points="4600.5,-2636 4447.5,-2636 4447.5,-2583 4600.5,-2583 4600.5,-2636"/>
<text text-anchor="middle" x="4524" y="-2620.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4524" y="-2605.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4524" y="-2590.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;residual1_0 -->
<g id="edge214" class="edge">
<title>input&#45;&gt;residual1_0</title>
<path fill="none" stroke="black" d="M4524,-2693.94C4524,-2679.83 4524,-2662.08 4524,-2646.57"/>
<polygon fill="black" stroke="black" points="4527.5,-2646.27 4524,-2636.27 4520.5,-2646.27 4527.5,-2646.27"/>
</g>
<!-- residual2_0 -->
<g id="node84" class="node">
<title>residual2_0</title>
<polygon fill="orange" stroke="black" points="5126.5,-2114 4973.5,-2114 4973.5,-2061 5126.5,-2061 5126.5,-2114"/>
<text text-anchor="middle" x="5050" y="-2098.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5050" y="-2083.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="5050" y="-2068.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;residual2_0 -->
<g id="edge217" class="edge">
<title>input&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M4627.14,-2712.11C4806.05,-2697.91 5155,-2663.41 5155,-2610.5 5155,-2610.5 5155,-2610.5 5155,-2190.5 5155,-2160.83 5133.17,-2137.01 5109.41,-2119.88"/>
<polygon fill="black" stroke="black" points="5111.19,-2116.85 5100.96,-2114.09 5107.24,-2122.63 5111.19,-2116.85"/>
</g>
<!-- proj_0_0_0 -->
<g id="node2" class="node">
<title>proj_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="3771,-2218 3627,-2218 3627,-2165 3771,-2165 3771,-2218"/>
<text text-anchor="middle" x="3699" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3699" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3699" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_0_0 -->
<g id="node3" class="node">
<title>concat_dim_0_0</title>
<polygon fill="lightsteelblue" stroke="black" points="3377.5,-2114 3224.5,-2114 3224.5,-2061 3377.5,-2061 3377.5,-2114"/>
<text text-anchor="middle" x="3301" y="-2098.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3301" y="-2083.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="3301" y="-2068.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_0_0_0&#45;&gt;concat_dim_0_0 -->
<g id="edge1" class="edge">
<title>proj_0_0_0&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3646.66,-2164.87C3621.3,-2153.35 3590.11,-2140.48 3561,-2132 3504.36,-2115.51 3438.83,-2104.59 3387.74,-2097.82"/>
<polygon fill="black" stroke="black" points="3388.08,-2094.34 3377.72,-2096.52 3387.18,-2101.28 3388.08,-2094.34"/>
<text text-anchor="middle" x="3661" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_0 -->
<g id="node22" class="node">
<title>concat_heads_0</title>
<polygon fill="lightsteelblue" stroke="black" points="1991,-1989 1827,-1989 1827,-1936 1991,-1936 1991,-1989"/>
<text text-anchor="middle" x="1909" y="-1973.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="1909" y="-1958.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="1909" y="-1943.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_0 -->
<g id="edge17" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3224.18,-2079.71C2985.84,-2058.65 2259.54,-1994.47 2001.32,-1971.66"/>
<polygon fill="black" stroke="black" points="2001.49,-1968.16 1991.22,-1970.77 2000.88,-1975.13 2001.49,-1968.16"/>
<text text-anchor="middle" x="2814.5" y="-2031.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_0_0_1 -->
<g id="node4" class="node">
<title>proj_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3560,-2218 3416,-2218 3416,-2165 3560,-2165 3560,-2218"/>
<text text-anchor="middle" x="3488" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3488" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3488" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_0_0_1&#45;&gt;concat_dim_0_0 -->
<g id="edge2" class="edge">
<title>proj_0_0_1&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3463.02,-2164.72C3451.11,-2153.52 3436.16,-2140.94 3421,-2132 3410.38,-2125.74 3398.71,-2120.14 3386.95,-2115.22"/>
<polygon fill="black" stroke="black" points="3388.1,-2111.91 3377.51,-2111.42 3385.48,-2118.4 3388.1,-2111.91"/>
<text text-anchor="middle" x="3499" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_0_0_2 -->
<g id="node5" class="node">
<title>proj_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3373,-2218 3229,-2218 3229,-2165 3373,-2165 3373,-2218"/>
<text text-anchor="middle" x="3301" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3301" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3301" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_0_0_2&#45;&gt;concat_dim_0_0 -->
<g id="edge3" class="edge">
<title>proj_0_0_2&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3301,-2164.76C3301,-2152.56 3301,-2137.78 3301,-2124.49"/>
<polygon fill="black" stroke="black" points="3304.5,-2124.23 3301,-2114.23 3297.5,-2124.23 3304.5,-2124.23"/>
<text text-anchor="middle" x="3359" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_0_0_3 -->
<g id="node6" class="node">
<title>proj_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3170,-2218 3026,-2218 3026,-2165 3170,-2165 3170,-2218"/>
<text text-anchor="middle" x="3098" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3098" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="3098" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_0_0_3&#45;&gt;concat_dim_0_0 -->
<g id="edge4" class="edge">
<title>proj_0_0_3&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3130.23,-2164.76C3145.1,-2153.69 3163.34,-2141.21 3181,-2132 3191.77,-2126.38 3203.44,-2121.17 3215.12,-2116.45"/>
<polygon fill="black" stroke="black" points="3216.44,-2119.69 3224.47,-2112.78 3213.88,-2113.18 3216.44,-2119.69"/>
<text text-anchor="middle" x="3239" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_0_1_0 -->
<g id="node7" class="node">
<title>proj_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="2795,-2218 2651,-2218 2651,-2165 2795,-2165 2795,-2218"/>
<text text-anchor="middle" x="2723" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2723" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2723" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_0_1 -->
<g id="node8" class="node">
<title>concat_dim_0_1</title>
<polygon fill="lightsteelblue" stroke="black" points="2401.5,-2114 2248.5,-2114 2248.5,-2061 2401.5,-2061 2401.5,-2114"/>
<text text-anchor="middle" x="2325" y="-2098.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="2325" y="-2083.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="2325" y="-2068.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_0_1_0&#45;&gt;concat_dim_0_1 -->
<g id="edge5" class="edge">
<title>proj_0_1_0&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2670.66,-2164.87C2645.3,-2153.35 2614.11,-2140.48 2585,-2132 2528.36,-2115.51 2462.83,-2104.59 2411.74,-2097.82"/>
<polygon fill="black" stroke="black" points="2412.08,-2094.34 2401.72,-2096.52 2411.18,-2101.28 2412.08,-2094.34"/>
<text text-anchor="middle" x="2685" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_0 -->
<g id="edge18" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2248.21,-2063.8C2178.34,-2043.14 2075.07,-2012.6 2000.85,-1990.66"/>
<polygon fill="black" stroke="black" points="2001.61,-1987.23 1991.03,-1987.75 1999.63,-1993.95 2001.61,-1987.23"/>
<text text-anchor="middle" x="2210.5" y="-2031.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_0_1_1 -->
<g id="node9" class="node">
<title>proj_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2584,-2218 2440,-2218 2440,-2165 2584,-2165 2584,-2218"/>
<text text-anchor="middle" x="2512" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2512" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2512" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_0_1_1&#45;&gt;concat_dim_0_1 -->
<g id="edge6" class="edge">
<title>proj_0_1_1&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2487.02,-2164.72C2475.11,-2153.52 2460.16,-2140.94 2445,-2132 2434.38,-2125.74 2422.71,-2120.14 2410.95,-2115.22"/>
<polygon fill="black" stroke="black" points="2412.1,-2111.91 2401.51,-2111.42 2409.48,-2118.4 2412.1,-2111.91"/>
<text text-anchor="middle" x="2523" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_0_1_2 -->
<g id="node10" class="node">
<title>proj_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2397,-2218 2253,-2218 2253,-2165 2397,-2165 2397,-2218"/>
<text text-anchor="middle" x="2325" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2325" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2325" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_0_1_2&#45;&gt;concat_dim_0_1 -->
<g id="edge7" class="edge">
<title>proj_0_1_2&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2325,-2164.76C2325,-2152.56 2325,-2137.78 2325,-2124.49"/>
<polygon fill="black" stroke="black" points="2328.5,-2124.23 2325,-2114.23 2321.5,-2124.23 2328.5,-2124.23"/>
<text text-anchor="middle" x="2383" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_0_1_3 -->
<g id="node11" class="node">
<title>proj_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2194,-2218 2050,-2218 2050,-2165 2194,-2165 2194,-2218"/>
<text text-anchor="middle" x="2122" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2122" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="2122" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_0_1_3&#45;&gt;concat_dim_0_1 -->
<g id="edge8" class="edge">
<title>proj_0_1_3&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2154.23,-2164.76C2169.1,-2153.69 2187.34,-2141.21 2205,-2132 2215.77,-2126.38 2227.44,-2121.17 2239.12,-2116.45"/>
<polygon fill="black" stroke="black" points="2240.44,-2119.69 2248.47,-2112.78 2237.88,-2113.18 2240.44,-2119.69"/>
<text text-anchor="middle" x="2263" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_0_2_0 -->
<g id="node12" class="node">
<title>proj_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="1852,-2218 1708,-2218 1708,-2165 1852,-2165 1852,-2218"/>
<text text-anchor="middle" x="1780" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1780" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1780" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_0_2 -->
<g id="node13" class="node">
<title>concat_dim_0_2</title>
<polygon fill="lightsteelblue" stroke="black" points="1669.5,-2114 1516.5,-2114 1516.5,-2061 1669.5,-2061 1669.5,-2114"/>
<text text-anchor="middle" x="1593" y="-2098.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="1593" y="-2083.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="1593" y="-2068.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_0_2_0&#45;&gt;concat_dim_0_2 -->
<g id="edge9" class="edge">
<title>proj_0_2_0&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1755.02,-2164.72C1743.11,-2153.52 1728.16,-2140.94 1713,-2132 1702.38,-2125.74 1690.71,-2120.14 1678.95,-2115.22"/>
<polygon fill="black" stroke="black" points="1680.1,-2111.91 1669.51,-2111.42 1677.48,-2118.4 1680.1,-2111.91"/>
<text text-anchor="middle" x="1791" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_0 -->
<g id="edge19" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1658.86,-2060.86C1709.88,-2041.01 1780.6,-2013.48 1833.83,-1992.76"/>
<polygon fill="black" stroke="black" points="1835.18,-1995.99 1843.23,-1989.1 1832.64,-1989.47 1835.18,-1995.99"/>
<text text-anchor="middle" x="1785.5" y="-2031.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_0_2_1 -->
<g id="node14" class="node">
<title>proj_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="1665,-2218 1521,-2218 1521,-2165 1665,-2165 1665,-2218"/>
<text text-anchor="middle" x="1593" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1593" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1593" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_0_2_1&#45;&gt;concat_dim_0_2 -->
<g id="edge10" class="edge">
<title>proj_0_2_1&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1593,-2164.76C1593,-2152.56 1593,-2137.78 1593,-2124.49"/>
<polygon fill="black" stroke="black" points="1596.5,-2124.23 1593,-2114.23 1589.5,-2124.23 1596.5,-2124.23"/>
<text text-anchor="middle" x="1651" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_0_2_2 -->
<g id="node15" class="node">
<title>proj_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="1462,-2218 1318,-2218 1318,-2165 1462,-2165 1462,-2218"/>
<text text-anchor="middle" x="1390" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1390" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1390" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_0_2_2&#45;&gt;concat_dim_0_2 -->
<g id="edge11" class="edge">
<title>proj_0_2_2&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1417.55,-2164.98C1430.83,-2153.7 1447.45,-2140.98 1464,-2132 1477.38,-2124.74 1492.19,-2118.38 1506.86,-2112.93"/>
<polygon fill="black" stroke="black" points="1508.24,-2116.15 1516.47,-2109.48 1505.88,-2109.57 1508.24,-2116.15"/>
<text text-anchor="middle" x="1526.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_0_2_3 -->
<g id="node16" class="node">
<title>proj_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1273,-2218 1129,-2218 1129,-2165 1273,-2165 1273,-2218"/>
<text text-anchor="middle" x="1201" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1201" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="1201" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_0_2_3&#45;&gt;concat_dim_0_2 -->
<g id="edge12" class="edge">
<title>proj_0_2_3&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1242.11,-2164.88C1262.69,-2153.15 1288.41,-2140.09 1313,-2132 1375.8,-2111.35 1449.83,-2100.39 1505.99,-2094.64"/>
<polygon fill="black" stroke="black" points="1506.65,-2098.09 1516.26,-2093.63 1505.96,-2091.13 1506.65,-2098.09"/>
<text text-anchor="middle" x="1375.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_0_3_0 -->
<g id="node17" class="node">
<title>proj_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="892,-2218 748,-2218 748,-2165 892,-2165 892,-2218"/>
<text text-anchor="middle" x="820" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="820" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="820" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_0_3 -->
<g id="node18" class="node">
<title>concat_dim_0_3</title>
<polygon fill="lightsteelblue" stroke="black" points="693.5,-2114 540.5,-2114 540.5,-2061 693.5,-2061 693.5,-2114"/>
<text text-anchor="middle" x="617" y="-2098.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="617" y="-2083.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="617" y="-2068.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_0_3_0&#45;&gt;concat_dim_0_3 -->
<g id="edge13" class="edge">
<title>proj_0_3_0&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M792.45,-2164.98C779.17,-2153.7 762.55,-2140.98 746,-2132 732.62,-2124.74 717.81,-2118.38 703.14,-2112.93"/>
<polygon fill="black" stroke="black" points="704.12,-2109.57 693.53,-2109.48 701.76,-2116.15 704.12,-2109.57"/>
<text text-anchor="middle" x="829.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_0 -->
<g id="edge20" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M693.95,-2079.17C918.62,-2057.79 1573.08,-1995.48 1816.44,-1972.31"/>
<polygon fill="black" stroke="black" points="1817.05,-1975.77 1826.67,-1971.34 1816.38,-1968.8 1817.05,-1975.77"/>
<text text-anchor="middle" x="1268.5" y="-2031.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_0_3_1 -->
<g id="node19" class="node">
<title>proj_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="689,-2218 545,-2218 545,-2165 689,-2165 689,-2218"/>
<text text-anchor="middle" x="617" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="617" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="617" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_0_3_1&#45;&gt;concat_dim_0_3 -->
<g id="edge14" class="edge">
<title>proj_0_3_1&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M617,-2164.76C617,-2152.56 617,-2137.78 617,-2124.49"/>
<polygon fill="black" stroke="black" points="620.5,-2124.23 617,-2114.23 613.5,-2124.23 620.5,-2124.23"/>
<text text-anchor="middle" x="679.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_0_3_2 -->
<g id="node20" class="node">
<title>proj_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="507,-2218 363,-2218 363,-2165 507,-2165 507,-2218"/>
<text text-anchor="middle" x="435" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="435" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="435" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_0_3_2&#45;&gt;concat_dim_0_3 -->
<g id="edge15" class="edge">
<title>proj_0_3_2&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M453.28,-2164.96C462.57,-2153.54 474.7,-2140.71 488,-2132 500.97,-2123.5 515.77,-2116.5 530.61,-2110.79"/>
<polygon fill="black" stroke="black" points="532.16,-2113.95 540.35,-2107.22 529.75,-2107.38 532.16,-2113.95"/>
<text text-anchor="middle" x="550.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_0_3_3 -->
<g id="node21" class="node">
<title>proj_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="304,-2218 160,-2218 160,-2165 304,-2165 304,-2218"/>
<text text-anchor="middle" x="232" y="-2202.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="232" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="232" y="-2172.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_0_3_3&#45;&gt;concat_dim_0_3 -->
<g id="edge16" class="edge">
<title>proj_0_3_3&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M271.54,-2164.86C291.36,-2153.12 316.16,-2140.06 340,-2132 401.75,-2111.12 474.7,-2100.18 530.23,-2094.5"/>
<polygon fill="black" stroke="black" points="530.78,-2097.96 540.39,-2093.49 530.09,-2090.99 530.78,-2097.96"/>
<text text-anchor="middle" x="402.5" y="-2135.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- gate_0 -->
<g id="node23" class="node">
<title>gate_0</title>
<polygon fill="gold" stroke="black" points="4578,-2456 4470,-2456 4470,-2403 4578,-2403 4578,-2456"/>
<text text-anchor="middle" x="4524" y="-2440.8" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="4524" y="-2425.8" font-family="Times,serif" font-size="14.00">[1048576, 8]</text>
<text text-anchor="middle" x="4524" y="-2410.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_0_0 -->
<g id="node24" class="node">
<title>expert_0_0</title>
<polygon fill="lightblue" stroke="black" points="4055.5,-2337 3920.5,-2337 3920.5,-2269 4055.5,-2269 4055.5,-2337"/>
<text text-anchor="middle" x="3988" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3988" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="3988" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="3988" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_0&#45;&gt;expert_0_0 -->
<g id="edge21" class="edge">
<title>gate_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4469.83,-2426.3C4351.19,-2421.12 4076.08,-2406.86 4040,-2385 4025.09,-2375.96 4013.69,-2360.84 4005.43,-2346.08"/>
<polygon fill="red" stroke="red" points="4008.41,-2344.25 4000.68,-2337.01 4002.21,-2347.49 4008.41,-2344.25"/>
<text text-anchor="middle" x="4071.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4071.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<!-- gate_0&#45;&gt;expert_0_0 -->
<g id="edge197" class="edge">
<title>gate_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4469.99,-2428.88C4396.76,-2427.9 4262.76,-2420.75 4155,-2385 4129.68,-2376.6 4126.78,-2367.09 4103,-2355 4095.19,-2351.03 4080.97,-2344.54 4065.14,-2337.49"/>
<polygon fill="black" stroke="black" points="4066.22,-2334.14 4055.66,-2333.3 4063.39,-2340.55 4066.22,-2334.14"/>
</g>
<!-- expert_0_1 -->
<g id="node25" class="node">
<title>expert_0_1</title>
<polygon fill="lightgreen" stroke="black" points="4208.5,-2337 4073.5,-2337 4073.5,-2269 4208.5,-2269 4208.5,-2337"/>
<text text-anchor="middle" x="4141" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4141" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4141" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4141" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_0&#45;&gt;expert_0_1 -->
<g id="edge22" class="edge">
<title>gate_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4469.67,-2427.44C4385.89,-2424.85 4230.1,-2415.88 4185,-2385 4171.46,-2375.73 4161.71,-2360.89 4154.88,-2346.43"/>
<polygon fill="red" stroke="red" points="4158,-2344.82 4150.81,-2337.05 4151.58,-2347.61 4158,-2344.82"/>
<text text-anchor="middle" x="4216.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4216.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<!-- gate_0&#45;&gt;expert_0_1 -->
<g id="edge199" class="edge">
<title>gate_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4469.57,-2423.43C4422.86,-2417.81 4354.35,-2406.55 4298,-2385 4273.79,-2375.74 4270.83,-2367.26 4248,-2355 4238.25,-2349.77 4227.88,-2344.49 4217.58,-2339.4"/>
<polygon fill="black" stroke="black" points="4219.08,-2336.24 4208.56,-2335 4216.01,-2342.53 4219.08,-2336.24"/>
</g>
<!-- expert_0_2 -->
<g id="node26" class="node">
<title>expert_0_2</title>
<polygon fill="lightyellow" stroke="black" points="4361.5,-2337 4226.5,-2337 4226.5,-2269 4361.5,-2269 4361.5,-2337"/>
<text text-anchor="middle" x="4294" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4294" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4294" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4294" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_0&#45;&gt;expert_0_2 -->
<g id="edge23" class="edge">
<title>gate_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4469.81,-2422.97C4417.34,-2416.57 4342.62,-2404.35 4321,-2385 4310.07,-2375.22 4303.55,-2360.89 4299.67,-2346.99"/>
<polygon fill="red" stroke="red" points="4303.02,-2345.94 4297.29,-2337.03 4296.21,-2347.57 4303.02,-2345.94"/>
<text text-anchor="middle" x="4352.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4352.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<!-- gate_0&#45;&gt;expert_0_2 -->
<g id="edge201" class="edge">
<title>gate_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4469.96,-2404.24C4457.36,-2398.23 4444.09,-2391.61 4432,-2385 4409.92,-2372.94 4405.62,-2367.87 4384,-2355 4376.9,-2350.77 4369.45,-2346.42 4362,-2342.12"/>
<polygon fill="black" stroke="black" points="4363.69,-2339.05 4353.27,-2337.11 4360.2,-2345.12 4363.69,-2339.05"/>
</g>
<!-- expert_0_3 -->
<g id="node27" class="node">
<title>expert_0_3</title>
<polygon fill="lightcoral" stroke="black" points="4514.5,-2337 4379.5,-2337 4379.5,-2269 4514.5,-2269 4514.5,-2337"/>
<text text-anchor="middle" x="4447" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4447" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4447" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4447" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_0&#45;&gt;expert_0_3 -->
<g id="edge24" class="edge">
<title>gate_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4469.66,-2409.3C4459.43,-2403.15 4450.06,-2395.19 4444,-2385 4437.36,-2373.83 4435.9,-2360.19 4436.75,-2347.3"/>
<polygon fill="red" stroke="red" points="4440.24,-2347.52 4437.87,-2337.19 4433.29,-2346.75 4440.24,-2347.52"/>
<text text-anchor="middle" x="4475.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4475.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<!-- gate_0&#45;&gt;expert_0_3 -->
<g id="edge203" class="edge">
<title>gate_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4522.09,-2402.84C4520.03,-2387.98 4515.78,-2369.43 4507,-2355 4504.8,-2351.39 4502.26,-2347.9 4499.48,-2344.57"/>
<polygon fill="black" stroke="black" points="4501.97,-2342.1 4492.65,-2337.07 4496.8,-2346.82 4501.97,-2342.1"/>
</g>
<!-- expert_0_4 -->
<g id="node28" class="node">
<title>expert_0_4</title>
<polygon fill="lightpink" stroke="black" points="4667.5,-2337 4532.5,-2337 4532.5,-2269 4667.5,-2269 4667.5,-2337"/>
<text text-anchor="middle" x="4600" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4600" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4600" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4600" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_0&#45;&gt;expert_0_4 -->
<g id="edge25" class="edge">
<title>gate_0&#45;&gt;expert_0_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4524.16,-2402.81C4525.28,-2387.95 4528.51,-2369.4 4537,-2355 4539.13,-2351.39 4541.62,-2347.92 4544.35,-2344.62"/>
<polygon fill="red" stroke="red" points="4546.95,-2346.97 4551.13,-2337.23 4541.79,-2342.24 4546.95,-2346.97"/>
<text text-anchor="middle" x="4568.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4568.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<!-- gate_0&#45;&gt;expert_0_4 -->
<g id="edge205" class="edge">
<title>gate_0&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4578.37,-2407.05C4587.02,-2401.2 4594.81,-2393.94 4600,-2385 4606.51,-2373.77 4608.33,-2360.1 4607.99,-2347.22"/>
<polygon fill="black" stroke="black" points="4611.47,-2346.86 4607.3,-2337.12 4604.49,-2347.33 4611.47,-2346.86"/>
</g>
<!-- expert_0_5 -->
<g id="node29" class="node">
<title>expert_0_5</title>
<polygon fill="lightcyan" stroke="black" points="4820.5,-2337 4685.5,-2337 4685.5,-2269 4820.5,-2269 4820.5,-2337"/>
<text text-anchor="middle" x="4753" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4753" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4753" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4753" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_0&#45;&gt;expert_0_5 -->
<g id="edge26" class="edge">
<title>gate_0&#45;&gt;expert_0_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4574.39,-2402.88C4585.51,-2397.09 4597.19,-2390.91 4608,-2385 4631.41,-2372.2 4636.75,-2368.08 4660,-2355 4667.58,-2350.74 4675.53,-2346.31 4683.45,-2341.93"/>
<polygon fill="red" stroke="red" points="4685.3,-2344.9 4692.36,-2337.01 4681.92,-2338.77 4685.3,-2344.9"/>
<text text-anchor="middle" x="4691.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4691.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<!-- gate_0&#45;&gt;expert_0_5 -->
<g id="edge207" class="edge">
<title>gate_0&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4578.44,-2422.5C4629.7,-2415.84 4701.72,-2403.5 4723,-2385 4734.2,-2375.26 4741.23,-2360.95 4745.63,-2347.05"/>
<polygon fill="black" stroke="black" points="4749.09,-2347.64 4748.39,-2337.07 4742.35,-2345.77 4749.09,-2347.64"/>
</g>
<!-- expert_0_6 -->
<g id="node30" class="node">
<title>expert_0_6</title>
<polygon fill="lightgrey" stroke="black" points="4973.5,-2337 4838.5,-2337 4838.5,-2269 4973.5,-2269 4973.5,-2337"/>
<text text-anchor="middle" x="4906" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4906" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="4906" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="4906" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_0&#45;&gt;expert_0_6 -->
<g id="edge27" class="edge">
<title>gate_0&#45;&gt;expert_0_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4578.03,-2421.57C4621.74,-2415 4684.44,-2403.35 4737,-2385 4764.77,-2375.3 4769.54,-2367.86 4796,-2355 4806.65,-2349.83 4817.93,-2344.46 4829.05,-2339.24"/>
<polygon fill="red" stroke="red" points="4830.76,-2342.31 4838.34,-2334.9 4827.8,-2335.97 4830.76,-2342.31"/>
<text text-anchor="middle" x="4827.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4827.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<!-- gate_0&#45;&gt;expert_0_6 -->
<g id="edge209" class="edge">
<title>gate_0&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4578.27,-2427.19C4661.09,-2424.26 4814.14,-2414.85 4859,-2385 4872.88,-2375.77 4883.18,-2360.93 4890.54,-2346.47"/>
<polygon fill="black" stroke="black" points="4893.87,-2347.62 4894.97,-2337.08 4887.54,-2344.64 4893.87,-2347.62"/>
</g>
<!-- expert_0_7 -->
<g id="node31" class="node">
<title>expert_0_7</title>
<polygon fill="lightseagreen" stroke="black" points="5126.5,-2337 4991.5,-2337 4991.5,-2269 5126.5,-2269 5126.5,-2337"/>
<text text-anchor="middle" x="5059" y="-2321.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5059" y="-2306.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="5059" y="-2291.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="5059" y="-2276.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_0&#45;&gt;expert_0_7 -->
<g id="edge28" class="edge">
<title>gate_0&#45;&gt;expert_0_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4578,-2427.21C4648.2,-2424.32 4774,-2415.01 4877,-2385 4906.77,-2376.32 4911.69,-2367.66 4940,-2355 4956.55,-2347.6 4962.47,-2345.59 4982.13,-2337.33"/>
<polygon fill="red" stroke="red" points="4983.63,-2340.5 4991.47,-2333.38 4980.9,-2334.05 4983.63,-2340.5"/>
<text text-anchor="middle" x="4971.5" y="-2373.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="4971.5" y="-2358.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<!-- gate_0&#45;&gt;expert_0_7 -->
<g id="edge211" class="edge">
<title>gate_0&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4578.12,-2429.24C4687.85,-2429.85 4932.14,-2426.35 5003,-2385 5018.41,-2376.01 5030.56,-2360.89 5039.55,-2346.13"/>
<polygon fill="black" stroke="black" points="5042.82,-2347.47 5044.74,-2337.05 5036.74,-2344 5042.82,-2347.47"/>
</g>
<!-- expert_agg_0 -->
<g id="node32" class="node">
<title>expert_agg_0</title>
<polygon fill="lightsteelblue" stroke="black" points="4682,-2218 4524,-2218 4524,-2165 4682,-2165 4682,-2218"/>
<text text-anchor="middle" x="4603" y="-2202.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4603" y="-2187.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4603" y="-2172.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_0_0&#45;&gt;expert_agg_0 -->
<g id="edge29" class="edge">
<title>expert_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3985.55,-2268.77C3986.51,-2256.79 3989.98,-2244.21 3999,-2236 4036.15,-2202.16 4354.66,-2194.61 4513.58,-2192.95"/>
<polygon fill="black" stroke="black" points="4513.85,-2196.44 4523.81,-2192.85 4513.78,-2189.44 4513.85,-2196.44"/>
<text text-anchor="middle" x="4050.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 0→Agg</text>
</g>
<!-- expert_0_0&#45;&gt;expert_agg_0 -->
<g id="edge198" class="edge">
<title>expert_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4055.6,-2271.99C4070.88,-2265.14 4087.02,-2257.86 4102,-2251 4116.28,-2244.46 4118.84,-2240.12 4134,-2236 4262.86,-2200.97 4418.16,-2192.93 4513.74,-2191.7"/>
<polygon fill="black" stroke="black" points="4513.98,-2195.2 4523.94,-2191.59 4513.9,-2188.2 4513.98,-2195.2"/>
</g>
<!-- expert_0_1&#45;&gt;expert_agg_0 -->
<g id="edge30" class="edge">
<title>expert_0_1&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4135.91,-2268.8C4135.98,-2256.96 4138.56,-2244.48 4147,-2236 4172.27,-2210.61 4387.87,-2199.41 4513.36,-2195.01"/>
<polygon fill="black" stroke="black" points="4513.84,-2198.49 4523.72,-2194.65 4513.6,-2191.5 4513.84,-2198.49"/>
<text text-anchor="middle" x="4198.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 1→Agg</text>
</g>
<!-- expert_0_1&#45;&gt;expert_agg_0 -->
<g id="edge200" class="edge">
<title>expert_0_1&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4208.73,-2272.38C4222.59,-2265.74 4236.93,-2258.45 4250,-2251 4260.28,-2245.14 4260.94,-2240.22 4272,-2236 4350.16,-2206.17 4445.41,-2196.15 4513.63,-2193.08"/>
<polygon fill="black" stroke="black" points="4514.07,-2196.57 4523.91,-2192.67 4513.78,-2189.58 4514.07,-2196.57"/>
</g>
<!-- expert_0_2&#45;&gt;expert_agg_0 -->
<g id="edge31" class="edge">
<title>expert_0_2&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4278.39,-2268.77C4275.37,-2257.22 4275.21,-2244.92 4283,-2236 4312.46,-2202.27 4429.77,-2193.7 4513.81,-2192.02"/>
<polygon fill="black" stroke="black" points="4513.95,-2195.52 4523.89,-2191.85 4513.83,-2188.52 4513.95,-2195.52"/>
<text text-anchor="middle" x="4334.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 2→Agg</text>
</g>
<!-- expert_0_2&#45;&gt;expert_agg_0 -->
<g id="edge202" class="edge">
<title>expert_0_2&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4355.93,-2268.94C4366.09,-2263.15 4376.43,-2257.05 4386,-2251 4395.7,-2244.88 4396.52,-2240.67 4407,-2236 4440.47,-2221.08 4479.5,-2211.08 4513.88,-2204.47"/>
<polygon fill="black" stroke="black" points="4514.72,-2207.88 4523.92,-2202.61 4513.45,-2200.99 4514.72,-2207.88"/>
</g>
<!-- expert_0_3&#45;&gt;expert_agg_0 -->
<g id="edge32" class="edge">
<title>expert_0_3&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4417.33,-2268.71C4411.02,-2257.66 4408.29,-2245.72 4416,-2236 4428.69,-2220.02 4472.01,-2209.38 4513.77,-2202.62"/>
<polygon fill="black" stroke="black" points="4514.42,-2206.06 4523.76,-2201.07 4513.35,-2199.14 4514.42,-2206.06"/>
<text text-anchor="middle" x="4467.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 3→Agg</text>
</g>
<!-- expert_0_3&#45;&gt;expert_agg_0 -->
<g id="edge204" class="edge">
<title>expert_0_3&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4494.23,-2268.85C4514.47,-2254.64 4538.01,-2238.12 4558,-2224.08"/>
<polygon fill="black" stroke="black" points="4560.16,-2226.85 4566.33,-2218.24 4556.14,-2221.12 4560.16,-2226.85"/>
</g>
<!-- expert_0_4&#45;&gt;expert_agg_0 -->
<g id="edge33" class="edge">
<title>expert_0_4&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4555.83,-2268.89C4547.81,-2258.89 4543.5,-2247.49 4549,-2236 4550.73,-2232.38 4552.93,-2228.96 4555.45,-2225.76"/>
<polygon fill="black" stroke="black" points="4558.14,-2228 4562.25,-2218.24 4552.95,-2223.3 4558.14,-2228"/>
<text text-anchor="middle" x="4600.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 4→Agg</text>
</g>
<!-- expert_0_4&#45;&gt;expert_agg_0 -->
<g id="edge206" class="edge">
<title>expert_0_4&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4640.85,-2268.91C4645.37,-2263.42 4649.31,-2257.41 4652,-2251 4655.69,-2242.21 4653.43,-2233.74 4648.28,-2226.1"/>
<polygon fill="black" stroke="black" points="4650.78,-2223.63 4641.7,-2218.17 4645.39,-2228.1 4650.78,-2223.63"/>
</g>
<!-- expert_0_5&#45;&gt;expert_agg_0 -->
<g id="edge34" class="edge">
<title>expert_0_5&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4706.72,-2268.9C4698.47,-2262.96 4689.97,-2256.81 4682,-2251 4670.24,-2242.42 4657.54,-2233.07 4645.85,-2224.4"/>
<polygon fill="black" stroke="black" points="4647.65,-2221.38 4637.53,-2218.24 4643.48,-2227 4647.65,-2221.38"/>
<text text-anchor="middle" x="4733.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 5→Agg</text>
</g>
<!-- expert_0_5&#45;&gt;expert_agg_0 -->
<g id="edge208" class="edge">
<title>expert_0_5&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4783.36,-2268.81C4789.85,-2257.76 4792.73,-2245.8 4785,-2236 4772.94,-2220.72 4732.29,-2210.21 4692.45,-2203.36"/>
<polygon fill="black" stroke="black" points="4692.8,-2199.87 4682.36,-2201.69 4691.66,-2206.77 4692.8,-2199.87"/>
</g>
<!-- expert_0_6&#45;&gt;expert_agg_0 -->
<g id="edge35" class="edge">
<title>expert_0_6&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4845.46,-2268.82C4835.23,-2263 4824.76,-2256.91 4815,-2251 4804.56,-2244.68 4803.23,-2240.78 4792,-2236 4760.55,-2222.63 4724.33,-2213.02 4692.06,-2206.29"/>
<polygon fill="black" stroke="black" points="4692.68,-2202.85 4682.19,-2204.3 4691.29,-2209.71 4692.68,-2202.85"/>
<text text-anchor="middle" x="4866.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 6→Agg</text>
</g>
<!-- expert_0_6&#45;&gt;expert_agg_0 -->
<g id="edge210" class="edge">
<title>expert_0_6&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4922.28,-2268.81C4925.48,-2257.25 4925.8,-2244.96 4918,-2236 4889.19,-2202.94 4774.82,-2194.16 4692.18,-2192.26"/>
<polygon fill="black" stroke="black" points="4692.08,-2188.75 4682.01,-2192.05 4691.94,-2195.75 4692.08,-2188.75"/>
</g>
<!-- expert_0_7&#45;&gt;expert_agg_0 -->
<g id="edge36" class="edge">
<title>expert_0_7&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4991.5,-2271.97C4977.62,-2265.37 4963.21,-2258.19 4950,-2251 4938.95,-2244.99 4937.83,-2240.27 4926,-2236 4850.06,-2208.6 4758.44,-2198.23 4692.2,-2194.42"/>
<polygon fill="black" stroke="black" points="4692.38,-2190.92 4682.21,-2193.88 4692.01,-2197.91 4692.38,-2190.92"/>
<text text-anchor="middle" x="5001.5" y="-2239.8" font-family="Times,serif" font-size="14.00">Expert 7→Agg</text>
</g>
<!-- expert_0_7&#45;&gt;expert_agg_0 -->
<g id="edge212" class="edge">
<title>expert_0_7&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M5064.09,-2268.8C5064.01,-2256.97 5061.44,-2244.49 5053,-2236 5028.14,-2211 4816.45,-2199.66 4692.47,-2195.13"/>
<polygon fill="black" stroke="black" points="4692.35,-2191.62 4682.23,-2194.76 4692.1,-2198.61 4692.35,-2191.62"/>
</g>
<!-- expert_agg_0&#45;&gt;residual2_0 -->
<g id="edge213" class="edge">
<title>expert_agg_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M4682.18,-2171.19C4760.97,-2152.81 4881.49,-2125.31 4962.94,-2107.14"/>
<polygon fill="black" stroke="black" points="4964.17,-2110.46 4973.17,-2104.87 4962.64,-2103.62 4964.17,-2110.46"/>
</g>
<!-- expert_agg_0&#45;&gt;residual2_0 -->
<g id="edge216" class="edge">
<title>expert_agg_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M4682.24,-2173.6C4761.04,-2156.06 4881.54,-2128.6 4962.97,-2109.64"/>
<polygon fill="black" stroke="black" points="4964.25,-2112.93 4973.19,-2107.25 4962.66,-2106.11 4964.25,-2112.93"/>
</g>
<!-- qkv_0_0_0 -->
<g id="node34" class="node">
<title>qkv_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="4075.5,-2546 3922.5,-2546 3922.5,-2493 4075.5,-2493 4075.5,-2546"/>
<text text-anchor="middle" x="3999" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3999" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3999" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_0_0 -->
<g id="edge146" class="edge">
<title>ln1_0&#45;&gt;qkv_0_0_0</title>
<path fill="none" stroke="black" d="M4106.63,-2582.81C4089.61,-2572.96 4070.03,-2561.62 4052.26,-2551.34"/>
<polygon fill="black" stroke="black" points="4053.57,-2548.05 4043.17,-2546.07 4050.07,-2554.11 4053.57,-2548.05"/>
</g>
<!-- reshape_0_0_0 -->
<g id="node35" class="node">
<title>reshape_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="4008,-2456 3846,-2456 3846,-2403 4008,-2403 4008,-2456"/>
<text text-anchor="middle" x="3927" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3927" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3927" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_0_0_0&#45;&gt;reshape_0_0_0 -->
<g id="edge147" class="edge">
<title>qkv_0_0_0&#45;&gt;reshape_0_0_0</title>
<path fill="none" stroke="black" d="M3977.79,-2492.57C3970.46,-2483.62 3962.15,-2473.46 3954.4,-2463.99"/>
<polygon fill="black" stroke="black" points="3957.1,-2461.76 3948.06,-2456.24 3951.68,-2466.2 3957.1,-2461.76"/>
</g>
<!-- attn_0_0_0 -->
<g id="node36" class="node">
<title>attn_0_0_0</title>
<polygon fill="lightblue" stroke="black" points="3902,-2329.5 3676,-2329.5 3676,-2276.5 3902,-2276.5 3902,-2329.5"/>
<text text-anchor="middle" x="3789" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3789" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3789" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge148" class="edge">
<title>reshape_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="black" d="M3898.41,-2402.7C3877.13,-2383.51 3847.93,-2357.17 3825.05,-2336.53"/>
<polygon fill="black" stroke="black" points="3827.33,-2333.86 3817.56,-2329.76 3822.64,-2339.06 3827.33,-2333.86"/>
</g>
<!-- attn_0_0_0&#45;&gt;proj_0_0_0 -->
<g id="edge149" class="edge">
<title>attn_0_0_0&#45;&gt;proj_0_0_0</title>
<path fill="none" stroke="black" d="M3767.9,-2276.33C3755.6,-2261.36 3739.94,-2242.32 3726.67,-2226.16"/>
<polygon fill="black" stroke="black" points="3729.02,-2223.52 3719.97,-2218.01 3723.61,-2227.96 3729.02,-2223.52"/>
</g>
<!-- qkv_0_0_1 -->
<g id="node37" class="node">
<title>qkv_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3621.5,-2546 3468.5,-2546 3468.5,-2493 3621.5,-2493 3621.5,-2546"/>
<text text-anchor="middle" x="3545" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3545" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3545" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_0_0_1 -->
<g id="node38" class="node">
<title>reshape_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3626,-2456 3464,-2456 3464,-2403 3626,-2403 3626,-2456"/>
<text text-anchor="middle" x="3545" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3545" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3545" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_0_0_1&#45;&gt;reshape_0_0_1 -->
<g id="edge150" class="edge">
<title>qkv_0_0_1&#45;&gt;reshape_0_0_1</title>
<path fill="none" stroke="black" d="M3545,-2492.57C3545,-2484.34 3545,-2475.08 3545,-2466.28"/>
<polygon fill="black" stroke="black" points="3548.5,-2466.24 3545,-2456.24 3541.5,-2466.24 3548.5,-2466.24"/>
</g>
<!-- attn_0_0_1 -->
<g id="node39" class="node">
<title>attn_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="3658,-2329.5 3432,-2329.5 3432,-2276.5 3658,-2276.5 3658,-2329.5"/>
<text text-anchor="middle" x="3545" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3545" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3545" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge151" class="edge">
<title>reshape_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="black" d="M3545,-2402.7C3545,-2384.51 3545,-2359.9 3545,-2339.8"/>
<polygon fill="black" stroke="black" points="3548.5,-2339.76 3545,-2329.76 3541.5,-2339.76 3548.5,-2339.76"/>
</g>
<!-- attn_0_0_1&#45;&gt;proj_0_0_1 -->
<g id="edge152" class="edge">
<title>attn_0_0_1&#45;&gt;proj_0_0_1</title>
<path fill="none" stroke="black" d="M3531.64,-2276.33C3523.99,-2261.64 3514.29,-2243.01 3505.99,-2227.05"/>
<polygon fill="black" stroke="black" points="3509,-2225.27 3501.28,-2218.01 3502.79,-2228.5 3509,-2225.27"/>
</g>
<!-- qkv_0_0_2 -->
<g id="node40" class="node">
<title>qkv_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3377.5,-2546 3224.5,-2546 3224.5,-2493 3377.5,-2493 3377.5,-2546"/>
<text text-anchor="middle" x="3301" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3301" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3301" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_0_0_2 -->
<g id="node41" class="node">
<title>reshape_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3382,-2456 3220,-2456 3220,-2403 3382,-2403 3382,-2456"/>
<text text-anchor="middle" x="3301" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3301" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3301" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_0_0_2&#45;&gt;reshape_0_0_2 -->
<g id="edge153" class="edge">
<title>qkv_0_0_2&#45;&gt;reshape_0_0_2</title>
<path fill="none" stroke="black" d="M3301,-2492.57C3301,-2484.34 3301,-2475.08 3301,-2466.28"/>
<polygon fill="black" stroke="black" points="3304.5,-2466.24 3301,-2456.24 3297.5,-2466.24 3304.5,-2466.24"/>
</g>
<!-- attn_0_0_2 -->
<g id="node42" class="node">
<title>attn_0_0_2</title>
<polygon fill="lightyellow" stroke="black" points="3414,-2329.5 3188,-2329.5 3188,-2276.5 3414,-2276.5 3414,-2329.5"/>
<text text-anchor="middle" x="3301" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3301" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3301" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge154" class="edge">
<title>reshape_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="black" d="M3301,-2402.7C3301,-2384.51 3301,-2359.9 3301,-2339.8"/>
<polygon fill="black" stroke="black" points="3304.5,-2339.76 3301,-2329.76 3297.5,-2339.76 3304.5,-2339.76"/>
</g>
<!-- attn_0_0_2&#45;&gt;proj_0_0_2 -->
<g id="edge155" class="edge">
<title>attn_0_0_2&#45;&gt;proj_0_0_2</title>
<path fill="none" stroke="black" d="M3301,-2276.33C3301,-2262.05 3301,-2244.05 3301,-2228.4"/>
<polygon fill="black" stroke="black" points="3304.5,-2228.01 3301,-2218.01 3297.5,-2228.01 3304.5,-2228.01"/>
</g>
<!-- qkv_0_0_3 -->
<g id="node43" class="node">
<title>qkv_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3133.5,-2546 2980.5,-2546 2980.5,-2493 3133.5,-2493 3133.5,-2546"/>
<text text-anchor="middle" x="3057" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3057" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="3057" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_0_0_3 -->
<g id="node44" class="node">
<title>reshape_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3138,-2456 2976,-2456 2976,-2403 3138,-2403 3138,-2456"/>
<text text-anchor="middle" x="3057" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="3057" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3057" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_0_0_3&#45;&gt;reshape_0_0_3 -->
<g id="edge156" class="edge">
<title>qkv_0_0_3&#45;&gt;reshape_0_0_3</title>
<path fill="none" stroke="black" d="M3057,-2492.57C3057,-2484.34 3057,-2475.08 3057,-2466.28"/>
<polygon fill="black" stroke="black" points="3060.5,-2466.24 3057,-2456.24 3053.5,-2466.24 3060.5,-2466.24"/>
</g>
<!-- attn_0_0_3 -->
<g id="node45" class="node">
<title>attn_0_0_3</title>
<polygon fill="lightcoral" stroke="black" points="3170,-2329.5 2944,-2329.5 2944,-2276.5 3170,-2276.5 3170,-2329.5"/>
<text text-anchor="middle" x="3057" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3057" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="3057" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge157" class="edge">
<title>reshape_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="black" d="M3057,-2402.7C3057,-2384.51 3057,-2359.9 3057,-2339.8"/>
<polygon fill="black" stroke="black" points="3060.5,-2339.76 3057,-2329.76 3053.5,-2339.76 3060.5,-2339.76"/>
</g>
<!-- attn_0_0_3&#45;&gt;proj_0_0_3 -->
<g id="edge158" class="edge">
<title>attn_0_0_3&#45;&gt;proj_0_0_3</title>
<path fill="none" stroke="black" d="M3066.61,-2276.33C3072.06,-2261.77 3078.96,-2243.36 3084.89,-2227.5"/>
<polygon fill="black" stroke="black" points="3088.22,-2228.6 3088.45,-2218.01 3081.66,-2226.15 3088.22,-2228.6"/>
</g>
<!-- qkv_0_1_0 -->
<g id="node46" class="node">
<title>qkv_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="2889.5,-2546 2736.5,-2546 2736.5,-2493 2889.5,-2493 2889.5,-2546"/>
<text text-anchor="middle" x="2813" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2813" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2813" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_0_1_0 -->
<g id="node47" class="node">
<title>reshape_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="2894,-2456 2732,-2456 2732,-2403 2894,-2403 2894,-2456"/>
<text text-anchor="middle" x="2813" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2813" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2813" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_0_1_0&#45;&gt;reshape_0_1_0 -->
<g id="edge159" class="edge">
<title>qkv_0_1_0&#45;&gt;reshape_0_1_0</title>
<path fill="none" stroke="black" d="M2813,-2492.57C2813,-2484.34 2813,-2475.08 2813,-2466.28"/>
<polygon fill="black" stroke="black" points="2816.5,-2466.24 2813,-2456.24 2809.5,-2466.24 2816.5,-2466.24"/>
</g>
<!-- attn_0_1_0 -->
<g id="node48" class="node">
<title>attn_0_1_0</title>
<polygon fill="lightpink" stroke="black" points="2926,-2329.5 2700,-2329.5 2700,-2276.5 2926,-2276.5 2926,-2329.5"/>
<text text-anchor="middle" x="2813" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2813" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2813" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge160" class="edge">
<title>reshape_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="black" d="M2813,-2402.7C2813,-2384.51 2813,-2359.9 2813,-2339.8"/>
<polygon fill="black" stroke="black" points="2816.5,-2339.76 2813,-2329.76 2809.5,-2339.76 2816.5,-2339.76"/>
</g>
<!-- attn_0_1_0&#45;&gt;proj_0_1_0 -->
<g id="edge161" class="edge">
<title>attn_0_1_0&#45;&gt;proj_0_1_0</title>
<path fill="none" stroke="black" d="M2791.9,-2276.33C2779.6,-2261.36 2763.94,-2242.32 2750.67,-2226.16"/>
<polygon fill="black" stroke="black" points="2753.02,-2223.52 2743.97,-2218.01 2747.61,-2227.96 2753.02,-2223.52"/>
</g>
<!-- qkv_0_1_1 -->
<g id="node49" class="node">
<title>qkv_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2645.5,-2546 2492.5,-2546 2492.5,-2493 2645.5,-2493 2645.5,-2546"/>
<text text-anchor="middle" x="2569" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2569" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2569" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_0_1_1 -->
<g id="node50" class="node">
<title>reshape_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2650,-2456 2488,-2456 2488,-2403 2650,-2403 2650,-2456"/>
<text text-anchor="middle" x="2569" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2569" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2569" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_0_1_1&#45;&gt;reshape_0_1_1 -->
<g id="edge162" class="edge">
<title>qkv_0_1_1&#45;&gt;reshape_0_1_1</title>
<path fill="none" stroke="black" d="M2569,-2492.57C2569,-2484.34 2569,-2475.08 2569,-2466.28"/>
<polygon fill="black" stroke="black" points="2572.5,-2466.24 2569,-2456.24 2565.5,-2466.24 2572.5,-2466.24"/>
</g>
<!-- attn_0_1_1 -->
<g id="node51" class="node">
<title>attn_0_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2682,-2329.5 2456,-2329.5 2456,-2276.5 2682,-2276.5 2682,-2329.5"/>
<text text-anchor="middle" x="2569" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2569" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2569" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge163" class="edge">
<title>reshape_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="black" d="M2569,-2402.7C2569,-2384.51 2569,-2359.9 2569,-2339.8"/>
<polygon fill="black" stroke="black" points="2572.5,-2339.76 2569,-2329.76 2565.5,-2339.76 2572.5,-2339.76"/>
</g>
<!-- attn_0_1_1&#45;&gt;proj_0_1_1 -->
<g id="edge164" class="edge">
<title>attn_0_1_1&#45;&gt;proj_0_1_1</title>
<path fill="none" stroke="black" d="M2555.64,-2276.33C2547.99,-2261.64 2538.29,-2243.01 2529.99,-2227.05"/>
<polygon fill="black" stroke="black" points="2533,-2225.27 2525.28,-2218.01 2526.79,-2228.5 2533,-2225.27"/>
</g>
<!-- qkv_0_1_2 -->
<g id="node52" class="node">
<title>qkv_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2401.5,-2546 2248.5,-2546 2248.5,-2493 2401.5,-2493 2401.5,-2546"/>
<text text-anchor="middle" x="2325" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2325" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2325" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_0_1_2 -->
<g id="node53" class="node">
<title>reshape_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2406,-2456 2244,-2456 2244,-2403 2406,-2403 2406,-2456"/>
<text text-anchor="middle" x="2325" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2325" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2325" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_0_1_2&#45;&gt;reshape_0_1_2 -->
<g id="edge165" class="edge">
<title>qkv_0_1_2&#45;&gt;reshape_0_1_2</title>
<path fill="none" stroke="black" d="M2325,-2492.57C2325,-2484.34 2325,-2475.08 2325,-2466.28"/>
<polygon fill="black" stroke="black" points="2328.5,-2466.24 2325,-2456.24 2321.5,-2466.24 2328.5,-2466.24"/>
</g>
<!-- attn_0_1_2 -->
<g id="node54" class="node">
<title>attn_0_1_2</title>
<polygon fill="lightgrey" stroke="black" points="2438,-2329.5 2212,-2329.5 2212,-2276.5 2438,-2276.5 2438,-2329.5"/>
<text text-anchor="middle" x="2325" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2325" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2325" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge166" class="edge">
<title>reshape_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="black" d="M2325,-2402.7C2325,-2384.51 2325,-2359.9 2325,-2339.8"/>
<polygon fill="black" stroke="black" points="2328.5,-2339.76 2325,-2329.76 2321.5,-2339.76 2328.5,-2339.76"/>
</g>
<!-- attn_0_1_2&#45;&gt;proj_0_1_2 -->
<g id="edge167" class="edge">
<title>attn_0_1_2&#45;&gt;proj_0_1_2</title>
<path fill="none" stroke="black" d="M2325,-2276.33C2325,-2262.05 2325,-2244.05 2325,-2228.4"/>
<polygon fill="black" stroke="black" points="2328.5,-2228.01 2325,-2218.01 2321.5,-2228.01 2328.5,-2228.01"/>
</g>
<!-- qkv_0_1_3 -->
<g id="node55" class="node">
<title>qkv_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2157.5,-2546 2004.5,-2546 2004.5,-2493 2157.5,-2493 2157.5,-2546"/>
<text text-anchor="middle" x="2081" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2081" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="2081" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_0_1_3 -->
<g id="node56" class="node">
<title>reshape_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2162,-2456 2000,-2456 2000,-2403 2162,-2403 2162,-2456"/>
<text text-anchor="middle" x="2081" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="2081" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2081" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_0_1_3&#45;&gt;reshape_0_1_3 -->
<g id="edge168" class="edge">
<title>qkv_0_1_3&#45;&gt;reshape_0_1_3</title>
<path fill="none" stroke="black" d="M2081,-2492.57C2081,-2484.34 2081,-2475.08 2081,-2466.28"/>
<polygon fill="black" stroke="black" points="2084.5,-2466.24 2081,-2456.24 2077.5,-2466.24 2084.5,-2466.24"/>
</g>
<!-- attn_0_1_3 -->
<g id="node57" class="node">
<title>attn_0_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="2194,-2329.5 1968,-2329.5 1968,-2276.5 2194,-2276.5 2194,-2329.5"/>
<text text-anchor="middle" x="2081" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2081" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="2081" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge169" class="edge">
<title>reshape_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="black" d="M2081,-2402.7C2081,-2384.51 2081,-2359.9 2081,-2339.8"/>
<polygon fill="black" stroke="black" points="2084.5,-2339.76 2081,-2329.76 2077.5,-2339.76 2084.5,-2339.76"/>
</g>
<!-- attn_0_1_3&#45;&gt;proj_0_1_3 -->
<g id="edge170" class="edge">
<title>attn_0_1_3&#45;&gt;proj_0_1_3</title>
<path fill="none" stroke="black" d="M2090.61,-2276.33C2096.06,-2261.77 2102.96,-2243.36 2108.89,-2227.5"/>
<polygon fill="black" stroke="black" points="2112.22,-2228.6 2112.45,-2218.01 2105.66,-2226.15 2112.22,-2228.6"/>
</g>
<!-- qkv_0_2_0 -->
<g id="node58" class="node">
<title>qkv_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="1913.5,-2546 1760.5,-2546 1760.5,-2493 1913.5,-2493 1913.5,-2546"/>
<text text-anchor="middle" x="1837" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1837" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1837" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_0_2_0 -->
<g id="node59" class="node">
<title>reshape_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="1918,-2456 1756,-2456 1756,-2403 1918,-2403 1918,-2456"/>
<text text-anchor="middle" x="1837" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1837" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1837" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_0_2_0&#45;&gt;reshape_0_2_0 -->
<g id="edge171" class="edge">
<title>qkv_0_2_0&#45;&gt;reshape_0_2_0</title>
<path fill="none" stroke="black" d="M1837,-2492.57C1837,-2484.34 1837,-2475.08 1837,-2466.28"/>
<polygon fill="black" stroke="black" points="1840.5,-2466.24 1837,-2456.24 1833.5,-2466.24 1840.5,-2466.24"/>
</g>
<!-- attn_0_2_0 -->
<g id="node60" class="node">
<title>attn_0_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="1950,-2329.5 1724,-2329.5 1724,-2276.5 1950,-2276.5 1950,-2329.5"/>
<text text-anchor="middle" x="1837" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1837" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1837" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge172" class="edge">
<title>reshape_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="black" d="M1837,-2402.7C1837,-2384.51 1837,-2359.9 1837,-2339.8"/>
<polygon fill="black" stroke="black" points="1840.5,-2339.76 1837,-2329.76 1833.5,-2339.76 1840.5,-2339.76"/>
</g>
<!-- attn_0_2_0&#45;&gt;proj_0_2_0 -->
<g id="edge173" class="edge">
<title>attn_0_2_0&#45;&gt;proj_0_2_0</title>
<path fill="none" stroke="black" d="M1823.64,-2276.33C1815.99,-2261.64 1806.29,-2243.01 1797.99,-2227.05"/>
<polygon fill="black" stroke="black" points="1801,-2225.27 1793.28,-2218.01 1794.79,-2228.5 1801,-2225.27"/>
</g>
<!-- qkv_0_2_1 -->
<g id="node61" class="node">
<title>qkv_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="1669.5,-2546 1516.5,-2546 1516.5,-2493 1669.5,-2493 1669.5,-2546"/>
<text text-anchor="middle" x="1593" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1593" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1593" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_0_2_1 -->
<g id="node62" class="node">
<title>reshape_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="1674,-2456 1512,-2456 1512,-2403 1674,-2403 1674,-2456"/>
<text text-anchor="middle" x="1593" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1593" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1593" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_0_2_1&#45;&gt;reshape_0_2_1 -->
<g id="edge174" class="edge">
<title>qkv_0_2_1&#45;&gt;reshape_0_2_1</title>
<path fill="none" stroke="black" d="M1593,-2492.57C1593,-2484.34 1593,-2475.08 1593,-2466.28"/>
<polygon fill="black" stroke="black" points="1596.5,-2466.24 1593,-2456.24 1589.5,-2466.24 1596.5,-2466.24"/>
</g>
<!-- attn_0_2_1 -->
<g id="node63" class="node">
<title>attn_0_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="1706,-2329.5 1480,-2329.5 1480,-2276.5 1706,-2276.5 1706,-2329.5"/>
<text text-anchor="middle" x="1593" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1593" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1593" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge175" class="edge">
<title>reshape_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="black" d="M1593,-2402.7C1593,-2384.51 1593,-2359.9 1593,-2339.8"/>
<polygon fill="black" stroke="black" points="1596.5,-2339.76 1593,-2329.76 1589.5,-2339.76 1596.5,-2339.76"/>
</g>
<!-- attn_0_2_1&#45;&gt;proj_0_2_1 -->
<g id="edge176" class="edge">
<title>attn_0_2_1&#45;&gt;proj_0_2_1</title>
<path fill="none" stroke="black" d="M1593,-2276.33C1593,-2262.05 1593,-2244.05 1593,-2228.4"/>
<polygon fill="black" stroke="black" points="1596.5,-2228.01 1593,-2218.01 1589.5,-2228.01 1596.5,-2228.01"/>
</g>
<!-- qkv_0_2_2 -->
<g id="node64" class="node">
<title>qkv_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="1425.5,-2546 1272.5,-2546 1272.5,-2493 1425.5,-2493 1425.5,-2546"/>
<text text-anchor="middle" x="1349" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1349" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1349" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_0_2_2 -->
<g id="node65" class="node">
<title>reshape_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="1430,-2456 1268,-2456 1268,-2403 1430,-2403 1430,-2456"/>
<text text-anchor="middle" x="1349" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1349" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1349" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_0_2_2&#45;&gt;reshape_0_2_2 -->
<g id="edge177" class="edge">
<title>qkv_0_2_2&#45;&gt;reshape_0_2_2</title>
<path fill="none" stroke="black" d="M1349,-2492.57C1349,-2484.34 1349,-2475.08 1349,-2466.28"/>
<polygon fill="black" stroke="black" points="1352.5,-2466.24 1349,-2456.24 1345.5,-2466.24 1352.5,-2466.24"/>
</g>
<!-- attn_0_2_2 -->
<g id="node66" class="node">
<title>attn_0_2_2</title>
<polygon fill="lightslategray" stroke="black" points="1462,-2329.5 1236,-2329.5 1236,-2276.5 1462,-2276.5 1462,-2329.5"/>
<text text-anchor="middle" x="1349" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1349" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1349" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge178" class="edge">
<title>reshape_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="black" d="M1349,-2402.7C1349,-2384.51 1349,-2359.9 1349,-2339.8"/>
<polygon fill="black" stroke="black" points="1352.5,-2339.76 1349,-2329.76 1345.5,-2339.76 1352.5,-2339.76"/>
</g>
<!-- attn_0_2_2&#45;&gt;proj_0_2_2 -->
<g id="edge179" class="edge">
<title>attn_0_2_2&#45;&gt;proj_0_2_2</title>
<path fill="none" stroke="black" d="M1358.61,-2276.33C1364.06,-2261.77 1370.96,-2243.36 1376.89,-2227.5"/>
<polygon fill="black" stroke="black" points="1380.22,-2228.6 1380.45,-2218.01 1373.66,-2226.15 1380.22,-2228.6"/>
</g>
<!-- qkv_0_2_3 -->
<g id="node67" class="node">
<title>qkv_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1181.5,-2546 1028.5,-2546 1028.5,-2493 1181.5,-2493 1181.5,-2546"/>
<text text-anchor="middle" x="1105" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1105" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="1105" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_0_2_3 -->
<g id="node68" class="node">
<title>reshape_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1186,-2456 1024,-2456 1024,-2403 1186,-2403 1186,-2456"/>
<text text-anchor="middle" x="1105" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="1105" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1105" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_0_2_3&#45;&gt;reshape_0_2_3 -->
<g id="edge180" class="edge">
<title>qkv_0_2_3&#45;&gt;reshape_0_2_3</title>
<path fill="none" stroke="black" d="M1105,-2492.57C1105,-2484.34 1105,-2475.08 1105,-2466.28"/>
<polygon fill="black" stroke="black" points="1108.5,-2466.24 1105,-2456.24 1101.5,-2466.24 1108.5,-2466.24"/>
</g>
<!-- attn_0_2_3 -->
<g id="node69" class="node">
<title>attn_0_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="1218,-2329.5 992,-2329.5 992,-2276.5 1218,-2276.5 1218,-2329.5"/>
<text text-anchor="middle" x="1105" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1105" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="1105" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge181" class="edge">
<title>reshape_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="black" d="M1105,-2402.7C1105,-2384.51 1105,-2359.9 1105,-2339.8"/>
<polygon fill="black" stroke="black" points="1108.5,-2339.76 1105,-2329.76 1101.5,-2339.76 1108.5,-2339.76"/>
</g>
<!-- attn_0_2_3&#45;&gt;proj_0_2_3 -->
<g id="edge182" class="edge">
<title>attn_0_2_3&#45;&gt;proj_0_2_3</title>
<path fill="none" stroke="black" d="M1127.51,-2276.33C1140.75,-2261.23 1157.63,-2241.97 1171.88,-2225.72"/>
<polygon fill="black" stroke="black" points="1174.67,-2227.84 1178.63,-2218.01 1169.41,-2223.22 1174.67,-2227.84"/>
</g>
<!-- qkv_0_3_0 -->
<g id="node70" class="node">
<title>qkv_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="937.5,-2546 784.5,-2546 784.5,-2493 937.5,-2493 937.5,-2546"/>
<text text-anchor="middle" x="861" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="861" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="861" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_0_3_0 -->
<g id="node71" class="node">
<title>reshape_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="942,-2456 780,-2456 780,-2403 942,-2403 942,-2456"/>
<text text-anchor="middle" x="861" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="861" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="861" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_0_3_0&#45;&gt;reshape_0_3_0 -->
<g id="edge183" class="edge">
<title>qkv_0_3_0&#45;&gt;reshape_0_3_0</title>
<path fill="none" stroke="black" d="M861,-2492.57C861,-2484.34 861,-2475.08 861,-2466.28"/>
<polygon fill="black" stroke="black" points="864.5,-2466.24 861,-2456.24 857.5,-2466.24 864.5,-2466.24"/>
</g>
<!-- attn_0_3_0 -->
<g id="node72" class="node">
<title>attn_0_3_0</title>
<polygon fill="#eedd82" stroke="black" points="974,-2329.5 748,-2329.5 748,-2276.5 974,-2276.5 974,-2329.5"/>
<text text-anchor="middle" x="861" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="861" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="861" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge184" class="edge">
<title>reshape_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="black" d="M861,-2402.7C861,-2384.51 861,-2359.9 861,-2339.8"/>
<polygon fill="black" stroke="black" points="864.5,-2339.76 861,-2329.76 857.5,-2339.76 864.5,-2339.76"/>
</g>
<!-- attn_0_3_0&#45;&gt;proj_0_3_0 -->
<g id="edge185" class="edge">
<title>attn_0_3_0&#45;&gt;proj_0_3_0</title>
<path fill="none" stroke="black" d="M851.39,-2276.33C845.94,-2261.77 839.04,-2243.36 833.11,-2227.5"/>
<polygon fill="black" stroke="black" points="836.34,-2226.15 829.55,-2218.01 829.78,-2228.6 836.34,-2226.15"/>
</g>
<!-- qkv_0_3_1 -->
<g id="node73" class="node">
<title>qkv_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="693.5,-2546 540.5,-2546 540.5,-2493 693.5,-2493 693.5,-2546"/>
<text text-anchor="middle" x="617" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="617" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="617" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_0_3_1 -->
<g id="node74" class="node">
<title>reshape_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="698,-2456 536,-2456 536,-2403 698,-2403 698,-2456"/>
<text text-anchor="middle" x="617" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="617" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="617" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_0_3_1&#45;&gt;reshape_0_3_1 -->
<g id="edge186" class="edge">
<title>qkv_0_3_1&#45;&gt;reshape_0_3_1</title>
<path fill="none" stroke="black" d="M617,-2492.57C617,-2484.34 617,-2475.08 617,-2466.28"/>
<polygon fill="black" stroke="black" points="620.5,-2466.24 617,-2456.24 613.5,-2466.24 620.5,-2466.24"/>
</g>
<!-- attn_0_3_1 -->
<g id="node75" class="node">
<title>attn_0_3_1</title>
<polygon fill="lightcyan" stroke="black" points="730,-2329.5 504,-2329.5 504,-2276.5 730,-2276.5 730,-2329.5"/>
<text text-anchor="middle" x="617" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="617" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="617" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge187" class="edge">
<title>reshape_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="black" d="M617,-2402.7C617,-2384.51 617,-2359.9 617,-2339.8"/>
<polygon fill="black" stroke="black" points="620.5,-2339.76 617,-2329.76 613.5,-2339.76 620.5,-2339.76"/>
</g>
<!-- attn_0_3_1&#45;&gt;proj_0_3_1 -->
<g id="edge188" class="edge">
<title>attn_0_3_1&#45;&gt;proj_0_3_1</title>
<path fill="none" stroke="black" d="M617,-2276.33C617,-2262.05 617,-2244.05 617,-2228.4"/>
<polygon fill="black" stroke="black" points="620.5,-2228.01 617,-2218.01 613.5,-2228.01 620.5,-2228.01"/>
</g>
<!-- qkv_0_3_2 -->
<g id="node76" class="node">
<title>qkv_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="449.5,-2546 296.5,-2546 296.5,-2493 449.5,-2493 449.5,-2546"/>
<text text-anchor="middle" x="373" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="373" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="373" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_0_3_2 -->
<g id="node77" class="node">
<title>reshape_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="454,-2456 292,-2456 292,-2403 454,-2403 454,-2456"/>
<text text-anchor="middle" x="373" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="373" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="373" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_0_3_2&#45;&gt;reshape_0_3_2 -->
<g id="edge189" class="edge">
<title>qkv_0_3_2&#45;&gt;reshape_0_3_2</title>
<path fill="none" stroke="black" d="M373,-2492.57C373,-2484.34 373,-2475.08 373,-2466.28"/>
<polygon fill="black" stroke="black" points="376.5,-2466.24 373,-2456.24 369.5,-2466.24 376.5,-2466.24"/>
</g>
<!-- attn_0_3_2 -->
<g id="node78" class="node">
<title>attn_0_3_2</title>
<polygon fill="lightgray" stroke="black" points="486,-2329.5 260,-2329.5 260,-2276.5 486,-2276.5 486,-2329.5"/>
<text text-anchor="middle" x="373" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="373" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="373" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge190" class="edge">
<title>reshape_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="black" d="M373,-2402.7C373,-2384.51 373,-2359.9 373,-2339.8"/>
<polygon fill="black" stroke="black" points="376.5,-2339.76 373,-2329.76 369.5,-2339.76 376.5,-2339.76"/>
</g>
<!-- attn_0_3_2&#45;&gt;proj_0_3_2 -->
<g id="edge191" class="edge">
<title>attn_0_3_2&#45;&gt;proj_0_3_2</title>
<path fill="none" stroke="black" d="M387.54,-2276.33C395.85,-2261.64 406.4,-2243.01 415.44,-2227.05"/>
<polygon fill="black" stroke="black" points="418.67,-2228.44 420.55,-2218.01 412.58,-2224.99 418.67,-2228.44"/>
</g>
<!-- qkv_0_3_3 -->
<g id="node79" class="node">
<title>qkv_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="205.5,-2546 52.5,-2546 52.5,-2493 205.5,-2493 205.5,-2546"/>
<text text-anchor="middle" x="129" y="-2530.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="129" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="129" y="-2500.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_0_3_3 -->
<g id="node80" class="node">
<title>reshape_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="210,-2456 48,-2456 48,-2403 210,-2403 210,-2456"/>
<text text-anchor="middle" x="129" y="-2440.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="129" y="-2425.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="129" y="-2410.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_0_3_3&#45;&gt;reshape_0_3_3 -->
<g id="edge192" class="edge">
<title>qkv_0_3_3&#45;&gt;reshape_0_3_3</title>
<path fill="none" stroke="black" d="M129,-2492.57C129,-2484.34 129,-2475.08 129,-2466.28"/>
<polygon fill="black" stroke="black" points="132.5,-2466.24 129,-2456.24 125.5,-2466.24 132.5,-2466.24"/>
</g>
<!-- attn_0_3_3 -->
<g id="node81" class="node">
<title>attn_0_3_3</title>
<polygon fill="lightcoral" stroke="black" points="242,-2329.5 16,-2329.5 16,-2276.5 242,-2276.5 242,-2329.5"/>
<text text-anchor="middle" x="129" y="-2314.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="129" y="-2299.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="129" y="-2284.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge193" class="edge">
<title>reshape_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="black" d="M129,-2402.7C129,-2384.51 129,-2359.9 129,-2339.8"/>
<polygon fill="black" stroke="black" points="132.5,-2339.76 129,-2329.76 125.5,-2339.76 132.5,-2339.76"/>
</g>
<!-- attn_0_3_3&#45;&gt;proj_0_3_3 -->
<g id="edge194" class="edge">
<title>attn_0_3_3&#45;&gt;proj_0_3_3</title>
<path fill="none" stroke="black" d="M153.15,-2276.33C167.35,-2261.23 185.47,-2241.97 200.76,-2225.72"/>
<polygon fill="black" stroke="black" points="203.7,-2227.69 208,-2218.01 198.6,-2222.9 203.7,-2227.69"/>
</g>
<!-- ln2_0 -->
<g id="node83" class="node">
<title>ln2_0</title>
<polygon fill="white" stroke="black" points="4600.5,-2546 4447.5,-2546 4447.5,-2493 4600.5,-2493 4600.5,-2546"/>
<text text-anchor="middle" x="4524" y="-2530.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4524" y="-2515.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="4524" y="-2500.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_0&#45;&gt;ln2_0 -->
<g id="edge195" class="edge">
<title>residual1_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M4517.78,-2582.57C4517.27,-2574.34 4517.13,-2565.08 4517.36,-2556.28"/>
<polygon fill="black" stroke="black" points="4520.85,-2556.39 4517.8,-2546.24 4513.86,-2556.08 4520.85,-2556.39"/>
</g>
<!-- residual1_0&#45;&gt;ln2_0 -->
<g id="edge215" class="edge">
<title>residual1_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M4530.22,-2582.57C4530.73,-2574.34 4530.87,-2565.08 4530.64,-2556.28"/>
<polygon fill="black" stroke="black" points="4534.14,-2556.08 4530.2,-2546.24 4527.15,-2556.39 4534.14,-2556.08"/>
</g>
<!-- ln2_0&#45;&gt;gate_0 -->
<g id="edge196" class="edge">
<title>ln2_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M4524,-2492.57C4524,-2484.34 4524,-2475.08 4524,-2466.28"/>
<polygon fill="black" stroke="black" points="4527.5,-2466.24 4524,-2456.24 4520.5,-2466.24 4527.5,-2466.24"/>
</g>
<!-- ln1_1 -->
<g id="node116" class="node">
<title>ln1_1</title>
<polygon fill="white" stroke="black" points="6203.5,-1989 6050.5,-1989 6050.5,-1936 6203.5,-1936 6203.5,-1989"/>
<text text-anchor="middle" x="6127" y="-1973.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6127" y="-1958.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="6127" y="-1943.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1 -->
<g id="edge218" class="edge">
<title>residual2_0&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M5126.59,-2077.75C5321.42,-2055.5 5834.93,-1996.86 6040.3,-1973.4"/>
<polygon fill="black" stroke="black" points="6040.9,-1976.86 6050.44,-1972.24 6040.11,-1969.9 6040.9,-1976.86"/>
</g>
<!-- residual1_1 -->
<g id="node165" class="node">
<title>residual1_1</title>
<polygon fill="orange" stroke="black" points="9394.5,-1989 9241.5,-1989 9241.5,-1936 9394.5,-1936 9394.5,-1989"/>
<text text-anchor="middle" x="9318" y="-1973.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9318" y="-1958.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="9318" y="-1943.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_0&#45;&gt;residual1_1 -->
<g id="edge287" class="edge">
<title>residual2_0&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M5126.8,-2084.29C5649.26,-2069.23 8676.95,-1981.97 9230.96,-1966.01"/>
<polygon fill="black" stroke="black" points="9231.38,-1969.5 9241.28,-1965.71 9231.18,-1962.5 9231.38,-1969.5"/>
</g>
<!-- residual2_1 -->
<g id="node167" class="node">
<title>residual2_1</title>
<polygon fill="orange" stroke="black" points="10261.5,-1467 10108.5,-1467 10108.5,-1414 10261.5,-1414 10261.5,-1467"/>
<text text-anchor="middle" x="10185" y="-1451.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10185" y="-1436.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="10185" y="-1421.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_0&#45;&gt;residual2_1 -->
<g id="edge290" class="edge">
<title>residual2_0&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M5126.65,-2086.72C5552.78,-2087.62 7673.19,-2088.36 9404,-2020 9601.14,-2012.21 10290,-2160.79 10290,-1963.5 10290,-1963.5 10290,-1963.5 10290,-1543.5 10290,-1513.83 10268.17,-1490.01 10244.41,-1472.88"/>
<polygon fill="black" stroke="black" points="10246.19,-1469.85 10235.96,-1467.09 10242.24,-1475.63 10246.19,-1469.85"/>
</g>
<!-- proj_1_0_0 -->
<g id="node85" class="node">
<title>proj_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="8906,-1571 8762,-1571 8762,-1518 8906,-1518 8906,-1571"/>
<text text-anchor="middle" x="8834" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8834" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="8834" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_1_0 -->
<g id="node86" class="node">
<title>concat_dim_1_0</title>
<polygon fill="lightsteelblue" stroke="black" points="8512.5,-1467 8359.5,-1467 8359.5,-1414 8512.5,-1414 8512.5,-1467"/>
<text text-anchor="middle" x="8436" y="-1451.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="8436" y="-1436.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="8436" y="-1421.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_1_0_0&#45;&gt;concat_dim_1_0 -->
<g id="edge37" class="edge">
<title>proj_1_0_0&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8781.66,-1517.87C8756.3,-1506.35 8725.11,-1493.48 8696,-1485 8639.36,-1468.51 8573.83,-1457.59 8522.74,-1450.82"/>
<polygon fill="black" stroke="black" points="8523.08,-1447.34 8512.72,-1449.52 8522.18,-1454.28 8523.08,-1447.34"/>
<text text-anchor="middle" x="8796" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_1 -->
<g id="node105" class="node">
<title>concat_heads_1</title>
<polygon fill="lightsteelblue" stroke="black" points="7126,-1342 6962,-1342 6962,-1289 7126,-1289 7126,-1342"/>
<text text-anchor="middle" x="7044" y="-1326.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="7044" y="-1311.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="7044" y="-1296.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_1 -->
<g id="edge53" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8359.18,-1432.71C8120.84,-1411.65 7394.54,-1347.47 7136.32,-1324.66"/>
<polygon fill="black" stroke="black" points="7136.49,-1321.16 7126.22,-1323.77 7135.88,-1328.13 7136.49,-1321.16"/>
<text text-anchor="middle" x="7949.5" y="-1384.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_1_0_1 -->
<g id="node87" class="node">
<title>proj_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8695,-1571 8551,-1571 8551,-1518 8695,-1518 8695,-1571"/>
<text text-anchor="middle" x="8623" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8623" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="8623" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_1_0_1&#45;&gt;concat_dim_1_0 -->
<g id="edge38" class="edge">
<title>proj_1_0_1&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8598.02,-1517.72C8586.11,-1506.52 8571.16,-1493.94 8556,-1485 8545.38,-1478.74 8533.71,-1473.14 8521.95,-1468.22"/>
<polygon fill="black" stroke="black" points="8523.1,-1464.91 8512.51,-1464.42 8520.48,-1471.4 8523.1,-1464.91"/>
<text text-anchor="middle" x="8634" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_1_0_2 -->
<g id="node88" class="node">
<title>proj_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="8508,-1571 8364,-1571 8364,-1518 8508,-1518 8508,-1571"/>
<text text-anchor="middle" x="8436" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8436" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="8436" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_1_0_2&#45;&gt;concat_dim_1_0 -->
<g id="edge39" class="edge">
<title>proj_1_0_2&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8436,-1517.76C8436,-1505.56 8436,-1490.78 8436,-1477.49"/>
<polygon fill="black" stroke="black" points="8439.5,-1477.23 8436,-1467.23 8432.5,-1477.23 8439.5,-1477.23"/>
<text text-anchor="middle" x="8494" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_1_0_3 -->
<g id="node89" class="node">
<title>proj_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8305,-1571 8161,-1571 8161,-1518 8305,-1518 8305,-1571"/>
<text text-anchor="middle" x="8233" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8233" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="8233" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_1_0_3&#45;&gt;concat_dim_1_0 -->
<g id="edge40" class="edge">
<title>proj_1_0_3&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8265.23,-1517.76C8280.1,-1506.69 8298.34,-1494.21 8316,-1485 8326.77,-1479.38 8338.44,-1474.17 8350.12,-1469.45"/>
<polygon fill="black" stroke="black" points="8351.44,-1472.69 8359.47,-1465.78 8348.88,-1466.18 8351.44,-1472.69"/>
<text text-anchor="middle" x="8374" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_1_1_0 -->
<g id="node90" class="node">
<title>proj_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="7930,-1571 7786,-1571 7786,-1518 7930,-1518 7930,-1571"/>
<text text-anchor="middle" x="7858" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7858" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7858" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_1_1 -->
<g id="node91" class="node">
<title>concat_dim_1_1</title>
<polygon fill="lightsteelblue" stroke="black" points="7536.5,-1467 7383.5,-1467 7383.5,-1414 7536.5,-1414 7536.5,-1467"/>
<text text-anchor="middle" x="7460" y="-1451.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="7460" y="-1436.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="7460" y="-1421.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_1_1_0&#45;&gt;concat_dim_1_1 -->
<g id="edge41" class="edge">
<title>proj_1_1_0&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7807.18,-1517.96C7782.33,-1506.39 7751.67,-1493.44 7723,-1485 7665.46,-1468.05 7598.77,-1457.12 7546.94,-1450.45"/>
<polygon fill="black" stroke="black" points="7547.14,-1446.95 7536.78,-1449.17 7546.27,-1453.89 7547.14,-1446.95"/>
<text text-anchor="middle" x="7822" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_1 -->
<g id="edge54" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7383.21,-1416.8C7313.34,-1396.14 7210.07,-1365.6 7135.85,-1343.66"/>
<polygon fill="black" stroke="black" points="7136.61,-1340.23 7126.03,-1340.75 7134.63,-1346.95 7136.61,-1340.23"/>
<text text-anchor="middle" x="7345.5" y="-1384.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_1_1_1 -->
<g id="node92" class="node">
<title>proj_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="7735,-1571 7591,-1571 7591,-1518 7735,-1518 7735,-1571"/>
<text text-anchor="middle" x="7663" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7663" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7663" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_1_1_1&#45;&gt;concat_dim_1_1 -->
<g id="edge42" class="edge">
<title>proj_1_1_1&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7630.77,-1517.76C7615.9,-1506.69 7597.66,-1494.21 7580,-1485 7569.23,-1479.38 7557.56,-1474.17 7545.88,-1469.45"/>
<polygon fill="black" stroke="black" points="7547.12,-1466.18 7536.53,-1465.78 7544.56,-1472.69 7547.12,-1466.18"/>
<text text-anchor="middle" x="7661" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_1_1_2 -->
<g id="node93" class="node">
<title>proj_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="7532,-1571 7388,-1571 7388,-1518 7532,-1518 7532,-1571"/>
<text text-anchor="middle" x="7460" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7460" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7460" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_1_1_2&#45;&gt;concat_dim_1_1 -->
<g id="edge43" class="edge">
<title>proj_1_1_2&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7460,-1517.76C7460,-1505.56 7460,-1490.78 7460,-1477.49"/>
<polygon fill="black" stroke="black" points="7463.5,-1477.23 7460,-1467.23 7456.5,-1477.23 7463.5,-1477.23"/>
<text text-anchor="middle" x="7518" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_1_1_3 -->
<g id="node94" class="node">
<title>proj_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="7329,-1571 7185,-1571 7185,-1518 7329,-1518 7329,-1571"/>
<text text-anchor="middle" x="7257" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7257" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="7257" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_1_1_3&#45;&gt;concat_dim_1_1 -->
<g id="edge44" class="edge">
<title>proj_1_1_3&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7289.23,-1517.76C7304.1,-1506.69 7322.34,-1494.21 7340,-1485 7350.77,-1479.38 7362.44,-1474.17 7374.12,-1469.45"/>
<polygon fill="black" stroke="black" points="7375.44,-1472.69 7383.47,-1465.78 7372.88,-1466.18 7375.44,-1472.69"/>
<text text-anchor="middle" x="7398" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_1_2_0 -->
<g id="node95" class="node">
<title>proj_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7003,-1571 6859,-1571 6859,-1518 7003,-1518 7003,-1571"/>
<text text-anchor="middle" x="6931" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6931" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6931" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_1_2 -->
<g id="node96" class="node">
<title>concat_dim_1_2</title>
<polygon fill="lightsteelblue" stroke="black" points="6804.5,-1467 6651.5,-1467 6651.5,-1414 6804.5,-1414 6804.5,-1467"/>
<text text-anchor="middle" x="6728" y="-1451.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6728" y="-1436.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="6728" y="-1421.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_1_2_0&#45;&gt;concat_dim_1_2 -->
<g id="edge45" class="edge">
<title>proj_1_2_0&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6898.77,-1517.76C6883.9,-1506.69 6865.66,-1494.21 6848,-1485 6837.23,-1479.38 6825.56,-1474.17 6813.88,-1469.45"/>
<polygon fill="black" stroke="black" points="6815.12,-1466.18 6804.53,-1465.78 6812.56,-1472.69 6815.12,-1466.18"/>
<text text-anchor="middle" x="6929" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_1 -->
<g id="edge55" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6793.86,-1413.86C6844.88,-1394.01 6915.6,-1366.48 6968.83,-1345.76"/>
<polygon fill="black" stroke="black" points="6970.18,-1348.99 6978.23,-1342.1 6967.64,-1342.47 6970.18,-1348.99"/>
<text text-anchor="middle" x="6920.5" y="-1384.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_1_2_1 -->
<g id="node97" class="node">
<title>proj_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6800,-1571 6656,-1571 6656,-1518 6800,-1518 6800,-1571"/>
<text text-anchor="middle" x="6728" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6728" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6728" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_1_2_1&#45;&gt;concat_dim_1_2 -->
<g id="edge46" class="edge">
<title>proj_1_2_1&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6728,-1517.76C6728,-1505.56 6728,-1490.78 6728,-1477.49"/>
<polygon fill="black" stroke="black" points="6731.5,-1477.23 6728,-1467.23 6724.5,-1477.23 6731.5,-1477.23"/>
<text text-anchor="middle" x="6786" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_1_2_2 -->
<g id="node98" class="node">
<title>proj_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6597,-1571 6453,-1571 6453,-1518 6597,-1518 6597,-1571"/>
<text text-anchor="middle" x="6525" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6525" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6525" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_1_2_2&#45;&gt;concat_dim_1_2 -->
<g id="edge47" class="edge">
<title>proj_1_2_2&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6552.55,-1517.98C6565.83,-1506.7 6582.45,-1493.98 6599,-1485 6612.38,-1477.74 6627.19,-1471.38 6641.86,-1465.93"/>
<polygon fill="black" stroke="black" points="6643.24,-1469.15 6651.47,-1462.48 6640.88,-1462.57 6643.24,-1469.15"/>
<text text-anchor="middle" x="6661.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_1_2_3 -->
<g id="node99" class="node">
<title>proj_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6353,-1571 6209,-1571 6209,-1518 6353,-1518 6353,-1571"/>
<text text-anchor="middle" x="6281" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6281" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="6281" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_1_2_3&#45;&gt;concat_dim_1_2 -->
<g id="edge48" class="edge">
<title>proj_1_2_3&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6345.19,-1517.92C6375.9,-1506.49 6413.43,-1493.66 6448,-1485 6511.9,-1468.99 6585.57,-1457.82 6641.3,-1450.82"/>
<polygon fill="black" stroke="black" points="6641.99,-1454.26 6651.49,-1449.56 6641.13,-1447.31 6641.99,-1454.26"/>
<text text-anchor="middle" x="6510.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_1_3_0 -->
<g id="node100" class="node">
<title>proj_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6006,-1571 5862,-1571 5862,-1518 6006,-1518 6006,-1571"/>
<text text-anchor="middle" x="5934" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5934" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5934" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_1_3 -->
<g id="node101" class="node">
<title>concat_dim_1_3</title>
<polygon fill="lightsteelblue" stroke="black" points="5828.5,-1467 5675.5,-1467 5675.5,-1414 5828.5,-1414 5828.5,-1467"/>
<text text-anchor="middle" x="5752" y="-1451.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="5752" y="-1436.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="5752" y="-1421.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_1_3_0&#45;&gt;concat_dim_1_3 -->
<g id="edge49" class="edge">
<title>proj_1_3_0&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5915.72,-1517.96C5906.43,-1506.54 5894.3,-1493.71 5881,-1485 5868.03,-1476.5 5853.23,-1469.5 5838.39,-1463.79"/>
<polygon fill="black" stroke="black" points="5839.25,-1460.38 5828.65,-1460.22 5836.84,-1466.95 5839.25,-1460.38"/>
<text text-anchor="middle" x="5961.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_1 -->
<g id="edge56" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5828.95,-1432.17C6053.62,-1410.79 6708.08,-1348.48 6951.44,-1325.31"/>
<polygon fill="black" stroke="black" points="6952.05,-1328.77 6961.67,-1324.34 6951.38,-1321.8 6952.05,-1328.77"/>
<text text-anchor="middle" x="6403.5" y="-1384.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_1_3_1 -->
<g id="node102" class="node">
<title>proj_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5824,-1571 5680,-1571 5680,-1518 5824,-1518 5824,-1571"/>
<text text-anchor="middle" x="5752" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5752" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5752" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_1_3_1&#45;&gt;concat_dim_1_3 -->
<g id="edge50" class="edge">
<title>proj_1_3_1&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5752,-1517.76C5752,-1505.56 5752,-1490.78 5752,-1477.49"/>
<polygon fill="black" stroke="black" points="5755.5,-1477.23 5752,-1467.23 5748.5,-1477.23 5755.5,-1477.23"/>
<text text-anchor="middle" x="5814.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_1_3_2 -->
<g id="node103" class="node">
<title>proj_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5621,-1571 5477,-1571 5477,-1518 5621,-1518 5621,-1571"/>
<text text-anchor="middle" x="5549" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5549" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5549" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_1_3_2&#45;&gt;concat_dim_1_3 -->
<g id="edge51" class="edge">
<title>proj_1_3_2&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5576.55,-1517.98C5589.83,-1506.7 5606.45,-1493.98 5623,-1485 5636.38,-1477.74 5651.19,-1471.38 5665.86,-1465.93"/>
<polygon fill="black" stroke="black" points="5667.24,-1469.15 5675.47,-1462.48 5664.88,-1462.57 5667.24,-1469.15"/>
<text text-anchor="middle" x="5685.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_1_3_3 -->
<g id="node104" class="node">
<title>proj_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5377,-1571 5233,-1571 5233,-1518 5377,-1518 5377,-1571"/>
<text text-anchor="middle" x="5305" y="-1555.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5305" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="5305" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_1_3_3&#45;&gt;concat_dim_1_3 -->
<g id="edge52" class="edge">
<title>proj_1_3_3&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5369.19,-1517.92C5399.9,-1506.49 5437.43,-1493.66 5472,-1485 5535.9,-1468.99 5609.57,-1457.82 5665.3,-1450.82"/>
<polygon fill="black" stroke="black" points="5665.99,-1454.26 5675.49,-1449.56 5665.13,-1447.31 5665.99,-1454.26"/>
<text text-anchor="middle" x="5534.5" y="-1488.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- gate_1 -->
<g id="node106" class="node">
<title>gate_1</title>
<polygon fill="gold" stroke="black" points="9696,-1809 9588,-1809 9588,-1756 9696,-1756 9696,-1809"/>
<text text-anchor="middle" x="9642" y="-1793.8" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="9642" y="-1778.8" font-family="Times,serif" font-size="14.00">[1048576, 8]</text>
<text text-anchor="middle" x="9642" y="-1763.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_1_0 -->
<g id="node107" class="node">
<title>expert_1_0</title>
<polygon fill="lightblue" stroke="black" points="9190.5,-1690 9055.5,-1690 9055.5,-1622 9190.5,-1622 9190.5,-1690"/>
<text text-anchor="middle" x="9123" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9123" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9123" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9123" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge57" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9587.65,-1782.04C9480.61,-1782.21 9247.01,-1777.83 9179,-1738 9163.61,-1728.99 9151.46,-1713.86 9142.47,-1699.11"/>
<polygon fill="red" stroke="red" points="9145.28,-1696.97 9137.28,-1690.03 9139.2,-1700.45 9145.28,-1696.97"/>
<text text-anchor="middle" x="9210.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9210.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge270" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9587.87,-1781.99C9517.31,-1781.04 9390.98,-1773.81 9290,-1738 9266.29,-1729.59 9264.29,-1719.66 9242,-1708 9241.92,-1707.96 9222.86,-1699.79 9200.02,-1690"/>
<polygon fill="black" stroke="black" points="9201.33,-1686.75 9190.76,-1686.03 9198.57,-1693.19 9201.33,-1686.75"/>
</g>
<!-- expert_1_1 -->
<g id="node108" class="node">
<title>expert_1_1</title>
<polygon fill="lightgreen" stroke="black" points="9343.5,-1690 9208.5,-1690 9208.5,-1622 9343.5,-1622 9343.5,-1690"/>
<text text-anchor="middle" x="9276" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9276" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9276" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9276" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge58" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9587.76,-1780.02C9507.58,-1776.86 9362.32,-1767.18 9320,-1738 9306.49,-1728.68 9296.74,-1713.84 9289.91,-1699.38"/>
<polygon fill="red" stroke="red" points="9293.03,-1697.78 9285.84,-1690 9286.61,-1700.57 9293.03,-1697.78"/>
<text text-anchor="middle" x="9351.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9351.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge272" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9587.75,-1775.29C9544.7,-1769.16 9483.57,-1757.78 9433,-1738 9408.86,-1728.56 9405.83,-1720.26 9383,-1708 9373.25,-1702.77 9362.88,-1697.49 9352.58,-1692.4"/>
<polygon fill="black" stroke="black" points="9354.08,-1689.24 9343.56,-1688 9351.01,-1695.53 9354.08,-1689.24"/>
</g>
<!-- expert_1_2 -->
<g id="node109" class="node">
<title>expert_1_2</title>
<polygon fill="lightyellow" stroke="black" points="9496.5,-1690 9361.5,-1690 9361.5,-1622 9496.5,-1622 9496.5,-1690"/>
<text text-anchor="middle" x="9429" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9429" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9429" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9429" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge59" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9587.78,-1774.75C9540,-1767.77 9475.11,-1755.43 9456,-1738 9445.25,-1728.19 9438.77,-1714 9434.87,-1700.22"/>
<polygon fill="red" stroke="red" points="9438.23,-1699.22 9432.47,-1690.33 9431.43,-1700.87 9438.23,-1699.22"/>
<text text-anchor="middle" x="9487.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9487.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge274" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9593.96,-1756C9583.64,-1750.26 9572.87,-1744.06 9563,-1738 9542.83,-1725.61 9539.09,-1720.51 9519,-1708 9512.25,-1703.79 9505.14,-1699.52 9497.99,-1695.32"/>
<polygon fill="black" stroke="black" points="9499.36,-1692.06 9488.95,-1690.06 9495.83,-1698.11 9499.36,-1692.06"/>
</g>
<!-- expert_1_3 -->
<g id="node110" class="node">
<title>expert_1_3</title>
<polygon fill="lightcoral" stroke="black" points="9649.5,-1690 9514.5,-1690 9514.5,-1622 9649.5,-1622 9649.5,-1690"/>
<text text-anchor="middle" x="9582" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9582" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9582" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9582" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge60" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9589.24,-1755.94C9583.14,-1750.84 9577.77,-1744.88 9574,-1738 9567.79,-1726.65 9567.04,-1713.07 9568.65,-1700.29"/>
<polygon fill="red" stroke="red" points="9572.12,-1700.73 9570.38,-1690.28 9565.23,-1699.54 9572.12,-1700.73"/>
<text text-anchor="middle" x="9605.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9605.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge276" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9644.79,-1755.83C9645.3,-1741.15 9644.05,-1722.77 9637,-1708 9635.39,-1704.63 9633.45,-1701.37 9631.28,-1698.25"/>
<polygon fill="black" stroke="black" points="9633.96,-1696 9625.03,-1690.3 9628.45,-1700.32 9633.96,-1696"/>
</g>
<!-- expert_1_4 -->
<g id="node111" class="node">
<title>expert_1_4</title>
<polygon fill="lightpink" stroke="black" points="9802.5,-1690 9667.5,-1690 9667.5,-1622 9802.5,-1622 9802.5,-1690"/>
<text text-anchor="middle" x="9735" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9735" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9735" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9735" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_1&#45;&gt;expert_1_4 -->
<g id="edge61" class="edge">
<title>gate_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9646.73,-1755.92C9650.43,-1740.92 9656.71,-1722.18 9667,-1708 9669.71,-1704.27 9672.76,-1700.69 9676.04,-1697.28"/>
<polygon fill="red" stroke="red" points="9678.74,-1699.55 9683.54,-1690.1 9673.9,-1694.49 9678.74,-1699.55"/>
<text text-anchor="middle" x="9698.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9698.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<!-- gate_1&#45;&gt;expert_1_4 -->
<g id="edge278" class="edge">
<title>gate_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9696.15,-1765.58C9709.29,-1759.12 9721.89,-1750.21 9730,-1738 9737.26,-1727.08 9739.9,-1713.38 9740.32,-1700.38"/>
<polygon fill="black" stroke="black" points="9743.82,-1700.13 9740.23,-1690.17 9736.82,-1700.2 9743.82,-1700.13"/>
</g>
<!-- expert_1_5 -->
<g id="node112" class="node">
<title>expert_1_5</title>
<polygon fill="lightcyan" stroke="black" points="9955.5,-1690 9820.5,-1690 9820.5,-1622 9955.5,-1622 9955.5,-1690"/>
<text text-anchor="middle" x="9888" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9888" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="9888" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="9888" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_1&#45;&gt;expert_1_5 -->
<g id="edge62" class="edge">
<title>gate_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9696.12,-1758.5C9710.23,-1752.16 9725.31,-1745.07 9739,-1738 9762.37,-1725.93 9767,-1720.74 9790,-1708 9797.82,-1703.67 9806.05,-1699.22 9814.27,-1694.84"/>
<polygon fill="red" stroke="red" points="9815.97,-1697.91 9823.17,-1690.13 9812.7,-1691.72 9815.97,-1697.91"/>
<text text-anchor="middle" x="9821.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9821.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<!-- gate_1&#45;&gt;expert_1_5 -->
<g id="edge280" class="edge">
<title>gate_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9696.2,-1776.04C9750.52,-1769.58 9829.39,-1757.21 9853,-1738 9864.87,-1728.34 9872.81,-1713.87 9878.08,-1699.83"/>
<polygon fill="black" stroke="black" points="9881.43,-1700.84 9881.31,-1690.24 9874.8,-1698.6 9881.43,-1700.84"/>
</g>
<!-- expert_1_6 -->
<g id="node113" class="node">
<title>expert_1_6</title>
<polygon fill="lightgrey" stroke="black" points="10108.5,-1690 9973.5,-1690 9973.5,-1622 10108.5,-1622 10108.5,-1690"/>
<text text-anchor="middle" x="10041" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10041" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="10041" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="10041" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_1&#45;&gt;expert_1_6 -->
<g id="edge63" class="edge">
<title>gate_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9696.03,-1775.33C9742.5,-1769.03 9810.86,-1757.37 9868,-1738 9896.24,-1728.43 9901.07,-1720.8 9928,-1708 9939.62,-1702.48 9951.97,-1696.75 9964.08,-1691.22"/>
<polygon fill="red" stroke="red" points="9965.62,-1694.37 9973.28,-1687.04 9962.73,-1687.99 9965.62,-1694.37"/>
<text text-anchor="middle" x="9959.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="9959.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<!-- gate_1&#45;&gt;expert_1_6 -->
<g id="edge282" class="edge">
<title>gate_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9696.33,-1780.37C9781.94,-1777.67 9943.41,-1768.56 9991,-1738 10005.39,-1728.76 10016.32,-1713.74 10024.24,-1699.14"/>
<polygon fill="black" stroke="black" points="10027.39,-1700.66 10028.78,-1690.15 10021.14,-1697.5 10027.39,-1700.66"/>
</g>
<!-- expert_1_7 -->
<g id="node114" class="node">
<title>expert_1_7</title>
<polygon fill="lightseagreen" stroke="black" points="10261.5,-1690 10126.5,-1690 10126.5,-1622 10261.5,-1622 10261.5,-1690"/>
<text text-anchor="middle" x="10194" y="-1674.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10194" y="-1659.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="10194" y="-1644.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="10194" y="-1629.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_1&#45;&gt;expert_1_7 -->
<g id="edge64" class="edge">
<title>gate_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9696.21,-1780.37C9768.74,-1777.66 9900.79,-1768.55 10009,-1738 10039.62,-1729.35 10044.82,-1720.69 10074,-1708 10090.95,-1700.62 10097.02,-1698.66 10117,-1690.38"/>
<polygon fill="red" stroke="red" points="10118.61,-1693.49 10126.49,-1686.4 10115.91,-1687.04 10118.61,-1693.49"/>
<text text-anchor="middle" x="10105.5" y="-1726.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="10105.5" y="-1711.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<!-- gate_1&#45;&gt;expert_1_7 -->
<g id="edge284" class="edge">
<title>gate_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9696.43,-1779.3C9817.12,-1774.04 10099.53,-1759.58 10137,-1738 10152.69,-1728.96 10165.12,-1713.65 10174.32,-1698.75"/>
<polygon fill="black" stroke="black" points="10177.36,-1700.49 10179.36,-1690.08 10171.3,-1696.97 10177.36,-1700.49"/>
</g>
<!-- expert_agg_1 -->
<g id="node115" class="node">
<title>expert_agg_1</title>
<polygon fill="lightsteelblue" stroke="black" points="9814,-1571 9656,-1571 9656,-1518 9814,-1518 9814,-1571"/>
<text text-anchor="middle" x="9735" y="-1555.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9735" y="-1540.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="9735" y="-1525.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_1_0&#45;&gt;expert_agg_1 -->
<g id="edge65" class="edge">
<title>expert_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9123.75,-1621.86C9125.8,-1609.74 9130.37,-1597.04 9140,-1589 9177.87,-1557.37 9489.07,-1548.73 9645.68,-1546.37"/>
<polygon fill="black" stroke="black" points="9645.82,-1549.87 9655.76,-1546.23 9645.71,-1542.87 9645.82,-1549.87"/>
<text text-anchor="middle" x="9191.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 0→Agg</text>
</g>
<!-- expert_1_0&#45;&gt;expert_agg_1 -->
<g id="edge271" class="edge">
<title>expert_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9190.59,-1625.99C9193.77,-1624.64 9196.92,-1623.3 9200,-1622 9219.08,-1613.92 9224.36,-1613.04 9243,-1604 9255.35,-1598.01 9256.89,-1593.06 9270,-1589 9337.86,-1568 9530.65,-1555.37 9645.57,-1549.49"/>
<polygon fill="black" stroke="black" points="9645.95,-1552.97 9655.76,-1548.97 9645.6,-1545.98 9645.95,-1552.97"/>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge66" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9271.47,-1621.75C9271.73,-1609.91 9274.49,-1597.43 9283,-1589 9308.2,-1564.05 9521.29,-1552.68 9645.69,-1548.13"/>
<polygon fill="black" stroke="black" points="9646.09,-1551.62 9655.96,-1547.76 9645.84,-1544.62 9646.09,-1551.62"/>
<text text-anchor="middle" x="9334.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 1→Agg</text>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge273" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9343.73,-1625.14C9361.4,-1617 9377.8,-1609.04 9386,-1604 9395.17,-1598.37 9395.09,-1593.19 9405,-1589 9447.09,-1571.22 9563.13,-1558.81 9645.67,-1551.91"/>
<polygon fill="black" stroke="black" points="9646.14,-1555.39 9655.82,-1551.08 9645.57,-1548.41 9646.14,-1555.39"/>
</g>
<!-- expert_1_2&#45;&gt;expert_agg_1 -->
<g id="edge67" class="edge">
<title>expert_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9412.04,-1621.83C9408.64,-1610.27 9408.17,-1597.97 9416,-1589 9445.32,-1555.41 9561.95,-1546.79 9645.71,-1545.07"/>
<polygon fill="black" stroke="black" points="9645.82,-1548.57 9655.75,-1544.89 9645.69,-1541.57 9645.82,-1548.57"/>
<text text-anchor="middle" x="9467.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 2→Agg</text>
</g>
<!-- expert_1_2&#45;&gt;expert_agg_1 -->
<g id="edge275" class="edge">
<title>expert_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9489.55,-1621.84C9499.49,-1616.07 9509.61,-1609.99 9519,-1604 9528.67,-1597.83 9529.53,-1593.68 9540,-1589 9573.15,-1574.2 9611.79,-1564.23 9645.89,-1557.62"/>
<polygon fill="black" stroke="black" points="9646.66,-1561.03 9655.85,-1555.75 9645.37,-1554.15 9646.66,-1561.03"/>
</g>
<!-- expert_1_3&#45;&gt;expert_agg_1 -->
<g id="edge68" class="edge">
<title>expert_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9550.89,-1621.85C9544.21,-1610.81 9541.2,-1598.84 9549,-1589 9561.59,-1573.12 9604.55,-1562.49 9646,-1555.72"/>
<polygon fill="black" stroke="black" points="9646.59,-1559.17 9655.93,-1554.16 9645.51,-1552.25 9646.59,-1559.17"/>
<text text-anchor="middle" x="9600.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 3→Agg</text>
</g>
<!-- expert_1_3&#45;&gt;expert_agg_1 -->
<g id="edge277" class="edge">
<title>expert_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9628.32,-1621.85C9648.18,-1607.64 9671.26,-1591.12 9690.87,-1577.08"/>
<polygon fill="black" stroke="black" points="9692.94,-1579.9 9699.04,-1571.24 9688.87,-1574.21 9692.94,-1579.9"/>
</g>
<!-- expert_1_4&#45;&gt;expert_agg_1 -->
<g id="edge69" class="edge">
<title>expert_1_4&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9693.12,-1621.7C9688.62,-1616.28 9684.7,-1610.35 9682,-1604 9678.18,-1595.02 9680.59,-1586.5 9686.05,-1578.89"/>
<polygon fill="black" stroke="black" points="9689.03,-1580.82 9693.04,-1571.01 9683.79,-1576.18 9689.03,-1580.82"/>
<text text-anchor="middle" x="9733.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 4→Agg</text>
</g>
<!-- expert_1_4&#45;&gt;expert_agg_1 -->
<g id="edge279" class="edge">
<title>expert_1_4&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9774.3,-1621.73C9778.64,-1616.27 9782.42,-1610.31 9785,-1604 9788.6,-1595.19 9786.32,-1586.75 9781.16,-1579.16"/>
<polygon fill="black" stroke="black" points="9783.67,-1576.71 9774.58,-1571.28 9778.3,-1581.2 9783.67,-1576.71"/>
</g>
<!-- expert_1_5&#45;&gt;expert_agg_1 -->
<g id="edge70" class="edge">
<title>expert_1_5&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9840.38,-1621.95C9831.91,-1616.01 9823.18,-1609.84 9815,-1604 9802.83,-1595.3 9789.7,-1585.76 9777.67,-1576.96"/>
<polygon fill="black" stroke="black" points="9779.67,-1574.09 9769.53,-1571 9775.53,-1579.74 9779.67,-1574.09"/>
<text text-anchor="middle" x="9866.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 5→Agg</text>
</g>
<!-- expert_1_5&#45;&gt;expert_agg_1 -->
<g id="edge281" class="edge">
<title>expert_1_5&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M9916.92,-1621.67C9923.04,-1610.62 9925.65,-1598.68 9918,-1589 9905.8,-1573.55 9864.5,-1563.01 9824.22,-1556.17"/>
<polygon fill="black" stroke="black" points="9824.73,-1552.71 9814.3,-1554.56 9823.6,-1559.62 9824.73,-1552.71"/>
</g>
<!-- expert_1_6&#45;&gt;expert_agg_1 -->
<g id="edge71" class="edge">
<title>expert_1_6&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9979.09,-1621.91C9968.64,-1616.08 9957.95,-1609.96 9948,-1604 9937.53,-1597.73 9936.23,-1593.77 9925,-1589 9893.24,-1575.52 9856.65,-1565.87 9824.1,-1559.15"/>
<polygon fill="black" stroke="black" points="9824.63,-1555.69 9814.14,-1557.16 9823.26,-1562.55 9824.63,-1555.69"/>
<text text-anchor="middle" x="9999.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 6→Agg</text>
</g>
<!-- expert_1_6&#45;&gt;expert_agg_1 -->
<g id="edge283" class="edge">
<title>expert_1_6&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M10055.94,-1621.76C10058.76,-1610.2 10058.77,-1597.91 10051,-1589 10022.09,-1555.84 9907.36,-1547.08 9824.46,-1545.21"/>
<polygon fill="black" stroke="black" points="9824.33,-1541.71 9814.26,-1545.01 9824.19,-1548.71 9824.33,-1541.71"/>
</g>
<!-- expert_1_7&#45;&gt;expert_agg_1 -->
<g id="edge72" class="edge">
<title>expert_1_7&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10126.4,-1624.47C10112.6,-1617.93 10098.25,-1610.9 10085,-1604 10073.17,-1597.83 10071.63,-1593.3 10059,-1589 9982.35,-1562.89 9890.5,-1552.37 9824.2,-1548.17"/>
<polygon fill="black" stroke="black" points="9824.39,-1544.68 9814.2,-1547.58 9823.97,-1551.67 9824.39,-1544.68"/>
<text text-anchor="middle" x="10136.5" y="-1592.8" font-family="Times,serif" font-size="14.00">Expert 7→Agg</text>
</g>
<!-- expert_1_7&#45;&gt;expert_agg_1 -->
<g id="edge285" class="edge">
<title>expert_1_7&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M10199.09,-1621.8C10199.01,-1609.97 10196.44,-1597.48 10188,-1589 10162.93,-1563.8 9949.29,-1552.54 9824.56,-1548.07"/>
<polygon fill="black" stroke="black" points="9824.38,-1544.56 9814.26,-1547.7 9824.13,-1551.55 9824.38,-1544.56"/>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge286" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M9814.23,-1524.31C9893.89,-1505.85 10016.26,-1478.12 10098.43,-1459.91"/>
<polygon fill="black" stroke="black" points="10099.24,-1463.32 10108.24,-1457.74 10097.72,-1456.48 10099.24,-1463.32"/>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge289" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M9814.22,-1526.71C9893.87,-1509.11 10016.23,-1481.4 10098.4,-1462.39"/>
<polygon fill="black" stroke="black" points="10099.26,-1465.79 10108.21,-1460.12 10097.68,-1458.97 10099.26,-1465.79"/>
</g>
<!-- qkv_1_0_0 -->
<g id="node117" class="node">
<title>qkv_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="8932.5,-1899 8779.5,-1899 8779.5,-1846 8932.5,-1846 8932.5,-1899"/>
<text text-anchor="middle" x="8856" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8856" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="8856" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;qkv_1_0_0 -->
<g id="edge219" class="edge">
<title>ln1_1&#45;&gt;qkv_1_0_0</title>
<path fill="none" stroke="black" d="M6203.52,-1960.84C6609.98,-1957.17 8507.28,-1938.07 8766,-1899 8767.08,-1898.84 8768.17,-1898.66 8769.27,-1898.48"/>
<polygon fill="black" stroke="black" points="8770.01,-1901.9 8779.2,-1896.64 8768.73,-1895.02 8770.01,-1901.9"/>
</g>
<!-- reshape_1_0_0 -->
<g id="node118" class="node">
<title>reshape_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="8978,-1809 8816,-1809 8816,-1756 8978,-1756 8978,-1809"/>
<text text-anchor="middle" x="8897" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="8897" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8897" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_1_0_0&#45;&gt;reshape_1_0_0 -->
<g id="edge220" class="edge">
<title>qkv_1_0_0&#45;&gt;reshape_1_0_0</title>
<path fill="none" stroke="black" d="M8868.08,-1845.57C8872.04,-1837.07 8876.51,-1827.48 8880.73,-1818.42"/>
<polygon fill="black" stroke="black" points="8883.96,-1819.78 8885.01,-1809.24 8877.61,-1816.83 8883.96,-1819.78"/>
</g>
<!-- attn_1_0_0 -->
<g id="node119" class="node">
<title>attn_1_0_0</title>
<polygon fill="lightblue" stroke="black" points="9037,-1682.5 8811,-1682.5 8811,-1629.5 9037,-1629.5 9037,-1682.5"/>
<text text-anchor="middle" x="8924" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8924" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8924" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge221" class="edge">
<title>reshape_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="black" d="M8902.59,-1755.7C8906.54,-1737.51 8911.88,-1712.9 8916.24,-1692.8"/>
<polygon fill="black" stroke="black" points="8919.71,-1693.28 8918.41,-1682.76 8912.87,-1691.79 8919.71,-1693.28"/>
</g>
<!-- attn_1_0_0&#45;&gt;proj_1_0_0 -->
<g id="edge222" class="edge">
<title>attn_1_0_0&#45;&gt;proj_1_0_0</title>
<path fill="none" stroke="black" d="M8902.9,-1629.33C8890.6,-1614.36 8874.94,-1595.32 8861.67,-1579.16"/>
<polygon fill="black" stroke="black" points="8864.02,-1576.52 8854.97,-1571.01 8858.61,-1580.96 8864.02,-1576.52"/>
</g>
<!-- qkv_1_0_1 -->
<g id="node120" class="node">
<title>qkv_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8756.5,-1899 8603.5,-1899 8603.5,-1846 8756.5,-1846 8756.5,-1899"/>
<text text-anchor="middle" x="8680" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8680" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="8680" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_1_0_1 -->
<g id="node121" class="node">
<title>reshape_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8761,-1809 8599,-1809 8599,-1756 8761,-1756 8761,-1809"/>
<text text-anchor="middle" x="8680" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="8680" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8680" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_1_0_1&#45;&gt;reshape_1_0_1 -->
<g id="edge223" class="edge">
<title>qkv_1_0_1&#45;&gt;reshape_1_0_1</title>
<path fill="none" stroke="black" d="M8680,-1845.57C8680,-1837.34 8680,-1828.08 8680,-1819.28"/>
<polygon fill="black" stroke="black" points="8683.5,-1819.24 8680,-1809.24 8676.5,-1819.24 8683.5,-1819.24"/>
</g>
<!-- attn_1_0_1 -->
<g id="node122" class="node">
<title>attn_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8793,-1682.5 8567,-1682.5 8567,-1629.5 8793,-1629.5 8793,-1682.5"/>
<text text-anchor="middle" x="8680" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8680" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8680" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge224" class="edge">
<title>reshape_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="black" d="M8680,-1755.7C8680,-1737.51 8680,-1712.9 8680,-1692.8"/>
<polygon fill="black" stroke="black" points="8683.5,-1692.76 8680,-1682.76 8676.5,-1692.76 8683.5,-1692.76"/>
</g>
<!-- attn_1_0_1&#45;&gt;proj_1_0_1 -->
<g id="edge225" class="edge">
<title>attn_1_0_1&#45;&gt;proj_1_0_1</title>
<path fill="none" stroke="black" d="M8666.64,-1629.33C8658.99,-1614.64 8649.29,-1596.01 8640.99,-1580.05"/>
<polygon fill="black" stroke="black" points="8644,-1578.27 8636.28,-1571.01 8637.79,-1581.5 8644,-1578.27"/>
</g>
<!-- qkv_1_0_2 -->
<g id="node123" class="node">
<title>qkv_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="8512.5,-1899 8359.5,-1899 8359.5,-1846 8512.5,-1846 8512.5,-1899"/>
<text text-anchor="middle" x="8436" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8436" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="8436" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_1_0_2 -->
<g id="node124" class="node">
<title>reshape_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="8517,-1809 8355,-1809 8355,-1756 8517,-1756 8517,-1809"/>
<text text-anchor="middle" x="8436" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="8436" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8436" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_1_0_2&#45;&gt;reshape_1_0_2 -->
<g id="edge226" class="edge">
<title>qkv_1_0_2&#45;&gt;reshape_1_0_2</title>
<path fill="none" stroke="black" d="M8436,-1845.57C8436,-1837.34 8436,-1828.08 8436,-1819.28"/>
<polygon fill="black" stroke="black" points="8439.5,-1819.24 8436,-1809.24 8432.5,-1819.24 8439.5,-1819.24"/>
</g>
<!-- attn_1_0_2 -->
<g id="node125" class="node">
<title>attn_1_0_2</title>
<polygon fill="lightyellow" stroke="black" points="8549,-1682.5 8323,-1682.5 8323,-1629.5 8549,-1629.5 8549,-1682.5"/>
<text text-anchor="middle" x="8436" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8436" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8436" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge227" class="edge">
<title>reshape_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="black" d="M8436,-1755.7C8436,-1737.51 8436,-1712.9 8436,-1692.8"/>
<polygon fill="black" stroke="black" points="8439.5,-1692.76 8436,-1682.76 8432.5,-1692.76 8439.5,-1692.76"/>
</g>
<!-- attn_1_0_2&#45;&gt;proj_1_0_2 -->
<g id="edge228" class="edge">
<title>attn_1_0_2&#45;&gt;proj_1_0_2</title>
<path fill="none" stroke="black" d="M8436,-1629.33C8436,-1615.05 8436,-1597.05 8436,-1581.4"/>
<polygon fill="black" stroke="black" points="8439.5,-1581.01 8436,-1571.01 8432.5,-1581.01 8439.5,-1581.01"/>
</g>
<!-- qkv_1_0_3 -->
<g id="node126" class="node">
<title>qkv_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8268.5,-1899 8115.5,-1899 8115.5,-1846 8268.5,-1846 8268.5,-1899"/>
<text text-anchor="middle" x="8192" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8192" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="8192" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_1_0_3 -->
<g id="node127" class="node">
<title>reshape_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8273,-1809 8111,-1809 8111,-1756 8273,-1756 8273,-1809"/>
<text text-anchor="middle" x="8192" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="8192" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8192" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_1_0_3&#45;&gt;reshape_1_0_3 -->
<g id="edge229" class="edge">
<title>qkv_1_0_3&#45;&gt;reshape_1_0_3</title>
<path fill="none" stroke="black" d="M8192,-1845.57C8192,-1837.34 8192,-1828.08 8192,-1819.28"/>
<polygon fill="black" stroke="black" points="8195.5,-1819.24 8192,-1809.24 8188.5,-1819.24 8195.5,-1819.24"/>
</g>
<!-- attn_1_0_3 -->
<g id="node128" class="node">
<title>attn_1_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8305,-1682.5 8079,-1682.5 8079,-1629.5 8305,-1629.5 8305,-1682.5"/>
<text text-anchor="middle" x="8192" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8192" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="8192" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge230" class="edge">
<title>reshape_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="black" d="M8192,-1755.7C8192,-1737.51 8192,-1712.9 8192,-1692.8"/>
<polygon fill="black" stroke="black" points="8195.5,-1692.76 8192,-1682.76 8188.5,-1692.76 8195.5,-1692.76"/>
</g>
<!-- attn_1_0_3&#45;&gt;proj_1_0_3 -->
<g id="edge231" class="edge">
<title>attn_1_0_3&#45;&gt;proj_1_0_3</title>
<path fill="none" stroke="black" d="M8201.61,-1629.33C8207.06,-1614.77 8213.96,-1596.36 8219.89,-1580.5"/>
<polygon fill="black" stroke="black" points="8223.22,-1581.6 8223.45,-1571.01 8216.66,-1579.15 8223.22,-1581.6"/>
</g>
<!-- qkv_1_1_0 -->
<g id="node129" class="node">
<title>qkv_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="8024.5,-1899 7871.5,-1899 7871.5,-1846 8024.5,-1846 8024.5,-1899"/>
<text text-anchor="middle" x="7948" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7948" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7948" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_1_1_0 -->
<g id="node130" class="node">
<title>reshape_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="8029,-1809 7867,-1809 7867,-1756 8029,-1756 8029,-1809"/>
<text text-anchor="middle" x="7948" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7948" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7948" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_1_1_0&#45;&gt;reshape_1_1_0 -->
<g id="edge232" class="edge">
<title>qkv_1_1_0&#45;&gt;reshape_1_1_0</title>
<path fill="none" stroke="black" d="M7948,-1845.57C7948,-1837.34 7948,-1828.08 7948,-1819.28"/>
<polygon fill="black" stroke="black" points="7951.5,-1819.24 7948,-1809.24 7944.5,-1819.24 7951.5,-1819.24"/>
</g>
<!-- attn_1_1_0 -->
<g id="node131" class="node">
<title>attn_1_1_0</title>
<polygon fill="lightpink" stroke="black" points="8061,-1682.5 7835,-1682.5 7835,-1629.5 8061,-1629.5 8061,-1682.5"/>
<text text-anchor="middle" x="7948" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7948" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7948" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge233" class="edge">
<title>reshape_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="black" d="M7948,-1755.7C7948,-1737.51 7948,-1712.9 7948,-1692.8"/>
<polygon fill="black" stroke="black" points="7951.5,-1692.76 7948,-1682.76 7944.5,-1692.76 7951.5,-1692.76"/>
</g>
<!-- attn_1_1_0&#45;&gt;proj_1_1_0 -->
<g id="edge234" class="edge">
<title>attn_1_1_0&#45;&gt;proj_1_1_0</title>
<path fill="none" stroke="black" d="M7926.9,-1629.33C7914.6,-1614.36 7898.94,-1595.32 7885.67,-1579.16"/>
<polygon fill="black" stroke="black" points="7888.02,-1576.52 7878.97,-1571.01 7882.61,-1580.96 7888.02,-1576.52"/>
</g>
<!-- qkv_1_1_1 -->
<g id="node132" class="node">
<title>qkv_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="7780.5,-1899 7627.5,-1899 7627.5,-1846 7780.5,-1846 7780.5,-1899"/>
<text text-anchor="middle" x="7704" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7704" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7704" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_1_1_1 -->
<g id="node133" class="node">
<title>reshape_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="7785,-1809 7623,-1809 7623,-1756 7785,-1756 7785,-1809"/>
<text text-anchor="middle" x="7704" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7704" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7704" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_1_1_1&#45;&gt;reshape_1_1_1 -->
<g id="edge235" class="edge">
<title>qkv_1_1_1&#45;&gt;reshape_1_1_1</title>
<path fill="none" stroke="black" d="M7704,-1845.57C7704,-1837.34 7704,-1828.08 7704,-1819.28"/>
<polygon fill="black" stroke="black" points="7707.5,-1819.24 7704,-1809.24 7700.5,-1819.24 7707.5,-1819.24"/>
</g>
<!-- attn_1_1_1 -->
<g id="node134" class="node">
<title>attn_1_1_1</title>
<polygon fill="lightcyan" stroke="black" points="7817,-1682.5 7591,-1682.5 7591,-1629.5 7817,-1629.5 7817,-1682.5"/>
<text text-anchor="middle" x="7704" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7704" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7704" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge236" class="edge">
<title>reshape_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="black" d="M7704,-1755.7C7704,-1737.51 7704,-1712.9 7704,-1692.8"/>
<polygon fill="black" stroke="black" points="7707.5,-1692.76 7704,-1682.76 7700.5,-1692.76 7707.5,-1692.76"/>
</g>
<!-- attn_1_1_1&#45;&gt;proj_1_1_1 -->
<g id="edge237" class="edge">
<title>attn_1_1_1&#45;&gt;proj_1_1_1</title>
<path fill="none" stroke="black" d="M7694.39,-1629.33C7688.94,-1614.77 7682.04,-1596.36 7676.11,-1580.5"/>
<polygon fill="black" stroke="black" points="7679.34,-1579.15 7672.55,-1571.01 7672.78,-1581.6 7679.34,-1579.15"/>
</g>
<!-- qkv_1_1_2 -->
<g id="node135" class="node">
<title>qkv_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="7536.5,-1899 7383.5,-1899 7383.5,-1846 7536.5,-1846 7536.5,-1899"/>
<text text-anchor="middle" x="7460" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7460" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7460" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_1_1_2 -->
<g id="node136" class="node">
<title>reshape_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="7541,-1809 7379,-1809 7379,-1756 7541,-1756 7541,-1809"/>
<text text-anchor="middle" x="7460" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7460" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7460" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_1_1_2&#45;&gt;reshape_1_1_2 -->
<g id="edge238" class="edge">
<title>qkv_1_1_2&#45;&gt;reshape_1_1_2</title>
<path fill="none" stroke="black" d="M7460,-1845.57C7460,-1837.34 7460,-1828.08 7460,-1819.28"/>
<polygon fill="black" stroke="black" points="7463.5,-1819.24 7460,-1809.24 7456.5,-1819.24 7463.5,-1819.24"/>
</g>
<!-- attn_1_1_2 -->
<g id="node137" class="node">
<title>attn_1_1_2</title>
<polygon fill="lightgrey" stroke="black" points="7573,-1682.5 7347,-1682.5 7347,-1629.5 7573,-1629.5 7573,-1682.5"/>
<text text-anchor="middle" x="7460" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7460" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7460" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge239" class="edge">
<title>reshape_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="black" d="M7460,-1755.7C7460,-1737.51 7460,-1712.9 7460,-1692.8"/>
<polygon fill="black" stroke="black" points="7463.5,-1692.76 7460,-1682.76 7456.5,-1692.76 7463.5,-1692.76"/>
</g>
<!-- attn_1_1_2&#45;&gt;proj_1_1_2 -->
<g id="edge240" class="edge">
<title>attn_1_1_2&#45;&gt;proj_1_1_2</title>
<path fill="none" stroke="black" d="M7460,-1629.33C7460,-1615.05 7460,-1597.05 7460,-1581.4"/>
<polygon fill="black" stroke="black" points="7463.5,-1581.01 7460,-1571.01 7456.5,-1581.01 7463.5,-1581.01"/>
</g>
<!-- qkv_1_1_3 -->
<g id="node138" class="node">
<title>qkv_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="7292.5,-1899 7139.5,-1899 7139.5,-1846 7292.5,-1846 7292.5,-1899"/>
<text text-anchor="middle" x="7216" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7216" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="7216" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_1_1_3 -->
<g id="node139" class="node">
<title>reshape_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="7297,-1809 7135,-1809 7135,-1756 7297,-1756 7297,-1809"/>
<text text-anchor="middle" x="7216" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="7216" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7216" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_1_1_3&#45;&gt;reshape_1_1_3 -->
<g id="edge241" class="edge">
<title>qkv_1_1_3&#45;&gt;reshape_1_1_3</title>
<path fill="none" stroke="black" d="M7216,-1845.57C7216,-1837.34 7216,-1828.08 7216,-1819.28"/>
<polygon fill="black" stroke="black" points="7219.5,-1819.24 7216,-1809.24 7212.5,-1819.24 7219.5,-1819.24"/>
</g>
<!-- attn_1_1_3 -->
<g id="node140" class="node">
<title>attn_1_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="7329,-1682.5 7103,-1682.5 7103,-1629.5 7329,-1629.5 7329,-1682.5"/>
<text text-anchor="middle" x="7216" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7216" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="7216" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge242" class="edge">
<title>reshape_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="black" d="M7216,-1755.7C7216,-1737.51 7216,-1712.9 7216,-1692.8"/>
<polygon fill="black" stroke="black" points="7219.5,-1692.76 7216,-1682.76 7212.5,-1692.76 7219.5,-1692.76"/>
</g>
<!-- attn_1_1_3&#45;&gt;proj_1_1_3 -->
<g id="edge243" class="edge">
<title>attn_1_1_3&#45;&gt;proj_1_1_3</title>
<path fill="none" stroke="black" d="M7225.61,-1629.33C7231.06,-1614.77 7237.96,-1596.36 7243.89,-1580.5"/>
<polygon fill="black" stroke="black" points="7247.22,-1581.6 7247.45,-1571.01 7240.66,-1579.15 7247.22,-1581.6"/>
</g>
<!-- qkv_1_2_0 -->
<g id="node141" class="node">
<title>qkv_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7048.5,-1899 6895.5,-1899 6895.5,-1846 7048.5,-1846 7048.5,-1899"/>
<text text-anchor="middle" x="6972" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6972" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6972" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_1_2_0 -->
<g id="node142" class="node">
<title>reshape_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7053,-1809 6891,-1809 6891,-1756 7053,-1756 7053,-1809"/>
<text text-anchor="middle" x="6972" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6972" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6972" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_1_2_0&#45;&gt;reshape_1_2_0 -->
<g id="edge244" class="edge">
<title>qkv_1_2_0&#45;&gt;reshape_1_2_0</title>
<path fill="none" stroke="black" d="M6972,-1845.57C6972,-1837.34 6972,-1828.08 6972,-1819.28"/>
<polygon fill="black" stroke="black" points="6975.5,-1819.24 6972,-1809.24 6968.5,-1819.24 6975.5,-1819.24"/>
</g>
<!-- attn_1_2_0 -->
<g id="node143" class="node">
<title>attn_1_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="7085,-1682.5 6859,-1682.5 6859,-1629.5 7085,-1629.5 7085,-1682.5"/>
<text text-anchor="middle" x="6972" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6972" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6972" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge245" class="edge">
<title>reshape_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="black" d="M6972,-1755.7C6972,-1737.51 6972,-1712.9 6972,-1692.8"/>
<polygon fill="black" stroke="black" points="6975.5,-1692.76 6972,-1682.76 6968.5,-1692.76 6975.5,-1692.76"/>
</g>
<!-- attn_1_2_0&#45;&gt;proj_1_2_0 -->
<g id="edge246" class="edge">
<title>attn_1_2_0&#45;&gt;proj_1_2_0</title>
<path fill="none" stroke="black" d="M6962.39,-1629.33C6956.94,-1614.77 6950.04,-1596.36 6944.11,-1580.5"/>
<polygon fill="black" stroke="black" points="6947.34,-1579.15 6940.55,-1571.01 6940.78,-1581.6 6947.34,-1579.15"/>
</g>
<!-- qkv_1_2_1 -->
<g id="node144" class="node">
<title>qkv_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6804.5,-1899 6651.5,-1899 6651.5,-1846 6804.5,-1846 6804.5,-1899"/>
<text text-anchor="middle" x="6728" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6728" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6728" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_1_2_1 -->
<g id="node145" class="node">
<title>reshape_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6809,-1809 6647,-1809 6647,-1756 6809,-1756 6809,-1809"/>
<text text-anchor="middle" x="6728" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6728" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6728" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_1_2_1&#45;&gt;reshape_1_2_1 -->
<g id="edge247" class="edge">
<title>qkv_1_2_1&#45;&gt;reshape_1_2_1</title>
<path fill="none" stroke="black" d="M6728,-1845.57C6728,-1837.34 6728,-1828.08 6728,-1819.28"/>
<polygon fill="black" stroke="black" points="6731.5,-1819.24 6728,-1809.24 6724.5,-1819.24 6731.5,-1819.24"/>
</g>
<!-- attn_1_2_1 -->
<g id="node146" class="node">
<title>attn_1_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="6841,-1682.5 6615,-1682.5 6615,-1629.5 6841,-1629.5 6841,-1682.5"/>
<text text-anchor="middle" x="6728" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6728" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6728" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge248" class="edge">
<title>reshape_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="black" d="M6728,-1755.7C6728,-1737.51 6728,-1712.9 6728,-1692.8"/>
<polygon fill="black" stroke="black" points="6731.5,-1692.76 6728,-1682.76 6724.5,-1692.76 6731.5,-1692.76"/>
</g>
<!-- attn_1_2_1&#45;&gt;proj_1_2_1 -->
<g id="edge249" class="edge">
<title>attn_1_2_1&#45;&gt;proj_1_2_1</title>
<path fill="none" stroke="black" d="M6728,-1629.33C6728,-1615.05 6728,-1597.05 6728,-1581.4"/>
<polygon fill="black" stroke="black" points="6731.5,-1581.01 6728,-1571.01 6724.5,-1581.01 6731.5,-1581.01"/>
</g>
<!-- qkv_1_2_2 -->
<g id="node147" class="node">
<title>qkv_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6560.5,-1899 6407.5,-1899 6407.5,-1846 6560.5,-1846 6560.5,-1899"/>
<text text-anchor="middle" x="6484" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6484" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6484" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_1_2_2 -->
<g id="node148" class="node">
<title>reshape_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6565,-1809 6403,-1809 6403,-1756 6565,-1756 6565,-1809"/>
<text text-anchor="middle" x="6484" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6484" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6484" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_1_2_2&#45;&gt;reshape_1_2_2 -->
<g id="edge250" class="edge">
<title>qkv_1_2_2&#45;&gt;reshape_1_2_2</title>
<path fill="none" stroke="black" d="M6484,-1845.57C6484,-1837.34 6484,-1828.08 6484,-1819.28"/>
<polygon fill="black" stroke="black" points="6487.5,-1819.24 6484,-1809.24 6480.5,-1819.24 6487.5,-1819.24"/>
</g>
<!-- attn_1_2_2 -->
<g id="node149" class="node">
<title>attn_1_2_2</title>
<polygon fill="lightslategray" stroke="black" points="6597,-1682.5 6371,-1682.5 6371,-1629.5 6597,-1629.5 6597,-1682.5"/>
<text text-anchor="middle" x="6484" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6484" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6484" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge251" class="edge">
<title>reshape_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="black" d="M6484,-1755.7C6484,-1737.51 6484,-1712.9 6484,-1692.8"/>
<polygon fill="black" stroke="black" points="6487.5,-1692.76 6484,-1682.76 6480.5,-1692.76 6487.5,-1692.76"/>
</g>
<!-- attn_1_2_2&#45;&gt;proj_1_2_2 -->
<g id="edge252" class="edge">
<title>attn_1_2_2&#45;&gt;proj_1_2_2</title>
<path fill="none" stroke="black" d="M6493.61,-1629.33C6499.06,-1614.77 6505.96,-1596.36 6511.89,-1580.5"/>
<polygon fill="black" stroke="black" points="6515.22,-1581.6 6515.45,-1571.01 6508.66,-1579.15 6515.22,-1581.6"/>
</g>
<!-- qkv_1_2_3 -->
<g id="node150" class="node">
<title>qkv_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6316.5,-1899 6163.5,-1899 6163.5,-1846 6316.5,-1846 6316.5,-1899"/>
<text text-anchor="middle" x="6240" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6240" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="6240" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_1_2_3 -->
<g id="node151" class="node">
<title>reshape_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6321,-1809 6159,-1809 6159,-1756 6321,-1756 6321,-1809"/>
<text text-anchor="middle" x="6240" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="6240" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6240" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_1_2_3&#45;&gt;reshape_1_2_3 -->
<g id="edge253" class="edge">
<title>qkv_1_2_3&#45;&gt;reshape_1_2_3</title>
<path fill="none" stroke="black" d="M6240,-1845.57C6240,-1837.34 6240,-1828.08 6240,-1819.28"/>
<polygon fill="black" stroke="black" points="6243.5,-1819.24 6240,-1809.24 6236.5,-1819.24 6243.5,-1819.24"/>
</g>
<!-- attn_1_2_3 -->
<g id="node152" class="node">
<title>attn_1_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="6353,-1682.5 6127,-1682.5 6127,-1629.5 6353,-1629.5 6353,-1682.5"/>
<text text-anchor="middle" x="6240" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6240" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="6240" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge254" class="edge">
<title>reshape_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="black" d="M6240,-1755.7C6240,-1737.51 6240,-1712.9 6240,-1692.8"/>
<polygon fill="black" stroke="black" points="6243.5,-1692.76 6240,-1682.76 6236.5,-1692.76 6243.5,-1692.76"/>
</g>
<!-- attn_1_2_3&#45;&gt;proj_1_2_3 -->
<g id="edge255" class="edge">
<title>attn_1_2_3&#45;&gt;proj_1_2_3</title>
<path fill="none" stroke="black" d="M6249.61,-1629.33C6255.06,-1614.77 6261.96,-1596.36 6267.89,-1580.5"/>
<polygon fill="black" stroke="black" points="6271.22,-1581.6 6271.45,-1571.01 6264.66,-1579.15 6271.22,-1581.6"/>
</g>
<!-- qkv_1_3_0 -->
<g id="node153" class="node">
<title>qkv_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6072.5,-1899 5919.5,-1899 5919.5,-1846 6072.5,-1846 6072.5,-1899"/>
<text text-anchor="middle" x="5996" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5996" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5996" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_1_3_0 -->
<g id="node154" class="node">
<title>reshape_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6077,-1809 5915,-1809 5915,-1756 6077,-1756 6077,-1809"/>
<text text-anchor="middle" x="5996" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5996" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5996" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_1_3_0&#45;&gt;reshape_1_3_0 -->
<g id="edge256" class="edge">
<title>qkv_1_3_0&#45;&gt;reshape_1_3_0</title>
<path fill="none" stroke="black" d="M5996,-1845.57C5996,-1837.34 5996,-1828.08 5996,-1819.28"/>
<polygon fill="black" stroke="black" points="5999.5,-1819.24 5996,-1809.24 5992.5,-1819.24 5999.5,-1819.24"/>
</g>
<!-- attn_1_3_0 -->
<g id="node155" class="node">
<title>attn_1_3_0</title>
<polygon fill="#eedd82" stroke="black" points="6109,-1682.5 5883,-1682.5 5883,-1629.5 6109,-1629.5 6109,-1682.5"/>
<text text-anchor="middle" x="5996" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5996" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5996" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge257" class="edge">
<title>reshape_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="black" d="M5996,-1755.7C5996,-1737.51 5996,-1712.9 5996,-1692.8"/>
<polygon fill="black" stroke="black" points="5999.5,-1692.76 5996,-1682.76 5992.5,-1692.76 5999.5,-1692.76"/>
</g>
<!-- attn_1_3_0&#45;&gt;proj_1_3_0 -->
<g id="edge258" class="edge">
<title>attn_1_3_0&#45;&gt;proj_1_3_0</title>
<path fill="none" stroke="black" d="M5981.46,-1629.33C5973.15,-1614.64 5962.6,-1596.01 5953.56,-1580.05"/>
<polygon fill="black" stroke="black" points="5956.42,-1577.99 5948.45,-1571.01 5950.33,-1581.44 5956.42,-1577.99"/>
</g>
<!-- qkv_1_3_1 -->
<g id="node156" class="node">
<title>qkv_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5828.5,-1899 5675.5,-1899 5675.5,-1846 5828.5,-1846 5828.5,-1899"/>
<text text-anchor="middle" x="5752" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5752" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5752" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_1_3_1 -->
<g id="node157" class="node">
<title>reshape_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5833,-1809 5671,-1809 5671,-1756 5833,-1756 5833,-1809"/>
<text text-anchor="middle" x="5752" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5752" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5752" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_1_3_1&#45;&gt;reshape_1_3_1 -->
<g id="edge259" class="edge">
<title>qkv_1_3_1&#45;&gt;reshape_1_3_1</title>
<path fill="none" stroke="black" d="M5752,-1845.57C5752,-1837.34 5752,-1828.08 5752,-1819.28"/>
<polygon fill="black" stroke="black" points="5755.5,-1819.24 5752,-1809.24 5748.5,-1819.24 5755.5,-1819.24"/>
</g>
<!-- attn_1_3_1 -->
<g id="node158" class="node">
<title>attn_1_3_1</title>
<polygon fill="lightcyan" stroke="black" points="5865,-1682.5 5639,-1682.5 5639,-1629.5 5865,-1629.5 5865,-1682.5"/>
<text text-anchor="middle" x="5752" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5752" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5752" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge260" class="edge">
<title>reshape_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="black" d="M5752,-1755.7C5752,-1737.51 5752,-1712.9 5752,-1692.8"/>
<polygon fill="black" stroke="black" points="5755.5,-1692.76 5752,-1682.76 5748.5,-1692.76 5755.5,-1692.76"/>
</g>
<!-- attn_1_3_1&#45;&gt;proj_1_3_1 -->
<g id="edge261" class="edge">
<title>attn_1_3_1&#45;&gt;proj_1_3_1</title>
<path fill="none" stroke="black" d="M5752,-1629.33C5752,-1615.05 5752,-1597.05 5752,-1581.4"/>
<polygon fill="black" stroke="black" points="5755.5,-1581.01 5752,-1571.01 5748.5,-1581.01 5755.5,-1581.01"/>
</g>
<!-- qkv_1_3_2 -->
<g id="node159" class="node">
<title>qkv_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5584.5,-1899 5431.5,-1899 5431.5,-1846 5584.5,-1846 5584.5,-1899"/>
<text text-anchor="middle" x="5508" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5508" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5508" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_1_3_2 -->
<g id="node160" class="node">
<title>reshape_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5589,-1809 5427,-1809 5427,-1756 5589,-1756 5589,-1809"/>
<text text-anchor="middle" x="5508" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5508" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5508" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_1_3_2&#45;&gt;reshape_1_3_2 -->
<g id="edge262" class="edge">
<title>qkv_1_3_2&#45;&gt;reshape_1_3_2</title>
<path fill="none" stroke="black" d="M5508,-1845.57C5508,-1837.34 5508,-1828.08 5508,-1819.28"/>
<polygon fill="black" stroke="black" points="5511.5,-1819.24 5508,-1809.24 5504.5,-1819.24 5511.5,-1819.24"/>
</g>
<!-- attn_1_3_2 -->
<g id="node161" class="node">
<title>attn_1_3_2</title>
<polygon fill="lightgray" stroke="black" points="5621,-1682.5 5395,-1682.5 5395,-1629.5 5621,-1629.5 5621,-1682.5"/>
<text text-anchor="middle" x="5508" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5508" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5508" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge263" class="edge">
<title>reshape_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="black" d="M5508,-1755.7C5508,-1737.51 5508,-1712.9 5508,-1692.8"/>
<polygon fill="black" stroke="black" points="5511.5,-1692.76 5508,-1682.76 5504.5,-1692.76 5511.5,-1692.76"/>
</g>
<!-- attn_1_3_2&#45;&gt;proj_1_3_2 -->
<g id="edge264" class="edge">
<title>attn_1_3_2&#45;&gt;proj_1_3_2</title>
<path fill="none" stroke="black" d="M5517.61,-1629.33C5523.06,-1614.77 5529.96,-1596.36 5535.89,-1580.5"/>
<polygon fill="black" stroke="black" points="5539.22,-1581.6 5539.45,-1571.01 5532.66,-1579.15 5539.22,-1581.6"/>
</g>
<!-- qkv_1_3_3 -->
<g id="node162" class="node">
<title>qkv_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5340.5,-1899 5187.5,-1899 5187.5,-1846 5340.5,-1846 5340.5,-1899"/>
<text text-anchor="middle" x="5264" y="-1883.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5264" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="5264" y="-1853.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_1_3_3 -->
<g id="node163" class="node">
<title>reshape_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5345,-1809 5183,-1809 5183,-1756 5345,-1756 5345,-1809"/>
<text text-anchor="middle" x="5264" y="-1793.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="5264" y="-1778.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5264" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_1_3_3&#45;&gt;reshape_1_3_3 -->
<g id="edge265" class="edge">
<title>qkv_1_3_3&#45;&gt;reshape_1_3_3</title>
<path fill="none" stroke="black" d="M5264,-1845.57C5264,-1837.34 5264,-1828.08 5264,-1819.28"/>
<polygon fill="black" stroke="black" points="5267.5,-1819.24 5264,-1809.24 5260.5,-1819.24 5267.5,-1819.24"/>
</g>
<!-- attn_1_3_3 -->
<g id="node164" class="node">
<title>attn_1_3_3</title>
<polygon fill="lightcoral" stroke="black" points="5377,-1682.5 5151,-1682.5 5151,-1629.5 5377,-1629.5 5377,-1682.5"/>
<text text-anchor="middle" x="5264" y="-1667.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5264" y="-1652.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="5264" y="-1637.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge266" class="edge">
<title>reshape_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="black" d="M5264,-1755.7C5264,-1737.51 5264,-1712.9 5264,-1692.8"/>
<polygon fill="black" stroke="black" points="5267.5,-1692.76 5264,-1682.76 5260.5,-1692.76 5267.5,-1692.76"/>
</g>
<!-- attn_1_3_3&#45;&gt;proj_1_3_3 -->
<g id="edge267" class="edge">
<title>attn_1_3_3&#45;&gt;proj_1_3_3</title>
<path fill="none" stroke="black" d="M5273.61,-1629.33C5279.06,-1614.77 5285.96,-1596.36 5291.89,-1580.5"/>
<polygon fill="black" stroke="black" points="5295.22,-1581.6 5295.45,-1571.01 5288.66,-1579.15 5295.22,-1581.6"/>
</g>
<!-- ln2_1 -->
<g id="node166" class="node">
<title>ln2_1</title>
<polygon fill="white" stroke="black" points="9394.5,-1899 9241.5,-1899 9241.5,-1846 9394.5,-1846 9394.5,-1899"/>
<text text-anchor="middle" x="9318" y="-1883.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9318" y="-1868.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="9318" y="-1853.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge268" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M9311.78,-1935.57C9311.27,-1927.34 9311.13,-1918.08 9311.36,-1909.28"/>
<polygon fill="black" stroke="black" points="9314.85,-1909.39 9311.8,-1899.24 9307.86,-1909.08 9314.85,-1909.39"/>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge288" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M9324.22,-1935.57C9324.73,-1927.34 9324.87,-1918.08 9324.64,-1909.28"/>
<polygon fill="black" stroke="black" points="9328.14,-1909.08 9324.2,-1899.24 9321.15,-1909.39 9328.14,-1909.08"/>
</g>
<!-- ln2_1&#45;&gt;gate_1 -->
<g id="edge269" class="edge">
<title>ln2_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M9394.78,-1850.65C9450.51,-1835.51 9525.05,-1815.26 9577.66,-1800.97"/>
<polygon fill="black" stroke="black" points="9578.82,-1804.29 9587.55,-1798.29 9576.98,-1797.53 9578.82,-1804.29"/>
</g>
<!-- ln1_2 -->
<g id="node199" class="node">
<title>ln1_2</title>
<polygon fill="white" stroke="black" points="12255.5,-1342 12102.5,-1342 12102.5,-1289 12255.5,-1289 12255.5,-1342"/>
<text text-anchor="middle" x="12179" y="-1326.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12179" y="-1311.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="12179" y="-1296.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2 -->
<g id="edge291" class="edge">
<title>residual2_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M10261.64,-1434.77C10575.33,-1415.42 11760.43,-1342.32 12092.21,-1321.85"/>
<polygon fill="black" stroke="black" points="12092.48,-1325.34 12102.24,-1321.23 12092.05,-1318.36 12092.48,-1325.34"/>
</g>
<!-- residual1_2 -->
<g id="node248" class="node">
<title>residual1_2</title>
<polygon fill="orange" stroke="black" points="14559.5,-1342 14406.5,-1342 14406.5,-1289 14559.5,-1289 14559.5,-1342"/>
<text text-anchor="middle" x="14483" y="-1326.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14483" y="-1311.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="14483" y="-1296.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;residual1_2 -->
<g id="edge360" class="edge">
<title>residual2_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M10261.88,-1437.3C10786.82,-1422.28 13838.75,-1334.94 14395.75,-1319"/>
<polygon fill="black" stroke="black" points="14396.23,-1322.48 14406.12,-1318.7 14396.02,-1315.49 14396.23,-1322.48"/>
</g>
<!-- residual2_2 -->
<g id="node250" class="node">
<title>residual2_2</title>
<polygon fill="orange" stroke="black" points="15396.5,-820 15243.5,-820 15243.5,-767 15396.5,-767 15396.5,-820"/>
<text text-anchor="middle" x="15320" y="-804.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15320" y="-789.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="15320" y="-774.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;residual2_2 -->
<g id="edge363" class="edge">
<title>residual2_1&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M10261.83,-1439.79C10690.1,-1441.11 12825.86,-1443.7 14569,-1373 14759.48,-1365.27 15425,-1507.14 15425,-1316.5 15425,-1316.5 15425,-1316.5 15425,-896.5 15425,-866.83 15403.17,-843.01 15379.41,-825.88"/>
<polygon fill="black" stroke="black" points="15381.19,-822.85 15370.96,-820.09 15377.24,-828.63 15381.19,-822.85"/>
</g>
<!-- proj_2_0_0 -->
<g id="node168" class="node">
<title>proj_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="14041,-924 13897,-924 13897,-871 14041,-871 14041,-924"/>
<text text-anchor="middle" x="13969" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13969" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="13969" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_2_0 -->
<g id="node169" class="node">
<title>concat_dim_2_0</title>
<polygon fill="lightsteelblue" stroke="black" points="13647.5,-820 13494.5,-820 13494.5,-767 13647.5,-767 13647.5,-820"/>
<text text-anchor="middle" x="13571" y="-804.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="13571" y="-789.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="13571" y="-774.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge73" class="edge">
<title>proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13916.66,-870.87C13891.3,-859.35 13860.11,-846.48 13831,-838 13774.36,-821.51 13708.83,-810.59 13657.74,-803.82"/>
<polygon fill="black" stroke="black" points="13658.08,-800.34 13647.72,-802.52 13657.18,-807.28 13658.08,-800.34"/>
<text text-anchor="middle" x="13931" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_2 -->
<g id="node188" class="node">
<title>concat_heads_2</title>
<polygon fill="lightsteelblue" stroke="black" points="12261,-695 12097,-695 12097,-642 12261,-642 12261,-695"/>
<text text-anchor="middle" x="12179" y="-679.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="12179" y="-664.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="12179" y="-649.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge89" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13494.18,-785.71C13255.84,-764.65 12529.54,-700.47 12271.32,-677.66"/>
<polygon fill="black" stroke="black" points="12271.49,-674.16 12261.22,-676.77 12270.88,-681.13 12271.49,-674.16"/>
<text text-anchor="middle" x="13084.5" y="-737.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_2_0_1 -->
<g id="node170" class="node">
<title>proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="13830,-924 13686,-924 13686,-871 13830,-871 13830,-924"/>
<text text-anchor="middle" x="13758" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13758" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="13758" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge74" class="edge">
<title>proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13733.02,-870.72C13721.11,-859.52 13706.16,-846.94 13691,-838 13680.38,-831.74 13668.71,-826.14 13656.95,-821.22"/>
<polygon fill="black" stroke="black" points="13658.1,-817.91 13647.51,-817.42 13655.48,-824.4 13658.1,-817.91"/>
<text text-anchor="middle" x="13769" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_2_0_2 -->
<g id="node171" class="node">
<title>proj_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="13643,-924 13499,-924 13499,-871 13643,-871 13643,-924"/>
<text text-anchor="middle" x="13571" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13571" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="13571" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge75" class="edge">
<title>proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13571,-870.76C13571,-858.56 13571,-843.78 13571,-830.49"/>
<polygon fill="black" stroke="black" points="13574.5,-830.23 13571,-820.23 13567.5,-830.23 13574.5,-830.23"/>
<text text-anchor="middle" x="13629" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_2_0_3 -->
<g id="node172" class="node">
<title>proj_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="13461,-924 13317,-924 13317,-871 13461,-871 13461,-924"/>
<text text-anchor="middle" x="13389" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13389" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="13389" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge76" class="edge">
<title>proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13411.52,-870.93C13422.53,-859.64 13436.51,-846.93 13451,-838 13461.5,-831.53 13473.1,-825.83 13484.83,-820.85"/>
<polygon fill="black" stroke="black" points="13486.3,-824.03 13494.24,-817.01 13483.66,-817.54 13486.3,-824.03"/>
<text text-anchor="middle" x="13509" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_2_1_0 -->
<g id="node173" class="node">
<title>proj_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="13077,-924 12933,-924 12933,-871 13077,-871 13077,-924"/>
<text text-anchor="middle" x="13005" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13005" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="13005" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_2_1 -->
<g id="node174" class="node">
<title>concat_dim_2_1</title>
<polygon fill="lightsteelblue" stroke="black" points="12671.5,-820 12518.5,-820 12518.5,-767 12671.5,-767 12671.5,-820"/>
<text text-anchor="middle" x="12595" y="-804.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="12595" y="-789.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="12595" y="-774.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge77" class="edge">
<title>proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12947.53,-870.88C12919.99,-859.43 12886.26,-846.61 12855,-838 12798.12,-822.33 12732.6,-811.41 12681.56,-804.43"/>
<polygon fill="black" stroke="black" points="12681.93,-800.95 12671.56,-803.09 12681,-807.89 12681.93,-800.95"/>
<text text-anchor="middle" x="12959" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge90" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12518.21,-769.8C12448.34,-749.14 12345.07,-718.6 12270.85,-696.66"/>
<polygon fill="black" stroke="black" points="12271.61,-693.23 12261.03,-693.75 12269.63,-699.95 12271.61,-693.23"/>
<text text-anchor="middle" x="12480.5" y="-737.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_2_1_1 -->
<g id="node175" class="node">
<title>proj_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="12854,-924 12710,-924 12710,-871 12854,-871 12854,-924"/>
<text text-anchor="middle" x="12782" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12782" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="12782" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge78" class="edge">
<title>proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12757.02,-870.72C12745.11,-859.52 12730.16,-846.94 12715,-838 12704.38,-831.74 12692.71,-826.14 12680.95,-821.22"/>
<polygon fill="black" stroke="black" points="12682.1,-817.91 12671.51,-817.42 12679.48,-824.4 12682.1,-817.91"/>
<text text-anchor="middle" x="12793" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_2_1_2 -->
<g id="node176" class="node">
<title>proj_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="12667,-924 12523,-924 12523,-871 12667,-871 12667,-924"/>
<text text-anchor="middle" x="12595" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12595" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="12595" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge79" class="edge">
<title>proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12595,-870.76C12595,-858.56 12595,-843.78 12595,-830.49"/>
<polygon fill="black" stroke="black" points="12598.5,-830.23 12595,-820.23 12591.5,-830.23 12598.5,-830.23"/>
<text text-anchor="middle" x="12653" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_2_1_3 -->
<g id="node177" class="node">
<title>proj_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="12480,-924 12336,-924 12336,-871 12480,-871 12480,-924"/>
<text text-anchor="middle" x="12408" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12408" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="12408" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge80" class="edge">
<title>proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12432.98,-870.72C12444.89,-859.52 12459.84,-846.94 12475,-838 12485.62,-831.74 12497.29,-826.14 12509.05,-821.22"/>
<polygon fill="black" stroke="black" points="12510.52,-824.4 12518.49,-817.42 12507.9,-817.91 12510.52,-824.4"/>
<text text-anchor="middle" x="12533" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_2_2_0 -->
<g id="node178" class="node">
<title>proj_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="12122,-924 11978,-924 11978,-871 12122,-871 12122,-924"/>
<text text-anchor="middle" x="12050" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12050" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="12050" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_2_2 -->
<g id="node179" class="node">
<title>concat_dim_2_2</title>
<polygon fill="lightsteelblue" stroke="black" points="11939.5,-820 11786.5,-820 11786.5,-767 11939.5,-767 11939.5,-820"/>
<text text-anchor="middle" x="11863" y="-804.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="11863" y="-789.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="11863" y="-774.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge81" class="edge">
<title>proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12025.02,-870.72C12013.11,-859.52 11998.16,-846.94 11983,-838 11972.38,-831.74 11960.71,-826.14 11948.95,-821.22"/>
<polygon fill="black" stroke="black" points="11950.1,-817.91 11939.51,-817.42 11947.48,-824.4 11950.1,-817.91"/>
<text text-anchor="middle" x="12061" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge91" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11928.86,-766.86C11979.88,-747.01 12050.6,-719.48 12103.83,-698.76"/>
<polygon fill="black" stroke="black" points="12105.18,-701.99 12113.23,-695.1 12102.64,-695.47 12105.18,-701.99"/>
<text text-anchor="middle" x="12055.5" y="-737.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_2_2_1 -->
<g id="node180" class="node">
<title>proj_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11935,-924 11791,-924 11791,-871 11935,-871 11935,-924"/>
<text text-anchor="middle" x="11863" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11863" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="11863" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge82" class="edge">
<title>proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11863,-870.76C11863,-858.56 11863,-843.78 11863,-830.49"/>
<polygon fill="black" stroke="black" points="11866.5,-830.23 11863,-820.23 11859.5,-830.23 11866.5,-830.23"/>
<text text-anchor="middle" x="11921" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_2_2_2 -->
<g id="node181" class="node">
<title>proj_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11715,-924 11571,-924 11571,-871 11715,-871 11715,-924"/>
<text text-anchor="middle" x="11643" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11643" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="11643" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge83" class="edge">
<title>proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11678.56,-870.74C11694.9,-859.67 11714.87,-847.2 11734,-838 11747.54,-831.49 11762.31,-825.53 11776.87,-820.25"/>
<polygon fill="black" stroke="black" points="11778.13,-823.51 11786.39,-816.87 11775.79,-816.91 11778.13,-823.51"/>
<text text-anchor="middle" x="11796.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_2_2_3 -->
<g id="node182" class="node">
<title>proj_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11533,-924 11389,-924 11389,-871 11533,-871 11533,-924"/>
<text text-anchor="middle" x="11461" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11461" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="11461" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge84" class="edge">
<title>proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11504.08,-870.9C11525.61,-859.18 11552.46,-846.11 11578,-838 11642.69,-817.45 11718.82,-806.47 11776.11,-800.68"/>
<polygon fill="black" stroke="black" points="11776.61,-804.15 11786.22,-799.69 11775.93,-797.18 11776.61,-804.15"/>
<text text-anchor="middle" x="11640.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_2_3_0 -->
<g id="node183" class="node">
<title>proj_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="11162,-924 11018,-924 11018,-871 11162,-871 11162,-924"/>
<text text-anchor="middle" x="11090" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11090" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="11090" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_2_3 -->
<g id="node184" class="node">
<title>concat_dim_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="10963.5,-820 10810.5,-820 10810.5,-767 10963.5,-767 10963.5,-820"/>
<text text-anchor="middle" x="10887" y="-804.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="10887" y="-789.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="10887" y="-774.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge85" class="edge">
<title>proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11062.45,-870.98C11049.17,-859.7 11032.55,-846.98 11016,-838 11002.62,-830.74 10987.81,-824.38 10973.14,-818.93"/>
<polygon fill="black" stroke="black" points="10974.12,-815.57 10963.53,-815.48 10971.76,-822.15 10974.12,-815.57"/>
<text text-anchor="middle" x="11099.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge92" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10963.95,-785.17C11188.62,-763.79 11843.08,-701.48 12086.44,-678.31"/>
<polygon fill="black" stroke="black" points="12087.05,-681.77 12096.67,-677.34 12086.38,-674.8 12087.05,-681.77"/>
<text text-anchor="middle" x="11538.5" y="-737.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_2_3_1 -->
<g id="node185" class="node">
<title>proj_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="10959,-924 10815,-924 10815,-871 10959,-871 10959,-924"/>
<text text-anchor="middle" x="10887" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10887" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="10887" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge86" class="edge">
<title>proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10887,-870.76C10887,-858.56 10887,-843.78 10887,-830.49"/>
<polygon fill="black" stroke="black" points="10890.5,-830.23 10887,-820.23 10883.5,-830.23 10890.5,-830.23"/>
<text text-anchor="middle" x="10949.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_2_3_2 -->
<g id="node186" class="node">
<title>proj_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="10777,-924 10633,-924 10633,-871 10777,-871 10777,-924"/>
<text text-anchor="middle" x="10705" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10705" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="10705" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge87" class="edge">
<title>proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10723.28,-870.96C10732.57,-859.54 10744.7,-846.71 10758,-838 10770.97,-829.5 10785.77,-822.5 10800.61,-816.79"/>
<polygon fill="black" stroke="black" points="10802.16,-819.95 10810.35,-813.22 10799.75,-813.38 10802.16,-819.95"/>
<text text-anchor="middle" x="10820.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_2_3_3 -->
<g id="node187" class="node">
<title>proj_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="10533,-924 10389,-924 10389,-871 10533,-871 10533,-924"/>
<text text-anchor="middle" x="10461" y="-908.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10461" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="10461" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge88" class="edge">
<title>proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10517.68,-870.87C10545.09,-859.35 10578.75,-846.48 10610,-838 10672.58,-821.02 10745.04,-809.93 10800.14,-803.2"/>
<polygon fill="black" stroke="black" points="10800.71,-806.66 10810.23,-802 10799.88,-799.71 10800.71,-806.66"/>
<text text-anchor="middle" x="10672.5" y="-841.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- gate_2 -->
<g id="node189" class="node">
<title>gate_2</title>
<polygon fill="gold" stroke="black" points="14831,-1162 14723,-1162 14723,-1109 14831,-1109 14831,-1162"/>
<text text-anchor="middle" x="14777" y="-1146.8" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="14777" y="-1131.8" font-family="Times,serif" font-size="14.00">[1048576, 8]</text>
<text text-anchor="middle" x="14777" y="-1116.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_2_0 -->
<g id="node190" class="node">
<title>expert_2_0</title>
<polygon fill="lightblue" stroke="black" points="14325.5,-1043 14190.5,-1043 14190.5,-975 14325.5,-975 14325.5,-1043"/>
<text text-anchor="middle" x="14258" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14258" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="14258" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="14258" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge93" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14722.74,-1132.18C14606.8,-1126.83 14342.57,-1112.44 14308,-1091 14293.46,-1081.98 14282.51,-1067.02 14274.61,-1052.38"/>
<polygon fill="red" stroke="red" points="14277.7,-1050.74 14270.09,-1043.37 14271.45,-1053.88 14277.7,-1050.74"/>
<text text-anchor="middle" x="14339.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14339.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge343" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14722.97,-1131.72C14634.86,-1126.59 14464.49,-1114 14409,-1091 14389.12,-1082.76 14389.39,-1072.18 14371,-1061 14363.74,-1056.58 14350.19,-1050.04 14334.94,-1043.1"/>
<polygon fill="black" stroke="black" points="14336.35,-1039.89 14325.8,-1038.98 14333.48,-1046.27 14336.35,-1039.89"/>
</g>
<!-- expert_2_1 -->
<g id="node191" class="node">
<title>expert_2_1</title>
<polygon fill="lightgreen" stroke="black" points="14478.5,-1043 14343.5,-1043 14343.5,-975 14478.5,-975 14478.5,-1043"/>
<text text-anchor="middle" x="14411" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14411" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="14411" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="14411" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge94" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14722.77,-1134.99C14636.14,-1134.61 14471.98,-1128.76 14430,-1091 14419.37,-1081.44 14414.12,-1067.16 14411.68,-1053.25"/>
<polygon fill="red" stroke="red" points="14415.14,-1052.71 14410.36,-1043.25 14408.2,-1053.62 14415.14,-1052.71"/>
<text text-anchor="middle" x="14461.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14461.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge345" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14722.7,-1126.43C14681.69,-1119.46 14624.39,-1107.83 14576,-1091 14542.81,-1079.46 14507.65,-1062.86 14478.35,-1047.69"/>
<polygon fill="black" stroke="black" points="14479.94,-1044.57 14469.45,-1043.03 14476.69,-1050.77 14479.94,-1044.57"/>
</g>
<!-- expert_2_2 -->
<g id="node192" class="node">
<title>expert_2_2</title>
<polygon fill="lightyellow" stroke="black" points="14631.5,-1043 14496.5,-1043 14496.5,-975 14631.5,-975 14631.5,-1043"/>
<text text-anchor="middle" x="14564" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14564" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="14564" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="14564" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge95" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14722.62,-1132.72C14685.32,-1128.88 14636.68,-1118.43 14603,-1091 14590.91,-1081.15 14582.31,-1066.65 14576.33,-1052.62"/>
<polygon fill="red" stroke="red" points="14579.49,-1051.1 14572.59,-1043.05 14572.97,-1053.64 14579.49,-1051.1"/>
<text text-anchor="middle" x="14634.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14634.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge347" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14726.12,-1108.94C14716.51,-1103.44 14706.74,-1097.35 14698,-1091 14682.23,-1079.54 14682,-1072.14 14666,-1061 14658.02,-1055.44 14649.35,-1050.14 14640.54,-1045.2"/>
<polygon fill="black" stroke="black" points="14642.16,-1042.1 14631.71,-1040.38 14638.81,-1048.24 14642.16,-1042.1"/>
</g>
<!-- expert_2_3 -->
<g id="node193" class="node">
<title>expert_2_3</title>
<polygon fill="lightcoral" stroke="black" points="14784.5,-1043 14649.5,-1043 14649.5,-975 14784.5,-975 14784.5,-1043"/>
<text text-anchor="middle" x="14717" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="14717" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="14717" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="14717" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge96" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14724.24,-1108.94C14718.14,-1103.84 14712.77,-1097.88 14709,-1091 14702.79,-1079.65 14702.04,-1066.07 14703.65,-1053.29"/>
<polygon fill="red" stroke="red" points="14707.12,-1053.73 14705.38,-1043.28 14700.23,-1052.54 14707.12,-1053.73"/>
<text text-anchor="middle" x="14740.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14740.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge349" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14779.79,-1108.83C14780.3,-1094.15 14779.05,-1075.77 14772,-1061 14770.39,-1057.63 14768.45,-1054.37 14766.28,-1051.25"/>
<polygon fill="black" stroke="black" points="14768.96,-1049 14760.03,-1043.3 14763.45,-1053.32 14768.96,-1049"/>
</g>
<!-- expert_2_4 -->
<g id="node194" class="node">
<title>expert_2_4</title>
<polygon fill="lightpink" stroke="black" points="14937.5,-1043 14802.5,-1043 14802.5,-975 14937.5,-975 14937.5,-1043"/>
<text text-anchor="middle" x="14870" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="14870" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="14870" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="14870" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_2&#45;&gt;expert_2_4 -->
<g id="edge97" class="edge">
<title>gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14781.73,-1108.92C14785.43,-1093.92 14791.71,-1075.18 14802,-1061 14804.71,-1057.27 14807.76,-1053.69 14811.04,-1050.28"/>
<polygon fill="red" stroke="red" points="14813.74,-1052.55 14818.54,-1043.1 14808.9,-1047.49 14813.74,-1052.55"/>
<text text-anchor="middle" x="14833.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14833.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<!-- gate_2&#45;&gt;expert_2_4 -->
<g id="edge351" class="edge">
<title>gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14831.15,-1118.58C14844.29,-1112.12 14856.89,-1103.21 14865,-1091 14872.26,-1080.08 14874.9,-1066.38 14875.32,-1053.38"/>
<polygon fill="black" stroke="black" points="14878.82,-1053.13 14875.23,-1043.17 14871.82,-1053.2 14878.82,-1053.13"/>
</g>
<!-- expert_2_5 -->
<g id="node195" class="node">
<title>expert_2_5</title>
<polygon fill="lightcyan" stroke="black" points="15090.5,-1043 14955.5,-1043 14955.5,-975 15090.5,-975 15090.5,-1043"/>
<text text-anchor="middle" x="15023" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="15023" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="15023" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="15023" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_2&#45;&gt;expert_2_5 -->
<g id="edge98" class="edge">
<title>gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14831.12,-1111.5C14845.23,-1105.16 14860.31,-1098.07 14874,-1091 14897.37,-1078.93 14902,-1073.74 14925,-1061 14932.82,-1056.67 14941.05,-1052.22 14949.27,-1047.84"/>
<polygon fill="red" stroke="red" points="14950.97,-1050.91 14958.17,-1043.13 14947.7,-1044.72 14950.97,-1050.91"/>
<text text-anchor="middle" x="14956.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="14956.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<!-- gate_2&#45;&gt;expert_2_5 -->
<g id="edge353" class="edge">
<title>gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14831.2,-1129.04C14885.52,-1122.58 14964.39,-1110.21 14988,-1091 14999.87,-1081.34 15007.81,-1066.87 15013.08,-1052.83"/>
<polygon fill="black" stroke="black" points="15016.43,-1053.84 15016.31,-1043.24 15009.8,-1051.6 15016.43,-1053.84"/>
</g>
<!-- expert_2_6 -->
<g id="node196" class="node">
<title>expert_2_6</title>
<polygon fill="lightgrey" stroke="black" points="15243.5,-1043 15108.5,-1043 15108.5,-975 15243.5,-975 15243.5,-1043"/>
<text text-anchor="middle" x="15176" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="15176" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="15176" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="15176" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_2&#45;&gt;expert_2_6 -->
<g id="edge99" class="edge">
<title>gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14831.03,-1128.33C14877.5,-1122.03 14945.86,-1110.37 15003,-1091 15031.24,-1081.43 15036.07,-1073.8 15063,-1061 15074.62,-1055.48 15086.97,-1049.75 15099.08,-1044.22"/>
<polygon fill="red" stroke="red" points="15100.62,-1047.37 15108.28,-1040.04 15097.73,-1040.99 15100.62,-1047.37"/>
<text text-anchor="middle" x="15094.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="15094.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<!-- gate_2&#45;&gt;expert_2_6 -->
<g id="edge355" class="edge">
<title>gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14831.33,-1133.37C14916.94,-1130.67 15078.41,-1121.56 15126,-1091 15140.39,-1081.76 15151.32,-1066.74 15159.24,-1052.14"/>
<polygon fill="black" stroke="black" points="15162.39,-1053.66 15163.78,-1043.15 15156.14,-1050.5 15162.39,-1053.66"/>
</g>
<!-- expert_2_7 -->
<g id="node197" class="node">
<title>expert_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="15396.5,-1043 15261.5,-1043 15261.5,-975 15396.5,-975 15396.5,-1043"/>
<text text-anchor="middle" x="15329" y="-1027.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="15329" y="-1012.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="15329" y="-997.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="15329" y="-982.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_2&#45;&gt;expert_2_7 -->
<g id="edge100" class="edge">
<title>gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14831.21,-1133.37C14903.74,-1130.66 15035.79,-1121.55 15144,-1091 15174.62,-1082.35 15179.82,-1073.69 15209,-1061 15225.95,-1053.62 15232.02,-1051.66 15252,-1043.38"/>
<polygon fill="red" stroke="red" points="15253.61,-1046.49 15261.49,-1039.4 15250.91,-1040.04 15253.61,-1046.49"/>
<text text-anchor="middle" x="15240.5" y="-1079.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="15240.5" y="-1064.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<!-- gate_2&#45;&gt;expert_2_7 -->
<g id="edge357" class="edge">
<title>gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14831.43,-1132.3C14952.12,-1127.04 15234.53,-1112.58 15272,-1091 15287.69,-1081.96 15300.12,-1066.65 15309.32,-1051.75"/>
<polygon fill="black" stroke="black" points="15312.36,-1053.49 15314.36,-1043.08 15306.3,-1049.97 15312.36,-1053.49"/>
</g>
<!-- expert_agg_2 -->
<g id="node198" class="node">
<title>expert_agg_2</title>
<polygon fill="lightsteelblue" stroke="black" points="14949,-924 14791,-924 14791,-871 14949,-871 14949,-924"/>
<text text-anchor="middle" x="14870" y="-908.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14870" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="14870" y="-878.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge101" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14258.22,-974.9C14260.08,-962.78 14264.46,-950.08 14274,-942 14311.74,-910.03 14623.94,-901.55 14780.78,-899.31"/>
<polygon fill="black" stroke="black" points="14780.94,-902.8 14790.89,-899.17 14780.84,-895.81 14780.94,-902.8"/>
<text text-anchor="middle" x="14325.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 0→Agg</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge344" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14325.68,-979C14352.37,-967.57 14376.82,-957.09 14377,-957 14389.72,-950.88 14391.48,-946.07 14405,-942 14473.01,-921.52 14665.75,-908.69 14780.62,-902.64"/>
<polygon fill="black" stroke="black" points="14781,-906.13 14790.8,-902.11 14780.64,-899.14 14781,-906.13"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge102" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14406.47,-974.75C14406.73,-962.91 14409.49,-950.43 14418,-942 14443.2,-917.05 14656.29,-905.68 14780.69,-901.13"/>
<polygon fill="black" stroke="black" points="14781.09,-904.62 14790.96,-900.76 14780.84,-897.62 14781.09,-904.62"/>
<text text-anchor="middle" x="14469.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 1→Agg</text>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge346" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14478.73,-978.14C14496.4,-970 14512.8,-962.04 14521,-957 14530.17,-951.37 14530.09,-946.19 14540,-942 14582.09,-924.22 14698.13,-911.81 14780.67,-904.91"/>
<polygon fill="black" stroke="black" points="14781.14,-908.39 14790.82,-904.08 14780.57,-901.41 14781.14,-908.39"/>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge103" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14547.04,-974.83C14543.64,-963.27 14543.17,-950.97 14551,-942 14580.32,-908.41 14696.95,-899.79 14780.71,-898.07"/>
<polygon fill="black" stroke="black" points="14780.82,-901.57 14790.75,-897.89 14780.69,-894.57 14780.82,-901.57"/>
<text text-anchor="middle" x="14602.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 2→Agg</text>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge348" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14624.55,-974.84C14634.49,-969.07 14644.61,-962.99 14654,-957 14663.67,-950.83 14664.53,-946.68 14675,-942 14708.15,-927.2 14746.79,-917.23 14780.89,-910.62"/>
<polygon fill="black" stroke="black" points="14781.66,-914.03 14790.85,-908.75 14780.37,-907.15 14781.66,-914.03"/>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge104" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14685.89,-974.85C14679.21,-963.81 14676.2,-951.84 14684,-942 14696.59,-926.12 14739.55,-915.49 14781,-908.72"/>
<polygon fill="black" stroke="black" points="14781.59,-912.17 14790.93,-907.16 14780.51,-905.25 14781.59,-912.17"/>
<text text-anchor="middle" x="14735.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 3→Agg</text>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge350" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14763.32,-974.85C14783.18,-960.64 14806.26,-944.12 14825.87,-930.08"/>
<polygon fill="black" stroke="black" points="14827.94,-932.9 14834.04,-924.24 14823.87,-927.21 14827.94,-932.9"/>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge105" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14828.12,-974.7C14823.62,-969.28 14819.7,-963.35 14817,-957 14813.18,-948.02 14815.59,-939.5 14821.05,-931.89"/>
<polygon fill="black" stroke="black" points="14824.03,-933.82 14828.04,-924.01 14818.79,-929.18 14824.03,-933.82"/>
<text text-anchor="middle" x="14868.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 4→Agg</text>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge352" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14909.3,-974.73C14913.64,-969.27 14917.42,-963.31 14920,-957 14923.6,-948.19 14921.32,-939.75 14916.16,-932.16"/>
<polygon fill="black" stroke="black" points="14918.67,-929.71 14909.58,-924.28 14913.3,-934.2 14918.67,-929.71"/>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge106" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14975.38,-974.95C14966.91,-969.01 14958.18,-962.84 14950,-957 14937.83,-948.3 14924.7,-938.76 14912.67,-929.96"/>
<polygon fill="black" stroke="black" points="14914.67,-927.09 14904.53,-924 14910.53,-932.74 14914.67,-927.09"/>
<text text-anchor="middle" x="15001.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 5→Agg</text>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge354" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M15051.92,-974.67C15058.04,-963.62 15060.65,-951.68 15053,-942 15040.8,-926.55 14999.5,-916.01 14959.22,-909.17"/>
<polygon fill="black" stroke="black" points="14959.73,-905.71 14949.3,-907.56 14958.6,-912.62 14959.73,-905.71"/>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge107" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15114.09,-974.91C15103.64,-969.08 15092.95,-962.96 15083,-957 15072.53,-950.73 15071.23,-946.77 15060,-942 15028.24,-928.52 14991.65,-918.87 14959.1,-912.15"/>
<polygon fill="black" stroke="black" points="14959.63,-908.69 14949.14,-910.16 14958.26,-915.55 14959.63,-908.69"/>
<text text-anchor="middle" x="15134.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 6→Agg</text>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge356" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M15190.94,-974.76C15193.76,-963.2 15193.77,-950.91 15186,-942 15157.09,-908.84 15042.36,-900.08 14959.46,-898.21"/>
<polygon fill="black" stroke="black" points="14959.33,-894.71 14949.26,-898.01 14959.19,-901.71 14959.33,-894.71"/>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge108" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15261.4,-977.47C15247.6,-970.93 15233.25,-963.9 15220,-957 15208.17,-950.83 15206.63,-946.3 15194,-942 15117.35,-915.89 15025.5,-905.37 14959.2,-901.17"/>
<polygon fill="black" stroke="black" points="14959.39,-897.68 14949.2,-900.58 14958.97,-904.67 14959.39,-897.68"/>
<text text-anchor="middle" x="15271.5" y="-945.8" font-family="Times,serif" font-size="14.00">Expert 7→Agg</text>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge358" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M15334.09,-974.8C15334.01,-962.97 15331.44,-950.48 15323,-942 15297.93,-916.8 15084.29,-905.54 14959.56,-901.07"/>
<polygon fill="black" stroke="black" points="14959.38,-897.56 14949.26,-900.7 14959.13,-904.55 14959.38,-897.56"/>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge359" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M14949.23,-877.31C15028.89,-858.85 15151.26,-831.12 15233.43,-812.91"/>
<polygon fill="black" stroke="black" points="15234.24,-816.32 15243.24,-810.74 15232.72,-809.48 15234.24,-816.32"/>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge362" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M14949.22,-879.71C15028.87,-862.11 15151.23,-834.4 15233.4,-815.39"/>
<polygon fill="black" stroke="black" points="15234.26,-818.79 15243.21,-813.12 15232.68,-811.97 15234.26,-818.79"/>
</g>
<!-- qkv_2_0_0 -->
<g id="node200" class="node">
<title>qkv_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="14081.5,-1252 13928.5,-1252 13928.5,-1199 14081.5,-1199 14081.5,-1252"/>
<text text-anchor="middle" x="14005" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14005" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="14005" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_2&#45;&gt;qkv_2_0_0 -->
<g id="edge292" class="edge">
<title>ln1_2&#45;&gt;qkv_2_0_0</title>
<path fill="none" stroke="black" d="M12255.69,-1313.8C12545.83,-1310.81 13576.37,-1297.21 13901,-1252 13906.72,-1251.2 13912.59,-1250.22 13918.47,-1249.12"/>
<polygon fill="black" stroke="black" points="13919.26,-1252.53 13928.39,-1247.15 13917.89,-1245.67 13919.26,-1252.53"/>
</g>
<!-- reshape_2_0_0 -->
<g id="node201" class="node">
<title>reshape_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="14108,-1162 13946,-1162 13946,-1109 14108,-1109 14108,-1162"/>
<text text-anchor="middle" x="14027" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="14027" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="14027" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_2_0_0&#45;&gt;reshape_2_0_0 -->
<g id="edge293" class="edge">
<title>qkv_2_0_0&#45;&gt;reshape_2_0_0</title>
<path fill="none" stroke="black" d="M14011.48,-1198.57C14013.56,-1190.25 14015.91,-1180.88 14018.13,-1171.99"/>
<polygon fill="black" stroke="black" points="14021.53,-1172.79 14020.56,-1162.24 14014.74,-1171.09 14021.53,-1172.79"/>
</g>
<!-- attn_2_0_0 -->
<g id="node202" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightblue" stroke="black" points="14172,-1035.5 13946,-1035.5 13946,-982.5 14172,-982.5 14172,-1035.5"/>
<text text-anchor="middle" x="14059" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="14059" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="14059" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge294" class="edge">
<title>reshape_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M14033.63,-1108.7C14038.33,-1090.42 14044.69,-1065.67 14049.87,-1045.53"/>
<polygon fill="black" stroke="black" points="14053.28,-1046.32 14052.38,-1035.76 14046.5,-1044.58 14053.28,-1046.32"/>
</g>
<!-- attn_2_0_0&#45;&gt;proj_2_0_0 -->
<g id="edge295" class="edge">
<title>attn_2_0_0&#45;&gt;proj_2_0_0</title>
<path fill="none" stroke="black" d="M14037.9,-982.33C14025.6,-967.36 14009.94,-948.32 13996.67,-932.16"/>
<polygon fill="black" stroke="black" points="13999.02,-929.52 13989.97,-924.01 13993.61,-933.96 13999.02,-929.52"/>
</g>
<!-- qkv_2_0_1 -->
<g id="node203" class="node">
<title>qkv_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="13891.5,-1252 13738.5,-1252 13738.5,-1199 13891.5,-1199 13891.5,-1252"/>
<text text-anchor="middle" x="13815" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13815" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="13815" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_2_0_1 -->
<g id="node204" class="node">
<title>reshape_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="13896,-1162 13734,-1162 13734,-1109 13896,-1109 13896,-1162"/>
<text text-anchor="middle" x="13815" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="13815" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13815" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_2_0_1&#45;&gt;reshape_2_0_1 -->
<g id="edge296" class="edge">
<title>qkv_2_0_1&#45;&gt;reshape_2_0_1</title>
<path fill="none" stroke="black" d="M13815,-1198.57C13815,-1190.34 13815,-1181.08 13815,-1172.28"/>
<polygon fill="black" stroke="black" points="13818.5,-1172.24 13815,-1162.24 13811.5,-1172.24 13818.5,-1172.24"/>
</g>
<!-- attn_2_0_1 -->
<g id="node205" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="13928,-1035.5 13702,-1035.5 13702,-982.5 13928,-982.5 13928,-1035.5"/>
<text text-anchor="middle" x="13815" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13815" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13815" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge297" class="edge">
<title>reshape_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M13815,-1108.7C13815,-1090.51 13815,-1065.9 13815,-1045.8"/>
<polygon fill="black" stroke="black" points="13818.5,-1045.76 13815,-1035.76 13811.5,-1045.76 13818.5,-1045.76"/>
</g>
<!-- attn_2_0_1&#45;&gt;proj_2_0_1 -->
<g id="edge298" class="edge">
<title>attn_2_0_1&#45;&gt;proj_2_0_1</title>
<path fill="none" stroke="black" d="M13801.64,-982.33C13793.99,-967.64 13784.29,-949.01 13775.99,-933.05"/>
<polygon fill="black" stroke="black" points="13779,-931.27 13771.28,-924.01 13772.79,-934.5 13779,-931.27"/>
</g>
<!-- qkv_2_0_2 -->
<g id="node206" class="node">
<title>qkv_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="13647.5,-1252 13494.5,-1252 13494.5,-1199 13647.5,-1199 13647.5,-1252"/>
<text text-anchor="middle" x="13571" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13571" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="13571" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_2_0_2 -->
<g id="node207" class="node">
<title>reshape_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="13652,-1162 13490,-1162 13490,-1109 13652,-1109 13652,-1162"/>
<text text-anchor="middle" x="13571" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="13571" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13571" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_2_0_2&#45;&gt;reshape_2_0_2 -->
<g id="edge299" class="edge">
<title>qkv_2_0_2&#45;&gt;reshape_2_0_2</title>
<path fill="none" stroke="black" d="M13571,-1198.57C13571,-1190.34 13571,-1181.08 13571,-1172.28"/>
<polygon fill="black" stroke="black" points="13574.5,-1172.24 13571,-1162.24 13567.5,-1172.24 13574.5,-1172.24"/>
</g>
<!-- attn_2_0_2 -->
<g id="node208" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightyellow" stroke="black" points="13684,-1035.5 13458,-1035.5 13458,-982.5 13684,-982.5 13684,-1035.5"/>
<text text-anchor="middle" x="13571" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13571" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13571" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge300" class="edge">
<title>reshape_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M13571,-1108.7C13571,-1090.51 13571,-1065.9 13571,-1045.8"/>
<polygon fill="black" stroke="black" points="13574.5,-1045.76 13571,-1035.76 13567.5,-1045.76 13574.5,-1045.76"/>
</g>
<!-- attn_2_0_2&#45;&gt;proj_2_0_2 -->
<g id="edge301" class="edge">
<title>attn_2_0_2&#45;&gt;proj_2_0_2</title>
<path fill="none" stroke="black" d="M13571,-982.33C13571,-968.05 13571,-950.05 13571,-934.4"/>
<polygon fill="black" stroke="black" points="13574.5,-934.01 13571,-924.01 13567.5,-934.01 13574.5,-934.01"/>
</g>
<!-- qkv_2_0_3 -->
<g id="node209" class="node">
<title>qkv_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="13403.5,-1252 13250.5,-1252 13250.5,-1199 13403.5,-1199 13403.5,-1252"/>
<text text-anchor="middle" x="13327" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13327" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="13327" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_2_0_3 -->
<g id="node210" class="node">
<title>reshape_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="13408,-1162 13246,-1162 13246,-1109 13408,-1109 13408,-1162"/>
<text text-anchor="middle" x="13327" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="13327" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13327" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_2_0_3&#45;&gt;reshape_2_0_3 -->
<g id="edge302" class="edge">
<title>qkv_2_0_3&#45;&gt;reshape_2_0_3</title>
<path fill="none" stroke="black" d="M13327,-1198.57C13327,-1190.34 13327,-1181.08 13327,-1172.28"/>
<polygon fill="black" stroke="black" points="13330.5,-1172.24 13327,-1162.24 13323.5,-1172.24 13330.5,-1172.24"/>
</g>
<!-- attn_2_0_3 -->
<g id="node211" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="13440,-1035.5 13214,-1035.5 13214,-982.5 13440,-982.5 13440,-1035.5"/>
<text text-anchor="middle" x="13327" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13327" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13327" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge303" class="edge">
<title>reshape_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M13327,-1108.7C13327,-1090.51 13327,-1065.9 13327,-1045.8"/>
<polygon fill="black" stroke="black" points="13330.5,-1045.76 13327,-1035.76 13323.5,-1045.76 13330.5,-1045.76"/>
</g>
<!-- attn_2_0_3&#45;&gt;proj_2_0_3 -->
<g id="edge304" class="edge">
<title>attn_2_0_3&#45;&gt;proj_2_0_3</title>
<path fill="none" stroke="black" d="M13341.54,-982.33C13349.85,-967.64 13360.4,-949.01 13369.44,-933.05"/>
<polygon fill="black" stroke="black" points="13372.67,-934.44 13374.55,-924.01 13366.58,-930.99 13372.67,-934.44"/>
</g>
<!-- qkv_2_1_0 -->
<g id="node212" class="node">
<title>qkv_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="13159.5,-1252 13006.5,-1252 13006.5,-1199 13159.5,-1199 13159.5,-1252"/>
<text text-anchor="middle" x="13083" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13083" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="13083" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_2_1_0 -->
<g id="node213" class="node">
<title>reshape_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="13164,-1162 13002,-1162 13002,-1109 13164,-1109 13164,-1162"/>
<text text-anchor="middle" x="13083" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="13083" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13083" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_2_1_0&#45;&gt;reshape_2_1_0 -->
<g id="edge305" class="edge">
<title>qkv_2_1_0&#45;&gt;reshape_2_1_0</title>
<path fill="none" stroke="black" d="M13083,-1198.57C13083,-1190.34 13083,-1181.08 13083,-1172.28"/>
<polygon fill="black" stroke="black" points="13086.5,-1172.24 13083,-1162.24 13079.5,-1172.24 13086.5,-1172.24"/>
</g>
<!-- attn_2_1_0 -->
<g id="node214" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightpink" stroke="black" points="13196,-1035.5 12970,-1035.5 12970,-982.5 13196,-982.5 13196,-1035.5"/>
<text text-anchor="middle" x="13083" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13083" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="13083" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge306" class="edge">
<title>reshape_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M13083,-1108.7C13083,-1090.51 13083,-1065.9 13083,-1045.8"/>
<polygon fill="black" stroke="black" points="13086.5,-1045.76 13083,-1035.76 13079.5,-1045.76 13086.5,-1045.76"/>
</g>
<!-- attn_2_1_0&#45;&gt;proj_2_1_0 -->
<g id="edge307" class="edge">
<title>attn_2_1_0&#45;&gt;proj_2_1_0</title>
<path fill="none" stroke="black" d="M13064.71,-982.33C13054.05,-967.36 13040.48,-948.32 13028.98,-932.16"/>
<polygon fill="black" stroke="black" points="13031.83,-930.13 13023.17,-924.01 13026.12,-934.19 13031.83,-930.13"/>
</g>
<!-- qkv_2_1_1 -->
<g id="node215" class="node">
<title>qkv_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="12915.5,-1252 12762.5,-1252 12762.5,-1199 12915.5,-1199 12915.5,-1252"/>
<text text-anchor="middle" x="12839" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12839" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="12839" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_2_1_1 -->
<g id="node216" class="node">
<title>reshape_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="12920,-1162 12758,-1162 12758,-1109 12920,-1109 12920,-1162"/>
<text text-anchor="middle" x="12839" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="12839" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12839" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_2_1_1&#45;&gt;reshape_2_1_1 -->
<g id="edge308" class="edge">
<title>qkv_2_1_1&#45;&gt;reshape_2_1_1</title>
<path fill="none" stroke="black" d="M12839,-1198.57C12839,-1190.34 12839,-1181.08 12839,-1172.28"/>
<polygon fill="black" stroke="black" points="12842.5,-1172.24 12839,-1162.24 12835.5,-1172.24 12842.5,-1172.24"/>
</g>
<!-- attn_2_1_1 -->
<g id="node217" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="12952,-1035.5 12726,-1035.5 12726,-982.5 12952,-982.5 12952,-1035.5"/>
<text text-anchor="middle" x="12839" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12839" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12839" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge309" class="edge">
<title>reshape_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M12839,-1108.7C12839,-1090.51 12839,-1065.9 12839,-1045.8"/>
<polygon fill="black" stroke="black" points="12842.5,-1045.76 12839,-1035.76 12835.5,-1045.76 12842.5,-1045.76"/>
</g>
<!-- attn_2_1_1&#45;&gt;proj_2_1_1 -->
<g id="edge310" class="edge">
<title>attn_2_1_1&#45;&gt;proj_2_1_1</title>
<path fill="none" stroke="black" d="M12825.64,-982.33C12817.99,-967.64 12808.29,-949.01 12799.99,-933.05"/>
<polygon fill="black" stroke="black" points="12803,-931.27 12795.28,-924.01 12796.79,-934.5 12803,-931.27"/>
</g>
<!-- qkv_2_1_2 -->
<g id="node218" class="node">
<title>qkv_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="12671.5,-1252 12518.5,-1252 12518.5,-1199 12671.5,-1199 12671.5,-1252"/>
<text text-anchor="middle" x="12595" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12595" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="12595" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_2_1_2 -->
<g id="node219" class="node">
<title>reshape_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="12676,-1162 12514,-1162 12514,-1109 12676,-1109 12676,-1162"/>
<text text-anchor="middle" x="12595" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="12595" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12595" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_2_1_2&#45;&gt;reshape_2_1_2 -->
<g id="edge311" class="edge">
<title>qkv_2_1_2&#45;&gt;reshape_2_1_2</title>
<path fill="none" stroke="black" d="M12595,-1198.57C12595,-1190.34 12595,-1181.08 12595,-1172.28"/>
<polygon fill="black" stroke="black" points="12598.5,-1172.24 12595,-1162.24 12591.5,-1172.24 12598.5,-1172.24"/>
</g>
<!-- attn_2_1_2 -->
<g id="node220" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgrey" stroke="black" points="12708,-1035.5 12482,-1035.5 12482,-982.5 12708,-982.5 12708,-1035.5"/>
<text text-anchor="middle" x="12595" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12595" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12595" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge312" class="edge">
<title>reshape_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M12595,-1108.7C12595,-1090.51 12595,-1065.9 12595,-1045.8"/>
<polygon fill="black" stroke="black" points="12598.5,-1045.76 12595,-1035.76 12591.5,-1045.76 12598.5,-1045.76"/>
</g>
<!-- attn_2_1_2&#45;&gt;proj_2_1_2 -->
<g id="edge313" class="edge">
<title>attn_2_1_2&#45;&gt;proj_2_1_2</title>
<path fill="none" stroke="black" d="M12595,-982.33C12595,-968.05 12595,-950.05 12595,-934.4"/>
<polygon fill="black" stroke="black" points="12598.5,-934.01 12595,-924.01 12591.5,-934.01 12598.5,-934.01"/>
</g>
<!-- qkv_2_1_3 -->
<g id="node221" class="node">
<title>qkv_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="12427.5,-1252 12274.5,-1252 12274.5,-1199 12427.5,-1199 12427.5,-1252"/>
<text text-anchor="middle" x="12351" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12351" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="12351" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_2_1_3 -->
<g id="node222" class="node">
<title>reshape_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="12432,-1162 12270,-1162 12270,-1109 12432,-1109 12432,-1162"/>
<text text-anchor="middle" x="12351" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="12351" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12351" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_2_1_3&#45;&gt;reshape_2_1_3 -->
<g id="edge314" class="edge">
<title>qkv_2_1_3&#45;&gt;reshape_2_1_3</title>
<path fill="none" stroke="black" d="M12351,-1198.57C12351,-1190.34 12351,-1181.08 12351,-1172.28"/>
<polygon fill="black" stroke="black" points="12354.5,-1172.24 12351,-1162.24 12347.5,-1172.24 12354.5,-1172.24"/>
</g>
<!-- attn_2_1_3 -->
<g id="node223" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="12464,-1035.5 12238,-1035.5 12238,-982.5 12464,-982.5 12464,-1035.5"/>
<text text-anchor="middle" x="12351" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12351" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12351" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge315" class="edge">
<title>reshape_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M12351,-1108.7C12351,-1090.51 12351,-1065.9 12351,-1045.8"/>
<polygon fill="black" stroke="black" points="12354.5,-1045.76 12351,-1035.76 12347.5,-1045.76 12354.5,-1045.76"/>
</g>
<!-- attn_2_1_3&#45;&gt;proj_2_1_3 -->
<g id="edge316" class="edge">
<title>attn_2_1_3&#45;&gt;proj_2_1_3</title>
<path fill="none" stroke="black" d="M12364.36,-982.33C12372.01,-967.64 12381.71,-949.01 12390.01,-933.05"/>
<polygon fill="black" stroke="black" points="12393.21,-934.5 12394.72,-924.01 12387,-931.27 12393.21,-934.5"/>
</g>
<!-- qkv_2_2_0 -->
<g id="node224" class="node">
<title>qkv_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="12183.5,-1252 12030.5,-1252 12030.5,-1199 12183.5,-1199 12183.5,-1252"/>
<text text-anchor="middle" x="12107" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12107" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="12107" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_2_2_0 -->
<g id="node225" class="node">
<title>reshape_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="12188,-1162 12026,-1162 12026,-1109 12188,-1109 12188,-1162"/>
<text text-anchor="middle" x="12107" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="12107" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12107" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_2_2_0&#45;&gt;reshape_2_2_0 -->
<g id="edge317" class="edge">
<title>qkv_2_2_0&#45;&gt;reshape_2_2_0</title>
<path fill="none" stroke="black" d="M12107,-1198.57C12107,-1190.34 12107,-1181.08 12107,-1172.28"/>
<polygon fill="black" stroke="black" points="12110.5,-1172.24 12107,-1162.24 12103.5,-1172.24 12110.5,-1172.24"/>
</g>
<!-- attn_2_2_0 -->
<g id="node226" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="12220,-1035.5 11994,-1035.5 11994,-982.5 12220,-982.5 12220,-1035.5"/>
<text text-anchor="middle" x="12107" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12107" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="12107" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge318" class="edge">
<title>reshape_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M12107,-1108.7C12107,-1090.51 12107,-1065.9 12107,-1045.8"/>
<polygon fill="black" stroke="black" points="12110.5,-1045.76 12107,-1035.76 12103.5,-1045.76 12110.5,-1045.76"/>
</g>
<!-- attn_2_2_0&#45;&gt;proj_2_2_0 -->
<g id="edge319" class="edge">
<title>attn_2_2_0&#45;&gt;proj_2_2_0</title>
<path fill="none" stroke="black" d="M12093.64,-982.33C12085.99,-967.64 12076.29,-949.01 12067.99,-933.05"/>
<polygon fill="black" stroke="black" points="12071,-931.27 12063.28,-924.01 12064.79,-934.5 12071,-931.27"/>
</g>
<!-- qkv_2_2_1 -->
<g id="node227" class="node">
<title>qkv_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11939.5,-1252 11786.5,-1252 11786.5,-1199 11939.5,-1199 11939.5,-1252"/>
<text text-anchor="middle" x="11863" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11863" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="11863" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_2_2_1 -->
<g id="node228" class="node">
<title>reshape_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11944,-1162 11782,-1162 11782,-1109 11944,-1109 11944,-1162"/>
<text text-anchor="middle" x="11863" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="11863" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11863" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_2_2_1&#45;&gt;reshape_2_2_1 -->
<g id="edge320" class="edge">
<title>qkv_2_2_1&#45;&gt;reshape_2_2_1</title>
<path fill="none" stroke="black" d="M11863,-1198.57C11863,-1190.34 11863,-1181.08 11863,-1172.28"/>
<polygon fill="black" stroke="black" points="11866.5,-1172.24 11863,-1162.24 11859.5,-1172.24 11866.5,-1172.24"/>
</g>
<!-- attn_2_2_1 -->
<g id="node229" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="11976,-1035.5 11750,-1035.5 11750,-982.5 11976,-982.5 11976,-1035.5"/>
<text text-anchor="middle" x="11863" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11863" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11863" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge321" class="edge">
<title>reshape_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M11863,-1108.7C11863,-1090.51 11863,-1065.9 11863,-1045.8"/>
<polygon fill="black" stroke="black" points="11866.5,-1045.76 11863,-1035.76 11859.5,-1045.76 11866.5,-1045.76"/>
</g>
<!-- attn_2_2_1&#45;&gt;proj_2_2_1 -->
<g id="edge322" class="edge">
<title>attn_2_2_1&#45;&gt;proj_2_2_1</title>
<path fill="none" stroke="black" d="M11863,-982.33C11863,-968.05 11863,-950.05 11863,-934.4"/>
<polygon fill="black" stroke="black" points="11866.5,-934.01 11863,-924.01 11859.5,-934.01 11866.5,-934.01"/>
</g>
<!-- qkv_2_2_2 -->
<g id="node230" class="node">
<title>qkv_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11695.5,-1252 11542.5,-1252 11542.5,-1199 11695.5,-1199 11695.5,-1252"/>
<text text-anchor="middle" x="11619" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11619" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="11619" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_2_2_2 -->
<g id="node231" class="node">
<title>reshape_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11700,-1162 11538,-1162 11538,-1109 11700,-1109 11700,-1162"/>
<text text-anchor="middle" x="11619" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="11619" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11619" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_2_2_2&#45;&gt;reshape_2_2_2 -->
<g id="edge323" class="edge">
<title>qkv_2_2_2&#45;&gt;reshape_2_2_2</title>
<path fill="none" stroke="black" d="M11619,-1198.57C11619,-1190.34 11619,-1181.08 11619,-1172.28"/>
<polygon fill="black" stroke="black" points="11622.5,-1172.24 11619,-1162.24 11615.5,-1172.24 11622.5,-1172.24"/>
</g>
<!-- attn_2_2_2 -->
<g id="node232" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightslategray" stroke="black" points="11732,-1035.5 11506,-1035.5 11506,-982.5 11732,-982.5 11732,-1035.5"/>
<text text-anchor="middle" x="11619" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11619" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11619" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge324" class="edge">
<title>reshape_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M11619,-1108.7C11619,-1090.51 11619,-1065.9 11619,-1045.8"/>
<polygon fill="black" stroke="black" points="11622.5,-1045.76 11619,-1035.76 11615.5,-1045.76 11622.5,-1045.76"/>
</g>
<!-- attn_2_2_2&#45;&gt;proj_2_2_2 -->
<g id="edge325" class="edge">
<title>attn_2_2_2&#45;&gt;proj_2_2_2</title>
<path fill="none" stroke="black" d="M11624.63,-982.33C11627.79,-967.91 11631.78,-949.71 11635.23,-933.95"/>
<polygon fill="black" stroke="black" points="11638.69,-934.53 11637.41,-924.01 11631.85,-933.03 11638.69,-934.53"/>
</g>
<!-- qkv_2_2_3 -->
<g id="node233" class="node">
<title>qkv_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11451.5,-1252 11298.5,-1252 11298.5,-1199 11451.5,-1199 11451.5,-1252"/>
<text text-anchor="middle" x="11375" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11375" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="11375" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_2_2_3 -->
<g id="node234" class="node">
<title>reshape_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11456,-1162 11294,-1162 11294,-1109 11456,-1109 11456,-1162"/>
<text text-anchor="middle" x="11375" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="11375" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11375" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_2_2_3&#45;&gt;reshape_2_2_3 -->
<g id="edge326" class="edge">
<title>qkv_2_2_3&#45;&gt;reshape_2_2_3</title>
<path fill="none" stroke="black" d="M11375,-1198.57C11375,-1190.34 11375,-1181.08 11375,-1172.28"/>
<polygon fill="black" stroke="black" points="11378.5,-1172.24 11375,-1162.24 11371.5,-1172.24 11378.5,-1172.24"/>
</g>
<!-- attn_2_2_3 -->
<g id="node235" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="11488,-1035.5 11262,-1035.5 11262,-982.5 11488,-982.5 11488,-1035.5"/>
<text text-anchor="middle" x="11375" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11375" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11375" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge327" class="edge">
<title>reshape_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M11375,-1108.7C11375,-1090.51 11375,-1065.9 11375,-1045.8"/>
<polygon fill="black" stroke="black" points="11378.5,-1045.76 11375,-1035.76 11371.5,-1045.76 11378.5,-1045.76"/>
</g>
<!-- attn_2_2_3&#45;&gt;proj_2_2_3 -->
<g id="edge328" class="edge">
<title>attn_2_2_3&#45;&gt;proj_2_2_3</title>
<path fill="none" stroke="black" d="M11395.16,-982.33C11406.92,-967.36 11421.88,-948.32 11434.56,-932.16"/>
<polygon fill="black" stroke="black" points="11437.54,-934.04 11440.96,-924.01 11432.03,-929.71 11437.54,-934.04"/>
</g>
<!-- qkv_2_3_0 -->
<g id="node236" class="node">
<title>qkv_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="11207.5,-1252 11054.5,-1252 11054.5,-1199 11207.5,-1199 11207.5,-1252"/>
<text text-anchor="middle" x="11131" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11131" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="11131" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_2_3_0 -->
<g id="node237" class="node">
<title>reshape_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="11212,-1162 11050,-1162 11050,-1109 11212,-1109 11212,-1162"/>
<text text-anchor="middle" x="11131" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="11131" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11131" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_2_3_0&#45;&gt;reshape_2_3_0 -->
<g id="edge329" class="edge">
<title>qkv_2_3_0&#45;&gt;reshape_2_3_0</title>
<path fill="none" stroke="black" d="M11131,-1198.57C11131,-1190.34 11131,-1181.08 11131,-1172.28"/>
<polygon fill="black" stroke="black" points="11134.5,-1172.24 11131,-1162.24 11127.5,-1172.24 11134.5,-1172.24"/>
</g>
<!-- attn_2_3_0 -->
<g id="node238" class="node">
<title>attn_2_3_0</title>
<polygon fill="#eedd82" stroke="black" points="11244,-1035.5 11018,-1035.5 11018,-982.5 11244,-982.5 11244,-1035.5"/>
<text text-anchor="middle" x="11131" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11131" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="11131" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge330" class="edge">
<title>reshape_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M11131,-1108.7C11131,-1090.51 11131,-1065.9 11131,-1045.8"/>
<polygon fill="black" stroke="black" points="11134.5,-1045.76 11131,-1035.76 11127.5,-1045.76 11134.5,-1045.76"/>
</g>
<!-- attn_2_3_0&#45;&gt;proj_2_3_0 -->
<g id="edge331" class="edge">
<title>attn_2_3_0&#45;&gt;proj_2_3_0</title>
<path fill="none" stroke="black" d="M11121.39,-982.33C11115.94,-967.77 11109.04,-949.36 11103.11,-933.5"/>
<polygon fill="black" stroke="black" points="11106.34,-932.15 11099.55,-924.01 11099.78,-934.6 11106.34,-932.15"/>
</g>
<!-- qkv_2_3_1 -->
<g id="node239" class="node">
<title>qkv_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="10963.5,-1252 10810.5,-1252 10810.5,-1199 10963.5,-1199 10963.5,-1252"/>
<text text-anchor="middle" x="10887" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10887" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="10887" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_2_3_1 -->
<g id="node240" class="node">
<title>reshape_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="10968,-1162 10806,-1162 10806,-1109 10968,-1109 10968,-1162"/>
<text text-anchor="middle" x="10887" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="10887" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10887" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_2_3_1&#45;&gt;reshape_2_3_1 -->
<g id="edge332" class="edge">
<title>qkv_2_3_1&#45;&gt;reshape_2_3_1</title>
<path fill="none" stroke="black" d="M10887,-1198.57C10887,-1190.34 10887,-1181.08 10887,-1172.28"/>
<polygon fill="black" stroke="black" points="10890.5,-1172.24 10887,-1162.24 10883.5,-1172.24 10890.5,-1172.24"/>
</g>
<!-- attn_2_3_1 -->
<g id="node241" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="11000,-1035.5 10774,-1035.5 10774,-982.5 11000,-982.5 11000,-1035.5"/>
<text text-anchor="middle" x="10887" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10887" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10887" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge333" class="edge">
<title>reshape_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M10887,-1108.7C10887,-1090.51 10887,-1065.9 10887,-1045.8"/>
<polygon fill="black" stroke="black" points="10890.5,-1045.76 10887,-1035.76 10883.5,-1045.76 10890.5,-1045.76"/>
</g>
<!-- attn_2_3_1&#45;&gt;proj_2_3_1 -->
<g id="edge334" class="edge">
<title>attn_2_3_1&#45;&gt;proj_2_3_1</title>
<path fill="none" stroke="black" d="M10887,-982.33C10887,-968.05 10887,-950.05 10887,-934.4"/>
<polygon fill="black" stroke="black" points="10890.5,-934.01 10887,-924.01 10883.5,-934.01 10890.5,-934.01"/>
</g>
<!-- qkv_2_3_2 -->
<g id="node242" class="node">
<title>qkv_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="10719.5,-1252 10566.5,-1252 10566.5,-1199 10719.5,-1199 10719.5,-1252"/>
<text text-anchor="middle" x="10643" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10643" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="10643" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_2_3_2 -->
<g id="node243" class="node">
<title>reshape_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="10724,-1162 10562,-1162 10562,-1109 10724,-1109 10724,-1162"/>
<text text-anchor="middle" x="10643" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="10643" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10643" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_2_3_2&#45;&gt;reshape_2_3_2 -->
<g id="edge335" class="edge">
<title>qkv_2_3_2&#45;&gt;reshape_2_3_2</title>
<path fill="none" stroke="black" d="M10643,-1198.57C10643,-1190.34 10643,-1181.08 10643,-1172.28"/>
<polygon fill="black" stroke="black" points="10646.5,-1172.24 10643,-1162.24 10639.5,-1172.24 10646.5,-1172.24"/>
</g>
<!-- attn_2_3_2 -->
<g id="node244" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgray" stroke="black" points="10756,-1035.5 10530,-1035.5 10530,-982.5 10756,-982.5 10756,-1035.5"/>
<text text-anchor="middle" x="10643" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10643" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10643" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge336" class="edge">
<title>reshape_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M10643,-1108.7C10643,-1090.51 10643,-1065.9 10643,-1045.8"/>
<polygon fill="black" stroke="black" points="10646.5,-1045.76 10643,-1035.76 10639.5,-1045.76 10646.5,-1045.76"/>
</g>
<!-- attn_2_3_2&#45;&gt;proj_2_3_2 -->
<g id="edge337" class="edge">
<title>attn_2_3_2&#45;&gt;proj_2_3_2</title>
<path fill="none" stroke="black" d="M10657.54,-982.33C10665.85,-967.64 10676.4,-949.01 10685.44,-933.05"/>
<polygon fill="black" stroke="black" points="10688.67,-934.44 10690.55,-924.01 10682.58,-930.99 10688.67,-934.44"/>
</g>
<!-- qkv_2_3_3 -->
<g id="node245" class="node">
<title>qkv_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="10475.5,-1252 10322.5,-1252 10322.5,-1199 10475.5,-1199 10475.5,-1252"/>
<text text-anchor="middle" x="10399" y="-1236.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10399" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="10399" y="-1206.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_2_3_3 -->
<g id="node246" class="node">
<title>reshape_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="10480,-1162 10318,-1162 10318,-1109 10480,-1109 10480,-1162"/>
<text text-anchor="middle" x="10399" y="-1146.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="10399" y="-1131.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10399" y="-1116.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_2_3_3&#45;&gt;reshape_2_3_3 -->
<g id="edge338" class="edge">
<title>qkv_2_3_3&#45;&gt;reshape_2_3_3</title>
<path fill="none" stroke="black" d="M10399,-1198.57C10399,-1190.34 10399,-1181.08 10399,-1172.28"/>
<polygon fill="black" stroke="black" points="10402.5,-1172.24 10399,-1162.24 10395.5,-1172.24 10402.5,-1172.24"/>
</g>
<!-- attn_2_3_3 -->
<g id="node247" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="10512,-1035.5 10286,-1035.5 10286,-982.5 10512,-982.5 10512,-1035.5"/>
<text text-anchor="middle" x="10399" y="-1020.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10399" y="-1005.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="10399" y="-990.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge339" class="edge">
<title>reshape_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M10399,-1108.7C10399,-1090.51 10399,-1065.9 10399,-1045.8"/>
<polygon fill="black" stroke="black" points="10402.5,-1045.76 10399,-1035.76 10395.5,-1045.76 10402.5,-1045.76"/>
</g>
<!-- attn_2_3_3&#45;&gt;proj_2_3_3 -->
<g id="edge340" class="edge">
<title>attn_2_3_3&#45;&gt;proj_2_3_3</title>
<path fill="none" stroke="black" d="M10413.54,-982.33C10421.85,-967.64 10432.4,-949.01 10441.44,-933.05"/>
<polygon fill="black" stroke="black" points="10444.67,-934.44 10446.55,-924.01 10438.58,-930.99 10444.67,-934.44"/>
</g>
<!-- ln2_2 -->
<g id="node249" class="node">
<title>ln2_2</title>
<polygon fill="white" stroke="black" points="14559.5,-1252 14406.5,-1252 14406.5,-1199 14559.5,-1199 14559.5,-1252"/>
<text text-anchor="middle" x="14483" y="-1236.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="14483" y="-1221.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="14483" y="-1206.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge341" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M14476.78,-1288.57C14476.27,-1280.34 14476.13,-1271.08 14476.36,-1262.28"/>
<polygon fill="black" stroke="black" points="14479.85,-1262.39 14476.8,-1252.24 14472.86,-1262.08 14479.85,-1262.39"/>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge361" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M14489.22,-1288.57C14489.73,-1280.34 14489.87,-1271.08 14489.64,-1262.28"/>
<polygon fill="black" stroke="black" points="14493.14,-1262.08 14489.2,-1252.24 14486.15,-1262.39 14493.14,-1262.08"/>
</g>
<!-- ln2_2&#45;&gt;gate_2 -->
<g id="edge342" class="edge">
<title>ln2_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M14559.86,-1201.49C14607.57,-1187.21 14668.16,-1169.08 14713.2,-1155.6"/>
<polygon fill="black" stroke="black" points="14714.28,-1158.93 14722.85,-1152.71 14712.27,-1152.22 14714.28,-1158.93"/>
</g>
<!-- ln1_3 -->
<g id="node282" class="node">
<title>ln1_3</title>
<polygon fill="white" stroke="black" points="16481.5,-695 16328.5,-695 16328.5,-642 16481.5,-642 16481.5,-695"/>
<text text-anchor="middle" x="16405" y="-679.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="16405" y="-664.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="16405" y="-649.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3 -->
<g id="edge364" class="edge">
<title>residual2_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M15396.73,-783.8C15592.76,-761.58 16111.08,-702.82 16317.94,-679.37"/>
<polygon fill="black" stroke="black" points="16318.61,-682.82 16328.15,-678.21 16317.82,-675.86 16318.61,-682.82"/>
</g>
<!-- residual1_3 -->
<g id="node331" class="node">
<title>residual1_3</title>
<polygon fill="orange" stroke="black" points="19680.5,-695 19527.5,-695 19527.5,-642 19680.5,-642 19680.5,-695"/>
<text text-anchor="middle" x="19604" y="-679.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19604" y="-664.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="19604" y="-649.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;residual1_3 -->
<g id="edge433" class="edge">
<title>residual2_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M15396.63,-790.3C15919.86,-775.28 18961.85,-687.94 19517.04,-672"/>
<polygon fill="black" stroke="black" points="19517.48,-675.49 19527.37,-671.7 19517.27,-668.49 19517.48,-675.49"/>
</g>
<!-- residual2_3 -->
<g id="node333" class="node">
<title>residual2_3</title>
<polygon fill="orange" stroke="black" points="20280.5,-173 20127.5,-173 20127.5,-120 20280.5,-120 20280.5,-173"/>
<text text-anchor="middle" x="20204" y="-157.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20204" y="-142.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="20204" y="-127.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;residual2_3 -->
<g id="edge436" class="edge">
<title>residual2_2&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M15396.59,-792.75C15823.48,-793.88 17952.39,-795.6 19690,-726 19883.59,-718.25 20560,-863.24 20560,-669.5 20560,-669.5 20560,-669.5 20560,-249.5 20560,-193.68 20396.2,-166.65 20290.82,-155.05"/>
<polygon fill="black" stroke="black" points="20291.13,-151.56 20280.81,-153.97 20290.38,-158.52 20291.13,-151.56"/>
</g>
<!-- proj_3_0_0 -->
<g id="node251" class="node">
<title>proj_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="19194,-277 19050,-277 19050,-224 19194,-224 19194,-277"/>
<text text-anchor="middle" x="19122" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="19122" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="19122" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- concat_dim_3_0 -->
<g id="node252" class="node">
<title>concat_dim_3_0</title>
<polygon fill="lightsteelblue" stroke="black" points="18782.5,-173 18629.5,-173 18629.5,-120 18782.5,-120 18782.5,-173"/>
<text text-anchor="middle" x="18706" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="18706" y="-142.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="18706" y="-127.8" font-family="Times,serif" font-size="14.00">Group 0</text>
</g>
<!-- proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge109" class="edge">
<title>proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19061.34,-224C19032.3,-212.58 18996.78,-199.75 18964,-191 18907.85,-176.01 18843.39,-165.14 18792.94,-158.02"/>
<polygon fill="black" stroke="black" points="18793.11,-154.51 18782.72,-156.6 18792.15,-161.44 18793.11,-154.51"/>
<text text-anchor="middle" x="19066" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 0→Group 0</text>
</g>
<!-- concat_heads_3 -->
<g id="node271" class="node">
<title>concat_heads_3</title>
<polygon fill="lightsteelblue" stroke="black" points="17446,-69 17282,-69 17282,-16 17446,-16 17446,-69"/>
<text text-anchor="middle" x="17364" y="-53.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="17364" y="-38.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="17364" y="-23.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge125" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18629.03,-139.65C18397.35,-122.04 17707.08,-69.58 17456.34,-50.52"/>
<polygon fill="black" stroke="black" points="17456.4,-47.01 17446.17,-49.75 17455.87,-53.99 17456.4,-47.01"/>
<text text-anchor="middle" x="18159.5" y="-90.8" font-family="Times,serif" font-size="14.00">Group 0→All</text>
</g>
<!-- proj_3_0_1 -->
<g id="node253" class="node">
<title>proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="18960,-277 18816,-277 18816,-224 18960,-224 18960,-277"/>
<text text-anchor="middle" x="18888" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18888" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="18888" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge110" class="edge">
<title>proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18865.48,-223.93C18854.47,-212.64 18840.49,-199.93 18826,-191 18815.5,-184.53 18803.9,-178.83 18792.17,-173.85"/>
<polygon fill="black" stroke="black" points="18793.34,-170.54 18782.76,-170.01 18790.7,-177.03 18793.34,-170.54"/>
<text text-anchor="middle" x="18902" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 1→Group 0</text>
</g>
<!-- proj_3_0_2 -->
<g id="node254" class="node">
<title>proj_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="18778,-277 18634,-277 18634,-224 18778,-224 18778,-277"/>
<text text-anchor="middle" x="18706" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18706" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="18706" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge111" class="edge">
<title>proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18706,-223.76C18706,-211.56 18706,-196.78 18706,-183.49"/>
<polygon fill="black" stroke="black" points="18709.5,-183.23 18706,-173.23 18702.5,-183.23 18709.5,-183.23"/>
<text text-anchor="middle" x="18764" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 2→Group 0</text>
</g>
<!-- proj_3_0_3 -->
<g id="node255" class="node">
<title>proj_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="18596,-277 18452,-277 18452,-224 18596,-224 18596,-277"/>
<text text-anchor="middle" x="18524" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18524" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="18524" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge112" class="edge">
<title>proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18546.52,-223.93C18557.53,-212.64 18571.51,-199.93 18586,-191 18596.5,-184.53 18608.1,-178.83 18619.83,-173.85"/>
<polygon fill="black" stroke="black" points="18621.3,-177.03 18629.24,-170.01 18618.66,-170.54 18621.3,-177.03"/>
<text text-anchor="middle" x="18644" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 3→Group 0</text>
</g>
<!-- proj_3_1_0 -->
<g id="node256" class="node">
<title>proj_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="18198,-277 18054,-277 18054,-224 18198,-224 18198,-277"/>
<text text-anchor="middle" x="18126" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18126" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="18126" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- concat_dim_3_1 -->
<g id="node257" class="node">
<title>concat_dim_3_1</title>
<polygon fill="lightsteelblue" stroke="black" points="17806.5,-173 17653.5,-173 17653.5,-120 17806.5,-120 17806.5,-173"/>
<text text-anchor="middle" x="17730" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="17730" y="-142.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="17730" y="-127.8" font-family="Times,serif" font-size="14.00">Group 1</text>
</g>
<!-- proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge113" class="edge">
<title>proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18074.77,-223.99C18049.74,-212.43 18018.85,-199.48 17990,-191 17933.4,-174.36 17867.88,-163.44 17816.77,-156.71"/>
<polygon fill="black" stroke="black" points="17817.11,-153.23 17806.75,-155.42 17816.22,-160.17 17817.11,-153.23"/>
<text text-anchor="middle" x="18090" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 4→Group 1</text>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge126" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17653.27,-124.12C17595.79,-108.1 17516.9,-86.11 17456.02,-69.15"/>
<polygon fill="black" stroke="black" points="17456.6,-65.67 17446.03,-66.36 17454.72,-72.42 17456.6,-65.67"/>
<text text-anchor="middle" x="17612.5" y="-90.8" font-family="Times,serif" font-size="14.00">Group 1→All</text>
</g>
<!-- proj_3_1_1 -->
<g id="node258" class="node">
<title>proj_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="17989,-277 17845,-277 17845,-224 17989,-224 17989,-277"/>
<text text-anchor="middle" x="17917" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17917" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="17917" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge114" class="edge">
<title>proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17892.02,-223.72C17880.11,-212.52 17865.16,-199.94 17850,-191 17839.38,-184.74 17827.71,-179.14 17815.95,-174.22"/>
<polygon fill="black" stroke="black" points="17817.1,-170.91 17806.51,-170.42 17814.48,-177.4 17817.1,-170.91"/>
<text text-anchor="middle" x="17928" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 5→Group 1</text>
</g>
<!-- proj_3_1_2 -->
<g id="node259" class="node">
<title>proj_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="17802,-277 17658,-277 17658,-224 17802,-224 17802,-277"/>
<text text-anchor="middle" x="17730" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17730" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="17730" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge115" class="edge">
<title>proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17730,-223.76C17730,-211.56 17730,-196.78 17730,-183.49"/>
<polygon fill="black" stroke="black" points="17733.5,-183.23 17730,-173.23 17726.5,-183.23 17733.5,-183.23"/>
<text text-anchor="middle" x="17788" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 6→Group 1</text>
</g>
<!-- proj_3_1_3 -->
<g id="node260" class="node">
<title>proj_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="17599,-277 17455,-277 17455,-224 17599,-224 17599,-277"/>
<text text-anchor="middle" x="17527" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17527" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="17527" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge116" class="edge">
<title>proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17559.23,-223.76C17574.1,-212.69 17592.34,-200.21 17610,-191 17620.77,-185.38 17632.44,-180.17 17644.12,-175.45"/>
<polygon fill="black" stroke="black" points="17645.44,-178.69 17653.47,-171.78 17642.88,-172.18 17645.44,-178.69"/>
<text text-anchor="middle" x="17668" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 7→Group 1</text>
</g>
<!-- proj_3_2_0 -->
<g id="node261" class="node">
<title>proj_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="17273,-277 17129,-277 17129,-224 17273,-224 17273,-277"/>
<text text-anchor="middle" x="17201" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17201" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="17201" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- concat_dim_3_2 -->
<g id="node262" class="node">
<title>concat_dim_3_2</title>
<polygon fill="lightsteelblue" stroke="black" points="17074.5,-173 16921.5,-173 16921.5,-120 17074.5,-120 17074.5,-173"/>
<text text-anchor="middle" x="16998" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="16998" y="-142.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="16998" y="-127.8" font-family="Times,serif" font-size="14.00">Group 2</text>
</g>
<!-- proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge117" class="edge">
<title>proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17168.77,-223.76C17153.9,-212.69 17135.66,-200.21 17118,-191 17107.23,-185.38 17095.56,-180.17 17083.88,-175.45"/>
<polygon fill="black" stroke="black" points="17085.12,-172.18 17074.53,-171.78 17082.56,-178.69 17085.12,-172.18"/>
<text text-anchor="middle" x="17199" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 8→Group 2</text>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge127" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17074.73,-124.12C17132.21,-108.1 17211.1,-86.11 17271.98,-69.15"/>
<polygon fill="black" stroke="black" points="17273.28,-72.42 17281.97,-66.36 17271.4,-65.67 17273.28,-72.42"/>
<text text-anchor="middle" x="17246.5" y="-90.8" font-family="Times,serif" font-size="14.00">Group 2→All</text>
</g>
<!-- proj_3_2_1 -->
<g id="node263" class="node">
<title>proj_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="17070,-277 16926,-277 16926,-224 17070,-224 17070,-277"/>
<text text-anchor="middle" x="16998" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16998" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="16998" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge118" class="edge">
<title>proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16998,-223.76C16998,-211.56 16998,-196.78 16998,-183.49"/>
<polygon fill="black" stroke="black" points="17001.5,-183.23 16998,-173.23 16994.5,-183.23 17001.5,-183.23"/>
<text text-anchor="middle" x="17056" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 9→Group 2</text>
</g>
<!-- proj_3_2_2 -->
<g id="node264" class="node">
<title>proj_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="16888,-277 16744,-277 16744,-224 16888,-224 16888,-277"/>
<text text-anchor="middle" x="16816" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16816" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="16816" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge119" class="edge">
<title>proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16834.28,-223.96C16843.57,-212.54 16855.7,-199.71 16869,-191 16881.97,-182.5 16896.77,-175.5 16911.61,-169.79"/>
<polygon fill="black" stroke="black" points="16913.16,-172.95 16921.35,-166.22 16910.75,-166.38 16913.16,-172.95"/>
<text text-anchor="middle" x="16931.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 10→Group 2</text>
</g>
<!-- proj_3_2_3 -->
<g id="node265" class="node">
<title>proj_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16691,-277 16547,-277 16547,-224 16691,-224 16691,-277"/>
<text text-anchor="middle" x="16619" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16619" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="16619" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge120" class="edge">
<title>proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16656.15,-223.8C16674.83,-212.05 16698.28,-198.99 16721,-191 16782.5,-169.37 16855.45,-158.46 16911.05,-152.98"/>
<polygon fill="black" stroke="black" points="16911.6,-156.45 16921.22,-152.02 16910.94,-149.48 16911.6,-156.45"/>
<text text-anchor="middle" x="16783.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 11→Group 2</text>
</g>
<!-- proj_3_3_0 -->
<g id="node266" class="node">
<title>proj_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16276,-277 16132,-277 16132,-224 16276,-224 16276,-277"/>
<text text-anchor="middle" x="16204" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16204" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="16204" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- concat_dim_3_3 -->
<g id="node267" class="node">
<title>concat_dim_3_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16098.5,-173 15945.5,-173 15945.5,-120 16098.5,-120 16098.5,-173"/>
<text text-anchor="middle" x="16022" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="16022" y="-142.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 2048]</text>
<text text-anchor="middle" x="16022" y="-127.8" font-family="Times,serif" font-size="14.00">Group 3</text>
</g>
<!-- proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge121" class="edge">
<title>proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16185.72,-223.96C16176.43,-212.54 16164.3,-199.71 16151,-191 16138.03,-182.5 16123.23,-175.5 16108.39,-169.79"/>
<polygon fill="black" stroke="black" points="16109.25,-166.38 16098.65,-166.22 16106.84,-172.95 16109.25,-166.38"/>
<text text-anchor="middle" x="16231.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 12→Group 3</text>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge128" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16098.97,-139.65C16330.65,-122.04 17020.92,-69.58 17271.66,-50.52"/>
<polygon fill="black" stroke="black" points="17272.13,-53.99 17281.83,-49.75 17271.6,-47.01 17272.13,-53.99"/>
<text text-anchor="middle" x="16817.5" y="-90.8" font-family="Times,serif" font-size="14.00">Group 3→All</text>
</g>
<!-- proj_3_3_1 -->
<g id="node268" class="node">
<title>proj_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="16094,-277 15950,-277 15950,-224 16094,-224 16094,-277"/>
<text text-anchor="middle" x="16022" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16022" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="16022" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge122" class="edge">
<title>proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16022,-223.76C16022,-211.56 16022,-196.78 16022,-183.49"/>
<polygon fill="black" stroke="black" points="16025.5,-183.23 16022,-173.23 16018.5,-183.23 16025.5,-183.23"/>
<text text-anchor="middle" x="16084.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 13→Group 3</text>
</g>
<!-- proj_3_3_2 -->
<g id="node269" class="node">
<title>proj_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="15891,-277 15747,-277 15747,-224 15891,-224 15891,-277"/>
<text text-anchor="middle" x="15819" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15819" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="15819" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge123" class="edge">
<title>proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15846.55,-223.98C15859.83,-212.7 15876.45,-199.98 15893,-191 15906.38,-183.74 15921.19,-177.38 15935.86,-171.93"/>
<polygon fill="black" stroke="black" points="15937.24,-175.15 15945.47,-168.48 15934.88,-168.57 15937.24,-175.15"/>
<text text-anchor="middle" x="15955.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 14→Group 3</text>
</g>
<!-- proj_3_3_3 -->
<g id="node270" class="node">
<title>proj_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="15709,-277 15565,-277 15565,-224 15709,-224 15709,-277"/>
<text text-anchor="middle" x="15637" y="-261.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15637" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 512]</text>
<text text-anchor="middle" x="15637" y="-231.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge124" class="edge">
<title>proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15675.34,-223.81C15694.59,-212.06 15718.71,-199.01 15742,-191 15804.63,-169.46 15878.82,-158.55 15935.09,-153.04"/>
<polygon fill="black" stroke="black" points="15935.75,-156.49 15945.38,-152.07 15935.1,-149.52 15935.75,-156.49"/>
<text text-anchor="middle" x="15804.5" y="-194.8" font-family="Times,serif" font-size="14.00">GPU 15→Group 3</text>
</g>
<!-- gate_3 -->
<g id="node272" class="node">
<title>gate_3</title>
<polygon fill="gold" stroke="black" points="19966,-515 19858,-515 19858,-462 19966,-462 19966,-515"/>
<text text-anchor="middle" x="19912" y="-499.8" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="19912" y="-484.8" font-family="Times,serif" font-size="14.00">[1048576, 8]</text>
<text text-anchor="middle" x="19912" y="-469.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_3_0 -->
<g id="node273" class="node">
<title>expert_3_0</title>
<polygon fill="lightblue" stroke="black" points="19460.5,-396 19325.5,-396 19325.5,-328 19460.5,-328 19460.5,-396"/>
<text text-anchor="middle" x="19393" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="19393" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="19393" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="19393" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge129" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19857.76,-485.54C19739.74,-480.85 19467.38,-467.59 19433,-444 19419.74,-434.9 19410.68,-420.1 19404.59,-405.62"/>
<polygon fill="red" stroke="red" points="19407.84,-404.31 19401,-396.21 19401.3,-406.8 19407.84,-404.31"/>
<text text-anchor="middle" x="19464.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="19464.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge416" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19857.94,-488.41C19784.7,-488.04 19650.82,-481.56 19544,-444 19520.27,-435.65 19517.97,-426.26 19496,-414 19487.51,-409.26 19478.51,-404.47 19469.52,-399.83"/>
<polygon fill="black" stroke="black" points="19471.04,-396.68 19460.54,-395.25 19467.85,-402.91 19471.04,-396.68"/>
</g>
<!-- expert_3_1 -->
<g id="node274" class="node">
<title>expert_3_1</title>
<polygon fill="lightgreen" stroke="black" points="19613.5,-396 19478.5,-396 19478.5,-328 19613.5,-328 19613.5,-396"/>
<text text-anchor="middle" x="19546" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="19546" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="19546" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="19546" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge130" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19857.77,-487.99C19771.14,-487.61 19606.98,-481.76 19565,-444 19554.37,-434.44 19549.12,-420.16 19546.68,-406.25"/>
<polygon fill="red" stroke="red" points="19550.14,-405.71 19545.36,-396.25 19543.2,-406.62 19550.14,-405.71"/>
<text text-anchor="middle" x="19596.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="19596.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge418" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19857.7,-479.43C19816.69,-472.46 19759.39,-460.83 19711,-444 19677.81,-432.46 19642.65,-415.86 19613.35,-400.69"/>
<polygon fill="black" stroke="black" points="19614.94,-397.57 19604.45,-396.03 19611.69,-403.77 19614.94,-397.57"/>
</g>
<!-- expert_3_2 -->
<g id="node275" class="node">
<title>expert_3_2</title>
<polygon fill="lightyellow" stroke="black" points="19766.5,-396 19631.5,-396 19631.5,-328 19766.5,-328 19766.5,-396"/>
<text text-anchor="middle" x="19699" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="19699" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="19699" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="19699" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge131" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19857.62,-485.72C19820.32,-481.88 19771.68,-471.43 19738,-444 19725.91,-434.15 19717.31,-419.65 19711.33,-405.62"/>
<polygon fill="red" stroke="red" points="19714.49,-404.1 19707.59,-396.05 19707.97,-406.64 19714.49,-404.1"/>
<text text-anchor="middle" x="19769.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="19769.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge420" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19861.12,-461.94C19851.51,-456.44 19841.74,-450.35 19833,-444 19817.23,-432.54 19817,-425.14 19801,-414 19793.02,-408.44 19784.35,-403.14 19775.54,-398.2"/>
<polygon fill="black" stroke="black" points="19777.16,-395.1 19766.71,-393.38 19773.81,-401.24 19777.16,-395.1"/>
</g>
<!-- expert_3_3 -->
<g id="node276" class="node">
<title>expert_3_3</title>
<polygon fill="lightcoral" stroke="black" points="19919.5,-396 19784.5,-396 19784.5,-328 19919.5,-328 19919.5,-396"/>
<text text-anchor="middle" x="19852" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="19852" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="19852" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="19852" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge132" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19859.24,-461.94C19853.14,-456.84 19847.77,-450.88 19844,-444 19837.79,-432.65 19837.04,-419.07 19838.65,-406.29"/>
<polygon fill="red" stroke="red" points="19842.12,-406.73 19840.38,-396.28 19835.23,-405.54 19842.12,-406.73"/>
<text text-anchor="middle" x="19875.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="19875.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge422" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19914.79,-461.83C19915.3,-447.15 19914.05,-428.77 19907,-414 19905.39,-410.63 19903.45,-407.37 19901.28,-404.25"/>
<polygon fill="black" stroke="black" points="19903.96,-402 19895.03,-396.3 19898.45,-406.32 19903.96,-402"/>
</g>
<!-- expert_3_4 -->
<g id="node277" class="node">
<title>expert_3_4</title>
<polygon fill="lightpink" stroke="black" points="20072.5,-396 19937.5,-396 19937.5,-328 20072.5,-328 20072.5,-396"/>
<text text-anchor="middle" x="20005" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="20005" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="20005" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="20005" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_3&#45;&gt;expert_3_4 -->
<g id="edge133" class="edge">
<title>gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19916.73,-461.92C19920.43,-446.92 19926.71,-428.18 19937,-414 19939.71,-410.27 19942.76,-406.69 19946.04,-403.28"/>
<polygon fill="red" stroke="red" points="19948.74,-405.55 19953.54,-396.1 19943.9,-400.49 19948.74,-405.55"/>
<text text-anchor="middle" x="19968.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="19968.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<!-- gate_3&#45;&gt;expert_3_4 -->
<g id="edge424" class="edge">
<title>gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19966.15,-471.58C19979.29,-465.12 19991.89,-456.21 20000,-444 20007.26,-433.08 20009.9,-419.38 20010.32,-406.38"/>
<polygon fill="black" stroke="black" points="20013.82,-406.13 20010.23,-396.17 20006.82,-406.2 20013.82,-406.13"/>
</g>
<!-- expert_3_5 -->
<g id="node278" class="node">
<title>expert_3_5</title>
<polygon fill="lightcyan" stroke="black" points="20225.5,-396 20090.5,-396 20090.5,-328 20225.5,-328 20225.5,-396"/>
<text text-anchor="middle" x="20158" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="20158" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="20158" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="20158" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_3&#45;&gt;expert_3_5 -->
<g id="edge134" class="edge">
<title>gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19966.12,-464.5C19980.23,-458.16 19995.31,-451.07 20009,-444 20032.37,-431.93 20037,-426.74 20060,-414 20067.82,-409.67 20076.05,-405.22 20084.27,-400.84"/>
<polygon fill="red" stroke="red" points="20085.97,-403.91 20093.17,-396.13 20082.7,-397.72 20085.97,-403.91"/>
<text text-anchor="middle" x="20091.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="20091.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<!-- gate_3&#45;&gt;expert_3_5 -->
<g id="edge426" class="edge">
<title>gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19966.2,-482.04C20020.52,-475.58 20099.39,-463.21 20123,-444 20134.87,-434.34 20142.81,-419.87 20148.08,-405.83"/>
<polygon fill="black" stroke="black" points="20151.43,-406.84 20151.31,-396.24 20144.8,-404.6 20151.43,-406.84"/>
</g>
<!-- expert_3_6 -->
<g id="node279" class="node">
<title>expert_3_6</title>
<polygon fill="lightgrey" stroke="black" points="20378.5,-396 20243.5,-396 20243.5,-328 20378.5,-328 20378.5,-396"/>
<text text-anchor="middle" x="20311" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="20311" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="20311" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="20311" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_3&#45;&gt;expert_3_6 -->
<g id="edge135" class="edge">
<title>gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19966.03,-481.33C20012.5,-475.03 20080.86,-463.37 20138,-444 20166.24,-434.43 20171.07,-426.8 20198,-414 20209.62,-408.48 20221.97,-402.75 20234.08,-397.22"/>
<polygon fill="red" stroke="red" points="20235.62,-400.37 20243.28,-393.04 20232.73,-393.99 20235.62,-400.37"/>
<text text-anchor="middle" x="20229.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="20229.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<!-- gate_3&#45;&gt;expert_3_6 -->
<g id="edge428" class="edge">
<title>gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19966.33,-486.37C20051.94,-483.67 20213.41,-474.56 20261,-444 20275.39,-434.76 20286.32,-419.74 20294.24,-405.14"/>
<polygon fill="black" stroke="black" points="20297.39,-406.66 20298.78,-396.15 20291.14,-403.5 20297.39,-406.66"/>
</g>
<!-- expert_3_7 -->
<g id="node280" class="node">
<title>expert_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="20531.5,-396 20396.5,-396 20396.5,-328 20531.5,-328 20531.5,-396"/>
<text text-anchor="middle" x="20464" y="-380.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="20464" y="-365.8" font-family="Times,serif" font-size="14.00">FFN 32768</text>
<text text-anchor="middle" x="20464" y="-350.8" font-family="Times,serif" font-size="14.00">[1048576, 8192]</text>
<text text-anchor="middle" x="20464" y="-335.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_3&#45;&gt;expert_3_7 -->
<g id="edge136" class="edge">
<title>gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19966.21,-486.37C20038.74,-483.66 20170.79,-474.55 20279,-444 20309.62,-435.35 20314.82,-426.69 20344,-414 20360.95,-406.62 20367.02,-404.66 20387,-396.38"/>
<polygon fill="red" stroke="red" points="20388.61,-399.49 20396.49,-392.4 20385.91,-393.04 20388.61,-399.49"/>
<text text-anchor="middle" x="20375.5" y="-432.8" font-family="Times,serif" font-size="14.00">Routing</text>
<text text-anchor="middle" x="20375.5" y="-417.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<!-- gate_3&#45;&gt;expert_3_7 -->
<g id="edge430" class="edge">
<title>gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19966.43,-485.3C20087.12,-480.04 20369.53,-465.58 20407,-444 20422.69,-434.96 20435.12,-419.65 20444.32,-404.75"/>
<polygon fill="black" stroke="black" points="20447.36,-406.49 20449.36,-396.08 20441.3,-402.97 20447.36,-406.49"/>
</g>
<!-- expert_agg_3 -->
<g id="node281" class="node">
<title>expert_agg_3</title>
<polygon fill="lightsteelblue" stroke="black" points="20086,-277 19928,-277 19928,-224 20086,-224 20086,-277"/>
<text text-anchor="middle" x="20007" y="-261.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="20007" y="-246.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="20007" y="-231.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge137" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19393.22,-327.9C19395.08,-315.78 19399.46,-303.08 19409,-295 19446.89,-262.91 19760.52,-254.49 19917.79,-252.28"/>
<polygon fill="black" stroke="black" points="19917.96,-255.78 19927.92,-252.15 19917.87,-248.78 19917.96,-255.78"/>
<text text-anchor="middle" x="19460.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 0→Agg</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge417" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M19460.68,-332.01C19487.37,-320.57 19511.82,-310.09 19512,-310 19524.32,-303.96 19525.89,-299.06 19539,-295 19607.39,-273.85 19801.87,-261.26 19917.48,-255.43"/>
<polygon fill="black" stroke="black" points="19917.91,-258.91 19927.72,-254.92 19917.56,-251.92 19917.91,-258.91"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge138" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19540.91,-327.8C19540.99,-315.96 19543.56,-303.48 19552,-295 19577.22,-269.67 19792.34,-258.44 19917.55,-254.02"/>
<polygon fill="black" stroke="black" points="19918.02,-257.51 19927.89,-253.66 19917.78,-250.51 19918.02,-257.51"/>
<text text-anchor="middle" x="19603.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 1→Agg</text>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge419" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M19613.73,-331.38C19627.59,-324.74 19641.93,-317.45 19655,-310 19665.28,-304.14 19665.94,-299.22 19677,-295 19754.79,-265.3 19849.57,-255.25 19917.56,-252.14"/>
<polygon fill="black" stroke="black" points="19917.97,-255.63 19927.81,-251.72 19917.68,-248.63 19917.97,-255.63"/>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge139" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19683.39,-327.77C19680.37,-316.22 19680.21,-303.93 19688,-295 19717.32,-261.41 19833.95,-252.79 19917.71,-251.07"/>
<polygon fill="black" stroke="black" points="19917.82,-254.57 19927.75,-250.89 19917.69,-247.57 19917.82,-254.57"/>
<text text-anchor="middle" x="19739.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 2→Agg</text>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge421" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M19760.93,-327.94C19771.09,-322.15 19781.43,-316.05 19791,-310 19800.7,-303.88 19801.53,-299.68 19812,-295 19845.15,-280.2 19883.79,-270.23 19917.89,-263.62"/>
<polygon fill="black" stroke="black" points="19918.66,-267.03 19927.85,-261.75 19917.37,-260.15 19918.66,-267.03"/>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge140" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19822.34,-327.72C19816.03,-316.67 19813.29,-304.72 19821,-295 19833.59,-279.12 19876.55,-268.49 19918,-261.72"/>
<polygon fill="black" stroke="black" points="19918.59,-265.17 19927.93,-260.16 19917.51,-258.25 19918.59,-265.17"/>
<text text-anchor="middle" x="19872.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 3→Agg</text>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge423" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M19898.93,-327.85C19919.04,-313.64 19942.43,-297.12 19962.29,-283.08"/>
<polygon fill="black" stroke="black" points="19964.42,-285.87 19970.57,-277.24 19960.38,-280.15 19964.42,-285.87"/>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge141" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19960.9,-327.92C19952.88,-317.92 19948.55,-306.52 19954,-295 19955.73,-291.35 19957.92,-287.91 19960.44,-284.67"/>
<polygon fill="black" stroke="black" points="19963.18,-286.86 19967.26,-277.09 19957.97,-282.19 19963.18,-286.86"/>
<text text-anchor="middle" x="20005.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 4→Agg</text>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge425" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M20045.85,-327.91C20050.37,-322.42 20054.31,-316.41 20057,-310 20060.72,-301.13 20058.4,-292.63 20053.14,-284.98"/>
<polygon fill="black" stroke="black" points="20055.55,-282.42 20046.42,-277.05 20050.21,-286.94 20055.55,-282.42"/>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge142" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20111.75,-327.86C20103.5,-321.93 20094.99,-315.79 20087,-310 20075,-301.3 20062.02,-291.84 20050.08,-283.1"/>
<polygon fill="black" stroke="black" points="20052.14,-280.27 20042,-277.19 20048,-285.92 20052.14,-280.27"/>
<text text-anchor="middle" x="20138.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 5→Agg</text>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge427" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M20188.36,-327.8C20194.86,-316.76 20197.74,-304.79 20190,-295 20177.8,-279.55 20136.5,-269.01 20096.22,-262.17"/>
<polygon fill="black" stroke="black" points="20096.73,-258.71 20086.3,-260.56 20095.6,-265.62 20096.73,-258.71"/>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge143" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20250.46,-327.82C20240.23,-322 20229.76,-315.91 20220,-310 20209.56,-303.68 20208.23,-299.77 20197,-295 20165.24,-281.52 20128.65,-271.87 20096.1,-265.15"/>
<polygon fill="black" stroke="black" points="20096.63,-261.69 20086.14,-263.16 20095.26,-268.55 20096.63,-261.69"/>
<text text-anchor="middle" x="20271.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 6→Agg</text>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge429" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M20327.28,-327.8C20330.49,-316.25 20330.81,-303.95 20323,-295 20294.09,-261.84 20179.36,-253.08 20096.46,-251.21"/>
<polygon fill="black" stroke="black" points="20096.33,-247.71 20086.26,-251.01 20096.19,-254.71 20096.33,-247.71"/>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge144" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20396.5,-330.97C20382.62,-324.37 20368.21,-317.19 20355,-310 20343.95,-303.99 20342.83,-299.27 20331,-295 20254.7,-267.49 20162.61,-257.14 20096.15,-253.36"/>
<polygon fill="black" stroke="black" points="20096.29,-249.86 20086.12,-252.83 20095.92,-256.85 20096.29,-249.86"/>
<text text-anchor="middle" x="20406.5" y="-298.8" font-family="Times,serif" font-size="14.00">Expert 7→Agg</text>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge431" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M20469.09,-327.8C20469.01,-315.97 20466.44,-303.48 20458,-295 20433.08,-269.94 20220.92,-258.63 20096.67,-254.11"/>
<polygon fill="black" stroke="black" points="20096.52,-250.6 20086.41,-253.75 20096.28,-257.6 20096.52,-250.6"/>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge432" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M20050.76,-223.76C20076.85,-209.76 20110.37,-192.35 20139.44,-177.7"/>
<polygon fill="black" stroke="black" points="20141.34,-180.67 20148.71,-173.05 20138.2,-174.41 20141.34,-180.67"/>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge435" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M20062.4,-223.89C20090.3,-209.95 20123.89,-192.6 20151.39,-177.97"/>
<polygon fill="black" stroke="black" points="20153.3,-180.92 20160.47,-173.12 20150,-174.75 20153.3,-180.92"/>
</g>
<!-- qkv_3_0_0 -->
<g id="node283" class="node">
<title>qkv_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="19201.5,-605 19048.5,-605 19048.5,-552 19201.5,-552 19201.5,-605"/>
<text text-anchor="middle" x="19125" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19125" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="19125" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_3&#45;&gt;qkv_3_0_0 -->
<g id="edge365" class="edge">
<title>ln1_3&#45;&gt;qkv_3_0_0</title>
<path fill="none" stroke="black" d="M16481.62,-666.85C16887.57,-663.22 18778.19,-644.33 19036,-605 19036.74,-604.89 19037.49,-604.77 19038.24,-604.65"/>
<polygon fill="black" stroke="black" points="19038.88,-608.09 19048.08,-602.84 19037.62,-601.2 19038.88,-608.09"/>
</g>
<!-- reshape_3_0_0 -->
<g id="node284" class="node">
<title>reshape_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="19243,-515 19081,-515 19081,-462 19243,-462 19243,-515"/>
<text text-anchor="middle" x="19162" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="19162" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="19162" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_3_0_0&#45;&gt;reshape_3_0_0 -->
<g id="edge366" class="edge">
<title>qkv_3_0_0&#45;&gt;reshape_3_0_0</title>
<path fill="none" stroke="black" d="M19135.9,-551.57C19139.44,-543.16 19143.43,-533.68 19147.2,-524.7"/>
<polygon fill="black" stroke="black" points="19150.53,-525.82 19151.18,-515.24 19144.07,-523.1 19150.53,-525.82"/>
</g>
<!-- attn_3_0_0 -->
<g id="node285" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightblue" stroke="black" points="19307,-388.5 19081,-388.5 19081,-335.5 19307,-335.5 19307,-388.5"/>
<text text-anchor="middle" x="19194" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="19194" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="19194" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge367" class="edge">
<title>reshape_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M19168.63,-461.7C19173.33,-443.42 19179.69,-418.67 19184.87,-398.53"/>
<polygon fill="black" stroke="black" points="19188.28,-399.32 19187.38,-388.76 19181.5,-397.58 19188.28,-399.32"/>
</g>
<!-- attn_3_0_0&#45;&gt;proj_3_0_0 -->
<g id="edge368" class="edge">
<title>attn_3_0_0&#45;&gt;proj_3_0_0</title>
<path fill="none" stroke="black" d="M19177.12,-335.33C19167.37,-320.5 19154.98,-301.66 19144.43,-285.61"/>
<polygon fill="black" stroke="black" points="19147.19,-283.44 19138.78,-277.01 19141.34,-287.29 19147.19,-283.44"/>
</g>
<!-- qkv_3_0_1 -->
<g id="node286" class="node">
<title>qkv_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="19026.5,-605 18873.5,-605 18873.5,-552 19026.5,-552 19026.5,-605"/>
<text text-anchor="middle" x="18950" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18950" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="18950" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_3_0_1 -->
<g id="node287" class="node">
<title>reshape_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="19031,-515 18869,-515 18869,-462 19031,-462 19031,-515"/>
<text text-anchor="middle" x="18950" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="18950" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18950" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_3_0_1&#45;&gt;reshape_3_0_1 -->
<g id="edge369" class="edge">
<title>qkv_3_0_1&#45;&gt;reshape_3_0_1</title>
<path fill="none" stroke="black" d="M18950,-551.57C18950,-543.34 18950,-534.08 18950,-525.28"/>
<polygon fill="black" stroke="black" points="18953.5,-525.24 18950,-515.24 18946.5,-525.24 18953.5,-525.24"/>
</g>
<!-- attn_3_0_1 -->
<g id="node288" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="19063,-388.5 18837,-388.5 18837,-335.5 19063,-335.5 19063,-388.5"/>
<text text-anchor="middle" x="18950" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18950" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18950" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge370" class="edge">
<title>reshape_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M18950,-461.7C18950,-443.51 18950,-418.9 18950,-398.8"/>
<polygon fill="black" stroke="black" points="18953.5,-398.76 18950,-388.76 18946.5,-398.76 18953.5,-398.76"/>
</g>
<!-- attn_3_0_1&#45;&gt;proj_3_0_1 -->
<g id="edge371" class="edge">
<title>attn_3_0_1&#45;&gt;proj_3_0_1</title>
<path fill="none" stroke="black" d="M18935.46,-335.33C18927.15,-320.64 18916.6,-302.01 18907.56,-286.05"/>
<polygon fill="black" stroke="black" points="18910.42,-283.99 18902.45,-277.01 18904.33,-287.44 18910.42,-283.99"/>
</g>
<!-- qkv_3_0_2 -->
<g id="node289" class="node">
<title>qkv_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="18782.5,-605 18629.5,-605 18629.5,-552 18782.5,-552 18782.5,-605"/>
<text text-anchor="middle" x="18706" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18706" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="18706" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_3_0_2 -->
<g id="node290" class="node">
<title>reshape_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="18787,-515 18625,-515 18625,-462 18787,-462 18787,-515"/>
<text text-anchor="middle" x="18706" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="18706" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18706" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_3_0_2&#45;&gt;reshape_3_0_2 -->
<g id="edge372" class="edge">
<title>qkv_3_0_2&#45;&gt;reshape_3_0_2</title>
<path fill="none" stroke="black" d="M18706,-551.57C18706,-543.34 18706,-534.08 18706,-525.28"/>
<polygon fill="black" stroke="black" points="18709.5,-525.24 18706,-515.24 18702.5,-525.24 18709.5,-525.24"/>
</g>
<!-- attn_3_0_2 -->
<g id="node291" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightyellow" stroke="black" points="18819,-388.5 18593,-388.5 18593,-335.5 18819,-335.5 18819,-388.5"/>
<text text-anchor="middle" x="18706" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18706" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18706" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge373" class="edge">
<title>reshape_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M18706,-461.7C18706,-443.51 18706,-418.9 18706,-398.8"/>
<polygon fill="black" stroke="black" points="18709.5,-398.76 18706,-388.76 18702.5,-398.76 18709.5,-398.76"/>
</g>
<!-- attn_3_0_2&#45;&gt;proj_3_0_2 -->
<g id="edge374" class="edge">
<title>attn_3_0_2&#45;&gt;proj_3_0_2</title>
<path fill="none" stroke="black" d="M18706,-335.33C18706,-321.05 18706,-303.05 18706,-287.4"/>
<polygon fill="black" stroke="black" points="18709.5,-287.01 18706,-277.01 18702.5,-287.01 18709.5,-287.01"/>
</g>
<!-- qkv_3_0_3 -->
<g id="node292" class="node">
<title>qkv_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="18538.5,-605 18385.5,-605 18385.5,-552 18538.5,-552 18538.5,-605"/>
<text text-anchor="middle" x="18462" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18462" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="18462" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_3_0_3 -->
<g id="node293" class="node">
<title>reshape_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="18543,-515 18381,-515 18381,-462 18543,-462 18543,-515"/>
<text text-anchor="middle" x="18462" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="18462" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18462" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_3_0_3&#45;&gt;reshape_3_0_3 -->
<g id="edge375" class="edge">
<title>qkv_3_0_3&#45;&gt;reshape_3_0_3</title>
<path fill="none" stroke="black" d="M18462,-551.57C18462,-543.34 18462,-534.08 18462,-525.28"/>
<polygon fill="black" stroke="black" points="18465.5,-525.24 18462,-515.24 18458.5,-525.24 18465.5,-525.24"/>
</g>
<!-- attn_3_0_3 -->
<g id="node294" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="18575,-388.5 18349,-388.5 18349,-335.5 18575,-335.5 18575,-388.5"/>
<text text-anchor="middle" x="18462" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18462" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18462" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge376" class="edge">
<title>reshape_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M18462,-461.7C18462,-443.51 18462,-418.9 18462,-398.8"/>
<polygon fill="black" stroke="black" points="18465.5,-398.76 18462,-388.76 18458.5,-398.76 18465.5,-398.76"/>
</g>
<!-- attn_3_0_3&#45;&gt;proj_3_0_3 -->
<g id="edge377" class="edge">
<title>attn_3_0_3&#45;&gt;proj_3_0_3</title>
<path fill="none" stroke="black" d="M18476.54,-335.33C18484.85,-320.64 18495.4,-302.01 18504.44,-286.05"/>
<polygon fill="black" stroke="black" points="18507.67,-287.44 18509.55,-277.01 18501.58,-283.99 18507.67,-287.44"/>
</g>
<!-- qkv_3_1_0 -->
<g id="node295" class="node">
<title>qkv_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="18294.5,-605 18141.5,-605 18141.5,-552 18294.5,-552 18294.5,-605"/>
<text text-anchor="middle" x="18218" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18218" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="18218" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_3_1_0 -->
<g id="node296" class="node">
<title>reshape_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="18299,-515 18137,-515 18137,-462 18299,-462 18299,-515"/>
<text text-anchor="middle" x="18218" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="18218" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18218" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_3_1_0&#45;&gt;reshape_3_1_0 -->
<g id="edge378" class="edge">
<title>qkv_3_1_0&#45;&gt;reshape_3_1_0</title>
<path fill="none" stroke="black" d="M18218,-551.57C18218,-543.34 18218,-534.08 18218,-525.28"/>
<polygon fill="black" stroke="black" points="18221.5,-525.24 18218,-515.24 18214.5,-525.24 18221.5,-525.24"/>
</g>
<!-- attn_3_1_0 -->
<g id="node297" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightpink" stroke="black" points="18331,-388.5 18105,-388.5 18105,-335.5 18331,-335.5 18331,-388.5"/>
<text text-anchor="middle" x="18218" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="18218" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="18218" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge379" class="edge">
<title>reshape_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M18218,-461.7C18218,-443.51 18218,-418.9 18218,-398.8"/>
<polygon fill="black" stroke="black" points="18221.5,-398.76 18218,-388.76 18214.5,-398.76 18221.5,-398.76"/>
</g>
<!-- attn_3_1_0&#45;&gt;proj_3_1_0 -->
<g id="edge380" class="edge">
<title>attn_3_1_0&#45;&gt;proj_3_1_0</title>
<path fill="none" stroke="black" d="M18196.43,-335.33C18183.74,-320.23 18167.56,-300.97 18153.91,-284.72"/>
<polygon fill="black" stroke="black" points="18156.55,-282.42 18147.43,-277.01 18151.19,-286.92 18156.55,-282.42"/>
</g>
<!-- qkv_3_1_1 -->
<g id="node298" class="node">
<title>qkv_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="18050.5,-605 17897.5,-605 17897.5,-552 18050.5,-552 18050.5,-605"/>
<text text-anchor="middle" x="17974" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17974" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="17974" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_3_1_1 -->
<g id="node299" class="node">
<title>reshape_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="18055,-515 17893,-515 17893,-462 18055,-462 18055,-515"/>
<text text-anchor="middle" x="17974" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="17974" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17974" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_3_1_1&#45;&gt;reshape_3_1_1 -->
<g id="edge381" class="edge">
<title>qkv_3_1_1&#45;&gt;reshape_3_1_1</title>
<path fill="none" stroke="black" d="M17974,-551.57C17974,-543.34 17974,-534.08 17974,-525.28"/>
<polygon fill="black" stroke="black" points="17977.5,-525.24 17974,-515.24 17970.5,-525.24 17977.5,-525.24"/>
</g>
<!-- attn_3_1_1 -->
<g id="node300" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightcyan" stroke="black" points="18087,-388.5 17861,-388.5 17861,-335.5 18087,-335.5 18087,-388.5"/>
<text text-anchor="middle" x="17974" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17974" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17974" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge382" class="edge">
<title>reshape_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M17974,-461.7C17974,-443.51 17974,-418.9 17974,-398.8"/>
<polygon fill="black" stroke="black" points="17977.5,-398.76 17974,-388.76 17970.5,-398.76 17977.5,-398.76"/>
</g>
<!-- attn_3_1_1&#45;&gt;proj_3_1_1 -->
<g id="edge383" class="edge">
<title>attn_3_1_1&#45;&gt;proj_3_1_1</title>
<path fill="none" stroke="black" d="M17960.64,-335.33C17952.99,-320.64 17943.29,-302.01 17934.99,-286.05"/>
<polygon fill="black" stroke="black" points="17938,-284.27 17930.28,-277.01 17931.79,-287.5 17938,-284.27"/>
</g>
<!-- qkv_3_1_2 -->
<g id="node301" class="node">
<title>qkv_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="17806.5,-605 17653.5,-605 17653.5,-552 17806.5,-552 17806.5,-605"/>
<text text-anchor="middle" x="17730" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17730" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="17730" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_3_1_2 -->
<g id="node302" class="node">
<title>reshape_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="17811,-515 17649,-515 17649,-462 17811,-462 17811,-515"/>
<text text-anchor="middle" x="17730" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="17730" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17730" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_3_1_2&#45;&gt;reshape_3_1_2 -->
<g id="edge384" class="edge">
<title>qkv_3_1_2&#45;&gt;reshape_3_1_2</title>
<path fill="none" stroke="black" d="M17730,-551.57C17730,-543.34 17730,-534.08 17730,-525.28"/>
<polygon fill="black" stroke="black" points="17733.5,-525.24 17730,-515.24 17726.5,-525.24 17733.5,-525.24"/>
</g>
<!-- attn_3_1_2 -->
<g id="node303" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgrey" stroke="black" points="17843,-388.5 17617,-388.5 17617,-335.5 17843,-335.5 17843,-388.5"/>
<text text-anchor="middle" x="17730" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17730" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17730" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge385" class="edge">
<title>reshape_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M17730,-461.7C17730,-443.51 17730,-418.9 17730,-398.8"/>
<polygon fill="black" stroke="black" points="17733.5,-398.76 17730,-388.76 17726.5,-398.76 17733.5,-398.76"/>
</g>
<!-- attn_3_1_2&#45;&gt;proj_3_1_2 -->
<g id="edge386" class="edge">
<title>attn_3_1_2&#45;&gt;proj_3_1_2</title>
<path fill="none" stroke="black" d="M17730,-335.33C17730,-321.05 17730,-303.05 17730,-287.4"/>
<polygon fill="black" stroke="black" points="17733.5,-287.01 17730,-277.01 17726.5,-287.01 17733.5,-287.01"/>
</g>
<!-- qkv_3_1_3 -->
<g id="node304" class="node">
<title>qkv_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="17562.5,-605 17409.5,-605 17409.5,-552 17562.5,-552 17562.5,-605"/>
<text text-anchor="middle" x="17486" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17486" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="17486" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_3_1_3 -->
<g id="node305" class="node">
<title>reshape_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="17567,-515 17405,-515 17405,-462 17567,-462 17567,-515"/>
<text text-anchor="middle" x="17486" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="17486" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17486" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_3_1_3&#45;&gt;reshape_3_1_3 -->
<g id="edge387" class="edge">
<title>qkv_3_1_3&#45;&gt;reshape_3_1_3</title>
<path fill="none" stroke="black" d="M17486,-551.57C17486,-543.34 17486,-534.08 17486,-525.28"/>
<polygon fill="black" stroke="black" points="17489.5,-525.24 17486,-515.24 17482.5,-525.24 17489.5,-525.24"/>
</g>
<!-- attn_3_1_3 -->
<g id="node306" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightseagreen" stroke="black" points="17599,-388.5 17373,-388.5 17373,-335.5 17599,-335.5 17599,-388.5"/>
<text text-anchor="middle" x="17486" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17486" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17486" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge388" class="edge">
<title>reshape_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M17486,-461.7C17486,-443.51 17486,-418.9 17486,-398.8"/>
<polygon fill="black" stroke="black" points="17489.5,-398.76 17486,-388.76 17482.5,-398.76 17489.5,-398.76"/>
</g>
<!-- attn_3_1_3&#45;&gt;proj_3_1_3 -->
<g id="edge389" class="edge">
<title>attn_3_1_3&#45;&gt;proj_3_1_3</title>
<path fill="none" stroke="black" d="M17495.61,-335.33C17501.06,-320.77 17507.96,-302.36 17513.89,-286.5"/>
<polygon fill="black" stroke="black" points="17517.22,-287.6 17517.45,-277.01 17510.66,-285.15 17517.22,-287.6"/>
</g>
<!-- qkv_3_2_0 -->
<g id="node307" class="node">
<title>qkv_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="17318.5,-605 17165.5,-605 17165.5,-552 17318.5,-552 17318.5,-605"/>
<text text-anchor="middle" x="17242" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17242" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="17242" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_3_2_0 -->
<g id="node308" class="node">
<title>reshape_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="17323,-515 17161,-515 17161,-462 17323,-462 17323,-515"/>
<text text-anchor="middle" x="17242" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="17242" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17242" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_3_2_0&#45;&gt;reshape_3_2_0 -->
<g id="edge390" class="edge">
<title>qkv_3_2_0&#45;&gt;reshape_3_2_0</title>
<path fill="none" stroke="black" d="M17242,-551.57C17242,-543.34 17242,-534.08 17242,-525.28"/>
<polygon fill="black" stroke="black" points="17245.5,-525.24 17242,-515.24 17238.5,-525.24 17245.5,-525.24"/>
</g>
<!-- attn_3_2_0 -->
<g id="node309" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightsalmon" stroke="black" points="17355,-388.5 17129,-388.5 17129,-335.5 17355,-335.5 17355,-388.5"/>
<text text-anchor="middle" x="17242" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="17242" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="17242" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge391" class="edge">
<title>reshape_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M17242,-461.7C17242,-443.51 17242,-418.9 17242,-398.8"/>
<polygon fill="black" stroke="black" points="17245.5,-398.76 17242,-388.76 17238.5,-398.76 17245.5,-398.76"/>
</g>
<!-- attn_3_2_0&#45;&gt;proj_3_2_0 -->
<g id="edge392" class="edge">
<title>attn_3_2_0&#45;&gt;proj_3_2_0</title>
<path fill="none" stroke="black" d="M17232.39,-335.33C17226.94,-320.77 17220.04,-302.36 17214.11,-286.5"/>
<polygon fill="black" stroke="black" points="17217.34,-285.15 17210.55,-277.01 17210.78,-287.6 17217.34,-285.15"/>
</g>
<!-- qkv_3_2_1 -->
<g id="node310" class="node">
<title>qkv_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="17074.5,-605 16921.5,-605 16921.5,-552 17074.5,-552 17074.5,-605"/>
<text text-anchor="middle" x="16998" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16998" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="16998" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_3_2_1 -->
<g id="node311" class="node">
<title>reshape_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="17079,-515 16917,-515 16917,-462 17079,-462 17079,-515"/>
<text text-anchor="middle" x="16998" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="16998" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16998" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_3_2_1&#45;&gt;reshape_3_2_1 -->
<g id="edge393" class="edge">
<title>qkv_3_2_1&#45;&gt;reshape_3_2_1</title>
<path fill="none" stroke="black" d="M16998,-551.57C16998,-543.34 16998,-534.08 16998,-525.28"/>
<polygon fill="black" stroke="black" points="17001.5,-525.24 16998,-515.24 16994.5,-525.24 17001.5,-525.24"/>
</g>
<!-- attn_3_2_1 -->
<g id="node312" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightskyblue" stroke="black" points="17111,-388.5 16885,-388.5 16885,-335.5 17111,-335.5 17111,-388.5"/>
<text text-anchor="middle" x="16998" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16998" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16998" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge394" class="edge">
<title>reshape_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M16998,-461.7C16998,-443.51 16998,-418.9 16998,-398.8"/>
<polygon fill="black" stroke="black" points="17001.5,-398.76 16998,-388.76 16994.5,-398.76 17001.5,-398.76"/>
</g>
<!-- attn_3_2_1&#45;&gt;proj_3_2_1 -->
<g id="edge395" class="edge">
<title>attn_3_2_1&#45;&gt;proj_3_2_1</title>
<path fill="none" stroke="black" d="M16998,-335.33C16998,-321.05 16998,-303.05 16998,-287.4"/>
<polygon fill="black" stroke="black" points="17001.5,-287.01 16998,-277.01 16994.5,-287.01 17001.5,-287.01"/>
</g>
<!-- qkv_3_2_2 -->
<g id="node313" class="node">
<title>qkv_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="16830.5,-605 16677.5,-605 16677.5,-552 16830.5,-552 16830.5,-605"/>
<text text-anchor="middle" x="16754" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16754" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="16754" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_3_2_2 -->
<g id="node314" class="node">
<title>reshape_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="16835,-515 16673,-515 16673,-462 16835,-462 16835,-515"/>
<text text-anchor="middle" x="16754" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="16754" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16754" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_3_2_2&#45;&gt;reshape_3_2_2 -->
<g id="edge396" class="edge">
<title>qkv_3_2_2&#45;&gt;reshape_3_2_2</title>
<path fill="none" stroke="black" d="M16754,-551.57C16754,-543.34 16754,-534.08 16754,-525.28"/>
<polygon fill="black" stroke="black" points="16757.5,-525.24 16754,-515.24 16750.5,-525.24 16757.5,-525.24"/>
</g>
<!-- attn_3_2_2 -->
<g id="node315" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightslategray" stroke="black" points="16867,-388.5 16641,-388.5 16641,-335.5 16867,-335.5 16867,-388.5"/>
<text text-anchor="middle" x="16754" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16754" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16754" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge397" class="edge">
<title>reshape_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M16754,-461.7C16754,-443.51 16754,-418.9 16754,-398.8"/>
<polygon fill="black" stroke="black" points="16757.5,-398.76 16754,-388.76 16750.5,-398.76 16757.5,-398.76"/>
</g>
<!-- attn_3_2_2&#45;&gt;proj_3_2_2 -->
<g id="edge398" class="edge">
<title>attn_3_2_2&#45;&gt;proj_3_2_2</title>
<path fill="none" stroke="black" d="M16768.54,-335.33C16776.85,-320.64 16787.4,-302.01 16796.44,-286.05"/>
<polygon fill="black" stroke="black" points="16799.67,-287.44 16801.55,-277.01 16793.58,-283.99 16799.67,-287.44"/>
</g>
<!-- qkv_3_2_3 -->
<g id="node316" class="node">
<title>qkv_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16586.5,-605 16433.5,-605 16433.5,-552 16586.5,-552 16586.5,-605"/>
<text text-anchor="middle" x="16510" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16510" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="16510" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_3_2_3 -->
<g id="node317" class="node">
<title>reshape_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16591,-515 16429,-515 16429,-462 16591,-462 16591,-515"/>
<text text-anchor="middle" x="16510" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="16510" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16510" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_3_2_3&#45;&gt;reshape_3_2_3 -->
<g id="edge399" class="edge">
<title>qkv_3_2_3&#45;&gt;reshape_3_2_3</title>
<path fill="none" stroke="black" d="M16510,-551.57C16510,-543.34 16510,-534.08 16510,-525.28"/>
<polygon fill="black" stroke="black" points="16513.5,-525.24 16510,-515.24 16506.5,-525.24 16513.5,-525.24"/>
</g>
<!-- attn_3_2_3 -->
<g id="node318" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightsteelblue" stroke="black" points="16623,-388.5 16397,-388.5 16397,-335.5 16623,-335.5 16623,-388.5"/>
<text text-anchor="middle" x="16510" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16510" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16510" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge400" class="edge">
<title>reshape_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M16510,-461.7C16510,-443.51 16510,-418.9 16510,-398.8"/>
<polygon fill="black" stroke="black" points="16513.5,-398.76 16510,-388.76 16506.5,-398.76 16513.5,-398.76"/>
</g>
<!-- attn_3_2_3&#45;&gt;proj_3_2_3 -->
<g id="edge401" class="edge">
<title>attn_3_2_3&#45;&gt;proj_3_2_3</title>
<path fill="none" stroke="black" d="M16535.56,-335.33C16550.73,-320.09 16570.11,-300.61 16586.38,-284.27"/>
<polygon fill="black" stroke="black" points="16589.03,-286.57 16593.6,-277.01 16584.07,-281.63 16589.03,-286.57"/>
</g>
<!-- qkv_3_3_0 -->
<g id="node319" class="node">
<title>qkv_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16342.5,-605 16189.5,-605 16189.5,-552 16342.5,-552 16342.5,-605"/>
<text text-anchor="middle" x="16266" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16266" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="16266" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_3_3_0 -->
<g id="node320" class="node">
<title>reshape_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16347,-515 16185,-515 16185,-462 16347,-462 16347,-515"/>
<text text-anchor="middle" x="16266" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="16266" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16266" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_3_3_0&#45;&gt;reshape_3_3_0 -->
<g id="edge402" class="edge">
<title>qkv_3_3_0&#45;&gt;reshape_3_3_0</title>
<path fill="none" stroke="black" d="M16266,-551.57C16266,-543.34 16266,-534.08 16266,-525.28"/>
<polygon fill="black" stroke="black" points="16269.5,-525.24 16266,-515.24 16262.5,-525.24 16269.5,-525.24"/>
</g>
<!-- attn_3_3_0 -->
<g id="node321" class="node">
<title>attn_3_3_0</title>
<polygon fill="#eedd82" stroke="black" points="16379,-388.5 16153,-388.5 16153,-335.5 16379,-335.5 16379,-388.5"/>
<text text-anchor="middle" x="16266" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16266" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16266" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge403" class="edge">
<title>reshape_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M16266,-461.7C16266,-443.51 16266,-418.9 16266,-398.8"/>
<polygon fill="black" stroke="black" points="16269.5,-398.76 16266,-388.76 16262.5,-398.76 16269.5,-398.76"/>
</g>
<!-- attn_3_3_0&#45;&gt;proj_3_3_0 -->
<g id="edge404" class="edge">
<title>attn_3_3_0&#45;&gt;proj_3_3_0</title>
<path fill="none" stroke="black" d="M16251.46,-335.33C16243.15,-320.64 16232.6,-302.01 16223.56,-286.05"/>
<polygon fill="black" stroke="black" points="16226.42,-283.99 16218.45,-277.01 16220.33,-287.44 16226.42,-283.99"/>
</g>
<!-- qkv_3_3_1 -->
<g id="node322" class="node">
<title>qkv_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="16098.5,-605 15945.5,-605 15945.5,-552 16098.5,-552 16098.5,-605"/>
<text text-anchor="middle" x="16022" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16022" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="16022" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_3_3_1 -->
<g id="node323" class="node">
<title>reshape_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="16103,-515 15941,-515 15941,-462 16103,-462 16103,-515"/>
<text text-anchor="middle" x="16022" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="16022" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16022" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_3_3_1&#45;&gt;reshape_3_3_1 -->
<g id="edge405" class="edge">
<title>qkv_3_3_1&#45;&gt;reshape_3_3_1</title>
<path fill="none" stroke="black" d="M16022,-551.57C16022,-543.34 16022,-534.08 16022,-525.28"/>
<polygon fill="black" stroke="black" points="16025.5,-525.24 16022,-515.24 16018.5,-525.24 16025.5,-525.24"/>
</g>
<!-- attn_3_3_1 -->
<g id="node324" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightcyan" stroke="black" points="16135,-388.5 15909,-388.5 15909,-335.5 16135,-335.5 16135,-388.5"/>
<text text-anchor="middle" x="16022" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="16022" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="16022" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge406" class="edge">
<title>reshape_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M16022,-461.7C16022,-443.51 16022,-418.9 16022,-398.8"/>
<polygon fill="black" stroke="black" points="16025.5,-398.76 16022,-388.76 16018.5,-398.76 16025.5,-398.76"/>
</g>
<!-- attn_3_3_1&#45;&gt;proj_3_3_1 -->
<g id="edge407" class="edge">
<title>attn_3_3_1&#45;&gt;proj_3_3_1</title>
<path fill="none" stroke="black" d="M16022,-335.33C16022,-321.05 16022,-303.05 16022,-287.4"/>
<polygon fill="black" stroke="black" points="16025.5,-287.01 16022,-277.01 16018.5,-287.01 16025.5,-287.01"/>
</g>
<!-- qkv_3_3_2 -->
<g id="node325" class="node">
<title>qkv_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="15854.5,-605 15701.5,-605 15701.5,-552 15854.5,-552 15854.5,-605"/>
<text text-anchor="middle" x="15778" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15778" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="15778" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_3_3_2 -->
<g id="node326" class="node">
<title>reshape_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="15859,-515 15697,-515 15697,-462 15859,-462 15859,-515"/>
<text text-anchor="middle" x="15778" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="15778" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="15778" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_3_3_2&#45;&gt;reshape_3_3_2 -->
<g id="edge408" class="edge">
<title>qkv_3_3_2&#45;&gt;reshape_3_3_2</title>
<path fill="none" stroke="black" d="M15778,-551.57C15778,-543.34 15778,-534.08 15778,-525.28"/>
<polygon fill="black" stroke="black" points="15781.5,-525.24 15778,-515.24 15774.5,-525.24 15781.5,-525.24"/>
</g>
<!-- attn_3_3_2 -->
<g id="node327" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgray" stroke="black" points="15891,-388.5 15665,-388.5 15665,-335.5 15891,-335.5 15891,-388.5"/>
<text text-anchor="middle" x="15778" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15778" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="15778" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge409" class="edge">
<title>reshape_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M15778,-461.7C15778,-443.51 15778,-418.9 15778,-398.8"/>
<polygon fill="black" stroke="black" points="15781.5,-398.76 15778,-388.76 15774.5,-398.76 15781.5,-398.76"/>
</g>
<!-- attn_3_3_2&#45;&gt;proj_3_3_2 -->
<g id="edge410" class="edge">
<title>attn_3_3_2&#45;&gt;proj_3_3_2</title>
<path fill="none" stroke="black" d="M15787.61,-335.33C15793.06,-320.77 15799.96,-302.36 15805.89,-286.5"/>
<polygon fill="black" stroke="black" points="15809.22,-287.6 15809.45,-277.01 15802.66,-285.15 15809.22,-287.6"/>
</g>
<!-- qkv_3_3_3 -->
<g id="node328" class="node">
<title>qkv_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="15610.5,-605 15457.5,-605 15457.5,-552 15610.5,-552 15610.5,-605"/>
<text text-anchor="middle" x="15534" y="-589.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15534" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 1536]</text>
<text text-anchor="middle" x="15534" y="-559.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_3_3_3 -->
<g id="node329" class="node">
<title>reshape_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="15615,-515 15453,-515 15453,-462 15615,-462 15615,-515"/>
<text text-anchor="middle" x="15534" y="-499.8" font-family="Times,serif" font-size="14.00">Reshape</text>
<text text-anchor="middle" x="15534" y="-484.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="15534" y="-469.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_3_3_3&#45;&gt;reshape_3_3_3 -->
<g id="edge411" class="edge">
<title>qkv_3_3_3&#45;&gt;reshape_3_3_3</title>
<path fill="none" stroke="black" d="M15534,-551.57C15534,-543.34 15534,-534.08 15534,-525.28"/>
<polygon fill="black" stroke="black" points="15537.5,-525.24 15534,-515.24 15530.5,-525.24 15537.5,-525.24"/>
</g>
<!-- attn_3_3_3 -->
<g id="node330" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="15647,-388.5 15421,-388.5 15421,-335.5 15647,-335.5 15647,-388.5"/>
<text text-anchor="middle" x="15534" y="-373.3" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="15534" y="-358.3" font-family="Times,serif" font-size="14.00">[1024, 1024, 4, 128]</text>
<text text-anchor="middle" x="15534" y="-343.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge412" class="edge">
<title>reshape_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M15534,-461.7C15534,-443.51 15534,-418.9 15534,-398.8"/>
<polygon fill="black" stroke="black" points="15537.5,-398.76 15534,-388.76 15530.5,-398.76 15537.5,-398.76"/>
</g>
<!-- attn_3_3_3&#45;&gt;proj_3_3_3 -->
<g id="edge413" class="edge">
<title>attn_3_3_3&#45;&gt;proj_3_3_3</title>
<path fill="none" stroke="black" d="M15558.15,-335.33C15572.35,-320.23 15590.47,-300.97 15605.76,-284.72"/>
<polygon fill="black" stroke="black" points="15608.7,-286.69 15613,-277.01 15603.6,-281.9 15608.7,-286.69"/>
</g>
<!-- ln2_3 -->
<g id="node332" class="node">
<title>ln2_3</title>
<polygon fill="white" stroke="black" points="19680.5,-605 19527.5,-605 19527.5,-552 19680.5,-552 19680.5,-605"/>
<text text-anchor="middle" x="19604" y="-589.8" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="19604" y="-574.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="19604" y="-559.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge414" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M19597.78,-641.57C19597.27,-633.34 19597.13,-624.08 19597.36,-615.28"/>
<polygon fill="black" stroke="black" points="19600.85,-615.39 19597.8,-605.24 19593.86,-615.08 19600.85,-615.39"/>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge434" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M19610.22,-641.57C19610.73,-633.34 19610.87,-624.08 19610.64,-615.28"/>
<polygon fill="black" stroke="black" points="19614.14,-615.08 19610.2,-605.24 19607.15,-615.39 19614.14,-615.08"/>
</g>
<!-- ln2_3&#45;&gt;gate_3 -->
<g id="edge415" class="edge">
<title>ln2_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M19680.53,-555.63C19732.03,-540.92 19799.17,-521.74 19847.86,-507.82"/>
<polygon fill="black" stroke="black" points="19849,-511.14 19857.66,-505.03 19847.08,-504.41 19849,-511.14"/>
</g>
<!-- output -->
<g id="node334" class="node">
<title>output</title>
<polygon fill="white" stroke="black" points="20701.5,-69 20548.5,-69 20548.5,-16 20701.5,-16 20701.5,-69"/>
<text text-anchor="middle" x="20625" y="-53.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="20625" y="-38.8" font-family="Times,serif" font-size="14.00">[1024, 1024, 8192]</text>
<text text-anchor="middle" x="20625" y="-23.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_3&#45;&gt;output -->
<g id="edge437" class="edge">
<title>residual2_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M20280.74,-130.15C20347.58,-116.34 20447.23,-94.7 20538.63,-70.41"/>
<polygon fill="black" stroke="black" points="20539.55,-73.79 20548.3,-67.82 20537.74,-67.03 20539.55,-73.79"/>
</g>
</g>
</svg>
