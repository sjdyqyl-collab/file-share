<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: moe_transformer_16gpus Pages: 1 -->
<svg width="1800pt" height="192pt"
 viewBox="0.00 0.00 1800.00 191.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 1481)">
<title>moe_transformer_16gpus</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1481 13934,-1481 13934,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="lightblue" stroke="black" d="M10587,-1477C10587,-1477 10439,-1477 10439,-1477 10433,-1477 10427,-1471 10427,-1465 10427,-1465 10427,-1436 10427,-1436 10427,-1430 10433,-1424 10439,-1424 10439,-1424 10587,-1424 10587,-1424 10593,-1424 10599,-1430 10599,-1436 10599,-1436 10599,-1465 10599,-1465 10599,-1471 10593,-1477 10587,-1477"/>
<text text-anchor="middle" x="10513" y="-1461.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="10513" y="-1446.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="10513" y="-1431.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<path fill="lightgreen" stroke="black" d="M7170,-1387C7170,-1387 7022,-1387 7022,-1387 7016,-1387 7010,-1381 7010,-1375 7010,-1375 7010,-1346 7010,-1346 7010,-1340 7016,-1334 7022,-1334 7022,-1334 7170,-1334 7170,-1334 7176,-1334 7182,-1340 7182,-1346 7182,-1346 7182,-1375 7182,-1375 7182,-1381 7176,-1387 7170,-1387"/>
<text text-anchor="middle" x="7096" y="-1371.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7096" y="-1356.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="7096" y="-1341.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M10426.83,-1447.28C9955.11,-1435.13 7688.97,-1376.77 7192.33,-1363.98"/>
<polygon fill="black" stroke="black" points="7192.42,-1360.48 7182.33,-1363.72 7192.24,-1367.48 7192.42,-1360.48"/>
</g>
<!-- residual1 -->
<g id="node88" class="node">
<title>residual1</title>
<path fill="lightgray" stroke="black" d="M11602,-817C11602,-817 11454,-817 11454,-817 11448,-817 11442,-811 11442,-805 11442,-805 11442,-776 11442,-776 11442,-770 11448,-764 11454,-764 11454,-764 11602,-764 11602,-764 11608,-764 11614,-770 11614,-776 11614,-776 11614,-805 11614,-805 11614,-811 11608,-817 11602,-817"/>
<text text-anchor="middle" x="11528" y="-801.8" font-family="Times,serif" font-size="14.00">Add &amp; Residual</text>
<text text-anchor="middle" x="11528" y="-786.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="11528" y="-771.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;residual1 -->
<g id="edge143" class="edge">
<title>input&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M10599.17,-1449.59C11129.7,-1449.9 13930,-1447.45 13930,-1361.5 13930,-1361.5 13930,-1361.5 13930,-879.5 13930,-820.79 12072.82,-797.29 11624.52,-792.47"/>
<polygon fill="black" stroke="black" points="11624.23,-788.97 11614.2,-792.36 11624.16,-795.97 11624.23,-788.97"/>
</g>
<!-- q_proj_0_0 -->
<g id="node3" class="node">
<title>q_proj_0_0</title>
<path fill="lightyellow" stroke="black" d="M260,-1297C260,-1297 12,-1297 12,-1297 6,-1297 0,-1291 0,-1285 0,-1285 0,-1241 0,-1241 0,-1235 6,-1229 12,-1229 12,-1229 260,-1229 260,-1229 266,-1229 272,-1235 272,-1241 272,-1241 272,-1285 272,-1285 272,-1291 266,-1297 260,-1297"/>
<text text-anchor="middle" x="136" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="136" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="136" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="136" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_0 -->
<g id="edge10" class="edge">
<title>ln1&#45;&gt;q_proj_0_0</title>
<path fill="none" stroke="black" d="M7009.81,-1359.35C6473.02,-1358.35 3533.12,-1351.38 1136,-1316 759.29,-1310.44 659.96,-1343.05 282.2,-1297.05"/>
<polygon fill="black" stroke="black" points="282.44,-1293.55 272.09,-1295.81 281.58,-1300.5 282.44,-1293.55"/>
</g>
<!-- k_proj_0_0 -->
<g id="node4" class="node">
<title>k_proj_0_0</title>
<path fill="lightyellow" stroke="black" d="M550,-1297C550,-1297 302,-1297 302,-1297 296,-1297 290,-1291 290,-1285 290,-1285 290,-1241 290,-1241 290,-1235 296,-1229 302,-1229 302,-1229 550,-1229 550,-1229 556,-1229 562,-1235 562,-1241 562,-1241 562,-1285 562,-1285 562,-1291 556,-1297 550,-1297"/>
<text text-anchor="middle" x="426" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="426" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="426" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="426" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_0 -->
<g id="edge11" class="edge">
<title>ln1&#45;&gt;k_proj_0_0</title>
<path fill="none" stroke="black" d="M7009.9,-1359.2C6269.94,-1356.58 999.73,-1336.61 572.3,-1296.92"/>
<polygon fill="black" stroke="black" points="572.39,-1293.41 562.08,-1295.86 571.66,-1300.37 572.39,-1293.41"/>
</g>
<!-- v_proj_0_0 -->
<g id="node5" class="node">
<title>v_proj_0_0</title>
<path fill="lightyellow" stroke="black" d="M840,-1297C840,-1297 592,-1297 592,-1297 586,-1297 580,-1291 580,-1285 580,-1285 580,-1241 580,-1241 580,-1235 586,-1229 592,-1229 592,-1229 840,-1229 840,-1229 846,-1229 852,-1235 852,-1241 852,-1241 852,-1285 852,-1285 852,-1291 846,-1297 840,-1297"/>
<text text-anchor="middle" x="716" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="716" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="716" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="716" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_0 -->
<g id="edge12" class="edge">
<title>ln1&#45;&gt;v_proj_0_0</title>
<path fill="none" stroke="black" d="M7009.67,-1358.44C6583.69,-1353.25 4663.13,-1330.09 3090,-1315 2968.65,-1313.84 1062.63,-1311.42 862.2,-1296.78"/>
<polygon fill="black" stroke="black" points="862.35,-1293.28 852.08,-1295.87 861.72,-1300.25 862.35,-1293.28"/>
</g>
<!-- q_proj_0_1 -->
<g id="node8" class="node">
<title>q_proj_0_1</title>
<path fill="lightyellow" stroke="black" d="M1130,-1297C1130,-1297 882,-1297 882,-1297 876,-1297 870,-1291 870,-1285 870,-1285 870,-1241 870,-1241 870,-1235 876,-1229 882,-1229 882,-1229 1130,-1229 1130,-1229 1136,-1229 1142,-1235 1142,-1241 1142,-1241 1142,-1285 1142,-1285 1142,-1291 1136,-1297 1130,-1297"/>
<text text-anchor="middle" x="1006" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1006" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1006" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1006" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_1 -->
<g id="edge18" class="edge">
<title>ln1&#45;&gt;q_proj_0_1</title>
<path fill="none" stroke="black" d="M7009.93,-1357.65C6683.38,-1350.72 5489.7,-1326.09 4506,-1315 4322.35,-1312.93 1422.98,-1318.15 1152.38,-1296.85"/>
<polygon fill="black" stroke="black" points="1152.36,-1293.33 1142.08,-1295.88 1151.71,-1300.3 1152.36,-1293.33"/>
</g>
<!-- k_proj_0_1 -->
<g id="node9" class="node">
<title>k_proj_0_1</title>
<path fill="lightyellow" stroke="black" d="M1420,-1297C1420,-1297 1172,-1297 1172,-1297 1166,-1297 1160,-1291 1160,-1285 1160,-1285 1160,-1241 1160,-1241 1160,-1235 1166,-1229 1172,-1229 1172,-1229 1420,-1229 1420,-1229 1426,-1229 1432,-1235 1432,-1241 1432,-1241 1432,-1285 1432,-1285 1432,-1291 1426,-1297 1420,-1297"/>
<text text-anchor="middle" x="1296" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1296" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1296" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1296" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_1 -->
<g id="edge19" class="edge">
<title>ln1&#45;&gt;k_proj_0_1</title>
<path fill="none" stroke="black" d="M7009.85,-1356.86C6744.27,-1348.87 5914.61,-1324.82 5227,-1315 5019.46,-1312.04 1738.19,-1320.75 1442.32,-1296.85"/>
<polygon fill="black" stroke="black" points="1442.36,-1293.34 1432.08,-1295.88 1441.7,-1300.31 1442.36,-1293.34"/>
</g>
<!-- v_proj_0_1 -->
<g id="node10" class="node">
<title>v_proj_0_1</title>
<path fill="lightyellow" stroke="black" d="M1710,-1297C1710,-1297 1462,-1297 1462,-1297 1456,-1297 1450,-1291 1450,-1285 1450,-1285 1450,-1241 1450,-1241 1450,-1235 1456,-1229 1462,-1229 1462,-1229 1710,-1229 1710,-1229 1716,-1229 1722,-1235 1722,-1241 1722,-1241 1722,-1285 1722,-1285 1722,-1291 1716,-1297 1710,-1297"/>
<text text-anchor="middle" x="1586" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1586" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1586" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1586" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_1 -->
<g id="edge20" class="edge">
<title>ln1&#45;&gt;v_proj_0_1</title>
<path fill="none" stroke="black" d="M7009.59,-1356.17C6780.09,-1347.49 6136.16,-1324.22 5600,-1315 5387.81,-1311.35 2031.38,-1321.24 1732.09,-1296.84"/>
<polygon fill="black" stroke="black" points="1732.36,-1293.35 1722.08,-1295.88 1731.7,-1300.32 1732.36,-1293.35"/>
</g>
<!-- q_proj_0_2 -->
<g id="node13" class="node">
<title>q_proj_0_2</title>
<path fill="lightyellow" stroke="black" d="M2000,-1297C2000,-1297 1752,-1297 1752,-1297 1746,-1297 1740,-1291 1740,-1285 1740,-1285 1740,-1241 1740,-1241 1740,-1235 1746,-1229 1752,-1229 1752,-1229 2000,-1229 2000,-1229 2006,-1229 2012,-1235 2012,-1241 2012,-1241 2012,-1285 2012,-1285 2012,-1291 2006,-1297 2000,-1297"/>
<text text-anchor="middle" x="1876" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1876" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1876" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1876" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_2 -->
<g id="edge26" class="edge">
<title>ln1&#45;&gt;q_proj_0_2</title>
<path fill="none" stroke="black" d="M7009.89,-1355.67C6801.87,-1346.6 6255.44,-1323.92 5799,-1315 5591.92,-1310.96 2317.56,-1320.67 2022.3,-1296.85"/>
<polygon fill="black" stroke="black" points="2022.36,-1293.34 2012.08,-1295.88 2021.7,-1300.31 2022.36,-1293.34"/>
</g>
<!-- k_proj_0_2 -->
<g id="node14" class="node">
<title>k_proj_0_2</title>
<path fill="lightyellow" stroke="black" d="M2290,-1297C2290,-1297 2042,-1297 2042,-1297 2036,-1297 2030,-1291 2030,-1285 2030,-1285 2030,-1241 2030,-1241 2030,-1235 2036,-1229 2042,-1229 2042,-1229 2290,-1229 2290,-1229 2296,-1229 2302,-1235 2302,-1241 2302,-1241 2302,-1285 2302,-1285 2302,-1291 2296,-1297 2290,-1297"/>
<text text-anchor="middle" x="2166" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2166" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2166" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2166" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_2 -->
<g id="edge27" class="edge">
<title>ln1&#45;&gt;k_proj_0_2</title>
<path fill="none" stroke="black" d="M7009.79,-1355.3C6814.37,-1345.99 6322.66,-1323.76 5911,-1315 5713.78,-1310.8 2596.67,-1319.58 2312.26,-1296.84"/>
<polygon fill="black" stroke="black" points="2312.36,-1293.34 2302.08,-1295.88 2311.7,-1300.31 2312.36,-1293.34"/>
</g>
<!-- v_proj_0_2 -->
<g id="node15" class="node">
<title>v_proj_0_2</title>
<path fill="lightyellow" stroke="black" d="M2580,-1297C2580,-1297 2332,-1297 2332,-1297 2326,-1297 2320,-1291 2320,-1285 2320,-1285 2320,-1241 2320,-1241 2320,-1235 2326,-1229 2332,-1229 2332,-1229 2580,-1229 2580,-1229 2586,-1229 2592,-1235 2592,-1241 2592,-1241 2592,-1285 2592,-1285 2592,-1291 2586,-1297 2580,-1297"/>
<text text-anchor="middle" x="2456" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2456" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2456" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2456" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_2 -->
<g id="edge28" class="edge">
<title>ln1&#45;&gt;v_proj_0_2</title>
<path fill="none" stroke="black" d="M7009.84,-1355.05C6822.43,-1345.61 6363.66,-1323.68 5979,-1315 5794.04,-1310.82 2871.95,-1318.24 2602.05,-1296.82"/>
<polygon fill="black" stroke="black" points="2602.36,-1293.33 2592.08,-1295.88 2601.7,-1300.3 2602.36,-1293.33"/>
</g>
<!-- q_proj_0_3 -->
<g id="node18" class="node">
<title>q_proj_0_3</title>
<path fill="lightyellow" stroke="black" d="M2870,-1297C2870,-1297 2622,-1297 2622,-1297 2616,-1297 2610,-1291 2610,-1285 2610,-1285 2610,-1241 2610,-1241 2610,-1235 2616,-1229 2622,-1229 2622,-1229 2870,-1229 2870,-1229 2876,-1229 2882,-1235 2882,-1241 2882,-1241 2882,-1285 2882,-1285 2882,-1291 2876,-1297 2870,-1297"/>
<text text-anchor="middle" x="2746" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2746" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2746" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2746" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_3 -->
<g id="edge34" class="edge">
<title>ln1&#45;&gt;q_proj_0_3</title>
<path fill="none" stroke="black" d="M7009.59,-1355.73C6772.5,-1345.4 6122.94,-1317.29 6026,-1315 5854.51,-1310.94 3147.82,-1316.76 2892.11,-1296.81"/>
<polygon fill="black" stroke="black" points="2892.36,-1293.32 2882.08,-1295.88 2891.71,-1300.29 2892.36,-1293.32"/>
</g>
<!-- k_proj_0_3 -->
<g id="node19" class="node">
<title>k_proj_0_3</title>
<path fill="lightyellow" stroke="black" d="M3160,-1297C3160,-1297 2912,-1297 2912,-1297 2906,-1297 2900,-1291 2900,-1285 2900,-1285 2900,-1241 2900,-1241 2900,-1235 2906,-1229 2912,-1229 2912,-1229 3160,-1229 3160,-1229 3166,-1229 3172,-1235 3172,-1241 3172,-1241 3172,-1285 3172,-1285 3172,-1291 3166,-1297 3160,-1297"/>
<text text-anchor="middle" x="3036" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3036" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="3036" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3036" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_3 -->
<g id="edge35" class="edge">
<title>ln1&#45;&gt;k_proj_0_3</title>
<path fill="none" stroke="black" d="M7009.85,-1355.71C6769.99,-1345.15 6108.98,-1316.16 6062,-1315 5904.57,-1311.12 3421.94,-1315.23 3182.04,-1296.8"/>
<polygon fill="black" stroke="black" points="3182.36,-1293.31 3172.08,-1295.87 3181.71,-1300.28 3182.36,-1293.31"/>
</g>
<!-- v_proj_0_3 -->
<g id="node20" class="node">
<title>v_proj_0_3</title>
<path fill="lightyellow" stroke="black" d="M3450,-1297C3450,-1297 3202,-1297 3202,-1297 3196,-1297 3190,-1291 3190,-1285 3190,-1285 3190,-1241 3190,-1241 3190,-1235 3196,-1229 3202,-1229 3202,-1229 3450,-1229 3450,-1229 3456,-1229 3462,-1235 3462,-1241 3462,-1241 3462,-1285 3462,-1285 3462,-1291 3456,-1297 3450,-1297"/>
<text text-anchor="middle" x="3326" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3326" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="3326" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3326" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_3 -->
<g id="edge36" class="edge">
<title>ln1&#45;&gt;v_proj_0_3</title>
<path fill="none" stroke="black" d="M7009.83,-1355.59C6774.86,-1344.95 6137.46,-1316.16 6092,-1315 5948.99,-1311.34 3696.91,-1313.67 3472.17,-1296.8"/>
<polygon fill="black" stroke="black" points="3472.36,-1293.3 3462.08,-1295.87 3471.72,-1300.27 3472.36,-1293.3"/>
</g>
<!-- q_proj_1_0 -->
<g id="node23" class="node">
<title>q_proj_1_0</title>
<path fill="lightyellow" stroke="black" d="M3740,-1297C3740,-1297 3492,-1297 3492,-1297 3486,-1297 3480,-1291 3480,-1285 3480,-1285 3480,-1241 3480,-1241 3480,-1235 3486,-1229 3492,-1229 3492,-1229 3740,-1229 3740,-1229 3746,-1229 3752,-1235 3752,-1241 3752,-1241 3752,-1285 3752,-1285 3752,-1291 3746,-1297 3740,-1297"/>
<text text-anchor="middle" x="3616" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3616" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="3616" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="3616" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_0 -->
<g id="edge42" class="edge">
<title>ln1&#45;&gt;q_proj_1_0</title>
<path fill="none" stroke="black" d="M7009.99,-1355.5C6779.46,-1344.78 6162.15,-1316.17 6118,-1315 5859.26,-1308.13 4063.94,-1326.79 3762.18,-1296.95"/>
<polygon fill="black" stroke="black" points="3762.39,-1293.45 3752.08,-1295.87 3761.65,-1300.41 3762.39,-1293.45"/>
</g>
<!-- k_proj_1_0 -->
<g id="node24" class="node">
<title>k_proj_1_0</title>
<path fill="lightyellow" stroke="black" d="M4030,-1297C4030,-1297 3782,-1297 3782,-1297 3776,-1297 3770,-1291 3770,-1285 3770,-1285 3770,-1241 3770,-1241 3770,-1235 3776,-1229 3782,-1229 3782,-1229 4030,-1229 4030,-1229 4036,-1229 4042,-1235 4042,-1241 4042,-1241 4042,-1285 4042,-1285 4042,-1291 4036,-1297 4030,-1297"/>
<text text-anchor="middle" x="3906" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3906" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="3906" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="3906" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_0 -->
<g id="edge43" class="edge">
<title>ln1&#45;&gt;k_proj_1_0</title>
<path fill="none" stroke="black" d="M7009.83,-1355.38C6783.54,-1344.58 6186.82,-1316.18 6144,-1315 5914.59,-1308.65 4324.72,-1323.56 4052.29,-1296.95"/>
<polygon fill="black" stroke="black" points="4052.39,-1293.44 4042.08,-1295.86 4051.65,-1300.41 4052.39,-1293.44"/>
</g>
<!-- v_proj_1_0 -->
<g id="node25" class="node">
<title>v_proj_1_0</title>
<path fill="lightyellow" stroke="black" d="M4320,-1297C4320,-1297 4072,-1297 4072,-1297 4066,-1297 4060,-1291 4060,-1285 4060,-1285 4060,-1241 4060,-1241 4060,-1235 4066,-1229 4072,-1229 4072,-1229 4320,-1229 4320,-1229 4326,-1229 4332,-1235 4332,-1241 4332,-1241 4332,-1285 4332,-1285 4332,-1291 4326,-1297 4320,-1297"/>
<text text-anchor="middle" x="4196" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4196" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4196" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4196" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_0 -->
<g id="edge44" class="edge">
<title>ln1&#45;&gt;v_proj_1_0</title>
<path fill="none" stroke="black" d="M7009.72,-1355.17C6795.66,-1344.45 6251.49,-1317.39 6169,-1315 5968.94,-1309.22 4584.17,-1320.34 4342.11,-1296.93"/>
<polygon fill="black" stroke="black" points="4342.39,-1293.44 4332.08,-1295.86 4341.65,-1300.4 4342.39,-1293.44"/>
</g>
<!-- q_proj_1_1 -->
<g id="node28" class="node">
<title>q_proj_1_1</title>
<path fill="lightyellow" stroke="black" d="M4610,-1297C4610,-1297 4362,-1297 4362,-1297 4356,-1297 4350,-1291 4350,-1285 4350,-1285 4350,-1241 4350,-1241 4350,-1235 4356,-1229 4362,-1229 4362,-1229 4610,-1229 4610,-1229 4616,-1229 4622,-1235 4622,-1241 4622,-1241 4622,-1285 4622,-1285 4622,-1291 4616,-1297 4610,-1297"/>
<text text-anchor="middle" x="4486" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4486" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4486" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4486" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_1 -->
<g id="edge50" class="edge">
<title>ln1&#45;&gt;q_proj_1_1</title>
<path fill="none" stroke="black" d="M7009.75,-1355.06C6799.89,-1344.28 6273.97,-1317.43 6194,-1315 6023.37,-1309.81 4844.77,-1317.13 4632.28,-1296.93"/>
<polygon fill="black" stroke="black" points="4632.39,-1293.42 4622.08,-1295.85 4631.66,-1300.39 4632.39,-1293.42"/>
</g>
<!-- k_proj_1_1 -->
<g id="node29" class="node">
<title>k_proj_1_1</title>
<path fill="lightyellow" stroke="black" d="M4900,-1297C4900,-1297 4652,-1297 4652,-1297 4646,-1297 4640,-1291 4640,-1285 4640,-1285 4640,-1241 4640,-1241 4640,-1235 4646,-1229 4652,-1229 4652,-1229 4900,-1229 4900,-1229 4906,-1229 4912,-1235 4912,-1241 4912,-1241 4912,-1285 4912,-1285 4912,-1291 4906,-1297 4900,-1297"/>
<text text-anchor="middle" x="4776" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4776" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4776" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4776" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_1 -->
<g id="edge51" class="edge">
<title>ln1&#45;&gt;k_proj_1_1</title>
<path fill="none" stroke="black" d="M7009.88,-1354.95C6804.35,-1344.11 6296.47,-1317.5 6219,-1315 6077.73,-1310.44 5104.34,-1313.95 4922.24,-1296.91"/>
<polygon fill="black" stroke="black" points="4922.39,-1293.41 4912.08,-1295.84 4921.66,-1300.37 4922.39,-1293.41"/>
</g>
<!-- v_proj_1_1 -->
<g id="node30" class="node">
<title>v_proj_1_1</title>
<path fill="lightyellow" stroke="black" d="M5190,-1297C5190,-1297 4942,-1297 4942,-1297 4936,-1297 4930,-1291 4930,-1285 4930,-1285 4930,-1241 4930,-1241 4930,-1235 4936,-1229 4942,-1229 4942,-1229 5190,-1229 5190,-1229 5196,-1229 5202,-1235 5202,-1241 5202,-1241 5202,-1285 5202,-1285 5202,-1291 5196,-1297 5190,-1297"/>
<text text-anchor="middle" x="5066" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5066" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5066" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5066" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_1 -->
<g id="edge52" class="edge">
<title>ln1&#45;&gt;v_proj_1_1</title>
<path fill="none" stroke="black" d="M7009.88,-1354.01C6856.15,-1344.43 6524.33,-1324.76 6244,-1315 6017.8,-1307.12 5455.16,-1324.13 5212.35,-1297.02"/>
<polygon fill="black" stroke="black" points="5212.42,-1293.51 5202.08,-1295.83 5211.61,-1300.46 5212.42,-1293.51"/>
</g>
<!-- q_proj_1_2 -->
<g id="node33" class="node">
<title>q_proj_1_2</title>
<path fill="lightyellow" stroke="black" d="M5480,-1297C5480,-1297 5232,-1297 5232,-1297 5226,-1297 5220,-1291 5220,-1285 5220,-1285 5220,-1241 5220,-1241 5220,-1235 5226,-1229 5232,-1229 5232,-1229 5480,-1229 5480,-1229 5486,-1229 5492,-1235 5492,-1241 5492,-1241 5492,-1285 5492,-1285 5492,-1291 5486,-1297 5480,-1297"/>
<text text-anchor="middle" x="5356" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5356" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5356" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5356" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_2 -->
<g id="edge58" class="edge">
<title>ln1&#45;&gt;q_proj_1_2</title>
<path fill="none" stroke="black" d="M7009.72,-1353.99C6859.35,-1344.59 6539.47,-1325.44 6269,-1315 6101.58,-1308.54 5686.21,-1317.7 5502.27,-1297.01"/>
<polygon fill="black" stroke="black" points="5502.43,-1293.5 5492.09,-1295.8 5501.6,-1300.46 5502.43,-1293.5"/>
</g>
<!-- k_proj_1_2 -->
<g id="node34" class="node">
<title>k_proj_1_2</title>
<path fill="lightyellow" stroke="black" d="M5770,-1297C5770,-1297 5522,-1297 5522,-1297 5516,-1297 5510,-1291 5510,-1285 5510,-1285 5510,-1241 5510,-1241 5510,-1235 5516,-1229 5522,-1229 5522,-1229 5770,-1229 5770,-1229 5776,-1229 5782,-1235 5782,-1241 5782,-1241 5782,-1285 5782,-1285 5782,-1291 5776,-1297 5770,-1297"/>
<text text-anchor="middle" x="5646" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5646" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5646" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5646" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_2 -->
<g id="edge59" class="edge">
<title>ln1&#45;&gt;k_proj_1_2</title>
<path fill="none" stroke="black" d="M7009.98,-1354.17C6863.18,-1345.2 6554.85,-1326.9 6294,-1315 6073.81,-1304.95 6014.54,-1325.34 5792.12,-1297.05"/>
<polygon fill="black" stroke="black" points="5792.46,-1293.56 5782.09,-1295.75 5791.56,-1300.51 5792.46,-1293.56"/>
</g>
<!-- v_proj_1_2 -->
<g id="node35" class="node">
<title>v_proj_1_2</title>
<path fill="lightyellow" stroke="black" d="M6060,-1297C6060,-1297 5812,-1297 5812,-1297 5806,-1297 5800,-1291 5800,-1285 5800,-1285 5800,-1241 5800,-1241 5800,-1235 5806,-1229 5812,-1229 5812,-1229 6060,-1229 6060,-1229 6066,-1229 6072,-1235 6072,-1241 6072,-1241 6072,-1285 6072,-1285 6072,-1291 6066,-1297 6060,-1297"/>
<text text-anchor="middle" x="5936" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5936" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5936" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5936" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_2 -->
<g id="edge60" class="edge">
<title>ln1&#45;&gt;v_proj_1_2</title>
<path fill="none" stroke="black" d="M7009.69,-1354.57C6782.91,-1341.56 6181.37,-1306.72 6082.33,-1296.83"/>
<polygon fill="black" stroke="black" points="6082.44,-1293.32 6072.11,-1295.65 6081.64,-1300.27 6082.44,-1293.32"/>
</g>
<!-- q_proj_1_3 -->
<g id="node38" class="node">
<title>q_proj_1_3</title>
<path fill="lightyellow" stroke="black" d="M6350,-1297C6350,-1297 6102,-1297 6102,-1297 6096,-1297 6090,-1291 6090,-1285 6090,-1285 6090,-1241 6090,-1241 6090,-1235 6096,-1229 6102,-1229 6102,-1229 6350,-1229 6350,-1229 6356,-1229 6362,-1235 6362,-1241 6362,-1241 6362,-1285 6362,-1285 6362,-1291 6356,-1297 6350,-1297"/>
<text text-anchor="middle" x="6226" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6226" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="6226" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6226" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_3 -->
<g id="edge66" class="edge">
<title>ln1&#45;&gt;q_proj_1_3</title>
<path fill="none" stroke="black" d="M7009.88,-1355.92C6875.54,-1349.48 6607.92,-1333.26 6372.26,-1297.12"/>
<polygon fill="black" stroke="black" points="6372.54,-1293.62 6362.12,-1295.55 6371.47,-1300.54 6372.54,-1293.62"/>
</g>
<!-- k_proj_1_3 -->
<g id="node39" class="node">
<title>k_proj_1_3</title>
<path fill="lightyellow" stroke="black" d="M6640,-1297C6640,-1297 6392,-1297 6392,-1297 6386,-1297 6380,-1291 6380,-1285 6380,-1285 6380,-1241 6380,-1241 6380,-1235 6386,-1229 6392,-1229 6392,-1229 6640,-1229 6640,-1229 6646,-1229 6652,-1235 6652,-1241 6652,-1241 6652,-1285 6652,-1285 6652,-1291 6646,-1297 6640,-1297"/>
<text text-anchor="middle" x="6516" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6516" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="6516" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6516" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_3 -->
<g id="edge67" class="edge">
<title>ln1&#45;&gt;k_proj_1_3</title>
<path fill="none" stroke="black" d="M7009.83,-1349.21C6924.05,-1338.49 6788.5,-1320.27 6662.03,-1297.14"/>
<polygon fill="black" stroke="black" points="6662.63,-1293.7 6652.16,-1295.33 6661.36,-1300.58 6662.63,-1293.7"/>
</g>
<!-- v_proj_1_3 -->
<g id="node40" class="node">
<title>v_proj_1_3</title>
<path fill="lightyellow" stroke="black" d="M6930,-1297C6930,-1297 6682,-1297 6682,-1297 6676,-1297 6670,-1291 6670,-1285 6670,-1285 6670,-1241 6670,-1241 6670,-1235 6676,-1229 6682,-1229 6682,-1229 6930,-1229 6930,-1229 6936,-1229 6942,-1235 6942,-1241 6942,-1241 6942,-1285 6942,-1285 6942,-1291 6936,-1297 6930,-1297"/>
<text text-anchor="middle" x="6806" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6806" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="6806" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6806" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_3 -->
<g id="edge68" class="edge">
<title>ln1&#45;&gt;v_proj_1_3</title>
<path fill="none" stroke="black" d="M7018.29,-1333.91C6986.85,-1323.55 6949.99,-1311.42 6915.88,-1300.19"/>
<polygon fill="black" stroke="black" points="6916.94,-1296.85 6906.34,-1297.04 6914.75,-1303.5 6916.94,-1296.85"/>
</g>
<!-- q_proj_2_0 -->
<g id="node43" class="node">
<title>q_proj_2_0</title>
<path fill="lightyellow" stroke="black" d="M7220,-1297C7220,-1297 6972,-1297 6972,-1297 6966,-1297 6960,-1291 6960,-1285 6960,-1285 6960,-1241 6960,-1241 6960,-1235 6966,-1229 6972,-1229 6972,-1229 7220,-1229 7220,-1229 7226,-1229 7232,-1235 7232,-1241 7232,-1241 7232,-1285 7232,-1285 7232,-1291 7226,-1297 7220,-1297"/>
<text text-anchor="middle" x="7096" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7096" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="7096" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7096" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_0 -->
<g id="edge74" class="edge">
<title>ln1&#45;&gt;q_proj_2_0</title>
<path fill="none" stroke="black" d="M7096,-1333.91C7096,-1325.72 7096,-1316.41 7096,-1307.32"/>
<polygon fill="black" stroke="black" points="7099.5,-1307.22 7096,-1297.22 7092.5,-1307.22 7099.5,-1307.22"/>
</g>
<!-- k_proj_2_0 -->
<g id="node44" class="node">
<title>k_proj_2_0</title>
<path fill="lightyellow" stroke="black" d="M7510,-1297C7510,-1297 7262,-1297 7262,-1297 7256,-1297 7250,-1291 7250,-1285 7250,-1285 7250,-1241 7250,-1241 7250,-1235 7256,-1229 7262,-1229 7262,-1229 7510,-1229 7510,-1229 7516,-1229 7522,-1235 7522,-1241 7522,-1241 7522,-1285 7522,-1285 7522,-1291 7516,-1297 7510,-1297"/>
<text text-anchor="middle" x="7386" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7386" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="7386" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7386" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_0 -->
<g id="edge75" class="edge">
<title>ln1&#45;&gt;k_proj_2_0</title>
<path fill="none" stroke="black" d="M7173.71,-1333.91C7205.15,-1323.55 7242.01,-1311.42 7276.12,-1300.19"/>
<polygon fill="black" stroke="black" points="7277.25,-1303.5 7285.66,-1297.04 7275.06,-1296.85 7277.25,-1303.5"/>
</g>
<!-- v_proj_2_0 -->
<g id="node45" class="node">
<title>v_proj_2_0</title>
<path fill="lightyellow" stroke="black" d="M7800,-1297C7800,-1297 7552,-1297 7552,-1297 7546,-1297 7540,-1291 7540,-1285 7540,-1285 7540,-1241 7540,-1241 7540,-1235 7546,-1229 7552,-1229 7552,-1229 7800,-1229 7800,-1229 7806,-1229 7812,-1235 7812,-1241 7812,-1241 7812,-1285 7812,-1285 7812,-1291 7806,-1297 7800,-1297"/>
<text text-anchor="middle" x="7676" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7676" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="7676" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7676" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_0 -->
<g id="edge76" class="edge">
<title>ln1&#45;&gt;v_proj_2_0</title>
<path fill="none" stroke="black" d="M7182.17,-1349.21C7267.95,-1338.49 7403.5,-1320.27 7529.97,-1297.14"/>
<polygon fill="black" stroke="black" points="7530.64,-1300.58 7539.84,-1295.33 7529.37,-1293.7 7530.64,-1300.58"/>
</g>
<!-- q_proj_2_1 -->
<g id="node48" class="node">
<title>q_proj_2_1</title>
<path fill="lightyellow" stroke="black" d="M8090,-1297C8090,-1297 7842,-1297 7842,-1297 7836,-1297 7830,-1291 7830,-1285 7830,-1285 7830,-1241 7830,-1241 7830,-1235 7836,-1229 7842,-1229 7842,-1229 8090,-1229 8090,-1229 8096,-1229 8102,-1235 8102,-1241 8102,-1241 8102,-1285 8102,-1285 8102,-1291 8096,-1297 8090,-1297"/>
<text text-anchor="middle" x="7966" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7966" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="7966" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="7966" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_1 -->
<g id="edge82" class="edge">
<title>ln1&#45;&gt;q_proj_2_1</title>
<path fill="none" stroke="black" d="M7182.12,-1355.92C7316.46,-1349.48 7584.08,-1333.26 7819.74,-1297.12"/>
<polygon fill="black" stroke="black" points="7820.53,-1300.54 7829.88,-1295.55 7819.46,-1293.62 7820.53,-1300.54"/>
</g>
<!-- k_proj_2_1 -->
<g id="node49" class="node">
<title>k_proj_2_1</title>
<path fill="lightyellow" stroke="black" d="M8380,-1297C8380,-1297 8132,-1297 8132,-1297 8126,-1297 8120,-1291 8120,-1285 8120,-1285 8120,-1241 8120,-1241 8120,-1235 8126,-1229 8132,-1229 8132,-1229 8380,-1229 8380,-1229 8386,-1229 8392,-1235 8392,-1241 8392,-1241 8392,-1285 8392,-1285 8392,-1291 8386,-1297 8380,-1297"/>
<text text-anchor="middle" x="8256" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8256" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8256" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="8256" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_1 -->
<g id="edge83" class="edge">
<title>ln1&#45;&gt;k_proj_2_1</title>
<path fill="none" stroke="black" d="M7182.03,-1358.9C7355.9,-1356.66 7761.53,-1346.27 8109.86,-1297.08"/>
<polygon fill="black" stroke="black" points="8110.49,-1300.53 8119.89,-1295.65 8109.5,-1293.6 8110.49,-1300.53"/>
</g>
<!-- v_proj_2_1 -->
<g id="node50" class="node">
<title>v_proj_2_1</title>
<path fill="lightyellow" stroke="black" d="M8670,-1297C8670,-1297 8422,-1297 8422,-1297 8416,-1297 8410,-1291 8410,-1285 8410,-1285 8410,-1241 8410,-1241 8410,-1235 8416,-1229 8422,-1229 8422,-1229 8670,-1229 8670,-1229 8676,-1229 8682,-1235 8682,-1241 8682,-1241 8682,-1285 8682,-1285 8682,-1291 8676,-1297 8670,-1297"/>
<text text-anchor="middle" x="8546" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8546" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8546" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="8546" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_1 -->
<g id="edge84" class="edge">
<title>ln1&#45;&gt;v_proj_2_1</title>
<path fill="none" stroke="black" d="M7182.15,-1357.35C7430.4,-1350.86 8145.15,-1329.91 8399.94,-1297.03"/>
<polygon fill="black" stroke="black" points="8400.45,-1300.49 8409.9,-1295.71 8399.53,-1293.55 8400.45,-1300.49"/>
</g>
<!-- q_proj_2_2 -->
<g id="node53" class="node">
<title>q_proj_2_2</title>
<path fill="lightyellow" stroke="black" d="M8960,-1297C8960,-1297 8712,-1297 8712,-1297 8706,-1297 8700,-1291 8700,-1285 8700,-1285 8700,-1241 8700,-1241 8700,-1235 8706,-1229 8712,-1229 8712,-1229 8960,-1229 8960,-1229 8966,-1229 8972,-1235 8972,-1241 8972,-1241 8972,-1285 8972,-1285 8972,-1291 8966,-1297 8960,-1297"/>
<text text-anchor="middle" x="8836" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8836" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8836" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="8836" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_2 -->
<g id="edge90" class="edge">
<title>ln1&#45;&gt;q_proj_2_2</title>
<path fill="none" stroke="black" d="M7182.15,-1358.23C7466.69,-1353.7 8375.6,-1336.54 8689.88,-1297.03"/>
<polygon fill="black" stroke="black" points="8690.44,-1300.49 8699.91,-1295.74 8689.54,-1293.55 8690.44,-1300.49"/>
</g>
<!-- k_proj_2_2 -->
<g id="node54" class="node">
<title>k_proj_2_2</title>
<path fill="lightyellow" stroke="black" d="M9250,-1297C9250,-1297 9002,-1297 9002,-1297 8996,-1297 8990,-1291 8990,-1285 8990,-1285 8990,-1241 8990,-1241 8990,-1235 8996,-1229 9002,-1229 9002,-1229 9250,-1229 9250,-1229 9256,-1229 9262,-1235 9262,-1241 9262,-1241 9262,-1285 9262,-1285 9262,-1291 9256,-1297 9250,-1297"/>
<text text-anchor="middle" x="9126" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9126" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9126" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="9126" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_2 -->
<g id="edge91" class="edge">
<title>ln1&#45;&gt;k_proj_2_2</title>
<path fill="none" stroke="black" d="M7182.25,-1357.05C7401.28,-1350.77 7996.78,-1333.39 8493,-1316 8706.64,-1308.52 8764.09,-1324.92 8979.84,-1297.06"/>
<polygon fill="black" stroke="black" points="8980.44,-1300.51 8989.91,-1295.74 8979.54,-1293.57 8980.44,-1300.51"/>
</g>
<!-- v_proj_2_2 -->
<g id="node55" class="node">
<title>v_proj_2_2</title>
<path fill="lightyellow" stroke="black" d="M9540,-1297C9540,-1297 9292,-1297 9292,-1297 9286,-1297 9280,-1291 9280,-1285 9280,-1285 9280,-1241 9280,-1241 9280,-1235 9286,-1229 9292,-1229 9292,-1229 9540,-1229 9540,-1229 9546,-1229 9552,-1235 9552,-1241 9552,-1241 9552,-1285 9552,-1285 9552,-1291 9546,-1297 9540,-1297"/>
<text text-anchor="middle" x="9416" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9416" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9416" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="9416" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_2 -->
<g id="edge92" class="edge">
<title>ln1&#45;&gt;v_proj_2_2</title>
<path fill="none" stroke="black" d="M7182.13,-1359.27C7530.36,-1357.98 8835.7,-1349.76 9269.82,-1297.04"/>
<polygon fill="black" stroke="black" points="9270.42,-1300.49 9279.91,-1295.78 9269.56,-1293.54 9270.42,-1300.49"/>
</g>
<!-- q_proj_2_3 -->
<g id="node58" class="node">
<title>q_proj_2_3</title>
<path fill="lightyellow" stroke="black" d="M9830,-1297C9830,-1297 9582,-1297 9582,-1297 9576,-1297 9570,-1291 9570,-1285 9570,-1285 9570,-1241 9570,-1241 9570,-1235 9576,-1229 9582,-1229 9582,-1229 9830,-1229 9830,-1229 9836,-1229 9842,-1235 9842,-1241 9842,-1241 9842,-1285 9842,-1285 9842,-1291 9836,-1297 9830,-1297"/>
<text text-anchor="middle" x="9706" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9706" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9706" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9706" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_3 -->
<g id="edge98" class="edge">
<title>ln1&#45;&gt;q_proj_2_3</title>
<path fill="none" stroke="black" d="M7182.33,-1358.17C7459.13,-1353.79 8349.43,-1338.78 9086,-1316 9293.88,-1309.57 9349.82,-1324.31 9559.79,-1297.07"/>
<polygon fill="black" stroke="black" points="9560.45,-1300.51 9569.91,-1295.74 9559.53,-1293.57 9560.45,-1300.51"/>
</g>
<!-- k_proj_2_3 -->
<g id="node59" class="node">
<title>k_proj_2_3</title>
<path fill="lightyellow" stroke="black" d="M10120,-1297C10120,-1297 9872,-1297 9872,-1297 9866,-1297 9860,-1291 9860,-1285 9860,-1285 9860,-1241 9860,-1241 9860,-1235 9866,-1229 9872,-1229 9872,-1229 10120,-1229 10120,-1229 10126,-1229 10132,-1235 10132,-1241 10132,-1241 10132,-1285 10132,-1285 10132,-1291 10126,-1297 10120,-1297"/>
<text text-anchor="middle" x="9996" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9996" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9996" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9996" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_3 -->
<g id="edge99" class="edge">
<title>ln1&#45;&gt;k_proj_2_3</title>
<path fill="none" stroke="black" d="M7182.23,-1357.78C7461.74,-1352.18 8368.12,-1333.78 9118,-1316 9440.45,-1308.35 9525.9,-1336.98 9849.77,-1297.06"/>
<polygon fill="black" stroke="black" points="9850.42,-1300.5 9859.91,-1295.79 9849.56,-1293.56 9850.42,-1300.5"/>
</g>
<!-- v_proj_2_3 -->
<g id="node60" class="node">
<title>v_proj_2_3</title>
<path fill="lightyellow" stroke="black" d="M10410,-1297C10410,-1297 10162,-1297 10162,-1297 10156,-1297 10150,-1291 10150,-1285 10150,-1285 10150,-1241 10150,-1241 10150,-1235 10156,-1229 10162,-1229 10162,-1229 10410,-1229 10410,-1229 10416,-1229 10422,-1235 10422,-1241 10422,-1241 10422,-1285 10422,-1285 10422,-1291 10416,-1297 10410,-1297"/>
<text text-anchor="middle" x="10286" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10286" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="10286" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10286" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_3 -->
<g id="edge100" class="edge">
<title>ln1&#45;&gt;v_proj_2_3</title>
<path fill="none" stroke="black" d="M7182.01,-1358.08C7485.36,-1353.04 8533.69,-1335.25 9399,-1316 9725.42,-1308.74 9811.91,-1337.43 10139.65,-1297.07"/>
<polygon fill="black" stroke="black" points="10140.42,-1300.5 10149.91,-1295.8 10139.56,-1293.56 10140.42,-1300.5"/>
</g>
<!-- q_proj_3_0 -->
<g id="node63" class="node">
<title>q_proj_3_0</title>
<path fill="lightyellow" stroke="black" d="M10700,-1297C10700,-1297 10452,-1297 10452,-1297 10446,-1297 10440,-1291 10440,-1285 10440,-1285 10440,-1241 10440,-1241 10440,-1235 10446,-1229 10452,-1229 10452,-1229 10700,-1229 10700,-1229 10706,-1229 10712,-1235 10712,-1241 10712,-1241 10712,-1285 10712,-1285 10712,-1291 10706,-1297 10700,-1297"/>
<text text-anchor="middle" x="10576" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10576" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="10576" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="10576" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_0 -->
<g id="edge106" class="edge">
<title>ln1&#45;&gt;q_proj_3_0</title>
<path fill="none" stroke="black" d="M7182.26,-1358.32C7508.87,-1353.79 8700.88,-1336.73 9683,-1316 10012.07,-1309.05 10099.25,-1337.73 10429.57,-1297.08"/>
<polygon fill="black" stroke="black" points="10430.42,-1300.5 10439.91,-1295.8 10429.56,-1293.56 10430.42,-1300.5"/>
</g>
<!-- k_proj_3_0 -->
<g id="node64" class="node">
<title>k_proj_3_0</title>
<path fill="lightyellow" stroke="black" d="M10990,-1297C10990,-1297 10742,-1297 10742,-1297 10736,-1297 10730,-1291 10730,-1285 10730,-1285 10730,-1241 10730,-1241 10730,-1235 10736,-1229 10742,-1229 10742,-1229 10990,-1229 10990,-1229 10996,-1229 11002,-1235 11002,-1241 11002,-1241 11002,-1285 11002,-1285 11002,-1291 10996,-1297 10990,-1297"/>
<text text-anchor="middle" x="10866" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10866" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="10866" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="10866" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_0 -->
<g id="edge107" class="edge">
<title>ln1&#45;&gt;k_proj_3_0</title>
<path fill="none" stroke="black" d="M7182.03,-1358.53C7530.74,-1354.52 8872.97,-1338.43 9977,-1316 10304.32,-1309.35 10391.02,-1337.54 10719.62,-1297.08"/>
<polygon fill="black" stroke="black" points="10720.42,-1300.5 10729.91,-1295.8 10719.56,-1293.56 10720.42,-1300.5"/>
</g>
<!-- v_proj_3_0 -->
<g id="node65" class="node">
<title>v_proj_3_0</title>
<path fill="lightyellow" stroke="black" d="M11280,-1297C11280,-1297 11032,-1297 11032,-1297 11026,-1297 11020,-1291 11020,-1285 11020,-1285 11020,-1241 11020,-1241 11020,-1235 11026,-1229 11032,-1229 11032,-1229 11280,-1229 11280,-1229 11286,-1229 11292,-1235 11292,-1241 11292,-1241 11292,-1285 11292,-1285 11292,-1291 11286,-1297 11280,-1297"/>
<text text-anchor="middle" x="11156" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11156" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11156" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11156" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_0 -->
<g id="edge108" class="edge">
<title>ln1&#45;&gt;v_proj_3_0</title>
<path fill="none" stroke="black" d="M7182.14,-1358.69C7552.18,-1355.16 9043.78,-1340.08 10269,-1316 10595.44,-1309.58 10681.91,-1337.45 11009.65,-1297.07"/>
<polygon fill="black" stroke="black" points="11010.42,-1300.5 11019.91,-1295.8 11009.56,-1293.56 11010.42,-1300.5"/>
</g>
<!-- q_proj_3_1 -->
<g id="node68" class="node">
<title>q_proj_3_1</title>
<path fill="lightyellow" stroke="black" d="M11570,-1297C11570,-1297 11322,-1297 11322,-1297 11316,-1297 11310,-1291 11310,-1285 11310,-1285 11310,-1241 11310,-1241 11310,-1235 11316,-1229 11322,-1229 11322,-1229 11570,-1229 11570,-1229 11576,-1229 11582,-1235 11582,-1241 11582,-1241 11582,-1285 11582,-1285 11582,-1291 11576,-1297 11570,-1297"/>
<text text-anchor="middle" x="11446" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11446" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11446" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11446" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_1 -->
<g id="edge114" class="edge">
<title>ln1&#45;&gt;q_proj_3_1</title>
<path fill="none" stroke="black" d="M7182.03,-1358.83C7572.05,-1355.73 9213.4,-1341.72 10560,-1316 10886,-1309.77 10972.35,-1337.4 11299.66,-1297.07"/>
<polygon fill="black" stroke="black" points="11300.42,-1300.5 11309.91,-1295.8 11299.56,-1293.56 11300.42,-1300.5"/>
</g>
<!-- k_proj_3_1 -->
<g id="node69" class="node">
<title>k_proj_3_1</title>
<path fill="lightyellow" stroke="black" d="M11860,-1297C11860,-1297 11612,-1297 11612,-1297 11606,-1297 11600,-1291 11600,-1285 11600,-1285 11600,-1241 11600,-1241 11600,-1235 11606,-1229 11612,-1229 11612,-1229 11860,-1229 11860,-1229 11866,-1229 11872,-1235 11872,-1241 11872,-1241 11872,-1285 11872,-1285 11872,-1291 11866,-1297 11860,-1297"/>
<text text-anchor="middle" x="11736" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11736" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11736" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11736" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_1 -->
<g id="edge115" class="edge">
<title>ln1&#45;&gt;k_proj_3_1</title>
<path fill="none" stroke="black" d="M7182.31,-1358.95C7592.17,-1356.24 9383.14,-1343.35 10851,-1316 11176.57,-1309.93 11262.8,-1337.36 11589.68,-1297.07"/>
<polygon fill="black" stroke="black" points="11590.42,-1300.5 11599.91,-1295.8 11589.56,-1293.56 11590.42,-1300.5"/>
</g>
<!-- v_proj_3_1 -->
<g id="node70" class="node">
<title>v_proj_3_1</title>
<path fill="lightyellow" stroke="black" d="M12150,-1297C12150,-1297 11902,-1297 11902,-1297 11896,-1297 11890,-1291 11890,-1285 11890,-1285 11890,-1241 11890,-1241 11890,-1235 11896,-1229 11902,-1229 11902,-1229 12150,-1229 12150,-1229 12156,-1229 12162,-1235 12162,-1241 12162,-1241 12162,-1285 12162,-1285 12162,-1291 12156,-1297 12150,-1297"/>
<text text-anchor="middle" x="12026" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12026" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12026" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="12026" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_1 -->
<g id="edge116" class="edge">
<title>ln1&#45;&gt;v_proj_3_1</title>
<path fill="none" stroke="black" d="M7182.13,-1359.05C7610.26,-1356.72 9552.05,-1344.98 11142,-1316 11467.13,-1310.07 11553.24,-1337.31 11879.69,-1297.07"/>
<polygon fill="black" stroke="black" points="11880.42,-1300.5 11889.91,-1295.8 11879.56,-1293.56 11880.42,-1300.5"/>
</g>
<!-- q_proj_3_2 -->
<g id="node73" class="node">
<title>q_proj_3_2</title>
<path fill="lightyellow" stroke="black" d="M12440,-1297C12440,-1297 12192,-1297 12192,-1297 12186,-1297 12180,-1291 12180,-1285 12180,-1285 12180,-1241 12180,-1241 12180,-1235 12186,-1229 12192,-1229 12192,-1229 12440,-1229 12440,-1229 12446,-1229 12452,-1235 12452,-1241 12452,-1241 12452,-1285 12452,-1285 12452,-1291 12446,-1297 12440,-1297"/>
<text text-anchor="middle" x="12316" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12316" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12316" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12316" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_2 -->
<g id="edge122" class="edge">
<title>ln1&#45;&gt;q_proj_3_2</title>
<path fill="none" stroke="black" d="M7182.32,-1359.14C7628.72,-1357.16 9720.56,-1346.58 11432,-1316 11757.13,-1310.19 11843.24,-1337.31 12169.69,-1297.07"/>
<polygon fill="black" stroke="black" points="12170.42,-1300.5 12179.91,-1295.8 12169.56,-1293.56 12170.42,-1300.5"/>
</g>
<!-- k_proj_3_2 -->
<g id="node74" class="node">
<title>k_proj_3_2</title>
<path fill="lightyellow" stroke="black" d="M12730,-1297C12730,-1297 12482,-1297 12482,-1297 12476,-1297 12470,-1291 12470,-1285 12470,-1285 12470,-1241 12470,-1241 12470,-1235 12476,-1229 12482,-1229 12482,-1229 12730,-1229 12730,-1229 12736,-1229 12742,-1235 12742,-1241 12742,-1241 12742,-1285 12742,-1285 12742,-1291 12736,-1297 12730,-1297"/>
<text text-anchor="middle" x="12606" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12606" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12606" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12606" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_2 -->
<g id="edge123" class="edge">
<title>ln1&#45;&gt;k_proj_3_2</title>
<path fill="none" stroke="black" d="M7182.29,-1359.21C7645.94,-1357.56 9888.57,-1348.19 11722,-1316 12047.13,-1310.29 12133.24,-1337.31 12459.69,-1297.07"/>
<polygon fill="black" stroke="black" points="12460.42,-1300.5 12469.91,-1295.8 12459.56,-1293.56 12460.42,-1300.5"/>
</g>
<!-- v_proj_3_2 -->
<g id="node75" class="node">
<title>v_proj_3_2</title>
<path fill="lightyellow" stroke="black" d="M13020,-1297C13020,-1297 12772,-1297 12772,-1297 12766,-1297 12760,-1291 12760,-1285 12760,-1285 12760,-1241 12760,-1241 12760,-1235 12766,-1229 12772,-1229 12772,-1229 13020,-1229 13020,-1229 13026,-1229 13032,-1235 13032,-1241 13032,-1241 13032,-1285 13032,-1285 13032,-1291 13026,-1297 13020,-1297"/>
<text text-anchor="middle" x="12896" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12896" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12896" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12896" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_2 -->
<g id="edge124" class="edge">
<title>ln1&#45;&gt;v_proj_3_2</title>
<path fill="none" stroke="black" d="M7182.12,-1359.28C7662.15,-1357.94 10056.16,-1349.79 12012,-1316 12337.14,-1310.38 12423.24,-1337.32 12749.69,-1297.07"/>
<polygon fill="black" stroke="black" points="12750.42,-1300.5 12759.91,-1295.8 12749.56,-1293.56 12750.42,-1300.5"/>
</g>
<!-- q_proj_3_3 -->
<g id="node78" class="node">
<title>q_proj_3_3</title>
<path fill="lightyellow" stroke="black" d="M13310,-1297C13310,-1297 13062,-1297 13062,-1297 13056,-1297 13050,-1291 13050,-1285 13050,-1285 13050,-1241 13050,-1241 13050,-1235 13056,-1229 13062,-1229 13062,-1229 13310,-1229 13310,-1229 13316,-1229 13322,-1235 13322,-1241 13322,-1241 13322,-1285 13322,-1285 13322,-1291 13316,-1297 13310,-1297"/>
<text text-anchor="middle" x="13186" y="-1281.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13186" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="13186" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13186" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_3 -->
<g id="edge130" class="edge">
<title>ln1&#45;&gt;q_proj_3_3</title>
<path fill="none" stroke="black" d="M7182.28,-1359.34C7678.95,-1358.3 10224.01,-1351.39 12302,-1316 12627.14,-1310.46 12713.24,-1337.32 13039.69,-1297.07"/>
<polygon fill="black" stroke="black" points="13040.42,-1300.5 13049.91,-1295.8 13039.56,-1293.56 13040.42,-1300.5"/>
</g>
<!-- k_proj_3_3 -->
<g id="node79" class="node">
<title>k_proj_3_3</title>
<path fill="lightyellow" stroke="black" d="M13600,-1297C13600,-1297 13352,-1297 13352,-1297 13346,-1297 13340,-1291 13340,-1285 13340,-1285 13340,-1241 13340,-1241 13340,-1235 13346,-1229 13352,-1229 13352,-1229 13600,-1229 13600,-1229 13606,-1229 13612,-1235 13612,-1241 13612,-1241 13612,-1285 13612,-1285 13612,-1291 13606,-1297 13600,-1297"/>
<text text-anchor="middle" x="13476" y="-1281.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13476" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="13476" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13476" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_3 -->
<g id="edge131" class="edge">
<title>ln1&#45;&gt;k_proj_3_3</title>
<path fill="none" stroke="black" d="M7182.02,-1359.39C7693.89,-1358.64 10391.1,-1353 12592,-1316 12917.14,-1310.53 13003.24,-1337.32 13329.69,-1297.07"/>
<polygon fill="black" stroke="black" points="13330.42,-1300.5 13339.91,-1295.8 13329.56,-1293.56 13330.42,-1300.5"/>
</g>
<!-- v_proj_3_3 -->
<g id="node80" class="node">
<title>v_proj_3_3</title>
<path fill="lightyellow" stroke="black" d="M13890,-1297C13890,-1297 13642,-1297 13642,-1297 13636,-1297 13630,-1291 13630,-1285 13630,-1285 13630,-1241 13630,-1241 13630,-1235 13636,-1229 13642,-1229 13642,-1229 13890,-1229 13890,-1229 13896,-1229 13902,-1235 13902,-1241 13902,-1241 13902,-1285 13902,-1285 13902,-1291 13896,-1297 13890,-1297"/>
<text text-anchor="middle" x="13766" y="-1281.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13766" y="-1266.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="13766" y="-1251.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13766" y="-1236.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_3 -->
<g id="edge132" class="edge">
<title>ln1&#45;&gt;v_proj_3_3</title>
<path fill="none" stroke="black" d="M7182.23,-1359.44C7710.04,-1358.96 10558.69,-1354.6 12882,-1316 13207.14,-1310.6 13293.24,-1337.32 13619.69,-1297.07"/>
<polygon fill="black" stroke="black" points="13620.42,-1300.5 13629.91,-1295.8 13619.56,-1293.56 13620.42,-1300.5"/>
</g>
<!-- attn_0_0 -->
<g id="node6" class="node">
<title>attn_0_0</title>
<path fill="orange" stroke="black" d="M632,-1192C632,-1192 366,-1192 366,-1192 360,-1192 354,-1186 354,-1180 354,-1180 354,-1151 354,-1151 354,-1145 360,-1139 366,-1139 366,-1139 632,-1139 632,-1139 638,-1139 644,-1145 644,-1151 644,-1151 644,-1180 644,-1180 644,-1186 638,-1192 632,-1192"/>
<text text-anchor="middle" x="499" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="499" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="499" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge13" class="edge">
<title>q_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M261.69,-1228.93C304.26,-1217.73 351.38,-1205.34 392.33,-1194.56"/>
<polygon fill="black" stroke="black" points="393.28,-1197.93 402.06,-1192 391.49,-1191.16 393.28,-1197.93"/>
</g>
<!-- k_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge14" class="edge">
<title>k_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M451.33,-1228.87C458.46,-1219.53 466.23,-1209.38 473.38,-1200.02"/>
<polygon fill="black" stroke="black" points="476.18,-1202.12 479.47,-1192.05 470.62,-1197.86 476.18,-1202.12"/>
</g>
<!-- v_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge15" class="edge">
<title>v_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M640.71,-1228.87C616.51,-1218.21 589.86,-1206.49 566.27,-1196.1"/>
<polygon fill="black" stroke="black" points="567.61,-1192.87 557.05,-1192.05 564.79,-1199.28 567.61,-1192.87"/>
</g>
<!-- out_proj_0_0 -->
<g id="node7" class="node">
<title>out_proj_0_0</title>
<path fill="lightcoral" stroke="black" d="M1312,-1102C1312,-1102 1064,-1102 1064,-1102 1058,-1102 1052,-1096 1052,-1090 1052,-1090 1052,-1046 1052,-1046 1052,-1040 1058,-1034 1064,-1034 1064,-1034 1312,-1034 1312,-1034 1318,-1034 1324,-1040 1324,-1046 1324,-1046 1324,-1090 1324,-1090 1324,-1096 1318,-1102 1312,-1102"/>
<text text-anchor="middle" x="1188" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1188" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1188" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1188" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_0&#45;&gt;out_proj_0_0 -->
<g id="edge16" class="edge">
<title>attn_0_0&#45;&gt;out_proj_0_0</title>
<path fill="none" stroke="black" d="M644.28,-1144.36C761.19,-1128.16 924.74,-1105.49 1041.88,-1089.25"/>
<polygon fill="black" stroke="black" points="1042.57,-1092.69 1052,-1087.85 1041.61,-1085.76 1042.57,-1092.69"/>
</g>
<!-- concat_dim_0 -->
<g id="node83" class="node">
<title>concat_dim_0</title>
<path fill="lightpink" stroke="black" d="M2287,-997C2287,-997 2045,-997 2045,-997 2039,-997 2033,-991 2033,-985 2033,-985 2033,-956 2033,-956 2033,-950 2039,-944 2045,-944 2045,-944 2287,-944 2287,-944 2293,-944 2299,-950 2299,-956 2299,-956 2299,-985 2299,-985 2299,-991 2293,-997 2287,-997"/>
<text text-anchor="middle" x="2166" y="-981.8" font-family="Times,serif" font-size="14.00">Concat Dimension Segments</text>
<text text-anchor="middle" x="2166" y="-966.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d=512×h_g=4=2048)</text>
<text text-anchor="middle" x="2166" y="-951.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
</g>
<!-- out_proj_0_0&#45;&gt;concat_dim_0 -->
<g id="edge17" class="edge">
<title>out_proj_0_0&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M1324.39,-1053.03C1382.78,-1047.09 1451.73,-1040.14 1514,-1034 1689.09,-1016.75 1890.69,-997.52 2022.81,-985.01"/>
<polygon fill="black" stroke="black" points="2023.37,-988.47 2032.99,-984.04 2022.71,-981.5 2023.37,-988.47"/>
</g>
<!-- attn_0_1 -->
<g id="node11" class="node">
<title>attn_0_1</title>
<path fill="orange" stroke="black" d="M1575,-1192C1575,-1192 1309,-1192 1309,-1192 1303,-1192 1297,-1186 1297,-1180 1297,-1180 1297,-1151 1297,-1151 1297,-1145 1303,-1139 1309,-1139 1309,-1139 1575,-1139 1575,-1139 1581,-1139 1587,-1145 1587,-1151 1587,-1151 1587,-1180 1587,-1180 1587,-1186 1581,-1192 1575,-1192"/>
<text text-anchor="middle" x="1442" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1442" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1442" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge21" class="edge">
<title>q_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M1142.22,-1230.95C1145.17,-1230.29 1148.1,-1229.64 1151,-1229 1203.5,-1217.39 1261.41,-1204.89 1311.64,-1194.14"/>
<polygon fill="black" stroke="black" points="1312.54,-1197.53 1321.58,-1192.02 1311.07,-1190.69 1312.54,-1197.53"/>
</g>
<!-- k_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge22" class="edge">
<title>k_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M1346.65,-1228.87C1362.08,-1218.78 1378.97,-1207.73 1394.2,-1197.77"/>
<polygon fill="black" stroke="black" points="1396.49,-1200.45 1402.95,-1192.05 1392.66,-1194.59 1396.49,-1200.45"/>
</g>
<!-- v_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge23" class="edge">
<title>v_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M1536.04,-1228.87C1520.83,-1218.78 1504.17,-1207.73 1489.15,-1197.77"/>
<polygon fill="black" stroke="black" points="1490.79,-1194.66 1480.52,-1192.05 1486.92,-1200.49 1490.79,-1194.66"/>
</g>
<!-- out_proj_0_1 -->
<g id="node12" class="node">
<title>out_proj_0_1</title>
<path fill="lightcoral" stroke="black" d="M1783,-1102C1783,-1102 1535,-1102 1535,-1102 1529,-1102 1523,-1096 1523,-1090 1523,-1090 1523,-1046 1523,-1046 1523,-1040 1529,-1034 1535,-1034 1535,-1034 1783,-1034 1783,-1034 1789,-1034 1795,-1040 1795,-1046 1795,-1046 1795,-1090 1795,-1090 1795,-1096 1789,-1102 1783,-1102"/>
<text text-anchor="middle" x="1659" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1659" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="1659" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1659" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_1&#45;&gt;out_proj_0_1 -->
<g id="edge24" class="edge">
<title>attn_0_1&#45;&gt;out_proj_0_1</title>
<path fill="none" stroke="black" d="M1500.15,-1138.91C1522.97,-1128.86 1549.61,-1117.14 1574.48,-1106.2"/>
<polygon fill="black" stroke="black" points="1576.17,-1109.28 1583.91,-1102.04 1573.35,-1102.87 1576.17,-1109.28"/>
</g>
<!-- out_proj_0_1&#45;&gt;concat_dim_0 -->
<g id="edge25" class="edge">
<title>out_proj_0_1&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M1795.2,-1041.34C1865.65,-1028.07 1951.61,-1011.88 2023.02,-998.43"/>
<polygon fill="black" stroke="black" points="2023.82,-1001.84 2033,-996.55 2022.52,-994.96 2023.82,-1001.84"/>
</g>
<!-- attn_0_2 -->
<g id="node16" class="node">
<title>attn_0_2</title>
<path fill="orange" stroke="black" d="M2299,-1192C2299,-1192 2033,-1192 2033,-1192 2027,-1192 2021,-1186 2021,-1180 2021,-1180 2021,-1151 2021,-1151 2021,-1145 2027,-1139 2033,-1139 2033,-1139 2299,-1139 2299,-1139 2305,-1139 2311,-1145 2311,-1151 2311,-1151 2311,-1180 2311,-1180 2311,-1186 2305,-1192 2299,-1192"/>
<text text-anchor="middle" x="2166" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2166" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2166" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge29" class="edge">
<title>q_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M1976.61,-1228.87C2009.82,-1217.93 2046.47,-1205.86 2078.61,-1195.28"/>
<polygon fill="black" stroke="black" points="2080.02,-1198.5 2088.43,-1192.05 2077.84,-1191.85 2080.02,-1198.5"/>
</g>
<!-- k_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge30" class="edge">
<title>k_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M2166,-1228.87C2166,-1220.29 2166,-1211.01 2166,-1202.3"/>
<polygon fill="black" stroke="black" points="2169.5,-1202.05 2166,-1192.05 2162.5,-1202.05 2169.5,-1202.05"/>
</g>
<!-- v_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge31" class="edge">
<title>v_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M2355.39,-1228.87C2322.18,-1217.93 2285.53,-1205.86 2253.39,-1195.28"/>
<polygon fill="black" stroke="black" points="2254.16,-1191.85 2243.57,-1192.05 2251.98,-1198.5 2254.16,-1191.85"/>
</g>
<!-- out_proj_0_2 -->
<g id="node17" class="node">
<title>out_proj_0_2</title>
<path fill="lightcoral" stroke="black" d="M2290,-1102C2290,-1102 2042,-1102 2042,-1102 2036,-1102 2030,-1096 2030,-1090 2030,-1090 2030,-1046 2030,-1046 2030,-1040 2036,-1034 2042,-1034 2042,-1034 2290,-1034 2290,-1034 2296,-1034 2302,-1040 2302,-1046 2302,-1046 2302,-1090 2302,-1090 2302,-1096 2296,-1102 2290,-1102"/>
<text text-anchor="middle" x="2166" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2166" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2166" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2166" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_2&#45;&gt;out_proj_0_2 -->
<g id="edge32" class="edge">
<title>attn_0_2&#45;&gt;out_proj_0_2</title>
<path fill="none" stroke="black" d="M2166,-1138.91C2166,-1130.72 2166,-1121.41 2166,-1112.32"/>
<polygon fill="black" stroke="black" points="2169.5,-1112.22 2166,-1102.22 2162.5,-1112.22 2169.5,-1112.22"/>
</g>
<!-- out_proj_0_2&#45;&gt;concat_dim_0 -->
<g id="edge33" class="edge">
<title>out_proj_0_2&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M2166,-1033.87C2166,-1025.29 2166,-1016.01 2166,-1007.3"/>
<polygon fill="black" stroke="black" points="2169.5,-1007.05 2166,-997.05 2162.5,-1007.05 2169.5,-1007.05"/>
</g>
<!-- attn_0_3 -->
<g id="node21" class="node">
<title>attn_0_3</title>
<path fill="orange" stroke="black" d="M3064,-1192C3064,-1192 2798,-1192 2798,-1192 2792,-1192 2786,-1186 2786,-1180 2786,-1180 2786,-1151 2786,-1151 2786,-1145 2792,-1139 2798,-1139 2798,-1139 3064,-1139 3064,-1139 3070,-1139 3076,-1145 3076,-1151 3076,-1151 3076,-1180 3076,-1180 3076,-1186 3070,-1192 3064,-1192"/>
<text text-anchor="middle" x="2931" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2931" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2931" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge37" class="edge">
<title>q_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M2810.18,-1228.87C2830.46,-1218.4 2852.74,-1206.9 2872.58,-1196.66"/>
<polygon fill="black" stroke="black" points="2874.23,-1199.74 2881.51,-1192.05 2871.02,-1193.52 2874.23,-1199.74"/>
</g>
<!-- k_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge38" class="edge">
<title>k_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M2999.57,-1228.87C2988.89,-1219.16 2977.24,-1208.55 2966.61,-1198.89"/>
<polygon fill="black" stroke="black" points="2968.84,-1196.18 2959.09,-1192.05 2964.13,-1201.36 2968.84,-1196.18"/>
</g>
<!-- v_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge39" class="edge">
<title>v_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M3189.79,-1229.07C3143.13,-1217.79 3091.41,-1205.28 3046.54,-1194.43"/>
<polygon fill="black" stroke="black" points="3047.32,-1191.02 3036.78,-1192.08 3045.68,-1197.83 3047.32,-1191.02"/>
</g>
<!-- out_proj_0_3 -->
<g id="node22" class="node">
<title>out_proj_0_3</title>
<path fill="lightcoral" stroke="black" d="M2725,-1102C2725,-1102 2477,-1102 2477,-1102 2471,-1102 2465,-1096 2465,-1090 2465,-1090 2465,-1046 2465,-1046 2465,-1040 2471,-1034 2477,-1034 2477,-1034 2725,-1034 2725,-1034 2731,-1034 2737,-1040 2737,-1046 2737,-1046 2737,-1090 2737,-1090 2737,-1096 2731,-1102 2725,-1102"/>
<text text-anchor="middle" x="2601" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2601" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="2601" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2601" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_0_3&#45;&gt;out_proj_0_3 -->
<g id="edge40" class="edge">
<title>attn_0_3&#45;&gt;out_proj_0_3</title>
<path fill="none" stroke="black" d="M2842.57,-1138.91C2806.49,-1128.47 2764.13,-1116.21 2725.04,-1104.9"/>
<polygon fill="black" stroke="black" points="2725.76,-1101.46 2715.18,-1102.04 2723.82,-1108.19 2725.76,-1101.46"/>
</g>
<!-- out_proj_0_3&#45;&gt;concat_dim_0 -->
<g id="edge41" class="edge">
<title>out_proj_0_3&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M2464.85,-1037.11C2409.72,-1025.01 2346.43,-1011.11 2292.34,-999.24"/>
<polygon fill="black" stroke="black" points="2292.86,-995.77 2282.34,-997.04 2291.36,-1002.61 2292.86,-995.77"/>
</g>
<!-- attn_1_0 -->
<g id="node26" class="node">
<title>attn_1_0</title>
<path fill="orange" stroke="black" d="M4183,-1192C4183,-1192 3917,-1192 3917,-1192 3911,-1192 3905,-1186 3905,-1180 3905,-1180 3905,-1151 3905,-1151 3905,-1145 3911,-1139 3917,-1139 3917,-1139 4183,-1139 4183,-1139 4189,-1139 4195,-1145 4195,-1151 4195,-1151 4195,-1180 4195,-1180 4195,-1186 4189,-1192 4183,-1192"/>
<text text-anchor="middle" x="4050" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4050" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4050" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge45" class="edge">
<title>q_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M3752.22,-1230.95C3755.17,-1230.3 3758.1,-1229.64 3761,-1229 3813.15,-1217.43 3870.66,-1204.94 3920.55,-1194.18"/>
<polygon fill="black" stroke="black" points="3921.38,-1197.58 3930.42,-1192.06 3919.91,-1190.74 3921.38,-1197.58"/>
</g>
<!-- k_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge46" class="edge">
<title>k_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M3955.96,-1228.87C3971.17,-1218.78 3987.83,-1207.73 4002.85,-1197.77"/>
<polygon fill="black" stroke="black" points="4005.08,-1200.49 4011.48,-1192.05 4001.21,-1194.66 4005.08,-1200.49"/>
</g>
<!-- v_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge47" class="edge">
<title>v_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4145.35,-1228.87C4129.92,-1218.78 4113.03,-1207.73 4097.8,-1197.77"/>
<polygon fill="black" stroke="black" points="4099.34,-1194.59 4089.05,-1192.05 4095.51,-1200.45 4099.34,-1194.59"/>
</g>
<!-- out_proj_1_0 -->
<g id="node27" class="node">
<title>out_proj_1_0</title>
<path fill="lightcoral" stroke="black" d="M4885,-1102C4885,-1102 4637,-1102 4637,-1102 4631,-1102 4625,-1096 4625,-1090 4625,-1090 4625,-1046 4625,-1046 4625,-1040 4631,-1034 4637,-1034 4637,-1034 4885,-1034 4885,-1034 4891,-1034 4897,-1040 4897,-1046 4897,-1046 4897,-1090 4897,-1090 4897,-1096 4891,-1102 4885,-1102"/>
<text text-anchor="middle" x="4761" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4761" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4761" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4761" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_0&#45;&gt;out_proj_1_0 -->
<g id="edge48" class="edge">
<title>attn_1_0&#45;&gt;out_proj_1_0</title>
<path fill="none" stroke="black" d="M4195.17,-1145C4317.53,-1128.57 4491.81,-1105.16 4614.54,-1088.67"/>
<polygon fill="black" stroke="black" points="4615.32,-1092.1 4624.77,-1087.3 4614.39,-1085.16 4615.32,-1092.1"/>
</g>
<!-- concat_dim_1 -->
<g id="node84" class="node">
<title>concat_dim_1</title>
<path fill="lightpink" stroke="black" d="M5767,-997C5767,-997 5525,-997 5525,-997 5519,-997 5513,-991 5513,-985 5513,-985 5513,-956 5513,-956 5513,-950 5519,-944 5525,-944 5525,-944 5767,-944 5767,-944 5773,-944 5779,-950 5779,-956 5779,-956 5779,-985 5779,-985 5779,-991 5773,-997 5767,-997"/>
<text text-anchor="middle" x="5646" y="-981.8" font-family="Times,serif" font-size="14.00">Concat Dimension Segments</text>
<text text-anchor="middle" x="5646" y="-966.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d=512×h_g=4=2048)</text>
<text text-anchor="middle" x="5646" y="-951.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
</g>
<!-- out_proj_1_0&#45;&gt;concat_dim_1 -->
<g id="edge49" class="edge">
<title>out_proj_1_0&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M4897.06,-1047.24C4930.67,-1042.62 4966.62,-1037.92 5000,-1034 5172.6,-1013.74 5371.7,-995.21 5502.73,-983.67"/>
<polygon fill="black" stroke="black" points="5503.17,-987.15 5512.83,-982.79 5502.56,-980.18 5503.17,-987.15"/>
</g>
<!-- attn_1_1 -->
<g id="node31" class="node">
<title>attn_1_1</title>
<path fill="orange" stroke="black" d="M5021,-1192C5021,-1192 4755,-1192 4755,-1192 4749,-1192 4743,-1186 4743,-1180 4743,-1180 4743,-1151 4743,-1151 4743,-1145 4749,-1139 4755,-1139 4755,-1139 5021,-1139 5021,-1139 5027,-1139 5033,-1145 5033,-1151 5033,-1151 5033,-1180 5033,-1180 5033,-1186 5027,-1192 5021,-1192"/>
<text text-anchor="middle" x="4888" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4888" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="4888" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge53" class="edge">
<title>q_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M4622.1,-1229.67C4670.37,-1218.2 4724.24,-1205.4 4770.8,-1194.34"/>
<polygon fill="black" stroke="black" points="4771.7,-1197.73 4780.62,-1192.01 4770.08,-1190.92 4771.7,-1197.73"/>
</g>
<!-- k_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge54" class="edge">
<title>k_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M4814.86,-1228.87C4826.36,-1219.06 4838.92,-1208.35 4850.34,-1198.61"/>
<polygon fill="black" stroke="black" points="4852.7,-1201.2 4858.04,-1192.05 4848.16,-1195.87 4852.7,-1201.2"/>
</g>
<!-- v_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge55" class="edge">
<title>v_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M5004.24,-1228.87C4984.83,-1218.45 4963.5,-1207 4944.46,-1196.79"/>
<polygon fill="black" stroke="black" points="4946.08,-1193.69 4935.61,-1192.05 4942.77,-1199.86 4946.08,-1193.69"/>
</g>
<!-- out_proj_1_1 -->
<g id="node32" class="node">
<title>out_proj_1_1</title>
<path fill="lightcoral" stroke="black" d="M5269,-1102C5269,-1102 5021,-1102 5021,-1102 5015,-1102 5009,-1096 5009,-1090 5009,-1090 5009,-1046 5009,-1046 5009,-1040 5015,-1034 5021,-1034 5021,-1034 5269,-1034 5269,-1034 5275,-1034 5281,-1040 5281,-1046 5281,-1046 5281,-1090 5281,-1090 5281,-1096 5275,-1102 5269,-1102"/>
<text text-anchor="middle" x="5145" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5145" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5145" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="5145" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_1&#45;&gt;out_proj_1_1 -->
<g id="edge56" class="edge">
<title>attn_1_1&#45;&gt;out_proj_1_1</title>
<path fill="none" stroke="black" d="M4956.87,-1138.91C4984.38,-1128.69 5016.56,-1116.73 5046.46,-1105.62"/>
<polygon fill="black" stroke="black" points="5047.92,-1108.81 5056.07,-1102.04 5045.48,-1102.25 5047.92,-1108.81"/>
</g>
<!-- out_proj_1_1&#45;&gt;concat_dim_1 -->
<g id="edge57" class="edge">
<title>out_proj_1_1&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5281.24,-1041.03C5349.87,-1027.95 5433.06,-1012.09 5502.66,-998.82"/>
<polygon fill="black" stroke="black" points="5503.65,-1002.2 5512.82,-996.89 5502.34,-995.32 5503.65,-1002.2"/>
</g>
<!-- attn_1_2 -->
<g id="node36" class="node">
<title>attn_1_2</title>
<path fill="orange" stroke="black" d="M5779,-1192C5779,-1192 5513,-1192 5513,-1192 5507,-1192 5501,-1186 5501,-1180 5501,-1180 5501,-1151 5501,-1151 5501,-1145 5507,-1139 5513,-1139 5513,-1139 5779,-1139 5779,-1139 5785,-1139 5791,-1145 5791,-1151 5791,-1151 5791,-1180 5791,-1180 5791,-1186 5785,-1192 5779,-1192"/>
<text text-anchor="middle" x="5646" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5646" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5646" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge61" class="edge">
<title>q_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5456.61,-1228.87C5489.82,-1217.93 5526.47,-1205.86 5558.61,-1195.28"/>
<polygon fill="black" stroke="black" points="5560.02,-1198.5 5568.43,-1192.05 5557.84,-1191.85 5560.02,-1198.5"/>
</g>
<!-- k_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge62" class="edge">
<title>k_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5646,-1228.87C5646,-1220.29 5646,-1211.01 5646,-1202.3"/>
<polygon fill="black" stroke="black" points="5649.5,-1202.05 5646,-1192.05 5642.5,-1202.05 5649.5,-1202.05"/>
</g>
<!-- v_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge63" class="edge">
<title>v_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5835.39,-1228.87C5802.18,-1217.93 5765.53,-1205.86 5733.39,-1195.28"/>
<polygon fill="black" stroke="black" points="5734.16,-1191.85 5723.57,-1192.05 5731.98,-1198.5 5734.16,-1191.85"/>
</g>
<!-- out_proj_1_2 -->
<g id="node37" class="node">
<title>out_proj_1_2</title>
<path fill="lightcoral" stroke="black" d="M5770,-1102C5770,-1102 5522,-1102 5522,-1102 5516,-1102 5510,-1096 5510,-1090 5510,-1090 5510,-1046 5510,-1046 5510,-1040 5516,-1034 5522,-1034 5522,-1034 5770,-1034 5770,-1034 5776,-1034 5782,-1040 5782,-1046 5782,-1046 5782,-1090 5782,-1090 5782,-1096 5776,-1102 5770,-1102"/>
<text text-anchor="middle" x="5646" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5646" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="5646" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5646" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_2&#45;&gt;out_proj_1_2 -->
<g id="edge64" class="edge">
<title>attn_1_2&#45;&gt;out_proj_1_2</title>
<path fill="none" stroke="black" d="M5646,-1138.91C5646,-1130.72 5646,-1121.41 5646,-1112.32"/>
<polygon fill="black" stroke="black" points="5649.5,-1112.22 5646,-1102.22 5642.5,-1112.22 5649.5,-1112.22"/>
</g>
<!-- out_proj_1_2&#45;&gt;concat_dim_1 -->
<g id="edge65" class="edge">
<title>out_proj_1_2&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5646,-1033.87C5646,-1025.29 5646,-1016.01 5646,-1007.3"/>
<polygon fill="black" stroke="black" points="5649.5,-1007.05 5646,-997.05 5642.5,-1007.05 5649.5,-1007.05"/>
</g>
<!-- attn_1_3 -->
<g id="node41" class="node">
<title>attn_1_3</title>
<path fill="orange" stroke="black" d="M6472,-1192C6472,-1192 6206,-1192 6206,-1192 6200,-1192 6194,-1186 6194,-1180 6194,-1180 6194,-1151 6194,-1151 6194,-1145 6200,-1139 6206,-1139 6206,-1139 6472,-1139 6472,-1139 6478,-1139 6484,-1145 6484,-1151 6484,-1151 6484,-1180 6484,-1180 6484,-1186 6478,-1192 6472,-1192"/>
<text text-anchor="middle" x="6339" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6339" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="6339" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge69" class="edge">
<title>q_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6265.2,-1228.87C6276.81,-1219.06 6289.48,-1208.35 6301.01,-1198.61"/>
<polygon fill="black" stroke="black" points="6303.4,-1201.17 6308.77,-1192.05 6298.88,-1195.83 6303.4,-1201.17"/>
</g>
<!-- k_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge70" class="edge">
<title>k_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6454.59,-1228.87C6435.28,-1218.45 6414.07,-1207 6395.15,-1196.79"/>
<polygon fill="black" stroke="black" points="6396.81,-1193.71 6386.35,-1192.05 6393.48,-1199.87 6396.81,-1193.71"/>
</g>
<!-- v_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge71" class="edge">
<title>v_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6669.8,-1230.87C6666.84,-1230.24 6663.91,-1229.61 6661,-1229 6603.83,-1216.95 6540.78,-1204.52 6485.73,-1193.95"/>
<polygon fill="black" stroke="black" points="6486.38,-1190.51 6475.9,-1192.07 6485.06,-1197.39 6486.38,-1190.51"/>
</g>
<!-- out_proj_1_3 -->
<g id="node42" class="node">
<title>out_proj_1_3</title>
<path fill="lightcoral" stroke="black" d="M6196,-1102C6196,-1102 5948,-1102 5948,-1102 5942,-1102 5936,-1096 5936,-1090 5936,-1090 5936,-1046 5936,-1046 5936,-1040 5942,-1034 5948,-1034 5948,-1034 6196,-1034 6196,-1034 6202,-1034 6208,-1040 6208,-1046 6208,-1046 6208,-1090 6208,-1090 6208,-1096 6202,-1102 6196,-1102"/>
<text text-anchor="middle" x="6072" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6072" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="6072" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="6072" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_1_3&#45;&gt;out_proj_1_3 -->
<g id="edge72" class="edge">
<title>attn_1_3&#45;&gt;out_proj_1_3</title>
<path fill="none" stroke="black" d="M6267.45,-1138.91C6238.75,-1128.64 6205.15,-1116.62 6173.97,-1105.47"/>
<polygon fill="black" stroke="black" points="6174.98,-1102.12 6164.39,-1102.04 6172.62,-1108.71 6174.98,-1102.12"/>
</g>
<!-- out_proj_1_3&#45;&gt;concat_dim_1 -->
<g id="edge73" class="edge">
<title>out_proj_1_3&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5935.75,-1036.45C5882.46,-1024.51 5821.78,-1010.91 5769.76,-999.24"/>
<polygon fill="black" stroke="black" points="5770.34,-995.79 5759.82,-997.02 5768.81,-1002.62 5770.34,-995.79"/>
</g>
<!-- attn_2_0 -->
<g id="node46" class="node">
<title>attn_2_0</title>
<path fill="orange" stroke="black" d="M7664,-1192C7664,-1192 7398,-1192 7398,-1192 7392,-1192 7386,-1186 7386,-1180 7386,-1180 7386,-1151 7386,-1151 7386,-1145 7392,-1139 7398,-1139 7398,-1139 7664,-1139 7664,-1139 7670,-1139 7676,-1145 7676,-1151 7676,-1151 7676,-1180 7676,-1180 7676,-1186 7670,-1192 7664,-1192"/>
<text text-anchor="middle" x="7531" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7531" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="7531" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge77" class="edge">
<title>q_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M7232.22,-1230.95C7235.17,-1230.29 7238.1,-1229.64 7241,-1229 7293.33,-1217.41 7351.03,-1204.91 7401.1,-1194.16"/>
<polygon fill="black" stroke="black" points="7401.96,-1197.56 7411,-1192.04 7400.49,-1190.71 7401.96,-1197.56"/>
</g>
<!-- k_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge78" class="edge">
<title>k_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M7436.31,-1228.87C7451.62,-1218.78 7468.4,-1207.73 7483.52,-1197.77"/>
<polygon fill="black" stroke="black" points="7485.79,-1200.47 7492.21,-1192.05 7481.94,-1194.62 7485.79,-1200.47"/>
</g>
<!-- v_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge79" class="edge">
<title>v_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M7625.69,-1228.87C7610.38,-1218.78 7593.6,-1207.73 7578.48,-1197.77"/>
<polygon fill="black" stroke="black" points="7580.06,-1194.62 7569.79,-1192.05 7576.21,-1200.47 7580.06,-1194.62"/>
</g>
<!-- out_proj_2_0 -->
<g id="node47" class="node">
<title>out_proj_2_0</title>
<path fill="lightcoral" stroke="black" d="M8140,-1102C8140,-1102 7892,-1102 7892,-1102 7886,-1102 7880,-1096 7880,-1090 7880,-1090 7880,-1046 7880,-1046 7880,-1040 7886,-1034 7892,-1034 7892,-1034 8140,-1034 8140,-1034 8146,-1034 8152,-1040 8152,-1046 8152,-1046 8152,-1090 8152,-1090 8152,-1096 8146,-1102 8140,-1102"/>
<text text-anchor="middle" x="8016" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8016" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8016" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="8016" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_0&#45;&gt;out_proj_2_0 -->
<g id="edge80" class="edge">
<title>attn_2_0&#45;&gt;out_proj_2_0</title>
<path fill="none" stroke="black" d="M7660.65,-1138.97C7725.11,-1126.28 7803.26,-1110.89 7869.83,-1097.78"/>
<polygon fill="black" stroke="black" points="7870.86,-1101.15 7879.99,-1095.78 7869.5,-1094.28 7870.86,-1101.15"/>
</g>
<!-- concat_dim_2 -->
<g id="node85" class="node">
<title>concat_dim_2</title>
<path fill="lightpink" stroke="black" d="M9024,-997C9024,-997 8782,-997 8782,-997 8776,-997 8770,-991 8770,-985 8770,-985 8770,-956 8770,-956 8770,-950 8776,-944 8782,-944 8782,-944 9024,-944 9024,-944 9030,-944 9036,-950 9036,-956 9036,-956 9036,-985 9036,-985 9036,-991 9030,-997 9024,-997"/>
<text text-anchor="middle" x="8903" y="-981.8" font-family="Times,serif" font-size="14.00">Concat Dimension Segments</text>
<text text-anchor="middle" x="8903" y="-966.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d=512×h_g=4=2048)</text>
<text text-anchor="middle" x="8903" y="-951.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
</g>
<!-- out_proj_2_0&#45;&gt;concat_dim_2 -->
<g id="edge81" class="edge">
<title>out_proj_2_0&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M8152.17,-1052.34C8316.59,-1034.64 8591.9,-1005 8759.53,-986.95"/>
<polygon fill="black" stroke="black" points="8760.1,-990.41 8769.67,-985.86 8759.35,-983.45 8760.1,-990.41"/>
</g>
<!-- attn_2_1 -->
<g id="node51" class="node">
<title>attn_2_1</title>
<path fill="orange" stroke="black" d="M8501,-1192C8501,-1192 8235,-1192 8235,-1192 8229,-1192 8223,-1186 8223,-1180 8223,-1180 8223,-1151 8223,-1151 8223,-1145 8229,-1139 8235,-1139 8235,-1139 8501,-1139 8501,-1139 8507,-1139 8513,-1145 8513,-1151 8513,-1151 8513,-1180 8513,-1180 8513,-1186 8507,-1192 8501,-1192"/>
<text text-anchor="middle" x="8368" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8368" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8368" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge85" class="edge">
<title>q_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M8102.1,-1229.67C8150.37,-1218.2 8204.24,-1205.4 8250.8,-1194.34"/>
<polygon fill="black" stroke="black" points="8251.7,-1197.73 8260.62,-1192.01 8250.08,-1190.92 8251.7,-1197.73"/>
</g>
<!-- k_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge86" class="edge">
<title>k_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M8294.86,-1228.87C8306.36,-1219.06 8318.92,-1208.35 8330.34,-1198.61"/>
<polygon fill="black" stroke="black" points="8332.7,-1201.2 8338.04,-1192.05 8328.16,-1195.87 8332.7,-1201.2"/>
</g>
<!-- v_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge87" class="edge">
<title>v_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M8484.24,-1228.87C8464.83,-1218.45 8443.5,-1207 8424.46,-1196.79"/>
<polygon fill="black" stroke="black" points="8426.08,-1193.69 8415.61,-1192.05 8422.77,-1199.86 8426.08,-1193.69"/>
</g>
<!-- out_proj_2_1 -->
<g id="node52" class="node">
<title>out_proj_2_1</title>
<path fill="lightcoral" stroke="black" d="M8679,-1102C8679,-1102 8431,-1102 8431,-1102 8425,-1102 8419,-1096 8419,-1090 8419,-1090 8419,-1046 8419,-1046 8419,-1040 8425,-1034 8431,-1034 8431,-1034 8679,-1034 8679,-1034 8685,-1034 8691,-1040 8691,-1046 8691,-1046 8691,-1090 8691,-1090 8691,-1096 8685,-1102 8679,-1102"/>
<text text-anchor="middle" x="8555" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8555" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="8555" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="8555" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_1&#45;&gt;out_proj_2_1 -->
<g id="edge88" class="edge">
<title>attn_2_1&#45;&gt;out_proj_2_1</title>
<path fill="none" stroke="black" d="M8418.11,-1138.91C8437.52,-1129 8460.13,-1117.45 8481.32,-1106.63"/>
<polygon fill="black" stroke="black" points="8482.98,-1109.71 8490.3,-1102.04 8479.8,-1103.48 8482.98,-1109.71"/>
</g>
<!-- out_proj_2_1&#45;&gt;concat_dim_2 -->
<g id="edge89" class="edge">
<title>out_proj_2_1&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M8675.74,-1033.87C8716.27,-1022.74 8761.08,-1010.45 8800.12,-999.73"/>
<polygon fill="black" stroke="black" points="8801.2,-1003.07 8809.91,-997.05 8799.34,-996.32 8801.2,-1003.07"/>
</g>
<!-- attn_2_2 -->
<g id="node56" class="node">
<title>attn_2_2</title>
<path fill="orange" stroke="black" d="M9245,-1192C9245,-1192 8979,-1192 8979,-1192 8973,-1192 8967,-1186 8967,-1180 8967,-1180 8967,-1151 8967,-1151 8967,-1145 8973,-1139 8979,-1139 8979,-1139 9245,-1139 9245,-1139 9251,-1139 9257,-1145 9257,-1151 9257,-1151 9257,-1180 9257,-1180 9257,-1186 9251,-1192 9245,-1192"/>
<text text-anchor="middle" x="9112" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9112" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9112" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge93" class="edge">
<title>q_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M8931.76,-1228.87C8963.23,-1217.98 8997.94,-1205.97 9028.43,-1195.42"/>
<polygon fill="black" stroke="black" points="9029.87,-1198.62 9038.17,-1192.05 9027.58,-1192.01 9029.87,-1198.62"/>
</g>
<!-- k_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge94" class="edge">
<title>k_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M9121.14,-1228.87C9119.87,-1220.19 9118.5,-1210.81 9117.21,-1202.02"/>
<polygon fill="black" stroke="black" points="9120.66,-1201.43 9115.74,-1192.05 9113.73,-1202.45 9120.66,-1201.43"/>
</g>
<!-- v_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge95" class="edge">
<title>v_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M9310.53,-1228.87C9275.57,-1217.88 9236.97,-1205.76 9203.18,-1195.14"/>
<polygon fill="black" stroke="black" points="9203.91,-1191.7 9193.32,-1192.05 9201.81,-1198.38 9203.91,-1191.7"/>
</g>
<!-- out_proj_2_2 -->
<g id="node57" class="node">
<title>out_proj_2_2</title>
<path fill="lightcoral" stroke="black" d="M9180,-1102C9180,-1102 8932,-1102 8932,-1102 8926,-1102 8920,-1096 8920,-1090 8920,-1090 8920,-1046 8920,-1046 8920,-1040 8926,-1034 8932,-1034 8932,-1034 9180,-1034 9180,-1034 9186,-1034 9192,-1040 9192,-1046 9192,-1046 9192,-1090 9192,-1090 9192,-1096 9186,-1102 9180,-1102"/>
<text text-anchor="middle" x="9056" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9056" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9056" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="9056" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_2&#45;&gt;out_proj_2_2 -->
<g id="edge96" class="edge">
<title>attn_2_2&#45;&gt;out_proj_2_2</title>
<path fill="none" stroke="black" d="M9096.99,-1138.91C9091.93,-1130.28 9086.15,-1120.41 9080.54,-1110.86"/>
<polygon fill="black" stroke="black" points="9083.56,-1109.08 9075.48,-1102.22 9077.52,-1112.62 9083.56,-1109.08"/>
</g>
<!-- out_proj_2_2&#45;&gt;concat_dim_2 -->
<g id="edge97" class="edge">
<title>out_proj_2_2&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M9002.92,-1033.87C8986.61,-1023.68 8968.72,-1012.52 8952.65,-1002.49"/>
<polygon fill="black" stroke="black" points="8954.26,-999.37 8943.93,-997.05 8950.56,-1005.31 8954.26,-999.37"/>
</g>
<!-- attn_2_3 -->
<g id="node61" class="node">
<title>attn_2_3</title>
<path fill="orange" stroke="black" d="M9984,-1192C9984,-1192 9718,-1192 9718,-1192 9712,-1192 9706,-1186 9706,-1180 9706,-1180 9706,-1151 9706,-1151 9706,-1145 9712,-1139 9718,-1139 9718,-1139 9984,-1139 9984,-1139 9990,-1139 9996,-1145 9996,-1151 9996,-1151 9996,-1180 9996,-1180 9996,-1186 9990,-1192 9984,-1192"/>
<text text-anchor="middle" x="9851" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9851" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9851" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge101" class="edge">
<title>q_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M9756.31,-1228.87C9771.62,-1218.78 9788.4,-1207.73 9803.52,-1197.77"/>
<polygon fill="black" stroke="black" points="9805.79,-1200.47 9812.21,-1192.05 9801.94,-1194.62 9805.79,-1200.47"/>
</g>
<!-- k_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge102" class="edge">
<title>k_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M9945.69,-1228.87C9930.38,-1218.78 9913.6,-1207.73 9898.48,-1197.77"/>
<polygon fill="black" stroke="black" points="9900.06,-1194.62 9889.79,-1192.05 9896.21,-1200.47 9900.06,-1194.62"/>
</g>
<!-- v_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge103" class="edge">
<title>v_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M10149.78,-1230.95C10146.83,-1230.29 10143.9,-1229.64 10141,-1229 10088.67,-1217.41 10030.97,-1204.91 9980.9,-1194.16"/>
<polygon fill="black" stroke="black" points="9981.51,-1190.71 9971,-1192.04 9980.04,-1197.56 9981.51,-1190.71"/>
</g>
<!-- out_proj_2_3 -->
<g id="node62" class="node">
<title>out_proj_2_3</title>
<path fill="lightcoral" stroke="black" d="M9693,-1102C9693,-1102 9445,-1102 9445,-1102 9439,-1102 9433,-1096 9433,-1090 9433,-1090 9433,-1046 9433,-1046 9433,-1040 9439,-1034 9445,-1034 9445,-1034 9693,-1034 9693,-1034 9699,-1034 9705,-1040 9705,-1046 9705,-1046 9705,-1090 9705,-1090 9705,-1096 9699,-1102 9693,-1102"/>
<text text-anchor="middle" x="9569" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9569" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="9569" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9569" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_2_3&#45;&gt;out_proj_2_3 -->
<g id="edge104" class="edge">
<title>attn_2_3&#45;&gt;out_proj_2_3</title>
<path fill="none" stroke="black" d="M9775.43,-1138.91C9744.99,-1128.6 9709.32,-1116.52 9676.28,-1105.33"/>
<polygon fill="black" stroke="black" points="9677.17,-1101.94 9666.58,-1102.04 9674.92,-1108.57 9677.17,-1101.94"/>
</g>
<!-- out_proj_2_3&#45;&gt;concat_dim_2 -->
<g id="edge105" class="edge">
<title>out_proj_2_3&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M9432.62,-1047.44C9320.04,-1031.3 9160.75,-1008.46 9046.31,-992.05"/>
<polygon fill="black" stroke="black" points="9046.47,-988.54 9036.07,-990.58 9045.48,-995.47 9046.47,-988.54"/>
</g>
<!-- attn_3_0 -->
<g id="node66" class="node">
<title>attn_3_0</title>
<path fill="orange" stroke="black" d="M11145,-1192C11145,-1192 10879,-1192 10879,-1192 10873,-1192 10867,-1186 10867,-1180 10867,-1180 10867,-1151 10867,-1151 10867,-1145 10873,-1139 10879,-1139 10879,-1139 11145,-1139 11145,-1139 11151,-1139 11157,-1145 11157,-1151 11157,-1151 11157,-1180 11157,-1180 11157,-1186 11151,-1192 11145,-1192"/>
<text text-anchor="middle" x="11012" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11012" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11012" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge109" class="edge">
<title>q_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M10712.22,-1230.95C10715.17,-1230.29 10718.1,-1229.64 10721,-1229 10773.5,-1217.39 10831.41,-1204.89 10881.64,-1194.14"/>
<polygon fill="black" stroke="black" points="10882.54,-1197.53 10891.58,-1192.02 10881.07,-1190.69 10882.54,-1197.53"/>
</g>
<!-- k_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge110" class="edge">
<title>k_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M10916.65,-1228.87C10932.08,-1218.78 10948.97,-1207.73 10964.2,-1197.77"/>
<polygon fill="black" stroke="black" points="10966.49,-1200.45 10972.95,-1192.05 10962.66,-1194.59 10966.49,-1200.45"/>
</g>
<!-- v_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge111" class="edge">
<title>v_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M11106.04,-1228.87C11090.83,-1218.78 11074.17,-1207.73 11059.15,-1197.77"/>
<polygon fill="black" stroke="black" points="11060.79,-1194.66 11050.52,-1192.05 11056.92,-1200.49 11060.79,-1194.66"/>
</g>
<!-- out_proj_3_0 -->
<g id="node67" class="node">
<title>out_proj_3_0</title>
<path fill="lightcoral" stroke="black" d="M11425,-1102C11425,-1102 11177,-1102 11177,-1102 11171,-1102 11165,-1096 11165,-1090 11165,-1090 11165,-1046 11165,-1046 11165,-1040 11171,-1034 11177,-1034 11177,-1034 11425,-1034 11425,-1034 11431,-1034 11437,-1040 11437,-1046 11437,-1046 11437,-1090 11437,-1090 11437,-1096 11431,-1102 11425,-1102"/>
<text text-anchor="middle" x="11301" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11301" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11301" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11301" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_0&#45;&gt;out_proj_3_0 -->
<g id="edge112" class="edge">
<title>attn_3_0&#45;&gt;out_proj_3_0</title>
<path fill="none" stroke="black" d="M11089.45,-1138.91C11120.78,-1128.55 11157.51,-1116.42 11191.5,-1105.19"/>
<polygon fill="black" stroke="black" points="11192.61,-1108.51 11201,-1102.04 11190.41,-1101.86 11192.61,-1108.51"/>
</g>
<!-- concat_dim_3 -->
<g id="node86" class="node">
<title>concat_dim_3</title>
<path fill="lightpink" stroke="black" d="M11857,-997C11857,-997 11615,-997 11615,-997 11609,-997 11603,-991 11603,-985 11603,-985 11603,-956 11603,-956 11603,-950 11609,-944 11615,-944 11615,-944 11857,-944 11857,-944 11863,-944 11869,-950 11869,-956 11869,-956 11869,-985 11869,-985 11869,-991 11863,-997 11857,-997"/>
<text text-anchor="middle" x="11736" y="-981.8" font-family="Times,serif" font-size="14.00">Concat Dimension Segments</text>
<text text-anchor="middle" x="11736" y="-966.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d=512×h_g=4=2048)</text>
<text text-anchor="middle" x="11736" y="-951.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
</g>
<!-- out_proj_3_0&#45;&gt;concat_dim_3 -->
<g id="edge113" class="edge">
<title>out_proj_3_0&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M11437.15,-1037.11C11492.28,-1025.01 11555.57,-1011.11 11609.66,-999.24"/>
<polygon fill="black" stroke="black" points="11610.64,-1002.61 11619.66,-997.04 11609.14,-995.77 11610.64,-1002.61"/>
</g>
<!-- attn_3_1 -->
<g id="node71" class="node">
<title>attn_3_1</title>
<path fill="orange" stroke="black" d="M11869,-1192C11869,-1192 11603,-1192 11603,-1192 11597,-1192 11591,-1186 11591,-1180 11591,-1180 11591,-1151 11591,-1151 11591,-1145 11597,-1139 11603,-1139 11603,-1139 11869,-1139 11869,-1139 11875,-1139 11881,-1145 11881,-1151 11881,-1151 11881,-1180 11881,-1180 11881,-1186 11875,-1192 11869,-1192"/>
<text text-anchor="middle" x="11736" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="11736" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11736" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge117" class="edge">
<title>q_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M11546.61,-1228.87C11579.82,-1217.93 11616.47,-1205.86 11648.61,-1195.28"/>
<polygon fill="black" stroke="black" points="11650.02,-1198.5 11658.43,-1192.05 11647.84,-1191.85 11650.02,-1198.5"/>
</g>
<!-- k_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge118" class="edge">
<title>k_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M11736,-1228.87C11736,-1220.29 11736,-1211.01 11736,-1202.3"/>
<polygon fill="black" stroke="black" points="11739.5,-1202.05 11736,-1192.05 11732.5,-1202.05 11739.5,-1202.05"/>
</g>
<!-- v_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge119" class="edge">
<title>v_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M11925.39,-1228.87C11892.18,-1217.93 11855.53,-1205.86 11823.39,-1195.28"/>
<polygon fill="black" stroke="black" points="11824.16,-1191.85 11813.57,-1192.05 11821.98,-1198.5 11824.16,-1191.85"/>
</g>
<!-- out_proj_3_1 -->
<g id="node72" class="node">
<title>out_proj_3_1</title>
<path fill="lightcoral" stroke="black" d="M11860,-1102C11860,-1102 11612,-1102 11612,-1102 11606,-1102 11600,-1096 11600,-1090 11600,-1090 11600,-1046 11600,-1046 11600,-1040 11606,-1034 11612,-1034 11612,-1034 11860,-1034 11860,-1034 11866,-1034 11872,-1040 11872,-1046 11872,-1046 11872,-1090 11872,-1090 11872,-1096 11866,-1102 11860,-1102"/>
<text text-anchor="middle" x="11736" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11736" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="11736" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11736" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_1&#45;&gt;out_proj_3_1 -->
<g id="edge120" class="edge">
<title>attn_3_1&#45;&gt;out_proj_3_1</title>
<path fill="none" stroke="black" d="M11736,-1138.91C11736,-1130.72 11736,-1121.41 11736,-1112.32"/>
<polygon fill="black" stroke="black" points="11739.5,-1112.22 11736,-1102.22 11732.5,-1112.22 11739.5,-1112.22"/>
</g>
<!-- out_proj_3_1&#45;&gt;concat_dim_3 -->
<g id="edge121" class="edge">
<title>out_proj_3_1&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M11736,-1033.87C11736,-1025.29 11736,-1016.01 11736,-1007.3"/>
<polygon fill="black" stroke="black" points="11739.5,-1007.05 11736,-997.05 11732.5,-1007.05 11739.5,-1007.05"/>
</g>
<!-- attn_3_2 -->
<g id="node76" class="node">
<title>attn_3_2</title>
<path fill="orange" stroke="black" d="M12562,-1192C12562,-1192 12296,-1192 12296,-1192 12290,-1192 12284,-1186 12284,-1180 12284,-1180 12284,-1151 12284,-1151 12284,-1145 12290,-1139 12296,-1139 12296,-1139 12562,-1139 12562,-1139 12568,-1139 12574,-1145 12574,-1151 12574,-1151 12574,-1180 12574,-1180 12574,-1186 12568,-1192 12562,-1192"/>
<text text-anchor="middle" x="12429" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="12429" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12429" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge125" class="edge">
<title>q_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M12355.2,-1228.87C12366.81,-1219.06 12379.48,-1208.35 12391.01,-1198.61"/>
<polygon fill="black" stroke="black" points="12393.4,-1201.17 12398.77,-1192.05 12388.88,-1195.83 12393.4,-1201.17"/>
</g>
<!-- k_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge126" class="edge">
<title>k_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M12544.59,-1228.87C12525.28,-1218.45 12504.07,-1207 12485.15,-1196.79"/>
<polygon fill="black" stroke="black" points="12486.81,-1193.71 12476.35,-1192.05 12483.48,-1199.87 12486.81,-1193.71"/>
</g>
<!-- v_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge127" class="edge">
<title>v_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M12759.8,-1230.87C12756.84,-1230.24 12753.91,-1229.61 12751,-1229 12693.83,-1216.95 12630.78,-1204.52 12575.73,-1193.95"/>
<polygon fill="black" stroke="black" points="12576.38,-1190.51 12565.9,-1192.07 12575.06,-1197.39 12576.38,-1190.51"/>
</g>
<!-- out_proj_3_2 -->
<g id="node77" class="node">
<title>out_proj_3_2</title>
<path fill="lightcoral" stroke="black" d="M12286,-1102C12286,-1102 12038,-1102 12038,-1102 12032,-1102 12026,-1096 12026,-1090 12026,-1090 12026,-1046 12026,-1046 12026,-1040 12032,-1034 12038,-1034 12038,-1034 12286,-1034 12286,-1034 12292,-1034 12298,-1040 12298,-1046 12298,-1046 12298,-1090 12298,-1090 12298,-1096 12292,-1102 12286,-1102"/>
<text text-anchor="middle" x="12162" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12162" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12162" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12162" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_2&#45;&gt;out_proj_3_2 -->
<g id="edge128" class="edge">
<title>attn_3_2&#45;&gt;out_proj_3_2</title>
<path fill="none" stroke="black" d="M12357.45,-1138.91C12328.75,-1128.64 12295.15,-1116.62 12263.97,-1105.47"/>
<polygon fill="black" stroke="black" points="12264.98,-1102.12 12254.39,-1102.04 12262.62,-1108.71 12264.98,-1102.12"/>
</g>
<!-- out_proj_3_2&#45;&gt;concat_dim_3 -->
<g id="edge129" class="edge">
<title>out_proj_3_2&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M12025.75,-1036.45C11972.46,-1024.51 11911.78,-1010.91 11859.76,-999.24"/>
<polygon fill="black" stroke="black" points="11860.34,-995.79 11849.82,-997.02 11858.81,-1002.62 11860.34,-995.79"/>
</g>
<!-- attn_3_3 -->
<g id="node81" class="node">
<title>attn_3_3</title>
<path fill="orange" stroke="black" d="M13465,-1192C13465,-1192 13199,-1192 13199,-1192 13193,-1192 13187,-1186 13187,-1180 13187,-1180 13187,-1151 13187,-1151 13187,-1145 13193,-1139 13199,-1139 13199,-1139 13465,-1139 13465,-1139 13471,-1139 13477,-1145 13477,-1151 13477,-1151 13477,-1180 13477,-1180 13477,-1186 13471,-1192 13465,-1192"/>
<text text-anchor="middle" x="13332" y="-1176.8" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="13332" y="-1161.8" font-family="Times,serif" font-size="14.00">(B=1024, L, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="13332" y="-1146.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge133" class="edge">
<title>q_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M13236.65,-1228.87C13252.08,-1218.78 13268.97,-1207.73 13284.2,-1197.77"/>
<polygon fill="black" stroke="black" points="13286.49,-1200.45 13292.95,-1192.05 13282.66,-1194.59 13286.49,-1200.45"/>
</g>
<!-- k_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge134" class="edge">
<title>k_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M13426.04,-1228.87C13410.83,-1218.78 13394.17,-1207.73 13379.15,-1197.77"/>
<polygon fill="black" stroke="black" points="13380.79,-1194.66 13370.52,-1192.05 13376.92,-1200.49 13380.79,-1194.66"/>
</g>
<!-- v_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge135" class="edge">
<title>v_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M13629.78,-1230.95C13626.83,-1230.3 13623.9,-1229.64 13621,-1229 13568.85,-1217.43 13511.34,-1204.94 13461.45,-1194.18"/>
<polygon fill="black" stroke="black" points="13462.09,-1190.74 13451.58,-1192.06 13460.62,-1197.58 13462.09,-1190.74"/>
</g>
<!-- out_proj_3_3 -->
<g id="node82" class="node">
<title>out_proj_3_3</title>
<path fill="lightcoral" stroke="black" d="M12956,-1102C12956,-1102 12708,-1102 12708,-1102 12702,-1102 12696,-1096 12696,-1090 12696,-1090 12696,-1046 12696,-1046 12696,-1040 12702,-1034 12708,-1034 12708,-1034 12956,-1034 12956,-1034 12962,-1034 12968,-1040 12968,-1046 12968,-1046 12968,-1090 12968,-1090 12968,-1096 12962,-1102 12956,-1102"/>
<text text-anchor="middle" x="12832" y="-1086.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12832" y="-1071.8" font-family="Times,serif" font-size="14.00">(B=1024, L, d_s=128×h_g=4=512)</text>
<text text-anchor="middle" x="12832" y="-1056.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12832" y="-1041.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- attn_3_3&#45;&gt;out_proj_3_3 -->
<g id="edge136" class="edge">
<title>attn_3_3&#45;&gt;out_proj_3_3</title>
<path fill="none" stroke="black" d="M13198.34,-1138.97C13130.51,-1126.02 13047.98,-1110.25 12978.44,-1096.97"/>
<polygon fill="black" stroke="black" points="12978.75,-1093.47 12968.27,-1095.03 12977.44,-1100.34 12978.75,-1093.47"/>
</g>
<!-- out_proj_3_3&#45;&gt;concat_dim_3 -->
<g id="edge137" class="edge">
<title>out_proj_3_3&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M12695.96,-1055.15C12487.72,-1037 12091.79,-1002.5 11879.29,-983.99"/>
<polygon fill="black" stroke="black" points="11879.58,-980.5 11869.32,-983.12 11878.97,-987.47 11879.58,-980.5"/>
</g>
<!-- concat_heads -->
<g id="node87" class="node">
<title>concat_heads</title>
<path fill="lightpink" stroke="black" d="M8977,-907C8977,-907 8829,-907 8829,-907 8823,-907 8817,-901 8817,-895 8817,-895 8817,-866 8817,-866 8817,-860 8823,-854 8829,-854 8829,-854 8977,-854 8977,-854 8983,-854 8989,-860 8989,-866 8989,-866 8989,-895 8989,-895 8989,-901 8983,-907 8977,-907"/>
<text text-anchor="middle" x="8903" y="-891.8" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="8903" y="-876.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="8903" y="-861.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0&#45;&gt;concat_heads -->
<g id="edge138" class="edge">
<title>concat_dim_0&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M2299.06,-967.76C3171.13,-956.37 8057.6,-892.54 8806.65,-882.76"/>
<polygon fill="black" stroke="black" points="8806.9,-886.26 8816.85,-882.63 8806.81,-879.26 8806.9,-886.26"/>
</g>
<!-- concat_dim_1&#45;&gt;concat_heads -->
<g id="edge139" class="edge">
<title>concat_dim_1&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M5779.24,-965.9C6319.57,-951.3 8340.75,-896.69 8806.74,-884.1"/>
<polygon fill="black" stroke="black" points="8806.9,-887.6 8816.8,-883.83 8806.71,-880.6 8806.9,-887.6"/>
</g>
<!-- concat_dim_2&#45;&gt;concat_heads -->
<g id="edge140" class="edge">
<title>concat_dim_2&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M8903,-943.57C8903,-935.34 8903,-926.08 8903,-917.28"/>
<polygon fill="black" stroke="black" points="8906.5,-917.24 8903,-907.24 8899.5,-917.24 8906.5,-917.24"/>
</g>
<!-- concat_dim_3&#45;&gt;concat_heads -->
<g id="edge141" class="edge">
<title>concat_dim_3&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M11602.69,-965.36C11113.2,-950.15 9421.62,-897.61 8999.18,-884.49"/>
<polygon fill="black" stroke="black" points="8999.24,-880.99 8989.14,-884.18 8999.02,-887.98 8999.24,-880.99"/>
</g>
<!-- concat_heads&#45;&gt;residual1 -->
<g id="edge142" class="edge">
<title>concat_heads&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M8989.22,-876.61C9383.88,-863.38 11016.64,-808.64 11431.7,-794.73"/>
<polygon fill="black" stroke="black" points="11431.98,-798.22 11441.86,-794.39 11431.75,-791.22 11431.98,-798.22"/>
</g>
<!-- ln2 -->
<g id="node89" class="node">
<title>ln2</title>
<path fill="lightgreen" stroke="black" d="M10509,-727C10509,-727 10361,-727 10361,-727 10355,-727 10349,-721 10349,-715 10349,-715 10349,-686 10349,-686 10349,-680 10355,-674 10361,-674 10361,-674 10509,-674 10509,-674 10515,-674 10521,-680 10521,-686 10521,-686 10521,-715 10521,-715 10521,-721 10515,-727 10509,-727"/>
<text text-anchor="middle" x="10435" y="-711.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="10435" y="-696.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="10435" y="-681.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;ln2 -->
<g id="edge144" class="edge">
<title>residual1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M11441.78,-782.56C11240.66,-766.37 10741.66,-726.19 10531.14,-709.24"/>
<polygon fill="black" stroke="black" points="10531.28,-705.74 10521.03,-708.43 10530.71,-712.72 10531.28,-705.74"/>
</g>
<!-- residual2 -->
<g id="node156" class="node">
<title>residual2</title>
<path fill="lightgray" stroke="black" d="M11765,-143C11765,-143 11617,-143 11617,-143 11611,-143 11605,-137 11605,-131 11605,-131 11605,-102 11605,-102 11605,-96 11611,-90 11617,-90 11617,-90 11765,-90 11765,-90 11771,-90 11777,-96 11777,-102 11777,-102 11777,-131 11777,-131 11777,-137 11771,-143 11765,-143"/>
<text text-anchor="middle" x="11691" y="-127.8" font-family="Times,serif" font-size="14.00">Add &amp; Residual</text>
<text text-anchor="middle" x="11691" y="-112.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="11691" y="-97.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;residual2 -->
<g id="edge219" class="edge">
<title>residual1&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M11614.21,-786.75C11864.9,-778.18 12576,-749.63 12576,-701.5 12576,-701.5 12576,-701.5 12576,-205.5 12576,-126.95 12016.78,-117.67 11787.4,-117.17"/>
<polygon fill="black" stroke="black" points="11787.07,-113.67 11777.06,-117.16 11787.06,-120.67 11787.07,-113.67"/>
</g>
<!-- gate -->
<g id="node90" class="node">
<title>gate</title>
<path fill="purple" stroke="black" d="M8023,-629.5C8023,-629.5 7867,-629.5 7867,-629.5 7861,-629.5 7855,-623.5 7855,-617.5 7855,-617.5 7855,-588.5 7855,-588.5 7855,-582.5 7861,-576.5 7867,-576.5 7867,-576.5 8023,-576.5 8023,-576.5 8029,-576.5 8035,-582.5 8035,-588.5 8035,-588.5 8035,-617.5 8035,-617.5 8035,-623.5 8029,-629.5 8023,-629.5"/>
<text text-anchor="middle" x="7945" y="-614.3" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="7945" y="-599.3" font-family="Times,serif" font-size="14.00">(B=1024, L, 8 experts)</text>
<text text-anchor="middle" x="7945" y="-584.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln2&#45;&gt;gate -->
<g id="edge145" class="edge">
<title>ln2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M10348.88,-697.82C10096.93,-692.8 9339.39,-676.96 8711,-656 8507.38,-649.21 8456.17,-652.08 8253,-637 8183.54,-631.84 8105.54,-623.46 8045.41,-616.43"/>
<polygon fill="black" stroke="black" points="8045.5,-612.92 8035.16,-615.23 8044.68,-619.87 8045.5,-612.92"/>
</g>
<!-- expert_0_fc1_0 -->
<g id="node99" class="node">
<title>expert_0_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M8500.5,-637C8500.5,-637 8273.5,-637 8273.5,-637 8267.5,-637 8261.5,-631 8261.5,-625 8261.5,-625 8261.5,-581 8261.5,-581 8261.5,-575 8267.5,-569 8273.5,-569 8273.5,-569 8500.5,-569 8500.5,-569 8506.5,-569 8512.5,-575 8512.5,-581 8512.5,-581 8512.5,-625 8512.5,-625 8512.5,-631 8506.5,-637 8500.5,-637"/>
<text text-anchor="middle" x="8387" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="8387" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="8387" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8387" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_0_fc1_0 -->
<g id="edge146" class="edge">
<title>ln2&#45;&gt;expert_0_fc1_0</title>
<path fill="none" stroke="black" d="M10348.98,-699.06C10028.38,-697.03 8902.42,-686.58 8522.52,-636.93"/>
<polygon fill="black" stroke="black" points="8522.97,-633.46 8512.59,-635.6 8522.04,-640.4 8522.97,-633.46"/>
</g>
<!-- expert_0_fc1_1 -->
<g id="node100" class="node">
<title>expert_0_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M8769.5,-637C8769.5,-637 8542.5,-637 8542.5,-637 8536.5,-637 8530.5,-631 8530.5,-625 8530.5,-625 8530.5,-581 8530.5,-581 8530.5,-575 8536.5,-569 8542.5,-569 8542.5,-569 8769.5,-569 8769.5,-569 8775.5,-569 8781.5,-575 8781.5,-581 8781.5,-581 8781.5,-625 8781.5,-625 8781.5,-631 8775.5,-637 8769.5,-637"/>
<text text-anchor="middle" x="8656" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 0 FC1</text>
<text text-anchor="middle" x="8656" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="8656" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="8656" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_0_fc1_1 -->
<g id="edge147" class="edge">
<title>ln2&#45;&gt;expert_0_fc1_1</title>
<path fill="none" stroke="black" d="M10348.76,-696.5C10152.69,-689.66 9658.41,-672.21 9245,-656 9046.45,-648.22 8992.68,-664.79 8791.6,-636.97"/>
<polygon fill="black" stroke="black" points="8791.99,-633.49 8781.6,-635.56 8791.01,-640.42 8791.99,-633.49"/>
</g>
<!-- expert_1_fc1_0 -->
<g id="node106" class="node">
<title>expert_1_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M9038.5,-637C9038.5,-637 8811.5,-637 8811.5,-637 8805.5,-637 8799.5,-631 8799.5,-625 8799.5,-625 8799.5,-581 8799.5,-581 8799.5,-575 8805.5,-569 8811.5,-569 8811.5,-569 9038.5,-569 9038.5,-569 9044.5,-569 9050.5,-575 9050.5,-581 9050.5,-581 9050.5,-625 9050.5,-625 9050.5,-631 9044.5,-637 9038.5,-637"/>
<text text-anchor="middle" x="8925" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="8925" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="8925" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8925" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_1_fc1_0 -->
<g id="edge155" class="edge">
<title>ln2&#45;&gt;expert_1_fc1_0</title>
<path fill="none" stroke="black" d="M10348.86,-697.79C10091.53,-692.34 9330.22,-673.62 9060.75,-636.97"/>
<polygon fill="black" stroke="black" points="9060.99,-633.47 9050.6,-635.54 9060.02,-640.4 9060.99,-633.47"/>
</g>
<!-- expert_1_fc1_1 -->
<g id="node107" class="node">
<title>expert_1_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M9307.5,-637C9307.5,-637 9080.5,-637 9080.5,-637 9074.5,-637 9068.5,-631 9068.5,-625 9068.5,-625 9068.5,-581 9068.5,-581 9068.5,-575 9074.5,-569 9080.5,-569 9080.5,-569 9307.5,-569 9307.5,-569 9313.5,-569 9319.5,-575 9319.5,-581 9319.5,-581 9319.5,-625 9319.5,-625 9319.5,-631 9313.5,-637 9307.5,-637"/>
<text text-anchor="middle" x="9194" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 1 FC1</text>
<text text-anchor="middle" x="9194" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="9194" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9194" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_1_fc1_1 -->
<g id="edge156" class="edge">
<title>ln2&#45;&gt;expert_1_fc1_1</title>
<path fill="none" stroke="black" d="M10348.76,-699.98C10163.45,-699.86 9713.64,-693.34 9329.52,-636.97"/>
<polygon fill="black" stroke="black" points="9330.01,-633.51 9319.61,-635.5 9328.98,-640.43 9330.01,-633.51"/>
</g>
<!-- expert_2_fc1_0 -->
<g id="node113" class="node">
<title>expert_2_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M9576.5,-637C9576.5,-637 9349.5,-637 9349.5,-637 9343.5,-637 9337.5,-631 9337.5,-625 9337.5,-625 9337.5,-581 9337.5,-581 9337.5,-575 9343.5,-569 9349.5,-569 9349.5,-569 9576.5,-569 9576.5,-569 9582.5,-569 9588.5,-575 9588.5,-581 9588.5,-581 9588.5,-625 9588.5,-625 9588.5,-631 9582.5,-637 9576.5,-637"/>
<text text-anchor="middle" x="9463" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="9463" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="9463" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="9463" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_2_fc1_0 -->
<g id="edge164" class="edge">
<title>ln2&#45;&gt;expert_2_fc1_0</title>
<path fill="none" stroke="black" d="M10348.91,-697.75C10198.38,-693.67 9877.64,-680.41 9598.53,-636.98"/>
<polygon fill="black" stroke="black" points="9599.04,-633.52 9588.62,-635.43 9597.95,-640.44 9599.04,-633.52"/>
</g>
<!-- expert_2_fc1_1 -->
<g id="node114" class="node">
<title>expert_2_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M9845.5,-637C9845.5,-637 9618.5,-637 9618.5,-637 9612.5,-637 9606.5,-631 9606.5,-625 9606.5,-625 9606.5,-581 9606.5,-581 9606.5,-575 9612.5,-569 9618.5,-569 9618.5,-569 9845.5,-569 9845.5,-569 9851.5,-569 9857.5,-575 9857.5,-581 9857.5,-581 9857.5,-625 9857.5,-625 9857.5,-631 9851.5,-637 9845.5,-637"/>
<text text-anchor="middle" x="9732" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 2 FC1</text>
<text text-anchor="middle" x="9732" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="9732" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9732" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_2_fc1_1 -->
<g id="edge165" class="edge">
<title>ln2&#45;&gt;expert_2_fc1_1</title>
<path fill="none" stroke="black" d="M10348.86,-693.53C10239.22,-685.15 10043.92,-667.58 9867.62,-637.03"/>
<polygon fill="black" stroke="black" points="9868.1,-633.56 9857.64,-635.28 9866.89,-640.45 9868.1,-633.56"/>
</g>
<!-- expert_3_fc1_0 -->
<g id="node120" class="node">
<title>expert_3_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M10114.5,-637C10114.5,-637 9887.5,-637 9887.5,-637 9881.5,-637 9875.5,-631 9875.5,-625 9875.5,-625 9875.5,-581 9875.5,-581 9875.5,-575 9881.5,-569 9887.5,-569 9887.5,-569 10114.5,-569 10114.5,-569 10120.5,-569 10126.5,-575 10126.5,-581 10126.5,-581 10126.5,-625 10126.5,-625 10126.5,-631 10120.5,-637 10114.5,-637"/>
<text text-anchor="middle" x="10001" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="10001" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="10001" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10001" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_3_fc1_0 -->
<g id="edge173" class="edge">
<title>ln2&#45;&gt;expert_3_fc1_0</title>
<path fill="none" stroke="black" d="M10348.8,-682.28C10291.43,-670.64 10214.15,-654.59 10136.66,-637.13"/>
<polygon fill="black" stroke="black" points="10137.25,-633.67 10126.72,-634.88 10135.7,-640.5 10137.25,-633.67"/>
</g>
<!-- expert_3_fc1_1 -->
<g id="node121" class="node">
<title>expert_3_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M10383.5,-637C10383.5,-637 10156.5,-637 10156.5,-637 10150.5,-637 10144.5,-631 10144.5,-625 10144.5,-625 10144.5,-581 10144.5,-581 10144.5,-575 10150.5,-569 10156.5,-569 10156.5,-569 10383.5,-569 10383.5,-569 10389.5,-569 10395.5,-575 10395.5,-581 10395.5,-581 10395.5,-625 10395.5,-625 10395.5,-631 10389.5,-637 10383.5,-637"/>
<text text-anchor="middle" x="10270" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 3 FC1</text>
<text text-anchor="middle" x="10270" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="10270" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10270" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_3_fc1_1 -->
<g id="edge174" class="edge">
<title>ln2&#45;&gt;expert_3_fc1_1</title>
<path fill="none" stroke="black" d="M10390.78,-673.91C10373.89,-664.13 10354.24,-652.76 10335.77,-642.07"/>
<polygon fill="black" stroke="black" points="10337.5,-639.02 10327.09,-637.04 10333.99,-645.08 10337.5,-639.02"/>
</g>
<!-- expert_4_fc1_0 -->
<g id="node127" class="node">
<title>expert_4_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M10652.5,-637C10652.5,-637 10425.5,-637 10425.5,-637 10419.5,-637 10413.5,-631 10413.5,-625 10413.5,-625 10413.5,-581 10413.5,-581 10413.5,-575 10419.5,-569 10425.5,-569 10425.5,-569 10652.5,-569 10652.5,-569 10658.5,-569 10664.5,-575 10664.5,-581 10664.5,-581 10664.5,-625 10664.5,-625 10664.5,-631 10658.5,-637 10652.5,-637"/>
<text text-anchor="middle" x="10539" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="10539" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="10539" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10539" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_4_fc1_0 -->
<g id="edge182" class="edge">
<title>ln2&#45;&gt;expert_4_fc1_0</title>
<path fill="none" stroke="black" d="M10462.87,-673.91C10472.84,-664.75 10484.34,-654.2 10495.32,-644.11"/>
<polygon fill="black" stroke="black" points="10497.82,-646.56 10502.82,-637.22 10493.09,-641.41 10497.82,-646.56"/>
</g>
<!-- expert_4_fc1_1 -->
<g id="node128" class="node">
<title>expert_4_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M10921.5,-637C10921.5,-637 10694.5,-637 10694.5,-637 10688.5,-637 10682.5,-631 10682.5,-625 10682.5,-625 10682.5,-581 10682.5,-581 10682.5,-575 10688.5,-569 10694.5,-569 10694.5,-569 10921.5,-569 10921.5,-569 10927.5,-569 10933.5,-575 10933.5,-581 10933.5,-581 10933.5,-625 10933.5,-625 10933.5,-631 10927.5,-637 10921.5,-637"/>
<text text-anchor="middle" x="10808" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 4 FC1</text>
<text text-anchor="middle" x="10808" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="10808" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10808" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_4_fc1_1 -->
<g id="edge183" class="edge">
<title>ln2&#45;&gt;expert_4_fc1_1</title>
<path fill="none" stroke="black" d="M10521.04,-677.47C10566.01,-665.96 10622.09,-651.6 10672.72,-638.64"/>
<polygon fill="black" stroke="black" points="10673.61,-642.02 10682.43,-636.15 10671.88,-635.24 10673.61,-642.02"/>
</g>
<!-- expert_5_fc1_0 -->
<g id="node134" class="node">
<title>expert_5_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M11190.5,-637C11190.5,-637 10963.5,-637 10963.5,-637 10957.5,-637 10951.5,-631 10951.5,-625 10951.5,-625 10951.5,-581 10951.5,-581 10951.5,-575 10957.5,-569 10963.5,-569 10963.5,-569 11190.5,-569 11190.5,-569 11196.5,-569 11202.5,-575 11202.5,-581 11202.5,-581 11202.5,-625 11202.5,-625 11202.5,-631 11196.5,-637 11190.5,-637"/>
<text text-anchor="middle" x="11077" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="11077" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="11077" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11077" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_5_fc1_0 -->
<g id="edge191" class="edge">
<title>ln2&#45;&gt;expert_5_fc1_0</title>
<path fill="none" stroke="black" d="M10521.31,-692.04C10620.59,-682.75 10788.55,-664.84 10941.17,-637.27"/>
<polygon fill="black" stroke="black" points="10941.99,-640.68 10951.2,-635.44 10940.74,-633.79 10941.99,-640.68"/>
</g>
<!-- expert_5_fc1_1 -->
<g id="node135" class="node">
<title>expert_5_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M11459.5,-637C11459.5,-637 11232.5,-637 11232.5,-637 11226.5,-637 11220.5,-631 11220.5,-625 11220.5,-625 11220.5,-581 11220.5,-581 11220.5,-575 11226.5,-569 11232.5,-569 11232.5,-569 11459.5,-569 11459.5,-569 11465.5,-569 11471.5,-575 11471.5,-581 11471.5,-581 11471.5,-625 11471.5,-625 11471.5,-631 11465.5,-637 11459.5,-637"/>
<text text-anchor="middle" x="11346" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 5 FC1</text>
<text text-anchor="middle" x="11346" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="11346" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="11346" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_5_fc1_1 -->
<g id="edge192" class="edge">
<title>ln2&#45;&gt;expert_5_fc1_1</title>
<path fill="none" stroke="black" d="M10521.2,-697.1C10663.25,-692.15 10955.37,-677.76 11210.04,-637.24"/>
<polygon fill="black" stroke="black" points="11210.91,-640.64 11220.23,-635.6 11209.8,-633.73 11210.91,-640.64"/>
</g>
<!-- expert_6_fc1_0 -->
<g id="node141" class="node">
<title>expert_6_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M11728.5,-637C11728.5,-637 11501.5,-637 11501.5,-637 11495.5,-637 11489.5,-631 11489.5,-625 11489.5,-625 11489.5,-581 11489.5,-581 11489.5,-575 11495.5,-569 11501.5,-569 11501.5,-569 11728.5,-569 11728.5,-569 11734.5,-569 11740.5,-575 11740.5,-581 11740.5,-581 11740.5,-625 11740.5,-625 11740.5,-631 11734.5,-637 11728.5,-637"/>
<text text-anchor="middle" x="11615" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="11615" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="11615" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11615" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_6_fc1_0 -->
<g id="edge200" class="edge">
<title>ln2&#45;&gt;expert_6_fc1_0</title>
<path fill="none" stroke="black" d="M10521.31,-699.63C10699.31,-698.75 11119.9,-690.74 11479.17,-637.19"/>
<polygon fill="black" stroke="black" points="11479.87,-640.62 11489.24,-635.68 11478.83,-633.7 11479.87,-640.62"/>
</g>
<!-- expert_6_fc1_1 -->
<g id="node142" class="node">
<title>expert_6_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M11997.5,-637C11997.5,-637 11770.5,-637 11770.5,-637 11764.5,-637 11758.5,-631 11758.5,-625 11758.5,-625 11758.5,-581 11758.5,-581 11758.5,-575 11764.5,-569 11770.5,-569 11770.5,-569 11997.5,-569 11997.5,-569 12003.5,-569 12009.5,-575 12009.5,-581 12009.5,-581 12009.5,-625 12009.5,-625 12009.5,-631 12003.5,-637 11997.5,-637"/>
<text text-anchor="middle" x="11884" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 6 FC1</text>
<text text-anchor="middle" x="11884" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="11884" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11884" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_6_fc1_1 -->
<g id="edge201" class="edge">
<title>ln2&#45;&gt;expert_6_fc1_1</title>
<path fill="none" stroke="black" d="M10521.39,-697.59C10771.2,-691.71 11492.32,-672.24 11748.24,-637.13"/>
<polygon fill="black" stroke="black" points="11748.84,-640.59 11758.25,-635.72 11747.86,-633.65 11748.84,-640.59"/>
</g>
<!-- expert_7_fc1_0 -->
<g id="node148" class="node">
<title>expert_7_fc1_0</title>
<path fill="lightsteelblue" stroke="black" d="M12266.5,-637C12266.5,-637 12039.5,-637 12039.5,-637 12033.5,-637 12027.5,-631 12027.5,-625 12027.5,-625 12027.5,-581 12027.5,-581 12027.5,-575 12033.5,-569 12039.5,-569 12039.5,-569 12266.5,-569 12266.5,-569 12272.5,-569 12278.5,-575 12278.5,-581 12278.5,-581 12278.5,-625 12278.5,-625 12278.5,-631 12272.5,-637 12266.5,-637"/>
<text text-anchor="middle" x="12153" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="12153" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="12153" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12153" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_7_fc1_0 -->
<g id="edge209" class="edge">
<title>ln2&#45;&gt;expert_7_fc1_0</title>
<path fill="none" stroke="black" d="M10521.17,-696.35C10711.36,-689.36 11181.43,-671.93 11575,-656 11769.08,-648.14 11821.74,-664.42 12017.23,-637.16"/>
<polygon fill="black" stroke="black" points="12017.84,-640.6 12027.25,-635.74 12016.86,-633.67 12017.84,-640.6"/>
</g>
<!-- expert_7_fc1_1 -->
<g id="node149" class="node">
<title>expert_7_fc1_1</title>
<path fill="lightsteelblue" stroke="black" d="M12535.5,-637C12535.5,-637 12308.5,-637 12308.5,-637 12302.5,-637 12296.5,-631 12296.5,-625 12296.5,-625 12296.5,-581 12296.5,-581 12296.5,-575 12302.5,-569 12308.5,-569 12308.5,-569 12535.5,-569 12535.5,-569 12541.5,-569 12547.5,-575 12547.5,-581 12547.5,-581 12547.5,-625 12547.5,-625 12547.5,-631 12541.5,-637 12535.5,-637"/>
<text text-anchor="middle" x="12422" y="-621.8" font-family="Times,serif" font-size="14.00">Expert 7 FC1</text>
<text text-anchor="middle" x="12422" y="-606.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 32768/2=16384)</text>
<text text-anchor="middle" x="12422" y="-591.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12422" y="-576.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;expert_7_fc1_1 -->
<g id="edge210" class="edge">
<title>ln2&#45;&gt;expert_7_fc1_1</title>
<path fill="none" stroke="black" d="M10521.03,-698.97C10835.01,-696.66 11919.58,-685.4 12286.15,-637.14"/>
<polygon fill="black" stroke="black" points="12286.81,-640.58 12296.26,-635.77 12285.88,-633.64 12286.81,-640.58"/>
</g>
<!-- expert_0 -->
<g id="node91" class="node">
<title>expert_0</title>
<path fill="none" stroke="black" d="M7516.5,-509.5C7516.5,-509.5 7461.5,-509.5 7461.5,-509.5 7455.5,-509.5 7449.5,-503.5 7449.5,-497.5 7449.5,-497.5 7449.5,-485.5 7449.5,-485.5 7449.5,-479.5 7455.5,-473.5 7461.5,-473.5 7461.5,-473.5 7516.5,-473.5 7516.5,-473.5 7522.5,-473.5 7528.5,-479.5 7528.5,-485.5 7528.5,-485.5 7528.5,-497.5 7528.5,-497.5 7528.5,-503.5 7522.5,-509.5 7516.5,-509.5"/>
<text text-anchor="middle" x="7489" y="-487.8" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate&#45;&gt;expert_0 -->
<g id="edge1" class="edge">
<title>gate&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7854.71,-599.67C7748.82,-595.44 7581.01,-583.67 7528,-551 7515.78,-543.47 7506.56,-530.52 7500.16,-518.71"/>
<polygon fill="black" stroke="black" points="7503.22,-517.01 7495.63,-509.62 7496.96,-520.13 7503.22,-517.01"/>
<text text-anchor="middle" x="7573.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_1 -->
<g id="node92" class="node">
<title>expert_1</title>
<path fill="none" stroke="black" d="M7630.5,-509.5C7630.5,-509.5 7575.5,-509.5 7575.5,-509.5 7569.5,-509.5 7563.5,-503.5 7563.5,-497.5 7563.5,-497.5 7563.5,-485.5 7563.5,-485.5 7563.5,-479.5 7569.5,-473.5 7575.5,-473.5 7575.5,-473.5 7630.5,-473.5 7630.5,-473.5 7636.5,-473.5 7642.5,-479.5 7642.5,-485.5 7642.5,-485.5 7642.5,-497.5 7642.5,-497.5 7642.5,-503.5 7636.5,-509.5 7630.5,-509.5"/>
<text text-anchor="middle" x="7603" y="-487.8" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate&#45;&gt;expert_1 -->
<g id="edge2" class="edge">
<title>gate&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7854.75,-595.39C7777.17,-588.21 7672.49,-574.5 7638,-551 7626.69,-543.29 7618.46,-530.62 7612.83,-519.03"/>
<polygon fill="black" stroke="black" points="7615.94,-517.42 7608.7,-509.68 7609.54,-520.25 7615.94,-517.42"/>
<text text-anchor="middle" x="7683.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_2 -->
<g id="node93" class="node">
<title>expert_2</title>
<path fill="none" stroke="black" d="M7744.5,-509.5C7744.5,-509.5 7689.5,-509.5 7689.5,-509.5 7683.5,-509.5 7677.5,-503.5 7677.5,-497.5 7677.5,-497.5 7677.5,-485.5 7677.5,-485.5 7677.5,-479.5 7683.5,-473.5 7689.5,-473.5 7689.5,-473.5 7744.5,-473.5 7744.5,-473.5 7750.5,-473.5 7756.5,-479.5 7756.5,-485.5 7756.5,-485.5 7756.5,-497.5 7756.5,-497.5 7756.5,-503.5 7750.5,-509.5 7744.5,-509.5"/>
<text text-anchor="middle" x="7717" y="-487.8" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate&#45;&gt;expert_2 -->
<g id="edge3" class="edge">
<title>gate&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7854.9,-595.34C7817.89,-588.7 7776.63,-575.8 7746,-551 7735.98,-542.89 7729.15,-530.44 7724.64,-519.11"/>
<polygon fill="black" stroke="black" points="7727.9,-517.83 7721.25,-509.58 7721.3,-520.18 7727.9,-517.83"/>
<text text-anchor="middle" x="7791.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_3 -->
<g id="node94" class="node">
<title>expert_3</title>
<path fill="none" stroke="black" d="M7858.5,-509.5C7858.5,-509.5 7803.5,-509.5 7803.5,-509.5 7797.5,-509.5 7791.5,-503.5 7791.5,-497.5 7791.5,-497.5 7791.5,-485.5 7791.5,-485.5 7791.5,-479.5 7797.5,-473.5 7803.5,-473.5 7803.5,-473.5 7858.5,-473.5 7858.5,-473.5 7864.5,-473.5 7870.5,-479.5 7870.5,-485.5 7870.5,-485.5 7870.5,-497.5 7870.5,-497.5 7870.5,-503.5 7864.5,-509.5 7858.5,-509.5"/>
<text text-anchor="middle" x="7831" y="-487.8" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate&#45;&gt;expert_3 -->
<g id="edge4" class="edge">
<title>gate&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7880.73,-576.28C7869.31,-569.42 7858.4,-561.06 7850,-551 7842.53,-542.06 7837.97,-530.11 7835.21,-519.34"/>
<polygon fill="black" stroke="black" points="7838.62,-518.54 7833.07,-509.52 7831.78,-520.03 7838.62,-518.54"/>
<text text-anchor="middle" x="7895.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_4 -->
<g id="node95" class="node">
<title>expert_4</title>
<path fill="none" stroke="black" d="M7972.5,-509.5C7972.5,-509.5 7917.5,-509.5 7917.5,-509.5 7911.5,-509.5 7905.5,-503.5 7905.5,-497.5 7905.5,-497.5 7905.5,-485.5 7905.5,-485.5 7905.5,-479.5 7911.5,-473.5 7917.5,-473.5 7917.5,-473.5 7972.5,-473.5 7972.5,-473.5 7978.5,-473.5 7984.5,-479.5 7984.5,-485.5 7984.5,-485.5 7984.5,-497.5 7984.5,-497.5 7984.5,-503.5 7978.5,-509.5 7972.5,-509.5"/>
<text text-anchor="middle" x="7945" y="-487.8" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate&#45;&gt;expert_4 -->
<g id="edge5" class="edge">
<title>gate&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7945,-576.33C7945,-559.37 7945,-537.16 7945,-519.87"/>
<polygon fill="black" stroke="black" points="7948.5,-519.82 7945,-509.82 7941.5,-519.82 7948.5,-519.82"/>
<text text-anchor="middle" x="7990.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_5 -->
<g id="node96" class="node">
<title>expert_5</title>
<path fill="none" stroke="black" d="M8086.5,-509.5C8086.5,-509.5 8031.5,-509.5 8031.5,-509.5 8025.5,-509.5 8019.5,-503.5 8019.5,-497.5 8019.5,-497.5 8019.5,-485.5 8019.5,-485.5 8019.5,-479.5 8025.5,-473.5 8031.5,-473.5 8031.5,-473.5 8086.5,-473.5 8086.5,-473.5 8092.5,-473.5 8098.5,-479.5 8098.5,-485.5 8098.5,-485.5 8098.5,-497.5 8098.5,-497.5 8098.5,-503.5 8092.5,-509.5 8086.5,-509.5"/>
<text text-anchor="middle" x="8059" y="-487.8" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate&#45;&gt;expert_5 -->
<g id="edge6" class="edge">
<title>gate&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8005.94,-576.26C8017.37,-569.34 8028.41,-560.95 8037,-551 8044.74,-542.04 8049.88,-530.09 8053.23,-519.32"/>
<polygon fill="black" stroke="black" points="8056.65,-520.07 8055.91,-509.5 8049.9,-518.22 8056.65,-520.07"/>
<text text-anchor="middle" x="8091.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_6 -->
<g id="node97" class="node">
<title>expert_6</title>
<path fill="none" stroke="black" d="M8200.5,-509.5C8200.5,-509.5 8145.5,-509.5 8145.5,-509.5 8139.5,-509.5 8133.5,-503.5 8133.5,-497.5 8133.5,-497.5 8133.5,-485.5 8133.5,-485.5 8133.5,-479.5 8139.5,-473.5 8145.5,-473.5 8145.5,-473.5 8200.5,-473.5 8200.5,-473.5 8206.5,-473.5 8212.5,-479.5 8212.5,-485.5 8212.5,-485.5 8212.5,-497.5 8212.5,-497.5 8212.5,-503.5 8206.5,-509.5 8200.5,-509.5"/>
<text text-anchor="middle" x="8173" y="-487.8" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate&#45;&gt;expert_6 -->
<g id="edge7" class="edge">
<title>gate&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8035.26,-594.08C8071.13,-587.2 8110.92,-574.46 8141,-551 8151.38,-542.91 8158.85,-530.46 8163.95,-519.13"/>
<polygon fill="black" stroke="black" points="8167.3,-520.17 8167.83,-509.59 8160.82,-517.53 8167.3,-520.17"/>
<text text-anchor="middle" x="8199.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_7 -->
<g id="node98" class="node">
<title>expert_7</title>
<path fill="none" stroke="black" d="M8314.5,-509.5C8314.5,-509.5 8259.5,-509.5 8259.5,-509.5 8253.5,-509.5 8247.5,-503.5 8247.5,-497.5 8247.5,-497.5 8247.5,-485.5 8247.5,-485.5 8247.5,-479.5 8253.5,-473.5 8259.5,-473.5 8259.5,-473.5 8314.5,-473.5 8314.5,-473.5 8320.5,-473.5 8326.5,-479.5 8326.5,-485.5 8326.5,-485.5 8326.5,-497.5 8326.5,-497.5 8326.5,-503.5 8320.5,-509.5 8314.5,-509.5"/>
<text text-anchor="middle" x="8287" y="-487.8" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- gate&#45;&gt;expert_7 -->
<g id="edge8" class="edge">
<title>gate&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8035.29,-594.89C8111.87,-587.42 8214.6,-573.56 8249,-551 8260.83,-543.24 8269.77,-530.39 8276,-518.7"/>
<polygon fill="black" stroke="black" points="8279.16,-520.22 8280.42,-509.7 8272.87,-517.14 8279.16,-520.22"/>
<text text-anchor="middle" x="8309.5" y="-539.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_0_gelu_0 -->
<g id="node101" class="node">
<title>expert_0_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M8513.5,-518C8513.5,-518 8356.5,-518 8356.5,-518 8350.5,-518 8344.5,-512 8344.5,-506 8344.5,-506 8344.5,-477 8344.5,-477 8344.5,-471 8350.5,-465 8356.5,-465 8356.5,-465 8513.5,-465 8513.5,-465 8519.5,-465 8525.5,-471 8525.5,-477 8525.5,-477 8525.5,-506 8525.5,-506 8525.5,-512 8519.5,-518 8513.5,-518"/>
<text text-anchor="middle" x="8435" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="8435" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="8435" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_fc1_0&#45;&gt;expert_0_gelu_0 -->
<g id="edge148" class="edge">
<title>expert_0_fc1_0&#45;&gt;expert_0_gelu_0</title>
<path fill="none" stroke="black" d="M8401.53,-568.85C8407.26,-555.78 8413.85,-540.76 8419.65,-527.51"/>
<polygon fill="black" stroke="black" points="8422.91,-528.8 8423.72,-518.24 8416.5,-525.99 8422.91,-528.8"/>
</g>
<!-- expert_0_gelu_1 -->
<g id="node102" class="node">
<title>expert_0_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M8754.5,-518C8754.5,-518 8597.5,-518 8597.5,-518 8591.5,-518 8585.5,-512 8585.5,-506 8585.5,-506 8585.5,-477 8585.5,-477 8585.5,-471 8591.5,-465 8597.5,-465 8597.5,-465 8754.5,-465 8754.5,-465 8760.5,-465 8766.5,-471 8766.5,-477 8766.5,-477 8766.5,-506 8766.5,-506 8766.5,-512 8760.5,-518 8754.5,-518"/>
<text text-anchor="middle" x="8676" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="8676" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="8676" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_0_fc1_1&#45;&gt;expert_0_gelu_1 -->
<g id="edge149" class="edge">
<title>expert_0_fc1_1&#45;&gt;expert_0_gelu_1</title>
<path fill="none" stroke="black" d="M8662.05,-568.85C8664.4,-556.03 8667.08,-541.34 8669.46,-528.29"/>
<polygon fill="black" stroke="black" points="8672.95,-528.7 8671.3,-518.24 8666.06,-527.45 8672.95,-528.7"/>
</g>
<!-- expert_0_fc2_0 -->
<g id="node103" class="node">
<title>expert_0_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M8539.5,-428C8539.5,-428 8330.5,-428 8330.5,-428 8324.5,-428 8318.5,-422 8318.5,-416 8318.5,-416 8318.5,-372 8318.5,-372 8318.5,-366 8324.5,-360 8330.5,-360 8330.5,-360 8539.5,-360 8539.5,-360 8545.5,-360 8551.5,-366 8551.5,-372 8551.5,-372 8551.5,-416 8551.5,-416 8551.5,-422 8545.5,-428 8539.5,-428"/>
<text text-anchor="middle" x="8435" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="8435" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="8435" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8435" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_0_gelu_0&#45;&gt;expert_0_fc2_0 -->
<g id="edge150" class="edge">
<title>expert_0_gelu_0&#45;&gt;expert_0_fc2_0</title>
<path fill="none" stroke="black" d="M8435,-464.91C8435,-456.72 8435,-447.41 8435,-438.32"/>
<polygon fill="black" stroke="black" points="8438.5,-438.22 8435,-428.22 8431.5,-438.22 8438.5,-438.22"/>
</g>
<!-- expert_0_fc2_1 -->
<g id="node104" class="node">
<title>expert_0_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M8790.5,-428C8790.5,-428 8581.5,-428 8581.5,-428 8575.5,-428 8569.5,-422 8569.5,-416 8569.5,-416 8569.5,-372 8569.5,-372 8569.5,-366 8575.5,-360 8581.5,-360 8581.5,-360 8790.5,-360 8790.5,-360 8796.5,-360 8802.5,-366 8802.5,-372 8802.5,-372 8802.5,-416 8802.5,-416 8802.5,-422 8796.5,-428 8790.5,-428"/>
<text text-anchor="middle" x="8686" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 0 FC2</text>
<text text-anchor="middle" x="8686" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="8686" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="8686" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_0_gelu_1&#45;&gt;expert_0_fc2_1 -->
<g id="edge151" class="edge">
<title>expert_0_gelu_1&#45;&gt;expert_0_fc2_1</title>
<path fill="none" stroke="black" d="M8678.68,-464.91C8679.54,-456.72 8680.51,-447.41 8681.46,-438.32"/>
<polygon fill="black" stroke="black" points="8684.96,-438.53 8682.52,-428.22 8678,-437.8 8684.96,-438.53"/>
</g>
<!-- expert_0_allreduce -->
<g id="node105" class="node">
<title>expert_0_allreduce</title>
<path fill="gold" stroke="black" d="M8771.5,-323C8771.5,-323 8600.5,-323 8600.5,-323 8594.5,-323 8588.5,-317 8588.5,-311 8588.5,-311 8588.5,-282 8588.5,-282 8588.5,-276 8594.5,-270 8600.5,-270 8600.5,-270 8771.5,-270 8771.5,-270 8777.5,-270 8783.5,-276 8783.5,-282 8783.5,-282 8783.5,-311 8783.5,-311 8783.5,-317 8777.5,-323 8771.5,-323"/>
<text text-anchor="middle" x="8686" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 0 All&#45;Reduce</text>
<text text-anchor="middle" x="8686" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="8686" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;1</text>
</g>
<!-- expert_0_fc2_0&#45;&gt;expert_0_allreduce -->
<g id="edge152" class="edge">
<title>expert_0_fc2_0&#45;&gt;expert_0_allreduce</title>
<path fill="none" stroke="black" d="M8522.08,-359.87C8550.45,-349.07 8581.72,-337.17 8609.28,-326.69"/>
<polygon fill="black" stroke="black" points="8610.76,-329.87 8618.86,-323.05 8608.27,-323.33 8610.76,-329.87"/>
</g>
<!-- expert_0_fc2_1&#45;&gt;expert_0_allreduce -->
<g id="edge153" class="edge">
<title>expert_0_fc2_1&#45;&gt;expert_0_allreduce</title>
<path fill="none" stroke="black" d="M8686,-359.87C8686,-351.29 8686,-342.01 8686,-333.3"/>
<polygon fill="black" stroke="black" points="8689.5,-333.05 8686,-323.05 8682.5,-333.05 8689.5,-333.05"/>
</g>
<!-- expert_agg -->
<g id="node155" class="node">
<title>expert_agg</title>
<path fill="lightpink" stroke="black" d="M10771,-233C10771,-233 10589,-233 10589,-233 10583,-233 10577,-227 10577,-221 10577,-221 10577,-192 10577,-192 10577,-186 10583,-180 10589,-180 10589,-180 10771,-180 10771,-180 10777,-180 10783,-186 10783,-192 10783,-192 10783,-221 10783,-221 10783,-227 10777,-233 10771,-233"/>
<text text-anchor="middle" x="10680" y="-217.8" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="10680" y="-202.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="10680" y="-187.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_0_allreduce&#45;&gt;expert_agg -->
<g id="edge154" class="edge">
<title>expert_0_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8783.85,-288.63C8865.23,-283.08 8984.11,-275.33 9088,-270 9642.05,-241.56 10305.16,-219.32 10566.34,-211.02"/>
<polygon fill="black" stroke="black" points="10566.71,-214.51 10576.59,-210.7 10566.48,-207.51 10566.71,-214.51"/>
</g>
<!-- expert_1_gelu_0 -->
<g id="node108" class="node">
<title>expert_1_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M9014.5,-518C9014.5,-518 8857.5,-518 8857.5,-518 8851.5,-518 8845.5,-512 8845.5,-506 8845.5,-506 8845.5,-477 8845.5,-477 8845.5,-471 8851.5,-465 8857.5,-465 8857.5,-465 9014.5,-465 9014.5,-465 9020.5,-465 9026.5,-471 9026.5,-477 9026.5,-477 9026.5,-506 9026.5,-506 9026.5,-512 9020.5,-518 9014.5,-518"/>
<text text-anchor="middle" x="8936" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="8936" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="8936" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_1_fc1_0&#45;&gt;expert_1_gelu_0 -->
<g id="edge157" class="edge">
<title>expert_1_fc1_0&#45;&gt;expert_1_gelu_0</title>
<path fill="none" stroke="black" d="M8928.33,-568.85C8929.62,-556.03 8931.09,-541.34 8932.41,-528.29"/>
<polygon fill="black" stroke="black" points="8935.9,-528.54 8933.41,-518.24 8928.93,-527.84 8935.9,-528.54"/>
</g>
<!-- expert_1_gelu_1 -->
<g id="node109" class="node">
<title>expert_1_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M9272.5,-518C9272.5,-518 9115.5,-518 9115.5,-518 9109.5,-518 9103.5,-512 9103.5,-506 9103.5,-506 9103.5,-477 9103.5,-477 9103.5,-471 9109.5,-465 9115.5,-465 9115.5,-465 9272.5,-465 9272.5,-465 9278.5,-465 9284.5,-471 9284.5,-477 9284.5,-477 9284.5,-506 9284.5,-506 9284.5,-512 9278.5,-518 9272.5,-518"/>
<text text-anchor="middle" x="9194" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="9194" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="9194" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_1_fc1_1&#45;&gt;expert_1_gelu_1 -->
<g id="edge158" class="edge">
<title>expert_1_fc1_1&#45;&gt;expert_1_gelu_1</title>
<path fill="none" stroke="black" d="M9194,-568.85C9194,-556.03 9194,-541.34 9194,-528.29"/>
<polygon fill="black" stroke="black" points="9197.5,-528.24 9194,-518.24 9190.5,-528.24 9197.5,-528.24"/>
</g>
<!-- expert_1_fc2_0 -->
<g id="node110" class="node">
<title>expert_1_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M9045.5,-428C9045.5,-428 8836.5,-428 8836.5,-428 8830.5,-428 8824.5,-422 8824.5,-416 8824.5,-416 8824.5,-372 8824.5,-372 8824.5,-366 8830.5,-360 8836.5,-360 8836.5,-360 9045.5,-360 9045.5,-360 9051.5,-360 9057.5,-366 9057.5,-372 9057.5,-372 9057.5,-416 9057.5,-416 9057.5,-422 9051.5,-428 9045.5,-428"/>
<text text-anchor="middle" x="8941" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="8941" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="8941" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8941" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_1_gelu_0&#45;&gt;expert_1_fc2_0 -->
<g id="edge159" class="edge">
<title>expert_1_gelu_0&#45;&gt;expert_1_fc2_0</title>
<path fill="none" stroke="black" d="M8937.34,-464.91C8937.77,-456.72 8938.26,-447.41 8938.73,-438.32"/>
<polygon fill="black" stroke="black" points="8942.23,-438.39 8939.26,-428.22 8935.24,-438.02 8942.23,-438.39"/>
</g>
<!-- expert_1_fc2_1 -->
<g id="node111" class="node">
<title>expert_1_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M9298.5,-428C9298.5,-428 9089.5,-428 9089.5,-428 9083.5,-428 9077.5,-422 9077.5,-416 9077.5,-416 9077.5,-372 9077.5,-372 9077.5,-366 9083.5,-360 9089.5,-360 9089.5,-360 9298.5,-360 9298.5,-360 9304.5,-360 9310.5,-366 9310.5,-372 9310.5,-372 9310.5,-416 9310.5,-416 9310.5,-422 9304.5,-428 9298.5,-428"/>
<text text-anchor="middle" x="9194" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 1 FC2</text>
<text text-anchor="middle" x="9194" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="9194" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9194" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_1_gelu_1&#45;&gt;expert_1_fc2_1 -->
<g id="edge160" class="edge">
<title>expert_1_gelu_1&#45;&gt;expert_1_fc2_1</title>
<path fill="none" stroke="black" d="M9194,-464.91C9194,-456.72 9194,-447.41 9194,-438.32"/>
<polygon fill="black" stroke="black" points="9197.5,-438.22 9194,-428.22 9190.5,-438.22 9197.5,-438.22"/>
</g>
<!-- expert_1_allreduce -->
<g id="node112" class="node">
<title>expert_1_allreduce</title>
<path fill="gold" stroke="black" d="M9279.5,-323C9279.5,-323 9108.5,-323 9108.5,-323 9102.5,-323 9096.5,-317 9096.5,-311 9096.5,-311 9096.5,-282 9096.5,-282 9096.5,-276 9102.5,-270 9108.5,-270 9108.5,-270 9279.5,-270 9279.5,-270 9285.5,-270 9291.5,-276 9291.5,-282 9291.5,-282 9291.5,-311 9291.5,-311 9291.5,-317 9285.5,-323 9279.5,-323"/>
<text text-anchor="middle" x="9194" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 1 All&#45;Reduce</text>
<text text-anchor="middle" x="9194" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="9194" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 2&#45;3</text>
</g>
<!-- expert_1_fc2_0&#45;&gt;expert_1_allreduce -->
<g id="edge161" class="edge">
<title>expert_1_fc2_0&#45;&gt;expert_1_allreduce</title>
<path fill="none" stroke="black" d="M9028.78,-359.87C9057.37,-349.07 9088.89,-337.17 9116.67,-326.69"/>
<polygon fill="black" stroke="black" points="9118.21,-329.85 9126.33,-323.05 9115.73,-323.3 9118.21,-329.85"/>
</g>
<!-- expert_1_fc2_1&#45;&gt;expert_1_allreduce -->
<g id="edge162" class="edge">
<title>expert_1_fc2_1&#45;&gt;expert_1_allreduce</title>
<path fill="none" stroke="black" d="M9194,-359.87C9194,-351.29 9194,-342.01 9194,-333.3"/>
<polygon fill="black" stroke="black" points="9197.5,-333.05 9194,-323.05 9190.5,-333.05 9197.5,-333.05"/>
</g>
<!-- expert_1_allreduce&#45;&gt;expert_agg -->
<g id="edge163" class="edge">
<title>expert_1_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9291.5,-289.73C9555.71,-274.08 10284.48,-230.92 10566.49,-214.22"/>
<polygon fill="black" stroke="black" points="10566.97,-217.7 10576.74,-213.61 10566.55,-210.71 10566.97,-217.7"/>
</g>
<!-- expert_2_gelu_0 -->
<g id="node115" class="node">
<title>expert_2_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M9546.5,-518C9546.5,-518 9389.5,-518 9389.5,-518 9383.5,-518 9377.5,-512 9377.5,-506 9377.5,-506 9377.5,-477 9377.5,-477 9377.5,-471 9383.5,-465 9389.5,-465 9389.5,-465 9546.5,-465 9546.5,-465 9552.5,-465 9558.5,-471 9558.5,-477 9558.5,-477 9558.5,-506 9558.5,-506 9558.5,-512 9552.5,-518 9546.5,-518"/>
<text text-anchor="middle" x="9468" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="9468" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="9468" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_2_fc1_0&#45;&gt;expert_2_gelu_0 -->
<g id="edge166" class="edge">
<title>expert_2_fc1_0&#45;&gt;expert_2_gelu_0</title>
<path fill="none" stroke="black" d="M9464.51,-568.85C9465.1,-556.03 9465.77,-541.34 9466.37,-528.29"/>
<polygon fill="black" stroke="black" points="9469.86,-528.39 9466.82,-518.24 9462.87,-528.07 9469.86,-528.39"/>
</g>
<!-- expert_2_gelu_1 -->
<g id="node116" class="node">
<title>expert_2_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M9810.5,-518C9810.5,-518 9653.5,-518 9653.5,-518 9647.5,-518 9641.5,-512 9641.5,-506 9641.5,-506 9641.5,-477 9641.5,-477 9641.5,-471 9647.5,-465 9653.5,-465 9653.5,-465 9810.5,-465 9810.5,-465 9816.5,-465 9822.5,-471 9822.5,-477 9822.5,-477 9822.5,-506 9822.5,-506 9822.5,-512 9816.5,-518 9810.5,-518"/>
<text text-anchor="middle" x="9732" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="9732" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="9732" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_2_fc1_1&#45;&gt;expert_2_gelu_1 -->
<g id="edge167" class="edge">
<title>expert_2_fc1_1&#45;&gt;expert_2_gelu_1</title>
<path fill="none" stroke="black" d="M9732,-568.85C9732,-556.03 9732,-541.34 9732,-528.29"/>
<polygon fill="black" stroke="black" points="9735.5,-528.24 9732,-518.24 9728.5,-528.24 9735.5,-528.24"/>
</g>
<!-- expert_2_fc2_0 -->
<g id="node117" class="node">
<title>expert_2_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M9576.5,-428C9576.5,-428 9367.5,-428 9367.5,-428 9361.5,-428 9355.5,-422 9355.5,-416 9355.5,-416 9355.5,-372 9355.5,-372 9355.5,-366 9361.5,-360 9367.5,-360 9367.5,-360 9576.5,-360 9576.5,-360 9582.5,-360 9588.5,-366 9588.5,-372 9588.5,-372 9588.5,-416 9588.5,-416 9588.5,-422 9582.5,-428 9576.5,-428"/>
<text text-anchor="middle" x="9472" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="9472" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="9472" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="9472" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_2_gelu_0&#45;&gt;expert_2_fc2_0 -->
<g id="edge168" class="edge">
<title>expert_2_gelu_0&#45;&gt;expert_2_fc2_0</title>
<path fill="none" stroke="black" d="M9469.07,-464.91C9469.41,-456.72 9469.8,-447.41 9470.19,-438.32"/>
<polygon fill="black" stroke="black" points="9473.69,-438.36 9470.61,-428.22 9466.69,-438.07 9473.69,-438.36"/>
</g>
<!-- expert_2_fc2_1 -->
<g id="node118" class="node">
<title>expert_2_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M9836.5,-428C9836.5,-428 9627.5,-428 9627.5,-428 9621.5,-428 9615.5,-422 9615.5,-416 9615.5,-416 9615.5,-372 9615.5,-372 9615.5,-366 9621.5,-360 9627.5,-360 9627.5,-360 9836.5,-360 9836.5,-360 9842.5,-360 9848.5,-366 9848.5,-372 9848.5,-372 9848.5,-416 9848.5,-416 9848.5,-422 9842.5,-428 9836.5,-428"/>
<text text-anchor="middle" x="9732" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 2 FC2</text>
<text text-anchor="middle" x="9732" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="9732" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9732" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_2_gelu_1&#45;&gt;expert_2_fc2_1 -->
<g id="edge169" class="edge">
<title>expert_2_gelu_1&#45;&gt;expert_2_fc2_1</title>
<path fill="none" stroke="black" d="M9732,-464.91C9732,-456.72 9732,-447.41 9732,-438.32"/>
<polygon fill="black" stroke="black" points="9735.5,-438.22 9732,-428.22 9728.5,-438.22 9735.5,-438.22"/>
</g>
<!-- expert_2_allreduce -->
<g id="node119" class="node">
<title>expert_2_allreduce</title>
<path fill="gold" stroke="black" d="M9817.5,-323C9817.5,-323 9646.5,-323 9646.5,-323 9640.5,-323 9634.5,-317 9634.5,-311 9634.5,-311 9634.5,-282 9634.5,-282 9634.5,-276 9640.5,-270 9646.5,-270 9646.5,-270 9817.5,-270 9817.5,-270 9823.5,-270 9829.5,-276 9829.5,-282 9829.5,-282 9829.5,-311 9829.5,-311 9829.5,-317 9823.5,-323 9817.5,-323"/>
<text text-anchor="middle" x="9732" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 2 All&#45;Reduce</text>
<text text-anchor="middle" x="9732" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="9732" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;5</text>
</g>
<!-- expert_2_fc2_0&#45;&gt;expert_2_allreduce -->
<g id="edge170" class="edge">
<title>expert_2_fc2_0&#45;&gt;expert_2_allreduce</title>
<path fill="none" stroke="black" d="M9562.21,-359.87C9591.72,-349.02 9624.27,-337.07 9652.9,-326.55"/>
<polygon fill="black" stroke="black" points="9654.27,-329.78 9662.45,-323.05 9651.86,-323.21 9654.27,-329.78"/>
</g>
<!-- expert_2_fc2_1&#45;&gt;expert_2_allreduce -->
<g id="edge171" class="edge">
<title>expert_2_fc2_1&#45;&gt;expert_2_allreduce</title>
<path fill="none" stroke="black" d="M9732,-359.87C9732,-351.29 9732,-342.01 9732,-333.3"/>
<polygon fill="black" stroke="black" points="9735.5,-333.05 9732,-323.05 9728.5,-333.05 9735.5,-333.05"/>
</g>
<!-- expert_2_allreduce&#45;&gt;expert_agg -->
<g id="edge172" class="edge">
<title>expert_2_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M9829.88,-286.41C10006.87,-269.99 10379.1,-235.43 10566.75,-218.01"/>
<polygon fill="black" stroke="black" points="10567.29,-221.48 10576.92,-217.07 10566.64,-214.51 10567.29,-221.48"/>
</g>
<!-- expert_3_gelu_0 -->
<g id="node122" class="node">
<title>expert_3_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M10082.5,-518C10082.5,-518 9925.5,-518 9925.5,-518 9919.5,-518 9913.5,-512 9913.5,-506 9913.5,-506 9913.5,-477 9913.5,-477 9913.5,-471 9919.5,-465 9925.5,-465 9925.5,-465 10082.5,-465 10082.5,-465 10088.5,-465 10094.5,-471 10094.5,-477 10094.5,-477 10094.5,-506 10094.5,-506 10094.5,-512 10088.5,-518 10082.5,-518"/>
<text text-anchor="middle" x="10004" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="10004" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="10004" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_3_fc1_0&#45;&gt;expert_3_gelu_0 -->
<g id="edge175" class="edge">
<title>expert_3_fc1_0&#45;&gt;expert_3_gelu_0</title>
<path fill="none" stroke="black" d="M10001.91,-568.85C10002.26,-556.03 10002.66,-541.34 10003.02,-528.29"/>
<polygon fill="black" stroke="black" points="10006.52,-528.33 10003.29,-518.24 9999.52,-528.14 10006.52,-528.33"/>
</g>
<!-- expert_3_gelu_1 -->
<g id="node123" class="node">
<title>expert_3_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M10348.5,-518C10348.5,-518 10191.5,-518 10191.5,-518 10185.5,-518 10179.5,-512 10179.5,-506 10179.5,-506 10179.5,-477 10179.5,-477 10179.5,-471 10185.5,-465 10191.5,-465 10191.5,-465 10348.5,-465 10348.5,-465 10354.5,-465 10360.5,-471 10360.5,-477 10360.5,-477 10360.5,-506 10360.5,-506 10360.5,-512 10354.5,-518 10348.5,-518"/>
<text text-anchor="middle" x="10270" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="10270" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="10270" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_3_fc1_1&#45;&gt;expert_3_gelu_1 -->
<g id="edge176" class="edge">
<title>expert_3_fc1_1&#45;&gt;expert_3_gelu_1</title>
<path fill="none" stroke="black" d="M10270,-568.85C10270,-556.03 10270,-541.34 10270,-528.29"/>
<polygon fill="black" stroke="black" points="10273.5,-528.24 10270,-518.24 10266.5,-528.24 10273.5,-528.24"/>
</g>
<!-- expert_3_fc2_0 -->
<g id="node124" class="node">
<title>expert_3_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M10119.5,-428C10119.5,-428 9910.5,-428 9910.5,-428 9904.5,-428 9898.5,-422 9898.5,-416 9898.5,-416 9898.5,-372 9898.5,-372 9898.5,-366 9904.5,-360 9910.5,-360 9910.5,-360 10119.5,-360 10119.5,-360 10125.5,-360 10131.5,-366 10131.5,-372 10131.5,-372 10131.5,-416 10131.5,-416 10131.5,-422 10125.5,-428 10119.5,-428"/>
<text text-anchor="middle" x="10015" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="10015" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="10015" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10015" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_3_gelu_0&#45;&gt;expert_3_fc2_0 -->
<g id="edge177" class="edge">
<title>expert_3_gelu_0&#45;&gt;expert_3_fc2_0</title>
<path fill="none" stroke="black" d="M10006.95,-464.91C10007.89,-456.72 10008.96,-447.41 10010.01,-438.32"/>
<polygon fill="black" stroke="black" points="10013.51,-438.56 10011.17,-428.22 10006.55,-437.75 10013.51,-438.56"/>
</g>
<!-- expert_3_fc2_1 -->
<g id="node125" class="node">
<title>expert_3_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M10374.5,-428C10374.5,-428 10165.5,-428 10165.5,-428 10159.5,-428 10153.5,-422 10153.5,-416 10153.5,-416 10153.5,-372 10153.5,-372 10153.5,-366 10159.5,-360 10165.5,-360 10165.5,-360 10374.5,-360 10374.5,-360 10380.5,-360 10386.5,-366 10386.5,-372 10386.5,-372 10386.5,-416 10386.5,-416 10386.5,-422 10380.5,-428 10374.5,-428"/>
<text text-anchor="middle" x="10270" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 3 FC2</text>
<text text-anchor="middle" x="10270" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="10270" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10270" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_3_gelu_1&#45;&gt;expert_3_fc2_1 -->
<g id="edge178" class="edge">
<title>expert_3_gelu_1&#45;&gt;expert_3_fc2_1</title>
<path fill="none" stroke="black" d="M10270,-464.91C10270,-456.72 10270,-447.41 10270,-438.32"/>
<polygon fill="black" stroke="black" points="10273.5,-438.22 10270,-428.22 10266.5,-438.22 10273.5,-438.22"/>
</g>
<!-- expert_3_allreduce -->
<g id="node126" class="node">
<title>expert_3_allreduce</title>
<path fill="gold" stroke="black" d="M10355.5,-323C10355.5,-323 10184.5,-323 10184.5,-323 10178.5,-323 10172.5,-317 10172.5,-311 10172.5,-311 10172.5,-282 10172.5,-282 10172.5,-276 10178.5,-270 10184.5,-270 10184.5,-270 10355.5,-270 10355.5,-270 10361.5,-270 10367.5,-276 10367.5,-282 10367.5,-282 10367.5,-311 10367.5,-311 10367.5,-317 10361.5,-323 10355.5,-323"/>
<text text-anchor="middle" x="10270" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 3 All&#45;Reduce</text>
<text text-anchor="middle" x="10270" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="10270" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 6&#45;7</text>
</g>
<!-- expert_3_fc2_0&#45;&gt;expert_3_allreduce -->
<g id="edge179" class="edge">
<title>expert_3_fc2_0&#45;&gt;expert_3_allreduce</title>
<path fill="none" stroke="black" d="M10103.47,-359.87C10132.42,-349.02 10164.34,-337.07 10192.42,-326.55"/>
<polygon fill="black" stroke="black" points="10193.65,-329.83 10201.79,-323.05 10191.2,-323.27 10193.65,-329.83"/>
</g>
<!-- expert_3_fc2_1&#45;&gt;expert_3_allreduce -->
<g id="edge180" class="edge">
<title>expert_3_fc2_1&#45;&gt;expert_3_allreduce</title>
<path fill="none" stroke="black" d="M10270,-359.87C10270,-351.29 10270,-342.01 10270,-333.3"/>
<polygon fill="black" stroke="black" points="10273.5,-333.05 10270,-323.05 10266.5,-333.05 10273.5,-333.05"/>
</g>
<!-- expert_3_allreduce&#45;&gt;expert_agg -->
<g id="edge181" class="edge">
<title>expert_3_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10367.68,-274.53C10427.6,-261.67 10504.55,-245.16 10567.08,-231.74"/>
<polygon fill="black" stroke="black" points="10567.94,-235.13 10576.98,-229.61 10566.47,-228.29 10567.94,-235.13"/>
</g>
<!-- expert_4_gelu_0 -->
<g id="node129" class="node">
<title>expert_4_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M10621.5,-518C10621.5,-518 10464.5,-518 10464.5,-518 10458.5,-518 10452.5,-512 10452.5,-506 10452.5,-506 10452.5,-477 10452.5,-477 10452.5,-471 10458.5,-465 10464.5,-465 10464.5,-465 10621.5,-465 10621.5,-465 10627.5,-465 10633.5,-471 10633.5,-477 10633.5,-477 10633.5,-506 10633.5,-506 10633.5,-512 10627.5,-518 10621.5,-518"/>
<text text-anchor="middle" x="10543" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="10543" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="10543" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_4_fc1_0&#45;&gt;expert_4_gelu_0 -->
<g id="edge184" class="edge">
<title>expert_4_fc1_0&#45;&gt;expert_4_gelu_0</title>
<path fill="none" stroke="black" d="M10540.21,-568.85C10540.68,-556.03 10541.22,-541.34 10541.69,-528.29"/>
<polygon fill="black" stroke="black" points="10545.19,-528.36 10542.06,-518.24 10538.2,-528.1 10545.19,-528.36"/>
</g>
<!-- expert_4_gelu_1 -->
<g id="node130" class="node">
<title>expert_4_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M10885.5,-518C10885.5,-518 10728.5,-518 10728.5,-518 10722.5,-518 10716.5,-512 10716.5,-506 10716.5,-506 10716.5,-477 10716.5,-477 10716.5,-471 10722.5,-465 10728.5,-465 10728.5,-465 10885.5,-465 10885.5,-465 10891.5,-465 10897.5,-471 10897.5,-477 10897.5,-477 10897.5,-506 10897.5,-506 10897.5,-512 10891.5,-518 10885.5,-518"/>
<text text-anchor="middle" x="10807" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="10807" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="10807" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_4_fc1_1&#45;&gt;expert_4_gelu_1 -->
<g id="edge185" class="edge">
<title>expert_4_fc1_1&#45;&gt;expert_4_gelu_1</title>
<path fill="none" stroke="black" d="M10807.7,-568.85C10807.58,-556.03 10807.45,-541.34 10807.33,-528.29"/>
<polygon fill="black" stroke="black" points="10810.83,-528.2 10807.24,-518.24 10803.83,-528.27 10810.83,-528.2"/>
</g>
<!-- expert_4_fc2_0 -->
<g id="node131" class="node">
<title>expert_4_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M10658.5,-428C10658.5,-428 10449.5,-428 10449.5,-428 10443.5,-428 10437.5,-422 10437.5,-416 10437.5,-416 10437.5,-372 10437.5,-372 10437.5,-366 10443.5,-360 10449.5,-360 10449.5,-360 10658.5,-360 10658.5,-360 10664.5,-360 10670.5,-366 10670.5,-372 10670.5,-372 10670.5,-416 10670.5,-416 10670.5,-422 10664.5,-428 10658.5,-428"/>
<text text-anchor="middle" x="10554" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="10554" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="10554" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="10554" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_4_gelu_0&#45;&gt;expert_4_fc2_0 -->
<g id="edge186" class="edge">
<title>expert_4_gelu_0&#45;&gt;expert_4_fc2_0</title>
<path fill="none" stroke="black" d="M10545.95,-464.91C10546.89,-456.72 10547.96,-447.41 10549.01,-438.32"/>
<polygon fill="black" stroke="black" points="10552.51,-438.56 10550.17,-428.22 10545.55,-437.75 10552.51,-438.56"/>
</g>
<!-- expert_4_fc2_1 -->
<g id="node132" class="node">
<title>expert_4_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M10910.5,-428C10910.5,-428 10701.5,-428 10701.5,-428 10695.5,-428 10689.5,-422 10689.5,-416 10689.5,-416 10689.5,-372 10689.5,-372 10689.5,-366 10695.5,-360 10701.5,-360 10701.5,-360 10910.5,-360 10910.5,-360 10916.5,-360 10922.5,-366 10922.5,-372 10922.5,-372 10922.5,-416 10922.5,-416 10922.5,-422 10916.5,-428 10910.5,-428"/>
<text text-anchor="middle" x="10806" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 4 FC2</text>
<text text-anchor="middle" x="10806" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="10806" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="10806" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_4_gelu_1&#45;&gt;expert_4_fc2_1 -->
<g id="edge187" class="edge">
<title>expert_4_gelu_1&#45;&gt;expert_4_fc2_1</title>
<path fill="none" stroke="black" d="M10806.73,-464.91C10806.65,-456.72 10806.55,-447.41 10806.45,-438.32"/>
<polygon fill="black" stroke="black" points="10809.95,-438.18 10806.35,-428.22 10802.95,-438.26 10809.95,-438.18"/>
</g>
<!-- expert_4_allreduce -->
<g id="node133" class="node">
<title>expert_4_allreduce</title>
<path fill="gold" stroke="black" d="M10765.5,-323C10765.5,-323 10594.5,-323 10594.5,-323 10588.5,-323 10582.5,-317 10582.5,-311 10582.5,-311 10582.5,-282 10582.5,-282 10582.5,-276 10588.5,-270 10594.5,-270 10594.5,-270 10765.5,-270 10765.5,-270 10771.5,-270 10777.5,-276 10777.5,-282 10777.5,-282 10777.5,-311 10777.5,-311 10777.5,-317 10771.5,-323 10765.5,-323"/>
<text text-anchor="middle" x="10680" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 4 All&#45;Reduce</text>
<text text-anchor="middle" x="10680" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="10680" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;9</text>
</g>
<!-- expert_4_fc2_0&#45;&gt;expert_4_allreduce -->
<g id="edge188" class="edge">
<title>expert_4_fc2_0&#45;&gt;expert_4_allreduce</title>
<path fill="none" stroke="black" d="M10597.72,-359.87C10610.78,-349.97 10625.06,-339.14 10638.01,-329.33"/>
<polygon fill="black" stroke="black" points="10640.44,-331.87 10646.3,-323.05 10636.21,-326.3 10640.44,-331.87"/>
</g>
<!-- expert_4_fc2_1&#45;&gt;expert_4_allreduce -->
<g id="edge189" class="edge">
<title>expert_4_fc2_1&#45;&gt;expert_4_allreduce</title>
<path fill="none" stroke="black" d="M10762.28,-359.87C10749.22,-349.97 10734.94,-339.14 10721.99,-329.33"/>
<polygon fill="black" stroke="black" points="10723.79,-326.3 10713.7,-323.05 10719.56,-331.87 10723.79,-326.3"/>
</g>
<!-- expert_4_allreduce&#45;&gt;expert_agg -->
<g id="edge190" class="edge">
<title>expert_4_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10680,-269.57C10680,-261.34 10680,-252.08 10680,-243.28"/>
<polygon fill="black" stroke="black" points="10683.5,-243.24 10680,-233.24 10676.5,-243.24 10683.5,-243.24"/>
</g>
<!-- expert_5_gelu_0 -->
<g id="node136" class="node">
<title>expert_5_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M11155.5,-518C11155.5,-518 10998.5,-518 10998.5,-518 10992.5,-518 10986.5,-512 10986.5,-506 10986.5,-506 10986.5,-477 10986.5,-477 10986.5,-471 10992.5,-465 10998.5,-465 10998.5,-465 11155.5,-465 11155.5,-465 11161.5,-465 11167.5,-471 11167.5,-477 11167.5,-477 11167.5,-506 11167.5,-506 11167.5,-512 11161.5,-518 11155.5,-518"/>
<text text-anchor="middle" x="11077" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="11077" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="11077" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_5_fc1_0&#45;&gt;expert_5_gelu_0 -->
<g id="edge193" class="edge">
<title>expert_5_fc1_0&#45;&gt;expert_5_gelu_0</title>
<path fill="none" stroke="black" d="M11077,-568.85C11077,-556.03 11077,-541.34 11077,-528.29"/>
<polygon fill="black" stroke="black" points="11080.5,-528.24 11077,-518.24 11073.5,-528.24 11080.5,-528.24"/>
</g>
<!-- expert_5_gelu_1 -->
<g id="node137" class="node">
<title>expert_5_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M11419.5,-518C11419.5,-518 11262.5,-518 11262.5,-518 11256.5,-518 11250.5,-512 11250.5,-506 11250.5,-506 11250.5,-477 11250.5,-477 11250.5,-471 11256.5,-465 11262.5,-465 11262.5,-465 11419.5,-465 11419.5,-465 11425.5,-465 11431.5,-471 11431.5,-477 11431.5,-477 11431.5,-506 11431.5,-506 11431.5,-512 11425.5,-518 11419.5,-518"/>
<text text-anchor="middle" x="11341" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="11341" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="11341" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_5_fc1_1&#45;&gt;expert_5_gelu_1 -->
<g id="edge194" class="edge">
<title>expert_5_fc1_1&#45;&gt;expert_5_gelu_1</title>
<path fill="none" stroke="black" d="M11344.49,-568.85C11343.9,-556.03 11343.23,-541.34 11342.63,-528.29"/>
<polygon fill="black" stroke="black" points="11346.13,-528.07 11342.18,-518.24 11339.14,-528.39 11346.13,-528.07"/>
</g>
<!-- expert_5_fc2_0 -->
<g id="node138" class="node">
<title>expert_5_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M11181.5,-428C11181.5,-428 10972.5,-428 10972.5,-428 10966.5,-428 10960.5,-422 10960.5,-416 10960.5,-416 10960.5,-372 10960.5,-372 10960.5,-366 10966.5,-360 10972.5,-360 10972.5,-360 11181.5,-360 11181.5,-360 11187.5,-360 11193.5,-366 11193.5,-372 11193.5,-372 11193.5,-416 11193.5,-416 11193.5,-422 11187.5,-428 11181.5,-428"/>
<text text-anchor="middle" x="11077" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="11077" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="11077" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11077" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_5_gelu_0&#45;&gt;expert_5_fc2_0 -->
<g id="edge195" class="edge">
<title>expert_5_gelu_0&#45;&gt;expert_5_fc2_0</title>
<path fill="none" stroke="black" d="M11077,-464.91C11077,-456.72 11077,-447.41 11077,-438.32"/>
<polygon fill="black" stroke="black" points="11080.5,-438.22 11077,-428.22 11073.5,-438.22 11080.5,-438.22"/>
</g>
<!-- expert_5_fc2_1 -->
<g id="node139" class="node">
<title>expert_5_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M11434.5,-428C11434.5,-428 11225.5,-428 11225.5,-428 11219.5,-428 11213.5,-422 11213.5,-416 11213.5,-416 11213.5,-372 11213.5,-372 11213.5,-366 11219.5,-360 11225.5,-360 11225.5,-360 11434.5,-360 11434.5,-360 11440.5,-360 11446.5,-366 11446.5,-372 11446.5,-372 11446.5,-416 11446.5,-416 11446.5,-422 11440.5,-428 11434.5,-428"/>
<text text-anchor="middle" x="11330" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 5 FC2</text>
<text text-anchor="middle" x="11330" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="11330" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="11330" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_5_gelu_1&#45;&gt;expert_5_fc2_1 -->
<g id="edge196" class="edge">
<title>expert_5_gelu_1&#45;&gt;expert_5_fc2_1</title>
<path fill="none" stroke="black" d="M11338.05,-464.91C11337.11,-456.72 11336.04,-447.41 11334.99,-438.32"/>
<polygon fill="black" stroke="black" points="11338.45,-437.75 11333.83,-428.22 11331.49,-438.56 11338.45,-437.75"/>
</g>
<!-- expert_5_allreduce -->
<g id="node140" class="node">
<title>expert_5_allreduce</title>
<path fill="gold" stroke="black" d="M11162.5,-323C11162.5,-323 10991.5,-323 10991.5,-323 10985.5,-323 10979.5,-317 10979.5,-311 10979.5,-311 10979.5,-282 10979.5,-282 10979.5,-276 10985.5,-270 10991.5,-270 10991.5,-270 11162.5,-270 11162.5,-270 11168.5,-270 11174.5,-276 11174.5,-282 11174.5,-282 11174.5,-311 11174.5,-311 11174.5,-317 11168.5,-323 11162.5,-323"/>
<text text-anchor="middle" x="11077" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 5 All&#45;Reduce</text>
<text text-anchor="middle" x="11077" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="11077" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 10&#45;11</text>
</g>
<!-- expert_5_fc2_0&#45;&gt;expert_5_allreduce -->
<g id="edge197" class="edge">
<title>expert_5_fc2_0&#45;&gt;expert_5_allreduce</title>
<path fill="none" stroke="black" d="M11077,-359.87C11077,-351.29 11077,-342.01 11077,-333.3"/>
<polygon fill="black" stroke="black" points="11080.5,-333.05 11077,-323.05 11073.5,-333.05 11080.5,-333.05"/>
</g>
<!-- expert_5_fc2_1&#45;&gt;expert_5_allreduce -->
<g id="edge198" class="edge">
<title>expert_5_fc2_1&#45;&gt;expert_5_allreduce</title>
<path fill="none" stroke="black" d="M11242.22,-359.87C11213.63,-349.07 11182.11,-337.17 11154.33,-326.69"/>
<polygon fill="black" stroke="black" points="11155.27,-323.3 11144.67,-323.05 11152.79,-329.85 11155.27,-323.3"/>
</g>
<!-- expert_5_allreduce&#45;&gt;expert_agg -->
<g id="edge199" class="edge">
<title>expert_5_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M10979.37,-273.86C10923.06,-261.38 10851.98,-245.62 10793.22,-232.6"/>
<polygon fill="black" stroke="black" points="10793.67,-229.11 10783.15,-230.36 10792.15,-235.95 10793.67,-229.11"/>
</g>
<!-- expert_6_gelu_0 -->
<g id="node143" class="node">
<title>expert_6_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M11693.5,-518C11693.5,-518 11536.5,-518 11536.5,-518 11530.5,-518 11524.5,-512 11524.5,-506 11524.5,-506 11524.5,-477 11524.5,-477 11524.5,-471 11530.5,-465 11536.5,-465 11536.5,-465 11693.5,-465 11693.5,-465 11699.5,-465 11705.5,-471 11705.5,-477 11705.5,-477 11705.5,-506 11705.5,-506 11705.5,-512 11699.5,-518 11693.5,-518"/>
<text text-anchor="middle" x="11615" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="11615" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="11615" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_6_fc1_0&#45;&gt;expert_6_gelu_0 -->
<g id="edge202" class="edge">
<title>expert_6_fc1_0&#45;&gt;expert_6_gelu_0</title>
<path fill="none" stroke="black" d="M11615,-568.85C11615,-556.03 11615,-541.34 11615,-528.29"/>
<polygon fill="black" stroke="black" points="11618.5,-528.24 11615,-518.24 11611.5,-528.24 11618.5,-528.24"/>
</g>
<!-- expert_6_gelu_1 -->
<g id="node144" class="node">
<title>expert_6_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M11959.5,-518C11959.5,-518 11802.5,-518 11802.5,-518 11796.5,-518 11790.5,-512 11790.5,-506 11790.5,-506 11790.5,-477 11790.5,-477 11790.5,-471 11796.5,-465 11802.5,-465 11802.5,-465 11959.5,-465 11959.5,-465 11965.5,-465 11971.5,-471 11971.5,-477 11971.5,-477 11971.5,-506 11971.5,-506 11971.5,-512 11965.5,-518 11959.5,-518"/>
<text text-anchor="middle" x="11881" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="11881" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="11881" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_6_fc1_1&#45;&gt;expert_6_gelu_1 -->
<g id="edge203" class="edge">
<title>expert_6_fc1_1&#45;&gt;expert_6_gelu_1</title>
<path fill="none" stroke="black" d="M11883.09,-568.85C11882.74,-556.03 11882.34,-541.34 11881.98,-528.29"/>
<polygon fill="black" stroke="black" points="11885.48,-528.14 11881.71,-518.24 11878.48,-528.33 11885.48,-528.14"/>
</g>
<!-- expert_6_fc2_0 -->
<g id="node145" class="node">
<title>expert_6_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M11719.5,-428C11719.5,-428 11510.5,-428 11510.5,-428 11504.5,-428 11498.5,-422 11498.5,-416 11498.5,-416 11498.5,-372 11498.5,-372 11498.5,-366 11504.5,-360 11510.5,-360 11510.5,-360 11719.5,-360 11719.5,-360 11725.5,-360 11731.5,-366 11731.5,-372 11731.5,-372 11731.5,-416 11731.5,-416 11731.5,-422 11725.5,-428 11719.5,-428"/>
<text text-anchor="middle" x="11615" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="11615" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="11615" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11615" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_6_gelu_0&#45;&gt;expert_6_fc2_0 -->
<g id="edge204" class="edge">
<title>expert_6_gelu_0&#45;&gt;expert_6_fc2_0</title>
<path fill="none" stroke="black" d="M11615,-464.91C11615,-456.72 11615,-447.41 11615,-438.32"/>
<polygon fill="black" stroke="black" points="11618.5,-438.22 11615,-428.22 11611.5,-438.22 11618.5,-438.22"/>
</g>
<!-- expert_6_fc2_1 -->
<g id="node146" class="node">
<title>expert_6_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M11972.5,-428C11972.5,-428 11763.5,-428 11763.5,-428 11757.5,-428 11751.5,-422 11751.5,-416 11751.5,-416 11751.5,-372 11751.5,-372 11751.5,-366 11757.5,-360 11763.5,-360 11763.5,-360 11972.5,-360 11972.5,-360 11978.5,-360 11984.5,-366 11984.5,-372 11984.5,-372 11984.5,-416 11984.5,-416 11984.5,-422 11978.5,-428 11972.5,-428"/>
<text text-anchor="middle" x="11868" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 6 FC2</text>
<text text-anchor="middle" x="11868" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="11868" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11868" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_6_gelu_1&#45;&gt;expert_6_fc2_1 -->
<g id="edge205" class="edge">
<title>expert_6_gelu_1&#45;&gt;expert_6_fc2_1</title>
<path fill="none" stroke="black" d="M11877.52,-464.91C11876.4,-456.72 11875.13,-447.41 11873.9,-438.32"/>
<polygon fill="black" stroke="black" points="11877.34,-437.66 11872.52,-428.22 11870.4,-438.6 11877.34,-437.66"/>
</g>
<!-- expert_6_allreduce -->
<g id="node147" class="node">
<title>expert_6_allreduce</title>
<path fill="gold" stroke="black" d="M11700.5,-323C11700.5,-323 11529.5,-323 11529.5,-323 11523.5,-323 11517.5,-317 11517.5,-311 11517.5,-311 11517.5,-282 11517.5,-282 11517.5,-276 11523.5,-270 11529.5,-270 11529.5,-270 11700.5,-270 11700.5,-270 11706.5,-270 11712.5,-276 11712.5,-282 11712.5,-282 11712.5,-311 11712.5,-311 11712.5,-317 11706.5,-323 11700.5,-323"/>
<text text-anchor="middle" x="11615" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 6 All&#45;Reduce</text>
<text text-anchor="middle" x="11615" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="11615" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;13</text>
</g>
<!-- expert_6_fc2_0&#45;&gt;expert_6_allreduce -->
<g id="edge206" class="edge">
<title>expert_6_fc2_0&#45;&gt;expert_6_allreduce</title>
<path fill="none" stroke="black" d="M11615,-359.87C11615,-351.29 11615,-342.01 11615,-333.3"/>
<polygon fill="black" stroke="black" points="11618.5,-333.05 11615,-323.05 11611.5,-333.05 11618.5,-333.05"/>
</g>
<!-- expert_6_fc2_1&#45;&gt;expert_6_allreduce -->
<g id="edge207" class="edge">
<title>expert_6_fc2_1&#45;&gt;expert_6_allreduce</title>
<path fill="none" stroke="black" d="M11780.22,-359.87C11751.63,-349.07 11720.11,-337.17 11692.33,-326.69"/>
<polygon fill="black" stroke="black" points="11693.27,-323.3 11682.67,-323.05 11690.79,-329.85 11693.27,-323.3"/>
</g>
<!-- expert_6_allreduce&#45;&gt;expert_agg -->
<g id="edge208" class="edge">
<title>expert_6_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M11517.15,-286.29C11342.52,-269.86 10978.22,-235.57 10793.14,-218.15"/>
<polygon fill="black" stroke="black" points="10793.4,-214.66 10783.11,-217.2 10792.74,-221.63 10793.4,-214.66"/>
</g>
<!-- expert_7_gelu_0 -->
<g id="node150" class="node">
<title>expert_7_gelu_0</title>
<path fill="lightcyan" stroke="black" d="M12231.5,-518C12231.5,-518 12074.5,-518 12074.5,-518 12068.5,-518 12062.5,-512 12062.5,-506 12062.5,-506 12062.5,-477 12062.5,-477 12062.5,-471 12068.5,-465 12074.5,-465 12074.5,-465 12231.5,-465 12231.5,-465 12237.5,-465 12243.5,-471 12243.5,-477 12243.5,-477 12243.5,-506 12243.5,-506 12243.5,-512 12237.5,-518 12231.5,-518"/>
<text text-anchor="middle" x="12153" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="12153" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="12153" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_7_fc1_0&#45;&gt;expert_7_gelu_0 -->
<g id="edge211" class="edge">
<title>expert_7_fc1_0&#45;&gt;expert_7_gelu_0</title>
<path fill="none" stroke="black" d="M12153,-568.85C12153,-556.03 12153,-541.34 12153,-528.29"/>
<polygon fill="black" stroke="black" points="12156.5,-528.24 12153,-518.24 12149.5,-528.24 12156.5,-528.24"/>
</g>
<!-- expert_7_gelu_1 -->
<g id="node151" class="node">
<title>expert_7_gelu_1</title>
<path fill="lightcyan" stroke="black" d="M12495.5,-518C12495.5,-518 12338.5,-518 12338.5,-518 12332.5,-518 12326.5,-512 12326.5,-506 12326.5,-506 12326.5,-477 12326.5,-477 12326.5,-471 12332.5,-465 12338.5,-465 12338.5,-465 12495.5,-465 12495.5,-465 12501.5,-465 12507.5,-471 12507.5,-477 12507.5,-477 12507.5,-506 12507.5,-506 12507.5,-512 12501.5,-518 12495.5,-518"/>
<text text-anchor="middle" x="12417" y="-502.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="12417" y="-487.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 16384)</text>
<text text-anchor="middle" x="12417" y="-472.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_7_fc1_1&#45;&gt;expert_7_gelu_1 -->
<g id="edge212" class="edge">
<title>expert_7_fc1_1&#45;&gt;expert_7_gelu_1</title>
<path fill="none" stroke="black" d="M12420.49,-568.85C12419.9,-556.03 12419.23,-541.34 12418.63,-528.29"/>
<polygon fill="black" stroke="black" points="12422.13,-528.07 12418.18,-518.24 12415.14,-528.39 12422.13,-528.07"/>
</g>
<!-- expert_7_fc2_0 -->
<g id="node152" class="node">
<title>expert_7_fc2_0</title>
<path fill="lightsteelblue" stroke="black" d="M12257.5,-428C12257.5,-428 12048.5,-428 12048.5,-428 12042.5,-428 12036.5,-422 12036.5,-416 12036.5,-416 12036.5,-372 12036.5,-372 12036.5,-366 12042.5,-360 12048.5,-360 12048.5,-360 12257.5,-360 12257.5,-360 12263.5,-360 12269.5,-366 12269.5,-372 12269.5,-372 12269.5,-416 12269.5,-416 12269.5,-422 12263.5,-428 12257.5,-428"/>
<text text-anchor="middle" x="12153" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="12153" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="12153" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12153" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_7_gelu_0&#45;&gt;expert_7_fc2_0 -->
<g id="edge213" class="edge">
<title>expert_7_gelu_0&#45;&gt;expert_7_fc2_0</title>
<path fill="none" stroke="black" d="M12153,-464.91C12153,-456.72 12153,-447.41 12153,-438.32"/>
<polygon fill="black" stroke="black" points="12156.5,-438.22 12153,-428.22 12149.5,-438.22 12156.5,-438.22"/>
</g>
<!-- expert_7_fc2_1 -->
<g id="node153" class="node">
<title>expert_7_fc2_1</title>
<path fill="lightsteelblue" stroke="black" d="M12517.5,-428C12517.5,-428 12308.5,-428 12308.5,-428 12302.5,-428 12296.5,-422 12296.5,-416 12296.5,-416 12296.5,-372 12296.5,-372 12296.5,-366 12302.5,-360 12308.5,-360 12308.5,-360 12517.5,-360 12517.5,-360 12523.5,-360 12529.5,-366 12529.5,-372 12529.5,-372 12529.5,-416 12529.5,-416 12529.5,-422 12523.5,-428 12517.5,-428"/>
<text text-anchor="middle" x="12413" y="-412.8" font-family="Times,serif" font-size="14.00">Expert 7 FC2</text>
<text text-anchor="middle" x="12413" y="-397.8" font-family="Times,serif" font-size="14.00">(B=selected, L, 8192/2=4096)</text>
<text text-anchor="middle" x="12413" y="-382.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12413" y="-367.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
</g>
<!-- expert_7_gelu_1&#45;&gt;expert_7_fc2_1 -->
<g id="edge214" class="edge">
<title>expert_7_gelu_1&#45;&gt;expert_7_fc2_1</title>
<path fill="none" stroke="black" d="M12415.93,-464.91C12415.59,-456.72 12415.2,-447.41 12414.81,-438.32"/>
<polygon fill="black" stroke="black" points="12418.31,-438.07 12414.39,-428.22 12411.31,-438.36 12418.31,-438.07"/>
</g>
<!-- expert_7_allreduce -->
<g id="node154" class="node">
<title>expert_7_allreduce</title>
<path fill="gold" stroke="black" d="M12238.5,-323C12238.5,-323 12067.5,-323 12067.5,-323 12061.5,-323 12055.5,-317 12055.5,-311 12055.5,-311 12055.5,-282 12055.5,-282 12055.5,-276 12061.5,-270 12067.5,-270 12067.5,-270 12238.5,-270 12238.5,-270 12244.5,-270 12250.5,-276 12250.5,-282 12250.5,-282 12250.5,-311 12250.5,-311 12250.5,-317 12244.5,-323 12238.5,-323"/>
<text text-anchor="middle" x="12153" y="-307.8" font-family="Times,serif" font-size="14.00">Expert 7 All&#45;Reduce</text>
<text text-anchor="middle" x="12153" y="-292.8" font-family="Times,serif" font-size="14.00">(B=selected, L, D=8192)</text>
<text text-anchor="middle" x="12153" y="-277.8" font-family="Times,serif" font-size="14.00">GPUs 14&#45;15</text>
</g>
<!-- expert_7_fc2_0&#45;&gt;expert_7_allreduce -->
<g id="edge215" class="edge">
<title>expert_7_fc2_0&#45;&gt;expert_7_allreduce</title>
<path fill="none" stroke="black" d="M12153,-359.87C12153,-351.29 12153,-342.01 12153,-333.3"/>
<polygon fill="black" stroke="black" points="12156.5,-333.05 12153,-323.05 12149.5,-333.05 12156.5,-333.05"/>
</g>
<!-- expert_7_fc2_1&#45;&gt;expert_7_allreduce -->
<g id="edge216" class="edge">
<title>expert_7_fc2_1&#45;&gt;expert_7_allreduce</title>
<path fill="none" stroke="black" d="M12322.79,-359.87C12293.28,-349.02 12260.73,-337.07 12232.1,-326.55"/>
<polygon fill="black" stroke="black" points="12233.14,-323.21 12222.55,-323.05 12230.73,-329.78 12233.14,-323.21"/>
</g>
<!-- expert_7_allreduce&#45;&gt;expert_agg -->
<g id="edge217" class="edge">
<title>expert_7_allreduce&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M12055.5,-289.67C11793.14,-274 11073.18,-230.99 10793.34,-214.27"/>
<polygon fill="black" stroke="black" points="10793.36,-210.77 10783.17,-213.66 10792.95,-217.75 10793.36,-210.77"/>
</g>
<!-- expert_agg&#45;&gt;residual2 -->
<g id="edge218" class="edge">
<title>expert_agg&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M10783.44,-196.5C10979.85,-179.4 11404.14,-142.47 11594.79,-125.87"/>
<polygon fill="black" stroke="black" points="11595.14,-129.36 11604.8,-125 11594.53,-122.38 11595.14,-129.36"/>
</g>
<!-- output -->
<g id="node157" class="node">
<title>output</title>
<path fill="lightblue" stroke="black" d="M11765,-53C11765,-53 11617,-53 11617,-53 11611,-53 11605,-47 11605,-41 11605,-41 11605,-12 11605,-12 11605,-6 11611,0 11617,0 11617,0 11765,0 11765,0 11771,0 11777,-6 11777,-12 11777,-12 11777,-41 11777,-41 11777,-47 11771,-53 11765,-53"/>
<text text-anchor="middle" x="11691" y="-37.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="11691" y="-22.8" font-family="Times,serif" font-size="14.00">(B=1024, L, D=8192)</text>
<text text-anchor="middle" x="11691" y="-7.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2&#45;&gt;output -->
<g id="edge220" class="edge">
<title>residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11691,-89.57C11691,-81.34 11691,-72.08 11691,-63.28"/>
<polygon fill="black" stroke="black" points="11694.5,-63.24 11691,-53.24 11687.5,-63.24 11694.5,-63.24"/>
</g>
</g>
</svg>
